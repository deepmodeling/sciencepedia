{
    "hands_on_practices": [
        {
            "introduction": "在评估人工智能驱动的诊断模型时，我们首先要掌握其核心性能指标。本练习旨在阐明分类器的内在性能（如灵敏度 $sensitivity$ 和特异性 $specificity$）如何与目标人群中的疾病患病率 $prevalence$ 相结合，从而决定其在临床实践中的真实预测能力。通过运用贝叶斯定理，您将亲手计算阳性预测值（$PPV$）和阴性预测值（$NPV$），这是将抽象的模型指标转化为具体临床决策依据的关键一步。",
            "id": "5094091",
            "problem": "一个转化型人工智能（AI）和机器学习（ML）流水线被部署用于解释针对分子诊断靶标的高通量免疫分析，其产生一个校准到固定决策阈值的二元分类结果。在选定的阈值下，交叉验证的性能评估得出灵敏度为 $0.92$，特异度为 $0.97$。在目标临床人群中，疾病患病率为 $0.04$。目标是量化分类器的性能如何转化为临床预测值和贝叶斯更新。\n\n从诊断测试和贝叶斯决策理论中使用的基本定义出发，按以下步骤进行。使用以下定义：灵敏度 $=$ $\\Pr(\\text{test positive} \\mid \\text{disease})$，特异度 $=$ $\\Pr(\\text{test negative} \\mid \\text{no disease})$，以及患病率 $=$ $\\Pr(\\text{disease})$。使用贝叶斯定理和阳性似然比（LR$^{+}$）的定义 $\\text{LR}^{+}=\\frac{\\text{sensitivity}}{1-\\text{specificity}}$。推导并计算：\n\n1. 阳性预测值（PPV），定义为 $\\Pr(\\text{disease} \\mid \\text{test positive})$。\n2. 阴性预测值（NPV），定义为 $\\Pr(\\text{no disease} \\mid \\text{test negative})$。\n3. 在得到阳性测试结果后，疾病的后验几率。\n\n将 $PPV$ 和 $NPV$ 表示为小数，将后验几率表示为无量纲小数。将每个量四舍五入到四位有效数字。不要使用百分号。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于贝叶斯统计学和流行病学的原理，所提问题清晰且提供了所有必要信息，其表述是客观的。我们可以进行正式的求解。\n\n令 $D$ 表示目标人群中的个体患有该疾病的事件，令 $D^c$ 表示个体未患该疾病的互补事件。令 $T^+$ 表示测试结果为阳性的事件，令 $T^-$ 表示测试结果为阴性的事件。所提供的信息可以正式表示如下：\n\n- 患病率，$\\Pr(D) = 0.04$。因此，未患病的概率为 $\\Pr(D^c) = 1 - \\Pr(D) = 1 - 0.04 = 0.96$。\n- 灵敏度, $\\text{Sens} = \\Pr(T^+ \\mid D) = 0.92$。\n- 特异度, $\\text{Spec} = \\Pr(T^- \\mid D^c) = 0.97$。\n\n根据这些定义，我们可以推导出其他条件概率：\n- 假阴性率, $\\Pr(T^- \\mid D) = 1 - \\text{Sens} = 1 - 0.92 = 0.08$。\n- 假阳性率, $\\Pr(T^+ \\mid D^c) = 1 - \\text{Spec} = 1 - 0.97 = 0.03$。\n\n该问题要求计算三个量：阳性预测值（PPV）、阴性预测值（NPV）以及在得到阳性测试结果后疾病的后验几率。\n\n**1. 阳性预测值（PPV）**\n\nPPV 定义为在测试结果为阳性的条件下患有该疾病的概率，即 $\\text{PPV} = \\Pr(D \\mid T^+)$。我们应用贝叶斯定理：\n$$\n\\text{PPV} = \\Pr(D \\mid T^+) = \\frac{\\Pr(T^+ \\mid D) \\Pr(D)}{\\Pr(T^+)}\n$$\n分母 $\\Pr(T^+)$ 是测试结果为阳性的全概率，可以使用全概率法则计算：\n$$\n\\Pr(T^+) = \\Pr(T^+ \\mid D) \\Pr(D) + \\Pr(T^+ \\mid D^c) \\Pr(D^c)\n$$\n代入已知值：\n$$\n\\Pr(T^+) = (0.92)(0.04) + (0.03)(0.96) = 0.0368 + 0.0288 = 0.0656\n$$\n现在我们可以计算 PPV：\n$$\n\\text{PPV} = \\frac{0.0368}{0.0656} \\approx 0.5609756...\n$$\n四舍五入到四位有效数字，我们得到 $\\text{PPV} \\approx 0.5610$。\n\n**2. 阴性预测值（NPV）**\n\nNPV 定义为在测试结果为阴性的条件下未患该疾病的概率，即 $\\text{NPV} = \\Pr(D^c \\mid T^-)$。应用贝叶斯定理：\n$$\n\\text{NPV} = \\Pr(D^c \\mid T^-) = \\frac{\\Pr(T^- \\mid D^c) \\Pr(D^c)}{\\Pr(T^-)}\n$$\n分母 $\\Pr(T^-)$ 是测试结果为阴性的全概率。使用全概率法则：\n$$\n\\Pr(T^-) = \\Pr(T^- \\mid D^c) \\Pr(D^c) + \\Pr(T^- \\mid D) \\Pr(D)\n$$\n注意到 $\\Pr(T^-) = 1 - \\Pr(T^+) = 1 - 0.0656 = 0.9344$。我们也可以直接计算它：\n$$\n\\Pr(T^-) = (0.97)(0.96) + (0.08)(0.04) = 0.9312 + 0.0032 = 0.9344\n$$\n现在我们可以计算 NPV：\n$$\n\\text{NPV} = \\frac{(0.97)(0.96)}{0.9344} = \\frac{0.9312}{0.9344} \\approx 0.9965753...\n$$\n四舍五入到四位有效数字，我们得到 $\\text{NPV} \\approx 0.9966$。\n\n**3. 疾病的后验几率**\n\n事件 $A$ 的几率由 $\\text{Odds}(A) = \\frac{\\Pr(A)}{1 - \\Pr(A)}$ 给出。疾病的后验几率是在观察到阳性测试结果后的几率，即 $\\text{Odds}(D \\mid T^+) = \\frac{\\Pr(D \\mid T^+)}{\\Pr(D^c \\mid T^+)}$。\n\n用贝叶斯术语来说，后验几率是通过将先验几率乘以似然比来计算的。\n$$\n\\text{Posterior Odds} = \\text{Prior Odds} \\times \\text{Likelihood Ratio}\n$$\n疾病的先验几率是：\n$$\n\\text{Odds}(D) = \\frac{\\Pr(D)}{\\Pr(D^c)} = \\frac{0.04}{0.96}\n$$\n对于阳性测试，相关的似然比是阳性似然比 $\\text{LR}^+$，定义为：\n$$\n\\text{LR}^+ = \\frac{\\text{sensitivity}}{1 - \\text{specificity}} = \\frac{\\Pr(T^+ \\mid D)}{\\Pr(T^+ \\mid D^c)}\n$$\n代入给定值：\n$$\n\\text{LR}^+ = \\frac{0.92}{1 - 0.97} = \\frac{0.92}{0.03}\n$$\n现在，我们计算后验几率：\n$$\n\\text{Odds}(D \\mid T^+) = \\left(\\frac{0.04}{0.96}\\right) \\times \\left(\\frac{0.92}{0.03}\\right) = \\frac{0.04 \\times 0.92}{0.96 \\times 0.03} = \\frac{0.0368}{0.0288} \\approx 1.2777...\n$$\n四舍五入到四位有效数字，后验几率约为 $1.278$。\n\n这个结果可以用之前计算的 PPV 来验证：\n$$\n\\text{Odds}(D \\mid T^+) = \\frac{\\text{PPV}}{1 - \\text{PPV}} = \\frac{0.5609756...}{1 - 0.5609756...} = \\frac{0.5609756...}{0.4390243...} \\approx 1.2777...\n$$\n结果是一致的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5610  0.9966  1.278 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了基本预测值的计算后，下一个挑战是如何为输出连续风险评分的分类器选择最佳决策阈值。本练习将引导您对比两种不同的优化策略：一种是最大化与ROC曲线下面积（AUC）相关的、不考虑患病率的Youden指数；另一种是满足临床要求的特定召回率（即灵敏度）目标。通过这个在罕见病背景下的思想实验，您将深刻理解为何在低患病率场景中，盲目优化诸如AUC之类的常用指标可能会导致临床效用不佳，并凸显了控制假阳性、提升阳性预测值（PPV）的至关重要性。",
            "id": "5094062",
            "problem": "一家免疫诊断实验室部署了一个监督式机器学习模型，用于解读一种罕见自身免疫性疾病的多重自身抗体检测，该疾病的患病率为 $p = 0.001$。该模型输出一个连续的风险评分 $s$，用于对后续的确认性检测进行分流。基于历史检测校准和特征聚合，患病 ($Y=1$) 和非患病 ($Y=0$) 人群中的评分分布可由等方差高斯密度近似：$s \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ 和 $s \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，其参数为 $\\mu_{0} = 0$，$\\mu_{1} = 2$ 和 $\\sigma = 1$。决策阈值 $t$ 将满足 $s \\geq t$ 的样本分类为阳性。\n\n根据基本定义：\n- 受试者工作特征（ROC）曲线是当 $t$ 变化时，点对 $(\\mathrm{TPR}(t), \\mathrm{FPR}(t))$ 的轨迹，其中 $\\mathrm{TPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=1)$ 和 $\\mathrm{FPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=0)$，而 ROC 曲线下面积（AUC）与阈值无关。\n- 一种广泛使用的基于 ROC 的工作点选择方法是 Youden $J$ 指数，定义为 $J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$，它选择使 $J(t)$ 最大化的阈值 $t$。\n- 精确率，也称为阳性预测值（PPV），是 $\\mathrm{PPV}(t) = \\mathbb{P}(Y=1 \\mid s \\geq t)$，根据贝叶斯法则可以写成 $$\\mathrm{PPV}(t) = \\frac{p \\cdot \\mathrm{TPR}(t)}{p \\cdot \\mathrm{TPR}(t) + (1-p) \\cdot \\mathrm{FPR}(t)}.$$\n- 临床操作规定了由目标召回率 $R^{\\star}$ 体现的最低灵敏度要求，这意味着决策阈值必须满足 $\\mathrm{TPR}(t) \\geq R^{\\star}$。\n\n仅使用这些基本定义，构建在这种罕见病背景下由两个相互竞争的目标所蕴含的操作阈值：\n1. 使 Youden $J$ 指数最大化的阈值 $t_{J}$。\n2. 达到目标召回率 $R^{\\star} = 0.7$ 的阈值 $t_{R}$。\n\n然后，计算阈值偏移 $\\Delta t = t_{R} - t_{J}$。利用患病率 $p = 0.001$ 和推导出的阈值，解释为什么在这种情况下，通过 Youden $J$ 指数优化 ROC 曲线下面积（AUC）可能不如在目标召回率下优化精确率。将 $\\Delta t$ 的最终数值四舍五入到四位有效数字。将任何中间概率表示为小数而非百分比。阈值不需要物理单位。",
            "solution": "在尝试解答之前，对问题陈述进行了严格的验证程序。\n\n### 第 1 步：提取已知条件\n- 疾病患病率：$p = 0.001$\n- 人群状态变量：患病 ($Y=1$)，非患病 ($Y=0$)\n- 模型风险评分：$s$\n- 患病人群的评分分布：$s \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$\n- 非患病人群的评分分布：$s \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$\n- 分布参数：$\\mu_{0} = 0$, $\\mu_{1} = 2$, $\\sigma = 1$\n- 分类规则：如果 $s \\geq t$，则样本为阳性\n- 真阳性率 (TPR)：$\\mathrm{TPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=1)$\n- 假阳性率 (FPR)：$\\mathrm{FPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=0)$\n- Youden $J$ 指数：$J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$\n- 阳性预测值 (PPV)：$\\mathrm{PPV}(t) = \\mathbb{P}(Y=1 \\mid s \\geq t) = \\frac{p \\cdot \\mathrm{TPR}(t)}{p \\cdot \\mathrm{TPR}(t) + (1-p) \\cdot \\mathrm{FPR}(t)}$\n- 目标召回率（最低灵敏度）：$R^{\\star} = 0.7$\n- 临床约束：$\\mathrm{TPR}(t) \\geq R^{\\star}$\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据**：该问题基于统计决策理论、信号检测理论和诊断测试评估的既定原则。使用高斯分布对分类器得分进行建模，以及使用 TPR、FPR、PPV 和 Youden 指数等指标，是机器学习和生物统计学中的标准和基本概念。该场景在科学上是合理的。\n- **适定性**：该问题提供了所有必要的参数（$\\mu_0, \\mu_1, \\sigma, p, R^{\\star}$）、明确的定义和清晰的目标。寻找两个特定阈值并比较其性能的任务定义明确，能够导出一个唯一、稳定且有意义的解。\n- **客观性**：该问题以精确、量化且无偏见的语言陈述，不含主观或推测性内容。\n\n该问题没有表现出任何诸如科学不合理、信息缺失、内部矛盾或不切实际的条件等缺陷。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。下面是一个完整的、有理有据的解答。\n\n设 $\\Phi(z)$ 和 $\\phi(z)$ 分别表示标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF）和概率密度函数（PDF）。\n\n首先，我们将真阳性率（TPR）和假阳性率（FPR）表示为决策阈值 $t$ 的函数。\n来自患病人群 $Y=1$ 的得分 $s$ 服从 $\\mathcal{N}(\\mu_{1}, \\sigma^{2})$。对变量进行标准化可得 $Z = \\frac{s-\\mu_1}{\\sigma} \\sim \\mathcal{N}(0,1)$。\n$$ \\mathrm{TPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=1) = \\mathbb{P}\\left(\\frac{s-\\mu_1}{\\sigma} \\geq \\frac{t-\\mu_1}{\\sigma}\\right) = \\mathbb{P}\\left(Z \\geq \\frac{t-\\mu_1}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) $$\n类似地，来自非患病人群 $Y=0$ 的得分 $s$ 服从 $\\mathcal{N}(\\mu_{0}, \\sigma^{2})$。对变量进行标准化可得 $Z = \\frac{s-\\mu_0}{\\sigma} \\sim \\mathcal{N}(0,1)$。\n$$ \\mathrm{FPR}(t) = \\mathbb{P}(s \\geq t \\mid Y=0) = \\mathbb{P}\\left(\\frac{s-\\mu_0}{\\sigma} \\geq \\frac{t-\\mu_0}{\\sigma}\\right) = \\mathbb{P}\\left(Z \\geq \\frac{t-\\mu_0}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) $$\n\n**1. Youden 最优阈值 $t_J$ 的计算**\nYouden $J$ 指数是 $J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$。代入上面的表达式：\n$$ J(t) = \\left(1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right)\\right) - \\left(1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right)\\right) = \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) $$\n为了找到使 $J(t)$ 最大化的阈值 $t_J$，我们对 $J(t)$ 关于 $t$ 求导，并令其为零。利用 $\\frac{d}{dx}\\Phi(x) = \\phi(x)$ 这一事实：\n$$ \\frac{dJ}{dt} = \\frac{d}{dt}\\left[\\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right)\\right] = \\frac{1}{\\sigma}\\phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) - \\frac{1}{\\sigma}\\phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) = 0 $$\n$$ \\phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) = \\phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) $$\n由于 PDF $\\phi(z)$ 关于 $z=0$ 对称，即 $\\phi(z) = \\phi(-z)$，对于 $|z_1| = |z_2|$ 有两个解。一个是平凡解（$z_1=z_2$，这意味着 $\\mu_0=\\mu_1$，但在这里情况并非如此），另一个是 $z_1 = -z_2$。这给出了最大值：\n$$ \\frac{t-\\mu_0}{\\sigma} = -\\left(\\frac{t-\\mu_1}{\\sigma}\\right) $$\n$$ t - \\mu_0 = -t + \\mu_1 \\implies 2t = \\mu_0 + \\mu_1 \\implies t = \\frac{\\mu_0 + \\mu_1}{2} $$\n这个阈值 $t_J$ 是两个分布均值的中点，也就是它们的 PDF 相交的点。代入给定值 $\\mu_{0}=0$，$\\mu_{1}=2$ 和 $\\sigma=1$：\n$$ t_{J} = \\frac{0 + 2}{2} = 1 $$\n\n**2. 召回率约束阈值 $t_R$ 的计算**\n阈值 $t_R$ 必须达到目标召回率 $R^{\\star} = 0.7$。这意味着我们设置 $\\mathrm{TPR}(t_R) = 0.7$。\n$$ \\mathrm{TPR}(t_R) = 1 - \\Phi\\left(\\frac{t_R-\\mu_1}{\\sigma}\\right) = 0.7 $$\n$$ \\Phi\\left(\\frac{t_R-\\mu_1}{\\sigma}\\right) = 1 - 0.7 = 0.3 $$\n我们通过应用标准正态 CDF 的反函数，即分位数函数 $\\Phi^{-1}$，来求解 $t_R$：\n$$ \\frac{t_R-\\mu_1}{\\sigma} = \\Phi^{-1}(0.3) $$\n$$ t_R = \\mu_1 + \\sigma \\cdot \\Phi^{-1}(0.3) $$\n使用标准统计表或软件，分位数的值为 $\\Phi^{-1}(0.3) \\approx -0.5244$。代入给定参数 $\\mu_1 = 2$ 和 $\\sigma=1$：\n$$ t_R = 2 + 1 \\cdot (-0.5244) = 1.4756 $$\n\n**3. 阈值偏移 $\\Delta t$ 的计算**\n阈值偏移是 $t_R$ 和 $t_J$ 之间的差值：\n$$ \\Delta t = t_R - t_J = 1.4756 - 1 = 0.4756 $$\n\n**4. 关于 Youden 指数次优性的解释**\nYouden 指数 $J(t)$ 是一个基于 AUC 的指标，它与疾病患病率 $p$ 无关。它将假阳性和假阴性视为同等代价。在罕见病背景下，$p$ 非常小，这种等价性是不恰当的，并导致临床性能次优，这可以通过阳性预测值（PPV）来衡量。\n\n让我们用 $p=0.001$ 计算两个阈值的性能指标：\n\n**在阈值 $t_J = 1$ 时：**\n$$ \\mathrm{TPR}(t_J) = 1 - \\Phi\\left(\\frac{1-2}{1}\\right) = 1 - \\Phi(-1) = \\Phi(1) \\approx 0.8413 $$\n$$ \\mathrm{FPR}(t_J) = 1 - \\Phi\\left(\\frac{1-0}{1}\\right) = 1 - \\Phi(1) \\approx 1 - 0.8413 = 0.1587 $$\nPPV 为：\n$$ \\mathrm{PPV}(t_J) = \\frac{p \\cdot \\mathrm{TPR}(t_J)}{p \\cdot \\mathrm{TPR}(t_J) + (1-p) \\cdot \\mathrm{FPR}(t_J)} \\approx \\frac{0.001 \\cdot 0.8413}{0.001 \\cdot 0.8413 + 0.999 \\cdot 0.1587} $$\n$$ \\mathrm{PPV}(t_J) \\approx \\frac{0.0008413}{0.0008413 + 0.1585413} \\approx 0.00528 $$\n这意味着使用 Youden 最优阈值时，只有约 $0.53\\%$ 的阳性检测结果来自真正患病的个体。\n\n**在阈值 $t_R = 1.4756$ 时：**\n$$ \\mathrm{TPR}(t_R) = 0.7 \\quad \\text{(根据定义)} $$\n$$ \\mathrm{FPR}(t_R) = 1 - \\Phi\\left(\\frac{1.4756-0}{1}\\right) = 1 - \\Phi(1.4756) \\approx 1 - 0.9300 = 0.0700 $$\nPPV 为：\n$$ \\mathrm{PPV}(t_R) = \\frac{p \\cdot \\mathrm{TPR}(t_R)}{p \\cdot \\mathrm{TPR}(t_R) + (1-p) \\cdot \\mathrm{FPR}(t_R)} \\approx \\frac{0.001 \\cdot 0.7}{0.001 \\cdot 0.7 + 0.999 \\cdot 0.0700} $$\n$$ \\mathrm{PPV}(t_R) \\approx \\frac{0.0007}{0.0007 + 0.06993} \\approx 0.00991 $$\n在此阈值下，PPV 约为 $0.99\\%$。\n\n**关于次优性的结论：**\n在罕见病背景下（$p=0.001$），PPV 公式的分母主要由项 $(1-p) \\cdot \\mathrm{FPR}(t)$ 决定，因为非患病人群远大于患病人群。为了获得一个有意义的 PPV，FPR 必须保持在极低的水平。Youden 指数通过最大化 $\\mathrm{TPR} - \\mathrm{FPR}$ 来找到一个忽略患病率的“平衡”点。在 $t_J=1$ 时，FPR 相对较高（$\\approx 15.9\\%$），这在庞大的非患病人群中产生了大量的假阳性，导致 PPV 急剧下降。\n\n通过将阈值调高至 $t_R = 1.4756$，我们接受了一个较低的灵敏度（TPR 从 $0.84$ 降至 $0.7$），但这仍然满足临床要求。然而，这一调整通过将 FPR 减少一半以上（从 $15.9\\%$ 降至 $7.0\\%$），显著提高了特异性。假阳性的减少使 PPV 几乎翻倍（从 $0.53\\%$ 增至 $0.99\\%$）。虽然这个值仍然很低，但这一改进具有重要的临床意义，因为它大大减少了被送去做不必要的、昂贵的且可能具有侵入性的后续检测的患者数量。因此，优化 Youden $J$ 指数是次优的，因为它未能考虑患病率，导致在一个控制假阳性至关重要的筛查背景下，阈值的精确率（PPV）很差。在目标召回率下优化像 PPV 这样的临床相关指标是一种更优的策略。阈值的增加，$\\Delta t  0$，反映了这种向更高特异性转变的必要性。",
            "answer": "$$\\boxed{0.4756}$$"
        },
        {
            "introduction": "前面的练习揭示了选择“最佳”阈值的复杂性，现在我们将学习一种更为严谨的解决方案。本练习引入了贝叶斯决策理论，它提供了一个通过明确量化错分成本（即假阳性 $c_{FP}$ 和假阴性 $c_{FN}$ 的代价）来寻找最优决策边界的系统性框架。您将推导并计算能够最小化预期风险的决策阈值 $\\tau$，这个过程不仅能加深您对模型、患病率和临床成本之间相互作用的理解，更展示了如何将机器学习模型真正嵌入到理性的临床决策流程中。",
            "id": "5094074",
            "problem": "一家临床实验室部署了一套人工智能 (AI) 和机器学习 (ML) 系统，用于将连续的免疫分析信号解释为某种传染病的诊断风险评分 $s \\in \\mathbb{R}$。决策规则是一个单阈值分类器：如果 $s  \\tau$，则预测患病，否则预测未患病。根据先前的校准，类条件分数分布被建模为等方差的高斯分布：$s \\mid \\text{disease} \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ 和 $s \\mid \\text{no disease} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$。患病率为 $\\pi_{1}$，非患病率为 $\\pi_{0} = 1 - \\pi_{1}$。此决策规则下的期望风险由二元分类的基本贝叶斯决策理论成本公式定义：$R(\\tau) = c_{FP} \\, \\pi_{0} \\, \\mathbb{P}(s  \\tau \\mid \\text{no disease}) + c_{FN} \\, \\pi_{1} \\, \\mathbb{P}(s \\leq \\tau \\mid \\text{disease})$，其中 $c_{FP}$ 和 $c_{FN}$ 分别是假阳性和假阴性的指定成本。\n\n从这个风险定义和高斯密度出发，通过在决策边界上均衡假阳性和假阴性的边际期望成本，推导出最小化 $R(\\tau)$ 的阈值 $\\tau$ 的解析表达式，然后对以下科学上合理的参数进行数值计算：$\\mu_{0} = 0.5$, $\\mu_{1} = 1.5$, $\\sigma = 0.4$, $\\pi_{1} = 0.2$, $\\pi_{0} = 0.8$, $c_{FP} = 1$, $c_{FN} = 5$。将最终阈值表示为无量纲分数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于贝叶斯决策理论和统计信号处理，代表了一个标准的、良态的优化问题。所提供的参数是自洽的，在诊断背景下是物理上合理的，并且是完整的。该问题是客观的，没有歧义，并且需要严谨且不平凡的推导。\n\n目标是找到使期望风险 $R(\\tau)$ 最小化的决策阈值 $\\tau$。风险函数由下式给出：\n$$R(\\tau) = c_{FP} \\, \\pi_{0} \\, \\mathbb{P}(s  \\tau \\mid \\text{no disease}) + c_{FN} \\, \\pi_{1} \\, \\mathbb{P}(s \\leq \\tau \\mid \\text{disease})$$\n其中 $\\mathbb{P}(s  \\tau \\mid \\text{no disease})$ 是假阳性概率，$\\mathbb{P}(s \\leq \\tau \\mid \\text{disease})$ 是假阴性概率。令 $p(s \\mid \\text{no disease})$ 和 $p(s \\mid \\text{disease})$ 分别为在无病或有病条件下分数 $s$ 的概率密度函数 (PDF)。这些概率可以写成积分形式：\n$$\\mathbb{P}(s  \\tau \\mid \\text{no disease}) = \\int_{\\tau}^{\\infty} p(s \\mid \\text{no disease}) \\, ds$$\n$$\\mathbb{P}(s \\leq \\tau \\mid \\text{disease}) = \\int_{-\\infty}^{\\tau} p(s \\mid \\text{disease}) \\, ds$$\n为了找到 $R(\\tau)$ 的最小值，我们将 $R(\\tau)$ 对 $\\tau$ 求导，并令结果为零。使用莱布尼茨积分法则，特别是 $\\frac{d}{dx}\\int_{x}^{a} f(t)dt = -f(x)$ 和 $\\frac{d}{dx}\\int_{a}^{x} f(t)dt = f(x)$，我们得到：\n$$\\frac{dR(\\tau)}{d\\tau} = c_{FP} \\, \\pi_{0} \\, \\frac{d}{d\\tau} \\left( \\int_{\\tau}^{\\infty} p(s \\mid \\text{no disease}) \\, ds \\right) + c_{FN} \\, \\pi_{1} \\, \\frac{d}{d\\tau} \\left( \\int_{-\\infty}^{\\tau} p(s \\mid \\text{disease}) \\, ds \\right)$$\n$$\\frac{dR(\\tau)}{d\\tau} = c_{FP} \\, \\pi_{0} \\, (-p(\\tau \\mid \\text{no disease})) + c_{FN} \\, \\pi_{1} \\, (p(\\tau \\mid \\text{disease}))$$\n将导数设为零，得到最优性条件，该条件使决策边界 $\\tau$ 处的边际成本相等：\n$$c_{FN} \\, \\pi_{1} \\, p(\\tau \\mid \\text{disease}) = c_{FP} \\, \\pi_{0} \\, p(\\tau \\mid \\text{no disease})$$\n问题陈述指出，类条件分布是高斯分布，其均值分别为 $\\mu_1$ (患病) 和 $\\mu_0$ (不患病)，并具有共同方差 $\\sigma^2$。其概率密度函数为：\n$$p(s \\mid \\text{disease}) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(s - \\mu_1)^2}{2\\sigma^2}\\right)$$\n$$p(s \\mid \\text{no disease}) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(s - \\mu_0)^2}{2\\sigma^2}\\right)$$\n将这些 $s = \\tau$ 时的表达式代入最优性条件：\n$$c_{FN} \\, \\pi_{1} \\, \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(\\tau - \\mu_1)^2}{2\\sigma^2}\\right) = c_{FP} \\, \\pi_{0} \\, \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(\\tau - \\mu_0)^2}{2\\sigma^2}\\right)$$\n归一化常数 $\\frac{1}{\\sqrt{2\\pi}\\sigma}$ 从两侧消去：\n$$c_{FN} \\, \\pi_{1} \\, \\exp\\left(-\\frac{(\\tau - \\mu_1)^2}{2\\sigma^2}\\right) = c_{FP} \\, \\pi_{0} \\, \\exp\\left(-\\frac{(\\tau - \\mu_0)^2}{2\\sigma^2}\\right)$$\n为了解出 $\\tau$，我们对两边取自然对数：\n$$\\ln(c_{FN} \\pi_{1}) - \\frac{(\\tau - \\mu_1)^2}{2\\sigma^2} = \\ln(c_{FP} \\pi_{0}) - \\frac{(\\tau - \\mu_0)^2}{2\\sigma^2}$$\n重新整理各项，以分离出包含 $\\tau$ 的表达式：\n$$\\frac{(\\tau - \\mu_0)^2}{2\\sigma^2} - \\frac{(\\tau - \\mu_1)^2}{2\\sigma^2} = \\ln(c_{FP} \\pi_{0}) - \\ln(c_{FN} \\pi_{1})$$\n乘以 $2\\sigma^2$ 并合并对数项：\n$$(\\tau - \\mu_0)^2 - (\\tau - \\mu_1)^2 = 2\\sigma^2 \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n展开左侧的平方项：\n$$(\\tau^2 - 2\\tau\\mu_0 + \\mu_0^2) - (\\tau^2 - 2\\tau\\mu_1 + \\mu_1^2) = 2\\sigma^2 \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n$\\tau^2$ 项被消去。将剩余项分组得到：\n$$2\\tau(\\mu_1 - \\mu_0) + (\\mu_0^2 - \\mu_1^2) = 2\\sigma^2 \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n使用平方差公式 $\\mu_0^2 - \\mu_1^2 = (\\mu_0 - \\mu_1)(\\mu_0 + \\mu_1)$：\n$$2\\tau(\\mu_1 - \\mu_0) - (\\mu_1 - \\mu_0)(\\mu_0 + \\mu_1) = 2\\sigma^2 \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n假设 $\\mu_1 \\neq \\mu_0$，两边同除以 $2(\\mu_1 - \\mu_0)$：\n$$\\tau - \\frac{\\mu_0 + \\mu_1}{2} = \\frac{\\sigma^2}{\\mu_1 - \\mu_0} \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n最后，求解 $\\tau$ 可得最优阈值的通用解析表达式：\n$$\\tau = \\frac{\\mu_0 + \\mu_1}{2} + \\frac{\\sigma^2}{\\mu_1 - \\mu_0} \\ln\\left(\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}}\\right)$$\n现在我们使用给定的参数对该表达式进行数值计算：$\\mu_{0} = 0.5$, $\\mu_{1} = 1.5$, $\\sigma = 0.4$, $\\pi_{1} = 0.2$, $\\pi_{0} = 0.8$, $c_{FP} = 1$, and $c_{FN} = 5$。\n\n首先，我们计算表达式的各个部分：\n均值的中点：$\\frac{\\mu_0 + \\mu_1}{2} = \\frac{0.5 + 1.5}{2} = \\frac{2.0}{2} = 1$。\n均值的差：$\\mu_1 - \\mu_0 = 1.5 - 0.5 = 1$。\n方差：$\\sigma^2 = (0.4)^2 = 0.16$。\n对数的参数：$\\frac{c_{FP} \\pi_{0}}{c_{FN} \\pi_{1}} = \\frac{1 \\times 0.8}{5 \\times 0.2} = \\frac{0.8}{1.0} = 0.8$。\n\n将这些值代入 $\\tau$ 的表达式中：\n$$\\tau = 1 + \\frac{0.16}{1} \\ln(0.8)$$\n$$\\tau = 1 + 0.16 \\times (-0.22314355...)$$\n$$\\tau = 1 - 0.035702968...$$\n$$\\tau = 0.96429703...$$\n将结果四舍五入到四位有效数字，得到 $\\tau \\approx 0.9643$。",
            "answer": "$$\\boxed{0.9643}$$"
        }
    ]
}