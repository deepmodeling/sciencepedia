{
    "hands_on_practices": [
        {
            "introduction": "Gene Set Enrichment Analysis fundamentally relies on a running-sum statistic to determine if a gene set is enriched at the top or bottom of a ranked list. To truly understand how this works, it's essential to move beyond software outputs and perform the calculation by hand. This practice guides you through computing the Enrichment Score ($ES$) from first principles for a small, illustrative example, reinforcing the core mechanics of the weighted Kolmogorov-Smirnov-like statistic .",
            "id": "4567424",
            "problem": "You are given a pre-ranked list of genes from a transcriptomic differential phenotype analysis, with each gene associated to a ranking metric magnitude interpreted as the absolute value of a correlation with the phenotype. The task is to compute the Gene Set Enrichment Analysis (GSEA) enrichment score at weighting parameter $p=1$ from first principles, using the Kolmogorov–Smirnov-like running-sum definition, and then identify the leading-edge subset. Do not use any pre-memorized shortcut formulas; instead, explicitly construct the running-sum process from the definitions of empirical cumulative distribution functions for hits and misses.\n\nThe total number of genes is $N=10$, the ordered ranked list from most to least associated is:\n1. MYC with score $10$\n2. TP53 with score $9$\n3. EGFR with score $8$\n4. BRCA1 with score $7$\n5. PTEN with score $6$\n6. KRAS with score $5$\n7. AKT1 with score $4$\n8. BRAF with score $3$\n9. MDM2 with score $2$\n10. CDK2 with score $1$\n\nConsider the gene set $S$ of size $|S|=3$ given by $S=\\{\\text{TP53}, \\text{KRAS}, \\text{MDM2}\\}$. Use weighting parameter $p=1$ so that at a hit the running sum increases by a value proportional to the gene’s score and normalized by the total score of $S$, and at a miss the running sum decreases by a constant so that the total decrement over all misses equals $1$.\n\nStarting from the definitions of the empirical cumulative distribution functions for hits and misses and their difference along the ranked list, compute by hand:\n- the enrichment score (ES) as the maximum deviation of the running sum from zero, and\n- the leading-edge subset corresponding to the location where the enrichment score is attained.\n\nExpress the enrichment score as an exact reduced rational number (no rounding), without units. The final answer should be only the enrichment score.",
            "solution": "The user-provided problem statement is subjected to a validation process.\n\n### Step 1: Extract Givens\n- Total number of genes in the ranked list: $N=10$.\n- Ranked list of genes with their scores (interpreted as absolute correlation):\n  1. MYC (score $10$)\n  2. TP53 (score $9$)\n  3. EGFR (score $8$)\n  4. BRCA1 (score $7$)\n  5. PTEN (score $6$)\n  6. KRAS (score $5$)\n  7. AKT1 (score $4$)\n  8. BRAF (score $3$)\n  9. MDM2 (score $2$)\n  10. CDK2 (score $1$)\n- Gene set of interest: $S=\\{\\text{TP53}, \\text{KRAS}, \\text{MDM2}\\}$.\n- Size of the gene set: $N_H = |S|=3$.\n- Weighting parameter: $p=1$.\n- Rule for hit increment: For a gene in $S$, the running sum increases by a value proportional to the gene's score, normalized by the total score of all genes in $S$.\n- Rule for miss decrement: For a gene not in $S$, the running sum decreases by a constant value, such that the sum of all decrements over all misses equals $1$.\n- Definition of Enrichment Score (ES): The maximum deviation of the running sum from zero.\n- Task: Compute the ES and the leading-edge subset from first principles, using the running-sum defined by empirical cumulative distribution functions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it describes a standard, albeit simplified, procedure for Gene Set Enrichment Analysis (GSEA), a well-established method in bioinformatics. The use of a weighted Kolmogorov-Smirnov-like statistic with $p=1$ is a valid GSEA variant. All necessary data ($N$, the ranked list, the scores, the gene set $S$, and the rules for the running sum) are provided, making the problem well-posed and self-contained. The language is objective and the data are internally consistent. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution\nThe Gene Set Enrichment Analysis (GSEA) enrichment score (ES) is calculated by walking down the ranked list of genes, $L$, and computing a running-sum statistic. The ES is the maximum deviation of this running sum from zero. The running sum at any point $i$ in the ranked list is the difference between a weighted empirical cumulative distribution function for the genes present in the set $S$ (hits) and an empirical cumulative distribution function for genes not in $S$ (misses).\n\nFirst, we identify the hits and misses in the ranked list. The total number of genes is $N=10$. The gene set $S=\\{\\text{TP53}, \\text{KRAS}, \\text{MDM2}\\}$ has $N_H = |S| = 3$ genes (hits). The number of genes not in $S$ is $N_M = N - N_H = 10 - 3 = 7$ (misses).\n\nThe ranked list with hit/miss status and scores ($r_j$) is as follows:\n1. MYC, $r_1=10$ (Miss)\n2. TP53, $r_2=9$ (Hit)\n3. EGFR, $r_3=8$ (Miss)\n4. BRCA1, $r_4=7$ (Miss)\n5. PTEN, $r_5=6$ (Miss)\n6. KRAS, $r_6=5$ (Hit)\n7. AKT1, $r_7=4$ (Miss)\n8. BRAF, $r_8=3$ (Miss)\n9. MDM2, $r_9=2$ (Hit)\n10. CDK2, $r_{10}=1$ (Miss)\n\nThe running sum at rank $i$, denoted $ES_i$, is defined as $ES_i = P_{hit}(S, i) - P_{miss}(S, i)$.\n\nThe term $P_{hit}(S, i)$ is the weighted empirical cumulative distribution of hits. With the weighting parameter $p=1$, it is calculated as:\n$$P_{hit}(S, i) = \\sum_{g_j \\in S, j \\le i} \\frac{r_j}{N_R}$$\nwhere $N_R$ is the normalization factor, equal to the sum of scores for all genes in $S$:\n$$N_R = \\sum_{g_j \\in S} r_j = r_{\\text{TP53}} + r_{\\text{KRAS}} + r_{\\text{MDM2}} = 9 + 5 + 2 = 16$$\nWhen we encounter a hit $g_j \\in S$ at rank $j$ with score $r_j$, the running sum increases by $\\frac{r_j}{N_R} = \\frac{r_j}{16}$.\n\nThe term $P_{miss}(S, i)$ is the empirical cumulative distribution of misses:\n$$P_{miss}(S, i) = \\sum_{g_j \\notin S, j \\le i} \\frac{1}{N_M}$$\nwhere $N_M = 7$. When we encounter a miss $g_j \\notin S$ at rank $j$, the running sum decreases by $\\frac{1}{N_M} = \\frac{1}{7}$.\n\nWe now compute the running sum $ES_i$ for each gene $g_i$ in the ranked list, starting with $ES_0=0$.\n\n1.  **Gene 1 (MYC, Miss):**\n    $P_{hit}(S, 1) = 0$. $P_{miss}(S, 1) = \\frac{1}{7}$.\n    $ES_1 = 0 - \\frac{1}{7} = -\\frac{1}{7} = -\\frac{16}{112}$.\n\n2.  **Gene 2 (TP53, Hit, score=9):**\n    $P_{hit}(S, 2) = \\frac{9}{16}$. $P_{miss}(S, 2) = \\frac{1}{7}$.\n    $ES_2 = \\frac{9}{16} - \\frac{1}{7} = \\frac{63 - 16}{112} = \\frac{47}{112}$.\n\n3.  **Gene 3 (EGFR, Miss):**\n    $P_{hit}(S, 3) = \\frac{9}{16}$. $P_{miss}(S, 3) = \\frac{2}{7}$.\n    $ES_3 = \\frac{9}{16} - \\frac{2}{7} = \\frac{63 - 32}{112} = \\frac{31}{112}$.\n\n4.  **Gene 4 (BRCA1, Miss):**\n    $P_{hit}(S, 4) = \\frac{9}{16}$. $P_{miss}(S, 4) = \\frac{3}{7}$.\n    $ES_4 = \\frac{9}{16} - \\frac{3}{7} = \\frac{63 - 48}{112} = \\frac{15}{112}$.\n\n5.  **Gene 5 (PTEN, Miss):**\n    $P_{hit}(S, 5) = \\frac{9}{16}$. $P_{miss}(S, 5) = \\frac{4}{7}$.\n    $ES_5 = \\frac{9}{16} - \\frac{4}{7} = \\frac{63 - 64}{112} = -\\frac{1}{112}$.\n\n6.  **Gene 6 (KRAS, Hit, score=5):**\n    $P_{hit}(S, 6) = \\frac{9}{16} + \\frac{5}{16} = \\frac{14}{16}$. $P_{miss}(S, 6) = \\frac{4}{7}$.\n    $ES_6 = \\frac{14}{16} - \\frac{4}{7} = \\frac{7}{8} - \\frac{4}{7} = \\frac{49 - 32}{56} = \\frac{17}{56} = \\frac{34}{112}$.\n\n7.  **Gene 7 (AKT1, Miss):**\n    $P_{hit}(S, 7) = \\frac{14}{16}$. $P_{miss}(S, 7) = \\frac{5}{7}$.\n    $ES_7 = \\frac{14}{16} - \\frac{5}{7} = \\frac{7}{8} - \\frac{5}{7} = \\frac{49 - 40}{56} = \\frac{9}{56} = \\frac{18}{112}$.\n\n8.  **Gene 8 (BRAF, Miss):**\n    $P_{hit}(S, 8) = \\frac{14}{16}$. $P_{miss}(S, 8) = \\frac{6}{7}$.\n    $ES_8 = \\frac{14}{16} - \\frac{6}{7} = \\frac{7}{8} - \\frac{6}{7} = \\frac{49 - 48}{56} = \\frac{1}{56} = \\frac{2}{112}$.\n\n9.  **Gene 9 (MDM2, Hit, score=2):**\n    $P_{hit}(S, 9) = \\frac{14}{16} + \\frac{2}{16} = \\frac{16}{16} = 1$. $P_{miss}(S, 9) = \\frac{6}{7}$.\n    $ES_9 = 1 - \\frac{6}{7} = \\frac{1}{7} = \\frac{16}{112}$.\n\n10. **Gene 10 (CDK2, Miss):**\n    $P_{hit}(S, 10) = 1$. $P_{miss}(S, 10) = \\frac{7}{7} = 1$.\n    $ES_{10} = 1 - 1 = 0$.\n\nThe sequence of running-sum values is: $\\{-\\frac{16}{112}, \\frac{47}{112}, \\frac{31}{112}, \\frac{15}{112}, -\\frac{1}{112}, \\frac{34}{112}, \\frac{18}{112}, \\frac{2}{112}, \\frac{16}{112}, 0\\}$.\n\nThe Enrichment Score (ES) is the maximum deviation of this running sum from zero. This is the maximum of the absolute values of the running sums:\n$$ES = \\max_{i=1,\\ldots,10} |ES_i|$$\nThe maximum value in the set is $ES_2 = \\frac{47}{112}$. The minimum value is $ES_1 = -\\frac{16}{112}$.\nThe maximum deviation from zero is $\\max(\\frac{47}{112}, |-\\frac{16}{112}|) = \\max(\\frac{47}{112}, \\frac{16}{112}) = \\frac{47}{112}$.\nThus, the enrichment score is $\\frac{47}{112}$. The number $47$ is prime and does not divide $112 = 2^4 \\times 7$, so this fraction is in its simplest form.\n\nThe leading-edge subset consists of the genes from the set $S$ that appear in the ranked list up to the position where the maximum enrichment score was found. The maximum score, $ES = \\frac{47}{112}$, occurs at rank $i=2$. The genes in the ranked list up to rank $2$ are $\\{\\text{MYC}, \\text{TP53}\\}$. The intersection of this set with the gene set $S$ is $\\{\\text{TP53}\\}$. Therefore, the leading-edge subset is $\\{\\text{TP53}\\}$.",
            "answer": "$$\\boxed{\\frac{47}{112}}$$"
        },
        {
            "introduction": "An observed Enrichment Score ($ES$) is only meaningful when compared to what might be expected by chance. This practice addresses the crucial step of normalization, where the raw $ES$ is converted into a Normalized Enrichment Score ($NES$) using properties of a null distribution. By calculating the $NES$ using different standardization methods, you will gain insight into how GSEA accounts for gene set size and random chance to produce a statistically interpretable result .",
            "id": "4345921",
            "problem": "In Gene Set Enrichment Analysis (GSEA), a gene set’s observed enrichment score $ES$ is obtained from a running-sum statistic over a ranked list of genes, and a null distribution for the magnitude of $ES$ is generated by phenotype-label permutations to estimate the expected magnitude of spurious enrichment. To remove dependence on gene set size and sampling variability, normalization maps an observed $ES$ onto a dimensionless scale using the null distribution of absolute enrichment scores. Consider a gene set with observed $ES$ equal to $0.62$. From $N$ permutations, the empirical null distribution of absolute enrichment scores yields a mean of $0.31$ and a standard deviation of $0.12$. Assume normalization preserves the sign of the observed $ES$ when mapping from the absolute-valued null distribution to the normalized enrichment score $NES$.\n\nUsing the statistical definitions of mean-standardization and $z$-score standardization applied to the absolute null magnitude, compute the two $NES$ values:\n- the mean-standardized $NES$, and\n- the $z$-score standardized $NES$.\n\nPresent your final answer as a row vector in the order $\\left(NES_{\\text{mean}}, NES_{z}\\right)$, and round each value to four significant figures. No units are required.",
            "solution": "The problem requires the computation of two types of Normalized Enrichment Scores ($NES$) for a given gene set, based on its observed Enrichment Score ($ES$) and the statistical properties of a null distribution.\n\nFirst, the given values are identified:\n- The observed Enrichment Score, $ES_{obs} = 0.62$.\n- The null distribution of absolute enrichment scores, $|ES|_{null}$, generated from permutations, has the following properties:\n  - Mean, $\\mu_{|ES|} = 0.31$.\n  - Standard deviation, $\\sigma_{|ES|} = 0.12$.\n\nThe problem specifies that the normalization process preserves the sign of the observed $ES$. Since $ES_{obs} = 0.62$ is positive, both resulting $NES$ values will be positive. The normalization is performed by standardizing the magnitude of the observed score, $|ES_{obs}|$, against the null distribution of magnitudes.\n\nThe magnitude of the observed enrichment score is $|ES_{obs}| = |0.62| = 0.62$.\n\nThe two required normalization methods are mean-standardization and $z$-score standardization.\n\n1.  **Mean-Standardized $NES$ ($NES_{\\text{mean}}$)**\n    Mean-standardization, in the context of GSEA, involves normalizing the observed score by the mean of the null distribution. The problem directs us to use the null distribution of absolute scores. Therefore, the magnitude of the observed $ES$ is divided by the mean of the absolute scores from the null distribution. The sign of the original $ES_{obs}$ is then applied.\n\n    The formula is:\n    $$NES_{\\text{mean}} = \\text{sign}(ES_{obs}) \\times \\frac{|ES_{obs}|}{\\mu_{|ES|}}$$\n    Given that $ES_{obs} > 0$, $\\text{sign}(ES_{obs}) = +1$.\n    Substituting the given values:\n    $$NES_{\\text{mean}} = \\frac{0.62}{0.31} = 2$$\n    Rounding to four significant figures, this is $2.000$.\n\n2.  **$z$-score Standardized $NES$ ($NES_{z}$)**\n    $z$-score standardization rescales a value by expressing it in terms of the number of standard deviations it is from the mean of a distribution. Here, we standardize the magnitude of the observed $ES$, $|ES_{obs}|$, with respect to the mean and standard deviation of the null distribution of absolute scores. The sign of the original $ES_{obs}$ is preserved.\n\n    The formula for a $z$-score is $z = \\frac{(x - \\mu)}{\\sigma}$. Applying this to our context:\n    $$NES_{z} = \\text{sign}(ES_{obs}) \\times \\frac{|ES_{obs}| - \\mu_{|ES|}}{\\sigma_{|ES|}}$$\n    Again, since $ES_{obs} > 0$, $\\text{sign}(ES_{obs}) = +1$.\n    Substituting the given values:\n    $$NES_{z} = \\frac{0.62 - 0.31}{0.12} = \\frac{0.31}{0.12}$$\n    $$NES_{z} \\approx 2.58333...$$\n    Rounding this value to four significant figures yields $2.583$.\n\nThe final answer should be presented as a row vector $(NES_{\\text{mean}}, NES_{z})$ with the calculated values rounded to four significant figures.\nThe calculated values are $NES_{\\text{mean}} = 2.000$ and $NES_{z} = 2.583$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.000 & 2.583 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Mastery of an algorithm often comes from exploring its behavior in edge cases. This exercise presents a thought experiment: what is the Enrichment Score for a gene set containing only a single gene? By deriving a closed-form expression for the $ES$ as a function of the gene's rank, you will deepen your analytical understanding of the running-sum dynamic and its direct relationship to a gene's position in the ranked list .",
            "id": "2393962",
            "problem": "Consider Gene Set Enrichment Analysis (GSEA) applied to a ranked list of genes. Let there be a ranked list $\\mathcal{L}$ of $N$ distinct genes ordered from rank $1$ (top) to rank $N$ (bottom). Let the gene set $\\mathcal{S}$ contain exactly one gene (so $N_H = |\\mathcal{S}| = 1$), and suppose that this gene appears at rank $k \\in \\{1,2,\\dots,N\\}$ in $\\mathcal{L}$. Use the standard weighted running-sum definition of GSEA with exponent $p \\ge 0$: when scanning down the list from $i=1$ to $i=N$, define the running sum $R(i)$ as follows. If the $i$-th ranked gene is in $\\mathcal{S}$, increase $R(i)$ by $|r_i|^{p} / NR$, where $NR = \\sum_{g \\in \\mathcal{S}} |r_g|^{p}$, and if it is not in $\\mathcal{S}$, decrease $R(i)$ by $1/(N - N_H)$. Define the Enrichment Score $ES$ to be the maximum value of the running sum encountered along the walk, i.e., $ES = \\max_{1 \\le i \\le N} R(i)$. Express $ES$ solely as a closed-form function of $N$ and $k$. No numerical evaluation or rounding is required, and no units are to be reported.",
            "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n- A ranked list $\\mathcal{L}$ of $N$ distinct genes. Ranks are from $1$ to $N$.\n- A gene set $\\mathcal{S}$ with size $N_H = |\\mathcal{S}| = 1$.\n- The single gene in $\\mathcal{S}$ is located at rank $k$, where $k \\in \\{1, 2, \\dots, N\\}$.\n- The GSEA exponent is $p \\ge 0$.\n- The running sum $R(i)$ is computed by scanning from $i=1$ to $i=N$.\n- If the $i$-th gene is in $\\mathcal{S}$ (a \"hit\"), the increment is $|r_i|^p / NR$. The term $r_i$ denotes the correlation or metric value for the gene at rank $i$.\n- $NR$ is defined as $NR = \\sum_{g \\in \\mathcal{S}} |r_g|^p$.\n- If the $i$-th gene is not in $\\mathcal{S}$ (a \"miss\"), the decrement is $1/(N - N_H)$.\n- The Enrichment Score is $ES = \\max_{1 \\le i \\le N} R(i)$.\n- The initial condition is implicitly $R(0)=0$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on the well-established Gene Set Enrichment Analysis (GSEA) methodology. The setup with a single-gene set ($N_H=1$) is a simplification that renders the problem analytically tractable, but does not violate any fundamental principles. The problem is well-posed and objective.\n\nA potential ambiguity regarding the correlation values $r_i$ is resolved by careful inspection of the definitions. Since the gene set $\\mathcal{S}$ contains only one gene, which is at rank $k$, let its associated metric value be $r_k$. The normalization factor $NR$ is then $NR = \\sum_{g \\in \\mathcal{S}} |r_g|^p = |r_k|^p$. The increment for a hit, which occurs only at step $i=k$, is calculated as $|r_k|^p / NR = |r_k|^p / |r_k|^p = 1$. This holds for $p > 0$ under the reasonable assumption that the metric value $r_k$ is non-zero. For the case $p=0$, which corresponds to the unweighted GSEA statistic, the increment is $|r_k|^0 / NR = 1 / \\sum_{g \\in \\mathcal{S}} |r_g|^0 = 1 / N_H = 1/1 = 1$. Thus, for any $p \\ge 0$, the increment at a hit is precisely $1$.\n\nThe decrement for a miss is given by $1/(N-N_H)$. With $N_H=1$, this is $1/(N-1)$. This term is undefined if $N=1$. However, if $N=1$, then $N_H=1$ and the set of \"misses\" is empty. The problem implicitly assumes $N > 1$ for the decrement step to be meaningful, which is a standard condition in such analyses. The problem is therefore deemed self-contained and consistent.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation of the Solution**\nWe define the running sum $R(i)$ starting from $R(0)=0$. The change in the running sum at each step $j \\in \\{1, 2, \\dots, N\\}$ is $\\Delta_j$.\nA \"hit\" occurs only at rank $i=k$. The increment is $\\Delta_k = 1$.\nA \"miss\" occurs at any rank $i \\neq k$. The decrement is $-\\frac{1}{N-N_H}$. Since $N_H=1$, the decrement is $-\\frac{1}{N-1}$.\nSo, $\\Delta_j = 1$ if $j=k$, and $\\Delta_j = -\\frac{1}{N-1}$ if $j \\neq k$.\n\nThe running sum at step $i$ is given by $R(i) = \\sum_{j=1}^{i} \\Delta_j$. We analyze $R(i)$ in three cases based on the value of $i$ relative to $k$.\n\nCase 1: $1 \\le i < k$.\nIn this range, every step is a \"miss\".\n$$R(i) = \\sum_{j=1}^{i} \\left(-\\frac{1}{N-1}\\right) = i \\left(-\\frac{1}{N-1}\\right) = -\\frac{i}{N-1}$$\nSince $i \\ge 1$ and $N > 1$, all values of $R(i)$ in this range are negative. The function is strictly decreasing with $i$. The value just before the hit is $R(k-1) = -\\frac{k-1}{N-1}$.\n\nCase 2: $i=k$.\nThe running sum includes $k-1$ misses and one hit at step $k$.\n$$R(k) = R(k-1) + \\Delta_k = -\\frac{k-1}{N-1} + 1 = \\frac{-(k-1) + (N-1)}{N-1} = \\frac{N-k}{N-1}$$\nSince $1 \\le k \\le N$, we have $0 \\le N-k \\le N-1$, so $0 \\le R(k) \\le 1$.\n\nCase 3: $k < i \\le N$.\nThe running sum at step $i$ is the sum at step $k$ plus the decrements for all steps from $k+1$ to $i$. There are $i-k$ such steps, all of which are misses.\n$$R(i) = R(k) + \\sum_{j=k+1}^{i} \\left(-\\frac{1}{N-1}\\right) = R(k) - \\frac{i-k}{N-1}$$\nSubstituting the expression for $R(k)$:\n$$R(i) = \\frac{N-k}{N-1} - \\frac{i-k}{N-1} = \\frac{(N-k) - (i-k)}{N-1} = \\frac{N-i}{N-1}$$\nFor this range $k < i \\le N$, as $i$ increases, $N-i$ decreases, so $R(i)$ is a strictly decreasing function of $i$. The sequence of values starts at $R(k+1) = \\frac{N-(k+1)}{N-1}$ and ends at $R(N) = \\frac{N-N}{N-1}=0$.\n\nTo find the Enrichment Score, $ES = \\max_{1 \\le i \\le N} R(i)$, we must find the maximum value among the expressions for $R(i)$.\n- For $1 \\le i < k$, $R(i) = -i/(N-1) < 0$.\n- For $i \\ge k$, $R(i) = (N-i)/(N-1)$ for $i>k$ and $R(k)=(N-k)/(N-1)$. Since $i>k$, $N-i < N-k$, which implies $R(i) < R(k)$ for all $i > k$ (assuming $N-1>0$).\nThe sequence of values $R(i)$ for $i \\ge k$ is $R(k), R(k+1), \\dots, R(N)$, which is a strictly decreasing sequence.\nThus, the maximum value in the range $i \\ge k$ is $R(k)$.\nSince all values for $i<k$ are negative and $R(k) \\ge 0$, the global maximum over $1 \\le i \\le N$ must be $R(k)$.\n\nTherefore, the Enrichment Score is:\n$$ES = R(k) = \\frac{N-k}{N-1}$$\nThis expression is a closed-form function dependent only on $N$ and $k$, as required.\nFor verification, if the gene is ranked first ($k=1$), $ES = \\frac{N-1}{N-1} = 1$, the maximum possible score. If the gene is ranked last ($k=N$), $ES = \\frac{N-N}{N-1} = 0$. In this case, $R(i) = -i/(N-1)$ for $i < N$, all negative, and $R(N)=0$, so the maximum is indeed $0$. The result is consistent.",
            "answer": "$$\\boxed{\\frac{N-k}{N-1}}$$"
        }
    ]
}