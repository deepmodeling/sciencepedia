{
    "hands_on_practices": [
        {
            "introduction": "位置权重矩阵（PWM）是基序表示的基石，但其概率细节可能很复杂。本练习要求您使用Kullback-Leibler散度来量化将PWM简化为更紧凑的简并码时所损失的信息。掌握此方法能让您在模型表示以及模型复杂性与可解释性之间的权衡方面做出明智的决策。",
            "id": "4576688",
            "problem": "一个转录因子结合基序由一个位置权重矩阵（PWM）来概括，其中每一列是关于四种脱氧核糖核苷酸碱基的分类概率分布。设一个长度为$5$的基序的PWM由以下各位置的概率 $\\{p_i(A), p_i(C), p_i(G), p_i(T)\\}$ 指定：\n- 位置 $1$：$p_1(A)=0.7$，$p_1(C)=0.3$，$p_1(G)=0$，$p_1(T)=0$。\n- 位置 $2$：$p_2(A)=0.4$，$p_2(C)=0.6$，$p_2(G)=0$，$p_2(T)=0$。\n- 位置 $3$：$p_3(A)=0$，$p_3(C)=0.5$，$p_3(G)=0.5$，$p_3(T)=0$。\n- 位置 $4$：$p_4(A)=0.1$，$p_4(C)=0.1$，$p_4(G)=0.8$，$p_4(T)=0$。\n- 位置 $5$：$p_5(A)=0.25$，$p_5(C)=0$，$p_5(G)=0.25$，$p_5(T)=0.5$。\n\n将位置 $i$ 处的共有碱基定义为 $c_i=\\arg\\max_{a\\in\\{A,C,G,T\\}} p_i(a)$，相同时选择字典序最小的碱基。使用概率阈值 $\\tau=0.1$，通过构建允许集 $S_i=\\{a\\in\\{A,C,G,T\\}: p_i(a)\\ge \\tau\\}$ 并选择能精确编码 $S_i$ 中所有碱基的国际纯粹与应用化学联合会（IUPAC）字母，将每个位置映射到一个IUPAC简并码。为了量化信息，将简并码表示近似为一个独立乘积分布 $q=\\prod_{i=1}^{5} q_i$，其中对于 $a\\in S_i$，有 $q_i(a)=\\frac{1}{|S_i|}$；对于 $a\\notin S_i$，有 $q_i(a)=0$。\n\n从分类分布和Kullback–Leibler散度（KLD）的核心定义出发，通过计算总散度\n$$L=\\sum_{i=1}^{5} D\\!\\left(p_i \\,\\|\\, q_i\\right),$$\n其中\n$$D\\!\\left(p_i \\,\\|\\, q_i\\right)=\\sum_{a\\in\\{A,C,G,T\\}} p_i(a)\\,\\log_{2}\\!\\left(\\frac{p_i(a)}{q_i(a)}\\right),$$\n量化将PWM压缩成简并码分布时丢失的信息，并约定当 $p_i(a)=0$ 时，该项贡献为 $0$。将 $L$ 的最终数值四舍五入到四位有效数字。以比特为单位表示最终结果。",
            "solution": "本题要求计算将位置权重矩阵（PWM）模型 $p$ 近似为简并码分布 $q$ 时的总信息损失，该损失由Kullback–Leibler散度（KLD）量化。总散度 $L$ 是各位置散度的总和：\n$$L = \\sum_{i=1}^{5} D(p_i \\,\\|\\, q_i)$$\n其中 $p_i$ 是位置 $i$ 的原始概率分布，而 $q_i$ 是在允许碱基集 $S_i$ 上的近似均匀分布。每个位置的KLD定义为：\n$$D(p_i \\,\\|\\, q_i) = \\sum_{a \\in \\{\\text{A,C,G,T}\\}} p_i(a) \\log_{2}\\left(\\frac{p_i(a)}{q_i(a)}\\right)$$\n对于 $p_i(a)=0$ 的项，使用约定 $0 \\log_{2}(0/q) = 0$。\n\n近似分布 $q_i$ 是基于允许集 $S_i = \\{a \\in \\{\\text{A,C,G,T}\\} : p_i(a) \\ge \\tau\\}$ 定义的，阈值为 $\\tau=0.1$。分布 $q_i$ 在该集合上是均匀的：如果 $a \\in S_i$，则 $q_i(a) = \\frac{1}{|S_i|}$；否则 $q_i(a)=0$。\n\n我们可以简化KLD表达式。对于 $a \\notin S_i$，有 $q_i(a)=0$。KLD的公式仅当 $p_i$ 的支撑集是 $q_i$ 的支撑集的子集时才有良好定义。在我们的情况下，对于任何使得 $p_i(a) > 0$ 的碱基 $a$，必然有 $p_i(a) \\ge 0.1$，因此 $a \\in S_i$。所以，求和可以限制在 $a \\in S_i$ 上。\n\\begin{align*} D(p_i \\,\\|\\, q_i) = \\sum_{a \\in S_i} p_i(a) \\log_{2}\\left(\\frac{p_i(a)}{1/|S_i|}\\right) \\\\ = \\sum_{a \\in S_i} p_i(a) \\left( \\log_{2}(p_i(a)) - \\log_{2}\\left(\\frac{1}{|S_i|}\\right) \\right) \\\\ = \\sum_{a \\in S_i} p_i(a) \\log_{2}(p_i(a)) + \\sum_{a \\in S_i} p_i(a) \\log_{2}(|S_i|) \\\\ = \\sum_{a \\in S_i} p_i(a) \\log_{2}(p_i(a)) + \\log_{2}(|S_i|) \\sum_{a \\in S_i} p_i(a)\\end{align*}\n由于每个分布 $p_i$ 的支撑集完全包含在相应的集合 $S_i$ 中，我们有 $\\sum_{a \\in S_i} p_i(a) = 1$。表达式简化为：\n$$ D(p_i \\,\\|\\, q_i) = \\log_{2}(|S_i|) + \\sum_{a \\in \\{\\text{A,C,G,T}\\}} p_i(a) \\log_{2}(p_i(a)) $$\n注意到香农熵 $H(p_i) = -\\sum_{a} p_i(a) \\log_{2}(p_i(a))$，散度为：\n$$ D(p_i \\,\\|\\, q_i) = \\log_{2}(|S_i|) - H(p_i) $$\n我们现在为每个位置 $i=1, \\dots, 5$ 计算这个值。\n\n**位置 1：**\n- 概率：$p_1(A)=0.7$，$p_1(C)=0.3$，$p_1(G)=0$，$p_1(T)=0$。\n- 使用 $\\tau=0.1$ 的允许集：$S_1 = \\{A, C\\}$，因为 $p_1(A) \\ge 0.1$ 且 $p_1(C) \\ge 0.1$。\n- 允许集的大小：$|S_1|=2$。\n- 香农熵：$H(p_1) = -(0.7 \\log_{2}(0.7) + 0.3 \\log_{2}(0.3)) \\approx 0.88129 \\text{ 比特}$。\n- 散度：$D(p_1 \\,\\|\\, q_1) = \\log_{2}(2) - H(p_1) = 1 - 0.88129 = 0.11871 \\text{ 比特}$。\n\n**位置 2：**\n- 概率：$p_2(A)=0.4$，$p_2(C)=0.6$，$p_2(G)=0$，$p_2(T)=0$。\n- 允许集：$S_2 = \\{A, C\\}$。\n- 大小：$|S_2|=2$。\n- 香农熵：$H(p_2) = -(0.4 \\log_{2}(0.4) + 0.6 \\log_{2}(0.6)) \\approx 0.97095 \\text{ 比特}$。\n- 散度：$D(p_2 \\,\\|\\, q_2) = \\log_{2}(2) - H(p_2) = 1 - 0.97095 = 0.02905 \\text{ 比特}$。\n\n**位置 3：**\n- 概率：$p_3(A)=0$，$p_3(C)=0.5$，$p_3(G)=0.5$，$p_3(T)=0$。\n- 允许集：$S_3 = \\{C, G\\}$。\n- 大小：$|S_3|=2$。\n- 香农熵：$H(p_3) = -(0.5 \\log_{2}(0.5) + 0.5 \\log_{2}(0.5)) = -(0.5 \\times (-1) + 0.5 \\times (-1)) = 1 \\text{ 比特}$。\n- 散度：$D(p_3 \\,\\|\\, q_3) = \\log_{2}(2) - H(p_3) = 1 - 1 = 0 \\text{ 比特}$。这是预料之中的，因为 $p_3$ 已经在 $S_3$ 上是均匀分布，所以 $p_3=q_3$。\n\n**位置 4：**\n- 概率：$p_4(A)=0.1$，$p_4(C)=0.1$，$p_4(G)=0.8$，$p_4(T)=0$。\n- 允许集：$S_4 = \\{A, C, G\\}$，因为 $p_4(A)$、$p_4(C)$ 和 $p_4(G)$ 都 $\\ge 0.1$。\n- 大小：$|S_4|=3$。\n- 香农熵：$H(p_4) = -(0.1 \\log_{2}(0.1) + 0.1 \\log_{2}(0.1) + 0.8 \\log_{2}(0.8)) \\approx 0.92193 \\text{ 比特}$。\n- 散度：$D(p_4 \\,\\|\\, q_4) = \\log_{2}(3) - H(p_4) \\approx 1.58496 - 0.92193 = 0.66303 \\text{ 比特}$。\n\n**位置 5：**\n- 概率：$p_5(A)=0.25$，$p_5(C)=0$，$p_5(G)=0.25$，$p_5(T)=0.5$。\n- 允许集：$S_5 = \\{A, G, T\\}$。\n- 大小：$|S_5|=3$。\n- 香农熵：$H(p_5) = -(0.25 \\log_{2}(0.25) + 0.25 \\log_{2}(0.25) + 0.5 \\log_{2}(0.5)) = -(2 \\times 0.25 \\times (-2) + 0.5 \\times (-1)) = 1.5 \\text{ 比特}$。\n- 散度：$D(p_5 \\,\\|\\, q_5) = \\log_{2}(3) - H(p_5) \\approx 1.58496 - 1.5 = 0.08496 \\text{ 比特}$。\n\n最后，总信息损失 $L$ 是各个散度的总和：\n$$L = D(p_1 \\,\\|\\, q_1) + D(p_2 \\,\\|\\, q_2) + D(p_3 \\,\\|\\, q_3) + D(p_4 \\,\\|\\, q_4) + D(p_5 \\,\\|\\, q_5)$$\n$$L \\approx 0.11871 + 0.02905 + 0 + 0.66303 + 0.08496$$\n$$L \\approx 0.89575 \\text{ 比特}$$\n将结果四舍五入到四位有效数字，得到 $0.8958$。",
            "answer": "$$\\boxed{0.8958}$$"
        },
        {
            "introduction": "在整个基因组中搜索一个基序涉及对数百万个潜在位点进行测试，这会产生一个巨大的多重检验问题。本练习将指导您计算扫描DNA双链时的统计检验总数，并应用类Bonferroni校正来控制家族性错误率。这是评估任何全基因组序列分析统计显著性的基本技能。",
            "id": "4576676",
            "problem": "一个转录因子结合位点模型由一个位置权重矩阵 (Position Weight Matrix, PWM) 表示，其定义如下。对于脱氧核糖核酸 (deoxyribonucleic acid, DNA) 序列中长度为 $k$ 的一个窗口，其对数似然比分数 $S$ 的计算方法为：将特定位置的贡献值 $w_{i}(b_{i})$ 相加，其中碱基 $b_{i} \\in \\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$，位置 $i \\in \\{1,\\dots,k\\}$。贡献值 $w_{i}(b_{i}) = \\ln\\left(\\frac{p_{i}(b_{i})}{q(b_{i})}\\right)$，其中 $p_{i}(b)$ 是基序在位置 $i$ 的特定碱基概率，而 $q(b)$ 是在零假设模型下碱基 $b$ 的背景概率。在基因组背景演化的零假设模型下，每个位置超过阈值分数 $s^{\\star}$ 的尾部概率定义为 $p_{0} = \\mathbb{P}_{0}(S \\ge s^{\\star})$。假设在一阶马尔可夫背景下使用动态规划方法，对于一个长度 $k = 12$ 的 PWM，在分数阈值 $s^{\\star}$ 下得到的 $p_{0} = 4.12 \\times 10^{-8}$。\n\n您需要在一个长度为 $G = 3.0 \\times 10^{6}$ 碱基对的双链细菌基因组中扫描基序的出现。扫描方法是沿着正向链和反向互补链上的每一个可能的窗口滑动该 PWM。假设基因组是线性的，每个位置的打分都如上所述使用 PWM，并且重叠窗口之间的任何依赖关系不会使得基于联合界限的校正方法失效。同时假设，在零假设下，对于 $k=12$，自身反向互补的回文 $k$-mer 出现频率可以忽略不计，在计算独立试验次数时可以忽略它们。\n\n从 $k$-mer 枚举和多重检验的联合界限的基本定义出发，推导为什么扫描双链时的试验次数约等于扫描单链时的两倍。然后，计算在扫描双链时，在基因组中任意位置观察到至少一个窗口分数 $\\ge s^{\\star}$ 的类邦弗朗尼校正后的 $p$ 值。\n\n请明确说明您所考虑的总试验次数，然后以单一数字的形式给出校正后的 $p$ 值。将您的最终数值答案四舍五入至四位有效数字。最终答案以纯数字形式表示（无单位）。",
            "solution": "该问题要求两个主要推导：总试验次数（统计检验次数）和整个基因组扫描的校正后 $p$ 值。\n\n**1. 总试验次数的推导与计算**\n\n首先，我们确定在长度为 $G$ 的单条线性 DNA 链上的试验次数。一次试验包括对一个长度为 $k$ 的窗口进行打分。一个长度为 $k$ 的窗口（一个 $k$-mer）可以从位置 $1$ 开始，直到最后一个能够形成完整 $k$-mer 的位置。最后一个可能的起始位置是 $G - k + 1$，它对应的窗口跨越从 $G-k+1$ 到 $G$ 的碱基。因此，单链上不同窗口的数量，也就是试验次数为：\n$$N_{single} = G - k + 1$$\n\n问题指定要扫描一个双链基因组，这包括正向链及其反向互补链。\n-   正向链长度为 $G$。正向链上的试验次数是 $N_{forward} = G - k + 1$。\n-   反向互补链的长度也是 $G$。为了扫描它，我们读取其序列并应用 PWM。长度为 $k$ 的窗口数量也是 $N_{reverse} = G - k + 1$。\n\n为了求得总试验次数 $N_{trials}$，我们必须将两条链的试验次数相加。然而，我们必须考虑是否有任何试验是冗余的。正向链窗口上的一次试验与相应的反向互补窗口上的一次试验是不同的，除非该序列本身是一个自身反向互补的回文序列（例如，6-mer `GTATAC` 的反向互补序列是 `GTATAC`）。在这种回文情况下，扫描正向链窗口和反向互补窗口将构成对完全相同的序列进行测试，从而导致冗余测试。\n\n问题通过陈述明确解决了这一点：“假设，在零假设下，对于 $k=12$，自身反向互补的回文 $k$-mer 出现频率可以忽略不计，在计算独立试验次数时可以忽略它们。”这个假设指导我们将正向链上的窗口集合与反向互补链上的窗口集合视为不相交的。\n\n因此，总的独立试验次数是两条链上试验次数的总和：\n$$N_{trials} = N_{forward} + N_{reverse} = (G - k + 1) + (G - k + 1) = 2(G - k + 1)$$\n\n这个推导解释了为什么与单链扫描相比，扫描双链会使试验次数加倍，$N_{trials} = 2 \\times N_{single}$。在问题提示中使用“约”是合理的，因为在实践中，对于一个大基因组，$G \\gg k$，这意味着 $G - k + 1 \\approx G$。因此，$N_{trials} \\approx 2G$，这是单链近似值 $N_{single} \\approx G$ 的两倍。\n\n现在，我们使用给定的值 $G = 3.0 \\times 10^{6}$ 和 $k = 12$ 来计算确切的总试验次数：\n$$N_{trials} = 2(3.0 \\times 10^{6} - 12 + 1) = 2(3,000,000 - 11) = 2(2,999,989)$$\n$$N_{trials} = 5,999,978$$\n总试验次数为 $5,999,978$。\n\n**2. 校正后 p 值的推导与计算**\n\n我们正在进行 $N_{trials} = 5,999,978$ 次假设检验，每个窗口一次。每次检验的零假设是窗口中的序列是由背景模型生成的。在零假设下，单次检验产生分数 $S \\ge s^{\\star}$ 的概率给定为 $p_{0} = 4.12 \\times 10^{-8}$。\n\n我们需要找到“在基因组中任意位置观察到至少一个窗口分数 $\\ge s^{\\star}$ 的类邦弗朗尼校正后的 $p$ 值”。这就是总体错误率 (family-wise error rate, FWER)，即在所有检验中犯一次或多次 I 型错误（假阳性）的概率。设 $E_j$ 为第 $j$ 个窗口的分数 $S_j \\ge s^{\\star}$ 的事件。FWER 为 $\\mathbb{P}(\\cup_{j=1}^{N_{trials}} E_j)$。\n\n问题指导我们使用“基于联合界限的校正”。联合界限，也称为布尔不等式 (Boole's inequality)，对于任意事件集合 $E_1, E_2, \\dots, E_N$ 陈述如下：\n$$\\mathbb{P}\\left(\\bigcup_{j=1}^{N} E_j\\right) \\le \\sum_{j=1}^{N} \\mathbb{P}(E_j)$$\n这个不等式在事件之间存在任何依赖关系时都成立。问题中“重叠窗口之间的任何依赖关系不会使得基于联合界限的校正方法失效”的假设是应用此界限的直接指令。\n\n使用联合界限，我们可以将基因组中至少出现一次匹配的概率（我们记为 $p_{adj}$）近似为一个上界：\n$$p_{adj} \\approx \\mathbb{P}\\left(\\bigcup_{j=1}^{N_{trials}} E_j\\right) \\le \\sum_{j=1}^{N_{trials}} \\mathbb{P}(E_j)$$\n因为对于所有的 $j$，$\\mathbb{P}(E_j) = p_0$，所以总和变为：\n$$p_{adj} \\le N_{trials} \\cdot p_0$$\n这个乘积 $N_{trials} \\cdot p_0$ 是用于 FWER 的标准邦弗朗尼校正。这就是问题所要求的量。\n\n我们现在代入数值：\n-   $N_{trials} = 5,999,978$\n-   $p_0 = 4.12 \\times 10^{-8}$\n\n$$p_{adj} = 5,999,978 \\times (4.12 \\times 10^{-8})$$\n$$p_{adj} = 0.2471990936$$\n\n问题要求最终数值答案四舍五入至四位有效数字。\n$$p_{adj} \\approx 0.2472$$",
            "answer": "$$\n\\boxed{0.2472}\n$$"
        },
        {
            "introduction": "对大型基因组进行详尽的k-mer分析在计算上是不可行的，因此需要像Minimizer这样的巧妙采样策略。这个高级练习要求您推导Minimizer方案的核心属性，包括其采样密度以及由此产生的计算速度和检测敏锐度（召回率）之间的权衡。理解这种强大的启发式方法是设计和实现高效现代基因组算法的关键。",
            "id": "4576693",
            "problem": "考虑一个长的脱氧核糖核酸 (DNA) 序列和一个固定的整数 $k \\geq 1$。一个 $k$-mer 被定义为任意长度为 $k$ 的连续子串。一个用于稀疏 $k$-mer 采样的 minimizer 方案操作如下：通过一个哈希函数 $h$ 为每个 $k$-mer 分配一个哈希值，该函数将 $k$-mer 映射到 $[0,1]$ 上的独立同分布连续随机变量；对于每个包含 $w$ 个连续 $k$-mer 的滑动窗口（其中 $w \\geq 2$），选择窗口中哈希值最小的 $k$-mer 的位置作为该窗口的代表，若哈希值相同则选择最左边的位置。这样就得到一个称为 minimizer 的位置子集。\n\n您将分析 minimizer 的期望密度，以及使用位置权重矩阵 (PWM) 进行基序（motif）扫描时，在准确性与速度之间的权衡。\n\n从独立同分布连续随机变量和基本次序统计量的基本定义出发，并且不引用任何关于 minimizer 的预先推导出的结果，完成以下任务：\n\n- 在 $k$-mer 数量远大于 $w$ 的渐近情况下，对于一个长随机序列，根据上述假设，推导出所有 $k$-mer 位置中被选为 minimizer 的期望比例 $d(w)$。\n\n- 考虑使用一个长度为 $L$（核苷酸数量）的位置权重矩阵 (PWM) 扫描转录因子结合位点，在真实的基序起始位置进行 PWM 评估会以概率 $q \\in (0,1)$ 返回一个真阳性，并且在本分析中可以忽略假阳性。假设我们不扫描每个可能的起始位置，而是只在 minimizer 方案标记的位置评估 PWM。对于单个长度为 $L$ 的真实基序，将其被“捕获”的事件建模为：在其 $m = L - k + 1$ 个（当 $L \\geq k$ 时）重叠的 $k$-mer 中，至少有一个被选为 minimizer。假设这 $m$ 个选择事件是相互独立的。推导期望召回率 $\\mathcal{R}(w)$，将其表示为 $w$、$L$、$k$ 和 $q$ 的函数。\n\n- 量化速度提升因子 $\\mathcal{S}(w)$，其定义为穷举扫描所需的 PWM 评估次数与基于 minimizer 的扫描所需的评估次数之比。假设计算成本主要由 PWM 评估主导，且每次评估的成本相等。在 $n \\gg L,k$ 的渐近情况下（其中 $n$ 是序列的长度，单位为核苷酸），用 $d(w)$ 表示 $\\mathcal{S}(w)$。\n\n- 现在设置 $k = 15$、$L = 21$ 和 $q = 0.92$。施加期望召回率必须至少为 $\\rho_{\\min} = 0.85$ 的约束。在所有满足 $\\mathcal{R}(w) \\geq \\rho_{\\min}$ 的整数 $w \\geq 2$ 中，选择能使速度最大化的最大 $w$ 值，并报告该整数值。无需四舍五入；请给出确切的整数。",
            "solution": "问题分为四个部分，将按顺序进行解答。\n\n**第一部分：minimizer 密度 $d(w)$ 的推导**\n\n我们被要求推导被选为 minimizer 的 $k$-mer 位置所占的期望比例 $d(w)$。问题陈述哈希函数 $h$ 将 $k$-mer 映射到区间 $[0,1]$ 上的独立同分布（i.i.d.）连续随机变量。\n\n让我们考虑一个非常长的 $k$-mer 序列，按其起始位置 $i=1, 2, 3, \\ldots$ 进行索引。设 $H_i = h(k_i)$ 是位置 $i$ 处的 $k$-mer 的哈希值。哈希值序列 $\\{H_i\\}$ 是一个 i.i.d. 连续随机变量序列。由于是连续分布，任意两个哈希值相等的概率为零，因此我们可以忽略哈希值相同的情况。\n\n在长序列的渐近极限下，minimizer 的密度 $d(w)$ 可以解释为当大小为 $w$ 的窗口向右滑动一个位置时，新选出一个 minimizer 的概率。\n\n考虑两个相邻的 $k$-mer 窗口：$W_j = \\{k_j, k_{j+1}, \\dots, k_{j+w-1}\\}$ 和 $W_{j+1} = \\{k_{j+1}, k_{j+2}, \\dots, k_{j+w}\\}$。如果窗口 $W_{j+1}$ 中最小哈希值的位置与窗口 $W_j$ 中最小哈希值的位置不同，则方案会选择一个新的 minimizer。让我们分析这个事件的概率。\n\n这两个相邻窗口涉及的所有 $k$-mer 的集合是 $\\{k_j, k_{j+1}, \\dots, k_{j+w}\\}$。这个集合包含 $w+1$ 个 $k$-mer。设它们对应的哈希值为 $\\{H_j, H_{j+1}, \\dots, H_{j+w}\\}$。由于这是 $w+1$ 个 i.i.d. 连续随机变量，它们中的任何一个成为整个集合中最小值的可能性是相等的。任何特定的 $H_i$ 是该集合最小值的概率是 $\\frac{1}{w+1}$。\n\n让我们分析 minimizer 的位置何时发生变化：\n1.  如果 $H_j$ 是所有 $w+1$ 个哈希值 $\\{H_j, \\dots, H_{j+w}\\}$ 中的最小值，那么窗口 $W_j$ 中的 minimizer 必定在位置 $j$。窗口 $W_{j+1}$ 不包含位置 $j$，所以它的 minimizer 必定在不同的位置。因此，minimizer 的位置发生改变。此事件的概率为 $\\frac{1}{w+1}$。\n2.  如果 $H_{j+w}$ 是所有 $w+1$ 个哈希值中的最小值，那么窗口 $W_{j+1}$ 中的 minimizer 在位置 $j+w$。窗口 $W_j$ 中的 minimizer 必定在 $\\{j, \\dots, j+w-1\\}$ 中的某个位置，这与 $j+w$ 不同。因此，minimizer 的位置发生改变。此事件的概率也为 $\\frac{1}{w+1}$。\n3.  如果所有 $w+1$ 个哈希值中的最小值是某个 $i \\in \\{j+1, \\dots, j+w-1\\}$ 的 $H_i$，那么 $H_i$ 同时是窗口 $W_j$（因为 $H_i  H_j$）和窗口 $W_{j+1}$（因为 $H_i  H_{j+w}$）中的最小值。在这种情况下，两个窗口的 minimizer 都在相同的位置 $i$。位置不发生改变。这种情况的概率是 $w-1$ 个可能位置的概率之和，即 $\\frac{w-1}{w+1}$。\n\n当窗口滑动时，minimizer 位置改变的概率是前两种互斥情况的概率之和。这个概率就是 minimizer 的密度。\n$$d(w) = P(\\text{position changes}) = \\frac{1}{w+1} + \\frac{1}{w+1} = \\frac{2}{w+1}$$\n\n**第二部分：期望召回率 $\\mathcal{R}(w)$ 的推导**\n\n期望召回率 $\\mathcal{R}(w)$ 是成功检测到真实基序的概率。检测是一个两步过程：minimizer 方案必须首先“捕获”该基序，然后 PWM 评估必须产生一个真阳性结果。\n\n一个长度为 $L$ 的真实基序包含 $m = L-k+1$ 个重叠的 $k$-mer。问题将“捕获”定义为这 $m$ 个 $k$-mer 中至少有一个被选为 minimizer 的事件。任何给定的 $k$-mer 是 minimizer 的概率是 $d(w) = \\frac{2}{w+1}$。\n\n问题指导我们假设，覆盖该基序的 $m$ 个不同 $k$-mer 的选择事件是独立的。设 $p_{min} = d(w)$ 是单个 $k$-mer 是 minimizer 的概率。那么单个 $k$-mer *不是* minimizer 的概率是 $1-p_{min}$。\n\n捕获概率 $P(\\text{capture})$ 是指 $m$ 个 $k$-mer 中至少有一个是 minimizer 的概率。计算其补集事件会更简单：即 $m$ 个 $k$-mer 都不是 minimizer 的概率。\n$$P(\\text{capture}) = 1 - P(\\text{none of the } m \\text{ k-mers are minimizers})$$\n根据独立性假设：\n$$P(\\text{capture}) = 1 - (P(\\text{a single k-mer is not a minimizer}))^m = 1 - (1 - p_{min})^m$$\n代入 $p_{min} = d(w) = \\frac{2}{w+1}$：\n$$P(\\text{capture}) = 1 - \\left(1 - \\frac{2}{w+1}\\right)^m = 1 - \\left(\\frac{w+1-2}{w+1}\\right)^m = 1 - \\left(\\frac{w-1}{w+1}\\right)^m$$\n如果基序被捕获，则会执行一次 PWM 评估。我们假设此过程允许在真实基序的起始位置进行评估，并以概率 $q$ 产生真阳性结果。总的检测概率，即召回率 $\\mathcal{R}(w)$，是捕获概率与 PWM 测试成功概率的乘积。\n$$\\mathcal{R}(w) = q \\times P(\\text{capture}) = q \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^m \\right]$$\n代入 $m=L-k+1$：\n$$\\mathcal{R(w)} = q \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^{L-k+1} \\right]$$\n\n**第三部分：速度提升因子 $\\mathcal{S}(w)$ 的推导**\n\n速度提升因子 $\\mathcal{S}(w)$ 是穷举扫描中的 PWM 评估次数与基于 minimizer 的扫描中的评估次数之比。\n\n设 DNA 序列的总长度为 $n$ 个核苷酸。对于穷举扫描，长度为 $L$ 的 PWM 会在每个可能的起始位置进行评估。这样的位置数量为 $n - L + 1$。在 $n \\gg L$ 的渐近情况下，评估次数约等于 $n$。\n$$N_{\\text{exhaustive}} \\approx n$$\n对于基于 minimizer 的扫描，PWM 仅在被标记为 minimizer 的位置进行评估。长度为 $n$ 的序列中 $k$-mer 的数量是 $n-k+1$，在 $n \\gg k$ 的情况下约等于 $n$。这些 $k$-mer 位置中被选为 minimizer 的期望比例是 $d(w)$。因此，期望的 PWM 评估次数为：\n$$N_{\\text{minimizer}} \\approx n \\cdot d(w)$$\n速度提升因子是其比值：\n$$\\mathcal{S}(w) = \\frac{N_{\\text{exhaustive}}}{N_{\\text{minimizer}}} \\approx \\frac{n}{n \\cdot d(w)} = \\frac{1}{d(w)}$$\n代入 $d(w)$ 的表达式：\n$$\\mathcal{S}(w) = \\frac{1}{\\frac{2}{w+1}} = \\frac{w+1}{2}$$\n\n**第四部分：最优窗口大小 $w$ 的计算**\n\n给定具体参数：$k=15$，$L=21$，以及 $q=0.92$。要求的最小期望召回率为 $\\rho_{\\min} = 0.85$。我们必须找到满足 $\\mathcal{R}(w) \\geq \\rho_{\\min}$ 的最大整数 $w \\geq 2$。最大化 $w$ 即可最大化速度提升 $\\mathcal{S}(w) = \\frac{w+1}{2}$。\n\n首先，我们计算与基序重叠的 $k$-mer 数量 $m$：\n$$m = L - k + 1 = 21 - 15 + 1 = 7$$\n召回率约束为：\n$$\\mathcal{R}(w) = 0.92 \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^7 \\right] \\geq 0.85$$\n对于 $w \\geq 2$，项 $\\frac{w-1}{w+1} = 1 - \\frac{2}{w+1}$ 是 $w$ 的单调递增函数。因此，$\\left(\\frac{w-1}{w+1}\\right)^7$ 也是递增的，$1-\\left(\\frac{w-1}{w+1}\\right)^7$ 是递减的，所以 $\\mathcal{R}(w)$ 是 $w$ 的单调递减函数。\n\n为了找到满足该不等式的最大整数 $w$，我们首先求解等式成立的边界情况：\n$$0.92 \\left[ 1 - \\left(\\frac{w-1}{w+1}\\right)^7 \\right] = 0.85$$\n$$1 - \\left(\\frac{w-1}{w+1}\\right)^7 = \\frac{0.85}{0.92} = \\frac{85}{92}$$\n$$\\left(\\frac{w-1}{w+1}\\right)^7 = 1 - \\frac{85}{92} = \\frac{7}{92}$$\n$$\\frac{w-1}{w+1} = \\left(\\frac{7}{92}\\right)^{1/7}$$\n令 $C = \\left(\\frac{7}{92}\\right)^{1/7}$。我们求解 $w$：\n$$w-1 = C(w+1)$$\n$$w-1 = Cw + C$$\n$$w - Cw = 1 + C$$\n$$w(1-C) = 1+C$$\n$$w = \\frac{1+C}{1-C}$$\n由于 $\\mathcal{R}(w)$ 是一个递减函数，不等式 $\\mathcal{R}(w) \\geq 0.85$ 对所有满足以下条件的 $w$ 成立：\n$$w \\leq \\frac{1+C}{1-C}$$\n我们需要计算这个表达式的值。\n$C = \\left(\\frac{7}{92}\\right)^{1/7} \\approx (0.076087)^{1/7} \\approx 0.69213$。\n$$w \\leq \\frac{1+0.69213}{1-0.69213} = \\frac{1.69213}{0.30787} \\approx 5.496$$\n问题要求找到满足此条件的最大整数 $w \\geq 2$。满足 $w \\leq 5.496$ 的整数集合是 $\\{..., 3, 4, 5\\}$。该集合中同时 $\\geq 2$ 的最大整数是 $5$。\n\n为了验证，我们检查 $w=5$ 和 $w=6$ 的情况：\n当 $w=5$ 时：\n$\\mathcal{R}(5) = 0.92 \\left[ 1 - \\left(\\frac{5-1}{5+1}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{4}{6}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{2}{3}\\right)^7 \\right] = 0.92 \\left[ 1 - \\frac{128}{2187} \\right] = 0.92 \\left[ \\frac{2059}{2187} \\right] \\approx 0.866 \\geq 0.85$。\n条件满足。\n\n当 $w=6$ 时：\n$\\mathcal{R}(6) = 0.92 \\left[ 1 - \\left(\\frac{6-1}{6+1}\\right)^7 \\right] = 0.92 \\left[ 1 - \\left(\\frac{5}{7}\\right)^7 \\right] = 0.92 \\left[ 1 - \\frac{78125}{823543} \\right] = 0.92 \\left[ \\frac{745418}{823543} \\right] \\approx 0.833  0.85$。\n条件不满足。\n\n因此，满足召回率要求的最大整数 $w$ 是 $5$。",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}