{
    "hands_on_practices": [
        {
            "introduction": "从头组装的成功与否在很大程度上取决于测序数据的质量和深度。在深入研究组装算法之前，我们必须首先理解测序覆盖度的基本概率原理。本练习将引导您从第一性原理推导Lander-Waterman模型的一个关键结果，该模型量化了基因组中任意碱基未被任何读长（read）覆盖的概率，从而揭示了测序深度与组装完整性之间的直接联系。",
            "id": "4552682",
            "problem": "一个长度为 $G$ 的连续基因组由 $N$ 个独立的、每个长度固定为 $L$ 的测序读长（reads）进行测序。假设读长的起始位置是独立的，并以相等的概率均匀分布在 $G$ 个可能的起始位点上，并且由于 $G \\gg L$，忽略边缘效应。在重叠-布局-一致性（Overlap-Layout-Consensus, OLC）和德布莱英图（de Bruijn graph）模型的从头组装（de novo assembly）背景下，一个基本量是名义测序覆盖度 $C$，定义为 $C = \\frac{N L}{G}$。仅使用核心概率定义以及连接二项分布与泊松分布的极限，从第一性原理推导基因组中任意一个碱基未被任何读长覆盖的概率表达式。用纯粹的 $C$ 来表示你的最终结果。根据此结果，简要解释在所述假设下，该概率对于重叠-布局-一致性（OLC）和德布莱英图框架中组装完整性的意义。您的最终答案必须是单一的封闭形式解析表达式，且无需四舍五入。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观且内部一致。它代表了测序理论中的一个经典问题。因此，我们可以着手解决。\n\n设 $G$ 为基因组长度，$N$ 为读长数量，$L$ 为每个读长的长度。名义测序覆盖度定义为 $C = \\frac{NL}{G}$。我们旨在寻找在读长起始位置独立且均匀分布于 $G$ 个可能起始位点的假设下，基因组中任意一个碱基未被 $N$ 个读长中任何一个覆盖的概率。$G \\gg L$ 的条件使我们可以忽略边缘效应。\n\n考虑基因组中特定位置的一个任意碱基。要使单个读长覆盖这个碱基，其起始位置必须落在一个特定的窗口内。一个长度为 $L$、起始于位置 $s$ 的读长覆盖基因组区间 $[s, s+L-1]$。要使这个读长覆盖我们位于位置 $k$ 的任意碱基，必须满足条件 $s \\le k \\le s+L-1$。这等价于起始位置 $s$ 处于范围 $k-L+1 \\le s \\le k$ 内。满足此条件的整数起始位置的数量是 $k - (k-L+1) + 1 = L$。\n\n问题陈述，对于任何给定的读长，有 $G$ 个可能的起始位点，且每个位点被选择的概率相等。因此，单个随机放置的读长覆盖我们特定碱基的概率 $p$ 是有利起始位置数与总可能起始位置数的比率：\n$$p = \\frac{L}{G}$$\n\n因此，单个读长*不*覆盖此特定碱基的概率是 $1-p$：\n$$1-p = 1 - \\frac{L}{G}$$\n\n问题陈述，$N$ 个读长是独立放置的。因此，一个碱基被一个读长覆盖的事件与被另一个读长覆盖的事件是独立的。该碱基未被 $N$ 个读长中任何一个覆盖的概率是每个读长不覆盖它的各个概率的乘积。设 $P_0$ 为未被覆盖（即覆盖度为零）的概率。这对应于 $N$ 次独立的伯努利试验，每次试验的“失败”概率为 $1-p$。\n$$P_0 = (1 - p)^N = \\left(1 - \\frac{L}{G}\\right)^N$$\n\n问题要求我们使用连接二项分布与泊松分布的极限。覆盖一个特定碱基的读长数量遵循二项分布 $B(N, p)$，其中 $N$ 是试验次数，$p = L/G$ 是单次试验中成功（覆盖）的概率。在典型的测序实验中，读长数量 $N$ 非常大（数百万到数十亿），并且由于 $G \\gg L$，概率 $p$ 非常小。在这个极限下，当 $N \\to \\infty$ 且 $p \\to 0$ 使得均值 $\\lambda = Np$ 保持不变时，二项分布可以被均值为 $\\lambda$ 的泊松分布精确近似。\n\n我们的任意碱基被覆盖的平均次数是：\n$$\\lambda = Np = N \\left(\\frac{L}{G}\\right) = \\frac{NL}{G}$$\n根据定义，这正是名义测序覆盖度 $C$。所以，$\\lambda = C$。\n\n泊松分布给出了观察到恰好 $k$ 个事件（在本例中为 $k$ 个读长覆盖该碱基）的概率：\n$$P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n我们感兴趣的是该碱基未被覆盖的概率，这对应于 $k=0$。将 $k=0$ 和 $\\lambda=C$ 代入泊松概率质量函数，我们得到：\n$$P_0 = P(k=0) = \\frac{C^0 \\exp(-C)}{0!}$$\n由于 $C^0 = 1$ 且 $0! = 1$，表达式简化为：\n$$P_0 = \\exp(-C)$$\n这就是基因组中任意一个碱基未被覆盖的概率，纯粹用名义覆盖度 $C$ 表示。\n\n这个结果对基因组组装的完整性具有直接而重要的意义。值 $\\exp(-C)$ 代表基因组中覆盖度为零部分的期望分数。\n\n在重叠-布局-一致性（OLC）框架中，组装通过寻找读长之间的重叠来构建更长的连续序列（重叠群，contigs）。如果基因组的某个片段覆盖度为零，那么测序数据中将不会存在源自该区域的读长。因此，将没有读长来桥接由两侧区域生成的重叠群之间的间隙。组装图将在这些点上断开，导致一个碎片化的组装结果。因此，数量 $\\exp(-C)$ 提供了一个因覆盖度间隙而导致最终组装中缺失的基因组比例的直接估计。\n\n在德布莱英图（DBG）框架中，所有读长都被分解为长度为 $k$ 的更小的重叠子序列（$k$-mers）。这些$k$-mers构成图的节点，边连接在读长中相邻的$k$-mers。一个完整且连续的组装对应于找到一条（或多条）遍历所有对应于真实基因组序列的边的路径。如果基因组的某个区域覆盖度为零，那么该区域所有独特的$k$-mers将在读长集合中缺失。这些缺失的$k$-mers会在德布莱英图中造成断裂，从而阻止重建单一的连续路径。因此，组装算法将输出多个不相交的重叠群，对应于图的连通分量。概率 $\\exp(-C)$ 作为遇到此类破坏组装的间隙可能性的一个强有力的代理指标，再次直接关系到组装的预期完整性。",
            "answer": "$$\\boxed{\\exp(-C)}$$"
        },
        {
            "introduction": "掌握了覆盖度理论后，下一步是了解如何将数百万个短读长拼接成连续的序列。现代从头组装主要依赖于德布莱英图（de Bruijn graph）和欧拉路径（Eulerian path）的概念。本练习提供了一个具体的微型组装场景，您将通过应用图论原理来确定一个给定的德布莱英图是否存在欧拉路径，并计算所有可能的组装结果数量，从而亲身体验组装过程中的核心计算挑战。",
            "id": "4552656",
            "problem": "考虑生物信息学和医学数据分析中的一个从头组装任务，该任务针对一个小型病原体质粒，使用由短读长序列构建的 de Bruijn 图进行建模。在此位点，字母表为脱氧核糖核酸 (DNA) 核苷酸，限制在 $\\{\\mathrm{A}, \\mathrm{T}\\}$ 范围内，组装在 $k=3$ 的条件下进行，因此顶点是 $(k-1)$-mers，边是 $k$-mers。给定观测到的 $k$-mers 的多重集（其重数由测序覆盖度产生）如下：\n$\\{\\mathrm{AAA}, \\mathrm{AAA}, \\mathrm{AAT}, \\mathrm{ATA}, \\mathrm{ATA}, \\mathrm{TAA}, \\mathrm{TAA}, \\mathrm{TAT}\\}$。\n构建一个有向 de Bruijn 图 $G$，其顶点为出现的所有不同 $(k-1)$-mers，其有向多重边表示给定的从前缀到后缀的 $k$-mers。得到的顶点集为 $\\{\\mathrm{AA}, \\mathrm{AT}, \\mathrm{TA}\\}$，边的多重集（及其计数）为：\n- 从 $\\mathrm{AA}$ 到 $\\mathrm{AA}$：$2$ 条边 (来自 $\\mathrm{AAA}$)，\n- 从 $\\mathrm{AA}$ 到 $\\mathrm{AT}$：$1$ 条边 (来自 $\\mathrm{AAT}$)，\n- 从 $\\mathrm{AT}$ 到 $\\mathrm{TA}$：$2$ 条边 (来自 $\\mathrm{ATA}$)，\n- 从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$：$2$ 条边 (来自 $\\mathrm{TAA}$)，\n- 从 $\\mathrm{TA}$ 到 $\\mathrm{AT}$：$1$ 条边 (来自 $\\mathrm{TAT}$)。\n\n这些边的计数意味着图 $G$ 的入度和出度如下：\n- $\\mathrm{outdeg}(\\mathrm{AA})=3$， $\\mathrm{indeg}(\\mathrm{AA})=4$，\n- $\\mathrm{outdeg}(\\mathrm{AT})=2$， $\\mathrm{indeg}(\\mathrm{AT})=2$，\n- $\\mathrm{outdeg}(\\mathrm{TA})=3$， $\\mathrm{indeg}(\\mathrm{TA})=2$。\n\n仅从 de Bruijn 图、有向图中的欧拉路径以及在组装中欧拉遍历存在的标准连通性要求的核心定义出发，判断 $G$ 是否存在欧拉路径。如果存在，请从第一性原理和经过充分检验的有向欧拉图计数结果出发，严格推导由 $G$ 中的欧拉路径可以拼出的不同序列的总数（每条不同的欧拉路径通过以尊重重叠的方式连接 $k$-mers 来拼写出一个序列）。请将最终答案表示为一个精确的整数。无需四舍五入。",
            "solution": "该问题要求计算从给定的$k$-mers多重集可以组装出的不同基因组序列的数量。这等价于在相应的 de Bruijn 图中寻找不同欧拉路径的数量。我们首先验证欧拉路径存在的条件，然后对其进行计数。\n\n设 $G(V, E)$ 为 de Bruijn 图，其中 $V$ 是 $(k-1)$-mers 的集合， $E$ 是$k$-mers的多重集。\n问题提供了以下信息：\n- 字母表为 $\\{\\mathrm{A}, \\mathrm{T}\\}$。\n- $k$-mer 长度为 $k=3$。\n- 顶点集为 $V = \\{\\mathrm{AA}, \\mathrm{AT}, \\mathrm{TA}\\}$。\n- 边的多重集（即观测到的 $k$-mers）共有 $8$ 条边。\n- 各顶点的入度和出度如下：\n  - 对于顶点 $\\mathrm{AA}$：$\\mathrm{outdeg}(\\mathrm{AA})=3$， $\\mathrm{indeg}(\\mathrm{AA})=4$。\n  - 对于顶点 $\\mathrm{AT}$：$\\mathrm{outdeg}(\\mathrm{AT})=2$， $\\mathrm{indeg}(\\mathrm{AT})=2$。\n  - 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}(\\mathrm{TA})=3$， $\\mathrm{indeg}(\\mathrm{TA})=2$。\n\n一个有向多重图存在欧拉路径，当且仅当：\n1. 其底层的无向图是连通的。\n2. 至多有一个顶点 $u$ 满足 $\\mathrm{outdeg}(u) - \\mathrm{indeg}(u) = 1$。\n3. 至多有一个顶点 $v$ 满足 $\\mathrm{indeg}(v) - \\mathrm{outdeg}(v) = 1$。\n4. 所有其他顶点 $w$ 满足 $\\mathrm{outdeg}(w) = \\mathrm{indeg}(w)$。\n\n首先，我们检查连通性。图中存在的边有 $\\mathrm{AA} \\to \\mathrm{AA}$, $\\mathrm{AA} \\to \\mathrm{AT}$, $\\mathrm{AT} \\to \\mathrm{TA}$, $\\mathrm{TA} \\to \\mathrm{AA}$ 和 $\\mathrm{TA} \\to \\mathrm{AT}$。我们可以在任意两个顶点之间找到路径，例如：$\\mathrm{AA} \\to \\mathrm{AT} \\to \\mathrm{TA} \\to \\mathrm{AA}$。这表明该图是强连通的，从而满足了连通性要求。\n\n接下来，我们检查度数：\n- 对于顶点 $\\mathrm{AA}$：$\\mathrm{indeg}(\\mathrm{AA}) - \\mathrm{outdeg}(\\mathrm{AA}) = 4 - 3 = 1$。\n- 对于顶点 $\\mathrm{AT}$：$\\mathrm{indeg}(\\mathrm{AT}) - \\mathrm{outdeg}(\\mathrm{AT}) = 2 - 2 = 0$。\n- 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}(\\mathrm{TA}) - \\mathrm{indeg}(\\mathrm{TA}) = 3 - 2 = 1$。\n\n欧拉路径存在的条件得到满足。恰好有一个顶点 $u = \\mathrm{TA}$ 的出度比入度多 $1$，恰好有一个顶点 $v = \\mathrm{AA}$ 的入度比出度多 $1$。所有其他顶点都是平衡的。因此，欧拉路径存在，并且它们都必须从 $\\mathrm{TA}$ 开始，到 $\\mathrm{AA}$ 结束。\n\n为了计算从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$ 的不同欧拉路径的数量，我们使用一种标准技巧。我们通过添加一条从终点顶点 $\\mathrm{AA}$ 到起始顶点 $\\mathrm{TA}$ 的“虚拟”边来增广图 $G$。我们将这个新图称为 $G'$。这个新图 $G'$ 现在是平衡的（即欧拉的），意味着对于所有顶点 $w \\in V$，都有 $\\mathrm{indeg}_{G'}(w) = \\mathrm{outdeg}_{G'}(w)$。\n$G'$ 中的度数为：\n- 对于顶点 $\\mathrm{AA}$：$\\mathrm{outdeg}_{G'}(\\mathrm{AA})=3+1=4$, $\\mathrm{indeg}_{G'}(\\mathrm{AA})=4$。\n- 对于顶点 $\\mathrm{AT}$：$\\mathrm{outdeg}_{G'}(\\mathrm{AT})=2$, $\\mathrm{indeg}_{G'}(\\mathrm{AT})=2$。\n- 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}_{G'}(\\mathrm{TA})=3$, $\\mathrm{indeg}_{G'}(\\mathrm{TA})=2+1=3$。\n\n$G$ 中从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$ 的欧拉路径与 $G'$ 中的欧拉回路存在一一对应关系。一个有向多重图中唯一欧拉回路的数量由 BEST 定理（de Bruijn、van Aardenne-Ehrenfest、Smith、Tutte）给出：\n$$N = t(G') \\prod_{w \\in V} (\\mathrm{indeg}_{G'}(w) - 1)!$$\n其中 $t(G')$ 是以任意选择的顶点为根的生成树状图的数量。\n\n首先，我们计算乘积项：\n$$ \\prod_w (\\mathrm{indeg}_{G'}(w) - 1)! = (\\mathrm{indeg}_{G'}(\\mathrm{AA}) - 1)! \\times (\\mathrm{indeg}_{G'}(\\mathrm{AT}) - 1)! \\times (\\mathrm{indeg}_{G'}(\\mathrm{TA}) - 1)! $$\n$$ = (4-1)! \\times (2-1)! \\times (3-1)! = 3! \\times 1! \\times 2! = 6 \\times 1 \\times 2 = 12 $$\n\n接下来，我们计算 $t(G')$，即生成树状图的数量。根据有向图的矩阵树定理，$t(G')$ 等于图 $G'$ 的拉普拉斯矩阵 $L'$ 的任何一个代数余子式。拉普拉斯矩阵定义为 $L' = D'_{out} - A'$，其中 $D'_{out}$ 是 $G'$ 的出度对角矩阵，$A'$ 是 $G'$ 的邻接矩阵。\n\n设顶点索引为 $1: \\mathrm{AA}$，$2: \\mathrm{AT}$，$3: \\mathrm{TA}$。$G'$ 的邻接矩阵 $A'$ (包括边的重数和虚拟边 $\\mathrm{AA} \\to \\mathrm{TA}$) 为：\n$$ A' = \\begin{pmatrix} 2  1  1 \\\\ 0  0  2 \\\\ 2  1  0 \\end{pmatrix} $$\n出度矩阵 $D'_{out}$ 为：\n$$ D'_{out} = \\begin{pmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} $$\n拉普拉斯矩阵 $L'$ 为：\n$$ L' = D'_{out} - A' = \\begin{pmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} - \\begin{pmatrix} 2  1  1 \\\\ 0  0  2 \\\\ 2  1  0 \\end{pmatrix} = \\begin{pmatrix} 2  -1  -1 \\\\ 0  2  -2 \\\\ -2  -1  3 \\end{pmatrix} $$\n树状图的数量 $t(G')$ 是 $L'$ 的任意一个代数余子式。我们计算 $(1,1)$-代数余子式：\n$$ C_{11} = (-1)^{1+1} \\det \\begin{pmatrix} 2  -2 \\\\ -1  3 \\end{pmatrix} = (2)(3) - (-2)(-1) = 6 - 2 = 4 $$\n所以，$t(G') = 4$。\n\n最后，$G$ 中欧拉路径的总数等于 $G'$ 中欧拉回路的数量，即：\n$$ N = t(G') \\times \\prod_w (\\mathrm{indeg}_{G'}(w) - 1)! = 4 \\times 12 = 48 $$\n每条不同的欧拉路径拼出一个唯一的核苷酸序列。因此，有 $48$ 种不同的序列可以被组装出来。",
            "answer": "$$\\boxed{48}$$"
        },
        {
            "introduction": "生成组装结果只是任务的一半，评估其质量同样至关重要。N50是衡量组装连续性（contiguity）的最常用指标之一，它反映了大部分组装序列的长度。本练习将指导您完成一个标准的生物信息学任务：根据一组给定的重叠群（contig）长度，从头计算N50值，从而掌握评估和比较不同组装策略结果的关键技能。",
            "id": "4552686",
            "problem": "从一个二倍体样本中，使用$k$-mer大小为$k=55$的德布莱英图方法生成了一个从头基因组组装，并在解决了气泡和移除了低覆盖度的末端后计算了重叠群（contig）。考虑从最终重叠群集合中收集到的组装重叠群长度（以碱基对为单位）：830124，710552，690121，540600，439820，415000，398657，372000，250300，240000，120000，95000。在从头基因组组装（重叠-布局-一致性（overlap-layout-consensus）和德布莱英图）中，$N50$统计量被定义为重叠群长度$L$，使得至少一半的总组装大小包含在长度大于或等于$L$的重叠群中。仅使用重叠群和$N50$统计量的标准、广泛接受的定义，从第一性原理推导出计算重叠群长度多重集的$N50$的算法过程，然后将其应用于给定的长度。明确描述排序和累加步骤，用数学方式定义阈值，并确定超过该阈值的最小重叠群长度。以碱基对的整数形式报告最终的$N50$长度。不要四舍五入；提供精确的整数。以碱基对表示最终结果。",
            "solution": "该问题要求根据一组给定的从头基因组组装的重叠群长度计算N50统计量。首先，我们必须按要求将N50统计量的定义形式化，并从第一性原理推导出其计算算法。\n\nN50统计量是衡量组装连续性的指标。它被定义为长度$L_{50}$，使得至少$50\\%$的总组装大小包含在长度大于或等于$L_{50}$的重叠群中。根据生物信息学的惯例，$L_{50}$是组装本身中的一个重叠群长度。具体来说，它是最大重叠群的最小集合中最小的重叠群长度，该集合的总长度达到或超过总组装大小的$50\\%$。\n\n根据这个定义，我们可以推导出一个精确的、分步的算法：\n\n1.  **计算总组装大小**：设给定的重叠群长度多重集为$\\mathcal{L} = \\{l_1, l_2, \\dots, l_n\\}$，其中$n$是重叠群的总数。总组装大小$S_{\\text{total}}$是所有重叠群长度的总和。\n    $$S_{\\text{total}} = \\sum_{i=1}^{n} l_i$$\n\n2.  **定义N50阈值**：阈值定义为总组装大小的一半。\n    $$T_{50} = \\frac{S_{\\text{total}}}{2}$$\n\n3.  **对重叠群长度进行排序**：必须将重叠群长度按降序排列，从最长到最短。设排序后的长度列表为$\\mathcal{L}' = (l'_1, l'_2, \\dots, l'_n)$，其中$l'_1 \\ge l'_2 \\ge \\dots \\ge l'_n$。\n\n4.  **找到N50值**：遍历排序后的列表$\\mathcal{L}'$，计算重叠群长度的累积和。N50值是序列中第一个导致累积和达到或超过阈值$T_{50}$的重叠群的长度$l'_j$。数学上，我们找到最小的索引$j$，使得：\n    $$\\sum_{i=1}^{j} l'_i \\ge T_{50}$$\n    N50值就是这个索引处的重叠群长度，$L_{50} = l'_j$。之前的累积和必须小于阈值：$\\sum_{i=1}^{j-1} l'_i  T_{50}$（对于$j=1$，该和为$0$）。\n\n现在，我们将此算法应用于所提供的数据。\n\n给定的重叠群长度（以碱基对为单位）是：\n$\\mathcal{L} = \\{830124, 710552, 690121, 540600, 439820, 415000, 398657, 372000, 250300, 240000, 120000, 95000\\}$。\n共有$n=12$个重叠群。\n\n**步骤1：计算总组装大小**\n我们对集合$\\mathcal{L}$中的所有长度求和：\n$$S_{\\text{total}} = 830124 + 710552 + 690121 + 540600 + 439820 + 415000 + 398657 + 372000 + 250300 + 240000 + 120000 + 95000$$\n$$S_{\\text{total}} = 5092174 \\text{ 碱基对}$$\n\n**步骤2：定义N50阈值**\n阈值是总组装大小的一半：\n$$T_{50} = \\frac{5092174}{2} = 2546087$$\n\n**步骤3：对重叠群长度进行排序**\n提供的重叠群长度列表已经按降序排列。我们将此排序后的列表表示为$\\mathcal{L}'$：\n$\\mathcal{L}' = (l'_1, l'_2, \\dots, l'_{12}) = (830124, 710552, 690121, 540600, 439820, 415000, 398657, 372000, 250300, 240000, 120000, 95000)$。\n\n**步骤4：通过累加找到N50值**\n我们计算排序列表$\\mathcal{L}'$中重叠群长度的累积和，并将其与阈值$T_{50} = 2546087$进行比较。\n\n-   加上 $l'_1 = 830124$：\n    累积和 = $830124$。这小于$2546087$。\n\n-   加上 $l'_2 = 710552$：\n    累积和 = $830124 + 710552 = 1540676$。这小于$2546087$。\n\n-   加上 $l'_3 = 690121$：\n    累积和 = $1540676 + 690121 = 2230797$。这小于$2546087$。\n\n-   加上 $l'_4 = 540600$：\n    累积和 = $2230797 + 540600 = 2771397$。这个值大于或等于阈值$T_{50} = 2546087$。\n\n这是累积和首次超过阈值的点。索引为$j=4$。导致超过阈值的重叠群长度是$l'_4$。因此，N50值就是这个重叠群的长度。\n\n$L_{50} = l'_4 = 540600$。\n\n长度大于或等于$540600$的重叠群集合是$\\{830124, 710552, 690121, 540600\\}$。它们的长度总和是$2771397$，占总组装大小的$\\frac{2771397}{5092174} \\approx 54.4\\%$，因此满足N50的定义。排序列表中第二大的重叠群长度是$l'_3 = 690121$。长度$\\ge 690121$的重叠群的长度总和是$2230797$，小于阈值。因此，根据标准定义，$l'_4 = 540600$确实是正确的N50值。",
            "answer": "$$\\boxed{540600}$$"
        }
    ]
}