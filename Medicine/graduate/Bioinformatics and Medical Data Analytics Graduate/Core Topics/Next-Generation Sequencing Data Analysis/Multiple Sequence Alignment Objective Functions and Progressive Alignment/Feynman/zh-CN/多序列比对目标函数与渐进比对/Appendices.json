{
    "hands_on_practices": [
        {
            "introduction": "多重序列比对的质量评估是生物信息学中的一个核心任务。最常用和最直观的评估方法之一是配对加和（Sum-of-Pairs, SP）目标函数。这个练习将带你从第一性原理出发，通过逐列计算一个给定比对的 $S_{\\mathrm{SP}}$ 得分，为理解更复杂的比对策略和启发式算法打下坚实的数学基础。",
            "id": "4587259",
            "problem": "考虑一个通过渐进式比对构建的多序列比对（MSA），该比对使用一个引导树，首先对齐序列$x_1$和$x_2$，然后将得到的轮廓（profile）与$x_3$对齐。比对$A$显示为$x_1$: ACGT，$x_2$: AG-T，$x_3$: A-CT，其中`-`表示一个空位。在MSA的标准基于目标的评估中，配对加和（Sum-of-Pairs, SP）系列目标函数将所有比对列的成对替换和空位得分进行汇总。设成对评分方案由以下经过充分检验的规则定义：相同的核苷酸符号（匹配）得分为$s(\\text{match})=+1$，不同的核苷酸符号（错配）得分为$s(\\text{mismatch})=-1$，一个空位与一个核苷酸符号对齐（空位-符号对）得分为$s(\\text{gap-symbol})=-2$，一个空位与一个空位对齐（空位-空位对）得分为$s(\\text{gap-gap})=0$。仅使用这些原则，通过评估每一列中所有成对的贡献并将它们相加，计算所显示比对的$S_{\\mathrm{SP}}(A)$的精确值。除了数值计算外，还需解释每一项的含义，即说明每个比对列中，三个成对贡献（对$(x_1,x_2)$、$(x_1,x_3)$和$(x_2,x_3)$）以及它们是如何根据评分规则产生的。提供$S_{\\mathrm{SP}}(A)$的最终值，该值应为精确整数，无需四舍五入。",
            "solution": "该问题是有效的。它在生物信息学领域具有科学依据，问题陈述清晰，提供了所有必要信息，并且是客观陈述的。任务是为一个给定的多序列比对（MSA）计算配对加和（SP）得分。\n\n对于一个包含$N$条序列的多重比对$A$，其配对加和得分（记为$S_{\\mathrm{SP}}(A)$）定义为所有列上所有诱导的成对比对得分之和。如果$A$有$L$列，则得分由以下公式给出：\n$$S_{\\mathrm{SP}}(A) = \\sum_{k=1}^{L} S_k = \\sum_{k=1}^{L} \\left( \\sum_{1 \\le i  j \\le N} s(A_{i,k}, A_{j,k}) \\right)$$\n其中$A_{i,k}$是第$i$条序列在第$k$列的字符（核苷酸或空位），$s(a, b)$是将字符$a$与字符$b$对齐的得分。\n\n给定的比对$A$包含$N=3$条序列（$x_1, x_2, x_3$），并且有$L=4$列。比对中的序列是：\n$x_1$: ACGT\n$x_2$: AG-T\n$x_3$: A-CT\n\n成对评分方案定义如下：\n-   匹配得分，$s(\\text{match}) = +1$\n-   错配得分，$s(\\text{mismatch}) = -1$\n-   空位-符号对得分，$s(\\text{gap-symbol}) = -2$\n-   空位-空位对得分，$s(\\text{gap-gap}) = 0$\n\n我们将通过对三个成对贡献（$(x_1, x_2)$、$(x_1, x_3)$和$(x_2, x_3)$）的得分求和来计算每一列的得分。\n\n**第$1$列**：字符为 (A, A, A)。\n-   对$(x_1, x_2)$：字符为$A$和$A$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n-   对$(x_1, x_3)$：字符为$A$和$A$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n-   对$(x_2, x_3)$：字符为$A$和$A$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n第$1$列的总分是 $S_1 = 1 + 1 + 1 = 3$。\n\n**第$2$列**：字符为 (C, G, -)。\n-   对$(x_1, x_2)$：字符为$C$和$G$。这是一个错配。得分为$s(\\text{mismatch}) = -1$。\n-   对$(x_1, x_3)$：字符为$C$和$-$。这是一个空位-符号对。得分为$s(\\text{gap-symbol}) = -2$。\n-   对$(x_2, x_3)$：字符为$G$和$-$。这是一个空位-符号对。得分为$s(\\text{gap-symbol}) = -2$。\n第$2$列的总分是 $S_2 = (-1) + (-2) + (-2) = -5$。\n\n**第$3$列**：字符为 (G, -, C)。\n-   对$(x_1, x_2)$：字符为$G$和$-$。这是一个空位-符号对。得分为$s(\\text{gap-symbol}) = -2$。\n-   对$(x_1, x_3)$：字符为$G$和$C$。这是一个错配。得分为$s(\\text{mismatch}) = -1$。\n-   对$(x_2, x_3)$：字符为$-$和$C$。这是一个空位-符号对。得分为$s(\\text{gap-symbol}) = -2$。\n第$3$列的总分是 $S_3 = (-2) + (-1) + (-2) = -5$。\n\n**第$4$列**：字符为 (T, T, T)。\n-   对$(x_1, x_2)$：字符为$T$和$T$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n-   对$(x_1, x_3)$：字符为$T$和$T$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n-   对$(x_2, x_3)$：字符为$T$和$T$。这是一个匹配。得分为$s(\\text{match}) = +1$。\n第$4$列的总分是 $S_4 = 1 + 1 + 1 = 3$。\n\n最后，总的配对加和得分$S_{\\mathrm{SP}}(A)$是所有列得分的总和：\n$$S_{\\mathrm{SP}}(A) = S_1 + S_2 + S_3 + S_4 = 3 + (-5) + (-5) + 3 = -4$$\n关于渐进式比对过程（引导树）的信息描述了比对$A$可能是如何构建的，但它不改变对最终给定的比对计算SP得分的过程。计算完全基于最终的比对矩阵和评分方案。",
            "answer": "$$\\boxed{-4}$$"
        },
        {
            "introduction": "掌握了SP得分的基本计算后，我们将探讨一个更微妙但至关重要的问题：评分方案本身如何影响比对结果。不同的评分参数反映了不同的进化假设，并可能导致算法选择截然不同的比对方案。通过分析在不同空位-空位（gap-gap）罚分约定下哪种比对更优，本练习让你深入理解目标函数参数背后的生物学原理及其对算法行为的指导作用。",
            "id": "4587210",
            "problem": "考虑三个源自临床病毒分离株的同源序列，用于下游的系统发育分析和变异检出：$S_1 = \\text{\"ACGT\"}$，$S_2 = \\text{\"AG\"}$，以及 $S_3 = \\text{\"AC\"}$。针对这个三元组 $\\{S_1,S_2,S_3\\}$，提出了两种候选的多序列比对方案：\n\n比对 $A$：\n$S_1$: A C G T\n$S_2$: A - G -\n$S_3$: A C - -\n\n比对 $B$：\n$S_1$: A C G T\n$S_2$: A - G -\n$S_3$: A - C -\n\n假设配对总和（SP）目标函数通过逐列对所有无序序列对的配对得分求和来为一个比对打分，其中每对的评分方案为：匹配 $m$，错配 $u$，空格-字母 $g$，以及空格-空格 $h$。对于本问题，取 $m=+2$，$u=-0.2$，$g=-1.3$，并考虑两种关于空格-空格得分的约定：$h=0$（零）与 $h=-0.3$（负罚分）。不使用其他得分。SP目标函数定义为对所有列的得分求和，而每列的得分是该列中所有无序序列对的两个字符的配对得分的总和。渐进式比对（PA）通过沿着一个指导树，使用相同的逐列加性评分方法，相继合并配对比对或轮廓比对来构建多序列比对，因此 $h$ 的选择会影响中间决策和最终决策。\n\n哪项陈述正确地指出了在每种空格-空格约定下的SP最优比对，并为这两种约定在渐进式比对和进化建模的背景下提供了科学上合理的生物学理由？\n\nA. 当 $h=0$ 时，比对 $B$ 是SP最优的；当 $h=-0.3$ 时，比对 $A$ 是SP最优的。理由：将空格-空格视为 $0$ 建模了两个缺少同源残基的序列不会产生进化差异，从而允许堆叠空格以避免多重空格-字母罚分；施加 $h0$ 不鼓励主要由空格组成的列，这反映了跨谱系完全同步的缺失事件的先验概率较低，并减轻了渐进式比对将列压缩为共同出现的空格的倾向。\n\nB. 当 $h=0$ 时，比对 $A$ 是SP最优的；当 $h=-0.3$ 时，比对 $B$ 是SP最优的。理由：负的空格-空格罚分适当地奖励共同出现的空格以避免错配，而零空格-空格得分则更重地惩罚交错的空格。\n\nC. 无论 $h=0$ 还是 $h=-0.3$，比对 $A$ 都是SP最优的，因为空格-空格对在配对总和目标函数中从不被计算，所以 $h$ 不能改变最优解。\n\nD. 无论 $h=0$ 还是 $h=-0.3$，比对 $B$ 都是SP最优的，因为无论空格-空格的评分如何，堆叠空格都严格减少了空格-字母罚分的数量，因此 $h$ 的选择是无关紧要的。\n\nE. 当 $h=0$ 时，两个比对的SP得分相同；当 $h=-0.3$ 时，比对 $B$ 是SP最优的。理由：负的空格-空格罚分总是通过抵消渐进式比对中的错配成本来偏好共同出现的空格，这与临床分离株中频繁的协同插入缺失事件相一致。",
            "solution": "1.  **启动计划**：\n    *   **验证过程**：\n        *   步骤1：逐字提取给定信息。\n        *   步骤2：根据清单（科学依据、适定性、客观性等）进行验证。\n        *   步骤3：决定是继续还是中止。如果中止，说明原因并输出 `$$\\boxed{invalid problem}$$`。\n    *   **求解过程（如果有效）**：\n        *   从第一性原理推导答案。\n        *   分析每个选项（A, B, C, D, E），并说明“正确”或“不正确”并给出理由。\n    *   **最终答案格式**：\n        *   如果存在正确选项，将其大写字母连接起来（例如，`AC`）放入 `\\boxed` 中。\n        *   如果没有正确选项，则使用空的 `\\boxed{}`。\n\n2.  **执行计划**：\n\n    **步骤1：提取给定信息**\n    *   序列：$S_1 = \\text{\"ACGT\"}$，$S_2 = \\text{\"AG\"}$，$S_3 = \\text{\"AC\"}$。\n    *   序列数量，$N=3$。\n    *   比对 A:\n        *   $S_1$: A C G T\n        *   $S_2$: A - G -\n        *   $S_3$: A C - -\n    *   比对 B:\n        *   $S_1$: A C G T\n        *   $S_2$: A - G -\n        *   $S_3$: A - C -\n    *   目标函数：配对总和（SP）。\n    *   评分方案：\n        *   匹配：$m = +2$\n        *   错配：$u = -0.2$\n        *   空格-字母：$g = -1.3$\n        *   空格-空格：$h$\n    *   两种关于 $h$ 的约定：\n        *   约定1：$h = 0$\n        *   约定2：$h = -0.3$\n    *   SP函数定义：对所有列的得分求和，而每列的得分是该列中所有无序序列对的配对得分的总和。无序序列对是 $(S_1, S_2)$、$(S_1, S_3)$ 和 $(S_2, S_3)$。\n\n    **步骤2：使用提取的给定信息进行验证**\n    *   **是否科学上合理？**：是。该问题涉及多序列比对（MSA）、配对总和（SP）目标函数和渐进式比对，这些都是生物信息学中的标准概念。评价值（$m, u, g$）是合理的。关于空格-空格得分（$h=0$ vs. $h0$）的讨论是MSA算法中一个真实且重要的考虑因素。\n    *   **是否适定（Well-Posed）？**：是。该问题提供了计算两种比对在两种 $h$ 约定下SP得分所需的所有信息。问题很明确：确定每种约定下的最优比对，并评估所提供的理由。计算部分存在唯一解。\n    *   **是否客观？**：是。语言精确且技术性强。问题设置中没有主观或基于意见的陈述。\n    *   **缺陷清单检查**：\n        1.  **科学上不健全？**：否。\n        2.  **无法形式化？**：否。SP得分可以形式化并计算。\n        3.  **不完整/矛盾？**：否。所有必要的数据和定义都已提供。\n        4.  **不切实际/不可行？**：否。序列和比对是简单但有效的例子。\n        5.  **不适定？**：否。\n        6.  **伪深刻/琐碎？**：否。它需要仔细计算并理解空格-空格得分的含义，这是一个不平凡的概念。\n        7.  **外部可验证性？**：否。计算是可验证的。\n\n    **步骤3：结论与行动**\n    *   该问题是**有效的**。我将继续进行求解。\n\n3.  **推导解法**：\n\n    **SP得分的计算**\n    SP得分是所有列得分的总和。一列的得分是该列内所有配对比较得分的总和。序列对是 $(S_1, S_2)$、$(S_1, S_3)$ 和 $(S_2, S_3)$。\n\n    我们用 $\\text{Score}(C_j)$ 表示第 $j$ 列的得分。\n    $\\text{Score}(C_j) = \\text{score}(S_1[j], S_2[j]) + \\text{score}(S_1[j], S_3[j]) + \\text{score}(S_2[j], S_3[j])$。\n    总SP得分是 $\\sum_j \\text{Score}(C_j)$。\n\n    给定的参数是：$m=+2$，$u=-0.2$，$g=-1.3$，以及 $h$（将是 $0$ 或 $-0.3$）。\n\n    **分析比对 A：**\n    $S_1$: A C G T\n    $S_2$: A - G -\n    $S_3$: A C - -\n\n    *   **第1列 (A, A, A):**\n        *   $(S_1, S_2)$: A vs A (匹配) - $m = +2$\n        *   $(S_1, S_3)$: A vs A (匹配) - $m = +2$\n        *   $(S_2, S_3)$: A vs A (匹配) - $m = +2$\n        *   Score(C1) = $2 + 2 + 2 = 6$\n\n    *   **第2列 (C, -, C):**\n        *   $(S_1, S_2)$: C vs - (空格-字母) - $g = -1.3$\n        *   $(S_1, S_3)$: C vs C (匹配) - $m = +2$\n        *   $(S_2, S_3)$: - vs C (空格-字母) - $g = -1.3$\n        *   Score(C2) = $-1.3 + 2 - 1.3 = -0.6$\n\n    *   **第3列 (G, G, -):**\n        *   $(S_1, S_2)$: G vs G (匹配) - $m = +2$\n        *   $(S_1, S_3)$: G vs - (空格-字母) - $g = -1.3$\n        *   $(S_2, S_3)$: G vs - (空格-字母) - $g = -1.3$\n        *   Score(C3) = $2 - 1.3 - 1.3 = -0.6$\n\n    *   **第4列 (T, -, -):**\n        *   $(S_1, S_2)$: T vs - (空格-字母) - $g = -1.3$\n        *   $(S_1, S_3)$: T vs - (空格-字母) - $g = -1.3$\n        *   $(S_2, S_3)$: - vs - (空格-空格) - $h$\n        *   Score(C4) = $-1.3 - 1.3 + h = -2.6 + h$\n\n    *   **比对 A 的总SP得分, $SP(A)$:**\n        *   $SP(A) = \\text{Score(C1)} + \\text{Score(C2)} + \\text{Score(C3)} + \\text{Score(C4)}$\n        *   $SP(A) = 6 + (-0.6) + (-0.6) + (-2.6 + h) = 6 - 0.6 - 0.6 - 2.6 + h = 2.2 + h$\n\n    **分析比对 B：**\n    $S_1$: A C G T\n    $S_2$: A - G -\n    $S_3$: A - C -\n\n    *   **第1列 (A, A, A):**\n        *   与比对 A 相同。Score(C1) = $6$\n\n    *   **第2列 (C, -, -):**\n        *   $(S_1, S_2)$: C vs - (空格-字母) - $g = -1.3$\n        *   $(S_1, S_3)$: C vs - (空格-字母) - $g = -1.3$\n        *   $(S_2, S_3)$: - vs - (空格-空格) - $h$\n        *   Score(C2) = $-1.3 - 1.3 + h = -2.6 + h$\n\n    *   **第3列 (G, G, C):**\n        *   $(S_1, S_2)$: G vs G (匹配) - $m = +2$\n        *   $(S_1, S_3)$: G vs C (错配) - $u = -0.2$\n        *   $(S_2, S_3)$: G vs C (错配) - $u = -0.2$\n        *   Score(C3) = $2 - 0.2 - 0.2 = 1.6$\n\n    *   **第4列 (T, -, -):**\n        *   $(S_1, S_2)$: T vs - (空格-字母) - $g = -1.3$\n        *   $(S_1, S_3)$: T vs - (空格-字母) - $g = -1.3$\n        *   $(S_2, S_3)$: - vs - (空格-空格) - $h$\n        *   Score(C4) = $-1.3 - 1.3 + h = -2.6+h$\n\n    *   **比对 B 的总SP得分, $SP(B)$:**\n        *   $SP(B) = 6 + (-2.6+h) + 1.6 + (-2.6+h) = 2.4 + 2h$\n\n    **得分比较**\n\n    现在我们比较 $SP(A)$ 和 $SP(B)$ 在两种 $h$ 值下的得分。\n    1.  **情况1：$h=0$**\n        $SP(A) = 2.2 + 0 = 2.2$\n        $SP(B) = 2.4 + 2(0) = 2.4$\n        由于 $2.4 > 2.2$，当 $h=0$ 时，比对 $B$ 是SP最优的。\n\n    2.  **情况2：$h=-0.3$**\n        $SP(A) = 2.2 + (-0.3) = 1.9$\n        $SP(B) = 2.4 + 2(-0.3) = 2.4 - 0.6 = 1.8$\n        由于 $1.9 > 1.8$，当 $h=-0.3$ 时，比对 $A$ 是SP最优的。\n\n    计算表明，当 $h=0$ 时，比对 $B$ 是最优的；当 $h=-0.3$ 时，比对 $A$ 是最优的。我们现在评估给出的选项。\n\n    **逐项分析**\n\n    A. **当 $h=0$ 时，比对 $B$ 是SP最优的；当 $h=-0.3$ 时，比对 $A$ 是SP最优的。理由：将空格-空格视为 $0$ 建模了两个缺少同源残基的序列不会产生进化差异，从而允许堆叠空格以避免多重空格-字母罚分；施加 $h0$ 不鼓励主要由空格组成的列，这反映了跨谱系完全同步的缺失事件的先验概率较低，并减轻了渐进式比对将列压缩为共同出现的空格的倾向。**\n    此选项中陈述的计算结果与我们推导出的结果相同。所提供的理由在科学上也是合理的。设置 $h=0$ 是一个标准约定，它将残基的共同缺失视为一个非事件，不施加惩罚。如果这样做有助于避免其他惩罚（如错配甚至空格-字母惩罚），则可能有利于对齐方式对间隙进行分组或“堆叠”。$h0$ 的理由也是生物信息学中的一个经典论点：它惩罚含有许多间隙的列，以抵消贪婪渐进比对算法的“间隙吸引”伪影，并反映了在同一位置发生多个独立的插入缺失事件在进化上不太可能的生物学假设。比对 $B$ 有两对空格-空格，而 $A$ 只有一对，所以负的 $h$ 值对 $B$ 的惩罚更重。\n    **结论：正确。**\n\n    B. **当 $h=0$ 时，比对 $A$ 是SP最优的；当 $h=-0.3$ 时，比对 $B$ 是SP最优的。理由：负的空格-空格罚分适当地奖励共同出现的空格以避免错配，而零空格-空格得分则更重地惩罚交错的空格。**\n    计算结果与我们的推导相反。其理由也是有缺陷的：负罚分（$h0$）是*不鼓励*，而不是“奖励”。\n    **结论：不正确。**\n\n    C. **无论 $h=0$ 还是 $h=-0.3$，比对 $A$ 都是SP最优的，因为空格-空格对在配对总和目标函数中从不被计算，所以 $h$ 不能改变最优解。**\n    计算结果不正确。问题陈述明确定义了此类配对的得分 $h$，因此“空格-空格对从不被计算”的前提与问题陈述相矛盾。我们的推导表明，$h$ 的值决定了最优比对。\n    **结论：不正确。**\n\n    D. **无论 $h=0$ 还是 $h=-0.3$，比对 $B$ 都是SP最优的，因为无论空格-空格的评分如何，堆叠空格都严格减少了空格-字母罚分的数量，因此 $h$ 的选择是无关紧要的。**\n    计算结果不正确。“$h$ 的选择是无关紧要的”这一断言是错误的，正如得分依赖关系 $SP(A)=2.2+h$ 和 $SP(B)=2.4+2h$ 所示。最优比对直接取决于 $h$。\n    **结论：不正确。**\n\n    E. **当 $h=0$ 时，两个比对的SP得分相同；当 $h=-0.3$ 时，比对 $B$ 是SP最优的。理由：负的空格-空格罚分总是通过抵消渐进式比对中的错配成本来偏好共同出现的空格，这与临床分离株中频繁的协同插入缺失事件相一致。**\n    计算结果不正确。对于 $h=0$，得分分别为 $2.2$ 和 $2.4$，并非平局。对于 $h=-0.3$，比对 $A$ 是最优的，而不是 $B$。其理由是有缺陷的：负罚分*不偏好*而非偏好共同出现的空格。此外，“频繁的协同插入缺失事件”将是*反对*惩罚空格-空格列（即支持 $h \\ge 0$）的论据，而不是支持它。\n    **结论：不正确。**\n\n    只有选项A给出了正确的计算结果以及科学上有效且符合上下文的理由。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "渐进式比对是构建多重序列比对最流行的方法，但它本质上是一种启发式（heuristic）算法，并不保证能找到全局最优解。这个练习通过一个精心设计的思想实验，揭示了渐进式比对的“贪婪”本质所带来的根本性限制。你将看到，即使在引导树完全正确（即反映了真实的进化关系）的理想情况下，算法在早期做出的局部最优决策也可能导致最终产生一个生物学上不甚理想的比对结果。",
            "id": "2418815",
            "problem": "给定四条脱氧核糖核酸 (DNA) 序列，一棵与真实系统发育相符的引导树，以及一个标准的渐进式多序列比对 (MSA) 流程规范。您的任务是确定最终结果，并解释为什么即使引导树是正确的，最终的 MSA 仍然可能质量不佳。\n\n序列：\n- $S_1 = \\text{TAAAAAT}$ (两侧各有一个侧翼胸腺嘧啶和一个由五个腺嘌呤组成的同聚物)\n- $S_2 = \\text{TAAAAAAT}$ (与 $S_1$ 相同，但同聚物有六个腺嘌呤)\n- $S_3 = \\text{TAACAAAT}$ (长度为六的腺嘌呤同聚物，但从左数第三个腺嘌呤被胞嘧啶取代)\n- $S_4 = \\text{TAACAAAT}$ (与 $S_3$ 相同)\n\n真实系统发育（和引导树）：$((S_1,S_2),(S_3,S_4))$。\n\n渐进式流程：\n- 使用 Needleman–Wunsch 算法计算成对比对，采用简单的线性计分方案：匹配 $= +1$，错配 $= -1$，空位（每个符号）$= -1$。不使用仿射项。\n- 当存在多个最优成对比对时，实现通过在同聚物区段内将空位符号尽可能向右放置来打破平局，否则在分数相同时优先选择匹配而非空位。\n- 渐进式算法首先将 $S_1$ 与 $S_2$ 比对以生成一个配置文件，然后将 $S_3$ 与 $S_4$ 比对以生成第二个配置文件，最后比对这两个配置文件。在任何阶段都不执行迭代优化或重新比对。该算法考虑的最终目标是配对总和 (SP) 分数，但是，正如渐进式比对的标准做法，一旦早期的成对比对决策被固定下来，就不会再重新审视。\n\n问题：尽管引导树是正确的，以下哪项最能描述在这种情况下发生的事情及其原因？\n\nA. 因为引导树是真实的系统发育，渐进式流程保证能产生全局最优的配对总和 MSA，其中 $S_3$ 和 $S_4$ 中的两个胞嘧啶在同一列中对齐，并与 $S_1$ 和 $S_2$ 中的同源位置对齐，无论决胜规则如何。\n\nB. $S_1$ 和 $S_2$ 的成对比对在腺嘌呤运行区域内所需的单个空位有许多共优位置；右对齐的决胜规则将该空位固定在运行区域的右边缘。当合并 $(S_3,S_4)$ 配置文件时，算法会保留这一早期决策，并且无法移动它以适应信息丰富的胞嘧啶，从而导致即使引导树正确，也会产生一个生物学意义上较差的 MSA（错位的同源性）。\n\nC. 在最终的配置文件-配置文件比对期间，渐进式算法检测到早期的空位放置是次优的，并回溯以重新优化 $S_1$–$S_2$ 的比对，从而使 $S_3$ 和 $S_4$ 中的胞嘧啶落入其同源列中。\n\nD. 只有当引导树不正确时，渐进式比对才会产生较差的 MSA；如果引导树与真实系统发育相等，贪婪效应不会降低 MSA 的质量。",
            "solution": "该问题旨在说明渐进式比对的“贪婪”本质，即便是使用正确的引导树，也可能因为早期的局部最优决策而无法得到全局最优或生物学上最合理的比对。\n\n我们将按照指定的渐进式流程逐步分析：\n\n1.  **第一步：比对 $S_1$ 与 $S_2$**\n    - 序列 $S_1 = \\text{TAAAAAT}$ 和 $S_2 = \\text{TAAAAAAT}$ 仅在腺嘌呤同聚物（A-homopolymer）的长度上相差一个核苷酸。\n    - 使用给定的计分方案（匹配=+1，空位=-1），最优比对将在较短的序列 $S_1$ 中引入一个空位，得到7个匹配和1个空位，总分为 $7 \\times (+1) + 1 \\times (-1) = 6$。\n    - 由于同聚物的存在，这个空位可以放置在多个位置而得分不变（共优比对）。\n    - 问题中的决胜规则——“在同聚物区段内将空位符号尽可能向右放置”——强制算法做出一个唯一的选择。这个选择将空位放置在同聚物末端：\n      $S_1$: `TAAAAA-T`\n      $S_2$: `TAAAAAAT`\n    - 这个比对结果被“锁定”并生成一个固定的轮廓（profile）$P_{12}$。这是一个“贪婪”的决策，因为它是在没有参考其他序列（$S_3, S_4$）信息的情况下做出的。\n\n2.  **第二步：比对 $S_3$ 与 $S_4$**\n    - 序列 $S_3$ 和 $S_4$ 是完全相同的（$\\text{TAACAAAT}$）。\n    - 它们的比对是平凡的，不含任何空位，形成轮廓 $P_{34}$。\n\n3.  **第三步：比对轮廓 $P_{12}$ 与 $P_{34}$**\n    - 算法现在比对这两个固定的轮廓。由于 $P_{12}$ 中的空位位置已经无法更改，最终的多序列比对将如下所示：\n      $S_1$: `T A A A A A - T`\n      $S_2$: `T A A A A A A T`\n      $S_3$: `T A A C A A A T`\n      $S_4$: `T A A C A A A T`\n\n**结论分析**\n这个最终比对揭示了渐进式算法的核心缺陷。序列 $S_3$ 和 $S_4$ 中的胞嘧啶（`C`）是一个重要的信息标记，它为确定同源位置提供了线索。一个理想的比对会将 $S_1$ 和 $S_2$ 中同源的腺嘌呤与这个胞嘧啶对齐。然而，在第一步中，由于缺乏这些信息，算法仅凭一个任意的决胜规则就固定了空位的位置。这个早期的、局部最优的决策阻碍了算法在后续步骤中找到一个全局上可能更优（或生物学上更合理）的结构。因此，即使引导树是正确的，渐进式比对的贪婪性质也可能导致同源性被错误地表示。\n\n选项B准确地描述了这一过程：$S_1$ 和 $S_2$ 之间存在多个共优比对，决胜规则固定了一个选择，这个早期决策被保留，导致了一个生物学意义上较差的最终比对。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}