{
    "hands_on_practices": [
        {
            "introduction": "掌握基因组组装质量评估的第一步是理解其核心指标。本练习聚焦于最基本且广泛使用的统计量 $N_{50}$，它衡量了组装的连续性。通过手动计算一个小型数据集的 $N_{50}$ 值，您将深入理解其定义——即构成组装总长度一半的、最长重叠群（contig）集合中，最短的那个重叠群的长度 。",
            "id": "4540123",
            "problem": "在用于宏基因组分析的临床生物信息学流程中，一个基因组草图组装由一组重叠群长度的多重集表示。质量评估通常需要通过一个阈值统计量来概括长度分布，该统计量能够反映最长的重叠群覆盖了多大比例的组装结果。从以下基本原理出发：(i) 组装总长度是所有重叠群长度的总和，以及 (ii) 累积覆盖度是通过按长度对重叠群进行排序并累加其长度得到的。基于这些原理，首先为统计量 $N_{50}$ 提供一个严格的定义，将其定义为从重叠群长度的累积分布中导出的长度加权阈值。然后，对于以碱基对 (bp) 为单位的特定重叠群长度 $[800,\\,200,\\,300,\\,700,\\,500]$，执行以下操作：\n\n- 论证为什么在构建从最长到最短的累积覆盖函数时，应按非递增顺序对重叠群长度进行排序。\n- 计算组装总长度以及相当于总长度 $\\frac{1}{2}$ 的覆盖目标。\n- 按论证过的顺序累加长度，直到达到覆盖目标，并确定正式对应于 $N_{50}$ 的阈值长度。\n\n将最终结果表示为以碱基对 (bp) 为单位的单个整数。无需四舍五入。不要提供任何中间公式来代替定义；从所述基本原理推导出 $N_{50}$，并演示计算的每一步。",
            "solution": "问题陈述具有科学依据，提法恰当且客观。它提供了一组明确的重叠群长度，并要求计算一个标准的、定义明确的生物信息学指标 $N_{50}$。所有必要信息都已提供，不存在矛盾或歧义。该问题是有效的。\n\n我们首先根据所提供的基本原理，对 $N_{50}$ 统计量进行形式化定义。设包含 $n$ 个重叠群长度的多重集为 $L = \\{l_1, l_2, \\dots, l_n\\}$。\n\n首先，根据问题的第一个基本原理，组装总长度 $L_{total}$ 是所有单个重叠群长度的总和。\n$$L_{total} = \\sum_{i=1}^{n} l_i$$\n\n其次，为了评估最长重叠群的贡献，我们必须按特定顺序排列这些长度。设 $L' = \\{l'_1, l'_2, \\dots, l'_n\\}$ 是将多重集 $L$ 中的重叠群长度按非递增顺序（即 $l'_1 \\ge l'_2 \\ge \\dots \\ge l'_n$）排序后得到的序列。\n\n基于这个有序序列，我们可以定义一个累积长度函数 $C(k)$，它表示 $k$ 个最长重叠群的长度之和：\n$$C(k) = \\sum_{i=1}^{k} l'_i$$\n\n$N_{50}$ 统计量是一个长度加权阈值。它被定义为：在那些最长的重叠群中，其累积长度之和至少覆盖总组装长度的 $50\\%$（或分数 $\\frac{1}{2}$）的最小集合里，长度最短的那个重叠群的长度。为了找到这个值，我们必须首先确定最小的整数索引（我们称之为 $k_{50}$），使得累积和 $C(k)$ 达到或超过目标覆盖度 $\\frac{1}{2}L_{total}$。\n$$k_{50} = \\min \\left\\{ k \\in \\{1, \\dots, n\\} \\mid \\sum_{i=1}^{k} l'_i \\ge \\frac{1}{2} L_{total} \\right\\}$$\n$N_{50}$ 的值就恰好是排序后列表 $L'$ 中索引为 $k_{50}$ 的重叠群的长度。\n$$N_{50} = l'_{k_{50}}$$\n\n现在我们将此形式化步骤应用于给定数据。\n\n**按非递增顺序排序的理由**\n像 $N_{50}$ 这样的指标旨在评估组装的连续性。一个由少数几个非常长的重叠群组成的组装，通常被认为比一个由许多短重叠群组成的组装质量更高，即使它们的总长度相同。通过将重叠群从最长到最短排序，我们优先考虑了这些长重叠群。按此顺序构建累积和，直接回答了这样一个问题：“使得所有等于或长于该长度的重叠群能够覆盖一半基因组的最小重叠群长度是多少？”这为重叠群长度分布的高值区域提供了一个单一数值的总结，而这一区域与质量评估最为相关。按递增顺序求和则会回答一个关于最短重叠群贡献的不同且信息量较少的问题。\n\n**计算**\n给定的重叠群长度多重集为 $L = \\{800, 200, 300, 700, 500\\}$，单位为碱基对 (bp)。\n\n1.  **计算组装总长度 ($L_{total}$):**\n    $$L_{total} = 800 + 200 + 300 + 700 + 500 = 2500 \\text{ bp}$$\n\n2.  **计算覆盖目标:**\n    目标是总组装长度的 $\\frac{1}{2}$。\n    $$\\text{Target} = \\frac{1}{2} L_{total} = \\frac{1}{2} \\times 2500 \\text{ bp} = 1250 \\text{ bp}$$\n\n3.  **按非递增顺序对重叠群进行排序并累加:**\n    首先，我们对 $L$ 中的长度进行排序，以创建有序序列 $L'$。\n    $$L' = \\{800, 700, 500, 300, 200\\}$$\n    接下来，我们按此顺序累加长度，并与 $1250$ bp 的目标进行比较。\n    -   加上第一个重叠群 ($l'_1 = 800$)：累积长度为 $C(1) = 800$。这小于 $1250$ bp 的目标。\n    -   加上第二个重叠群 ($l'_2 = 700$)：累积长度为 $C(2) = 800 + 700 = 1500$。这个值 $1500$ 达到并超过了 $1250$ bp 的目标。\n\n4.  **确定 $N_{50}$ 值:**\n    当我们加上第二个重叠群时（$k_{50}=2$），累积和首次达到目标。根据定义，$N_{50}$ 统计量是最后一个被加进来以越过阈值的重叠群的长度。\n    $$N_{50} = l'_{k_{50}} = l'_2 = 700$$\n    因此，该组装的 $N_{50}$ 为 $700$ bp。",
            "answer": "$$\\boxed{700}$$"
        },
        {
            "introduction": "单个指标往往无法全面反映组装质量的复杂性。一个较高的 $N_{50}$ 值可能掩盖了组装中其他部分的严重碎片化问题。本练习通过比较两个总长度相同但重叠群分布迥异的组装，引入了 $L_{90}$ 指标（覆盖90%组装所需的最小重叠群数量），旨在揭示不同指标间的权衡关系 。解决这个问题将帮助您学会如何综合利用多个指标，以更批判性的视角评估组装结果。",
            "id": "4540052",
            "problem": "一个临床生物信息学团队评估了来自一个肿瘤基因组学样本的两个草图基因组组装，以了解其结构连续性并为下游的变异分析提供信息。在基因组组装评估中，重叠群（contig）按长度从长到短排序，组装总跨度是所有重叠群长度的总和，而连续性指标是基于该有序列表计算的。根据组装评估中使用的标准定义：50%重叠群长度统计量（N50）是指，在有序列表中，其累积跨度至少达到组装总跨度一半的最小前缀中，最短重叠群的长度。90%跨度重叠群计数（L90）是指，在有序列表中，累积跨度至少达到组装总跨度九成的所需的最少重叠群数量。这两个组装的重叠群长度多重集分别为 $A:[3000, 3000, 3000]$ 和 $B:[8000, 500, 500]$，其中每个数字表示以碱基对为单位的长度。请根据这些定义计算组装 $A$ 和 $B$ 的 $N_{50}$ 和 $L_{90}$ 值。然后，从第一性原理出发，阐明这些指标所揭示的，在以少数极长重叠群为特征的组装与具有更均衡分布的组装之间的权衡，特别关注 $\\left(N_{50}, L_{90}\\right)$ 这对指标如何在医学数据分析中共同制约可解释性和下游应用价值。所有重叠群长度以碱基对表示，所有计数为无单位整数。如果出现任何非整数，请四舍五入至四位有效数字。请按顺序 $\\left(N_{50}(A), L_{90}(A), N_{50}(B), L_{90}(B)\\right)$ 将最终答案表示为单行矩阵。",
            "solution": "用户提供的问题已根据指定标准进行了评估，并被确定为有效。该问题在科学上基于生物信息学和基因组组装评估的原理，问题提出得当，定义清晰，数据充分，并且表述客观。因此，我们可以进行正式的解答。\n\n问题要求为两个给定的组装（分别指定为组装 A 和组装 B）计算两个标准的基因组组装质量指标：50%重叠群长度统计量（$N_{50}$）和90%跨度重叠群计数（$L_{90}$）。问题还要求阐明这些指标所揭示的权衡。\n\n设一个给定组装的重叠群长度多重集为 $C = \\{c_1, c_2, \\dots, c_n\\}$。\n组装总跨度 $S$ 是所有重叠群长度的总和：\n$$S = \\sum_{i=1}^{n} c_i$$\n为了计算 $N_{50}$ 和 $L_{90}$，必须首先将重叠群按长度降序排序，创建一个有序列表 $C' = (l_1, l_2, \\dots, l_n)$，其中 $l_1 \\ge l_2 \\ge \\dots \\ge l_n$。\n\n$N_{50}$ 统计量定义为，在 $C'$ 的最小前缀中，当其长度累积和达到总跨度 $S$ 的至少 $50\\%$ 时，该前缀中最短的重叠群的长度 $l_k$。也就是说，找到最小的整数 $k$，使得：\n$$\\sum_{i=1}^{k} l_i \\ge 0.5 \\times S$$\n$N_{50}$ 的值即为 $l_k$，也就是集合 $\\{l_1, l_2, \\dots, l_k\\}$ 中最短重叠群的长度。由于列表是有序的， $l_k$ 总是最短的。\n\n$L_{90}$ 统计量定义为，从有序列表 $C'$ 中取出最少数量的重叠群，使其累积长度至少为总跨度 $S$ 的 $90\\%$。也就是说，找到最小的整数 $k$，使得：\n$$\\sum_{i=1}^{k} l_i \\ge 0.9 \\times S$$\n$L_{90}$ 的值就是这个整数 $k$。\n\n我们现在将这些定义应用于组装 A 和组装 B。\n\n**组装 A**\n重叠群长度的多重集是 $A = [3000, 3000, 3000]$。\n1.  **重叠群排序**：所有长度相同，所以有序列表是 $C'_A = (3000, 3000, 3000)$。\n2.  **总跨度**：组装总跨度是 $S_A = 3000 + 3000 + 3000 = 9000$ 碱基对。\n3.  **阈值**：$50\\%$ 的阈值是 $0.5 \\times 9000 = 4500$。$90\\%$ 的阈值是 $0.9 \\times 9000 = 8100$。\n\n4.  **计算 $N_{50}(A)$**：我们找到最小的 $k$，使得累积和 $\\ge 4500$。\n    -   当 $k=1$ 时：累积和为 $3000$。这  4500。\n    -   当 $k=2$ 时：累积和为 $3000 + 3000 = 6000$。这 $\\ge 4500$。\n    最小的重叠群集合是 $(3000, 3000)$。这个集合中最短的（也是唯一的）长度是 $3000$。\n    因此，$N_{50}(A) = 3000$。\n\n5.  **计算 $L_{90}(A)$**：我们找到最小的 $k$，使得累积和 $\\ge 8100$。\n    -   当 $k=1$ 时：累积和为 $3000$。这  8100。\n    -   当 $k=2$ 时：累积和为 $6000$。这  8100。\n    -   当 $k=3$ 时：累积和为 $6000 + 3000 = 9000$。这 $\\ge 8100$。\n    所需的最少重叠群数量是 $3$。\n    因此，$L_{90}(A) = 3$。\n\n**组装 B**\n重叠群长度的多重集是 $B = [8000, 500, 500]$。\n1.  **重叠群排序**：有序列表是 $C'_B = (8000, 500, 500)$。\n2.  **总跨度**：组装总跨度是 $S_B = 8000 + 500 + 500 = 9000$ 碱基对。\n3.  **阈值**：阈值与组装 A 相同：$50\\%$ 是 $4500$，$90\\%$ 是 $8100$。\n\n4.  **计算 $N_{50}(B)$**：我们找到最小的 $k$，使得累积和 $\\ge 4500$。\n    -   当 $k=1$ 时：累积和为 $8000$。这 $\\ge 4500$。\n    最小的重叠群集合是 $(8000)$。这个集合中最短的（也是唯一的）长度是 $8000$。\n    因此，$N_{50}(B) = 8000$。\n\n5.  **计算 $L_{90}(B)$**：我们找到最小的 $k$，使得累积和 $\\ge 8100$。\n    -   当 $k=1$ 时：累积和为 $8000$。这  8100。\n    -   当 $k=2$ 时：累积和为 $8000 + 500 = 8500$。这 $\\ge 8100$。\n    所需的最少重叠群数量是 $2$。\n    因此，$L_{90}(B) = 2$。\n\n**权衡的解读**\n计算出的指标是：\n-   组装 A：$(N_{50}, L_{90}) = (3000, 3)$\n-   组装 B：$(N_{50}, L_{90}) = (8000, 2)$\n\n尽管两个组装的总大小相同，但这两对指标揭示了它们结构上的根本差异。\n\n-   **$N_{50}$ 作为连续性的衡量标准**：$N_{50}$ 表示构成组装“较大部分”一半的重叠群的长度。较高的 $N_{50}$ 通常更好，表明至少一半的基因组被组装成大的、连续的片段。组装 B 的 $N_{50}$ 为 $8000$，远高于组装 A 的 $3000$，表明其至少一半内容的宏观连续性更优。\n\n-   **$L_{90}$ 作为片段化程度的衡量标准**：$L_{90}$ 表示构成组装绝大部分（$90\\%$）需要多少个片段。较低的 $L_{90}$ 更好，表明组装的片段化程度较低。组装 B 的 $L_{90}$ 为 $2$，低于组装 A 的 $3$，意味着在 B 中可以用更少的重叠群覆盖 $90\\%$ 的基因组。\n\n$(N_{50}, L_{90})$ 这对指标共同制约了解读：\n1.  **组装 A ($(3000, 3)$)** 代表一个**均衡但片段化**的组装。其所有重叠群的长度都统一且适中。较低的 $N_{50}$ 反映了它缺少非常长的重叠群。对于下游分析而言，这意味着虽然质量是一致的，但任何大于 $3000$ 碱基对的基因或结构变异都将被打断在多个重叠群中，使分析复杂化。\n\n2.  **组装 B ($(8000, 2)$)** 代表一个**头重脚轻或倾斜**的组装。它的特点是一个非常长的重叠群和一条由非常短的重叠群组成的“尾巴”。高 $N_{50}$ 和低 $L_{90}$ 都是由单个 $8000$ bp的重叠群驱动的。\n    -   **应用价值**：如果感兴趣的区域（如一个大的癌基因）完全位于这个长重叠群内，那么这种结构非常有利。它允许对该区域内的变异和局部结构进行明确的分析。\n    -   **可解释性约束**：高质量的指标可能具有误导性。它们掩盖了组装中约 $100\\% - (8000/9000 \\times 100\\%) \\approx 11.1\\%$ 的部分被高度片段化为 $500$ bp的小片段这一事实。这些片段化区域中的信息是孤立的，它们与主重叠群的关系未知。这说明了一个关键的权衡：追求高 $N_{50}$ 有时可能导致一个组装为了生成少数几个“主干”重叠群，而牺牲了对其余序列的正确放置，从而产生一个片段化的尾部。\n\n在医学数据分析的背景下，对于分析其单个大重叠群内的长程特征，组装 B 会是首选。然而，研究人员必须谨慎，因为 $(8000, 2)$ 这样亮眼的汇总统计数据隐藏了组装中不可忽略的一部分质量很差。组装 A 在纸面上不那么出色，但可能更具统一的可靠性，尽管其用于研究大基因或结构变异的应用价值因其片段化而受到固有限制。两者之间的选择取决于具体的分析目标。\n\n最终结果向量的顺序为 $(N_{50}(A), L_{90}(A), N_{50}(B), L_{90}(B))$。\n这些值为 $(3000, 3, 8000, 2)$。所有值均为整数，因此无需四舍五入。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3000  3  8000  2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际应用中，组装质量评估常常依赖于外部信息，例如预估的基因组大小（$G$），而这个估计值本身可能存在不确定性。本练习引入了 $NG_{50}$，一个相对于基因组大小进行标准化的指标，并探讨了当 $G$ 值发生微小变化时，$NG_{50}$ 的敏感性 。这个高级练习旨在揭示生物信息学分析中一个至关重要的概念：输入参数的不确定性如何影响最终结果的稳定性和可靠性。",
            "id": "4540059",
            "problem": "对一个临床细菌分离株进行测序，其从头组装产生了四个重叠群，长度分别为 $[900, 800, 700, 600]$ 千碱基对 (kbp)。送检实验室提供了一个估计的单倍体基因组大小 $G$，其不确定度为 $\\pm 5\\%$。在基因组组装评估中，$N50$（组装的加权中位重叠群长度）的定义是：将重叠群按非递增顺序排列，并从最大到最小累加它们的长度，当累积长度首次达到总组装长度至少一半时，对应的那个重叠群的长度。$NG50$（基因组大小标准化的 $N50$）的定义与此相同，只是累积长度是与估计基因组大小 $G$ 的至少一半进行比较，而不是与总组装长度比较。具体而言，将重叠群按长度以非递增顺序排序，并令其长度为 $L_{1}, L_{2}, \\dots, L_{n}$，$NG50$ 是满足其和 $\\sum_{i=1}^{k} L_{i} \\geq \\frac{G}{2}$ 的最小前缀 $\\{L_{1}, \\dots, L_{k}\\}$ 中最短的那个重叠群的长度。\n\n假设 $G = 1800$ kbp。为量化 $G$ 中的不确定性如何传播到报告的 $NG50$ 中，定义在 $\\pm 5\\%$ 扰动下 $NG50$ 相对于 $G$ 的对称有限差分灵敏度为\n$$\nS \\equiv \\frac{NG50\\big((1+0.05)G\\big) - NG50\\big((1-0.05)G\\big)}{(1+0.05)G - (1-0.05)G}.\n$$\n计算给定重叠群长度下的 $S$。您的最终答案以千碱基对/千碱基对 (kbp/kbp) 为单位表示，并四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在生物信息学领域具有科学依据，问题提法得当、客观且内部一致。唯一解所需的所有必要数据和定义均已提供。\n\n目标是计算在 $\\pm 5\\%$ 扰动下，$NG50$ 指标相对于估计基因组大小 $G$ 的对称有限差分灵敏度 $S$。$S$ 的计算公式如下：\n$$\nS \\equiv \\frac{NG50\\big((1+0.05)G\\big) - NG50\\big((1-0.05)G\\big)}{(1+0.05)G - (1-0.05)G}\n$$\n问题提供了以下信息：\n重叠群长度集合为 $\\{900, 800, 700, 600\\}$ 千碱基对 (kbp)。我们将这些长度按非递增顺序排序，它们已经是这个顺序了：\n$L_1 = 900$ kbp\n$L_2 = 800$ kbp\n$L_3 = 700$ kbp\n$L_4 = 600$ kbp\n\n名义上的估计单倍体基因组大小为 $G = 1800$ kbp。\n\n$NG50$ 的定义是，在已排序的重叠群中，其累积和至少为基因组大小一半（即 $\\sum_{i=1}^{k} L_{i} \\geq \\frac{G}{2}$）的最小前缀 $\\{L_{1}, \\dots, L_{k}\\}$ 中最短重叠群的长度。由于重叠群按非递增顺序排序（$L_1 \\geq L_2 \\geq \\dots$），因此前缀 $\\{L_1, \\dots, L_k\\}$ 中最短的重叠群始终是 $L_k$。所以，$NG50$ 是使累积和首次达到或超过阈值 $\\frac{G}{2}$ 的那个重叠群的长度 $L_k$。\n\n计算过程分为三个主要步骤：\n1.  确定扰动后的基因组大小 $G_{lower}$ 和 $G_{upper}$。\n2.  计算 $NG50(G_{lower})$ 和 $NG50(G_{upper})$。\n3.  将这些值代入 $S$ 的公式。\n\n首先，我们计算对应于 $\\pm 5\\%$ 变化的扰动后基因组大小。设扰动因子为 $\\delta = 0.05$。\n基因组大小的上限为：\n$$\nG_{upper} = (1 + \\delta)G = (1 + 0.05) \\times 1800 = 1.05 \\times 1800 = 1890 \\text{ kbp}\n$$\n基因组大小的下限为：\n$$\nG_{lower} = (1 - \\delta)G = (1 - 0.05) \\times 1800 = 0.95 \\times 1800 = 1710 \\text{ kbp}\n$$\n灵敏度公式的分母是此扰动的范围：\n$$\nG_{upper} - G_{lower} = 1890 - 1710 = 180 \\text{ kbp}\n$$\n\n接下来，我们计算 $G_{lower}$ 和 $G_{upper}$ 的 $NG50$ 值。这需要将累积的重叠群长度与各自的阈值 $\\frac{G_{lower}}{2}$ 和 $\\frac{G_{upper}}{2}$ 进行比较。\n阈值分别为：\n$$\n\\text{Threshold}_{lower} = \\frac{G_{lower}}{2} = \\frac{1710}{2} = 855 \\text{ kbp}\n$$\n$$\n\\text{Threshold}_{upper} = \\frac{G_{upper}}{2} = \\frac{1890}{2} = 945 \\text{ kbp}\n$$\n让我们计算排序后重叠群长度的累积和：\n$C_1 = \\sum_{i=1}^{1} L_i = L_1 = 900$ kbp\n$C_2 = \\sum_{i=1}^{2} L_i = L_1 + L_2 = 900 + 800 = 1700$ kbp\n$C_3 = \\sum_{i=1}^{3} L_i = C_2 + L_3 = 1700 + 700 = 2400$ kbp\n$C_4 = \\sum_{i=1}^{4} L_i = C_3 + L_4 = 2400 + 600 = 3000$ kbp\n\n为了找到 $NG50(G_{lower})$，我们寻找满足 $C_k \\geq 855$ kbp 的最小整数 $k$。\n当 $k=1$ 时，$C_1 = 900$，且 $900 \\geq 855$。条件在 $k=1$ 时满足。\n因此，$NG50(G_{lower}) = L_1 = 900$ kbp。\n\n为了找到 $NG50(G_{upper})$，我们寻找满足 $C_k \\geq 945$ kbp 的最小整数 $k$。\n当 $k=1$ 时，$C_1 = 900$，且 $900  945$。条件不满足。\n当 $k=2$ 时，$C_2 = 1700$，且 $1700 \\geq 945$。条件在 $k=2$ 时满足。\n因此，$NG50(G_{upper}) = L_2 = 800$ kbp。\n\n最后，我们将这些值代入灵敏度 $S$ 的公式中：\n$$\nS = \\frac{NG50(G_{upper}) - NG50(G_{lower})}{G_{upper} - G_{lower}} = \\frac{800 \\text{ kbp} - 900 \\text{ kbp}}{180 \\text{ kbp}} = \\frac{-100}{180}\n$$\n化简该分数得到：\n$$\nS = -\\frac{10}{18} = -\\frac{5}{9}\n$$\n换算成小数，即 $S = -0.5555...$。题目要求答案四舍五入到四位有效数字。\n$$\nS \\approx -0.5556\n$$\n单位是 kbp/kbp，这是一个无量纲的量，符合灵敏度的预期。",
            "answer": "$$\n\\boxed{-0.5556}\n$$"
        }
    ]
}