{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of homology modeling is the accurate alignment of a target sequence to a known template structure. The quality of this alignment directly determines the fidelity of the final model, as it maps which residues correspond to each other. This process is governed by quantitative scoring schemes, such as the BLOSUM matrices for substitutions and penalty models for insertions or deletions, which reflect evolutionary and biophysical constraints . This exercise provides fundamental practice in applying an affine gap penalty model to compute an optimal global alignment score, developing the critical skill of weighing the cost of a mismatch against the high penalty of introducing a gap.",
            "id": "4601961",
            "problem": "In homology modeling, template-target alignment accuracy critically determines the fidelity of residue mapping from template to target tertiary structure. Consider the global alignment of two protein sequences under an affine gap penalty model and a standard amino acid substitution score framework. The scoring model is defined by the sum of substitution scores from the BLOcks SUbstitution Matrix 62 (BLOSUM62) for aligned residue pairs, and an affine penalty for each gap segment of length $L$ given by $p(L) = g_{o} + g_{e}(L-1)$, where $g_{o}$ is the gap opening penalty and $g_{e}$ is the gap extension penalty per additional residue in the gap. Let the parameters be $g_{o} = 11$ and $g_{e} = 1$. Let $S_1 = \\text{\"ACDEFGHIKLMNP\"}$ and $S_2 = \\text{\"ACDFFGHIKLMKP\"}$. Using BLOSUM62, compute the optimal global alignment score between $S_1$ and $S_2$ and justify any gap placement decision by comparing the score differences attributable to correcting mismatches versus incurring gap costs. Report the single numerical optimal alignment score. No rounding is required.",
            "solution": "The task is to compute the optimal global alignment score between two protein sequences, $S_1$ and $S_2$, using the BLOSUM62 substitution matrix and an affine gap penalty model. The problem is a direct application of the Needleman-Wunsch algorithm, adapted for affine gap penalties (often implemented as the Gotoh algorithm).\n\nThe given sequences are:\n$S_1 = \\text{\"ACDEFGHIKLMNP\"}$ (length $n=13$)\n$S_2 = \\text{\"ACDFFGHIKLMKP\"}$ (length $m=13$)\n\nThe affine gap penalty for a gap of length $L$ is given by $p(L) = g_{o} + g_{e}(L-1)$, where the gap opening penalty is $g_{o} = 11$ and the gap extension penalty is $g_{e} = 1$. In a maximization framework for alignment scores, these penalties are subtracted from the score. A new gap of length $L=1$ incurs a penalty of $g_o = 11$. Each additional residue in the gap adds a penalty of $g_e = 1$.\n\nA direct comparison of the sequences reveals a high degree of similarity. They are of equal length and differ at only two positions.\n$S_1$: A C D E F G H I K L M N P\n$S_2$: A C D F F G H I K L M K P\n\nThe differing positions are:\n1.  At index 4, $S_1$ has residue 'E' while $S_2$ has 'F'.\n2.  At index 12, $S_1$ has residue 'N' while $S_2$ has 'K'.\n\nThe optimal global alignment score is found by determining the alignment path that maximizes the sum of substitution scores minus gap penalties. The decision at each point in the alignment is whether to align two residues (a match or mismatch) or to align a residue with a gap.\n\n**Justification for Gap Placement**\n\nThe cost of opening a gap is $g_{o} = 11$. This is a substantial penalty. A gap is only energetically favorable if it circumvents a mismatch or a series of mismatches with a total penalty significantly greater than 11, and simultaneously creates new, high-scoring matches.\n\n1.  **Analysis of the first mismatch region (E vs. F at index 4)**\n    The local segments are $S_1[3..6] = \\text{\"DEFG\"}$ and $S_2[3..6] = \\text{\"DFFG\"}$.\n    -   **No-gap option**: Aligning `E` with `F`. The score contribution from this column is $s(\\text{E},\\text{F})$. From BLOSUM62, $s(\\text{E},\\text{F}) = -3$.\n    -   **Gap option**: Introduce a gap to avoid the `E-F` mismatch. A gap would incur a penalty of at least $g_o = 11$. This is far too large to be compensated by resolving a mismatch of score $-3$. Thus, accepting the `E-F` mismatch is the optimal choice for this region.\n\n2.  **Analysis of the second mismatch region (N vs. K at index 12)**\n    The local segments are $S_1[11..13] = \\text{\"MNP\"}$ and $S_2[11..13] = \\text{\"MKP\"}$.\n    -   **No-gap option**: Aligning `N` with `K`. The score contribution is $s(\\text{N},\\text{K})$. From BLOSUM62, $s(\\text{N},\\text{K}) = 0$.\n    -   **Gap option**: Introduce a gap. A gap would incur a penalty of at least $g_o = 11$. Since the mismatch `N-K` has a neutral score of $0$, there is no possibility that introducing a gap could lead to a better score. Any gapped alignment would replace a score of $0$ with a penalty of at least $-11$.\n\nBased on this analysis, the optimal global alignment is the one with zero gaps.\n\n**Calculation of the Optimal Score**\n\nThe optimal score is the sum of the substitution scores for the direct, gapless alignment of $S_1$ and $S_2$.\n$$ \\text{Score} = \\sum_{i=1}^{13} s(S_{1}[i], S_{2}[i]) $$\nThe required BLOSUM62 scores are:\n- $s(\\text{A,A}) = 4$\n- $s(\\text{C,C}) = 9$\n- $s(\\text{D,D}) = 6$\n- $s(\\text{E,F}) = -3$ (mismatch)\n- $s(\\text{F,F}) = 6$\n- $s(\\text{G,G}) = 6$\n- $s(\\text{H,H}) = 8$\n- $s(\\text{I,I}) = 4$\n- $s(\\text{K,K}) = 5$\n- $s(\\text{L,L}) = 4$\n- $s(\\text{M,M}) = 5$\n- $s(\\text{N,K}) = 0$ (mismatch)\n- $s(\\text{P,P}) = 7$\n\nThe total score is the sum of these values:\n$\\text{Score} = 4 + 9 + 6 + (-3) + 6 + 6 + 8 + 4 + 5 + 4 + 5 + 0 + 7$\nWe can group the scores for identical matches and the mismatches:\nSum of scores for matches: $4 + 9 + 6 + 6 + 6 + 8 + 4 + 5 + 4 + 5 + 7 = 64$\nSum of scores for mismatches: $-3 + 0 = -3$\nTotal Score = $64 + (-3) = 61$.",
            "answer": "$$\n\\boxed{61}\n$$"
        },
        {
            "introduction": "In practice, a search for templates often yields multiple candidates, and selecting the most suitable one is a crucial strategic decision. The best choice is not always the template with the highest sequence identity; a holistic evaluation must balance competing factors like crystallographic resolution, alignment coverage, and the presence of functionally relevant elements like cofactors or ligands. This practice  simulates this complex, real-world decision-making process by guiding you to construct a quantitative utility function, thereby making an evidence-based choice among several viable templates.",
            "id": "4601997",
            "problem": "A biopharmaceutical team is performing comparative (homology) modeling for a human enzyme whose ligand-bound conformation is functionally relevant. They have identified three candidate templates from the Protein Data Bank (PDB; Protein Data Bank) with the following properties: template 1 has sequence identity $I_1 = 0.40$, alignment coverage $C_1 = 0.85$, X-ray resolution $r_1 = 1.8$ Angstrom, and no matching cofactor; template 2 has $I_2 = 0.32$, $C_2 = 0.95$, $r_2 = 2.5$ Angstrom, and a matching cofactor bound; template 3 has $I_3 = 0.28$, $C_3 = 0.70$, $r_3 = 3.2$ Angstrom, and no matching cofactor. To decide which template to use, the team proposes a utility function grounded in fundamental principles of homology modeling and X-ray crystallography.\n\nAssume the following foundational relationships:\n- The expected per-residue correctness of the modeled structure for aligned positions is approximated by the sequence identity $I$ of the template-target alignment, reflecting the empirical link between sequence identity and structural similarity for homologous proteins.\n- The expected fraction of residues modeled at all is given by the alignment coverage $C$, which multiplies the expected correctness over the aligned subset, so that overall correctness scales with $I \\times C$.\n- The coordinate reliability due to crystallographic resolution $r$ is modeled by a dimensionless function $Q(r)$, with baseline $Q(r_{\\star}) = 1$ at $r_{\\star} = 1.5$ Angstrom. Empirically, each increase of $1$ Angstrom beyond $r_{\\star}$ halves the coordinate reliability, i.e., $Q(r + 1) = \\frac{1}{2} Q(r)$ for $r \\ge r_{\\star}$.\n- The presence of a correct cofactor in the template raises the probability that the active site adopts the functionally relevant conformation from $0.80$ (without cofactor match) to $1.00$ (with cofactor match). Treat this as a multiplicative factor $F$ relative to the baseline without cofactor match.\n\nUsing only these foundational relationships, derive a dimensionless utility $U$ up to a positive constant of proportionality, combine the contributions $I$, $C$, $Q(r)$, and $F$, and compute the template index $t \\in \\{1,2,3\\}$ that maximizes $U$ for the three templates specified above. Report only the single index number as your final answer. No rounding is required, and no units should be included in the final reported index.",
            "solution": "The problem requires the selection of the optimal template for homology modeling from a set of three candidates. The selection criterion is the maximization of a dimensionless utility function $U$, which incorporates sequence identity $I$, alignment coverage $C$, crystallographic resolution $r$, and the presence of a matching cofactor. The first step is to construct this utility function based on the provided foundational relationships.\n\nThe utility function $U$ is proportional to the product of several factors that quantify the quality of a template. We can write this as:\n$$\nU \\propto (\\text{Overall Correctness}) \\times (\\text{Coordinate Reliability}) \\times (\\text{Functional Relevance})\n$$\nLet's formalize each term.\n\nThe problem states that the overall correctness of the model scales with the product of sequence identity $I$ and alignment coverage $C$. Thus, this component is proportional to $I \\cdot C$.\n\nThe coordinate reliability is given by a dimensionless function $Q(r)$, where $r$ is the X-ray resolution in Angstroms. We are given two conditions for $Q(r)$:\n1.  A baseline of $Q(r_{\\star}) = 1$ at $r_{\\star} = 1.5$ Angstroms.\n2.  An exponential decay relationship: $Q(r + 1) = \\frac{1}{2} Q(r)$ for $r \\ge r_{\\star}$.\nThe second condition implies an exponential function. The specific form that satisfies both conditions is:\n$$\nQ(r) = 2^{-(r - 1.5)}\n$$\nAll given resolution values ($r_1=1.8$, $r_2=2.5$, $r_3=3.2$) are greater than or equal to $r_{\\star}=1.5$, so this formula is applicable.\n\nThe functional relevance is captured by a multiplicative factor $F$. The probability of the active site adopting the correct conformation is $p_{\\text{without}} = 0.80$ without a matching cofactor and $p_{\\text{with}} = 1.00$ with a matching cofactor. The factor $F$ is defined relative to the baseline case, which is \"without cofactor match\".\nFor the baseline case (no matching cofactor), the factor is:\n$$\nF_{\\text{without}} = \\frac{p_{\\text{without}}}{p_{\\text{without}}} = \\frac{0.80}{0.80} = 1\n$$\nFor the case with a matching cofactor, the factor is:\n$$\nF_{\\text{with}} = \\frac{p_{\\text{with}}}{p_{\\text{without}}} = \\frac{1.00}{0.80} = \\frac{5}{4} = 1.25\n$$\n\nCombining these components, the utility function $U$ can be defined as:\n$$\nU = (I \\cdot C) \\cdot Q(r) \\cdot F = (I \\cdot C) \\cdot 2^{-(r - 1.5)} \\cdot F\n$$\nSince we are only comparing the templates, any positive constant of proportionality can be ignored.\n\nNow, we compute the utility $U_t$ for each template $t \\in \\{1, 2, 3\\}$.\n\nFor template 1:\n$I_{1} = 0.40$, $C_{1} = 0.85$, $r_{1} = 1.8$ Angstrom, no matching cofactor.\nThe factor $F_1 = 1$.\n$$\nU_1 = (0.40 \\cdot 0.85) \\cdot 2^{-(1.8 - 1.5)} \\cdot 1 = 0.34 \\cdot 2^{-0.3}\n$$\n\nFor template 2:\n$I_{2} = 0.32$, $C_{2} = 0.95$, $r_{2} = 2.5$ Angstrom, matching cofactor bound.\nThe factor $F_2 = 1.25$.\n$$\nU_2 = (0.32 \\cdot 0.95) \\cdot 2^{-(2.5 - 1.5)} \\cdot 1.25\n$$\n$$\nU_2 = 0.304 \\cdot 2^{-1} \\cdot 1.25 = 0.304 \\cdot 0.5 \\cdot 1.25 = 0.152 \\cdot 1.25 = 0.19\n$$\n\nFor template 3:\n$I_{3} = 0.28$, $C_{3} = 0.70$, $r_{3} = 3.2$ Angstrom, no matching cofactor.\nThe factor $F_3 = 1$.\n$$\nU_3 = (0.28 \\cdot 0.70) \\cdot 2^{-(3.2 - 1.5)} \\cdot 1 = 0.196 \\cdot 2^{-1.7}\n$$\n\nFinally, we must compare the values of $U_1$, $U_2$, and $U_3$ to find the maximum.\n$U_1 = 0.34 \\cdot 2^{-0.3} \\approx 0.34 \\cdot 0.812 = 0.276$\n$U_2 = 0.19$\n$U_3 = 0.196 \\cdot 2^{-1.7} \\approx 0.196 \\cdot 0.308 = 0.060$\n\nFrom these calculations, we have established the order of utilities: $U_1 > U_2 > U_3$.\nThe utility is maximized for template 1. The index of this template is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Once a structural model is built, it is imperative to assess its accuracy to understand its reliability and potential limitations. The local Distance Difference Test (lDDT) is a state-of-the-art, superposition-free metric that evaluates how well the network of local inter-atomic distances in the native structure is preserved in the model. By calculating a per-residue score, lDDT provides a detailed map of model quality, highlighting well-modeled regions and flagging those that may be incorrect . This exercise offers direct, hands-on experience in calculating lDDT scores, an essential skill for the critical validation of any predicted protein structure.",
            "id": "4601963",
            "problem": "You are evaluating the local structural accuracy of a homology model for a short protein segment using the local Distance Difference Test (lDDT). The lDDT assesses how well local inter-residue distances in the model agree with a native reference, within a specified neighborhood and set of tolerance thresholds, without requiring a global superposition. For each residue index $i$, define its neighborhood $\\mathcal{N}(i)$ as all residues $j \\neq i$ such that the native C$\\alpha$–C$\\alpha$ distance $d_{\\mathrm{nat}}(i,j)$ is less than a cutoff $C$. Given a set of tolerance thresholds $\\mathcal{T}$ (in Ångström), the per-residue lDDT score is computed by comparing modeled and native distances using indicator functions that count how many thresholds are satisfied for each neighbor. Specifically, with cutoff $C = 8$ Å and thresholds $\\mathcal{T} = \\{0.5, 1.0, 2.0, 4.0\\}$ Å, define for each residue $i$:\n$$\n\\mathrm{lDDT}(i) \\;=\\; \\frac{1}{|\\mathcal{N}(i)|} \\sum_{j \\in \\mathcal{N}(i)} \\left[ \\frac{1}{|\\mathcal{T}|} \\sum_{t \\in \\mathcal{T}} \\mathbf{1}\\!\\left(\\left| d_{\\mathrm{mod}}(i,j) - d_{\\mathrm{nat}}(i,j) \\right| < t \\right) \\right],\n$$\nwhere $d_{\\mathrm{nat}}(i,j)$ and $d_{\\mathrm{mod}}(i,j)$ are the native and model C$\\alpha$–C$\\alpha$ distances for residue pair $(i,j)$, $|\\cdot|$ denotes set cardinality, and $\\mathbf{1}(\\cdot)$ is the indicator function that equals $1$ if its condition is true and $0$ otherwise.\n\nYou are given the following native and model C$\\alpha$–C$\\alpha$ distances (in Ångström) for a contiguous segment of $5$ residues indexed $1$ to $5$. Each pair is listed once for $i<j$. All other pairs not listed can be considered nonexistent data and should not be used. Use the neighborhood definition based on the native distances and cutoff $C = 8$ Å.\n\n- Pair $(1,2)$: $d_{\\text{nat}} = 3.8$, $d_{\\text{mod}} = 4.1$.\n- Pair $(1,3)$: $d_{\\text{nat}} = 6.0$, $d_{\\text{mod}} = 6.7$.\n- Pair $(1,4)$: $d_{\\text{nat}} = 8.5$, $d_{\\text{mod}} = 8.9$.\n- Pair $(1,5)$: $d_{\\text{nat}} = 11.0$, $d_{\\text{mod}} = 10.5$.\n- Pair $(2,3)$: $d_{\\text{nat}} = 3.8$, $d_{\\text{mod}} = 4.6$.\n- Pair $(2,4)$: $d_{\\text{nat}} = 6.0$, $d_{\\text{mod}} = 5.2$.\n- Pair $(2,5)$: $d_{\\text{nat}} = 8.6$, $d_{\\text{mod}} = 7.9$.\n- Pair $(3,4)$: $d_{\\text{nat}} = 3.8$, $d_{\\text{mod}} = 4.0$.\n- Pair $(3,5)$: $d_{\\text{nat}} = 6.0$, $d_{\\text{mod}} = 7.5$.\n- Pair $(4,5)$: $d_{\\text{nat}} = 3.8$, $d_{\\text{mod}} = 4.4$.\n\nTasks:\n1. Compute $\\mathrm{lDDT}(i)$ for each residue $i \\in \\{1,2,3,4,5\\}$ using the definition above with $C = 8$ Å and $\\mathcal{T} = \\{0.5, 1.0, 2.0, 4.0\\}$ Å. Treat the lDDT as unitless.\n2. Define a residue as locally low-accuracy if $\\mathrm{lDDT}(i) < 0.7$. Based on the computed per-residue scores, identify any contiguous segments of low-accuracy residues along the sequence and briefly summarize their locations.\n3. Finally, compute the mean lDDT over residues $1$ through $5$. Express the final mean lDDT as a unitless decimal rounded to four significant figures. Your final submitted answer must be this single numerical value only.",
            "solution": "The solution is found by following the definition of the lDDT score. First, the neighborhood for each residue is determined using the cutoff $C = 8$ Å on native distances. Second, for each pair of residues within a neighborhood, the fraction of satisfied tolerance thresholds is calculated. Finally, the per-residue lDDT is the average of these fractions over its neighborhood, and the overall mean is computed.\n\n**1. Residue Neighborhoods ($\\mathcal{N}(i)$)**\n- $\\mathcal{N}(1) = \\{2, 3\\}$\n- $\\mathcal{N}(2) = \\{1, 3, 4\\}$\n- $\\mathcal{N}(3) = \\{1, 2, 4, 5\\}$\n- $\\mathcal{N}(4) = \\{2, 3, 5\\}$\n- $\\mathcal{N}(5) = \\{3, 4\\}$\n\n**2. Per-Residue lDDT Scores**\nWe calculate the fraction of satisfied thresholds, $S(i,j)$, for each neighboring pair and average them.\n- $\\Delta d(1,2)=|4.1 - 3.8|=0.3 \\implies S(1,2)=1.0$; $\\Delta d(1,3)=|6.7 - 6.0|=0.7 \\implies S(1,3)=0.75$.\n  $\\mathrm{lDDT}(1) = \\frac{1.0 + 0.75}{2} = 0.875$.\n- $\\Delta d(2,3)=|4.6 - 3.8|=0.8 \\implies S(2,3)=0.75$; $\\Delta d(2,4)=|5.2 - 6.0|=0.8 \\implies S(2,4)=0.75$.\n  $\\mathrm{lDDT}(2) = \\frac{S(2,1) + S(2,3) + S(2,4)}{3} = \\frac{1.0 + 0.75 + 0.75}{3} \\approx 0.8333$.\n- $\\Delta d(3,4)=|4.0 - 3.8|=0.2 \\implies S(3,4)=1.0$; $\\Delta d(3,5)=|7.5 - 6.0|=1.5 \\implies S(3,5)=0.5$.\n  $\\mathrm{lDDT}(3) = \\frac{S(3,1) + S(3,2) + S(3,4) + S(3,5)}{4} = \\frac{0.75 + 0.75 + 1.0 + 0.5}{4} = 0.75$.\n- $\\Delta d(4,5)=|4.4 - 3.8|=0.6 \\implies S(4,5)=0.75$.\n  $\\mathrm{lDDT}(4) = \\frac{S(4,2) + S(4,3) + S(4,5)}{3} = \\frac{0.75 + 1.0 + 0.75}{3} \\approx 0.8333$.\n- $\\mathrm{lDDT}(5) = \\frac{S(5,3) + S(5,4)}{2} = \\frac{0.5 + 0.75}{2} = 0.625$.\n\n**3. Low-Accuracy Segments and Final Mean lDDT**\nBased on the threshold $\\mathrm{lDDT}(i)  0.7$, only residue 5 is classified as low-accuracy.\n\nThe mean lDDT over all five residues is:\n$$ \\text{Mean lDDT} = \\frac{1}{5} (0.875 + 0.8333... + 0.75 + 0.8333... + 0.625) = \\frac{47}{60} \\approx 0.78333... $$\nRounded to four significant figures, the mean lDDT is $0.7833$.",
            "answer": "$$\n\\boxed{0.7833}\n$$"
        }
    ]
}