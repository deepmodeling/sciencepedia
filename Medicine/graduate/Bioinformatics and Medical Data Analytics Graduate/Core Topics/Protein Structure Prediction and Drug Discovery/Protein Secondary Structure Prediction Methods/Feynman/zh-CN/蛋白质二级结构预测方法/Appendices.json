{
    "hands_on_practices": [
        {
            "introduction": "滑动窗口方法是早期序列分析算法的基石，其核心参数——窗口大小的选择，蕴含着一个关键的权衡。本练习旨在探讨这个权衡：一个小的窗口可以精确捕捉局部变化，但可能受噪声影响；而一个大的窗口可以整合更多信息以获得更稳健的统计信号，但代价是可能模糊结构元素的精确边界。通过分析这个中的假设情景，我们可以深入理解输入信息的尺度如何影响预测的准确性，特别是在稳定结构（如$\\alpha$-螺旋核心）与过渡区域（如螺旋末端）之间。",
            "id": "2135783",
            "problem": "在生物信息学领域，早期预测蛋白质二级结构的方法通常依赖于一种“滑动窗口”方法。对于蛋白质序列中的每个氨基酸残基，该算法会将该残基视为一个固定奇数大小（$W$）窗口的中心。然后，根据该窗口内包含的 $W$ 个氨基酸的统计倾向性来预测中心残基的二级结构状态（例如，$\\alpha$-螺旋、$\\beta$-折叠或无规卷曲）。\n\n两个研究小组正在基于这一原理开发相互竞争的预测算法。Group A 认为，一个较小的窗口大小（例如 $W=7$）是最佳的。Group B 则主张，一个更大的窗口大小（例如 $W=17$）会产生更好的结果。他们正在一组蛋白质上测试他们的方法，已知这些蛋白质包含由短而灵活的无规卷曲区域连接的长而稳定的$\\alpha$-螺旋片段。\n\n以下哪个陈述最准确地描述了与窗口大小选择相关的基本权衡，以及两个小组的方法在测试蛋白质上可能的表现？\n\nA. Group B 使用较大窗口的方法将在所有方面都更优越，因为处理更多的序列信息总是能为每个残基带来统计上更显著和更准确的预测。\n\nB. Group A 使用较小窗口的方法在正确识别长$\\alpha$-螺旋片段核心深处的残基方面会更有效，因为它避免了来自连接的无规卷曲区域中远处残基的“噪声”。\n\nC. Group B 使用较大窗口的方法可能在预测长$\\alpha$-螺旋中段残基的螺旋状态方面更准确，但在识别这些螺旋的确切起始和末端残基方面表现会很差。\n\nD. Group A 使用较小窗口的方法在根本上更好，因为二级结构几乎完全由相邻残基之间的相互作用决定，这使得小窗口之外的残基信息变得无关紧要。\n\nE. 窗口大小的选择是一个次要参数；Group A 和 Group B 的整体预测准确性将几乎相同，并且几乎完全取决于他们实施的统计评分方案的质量。",
            "solution": "该问题要求我们评估在一种简单的、基于统计的蛋白质二级结构预测方法中，选择窗口大小所涉及的权衡。问题的核心在于理解局部序列上下文的数量（由窗口大小决定）如何影响对二级结构元素不同部分的预测质量。\n\n让我们分析使用小窗口与大窗口的后果。\n\n**小窗口分析（例如 $W=7$，Group A 的方法）：**\n小窗口只使用被预测的中心残基两侧少数几个残基的信息。\n- **优点：** 当窗口位于两种不同结构类型之间的边界时（例如，$\\alpha$-螺旋结束和无规卷曲开始的地方），小窗口是有利的。它可以精确地捕捉到标志着一种结构终止和另一种结构开始的局部序列特征。对于位于螺旋C-末端的残基，小窗口将包含上游倾向于形成螺旋的残基和下游倾向于形成卷曲的残基的混合，为“螺旋末端”状态提供了一个明确的信号。因此，较小的窗口通常更善于描绘二级结构元素的精确末端。\n- **缺点：** 小窗口包含的统计信息较少。预测对少数几个氨基酸的特性高度敏感，很容易因为单个具有与周围结构元素不符的倾向性的残基而被干扰。更重要的是，它可能无法捕捉到对二级结构稳定性至关重要的稍长程的模式。例如，$\\alpha$-螺旋是通过残基 $i$ 和残基 $i+4$ 的主链原子之间的氢键来稳定的。一个以残基 $i$ 为中心、大小为7的窗口仅延伸到 $i+3$，可能无法完全捕捉到这个基本模式。这使得对二级结构元素稳定核心中残基的预测变得不太可靠。\n\n**大窗口分析（例如 $W=17$，Group B 的方法）：**\n大窗口对更长一段序列的倾向性进行平均。\n- **优点：** 当窗口位于一个长的、统一的二级结构元素深处时（比如一个长$\\alpha$-螺旋的中部），它将完全被对该结构有高倾向性的残基填满。这提供了一个非常强、清晰且统计上稳健的信号。预测不易受到一两个异常残基的噪声影响。因此，大窗口通常更善于正确识别长螺旋和折叠稳定核心中残基的状态。\n- **缺点：** 大窗口的主要缺点在边界处变得明显。考虑一个作为螺旋最后一个残基的中心残基。一个大小为17的大窗口将向螺旋内延伸8个残基，并向随后的无规卷曲区域延伸8个残基。对中心残基的预测将基于强螺旋信号和强卷曲信号的“平均值”。这种“模糊”或“过度平滑”效应通常会导致对边界残基本身及其近邻的错误预测。该算法将无法检测到急剧的转变，并且通常会错误地将螺旋预测延伸到卷曲区域，反之亦然。\n\n**评估选项：**\n\n- **A：** 这个陈述是错误的。“在所有方面都更优越”和“总是能”是绝对的说法，忽略了大窗口固有的边界预测问题。\n- **B：** 这个陈述是错误的。它颠倒了角色。小窗口通常在识别长元素核心方面效果*较差*，因为它统计能力较弱，并且可能错过较长程的稳定模式。大窗口更适合核心区域。\n- **C：** 这个陈述正确地抓住了权衡。大窗口（Group B）提供更强的统计能力，改善了对长元素核心（“长$\\alpha$-螺旋的中段”）的预测。然而，同样的平均特性（“模糊”）使其在解决急剧转变方面表现不佳，因此它在“识别确切的起始和末端残基方面准确性较低”。这与我们的分析完全一致。\n- **D：** 这个陈述是错误的。虽然局部相互作用非常重要，但相互作用不限于紧邻的残基（例如，螺旋中的 $i, i+4$ 模式）。声称小窗口之外的信息“无关紧要”是一种错误的过度简化。\n- **E：** 这个陈述是错误的。窗口大小是一个关键的超参数，它定义了算法使用的信息的数量和类型。将其从7更改为17将对算法的性能特征产生巨大且可预测的影响，正如上面在权衡中所描述的。它不是一个“次要参数”。\n\n因此，陈述 C 提供了对情况最准确、最细致的描述。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "现代预测器早已超越简单的统计倾向，转而采用概率模型来量化和整合来自序列的多种证据。本练习将引导你应用机器学习中的基石——贝叶斯定理——来解决一个实际的生物信息学问题。你将学习如何结合关于螺旋N端加帽基序的先验知识和局部序列特征的观测证据，定量地计算出某个残基作为$\\alpha$-螺旋起点的后验概率，这正是构建高级预测模型所需的核心技能。",
            "id": "4601343",
            "problem": "在一个蛋白质二级结构预测流程中，一个二元潜变量 $H$ 标记给定位置 $i$ 是否为$\\alpha$-螺旋的N-末端边界（起始点）（$H=1$）或不是（$H=0$）。加帽基序和局部边界效应被建模为在给定状态 $H$ 的条件下生成的可观测二元特征。考虑位置 $i$ 及其周围的三个具有生物学基础的特征：$E_{1}$ 表示位置 $i$ 的残基是丝氨酸或苏氨酸（一种N-端加帽偏好），$E_{2}$ 表示位置 $i-1$ 的残基是甘氨酸（一个有利的N-端加帽伙伴），以及 $E_{3}$ 表示位置 $i+1$ 的残基是脯氨酸（一种不利于螺旋延续的边界破坏效应）。假设给定 $H$ 时，特征 $E_{1}$、$E_{2}$ 和 $E_{3}$ 是条件独立的。从一个经过整理的非冗余结构数据集中得到的经验估计产生以下类条件概率：\n- $P(E_{1}=1 \\mid H=1) = 0.35$，$P(E_{1}=1 \\mid H=0) = 0.14$，\n- $P(E_{2}=1 \\mid H=1) = 0.24$，$P(E_{2}=1 \\mid H=0) = 0.15$，\n- $P(E_{3}=1 \\mid H=1) = 0.10$，$P(E_{3}=1 \\mid H=0) = 0.25$。\n任何位置是$\\alpha$-螺旋起始点的先验概率为 $P(H=1) = 0.08$。在位置 $i$ 周围的一个序列窗口中，观测到 $E_{1}=1$，$E_{2}=1$ 和 $E_{3}=1$。仅使用基本概率原理和所述的建模假设，确定后验概率 $P(H=1 \\mid E_{1}=1, E_{2}=1, E_{3}=1)$，以小数形式表示并四舍五入到四位有效数字。无需单位。",
            "solution": "我们的目标是计算后验概率 $P(H=1 \\mid E_1=1, E_2=1, E_3=1)$。为此，我们应用贝叶斯定理。设 $\\mathcal{E}$ 表示观测到的证据 $\\{E_1=1, E_2=1, E_3=1\\}$。\n\n贝叶斯定理的公式为：\n$$P(H=1 \\mid \\mathcal{E}) = \\frac{P(\\mathcal{E} \\mid H=1) P(H=1)}{P(\\mathcal{E})}$$\n\n1.  **计算分子**:\n    *   先验概率 $P(H=1)$ 已知为 $0.08$。\n    *   似然 $P(\\mathcal{E} \\mid H=1)$ 可以使用条件独立性假设计算：\n    $$P(\\mathcal{E} \\mid H=1) = P(E_1=1 \\mid H=1) \\times P(E_2=1 \\mid H=1) \\times P(E_3=1 \\mid H=1)$$\n    $$P(\\mathcal{E} \\mid H=1) = 0.35 \\times 0.24 \\times 0.10 = 0.0084$$\n    *   因此，分子为 $P(\\mathcal{E} \\mid H=1) P(H=1) = 0.0084 \\times 0.08 = 0.000672$。\n\n2.  **计算分母 (边际似然)**:\n    *   分母 $P(\\mathcal{E})$ 使用全概率定律计算：\n    $$P(\\mathcal{E}) = P(\\mathcal{E} \\mid H=1) P(H=1) + P(\\mathcal{E} \\mid H=0) P(H=0)$$\n    *   我们需要 $P(H=0)$ 和 $P(\\mathcal{E} \\mid H=0)$。\n    *   $P(H=0) = 1 - P(H=1) = 1 - 0.08 = 0.92$。\n    *   同样使用条件独立性：\n    $$P(\\mathcal{E} \\mid H=0) = P(E_1=1 \\mid H=0) \\times P(E_2=1 \\mid H=0) \\times P(E_3=1 \\mid H=0)$$\n    $$P(\\mathcal{E} \\mid H=0) = 0.14 \\times 0.15 \\times 0.25 = 0.00525$$\n    *   将这些值代入全概率公式：\n    $$P(\\mathcal{E}) = (0.0084 \\times 0.08) + (0.00525 \\times 0.92) = 0.000672 + 0.00483 = 0.005502$$\n\n3.  **计算后验概率**:\n    *   现在我们将分子和分母结合起来：\n    $$P(H=1 \\mid \\mathcal{E}) = \\frac{0.000672}{0.005502} \\approx 0.1221374$$\n    *   四舍五入到四位有效数字，我们得到 $0.1221$。\n\n这个后验概率（$0.1221$）高于先验概率（$0.08$），表明观测到的证据组合总体上增加了该位置是$\\alpha$-螺旋N-末端的可能性。",
            "answer": "$$\\boxed{0.1221}$$"
        },
        {
            "introduction": "将机器学习模型从训练环境部署到实际应用中，常常会面临一个严峻的挑战：数据集漂移，即测试数据的统计特性与训练数据不同。本高级练习聚焦于“先验概率漂移”这一特定情况，即结构类别（如螺旋与非螺旋）的整体丰度发生变化。你将推导一个重要的校准公式，用于调整分类器在不同类别分布下输出的概率，并使用加权Brier分数这一对类别不平衡敏感的度量标准来评估校准后模型的性能，这对于构建可靠的预测工具至关重要。",
            "id": "4601358",
            "problem": "在蛋白质二级结构预测中，一种常见的二元简化是区分螺旋（$H$）和非螺旋（$\\neg H$）。考虑一个在源数据集上训练的概率分类器，其中螺旋的丰度为 $ \\pi_{s} = 0.65 $。该分类器输出源校准的后验概率 $ p_{s}(x) = \\mathbb{P}_{s}(H \\mid x) $。在部署时，目标丰度转变为 $ \\pi_{t} = 0.25 $，并且可以假设存在先验概率漂移（prior probability shift），即类条件特征分布 $ p(x \\mid H) $ 和 $ p(x \\mid \\neg H) $ 在源域和目标域之间是不变的。\n\n现给定四个残基及其在目标域中的源校准概率和真实标签：\n- 残基 $1$：$p_{s}(x_{1}) = 0.95$， $y_{1} = 0$，\n- 残基 $2$：$p_{s}(x_{2}) = 0.70$， $y_{2} = 1$，\n- 残基 $3$：$p_{s}(x_{3}) = 0.40$， $y_{3} = 1$，\n- 残基 $4$：$p_{s}(x_{4}) = 0.20$， $y_{4} = 0$，\n\n其中 $ y_{i} \\in \\{0,1\\} $，$1$ 表示螺旋。\n\n仅使用概率论的基本定义和先验概率漂移的假设，首先从第一性原理推导一个表达式，将 $ p_{s}(x) $ 映射到目标后验概率 $ p_{t}(x) = \\mathbb{P}_{t}(H \\mid x) $，并用 $ \\pi_{s} $ 和 $ \\pi_{t} $ 表示。然后，使用调整后的概率 $ p_{t}(x_{i}) $ 和以下依赖于类别的权重，计算这四个残基的类别不平衡加权 Brier 分数：\n- 对于 $ y_{i} = 1 $，权重为 $ w(1) = \\frac{1}{\\pi_{t}} $，\n- 对于 $ y_{i} = 0 $，权重为 $ w(0) = \\frac{1}{1-\\pi_{t}} $。\n\n加权 Brier 分数定义为：\n$$\n\\mathrm{Brier}_{w} = \\frac{\\sum_{i=1}^{4} w(y_{i}) \\big(y_{i} - p_{t}(x_{i})\\big)^{2}}{\\sum_{i=1}^{4} w(y_{i})}.\n$$\n\n提供 $ \\mathrm{Brier}_{w} $ 的最终值，作为一个无单位实数，四舍五入到四位有效数字。",
            "solution": "该问题要求完成两个主要任务：首先，推导在先验概率漂移下调整后验概率的表达式；其次，使用该表达式为一组给定的数据点计算加权 Brier 分数。\n\n**第一部分：目标后验概率的推导**\n\n设 $H$ 表示残基处于螺旋状态的事件，$\\neg H$ 表示其互补事件。源域（$s$）和目标域（$t$）对于螺旋类具有不同的先验概率（丰度），分别表示为 $\\pi_{s} = \\mathbb{P}_{s}(H)$ 和 $\\pi_{t} = \\mathbb{P}_{t}(H)$。源校准的后验概率为 $p_{s}(x) = \\mathbb{P}_{s}(H \\mid x)$，我们寻求目标后验概率 $p_{t}(x) = \\mathbb{P}_{t}(H \\mid x)$。\n\n核心假设是先验概率漂移，这意味着特征 $x$ 的类条件似然在不同域之间是不变的：\n$$p_{s}(x \\mid H) = p_{t}(x \\mid H) = p(x \\mid H)$$\n$$p_{s}(x \\mid \\neg H) = p_{t}(x \\mid \\neg H) = p(x \\mid \\neg H)$$\n\n我们可以使用贝叶斯定理在两个域中表达后验概率。对于源域：\n$$p_{s}(x) = \\frac{p(x \\mid H) \\mathbb{P}_{s}(H)}{p(x \\mid H) \\mathbb{P}_{s}(H) + p(x \\mid \\neg H) \\mathbb{P}_{s}(\\neg H)} = \\frac{p(x \\mid H) \\pi_{s}}{p(x \\mid H) \\pi_{s} + p(x \\mid \\neg H) (1 - \\pi_{s})}$$\n使用发生比（odds）处理更为方便。源域中的后验发生比为：\n$$\\frac{p_{s}(x)}{1-p_{s}(x)} = \\frac{p(x \\mid H) \\pi_{s}}{p(x \\mid \\neg H) (1 - \\pi_{s})} = \\frac{p(x \\mid H)}{p(x \\mid \\neg H)} \\frac{\\pi_{s}}{1-\\pi_{s}}$$\n该方程将后验发生比与似然比 $\\frac{p(x \\mid H)}{p(x \\mid \\neg H)}$ 和先验发生比 $\\frac{\\pi_{s}}{1-\\pi_{s}}$ 联系起来。由于似然比在不同域之间是不变的，我们可以用源域的量来表示它：\n$$\\frac{p(x \\mid H)}{p(x \\mid \\neg H)} = \\frac{p_{s}(x)}{1-p_{s}(x)} \\frac{1-\\pi_{s}}{\\pi_{s}}$$\n现在，我们写出目标域的后验发生比：\n$$\\frac{p_{t}(x)}{1-p_{t}(x)} = \\frac{p(x \\mid H)}{p(x \\mid \\neg H)} \\frac{\\pi_{t}}{1-\\pi_{t}}$$\n代入不变的似然比的表达式：\n$$\\frac{p_{t}(x)}{1-p_{t}(x)} = \\left(\\frac{p_{s}(x)}{1-p_{s}(x)} \\frac{1-\\pi_{s}}{\\pi_{s}}\\right) \\frac{\\pi_{t}}{1-\\pi_{t}} = \\frac{p_{s}(x)}{1-p_{s}(x)} \\left( \\frac{\\pi_{t}(1-\\pi_{s})}{\\pi_{s}(1-\\pi_{t})} \\right)$$\n我们定义一个校正因子 $A = \\frac{\\pi_{t}(1-\\pi_{s})}{\\pi_{s}(1-\\pi_{t})}$。目标后验发生比为 $o_{t}(x) = o_{s}(x) \\cdot A$。为了求得概率 $p_{t}(x)$，我们将发生比转换回来：\n$$p_{t}(x) = \\frac{\\frac{p_{t}(x)}{1-p_{t}(x)}}{1 + \\frac{p_{t}(x)}{1-p_{t}(x)}} = \\frac{\\frac{p_{s}(x)}{1-p_{s}(x)} A}{1 + \\frac{p_{s}(x)}{1-p_{s}(x)} A}$$\n分子和分母同乘以 $1-p_{s}(x)$，得到所需的表达式：\n$$p_{t}(x) = \\frac{A \\cdot p_{s}(x)}{(1-p_{s}(x)) + A \\cdot p_{s}(x)}$$\n\n**第二部分：加权 Brier 分数的计算**\n\n首先，我们使用给定的丰度 $\\pi_{s} = 0.65$ 和 $\\pi_{t} = 0.25$ 计算校正因子 $A$ 的数值。\n$$A = \\frac{0.25 \\cdot (1-0.65)}{0.65 \\cdot (1-0.25)} = \\frac{0.25 \\cdot 0.35}{0.65 \\cdot 0.75} = \\frac{0.0875}{0.4875} = \\frac{875}{4875} = \\frac{7}{39}$$\n从源概率到目标概率的映射为：\n$$p_{t}(x) = \\frac{\\frac{7}{39} p_{s}(x)}{(1-p_{s}(x)) + \\frac{7}{39} p_{s}(x)}$$\n接下来，我们为给定的四个残基计算调整后的概率 $p_{t}(x_{i})$：\n- 残基 $1$：$p_{s}(x_{1}) = 0.95$, $y_{1}=0$。\n  $p_{t}(x_{1}) = \\frac{\\frac{7}{39} (0.95)}{1-0.95 + \\frac{7}{39} (0.95)} = \\frac{\\frac{7}{39} \\frac{19}{20}}{\\frac{1}{20} + \\frac{7}{39} \\frac{19}{20}} = \\frac{7 \\cdot 19}{39 + 7 \\cdot 19} = \\frac{133}{39+133} = \\frac{133}{172}$。\n- 残基 $2$：$p_{s}(x_{2}) = 0.70$, $y_{2}=1$。\n  $p_{t}(x_{2}) = \\frac{\\frac{7}{39} (0.7)}{1-0.7 + \\frac{7}{39} (0.7)} = \\frac{\\frac{7}{39} \\frac{7}{10}}{\\frac{3}{10} + \\frac{7}{39} \\frac{7}{10}} = \\frac{7 \\cdot 7}{39 \\cdot 3 + 7 \\cdot 7} = \\frac{49}{117+49} = \\frac{49}{166}$。\n- 残基 $3$：$p_{s}(x_{3}) = 0.40$, $y_{3}=1$。\n  $p_{t}(x_{3}) = \\frac{\\frac{7}{39} (0.4)}{1-0.4 + \\frac{7}{39} (0.4)} = \\frac{\\frac{7}{39} \\frac{2}{5}}{\\frac{3}{5} + \\frac{7}{39} \\frac{2}{5}} = \\frac{7 \\cdot 2}{39 \\cdot 3 + 7 \\cdot 2} = \\frac{14}{117+14} = \\frac{14}{131}$。\n- 残基 $4$：$p_{s}(x_{4}) = 0.20$, $y_{4}=0$。\n  $p_{t}(x_{4}) = \\frac{\\frac{7}{39} (0.2)}{1-0.2 + \\frac{7}{39} (0.2)} = \\frac{\\frac{7}{39} \\frac{1}{5}}{\\frac{4}{5} + \\frac{7}{39} \\frac{1}{5}} = \\frac{7}{39 \\cdot 4 + 7} = \\frac{7}{156+7} = \\frac{7}{163}$。\n\n依赖于类别的权重为：\n$w(1) = \\frac{1}{\\pi_{t}} = \\frac{1}{0.25} = 4$。\n$w(0) = \\frac{1}{1-\\pi_{t}} = \\frac{1}{1-0.25} = \\frac{1}{0.75} = \\frac{4}{3}$。\n\n加权 Brier 分数由 $\\mathrm{Brier}_{w} = \\frac{N}{D}$ 给出，其中 $N = \\sum_{i=1}^{4} w(y_{i}) (y_{i} - p_{t}(x_{i}))^{2}$ 且 $D = \\sum_{i=1}^{4} w(y_{i})$。\n分母是：\n$D = w(y_1) + w(y_2) + w(y_3) + w(y_4) = w(0) + w(1) + w(1) + w(0) = 2 w(0) + 2 w(1) = 2(\\frac{4}{3}) + 2(4) = \\frac{8}{3} + 8 = \\frac{32}{3}$。\n分子由四项组成：\n- 第1项：$w(0) (0 - p_t(x_1))^2 = \\frac{4}{3} (\\frac{133}{172})^2 \\approx 0.79723$。\n- 第2项：$w(1) (1 - p_t(x_2))^2 = 4 (1 - \\frac{49}{166})^2 = 4 (\\frac{117}{166})^2 \\approx 1.98708$。\n- 第3项：$w(1) (1 - p_t(x_3))^2 = 4 (1 - \\frac{14}{131})^2 = 4 (\\frac{117}{131})^2 \\approx 3.19072$。\n- 第4项：$w(0) (0 - p_t(x_4))^2 = \\frac{4}{3} (\\frac{7}{163})^2 \\approx 0.00246$。\n\n现在我们将这些项相加：\n$N \\approx 0.79723 + 1.98708 + 3.19072 + 0.00246 = 5.97749$。\n最后，我们计算分数：\n$\\mathrm{Brier}_{w} = \\frac{N}{D} \\approx \\frac{5.97749}{32/3} = \\frac{5.97749 \\times 3}{32} \\approx \\frac{17.93247}{32} \\approx 0.56039$。\n\n四舍五入到四位有效数字得到 $0.5604$。",
            "answer": "$$\\boxed{0.5604}$$"
        }
    ]
}