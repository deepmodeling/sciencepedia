{
    "hands_on_practices": [
        {
            "introduction": "真实的基因组背景并非均匀一致；某些区域天然会比其他区域积累更多的读段。简单的全局背景模型可能导致假阳性或假阴性结果。本练习将展示一种受MACS等流行工具启发的高级方法，该方法通过估计一个更稳健的局部背景率来解决这一问题。通过这个练习，你将学会如何根据局部基因组环境调整背景模型，这是提高峰值识别准确性的关键一步。",
            "id": "4545492",
            "problem": "一个组蛋白修饰染色质免疫共沉淀测序 (ChIP-seq) 的 peak-calling 流程将处理样本中分箱的读数计数建模为泊松随机变量的实现，其均值（期望计数）由局部估计的背景率给出。在广泛使用的方法中，例如基于模型的 ChIP-Sequencing 分析 (Model-based Analysis of ChIP-Sequencing, MACS)，候选位点的局部背景期望通过在全局背景率和在多个空间尺度上计算的窗口归一化对照率中选择最大值来稳定。具体来说，假设观察并假定以下内容：\n- 测试箱的宽度为 $200$ 个碱基对 (bp)。\n- 位点周围的对照样本计数在 $1\\,\\mathrm{kb}$ 窗口中为 $5$，在 $5\\,\\mathrm{kb}$ 窗口中为 $18$，在 $10\\,\\mathrm{kb}$ 窗口中为 $24$，其中 $1\\,\\mathrm{kb} = 1000\\,\\mathrm{bp}$。\n- 全局背景率为 $\\lambda_{\\mathrm{global}} = 2$ 计数/每 $200\\,\\mathrm{bp}$ 箱。\n- 处理和对照文库具有相同的总测序深度，因此不需要进一步的文库大小缩放。\n- 在该位点的测试箱中观察到的处理计数为 $30$。\n\n在泊松模型下，并使用多尺度稳定化规则 $\\lambda_{\\mathrm{local}} = \\max\\{\\lambda_{\\mathrm{global}}, \\lambda_{1\\,\\mathrm{kb}}, \\lambda_{5\\,\\mathrm{kb}}, \\lambda_{10\\,\\mathrm{kb}}\\}$，其中每个 $\\lambda_{w}$ 是通过将宽度为 $w$ 的窗口中的对照计数通过“计数密度乘以箱宽度”的方法归一化到 $200\\,\\mathrm{bp}$ 测试箱来获得的，计算：\n1. $200\\,\\mathrm{bp}$ 箱的局部期望计数 $\\lambda_{\\mathrm{local}}$。\n2. 用于检验处理样本中富集的单侧泊松 $p$ 值 $P(X \\geq 30 \\mid \\lambda_{\\mathrm{local}})$，其中 $X$ 表示箱中的泊松计数。\n\n以每 $200\\,\\mathrm{bp}$ 箱的计数值（无量纲）精确报告 $\\lambda_{\\mathrm{local}}$，并将 $p$ 值四舍五入到三位有效数字。将 $p$ 值以科学记数法表示为无量纲小数。",
            "solution": "我们从泊松分布的定义开始：如果 $X \\sim \\mathrm{Pois}(\\lambda)$，那么概率质量函数是\n$$\nP(X = n \\mid \\lambda) = \\exp(-\\lambda)\\,\\frac{\\lambda^{n}}{n!},\n$$\n对于 $n \\in \\{0,1,2,\\dots\\}$。在零假设 $\\mathrm{Pois}(\\lambda)$ 模型下，观察到至少 $k$ 个读数的单侧富集 $p$ 值是\n$$\nP(X \\geq k \\mid \\lambda) = \\sum_{n=k}^{\\infty} \\exp(-\\lambda)\\,\\frac{\\lambda^{n}}{n!} = 1 - \\sum_{n=0}^{k-1} \\exp(-\\lambda)\\,\\frac{\\lambda^{n}}{n!}.\n$$\n等价地，用正则化的上不完全伽马函数表示，对于整数 $k$，\n$$\nP(X \\geq k \\mid \\lambda) = \\frac{\\Gamma(k, \\lambda)}{\\Gamma(k)}.\n$$\n\n局部背景期望被稳定化为\n$$\n\\lambda_{\\mathrm{local}} = \\max\\left\\{\\lambda_{\\mathrm{global}}, \\lambda_{1\\,\\mathrm{kb}}, \\lambda_{5\\,\\mathrm{kb}}, \\lambda_{10\\,\\mathrm{kb}}\\right\\},\n$$\n其中每个窗口归一化的期望 $\\lambda_{w}$ 是通过将宽度为 $w$ 的窗口中的对照计数，通过“密度乘以箱宽度”的方法转换为 $200\\,\\mathrm{bp}$ 测试箱中的期望计数来计算的：\n$$\n\\lambda_{w} = \\left(\\frac{c_{w}}{w}\\right)\\times 200,\n$$\n其中 $c_{w}$ 是 $w$-bp 窗口中的对照计数。在文库大小相等的假设下，不需要额外的缩放因子。\n\n计算每个 $\\lambda_{w}$：\n- 对于 $w = 1\\,\\mathrm{kb} = 1000\\,\\mathrm{bp}$ 和 $c_{1\\,\\mathrm{kb}} = 5$，\n$$\n\\lambda_{1\\,\\mathrm{kb}} = \\left(\\frac{5}{1000}\\right)\\times 200 = 1.\n$$\n- 对于 $w = 5\\,\\mathrm{kb} = 5000\\,\\mathrm{bp}$ 和 $c_{5\\,\\mathrm{kb}} = 18$，\n$$\n\\lambda_{5\\,\\mathrm{kb}} = \\left(\\frac{18}{5000}\\right)\\times 200 = 0.72.\n$$\n- 对于 $w = 10\\,\\mathrm{kb} = 10000\\,\\mathrm{bp}$ 和 $c_{10\\,\\mathrm{kb}} = 24$，\n$$\n\\lambda_{10\\,\\mathrm{kb}} = \\left(\\frac{24}{10000}\\right)\\times 200 = 0.48.\n$$\n给定 $\\lambda_{\\mathrm{global}} = 2$，我们有\n$$\n\\lambda_{\\mathrm{local}} = \\max\\{2, 1, 0.72, 0.48\\} = 2.\n$$\n\n现在计算在 $X \\sim \\mathrm{Pois}(\\lambda_{\\mathrm{local}})$ 且 $\\lambda_{\\mathrm{local}} = 2$ 的条件下，观察到 $k = 30$ 的单侧 $p$ 值：\n$$\nP(X \\geq 30 \\mid \\lambda = 2) = \\sum_{n=30}^{\\infty} \\exp(-2)\\,\\frac{2^{n}}{n!}.\n$$\n首项是\n$$\nP(X = 30 \\mid \\lambda = 2) = \\exp(-2)\\,\\frac{2^{30}}{30!}.\n$$\n我们可以通过使用 $2^{30} = 1{,}073{,}741{,}824$ 和精确的阶乘 $30! = 265252859812191058636308480000000$ 来评估此项，得到\n$$\nP(X = 30 \\mid \\lambda = 2) = \\exp(-2)\\,\\frac{1{,}073{,}741{,}824}{265252859812191058636308480000000}.\n$$\n数值上，$\\exp(-2) \\approx 0.1353352832366127$，因此\n$$\nP(X = 30 \\mid \\lambda = 2) \\approx 5.48 \\times 10^{-25}.\n$$\n为了近似 $n=30$ 以上的上尾部，注意递归比率\n$$\n\\frac{P(X = n+1 \\mid \\lambda)}{P(X = n \\mid \\lambda)} = \\frac{\\lambda}{n+1}.\n$$\n在 $n = 30$ 和 $\\lambda = 2$ 时，这个比率是 $\\frac{2}{31} \\approx 0.064516129$，并且对于更大的 $n$ 它会进一步减小。因此，尾部和可以由一个快速收敛的级数很好地近似：\n$$\n\\sum_{n=30}^{\\infty} P(X = n \\mid \\lambda=2) = P(X=30 \\mid \\lambda=2)\\left(1 + \\frac{2}{31} + \\frac{2}{31}\\cdot\\frac{2}{32} + \\frac{2}{31}\\cdot\\frac{2}{32}\\cdot\\frac{2}{33} + \\dots \\right).\n$$\n计算括号内乘法因子的前几项，近似得到\n$$\n1 + 0.064516129 + 0.004032508 + 0.000244097 + 0.000014360 + 0.000000819 + \\dots \\approx 1.068807962.\n$$\n因此，\n$$\nP(X \\geq 30 \\mid \\lambda = 2) \\approx \\left(5.48 \\times 10^{-25}\\right)\\times 1.068807962 \\approx 5.86 \\times 10^{-25}.\n$$\n或者，使用正则化的上不完全伽马函数，$P(X \\geq 30 \\mid \\lambda = 2) = \\Gamma(30,2)/\\Gamma(30)$，其数值计算结果相同。\n\n因此，所求的量为\n$$\n\\lambda_{\\mathrm{local}} = 2,\\quad P(X \\geq 30 \\mid \\lambda_{\\mathrm{local}}) \\approx 5.86 \\times 10^{-25},\n$$\n其中 $p$ 值按要求四舍五入到三位有效数字。",
            "answer": "$$\\boxed{\\begin{pmatrix}2 & 5.86 \\times 10^{-25}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在鉴定出具有显著富集的单个区间（bin）后，下一步通常需要以生物学上有意义的方式解释这些信号，特别是对于像H3K27me3这样的广泛型组蛋白修饰。本练习将介绍“缝合”（stitching）的概念，这是一种常见的后处理技术，用于将邻近的富集区间合并成更大的结构域（domain）。通过这个练习，你将理解如何从离散的统计显著位点过渡到定义连续的功能性结构域，这对于分析广泛型表观遗传标记的生物学作用至关重要。",
            "id": "4545442",
            "problem": "针对广泛组蛋白修饰，例如组蛋白H3赖氨酸27三甲基化（H3K27me3）的染色质免疫沉淀测序（ChIP-seq），其分析方法通常是将基因组划分为等宽的区间（bin），并根据统计检验（例如，与输入对照进行泊松或负二项检验）识别富集的区间，然后将相邻的富集区间连接成域（domain），以容忍因抽样变异性导致的局部脱落。考虑一个单条染色体被划分为$20$个连续不重叠的区间，索引从$1$到$20$。设富集区间的索引集合为 $E=\\{2,3,4,7,8,12,13,14,15,19\\}$。连接规则由一个非负整数的间隙容差 $g$ 定义，该规则允许跨越最多 $g$ 个中间的未富集区间来合并富集区间。形式上，如果位于索引 $i",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、问题明确、客观、内部一致，并包含了推导出唯一解所需的所有必要信息。\n\n该问题要求我们识别富集基因组区间的连接域并报告其跨度。区间总数为$20$个，索引从$1$到$20$。富集区间的索引集合为 $E=\\{2, 3, 4, 7, 8, 12, 13, 14, 15, 19\\}$。\n\n连接两个位于索引 $i$ 和 $j$（其中 $i",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 4 & 7 & 8 & 12 & 15 & 19 & 19\n\\end{pmatrix}\n}\n$$"
        }
    ]
}