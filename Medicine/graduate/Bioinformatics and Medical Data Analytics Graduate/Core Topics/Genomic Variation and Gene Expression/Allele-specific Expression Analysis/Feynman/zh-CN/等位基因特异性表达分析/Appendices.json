{
    "hands_on_practices": [
        {
            "introduction": "虽然可以在单个SNP位点评估等位基因特异性表达（ASE），但一种更强大的方法是整合基因内所有杂合位点的信息。本练习将演示如何通过汇总读数计数来推导基因水平等位基因比例的最大似然估计，这是ASE分析中的一项基本技术。",
            "id": "4539400",
            "problem": "一位研究人员正在使用RNA测序（RNA-seq）对单个基因进行等位基因特异性表达分析。在该基因内，存在 $s$ 个杂合的单核苷酸多态性（SNPs），索引为 $i \\in \\{1,\\dots,s\\}$。在SNP $i$ 处，测序产生了 $n_i$ 条信息性读数，其中 $k_i$ 条支持参考等位基因。假设，在给定一个在该基因中所有SNP上都恒定的基因水平等位基因比例 $p \\in (0,1)$ 的条件下，每个SNP的读数计数是独立的，并且由一个二项式抽样过程生成，因此对于每个 $i$，$K_i \\sim \\mathrm{Binomial}(n_i,p)$，且在 $i$ 之间相互独立。\n\n仅使用这些假设和二项分布的定义，从第一性原理推导基因水平等位基因比例的最大似然估计量，以及一个基于Fisher信息的Wald型标准误。然后对以下数据计算这两个量：\n- $s = 6$ 个位点，各位点的计数 $(k_i,n_i)$ 由 $[(47,80),(29,50),(15,30),(40,70),(22,45),(9,25)]$ 给出。\n\n清楚地说明你所引用的任何正则性条件。提供点估计及其标准误的数值。将你的答案四舍五入到 $4$ 位有效数字。将你的最终答案表示为一个没有单位的、包含两个条目的单行矩阵 $[\\hat{p}\\ \\ \\mathrm{SE}(\\hat{p})]$。如果存在百分比，必须表示为小数（例如，用 $0.62$ 而不是 $62\\%$）。",
            "solution": "该问题具有科学依据，提法明确，并为一项标准的统计估计任务提供了完整且一致的设置。因此，该问题被认为是有效的。\n\n问题陈述了对于 $s$ 个杂合SNP，在 $n_i$ 个总信息性读数中支持参考等位基因的读数数量 $K_i$ 服从二项分布。具体来说，对于 $i \\in \\{1, \\dots, s\\}$，$K_i \\sim \\mathrm{Binomial}(n_i, p)$，其中 $p$ 是基因水平的等位基因比例。各SNP的观测值是独立的。数据由数对 $(k_i, n_i)$ 组成，它们是随机变量 $(K_i, n_i)$ 的实现。\n\n首先，我们推导 $p$ 的最大似然估计量（MLE）。单个观测值 $K_i = k_i$ 的概率质量函数由下式给出：\n$$ P(K_i=k_i | p) = \\binom{n_i}{k_i} p^{k_i} (1-p)^{n_i-k_i} $$\n由于各SNP的观测值是独立的，完整数据集 $\\{ (k_i, n_i) \\}_{i=1}^s$ 的联合似然函数 $L(p)$ 是各个概率的乘积：\n$$ L(p) = \\prod_{i=1}^{s} P(K_i=k_i | p) = \\prod_{i=1}^{s} \\binom{n_i}{k_i} p^{k_i} (1-p)^{n_i-k_i} $$\n为了找到MLE，我们最大化对数似然函数 $\\ell(p) = \\ln L(p)$，这在计算上更为简便。\n$$ \\ell(p) = \\ln \\left( \\prod_{i=1}^{s} \\binom{n_i}{k_i} p^{k_i} (1-p)^{n_i-k_i} \\right) = \\sum_{i=1}^{s} \\ln \\left( \\binom{n_i}{k_i} p^{k_i} (1-p)^{n_i-k_i} \\right) $$\n$$ \\ell(p) = \\sum_{i=1}^{s} \\left( \\ln\\binom{n_i}{k_i} + k_i \\ln(p) + (n_i - k_i) \\ln(1-p) \\right) $$\n这可以通过分离依赖于 $p$ 的项来简化：\n$$ \\ell(p) = \\left( \\sum_{i=1}^{s} \\ln\\binom{n_i}{k_i} \\right) + \\left( \\sum_{i=1}^{s} k_i \\right) \\ln(p) + \\left( \\sum_{i=1}^{s} (n_i - k_i) \\right) \\ln(1-p) $$\n令 $K_{tot} = \\sum_{i=1}^{s} k_i$ 和 $N_{tot} = \\sum_{i=1}^{s} n_i$。对数似然函数变为：\n$$ \\ell(p) = \\text{const} + K_{tot} \\ln(p) + (N_{tot} - K_{tot}) \\ln(1-p) $$\n为了找到使 $\\ell(p)$ 最大化的 $p$ 值，我们计算其关于 $p$ 的一阶导数（得分函数）并将其设为零：\n$$ \\frac{d\\ell(p)}{dp} = \\frac{K_{tot}}{p} - \\frac{N_{tot} - K_{tot}}{1-p} $$\n将导数设为 $0$ 以求得MLE，记为 $\\hat{p}$：\n$$ \\frac{K_{tot}}{\\hat{p}} = \\frac{N_{tot} - K_{tot}}{1-\\hat{p}} \\implies K_{tot}(1-\\hat{p}) = \\hat{p}(N_{tot} - K_{tot}) $$\n$$ K_{tot} - K_{tot}\\hat{p} = N_{tot}\\hat{p} - K_{tot}\\hat{p} \\implies K_{tot} = N_{tot}\\hat{p} $$\n求解 $\\hat{p}$，我们得到最大似然估计量：\n$$ \\hat{p} = \\frac{K_{tot}}{N_{tot}} = \\frac{\\sum_{i=1}^{s} k_i}{\\sum_{i=1}^{s} n_i} $$\n为确认这是一个最大值，我们检查二阶导数：\n$$ \\frac{d^2\\ell(p)}{dp^2} = -\\frac{K_{tot}}{p^2} - \\frac{N_{tot} - K_{tot}}{(1-p)^2} $$\n对于 $p \\in (0,1)$，并假设在一个非平凡的实验中 $0  K_{tot}  N_{tot}$，两项均为负。因此，$\\frac{d^2\\ell(p)}{dp^2}  0$，这证实了 $\\hat{p}$ 是一个唯一的最大值点。\n\n接下来，我们推导基于Fisher信息 $I(p)$ 的Wald型标准误。Fisher信息是对数似然函数二阶导数的期望值的负数：\n$$ I(p) = -E\\left[ \\frac{d^2\\ell(p)}{dp^2} \\right] = -E\\left[ -\\frac{\\sum_{i=1}^{s} K_i}{p^2} - \\frac{\\sum_{i=1}^{s} (n_i - K_i)}{(1-p)^2} \\right] $$\n我们使用期望的线性性质以及 $E[K_i] = n_i p$ 这一事实。总计数的期望为 $E[K_{tot}] = E[\\sum_{i=1}^{s} K_i] = \\sum_{i=1}^{s} E[K_i] = \\sum_{i=1}^{s} n_i p = p N_{tot}$。\n将此代入 $I(p)$ 的表达式中：\n$$ I(p) = \\frac{E[K_{tot}]}{p^2} + \\frac{E[N_{tot} - K_{tot}]}{(1-p)^2} = \\frac{p N_{tot}}{p^2} + \\frac{N_{tot} - p N_{tot}}{(1-p)^2} $$\n$$ I(p) = \\frac{N_{tot}}{p} + \\frac{N_{tot}(1-p)}{(1-p)^2} = \\frac{N_{tot}}{p} + \\frac{N_{tot}}{1-p} = N_{tot}\\left(\\frac{1-p+p}{p(1-p)}\\right) = \\frac{N_{tot}}{p(1-p)} $$\nMLE的渐近方差 $\\mathrm{Var}(\\hat{p})$ 是Fisher信息的倒数。通过在MLE $\\hat{p}$ 处评估此方差并取平方根，可以获得Wald型标准误。方差估计为：\n$$ \\widehat{\\mathrm{Var}}(\\hat{p}) = [I(\\hat{p})]^{-1} = \\frac{\\hat{p}(1-\\hat{p})}{N_{tot}} $$\n因此，标准误为：\n$$ \\mathrm{SE}(\\hat{p}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{p})} = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{N_{tot}}} $$\n此推导依赖于MLE的标准正则性条件，这些条件在此处得到满足，因为二项分布属于正则指数族。这些条件包括参数空间是开集、对数似然函数的可微性以及Fisher信息的正定性。\n\n现在我们计算数值。给定的数据是 $s=6$ 个位点，其 $(k_i, n_i)$ 对为：$[(47,80),(29,50),(15,30),(40,70),(22,45),(9,25)]$。\n\n首先，我们计算总计数 $K_{tot}$ 和 $N_{tot}$：\n$$ K_{tot} = \\sum_{i=1}^{6} k_i = 47 + 29 + 15 + 40 + 22 + 9 = 162 $$\n$$ N_{tot} = \\sum_{i=1}^{6} n_i = 80 + 50 + 30 + 70 + 45 + 25 = 300 $$\n$p$ 的最大似然估计为：\n$$ \\hat{p} = \\frac{K_{tot}}{N_{tot}} = \\frac{162}{300} = 0.54 $$\n$\\hat{p}$ 的Wald型标准误为：\n$$ \\mathrm{SE}(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{N_{tot}}} = \\sqrt{\\frac{0.54 \\times (1 - 0.54)}{300}} = \\sqrt{\\frac{0.54 \\times 0.46}{300}} $$\n$$ \\mathrm{SE}(\\hat{p}) = \\sqrt{\\frac{0.2484}{300}} = \\sqrt{0.000828} \\approx 0.0287750... $$\n将结果四舍五入到 $4$ 位有效数字：\n点估计 $\\hat{p}$ 为 $0.5400$。\n标准误 $\\mathrm{SE}(\\hat{p})$ 为 $0.02878$。\n最终答案表示为一个包含两个条目的行矩阵 $[\\hat{p}\\ \\ \\mathrm{SE}(\\hat{p})]$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5400  0.02878 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "基因组中等位基因呈等量（$1:1$）存在的基本假设常常被打破，尤其是在癌症等背景下。本练习探讨了当拷贝数变异（CNV）造成非均一的基因组背景时，如何为ASE正确构建原假设。这是避免假阳性结果的关键一步。",
            "id": "4539418",
            "problem": "肿瘤样本中的一个杂合单核苷酸多态性（SNP）位于受拷贝数变异（CNV）影响的基因组片段内。设两个等位基因携带的单倍体拷贝数分别为：等位基因A为$c_1$，等位基因B为$c_2$，其中$c_1,c_2 \\in \\mathbb{N}$表示样本中每个等位基因的基因组拷贝数（假设肿瘤纯度为$100\\%$且该片段内无亚克隆性）。您使用与该SNP重叠的核糖核酸测序（RNA-seq）读数（reads）进行等位基因特异性表达（ASE）分析。假设：\n- 每个基因组拷贝的转录输出相等（无内在的等位基因特异性调控）。\n- 检测中不存在等位基因比对、捕获或扩增偏好。\n- 读数是从该位点表达的转录本中独立同分布抽取的样本。\n\n在这些假设下，标准检验将总共$n$个信息性读数中来自等位基因A的特异性读数计数$X$建模为$X \\sim \\mathrm{Binomial}(n,p)$，其中$p$是随机抽样的读数来源于等位基因A的概率。以下哪个选项给出了正确考虑了CNV的$p$的原假设值表达式？\n\nA. $p = 0.5$\n\nB. $p = \\dfrac{c_1}{c_1 + c_2}$\n\nC. $p = \\dfrac{c_1}{c_2}$\n\nD. $p = \\dfrac{c_1^2}{c_1^2 + c_2^2}$\n\n选择唯一一个能正确指定原假设比例，并隐含地反映CNV如何通过改变每个等位基因的基因组拷贝数来改变预期等位基因比例的最佳答案。",
            "solution": "## 问题验证\n\n### 第1步：提取已知条件\n-   一个杂合单核苷酸多态性（SNP）位于一个肿瘤样本中。\n-   包含该SNP的基因组片段受到拷贝数变异（CNV）的影响。\n-   $c_1$：等位基因A的单倍体拷贝数，其中 $c_1 \\in \\mathbb{N}$。\n-   $c_2$：等位基因B的单倍体拷贝数，其中 $c_2 \\in \\mathbb{N}$。\n-   肿瘤样本纯度为$100\\%$。\n-   该片段内没有亚克隆性。\n-   使用RNA-seq读数分析等位基因特异性表达（ASE）。\n-   假设1：每个基因组拷贝的转录输出相等。\n-   假设2：没有等位基因比对、捕获或扩增偏好。\n-   假设3：读数是从该位点表达的转录本中独立同分布抽取的样本。\n-   来自等位基因A的特异性读数计数$X$，在总共$n$个信息性读数中，被建模为$X \\sim \\mathrm{Binomial}(n,p)$。\n-   $p$是随机抽样的读数来源于等位基因A的概率。\n-   问题要求给出考虑了CNV的$p$的原假设值的正确表达式。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据充分**：该问题在癌症基因组学和生物信息学领域有坚实的科学基础。SNP、CNV、ASE和RNA-seq的概念都是基础性的。使用二项分布来建模读数计数是标准的统计实践。这些假设定义了一个清晰的原假设模型，这是ASE假设检验中的常用方法。\n2.  **定义明确**：该问题定义明确。它提供了一套清晰的假设，并要求在指定模型内推导参数$p$。所提供的信息足以确定唯一解。\n3.  **客观性**：语言技术性强、精确，没有任何主观或模糊的术语。\n4.  **完整且一致**：问题陈述是自洽的。它定义了所有变量（$c_1, c_2, X, n, p$），并提供了将基因组状态（拷贝数）与转录组读出（读数计数）联系起来的必要假设。这些假设相互一致，定义了一个连贯的理论模型。条件$c_1, c_2 \\in \\mathbb{N}$（自然数，通常为$\\{1, 2, 3, \\dots\\}$）是明确的，并确保每个等位基因至少存在一个拷贝，这与初始的杂合状态一致，尽管如果一个拷贝数为$0$（假设$\\mathbb{N}$包含$0$），该框架也能适应杂合性丢失（Loss of Heterozygosity）的情景。\n5.  **现实性**：该情景是计算癌症生物学中一个标准且现实的问题。尽管像$100\\%$肿瘤纯度这样的简化是理想化的，但它们是创建易于处理的基线模型所常见且必需的。\n\n### 第3步：结论与操作\n问题陈述有效。它在科学上是合理的，定义明确，并且提供了推导解决方案所需的所有信息。\n\n## 解题推导\n\n问题要求一个二项分布参数$p$的原假设值，其中$p$是随机抽样的RNA-seq读数来源于等位基因A的概率。这个概率等同于在该位点，来源于等位基因A的转录本在A和B两个等位基因的总转录本池中所占的比例。\n\n设$E_A$为等位基因A的总转录表达水平，$E_B$为等位基因B的总转录表达水平。根据定义，概率$p$是来自等位基因A的表达量相对于总表达量的分数：\n$$p = \\dfrac{E_A}{E_A + E_B}$$\n\n我们被给予了以下信息和假设：\n1.  有$c_1$个等位基因A的基因组拷贝和$c_2$个等位基因B的基因组拷贝。\n2.  “每个基因组拷贝的转录输出相等”。我们把每个拷贝的这个恒定转录速率表示为$k$。\n3.  原假设假定没有其他因素导致差异表达（即“无内在的等位基因特异性调控”）。\n\n基于这几点，来自等位基因A的总表达量是等位基因A的拷贝数乘以每个拷贝的表达量：\n$$E_A = c_1 \\cdot k$$\n\n类似地，来自等位基因B的总表达量是：\n$$E_B = c_2 \\cdot k$$\n\n现在，我们将这些表达式代回到$p$的方程中：\n$$p = \\dfrac{c_1 \\cdot k}{(c_1 \\cdot k) + (c_2 \\cdot k)}$$\n\n我们可以从分母中提出常数$k$：\n$$p = \\dfrac{c_1 \\cdot k}{k \\cdot (c_1 + c_2)}$$\n\n由于转录输出非零（$k  0$），我们可以从分子和分母中消去$k$：\n$$p = \\dfrac{c_1}{c_1 + c_2}$$\n\n这个$p$的表达式代表了在原假设下的预期等位基因A读数比例，该假设认为等位基因不平衡完全由相应等位基因的拷贝数驱动，没有其他调控效应和实验偏好。\n\n## 逐项分析\n\n**A. $p = 0.5$**\n这个表达式假设来自两个等位基因的转录本比例相等。这对于没有CNV的二倍体生物是正确的原假设，其中$c_1 = 1$且$c_2 = 1$。在这种特定情况下，我们推导的公式得出$p = \\dfrac{1}{1+1} = 0.5$。然而，问题明确指出存在CNV，这意味着我们不能假设$c_1 = c_2$。这个选项忽略了问题的核心前提。\n**结论：错误**。\n\n**B. $p = \\dfrac{c_1}{c_1 + c_2}$**\n这个表达式与从第一性原理推导出的结果完全匹配。它正确地将概率$p$公式化为等位基因A的基因组拷贝数相对于两个等位基因总基因组拷贝数的比例。这直接模拟了原假设下CNV对转录本丰度的影响。\n**结论：正确**。\n\n**C. $p = \\dfrac{c_1}{c_2}$**\n这个表达式代表了等位基因A与等位基因B的拷贝数之比。这不是一个概率，因为它没有界定在$0$和$1$之间。例如，如果$c_1 = 3$且$c_2 = 1$，这个公式将得出$p = 3$，这对于二项分布的概率参数来说是一个不可能的值。\n**结论：错误**。\n\n**D. $p = \\dfrac{c_1^2}{c_1^2 + c_2^2}$**\n这个表达式假定了拷贝数和转录本比例之间的二次关系。问题中“每个基因组拷贝的转录输出相等”的假设意味着一种直接的线性关系。问题陈述中没有提供任何生物学或理论上的理由来对拷贝数进行平方。\n**结论：错误**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "并非所有的测序读数都能确定地分配到某个等位基因上，这是ASE分析中一个常见的挑战。这个高级练习将引导您完成期望最大化（EM）算法的推导，这是一种强大的统计方法，用于处理这种比对不确定性并获得稳健的等位基因表达估计。",
            "id": "4539391",
            "problem": "考虑一个具有两个（$2$）等位基因（表示为等位基因 $A$ 和等位基因 $B$）的二倍体基因座。您观察到 $n$ 个独立的 RNA 测序读数 $\\{x_{i}\\}_{i=1}^{n}$。对于每个读数 $x_{i}$，一个比对器提供了比对概率 $(a_{i}^{A},a_{i}^{B})$，其中 $a_{i}^{A}=\\Pr(x_{i}\\,|\\,z_{i}=A)$ 且 $a_{i}^{B}=\\Pr(x_{i}\\,|\\,z_{i}=B)$。假设对于所有 $i$，$a_{i}^{A}0$，$a_{i}^{B}0$，且 $a_{i}^{A}+a_{i}^{B}0$。并假设在给定潜在的来源等位基因 $z_{i}\\in\\{A,B\\}$ 的条件下，这些读数是独立的。令 $p=\\Pr(z_{i}=A)$ 表示等位基因 $A$ 的表达比例，因此 $\\Pr(z_{i}=B)=1-p$。目标是通过期望最大化（EM）算法，将 $z_{i}$ 视为潜变量，来对 $p$ 进行最大似然估计。\n\n从以下核心定义出发：(i) 在条件独立性下，联合似然可分解为 $\\prod_{i=1}^{n}\\Pr(x_{i}\\,|\\,z_{i})\\Pr(z_{i}\\,|\\,p)$；(ii) 贝叶斯法则给出 $\\Pr(z_{i}=A\\,|\\,x_{i},p)=\\frac{\\Pr(x_{i}\\,|\\,z_{i}=A)\\Pr(z_{i}=A\\,|\\,p)}{\\Pr(x_{i}\\,|\\,p)}$；以及 (iii) EM 算法在第 $t$ 次迭代时使用当前参数 $p^{(t)}$ 来计算期望的完整数据对数似然，然后相对于 $p$ 将其最大化以获得 $p^{(t+1)}$。请解析地执行一次 EM 迭代。\n\n具体来说，请仅使用上述基本原理，不使用任何预先推导的更新规则，来推导以下表达式：\n- 在期望步骤中，每个读数的等位基因特异性分数责任（也称为分数计数），并将其在所有读数上聚合，得到等位基因 $A$ 和等位基因 $B$ 的总分数计数，分别表示为 $c_{A}^{(t)}$ 和 $c_{B}^{(t)}$；\n- 在最大化步骤中的最大化者 $p^{(t+1)}$。\n\n请将您的最终答案表示为关于 $p^{(t)}$、$\\{a_{i}^{A}\\}_{i=1}^{n}$ 和 $\\{a_{i}^{B}\\}_{i=1}^{n}$ 的闭式解析表达式，并尽可能简化。请将最终答案以包含 $c_{A}^{(t)}$、$c_{B}^{(t)}$ 和 $p^{(t+1)}$ 的单行矩阵形式提供。不需要进行数值计算。不要包含任何单位。",
            "solution": "用户提供了一个有效且表述清晰的问题陈述，该问题植根于生物信息学的统计推断原理。该问题要求通过解析推导期望最大化（EM）算法的一次迭代，以估计等位基因特异性表达模型中的等位基因比例参数。我将按照要求进行推导，严格遵守所提供的基本原则。\n\n该模型假设我们有 $n$ 个独立的 RNA 测序读数，$\\{x_i\\}_{i=1}^n$。对于每个读数 $x_i$，其潜在（未观测到的）来源等位基因是 $z_i \\in \\{A, B\\}$。我们感兴趣的参数是 $p = \\Pr(z_i = A)$，即等位基因 $A$ 的表达比例。因此，$\\Pr(z_i = B) = 1-p$。对于每个读数 $x_i$ 的观测数据包括比对概率 $a_i^A = \\Pr(x_i | z_i=A)$ 和 $a_i^B = \\Pr(x_i | z_i=B)$。\n\nEM 算法是一种用于寻找 $p$ 的最大似然估计的迭代方法。每次迭代包括一个期望（E）步骤和一个最大化（M）步骤。我们在第 $t$ 次迭代开始时，有一个当前参数的估计值，表示为 $p^{(t)}$。\n\n此问题的完整数据是观测到的读数和潜在的来源，即 $(\\{x_i\\}, \\{z_i\\})$。根据问题陈述，完整数据似然函数为 $L(p; \\{x_i\\}, \\{z_i\\}) = \\prod_{i=1}^{n} \\Pr(x_i | z_i) \\Pr(z_i | p)$。完整数据对数似然函数 $\\ell(p)$ 为：\n$$\n\\ell(p; \\{x_i\\}, \\{z_i\\}) = \\log \\left( \\prod_{i=1}^{n} \\Pr(x_i | z_i) \\Pr(z_i | p) \\right) = \\sum_{i=1}^{n} \\left( \\log \\Pr(x_i | z_i) + \\log \\Pr(z_i | p) \\right)\n$$\n为了使其更明确，我们可以使用指示变量。令 $I(z_i=A)$ 在 $z_i=A$ 时为 $1$，否则为 $0$，且 $I(z_i=B)=1-I(z_i=A)$。那么 $\\Pr(z_i|p) = p^{I(z_i=A)}(1-p)^{I(z_i=B)}$，并且 $\\Pr(x_i|z_i)=(a_i^A)^{I(z_i=A)}(a_i^B)^{I(z_i=B)}$。对数似然函数变为：\n$$\n\\ell(p; \\{x_i\\}, \\{z_i\\}) = \\sum_{i=1}^{n} \\left[ I(z_i=A)\\log p + I(z_i=B)\\log(1-p) + I(z_i=A)\\log a_i^A + I(z_i=B)\\log a_i^B \\right]\n$$\n\n### 期望 (E) 步\n\nE 步计算完整数据对数似然函数关于潜变量 $z_i$ 的后验分布（给定观测数据 $\\{x_i\\}$ 和当前参数估计 $p^{(t)}$）的期望值。该函数表示为 $Q(p | p^{(t)})$。\n$$\nQ(p | p^{(t)}) = E_{Z | X, p^{(t)}}[\\ell(p; \\{x_i\\}, \\{z_i\\})]\n$$\n根据期望的线性性质，我们只需要计算指示变量的期望，即潜在来源的后验概率。令 $\\gamma_{iA}^{(t)}$ 为在给定数据 $x_i$ 和参数 $p^{(t)}$ 的条件下，读数 $i$ 来源于等位基因 $A$ 的后验概率。\n$$\n\\gamma_{iA}^{(t)} = E[I(z_i=A) | x_i, p^{(t)}] = \\Pr(z_i=A | x_i, p^{(t)})\n$$\n根据问题陈述中指定的贝叶斯法则：\n$$\n\\gamma_{iA}^{(t)} = \\frac{\\Pr(x_i | z_i=A) \\Pr(z_i=A | p^{(t)})}{\\Pr(x_i | p^{(t)})}\n$$\n分母是观测到读数 $x_i$ 的边际概率，通过对所有可能的来源求和得到：\n$$\n\\Pr(x_i | p^{(t)}) = \\Pr(x_i | z_i=A)\\Pr(z_i=A | p^{(t)}) + \\Pr(x_i | z_i=B)\\Pr(z_i=B | p^{(t)}) = a_i^A p^{(t)} + a_i^B (1-p^{(t)})\n$$\n代入各项，我们得到等位基因 $A$ 的分数责任：\n$$\n\\gamma_{iA}^{(t)} = \\frac{a_i^A p^{(t)}}{a_i^A p^{(t)} + a_i^B (1-p^{(t)})}\n$$\n类似地，等位基因 $B$ 的分数责任 $\\gamma_{iB}^{(t)} = \\Pr(z_i=B | x_i, p^{(t)})$ 为：\n$$\n\\gamma_{iB}^{(t)} = \\frac{a_i^B (1-p^{(t)})}{a_i^A p^{(t)} + a_i^B (1-p^{(t)})}\n$$\n注意 $\\gamma_{iA}^{(t)} + \\gamma_{iB}^{(t)} = 1$。问题要求每个等位基因的总分数计数 $c_A^{(t)}$ 和 $c_B^{(t)}$，它们是这些责任在所有 $n$ 个读数上的总和。\n$$\nc_A^{(t)} = \\sum_{i=1}^{n} \\gamma_{iA}^{(t)} = \\sum_{i=1}^{n} \\frac{a_i^A p^{(t)}}{a_i^A p^{(t)} + a_i^B (1-p^{(t)})}\n$$\n$$\nc_B^{(t)} = \\sum_{i=1}^{n} \\gamma_{iB}^{(t)} = \\sum_{i=1}^{n} \\frac{a_i^B (1-p^{(t)})}{a_i^A p^{(t)} + a_i^B (1-p^{(t)})}\n$$\n这些是所要求的前两个表达式。\n\n### 最大化 (M) 步\n\nM 步相对于 $p$ 最大化 $Q(p | p^{(t)})$ 函数，以找到更新后的参数估计 $p^{(t+1)}$。\n$$\np^{(t+1)} = \\underset{p \\in [0,1]}{\\arg\\max} \\, Q(p | p^{(t)})\n$$\n我们将期望值（$\\gamma_{iA}^{(t)}$ 和 $\\gamma_{iB}^{(t)}$）代入对数似然表达式中的指示变量，来写出 $Q$ 函数：\n$$\nQ(p | p^{(t)}) = \\sum_{i=1}^{n} \\left[ \\gamma_{iA}^{(t)}\\log p + \\gamma_{iB}^{(t)}\\log(1-p) + \\gamma_{iA}^{(t)}\\log a_i^A + \\gamma_{iB}^{(t)}\\log a_i^B \\right]\n$$\n为了找到关于 $p$ 的最大值，我们可以忽略不依赖于 $p$ 的项。涉及 $\\log a_i^A$ 和 $\\log a_i^B$ 的项相对于 $p$ 是常数。需要最大化的函数简化为：\n$$\nQ'(p) = \\sum_{i=1}^{n} \\left( \\gamma_{iA}^{(t)}\\log p + \\gamma_{iB}^{(t)}\\log(1-p) \\right)\n$$\n我们可以重新整理求和式：\n$$\nQ'(p) = \\left(\\sum_{i=1}^{n} \\gamma_{iA}^{(t)}\\right) \\log p + \\left(\\sum_{i=1}^{n} \\gamma_{iB}^{(t)}\\right) \\log(1-p) = c_A^{(t)} \\log p + c_B^{(t)} \\log(1-p)\n$$\n为了最大化 $Q'(p)$，我们对 $p$ 求导并令其等于零：\n$$\n\\frac{d Q'(p)}{dp} = \\frac{c_A^{(t)}}{p} - \\frac{c_B^{(t)}}{1-p} = 0\n$$\n$$\n\\frac{c_A^{(t)}}{p} = \\frac{c_B^{(t)}}{1-p} \\implies c_A^{(t)}(1-p) = c_B^{(t)} p \\implies c_A^{(t)} = (c_A^{(t)} + c_B^{(t)})p\n$$\n求解 $p$ 得到更新后的估计值 $p^{(t+1)}$：\n$$\np^{(t+1)} = \\frac{c_A^{(t)}}{c_A^{(t)} + c_B^{(t)}}\n$$\n分母是总分数计数的和：\n$$\nc_A^{(t)} + c_B^{(t)} = \\sum_{i=1}^{n} \\gamma_{iA}^{(t)} + \\sum_{i=1}^{n} \\gamma_{iB}^{(t)} = \\sum_{i=1}^{n} (\\gamma_{iA}^{(t)} + \\gamma_{iB}^{(t)}) = \\sum_{i=1}^{n} 1 = n\n$$\n因此，$p$ 的更新规则是：\n$$\np^{(t+1)} = \\frac{c_A^{(t)}}{n}\n$$\n代入 $c_A^{(t)}$ 的完整表达式：\n$$\np^{(t+1)} = \\frac{1}{n} \\sum_{i=1}^{n} \\frac{a_i^A p^{(t)}}{a_i^A p^{(t)} + a_i^B (1-p^{(t)})}\n$$\n这是第三个也是最后一个所要求的表达式。这三个推导出的表达式提供了一次 EM 迭代的完整解析描述。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sum_{i=1}^{n} \\frac{a_{i}^{A}p^{(t)}}{a_{i}^{A}p^{(t)} + a_{i}^{B}(1-p^{(t)})}  \\sum_{i=1}^{n} \\frac{a_{i}^{B}(1-p^{(t)})}{a_{i}^{A}p^{(t)} + a_{i}^{B}(1-p^{(t)})}  \\frac{1}{n} \\sum_{i=1}^{n} \\frac{a_{i}^{A}p^{(t)}}{a_{i}^{A}p^{(t)} + a_{i}^{B}(1-p^{(t)})}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}