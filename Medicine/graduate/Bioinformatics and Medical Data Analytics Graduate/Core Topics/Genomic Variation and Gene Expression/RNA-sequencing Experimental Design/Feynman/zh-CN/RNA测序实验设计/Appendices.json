{
    "hands_on_practices": [
        {
            "introduction": "在设计RNA测序实验时，一个常见的诱惑是混合（或“池化”）来自多个个体的样本以节省成本，认为一个深度测序的池化样本足以代表整个组。然而，这种方法存在一个根本性的统计缺陷。这个练习  旨在通过一个典型的错误设计案例，阐明生物学重复的不可或缺性，并帮助您区分生物变异和技术变异，这是任何有意义的差异表达分析的基石。",
            "id": "2385533",
            "problem": "一位研究人员想要评估一个对照条件和一个处理条件之间的差异基因表达（Differential Gene Expression, DGE）。他们从 $n_c$ 个对照组捐献者和 $n_t$ 个处理组捐献者身上收集组织，提取总核糖核酸（RNA），并创建了两个混合样本池：一个是通过合并所有对照组捐献者的等量RNA质量构成的，另一个是通过合并所有处理组捐献者的等量RNA质量构成的。他们从每个样本池中构建一个测序文库（这两个文库在不同的日期制备），并进行高深度RNA测序（RNA-seq），获得了 $G$ 个基因的基因水平计数数据。他们计划应用一个标准的DGE分析流程来鉴定差异表达基因，该流程会输出 $p$ 值和错误发现率（False Discovery Rate, FDR）$q$ 值。\n\n以下哪个陈述是对该设计最准确的批评，并附带了适当的补救措施？\n\nA. 根本缺陷在于缺少独立的生物学重复，这使得样本间方差无法确定，并导致差异表达的推断性 $p$ 值无效；一个文库内的读数（reads）不是独立的实验单元。混合样本也掩盖了捐献者之间的异质性。适当的补救措施是每个条件至少包含 $k\\geq 3$ 个独立的生物学重复，并在文库制备批次之间进行随机化和平衡，以便能够估计方差并将批次效应与条件效应分离开来。\n\nB. 如果测序深度极高（例如，每个文库 $\\geq 10^8$ 条读数），该设计是可以接受的，因为大数定律确保了每个基因的均值和方差能够以足够的精度进行估计，从而在没有生物学重复的情况下也能产生有效的假设检验。\n\nC. 如果通过对每个混合文库在 $r\\geq 3$ 个测序泳道（lane）上进行测序来生成多个技术重复，那么生物学重复就不是必需的；泳道间的变异为条件间的有效差异表达检验提供了所需的方差。\n\nD. 外部添加的内参（spike-in controls）可以在没有生物学重复的情况下实现完全的标准化和假设检验；通过适当的内参，尽管每个条件只有一个混合样本，也可以为每个基因计算出有效的 $p$ 值。\n\nE. 即使每个条件只有一个混合文库，也可以通过在两个文库之间随机置换读数来为每个基因构建一个经验零分布，从而在没有生物学重复的情况下获得有效的 $p$ 值。",
            "solution": "对问题陈述进行验证。\n\n步骤1：提取已知信息\n- 一位研究人员旨在进行对照条件和处理条件之间的差异基因表达（DGE）分析。\n- 组织样本来自 $n_c$ 个对照组捐献者和 $n_t$ 个处理组捐献者。\n- 从所有样本中提取总核糖核酸（RNA）。\n- 创建了两个RNA混合样本池：一个是通过合并所有 $n_c$ 个对照组捐献者的等量RNA质量构成的，另一个是通过合并所有 $n_t$ 个处理组捐献者的等量RNA质量构成的。\n- 从两个样本池中各构建一个测序文库。\n- 这两个文库在不同的日期制备。\n- 对这两个文库进行高深度RNA测序（RNA-seq）。\n- 获得了 $G$ 个基因的基因水平计数数据。\n- 研究人员计划使用一个标准的DGE分析流程来鉴定差异表达基因，该流程输出 $p$ 值和错误发现率（FDR）$q$ 值。\n- 问题要求对该实验设计提出最准确的批评和适当的补救措施。\n\n步骤2：使用提取的已知信息进行验证\n该问题描述了一个RNA-seq实验的具体设计，并要求基于生物统计学和生物信息学的原理对其进行批判性评估。\n\n- **科学依据：** 所提出的概念——DGE、RNA-seq、样本混合、生物学重复、批次效应、$p$ 值和FDR——都是计算生物学和基因组学领域的标准和基本概念。所描述的实验设计虽然有缺陷，却是研究人员可能提出的一个现实情景。该问题基于已建立的科学原理。\n- **问题明确：** 该问题以多项选择题的形式构建，要求在一组选项中找出最准确的批评。这是评估对实验设计原则理解的标准且明确的格式。根据该领域的既定最佳实践，预计存在一个唯一的最佳答案。\n- **客观性：** 语言技术性强且精确。诸如“对照条件”、“处理”、“RNA-seq”和“生物学重复”等术语在该科学背景下具有清晰、无歧义的定义。对实验过程的描述是客观的，没有主观性陈述。\n\n问题陈述本身不包含科学谬误；相反，它描述了一个在科学上有缺陷的实验设计，并要求学生找出这些缺陷。这是一种有效的教学方法。该问题是自洽的、一致的，并且与其主题直接相关。它没有违反任何无效标准。\n\n步骤3：结论与行动\n问题陈述有效。我将继续进行完整的推导和分析。\n\n差异基因表达分析的核心任务是检验一个基因的平均表达量在两个或多个群体（例如，对照群体 vs. 处理群体）之间是否存在差异的假设。统计检验需要一个效应大小（均值差异）的估计值，以及与该效应大小相关的方差或不确定性的估计值。\n\n在生物学实验中，总方差有两个主要组成部分：生物学方差和技术方差。\n1.  **生物学方差** ($\\sigma^2_{\\text{bio}}$): 这代表了在同一群体或条件内，不同个体之间基因表达水平的真实、自然的变异。在本问题中，这就是捐献者之间的变异性。对群体进行推断需要量化这种方差。\n2.  **技术方差** ($\\sigma^2_{\\text{tech}}$): 这是在实验测量过程中引入的变异，包括RNA提取、文库制备和测序。对于像RNA-seq这样的计数数据，技术噪音的一个主要组成部分是泊松散粒噪声。\n\n所提议的实验设计的根本缺陷是完全没有**独立的生物学重复**。通过将来自 $n_c$ 个对照组捐献者的所有RNA混合成一个样本，并将来自 $n_t$ 个处理组捐献者的所有RNA混合成另一个样本，研究人员最终得到的有效样本量对于对照组是 $n=1$，对于处理组也是 $n=1$。\n\n当每组的样本量为 $n=1$ 时，从数学上讲，不可能估计生物学方差（$\\sigma^2_{\\text{bio}}$）。两个混合文库之间观察到的任何基因表达差异都是完全混淆的。这种差异可能源于：\n- 处理的真实生物学效应。\n- 随机偶然性，即特定的 $n_c$ 个捐献者群体恰好与特定的 $n_t$ 个捐献者群体在平均表达水平上有所不同，即使没有任何处理。\n- 一个系统性的技术偏差，即**批次效应**，因为两个文库是在不同的日期制备的。制备日期与条件（对照 vs. 处理）完全混淆。\n\n从单个文库测序获得的读数是**技术重复**，而不是生物学重复。增加测序深度可以更精确地测量*那个特定RNA混合样本池中*的平均表达水平，从而减少由技术（抽样）方差引起的不确定性。然而，它完全无法提供关于捐献者来源群体的生物学方差的任何信息。DGE的推断统计学关心的是观察到的效应相对于群体中的生物学变异是否足够大，而不是测量单个样本时的技术变异。像DESeq2或edgeR这样的标准DGE软件包是明确设计用来利用来自生物学重复的数据来模拟生物学方差的。没有生物学重复，这些模型就无法正确拟合，产生的 $p$ 值也是无效的。\n\n适当的补救措施必须纠正这些缺陷。它要求：\n1.  为每个条件的多个个体创建独立的文库。这构成了真正的生物学重复，并允许估计生物学方差。每个条件至少 $k=3$ 个重复是获得合理统计功效和稳健方差估计的公认标准。\n2.  处理批次效应。实验单元（来自对照组和处理组的文库）必须在不同批次（例如，文库制备日期）之间以随机和平衡的方式进行处理，以确保任何与批次相关的技术变异不会与感兴趣的生物学信号相混淆。\n\n现在，我将评估每个选项。\n\n**A. 根本缺陷在于缺少独立的生物学重复，这使得样本间方差无法确定，并导致差异表达的推断性 $p$ 值无效；一个文库内的读数（reads）不是独立的实验单元。混合样本也掩盖了捐献者之间的异质性。适当的补救措施是每个条件至少包含 $k\\geq 3$ 个独立的生物学重复，并在文库制备批次之间进行随机化和平衡，以便能够估计方差并将批次效应与条件效应分离开来。**\n这个陈述是一个精确而全面的批评。它正确地指出了缺乏生物学重复是核心问题，解释了其后果（无法确定的生物学方差和无效的 $p$ 值），正确地区分了技术单元和生物学单元，并指出了混合样本导致的信息损失。提议的补救措施——每个条件使用至少3个生物学重复，并采用随机、平衡的设计来减轻批次效应——是现代基因组学中的标准和正确解决方案。原始设计存在批次效应（不同日期），这个补救措施也明确地解决了这个问题。\n结论：**正确**。\n\n**B. 如果测序深度极高（例如，每个文库 $\\geq 10^8$ 条读数），该设计是可以接受的，因为大数定律确保了每个基因的均值和方差能够以足够的精度进行估计，从而在没有生物学重复的情况下也能产生有效的假设检验。**\n这是不正确的。高测序深度只减少了技术方差，为特定混合样本提供了非常精确的测量。它不能也无法提供捐献者群体内的生物学方差信息。大数定律适用于从文库中对RNA分子的技术抽样，而不是从群体中对受试者的生物学抽样。假设检验是关于群体的，因此需要对群体方差进行估计，这必须要有生物学重复。\n结论：**不正确**。\n\n**C. 如果通过对每个混合文库在 $r\\geq 3$ 个测序泳道（lane）上进行测序来生成多个技术重复，那么生物学重复就不是必需的；泳道间的变异为条件间的有效差异表达检验提供了所需的方差。**\n这是不正确的。技术重复（例如，同一文库的多个测序泳道）只允许估计技术方差。在假设检验中用技术方差代替生物学方差是一个严重的统计错误。生物学方差几乎总是远大于技术方差。这样做会导致检验统计量的分母极小，从而导致假阳性的大量增加。人们会检测到数千个“显著”的基因，而这些基因仅仅是两个特定混合样本之间微小随机波动的反映，并非可推广到群体的真实生物学效应。\n结论：**不正确**。\n\n**D. 外部添加的内参（spike-in controls）可以在没有生物学重复的情况下实现完全的标准化和假设检验；通过适当的内参，尽管每个条件只有一个混合样本，也可以为每个基因计算出有效的 $p$ 值。**\n这是不正确的。内参（Spike-in controls）是添加到每个样本中已知浓度的外源RNA分子。它们的主要用途是技术标准化和评估技术性能。它们可以帮助估计技术方差和建模技术偏差。然而，由于它们不受生物体内的生物学调控，因此它们完全不能提供关于感兴趣的内源基因的生物学方差的任何信息。因此，在DGE分析中，它们不能替代生物学重复。\n结论：**不正确**。\n\n**E. 即使每个条件只有一个混合文库，也可以通过在两个文库之间随机置换读数来为每个基因构建一个经验零分布，从而在没有生物学重复的情况下获得有效的 $p$ 值。**\n这是不正确的。置换检验依赖于在零假设下样本标签的可交换性。可交换的单元是独立的生物学重复。在这里，每个条件只有一个单元（混合文库）。没有任何东西可以置换。在文库之间随机打乱单个读数不是一个有效的统计程序。一个文库内的读数不是独立的；它们的计数是相关的，并取决于该特定文库的组成。打乱它们会破坏数据的结构，并且不会为检验统计量生成一个有效的零分布。\n结论：**不正确**。\n\n综上所述，选项A是唯一一个正确诊断了实验设计的关键缺陷并提出了正确、标准补救措施的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使我们认识到需要生物学重复，一个糟糕的实验设计仍然可能导致结果无效。在RNA测序等高通量实验中，批次效应是一个普遍存在的技术变异来源，如果实验条件与批次发生混淆，就会产生严重的偏倚。这个练习  将通过一个简化的线性模型，让您定量地推导出这种混淆如何系统性地扭曲我们对处理效应的估计，从而将对批次效应的理解从定性警告提升到定量分析的层面。",
            "id": "4605715",
            "problem": "一项核糖核酸测序 (RNA-seq) 研究旨在检测疾病状况与对照状况之间的差异表达。对于单个基因，假设样本 $i$ 的归一化对数计数由一个线性均值漂移生成模型建模\n$$\ny_i = \\mu + \\beta c_i + \\gamma b_i + \\varepsilon_i,\n$$\n其中 $y_i$ 是对数计数，$c_i \\in \\{0,1\\}$ 表示状况（$c_i=1$ 为疾病，$c_i=0$ 为对照），$b_i \\in \\{0,1\\}$ 表示批次成员关系（$b_i=1$ 为批次 A，$b_i=0$ 为批次 B），$\\mu$ 是基线均值，$\\beta$ 是真实的状况效应（对数尺度），$\\gamma$ 是批次效应（对数尺度），而 $\\varepsilon_i$ 是独立的误差，满足 $\\mathbb{E}[\\varepsilon_i]=0$ 和有限方差。假设实验设计导致批次和状况之间存在相关性（例如，在批次 A 中处理的疾病样本多于在批次 B 中处理的），但在分析中未对批次进行校正。\n\n一位分析师错误地拟合了省略批次的简化普通最小二乘法 (OLS) 模型，\n$$\ny_i = \\alpha + \\tau c_i + u_i,\n$$\n并报告 $\\hat{\\tau}$ 作为疾病与对照之间估计的对数尺度差异表达。\n\n从线性模型的基本定义以及 OLS 估计量是响应在回归量张成的空间上的投影这一定义出发，推导在上述生成模型下期望 $\\mathbb{E}[\\hat{\\tau}]$ 的解析表达式，并由此推导出偏差 $\\mathbb{E}[\\hat{\\tau}] - \\beta$ 作为被省略的批次效应以及 $c_i$ 和 $b_i$ 联合分布的函数。然后，对于以下具体设计，计算期望值 $\\mathbb{E}[\\hat{\\tau}]$：\n\n- 总样本数 $n=100$，其中 $n_1=50$ 个疾病样本（$c_i=1$）和 $n_0=50$ 个对照样本（$c_i=0$）。\n- 批次构成：在疾病样本中，$m_1=45$ 个在批次 A（$b_i=1$），$5$ 个在批次 B（$b_i=0$）；在对照样本中，$m_0=5$ 个在批次 A，$45$ 个在批次 B。\n- 真实的状况效应 $\\beta=1.2$ 和批次效应 $\\gamma=0.7$。\n\n将最终数值答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "用户要求我批判性地验证并解决一个关于 RNA 测序数据分析中线性模型遗漏变量偏差的问题。\n\n### 步骤 1：提取已知信息\n\n-   **真实生成模型：** 对于样本 $i$，归一化对数计数 $y_i$ 由 $y_i = \\mu + \\beta c_i + \\gamma b_i + \\varepsilon_i$ 给出。\n    -   $y_i$：样本 $i$ 的对数计数。\n    -   $c_i \\in \\{0,1\\}$：状况指示变量（$1$ 为疾病，$0$ 为对照）。\n    -   $b_i \\in \\{0,1\\}$：批次指示变量（$1$ 为批次 A，$0$ 为批次 B）。\n    -   $\\mu$：基线均值。\n    -   $\\beta$：真实的状况效应。\n    -   $\\gamma$：真实的批次效应。\n    -   $\\varepsilon_i$：独立的误差，满足 $\\mathbb{E}[\\varepsilon_i]=0$ 和有限方差。\n-   **拟合的（错误设定的）模型：** 一位分析师拟合了模型 $y_i = \\alpha + \\tau c_i + u_i$。\n    -   $\\hat{\\tau}$：状况效应的 OLS 估计值，作为结果报告。\n-   **实验设计数据：**\n    -   总样本数：$n=100$。\n    -   疾病样本（$c_i=1$）：$n_1=50$。\n    -   对照样本（$c_i=0$）：$n_0=50$。\n    -   疾病样本的批次构成：$m_1=45$ 个在批次 A（$b_i=1$），$5$ 个在批次 B（$b_i=0$）。\n    -   对照样本的批次构成：$m_0=5$ 个在批次 A（$b_i=1$），$45$ 个在批次 B（$b_i=0$）。\n-   **真实参数值：**\n    -   $\\beta = 1.2$。\n    -   $\\gamma = 0.7$。\n-   **任务：**\n    1.  推导期望 $\\mathbb{E}[\\hat{\\tau}]$ 和偏差 $\\mathbb{E}[\\hat{\\tau}] - \\beta$，将其表示为 $\\gamma$ 以及 $c_i$ 和 $b_i$ 的联合分布的函数。推导应从 OLS 估计量作为投影的定义开始。\n    2.  为给定设计计算 $\\mathbb{E}[\\hat{\\tau}]$ 的数值。\n    3.  报告最终数值答案，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n-   **科学性：** 该问题牢固地植根于统计理论（线性回归中的遗漏变量偏差）及其在生物信息学现实场景中的应用（RNA-seq 实验中生物学状况与技术性批次效应的混淆）。这是应用统计学中的一个典型问题。\n-   **适定性：** 该问题是适定的。模型定义清晰，所有必要的参数和数据都已提供，并且要求一个具体、唯一的解析和数值答案。\n-   **客观性：** 该问题以客观的数学语言陈述，并要求一个可量化、可验证的结果。\n-   **完整性和一致性：** 该问题是自包含的，为求解提供了所有必要信息。给定数据中没有矛盾。\n-   **现实性和可行性：** 所描述的实验设计中，状况与批次发生混淆，这是现实世界研究中一个常见且严重的问题。指定的样本量和效应大小是合理的。\n-   **其他缺陷：** 该问题没有表现出任何其他缺陷，如不适定、琐碎或故作高深。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。现在将开始推导求解过程。\n\n### 估计量期望与偏差的推导\n\n分析师拟合了简单线性回归模型 $y_i = \\alpha + \\tau c_i + u_i$。斜率参数 $\\tau$ 的普通最小二乘法 (OLS) 估计量由 $\\hat{\\tau}$ 给出。从根本上说，$\\hat{\\tau}$ 是通过将响应向量 $\\mathbf{y}$ 投影到由回归量张成的子空间上，并在考虑截距后得到的。这等同于将中心化的响应对中心化的回归量进行回归。\n\n令 $\\mathbf{y} = [y_1, \\dots, y_n]^T$ 为响应向量，$\\mathbf{c} = [c_1, \\dots, c_n]^T$ 为状况指示向量。令 $\\mathbf{1}$ 为长度为 $n$ 的全 1 向量。OLS 估计量 $\\hat{\\tau}$ 是通过将 $\\mathbf{y}$ 投影到与 $\\mathbf{1}$ 正交的 $\\mathbf{c}$ 的部分上获得的。令 $\\mathbf{c}^* = \\mathbf{c} - \\bar{c}\\mathbf{1}$ 为中心化的状况向量，其中 $\\bar{c} = \\frac{1}{n}\\sum_{i=1}^n c_i$。则估计量 $\\hat{\\tau}$ 为：\n$$\n\\hat{\\tau} = \\frac{\\langle \\mathbf{c}^*, \\mathbf{y} \\rangle}{\\langle \\mathbf{c}^*, \\mathbf{c}^* \\rangle} = \\frac{\\sum_{i=1}^n (c_i - \\bar{c})y_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2}\n$$\n真实的生成模型是 $\\mathbf{y} = \\mu\\mathbf{1} + \\beta\\mathbf{c} + \\gamma\\mathbf{b} + \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{b}=[b_1, \\dots, b_n]^T$，$\\boldsymbol{\\varepsilon}=[\\varepsilon_1, \\dots, \\varepsilon_n]^T$。为了求 $\\hat{\\tau}$ 的期望，我们将此真实模型代入估计量的公式中。\n分子变为：\n$$\n\\sum_{i=1}^n (c_i - \\bar{c})y_i = \\sum_{i=1}^n (c_i - \\bar{c})(\\mu + \\beta c_i + \\gamma b_i + \\varepsilon_i)\n$$\n我们逐项展开这个和：\n1.  $\\sum_{i=1}^n (c_i - \\bar{c})\\mu = \\mu \\sum_{i=1}^n (c_i - \\bar{c}) = \\mu(n\\bar{c} - n\\bar{c}) = 0$。\n2.  $\\sum_{i=1}^n (c_i - \\bar{c})(\\beta c_i) = \\beta \\sum_{i=1}^n (c_i - \\bar{c})c_i = \\beta \\sum_{i=1}^n (c_i - \\bar{c})(c_i - \\bar{c}) = \\beta \\sum_{i=1}^n (c_i - \\bar{c})^2$。\n3.  $\\sum_{i=1}^n (c_i - \\bar{c})(\\gamma b_i) = \\gamma \\sum_{i=1}^n (c_i - \\bar{c})b_i$。\n4.  $\\sum_{i=1}^n (c_i - \\bar{c})\\varepsilon_i$。\n\n将这些代回到 $\\hat{\\tau}$ 的表达式中：\n$$\n\\hat{\\tau} = \\frac{\\beta \\sum_{i=1}^n (c_i - \\bar{c})^2 + \\gamma \\sum_{i=1}^n (c_i - \\bar{c})b_i + \\sum_{i=1}^n (c_i - \\bar{c})\\varepsilon_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2}\n$$\n$$\n\\hat{\\tau} = \\beta + \\gamma \\frac{\\sum_{i=1}^n (c_i - \\bar{c})b_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2} + \\frac{\\sum_{i=1}^n (c_i - \\bar{c})\\varepsilon_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2}\n$$\n我们现在对误差 $\\varepsilon_i$ 的分布取期望。由于 $\\mathbb{E}[\\varepsilon_i]=0$ 并且设计变量 $c_i, b_i$ 是固定的，最后一项的期望为零。\n$$\n\\mathbb{E}[\\hat{\\tau}] = \\beta + \\gamma \\frac{\\sum_{i=1}^n (c_i - \\bar{c})b_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2}\n$$\n估计量的偏差为 $\\mathbb{E}[\\hat{\\tau}] - \\beta$：\n$$\n\\text{Bias}(\\hat{\\tau}) = \\mathbb{E}[\\hat{\\tau}] - \\beta = \\gamma \\frac{\\sum_{i=1}^n (c_i - \\bar{c})b_i}{\\sum_{i=1}^n (c_i - \\bar{c})^2}\n$$\n这是遗漏变量偏差的通用公式。项 $\\frac{\\sum(c_i-\\bar{c})b_i}{\\sum(c_i-\\bar{c})^2}$ 是被遗漏变量 $b$ 对被包含变量 $c$ 进行回归的系数。\n\n为了用 $c_i$ 和 $b_i$ 的联合分布（在此案例中，是它们的样本计数）来表示偏差，我们可以重写这些项。令 $n_{jk}$ 为满足 $c_i=j$ 和 $b_i=k$ 的样本数量。\n$c$ 的样本均值为 $\\bar{c} = (n_{11}+n_{10})/n = n_1/n$。\n分母是 $c_i$ 的离差平方和：\n$\\sum(c_i - \\bar{c})^2 = n_1(1-\\bar{c})^2 + n_0(0-\\bar{c})^2 = n_1(n_0/n)^2 + n_0(-n_1/n)^2 = \\frac{n_1 n_0^2 + n_0 n_1^2}{n^2} = \\frac{n_1 n_0 (n_0+n_1)}{n^2} = \\frac{n_1 n_0}{n}$。\n偏差项的分子是 $\\sum(c_i - \\bar{c})b_i$，即样本协方差项：\n$\\sum(c_i - \\bar{c})b_i = n_{11}(1-\\bar{c}) + n_{01}(0-\\bar{c}) = n_{11}(1-n_1/n) - n_{01}(n_1/n) = n_{11}(n_0/n) - n_{01}(n_1/n) = \\frac{n_{11}n_0 - n_{01}n_1}{n}$。\n因此，偏差为：\n$$\n\\text{Bias}(\\hat{\\tau}) = \\gamma \\frac{(n_{11}n_0 - n_{01}n_1)/n}{n_1 n_0/n} = \\gamma \\frac{n_{11}n_0 - n_{01}n_1}{n_1 n_0} = \\gamma \\left( \\frac{n_{11}}{n_1} - \\frac{n_{01}}{n_0} \\right)\n$$\n这里，$n_{11}/n_1$ 是疾病组中批次 A 样本的比例（样本 $P(b=1|c=1)$），而 $n_{01}/n_0$ 是对照组中批次 A 样本的比例（样本 $P(b=1|c=0)$）。\n\n### 数值计算\n\n现在我们将此公式应用于给定的实验设计。\n-   总样本数 $n = 100$。\n-   疾病样本（$c=1$）：$n_1 = 50$。\n-   对照样本（$c=0$）：$n_0 = 50$。\n-   批次 A 中的疾病样本（$b=1, c=1$）：$n_{11} = 45$。\n-   批次 A 中的对照样本（$b=1, c=0$）：$n_{01} = 5$。\n-   真实效应：$\\beta = 1.2$, $\\gamma = 0.7$。\n\n首先，我们计算比例：\n-   疾病组中批次 A 的比例：$P(b=1|c=1) = \\frac{n_{11}}{n_1} = \\frac{45}{50} = 0.9$。\n-   对照组中批次 A 的比例：$P(b=1|c=0) = \\frac{n_{01}}{n_0} = \\frac{5}{50} = 0.1$。\n\n接下来，我们计算偏差：\n$$\n\\text{Bias}(\\hat{\\tau}) = \\gamma \\left( \\frac{n_{11}}{n_1} - \\frac{n_{01}}{n_0} \\right) = 0.7 \\times (0.9 - 0.1) = 0.7 \\times 0.8 = 0.56\n$$\n估计的状况效应 $\\hat{\\tau}$ 的期望值是真实效应 $\\beta$ 加上此偏差：\n$$\n\\mathbb{E}[\\hat{\\tau}] = \\beta + \\text{Bias}(\\hat{\\tau}) = 1.2 + 0.56 = 1.76\n$$\n题目要求答案四舍五入到四位有效数字。因此，$1.76$ 变为 $1.760$。该值为无量纲，因为它代表对数计数的差异。",
            "answer": "$$\\boxed{1.760}$$"
        },
        {
            "introduction": "实验设计和执行之后，我们便进入了数据分析的“真实世界”，其中第一步也是最关键的一步是质量控制（QC）。原始数据中几乎总会存在异常值或低质量样本，如果不加识别和处理，它们可能会严重影响最终的生物学结论。这个练习  提供了一个真实的案例研究，其中一个样本在主成分分析中表现为明显的异常值，它要求您综合利用多种QC指标——从RNA完整性到文库复杂度——来做出科学上合理的判断，决定是排除样本还是采取其他补救措施。",
            "id": "4605754",
            "problem": "一项信使核糖核酸测序（RNA-seq）研究旨在评估疾病状况与对照组之间的基因表达差异。共有 $n=12$ 个文库：$6$ 个疾病案例和 $6$ 个对照。文库制备分两批 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 进行，每批包含 $3$ 个案例和 $3$ 个对照，使用相同的试剂盒和方案。对于每个样本 $i$，基因 $g$ 的观测计数（记为 $Y_{gi}$）被建模为来自一个采样过程，其中表达转录本的片段被随机捕获和测序。一个经过充分检验的计数数据基础模型假设数据服从负二项分布，其均值为 $\\mu_{gi}$，方差为 $\\mu_{gi} + \\alpha_g \\mu_{gi}^2$，其中 $\\mu_{gi} = s_i q_{gi}$，$s_i$ 是样本特异性的文库大小（大小因子），$q_{gi}$ 是样本 $i$ 中基因 $g$ 的潜在表达水平，而 $\\alpha_g$ 是基因特异性的离散度。技术故障可能会扭曲 $s_i$ 并在 $q_{gi}$ 中引入基因和转录本长度依赖的偏倚（例如，由于降解导致 $3'$ 端富集），从而违反了差异可由固定的设计协变量捕获的假设。\n\n所有样本的质量控制（QC）摘要均可用，包括总读数 $R_i$、唯一比对分数 $\\hat{p}_{u,i}$、重复率 $d_i$、核糖体分数 $r_i$、$3'$ 到 $5'$ 端覆盖率比值 $b_i$、RNA 完整性数值 $q_i$ (RIN)，以及通过中位数比率法估计的大小因子 $s_i$。对跨基因的对数转换和标准化的计数进行了主成分分析（PCA），通过计算样本协方差矩阵的特征分解来获得主成分及其特征值 $\\lambda_1, \\lambda_2, \\ldots$；前两个主成分分别解释了方差的 $\\lambda_1 / \\sum_j \\lambda_j$ 和 $\\lambda_2 / \\sum_j \\lambda_j$。\n\n一个标记为 $S7$ 的案例样本在 PCA 中是一个明显的离群值。第一个主成分解释了 $35\\%$ 的方差（即 $\\lambda_1 / \\sum_j \\lambda_j = 0.35$），第二个主成分解释了 $18\\%$ 的方差（即 $\\lambda_2 / \\sum_j \\lambda_j = 0.18$）。$S7$ 在主成分1上的 PCA 坐标为 $z_{1,7} = 5.2$，在主成分2上的 PCA 坐标为 $z_{2,7} = -0.4$，而所有其他样本都满足 $|z_{1,i}|  1.0$ 和 $|z_{2,i}|  1.2$。按批次着色显示 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 的聚类重叠，而 $S7$ 与两个批次都分离。\n\n$S7$ 的 QC 指标与其他样本的范围对比如下：\n- $R_7 = 2.8 \\times 10^7$ 读数（其他样本：$R_i \\in [3.0 \\times 10^7, 4.1 \\times 10^7]$），\n- $\\hat{p}_{u,7} = 0.52$（其他样本：$\\hat{p}_{u,i} \\in [0.76, 0.88]$），\n- $d_7 = 0.65$（其他样本：$d_i \\in [0.22, 0.44]$），\n- $r_7 = 0.23$（其他样本：$r_i \\in [0.04, 0.09]$），\n- $b_7 = 2.3$（其他样本：$b_i \\in [0.93, 1.15]$），\n- $q_7 = 5.1$（其他样本：$q_i \\in [7.8, 9.2]$），\n- $s_7 = 0.42$（其他样本：$s_i \\in [0.84, 1.15]$）。\n\n此外，还加入了已知数量的外部 RNA 控制联盟（ERCC）的 spike-in 分子。对于 $S7$，观测到的 ERCC 计数与预期浓度之间的斯皮尔曼相关系数为 $\\rho_7 = 0.31$（其他样本：$\\rho_i \\in [0.78, 0.92]$）。$S7$ 剩余的可用输入 RNA 材料为 $M_7 = 0.8 \\,\\mu\\text{g}$，而文库试剂盒的规格要求 $\\geq 1.0 \\,\\mu\\text{g}$ 的高质量输入 RNA。\n\n您计划使用一个包含截距和条件指示符的设计矩阵 $X$，以及可能存在的批次协变量或其他干扰因素，将广义线性模型拟合到计数 $Y_{gi}$ 上。基于以上信息，为 $S7$ 选择最恰当的处理方法，以确保科学上有效的推断，并从数据生成和分析模型的第一性原理出发，论证您的选择。\n\n哪种处理方法最恰当？\nA. 将 $S7$ 从下游的差异表达分析中排除，并记录因技术故障而排除。\nB. 使用剩余的 RNA 材料为 $S7$ 重新进行文库制备，以恢复一个可用的文库。\nC. 保留 $S7$ 并在设计矩阵 $X$ 中包含一个批次指示符以解释该离群值。\nD. 保留 $S7$ 并应用替代变量分析（surrogate variable analysis）来捕获隐藏因素，同时保留该样本。\nE. 保留 $S7$ 并滤除与核糖体 RNA 比对的读数；其余步骤照常进行。",
            "solution": "问题要求确定处理样本 $S7$ 的最恰当方法，该样本在一次 RNA 测序实验中表现为一个显著的离群值。该决策必须基于实验设计、数据质量控制和统计建模的原则，以确保最终结论的科学有效性。\n\n首先，我将总结和解释所提供的关于样本 $S7$ 的大量证据。目标是确定该样本的离群状态是反映了真实的生物现象还是技术故障。\n\n**关于样本 $S7$ 的证据分析**\n\n数据为样本 $S7$ 处理过程中出现的严重技术故障提供了一个令人信服且多方面的案例。\n\n1.  **主成分分析 (PCA):** 样本 $S7$ 在第一主成分（PC1）上是一个剧烈的离群值，其坐标为 $z_{1,7} = 5.2$，而所有其他样本的坐标满足 $|z_{1,i}|  1.0$。由于 PC1 解释了数据集中总方差的 $35\\%$（$\\lambda_1 / \\sum_j \\lambda_j = 0.35$），这单个样本是驱动主要变异模式的原因。由单个样本驱动的主要变异来源，而非由感兴趣的实验条件驱动，是技术性假象的强烈指标，而不是生物学上的极端表型。$S7$ 与两个批次 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 都分离，这一事实证实了这并非简单的批次效应。\n\n2.  **RNA 质量与降解:** $S7$ 的 RNA 完整性数值（RIN）为 $q_7 = 5.1$，远低于其他样本的范围（$q_i \\in [7.8, 9.2]$）。低于 $6.0$ 的 RIN 分数表明 RNA 严重降解。$S7$ 的高 $3'$-到-$5'$ 端覆盖率比值 $b_7 = 2.3$（其他样本：$b_i \\in [0.93, 1.15]$）证实了这一点。RNA 降解与 poly-A 尾文库制备方法相结合，会导致读数在转录本的 $3'$ 端累积。这会在定量中产生一种基因长度依赖的偏倚，而这种偏倚无法通过单个样本特异性的大小因子 $s_i$ 来校正。\n\n3.  **文库质量:** 从 $S7$ 生成的文库质量很差。重复率极高（$d_7 = 0.65$，而其他样本在 $[0.22, 0.44]$ 之间），这表明文库复杂度低，为了达到足够的产量而进行了过度的 PCR 扩增。这降低了有效测序深度和表达量估计的精度。唯一比对分数非常低（$\\hat{p}_{u,7} = 0.52$，而其他样本在 $[0.76, 0.88]$ 之间），这可能表明存在污染或其他文库制备失败，如接头二聚体形成。\n\n4.  **测序效率与污染:** 核糖体 RNA 分数显著升高（$r_7 = 0.23$，而其他样本在 $[0.04, 0.09]$ 之间），表明 poly-A 筛选或 rRNA 去除步骤效率低下。因此，大部分测序资源浪费在了非目标分子上。这与稍低的总读数（$R_7 = 2.8 \\times 10^7$）相结合，导致估计的大小因子非常低（$s_7 = 0.42$），意味着编码转录本的有效文库大小仅为其他样本的一小部分。\n\n5.  **定量准确性（地面实况）:** 最明确的失败证据来自外部 RNA 控制联盟（ERCC）的 spike-in 数据。$S7$ 的观测计数与预期浓度之间的斯皮尔曼相关系数仅为 $\\rho_7 = 0.31$，而所有其他样本都较高（$\\rho_i \\in [0.78, 0.92]$）。这表明来自样本 $S7$ 的定量测量未能忠实反映原始样本中分子的真实丰度。整个定量测量的基础都已受损。\n\n**对统计模型的影响**\n\n预期的分析使用负二项模型，其中平均计数 $\\mu_{gi}$ 被建模为 $\\mu_{gi} = s_i q_{gi}$。该模型假设所有样本特异性的技术效应都可以通过单个缩放因子 $s_i$ 来捕获，从而使 $q_{gi}$ 代表感兴趣的生物学量。关于 $S7$ 的证据表明，这一假设被严重违反了。RNA 降解引入了复杂的、基因依赖的偏倚（例如，与转录本长度相关的偏倚），这是单个因子 $s_7$ 无法校正的。将此样本纳入分析会夸大方差估计（离散度 $\\alpha_g$），急剧降低统计功效，并由于大量未建模的技术噪声而引入假阳性和假阴性差异表达判定的高风险。\n\n基于此分析，我们可以评估所提出的处理方法。\n\n**逐项分析**\n\n**A. 将 $S7$ 从下游的差异表达分析中排除，并记录因技术故障而排除。**\n证据是确凿的：由于始于低质量输入 RNA 的一系列技术故障，$S7$ 的数据并非该样本生物学的有效代表。下游统计分析的基本假设以一种无法通过计算校正的方式被违反了。在这种情况下，最科学严谨且可辩护的行动是排除该样本。这将研究结论的有效性和完整性置于样本量边际损失之上。最终分析将以 $5$ 个案例对 $6$ 个对照进行。排除该样本及其详细原因必须被透明地记录下来。\n**结论：正确。**\n\n**B. 使用剩余的 RNA 材料为 $S7$ 重新进行文库制备，以恢复一个可用的文库。**\n问题陈述剩余的 RNA 材料为 $M_7 = 0.8 \\,\\mu\\text{g}$，而试剂盒要求 $\\geq 1.0 \\,\\mu\\text{g}$。此外，这批剩余的 RNA 与已被证实质量极差（$q_7 = 5.1$）的是同一批。试图用不足且已降解的起始材料生成新文库违反了实验方案，几乎肯定会导致另一次文库制备失败。这一行动将是浪费时间和资源。\n**结论：不正确。**\n\n**C. 保留 $S7$ 并在设计矩阵 $X$ 中包含一个批次指示符以解释该离群值。**\n批次效应是影响一组共同处理的样本的系统性技术变异。PCA 图显示，$S7$ 相对于*所有*其他样本（包括其自身批次中的样本）都是一个离群值。因此，它的变异不是批次效应。在模型中包含批次协变量无法解释 $S7$ 的独有偏差。将 $S7$ 建模为其自身的批次是一种临时凑合的修复方法，它没有解决潜在的非线性、基因依赖的偏倚（如 $3'$ 偏倚）以及由 ERCC 数据证实的定量准确性的根本缺失。\n**结论：不正确。**\n\n**D. 保留 $S7$ 并应用替代变量分析来捕获隐藏因素，同时保留该样本。**\n替代变量分析（SVA）是一种估计和解释未测量的系统性变异来源的方法。虽然 SVA 很强大，但它并非旨在挽救来自单个灾难性样本失败的数据。来自 $S7$ 的变异是如此之大（$\\lambda_1 / \\sum_j \\lambda_j = 0.35$），其技术原因又如此有据可查（降解、低复杂度等），以至于它不是一个“隐藏”因素。更重要的是，SVA 和其他线性模型调整无法解决数据不具有定量性的根本问题，正如低的 ERCC 相关性（$\\rho_7 = 0.31$）所示。最佳实践是在应用 SVA 等方法寻找更微妙、未知的混杂因素*之前*，移除具有已知严重技术假象的样本。\n**结论：不正确。**\n\n**E. 保留 $S7$ 并滤除与核糖体 RNA 比对的读数；其余步骤照常进行。**\n过滤 rRNA 读数是一个标准的数据处理步骤。高 rRNA 分数（$r_7 = 0.23$）是文库制备失败的症状，而不是根本原因。移除这些读数无法解决 RNA 降解（$q_7 = 5.1$, $b_7 = 2.3$）、低文库复杂度（$d_7 = 0.65$）或由此导致的定量准确性丧失（$\\rho_7 = 0.31$）等根本问题。剩余的非 rRNA 读数仍将携带所有这些技术假象，使其不适用于差异表达分析。\n**结论：不正确。**\n\n总之，来自多个独立 QC 指标的压倒性且一致的证据表明，样本 $S7$ 存在不可挽回的技术故障。唯一科学合理的行动是排除该样本，以维护分析的完整性。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}