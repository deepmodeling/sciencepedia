{
    "hands_on_practices": [
        {
            "introduction": "Molecular dynamics simulations rely on force fields, which describe the potential energy of a system using parameters that are often reported in units convenient for computation, such as kilojoules per mole. To connect these parameters to real-world physical properties, like the vibrational frequencies measured in spectroscopy, we must convert them into standard SI units on a per-molecule basis. This exercise  will guide you through this essential conversion for a bond stretching term and explore how uncertainties in force field parameters propagate to affect predictions of physical observables.",
            "id": "4586353",
            "problem": "A Molecular Dynamics (MD) force field models a single covalent bond stretching interaction by the potential energy function $U_b = k_b^{\\mathrm{MD}}(b - b_0)^2$, where $k_b^{\\mathrm{MD}}$ is reported in kilojoules per mole per square nanometre. Consider a carbon–hydrogen bond with equilibrium length $b_0$ and atomic masses $m_{\\mathrm{C}} = 12.0107$ unified atomic mass units (u) and $m_{\\mathrm{H}} = 1.00784$ unified atomic mass units (u). Use the International System of Units (SI) to express mass in kilograms and force constants in newtons per metre. The unified atomic mass unit is $m_u = 1.66053906660 \\times 10^{-27}$ kilograms, and Avogadro’s number is $N_A = 6.02214076 \\times 10^{23}$ mol$^{-1}$. Suppose the MD-reported bond parameter is $k_b^{\\mathrm{MD}} = 4.00 \\times 10^{5}$ kilojoules per mole per square nanometre, and its relative uncertainty is $\\delta = 0.07290$. Starting from Newton’s laws and the definition of reduced mass, compute the SI per-bond force constant that governs the small-amplitude vibrational dynamics and, using a small-displacement linearization, determine how the relative uncertainty in $k_b^{\\mathrm{MD}}$ propagates to the angular vibrational frequency $\\omega$ for the bond. Express your final answer as the fractional error in $\\omega$ (a dimensionless decimal), and round your answer to four significant figures. You do not need to report intermediate quantities such as the SI force constant or the angular frequency; only report the fractional error in $\\omega$.",
            "solution": "The problem requires the calculation of the fractional uncertainty in the angular vibrational frequency, $\\omega$, of a carbon-hydrogen bond, given the fractional uncertainty in the associated molecular dynamics (MD) force field parameter, $k_b^{\\mathrm{MD}}$.\n\nFirst, we must establish the relationship between the per-mole potential energy function provided by the MD force field and the per-bond potential energy described by the physical harmonic oscillator model. The MD potential energy for a mole of bonds is given as:\n$$U_b = k_b^{\\mathrm{MD}}(b - b_0)^2$$\nwhere $k_b^{\\mathrm{MD}}$ is the force field parameter with units of kilojoules per mole per square nanometre ($\\text{kJ mol}^{-1} \\text{nm}^{-2}$), $b$ is the bond length, and $b_0$ is the equilibrium bond length.\n\nTo obtain the potential energy for a single bond, $U_{\\text{single}}$, we must divide $U_b$ by Avogadro's number, $N_A$:\n$$U_{\\text{single}} = \\frac{U_b}{N_A} = \\frac{k_b^{\\mathrm{MD}}}{N_A}(b - b_0)^2$$\nThe units of the coefficient $\\frac{k_b^{\\mathrm{MD}}}{N_A}$ are now kilojoules per square nanometre ($\\text{kJ nm}^{-2}$).\n\nNext, we convert this single-bond potential energy into SI units (Joules, J, for energy and metres, m, for length).\nWe use the conversion factors:\n$1 \\text{ kJ} = 10^3 \\text{ J}$\n$1 \\text{ nm} = 10^{-9} \\text{ m}$, which implies $1 \\text{ nm}^2 = (10^{-9})^2 \\text{ m}^2 = 10^{-18} \\text{ m}^2$.\n\nThe conversion for the coefficient is:\n$$ \\frac{k_b^{\\mathrm{MD}}}{N_A} \\left[\\frac{\\text{kJ}}{\\text{nm}^2}\\right] \\times \\frac{10^3 \\text{ J}}{1 \\text{ kJ}} \\times \\frac{1 \\text{ nm}^2}{10^{-18} \\text{ m}^2} = \\frac{k_b^{\\mathrm{MD}}}{N_A} \\times 10^{21} \\left[\\frac{\\text{J}}{\\text{m}^2}\\right] $$\nThus, the single-bond potential energy in SI units is:\n$$U_{\\text{single}} = \\left( \\frac{10^{21}}{N_A} k_b^{\\mathrm{MD}} \\right) (b - b_0)^2$$\n\nThe standard physical model for small-amplitude vibrations of a bond is the simple harmonic oscillator, whose potential energy is given by:\n$$U_{\\text{SHO}} = \\frac{1}{2} k_{\\text{SI}} (b - b_0)^2$$\nHere, $k_{\\text{SI}}$ is the per-bond force constant in SI units (Newtons per metre, $\\text{N m}^{-1}$, which is equivalent to Joules per square metre, $\\text{J m}^{-2}$).\n\nBy comparing the expressions for $U_{\\text{single}}$ and $U_{\\text{SHO}}$, we can relate the MD parameter $k_b^{\\mathrm{MD}}$ to the physical force constant $k_{\\text{SI}}$:\n$$\\frac{1}{2} k_{\\text{SI}} (b - b_0)^2 = \\left( \\frac{10^{21}}{N_A} k_b^{\\mathrm{MD}} \\right) (b - b_0)^2$$\n$$k_{\\text{SI}} = \\frac{2 \\times 10^{21}}{N_A} k_b^{\\mathrm{MD}}$$\n\nAccording to Newton's second law applied to the two-body system (carbon and hydrogen atoms), the equation of motion for small displacements $x = b - b_0$ from equilibrium is:\n$$\\mu \\frac{d^2x}{dt^2} = -k_{\\text{SI}} x$$\nwhere $\\mu$ is the reduced mass of the two-atom system. This is the equation for simple harmonic motion. The angular vibrational frequency $\\omega$ is given by:\n$$\\omega = \\sqrt{\\frac{k_{\\text{SI}}}{\\mu}}$$\n\nThe reduced mass $\\mu$ is defined as:\n$$\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{H}}}{m_{\\mathrm{C}} + m_{\\mathrm{H}}}$$\nwhere $m_{\\mathrm{C}} = 12.0107 \\text{ u}$ and $m_{\\mathrm{H}} = 1.00784 \\text{ u}$ are the masses of the carbon and hydrogen atoms. To be used in the SI-unit formula for $\\omega$, $\\mu$ must be expressed in kilograms by multiplying by the unified atomic mass unit $m_u = 1.66053906660 \\times 10^{-27} \\text{ kg}$.\n\nSubstituting the expression for $k_{\\text{SI}}$ into the equation for $\\omega$:\n$$\\omega = \\sqrt{\\frac{\\left( \\frac{2 \\times 10^{21}}{N_A} k_b^{\\mathrm{MD}} \\right)}{\\mu}}$$\nSince $\\mu$, $N_A$, and the numerical factors are constants, we can express $\\omega$ as:\n$$\\omega = C \\sqrt{k_b^{\\mathrm{MD}}}$$\nwhere $C = \\sqrt{\\frac{2 \\times 10^{21}}{N_A \\mu}}$ is a constant.\n\nWe are asked to find the fractional uncertainty in $\\omega$, denoted $\\frac{\\Delta\\omega}{|\\omega|}$, resulting from the uncertainty in $k_b^{\\mathrm{MD}}$. For a relationship of the form $y = c x^n$, the rule for propagation of fractional uncertainties is:\n$$\\frac{\\Delta y}{|y|} = |n| \\frac{\\Delta x}{|x|}$$\nIn our case, $y = \\omega$, $x = k_b^{\\mathrm{MD}}$, and the exponent is $n = \\frac{1}{2}$. The fractional uncertainty in $k_b^{\\mathrm{MD}}$ is given as $\\delta = \\frac{\\Delta k_b^{\\mathrm{MD}}}{k_b^{\\mathrm{MD}}} = 0.07290$.\nTherefore, the fractional uncertainty in $\\omega$ is:\n$$\\frac{\\Delta\\omega}{\\omega} = \\left|\\frac{1}{2}\\right| \\frac{\\Delta k_b^{\\mathrm{MD}}}{k_b^{\\mathrm{MD}}} = \\frac{1}{2}\\delta$$\n\nSubstituting the given value for $\\delta$:\n$$\\frac{\\Delta\\omega}{\\omega} = \\frac{1}{2} \\times 0.07290 = 0.03645$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $0.03645$ already has four significant figures.",
            "answer": "$$\\boxed{0.03645}$$"
        },
        {
            "introduction": "A fundamental choice in any molecular dynamics simulation is the integration time step, $\\Delta t$, which dictates the trade-off between computational cost and numerical stability. If the time step is too large, the simulation will become unstable and produce nonsensical results. This practice  delves into the theoretical basis for this stability limit by analyzing the behavior of the Verlet integrator for the fastest motions in a biomolecule, modeled as a simple harmonic oscillator.",
            "id": "4586302",
            "problem": "A research group in bioinformatics and medical data analytics is performing Molecular Dynamics (MD) simulations of a solvated peptide with unconstrained hydrogen bonds. In MD, numerical stability of the time integration is controlled by the highest vibrational frequency present in the system. Consider a single normal mode approximated near equilibrium by a harmonic oscillator with natural angular frequency $\\omega$ arising from linearization of Newton's second law $m\\,d^{2}x/dt^{2}=-\\partial U/\\partial x$ about a minimum of the potential energy $U(x)$. The simulation uses the standard position form of the Verlet integrator to propagate atomic positions. \n\nStarting from these fundamental bases (Newton’s second law, small-amplitude harmonic approximation, and the position form of the Verlet integrator), derive the explicit upper bound on the MD time step $\\Delta t$ required for linear stability as a function of the highest angular frequency $\\omega_{\\max}$ in the biomolecule. Then, under the laboratory’s conservative policy that production runs use a safety factor $s=0.25$ relative to the maximum stable $\\Delta t$ you derive, compute a feasible $\\Delta t$ for a peptide whose unconstrained X–H bond stretching sets $\\omega_{\\max}=3\\times 10^{14}\\ \\mathrm{s}^{-1}$. \n\nExpress your final $\\Delta t$ in femtoseconds (fs) and round your answer to three significant figures. Your final answer must be a single real-valued number.",
            "solution": "The problem requires the derivation of the stability condition for the Verlet integrator applied to a harmonic oscillator, followed by the application of this result to a specific biomolecular simulation scenario. The derivation proceeds from the fundamental principles outlined in the problem statement.\n\nFirst, we model the high-frequency vibration of an X-H bond as a one-dimensional simple harmonic oscillator. The potential energy $U(x)$ near a minimum at equilibrium position $x=0$ is approximated by the first non-zero term in its Taylor expansion, $U(x) \\approx \\frac{1}{2}kx^2$, where $k$ is the effective spring constant of the bond. Newton's second law of motion is $m\\frac{d^2x}{dt^2} = F(x)$, where the force is $F(x) = -\\frac{\\partial U}{\\partial x} = -kx$. The equation of motion is therefore $m\\frac{d^2x}{dt^2} = -kx$. This can be expressed in terms of the natural angular frequency of the oscillator, $\\omega = \\sqrt{\\frac{k}{m}}$, as:\n$$\n\\frac{d^2x}{dt^2} = -\\omega^2 x(t)\n$$\nThe acceleration at time $t$ is thus $a(t) = -\\omega^2 x(t)$.\n\nNext, we introduce the standard position form of the Verlet integrator. The position of a particle at time step $n+1$, denoted $x_{n+1} = x((n+1)\\Delta t)$, is propagated from the positions at time steps $n$ and $n-1$ using the following finite difference equation:\n$$\nx_{n+1} = 2x_n - x_{n-1} + a_n (\\Delta t)^2\n$$\nwhere $a_n = a(n\\Delta t)$ is the acceleration at time step $n$ and $\\Delta t$ is the integration time step.\n\nWe substitute the expression for the acceleration of the harmonic oscillator into the Verlet integration formula:\n$$\nx_{n+1} = 2x_n - x_{n-1} - \\omega^2 x_n (\\Delta t)^2\n$$\nRearranging this equation gives a linear homogeneous recurrence relation with constant coefficients:\n$$\nx_{n+1} - \\left(2 - \\omega^2 (\\Delta t)^2\\right) x_n + x_{n-1} = 0\n$$\n\nTo analyze the stability of this numerical scheme, we propose a solution of the form $x_n = A\\lambda^n$. Substituting this ansatz into the recurrence relation yields the characteristic equation for $\\lambda$:\n$$\nA\\lambda^{n+1} - \\left(2 - \\omega^2 (\\Delta t)^2\\right) A\\lambda^n + A\\lambda^{n-1} = 0\n$$\nFor a non-trivial solution ($A \\ne 0, \\lambda \\ne 0$), we can divide by $A\\lambda^{n-1}$ to obtain a quadratic equation in $\\lambda$:\n$$\n\\lambda^2 - \\left(2 - \\omega^2 (\\Delta t)^2\\right) \\lambda + 1 = 0\n$$\n\nFor the trajectory $x_n$ to remain bounded, which is the condition for numerical stability, the magnitude of the roots $\\lambda$ of the characteristic equation must not exceed unity, i.e., $|\\lambda| \\le 1$. Let us define a variable $\\beta = 1 - \\frac{\\omega^2 (\\Delta t)^2}{2}$. The characteristic equation can be rewritten as $\\lambda^2 - 2\\beta\\lambda + 1 = 0$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{2\\beta \\pm \\sqrt{4\\beta^2 - 4}}{2} = \\beta \\pm \\sqrt{\\beta^2 - 1}\n$$\n\nThe stability depends on the nature of these roots, which is determined by the discriminant $\\beta^2 - 1$:\n1. If $|\\beta| > 1$, then $\\beta^2 - 1 > 0$, and the roots are real. Since the product of the roots is $\\lambda_1 \\lambda_2 = 1$ (from the constant term of the quadratic), one root must have a magnitude greater than $1$. This leads to an exponential growth in the solution $x_n = A\\lambda^n$, signifying instability.\n2. If $|\\beta| \\le 1$, then $\\beta^2 - 1 \\le 0$. The roots are complex conjugates (or real and equal if $|\\beta|=1$).\n   - If $|\\beta| < 1$, the roots are $\\lambda = \\beta \\pm i\\sqrt{1-\\beta^2}$. The magnitude of these roots is $|\\lambda| = \\sqrt{\\beta^2 + \\left(\\sqrt{1-\\beta^2}\\right)^2} = \\sqrt{\\beta^2 + 1 - \\beta^2} = 1$. The solution is oscillatory with constant amplitude, which corresponds to a stable integration that correctly reproduces the energy-conserving dynamics of the harmonic oscillator.\n   - At the boundary, $|\\beta|=1$, the roots are real and equal, $\\lambda_{1,2}=\\beta=\\pm 1$. This is the limit of stability.\n\nTherefore, the condition for numerical stability of the Verlet integrator for a harmonic oscillator is $|\\beta| \\le 1$. Substituting the definition of $\\beta$:\n$$\n\\left| 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} \\right| \\le 1\n$$\nThis absolute value inequality is equivalent to the compound inequality:\n$$\n-1 \\le 1 - \\frac{\\omega^2 (\\Delta t)^2}{2} \\le 1\n$$\nThe right-hand side, $1 - \\frac{\\omega^2 (\\Delta t)^2}{2} \\le 1$, implies $-\\frac{\\omega^2 (\\Delta t)^2}{2} \\le 0$, which is always true for real $\\omega$ and $\\Delta t$. The left-hand side provides the critical constraint on the time step:\n$$\n-1 \\le 1 - \\frac{\\omega^2 (\\Delta t)^2}{2}\n$$\n$$\n\\frac{\\omega^2 (\\Delta t)^2}{2} \\le 2\n$$\n$$\n\\omega^2 (\\Delta t)^2 \\le 4\n$$\nTaking the square root of both sides (since $\\omega > 0$ and $\\Delta t > 0$) yields the stability condition:\n$$\n\\omega \\Delta t \\le 2\n$$\nIn a complex system like a biomolecule, this condition must hold for all vibrational modes. The stability of the entire simulation is governed by the mode with the highest frequency, $\\omega_{\\max}$, as it imposes the most restrictive limit on $\\Delta t$. The upper bound for the time step is thus:\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}}\n$$\nThe maximum stable time step is $\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}}$.\n\nNow, we apply this derived result to the specific problem. We are given the highest angular frequency $\\omega_{\\max} = 3 \\times 10^{14}\\ \\mathrm{s}^{-1}$. The maximum stable time step is:\n$$\n\\Delta t_{\\max} = \\frac{2}{3 \\times 10^{14}\\ \\mathrm{s}^{-1}} = \\frac{2}{3} \\times 10^{-14}\\ \\mathrm{s}\n$$\nThe laboratory's policy is to use a feasible time step $\\Delta t$ that is a fraction of this maximum value, determined by a safety factor $s=0.25$:\n$$\n\\Delta t = s \\cdot \\Delta t_{\\max} = 0.25 \\cdot \\left(\\frac{2}{3} \\times 10^{-14}\\ \\mathrm{s}\\right) = \\frac{1}{4} \\cdot \\frac{2}{3} \\times 10^{-14}\\ \\mathrms = \\frac{2}{12} \\times 10^{-14}\\ \\mathrms = \\frac{1}{6} \\times 10^{-14}\\ \\mathrms\n$$\nFinally, we convert this result to femtoseconds (fs), using the conversion factor $1\\ \\mathrm{fs} = 10^{-15}\\ \\mathrm{s}$:\n$$\n\\Delta t = \\left(\\frac{1}{6} \\times 10^{-14}\\ \\mathrm{s}\\right) \\times \\left(\\frac{1\\ \\mathrm{fs}}{10^{-15}\\ \\mathrm{s}}\\right) = \\frac{1}{6} \\times 10^{(-14 - (-15))}\\ \\mathrm{fs} = \\frac{1}{6} \\times 10^{1}\\ \\mathrm{fs} = \\frac{10}{6}\\ \\mathrm{fs} = \\frac{5}{3}\\ \\mathrm{fs}\n$$\nEvaluating this fraction gives $\\Delta t \\approx 1.666... \\mathrm{fs}$. As per the problem's requirement, we round this to three significant figures:\n$$\n\\Delta t \\approx 1.67\\ \\mathrm{fs}\n$$",
            "answer": "$$\\boxed{1.67}$$"
        },
        {
            "introduction": "To simulate a small portion of a bulk system, such as a solvated biomolecule, molecular dynamics simulations employ periodic boundary conditions (PBC) to minimize edge effects. The dimensions of the periodic box must be chosen carefully to ensure the central molecule is adequately solvated and does not artificially interact with its own periodic images. This exercise  provides hands-on practice in applying the geometric principles and the minimum image convention to determine an appropriate box size, a critical first step in preparing a valid simulation.",
            "id": "4586373",
            "problem": "A molecular dynamics (MD) simulation is to be prepared for a globular biomolecular solute that can be conservatively enclosed within a sphere of radius $R = 3\\,\\mathrm{nm}$. The system will be simulated in a cubic box with periodic boundary conditions (PBC). To reduce spurious finite-size effects, the initial solvated configuration must provide at least $p = 1.2\\,\\mathrm{nm}$ of solvent between the solute surface and each face of the cubic box in every direction. The nonbonded interactions are treated with a pairwise real-space cutoff of $r_{c} = 1.0\\,\\mathrm{nm}$ for both Lennard–Jones (LJ) interactions and the real-space part of electrostatics, while long-range electrostatics are computed with Particle Mesh Ewald (PME). Using only fundamental geometric reasoning, the minimum image convention under PBC, and the definition of a real-space cutoff, derive the minimum cubic box length $L_{\\min}$ that satisfies the solvent padding requirement and argue whether this choice guarantees that no atom of the solute can directly interact in real space with any atom of its own periodic images. Express the final $L_{\\min}$ as a single number in nanometers. Provide the exact decimal value (no rounding instruction is required).",
            "solution": "The solution involves two parts: first, deriving the minimum cubic box length, $L_{\\min}$, from the geometric constraints, and second, arguing whether this length prevents direct real-space interactions between the solute and its periodic images.\n\n**Part 1: Derivation of the Minimum Box Length $L_{\\min}$**\n\nLet the cubic simulation box have a side length of $L$. The solute is contained within a sphere of radius $R = 3\\,\\mathrm{nm}$, which means its diameter is $2R = 6\\,\\mathrm{nm}$. To ensure a minimum solvent padding of $p = 1.2\\,\\mathrm{nm}$ between the solute and the box faces, the total length of the box, $L$, must accommodate the solute's diameter plus the padding on both sides along any given dimension.\n\nTherefore, the minimum required length $L_{\\min}$ is:\n$$ L_{\\min} = (\\text{solute diameter}) + 2 \\times (\\text{padding}) = 2R + 2p $$\nSubstituting the given values:\n$$ L_{\\min} = 2(3\\,\\mathrm{nm}) + 2(1.2\\,\\mathrm{nm}) = 6\\,\\mathrm{nm} + 2.4\\,\\mathrm{nm} = 8.4\\,\\mathrm{nm} $$\n\n**Part 2: Argument on Self-Interaction**\n\nThe second task is to determine if this box size, $L_{\\min} = 8.4\\,\\mathrm{nm}$, prevents any atom of the solute from directly interacting with its own periodic images. According to the minimum image convention, this requires the shortest distance between the solute and any of its images to be greater than the real-space interaction cutoff, $r_c = 1.0\\,\\mathrm{nm}$.\n\nIf the solute is centered in the box, the shortest distance between its surface and the surface of its nearest periodic image is the box length, $L$, minus the radius of the solute twice (once for the original, once for the image).\n$$ d_{\\text{min_separation}} = L - 2R $$\nFor there to be no direct real-space self-interaction, we must have:\n$$ L - 2R > r_c $$\nUsing our calculated $L_{\\min} = 2R + 2p$, we can test this condition:\n$$ (2R + 2p) - 2R > r_c $$\n$$ 2p > r_c $$\nSubstituting the numerical values $p = 1.2\\,\\mathrm{nm}$ and $r_c = 1.0\\,\\mathrm{nm}$:\n$$ 2(1.2\\,\\mathrm{nm}) > 1.0\\,\\mathrm{nm} \\implies 2.4\\,\\mathrm{nm} > 1.0\\,\\mathrm{nm} $$\nThis inequality is true. The condition is satisfied. The minimum distance between solute images ($2.4\\,\\mathrm{nm}$) is greater than the cutoff distance ($1.0\\,\\mathrm{nm}$).\n\nTherefore, the choice of $L_{\\min} = 8.4\\,\\mathrm{nm}$ based on the padding requirement also guarantees that no atom of the solute can directly interact in real space with any atom of its own periodic images. The final answer for the minimum cubic box length is $8.4\\,\\mathrm{nm}$.",
            "answer": "$$\\boxed{8.4}$$"
        }
    ]
}