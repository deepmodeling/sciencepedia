{
    "hands_on_practices": [
        {
            "introduction": "计算药物重定位的一个基本假设是，结构相似的药物可能具有相似的生物活性。该练习将引导您实践一种量化化学结构相似性的核心方法。通过推导和计算Tanimoto系数——一种基于分子指纹的常用指标——您将掌握评估化合物之间结构关系的基本技能。",
            "id": "4549838",
            "problem": "在计算药物重定位中，一种策略是构建化学相似性网络，其中候选化合物通过高结构相似性与已批准的药物相连接，然后通过该网络传播表型证据。用于此类相似性计算的分子结构的常见表示是二进制结构指纹，例如扩展连接性指纹（ECFP），其中每个化合物被编码为一个固定长度的二进制向量，表示特定子结构特征的存在与否。考虑两个由长度为 $1024$ 的二进制指纹表示的化合物，并令 $A$ 和 $B$ 分别表示各自指纹中位为 $1$ 的特征索引（位置）的集合。一个广泛使用且经过充分检验的集合相似性基本度量是 Jaccard 指数，对于有限集合其定义为 $$J(A,B) = \\frac{|A \\cap B|}{|A \\cup B|}.$$ 从这个基本定义以及将二进制指纹解释为活性特征集合出发，根据计数 $a = |A|$、$b = |B|$ 和 $c = |A \\cap B|$，推导出适用于二进制指纹的 Tanimoto 系数的表达式。然后，对于两个具有 $a=120$、$b=150$ 和 $c=90$ 的 $1024$ 位指纹，计算 Tanimoto 系数。请提供精确值，无需四舍五入。将最终的相似性表示为一个无量纲的实数。",
            "solution": "该问题陈述经评估在科学上是合理的、适定的和客观的。它基于化学信息学和生物信息学中已确立的原则，特别是利用分子指纹和相似性度量进行药物发现。所有必要信息都已提供，以得出一个唯一的解。\n\n任务首先是推导二进制指纹的 Tanimoto 系数的表达式，然后计算其在特定情况下的值。\n\n问题将基本相似性度量定义为两个有限集合 $A$ 和 $B$ 的 Jaccard 指数：\n$$J(A,B) = \\frac{|A \\cap B|}{|A \\cup B|}$$\n在此背景下，$A$ 和 $B$ 是两个不同化合物的二进制指纹中位为 $1$ 的索引集合。变量定义为这些集合及其交集的基数：\n$a = |A|$，化合物1中存在的特征数量。\n$b = |B|$，化合物2中存在的特征数量。\n$c = |A \\cap B|$，两种化合物中都存在的特征数量。\n\n推导需要用给定的量 $a$、$b$ 和 $c$ 来表示分母 $|A \\cup B|$。使用两个集合的容斥原理，并集的基数由下式给出：\n$$|A \\cup B| = |A| + |B| - |A \\cap B|$$\n将给定的变量代入此公式，我们得到：\n$$|A \\cup B| = a + b - c$$\n现在，我们可以将分子和分母的表达式代回 Jaccard 指数的定义中：\n$$J(A,B) = \\frac{c}{a + b - c}$$\n在比较二进制向量或指纹的背景下，Jaccard 指数正式称为 Tanimoto 系数。因此，Tanimoto 系数（记为 $T_c$）的表达式为：\n$$T_c(A,B) = \\frac{c}{a + b - c}$$\n这完成了问题的第一部分。\n\n第二部分要求计算两个长度为 $1024$ 的指纹的该系数值，其特征如下：\n$a = |A| = 120$\n$b = |B| = 150$\n$c = |A \\cap B| = 90$\n\n指纹的长度 $1024$ 是关于特征空间的背景信息，但它不参与 Tanimoto 系数的计算，该系数仅取决于为1的位的数量。\n\n将这些值代入推导出的公式：\n$$T_c = \\frac{90}{120 + 150 - 90}$$\n首先，我们计算分母：\n$$120 + 150 - 90 = 270 - 90 = 180$$\n现在，我们计算这个分数：\n$$T_c = \\frac{90}{180}$$\n这个分数可以简化为：\n$$T_c = \\frac{1}{2}$$\nTanimoto 系数是一个无量纲的实数，问题要求提供精确值。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "超越化学结构，药物重定位策略常常比较药物对生物系统的影响。本练习探讨一种基于基因表达谱的“特征匹配”方法，即比较疾病引起的变化与药物引起的反向变化。您将计算重叠系数，并批判性地分析其作为相似性度量的局限性，这对于在实际应用中选择正确的分析工具至关重要。",
            "id": "4549869",
            "problem": "在计算药物重定位的工作流程中，通过比较疾病扰动特征和药物扰动特征，来识别其转录效应能抵消疾病相关变化的候选药物。考虑一个由上调基因集合组成的疾病特征，记为 $S_{\\mathrm{dis}}^{+}$，以及一个由下调基因集合组成的药物特征，记为 $S_{\\mathrm{drug}}^{-}$。这两个集合都源于对高通量转录组数据在共同的分析空间（如 Connectivity Map (CMap)）中进行的差异表达分析，Connectivity Map (CMap) 是一个提供扰动基因表达谱的资源。\n\n假设以下通过经验确定的量成立：\n- 疾病上调基因集合的基数为 $|S_{\\mathrm{dis}}^{+}| = 200$。\n- 药物下调基因集合的基数为 $|S_{\\mathrm{drug}}^{-}| = 150$。\n- 这两个集合交集的基数为 $|S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}| = 46$。\n\n从集合论的第一性原理和有限集合之间相似性的核心定义出发，计算 $S_{\\mathrm{dis}}^{+}$ 和 $S_{\\mathrm{drug}}^{-}$ 之间的重叠系数，其中重叠系数定义为交集覆盖较小集合的比例。将最终答案表示为精确分数，不要四舍五入。\n\n此外，在您的推导过程中，从第一性原理的角度解释该系数在药物-疾病特征比较背景下的解释性局限，特别是与那些同时考虑集合共享元素和独有元素的对称集合相似性度量相比。您的解释应基于集合基数、交集和并集的定义，并且在生物信息学和医学数据分析领域内具有科学现实性。",
            "solution": "问题陈述的有效性建立如下。\n\n**步骤 1：提取已知条件**\n- 疾病特征是上调基因的集合，$S_{\\mathrm{dis}}^{+}$。\n- 药物特征是下调基因的集合，$S_{\\mathrm{drug}}^{-}$。\n- 疾病上调基因集合的基数为 $|S_{\\mathrm{dis}}^{+}| = 200$。\n- 药物下调基因集合的基数为 $|S_{\\mathrm{drug}}^{-}| = 150$。\n- 这些集合交集的基数为 $|S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}| = 46$。\n- 重叠系数定义为“交集覆盖较小集合的比例”。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于生物信息学这一成熟领域，特别是在计算药物重定位方面。使用转录组扰动特征（上调/下调基因集）、通过基于集合的度量进行比较，以及提及像 Connectivity Map (CMap) 这样的资源，都是标准方法。数值是生物学上合理的。\n- **问题适定：** 该问题提供了计算所需系数的所有必要数据和清晰、无歧义的定义。在集合论及其在该领域应用的背景下，对概念性解释的要求也定义明确。\n- **客观性：** 问题使用了来自集合论和生物信息学的精确、正式的语言进行陈述。没有主观或模糊的术语。\n- **一致性：** 给定的基数与集合论的公理一致。交集的基数 $|S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}| = 46$ 小于或等于单个集合的基数 $|S_{\\mathrm{dis}}^{+}| = 200$ 和 $|S_{\\mathrm{drug}}^{-}| = 150$，符合要求。\n\n**步骤 3：结论与行动**\n该问题是有效的。它在科学上合理，数学上一致，且问题适定。将提供完整的解答。\n\n**解答推导**\n\n问题要求计算两个集合 $S_{\\mathrm{dis}}^{+}$ 和 $S_{\\mathrm{drug}}^{-}$ 的重叠系数，并分析其解释性局限。\n\n设这两个集合分别记为 $A = S_{\\mathrm{dis}}^{+}$ 和 $B = S_{\\mathrm{drug}}^{-}$。我们已知以下基数：\n- $|A| = |S_{\\mathrm{dis}}^{+}| = 200$\n- $|B| = |S_{\\mathrm{drug}}^{-}| = 150$\n- $|A \\cap B| = |S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}| = 46$\n\n重叠系数，我们记为 $O(A, B)$，定义为交集的大小除以两个集合中较小者的大小。这可以用最小值函数正式表示为：\n$$O(A, B) = \\frac{|A \\cap B|}{\\min(|A|, |B|)}$$\n该系数也称为 Szymkiewicz–Simpson 系数。\n\n首先，我们通过比较它们的基数来确定较小的集合：\n$$\\min(|A|, |B|) = \\min(200, 150) = 150$$\n较小的集合是 $B = S_{\\mathrm{drug}}^{-}$。\n\n现在，我们将给定值代入重叠系数的公式：\n$$O(S_{\\mathrm{dis}}^{+}, S_{\\mathrm{drug}}^{-}) = \\frac{|S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}|}{\\min(|S_{\\mathrm{dis}}^{+}|, |S_{\\mathrm{drug}}^{-}|)} = \\frac{46}{150}$$\n为了将其表示为最简精确分数，我们找到分子和分母的最大公约数。46 和 150 都可以被 2 整除：\n$$O(S_{\\mathrm{dis}}^{+}, S_{\\mathrm{drug}}^{-}) = \\frac{46 \\div 2}{150 \\div 2} = \\frac{23}{75}$$\n\n**重叠系数的解释性局限**\n\n从集合论的第一性原理来看，重叠系数衡量的是较小集合被包含在较大集合中的程度。在此背景下，它量化了药物下调的基因中，有多大比例存在于疾病上调的基因集合中。我们的结果 $O = \\frac{23}{75}$ 意味着，在药物特征 ($S_{\\mathrm{drug}}^{-}$) 的 150 个基因中，有 46 个成功地抵消了疾病特征 ($S_{\\mathrm{dis}}^{+}$) 中的基因。\n\n重叠系数的主要局限在于其不对称性以及对较大集合大小的不敏感性。通过与对称相似性度量（如 Jaccard 指数 $J(A, B)$）进行比较，可以理解这一点。Jaccard 指数定义为交集大小与并集大小的比率：\n$$J(A, B) = \\frac{|A \\cap B|}{|A \\cup B|}$$\n根据容斥原理，并集的大小为 $|A \\cup B| = |A| + |B| - |A \\cap B|$。对于给定的问题：\n$$|S_{\\mathrm{dis}}^{+} \\cup S_{\\mathrm{drug}}^{-}| = 200 + 150 - 46 = 304$$\nJaccard 指数将是：\n$$J(S_{\\mathrm{dis}}^{+}, S_{\\mathrm{drug}}^{-}) = \\frac{46}{304} = \\frac{23}{152}$$\n\n这些解释性局限源于每个系数的分母所代表的含义：\n1.  **重叠系数的分母：** 分母是 $\\min(|A|, |B|)$。该系数忽略了较大集合中不在交集内的元素数量。在我们的案例中，未被药物抵消的疾病上调基因数量为 $|S_{\\mathrm{dis}}^{+} \\setminus S_{\\mathrm{drug}}^{-}| = |S_{\\mathrm{dis}}^{+}| - |S_{\\mathrm{dis}}^{+} \\cap S_{\\mathrm{drug}}^{-}| = 200 - 46 = 154$。$\\frac{23}{75}$ 的重叠系数并未反映出大量未被处理的疾病基因。如果疾病特征要大得多，比如 $|S_{\\mathrm{dis}}^{+}| = 2000$，而所有其他值保持不变，重叠系数将仍然是 $\\frac{23}{75}$，这可能会误导性地表明该药物同样有效，而实际上它现在只处理了整体疾病病理中一个更小的部分。因此，重叠系数对于回答子集关系的问题（例如，“药物的作用机制是否完全包含在疾病的机制中？”）很有用，但它未能对逆转的不完全性进行惩罚。\n\n2.  **Jaccard 指数的分母：** 分母是 $|A \\cup B|$，即两个集合中所有独有元素的总数。它同时考虑了集合 $A$ 的独有元素 ($A \\setminus B$) 和集合 $B$ 的独有元素 ($B \\setminus A$)。这些集合分别代表了未被药物调节的疾病基因，以及与疾病特征无关的药物调节基因（潜在的“脱靶效应”）。Jaccard 指数对双向的差异都进行惩罚，提供了一个更平衡且通常更保守的整体相似性度量。一个低的 Jaccard 指数，比如我们计算出的 $\\frac{23}{152}$，正确地表明尽管相对于药物特征的大小有中等程度的重叠，但在考虑所涉及的基因总数时，这两个集合总体上是相当不相似的。\n\n总之，在该科学背景下，重叠系数的主要局限在于，即使当一种药物仅处理一个巨大疾病特征的一小部分时，它也可能产生高分，从而可能夸大药物的治疗相关性。像 Jaccard 指数这样的对称度量通过考虑共享和非共享元素的全部范围，为全局相似性提供了更稳健的评估。",
            "answer": "$$\\boxed{\\frac{23}{75}}$$"
        },
        {
            "introduction": "现代药物重定位方法利用机器学习来预测全新的药物-疾病关联。本练习将向您介绍矩阵分解，这是一种强大的技术，它能通过发现药物和疾病的潜在特征来“填补”已知的关联矩阵。通过推导交替最小二乘法（ALS）的更新规则并应用于一个实例，您将深入了解这种预测建模方法在药物发现中的应用。",
            "id": "4549794",
            "problem": "考虑一个计算药物重定位中的二元关联建模任务，其中药物与疾病之间的关联分数矩阵通过低秩潜在因子分解进行近似。设 $R \\in \\mathbb{R}^{m \\times n}$ 是一个部分观测的药物-疾病关联分数矩阵，其中有 $m$ 种药物和 $n$ 种疾病，并设 $\\Omega \\subset \\{1,\\dots,m\\} \\times \\{1,\\dots,n\\}$ 表示观测到的索引对集合。我们建立模型 $R \\approx U V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times k}$ 是药物的潜在因子， $V \\in \\mathbb{R}^{n \\times k}$ 是疾病的潜在因子，秩 $k$ 很小。在生物信息学和医学数据分析中，一种广泛用于推荐系统风格的矩阵补全方法是通过最小化观测条目上的正则化平方误差来拟合 $U$ 和 $V$，即目标函数为\n$$\nJ(U,V) = \\sum_{(i,j) \\in \\Omega} \\left(R_{ij} - \\langle u_i, v_j \\rangle \\right)^{2} + \\lambda \\left( \\|U\\|_{F}^{2} + \\|V\\|_{F}^{2} \\right),\n$$\n其中 $u_i \\in \\mathbb{R}^{k}$ 是 $U$ 的第 $i$ 行，$v_j \\in \\mathbb{R}^{k}$ 是 $V$ 的第 $j$ 行，$\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数，$\\lambda > 0$ 是一个正则化参数。交替最小二乘法 (ALS) 指的是通过交替固定 $V$ 并对 $U$ 进行最小化，以及固定 $U$ 并对 $V$ 进行最小化来最小化 $J(U,V)$。\n\n你的任务是：\n- 从上面 $J(U,V)$ 的定义出发，利用最小二乘法和 Tikhonov 正则化的基本原理，推导在固定 $V$ 时对每个 $u_i$ 的闭式正规方程更新，以及在固定 $U$ 时对每个 $v_j$ 的闭式正规方程更新。你的推导必须明确显示对观测条目 $\\Omega$ 的限制是如何体现在更新式中的。\n- 然后，对一个 $m = 2$，$n = 2$，$k = 2$ 的玩具案例，实例化一次 ALS 更新。观测到的关联分数为 $R_{1,1} = 2$, $R_{1,2} = 1$, $R_{2,1} = 1.5$, $R_{2,2} = 2.5$，所以 $\\Omega = \\{(1,1),(1,2),(2,1),(2,2)\\}$。假设当前的疾病因子为\n$$\nV = \\begin{pmatrix}\n0.9  0.1 \\\\\n0.3  0.7\n\\end{pmatrix},\n$$\n且正则化参数为 $\\lambda = 0.1$。使用你推导出的公式，在固定 $V$ 的情况下计算更新后的 $u_1$，并由此计算更新后的插补关联分数 $\\hat{R}_{1,2} = \\langle u_1, v_2 \\rangle$。\n\n将你计算出的 $\\hat{R}_{1,2}$ 的最终数值结果四舍五入到四位有效数字。你的答案应表示为一个不带单位的纯数字。",
            "solution": "该问题具有科学依据，是良定的，并包含了完整解答所需的所有信息。因此，该问题是有效的。\n\n该问题要求完成两项主要任务：首先，推导应用于正则化矩阵分解问题的交替最小二乘法 (ALS) 算法的更新规则；其次，将此规则应用于一个具体的数值示例。\n\n### 第一部分：ALS 更新规则的推导\n\n需要最小化的目标函数由下式给出：\n$$\nJ(U,V) = \\sum_{(i,j) \\in \\Omega} \\left(R_{ij} - \\langle u_i, v_j \\rangle \\right)^{2} + \\lambda \\left( \\|U\\|_{F}^{2} + \\|V\\|_{F}^{2} \\right)\n$$\n其中 $u_i \\in \\mathbb{R}^{k}$ 是 $U$ 的第 $i$ 行，$v_j \\in \\mathbb{R}^{k}$ 是 $V$ 的第 $j$ 行。弗罗贝尼乌斯范数可以用行向量展开：\n$$\n\\|U\\|_{F}^{2} = \\sum_{i=1}^{m} \\|u_i\\|_{2}^{2} = \\sum_{i=1}^{m} u_i^{\\top}u_i \\quad \\text{和} \\quad \\|V\\|_{F}^{2} = \\sum_{j=1}^{n} \\|v_j\\|_{2}^{2} = \\sum_{j=1}^{n} v_j^{\\top}v_j\n$$\nALS 算法通过在两个步骤之间交替来最小化 $J(U,V)$：固定 $V$ 求解 $U$，以及固定 $U$ 求解 $V$。\n\n**更新药物因子 $U$（固定 $V$）**\n\n当 $V$ 固定时，目标函数可以针对每个药物因子 $u_i$ 进行解耦，因为在目标函数中 $U$ 的各行是相互独立的。对于特定的药物 $i$，我们只需考虑 $J(U,V)$ 中涉及 $u_i$ 的项。设 $\\Omega_i = \\{j \\mid (i,j) \\in \\Omega\\}$ 为与药物 $i$ 有观测关联分数的疾病索引集。对于 $u_i$ 的子问题是最小化：\n$$\nJ(u_i) = \\sum_{j \\in \\Omega_i} \\left(R_{ij} - u_i^{\\top}v_j \\right)^{2} + \\lambda \\|u_i\\|_{2}^{2}\n$$\n这是一个标准的 Tikhonov 正则化最小二乘问题。为了找到最优的 $u_i$，我们计算 $J(u_i)$ 关于 $u_i$ 的梯度并将其设为零。\n$$\n\\nabla_{u_i} J(u_i) = \\nabla_{u_i} \\left( \\sum_{j \\in \\Omega_i} \\left(R_{ij} - u_i^{\\top}v_j \\right)^{2} + \\lambda u_i^{\\top}u_i \\right)\n$$\n使用向量导数的链式法则，$\\nabla_{\\mathbf{x}} (\\mathbf{a} - \\mathbf{x}^{\\top}\\mathbf{b})^2 = 2(\\mathbf{x}^{\\top}\\mathbf{b} - \\mathbf{a})\\mathbf{b}$ 和 $\\nabla_{\\mathbf{x}} (\\mathbf{x}^{\\top}\\mathbf{x}) = 2\\mathbf{x}$，我们得到：\n$$\n\\nabla_{u_i} J(u_i) = \\sum_{j \\in \\Omega_i} 2 \\left(u_i^{\\top}v_j - R_{ij} \\right) v_j + 2\\lambda u_i\n$$\n将梯度设为零：\n$$\n\\sum_{j \\in \\Omega_i} \\left(u_i^{\\top}v_j - R_{ij} \\right) v_j + \\lambda u_i = \\mathbf{0}\n$$\n$$\n\\sum_{j \\in \\Omega_i} (v_j v_j^{\\top}) u_i - \\sum_{j \\in \\Omega_i} R_{ij} v_j + \\lambda u_i = \\mathbf{0}\n$$\n重新整理各项以求解 $u_i$：\n$$\n\\left( \\sum_{j \\in \\Omega_i} v_j v_j^{\\top} \\right) u_i + \\lambda I_k u_i = \\sum_{j \\in \\Omega_i} R_{ij} v_j\n$$\n其中 $I_k$ 是 $k \\times k$ 单位矩阵。提出因子 $u_i$：\n$$\n\\left( \\left(\\sum_{j \\in \\Omega_i} v_j v_j^{\\top}\\right) + \\lambda I_k \\right) u_i = \\sum_{j \\in \\Omega_i} R_{ij} v_j\n$$\n这给出了 $u_i$ 的闭式正规方程更新：\n$$\nu_i \\leftarrow \\left( \\sum_{j \\in \\Omega_i} v_j v_j^{\\top} + \\lambda I_k \\right)^{-1} \\left( \\sum_{j \\in \\Omega_i} R_{ij} v_j \\right)\n$$\n对观测条目 $\\Omega$ 的限制通过对索引集 $\\Omega_i$ 的求和明确地体现出来。\n\n**更新疾病因子 $V$（固定 $U$）**\n\n在固定 $U$ 的情况下更新疾病因子 $v_j$ 的推导是对称的。设 $\\Omega_j = \\{i \\mid (i,j) \\in \\Omega\\}$ 为与疾病 $j$ 有观测关联分数的药物索引集。对于 $v_j$ 的子问题是最小化：\n$$\nJ(v_j) = \\sum_{i \\in \\Omega_j} \\left(R_{ij} - u_i^{\\top}v_j \\right)^{2} + \\lambda \\|v_j\\|_{2}^{2}\n$$\n遵循相同的步骤，我们得到 $v_j$ 的对称更新规则：\n$$\nv_j \\leftarrow \\left( \\sum_{i \\in \\Omega_j} u_i u_i^{\\top} + \\lambda I_k \\right)^{-1} \\left( \\sum_{i \\in \\Omega_j} R_{ij} u_i \\right)\n$$\n\n### 第二部分：玩具案例的实例化\n\n对于一个玩具案例，我们有以下参数：\n$m = 2$，$n = 2$，$k = 2$。\n关联矩阵是完全观测的，$R_{1,1} = 2$, $R_{1,2} = 1$, $R_{2,1} = 1.5$, $R_{2,2} = 2.5$。\n因此，$\\Omega = \\{(1,1), (1,2), (2,1), (2,2)\\}$。\n当前的疾病因子为 $V = \\begin{pmatrix} 0.9  0.1 \\\\ 0.3  0.7 \\end{pmatrix}$，所以 $v_1 = \\begin{pmatrix} 0.9 \\\\ 0.1 \\end{pmatrix}$ 且 $v_2 = \\begin{pmatrix} 0.3 \\\\ 0.7 \\end{pmatrix}$。\n正则化参数为 $\\lambda = 0.1$。\n\n我们需要计算更新后的药物因子 $u_1$。对于 $i=1$，观测到的疾病索引集为 $\\Omega_1 = \\{1, 2\\}$。\n使用推导出的公式：\n$$\nu_1 = \\left( v_1 v_1^{\\top} + v_2 v_2^{\\top} + \\lambda I_2 \\right)^{-1} \\left( R_{11} v_1 + R_{12} v_2 \\right)\n$$\n首先，我们计算待求逆的矩阵，称之为 $A$：\n$$\nA = v_1 v_1^{\\top} + v_2 v_2^{\\top} + \\lambda I_2\n$$\n$v_1 v_1^{\\top} = \\begin{pmatrix} 0.9 \\\\ 0.1 \\end{pmatrix} \\begin{pmatrix} 0.9  0.1 \\end{pmatrix} = \\begin{pmatrix} 0.81  0.09 \\\\ 0.09  0.01 \\end{pmatrix}$\n$v_2 v_2^{\\top} = \\begin{pmatrix} 0.3 \\\\ 0.7 \\end{pmatrix} \\begin{pmatrix} 0.3  0.7 \\end{pmatrix} = \\begin{pmatrix} 0.09  0.21 \\\\ 0.21  0.49 \\end{pmatrix}$\n$\\lambda I_2 = 0.1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.1  0 \\\\ 0  0.1 \\end{pmatrix}$\n$$\nA = \\begin{pmatrix} 0.81  0.09 \\\\ 0.09  0.01 \\end{pmatrix} + \\begin{pmatrix} 0.09  0.21 \\\\ 0.21  0.49 \\end{pmatrix} + \\begin{pmatrix} 0.1  0 \\\\ 0  0.1 \\end{pmatrix} = \\begin{pmatrix} 0.81+0.09+0.1  0.09+0.21+0 \\\\ 0.09+0.21+0  0.01+0.49+0.1 \\end{pmatrix} = \\begin{pmatrix} 1.0  0.3 \\\\ 0.3  0.6 \\end{pmatrix}\n$$\n现在我们求 $A^{-1}$ 的逆。行列式为 $\\det(A) = (1.0)(0.6) - (0.3)(0.3) = 0.6 - 0.09 = 0.51$。\n$$\nA^{-1} = \\frac{1}{0.51} \\begin{pmatrix} 0.6  -0.3 \\\\ -0.3  1.0 \\end{pmatrix}\n$$\n接下来，我们计算向量项，称之为 $b$：\n$$\nb = R_{11} v_1 + R_{12} v_2 = 2 \\begin{pmatrix} 0.9 \\\\ 0.1 \\end{pmatrix} + 1 \\begin{pmatrix} 0.3 \\\\ 0.7 \\end{pmatrix} = \\begin{pmatrix} 1.8 \\\\ 0.2 \\end{pmatrix} + \\begin{pmatrix} 0.3 \\\\ 0.7 \\end{pmatrix} = \\begin{pmatrix} 2.1 \\\\ 0.9 \\end{pmatrix}\n$$\n现在我们计算更新后的 $u_1 = A^{-1}b$：\n$$\nu_1 = \\frac{1}{0.51} \\begin{pmatrix} 0.6  -0.3 \\\\ -0.3  1.0 \\end{pmatrix} \\begin{pmatrix} 2.1 \\\\ 0.9 \\end{pmatrix} = \\frac{1}{0.51} \\begin{pmatrix} (0.6)(2.1) - (0.3)(0.9) \\\\ (-0.3)(2.1) + (1.0)(0.9) \\end{pmatrix}\n$$\n$$\nu_1 = \\frac{1}{0.51} \\begin{pmatrix} 1.26 - 0.27 \\\\ -0.63 + 0.90 \\end{pmatrix} = \\frac{1}{0.51} \\begin{pmatrix} 0.99 \\\\ 0.27 \\end{pmatrix} = \\begin{pmatrix} 0.99 / 0.51 \\\\ 0.27 / 0.51 \\end{pmatrix} = \\begin{pmatrix} 99/51 \\\\ 27/51 \\end{pmatrix} = \\begin{pmatrix} 33/17 \\\\ 9/17 \\end{pmatrix}\n$$\n所以更新后的药物因子为 $u_1 = \\begin{pmatrix} 33/17 \\\\ 9/17 \\end{pmatrix}$。\n\n最后，我们计算更新后的插补关联分数 $\\hat{R}_{1,2} = \\langle u_1, v_2 \\rangle = u_1^{\\top}v_2$：\n$$\n\\hat{R}_{1,2} = \\begin{pmatrix} 33/17  9/17 \\end{pmatrix} \\begin{pmatrix} 0.3 \\\\ 0.7 \\end{pmatrix} = \\left(\\frac{33}{17}\\right)(0.3) + \\left(\\frac{9}{17}\\right)(0.7)\n$$\n$$\n\\hat{R}_{1,2} = \\frac{ (33 \\times 0.3) + (9 \\times 0.7) }{17} = \\frac{9.9 + 6.3}{17} = \\frac{16.2}{17}\n$$\n其分数形式为 $\\frac{162}{170} = \\frac{81}{85}$。\n作为小数，其值为：\n$$\n\\hat{R}_{1,2} = \\frac{81}{85} \\approx 0.952941176...\n$$\n四舍五入到四位有效数字，我们得到 $0.9529$。",
            "answer": "$$\\boxed{0.9529}$$"
        }
    ]
}