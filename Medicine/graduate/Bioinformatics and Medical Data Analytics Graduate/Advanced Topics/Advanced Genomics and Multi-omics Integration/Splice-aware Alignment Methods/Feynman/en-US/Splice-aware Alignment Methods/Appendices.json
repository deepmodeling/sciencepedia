{
    "hands_on_practices": [
        {
            "introduction": "At the heart of any splice-aware alignment algorithm is an optimization problem: finding the alignment that best explains a given RNA-seq read according to a scoring model. This fundamental exercise  delves into the core decision-making logic of an aligner by comparing two competing hypotheses for a read's origin. By manually calculating and comparing the scores for a contiguous alignment with a deletion versus a spliced alignment, you will gain direct insight into the trade-offs governed by affine gap penalties and intron penalties, making the abstract process of alignment tangible and clear.",
            "id": "4609252",
            "problem": "In splice-aware alignment of ribonucleic acid sequencing (RNA-seq) reads to a reference genome, the objective is to select a mapping that optimizes an additive alignment score derived from a probabilistic model of sequence evolution and sequencing error. A standard and well-tested scoring framework uses an affine gap penalty to model insertions or deletions and a distinct intron penalty to model splice junctions. In this framework, each matched base contributes a match score, and structural events contribute fixed penalties:\n\n- A matched base contributes $c_{M}$ to the alignment score per base.\n- A gap (insertion or deletion) of length $l$ contributes a total penalty $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$, representing one gap opening event and $l$ gap extension steps.\n- A splice junction contributes a single intron penalty $c_{I}$, independent of intron length in this simplified model.\n\nConsider a single $150$ base-pair read with two candidate genomic mappings:\n\n1. Candidate A is a contiguous genomic alignment that contains a single deletion of length $10$ in the read-to-reference alignment, with $140$ matched bases and no mismatches.\n2. Candidate B is a spliced alignment in which the read is split into two segments of $75$ bases each that map to two exons across one intron, yielding $150$ matched bases and one splice junction, with no mismatches and no genomic gaps within exons.\n\nAssume the following scoring constants: $c_{M} = -2$, $c_{\\text{gap\\_open}} = -5$, $c_{\\text{gap\\_extend}} = -1$, and $c_{I} = -20$. Define the alignment score of each candidate as the sum of all applicable contributions described above. Compute the alignment score difference $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$, where $S_{\\text{splice}}$ is the score of Candidate B and $S_{\\text{deletion}}$ is the score of Candidate A. Provide your final answer as a single real number. No rounding is needed.",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- **Read length**: $150$ base-pairs (bp).\n- **Match score per base**: $c_{M} = -2$.\n- **Affine gap penalty for a gap of length $l$**: The total contribution is $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$.\n- **Gap opening penalty**: $c_{\\text{gap\\_open}} = -5$.\n- **Gap extension penalty**: $c_{\\text{gap\\_extend}} = -1$.\n- **Intron penalty per splice junction**: $c_{I} = -20$.\n- **Candidate A (deletion alignment)**: A contiguous alignment with $140$ matched bases and a single deletion of length $l=10$.\n- **Candidate B (spliced alignment)**: A spliced alignment with two segments of $75$ bases each, resulting in $150$ matched bases and one splice junction.\n- **Objective**: Compute the alignment score difference $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$, where $S_{\\text{splice}}$ is the score of Candidate B and $S_{\\text{deletion}}$ is the score of Candidate A.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes a simplified but standard and scientifically grounded model for scoring RNA-seq alignments. The use of an affine gap penalty and a specific intron penalty is a common practice in splice-aware alignment algorithms. The provided parameters and alignment scenarios are clearly defined, self-consistent, and objective. The read length of $150$ bp is consistent with the details of both candidates (Candidate A: $140$ matches + $10$ deleted bases from the reference account for $150$ bases of the read; Candidate B: $75+75 = 150$ matched bases). The problem is well-posed, as it contains all necessary information to compute a unique, meaningful numerical solution. The problem does not violate any scientific principles, is not ambiguous, and is directly solvable.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\n**Derivation of Solution**\nThe alignment score, $S$, is calculated as the sum of contributions from all alignment features (matches, gaps, and introns).\n\nFirst, we calculate the score for Candidate A, the contiguous alignment with a deletion, denoted as $S_{\\text{deletion}}$.\nCandidate A has $140$ matched bases. The total contribution from matches is the number of matches multiplied by the match score per base, $c_{M}$.\nContribution from matches = $140 \\cdot c_{M}$.\nCandidate A has a single deletion of length $l=10$. This constitutes one gap opening event and $10$ gap extension steps. The total penalty contribution from this gap is given by the affine gap penalty formula: $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$ with $l=10$.\nContribution from gap = $c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}}$.\nThere are no splice junctions in Candidate A.\nThe total score for Candidate A is the sum of these contributions:\n$$S_{\\text{deletion}} = 140 \\cdot c_{M} + (c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}})$$\nSubstituting the given values:\n$$S_{\\text{deletion}} = 140 \\cdot (-2) + (-5 + 10 \\cdot (-1))$$\n$$S_{\\text{deletion}} = -280 + (-5 - 10)$$\n$$S_{\\text{deletion}} = -280 - 15 = -295$$\n\nNext, we calculate the score for Candidate B, the spliced alignment, denoted as $S_{\\text{splice}}$.\nCandidate B has $150$ matched bases. The contribution from matches is:\nContribution from matches = $150 \\cdot c_{M}$.\nCandidate B has one splice junction, which contributes the intron penalty, $c_{I}$.\nContribution from intron = $c_{I}$.\nThere are no gaps within the exons for Candidate B.\nThe total score for Candidate B is the sum of these contributions:\n$$S_{\\text{splice}} = 150 \\cdot c_{M} + c_{I}$$\nSubstituting the given values:\n$$S_{\\text{splice}} = 150 \\cdot (-2) + (-20)$$\n$$S_{\\text{splice}} = -300 - 20$$\n$$S_{\\text{splice}} = -320$$\n\nFinally, we compute the requested alignment score difference, $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$.\n$$\\Delta S = (-320) - (-295)$$\n$$\\Delta S = -320 + 295$$\n$$\\Delta S = -25$$\n\nThe difference in alignment scores is $-25$. This indicates that, according to the specified scoring model, the alignment with the deletion (Candidate A) is preferred over the spliced alignment (Candidate B) as it has a higher (less negative) score.",
            "answer": "$$\\boxed{-25}$$"
        },
        {
            "introduction": "Simply identifying the highest-scoring alignment is not enough; we must also quantify our confidence in that choice, as a second-best alignment with a nearly identical score implies high mapping ambiguity. This problem  illustrates how aligners translate alignment scores into a probabilistic measure of confidence using a Bayesian framework. By calculating the Mapping Quality (MAPQ) score from alignment likelihoods and prior probabilities, you will understand how this essential quality metric is derived and how it incorporates prior biological knowledge, such as the prevalence of canonical splice sites.",
            "id": "4609207",
            "problem": "An RNA sequencing (RNA-seq) read spans a putative splice junction and is evaluated by a splice-aware aligner that uses a Hidden Markov Model (HMM) to score spliced alignments. The aligner considers two mutually exclusive candidate hypotheses for the read’s origin: $H_{A}$, a canonical donor–acceptor splice (`GT`–`AG`) consistent with the gene’s known annotation track, and $H_{B}$, a non-canonical donor–acceptor splice (`GC`–`AG`) not present in the annotation. The HMM likelihoods for the observed bases and gap structure are equal for both hypotheses, that is $P(D \\mid H_{A}) = P(D \\mid H_{B})$, where $D$ denotes the observed read sequence and its alignment features. Prior usage of canonical splice sites in this locus is supported by population-level junction counts, resulting in priors $P(H_{A}) = 0.9$ and $P(H_{B}) = 0.1$. Using Bayes’ rule and the definition that the Mapping Quality (MAPQ) is the Phred-scale (PHRED) transformation of the probability that the reported best alignment is incorrect, compute the $MAPQ$ for reporting $H_{A}$ as the best alignment.\n\nYou may assume:\n- $P(H_{A} \\mid D) = \\dfrac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}$ and similarly for $H_{B}$.\n- The error probability for the reported best alignment is $p_{\\mathrm{error}} = 1 - P_{\\mathrm{best}}$, where $P_{\\mathrm{best}}$ is the posterior probability of the chosen best hypothesis.\n- The Phred-scale transform is $Q = -10 \\log_{10}(p)$ for a probability $p$.\n\nExpress the final value of $MAPQ$ as an exact integer with no rounding.",
            "solution": "The splice-aware aligner produces two hypotheses, $H_{A}$ and $H_{B}$, with equal likelihoods under the Hidden Markov Model, so $P(D \\mid H_{A}) = P(D \\mid H_{B})$. The priors are $P(H_{A}) = 0.9$ and $P(H_{B}) = 0.1$. By Bayes’ rule,\n$$\nP(H_{A} \\mid D) = \\frac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}.\n$$\nBecause $P(D \\mid H_{A}) = P(D \\mid H_{B})$, denote this common likelihood by $L$; then\n$$\nP(H_{A} \\mid D) = \\frac{L \\cdot 0.9}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.9}{0.9 + 0.1} = 0.9,\n$$\nand similarly,\n$$\nP(H_{B} \\mid D) = \\frac{L \\cdot 0.1}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.1}{1.0} = 0.1.\n$$\nThe best alignment to report is $H_{A}$, with posterior $P_{\\mathrm{best}} = P(H_{A} \\mid D) = 0.9$. The error probability for the reported best alignment is the probability that the reported alignment is wrong, namely\n$$\np_{\\mathrm{error}} = 1 - P_{\\mathrm{best}} = 1 - 0.9 = 0.1.\n$$\nThe Mapping Quality (MAPQ) is the Phred-scale transformation of this error probability:\n$$\nMAPQ = -10 \\log_{10}(p_{\\mathrm{error}}) = -10 \\log_{10}(0.1).\n$$\nUsing the identity $\\log_{10}(0.1) = \\log_{10}(10^{-1}) = -1$, we obtain\n$$\nMAPQ = -10 \\cdot (-1) = 10.\n$$\nThis is already an exact integer, so no rounding is needed.",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "After aligning millions of reads, the focus shifts from individual alignment confidence to the overall performance of the aligner across the entire dataset. To benchmark and compare different tools, we need standardized, quantitative metrics. This practice  introduces the fundamental concepts of precision and sensitivity (recall) in the context of splice junction detection. You will learn to compute the $F_1$ score, the harmonic mean of these two metrics, which provides a single, balanced measure of an aligner's accuracy and is a cornerstone of bioinformatics performance evaluation.",
            "id": "4609249",
            "problem": "A splice-aware read aligner is evaluated for exon–exon junction detection on simulated RNA sequencing (RNA-seq) data where the ground-truth splice junctions are known from an annotation. Suppose the evaluation is conducted at the junction level, where a predicted junction is considered correct only if both donor and acceptor sites match the annotation exactly. Let precision and sensitivity (recall) be defined by the standard confusion-count ratios, namely precision $P = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FP}}$ and sensitivity $R = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$, where $\\mathrm{TP}$, $\\mathrm{FP}$, and $\\mathrm{FN}$ denote true positives, false positives, and false negatives, respectively. You are told that this aligner yields sensitivity $R = 0.85$ and precision $P = 0.90$ at the junction level on this benchmark.\n\nStarting from the mathematical definition of the harmonic mean of two positive real numbers as the reciprocal of the arithmetic mean of their reciprocals, derive a closed-form expression for the balanced summary statistic $F_{1}$ that equally weights precision and sensitivity as the harmonic mean of $P$ and $R$, and then evaluate it for $P = 0.90$ and $R = 0.85$. Report the $F_{1}$ score as a dimensionless quantity. Round your final numerical answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n- The context is the evaluation of a splice-aware read aligner for exon-exon junction detection.\n- A predicted junction is correct if both donor and acceptor sites match the annotation.\n- Precision is defined as $P = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FP}}$.\n- Sensitivity (Recall) is defined as $R = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$.\n- True positives, false positives, and false negatives are denoted by $\\mathrm{TP}$, $\\mathrm{FP}$, and $\\mathrm{FN}$, respectively.\n- The aligner's performance metrics are given as $R = 0.85$ and $P = 0.90$.\n- The harmonic mean of two positive real numbers is defined as the reciprocal of the arithmetic mean of their reciprocals.\n- The $F_{1}$ score is defined as the harmonic mean of $P$ and $R$.\n- The task is to derive a closed-form expression for the $F_{1}$ score and then evaluate it for the given values of $P$ and $R$.\n- The final numerical answer must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is assessed for validity:\n- **Scientifically Grounded**: The problem is grounded in the standard principles of bioinformatics and performance evaluation in machine learning. The definitions of precision ($P$), sensitivity ($R$), and the $F_{1}$ score are standard and correctly stated. The context of RNA-seq data analysis and splice junction detection is a well-established area of genomics research.\n- **Well-Posed**: The problem is well-posed. It provides all necessary definitions and numerical values to derive the requested expression and compute the final value. The tasks are clearly stated and lead to a unique, stable solution.\n- **Objective**: The problem is expressed in objective, precise language. The terms used are standard and unambiguous in the field. The provided values $P=0.90$ and $R=0.85$ are realistic for modern alignment tools.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically sound, well-posed, and all necessary information for its solution is provided. I will now proceed with the derivation and calculation.\n\nThe problem requires the derivation of the $F_1$ score, defined as the harmonic mean of precision, $P$, and sensitivity, $R$. The definition of the harmonic mean, $H$, of two positive real numbers, $x$ and $y$, is the reciprocal of the arithmetic mean of their reciprocals.\n\nLet us formalize this definition. The reciprocals of $x$ and $y$ are $\\frac{1}{x}$ and $\\frac{1}{y}$.\nThe arithmetic mean of these reciprocals is:\n$$ \\text{Mean of reciprocals} = \\frac{\\frac{1}{x} + \\frac{1}{y}}{2} $$\nThe harmonic mean is the reciprocal of this quantity:\n$$ H(x, y) = \\frac{1}{\\frac{\\frac{1}{x} + \\frac{1}{y}}{2}} $$\nThis can be simplified:\n$$ H(x, y) = \\frac{2}{\\frac{1}{x} + \\frac{1}{y}} $$\nTo combine the fractions in the denominator, we find a common denominator, which is $xy$:\n$$ \\frac{1}{x} + \\frac{1}{y} = \\frac{y}{xy} + \\frac{x}{xy} = \\frac{x+y}{xy} $$\nSubstituting this back into the expression for $H(x, y)$:\n$$ H(x, y) = \\frac{2}{\\frac{x+y}{xy}} $$\nSimplifying the complex fraction yields the standard closed-form expression for the harmonic mean of two numbers:\n$$ H(x, y) = \\frac{2xy}{x+y} $$\nThe problem defines the $F_1$ score as the harmonic mean of precision, $P$, and sensitivity, $R$. Therefore, we substitute $x=P$ and $y=R$ into the derived expression:\n$$ F_1 = \\frac{2PR}{P+R} $$\nThis is the required closed-form expression for the $F_1$ score.\n\nThe next step is to evaluate this expression for the given values: $P = 0.90$ and $R = 0.85$.\nSubstituting these values into the formula:\n$$ F_1 = \\frac{2 \\times 0.90 \\times 0.85}{0.90 + 0.85} $$\nFirst, we compute the numerator and the denominator separately.\nThe numerator is:\n$$ 2 \\times 0.90 \\times 0.85 = 1.80 \\times 0.85 = 1.53 $$\nThe denominator is:\n$$ 0.90 + 0.85 = 1.75 $$\nNow, we compute the value of the fraction:\n$$ F_1 = \\frac{1.53}{1.75} $$\nTo facilitate calculation, we can express this as a fraction of integers:\n$$ F_1 = \\frac{153}{175} $$\nPerforming the division gives:\n$$ F_1 = 0.874285714... $$\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures are $8$, $7$, $4$, and $2$. The fifth significant figure is $8$, which is greater than or equal to $5$, so we must round up the fourth significant figure.\n$$ F_1 \\approx 0.8743 $$\nThis is the final numerical value for the $F_1$ score.",
            "answer": "$$\\boxed{0.8743}$$"
        }
    ]
}