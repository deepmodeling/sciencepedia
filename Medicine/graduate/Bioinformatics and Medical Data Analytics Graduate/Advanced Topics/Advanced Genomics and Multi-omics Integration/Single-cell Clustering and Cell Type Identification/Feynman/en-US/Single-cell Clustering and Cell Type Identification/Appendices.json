{
    "hands_on_practices": [
        {
            "introduction": "After performing clustering, a critical first step is to assess the quality of the resulting partitions. The silhouette score provides an intuitive internal validation metric, meaning it requires no external labels to gauge performance. This practice  will guide you through calculating silhouette coefficients by hand, building a concrete understanding of how this score quantifies both the compactness of clusters (cohesion) and their separation from one another.",
            "id": "4607428",
            "problem": "A single-cell ribonucleic acid sequencing (scRNA-seq) study of peripheral blood mononuclear cells yields a low-dimensional embedding along the first principal component obtained by principal component analysis (PCA). Five cells have the following one-dimensional coordinates (in arbitrary normalized units) and a proposed two-cluster partition thought to correspond to two lymphocyte lineages:\n\n- Cell $S_{1}$ at $x = 0$, Cell $S_{2}$ at $x = 1$, Cell $S_{3}$ at $x = 3$ assigned to Cluster $\\mathcal{A}$ (putative T cells).\n- Cell $S_{4}$ at $x = 10$, Cell $S_{5}$ at $x = 12$ assigned to Cluster $\\mathcal{B}$ (putative B cells).\n\nAssume the dissimilarity between any two cells is the Euclidean distance in this one-dimensional embedding (that is, the absolute difference of their coordinates). Using the standard definition of the silhouette in cluster analysis, compute the silhouette coefficient for each cell under this partition, and then compute the overall average silhouette across all five cells. Interpret, in terms of separation and compactness, what the obtained silhouette values imply about this partition in the context of cell type identification.\n\nProvide the final overall average silhouette as a single simplified fraction. Do not round. No units are required for the final answer.",
            "solution": "The problem is valid as it is a well-defined, self-contained, and scientifically grounded problem in cluster analysis, a standard technique in bioinformatics. All necessary data and definitions are provided to compute a unique solution.\n\nThe silhouette coefficient for a single data point $i$ is defined by the formula:\n$$ s(i) = \\frac{b(i) - a(i)}{\\max\\{a(i), b(i)\\}} $$\nwhere $a(i)$ is the mean intra-cluster dissimilarity for point $i$, and $b(i)$ is the mean nearest-cluster dissimilarity for point $i$. The dissimilarity is given as the one-dimensional Euclidean distance, $d(S_i, S_j) = |x_i - x_j|$.\n\nThe provided data points and cluster assignments are:\nCluster $\\mathcal{A}$: Cell $S_1$ at $x_1=0$, Cell $S_2$ at $x_2=1$, Cell $S_3$ at $x_3=3$.\nCluster $\\mathcal{B}$: Cell $S_4$ at $x_4=10$, Cell $S_5$ at $x_5=12$.\n\nWe proceed to calculate the silhouette coefficient for each of the $5$ cells.\n\nFor Cell $S_1$ at $x_1=0$ in Cluster $\\mathcal{A}$:\nThe intra-cluster dissimilarity, $a(1)$, is the average distance to other cells in $\\mathcal{A}$ ($S_2, S_3$):\n$$ a(1) = \\frac{d(S_1, S_2) + d(S_1, S_3)}{2} = \\frac{|0-1| + |0-3|}{2} = \\frac{1+3}{2} = 2 $$\nThe nearest-cluster dissimilarity, $b(1)$, is the average distance to cells in Cluster $\\mathcal{B}$ ($S_4, S_5$):\n$$ b(1) = \\frac{d(S_1, S_4) + d(S_1, S_5)}{2} = \\frac{|0-10| + |0-12|}{2} = \\frac{10+12}{2} = 11 $$\nThe silhouette coefficient for $S_1$ is:\n$$ s(1) = \\frac{b(1) - a(1)}{\\max\\{a(1), b(1)\\}} = \\frac{11-2}{\\max\\{2, 11\\}} = \\frac{9}{11} $$\n\nFor Cell $S_2$ at $x_2=1$ in Cluster $\\mathcal{A}$:\n$$ a(2) = \\frac{d(S_2, S_1) + d(S_2, S_3)}{2} = \\frac{|1-0| + |1-3|}{2} = \\frac{1+2}{2} = \\frac{3}{2} $$\n$$ b(2) = \\frac{d(S_2, S_4) + d(S_2, S_5)}{2} = \\frac{|1-10| + |1-12|}{2} = \\frac{9+11}{2} = 10 $$\n$$ s(2) = \\frac{b(2) - a(2)}{\\max\\{a(2), b(2)\\}} = \\frac{10 - \\frac{3}{2}}{\\max\\{\\frac{3}{2}, 10\\}} = \\frac{\\frac{17}{2}}{10} = \\frac{17}{20} $$\n\nFor Cell $S_3$ at $x_3=3$ in Cluster $\\mathcal{A}$:\n$$ a(3) = \\frac{d(S_3, S_1) + d(S_3, S_2)}{2} = \\frac{|3-0| + |3-1|}{2} = \\frac{3+2}{2} = \\frac{5}{2} $$\n$$ b(3) = \\frac{d(S_3, S_4) + d(S_3, S_5)}{2} = \\frac{|3-10| + |3-12|}{2} = \\frac{7+9}{2} = 8 $$\n$$ s(3) = \\frac{b(3) - a(3)}{\\max\\{a(3), b(3)\\}} = \\frac{8 - \\frac{5}{2}}{\\max\\{\\frac{5}{2}, 8\\}} = \\frac{\\frac{11}{2}}{8} = \\frac{11}{16} $$\n\nFor Cell $S_4$ at $x_4=10$ in Cluster $\\mathcal{B}$:\nThe size of its own cluster is $2$, so $a(4)$ is the average distance to the $1$ other cell in $\\mathcal{B}$ ($S_5$):\n$$ a(4) = \\frac{d(S_4, S_5)}{1} = |10-12| = 2 $$\nThe nearest-cluster dissimilarity, $b(4)$, is the average distance to cells in Cluster $\\mathcal{A}$ ($S_1, S_2, S_3$):\n$$ b(4) = \\frac{d(S_4, S_1) + d(S_4, S_2) + d(S_4, S_3)}{3} = \\frac{|10-0| + |10-1| + |10-3|}{3} = \\frac{10+9+7}{3} = \\frac{26}{3} $$\n$$ s(4) = \\frac{b(4) - a(4)}{\\max\\{a(4), b(4)\\}} = \\frac{\\frac{26}{3} - 2}{\\max\\{2, \\frac{26}{3}\\}} = \\frac{\\frac{20}{3}}{\\frac{26}{3}} = \\frac{20}{26} = \\frac{10}{13} $$\n\nFor Cell $S_5$ at $x_5=12$ in Cluster $\\mathcal{B}$:\n$$ a(5) = \\frac{d(S_5, S_4)}{1} = |12-10| = 2 $$\n$$ b(5) = \\frac{d(S_5, S_1) + d(S_5, S_2) + d(S_5, S_3)}{3} = \\frac{|12-0| + |12-1| + |12-3|}{3} = \\frac{12+11+9}{3} = \\frac{32}{3} $$\n$$ s(5) = \\frac{b(5) - a(5)}{\\max\\{a(5), b(5)\\}} = \\frac{\\frac{32}{3} - 2}{\\max\\{2, \\frac{32}{3}\\}} = \\frac{\\frac{26}{3}}{\\frac{32}{3}} = \\frac{26}{32} = \\frac{13}{16} $$\n\nNext, we compute the overall average silhouette, $\\bar{s}$, across all $5$ cells.\n$$ \\bar{s} = \\frac{1}{5} \\sum_{i=1}^{5} s(i) = \\frac{1}{5} \\left( \\frac{9}{11} + \\frac{17}{20} + \\frac{11}{16} + \\frac{10}{13} + \\frac{13}{16} \\right) $$\nCombining terms with the same denominator:\n$$ \\bar{s} = \\frac{1}{5} \\left( \\frac{9}{11} + \\frac{17}{20} + \\frac{10}{13} + \\frac{11+13}{16} \\right) = \\frac{1}{5} \\left( \\frac{9}{11} + \\frac{17}{20} + \\frac{10}{13} + \\frac{24}{16} \\right) = \\frac{1}{5} \\left( \\frac{9}{11} + \\frac{17}{20} + \\frac{10}{13} + \\frac{3}{2} \\right) $$\nThe least common multiple of the denominators $11$, $20$, $13$, and $2$ is $lcm(11, 20, 13, 2) = 2860$. We express each fraction with this common denominator:\n$$ \\bar{s} = \\frac{1}{5} \\left( \\frac{9 \\times 260}{2860} + \\frac{17 \\times 143}{2860} + \\frac{10 \\times 220}{2860} + \\frac{3 \\times 1430}{2860} \\right) $$\n$$ \\bar{s} = \\frac{1}{5} \\left( \\frac{2340}{2860} + \\frac{2431}{2860} + \\frac{2200}{2860} + \\frac{4290}{2860} \\right) $$\n$$ \\bar{s} = \\frac{1}{5} \\left( \\frac{2340 + 2431 + 2200 + 4290}{2860} \\right) = \\frac{1}{5} \\left( \\frac{11261}{2860} \\right) $$\n$$ \\bar{s} = \\frac{11261}{14300} $$\n\nInterpretation of the results:\nThe individual silhouette coefficients are $s(1) = 9/11 \\approx 0.818$, $s(2) = 17/20 = 0.85$, $s(3) = 11/16 = 0.6875$, $s(4) = 10/13 \\approx 0.769$, and $s(5) = 13/16 = 0.8125$. All these values are significantly greater than $0$ and approach $1$, which indicates that each cell is much closer on average to cells in its own cluster than to cells in the other cluster. The overall average silhouette score of $\\bar{s} = 11261/14300 \\approx 0.787$ is high, signifying that the clustering partition is of high quality. In this context, it implies that the clusters are both compact (low intra-cluster distances, reflected in the $a(i)$ values) and well-separated (high inter-cluster distances, reflected in the $b(i)$ values). This provides strong quantitative evidence supporting the hypothesis that the two clusters indeed correspond to distinct and well-resolved cell types.",
            "answer": "$$\\boxed{\\frac{11261}{14300}}$$"
        },
        {
            "introduction": "When ground-truth cell type labels are available, we can use external validation metrics to assess clustering performance. While a simple agreement score like the Rand Index can be useful, it fails to account for agreement that occurs purely by chance. This exercise  delves into the Adjusted Rand Index (ARI), a more robust metric that normalizes the index based on the agreement expected under a random model, providing a foundation for rigorously comparing clustering results to known biology.",
            "id": "4607379",
            "problem": "A single-cell ribonucleic acid sequencing (scRNA-seq) experiment yields $N$ cells with ground-truth cell-type labels and clustering assignments from an unsupervised algorithm. Let the contingency counts be $a_{ij}$, the number of cells that are in ground-truth class $i$ and assigned to cluster $j$, with row sums $n_{i} = \\sum_{j} a_{ij}$, column sums $m_{j} = \\sum_{i} a_{ij}$, and total $N = \\sum_{i,j} a_{ij}$. The classical Rand index counts agreeing pairs of cells (both in the same class and same cluster, or both in different classes and different clusters). The adjusted Rand index (ARI) corrects the Rand index for the agreement expected by chance under a null model that fixes $\\{n_{i}\\}$ and $\\{m_{j}\\}$ but randomizes the association between labels and clusters.\n\nStarting from the pair-counting definition of the Rand index and basic combinatorics for unordered pairs $\\binom{x}{2}$, derive an expression for the adjusted Rand index in terms of $a_{ij}$, $n_{i}$, $m_{j}$, and $N$ by:\n- Expressing the observed number of cell pairs that are simultaneously in the same ground-truth class and the same cluster in terms of $\\{a_{ij}\\}$.\n- Using linearity of expectation and an independence-by-construction null model to derive the expected number of such agreeing pairs given fixed $\\{n_{i}\\}$ and $\\{m_{j}\\}$.\n- Normalizing the centered index by the maximum possible value under the fixed marginals to obtain a dimensionless index in $[-1,1]$.\n\nThen, for a scRNA-seq dataset with $3$ ground-truth cell types and $3$ clusters, the nonzero contingency counts are:\n- $a_{11} = 8$, $a_{12} = 1$, $a_{13} = 1$,\n- $a_{21} = 2$, $a_{22} = 9$, $a_{23} = 2$,\n- $a_{31} = 0$, $a_{32} = 3$, $a_{33} = 14$.\n\nCompute the adjusted Rand index using your derived expression. Round your final answer to four significant figures. Express the final answer as a pure number with no units.",
            "solution": "The problem requires the derivation of the Adjusted Rand Index (ARI) from first principles and its subsequent calculation for a given contingency table. The validation of the problem statement is the first step.\n\n### Step 1: Extract Givens\n- A set of $N$ cells with ground-truth class labels and unsupervised clustering assignments.\n- $a_{ij}$: The number of cells in ground-truth class $i$ and assigned to cluster $j$.\n- $n_i = \\sum_{j} a_{ij}$: The total number of cells in ground-truth class $i$ (row sums).\n- $m_j = \\sum_{i} a_{ij}$: The total number of cells in cluster $j$ (column sums).\n- $N = \\sum_{i,j} a_{ij}$: The total number of cells.\n- The task is to derive the ARI formula based on a pair-counting approach and a null model with fixed marginals $\\{n_i\\}$ and $\\{m_j\\}$.\n- A specific contingency table is provided with nonzero counts: $a_{11} = 8$, $a_{12} = 1$, $a_{13} = 1$; $a_{21} = 2$, $a_{22} = 9$, $a_{23} = 2$; $a_{31} = 0$, $a_{32} = 3$, $a_{33} = 14$.\n- The final answer should be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in statistics and bioinformatics. The Adjusted Rand Index is a standard and widely accepted metric for comparing partitions, especially in the context of clustering validation for scRNA-seq data. The derivation relies on fundamental principles of combinatorics and probability.\n- **Well-Posed:** The problem provides all necessary information: definitions, the specific form of the null model, the pair-counting framework, and a complete set of data for calculation. It guides the derivation process logically and asks for a single, computable value.\n- **Objective:** The problem is stated in precise mathematical and statistical language, free of ambiguity or subjective claims.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, well-posed, objective, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of the Adjusted Rand Index\n\nThe Adjusted Rand Index (ARI) is a corrected-for-chance version of the Rand Index. Its general form is:\n$$ \\text{ARI} = \\frac{\\text{Index} - \\text{Expected Index}}{\\text{Max Index} - \\text{Expected Index}} $$\nHere, the \"Index\" is a measure of agreement between two partitions (in this case, ground-truth classes and algorithm-derived clusters). We will use the number of pairs of objects placed in the same group in both partitions as our index of agreement.\n\n1.  **The Index of Agreement (Observed Agreement)**\n    The total number of pairs of cells in the dataset is $\\binom{N}{2}$. We define the index of agreement as the number of pairs that are both in the same ground-truth class and in the same cluster.\n    For a given cell $(i, j)$ in the contingency table containing $a_{ij}$ cells, the number of distinct pairs of cells is $\\binom{a_{ij}}{2}$. Summing over all cells of the contingency table gives the total number of pairs of cells that agree in both their class and cluster assignment. This is our observed index of agreement, which we denote as $I_{obs}$.\n    $$ I_{obs} = \\sum_{i,j} \\binom{a_{ij}}{2} $$\n\n2.  **The Expected Index (Agreement by Chance)**\n    We compute the expected value of the index under a null model where the two partitions are independent, but the marginal sums ($n_i$ and $m_j$) are fixed. This is the permutation model, where cluster labels are randomly assigned to cells while preserving the total number of cells per cluster.\n\n    The total number of pairs of cells belonging to the same class is $\\sum_i \\binom{n_i}{2}$. The probability that a randomly chosen pair of cells is in the same class is $P(\\text{same class}) = \\frac{\\sum_i \\binom{n_i}{2}}{\\binom{N}{2}}$.\n    Similarly, the total number of pairs of cells belonging to the same cluster is $\\sum_j \\binom{m_j}{2}$. The probability that a random pair is in the same cluster is $P(\\text{same cluster}) = \\frac{\\sum_j \\binom{m_j}{2}}{\\binom{N}{2}}$.\n\n    Under the null hypothesis of independence between the two partitions, the probability that a random pair of cells falls into both the same class and the same cluster is the product of these individual probabilities.\n    $$ P(\\text{agree}) = P(\\text{same class}) \\times P(\\text{same cluster}) = \\frac{\\sum_i \\binom{n_i}{2}}{\\binom{N}{2}} \\times \\frac{\\sum_j \\binom{m_j}{2}}{\\binom{N}{2}} $$\n    The expected number of agreeing pairs, $E[I]$, is the total number of pairs, $\\binom{N}{2}$, multiplied by this probability.\n    $$ E[I] = \\binom{N}{2} \\times P(\\text{agree}) = \\frac{\\left( \\sum_i \\binom{n_i}{2} \\right) \\left( \\sum_j \\binom{m_j}{2} \\right)}{\\binom{N}{2}} $$\n\n3.  **The Maximum Index and Normalization**\n    The maximum value of the index is needed for normalization. This value should correspond to perfect agreement. If the two partitions were identical, the index $I_{obs}$ would be equal to $\\sum_i \\binom{n_i}{2}$ (which would also equal $\\sum_j \\binom{m_j}{2}$). To create a symmetric measure, the maximum index is defined as the arithmetic mean of the maximum possible agreement values for each partition.\n    $$ I_{max} = \\frac{1}{2} \\left( \\sum_i \\binom{n_i}{2} + \\sum_j \\binom{m_j}{2} \\right) $$\n    This ensures that if the two partitions are identical, the ARI will be $1$.\n\n4.  **Final Expression for ARI**\n    Substituting the expressions for $I_{obs}$, $E[I]$, and $I_{max}$ into the general formula gives the complete expression for the Adjusted Rand Index:\n    $$ \\text{ARI} = \\frac{\\sum_{i,j} \\binom{a_{ij}}{2} - \\frac{\\left( \\sum_i \\binom{n_i}{2} \\right) \\left( \\sum_j \\binom{m_j}{2} \\right)}{\\binom{N}{2}}}{\\frac{1}{2} \\left[ \\sum_i \\binom{n_i}{2} + \\sum_j \\binom{m_j}{2} \\right] - \\frac{\\left( \\sum_i \\binom{n_i}{2} \\right) \\left( \\sum_j \\binom{m_j}{2} \\right)}{\\binom{N}{2}}} $$\n\n### Calculation for the Given Data\n\nThe provided nonzero contingency counts define a $3 \\times 3$ table:\n$$\n\\mathbf{A} = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{21} & a_{22} & a_{23} \\\\ a_{31} & a_{32} & a_{33} \\end{pmatrix} = \\begin{pmatrix} 8 & 1 & 1 \\\\ 2 & 9 & 2 \\\\ 0 & 3 & 14 \\end{pmatrix}\n$$\n\n1.  **Compute Marginal Sums and Total Count**\n    -   Row sums (ground-truth classes):\n        $n_1 = 8 + 1 + 1 = 10$\n        $n_2 = 2 + 9 + 2 = 13$\n        $n_3 = 0 + 3 + 14 = 17$\n    -   Column sums (clusters):\n        $m_1 = 8 + 2 + 0 = 10$\n        $m_2 = 1 + 9 + 3 = 13$\n        $m_3 = 1 + 2 + 14 = 17$\n    -   Total number of cells:\n        $N = 10 + 13 + 17 = 40$\n\n2.  **Calculate the Components of the ARI Formula**\n    -   **Observed Index ($I_{obs}$):** Sum of $\\binom{a_{ij}}{2}$ for all entries.\n        $I_{obs} = \\binom{8}{2} + \\binom{1}{2} + \\binom{1}{2} + \\binom{2}{2} + \\binom{9}{2} + \\binom{2}{2} + \\binom{0}{2} + \\binom{3}{2} + \\binom{14}{2}$\n        $I_{obs} = \\frac{8 \\times 7}{2} + 0 + 0 + \\frac{2 \\times 1}{2} + \\frac{9 \\times 8}{2} + \\frac{2 \\times 1}{2} + 0 + \\frac{3 \\times 2}{2} + \\frac{14 \\times 13}{2}$\n        $I_{obs} = 28 + 0 + 0 + 1 + 36 + 1 + 0 + 3 + 91 = 160$\n\n    -   **Total Pairs in Classes:** Sum of $\\binom{n_i}{2}$.\n        $\\sum_i \\binom{n_i}{2} = \\binom{10}{2} + \\binom{13}{2} + \\binom{17}{2}$\n        $\\sum_i \\binom{n_i}{2} = \\frac{10 \\times 9}{2} + \\frac{13 \\times 12}{2} + \\frac{17 \\times 16}{2} = 45 + 78 + 136 = 259$\n\n    -   **Total Pairs in Clusters:** Sum of $\\binom{m_j}{2}$.\n        Since $\\{n_i\\} = \\{m_j\\} = \\{10, 13, 17\\}$, this sum is identical.\n        $\\sum_j \\binom{m_j}{2} = \\binom{10}{2} + \\binom{13}{2} + \\binom{17}{2} = 259$\n\n    -   **Total Pairs:** $\\binom{N}{2}$.\n        $\\binom{40}{2} = \\frac{40 \\times 39}{2} = 780$\n\n3.  **Assemble the ARI Value**\n    -   **Numerator:** $I_{obs} - E[I]$\n        $E[I] = \\frac{(259) \\times (259)}{780} = \\frac{67081}{780}$\n        Numerator = $160 - \\frac{67081}{780} = \\frac{160 \\times 780 - 67081}{780} = \\frac{124800 - 67081}{780} = \\frac{57719}{780}$\n\n    -   **Denominator:** $I_{max} - E[I]$\n        $I_{max} = \\frac{1}{2} (259 + 259) = 259$\n        Denominator = $259 - \\frac{67081}{780} = \\frac{259 \\times 780 - 67081}{780} = \\frac{202020 - 67081}{780} = \\frac{134939}{780}$\n\n    -   **ARI:**\n        $\\text{ARI} = \\frac{\\text{Numerator}}{\\text{Denominator}} = \\frac{57719/780}{134939/780} = \\frac{57719}{134939}$\n\n4.  **Final Numerical Result**\n    $\\text{ARI} = \\frac{57719}{134939} \\approx 0.42770908...$\n    Rounding to four significant figures, we get $0.4277$.",
            "answer": "$$\\boxed{0.4277}$$"
        },
        {
            "introduction": "The ultimate goal of clustering is often to identify biologically distinct cell types, which requires moving beyond geometric validation to biological interpretation. This is primarily achieved through the identification of marker genes that are uniquely expressed in each cluster. This practice  demonstrates how to use the Area Under the Receiver Operating Characteristic curve (AUC) to quantify a gene's power to discriminate between two cell populations, providing a robust statistical foundation for annotating clusters and uncovering their biological identity.",
            "id": "4607367",
            "problem": "You are analyzing a single-cell ribonucleic acid sequencing (scRNA-seq) dataset where unsupervised clustering identified two clusters, denoted $\\mathcal{C}_{1}$ and $\\mathcal{C}_{0}$. A candidate marker gene $g$ is hypothesized to be upregulated in $\\mathcal{C}_{1}$ relative to $\\mathcal{C}_{0}$, and you wish to quantify its discriminative power using the area under the receiver operating characteristic (ROC) curve. The receiver operating characteristic (ROC) curve compares the true positive rate and false positive rate as a threshold on a scalar score varies; here, the scalar score is the log-normalized expression of $g$. Treat $\\mathcal{C}_{1}$ as the positive class and $\\mathcal{C}_{0}$ as the negative class. The log-normalized expression values of $g$ for a subset of cells are as follows:\n- $\\mathcal{C}_{1}$ (putative marker-positive): $2.5$, $3.1$, $1.8$, $2.2$, $3.7$, $2.9$.\n- $\\mathcal{C}_{0}$ (putative marker-negative): $0.6$, $1.1$, $1.4$, $1.9$, $2.3$.\nStarting from the foundational definition of the ROC curve in terms of the true positive rate and false positive rate as functions of the threshold applied to a scalar score, derive an expression for the area under the ROC curve (AUC) in this finite-sample setting and compute its value for the data above. Briefly interpret what this value implies about the discriminative power of $g$ between $\\mathcal{C}_{1}$ and $\\mathcal{C}_{0}$, using a probabilistic interpretation grounded in the definition. Report the AUC as a scalar in $[0,1]$ and round your final numeric answer to four significant figures.",
            "solution": "The problem asks for the calculation and interpretation of the area under the receiver operating characteristic curve (AUC) for a candidate marker gene $g$, given its log-normalized expression values in two cell clusters, $\\mathcal{C}_{1}$ (positive class) and $\\mathcal{C}_{0}$ (negative class).\n\nFirst, let us formalize the concepts of the receiver operating characteristic (ROC) curve and the area under it. The ROC curve is a graphical plot that illustrates the diagnostic ability of a binary classifier system as its discrimination threshold is varied. It is created by plotting the True Positive Rate ($TPR$) against the False Positive Rate ($FPR$) at various threshold settings.\n\nLet $S$ be the scalar score used for classification, which in this problem is the log-normalized expression of gene $g$. Let $\\tau$ be the classification threshold. A sample is classified as positive if its score $S > \\tau$.\nThe positive class is $\\mathcal{C}_{1}$, containing $N_1$ samples. The negative class is $\\mathcal{C}_{0}$, containing $N_0$ samples.\nThe True Positive Rate, or sensitivity, is the fraction of positive samples correctly classified as positive:\n$$TPR(\\tau) = \\frac{\\text{Number of samples in } \\mathcal{C}_{1} \\text{ with score } > \\tau}{N_1}$$\nThe False Positive Rate, or ($1$ - specificity), is the fraction of negative samples incorrectly classified as positive:\n$$FPR(\\tau) = \\frac{\\text{Number of samples in } \\mathcal{C}_{0} \\text{ with score } > \\tau}{N_0}$$\nThe ROC curve is the set of points $(FPR(\\tau), TPR(\\tau))$ for all possible values of $\\tau \\in (-\\infty, \\infty)$. The area under this curve, the AUC, is given by the integral:\n$$AUC = \\int_0^1 TPR(x) dx$$\nwhere the integration variable $x$ represents the $FPR$.\n\nA fundamental result provides a probabilistic interpretation for the AUC. The AUC is equal to the probability that a randomly drawn sample from the positive class has a higher score than a randomly drawn sample from the negative class. Let $S_1$ be the score of a random sample from $\\mathcal{C}_1$ and $S_0$ be the score of a random sample from $\\mathcal{C}_0$. Then,\n$$AUC = P(S_1 > S_0)$$\nIn the case where ties can occur (i.e., $S_1 = S_0$), the standard definition adjusts this to $AUC = P(S_1 > S_0) + \\frac{1}{2} P(S_1 = S_0)$.\n\nFor finite sample sets without ties, this probability can be estimated non-parametrically by the Wilcoxon-Mann-Whitney U statistic, which involves counting all possible pairs of samples, one from each class. Let the set of scores from $\\mathcal{C}_1$ be $X_1 = \\{x_{1,i}\\}_{i=1}^{N_1}$ and from $\\mathcal{C}_0$ be $X_0 = \\{x_{0,j}\\}_{j=1}^{N_0}$. The AUC is then calculated as:\n$$AUC = \\frac{1}{N_1 N_0} \\sum_{i=1}^{N_1} \\sum_{j=1}^{N_0} \\mathbb{I}(x_{1,i}, x_{0,j})$$\nwhere\n$$ \\mathbb{I}(a, b) = \\begin{cases} 1 & \\text{if } a > b \\\\ 0.5 & \\text{if } a = b \\\\ 0 & \\text{if } a < b \\end{cases} $$\nThis expression provides the most direct method for computing the AUC for the given finite dataset.\n\nNow, we apply this to the provided data.\nThe positive class is $\\mathcal{C}_{1}$ with $N_1 = 6$ samples. The expression values are $X_1 = \\{2.5, 3.1, 1.8, 2.2, 3.7, 2.9\\}$.\nThe negative class is $\\mathcal{C}_{0}$ with $N_0 = 5$ samples. The expression values are $X_0 = \\{0.6, 1.1, 1.4, 1.9, 2.3\\}$.\n\nThe total number of pairs of one cell from $\\mathcal{C}_{1}$ and one from $\\mathcal{C}_{0}$ is $N_1 \\times N_0 = 6 \\times 5 = 30$.\nThere are no ties in expression values between the two sets, so the $\\mathbb{I}(a,b)$ function will only take values of $1$ or $0$. We need to count the number of pairs $(x_{1,i}, x_{0,j})$ for which $x_{1,i} > x_{0,j}$.\n\nLet us perform the pairwise comparisons systematically:\nFor each $x_{1,i} \\in X_1$, we count how many $x_{0,j} \\in X_0$ are smaller.\n\\begin{itemize}\n    \\item For $x_{1,i} = 2.5$: it is greater than all $5$ values in $X_0 = \\{0.6, 1.1, 1.4, 1.9, 2.3\\}$. The count is $5$.\n    \\item For $x_{1,i} = 3.1$: it is greater than all $5$ values in $X_0$. The count is $5$.\n    \\item For $x_{1,i} = 1.8$: it is greater than $\\{0.6, 1.1, 1.4\\}$. The count is $3$.\n    \\item For $x_{1,i} = 2.2$: it is greater than $\\{0.6, 1.1, 1.4, 1.9\\}$. The count is $4$.\n    \\item For $x_{1,i} = 3.7$: it is greater than all $5$ values in $X_0$. The count is $5$.\n    \\item For $x_{1,i} = 2.9$: it is greater than all $5$ values in $X_0$. The count is $5$.\n\\end{itemize}\n\nThe total number of pairs where the score from $\\mathcal{C}_1$ is greater than the score from $\\mathcal{C}_0$ is the sum of these counts:\n$$ \\text{Sum} = 5 + 5 + 3 + 4 + 5 + 5 = 27 $$\nNow, we can compute the AUC:\n$$ AUC = \\frac{27}{30} = \\frac{9}{10} = 0.9 $$\nThe problem requires the answer to be rounded to four significant figures, so $0.9$ is written as $0.9000$.\n\nInterpretation: The AUC value is a measure of the classifier's performance, ranging from $0$ to $1$. An AUC of $0.5$ corresponds to a random classifier with no discriminative ability. An AUC of $1.0$ corresponds to a perfect classifier. The calculated AUC of $0.9$ is very close to $1.0$, which indicates that the expression level of gene $g$ has excellent discriminative power to distinguish between cells of cluster $\\mathcal{C}_{1}$ and $\\mathcal{C}_{0}$.\nBased on the probabilistic interpretation, an AUC of $0.9$ means that if we randomly select one cell from $\\mathcal{C}_{1}$ and one cell from $\\mathcal{C}_{0}$, there is a $90\\%$ probability that the cell from $\\mathcal{C}_{1}$ will have a higher log-normalized expression of gene $g$. This strongly supports the hypothesis that $g$ is a marker gene upregulated in $\\mathcal{C}_{1}$.",
            "answer": "$$\\boxed{0.9000}$$"
        }
    ]
}