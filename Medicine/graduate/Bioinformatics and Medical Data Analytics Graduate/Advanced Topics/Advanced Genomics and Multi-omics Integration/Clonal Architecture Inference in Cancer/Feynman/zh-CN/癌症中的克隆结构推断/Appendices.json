{
    "hands_on_practices": [
        {
            "introduction": "测序数据直接提供的是变异等位基因频率（$VAF$），但要真正理解克隆结构，我们需要计算癌症细胞分数（Cancer Cell Fraction, $CCF$）。本练习将指导你从第一性原理出发，推导连接 $VAF$ 和 $CCF$ 的关键公式，该公式考虑了肿瘤纯度 $p$ 和拷贝数 $C$。这是解释癌症测序数据、揭示肿瘤内部异质性的基础步骤。",
            "id": "4549139",
            "problem": "来自实体瘤的单个全基因组测序活检样本显示，一个体细胞单核苷酸变异的观察变异等位基因频率 (VAF) 等于 $0.18$。该样本包含癌细胞和正常细胞的混合物。癌细胞分数 (Cancer Cell Fraction, CCF)，记为 $f$，定义为携带该突变的癌细胞所占的比例。样本纯度，记为 $p$，是样本中癌细胞所占的比例。在癌细胞中，该基因座的总拷贝数为 $C$，突变多重性 $m$ 是指携带该突变的癌细胞中，携带该突变的等位基因拷贝数。\n\n假设如下：\n- 在该基因座上，正常细胞是二倍体，每个细胞贡献 $2$ 个总等位基因。\n- 在该基因座上，癌细胞的总拷贝数为 $C$，并且在癌细胞中，有比例为 $f$ 的细胞携带该突变。\n- 每个突变的癌细胞在该基因座上携带 $m$ 个突变等位基因拷贝。\n- 测序是无偏的，并且在足够大的测序深度下，观察到的VAF等于混合DNA池中突变等位基因的期望比例。\n\n从基本原理出发，在两室混合模型（正常细胞和癌细胞）中使用等位基因计数法，推导一个将期望VAF与 $p$、$C$、$m$ 和 $f$ 联系起来的表达式，并求解 $f$。然后，使用观察到的VAF为 $0.18$、$p=0.7$、$C=3$ 和 $m=1$ 的数据计算 $f$ 的值。将你的最终答案以最简分数形式表示。",
            "solution": "问题要求基于肿瘤样本的两室模型，推导癌细胞分数 $f$ 的表达式，然后根据一组给定的参数计算其值。推导将从基本原理出发，通过考虑样本中正常细胞和癌细胞群体的等位基因贡献来进行。\n\n让我们考虑一个代表性的组织样本，共含有 $N_{\\text{total}}$ 个细胞。样本纯度 $p$ 是癌细胞所占的比例。\n样本中癌细胞的数量为 $N_{\\text{cancer}} = p \\cdot N_{\\text{total}}$。\n样本中正常细胞的数量为 $N_{\\text{normal}} = (1-p) \\cdot N_{\\text{total}}$。\n\n期望的变异等位基因频率 $VAF_{\\text{exp}}$ 是整个样本中指定基因座上突变等位基因数量与等位基因总数的比率。我们必须计算这两个量。\n\n首先，我们确定样本中等位基因的总数 $A_{\\text{total}}$。\n正常细胞是二倍体，所以每个正常细胞在该基因座上贡献 $2$ 个等位基因。来自正常细胞的总贡献为 $N_{\\text{normal}} \\times 2 = (1-p) N_{\\text{total}} \\times 2$。\n在该基因座上，癌细胞的总拷贝数为 $C$。来自癌细胞的总贡献为 $N_{\\text{cancer}} \\times C = p N_{\\text{total}} \\times C$。\n样本中等位基因的总数是这些贡献的总和：\n$$\nA_{\\text{total}} = 2(1-p)N_{\\text{total}} + C p N_{\\text{total}} = N_{\\text{total}} [2(1-p) + C p]\n$$\n\n接下来，我们确定突变等位基因的总数 $A_{\\text{mutated}}$。\n假设正常细胞不携带该体细胞突变，因此它们对突变等位基因计数的贡献为 $0$。\n该突变仅存在于一部分比例为 $f$（癌细胞分数）的癌细胞中。\n携带该突变的癌细胞数量为 $N_{\\text{mutated\\_cancer}} = f \\cdot N_{\\text{cancer}} = f \\cdot p \\cdot N_{\\text{total}}$。\n在这些突变的癌细胞中，每个细胞的突变存在于 $m$ 个等位基因拷贝上（突变多重性）。\n因此，样本中突变等位基因的总数为：\n$$\nA_{\\text{mutated}} = N_{\\text{mutated\\_cancer}} \\times m = (f \\cdot p \\cdot N_{\\text{total}}) \\cdot m = f p m N_{\\text{total}}\n$$\n\n期望的VAF是 $A_{\\text{mutated}}$ 与 $A_{\\text{total}}$ 的比率。\n$$\nVAF_{\\text{exp}} = \\frac{A_{\\text{mutated}}}{A_{\\text{total}}} = \\frac{f p m N_{\\text{total}}}{N_{\\text{total}} [2(1-p) + C p]}\n$$\n项 $N_{\\text{total}}$ 被消去，得到将期望VAF与模型参数联系起来的通用表达式：\n$$\nVAF_{\\text{exp}} = \\frac{f p m}{2(1-p) + C p}\n$$\n问题陈述，观察到的VAF可以等同于期望的VAF。让 $VAF$ 表示 $VAF_{\\text{exp}}$。\n$$\nVAF = \\frac{f p m}{2(1-p) + C p}\n$$\n我们需要解这个方程以求出癌细胞分数 $f$。为此，我们整理该方程：\n$$\nVAF \\cdot [2(1-p) + C p] = f p m\n$$\n$$\nf = \\frac{VAF \\cdot [2(1-p) + C p]}{p m}\n$$\n这就是推导出的 $f$ 的表达式。\n\n现在，我们使用给定的数据计算 $f$ 的值：观察到的 $VAF = 0.18$，样本纯度 $p=0.7$，癌细胞中的总拷贝数 $C=3$，以及突变多重性 $m=1$。\n为了保持精度，我们将对小数值使用分数表示法：\n$VAF = 0.18 = \\frac{18}{100} = \\frac{9}{50}$\n$p = 0.7 = \\frac{7}{10}$\n\n将这些值代入 $f$ 的表达式中：\n$$\nf = \\frac{\\frac{9}{50} \\cdot [2(1-\\frac{7}{10}) + 3 \\cdot \\frac{7}{10}]}{\\frac{7}{10} \\cdot 1}\n$$\n首先，我们计算方括号中的项：\n$$\n1-\\frac{7}{10} = \\frac{3}{10}\n$$\n$$\n2\\left(\\frac{3}{10}\\right) + 3\\left(\\frac{7}{10}\\right) = \\frac{6}{10} + \\frac{21}{10} = \\frac{27}{10}\n$$\n现在，将此结果代回 $f$ 的表达式中：\n$$\nf = \\frac{\\frac{9}{50} \\cdot \\frac{27}{10}}{\\frac{7}{10}}\n$$\n我们可以简化这个繁分数：\n$$\nf = \\frac{9}{50} \\cdot \\frac{27}{10} \\cdot \\frac{10}{7}\n$$\n分子和分母中的因子 $10$ 被消去：\n$$\nf = \\frac{9}{50} \\cdot \\frac{27}{7}\n$$\n最后，我们进行乘法运算：\n$$\nf = \\frac{9 \\times 27}{50 \\times 7} = \\frac{243}{350}\n$$\n为了确认此分数为最简形式，我们注意到分子的质因数分解为 $243 = 3^5$，分母的质因数分解为 $350 = 2 \\times 5^2 \\times 7$。它们没有共同的质因数，所以该分数是不可约的。",
            "answer": "$$\n\\boxed{\\frac{243}{350}}\n$$"
        },
        {
            "introduction": "真实的肿瘤样本包含大量突变，简单的单一位点分析是不够的。本练习将单个变异的计算扩展到一个更真实的场景，让你处理多个具有不同局部拷贝数的变异。你将应用 $VAF$ 到 $CCF$ 的转换，解决突变多重性（multiplicity）的不确定性，并实践如何将变异聚类到不同的克隆中，这是系统发育推断前关键的数据处理环节。",
            "id": "4549121",
            "problem": "一个单一的实体瘤测序样本具有已知的纯度 $p=0.7$（样本中癌细胞的比例）。对于每个体细胞单核苷酸变异，给出了其变异和参考读数计数，以及从分段推断出的局部等位基因特异性拷贝数：总拷贝数 $C_{t}$ 和次要等位基因拷贝数 $C_{m}$。假设正常细胞群在所有位点上的总拷贝数为 $2$，测序无偏差，并且位点水平的肿瘤拷贝数在包含或不包含该变异的癌细胞中均一适用。设变异存在于一部分比例为 $c$ 的癌细胞中（癌症细胞分数，CCF），并让多重性 $m$ 表示携带该变异的每个癌细胞中的突变拷贝数。变异等位基因频率（VAF）定义为支持变异等位基因的测序读数比例：$v = \\frac{a}{a+r}$，其中 $a$ 和 $r$ 分别是变异和参考读数计数。\n\n从这些定义以及肿瘤和正常细胞的混合模型出发，推导从观测到的 VAF $v$ 到 CCF $c$ 的映射关系，该关系是 $p$、$C_{t}$ 和 $m$ 的函数。然后，对于下面的每个变异，通过使用观测到的 $v$ 反转该映射来计算调整后的 CCF，并选择最小的整数多重性 $m$ 使得 $1 \\leq m \\leq C_{\\mathrm{maj}}$ 且得到的 $c$ 位于区间 $[0,1]$ 内，其中 $C_{\\mathrm{maj}} = C_{t} - C_{m}$ 是主要等位基因拷贝数。如果没有这样的 $m$ 能使得 $c \\in [0,1]$，则选择使 $c$与 $1$ 的绝对偏差最小的最小 $m$。\n\n在计算调整后的 CCF之后，将每个变异分配到由固定的 CCF 中心定义的两个簇之一：中心为 $1.0$ 的克隆簇和中心为 $0.35$ 的显性亚克隆簇。使用绝对差 $|c - \\text{center}|$ 的最近中心分配法，若出现平局则优先分配给克隆簇 ($1.0$)。\n\n五个变异如下：\n- 变异 $1$：$a_{1}=45$，$r_{1}=55$，$C_{t,1}=3$，$C_{m,1}=1$。\n- 变异 $2$：$a_{2}=40$，$r_{2}=80$，$C_{t,2}=2$，$C_{m,2}=1$。\n- 变异 $3$：$a_{3}=20$，$r_{3}=80$，$C_{t,3}=4$，$C_{m,3}=1$。\n- 变异 $4$：$a_{4}=25$，$r_{4}=75$，$C_{t,4}=3$，$C_{m,4}=0$。\n- 变异 $5$：$a_{5}=20$，$r_{5}=80$，$C_{t,5}=5$，$C_{m,5}=2$。\n\n将每个 CCF 表示为四舍五入到四位有效数字的小数。最终答案必须以单行矩阵的形式给出，前五个条目是按顺序排列的变异 1 到 5 的四舍五入后的 CCF，后面是五个簇分配的整数编码（$1$ 代表克隆簇，$2$ 代表显性亚克隆簇）。",
            "solution": "该问题被认为是有效的，因为它科学地基于癌症基因组学的原理，问题陈述清晰，包含所有必要的数据和明确的客观规则，并且可以形式化为一个可解的数学和分析任务。\n\n第一步是推导癌症细胞分数（$c$）与观测到的变异等位基因频率（$v$）之间的一般关系。测序样本是正常细胞（比例为 $1-p$）和肿瘤细胞（比例为 $p$）的混合物。\n\n让我们考虑在给定基因座上被测序的等位基因总数。\n正常细胞群的比例为 $1-p$，总拷贝数为 $2$。因此，由正常细胞贡献的等位基因数量与 $2(1-p)$ 成正比。\n肿瘤细胞群的比例为 $p$，特定位点的总拷贝数为 $C_t$。因此，由肿瘤细胞贡献的等位基因数量与 $p C_t$ 成正比。\n样本中等位基因的总数是两个细胞群贡献之和，与 $N_{total} = 2(1-p) + p C_t$ 成正比。\n\n接下来，我们考虑变异（突变）等位基因的数量。体细胞变异仅存在于比例为 $c$ 的癌细胞中。\n正常细胞不携带该体细胞变异，因此它们贡献 $0$ 个变异等位基因。\n不携带该变异的肿瘤细胞（占肿瘤细胞群的比例为 $1-c$）也贡献 $0$ 个变异等位基因。\n携带该变异的肿瘤细胞（占肿瘤细胞群的比例为 $c$）具有多重性 $m$，意味着每个这样的细胞拥有 $m$ 个突变等位基因的拷贝。这些细胞对样本中变异等位基因总数的贡献与 $N_{alt} = p \\cdot c \\cdot m$ 成正比。\n\n变异等位基因频率（$v$）是变异等位基因数量与等位基因总数的比率。\n$$v = \\frac{N_{alt}}{N_{total}} = \\frac{p c m}{2(1-p) + p C_t}$$\n问题要求我们找到作为观测到的 $v$ 的函数的 CCF，$c$。我们可以反转上述方程来解出 $c$：\n$$c(v, m) = \\frac{v \\left( 2(1-p) + p C_t \\right)}{p m}$$\n鉴于肿瘤纯度 $p=0.7$，这可以简化为：\n$$c(v, m) = \\frac{v \\left( 2(1-0.7) + 0.7 C_t \\right)}{0.7 m} = \\frac{v \\left( 0.6 + 0.7 C_t \\right)}{0.7 m}$$\n这个公式将用于计算每个变异的 CCF。\n\n我们现在将通过应用此公式和选择多重性 $m$ 的规则来分析每个变异。\n\n**变异 1**\n- 数据：$a_1=45$，$r_1=55$，$C_{t,1}=3$，$C_{m,1}=1$。\n- 观测到的 VAF：$v_1 = \\frac{a_1}{a_1+r_1} = \\frac{45}{45+55} = 0.45$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},1} = C_{t,1} - C_{m,1} = 3-1 = 2$。\n- 多重性 $m$ 必须是整数，$1 \\leq m \\leq C_{\\mathrm{maj},1}$。因此，$m \\in \\{1, 2\\}$。\n- 我们为每个可能的 $m$ 计算 $c_1(m)$：\n$$c_1(m) = \\frac{0.45 \\left( 0.6 + 0.7 \\times 3 \\right)}{0.7 m} = \\frac{0.45 \\left( 2.7 \\right)}{0.7 m} = \\frac{1.215}{0.7 m} \\approx \\frac{1.7357}{m}$$\n- 对于 $m=1$：$c_1(1) \\approx 1.7357$。这不在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_1(2) \\approx 1.7357/2 = 0.86785$。这在 $[0,1]$ 区间内。\n- 根据规则，我们选择能使 $c \\in [0,1]$ 的最小整数 $m$。这里，只有 $m=2$ 满足条件。\n- 变异 1 的 CCF 是 $c_1 = 0.86785$。四舍五入到四位有效数字，$c_1 = 0.8679$。\n\n**变异 2**\n- 数据：$a_2=40$，$r_2=80$，$C_{t,2}=2$，$C_{m,2}=1$。\n- 观测到的 VAF：$v_2 = \\frac{40}{40+80} = \\frac{40}{120} = \\frac{1}{3}$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},2} = C_{t,2} - C_{m,2} = 2-1 = 1$。\n- 多重性 $m$ 必须是整数，$1 \\leq m \\leq C_{\\mathrm{maj},2}$。因此，$m \\in \\{1\\}$。\n- 我们计算 $c_2(m)$：\n$$c_2(m) = \\frac{(1/3) \\left( 0.6 + 0.7 \\times 2 \\right)}{0.7 m} = \\frac{(1/3) \\left( 2.0 \\right)}{0.7 m} = \\frac{2/3}{0.7 m} = \\frac{2}{2.1 m} \\approx \\frac{0.95238}{m}$$\n- 对于 $m=1$：$c_2(1) \\approx 0.95238$。这在 $[0,1]$ 区间内。\n- 由于 $m=1$ 是唯一的可能性，并且它产生了有效的 $c_2$，我们选择 $m=1$。\n- 变异 2 的 CCF 是 $c_2 \\approx 0.95238$。四舍五入到四位有效数字，$c_2 = 0.9524$。\n\n**变异 3**\n- 数据：$a_3=20$，$r_3=80$，$C_{t,3}=4$，$C_{m,3}=1$。\n- 观测到的 VAF：$v_3 = \\frac{20}{20+80} = 0.2$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},3} = C_{t,3} - C_{m,3} = 4-1 = 3$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_3(m)$：\n$$c_3(m) = \\frac{0.2 \\left( 0.6 + 0.7 \\times 4 \\right)}{0.7 m} = \\frac{0.2 \\left( 3.4 \\right)}{0.7 m} = \\frac{0.68}{0.7 m} \\approx \\frac{0.97143}{m}$$\n- 对于 $m=1$：$c_3(1) \\approx 0.97143$。这在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_3(2) \\approx 0.97143/2 = 0.48571$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_3(3) \\approx 0.97143/3 = 0.32381$。这在 $[0,1]$ 区间内。\n- 我们有多个 $m$ 值使得 $c \\in [0,1]$。我们必须选择最小的一个，即 $m=1$。\n- 变异 3 的 CCF 是 $c_3 \\approx 0.97143$。四舍五入到四位有效数字，$c_3 = 0.9714$。\n\n**变异 4**\n- 数据：$a_4=25$，$r_4=75$，$C_{t,4}=3$，$C_{m,4}=0$。\n- 观测到的 VAF：$v_4 = \\frac{25}{25+75} = 0.25$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},4} = C_{t,4} - C_{m,4} = 3-0 = 3$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_4(m)$：\n$$c_4(m) = \\frac{0.25 \\left( 0.6 + 0.7 \\times 3 \\right)}{0.7 m} = \\frac{0.25 \\left( 2.7 \\right)}{0.7 m} = \\frac{0.675}{0.7 m} \\approx \\frac{0.96429}{m}$$\n- 对于 $m=1$：$c_4(1) \\approx 0.96429$。这在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_4(2) \\approx 0.96429/2 = 0.48214$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_4(3) \\approx 0.96429/3 = 0.32143$。这在 $[0,1]$ 区间内。\n- 我们选择能使 $c \\in [0,1]$ 的最小 $m$，即 $m=1$。\n- 变异 4 的 CCF 是 $c_4 \\approx 0.96429$。四舍五入到四位有效数字，$c_4 = 0.9643$。\n\n**变异 5**\n- 数据：$a_5=20$，$r_5=80$，$C_{t,5}=5$，$C_{m,5}=2$。\n- 观测到的 VAF：$v_5 = \\frac{20}{20+80} = 0.2$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},5} = C_{t,5} - C_{m,5} = 5-2 = 3$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_5(m)$：\n$$c_5(m) = \\frac{0.2 \\left( 0.6 + 0.7 \\times 5 \\right)}{0.7 m} = \\frac{0.2 \\left( 4.1 \\right)}{0.7 m} = \\frac{0.82}{0.7 m} \\approx \\frac{1.1714}{m}$$\n- 对于 $m=1$：$c_5(1) \\approx 1.1714$。这不在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_5(2) \\approx 1.1714/2 = 0.5857$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_5(3) \\approx 1.1714/3 = 0.39047$。这在 $[0,1]$ 区间内。\n- 我们选择能使 $c \\in [0,1]$ 的最小 $m$，即 $m=2$。\n- 变异 5 的 CCF 是 $c_5 \\approx 0.5857$。四舍五入到四位有效数字，$c_5 = 0.5857$。\n\n现在我们进行聚类。簇中心为 $1.0$（克隆性，簇ID 1）和 $0.35$（亚克隆性，簇ID 2）。我们使用最近中心分配法。\n\n- **V1 ($c_1=0.8679$):** $|0.8679 - 1.0| = 0.1321$，$|0.8679 - 0.35| = 0.5179$。更接近 $1.0$。簇：**1**。\n- **V2 ($c_2=0.9524$):** $|0.9524 - 1.0| = 0.0476$，$|0.9524 - 0.35| = 0.6024$。更接近 $1.0$。簇：**1**。\n- **V3 ($c_3=0.9714$):** $|0.9714 - 1.0| = 0.0286$，$|0.9714 - 0.35| = 0.6214$。更接近 $1.0$。簇：**1**。\n- **V4 ($c_4=0.9643$):** $|0.9643 - 1.0| = 0.0357$，$|0.9643 - 0.35| = 0.6143$。更接近 $1.0$。簇：**1**。\n- **V5 ($c_5=0.5857$):** $|0.5857 - 1.0| = 0.4143$，$|0.5857 - 0.35| = 0.2357$。更接近 $0.35$。簇：**2**。\n\n最终结果结合了五个 CCF 值和五个簇分配。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8679  0.9524  0.9714  0.9643  0.5857  1  1  1  1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将突变聚类后，下一步是确定它们之间的演化关系，即构建克隆系统发育树。本练习将指导你利用来自多个肿瘤样本的簇级 $CCF$ 值来验证可能的树结构。通过应用无限位点假设（Infinite Sites Assumption, ISA）所衍生的核心约束，你将学会如何判断一个系统发育树是否与观测数据兼容，从而推断出肿瘤的演化路径。",
            "id": "4549150",
            "problem": "一个肿瘤在两个空间上分离的大块样本（表示为 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$）中进行了测序。体细胞单核苷酸变异（SNV）已根据其共现模式和推断的癌细胞分数（CCF）聚类成 $3$ 个突变簇。这些CCF值已经根据肿瘤纯度进行了校正，并假定为拷贝数中性。设这些簇为 $C_1$（推定的主干）、$C_2$ 和 $C_3$。每个样本中每个簇的估计CCF如下：\n- 在 $S_{\\mathrm{A}}$ 中：$C_1: 0.95$， $C_2: 0.40$， $C_3: 0.55$。\n- 在 $S_{\\mathrm{B}}$ 中：$C_1: 0.96$， $C_2: 0.60$， $C_3: 0.25$。\n\n假设无限位点假设（ISA），即每个突变只发生一次，并且永远不会丢失或恢复。还假设所有簇共享一个在所有样本中都一致的单一克隆系统发育树。在ISA和拷贝数中性的条件下，对于任何样本中的任何克隆，其父克隆的癌细胞分数必须至少等于其所有子克隆的癌细胞分数之和。此外，如果克隆 $u$ 是克隆 $v$ 的祖先，那么在每个样本中，克隆 $v$ 的癌细胞分数不能超过克隆 $u$ 的癌细胞分数。将上述CCF值视为精确值。\n\n只考虑以 $C_1$ 为根（主干）、$C_2$ 和 $C_3$ 为非根节点的有根树。在所有满足ISA结构约束的关于 $\\{C_1,C_2,C_3\\}$ 的不同有根标记拓扑中，确定有多少种拓扑可以使用给定的CCF值同时满足两个样本 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$ 中的每个样本的频率约束。将计数报告为单个整数。无需四舍五入，也无需单位。",
            "solution": "### 第一步：提取和理解约束\n问题要求我们根据两个样本（$S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$）的癌细胞分数（CCF）数据，来确定有多少种可能的克隆系统发育树拓扑是有效的。我们有三个突变簇 $C_1, C_2, C_3$，其中 $C_1$ 被指定为主干（根）。\n\n无限位点假设（ISA）为我们提供了两个核心约束：\n1.  **鸽巢原理**：如果一个克隆（例如 $C_2$）是另一个克隆（例如 $C_1$）的后代，那么在**所有**样本中，$C_2$ 的CCF都不能超过 $C_1$ 的CCF。即 $CCF(C_2) \\le CCF(C_1)$。\n2.  **求和法则**：如果两个克隆（例如 $C_2$ 和 $C_3$）是从同一个父克隆（例如 $C_1$）分化出来的不同分支（即它们是“姐妹”关系），那么在**所有**样本中，它们的CCF之和不能超过父克隆的CCF。即 $CCF(C_2) + CCF(C_3) \\le CCF(C_1)$。\n\n给定的CCF数据：\n- 样本 $S_{\\mathrm{A}}$：$CCF(C_1)=0.95$, $CCF(C_2)=0.40$, $CCF(C_3)=0.55$。\n- 样本 $S_{\\mathrm{B}}$：$CCF(C_1)=0.96$, $CCF(C_2)=0.60$, $CCF(C_3)=0.25$。\n\n### 第二步：列出并检验所有可能的拓扑\n以 $C_1$ 为根，对于 $C_2$ 和 $C_3$ 这两个节点，总共有三种可能的有根树拓扑结构：\n1.  **线性演化 1**: $C_1 \\to C_2 \\to C_3$ (C1是C2的父代, C2是C3的父代)。\n2.  **线性演化 2**: $C_1 \\to C_3 \\to C_2$ (C1是C3的父代, C3是C2的父代)。\n3.  **分支演化**: $C_1$ 是 $C_2$ 和 $C_3$ 的共同父代。\n\n我们逐一检验这些拓扑是否满足上述两个约束。\n\n#### 检验拓扑 1: $C_1 \\to C_2 \\to C_3$\n-   该结构要求 $CCF(C_3) \\le CCF(C_2)$ 并且 $CCF(C_2) \\le CCF(C_1)$ 在两个样本中都必须成立。\n-   **检验 $CCF(C_3) \\le CCF(C_2)$**：\n    -   在样本 $S_{\\mathrm{A}}$ 中：$0.55 \\le 0.40$。此条件**不成立**。\n-   由于在样本 $S_{\\mathrm{A}}$ 中鸽巢原理被违反，该拓扑无效。我们无需继续检验。\n\n#### 检验拓扑 2: $C_1 \\to C_3 \\to C_2$\n-   该结构要求 $CCF(C_2) \\le CCF(C_3)$ 并且 $CCF(C_3) \\le CCF(C_1)$ 在两个样本中都必须成立。\n-   **检验 $CCF(C_2) \\le CCF(C_3)$**：\n    -   在样本 $S_{\\mathrm{B}}$ 中：$0.60 \\le 0.25$。此条件**不成立**。\n-   由于在样本 $S_{\\mathrm{B}}$ 中鸽巢原理被违反，该拓扑也无效。\n\n#### 检验拓扑 3: 分支演化 ($C_1$ 是 $C_2$ 和 $C_3$ 的共同父代)\n-   该结构要求同时满足鸽巢原理和求和法则。\n-   **检验鸽巢原理**:\n    -   $CCF(C_2) \\le CCF(C_1)$?\n        -   $S_{\\mathrm{A}}$: $0.40 \\le 0.95$ (成立)\n        -   $S_{\\mathrm{B}}$: $0.60 \\le 0.96$ (成立)\n    -   $CCF(C_3) \\le CCF(C_1)$?\n        -   $S_{\\mathrm{A}}$: $0.55 \\le 0.95$ (成立)\n        -   $S_{\\mathrm{B}}$: $0.25 \\le 0.96$ (成立)\n    -   鸽巢原理在两个样本中对两个子克隆都成立。\n-   **检验求和法则**: $CCF(C_2) + CCF(C_3) \\le CCF(C_1)$?\n    -   在样本 $S_{\\mathrm{A}}$ 中：$0.40 + 0.55 = 0.95$。$0.95 \\le 0.95$ (成立)。\n    -   在样本 $S_{\\mathrm{B}}$ 中：$0.60 + 0.25 = 0.85$。$0.85 \\le 0.96$ (成立)。\n-   求和法则在两个样本中都成立。\n\n由于分支演化拓扑满足了所有样本中的所有约束条件，因此它是唯一有效的拓扑。\n\n### 第三步：结论\n在所有三种可能的拓扑中，只有一种（分支演化模型）与给定的两个样本的CCF数据一致。因此，只有一个拓扑满足所有约束。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}