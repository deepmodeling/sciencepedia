{
    "hands_on_practices": [
        {
            "introduction": "首个练习旨在解决一个基本概念：如何解读变异等位基因频率（Variant Allele Fraction, $VAF$）。在癌症基因组学中，$VAF$ 并不仅仅是一个简单的频率，而是一个受肿瘤纯度（tumor purity）和局部拷贝数（copy number）影响的丰富信号。通过本练习，你将学习推导连接这些因素的核心数学模型，这是从批量测序数据中定量评估体细胞突变的关键技能。",
            "id": "4608601",
            "problem": "一份批量全基因组测序样本由肿瘤细胞和正常细胞混合而成。设$p$表示肿瘤细胞分数（肿瘤纯度），$c_{t}$表示肿瘤细胞中某个位点的总拷贝数，$c_{n}$表示正常细胞中该位点的总拷贝数。考虑一个克隆性体细胞突变，该突变存在于所有肿瘤细胞中，并且在肿瘤细胞内是杂合的，这意味着在每个肿瘤細胞的$c_{t}$个拷贝中，它恰好占据$m=1$个突变拷贝，并且在正常细胞中不存在。假设DNA分子是随机采样的，没有等位基因偏好，并且测序读段的采样与等位基因拷贝数成正比。根据变异等位基因分数（VAF）的定义，期望VAF等于批量样本中突变等位基因拷贝数占总等位基因拷贝数的分数。\n\n仅使用这些定义和假设，首先推导出对于通用参数$p$、$c_{t}$、$c_{n}$和$m$的期望VAF（表示为$v_{\\mathrm{exp}}$）。然后，对于$p=0.6$、$c_{t}=3$、$c_{n}=2$和$m=1$的情况，计算$v_{\\mathrm{exp}}$的数值。一次测序实验报告该位点的测量VAF为$v=0.22$。为定量评估测量值与模型的一致性，计算绝对偏差$r=|v-v_{\\mathrm{exp}}|$。将$r$表示为小数，并将最终答案四舍五入到四位有效数字。不需要单位。",
            "solution": "问题陈述已经过验证，具有科学依据，提法恰当且客观。所有必要信息均已提供，且所作假设在癌症基因组学领域是标准的。我们可以开始求解。\n\n问题要求三个量：首先，期望变异等位基因分数（$v_{\\mathrm{exp}}$）的通用公式；其次，在特定情况下的数值；第三，此期望值与给定测量值之间的绝对偏差（$r$）。\n\n首先，我们推导$v_{\\mathrm{exp}}$的通用公式。期望VAF定义为批量样本中突变等位基因拷贝数占总等位基因拷贝数的分数。样本是肿瘤细胞（分数为$p$）和正常细胞（分数为$1-p$）的混合物。\n\n让我们计算突变拷贝的总数。\n- 在肿瘤细胞中，该位点的突变拷贝数给定为$m$。肿瘤细胞对总突变等位基因库的贡献与肿瘤纯度$p$和每个肿瘤细胞的突变拷贝数$m$成正比。因此，该贡献与$p \\cdot m$成正比。\n- 在正常细胞中，体细胞突变不存在，因此突变拷贝数为$0$。正常细胞对突变等位基因库的贡献与$(1-p) \\cdot 0 = 0$成正比。\n因此，批量样本中突变拷贝的总数与$p \\cdot m$成正比。\n\n接下来，让我们计算该位点等位基因拷贝的总数（包括突变型和野生型）。\n- 在肿瘤细胞中，该位点的总拷贝数为$c_t$。肿瘤细胞对总等位基因库的贡献与$p \\cdot c_t$成正比。\n- 在正常细胞中，该位点的总拷贝数为$c_n$。正常细胞对总等位基因库的贡献与$(1-p) \\cdot c_n$成正比。\n因此，批量样本中等位基因拷贝的总数与这些贡献的总和成正比：$p \\cdot c_t + (1-p) \\cdot c_n$。\n\n期望VAF，$v_{\\mathrm{exp}}$，是突变拷贝总数与所有拷贝总数的比率。\n$$v_{\\mathrm{exp}} = \\frac{p \\cdot m}{p \\cdot c_t + (1-p) \\cdot c_n}$$\n\n第二，我们使用给定的参数计算$v_{\\mathrm{exp}}$的数值：肿瘤纯度$p=0.6$，肿瘤细胞拷贝数$c_t=3$，正常细胞拷贝数$c_n=2$，肿瘤细胞中的突变等位基因计数$m=1$。\n将这些值代入推导出的公式中：\n$$v_{\\mathrm{exp}} = \\frac{(0.6) \\cdot 1}{(0.6) \\cdot 3 + (1-0.6) \\cdot 2}$$\n$$v_{\\mathrm{exp}} = \\frac{0.6}{1.8 + (0.4) \\cdot 2}$$\n$$v_{\\mathrm{exp}} = \\frac{0.6}{1.8 + 0.8}$$\n$$v_{\\mathrm{exp}} = \\frac{0.6}{2.6}$$\n该分数简化为：\n$$v_{\\mathrm{exp}} = \\frac{6}{26} = \\frac{3}{13}$$\n\n第三，我们计算绝对偏差$r = |v - v_{\\mathrm{exp}}|$，其中$v$是测量的VAF，给定为$v=0.22$。\n$$r = \\left|0.22 - \\frac{3}{13}\\right|$$\n为了进行减法运算，我们可以将两项都表示为分数或小数。让我们将$0.22$转换为分数：$0.22 = \\frac{22}{100} = \\frac{11}{50}$。\n$$r = \\left|\\frac{11}{50} - \\frac{3}{13}\\right|$$\n$$r = \\left|\\frac{11 \\cdot 13 - 3 \\cdot 50}{50 \\cdot 13}\\right|$$\n$$r = \\left|\\frac{143 - 150}{650}\\right|$$\n$$r = \\left|\\frac{-7}{650}\\right|$$\n$$r = \\frac{7}{650}$$\n为了以四舍五入到四位有效数字的小数形式提供答案，我们计算该分数的值：\n$$r = \\frac{7}{650} \\approx 0.01076923...$$\n第一个有效数字是$1$。前四个有效数字是$1$、$0$、$7$和$6$。第五个有效数字是$9$，大于或等于$5$，所以我们将第四个有效数字向上取整。\n$$r \\approx 0.01077$$\n这是绝对偏差的最终数值答案。",
            "answer": "$$\n\\boxed{0.01077}\n$$"
        },
        {
            "introduction": "在识别出潜在的变异后，我们面临一个重大的统计挑战：全基因组分析涉及数千次假设检验，这会增加假阳性的风险。本练习将介绍用于控制假发现率（False Discovery Rate, $FDR$）的Benjamini-Hochberg（BH）程序，这是生物信息学中的一种标准方法。你将通过编程实践该程序，并结合常用的读数深度（read depth）和$VAF$阈值等过滤条件，构建一个稳健的变异检出流程。",
            "id": "4608579",
            "problem": "您正在分析肿瘤-正常组织测序中的体细胞变异假设，其中每个假设检验都会产生一个$p$值，该$p$值反映了反对无体细胞信号之原假设的证据。必须使用Benjamini–Hochberg (BH)程序，在目标水平$q=0.1$（以小数表示）下，通过控制假发现率（FDR）来校正多重检验。除了统计显著性外，您还将通过对read支持度和等位基因信号应用实用性筛选条件来解释最终的检出集：一个变异被检出，当且仅当它具有BH显著性，并且满足最小肿瘤read深度和最小变异等位基因频率（VAF）。BH方法应从假设检验和FDR控制的基本定义推导得出，而不是在没有论证的情况下调用任何快捷公式。\n\n推导的基本依据：\n- 在原假设下，对于一个有效的检验，其$p$值在$[0,1]$上随机地至少是均匀分布的；对于连续型检验，其$p$值在$[0,1]$上是均匀分布的。\n- 假发现率（FDR）是在所有被拒绝的假设中，假阳性（错误拒绝）所占的期望比例。\n- Benjamini–Hochberg (BH) 升阶程序通过对$p$值进行排序并选择一个依赖于数据的截断值，来在独立性或正相关性条件下控制FDR。\n\n任务：\n1. 给定$n$个假设（变异）的$p$值数组$\\{p_i\\}_{i=1}^n$，计算BH校正后的$p$值。对于每个假设$i$，其校正后的$p$值代表了BH方法会拒绝该假设的最小FDR水平。\n2. 对每个假设，在$q=0.1$的水平下，确定其BH显著性（以布尔值决策表示）。\n3. 对每个测试用例，解释其最终的检出集。如果一个变异的BH显著性决策为真，并且同时满足两个筛选条件：肿瘤read深度$d_i \\ge d_{\\min}$和变异等位基因频率$f_i \\ge f_{\\min}$（其中$d_{\\min}=30$，$f_{\\min}=0.05$（小数形式）），则将其标记为“已检出”。\n\n角度单位不适用，也不需要物理单位。诸如FDR目标之类的百分比量必须始终以小数形式表示。\n\n测试套件：\n使用以下测试用例，每个用例由三个列表指定：$p$值、肿瘤read深度和变异等位基因频率（VAF）。最小深度$d_{\\min}=30$和最小VAF $f_{\\min}=0.05$适用于所有用例，BH目标为$q=0.1$。\n\n- A用例（一般情况，未排序且数量级不同）： $p = [0.0008, 0.012, 0.075, 0.2, 0.0001, 0.5]$, $d = [120, 80, 45, 35, 200, 40]$, $f = [0.12, 0.08, 0.04, 0.06, 0.2, 0.03]$。\n- B用例（边界条件，包含$p=0$和$p=1$）： $p = [0.0, 1.0, 0.1, 0.05]$, $d = [500, 60, 10, 120]$, $f = [0.9, 0.01, 0.06, 0.07]$。\n- C用例（小$p$值存在并列且筛选结果混合）： $p = [0.01, 0.01, 0.01, 0.5, 0.2]$, $d = [100, 29, 35, 50, 80]$, $f = [0.04, 0.07, 0.08, 0.05, 0.12]$。\n- D用例（所有$p$值均较大，预期无发现）： $p = [0.6, 0.7, 0.8, 0.9, 1.0]$, $d = [60, 70, 80, 90, 100]$, $f = [0.2, 0.1, 0.05, 0.04, 0.03]$。\n- E用例（单一假设，边界情况$n=1$）： $p = [0.11]$, $d = [100]$, $f = [0.2]$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个包含三个列表的列表：BH校正后的$p$值（浮点数）、BH显著性决策（布尔值）和最终检出决策（布尔值）。因此，整体输出必须是一个长度为5的紧凑列表，其中第$i$个元素的格式为$[\\text{padj}_i,\\text{sign}_i,\\text{call}_i]$，打印表示中不含空格。例如，其结构为$[[\\ldots],[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$，元素之间用逗号分隔，列表用方括号括起，布尔值打印为$\\text{True}$或$\\text{False}$。",
            "solution": "我们从假设检验的核心性质和假发现率（FDR）的定义开始。对于一个有效的原假设检验，其$p$值（记为$p_i$）满足在原假设下，它在$[0,1]$上随机地至少是均匀分布的；当检验是连续的时，它在$[0,1]$上是精确均匀分布的。假发现率（FDR）定义为在所有被拒绝的假设中，错误拒绝（假阳性）所占的期望比例，这一数量用于在同时检验多个假设时控制I类错误率。\n\nBenjamini–Hochberg (BH) 程序是一种升阶法，它在独立性或某些正相关性形式的条件下，将FDR控制在目标水平$q$。其构建基础是对反对原假设的证据进行排序，并将其与依赖于排序秩次的阈值进行比较。具体来说，假设有$n$个假设，其$p$值为$\\{p_i\\}_{i=1}^n$。通过将$p$值升序排列来定义其顺序统计量：$p_{(1)} \\le p_{(2)} \\le \\cdots \\le p_{(n)}$，相应的索引为$\\{i_{(1)}, i_{(2)}, \\ldots, i_{(n)}\\}$，用于将秩次映射回原始假设。\n\nBH升阶决策规则选择满足以下条件的最大秩次$k^\\star$：\n$$\np_{(k^\\star)} \\le \\frac{k^\\star}{n} q,\n$$\n并拒绝所有秩次为$1 \\le k \\le k^\\star$的假设。该规则是通过将每个排序后的$p$值与一个线性的、非递减的阈值序列$\\frac{k}{n}q$进行比较而产生的，确保如果第$k^\\star$个排序后的$p$值满足其阈值，那么所有在它之前的（更小的）$p$值也满足它们各自的阈值。\n\n为了获得BH校正后的$p$值，我们需要对每个假设$i$求解其能被BH升阶规则拒绝的最小FDR水平。对于排序后位置为$k$的假设，该值由满足$p_{(k)} \\le \\frac{k}{n} q$的最小$q$给出，等价于$q \\ge \\frac{n}{k} p_{(k)}$。然而，由于BH的拒绝决策取决于满足该不等式的最大$k$值，并且增加$q$值不能减少拒绝集合，因此当映射回排序列表时，校正后的值在秩次上必须是单调非增的。这种单调性通过从序列$\\left\\{ \\frac{n}{k} p_{(k)} \\right\\}_{k=1}^n$的尾部开始取累积最小值来强制实现：\n$$\n\\tilde{p}_{(k)} = \\min_{j \\ge k} \\left( \\frac{n}{j} p_{(j)} \\right),\n$$\n然后通过以$1$为界，使校正后的值保持在$[0,1]$范围内：\n$$\n\\text{padj}_{(k)} = \\min\\left( 1, \\tilde{p}_{(k)} \\right).\n$$\n最后，使用排序步骤的逆置换将这些校正值返回到原始假设的顺序。然后，通过将其校正值与目标$q$进行比较，来计算假设$i$在目标$q$下的BH显著性决策：\n$$\n\\text{significant}_i = \\left( \\text{padj}_i \\le q \\right).\n$$\n\n在得出统计决策后，通过施加额外的实用性筛选条件来解释体细胞变异检出集。定义$d_i$为变异$i$的肿瘤read深度，$f_i$为变异等位基因频率（VAF），即在该位点所有肿瘤read中支持变异等位基因的read所占的比例。设置阈值$d_{\\min} = 30$和$f_{\\min} = 0.05$（以小数表示）。一个变异被“检出”，当且仅当它具有BH显著性并且同时满足两个筛选条件：\n$$\n\\text{called}_i = \\left( \\text{padj}_i \\le q \\right) \\land \\left( d_i \\ge d_{\\min} \\right) \\land \\left( f_i \\ge f_{\\min} \\right).\n$$\n\n算法设计：\n1. 对每个测试用例，获取$p$值列表并计算它们的排序索引。提取排序后的$p$值$p_{(k)}$并计算序列$s_k = \\frac{n}{k} p_{(k)}$，其中$k=1,\\ldots,n$。\n2. 计算$s_k$的反向累积最小值，即$\\tilde{s}_k = \\min_{j \\ge k} s_j$，以强制实现跨秩次的单调性。将$\\tilde{s}_k$以$1$为界得到$\\text{padj}_{(k)}$，然后通过逆置换将这些校正值映射回原始假设的顺序。\n3. 通过检查每个假设$i$是否满足$\\text{padj}_i \\le q$来确定其BH显著性。\n4. 应用筛选条件$d_{\\min}=30$和$f_{\\min}=0.05$来获得最终的检出决策：$\\text{called}_i = \\left( \\text{padj}_i \\le q \\right) \\land \\left( d_i \\ge 30 \\right) \\land \\left( f_i \\ge 0.05 \\right)$。\n5. 生成最终输出，为单行文本，包含一个有五个元素的列表，每个元素对应一个测试用例。每个元素本身是一个包含三个列表的列表：BH校正后的$p$值（浮点数）、BH显著性决策（布尔值）和最终检出决策（布尔值）。打印表示必须不含空格，用方括号和逗号分隔列表，布尔值打印为True或False。\n\n该设计直接实现了从基本定义推导出的BH程序，并为体细胞变异假设生成了一个在FDR控制下的严谨且可解释的检出集。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef bh_adjust(pvals):\n    \"\"\"\n    Compute Benjamini-Hochberg adjusted p-values.\n    Steps:\n    - Sort p-values ascending.\n    - Compute s_k = (n / k) * p_(k).\n    - Compute reverse cumulative minima to enforce monotonicity.\n    - Clip to 1.0 and map back to original order.\n    \"\"\"\n    pvals = np.asarray(pvals, dtype=float)\n    n = pvals.size\n    if n == 0:\n        return []\n    order = np.argsort(pvals)\n    ranked = pvals[order]\n    ranks = np.arange(1, n + 1, dtype=float)\n    s = (n / ranks) * ranked\n    # Reverse cumulative minimum\n    rev_cummin = np.minimum.accumulate(s[::-1])[::-1]\n    padj_sorted = np.minimum(rev_cummin, 1.0)\n    # Map back to original order\n    padj = np.empty_like(pvals)\n    padj[order] = padj_sorted\n    return padj.tolist()\n\ndef to_compact_str(obj):\n    \"\"\"\n    Serialize Python lists and primitives to a compact string with no spaces.\n    Booleans are printed as 'True' or 'False'. Floats/ints use repr().\n    \"\"\"\n    if isinstance(obj, list):\n        return \"[\" + \",\".join(to_compact_str(x) for x in obj) + \"]\"\n    elif isinstance(obj, bool):\n        return \"True\" if obj else \"False\"\n    elif isinstance(obj, (int, float, np.floating, np.integer)):\n        return repr(float(obj)) if isinstance(obj, (float, np.floating)) else repr(int(obj))\n    else:\n        # Fallback for other types\n        return repr(obj)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (p_values, depths, vafs)\n    test_cases = [\n        ([0.0008, 0.012, 0.075, 0.2, 0.0001, 0.5],\n         [120, 80, 45, 35, 200, 40],\n         [0.12, 0.08, 0.04, 0.06, 0.2, 0.03]),\n        ([0.0, 1.0, 0.1, 0.05],\n         [500, 60, 10, 120],\n         [0.9, 0.01, 0.06, 0.07]),\n        ([0.01, 0.01, 0.01, 0.5, 0.2],\n         [100, 29, 35, 50, 80],\n         [0.04, 0.07, 0.08, 0.05, 0.12]),\n        ([0.6, 0.7, 0.8, 0.9, 1.0],\n         [60, 70, 80, 90, 100],\n         [0.2, 0.1, 0.05, 0.04, 0.03]),\n        ([0.11],\n         [100],\n         [0.2]),\n    ]\n\n    # Parameters\n    q = 0.1  # FDR target level as decimal\n    d_min = 30\n    f_min = 0.05\n\n    results = []\n    for pvals, depths, vafs in test_cases:\n        padj = bh_adjust(pvals)\n        # Significance decisions\n        signif = [pv = q for pv in padj]\n        # Final calls: BH significant AND pass depth and VAF filters\n        calls = [(signif[i] and (depths[i] >= d_min) and (vafs[i] >= f_min)) for i in range(len(pvals))]\n        results.append([padj, signif, calls])\n\n    # Final print statement in the exact required format (compact, no spaces).\n    print(to_compact_str(results))\n\nsolve()\n```"
        },
        {
            "introduction": "获得一组统计上显著的变异后，下一步是进行生物学和临床解读。最后的这个实践将带你直面一个真实世界的诊断难题：如何区分一个源自肿瘤的突变和另一个源自意义未明的克隆性造血（Clonal Hematopoiesis of Indeterminate Potential, CHIP）的突变。通过构建对数似然比检验（log-likelihood ratio test），你将学习如何利用定量的$VAF$模型来做出有原则的判断，这突显了体细胞变异分析如何直接应用于临床肿瘤学的决策中。",
            "id": "4608598",
            "problem": "对一名骨髓增生性肿瘤患者的配对肿瘤和正常样本中的Janus激酶2 (JAK2) 基因上的一个基因组位点进行靶向高通量测序。目的是判断观察到的单核苷酸变异是源于造血系统的意义不明的克隆性造血 (CHIP)，还是源于癌细胞的肿瘤源性变异。使用以下基本依据：\n\n- 混合样本中的变异等位基因频率 (VAF) 由贡献DNA的细胞群混合而成，按其各自的比例、拷贝数状态以及每个细胞的突变拷贝数进行加权。\n- 某个位点上的测序读数可以建模为独立的伯努利试验，其成功概率等于样本的真实VAF，从而在给定总读数的情况下，得到一个关于变异（突变）读数的二项抽样模型。\n- 在肿瘤样本中，癌细胞的比例是肿瘤纯度 $\\pi$，剩余的 $1 - \\pi$ 比例是正常细胞。癌细胞中该位点的总拷贝数是 $C_{t}$，正常细胞中是 $C_{n} = 2$。\n- 在肿瘤源性假设下，除了测序错误（错误率为 $\\epsilon$）外，正常细胞中不存在该变异，而癌细胞中每个细胞有 $m$ 个突变拷贝。\n- 在CHIP假设下，该变异存在于一部分正常造血细胞中；在该位点上测得的有效正常样本VAF被用来代表CHIP克隆在正常DNA中的贡献。\n\n基于这些依据，通过构建对数似然比来推导一个决策规则。该对数似然比用于比较在肿瘤源性假设与CHIP假设下，观察到肿瘤和正常样本中变异读数计数的联合二项似然。然后，使用以下数据和参数对该决策规则进行数值评估：\n\n- 肿瘤总读数 $N_{t} = 800$ 和肿瘤变异读数 $A_{t} = 240$。\n- 正常样本总读数 $N_{n} = 1000$ 和正常样本变异读数 $A_{n} = 45$。\n- 肿瘤纯度 $\\pi = 0.7$。\n- 肿瘤中该位点的总拷贝数 $C_{t} = 3$。\n- 在肿瘤源性假设下，癌细胞中的突变拷贝数 $m = 1$。\n- 正常细胞拷贝数 $C_{n} = 2$。\n- 测序错误率 $\\epsilon = 1 \\times 10^{-3}$。\n\n假设在肿瘤源性假设下，变异是克隆性的肿瘤源性变异，并使用经验观察到的正常样本VAF $v_{n} = A_{n}/N_{n}$ 来参数化CHIP假设。将对数似然比的最终数值结果四舍五入到四位有效数字。将最终结果表示为一个无单位的单个实数。",
            "solution": "任务是基于对数似然比 (LLR) 推导一个决策规则，以区分肿瘤源性的体细胞变异和意义不明的克隆性造血 (CHIP)。推导出规则后，我们必须使用所提供的数据对其进行数值评估。\n\n首先，我们将统计模型形式化。在特定位点上，给定总测序读数 $N$，变异（突变）读数 $A$ 的数量被建模为一个服从二项分布的随机变量。每次读数的成功概率（即观察到突变等位基因的概率）是该位点的真实变异等位基因频率 (VAF)，我们记为 $v$。\n观察到 $N$ 个总读数中有 $A$ 个变异读数的概率质量函数由下式给出：\n$$ P(A | N, v) = \\binom{N}{A} v^{A} (1-v)^{N-A} $$\n我们有两个独立的样本：一个肿瘤样本 (t) 和一个正常样本 (n)。观测数据是读数计数 $(A_t, N_t)$ 和 $(A_n, N_n)$。给定肿瘤 ($v_t$) 和正常 ($v_n$) 样本中的VAF，数据的联合似然是各自似然的乘积：\n$$ L(A_t, A_n | N_t, N_n, v_t, v_n) = P(A_t | N_t, v_t) \\times P(A_n | N_n, v_n) $$\n\n接下来，我们在两个竞争假设（$H_{\\text{tumor}}$，即肿瘤源性变异，和 $H_{\\text{CHIP}}$，即CHIP源性变异）下定义理论VAF。混合样本中的VAF是所有细胞群贡献的突变等位基因总数与该位点上等位基因总数的比率。\n\n**假设1：肿瘤源性变异 ($H_{\\text{tumor}}$)**\n在此假设下，突变仅存在于癌细胞中。\n肿瘤样本是癌细胞（比例为 $\\pi$）和正常细胞（比例为 $1-\\pi$）的混合物。癌细胞中的总拷贝数是 $C_t$，正常细胞中的是 $C_n$。每个癌细胞中有 $m$ 个拷贝带有该突变。正常细胞不携带该突变。\n肿瘤样本中的预期VAF，$v_{t, \\text{tumor}}$，是来自癌细胞的突变等位基因与来自癌细胞和正常细胞的总等位基因的比率：\n$$ v_{t, \\text{tumor}} = \\frac{\\pi \\cdot m}{\\pi C_t + (1-\\pi) C_n} $$\n在正常样本中，该变异不存在。任何观察到的变异读数都假定是由于测序错误造成的，其错误率为 $\\epsilon$。因此，正常样本中的预期VAF是：\n$$ v_{n, \\text{tumor}} = \\epsilon $$\n\n**假设2：CHIP变异 ($H_{\\text{CHIP}}$)**\n在此假设下，突变起源于造血（正常）系统，而在肿瘤细胞中不存在。正常造血细胞中这个克隆群体的VAF记为 $v_{\\text{CHIP}}$。题目要求使用从正常样本中经验观察到的VAF来估计这个参数。\n$$ v_{\\text{CHIP}} = \\frac{A_n}{N_n} $$\n因此，正常样本中的预期VAF，$v_{n, \\text{CHIP}}$，被设定为这个经验观察值：\n$$ v_{n, \\text{CHIP}} = \\frac{A_n}{N_n} $$\n在肿瘤样本中，突变仅存在于混入的正常细胞中（比例为 $1-\\pi$）。这个正常细胞群体中突变的VAF是 $v_{\\text{CHIP}}$。来自正常细胞部分的等位基因总数与 $(1-\\pi)C_n$ 成正比，突变等位基因的数量与 $(1-\\pi)C_n v_{\\text{CHIP}}$ 成正比。混合肿瘤样本中的总等位基因数与 $\\pi C_t + (1-\\pi) C_n$ 成正比。因此，肿瘤样本中的预期VAF是：\n$$ v_{t, \\text{CHIP}} = \\frac{(1-\\pi) C_n v_{\\text{CHIP}}}{\\pi C_t + (1-\\pi) C_n} $$\n\n**对数似然比 (LLR) 决策规则**\n决策规则基于LLR，它比较了在 $H_{\\text{tumor}}$ 和 $H_{\\text{CHIP}}$ 假设下观测数据的似然。\n$$ \\text{LLR} = \\ln\\left(\\frac{L(\\text{data} | H_{\\text{tumor}})}{L(\\text{data} | H_{\\text{CHIP}})}\\right) = \\ln(L(\\text{data} | H_{\\text{tumor}})) - \\ln(L(\\text{data} | H_{\\text{CHIP}})) $$\n给定假设 $H$ 的对数似然为：\n$$ \\ln(L(H)) = \\ln\\binom{N_t}{A_t} + A_t \\ln(v_t) + (N_t-A_t)\\ln(1-v_t) + \\ln\\binom{N_n}{A_n} + A_n \\ln(v_n) + (N_n-A_n)\\ln(1-v_n) $$\n在计算LLR时，二项式系数项 $\\ln\\binom{N_t}{A_t}$ 和 $\\ln\\binom{N_n}{A_n}$ 对于两个假设是相同的，因此会抵消。LLR简化为：\n$$ \\text{LLR} = \\left[ A_t \\ln(v_{t, \\text{tumor}}) + (N_t - A_t) \\ln(1 - v_{t, \\text{tumor}}) \\right] - \\left[ A_t \\ln(v_{t, \\text{CHIP}}) + (N_t - A_t) \\ln(1 - v_{t, \\text{CHIP}}) \\right] \\\\ + \\left[ A_n \\ln(v_{n, \\text{tumor}}) + (N_n - A_n) \\ln(1 - v_{n, \\text{tumor}}) \\right] - \\left[ A_n \\ln(v_{n, \\text{CHIP}}) + (N_n - A_n) \\ln(1 - v_{n, \\text{CHIP}}) \\right] $$\n这可以按样本分组：\n$$ \\text{LLR} = \\left[ A_t \\ln\\left(\\frac{v_{t, \\text{tumor}}}{v_{t, \\text{CHIP}}}\\right) + (N_t - A_t) \\ln\\left(\\frac{1 - v_{t, \\text{tumor}}}{1 - v_{t, \\text{CHIP}}}\\right) \\right] + \\left[ A_n \\ln\\left(\\frac{v_{n, \\text{tumor}}}{v_{n, \\text{CHIP}}}\\right) + (N_n - A_n) \\ln\\left(\\frac{1 - v_{n, \\text{tumor}}}{1 - v_{n, \\text{CHIP}}}\\right) \\right] $$\n\n**数值评估**\n我们得到以下数据：\n- 肿瘤读数：$N_t = 800$, $A_t = 240$。\n- 正常样本读数：$N_n = 1000$, $A_n = 45$。\n- 肿瘤纯度：$\\pi = 0.7$。\n- 肿瘤拷贝数：$C_t = 3$。\n- 癌细胞突变拷贝数：$m = 1$。\n- 正常细胞拷贝数：$C_n = 2$。\n- 测序错误率：$\\epsilon = 1 \\times 10^{-3} = 0.001$。\n\n首先，我们计算肿瘤样本中VAF的分母：\n$$ \\pi C_t + (1-\\pi) C_n = (0.7)(3) + (1-0.7)(2) = 2.1 + (0.3)(2) = 2.1 + 0.6 = 2.7 $$\n\n现在，我们计算每个假设的VAF：\n在 $H_{\\text{tumor}}$ 假设下：\n$$ v_{t, \\text{tumor}} = \\frac{0.7 \\times 1}{2.7} = \\frac{0.7}{2.7} = \\frac{7}{27} $$\n$$ v_{n, \\text{tumor}} = 0.001 $$\n\n在 $H_{\\text{CHIP}}$ 假设下：\n首先，计算 $v_{\\text{CHIP}}$：\n$$ v_{\\text{CHIP}} = \\frac{A_n}{N_n} = \\frac{45}{1000} = 0.045 $$\n然后，计算CHIP假设下的预期VAF：\n$$ v_{n, \\text{CHIP}} = 0.045 $$\n$$ v_{t, \\text{CHIP}} = \\frac{(1-0.7) \\times 2 \\times 0.045}{2.7} = \\frac{0.3 \\times 2 \\times 0.045}{2.7} = \\frac{0.027}{2.7} = 0.01 $$\n\n我们现在可以将这些值代入LLR公式。\nLLR是来自肿瘤样本的LLR ($LLR_t$) 和来自正常样本的LLR ($LLR_n$) 的总和。\n\n对于肿瘤样本 ($A_t=240, N_t-A_t=560$)：\n$$ LLR_t = 240 \\ln\\left(\\frac{7/27}{0.01}\\right) + 560 \\ln\\left(\\frac{1 - 7/27}{1 - 0.01}\\right) = 240 \\ln\\left(\\frac{700}{27}\\right) + 560 \\ln\\left(\\frac{20/27}{0.99}\\right) = 240 \\ln\\left(\\frac{700}{27}\\right) + 560 \\ln\\left(\\frac{2000}{2673}\\right) $$\n$$ LLR_t \\approx 240 \\times (3.255243) + 560 \\times (-0.290054) \\approx 781.258 - 162.430 = 618.828 $$\n\n对于正常样本 ($A_n=45, N_n-A_n=955$)：\n$$ LLR_n = 45 \\ln\\left(\\frac{0.001}{0.045}\\right) + 955 \\ln\\left(\\frac{1-0.001}{1-0.045}\\right) = 45 \\ln\\left(\\frac{1}{45}\\right) + 955 \\ln\\left(\\frac{0.999}{0.955}\\right) $$\n$$ LLR_n \\approx 45 \\times (-3.806662) + 955 \\times (0.045045) \\approx -171.300 + 43.018 = -128.282 $$\n\n总LLR是这两个分量的和：\n$$ \\text{LLR} = LLR_t + LLR_n \\approx 618.828 - 128.282 = 490.546 $$\n\n正的LLR表示数据在肿瘤源性假设 ($H_{\\text{tumor}}$) 下比在CHIP假设 ($H_{\\text{CHIP}}$) 下更有可能。大的正值提供了强有力的证据，支持该变异是肿瘤源性的。\n\n将最终数值答案四舍五入到四位有效数字，得到 $490.5$。",
            "answer": "$$\\boxed{490.5}$$"
        }
    ]
}