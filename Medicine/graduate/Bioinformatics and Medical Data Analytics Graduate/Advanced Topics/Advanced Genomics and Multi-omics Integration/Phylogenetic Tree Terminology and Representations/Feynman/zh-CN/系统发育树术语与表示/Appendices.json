{
    "hands_on_practices": [
        {
            "introduction": "在生物信息学中，Newick 格式是交换和表示系统发育树的通用语言，能够熟练地解析它是任何研究人员的基础技能。本练习 () 提供了一个从头开始的机会，通过将一个标准的 Newick 字符串手动转换为一个明确的图结构，包括其邻接列表、分支长度和所引导的分裂，来深入理解系统发育树的内在构造。",
            "id": "4594051",
            "problem": "给定一个叶节点集为 $\\{A,B,C,D\\}$ 的有根系统发育树，它由 Newick 格式的字符串 \"((A:0.1,B:0.2):0.3,(C:0.15,D:0.15):0.25);\" 表示。请使用 Newick 格式和系统发育分裂的基本定义执行以下步骤。首先，形式化解析该字符串，生成一个明确的有根树，其邻接表指定了父-子边及其分支长度。其次，推导移除树中每条边所引发的二分分裂集合，区分平凡分裂（即隔离单个叶节点的分裂）和非平凡分裂（即将叶节点集划分为两个大小至少为二的子集的分裂）。第三，从基本原理出发，验证在 Newick 表示法中，每个分支长度都附属于树中的一条父-子边，而不是节点本身。最后，计算总树长，定义为解析出的树中所有边的分支长度之和。假设分支长度以每位点预期替换数来衡量，并以每位点替换数表示最终的树长。提供精确的最终数值，无需四舍五入。",
            "solution": "问题陈述经评估为有效。它在科学上基于生物信息学和系统发育分析的既定原则，特别是关于 Newick 树格式的原则。该问题是良构的，提供了一个完整且无歧义的 Newick 字符串，对应一棵唯一的有根树。所有任务都定义明确，并导向一个单一、可验证的解。\n\n按照要求，解答过程分四个阶段进行。\n\n**第一步：将 Newick 字符串解析为显式树结构**\n\n给定的 Newick 字符串为 `\"((A:0.1,B:0.2):0.3,(C:0.15,D:0.15):0.25);\"`。叶节点集为 $L = \\{A, B, C, D\\}$。此字符串代表一棵有根二叉树。我们可以通过识别节点和连接它们的边来解析此结构。为了清晰起见，我们对内部节点进行命名。\n令 $I_1$ 为叶节点 $A$ 和 $B$ 的父节点。\n令 $I_2$ 为叶节点 $C$ 和 $D$ 的父节点。\n令 $R$ 为树的根节点，它是内部节点 $I_1$ 和 $I_2$ 的父节点。\n\nNewick 格式 `(X:lx, Y:ly)` 定义了子节点 $X$ 和 $Y$ 的一个父节点，其中 $lx$ 和 $ly$ 分别是连接父节点到 $X$ 和 $Y$ 的分支（边）的长度。像 `(..):lz` 这样的结构表示由括号定义的内部节点通过一条长度为 $lz$ 的边连接到其自身的父节点。\n\n遵循此语法：\n- 片段 `(A:0.1,B:0.2)` 意味着存在一个内部节点 $I_1$，使得边 $(I_1, A)$ 的长度为 $0.1$，边 $(I_1, B)$ 的长度为 $0.2$。\n- 片段 `(C:0.15,D:0.15)` 意味着存在一个内部节点 $I_2$，使得边 $(I_2, C)$ 的长度为 $0.15$，边 $(I_2, D)$ 的长度为 $0.15$。\n- 更大的结构 `((...):0.3,(...):0.25)` 定义了根节点 $R$。片段 `(...):0.3` 指的是支系 `(A,B)`，因此连接其父节点 $I_1$ 到根节点 $R$ 的边，即边 $(R, I_1)$，长度为 $0.3$。类似地，片段 `(...):0.25` 指的是支系 `(C,D)`，因此连接其父节点 $I_2$ 到根节点 $R$ 的边，即边 $(R, I_2)$，长度为 $0.25$。\n\n该树有 $3$ 个内部节点 ($R, I_1, I_2$) 和 $4$ 个叶节点 ($A, B, C, D$)。一个有 $n$ 个叶节点的有根树的总边数为 $2n-2$。对于 $n=4$，有 $2(4)-2=6$ 条边。\n\n得到的带有分支长度的父-子邻接表如下：\n1.  边 $(R, I_1)$，长度 $l(R, I_1) = 0.3$。\n2.  边 $(R, I_2)$，长度 $l(R, I_2) = 0.25$。\n3.  边 $(I_1, A)$，长度 $l(I_1, A) = 0.1$。\n4.  边 $(I_1, B)$，长度 $l(I_1, B) = 0.2$。\n5.  边 $(I_2, C)$，长度 $l(I_2, C) = 0.15$。\n6.  边 $(I_2, D)$，长度 $l(I_2, D) = 0.15$。\n\n**第二步：推导二分分裂**\n\n叶节点集 $L$ 的一个二分分裂是将 $L$ 划分为两个非空、不相交的子集，且这两个子集的并集为 $L$。系统发育树中的每条边通过“切断”该边来引发一个分裂，这将叶节点划分为两个集合。我们为已识别的 6 条边推导分裂。\n\n-   **边 $(I_1, A)$：** 移除此边将叶节点 $A$ 与树的其余部分分开。一侧的叶节点是 $\\{A\\}$，另一侧是 $\\{B, C, D\\}$。这引发了分裂 $\\{\\{A\\}, \\{B, C, D\\}\\}$。这是一个**平凡**分裂，因为其中一个分区只包含一个叶节点。\n-   **边 $(I_1, B)$：** 移除此边隔离了叶节点 $B$。这引发了分裂 $\\{\\{B\\}, \\{A, C, D\\}\\}$。这也是一个**平凡**分裂。\n-   **边 $(I_2, C)$：** 移除此边隔离了叶节点 $C$。这引发了分裂 $\\{\\{C\\}, \\{A, B, D\\}\\}$。这是一个**平凡**分裂。\n-   **边 $(I_2, D)$：** 移除此边隔离了叶节点 $D$。这引发了分裂 $\\{\\{D\\}, \\{A, B, C\\}\\}$。这是一个**平凡**分裂。\n-   **边 $(R, I_1)$：** 移除此边将以 $I_1$ 为根的子树与树的其余部分分开。以 $I_1$ 为根的子树中的叶节点是 $\\{A, B\\}$。其余的叶节点是 $\\{C, D\\}$。这引发了分裂 $\\{\\{A, B\\}, \\{C, D\\}\\}$。这是一个**非平凡**分裂，因为两个子集的大小都至少为 $2$。\n-   **边 $(R, I_2)$：** 移除此边分离了以 $I_2$ 为根的子树。此子树中的叶节点是 $\\{C, D\\}$，其余的叶节点是 $\\{A, B\\}$。这引发了分裂 $\\{\\{C, D\\}, \\{A, B\\}\\}$。由于分裂中集合的顺序无关紧要，这与由边 $(R, I_1)$ 引发的非平凡分裂完全相同。\n\n总而言之，该树有 $5$ 个唯一的分裂：$4$ 个对应于末端边的平凡分裂，和 $1$ 个对应于从根节点向下的内部边的非平凡分裂。\n\n**第三步：验证分支长度的放置**\n\nNewick 格式有严格的语法，其中分支长度总是与边相关联，而不是节点。通用形式是 `(subtrees)name:length`。\n-   当一个元素是叶节点时，例如 `A:0.1`，长度 $0.1$ 被明确地分配给连接叶节点 `A` 与其父节点（在此例中为 $I_1$）的分支。\n-   当一个元素是代表内部节点的括号组时，例如 `(A:0.1,B:0.2):0.3`，长度 $0.3$ 被分配给连接此内部节点（$A$ 和 $B$ 的共同祖先，我们标记为 $I_1$）与其父节点（根节点 $R$）的分支。\n\n在这两种语法情境中，冒号（`:`）后面的数字代表从父节点到冒号紧左侧描述的节点（或节点组）的边的长度。一个节点代表一个分歧点（一个祖先），它在时间或状态上是一个无穷小的点。一个分支代表两个节点（祖先和后代）之间的进化谱系，正是这条路径具有可量化的长度（例如，时间或预期的替换数）。因此，从 Newick 格式定义的基本原理来看，分支长度根本上是边（父-子连接）的属性，而不是节点本身的属性。\n\n**第四步：计算总树长**\n\n总树长定义为树中所有分支长度的总和。使用第一步中从 Newick 字符串提取的分支长度，我们将它们相加：\n- 从 $I_1$ 到 $A$ 的长度：$0.1$\n- 从 $I_1$ 到 $B$ 的长度：$0.2$\n- 从 $I_2$ 到 $C$ 的长度：$0.15$\n- 从 $I_2$ 到 $D$ 的长度：$0.15$\n- 从 $R$ 到 $I_1$ 的长度：$0.3$\n- 从 $R$ 到 $I_2$ 的长度：$0.25$\n\n总树长 $L_{total}$ 是这些值的总和：\n$$L_{total} = 0.1 + 0.2 + 0.15 + 0.15 + 0.3 + 0.25$$\n$$L_{total} = (0.1 + 0.2) + (0.15 + 0.15) + (0.3 + 0.25)$$\n$$L_{total} = 0.3 + 0.3 + 0.55$$\n$$L_{total} = 1.15$$\n单位是每位点替换数，如问题所述。最终的数值是 $1.15$。",
            "answer": "$$\\boxed{1.15}$$"
        },
        {
            "introduction": "在系统发育分析的实践中，我们经常会遇到由不同数据集或方法生成的相互竞争的树拓扑。为了客观地评估它们之间的一致性，我们需要一种定量的方法来衡量它们的差异。本练习 () 侧重于 Robinson-Foulds (RF) 距离——一种通过比较树的分裂集来量化拓扑不一致性的标准度量，让您能够识别和解释不同系统发育假说之间的具体冲突。",
            "id": "4594075",
            "problem": "一项呼吸道病毒的临床测序研究从 $5$ 名患者中获得了标记为 $A$、$B$、$C$、$D$ 和 $E$ 的分离株。两个独立的推断流程提出了关于共同分类单元集 $X=\\{A,B,C,D,E\\}$ 的两个候选无根、完全解析的系统发育假说。每个无根树都可以用其内部边所引导的非平凡二分分裂（也称为 Buneman 分裂）的集合来表示。第一个流程生成一棵树 $T_{1}$，其具有以下非平凡分裂：\n- $\\{A,B\\}\\mid\\{C,D,E\\}$，\n- $\\{D,E\\}\\mid\\{A,B,C\\}$。\n第二个流程生成一棵树 $T_{2}$，其具有以下非平凡分裂：\n- $\\{A,B\\}\\mid\\{C,D,E\\}$，\n- $\\{C,E\\}\\mid\\{A,B,D\\}$。\n仅使用系统发育学和集合论的基本定义，包括 Robinson–Foulds (RF) 距离的定义，即对于具有相同叶集合的两个无根树，该距离计算存在于一棵树中但不存在于另一棵树中的非平凡分裂的数量，完成以下任务：\n- 通过比较它们的分裂集合，计算 Robinson–Foulds (RF) 距离 $d_{\\mathrm{RF}}(T_{1},T_{2})$。\n- 确定在 $T_{1}$ 和 $T_{2}$ 之间哪些分支（即由分裂定义的叶分组）是共享的，哪些是冲突的。\n- 从分裂比较的基本原理出发，简要论证为什么在此示例中 RF 距离不能对“近似”分支和完全不同的分支给予不同的权重。\n将 $d_{\\mathrm{RF}}(T_{1},T_{2})$ 报告为精确整数。无需四舍五入，也无需使用单位。",
            "solution": "首先验证问题的科学性和逻辑一致性。\n\n**步骤 1：提取已知信息**\n- 分类单元集：$X=\\{A,B,C,D,E\\}$。分类单元的数量为 $n=5$。\n- 树是无根且完全解析的。一个包含 $n$ 个分类单元的完全解析的无根树有 $n-3$ 条内部边，每条边定义一个非平凡分裂。对于 $n=5$，有 $5-3=2$ 个非平凡分裂。\n- 树 $T_{1}$ 由其非平凡分裂集合 $\\mathcal{S}(T_{1})$ 定义。设 $S_{1,1} = \\{A,B\\}\\mid\\{C,D,E\\}$ 和 $S_{1,2} = \\{D,E\\}\\mid\\{A,B,C\\}$。那么 $\\mathcal{S}(T_{1}) = \\{S_{1,1}, S_{1,2}\\}$。\n- 树 $T_{2}$ 由其非平凡分裂集合 $\\mathcal{S}(T_{2})$ 定义。设 $S_{2,1} = \\{A,B\\}\\mid\\{C,D,E\\}$ 和 $S_{2,2} = \\{C,E\\}\\mid\\{A,B,D\\}$。那么 $\\mathcal{S}(T_{2}) = \\{S_{2,1}, S_{2,2}\\}$。\n- Robinson–Foulds (RF) 距离的定义，$d_{\\mathrm{RF}}(T_{1},T_{2})$：存在于一棵树中但不存在于另一棵树中的非平凡分裂的数量。\n- 任务是计算 $d_{\\mathrm{RF}}(T_{1},T_{2})$，确定共享和冲突的分支，并解释 RF 度量的一个性质。\n\n**步骤 2：使用提取的已知信息进行验证**\n问题具有科学依据，使用了生物信息学和系统发育学中的标准定义和概念（无根树、二分分裂、Robinson-Foulds 距离）。为每棵树提供的分裂数量（$2$）与具有 $n=5$ 个分类单元的完全解析无根树的公式 $n-3$ 一致。问题提法明确、客观，并包含足够的信息以得出唯一解。它没有违反任何无效标准。\n\n**步骤 3：结论和行动**\n问题有效。将提供解答。\n\n**解答推导**\n\n问题要求基于所提供的两棵系统发育树 $T_1$ 和 $T_2$ 的分裂表示进行三部分分析。\n\n**第一部分：Robinson–Foulds 距离的计算**\n\nRobinson–Foulds 距离 $d_{\\mathrm{RF}}(T_{1},T_{2})$ 定义为两棵树的非平凡分裂集合之间的对称差的大小。两个集合 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的对称差由 $|\\mathcal{A} \\Delta \\mathcal{B}| = |(\\mathcal{A} \\setminus \\mathcal{B}) \\cup (\\mathcal{B} \\setminus \\mathcal{A})|$ 给出。这等同于计算存在于任一集合中但不在其交集中的元素数量。\n\n给定的分裂集合是：\n$$ \\mathcal{S}(T_{1}) = \\{ \\{A,B\\}\\mid\\{C,D,E\\}, \\{D,E\\}\\mid\\{A,B,C\\} \\} $$\n$$ \\mathcal{S}(T_{2}) = \\{ \\{A,B\\}\\mid\\{C,D,E\\}, \\{C,E\\}\\mid\\{A,B,D\\} \\} $$\n\n一个分裂是分类单元集 $X$ 的一个二划分。表示 $\\{X_1\\}\\mid\\{X_2\\}$ 等价于 $\\{X_2\\}\\mid\\{X_1\\}$。我们比较 $\\mathcal{S}(T_{1})$ 和 $\\mathcal{S}(T_{2})$ 中的分裂以找到交集 $\\mathcal{S}(T_{1}) \\cap \\mathcal{S}(T_{2})$。\n\n- $\\mathcal{S}(T_{1})$ 中的第一个分裂是 $S_{1,1} = \\{A,B\\}\\mid\\{C,D,E\\}$。\n- $\\mathcal{S}(T_{2})$ 中的第一个分裂是 $S_{2,1} = \\{A,B\\}\\mid\\{C,D,E\\}$。\n这两个分裂是相同的。因此，$S_{1,1} = S_{2,1}$ 在交集中。\n\n- $\\mathcal{S}(T_{1})$ 中的第二个分裂是 $S_{1,2} = \\{D,E\\}\\mid\\{A,B,C\\}$。\n- $\\mathcal{S}(T_{2})$ 中的第二个分裂是 $S_{2,2} = \\{C,E\\}\\mid\\{A,B,D\\}$。\n这两个分裂不相同。分类单元分组是不同的。\n\n因此，两个分裂集合的交集是：\n$$ \\mathcal{S}(T_{1}) \\cap \\mathcal{S}(T_{2}) = \\{ \\{A,B\\}\\mid\\{C,D,E\\} \\} $$\n\n存在于 $\\mathcal{S}(T_{1})$ 但不存在于 $\\mathcal{S}(T_{2})$ 中的分裂集合是：\n$$ \\mathcal{S}(T_{1}) \\setminus \\mathcal{S}(T_{2}) = \\{ \\{D,E\\}\\mid\\{A,B,C\\} \\} $$\n这个集合的大小是 $|\\mathcal{S}(T_{1}) \\setminus \\mathcal{S}(T_{2})| = 1$。\n\n存在于 $\\mathcal{S}(T_{2})$ 但不存在于 $\\mathcal{S}(T_{1})$ 中的分裂集合是：\n$$ \\mathcal{S}(T_{2}) \\setminus \\mathcal{S}(T_{1}) = \\{ \\{C,E\\}\\mid\\{A,B,D\\} \\} $$\n这个集合的大小是 $|\\mathcal{S}(T_{2}) \\setminus \\mathcal{S}(T_{1})| = 1$。\n\nRobinson–Foulds 距离是这两个集合大小之和：\n$$ d_{\\mathrm{RF}}(T_{1},T_{2}) = |\\mathcal{S}(T_{1}) \\setminus \\mathcal{S}(T_{2})| + |\\mathcal{S}(T_{2}) \\setminus \\mathcal{S}(T_{1})| = 1 + 1 = 2 $$\n\n**第二部分：共享和冲突的分支**\n\n在此上下文中，“分支”或“叶分组”指的是由一个分裂定义的分类单元子集。\n\n- **共享分支：** 两棵树共有的唯一分裂是 $\\{A,B\\}\\mid\\{C,D,E\\}$。这意味着两个系统发育假说 $T_1$ 和 $T_2$ 都同意分类单元 $A$ 和 $B$ 形成一个单系群，排除了 $C$、$D$ 和 $E$。相应的共享分支（叶分组）是 $\\{A,B\\}$ 及其补集 $\\{C,D,E\\}$。\n\n- **冲突分支：** 冲突源于不共享的分裂。\n  - $T_1$ 提出了分裂 $\\{D,E\\}\\mid\\{A,B,C\\}$。这个假说支持分支 $\\{D,E\\}$ 的存在。\n  - $T_2$ 提出了分裂 $\\{C,E\\}\\mid\\{A,B,D\\}$。这个假说支持分支 $\\{C,E\\}$ 的存在。\n这两个命题是相互冲突的。在 $T_1$ 中，$E$ 与 $D$ 的关系最密切。在 $T_2$ 中，$E$ 与 $C$ 的关系最密切。由于树是完全解析的，这两个分组是互斥的。冲突的分支是 $\\{D,E\\}$（来自 $T_1$）和 $\\{C,E\\}$（来自 $T_2$）。\n\n**第三部分：关于 RF 距离缺乏权重的论证**\n\nRobinson-Foulds 距离本质上是一种基于集合论的度量，具体来说是基于两个集合中元素的同一性。每个分裂都是一棵树的分裂集合中的一个元素。两个分裂之间的比较是二元的：它们要么相同，要么不同。没有部分得分或相似性的概念。\n\n在本例中，冲突的分裂是来自 $T_1$ 的 $S_{1,2} = \\{D,E\\}\\mid\\{A,B,C\\}$ 和来自 $T_2$ 的 $S_{2,2} = \\{C,E\\}\\mid\\{A,B,D\\}$。它们定义的分支 $\\{D,E\\}$ 和 $\\{C,E\\}$ 可以被认为是“近似”，因为它们仅相差一个分类单元（一个用 $D$ 替换了 $C$）。一个直观的相似性度量可能会将它们评为非常接近。\n\n然而，RF 度量并不在这种细节层面上操作。它将每个分裂视为一个不可分割的整体。在比较 $\\mathcal{S}(T_1)$ 和 $\\mathcal{S}(T_2)$ 时，算法检查每个分裂是否存在。由于代表 $S_{1,2}$ 的集合对象与代表 $S_{2,2}$ 的集合对象不相同，它们被计为两个不同的实体。分裂 $S_{1,2}$ 在 $\\mathcal{S}(T_2)$ 中不存在，分裂 $S_{2,2}$ 在 $\\mathcal{S}(T_1)$ 中不存在。每一次缺失都对总距离贡献了 $1$，总计为 $2$。\n\n如果 $T_2$ 中的冲突分裂是 $\\{C,D\\}\\mid\\{A,B,E\\}$，它定义了一个分支 $\\{C,D\\}$，该分支除了 $D$ 之外与 $\\{D,E\\}$ 没有任何共同的分类单元，那么 RF 距离将得出完全相同的值 $2$。该度量对非相同分裂之间的分类单元重叠程度不敏感。其计算完全基于集合元素同一性的原则，其中每个非共享分裂对距离的贡献相等，而不管其与另一棵树中任何分裂的拓扑或组成相似性如何。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}