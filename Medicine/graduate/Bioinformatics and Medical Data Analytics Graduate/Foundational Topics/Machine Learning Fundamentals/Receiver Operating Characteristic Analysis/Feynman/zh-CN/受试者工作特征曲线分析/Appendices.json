{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握受试者工作特征（ROC）分析，第一步是理解如何从原始分类器分数手动构建ROC曲线。这个练习将指导您完成从一组给定的患病和非患病样本分数构建经验ROC曲线的全过程，并计算曲线下面积（AUC）。通过这种基础性的实践，您将不再将AUC仅仅看作一个黑盒指标，而是能深入理解其几何构造及其与决策阈值选择的内在联系。",
            "id": "4918235",
            "problem": "一项医学影像中的二元诊断任务使用受试者工作特征（ROC）分析进行评估。一个分类器产生在区间 $[0,1]$ 内的连续置信度分数，这些分数反映了患病的可能性。对于一个阈值 $\\tau$，决策规则是：如果影像的分数 $\\ge \\tau$，则判定为阳性（患病），否则判定为阴性（未患病）。在阈值 $\\tau$ 下，真阳性率（$\\mathrm{TPR}$，灵敏度）定义为被判定为阳性的患病病例的比例，而假阳性率（$\\mathrm{FPR}$，1-特异度）是被判定为阳性的未患病病例的比例。\n\n给定三个患病病例的分数 $\\{0.3,\\,0.6,\\,0.9\\}$ 和四个未患病病例的分数 $\\{0.1,\\,0.2,\\,0.4,\\,0.8\\}$。使用上述经验性定义：\n\n1) 通过枚举从给定分数的并集中选取的所有唯一阈值 $\\tau$，并辅以端点约定 $\\tau\\max$（没有病例为阳性）和 $\\tau\\le\\min$（所有病例为阳性），来构建经验ROC曲线。对于每个阈值，计算对应的点 $(\\mathrm{FPR},\\,\\mathrm{TPR})$。\n\n2) 根据经验ROC曲线，通过对沿$\\mathrm{FPR}$轴的连续点之间形成的梯形面积求和，计算曲线下面积（AUC）。\n\n将最终的AUC表示为一个精确的分数。无需单位。",
            "solution": "问题陈述已经过验证，具有科学依据、提法恰当且客观。它代表了在评估二元分类器时，受试者工作特征（ROC）分析的一个标准应用。所有必要的数据和定义都已提供并且内部一致。因此，我们可以开始求解。\n\n该问题要求针对一组给定的分类器分数，构建一条经验ROC曲线并计算其曲线下面积（AUC）。\n\n首先，我们确定给定的信息。患病病例的分数集合为 $S_D = \\{0.3, 0.6, 0.9\\}$，患病病例数为 $N_D = 3$。未患病病例的分数集合为 $S_{ND} = \\{0.1, 0.2, 0.4, 0.8\\}$，未患病病例数为 $N_{ND} = 4$。\n\n将决策阈值 $\\tau$ 应用于这些分数。如果一个病例的分数大于或等于 $\\tau$，则该病例被分类为阳性。\n真阳性率 $\\mathrm{TPR}(\\tau)$ 是分数 $\\ge \\tau$ 的患病病例所占的比例：\n$$ \\mathrm{TPR}(\\tau) = \\frac{|\\{s \\in S_D \\mid s \\ge \\tau\\}|}{N_D} $$\n假阳性率 $\\mathrm{FPR}(\\tau)$ 是分数 $\\ge \\tau$ 的未患病病例所占的比例：\n$$ \\mathrm{FPR}(\\tau) = \\frac{|\\{s \\in S_{ND} \\mid s \\ge \\tau\\}|}{N_{ND}} $$\nROC曲线是针对所有可能的阈值 $\\tau$，绘制的 $\\mathrm{TPR}$ 相对于 $\\mathrm{FPR}$ 的图。\n\n第1部分：构建经验ROC曲线。\n经验ROC曲线的顶点是通过考虑以给定分数值为阈值而生成的。一个标准方法是将所有分数按降序排序，然后将阈值依次降低并越过每个分数。这会在$\\mathrm{FPR}$-$\\mathrm{TPR}$平面上生成一条路径。\n合并后的分数集，按其类别（D代表患病，ND代表未患病）降序排列如下：\n$0.9(\\text{D}), 0.8(\\text{ND}), 0.6(\\text{D}), 0.4(\\text{ND}), 0.3(\\text{D}), 0.2(\\text{ND}), 0.1(\\text{ND})$\n\n曲线从点 $(0, 0)$ 开始，这对应于阈值 $\\tau  0.9$，此时没有病例被分类为阳性。随着阈值的降低，每遇到一个患病病例，曲线向上移动一个步长，大小为 $\\frac{1}{N_D} = \\frac{1}{3}$。每遇到一个未患病病例，曲线向右移动一个步长，大小为 $\\frac{1}{N_{ND}} = \\frac{1}{4}$。\n\n设ROC曲线上的有序点为 $(x_i, y_i)$，其中 $x_i = \\mathrm{FPR}$，$y_i = \\mathrm{TPR}$。\n1.  从点 $p_0 = (x_0, y_0) = (0, 0)$ 开始。\n2.  最高分是 $0.9$，来自一个患病病例。曲线上移。 $p_1 = (0, 0 + \\frac{1}{3}) = (0, \\frac{1}{3})$。\n3.  下一个分数是 $0.8$，来自一个未患病病例。曲线右移。 $p_2 = (0 + \\frac{1}{4}, \\frac{1}{3}) = (\\frac{1}{4}, \\frac{1}{3})$。\n4.  下一个分数是 $0.6$，来自一个患病病例。曲线上移。 $p_3 = (\\frac{1}{4}, \\frac{1}{3} + \\frac{1}{3}) = (\\frac{1}{4}, \\frac{2}{3})$。\n5.  下一个分数是 $0.4$，来自一个未患病病例。曲线右移。 $p_4 = (\\frac{1}{4} + \\frac{1}{4}, \\frac{2}{3}) = (\\frac{1}{2}, \\frac{2}{3})$。\n6.  下一个分数是 $0.3$，来自一个患病病例。曲线上移。 $p_5 = (\\frac{1}{2}, \\frac{2}{3} + \\frac{1}{3}) = (\\frac{1}{2}, 1)$。\n7.  下一个分数是 $0.2$，来自一个未患病病例。曲线右移。 $p_6 = (\\frac{1}{2} + \\frac{1}{4}, 1) = (\\frac{3}{4}, 1)$。\n8.  最后一个分数是 $0.1$，来自一个未患病病例。曲线右移。 $p_7 = (\\frac{3}{4} + \\frac{1}{4}, 1) = (1, 1)$。\n\n经验ROC曲线的顶点序列是：\n$p_0 = (0, 0)$\n$p_1 = (0, \\frac{1}{3})$\n$p_2 = (\\frac{1}{4}, \\frac{1}{3})$\n$p_3 = (\\frac{1}{4}, \\frac{2}{3})$\n$p_4 = (\\frac{1}{2}, \\frac{2}{3})$\n$p_5 = (\\frac{1}{2}, 1)$\n$p_6 = (\\frac{3}{4}, 1)$\n$p_7 = (1, 1)$\n\n第2部分：计算曲线下面积（AUC）。\nAUC是通过对由连续点 $(x_{i-1}, y_{i-1})$ 和 $(x_i, y_i)$ 与 $\\mathrm{FPR}$ 轴所形成的梯形面积求和来计算的。每个梯形的面积由以下公式给出：\n$$ A_i = (x_i - x_{i-1}) \\times \\frac{y_i + y_{i-1}}{2} $$\n总AUC是这些面积的总和：\n$$ \\mathrm{AUC} = \\sum_{i=1}^{7} A_i = \\sum_{i=1}^{7} (x_i - x_{i-1}) \\times \\frac{y_i + y_{i-1}}{2} $$\n我们计算曲线每个分段的面积：\n-   $p_0$ 和 $p_1$ 之间的面积： $A_1 = (0 - 0) \\times \\frac{\\frac{1}{3} + 0}{2} = 0$。\n-   $p_1$ 和 $p_2$ 之间的面积： $A_2 = (\\frac{1}{4} - 0) \\times \\frac{\\frac{1}{3} + \\frac{1}{3}}{2} = \\frac{1}{4} \\times \\frac{1}{3} = \\frac{1}{12}$。\n-   $p_2$ 和 $p_3$ 之间的面积： $A_3 = (\\frac{1}{4} - \\frac{1}{4}) \\times \\frac{\\frac{2}{3} + \\frac{1}{3}}{2} = 0$。\n-   $p_3$ 和 $p_4$ 之间的面积： $A_4 = (\\frac{1}{2} - \\frac{1}{4}) \\times \\frac{\\frac{2}{3} + \\frac{2}{3}}{2} = \\frac{1}{4} \\times \\frac{2}{3} = \\frac{2}{12} = \\frac{1}{6}$。\n-   $p_4$ 和 $p_5$ 之间的面积： $A_5 = (\\frac{1}{2} - \\frac{1}{2}) \\times \\frac{1 + \\frac{2}{3}}{2} = 0$。\n-   $p_5$ 和 $p_6$ 之间的面积： $A_6 = (\\frac{3}{4} - \\frac{1}{2}) \\times \\frac{1 + 1}{2} = \\frac{1}{4} \\times 1 = \\frac{1}{4}$。\n-   $p_6$ 和 $p_7$ 之间的面积： $A_7 = (1 - \\frac{3}{4}) \\times \\frac{1 + 1}{2} = \\frac{1}{4} \\times 1 = \\frac{1}{4}$。\n\n总AUC是这些单个面积的总和：\n$$ \\mathrm{AUC} = 0 + \\frac{1}{12} + 0 + \\frac{1}{6} + 0 + \\frac{1}{4} + \\frac{1}{4} $$\n为了对这些分数求和，我们找到一个公分母，即 $12$：\n$$ \\mathrm{AUC} = \\frac{1}{12} + \\frac{2}{12} + \\frac{3}{12} + \\frac{3}{12} = \\frac{1+2+3+3}{12} = \\frac{9}{12} $$\n化简分数得到最终结果：\n$$ \\mathrm{AUC} = \\frac{3}{4} $$\n这个结果可以使用Wilcoxon-Mann-Whitney U统计量进行验证，该统计量指出，AUC是随机选择的患病病例的分数高于随机选择的未患病病例的分数的概率。一个患病病例和一个未患病病例的配对数量为 $N_D \\times N_{ND} = 3 \\times 4 = 12$。患病病例分数较高的配对数量为 $9$。因此，AUC为 $\\frac{9}{12} = \\frac{3}{4}$，这证实了我们的计算。",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "在掌握了经验ROC曲线的构建之后，下一个关键步骤是探索其理论模型。双正态模型是一个经典的理论框架，它假设两组分数分别服从正态分布。本练习将引导您从该模型的根本定义出发，推导出AUC的一般表达式，并探讨不同方差（异方差性）如何影响ROC曲线的形状。这项实践有助于加深您对分类器性能背后驱动因素的理解，将经验观察与参数化理论联系起来。",
            "id": "4604288",
            "problem": "一个基于蛋白质组学的诊断分类器为每位患者输出一个连续的风险评分。在一项队列研究中，患病患者和非患病患者的风险评分被建模为独立的 高斯随机变量：患病组的评分 $S_{1}$ 服从均值为 $\\mu_{1}$、方差为 $\\sigma_{1}^{2}$ 的正态分布，非患病组的评分 $S_{0}$ 服从均值为 $\\mu_{0}$、方差为 $\\sigma_{0}^{2}$ 的正态分布。通过改变评分的决策阈值来构建受试者工作特征（ROC）曲线，并使用曲线下面积（AUC）来概括其区分能力。仅从ROC和AUC的基本定义出发，推导在异方差双正态模型（$\\sigma_{1}\\neq\\sigma_{0}$）下AUC的通用表达式。然后，使用 $\\mu_{0}=0$, $\\mu_{1}=1.7$, $\\sigma_{0}=0.8$ 和 $\\sigma_{1}=1.5$ 计算AUC。将最终数值答案四舍五入至四位有效数字，并以小数形式表示。最后，将推导出的表达式与等方差情况进行比较（在该情况下，两类具有相同的方差，且选择该方差以使总方差 $\\sigma_{1}^{2}+\\sigma_{0}^{2}$ 保持不变），并定性解释方差差异如何从曲线形状和AUC方面影响区分能力。最终答案必须仅为计算出的AUC值。",
            "solution": "该问题要求推导异方差双正态模型的曲线下面积（AUC），进行一次具体的AUC数值计算，并与等方差模型进行定性比较。\n\n首先，我们验证问题的有效性。\n**步骤 1：提取已知条件**\n- 患病组的评分 $S_{1}$ 是一个服从正态分布 $N(\\mu_{1}, \\sigma_{1}^{2})$ 的随机变量。\n- 非患病组的评分 $S_{0}$ 是一个服从正态分布 $N(\\mu_{0}, \\sigma_{0}^{2})$ 的随机变量。\n- $S_{1}$ 和 $S_{0}$ 是独立的。\n- 模型是异方差的，即 $\\sigma_{1} \\neq \\sigma_{0}$。\n- 对于数值计算，参数为：$\\mu_{0}=0$, $\\mu_{1}=1.7$, $\\sigma_{0}=0.8$, 和 $\\sigma_{1}=1.5$。\n- 最终数值答案必须四舍五入到四位有效数字。\n- 要求与总方差 $\\sigma_{1}^{2}+\\sigma_{0}^{2}$ 保持不变的等方差情况进行定性比较。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为双正态模型是受试者工作特征（ROC）分析的标准理论框架。该问题是适定的，为求得唯一解提供了所有必要信息。语言客观、精确。问题陈述不违反任何基本科学原理，不基于错误的前提，并且不包含矛盾或含糊之处。这是一个可以形式化的统计问题。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行求解。\n\n**AUC 表达式的推导**\n\nROC 曲线绘制的是在一系列连续的决策阈值下，真阳性率（TPR）相对于假阳性率（FPR）的图形。设决策阈值为 $c$。如果一个受试者的评分 $S \\ge c$，则其被分类为患病。\n\nTPR，即灵敏度，是正确分类患病受试者的概率：\n$$ TPR(c) = P(S_{1} \\ge c) $$\nFPR，即 $1 - \\text{特异度}$，是错误分类非患病受试者的概率：\n$$ FPR(c) = P(S_{0} \\ge c) $$\nROC 曲线下面积（AUC）由 ROC 曲线 $TPR(FPR)$ 在 $FPR$ 从 $0$ 到 $1$ 的范围内的积分给出：\n$$ AUC = \\int_{0}^{1} TPR(FPR) \\, d(FPR) $$\n这个积分可以通过阈值 $c$ 来参数化 $TPR$ 和 $FPR$ 进行计算。注意，当 $c$ 从 $-\\infty$ 变为 $+\\infty$ 时，$FPR(c)$ 从 $1$ 变为 $0$。设 $F_{0}(c) = P(S_0 \\le c)$ 为 $S_0$ 的累积分布函数（CDF），$f_{0}(c)$ 为其概率密度函数（PDF）。则 $FPR(c) = 1 - F_{0}(c)$，且 $d(FPR) = -f_{0}(c) dc$。类似地，$TPR(c) = 1 - F_{1}(c)$，其中 $F_{1}(c)$ 是 $S_{1}$ 的累积分布函数。\n将这些代入 AUC 的积分表达式：\n$$ AUC = \\int_{c=+\\infty}^{c=-\\infty} [1 - F_{1}(c)] (-f_{0}(c) \\, dc) = \\int_{-\\infty}^{+\\infty} [1 - F_{1}(c)] f_{0}(c) \\, dc $$\n项 $[1 - F_{1}(c)]$ 是 $P(S_{1}  c)$。该积分表示 $P(S_{1}  S_{0})$ 的期望，其中外层期望是基于 $S_{0}$ 的分布。这证实了AUC的一个众所周知 的等价定义：随机选择一个患病受试者的评分高于随机选择一个非患病受试者的评分的概率。\n$$ AUC = P(S_{1}  S_{0}) $$\n为计算此概率，我们定义一个新的随机变量 $D = S_{1} - S_{0}$。由于 $S_{1}$ 和 $S_{0}$ 是独立的服从正态分布的随机变量，它们的差 $D$ 也服从正态分布。\n$D$ 的均值为：\n$$ E[D] = E[S_{1} - S_{0}] = E[S_{1}] - E[S_{0}] = \\mu_{1} - \\mu_{0} $$\n$D$ 的方差，由于独立性：\n$$ Var(D) = Var(S_{1} - S_{0}) = Var(S_{1}) + (-1)^{2}Var(S_{0}) = \\sigma_{1}^{2} + \\sigma_{0}^{2} $$\n因此，$D$ 的分布为 $N(\\mu_{1} - \\mu_{0}, \\sigma_{1}^{2} + \\sigma_{0}^{2})$。\nAUC 即为概率 $P(D  0)$。为了计算它，我们对变量 $D$ 进行标准化：\n$$ P(D  0) = P\\left(\\frac{D - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}  \\frac{0 - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) $$\n令 $Z = \\frac{D - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}$，这是一个标准正态变量，$Z \\sim N(0, 1)$。\n不等式变为：\n$$ P(D  0) = P\\left(Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) $$\n利用标准正态分布的对称性，$P(Z  -z) = P(Z  z) = \\Phi(z)$，其中 $\\Phi(z)$ 是标准正态分布的累积分布函数。\n因此，异方差双正态模型下 AUC 的通用表达式为：\n$$ AUC = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) $$\n\n**数值计算**\n\n给定参数为：$\\mu_{0}=0$, $\\mu_{1}=1.7$, $\\sigma_{0}=0.8$, 和 $\\sigma_{1}=1.5$。\n我们将这些值代入推导出的表达式中。\n首先，计算函数 $\\Phi$ 的自变量：\n$$ z = \\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}} = \\frac{1.7 - 0}{\\sqrt{(1.5)^{2} + (0.8)^{2}}} $$\n方差为 $\\sigma_{1}^{2} = (1.5)^{2} = 2.25$ 和 $\\sigma_{0}^{2} = (0.8)^{2} = 0.64$。\n方差之和为 $\\sigma_{1}^{2} + \\sigma_{0}^{2} = 2.25 + 0.64 = 2.89$。\n差值的标准差为 $\\sqrt{2.89} = 1.7$。\n将此结果代回 $z$ 的表达式中：\n$$ z = \\frac{1.7}{1.7} = 1 $$\n因此，AUC 由 $\\Phi(1)$ 给出。\n$\\Phi(1)$ 的值是标准正态曲线在 $z=1$ 左侧的面积。这是一个标准值，约等于 $0.8413447...$。\n问题要求四舍五入到四位有效数字。\n$$ AUC \\approx 0.8413 $$\n\n**定性比较**\n\n推导出的 AUC 表达式为 $AUC = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right)$。\n我们来考虑总方差 $\\sigma_{1}^{2}+\\sigma_{0}^{2}$ 保持不变的等方差（同方差）情况。设新的共同方差为 $\\sigma^{2}$。条件是 $2\\sigma^{2} = \\sigma_{1}^{2} + \\sigma_{0}^{2}$。\n这个同方差模型的 AUC，$AUC_{eq}$，将是：\n$$ AUC_{eq} = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma^{2} + \\sigma^{2}}}\\right) = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{2\\sigma^{2}}}\\right) $$\n由于 $2\\sigma^{2} = \\sigma_{1}^{2} + \\sigma_{0}^{2}$，$\\Phi$ 的自变量与异方差情况下的相同。\n$$ AUC_{eq} = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) = AUC $$\n这表明，对于固定的均值差 $(\\mu_{1} - \\mu_{0})$ 和固定的总方差 $(\\sigma_{1}^{2} + \\sigma_{0}^{2})$，AUC 与方差在两类之间的分布方式（即异方差的程度）无关。\n\n然而，方差差异显著影响 ROC 曲线的*形状*。ROC 曲线由 $y(x) = TPR(FPR^{-1}(x))$ 定义。对于双正态模型，这是 $y(x) = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma_1} + \\frac{\\sigma_0}{\\sigma_1} \\Phi^{-1}(x)\\right)$。\n- **等方差情况（$\\sigma_{1}=\\sigma_{0}$）：** 项 $\\frac{\\sigma_{0}}{\\sigma_{1}}$ 为 $1$。得到的 ROC 曲线关于从 $(0,1)$ 到 $(1,0)$ 的反对角线对称。这意味着在提高灵敏度和损失特异度之间的权衡在整个曲线上是对称的。\n- **不等方差情况（$\\sigma_{1} \\neq \\sigma_{0}$）：** 曲线是不对称的。在我们的问题中，$\\sigma_{1} = 1.5  \\sigma_{0} = 0.8$。患病组的分布比非患病组的分布更宽。这导致 ROC 曲线不对称，与对称曲线相比，它更向靠近点 $(0,1)$ 的左上角弯曲。这种形状表明，在高阈值（低FPR）下，很难捕捉到宽的患病分布的长尾，因此 TPR 上升相对较慢。在较低阈值下，患病分布的主体被更快地捕捉。因此，即使总体 AUC 不变，曲线上最佳工作点的选择（取决于错误分类的相对成本）也受到方差差异的影响。\n\n总之，在给定的均值差和总方差下，方差差异不会改变由 AUC 衡量的总区分能力，但它会改变在不同决策阈值下灵敏度和特异度之间的局部权衡，这反映在 ROC 曲线的不对称形状上。",
            "answer": "$$\\boxed{0.8413}$$"
        },
        {
            "introduction": "在生物信息学和医学数据分析中，任何点估计都离不开其不确定性的量化。计算出AUC值固然重要，但评估该值的可靠性并给出其置信区间则更为关键，这使得我们能够严谨地比较不同模型的性能。本练习将介绍一种基于U统计量的非参数方法——DeLong方法，用于估计AUC的方差并构建其置信区间。完成这项练习将使您从单纯的性能计算，迈向严谨的统计推断。",
            "id": "4604295",
            "problem": "考虑在病例-对照研究中研究的一个二分类生物标志物，其中在 $n_1$ 名患病受试者和 $n_0$ 名非患病受试者上测量了生物标志物得分 $S$。受试者工作特征（ROC）曲线是当决策阈值变化时，描绘真阳性率相对于假阳性率的点集，而曲线下面积（AUC）定义为随机选择的患病受试者的得分高于随机选择的非患病受试者的得分的概率。形式上，对于从各自总体中独立抽取的患病得分 $S_1$ 和非患病得分 $S_0$，曲线下面积（AUC）满足 $AUC = \\mathbb{P}(S_1  S_0)$。\n\n从 $AUC$ 作为指示核函数的期望的定义 $AUC = \\mathbb{E}\\big[\\mathbf{1}\\{S_1  S_0\\}\\big]$ 和 U-统计量理论出发，在每个类别内样本独立同分布且类别之间相互独立的假设下，推导一个基于指示核函数 $\\mathbf{1}\\{S_1  S_0\\}$ 的经验 $AUC$ 的渐近有效方差估计量。使用此推导，以每个患病和非患病样本的影响值的形式，获得渐近方差的相合估计量。然后，将你的推导应用于以下不包含结（相同值）的观测生物标志物得分：\n- 患病组 ($n_1 = 6$): $0.82,\\, 0.76,\\, 0.67,\\, 0.59,\\, 0.71,\\, 0.64$。\n- 非患病组 ($n_0 = 7$): $0.41,\\, 0.55,\\, 0.49,\\, 0.58,\\, 0.62,\\, 0.73,\\, 0.60$。\n\n计算经验 $AUC$、通过 U-统计量影响函数分解推导出的 DeLong 方差估计量，并利用渐近正态性构建 $\\alpha = 0.05$ 时的 $(1 - \\alpha)$ 置信区间。仅报告此置信区间的上端点作为你的最终答案。将你的最终答案四舍五入到四位有效数字。将最终数字表示为小数。",
            "solution": "用户想要解决一个问题。\n用户希望我扮演一名STEM教授。\n用户希望我先验证问题。\n如果问题有效，用户希望我提供完整的解答。\n用户希望我为所有数学表达式使用LaTeX。\n用户希望输出有特定的XML结构。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n- 用于二分类问题的生物标志物得分 $S$。\n- 包含 $n_1$ 名患病受试者和 $n_0$ 名非患病受试者的病例-对照研究。\n- ROC曲线定义：真阳性率 vs. 假阳性率。\n- AUC定义：$AUC = \\mathbb{P}(S_1  S_0)$，其中 $S_1$ 是来自患病受试者的得分，$S_0$ 是来自非患病受试者的得分。\n- U-统计量公式：$AUC = \\mathbb{E}\\big[\\mathbf{1}\\{S_1  S_0\\}\\big]$。\n- 任务：使用U-统计量理论和指示核函数 $\\mathbf{1}\\{S_1  S_0\\}$，推导一个经验 $AUC$ 的渐近有效方差估计量。该估计量应以每个患病和非患病样本的影响值的形式表示。\n- 假设：\n    1. 每个类别（患病和非患病）内的样本独立同分布（i.i.d.）。\n    2. 两个类别之间相互独立。\n- 数据：\n    - 患病组 ($n_1 = 6$): $D = \\{0.82,\\, 0.76,\\, 0.67,\\, 0.59,\\, 0.71,\\, 0.64\\}$。\n    - 非患病组 ($n_0 = 7$): $N = \\{0.41,\\, 0.55,\\, 0.49,\\, 0.58,\\, 0.62,\\, 0.73,\\, 0.60\\}$。\n    - 数据中没有结。\n- 需要执行的计算：\n    1. 经验 $AUC$。\n    2. DeLong 方差估计量。\n    3. $\\alpha = 0.05$ 的 $(1 - \\alpha)$ 置信区间。\n- 报告的最终答案：置信区间的上端点，四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知信息进行验证**\n- **科学依据**：该问题在生物统计学中是公认的。将AUC定义为 $\\mathbb{P}(S_1  S_0)$ 是标准做法。使用双样本U-统计量分析AUC并推导其方差（DeLong方法）是非参数ROC分析的基石。所有前提在事实上和科学上都是合理的。\n- **结构良好**：问题陈述清晰，提供了所有必要的数据、参数（$\\alpha$、$n_1$、$n_0$）以及需要遵循的具体方法。目标明确：计算置信区间的上限。存在唯一的可达解。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n- **缺陷清单**：该问题不违反任何无效性标准。它在科学上是合理的、可形式化的、完整的、现实的且结构良好。推导和计算并非微不足道，测试了统计生物信息学中的一个核心概念。\n\n**步骤3：结论与行动**\n问题有效。我将开始解答。\n\n### 推导与解答\n\n设 $n_1$ 名患病受试者的生物标志物得分为 $X_1, X_2, \\ldots, X_{n_1}$，$n_0$ 名非患病受试者的得分为 $Y_1, Y_2, \\ldots, Y_{n_0}$。问题陈述，每个组内的样本是独立同分布的，并且组间是独立的。\n\n曲线下面积（$AUC$）是随机选择的患病受试者的得分高于随机选择的非患病受试者的得分的概率，即 $\\theta = \\mathbb{P}(X  Y)$。这可以写成指示函数（核函数）$\\phi(X, Y) = \\mathbf{1}\\{X  Y\\}$ 的期望，因此 $\\theta = \\mathbb{E}[\\phi(X, Y)]$。问题明确指出没有结，所以我们不需要考虑 $X=Y$ 的情况。\n\n$AUC$ 的经验估计量是基于此核函数的阶为 ($1,1$) 的双样本 U-统计量：\n$$ \\widehat{AUC} = \\frac{1}{n_1 n_0} \\sum_{i=1}^{n_1} \\sum_{j=1}^{n_0} \\phi(X_i, Y_j) = \\frac{1}{n_1 n_0} \\sum_{i=1}^{n_1} \\sum_{j=1}^{n_0} \\mathbf{1}\\{X_i  Y_j\\} $$\n这是标准化的 Wilcoxon-Mann-Whitney 统计量。\n\n为了求 $\\widehat{AUC}$ 的方差，我们使用 U-统计量理论。双样本 U-统计量的渐近方差由其投影的方差给出。首先，我们定义核函数的条件期望：\n- 令 $\\phi_1(x) = \\mathbb{E}[\\phi(x, Y) | X=x] = \\mathbb{E}[\\mathbf{1}\\{x  Y\\}] = \\mathbb{P}(x  Y)$。\n- 令 $\\phi_0(y) = \\mathbb{E}[\\phi(X, y) | Y=y] = \\mathbb{E}[\\mathbf{1}\\{X  y\\}] = \\mathbb{P}(X  y)$。\n\n这些条件期望的方差定义为：\n- $\\sigma_1^2 = \\text{Var}[\\phi_1(X)] = \\mathbb{E}[(\\phi_1(X) - \\theta)^2]$。\n- $\\sigma_0^2 = \\text{Var}[\\phi_0(Y)] = \\mathbb{E}[(\\phi_0(Y) - \\theta)^2]$。\n\n那么 $\\widehat{AUC}$ 的渐近方差由下式给出：\n$$ \\text{Var}(\\widehat{AUC}) \\approx \\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_0^2}{n_0} $$\n为获得此方差的相合估计量，我们用理论量对应的经验量来替换。这是 DeLong 等人（1988）提出的方法。\n\n对每个观测值的条件期望的经验估计就是问题中所称的“影响值”。\n对于每个患病受试者得分 $X_i$，其分量为：\n$$ V_{10}(X_i) = \\hat{\\phi}_1(X_i) = \\frac{1}{n_0} \\sum_{j=1}^{n_0} \\mathbf{1}\\{X_i  Y_j\\} $$\n对于每个非患病受试者得分 $Y_j$，其分量为：\n$$ V_{01}(Y_j) = \\hat{\\phi}_0(Y_j) = \\frac{1}{n_1} \\sum_{i=1}^{n_1} \\mathbf{1}\\{X_i  Y_j\\} $$\n注意，$V_{10}$ 分量的平均值和 $V_{01}$ 分量的平均值都等于经验 $AUC$：\n$$ \\frac{1}{n_1} \\sum_{i=1}^{n_1} V_{10}(X_i) = \\widehat{AUC} \\quad \\text{和} \\quad \\frac{1}{n_0} \\sum_{j=1}^{n_0} V_{01}(Y_j) = \\widehat{AUC} $$\n这些分量的样本方差用于估计 $\\sigma_1^2$ 和 $\\sigma_0^2$：\n$$ S_{10} = \\widehat{\\sigma}_1^2 = \\frac{1}{n_1-1} \\sum_{i=1}^{n_1} (V_{10}(X_i) - \\widehat{AUC})^2 $$\n$$ S_{01} = \\widehat{\\sigma}_0^2 = \\frac{1}{n_0-1} \\sum_{j=1}^{n_0} (V_{01}(Y_j) - \\widehat{AUC})^2 $$\n那么 $\\widehat{AUC}$ 的 DeLong 方差估计量为：\n$$ \\widehat{\\text{Var}}(\\widehat{AUC}) = \\frac{S_{10}}{n_1} + \\frac{S_{01}}{n_0} $$\n利用这个方差估计量，基于 U-统计量的渐近正态性，可以为真实的 $AUC$ 构建一个近似的 $(1-\\alpha)$ 置信区间：\n$$ \\widehat{AUC} \\pm z_{1-\\alpha/2} \\sqrt{\\widehat{\\text{Var}}(\\widehat{AUC})} $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$ 分位数。\n\n**数据应用**\n给定数据为：\n- 患病组 ($n_1 = 6$): $D = \\{0.82,\\, 0.76,\\, 0.67,\\, 0.59,\\, 0.71,\\, 0.64\\}$\n- 非患病组 ($n_0 = 7$): $N = \\{0.41,\\, 0.55,\\, 0.49,\\, 0.58,\\, 0.62,\\, 0.73,\\, 0.60\\}$\n\n**1. 计算经验 $AUC$ ($\\widehat{AUC}$)**\n我们计算满足 $X_i  Y_j$ 的配对 $(X_i, Y_j)$ 的数量：\n- $X=0.82 $ 所有 $7$ 个 $Y$ 得分。\n- $X=0.76 $ 所有 $7$ 个 $Y$ 得分。\n- $X=0.67 $ $6$ 个 $Y$ 得分 (除了 $0.73$)。\n- $X=0.59 $ $4$ 个 $Y$ 得分 ($0.41, 0.55, 0.49, 0.58$)。\n- $X=0.71 $ $6$ 个 $Y$ 得分 (除了 $0.73$)。\n- $X=0.64 $ $6$ 个 $Y$ 得分 (除了 $0.73$)。\n$X_i  Y_j$ 的配对总数为 $7+7+6+4+6+6 = 36$。\n配对总数为 $n_1 \\times n_0 = 6 \\times 7 = 42$。\n$$ \\widehat{AUC} = \\frac{36}{42} = \\frac{6}{7} $$\n\n**2. 计算 DeLong 方差估计量**\n首先，我们计算分量 $V_{10}(X_i)$：\n$V_{10}(0.82) = 7/7 = 1$\n$V_{10}(0.76) = 7/7 = 1$\n$V_{10}(0.67) = 6/7$\n$V_{10}(0.59) = 4/7$\n$V_{10}(0.71) = 6/7$\n$V_{10}(0.64) = 6/7$\n现在，计算样本方差 $S_{10}$：\n$$ S_{10} = \\frac{1}{6-1} \\left[ (1-\\frac{6}{7})^2 + (1-\\frac{6}{7})^2 + (\\frac{6}{7}-\\frac{6}{7})^2 + (\\frac{4}{7}-\\frac{6}{7})^2 + (\\frac{6}{7}-\\frac{6}{7})^2 + (\\frac{6}{7}-\\frac{6}{7})^2 \\right] $$\n$$ S_{10} = \\frac{1}{5} \\left[ 2 \\cdot (\\frac{1}{7})^2 + (\\frac{-2}{7})^2 \\right] = \\frac{1}{5} \\left[ \\frac{2}{49} + \\frac{4}{49} \\right] = \\frac{1}{5} \\cdot \\frac{6}{49} = \\frac{6}{245} $$\n接下来，我们计算分量 $V_{01}(Y_j)$。对每个 $Y_j$，我们计算比它大的 $X_i$ 得分的数量。\n- $Y=0.41$: $6$ 个 $X$ 得分大于它。\n- $Y=0.55$: $6$ 个 $X$ 得分大于它。\n- $Y=0.49$: $6$ 个 $X$ 得分大于它。\n- $Y=0.58$: $6$ 个 $X$ 得分大于它。\n- $Y=0.62$: $5$ 个 $X$ 得分大于它 ($0.82, 0.76, 0.67, 0.71, 0.64$)。\n- $Y=0.73$: $2$ 个 $X$ 得分大于它 ($0.82, 0.76$)。\n- $Y=0.60$: $5$ 个 $X$ 得分大于它 ($0.82, 0.76, 0.67, 0.71, 0.64$)。\n将计数除以 $n_1=6$ 得到分量 $V_{01}(Y_j)$：\n$\\{6/6, 6/6, 6/6, 6/6, 5/6, 2/6, 5/6\\} = \\{1, 1, 1, 1, 5/6, 1/3, 5/6\\}$\n现在，计算样本方差 $S_{01}$：\n$$ S_{01} = \\frac{1}{7-1} \\sum_{j=1}^{7} (V_{01}(Y_j) - \\frac{6}{7})^2 $$\n$$ S_{01} = \\frac{1}{6} \\left[ 4 \\cdot (1-\\frac{6}{7})^2 + 2 \\cdot (\\frac{5}{6}-\\frac{6}{7})^2 + (\\frac{1}{3}-\\frac{6}{7})^2 \\right] $$\n$$ S_{01} = \\frac{1}{6} \\left[ 4(\\frac{1}{7})^2 + 2(\\frac{35-36}{42})^2 + (\\frac{7-18}{21})^2 \\right] = \\frac{1}{6} \\left[ \\frac{4}{49} + 2(\\frac{-1}{42})^2 + (\\frac{-11}{21})^2 \\right] $$\n$$ S_{01} = \\frac{1}{6} \\left[ \\frac{4}{49} + \\frac{2}{1764} + \\frac{121}{441} \\right] = \\frac{1}{6} \\left[ \\frac{4 \\cdot 36}{1764} + \\frac{2}{1764} + \\frac{121 \\cdot 4}{1764} \\right] $$\n$$ S_{01} = \\frac{1}{6} \\left[ \\frac{144 + 2 + 484}{1764} \\right] = \\frac{1}{6} \\frac{630}{1764} = \\frac{1}{6} \\frac{5}{14} = \\frac{5}{84} $$\n最后，计算 $\\widehat{AUC}$ 的估计方差：\n$$ \\widehat{\\text{Var}}(\\widehat{AUC}) = \\frac{S_{10}}{n_1} + \\frac{S_{01}}{n_0} = \\frac{6/245}{6} + \\frac{5/84}{7} = \\frac{1}{245} + \\frac{5}{588} $$\n为了将这些分数相加，我们找到一个公分母。$245 = 5 \\times 7^2$ 且 $588 = 12 \\times 49 = 12 \\times 7^2$。最小公倍数是 $60 \\times 49 = 2940$。\n$$ \\widehat{\\text{Var}}(\\widehat{AUC}) = \\frac{12}{2940} + \\frac{25}{2940} = \\frac{37}{2940} $$\n\n**3. 构建置信区间**\n置信水平是 $(1 - \\alpha) = 1 - 0.05 = 0.95$。相应的标准正态分布临界值是 $z_{1-0.05/2} = z_{0.975} \\approx 1.96$。\n标准误（$SE$）是：\n$$ SE(\\widehat{AUC}) = \\sqrt{\\widehat{\\text{Var}}(\\widehat{AUC})} = \\sqrt{\\frac{37}{2940}} $$\n置信区间的上端点是：\n$$ \\text{Upper Endpoint} = \\widehat{AUC} + z_{0.975} \\times SE(\\widehat{AUC}) $$\n$$ \\text{Upper Endpoint} = \\frac{6}{7} + 1.96 \\times \\sqrt{\\frac{37}{2940}} $$\n现在，我们计算数值：\n$$ \\frac{6}{7} \\approx 0.857143 $$\n$$ \\sqrt{\\frac{37}{2940}} \\approx \\sqrt{0.01258503} \\approx 0.112183 $$\n$$ \\text{Upper Endpoint} \\approx 0.857143 + 1.96 \\times 0.112183 \\approx 0.857143 + 0.21987868 \\approx 1.07702168 $$\n将结果四舍五入到四位有效数字得到 $1.077$。上界超过 $1$ 的事实反映了正态近似的使用，这在该方法中很常见，尤其是在小样本量的情况下。",
            "answer": "$$\\boxed{1.077}$$"
        }
    ]
}