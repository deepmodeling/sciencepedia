{
    "hands_on_practices": [
        {
            "introduction": "Understanding statistical power begins with mastering the fundamental calculations in a simple setting. This first practice guides you through deriving the power and sample size formulas for a one-sample $z$-test from first principles. By working through this foundational exercise , you will build a solid intuition for how the key components of study design—effect size, variance, sample size, and error rates—interact.",
            "id": "4610103",
            "problem": "A translational genomics team is evaluating whether the mean $\\log_2$-normalized expression level of a therapy-responsive biomarker in a single-arm study exceeds a clinically relevant threshold. Prior platform calibration and extensive historical controls justify treating the measurement standard deviation as known and stable across subjects. Let the null hypothesis be $H_{0}: \\mu = \\mu_{0}$ and the scientific alternative be $H_{1}: \\mu > \\mu_{0}$, where $\\mu$ is the true population mean biomarker expression and $\\mu_{0}$ is the threshold.\n\nFundamental base assumptions: by the Central Limit Theorem (CLT), for independent subjects the sample mean $\\bar{X}$ of $n$ subjects is approximately normal with mean $\\mu$ and variance $\\sigma^{2}/n$; a one-sample $z$-test uses the standardized statistic $Z = (\\bar{X} - \\mu_{0})/(\\sigma/\\sqrt{n})$, where $\\sigma$ is treated as known from prior calibration. The significance level $\\alpha$ is the Type I error probability, and the statistical power is $1 - \\beta$, where $\\beta$ is the Type II error probability under a specific true mean $\\mu_{1}$.\n\nScenario: suppose the clinically relevant threshold is $\\mu_{0} = 0$, the anticipated true mean under the therapy is $\\mu_{1} = 0.3$, the known standard deviation is $\\sigma = 0.6$, the planned pilot sample size is $n = 30$, and the study will use a one-sided test at $\\alpha = 0.01$.\n\nTasks:\n1. Using only the fundamental base above, derive the sampling distribution of the $z$-statistic under $H_{0}$ and under the specific alternative $\\mu = \\mu_{1}$, and from first principles compute the exact analytic form of the power function for the one-sided test at significance level $\\alpha$. Then evaluate the power at the given values $\\mu_{0}$, $\\mu_{1}$, $\\sigma$, $n$, and $\\alpha$. Express the power as a decimal (not a percentage).\n2. Invert the derived power expression to obtain a closed-form expression for the minimum sample size $n$ required to achieve target power $1 - \\beta = 0.9$ at the same $\\alpha$ for detecting the shift from $\\mu_{0}$ to $\\mu_{1}$ with known $\\sigma$.\n3. Compute this minimum $n$ numerically for the given $\\mu_{0}$, $\\mu_{1}$, $\\sigma$, and $\\alpha$. Report your final numerical answer as the smallest integer $n$ that meets or exceeds the target power.\n\nThe final answer must be a single number. No rounding instruction is needed beyond reporting the smallest integer $n$.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe verbatim givens extracted from the problem statement are:\n- Null hypothesis: $H_{0}: \\mu = \\mu_{0}$\n- Alternative hypothesis: $H_{1}: \\mu > \\mu_{0}$\n- $\\mu$: true population mean biomarker expression\n- $\\mu_{0}$: clinically relevant threshold\n- Sample mean distribution: $\\bar{X} \\sim N(\\mu, \\sigma^{2}/n)$ approximately, for $n$ independent subjects\n- Test statistic: $Z = (\\bar{X} - \\mu_{0})/(\\sigma/\\sqrt{n})$\n- $\\sigma$: known standard deviation\n- $\\alpha$: significance level (Type I error probability)\n- $1 - \\beta$: statistical power\n- $\\beta$: Type II error probability under a specific true mean $\\mu_{1}$\n- Scenario values for Task 1: $\\mu_{0} = 0$, $\\mu_{1} = 0.3$, $\\sigma = 0.6$, $n = 30$, $\\alpha = 0.01$ (one-sided test)\n- Target values for Task 2 & 3: Power $1 - \\beta = 0.9$, $\\alpha = 0.01$, $\\mu_{0} = 0$, $\\mu_{1} = 0.3$, $\\sigma = 0.6$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n- **Scientifically Grounded**: The problem is a canonical application of statistical hypothesis testing, power analysis, and sample size determination based on the normal distribution and the Central Limit Theorem. The context of biomarker analysis in translational genomics is a standard and appropriate setting for such methods. The problem is fundamentally sound.\n- **Well-Posed**: All necessary parameters ($\\mu_0, \\mu_1, \\sigma, \\alpha, \\text{target power}, n$) are provided for each task. The objectives are clearly stated, leading to a unique and meaningful solution for each part.\n- **Objective**: The problem is stated using precise, standard statistical terminology and quantitative values. It is free from ambiguity, subjectivity, or opinion-based claims.\n- **Other Flaws**: The problem does not violate any other validity criteria. It is complete, consistent, realistic, and directly relevant to the specified topic of statistical power in bioinformatics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will now be provided.\n\n---\n\n### Solution Derivations\n\n#### Task 1: Power Function Derivation and Evaluation\n\n**Distribution of the Test Statistic**\n\nThe problem states that the sample mean $\\bar{X}$ is approximately normally distributed, $\\bar{X} \\sim N(\\mu, \\sigma^2/n)$. The test statistic is $Z = (\\bar{X} - \\mu_{0})/(\\sigma/\\sqrt{n})$.\n\n1.  **Under the null hypothesis ($H_{0}$)**: The true mean is $\\mu = \\mu_{0}$. The distribution of the sample mean is $\\bar{X} \\sim N(\\mu_{0}, \\sigma^2/n)$. The test statistic $Z = (\\bar{X} - \\mu_{0})/(\\sigma/\\sqrt{n})$ is a standard linear transformation of a normal variable to its standard form. Thus, under $H_{0}$, the statistic $Z$ follows a standard normal distribution:\n    $$Z \\sim N(0, 1)$$\n\n2.  **Under the specific alternative hypothesis ($H_{1}$)**: The true mean is specified as $\\mu = \\mu_{1}$. The distribution of the sample mean is $\\bar{X} \\sim N(\\mu_{1}, \\sigma^2/n)$. The test statistic $Z$ is still calculated with respect to $\\mu_{0}$. Its distribution under this alternative is found by calculating its expectation and variance:\n    $$E[Z] = E\\left[\\frac{\\bar{X} - \\mu_{0}}{\\sigma/\\sqrt{n}}\\right] = \\frac{E[\\bar{X}] - \\mu_{0}}{\\sigma/\\sqrt{n}} = \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}$$\n    $$Var(Z) = Var\\left(\\frac{\\bar{X} - \\mu_{0}}{\\sigma/\\sqrt{n}}\\right) = \\frac{Var(\\bar{X})}{(\\sigma/\\sqrt{n})^2} = \\frac{\\sigma^2/n}{\\sigma^2/n} = 1$$\n    Thus, under the specific alternative $\\mu=\\mu_1$, the statistic $Z$ follows a non-standard normal distribution:\n    $$Z \\sim N\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}, 1\\right)$$\n\n**Derivation of the Power Function**\n\nFor a one-sided test $H_1: \\mu > \\mu_0$ at significance level $\\alpha$, we reject $H_0$ if the observed test statistic $Z_{obs}$ exceeds the critical value $z_{\\alpha}$. The critical value $z_{\\alpha}$ is defined as the upper $\\alpha$-quantile of the standard normal distribution, satisfying $P(Z > z_{\\alpha} | H_0) = \\alpha$, where $Z \\sim N(0, 1)$.\n\nPower ($1-\\beta$) is the probability of correctly rejecting $H_0$ when the alternative hypothesis is true, i.e., when $\\mu = \\mu_{1}$.\n$$1 - \\beta = \\text{Power} = P(Z_{obs} > z_{\\alpha} | \\mu = \\mu_{1})$$\nSince $Z_{obs} = (\\bar{X} - \\mu_{0})/(\\sigma/\\sqrt{n})$, and under $\\mu = \\mu_1$, we have $\\bar{X} \\sim N(\\mu_1, \\sigma^2/n)$, we can standardize this probability statement with respect to the true mean $\\mu_1$.\n$$\\text{Power} = P\\left(\\frac{\\bar{X} - \\mu_{0}}{\\sigma/\\sqrt{n}} > z_{\\alpha}\\right)$$\nWe manipulate the term inside the probability:\n$$\\frac{\\bar{X} - \\mu_{0}}{\\sigma/\\sqrt{n}} = \\frac{(\\bar{X} - \\mu_{1}) + (\\mu_{1} - \\mu_{0})}{\\sigma/\\sqrt{n}} = \\frac{\\bar{X} - \\mu_{1}}{\\sigma/\\sqrt{n}} + \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}$$\nThe term $Z' = (\\bar{X} - \\mu_{1})/(\\sigma/\\sqrt{n})$ is a standard normal variable, $Z' \\sim N(0, 1)$, because $\\bar{X} \\sim N(\\mu_1, \\sigma^2/n)$. Substituting this back into the power expression:\n$$\\text{Power} = P\\left(Z' + \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}} > z_{\\alpha}\\right) = P\\left(Z' > z_{\\alpha} - \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}\\right)$$\nLet $\\Phi(\\cdot)$ be the cumulative distribution function (CDF) of the standard normal distribution. Then $P(Z' > k) = 1 - \\Phi(k)$. Using the symmetry property $\\Phi(-x) = 1 - \\Phi(x)$, this can also be written as $\\Phi(-k)$. Therefore, the exact analytic form of the power function is:\n$$\\text{Power}(\\mu_1) = 1 - \\Phi\\left(z_{\\alpha} - \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}\\right) = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}} - z_{\\alpha}\\right)$$\n\n**Evaluation of Power**\n\nGiven values are: $\\mu_{0} = 0$, $\\mu_{1} = 0.3$, $\\sigma = 0.6$, $n = 30$, and $\\alpha = 0.01$.\nFirst, find the critical value $z_{\\alpha} = z_{0.01}$. This value satisfies $\\Phi(z_{0.01}) = 1 - 0.01 = 0.99$. From standard normal tables or a calculator, $z_{0.01} \\approx 2.3263$.\nNow substitute the values into the power formula:\n$$\\text{Power} = \\Phi\\left(\\frac{0.3 - 0}{0.6/\\sqrt{30}} - 2.3263\\right)$$\n$$\\text{Power} = \\Phi\\left(\\frac{0.3\\sqrt{30}}{0.6} - 2.3263\\right) = \\Phi\\left(0.5\\sqrt{30} - 2.3263\\right)$$\nNumerically evaluating the argument:\n$$0.5\\sqrt{30} - 2.3263 \\approx 0.5 \\times 5.4772 - 2.3263 = 2.7386 - 2.3263 = 0.4123$$\n$$\\text{Power} = \\Phi(0.4123) \\approx 0.6600$$\nThe power of the study with $n=30$ is approximately $0.6600$.\n\n#### Task 2: Derivation of the Sample Size Formula\n\nThe goal is to find the minimum sample size $n$ to achieve a target power of $1 - \\beta$. We start from the power expression derived in Task 1:\n$$\\text{Power} = 1 - \\beta = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}} - z_{\\alpha}\\right)$$\nApplying the inverse normal CDF, $\\Phi^{-1}$, to both sides:\n$$\\Phi^{-1}(1 - \\beta) = \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}} - z_{\\alpha}$$\nThe standard notation for the upper $\\beta$-quantile is $z_{\\beta}$, which satisfies $P(Z > z_{\\beta}) = \\beta$, or $\\Phi(z_{\\beta}) = 1 - \\beta$. Therefore, $\\Phi^{-1}(1-\\beta)$ is simply $z_{\\beta}$.\n$$z_{\\beta} = \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}} - z_{\\alpha}$$\nNow, we rearrange the equation to solve for $n$:\n$$z_{\\alpha} + z_{\\beta} = \\frac{\\mu_{1} - \\mu_{0}}{\\sigma/\\sqrt{n}}$$\n$$\\sqrt{n} = \\frac{\\sigma(z_{\\alpha} + z_{\\beta})}{\\mu_{1} - \\mu_{0}}$$\nSquaring both sides gives the closed-form expression for the sample size $n$:\n$$n = \\left(\\frac{\\sigma(z_{\\alpha} + z_{\\beta})}{\\mu_{1} - \\mu_{0}}\\right)^2$$\n\n#### Task 3: Numerical Calculation of Sample Size $n$\n\nWe are given: $\\mu_{0} = 0$, $\\mu_{1} = 0.3$, $\\sigma = 0.6$, $\\alpha = 0.01$, and target power $1 - \\beta = 0.9$, which implies $\\beta = 0.1$.\n\nWe need the critical values for $\\alpha$ and $\\beta$:\n1.  $z_{\\alpha} = z_{0.01}$: The upper $1\\%$ point of the standard normal distribution. $P(Z > z_{0.01}) = 0.01$. As before, $z_{0.01} \\approx 2.3263$.\n2.  $z_{\\beta} = z_{0.1}$: The upper $10\\%$ point of the standard normal distribution. $P(Z > z_{0.1}) = 0.1$. From tables, $z_{0.1} \\approx 1.2816$.\n\nSubstitute these values into the derived formula for $n$:\n$$n = \\left(\\frac{0.6(2.3263 + 1.2816)}{0.3 - 0}\\right)^2$$\n$$n = \\left(\\frac{0.6(3.6079)}{0.3}\\right)^2$$\n$$n = (2 \\times 3.6079)^2$$\n$$n = (7.2158)^2$$\n$$n \\approx 52.0677$$\nSince the sample size $n$ must be an integer, and we need to meet or exceed the target power, we must round the calculated value up to the next integer.\n$$n_{min} = \\lceil 52.0677 \\rceil = 53$$\nTherefore, the minimum required sample size is $53$.",
            "answer": "$$\\boxed{53}$$"
        },
        {
            "introduction": "A successful initial study is often just the beginning; the true test of a discovery is its replicability. This exercise  confronts a critical real-world challenge known as the 'winner's curse,' where the effect sizes of initial discoveries are often inflated. You will calculate how this inflation, even when modest, can dramatically affect the power of a replication study, providing a crucial lesson in the cautious interpretation and follow-up of significant findings.",
            "id": "4610085",
            "problem": "A translational oncology team investigates a protein biomarker whose effect on a continuous clinical risk score has been standardized so that the discovery and replication analyses can be conducted using a one-sided $z$-test. In the initial discovery study, the team targeted power $\\pi_{0}$ against a right-sided alternative at significance level $\\alpha_{0}$, and achieved that power based on the true noncentral mean $\\mu_{1}$ of the $z$-statistic under the alternative. The biology and data-generating mechanism in both studies are stable, so the standardized $z$-statistic under the alternative in each study can be modeled as $Z \\sim \\mathcal{N}(\\mu,1)$, where $\\mu$ is the study-specific noncentral mean.\n\nAfter discovery, they plan a direction-consistent replication using the same standardized one-sided $z$-test at replication significance level $\\alpha_{\\mathrm{rep}}$. However, due to selection on statistical significance, the initial estimate of the effect is inflated (winner’s curse), and the true noncentral mean carried into replication is attenuated by a multiplicative factor $b \\in (0,1)$ relative to $\\mu_{1}$.\n\nAssume the following scientifically plausible quantities for this biomarker analysis:\n- Initial power $\\pi_{0} = 0.80$ for a one-sided right-tailed $z$-test at $\\alpha_{0} = 0.005$.\n- Winner’s curse attenuation factor $b = 0.65$, meaning the replication noncentral mean is $\\mu_{2} = b \\mu_{1}$.\n- Replication uses a one-sided right-tailed $z$-test at $\\alpha_{\\mathrm{rep}} = 0.025$.\n\nUsing only fundamental definitions of hypothesis testing for the normal model, compute the probability that the replication study will yield a statistically significant result in the same direction at level $\\alpha_{\\mathrm{rep}}$. Express your final answer as a decimal and round to four significant figures.",
            "solution": "The user wants me to solve a statistical power problem related to a replication study in bioinformatics. I must first validate the problem statement.\n\n### Step 1: Extract Givens\n- The test is a one-sided, right-tailed $z$-test.\n- The test statistic under the alternative is modeled as $Z \\sim \\mathcal{N}(\\mu,1)$, where $\\mu$ is the study-specific noncentral mean.\n- Initial discovery study power: $\\pi_{0} = 0.80$.\n- Initial discovery study significance level: $\\alpha_{0} = 0.005$.\n- The true noncentral mean in the discovery study is $\\mu_{1}$.\n- Replication study significance level: $\\alpha_{\\mathrm{rep}} = 0.025$.\n- Winner’s curse attenuation factor: $b = 0.65$.\n- The noncentral mean for the replication study is $\\mu_{2} = b \\mu_{1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria:\n- **Scientifically Grounded**: The problem is well-grounded in the statistical theory of hypothesis testing. The concepts of power, significance level, noncentrality parameters for a $z$-test, and the 'winner's curse' are standard and widely applied in fields like biostatistics and medical data analytics. The provided model $Z \\sim \\mathcal{N}(\\mu,1)$ is a standard theoretical framework for $z$-statistics derived from large samples. The numerical values for power and significance levels are conventional.\n- **Well-Posed**: The problem asks for a specific, calculable quantity: the probability of a significant result in the replication study (i.e., its statistical power). It provides sufficient information to determine this value uniquely. The relationship between the given parameters ($\\pi_0, \\alpha_0, \\alpha_{\\text{rep}}, b$) and the desired outcome is mathematically well-defined.\n- **Objective**: The problem is stated in precise, formal, and unbiased language. It is free of subjective or opinion-based assertions.\n- **Completeness and Consistency**: The problem is self-contained. All necessary data and relationships are provided, and they are internally consistent without contradiction.\n- **Realism**: The scenario described is a realistic challenge in translational research, where initial findings may be subject to effect size inflation, and replication power is a critical concern.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and complete. I will proceed with a full solution.\n\nThe solution will be derived in three main steps:\n1.  Determine the noncentral mean of the discovery study, $\\mu_{1}$, based on its specified power $\\pi_{0}$ and significance level $\\alpha_{0}$.\n2.  Calculate the attenuated noncentral mean for the replication study, $\\mu_{2}$, using the winner's curse factor $b$.\n3.  Compute the power of the replication study, $\\pi_{\\mathrm{rep}}$, which is the desired probability of obtaining a significant result at significance level $\\alpha_{\\mathrm{rep}}$ with the noncentral mean $\\mu_{2}$.\n\nFor a one-sided, right-tailed $z$-test conducted at a significance level $\\alpha$, the null hypothesis is rejected if the observed test statistic $Z_{obs}$ is greater than the critical value $z_{1-\\alpha}$. The critical value $z_{1-\\alpha}$ is the $(1-\\alpha)$-quantile of the standard normal distribution, defined by $\\Phi(z_{1-\\alpha}) = 1-\\alpha$, where $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution $\\mathcal{N}(0,1)$.\n\nThe statistical power, $\\pi$, is the probability of correctly rejecting the null hypothesis when the alternative hypothesis is true. Under the alternative, the test statistic $Z$ follows a noncentral normal distribution $Z \\sim \\mathcal{N}(\\mu, 1)$, where $\\mu > 0$. The power is given by:\n$$ \\pi = P(Z > z_{1-\\alpha} | Z \\sim \\mathcal{N}(\\mu,1)) $$\nTo evaluate this probability, we standardize the variable $Z$:\n$$ \\pi = P\\left(\\frac{Z-\\mu}{1} > \\frac{z_{1-\\alpha}-\\mu}{1}\\right) $$\nSince $(Z-\\mu)$ follows a standard normal distribution, we have:\n$$ \\pi = P(\\mathcal{N}(0,1) > z_{1-\\alpha} - \\mu) = 1 - \\Phi(z_{1-\\alpha} - \\mu) $$\nThis is the fundamental equation linking power $\\pi$, significance level $\\alpha$, and noncentrality parameter $\\mu$. This equation can be rearranged to solve for $\\mu$:\n$$ \\Phi(z_{1-\\alpha} - \\mu) = 1 - \\pi $$\n$$ z_{1-\\alpha} - \\mu = \\Phi^{-1}(1 - \\pi) $$\n$$ \\mu = z_{1-\\alpha} - \\Phi^{-1}(1 - \\pi) = \\Phi^{-1}(1 - \\alpha) - \\Phi^{-1}(1 - \\pi) $$\n\n**Step 1: Calculate the noncentral mean of the discovery study ($\\mu_{1}$)**\nWe apply the derived formula using the parameters of the discovery study: $\\pi_{0} = 0.80$ and $\\alpha_{0} = 0.005$.\n$$ \\mu_{1} = \\Phi^{-1}(1 - \\alpha_{0}) - \\Phi^{-1}(1 - \\pi_{0}) $$\n$$ \\mu_{1} = \\Phi^{-1}(1 - 0.005) - \\Phi^{-1}(1 - 0.80) $$\n$$ \\mu_{1} = \\Phi^{-1}(0.995) - \\Phi^{-1}(0.20) $$\nWe use standard values for the quantiles of the normal distribution:\n- $\\Phi^{-1}(0.995) \\approx 2.575829$\n- $\\Phi^{-1}(0.20) = -\\Phi^{-1}(0.80) \\approx -0.841621$\nSubstituting these values:\n$$ \\mu_{1} \\approx 2.575829 - (-0.841621) = 3.417450 $$\n\n**Step 2: Calculate the noncentral mean of the replication study ($\\mu_{2}$)**\nThe problem states that the true effect size is attenuated due to the winner's curse. The noncentral mean for the replication study, $\\mu_{2}$, is given by $\\mu_{2} = b \\mu_{1}$, with $b=0.65$.\n$$ \\mu_{2} = 0.65 \\times \\mu_{1} $$\n$$ \\mu_{2} \\approx 0.65 \\times 3.417450 \\approx 2.221343 $$\n\n**Step 3: Calculate the power of the replication study ($\\pi_{\\mathrm{rep}}$)**\nThe probability that the replication study yields a statistically significant result is, by definition, its statistical power, $\\pi_{\\mathrm{rep}}$. We use the general power formula with the parameters for the replication study: $\\alpha_{\\mathrm{rep}} = 0.025$ and the calculated noncentral mean $\\mu_{2}$.\nThe critical value for the replication study is $z_{1-\\alpha_{\\mathrm{rep}}} = \\Phi^{-1}(1 - 0.025) = \\Phi^{-1}(0.975)$.\n$$ \\pi_{\\mathrm{rep}} = 1 - \\Phi(z_{1-\\alpha_{\\mathrm{rep}}} - \\mu_{2}) $$\n$$ \\pi_{\\mathrm{rep}} = 1 - \\Phi(\\Phi^{-1}(0.975) - \\mu_{2}) $$\nWe use the standard value $\\Phi^{-1}(0.975) \\approx 1.959964$.\nSubstituting the values for $\\Phi^{-1}(0.975)$ and $\\mu_{2}$:\n$$ \\pi_{\\mathrm{rep}} \\approx 1 - \\Phi(1.959964 - 2.221343) $$\n$$ \\pi_{\\mathrm{rep}} \\approx 1 - \\Phi(-0.261379) $$\nUsing the symmetry property of the normal CDF, $\\Phi(-x) = 1 - \\Phi(x)$, we have:\n$$ \\pi_{\\mathrm{rep}} \\approx 1 - (1 - \\Phi(0.261379)) = \\Phi(0.261379) $$\nEvaluating the CDF of the standard normal distribution at this point gives:\n$$ \\pi_{\\mathrm{rep}} \\approx 0.603094 $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\pi_{\\mathrm{rep}} \\approx 0.6031 $$\nThis is the probability that the replication study will be statistically significant.",
            "answer": "$$\n\\boxed{0.6031}\n$$"
        },
        {
            "introduction": "Classical power calculations hinge on a single, fixed estimate for the effect size, yet this value is almost always uncertain before a study is run. This advanced practice introduces the concept of assurance, a hybrid Bayesian-frequentist approach that addresses this limitation . By calculating the sample size needed to achieve a target power across a *distribution* of plausible effect sizes, you will learn a more robust method for planning studies that better reflects the true uncertainty inherent in research.",
            "id": "4610066",
            "problem": "A medical analytics team designing a case-control study to detect differential expression of a biomarker measured from RNA sequencing (RNA-seq) seeks a principled assurance-based sample size. Two independent groups (cases versus controls) will be compared by the difference in their mean expression. Assume each group yields independent observations modeled as Gaussian with a known common variance. Let the true mean difference be denoted by $\\Delta$, the known common standard deviation by $\\sigma$, and the planned test be a two-sided test of $H_{0}:\\Delta=0$ at type I error level $\\alpha$. The design goal is to choose an equal per-group sample size $n$ such that the frequentist power of the two-sample $z$-test is at least a target level $p^{\\star}$ for at least a specified proportion $\\gamma$ of values of $\\Delta$ drawn from a Normal prior distribution that reflects preclinical omics evidence, $\\Delta \\sim \\mathcal{N}(\\mu_{\\Delta}, \\tau^{2})$. This proportion is called the Bayesian assurance.\n\nThe fundamental bases to be used are the definitions of type I error and power in hypothesis testing, properties of the Standard Normal Distribution (SND), the Central Limit Theorem (CLT), and the Normal prior modeling of the uncertain effect $\\Delta$. No shortcut formulas are provided; you must derive all necessary relationships from these bases.\n\nYou must write a program that, for each test case, returns the minimal integer per-group sample size $n$ such that the assurance condition\n$$\n\\Pr_{\\Delta \\sim \\mathcal{N}(\\mu_{\\Delta}, \\tau^{2})}\\left(\\text{Power}(n,\\Delta,\\alpha,\\sigma) \\ge p^{\\star}\\right) \\ge \\gamma\n$$\nholds. If no such $n$ exists up to a provided maximum search bound $n_{\\max}$, return $-1$. All proportions such as $p^{\\star}$ and $\\gamma$ must be treated as decimals (for example, $0.8$), not as percentages. There are no physical units in this problem.\n\nYour program must implement the following scenario and assumptions for its computations:\n- The two-sample $z$-test for the difference in means under known variance, with equal per-group sample size $n$, two-sided significance level $\\alpha$, and known $\\sigma$.\n- The distribution of the standardized test statistic under the true $\\Delta$ follows from the CLT and properties of the Normal distribution.\n- Assurance is defined as the prior probability, under $\\Delta \\sim \\mathcal{N}(\\mu_{\\Delta}, \\tau^{2})$, that the frequentist power function evaluated at $\\Delta$ and $n$ is at least $p^{\\star}$.\n\nTest suite and parameterization:\nEach test case is a tuple $(\\alpha, p^{\\star}, \\gamma, \\sigma, \\mu_{\\Delta}, \\tau, n_{\\max})$ where:\n- $\\alpha$ is the two-sided type I error level, expressed as a decimal in $(0,1)$.\n- $p^{\\star}$ is the target power threshold, expressed as a decimal in $(0,1)$.\n- $\\gamma$ is the assurance requirement, expressed as a decimal in $(0,1)$.\n- $\\sigma$ is the known common standard deviation, a positive real number.\n- $\\mu_{\\Delta}$ is the Normal prior mean for $\\Delta$, a real number.\n- $\\tau$ is the Normal prior standard deviation for $\\Delta$, a nonnegative real number; the case $\\tau=0$ represents a degenerate prior concentrated at $\\Delta=\\mu_{\\Delta}$.\n- $n_{\\max}$ is the maximum per-group sample size to search, a positive integer.\n\nThe test suite to implement in the program is:\n- Case $1$: $(\\alpha, p^{\\star}, \\gamma, \\sigma, \\mu_{\\Delta}, \\tau, n_{\\max}) = (0.05, 0.80, 0.80, 1.2, 0.5, 0.3, 20000)$\n- Case $2$: $(\\alpha, p^{\\star}, \\gamma, \\sigma, \\mu_{\\Delta}, \\tau, n_{\\max}) = (0.01, 0.90, 0.90, 1.0, 0.2, 0.5, 20000)$\n- Case $3$: $(\\alpha, p^{\\star}, \\gamma, \\sigma, \\mu_{\\Delta}, \\tau, n_{\\max}) = (0.05, 0.80, 0.95, 2.0, 0.0, 0.4, 20000)$\n- Case $4$: $(\\alpha, p^{\\star}, \\gamma, \\sigma, \\mu_{\\Delta}, \\tau, n_{\\max}) = (0.05, 0.90, 0.90, 1.0, 0.8, 0.0, 20000)$\n\nFinal output format:\nYour program should produce a single line of output containing the minimal per-group sample sizes for all four cases, in order, as a comma-separated list enclosed in square brackets, for example, $\\texttt{[n_1,n_2,n_3,n_4]}$, where each $n_{i}$ is the integer solution for Case $i$ or $-1$ if no solution exists up to $n_{\\max}$.",
            "solution": "The problem is to determine the minimum integer per-group sample size $n$ that satisfies a Bayesian assurance criterion for a two-sample $z$-test. The problem is scientifically and mathematically well-posed, providing all necessary parameters and a clear objective. Proceeding to the solution.\n\nThe derivation is structured as follows:\n1. Definition of the statistical test and the power function.\n2. Formulation of the condition for achieving a target power $p^{\\star}$.\n3. Definition of assurance and derivation of its formula.\n4. Derivation of a search algorithm to find the minimum sample size $n$.\n\n**1. The Power Function**\n\nLet the observations from the two groups be $X_i \\sim \\mathcal{N}(\\mu_X, \\sigma^2)$ and $Y_i \\sim \\mathcal{N}(\\mu_Y, \\sigma^2)$ for $i=1, \\dots, n$. The true mean difference is $\\Delta = \\mu_X - \\mu_Y$. The estimator for $\\Delta$ is $\\hat{\\Delta} = \\bar{X} - \\bar{Y}$, where $\\bar{X}$ and $\\bar{Y}$ are the sample means. The distribution of the estimator is:\n$$ \\hat{\\Delta} \\sim \\mathcal{N}\\left(\\Delta, \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n}\\right) = \\mathcal{N}\\left(\\Delta, \\frac{2\\sigma^2}{n}\\right) $$\nThe two-sided hypothesis test is for $H_0: \\Delta = 0$ versus $H_1: \\Delta \\neq 0$. The test statistic, assuming $\\sigma$ is known, is:\n$$ Z = \\frac{\\hat{\\Delta} - 0}{\\sqrt{\\frac{2\\sigma^2}{n}}} = \\frac{\\hat{\\Delta}\\sqrt{n}}{\\sigma\\sqrt{2}} $$\nUnder the null hypothesis $H_0$, $\\Delta=0$, so $Z \\sim \\mathcal{N}(0,1)$. The null hypothesis is rejected at a significance level $\\alpha$ if $|Z| > z_{1-\\alpha/2}$, where $z_q$ is the $q$-th quantile of the standard normal distribution.\n\nUnder a true mean difference $\\Delta$, the distribution of $Z$ is:\n$$ Z \\sim \\mathcal{N}\\left(\\frac{\\Delta\\sqrt{n}}{\\sigma\\sqrt{2}}, 1\\right) $$\nThe power of the test, $\\text{Power}(n, \\Delta, \\alpha, \\sigma)$, is the probability of correctly rejecting $H_0$:\n$$ \\text{Power}(n, \\Delta) = \\Pr(|Z| > z_{1-\\alpha/2} \\mid \\Delta) $$\nLet $\\mu_Z = \\frac{\\Delta\\sqrt{n}}{\\sigma\\sqrt{2}}$. The power is:\n$$ \\text{Power}(n, \\Delta) = \\Pr(Z > z_{1-\\alpha/2}) + \\Pr(Z < -z_{1-\\alpha/2}) $$\nLet $W \\sim \\mathcal{N}(0,1)$. Then $Z = W + \\mu_Z$.\n$$ \\text{Power}(n, \\Delta) = \\Pr(W > z_{1-\\alpha/2} - \\mu_Z) + \\Pr(W < -z_{1-\\alpha/2} - \\mu_Z) $$\nUsing the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(\\cdot)$:\n$$ \\text{Power}(n, \\Delta) = \\left(1 - \\Phi(z_{1-\\alpha/2} - \\mu_Z)\\right) + \\Phi(-z_{1-\\alpha/2} - \\mu_Z) $$\nUsing the symmetry property $\\Phi(-x) = 1-\\Phi(x)$, this becomes:\n$$ \\text{Power}(n, \\Delta) = \\Phi(-z_{1-\\alpha/2} + \\mu_Z) + \\Phi(-z_{1-\\alpha/2} - \\mu_Z) $$\nSubstituting for $\\mu_Z$:\n$$ \\text{Power}(n, \\Delta) = \\Phi\\left(\\frac{\\Delta\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2}\\right) + \\Phi\\left(-\\frac{\\Delta\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2}\\right) $$\nFor any reasonably high power, the term $\\frac{|\\Delta|\\sqrt{n}}{\\sigma\\sqrt{2}}$ is positive and large enough to make one of the arguments to $\\Phi$ large and positive, and the other large and negative. The contribution of $\\Phi$ for a large negative argument is negligible. For instance, for $\\Delta>0$, the term $\\Phi\\left(-\\frac{\\Delta\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2}\\right)$ is negligible. This justifies the standard approximation:\n$$ \\text{Power}(n, \\Delta) \\approx \\Phi\\left(\\frac{|\\Delta|\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2}\\right) $$\n\n**2. Condition for Target Power**\n\nWe require the power to be at least a target level $p^{\\star}$:\n$$ \\Phi\\left(\\frac{|\\Delta|\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2}\\right) \\ge p^{\\star} $$\nSince $\\Phi$ is a monotonically increasing function, we can apply its inverse, $z_q = \\Phi^{-1}(q)$, to both sides:\n$$ \\frac{|\\Delta|\\sqrt{n}}{\\sigma\\sqrt{2}} - z_{1-\\alpha/2} \\ge z_{p^{\\star}} $$\n$$ |\\Delta| \\ge \\frac{(z_{1-\\alpha/2} + z_{p^{\\star}})\\sigma\\sqrt{2}}{\\sqrt{n}} $$\nThis inequality defines a threshold for the effect size, $\\Delta_{min}(n)$, which depends on the sample size $n$. The power requirement is met if and only if $|\\Delta| \\ge \\Delta_{min}(n)$, where:\n$$ \\Delta_{min}(n) = \\frac{(z_{1-\\alpha/2} + z_{p^{\\star}})\\sigma\\sqrt{2}}{\\sqrt{n}} $$\n\n**3. Assurance Calculation**\n\nAssurance is the prior probability that the power condition is met. The true effect size $\\Delta$ is modeled as a random variable from a normal prior distribution, $\\Delta \\sim \\mathcal{N}(\\mu_{\\Delta}, \\tau^2)$.\n$$ \\text{Assurance}(n) = \\Pr_{\\Delta \\sim \\mathcal{N}(\\mu_{\\Delta}, \\tau^2)}(|\\Delta| \\ge \\Delta_{min}(n)) $$\nThis probability is the sum of two tail probabilities of the prior distribution:\n$$ \\text{Assurance}(n) = \\Pr(\\Delta \\ge \\Delta_{min}(n)) + \\Pr(\\Delta \\le -\\Delta_{min}(n)) $$\nTo compute this, we standardize $\\Delta$ using $W_{\\Delta} = \\frac{\\Delta - \\mu_{\\Delta}}{\\tau} \\sim \\mathcal{N}(0,1)$:\n$$ \\Pr(\\Delta \\ge \\Delta_{min}(n)) = \\Pr(\\tau W_{\\Delta} + \\mu_{\\Delta} \\ge \\Delta_{min}(n)) = \\Pr\\left(W_{\\Delta} \\ge \\frac{\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) = 1 - \\Phi\\left(\\frac{\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) $$\n$$ \\Pr(\\Delta \\le -\\Delta_{min}(n)) = \\Pr(\\tau W_{\\Delta} + \\mu_{\\Delta} \\le -\\Delta_{min}(n)) = \\Pr\\left(W_{\\Delta} \\le \\frac{-\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) = \\Phi\\left(\\frac{-\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) $$\nCombining these gives the assurance function:\n$$ \\text{Assurance}(n) = 1 - \\Phi\\left(\\frac{\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) + \\Phi\\left(\\frac{-\\Delta_{min}(n) - \\mu_{\\Delta}}{\\tau}\\right) $$\nThe objective is to find the minimum integer $n \\in [1, n_{\\max}]$ such that $\\text{Assurance}(n) \\ge \\gamma$.\n\n**4. Search Algorithm**\n\nAs $n$ increases, $\\Delta_{min}(n)$ decreases. The arguments to $\\Phi$ in the assurance formula change in a way that $\\text{Assurance}(n)$ is a monotonically increasing function of $n$. This property allows the use of an efficient binary search algorithm on the interval $[1, n_{\\max}]$ to find the minimal integer $n$ that satisfies the condition $\\text{Assurance}(n) \\ge \\gamma$.\n\nA special case arises when $\\tau = 0$. The prior for $\\Delta$ becomes a point mass at $\\mu_{\\Delta}$, so $\\Delta = \\mu_{\\Delta}$ with probability $1$. The assurance is $1$ if $\\text{Power}(n, \\mu_{\\Delta}) \\ge p^{\\star}$ and $0$ otherwise. For any $0 < \\gamma \\le 1$, the condition $\\text{Assurance}(n) \\ge \\gamma$ requires the assurance to be $1$. This reduces to the standard power calculation: find $n$ such that $|\\mu_{\\Delta}| \\ge \\Delta_{min}(n)$.\n$$ |\\mu_{\\Delta}| \\ge \\frac{(z_{1-\\alpha/2} + z_{p^{\\star}})\\sigma\\sqrt{2}}{\\sqrt{n}} $$\nIf $\\mu_{\\Delta} \\ne 0$, solving for $n$ gives:\n$$ n \\ge \\frac{2\\sigma^2(z_{1-\\alpha/2} + z_{p^{\\star}})^2}{\\mu_{\\Delta}^2} $$\nThe minimal integer $n$ is the ceiling of the right-hand side. If $\\mu_{\\Delta}=0$, no finite $n$ can satisfy the condition, so no solution exists.\n\nThe final algorithm is:\n1. For a given test case, calculate the required quantiles $z_1 = z_{1-\\alpha/2}$ and $z_2 = z_{p^{\\star}}$.\n2. If $\\tau = 0$, compute $n_{\\text{req}} = \\lceil \\frac{2\\sigma^2(z_1 + z_2)^2}{\\mu_{\\Delta}^2} \\rceil$. If $\\mu_\\Delta = 0$ or $n_{\\text{req}} > n_{\\max}$, return $-1$; otherwise, return $n_{\\text{req}}$.\n3. If $\\tau > 0$, perform a binary search for $n$ in $[1, n_{\\max}]$. For each trial $n$, compute $\\text{Assurance}(n)$. If $\\text{Assurance}(n) \\ge \\gamma$, we have a potential solution and search for a smaller $n$ in the lower half of the interval. Otherwise, we search in the upper half. The last valid $n$ found is the minimal solution. If no $n$ satisfies the condition, return $-1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the minimal integer per-group sample size 'n' based on\n    a Bayesian assurance criterion.\n    \"\"\"\n\n    test_cases = [\n        # (alpha, p_star, gamma, sigma, mu_delta, tau, n_max)\n        (0.05, 0.80, 0.80, 1.2, 0.5, 0.3, 20000),\n        (0.01, 0.90, 0.90, 1.0, 0.2, 0.5, 20000),\n        (0.05, 0.80, 0.95, 2.0, 0.0, 0.4, 20000),\n        (0.05, 0.90, 0.90, 1.0, 0.8, 0.0, 20000),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _solve_one_case(*params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _solve_one_case(alpha, p_star, gamma, sigma, mu_delta, tau, n_max):\n    \"\"\"\n    Calculates the minimal sample size for a single test case.\n\n    Args:\n        alpha (float): Two-sided type I error level.\n        p_star (float): Target power threshold.\n        gamma (float): Assurance requirement.\n        sigma (float): Known common standard deviation.\n        mu_delta (float): Normal prior mean for the effect size Delta.\n        tau (float): Normal prior standard deviation for Delta.\n        n_max (int): Maximum per-group sample size to search.\n\n    Returns:\n        int: The minimal per-group sample size n, or -1 if no solution exists.\n    \"\"\"\n    # Calculate quantiles from the standard normal distribution\n    # z1 is for the two-sided test critical value\n    # z2 is for the power requirement\n    z1 = norm.ppf(1 - alpha / 2)\n    z2 = norm.ppf(p_star)\n\n    # Handle the special case where tau is zero (degenerate prior)\n    if tau == 0:\n        # If mu_delta is 0, the required sample size is infinite.\n        if mu_delta == 0:\n            return -1\n        \n        # This is the standard sample size formula for a two-sample z-test.\n        # It is derived from the requirement that Power(n, mu_delta) >= p_star.\n        numerator = 2 * sigma**2 * (z1 + z2)**2\n        denominator = mu_delta**2\n        \n        n_float = numerator / denominator\n        n = int(np.ceil(n_float))\n        \n        if n > n_max:\n            return -1\n        else:\n            return n\n\n    # General case for tau > 0, using binary search\n    \n    # Pre-calculate a constant part of the Delta_min(n) expression\n    const_term = (z1 + z2) * sigma * np.sqrt(2)\n\n    def calculate_assurance(n):\n        \"\"\"Helper function to compute assurance for a given sample size n.\"\"\"\n        if n == 0: # Assurance is 0 for n=0\n            return 0.0\n        \n        # Calculate minimum effect size needed for power p_star at sample size n\n        delta_min_n = const_term / np.sqrt(n)\n        \n        # Arguments for the normal CDF\n        arg1 = (delta_min_n - mu_delta) / tau\n        arg2 = (-delta_min_n - mu_delta) / tau\n        \n        # Assurance is the probability that |Delta| >= delta_min_n under the prior\n        assurance = (1 - norm.cdf(arg1)) + norm.cdf(arg2)\n        return assurance\n\n    # Binary search for the minimal integer n\n    low = 1\n    high = n_max\n    ans = -1\n\n    while low <= high:\n        mid = low + (high - low) // 2\n        if mid == 0: # Precaution, though low starts at 1\n            low = 1\n            continue\n\n        if calculate_assurance(mid) >= gamma:\n            ans = mid\n            high = mid - 1  # A solution is found, try for a smaller n\n        else:\n            low = mid + 1   # n is too small, need to increase it\n\n    return ans\n\nsolve()\n```"
        }
    ]
}