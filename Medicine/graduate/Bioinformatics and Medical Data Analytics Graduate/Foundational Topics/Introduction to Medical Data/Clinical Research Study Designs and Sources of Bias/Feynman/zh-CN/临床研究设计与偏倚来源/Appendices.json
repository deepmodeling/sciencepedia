{
    "hands_on_practices": [
        {
            "introduction": "在临床研究中，评估诊断或筛查检测的性能是基石之一。本练习将引导你从第一性原理出发，推导并应用关键的性能指标，如阳性预测值（PPV）和阴性预测值（NPV）。通过一个关于罕见病的假设场景，你将亲手揭示检测准确性与其在不同患病率背景下的预测能力之间通常违反直觉的关系，这一现象被称为“基本比率谬误”（base-rate fallacy）。",
            "id": "4547844",
            "problem": "一个由生物信息学支持的临床研究团队正在一个大型队列中评估一种用于罕见病的二元筛查检测。令 $D \\in \\{0,1\\}$ 表示疾病状态（$D=1$ 表示患病），令 $T \\in \\{0,1\\}$ 表示检测结果（$T=1$ 表示阳性结果）。假设以下核心定义：\n- 患病率 $\\pi$ 为 $P(D=1)$。\n- 灵敏度 $Se$ 为 $P(T=1 \\mid D=1)$。\n- 特异度 $Sp$ 为 $P(T=0 \\mid D=0)$。\n- 阳性预测值 (PPV) 为 $P(D=1 \\mid T=1)$。\n- 阴性预测值 (NPV) 为 $P(D=0 \\mid T=0)$。\n\n仅使用上述定义、全概率公式和贝叶斯定理，完成以下任务：\n\n1. 推导以 $Se$、$Sp$ 和 $\\pi$ 表示的 $\\mathrm{PPV}$ 和 $\\mathrm{NPV}$ 的闭式表达式，不引入任何其他参数。\n2. 在筛查情境下，当 $Se = 0.99$、$Sp = 0.98$ 且 $\\pi = 0.005$ 时，计算 $\\mathrm{PPV}$ 和 $\\mathrm{NPV}$ 的数值。结果以小数形式报告，而非百分比，并四舍五入至 $5$ 位有效数字。\n\n最终数值答案请按 $\\mathrm{PPV}$、$\\mathrm{NPV}$ 的顺序报告。最终答案必须表示为单个行向量。",
            "solution": "问题陈述经确认为具有科学依据、提法恰当、客观且完整。它提出了一个生物统计学和流行病学中的标准、可形式化的问题，基于概率论的基本原理。其中没有矛盾、歧义或事实错误。因此，我们可以着手求解。\n\n该问题分为两部分：首先推导阳性预测值（$\\mathrm{PPV}$）和阴性预测值（$\\mathrm{NPV}$）的表达式，然后使用给定的参数进行数值计算。\n\n设 $D$ 为疾病状态的随机变量，$D=1$ 表示患病，$D=0$ 表示未患病。设 $T$ 为检测结果的随机变量，$T=1$ 表示阳性结果，$T=0$ 表示阴性结果。给定的定义如下：\n- 患病率：$\\pi = P(D=1)$。因此，$P(D=0) = 1 - \\pi$。\n- 灵敏度：$Se = P(T=1 \\mid D=1)$。\n- 特异度：$Sp = P(T=0 \\mid D=0)$。\n- 阳性预测值：$\\mathrm{PPV} = P(D=1 \\mid T=1)$。\n- 阴性预测值：$\\mathrm{NPV} = P(D=0 \\mid T=0)$。\n\n此外，我们可以定义假阳性率为 $P(T=1 \\mid D=0) = 1 - P(T=0 \\mid D=0) = 1 - Sp$。\n假阴性率为 $P(T=0 \\mid D=1) = 1 - P(T=1 \\mid D=1) = 1 - Se$。\n\n**第1部分：$\\mathrm{PPV}$ 与 $\\mathrm{NPV}$ 的推导**\n\n**阳性预测值 ($\\mathrm{PPV}$) 的推导**\n我们需要求 $\\mathrm{PPV} = P(D=1 \\mid T=1)$ 的表达式。使用贝叶斯定理：\n$$ \\mathrm{PPV} = P(D=1 \\mid T=1) = \\frac{P(T=1 \\mid D=1) P(D=1)}{P(T=1)} $$\n分子中的项由定义直接给出：$P(T=1 \\mid D=1) = Se$ 且 $P(D=1) = \\pi$。\n分母 $P(T=1)$ 是检测结果为阳性的总概率。我们使用全概率公式，以疾病状态 $D$ 为条件对其进行展开：\n$$ P(T=1) = P(T=1 \\mid D=1) P(D=1) + P(T=1 \\mid D=0) P(D=0) $$\n代入已定义的项：\n- $P(T=1 \\mid D=1) = Se$\n- $P(D=1) = \\pi$\n- $P(T=1 \\mid D=0) = 1 - Sp$\n- $P(D=0) = 1 - \\pi$\n\n这得到：\n$$ P(T=1) = (Se)(\\pi) + (1 - Sp)(1 - \\pi) $$\n将此分母代回 $\\mathrm{PPV}$ 的贝叶斯定理表达式中：\n$$ \\mathrm{PPV} = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)} $$\n这就是所求的 $\\mathrm{PPV}$ 的闭式表达式。\n\n**阴性预测值 ($\\mathrm{NPV}$) 的推导**\n我们需要求 $\\mathrm{NPV} = P(D=0 \\mid T=0)$ 的表达式。使用贝叶斯定理：\n$$ \\mathrm{NPV} = P(D=0 \\mid T=0) = \\frac{P(T=0 \\mid D=0) P(D=0)}{P(T=0)} $$\n分子中的项由定义给出：$P(T=0 \\mid D=0) = Sp$ 且 $P(D=0) = 1-\\pi$。\n分母 $P(T=0)$ 是检测结果为阴性的总概率。使用全概率公式：\n$$ P(T=0) = P(T=0 \\mid D=0) P(D=0) + P(T=0 \\mid D=1) P(D=1) $$\n代入已定义的项：\n- $P(T=0 \\mid D=0) = Sp$\n- $P(D=0) = 1 - \\pi$\n- $P(T=0 \\mid D=1) = 1 - Se$\n- $P(D=1) = \\pi$\n\n这得到：\n$$ P(T=0) = (Sp)(1 - \\pi) + (1 - Se)(\\pi) $$\n将此分母代回 $\\mathrm{NPV}$ 的贝叶斯定理表达式中：\n$$ \\mathrm{NPV} = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se)\\pi} $$\n这就是所求的 $\\mathrm{NPV}$ 的闭式表达式。\n\n**第2部分：数值计算**\n\n给定以下数值：\n- $Se = 0.99$\n- $Sp = 0.98$\n- $\\pi = 0.005$\n\n我们也计算互补概率：\n- $1 - Se = 1 - 0.99 = 0.01$\n- $1 - Sp = 1 - 0.98 = 0.02$\n- $1 - \\pi = 1 - 0.005 = 0.995$\n\n**$\\mathrm{PPV}$ 的计算**\n使用推导出的公式：\n$$ \\mathrm{PPV} = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)} $$\n$$ \\mathrm{PPV} = \\frac{0.99 \\times 0.005}{(0.99 \\times 0.005) + (0.02 \\times 0.995)} $$\n$$ \\mathrm{PPV} = \\frac{0.00495}{0.00495 + 0.0199} $$\n$$ \\mathrm{PPV} = \\frac{0.00495}{0.02485} \\approx 0.19919517... $$\n四舍五入到 $5$ 位有效数字，我们得到 $\\mathrm{PPV} = 0.19920$。\n\n**$\\mathrm{NPV}$ 的计算**\n使用推导出的公式：\n$$ \\mathrm{NPV} = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se)\\pi} $$\n$$ \\mathrm{NPV} = \\frac{0.98 \\times 0.995}{(0.98 \\times 0.995) + (0.01 \\times 0.005)} $$\n$$ \\mathrm{NPV} = \\frac{0.9751}{0.9751 + 0.00005} $$\n$$ \\mathrm{NPV} = \\frac{0.9751}{0.97515} \\approx 0.99994872... $$\n四舍五入到 $5$ 位有效数字，我们得到 $\\mathrm{NPV} = 0.99995$。\n\n这些结果展示了罕见病筛查中的一个关键概念：即使使用灵敏度和特异度都非常高的检测，由于该疾病的患病率很低，其阳性预测值也可能很低。相反，阴性预测值则非常高。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.19920  0.99995 \\end{pmatrix}}$$"
        },
        {
            "introduction": "随机对照试验（RCT）是临床研究的黄金标准，但具体的随机化方法会显著影响研究的统计功效。本实践旨在比较不同的随机化方案，包括简单随机化、区组随机化和分层随机化。你将需要量化这些设计选择如何通过平衡重要的基线协变量来降低治疗效果估计量的方差，从而加深对试验设计如何直接影响结果精确性的理解。",
            "id": "4547834",
            "problem": "一项随机对照临床试验招募了 $n = 240$ 名参与者，旨在比较一种二元处理（$T_{i} \\in \\{0,1\\}$）。参与者 $i$ 的主要结局由以下线性数据生成过程建模：\n$$\nY_{i} = \\beta_{0} + \\beta_{T} T_{i} + \\beta_{X} X_{i} + \\epsilon_{i},\n$$\n其中 $X_{i}$ 是一个基线协变量，其总体均值为 $0$，方差为 $\\sigma_{X}^{2} = 4$；$\\epsilon_{i}$ 是一个独立误差项，其均值为 $0$，方差为 $\\sigma_{\\epsilon}^{2} = 9$；且 $\\beta_{X} = 0.5$。所有 $(X_{i}, \\epsilon_{i})$ 对所有 $i$ 都是独立同分布的，并且独立于处理分配机制。考虑处理效应的未经调整的均值差估计量，\n$$\n\\hat{\\Delta} = \\bar{Y}_{T} - \\bar{Y}_{C},\n$$\n其中 $\\bar{Y}_{T}$ 和 $\\bar{Y}_{C}$ 分别表示处理组和对照组参与者的 $Y_{i}$ 样本均值。\n\n比较三种随机化方案：\n- 简单随机化：每位参与者以 $1/2$ 的概率被独立分配到处理组，导致处理组的样本量是随机的，$n_{T} \\sim \\mathrm{Binomial}(n, 1/2)$，且 $n_{C} = n - n_{T}$。\n- 区组随机化：使用置换区组保证总体分配比例为 $1{:}1$，因此精确地有 $n_{T} = n_{C} = n/2$。\n- 分层随机化：参与者根据一个分类基线变量 $Z \\in \\{1,2,3\\}$ 被分为三层，各层大小为 $n_{1} = n_{2} = n_{3} = 80$。在每一层内，分配比例精确为 $1{:}1$，因此对于每一层 $z$，$n_{T,z} = n_{C,z} = n_{z}/2$。$X$ 的层内方差满足 $\\mathrm{Var}(X \\mid Z = 1) = 1$，$\\mathrm{Var}(X \\mid Z = 2) = 2$，$\\mathrm{Var}(X \\mid Z = 3) = 3$，并且总体方差 $\\sigma_{X}^{2} = 4$ 与全方差定律一致。\n\n从关于独立抽样、样本均值方差和全方差定律的第一性原理出发，推导 $\\hat{\\Delta}$ 在每种方案下的大样本方差。对于简单随机化，当 $n_{T} \\sim \\mathrm{Binomial}(n,1/2)$ 且 $n$ 很大时，你可以使用在 $n/2$ 附近的二阶展开来计算期望 $\\mathbb{E}[1/n_{T} + 1/n_{C}]$。将你的最终答案表示为精确的闭式解析表达式（不进行四舍五入）。按（简单、区组、分层）的顺序，将这三个方差以行矩阵的形式报告。",
            "solution": "问题要求在三种不同的随机化方案下，计算未经调整的均值差估计量 $\\hat{\\Delta} = \\bar{Y}_{T} - \\bar{Y}_{C}$ 的大样本方差。\n\n参与者 $i$ 的结局 $Y_i$ 的数据生成过程由以下线性模型给出：\n$$\nY_{i} = \\beta_{0} + \\beta_{T} T_{i} + \\beta_{X} X_{i} + \\epsilon_{i}\n$$\n其中 $T_i=1$ 表示处理组，$T_i=0$ 表示对照组。协变量 $X_i$ 和误差 $\\epsilon_i$ 是具有以下性质的随机变量：\n$\\mathbb{E}[X_i] = 0$，$\\mathrm{Var}(X_i) = \\sigma_X^2 = 4$。\n$\\mathbb{E}[\\epsilon_i] = 0$，$\\mathrm{Var}(\\epsilon_i) = \\sigma_\\epsilon^2 = 9$。\n协变量的系数为 $\\beta_X = 0.5$。随机变量集 $\\{X_i\\}_{i=1}^n$ 和 $\\{\\epsilon_i\\}_{i=1}^n$ 相互独立，且独立于处理分配向量 $T=(T_1, \\dots, T_n)$。\n\n估计量 $\\hat{\\Delta}$ 可以用模型的分量来表示。设 $\\bar{Y}_T$ 和 $\\bar{Y}_C$ 分别为处理组和对照组的样本均值，其样本量分别为 $n_T$ 和 $n_C$。\n$$\n\\bar{Y}_{T} = \\frac{1}{n_T}\\sum_{i:T_i=1} Y_i = \\frac{1}{n_T}\\sum_{i:T_i=1} (\\beta_0 + \\beta_T + \\beta_X X_i + \\epsilon_i) = \\beta_0 + \\beta_T + \\beta_X \\bar{X}_T + \\bar{\\epsilon}_T\n$$\n$$\n\\bar{Y}_{C} = \\frac{1}{n_C}\\sum_{i:T_i=0} Y_i = \\frac{1}{n_C}\\sum_{i:T_i=0} (\\beta_0 + \\beta_X X_i + \\epsilon_i) = \\beta_0 + \\beta_X \\bar{X}_C + \\bar{\\epsilon}_C\n$$\n其中 $\\bar{X}_T, \\bar{\\epsilon}_T$ 和 $\\bar{X}_C, \\bar{\\epsilon}_C$ 分别是各组中协变量和误差的样本均值。\n因此，该估计量为：\n$$\n\\hat{\\Delta} = \\bar{Y}_T - \\bar{Y}_C = \\beta_T + \\beta_X(\\bar{X}_T - \\bar{X}_C) + (\\bar{\\epsilon}_T - \\bar{\\epsilon}_C)\n$$\n为了求 $\\hat{\\Delta}$ 的方差，我们注意到 $\\beta_T$ 是一个常数。因为随机变量集 $\\{X_i\\}$ 和 $\\{\\epsilon_i\\}$ 是独立的，所以它们的任何函数，例如 $(\\bar{X}_T - \\bar{X}_C)$ 和 $(\\bar{\\epsilon}_T - \\bar{\\epsilon}_C)$，也是独立的。因此，它们和的方差是它们方差的和：\n$$\n\\mathrm{Var}(\\hat{\\Delta}) = \\mathrm{Var}\\left(\\beta_X(\\bar{X}_T - \\bar{X}_C) + (\\bar{\\epsilon}_T - \\bar{\\epsilon}_C)\\right) = \\beta_X^2 \\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) + \\mathrm{Var}(\\bar{\\epsilon}_T - \\bar{\\epsilon}_C)\n$$\n我们现在将为每种随机化方案计算这两个方差项。我们使用全方差定律，以处理分配向量 $T$ 为条件，而 $T$ 本身是随机的。对于任何随机变量 $A$，有 $\\mathrm{Var}(A) = \\mathbb{E}[\\mathrm{Var}(A|T)] + \\mathrm{Var}(\\mathbb{E}[A|T])$.\n\n我们来分析 $\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C)$ 这一项。\n$\\mathbb{E}[\\bar{X}_T|T] = \\frac{1}{n_T}\\sum_{i:T_i=1}\\mathbb{E}[X_i] = 0$，类似地 $\\mathbb{E}[\\bar{X}_C|T]=0$。因此，$\\mathbb{E}[\\bar{X}_T - \\bar{X}_C|T] = 0$。\n这意味着 $\\mathrm{Var}(\\mathbb{E}[\\bar{X}_T - \\bar{X}_C|T]) = \\mathrm{Var}(0) = 0$。所以，$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) = \\mathbb{E}[\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C|T)]$。\n在给定 $T$ 的条件下，处理组和对照组是参与者的不相交集合。随机变量 $X_i$ 是独立的。因此，在给定 $T$ 的条件下，$\\bar{X}_T$ 和 $\\bar{X}_C$ 是独立的。\n$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C|T) = \\mathrm{Var}(\\bar{X}_T|T) + \\mathrm{Var}(\\bar{X}_C|T)$。\n对于一组大小为 $k$、方差为 $\\sigma_X^2$ 的独立同分布变量，其样本均值的方差为 $\\sigma_X^2/k$。\n$\\mathrm{Var}(\\bar{X}_T|T) = \\sigma_X^2/n_T$ 且 $\\mathrm{Var}(\\bar{X}_C|T) = \\sigma_X^2/n_C$。\n所以，$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C|T) = \\sigma_X^2(\\frac{1}{n_T} + \\frac{1}{n_C})$。\n无条件方差是在随机化方案下的期望：\n$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) = \\mathbb{E}\\left[\\sigma_X^2\\left(\\frac{1}{n_T} + \\frac{1}{n_C}\\right)\\right] = \\sigma_X^2 \\mathbb{E}\\left[\\frac{1}{n_T} + \\frac{1}{n_C}\\right]$。\n根据同样的逻辑，$\\mathrm{Var}(\\bar{\\epsilon}_T - \\bar{\\epsilon}_C) = \\sigma_\\epsilon^2 \\mathbb{E}\\left[\\frac{1}{n_T} + \\frac{1}{n_C}\\right]$。\n这个通用公式适用于参与者未被分层的简单随机化和区组随机化。我们定义一个有效结局方差 $\\sigma^2_{\\text{eff}} = \\beta_X^2 \\sigma_X^2 + \\sigma_\\epsilon^2 = (0.5)^2(4) + 9 = 1 + 9 = 10$。\n那么，对于这些方案，$\\mathrm{Var}(\\hat{\\Delta}) = \\sigma^2_{\\text{eff}} \\mathbb{E}\\left[\\frac{1}{n_T} + \\frac{1}{n_C}\\right]$。\n\n**1. 简单随机化**\n每位参与者以概率 $p=1/2$ 被分配到处理组。处理组的参与者数量 $n_T$ 服从二项分布，$n_T \\sim \\mathrm{Binomial}(n, 1/2)$，其中 $n=240$。\n其期望为 $\\mathbb{E}[n_T] = np = 120$，方差为 $\\mathrm{Var}(n_T) = np(1-p) = 240(1/2)(1/2) = 60$。\n为了求出 $\\mathbb{E}[1/n_T + 1/(n-n_T)]$，我们使用题目建议的，在 $\\mathbb{E}[n_T] = n/2$ 附近对 $f(k) = 1/k + 1/(n-k)$ 进行的二阶泰勒展开。\n$\\mathbb{E}[f(n_T)] \\approx f(n/2) + \\frac{1}{2}f''(n/2)\\mathrm{Var}(n_T)$.\n$f(n/2) = 1/(n/2) + 1/(n/2) = 4/n$.\n$f'(k) = -1/k^2 + 1/(n-k)^2$，所以 $f'(n/2) = 0$。\n$f''(k) = 2/k^3 + 2/(n-k)^3$，所以 $f''(n/2) = 2/(n/2)^3 + 2/(n/2)^3 = 32/n^3$。\n$\\mathbb{E}\\left[\\frac{1}{n_T} + \\frac{1}{n_C}\\right] \\approx \\frac{4}{n} + \\frac{1}{2}\\left(\\frac{32}{n^3}\\right)\\left(\\frac{n}{4}\\right) = \\frac{4}{n} + \\frac{4}{n^2}$.\n对于 $n=240$：$\\mathbb{E}[\\dots] \\approx \\frac{4}{240} + \\frac{4}{240^2} = \\frac{1}{60} + \\frac{4}{57600} = \\frac{1}{60} + \\frac{1}{14400} = \\frac{240+1}{14400} = \\frac{241}{14400}$。\n该估计量的方差为：\n$\\mathrm{Var}(\\hat{\\Delta})_{\\text{simple}} = 10 \\times \\frac{241}{14400} = \\frac{241}{1440}$。\n\n**2. 区组随机化**\n分配是固定的，$n_T = n_C = n/2 = 120$。因此，期望的计算是显而易见的。\n$\\mathbb{E}\\left[\\frac{1}{n_T} + \\frac{1}{n_C}\\right] = \\frac{1}{n/2} + \\frac{1}{n/2} = \\frac{4}{n}$。\n对于 $n=240$：$\\frac{4}{240} = \\frac{1}{60}$。\n该估计量的方差为：\n$\\mathrm{Var}(\\hat{\\Delta})_{\\text{block}} = 10 \\times \\frac{4}{n} = 10 \\times \\frac{1}{60} = \\frac{1}{6}$。\n\n**3. 分层随机化**\n总体按 $Z \\in \\{1,2,3\\}$ 分层，每层大小为 $n_1=n_2=n_3=80$。在每层 $z$ 内，分配是固定的：$n_{T,z}=n_{C,z}=40$。总样本量也是固定的：$n_T = \\sum_z n_{T,z} = 120$ 且 $n_C = \\sum_z n_{C,z} = 120$。\n未经调整的样本均值 $\\bar{X}_T$ 和 $\\bar{X}_C$ 是各层特有均值的加权平均：\n$\\bar{X}_T = \\frac{1}{n_T}\\sum_z n_{T,z}\\bar{X}_{T,z} = \\frac{40}{120}\\sum_z \\bar{X}_{T,z} = \\frac{1}{3}\\sum_z \\bar{X}_{T,z}$。类似地，$\\bar{X}_C = \\frac{1}{3}\\sum_z \\bar{X}_{C,z}$。\n差值为 $\\bar{X}_T - \\bar{X}_C = \\frac{1}{3}\\sum_{z=1}^3 (\\bar{X}_{T,z} - \\bar{X}_{C,z})$。\n由于来自不同层的样本是独立的，方差为：\n$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) = \\frac{1}{9}\\sum_{z=1}^3 \\mathrm{Var}(\\bar{X}_{T,z} - \\bar{X}_{C,z})$。\n在每层 $z$ 内，参与者从一个子总体中抽取，其协变量方差为 $\\sigma_{X,z}^2 = \\mathrm{Var}(X|Z=z)$。\n$\\mathrm{Var}(\\bar{X}_{T,z} - \\bar{X}_{C,z}) = \\mathrm{Var}(\\bar{X}_{T,z}) + \\mathrm{Var}(\\bar{X}_{C,z}) = \\frac{\\sigma_{X,z}^2}{n_{T,z}} + \\frac{\\sigma_{X,z}^2}{n_{C,z}} = \\sigma_{X,z}^2\\left(\\frac{1}{40}+\\frac{1}{40}\\right) = \\frac{\\sigma_{X,z}^2}{20}$。\n$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) = \\frac{1}{9}\\sum_{z=1}^3 \\frac{\\sigma_{X,z}^2}{20} = \\frac{1}{180}(\\sigma_{X,1}^2 + \\sigma_{X,2}^2 + \\sigma_{X,3}^2)$。\n使用给定值 $\\mathrm{Var}(X|Z=1)=1, \\mathrm{Var}(X|Z=2)=2, \\mathrm{Var}(X|Z=3)=3$：\n$\\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) = \\frac{1}{180}(1+2+3) = \\frac{6}{180} = \\frac{1}{30}$。\n对于误差项，$\\epsilon_i$ 是独立同分布的，其方差为 $\\sigma_\\epsilon^2=9$，与分层无关。所以，对于所有 $z$，都有 $\\mathrm{Var}(\\epsilon|Z=z)=\\sigma_\\epsilon^2=9$。\n$\\mathrm{Var}(\\bar{\\epsilon}_T - \\bar{\\epsilon}_C) = \\frac{1}{9}\\sum_{z=1}^3 \\mathrm{Var}(\\bar{\\epsilon}_{T,z} - \\bar{\\epsilon}_{C,z}) = \\frac{1}{9}\\sum_{z=1}^3 \\frac{\\sigma_\\epsilon^2}{20} = \\frac{3 \\times (9/20)}{9} = \\frac{3}{20}$。\n分层方案的总方差为：\n$\\mathrm{Var}(\\hat{\\Delta})_{\\text{strat}} = \\beta_X^2 \\mathrm{Var}(\\bar{X}_T - \\bar{X}_C) + \\mathrm{Var}(\\bar{\\epsilon}_T - \\bar{\\epsilon}_C) = (0.5)^2\\left(\\frac{1}{30}\\right) + \\frac{3}{20}$。\n$\\mathrm{Var}(\\hat{\\Delta})_{\\text{strat}} = \\frac{1}{4}\\cdot\\frac{1}{30} + \\frac{3}{20} = \\frac{1}{120} + \\frac{18}{120} = \\frac{19}{120}$。\n\n这三个方差是：\n- 简单随机化：$\\frac{241}{1440}$\n- 区组随机化：$\\frac{1}{6}$\n- 分层随机化：$\\frac{19}{120}$\n\n为了比较，我们可以使用公分母 $1440$：\n- 简单：$\\frac{241}{1440} \\approx 0.16736$\n- 区组：$\\frac{1}{6} = \\frac{240}{1440} \\approx 0.16667$\n- 分层：$\\frac{19}{120} = \\frac{19 \\times 12}{120 \\times 12} = \\frac{228}{1440} \\approx 0.15833$\n结果表明，区组随机化通过消除随机样本量带来的方差，相比简单随机化有微小的改进。分层随机化通过在处理组之间平衡预后协变量 $X$，提供了更实质性的改进，这减少了与该协变量相关的方差分量。\n\n最终答案以精确分数的形式报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{241}{1440}  \\frac{1}{6}  \\frac{19}{120}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "生存分析或称时间-事件分析，是临床研究中的常用方法，但它也面临着独特的挑战，其中之一就是“竞争风险”（competing risks）——一个在肿瘤学等领域常见的偏倚来源。本练习将通过一个具体案例，展示忽略竞争风险、采用朴素方法分析特定原因终点所导致的偏倚。你将学习并实践如何使用子分布函数（subdistribution function）正确地计算累积发生率，从而掌握处理此类复杂数据的关键技能。",
            "id": "4547838",
            "problem": "一项精准肿瘤学的回顾性队列研究使用整理过的电子健康记录(EHR)数据来评估具有两个互斥终点（事件 $A$：疾病特异性死亡；事件 $B$：非疾病性死亡）的事件发生时间结局。研究人员通过一项分层Cox型分析，估计出特定原因风险率在时间上是恒定的，并稳定在该队列的基线水平。估计的特定原因风险率为 $h_{A}(t) = \\lambda_{A}$ 和 $h_{B}(t) = \\lambda_{B}$，其中 $\\lambda_{A} = 0.1\\,\\text{year}^{-1}$ 且 $\\lambda_{B} = 0.05\\,\\text{year}^{-1}$。考虑一个为期 $t = 6\\,\\text{years}$ 的随访期。\n\n使用在存在竞争风险情况下的风险率、生存和累积发生率的基本定义，完成以下任务：\n- 在不存在竞争风险的不正确建模假设下（即，仅使用事件 $A$ 的特定原因风险率来估计到时间 $t$ 时事件 $A$ 的发生风险），计算在时间 $t$ 的累积发生率的朴素估计量。\n- 推导并计算在时间 $t$ 时事件 $A$ 的正确累积发生率函数（也称为次分布函数），该函数通过免于任何事件的总生存来考虑两个终点的联合风险。\n- 最后，报告定义为朴素估计量减去在 $t=6$ 时求值的正确次分布函数的绝对偏差。\n\n将最终答案表示为小数。将最终答案四舍五入到四位有效数字。最终表达式中不允许使用百分号。",
            "solution": "我们从竞争风险的核心定义开始。假设有两个互斥的失败原因，$A$ 和 $B$，其特定原因风险率分别为 $h_{A}(t)$ 和 $h_{B}(t)$。在时间 $t$ 因任何原因失败的总风险率为 $h(t) = h_{A}(t) + h_{B}(t)$。到时间 $t$ 时，免于任何事件的总体生存函数是\n$$\nS(t) = \\exp\\Big(-\\int_{0}^{t} h(u)\\,du\\Big) = \\exp\\Big(-\\int_{0}^{t} \\big(h_{A}(u) + h_{B}(u)\\big)\\,du\\Big).\n$$\n到时间 $t$ 时，原因 $A$ 的累积发生率函数（次分布函数）定义为\n$$\nF_{A}(t) = \\int_{0}^{t} S(u)\\,h_{A}(u)\\,du,\n$$\n它表示到时间 $t$ 为止因原因 $A$ 而失败的概率，同时正确地考虑了因所有原因导致的风险集耗减。\n\n相比之下，一个常见但不正确的方法是忽略竞争风险 $B$，并仅使用 $A$ 的特定原因风险率，通过单一原因模型中风险率和生存之间的关系来计算事件 $A$ 的累积概率。在这个错误设定的模型下，仅考虑事件A时的生存函数是\n$$\n\\tilde{S}_{A}(t) = \\exp\\Big(-\\int_{0}^{t} h_{A}(u)\\,du\\Big),\n$$\n并且朴素累积发生率估计量（在存在竞争风险时是不正确的）是\n$$\n\\tilde{F}_{A}(t) = 1 - \\tilde{S}_{A}(t) = 1 - \\exp\\Big(-\\int_{0}^{t} h_{A}(u)\\,du\\Big).\n$$\n\n在本研究中，风险率是恒定的：$h_{A}(t) = \\lambda_{A}$ 和 $h_{B}(t) = \\lambda_{B}$，其中 $\\lambda_{A} = 0.1\\,\\text{year}^{-1}$ 且 $\\lambda_{B} = 0.05\\,\\text{year}^{-1}$。因此，积分可以简化。\n\n首先，计算在 $t = 6$ 时的朴素估计量：\n$$\n\\int_{0}^{t} h_{A}(u)\\,du = \\int_{0}^{6} \\lambda_{A}\\,du = \\lambda_{A} \\cdot 6 = 0.1 \\cdot 6 = 0.6,\n$$\n所以\n$$\n\\tilde{F}_{A}(6) = 1 - \\exp(-0.6).\n$$\n\n其次，计算在 $t = 6$ 时的正确累积发生率函数。对于恒定风险率，总生存函数为\n$$\nS(t) = \\exp\\Big(-\\int_{0}^{t} (\\lambda_{A} + \\lambda_{B})\\,du\\Big) = \\exp\\big(-(\\lambda_{A} + \\lambda_{B}) t\\big) = \\exp\\big(-0.15 \\cdot t\\big).\n$$\n因此，\n$$\nF_{A}(t) = \\int_{0}^{t} S(u)\\,h_{A}(u)\\,du = \\int_{0}^{t} \\exp\\big(-(\\lambda_{A} + \\lambda_{B}) u\\big)\\,\\lambda_{A}\\,du.\n$$\n这个积分是初等的：\n$$\nF_{A}(t) = \\lambda_{A} \\int_{0}^{t} \\exp\\big(-(\\lambda_{A} + \\lambda_{B}) u\\big)\\,du = \\lambda_{A} \\cdot \\frac{1 - \\exp\\big(-(\\lambda_{A} + \\lambda_{B}) t\\big)}{\\lambda_{A} + \\lambda_{B}}.\n$$\n代入 $t = 6$ 和 $(\\lambda_{A}, \\lambda_{B}) = (0.1, 0.05)$ 可得\n$$\nF_{A}(6) = \\frac{\\lambda_{A}}{\\lambda_{A} + \\lambda_{B}} \\Big(1 - \\exp\\big(-(\\lambda_{A} + \\lambda_{B}) \\cdot 6\\big)\\Big) = \\frac{0.1}{0.15} \\Big(1 - \\exp(-0.9)\\Big).\n$$\n\n绝对偏差，定义为在 $t=6$ 时的朴素估计量减去正确的次分布函数，为\n$$\n\\text{Bias} = \\tilde{F}_{A}(6) - F_{A}(6) = \\Big(1 - \\exp(-0.6)\\Big) - \\frac{0.1}{0.15} \\Big(1 - \\exp(-0.9)\\Big).\n$$\n\n进行数值计算，结果保留四位有效数字。首先，计算各指数项的值：\n$$\n\\exp(-0.6) \\approx 0.548811636,\\qquad \\exp(-0.9) \\approx 0.406569660.\n$$\n因此，\n$$\n\\tilde{F}_{A}(6) \\approx 1 - 0.548811636 = 0.451188364,\n$$\n并且\n$$\nF_{A}(6) \\approx \\frac{0.1}{0.15} \\Big(1 - 0.406569660\\Big) = \\frac{2}{3} \\cdot 0.593430340 \\approx 0.395620227.\n$$\n因此，\n$$\n\\text{Bias} \\approx 0.451188364 - 0.395620227 = 0.055568137.\n$$\n四舍五入到四位有效数字并表示为小数，最终答案是 $0.05557$。",
            "answer": "$$\\boxed{0.05557}$$"
        }
    ]
}