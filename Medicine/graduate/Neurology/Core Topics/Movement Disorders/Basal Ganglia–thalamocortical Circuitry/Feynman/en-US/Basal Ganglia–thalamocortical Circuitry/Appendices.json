{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the function of the basal ganglia, we must first understand its most fundamental mechanism: disinhibition. This practice guides you through an analytical derivation of this core concept within a simplified model of the direct pathway. By representing neural populations with linear equations, we can mathematically demonstrate how a cortical signal, transmitted through two successive inhibitory synapses, results in a net facilitation of thalamic activity, effectively providing a \"Go\" signal for action .",
            "id": "4454482",
            "problem": "Consider a simplified, steady-state, linearized model of the basal ganglia–thalamocortical direct pathway. Cortical pyramidal neurons provide excitatory glutamatergic drive to striatal medium spiny neurons, which in turn provide inhibitory gamma-aminobutyric acid (GABA)ergic input to the internal segment of the Globus Pallidus (GPi) and the Substantia Nigra pars reticulata (SNr). The GPi/SNr provide tonic inhibitory GABAergic output to thalamic relay neurons. Let the population-averaged firing rates be denoted by $r_{C}$ (cortex), $r_{S}$ (striatum), $r_{G}$ (GPi/SNr), and $r_{T}$ (thalamus). Assume the following monotone, linear relations around a baseline:\n- $r_{S} = k_{CS}\\, r_{C}$ with $k_{CS}  0$ (cortex-to-striatum is excitatory),\n- $r_{G} = \\bar{r}_{G} - k_{SG}\\, r_{S}$ with $k_{SG}  0$ and $\\bar{r}_{G}  0$ (striatum-to-GPi/SNr is inhibitory and GPi/SNr are tonically active),\n- $r_{T} = \\bar{r}_{T} - k_{GT}\\, r_{G}$ with $k_{GT}  0$ and $\\bar{r}_{T} \\ge 0$ (GPi/SNr-to-thalamus is inhibitory).\n\nStarting from these foundational sign conventions for glutamatergic excitation and GABAergic inhibition and the tonic nature of GPi/SNr output, analytically derive the net thalamic modulation gain $G$, defined as the partial derivative $G \\equiv \\frac{\\partial r_{T}}{\\partial r_{C}}$ evaluated at the baseline. Your derivation should make explicit how disinhibition arises in this chain. Express your final answer as a single closed-form symbolic expression in terms of $k_{CS}$, $k_{SG}$, and $k_{GT}$. No numerical approximation is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded in a standard, simplified model of neural circuitry, is mathematically well-posed, and is stated in precise, objective language. All necessary information is provided, and there are no internal contradictions. We may therefore proceed with the derivation.\n\nThe objective is to compute the net thalamic modulation gain, $G$, defined as the partial derivative of the thalamic firing rate, $r_{T}$, with respect to the cortical firing rate, $r_{C}$. This quantity measures the overall sensitivity of the pathway's output to its input.\n$$\nG \\equiv \\frac{\\partial r_{T}}{\\partial r_{C}}\n$$\nThe dynamics of the simplified direct pathway are described by a cascade of linear equations relating the population-averaged firing rates of the cortex ($r_{C}$), striatum ($r_{S}$), globus pallidus interna/substantia nigra pars reticulata ($r_{G}$), and thalamus ($r_{T}$):\n1.  $r_{S} = k_{CS}\\, r_{C}$\n2.  $r_{G} = \\bar{r}_{G} - k_{SG}\\, r_{S}$\n3.  $r_{T} = \\bar{r}_{T} - k_{GT}\\, r_{G}$\n\nThe constraints on the parameters are $k_{CS}  0$, $k_{SG}  0$, $k_{GT}  0$, $\\bar{r}_{G}  0$, and $\\bar{r}_{T} \\ge 0$.\n\nTo find the relationship between the output $r_{T}$ and the input $r_{C}$, we can express $r_{T}$ as a function of $r_{C}$ through systematic substitution.\n\nFirst, substitute the expression for $r_{S}$ from equation (1) into equation (2):\n$$\nr_{G} = \\bar{r}_{G} - k_{SG}\\, (k_{CS}\\, r_{C}) = \\bar{r}_{G} - k_{SG}\\, k_{CS}\\, r_{C}\n$$\nThis equation shows how the activity of the GPi/SNr, $r_{G}$, is modulated by the cortical input, $r_{C}$.\n\nNext, substitute this new expression for $r_{G}$ into equation (3):\n$$\nr_{T} = \\bar{r}_{T} - k_{GT}\\, (\\bar{r}_{G} - k_{SG}\\, k_{CS}\\, r_{C})\n$$\nDistributing the term $k_{GT}$ gives:\n$$\nr_{T} = \\bar{r}_{T} - k_{GT}\\, \\bar{r}_{G} + k_{GT}\\, k_{SG}\\, k_{CS}\\, r_{C}\n$$\nThis equation represents the complete input-output function of the model, $r_{T}(r_{C})$. It is a linear function of $r_{C}$. The gain $G$ is the slope of this function.\n\nTo find the gain $G$, we differentiate $r_{T}$ with respect to $r_{C}$:\n$$\nG = \\frac{\\partial r_{T}}{\\partial r_{C}} = \\frac{\\partial}{\\partial r_{C}} \\left( (\\bar{r}_{T} - k_{GT}\\, \\bar{r}_{G}) + (k_{CS}\\, k_{SG}\\, k_{GT})\\, r_{C} \\right)\n$$\nThe terms $\\bar{r}_{T}$ and $k_{GT}\\,\\bar{r}_{G}$ are constant with respect to $r_{C}$, so their derivative is $0$. The derivative of the second term is the constant coefficient of $r_{C}$.\n$$\nG = k_{CS}\\, k_{SG}\\, k_{GT}\n$$\nThe problem also requires an explicit explanation of disinhibition. This can be illustrated by applying the chain rule for derivatives, which breaks down the total effect into the contributions of each stage in the pathway:\n$$\nG = \\frac{\\partial r_{T}}{\\partial r_{C}} = \\frac{\\partial r_{T}}{\\partial r_{G}} \\cdot \\frac{\\partial r_{G}}{\\partial r_{S}} \\cdot \\frac{\\partial r_{S}}{\\partial r_{C}}\n$$\nLet's evaluate each partial derivative separately:\n1.  $\\frac{\\partial r_{S}}{\\partial r_{C}} = \\frac{\\partial}{\\partial r_{C}}(k_{CS}\\, r_{C}) = k_{CS}$. Since $k_{CS}  0$, this represents an excitatory connection. An increase in $r_{C}$ leads to an increase in $r_{S}$.\n2.  $\\frac{\\partial r_{G}}{\\partial r_{S}} = \\frac{\\partial}{\\partial r_{S}}(\\bar{r}_{G} - k_{SG}\\, r_{S}) = -k_{SG}$. Since $k_{SG}  0$, this derivative is negative, representing an inhibitory connection. An increase in $r_{S}$ leads to a decrease in $r_{G}$.\n3.  $\\frac{\\partial r_{T}}{\\partial r_{G}} = \\frac{\\partial}{\\partial r_{G}}(\\bar{r}_{T} - k_{GT}\\, r_{G}) = -k_{GT}$. Since $k_{GT}  0$, this derivative is also negative, representing another inhibitory connection. An increase in $r_{G}$ leads to a decrease in $r_{T}$.\n\nMultiplying these individual gains gives the overall gain:\n$$\nG = (-k_{GT}) \\cdot (-k_{SG}) \\cdot (k_{CS}) = k_{CS}\\, k_{SG}\\, k_{GT}\n$$\nThe mechanism of disinhibition is revealed by the product of the signs of the serial connections. The pathway consists of an excitation followed by two successive inhibitions. An increase in cortical activity ($r_{C}$) excites the striatum ($r_{S}$). The increased striatal activity inhibits the GPi/SNr ($r_{G}$), causing its firing rate to decrease. The GPi/SNr provides tonic inhibition to the thalamus. Therefore, a decrease in the activity of the GPi/SNr results in a *reduction of inhibition* onto the thalamus. This reduction of tonic inhibition is termed **disinhibition**, and it leads to an increase in the thalamic firing rate ($r_{T}$). The net effect is that an increase in $r_{C}$ causes an increase in $r_{T}$, which is reflected by the positive sign of the overall gain $G$. The two negative signs corresponding to the two inhibitory synapses ($r_{S} \\to r_{G}$ and $r_{G} \\to r_{T}$) multiply to give a positive sign, mathematically formalizing the concept of disinhibition.",
            "answer": "$$\\boxed{k_{CS}\\, k_{SG}\\, k_{GT}}$$"
        },
        {
            "introduction": "The brain's control of movement involves a delicate balance between initiating desired actions and suppressing unwanted ones. This practice explores the temporal dynamics that underpin this balance by comparing the direct \"Go\" pathway with the hyperdirect \"Stop\" pathway. By calculating the total signal latency through each route, you will uncover the crucial speed advantage of the hyperdirect pathway, providing quantitative support for its proposed role as a fast-acting brake that can globally suppress motor output before a specific action is selected and released by the slower direct pathway .",
            "id": "4454511",
            "problem": "A cortical pyramidal neuron in the primary motor cortex initiates a spike that influences thalamic relay neurons via basal ganglia pathways. Consider two routes: the direct pathway and the hyperdirect pathway. Use the following scientifically grounded basis and parameters.\n\nBasis:\n- Conduction time along an axon is given by $t = \\frac{d}{v}$, where $d$ is the path length and $v$ is the conduction velocity.\n- Each chemical synapse imposes an additive synaptic delay $\\delta$ determined by presynaptic release, postsynaptic receptor kinetics, and transmission processes.\n\nDirect pathway segment definitions:\n- Cortex to striatum: path length $d_{\\mathrm{CS}} = 0.030~\\text{m}$, conduction velocity $v_{\\mathrm{CS}} = 7~\\text{m}\\,\\text{s}^{-1}$, synaptic delay $\\delta_{\\mathrm{CS}} = 1.0~\\text{ms}$.\n- Striatum (medium spiny neuron) to internal segment of the globus pallidus (GPi): path length $d_{\\mathrm{SG}} = 0.020~\\text{m}$, conduction velocity $v_{\\mathrm{SG}} = 1.5~\\text{m}\\,\\text{s}^{-1}$, synaptic delay $\\delta_{\\mathrm{SG}} = 1.0~\\text{ms}$.\n- GPi to thalamus: path length $d_{\\mathrm{GT}} = 0.015~\\text{m}$, conduction velocity $v_{\\mathrm{GT}} = 12~\\text{m}\\,\\text{s}^{-1}$, synaptic delay $\\delta_{\\mathrm{GT}} = 0.8~\\text{ms}$.\n\nHyperdirect pathway segment definitions:\n- Cortex to subthalamic nucleus (STN): path length $d_{\\mathrm{CT}} = 0.025~\\text{m}$, conduction velocity $v_{\\mathrm{CT}} = 18~\\text{m}\\,\\text{s}^{-1}$, synaptic delay $\\delta_{\\mathrm{CT}} = 0.9~\\text{ms}$.\n- STN to GPi: path length $d_{\\mathrm{TG}} = 0.012~\\text{m}$, conduction velocity $v_{\\mathrm{TG}} = 6~\\text{m}\\,\\text{s}^{-1}$, synaptic delay $\\delta_{\\mathrm{TG}} = 0.8~\\text{ms}$.\n- GPi to thalamus: same as above, $d_{\\mathrm{GT}} = 0.015~\\text{m}$, $v_{\\mathrm{GT}} = 12~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{GT}} = 0.8~\\text{ms}$.\n\nAssumptions:\n- Ignore recurrent loops, collateral pathways, and dendritic integration beyond the specified synaptic delays.\n- Treat synaptic delays as fixed and additive.\n\nTask:\n- Derive from first principles an expression for the total latency from cortical spike initiation to thalamic influence via each route, as the sum of segmental conduction times and synaptic delays.\n- Evaluate the total latencies numerically for the direct pathway and the hyperdirect pathway using the parameters given.\n- Express each latency in milliseconds, and round each to three significant figures.\n\nProvide your final answer as the pair of latencies for the direct pathway and the hyperdirect pathway, respectively, rounded to three significant figures and expressed in milliseconds.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extracted Givens\n- **Basis**:\n  - Conduction time: $t = \\frac{d}{v}$, where $d$ is path length and $v$ is conduction velocity.\n  - Synaptic delay: additive, denoted by $\\delta$.\n- **Direct Pathway Parameters**:\n  - Cortex to Striatum (CS): $d_{\\mathrm{CS}} = 0.030~\\text{m}$, $v_{\\mathrm{CS}} = 7~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{CS}} = 1.0~\\text{ms}$.\n  - Striatum to GPi (SG): $d_{\\mathrm{SG}} = 0.020~\\text{m}$, $v_{\\mathrm{SG}} = 1.5~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{SG}} = 1.0~\\text{ms}$.\n  - GPi to Thalamus (GT): $d_{\\mathrm{GT}} = 0.015~\\text{m}$, $v_{\\mathrm{GT}} = 12~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{GT}} = 0.8~\\text{ms}$.\n- **Hyperdirect Pathway Parameters**:\n  - Cortex to STN (CT): $d_{\\mathrm{CT}} = 0.025~\\text{m}$, $v_{\\mathrm{CT}} = 18~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{CT}} = 0.9~\\text{ms}$.\n  - STN to GPi (TG): $d_{\\mathrm{TG}} = 0.012~\\text{m}$, $v_{\\mathrm{TG}} = 6~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{TG}} = 0.8~\\text{ms}$.\n  - GPi to Thalamus (GT): $d_{\\mathrm{GT}} = 0.015~\\text{m}$, $v_{\\mathrm{GT}} = 12~\\text{m}\\,\\text{s}^{-1}$, $\\delta_{\\mathrm{GT}} = 0.8~\\text{ms}$.\n- **Assumptions**:\n  - Ignore recurrent loops, collateral pathways, and dendritic integration beyond specified synaptic delays.\n  - Synaptic delays are fixed and additive.\n- **Task**:\n  - Derive expressions for total latency for each pathway.\n  - Evaluate latencies numerically in milliseconds, rounded to three significant figures.\n  - Provide results as a pair (direct, hyperdirect).\n\n### Step 2: Validation of Extracted Givens\n1.  **Scientific Grounding**: The problem is well-grounded in fundamental principles of neurophysiology. The model of signal propagation, a summation of axonal conduction times and synaptic delays, is a standard and valid simplification. The anatomical pathways described (direct and hyperdirect) are cornerstones of basal ganglia circuit theory. The provided numerical parameters for path lengths, conduction velocities, and synaptic delays are within biophysically plausible ranges.\n2.  **Well-Posedness**: The problem is clearly defined. It provides all necessary parameters and an explicit set of instructions for deriving and calculating the required quantities. A unique solution exists.\n3.  **Objectivity**: The problem is stated using precise, objective language and quantitative data. The stated assumptions are clear and serve to define the scope of the model.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and internally consistent. I will now proceed with the formal derivation and solution.\n\nThe total latency, $T$, for a signal traversing a multi-segment neural pathway is the sum of the latencies of each individual segment. The latency for a single segment $i$ is the sum of its axonal conduction time, $t_i$, and its synaptic delay, $\\delta_i$. The conduction time is given by the foundational relation $t_i = d_i/v_i$, where $d_i$ is the path length and $v_i$ is the conduction velocity.\n\nTherefore, the expression for the total latency of a pathway composed of $N$ segments, derived from first principles, is:\n$$T = \\sum_{i=1}^{N} (t_i + \\delta_i) = \\sum_{i=1}^{N} \\left( \\frac{d_i}{v_i} + \\delta_i \\right)$$\n\nThis general expression will now be applied to the two specified pathways.\n\n**Direct Pathway Latency**\nThe direct pathway consists of three segments: Cortex-Striatum (CS), Striatum-GPi (SG), and GPi-Thalamus (GT). The total latency, $T_{\\mathrm{direct}}$, is given by the sum of the latencies of these three segments:\n$$T_{\\mathrm{direct}} = \\left( \\frac{d_{\\mathrm{CS}}}{v_{\\mathrm{CS}}} + \\delta_{\\mathrm{CS}} \\right) + \\left( \\frac{d_{\\mathrm{SG}}}{v_{\\mathrm{SG}}} + \\delta_{\\mathrm{SG}} \\right) + \\left( \\frac{d_{\\mathrm{GT}}}{v_{\\mathrm{GT}}} + \\delta_{\\mathrm{GT}} \\right)$$\n\nTo evaluate this expression numerically, we sum the conduction times and synaptic delays, ensuring consistent units. We will convert all time values to milliseconds ($ms$). Note that $1~\\text{s} = 1000~\\text{ms}$.\n\nThe total conduction time for the direct pathway is:\n$$T_{\\text{cond, direct}} = \\frac{d_{\\mathrm{CS}}}{v_{\\mathrm{CS}}} + \\frac{d_{\\mathrm{SG}}}{v_{\\mathrm{SG}}} + \\frac{d_{\\mathrm{GT}}}{v_{\\mathrm{GT}}}$$\n$$T_{\\text{cond, direct}} = \\frac{0.030~\\text{m}}{7~\\text{m}\\,\\text{s}^{-1}} + \\frac{0.020~\\text{m}}{1.5~\\text{m}\\,\\text{s}^{-1}} + \\frac{0.015~\\text{m}}{12~\\text{m}\\,\\text{s}^{-1}}$$\n$$T_{\\text{cond, direct}} \\approx 0.0042857~\\text{s} + 0.0133333~\\text{s} + 0.00125~\\text{s} = 0.018869~\\text{s}$$\nConverting to milliseconds: $T_{\\text{cond, direct}} \\approx 18.869~\\text{ms}$.\n\nThe total synaptic delay for the direct pathway is:\n$$\\Delta_{\\text{direct}} = \\delta_{\\mathrm{CS}} + \\delta_{\\mathrm{SG}} + \\delta_{\\mathrm{GT}} = 1.0~\\text{ms} + 1.0~\\text{ms} + 0.8~\\text{ms} = 2.8~\\text{ms}$$\n\nThe total latency for the direct pathway is the sum:\n$$T_{\\mathrm{direct}} = T_{\\text{cond, direct}} + \\Delta_{\\text{direct}} \\approx 18.869~\\text{ms} + 2.8~\\text{ms} = 21.669~\\text{ms}$$\nRounding to three significant figures, the latency is $21.7~\\text{ms}$.\n\n**Hyperdirect Pathway Latency**\nThe hyperdirect pathway consists of three segments: Cortex-STN (CT), STN-GPi (TG), and GPi-Thalamus (GT). The total latency, $T_{\\mathrm{hyperdirect}}$, is:\n$$T_{\\mathrm{hyperdirect}} = \\left( \\frac{d_{\\mathrm{CT}}}{v_{\\mathrm{CT}}} + \\delta_{\\mathrm{CT}} \\right) + \\left( \\frac{d_{\\mathrm{TG}}}{v_{\\mathrm{TG}}} + \\delta_{\\mathrm{TG}} \\right) + \\left( \\frac{d_{\\mathrm{GT}}}{v_{\\mathrm{GT}}} + \\delta_{\\mathrm{GT}} \\right)$$\nNote that the final segment (GT) is common to both pathways.\n\nThe total conduction time for the hyperdirect pathway is:\n$$T_{\\text{cond, hyper}} = \\frac{d_{\\mathrm{CT}}}{v_{\\mathrm{CT}}} + \\frac{d_{\\mathrm{TG}}}{v_{\\mathrm{TG}}} + \\frac{d_{\\mathrm{GT}}}{v_{\\mathrm{GT}}}$$\n$$T_{\\text{cond, hyper}} = \\frac{0.025~\\text{m}}{18~\\text{m}\\,\\text{s}^{-1}} + \\frac{0.012~\\text{m}}{6~\\text{m}\\,\\text{s}^{-1}} + \\frac{0.015~\\text{m}}{12~\\text{m}\\,\\text{s}^{-1}}$$\n$$T_{\\text{cond, hyper}} \\approx 0.0013889~\\text{s} + 0.002~\\text{s} + 0.00125~\\text{s} = 0.0046389~\\text{s}$$\nConverting to milliseconds: $T_{\\text{cond, hyper}} \\approx 4.6389~\\text{ms}$.\n\nThe total synaptic delay for the hyperdirect pathway is:\n$$\\Delta_{\\text{hyper}} = \\delta_{\\mathrm{CT}} + \\delta_{\\mathrm{TG}} + \\delta_{\\mathrm{GT}} = 0.9~\\text{ms} + 0.8~\\text{ms} + 0.8~\\text{ms} = 2.5~\\text{ms}$$\n\nThe total latency for the hyperdirect pathway is the sum:\n$$T_{\\mathrm{hyperdirect}} = T_{\\text{cond, hyper}} + \\Delta_{\\text{hyper}} \\approx 4.6389~\\text{ms} + 2.5~\\text{ms} = 7.1389~\\text{ms}$$\nRounding to three significant figures, the latency is $7.14~\\text{ms}$.\n\nThe final requested answer is the pair of latencies for the direct and hyperdirect pathways, respectively.\n- Direct pathway latency: $21.7~\\text{ms}$\n- Hyperdirect pathway latency: $7.14~\\text{ms}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n21.7  7.14\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from fundamental principles to therapeutic application, this final practice challenges you to model a next-generation clinical intervention. You will design a closed-loop Deep Brain Stimulation (DBS) system that targets pathological beta-band oscillations, a key biomarker in Parkinson's disease. This computational exercise demonstrates how a quantitative understanding of circuit dynamics can inform the design of \"smart\" therapies that adapt to the brain's real-time state, optimizing treatment efficacy while potentially reducing side effects .",
            "id": "4454563",
            "problem": "You are tasked with designing and implementing a closed-loop Deep Brain Stimulation (DBS) control law for a simplified scalar model of beta-band power in the basal ganglia–thalamocortical circuit and quantifying its effect on movement speed and accuracy. The task must be approached from first principles grounded in widely accepted neurophysiological facts: elevated beta-band power correlates with bradykinesia, and DBS reduces beta-band power when delivered. Your program must simulate the following scenario purely mathematically and output specified performance metrics for a fixed test suite.\n\nBase facts and definitions to be used:\n- Elevated beta-band power in the basal ganglia–thalamocortical loop is associated with slowed movement. Delivering DBS reduces beta-band power when stimulation is active.\n- Let the scalar envelope of beta power be denoted by $P(t)$, measured in arbitrary normalized units. Its dynamics are modeled as a first-order linear system driven by tonic and oscillatory input and damped by both intrinsic relaxation and DBS-induced suppression.\n- The closed-loop controller is a threshold policy that activates DBS only when the instantaneous beta power exceeds a threshold.\n\nModel specification:\n- State dynamics (continuous time):\n$$\n\\frac{dP}{dt} = -\\frac{P(t)-P_0}{\\tau} + I_0 + I_1 \\sin\\!\\big(2\\pi f t\\big) - \\eta\\,u(t)\\,P(t),\n$$\nwhere $P_0$ is the baseline beta power, $\\tau$ is the relaxation time constant, $I_0$ is a constant excitatory drive, $I_1$ is the amplitude of a low-frequency modulation with frequency $f$, $\\eta$ is the DBS suppression gain, and $u(t)\\in\\{0,1\\}$ is the control input.\n- Control law (threshold policy):\n$$\nu(t) = \\begin{cases}\n1,  \\text{if } P(t) \\ge P^\\*,\\\\\n0,  \\text{if } P(t)  P^\\*,\n\\end{cases}\n$$\nwhere $P^\\*$ is the beta power threshold.\n- Discretization requirement: simulate with forward Euler integration using time step $\\Delta t$ over a duration $T$:\n$$\nP_{k+1} = \\max\\Big\\{0,\\; P_k + \\Delta t \\Big( -\\frac{P_k-P_0}{\\tau} + I_0 + I_1 \\sin(2\\pi f k \\Delta t) - \\eta\\,u_k\\,P_k \\Big) \\Big\\},\n$$\nwith $u_k = 1$ if $P_k \\ge P^\\*$ and $u_k=0$ otherwise. Enforce nonnegativity of $P_k$ via the $\\max$ operator.\n\nPerformance mapping:\n- Define the time-averaged beta power over the full simulation as\n$$\n\\bar{P} = \\frac{1}{N}\\sum_{k=1}^{N} P_k,\n$$\nwith $N = T/\\Delta t$.\n- Define the stimulation duty fraction as\n$$\nR = \\frac{1}{N}\\sum_{k=1}^{N} u_k.\n$$\n- Movement speed $V$ (dimensionless, normalized to a notional upper bound) is modeled as a monotone decreasing function of $\\bar{P}$:\n$$\nV = \\frac{V_{\\max}}{1 + \\alpha \\bar{P}}.\n$$\n- Movement accuracy $A$ (dimensionless fraction in $[0,1]$) is modeled as a penalty from both elevated beta and stimulation-induced disruption:\n$$\nA = \\mathrm{clip}\\Big(1 - \\beta_1 \\bar{P} - \\beta_2 R,\\; 0,\\; 1\\Big).\n$$\n- All constants must be set to the following values:\n  - $P_0 = 1.0$,\n  - $\\tau = 0.3\\ \\text{s}$,\n  - $I_0 = 1.0$,\n  - $I_1 = 0.6$,\n  - $f = 0.5\\ \\text{Hz}$,\n  - $\\Delta t = 0.001\\ \\text{s}$,\n  - $T = 20.0\\ \\text{s}$,\n  - $V_{\\max} = 1.5$,\n  - $\\alpha = 0.5$,\n  - $\\beta_1 = 0.15$,\n  - $\\beta_2 = 0.25$.\n\nTest suite:\n- Evaluate the model for the following four parameter pairs $(P^\\*, \\eta)$:\n  - Case $1$: $(P^\\*=\\;10.0,\\ \\eta=\\;0.0)$,\n  - Case $2$: $(P^\\*=\\;1.1,\\ \\eta=\\;2.0)$,\n  - Case $3$: $(P^\\*=\\;0.5,\\ \\eta=\\;5.0)$,\n  - Case $4$: $(P^\\*=\\;1.5,\\ \\eta=\\;1.0)$.\n\nComputational and output requirements:\n- Initialize $P_0$ for the simulation as $P(0)=P_0$.\n- Use the full time horizon $[0,T]$ for all averages (no transient discard).\n- Report for each case the pair $[V, A]$ as floats rounded to six decimal places.\n- Units: time in seconds, frequency in Hertz, all other quantities dimensionless.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case represented as a two-element list in order of the cases above. For example, the output format must be:\n\"[[v1,a1],[v2,a2],[v3,a3],[v4,a4]]\"\nwith no spaces anywhere in the line.",
            "solution": "The problem statement has been rigorously validated and found to be valid. It is scientifically grounded in established neurophysiological principles concerning basal ganglia oscillations and Deep Brain Stimulation (DBS), well-posed with a complete set of equations and parameters, and objective in its formulation. The task is a straightforward computational problem requiring the simulation of a dynamical system and the calculation of performance metrics. We proceed with a direct implementation of the specified model.\n\nThe solution involves numerically simulating a discrete-time dynamical system that models the envelope of beta-band power, $P(t)$, under a closed-loop DBS control strategy. The model's parameters and equations are all explicitly provided.\n\nThe simulation uses the forward Euler method to integrate the state equation over a time horizon $T = 20.0\\,\\mathrm{s}$ with a time step $\\Delta t = 0.001\\,\\mathrm{s}$. This corresponds to a total of $N = T/\\Delta t = 20000$ steps. The simulation generates a sequence of beta power values $\\{P_k\\}_{k=0}^{N}$, starting from the initial condition $P(0) = P_0 = 1.0$.\n\nThe discrete-time update rule for the beta power at step $k$, generating the value for step $k+1$, is given by:\n$$\nP_{k+1} = \\max\\Big\\{0,\\; P_k + \\Delta t \\Big( -\\frac{P_k-P_0}{\\tau} + I_0 + I_1 \\sin(2\\pi f k \\Delta t) - \\eta\\,u_k\\,P_k \\Big) \\Big\\}\n$$\nwhere all parameters ($P_0=1.0$, $\\tau=0.3$, $I_0=1.0$, $I_1=0.6$, $f=0.5$) are fixed constants. The control input $u_k$ is determined at each step $k$ by a threshold-based control law that depends on the current state $P_k$ and a control parameter $P^\\*$:\n$$\nu_k = \\begin{cases}\n1,  \\text{if } P_k \\ge P^\\*,\\\\\n0,  \\text{if } P_k  P^\\*,\n\\end{cases}\n$$\nThe parameters for the control law, the threshold $P^\\*$ and the DBS gain $\\eta$, vary for each of the four test cases provided.\n\nAfter simulating the trajectory of $P_k$ for $k=0, \\dots, N$, we compute the specified performance metrics.\n\nFirst, the time-averaged beta power, $\\bar{P}$, is calculated by averaging the simulated power values from $k=1$ to $k=N$, as per the problem's definition:\n$$\n\\bar{P} = \\frac{1}{N}\\sum_{k=1}^{N} P_k\n$$\nNote that the initial state $P_0$ is excluded from this average.\n\nSecond, the stimulation duty fraction, $R$, is calculated. This requires determining the control action $u_k$ for each time step $k=1, \\dots, N$ based on the simulated values $P_k$, and then averaging these control actions:\n$$\nR = \\frac{1}{N}\\sum_{k=1}^{N} u_k\n$$\nFinally, the two primary performance metrics, movement speed $V$ and accuracy $A$, are calculated based on $\\bar{P}$ and $R$. The speed $V$ is a decreasing function of the average beta power:\n$$\nV = \\frac{V_{\\max}}{1 + \\alpha \\bar{P}}\n$$\nThe accuracy $A$ is penalized by both elevated beta power and the amount of stimulation delivered:\n$$\nA = \\mathrm{clip}\\Big(1 - \\beta_1 \\bar{P} - \\beta_2 R,\\; 0,\\; 1\\Big)\n$$\nThe parameters for these mappings are given as $V_{\\max}=1.5$, $\\alpha=0.5$, $\\beta_1=0.15$, and $\\beta_2=0.25$.\n\nThis entire procedure—simulation, calculation of $\\bar{P}$ and $R$, and final computation of $V$ and $A$—is executed for each of the four $(P^\\*, \\eta)$ parameter pairs in the test suite. The resulting $[V, A]$ pairs are then formatted to six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a closed-loop DBS control law for a model of beta-band power\n    and calculates movement speed and accuracy metrics.\n    \"\"\"\n    # Define fixed model and simulation parameters\n    P0_param = 1.0  # Baseline beta power (unitless)\n    tau = 0.3      # Relaxation time constant (s)\n    I0 = 1.0       # Constant excitatory drive (unitless/s)\n    I1 = 0.6       # Amplitude of oscillatory drive (unitless/s)\n    f_freq = 0.5   # Frequency of modulation (Hz)\n    dt = 0.001     # Time step (s)\n    T_sim = 20.0   # Total simulation duration (s)\n    P_initial = 1.0  # Initial condition P(0)\n\n    # Performance mapping parameters\n    V_max = 1.5\n    alpha = 0.5\n    beta1 = 0.15\n    beta2 = 0.25\n\n    # Test suite of parameter pairs (P_star, eta)\n    test_cases = [\n        (10.0, 0.0),  # Case 1: Open-loop (no effective stimulation)\n        (1.1, 2.0),   # Case 2: Tight control near baseline\n        (0.5, 5.0),   # Case 3: Aggressive control below baseline\n        (1.5, 1.0),   # Case 4: Lenient control\n    ]\n\n    # Calculate simulation step count\n    N = int(T_sim / dt)\n    pi = np.pi\n\n    all_results = []\n\n    for P_star, eta in test_cases:\n        # --- Simulation Phase ---\n        # Initialize array to store the history of beta power P\n        P_hist = np.zeros(N + 1)\n        P_hist[0] = P_initial\n\n        # Perform forward Euler integration for N steps\n        for k in range(N):\n            Pk = P_hist[k]\n            tk = k * dt\n\n            # Apply the threshold control law\n            uk = 1.0 if Pk >= P_star else 0.0\n\n            # Calculate the derivative dP/dt according to the model\n            dPdt = -(Pk - P0_param) / tau + I0 + I1 * np.sin(2 * pi * f_freq * tk) - eta * uk * Pk\n\n            # Update state using forward Euler, with non-negativity constraint\n            P_kp1 = Pk + dt * dPdt\n            P_hist[k+1] = max(0.0, P_kp1)\n\n        # --- Performance Metrics Calculation Phase ---\n        # Get the simulated states from k=1 to k=N for averaging\n        P_avg_series = P_hist[1:]\n\n        # Calculate time-averaged beta power (P_bar)\n        P_bar = np.mean(P_avg_series)\n\n        # Calculate stimulation duty fraction (R)\n        # u_k is derived from P_k, so we need P_1 to P_N\n        u_vals_for_R = (P_avg_series >= P_star).astype(float)\n        R = np.mean(u_vals_for_R)\n\n        # Calculate movement speed (V)\n        V = V_max / (1 + alpha * P_bar)\n\n        # Calculate movement accuracy (A) with clipping\n        A = np.clip(1 - beta1 * P_bar - beta2 * R, 0.0, 1.0)\n        \n        all_results.append([V, A])\n\n    # Format the final output string as specified\n    case_strings = [f\"[{v:.6f},{a:.6f}]\" for v, a in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # The final print statement must produce only the specified output format\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}