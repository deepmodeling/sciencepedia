{
    "hands_on_practices": [
        {
            "introduction": "Understanding the distinction between Duchenne and Becker muscular dystrophies often begins with the \"reading-frame rule,\" which correlates the genetic mutation to the clinical phenotype. This exercise provides a hands-on method to predict disease severity by calculating the impact of a specific exon deletion on the mRNA reading frame using exon phase data, a fundamental skill in molecular diagnostics .",
            "id": "4499889",
            "problem": "A patient presents with a confirmed multi-exon deletion in the dystrophin gene: a contiguous deletion of exons $45$ through $47$ on the protein-coding transcript of the dystrophin gene. You are asked to determine whether the resulting messenger ribonucleic acid (mRNA) maintains the original reading frame across the novel exon junction created by splicing exon $44$ directly to exon $48$, and from this infer the likely phenotype according to the reading-frame rule (in-frame tends to yield Becker muscular dystrophy (BMD); out-of-frame tends to yield Duchenne muscular dystrophy (DMD)).\n\nUse the following foundational definitions rooted in the Central Dogma of molecular biology and the convention of intron phase in eukaryotic splicing:\n- Protein translation reads codons in sets of $3$ nucleotides; a frameshift changes the grouping and thus the encoded amino acid sequence downstream.\n- For any exon $i$, define the left splice phase $p_{L}(i) \\in \\{0,1,2\\}$ as the number of nucleotides of a codon present at the exon’s $5^{\\prime}$ end before the splice acceptor site, and the right splice phase $p_{R}(i) \\in \\{0,1,2\\}$ as the number of nucleotides of a codon present at the exon’s $3^{\\prime}$ end before the splice donor site. By convention, $p=0$ indicates that the splice occurs between codons.\n\nAssume the curated exon-phase annotation for the human dystrophin transcript is as follows in the relevant interval:\n- Exon $44$: $p_{L}(44)=0$, $p_{R}(44)=0$.\n- Exon $45$: $p_{L}(45)=0$, $p_{R}(45)=0$.\n- Exon $46$: $p_{L}(46)=0$, $p_{R}(46)=0$.\n- Exon $47$: $p_{L}(47)=0$, $p_{R}(47)=0$.\n- Exon $48$: $p_{L}(48)=0$, $p_{R}(48)=0$.\n\nStarting from these definitions, compute the net reading-frame offset modulo $3$ induced at the novel junction created by directly splicing exon $44$ to exon $48$ after deletion of exons $45$–$47$. Denote this offset by $k \\in \\{0,1,2\\}$, where $k=0$ indicates that the reading frame is preserved at the junction, and $k \\in \\{1,2\\}$ indicates a frameshift at the junction. Based on the result, the phenotype prediction follows the reading-frame rule: $k=0$ is consistent with a Becker muscular dystrophy (BMD)-like phenotype, and $k \\in \\{1,2\\}$ is consistent with a Duchenne muscular dystrophy (DMD)-like phenotype.\n\nReport the single integer $k$ as your final answer. No units are required. Do not provide any text in your final answer.",
            "solution": "To determine the reading-frame offset, we must analyze the effect of splicing exon $44$ directly to exon $48$. A reading frame is preserved across a novel splice junction if the exit phase of the upstream exon matches the entry phase of the downstream exon. The frame offset, $k$, can be calculated as the difference between these phases, modulo $3$.\n\nThe rule is:\n$$k = (p_R(\\text{upstream exon}) - p_L(\\text{downstream exon})) \\pmod 3$$\n\nIn this case, the upstream exon is exon $44$, and the downstream exon is exon $48$. From the provided data:\n- Right (exit) phase of exon $44$: $p_R(44) = 0$.\n- Left (entry) phase of exon $48$: $p_L(48) = 0$.\n\nSubstituting these values into the formula:\n$$k = (p_R(44) - p_L(48)) \\pmod 3 = (0 - 0) \\pmod 3 = 0$$\n\nAn alternative method involves calculating the total number of nucleotides in the deleted exons (exons $45$, $46$, and $47$) modulo $3$. The length of any exon $i$, $L(i)$, is related to its entry and exit phases by the equation $(L(i) + p_L(i) - p_R(i)) \\pmod 3 = 0$. This implies $L(i) \\pmod 3 = (p_R(i) - p_L(i)) \\pmod 3$.\n\nFor the deleted exons:\n- $L(45) \\pmod 3 = (p_R(45) - p_L(45)) \\pmod 3 = (0 - 0) \\pmod 3 = 0$.\n- $L(46) \\pmod 3 = (p_R(46) - p_L(46)) \\pmod 3 = (0 - 0) \\pmod 3 = 0$.\n- $L(47) \\pmod 3 = (p_R(47) - p_L(47)) \\pmod 3 = (0 - 0) \\pmod 3 = 0$.\n\nThe total length of the deleted segment modulo $3$ is $(0 + 0 + 0) \\pmod 3 = 0$. Since a multiple of $3$ nucleotides has been removed, the reading frame is preserved. The offset $k$ is $0$.\n\nBoth methods confirm that the reading frame is maintained ($k=0$). Based on the reading-frame rule, this would predict a milder Becker muscular dystrophy (BMD) phenotype.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Moving from diagnosis to therapy, the same principles that predict a frameshift can be used to design ways to correct it. This computational challenge asks you to develop an algorithm that identifies which exon or exons could be \"skipped\" using targeted therapies to restore the reading frame, a direct application of bioinformatics in personalized medicine .",
            "id": "4499934",
            "problem": "Design a program that, given patient-specific coding exon coordinates for the dystrophin gene and a contiguous exon deletion, determines which exon-skipping targets from a provided candidate set would restore the open reading frame. Use the following fundamental base: the Central Dogma of molecular biology and the genetic code, where messenger Ribonucleic Acid (mRNA) is translated in codons of length $3$ nucleotides, and the open reading frame is preserved if and only if the net count of coding nucleotides removed is a multiple of $3$. Formulate the restoration criterion purely in arithmetic terms: for a deletion of exons $i$ through $j$ with coding lengths $\\{L_k\\}$ in nucleotides, let $r = \\left(\\sum_{k=i}^{j} L_k\\right) \\bmod 3$. For any additional exon-skipping set $S$ from the candidate pool, frame restoration requires $\\left(r + \\sum_{e \\in S} L_e\\right) \\bmod 3 = 0$. Your task is to compute, for each test case, the list of all minimal-cardinality skipping sets $S$ that satisfy the restoration criterion. If the deletion is already in frame (i.e., $r = 0$), the empty set is the unique minimal solution and must be returned as $[\\,]$ inside the outer result. If no subset of the candidate pool restores the frame, return an empty outer list to denote that no solution exists. All exon coordinates are provided as start and end positions in nucleotides on the coding sequence, and lengths are computed as $L_e = \\text{end} - \\text{start} + 1$ in nucleotides; use the unit \"nucleotides (nt)\" for all lengths. Your program must not rely on any biological shortcuts beyond these principles.\n\nFor reproducibility and testability, apply your algorithm to the following test suite. For each test case, the input is given by: a dictionary of exon coordinates mapping exon labels (integers) to pairs $(\\text{start}, \\text{end})$ in nucleotides, a deletion interval $(i, j)$ inclusive, and a list of candidate exons to consider for skipping. The required output for each test case is a list of lists of exon labels, representing all minimal-cardinality skipping sets that restore the frame, sorted in lexicographic order. The unit of exon lengths is nucleotides (nt). The angle unit is not applicable. Percentages are not applicable.\n\nTest suite:\n- Case $1$ (happy path, therapeutic design applicability): Patient-specific coordinates for exons $49$–$53$ are given in nucleotides as follows: $49: (7000, 7149)$, $50: (7150, 7307)$, $51: (7308, 7458)$, $52: (7459, 7638)$, $53: (7639, 7838)$. The deletion is $(49, 50)$, and the candidate pool is $[51, 52, 53]$. The task is to determine whether skipping exon $51$ alone can restore the reading frame for the deletion of exons $49$–$50$, consistent with known therapeutic strategies.\n- Case $2$ (boundary condition, already in frame): Exons $10$–$14$ coordinates are $10: (1000, 1119)$, $11: (1120, 1266)$, $12: (1267, 1422)$, $13: (1423, 1550)$, $14: (1551, 1680)$. The deletion is $(10, 12)$, and the candidate pool is $[13, 14]$. Since the deletion is already in frame, the minimal solution must be the empty set.\n- Case $3$ (edge case, no solution in candidate pool): Exons $20$–$22$ coordinates are $20: (2000, 2100)$, $21: (2101, 2201)$, $22: (2202, 2324)$. The deletion is $(20, 21)$, and the candidate pool is $[22]$. Show that no skipping set from the candidate pool can restore the frame.\n- Case $4$ (coverage for multiple minimal solutions): Exons $30$–$32$ coordinates are $30: (3000, 3148)$, $31: (3149, 3308)$, $32: (3309, 3483)$. The deletion is $(30, 30)$, and the candidate pool is $[31, 32]$. Determine all minimal single-exon skipping solutions.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces, where each element corresponds to a test case and is itself a list of lists (possibly empty). For example, the output format is $[result\\_1,result\\_2,result\\_3,result\\_4]$ with no spaces, such as $[[[51]],[[]],[],[[31],[32]]]$ for four test cases. All computations must be based on the modulo arithmetic defined above, with lengths in nucleotides (nt). Angles are not used, and percentages must not be used.",
            "solution": "The problem requires implementing an algorithm to find minimal exon-skipping solutions that restore the reading frame after a deletion. The core principle is that the total number of nucleotides removed (from the initial deletion plus the therapeutic skip) must be a multiple of $3$.\n\nThe algorithm proceeds as follows for each test case:\n1.  **Calculate Exon Lengths**: For each exon in the provided coordinates, calculate its length in nucleotides (nt) using the formula $L_e = \\text{end} - \\text{start} + 1$.\n2.  **Analyze Deletion**: Sum the lengths of the deleted exons to find the total deleted length, $L_{del}$. Calculate the frame-disrupting remainder, $r = L_{del} \\pmod 3$.\n3.  **Handle In-Frame Case**: If $r = 0$, the deletion is already in-frame. The minimal solution is the empty set, and no skipping is needed. The result is `[[]]`.\n4.  **Determine Target Remainder**: If $r \\neq 0$, a therapeutic skip is needed. The sum of the lengths of the skipped exons, $L_S$, must have a remainder modulo $3$ that compensates for $r$. This target remainder is $r_{target} = (3 - r) \\pmod 3$.\n5.  **Search for Minimal Solutions**:\n    - Iterate through possible solution sizes, starting with a cardinality of $c=1$.\n    - For each cardinality $c$, generate all combinations of $c$ exons from the candidate pool.\n    - For each combination, calculate the sum of exon lengths and check if its remainder modulo $3$ equals $r_{target}$.\n    - If solutions are found for cardinality $c$, these are the minimal solutions. Collect all such combinations, sort them lexicographically, and stop the search.\n    - If the search completes without finding any solutions, none exist in the given pool. The result is `[]`.\n\n**Applying the algorithm to the test suite:**\n\n-   **Case 1**: Deletion of exons $49, 50$. $L_{del} = L_{49} + L_{50} = 150 + 158 = 308$ nt. $r = 308 \\pmod 3 = 2$. The target remainder $r_{target}$ is $1$. From the candidate pool, only exon $51$ ($L_{51}=151$ nt, $151 \\pmod 3 = 1$) provides the required remainder as a single-exon skip. **Result: `[[51]]`**.\n-   **Case 2**: Deletion of exons $10, 11, 12$. $L_{del} = L_{10} + L_{11} + L_{12} = 120 + 147 + 156 = 423$ nt. $r = 423 \\pmod 3 = 0$. The deletion is already in-frame. **Result: `[[]]`**.\n-   **Case 3**: Deletion of exons $20, 21$. $L_{del} = L_{20} + L_{21} = 101 + 101 = 202$ nt. $r = 202 \\pmod 3 = 1$. The target remainder $r_{target}$ is $2$. The only candidate exon, $22$ ($L_{22}=123$ nt), has a length remainder of $0$. No combination from the pool can produce a remainder of $2$. **Result: `[]`**.\n-   **Case 4**: Deletion of exon $30$. $L_{del} = L_{30} = 149$ nt. $r = 149 \\pmod 3 = 2$. The target remainder $r_{target}$ is $1$. In the candidate pool, both exon $31$ ($L_{31}=160$ nt, $160 \\pmod 3 = 1$) and exon $32$ ($L_{32}=175$ nt, $175 \\pmod 3 = 1$) satisfy the condition as single-exon skips. These are the minimal solutions. **Result: `[[31], [32]]`**.\n\nThe provided Python code in the answer block correctly implements this logic to produce the final concatenated output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and generate the final output.\n    \"\"\"\n    test_cases = [\n        {\n            \"coords\": {49: (7000, 7149), 50: (7150, 7307), 51: (7308, 7458), 52: (7459, 7638), 53: (7639, 7838)},\n            \"deletion\": (49, 50),\n            \"candidates\": [51, 52, 53]\n        },\n        {\n            \"coords\": {10: (1000, 1119), 11: (1120, 1266), 12: (1267, 1422), 13: (1423, 1550), 14: (1551, 1680)},\n            \"deletion\": (10, 12),\n            \"candidates\": [13, 14]\n        },\n        {\n            \"coords\": {20: (2000, 2100), 21: (2101, 2201), 22: (2202, 2324)},\n            \"deletion\": (20, 21),\n            \"candidates\": [22]\n        },\n        {\n            \"coords\": {30: (3000, 3148), 31: (3149, 3308), 32: (3309, 3483)},\n            \"deletion\": (30, 30),\n            \"candidates\": [31, 32]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case['coords'], case['deletion'], case['candidates'])\n        results.append(result)\n\n    # Format the final output string according to the problem specification.\n    # It requires a compact representation with no spaces.\n    str_results = []\n    for r in results:\n        str_results.append(str( r ).replace(' ', ''))\n    \n    print(f\"[{','.join(str_results)}]\")\n\ndef process_case(coords, deletion, candidates):\n    \"\"\"\n    Solves a single case for finding minimal-cardinality exon skipping sets.\n\n    Args:\n        coords (dict): A dictionary mapping exon labels to (start, end) coordinates.\n        deletion (tuple): A tuple (i, j) for the inclusive range of deleted exons.\n        candidates (list): A list of exon labels in the candidate pool for skipping.\n\n    Returns:\n        list: A list of lists of exon labels, representing all minimal-cardinality\n              skipping sets that restore the reading frame. Sorted lexicographically.\n              Returns [[]] for in-frame deletions and [] for no solution.\n    \"\"\"\n    # Step 1: Calculate lengths of all relevant exons in nucleotides.\n    lengths = {exon: end - start + 1 for exon, (start, end) in coords.items()}\n\n    # Step 2: Calculate the total length of the primary deletion and its remainder modulo 3.\n    del_start, del_end = deletion\n    deleted_len_sum = 0\n    for exon_num in range(del_start, del_end + 1):\n        deleted_len_sum += lengths[exon_num]\n    \n    r = deleted_len_sum % 3\n\n    # Step 3: Handle the in-frame case.\n    if r == 0:\n        return [[]]\n\n    # Step 4: Determine the target remainder for the therapeutic skip.\n    r_target = (3 - r) % 3\n\n    # Step 5: Search for minimal-cardinality solutions.\n    # Sort candidates to ensure itertools.combinations produces lexicographically ordered tuples.\n    candidates.sort()\n\n    for c in range(1, len(candidates) + 1):\n        minimal_solutions = []\n        for combo in itertools.combinations(candidates, c):\n            skip_len_sum = sum(lengths[e] for e in combo)\n            if skip_len_sum % 3 == r_target:\n                minimal_solutions.append(list(combo))\n        \n        # If solutions are found for cardinality c, this is the minimal cardinality.\n        # Return them and terminate the search for this case.\n        if minimal_solutions:\n            # The solutions are already lexicographically sorted because candidates were sorted\n            # and itertools.combinations preserves that order.\n            return minimal_solutions\n\n    # If the loop completes, no solution was found in the candidate pool.\n    return []\n\n# Execute the solver.\nsolve()\n```"
        },
        {
            "introduction": "Beyond the molecular level, understanding the inheritance pattern of X-linked disorders like DMD and BMD is critical for genetic counseling and family planning. This practice applies Bayes' theorem to a common clinical scenario: calculating the revised probability of a woman being a carrier after having an affected child, illustrating how new evidence quantitatively refines genetic risk assessment .",
            "id": "4499959",
            "problem": "A clinician is evaluating a proband with Duchenne muscular dystrophy (DMD) or Becker muscular dystrophy (BMD), both X-linked recessive dystrophinopathies with transmission through the X chromosome. Assume the following:\n\n- In males, the disease exhibits penetrance $p$ (for DMD or BMD, take $p$ close to $1$, but do not substitute a numerical value).\n- A woman from an outbred population presents with a negative family history for dystrophinopathies prior to childbearing. Let $r$ denote her pretest (prior) probability of being a heterozygous carrier of a pathogenic dystrophin variant, conditional only on the negative family history and population background risk.\n- Let $m$ denote the probability that a male child born to a non-carrier mother is affected due to a de novo pathogenic mutation in the dystrophin gene (conditional on male sex), per male birth.\n- The observed data consist of a single ($1$) affected son with a definitive diagnosis of a dystrophinopathy.\n\nUsing only the fundamental definition of Bayes’ theorem and the Mendelian transmission rules for an X-linked recessive condition, derive the posterior probability that the woman is a carrier after observing the affected son. Express your final answer as a single closed-form analytic expression in terms of $r$, $p$, and $m$ only. Do not plug in numerical values. The final expression must be simplified and contain no units.",
            "solution": "We will use Bayes' theorem to calculate the posterior probability that the woman is a carrier, given that she has an affected son.\n\nLet the following events be defined:\n-   $C$: The woman is a heterozygous carrier.\n-   $\\neg C$: The woman is not a carrier.\n-   $A$: The woman has one affected son.\n\nWe want to find the posterior probability $P(C \\mid A)$. Bayes' theorem states:\n$$P(C \\mid A) = \\frac{P(A \\mid C) P(C)}{P(A)}$$\nThe total probability of the observation, $P(A)$, can be expanded using the law of total probability:\n$$P(A) = P(A \\mid C) P(C) + P(A \\mid \\neg C) P(\\neg C)$$\nThis gives the full form of Bayes' theorem for this problem:\n$$P(C \\mid A) = \\frac{P(A \\mid C) P(C)}{P(A \\mid C) P(C) + P(A \\mid \\neg C) P(\\neg C)}$$\n\nNext, we define each term based on the problem statement:\n1.  **Prior Probabilities**: The woman's prior probability of being a carrier is given as $r$.\n    -   $P(C) = r$\n    -   $P(\\neg C) = 1 - r$\n\n2.  **Likelihoods**: These are the probabilities of having an affected son under each hypothesis.\n    -   $P(A \\mid C)$: If the mother is a carrier of an X-linked recessive trait, there is a $\\frac{1}{2}$ chance she passes the pathogenic variant to a son. With disease penetrance $p$, the probability of the son being affected is:\n        $$P(A \\mid C) = \\frac{1}{2} \\times p = \\frac{p}{2}$$\n    -   $P(A \\mid \\neg C)$: If the mother is not a carrier, the son can only be affected by a *de novo* mutation. The probability for this is given as $m$.\n        $$P(A \\mid \\neg C) = m$$\n\nFinally, we substitute these terms back into the Bayesian formula:\n$$P(C \\mid A) = \\frac{\\left(\\frac{p}{2}\\right) r}{\\left(\\frac{p}{2}\\right) r + m(1 - r)}$$\nTo simplify the expression, we multiply the numerator and denominator by $2$:\n$$P(C \\mid A) = \\frac{pr}{pr + 2m(1 - r)}$$\nThis is the simplified, closed-form expression for the posterior probability.",
            "answer": "$$\n\\boxed{\\frac{p r}{p r + 2m(1 - r)}}\n$$"
        }
    ]
}