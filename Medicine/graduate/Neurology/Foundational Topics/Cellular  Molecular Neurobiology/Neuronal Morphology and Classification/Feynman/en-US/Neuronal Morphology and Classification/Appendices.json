{
    "hands_on_practices": [
        {
            "introduction": "The intricate branching patterns of dendrites are not random; they are finely tuned to optimize the flow of electrical information. This first exercise provides a foundational understanding of this principle by guiding you through the derivation of Rall's 3/2 power rule from the first principles of passive cable theory. By working through this problem, you will see how the physical requirement of impedance matching at a bifurcation point—which minimizes signal reflection—translates directly into a simple, elegant geometric constraint on the diameters of parent and daughter branches .",
            "id": "4508610",
            "problem": "In a passive dendritic tree modeled by cable theory with spatially homogeneous specific membrane resistivity $R_{m}$ and intracellular (axial) resistivity $R_{i}$, morphometric constraints at a bifurcation can be derived from the requirement that the branch point is impedance matched so that no reflections occur and electrotonic length is preserved across the junction. Starting from fundamental cable definitions for axial resistance per unit length and membrane resistance per unit length, derive the diameter relationship that enforces impedance matching at a dendritic bifurcation between a parent branch of diameter $d_{0}$ and two daughter branches of diameters $d_{1}$ and $d_{2}$, under the assumption that each branch can be treated locally as semi-infinite around the junction and membrane properties are uniform.\n\nYou are given a specific bifurcation measured in a cortical pyramidal neuron apical dendrite with parent diameter $d_{0} = 3.0\\,\\mu\\text{m}$ and daughter diameters $d_{1} = 2.5\\,\\mu\\text{m}$ and $d_{2} = 1.2\\,\\mu\\text{m}$. Using your derived relationship, compute the absolute fractional deviation from the exact impedance-matching condition, defined as\n$$\\varepsilon \\equiv \\frac{\\left|\\,f(d_{1},d_{2}) - f(d_{0})\\,\\right|}{f(d_{0})},$$\nwhere $f(\\cdot)$ is the diameter-dependent quantity implied by the impedance-matching condition you derived. Report $\\varepsilon$ as a decimal fraction (for example, report $0.05$ for a five percent deviation). Round your answer to four significant figures. Do not include any units or a percent sign in your final reported value.",
            "solution": "The problem requires the derivation of a diameter relationship for impedance matching at a dendritic bifurcation and the calculation of a fractional deviation for a specific case.\n\n### Part 1: Derivation of the Diameter Relationship\n\nThe problem is framed within the context of passive cable theory applied to a dendritic tree. We are given that the specific membrane resistivity, $R_m$ (units of $\\Omega \\cdot \\text{m}^2$), and the specific intracellular (axial) resistivity, $R_i$ (units of $\\Omega \\cdot \\text{m}$), are spatially homogeneous.\n\nFirst, we must define the relevant electrical properties for a cylindrical dendrite of diameter $d$.\nThe axial resistance per unit length, $r_a$, is the intracellular resistivity $R_i$ divided by the cross-sectional area $A = \\pi (d/2)^2$.\n$$r_a = \\frac{R_i}{A} = \\frac{R_i}{\\pi (d/2)^2} = \\frac{4 R_i}{\\pi d^2}$$\nThe membrane resistance for a unit length of the cylinder, $r_m$, is the specific membrane resistivity $R_m$ divided by the circumference of the cylinder, which is $\\pi d$.\n$$r_m = \\frac{R_m}{\\pi d}$$\nThe problem states that each branch at the bifurcation can be treated locally as a semi-infinite cable. For a semi-infinite passive cable, the DC or steady-state input resistance, $R_{in}$, is given by the characteristic resistance of the cable:\n$$R_{in} = \\sqrt{r_a r_m}$$\nSubstituting the expressions for $r_a$ and $r_m$ in terms of the diameter $d$:\n$$R_{in}(d) = \\sqrt{\\left(\\frac{4 R_i}{\\pi d^2}\\right) \\left(\\frac{R_m}{\\pi d}\\right)} = \\sqrt{\\frac{4 R_i R_m}{\\pi^2 d^3}} = \\frac{2}{\\pi} \\sqrt{\\frac{R_i R_m}{d^3}}$$\nThe condition for impedance matching at the bifurcation point is that there are no reflections. This is achieved when the input conductance of the parent branch is equal to the sum of the input conductances of the daughter branches. The input conductance, $G_{in}$, is the reciprocal of the input resistance, $G_{in} = 1/R_{in}$.\n$$G_{in}(d) = \\frac{1}{R_{in}(d)} = \\frac{\\pi}{2} \\sqrt{\\frac{d^3}{R_i R_m}}$$\nLet the parent branch have diameter $d_0$ and the two daughter branches have diameters $d_1$ and $d_2$. The impedance matching condition is:\n$$G_{in}(d_0) = G_{in}(d_1) + G_{in}(d_2)$$\nSubstituting the expression for $G_{in}(d)$:\n$$\\frac{\\pi}{2} \\sqrt{\\frac{d_0^3}{R_i R_m}} = \\frac{\\pi}{2} \\sqrt{\\frac{d_1^3}{R_i R_m}} + \\frac{\\pi}{2} \\sqrt{\\frac{d_2^3}{R_i R_m}}$$\nSince the problem states that membrane and intracellular properties ($R_m$ and $R_i$) are uniform across the tree, the constant term $\\frac{\\pi}{2\\sqrt{R_i R_m}}$ is common to all terms and can be cancelled. This yields the desired diameter relationship:\n$$\\sqrt{d_0^3} = \\sqrt{d_1^3} + \\sqrt{d_2^3}$$\nThis is commonly known as Rall's $3/2$ power rule, which can also be written as:\n$$d_0^{3/2} = d_1^{3/2} + d_2^{3/2}$$\n\n### Part 2: Calculation of the Fractional Deviation\n\nThe problem defines the absolute fractional deviation from the exact impedance-matching condition as:\n$$\\varepsilon \\equiv \\frac{\\left|\\,f(d_{1},d_{2}) - f(d_{0})\\,\\right|}{f(d_{0})}$$\nFrom our derivation, the diameter-dependent quantity $f(\\cdot)$ that determines the conductance is $d^{3/2}$. Therefore, $f(d_0) = d_0^{3/2}$ and the combined contribution from the daughters is $f(d_1, d_2) = d_1^{3/2} + d_2^{3/2}$. The formula for $\\varepsilon$ becomes:\n$$\\varepsilon = \\frac{\\left| (d_1^{3/2} + d_2^{3/2}) - d_0^{3/2} \\right|}{d_0^{3/2}} = \\left| \\frac{d_1^{3/2} + d_2^{3/2}}{d_0^{3/2}} - 1 \\right|$$\nWe are given the following diameters for a specific bifurcation:\n$d_0 = 3.0\\,\\mu\\text{m}$\n$d_1 = 2.5\\,\\mu\\text{m}$\n$d_2 = 1.2\\,\\mu\\text{m}$\n\nThe units of micrometers ($\\mu\\text{m}$) will cancel in the ratio, so we can use the numerical values directly.\nFirst, we compute the required terms:\nThe term for the parent branch is:\n$$f(d_0) = d_0^{3/2} = (3.0)^{3/2} \\approx 5.196152$$\nThe terms for the daughter branches are:\n$$d_1^{3/2} = (2.5)^{3/2} \\approx 3.952847$$\n$$d_2^{3/2} = (1.2)^{3/2} \\approx 1.314534$$\nThe sum for the daughter branches is:\n$$f(d_1, d_2) = d_1^{3/2} + d_2^{3/2} \\approx 3.952847 + 1.314534 = 5.267381$$\nNow, we substitute these values into the expression for $\\varepsilon$:\n$$\\varepsilon = \\frac{\\left| 5.267381 - 5.196152 \\right|}{5.196152} = \\frac{0.071229}{5.196152} \\approx 0.01370798$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\varepsilon \\approx 0.01371$$\nThis value represents an absolute fractional deviation of approximately $1.371\\%$ from the ideal impedance-matching condition for the given dendritic bifurcation.",
            "answer": "$$\\boxed{0.01371}$$"
        },
        {
            "introduction": "Scientific models provide powerful simplifications, but their true value is understood when we also appreciate their limitations. While Rall's 3/2 power rule offers a baseline for an 'ideal' dendrite, real neurons exhibit significant biological variability. This advanced practice challenges the ideal model by presenting a scenario where spatial heterogeneity in membrane properties, such as specific membrane resistance $R_m$, allows for near-perfect impedance matching even when the classic diameter rule is violated . This exercise will sharpen your critical thinking by demonstrating how local biophysical variations can create functional equivalences that are not apparent from morphology alone.",
            "id": "4004781",
            "problem": "Consider a passive dendritic branching point under one-dimensional cable theory with semi-infinite approximations and finite-length corrections. The following standard definitions apply: the specific membrane resistance $R_m$ (units $\\Omega \\cdot \\mathrm{cm}^2$), the specific axial resistivity $R_i$ (units $\\Omega \\cdot \\mathrm{cm}$), the per-unit-length membrane resistance $r_m = \\dfrac{R_m}{\\pi d}$, the per-unit-length axial resistance $r_i = \\dfrac{4 R_i}{\\pi d^2}$ for a cylindrical cable of diameter $d$, the space constant $\\lambda = \\sqrt{\\dfrac{r_m}{r_i}} = \\sqrt{\\dfrac{R_m d}{4 R_i}}$, and the input impedance of a passive, uniform cable of length $L$ given by $Z(L) = \\sqrt{r_m r_i} \\, \\coth\\!\\left(\\dfrac{L}{\\lambda}\\right)$. The well-known Rall $3/2$ law (Rall’s law) for diameter-based impedance matching at a branch point is derived under uniform $R_m$, uniform $R_i$, and semi-infinite branch approximations, leading to the condition $d_p^{3/2} = \\sum_i d_i^{3/2}$, where $d_p$ denotes the parent diameter and $d_i$ are daughter diameters.\n\nYou are asked to construct a counterexample in which the observed diameters violate the $3/2$ law yet the branch point maintains approximate impedance matching due to spatial variability in $R_m$, and to analyze conditions under which such heterogeneity masks diameter violations.\n\nUse the following scientifically plausible parameters:\n- Parent diameter $d_p = 4 \\ \\mu \\mathrm{m}$, daughter diameters $d_1 = 2 \\ \\mu \\mathrm{m}$ and $d_2 = 2 \\ \\mu \\mathrm{m}$.\n- Uniform specific axial resistivity $R_i = 100 \\ \\Omega \\cdot \\mathrm{cm}$ throughout.\n- Parent specific membrane resistance near the branch $R_{m,p} = 2.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$.\n- Each daughter exhibits spatially heterogeneous specific membrane resistance: proximal segment $x \\in [0, \\lambda_i(0)]$ has $R_{m,i}(x) = 1.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$, and more distal segments $x > \\lambda_i(0)$ transition to $R_{m,i}(x) = 2.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$ smoothly over a distance of order $\\lambda_i(0)$.\n- Each daughter cable total physical length $L_i = 2 \\ \\mathrm{mm}$, and the parent proximal segment is effectively semi-infinite relative to its space constant.\n\nTasks:\n1. Using the uniform formulas for a local, proximal segment to approximate the characteristic impedance seen at the branch point, compute the input impedances of the parent and daughters near the branch, first under the semi-infinite approximation $Z_\\infty = \\sqrt{r_m r_i}$, and then include the finite-length correction via $Z(L) = \\sqrt{r_m r_i} \\, \\coth(L/\\lambda)$ using the proximal values $R_{m,p}$ and $R_{m,i}(0)$ to define $\\lambda$ locally. Treat the daughters as parallel impedances at the branch point and show that approximate impedance matching holds despite violation of the $3/2$ law in diameters.\n2. Based on the cable-theoretic foundations above, determine the general matching condition at the branch point when $R_m$ is allowed to vary across branches and along them, and articulate sufficient conditions on spatial variability that ensure the proximal impedance dominates so that diameter violations are masked.\n\nWhich option best captures the correct conditions under which spatial $R_m$ heterogeneity near the branch point can mask violations of the $3/2$ law while maintaining approximate impedance matching?\n\nA. Matching is achieved if the parent’s proximal characteristic admittance equals the sum of the daughters’ proximal characteristic admittances, i.e., $\\dfrac{d_p^{3/2}}{\\sqrt{R_{m,p}}} \\approx \\sum_i \\dfrac{d_i^{3/2}}{\\sqrt{R_{m,i}(0)}}$, assuming uniform $R_i$, and the daughters satisfy $L_i / \\lambda_i(0) \\gtrsim 2$ with proximal $R_m$ varying on spatial scales $\\ell_i$ such that $\\left|\\dfrac{d \\ln R_m}{dx}\\right|_{x=0} \\ll \\dfrac{1}{\\lambda_i(0)}$, so that proximal properties dominate $Z(L)$ via $Z(L) \\approx \\sqrt{r_m(0) r_i(0)} \\, \\coth\\!\\left(\\dfrac{L}{\\lambda(0)}\\right)$.\n\nB. Impedance matching can be restored solely by increasing $R_m$ distally in the daughters when $L_i / \\lambda_i(0) \\ll 1$, because distal heterogeneity under short-cable conditions determines $Z(L)$ and compensates morphological mismatch.\n\nC. If $R_m$ varies rapidly over distances shorter than the local space constant near the branch point, reflections decrease and matching improves, thereby masking diameter violations.\n\nD. With uniform $R_i$, impedance matching depends only on diameters, and the $3/2$ law cannot be violated without reflections regardless of any spatial heterogeneity in $R_m$.",
            "solution": "The problem asks for an analysis of impedance matching at a dendritic branch point under conditions where the classic Rall $3/2$ power law for diameters is violated, but compensation is achieved through spatial heterogeneity of the specific membrane resistance, $R_m$.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Parent Diameter:** $d_p = 4 \\ \\mu \\mathrm{m}$\n- **Daughter Diameters:** $d_1 = 2 \\ \\mu \\mathrm{m}$, $d_2 = 2 \\ \\mu \\mathrm{m}$\n- **Specific Axial Resistivity (uniform):** $R_i = 100 \\ \\Omega \\cdot \\mathrm{cm}$\n- **Parent Specific Membrane Resistance:** $R_{m,p} = 2.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$\n- **Daughter Specific Membrane Resistance (heterogeneous):**\n  - Proximal ($x \\in [0, \\lambda_i(0)]$): $R_{m,i}(x) = 1.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$\n  - Distal ($x > \\lambda_i(0)$): transitions smoothly to $2.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$\n- **Daughter Cable Length:** $L_i = 2 \\ \\mathrm{mm} = 0.2 \\ \\mathrm{cm}$\n- **Parent Cable Length:** Effectively semi-infinite.\n- **Formulas:**\n  - $r_m = \\dfrac{R_m}{\\pi d}$\n  - $r_i = \\dfrac{4 R_i}{\\pi d^2}$\n  - $\\lambda = \\sqrt{\\dfrac{r_m}{r_i}} = \\sqrt{\\dfrac{R_m d}{4 R_i}}$\n  - $Z(L) = \\sqrt{r_m r_i} \\, \\coth\\!\\left(\\dfrac{L}{\\lambda}\\right)$\n  - $Z_\\infty = \\sqrt{r_m r_i}$ (semi-infinite impedance)\n- **Rall's $3/2$ Law:** $d_p^{3/2} = \\sum_i d_i^{3/2}$ (derived under uniform $R_m, R_i$ and semi-infinite branches)\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded in standard cable theory as used in computational neuroscience. The parameters are physiologically plausible for mammalian neurons. The terminology is precise and the objectives are clearly stated. The problem is well-posed, providing sufficient information to perform the required calculations and theoretical analysis. It does not violate any fundamental principles, is not based on false premises, and contains no internal contradictions. The concepts of local approximation for heterogeneous cables and finite-length corrections are standard techniques in the field.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution process may proceed.\n\n### Solution Derivation\n\n**Task 1: Counterexample Calculation**\n\nFirst, we confirm that the given diameters violate the Rall $3/2$ power law.\nThe left-hand side (LHS) of the law is the parent term:\n$$d_p^{3/2} = (4)^{3/2} = 8 \\ (\\mu\\mathrm{m})^{3/2}$$\nThe right-hand side (RHS) is the sum of daughter terms:\n$$\\sum_i d_i^{3/2} = d_1^{3/2} + d_2^{3/2} = (2)^{3/2} + (2)^{3/2} = 2 \\cdot 2^{3/2} = 2^{5/2} = \\sqrt{32} \\approx 5.657 \\ (\\mu\\mathrm{m})^{3/2}$$\nSince $8 \\neq 5.657$, the $3/2$ law is violated.\n\nNext, we evaluate the impedance matching condition, which states that the input impedance of the parent branch, $Z_p$, must equal the combined parallel impedance of the daughter branches, $Z_{\\text{daughters}} = \\left( \\frac{1}{Z_1} + \\frac{1}{Z_2} \\right)^{-1}$. This is equivalent to matching admittances: $Y_p = Y_1 + Y_2$, where $Y = 1/Z$.\n\nThe characteristic impedance for a semi-infinite cable, $Z_\\infty = \\sqrt{r_m r_i}$, can be expressed in terms of the primary parameters $R_m$, $R_i$, and $d$:\n$$Z_\\infty = \\frac{2}{\\pi} \\frac{\\sqrt{R_m R_i}}{d^{3/2}}$$\n\nLet's calculate the impedance of the parent branch, which is treated as semi-infinite.\n$d_p = 4 \\ \\mu\\mathrm{m} = 4 \\times 10^{-4} \\ \\mathrm{cm}$\n$R_{m,p} = 2.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$\n$R_i = 100 \\ \\Omega \\cdot \\mathrm{cm}$\n$$Z_p = Z_{p,\\infty} = \\frac{2}{\\pi} \\frac{\\sqrt{(2.0 \\times 10^4)(100)}}{(4 \\times 10^{-4})^{3/2}} = \\frac{2}{\\pi} \\frac{\\sqrt{2 \\times 10^6}}{8 \\times 10^{-6}} = \\frac{2 \\cdot \\sqrt{2} \\cdot 10^3}{8\\pi \\cdot 10^{-6}} = \\frac{\\sqrt{2}}{4\\pi} \\times 10^9 \\ \\Omega \\approx 112.5 \\ \\mathrm{M}\\Omega$$\n\nNow, we calculate the impedance of the daughter branches. Since they are identical, $Z_1 = Z_2$. We use the proximal parameters as instructed.\n$d_i = 2 \\ \\mu\\mathrm{m} = 2 \\times 10^{-4} \\ \\mathrm{cm}$\n$R_{m,i}(0) = 1.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2$\n$R_i = 100 \\ \\Omega \\cdot \\mathrm{cm}$\n\nUnder the semi-infinite approximation for the daughters:\n$$Z_{i,\\infty}(0) = \\frac{2}{\\pi} \\frac{\\sqrt{(1.0 \\times 10^4)(100)}}{(2 \\times 10^{-4})^{3/2}} = \\frac{2}{\\pi} \\frac{\\sqrt{10^6}}{2\\sqrt{2} \\times 10^{-6}} = \\frac{2 \\cdot 10^3}{2\\sqrt{2}\\pi \\cdot 10^{-6}} = \\frac{1}{\\sqrt{2}\\pi} \\times 10^9 \\ \\Omega \\approx 225.1 \\ \\mathrm{M}\\Omega$$\nThe combined impedance of the two identical daughters in parallel is:\n$$Z_{\\text{daughters}} = \\left( \\frac{1}{Z_{1,\\infty}(0)} + \\frac{1}{Z_{2,\\infty}(0)} \\right)^{-1} = \\frac{Z_{1,\\infty}(0)}{2} \\approx \\frac{225.1}{2} \\ \\mathrm{M}\\Omega \\approx 112.5 \\ \\mathrm{M}\\Omega$$\nWe see that $Z_p \\approx Z_{\\text{daughters}}$. Under the semi-infinite approximation with local parameters, the impedance match is nearly perfect, demonstrating the principle.\n\nNow, we apply the finite-length correction, $Z_i(L_i) = Z_{i,\\infty}(0) \\, \\coth(L_i/\\lambda_i(0))$. We first need the local space constant $\\lambda_i(0)$:\n$$\\lambda_i(0) = \\sqrt{\\frac{R_{m,i}(0) d_i}{4 R_i}} = \\sqrt{\\frac{(1.0 \\times 10^4 \\ \\Omega \\cdot \\mathrm{cm}^2)(2 \\times 10^{-4} \\ \\mathrm{cm})}{4 (100 \\ \\Omega \\cdot \\mathrm{cm})}} = \\sqrt{\\frac{2}{400}} \\ \\mathrm{cm} = \\frac{1}{\\sqrt{200}} \\ \\mathrm{cm} \\approx 0.0707 \\ \\mathrm{cm}$$\nThe electrotonic length is $L_i/\\lambda_i(0)$:\n$$\\frac{L_i}{\\lambda_i(0)} = \\frac{0.2 \\ \\mathrm{cm}}{0.0707 \\ \\mathrm{cm}} \\approx 2.828$$\nThe correction factor is $\\coth(2.828) \\approx 1.007$.\nThe corrected daughter impedance is:\n$$Z_i(L_i) \\approx (225.1 \\ \\mathrm{M}\\Omega)(1.007) \\approx 226.7 \\ \\mathrm{M}\\Omega$$\nThe corrected combined impedance is:\n$$Z_{\\text{daughters}} = \\frac{Z_i(L_i)}{2} \\approx \\frac{226.7 \\ \\mathrm{M}\\Omega}{2} \\approx 113.4 \\ \\mathrm{M}\\Omega$$\nComparing $Z_p = 112.5 \\ \\mathrm{M}\\Omega$ to $Z_{\\text{daughters}} \\approx 113.4 \\ \\mathrm{M}\\Omega$, the mismatch is less than $1\\%$. This confirms that approximate impedance matching holds despite the clear violation of the $3/2$ law.\n\n**Task 2: General Matching Condition and Proximal Dominance**\n\nThe general condition for impedance matching is $Y_p = \\sum_i Y_i$, where $Y=1/Z$ is the admittance. When the input impedance of a branch can be approximated by its proximal characteristic impedance, $Z \\approx Z_\\infty(0)$, the admittance is $Y \\approx Y_\\infty(0) = 1/Z_\\infty(0)$.\n$$Y_\\infty(0) = \\left( \\frac{2}{\\pi} \\frac{\\sqrt{R_m(0) R_i(0)}}{d^{3/2}} \\right)^{-1} = \\frac{\\pi}{2} \\frac{d^{3/2}}{\\sqrt{R_m(0) R_i(0)}}$$\nAssuming the parent is semi-infinite and the daughters are electrotonically long enough for the proximal impedance to dominate, the matching condition $Y_{p,\\infty}(0) \\approx \\sum_i Y_{i,\\infty}(0)$ becomes:\n$$\\frac{\\pi}{2} \\frac{d_p^{3/2}}{\\sqrt{R_{m,p}(0) R_{i,p}(0)}} \\approx \\sum_i \\frac{\\pi}{2} \\frac{d_i^{3/2}}{\\sqrt{R_{m,i}(0) R_{i,i}(0)}}$$\nGiven uniform $R_i$ throughout, $R_{i,p}(0) = R_{i,i}(0) = R_i$. The constants $\\frac{\\pi}{2}$ and $\\sqrt{R_i}$ cancel, yielding the generalized matching condition:\n$$\\frac{d_p^{3/2}}{\\sqrt{R_{m,p}(0)}} \\approx \\sum_i \\frac{d_i^{3/2}}{\\sqrt{R_{m,i}(0)}}$$\nThis shows that it is the ratio $d^{3/2}/\\sqrt{R_m}$ that must be matched across the branch point, not just $d^{3/2}$.\n\nThe conditions for this approximation to be valid (i.e., for the proximal impedance to dominate) are:\n1.  **Sufficient Electrotonic Length:** The daughter cables must be long enough that signals are significantly attenuated before reaching distal regions with different properties. This prevents reflections from distal heterogeneities from strongly influencing the input impedance. A rule of thumb is that the electrotonic length $L_i/\\lambda_i(0)$ should be greater than $\\approx 2$. For such lengths, $\\coth(L/\\lambda) \\approx 1$.\n2.  **Slow Variation of Properties:** The approximation of a non-uniform cable by a locally uniform one is valid when the properties change slowly on the length scale of the space constant. This is a WKB-type approximation condition. Mathematically, the fractional change in a parameter (like $R_m$) over a distance of one space constant must be small: $|\\frac{d R_m(x)}{dx}|_{x=0} \\frac{\\lambda_i(0)}{R_{m,i}(0)} \\ll 1$, which can be rewritten as $\\left|\\frac{d \\ln R_m}{dx}\\right|_{x=0} \\ll \\frac{1}{\\lambda_i(0)}$.\n\n### Option-by-Option Analysis\n\n**A. Matching is achieved if the parent’s proximal characteristic admittance equals the sum of the daughters’ proximal characteristic admittances, i.e., $\\dfrac{d_p^{3/2}}{\\sqrt{R_{m,p}}} \\approx \\sum_i \\dfrac{d_i^{3/2}}{\\sqrt{R_{m,i}(0)}}$, assuming uniform $R_i$, and the daughters satisfy $L_i / \\lambda_i(0) \\gtrsim 2$ with proximal $R_m$ varying on spatial scales $\\ell_i$ such that $\\left|\\dfrac{d \\ln R_m}{dx}\\right|_{x=0} \\ll \\dfrac{1}{\\lambda_i(0)}$, so that proximal properties dominate $Z(L)$...**\nThis option correctly states the generalized matching condition $\\frac{d_p^{3/2}}{\\sqrt{R_{m,p}}} \\approx \\sum_i \\frac{d_i^{3/2}}{\\sqrt{R_{m,i}(0)}}$ derived above. It also correctly identifies the two crucial conditions for this approximation to hold: sufficient electrotonic length ($L_i / \\lambda_i(0) \\gtrsim 2$) and slow spatial variation of properties ($\\left|\\frac{d \\ln R_m}{dx}\\right|_{x=0} \\ll \\frac{1}{\\lambda_i(0)}$). This is a comprehensive and accurate description of the phenomenon.\n**Verdict: Correct.**\n\n**B. Impedance matching can be restored solely by increasing $R_m$ distally in the daughters when $L_i / \\lambda_i(0) \\ll 1$, because distal heterogeneity under short-cable conditions determines $Z(L)$ and compensates morphological mismatch.**\nThis option describes the short-cable limit ($L_i / \\lambda_i(0) \\ll 1$). In this regime, the input impedance is dominated by the total membrane conductance and is not well-approximated by the characteristic impedance. While distal properties are indeed important for short cables, the problem's example operates in the electrotonically long regime ($L_i/\\lambda_i(0) \\approx 2.828$). Therefore, this option describes an irrelevant physical regime for the given problem and does not explain the demonstrated effect.\n**Verdict: Incorrect.**\n\n**C. If $R_m$ varies rapidly over distances shorter than the local space constant near the branch point, reflections decrease and matching improves, thereby masking diameter violations.**\nThis statement is fundamentally incorrect. Rapid variations or discontinuities in impedance cause *more* reflections, not fewer. Such reflections would disrupt impedance matching by introducing frequency- and location-dependent oscillations in the input impedance, making a simple matching condition fail. Smooth, slow variations are required for the local approximation to hold and for reflections to be minimized.\n**Verdict: Incorrect.**\n\n**D. With uniform $R_i$, impedance matching depends only on diameters, and the $3/2$ law cannot be violated without reflections regardless of any spatial heterogeneity in $R_m$.**\nThis statement is demonstrably false. Our explicit calculation shows that impedance matching can be achieved while violating the $3/2$ law, precisely because of the heterogeneity in $R_m$. The generalized matching condition $\\frac{d_p^{3/2}}{\\sqrt{R_{m,p}}} \\approx \\sum_i \\frac{d_i^{3/2}}{\\sqrt{R_{m,i}(0)}}$ clearly shows that impedance matching depends on both diameter and $R_m$. This option incorrectly claims the universal applicability of the $3/2$ law, which is only a special case for uniform $R_m$.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The theories connecting form and function in neuroscience are ultimately validated and refined by analyzing empirical data from neuron reconstructions. This final hands-on practice transitions from theoretical derivation to computational application, tasking you with building a feature extraction pipeline for 3D morphological data. By implementing algorithms to quantify features such as branch angles, path tortuosity, and dendritic tapering, you will be creating the foundational tools that enable data-driven classification of cell types and the systematic study of structure-function relationships in the nervous system .",
            "id": "4004748",
            "problem": "You are provided with the three-dimensional coordinates of nodes from a neuron reconstruction, together with a parent pointer for each node and a radius at each node. The reconstruction defines a rooted tree in three-dimensional space, where each node $i$ has position $(x_i, y_i, z_i)$ in micrometers (μm), a radius $r_i$ in micrometers (μm), and a parent index $p_i$, with $p_i = -1$ indicating the root. The tree is assumed to be anatomically plausible: it is a directed acyclic graph with a single root, and each node other than the root has exactly one parent.\n\nYour task is to derive and implement from first principles the computation of a morphological feature vector suitable for downstream classification. Starting from basic Euclidean geometry and definitions for curves discretized by polylines, you must construct the following features:\n\n1. Branch angle histogram:\n- For any node $b$ that has at least two children, define the outgoing segment vector for a child $c$ as $\\mathbf{v}_c = \\mathbf{x}_c - \\mathbf{x}_b$, where $\\mathbf{x}_j = (x_j, y_j, z_j)$ is the Cartesian coordinate of node $j$.\n- For each unordered pair of children $(c_1, c_2)$, define the branch angle\n$$\n\\theta(b; c_1, c_2) = \\arccos\\left(\\frac{\\mathbf{v}_{c_1} \\cdot \\mathbf{v}_{c_2}}{\\|\\mathbf{v}_{c_1}\\| \\, \\|\\mathbf{v}_{c_2}\\|}\\right),\n$$\nwith $\\theta$ measured in radians.\n- Accumulate all such angles across the entire tree and compute a normalized histogram with bin edges\n$$\nB_\\theta = [0, \\pi/6, \\pi/3, \\pi/2, 2\\pi/3, 5\\pi/6, \\pi],\n$$\ninterpreted as half-open intervals $[b_k, b_{k+1})$ except for the last bin, which is $[b_6, b_7]$. The histogram must be normalized to sum to $1$. If there are no bifurcation angles, the histogram must be a vector of zeros of length $6$.\n\n2. Root-to-leaf path length distribution:\n- Define a leaf as any node with zero children.\n- For each leaf $t$, define the unique path $P(t)$ from the root to $t$ and its length\n$$\nL(t) = \\sum_{(i \\rightarrow j) \\in P(t)} \\|\\mathbf{x}_j - \\mathbf{x}_i\\|,\n$$\nwith $\\|\\cdot\\|$ the Euclidean norm and lengths measured in micrometers (μm).\n- Compute a normalized histogram over the set $\\{L(t)\\}$ using bin edges\n$$\nB_L = [0, 20, 40, 60, 80, 100],\n$$\nwith the same half-open interpretation $[b_k, b_{k+1})$ except the last bin $[b_5, b_6]$. The histogram must sum to $1$. If there are no leaves, the histogram must be a vector of zeros of length $5$.\n\n3. Curvature estimates:\n- For each root-to-leaf path with ordered points $(\\mathbf{x}_0, \\mathbf{x}_1, \\dots, \\mathbf{x}_n)$, approximate the curvature at interior points $k = 1, \\dots, n-1$ by the discrete formula\n$$\n\\kappa_k = \\frac{\\arccos\\left(\\frac{(\\mathbf{x}_k - \\mathbf{x}_{k-1}) \\cdot (\\mathbf{x}_{k+1} - \\mathbf{x}_k)}{\\|\\mathbf{x}_k - \\mathbf{x}_{k-1}\\| \\, \\|\\mathbf{x}_{k+1} - \\mathbf{x}_k\\|}\\right)}{\\frac{1}{2}\\left(\\|\\mathbf{x}_k - \\mathbf{x}_{k-1}\\| + \\|\\mathbf{x}_{k+1} - \\mathbf{x}_k\\|\\right)},\n$$\nwith $\\kappa_k$ in radians per micrometer. Aggregate all curvature samples across all paths into a set $\\{\\kappa_k\\}$. Define the mean curvature\n$$\n\\bar{\\kappa} = \\frac{1}{M}\\sum_{m=1}^{M} \\kappa_m\n$$\nand the population standard deviation\n$$\n\\sigma_{\\kappa} = \\sqrt{\\frac{1}{M}\\sum_{m=1}^{M} (\\kappa_m - \\bar{\\kappa})^2},\n$$\nwhere $M$ is the total number of curvature samples across all paths. If there are no interior points, set both $\\bar{\\kappa}$ and $\\sigma_{\\kappa}$ to $0$.\n\n4. Tapering profiles:\n- For each root-to-leaf path, let $s_k$ be the cumulative path length at node $k$ measured from the root along the path (in micrometers), and $r_k$ the radius at node $k$ (in micrometers).\n- For each path with at least $2$ points, compute the ordinary least squares slope $m$ of $r$ versus $s$ given by\n$$\nm = \\frac{\\sum_{k}(s_k - \\bar{s})(r_k - \\bar{r})}{\\sum_{k}(s_k - \\bar{s})^2},\n$$\nwhere $\\bar{s}$ and $\\bar{r}$ are the means of $\\{s_k\\}$ and $\\{r_k\\}$, respectively. If the denominator is zero or the path has fewer than $2$ points, define $m = 0$. Aggregate the slopes from all paths into a set $\\{m\\}$ and define the mean slope\n$$\n\\bar{m} = \\frac{1}{P}\\sum_{p=1}^{P} m_p\n$$\nand the population standard deviation\n$$\n\\sigma_m = \\sqrt{\\frac{1}{P}\\sum_{p=1}^{P} (m_p - \\bar{m})^2},\n$$\nwhere $P$ is the number of paths.\n\nConstruct the feature vector by concatenating, in order, the branch angle histogram (length $6$), the path length histogram (length $5$), the curvature mean and standard deviation (length $2$), and the taper slope mean and standard deviation (length $2$). The total feature vector length is $15$. All lengths must be in micrometers (μm); all angles must be in radians; curvature must be in radians per micrometer; taper slopes must be in micrometers per micrometer.\n\nTest Suite:\nUse the following four test cases, each defined by a list of nodes $(i, x_i, y_i, z_i, r_i, p_i)$, where all coordinates and radii are in micrometers (μm) and indices are integers. The parent index $p_i = -1$ denotes the root.\n\n- Test case $1$ (straight cable):\n  - $(0, 0, 0, 0, 2, -1)$\n  - $(1, 0, 0, 10, 2, 0)$\n  - $(2, 0, 0, 20, 2, 1)$\n  - $(3, 0, 0, 30, 2, 2)$\n\n- Test case $2$ (symmetric Y-shape):\n  - $(0, 0, 0, 0, 3, -1)$\n  - $(1, 0, 0, 10, 2.5, 0)$\n  - $(2, 10, 0, 20, 2, 1)$\n  - $(3, -10, 0, 20, 2, 1)$\n\n- Test case $3$ (curved path with bifurcation):\n  - $(0, 0, 0, 0, 3, -1)$\n  - $(1, 0, 5, 5, 2.8, 0)$\n  - $(2, 0, 10, 10, 2.6, 1)$\n  - $(3, 0, 15, 10, 2.4, 2)$\n  - $(4, 4, 22, 10, 2.2, 3)$\n  - $(5, -2, 22, 10, 2.2, 3)$\n\n- Test case $4$ (long branches):\n  - $(0, 0, 0, 0, 4, -1)$\n  - $(1, 0, 0, 20, 3.5, 0)$\n  - $(2, 0, 0, 40, 3.0, 1)$\n  - $(3, 10, 0, 55, 2.5, 2)$\n  - $(4, 20, 0, 70, 2.0, 3)$\n  - $(5, -10, 0, 55, 2.5, 2)$\n  - $(6, -20, 0, 70, 2.0, 5)\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the feature vector (a list of $15$ floats) for one test case, aggregated into a single top-level list. For example: \"[[f1,f2,...,f15],[g1,g2,...,g15],[h1,h2,...,h15],[k1,k2,...,k15]]\". Angles must be in radians; lengths must be in micrometers (μm); curvature must be in radians per micrometer; taper slopes must be in micrometers per micrometer. No additional text should be printed.\n\nThe implementation must be a complete, runnable program that uses only the specified runtime environment. All numerical answers must be floats. The algorithm must be robust to boundary cases including nodes with no bifurcations, paths with constant radius, and paths too short to define curvature or slope.",
            "solution": "The problem proposed is valid. It is scientifically grounded in the field of computational neuroscience, specifically in the morphometric analysis of neuron reconstructions. All provided definitions, formulas, and conditions are mathematically and algorithmically sound, well-posed, and free from ambiguity or contradiction. The task is to implement a feature extraction pipeline from first principles, which is a standard and verifiable procedure.\n\nThe solution is developed through a systematic, multi-step process. First, the input data, a list of node properties, is parsed into a graph data structure representing the neuron's tree-like morphology. Subsequently, four distinct sets of morphological features are computed based on this structure: the branch angle histogram, the root-to-leaf path length distribution, statistics of local curvature, and statistics of dendritic tapering. Finally, these features are concatenated into a single feature vector of dimension $15$.\n\n**1. Data Structuring**\n\nThe initial input is a list of nodes, each defined by its index $i$, Cartesian coordinates $\\mathbf{x}_i = (x_i, y_i, z_i)$, radius $r_i$, and parent index $p_i$. To facilitate traversal and neighborhood queries, we first transform this flat list into a more structured representation. A dictionary mapping each node index to its properties (coordinates, radius, parent) provides efficient lookups. A second dictionary, representing an adjacency list, is constructed to map each parent node index to a list of its children indices. This is achieved by iterating through all nodes and, for each node $i$ with parent $p_i \\neq -1$, appending $i$ to the list of children for $p_i$. The single node with $p_i = -1$ is identified as the root of the tree.\n\n**2. Feature Derivation and Computation**\n\nThe computation of the four feature groups proceeds as follows, adhering strictly to the provided definitions.\n\n**2.1. Branch Angle Histogram**\n\nThis feature quantifies the geometry of dendritic bifurcations.\n- A branch point, or bifurcation node $b$, is defined as any node with two or more children. We identify all such nodes by inspecting the previously constructed children-map.\n- For each bifurcation node $b$, we consider every unordered pair of its children, $(c_1, c_2)$.\n- The direction of the initial segment of each child branch is given by the vector from the parent to the child: $\\mathbf{v}_{c_1} = \\mathbf{x}_{c_1} - \\mathbf{x}_b$ and $\\mathbf{v}_{c_2} = \\mathbf{x}_{c_2} - \\mathbf{x}_b$.\n- The angle $\\theta$ between these two vectors is a measure of how widely the branches splay. It is computed from the definition of the dot product:\n$$\n\\theta(b; c_1, c_2) = \\arccos\\left(\\frac{\\mathbf{v}_{c_1} \\cdot \\mathbf{v}_{c_2}}{\\|\\mathbf{v}_{c_1}\\| \\|\\mathbf{v}_{c_2}\\|}\\right)\n$$\nwhere $\\|\\cdot\\|$ denotes the Euclidean norm. The argument of the $\\arccos$ function is clipped to the range $[-1, 1]$ to prevent numerical errors from floating-point inaccuracies.\n- All such angles from all bifurcation points in the tree are collected into a single list.\n- A histogram of these angles is computed using the specified bin edges $B_\\theta = [0, \\pi/6, \\pi/3, \\pi/2, 2\\pi/3, 5\\pi/6, \\pi]$. This results in a $6$-dimensional vector of counts.\n- To make the feature independent of the neuron's size (i.e., the total number of bifurcations), the histogram is normalized by dividing each bin count by the total number of angles, ensuring the components sum to $1$. If no bifurcation points exist, a zero vector of length $6$ is returned, as per the problem specification.\n\n**2.2. Root-to-Leaf Path Length Distribution**\n\nThis feature captures the distribution of electrotonic distances from the soma (root) to the terminal tips of the dendrites.\n- A leaf node $t$ is defined as any node with zero children. We identify all such nodes.\n- For each leaf node $t$, we trace its unique path back to the root using the parent pointers. This yields the sequence of nodes $P(t) = (\\mathbf{x}_0, \\mathbf{x}_1, \\dots, \\mathbf{x}_n=t)$ comprising the path.\n- The total length of this path, $L(t)$, is the sum of the Euclidean lengths of its constituent segments:\n$$\nL(t) = \\sum_{(i \\rightarrow j) \\in P(t)} \\|\\mathbf{x}_j - \\mathbf{x}_i\\|\n$$\n- The lengths of all such root-to-leaf paths are collected.\n- A normalized histogram is computed over these path lengths using the specified bin edges $B_L = [0, 20, 40, 60, 80, 100]$, resulting in a $5$-dimensional vector. Normalization is performed by dividing by the total number of leaves. If there are no leaves, a zero vector of length $5$ is returned.\n\n**2.3. Curvature Estimates**\n\nThis feature measures the tortuosity of dendritic paths.\n- We reuse the root-to-leaf paths identified in the previous step.\n- For each path with at least $3$ nodes, $(\\mathbf{x}_0, \\mathbf{x}_1, \\dots, \\mathbf{x}_n)$, we can estimate curvature at the interior nodes $k = 1, \\dots, n-1$.\n- The discrete curvature $\\kappa_k$ at node $\\mathbf{x}_k$ is defined as the turning angle per unit of path length. The turning angle is the angle between the incoming vector $(\\mathbf{x}_k - \\mathbf{x}_{k-1})$ and the outgoing vector $(\\mathbf{x}_{k+1} - \\mathbf{x}_k)$. The path length unit is approximated by the average length of these two segments. This gives the formula:\n$$\n\\kappa_k = \\frac{\\arccos\\left(\\frac{(\\mathbf{x}_k - \\mathbf{x}_{k-1}) \\cdot (\\mathbf{x}_{k+1} - \\mathbf{x}_k)}{\\|\\mathbf{x}_k - \\mathbf{x}_{k-1}\\| \\, \\|\\mathbf{x}_{k+1} - \\mathbf{x}_k\\|}\\right)}{\\frac{1}{2}\\left(\\|\\mathbf{x}_k - \\mathbf{x}_{k-1}\\| + \\|\\mathbf{x}_{k+1} - \\mathbf{x}_k\\|\\right)}\n$$\n- A check is performed to ensure segment lengths are non-zero to avoid division by zero.\n- All valid curvature samples $\\kappa_k$ from all paths are aggregated.\n- From this collection of samples, we compute two summary statistics: the mean curvature $\\bar{\\kappa}$ and the population standard deviation $\\sigma_{\\kappa}$. If no interior points exist in the entire tree (i.e., all paths have fewer than $3$ nodes), both statistics are set to $0$.\n\n**2.4. Tapering Profiles**\n\nThis feature describes how the radius of dendritic branches changes with distance from the root, which is related to Rall's power law.\n- For each root-to-leaf path with at least $2$ nodes, we analyze the relationship between radius $r$ and cumulative path distance from the root $s$.\n- For a path with nodes $(_0, _1, ..., _n)$, the cumulative distance at node $k$ is $s_k = \\sum_{i=0}^{k-1} \\|\\mathbf{x}_{i+1} - \\mathbf{x}_i\\|$, with $s_0=0$. The corresponding radii are $\\{r_0, r_1, \\dots, r_n\\}$.\n- For each path, we compute the slope $m$ of the ordinary least squares linear regression of radius $r$ on distance $s$. The formula is given by the ratio of the covariance of $s$ and $r$ to the variance of $s$:\n$$\nm = \\frac{\\sum_{k}(s_k - \\bar{s})(r_k - \\bar{r})}{\\sum_{k}(s_k - \\bar{s})^2}\n$$\n- As specified, if the path has fewer than $2$ points or if the denominator is zero (i.e., all cumulative distances are the same, which implies zero-length segments), the slope $m$ is defined as $0$.\n- The slopes from all valid paths are collected.\n- The mean slope $\\bar{m}$ and the population standard deviation of slopes $\\sigma_m$ are computed. If there are no paths for which a slope can be computed, both statistics are set to $0$.\n\n**3. Feature Vector Assembly**\n\nThe final $15$-dimensional feature vector is constructed by concatenating the results of the above computations in the specified order:\n1.  Branch Angle Histogram (6 floats)\n2.  Path Length Histogram (5 floats)\n3.  Mean and Standard Deviation of Curvature (2 floats)\n4.  Mean and Standard Deviation of Taper Slope (2 floats)\n\nThis procedure provides a comprehensive, quantitative description of the neuron's morphology, suitable for use in machine learning models for cell type classification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef compute_features(nodes_data):\n    \"\"\"\n    Computes morphological features for a single neuron reconstruction.\n    \"\"\"\n    if not nodes_data:\n        return [0.0] * 15\n\n    # 1. Data Structuring\n    num_nodes = len(nodes_data)\n    nodes = {}\n    children = {i: [] for i in range(num_nodes)}\n    root_id = -1\n\n    node_list = sorted(nodes_data, key=lambda n: n[0])\n\n    for (node_id, x, y, z, r, p) in node_list:\n        nodes[node_id] = {\n            'pos': np.array([x, y, z], dtype=float),\n            'radius': float(r),\n            'parent': int(p)\n        }\n        if p != -1:\n            if p in children:\n                children[p].append(node_id)\n        else:\n            root_id = node_id\n\n    # 2. Feature Calculation\n\n    # 2.1. Branch Angle Histogram\n    branch_angles = []\n    bifurcation_node_ids = [i for i, c in children.items() if len(c) >= 2]\n    for b_id in bifurcation_node_ids:\n        b_pos = nodes[b_id]['pos']\n        for c1_id, c2_id in itertools.combinations(children[b_id], 2):\n            v1 = nodes[c1_id]['pos'] - b_pos\n            v2 = nodes[c2_id]['pos'] - b_pos\n            norm_v1 = np.linalg.norm(v1)\n            norm_v2 = np.linalg.norm(v2)\n            if norm_v1 > 0 and norm_v2 > 0:\n                cos_theta = np.dot(v1, v2) / (norm_v1 * norm_v2)\n                cos_theta = np.clip(cos_theta, -1.0, 1.0)\n                angle = np.arccos(cos_theta)\n                branch_angles.append(angle)\n\n    angle_bins = [0, np.pi/6, np.pi/3, np.pi/2, 2*np.pi/3, 5*np.pi/6, np.pi]\n    if branch_angles:\n        hist_angles, _ = np.histogram(branch_angles, bins=angle_bins)\n        hist_angles = hist_angles.astype(float) / len(branch_angles)\n    else:\n        hist_angles = np.zeros(len(angle_bins) - 1, dtype=float)\n\n    # 2.2, 2.3, 2.4: Path-based features\n    leaf_ids = [i for i in range(num_nodes) if not children[i]]\n    \n    path_lengths = []\n    curvatures = []\n    taper_slopes = []\n\n    for leaf_id in leaf_ids:\n        path = []\n        curr_id = leaf_id\n        while curr_id != -1:\n            path.append(curr_id)\n            curr_id = nodes[curr_id]['parent']\n        path.reverse()\n        \n        if not path:\n            continue\n        \n        # Path length and cumulative length calculation\n        total_length = 0.0\n        segment_lengths = []\n        if len(path) > 1:\n            for i in range(len(path) - 1):\n                p1_pos = nodes[path[i]]['pos']\n                p2_pos = nodes[path[i+1]]['pos']\n                length = np.linalg.norm(p2_pos - p1_pos)\n                segment_lengths.append(length)\n            total_length = sum(segment_lengths)\n        path_lengths.append(total_length)\n        \n        # Curvature calculation\n        if len(path) >= 3:\n            for i in range(1, len(path) - 1):\n                p_prev_pos = nodes[path[i-1]]['pos']\n                p_curr_pos = nodes[path[i]]['pos']\n                p_next_pos = nodes[path[i+1]]['pos']\n                \n                v_in = p_curr_pos - p_prev_pos\n                v_out = p_next_pos - p_curr_pos\n                \n                norm_in = np.linalg.norm(v_in)\n                norm_out = np.linalg.norm(v_out)\n                \n                if norm_in > 0 and norm_out > 0:\n                    cos_theta = np.dot(v_in, v_out) / (norm_in * norm_out)\n                    cos_theta = np.clip(cos_theta, -1.0, 1.0)\n                    angle = np.arccos(cos_theta)\n                    avg_len = (norm_in + norm_out) / 2.0\n                    curvatures.append(angle / avg_len)\n\n        # Tapering calculation\n        if len(path) >= 2:\n            s = np.concatenate(([0.0], np.cumsum(segment_lengths)))\n            r = np.array([nodes[node_id]['radius'] for node_id in path])\n            \n            s_mean = np.mean(s)\n            denominator = np.sum((s - s_mean)**2)\n            \n            if denominator > 0:\n                r_mean = np.mean(r)\n                numerator = np.sum((s - s_mean) * (r - r_mean))\n                slope = numerator / denominator\n                taper_slopes.append(slope)\n            else:\n                taper_slopes.append(0.0)\n        elif len(path) > 0:\n             # Path has only 1 node, so less than 2 points.\n             taper_slopes.append(0.0)\n\n    # Post-processing path features\n    length_bins = [0, 20, 40, 60, 80, 100]\n    if path_lengths:\n        hist_lengths, _ = np.histogram(path_lengths, bins=length_bins)\n        hist_lengths = hist_lengths.astype(float) / len(path_lengths)\n    else:\n        hist_lengths = np.zeros(len(length_bins) - 1, dtype=float)\n\n    if curvatures:\n        mean_kappa = np.mean(curvatures)\n        std_kappa = np.std(curvatures)\n    else:\n        mean_kappa, std_kappa = 0.0, 0.0\n\n    if taper_slopes:\n        mean_m = np.mean(taper_slopes)\n        std_m = np.std(taper_slopes)\n    else:\n        mean_m, std_m = 0.0, 0.0\n    \n    # 3. Assemble Feature Vector\n    feature_vector = np.concatenate([\n        hist_angles,\n        hist_lengths,\n        [mean_kappa, std_kappa],\n        [mean_m, std_m]\n    ])\n    \n    return feature_vector.tolist()\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (straight cable)\n        [\n            (0, 0, 0, 0, 2, -1),\n            (1, 0, 0, 10, 2, 0),\n            (2, 0, 0, 20, 2, 1),\n            (3, 0, 0, 30, 2, 2)\n        ],\n        # Test case 2 (symmetric Y-shape)\n        [\n            (0, 0, 0, 0, 3, -1),\n            (1, 0, 0, 10, 2.5, 0),\n            (2, 10, 0, 20, 2, 1),\n            (3, -10, 0, 20, 2, 1)\n        ],\n        # Test case 3 (curved path with bifurcation)\n        [\n            (0, 0, 0, 0, 3, -1),\n            (1, 0, 5, 5, 2.8, 0),\n            (2, 0, 10, 10, 2.6, 1),\n            (3, 0, 15, 10, 2.4, 2),\n            (4, 4, 22, 10, 2.2, 3),\n            (5, -2, 22, 10, 2.2, 3)\n        ],\n        # Test case 4 (long branches)\n        [\n            (0, 0, 0, 0, 4, -1),\n            (1, 0, 0, 20, 3.5, 0),\n            (2, 0, 0, 40, 3.0, 1),\n            (3, 10, 0, 55, 2.5, 2),\n            (4, 20, 0, 70, 2.0, 3),\n            (5, -10, 0, 55, 2.5, 2),\n            (6, -20, 0, 70, 2.0, 5)\n        ]\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_features(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}