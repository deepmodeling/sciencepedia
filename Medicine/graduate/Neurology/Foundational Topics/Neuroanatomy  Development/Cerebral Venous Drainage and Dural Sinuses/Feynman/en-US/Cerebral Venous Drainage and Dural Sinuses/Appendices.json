{
    "hands_on_practices": [
        {
            "introduction": "To understand the dynamics of the cerebral venous system, we begin with its fundamental building block: the sinus segment. This exercise applies the principles of fluid dynamics to a simplified model of a dural sinus, guiding you through the derivation of the Hagen-Poiseuille equation from first principles. By calculating the pressure drop across a sinus segment, you will gain a quantitative appreciation for why these large vessels function as highly efficient, low-resistance conduits for cerebral blood flow .",
            "id": "4467210",
            "problem": "A dural venous sinus segment is approximated as a rigid, circular conduit with uniform cross-section. Assume steady, incompressible, axisymmetric laminar flow of a Newtonian fluid. A uniform segment of sinus has radius $r=4\\ \\text{mm}$, dynamic viscosity $\\mu=3.5\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$, length $L=30\\ \\text{cm}$, and carries volumetric flow $Q=6\\ \\text{ml/s}$. Starting from the continuum mechanical balance appropriate for viscous flow in a circular tube, derive the relationship connecting the axial pressure drop $\\Delta P$ to the volumetric flow $Q$, and then compute $\\Delta P$ for this segment. Express your final $\\Delta P$ in millimeters of mercury (mmHg) and round your answer to three significant figures. Finally, briefly interpret the magnitude of the computed $\\Delta P$ in physiological terms in relation to cerebral venous drainage in dural sinuses.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   **Model:** A dural venous sinus segment is approximated as a rigid, circular conduit with uniform cross-section.\n-   **Flow conditions:** Steady, incompressible, axisymmetric laminar flow.\n-   **Fluid properties:** Newtonian fluid with dynamic viscosity $\\mu=3.5\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$.\n-   **Geometry:** Radius $r=4\\ \\text{mm}$, length $L=30\\ \\text{cm}$.\n-   **Flow rate:** Volumetric flow $Q=6\\ \\text{ml/s}$.\n-   **Objective 1:** Starting from the continuum mechanical balance, derive the relationship connecting axial pressure drop $\\Delta P$ to volumetric flow $Q$.\n-   **Objective 2:** Compute $\\Delta P$ for the segment.\n-   **Objective 3:** Express the final $\\Delta P$ in millimeters of mercury (mmHg) and round to three significant figures.\n-   **Objective 4:** Briefly interpret the result's magnitude in physiological context.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a classic application of fluid dynamics to a simplified model of blood flow. The governing principles (Navier-Stokes equations for viscous flow) are fundamental. The model assumptions (steady, laminar, incompressible, Newtonian flow in a rigid pipe) are standard for a first-order analysis of arterial or large-vessel venous flow, known as Hagen-Poiseuille flow. The provided values for blood viscosity, sinus dimensions, and flow rate are physiologically plausible for a major dural venous sinus.\n-   **Well-Posed:** The problem is well-posed. The provided data and explicitly stated assumptions are sufficient to derive the requested relationship and compute a unique value for the pressure drop.\n-   **Objective:** The problem is stated in precise, objective language without subjective or non-scientific claims.\n-   **Conclusion:** The problem is free of scientific unsoundness, ambiguity, and internal contradictions. It is a valid, well-posed problem in biophysical fluid dynamics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\nThe derivation begins with the Navier-Stokes equations for an incompressible Newtonian fluid, expressed in cylindrical coordinates $(R, \\theta, z)$, where $z$ is the axial direction of the conduit. The axial component of the momentum balance is:\n$$ \\rho \\left( \\frac{\\partial v_z}{\\partial t} + v_R \\frac{\\partial v_z}{\\partial R} + \\frac{v_\\theta}{R} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial P}{\\partial z} + \\mu \\left[ \\frac{1}{R} \\frac{\\partial}{\\partial R} \\left( R \\frac{\\partial v_z}{\\partial R} \\right) + \\frac{1}{R^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right] + \\rho g_z $$\nWe apply the simplifying assumptions given in the problem:\n1.  **Steady flow:** All time derivatives are zero, so $\\frac{\\partial v_z}{\\partial t} = 0$.\n2.  **Axisymmetric flow:** There is no variation in the tangential direction, so $\\frac{\\partial}{\\partial \\theta} = 0$. The tangential velocity component is zero, $v_\\theta=0$.\n3.  **Fully developed laminar flow:** The velocity profile is constant along the axial direction, so $\\frac{\\partial v_z}{\\partial z} = 0$. For an incompressible fluid in a pipe of constant cross-section, the continuity equation $\\nabla \\cdot \\mathbf{v} = 0$ simplifies, and combined with the no-slip condition at the wall, implies the radial velocity component is also zero, $v_R=0$.\n4.  The gravitational body force $\\rho g_z$ is assumed to be negligible or incorporated into the pressure term $P$.\n\nApplying these simplifications, the momentum equation reduces significantly. All terms on the left-hand side (the convective acceleration) become zero. The second and third terms within the viscosity bracket also become zero. The equation simplifies to:\n$$ 0 = -\\frac{dP}{dz} + \\frac{\\mu}{R} \\frac{d}{dR} \\left( R \\frac{d v_z}{dR} \\right) $$\nHere, we use total derivatives because pressure $P$ can be shown to be a function of $z$ only, and the axial velocity $v_z$ is a function of $R$ only. Rearranging this ordinary differential equation gives:\n$$ \\frac{d}{dR} \\left( R \\frac{d v_z}{dR} \\right) = \\frac{R}{\\mu} \\frac{dP}{dz} $$\nIntegrating once with respect to $R$:\n$$ R \\frac{d v_z}{dR} = \\frac{R^2}{2\\mu} \\frac{dP}{dz} + C_1 $$\nDividing by $R$ and integrating a second time:\n$$ v_z(R) = \\frac{R^2}{4\\mu} \\frac{dP}{dz} + C_1 \\ln(R) + C_2 $$\nTo determine the integration constants $C_1$ and $C_2$, we apply the boundary conditions:\n1.  The velocity must be finite at the centerline of the pipe ($R=0$). Since $\\ln(R)$ approaches $-\\infty$ as $R \\to 0$, we must have $C_1 = 0$ to avoid a physically impossible infinite velocity.\n2.  The no-slip condition at the pipe wall ($R=r$) requires the fluid velocity to be zero: $v_z(r) = 0$.\n    $$ 0 = \\frac{r^2}{4\\mu} \\frac{dP}{dz} + C_2 \\implies C_2 = -\\frac{r^2}{4\\mu} \\frac{dP}{dz} $$\nSubstituting the constants back into the velocity equation yields the parabolic velocity profile:\n$$ v_z(R) = \\frac{1}{4\\mu} \\frac{dP}{dz} (R^2 - r^2) $$\nSince we expect pressure to decrease along the direction of flow, the pressure gradient $\\frac{dP}{dz}$ is negative. For a pipe of length $L$ with a total pressure drop $\\Delta P = P_{in} - P_{out}$, we can approximate the constant pressure gradient as $\\frac{dP}{dz} = -\\frac{\\Delta P}{L}$. Substituting this gives:\n$$ v_z(R) = \\frac{\\Delta P}{4\\mu L} (r^2 - R^2) $$\nThe volumetric flow rate $Q$ is found by integrating this velocity profile over the circular cross-section, which has a differential area element $dA = 2\\pi R dR$:\n$$ Q = \\int_0^r v_z(R) (2\\pi R) dR = \\int_0^r \\frac{\\Delta P}{4\\mu L} (r^2 - R^2) (2\\pi R) dR $$\n$$ Q = \\frac{2\\pi \\Delta P}{4\\mu L} \\int_0^r (r^2 R - R^3) dR = \\frac{\\pi \\Delta P}{2\\mu L} \\left[ \\frac{r^2 R^2}{2} - \\frac{R^4}{4} \\right]_0^r $$\n$$ Q = \\frac{\\pi \\Delta P}{2\\mu L} \\left( \\frac{r^4}{2} - \\frac{r^4}{4} \\right) = \\frac{\\pi \\Delta P}{2\\mu L} \\left( \\frac{r^4}{4} \\right) $$\nThis yields the Hagen-Poiseuille equation:\n$$ Q = \\frac{\\pi r^4}{8\\mu L} \\Delta P $$\nThe problem asks for the relationship connecting the pressure drop $\\Delta P$ to the flow $Q$. Solving for $\\Delta P$, we find:\n$$ \\Delta P = \\frac{8\\mu L Q}{\\pi r^4} $$\nThis completes the derivation.\n\nNext, we compute the value of $\\Delta P$. All given quantities must be converted to coherent SI units (meters, kilograms, seconds).\n-   $r = 4\\ \\text{mm} = 4 \\times 10^{-3}\\ \\text{m}$\n-   $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n-   $L = 30\\ \\text{cm} = 0.30\\ \\text{m}$\n-   $Q = 6\\ \\text{ml/s} = 6\\ \\text{cm}^3/\\text{s} = 6 \\times (10^{-2}\\ \\text{m})^3/\\text{s} = 6 \\times 10^{-6}\\ \\text{m}^3/\\text{s}$\n\nBefore calculating, we verify the \"laminar flow\" assumption is consistent. This requires calculating the Reynolds number, $Re = \\frac{\\rho v_m D}{\\mu}$, where $v_m$ is the mean velocity, $D$ is the diameter, and $\\rho$ is the fluid density. The density of blood is not provided, so we assume a standard physiological value of $\\rho \\approx 1060\\ \\text{kg}/\\text{m}^3$. The mean velocity is $v_m = \\frac{Q}{A} = \\frac{Q}{\\pi r^2}$ and the diameter is $D=2r$.\n$$ Re = \\frac{\\rho (\\frac{Q}{\\pi r^2}) (2r)}{\\mu} = \\frac{2\\rho Q}{\\pi r \\mu} $$\n$$ Re = \\frac{2(1060)(6 \\times 10^{-6})}{\\pi (4 \\times 10^{-3})(3.5 \\times 10^{-3})} \\approx \\frac{1.272 \\times 10^{-2}}{4.398 \\times 10^{-5}} \\approx 289 $$\nSince $Re \\approx 289$ is well below the typical critical value for transition to turbulence in a pipe ($Re_{crit} \\approx 2300$), the initial assumption of laminar flow is valid.\n\nNow, we substitute the SI values into the derived pressure drop equation:\n$$ \\Delta P = \\frac{8(3.5 \\times 10^{-3})(0.30)(6 \\times 10^{-6})}{\\pi (4 \\times 10^{-3})^4} $$\n$$ \\Delta P = \\frac{5.04 \\times 10^{-8}}{\\pi (256 \\times 10^{-12})} = \\frac{5.04 \\times 10^{-8}}{8.0425 \\times 10^{-10}} \\approx 62.669\\ \\text{Pa} $$\nThe question requires the answer in millimeters of mercury (mmHg). The standard conversion is $1\\ \\text{atm} = 760\\ \\text{mmHg} = 101325\\ \\text{Pa}$. Thus, $1\\ \\text{mmHg} \\approx 133.322\\ \\text{Pa}$.\n$$ \\Delta P_{\\text{mmHg}} = \\frac{\\Delta P_{\\text{Pa}}}{133.322\\ \\text{Pa/mmHg}} = \\frac{62.669}{133.322} \\approx 0.4700\\ \\text{mmHg} $$\nRounding to three significant figures, the pressure drop is $0.470\\ \\text{mmHg}$.\n\nFinally, a brief physiological interpretation is required. Normal intracranial pressure (ICP) is typically below $15\\ \\text{mmHg}$. The dural venous sinuses are the main conduits for draining venous blood from the brain, and the pressure within them is a key determinant of ICP. A calculated pressure drop of $\\Delta P \\approx 0.470\\ \\text{mmHg}$ over a significant length of $30\\ \\text{cm}$ is a very small gradient. This result quantitatively demonstrates that the large-diameter dural sinuses function as extremely low-resistance pathways. This low resistance is crucial for ensuring efficient cerebral venous drainage with minimal back pressure, which helps maintain a low and stable intracranial pressure, essential for normal brain function.",
            "answer": "$$\n\\boxed{0.470}\n$$"
        },
        {
            "introduction": "Building upon the single-vessel model, we now consider how flow is distributed within a simple network. Anatomical asymmetry in the transverse sinuses is common, and this practice challenges you to predict its hemodynamic consequences by modeling the sinuses as a parallel circuit . This exercise powerfully illustrates how the hydraulic conductance, which scales with the fourth power of the radius ($G \\propto r^4$), dictates the preferential pathways for venous drainage and highlights the profound impact of anatomical variations.",
            "id": "4467245",
            "problem": "A patient with asymmetric transverse dural sinuses exhibits radii measured by high-resolution venography: right transverse sinus radius $r_{R} = 5\\ \\text{mm}$ and left transverse sinus radius $r_{L} = 3\\ \\text{mm}$. Assume that each sinus segment between the torcular herophili and the sigmoid junction behaves as a rigid cylindrical conduit with laminar flow of a Newtonian fluid, that both segments have equal length $L$ and experience the same pressure drop $\\Delta P$, and that the dynamic viscosity $\\mu$ is uniform. Using the definition of hydraulic conductance $G$ as the proportionality factor between volumetric flow $Q$ and pressure drop $\\Delta P$, and the well-established Hagen–Poiseuille relation as the fundamental base, derive the relative conductances of the right and left transverse sinuses. Then, model the sinuses as two parallel pathways receiving a total volumetric flow $Q_{\\text{total}} = 10\\ \\text{ml/s}$ from the superior sagittal and straight sinus confluence, and predict the split of flow $Q_{R}$ and $Q_{L}$ through the right and left pathways, respectively. Express both flow rates as exact rational numbers in milliliters per second. No rounding is required. Provide your final numerical values for $Q_{R}$ and $Q_{L}$.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n-   Right transverse sinus radius: $r_{R} = 5\\ \\text{mm}$\n-   Left transverse sinus radius: $r_{L} = 3\\ \\text{mm}$\n-   Assumption: Sinus segments are rigid cylindrical conduits.\n-   Assumption: Flow is laminar.\n-   Assumption: The fluid (blood) is Newtonian.\n-   Assumption: Both sinus segments have equal length, $L$.\n-   Assumption: Both segments experience the same pressure drop, $\\Delta P$.\n-   Assumption: The dynamic viscosity, $\\mu$, is uniform.\n-   Definition: Hydraulic conductance $G$ is defined by $Q = G \\Delta P$, where $Q$ is the volumetric flow rate.\n-   Fundamental model: The Hagen–Poiseuille relation.\n-   Total volumetric flow from the confluence: $Q_{\\text{total}} = 10\\ \\text{ml/s}$.\n-   Model: The two sinuses are treated as parallel pathways.\n-   Objective: Derive the relative conductances, and predict the flow rates $Q_{R}$ and $Q_{L}$.\n-   Required output format: Express $Q_{R}$ and $Q_{L}$ as exact rational numbers in ml/s.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the Hagen–Poiseuille equation, a cornerstone of fluid dynamics. The assumptions of laminar flow and Newtonian fluid behavior for blood in large vessels like dural sinuses, while simplifications, are standard and acceptable for first-order biophysical modeling. The anatomical premise of asymmetric transverse sinuses and the given physical values ($r_R, r_L, Q_{\\text{total}}$) are physiologically plausible.\n-   **Well-Posed**: The problem is clearly defined and self-contained. It provides all necessary parameters and a well-defined physical model (parallel hydraulic circuit) to permit the calculation of a unique, stable solution for the flow split.\n-   **Objective**: The problem is stated in precise, unbiased scientific language.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. It is scientifically grounded, well-posed, and objective. It does not violate any of the specified invalidity criteria. We may proceed to the solution.\n\nThe solution begins with the Hagen–Poiseuille equation, which describes the volumetric flow rate $Q$ of a Newtonian fluid in laminar flow through a rigid cylindrical pipe of length $L$ and radius $r$, driven by a pressure drop $\\Delta P$:\n$$Q = \\frac{\\pi r^4}{8 \\mu L} \\Delta P$$\nwhere $\\mu$ is the dynamic viscosity of the fluid.\n\nThe problem defines hydraulic conductance $G$ as the proportionality constant in the relationship $Q = G \\Delta P$. By comparing this definition with the Hagen–Poiseuille equation, we can express the conductance as:\n$$G = \\frac{\\pi r^4}{8 \\mu L}$$\nThis equation shows that conductance is highly dependent on the radius of the conduit, varying with the fourth power of the radius.\n\nWe can now write the specific conductances for the right ($G_R$) and left ($G_L$) transverse sinuses:\n$$G_R = \\frac{\\pi r_{R}^4}{8 \\mu L}$$\n$$G_L = \\frac{\\pi r_{L}^4}{8 \\mu L}$$\nThe problem asks for the relative conductances. This is most directly expressed as the ratio of $G_R$ to $G_L$:\n$$\\frac{G_R}{G_L} = \\frac{\\frac{\\pi r_{R}^4}{8 \\mu L}}{\\frac{\\pi r_{L}^4}{8 \\mu L}} = \\left(\\frac{r_R}{r_L}\\right)^4$$\nThe common factors $\\pi$, $8$, $\\mu$, and $L$ cancel, as these parameters are assumed to be identical for both sinuses.\n\nNext, we model the sinuses as two hydraulic pathways in parallel. For parallel circuits, two principles apply:\n$1$. The total flow is the sum of the individual flows:\n$$Q_{\\text{total}} = Q_R + Q_L$$\n$2$. The pressure drop across each parallel branch is identical. This is consistent with the problem's initial assumption of a common $\\Delta P$.\n$$Q_R = G_R \\Delta P$$\n$$Q_L = G_L \\Delta P$$\n\nFrom these relationships, we can find the ratio of the flows:\n$$\\frac{Q_R}{Q_L} = \\frac{G_R \\Delta P}{G_L \\Delta P} = \\frac{G_R}{G_L}$$\nSubstituting our derived expression for the conductance ratio:\n$$\\frac{Q_R}{Q_L} = \\left(\\frac{r_R}{r_L}\\right)^4$$\nThis shows that the total flow will split between the two sinuses in proportion to the fourth power of their respective radii.\n\nWe have a system of two equations with two unknowns, $Q_R$ and $Q_L$:\n$$Q_R + Q_L = Q_{\\text{total}}$$\n$$Q_R = Q_L \\left(\\frac{r_R}{r_L}\\right)^4$$\nSubstitute the second equation into the first:\n$$Q_L \\left(\\frac{r_R}{r_L}\\right)^4 + Q_L = Q_{\\text{total}}$$\n$$Q_L \\left(1 + \\left(\\frac{r_R}{r_L}\\right)^4\\right) = Q_{\\text{total}}$$\nSolving for $Q_L$:\n$$Q_L = Q_{\\text{total}} \\frac{1}{1 + \\frac{r_R^4}{r_L^4}} = Q_{\\text{total}} \\frac{r_L^4}{r_L^4 + r_R^4}$$\nSimilarly, we can solve for $Q_R$:\n$$Q_R = Q_{\\text{total}} \\frac{r_R^4}{r_L^4 + r_R^4}$$\nThese expressions partition the total flow according to the contribution of each channel's conductance ($r^4$) to the total conductance ($r_R^4 + r_L^4$).\n\nNow, we substitute the given numerical values:\n$r_R = 5\\ \\text{mm}$\n$r_L = 3\\ \\text{mm}$\n$Q_{\\text{total}} = 10\\ \\text{ml/s}$\n\nFirst, we calculate the fourth powers of the radii. The units are not required in the ratio.\n$$r_R^4 = 5^4 = 625$$\n$$r_L^4 = 3^4 = 81$$\nThe sum of these values is:\n$$r_R^4 + r_L^4 = 625 + 81 = 706$$\nNow we can calculate the flow rates $Q_R$ and $Q_L$:\n$$Q_R = (10\\ \\text{ml/s}) \\times \\frac{625}{706} = \\frac{6250}{706}\\ \\text{ml/s}$$\n$$Q_L = (10\\ \\text{ml/s}) \\times \\frac{81}{706} = \\frac{810}{706}\\ \\text{ml/s}$$\nThe problem requires the answers as exact rational numbers. We simplify the fractions by dividing the numerator and denominator by their greatest common divisor, which is $2$.\n$$Q_R = \\frac{6250 \\div 2}{706 \\div 2} = \\frac{3125}{353}\\ \\text{ml/s}$$\n$$Q_L = \\frac{810 \\div 2}{706 \\div 2} = \\frac{405}{353}\\ \\text{ml/s}$$\nAs a check, we can sum the flows:\n$$Q_R + Q_L = \\frac{3125}{353} + \\frac{405}{353} = \\frac{3125 + 405}{353} = \\frac{3530}{353} = 10$$\nThe sum correctly equals the total flow rate $Q_{\\text{total}} = 10\\ \\text{ml/s}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3125}{353} & \\frac{405}{353} \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice integrates the preceding concepts into a comprehensive computational model of the dural venous sinus network. By representing the system as a resistive circuit, you will use linear algebra to solve for pressures and flows throughout the network under various simulated conditions . This advanced exercise introduces a powerful method for systems-level analysis, enabling the identification of hemodynamic bottlenecks and providing a framework to investigate the effects of pathologies like venous stenosis or outflow obstruction.",
            "id": "4467211",
            "problem": "Construct a program to model a simplified hemodynamic network of the dural venous sinuses, using a resistive network abstraction grounded in laminar flow through rigid tubes. In this model, each edge represents a venous sinus segment with a given hydraulic conductance in milliliters per second per millimeter of mercury ($\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$), and each node represents a junction with a scalar pressure in millimeters of mercury ($\\mathrm{mmHg}$). Edge flows follow a linear constitutive relation derived from Poiseuille’s law, conservation of mass holds at every internal node, and some nodes have prescribed pressures (Dirichlet boundary conditions) representing sources and sinks. Your task is to compute edge flows and identify bottleneck segments according to a principled, quantitative criterion.\n\nFundamental base and assumptions:\n- Flow along an edge between nodes $i$ and $j$ is given by $Q_{ij} = G_{ij}\\,(P_i - P_j)$, where $Q_{ij}$ is in $\\mathrm{mL}/\\mathrm{s}$, $G_{ij}$ is the edge conductance in $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$, and $P_i, P_j$ are pressures in $\\mathrm{mmHg}$. This is the linear resistive form of Poiseuille’s law under steady, laminar conditions.\n- Conservation of mass at every internal node $k$ imposes $\\sum_{m \\in \\mathcal{N}(k)} G_{km}\\,(P_k - P_m) = 0$, where $\\mathcal{N}(k)$ denotes the neighbors of node $k$ in the network.\n- Dirichlet boundary condition nodes have prescribed pressures and are not solved for; all other node pressures are determined by solving the resulting linear system.\n\nNetwork definition (nodes and edges):\n- Nodes (with indices and anatomical labels): $0$ (superior sagittal sinus inlet), $1$ (straight sinus inlet), $2$ (confluence of sinuses, torcular Herophili), $3$ (left transverse sinus), $4$ (right transverse sinus), $5$ (left sigmoid sinus), $6$ (right sigmoid sinus), $7$ (left internal jugular bulb), $8$ (right internal jugular bulb).\n- Edges (with indices, direction for sign convention, and anatomical labels): \n  - $0$: $(0 \\rightarrow 2)$ superior sagittal sinus to confluence,\n  - $1$: $(1 \\rightarrow 2)$ straight sinus to confluence,\n  - $2$: $(2 \\rightarrow 3)$ confluence to left transverse sinus,\n  - $3$: $(2 \\rightarrow 4)$ confluence to right transverse sinus,\n  - $4$: $(3 \\rightarrow 5)$ left transverse to left sigmoid sinus,\n  - $5$: $(4 \\rightarrow 6)$ right transverse to right sigmoid sinus,\n  - $6$: $(5 \\rightarrow 7)$ left sigmoid sinus to left internal jugular bulb,\n  - $7$: $(6 \\rightarrow 8)$ right sigmoid sinus to right internal jugular bulb.\n\nBoundary conditions:\n- Prescribed (Dirichlet) node pressures: nodes $0$, $1$, $7$, and $8$ have specified pressures $P_0$, $P_1$, $P_7$, and $P_8$ in $\\mathrm{mmHg}$. All other nodes’ pressures are unknown and must be solved.\n\nFlow computation and sign convention:\n- For each edge $e = (i \\rightarrow j)$ with conductance $G_e$, compute $Q_e = G_e\\,(P_i - P_j)$ in $\\mathrm{mL}/\\mathrm{s}$. Positive $Q_e$ indicates flow in the listed edge direction; negative $Q_e$ indicates net flow opposite to the listed edge direction.\n\nBottleneck criterion:\n- Define the power dissipation on an edge as $D_e = Q_e^2 / G_e$, derived from $D_e = Q_e\\,\\Delta P_e$ with $\\Delta P_e = Q_e/G_e$. Let the total dissipation be $D_{\\mathrm{tot}} = \\sum_e D_e$. Define the dissipation share $S_e = D_e / D_{\\mathrm{tot}}$ when $D_{\\mathrm{tot}} > 0$ and $S_e = 0$ otherwise. For a fixed threshold $\\tau = 0.3$, declare an edge a bottleneck if $S_e \\ge \\tau$.\n\nUnits:\n- Pressures must be in $\\mathrm{mmHg}$.\n- Conductances must be in $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$.\n- Flows must be reported in $\\mathrm{mL}/\\mathrm{s}$.\n- Express flows rounded to six decimal places (numerically rounded; do not include units in the numeric outputs).\n\nAngle units do not apply. If any ratio is needed, express it as a decimal number (no percentage signs).\n\nTest suite:\nUse the following four test cases. Each test case provides:\n- A vector of edge conductances $\\mathbf{G} = [G_0,G_1,G_2,G_3,G_4,G_5,G_6,G_7]$ in $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$.\n- Prescribed pressures at nodes $0$, $1$, $7$, $8$ in $\\mathrm{mmHg}$.\n- The threshold is fixed at $\\tau = 0.3$ for all cases.\n\nCase A (baseline with hypoplastic left transverse sinus):\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.15,\\,0.6,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\nCase B (symmetric transverse outflow):\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.6,\\,0.6,\\,0.6,\\,0.6,\\,0.6,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\nCase C (elevated right jugular pressure):\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.4,\\,0.6,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 8$\n\nCase D (right transverse stenosis):\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.6,\\,0.02,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\nRequired final output format:\n- For each test case, output a list containing two elements: \n  - the list of edge flows $[Q_0,Q_1,\\dots,Q_7]$ in $\\mathrm{mL}/\\mathrm{s}$, each numerically rounded to six decimal places, following the edge order defined above,\n  - the list of bottleneck edge indices (integers) satisfying $S_e \\ge \\tau$, sorted in ascending order.\n- Aggregate the four per-case results into a single list and print exactly one line containing this aggregate, formatted as a single bracketed, comma-separated list. For example: \n  - $[\\,[\\,[q\\_0,\\dots,q\\_7],\\,[i\\_1,i\\_2,\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,]\\,]$",
            "solution": "The problem requires the analysis of a simplified hemodynamic network representing the dural venous sinuses. The network is modeled as a linear resistive circuit, where blood flow is analogous to electric current, pressure difference to voltage, and hydraulic conductance to electrical conductance. The primary task is to determine the pressures at internal junctions (nodes), calculate the flow rate through each vessel segment (edge), and identify bottleneck segments based on a power dissipation criterion.\n\nThe analysis proceeds in two main stages: first, solving for the unknown node pressures by establishing and solving a system of linear equations derived from the principle of mass conservation; second, using the complete set of node pressures to compute edge flows and evaluate the bottleneck criterion.\n\nFirst, we formulate the linear system for the unknown pressures. The network has $9$ nodes, indexed $0$ through $8$. The pressures at nodes $0$, $1$, $7$, and $8$ are prescribed as Dirichlet boundary conditions ($P_0$, $P_1$, $P_7$, $P_8$). The pressures at the remaining $5$ internal nodes ($P_2, P_3, P_4, P_5, P_6$) are the unknowns to be determined.\n\nThe governing principle is the conservation of mass at steady state for an incompressible fluid, which dictates that the sum of flows into any internal node must be zero. The flow $Q_{ij}$ from node $i$ to node $j$ is given by the linear constitutive relation $Q_{ij} = G_{ij}\\,(P_i - P_j)$, where $G_{ij}$ is the hydraulic conductance. The conservation law at an internal node $k$ is therefore $\\sum_{m \\in \\mathcal{N}(k)} Q_{km} = 0$, which can be written in terms of pressures as:\n$$\n\\sum_{m \\in \\mathcal{N}(k)} G_{km}\\,(P_k - P_m) = 0\n$$\nwhere $\\mathcal{N}(k)$ is the set of neighbors of node $k$. Applying this to each of the $5$ internal nodes yields a system of $5$ linear equations. The edge conductances are given by the vector $\\mathbf{G} = [G_0, G_1, \\dots, G_7]$. The connectivities are: $G_0=G_{02}$, $G_1=G_{12}$, $G_2=G_{23}$, $G_3=G_{24}$, $G_4=G_{35}$, $G_5=G_{46}$, $G_6=G_{57}$, $G_7=G_{68}$.\n\nThe equations for the internal nodes are:\n1.  Node $2$ (Confluence): Neighbors are $0, 1, 3, 4$.\n    $G_{20}(P_2 - P_0) + G_{21}(P_2 - P_1) + G_{23}(P_2 - P_3) + G_{24}(P_2 - P_4) = 0$\n    Using the edge conductance indices: $G_0(P_2 - P_0) + G_1(P_2 - P_1) + G_2(P_2 - P_3) + G_3(P_2 - P_4) = 0$\n2.  Node $3$ (Left Transverse): Neighbors are $2, 5$.\n    $G_{32}(P_3 - P_2) + G_{35}(P_3 - P_5) = 0 \\implies G_2(P_3 - P_2) + G_4(P_3 - P_5) = 0$\n3.  Node $4$ (Right Transverse): Neighbors are $2, 6$.\n    $G_{42}(P_4 - P_2) + G_{46}(P_4 - P_6) = 0 \\implies G_3(P_4 - P_2) + G_5(P_4 - P_6) = 0$\n4.  Node $5$ (Left Sigmoid): Neighbors are $3, 7$.\n    $G_{53}(P_5 - P_3) + G_{57}(P_5 - P_7) = 0 \\implies G_4(P_5 - P_3) + G_6(P_5 - P_7) = 0$\n5.  Node $6$ (Right Sigmoid): Neighbors are $4, 8$.\n    $G_{64}(P_6 - P_4) + G_{68}(P_6 - P_8) = 0 \\implies G_5(P_6 - P_4) + G_7(P_6 - P_8) = 0$\n\nLet the vector of unknown pressures be $\\mathbf{p} = [P_2, P_3, P_4, P_5, P_6]^T$. We can rearrange the above equations into the matrix form $\\mathbf{A} \\mathbf{p} = \\mathbf{b}$:\n$$\n\\begin{pmatrix}\nG_0+G_1+G_2+G_3 & -G_2 & -G_3 & 0 & 0 \\\\\n-G_2 & G_2+G_4 & 0 & -G_4 & 0 \\\\\n-G_3 & 0 & G_3+G_5 & 0 & -G_5 \\\\\n0 & -G_4 & 0 & G_4+G_6 & 0 \\\\\n0 & 0 & -G_5 & 0 & G_5+G_7\n\\end{pmatrix}\n\\begin{pmatrix} P_2 \\\\ P_3 \\\\ P_4 \\\\ P_5 \\\\ P_6 \\end{pmatrix}\n=\n\\begin{pmatrix}\nG_0 P_0 + G_1 P_1 \\\\\n0 \\\\\n0 \\\\\nG_6 P_7 \\\\\nG_7 P_8\n\\end{pmatrix}\n$$\nThis system is solved for $\\mathbf{p}$ using a standard linear algebra solver. The resulting pressures, combined with the boundary values, give the complete pressure field across the network.\n\nWith all node pressures determined, the flow $Q_k$ through each edge $k=(i \\to j)$ is calculated using $Q_k = G_k (P_i - P_j)$. The edge directions are specified in the problem statement:\n- $Q_0 = G_0 (P_0 - P_2)$\n- $Q_1 = G_1 (P_1 - P_2)$\n- $Q_2 = G_2 (P_2 - P_3)$\n- $Q_3 = G_3 (P_2 - P_4)$\n- $Q_4 = G_4 (P_3 - P_5)$\n- $Q_5 = G_5 (P_4 - P_6)$\n- $Q_6 = G_6 (P_5 - P_7)$\n- $Q_7 = G_7 (P_6 - P_8)$\n\nFinally, we identify bottleneck segments. The power dissipated by viscous forces in an edge $k$ is $D_k = Q_k \\Delta P_k = Q_k (Q_k/G_k) = Q_k^2 / G_k$. If $G_k=0$, no flow can pass, so $Q_k=0$ and the dissipation $D_k=0$. The total dissipation in the network is $D_{\\mathrm{tot}} = \\sum_k D_k$. The dissipation share for each edge is $S_k = D_k / D_{\\mathrm{tot}}$ (defined as $0$ if $D_{\\mathrm{tot}}=0$). An edge $k$ is classified as a bottleneck if its dissipation share $S_k$ meets or exceeds a given threshold $\\tau=0.3$.\n\nThe algorithm for each test case is as follows:\n1.  Construct the $5 \\times 5$ matrix $\\mathbf{A}$ and the $5 \\times 1$ vector $\\mathbf{b}$ from the given conductances $\\mathbf{G}$ and boundary pressures $P_0, P_1, P_7, P_8$.\n2.  Solve the linear system $\\mathbf{A} \\mathbf{p} = \\mathbf{b}$ to find the internal pressures $P_2, \\dots, P_6$.\n3.  Compute the flow rates $Q_0, \\dots, Q_7$ using the full set of node pressures.\n4.  Calculate the dissipation $D_k$ for each edge, the total dissipation $D_{\\mathrm{tot}}$, and the dissipation shares $S_k$.\n5.  Identify the indices of all edges for which $S_k \\ge 0.3$.\n6.  The flows are numerically rounded to six decimal places, and the list of bottleneck indices is sorted. The results are formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for flows and bottlenecks in a dural venous sinus network model.\n    \"\"\"\n    \n    test_cases = [\n        # Case A (baseline with hypoplastic left transverse sinus)\n        {\n            \"G\": [0.8, 0.7, 0.15, 0.6, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        },\n        # Case B (symmetric transverse outflow)\n        {\n            \"G\": [0.8, 0.7, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        },\n        # Case C (elevated right jugular pressure)\n        {\n            \"G\": [0.8, 0.7, 0.4, 0.6, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 8},\n            \"tau\": 0.3\n        },\n        # Case D (right transverse stenosis)\n        {\n            \"G\": [0.8, 0.7, 0.6, 0.02, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        }\n    ]\n\n    # Node indices: 0..8\n    # Edge indices: 0..7\n    # Unknown pressure vector p_sol corresponds to [P2, P3, P4, P5, P6]\n    \n    # Edge definitions: (from_node, to_node) for calculating flows\n    # Q_k = G_k * (P_from - P_to)\n    edge_node_map = [\n        (0, 2),  # Edge 0: SSS to Confluence\n        (1, 2),  # Edge 1: Straight Sinus to Confluence\n        (2, 3),  # Edge 2: Confluence to L. Transverse\n        (2, 4),  # Edge 3: Confluence to R. Transverse\n        (3, 5),  # Edge 4: L. Transverse to L. Sigmoid\n        (4, 6),  # Edge 5: R. Transverse to R. Sigmoid\n        (5, 7),  # Edge 6: L. Sigmoid to L. Jugular\n        (6, 8)   # Edge 7: R. Sigmoid to R. Jugular\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        G = case[\"G\"]\n        P_bc = case[\"P_bc\"]\n        tau = case[\"tau\"]\n\n        # Assemble the linear system Ap = b\n        # p = [P2, P3, P4, P5, P6]\n        A = np.zeros((5, 5))\n        b = np.zeros(5)\n\n        # Equation for Node 2\n        A[0, 0] = G[0] + G[1] + G[2] + G[3]\n        A[0, 1] = -G[2]\n        A[0, 2] = -G[3]\n        b[0] = G[0] * P_bc[\"P0\"] + G[1] * P_bc[\"P1\"]\n\n        # Equation for Node 3\n        A[1, 0] = -G[2]\n        A[1, 1] = G[2] + G[4]\n        A[1, 3] = -G[4]\n        # b[1] is 0\n\n        # Equation for Node 4\n        A[2, 0] = -G[3]\n        A[2, 2] = G[3] + G[5]\n        A[2, 4] = -G[5]\n        # b[2] is 0\n\n        # Equation for Node 5\n        A[3, 1] = -G[4]\n        A[3, 3] = G[4] + G[6]\n        b[3] = G[6] * P_bc[\"P7\"]\n\n        # Equation for Node 6\n        A[4, 2] = -G[5]\n        A[4, 4] = G[5] + G[7]\n        b[4] = G[7] * P_bc[\"P8\"]\n        \n        # Solve for unknown pressures\n        p_sol = np.linalg.solve(A, b)\n\n        # Reconstruct the full pressure vector [P0, P1, ..., P8]\n        P_full = np.zeros(9)\n        P_full[0] = P_bc[\"P0\"]\n        P_full[1] = P_bc[\"P1\"]\n        P_full[2:7] = p_sol\n        P_full[7] = P_bc[\"P7\"]\n        P_full[8] = P_bc[\"P8\"]\n        \n        # Calculate edge flows\n        Q = np.zeros(8)\n        for i in range(8):\n            n_from, n_to = edge_node_map[i]\n            Q[i] = G[i] * (P_full[n_from] - P_full[n_to])\n\n        # Calculate power dissipation and identify bottlenecks\n        D = np.zeros(8)\n        for i in range(8):\n            if G[i] > 1e-9:  # Avoid division by zero\n                D[i] = Q[i]**2 / G[i]\n            else:\n                D[i] = 0.0\n        \n        D_tot = np.sum(D)\n        \n        bottleneck_indices = []\n        if D_tot > 1e-9:\n            S = D / D_tot\n            for i in range(8):\n                if S[i] >= tau:\n                    bottleneck_indices.append(i)\n        \n        # Format results for this case\n        rounded_flows = [round(flow, 6) for flow in Q]\n        case_result = [rounded_flows, sorted(bottleneck_indices)]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(all_results)\n\nsolve()\n```"
        }
    ]
}