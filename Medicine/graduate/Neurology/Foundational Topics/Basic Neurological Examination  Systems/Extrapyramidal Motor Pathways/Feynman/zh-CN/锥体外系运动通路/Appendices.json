{
    "hands_on_practices": [
        {
            "introduction": "要深入理解锥体外系通路，第一步是掌握其核心的电路逻辑。这个练习将指导你使用一个简化的符号模型来追踪直接通路中的信号流，从而揭示其促进运动的基本功能。通过这个练习，你将亲手验证基底节神经环路中至关重要的“去抑制”（disinhibition）原理，为后续更复杂的定量分析打下基础。",
            "id": "4480419",
            "problem": "哺乳动物大脑中一个典型的基底节-丘脑皮层回路包括沿所谓直接通路的以下单突触连接：从表达多巴胺D1受体的纹状体中型多棘神经元到苍白球内侧段和黑质网状部（共同表示为 $\\mathrm{GPi/SNr}$），从 $\\mathrm{GPi/SNr}$ 到丘脑腹侧中继神经元，以及从丘脑腹侧中继神经元到新皮层锥体神经元。假设以下已确立的生理学事实为您的基本依据：$\\mathrm{GABA}$介导的突触是抑制性的，会相对于基线水平降低突触后放电率，而谷氨酸介导的突触是兴奋性的，会相对于基线水平增加突触后放电率。进一步假设围绕一个稳态进行小信号线性化，从而一个串联突触链对一个输出变量的净效应符号由链中抑制性和兴奋性步骤的奇偶性决定。定义符号约定，使得一个抑制性突触贡献一个因子 $-1$，一个兴奋性突触贡献一个因子 $+1$。\n\n仅使用这些假设，考虑表达D1受体的纹状体中型多棘神经元放电率的微小持续增加。通过遍历直接通路，计算其对丘脑皮层驱动的效应的净符号，此处丘脑皮层驱动定义为从丘脑腹侧中继神经元到皮层的兴奋性输出。将直接通路视为由恰好 $3$ 个序贯突触组成：D1纹状体中型多棘神经元到 $\\mathrm{GPi/SNr}$，$\\mathrm{GPi/SNr}$ 到丘脑，以及丘脑到皮层。使用上述符号约定，并以 $+1$ 表示净兴奋性效应，$-1$ 表示净抑制性效应的形式提供您的最终结果。无需四舍五入；结果是无量纲的。",
            "solution": "首先对问题的科学合理性、一致性和完整性进行验证。\n\n**步骤1：提取已知条件**\n- **回路通路（直接通路）：** 一系列 $3$ 个单突触连接：\n    1. 表达多巴胺D1受体的纹状体中型多棘神经元（D1-MSNs）到苍白球内侧段和黑质网状部（$\\mathrm{GPi/SNr}$）。\n    2. $\\mathrm{GPi/SNr}$ 到丘脑腹侧中继神经元。\n    3. 丘脑腹侧中继神经元到新皮层锥体神经元。\n- **生理学规则：**\n    1. $\\mathrm{GABA}$介导的突触是抑制性的。\n    2. 谷氨酸介导的突触是兴奋性的。\n- **建模假设：**\n    1. 该系统可使用围绕稳态的小信号线性化进行分析。\n    2. 串联突触链的净符号由抑制性和兴奋性步骤的奇偶性决定。\n- **符号约定：**\n    1. 一个抑制性突触贡献一个乘法因子 $-1$。\n    2. 一个兴奋性突触贡献一个乘法因子 $+1$。\n- **输入扰动：** D1-MSNs放电率的微小持续增加。\n- **关注的输出：** 对丘脑皮层驱动的净效应，定义为从丘脑腹侧中继神经元到皮层的兴奋性输出。\n- **要求输出：** 净兴奋性效应的最终结果为 $+1$，或净抑制性效应的最终结果为 $-1$。\n\n**步骤2：问题验证**\n该问题描述了基底节的典型“直接通路”，这是运动控制和决策中的一个基本回路。根据标准神经科学文献，所列出的组件和连接是正确的。关于$\\mathrm{GABA}$（抑制性）和谷氨酸（兴奋性）的生理学规则是神经生理学的基石。线性化和符号乘法的建模假设是系统神经科学中用于定性分析网络动态的标准且有效的简化方法。该问题是自洽的，因为它依赖于“已确立的生理学事实”，这在专业STEM领域的背景下，意味着使用典型的教科书知识。该问题是适定的、客观的且有科学依据的。它没有违反任何无效性标准。因此，该问题被认为是有效的。\n\n**步骤3：求解推导**\n该问题要求计算D1-MSN活动增加对最终皮层输出效应的净符号。这通过确定链中 $3$ 个突触中每一个的符号并将它们相乘来实现。每个突触的符号由其主要神经递质决定。这需要应用关于指定回路的标准神经解剖学知识。\n\n设 $S_1$、$S_2$ 和 $S_3$ 是三个序贯突触的符号。净符号 $S_{\\text{net}}$ 由以下乘积给出：\n$$S_{\\text{net}} = S_1 \\times S_2 \\times S_3$$\n\n1.  **突触1：纹状体 (D1-MSN) $\\rightarrow$ $\\mathrm{GPi/SNr}$**\n    纹状体的投射神经元，即中型多棘神经元（MSNs），是$\\mathrm{GABA}$能的。问题陈述指出，$\\mathrm{GABA}$介导的突触是抑制性的。根据给定的符号约定，一个抑制性突触贡献一个因子 $-1$。\n    $$S_1 = -1$$\n\n2.  **突触2：$\\mathrm{GPi/SNr}$ $\\rightarrow$ 丘脑**\n    $\\mathrm{GPi/SNr}$ 的投射神经元也是$\\mathrm{GABA}$能的，它们构成了基底节的主要输出核。因此，它们到丘脑的投射是抑制性的。\n    $$S_2 = -1$$\n\n3.  **突触3：丘脑 $\\rightarrow$ 皮层**\n    投射到新皮层的丘脑腹侧中继神经元是谷氨酸能的。问题陈述指出，谷氨酸介导的突触是兴奋性的。该问题还将“丘脑皮层驱动”定义为这个特定的兴奋性输出。\n    $$S_3 = +1$$\n\n现在，我们通过将通路中各个突触的符号相乘来计算效应的净符号。\n$$S_{\\text{net}} = S_1 \\times S_2 \\times S_3 = (-1) \\times (-1) \\times (+1)$$\n$$S_{\\text{net}} = (+1) \\times (+1) = +1$$\n\n结果符号为 $+1$，表示净兴奋性效应。这一结果与直接通路的已知功能一致，即促进运动输出或动作选择。D1-MSNs活动的增加导致对持续活动的抑制性$\\mathrm{GPi/SNr}$神经元的抑制。这会去抑制丘脑（即增加其活动），进而兴奋皮层。这个效应链可以概括为序列：增加 $\\rightarrow$ 抑制 $\\rightarrow$ 去抑制（兴奋） $\\rightarrow$ 兴奋。因此，总体效应是兴奋性的。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在掌握了定性的电路逻辑后，我们进一步将这些概念定量化，以理解其生理意义。这个练习构建了一个计算模型，模拟了苍白球切开术（pallidotomy）如何通过降低基底节的抑制性输出来影响丘脑神经元的活动。通过计算丘脑神经元放电概率的具体变化，你将把抽象的环路知识与可测量的生理效应联系起来。",
            "id": "4480378",
            "problem": "在基底神经节-丘脑-皮层环路中，苍白球内侧段（GPi）通过γ-氨基丁酸（GABA）突触对丘脑中继神经元施加持续性抑制控制。考虑一个在固定的短观察窗内接收两类输入的单个丘脑中继神经元：一类是稳定的皮层兴奋性驱动，另一类是来自GPi神经元的大量抑制性突触事件，这些神经元的脉冲发放近似服从泊松分布。使用以下基于标准系统神经科学的基本建模假设：\n\n1. 在稳态条件下，对于足够大量的突触，从GPi到丘脑神经元的平均抑制性电导与GPi群体放电率成线性关系。如果 $r$ 是GPi的放电率（单位为$\\mathrm{Hz}$），那么有效抑制性驱动为 $w r$，其中 $w$ 是一个正常数，其单位使得 $w r$ 与下文的兴奋性驱动项具有相同的量纲。\n\n2. 设丘脑神经元的净输入（减去有效脉冲阈值后）表示为 $x = b - w r$，其中 $b$ 是净兴奋性驱动减去阈值（两者合并为一个常数），$w r$ 代表GPi的平均抑制效应。\n\n3. 在一个短的固定观察窗口内，神经元要么发放一次脉冲，要么不发放。由于大量突触输入的中心极限定理效应，膜电位波动近似为高斯分布。在此情况下，脉冲概率是归一化输入 $x$ 的一个平滑饱和函数。该映射可以很好地由一个逻辑斯蒂输入-输出函数来近似，该函数作为噪声阈值模型的规范链接函数而产生：$p = \\sigma(\\beta x)$，其中 $\\sigma(y) = \\frac{1}{1 + \\exp(-y)}$，且 $\\beta > 0$ 概括了有效噪声的反向尺度。\n\n给定以下在归一化单位下经验上合理的参数化设置：\n- 基线GPi放电率 $r_{0} = 70\\,\\mathrm{Hz}$。\n- 苍白球切开术后，GPi放电率降低了 $35\\%$（即降至 $r_{1} = r_{0} \\times (1 - 0.35)$）。\n- 抑制效能 $w = 0.03$（单位使得 $w r$ 与 $b$ 的量纲相同）。\n- 净兴奋性驱动减去阈值 $b = 3.0$（与 $w r$ 单位相同）。\n- 反向噪声尺度 $\\beta = 1.0$（无量纲）。\n\n从以上假设以及泊松突触输入汇聚成高斯膜电位波动的标准性质出发，推导苍白球切开术前后丘脑的期望脉冲概率，然后计算放电概率的期望变化量 $\\Delta p = p_{\\text{after}} - p_{\\text{before}}$。将你的最终答案表示为一个无量纲的小数。将最终答案四舍五入至四位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取给定信息\n- 丘脑神经元的净输入：$x = b - w r$\n- 脉冲概率函数：$p = \\sigma(\\beta x)$，其中 $\\sigma(y) = \\frac{1}{1 + \\exp(-y)}$\n- 基线GPi放电率：$r_{0} = 70\\,\\mathrm{Hz}$\n- 苍白球切开术后GPi放电率：$r_{1} = r_{0} \\times (1 - 0.35)$\n- 抑制效能常数：$w = 0.03$\n- 净兴奋性驱动减阈值常数：$b = 3.0$\n- 反向噪声尺度常数：$\\beta = 1.0$\n- 待计算的量是放电概率的变化量，$\\Delta p = p_{\\text{after}} - p_{\\text{before}}$。\n- 最终答案需四舍五入至四位有效数字。\n\n### 步骤2：使用提取的信息进行验证\n该问题具有科学依据。基底神经节-丘脑-皮层环路、苍白球内侧段（GPi）的抑制功能、GPi活动减少（如苍白球切开术中）后丘脑的去抑制，以及突触输入的泊松-高斯近似，都是系统与计算神经科学中的标准概念。逻辑斯蒂函数是神经元输入-输出放电概率曲线的典型选择。该问题是适定的，提供了所有必要的数学模型和参数值，以唯一地确定所需量。语言是客观的，且参数作为归一化模型的参数是合理的。问题内部没有矛盾、歧义或违反科学原理之处。\n\n### 步骤3：结论与行动\n问题有效。将推导解答。\n\n目标是计算由于苍白球切开术引起的GPi放电率变化而导致的丘脑神经元脉冲概率的变化量 $\\Delta p = p_{\\text{after}} - p_{\\text{before}}$。\n\n首先，我们计算手术前后的GPi放电率。\n基线放电率给定为 $r_{\\text{before}} = r_{0} = 70\\,\\mathrm{Hz}$。\n苍白球切开术后的放电率 $r_{\\text{after}}$ 是从基线降低了 $35\\%$：\n$$r_{\\text{after}} = r_{1} = r_{0} \\times (1 - 0.35) = 70 \\times 0.65 = 45.5\\,\\mathrm{Hz}$$\n\n接下来，我们使用公式 $x = b - w r$ 计算两种情况下丘脑神经元的净输入 $x$。给定的参数是 $b = 3.0$，$w = 0.03$ 和 $\\beta = 1.0$。\n\n苍白球切开术前：\n$$x_{\\text{before}} = b - w r_{\\text{before}} = 3.0 - (0.03 \\times 70) = 3.0 - 2.1 = 0.9$$\n\n苍白球切开术后：\n$$x_{\\text{after}} = b - w r_{\\text{after}} = 3.0 - (0.03 \\times 45.5) = 3.0 - 1.365 = 1.635$$\n\n现在，我们使用逻辑斯蒂函数 $p = \\sigma(\\beta x) = \\frac{1}{1 + \\exp(-\\beta x)}$ 计算相应的脉冲概率。\n\n苍白球切开术前的概率 $p_{\\text{before}}$ 为：\n$$p_{\\text{before}} = \\sigma(\\beta x_{\\text{before}}) = \\sigma(1.0 \\times 0.9) = \\sigma(0.9) = \\frac{1}{1 + \\exp(-0.9)}$$\n\n苍白球切开术后的概率 $p_{\\text{after}}$ 为：\n$$p_{\\text{after}} = \\sigma(\\beta x_{\\text{after}}) = \\sigma(1.0 \\times 1.635) = \\sigma(1.635) = \\frac{1}{1 + \\exp(-1.635)}$$\n\n概率的变化量 $\\Delta p$ 是这两个值之间的差：\n$$\\Delta p = p_{\\text{after}} - p_{\\text{before}} = \\frac{1}{1 + \\exp(-1.635)} - \\frac{1}{1 + \\exp(-0.9)}$$\n\n为了得到最终的数值答案，我们计算这些表达式：\n$$p_{\\text{before}} \\approx \\frac{1}{1 + 0.40657} \\approx \\frac{1}{1.40657} \\approx 0.71095$$\n$$p_{\\text{after}} \\approx \\frac{1}{1 + 0.19495} \\approx \\frac{1}{1.19495} \\approx 0.83685$$\n\n最后，我们计算差值：\n$$\\Delta p \\approx 0.83685 - 0.71095 = 0.12590$$\n\n将结果四舍五入至四位有效数字，得到 $0.1259$。这个正向变化表明丘脑兴奋性增加，这与减少GPi输出的去抑制效应相一致。",
            "answer": "$$\\boxed{0.1259}$$"
        },
        {
            "introduction": "最后一个练习将引导你进入计算神经科学的核心，通过编程实现一个基底节动作选择的速率模型。此实践不仅巩固了对直接通路功能的理解，还通过代码清晰地展示了多巴胺如何调节该环路的增益以偏向性地选择动作。完成这个练习将为你提供一个探索系统动力学的强大工具，并让你体会计算方法在现代神经科学研究中的应用。",
            "id": "4480365",
            "problem": "考虑一个简化的、通道化的基底核动作选择回路速率模型，该模型侧重于锥体外系运动通路。该模型包含从皮质到纹状体（D1型中型多棘神经元），再到苍白球内侧部（GPi），并继续延伸至丘脑的直接通路。来自黑质致密部（SNc）的多巴胺调节直接通路的兴奋性。以下科学事实和核心定义是模型的基础：(i) 多巴胺增加表达D1受体的纹状体神经元的兴奋性，(ii) 直接通路抑制GPi和黑质网状部（SNr），从而减少对丘脑的抑制性输出，(iii) 丘脑的去抑制作用增强了支持动作选择的丘脑-皮质驱动，以及 (iv) 基于发放率的模型以赫兹（Hz）为单位近似群体活动。\n\n您将实现一个包含 $N$ 个动作通道的基于速率的模型，通道索引为 $i \\in \\{0, \\dots, N-1\\}$。对于每个通道 $i$，皮质输入为 $c_i$，单位为 $\\mathrm{Hz}$。该模型定义了以下转换：\n\n- 纹状体直接通路速率：$s_i = \\phi\\!\\left(g_i(D)\\,c_i - \\theta_i\\right)$，其中 $D$ 是来自黑质致密部（SNc）的相位性多巴胺水平，$g_i(D)$ 是一个多巴胺依赖的增益，$\\theta_i$ 是一个阈值（单位为 $\\mathrm{Hz}$），而 $\\phi(x) = \\max(0, x)$ 是线性整流函数。\n\n- GPi输出速率（对丘脑有抑制作用）：$y_i = y_0 - w\\,s_i$，其中 $y_0$ 是GPi的基线速率（单位为 $\\mathrm{Hz}$），$w > 0$ 是纹状体-黑质抑制权重。\n\n- 具有饱和线性读出的丘脑输出速率：$t_i = \\mathrm{clip}\\!\\left(\\eta - \\beta\\,y_i,\\; 0,\\; t_{\\max}\\right)$，其中 $\\eta$ 是一个基线丘脑驱动（单位为 $\\mathrm{Hz}$），$\\beta > 0$ 是一个缩放常数，$t_{\\max}$ 是一个饱和上限（单位为 $\\mathrm{Hz}$），且 $\\mathrm{clip}(x, a, b) = \\min\\!\\left(b, \\max\\!\\left(a, x\\right)\\right)$。\n\n假设多巴胺依赖的增益为 $g_i(D) = g_{0,i}\\,\\bigl(1 + \\alpha_i D\\bigr)$，其中 $g_{0,i} > 0$ 是基线增益，$\\alpha_i \\ge 0$ 是一个多巴胺敏感性参数，反映了D1受体介导的放大作用。所有速率单位均为 $\\mathrm{Hz}$，而 $D$ 是无量纲的。\n\n任务要求：\n\n1. 根据上述定义，在非饱和、活动区间（即当 $g_i(D)\\,c_i - \\theta_i > 0$ 和 $0 < \\eta - \\beta\\,y_i < t_{\\max}$ 同时成立时），推导出丘脑输出相对于皮质输入的局部斜率 $\\dfrac{\\partial t_i}{\\partial c_i}$，并将其表示为 $D$ 和模型参数的函数。\n\n2. 实现一个程序，对于下面定义的每个测试用例，计算：\n   - 在相位性多巴胺增加后选择的动作索引，定义为在多巴胺脉冲水平 $D_{\\text{pulse}}$ 下使 $t_i$ 最大化的索引 $i$。\n   - 所选动作的增益比 $R$，定义为 $R = \\left(\\dfrac{\\partial t_i}{\\partial c_i}\\big|_{D=D_{\\text{pulse}}}\\right) \\Big/ \\left(\\dfrac{\\partial t_i}{\\partial c_i}\\big|_{D=0}\\right)$，并使用提供的输入参数进行评估。如果任一条件不处于非饱和、活动区间（即，由于纹状体不活动或丘脑饱和/触底，导数为 $0$），则定义 $R = 0.0$。\n\n3. 单位和输出格式：\n   - 所有发放率的单位均为 $\\mathrm{Hz}$。\n   - 不涉及角度；因此，不需要角度单位。\n   - 将增益比 $R$ 四舍五入到三位小数。\n   - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果格式为 $[i,R]$（无空格），所有结果聚合为一个列表。例如：$[[i_1,R_1],[i_2,R_2],[i_3,R_3]]$。\n\n测试套件参数集：\n\n- 测试用例 1（理想路径，非饱和）：\n  - $N = 2$\n  - $\\mathbf{c} = [20, 18]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.5, 0.5]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.2$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 0.3$\n\n- 测试用例 2（皮质输入相等，多巴胺敏感性差异偏向）：\n  - $N = 2$\n  - $\\mathbf{c} = [15, 15]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.5, 0.5]$\n  - $\\boldsymbol{\\alpha} = [1.2, 0.8]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.0$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 0.5$\n\n- 测试用例 3（由于大输入和多巴胺导致的饱和边缘情况）：\n  - $N = 2$\n  - $\\mathbf{c} = [80, 80]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.6, 0.6]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.5$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 1.0$\n\n- 测试用例 4（由于低输入导致的纹状体不活动边缘情况）：\n  - $N = 2$\n  - $\\mathbf{c} = [5, 5]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.3, 0.3]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.0$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 1.0$\n\n您的程序必须实现上述模型，为每个测试用例计算所选动作的索引和增益比 $R$，将 $R$ 四舍五入到三位小数，并严格按照 $[[i_1,R_1],[i_2,R_2],[i_3,R_3],[i_4,R_4]]$ 的格式打印单行输出。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于计算神经科学的既定原则，问题设定良好，定义和参数清晰完整，表述客观。该问题按陈述即可解决。我们开始解答，解答过程包括两个主要部分：对所需量的解析推导，以及实现一个程序来计算给定测试用例的结果。\n\n### 第一部分：丘脑输出斜率的推导\n\n第一个任务是推导给定动作通道 $i$ 的丘脑输出相对于皮质输入的局部斜率 $\\dfrac{\\partial t_i}{\\partial c_i}$。这个量代表了皮质-丘脑通路的增益。推导是在“非饱和、活动区间”下进行的，在该区间内，类神经元单元在其线性范围内运行。\n\n模型通过一系列变换定义了皮质输入 $c_i$ 和丘脑输出 $t_i$ 之间的关系：\n1.  纹状体速率：$s_i = \\phi(g_i(D)c_i - \\theta_i)$，其中 $\\phi(x) = \\max(0, x)$。\n2.  GPi速率：$y_i = y_0 - w s_i$。\n3.  丘脑速率：$t_i = \\mathrm{clip}(\\eta - \\beta y_i, 0, t_{\\max})$。\n\n我们可以通过应用链式法则来求导数 $\\dfrac{\\partial t_i}{\\partial c_i}$：\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\frac{\\partial t_i}{\\partial y_i} \\cdot \\frac{\\partial y_i}{\\partial s_i} \\cdot \\frac{\\partial s_i}{\\partial c_i}\n$$\n\n我们在指定的区间条件下评估每个偏导数。\n\n**1. 纹状体速率 ($s_i$) 对皮质输入 ($c_i$) 的导数**\n纹状体速率为 $s_i = \\phi(g_i(D)c_i - \\theta_i)$。“活动区间”条件定义为 $g_i(D)c_i - \\theta_i > 0$。在此域中，线性整流函数 $\\phi(x)$ 简化为 $\\phi(x) = x$。\n因此，对于一个活动通道，$s_i = g_i(D)c_i - \\theta_i$。其相对于 $c_i$ 的偏导数为：\n$$\n\\frac{\\partial s_i}{\\partial c_i} = \\frac{\\partial}{\\partial c_i} (g_i(D)c_i - \\theta_i) = g_i(D)\n$$\n如果通道不活动（$g_i(D)c_i - \\theta_i \\le 0$），则 $s_i=0$ 且导数为 $0$。\n\n**2. GPi速率 ($y_i$) 对纹状体速率 ($s_i$) 的导数**\nGPi速率是纹状体速率的线性函数：$y_i = y_0 - w s_i$。其偏导数是常数：\n$$\n\\frac{\\partial y_i}{\\partial s_i} = \\frac{\\partial}{\\partial s_i} (y_0 - w s_i) = -w\n$$\n\n**3. 丘脑速率 ($t_i$) 对GPi速率 ($y_i$) 的导数**\n丘脑速率为 $t_i = \\mathrm{clip}(\\eta - \\beta y_i, 0, t_{\\max})$。“非饱和”条件是 $0 < \\eta - \\beta y_i < t_{\\max}$。在这个线性区域，裁剪函数（clip function）等于其参数，即 $t_i = \\eta - \\beta y_i$。其相对于 $y_i$ 的偏导数为：\n$$\n\\frac{\\partial t_i}{\\partial y_i} = \\frac{\\partial}{\\partial y_i} (\\eta - \\beta y_i) = -\\beta\n$$\n如果丘脑活动处于其下限（$0$）或上限（$t_{\\max}$），则导数为 $0$。\n\n**4. 组合最终表达式**\n通过将各偏导数相乘，我们得到在非饱和、活动区间内的斜率表达式：\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\left(\\frac{\\partial t_i}{\\partial y_i}\\right) \\left(\\frac{\\partial y_i}{\\partial s_i}\\right) \\left(\\frac{\\partial s_i}{\\partial c_i}\\right) = (-\\beta)(-w)(g_i(D)) = \\beta w g_i(D)\n$$\n最后，代入多巴胺依赖增益的定义 $g_i(D) = g_{0,i}(1 + \\alpha_i D)$，我们得到：\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\beta w g_{0,i}(1 + \\alpha_i D)\n$$\n这就是局部斜率的最终表达式。如果在给定的 $D$ 值下，系统不处于此区间，则该导数为 $0$。\n\n### 第二部分：计算逻辑与增益比\n\n第二个任务是实现该模型以确定所选动作和增益比 $R$。\n\n**所选动作：** 所选动作是在相位性多巴胺水平为 $D = D_{\\text{pulse}}$ 时，使丘脑输出 $t_i$ 最大化的通道索引 $i$。这可以通过计算所有通道 $i \\in \\{0, \\dots, N-1\\}$ 的 $t_i$ 值，然后找到最大值的索引来得出。\n\n**增益比 $R$：** 所选动作通道 $i_{\\text{sel}}$ 的增益比 $R$ 定义为：\n$$\nR = \\frac{\\left.\\frac{\\partial t_{i_{\\text{sel}}}}{\\partial c_{i_{\\text{sel}}}}\\right|_{D=D_{\\text{pulse}}}}{\\left.\\frac{\\partial t_{i_{\\text{sel}}}}{\\partial c_{i_{\\text{sel}}}}\\right|_{D=0}}\n$$\n一个关键条件是，如果所选通道的系统状态在 $D = D_{\\text{pulse}}$ 或 $D=0$ 任一情况下超出了非饱和、活动区间，则 $R$ 定义为 $0.0$。\n\n我们来分析两种情况（$D=D_{\\text{pulse}}$ 和 $D=0$）都处于活动、非饱和区间时的比率 $R$。使用推导出的斜率表达式：\n- 分子（在 $D=D_{\\text{pulse}}$ 时）： $\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}})$\n- 分母（在 $D=0$ 时）： $\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} \\cdot 0) = \\beta w g_{0,i_{\\text{sel}}}$\n\n该比率简化为：\n$$\nR = \\frac{\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}})}{\\beta w g_{0,i_{\\text{sel}}}} = 1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}}\n$$\n这个简洁的结果表明，只要系统保持在其线性工作范围内，增益调制就与多巴胺敏感性 $\\alpha_i$ 和多巴胺水平 $D_{\\text{pulse}}$ 直接相关。\n\n因此，算法如下：\n1.  对于给定的测试用例，在 $D=D_{\\text{pulse}}$ 条件下遍历每个通道 $i=0, \\dots, N-1$，计算所有的 $t_i$ 值。\n2.  确定所选动作的索引 $i_{\\text{sel}} = \\arg\\max_i(t_i)$。\n3.  对于这个选定的通道 $i_{\\text{sel}}$，检查在 $D=D_{\\text{pulse}}$ 和 $D=0$ 两种情况下的非饱和、活动区间条件。\n    对于给定的 $D$ 和通道 $i$ 的条件如下：\n    a. 纹状体活动性： $g_{0,i}(1 + \\alpha_i D)c_i - \\theta_i > 0$。\n    b. 丘脑线性：首先计算 $s_i$ 和 $y_i$，然后检查 $0 < \\eta - \\beta y_i < t_{\\max}$。\n4. 如果两次检查（$D=D_{\\text{pulse}}$ 和 $D=0$ 时）都通过，则计算 $R = 1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}}$。\n5. 否则，设置 $R=0.0$。\n6. 将结果格式化为 $[i_{\\text{sel}}, R]$，其中 $R$ 四舍-五入到三位小数。\n\n此过程被系统地应用于每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the basal ganglia model problem for the given test suite.\n    \"\"\"\n    \n    test_cases = [\n        # Test Case 1 (happy path, unsaturated)\n        {\n            \"N\": 2, \"c\": [20, 18], \"g0\": [0.5, 0.5], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.2, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 0.3\n        },\n        # Test Case 2 (equal cortical input, differential dopamine sensitivity bias)\n        {\n            \"N\": 2, \"c\": [15, 15], \"g0\": [0.5, 0.5], \"alpha\": [1.2, 0.8], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.0, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 0.5\n        },\n        # Test Case 3 (saturation edge due to large input and dopamine)\n        {\n            \"N\": 2, \"c\": [80, 80], \"g0\": [0.6, 0.6], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.5, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 1.0\n        },\n        # Test Case 4 (striatum inactive edge due to low input)\n        {\n            \"N\": 2, \"c\": [5, 5], \"g0\": [0.3, 0.3], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.0, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 1.0\n        }\n    ]\n\n    all_results = []\n\n    def check_regime(c_i, g0_i, alpha_i, theta_i, y0, w, beta, eta, t_max, D):\n        \"\"\"\n        Checks if a channel is in the non-saturated, active regime for a given D.\n        Returns True if in the regime, False otherwise.\n        \"\"\"\n        g_i = g0_i * (1.0 + alpha_i * D)\n        striatal_input = g_i * c_i - theta_i\n        \n        # Condition 1: Striatal activity\n        if striatal_input = 0:\n            return False\n        \n        # Calculate intermediate rates\n        s_i = striatal_input\n        y_i = y0 - w * s_i\n        thalamic_input = eta - beta * y_i\n        \n        # Condition 2: Thalamic non-saturation\n        if not (0  thalamic_input  t_max):\n            return False\n            \n        return True\n\n    def calculate_thalamic_rate(c_i, g0_i, alpha_i, theta_i, y0, w, beta, eta, t_max, D):\n        \"\"\"\n        Computes the thalamic output rate for a single channel.\n        \"\"\"\n        g_i = g0_i * (1.0 + alpha_i * D)\n        s_i = max(0, g_i * c_i - theta_i)\n        y_i = y0 - w * s_i\n        t_i = np.clip(eta - beta * y_i, 0, t_max)\n        return t_i\n\n    for case in test_cases:\n        N = case[\"N\"]\n        c, g0, alpha, theta = case[\"c\"], case[\"g0\"], case[\"alpha\"], case[\"theta\"]\n        y0, w, beta, eta, t_max = case[\"y0\"], case[\"w\"], case[\"beta\"], case[\"eta\"], case[\"t_max\"]\n        D_pulse = case[\"D_pulse\"]\n\n        # 1. Determine the selected action index\n        t_values = []\n        for i in range(N):\n            t_i = calculate_thalamic_rate(c[i], g0[i], alpha[i], theta[i],\n                                          y0, w, beta, eta, t_max, D_pulse)\n            t_values.append(t_i)\n        \n        selected_index = int(np.argmax(t_values))\n\n        # 2. Compute the gain ratio R\n        c_sel = c[selected_index]\n        g0_sel = g0[selected_index]\n        alpha_sel = alpha[selected_index]\n        theta_sel = theta[selected_index]\n        \n        # Check regime for D = D_pulse\n        is_active_at_pulse = check_regime(c_sel, g0_sel, alpha_sel, theta_sel,\n                                          y0, w, beta, eta, t_max, D_pulse)\n        \n        # Check regime for D = 0\n        is_active_at_zero = check_regime(c_sel, g0_sel, alpha_sel, theta_sel,\n                                         y0, w, beta, eta, t_max, 0.0)\n\n        # Calculate R based on the regime checks\n        if is_active_at_pulse and is_active_at_zero:\n            R = 1.0 + alpha_sel * D_pulse\n        else:\n            R = 0.0\n\n        # Format and append the result\n        all_results.append(f\"[{selected_index},{R:.3f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(all_results)}]]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}