{
    "hands_on_practices": [
        {
            "introduction": "神经修复术的一个核心目标是向神经系统传递信息，例如为假肢提供触觉反馈。在实现这一目标时，安全性是首要考虑的因素。这项练习将帮助你掌握电刺激的基本生物物理限制，特别是电荷注入极限的概念，这对于设计任何与神经组织相互作用的植入式设备都至关重要。这是一个每个脑机接口设计者都必须掌握的实用计算。",
            "id": "4457814",
            "problem": "一个由溅射氧化铱薄膜制成的皮层微刺激电极被用于脑机接口，以提供体感反馈。为避免不可逆的法拉第反应和组织损伤，刺激受到材料每相可逆电荷注入极限的限制。假设一个矩形的、恒流的、阴极优先的双相脉冲，其阴极相持续时间为 $200\\,\\mu\\text{s}$。电极的几何表面积为 $A=0.02\\,\\text{cm}^2$，并且制造商报告在相关波形和偏置条件下，阴极相的每相可逆电荷注入极限为 $\\sigma_{\\text{max}}=0.35\\,\\text{mC/cm}^2$。为安全起见，设备在运行时设置了 $10\\%$ 的安全裕度，此处定义为将操作限制在理论最大可逆电荷的 $90\\%$ 以内。\n\n仅使用以下基本关系：(i) 单相中传递的电荷是电流在该相上的时间积分，以及 (ii) 每相的电荷不得超过可逆单位面积极限与几何面积的乘积，计算阴极相的最大安全电流幅值。将您的最终答案以毫安为单位表示，并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过评估并被确定为有效。它具有科学依据，问题设定良好，客观，完整，并包含神经工程问题中的实际参数。\n\n目标是计算双相刺激脉冲阴极相的最大安全电流幅值 $I_{\\text{safe, max}}$。这将通过遵守电荷注入的限制来完成。\n\n首先，我们用符号定义所提供的参数：\n- 阴极相持续时间：$t_c = 200\\,\\mu\\text{s}$\n- 电极几何表面积：$A = 0.02\\,\\text{cm}^2$\n- 每相可逆电荷注入极限（单位面积电荷密度）：$\\sigma_{\\text{max}} = 0.35\\,\\text{mC/cm}^2$\n- 安全系数：$S_f = 0.90$（根据 $10\\%$ 的安全裕度，代表在最大极限的 $90\\%$ 下运行）。\n\n该问题受两个明确陈述的基本关系支配。\n\n首先，单相期间可注入的最大理论可逆电荷 $Q_{\\text{max, theoretical}}$ 是材料的单位面积电荷注入极限 $\\sigma_{\\text{max}}$ 与电极的几何表面积 $A$ 的乘积。\n$$Q_{\\text{max, theoretical}} = \\sigma_{\\text{max}} \\times A$$\n\n其次，为安全起见，操作电荷不得超过此理论最大值的一定比例。因此，通过应用安全系数 $S_f$ 来确定每相的最大安全电荷 $Q_{\\text{safe}}$。\n$$Q_{\\text{safe}} = S_f \\times Q_{\\text{max, theoretical}} = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\n第三，在持续时间 $t$ 内由恒定电流 $I$ 传递的总电荷 $Q$ 是电流和持续时间的乘积。这是对恒定电流在时间间隔内积分的结果。对于阴极相，传递的电荷为：\n$$Q_c = I_c \\times t_c$$\n其中 $I_c$ 是阴极相期间的电流幅值。\n\n为了找到最大安全电流幅值 $I_{\\text{safe, max}}$，我们将阴极相期间传递的电荷设置为等于最大安全电荷极限 $Q_{\\text{safe}}$。\n$$I_{\\text{safe, max}} \\times t_c = Q_{\\text{safe}}$$\n\n代入 $Q_{\\text{safe}}$ 的表达式可得：\n$$I_{\\text{safe, max}} \\times t_c = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\n我们现在可以解出 $I_{\\text{safe, max}}$：\n$$I_{\\text{safe, max}} = \\frac{S_f \\times \\sigma_{\\text{max}} \\times A}{t_c}$$\n\n现在，我们将给定的数值代入此方程。保持单位一致性至关重要。我们首先以毫库仑（$ \\text{mC} $）为单位计算 $Q_{\\text{safe}}$。\n$$Q_{\\text{safe}} = 0.90 \\times (0.35\\,\\frac{\\text{mC}}{\\text{cm}^2}) \\times (0.02\\,\\text{cm}^2)$$\n$$Q_{\\text{safe}} = 0.90 \\times 0.007\\,\\text{mC}$$\n$$Q_{\\text{safe}} = 0.0063\\,\\text{mC}$$\n\n接下来，我们计算 $I_{\\text{safe, max}}$。电荷单位是毫库仑（$ \\text{mC} $），持续时间单位是微秒（$ \\mu\\text{s} $）。明智的做法是先将这些单位转换为国际单位制基本单位（库仑和秒），以安培为单位求出电流，最后再按要求转换为毫安。\n$Q_{\\text{safe}} = 0.0063\\,\\text{mC} = 0.0063 \\times 10^{-3}\\,\\text{C} = 6.3 \\times 10^{-6}\\,\\text{C}$\n$t_c = 200\\,\\mu\\text{s} = 200 \\times 10^{-6}\\,\\text{s} = 2.0 \\times 10^{-4}\\,\\text{s}$\n\n现在，我们以安培（$ \\text{A} $）为单位计算电流：\n$$I_{\\text{safe, max}} = \\frac{Q_{\\text{safe}}}{t_c} = \\frac{6.3 \\times 10^{-6}\\,\\text{C}}{2.0 \\times 10^{-4}\\,\\text{s}}$$\n$$I_{\\text{safe, max}} = 3.15 \\times 10^{-2}\\,\\text{A}$$\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A}$$\n\n问题要求最终答案以毫安（$ \\text{mA} $）表示，并四舍五入到三位有效数字。\n要从安培转换为毫安，我们乘以 $1000$：\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A} \\times \\frac{1000\\,\\text{mA}}{1\\,\\text{A}} = 31.5\\,\\text{mA}$$\n\n数值 $31.5$ 正好有三位有效数字（$3$、$1$ 和 $5$）。因此，不需要进一步的四舍五入。\n阴极相的最大安全电流幅值为 $31.5\\,\\text{mA}$。",
            "answer": "$$\n\\boxed{31.5}\n$$"
        },
        {
            "introduction": "在探讨了如何安全地“写入”大脑之后，我们将焦点转向如何“读取”大脑信号。确保安全后，下一个实际挑战是处理神经记录系统产生的海量数据。本练习将让你亲手计算典型微电极阵列的数据速率和存储需求，从而对高通道数脑机接口系统中的工程约束和数据管理挑战有一个切实的认识。",
            "id": "4457855",
            "problem": "在一个脑机接口（BCI）应用中，一个多通道胞外记录系统使用一个具有 $96$ 个独立通道的微电极阵列（MEA）来采集神经元尖峰波形。每个通道以 $30\\,\\mathrm{kHz}$ 的恒定采样频率进行数字化，模数转换器（ADC）的分辨率为每样本 $12$ 位。假设是连续采集、跨通道同步采样，并且是原始流式传输，没有压缩、分帧、元数据或线路编码开销；假设样本按位紧密打包，因此每个样本恰好存储 $12$ 位。\n\n从采样频率（样本/秒）和数字系统中的信息表示（位/样本）的基本定义出发，推导计算以下内容所需的表达式：\n1. 整个系统的原始数据速率。\n2. 记录 $1$ 小时所需的总存储空间。\n\n使用十进制定义 $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$ 和 $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$，将原始数据速率以兆字节/秒（MB/s）表示，总存储空间以吉字节（GB）表示。提供最终的数值，无需四舍五入。",
            "solution": "我们使用的基本定义是：\n- 采样频率 $f_{s}$ 给出每个通道每秒产生的样本数。\n- 模数转换器分辨率 $n_{b}$ 给出用于表示每个样本的位数。\n- 对于 $N_{c}$ 个独立且同步采样的通道，每秒的总样本数为 $N_{c} f_{s}$。\n- 原始比特率是每秒样本数与每样本位数的乘积。\n\n令 $f_{s} = 30\\,\\mathrm{kHz} = 30{,}000\\,\\mathrm{s}^{-1}$，$n_{b} = 12\\,\\mathrm{bits/sample}$，以及 $N_{c} = 96$ 个通道。\n\n原始比特率 $R_{\\mathrm{bits}}$ 为\n$$\nR_{\\mathrm{bits}} = f_{s} \\times n_{b} \\times N_{c}.\n$$\n代入符号和数值：\n$$\nR_{\\mathrm{bits}} = 30{,}000 \\times 12 \\times 96 = 34{,}560{,}000 \\ \\text{bits/s}.\n$$\n\n要转换为字节/秒，使用 $1\\,\\mathrm{byte} = 8\\,\\mathrm{bits}$：\n$$\nR_{\\mathrm{bytes}} = \\frac{R_{\\mathrm{bits}}}{8} = \\frac{34{,}560{,}000}{8} = 4{,}320{,}000 \\ \\text{bytes/s}.\n$$\n\n要将原始数据速率以兆字节/秒（十进制）表示，使用 $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$：\n$$\nR_{\\mathrm{MB/s}} = \\frac{R_{\\mathrm{bytes}}}{10^{6}} = \\frac{4{,}320{,}000}{1{,}000{,}000} = 4.32.\n$$\n\n接下来，计算记录时长 $T = 1\\,\\mathrm{hour} = 3600\\,\\mathrm{s}$ 的总存储空间。存储的总字节数 $S_{\\mathrm{bytes}}$ 为\n$$\nS_{\\mathrm{bytes}} = R_{\\mathrm{bytes}} \\times T = 4{,}320{,}000 \\times 3{,}600 = 15{,}552{,}000{,}000 \\ \\text{bytes}.\n$$\n\n使用 $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$ 转换为吉字节（十进制）：\n$$\nS_{\\mathrm{GB}} = \\frac{S_{\\mathrm{bytes}}}{10^{9}} = \\frac{15{,}552{,}000{,}000}{1{,}000{,}000{,}000} = 15.552.\n$$\n\n因此，在所述假设和十进制单位定义下，原始数据速率为 $4.32\\,\\mathrm{MB/s}$，一小时所需的存储空间为 $15.552\\,\\mathrm{GB}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}4.32 & 15.552\\end{pmatrix}}$$"
        },
        {
            "introduction": "涵盖了输入（刺激）和数据采集（记录）方面后，这最后一个练习将解决核心的“解码”挑战。它将引导你完成一个用于非侵入式脑机接口的完整经典流程：使用共空间模式（Common Spatial Patterns, CSP）算法从脑电图（EEG）数据中解码运动想象。这个问题综合了线性代数和统计学的概念来构建一个功能性解码器并评估其性能，从而提供了一个全面、端到端的脑机接口信号处理视角。",
            "id": "4457878",
            "problem": "给定一个双类别运动想象范式下，按类别区分的多通道脑电图（EEG）试验协方差矩阵集。每个试验协方差是一个对称半正定矩阵，表示试验数据在各通道间的二阶统计量。从基本原理出发，设计一个程序，该程序为每个测试用例学习公共空间模式（CSP）滤波器，以在适当约束下最大化一个类别的方差，通过这些滤波器从每次试验中提取归一化的对数方差特征，并使用Fisher准则评估跨类别的特征可分性。\n\n您必须使用的基本原理：\n- 零均值随机向量的协方差：对于具有通道向量时间序列的试验，其协方差矩阵是对称半正定的。对于每次试验，您将直接获得其协方差矩阵。\n- 线性空间滤波：如果空间滤波器是一个列向量 $w$，则类别平均协方差 $C$ 的投影方差为 $w^{\\top} C w$。在线性约束下最大化瑞利商（Rayleigh quotient）会得到一个特征值-特征向量问题。\n- 对称矩阵的广义特征值问题：对于对称正定矩阵 $B$ 和对称矩阵 $A$，约束优化的滤波器方向满足形式为 $A w = \\lambda B w$ 的广义特征值问题。\n- Fisher判别比（Fisher准则）：对于一个跨越两个类别的一维特征，其样本均值分别为 $\\mu_1$、$\\mu_2$，样本方差分别为 $\\sigma_1^2$、$\\sigma_2^2$，其可分性通过 $(\\mu_1 - \\mu_2)^2 / (\\sigma_1^2 + \\sigma_2^2)$ 来量化。\n\n您的程序必须：\n1. 对每个类别，首先通过其迹（trace）对每个试验协方差 $C_i$ 进行归一化（以消除尺度影响），即 $C_i / \\operatorname{tr}(C_i)$，然后在所有试验上取平均，从而形成类别平均协方差。为确保数值稳定性，向每个类别平均协方差中添加一个小的正则化项 $\\epsilon I$，其中 $I$ 是单位矩阵，$\\epsilon > 0$ 会在每个测试用例中提供。\n2. 通过求解由以下优化目标导出的对称广义特征值问题来计算CSP滤波器：在使用两个正则化的类别平均协方差时，最大化一个类别的方差，同时约束两个类别的总方差为1。选择与第一个类别最相关的 $m$ 个滤波器（最具辨别性的方向）和与第二个类别最相关的 $m$ 个滤波器（最具辨别性的方向），总共得到 $2m$ 个滤波器。\n3. 对于每个类别中的每个试验协方差，将其投影到CSP基上，并提取归一化的对数方差特征。具体方法是：沿着选定的 $2m$ 个滤波器方向，计算投影协方差对角线元素，并用它们的和（即投影总方差）进行归一化，然后取自然对数。\n4. 使用来自两个类别的所有试验，为 $2m$ 个特征维度中的每一个计算Fisher准则。为了分母的数值稳定性，添加一个方差下限 $\\delta$，其中 $\\delta = 10^{-12}$。\n5. 对于每个测试用例，将 $2m$ 个Fisher分数按降序排序，并将每个分数四舍五入到六位小数。\n\n测试套件：\n提供以下所有测试用例的结果。所有协方差矩阵都是对角矩阵，由 $\\operatorname{diag}(\\cdot)$ 给出，且所有试验都是独立的。每个类别有 $3$ 次试验。所有情况下通道数均为 $3$。单位矩阵 $I$ 是 $3 \\times 3$ 的单位矩阵。\n\n- 测试用例 $1$ （类别区分度高），$m = 1$ 且 $\\epsilon = 10^{-8}$：\n  - 类别 $1$ 的试验协方差：\n    - $C^{(1)}_{1} = \\operatorname{diag}(9.0, 1.0, 0.5)$\n    - $C^{(1)}_{2} = \\operatorname{diag}(8.5, 1.2, 0.6)$\n    - $C^{(1)}_{3} = \\operatorname{diag}(9.2, 0.9, 0.4)$\n  - 类别 $2$ 的试验协方差：\n    - $C^{(2)}_{1} = \\operatorname{diag}(0.5, 1.0, 9.0)$\n    - $C^{(2)}_{2} = \\operatorname{diag}(0.6, 1.1, 8.7)$\n    - $C^{(2)}_{3} = \\operatorname{diag}(0.4, 0.9, 9.3)$\n\n- 测试用例 $2$ （类别相同；边界情况），$m = 1$ 且 $\\epsilon = 10^{-8}$：\n  - 类别 $1$ 的试验协方差：\n    - $C^{(1)}_{1} = \\operatorname{diag}(2.0, 1.0, 0.5)$\n    - $C^{(1)}_{2} = \\operatorname{diag}(2.0, 1.0, 0.5)$\n    - $C^{(1)}_{3} = \\operatorname{diag(2.0, 1.0, 0.5)}$\n  - 类别 $2$ 的试验协方差：\n    - $C^{(2)}_{1} = \\operatorname{diag}(2.0, 1.0, 0.5)$\n    - $C^{(2)}_{2} = \\operatorname{diag}(2.0, 1.0, 0.5)$\n    - $C^{(2)}_{3} = \\operatorname{diag}(2.0, 1.0, 0.5)$\n\n- 测试用例 $3$ （病态条件；需要正则化），$m = 1$ 且 $\\epsilon = 10^{-8}$：\n  - 类别 $1$ 的试验协方差：\n    - $C^{(1)}_{1} = \\operatorname{diag}(1000.0, 10^{-3}, 10^{-6})$\n    - $C^{(1)}_{2} = \\operatorname{diag}(900.0, 1.2 \\times 10^{-3}, 0.8 \\times 10^{-6})$\n    - $C^{(1)}_{3} = \\operatorname{diag}(1100.0, 0.9 \\times 10^{-3}, 1.1 \\times 10^{-6})$\n  - 类别 $2$ 的试验协方差：\n    - $C^{(2)}_{1} = \\operatorname{diag}(10^{-6}, 10^{-3}, 1000.0)$\n    - $C^{(2)}_{2} = \\operatorname{diag}(1.1 \\times 10^{-6}, 0.8 \\times 10^{-3}, 900.0)$\n    - $C^{(2)}_{3} = \\operatorname{diag}(0.9 \\times 10^{-6}, 1.2 \\times 10^{-3}, 1100.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个包含三个子列表的列表作为结果，每个子列表对应一个测试用例，并包含 $2m$ 个按降序排列并四舍五入到六位小数的Fisher分数。整体格式为不含空格的单行：例如，`[[a_1,a_2],[b_1,b_2],[c_1,c_2]]`，其中每个 $a_i$、$b_i$、$c_i$ 是一个四舍五入到六位小数的浮点数。",
            "solution": "该问题要求设计并实现一个算法，用于从脑电图（EEG）协方差矩阵中计算公共空间模式（CSP）滤波器、提取特征，并使用Fisher准则评估其可分性。该过程基于脑机接口（BCI）的既定统计信号处理原则。\n\n解决方案按照问题描述的要求分五个步骤进行。\n\n**1. 类别平均协方差矩阵的构建**\n\n设类别 $k \\in \\{1, 2\\}$ 的试验协方差矩阵集合为 $\\{C_i^{(k)}\\}_{i=1}^{N_k}$，其中 $N_k$ 是类别 $k$ 的试验次数。每个 $C_i^{(k)}$ 是一个 $N_c \\times N_c$ 的对称半正定矩阵，其中 $N_c$ 是通道数。\n\n首先，为了解决试验间信号功率的变化问题，每个协方差矩阵 $C_i^{(k)}$ 都通过其迹进行归一化。迹 $\\operatorname{tr}(C_i^{(k)})$ 表示该次试验中所有通道的总方差。归一化后的协方差为：\n$$\nC_{i, \\text{norm}}^{(k)} = \\frac{C_i^{(k)}}{\\operatorname{tr}(C_i^{(k)})}\n$$\n接着，通过对归一化后的试验协方差进行平均，计算出每个类别的单个代表性协方差矩阵 $\\bar{C}^{(k)}$：\n$$\n\\bar{C}^{(k)} = \\frac{1}{N_k} \\sum_{i=1}^{N_k} C_{i, \\text{norm}}^{(k)}\n$$\n最后，为确保矩阵是良态（well-conditioned）且可逆的，会添加一个小的正则化项。这是提高数值稳定性的常用做法。正则化后的类别平均协方差 $\\tilde{C}^{(k)}$ 为：\n$$\n\\tilde{C}^{(k)} = \\bar{C}^{(k)} + \\epsilon I\n$$\n其中 $I$ 是 $N_c \\times N_c$ 的单位矩阵，$\\epsilon$ 是一个小的正常数。这确保了 $\\tilde{C}^{(k)}$ 是严格正定的。\n\n**2. 通过广义特征值问题计算CSP滤波器**\n\nCSP的目标是找到空间滤波器（通道空间中的方向），使得一个类别的方差最大化，同时另一个类别的方差最小化。空间滤波器是一个向量 $w \\in \\mathbb{R}^{N_c}$。对于类别 $k$，投影到该滤波器上的信号方差由二次型 $w^T \\tilde{C}^{(k)} w$ 给出。\n\n该问题被表述为最大化类别1的方差，同时约束两个类别的总方差为1：\n$$\n\\max_{w} w^T \\tilde{C}^{(1)} w \\quad \\text{subject to} \\quad w^T (\\tilde{C}^{(1)} + \\tilde{C}^{(2)}) w = 1\n$$\n这个约束优化问题可以使用拉格朗日乘子法求解，从而导出广义特征值问题：\n$$\n\\tilde{C}^{(1)} w = \\lambda (\\tilde{C}^{(1)} + \\tilde{C}^{(2)}) w\n$$\n这个问题的特征向量 $w$ 就是空间滤波器。与特征向量 $w$ 相关联的特征值 $\\lambda$ 表示由类别1贡献的方差相对于总方差的比例。具体来说，$\\lambda = \\frac{w^T \\tilde{C}^{(1)} w}{w^T (\\tilde{C}^{(1)} + \\tilde{C}^{(2)}) w}$。因此，$1-\\lambda = \\frac{w^T \\tilde{C}^{(2)} w}{w^T (\\tilde{C}^{(1)} + \\tilde{C}^{(2)}) w}$。方差之比为 $\\frac{w^T \\tilde{C}^{(1)} w}{w^T \\tilde{C}^{(2)} w} = \\frac{\\lambda}{1-\\lambda}$。\n\n接近1的特征值 $\\lambda$ 对应于最大化类别1方差的滤波器，而接近0的特征值 $\\lambda$ 对应于最大化类别2方差的滤波器。\n\n该问题求解所有的 $N_c$ 个特征值及其对应的特征向量。特征向量根据其特征值进行排序。我们选择与最大特征值对应的 $m$ 个滤波器（对类别1最具辨别性）和与最小特征值对应的 $m$ 个滤波器（对类别2最具辨别性）。这 $2m$ 个滤波器构成了投影矩阵 $W_{csp} \\in \\mathbb{R}^{N_c \\times 2m}$ 的列。\n\n**3. 特征提取**\n\n在确定CSP滤波器后，我们可以从每个原始（未归一化）的试验协方差矩阵 $C_i^{(k)}$ 中提取特征。试验数据被投影到学习到的CSP空间中。投影数据的协方差矩阵由下式给出：\n$$\nZ_i^{(k)} = W_{csp}^T C_i^{(k)} W_{csp}\n$$\n$Z_i^{(k)}$ 是一个 $2m \\times 2m$ 的矩阵，其对角线元素表示试验数据投影到 $2m$ 个CSP滤波器上各自的方差。设这些方差组成的向量为 $v_i^{(k)} = \\operatorname{diag}(Z_i^{(k)})$。\n\n为了创建对整体信号功率不变的特征，该方差向量通过其总和进行归一化：\n$$\np_i^{(k)} = \\frac{v_i^{(k)}}{\\sum_{j=1}^{2m} (v_i^{(k)})_j}\n$$\n$p_i^{(k)}$ 的分量可以解释为每个滤波后的通道对投影空间中总方差的相对贡献。最后，对每个分量应用自然对数，以生成该次试验的特征向量 $f_i^{(k)}$，这有助于使特征分布更接近高斯分布：\n$$\nf_i^{(k)} = \\ln(p_i^{(k)})\n$$\n该向量的分量 $(f_i^{(k)})_j$ 即为用于分类的特征。\n\n**4. 使用Fisher准则评估特征可分性**\n\n为了量化 $2m$ 个提取出的特征中每一个区分两个类别的效果，我们使用Fisher准则（也称为Fisher判别比）。对于每个特征维度 $j \\in \\{1, \\dots, 2m\\}$，我们有一组类别1的值 $\\{ (f_i^{(1)})_j \\}_{i=1}^{N_1}$ 和一组类别2的值 $\\{ (f_i^{(2)})_j \\}_{i=1}^{N_2}$。\n\n我们为每个类别和每个特征维度计算样本均值和样本方差：\n$$\n\\mu_{k,j} = \\frac{1}{N_k} \\sum_{i=1}^{N_k} (f_i^{(k)})_j\n$$\n$$\n\\sigma_{k,j}^2 = \\frac{1}{N_k - 1} \\sum_{i=1}^{N_k} \\left( (f_i^{(k)})_j - \\mu_{k,j} \\right)^2\n$$\n特征 $j$ 的Fisher准则，记为 $F_j$，是类别均值之差的平方与类别方差之和的比率：\n$$\nF_j = \\frac{(\\mu_{1,j} - \\mu_{2,j})^2}{\\sigma_{1,j}^2 + \\sigma_{2,j}^2}\n$$\n较大的 $F_j$ 表示该特征维度具有更好的可分性。为了数值稳定性，特别是当方差接近于零时，按照规定在分母中添加一个小的常数 $\\delta = 10^{-12}$：\n$$\nF_j = \\frac{(\\mu_{1,j} - \\mu_{2,j})^2}{\\sigma_{1,j}^2 + \\sigma_{2,j}^2 + \\delta}\n$$\n\n**5. 最终输出生成**\n\n对于每个测试用例，计算出的 $2m$ 个Fisher分数 $\\{F_j\\}$ 按降序排序。然后将每个分数四舍五入到六位小数。最终输出的结构是一个列表的列表，每个内部列表包含一个测试用例的已排序和舍入的分数。",
            "answer": "```\n[[213.910309,213.910309],[0.000000,0.000000],[217.436329,217.436329]]\n```"
        }
    ]
}