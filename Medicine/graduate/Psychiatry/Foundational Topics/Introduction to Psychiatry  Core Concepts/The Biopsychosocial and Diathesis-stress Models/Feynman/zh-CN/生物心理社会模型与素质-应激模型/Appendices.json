{
    "hands_on_practices": [
        {
            "introduction": "要将素质-应激模型的理论应用于临床实践，关键一步是能够使用该模型来评估具体个体的风险。这项练习提供了一个基于真实研究场景的假设性练习，您将使用逻辑回归模型的系数来计算一个具有特定遗传风险和压力水平的个体的抑郁症发作概率。通过这个计算 ，您将学习如何将抽象的统计参数转化为有临床意义的、可解释的风险预测。",
            "id": "4765949",
            "problem": "一项为期$12$个月的首发重度抑郁发作的前瞻性队列研究，在素质-压力模型框架下进行建模。该模型假设发病概率取决于个体的易感性（素质）和压力暴露水平。在该队列中，素质被操作化为以标准差单位表示的标准化多基因风险评分（PRS；Polygenic Risk Score），压力暴露则被概括为一个在经过验证的$0$到$3$量表上的连续压力指数$S$。为将预测因子与发病概率联系起来，该研究使用了一个与素质-压力模型及基因-环境（G$\\times$E；Gene-by-Environment）交互作用相符的逻辑回归模型：\n$$\n\\mathrm{logit}(p) \\equiv \\ln\\!\\left(\\frac{p}{1-p}\\right) = \\beta_{0} + \\beta_{G}\\,PRS + \\beta_{S}\\,S + \\beta_{G\\times E}\\,PRS\\cdot S,\n$$\n其中$p$是在$12$个月内发作的概率。\n\n假设该队列的代表性人群训练数据得出以下系数：$\\beta_{0} = -3.2$，$\\beta_{G} = 0.45$，$\\beta_{S} = 0.55$以及$\\beta_{G\\times E} = 0.20$。对于一个个体，其$PRS = 1.2$且$S = 2.0$：\n\n1. 从素质-压力模型的核心定义和逻辑连接函数的性质出发，推导预测发病概率$p$关于线性预测子和逆logit变换的解析表达式，然后计算在给定$PRS$和$S$值下的数值。\n2. 简要解释所得概率相对于$\\beta_{0}$所隐含的基线风险以及$\\beta_{G\\times E}$的符号所具有的临床相关性。\n\n将预测概率$p$表示为$[0,1]$区间内的一个无单位标量，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "要计算并解释给定个体的抑郁发作概率，我们遵循以下步骤：\n\n**第1部分：推导并计算发病概率 ($p$)**\n\n首先，我们根据逻辑回归模型推导概率 $p$ 的表达式。模型将结果的对数几率（logit）定义为预测因子的线性组合。设线性预测子为 $\\eta$：\n$$\n\\eta = \\beta_{0} + \\beta_{G}\\,PRS + \\beta_{S}\\,S + \\beta_{G\\times E}\\,PRS\\cdot S\n$$\n模型的核心方程是 $\\ln(p/(1-p)) = \\eta$。为了解出 $p$，我们应用逆logit变换（也称为逻辑S型函数）：\n$$\np = \\frac{e^{\\eta}}{1 + e^{\\eta}} = \\frac{1}{1 + e^{-\\eta}}\n$$\n现在，我们将给定的系数值和个体数据代入线性预测子 $\\eta$ 的方程中：\n- $\\beta_{0} = -3.2$\n- $\\beta_{G} = 0.45$\n- $\\beta_{S} = 0.55$\n- $\\beta_{G\\times E} = 0.20$\n- $PRS = 1.2$\n- $S = 2.0$\n\n计算 $\\eta$：\n$$\n\\eta = -3.2 + (0.45)(1.2) + (0.55)(2.0) + (0.20)(1.2)(2.0)\n$$\n$$\n\\eta = -3.2 + 0.54 + 1.10 + 0.48\n$$\n$$\n\\eta = -3.2 + 2.12 = -1.08\n$$\n接下来，我们将 $\\eta = -1.08$ 代入概率 $p$ 的表达式中：\n$$\np = \\frac{1}{1 + e^{-(-1.08)}} = \\frac{1}{1 + e^{1.08}}\n$$\n计算指数项，$e^{1.08} \\approx 2.944683$。\n$$\np \\approx \\frac{1}{1 + 2.944683} = \\frac{1}{3.944683} \\approx 0.253496\n$$\n根据要求，将结果四舍五入至四位有效数字，我们得到预测的发病概率为 $p = 0.2535$。\n\n**第2部分：临床相关性解释**\n\n1.  **相对于基线风险的解释**：截距 $\\beta_0 = -3.2$ 代表了在没有遗传风险（$PRS = 0$）和没有压力（$S = 0$）的情况下的基线对数几率。对应的基线概率为 $p_{\\text{baseline}} = 1 / (1 + e^{-(-3.2)}) \\approx 0.039$，即约 $3.9\\%$。我们计算出的该个体的风险 $p \\approx 25.35\\%$，显著高于基线风险。这表明，该个体较高的遗传素质和压力水平使其抑郁发作的风险远超普通水平。\n\n2.  **交互作用效应的解释**：交互作用项的系数 $\\beta_{G\\times E} = 0.20$ 是一个正数，这在数学上证实了素质-压力模型的“协同效应”假说。这意味着，压力的负面影响并非恒定，而是被个体的遗传易感性所放大。对于这位具有高遗传风险（$PRS=1.2$）的个体，压力（$S=2.0$）对他抑郁风险的提升作用，要比对一个遗传风险较低的人更大。具体来说，交互作用项为对数几率 $\\eta$ 贡献了 $0.20 \\times 1.2 \\times 2.0 = 0.48$ 的增量，这个风险的增加是在基因和压力的独立效应之外的“额外”风险，体现了“1+1>2”的协同作用。",
            "answer": "$$\n\\boxed{0.2535}\n$$"
        },
        {
            "introduction": "在能够应用模型之后，更深层次的理解来自于剖析其数学结构。这项练习将引导您从第一性原理出发，推导素质-应激模型在逻辑回归框架下的风险函数，并揭示交互作用系数的深刻含义。这项推导练习  旨在巩固您对模型核心机制的理解，阐明交互作用项如何从数学上捕捉“易感性放大了压力效应”这一核心概念。",
            "id": "4765951",
            "problem": "精神病学中素质-应激框架的一个核心论点是，某种障碍的发病概率取决于个体的素质（类特质易感性）和环境应激，并且它们的共同效应可能不是纯粹可加的。考虑在一个固定的观察窗口内，某种障碍的二元发病指标 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示发病。令 $D \\in \\mathbb{R}$ 表示连续的素质得分，$S \\in \\mathbb{R}$ 表示连续的应激暴露得分。\n\n使用以下基本建模假设：\n- 发病指标 $Y$ 被建模为一个成功概率为 $p(D,S)$ 的伯努利随机变量。\n- 发病几率定义为 $\\frac{p(D,S)}{1 - p(D,S)}$。\n- 在具有伯努利结果的广义线性模型 (GLM) 中使用的对数几率 (logit) 关联函数通过变换 $\\ln\\!\\left(\\frac{p(D,S)}{1 - p(D,S)}\\right)$ 将期望值与线性预测变量关联起来。\n- 根据素质-应激模型的精神，假设线性预测变量在 $D$ 和 $S$ 的主效应上是可加的，并包含它们的乘积以允许交互作用。\n\n任务：\n1) 仅从上述定义以及对数几率尺度上线性预测变量的可加性出发，推导出风险函数 $p(D,S)$ 的闭式表达式。该表达式应包含一个截距、$D$ 和 $S$ 的线性主效应以及它们的交互作用。用系数 $\\beta_{0}$、$\\beta_{D}$、$\\beta_{S}$ 和 $\\beta_{DS}$ 表示结果。\n\n2) 将在固定素质水平 $D$ 下，应激增加一个单位时的应激优势比定义为\n$$\\mathrm{OR}_{S}(D) \\equiv \\frac{\\text{odds of onset at }(D,S+1)}{\\text{odds of onset at }(D,S)}.$$\n用这些系数推导出 $\\mathrm{OR}_{S}(D)$。\n\n3) 将素质对应激效应的调节强度定义为当素质增加一个单位时，应激优势比的比率：\n$$M \\equiv \\frac{\\mathrm{OR}_{S}(D+1)}{\\mathrm{OR}_{S}(D)}.$$\n提供 $M$ 的一个简化的、用模型系数表示的闭式解析表达式。仅报告此最终表达式作为您的答案。不要包含单位。如果在中间步骤中得到数值，请勿四舍五入；最终交付的是一个符号表达式。",
            "solution": "本题要求推导与一个形式化了素质-应激框架的 logistic 回归模型相关的三个量。该模型基于连续的素质得分 $D$ 和连续的应激得分 $S$ 来预测障碍发病的概率 $p(D,S)$。\n\n基本假设如下：\n1.  发病 $Y$ 是一个成功概率为 $p(D,S)$ 的伯努利试验。\n2.  模型使用 logit 关联函数，意味着发病的对数几率是预测变量的线性函数。\n3.  线性预测变量 $\\eta(D,S)$ 包括一个截距、$D$ 和 $S$ 的主效应以及它们的交互作用项。\n\n首先，我们使用给定的系数 $\\beta_{0}$、$\\beta_{D}$、$\\beta_{S}$ 和 $\\beta_{DS}$ 写出线性预测变量 $\\eta(D,S)$ 的表达式：\n$$ \\eta(D,S) = \\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS $$\n\nlogit 关联函数表明对数几率等于此线性预测变量：\n$$ \\ln\\left(\\frac{p(D,S)}{1 - p(D,S)}\\right) = \\eta(D,S) = \\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS $$\n\n任务 1：推导风险函数 $p(D,S)$ 的闭式表达式。\n为了求得 $p(D,S)$，我们必须对 logit 变换求逆。首先，我们对等式两边取指数以求解几率 $\\frac{p(D,S)}{1 - p(D,S)}$：\n$$ \\frac{p(D,S)}{1 - p(D,S)} = \\exp(\\eta(D,S)) = \\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS) $$\n为代数方便起见，令 $p = p(D,S)$ 且 $E = \\exp(\\eta(D,S))$。方程变为：\n$$ \\frac{p}{1-p} = E $$\n求解 $p$：\n$$ p = E(1-p) \\implies p = E - Ep \\implies p + Ep = E \\implies p(1+E) = E \\implies p = \\frac{E}{1+E} $$\n将 $E$ 的表达式代回，我们得到风险函数：\n$$ p(D,S) = \\frac{\\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS)}{1 + \\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS)} $$\n这就是任务 1 所需的表达式。\n\n任务 2：推导应激优势比 $\\mathrm{OR}_{S}(D)$。\n应激优势比是在素质 $D$ 水平固定时，应激 $S$ 增加一个单位的定义：\n$$ \\mathrm{OR}_{S}(D) \\equiv \\frac{\\text{odds of onset at }(D,S+1)}{\\text{odds of onset at }(D,S)} $$\n根据上一步，几率由 $\\exp(\\eta(D,S))$ 给出。\n在 $(D, S+1)$ 处的几率是：\n$$ \\text{odds}(D,S+1) = \\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}(S+1) + \\beta_{DS}D(S+1)) $$\n$$ = \\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{S} + \\beta_{DS}DS + \\beta_{DS}D) $$\n在 $(D, S)$ 处的几率是：\n$$ \\text{odds}(D,S) = \\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS) $$\n我们构成比率：\n$$ \\mathrm{OR}_{S}(D) = \\frac{\\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{S} + \\beta_{DS}DS + \\beta_{DS}D)}{\\exp(\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS)} $$\n使用指数性质 $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$，所得表达式的指数是分子指数与分母指数之差：\n$$ (\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{S} + \\beta_{DS}DS + \\beta_{DS}D) - (\\beta_{0} + \\beta_{D}D + \\beta_{S}S + \\beta_{DS}DS) = \\beta_{S} + \\beta_{DS}D $$\n因此，应激优势比为：\n$$ \\mathrm{OR}_{S}(D) = \\exp(\\beta_{S} + \\beta_{DS}D) $$\n\n任务 3：推导调节强度 $M$。\n最后一个任务是找到调节强度 $M$ 的简化表达式，其定义为：\n$$ M \\equiv \\frac{\\mathrm{OR}_{S}(D+1)}{\\mathrm{OR}_{S}(D)} $$\n我们使用任务 2 的结果。通过将 $D+1$ 代入 $\\mathrm{OR}_{S}(D)$ 的表达式来找到分子：\n$$ \\mathrm{OR}_{S}(D+1) = \\exp(\\beta_{S} + \\beta_{DS}(D+1)) = \\exp(\\beta_{S} + \\beta_{DS}D + \\beta_{DS}) $$\n分母是 $\\mathrm{OR}_{S}(D)$ 本身的表达式：\n$$ \\mathrm{OR}_{S}(D) = \\exp(\\beta_{S} + \\beta_{DS}D) $$\n构成 $M$ 的比率：\n$$ M = \\frac{\\exp(\\beta_{S} + \\beta_{DS}D + \\beta_{DS})}{\\exp(\\beta_{S} + \\beta_{DS}D)} $$\n同样，我们对指数做减法：\n$$ (\\beta_{S} + \\beta_{DS}D + \\beta_{DS}) - (\\beta_{S} + \\beta_{DS}D) = \\beta_{DS} $$\n因此，调节强度 $M$ 的简化的闭式表达式是：\n$$ M = \\exp(\\beta_{DS}) $$\n这个结果表明，在这个特定的交互作用对数线性模型中，调节强度 $M$ 是一个常数，并且仅取决于交互作用系数 $\\beta_{DS}$。这就是题目所要求的最终表达式。",
            "answer": "$$\n\\boxed{\\exp(\\beta_{DS})}\n$$"
        },
        {
            "introduction": "在精神病学研究中，我们常常面临不同理论模型的竞争，例如简单的相加模型与更复杂的交互作用模型。这项练习模拟了这一现实挑战，要求您比较相加模型和相乘（交互作用）模型对一组假设参与者的风险排序。通过计算并比较两种模型得出的风险指数和排序 ，您将亲身体会到模型结构的选择如何影响临床风险评估，并理解评估不同模型之间一致性的重要性。",
            "id": "4766023",
            "problem": "精神病学中素质-应激模型的一个核心前提是，障碍发作的概率随着稳定的易感性（素质）和环境应激暴露而单调增加。关于易感性与应激如何结合的两种广泛使用的结构性假设是加法公式和乘法公式。在加法设定中，风险指数随素质和应激线性增加。在乘法设定中，联合效应由它们的乘积捕捉，这反映了一种交互作用，与素质-应激模型所强调的协同放大效应一致。为了比较不同模型形式的个体水平预测，只需要单调风险指数的等级排序，因为任何严格递增变换都会保持等级不变。\n\n考虑五名研究参与者，索引为 $i \\in \\{1,2,3,4,5\\}$，他们测得的素质为 $D_i$（一个非负、无量纲的气質易感性得分），近期应激为 $S_i$（过去一年中加权重大生活事件的非负计数）。观测值如下：\n- 参与者 1：$D_1 = 2.0$，$S_1 = 4$\n- 参与者 2：$D_2 = 1.0$，$S_2 = 2$\n- 参与者 3：$D_3 = 3.0$，$S_3 = 1$\n- 参与者 4：$D_4 = 0.5$，$S_4 = 5$\n- 参与者 5：$D_5 = 1.5$，$S_5 = 3$\n\n将加法模型风险指数定义为 $r_A(i) = \\beta_D D_i + \\beta_S S_i$，系数为 $\\beta_D = 0.9$ 和 $\\beta_S = 0.5$。将乘法模型风险指数定义为 $r_M(i) = D_i \\times S_i$。假设得到的风险指数中没有相同值。\n\n使用以上信息，计算每位参与者的加法模型和乘法模型预测的风险指数，得出两种导出的等级排序，然后使用 Kendall's tau 系数量化这两种排序之间的一致性，其定义为\n$$\\tau = \\frac{C - D}{\\binom{n}{2}},$$\n其中 $n$ 是参与者人数，$C$ 是两种排序之间的一致对数量，$D$ 是不一致对的数量。将您对 $\\tau$ 的最终答案表示为精确值（不进行四舍五入）。不需要单位。",
            "solution": "第一步是计算 $n=5$ 名参与者在两种指定模型下的风险指数：加法模型 $r_A(i)$ 和乘法模型 $r_M(i)$。\n\n加法模型风险指数定义为 $r_A(i) = \\beta_D D_i + \\beta_S S_i$，给定系数为 $\\beta_D = 0.9$ 和 $\\beta_S = 0.5$。五名参与者的数据 $(D_i, S_i)$ 如下：\n- 参与者 1：$D_1 = 2.0$，$S_1 = 4$\n- 参与者 2：$D_2 = 1.0$，$S_2 = 2$\n- 参与者 3：$D_3 = 3.0$，$S_3 = 1$\n- 参与者 4：$D_4 = 0.5$，$S_4 = 5$\n- 参与者 5：$D_5 = 1.5$，$S_5 = 3$\n\n计算每位参与者的 $r_A(i)$：\n- $r_A(1) = (0.9)(2.0) + (0.5)(4) = 1.8 + 2.0 = 3.8$\n- $r_A(2) = (0.9)(1.0) + (0.5)(2) = 0.9 + 1.0 = 1.9$\n- $r_A(3) = (0.9)(3.0) + (0.5)(1) = 2.7 + 0.5 = 3.2$\n- $r_A(4) = (0.9)(0.5) + (0.5)(5) = 0.45 + 2.5 = 2.95$\n- $r_A(5) = (0.9)(1.5) + (0.5)(3) = 1.35 + 1.5 = 2.85$\n\n乘法模型风险指数定义为 $r_M(i) = D_i \\times S_i$。\n计算每位参与者的 $r_M(i)$：\n- $r_M(1) = 2.0 \\times 4 = 8.0$\n- $r_M(2) = 1.0 \\times 2 = 2.0$\n- $r_M(3) = 3.0 \\times 1 = 3.0$\n- $r_M(4) = 0.5 \\times 5 = 2.5$\n- $r_M(5) = 1.5 \\times 3 = 4.5$\n\n接下来，我们确定每个模型的等级排序，从最低风险（等级1）到最高风险（等级5）。\n\n对于加法模型，排序后的得分为：\n1.9 (参与者 2)\n2.85 (参与者 5)\n2.95 (参与者 4)\n3.2 (参与者 3)\n3.8 (参与者 1)\n对于参与者 $(1, 2, 3, 4, 5)$，等级排序（记为 $R_A$）为 $(5, 1, 4, 3, 2)$。\n\n对于乘法模型，排序后的得分为：\n2.0 (参与者 2)\n2.5 (参与者 4)\n3.0 (参与者 3)\n4.5 (参与者 5)\n8.0 (参与者 1)\n对于参与者 $(1, 2, 3, 4, 5)$，等级排序（记为 $R_M$）为 $(5, 1, 3, 2, 4)$。\n\n为了计算 Kendall's tau, $\\tau$，我们需要计算两种排序之间的一致对 ($C$) 和不一致对 ($D$) 的数量。如果一对参与者 $(i, j)$ 在两种排序中的等级顺序相同（即 $R_A(i)  R_A(j)$ 且 $R_M(i)  R_M(j)$，或 $R_A(i) > R_A(j)$ 且 $R_M(i) > R_M(j)$），则该对是一致的。如果他们的等级顺序相反，则该对是不一致的。参与者对的总数为 $\\binom{n}{2} = \\binom{5}{2} = \\frac{5 \\times 4}{2} = 10$。\n\n让我们列出每位参与者 $i$ 的配对等级 $(R_A(i), R_M(i))$：\n- 参与者 1: $(5, 5)$\n- 参与者 2: $(1, 1)$\n- 参与者 3: $(4, 3)$\n- 参与者 4: $(3, 2)$\n- 参与者 5: $(2, 4)$\n\n我们现在检查所有 $10$ 对参与者：\n1. 对 (1, 2)：等级为 $(5, 5)$ 和 $(1, 1)$。由于 $5>1$ 且 $5>1$，该对是一致的。\n2. 对 (1, 3)：等级为 $(5, 5)$ 和 $(4, 3)$。由于 $5>4$ 且 $5>3$，该对是一致的。\n3. 对 (1, 4)：等级为 $(5, 5)$ 和 $(3, 2)$。由于 $5>3$ 且 $5>2$，该对是一致的。\n4. 对 (1, 5)：等级为 $(5, 5)$ 和 $(2, 4)$。由于 $5>2$ 且 $5>4$，该对是一致的。\n5. 对 (2, 3)：等级为 $(1, 1)$ 和 $(4, 3)$。由于 $14$ 且 $13$，该对是一致的。\n6. 对 (2, 4)：等级为 $(1, 1)$ 和 $(3, 2)$。由于 $13$ 且 $12$，该对是一致的。\n7. 对 (2, 5)：等级为 $(1, 1)$ 和 $(2, 4)$。由于 $12$ 且 $14$，该对是一致的。\n8. 对 (3, 4)：等级为 $(4, 3)$ 和 $(3, 2)$。由于 $4>3$ 且 $3>2$，该对是一致的。\n9. 对 (3, 5)：等级为 $(4, 3)$ 和 $(2, 4)$。由于 $4>2$ 但 $34$，该对是不一致的。\n10. 对 (4, 5)：等级为 $(3, 2)$ 和 $(2, 4)$。由于 $3>2$ 但 $24$，该对是不一致的。\n\n根据此分析，我们得到 $C=8$ 个一致对和 $D=2$ 个不一致对。总对数为 $C+D = 8+2=10$，与 $\\binom{5}{2}$ 相符。\n\n最后，我们使用公式 $\\tau = \\frac{C - D}{\\binom{n}{2}}$ 计算 Kendall's tau 系数。\n代入数值：\n$$ \\tau = \\frac{8 - 2}{10} = \\frac{6}{10} $$\n化简分数得到：\n$$ \\tau = \\frac{3}{5} $$\n该值表示对于此特定数据集，加法模型和乘法模型之间等级排序的一致性程度。",
            "answer": "$$ \\boxed{\\frac{3}{5}} $$"
        }
    ]
}