{
    "hands_on_practices": [
        {
            "introduction": "在循证精神病学中，将研究结果转化为具有临床意义的指标至关重要。本练习旨在从临床试验提供的复发概率数据中，计算需治疗人数（$NNT$），这是一个强有力的工具，用于理解维持治疗的实际效果。掌握这项技能有助于临床医生更好地向患者传达治疗的益处。",
            "id": "4754068",
            "problem": "一项针对接受抗抑郁药物治疗后病情缓解的复发性重度抑郁症成年患者的随机、双盲、停药试验报告称，在$12$个月内，分配到停药组的患者复发概率为$40\\%$，而分配到继续用药组的患者复发概率为$20\\%$。请使用基本原理定义，将风险视为在固定时间范围内事件发生的概率，并将预防效果量化为在同一时间范围内由干预措施引起的概率差异，从这些基本定义中推导出以患者为中心的衡量指标，以回答以下问题：“为在$12$个月的时间范围内预防额外一例复发，需要有多少患者持续进行$12$个月的抗抑郁药物维持治疗而不是停药？”然后，根据给定数据计算其值。请以单个精确整数形式提供最终结果，无需四舍五入。此外，请简要用文字解释该值在临床上的意义，但您提交的数值答案必须仅为所要求的整数。",
            "solution": "首先从临床流行病学中风险的基本概率解释开始：对于一个固定的时间范围，一组中的绝对风险是在该时间范围内经历事件的概率。令 $p_{d}$ 表示停药情况下$12$个月内的绝对复发风险，令 $p_{c}$ 表示继续用药情况下$12$个月内的绝对复发风险。该试验提供的数据为 $p_{d} = 0.40$ 和 $p_{c} = 0.20$。\n\n在同一时间范围内，于群体水平上量化预防效果的一个基本方法是绝对风险降低值，其根据基本原理定义为该时间范围内由干预措施引起的绝对风险之差，即\n$$\n\\Delta p \\equiv p_{d} - p_{c}.\n$$\n该数量代表在指定时间范围内，每名接受治疗的个体所避免的事件的预期数量。\n\n为了将每个个体的事件差异转换为产生一个被避免的事件所需个体数量，我们取其倒数，得到需治愈人数 (NNT)，定义为\n$$\n\\mathrm{NNT} \\equiv \\frac{1}{\\Delta p} = \\frac{1}{p_{d} - p_{c}}.\n$$\n代入所提供的风险值得\n$$\n\\Delta p = 0.40 - 0.20 = 0.20,\n$$\n因此\n$$\n\\mathrm{NNT} = \\frac{1}{0.20} = 5.\n$$\n\n临床意义解释：在与该试验相似的条件下，对于一个$12$个月的时间范围，且停药的基线风险接近$0.40$时，对$5$名可比患者继续进行抗抑郁药物维持治疗而非停药，平均而言，将在$12$个月内预防$1$例额外的复发。此解释假设基线风险稳定，并且绝对风险差适用于所述时间范围内的目标人群；NNT是特定于时间范围并依赖于基线风险的。\n\n所要求的数值答案是上面计算出的精确整数。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "心境障碍的复发是一个随时间展开的过程。本练习超越了固定时间点的风险评估，转而使用生存分析来探索复发的动态过程。通过在比例风险假设下，从生存概率推导出风险比（$HR$），您将更深入地理解如何量化干预措施在整个时间过程中的持续保护作用。",
            "id": "4754090",
            "problem": "一项针对心境障碍患者的随机维持治疗试验，比较了常规护理与结构化维持干预在预防复发方面的效果。根据Kaplan–Meier曲线，常规护理组在$12$个月时的估计无复发生存率为 $S_{\\text{usual}}(12) = 0.60$，维持治疗组为 $S_{\\text{maint}}(12) = 0.75$。假设采用Cox比例风险（PH）模型，治疗组间的风险比不随时间变化，并仅以风险函数、累积风险函数和生存函数之间的基本关系作为出发点。请从第一性原理出发，推导一个基于同一时间点的两个生存概率的恒定风险比表达式，并使用给定数据计算其数值。将最终答案四舍五入至$4$位有效数字。最终答案中不要包含单位。",
            "solution": "问题要求在Cox比例风险（PH）模型下，根据两个组在特定时间点的生存概率推导出恒定风险比（$HR$）。推导必须从连接生存函数$S(t)$、风险函数$h(t)$和累积风险函数$H(t)$的基本关系开始。\n\n设$t$为时间变量。生存函数与累积风险函数之间的基本关系是：\n$$S(t) = \\exp(-H(t))$$\n其中累积风险函数是风险函数从时间$0$到$t$的积分：\n$$H(t) = \\int_0^t h(u) \\, du$$\n\n设常规护理组为参照组，维持治疗组为干预组。我们用下标 'usual' 和 'maint' 分别表示它们各自的函数。\n\n对于常规护理组，其生存函数为：\n$$S_{\\text{usual}}(t) = \\exp(-H_{\\text{usual}}(t)) = \\exp\\left(-\\int_0^t h_{\\text{usual}}(u) \\, du\\right)$$\n\n对于维持治疗组，其生存函数为：\n$$S_{\\text{maint}}(t) = \\exp(-H_{\\text{maint}}(t)) = \\exp\\left(-\\int_0^t h_{\\text{maint}}(u) \\, du\\right)$$\n\nCox比例风险模型假设两组之间的风险比不随时间变化。风险比$HR$定义为干预组的风险函数与参照（常规护理）组的风险函数之比：\n$$HR = \\frac{h_{\\text{maint}}(t)}{h_{\\text{usual}}(t)}$$\n由于$HR$是常数，我们可以写出对于所有$t \\ge 0$，$h_{\\text{maint}}(t) = HR \\cdot h_{\\text{usual}}(t)$。\n\n我们现在可以用常规护理组的累积风险来表示维持治疗组的累积风险。\n$$H_{\\text{maint}}(t) = \\int_0^t h_{\\text{maint}}(u) \\, du = \\int_0^t (HR \\cdot h_{\\text{usual}}(u)) \\, du$$\n因为$HR$是一个常数，所以可以将其从积分中提出来：\n$$H_{\\text{maint}}(t) = HR \\cdot \\int_0^t h_{\\text{usual}}(u) \\, du = HR \\cdot H_{\\text{usual}}(t)$$\n\n现在，我们将生存函数联系起来。我们有维持治疗组的生存函数表达式：\n$$S_{\\text{maint}}(t) = \\exp(-H_{\\text{maint}}(t))$$\n代入关系式$H_{\\text{maint}}(t) = HR \\cdot H_{\\text{usual}}(t)$：\n$$S_{\\text{maint}}(t) = \\exp(-HR \\cdot H_{\\text{usual}}(t))$$\n\n从常规护理组的生存函数$S_{\\text{usual}}(t) = \\exp(-H_{\\text{usual}}(t))$，我们可以通过对两边取自然对数来表示累积风险$H_{\\text{usual}}(t)$：\n$$\\ln(S_{\\text{usual}}(t)) = -H_{\\text{usual}}(t)$$\n$$H_{\\text{usual}}(t) = -\\ln(S_{\\text{usual}}(t))$$\n\n将$H_{\\text{usual}}(t)$的这个表达式代入$S_{\\text{maint}}(t)$的方程中：\n$$S_{\\text{maint}}(t) = \\exp(-HR \\cdot [-\\ln(S_{\\text{usual}}(t))])$$\n$$S_{\\text{maint}}(t) = \\exp(HR \\cdot \\ln(S_{\\text{usual}}(t)))$$\n使用对数性质$a \\ln(b) = \\ln(b^a)$，我们得到：\n$$S_{\\text{maint}}(t) = \\exp(\\ln([S_{\\text{usual}}(t)]^{HR}))$$\n由于指数函数和自然对数函数是互逆的，这可以简化为：\n$$S_{\\text{maint}}(t) = [S_{\\text{usual}}(t)]^{HR}$$\n\n为了推导出$HR$的显式表达式，我们对这个方程的两边取自然对数：\n$$\\ln(S_{\\text{maint}}(t)) = \\ln([S_{\\text{usual}}(t)]^{HR})$$\n再次使用对数幂法则：\n$$\\ln(S_{\\text{maint}}(t)) = HR \\cdot \\ln(S_{\\text{usual}}(t))$$\n解出$HR$，我们得到所需的表达式：\n$$HR = \\frac{\\ln(S_{\\text{maint}}(t))}{\\ln(S_{\\text{usual}}(t))}$$\n这个表达式对于任何时间$t > 0$都有效，只要生存概率已知且不等于$1$。\n\n问题提供了在$t = 12$个月时的生存概率：\n$S_{\\text{usual}}(12) = 0.60$\n$S_{\\text{maint}}(12) = 0.75$\n\n将这些值代入推导出的$HR$表达式中：\n$$HR = \\frac{\\ln(0.75)}{\\ln(0.60)}$$\n我们计算对数的数值：\n$$\\ln(0.75) \\approx -0.28768207$$\n$$\\ln(0.60) \\approx -0.51082562$$\n现在，我们计算比率：\n$$HR \\approx \\frac{-0.28768207}{-0.51082562} \\approx 0.56317004$$\n问题要求答案四舍五入到$4$位有效数字。\n$$HR \\approx 0.5632$$\n小于$1$的风险比表明维持干预具有保护作用，这意味着在任何给定时间，该组患者的复发率都低于接受常规护理的患者，这与观察到的更高生存概率（$0.75 > 0.60$）相一致。",
            "answer": "$$\\boxed{0.5632}$$"
        },
        {
            "introduction": "预测哪些患者具有最高的复发风险是精神病学中个体化医疗的一个关键目标。这项综合性练习要求您设计一套稳健的方法学，用于根据队列数据创建并验证一个多变量复发风险评分模型。此练习整合了生物统计学的多项原则，从模型设定、处理缺失数据到严格的验证流程，反映了开发临床预测工具的完整生命周期。",
            "id": "4754094",
            "problem": "一项针对$N=600$名重度抑郁症成年人的前瞻性队列研究进行了为期$12$个月的随访，以评估复发（重度抑郁发作的复现，且满足诊断阈值标准）的风险。二元结局$Y$表示$12$个月内是否复发，$Y=1$表示复发，$Y=0$表示未复发。在缓解期测量了$p=8$个预先指定的临床预测因素：使用汉密尔顿抑郁量表（HDRS；Hamilton Depression Rating Scale (HDRS) 总分范围为$0$到$52$）评估的残留症状、既往发作次数、共病焦虑诊断（是/否）、过去$3$个月内服用抗抑郁药剂量的比例（依从性比例，介于$0$和$1$之间）、社会心理压力指数（连续变量）、既往自杀未遂史（是/否）、睡眠规律性指数（连续变量）以及有害饮酒行为（是/否）。$N=582$名参与者完成了随访，观察到$180$例复发，每个基线预测变量的数据在约$5\\%$到$10\\%$的参与者中存在缺失。临床目标是构建一个多变量复发风险评分，该评分能对这些因素进行适当加权，以估计个体在$12$个月内复发的概率，并描述如何校准和验证该模型。\n\n鉴于该研究的特征，哪个选项最能描述一种在方法学上合理的方法，用于构建加权多变量风险评分，并对其进行校准和验证，以预测抑郁症的$12$个月复发率？\n\nA. 基于临床相关性预先指定$p=8$个预测因素，并使用最大似然法拟合关于$Y$的多变量逻辑回归模型，采用链式方程多重插补（MICE）处理预测变量的缺失值，通过Rubin法则合并$m$次插补的估计值。使用估计的对数优势比系数为每个因素加权，可选择性地通过除以一个选定的常数（例如，$\\ln(2)$，以将$1$分解释为优势比加倍）并对所有预测因素求和，将其转换为整数评分，再通过逻辑函数将总分映射为绝对风险。使用受试者工作特征曲线下面积（AUC；Receiver Operating Characteristic (ROC) curve area）评估区分度，并使用Brier分数评估总体性能。评估整体校准度（平均预测风险与观察事件率的一致性）、校准斜率（通过将观察结局对预测对数优势比进行回归）和一条平滑的校准曲线。使用自助法重抽样（例如，$B=200$到$B=1000$次重抽样）进行内部验证，以估计并减去区分度和校准度指标中的乐观偏倚，并在可能的情况下，在一个时间上不同或地理上独立的队列中进行外部验证。\n\nB. 在$\\alpha=0.05$的水平上使用单变量检验筛选预测因素，仅将显著的预测因素纳入多变量模型，在简单求和中为所有纳入的预测因素分配相等权重，并将分类复发风险的决策阈值设置在观察到的患病率（$0.31$）以实现校准。通过将样本分为$50\\%$的训练集和$50\\%$的测试集进行验证，并使用准确度和ROC曲线的Youden指数评估性能；如果准确度高，则认为校准评估是不必要的。\n\nC. 使用Cox比例风险模型对复发时间进行建模，并通过将从训练数据中得出的恒定基线风险应用于所有个体来估计$12$个月的风险。使用Hosmer–Lemeshow拟合优度检验评估校准度，并使用留一法交叉验证来验证模型；区分度仅通过一致性指数进行评估，不进行乐观偏倚校正。\n\nD. 将所有预测因素标准化为$z$-分数，并通过对标准化值求和来构建风险评分，而不拟合概率模型。通过使用普通最小二乘法将二元结局对$z$-分数总和进行回归来校准评分，并使用$k=5$的$k$-折交叉验证进行验证，报告用于校准的ROC曲线和作为主要指标的均方误差。\n\nE. 使用嵌套$k$-折交叉验证选择惩罚项，拟合带有最小绝对收缩和选择算子（LASSO; Least Absolute Shrinkage and Selection Operator (LASSO)）的逻辑回归，并使用Platt缩放对预测概率进行后处理以改善校准。通过惩罚后的系数对临床因素进行加权，仅使用交叉验证进行验证，并报告AUC和准确度；如果交叉验证的AUC很高，则外部验证是不必要的。",
            "solution": "### 方法学上合理方法的推导\n\n目标是为一个在固定时间点（$12$个月）的二元结局（$Y \\in \\{0, 1\\}$）建立、校准和验证一个风险评分。\n\n1.  **模型选择：** 对于二元结局，逻辑回归是自然且标准的选择。它将结局发生优势比的对数建模为预测因素的线性函数：\n    $$ \\ln\\left(\\frac{P(Y=1|\\mathbf{X})}{1 - P(Y=1|\\mathbf{X})}\\right) = \\beta_0 + \\beta_1 X_1 + \\dots + \\beta_p X_p $$\n    系数（$\\beta_i$）通过最大似然法估计，代表与每个预测因素相关的对数优势比，从而提供数据驱动的权重。\n\n2.  **处理预测因素：** 问题指出，$p=8$个预测因素是基于临床相关性预先指定的。这是极佳的做法。将所有预先指定的预测因素纳入多变量模型是正确的方法，特别是考虑到充足的每个变量事件数比率。单变量筛选等方法已知存在缺陷，应予以避免。\n\n3.  **处理缺失数据：** 每个预测因素有$5\\%$到$10\\%$的缺失数据，完整病例分析效率低下（损失统计功效）且可能存在偏倚，除非数据是完全随机缺失（MCAR），这是一个很强且通常不切实际的假设。处理这种情况的现代标准方法是**多重插补（MI）**，通常通过**链式方程（MICE）**实现。该方法假设数据是随机缺失（MAR），这是一个限制较少的假设。该过程包括通过插补缺失值创建多个（$m$）完整数据集，在每个数据集上拟合逻辑回归模型，然后使用Rubin法则合并结果（系数和标准误）。\n\n4.  **风险评分构建：** 拟合的逻辑回归模型的线性预测器 $\\sum_{i=1}^p \\hat{\\beta}_i X_i$ 就是加权风险评分。为了临床应用，可以通过缩放和舍入$\\hat{\\beta_i}$系数，将其简化为基于分数的系统。例如，将每个$\\hat{\\beta_i}$除以一个常数（如$\\ln(2)$）并舍入，将得到整数分数，其中每一点对应于复发优势比的大约两倍。总分可以通过逻辑函数映射回绝对风险概率。\n\n5.  **性能评估：** 全面的评估必须包括：\n    -   **区分度：** 区分复发个体和未复发个体的能力。标准指标是**受试者工作特征曲线下面积（AUC）**，也称为C统计量。\n    -   **校准度：** 预测概率与观察到的事件频率之间的一致性。应通过**校准图**（绘制观察频率与预测概率的对比图）、**校准斜率**（应接近$1$）和**整体校准度**（比较平均预测风险与总体观察事件率）进行评估。\n    -   **总体性能：** **Brier分数**（预测概率与$0/1$结局之间的均方误差）是一个极好的综合度量，它同时包含了区分度和校准度。\n\n6.  **验证：** 模型在开发数据上的表现是乐观的。\n    -   **内部验证：** 为获得更现实的性能估计，必须估计并校正性能指标（如AUC和校准斜率）中的乐观偏倚。**自助法重抽样**是首选方法。它涉及在自助样本上重复拟合整个建模过程（包括插补），并在原始样本上评估性能以量化乐观偏倚。\n    -   **外部验证：** 模型的最终检验是在新的、独立的数据（例如，来自不同医院或国家）上的性能。这评估了模型的泛化能力，是验证的黄金标准。\n\n这个全面的工作流程代表了当前临床预测建模的最佳实践。\n\n### 逐项分析选项\n\n**A. 基于临床相关性预先指定$p=8$个预测因素，并使用最大似然法拟合关于$Y$的多变量逻辑回归模型，采用链式方程多重插补（MICE）处理预测变量的缺失值，通过Rubin法则合并$m$次插补的估计值。使用估计的对数优势比系数为每个因素加权，可选择性地通过除以一个选定的常数（例如，$\\ln(2)$，以将$1$分解释为优势比加倍）并对所有预测因素求和，将其转换为整数评分，再通过逻辑函数将总分映射为绝对风险。使用受试者工作特征曲线下面积（AUC；Receiver Operating Characteristic (ROC) curve area）评估区分度，并使用Brier分数评估总体性能。评估整体校准度（平均预测风险与观察事件率的一致性）、校准斜率（通过将观察结局对预测对数优势比进行回归）和一条平滑的校准曲线。使用自助法重抽样（例如，$B=200$到$B=1000$次重抽样）进行内部验证，以估计并减去区分度和校准度指标中的乐观偏倚，并在可能的情况下，在一个时间上不同或地理上独立的队列中进行外部验证。**\n此选项与推导出的方法学上合理的方法完全一致。它正确地指定了：（1）在多变量逻辑回归中使用所有预先指定的预测因素，（2）使用MICE处理缺失数据，（3）从模型系数构建风险评分，（4）使用适当的指标进行区分度（AUC）、校准度（图、斜率、整体）和总体性能（Brier分数）的评估，以及（5）采用最佳实践进行验证（用于内部验证的自助法，并提及外部验证作为理想情况）。提及“使用Brier分数评估总体准确性”在术语上稍有不精确，因为Brier分数衡量的是总体性能而不仅仅是准确性，但这并不影响该指标选择本身的有效性。\n**结论：正确**\n\n**B. 在$\\alpha=0.05$的水平上使用单变量检验筛选预测因素，仅将显著的预测因素纳入多变量模型，在简单求和中为所有纳入的预测因素分配相等权重，并将分类复发风险的决策阈值设置在观察到的患病率（$0.31$）以实现校准。通过将样本分为$50\\%$的训练集和$50\\%$的测试集进行验证，并使用准确度和ROC曲线的Youden指数评估性能；如果准确度高，则认为校准评估是不必要的。**\n此选项是糟糕统计实践的集合。单变量筛选存在偏倚。分配相等权重是武断的，忽略了数据。设置阈值无法实现校准。样本分割验证效率低下。准确度和Youden指数是用于风险模型的不良、依赖于阈值的指标。忽略校准是一个关键缺陷。\n**结论：错误**\n\n**C. 使用Cox比例风险模型对复发时间进行建模，并通过将从训练数据中得出的恒定基线风险应用于所有个体来估计$12$个月的风险。使用Hosmer–Lemeshow拟合优度检验评估校准度，并使用留一法交叉验证来验证模型；区分度仅通过一致性指数进行评估，不进行乐观偏倚校正。**\n此选项包含多个错误。虽然Cox模型是可行的，但通过应用“恒定基线风险”来估计风险是错误的；基线风险是时间的函数。Hosmer-Lemeshow检验是评估校准度的过时且次优的方法。留一法交叉验证的性能估计方差可能很高。评估一致性指数而不进行乐观偏倚校正，会对模型性能产生过于乐观的看法。\n**结论：错误**\n\n**D. 将所有预测因素标准化为$z$-分数，并通过对标准化值求和来构建风险评分，而不拟合概率模型。通过使用普通最小二乘法将二元结局对$z$-分数总和进行回归来校准评分，并使用$k=5$的$k$-折交叉验证进行验证，报告用于校准的ROC曲线和作为主要指标的均方误差。**\n此选项显示了对回归和模型评估的基本误解。创建$z$-分数的总和是一种幼稚的加权方案，忽略了变量的不同预测价值。对二元结局使用普通最小二乘法是不恰当的。关键的是，报告用于*校准*的ROC曲线在概念上是错误的；ROC曲线评估的是*区分度*。\n**结论：错误**\n\n**E. 使用嵌套$k$-折交叉验证选择惩罚项，拟合带有最小绝对收缩和选择算子（LASSO; Least Absolute Shrinkage and Selection Operator (LASSO)）的逻辑回归，并使用Platt缩放对预测概率进行后处理以改善校准。通过惩罚后的系数对临床因素进行加权，仅使用交叉验证进行验证，并报告AUC和准确度；如果交叉验证的AUC很高，则外部验证是不必要的。**\n此选项包含一些先进技术（LASSO，嵌套交叉验证），但最终提出了一个致命的方法学主张。虽然LASSO可以是一种有效的方法，但“如果交叉验证的AUC很高，则外部验证是不必要的”这一说法是一个严重错误。内部验证，无论多么严格，都不能取代外部验证来评估模型对新群体的泛化能力。在一个数据集中的高性能并不能保证在另一个数据集中的性能。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}