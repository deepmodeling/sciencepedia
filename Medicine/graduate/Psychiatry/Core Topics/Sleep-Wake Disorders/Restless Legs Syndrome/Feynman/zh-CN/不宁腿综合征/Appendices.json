{
    "hands_on_practices": [
        {
            "introduction": "不宁腿综合征 (RLS) 的管理始于对核心病理生理学的深刻理解，其中铁代谢紊乱尤为关键。本练习将理论与实践相结合，要求您根据标准的实验室数据计算转铁蛋白饱和度 (TSAT)，这是评估功能性铁缺乏的关键指标。通过这个基本计算 ，您将加强对 RLS 实验室评估及其对治疗决策影响的理解。",
            "id": "4754899",
            "problem": "作为循证管理的一部分，一位不宁腿综合征（RLS）患者正在接受铁缺乏评估。您获得了从同一样本血液中测得的以下实验室数值：血清铁 $I = 35\\,\\mu\\text{g/dL}$ 和总铁结合力 $C = 310\\,\\mu\\text{g/dL}$。从转铁蛋白饱和度的核心定义出发，即转铁蛋白铁结合位点被铁占据的比例，并且当 $I$ 和 $C$ 的浓度单位相同时，该饱和度比例等于比值 $I/C$。请计算转铁蛋白饱和度，结果表示为无单位小数。将您的答案四舍五入至四位有效数字。然后，根据在RLS中考虑补铁的常用临床决策阈值 $0.20$，判断计算出的值是否被认为是低的；在您的推理中包括此解释步骤，但仅报告计算出的饱和度作为您的最终数值答案（无单位）。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。它为得出唯一且有意义的解提供了所有必要的数据和定义。其临床背景和数值是现实的，并基于已建立的医疗实践。\n\n该问题要求根据给定的血清铁 ($I$) 和总铁结合力 ($C$) 的值来计算转铁蛋白饱和度 ($TS$)。\n\n给定的值为：\n- 血清铁, $I = 35\\,\\mu\\text{g/dL}$。\n- 总铁结合力, $C = 310\\,\\mu\\text{g/dL}$。\n\n问题陈述，转铁蛋白饱和度定义为转铁蛋白铁结合位点被铁占据的比例。当 $I$ 和 $C$ 以相同的浓度单位表示时，该比例通过以下比率计算：\n$$TS = \\frac{I}{C}$$\n\n由于 $I$ 和 $C$ 都以 $\\mu\\text{g/dL}$ 为单位，单位将相消，从而得到一个符合要求的无单位小数。将给定的数值代入方程中：\n$$TS = \\frac{35}{310}$$\n\n进行除法运算得到：\n$$TS \\approx 0.1129032258...$$\n\n问题要求将答案四舍五入至四位有效数字。前四位有效数字是 $1$、$1$、$2$ 和 $9$。第五位数字是 $0$，小于 $5$，所以我们不对最后一位有效数字进行进位。\n因此，四舍五入至四位有效数字的转铁蛋白饱和度是：\n$$TS \\approx 0.1129$$\n\n任务的第二部分是进行解释性步骤。问题提供了一个在不宁腿综合征患者中考虑补铁的临床决策阈值 $0.20$。我们需要根据这个阈值来判断计算出的值是否被认为是低的。\n\n为此，我们将我们计算出的 $TS$ 值与阈值进行比较：\n$$0.1129  0.20$$\n由于计算出的转铁蛋白饱和度 $0.1129$ 小于临床阈值 $0.20$，该值确实会被认为是低的，这表明根据给定的指南，应考虑为该患者进行补铁治疗。\n\n最终需要报告的答案仅为计算出的饱和度数值。",
            "answer": "$$\\boxed{0.1129}$$"
        },
        {
            "introduction": "在确定了潜在的病理生理因素后，下一步是制定安全有效的药物治疗方案。由于 RLS 患者常伴有肾功能不全等合并症，因此根据药代动力学原理调整剂量至关重要。本练习模拟了一个真实世界的临床挑战 ：为一名肾功能受损的 RLS 患者计算普瑞巴林的精确调整剂量，以在维持疗效的同时最大程度地降低风险。",
            "id": "4754876",
            "problem": "一名患有原发性不宁腿综合征的成年人正在接受普瑞巴林治疗。在肾功能正常，估计肾小球滤过率 (eGFR) 等于 $100$ mL/min 的情况下，每晚一次 $150$ mg 的剂量可达到理想的平均稳态浓度。普瑞巴林表现出线性、时不变的药代动力学特征，其口服生物利用度约等于 $1$，蛋白结合可忽略不计，主要以原形药物形式通过肾脏消除。假设在 $eGFR = 100$ mL/min 时，非肾清除率占总清除率的 $0.10$，并且在该关注范围内，清除率的肾脏部分与肾小球滤过率成正比。您正在评估一名中度肾功能损害的患者，其 $eGFR = 35$ mL/min。如果您希望在保持相同的每晚一次给药间隔的情况下，维持相同的平均稳态浓度，那么根据药代动力学基本原理，您会选择多大剂量（以 mg 为单位）的普瑞巴林？忽略饱和转运和分布容积的变化。将您的答案四舍五入至三位有效数字。最终剂量以 mg 表示。",
            "solution": "目标是在肾功能水平发生变化的情况下，维持相同的平均稳态浓度，同时保持给药间隔不变。对于具有线性药代动力学的药物，平均稳态浓度由下式给出\n$$\nC_{\\text{ss,avg}} = \\frac{F \\times D}{CL \\times \\tau},\n$$\n其中 $F$ 是生物利用度，$D$ 是每个给药间隔的剂量，$CL$ 是全身总清除率，$\\tau$ 是给药间隔。在 $F$ 和 $\\tau$ 不变的情况下，要维持相同的 $C_{\\text{ss,avg}}$，需要按清除率的比例调整剂量：\n$$\n\\frac{D_{\\text{new}}}{D_{\\text{old}}} = \\frac{CL_{\\text{new}}}{CL_{\\text{old}}}.\n$$\n\n设 $CL_{\\text{old}}$ 表示基线 $eGFR = 100$ mL/min 时的总清除率，并将清除率分解为肾清除部分和非肾清除部分：\n$$\nCL_{\\text{old}} = CL_{\\text{r,old}} + CL_{\\text{nr}}.\n$$\n根据假设，在基线时，非肾清除率是总清除率的一个恒定比例：\n$$\nCL_{\\text{nr}} = f_{\\text{nr}} \\, CL_{\\text{old}}, \\quad f_{\\text{nr}} = 0.10.\n$$\n因此，基线时的肾清除部分为\n$$\nCL_{\\text{r,old}} = (1 - f_{\\text{nr}})\\, CL_{\\text{old}}.\n$$\n\n假设肾清除率与肾小球滤过率成正比，对于肾功能受损且 $eGFR_{\\text{new}}$ 的情况，新的肾清除率为\n$$\nCL_{\\text{r,new}} = CL_{\\text{r,old}} \\times \\frac{eGFR_{\\text{new}}}{eGFR_{\\text{old}}}.\n$$\n新状态下的总清除率是非肾清除率（假设不变）和新肾清除率之和：\n$$\nCL_{\\text{new}} = CL_{\\text{nr}} + CL_{\\text{r,new}} = f_{\\text{nr}} \\, CL_{\\text{old}} + (1 - f_{\\text{nr}})\\, CL_{\\text{old}} \\times \\frac{eGFR_{\\text{new}}}{eGFR_{\\text{old}}}.\n$$\n这可以简化为以下比例关系\n$$\n\\frac{CL_{\\text{new}}}{CL_{\\text{old}}} = f_{\\text{nr}} + (1 - f_{\\text{nr}})\\, \\frac{eGFR_{\\text{new}}}{eGFR_{\\text{old}}}.\n$$\n\n代入给定值 $f_{\\text{nr}} = 0.10$，$eGFR_{\\text{new}} = 35$ mL/min，以及 $eGFR_{\\text{old}} = 100$ mL/min，\n$$\n\\frac{CL_{\\text{new}}}{CL_{\\text{old}}} = 0.10 + 0.90 \\times \\frac{35}{100} = 0.10 + 0.90 \\times 0.35 = 0.10 + 0.315 = 0.415.\n$$\n因此，新剂量为\n$$\nD_{\\text{new}} = D_{\\text{old}} \\times \\frac{CL_{\\text{new}}}{CL_{\\text{old}}} = 150 \\times 0.415 = 62.25 \\text{ mg}.\n$$\n按要求四舍五入至三位有效数字，得到 $62.3$ mg。药代动力学上的理由是，对于一种主要通过肾脏消除且具有线性动力学的药物，在给药间隔不变的情况下，要维持相同的平均稳态暴露量，需要按总清除率的比例调整剂量，而在此例中，总清除率主要由与肾小球滤过率成正比的肾脏部分和一个恒定的非肾脏部分构成。",
            "answer": "$$\\boxed{62.3}$$"
        },
        {
            "introduction": "卓越的临床实践不仅关注短期症状控制，更要预见和规划长期治疗策略，以避免如“增强现象”(augmentation) 等严重并发症。这项高级练习将您置于临床研究者和卫生经济学家的角色，要求您构建一个马尔可夫决策模型 。通过量化不同治疗路径的长期成本和效果，您将学会如何运用定量分析来支持循证医学决策，并理解为何某些一线疗法优于其他疗法。",
            "id": "4754914",
            "problem": "您的任务是根据马尔可夫性质，为不宁腿综合征的管理构建一个离散时间、有限范围的马尔可夫决策分析模型。该模型必须量化症状强化如何增加后续成本并降低效果。该系统定义在以下几个状态上，索引为 $0,1,2,3,4$：$0$ 无症状强化管理，$1$ 症状强化，$2$ 症状强化后转换治疗管理，$3$ 难治性症状，以及 $4$ 死亡。状态 $4$ 是吸收态。所有患者在周期 $t=0$ 时从状态 $0$ 开始。周期长度为 $1$ 年，总范围为 $T$ 个周期。您必须使用一个大小为 $5 \\times 5$ 的时间同质转移矩阵 $P$ 来实现马尔可夫状态演化，其中 $x_{t+1} = x_t P$，而 $x_t \\in \\mathbb{R}^{1 \\times 5}$ 是周期 $t$ 开始时各状态的概率分布。\n\n成本和效果按以下约定累积：\n- 每个周期的状态成本 $c_i$ 在每个周期 $t$ 开始时根据当前的占有率 $x_t$ 累积；转移成本 $c^{\\text{trans}}_{i \\rightarrow j}$ 在周期 $t$ 结束时，对于该周期内发生的转移 $i \\rightarrow j$ 而产生。\n- 成本以美元（USD）/患者年表示，并且必须使用恒定的年贴现率 $r_c$ 进行贴现，周期初贴现因子为 $d_c(t) = \\frac{1}{(1+r_c)^t}$，周期末贴现因子为 $d_c^{\\text{end}}(t) = \\frac{1}{(1+r_c)^{t+1}}$。\n- 效果以质量调整生命年（QALY）/患者年衡量，使用恒定的年贴现率 $r_q$ 进行贴现，贴现因子为 $d_q(t) = \\frac{1}{(1+r_q)^t}$。\n- 必须产出 $T$ 个周期内的总贴现成本 $C$ 和总贴现QALY $Q$，以及净货币效益 $NMB = \\lambda Q - C$，其中 $\\lambda$ 是支付意愿阈值，单位为美元/QALY。\n\n状态成本和效用：\n- 基线管理状态 $0$：成本 $c_0$ 和效用 $u_0$。\n- 症状强化状态 $1$：成本 $c_1 = c_0 \\cdot m_c^{\\text{aug}}$ 和效用 $u_1 = u_0 \\cdot (1 - m_u^{\\text{aug}})$。\n- 转换治疗后状态 $2$：成本 $c_2 = c_0 \\cdot m_c^{\\text{post}}$ 和效用 $u_2 = u_0 \\cdot (1 - m_u^{\\text{post}})$。\n- 难治性状态 $3$：成本 $c_3$ 和效用 $u_3$。\n- 死亡状态 $4$：$c_4 = 0$ 和 $u_4 = 0$。\n\n转移成本仅在两个具有临床意义的后续事件上非零：$c^{\\text{trans}}_{0 \\rightarrow 1} = c_{\\text{aug\\_workup}}$ 和 $c^{\\text{trans}}_{1 \\rightarrow 2} = c_{\\text{switch}}$；所有其他的 $c^{\\text{trans}}_{i \\rightarrow j} = 0$。\n\n每个周期的转移概率必须根据以下参数构建，其中 $p_{\\text{death}}$ 是每个周期的背景死亡概率：\n- 从状态 $0$：转移到 $1$ 的概率为 $p_{\\text{aug}}$，转移到 $4$ 的概率为 $p_{\\text{death}}$，停留在 $0$ 的概率为 $1 - p_{\\text{aug}} - p_{\\text{death}}$。\n- 从状态 $1$：转移到 $2$ 的概率为 $p_{\\text{switch}}$，转移到 $3$ 的概率为 $p_{\\text{ref}}$，转移到 $4$ 的概率为 $p_{\\text{death}}$，余下概率停留在 $1$。\n- 从状态 $2$：转移到 $3$ 的概率为 $p_{2\\rightarrow 3}$，转移到 $4$ 的概率为 $p_{\\text{death}}$，余下概率停留在 $2$。\n- 从状态 $3$：转移到 $4$ 的概率为 $p_{\\text{death}}$，余下概率停留在 $3$。\n- 从状态 $4$：停留在 $4$ 的概率为 $1$。\n\n科学和数值要求：\n- 使用马尔可夫性质和时间同质转移；状态和转移必须是概率一致的，即 $P$ 的每一行之和为 $1$。\n- $C$、$Q$ 和 $NMB$ 的计算必须仅从占有率分布和指定的贴现约定中导出。\n- 货币量以美元表示，QALY为无量纲单位；成本和 $NMB$ 四舍五入到 $2$ 位小数，QALY 四舍五入到 $4$ 位小数。\n\n测试套件：\n为以下每个参数集实现您的程序以计算 $[C,Q,NMB]$。每个参数集以元组形式给出，包含 $(T, r_c, r_q, c_0, u_0, c_3, u_3, c_{\\text{aug\\_workup}}, c_{\\text{switch}}, p_{\\text{death}}, p_{\\text{aug}}, p_{\\text{switch}}, p_{\\text{ref}}, p_{2\\rightarrow 3}, m_c^{\\text{aug}}, m_u^{\\text{aug}}, m_c^{\\text{post}}, m_u^{\\text{post}}, \\lambda)$：\n\n- 案例 $1$ (理想路径)：$(10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.15, 0.60, 0.10, 0.10, 2.0, 0.10, 1.5, 0.05, 50000)$。\n- 案例 $2$ (无症状强化边界)：$(10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.00, 0.00, 0.02, 0.00, 2.0, 0.10, 1.5, 0.05, 50000)$。\n- 案例 $3$ (严重症状强化及后续负担)：$(10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.25, 0.70, 0.15, 0.20, 3.0, 0.20, 2.0, 0.10, 50000)$。\n- 案例 $4$ (短期范围和高贴现率)：$(3, 0.10, 0.10, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.15, 0.90, 0.05, 0.20, 2.0, 0.10, 1.5, 0.05, 50000)$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果，每个元素对应一个测试案例，并且本身是一个按 $[C,Q,NMB]$ 顺序排列的列表，并遵循指定的四舍五入规则，例如，`[[1234.56,9.8765,372343.21],[\\dots],\\dots]`。",
            "solution": "该问题被视为有效。它提出了一个定义明确、有科学依据且客观的任务，以实现用于卫生经济学分析的离散时间马尔可夫模型。所有必要的参数、初始条件和公式都已明确定义，其前提与决策分析和结果研究中的标准方法论一致。该问题是自洽的，没有矛盾或歧义。\n\n在此，我们提出解决方案的形式化推导和计算策略。\n\n该模型是一个离散时间、有限范围的马尔可夫链，定义在从 $0$ 到 $4$ 索引的 $5$ 个状态集上：状态 $0$（无症状强化管理）、状态 $1$（症状强化）、状态 $2$（转换治疗后管理）、状态 $3$（难治性）和状态 $4$（死亡）。系统以年为周期演化，总范围为 $T$ 个周期。\n\n系统在任何周期 $t$ 开始时的状态由一个行向量 $x_t \\in \\mathbb{R}^{1 \\times 5}$ 描述，其中第 $i$ 个分量 $x_{t,i}$ 代表处于状态 $i$ 的队列比例。初始条件是整个队列在时间 $t=0$ 时从状态 $0$ 开始，因此 $x_0 = [1, 0, 0, 0, 0]$。\n\n状态分布的演化由一个时间同质转移概率矩阵 $P \\in \\mathbb{R}^{5 \\times 5}$ 控制，其中 $P_{ij}$ 是在一个周期内从状态 $i$ 转移到状态 $j$ 的概率。状态向量根据规则 $x_{t+1} = x_t P$ 更新。矩阵 $P$ 的构建如下，其中 $p_{\\text{aug}}$、$p_{\\text{switch}}$、$p_{\\text{ref}}$、$p_{2\\rightarrow 3}$ 和 $p_{\\text{death}}$ 是给定的每个周期的转移概率：\n\n$$\nP = \\begin{pmatrix}\n1 - p_{\\text{aug}} - p_{\\text{death}}  p_{\\text{aug}}  0  0  p_{\\text{death}} \\\\\n0  1 - p_{\\text{switch}} - p_{\\text{ref}} - p_{\\text{death}}  p_{\\text{switch}}  p_{\\text{ref}}  p_{\\text{death}} \\\\\n0  0  1 - p_{2\\rightarrow 3} - p_{\\text{death}}  p_{2\\rightarrow 3}  p_{\\text{death}} \\\\\n0  0  0  1 - p_{\\text{death}}  p_{\\text{death}} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n通过构造，P 的每一行之和为 $1$，确保了概率的一致性。状态 $4$ 是一个吸收态，因为 $P_{44}=1$。\n\n该模型计算总范围 $T$ 内的总贴现成本（$C$）和总贴现效果（以质量调整生命年，$Q$ 计）。\n\n与每个状态 $i$ 相关联的是每个周期的成本 $c_i$ 和每个周期的效用（QALY）$u_i$。这些被编译成状态成本向量 $C_{\\text{state}} = [c_0, c_1, c_2, c_3, c_4]$ 和状态效用向量 $U_{\\text{state}} = [u_0, u_1, u_2, u_3, u_4]$。具体值为：\n- $c_0, u_0, c_3, u_3$ 是给定的。\n- $c_1 = c_0 \\cdot m_c^{\\text{aug}}$ 和 $u_1 = u_0 \\cdot (1 - m_u^{\\text{aug}})$。\n- $c_2 = c_0 \\cdot m_c^{\\text{post}}$ 和 $u_2 = u_0 \\cdot (1 - m_u^{\\text{post}})$。\n- $c_4 = 0$ 和 $u_4 = 0$。\n\n还有与特定转移相关的成本，$c^{\\text{trans}}_{i \\rightarrow j}$。这些成本仅在 $c^{\\text{trans}}_{0 \\rightarrow 1} = c_{\\text{aug\\_workup}}$ 和 $c^{\\text{trans}}_{1 \\rightarrow 2} = c_{\\text{switch}}$ 时为非零。我们可以将这些成本表示在一个转移成本矩阵 $C_{\\text{trans}} \\in \\mathbb{R}^{5 \\times 5}$ 中。\n\n模拟从周期 $t=0$ 到 $T-1$ 迭代进行。\n\n**总贴现成本 ($C$)**\n总成本是所有周期内贴现状态成本和贴现转移成本的总和。\n在周期 $t$ 开始时，队列的分布为 $x_t$。在此周期内由状态占有率产生的预期成本是状态向量和成本向量的内积：$x_t \\cdot C_{\\text{state}}^T$。此成本使用周期初贴现因子 $d_c(t) = \\frac{1}{(1+r_c)^t}$ 进行贴现。\n在周期 $t$ 结束时，发生转移。从状态 $i$ 转移到状态 $j$ 的队列比例为 $x_{t,i}P_{ij}$。此转移的预期成本为 $x_{t,i}P_{ij}c^{\\text{trans}}_{i \\rightarrow j}$。周期 $t$ 的总预期转移成本为 $\\sum_{i=0}^{4} \\sum_{j=0}^{4} x_{t,i}P_{ij}c^{\\text{trans}}_{i \\rightarrow j}$。此成本使用周期末贴现因子 $d_c^{\\text{end}}(t) = \\frac{1}{(1+r_c)^{t+1}}$ 进行贴现。\n\n总贴现成本 $C$ 是在总范围 $T$ 上的总和：\n$$ C = \\sum_{t=0}^{T-1} \\left( \\frac{1}{(1+r_c)^t} (x_t \\cdot C_{\\text{state}}^T) + \\frac{1}{(1+r_c)^{t+1}} \\sum_{i,j} x_{t,i}P_{ij}C^{\\text{trans}}_{ij} \\right) $$\n\n**总贴现QALY ($Q$)**\n效果以QALY衡量。在周期 $t$ 开始时，该周期内队列获得的预期QALY为 $x_t \\cdot U_{\\text{state}}^T$。没有与转移相关的QALY。每个周期的QALY使用贴现因子 $d_q(t) = \\frac{1}{(1+r_q)^t}$ 进行贴现。\n总贴现QALY $Q$ 是在总范围 $T$ 上的总和：\n$$ Q = \\sum_{t=0}^{T-1} \\frac{1}{(1+r_q)^t} (x_t \\cdot U_{\\text{state}}^T) $$\n\n**净货币效益 ($NMB$)**\n$NMB$ 是根据总贴现成本和QALY，使用一个支付意愿阈值 $\\lambda$（美元/QALY）计算得出：\n$$ NMB = \\lambda Q - C $$\n\n对于每个测试案例，算法按以下步骤进行：\n1.  初始化总成本 $C=0$ 和总QALY $Q=0$。\n2.  初始化状态向量 $x = x_0 = [1, 0, 0, 0, 0]$。\n3.  根据输入参数构建矩阵 $P$、$C_{\\text{state}}$、$U_{\\text{state}}$ 和 $C_{\\text{trans}}$。\n4.  从 $t=0$ 到 $T-1$ 循环：\n    a. 计算周期初成本：$C_{t,\\text{state}} = x \\cdot C_{\\text{state}}^T$。将 $C_{t,\\text{state}} / (1+r_c)^t$ 加到 $C$ 中。\n    b. 计算周期初QALY：$Q_{t,\\text{state}} = x \\cdot U_{\\text{state}}^T$。将 $Q_{t,\\text{state}} / (1+r_q)^t$ 加到 $Q$ 中。\n    c. 计算周期末转移成本。这可以使用矩阵运算高效计算。从状态 $i$ 到 $j$ 的人口流动矩阵是 $F_t = \\text{diag}(x) \\cdot P$。总转移成本是 $F_t$ 和 $C_{\\text trans}$ 逐元素乘积之和：$C_{t,\\text{trans}} = \\sum_{i,j} (F_t)_{ij} (C_{\\text{trans}})_{ij}$。将 $C_{t,\\text{trans}} / (1+r_c)^{t+1}$ 加到 $C$ 中。\n    d. 为下一个周期更新状态向量：$x \\leftarrow x P$。\n5.  循环结束后，计算 $NMB = \\lambda Q - C$。\n6.  将 $C$ 和 $NMB$ 四舍五入到 $2$ 位小数，将 $Q$ 四舍五入到 $4$ 位小数。\n\n对测试套件中提供的每个参数集重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Markov model for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        (10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.15, 0.60, 0.10, 0.10, 2.0, 0.10, 1.5, 0.05, 50000),\n        # Case 2 (no augmentation boundary)\n        (10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.00, 0.00, 0.02, 0.00, 2.0, 0.10, 1.5, 0.05, 50000),\n        # Case 3 (severe augmentation and downstream burden)\n        (10, 0.03, 0.03, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.25, 0.70, 0.15, 0.20, 3.0, 0.20, 2.0, 0.10, 50000),\n        # Case 4 (short horizon and high discount)\n        (3, 0.10, 0.10, 500, 0.95, 2500, 0.70, 200, 800, 0.01, 0.15, 0.90, 0.05, 0.20, 2.0, 0.10, 1.5, 0.05, 50000),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = run_markov_model(params)\n        all_results.append(result)\n\n    # Format the final output string as a list of lists.\n    # str(list) automatically adds the brackets, so we just join them with commas.\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\ndef run_markov_model(params):\n    \"\"\"\n    Executes the Markov model simulation for a single set of parameters.\n\n    Args:\n        params (tuple): A tuple containing all the model parameters.\n\n    Returns:\n        list: A list containing [Total Cost, Total QALY, NMB] rounded as specified.\n    \"\"\"\n    (T, r_c, r_q, c_0, u_0, c_3, u_3, c_aug_workup, c_switch, p_death, \n     p_aug, p_switch, p_ref, p_2_to_3, m_c_aug, m_u_aug, m_c_post, m_u_post, lambda_wtp) = params\n\n    # 1. Construct state cost and utility vectors\n    c_1 = c_0 * m_c_aug\n    c_2 = c_0 * m_c_post\n    C_state = np.array([c_0, c_1, c_2, c_3, 0.0])\n\n    u_1 = u_0 * (1 - m_u_aug)\n    u_2 = u_0 * (1 - m_u_post)\n    U_state = np.array([u_0, u_1, u_2, u_3, 0.0])\n\n    # 2. Construct transition probability matrix (P)\n    P = np.zeros((5, 5))\n    P[0, 0] = 1 - p_aug - p_death\n    P[0, 1] = p_aug\n    P[0, 4] = p_death\n\n    P[1, 1] = 1 - p_switch - p_ref - p_death\n    P[1, 2] = p_switch\n    P[1, 3] = p_ref\n    P[1, 4] = p_death\n\n    P[2, 2] = 1 - p_2_to_3 - p_death\n    P[2, 3] = p_2_to_3\n    P[2, 4] = p_death\n\n    P[3, 3] = 1 - p_death\n    P[3, 4] = p_death\n\n    P[4, 4] = 1.0\n\n    # 3. Construct transition cost matrix (C_trans)\n    C_trans = np.zeros((5, 5))\n    C_trans[0, 1] = c_aug_workup\n    C_trans[1, 2] = c_switch\n\n    # 4. Initialize simulation variables\n    x_t = np.array([1.0, 0.0, 0.0, 0.0, 0.0])\n    total_C = 0.0\n    total_Q = 0.0\n\n    # 5. Run simulation for T cycles\n    for t in range(T):\n        # Discount factors for cycle t\n        df_c_start = 1 / ((1 + r_c) ** t)\n        df_c_end = 1 / ((1 + r_c) ** (t + 1))\n        df_q_start = 1 / ((1 + r_q) ** t)\n        \n        # Accrue start-of-cycle costs and QALYs\n        # x_t is (1,5), C_state is (5,), so @ is dot product\n        cost_t_state = x_t @ C_state\n        qaly_t_state = x_t @ U_state\n        \n        total_C += cost_t_state * df_c_start\n        total_Q += qaly_t_state * df_q_start\n\n        # Accrue end-of-cycle transition costs\n        # Flow matrix F_t[i, j] = x_t[i] * P[i, j]\n        # This is the probability of a transition i-j happening in the cohort.\n        flow_matrix = np.diag(x_t) @ P\n        cost_t_trans = np.sum(flow_matrix * C_trans)\n        \n        total_C += cost_t_trans * df_c_end\n\n        # Update state vector for next cycle\n        x_t = x_t @ P\n\n    # 6. Calculate Net Monetary Benefit (NMB)\n    nmb = lambda_wtp * total_Q - total_C\n\n    # 7. Round and return results\n    return [round(total_C, 2), round(total_Q, 4), round(nmb, 2)]\n\nsolve()\n```"
        }
    ]
}