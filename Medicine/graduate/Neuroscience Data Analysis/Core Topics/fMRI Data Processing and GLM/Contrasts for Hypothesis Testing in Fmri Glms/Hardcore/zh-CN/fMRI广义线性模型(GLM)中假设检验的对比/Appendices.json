{
    "hands_on_practices": [
        {
            "introduction": "在检验任何假设之前，我们必须首先确保该假设在我们的模型中是“可估计的”（estimable）或可检验的。本练习旨在强化一个基本原则：一个对比（contrast）是可估计的，当且仅当其对应的向量位于设计矩阵的行空间内。通过亲手构建对比向量并验证此属性，您将对有效统计推断的这一关键先决条件建立具体而深刻的理解。",
            "id": "4149034",
            "problem": "一个单被试功能性磁共振成像 (fMRI) 实验使用一个通用线性模型 (GLM) 进行建模，该模型包含三个任务条件 $\\mathcal{A}$、$\\mathcal{B}$ 和 $\\mathcal{C}$。设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 使用一个截距项和两个条件虚拟回归量，其中截距项编码基线，虚拟回归量指示相对于条件 $\\mathcal{A}$ 的条件 $\\mathcal{B}$ 和 $\\mathcal{C}$。共有 $n=6$ 次扫描，其顺序为：扫描 $1$ 和 $4$ 呈现条件 $\\mathcal{A}$，扫描 $2$ 和 $5$ 呈现条件 $\\mathcal{B}$，扫描 $3$ 和 $6$ 呈现条件 $\\mathcal{C}$。设计矩阵的行向量为\n$$\nx_{\\mathcal{A}}^{\\top} = \\begin{pmatrix} 1  0  0 \\end{pmatrix}, \\quad\nx_{\\mathcal{B}}^{\\top} = \\begin{pmatrix} 1  1  0 \\end{pmatrix}, \\quad\nx_{\\mathcal{C}}^{\\top} = \\begin{pmatrix} 1  0  1 \\end{pmatrix},\n$$\n且 $X$ 以 $\\mathcal{A},\\mathcal{B},\\mathcal{C},\\mathcal{A},\\mathcal{B},\\mathcal{C}$ 的顺序重复这些行向量。GLM 为 $y = X \\beta + \\varepsilon$，其中 $\\beta \\in \\mathbb{R}^{3}$，$\\varepsilon$ 是均值为零、协方差为 $\\sigma^{2} I$ 的噪声。\n\n从以下定义出发：(i) GLM 将特定条件的预测均值编码为 $x^{\\top}\\beta$，以及 (ii) 用于比较两个条件均值的对比是一个行向量 $c^{\\top}$，使得 $c^{\\top}\\beta$ 等于相应预测均值之差。请执行以下操作：\n\n1. 构建对比行向量 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top}$、$c_{\\mathcal{C}-\\mathcal{A}}^{\\top}$ 和 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top}$，它们分别代表条件 $\\mathcal{B}$ 与 $\\mathcal{A}$、$\\mathcal{C}$ 与 $\\mathcal{A}$、以及 $\\mathcal{B}$ 与 $\\mathcal{C}$ 之间预测均值的差异。\n\n2. 根据线性代数的基本原理，通过将每个构建的对比明确表示为 $X$ 的行向量的线性组合，来验证它们都位于 $X$ 的行空间中。\n\n3. 令 $P_{\\mathrm{row}(X)}$ 表示到 $X$ 的行空间上的欧几里得正交投影算子。定义\n$$\nS \\equiv \\left\\| c_{\\mathcal{B}-\\mathcal{A}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2}\n+ \\left\\| c_{\\mathcal{C}-\\mathcal{A}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{C}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2}\n+ \\left\\| c_{\\mathcal{B}-\\mathcal{C}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{C}}^{\\top} \\right\\|_{2}^{2}.\n$$\n计算 $S$ 的精确值。无需四舍五入。以一个无单位的实数形式提供最终答案。",
            "solution": "该问题被评估为有效，因为它科学地基于神经科学中线性模型的原理，问题设定良好，具有唯一且有意义的解，并使用客观、形式化的数学语言陈述。它不包含任何科学缺陷、歧义或矛盾。\n\n该问题要求对 fMRI 数据的通用线性模型 (GLM) 中的对比进行三部分分析。GLM 由 $y = X \\beta + \\varepsilon$ 给出，其中 $y \\in \\mathbb{R}^{n}$ 是数据，$X \\in \\mathbb{R}^{n \\times p}$ 是设计矩阵，$\\beta \\in \\mathbb{R}^{p}$ 是参数矢量，$\\varepsilon$ 是噪声项。此处，$n=6$ 且 $p=3$。\n\n实验设计涉及三个条件：$\\mathcal{A}$、$\\mathcal{B}$ 和 $\\mathcal{C}$。参数化使用一个截距项表示条件 $\\mathcal{A}$ 的基线活动，以及两个虚拟回归量表示条件 $\\mathcal{B}$ 和 $\\mathcal{C}$ 的附加效应。设计矩阵的相应行向量如下所示：\n$$\nx_{\\mathcal{A}}^{\\top} = \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n$$\n$$\nx_{\\mathcal{B}}^{\\top} = \\begin{pmatrix} 1  1  0 \\end{pmatrix}\n$$\n$$\nx_{\\mathcal{C}}^{\\top} = \\begin{pmatrix} 1  0  1 \\end{pmatrix}\n$$\n完整的设计矩阵 $X$ 由这些行向量以 $\\mathcal{A},\\mathcal{B},\\mathcal{C},\\mathcal{A},\\mathcal{B},\\mathcal{C}$ 的顺序重复组成。\n\n参数矢量为 $\\beta = \\begin{pmatrix} \\beta_1  \\beta_2  \\beta_3 \\end{pmatrix}^{\\top}$。每个条件的预测平均活动由 $x^{\\top}\\beta$ 给出。\n对于条件 $\\mathcal{A}$，预测均值为 $\\mu_{\\mathcal{A}} = x_{\\mathcal{A}}^{\\top}\\beta = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix} = \\beta_1$。\n对于条件 $\\mathcal{B}$，预测均值为 $\\mu_{\\mathcal{B}} = x_{\\mathcal{B}}^{\\top}\\beta = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix} = \\beta_1 + \\beta_2$。\n对于条件 $\\mathcal{C}$，预测均值为 $\\mu_{\\mathcal{C}} = x_{\\mathcal{C}}^{\\top}\\beta = \\begin{pmatrix} 1  0  1 \\end{pmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix} = \\beta_1 + \\beta_3$。\n这证实了 $\\beta_1$ 是条件 $\\mathcal{A}$ 的均值，$\\beta_2$ 是差异 $\\mu_{\\mathcal{B}} - \\mu_{\\mathcal{A}}$，$\\beta_3$ 是差异 $\\mu_{\\mathcal{C}} - \\mu_{\\mathcal{A}}$。\n\n**1. 构建对比向量**\n\n对比是一个行向量 $c^{\\top}$，使得 $c^{\\top}\\beta$ 代表参数的特定线性组合，通常是条件均值之间的比较。\n\n- **用于 $\\mathcal{B} - \\mathcal{A}$ 的对比：**\n预测均值之差为 $\\mu_{\\mathcal{B}} - \\mu_{\\mathcal{A}} = (\\beta_1 + \\beta_2) - \\beta_1 = \\beta_2$。\n我们需要找到 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top}$ 使得 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top}\\beta = \\beta_2$。这由以下向量满足：\n$$\nc_{\\mathcal{B}-\\mathcal{A}}^{\\top} = \\begin{pmatrix} 0  1  0 \\end{pmatrix}\n$$\n\n- **用于 $\\mathcal{C} - \\mathcal{A}$ 的对比：**\n预测均值之差为 $\\mu_{\\mathcal{C}} - \\mu_{\\mathcal{A}} = (\\beta_1 + \\beta_3) - \\beta_1 = \\beta_3$。\n我们需要找到 $c_{\\mathcal{C}-\\mathcal{A}}^{\\top}$ 使得 $c_{\\mathcal{C}-\\mathcal{A}}^{\\top}\\beta = \\beta_3$。这由以下向量满足：\n$$\nc_{\\mathcal{C}-\\mathcal{A}}^{\\top} = \\begin{pmatrix} 0  0  1 \\end{pmatrix}\n$$\n\n- **用于 $\\mathcal{B} - \\mathcal{C}$ 的对比：**\n预测均值之差为 $\\mu_{\\mathcal{B}} - \\mu_{\\mathcal{C}} = (\\beta_1 + \\beta_2) - (\\beta_1 + \\beta_3) = \\beta_2 - \\beta_3$。\n我们需要找到 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top}$ 使得 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top}\\beta = \\beta_2 - \\beta_3$。这由以下向量满足：\n$$\nc_{\\mathcal{B}-\\mathcal{C}}^{\\top} = \\begin{pmatrix} 0  1  -1 \\end{pmatrix}\n$$\n\n**2. 验证对比位于 $X$ 的行空间中**\n\n$X$ 的行空间，记为 $\\mathrm{row}(X)$，是由 $X$ 的行向量张成的向量空间。由于矩阵 $X$ 是由三个唯一的行向量 $x_{\\mathcal{A}}^{\\top}$、$x_{\\mathcal{B}}^{\\top}$ 和 $x_{\\mathcal{C}}^{\\top}$ 重复构成的，其行空间是这三个向量的张成空间：$\\mathrm{row}(X) = \\mathrm{span}\\{x_{\\mathcal{A}}^{\\top}, x_{\\mathcal{B}}^{\\top}, x_{\\mathcal{C}}^{\\top}\\}$。\n如果一个向量可以写成这些基向量的线性组合，那么它就位于这个空间中。\n\n- 对于 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top} = \\begin{pmatrix} 0  1  0 \\end{pmatrix}$：\n我们观察到 $x_{\\mathcal{B}}^{\\top} - x_{\\mathcal{A}}^{\\top} = \\begin{pmatrix} 1  1  0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\end{pmatrix}$。\n因此，$c_{\\mathcal{B}-\\mathcal{A}}^{\\top} = (1)x_{\\mathcal{B}}^{\\top} + (-1)x_{\\mathcal{A}}^{\\top}$，这是 $X$ 的行向量的线性组合。所以，$c_{\\mathcal{B}-\\mathcal{A}}^{\\top} \\in \\mathrm{row}(X)$。\n\n- 对于 $c_{\\mathcal{C}-\\mathcal{A}}^{\\top} = \\begin{pmatrix} 0  0  1 \\end{pmatrix}$：\n我们观察到 $x_{\\mathcal{C}}^{\\top} - x_{\\mathcal{A}}^{\\top} = \\begin{pmatrix} 1  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  1 \\end{pmatrix}$。\n因此，$c_{\\mathcal{C}-\\mathcal{A}}^{\\top} = (1)x_{\\mathcal{C}}^{\\top} + (-1)x_{\\mathcal{A}}^{\\top}$，这是 $X$ 的行向量的线性组合。所以，$c_{\\mathcal{C}-\\mathcal{A}}^{\\top} \\in \\mathrm{row}(X)$。\n\n- 对于 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top} = \\begin{pmatrix} 0  1  -1 \\end{pmatrix}$：\n我们观察到 $x_{\\mathcal{B}}^{\\top} - x_{\\mathcal{C}}^{\\top} = \\begin{pmatrix} 1  1  0 \\end{pmatrix} - \\begin{pmatrix} 1  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  -1 \\end{pmatrix}$。\n因此，$c_{\\mathcal{B}-\\mathcal{C}}^{\\top} = (1)x_{\\mathcal{B}}^{\\top} + (-1)x_{\\mathcal{C}}^{\\top}$，这是 $X$ 的行向量的线性组合。所以，$c_{\\mathcal{B}-\\mathcal{C}}^{\\top} \\in \\mathrm{row}(X)$。\n\n这明确地验证了所有三个对比向量都位于设计矩阵 $X$ 的行空间中。这是一个对比 $c^{\\top}\\beta$ 可估计的一般要求。\n\n**3. 计算 $S$ 的值**\n\n需要计算的量是：\n$$\nS \\equiv \\left\\| c_{\\mathcal{B}-\\mathcal{A}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2}\n+ \\left\\| c_{\\mathcal{C}-\\mathcal{A}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{C}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2}\n+ \\left\\| c_{\\mathcal{B}-\\mathcal{C}}^{\\top} - P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{C}}^{\\top} \\right\\|_{2}^{2}\n$$\n其中 $P_{\\mathrm{row}(X)}$ 是到子空间 $\\mathrm{row}(X)$ 的欧几里得正交投影算子。\n\n正交投影算子 $P_V$ 到向量子空间 $V$ 上的一个基本性质是，对于任何向量 $v \\in V$，$v$ 在 $V$ 上的投影就是 $v$ 本身。也就是说，如果 $v \\in V$，那么 $P_V v = v$。\n\n在第 2 步中，我们证明了每个对比向量，$c_{\\mathcal{B}-\\mathcal{A}}^{\\top}$、$c_{\\mathcal{C}-\\mathcal{A}}^{\\top}$ 和 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top}$，都是 $X$ 的行空间的元素。\n应用正交投影算子的性质：\n\n- 对于 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top}$：由于 $c_{\\mathcal{B}-\\mathcal{A}}^{\\top} \\in \\mathrm{row}(X)$，我们有 $P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{A}}^{\\top} = c_{\\mathcal{B}-\\mathcal{A}}^{\\top}$。\n$S$ 的求和中的第一项是 $\\left\\| c_{\\mathcal{B}-\\mathcal{A}}^{\\top} - c_{\\mathcal{B}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2} = \\left\\| \\mathbf{0}^{\\top} \\right\\|_{2}^{2} = 0$。\n\n- 对于 $c_{\\mathcal{C}-\\mathcal{A}}^{\\top}$：由于 $c_{\\mathcal{C}-\\mathcal{A}}^{\\top} \\in \\mathrm{row}(X)$，我们有 $P_{\\mathrm{row}(X)} c_{\\mathcal{C}-\\mathcal{A}}^{\\top} = c_{\\mathcal{C}-\\mathcal{A}}^{\\top}$。\n第二项是 $\\left\\| c_{\\mathcal{C}-\\mathcal{A}}^{\\top} - c_{\\mathcal{C}-\\mathcal{A}}^{\\top} \\right\\|_{2}^{2} = \\left\\| \\mathbf{0}^{\\top} \\right\\|_{2}^{2} = 0$。\n\n- 对于 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top}$：由于 $c_{\\mathcal{B}-\\mathcal{C}}^{\\top} \\in \\mathrm{row}(X)$，我们有 $P_{\\mathrm{row}(X)} c_{\\mathcal{B}-\\mathcal{C}}^{\\top} = c_{\\mathcal{B}-\\mathcal{C}}^{\\top}$。\n第三项是 $\\left\\| c_{\\mathcal{B}-\\mathcal{C}}^{\\top} - c_{\\mathcal{B}-\\mathcal{C}}^{\\top} \\right\\|_{2}^{2} = \\left\\| \\mathbf{0}^{\\top} \\right\\|_{2}^{2} = 0$。\n\n综合这些结果，$S$ 的值是这三项之和：\n$$\nS = 0 + 0 + 0 = 0\n$$\n\n表达式 $\\| v - P_V v \\|_2$ 表示从向量 $v$ 到子空间 $V$ 的距离。计算证实，对于所有三个对比向量，这个距离都为零，因为根据构造，它们都是子空间 $\\mathrm{row}(X)$ 的元素。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "同一个实验设计可以使用不同的参数化方案（例如，处理编码 vs. 效应编码）进行建模，这常常会引起混淆。本练习将向您展示，尽管不同编码方案下的参数估计值会有所不同，但其背后可估计的函数（即所检验的假设）是保持不变的。通过推导不同编码方案之间的转换关系，您将掌握在任何软件的默认参数化设置下都能正确定义和解释对比的技能。",
            "id": "4148931",
            "problem": "来自功能性磁共振成像 (fMRI) 的单个体素时间序列使用通用线性模型 (GLM) 进行建模。存在 $3$ 种实验条件：$A$、$B$ 和 $C$。每种条件的回归量是通过将特定条件的事件起始时间与相同的血流动力学响应函数进行卷积形成的，因此各条件下的振幅可以直接比较。误差经过预白化处理，以便应用普通最小二乘法，并且设计矩阵具有满列秩。\n\n使用了同一设计的两种参数化方法：\n\n$1.$ 以 $A$ 为基线的处理编码：有一个截距列和两个分别对应于 $B$ 和 $C$ 的条件列。设参数向量为 $\\boldsymbol{\\beta}^{(t)} = \\begin{pmatrix}\\mu \\\\ \\beta_{B} \\\\ \\beta_{C}\\end{pmatrix}$，其中 $\\mu$ 是条件 $A$ 的基线振幅，而 $\\beta_{B}$ 和 $\\beta_{C}$ 是条件 $B$ 和 $C$ 相对于 $A$ 的增量振幅。在这种编码下，条件均值 $(m_{A}, m_{B}, m_{C})$ 满足 $m_{A} = \\mu$，$m_{B} = \\mu + \\beta_{B}$，以及 $m_{C} = \\mu + \\beta_{C}$。\n\n$2.$ 带截距的零和（效应）编码：有一个全为1的截距列和两个效应编码列 $E_{1}$ 和 $E_{2}$，根据每个时间点的条件标签定义如下：对于条件 $A$，$(E_{1}, E_{2}) = (-1, -1)$；对于条件 $B$，$(E_{1}, E_{2}) = (1, 0)$；对于条件 $C$，$(E_{1}, E_{2}) = (0, 1)$。设参数向量为 $\\boldsymbol{\\theta} = \\begin{pmatrix}\\alpha \\\\ \\gamma_{1} \\\\ \\gamma_{2}\\end{pmatrix}$。在这种编码下，条件均值满足 $m_{A} = \\alpha - \\gamma_{1} - \\gamma_{2}$，$m_{B} = \\alpha + \\gamma_{1}$，以及 $m_{C} = \\alpha + \\gamma_{2}$。\n\n任务：\n\n(a) 使用对比度作为参数向量的线性泛函的定义，写出在处理编码下用于检验 $B$ 与 $A$ 以及 $C$ 与 $A$ 的对比度向量。分别将它们表示为 $\\mathbf{c}^{(t)}_{B:A}$ 和 $\\mathbf{c}^{(t)}_{C:A}$。\n\n(b) 通过令两种参数化下的条件均值相等，推导出线性映射矩阵 $\\mathbf{M}$，使得 $\\boldsymbol{\\beta}^{(t)} = \\mathbf{M}\\,\\boldsymbol{\\theta}$。\n\n(c) 仅使用以下定义：如果两种参数化产生相同的条件均值，则它们代表相同的模型；并且在任何满秩重参数化下，对比度对可估函数的求值都相同。据此，将 (a) 部分的对比度在零和编码下重新表达。即，找到 $\\mathbf{c}^{(s)}_{B:A}$ 和 $\\mathbf{c}^{(s)}_{C:A}$ 使得对于所有 $\\boldsymbol{\\theta}$，$\\mathbf{c}^{(t)\\top}_{B:A}\\boldsymbol{\\beta}^{(t)} = \\mathbf{c}^{(s)\\top}_{B:A}\\boldsymbol{\\theta}$ 和 $\\mathbf{c}^{(t)\\top}_{C:A}\\boldsymbol{\\beta}^{(t)} = \\mathbf{c}^{(s)\\top}_{C:A}\\boldsymbol{\\theta}$ 成立。\n\n(d) 设 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle$ 表示标准欧几里得内积。计算标量 $\\langle \\mathbf{c}^{(s)}_{B:A}, \\mathbf{c}^{(s)}_{C:A} \\rangle$。将最终答案以单个精确数字的形式给出，不带单位。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提出了一个在使用通用线性模型 (GLM) 进行功能性神经影像数据统计分析中的标准、明确定义的问题。所有必要信息均已提供，各项任务是线性模型理论和对比度检验的直接应用。\n\n我们将逐步解决这四个任务。\n\n(a) 处理编码下的对比度向量。\n\n对比度是模型参数的线性组合 $\\mathbf{c}^\\top\\boldsymbol{\\beta}$，对应于关于条件均值的可检验假设。处理编码的参数向量是 $\\boldsymbol{\\beta}^{(t)} = \\begin{pmatrix}\\mu \\\\ \\beta_{B} \\\\ \\beta_{C}\\end{pmatrix}$。条件均值由 $m_{A} = \\mu$，$m_{B} = \\mu + \\beta_{B}$ 和 $m_{C} = \\mu + \\beta_{C}$ 给出。\n\n假设“$B$ 对比 $A$”对应于检验条件 $B$ 和条件 $A$ 的平均激活值之差是否为零，即检验 $m_{B} - m_{A} = 0$。表示此差异的参数线性函数是可估函数。\n$$\nm_{B} - m_{A} = (\\mu + \\beta_{B}) - \\mu = \\beta_{B}\n$$\n为了将其表示为点积 $\\mathbf{c}^{(t)\\top}_{B:A}\\boldsymbol{\\beta}^{(t)}$，我们写出：\n$$\n\\beta_{B} = (0)\\mu + (1)\\beta_{B} + (0)\\beta_{C} = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix}\\mu \\\\ \\beta_{B} \\\\ \\beta_{C}\\end{pmatrix}\n$$\n因此，用于检验 $B$ 与 $A$ 的对比度向量是 $\\mathbf{c}^{(t)}_{B:A} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n类似地，假设“$C$ 对比 $A$”对应于检验 $m_{C} - m_{A} = 0$。可估函数是：\n$$\nm_{C} - m_{A} = (\\mu + \\beta_{C}) - \\mu = \\beta_{C}\n$$\n将其表示为点积 $\\mathbf{c}^{(t)\\top}_{C:A}\\boldsymbol{\\beta}^{(t)}$：\n$$\n\\beta_{C} = (0)\\mu + (0)\\beta_{B} + (1)\\beta_{C} = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix}\\mu \\\\ \\beta_{B} \\\\ \\beta_{C}\\end{pmatrix}\n$$\n因此，用于检验 $C$ 与 $A$ 的对比度向量是 $\\mathbf{c}^{(t)}_{C:A} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n\n(b) 线性映射矩阵 $\\mathbf{M}$ 的推导。\n\n我们被要求找到矩阵 $\\mathbf{M}$ 使得 $\\boldsymbol{\\beta}^{(t)} = \\mathbf{M}\\,\\boldsymbol{\\theta}$。这涉及到用零和编码的参数 ($\\alpha, \\gamma_{1}, \\gamma_{2}$) 来表示处理编码的参数 ($\\mu, \\beta_{B}, \\beta_{C}$)。我们通过令两种参数化下的条件均值表达式相等来实现这一点。\n\n处理编码均值：\n$m_{A} = \\mu$\n$m_{B} = \\mu + \\beta_{B}$\n$m_{C} = \\mu + \\beta_{C}$\n\n零和编码均值：\n$m_{A} = \\alpha - \\gamma_{1} - \\gamma_{2}$\n$m_{B} = \\alpha + \\gamma_{1}$\n$m_{C} = \\alpha + \\gamma_{2}$\n\n首先，我们通过令 $m_{A}$ 的表达式相等来求解 $\\mu$：\n$$\n\\mu = \\alpha - \\gamma_{1} - \\gamma_{2}\n$$\n\n接下来，我们求解 $\\beta_{B}$。我们知道 $m_{B} = \\mu + \\beta_{B}$，所以 $\\beta_{B} = m_{B} - \\mu$。代入零和编码中 $m_{B}$ 的表达式以及我们刚求出的 $\\mu$ 的表达式：\n$$\n\\beta_{B} = (\\alpha + \\gamma_{1}) - (\\alpha - \\gamma_{1} - \\gamma_{2}) = \\alpha + \\gamma_{1} - \\alpha + \\gamma_{1} + \\gamma_{2} = 2\\gamma_{1} + \\gamma_{2}\n$$\n\n最后，我们求解 $\\beta_{C}$。我们知道 $m_{C} = \\mu + \\beta_{C}$，所以 $\\beta_{C} = m_{C} - \\mu$。代入 $m_{C}$ 和 $\\mu$ 的表达式：\n$$\n\\beta_{C} = (\\alpha + \\gamma_{2}) - (\\alpha - \\gamma_{1} - \\gamma_{2}) = \\alpha + \\gamma_{2} - \\alpha + \\gamma_{1} + \\gamma_{2} = \\gamma_{1} + 2\\gamma_{2}\n$$\n\n我们现在可以将这些关系写成矩阵形式：\n$$\n\\mu = (1)\\alpha + (-1)\\gamma_{1} + (-1)\\gamma_{2}\n$$\n$$\n\\beta_{B} = (0)\\alpha + (2)\\gamma_{1} + (1)\\gamma_{2}\n$$\n$$\n\\beta_{C} = (0)\\alpha + (1)\\gamma_{1} + (2)\\gamma_{2}\n$$\n这给出了系统 $\\boldsymbol{\\beta}^{(t)} = \\mathbf{M}\\,\\boldsymbol{\\theta}$：\n$$\n\\begin{pmatrix}\\mu \\\\ \\beta_{B} \\\\ \\beta_{C}\\end{pmatrix} = \\begin{pmatrix} 1  -1  -1 \\\\ 0  2  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix}\\alpha \\\\ \\gamma_{1} \\\\ \\gamma_{2}\\end{pmatrix}\n$$\n因此，线性映射矩阵为：\n$$\n\\mathbf{M} = \\begin{pmatrix} 1  -1  -1 \\\\ 0  2  1 \\\\ 0  1  2 \\end{pmatrix}\n$$\n\n(c) 在零和编码下重新表达对比度。\n\nGLM 中可估函数的一个基本性质是，其值在模型的任何有效重参数化下都是不变的。这意味着作为可估函数的对比度值，无论选择哪种参数化，都必须相同。\n$$\n\\mathbf{c}^{(t)\\top}\\boldsymbol{\\beta}^{(t)} = \\mathbf{c}^{(s)\\top}\\boldsymbol{\\theta}\n$$\n我们将关系式 $\\boldsymbol{\\beta}^{(t)} = \\mathbf{M}\\,\\boldsymbol{\\theta}$ 代入此方程：\n$$\n\\mathbf{c}^{(t)\\top}(\\mathbf{M}\\,\\boldsymbol{\\theta}) = \\mathbf{c}^{(s)\\top}\\boldsymbol{\\theta}\n$$\n使用矩阵乘法的结合律 $(\\mathbf{A}\\mathbf{B})\\mathbf{C} = \\mathbf{A}(\\mathbf{B}\\mathbf{C})$，我们可以对各项进行分组：\n$$\n(\\mathbf{c}^{(t)\\top}\\mathbf{M})\\boldsymbol{\\theta} = \\mathbf{c}^{(s)\\top}\\boldsymbol{\\theta}\n$$\n由于此等式必须对任何参数向量 $\\boldsymbol{\\theta}$ 都成立，因此与 $\\boldsymbol{\\theta}$ 相乘的行向量必须相等：\n$$\n\\mathbf{c}^{(s)\\top} = \\mathbf{c}^{(t)\\top}\\mathbf{M}\n$$\n对两边进行转置，得到列向量的关系：\n$$\n\\mathbf{c}^{(s)} = (\\mathbf{c}^{(t)\\top}\\mathbf{M})^\\top = \\mathbf{M}^\\top \\mathbf{c}^{(t)}\n$$\n我们首先需要 $\\mathbf{M}$ 的转置：\n$$\n\\mathbf{M}^\\top = \\begin{pmatrix} 1  0  0 \\\\ -1  2  1 \\\\ -1  1  2 \\end{pmatrix}\n$$\n现在我们可以找到新的对比度向量。对于 $B$ 与 $A$ 的对比：\n$$\n\\mathbf{c}^{(s)}_{B:A} = \\mathbf{M}^\\top \\mathbf{c}^{(t)}_{B:A} = \\begin{pmatrix} 1  0  0 \\\\ -1  2  1 \\\\ -1  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(1) + (0)(0) \\\\ (-1)(0) + (2)(1) + (1)(0) \\\\ (-1)(0) + (1)(1) + (2)(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n对于 $C$ 与 $A$ 的对比：\n$$\n\\mathbf{c}^{(s)}_{C:A} = \\mathbf{M}^\\top \\mathbf{c}^{(t)}_{C:A} = \\begin{pmatrix} 1  0  0 \\\\ -1  2  1 \\\\ -1  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(0) + (0)(1) \\\\ (-1)(0) + (2)(0) + (1)(1) \\\\ (-1)(0) + (1)(0) + (2)(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 2 \\end{pmatrix}\n$$\n作为检验，我们可以直接用零和编码的参数来评估可估函数：\n$m_{B} - m_{A} = (\\alpha + \\gamma_{1}) - (\\alpha - \\gamma_{1} - \\gamma_{2}) = 2\\gamma_{1} + \\gamma_{2}$。这对应于点积 $\\begin{pmatrix} 0  2  1 \\end{pmatrix} \\boldsymbol{\\theta}$，从而验证了 $\\mathbf{c}^{(s)}_{B:A} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\end{pmatrix}$。\n$m_{C} - m_{A} = (\\alpha + \\gamma_{2}) - (\\alpha - \\gamma_{1} - \\gamma_{2}) = \\gamma_{1} + 2\\gamma_{2}$。这对应于点积 $\\begin{pmatrix} 0  1  2 \\end{pmatrix} \\boldsymbol{\\theta}$，从而验证了 $\\mathbf{c}^{(s)}_{C:A} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 2 \\end{pmatrix}$。\n\n(d) 新对比度向量的标量积。\n\n我们需要计算 (c) 部分中找到的两个对比度向量的标准欧几里得内积（点积）。\n$$\n\\mathbf{c}^{(s)}_{B:A} = \\begin{pmatrix} 0 \\\\ 2 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{c}^{(s)}_{C:A} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 2 \\end{pmatrix}\n$$\n内积是：\n$$\n\\langle \\mathbf{c}^{(s)}_{B:A}, \\mathbf{c}^{(s)}_{C:A} \\rangle = \\mathbf{c}^{(s)\\top}_{B:A} \\mathbf{c}^{(s)}_{C:A} = \\begin{pmatrix} 0  2  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\n\\langle \\mathbf{c}^{(s)}_{B:A}, \\mathbf{c}^{(s)}_{C:A} \\rangle = (0)(0) + (2)(1) + (1)(2) = 0 + 2 + 2 = 4\n$$\n标量积是 $4$。这个非零值表明这两个对比度不是正交的。在 fMRI 分析的背景下，这意味着对于“$B$ 对比 $A$”和“$C$ 对比 $A$”的统计检验在这种特定的零和参数化下不是独立的。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在现实世界的数据分析中，设计矩阵可能非常复杂且呈病态（ill-conditioned），这使得理论上检查可估计性变得困难。本练习将可估计性的理论条件转化为一个使用QR分解的稳健数值算法。通过实现这一检查过程，您不仅将为自己的分析工作开发一个实用的对比验证工具，还将深入理解其中涉及的数值稳定性问题。",
            "id": "4149008",
            "problem": "您正在广义线性模型 (GLM) 框架下，为功能性磁共振成像 (fMRI) 的假设检验分析对比 (contrast)。GLM 假设一个形式为 $y = X \\beta + \\varepsilon$ 的时间序列模型，其中 $y \\in \\mathbb{R}^n$ 是观测数据，$X \\in \\mathbb{R}^{n \\times p}$ 是编码回归量（例如刺激条件和干扰信号）的设计矩阵，$\\beta \\in \\mathbb{R}^p$ 是回归系数，$\\varepsilon \\in \\mathbb{R}^n$ 是零均值噪声。一个对比是某个 $c \\in \\mathbb{R}^p$ 的线性泛函 $c^\\top \\beta$。一个对比 $c^\\top \\beta$ 被认为是可估计的，当且仅当 $c$ 位于 $X$ 的行空间中。\n\n从线性和代数的基本原理出发，通过检查 $c$ 是否位于 $X$ 的行空间中，实现一个鲁棒的数值判定程序来验证对比的可估计性。您的程序必须在数值上使用正交三角 (QR) 分解来为 $X$ 的行空间构建一个标准正交基，并在用户指定的数值容差内判定成员关系。\n\n使用以下测试套件。对于每个测试用例，您将得到一个矩阵 $X \\in \\mathbb{R}^{n \\times p}$，一个对比向量 $c \\in \\mathbb{R}^p$，以及一个投影容差 $\\tau  0$。您的程序必须返回一个布尔值，指示在给定 $X$ 的情况下 $c$ 是否可估计（即，$c$ 到 $X$ 的行空间的距离是否最多为 $\\tau$）。所有矩阵和向量的维度都是一致的，并且包含无单位的条目。程序必须对 $X^\\top$ 使用带列主元的 QR 分解，以获得 $X$ 行空间的一个标准正交基。\n\n测试套件：\n- 案例 $1$ (满列秩设计)：\n  $$\n  X_1 =\n  \\begin{bmatrix}\n  1  0  0 \\\\\n  1  1  0 \\\\\n  1  1  1 \\\\\n  1  0  1 \\\\\n  1  0  0 \\\\\n  1  1  0\n  \\end{bmatrix},\n  \\quad\n  c_1 = \\begin{bmatrix} 0 \\\\ 1 \\\\ -1 \\end{bmatrix},\n  \\quad\n  \\tau_1 = 10^{-12}.\n  $$\n- 案例 $2$ (通过重复回归量导致秩亏，不可估计的对比)：\n  $$\n  X_2 =\n  \\begin{bmatrix}\n  1  0  0 \\\\\n  1  1  1 \\\\\n  1  1  1 \\\\\n  1  0  0 \\\\\n  1  1  1\n  \\end{bmatrix},\n  \\quad\n  c_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ -1 \\end{bmatrix},\n  \\quad\n  \\tau_2 = 10^{-12}.\n  $$\n- 案例 $3$ (通过重复回归量导致秩亏，与行空间对称性对齐的可估计对比)：\n  $$\n  X_3 =\n  X_2 \\text{ (如上)},\n  \\quad\n  c_3 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix},\n  \\quad\n  \\tau_3 = 10^{-12}.\n  $$\n- 案例 $4$ (近似共线性，通过微小扰动在数值上满秩)：\n  令 $\\delta = 10^{-10}$，且\n  $$\n  X_4 =\n  \\begin{bmatrix}\n  1  0  \\delta \\\\\n  1  1  1 \\\\\n  1  1  1 \\\\\n  1  0  0\n  \\end{bmatrix},\n  \\quad\n  c_4 = \\begin{bmatrix} 0 \\\\ 1 \\\\ -1 \\end{bmatrix},\n  \\quad\n  \\tau_4 = 10^{-8}.\n  $$\n- 案例 $5$ (零回归量列意味着该系数上的对比不可估计)：\n  $$\n  X_5 =\n  \\begin{bmatrix}\n  1  0  0 \\\\\n  1  0  1 \\\\\n  1  0  0 \\\\\n  1  0  1\n  \\end{bmatrix},\n  \\quad\n  c_5 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix},\n  \\quad\n  \\tau_5 = 10^{-12}.\n  $$\n\n实现要求：\n- 对 $X^\\top$ 使用带列主元的 QR 分解，以获得 $Q$ 和 $R$ 因子以及一个置换。\n- 通过将 $R$ 的对角线元素的绝对值与您的程序内部计算的秩容差进行阈值比较，来确定数值秩 $r$（您可以基于机器精度和 $R$ 的尺度来计算）。\n- 从 $Q$ 的前 $r$ 列构建一个标准正交基 $Q_r$ 来表示 $X$ 的行空间。通过检查 $(I - Q_r Q_r^\\top) c$ 的欧几里得范数是否最多为 $\\tau$ 来判定可估计性。\n- 对于上述五个案例中的每一个，计算一个布尔值，指示在容差 $\\tau_i$ 下，所提供的 $c_i$ 是否可从 $X_i$ 估计。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[True,False,True,True,False]”），按案例 1 到 5 的顺序排列。",
            "solution": "该问题要求实现一个鲁棒的数值程序，以确定在形式为 $y = X\\beta + \\varepsilon$ 的广义线性模型 (GLM) 框架内，由向量 $c \\in \\mathbb{R}^p$ 定义的对比是否可估计。可估计性的条件是对比向量 $c$ 必须位于设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 的行空间中。\n\n**理论基础**\n当且仅当对比向量 $c$ 是设计矩阵 $X$ 行空间的成员时，对比 $c^\\top\\beta$ 是可估计的。$X$ 的行空间，记作 $\\text{row}(X)$，是由 $X$ 的行向量张成的 $\\mathbb{R}^p$ 的子空间。一个等价且在计算上更有用的观点是，$X$ 的行空间与其转置 $X^\\top$ 的列空间相同。即 $\\text{row}(X) = \\text{col}(X^\\top)$。\n\n因此，检查 $c \\in \\text{row}(X)$ 的问题就转化为检查 $c \\in \\text{col}(X^\\top)$。一个向量属于一个向量子空间，当且仅当它在该子空间上的正交投影是它自身。在数值上，这意味着从该向量到该子空间的距离应该接近于零。验证这一点的最鲁棒的方法是首先为子空间 $\\text{col}(X^\\top)$ 构建一个标准正交基。一旦找到这样的基，我们就将向量 $c$ 投影到该子空间上，并测量残差向量的长度（欧几里得范数）。如果这个范数小于给定的容差 $\\tau$，我们便断定 $c$ 在数值上位于该子空间内。\n\n**数值方法：秩揭示 QR 分解**\n为了构造 $\\text{col}(X^\\top)$ 的标准正交基，我们采用带列主元的 QR 分解。这是一种秩揭示分解，在数值上是稳定的，特别是当 $X$（及其转置 $X^\\top$）是秩亏或病态时。\n\n我们将该分解应用于矩阵 $A = X^\\top \\in \\mathbb{R}^{p \\times n}$。该分解产生 $A P = Q R$，可以重写为 $X^\\top P = QR$。在这个方程中：\n- $P$ 是一个置换矩阵，它对 $A$ 的列进行重新排序，使得 $R$ 的对角线元素在量值上非增，即 $|R_{00}| \\ge |R_{11}| \\ge \\dots$。\n- $Q \\in \\mathbb{R}^{p \\times p}$ 是一个正交矩阵，意味着它的列构成了 $\\mathbb{R}^p$ 的一个标准正交基。\n- $R \\in \\mathbb{R}^{p \\times n}$ 是一个上梯形矩阵。\n\n矩阵 $X$ 的秩 $r$（等于 $X^\\top$ 的秩）是其行空间的维度。由于浮点运算，我们必须确定一个数值秩。通过检查 $R$ 的对角线元素，我们可以找到置换矩阵 $A P$ 中线性无关列的数量。数值秩 $r$ 是对角线元素 $|R_{ii}|$ 中显著大于零的条目的计数。对此的一个标准阈值是一个容差 $\\text{tol}$，通常相对于矩阵维度、机器精度 $\\epsilon$ 和矩阵的尺度来设置：$\\text{tol} = \\max(p, n) \\cdot \\epsilon \\cdot |R_{00}|$。\n\n$Q$ 矩阵的前 $r$ 列，我们记作 $Q_r \\in \\mathbb{R}^{p \\times r}$，构成了 $X^\\top$ 列空间的一个标准正交基，因此也构成了 $X$ 行空间的一个标准正交基。\n\n**投影与验证**\n有了标准正交基 $Q_r$，$c$ 在 $\\text{row}(X)$ 上的投影由 $c_{\\text{proj}} = Q_r Q_r^\\top c$ 给出。$c$ 中与行空间正交的向量分量是残差 $c_{\\perp} = c - c_{\\text{proj}} = (I - Q_r Q_r^\\top)c$。如果这个残差可以忽略不计，即其欧几里得范数在指定的容差 $\\tau$ 之内，则满足可估计性条件：\n$$ \\| c_{\\perp} \\|_2 = \\|(I - Q_r Q_r^\\top)c\\|_2 \\le \\tau $$\n\n一种计算上更高效、更稳定的计算该范数的方法利用了完整正交矩阵 $Q$ 的性质。由于 $Q$ 是正交的，它在变换下保持范数 ($||Q^\\top v||_2 = ||v||_2$)。令 $\\hat{c} = Q^\\top c$ 为 $c$ 在由 $Q$ 的列定义的基中的表示。向量 $c$ 可以表示为基向量的线性组合：$c = Q\\hat{c}$。投影 $c_{\\text{proj}}$ 对应于使用前 $r$ 个基向量（$Q_r$ 的列）的求和部分，而残差 $c_{\\perp}$ 对应于使用余下的 $p-r$ 个基向量的部分。因为这些基向量是标准正交的，所以残差的范数就是 $\\hat{c}$ 中相应系数的范数：\n$$ \\|c_{\\perp}\\|_2 = \\left\\| \\hat{c}_{r:p} \\right\\|_2 = \\sqrt{\\sum_{i=r}^{p-1} \\hat{c}_i^2} $$\n其中 $\\hat{c}_{r:p}$ 表示 $\\hat{c}$ 从索引 $r$ 到末尾的分量。这种方法避免了显式地构造投影矩阵，在数值上是更可取的。\n\n**测试用例的实现**\n对于每个给定的测试用例 $(X_i, c_i, \\tau_i)$，算法按以下步骤进行：\n1. 构造矩阵 $A = X_i^\\top$。\n2. 计算带列主元的 QR 分解：$A P = Q R$。\n3. 通过将 $R$ 的对角线与内部计算的容差进行阈值比较，来确定数值秩 $r$。\n4. 将对比向量变换到新基中：$\\hat{c}_i = Q^\\top c_i$。\n5. 计算从索引 $r$ 开始的 $\\hat{c}_i$分量的欧几里得范数。这就是 $c_i$ 到 $X_i$ 行空间的距离。\n6. 将此范数与容差 $\\tau_i$ 进行比较。如果范数小于或等于 $\\tau_i$，则对比是可估计的 (True)；否则，是不可估计的 (False)。\n\n此程序应用于所有五个测试用例，以生成最终的布尔结果列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import qr\n\ndef is_estimable(X, c, tau):\n    \"\"\"\n    Checks if a contrast vector c is in the row space of a design matrix X\n    using QR decomposition with column pivoting.\n\n    Args:\n        X (np.ndarray): The design matrix of shape (n, p).\n        c (np.ndarray): The contrast vector of shape (p,).\n        tau (float): The numerical tolerance for the distance to the subspace.\n\n    Returns:\n        bool: True if c is estimable within the given tolerance, False otherwise.\n    \"\"\"\n    # Number of regressors (columns of X)\n    p = X.shape[1]\n    if p == 0:\n        # If there are no regressors, the row space is {0} in R^0.\n        # The only valid contrast vector is an empty one.\n        return np.linalg.norm(c) = tau\n\n    # The problem of checking if c is in row(X) is equivalent to\n    # checking if c is in the column space of X.T.\n    A = X.T\n    p, n = A.shape  # p = num_regressors, n = num_timepoints\n\n    # Perform QR decomposition with column pivoting on X.T.\n    # We use mode='full' to ensure Q is a square (p x p) orthogonal matrix.\n    # The decomposition is A[:, P] = Q @ R, where P is the permutation vector.\n    Q, R, _ = qr(A, pivoting=True, mode='full')\n\n    # Determine the numerical rank 'r' of the matrix A.\n    # This is done by thresholding the absolute diagonal entries of R.\n    if R.shape[0] == 0 or R.shape[1] == 0:\n        rank = 0\n    else:\n        # A standard tolerance for rank determination is based on the matrix size,\n        # machine epsilon, and the scale of the matrix (given by abs(R[0, 0])).\n        eps = np.finfo(R.dtype).eps\n        rank_tol = max(p, n) * eps * abs(R[0, 0])\n        diag_R_abs = np.abs(np.diag(R))\n        rank = np.sum(diag_R_abs  rank_tol)\n\n    # Transform the contrast vector c into the basis defined by the columns of Q.\n    c_transformed = Q.T @ c\n\n    # The distance from c to the column space of A (i.e., row space of X) is\n    # the Euclidean norm of the components of c_transformed that correspond to\n    # the basis vectors of the orthogonal complement. These are the components\n    # of the transformed vector from index 'rank' onwards.\n    distance_to_subspace = np.linalg.norm(c_transformed[rank:])\n\n    # The contrast is estimable if this distance is within the specified tolerance.\n    return distance_to_subspace = tau\n\n\ndef solve():\n    \"\"\"\n    Defines the test suite from the problem statement and computes the results.\n    \"\"\"\n    # Case 1: Full column rank design\n    X1 = np.array([\n        [1., 0., 0.], [1., 1., 0.], [1., 1., 1.],\n        [1., 0., 1.], [1., 0., 0.], [1., 1., 0.]\n    ])\n    c1 = np.array([0., 1., -1.])\n    tau1 = 1e-12\n\n    # Case 2: Rank deficiency via duplicated regressor, non-estimable contrast\n    X2 = np.array([\n        [1., 0., 0.], [1., 1., 1.], [1., 1., 1.],\n        [1., 0., 0.], [1., 1., 1.]\n    ])\n    c2 = np.array([0., 1., -1.])\n    tau2 = 1e-12\n\n    # Case 3: Rank deficiency via duplicated regressor, estimable contrast\n    X3 = X2\n    c3 = np.array([0., 1., 1.])\n    tau3 = 1e-12\n\n    # Case 4: Near collinearity, numerically full rank with tiny perturbation\n    delta = 1e-10\n    X4 = np.array([\n        [1., 0., delta], [1., 1., 1.],\n        [1., 1., 1.], [1., 0., 0.]\n    ])\n    c4 = np.array([0., 1., -1.])\n    tau4 = 1e-8\n\n    # Case 5: Zero regressor column implies non-estimable contrast\n    X5 = np.array([\n        [1., 0., 0.], [1., 0., 1.],\n        [1., 0., 0.], [1., 0., 1.]\n    ])\n    c5 = np.array([0., 1., 0.])\n    tau5 = 1e-12\n\n    test_cases = [\n        (X1, c1, tau1),\n        (X2, c2, tau2),\n        (X3, c3, tau3),\n        (X4, c4, tau4),\n        (X5, c5, tau5),\n    ]\n\n    results = []\n    for X, c, tau in test_cases:\n        estimable = is_estimable(X, c, tau)\n        results.append(estimable)\n\n    # Format the final output string as a comma-separated list in brackets.\n    # The map(str, ...) function automatically converts Python's True/False\n    # to the required \"True\"/\"False\" string representation.\n    result_str = f\"[{','.join(map(str, results))}]\"\n    print(result_str)\n\n\nsolve()\n\n```"
        }
    ]
}