{
    "hands_on_practices": [
        {
            "introduction": "在我们能校正时间自相关之前，我们首先需要一个能描述它的模型。本练习将指导你使用Yule-Walker方程来估计一个简单但强大的噪声模型——一阶自回归或AR(1)模型的参数 $\\phi$。通过解决这个问题 ，你将获得直接从fMRI残差中量化噪声结构的实践经验，这是预白化（prewhitening）关键的第一步。",
            "id": "4197953",
            "problem": "您正在分析一次功能性磁共振成像 (fMRI) 短暂校准运行中的噪声自相关，数据采集的重复时间 (TR) 为 $2$ 秒。在使用时间滤波回归量拟合广义线性模型 (GLM) 后，您获得了 $t=1,\\dots,T$ 的残差 $\\hat{\\varepsilon}_{t}$。为了进行预白化，假设 GLM 残差服从一个零均值的平稳一阶自回归模型 $\\mathrm{AR}(1)$：\n$$\n\\hat{\\varepsilon}_{t} = \\phi \\hat{\\varepsilon}_{t-1} + w_{t},\n$$\n其中 $w_{t}$ 是均值为零、方差为 $\\sigma_{w}^{2}$ 的独立同分布白噪声，且 $|\\phi|<1$。从严平稳过程的自协方差函数定义出发：\n$$\n\\gamma(k) = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-k} \\right],\n$$\n通过用样本模拟量替换总体量，推导出 $\\phi$ 的一个估计量：\n$$\n\\hat{\\gamma}(k) = \\frac{1}{T} \\sum_{t=k+1}^{T} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-k},\n$$\n并证明它可以用残差表示为闭式形式。然后，使用以下来自长度为 $T=8$ 的短时间序列的均值中心化 GLM 残差：\n$$\n\\left\\{ \\hat{\\varepsilon}_{t} \\right\\}_{t=1}^{8} = \\{ 0.7,\\; 0.4,\\; 0.2,\\; -0.1,\\; -0.3,\\; -0.5,\\; -0.2,\\; -0.2 \\},\n$$\n计算该估计量的数值。将您的数值答案四舍五入到四位有效数字。最后，在您的推导过程中，简要说明为什么短时间序列会给这个估计量带来偏差，并指出在给定的样本自协方差约定下，当 $\\phi>0$ 时偏差的符号。将最终答案表示为单个无单位的实数。",
            "solution": "本题要求从广义线性模型 (GLM) 的残差中推导出一阶自回归参数 $\\phi$ 的估计量，为给定数据集计算其数值，并说明其在短时间序列中的偏差原因。\n\n首先，我们从题目给出的 GLM 残差模型开始，这是一个零均值的平稳一阶自回归过程 $\\mathrm{AR}(1)$：\n$$\n\\hat{\\varepsilon}_{t} = \\phi \\hat{\\varepsilon}_{t-1} + w_{t}\n$$\n其中 $w_{t}$ 是独立同分布的白噪声，$\\mathbb{E}[w_t] = 0$，方差为 $\\sigma_{w}^{2}$，且平稳性条件要求 $|\\phi|<1$。该严平稳过程的自协方差函数定义为 $\\gamma(k) = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-k} \\right]$。\n\n为了找到用总体自协方差表示 $\\phi$ 的表达式，我们计算 $k=0$ 和 $k=1$ 时的 $\\gamma(k)$。\n对于 $k=0$，自协方差是过程的方差：\n$$\n\\gamma(0) = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t} \\right] = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}^{2} \\right] = \\sigma_{\\varepsilon}^{2}\n$$\n对于 $k=1$，自协方差为：\n$$\n\\gamma(1) = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-1} \\right]\n$$\n将 $\\mathrm{AR}(1)$ 模型定义代入 $\\gamma(1)$ 的表达式中：\n$$\n\\gamma(1) = \\mathbb{E}\\left[ (\\phi \\hat{\\varepsilon}_{t-1} + w_{t}) \\hat{\\varepsilon}_{t-1} \\right]\n$$\n根据期望的线性性质，这变为：\n$$\n\\gamma(1) = \\mathbb{E}\\left[ \\phi \\hat{\\varepsilon}_{t-1}^{2} \\right] + \\mathbb{E}\\left[ w_{t}\\hat{\\varepsilon}_{t-1} \\right] = \\phi \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t-1}^{2} \\right] + \\mathbb{E}\\left[ w_{t}\\hat{\\varepsilon}_{t-1} \\right]\n$$\n由于平稳性，方差不随时间变化，所以 $\\mathbb{E}\\left[ \\hat{\\varepsilon}_{t-1}^{2} \\right] = \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t}^{2} \\right] = \\gamma(0)$。根据定义，噪声项 $w_{t}$ 是一个新息项，它与过程的所有过去值（包括 $\\hat{\\varepsilon}_{t-1}$）都无关。因此，它们乘积的期望等于它们各自期望的乘积：\n$$\n\\mathbb{E}\\left[ w_{t}\\hat{\\varepsilon}_{t-1} \\right] = \\mathbb{E}\\left[ w_{t} \\right] \\mathbb{E}\\left[ \\hat{\\varepsilon}_{t-1} \\right] = 0 \\times 0 = 0\n$$\n将这些结果代回 $\\gamma(1)$ 的方程，得到 $\\mathrm{AR}(1)$ 过程的 Yule-Walker 方程：\n$$\n\\gamma(1) = \\phi \\gamma(0)\n$$\n由此，我们可以将真实参数 $\\phi$ 表示为滞后-1自协方差与滞后-0自协方差（即方差）之比：\n$$\n\\phi = \\frac{\\gamma(1)}{\\gamma(0)}\n$$\n题目要求通过用样本模拟量 $\\hat{\\gamma}(k)$ 替换总体量 $\\gamma(k)$ 来推导 $\\phi$ 的一个估计量（记为 $\\hat{\\phi}$）。给出的样本自协方差为：\n$$\n\\hat{\\gamma}(k) = \\frac{1}{T} \\sum_{t=k+1}^{T} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-k}\n$$\n利用这个定义，我们构建估计量 $\\hat{\\phi}$：\n$$\n\\hat{\\phi} = \\frac{\\hat{\\gamma}(1)}{\\hat{\\gamma}(0)} = \\frac{\\frac{1}{T} \\sum_{t=2}^{T} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-1}}{\\frac{1}{T} \\sum_{t=1}^{T} \\hat{\\varepsilon}_{t}^{2}}\n$$\n因子 $\\frac{1}{T}$ 可以消去，留下用残差表示的闭式估计量：\n$$\n\\hat{\\phi} = \\frac{\\sum_{t=2}^{T} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-1}}{\\sum_{t=1}^{T} \\hat{\\varepsilon}_{t}^{2}}\n$$\n这是将 $\\hat{\\varepsilon}_{t}$ 对 $\\hat{\\varepsilon}_{t-1}$ 进行回归时，系数的普通最小二乘 (OLS) 估计量。\n\n关于偏差，已知该估计量在有限样本（即 $T$ 较小时）中是有偏的。偏差 $\\mathbb{E}[\\hat{\\phi}] - \\phi$ 的阶数为 $O(1/T)$，因此随着时间序列长度 $T$ 的增加而减小，使得该估计量是渐进无偏的（一致的）。偏差的产生是因为回归量 $\\hat{\\varepsilon}_{t-1}$ 不是严格外生的；它与误差项的历史值 $\\{w_{t-1}, w_{t-2}, \\dots\\}$ 相关。这导致了估计量随机部分的分母和分子之间存在相关性，即 $\\sum w_t \\hat{\\varepsilon}_{t-1}$ 和 $\\sum \\hat{\\varepsilon}_t^2$ 之间存在相关性。对于 $\\phi > 0$ 的 $\\mathrm{AR}(1)$ 过程，该偏差通常是负的。也就是说，$\\mathbb{E}[\\hat{\\phi}]  \\phi$。这意味着对于短时间序列，该估计量倾向于低估时间自相关的真实幅度。这种向下偏差是时间序列分析中一个公认的结果（例如，Hurwicz 偏差）。\n\n现在，我们为给定的数据集计算 $\\hat{\\phi}$ 的数值：\n$$\n\\left\\{ \\hat{\\varepsilon}_{t} \\right\\}_{t=1}^{8} = \\{ 0.7,\\; 0.4,\\; 0.2,\\; -0.1,\\; -0.3,\\; -0.5,\\; -0.2,\\; -0.2 \\}\n$$\n序列长度为 $T=8$。\n\n首先，我们计算分子，即滞后乘积之和 $\\sum_{t=2}^{8} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-1}$：\n\\begin{align*}\n\\sum_{t=2}^{8} \\hat{\\varepsilon}_{t}\\hat{\\varepsilon}_{t-1} = (0.4)(0.7) + (0.2)(0.4) + (-0.1)(0.2) + (-0.3)(-0.1) + (-0.5)(-0.3) + (-0.2)(-0.5) + (-0.2)(-0.2) \\\\\n= 0.28 + 0.08 - 0.02 + 0.03 + 0.15 + 0.10 + 0.04 \\\\\n= 0.66\n\\end{align*}\n\n接下来，我们计算分母，即平方和 $\\sum_{t=1}^{8} \\hat{\\varepsilon}_{t}^{2}$：\n\\begin{align*}\n\\sum_{t=1}^{8} \\hat{\\varepsilon}_{t}^{2} = (0.7)^{2} + (0.4)^{2} + (0.2)^{2} + (-0.1)^{2} + (-0.3)^{2} + (-0.5)^{2} + (-0.2)^{2} + (-0.2)^{2} \\\\\n= 0.49 + 0.16 + 0.04 + 0.01 + 0.09 + 0.25 + 0.04 + 0.04 \\\\\n= 1.12\n\\end{align*}\n\n最后，我们计算估计量 $\\hat{\\phi}$：\n$$\n\\hat{\\phi} = \\frac{0.66}{1.12} = \\frac{33}{56} \\approx 0.5892857...\n$$\n将数值四舍五入到四位有效数字，得到 $0.5893$。",
            "answer": "$$\n\\boxed{0.5893}\n$$"
        },
        {
            "introduction": "fMRI数据常常受到缓慢的、非神经元活动的信号漂移的污染，这可以通过高通滤波来去除。本练习演示了在通用线性模型（GLM）框架内，如何使用一组离散余弦变换（DCT）基函数来实际执行这种滤波。完成此练习  后，你将理解一个概念上的滤波器截止周期与你的统计模型中包含的具体回归量之间的直接联系。",
            "id": "4197992",
            "problem": "给定一次功能性磁共振成像 (fMRI) 单次运行数据，其重复时间 (TR) 为 $2\\ \\mathrm{s}$，运行长度为 $N=240$ 个时间点（volumes）。考虑在统计参数图 (SPM) 中使用离散余弦变换 (DCT) 基函数实现一个时间高通滤波器。在 SPM 中，低频漂移是通过一组低频余弦分量（包括零频常数项）来建模的，这些分量的周期大于或等于指定的高通截止周期。本题的截止周期为 $128\\ \\mathrm{s}$。从 DCT-II 基函数的定义和周/样本的概念出发，推导建模所有周期大于或等于截止周期的余弦分量（明确计入零频余弦分量）所需的 DCT 基函数数量。然后根据给定参数计算这个数量。请给出最终答案，为一个精确的整数，不带单位。",
            "solution": "该问题要求计算在 fMRI 时间序列中建模低频信号分量所需的 DCT 基函数数量。该时间序列包含 $N=240$ 个样本（时间点），采样间隔为 $TR=2\\ \\mathrm{s}$。在模型中包含一个基函数的条件是其时间周期必须大于或等于 $P_{cutoff}=128\\ \\mathrm{s}$ 的截止周期。\n\n在 SPM 中，使用的是针对长度为 $N$ 的时间序列的 DCT-II 基函数集。对于离散时间索引 $n \\in \\{0, 1, \\dots, N-1\\}$，第 $k$ 个基函数（对于 $k \\in \\{1, 2, \\dots, N-1\\}$）正比于：\n$$ \\cos\\left( \\frac{\\pi k (2n+1)}{2N} \\right) $$\n第 $k$ 个基函数的频率，以“周/样本”为单位，是 $f_k^{\\text{cycles/sample}} = \\frac{k}{2N}$。要将其转换为赫兹（周/秒），我们除以采样间隔 $TR$：\n$$ f_k^{\\text{Hz}} = \\frac{f_k^{\\text{cycles/sample}}}{TR} = \\frac{k}{2N \\cdot TR} $$\n第 $k$ 个基函数的周期 $P_k$ 是其频率（以赫兹为单位）的倒数：\n$$ P_k = \\frac{1}{f_k^\\text{Hz}} = \\frac{2N \\cdot TR}{k} $$\n此公式对 $k = 1, 2, \\dots, N-1$ 有效。\n\n问题还规定要包含“零频常数项”。这对应于 $k=0$ 的基函数，它是一个恒定的直流（DC）分量。该分量的频率为 $f_0 = 0\\ \\mathrm{Hz}$，其周期可以认为是无穷大，即 $P_0 = \\infty$。\n\n包含基函数的标准是 $P_k \\ge P_{cutoff}$。\n首先，考虑 $k=0$ 的分量。由于其周期 $P_0 = \\infty$ 而截止周期 $P_{cutoff} = 128\\ \\mathrm{s}$ 是有限的，因此条件 $\\infty \\ge 128$ 总是满足的。所以，$k=0$ 的基函数总是被包含在内。这算作一个函数。\n\n接下来，我们考虑 $k \\ge 1$ 的基函数。我们需要找到满足以下不等式的整数 $k$ 的数量：\n$$ P_k \\ge P_{cutoff} $$\n代入 $P_k$ 的表达式：\n$$ \\frac{2N \\cdot TR}{k} \\ge P_{cutoff} $$\n由于 $k$ 是正整数且 $P_{cutoff}$ 是正数，我们可以重排不等式以求解 $k$：\n$$ 2N \\cdot TR \\ge k \\cdot P_{cutoff} $$\n$$ k \\le \\frac{2N \\cdot TR}{P_{cutoff}} $$\n满足此条件的 $k$ 值为 $k = 1, 2, \\dots, K_{max}$，其中 $K_{max}$ 是小于或等于右侧值的最大整数。这由向下取整函数（floor function）给出：\n$$ K_{max} = \\left\\lfloor \\frac{2N \\cdot TR}{P_{cutoff}} \\right\\rfloor $$\n这些基函数（对于 $k \\ge 1$）的数量就是 $K_{max}$。\n\n基函数的总数 $M$ 是 $k=0$ 的计数和 $k \\ge 1$ 的计数之和：\n$$ M = 1 + K_{max} = 1 + \\left\\lfloor \\frac{2N \\cdot TR}{P_{cutoff}} \\right\\rfloor $$\n现在，我们代入给定值：$N=240$，$TR=2\\ \\mathrm{s}$，以及 $P_{cutoff}=128\\ \\mathrm{s}$。\n$$ M = 1 + \\left\\lfloor \\frac{2 \\times 240 \\times 2}{128} \\right\\rfloor $$\n首先，我们计算分数值：\n$$ \\frac{2 \\times 240 \\times 2}{128} = \\frac{960}{128} $$\n为了简化分数，我们可以将分子和分母除以它们的最大公约数。两者都可以被 $64$ 整除：\n$$ \\frac{960}{128} = \\frac{15 \\times 64}{2 \\times 64} = \\frac{15}{2} = 7.5 $$\n将这个值代回 $M$ 的表达式中：\n$$ M = 1 + \\lfloor 7.5 \\rfloor $$\n$7.5$ 的向下取整是 $7$。\n$$ M = 1 + 7 = 8 $$\n因此，根据指定标准，总共需要 $8$ 个 DCT 基函数来建模低频漂移。这些基函数对应的索引是 $k = 0, 1, 2, 3, 4, 5, 6, 7$。",
            "answer": "$$\n\\boxed{8}\n$$"
        },
        {
            "introduction": "在应用了预白化程序后，我们如何确定它是否有效？本练习介绍了Durbin-Watson统计量，这是一个评估模型残差是否真正“白化”（即不存在自相关）的宝贵诊断工具。通过为一个给定的残差序列计算该统计量 ，你将学会定量地评估预白化处理的成功与否，并识别出如过度校正等潜在问题。",
            "id": "4197966",
            "problem": "考虑一个来自功能性磁共振成像 (fMRI) 实验的单体素时间序列，该序列在 $8$ 次扫描中每 $2$ 秒采样一次，并使用通用线性模型 (GLM) 进行建模。该模型包含捕获与任务相关效应和滋扰漂移项的回归量。假设噪声过程可以很好地近似为真实参数为 $\\phi_{\\text{true}}$ 的一阶自回归过程，但预白化阶段使用的参数 $\\phi_{\\text{pw}}$ 高估了 $\\phi_{\\text{true}}$，导致在拟合 GLM 后出现残差反相关。\n\n经过预白化和估计后，观测到该体素在时间点 $t=1,\\dots,8$ 的残差为\n$$\ne_1=1,\\quad e_2=-1,\\quad e_3=1,\\quad e_4=-1,\\quad e_5=1,\\quad e_6=-1,\\quad e_7=1,\\quad e_8=-1.\n$$\n\n从通用线性模型残差的定义和一阶自回归所隐含的样本滞后-$1$ 协方差结构出发，推导 Durbin–Watson 统计量作为残差 $\\{e_t\\}$ 的函数，并为上述序列计算其值。解释偏离 $2$ 的值如何表示残差自相关，并根据预白化后剩余的相关性来解释计算出的值。报告 Durbin–Watson 统计量的值，要求为精确数值，不进行四舍五入，且不带单位。",
            "solution": "问题要求对应用于 fMRI 数据的通用线性模型 (GLM) 所产生的给定残差序列，推导并计算 Durbin–Watson 统计量，并在预白化的背景下解释其结果。\n\n首先，我们来推导和定义 Durbin–Watson 统计量，记为 $d$。对于一个残差时间序列 $\\{e_t\\}_{t=1}^T$（其中 $T$ 是观测数量），该统计量定义为连续残差的平方差之和与残差平方和的比值：\n$$\nd = \\frac{\\sum_{t=2}^T (e_t - e_{t-1})^2}{\\sum_{t=1}^T e_t^2}\n$$\n这就是问题所要求的作为残差 $\\{e_t\\}$ 函数的表达式。\n\n为了理解该统计量如何与自相关联系起来，我们可以展开分子：\n$$\n\\sum_{t=2}^T (e_t - e_{t-1})^2 = \\sum_{t=2}^T (e_t^2 - 2e_t e_{t-1} + e_{t-1}^2) = \\sum_{t=2}^T e_t^2 + \\sum_{t=2}^T e_{t-1}^2 - 2\\sum_{t=2}^T e_t e_{t-1}\n$$\n展开式中的第二项是 $\\sum_{t=2}^T e_{t-1}^2 = \\sum_{k=1}^{T-1} e_k^2$。对于足够大的样本量 $T$，以下近似成立：$\\sum_{t=2}^T e_t^2 \\approx \\sum_{t=1}^T e_t^2$ 和 $\\sum_{t=1}^{T-1} e_t^2 \\approx \\sum_{t=1}^T e_t^2$。使用这些近似，分子近似变为 $2 \\sum_{t=1}^T e_t^2 - 2 \\sum_{t=2}^T e_t e_{t-1}$。\n\n将此近似代回 $d$ 的定义中：\n$$\nd \\approx \\frac{2 \\sum_{t=1}^T e_t^2 - 2 \\sum_{t=2}^T e_t e_{t-1}}{\\sum_{t=1}^T e_t^2} = 2 \\left( 1 - \\frac{\\sum_{t=2}^T e_t e_{t-1}}{\\sum_{t=1}^T e_t^2} \\right)\n$$\n对于均值为零的序列，样本滞后-$1$ 自相关系数 $\\hat{\\rho}$ 估计为 $\\hat{\\rho} = \\frac{\\sum_{t=2}^T e_t e_{t-1}}{\\sum_{t=1}^T e_t^2}$（假设方差是恒定的，这允许用 $\\sum_{t=1}^T e_t^2$ 替换分母 $\\sqrt{(\\sum_{t=2}^T e_{t-1}^2)(\\sum_{t=2}^T e_t^2)}$）。因此，我们得到了众所周知的近似关系：\n$$\nd \\approx 2(1 - \\hat{\\rho})\n$$\n\n接下来，我们为给定的残差序列计算 $d$ 的值。扫描次数为 $T=8$，残差为：\n$e_1=1$, $e_2=-1$, $e_3=1$, $e_4=-1$, $e_5=1$, $e_6=-1$, $e_7=1$, $e_8=-1$。\n\n首先，我们计算分母，即残差平方和：\n$$\n\\sum_{t=1}^8 e_t^2 = (1)^2 + (-1)^2 + (1)^2 + (-1)^2 + (1)^2 + (-1)^2 + (1)^2 + (-1)^2 = 1+1+1+1+1+1+1+1 = 8\n$$\n\n接下来，我们计算分子，即连续残差的平方差之和：\n\\begin{align*}\n\\sum_{t=2}^8 (e_t - e_{t-1})^2 = (e_2 - e_1)^2 + (e_3 - e_2)^2 + (e_4 - e_3)^2 + (e_5 - e_4)^2 + (e_6 - e_5)^2 + (e_7 - e_6)^2 + (e_8 - e_7)^2 \\\\\n= (-1 - 1)^2 + (1 - (-1))^2 + (-1 - 1)^2 + (1 - (-1))^2 + (-1 - 1)^2 + (1 - (-1))^2 + (-1 - 1)^2 \\\\\n= (-2)^2 + (2)^2 + (-2)^2 + (2)^2 + (-2)^2 + (2)^2 + (-2)^2 \\\\\n= 4 + 4 + 4 + 4 + 4 + 4 + 4 \\\\\n= 7 \\times 4 = 28\n\\end{align*}\n\n现在，我们可以计算 Durbin–Watson 统计量：\n$$\nd = \\frac{28}{8} = \\frac{7}{2} = 3.5\n$$\n\n最后，我们解释这个结果。Durbin–Watson 统计量 $d$ 的取值范围大约在 $0$ 到 $4$ 之间。\n- 如果没有一阶自相关，则 $\\hat{\\rho} \\approx 0$，且 $d \\approx 2(1-0) = 2$。$d$ 值接近 $2$ 表明残差不相关。\n- 如果存在完全正自相关，则 $\\hat{\\rho} \\approx 1$，且 $d \\approx 2(1-1) = 0$。$d$ 值接近 $0$ 表示存在强正自相关。\n- 如果存在完全负自相关（反相关），则 $\\hat{\\rho} \\approx -1$，且 $d \\approx 2(1 - (-1)) = 4$。$d$ 值接近 $4$ 表示存在强负自相关。\n\n计算值为 $d = 3.5$。这个值比 $2$ 更接近 $4$，表明残差中存在强负自相关（反相关）。这一发现与问题的假设一致。噪声被建模为真实参数为 $\\phi_{\\text{true}}$ 的 AR($1$) 过程。旨在消除这种相关性的预白化程序使用了一个被高估的参数 $\\phi_{\\text{pw}}$，即 $\\phi_{\\text{pw}}  \\phi_{\\text{true}}  0$。这种过度校正实际上“减去”了过多前一时间点的信号，从而在转换后的数据中引入了一种新的、人为的负相关。观测到的残差序列 $e_t = (-1)^{t+1}$ 是完全反相关的一个教科书式的例子，而得出的 Durbin–Watson 统计量 $3.5$ 为这种结构提供了定量的确认。与理论最大值 $4$ 的轻微偏差是由于小样本量 ($T=8$) 以及求和中相关的边缘效应造成的，这导致近似式 $d \\approx 2(1-\\hat{\\rho})$ 不精确。",
            "answer": "$$\\boxed{\\frac{7}{2}}$$"
        }
    ]
}