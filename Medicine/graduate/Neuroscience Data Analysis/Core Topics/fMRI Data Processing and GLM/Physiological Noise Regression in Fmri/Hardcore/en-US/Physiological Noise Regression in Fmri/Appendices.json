{
    "hands_on_practices": [
        {
            "introduction": "To effectively correct for physiological noise, we must first understand how it contaminates the fMRI signal. Because the fMRI sampling rate, governed by the Repetition Time ($TR$), is much slower than the frequencies of cardiac and respiratory cycles, these physiological signals are undersampled. This exercise guides you through the fundamental signal processing principle of aliasing, demonstrating mathematically how a high-frequency physiological rhythm can masquerade as a low-frequency artifact in your data . Mastering this concept is the first step toward building robust noise correction models.",
            "id": "4186340",
            "problem": "In functional Magnetic Resonance Imaging (fMRI), physiological oscillations such as respiration introduce periodic fluctuations into the Blood Oxygen Level Dependent (BOLD) signal. The scanner acquires volumes at discrete times separated by the Repetition Time (TR), which imposes a sampling frequency. Consider a continuous-time sinusoidal respiratory signal $r(t) = A \\cos(2\\pi f t + \\phi)$ contributing to the measured BOLD fluctuations. The fMRI system samples the signal at times $t_n = n \\cdot \\mathrm{TR}$ for integer $n$, yielding a discrete-time sequence $r[n] = r(t_n)$. Let the sampling frequency be $f_s = 1/\\mathrm{TR}$.\n\nStarting from the core facts that (i) a sampled sinusoid $r[n]$ can be represented via complex exponentials and (ii) complex exponentials in discrete time are periodic on the integer lattice due to $\\exp\\!\\big(i 2\\pi k n\\big) = 1$ for any integer $k$ and $n$, derive the explicit expression for the discrete-time aliased frequency as a function of the true continuous frequency $f$, the sampling frequency $f_s$, and an integer $k$. Your derivation should clearly identify the discrete-time frequency that is indistinguishable from the original frequency after sampling, and explain why an absolute value and an integer offset are involved.\n\nThen, use the derived relationship to compute the aliased frequency for a respiratory cycle with $f = 0.3$ Hz when $\\mathrm{TR} = 2.0$ s (so that $f_s = 1/\\mathrm{TR}$). Choose the integer $k$ that places the aliased frequency within the principal baseband consistent with the Nyquist interval. Express your final numerical answer in Hertz (Hz).",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Continuous-time signal: $r(t) = A \\cos(2\\pi f t + \\phi)$\n- Sampling times: $t_n = n \\cdot \\mathrm{TR}$ for integer $n$\n- Discrete-time signal: $r[n] = r(t_n)$\n- Sampling frequency: $f_s = 1/\\mathrm{TR}$\n- Core fact (i): A sampled sinusoid $r[n]$ can be represented via complex exponentials.\n- Core fact (ii): For any integers $k$ and $n$, $\\exp(i 2\\pi k n) = 1$.\n- Task 1: Derive the explicit expression for the discrete-time aliased frequency as a function of the true continuous frequency $f$, the sampling frequency $f_s$, and an integer $k$.\n- Task 2: Compute the aliased frequency for a specific case: $f = 0.3$ Hz and $\\mathrm{TR} = 2.0$ s. The integer $k$ must be chosen to place the result in the principal baseband.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the principle of aliasing in digital signal processing, a fundamental concept. Its application to physiological noise in fMRI is a standard and well-understood topic in neuroimaging data analysis. All statements are consistent with established scientific theory.\n- **Well-Posed**: The problem is clearly defined. It requests a specific derivation followed by a calculation using provided values. The objectives are clear, and the given information is sufficient to arrive at a unique solution.\n- **Objective**: The problem is stated in precise, technical language, free from any subjective or biased content.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of the Aliasing Relationship\n\nWe begin with the continuous-time signal, a sinusoidal oscillation with frequency $f$:\n$$\nr(t) = A \\cos(2\\pi f t + \\phi)\n$$\nUsing Euler's formula, $\\cos(x) = \\frac{1}{2}(\\exp(ix) + \\exp(-ix))$, we can express $r(t)$ in terms of complex exponentials:\n$$\nr(t) = \\frac{A}{2} \\left( \\exp\\big(i(2\\pi f t + \\phi)\\big) + \\exp\\big(-i(2\\pi f t + \\phi)\\big) \\right)\n$$\n$$\nr(t) = \\frac{A}{2} \\left( \\exp(i\\phi) \\exp(i 2\\pi f t) + \\exp(-i\\phi) \\exp(-i 2\\pi f t) \\right)\n$$\nThe fMRI system samples this signal at discrete time points $t_n = n \\cdot \\mathrm{TR} = n/f_s$, where $n$ is an integer representing the volume acquisition number and $f_s$ is the sampling frequency. The resulting discrete-time signal is $r[n] = r(t_n)$:\n$$\nr[n] = \\frac{A}{2} \\left( \\exp(i\\phi) \\exp\\left(i 2\\pi f \\frac{n}{f_s}\\right) + \\exp(-i\\phi) \\exp\\left(-i 2\\pi f \\frac{n}{f_s}\\right) \\right)\n$$\nLet us examine one of the complex exponential terms, $\\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right)$. The term $\\frac{f}{f_s}$ is the normalized frequency. The core principle of aliasing stems from the periodicity of the discrete-time complex exponential function. As stated in the problem, for any integers $k$ and $n$, $\\exp(i 2\\pi k n) = 1$.\n\nWe can multiply the exponential term by $\\exp(i 2\\pi k n)$ without changing its value:\n$$\n\\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right) = \\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right) \\cdot \\exp(i 2\\pi k n) = \\exp\\left(i 2\\pi \\left(\\frac{f}{f_s} + k\\right) n\\right)\n$$\nThis mathematical identity shows that a discrete signal generated from a continuous frequency $f$ is indistinguishable from a signal generated from a continuous frequency $f'$ whose normalized frequency is $\\frac{f'}{f_s} = \\frac{f}{fs} + k$. Solving for $f'$ yields:\n$$\nf' = \\left(\\frac{f}{f_s} + k\\right) f_s = f + k f_s\n$$\nThis means that any continuous frequency $f$ and the entire family of frequencies $f + k f_s$ for any integer $k$ are aliases of each other; they produce the exact same sampled sequence.\n\nThe same logic applies to the negative frequency component, which originates from the $\\exp(-i 2\\pi f t)$ term in the cosine expansion. This component is sampled as $\\exp\\left(-i 2\\pi \\frac{f}{f_s} n\\right)$. It is aliased with any frequency $f''$ such that:\n$$\n\\frac{f''}{f_s} = -\\frac{f}{f_s} + k \\implies f'' = -f + k f_s\n$$\nCombining both results, the set of all continuous frequencies that are indistinguishable from the original frequency $f$ after sampling is given by $\\{ \\pm f + k f_s \\mid k \\in \\mathbb{Z} \\}$.\n\nThe aliased frequency, which we denote as $f_a$, is conventionally taken to be the unique frequency in this set that lies within the principal baseband. For a real-valued signal, this interval is $[0, f_s/2]$, also known as the first Nyquist zone. We must find an integer $k$ such that the frequency $f' = \\pm f + k f_s$ falls into this range.\n\nThis process can be described by a more compact formula. The aliased frequency $f_a$ is the frequency in the baseband that has the same \"distance\" from a multiple of the sampling frequency as the original frequency. The expression for the aliased frequency is the minimum absolute difference between the true frequency $f$ and an integer multiple of the sampling frequency $f_s$:\n$$\nf_a = \\min_{k \\in \\mathbb{Z}} |f - k f_s|\n$$\nThe integer $k$ that minimizes this expression is the integer closest to the ratio $f/f_s$, i.e., $k = \\mathrm{round}(f/f_s)$. The explicit expression for the aliased frequency is therefore:\n$$\nf_a = |f - \\mathrm{round}(f/f_s) \\cdot f_s|\n$$\nThe integer offset, represented by the term $k f_s$ (or $\\mathrm{round}(f/f_s) \\cdot f_s$), arises from the $2\\pi$-periodicity of the angle in the discrete complex exponential, which makes spectral information replicate at integer multiples of the sampling frequency. The absolute value is necessary because a real cosine signal contains both positive and negative frequencies ($\\pm f$), and the folding of the frequency spectrum at multiples of $f_s/2$ means that a frequency $f'$ in the range $(f_s/2, f_s)$ is aliased to $f_s-f'$, which is captured by the absolute value operation when the appropriate `k` is chosen.\n\n### Calculation of Aliased Frequency\n\nWe are given the following parameters:\n- True respiratory frequency: $f = 0.3$ Hz.\n- Repetition Time: $\\mathrm{TR} = 2.0$ s.\n\nFirst, we calculate the sampling frequency $f_s$:\n$$\nf_s = \\frac{1}{\\mathrm{TR}} = \\frac{1}{2.0 \\text{ s}} = 0.5 \\text{ Hz}\n$$\nThe principal baseband for a real signal is the interval $[0, f_s/2]$.\n$$\n[0, f_s/2] = [0, 0.5/2] = [0, 0.25 \\text{ Hz}]\n$$\nThe true frequency $f = 0.3$ Hz is outside this interval, so it will be aliased to a lower frequency within the interval. We need to find the integer $k$ that maps $f$ into this baseband. Using the derived relationship $f_a = |f - k f_s|$, we seek the integer $k$ that places $f_a$ in $[0, 0.25]$.\n\nLet's test integer values of $k$:\n- For $k=0$: $f_a = |0.3 - 0 \\cdot 0.5| = 0.3$. This is not in the interval $[0, 0.25]$.\n- For $k=1$: $f_a = |0.3 - 1 \\cdot 0.5| = |-0.2| = 0.2$. This value lies within the interval $[0, 0.25]$.\n\nThus, the correct integer is $k=1$. The observed aliased frequency of the respiratory signal is $0.2$ Hz. This phenomenon is known as spectral folding: the frequency $f = 0.3$ Hz, which is above the Nyquist frequency $f_N = f_s/2 = 0.25$ Hz, is \"folded\" back from the sampling frequency, resulting in an apparent frequency of $f_s - f = 0.5 - 0.3 = 0.2$ Hz. Our general formula using $k=1$ correctly produced this result.\n\nThe final aliased frequency is $0.2$ Hz.",
            "answer": "$$\n\\boxed{0.2}\n$$"
        },
        {
            "introduction": "The RETROICOR method relies on creating regressors from physiological recordings that are precisely phase-aligned with the cardiac and respiratory cycles. Often, a peripheral Photoplethysmogram (PPG) from a finger sensor is used as a convenient proxy for the heart's electrical activity (ECG). This practice problem addresses a critical real-world implementation detail: the significant time delay between an ECG $R$-peak and the arrival of the corresponding pulse wave at the finger . By calculating and correcting for this delay, you ensure that your noise regressors accurately reflect the physiological events influencing the BOLD signal at each slice acquisition time.",
            "id": "4186337",
            "problem": "A functional Magnetic Resonance Imaging (fMRI) dataset is accompanied by concurrent Electrocardiogram (ECG) and finger Photoplethysmogram (PPG) recordings. To apply RETROspective Image CORrection (RETROICOR), the cardiac phase must reflect the timing of the underlying electrical cardiac cycle rather than the delayed peripheral PPG signal. Consider a single brain slice acquired at time $t_s = 12.950\\,\\mathrm{s}$, and three consecutive PPG systolic peak times $t_{\\mathrm{PPG},1} = 12.860\\,\\mathrm{s}$, $t_{\\mathrm{PPG},2} = 13.140\\,\\mathrm{s}$, and $t_{\\mathrm{PPG},3} = 13.420\\,\\mathrm{s}$. The expected delay between the ECG $R$-peak and the finger PPG peak is modeled as the sum of four physiologically grounded components:\n- a pre-ejection period $\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms}$,\n- a pulse wave transit time $\\tau_{\\mathrm{PTT}}$ given by $\\tau_{\\mathrm{PTT}} = L / v$ with path length $L = 0.70\\,\\mathrm{m}$ and pulse wave velocity $v = 6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- a morphology foot-to-peak delay in the PPG waveform $\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms}$,\n- a sensor and filter group delay $\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms}$.\n\nAssume these components are additive and time-invariant over the three beats. Using these assumptions:\n1. Compute the expected total delay $\\tau$ between the ECG $R$-peak and the finger PPG peak.\n2. Use this delay to map the measured PPG peak times $t_{\\mathrm{PPG},i}$ to estimated ECG $R$-peak times $t_{R,i} = t_{\\mathrm{PPG},i} - \\tau$.\n3. Identify the two consecutive estimated $R$-peaks that temporally bracket the slice time $t_s$, and compute the RETROICOR cardiac phase $\\phi$ at $t_s$ defined as $2\\pi$ times the fraction of the bracketing interval that has elapsed by $t_s$.\n\nExpress the final phase $\\phi$ in radians. The final answer must be a single real-valued number or a closed-form analytic expression.",
            "solution": "The user wants me to solve a problem based on the provided information.\n\n### Step 1: Extract Givens\n- Slice acquisition time: $t_s = 12.950\\,\\mathrm{s}$\n- PPG systolic peak times: $t_{\\mathrm{PPG},1} = 12.860\\,\\mathrm{s}$, $t_{\\mathrm{PPG},2} = 13.140\\,\\mathrm{s}$, $t_{\\mathrm{PPG},3} = 13.420\\,\\mathrm{s}$\n- Delay components:\n  - Pre-ejection period: $\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms}$\n  - Pulse wave transit time: $\\tau_{\\mathrm{PTT}} = L / v$, with path length $L = 0.70\\,\\mathrm{m}$ and pulse wave velocity $v = 6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n  - Morphology foot-to-peak delay: $\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms}$\n  - Sensor and filter group delay: $\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms}$\n- Model for ECG R-peak times: $t_{R,i} = t_{\\mathrm{PPG},i} - \\tau$, where $\\tau$ is the total delay.\n- Definition of RETROICOR cardiac phase: $\\phi = 2\\pi \\frac{t_s - t_{R,\\text{prev}}}{t_{R,\\text{next}} - t_{R,\\text{prev}}}$, where $t_{R,\\text{prev}}$ and $t_{R,\\text{next}}$ are the consecutive estimated R-peaks that bracket $t_s$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounded (Critical)**: The problem is scientifically grounded. It describes the RETROspective Image CORrection (RETROICOR) method, a standard technique for physiological noise correction in fMRI. The modeling of the delay between the ECG R-peak and the PPG peak as a sum of constituent physiological and technical delays (pre-ejection period, pulse transit time, etc.) is a valid and commonly used simplification. The numerical values provided for these components are within plausible ranges for human physiology and instrumentation.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data and clear, unambiguous definitions for all quantities to be calculated. The steps required to reach the solution are logically defined, leading to a unique answer.\n- **Objective (Critical)**: The problem is stated in precise, quantitative, and objective language, free from subjective or opinion-based assertions.\n\nThe problem does not violate any of the invalidity criteria. It is a scientifically sound, well-posed, and objective problem from the field of neuroscience data analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Solution\nThe problem requires the calculation of the RETROICOR cardiac phase for a given fMRI slice acquisition time. This is a multi-step process.\n\nFirst, we must compute the total expected delay, $\\tau$, between an ECG $R$-peak and the corresponding finger PPG peak. This delay is given as the sum of four components:\n$$\n\\tau = \\tau_{\\mathrm{PEP}} + \\tau_{\\mathrm{PTT}} + \\tau_{\\mathrm{pk}} + \\tau_{\\mathrm{g}}\n$$\nWe are given the values for $\\tau_{\\mathrm{PEP}}$, $\\tau_{\\mathrm{pk}}$, and $\\tau_{\\mathrm{g}}$. We first need to calculate $\\tau_{\\mathrm{PTT}}$ from the provided path length $L$ and pulse wave velocity $v$:\n$$\n\\tau_{\\mathrm{PTT}} = \\frac{L}{v} = \\frac{0.70\\,\\mathrm{m}}{6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = \\frac{7}{60}\\,\\mathrm{s}\n$$\nNext, we convert all delay components to a common unit, seconds, to calculate the total delay $\\tau$.\n$$\n\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms} = 0.065\\,\\mathrm{s}\n$$\n$$\n\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms} = 0.120\\,\\mathrm{s}\n$$\n$$\n\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms} = 0.035\\,\\mathrm{s}\n$$\nNow we sum the components to find the total delay $\\tau$:\n$$\n\\tau = 0.065\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s} + 0.120\\,\\mathrm{s} + 0.035\\,\\mathrm{s}\n$$\n$$\n\\tau = (0.065 + 0.120 + 0.035)\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s} = 0.220\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s}\n$$\nTo maintain precision, we work with fractions:\n$$\n\\tau = \\frac{220}{1000} + \\frac{7}{60} = \\frac{11}{50} + \\frac{7}{60} = \\frac{11 \\times 6}{300} + \\frac{7 \\times 5}{300} = \\frac{66+35}{300} = \\frac{101}{300}\\,\\mathrm{s}\n$$\n\nSecond, we use this total delay $\\tau$ to estimate the times of the ECG $R$-peaks, $t_{R,i}$, by subtracting the delay from the measured PPG peak times, $t_{\\mathrm{PPG},i}$.\n$$\nt_{R,i} = t_{\\mathrm{PPG},i} - \\tau\n$$\nFor the three given PPG peak times:\n$$\nt_{R,1} = 12.860 - \\frac{101}{300} = \\frac{1286}{100} - \\frac{101}{300} = \\frac{3858 - 101}{300} = \\frac{3757}{300}\\,\\mathrm{s}\n$$\n$$\nt_{R,2} = 13.140 - \\frac{101}{300} = \\frac{1314}{100} - \\frac{101}{300} = \\frac{3942 - 101}{300} = \\frac{3841}{300}\\,\\mathrm{s}\n$$\n$$\nt_{R,3} = 13.420 - \\frac{101}{300} = \\frac{1342}{100} - \\frac{101}{300} = \\frac{4026 - 101}{300} = \\frac{3925}{300}\\,\\mathrm{s}\n$$\nThe decimal representations are approximately $t_{R,1} \\approx 12.5233\\,\\mathrm{s}$, $t_{R,2} \\approx 12.8033\\,\\mathrm{s}$, and $t_{R,3} \\approx 13.0833\\,\\mathrm{s}$.\n\nThird, we identify the two consecutive estimated $R$-peaks that bracket the slice acquisition time, $t_s = 12.950\\,\\mathrm{s}$. We compare $t_s$ to the calculated $t_{R,i}$ values:\n$$\nt_{R,2} \\approx 12.8033\\,\\mathrm{s} < 12.950\\,\\mathrm{s} < 13.0833\\,\\mathrm{s} \\approx t_{R,3}\n$$\nThus, the bracketing $R$-peaks are $t_{R,2}$ and $t_{R,3}$. We set $t_{R,\\text{prev}} = t_{R,2}$ and $t_{R,\\text{next}} = t_{R,3}$.\n\nFinally, we compute the RETROICOR cardiac phase $\\phi$ using the formula provided:\n$$\n\\phi = 2\\pi \\frac{t_s - t_{R,\\text{prev}}}{t_{R,\\text{next}} - t_{R,\\text{prev}}}\n$$\nLet's calculate the numerator and the denominator of the fraction.\nThe time elapsed since the previous $R$-peak is:\n$$\nt_s - t_{R,\\text{prev}} = 12.950\\,\\mathrm{s} - \\frac{3841}{300}\\,\\mathrm{s} = \\frac{1295}{100} - \\frac{3841}{300} = \\frac{3885}{300} - \\frac{3841}{300} = \\frac{44}{300}\\,\\mathrm{s}\n$$\nThe interval between the bracketing $R$-peaks (the $R-R$ interval) is:\n$$\nt_{R,\\text{next}} - t_{R,\\text{prev}} = \\frac{3925}{300}\\,\\mathrm{s} - \\frac{3841}{300}\\,\\mathrm{s} = \\frac{84}{300}\\,\\mathrm{s}\n$$\nNow we can compute the phase $\\phi$:\n$$\n\\phi = 2\\pi \\left( \\frac{\\frac{44}{300}}{\\frac{84}{300}} \\right) = 2\\pi \\left( \\frac{44}{84} \\right) = 2\\pi \\left( \\frac{11}{21} \\right) = \\frac{22\\pi}{21}\n$$\nThe cardiac phase $\\phi$ at the time of slice acquisition is $\\frac{22\\pi}{21}$ radians.",
            "answer": "$$\\boxed{\\frac{22\\pi}{21}}$$"
        },
        {
            "introduction": "Adding nuisance regressors to the General Linear Model (GLM) is a powerful way to account for physiological noise, but this benefit comes at a statistical cost. Each regressor included in the model consumes one \"degree of freedom\" from the data, which has direct implications for statistical inference. This exercise explores the fundamental trade-off between reducing noise variance and preserving statistical power, asking you to derive the expression for residual degrees of freedom and explain how it affects the sensitivity of your statistical tests . Understanding this balance is essential for designing an optimal and efficient fMRI analysis pipeline.",
            "id": "4186366",
            "problem": "You are analyzing a single-run Functional Magnetic Resonance Imaging (fMRI) time series with $n$ temporally ordered samples (time points). The signal at one voxel is modeled using the General Linear Model (GLM) $y = X\\beta + \\varepsilon$, where $y \\in \\mathbb{R}^{n}$ is the observed time series, $X \\in \\mathbb{R}^{n \\times r}$ is the design matrix, $\\beta \\in \\mathbb{R}^{r}$ are regression coefficients, and $\\varepsilon \\in \\mathbb{R}^{n}$ is the noise. Assume that $\\varepsilon$ is a zero-mean Gaussian random vector with covariance $\\sigma^{2} I_{n}$, i.e., $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$, consistent with perfect prewhitening. The design matrix $X$ contains nuisance regressors only: specifically, it includes $k$ physiological noise regressors (e.g., cardiac and respiratory phase models), $m$ head-motion regressors (e.g., rigid-body parameters and their derivatives), and $p$ low-order polynomial trend regressors, with the constant term included among these $p$ polynomial columns. Assume that all columns of $X$ are mutually linearly independent so that the rank of $X$ is equal to the number of its columns.\n\nStarting from the definitions and properties of orthogonal projection matrices in the GLM, derive the residual degrees of freedom available for estimating the noise variance and for the $t$-statistics associated with any single coefficient estimate in this model. Express your final result as a simplified closed-form symbolic expression in terms of $n$, $k$, $m$, and $p$. Then, using first principles about the sampling distribution of $t$ under the stated Gaussian noise model, explain how increasing $k$, $m$, or $p$ affects the null distribution of the $t$-statistic and the implications for statistical power. No numerical rounding is required, and units are not applicable. Your final answer must be a single symbolic expression in $n$, $k$, $m$, and $p$.",
            "solution": "The problem asks for the derivation of the residual degrees of freedom in a General Linear Model (GLM) applied to fMRI data, and an explanation of how the number of nuisance regressors affects statistical inference.\n\nFirst, we validate the problem statement.\n\n**Step 1: Extract Givens**\n-   The model is the GLM: $y = X\\beta + \\varepsilon$.\n-   $y \\in \\mathbb{R}^{n}$: Observed fMRI time series.\n-   $n$: Number of time points.\n-   $X \\in \\mathbb{R}^{n \\times r}$: Design matrix.\n-   $\\beta \\in \\mathbb{R}^{r}$: Regression coefficients.\n-   $\\varepsilon \\in \\mathbb{R}^{n}$: Noise vector.\n-   Noise distribution: $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$.\n-   The design matrix $X$ contains nuisance regressors only, categorized as:\n    -   $k$ physiological noise regressors.\n    -   $m$ head-motion regressors.\n    -   $p$ low-order polynomial trend regressors (including a constant term).\n-   The total number of columns in $X$ is $r = k + m + p$.\n-   The columns of $X$ are linearly independent, so $\\text{rank}(X) = r$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as the GLM is the canonical method for fMRI analysis. The assumptions, such as Gaussian i.i.d. noise (perfect prewhitening), are standard for theoretical derivations. The components of the design matrix are typical nuisance regressors used in practice. The problem is well-posed, with all necessary information provided symbolically ($n, k, m, p$) and the crucial condition of linear independence of regressors stated, which guarantees a unique solution for the model's parameters. The language is objective and precise. The problem is valid.\n\n**Derivation of Residual Degrees of Freedom**\n\nThe General Linear Model is given by $y = X\\beta + \\varepsilon$. Under the assumption that the columns of the design matrix $X$ are linearly independent, the matrix $X^T X$ is invertible. The Ordinary Least Squares (OLS) estimator for the coefficient vector $\\beta$ is:\n$$\n\\hat{\\beta} = (X^T X)^{-1} X^T y\n$$\nThe fitted values, $\\hat{y}$, are the projection of the observed data $y$ onto the column space of $X$, denoted $\\mathcal{C}(X)$. This projection is achieved by the \"hat matrix\" or projection matrix, $P_X$:\n$$\n\\hat{y} = X\\hat{\\beta} = X(X^T X)^{-1} X^T y = P_X y\n$$\nThe hat matrix $P_X = X(X^T X)^{-1} X^T$ is symmetric ($P_X^T = P_X$) and idempotent ($P_X^2 = P_X$).\n\nThe residuals, $e$, are the difference between the observed and fitted values. They represent the portion of the data that is not explained by the model.\n$$\ne = y - \\hat{y} = y - P_X y = (I_n - P_X)y\n$$\nThe matrix $M_X = I_n - P_X$ is the residual-forming matrix. It projects the data vector $y$ onto the space orthogonal to the column space of $X$. Like $P_X$, the matrix $M_X$ is also symmetric and idempotent.\n\nThe Residual Sum of Squares ($RSS$) is the squared Euclidean norm of the residual vector:\n$$\nRSS = e^T e = ((I_n - P_X)y)^T ((I_n - P_X)y) = y^T (I_n - P_X)^T (I_n - P_X) y\n$$\nSince $I_n - P_X$ is symmetric and idempotent, this simplifies to:\n$$\nRSS = y^T (I_n - P_X) y\n$$\nThe degrees of freedom of a sum of squares associated with a quadratic form $z^T A z$, where $z$ is a vector of i.i.d. standard normal variables and $A$ is an idempotent matrix, is equal to the trace of $A$. In our case, substituting $y = X\\beta + \\varepsilon$, we have $e = (I_n - P_X)y = (I_n - P_X)(X\\beta + \\varepsilon) = (I_n - P_X)X\\beta + (I_n-P_X)\\varepsilon$. Since the columns of $X$ are in the column space of $X$ and $I_n-P_X$ projects onto the orthogonal complement, $(I_n - P_X)X = X-P_XX=X-X=0$. Thus, $e = (I_n-P_X)\\varepsilon$. The $RSS$ can be written as:\n$$\nRSS = \\varepsilon^T (I_n - P_X) \\varepsilon\n$$\nSince $\\frac{\\varepsilon}{\\sigma} \\sim \\mathcal{N}(0, I_n)$, it follows from Cochran's theorem that $\\frac{RSS}{\\sigma^2} \\sim \\chi^2(df_{res})$, where the degrees of freedom, $df_{res}$, are given by the trace of the idempotent matrix of the quadratic form.\n$$\ndf_{res} = \\text{tr}(I_n - P_X) = \\text{tr}(I_n) - \\text{tr}(P_X)\n$$\nThe trace of the $n \\times n$ identity matrix is $\\text{tr}(I_n) = n$. The trace of the projection matrix $P_X$ is equal to the rank of the space it projects onto, which is the rank of $X$.\n$$\n\\text{tr}(P_X) = \\text{tr}(X(X^T X)^{-1} X^T) = \\text{tr}(X^T X(X^T X)^{-1}) = \\text{tr}(I_r) = r\n$$\nHere, $r$ is the dimension of the identity matrix $I_r$, which corresponds to the number of columns in $X$.\nThe problem states that the design matrix $X$ is composed of $k$ physiological regressors, $m$ motion regressors, and $p$ polynomial trend regressors. Since all columns are linearly independent, the total number of regressors is:\n$$\nr = k + m + p\n$$\nSubstituting these into the expression for the degrees of freedom, we get:\n$$\ndf_{res} = n - r = n - (k + m + p) = n - k - m - p\n$$\nThis quantity represents the residual degrees of freedom available for estimating the noise variance $\\sigma^2$ (via $\\hat{\\sigma}^2 = \\frac{RSS}{df_{res}}$) and for constructing $t$-statistics. For any single coefficient estimate $\\hat{\\beta}_i$, the corresponding $t$-statistic, under the null hypothesis $H_0: \\beta_i = 0$, follows a Student's $t$-distribution with these same residual degrees of freedom:\n$$\nt = \\frac{\\hat{\\beta}_i}{\\text{SE}(\\hat{\\beta}_i)} \\sim t_{df_{res}}\n$$\n\n**Effect on Null Distribution and Implications for Statistical Power**\n\n1.  **Effect on the Null Distribution**: The null distribution of the $t$-statistic for any single coefficient is the Student's $t$-distribution with $df_{res} = n - k - m - p$ degrees of freedom. Increasing the number of nuisance regressors (increasing $k$, $m$, or $p$) directly reduces the value of $df_{res}$. A $t$-distribution with fewer degrees of freedom has heavier tails and a lower peak (it is more platykurtic) compared to a $t$-distribution with more degrees of freedom. As $df_{res} \\to \\infty$, the $t$-distribution converges to the standard normal distribution, $\\mathcal{N}(0,1)$. Therefore, adding regressors moves the null distribution further away from the normal distribution, resulting in wider confidence intervals for the parameter estimates.\n\n2.  **Implications for Statistical Power**: Statistical power is the probability of correctly rejecting a false null hypothesis. The change in the null distribution has a direct consequence for power. For a fixed significance level $\\alpha$, the critical value $t_{crit}$ that a calculated $t$-statistic must exceed for significance is determined by the null distribution. Specifically, $t_{crit}$ is the value such that $P(|T| > t_{crit} | H_0) = \\alpha$, where $T \\sim t_{df_{res}}$. As $df_{res}$ decreases (due to increased $k, m, p$), the tails of the $t$-distribution become heavier, and the value of $t_{crit}$ required to achieve the same $\\alpha$ level increases. This raising of the statistical threshold, considered in isolation, makes it more difficult to declare a result significant, thus reducing statistical power.\n\nIt is critical to note that this is only one side of a trade-off. The purpose of including nuisance regressors is to model and remove systematic, non-neuronal variance from the time series. If these regressors are effective, they reduce the residual sum of squares ($RSS$), leading to a smaller estimate of the unexplained noise variance, $\\hat{\\sigma}^2$. A smaller $\\hat{\\sigma}^2$ reduces the standard error of the coefficient estimates, $\\text{SE}(\\hat{\\beta}_i)$, which increases the magnitude of the calculated $t$-statistic. This effect acts to *increase* statistical power.\n\nIn summary, the net effect of adding a nuisance regressor on statistical power depends on the balance between two competing effects: the cost of one degree of freedom (which raises the critical value and reduces power) and the benefit of explaining residual variance (which increases the $t$-statistic and increases power). A regressor should only be included if the variance it explains is substantial enough to overcome the penalty of losing a degree of freedom.\n\nThe question, however, specifically asks for the effect on the *null distribution* and its implications. The effect on the null distribution is unambiguously a reduction in degrees of freedom, which increases the critical value for significance. This specific consequence, stemming from the change in the distribution's shape, is a reduction in statistical power, ceteris paribus.\n\nThe final expression for the residual degrees of freedom is $n - k - m - p$.",
            "answer": "$$\n\\boxed{n - k - m - p}\n$$"
        }
    ]
}