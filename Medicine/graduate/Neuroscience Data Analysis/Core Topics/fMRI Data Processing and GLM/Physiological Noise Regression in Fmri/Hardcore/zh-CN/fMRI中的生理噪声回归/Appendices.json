{
    "hands_on_practices": [
        {
            "introduction": "fMRI的一个基本挑战是，诸如呼吸之类的生理信号的频率，高于扫描仪采样率所能完全捕捉的范围。这会导致“混叠”现象(aliasing)，即这些生理信号伪装成低频波动，可能被误认为是神经活动。本练习将引导您完成混叠效应的数学推导，让您对这些伪影的产生机制以及生理噪声校正的必要性有扎实的理解。",
            "id": "4186340",
            "problem": "在功能性磁共振成像（fMRI）中，诸如呼吸等生理振荡会将周期性波动引入到血氧水平依赖（BOLD）信号中。扫描仪以重复时间（TR）为间隔的离散时间点采集数据卷，这就决定了采样频率。考虑一个连续时间的正弦呼吸信号 $r(t) = A \\cos(2\\pi f t + \\phi)$，它对测量到的BOLD波动有贡献。fMRI系统在时间点 $t_n = n \\cdot \\mathrm{TR}$（其中n为整数）对该信号进行采样，得到一个离散时间序列 $r[n] = r(t_n)$。设采样频率为 $f_s = 1/\\mathrm{TR}$。\n\n从以下核心事实出发：(i) 采样后的正弦信号 $r[n]$ 可以通过复指数表示；(ii) 由于对于任意整数 $k$ 和 $n$ 都有 $\\exp\\!\\big(i 2\\pi k n\\big) = 1$，离散时间中的复指数在整数格点上是周期性的。请推导离散时间混叠频率作为真实连续频率 $f$、采样频率 $f_s$ 和整数 $k$ 的函数的显式表达式。你的推导应清楚地指出，在采样后与原始频率无法区分的离散时间频率，并解释为什么会涉及绝对值和整数偏移。\n\n然后，使用推导出的关系式，计算当 $\\mathrm{TR} = 2.0$ s（因此 $f_s = 1/\\mathrm{TR}$）时，一个频率为 $f = 0.3$ Hz 的呼吸周期的混叠频率。选择一个整数 $k$，使混叠频率落在与奈奎斯特区间一致的主基带内。用赫兹（Hz）表示你的最终数值答案。",
            "solution": "首先验证问题，以确保其科学上合理、定义明确且客观。\n\n### 步骤 1：提取已知条件\n- 连续时间信号：$r(t) = A \\cos(2\\pi f t + \\phi)$\n- 采样时间：$t_n = n \\cdot \\mathrm{TR}$，其中n为整数\n- 离散时间信号：$r[n] = r(t_n)$\n- 采样频率：$f_s = 1/\\mathrm{TR}$\n- 核心事实 (i)：采样后的正弦信号 $r[n]$ 可以通过复指数表示。\n- 核心事实 (ii)：对于任意整数 $k$ 和 $n$，$\\exp(i 2\\pi k n) = 1$。\n- 任务 1：推导离散时间混叠频率作为真实连续频率 $f$、采样频率 $f_s$ 和整数 $k$ 的函数的显式表达式。\n- 任务 2：计算特定情况下的混叠频率：$f = 0.3$ Hz 且 $\\mathrm{TR} = 2.0$ s。必须选择整数 $k$ 以将结果置于主基带内。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于数字信号处理中的混叠原理，这是一个基本概念。其在fMRI生理噪声中的应用是神经影像数据分析中一个标准且被充分理解的课题。所有陈述均与已建立的科学理论一致。\n- **定义明确**：该问题定义清晰。它要求进行一次特定的推导，然后使用所提供的值进行计算。目标明确，给出的信息足以得出一个唯一的解。\n- **客观性**：该问题以精确的技术语言陈述，不含任何主观或偏见内容。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 混叠关系的推导\n\n我们从连续时间信号开始，这是一个频率为 $f$ 的正弦振荡：\n$$\nr(t) = A \\cos(2\\pi f t + \\phi)\n$$\n使用欧拉公式 $\\cos(x) = \\frac{1}{2}(\\exp(ix) + \\exp(-ix))$，我们可以用复指数来表示 $r(t)$：\n$$\nr(t) = \\frac{A}{2} \\left( \\exp\\big(i(2\\pi f t + \\phi)\\big) + \\exp\\big(-i(2\\pi f t + \\phi)\\big) \\right)\n$$\n$$\nr(t) = \\frac{A}{2} \\left( \\exp(i\\phi) \\exp(i 2\\pi f t) + \\exp(-i\\phi) \\exp(-i 2\\pi f t) \\right)\n$$\nfMRI系统在离散时间点 $t_n = n \\cdot \\mathrm{TR} = n/f_s$ 对该信号进行采样，其中 $n$ 是表示数据卷采集编号的整数，$f_s$ 是采样频率。得到的离散时间信号是 $r[n] = r(t_n)$：\n$$\nr[n] = \\frac{A}{2} \\left( \\exp(i\\phi) \\exp\\left(i 2\\pi f \\frac{n}{f_s}\\right) + \\exp(-i\\phi) \\exp\\left(-i 2\\pi f \\frac{n}{f_s}\\right) \\right)\n$$\n让我们考察其中一个复指数项 $\\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right)$。项 $\\frac{f}{f_s}$ 是归一化频率。混叠的核心原理源于离散时间复指数函数的周期性。如问题所述，对于任意整数 $k$ 和 $n$，有 $\\exp(i 2\\pi k n) = 1$。\n\n我们可以将指数项乘以 $\\exp(i 2\\pi k n)$ 而不改变其值：\n$$\n\\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right) = \\exp\\left(i 2\\pi \\frac{f}{f_s} n\\right) \\cdot \\exp(i 2\\pi k n) = \\exp\\left(i 2\\pi \\left(\\frac{f}{f_s} + k\\right) n\\right)\n$$\n这个数学恒等式表明，由连续频率 $f$ 生成的离散信号，与由一个其归一化频率为 $\\frac{f'}{f_s} = \\frac{f}{fs} + k$ 的连续频率 $f'$ 生成的信号是无法区分的。解出 $f'$ 得：\n$$\nf' = \\left(\\frac{f}{f_s} + k\\right) f_s = f + k f_s\n$$\n这意味着任何连续频率 $f$ 以及对于任意整数 $k$ 的整个频率族 $f + k f_s$ 互为混叠；它们产生完全相同的采样序列。\n\n同样的逻辑也适用于负频率分量，它源于余弦展开式中的 $\\exp(-i 2\\pi f t)$ 项。该分量被采样为 $\\exp\\left(-i 2\\pi \\frac{f}{f_s} n\\right)$。它与任何满足以下条件的频率 $f''$ 发生混叠：\n$$\n\\frac{f''}{f_s} = -\\frac{f}{f_s} + k \\implies f'' = -f + k f_s\n$$\n结合这两个结果，采样后与原始频率 $f$ 无法区分的所有连续频率的集合由 $\\{ \\pm f + k f_s \\mid k \\in \\mathbb{Z} \\}$ 给出。\n\n混叠频率，我们记作 $f_a$，通常取该集合中位于主基带内的唯一频率。对于实值信号，该区间是 $[0, f_s/2]$，也称为第一奈奎斯特区。我们必须找到一个整数 $k$，使得频率 $f' = \\pm f + k f_s$ 落入此范围内。\n\n这个过程可以用一个更紧凑的公式来描述。混叠频率 $f_a$ 是基带内的一个频率，它与采样频率某个倍数的“距离”同原始频率与该倍数的距离相同。混叠频率的表达式是真实频率 $f$ 与采样频率 $f_s$ 的整数倍之间的最小绝对差：\n$$\nf_a = \\min_{k \\in \\mathbb{Z}} |f - k f_s|\n$$\n最小化此表达式的整数 $k$ 是最接近比值 $f/f_s$ 的整数，即 $k = \\mathrm{round}(f/f_s)$。因此，混叠频率的显式表达式为：\n$$\nf_a = |f - \\mathrm{round}(f/f_s) \\cdot f_s|\n$$\n整数偏移，由项 $k f_s$（或 $\\mathrm{round}(f/f_s) \\cdot f_s$）表示，源于离散复指数中角度的 $2\\pi$ 周期性，这使得频谱信息在采样频率的整数倍处复制。绝对值是必需的，因为一个真实的余弦信号包含正负频率（$\\pm f$），并且频谱在 $f_s/2$ 的倍数处发生折叠，这意味着在 $(f_s/2, f_s)$ 范围内的频率 $f'$ 会混叠到 $f_s-f'$，当选择合适的 `k` 时，这一过程被绝对值运算所捕捉。\n\n### 混叠频率的计算\n\n给定以下参数：\n- 真实呼吸频率：$f = 0.3$ Hz。\n- 重复时间：$\\mathrm{TR} = 2.0$ s。\n\n首先，我们计算采样频率 $f_s$：\n$$\nf_s = \\frac{1}{\\mathrm{TR}} = \\frac{1}{2.0 \\text{ s}} = 0.5 \\text{ Hz}\n$$\n实信号的主基带是区间 $[0, f_s/2]$。\n$$\n[0, f_s/2] = [0, 0.5/2] = [0, 0.25 \\text{ Hz}]\n$$\n真实频率 $f = 0.3$ Hz 在此区间之外，因此它将混叠到区间内的一个较低频率。我们需要找到将 $f$ 映射到此基带的整数 $k$。使用推导出的关系 $f_a = |f - k f_s|$，我们寻找能将 $f_a$ 置于 $[0, 0.25]$ 内的整数 $k$。\n\n让我们测试 $k$ 的整数值：\n- 对于 $k=0$：$f_a = |0.3 - 0 \\cdot 0.5| = 0.3$。这不在区间 $[0, 0.25]$ 内。\n- 对于 $k=1$：$f_a = |0.3 - 1 \\cdot 0.5| = |-0.2| = 0.2$。该值位于区间 $[0, 0.25]$ 内。\n\n因此，正确的整数是 $k=1$。观察到的呼吸信号的混叠频率是 $0.2$ Hz。这种现象被称为频谱折叠：频率 $f = 0.3$ Hz 高于奈奎斯特频率 $f_N = f_s/2 = 0.25$ Hz，它从采样频率处被“折叠”回来，导致一个表观频率为 $f_s - f = 0.5 - 0.3 = 0.2$ Hz。我们使用 $k=1$ 的通用公式正确地得出了这个结果。\n\n最终的混叠频率是 $0.2$ Hz。",
            "answer": "$$\n\\boxed{0.2}\n$$"
        },
        {
            "introduction": "在阐明了混叠问题之后，我们现在转向一个实用的解决方案：回顾性图像校正（RETROspective Image CORrection, RETROICOR）。这种强大的技术需要将心动周期的相位精确地映射到每个采集到的fMRI切片上。本练习模拟了该过程中的一个关键步骤：通过仔细考虑相对于心脏电活动的内在生理和仪器延迟，从外周脉搏血氧（PPG）信号中计算心脏相位。",
            "id": "4186337",
            "problem": "一个功能性磁共振成像 (fMRI) 数据集附带有同步记录的心电图 (ECG) 和手指光电容积描记图 (PPG)。为了应用回溯性图像校正 (RETROspective Image CORrection, RETROICOR)，心脏相位必须反映基础的心脏电周期的时间，而不是延迟的外周 PPG 信号。考虑在时间 $t_s = 12.950\\,\\mathrm{s}$ 采集的单个脑部切片，以及三个连续的 PPG 收缩期峰值时间 $t_{\\mathrm{PPG},1} = 12.860\\,\\mathrm{s}$、$t_{\\mathrm{PPG},2} = 13.140\\,\\mathrm{s}$ 和 $t_{\\mathrm{PPG},3} = 13.420\\,\\mathrm{s}$。ECG 的 $R$ 峰与手指 PPG 峰之间的预期延迟被建模为四个基于生理学的分量之和：\n- 射血前期 $\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms}$，\n- 脉搏波传输时间 $\\tau_{\\mathrm{PTT}}$，由 $\\tau_{\\mathrm{PTT}} = L / v$ 给出，其中路径长度 $L = 0.70\\,\\mathrm{m}$，脉搏波速度 $v = 6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- PPG 波形中的形态学脚点到峰点延迟 $\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms}$，\n- 传感器和滤波器群延迟 $\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms}$。\n\n假设在这三个心跳周期内，这些分量是可加的且不随时间变化。使用这些假设：\n1. 计算 ECG 的 $R$ 峰与手指 PPG 峰之间的预期总延迟 $\\tau$。\n2. 使用此延迟将测量的 PPG 峰值时间 $t_{\\mathrm{PPG},i}$ 映射到估计的 ECG $R$ 峰时间 $t_{R,i} = t_{\\mathrm{PPG},i} - \\tau$。\n3. 找出在时间上包围切片时间 $t_s$ 的两个连续的估计 $R$ 峰，并计算在 $t_s$ 时的 RETROICOR 心脏相位 $\\phi$，其定义为到 $t_s$ 时已流逝的包围时间间隔的分数乘以 $2\\pi$。\n\n以弧度表示最终的相位 $\\phi$。最终答案必须是单个实数值或一个封闭形式的解析表达式。",
            "solution": "用户希望我根据提供的信息解决一个问题。\n\n### 步骤1：提取给定信息\n- 切片采集时间：$t_s = 12.950\\,\\mathrm{s}$\n- PPG 收缩期峰值时间：$t_{\\mathrm{PPG},1} = 12.860\\,\\mathrm{s}$、$t_{\\mathrm{PPG},2} = 13.140\\,\\mathrm{s}$、$t_{\\mathrm{PPG},3} = 13.420\\,\\mathrm{s}$\n- 延迟分量：\n  - 射血前期：$\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms}$\n  - 脉搏波传输时间：$\\tau_{\\mathrm{PTT}} = L / v$，其中路径长度 $L = 0.70\\,\\mathrm{m}$，脉搏波速度 $v = 6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n  - 形态学脚点到峰点延迟：$\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms}$\n  - 传感器和滤波器群延迟：$\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms}$\n- ECG R 峰时间的模型：$t_{R,i} = t_{\\mathrm{PPG},i} - \\tau$，其中 $\\tau$ 是总延迟。\n- RETROICOR 心脏相位的定义：$\\phi = 2\\pi \\frac{t_s - t_{R,\\text{prev}}}{t_{R,\\text{next}} - t_{R,\\text{prev}}}$，其中 $t_{R,\\text{prev}}$ 和 $t_{R,\\text{next}}$ 是包围 $t_s$ 的连续估计 R 峰。\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学性（关键）**：该问题具有科学依据。它描述了回溯性图像校正 (RETROICOR) 方法，这是一种用于 fMRI 生理噪声校正的标准技术。将 ECG R 峰和 PPG 峰之间的延迟建模为生理和技术延迟（射血前期、脉搏传输时间等）组成部分之和，是一种有效且常用的简化方法。为这些分量提供的数值在人体生理学和仪器测量的合理范围内。\n- **适定性**：该问题是适定的。它提供了所有必要的数据以及对所有待计算量的清晰、明确的定义。得出解决方案所需的步骤逻辑清晰，导向唯一的答案。\n- **客观性（关键）**：该问题以精确、定量和客观的语言陈述，没有主观或基于意见的断言。\n\n该问题不违反任何无效性标准。这是一个来自神经科学数据分析领域的、科学合理、适定且客观的问题。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供详细的解答。\n\n### 解题过程\n该问题要求计算给定 fMRI 切片采集时间的 RETROICOR 心脏相位。这是一个多步骤的过程。\n\n首先，我们必须计算 ECG $R$ 峰与相应的手指 PPG 峰之间的总预期延迟 $\\tau$。该延迟由四个分量之和给出：\n$$\n\\tau = \\tau_{\\mathrm{PEP}} + \\tau_{\\mathrm{PTT}} + \\tau_{\\mathrm{pk}} + \\tau_{\\mathrm{g}}\n$$\n我们已知 $\\tau_{\\mathrm{PEP}}$、$\\tau_{\\mathrm{pk}}$ 和 $\\tau_{\\mathrm{g}}$ 的值。我们首先需要根据给定的路径长度 $L$ 和脉搏波速度 $v$ 计算 $\\tau_{\\mathrm{PTT}}$：\n$$\n\\tau_{\\mathrm{PTT}} = \\frac{L}{v} = \\frac{0.70\\,\\mathrm{m}}{6.0\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = \\frac{7}{60}\\,\\mathrm{s}\n$$\n接下来，我们将所有延迟分量转换为同一单位（秒），以计算总延迟 $\\tau$。\n$$\n\\tau_{\\mathrm{PEP}} = 65\\,\\mathrm{ms} = 0.065\\,\\mathrm{s}\n$$\n$$\n\\tau_{\\mathrm{pk}} = 120\\,\\mathrm{ms} = 0.120\\,\\mathrm{s}\n$$\n$$\n\\tau_{\\mathrm{g}} = 35\\,\\mathrm{ms} = 0.035\\,\\mathrm{s}\n$$\n现在我们将这些分量相加，求得总延迟 $\\tau$：\n$$\n\\tau = 0.065\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s} + 0.120\\,\\mathrm{s} + 0.035\\,\\mathrm{s}\n$$\n$$\n\\tau = (0.065 + 0.120 + 0.035)\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s} = 0.220\\,\\mathrm{s} + \\frac{7}{60}\\,\\mathrm{s}\n$$\n为保持精度，我们使用分数进行计算：\n$$\n\\tau = \\frac{220}{1000} + \\frac{7}{60} = \\frac{11}{50} + \\frac{7}{60} = \\frac{11 \\times 6}{300} + \\frac{7 \\times 5}{300} = \\frac{66+35}{300} = \\frac{101}{300}\\,\\mathrm{s}\n$$\n\n其次，我们使用这个总延迟 $\\tau$ 从测量的 PPG 峰值时间 $t_{\\mathrm{PPG},i}$ 中减去该延迟，从而估计 ECG $R$ 峰的时间 $t_{R,i}$。\n$$\nt_{R,i} = t_{\\mathrm{PPG},i} - \\tau\n$$\n对于给定的三个 PPG 峰值时间：\n$$\nt_{R,1} = 12.860 - \\frac{101}{300} = \\frac{1286}{100} - \\frac{101}{300} = \\frac{3858 - 101}{300} = \\frac{3757}{300}\\,\\mathrm{s}\n$$\n$$\nt_{R,2} = 13.140 - \\frac{101}{300} = \\frac{1314}{100} - \\frac{101}{300} = \\frac{3942 - 101}{300} = \\frac{3841}{300}\\,\\mathrm{s}\n$$\n$$\nt_{R,3} = 13.420 - \\frac{101}{300} = \\frac{1342}{100} - \\frac{101}{300} = \\frac{4026 - 101}{300} = \\frac{3925}{300}\\,\\mathrm{s}\n$$\n其小数值约等于 $t_{R,1} \\approx 12.5233\\,\\mathrm{s}$，$t_{R,2} \\approx 12.8033\\,\\mathrm{s}$ 和 $t_{R,3} \\approx 13.0833\\,\\mathrm{s}$。\n\n第三，我们找出包围切片采集时间 $t_s = 12.950\\,\\mathrm{s}$ 的两个连续的估计 $R$ 峰。我们将 $t_s$ 与计算出的 $t_{R,i}$ 值进行比较：\n$$\nt_{R,2} \\approx 12.8033\\,\\mathrm{s}  12.950\\,\\mathrm{s}  13.0833\\,\\mathrm{s} \\approx t_{R,3}\n$$\n因此，包围的 $R$ 峰是 $t_{R,2}$ 和 $t_{R,3}$。我们设定 $t_{R,\\text{prev}} = t_{R,2}$ 和 $t_{R,\\text{next}} = t_{R,3}$。\n\n最后，我们使用提供的公式计算 RETROICOR 心脏相位 $\\phi$：\n$$\n\\phi = 2\\pi \\frac{t_s - t_{R,\\text{prev}}}{t_{R,\\text{next}} - t_{R,\\text{prev}}}\n$$\n我们来计算分数的分子和分母。\n自上一个 $R$ 峰以来经过的时间是：\n$$\nt_s - t_{R,\\text{prev}} = 12.950\\,\\mathrm{s} - \\frac{3841}{300}\\,\\mathrm{s} = \\frac{1295}{100} - \\frac{3841}{300} = \\frac{3885}{300} - \\frac{3841}{300} = \\frac{44}{300}\\,\\mathrm{s}\n$$\n包围 $R$ 峰之间的时间间隔（R-R 间期）是：\n$$\nt_{R,\\text{next}} - t_{R,\\text{prev}} = \\frac{3925}{300}\\,\\mathrm{s} - \\frac{3841}{300}\\,\\mathrm{s} = \\frac{84}{300}\\,\\mathrm{s}\n$$\n现在我们可以计算相位 $\\phi$：\n$$\n\\phi = 2\\pi \\left( \\frac{\\frac{44}{300}}{\\frac{84}{300}} \\right) = 2\\pi \\left( \\frac{44}{84} \\right) = 2\\pi \\left( \\frac{11}{21} \\right) = \\frac{22\\pi}{21}\n$$\n切片采集时刻的心脏相位 $\\phi$ 为 $\\frac{22\\pi}{21}$ 弧度。",
            "answer": "$$\\boxed{\\frac{22\\pi}{21}}$$"
        },
        {
            "introduction": "虽然在通用线性模型（General Linear Model, GLM）中加入生理噪声回归量对于净化fMRI数据至关重要，但这种益处并非没有统计学上的代价。模型中增加的每一个回归量都会消耗一个自由度，这会影响我们统计检验的敏感度。最后一个练习将深入探讨这一关键的权衡，要求您推导残差自由度并解释其对统计功效的影响，从而培养对模型构建的深入理解。",
            "id": "4186366",
            "problem": "您正在分析一个单次运行的功能磁共振成像（fMRI）时间序列，该序列包含 $n$ 个按时间排序的样本（时间点）。单个体素的信号使用通用线性模型（GLM）$y = X\\beta + \\varepsilon$ 进行建模，其中 $y \\in \\mathbb{R}^{n}$ 是观测到的时间序列，$X \\in \\mathbb{R}^{n \\times r}$ 是设计矩阵，$\\beta \\in \\mathbb{R}^{r}$ 是回归系数，$\\varepsilon \\in \\mathbb{R}^{n}$ 是噪声。假设 $\\varepsilon$ 是一个零均值高斯随机向量，其协方差为 $\\sigma^{2} I_{n}$，即 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$，这与完美的预白化处理一致。设计矩阵 $X$ 仅包含干扰回归量：具体来说，它包括 $k$ 个生理噪声回归量（例如，心跳和呼吸相位模型）、$m$ 个头动回归量（例如，刚体参数及其导数）以及 $p$ 个低阶多项式趋势回归量，其中常数项包含在这 $p$ 个多项式列中。假设 $X$ 的所有列相互线性无关，因此 $X$ 的秩等于其列数。\n\n从 GLM 中正交投影矩阵的定义和性质出发，推导可用于估计噪声方差以及与该模型中任何单个系数估计相关的 $t$ 统计量的残差自由度。将您的最终结果表示为以 $n$、$k$、$m$ 和 $p$ 表示的简化闭式符号表达式。然后，根据所述高斯噪声模型下 $t$ 的抽样分布的基本原理，解释增加 $k$、$m$ 或 $p$ 如何影响 $t$ 统计量的零分布及其对统计功效的影响。无需数值四舍五入，单位不适用。您的最终答案必须是关于 $n$、$k$、$m$ 和 $p$ 的单个符号表达式。",
            "solution": "问题要求推导应用于 fMRI 数据的通用线性模型（GLM）中的残差自由度，并解释干扰回归量的数量如何影响统计推断。\n\n首先，我们验证问题陈述。\n\n**步骤 1：提取已知条件**\n-   模型为 GLM：$y = X\\beta + \\varepsilon$。\n-   $y \\in \\mathbb{R}^{n}$：观测到的 fMRI 时间序列。\n-   $n$：时间点数量。\n-   $X \\in \\mathbb{R}^{n \\times r}$：设计矩阵。\n-   $\\beta \\in \\mathbb{R}^{r}$：回归系数。\n-   $\\varepsilon \\in \\mathbb{R}^{n}$：噪声向量。\n-   噪声分布：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$。\n-   设计矩阵 $X$ 仅包含干扰回归量，分类如下：\n    -   $k$ 个生理噪声回归量。\n    -   $m$ 个头动回归量。\n    -   $p$ 个低阶多项式趋势回归量（包括一个常数项）。\n-   $X$ 的总列数为 $r = k + m + p$。\n-   $X$ 的列是线性无关的，因此 $\\text{rank}(X) = r$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为 GLM 是 fMRI 分析的经典方法。诸如高斯独立同分布噪声（完美预白化）等假设是理论推导的标准假设。设计矩阵的组成部分是实践中使用的典型干扰回归量。问题是适定的（well-posed），所有必要信息都以符号（$n, k, m, p$）形式提供，并且陈述了回归量线性无关的关键条件，这保证了模型参数的唯一解。语言客观而精确。该问题是有效的。\n\n**残差自由度的推导**\n\n通用线性模型由 $y = X\\beta + \\varepsilon$ 给出。在设计矩阵 $X$ 的列线性无关的假设下，矩阵 $X^T X$ 是可逆的。系数向量 $\\beta$ 的普通最小二乘（OLS）估计量为：\n$$\n\\hat{\\beta} = (X^T X)^{-1} X^T y\n$$\n拟合值 $\\hat{y}$ 是观测数据 $y$ 在 $X$ 的列空间（记为 $\\mathcal{C}(X)$）上的投影。该投影通过“帽子矩阵”或投影矩阵 $P_X$ 实现：\n$$\n\\hat{y} = X\\hat{\\beta} = X(X^T X)^{-1} X^T y = P_X y\n$$\n帽子矩阵 $P_X = X(X^T X)^{-1} X^T$ 是对称的（$P_X^T = P_X$）和幂等的（$P_X^2 = P_X$）。\n\n残差 $e$ 是观测值与拟合值之间的差。它们代表了数据中未被模型解释的部分。\n$$\ne = y - \\hat{y} = y - P_X y = (I_n - P_X)y\n$$\n矩阵 $M_X = I_n - P_X$ 是残差生成矩阵。它将数据向量 $y$ 投影到与 $X$ 的列空间正交的空间上。与 $P_X$ 类似，矩阵 $M_X$ 也是对称和幂等的。\n\n残差平方和（$RSS$）是残差向量的欧几里得范数的平方：\n$$\nRSS = e^T e = ((I_n - P_X)y)^T ((I_n - P_X)y) = y^T (I_n - P_X)^T (I_n - P_X) y\n$$\n由于 $I_n - P_X$ 是对称和幂等的，这可以简化为：\n$$\nRSS = y^T (I_n - P_X) y\n$$\n对于二次型 $z^T A z$，其中 $z$ 是一个由独立同分布的标准正态变量组成的向量，$A$ 是一个幂等矩阵，与其相关的平方和的自由度等于 $A$ 的迹。在我们的情况下，代入 $y = X\\beta + \\varepsilon$，我们得到 $e = (I_n - P_X)y = (I_n - P_X)(X\\beta + \\varepsilon) = (I_n - P_X)X\\beta + (I_n-P_X)\\varepsilon$。由于 $X$ 的列位于 $X$ 的列空间中，而 $I_n-P_X$ 投影到其正交补上，所以 $(I_n - P_X)X = X-P_XX=X-X=0$。因此，$e = (I_n-P_X)\\varepsilon$。$RSS$ 可以写成：\n$$\nRSS = \\varepsilon^T (I_n - P_X) \\varepsilon\n$$\n由于 $\\frac{\\varepsilon}{\\sigma} \\sim \\mathcal{N}(0, I_n)$，根据 Cochran 定理，可知 $\\frac{RSS}{\\sigma^2} \\sim \\chi^2(df_{res})$，其中自由度 $df_{res}$ 由二次型的幂等矩阵的迹给出。\n$$\ndf_{res} = \\text{tr}(I_n - P_X) = \\text{tr}(I_n) - \\text{tr}(P_X)\n$$\n$n \\times n$ 单位矩阵的迹是 $\\text{tr}(I_n) = n$。投影矩阵 $P_X$ 的迹等于它所投影到的空间的秩，也就是 $X$ 的秩。\n$$\n\\text{tr}(P_X) = \\text{tr}(X(X^T X)^{-1} X^T) = \\text{tr}(X^T X(X^T X)^{-1}) = \\text{tr}(I_r) = r\n$$\n这里，$r$ 是单位矩阵 $I_r$ 的维度，它对应于 $X$ 中的列数。\n问题陈述设计矩阵 $X$ 由 $k$ 个生理回归量、$m$ 个运动回归量和 $p$ 个多项式趋势回归量组成。由于所有列都是线性无关的，回归量的总数为：\n$$\nr = k + m + p\n$$\n将这些代入自由度的表达式中，我们得到：\n$$\ndf_{res} = n - r = n - (k + m + p) = n - k - m - p\n$$\n这个量代表了可用于估计噪声方差 $\\sigma^2$（通过 $\\hat{\\sigma}^2 = \\frac{RSS}{df_{res}}$）和构建 $t$ 统计量的残差自由度。对于任何单个系数估计 $\\hat{\\beta}_i$，在零假设 $H_0: \\beta_i = 0$ 下，相应的 $t$ 统计量服从具有相同残差自由度的学生t分布（Student's $t$-distribution）：\n$$\nt = \\frac{\\hat{\\beta}_i}{\\text{SE}(\\hat{\\beta}_i)} \\sim t_{df_{res}}\n$$\n\n**对零分布的影响及其对统计功效的启示**\n\n1.  **对零分布的影响**：任何单个系数的 $t$ 统计量的零分布是自由度为 $df_{res} = n - k - m - p$ 的学生t分布。增加干扰回归量的数量（即增加 $k$、$m$ 或 $p$）会直接减少 $df_{res}$ 的值。与具有更多自由度的 $t$ 分布相比，自由度较少的 $t$ 分布具有更重的尾部和更低的峰（即更平阔）。当 $df_{res} \\to \\infty$ 时，$t$ 分布收敛于标准正态分布 $\\mathcal{N}(0,1)$。因此，增加回归量会使零分布离正态分布更远，从而导致参数估计的置信区间更宽。\n\n2.  **对统计功效的启示**：统计功效是正确拒绝一个错误的零假设的概率。零分布的变化对功效有直接影响。对于一个固定的显著性水平 $\\alpha$，计算出的 $t$ 统计量要达到显著性所必须超过的临界值 $t_{crit}$ 是由零分布决定的。具体来说，$t_{crit}$ 是满足 $P(|T| > t_{crit} | H_0) = \\alpha$ 的值，其中 $T \\sim t_{df_{res}}$。随着 $df_{res}$ 的减少（由于 $k, m, p$ 的增加），$t$ 分布的尾部变得更重，为达到相同的 $\\alpha$ 水平所需的 $t_{crit}$ 值会增加。单独来看，这种统计阈值的提高使得宣告结果显著变得更加困难，从而降低了统计功效。\n\n需要注意的是，这只是权衡的一方面。包含干扰回归量的目的是为了建模并从时间序列中移除系统的、非神经元的方差。如果这些回归量是有效的，它们会减少残差平方和（$RSS$），从而导致对未解释噪声方差的估计值 $\\hat{\\sigma}^2$ 变小。较小的 $\\hat{\\sigma}^2$ 会减小系数估计的标准误 $\\text{SE}(\\hat{\\beta}_i)$，这会增加计算出的 $t$ 统计量的绝对值。这种效应会*增加*统计功效。\n\n总之，增加一个干扰回归量对统计功效的净效应取决于两种相互竞争的效应之间的平衡：损失一个自由度的代价（这会提高临界值并降低功效）和解释残差方差的收益（这会增加 $t$ 统计量并增加功效）。只有当一个回归量所解释的方差足够大，能够克服损失一个自由度的代价时，才应该将其包含进来。\n\n然而，问题具体询问的是对*零分布*的影响及其启示。对零分布的影响明确无误地是自由度的减少，这会增加显著性的临界值。由分布形状变化引起的这一特定后果是，在其他条件不变的情况下（ceteris paribus），统计功效会降低。\n\n残差自由度的最终表达式是 $n - k - m - p$。",
            "answer": "$$\n\\boxed{n - k - m - p}\n$$"
        }
    ]
}