{
    "hands_on_practices": [
        {
            "introduction": "通用线性模型（GLM）的核心在于其设计矩阵 $X$。然而，这个矩阵是如何从我们关于神经信号的理论假设构建出来的呢？本练习将信号处理中的离散卷积概念与GLM的线性代数框架联系起来。通过从第一性原理推导有限脉冲响应（FIR）模型的设计矩阵，您将深刻理解我们如何能够灵活地对血流动力学响应进行建模，而不局限于单一的“标准”形状。这项技能对于探索性数据分析和研究血流动力学响应可能存在差异的特殊人群至关重要。",
            "id": "4199556",
            "problem": "你正在使用通用线性模型（GLM）分析一次单运行（single-run）事件相关功能性磁共振成像（fMRI）实验。设 $N$ 表示采集到的功能像体积（volumes）数量，重复时间（TR）在整个运行过程中保持不变。考虑一个任务条件 $c$，其起始时间由在索引集 $\\{0,1,\\dots,N-1\\}$ 上定义的离散时间刺激指示向量 $\\mathbf{s}^{(c)} \\in \\{0,1\\}^{N}$ 编码，其中如果条件 $c$ 的一个起始事件发生在时间索引 $t$，则 $s^{(c)}_{t} = 1$，否则 $s^{(c)}_{t} = 0$。假设一个线性时不变的血流动力学系统，因此预测的血氧水平依赖（BOLD）信号由刺激与血流动力学响应函数（HRF）的离散时间卷积给出。在非参数方法中，将HRF近似为一个具有 $L$ 个时间窗（time bins）的有限脉冲响应（FIR）模型，这意味着HRF由 $L$ 个未知系数表示，每个系数对应窗口 $\\{0,1,\\dots,L-1\\}$ 内的一个延迟时间窗。\n\n仅从离散时间卷积的定义和上述因果、有限支撑的FIR假设出发，定义条件 $c$ 的FIR模型，并构建相应的、用于非参数化估计HRF形状的设计子矩阵 $X^{(c)} \\in \\mathbb{R}^{N \\times L}$。你的构建必须是逐个元素进行的，也就是说，你必须为 $X^{(c)}$ 的 $(t,\\ell)$ 项提供一个闭式解析表达式，该表达式仅用刺激指示向量 $\\mathbf{s}^{(c)}$ 以及索引 $t \\in \\{0,1,\\dots,N-1\\}$ 和 $\\ell \\in \\{0,1,\\dots,L-1\\}$ 来表示。你可以使用离散时间指示函数 $\\mathbf{1}_{A}$，如果条件 $A$ 成立，其值为 $1$，否则为 $0$。将你的最终答案表示为单个无单位的闭式解析表达式。",
            "solution": "问题要求在一个事件相关fMRI实验中，为单个条件构建设计子矩阵，其中血流动力学响应使用有限脉冲响应（FIR）基组进行非参数化建模。该构建必须从第一性原理推导得出，即一个刺激指示向量与一个未知FIR滤波器的离散时间卷积。\n\n设 $\\mathbf{y} \\in \\mathbb{R}^{N}$ 是在 $N$ 个时间点上测得的单个体素的血氧水平依赖（BOLD）信号，时间点由 $t \\in \\{0, 1, \\dots, N-1\\}$ 索引。通用线性模型（GLM）假设该信号可以建模为预测变量的线性组合加上噪声：\n$$ \\mathbf{y} = X \\boldsymbol{\\beta} + \\boldsymbol{\\epsilon} $$\n其中 $X$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是待估计的未知参数向量，$\\boldsymbol{\\epsilon}$ 是残差向量。\n\n我们的目标是构建设计矩阵中对应于单个任务条件 $c$ 的特定部分 $X^{(c)} \\in \\mathbb{R}^{N \\times L}$。相关的参数 $\\boldsymbol{\\beta}^{(c)} \\in \\mathbb{R}^{L}$ 是血流动力学响应函数（HRF）的FIR模型的未知系数。因此，由条件 $c$ 引起的预测BOLD信号由 $\\mathbf{y}_{\\text{pred}}^{(c)} = X^{(c)} \\boldsymbol{\\beta}^{(c)}$ 给出。\n\n问题指出该系统是线性时不变（LTI）的。因此，在时间 $t$ 的预测BOLD信号，记为 $(y_{\\text{pred}}^{(c)})_t$，是刺激指示向量 $\\mathbf{s}^{(c)}$ 与我们记为 $h$ 的HRF的离散时间卷积。卷积定义为：\n$$ (y_{\\text{pred}}^{(c)})_t = (\\mathbf{s}^{(c)} * h)_t = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} h(t-\\tau) $$\n问题指定了一个HRF的非参数FIR模型。这意味着HRF被表示为 $L$ 个时移脉冲的加权和。设未知权重（即HRF在不同时间延迟处的高度）为系数 $\\beta^{(c)}_0, \\beta^{(c)}_1, \\dots, \\beta^{(c)}_{L-1}$。HRF $h(k)$ 是为离散时间延迟 $k$ 定义的。FIR模型假设HRF是因果的，并且具有 $L$ 个时间窗的有限支撑，因此 $h(k)$ 仅在 $k \\in \\{0, 1, \\dots, L-1\\}$ 时非零。我们可以将HRF写为：\n$$ h(k) = \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\delta(k - \\ell) $$\n其中 $\\delta(m)$ 是离散时间脉冲或Kronecker δ函数，当 $m=0$ 时为 $1$，否则为 $0$。参数 $\\beta^{(c)}_{\\ell}$ 代表HRF在刺激后第 $\\ell$ 个时间窗的值。\n\n我们将 $h(k)$ 的这个FIR定义代入卷积方程。在卷积和中，$h$ 的自变量是 $(t-\\tau)$，所以我们将 $k$ 替换为 $(t-\\tau)$：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\left( \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\delta((t-\\tau) - \\ell) \\right) $$\n由于求和是在有限范围内进行的，我们可以交换它们的顺序：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\left( \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\delta(t - \\tau - \\ell) \\right) $$\n这个表达式现在是未知参数 $\\beta^{(c)}_{\\ell}$ 的线性组合形式。这与GLM的结构相匹配。矩阵方程 $\\mathbf{y}_{\\text{pred}}^{(c)} = X^{(c)} \\boldsymbol{\\beta}^{(c)}$ 的第 $t$ 行是：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\ell=0}^{L-1} X^{(c)}_{t,\\ell} \\beta^{(c)}_{\\ell} $$\n通过将其与重新排列后的卷积方程进行比较，我们可以确定设计子矩阵的元素 $X^{(c)}_{t,\\ell}$：\n$$ X^{(c)}_{t,\\ell} = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\delta(t - \\tau - \\ell) $$\nKronecker δ项 $\\delta(t - \\tau - \\ell)$ 仅当其自变量为零时非零（等于 $1$），即当 $t - \\tau - \\ell = 0$ 时，这意味着 $\\tau = t - \\ell$。对于任何其他 $\\tau$ 值，该项为零。因此，对 $\\tau$ 的求和坍缩为单个项，在 $\\tau = t - \\ell$ 处求值，前提是这个 $\\tau$ 值在求和边界 $[0, N-1]$ 内。\n\n$\\tau$ 的值是 $t-\\ell$。矩阵元素的索引是 $t \\in \\{0, 1, \\dots, N-1\\}$ 和 $\\ell \\in \\{0, 1, \\dots, L-1\\}$。\n我们来检查一下 $\\tau=t-\\ell$ 是否在 $s^{(c)}_{\\tau}$ 索引的有效范围内。\n1.  下界：$\\tau \\ge 0 \\implies t-\\ell \\ge 0 \\implies t \\ge \\ell$。\n2.  上界：$\\tau \\le N-1 \\implies t-\\ell \\le N-1$。由于 $t$ 的最大值是 $N-1$ 且 $\\ell$ 的最小值是 $0$，所以 $t-\\ell$ 的最大值是 $(N-1)-0 = N-1$。因此，对于给定的 $t$ 和 $\\ell$ 的范围，条件 $t-\\ell \\le N-1$ 总是满足的。\n\n所以，如果 $t  \\ell$，则 $\\tau = t-\\ell$ 的值为负，落在求和范围之外。在这种情况下，没有 $\\tau \\in [0, N-1]$ 能使δ函数非零，求和结果为 $0$。\n如果 $t \\ge \\ell$，则 $\\tau = t-\\ell$ 的值落在求和范围内。求和坍缩为单个项 $s^{(c)}_{t-\\ell} \\cdot 1 = s^{(c)}_{t-\\ell}$。\n\n我们可以使用离散时间指示函数 $\\mathbf{1}_{A}$ 来表示这种情形区分，当条件 $A$ 为真时其值为 $1$，否则为 $0$。非零元素的条件是 $t \\ge \\ell$。\n因此，设计子矩阵 $X^{(c)}$ 的第 $t$ 行和第 $\\ell$ 列的元素由下式给出：\n$$ X^{(c)}_{t,\\ell} = s^{(c)}_{t-\\ell} \\cdot \\mathbf{1}_{t \\ge \\ell} $$\n这个表达式就是所要求的闭式表示。它通过取刺激指示向量 $\\mathbf{s}^{(c)}$ 并将其向下平移 $\\ell$ 个时间步，并在顶部填充零，来构建设计矩阵的每一列 $\\ell$。这是构建FIR设计矩阵的标准方法，并且此推导从第一性原理验证了它。",
            "answer": "$$\\boxed{s^{(c)}_{t-\\ell} \\mathbf{1}_{t \\ge \\ell}}$$"
        },
        {
            "introduction": "在构建了设计矩阵中的回归量之后，简单地将它们纳入模型是不够的，我们如何预处理这些回归量会极大地影响模型的解释。本练习探讨了一个简单的线性变换——均值中心化——如何影响回归量之间的正交性，并改变模型参数的解释，特别是截距项（$\\beta_0$）。理解这种关系不仅是数学上的好奇，更是解释大脑区域基线活动以及构建参数估计值相关性较低的统计稳健模型的实际需要。",
            "id": "4199568",
            "problem": "您正在分析功能性磁共振成像 (fMRI) 中的单个体素、经预处理的血氧水平依赖 (BOLD) 时间序列，该序列使用广义线性模型 (GLM) 进行建模。令观测到的时间序列为 $y \\in \\mathbb{R}^{T}$，并考虑一个包含一个截距项和一个任务回归量 $r \\in \\mathbb{R}^{T}$ 的设计，其中回归量 $r$ 是通过将二元刺激 $u$ 与典型血流动力学响应函数 $h$ 进行卷积得到的。假设存在加性噪声 $ \\varepsilon \\in \\mathbb{R}^{T}$，其均值为零，方差有限，并且适当的预处理已使误差可以很好地近似为随时间独立同方差。您对同一数据拟合了两个 GLM：\n1. 未中心化模型 $y = \\beta_{0}\\mathbf{1} + \\beta_{1} r + \\varepsilon$。\n2. 均值中心化模型 $y = \\alpha_{0}\\mathbf{1} + \\alpha_{1} r_{c} + \\varepsilon$，其中 $r_{c} = r - \\bar{r}\\,\\mathbf{1}$ 且 $\\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r$。\n\n从 GLM 和普通最小二乘法准则的定义出发，根据第一性原理推导对 $r$ 进行均值中心化如何改变系数的解释，并影响其与截距项的正交结构。具体而言，请展示 $r_{c}$ 与截距项 $\\mathbf{1}$ 之间的正交性，并通过令两个 GLM 的拟合值相等来关联它们的参数化。您的最终任务是，用未中心化系数 $\\beta_{0}$、$\\beta_{1}$ 和均值 $\\bar{r}$ 来表示均值中心化截距系数 $\\alpha_{0}$，给出一个单一的闭式解析表达式。\n\n最终答案仅报告所要求的 $\\alpha_{0}$ 的解析表达式。无需进行数值四舍五入。",
            "solution": "我们从观测到的时间序列 $y \\in \\mathbb{R}^{T}$ 的广义线性模型 (GLM) 表示开始：\n$$\ny = X\\beta + \\varepsilon,\n$$\n其中 $X$ 是设计矩阵，$\\beta$ 是回归系数。在未中心化模型中，设计矩阵为 $X = [\\mathbf{1}\\ \\ r]$，参数向量为 $\\beta = \\begin{pmatrix}\\beta_{0} \\\\ \\beta_{1}\\end{pmatrix}$，得到\n$$\ny = \\beta_{0}\\mathbf{1} + \\beta_{1} r + \\varepsilon.\n$$\n在均值中心化模型中，我们定义\n$$\nr_{c} = r - \\bar{r}\\,\\mathbf{1}, \\quad \\text{with} \\quad \\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r,\n$$\n设计矩阵变为 $X_{c} = [\\mathbf{1}\\ \\ r_{c}]$，参数向量为 $\\alpha = \\begin{pmatrix}\\alpha_{0} \\\\ \\alpha_{1}\\end{pmatrix}$，得到\n$$\ny = \\alpha_{0}\\mathbf{1} + \\alpha_{1} r_{c} + \\varepsilon.\n$$\n\n首先，我们确立均值中心化回归量 $r_{c}$ 与截距项 $\\mathbf{1}$ 的正交性。计算其内积：\n$$\n\\mathbf{1}^{\\top} r_{c} = \\mathbf{1}^{\\top}(r - \\bar{r}\\,\\mathbf{1}) = \\mathbf{1}^{\\top} r - \\bar{r}\\,\\mathbf{1}^{\\top}\\mathbf{1}.\n$$\n根据定义，$\\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r$，因此\n$$\n\\mathbf{1}^{\\top} r_{c} = \\mathbf{1}^{\\top} r - \\left(\\frac{1}{T}\\mathbf{1}^{\\top} r\\right) \\cdot T = \\mathbf{1}^{\\top} r - \\mathbf{1}^{\\top} r = 0.\n$$\n因此，在欧几里得内积下，$r_{c}$ 与截距项 $\\mathbf{1}$ 正交。这一性质直接影响普通最小二乘法中的正规方程，并简化了对截距的解释。\n\n接下来，我们通过用 $r_{c}$ 表示 $r$ 来关联这两种参数化：\n$$\nr = r_{c} + \\bar{r}\\,\\mathbf{1}.\n$$\n将此代入未中心化模型，以在中心化基下获得相同的拟合值：\n$$\n\\beta_{0}\\mathbf{1} + \\beta_{1} r\n= \\beta_{0}\\mathbf{1} + \\beta_{1}(r_{c} + \\bar{r}\\,\\mathbf{1})\n= (\\beta_{0} + \\beta_{1}\\bar{r})\\mathbf{1} + \\beta_{1} r_{c}.\n$$\n由于两个模型描述的是相同的数据且共享相同的误差过程，因此拟合值相等要求共同基向量 $\\mathbf{1}$ 和 $r_{c}$ 上的系数相匹配：\n$$\n\\alpha_{0} = \\beta_{0} + \\beta_{1}\\bar{r}, \\quad \\alpha_{1} = \\beta_{1}.\n$$\n\n这种重参数化展示了由均值中心化引起的解释上的变化。在未中心化模型中，$\\beta_{0}$ 是当 $r = 0$ 时 $y$ 的预测值（即回归量振幅为零时的基线），而 $\\beta_{1}$ 则衡量 $r$ 每单位变化所引起的 $y$ 的变化。均值中心化后，正交性质 $\\mathbf{1}^{\\top} r_{c} = 0$ 意味着普通最小二乘法的正规方程将截距项与 $r_{c}$ 解耦，从而得到一个等于 $y$ 的样本均值的截距估计值：\n$$\n\\alpha_{0} = \\bar{y}, \\quad \\text{where} \\quad \\bar{y} = \\frac{1}{T}\\mathbf{1}^{\\top} y,\n$$\n在中心化设计的标准普通最小二乘解下。相应地，斜率保持不变，即 $\\alpha_{1} = \\beta_{1}$，因为中心化是一种线性重参数化，它不改变构成 $r$ 的列空间中的方向；它只是改变了截距项和回归量之间共享方差的分配。\n\n因此，所要求的以未中心化参数和回归量均值表示的均值中心化截距 $\\alpha_{0}$ 的闭式解析表达式为\n$$\n\\alpha_{0} = \\beta_{0} + \\beta_{1}\\bar{r}.\n$$",
            "answer": "$$\\boxed{\\beta_{0}+\\beta_{1}\\,\\bar{r}}$$"
        },
        {
            "introduction": "fMRI分析的最终目标是检验科学假设。我们如何将一个复杂的科学问题，例如“这个脑区是否存在任何与任务相关的活动？”，转化为GLM框架下的一个正式统计检验呢？本练习展示了如何使用F检验来评估关于多个参数的联合假设，其核心思想是比较一个完整模型与一个体现了零假设的嵌套受限模型之间的拟合优度（残差平方和）。掌握F检验使您能够超越对单个回归量的检验，转而提出关于任务总体效应或一组基函数贡献的更广泛问题。",
            "id": "4199521",
            "problem": "考虑一个由广义线性模型 (GLM) 建模的单体素功能性磁共振成像 (fMRI) 时间序列，其中观测数据向量为 $y \\in \\mathbb{R}^{T}$，设计矩阵为 $X \\in \\mathbb{R}^{T \\times p}$。GLM 假设 $y = X\\beta + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{T})$，在时间上独立同分布。该体素的设计矩阵 $X$ 包含 $p$ 列：两个与标准血流动力学响应函数卷积的任务回归量（第 $1$ 列和第 $2$ 列）、一个参数调制器（第 $3$ 列）、一个截距项（第 $4$ 列），以及三个头动伪差回归量（第 $5$ 列到第 $7$ 列）。你感兴趣的是检验任务诱发的响应不存在的联合零假设：$H_{0}: \\beta_{1} = 0$ 且 $\\beta_{2} = 0$，该假设被表述为广义线性假设 $C\\beta = 0$。\n\n你的任务是：\n- 构建一个明确的对比矩阵 $C$，用以在上述 GLM 中编码 $H_{0}: \\beta_{1} = 0$ 且 $\\beta_{2} = 0$。\n- 从高斯噪声和普通最小二乘估计的假设出发，通过残差平方和的差异推导 F 统计量，该统计量用于比较约束模型（施加 $C\\beta = 0$）与完整模型。明确说明分子和分母的自由度。\n- 使用以下从该体素的最小二乘拟合中获得的科学上合理的值：扫描次数 $T = 240$，回归量数量 $p = 7$，完整模型的残差平方和 $\\mathrm{SSE}_{\\mathrm{full}} = 375.4$，以及约束模型的残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = 401.0$。根据你的推导计算 F 统计量的值。将最终数值四舍五入至四位有效数字。将最终答案表示为一个无单位的纯数字。",
            "solution": "#### 1. 对比矩阵 $C$ 的构建\n\nGLM 由 $y = X\\beta + \\varepsilon$ 给出，其中参数向量 $\\beta$ 是 $\\mathbb{R}^{p}$ 中的一个列向量。给定 $p=7$，参数向量为 $\\beta = [\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6, \\beta_7]^T$。$\\beta$ 的各分量与指定的设计矩阵 $X$ 的列相对应。\n\n零假设 $H_0$ 是任务诱发的响应不存在，即 $\\beta_1 = 0$ 且 $\\beta_2 = 0$。这表示对参数向量 $\\beta$ 的一组两个联立线性约束。我们需要将其表述为 $C\\beta=0$ 形式的广义线性假设。\n\n矩阵 $C$ 的构建必须使得乘积 $C\\beta$ 产生一个代表零假设中表达式的向量。由于有两个约束，矩阵 $C$ 将有两行。列数必须与 $\\beta$ 的维度相匹配，即 $p=7$。设 $C$ 的秩为 $q$。\n\n第一个约束是 $\\beta_1 = 0$。这可以写成一个向量与 $\\beta$ 的点积：\n$$1 \\cdot \\beta_1 + 0 \\cdot \\beta_2 + 0 \\cdot \\beta_3 + 0 \\cdot \\beta_4 + 0 \\cdot \\beta_5 + 0 \\cdot \\beta_6 + 0 \\cdot \\beta_7 = 0$$\n这对应于 $C$ 的第一行为 $[1, 0, 0, 0, 0, 0, 0]$。\n\n第二个约束是 $\\beta_2 = 0$。这可以写成：\n$$0 \\cdot \\beta_1 + 1 \\cdot \\beta_2 + 0 \\cdot \\beta_3 + 0 \\cdot \\beta_4 + 0 \\cdot \\beta_5 + 0 \\cdot \\beta_6 + 0 \\cdot \\beta_7 = 0$$\n这对应于 $C$ 的第二行为 $[0, 1, 0, 0, 0, 0, 0]$。\n\n将这两行组合起来得到对比矩阵 $C$：\n$$C = \\begin{pmatrix} 1  0  0  0  0  0  0 \\\\ 0  1  0  0  0  0  0 \\end{pmatrix}$$\n该矩阵的行是线性无关的，所以其秩为 $q = 2$。\n\n#### 2. F 统计量的推导\n\nF 统计量用于比较完整模型与嵌套于其中的约束模型。约束模型是通过在完整模型 $y = X\\beta + \\varepsilon$ 上施加零假设 $H_0: C\\beta=0$ 得到的。\n\n完整模型有 $p$ 个参数。$\\beta$ 的普通最小二乘 (OLS) 估计是 $\\hat{\\beta} = (X^T X)^{-1} X^T y$。完整模型的残差平方和是：\n$$\\mathrm{SSE}_{\\mathrm{full}} = \\|y - X\\hat{\\beta}\\|^2 = (y - X\\hat{\\beta})^T(y - X\\hat{\\beta})$$\n在误差 $\\varepsilon$ 呈正态分布的假设下，标准化的残差平方和服从卡方分布：\n$$\\frac{\\mathrm{SSE}_{\\mathrm{full}}}{\\sigma^2} \\sim \\chi^2_{T-p}$$\n自由度 $df_2 = T-p$ 是观测数量 $T$ 减去完整模型中的参数数量 $p$。量 $\\hat{\\sigma}^2 = \\frac{\\mathrm{SSE}_{\\mathrm{full}}}{T-p}$ 是误差方差 $\\sigma^2$ 的一个无偏估计量。\n\n约束模型是在由 $H_0: C\\beta=0$ 定义的 $q$ 个线性约束下进行估计的。在这些约束下的 OLS 估计产生一个估计值 $\\hat{\\beta}_{\\mathrm{rest}}$ 和相应的残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = \\|y - X\\hat{\\beta}_{\\mathrm{rest}}\\|^2$。根据定义，由于约束模型是完整模型的一个特例，因此有 $\\mathrm{SSE}_{\\mathrm{rest}} \\ge \\mathrm{SSE}_{\\mathrm{full}}$。\n\n由约束引起的残差平方和的增加量是 $\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}$。根据线性模型理论的一个标准结果，在零假设下，这个差值经过标准化后也服从一个卡方分布，且独立于 $\\mathrm{SSE}_{\\mathrm{full}}$。\n$$\\frac{\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}}{\\sigma^2} \\sim \\chi^2_q$$\n自由度 $df_1 = q$ 是施加的线性无关约束的数量，也就是矩阵 $C$ 的秩。\n\nF 统计量定义为两个独立的卡方随机变量分别除以其各自自由度后的比率。\n$$F = \\frac{(\\text{假设的平方和}) / (\\text{假设的自由度})}{(\\text{残差平方和}) / (\\text{残差自由度})}$$\n代入上面推导出的表达式：\n$$F = \\frac{(\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}) / q}{\\mathrm{SSE}_{\\mathrm{full}} / (T-p)}$$\n在零假设 $H_0$ 下，该统计量服从自由度为 $q$ 和 $T-p$ 的 F 分布，记作 $F \\sim F_{q, T-p}$。未知的方差项 $\\sigma^2$ 在该比率中被方便地消去了。\n\n此 F 检验的自由度为：\n-   分子自由度：$df_1 = q = \\mathrm{rank}(C)$。\n-   分母自由度：$df_2 = T - p$。\n\n#### 3. F 统计量的计算\n\n我们已知以下数值：\n-   扫描次数 $T = 240$。\n-   回归量数量 $p = 7$。\n-   约束数量 $q = 2$（来自 $C$ 的秩）。\n-   完整模型的残差平方和 $\\mathrm{SSE}_{\\mathrm{full}} = 375.4$。\n-   约束模型的残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = 401.0$。\n\n首先，我们确定自由度：\n-   分子自由度：$df_1 = q = 2$。\n-   分母自由度：$df_2 = T - p = 240 - 7 = 233$。\n\n现在，我们将这些值代入 F 统计量公式：\n$$F = \\frac{(\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}) / q}{\\mathrm{SSE}_{\\mathrm{full}} / (T-p)}$$\n$$F = \\frac{(401.0 - 375.4) / 2}{375.4 / (240 - 7)}$$\n$$F = \\frac{25.6 / 2}{375.4 / 233}$$\n$$F = \\frac{12.8}{1.611158798...}$$\n$$F \\approx 7.944592435...$$\n\n将结果四舍五入至四位有效数字，得到 $7.945$。",
            "answer": "$$\\boxed{7.945}$$"
        }
    ]
}