{
    "hands_on_practices": [
        {
            "introduction": "In functional MRI, brain volumes are acquired one slice at a time, leading to small but significant timing differences between slices within the same volume. To ensure temporal consistency before modeling brain activity, these offsets must be corrected through a process called slice timing correction (STC). This exercise  provides hands-on practice in calculating the precise acquisition time for each slice based on scanner parameters and understanding how these timing vectors are used to resample the data, a process rooted in the time-shift property of the Fourier transform.",
            "id": "4163858",
            "problem": "A researcher is converting Digital Imaging and Communications in Medicine (DICOM) functional Magnetic Resonance Imaging (fMRI) data to Neuroimaging Informatics Technology Initiative (NIfTI) format. The data were acquired using Echo Planar Imaging (EPI) with interleaved ascending slice acquisition, single-band (no simultaneous multi-slice), and constant per-slice acquisition spacing across the repetition time. The scanner log indicates the following acquisition pattern: within each volume, slices with even index are acquired first in ascending order, followed by slices with odd index in ascending order. Consider the resulting NIfTI volume indexed by slice number from $0$ (inferior-most) to $N-1$ (superior-most). Assume the Blood Oxygenation Level Dependent (BOLD) signal is sampled once per repetition time with slice-dependent offsets, and that the total slice acquisition spans the entire repetition time.\n\nGiven:\n- Repetition time $T_R = 1.6$ seconds.\n- Number of slices $N = 16$.\n- Interleaved ascending order: $\\{0, 2, 4, \\dots, 14, 1, 3, 5, \\dots, 15\\}$ within each volume.\n\nTask:\n1. Compute the NIfTI SliceTiming vector of length $N$ in seconds, ordered by slice index from $0$ to $N-1$, where the $i$-th entry is the acquisition time offset (in seconds) of slice $i$ relative to the start of the volume.\n2. Briefly explain, starting from the definition of discrete-time sampling and the time-shift property of the Fourier transform, how slice timing correction algorithms use this vector to resample each sliceâ€™s time series to a common reference time.\n\nExpress the vector entries in seconds. Use exact values; do not round.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains sufficient, consistent information to derive a unique solution. The scenario described is a standard procedure in functional magnetic resonance imaging (fMRI) data preprocessing.\n\nThe overall task is to first compute the slice acquisition times for a given fMRI acquisition protocol and then explain the theoretical basis for slice timing correction.\n\n**Part 1: Computation of the SliceTiming Vector**\n\nThe problem specifies that $N=16$ slices are acquired within one repetition time, $T_R = 1.6$ seconds. The acquisition spans the entire repetition time with a constant per-slice acquisition spacing. This means the time between the acquisition of any two consecutive slices in the acquisition sequence is constant. This time interval, $\\Delta t$, can be calculated as:\n$$\n\\Delta t = \\frac{T_R}{N} = \\frac{1.6 \\, \\text{s}}{16} = 0.1 \\, \\text{s}\n$$\nThe acquisition order is specified as interleaved ascending, where all even-indexed slices are acquired first, followed by all odd-indexed slices. The slice indices range from $0$ to $N-1 = 15$. The explicit acquisition sequence, ordered by time, is therefore:\n$$\n\\{0, 2, 4, 6, 8, 10, 12, 14, 1, 3, 5, 7, 9, 11, 13, 15\\}\n$$\nThe acquisition time for a given slice is determined by its position in this sequence. Let the temporal position in the sequence be denoted by $p$, where $p$ ranges from $0$ to $N-1 = 15$. The acquisition time offset for the slice acquired at temporal position $p$ is $p \\times \\Delta t$.\n\nWe need to find the acquisition time for each slice, ordered by the slice index $i$ from $0$ to $15$. Let $t_i$ be the acquisition time for the slice with index $i$.\n\nFor even-indexed slices, $i = 2k$ where $k \\in \\{0, 1, \\dots, 7\\}$:\nThe slice with index $i=2k$ is the $(k+1)$-th slice to be acquired. Its temporal position is $p=k$.\nThus, its acquisition time is:\n$$\nt_{2k} = k \\times \\Delta t = k \\times 0.1 \\, \\text{s}\n$$\n\nFor odd-indexed slices, $i = 2k+1$ where $k \\in \\{0, 1, \\dots, 7\\}$:\nThese slices are acquired after all $N/2=8$ even slices have been acquired. The first odd slice in the sequence is index $1$ (corresponding to $k=0$), and its temporal position is $p=8$. The odd slice with index $i=2k+1$ is the $(k+1)$-th odd slice to be acquired. Its temporal position in the overall sequence is $p = (N/2) + k = 8 + k$.\nThus, its acquisition time is:\n$$\nt_{2k+1} = (8+k) \\times \\Delta t = (8+k) \\times 0.1 \\, \\text{s}\n$$\n\nUsing these formulae, we can compute the time for each slice index $i \\in \\{0, 1, \\dots, 15\\}$:\n$t_0 = 0 \\times 0.1 = 0.0$ s\n$t_1 = (8+0) \\times 0.1 = 0.8$ s\n$t_2 = 1 \\times 0.1 = 0.1$ s\n$t_3 = (8+1) \\times 0.1 = 0.9$ s\n$t_4 = 2 \\times 0.1 = 0.2$ s\n$t_5 = (8+2) \\times 0.1 = 1.0$ s\n$t_6 = 3 \\times 0.1 = 0.3$ s\n$t_7 = (8+3) \\times 0.1 = 1.1$ s\n$t_8 = 4 \\times 0.1 = 0.4$ s\n$t_9 = (8+4) \\times 0.1 = 1.2$ s\n$t_{10} = 5 \\times 0.1 = 0.5$ s\n$t_{11} = (8+5) \\times 0.1 = 1.3$ s\n$t_{12} = 6 \\times 0.1 = 0.6$ s\n$t_{13} = (8+6) \\times 0.1 = 1.4$ s\n$t_{14} = 7 \\times 0.1 = 0.7$ s\n$t_{15} = (8+7) \\times 0.1 = 1.5$ s\n\nThe NIfTI SliceTiming vector is the list of these acquisition times, ordered by slice index from $0$ to $15$.\n\n**Part 2: Principle of Slice Timing Correction**\n\nThe SliceTiming vector computed above provides the acquisition time offset $t_i$ for each slice $i$ relative to the start of the volume acquisition. Slice timing correction (STC) algorithms use this information to resample each slice's time series to a common reference time, thereby mitigating artifacts in subsequent analyses (e.g., event-related analysis) that assume all data within a volume were acquired simultaneously.\n\nThe underlying principle of STC is rooted in the concepts of discrete-time sampling and the time-shift property of the Fourier transform. The BOLD signal for any given voxel is a continuous function of time, $s(t)$. For a voxel in slice $i$, this signal is sampled at discrete time points corresponding to each volume acquisition, but with an offset $t_i$. The sampled time series for a voxel in slice $i$ across $M$ volumes is therefore $x_i[k] = s(k T_R + t_i)$, for $k=0, 1, \\dots, M-1$.\n\nThe goal of STC is to estimate the signal values as if they had been acquired at a common reference time for all slices. Let this reference time be an offset $t_{\\text{ref}}$ relative to the start of the volume (e.g., $t_{\\text{ref}}=0$ for the first slice, or $t_{\\text{ref}}=T_R/2$ for the middle of the acquisition window). We wish to find the values $x_i^{\\text{corr}}[k] = s(k T_R + t_{\\text{ref}})$. This is equivalent to shifting the original continuous signal $s(t)$ by a time $\\Delta t_i = t_{\\text{ref}} - t_i$.\n\nThe time-shift property of the continuous Fourier transform states that if a signal $f(t)$ has a Fourier transform $F(\\omega)$, then the time-shifted signal $f(t - \\tau)$ has the Fourier transform $F(\\omega) \\exp(-j\\omega\\tau)$. This property provides a direct method for performing non-integer time shifts, which are generally required for STC since the required shift $\\Delta t_i$ is not necessarily a multiple of the sampling interval $T_R$.\n\nThe STC algorithm proceeds as follows:\n1. For each voxel's time series $x_i[k]$, compute its Discrete Fourier Transform (DFT), yielding the frequency-domain representation $X_i[m]$, where $m$ is the frequency index.\n2. For each frequency component $m$, apply a phase shift. To shift the signal in time by $\\Delta t_i = t_{\\text{ref}} - t_i$, the complex value $X_i[m]$ is multiplied by a phase factor $\\exp(-j \\omega_m \\Delta t_i)$, where $\\omega_m = \\frac{2\\pi m}{M T_R}$ is the angular frequency corresponding to index $m$. The corrected frequency-domain signal is $X_i^{\\text{corr}}[m] = X_i[m] \\exp\\left(-j \\frac{2\\pi m}{M T_R} \\Delta t_i\\right)$.\n3. Compute the Inverse Discrete Fourier Transform (IDFT) of $X_i^{\\text{corr}}[m]$ to obtain the corrected time-domain signal $x_i^{\\text{corr}}[k]$. This new time series represents the BOLD signal resampled to the common reference time $t_{\\text{ref}}$.\n\nThis Fourier-based interpolation is theoretically equivalent to performing convolution with a sinc function in the time domain, which is the ideal method for resampling a band-limited signal. The SliceTiming vector is thus the critical input that specifies the required shift $\\Delta t_i$ for each slice.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0 & 0.8 & 0.1 & 0.9 & 0.2 & 1.0 & 0.3 & 1.1 & 0.4 & 1.2 & 0.5 & 1.3 & 0.6 & 1.4 & 0.7 & 1.5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Subject head motion is a primary source of artifact in fMRI data, potentially confounding statistical results. Therefore, quantifying this motion is essential for quality control and subsequent artifact mitigation. This exercise  demonstrates how to compute a summary metric of instantaneous head motion from the raw realignment parameters. By calculating Framewise Displacement ($FD$) and applying a threshold, you will practice a common and effective method for identifying and flagging high-motion time points for exclusion, a critical quality control step known as \"scrubbing\".",
            "id": "4163860",
            "problem": "A research team is building a preprocessing pipeline for functional Magnetic Resonance Imaging (fMRI) data and needs to decide which volumes to scrub based on head motion. In rigid-body realignment, each volume is described by six motion parameters: three translations along the orthogonal axes and three rotations about those axes. The goal is to quantify, at each time point, the instantaneous displacement experienced by a point on the surface of the head when moving from the previous volume to the current volume. Assume the head can be locally approximated by a sphere of radius $r = 50$ mm, and that the rotational increments are sufficiently small for the small-angle approximation to apply, with arc length given by $s = r \\theta$ for angle $\\theta$ measured in radians.\n\nUsing the following realignment parameter time series for $t = 1, 2, \\dots, 8$, where translations are in millimeters and rotations (yaw, pitch, roll) are in degrees, compute the per-frame displacement series by summing the absolute contributions from the three translations and the three rotation-induced arc lengths. Specifically, convert the rotation differences from degrees to radians before multiplying by $r$. Define the displacement at $t=1$ to be $0$ because there is no prior volume. A frame is flagged for scrubbing if its displacement exceeds the threshold $\\tau = 0.5$ mm.\n\nMotion parameters at each time point $t$:\n- $t=1$: translations $(0.00, 0.00, 0.00)$ mm; rotations $(0.00, 0.00, 0.00)$ degrees.\n- $t=2$: translations $(0.10, -0.05, 0.02)$ mm; rotations $(0.10, -0.05, 0.00)$ degrees.\n- $t=3$: translations $(0.15, -0.08, 0.01)$ mm; rotations $(0.20, -0.04, 0.02)$ degrees.\n- $t=4$: translations $(0.50, 0.10, -0.10)$ mm; rotations $(0.80, 0.00, -0.20)$ degrees.\n- $t=5$: translations $(0.55, 0.12, -0.05)$ mm; rotations $(0.85, 0.05, -0.25)$ degrees.\n- $t=6$: translations $(0.60, 0.20, -0.10)$ mm; rotations $(1.00, 0.05, -0.30)$ degrees.\n- $t=7$: translations $(0.45, 0.18, -0.15)$ mm; rotations $(0.80, 0.05, -0.28)$ degrees.\n- $t=8$: translations $(0.46, 0.21, -0.12)$ mm; rotations $(0.82, 0.10, -0.30)$ degrees.\n\nUsing this displacement-based scrubbing criterion, determine the total number of frames that must be scrubbed. Express your final answer as a pure number without units. No rounding specification is necessary because the final answer is an exact count.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a valid computational problem in the domain of neuroscience data analysis.\n\nThe problem requires us to calculate a per-frame displacement metric for a series of fMRI volumes and determine how many frames exceed a given scrubbing threshold. The displacement at each time point $t$ is the sum of the absolute displacements caused by translation and rotation relative to the previous time point, $t-1$.\n\nLet the six motion parameters at time $t$ be denoted by the vector $P(t) = (T_x(t), T_y(t), T_z(t), R_x(t), R_y(t), R_z(t))$, where $T_i$ are translations in millimeters and $R_i$ are rotations in degrees. The radius of the head is given as $r = 50$ mm. The scrubbing threshold is $\\tau = 0.5$ mm.\n\nThe displacement $D(t)$ at time $t$ for $t > 1$ is defined as the sum of absolute translational changes and absolute rotation-induced arc length changes from time $t-1$ to $t$. The displacement at $t=1$ is defined as $D(1) = 0$.\n\nThe change in translation for each axis $i \\in \\{x, y, z\\}$ is:\n$$ \\Delta T_i(t) = T_i(t) - T_i(t-1) $$\nThe change in rotation for each axis $i \\in \\{x, y, z\\}$ in degrees is:\n$$ \\Delta R_i(t) = R_i(t) - R_i(t-1) $$\nTo calculate the arc length, the rotational change must be converted from degrees to radians. The conversion is $1 \\text{ degree} = \\frac{\\pi}{180} \\text{ radians}$. The change in radians is:\n$$ \\Delta \\theta_i(t) = \\Delta R_i(t) \\cdot \\frac{\\pi}{180} $$\nThe total displacement $D(t)$ is the sum of the absolute values of these contributions:\n$$ D(t) = \\sum_{i \\in \\{x,y,z\\}} |\\Delta T_i(t)| + \\sum_{i \\in \\{x,y,z\\}} r |\\Delta \\theta_i(t)| $$\nSubstituting the expression for $\\Delta \\theta_i(t)$:\n$$ D(t) = \\sum_{i \\in \\{x,y,z\\}} |\\Delta T_i(t)| + r \\frac{\\pi}{180} \\sum_{i \\in \\{x,y,z\\}} |\\Delta R_i(t)| $$\nWith $r=50$ mm, the formula becomes:\n$$ D(t) = \\sum_{i=x,y,z} |\\Delta T_i(t)| + \\frac{50\\pi}{180} \\sum_{i=x,y,z} |\\Delta R_i(t)| = \\sum_{i=x,y,z} |\\Delta T_i(t)| + \\frac{5\\pi}{18} \\sum_{i=x,y,z} |\\Delta R_i(t)| $$\nA frame at time $t$ is scrubbed if $D(t) > \\tau = 0.5$ mm. We will now compute $D(t)$ for each time point from $t=2$ to $t=8$.\n\n**For $t=2$:**\n$\\Delta T(2) = (0.10, -0.05, 0.02)$ mm.\n$\\sum |\\Delta T(2)| = |0.10| + |-0.05| + |0.02| = 0.17$ mm.\n$\\Delta R(2) = (0.10, -0.05, 0.00)$ degrees.\n$\\sum |\\Delta R(2)| = |0.10| + |-0.05| + |0.00| = 0.15$ degrees.\n$D(2) = 0.17 + \\frac{5\\pi}{18} \\cdot 0.15 = 0.17 + \\frac{0.75\\pi}{18} = 0.17 + \\frac{\\pi}{24} \\approx 0.17 + 0.131 = 0.301$ mm.\n$D(2) \\le 0.5$. Frame is not scrubbed.\n\n**For $t=3$:**\n$\\Delta T(3) = (0.15-0.10, -0.08-(-0.05), 0.01-0.02) = (0.05, -0.03, -0.01)$ mm.\n$\\sum |\\Delta T(3)| = 0.05 + 0.03 + 0.01 = 0.09$ mm.\n$\\Delta R(3) = (0.20-0.10, -0.04-(-0.05), 0.02-0.00) = (0.10, 0.01, 0.02)$ degrees.\n$\\sum |\\Delta R(3)| = 0.10 + 0.01 + 0.02 = 0.13$ degrees.\n$D(3) = 0.09 + \\frac{5\\pi}{18} \\cdot 0.13 = 0.09 + \\frac{0.65\\pi}{18} = 0.09 + \\frac{13\\pi}{360} \\approx 0.09 + 0.113 = 0.203$ mm.\n$D(3) \\le 0.5$. Frame is not scrubbed.\n\n**For $t=4$:**\n$\\Delta T(4) = (0.50-0.15, 0.10-(-0.08), -0.10-0.01) = (0.35, 0.18, -0.11)$ mm.\n$\\sum |\\Delta T(4)| = 0.35 + 0.18 + 0.11 = 0.64$ mm.\n$\\Delta R(4) = (0.80-0.20, 0.00-(-0.04), -0.20-0.02) = (0.60, 0.04, -0.22)$ degrees.\n$\\sum |\\Delta R(4)| = 0.60 + 0.04 + 0.22 = 0.86$ degrees.\n$D(4) = 0.64 + \\frac{5\\pi}{18} \\cdot 0.86 = 0.64 + \\frac{4.3\\pi}{18} = 0.64 + \\frac{43\\pi}{180} \\approx 0.64 + 0.750 = 1.390$ mm.\n$D(4) > 0.5$. Frame is scrubbed.\n\n**For $t=5$:**\n$\\Delta T(5) = (0.55-0.50, 0.12-0.10, -0.05-(-0.10)) = (0.05, 0.02, 0.05)$ mm.\n$\\sum |\\Delta T(5)| = 0.05 + 0.02 + 0.05 = 0.12$ mm.\n$\\Delta R(5) = (0.85-0.80, 0.05-0.00, -0.25-(-0.20)) = (0.05, 0.05, -0.05)$ degrees.\n$\\sum |\\Delta R(5)| = 0.05 + 0.05 + 0.05 = 0.15$ degrees.\n$D(5) = 0.12 + \\frac{5\\pi}{18} \\cdot 0.15 = 0.12 + \\frac{\\pi}{24} \\approx 0.12 + 0.131 = 0.251$ mm.\n$D(5) \\le 0.5$. Frame is not scrubbed.\n\n**For $t=6$:**\n$\\Delta T(6) = (0.60-0.55, 0.20-0.12, -0.10-(-0.05)) = (0.05, 0.08, -0.05)$ mm.\n$\\sum |\\Delta T(6)| = 0.05 + 0.08 + 0.05 = 0.18$ mm.\n$\\Delta R(6) = (1.00-0.85, 0.05-0.05, -0.30-(-0.25)) = (0.15, 0.00, -0.05)$ degrees.\n$\\sum |\\Delta R(6)| = 0.15 + 0.00 + 0.05 = 0.20$ degrees.\n$D(6) = 0.18 + \\frac{5\\pi}{18} \\cdot 0.20 = 0.18 + \\frac{\\pi}{18} \\approx 0.18 + 0.175 = 0.355$ mm.\n$D(6) \\le 0.5$. Frame is not scrubbed.\n\n**For $t=7$:**\n$\\Delta T(7) = (0.45-0.60, 0.18-0.20, -0.15-(-0.10)) = (-0.15, -0.02, -0.05)$ mm.\n$\\sum |\\Delta T(7)| = 0.15 + 0.02 + 0.05 = 0.22$ mm.\n$\\Delta R(7) = (0.80-1.00, 0.05-0.05, -0.28-(-0.30)) = (-0.20, 0.00, 0.02)$ degrees.\n$\\sum |\\Delta R(7)| = 0.20 + 0.00 + 0.02 = 0.22$ degrees.\n$D(7) = 0.22 + \\frac{5\\pi}{18} \\cdot 0.22 = 0.22 + \\frac{1.1\\pi}{18} = 0.22 + \\frac{11\\pi}{180} \\approx 0.22 + 0.192 = 0.412$ mm.\n$D(7) \\le 0.5$. Frame is not scrubbed.\n\n**For $t=8$:**\n$\\Delta T(8) = (0.46-0.45, 0.21-0.18, -0.12-(-0.15)) = (0.01, 0.03, 0.03)$ mm.\n$\\sum |\\Delta T(8)| = 0.01 + 0.03 + 0.03 = 0.07$ mm.\n$\\Delta R(8) = (0.82-0.80, 0.10-0.05, -0.30-(-0.28)) = (0.02, 0.05, -0.02)$ degrees.\n$\\sum |\\Delta R(8)| = 0.02 + 0.05 + 0.02 = 0.09$ degrees.\n$D(8) = 0.07 + \\frac{5\\pi}{18} \\cdot 0.09 = 0.07 + \\frac{0.45\\pi}{18} = 0.07 + \\frac{\\pi}{40} \\approx 0.07 + 0.079 = 0.149$ mm.\n$D(8) \\le 0.5$. Frame is not scrubbed.\n\nBased on these calculations, only the frame at time $t=4$ has a displacement $D(4)$ that exceeds the threshold of $0.5$ mm. Therefore, only one frame must be scrubbed.\nThe total number of scrubbed frames is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Raw fMRI signals are often contaminated by low-frequency noise arising from physiological sources and slow scanner drift, which can obscure task-related brain activity. A standard approach to address this is high-pass filtering, which can be elegantly implemented within the General Linear Model (GLM) by including a set of low-frequency basis functions as nuisance regressors. This practice  bridges preprocessing and statistical modeling, showing how to construct such a filter using the Discrete Cosine Transform (DCT) and understand why including these components in the GLM design matrix effectively removes unwanted slow drifts from the data.",
            "id": "4163890",
            "problem": "A single functional Magnetic Resonance Imaging (fMRI) run consists of $N=750$ volumes sampled at repetition time $TR=0.8$ s, so the total acquisition duration is $T=N \\cdot TR$. To remove low-frequency drifts during preprocessing for the General Linear Model (GLM), a high-pass filter based on the Discrete Cosine Transform (DCT) is constructed by including a set of orthonormal cosine basis functions whose temporal periods are greater than or equal to a specified cutoff of $128$ s.\n\nStarting from first principles, use the fundamental definition of the Discrete Cosine Transform Type-II (DCT-II) basis on $n \\in \\{0,1,\\dots,N-1\\}$ and the orthonormality requirement in discrete time to derive the normalized filter coefficients (basis columns) $b_{k}[n]$ for integer mode index $k \\geq 0$. Relate the integer index $k$ to the implied temporal period $P_{k}$ of $b_{k}[n]$ over the observation window of duration $T$, and determine the largest integer $K$ such that $P_{K} \\geq 128$ s. Explain how including $\\{b_{k}[n]\\}_{k=0}^{K}$ as nuisance regressors implements high-pass filtering in the GLM preprocessing pipeline, making clear the projection interpretation.\n\nExpress your final answer as the integer value of $K$. No rounding is required. Provide no units in the final answer box.",
            "solution": "The problem requires the derivation of the high-pass filter regressors for fMRI analysis using the Discrete Cosine Transform (DCT), the determination of the number of such regressors based on a specified period cutoff, and an explanation of the filtering mechanism within the General Linear Model (GLM) framework.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Number of volumes (time points): $N=750$.\n- Repetition time: $TR=0.8$ s.\n- Total acquisition duration: $T = N \\cdot TR$.\n- Filter method: High-pass filtering using a set of DCT basis functions.\n- Period cutoff: The temporal periods of the included basis functions must be greater than or equal to $128$ s.\n- DCT type: Discrete Cosine Transform Type-II (DCT-II).\n- Time index: $n \\in \\{0, 1, \\dots, N-1\\}$.\n- Basis function notation: $b_k[n]$ for integer mode index $k \\geq 0$.\n- Required outputs: The derivation of normalized $b_k[n]$, the relation between $k$ and the period $P_k$, the largest integer $K$ for the nuisance set $\\{b_k[n]\\}_{k=0}^{K}$, and an explanation of the filtering mechanism.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard and widely used technique in fMRI preprocessing (high-pass filtering via nuisance regression in the GLM, as implemented in software like SPM). All terms are standard in signal processing and neuroscience. The problem is well-posed, providing all necessary parameters ($N$, $TR$, cutoff period) to calculate a unique integer solution for $K$. The language is objective and precise. The problem is valid.\n\n### Step 3: Derivation and Solution\n\n**1. Orthonormal DCT-II Basis Functions**\n\nThe DCT-II transform of a sequence $x[n]$ of length $N$ is defined by its basis functions. The unnormalized basis functions, which are columns of the DCT-II matrix, are given by:\n$$c_k[n] = \\cos\\left[\\frac{\\pi k}{N}\\left(n + \\frac{1}{2}\\right)\\right]$$\nfor the discrete time index $n \\in \\{0, 1, \\dots, N-1\\}$ and the frequency index $k \\in \\{0, 1, \\dots, N-1\\}$.\n\nTo be used as orthonormal regressors, these basis functions must be normalized such that their inner product satisfies $\\sum_{n=0}^{N-1} b_k[n] b_j[n] = \\delta_{kj}$, where $\\delta_{kj}$ is the Kronecker delta. This requires normalizing each vector $c_k$ by its Euclidean norm, $\\|c_k\\| = \\sqrt{\\sum_{n=0}^{N-1} (c_k[n])^2}$.\n\nFor the case $k=0$:\n$$c_0[n] = \\cos(0) = 1$$\nThe squared norm is:\n$$\\|c_0\\|^2 = \\sum_{n=0}^{N-1} 1^2 = N$$\nThe normalization constant is $1/\\sqrt{N}$.\n\nFor the case $k \\in \\{1, 2, \\dots, N-1\\}$:\nThe squared norm is:\n$$\\|c_k\\|^2 = \\sum_{n=0}^{N-1} \\cos^2\\left[\\frac{\\pi k}{N}\\left(n + \\frac{1}{2}\\right)\\right]$$\nUsing the identity $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$:\n$$\\|c_k\\|^2 = \\sum_{n=0}^{N-1} \\frac{1}{2}\\left(1 + \\cos\\left[\\frac{2\\pi k}{N}\\left(n + \\frac{1}{2}\\right)\\right]\\right) = \\frac{N}{2} + \\frac{1}{2}\\sum_{n=0}^{N-1}\\cos\\left(\\frac{2\\pi k n}{N} + \\frac{\\pi k}{N}\\right)$$\nThe summation term is the real part of a geometric series of complex exponentials, which sums to zero for $1 \\le k < N$. Thus:\n$$\\|c_k\\|^2 = \\frac{N}{2}$$\nThe normalization constant is $\\sqrt{2/N}$.\n\nTherefore, the orthonormal DCT-II basis functions $b_k[n]$ are:\n$$\nb_k[n] = \\begin{cases}\n\\sqrt{\\frac{1}{N}} & \\text{for } k=0 \\\\\n\\sqrt{\\frac{2}{N}} \\cos\\left[\\frac{\\pi k}{N}\\left(n + \\frac{1}{2}\\right)\\right] & \\text{for } k \\in \\{1, 2, \\dots, N-1\\}\n\\end{cases}\n$$\n\n**2. Relation between Index $k$ and Temporal Period $P_k$**\n\nThe basis function $b_k[n]$ for $k>0$ is a sampled cosine wave. The \"digital\" angular frequency is $\\Omega_k = \\frac{\\pi k}{N}$ radians per sample. The physical time between samples is the repetition time, $TR$. The continuous-time angular frequency $\\omega_k$ is related to the digital frequency by $\\omega_k = \\Omega_k / TR$.\n$$\\omega_k = \\frac{\\pi k}{N \\cdot TR}$$\nThe temporal period $P_k$ is related to the angular frequency by $P_k = 2\\pi / \\omega_k$.\n$$P_k = \\frac{2\\pi}{\\left(\\frac{\\pi k}{N \\cdot TR}\\right)} = \\frac{2 N \\cdot TR}{k}$$\nThe total duration of the fMRI run is $T = N \\cdot TR$. Substituting this into the expression for $P_k$:\n$$P_k = \\frac{2T}{k}$$\nThis formula shows that the basis function with index $k$ completes $k/2$ cycles over the total acquisition time $T$. For $k=1$, the period is $P_1 = 2T$, corresponding to half a cosine cycle over the interval. For $k=0$, the basis function is a constant (DC component), and its period is formally infinite, $P_0 = \\infty$.\n\n**3. Determine the Largest Integer $K$**\n\nWe are given the parameters:\n$N=750$\n$TR=0.8$ s\n\nFirst, we calculate the total acquisition duration $T$:\n$$T = N \\cdot TR = 750 \\cdot 0.8 \\text{ s} = 600 \\text{ s}$$\nThe period of the $k$-th basis function is:\n$$P_k = \\frac{2T}{k} = \\frac{2 \\cdot 600 \\text{ s}}{k} = \\frac{1200}{k} \\text{ s}$$\nThe high-pass filter is constructed by including all basis functions $\\{b_k[n]\\}$ whose periods are greater than or equal to the cutoff of $128$ s. We need to find the largest integer index $K$ such that the set of nuisance regressors is $\\{b_k[n]\\}_{k=0}^{K}$. This means we must find the largest integer $k$ (which we will call $K$) that satisfies the condition $P_k \\geq 128$ s.\n\nFor $k=0$, $P_0 = \\infty$, which satisfies $\\infty \\geq 128$ s. So, the $k=0$ regressor is included.\nFor $k > 0$, we have the inequality:\n$$\\frac{1200}{k} \\geq 128$$\nSince $k$ is a positive integer, we can multiply both sides by $k$ without changing the inequality direction:\n$$1200 \\geq 128k$$\n$$k \\leq \\frac{1200}{128}$$\nLet's simplify the fraction:\n$$\\frac{1200}{128} = \\frac{300}{32} = \\frac{75}{8} = 9.375$$\nThe condition is $k \\leq 9.375$. Since $k$ must be an integer, the possible positive integer values for $k$ are $1, 2, 3, 4, 5, 6, 7, 8, 9$.\nThe largest integer index satisfying the criterion is $k=9$.\nTherefore, the regressors to be included correspond to indices $k = 0, 1, \\dots, 9$. The problem asks for the largest integer $K$ in the set $\\{b_k[n]\\}_{k=0}^{K}$, which is $K=9$.\n\n**4. Filtering Mechanism in the GLM**\n\nThe General Linear Model (GLM) in fMRI analysis models the time series data $Y$ from a single voxel as a linear combination of predictors plus error:\n$$Y = X\\beta + \\epsilon$$\nHere, $Y$ is the $N \\times 1$ vector of fMRI data, $X$ is the $N \\times P$ design matrix (with $P$ regressors), $\\beta$ is the $P \\times 1$ vector of parameters to be estimated, and $\\epsilon$ is the $N \\times 1$ vector of residual error.\n\nTo implement high-pass filtering, the design matrix $X$ is augmented with the low-frequency DCT basis functions as nuisance regressors. The design matrix takes the form:\n$$X = [X_{\\text{interest}} \\quad X_{\\text{nuisance}}]$$\nwhere $X_{\\text{interest}}$ contains regressors modeling the expected BOLD response to experimental tasks, and $X_{\\text{nuisance}}$ contains the low-frequency drift components:\n$$X_{\\text{nuisance}} = [b_0 \\quad b_1 \\quad \\dots \\quad b_K]$$\nwhere $b_k$ is the column vector representing the basis function $b_k[n]$. In our case, $K=9$.\n\nThe parameters $\\beta$ are typically estimated using Ordinary Least Squares (OLS), yielding $\\hat{\\beta} = (X^TX)^{-1}X^TY$. The key insight is that this estimation process effectively \"partitions\" the variance in the data $Y$ among the different regressors in $X$. By including the columns $\\{b_k\\}_{k=0}^K$ in the model, any variance in the fMRI signal that systematically covaries with these low-frequency cosine functions is attributed to them.\n\nThe projection interpretation is as follows: The OLS fit, $\\hat{Y} = X\\hat{\\beta}$, is the orthogonal projection of the data vector $Y$ onto the vector space (subspace) spanned by the columns of the design matrix $X$. This subspace, let's call it $\\mathcal{C}(X)$, is the sum of the subspace spanned by the regressors of interest, $\\mathcal{C}(X_{\\text{interest}})$, and the subspace spanned by the nuisance regressors, $\\mathcal{C}(X_{\\text{nuisance}})$.\nWhen we test hypotheses about the parameters associated with $X_{\\text{interest}}$, the GLM procedure effectively isolates the unique contribution of these regressors after accounting for the variance explained by all other regressors, including the nuisance ones. This is equivalent to first projecting the data $Y$ and the regressors of interest $X_{\\text{interest}}$ onto the subspace orthogonal to the space spanned by the nuisance regressors, and then performing the regression. This orthogonalization removes any low-frequency signal components from the data that can be modeled by the DCT basis set, thus achieving high-pass filtering. The subsequent statistical analysis is then performed on a signal that is \"cleaned\" of these low-frequency drifts.",
            "answer": "$$\\boxed{9}$$"
        }
    ]
}