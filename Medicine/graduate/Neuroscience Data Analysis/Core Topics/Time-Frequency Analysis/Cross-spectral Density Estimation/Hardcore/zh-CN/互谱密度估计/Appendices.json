{
    "hands_on_practices": [
        {
            "introduction": "在信号处理流程中，诸如移除均值之类的预处理步骤是常见的做法，但它们也可能在不经意间引入系统性偏差。本练习将引导你量化这种效应，通过将分段均值移除操作视为一个线性滤波器，推导出它对低频交叉谱估计的精确影响。这个实践强调了理解分析流程中每一步骤的数学基础的重要性，以避免对结果的错误解读。",
            "id": "4151802",
            "problem": "考虑两个联合宽平稳的神经时间序列 $x[n]$ 和 $y[n]$，它们以时间间隔 $\\Delta t$ 进行采样，其真实的互谱密度 (CSD) $S_{xy}(f)$ 在 $f=0$ 附近缓慢变化。您可以使用长度为 $L$ 点的非重叠矩形分段来估计 CSD，方法如下：对于每个分段，从每个序列中减去样本均值，计算 $L$ 点离散傅里叶变换，形成互周期图，最后对所有分段进行平均。假设 $L$ 很大，并且对于频率 $|f| \\ll \\frac{1}{L \\Delta t}$，分段带来的边缘效应可以忽略不计。仅使用以下基本依据：(i) CSD 的定义，即互协方差的傅里叶变换；(ii) 一个线性系统的事实，即当两个信号通过具有相同频率响应 $H(\\omega)$ 的线性时不变滤波器时，其 CSD 会乘以 $|H(\\omega)|^{2}$；以及 (iii) 长度为 $L$ 的矩形序列的离散时间傅里叶变换。\n\n将分段均值移除视为一个算子，在上述大 $L$ 和低频范围内，该操作等效于在分段之前将数据通过一个有限脉冲响应滤波器。从给定的基本依据出发，推导主阶低频乘性衰减因子 $A(f)$，使得去趋势后的 CSD 估计的期望值满足\n$$\n\\mathbb{E}\\!\\left[\\hat{S}_{xy}^{(\\mathrm{detrend})}(f)\\right] \\approx A(f)\\, S_{xy}(f)\n$$\n对于 $|f| \\ll \\frac{1}{L \\Delta t}$。您的推导必须从所述的基本依据开始，并逻辑地推导出一个关于 $L$、$f$ 和 $\\Delta t$ 的、$A(f)$ 的渐近表达式，直到 $f$ 的第一个非零阶。请以单个闭式解析表达式的形式提供 $A(f)$ 的最终答案；不要计算任何数值。不需要四舍五入，最终方框内的表达式中不应出现单位。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。它在一个明确的约束框架内提出了一个谱分析中的标准问题，并要求基于基本原理进行严格的推导。因此，我将开始解答。\n\n目标是推导在执行分段均值减法时，影响互谱密度 (CSD) 估计的低频衰减因子 $A(f)$。问题指出，对于大的分段长度 $L$ 和在低频范围 $|f| \\ll \\frac{1}{L \\Delta t}$ 内，此操作等效于将数据通过一个线性时不变 (LTI) 滤波器。我们的第一步是刻画这个滤波器。\n\n设一个时间序列的数据分段表示为 $x[n]$，其中 $n \\in \\{0, 1, \\dots, L-1\\}$。均值减法操作产生一个新的分段 $x'[n]$：\n$$\nx'[n] = x[n] - \\bar{x} = x[n] - \\frac{1}{L}\\sum_{k=0}^{L-1} x[k]\n$$\n该操作可以用一个脉冲响应 $h[n]$ 来描述。输出 $x'[n]$ 是输入 $x[n]$ 与 $h[n]$ 卷积的结果。通过观察该操作的结构，我们可以确定 $h[n]$ 为：\n$$\nh[n] = \\delta[n] - \\frac{1}{L}\\mathbf{1}_{[0, L-1]}[n]\n$$\n其中 $\\delta[n]$ 是克罗内克 δ 函数，$\\mathbf{1}_{[0, L-1]}[n]$ 是一个长度为 $L$ 的矩形窗，当 $n \\in \\{0, 1, \\dots, L-1\\}$ 时其值为 $1$，否则为 $0$。\n\n下一步，根据问题的指示，是求此滤波器的频率响应 $H(f)$。$H(f)$ 是 $h[n]$ 的离散时间傅里叶变换 (DTFT)。令 $\\omega = 2\\pi f \\Delta t$ 为归一化角频率。\n$$\nH(f) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\omega n) = \\mathcal{F}\\{\\delta[n]\\} - \\frac{1}{L}\\mathcal{F}\\{\\mathbf{1}_{[0, L-1]}[n]\\}\n$$\nδ 函数的 DTFT 是 $1$。矩形窗的 DTFT 是一个标准结果，由依据 (iii) 给出：\n$$\n\\mathcal{F}\\{\\mathbf{1}_{[0, L-1]}[n]\\} = \\sum_{n=0}^{L-1} \\exp(-j\\omega n)\n$$\n这是一个有限几何级数。对于 $\\omega \\neq 0$，其和为 $\\frac{1-\\exp(-j\\omega L)}{1-\\exp(-j\\omega)}$。在 $\\omega=0$ 时，其和显然是 $L$。\n\n因此，频率响应为：\n$$\nH(f) = 1 - \\frac{1}{L} \\sum_{n=0}^{L-1} \\exp(-j\\omega n)\n$$\n根据依据 (ii)，当信号 $x[n]$ 和 $y[n]$ 都通过同一个滤波器时，所得的 CSD 会乘以因子 $|H(f)|^2$。因此，衰减因子 $A(f)$ 由 $A(f) = |H(f)|^2$ 给出。我们需要求 $A(f)$ 的主阶低频行为。这需要对小 $\\omega$ 情况下的 $H(f)$ 进行泰勒级数展开。\n\n对于小的 $\\omega$，我们展开指数项 $\\exp(-j\\omega n)$：\n$$\n\\exp(-j\\omega n) \\approx 1 - j\\omega n - \\frac{(\\omega n)^2}{2}\n$$\n我们将此代入求和式中：\n$$\n\\sum_{n=0}^{L-1} \\exp(-j\\omega n) \\approx \\sum_{n=0}^{L-1} \\left(1 - j\\omega n - \\frac{\\omega^2 n^2}{2}\\right) = \\sum_{n=0}^{L-1} 1 - j\\omega \\sum_{n=0}^{L-1} n - \\frac{\\omega^2}{2} \\sum_{n=0}^{L-1} n^2\n$$\n使用幂和的标准公式：\n$\\sum_{n=0}^{L-1} 1 = L$\n$\\sum_{n=0}^{L-1} n = \\frac{(L-1)L}{2}$\n$\\sum_{n=0}^{L-1} n^2 = \\frac{(L-1)L(2L-1)}{6}$\n\n求和式变为：\n$$\n\\sum_{n=0}^{L-1} \\exp(-j\\omega n) \\approx L - j\\omega \\frac{L(L-1)}{2} - \\frac{\\omega^2}{2} \\frac{L(L-1)(2L-1)}{6}\n$$\n现在，将此代回 $H(f)$ 的表达式中：\n$$\nH(f) \\approx 1 - \\frac{1}{L} \\left[ L - j\\omega \\frac{L(L-1)}{2} - \\omega^2 \\frac{L(L-1)(2L-1)}{12} \\right]\n$$\n$$\nH(f) \\approx 1 - \\left[ 1 - j\\omega \\frac{L-1}{2} - \\omega^2 \\frac{(L-1)(2L-1)}{12} \\right]\n$$\n$$\nH(f) \\approx j\\omega \\frac{L-1}{2} + \\omega^2 \\frac{(L-1)(2L-1)}{12}\n$$\n在频率 $f=0$（即 $\\omega=0$）时，$H(0)=0$，这是正确的，因为均值减法完全移除了直流分量。对于小的非零 $\\omega$，主阶项是虚部项，其阶数为 $\\omega$。\n\n衰减因子为 $A(f) = |H(f)|^2$。对于复数 $z = a+ib$，有 $|z|^2 = a^2+b^2$。在我们的例子中，实部是 $\\omega^2$ 阶的，虚部是 $\\omega$ 阶的。\n$$\nA(f) = \\left| j\\omega \\frac{L-1}{2} + \\omega^2 \\frac{(L-1)(2L-1)}{12} \\right|^2 = \\left(\\omega^2 \\frac{(L-1)(2L-1)}{12}\\right)^2 + \\left(\\omega \\frac{L-1}{2}\\right)^2\n$$\n第一项是 $\\omega^4$ 阶的，第二项是 $\\omega^2$ 阶的。问题要求的是主阶非零项，即 $\\omega^2$ 项。\n$$\nA(f) \\approx \\left(\\omega \\frac{L-1}{2}\\right)^2\n$$\n最后，我们代入 $\\omega = 2\\pi f \\Delta t$ 以使用要求的变量来表示结果：\n$$\nA(f) \\approx \\left( (2\\pi f \\Delta t) \\frac{L-1}{2} \\right)^2 = (\\pi (L-1) f \\Delta t)^2\n$$\n这就是从指定的基本依据推导出的、在 $|f| \\ll \\frac{1}{L \\Delta t}$ 条件下的乘性衰减因子的渐近表达式。",
            "answer": "$$\n\\boxed{(\\pi (L-1) f \\Delta t)^{2}}\n$$"
        },
        {
            "introduction": "成功进行神经科学实验的关键不仅在于分析已有的数据，更在于前期的合理设计。一个核心挑战是确保采集足够的数据以获得可靠的统计结果。本练习提供了一个定量框架，用于回答“需要多少数据？”这一根本问题，它要求你在频率分辨率和相干性检测的统计功效这两个相互竞争的需求之间进行权衡。",
            "id": "4151844",
            "problem": "考虑两个以时间间隔 $\\Delta t$（采样频率 $F_s = 1/\\Delta t$）同时记录的离散时间神经信号 $x[n]$ 和 $y[n]$，总共有 $N$ 个样本。假设在载波频率 $f_0$ 附近存在窄带耦合，其真实相干平方值 $\\gamma_0^2 \\in (0,1)$ 在半峰全宽 $b$（单位为 $\\mathrm{Hz}$）范围内近似恒定。您使用Welch方法估计交叉谱密度，分段长度为 $M$，采用汉宁窗，并有半重叠（$50\\%$）。频率分辨率满足 $\\Delta f \\approx 1/(M \\Delta t)$。对于汉宁窗，等效噪声带宽为 $B_w = c_w \\Delta f$，其中 $c_w = 1.5$。\n\n将在 $f_0$ 处的Welch估计中，由窗函数引起的可观测相干性的谱稀释效应建模为因子 $\\min\\!\\left(1, b/B_w\\right)$，因此在 $f_0$ 处的预期观测相干性等于 $\\gamma_0^2 \\min\\!\\left(1, b/B_w\\right)$。设Welch分段数近似为 $K \\approx \\frac{2N}{M} - 1$（由于半重叠），并设有效独立平均次数为 $K_{\\mathrm{eff}} = \\eta K$，其中 $\\eta \\in (0,1)$ 捕捉了由重叠和加窗引起的依赖性。\n\n将显著性水平为 $\\alpha \\in (0,1)$ 的统计检测定义为：在 $f_0$ 处的相干平方估计值需要超过由 $K_{\\mathrm{eff}}$ 决定的 $(1-\\alpha)$ 零假设百分位数。仅使用Welch相干性估计器的基本定义和经过充分检验的统计特性，推导出一个关于最小总样本数 $N_{\\min}$ 的单一闭式解析表达式。该表达式是 $\\alpha$、$\\eta$、$c_w$、$F_s$、$b$ 和 $\\gamma_0^2$ 的函数，并能保证存在至少一个分段长度 $M$，同时满足以下两个条件：\n- 分辨率约束 $B_w \\le b$，以及\n- 在显著性水平 $\\alpha$ 下，使用 $f_0$ 处的预期观测相干性满足统计检测约束。\n\n您最终关于 $N_{\\min}$ 的表达式必须是闭式的、解析的，并且完全由给定参数表示。不需要进行数值计算。",
            "solution": "该问题要求推导最小总样本数 $N_{\\min}$，使得存在至少一个分段长度 $M$ 能同时满足两个约束：一个关于频率分辨率，另一个关于相干性的统计检测。\n\n让我们将关于分段长度 $M$ 的两个约束形式化。\n\n首先，我们分析分辨率约束。问题陈述，等效噪声带宽 $B_w$ 必须小于或等于相干峰的带宽 $b$。\n等效噪声带宽由 $B_w = c_w \\Delta f$ 给出。频率分辨率为 $\\Delta f \\approx 1/(M \\Delta t)$。采样频率为 $F_s = 1/\\Delta t$。\n将这些代入约束 $B_w \\le b$ 中：\n$$c_w \\left( \\frac{1}{M \\Delta t} \\right) \\le b$$\n$$c_w \\frac{F_s}{M} \\le b$$\n求解 $M$ 得到分段长度的下界：\n$$M \\ge \\frac{c_w F_s}{b}$$\n\n其次，我们分析统计检测约束。问题将检测定义为相干性估计值超过由显著性水平 $\\alpha$ 决定的临界阈值的情况。它进一步指定，此条件应针对相干性估计的*期望*值进行评估。\n检测条件是：\n$$\\mathbb{E}[\\hat{\\gamma}^2(f_0)] > \\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}})$$\n其中 $\\hat{\\gamma}^2(f_0)$ 是在频率 $f_0$ 处的相干平方估计值，而 $\\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}})$ 是在零相干性的零假设下，给定 $K_{\\mathrm{eff}}$ 个有效自由度时，估计器分布的 $(1-\\alpha)$ 百分位数。\n\n预期的观测相干性建模为 $\\mathbb{E}[\\hat{\\gamma}^2(f_0)] = \\gamma_0^2 \\min(1, b/B_w)$。由于第一个约束要求 $B_w \\le b$，因此 $b/B_w \\ge 1$。所以，对于任何满足分辨率约束的 $M$，$\\min(1, b/B_w) = 1$。预期的相干性简化为真实相干性：\n$$\\mathbb{E}[\\hat{\\gamma}^2(f_0)] = \\gamma_0^2$$\n\n接下来，我们必须找到临界值 $\\gamma^2_{\\text{crit}}$ 的表达式。对于基于Welch方法的相干性估计，在零假设（$\\gamma^2 = 0$）下，对于 $K_{\\mathrm{eff}}$ 次有效平均，估计量 $\\hat{\\gamma}^2$ 的累积分布函数（CDF）是众所周知的：\n$$F_{\\hat{\\gamma}^2}(y) = P(\\hat{\\gamma}^2 \\le y) = 1 - (1-y)^{K_{\\mathrm{eff}}-1}$$\n临界值 $\\gamma^2_{\\text{crit}}$ 是 $(1-\\alpha)$ 分位数，意味着 $F_{\\hat{\\gamma}^2}(\\gamma^2_{\\text{crit}}) = 1-\\alpha$。\n$$1 - (1-\\gamma^2_{\\text{crit}})^{K_{\\mathrm{eff}}-1} = 1-\\alpha$$\n$$(1-\\gamma^2_{\\text{crit}})^{K_{\\mathrm{eff}}-1} = \\alpha$$\n$$1-\\gamma^2_{\\text{crit}} = \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\n$$\\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}}) = 1 - \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\n\n将这些代入统计检测不等式中：\n$$\\gamma_0^2 > 1 - \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\n我们现在对此求解 $K_{\\mathrm{eff}}$。\n$$\\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}} > 1 - \\gamma_0^2$$\n对两边取自然对数。由于 $\\alpha \\in (0,1)$，$\\ln(\\alpha)$ 为负。\n$$\\frac{1}{K_{\\mathrm{eff}}-1} \\ln(\\alpha) > \\ln(1 - \\gamma_0^2)$$\n除以 $\\ln(\\alpha)$ 会使不等式反向：\n$$\\frac{1}{K_{\\mathrm{eff}}-1}  \\frac{\\ln(1 - \\gamma_0^2)}{\\ln(\\alpha)}$$\n对两边取倒数（两边均为正，因为 $\\ln(1-\\gamma_0^2)0$ 且 $\\ln(\\alpha)0$）：\n$$K_{\\mathrm{eff}}-1 > \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\n$$K_{\\mathrm{eff}} > 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\n\n现在，我们代入给定的 $K_{\\mathrm{eff}}$ 和 $K$ 的表达式：\n$K_{\\mathrm{eff}} = \\eta K$，其中 $K \\approx \\frac{2N}{M} - 1$。\n$$\\eta \\left( \\frac{2N}{M} - 1 \\right) > 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\n求解 $M$ 以找到其上界：\n$$\\frac{2N}{M} - 1 > \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)$$\n$$\\frac{2N}{M} > 1 + \\frac{1}{\\eta} + \\frac{\\ln(\\alpha)}{\\eta\\ln(1 - \\gamma_0^2)}$$\n$$\\frac{2N}{M} > \\frac{\\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}}{\\eta}$$\n$$M  \\frac{2N\\eta}{\\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}}$$\n\n我们现在对 $M$ 有两个约束：\n$$ \\frac{c_w F_s}{b} \\le M  \\frac{2N\\eta}{\\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}} $$\n为了使至少一个有效的分段长度 $M$ 存在，由这些界限定义的区间必须非空。其最小条件是下界严格小于上界。我们将 $N$ 的阈值表示为 $N_{\\min}$，通过将下界设为等于上界来求得。\n$$\\frac{c_w F_s}{b} = \\frac{2N_{\\min}\\eta}{\\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}}$$\n最后，我们求解 $N_{\\min}$ 以获得所需的闭式表达式：\n$$N_{\\min} = \\frac{c_w F_s}{2b\\eta} \\left( \\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)$$\n此表达式表示为确保能够选择一个分段长度 $M$ 来同时满足问题中定义的光谱分辨率和统计检测标准所需的最小样本数。",
            "answer": "$$\n\\boxed{\\frac{c_w F_s}{2b\\eta} \\left( \\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)}\n$$"
        },
        {
            "introduction": "多窗谱法和跨试次平均是提高谱估计稳定性的两种核心技术。为了真正掌握这些方法，理解它们为何有效以及如何量化其性能至关重要。本练习将通过严格的数学推导，揭示交叉谱估计量的方差如何随着数据窗（taper）数量 $K$ 和独立试次数量 $T$ 的增加而减小，从而让你深刻理解估计器的统计效率。",
            "id": "4151873",
            "problem": "考虑一个重复刺激实验，其中在 $T$ 次独立试验中，从两个皮层位点同时记录局部场电位 (LFP) $x(t)$ 和 $y(t)$。每次试验的持续时间足够长，使得过程在试验内部可被视作平稳过程。对于每次试验，您使用时间带宽积为 $NW$ 的正交离散长球状序列 (DPSS)，在频率 $f$ 处计算 $K$ 个加窗傅里叶变换，得到 $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$，其中 $t \\in \\{1,\\dots,T\\}$ 且 $k \\in \\{1,\\dots,K\\}$。假设以下模型假设成立，这些假设在高斯平稳过程的谱分析中是标准的，并且对于 DPSS 多窗格法具有很高的准确性：\n- 在所有试验和窗格中，复傅里叶系数 $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ 是独立同分布的正常复高斯随机向量，其均值为零，在频率 $f$ 处的谱协方差矩阵由下式给出\n$$\n\\mathbf{S}(f) \\equiv \\begin{pmatrix}\nS_{xx}(f)  S_{xy}(f) \\\\\n\\overline{S_{xy}(f)}  S_{yy}(f)\n\\end{pmatrix},\n$$\n因此，$E[F_{x}^{(t,k)}(f)\\,\\overline{F_{x}^{(t,k)}(f)}] = S_{xx}(f)$，$E[F_{y}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}] = S_{yy}(f)$，以及 $E[F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}] = S_{xy}(f)$，并且所有非正常矩（例如，$E[F_{x}^{(t,k)}(f)\\,F_{y}^{(t,k)}(f)]$）都等于 0。\n- $K$ 个 DPSS 的正交性和谱集中性意味着，在同一次试验中，不同的窗格在目标频率 $f$ 处产生有效独立同分布的估计。\n\n将在频率 $f$ 处的多窗格、试验平均的交叉谱密度估计量定义为\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}.\n$$\n从交叉谱密度作为期望的定义出发，并仅使用上述独立性和正常复高斯假设，推导该复估计量的均方方差的闭式解析表达式，\n$$\n\\mathrm{Var}\\!\\left[\\hat{S}_{xy}(f)\\right] \\equiv E\\!\\left[\\,\\left|\\hat{S}_{xy}(f) - S_{xy}(f)\\right|^{2}\\right],\n$$\n并明确展示方差的减小是如何由试验次数 $T$ 和窗格数量 $K$ 共同决定的。\n\n答案规格：\n- 以 $S_{xx}(f)$、$S_{yy}(f)$、$K$ 和 $T$ 的单个符号表达式形式提供最终答案。\n- 无需进行数值近似或四舍五入。\n- 不要包含单位。",
            "solution": "问题要求推导多窗格、试验平均的交叉谱密度估计量 $\\hat{S}_{xy}(f)$ 的均方方差。复随机变量 $Z$ 的方差定义为 $\\mathrm{Var}[Z] \\equiv E\\left[|Z - E[Z]|^2\\right]$。\n\n该估计量定义为：\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\n$$\n让我们将来自第 $t$ 次试验的第 $k$ 个窗格的单个交叉谱估计定义为复随机变量 $Z_{t,k}$：\n$$\nZ_{t,k} = F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\n$$\n该估计量可以写成这 $KT$ 个单个估计的样本均值：\n$$\n\\hat{S}_{xy}(f) = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\n$$\n根据问题陈述，复傅里叶系数 $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ 在所有试验 $t \\in \\{1, \\dots, T\\}$ 和窗格 $k \\in \\{1, \\dots, K\\}$ 中都是独立同分布的 (i.i.d.)。因此，对于所有的 $(t,k)$ 对，变量 $Z_{t,k}$ 也是独立同分布的。\n\n首先，我们确定该估计量是否有偏。我们利用期望算子的线性性来计算其期望：\n$$\nE[\\hat{S}_{xy}(f)] = E\\left[\\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\\right] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} E[Z_{t,k}]\n$$\n根据定义，每个单个估计 $Z_{t,k}$ 的期望是真实的交叉谱密度 $S_{xy}(f)$：\n$$\nE[Z_{t,k}] = E\\left[F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\\right] = S_{xy}(f)\n$$\n由于这个期望对所有的 $(t,k)$ 都是相同的，我们有：\n$$\nE[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} S_{xy}(f) = \\frac{1}{KT} (KT) S_{xy}(f) = S_{xy}(f)\n$$\n估计量 $\\hat{S}_{xy}(f)$ 是无偏的。因此，问题中定义的均方方差 $E\\left[\\,|\\hat{S}_{xy}(f) - S_{xy}(f)|^{2}\\right]$ 简化为该估计量的方差 $\\mathrm{Var}[\\hat{S}_{xy}(f)]$。\n\n对于 $N$ 个独立同分布随机变量 $X_i$ 的样本均值，其均值的方差为 $\\mathrm{Var}[\\frac{1}{N}\\sum X_i] = \\frac{1}{N^2} \\sum \\mathrm{Var}[X_i] = \\frac{N}{N^2}\\mathrm{Var}[X_1] = \\frac{1}{N}\\mathrm{Var}[X_1]$。将此原理应用于我们的估计量，即 $KT$ 个独立同分布变量 $Z_{t,k}$ 的均值，其方差为：\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z_{t,k}]\n$$\n现在我们需要计算单个估计 $Z_{t,k}$ 的方差。为简单起见，我们省略索引 $(t,k)$，并将傅里叶系数表示为 $X = F_{x}(f)$ 和 $Y = F_{y}(f)$，因此 $Z = X\\overline{Y}$。方差由下式给出：\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2\n$$\n我们已经确定 $|E[Z]|^2 = |S_{xy}(f)|^2$。现在我们计算 $E[|Z|^2]$：\n$$\nE[|Z|^2] = E\\left[|X\\overline{Y}|^2\\right] = E\\left[|X|^2 |\\overline{Y}|^2\\right] = E\\left[|X|^2 |Y|^2\\right] = E[(X\\overline{X})(Y\\overline{Y})]\n$$\n为计算此四阶矩，我们使用针对零均值复高斯随机变量的 Isserlis 定理（也称为 Wick 定理）。对于四个这样的变量 $W_1, W_2, W_3, W_4$，其乘积的期望为：\n$$\nE[W_1 W_2 W_3 W_4] = E[W_1 W_2]E[W_3 W_4] + E[W_1 W_3]E[W_2 W_4] + E[W_1 W_4]E[W_2 W_3]\n$$\n在我们的情况下，变量为 $W_1 = X$, $W_2 = \\overline{X}$, $W_3 = Y$, 和 $W_4 = \\overline{Y}$。将这些代入公式可得：\n$$\nE[X\\overline{X}Y\\overline{Y}] = E[X\\overline{X}]E[Y\\overline{Y}] + E[XY]E[\\overline{X}\\overline{Y}] + E[X\\overline{Y}]E[\\overline{X}Y]\n$$\n根据问题陈述，我们有以下期望：\n- $E[X\\overline{X}] = S_{xx}(f)$\n- $E[Y\\overline{Y}] = S_{yy}(f)$\n- $E[X\\overline{Y}] = S_{xy}(f)$\n- $E[\\overline{X}Y] = \\overline{E[X\\overline{Y}]} = \\overline{S_{xy}(f)}$\n- $E[XY] = 0$ 且 $E[\\overline{X}\\overline{Y}] = \\overline{E[XY]} = 0$，因为对于正常复高斯变量，所有非正常矩均为零。\n\n将这些值代入四阶矩的表达式中：\n$$\nE[|Z|^2] = E[X\\overline{X}Y\\overline{Y}] = (S_{xx}(f))(S_{yy}(f)) + (0)(0) + (S_{xy}(f))(\\overline{S_{xy}(f)})\n$$\n$$\nE[|Z|^2] = S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\n$$\n现在，我们可以计算单个估计 $Z$ 的方差：\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2 = \\left(S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\\right) - |S_{xy}(f)|^2\n$$\n$$\n\\mathrm{Var}[Z] = S_{xx}(f)S_{yy}(f)\n$$\n最后，我们将此结果代回估计量 $\\hat{S}_{xy}(f)$ 的方差表达式中：\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z] = \\frac{1}{KT} S_{xx}(f)S_{yy}(f)\n$$\n此表达式表明，交叉谱估计量的方差与独立估计的总数成反比，该总数是试验次数 $T$ 和窗格数量 $K$ 的乘积。这种方差的减小是在谱分析中使用多窗格法和试验平均法的主要动机。最终结果取决于两个信号的自谱密度，并且与真实的交叉谱密度无关。",
            "answer": "$$\n\\boxed{\\frac{S_{xx}(f) S_{yy}(f)}{KT}}\n$$"
        }
    ]
}