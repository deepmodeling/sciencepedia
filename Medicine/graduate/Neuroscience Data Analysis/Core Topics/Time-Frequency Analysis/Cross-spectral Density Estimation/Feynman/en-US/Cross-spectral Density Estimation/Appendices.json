{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of robust spectral estimation is the reduction of variance through averaging. This practice explores how combining estimates across multiple experimental trials and multiple tapers within each trial leads to a more precise and reliable cross-spectral density estimate. By deriving the variance of this combined estimator from first principles , you will gain a quantitative understanding of how statistical power is built and why this dual-averaging approach is fundamental to modern neural data analysis.",
            "id": "4151873",
            "problem": "Consider a repeated-stimulus experiment in which simultaneous Local Field Potential (LFP) recordings $x(t)$ and $y(t)$ are made from two cortical sites over $T$ independent trials, each of duration sufficiently long that the processes can be treated as stationary within-trial. For each trial, you compute $K$ tapered Fourier transforms at frequency $f$ using orthonormal Discrete Prolate Spheroidal Sequences (DPSS) with time-bandwidth product $NW$, yielding $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ for $t \\in \\{1,\\dots,T\\}$ and $k \\in \\{1,\\dots,K\\}$. Assume the following modeling assumptions, which are standard in spectral analysis of Gaussian stationary processes and hold to high accuracy for DPSS multitapering:\n- Across trials and tapers, the complex Fourier coefficients $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ are independent and identically distributed proper complex Gaussian random vectors with mean zero and spectral covariance matrix at frequency $f$ given by\n$$\n\\mathbf{S}(f) \\equiv \\begin{pmatrix}\nS_{xx}(f) & S_{xy}(f) \\\\\n\\overline{S_{xy}(f)} & S_{yy}(f)\n\\end{pmatrix},\n$$\nso that $E[F_{x}^{(t,k)}(f)\\,\\overline{F_{x}^{(t,k)}(f)}] = S_{xx}(f)$, $E[F_{y}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}] = S_{yy}(f)$, and $E[F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}] = S_{xy}(f)$, with all improper moments (e.g., $E[F_{x}^{(t,k)}(f)\\,F_{y}^{(t,k)}(f)]$) equal to $0$.\n- The orthonormality and spectral concentration of the $K$ DPSS imply that different tapers within a trial produce effectively independent, identically distributed estimates at the target frequency $f$.\n\nDefine the multitaper, trial-averaged cross-spectral density estimator at frequency $f$ by\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}.\n$$\nStarting from the definition of cross-spectral density as an expectation and using only the above independence and proper complex Gaussian assumptions, derive a closed-form analytic expression for the mean-square variance of the complex estimator,\n$$\n\\mathrm{Var}\\!\\left[\\hat{S}_{xy}(f)\\right] \\equiv E\\!\\left[\\,\\left|\\hat{S}_{xy}(f) - S_{xy}(f)\\right|^{2}\\right],\n$$\nexplicitly exhibiting how the variance reduction arises jointly from the number of trials $T$ and the number of tapers $K$.\n\nAnswer specification:\n- Provide your final answer as a single symbolic expression in terms of $S_{xx}(f)$, $S_{yy}(f)$, $K$, and $T$.\n- No numerical approximation or rounding is required.\n- Do not include units.",
            "solution": "The problem asks for the derivation of the mean-square variance of the multitaper, trial-averaged cross-spectral density estimator, $\\hat{S}_{xy}(f)$. The variance of a complex random variable $Z$ is defined as $\\mathrm{Var}[Z] \\equiv E\\left[|Z - E[Z]|^2\\right]$.\n\nThe estimator is defined as:\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\n$$\nLet us define an individual cross-spectral estimate from taper $k$ of trial $t$ as the complex random variable $Z_{t,k}$:\n$$\nZ_{t,k} = F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\n$$\nThe estimator can then be written as the sample mean of these $KT$ individual estimates:\n$$\n\\hat{S}_{xy}(f) = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\n$$\nAccording to the problem statement, the complex Fourier coefficients $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ are independent and identically distributed (i.i.d.) across all trials $t \\in \\{1, \\dots, T\\}$ and tapers $k \\in \\{1, \\dots, K\\}$. Consequently, the variables $Z_{t,k}$ are also i.i.d. for all pairs $(t,k)$.\n\nFirst, we determine if the estimator is biased. We compute its expectation by leveraging the linearity of the expectation operator:\n$$\nE[\\hat{S}_{xy}(f)] = E\\left[\\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\\right] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} E[Z_{t,k}]\n$$\nThe expectation of each individual estimate $Z_{t,k}$ is, by definition, the true cross-spectral density $S_{xy}(f)$:\n$$\nE[Z_{t,k}] = E\\left[F_{x}^{(t,k)}(f)\\,\\overline{F_{y}^{(t,k)}(f)}\\right] = S_{xy}(f)\n$$\nSince this expectation is the same for all $(t,k)$, we have:\n$$\nE[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} S_{xy}(f) = \\frac{1}{KT} (KT) S_{xy}(f) = S_{xy}(f)\n$$\nThe estimator $\\hat{S}_{xy}(f)$ is unbiased. Therefore, the mean-square variance defined in the problem, $E\\left[\\,|\\hat{S}_{xy}(f) - S_{xy}(f)|^{2}\\right]$, simplifies to the variance of the estimator, $\\mathrm{Var}[\\hat{S}_{xy}(f)]$.\n\nFor a sample mean of $N$ i.i.d. random variables $X_i$, the variance of the mean is $\\mathrm{Var}[\\frac{1}{N}\\sum X_i] = \\frac{1}{N^2} \\sum \\mathrm{Var}[X_i] = \\frac{N}{N^2}\\mathrm{Var}[X_1] = \\frac{1}{N}\\mathrm{Var}[X_1]$. Applying this principle to our estimator, which is the mean of $KT$ i.i.d. variables $Z_{t,k}$, its variance is:\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z_{t,k}]\n$$\nWe now need to calculate the variance of a single estimate $Z_{t,k}$. For simplicity, we drop the indices $(t,k)$ and denote the Fourier coefficients as $X = F_{x}(f)$ and $Y = F_{y}(f)$, so $Z = X\\overline{Y}$. The variance is given by:\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2\n$$\nWe have already established that $|E[Z]|^2 = |S_{xy}(f)|^2$. We now compute $E[|Z|^2]$:\n$$\nE[|Z|^2] = E\\left[|X\\overline{Y}|^2\\right] = E\\left[|X|^2 |\\overline{Y}|^2\\right] = E\\left[|X|^2 |Y|^2\\right] = E[(X\\overline{X})(Y\\overline{Y})]\n$$\nTo evaluate this fourth-order moment, we use Isserlis' theorem (also known as Wick's theorem) for zero-mean complex Gaussian random variables. For four such variables $W_1, W_2, W_3, W_4$, the expectation of their product is:\n$$\nE[W_1 W_2 W_3 W_4] = E[W_1 W_2]E[W_3 W_4] + E[W_1 W_3]E[W_2 W_4] + E[W_1 W_4]E[W_2 W_3]\n$$\nIn our case, the variables are $W_1 = X$, $W_2 = \\overline{X}$, $W_3 = Y$, and $W_4 = \\overline{Y}$. Substituting these into the formula yields:\n$$\nE[X\\overline{X}Y\\overline{Y}] = E[X\\overline{X}]E[Y\\overline{Y}] + E[XY]E[\\overline{X}\\overline{Y}] + E[X\\overline{Y}]E[\\overline{X}Y]\n$$\nFrom the problem statement, we have the following expectations:\n- $E[X\\overline{X}] = S_{xx}(f)$\n- $E[Y\\overline{Y}] = S_{yy}(f)$\n- $E[X\\overline{Y}] = S_{xy}(f)$\n- $E[\\overline{X}Y] = \\overline{E[X\\overline{Y}]} = \\overline{S_{xy}(f)}$\n- $E[XY] = 0$ and $E[\\overline{X}\\overline{Y}] = \\overline{E[XY]} = 0$, as all improper moments are zero for proper complex Gaussian variables.\n\nSubstituting these values into the expression for the fourth-order moment:\n$$\nE[|Z|^2] = E[X\\overline{X}Y\\overline{Y}] = (S_{xx}(f))(S_{yy}(f)) + (0)(0) + (S_{xy}(f))(\\overline{S_{xy}(f)})\n$$\n$$\nE[|Z|^2] = S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\n$$\nNow, we can compute the variance of a single estimate $Z$:\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2 = \\left(S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\\right) - |S_{xy}(f)|^2\n$$\n$$\n\\mathrm{Var}[Z] = S_{xx}(f)S_{yy}(f)\n$$\nFinally, we substitute this result back into the expression for the variance of the estimator $\\hat{S}_{xy}(f)$:\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z] = \\frac{1}{KT} S_{xx}(f)S_{yy}(f)\n$$\nThis expression demonstrates that the variance of the cross-spectral estimator is inversely proportional to the total number of independent estimates, which is the product of the number of trials $T$ and the number of tapers $K$. This reduction in variance is the principal motivation for using multitapering and trial-averaging in spectral analysis. The final result depends on the auto-spectral densities of the two signals and is independent of the true cross-spectral density.",
            "answer": "$$\n\\boxed{\\frac{S_{xx}(f) S_{yy}(f)}{KT}}\n$$"
        },
        {
            "introduction": "While averaging improves estimates, practical methods like Welch's introduce a critical trade-off between statistical power and spectral resolution. This exercise  challenges you to formalize this trade-off by deriving the minimum data length required to reliably detect neural coherence. Successfully navigating this problem will equip you with the analytical tools to plan experiments and choose analysis parameters that are sensitive to the specific neural phenomena you aim to study.",
            "id": "4151844",
            "problem": "Consider two simultaneously recorded discrete-time neural signals $x[n]$ and $y[n]$ sampled at interval $\\Delta t$ (sampling frequency $F_s = 1/\\Delta t$), with a total of $N$ samples. Assume there is narrowband coupling around a carrier frequency $f_0$ whose true magnitude-squared coherence $\\gamma_0^2 \\in (0,1)$ is approximately constant across a full width at half maximum $b$ (in $\\mathrm{Hz}$). You estimate the cross-spectral density using the Welch method with segment length $M$, Hann windowing, and half overlap ($50\\%$). The frequency resolution satisfies $\\Delta f \\approx 1/(M \\Delta t)$. For a Hann window, the equivalent noise bandwidth is $B_w = c_w \\Delta f$ with $c_w = 1.5$.\n\nModel the window-induced spectral dilution of the observable coherence in the Welch estimate at $f_0$ by the factor $\\min\\!\\left(1, b/B_w\\right)$ so that the expected observed coherence at $f_0$ equals $\\gamma_0^2 \\min\\!\\left(1, b/B_w\\right)$. Let the number of Welch segments be approximated by $K \\approx \\frac{2N}{M} - 1$ (due to half overlap), and let the effective number of independent averages be $K_{\\mathrm{eff}} = \\eta K$, where $\\eta \\in (0,1)$ captures the dependence induced by overlap and windowing.\n\nDefine statistical detection at significance level $\\alpha \\in (0,1)$ as requiring the magnitude-squared coherence estimate at $f_0$ to exceed the $(1-\\alpha)$ null percentile determined by $K_{\\mathrm{eff}}$. Using only fundamental definitions and well-tested statistical properties of the Welch coherence estimator, derive a single closed-form analytic expression for the minimal total sample count $N_{\\min}$, as a function of $\\alpha$, $\\eta$, $c_w$, $F_s$, $b$, and $\\gamma_0^2$, that guarantees the existence of at least one segment length $M$ which simultaneously satisfies:\n- the resolution constraint $B_w \\le b$, and\n- the statistical detection constraint at level $\\alpha$ with the expected observed coherence at $f_0$.\n\nYour final expression for $N_{\\min}$ must be closed-form, analytic, and expressed entirely in terms of the given parameters. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the minimal total sample count, $N_{\\min}$, for which there exists at least one segment length $M$ that satisfies two simultaneous constraints: one on frequency resolution and one on statistical detection of coherence.\n\nLet's formalize the two constraints on the segment length $M$.\n\nFirst, we analyze the resolution constraint. The problem states that the equivalent noise bandwidth, $B_w$, must be less than or equal to the bandwidth of the coherence peak, $b$.\nThe equivalent noise bandwidth is given as $B_w = c_w \\Delta f$. The frequency resolution is $\\Delta f \\approx 1/(M \\Delta t)$. The sampling frequency is $F_s = 1/\\Delta t$.\nSubstituting these into the constraint $B_w \\le b$:\n$$c_w \\left( \\frac{1}{M \\Delta t} \\right) \\le b$$\n$$c_w \\frac{F_s}{M} \\le b$$\nSolving for $M$ gives a lower bound on the segment length:\n$$M \\ge \\frac{c_w F_s}{b}$$\n\nSecond, we analyze the statistical detection constraint. The problem defines detection as the case where the coherence estimate exceeds a critical threshold determined by the significance level $\\alpha$. It further specifies that this condition should be evaluated for the *expected* value of the coherence estimate.\nThe detection condition is:\n$$\\mathbb{E}[\\hat{\\gamma}^2(f_0)] > \\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}})$$\nwhere $\\hat{\\gamma}^2(f_0)$ is the magnitude-squared coherence estimate at frequency $f_0$, and $\\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}})$ is the $(1-\\alpha)$ percentile of the estimator's distribution under the null hypothesis of zero coherence, given $K_{\\mathrm{eff}}$ effective degrees of freedom.\n\nThe expected observed coherence is modeled as $\\mathbb{E}[\\hat{\\gamma}^2(f_0)] = \\gamma_0^2 \\min(1, b/B_w)$. Since the first constraint requires $B_w \\le b$, it follows that $b/B_w \\ge 1$. Therefore, for any $M$ satisfying the resolution constraint, $\\min(1, b/B_w) = 1$. The expected coherence simplifies to the true coherence:\n$$\\mathbb{E}[\\hat{\\gamma}^2(f_0)] = \\gamma_0^2$$\n\nNext, we must find the expression for the critical value $\\gamma^2_{\\text{crit}}$. For Welch-based coherence estimation, under the null hypothesis ($\\gamma^2 = 0$), the cumulative distribution function (CDF) of the estimator $\\hat{\\gamma}^2$ for $K_{\\mathrm{eff}}$ effective averages is well-known:\n$$F_{\\hat{\\gamma}^2}(y) = P(\\hat{\\gamma}^2 \\le y) = 1 - (1-y)^{K_{\\mathrm{eff}}-1}$$\nThe critical value $\\gamma^2_{\\text{crit}}$ is the $(1-\\alpha)$ quantile, meaning $F_{\\hat{\\gamma}^2}(\\gamma^2_{\\text{crit}}) = 1-\\alpha$.\n$$1 - (1-\\gamma^2_{\\text{crit}})^{K_{\\mathrm{eff}}-1} = 1-\\alpha$$\n$$(1-\\gamma^2_{\\text{crit}})^{K_{\\mathrm{eff}}-1} = \\alpha$$\n$$1-\\gamma^2_{\\text{crit}} = \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\n$$\\gamma^2_{\\text{crit}}(\\alpha, K_{\\mathrm{eff}}) = 1 - \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\n\nSubstituting these into the statistical detection inequality:\n$$\\gamma_0^2 > 1 - \\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}}$$\nWe now solve this for $K_{\\mathrm{eff}}$.\n$$\\alpha^{\\frac{1}{K_{\\mathrm{eff}}-1}} > 1 - \\gamma_0^2$$\nTaking the natural logarithm of both sides. Since $\\alpha \\in (0,1)$, $\\ln(\\alpha)$ is negative.\n$$\\frac{1}{K_{\\mathrm{eff}}-1} \\ln(\\alpha) > \\ln(1 - \\gamma_0^2)$$\nDividing by $\\ln(\\alpha)$ reverses the inequality:\n$$\\frac{1}{K_{\\mathrm{eff}}-1} < \\frac{\\ln(1 - \\gamma_0^2)}{\\ln(\\alpha)}$$\nTaking the reciprocal of both sides (both sides are positive, since $\\ln(1-\\gamma_0^2)<0$ and $\\ln(\\alpha)<0$):\n$$K_{\\mathrm{eff}}-1 > \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\n$$K_{\\mathrm{eff}} > 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\n\nNow, we substitute the given expressions for $K_{\\mathrm{eff}}$ and $K$:\n$K_{\\mathrm{eff}} = \\eta K$, with $K \\approx \\frac{2N}{M} - 1$.\n$$\\eta \\left( \\frac{2N}{M} - 1 \\right) > 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)}$$\nSolving for $M$ to find its upper bound:\n$$\\frac{2N}{M} - 1 > \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)$$\n$$\\frac{2N}{M} > 1 + \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)$$\n$$M < \\frac{2N}{1 + \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)}$$\n\nWe now have two constraints on $M$:\n$$ \\frac{c_w F_s}{b} \\le M < \\frac{2N}{1 + \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)} $$\nFor at least one valid segment length $M$ to exist, the interval defined by these bounds must be non-empty. The minimal condition for this is when the lower bound is strictly less than the upper bound. The threshold value for $N$, which we denote $N_{\\min}$, is found by setting the lower bound equal to the upper bound.\n$$\\frac{c_w F_s}{b} = \\frac{2N_{\\min}}{1 + \\frac{1}{\\eta} \\left( 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)}$$\nFinally, we solve for $N_{\\min}$ to obtain the desired closed-form expression:\n$$N_{\\min} = \\frac{c_w F_s}{2b\\eta} \\left( \\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)$$\nThis expression represents the minimum number of samples required to ensure that a segment length $M$ can be chosen to simultaneously satisfy the spectral resolution and statistical detection criteria as defined in the problem.",
            "answer": "$$\n\\boxed{\\frac{c_w F_s}{2b\\eta} \\left( \\eta + 1 + \\frac{\\ln(\\alpha)}{\\ln(1 - \\gamma_0^2)} \\right)}\n$$"
        },
        {
            "introduction": "Beyond the mathematics of estimation, real-world data comes with its own set of challenges, particularly those arising from the measurement process itself. In electrophysiology, the choice of a reference electrode is a common source of artifacts that can create spurious coherence. This practice  guides you through an analysis of how different referencing schemes contaminate the cross-spectrum and explores advanced techniques to mitigate these effects, fostering a deeper understanding of how to distinguish true neural interaction from measurement artifact.",
            "id": "4151847",
            "problem": "An investigator analyzes Electroencephalography (EEG) recordings from a healthy participant with a high-density montage of $N=64$ channels, focusing on two occipital electrodes, denoted $x(t)$ for $\\mathrm{O1}$ and $y(t)$ for $\\mathrm{O2}$. The goal is to estimate the cross-spectral density $S_{xy}(f)$ in the alpha band around $f \\approx 10\\,\\mathrm{Hz}$ for two different re-referencing schemes: linked mastoids and average reference. Under linked mastoids, the reference is $r_{\\mathrm{LM}}(t) = \\left(m_{1}(t) + m_{2}(t)\\right)/2$, where $m_{1}(t)$ and $m_{2}(t)$ are mastoid signals. Under average reference, the reference is $r_{\\mathrm{AR}}(t) = \\frac{1}{N}\\sum_{k=1}^{N} v_{k}(t)$, where $v_{k}(t)$ are the scalp channel potentials. Empirically, the mastoids exhibit non-negligible alpha power due to volume conduction, and the average reference includes contributions from $\\mathrm{O1}$, $\\mathrm{O2}$, and other channels.\n\nAssume that within the analysis window, all processes are wide-sense stationary, re-referencing is performed by subtraction of the chosen reference from each channel, and $S_{xy}(f)$ is computed from the re-referenced signals using a consistent spectral estimator. Based on first principles of linear transformations of signals and the definition of cross-spectral density, which statements about how reference choice alters $S_{xy}(f)$ between $\\mathrm{O1}$ and $\\mathrm{O2}$ and strategies to minimize spurious coherence are most accurate? Select all that apply.\n\nA. Because both $\\mathrm{O1}$ and $\\mathrm{O2}$ share the same linked mastoid reference, the cross-spectral density between the re-referenced signals contains an additive contribution from the mastoid signal even if $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, which can inflate apparent coherence near $f\\approx 10\\,\\mathrm{Hz}$.\n\nB. With a high-density montage and average reference, the common reference term cancels to first order across channels, so if the original $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, $S_{xy}(f)$ for the re-referenced signals tends toward $0$ as $N$ grows, thereby reducing spurious coherence.\n\nC. Linear re-referencing leaves $S_{xy}(f)$ invariant, hence reference choice cannot change coherence between channels.\n\nD. Computing the imaginary part of coherency derived from $S_{xy}(f)$ suppresses zero-phase inflation due to common reference and volume conduction, thereby reducing spurious coherence estimates.\n\nE. Applying the surface Laplacian, also called current source density (CSD), as a linear spatial transform before spectral estimation reduces shared low-spatial-frequency components and thus lowers spurious zero-lag cross-spectral power between occipital channels.\n\nF. Increasing the number of averages in Welch’s method alone eliminates bias from common reference in $S_{xy}(f)$.",
            "solution": "The problem asks to evaluate statements about the effect of re-referencing on the cross-spectral density ($S_{xy}(f)$) between two EEG channels (O1 and O2) and strategies to mitigate resulting artifacts. The core of the analysis rests on understanding how subtracting a common reference signal modifies the spectral properties of the signals.\n\nLet the EEG potentials at O1 and O2 be denoted by $v_x(t)$ and $v_y(t)$, respectively. Let $r(t)$ be the reference signal. The re-referenced signals, $x'(t)$ and $y'(t)$, are given by:\n$$x'(t) = v_x(t) - r(t)$$\n$$y'(t) = v_y(t) - r(t)$$\nAll signals are assumed to be wide-sense stationary. The cross-spectral density (CSD) is the Fourier transform of the cross-correlation function. The cross-correlation of the re-referenced signals is:\n$$R_{x'y'}(\\tau) = E[x'(t) y'(t+\\tau)] = E[(v_x(t) - r(t))(v_y(t+\\tau) - r(t+\\tau))]$$\nExpanding the product and applying the linearity of expectation yields:\n$$R_{x'y'}(\\tau) = E[v_x(t)v_y(t+\\tau)] - E[v_x(t)r(t+\\tau)] - E[r(t)v_y(t+\\tau)] + E[r(t)r(t+\\tau)]$$\nIn terms of correlation functions, this is:\n$$R_{x'y'}(\\tau) = R_{v_x v_y}(\\tau) - R_{v_x r}(\\tau) - R_{r v_y}(\\tau) + R_{rr}(\\tau)$$\nApplying the Fourier transform to each term gives the CSD of the re-referenced signals, $S_{x'y'}(f)$:\n$$S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nThis equation is the foundation for evaluating the provided statements. $S_{v_x v_y}(f)$ is the CSD of the original signals, while the other three terms represent the influence of the reference. $S_{rr}(f)$ is the power spectral density (PSD) of the reference signal itself.\n\nNow, we evaluate each option:\n\n**A. Because both $\\mathrm{O1}$ and $\\mathrm{O2}$ share the same linked mastoid reference, the cross-spectral density between the re-referenced signals contains an additive contribution from the mastoid signal even if $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, which can inflate apparent coherence near $f\\approx 10\\,\\mathrm{Hz}$.**\n\nThe reference is $r(t) = r_{\\mathrm{LM}}(t)$. The problem states that the mastoids exhibit non-negligible alpha power, meaning $S_{rr}(f) = S_{r_{\\mathrm{LM}} r_{\\mathrm{LM}}}(f)$ is large around $f \\approx 10\\,\\mathrm{Hz}$.\nFrom our derived formula:\n$$S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nIf the original signals $v_x(t)$ and $v_y(t)$ are independent (and assuming zero mean), their cross-spectrum $S_{v_x v_y}(f)$ is zero. The expression for the re-referenced CSD becomes:\n$$S_{x'y'}(f) = - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nThe term $+S_{rr}(f)$ is a direct additive contribution from the reference signal's power. Since $S_{rr}(f)$ is stated to be significant in the alpha band, this term will be non-zero, creating a spurious non-zero CSD between the re-referenced O1 and O2 signals. This spurious CSD inflates the numerator of the coherence calculation, $\\gamma^2(f) = |S_{xy}(f)|^2 / (S_{xx}(f)S_{yy}(f))$, leading to an artificially high coherence estimate. The statement accurately describes this well-known artifact.\n\nVerdict: **Correct**.\n\n**B. With a high-density montage and average reference, the common reference term cancels to first order across channels, so if the original $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, $S_{xy}(f)$ for the re-referenced signals tends toward $0$ as $N$ grows, thereby reducing spurious coherence.**\n\nThe average reference is $r(t) = r_{\\mathrm{AR}}(t) = \\frac{1}{N}\\sum_{k=1}^{N} v_{k}(t)$. Let's analyze the terms of the CSD formula. Assume the original signals $v_k(t)$ are mutually uncorrelated, each with power spectrum $S_{v_k v_k}(f)$, and $v_x(t) = v_1(t)$, $v_y(t) = v_2(t)$.\nThe power of the reference is $S_{rr}(f) = S_{r_{\\mathrm{AR}} r_{\\mathrm{AR}}}(f) = \\frac{1}{N^2} \\sum_{k=1}^{N} S_{v_k v_k}(f)$.\nThe cross-spectra with the reference are $S_{v_x r}(f) = S_{v_1, \\frac{1}{N}\\sum_k v_k}(f) = \\frac{1}{N}S_{v_1 v_1}(f)$ and $S_{r v_y}(f) = S_{\\frac{1}{N}\\sum_k v_k, v_2}(f) = \\frac{1}{N} S_{v_2 v_2}(f)$ (since $S_{v_k v_j}(f) = 0$ for $k \\ne j$).\nIf the original O1 and O2 are independent, $S_{v_x v_y}(f)=0$. The re-referenced CSD is:\n$$S_{x'y'}(f) = 0 - \\frac{1}{N}S_{v_x v_x}(f) - \\frac{1}{N}S_{v_y v_y}(f) + \\frac{1}{N^2}\\sum_{k=1}^{N} S_{v_k v_k}(f)$$\nLet $\\bar{S}_{vv}(f) = \\frac{1}{N}\\sum_{k=1}^{N} S_{v_k v_k}(f)$ be the average power spectrum. Then:\n$$S_{x'y'}(f) = -\\frac{1}{N}S_{v_x v_x}(f) - \\frac{1}{N}S_{v_y v_y}(f) + \\frac{1}{N}\\bar{S}_{vv}(f) = \\frac{1}{N}\\left(\\bar{S}_{vv}(f) - S_{v_x v_x}(f) - S_{v_y v_y}(f)\\right)$$\nAs the number of channels $N$ becomes large, the term $\\frac{1}{N}$ drives the entire expression towards zero. The average reference $r_{\\mathrm{AR}}(t)$ approaches a stable zero potential (by a law of large numbers argument), so its contaminating effect diminishes. The statement that $S_{xy}(f)$ tends toward $0$ as $N$ grows is accurate.\n\nVerdict: **Correct**.\n\n**C. Linear re-referencing leaves $S_{xy}(f)$ invariant, hence reference choice cannot change coherence between channels.**\n\nAs derived in the preamble, the new CSD is $S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$. For $S_{x'y'}(f)$ to be equal to $S_{v_x v_y}(f)$, the following condition must hold: $-S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f) = 0$. This is not true in general. For almost any active reference $r(t)$ (i.e., $S_{rr}(f) \\ne 0$), the CSD will be altered. The entire premise of the \"reference problem\" in EEG is that the choice of reference *does* alter spectral measures, including CSD and coherence. This statement is fundamentally incorrect.\n\nVerdict: **Incorrect**.\n\n**D. Computing the imaginary part of coherency derived from $S_{xy}(f)$ suppresses zero-phase inflation due to common reference and volume conduction, thereby reducing spurious coherence estimates.**\n\nSpurious correlation from a common reference or volume conduction is typically a zero-phase-lag phenomenon. The contribution of a common reference signal $r(t)$ to the CSD includes the term $S_{rr}(f)$, which is the power spectral density of a real-valued signal. A PSD is always real-valued, so $\\text{Im}\\{S_{rr}(f)\\} = 0$. Similarly, volume conduction is often modeled as an instantaneous mixing of sources, which also contributes a real-valued component to the CSD.\nThe coherency is the complex-valued quantity $\\gamma_{xy}(f) = \\frac{S_{xy}(f)}{\\sqrt{S_{xx}(f) S_{yy}(f)}}$.\nThe imaginary part of the coherency is $\\text{Im}\\{\\gamma_{xy}(f)\\} = \\frac{\\text{Im}\\{S_{xy}(f)\\}}{\\sqrt{S_{xx}(f) S_{yy}(f)}}$.\nBy computing $\\text{Im}\\{S_{xy}(f)\\}$, one isolates the portion of the cross-spectrum corresponding to non-zero phase lags. True neurophysiological interactions often involve propagation delays, leading to a non-zero phase lag and thus a non-zero imaginary part of the CSD. By focusing on this imaginary component, the zero-phase artifacts from common reference and volume conduction are indeed suppressed. This is a recognized technique for obtaining more robust estimates of brain connectivity.\n\nVerdict: **Correct**.\n\n**E. Applying the surface Laplacian, also called current source density (CSD), as a linear spatial transform before spectral estimation reduces shared low-spatial-frequency components and thus lowers spurious zero-lag cross-spectral power between occipital channels.**\n\nThe surface Laplacian is an estimate of the second spatial derivative of the scalp potential field. It acts as a spatial high-pass filter, meaning it attenuates components that are broadly distributed (low spatial frequency) and enhances components that are spatially focal (high spatial frequency).\nA common reference signal affects all channels, creating a very low (zero) spatial frequency component. Similarly, volume conduction from deep or distant sources smears the potential across the scalp, also creating a low spatial frequency signal component shared by many electrodes. The surface Laplacian transform is explicitly designed to combat these effects. By attenuating these shared, widespread signals, it reduces the common signal components between the two occipital channels before the spectral analysis is performed. This directly reduces the spurious cross-spectral power that arises from these common components. Furthermore, the Laplacian is reference-independent, effectively solving the reference problem.\n\nVerdict: **Correct**.\n\n**F. Increasing the number of averages in Welch’s method alone eliminates bias from common reference in $S_{xy}(f)$.**\n\nWelch's method for spectral estimation involves averaging the periodograms of multiple, possibly overlapping, segments of the data. This procedure has a well-known statistical effect: it reduces the *variance* of the spectral estimate. As the number of segments $K$ goes to infinity, the variance of the estimate approaches zero. The estimate converges to the expected value of the periodogram, which (for long enough segments) is the true CSD of the input signals.\nIn this context, the input signals are the re-referenced signals $x'(t)$ and $y'(t)$. Therefore, Welch's method provides a good estimate of $S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$.\nThe \"bias\" in question is the deviation of $S_{x'y'}(f)$ from the desired \"true\" CSD, $S_{v_x v_y}(f)$. This bias is represented by the terms involving the reference, $- S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$. Welch's method makes the estimate of the *biased spectrum* more precise; it does not remove the bias itself. The bias is inherent to the re-referenced data. To eliminate this bias, one must change the data itself (e.g., via Laplacian) or use a different referencing scheme, not simply change the spectral estimation parameters.\n\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{ABDE}$$"
        }
    ]
}