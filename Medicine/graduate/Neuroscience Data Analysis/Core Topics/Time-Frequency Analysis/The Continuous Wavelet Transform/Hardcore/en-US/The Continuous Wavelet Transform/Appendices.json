{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in any Continuous Wavelet Transform (CWT) analysis is translating the scientific question about specific frequency bands into the technical parameters of wavelet scales. This practice guides you through the fundamental derivation of the relationship between a wavelet's scale and the \"pseudo-frequency\" it is most sensitive to. By working from the first principles of Fourier scaling, you will learn to design a precise, logarithmically-spaced set of scales to cover a target frequency range, a key feature that gives the CWT its \"zoom-lens\" capability for neural signal analysis .",
            "id": "4198700",
            "problem": "You are given a discrete neural time series $x[n]$ sampled at a sampling frequency $f_s$ (in Hz), with sampling period $\\Delta t$ (in seconds) equal to $\\Delta t = 1 / f_s$. Consider the Continuous Wavelet Transform (CWT), defined for a mother wavelet $\\psi(t)$ by scaled and translated atoms $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t-b}{a}\\right)$ for scale $a  0$ and translation $b \\in \\mathbb{R}$. For neuroscience data analysis, a commonly used mother wavelet is the Morlet wavelet, which has a well-defined spectral peak. You must start from the fundamental properties of Fourier transforms and wavelet scaling, and use the scaling relations to derive a principled mapping between scale $a$ and a corresponding pseudo-frequency $f$ (in Hz) for the Morlet wavelet. The angular frequency parameter associated with the Morlet wavelet must be treated in radians, and you must explicitly use radians as the angle unit.\n\nDesign a discrete set of scales $\\{a_k\\}_{k=0}^{K-1}$ that covers a target frequency band $[f_{\\min}, f_{\\max}]$ (in Hz) for the pseudo-frequency associated with each scale, where $f_{\\max} \\leq f_s/2$ (Nyquist limit). Use a constant-quality-factor (constant-$Q$) design criterion: the adjacent pseudo-frequencies must form a geometric progression across the band, meaning there exists a constant ratio $r$ such that $f_{k+1} = r \\cdot f_k$ for all valid $k$. You must derive the mapping between $a_k$ and $f_k$ from first principles, without assuming any pre-given wavelet frequency-scale formulas, and then implement it to compute scales from the desired pseudo-frequencies.\n\nYour program must implement the following steps for each test case:\n- Compute $\\Delta t = 1 / f_s$.\n- Construct $K$ pseudo-frequencies $\\{f_k\\}$ that geometrically span $[f_{\\min}, f_{\\max}]$ according to the constant-$Q$ criterion, with $f_0 = f_{\\max}$ and $f_{K-1} = f_{\\min}$ for $K \\geq 2$. For $K = 1$, set $f_0 = f_{\\min} = f_{\\max}$.\n- Using your derived mapping, compute scales $\\{a_k\\}$ that realize those pseudo-frequencies.\n- Recompute pseudo-frequencies $\\{\\hat{f}_k\\}$ from the scales to verify consistency.\n\nFor each test case, compute and return the following quantifiable outputs:\n1. The minimum pseudo-frequency $\\min_k \\hat{f}_k$ (a float, in Hz).\n2. The maximum pseudo-frequency $\\max_k \\hat{f}_k$ (a float, in Hz).\n3. The maximum relative edge error between the target band edges and the realized pseudo-frequencies: $\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$ (a float).\n4. The maximum absolute deviation of the realized consecutive frequency ratios from the target geometric ratio $r$ (a float). For $K=1$, define this deviation to be $0$.\n5. A boolean indicating whether all realized pseudo-frequencies lie within the closed interval $[f_{\\min}, f_{\\max}]$ (inclusive), allowing only numerical roundoff at the level of standard double-precision floating-point arithmetic.\n\nUnits and angle specification:\n- All frequencies $f$, $f_{\\min}$, $f_{\\max}$, $f_s$, $\\hat{f}_k$ are in Hz.\n- Sampling period $\\Delta t$ is in seconds.\n- Angular frequency parameters are in radians, and any angular quantity used must be in radians.\n- No angles in degrees are permitted.\n\nTest suite:\nProvide results for the following parameter sets $\\left(f_s, f_{\\min}, f_{\\max}, K, \\omega_0\\right)$, where $\\omega_0$ is the Morlet wavelet central angular frequency parameter (in radians), used in your derivation and implementation:\n- Case $1$: $\\left(f_s = 1000, f_{\\min} = 4, f_{\\max} = 100, K = 12, \\omega_0 = 6\\right)$.\n- Case $2$: $\\left(f_s = 500, f_{\\min} = 20, f_{\\max} = 240, K = 18, \\omega_0 = 6\\right)$.\n- Case $3$: $\\left(f_s = 250, f_{\\min} = 1, f_{\\max} = 4, K = 10, \\omega_0 = 5\\right)$.\n- Case $4$: $\\left(f_s = 1000, f_{\\min} = 30, f_{\\max} = 30, K = 1, \\omega_0 = 6\\right)$.\n- Case $5$: $\\left(f_s = 2000, f_{\\min} = 800, f_{\\max} = 950, K = 5, \\omega_0 = 7\\right)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the five values in the exact order specified above, producing a nested list. For example, the output should have the form $[\\,[\\text{case1\\_min},\\text{case1\\_max},\\text{case1\\_err},\\text{case1\\_dev},\\text{case1\\_bool}],\\ldots\\,]$.",
            "solution": "We begin from the definition of the Continuous Wavelet Transform (CWT) for a mother wavelet $\\psi(t)$, where scaled atoms are given by $\\psi_{a}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ for scale $a  0$. The translation parameter is not needed for the scale-frequency mapping derivation. A widely used mother wavelet in neuroscience is the Morlet wavelet, defined in a nondimensional time variable by\n$$\n\\psi(t) = \\pi^{-1/4} \\exp\\left(i\\,\\omega_0\\, t\\right)\\exp\\left(-\\frac{t^2}{2}\\right),\n$$\nwhere $\\omega_0$ is a central angular frequency parameter in radians. The key foundational facts we use are:\n1. The Fourier transform scaling property: If $\\mathcal{F}\\{\\psi(t)\\}(\\omega) = \\hat{\\psi}(\\omega)$, then the Fourier transform of $\\psi_a(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ is $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$.\n2. The Morlet wavelet has a Fourier-domain peak at angular frequency approximately $\\omega = \\omega_0$ for the unscaled wavelet $\\psi(t)$, owing to the complex exponential $\\exp(i\\,\\omega_0 t)$ modulated by a Gaussian envelope.\n\nUsing these, we derive how the spectral peak shifts with scale. For the scaled wavelet $\\psi_a(t)$, the Fourier transform is $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$, so the location of the peak in $\\hat{\\psi}_a(\\omega)$ occurs when $a\\,\\omega \\approx \\omega_0$, i.e.,\n$$\n\\omega \\approx \\frac{\\omega_0}{a}.\n$$\nThis establishes the central angular frequency of the scaled wavelet in continuous time. To relate this to a discrete-time sampled signal $x[n]$ with sampling period $\\Delta t = 1/f_s$ (in seconds), we convert angular frequency to cycles per second (Hz). Angular frequency and ordinary frequency are related by $\\omega = 2\\pi f$ in radians per second. Substituting,\n$$\n2\\pi f \\approx \\frac{\\omega_0}{a}.\n$$\nIn sampled data analysis, the pseudo-frequency in Hz realized by a given scale $a$ must account for the discrete sampling interval $\\Delta t$. Because the nondimensional time used in the mother wavelet corresponds to physical time via $t_{\\text{phys}} = t \\cdot \\Delta t$, the effective frequency in Hz is\n$$\nf(a) \\approx \\frac{\\omega_0}{2\\pi\\, a\\, \\Delta t}.\n$$\nThis is the required scale-to-pseudo-frequency mapping derived from the Fourier scaling property and the definition of angular frequency. It uses radians as the angle unit for $\\omega_0$ and seconds for $\\Delta t$.\n\nWe now design a discrete set of scales $\\{a_k\\}_{k=0}^{K-1}$ to cover a target frequency band $[f_{\\min}, f_{\\max}]$ in Hz under a constant-quality-factor criterion. A constant-$Q$ design asks that adjacent pseudo-frequencies form a geometric progression. Let $K$ be the number of scales. For $K \\geq 2$, define a geometric sequence of target pseudo-frequencies $\\{f_k\\}$ by\n$$\nf_k = f_{\\max}\\, r^k, \\quad k = 0,1,\\ldots,K-1,\n$$\nwith common ratio\n$$\nr = \\left(\\frac{f_{\\min}}{f_{\\max}}\\right)^{\\frac{1}{K-1}}.\n$$\nThis ensures $f_0 = f_{\\max}$ and $f_{K-1} = f_{\\min}$. For $K = 1$, we set $f_0 = f_{\\min} = f_{\\max}$, trivially covering the band. Given the derived mapping between scale $a$ and pseudo-frequency $f$, we invert the mapping to obtain scales from the desired pseudo-frequencies:\n$$\na_k = \\frac{\\omega_0}{2\\pi\\, f_k\\, \\Delta t}.\n$$\nTo verify correctness, we recompute the realized pseudo-frequencies from the scales:\n$$\n\\hat{f}_k = \\frac{\\omega_0}{2\\pi\\, a_k\\, \\Delta t}.\n$$\nBy construction, $\\hat{f}_k$ equals $f_k$ up to floating-point roundoff.\n\nAlgorithmic steps for each test case:\n1. Compute $\\Delta t = 1/f_s$.\n2. If $K \\geq 2$, compute $r = (f_{\\min}/f_{\\max})^{1/(K-1)}$ and the sequence $f_k = f_{\\max} r^k$. If $K = 1$, set $f_0 = f_{\\min} = f_{\\max}$.\n3. Compute scales $a_k = \\omega_0/(2\\pi f_k \\Delta t)$.\n4. Recompute $\\hat{f}_k = \\omega_0/(2\\pi a_k \\Delta t)$.\n5. Compute the outputs:\n   - $\\min_k \\hat{f}_k$ and $\\max_k \\hat{f}_k$ in Hz.\n   - The maximum relative edge error $\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$.\n   - The maximum absolute deviation of consecutive realized ratios $\\hat{r}_k = \\hat{f}_{k+1}/\\hat{f}_k$ from $r$. For $K=1$, this deviation is defined to be $0$.\n   - A boolean indicating whether all $\\hat{f}_k$ lie in $[f_{\\min}, f_{\\max}]$ (inclusive), allowing only numerical roundoff.\n\nScientific realism and constraints:\n- The design ensures $f_{\\max} \\leq f_s/2$ (Nyquist limit) in the provided test suite.\n- The Morlet parameter $\\omega_0$ is specified in radians and kept within typical values used in neuroscience ($\\omega_0$ in the range of $5$ to $7$ is common).\n\nTest suite coverage:\n- Case $1$ is a typical local field potential analysis band with $f_s = 1000$, $[f_{\\min}, f_{\\max}] = [4, 100]$, $K = 12$, $\\omega_0 = 6$.\n- Case $2$ approaches the Nyquist limit with $f_s = 500$, $[20, 240]$, $K = 18$, $\\omega_0 = 6$.\n- Case $3$ focuses on low-frequency bands with $f_s = 250$, $[1, 4]$, $K = 10$, $\\omega_0 = 5$.\n- Case $4$ tests the degenerate single-scale scenario with $f_s = 1000$, $[30, 30]$, $K = 1$, $\\omega_0 = 6$.\n- Case $5$ is a narrow high-frequency band near Nyquist with $f_s = 2000$, $[800, 950]$, $K = 5$, $\\omega_0 = 7$.\n\nThe final program outputs, for each test case, the list $[\\min_k \\hat{f}_k, \\max_k \\hat{f}_k, \\text{edge\\_error}, \\text{ratio\\_deviation}, \\text{coverage\\_boolean}]$, aggregated into a single top-level list and printed as one line.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef design_scales_and_metrics(fs, f_min, f_max, K, w0):\n    \"\"\"\n    Design constant-Q pseudo-frequencies and corresponding scales for a Morlet wavelet,\n    then compute verification metrics.\n\n    Parameters:\n        fs (float): Sampling frequency in Hz.\n        f_min (float): Minimum target pseudo-frequency in Hz.\n        f_max (float): Maximum target pseudo-frequency in Hz.\n        K (int): Number of scales.\n        w0 (float): Morlet central angular frequency parameter in radians.\n\n    Returns:\n        list: [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n    \"\"\"\n    dt = 1.0 / fs\n\n    # Construct geometric sequence of target pseudo-frequencies\n    if K >= 2:\n        r = (f_min / f_max) ** (1.0 / (K - 1))\n        # f_k descending from f_max to f_min\n        f_k = f_max * (r ** np.arange(K))\n    else:\n        # K == 1\n        r = 1.0\n        f_k = np.array([f_min], dtype=float)\n\n    # Compute scales from derived mapping: a_k = w0 / (2*pi*f_k*dt)\n    two_pi = 2.0 * np.pi\n    a_k = w0 / (two_pi * f_k * dt)\n\n    # Recompute pseudo-frequencies from scales to verify: f_hat_k = w0 / (2*pi*a_k*dt)\n    f_hat_k = w0 / (two_pi * a_k * dt)\n\n    # Metrics\n    min_fk = float(np.min(f_hat_k))\n    max_fk = float(np.max(f_hat_k))\n\n    # Edge relative error\n    # Avoid division by zero if f_min == 0 (not present in our test suite)\n    edge_err_min = abs((f_min - min_fk) / f_min) if f_min != 0 else abs(f_min - min_fk)\n    edge_err_max = abs((f_max - max_fk) / f_max) if f_max != 0 else abs(f_max - max_fk)\n    edge_rel_error = float(max(edge_err_min, edge_err_max))\n\n    # Ratio deviation: compare realized consecutive ratios to target r\n    if K >= 2:\n        realized_ratios = f_hat_k[1:] / f_hat_k[:-1]\n        ratio_dev = float(np.max(np.abs(realized_ratios - r)))\n    else:\n        ratio_dev = 0.0\n\n    # Coverage boolean: all realized pseudo-frequencies within [f_min, f_max]\n    # Allow tiny numerical tolerance\n    tol = 1e-12\n    coverage_bool = (min_fk >= f_min - tol) and (max_fk = f_max + tol)\n\n    return [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (fs, f_min, f_max, K, w0)\n    test_cases = [\n        (1000.0, 4.0, 100.0, 12, 6.0),\n        (500.0, 20.0, 240.0, 18, 6.0),\n        (250.0, 1.0, 4.0, 10, 5.0),\n        (1000.0, 30.0, 30.0, 1, 6.0),\n        (2000.0, 800.0, 950.0, 5, 7.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        fs, f_min, f_max, K, w0 = case\n        result = design_scales_and_metrics(fs, f_min, f_max, K, w0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Theoretical signals are often infinite, but real-world neural recordings are always finite. This practical limitation introduces boundary artifacts, or \"edge effects,\" where the wavelet is truncated by the signal's beginning or end. This exercise confronts this unavoidable issue by having you derive and quantify the resulting amplitude bias in the CWT coefficients. Understanding this \"cone of influence\" is essential for accurately interpreting time-frequency representations and avoiding erroneous conclusions about neural activity near the edges of your analysis window .",
            "id": "4198675",
            "problem": "You are given a finite-duration observation of a one-dimensional signal used in neuroscience data analysis. The goal is to analyze the impact of finite-length signals on the Continuous Wavelet Transform (CWT) near boundaries, derive the effective truncation of the scaled and shifted wavelet, and quantify the amplitude bias as a function of the scale. Use only mathematically rigorous definitions and derivations based on the following fundamental bases.\n\nDefinitions and assumptions:\n- The Continuous Wavelet Transform (CWT) of a signal $x(t)$ with respect to a mother wavelet $\\psi(t)$ is defined by\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt,\n$$\nwhere $a \\in \\mathbb{R}^{+}$ is the scale, $b \\in \\mathbb{R}$ is the translation, and $\\psi^{*}$ denotes the complex conjugate.\n- The observed signal is time-limited to the interval $[0, T]$ seconds, where $T  0$ is the total duration in seconds. The observed CWT is\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{0}^{T} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt.\n$$\n- The mother wavelet is the complex Morlet wavelet,\n$$\n\\psi(t) = \\pi^{-1/4} \\, e^{i \\omega_{0} t} \\, e^{-t^{2}/2},\n$$\nwith central angular frequency $\\omega_{0}  0$. The scaled and shifted wavelet is\n$$\n\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\!\\left(\\frac{t-b}{a}\\right).\n$$\n- The analysis signal is a narrowband oscillation modeled as\n$$\nx(t) = e^{i 2\\pi f_{0} t},\n$$\nwhere $f_{0}$ is the oscillation frequency in Hertz (Hz).\n- All times must be expressed in seconds and all frequencies in Hertz. There are no angles to report.\n\nTasks:\n1. Derive the effective truncation of the scaled and shifted wavelet $\\psi_{a,b}(t)$ near the boundaries caused by the finite observation interval $[0,T]$. Define the energy-inclusion fraction\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\nand express it in closed form using fundamental integrals and well-known special functions.\n2. Starting from the definition of the Continuous Wavelet Transform and the finite observation interval, derive a closed-form expression for the amplitude bias near boundaries defined by\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|},\n$$\nas a function of the scale $a$, translation $b$, duration $T$, oscillation frequency $f_{0}$, and wavelet central angular frequency $\\omega_{0}$.\n3. Implement a program that uses your derived expression to compute $B(a,b;T,f_{0},\\omega_{0})$ for each test case below. For each case, set $f_{0}$ to match the wavelet’s peak response for the given scale, that is $f_{0} = \\omega_{0}/(2\\pi a)$, to isolate boundary-induced effects. The units must be seconds for $T$ and $b$, and Hertz for $f_{0}$.\n4. The final program output must be a single line containing a comma-separated list enclosed in square brackets with the amplitude bias values $B$ for the following test suite. Each result must be a float.\n\nTest Suite (time in seconds, frequency in Hertz):\n- Case 1 (near left boundary, moderate scale): $T = 10.0$, $b = 0.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 2 (exact left boundary, moderate scale): $T = 10.0$, $b = 0.0$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 3 (near left boundary, large scale): $T = 10.0$, $b = 0.5$, $a = 2.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 4 (center of interval): $T = 10.0$, $b = 5.0$, $a = 1.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 5 (near right boundary, moderate scale): $T = 10.0$, $b = 9.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_{1},r_{2},r_{3},r_{4},r_{5}]$), where each $r_{k}$ is the float value of $B(a,b;T,f_{0},\\omega_{0})$ for the corresponding case.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information for a rigorous derivation. The definitions of the Continuous Wavelet Transform (CWT), the complex Morlet wavelet, and the problem objectives are standard in the field of time-frequency analysis. We may therefore proceed with the solution.\n\nThe analysis is divided into two main tasks: first, deriving the energy-inclusion fraction $\\Gamma(a,b;T)$, and second, deriving the amplitude bias $B(a,b;T,f_{0},\\omega_{0})$.\n\n**Task 1: Derivation of the Energy-Inclusion Fraction $\\Gamma(a,b;T)$**\n\nThe energy-inclusion fraction $\\Gamma(a,b;T)$ is defined as the ratio of the energy of the scaled and shifted wavelet within the observation interval $[0, T]$ to its total energy over $(-\\infty, \\infty)$.\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\nThe mother wavelet is $\\psi(t) = \\pi^{-1/4} e^{i \\omega_{0} t} e^{-t^{2}/2}$. The scaled and shifted wavelet is $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\left(\\frac{t-b}{a}\\right)$.\n\nFirst, we compute the squared magnitude of $\\psi_{a,b}(t)$:\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\left| \\frac{1}{\\sqrt{a}} \\pi^{-1/4} e^{i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\right|^2 = \\frac{1}{a} \\pi^{-1/2} \\left| e^{i \\omega_{0} (t-b)/a} \\right|^2 \\left| e^{-((t-b)/a)^{2}/2} \\right|^2\n$$\nSince $|e^{i\\theta}| = 1$ and the exponential of a real number is its own magnitude, we get:\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\frac{1}{a \\sqrt{\\pi}} e^{-((t-b)/a)^{2}}\n$$\nThe denominator of $\\Gamma(a,b;T)$ is the total energy. We demonstrate that the wavelet has unit energy:\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-((t-b)/a)^{2}} \\, dt\n$$\nLet $u = (t-b)/a$, so $dt = a \\, du$. The integration limits remain $(-\\infty, \\infty)$.\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} (a \\, du) = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\sqrt{\\pi} = 1\n$$\nThis confirms the denominator is $1$.\n\nNext, we compute the numerator, which is the integral over the finite interval $[0, T]$:\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{0}^{T} e^{-((t-b)/a)^{2}} \\, dt\n$$\nUsing the same substitution $u = (t-b)/a$, the integration limits become $u_{lower} = -b/a$ and $u_{upper} = (T-b)/a$.\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du\n$$\nThis integral is expressed in terms of the error function, $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-x^2} \\, dx$. The integral $\\int_{z_1}^{z_2} e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}(\\text{erf}(z_2) - \\text{erf}(z_1))$.\n$$\n\\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) - \\text{erf}\\left(-\\frac{b}{a}\\right) \\right]\n$$\nUsing the property $\\text{erf}(-z) = -\\text{erf}(z)$, we obtain the closed-form expression for the numerator.\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\nThus, the energy-inclusion fraction is:\n$$\n\\Gamma(a,b;T) = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\n\n**Task 2: Derivation of the Amplitude Bias $B(a,b;T,f_{0},\\omega_{0})$**\n\nThe amplitude bias $B$ is the ratio of the magnitude of the CWT for the finite signal, $\\widetilde{W}_{x}(a,b)$, to that of the infinite signal, $W_{x}(a,b)$.\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|}\n$$\nThe signal is $x(t) = e^{i 2\\pi f_{0} t}$ and the wavelet transform is computed using $\\psi_{a,b}^*(t) = \\frac{1}{\\sqrt{a}} \\psi^*\\left(\\frac{t-b}{a}\\right)$. The complex conjugate of the mother wavelet is $\\psi^*(t) = \\pi^{-1/4} e^{-i \\omega_{0} t} e^{-t^{2}/2}$.\nThe CWT for the infinite signal is:\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} e^{i 2\\pi f_{0} t} \\, \\pi^{-1/4} e^{-i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\, dt\n$$\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{i(2\\pi f_0 - \\omega_0/a) t} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nThe problem specifies setting the analysis frequency $f_{0}$ to match the wavelet's peak response at scale $a$, which is $f_{0} = \\omega_{0}/(2\\pi a)$. This condition implies $2\\pi f_0 - \\omega_0/a = 0$, significantly simplifying the integral:\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nThe integral is a standard Gaussian integral. Let $v = (t-b)/(\\sqrt{2}a)$, so $dt=\\sqrt{2}a \\, dv$.\n$$\n\\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-\\infty}^{\\infty} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\sqrt{\\pi}\n$$\nSubstituting this back, we get:\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} (\\sqrt{2}a \\sqrt{\\pi}) = \\sqrt{2a} \\pi^{1/4} e^{i\\omega_0 b/a}\n$$\nThe magnitude is therefore $|W_{x}(a,b)| = \\sqrt{2a} \\pi^{1/4}$.\n\nNow we compute the observed CWT, $\\widetilde{W}_{x}(a,b)$, over the interval $[0, T]$ under the same condition $f_{0} = \\omega_{0}/(2\\pi a)$:\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nUsing the same substitution $v = (t-b)/(\\sqrt{2}a)$, the limits of integration for $v$ become $v_{lower} = -b/(\\sqrt{2}a)$ and $v_{upper} = (T-b)/(\\sqrt{2}a)$.\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-b/(\\sqrt{2}a)}^{(T-b)/(\\sqrt{2}a)} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) - \\text{erf}\\left(-\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nSubstituting this into the expression for $\\widetilde{W}_{x}(a,b)$:\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\left( \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right] \\right)\n$$\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} e^{i\\omega_0 b/a} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nThe magnitude is found by taking the absolute value. Since $a0$, $T0$, and for the test cases $0 \\le b \\le T$, the arguments to the error function are non-negative, and thus the term in brackets is real and non-negative.\n$$\n\\left| \\widetilde{W}_{x}(a,b) \\right| = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nFinally, we compute the ratio $B$:\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|} = \\frac{\\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]}{\\sqrt{2a} \\pi^{1/4}}\n$$\nThis simplifies to the final expression for the amplitude bias:\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{1}{2}\\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nNote that under the specified frequency condition, the bias $B$ is independent of $\\omega_0$ and $f_0$. It is purely a function of the geometric relationship between the wavelet's temporal support (determined by scale $a$) and its position $b$ relative to the signal boundaries $[0, T]$.\n\nThe provided code implements this final formula for $B$ to compute the values for the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the amplitude bias of the CWT near signal boundaries\n    for a given set of parameters.\n    \"\"\"\n    # Test Suite (T, b, a, omega_0)\n    # T: signal duration in seconds\n    # b: wavelet translation in seconds\n    # a: wavelet scale (dimensionless)\n    # omega_0: wavelet central angular frequency (rad/s)\n    # f_0 is set to omega_0 / (2*pi*a) as per the problem, which simplifies\n    # the bias formula to be independent of f_0 and omega_0.\n    test_cases = [\n        # Case 1: T=10.0, b=0.5, a=0.5, omega_0=6.0\n        (10.0, 0.5, 0.5, 6.0),\n        # Case 2: T=10.0, b=0.0, a=0.5, omega_0=6.0\n        (10.0, 0.0, 0.5, 6.0),\n        # Case 3: T=10.0, b=0.5, a=2.0, omega_0=6.0\n        (10.0, 0.5, 2.0, 6.0),\n        # Case 4: T=10.0, b=5.0, a=1.0, omega_0=6.0\n        (10.0, 5.0, 1.0, 6.0),\n        # Case 5: T=10.0, b=9.5, a=0.5, omega_0=6.0\n        (10.0, 9.5, 0.5, 6.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, b, a, omega_0 = case\n\n        # The derived closed-form expression for the amplitude bias B is:\n        # B = 0.5 * [ erf((T-b)/(sqrt(2)*a)) + erf(b/(sqrt(2)*a)) ]\n        # This formula is valid under the condition f_0 = omega_0 / (2*pi*a),\n        # which isolates boundary effects from frequency mismatch effects.\n\n        arg1 = (T - b) / (np.sqrt(2.0) * a)\n        arg2 = b / (np.sqrt(2.0) * a)\n\n        bias = 0.5 * (erf(arg1) + erf(arg2))\n        results.append(bias)\n\n    # Format the final output as a single line: [r1,r2,r3,r4,r5]\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond selecting scales, the very shape of the mother wavelet is a powerful parameter that can be tuned to the signal features of interest. This practice delves into the heart of the time-frequency trade-off by asking you to optimize a Morlet wavelet for detecting a transient neural burst of a known duration. By deriving the ideal central frequency parameter $\\omega_0$, you will gain a deeper intuition for how a wavelet's time and frequency resolution can be adjusted to maximize sensitivity to specific neural events, moving beyond default parameters to a more principled and powerful analysis .",
            "id": "4198724",
            "problem": "You are analyzing a transient narrowband neural oscillation burst in a local field potential recording using the Continuous Wavelet Transform (CWT). The oscillation can be modeled as a complex sinusoid with a rectangular time support centered at $b_{0}$: $x(t) = A \\exp\\!\\big(i\\,2\\pi f\\,t\\big)\\,w(t)$, where $w(t) = 1$ for $|t-b_{0}| \\leq T/2$ and $w(t) = 0$ otherwise, $A$ is a constant amplitude, $f$ is the oscillation frequency, and $T$ is the duration of the burst. You analyze $x(t)$ with the CWT defined by\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\nwhere $\\psi(t)$ is the Complex Morlet Wavelet (CMW) mother wavelet, $\\psi(t) = \\pi^{-1/4}\\,\\exp\\!\\big(i\\,\\omega_{0}\\,t\\big)\\,\\exp\\!\\big(-t^{2}/2\\big)$, $\\omega_{0}$ is the dimensionless central frequency of the mother wavelet, and ${}^{*}$ denotes complex conjugation. Assume the admissibility correction is negligible (which holds for sufficiently large $\\omega_{0}$) and that the analysis is carried out at the oscillation time $b=b_{0}$ and at the matched scale that aligns the wavelet’s central frequency with the oscillation, i.e., choose the scale $a$ so that the scaled wavelet’s central angular frequency equals $2\\pi f$. Under these conditions, derive from first principles an analytic criterion to choose $\\omega_{0}$ that maximizes detectability in the squared modulus of the CWT coefficient, $|W_{x}(a,b)|^{2}$, and provide the optimal $\\omega_{0}$ as a single closed-form expression in terms of $f$ and $T$. Express the final answer as a dimensionless number multiplying $fT$, and round the numerical coefficient to four significant figures. State clearly any intermediate definitions you use, and justify your choice analytically using the wavelet response implied by the CWT definition and the CMW form.",
            "solution": "The user wants to find the optimal dimensionless central frequency $\\omega_0$ of a Complex Morlet Wavelet (CMW) that maximizes the detectability of a transient neural oscillation. Detectability is defined as the squared modulus of the Continuous Wavelet Transform (CWT) coefficient, $|W_x(a,b)|^2$.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   Signal model: $x(t) = A \\exp(i\\,2\\pi f\\,t)\\,w(t)$, where $A$ is a constant amplitude, $f$ is the oscillation frequency.\n-   Time window: $w(t) = 1$ for $|t-b_0| \\leq T/2$ and $w(t) = 0$ otherwise. $T$ is the duration, $b_0$ is the center time.\n-   CWT definition: $W_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt$.\n-   Mother wavelet: Complex Morlet Wavelet (CMW), $\\psi(t) = \\pi^{-1/4}\\,\\exp(i\\,\\omega_0\\,t)\\,\\exp(-t^2/2)$, where $\\omega_0$ is the dimensionless central frequency.\n-   Analysis conditions: The CWT is evaluated at time $b=b_0$ and at the matched scale $a$ where the scaled wavelet's central angular frequency equals the signal's angular frequency, $2\\pi f$.\n-   Objective: Derive an analytic criterion for choosing $\\omega_0$ to maximize $|W_x(a,b_0)|^2$ and provide the optimal $\\omega_0$ as an expression of the form $k \\cdot fT$, with $k$ rounded to four significant figures.\n\n**1.2. Validation Using Extracted Givens**\n-   **Scientific Grounding**: The problem is scientifically sound. It employs standard definitions for the CWT, the Complex Morlet Wavelet, and a canonical model of a neural burst. The question addresses a fundamental trade-off in time-frequency analysis, which is a core concept in signal processing and its applications, including neuroscience.\n-   **Well-Posedness**: The problem is well-posed. The objective is to maximize a well-defined mathematical function, $|W_x(a,b_0)|^2$, with respect to a single parameter, $\\omega_0$, under clearly specified constraints. All necessary components are provided to formulate and solve the optimization problem.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective elements.\n\n**1.3. Verdict and Action**\nThe problem is valid. It is a standard, albeit non-trivial, optimization problem in signal processing. The solution process can proceed.\n\n### Step 2: Solution Derivation\n\nThe CWT coefficient of the signal $x(t)$ at a given scale $a$ and time $b$ is:\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt\n$$\nThe signal is non-zero only for $t \\in [b_0 - T/2, b_0 + T/2]$. The complex conjugate of the CMW is:\n$$\n\\psi^{*}(t) = \\pi^{-1/4}\\,\\exp(-i\\,\\omega_0\\,t)\\,\\exp(-t^2/2)\n$$\nWe are instructed to evaluate the CWT at $b=b_0$:\n$$\nW_{x}(a,b_0) = \\frac{1}{\\sqrt{a}}\\int_{b_0-T/2}^{b_0+T/2} A \\exp(i\\,2\\pi f t) \\left[ \\pi^{-1/4}\\,\\exp\\left(-i\\,\\omega_0\\,\\frac{t-b_0}{a}\\right)\\,\\exp\\left(-\\frac{1}{2}\\left(\\frac{t-b_0}{a}\\right)^2\\right) \\right] dt\n$$\nNext, we apply the matched scale condition. The central angular frequency of the scaled wavelet $\\psi((t-b)/a)$ is $\\omega_0/a$. This must match the signal's angular frequency, $2\\pi f$.\n$$\n\\frac{\\omega_0}{a} = 2\\pi f \\implies a = \\frac{\\omega_0}{2\\pi f}\n$$\nSubstituting this condition into the CWT integral:\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}}{\\sqrt{a}}\\int_{b_0-T/2}^{b_0+T/2} \\exp(i\\,2\\pi f t) \\exp\\left(-i\\,(2\\pi f)(t-b_0)\\right)\\exp\\left(-\\frac{(t-b_0)^2}{2a^2}\\right) dt\n$$\nThe oscillatory terms in the integrand simplify:\n$$\n\\exp(i\\,2\\pi f t) \\exp(-i\\,2\\pi f t + i\\,2\\pi fb_0) = \\exp(i\\,2\\pi fb_0)\n$$\nSince $\\exp(i\\,2\\pi fb_0)$ is a constant with respect to the integration variable $t$, it can be moved outside the integral:\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}\\exp(i\\,2\\pi fb_0)}{\\sqrt{a}} \\int_{b_0-T/2}^{b_0+T/2} \\exp\\left(-\\frac{(t-b_0)^2}{2a^2}\\right) dt\n$$\nTo evaluate the remaining integral, we perform a change of variables. Let $u = t - b_0$, so $du = dt$. The integration limits become $u = -T/2$ to $u = T/2$:\n$$\n\\int_{-T/2}^{T/2} \\exp\\left(-\\frac{u^2}{2a^2}\\right) du\n$$\nThis integral is related to the error function, $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z \\exp(-y^2)dy$. Let $y = \\frac{u}{\\sqrt{2}a}$, which implies $du = \\sqrt{2}a\\,dy$. The limits change to $y = \\mp \\frac{T}{2\\sqrt{2}a}$.\n$$\n\\int_{-T/(2\\sqrt{2}a)}^{T/(2\\sqrt{2}a)} \\exp(-y^2) \\sqrt{2}a\\,dy = \\sqrt{2}a \\left[ \\frac{\\sqrt{\\pi}}{2} \\text{erf}(y) \\right]_{-T/(2\\sqrt{2}a)}^{T/(2\\sqrt{2}a)}\n$$\nUsing the property $\\text{erf}(-z) = -\\text{erf}(z)$, this evaluates to:\n$$\n\\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left( \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) - \\text{erf}\\left(-\\frac{T}{2\\sqrt{2}a}\\right) \\right) = \\sqrt{2\\pi}a\\,\\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right)\n$$\nSubstituting this result back into the expression for $W_x(a,b_0)$:\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}\\exp(i\\,2\\pi fb_0)}{\\sqrt{a}} \\left( \\sqrt{2\\pi}a\\,\\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) \\right) = A\\sqrt{2}\\pi^{1/4}\\sqrt{a} \\exp(i\\,2\\pi fb_0) \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right)\n$$\nThe squared modulus $|W_x(a,b_0)|^2$ is what we aim to maximize. The term $\\exp(i\\,2\\pi fb_0)$ has modulus $1$.\n$$\n|W_x(a,b_0)|^2 = |A|^2 (2\\sqrt{\\pi}) a \\left[ \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) \\right]^2\n$$\nTo find the optimal $\\omega_0$, we express this quantity in terms of $\\omega_0$ by substituting $a = \\frac{\\omega_0}{2\\pi f}$:\n$$\n|W_x(a,b_0)|^2 = |A|^2 (2\\sqrt{\\pi}) \\left(\\frac{\\omega_0}{2\\pi f}\\right) \\left[ \\text{erf}\\left(\\frac{T}{2\\sqrt{2}(\\omega_0/2\\pi f)}\\right) \\right]^2 = \\frac{|A|^2}{\\sqrt{\\pi}f} \\omega_0 \\left[ \\text{erf}\\left(\\frac{\\pi f T}{\\sqrt{2}\\omega_0}\\right) \\right]^2\n$$\nTo maximize this expression with respect to $\\omega_0$, we only need to consider the terms that depend on $\\omega_0$. Let $g(\\omega_0)$ be this part:\n$$\ng(\\omega_0) = \\omega_0 \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2, \\quad \\text{where } C = \\frac{\\pi f T}{\\sqrt{2}}\n$$\nWe find the maximum by setting the derivative $g'(\\omega_0)$ to zero. Using the product and chain rules:\n$$\ng'(\\omega_0) = \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2 + \\omega_0 \\cdot 2\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\cdot \\frac{d}{d\\omega_0}\\left[\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\right]\n$$\nThe derivative of the error function is $\\frac{d}{dz}\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\exp(-z^2)$.\n$$\n\\frac{d}{d\\omega_0}\\left[\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\right] = \\frac{2}{\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right) \\cdot \\left(-\\frac{C}{\\omega_0^2}\\right)\n$$\nSubstituting this back into $g'(\\omega_0)$:\n$$\ng'(\\omega_0) = \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2 - \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right)\n$$\nSetting $g'(\\omega_0) = 0$ gives:\n$$\n\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) - \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right) \\right] = 0\n$$\nThis equation has a trivial solution if $\\text{erf}(C/\\omega_0) = 0$, which implies $C=0$ or $\\omega_0 \\to \\infty$. This corresponds to a minimum. The non-trivial solution, which gives the maximum, is found by setting the term in brackets to zero. This provides the analytic criterion:\n$$\n\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) = \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right)\n$$\nLet $z_{opt} = \\frac{C}{\\omega_{0, opt}} = \\frac{\\pi f T}{\\sqrt{2}\\omega_{0, opt}}$, where $\\omega_{0,opt}$ is the optimal value of $\\omega_0$. The criterion for $z_{opt}$ is a transcendental equation:\n$$\n\\text{erf}(z_{opt}) = \\frac{4z_{opt}}{\\sqrt{\\pi}}\\exp(-z_{opt}^2)\n$$\nThis equation must be solved numerically. A numerical root-finding algorithm yields the solution:\n$$\nz_{opt} \\approx 0.98986\n$$\nNow we can solve for the optimal $\\omega_0$:\n$$\n\\omega_{0, opt} = \\frac{\\pi f T}{\\sqrt{2}z_{opt}} = \\left( \\frac{\\pi}{\\sqrt{2}z_{opt}} \\right) fT\n$$\nWe calculate the dimensionless coefficient $k = \\frac{\\pi}{\\sqrt{2}z_{opt}}$:\n$$\nk = \\frac{\\pi}{\\sqrt{2} \\cdot 0.98986} \\approx \\frac{3.14159}{1.41421 \\cdot 0.98986} \\approx \\frac{3.14159}{1.39985} \\approx 2.244249\n$$\nRounding this coefficient to four significant figures as requested gives $k=2.244$.\nThus, the optimal dimensionless central frequency is:\n$$\n\\omega_{0, opt} = 2.244 fT\n$$",
            "answer": "$$\n\\boxed{2.244 fT}\n$$"
        }
    ]
}