{
    "hands_on_practices": [
        {
            "introduction": "The first step in applying the Continuous Wavelet Transform is translating a desired frequency range into a corresponding set of wavelet scales. This exercise guides you through deriving the fundamental relationship between a wavelet's scale $a$ and its associated pseudo-frequency $f$ from first principles. By implementing a constant-quality-factor (constant-$Q$) design, you will practice creating a logarithmically spaced frequency tiling, a standard and powerful approach for analyzing neural signals. ",
            "id": "4198700",
            "problem": "You are given a discrete neural time series $x[n]$ sampled at a sampling frequency $f_s$ (in Hz), with sampling period $\\Delta t$ (in seconds) equal to $\\Delta t = 1 / f_s$. Consider the Continuous Wavelet Transform (CWT), defined for a mother wavelet $\\psi(t)$ by scaled and translated atoms $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t-b}{a}\\right)$ for scale $a > 0$ and translation $b \\in \\mathbb{R}$. For neuroscience data analysis, a commonly used mother wavelet is the Morlet wavelet, which has a well-defined spectral peak. You must start from the fundamental properties of Fourier transforms and wavelet scaling, and use the scaling relations to derive a principled mapping between scale $a$ and a corresponding pseudo-frequency $f$ (in Hz) for the Morlet wavelet. The angular frequency parameter associated with the Morlet wavelet must be treated in radians, and you must explicitly use radians as the angle unit.\n\nDesign a discrete set of scales $\\{a_k\\}_{k=0}^{K-1}$ that covers a target frequency band $[f_{\\min}, f_{\\max}]$ (in Hz) for the pseudo-frequency associated with each scale, where $f_{\\max} \\leq f_s/2$ (Nyquist limit). Use a constant-quality-factor (constant-$Q$) design criterion: the adjacent pseudo-frequencies must form a geometric progression across the band, meaning there exists a constant ratio $r$ such that $f_{k+1} = r \\cdot f_k$ for all valid $k$. You must derive the mapping between $a_k$ and $f_k$ from first principles, without assuming any pre-given wavelet frequency-scale formulas, and then implement it to compute scales from the desired pseudo-frequencies.\n\nYour program must implement the following steps for each test case:\n- Compute $\\Delta t = 1 / f_s$.\n- Construct $K$ pseudo-frequencies $\\{f_k\\}$ that geometrically span $[f_{\\min}, f_{\\max}]$ according to the constant-$Q$ criterion, with $f_0 = f_{\\max}$ and $f_{K-1} = f_{\\min}$ for $K \\geq 2$. For $K = 1$, set $f_0 = f_{\\min} = f_{\\max}$.\n- Using your derived mapping, compute scales $\\{a_k\\}$ that realize those pseudo-frequencies.\n- Recompute pseudo-frequencies $\\{\\hat{f}_k\\}$ from the scales to verify consistency.\n\nFor each test case, compute and return the following quantifiable outputs:\n1. The minimum pseudo-frequency $\\min_k \\hat{f}_k$ (a float, in Hz).\n2. The maximum pseudo-frequency $\\max_k \\hat{f}_k$ (a float, in Hz).\n3. The maximum relative edge error between the target band edges and the realized pseudo-frequencies: $\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$ (a float).\n4. The maximum absolute deviation of the realized consecutive frequency ratios from the target geometric ratio $r$ (a float). For $K=1$, define this deviation to be $0$.\n5. A boolean indicating whether all realized pseudo-frequencies lie within the closed interval $[f_{\\min}, f_{\\max}]$ (inclusive), allowing only numerical roundoff at the level of standard double-precision floating-point arithmetic.\n\nUnits and angle specification:\n- All frequencies $f$, $f_{\\min}$, $f_{\\max}$, $f_s$, $\\hat{f}_k$ are in Hz.\n- Sampling period $\\Delta t$ is in seconds.\n- Angular frequency parameters are in radians, and any angular quantity used must be in radians.\n- No angles in degrees are permitted.\n\nTest suite:\nProvide results for the following parameter sets $\\left(f_s, f_{\\min}, f_{\\max}, K, \\omega_0\\right)$, where $\\omega_0$ is the Morlet wavelet central angular frequency parameter (in radians), used in your derivation and implementation:\n- Case $1$: $\\left(f_s = 1000, f_{\\min} = 4, f_{\\max} = 100, K = 12, \\omega_0 = 6\\right)$.\n- Case $2$: $\\left(f_s = 500, f_{\\min} = 20, f_{\\max} = 240, K = 18, \\omega_0 = 6\\right)$.\n- Case $3$: $\\left(f_s = 250, f_{\\min} = 1, f_{\\max} = 4, K = 10, \\omega_0 = 5\\right)$.\n- Case $4$: $\\left(f_s = 1000, f_{\\min} = 30, f_{\\max} = 30, K = 1, \\omega_0 = 6\\right)$.\n- Case $5$: $\\left(f_s = 2000, f_{\\min} = 800, f_{\\max} = 950, K = 5, \\omega_0 = 7\\right)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the five values in the exact order specified above, producing a nested list. For example, the output should have the form $[\\,[\\text{case1\\_min},\\text{case1\\_max},\\text{case1\\_err},\\text{case1\\_dev},\\text{case1\\_bool}],\\ldots\\,]$.",
            "solution": "We begin from the definition of the Continuous Wavelet Transform (CWT) for a mother wavelet $\\psi(t)$, where scaled atoms are given by $\\psi_{a}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ for scale $a > 0$. The translation parameter is not needed for the scale-frequency mapping derivation. A widely used mother wavelet in neuroscience is the Morlet wavelet, defined in a nondimensional time variable by\n$$\n\\psi(t) = \\pi^{-1/4} \\exp\\left(i\\,\\omega_0\\, t\\right)\\exp\\left(-\\frac{t^2}{2}\\right),\n$$\nwhere $\\omega_0$ is a central angular frequency parameter in radians. The key foundational facts we use are:\n1. The Fourier transform scaling property: If $\\mathcal{F}\\{\\psi(t)\\}(\\omega) = \\hat{\\psi}(\\omega)$, then the Fourier transform of $\\psi_a(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ is $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$.\n2. The Morlet wavelet has a Fourier-domain peak at angular frequency approximately $\\omega = \\omega_0$ for the unscaled wavelet $\\psi(t)$, owing to the complex exponential $\\exp(i\\,\\omega_0 t)$ modulated by a Gaussian envelope.\n\nUsing these, we derive how the spectral peak shifts with scale. For the scaled wavelet $\\psi_a(t)$, the Fourier transform is $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$, so the location of the peak in $\\hat{\\psi}_a(\\omega)$ occurs when $a\\,\\omega \\approx \\omega_0$, i.e.,\n$$\n\\omega \\approx \\frac{\\omega_0}{a}.\n$$\nThis establishes the central angular frequency of the scaled wavelet in continuous time. To relate this to a discrete-time sampled signal $x[n]$ with sampling period $\\Delta t = 1/f_s$ (in seconds), we convert angular frequency to cycles per second (Hz). Angular frequency and ordinary frequency are related by $\\omega = 2\\pi f$ in radians per second. Substituting,\n$$\n2\\pi f \\approx \\frac{\\omega_0}{a}.\n$$\nIn sampled data analysis, the pseudo-frequency in Hz realized by a given scale $a$ must account for the discrete sampling interval $\\Delta t$. Because the nondimensional time used in the mother wavelet corresponds to physical time via $t_{\\text{phys}} = t \\cdot \\Delta t$, the effective frequency in Hz is\n$$\nf(a) \\approx \\frac{\\omega_0}{2\\pi\\, a\\, \\Delta t}.\n$$\nThis is the required scale-to-pseudo-frequency mapping derived from the Fourier scaling property and the definition of angular frequency. It uses radians as the angle unit for $\\omega_0$ and seconds for $\\Delta t$.\n\nWe now design a discrete set of scales $\\{a_k\\}_{k=0}^{K-1}$ to cover a target frequency band $[f_{\\min}, f_{\\max}]$ in Hz under a constant-quality-factor criterion. A constant-$Q$ design asks that adjacent pseudo-frequencies form a geometric progression. Let $K$ be the number of scales. For $K \\geq 2$, define a geometric sequence of target pseudo-frequencies $\\{f_k\\}$ by\n$$\nf_k = f_{\\max}\\, r^k, \\quad k = 0,1,\\ldots,K-1,\n$$\nwith common ratio\n$$\nr = \\left(\\frac{f_{\\min}}{f_{\\max}}\\right)^{\\frac{1}{K-1}}.\n$$\nThis ensures $f_0 = f_{\\max}$ and $f_{K-1} = f_{\\min}$. For $K = 1$, we set $f_0 = f_{\\min} = f_{\\max}$, trivially covering the band. Given the derived mapping between scale $a$ and pseudo-frequency $f$, we invert the mapping to obtain scales from the desired pseudo-frequencies:\n$$\na_k = \\frac{\\omega_0}{2\\pi\\, f_k\\, \\Delta t}.\n$$\nTo verify correctness, we recompute the realized pseudo-frequencies from the scales:\n$$\n\\hat{f}_k = \\frac{\\omega_0}{2\\pi\\, a_k\\, \\Delta t}.\n$$\nBy construction, $\\hat{f}_k$ equals $f_k$ up to floating-point roundoff.\n\nAlgorithmic steps for each test case:\n1. Compute $\\Delta t = 1/f_s$.\n2. If $K \\geq 2$, compute $r = (f_{\\min}/f_{\\max})^{1/(K-1)}$ and the sequence $f_k = f_{\\max} r^k$. If $K = 1$, set $f_0 = f_{\\min} = f_{\\max}$.\n3. Compute scales $a_k = \\omega_0/(2\\pi f_k \\Delta t)$.\n4. Recompute $\\hat{f}_k = \\omega_0/(2\\pi a_k \\Delta t)$.\n5. Compute the outputs:\n   - $\\min_k \\hat{f}_k$ and $\\max_k \\hat{f}_k$ in Hz.\n   - The maximum relative edge error $\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$.\n   - The maximum absolute deviation of consecutive realized ratios $\\hat{r}_k = \\hat{f}_{k+1}/\\hat{f}_k$ from $r$. For $K=1$, this deviation is defined to be $0$.\n   - A boolean indicating whether all $\\hat{f}_k$ lie in $[f_{\\min}, f_{\\max}]$ (inclusive), allowing only numerical roundoff.\n\nScientific realism and constraints:\n- The design ensures $f_{\\max} \\leq f_s/2$ (Nyquist limit) in the provided test suite.\n- The Morlet parameter $\\omega_0$ is specified in radians and kept within typical values used in neuroscience ($\\omega_0$ in the range of $5$ to $7$ is common).\n\nTest suite coverage:\n- Case $1$ is a typical local field potential analysis band with $f_s = 1000$, $[f_{\\min}, f_{\\max}] = [4, 100]$, $K = 12$, $\\omega_0 = 6$.\n- Case $2$ approaches the Nyquist limit with $f_s = 500$, $[20, 240]$, $K = 18$, $\\omega_0 = 6$.\n- Case $3$ focuses on low-frequency bands with $f_s = 250$, $[1, 4]$, $K = 10$, $\\omega_0 = 5$.\n- Case $4$ tests the degenerate single-scale scenario with $f_s = 1000$, $[30, 30]$, $K = 1$, $\\omega_0 = 6$.\n- Case $5$ is a narrow high-frequency band near Nyquist with $f_s = 2000$, $[800, 950]$, $K = 5$, $\\omega_0 = 7$.\n\nThe final program outputs, for each test case, the list $[\\min_k \\hat{f}_k, \\max_k \\hat{f}_k, \\text{edge\\_error}, \\text{ratio\\_deviation}, \\text{coverage\\_boolean}]$, aggregated into a single top-level list and printed as one line.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef design_scales_and_metrics(fs, f_min, f_max, K, w0):\n    \"\"\"\n    Design constant-Q pseudo-frequencies and corresponding scales for a Morlet wavelet,\n    then compute verification metrics.\n\n    Parameters:\n        fs (float): Sampling frequency in Hz.\n        f_min (float): Minimum target pseudo-frequency in Hz.\n        f_max (float): Maximum target pseudo-frequency in Hz.\n        K (int): Number of scales.\n        w0 (float): Morlet central angular frequency parameter in radians.\n\n    Returns:\n        list: [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n    \"\"\"\n    dt = 1.0 / fs\n\n    # Construct geometric sequence of target pseudo-frequencies\n    if K >= 2:\n        r = (f_min / f_max) ** (1.0 / (K - 1))\n        # f_k descending from f_max to f_min\n        f_k = f_max * (r ** np.arange(K))\n    else:\n        # K == 1\n        r = 1.0\n        f_k = np.array([f_min], dtype=float)\n\n    # Compute scales from derived mapping: a_k = w0 / (2*pi*f_k*dt)\n    two_pi = 2.0 * np.pi\n    a_k = w0 / (two_pi * f_k * dt)\n\n    # Recompute pseudo-frequencies from scales to verify: f_hat_k = w0 / (2*pi*a_k*dt)\n    f_hat_k = w0 / (two_pi * a_k * dt)\n\n    # Metrics\n    min_fk = float(np.min(f_hat_k))\n    max_fk = float(np.max(f_hat_k))\n\n    # Edge relative error\n    # Avoid division by zero if f_min == 0 (not present in our test suite)\n    edge_err_min = abs((f_min - min_fk) / f_min) if f_min != 0 else abs(f_min - min_fk)\n    edge_err_max = abs((f_max - max_fk) / f_max) if f_max != 0 else abs(f_max - max_fk)\n    edge_rel_error = float(max(edge_err_min, edge_err_max))\n\n    # Ratio deviation: compare realized consecutive ratios to target r\n    if K >= 2:\n        realized_ratios = f_hat_k[1:] / f_hat_k[:-1]\n        ratio_dev = float(np.max(np.abs(realized_ratios - r)))\n    else:\n        ratio_dev = 0.0\n\n    # Coverage boolean: all realized pseudo-frequencies within [f_min, f_max]\n    # Allow tiny numerical tolerance\n    tol = 1e-12\n    coverage_bool = (min_fk >= f_min - tol) and (max_fk = f_max + tol)\n\n    return [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (fs, f_min, f_max, K, w0)\n    test_cases = [\n        (1000.0, 4.0, 100.0, 12, 6.0),\n        (500.0, 20.0, 240.0, 18, 6.0),\n        (250.0, 1.0, 4.0, 10, 5.0),\n        (1000.0, 30.0, 30.0, 1, 6.0),\n        (2000.0, 800.0, 950.0, 5, 7.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        fs, f_min, f_max, K, w0 = case\n        result = design_scales_and_metrics(fs, f_min, f_max, K, w0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world neural recordings are always finite in duration, which introduces unavoidable boundary effects in wavelet analysis. This practice provides a rigorous framework for understanding and quantifying these effects, often visualized as a \"cone of influence\" on a time-frequency plot. You will derive an analytic expression for the amplitude bias that arises when a wavelet is truncated by the signal's edge, giving you a quantitative tool to assess the reliability of your CWT results. ",
            "id": "4198675",
            "problem": "You are given a finite-duration observation of a one-dimensional signal used in neuroscience data analysis. The goal is to analyze the impact of finite-length signals on the Continuous Wavelet Transform (CWT) near boundaries, derive the effective truncation of the scaled and shifted wavelet, and quantify the amplitude bias as a function of the scale. Use only mathematically rigorous definitions and derivations based on the following fundamental bases.\n\nDefinitions and assumptions:\n- The Continuous Wavelet Transform (CWT) of a signal $x(t)$ with respect to a mother wavelet $\\psi(t)$ is defined by\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt,\n$$\nwhere $a \\in \\mathbb{R}^{+}$ is the scale, $b \\in \\mathbb{R}$ is the translation, and $\\psi^{*}$ denotes the complex conjugate.\n- The observed signal is time-limited to the interval $[0, T]$ seconds, where $T  0$ is the total duration in seconds. The observed CWT is\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{0}^{T} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt.\n$$\n- The mother wavelet is the complex Morlet wavelet,\n$$\n\\psi(t) = \\pi^{-1/4} \\, e^{i \\omega_{0} t} \\, e^{-t^{2}/2},\n$$\nwith central angular frequency $\\omega_{0}  0$. The scaled and shifted wavelet is\n$$\n\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\!\\left(\\frac{t-b}{a}\\right).\n$$\n- The analysis signal is a narrowband oscillation modeled as\n$$\nx(t) = e^{i 2\\pi f_{0} t},\n$$\nwhere $f_{0}$ is the oscillation frequency in Hertz (Hz).\n- All times must be expressed in seconds and all frequencies in Hertz. There are no angles to report.\n\nTasks:\n1. Derive the effective truncation of the scaled and shifted wavelet $\\psi_{a,b}(t)$ near the boundaries caused by the finite observation interval $[0,T]$. Define the energy-inclusion fraction\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\nand express it in closed form using fundamental integrals and well-known special functions.\n2. Starting from the definition of the Continuous Wavelet Transform and the finite observation interval, derive a closed-form expression for the amplitude bias near boundaries defined by\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|},\n$$\nas a function of the scale $a$, translation $b$, duration $T$, oscillation frequency $f_{0}$, and wavelet central angular frequency $\\omega_{0}$.\n3. Implement a program that uses your derived expression to compute $B(a,b;T,f_{0},\\omega_{0})$ for each test case below. For each case, set $f_{0}$ to match the wavelet’s peak response for the given scale, that is $f_{0} = \\omega_{0}/(2\\pi a)$, to isolate boundary-induced effects. The units must be seconds for $T$ and $b$, and Hertz for $f_{0}$.\n4. The final program output must be a single line containing a comma-separated list enclosed in square brackets with the amplitude bias values $B$ for the following test suite. Each result must be a float.\n\nTest Suite (time in seconds, frequency in Hertz):\n- Case 1 (near left boundary, moderate scale): $T = 10.0$, $b = 0.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 2 (exact left boundary, moderate scale): $T = 10.0$, $b = 0.0$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 3 (near left boundary, large scale): $T = 10.0$, $b = 0.5$, $a = 2.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 4 (center of interval): $T = 10.0$, $b = 5.0$, $a = 1.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n- Case 5 (near right boundary, moderate scale): $T = 10.0$, $b = 9.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_{1},r_{2},r_{3},r_{4},r_{5}]$), where each $r_{k}$ is the float value of $B(a,b;T,f_{0},\\omega_{0})$ for the corresponding case.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information for a rigorous derivation. The definitions of the Continuous Wavelet Transform (CWT), the complex Morlet wavelet, and the problem objectives are standard in the field of time-frequency analysis. We may therefore proceed with the solution.\n\nThe analysis is divided into two main tasks: first, deriving the energy-inclusion fraction $\\Gamma(a,b;T)$, and second, deriving the amplitude bias $B(a,b;T,f_{0},\\omega_{0})$.\n\n**Task 1: Derivation of the Energy-Inclusion Fraction $\\Gamma(a,b;T)$**\n\nThe energy-inclusion fraction $\\Gamma(a,b;T)$ is defined as the ratio of the energy of the scaled and shifted wavelet within the observation interval $[0, T]$ to its total energy over $(-\\infty, \\infty)$.\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\nThe mother wavelet is $\\psi(t) = \\pi^{-1/4} e^{i \\omega_{0} t} e^{-t^{2}/2}$. The scaled and shifted wavelet is $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\left(\\frac{t-b}{a}\\right)$.\n\nFirst, we compute the squared magnitude of $\\psi_{a,b}(t)$:\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\left| \\frac{1}{\\sqrt{a}} \\pi^{-1/4} e^{i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\right|^2 = \\frac{1}{a} \\pi^{-1/2} \\left| e^{i \\omega_{0} (t-b)/a} \\right|^2 \\left| e^{-((t-b)/a)^{2}/2} \\right|^2\n$$\nSince $|e^{i\\theta}| = 1$ and the exponential of a real number is its own magnitude, we get:\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\frac{1}{a \\sqrt{\\pi}} e^{-((t-b)/a)^{2}}\n$$\nThe denominator of $\\Gamma(a,b;T)$ is the total energy. We demonstrate that the wavelet has unit energy:\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-((t-b)/a)^{2}} \\, dt\n$$\nLet $u = (t-b)/a$, so $dt = a \\, du$. The integration limits remain $(-\\infty, \\infty)$.\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} (a \\, du) = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\sqrt{\\pi} = 1\n$$\nThis confirms the denominator is $1$.\n\nNext, we compute the numerator, which is the integral over the finite interval $[0, T]$:\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{0}^{T} e^{-((t-b)/a)^{2}} \\, dt\n$$\nUsing the same substitution $u = (t-b)/a$, the integration limits become $u_{lower} = -b/a$ and $u_{upper} = (T-b)/a$.\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du\n$$\nThis integral is expressed in terms of the error function, $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-x^2} \\, dx$. The integral $\\int_{z_1}^{z_2} e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}(\\text{erf}(z_2) - \\text{erf}(z_1))$.\n$$\n\\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) - \\text{erf}\\left(-\\frac{b}{a}\\right) \\right]\n$$\nUsing the property $\\text{erf}(-z) = -\\text{erf}(z)$, we obtain the closed-form expression for the numerator.\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\nThus, the energy-inclusion fraction is:\n$$\n\\Gamma(a,b;T) = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\n\n**Task 2: Derivation of the Amplitude Bias $B(a,b;T,f_{0},\\omega_{0})$**\n\nThe amplitude bias $B$ is the ratio of the magnitude of the CWT for the finite signal, $\\widetilde{W}_{x}(a,b)$, to that of the infinite signal, $W_{x}(a,b)$.\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|}\n$$\nThe signal is $x(t) = e^{i 2\\pi f_{0} t}$ and the wavelet transform is computed using $\\psi_{a,b}^*(t) = \\frac{1}{\\sqrt{a}} \\psi^*\\left(\\frac{t-b}{a}\\right)$. The complex conjugate of the mother wavelet is $\\psi^*(t) = \\pi^{-1/4} e^{-i \\omega_{0} t} e^{-t^{2}/2}$.\nThe CWT for the infinite signal is:\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} e^{i 2\\pi f_{0} t} \\, \\pi^{-1/4} e^{-i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\, dt\n$$\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{i(2\\pi f_0 - \\omega_0/a) t} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nThe problem specifies setting the analysis frequency $f_{0}$ to match the wavelet's peak response at scale $a$, which is $f_{0} = \\omega_{0}/(2\\pi a)$. This condition implies $2\\pi f_0 - \\omega_0/a = 0$, significantly simplifying the integral:\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nThe integral is a standard Gaussian integral. Let $v = (t-b)/(\\sqrt{2}a)$, so $dt=\\sqrt{2}a \\, dv$.\n$$\n\\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-\\infty}^{\\infty} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\sqrt{\\pi}\n$$\nSubstituting this back, we get:\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} (\\sqrt{2}a \\sqrt{\\pi}) = \\sqrt{2a} \\pi^{1/4} e^{i\\omega_0 b/a}\n$$\nThe magnitude is therefore $|W_{x}(a,b)| = \\sqrt{2a} \\pi^{1/4}$.\n\nNow we compute the observed CWT, $\\widetilde{W}_{x}(a,b)$, over the interval $[0, T]$ under the same condition $f_{0} = \\omega_{0}/(2\\pi a)$:\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\nUsing the same substitution $v = (t-b)/(\\sqrt{2}a)$, the limits of integration for $v$ become $v_{lower} = -b/(\\sqrt{2}a)$ and $v_{upper} = (T-b)/(\\sqrt{2}a)$.\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-b/(\\sqrt{2}a)}^{(T-b)/(\\sqrt{2}a)} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) - \\text{erf}\\left(-\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nSubstituting this into the expression for $\\widetilde{W}_{x}(a,b)$:\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\left( \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right] \\right)\n$$\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} e^{i\\omega_0 b/a} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nThe magnitude is found by taking the absolute value. Since $a0$, $T0$, and for the test cases $0 \\le b \\le T$, the arguments to the error function are non-negative, and thus the term in brackets is real and non-negative.\n$$\n\\left| \\widetilde{W}_{x}(a,b) \\right| = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nFinally, we compute the ratio $B$:\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|} = \\frac{\\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]}{\\sqrt{2a} \\pi^{1/4}}\n$$\nThis simplifies to the final expression for the amplitude bias:\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{1}{2}\\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\nNote that under the specified frequency condition, the bias $B$ is independent of $\\omega_0$ and $f_0$. It is purely a function of the geometric relationship between the wavelet's temporal support (determined by scale $a$) and its position $b$ relative to the signal boundaries $[0, T]$.\n\nThe provided code implements this final formula for $B$ to compute the values for the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the amplitude bias of the CWT near signal boundaries\n    for a given set of parameters.\n    \"\"\"\n    # Test Suite (T, b, a, omega_0)\n    # T: signal duration in seconds\n    # b: wavelet translation in seconds\n    # a: wavelet scale (dimensionless)\n    # omega_0: wavelet central angular frequency (rad/s)\n    # f_0 is set to omega_0 / (2*pi*a) as per the problem, which simplifies\n    # the bias formula to be independent of f_0 and omega_0.\n    test_cases = [\n        # Case 1: T=10.0, b=0.5, a=0.5, omega_0=6.0\n        (10.0, 0.5, 0.5, 6.0),\n        # Case 2: T=10.0, b=0.0, a=0.5, omega_0=6.0\n        (10.0, 0.0, 0.5, 6.0),\n        # Case 3: T=10.0, b=0.5, a=2.0, omega_0=6.0\n        (10.0, 0.5, 2.0, 6.0),\n        # Case 4: T=10.0, b=5.0, a=1.0, omega_0=6.0\n        (10.0, 5.0, 1.0, 6.0),\n        # Case 5: T=10.0, b=9.5, a=0.5, omega_0=6.0\n        (10.0, 9.5, 0.5, 6.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, b, a, omega_0 = case\n\n        # The derived closed-form expression for the amplitude bias B is:\n        # B = 0.5 * [ erf((T-b)/(sqrt(2)*a)) + erf(b/(sqrt(2)*a)) ]\n        # This formula is valid under the condition f_0 = omega_0 / (2*pi*a),\n        # which isolates boundary effects from frequency mismatch effects.\n\n        arg1 = (T - b) / (np.sqrt(2.0) * a)\n        arg2 = b / (np.sqrt(2.0) * a)\n\n        bias = 0.5 * (erf(arg1) + erf(arg2))\n        results.append(bias)\n\n    # Format the final output as a single line: [r1,r2,r3,r4,r5]\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the CWT is a powerful tool for deriving higher-order statistics like phase-amplitude coupling (PAC), it is essential to understand its potential pitfalls. This exercise explores how the inherent spectral bandwidth of a wavelet can lead to cross-talk between adjacent scales, which may produce spurious coupling estimates even from random noise. By deriving the expected correlation between wavelet coefficients at nearby scales, you will gain insight into how wavelet parameter choices impact the risk of analysis artifacts. ",
            "id": "4198726",
            "problem": "A common approach to estimating phase-amplitude coupling (PAC) in local field potential time series is to use the continuous wavelet transform (CWT) to extract phase at a low frequency and amplitude at a higher frequency. A potential source of bias arises from cross-talk between adjacent wavelet scales: even in the absence of true coupling, correlated outputs across nearby scales can induce spurious associations. Consider the following setup.\n\nLet the mother wavelet be the analytic Morlet wavelet, defined by\n$$\n\\psi(t) = \\pi^{-1/4}\\,\\exp\\!\\big(i\\,\\omega_{0}\\,t\\big)\\,\\exp\\!\\left(-\\frac{t^{2}}{2}\\right),\n$$\nwhere $\\omega_{0}  0$ is the central (dimensionless) frequency parameter, and neglect the small correction term typically used for strict admissibility. For scale $a0$ and time shift $b \\in \\mathbb{R}$, the scaled and shifted wavelet is\n$$\n\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right),\n$$\nand the continuous wavelet transform of a signal $x(t)$ is\n$$\nW_{x}(a,b) = \\int_{-\\infty}^{\\infty} x(t)\\,\\psi_{a,b}^{*}(t)\\,dt.\n$$\n\nAssume the input $x(t)$ is zero-mean, unit-variance, white Gaussian noise with autocorrelation function\n$$\nR_{x}(\\tau) = \\mathbb{E}[x(t)\\,x(t+\\tau)] = \\delta(\\tau),\n$$\nwhere $\\delta(\\tau)$ is the Dirac delta distribution. Define the expected cross-talk between two scales $a_{1}$ and $a_{2}$ at a common time shift $b$ as the magnitude of the normalized covariance of the corresponding CWT coefficients,\n$$\n\\rho(a_{1},a_{2}) \\equiv \\frac{\\big|\\,\\mathbb{E}\\big[ W_{x}(a_{1},b)\\,W_{x}(a_{2},b)^{*} \\big]\\,\\big|}{\\sqrt{\\mathbb{E}\\big[|W_{x}(a_{1},b)|^{2}\\big]\\,\\mathbb{E}\\big[|W_{x}(a_{2},b)|^{2}\\big]}}.\n$$\n\nIn PAC analysis with logarithmically spaced scales, “adjacent scales” are often separated by a fixed ratio $r1$, i.e., $a_{2} = r\\,a_{1}$. Starting from the definitions above and without invoking any pre-derived shortcut formulas, derive a closed-form analytic expression for the expected cross-talk between adjacent scales,\n$$\n\\rho(r,\\omega_{0}) \\equiv \\rho(a, r a),\n$$\nthat depends only on the scale ratio $r$ and the wavelet parameter $\\omega_{0}$ (and is independent of $a$ and $b$).\n\nExpress your final answer as a single closed-form analytic expression in terms of $r$ and $\\omega_{0}$. No numerical approximation is required, and no units are needed.",
            "solution": "We begin from the definitions of the continuous wavelet transform and the statistical properties of white Gaussian noise. Let $x(t)$ be zero-mean, unit-variance, white Gaussian noise with autocorrelation $R_{x}(\\tau)=\\delta(\\tau)$. The continuous wavelet transform at time shift $b$ and scale $a$ is given by\n$$\nW_{x}(a,b) = \\int_{-\\infty}^{\\infty} x(t)\\,\\psi_{a,b}^{*}(t)\\,dt.\n$$\nFor two scales $a_{1}$ and $a_{2}$ at the same time shift $b$, the covariance of the CWT coefficients is\n$$\n\\mathbb{E}\\big[ W_{x}(a_{1},b)\\,W_{x}(a_{2},b)^{*} \\big]\n= \\mathbb{E}\\left[ \\int x(t)\\,\\psi_{a_{1},b}^{*}(t)\\,dt \\int x(s)^{*}\\,\\psi_{a_{2},b}(s)\\,ds \\right].\n$$\nUsing Fubini’s theorem and the definition of the autocorrelation for white noise, we have\n$$\n\\mathbb{E}\\big[ W_{x}(a_{1},b)\\,W_{x}(a_{2},b)^{*} \\big]\n= \\int \\int \\mathbb{E}\\big[ x(t)\\,x(s)^{*} \\big]\\,\\psi_{a_{1},b}^{*}(t)\\,\\psi_{a_{2},b}(s)\\,dt\\,ds\n= \\int \\psi_{a_{1},b}^{*}(t)\\,\\psi_{a_{2},b}(t)\\,dt.\n$$\nThus, for unit-variance white noise, the covariance equals the inner product\n$$\n\\mathbb{E}\\big[ W_{x}(a_{1},b)\\,W_{x}(a_{2},b)^{*} \\big] = \\langle \\psi_{a_{1},b}, \\psi_{a_{2},b} \\rangle.\n$$\nSimilarly, the variance at a single scale is\n$$\n\\mathbb{E}\\big[ |W_{x}(a,b)|^{2} \\big] = \\int |\\psi_{a,b}(t)|^{2}\\,dt = \\|\\psi_{a,b}\\|_{2}^{2}.\n$$\nBecause the analytic Morlet wavelet $\\psi(t)=\\pi^{-1/4}\\exp(i\\omega_{0} t)\\exp(-t^{2}/2)$ has unit $L^{2}$ norm,\n$$\n\\int_{-\\infty}^{\\infty} |\\psi(t)|^{2}\\,dt = \\pi^{-1/2} \\int_{-\\infty}^{\\infty} \\exp(-t^{2})\\,dt = 1,\n$$\nand the CWT scaling preserves energy,\n$$\n\\|\\psi_{a,b}\\|_{2}^{2} = \\int \\left|\\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t-b}{a}\\right)\\right|^{2} dt\n= \\frac{1}{a}\\int \\left| \\psi\\!\\left(\\frac{t-b}{a}\\right)\\right|^{2} dt\n= \\int |\\psi(u)|^{2}\\,du = 1,\n$$\nit follows that\n$$\n\\mathbb{E}\\big[ |W_{x}(a,b)|^{2} \\big] = 1.\n$$\nTherefore, the normalized expected cross-talk simplifies to the magnitude of the inner product,\n$$\n\\rho(a_{1},a_{2}) = \\left| \\langle \\psi_{a_{1},b}, \\psi_{a_{2},b} \\rangle \\right|.\n$$\nBecause the inner product of two wavelets at the same time shift is invariant to $b$, we can set $b=0$ without loss of generality and write $\\psi_{a}(t) \\equiv \\psi_{a,0}(t) = \\frac{1}{\\sqrt{a}}\\,\\psi\\!\\left(\\frac{t}{a}\\right)$. With the analytic Morlet mother wavelet,\n$$\n\\psi_{a}(t) = \\frac{1}{\\sqrt{a}}\\;\\pi^{-1/4}\\,\\exp\\!\\left(i\\,\\omega_{0}\\,\\frac{t}{a}\\right)\\,\\exp\\!\\left(-\\frac{t^{2}}{2 a^{2}}\\right).\n$$\nCompute the inner product for two scales $a_{1}$ and $a_{2}$:\n$$\n\\langle \\psi_{a_{1}}, \\psi_{a_{2}} \\rangle\n= \\int_{-\\infty}^{\\infty} \\psi_{a_{1}}(t)\\,\\psi_{a_{2}}(t)^{*}\\,dt\n= \\frac{1}{\\sqrt{a_{1} a_{2}}}\\,\\pi^{-1/2}\\int_{-\\infty}^{\\infty}\n\\exp\\!\\left(i\\,\\omega_{0}\\,\\frac{t}{a_{1}}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2 a_{1}^{2}}\\right)\n\\exp\\!\\left(-i\\,\\omega_{0}\\,\\frac{t}{a_{2}}\\right)\\exp\\!\\left(-\\frac{t^{2}}{2 a_{2}^{2}}\\right) dt.\n$$\nCombine exponents:\n$$\n\\langle \\psi_{a_{1}}, \\psi_{a_{2}} \\rangle\n= \\frac{1}{\\sqrt{a_{1} a_{2}}}\\,\\pi^{-1/2}\\int_{-\\infty}^{\\infty}\n\\exp\\!\\left(-\\frac{t^{2}}{2}\\left(\\frac{1}{a_{1}^{2}}+\\frac{1}{a_{2}^{2}}\\right)\n+ i\\,\\omega_{0}\\,t\\left(\\frac{1}{a_{1}}-\\frac{1}{a_{2}}\\right)\\right) dt.\n$$\nDefine\n$$\n\\alpha \\equiv \\frac{1}{2}\\left(\\frac{1}{a_{1}^{2}}+\\frac{1}{a_{2}^{2}}\\right), \\quad\n\\beta \\equiv i\\,\\omega_{0}\\left(\\frac{1}{a_{1}}-\\frac{1}{a_{2}}\\right),\n$$\nso that the integral is of the standard Gaussian form\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-\\alpha t^{2} + \\beta t)\\,dt = \\sqrt{\\frac{\\pi}{\\alpha}}\\,\\exp\\!\\left(\\frac{\\beta^{2}}{4\\alpha}\\right),\n$$\nvalid for $\\Re(\\alpha)0$, which holds here. Therefore,\n$$\n\\langle \\psi_{a_{1}}, \\psi_{a_{2}} \\rangle\n= \\frac{1}{\\sqrt{a_{1} a_{2}}}\\,\\pi^{-1/2}\\,\\sqrt{\\frac{\\pi}{\\alpha}}\\,\\exp\\!\\left(\\frac{\\beta^{2}}{4\\alpha}\\right)\n= \\frac{1}{\\sqrt{a_{1} a_{2}\\,\\alpha}}\\,\\exp\\!\\left(\\frac{\\beta^{2}}{4\\alpha}\\right).\n$$\nCompute $\\alpha$ and $\\beta^{2}/(4\\alpha)$ explicitly:\n$$\n\\alpha = \\frac{a_{1}^{2}+a_{2}^{2}}{2\\,a_{1}^{2}\\,a_{2}^{2}}, \\qquad\n\\frac{1}{\\alpha} = \\frac{2\\,a_{1}^{2}\\,a_{2}^{2}}{a_{1}^{2}+a_{2}^{2}},\n$$\nand with\n$$\n\\beta = i\\,\\omega_{0}\\,\\frac{a_{2}-a_{1}}{a_{1}\\,a_{2}} \\quad \\Rightarrow \\quad \\beta^{2} = -\\,\\omega_{0}^{2}\\,\\frac{(a_{2}-a_{1})^{2}}{a_{1}^{2}\\,a_{2}^{2}},\n$$\nwe obtain\n$$\n\\frac{\\beta^{2}}{4\\alpha}\n= -\\,\\frac{\\omega_{0}^{2}\\,(a_{2}-a_{1})^{2}}{a_{1}^{2}\\,a_{2}^{2}} \\cdot \\frac{1}{4}\\cdot \\frac{2\\,a_{1}^{2}\\,a_{2}^{2}}{a_{1}^{2}+a_{2}^{2}}\n= -\\,\\frac{\\omega_{0}^{2}\\,(a_{2}-a_{1})^{2}}{2\\,(a_{1}^{2}+a_{2}^{2})}.\n$$\nThus,\n$$\n\\langle \\psi_{a_{1}}, \\psi_{a_{2}} \\rangle\n= \\sqrt{\\frac{2\\,a_{1}\\,a_{2}}{a_{1}^{2}+a_{2}^{2}}}\\;\\exp\\!\\left(-\\,\\frac{\\omega_{0}^{2}\\,(a_{2}-a_{1})^{2}}{2\\,(a_{1}^{2}+a_{2}^{2})}\\right).\n$$\nTaking the magnitude (the expression is already real and positive), the normalized expected cross-talk is\n$$\n\\rho(a_{1},a_{2}) = \\left|\\langle \\psi_{a_{1}}, \\psi_{a_{2}} \\rangle\\right|\n= \\sqrt{\\frac{2\\,a_{1}\\,a_{2}}{a_{1}^{2}+a_{2}^{2}}}\\;\\exp\\!\\left(-\\,\\frac{\\omega_{0}^{2}\\,(a_{2}-a_{1})^{2}}{2\\,(a_{1}^{2}+a_{2}^{2})}\\right).\n$$\nFor adjacent logarithmically spaced scales with ratio $r1$, let $a_{2}=r\\,a_{1}\\equiv r\\,a$. Substituting $a_{1}=a$ and $a_{2}=r\\,a$ yields\n$$\n\\frac{2\\,a_{1}\\,a_{2}}{a_{1}^{2}+a_{2}^{2}} = \\frac{2\\,a\\,(r\\,a)}{a^{2}+(r\\,a)^{2}} = \\frac{2\\,r}{1+r^{2}},\n$$\nand\n$$\n\\frac{(a_{2}-a_{1})^{2}}{a_{1}^{2}+a_{2}^{2}} = \\frac{(r\\,a - a)^{2}}{a^{2}+(r\\,a)^{2}} = \\frac{a^{2}\\,(r-1)^{2}}{a^{2}\\,(1+r^{2})} = \\frac{(r-1)^{2}}{1+r^{2}}.\n$$\nTherefore,\n$$\n\\rho(r,\\omega_{0}) \\equiv \\rho(a, r a) = \\sqrt{\\frac{2\\,r}{1+r^{2}}}\\;\\exp\\!\\left(-\\,\\frac{\\omega_{0}^{2}\\,(r-1)^{2}}{2\\,(1+r^{2})}\\right),\n$$\nwhich depends only on the scale ratio $r$ and the wavelet parameter $\\omega_{0}$, and is independent of $a$ and $b$, as required.",
            "answer": "$$\\boxed{\\sqrt{\\frac{2\\,r}{1+r^{2}}}\\,\\exp\\!\\left(-\\,\\frac{\\omega_{0}^{2}\\,(r-1)^{2}}{2\\,(1+r^{2})}\\right)}$$"
        }
    ]
}