{
    "hands_on_practices": [
        {
            "introduction": "The power of Welch's method lies in averaging, which reduces the variance of the power spectrum estimate. The first step is always to decide how to segment your data. This exercise guides you through the fundamental calculation of determining the number of available segments ($K$) based on data length, segment length, and overlap, a key parameter that directly controls the trade-off between the statistical stability and frequency resolution of your final estimate .",
            "id": "4203885",
            "problem": "A neurophysiology laboratory has acquired an extracellular Local Field Potential (LFP) recording from primate motor cortex with a sampling frequency $f_s$ and total duration $T$. The research goal is to estimate the power spectral density of the LFP in the $\\beta$ band using a method that reduces the variance of the raw periodogram. The recording is to be analyzed using Welch’s method, which constructs an estimator by averaging windowed periodograms computed on overlapping segments. Let the total number of samples be $N$, where $N = f_s T$; let the segment length be $L$ samples; and let the overlap be $O$ samples with $0 < O < L$.\n\nDefine a segmentation procedure that places the first segment starting at index $0$, and then places subsequent segments so that the start index advances by $L - O$ samples each time. A segment is retained only if it fully fits within the $N$-sample record. Let $K$ denote the number of retained segments produced by this procedure. Using only these definitions and first principles, compute $K$ for the case $f_s = 1024 \\text{ Hz}$, $T = 100 \\text{ s}$, $L = 8192$ samples, and $O = 4096$ samples. Then, based on the definition of the periodogram and properties of averaging, interpret how $K$ influences the variance of the Welch estimator and the bias–variance trade-off, assuming a fixed window shape is applied to each segment. Provide the numerical value of $K$ as your final answer. No rounding is required for the final answer.",
            "solution": "The problem requires the calculation of the number of segments, $K$, generated by Welch's method under a specific segmentation procedure, and an interpretation of how $K$ relates to the statistical properties of the resulting power spectral density estimator.\n\nFirst, we validate the problem statement.\nThe givens are:\n-   Sampling frequency, $f_s = 1024 \\text{ Hz}$.\n-   Total recording duration, $T = 100 \\text{ s}$.\n-   Segment length, $L = 8192$ samples.\n-   Overlap, $O = 4096$ samples.\n-   The constraint $0 < O < L$ is satisfied, as $0 < 4096 < 8192$.\n-   The segmentation procedure starts the first segment at index $0$ and advances the starting point of subsequent segments by $L-O$ samples. Only segments that fully fit within the total record are retained.\n\nThe problem is scientifically grounded in the principles of digital signal processing, specifically spectral estimation. Welch's method is a standard technique, and the parameters provided are realistic for neurophysiological data analysis. The problem is well-posed, with all necessary information provided to calculate a unique value for $K$. The language is objective and precise. The problem is therefore deemed valid.\n\nWe proceed with the solution.\n\nThe total number of samples in the recording, $N$, is the product of the sampling frequency $f_s$ and the duration $T$:\n$$N = f_s \\times T = 1024 \\frac{\\text{samples}}{\\text{s}} \\times 100 \\text{ s} = 102400 \\text{ samples}$$\n\nThe segmentation procedure places segments of length $L$ starting at specific indices. The step size between the start of consecutive segments is the difference between the segment length and the overlap:\n$$\\text{Step size} = L - O = 8192 - 4096 = 4096 \\text{ samples}$$\n\nLet the start index of the $k$-th segment be denoted by $s_k$, where $k$ is an integer starting from $0$. The first segment starts at $s_0 = 0$. Subsequent start indices are given by the arithmetic progression:\n$$s_k = k \\times (L - O)$$\nfor $k = 0, 1, 2, \\dots$.\n\nA segment of length $L$ starting at index $s_k$ occupies the sample indices from $s_k$ to $s_k + L - 1$. For this segment to be retained, it must fit entirely within the total number of samples, $N$. The indices of the full recording range from $0$ to $N - 1$. Therefore, the highest index of any retained segment must be less than or equal to $N-1$:\n$$s_k + L - 1 \\le N - 1$$\nThis inequality simplifies to:\n$$s_k + L \\le N$$\n\nSubstituting the expression for $s_k$:\n$$k \\times (L - O) + L \\le N$$\n\nWe need to find the maximum integer value of $k$ that satisfies this condition. Let's solve for $k$:\n$$k \\times (L - O) \\le N - L$$\n$$k \\le \\frac{N - L}{L - O}$$\n\nNow, we substitute the given numerical values:\n$$N = 102400$$\n$$L = 8192$$\n$$O = 4096$$\n$$L - O = 4096$$\n\nThe inequality becomes:\n$$k \\le \\frac{102400 - 8192}{8192 - 4096}$$\n$$k \\le \\frac{94208}{4096}$$\n\nPerforming the division:\n$$\\frac{94208}{4096} = 23$$\nSo, the inequality is $k \\le 23$.\n\nSince $k$ must be an integer and starts from $0$, the possible values for $k$ are $0, 1, 2, \\dots, 23$. The maximum value for $k$ is $k_{\\text{max}} = 23$. The total number of segments, $K$, is the count of these possible values, which is $k_{\\text{max}} + 1$.\n$$K = 23 + 1 = 24$$\n\nNext, we interpret the role of $K$ in the context of Welch's method. Welch's method is designed to reduce the variance of the power spectrum estimate. A raw periodogram calculated over a long data record is an asymptotically unbiased estimator of the true power spectral density (PSD), but its variance does not decrease as the record length increases. It is therefore an inconsistent estimator.\n\nTo mitigate this high variance, Welch's method averages the periodograms of $K$ smaller, windowed segments of the data. The Welch PSD estimate, $\\hat{S}_W(f)$, is given by:\n$$\\hat{S}_W(f) = \\frac{1}{K} \\sum_{i=0}^{K-1} \\hat{P}_i(f)$$\nwhere $\\hat{P}_i(f)$ is the modified periodogram of the $i$-th segment.\n\nAssuming the periodograms of the individual segments are approximately independent and identically distributed random variables, the variance of their average is inversely proportional to the number of segments, $K$:\n$$\\text{Var}[\\hat{S}_W(f)] \\approx \\frac{1}{K} \\text{Var}[\\hat{P}_i(f)]$$\nThis relationship shows the primary benefit of the method: by increasing the number of segments $K$, the variance of the final PSD estimate is reduced. A larger $K$ results in a smoother, more statistically reliable spectrum.\n\nHowever, this variance reduction comes at a cost, leading to the classic bias-variance trade-off. For a signal of fixed total length $N$, increasing $K$ generally requires decreasing the segment length $L$. The frequency resolution of the PSD estimate is inversely proportional to the segment length $L$. A shorter segment length $L$ results in a wider main lobe of the window's frequency response, which leads to spectral smearing. This smearing increases the bias of the estimator, as it can obscure sharp spectral features and distort their true power.\n\nTherefore, the choice of segmentation parameters, which determines $K$, involves a compromise:\n-   **Large $K$ (implying small $L$):** This leads to low variance (a smooth estimate) but high bias (poor frequency resolution).\n-   **Small $K$ (implying large $L$):** This leads to high variance (a noisy estimate) but low bias (good frequency resolution).\n\nIn this problem, the parameters $L$ and $O$ are fixed, yielding a specific value of $K = 24$. This value represents a particular point on the bias-variance trade-off curve, chosen by the analyst to balance the need for statistical stability against the need to resolve specific spectral features within the $\\beta$ band.\n\nThe numerical value of $K$ is $24$.",
            "answer": "$$\\boxed{24}$$"
        },
        {
            "introduction": "A common pitfall in spectral analysis is confusing a dense frequency grid with high spectral resolution. This practice addresses the role of zero-padding, a technique that increases the number of points in the Discrete Fourier Transform (DFT) to produce a smoother-looking spectrum. By working through this problem, you will clarify the crucial distinction between interpolating a spectrum for better visualization and improving its intrinsic ability to separate closely-spaced frequencies, a property determined by the window length, not the DFT size .",
            "id": "4203927",
            "problem": "A laboratory is analyzing a Local Field Potential (LFP) signal to estimate its Power Spectral Density (PSD) using Welch’s method. The signal is sampled at sampling frequency $f_s = 1000$ Hz (Hertz). Segments of length $L = 2048$ samples are extracted with $50\\%$ overlap and multiplied by a Hann window of length $L$. For each segment, the Discrete Fourier Transform (DFT) is computed using a Fast Fourier Transform (FFT) of length $P = 16384$ by appending zeros to the $L$-point windowed data (zero-padding). The segment periodograms are averaged to form the Welch estimate.\n\nUsing the foundational facts that (i) a length-$P$ DFT samples the Discrete-Time Fourier Transform (DTFT) of the windowed data on a uniform grid of frequencies $f_k$ with spacing determined by $P$ and $f_s$, and (ii) the expected value of a modified periodogram is a convolution of the true PSD with the window’s spectral energy determined by the window $w[n]$ and segment length $L$, answer the following. Select all correct statements about the effect of zero-padding from $L$ to $P$ on the frequency grid $f_k$ and on the intrinsic resolution of Welch’s estimate.\n\nA. Zero-padding from $L$ to $P$ reduces the expected mainlobe width of the Welch spectral window by a factor of $L/P$, thereby increasing the intrinsic resolution and enabling two closer oscillations to be separated.\n\nB. Zero-padding from $L$ to $P$ changes the discrete frequency grid to $f_k = k\\,f_s/P$ (for integer $k$), thereby interpolating the same expected window-smoothed spectrum more finely across frequency, while the mainlobe width and spectral leakage remain determined by the window $w[n]$ and $L$, not by $P$.\n\nC. Zero-padding from $L$ to $P$ increases the number of independent averages per frequency bin in Welch’s estimator, thereby reducing the estimator’s variance at all frequencies.\n\nD. Zero-padding from $L$ to $P$ can improve peak localization and reduce scalloping loss by placing frequency samples closer to true sinusoidal frequencies, but it does not alter the intrinsic resolution or the variance of the Welch estimate.\n\nE. Zero-padding from $L$ to $P$ introduces artificial high-frequency content because appending zeros creates discontinuities, biasing the PSD estimate upward at high frequencies.\n\nChoose all that apply.",
            "solution": "The problem asks for an evaluation of several statements regarding the effect of zero-padding in Welch's method for Power Spectral Density (PSD) estimation. The core of the problem lies in distinguishing between the frequency grid spacing of the Discrete Fourier Transform (DFT) and the intrinsic spectral resolution of the estimator.\n\nFirst, let us formalize the concepts involved based on the provided information and the principles of digital signal processing.\n\n1.  **Frequency Grid:** The DFT of a sequence of length $P$ provides samples of the spectrum at a set of discrete frequencies. For a signal sampled at a frequency $f_s$, the $P$-point DFT yields frequency components at $f_k = k \\frac{f_s}{P}$, for $k = 0, 1, \\dots, P-1$. The spacing between adjacent frequency samples is $\\Delta f = f_s / P$. In this problem, the windowed data of length $L=2048$ is zero-padded to a length of $P=16384$. Thus, the frequency grid of the resulting periodogram for each segment is determined by $P$, and the spacing is $\\Delta f = f_s / P = 1000 \\, \\text{Hz} / 16384 \\approx 0.061 \\, \\text{Hz}$. Without zero-padding (i.e., if $P=L$), the spacing would have been $\\Delta f' = f_s / L = 1000 \\, \\text{Hz} / 2048 \\approx 0.488 \\, \\text{Hz}$. Zero-padding clearly makes the frequency grid finer. This process is equivalent to interpolating the Discrete-Time Fourier Transform (DTFT) of the original $L$-point windowed segment.\n\n2.  **Intrinsic Resolution (Bias):** The intrinsic resolution of a spectral estimator refers to its ability to distinguish between two closely spaced frequency components. In windowed spectral estimation methods like Welch's, this is determined by the spectral properties of the window function, specifically the width of its mainlobe. The expected value of the periodogram for a single segment is the convolution of the true PSD of the signal with the power spectrum of the window function (scaled by its energy). For a window $w[n]$ of length $L$, the mainlobe width of its transformed spectrum is proportional to $1/L$. A wider mainlobe leads to more \"smearing\" of the true spectrum, hence lower resolution. Zero-padding to length $P > L$ does not change the window $w[n]$ or its length $L$. It only changes the number of points at which we evaluate its Fourier transform. The underlying continuous transform of the length-$L$ window, and thus its mainlobe width and shape, are unaltered. Therefore, the intrinsic resolution and the related spectral leakage characteristics are determined by the window type (Hann) and its length $L=2048$, not by the FFT length $P=16384$.\n\n3.  **Variance:** The variance of the Welch PSD estimate is reduced by averaging the periodograms of multiple, often overlapping, segments. The number of available segments, $K$, depends on the total signal length $N_{total}$, the segment length $L$, and the overlap. With $50\\%$ overlap, the number of segments is approximately $K \\approx 2 N_{total} / L - 1$. This number is a function of $L$ and the overlap, but it is independent of the FFT length $P$ used to compute the periodogram for each segment. Therefore, zero-padding from $L$ to $P$ has no effect on the number of periodograms being averaged and, consequently, does not change the variance of the final Welch estimate.\n\nWith these principles established, we evaluate each option.\n\n**A. Zero-padding from $L$ to $P$ reduces the expected mainlobe width of the Welch spectral window by a factor of $L/P$, thereby increasing the intrinsic resolution and enabling two closer oscillations to be separated.**\n\nThis statement is fundamentally incorrect. The mainlobe width of the Welch spectral window is determined by the window function's length, $L$, not the FFT length, $P$. The intrinsic resolution is proportional to $f_s/L$. Zero-padding does not change $L$. It only provides a more densely sampled representation of the *same* smeared spectrum. It does not narrow the mainlobe, and therefore does not increase the intrinsic resolution.\n**Verdict: Incorrect.**\n\n**B. Zero-padding from $L$ to $P$ changes the discrete frequency grid to $f_k = k\\,f_s/P$ (for integer $k$), thereby interpolating the same expected window-smoothed spectrum more finely across frequency, while the mainlobe width and spectral leakage remain determined by the window $w[n]$ and $L$, not by $P$.**\n\nThis statement is entirely consistent with our analysis. The frequency grid is correctly stated as $f_k = k f_s / P$. Zero-padding is an interpolation method for the DTFT, which means we are sampling the window-smoothed spectrum at more points. Crucially, it correctly states that the properties governed by the window itself—mainlobe width (resolution) and spectral leakage—are determined by the window $w[n]$ and its length $L$, not the FFT length $P$.\n**Verdict: Correct.**\n\n**C. Zero-padding from $L$ to $P$ increases the number of independent averages per frequency bin in Welch’s estimator, thereby reducing the estimator’s variance at all frequencies.**\n\nThis statement is incorrect. The number of segments averaged in Welch's method is determined by the total signal length, the segment length $L$, and the specified overlap ($50\\%$ in this case). The zero-padding length $P$ is used *after* a segment is extracted and windowed. It does not alter how many segments can be formed from the original data. Thus, the number of averages remains the same, and the variance reduction is unaffected by zero-padding.\n**Verdict: Incorrect.**\n\n**D. Zero-padding from $L$ to $P$ can improve peak localization and reduce scalloping loss by placing frequency samples closer to true sinusoidal frequencies, but it does not alter the intrinsic resolution or the variance of the Welch estimate.**\n\nThis statement accurately describes the practical benefits and limitations of zero-padding. Scalloping loss occurs when a signal's true frequency lies between the discrete frequency bins of the DFT, resulting in an underestimation of its peak power. By creating a finer frequency grid, zero-padding increases the probability that a DFT bin will fall on or very near the actual peak of a spectral feature, thus improving the accuracy of peak amplitude and frequency localization. The statement correctly concludes that this improvement in sampling does not change the fundamental intrinsic resolution (determined by $L$) or the estimator's variance (determined by the number of segments).\n**Verdict: Correct.**\n\n**E. Zero-padding from $L$ to $P$ introduces artificial high-frequency content because appending zeros creates discontinuities, biasing the PSD estimate upward at high frequencies.**\n\nThis statement is incorrect. The signal segment of length $L$ is first multiplied by a Hann window of the same length. A Hann window's values taper smoothly to zero at its endpoints. Appending zeros to this windowed signal does not create a sharp discontinuity. The transition from the end of the windowed data to the zero-padding is smooth. Therefore, this operation does not introduce significant high-frequency artifacts or bias. Zero-padding is a mathematically well-defined procedure for DFT interpolation.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "Theory comes to life when we can see its effects in action. This hands-on numerical experiment demonstrates one of the most important practical benefits of Welch's method: the suppression of spectral leakage. You will create a synthetic signal with a strong low-frequency drift and observe how its energy \"leaks\" into and contaminates higher-frequency bands when using a simple periodogram, and then quantify how effectively Welch's method with a Hann window mitigates this critical issue .",
            "id": "4203915",
            "problem": "You are analyzing how low-frequency drift in neural recordings biases spectral estimates at higher frequencies when using different power spectral density estimators. Starting from first principles, recall that finite-length observation multiplies a discrete-time signal by a deterministic window function, and that time-domain multiplication corresponds to frequency-domain convolution. Therefore, any single-tone component at frequency $f_{0}$ is convolved with the window’s spectral response, leaking energy away from $f_{0}$ into other frequencies. A rectangular window has relatively high and slowly decaying sidelobes, while a Hann window suppresses far-out sidelobes more strongly. Welch’s method additionally averages across segments to reduce estimator variance.\n\nYou will design a reproducible numerical experiment to isolate and quantify the contamination of a target band at higher frequency by a single low-frequency sinusoidal drift, comparing a whole-record rectangular-window periodogram against Welch’s method with a Hann window.\n\nUse the following fundamental base in your reasoning and implementation: the convolution theorem, the definition of a discrete-time Fourier transform, and the fact that the spectral estimate of a time-windowed signal equals the true spectrum convolved with the window’s spectral response. Do not assume any closed-form leakage formulas; instead, compute the estimates numerically and integrate power over bands.\n\nConstruct a deterministic synthetic signal composed only of a low-frequency drift,\n$$\nx[n] = A_d \\sin(2\\pi f_d n / f_s), \\quad n=0,1,\\dots,N-1,\n$$\nwith sampling frequency $f_s$, drift frequency $f_d$, and drift amplitude $A_d$. There is no high-frequency oscillation in the synthesized signal; any power measured in a distant target band arises from spectral leakage of the drift.\n\nFor each test case below, compute two power spectral density estimates:\n- A whole-record rectangular-window periodogram (equivalent to a single segment with a boxcar window).\n- Welch’s method using a Hann window with $50\\%$ overlap and mean averaging.\n\nDefine the contamination metric at a target frequency $f_t$ as the band-integrated power around $f_t$ over a symmetric bandwidth $B$:\n$$\nP_{\\mathrm{band}} = \\sum_{k: |f[k]-f_t| \\le B/2} S_{xx}[k] \\,\\Delta f,\n$$\nwhere $S_{xx}[k]$ is the one-sided power spectral density sample at frequency $f[k]$, and $\\Delta f$ is the frequency-bin width of the corresponding estimator. Compute this contamination metric for both estimators. Also compute the improvement, defined as the decibel ratio\n$$\n\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{P_{\\text{rect}}}{P_{\\text{welch}}}\\right).\n$$\n\nImplementation requirements:\n- Use amplitude $A_d = 1$ (dimensionless).\n- Use a symmetric target-band half-width of $B/2 = 0.5\\,\\mathrm{Hz}$, i.e., total bandwidth $B = 1\\,\\mathrm{Hz}$, centered at $f_t$.\n- Use no detrending and no zero-padding beyond what is implicit in the estimators’ definitions (set the discrete Fourier transform size equal to the segment length in each method).\n- Express the two contamination outputs as dimensionless power values (the synthetic amplitude is dimensionless, so the power is also dimensionless); express the improvement as a dimensionless decibel value computed from the power ratio. Do not append units to any printed numbers.\n\nTest suite:\nFor each tuple $(f_s, N, f_d, f_t, L)$, where $L$ is the Welch segment length (samples), synthesize $x[n]$ as above and compute:\n- $P_{\\mathrm{rect}}$: contamination using the whole-record rectangular-window periodogram with segment length $N$.\n- $P_{\\mathrm{welch}}$: contamination using Welch’s method with a Hann window, segment length $L$, and $50\\%$ overlap.\n- $\\Delta_{\\mathrm{dB}}$: the decibel improvement defined above.\n\nProvide results for the following three cases:\n- Case $1$: $(1000, 9500, 0.23, 40, 1000)$.\n- Case $2$: $(1000, 9500, 0.01, 40, 1000)$.\n- Case $3$: $(1000, 9500, 0.23, 40, 250)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain nine floating-point numbers in the following order:\n$$\n[P_{\\mathrm{rect}}^{(1)}, P_{\\mathrm{welch}}^{(1)}, \\Delta_{\\mathrm{dB}}^{(1)}, P_{\\mathrm{rect}}^{(2)}, P_{\\mathrm{welch}}^{(2)}, \\Delta_{\\mathrm{dB}}^{(2)}, P_{\\mathrm{rect}}^{(3)}, P_{\\mathrm{welch}}^{(3)}, \\Delta_{\\mathrm{dB}}^{(3)}].\n$$",
            "solution": "The problem requires a numerical experiment to quantify and compare spectral leakage from a low-frequency drift artifact into a higher-frequency band for two different power spectral density (PSD) estimators: a whole-record periodogram and Welch's method. The analysis is founded on fundamental principles of digital signal processing.\n\nThe core principle is the convolution theorem for the Fourier transform. When we analyze a finite-length segment of a discrete-time signal $x[n]$, we are implicitly multiplying an infinitely long signal by a window function $w[n]$ that is non-zero only for the duration of observation. This time-domain multiplication corresponds to a circular convolution in the frequency domain:\n$$\n\\text{DFT}\\{x[n] \\cdot w[n]\\} = X[k] * W[k]\n$$\nwhere $X[k]$ and $W[k]$ are the Discrete Fourier Transforms (DFTs) of the signal and the window, respectively, and $*$ denotes circular convolution. The estimated spectrum is therefore the true signal spectrum, $X[k]$, convolved with (or \"smeared by\") the window's spectral response, $W[k]$. This smearing effect is known as spectral leakage.\n\nThe signal under consideration is a pure low-frequency sinusoid:\n$$\nx[n] = A_d \\sin(2\\pi f_d n / f_s)\n$$\nwith amplitude $A_d=1$. The true spectrum of this signal consists of two delta functions at frequencies $\\pm f_d$. However, due to windowing, the estimated spectrum will show a peak at $f_d$ with a shape dictated by the window's spectral response, $W[k]$. This response consists of a main lobe centered at the signal frequency and a series of sidelobes that decay with distance from the main lobe. It is the energy in these sidelobes that leaks into and contaminates other frequency bands.\n\nThe two estimators are chosen to highlight the effect of window shape and segment averaging on leakage:\n\n1.  **Whole-Record Rectangular-Window Periodogram:** This estimator uses a single segment equal to the entire signal length, $N$. The window is rectangular (or `boxcar`), which is equivalent to taking the signal as is. The spectral response of a rectangular window has a narrow main lobe but high sidelobes that decay slowly (proportional to $1/f$). This results in significant long-range spectral leakage. The PSD is computed using `scipy.signal.periodogram` with `window='boxcar'` and an FFT length `nfft` equal to the signal length $N$. The frequency resolution is $\\Delta f_{\\mathrm{rect}} = f_s / N$.\n\n2.  **Welch's Method with a Hann Window:** This method mitigates leakage and reduces estimator variance. It works by:\n    a. Dividing the signal into shorter, overlapping segments of length $L$. The problem specifies $50\\%$ overlap.\n    b. Applying a Hann window to each segment. The Hann window's spectral response has a wider main lobe than a rectangular window of the same length, but its sidelobes decay much faster (proportional to $1/f^3$). This property is crucial for suppressing leakage into distant frequency bands.\n    c. Computing the periodogram for each windowed segment.\n    d. Averaging the periodograms to obtain the final PSD estimate. This averaging reduces the variance of the estimate.\n    The PSD is computed using `scipy.signal.welch` with `window='hann'`, `nperseg=L`, `noverlap=L/2`, and `nfft=L`. The frequency resolution is determined by the segment length, $\\Delta f_{\\mathrm{welch}} = f_s / L$.\n\nThe contamination is quantified by integrating the estimated one-sided PSD, $S_{xx}[k]$, over a target band of width $B=1\\,\\mathrm{Hz}$ centered at $f_t$. Since the synthetic signal contains no energy at $f_t$, any power measured in this band is solely due to leakage. The band-integrated power is calculated as:\n$$\nP_{\\mathrm{band}} = \\sum_{k: |f[k]-f_t| \\le B/2} S_{xx}[k] \\,\\Delta f\n$$\nwhere $\\Delta f$ is the frequency bin width for the respective estimator. This is computed for both the periodogram ($P_{\\mathrm{rect}}$) and Welch's method ($P_{\\mathrm{welch}}$).\n\nFinally, the improvement of Welch's method over the periodogram is expressed in decibels ($\\mathrm{dB}$):\n$$\n\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{P_{\\text{rect}}}{P_{\\text{welch}}}\\right)\n$$\nA larger positive value of $\\Delta_{\\text{dB}}$ indicates greater suppression of leakage by Welch's method.\n\nThe implementation proceeds by first defining a function that encapsulates these steps. For each test case, this function:\n1.  Generates the sinusoidal signal $x[n]$ with the specified parameters $(f_s, N, f_d)$.\n2.  Computes the PSD $S_{xx}^{\\mathrm{rect}}[k]$ and corresponding frequencies $f_{\\mathrm{rect}}[k]$ using `scipy.signal.periodogram` with a `'boxcar'` window of length $N$.\n3.  Computes the PSD $S_{xx}^{\\mathrm{welch}}[k]$ and frequencies $f_{\\mathrm{welch}}[k]$ using `scipy.signal.welch` with a `'hann'` window, segment length $L$, and $50\\%$ overlap.\n4.  For both estimators, identifies the frequency bins falling within the target band $[f_t-0.5, f_t+0.5]$.\n5.  Calculates $P_{\\mathrm{rect}}$ and $P_{\\mathrm{welch}}$ by summing the PSD values in the band and multiplying by the respective frequency resolution ($\\Delta f = f_s/N$ for the periodogram, $\\Delta f = f_s/L$ for Welch).\n6.  Computes the improvement metric $\\Delta_{\\text{dB}}$.\n\nThis process is repeated for all three test cases, and the results are aggregated and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef calculate_contamination(params):\n    \"\"\"\n    Computes spectral contamination for two estimators based on problem parameters.\n\n    Args:\n        params (tuple): A tuple containing (fs, N, fd, ft, L).\n            fs (int): Sampling frequency in Hz.\n            N (int): Total number of samples in the signal.\n            fd (float): Drift frequency in Hz.\n            ft (float): Target frequency in Hz.\n            L (int): Segment length for Welch's method.\n\n    Returns:\n        tuple: A tuple containing (P_rect, P_welch, delta_dB).\n            P_rect (float): Contamination power for the rectangular periodogram.\n            P_welch (float): Contamination power for Welch's method.\n            delta_dB (float): Improvement of Welch over periodogram in dB.\n    \"\"\"\n    fs, N, fd, ft, L = params\n    \n    # Per problem statement, amplitude is 1 (dimensionless) and target band\n    # half-width is 0.5 Hz.\n    A_d = 1.0\n    B_half = 0.5\n\n    # 1. Generate the deterministic synthetic signal\n    # n = 0, 1, ..., N-1\n    n = np.arange(N)\n    x = A_d * np.sin(2 * np.pi * fd * n / fs)\n\n    # 2. Estimator 1: Whole-record rectangular-window periodogram\n    # FFT length is the entire signal length.\n    nfft_rect = N\n    f_rect, Pxx_rect = signal.periodogram(\n        x,\n        fs=fs,\n        window='boxcar',\n        nfft=nfft_rect,\n        detrend=False,\n        return_onesided=True,\n        scaling='density'\n    )\n    delta_f_rect = fs / nfft_rect\n\n    # 3. Estimator 2: Welch's method with Hann window and 50% overlap\n    # FFT length is the segment length.\n    nfft_welch = L\n    noverlap = L // 2\n    f_welch, Pxx_welch = signal.welch(\n        x,\n        fs=fs,\n        window='hann',\n        nperseg=L,\n        noverlap=noverlap,\n        nfft=nfft_welch,\n        detrend=False,\n        return_onesided=True,\n        scaling='density'\n    )\n    delta_f_welch = fs / nfft_welch\n\n    # 4. Calculate contamination metric P_band for both estimators\n    # The target band is symmetric around ft with total width B = 1 Hz.\n    f_min = ft - B_half\n    f_max = ft + B_half\n\n    # Contamination for rectangular periodogram\n    band_indices_rect = np.where((f_rect >= f_min) & (f_rect <= f_max))\n    P_rect = np.sum(Pxx_rect[band_indices_rect]) * delta_f_rect\n    \n    # Contamination for Welch's method\n    band_indices_welch = np.where((f_welch >= f_min) & (f_welch <= f_max))\n    P_welch = np.sum(Pxx_welch[band_indices_welch]) * delta_f_welch\n\n    # 5. Calculate the improvement metric in decibels\n    delta_dB = 10 * np.log10(P_rect / P_welch)\n\n    return P_rect, P_welch, delta_dB\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the final results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (fs, N, fd, ft, L)\n    test_cases = [\n        (1000, 9500, 0.23, 40, 1000),  # Case 1\n        (1000, 9500, 0.01, 40, 1000),  # Case 2\n        (1000, 9500, 0.23, 40, 250),   # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate the three metrics for the current case\n        p_rect, p_welch, delta_db = calculate_contamination(case)\n        results.extend([p_rect, p_welch, delta_db])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}