{
    "hands_on_practices": [
        {
            "introduction": "在时频分析的实践中，第一步是掌握短时傅里叶变换 (STFT) 的基本原理。这个练习将引导你区分离散傅里叶变换 (DFT) 的频率“箱”间距和由窗函数决定的真实频谱分辨率，这是两个经常被混淆的概念。通过计算具体参数并评估分辨两个相近频率峰值的能力，你将为理解时频分辨率权衡奠定坚实的基础。",
            "id": "4200751",
            "problem": "您正在使用短时傅里叶变换 (STFT) 分析一段平稳的脑电图 (EEG) 数据。信号的采样率为 $F_s = 500\\ \\mathrm{Hz}$，您将使用时长为 $L = 1\\ \\mathrm{s}$ 的分析窗。STFT 采用汉恩 (Hann) 窗（也称汉宁窗），连续窗口之间的重叠率为 $50\\%$。考虑一段 10 秒的记录。\n\n从离散时间傅里叶分析和加窗的基本定义出发，并利用窗主瓣宽度的成熟特性，完成以下任务：\n\n- 推导离散傅里叶变换 (DFT) 的频率箱间隔 $\\Delta f$ 作为 $F_s$ 和 $L$ 的函数。\n- 根据指定的重叠规则，计算这段 10 秒记录可以容纳多少个 STFT 段，假设窗口从记录开始处连续放置，且最后一个窗口必须完全位于记录之内。\n- 基于汉恩窗已知的以频率箱为单位的主瓣宽度，严格论证在这些分析参数下分辨位于 $9\\ \\mathrm{Hz}$ 和 $10\\ \\mathrm{Hz}$ 的两个窄带峰的能力。您的论证应围绕窗口主瓣所蕴含的瑞利分辨率以及时频分辨率的权衡展开，明确地将窗口时长 $L$ 与时间分辨率和频谱分辨率联系起来。\n\n提供 $\\Delta f$ 的数值（单位为 Hz）和段数（为整数）。无需四舍五入。在最终答案框中，以不带单位的形式表示您的最终数值答案。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它提出了一个标准的信号处理任务，涉及短时傅里叶变换 (STFT)，并使用了符合神经科学数据分析的实际参数。所有必要信息均已提供，问题有唯一、可推导的答案。\n\n该问题要求对 STFT 在 EEG 数据上的应用进行三部分分析。我们将从基本原理出发，依次处理每个部分。给定的参数是采样频率 $F_s = 500\\ \\mathrm{Hz}$、窗口时长 $L = 1\\ \\mathrm{s}$、总记录时长 $T_{rec} = 10\\ \\mathrm{s}$、汉恩窗以及 $50\\%$ 的重叠率。\n\n首先，我们推导每个 STFT 段内使用的离散傅里叶变换 (DFT) 的频率箱间隔。分析窗的时长为 $L$。给定采样频率 $F_s$，此窗口内的离散样本数 $N$ 为：\n$$N = L \\times F_s$$\n对于给定值，$N = 1\\ \\mathrm{s} \\times 500\\ \\mathrm{Hz} = 500$ 个样本。\n一个包含 $N$ 个样本的序列的 DFT 会产生一个由 $N$ 个复系数表示的频谱，这些系数对应于 $N$ 个等间距的频率箱。一个实值信号的 DFT 所跨越的频率范围从 $0$ Hz 延伸到采样频率 $F_s$。因此，相邻频率箱之间的间隔 $\\Delta f$ 是：\n$$\\Delta f = \\frac{F_s}{N}$$\n代入 $N$ 的表达式，我们得到频率箱间隔和窗口时长之间的普遍关系：\n$$\\Delta f = \\frac{F_s}{L \\times F_s} = \\frac{1}{L}$$\n对于指定的窗口时长 $L = 1\\ \\mathrm{s}$，频率箱间隔为：\n$$\\Delta f = \\frac{1}{1\\ \\mathrm{s}} = 1\\ \\mathrm{Hz}$$\n\n其次，我们计算从 10 秒记录中可以提取多少个 STFT 段。窗口时长为 $L = 1\\ \\mathrm{s}$，重叠率为 $50\\%$。步长 $H$（即连续窗口起始点之间的时间差）是窗口的非重叠部分：\n$$H = L \\times (1 - 0.50) = 0.5 \\times L = 0.5 \\times 1\\ \\mathrm{s} = 0.5\\ \\mathrm{s}$$\n设 $K$ 为段数。第一个窗口从时间 $t_0 = 0$ 开始，覆盖区间 $[0, L]$。第 $k$ 个段（使用从 1 开始的索引）的起始时间是 $t_{k-1} = (k-1)H$。第 $k$ 个段覆盖的时间区间是 $[(k-1)H, (k-1)H + L]$。问题规定，最后一个窗口必须完全位于记录时长 $T_{rec} = 10\\ \\mathrm{s}$ 之内。因此，对于最后一个段，即第 $K$ 段，其结束时间必须小于或等于 $T_{rec}$：\n$$(K-1)H + L \\le T_{rec}$$\n代入数值 $H = 0.5\\ \\mathrm{s}$、$L = 1\\ \\mathrm{s}$ 和 $T_{rec} = 10\\ \\mathrm{s}$：\n$$(K-1) \\times 0.5 + 1 \\le 10$$\n$$(K-1) \\times 0.5 \\le 9$$\n$$K-1 \\le \\frac{9}{0.5}$$\n$$K-1 \\le 18$$\n$$K \\le 19$$\n由于段数 $K$ 必须是整数，所以最大段数是 19。\n\n第三，我们评估分辨位于 $f_1 = 9\\ \\mathrm{Hz}$ 和 $f_2 = 10\\ \\mathrm{Hz}$ 的两个窄带频率分量的能力。这些分量之间的频率间隔是 $\\Delta f_{peaks} = |f_2 - f_1| = 1\\ \\mathrm{Hz}$。分辨两个紧邻频率的能力不是由 DFT 频率箱间隔 $\\Delta f$ 决定的，而是由分析窗的频谱分辨率决定的。频谱分辨率从根本上受限于窗函数傅里叶变换的主瓣宽度。这是时频不确定性原理的直接结果：时间窗越短，频谱窗越宽，意味着频率分辨率越差。\n\n对于时长为 $L$ 的汉恩窗，其傅里叶变换呈现一个主瓣。瑞利分辨率准则指出，如果一个分量频谱峰值的最大值与另一个分量频谱的第一个最小值（零点）重合，则两个频率分量恰好可被分辨。对于经过汉恩窗加权的​​正弦波，其频谱中第一个零点相对于正弦波真实频率的距离为 $\\frac{2}{L}$。因此，汉恩窗的最小可分辨频率间隔 $\\delta f_{res}$ 由下式给出：\n$$\\delta f_{res} = \\frac{2}{L}$$\n使用给定的窗口时长 $L = 1\\ \\mathrm{s}$，频谱分辨率为：\n$$\\delta f_{res} = \\frac{2}{1\\ \\mathrm{s}} = 2\\ \\mathrm{Hz}$$\n为了分辨这两个峰，它们的间隔 $\\Delta f_{peaks}$ 必须大于或至少等于频谱分辨率 $\\delta f_{res}$。在本例中：\n$$\\Delta f_{peaks} = 1\\ \\mathrm{Hz}  \\delta f_{res} = 2\\ \\mathrm{Hz}$$\n由于信号的频率间隔（$1\\ \\mathrm{Hz}$）小于所选窗口能达到的频谱分辨率（$2\\ \\mathrm{Hz}$），因此位于 $9\\ \\mathrm{Hz}$ 和 $10\\ \\mathrm{Hz}$ 的两个分量无法被区分为两个独立的峰。相反，它们加窗后的频谱会显著重叠，并融合成一个更宽的、中心位于 $9\\ \\mathrm{Hz}$ 和 $10\\ \\mathrm{Hz}$ 之间的单峰。\n\n这说明了时频分辨率的权衡。所选的时间分辨率由窗长决定，即 $\\Delta t \\approx L = 1\\ \\mathrm{s}$。这个选择反过来将可能的最佳频谱分辨率限制为 $\\delta f_{res} \\approx \\frac{2}{L} = 2\\ \\mathrm{Hz}$。要分辨 $1\\ \\mathrm{Hz}$ 的间隔，需要将窗口时长 $L$ 增加到至少 $2\\ \\mathrm{s}$（因为 $L = 2/\\delta f_{res} = 2/1 = 2$），但这必然会使时间分辨率降低至 $\\Delta t \\approx 2\\ \\mathrm{s}$。\n\n所需的数值答案是频率箱间隔 $\\Delta f = 1\\ \\mathrm{Hz}$ 和段数 $K = 19$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  19\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在频谱分析中，一个常见的操作是对信号进行零填充（zero-padding）以获得“看起来”更平滑的频谱。这个练习旨在揭示这一操作的真正效果，帮助你辨别其带来的“幻觉”与真实的分辨率提升之间的差异。通过这个思想实验，你将深刻理解频谱分辨率的根本限制在于原始数据的时长，而非傅里叶变换的点数，从而避免在未来的数据分析中做出错误解读。",
            "id": "4200800",
            "problem": "一个系统神经科学实验室分析了一段持续时间为 $T=2\\ \\mathrm{s}$ 的局部场电位 (LFP) 片段，以估计 alpha 和 beta 波段附近的振荡内容。他们首先使用一个相同长度的矩形分析窗对这个 $2\\ \\mathrm{s}$ 的片段进行快速傅里叶变换 (FFT)，然后在保持相同采样率和原始数据样本上相同矩形锥形窗的情况下，将该片段补零至 $8\\ \\mathrm{s}$ 的记录，并重复进行 FFT。实验室负责人强调了时间-频率分辨率的权衡关系，并要求团队从第一性原理出发，推断补零对离散频率采样和谱主瓣宽度的影响。\n\n仅使用离散傅里叶变换 (DFT) 作为在 FFT 持续时间上对复指数的投影的定义，以及时间有限窗与其谱包络之间的傅里叶变换关系，确定补零前后的频率箱间距，并解释补零是否以及为什么会改变谱主瓣的宽度（以赫兹为单位）。\n\n选择一个既正确陈述了数值上的频率箱间距，又给出了正确概念解释的选项。\n\nA. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。补零只增加了同一连续谱的采样密度；谱主瓣由 $2\\ \\mathrm{s}$ 的矩形窗决定，其宽度（零点到零点）保持在约 $2/T \\approx 1\\ \\mathrm{Hz}$，不受补零影响。\n\nB. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。补零会按与频率箱间距成比例的方式减小谱主瓣宽度，使其变窄为原来的 $1/4$。\n\nC. 补零前：$\\Delta f = 2\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.5\\ \\mathrm{Hz}$。补零不会改变谱主瓣，因为它不改变数据内容，只改变 FFT 的点数。\n\nD. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。由于追加零值减少了谱泄漏，补零会加宽谱主瓣。\n\nE. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.5\\ \\mathrm{Hz}$。补零不会改变谱主瓣，因为分析窗的持续时间和类型没有改变，但频率箱间距也没有改变，因为是数据持续时间决定了它。",
            "solution": "问题陈述是数字信号处理中的一个有效练习，具体涉及补零对时间有限信号的离散傅里叶变换 (DFT) 的影响。该场景具有科学依据、问题设定良好且客观。没有矛盾或缺失任何必要信息。\n\n要解决这个问题，我们必须区分两个关键概念：DFT 的频率箱间距和谱分辨率。\n\n1.  **频率箱间距 ($\\Delta f$)**：DFT（通常通过快速傅里叶变换 FFT 实现）作用于总持续时间为 $T_{record}$ 的离散数据记录。如果记录包含以采样频率 $f_s$ 采集的 $N$ 个样本，则 $T_{record} = N/f_s$。DFT 产生 $N$ 个频率分量，范围从 $0\\ \\mathrm{Hz}$ 到（但不包括）$f_s$。相邻频率箱之间的间距由以下公式给出：\n    $$ \\Delta f = \\frac{f_s}{N} = \\frac{1}{T_{record}} $$\n    这意味着频率箱间距完全由输入 FFT 算法的记录的总持续时间决定。\n\n2.  **谱分辨率和主瓣宽度**：谱分辨率指的是区分原始连续信号中两个紧密间隔的频率分量的能力。这从根本上受限于实际非零数据采集的持续时间，如海森堡-伽柏不确定性原理所规定，或者更实际地，受限于窗函数的性质。记录下来的信号实际上是真实的、潜在的信号乘以一个窗函数 $w(t)$。在这个问题中，窗是一个持续时间为 $T = 2\\ \\mathrm{s}$ 的矩形窗。在频域中，这个乘积对应于真实信号的频谱与窗的频谱 $W(f)$ 的卷积。这种卷积会“涂抹”真实的频谱。$W(f)$ 的形状决定了这种涂抹的性质。对于一个持续时间为 $T$ 的矩形窗，其傅里叶变换是一个 sinc 函数，即 $|W(f)| \\propto |\\mathrm{sinc}(\\pi f T)|$。这个函数的主瓣位于其第一对零点之间，这些零点出现在 $f = \\pm 1/T$。因此，主瓣的总宽度，从一个零点到另一个零点测量，是 $2/T$。这个宽度决定了谱分辨率。\n\n让我们将这些原理应用于问题中描述的两种情况。\n\n**情况1：补零前**\nLFP 片段的持续时间为 $T = 2\\ \\mathrm{s}$。FFT 直接在该片段上计算。\n- 用于 FFT 的总记录持续时间为 $T_{record,1} = 2\\ \\mathrm{s}$。\n- 频率箱间距是：\n  $$ \\Delta f_1 = \\frac{1}{T_{record,1}} = \\frac{1}{2\\ \\mathrm{s}} = 0.5\\ \\mathrm{Hz} $$\n- 谱分辨率由窗的持续时间决定，即 $T = 2\\ \\mathrm{s}$。谱主瓣的宽度是：\n  $$ W_{ML} = \\frac{2}{T} = \\frac{2}{2\\ \\mathrm{s}} = 1\\ \\mathrm{Hz} $$\n\n**情况2：补零后**\n将 $2\\ \\mathrm{s}$ 的 LFP 片段用零填充，创建一个新的持续时间为 $8\\ \\mathrm{s}$ 的记录。\n- 用于 FFT 的总记录持续时间现在是 $T_{record,2} = 8\\ \\mathrm{s}$。\n- 频率箱间距是：\n  $$ \\Delta f_2 = \\frac{1}{T_{record,2}} = \\frac{1}{8\\ \\mathrm{s}} = 0.125\\ \\mathrm{Hz} $$\n- **至关重要的是**，谱分辨率仍然由原始非零数据的持续时间决定，即 $T = 2\\ \\mathrm{s}$。补零操作不增加关于信号频率内容的新信息；它只改变了被变换向量的长度。DFT 采样的底层连续谱仍然是 $2\\ \\mathrm{s}$ 数据段的谱。因此，主瓣宽度保持不变：\n  $$ W_{ML} = \\frac{2}{T} = \\frac{2}{2\\ \\mathrm{s}} = 1\\ \\mathrm{Hz} $$\n通过将频率箱间距从 $0.5\\ \\mathrm{Hz}$ 减小到 $0.125\\ \\mathrm{Hz}$，补零提供了对由 $2\\ \\mathrm{s}$ 窗决定的*相同*谱形状的更密集采样或更高清晰度的视图。这等效于频域插值。它并不能提高分辨两个相近频率的能力，该能力仍然受限于 $1\\ \\mathrm{Hz}$ 的主瓣宽度。\n\n现在我们评估给出的选项：\n\n**A. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。补零只增加了同一连续谱的采样密度；谱主瓣由 $2\\ \\mathrm{s}$ 的矩形窗决定，其宽度（零点到零点）保持在约 $2/T \\approx 1\\ \\mathrm{Hz}$，不受补零影响。**\n- 计算出的频率箱间距，补零前 $\\Delta f = 0.5\\ \\mathrm{Hz}$ 和补零后 $\\Delta f = 0.125\\ \\mathrm{Hz}$，都是正确的。\n- 概念解释完全正确。它正确地指出，补零增加了连续谱的采样密度（相当于插值）。它正确地识别出主瓣宽度由 $2\\ \\mathrm{s}$ 窗决定，并正确地计算出其近似宽度为 $2/T = 1\\ \\mathrm{Hz}$。它正确地得出结论，主瓣宽度不受补零影响。\n- **结论：正确。**\n\n**B. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。补零会按与频率箱间距成比例的方式减小谱主瓣宽度，使其变窄为原来的 $1/4$。**\n- 计算出的频率箱间距是正确的。\n- 概念解释不正确。它混淆了频率箱间距与谱分辨率（主瓣宽度）。补零不会减小主瓣宽度。\n- **结论：不正确。**\n\n**C. 补零前：$\\Delta f = 2\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.5\\ \\mathrm{Hz}$。补零不会改变谱主瓣，因为它不改变数据内容，只改变 FFT 的点数。**\n- 计算出的频率箱间距不正确。“补零前”的间距是 $0.5\\ \\mathrm{Hz}$，而不是 $2\\ \\mathrm{Hz}$。“补零后”的间距是 $0.125\\ \\mathrm{Hz}$，而不是 $0.5\\ \\mathrm{Hz}$。\n- 虽然关于主瓣的推理部分正确，但不正确的数值使该选项无效。\n- **结论：不正确。**\n\n**D. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.125\\ \\mathrm{Hz}$。由于追加零值减少了谱泄漏，补零会加宽谱主瓣。**\n- 计算出的频率箱间距是正确的。\n- 概念解释不正确。补零不会加宽谱主瓣，也不会减少谱泄漏。泄漏模式由窗函数固定。\n- **结论：不正确。**\n\n**E. 补零前：$\\Delta f = 0.5\\ \\mathrm{Hz}$；补零后：$\\Delta f = 0.5\\ \\mathrm{Hz}$。补零不会改变谱主瓣，因为分析窗的持续时间和类型没有改变，但频率箱间距也没有改变，因为是数据持续时间决定了它。**\n- “补零后”的频率箱间距不正确。它应该是 $0.125\\ \\mathrm{Hz}$。认为频率箱间距由数据持续时间而不是记录持续时间决定的推理也是不正确的。\n- **结论：不正确。**\n\n只有选项 A 同时提供了正确的数值和基于傅里叶分析第一性原理的正确概念解释。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了基本概念后，我们将理论付诸实践，通过一个完整的仿真来探索时频分辨率权衡对神经信号检测的实际影响。你将构建一个含有短暂伽马振荡（gamma burst）的合成信号，并尝试在噪声背景中将其检测出来。这个练习将直观地展示，如何通过明智地选择分析窗长 $L$ 来匹配信号的持续时间，从而显著提高信噪比和检测成功率，这正是将抽象理论转化为有效数据分析策略的关键一步。",
            "id": "4200811",
            "problem": "要求您实现一个完整的仿真，以分析在受控的信噪比（SNR）和窗口参数下，检测合成神经时间序列中的瞬态伽马波段爆发的时频分辨率权衡。您的程序必须生成一个确定性数据集，使用短时傅里叶变换（STFT）计算频谱表示，量化一个检测指标，并为指定的测试套件报告检测决策。以下规范中的所有数学量均以 LaTeX 表示。\n\n其背景是对模拟局部场电位的离散时间信号中的瞬态振荡进行分析。需要探索的核心原理是时频分析中时间分辨率和频率分辨率之间的权衡。基本基础包括以下广为接受的定义和事实：\n- 一个以赫兹为单位的速率 $f_s$ 采样的实数、有限能量的离散时间信号 $x[n]$，通过 $t_n = n / f_s$ 与连续时间相关联。频率为 $f_0$ 赫兹的正弦分量为 $s(t) = \\sin(2\\pi f_0 t)$。\n- 一个瞬态爆发可以通过时间局部化的包络 $a(t)$ 进行振幅调制来建模，例如高斯包络 $a(t) = \\exp\\!\\left( -\\frac{(t - t_0)^2}{2\\sigma^2} \\right)$，其中 $t_0$ 是以秒为单位的爆发中心时间，$\\sigma$ 是控制持续时间的标准差（以秒为单位）。\n- 短时傅里叶变换（STFT）通过将长度为 $L$ 个样本的窗口 $w[n]$ 应用于重叠的段，并计算局部的离散傅里叶变换来分析 $x[n]$。STFT 的幅值平方产生一个谱图，该谱图近似了作为时间和频率函数的局部功率。\n- 信噪比（SNR）定义为感兴趣信号的均方根（RMS）振幅与加性噪声的均方根（RMS）振幅之比。如果噪声是零均值、标准差为 $1$ 的，那么根据构造，噪声的 RMS 为 $1$。\n- Heisenberg-Gabor 不确定性原理指出，时间分辨率和频率分辨率的乘积有一个下界：对于与加窗时频分析相关的时间展宽 $\\sigma_t$ 和频率展宽 $\\sigma_f$ 的适当定义，有 $\\sigma_t \\sigma_f \\geq \\frac{1}{4\\pi}$。因此，提高时间分辨率（使用更短的窗口）会恶化频率分辨率，反之亦然。\n\n您的仿真必须使用以下确定性生成模型和分析流程：\n1. 构建一个一维离散时间信号 $x[n]$，持续时间 $T = 2.0$ 秒，采样率 $f_s = 1000 \\ \\mathrm{Hz}$，产生 $N = T \\times f_s = 2000$ 个样本。通过 $t_n = n / f_s$ 使用连续时间 $t$ 来构建包络。\n2. 嵌入一个伽马爆发，中心时间为 $t_0 = 1.0 \\ \\mathrm{s}$，载波频率为 $f_0 = 60 \\ \\mathrm{Hz}$，高斯包络为 $a(t) = \\exp\\!\\left( -\\frac{(t - t_0)^2}{2\\sigma^2} \\right)$，其中 $\\sigma$ 根据每个测试用例指定。令单位振幅爆发为 $s_{\\mathrm{unit}}(t) = a(t) \\sin(2\\pi f_0 t)$，其离散时间版本为 $s_{\\mathrm{unit}}[n] = s_{\\mathrm{unit}}(t_n)$。\n3. 加性噪声 $n[n]$ 必须是独立同分布的、均值为零、标准差为 $1$ 的高斯噪声。为了确定性，请使用固定的随机种子，以便每次运行的实现都是可复现的。\n4. 令 $x[n] = A \\cdot s_{\\mathrm{unit}}[n] + n[n]$，其中选择振幅 $A$ 以达到每个测试用例所需的目标 SNR 值：计算 $s_{\\mathrm{unit}}[n]$ 在所有 $n$ 上的 RMS，记为 $\\mathrm{RMS}_{\\mathrm{unit}} = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} s_{\\mathrm{unit}}[n]^2}$，然后设置 $A = \\mathrm{SNR} / \\mathrm{RMS}_{\\mathrm{unit}}$，使得爆发的 RMS 等于噪声的 RMS 乘以 $\\mathrm{SNR}$。\n5. 使用长度为 $L$ 个样本（每个测试用例指定）的汉宁窗 $w[n]$ 计算 $x[n]$ 的 STFT，重叠设置使跳跃长度 $H$ 为 $L$ 的四分之一（向下取整），即 $H = \\left\\lfloor \\frac{L}{4} \\right\\rfloor$，重叠为 $L - H$。不要使用超出信号长度的填充或边界扩展。\n6. 将谱图 $P(f,t)$ 计算为 STFT 的幅值平方。定义伽马波段为 $[f_{\\min}, f_{\\max}] = [50, 70] \\ \\mathrm{Hz}$。定义爆发时间窗口为 $[t_0 - \\Delta_t, t_0 + \\Delta_t]$，其中 $\\Delta_t = 0.1 \\ \\mathrm{s}$。\n7. 根据 $P(f,t)$ 定义以下检测指标：\n   - 爆发与基线的强度比 $R$ 是爆发时间窗口内伽马波段平均功率与爆发时间窗口外伽马波段平均功率的比值。形式上，如果 $\\mathcal{F}_\\gamma = \\{ f \\mid f_{\\min} \\le f \\le f_{\\max} \\}$，$\\mathcal{T}_{\\mathrm{burst}} = \\{ t \\mid t_0 - \\Delta_t \\le t \\le t_0 + \\Delta_t \\}$，且 $\\mathcal{T}_{\\mathrm{base}}$ 是 $\\mathcal{T}_{\\mathrm{burst}}$ 在 STFT 时间网格上的补集，则\n   $$ R = \\frac{\\frac{1}{|\\mathcal{F}_\\gamma||\\mathcal{T}_{\\mathrm{burst}}|} \\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t \\in \\mathcal{T}_{\\mathrm{burst}}} P(f,t)}{\\frac{1}{|\\mathcal{F}_\\gamma||\\mathcal{T}_{\\mathrm{base}}|} \\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t \\in \\mathcal{T}_{\\mathrm{base}}} P(f,t)} \\ . $$\n   - 时间集中度 $C$ 是集中在爆发时间窗口内的总伽马波段功率的比例：\n   $$ C = \\frac{\\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t \\in \\mathcal{T}_{\\mathrm{burst}}} P(f,t)}{\\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t} P(f,t)} \\ . $$\n8. 当且仅当 $R$ 和 $C$ 都超过固定阈值时，宣告检测到爆发。使用 $R_{\\mathrm{th}} = 2.2$ 和 $C_{\\mathrm{th}} = 0.35$。\n\n您的程序必须实现上述流程，并评估以下由元组 $(\\mathrm{SNR}, \\sigma, L)$ 指定的参数值的测试套件：\n- 测试用例 1：$(3.0, 0.05, 64)$\n- 测试用例 2：$(3.0, 0.05, 512)$\n- 测试用例 3：$(1.0, 0.05, 64)$\n- 测试用例 4：$(1.5, 0.15, 256)$\n- 测试用例 5：$(2.0, 0.05, 16)$\n\n所有物理量必须使用指定的单位处理：采样率以 $\\mathrm{Hz}$ 为单位，持续时间以 $\\mathrm{s}$ 为单位，频率以 $\\mathrm{Hz}$ 为单位。正弦函数参数所隐含的角度以弧度为单位。基于谱图的计算是源自功率量的无单位比率。\n\n您的程序应生成单行输出，包含测试套件的检测结果，格式如下：一个用方括号括起来的逗号分隔的布尔值列表，例如 $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}]$。程序必须是确定性的和自包含的，没有任何外部输入或文件。",
            "solution": "该任务是实现一个确定性仿真，以分析在合成神经信号中检测瞬态伽马波段爆发的时频分辨率权衡。此分析通过生成一个具有精确定义爆发的信号，使用短时傅里叶变换（STFT）并以变化的窗口参数计算其谱图，以及应用基于规则的检测准则来执行。问题的核心在于 Heisenberg-Gabor 不确定性原理，该原理规定了提高时间分辨率（通过更短的分析窗口）必然会降低频率分辨率，反之亦然。该仿真旨在探索这种权衡如何影响特定频率和持续时间的爆发的可检测性。\n\n方法流程始于离散时间信号 $x[n]$ 的确定性生成。总信号持续时间为 $T = 2.0 \\ \\mathrm{s}$，采样率为 $f_s = 1000 \\ \\mathrm{Hz}$，产生 $N = T \\times f_s = 2000$ 个样本。构建一个时间向量 $t_n = n / f_s$，其中 $n \\in [0, N-1]$。\n\n一个单独的伽马波段爆发被嵌入到信号中。该爆发是一个频率为 $f_0 = 60 \\ \\mathrm{Hz}$ 的正弦载波，由一个高斯包络 $a(t) = \\exp\\!\\left( -\\frac{(t - t_0)^2}{2\\sigma^2} \\right)$ 进行调制。爆发中心位于 $t_0 = 1.0 \\ \\mathrm{s}$，其持续时间由标准差 $\\sigma$ 控制，该参数在每个测试用例中指定。因此，单位振幅的爆发信号定义为 $s_{\\mathrm{unit}}[n] = \\exp\\!\\left( -\\frac{(t_n - t_0)^2}{2\\sigma^2} \\right) \\sin(2\\pi f_0 t_n)$。\n\n为了控制信噪比（SNR），我们首先计算单位爆发在整个信号持续时间内的均方根（RMS）振幅：$\\mathrm{RMS}_{\\mathrm{unit}} = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} s_{\\mathrm{unit}}[n]^2}$。然后，信号由一个振幅因子 $A = \\mathrm{SNR} / \\mathrm{RMS}_{\\mathrm{unit}}$ 进行缩放，其中 $\\mathrm{SNR}$ 为每个测试用例给定。这确保了缩放后爆发 $A \\cdot s_{\\mathrm{unit}}[n]$ 的 RMS 恰好是噪声 RMS 的 $\\mathrm{SNR}$ 倍。\n\n生成均值为零、标准差为 $1$ 的加性高斯白噪声 $n[n]$。为保证可复现性，每个测试用例的噪声生成过程都使用固定的随机种子。最终信号是线性叠加 $x[n] = A \\cdot s_{\\mathrm{unit}}[n] + n[n]$。\n\n下一步是使用 STFT 进行时频分析。使用长度为 $L$ 个样本的汉宁窗 $w[n]$ 对信号 $x[n]$ 进行分析，其中 $L$ 是特定于测试用例的参数。窗口段重叠，跳跃长度为 $H = \\left\\lfloor \\frac{L}{4} \\right\\rfloor$。谱图 $P(f,t)$ 计算为复数 STFT 系数的幅值平方。这提供了信号功率在时间 $t$ 和频率 $f$ 上分布的表示。\n\n从谱图中导出两个定量指标以检测爆发。这些指标依赖于将谱图划分为感兴趣的区域。频率区域是伽马波段，定义为 $\\mathcal{F}_\\gamma = [50, 70] \\ \\mathrm{Hz}$。爆发的时间区域定义为 $\\mathcal{T}_{\\mathrm{burst}} = [t_0 - \\Delta_t, t_0 + \\Delta_t] = [0.9, 1.1] \\ \\mathrm{s}$，其中 $\\Delta_t = 0.1 \\ \\mathrm{s}$。基线时间区域 $\\mathcal{T}_{\\mathrm{base}}$ 是所有不在 $\\mathcal{T}_{\\mathrm{burst}}$ 内的 STFT 时间点的集合。\n\n第一个指标是爆发与基线的强度比 R。它是伽马波段和爆发时间窗口内的平均功率与基线期间伽马波段内的平均功率之比。\n$$ R = \\frac{\\langle P(f,t) \\rangle_{f \\in \\mathcal{F}_\\gamma, t \\in \\mathcal{T}_{\\mathrm{burst}}}}{\\langle P(f,t) \\rangle_{f \\in \\mathcal{F}_\\gamma, t \\in \\mathcal{T}_{\\mathrm{base}}}} $$\n较高的 R 值表示在爆发预期时间范围内的功率显著高于背景功率水平。\n\n第二个指标是时间集中度 C。它测量伽马波段内的总能量集中在爆发时间窗口内的比例。\n$$ C = \\frac{\\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t \\in \\mathcal{T}_{\\mathrm{burst}}} P(f,t)}{\\sum_{f \\in \\mathcal{F}_\\gamma} \\sum_{t} P(f,t)} $$\n较高的 C 值表明伽马波段活动在时间上是局部的，与瞬态爆发一致。\n\n当且仅当两个指标都超过各自预定义的阈值时，爆发才被宣告“检测到”：$R > R_{\\mathrm{th}} = 2.2$ 且 $C > C_{\\mathrm{th}} = 0.35$。这个双重标准确保了检测对应于一个既相对于基线强大又在时间上集中的事件。对由元组 $(\\mathrm{SNR}, \\sigma, L)$ 指定的每个测试用例执行整个流程，并记录一个布尔检测结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Implements a simulation to analyze the time-frequency resolution trade-off\n    for detecting transient gamma-band bursts in a synthetic neural time series.\n    \"\"\"\n    \n    # Define the test cases from the problem statement as (SNR, sigma, L).\n    test_cases = [\n        (3.0, 0.05, 64),\n        (3.0, 0.05, 512),\n        (1.0, 0.05, 64),\n        (1.5, 0.15, 256),\n        (2.0, 0.05, 16),\n    ]\n\n    results = []\n\n    # Global parameters for the simulation\n    T = 2.0  # seconds\n    f_s = 1000.0  # Hz\n    N = int(T * f_s)\n    t_vec = np.arange(N) / f_s\n    t_0 = 1.0  # seconds\n    f_0 = 60.0  # Hz\n    \n    f_min, f_max = 50.0, 70.0  # Hz (gamma band)\n    delta_t = 0.1  # seconds\n    t_burst_min, t_burst_max = t_0 - delta_t, t_0 + delta_t\n    \n    R_th = 2.2\n    C_th = 0.35\n    \n    for snr, sigma, L in test_cases:\n        # For determinism, reset the random seed for each independent test case.\n        np.random.seed(0)\n\n        # 1.  2. Construct the unit-amplitude gamma burst signal\n        gauss_envelope = np.exp(-((t_vec - t_0)**2) / (2 * sigma**2))\n        s_unit = gauss_envelope * np.sin(2 * np.pi * f_0 * t_vec)\n\n        # 3.  4. Generate noise and construct the final signal x[n]\n        rms_unit = np.sqrt(np.mean(s_unit**2))\n        A = snr / rms_unit if rms_unit > 0 else 0\n        noise = np.random.randn(N) # mu=0, std=1\n        x = A * s_unit + noise\n\n        # 5. Compute the Short-Time Fourier Transform (STFT)\n        hop_size = int(L / 4)\n        n_overlap = L - hop_size\n        \n        # Use scipy.signal.stft\n        # boundary=None and padded=False ensures no data is used beyond signal ends.\n        f, t_stft, Zxx = signal.stft(\n            x,\n            fs=f_s,\n            window='hann',\n            nperseg=L,\n            noverlap=n_overlap,\n            boundary=None,\n            padded=False\n        )\n\n        # 6. Compute Spectrogram and define analysis windows\n        P = np.abs(Zxx)**2\n        \n        # Create boolean masks for indexing the spectrogram\n        f_gamma_mask = (f >= f_min)  (f = f_max)\n        t_burst_mask = (t_stft >= t_burst_min)  (t_stft = t_burst_max)\n        t_base_mask = ~t_burst_mask\n\n        # 7. Define detection metrics R and C\n        \n        # Check if the frequency band of interest exists in the STFT output\n        if not np.any(f_gamma_mask):\n            R = 0.0\n            C = 0.0\n        else:\n            P_gamma = P[f_gamma_mask, :]\n\n            # Calculate mean power in burst and baseline regions\n            if np.any(t_burst_mask):\n                mean_burst_power = np.mean(P_gamma[:, t_burst_mask])\n            else: # Should not happen with given parameters\n                mean_burst_power = 0.0\n\n            if np.any(t_base_mask):\n                mean_base_power = np.mean(P_gamma[:, t_base_mask])\n            else: # Should not happen with given parameters\n                mean_base_power = 0.0\n                \n            # Calculate R, the burst-to-baseline strength ratio\n            if mean_base_power > 1e-12: # Check for non-zero baseline power\n                R = mean_burst_power / mean_base_power\n            else: # If baseline power is zero, ratio is theoretically infinite\n                R = np.inf\n            \n            # Calculate total power in burst and across all time within gamma band\n            total_burst_power = np.sum(P_gamma[:, t_burst_mask])\n            total_gamma_power = np.sum(P_gamma)\n            \n            # Calculate C, the temporal concentration\n            if total_gamma_power > 1e-12:\n                C = total_burst_power / total_gamma_power\n            else:\n                C = 0.0\n\n        # 8. Apply detection thresholds\n        is_detected = (R > R_th) and (C > C_th)\n        results.append(is_detected)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [r for r in results]))}]\")\n\nsolve()\n\n```"
        }
    ]
}