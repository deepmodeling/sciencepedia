{
    "hands_on_practices": [
        {
            "introduction": "在神经科学实验中，严谨的实验设计与数据分析同等重要。本练习将指导您解决一个核心问题：为了以预期的精度估计神经元的放电概率，需要收集多少次试验数据？通过运用中心极限定理来近似计算二项分布比例的置信区间宽度，您将掌握估算样本量这一规划高效实验的关键技能，从而避免研究效力不足或资源浪费。",
            "id": "4159958",
            "problem": "在一个单神经元刺激-反应实验中，每次试验被编码为一个伯努利随机变量 $X_i \\in \\{0,1\\}$，表示在一个固定的刺激后分析窗口内是否至少发生一次动作电位（锋电位）（$X_i=1$ 表示有锋电位，$X_i=0$ 表示没有）。假设各次试验独立同分布，且 $\\Pr(X_i=1)=p$。一次预实验共进行了 $n_0=60$ 次试验，得到 $\\sum_{i=1}^{n_0} X_i=12$，从而得出预估量 $\\hat{p}_0=12/60$。你计划进行一个包含 $n$ 次试验的新实验，通过样本比例 $\\hat{p} = \\frac{1}{n}\\sum_{i=1}^n X_i$ 来估计 $p$。\n\n从 $\\hat{p}$ 的中心极限定理以及基于标准正态分位数 $z_{1-\\alpha/2}$（定义为对于 $Z\\sim \\mathcal{N}(0,1)$，有 $\\Pr(Z \\le z_{1-\\alpha/2})=1-\\alpha/2$）的 $p$ 的双侧 $(1-\\alpha)$ 置信区间（CI）的定义出发，推导出CI宽度关于 $p$ 和 $n$ 的函数的主阶近似。然后，使用预估值作为 $p$ 的预期值（即，代入 $p=\\hat{p}_0$），确定最小的整数 $n$，使得在置信水平 $1-\\alpha=0.95$ 下，近似CI宽度至多为目标宽度 $w=0.10$。\n\n报告满足宽度要求的最小整数 $n$。无需单位。",
            "solution": "用户提供了一个提法明确且具有科学依据的问题陈述，要求计算二项分布比例置信区间所需的样本量。该问题是有效的，我将提供完整的解答。\n\n该问题要求确定新实验的样本量 $n$。每次试验的数据 $X_i$ 是一个参数为 $p$ 的伯努利随机变量，其中 $p$ 是观测到锋电位的概率。各次试验是独立同分布的。$p$ 的估计量是样本比例 $\\hat{p} = \\frac{1}{n}\\sum_{i=1}^n X_i$。\n\n估计量 $\\hat{p}$ 的均值和方差由下式给出：\n$$ E[\\hat{p}] = p $$\n$$ \\text{Var}(\\hat{p}) = \\frac{p(1-p)}{n} $$\n\n根据中心极限定理（CLT），对于足够大的样本量 $n$，$\\hat{p}$ 的抽样分布近似为正态分布。我们可以对 $\\hat{p}$ 进行标准化，以获得一个近似服从标准正态分布 $Z \\sim \\mathcal{N}(0, 1)$ 的变量：\n$$ Z = \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\approx \\mathcal{N}(0, 1) $$\n\n基于此近似，构建 $p$ 的一个双侧 $(1-\\alpha)$ 置信区间（CI）。设 $z_{1-\\alpha/2}$ 是标准正态分布的分位数，使得 $\\Pr(Z \\le z_{1-\\alpha/2}) = 1-\\alpha/2$。该区间由以下概率陈述定义：\n$$ \\Pr\\left(-z_{1-\\alpha/2} \\le \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\n\n为了得到一个关于 $p$ 的可解区间，标准的（瓦尔德型）近似方法用其估计值 $\\hat{p}$ 替换分母（标准误差项）中的未知参数 $p$。这给出了置信区间：\n$$ \\hat{p} \\pm z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n\n该置信区间的宽度，我们记为 $W$，是上界与下界之差：\n$$ W = \\left(\\hat{p} + z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\\right) - \\left(\\hat{p} - z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\\right) = 2 z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} $$\n\n为了计算样本量，我们在实验开始前确定 $n$，因此我们没有 $\\hat{p}$ 的值。问题要求将近似CI宽度表示为真实比例 $p$ 和样本量 $n$ 的函数。该公式成为我们规划的基础：\n$$ W(p, n) = 2 z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}} $$\n\n我们的任务是找到最小的整数 $n$，使得这个预期宽度至多为目标宽度 $w = 0.10$。问题指明我们应该使用预估值 $\\hat{p}_0$ 作为 $p$ 的预期值。预研究提供了：\n$$ n_0 = 60 $$\n$$ \\sum_{i=1}^{n_0} X_i = 12 $$\n$$ \\hat{p}_0 = \\frac{12}{60} = \\frac{1}{5} = 0.2 $$\n\n置信水平被指定为 $1-\\alpha = 0.95$。这意味着 $\\alpha = 0.05$，且 $\\alpha/2 = 0.025$。所需的正态分位数为 $z_{1-0.025} = z_{0.975}$。从标准统计表中， $z_{0.975}$ 的值约为 $1.96$。\n\n我们为样本量 $n$ 建立不等式：\n$$ W(\\hat{p}_0, n) \\le w $$\n$$ 2 z_{0.975} \\sqrt{\\frac{\\hat{p}_0(1-\\hat{p}_0)}{n}} \\le w $$\n\n为了解出 $n$，我们整理不等式：\n$$ \\sqrt{\\frac{\\hat{p}_0(1-\\hat{p}_0)}{n}} \\le \\frac{w}{2 z_{0.975}} $$\n两边都是正数，平方后得到：\n$$ \\frac{\\hat{p}_0(1-\\hat{p}_0)}{n} \\le \\left(\\frac{w}{2 z_{0.975}}\\right)^2 $$\n最后，我们分离出 $n$：\n$$ n \\ge \\hat{p}_0(1-\\hat{p}_0) \\left(\\frac{2 z_{0.975}}{w}\\right)^2 $$\n\n现在，我们代入指定的值：$\\hat{p}_0 = 0.2$，$w = 0.10$，以及 $z_{0.975} \\approx 1.96$。\n$$ n \\ge 0.2(1-0.2) \\left(\\frac{2 \\times 1.96}{0.10}\\right)^2 $$\n$$ n \\ge 0.2(0.8) \\left(\\frac{3.92}{0.10}\\right)^2 $$\n$$ n \\ge 0.16 \\times (39.2)^2 $$\n$$ n \\ge 0.16 \\times 1536.64 $$\n$$ n \\ge 245.8624 $$\n\n由于试验次数 $n$ 必须是整数，我们必须取满足此条件的最小整数值。因此，我们向上取整至下一个整数。\n$$ n = 246 $$\n这是基于预研究数据，在 $95\\%$ 置信水平下，要实现至多 $0.10$ 的置信区间宽度所需的最小样本量。",
            "answer": "$$\n\\boxed{246}\n$$"
        },
        {
            "introduction": "比较不同条件下神经元的反应是神经科学分析中的常见任务。然而，真实世界的数据往往不满足方差相等的理想假设。本练习将引导您处理当比较两个样本均值时方差不相等的情况（即Behrens-Fisher问题），并应用Welch-Satterthwaite近似来校正自由度，这是进行稳健双样本检验的一项关键技术。",
            "id": "4159938",
            "problem": "记录了单个皮层神经元在两种感觉刺激条件（标记为条件 $\\mathrm{A}$ 和条件 $\\mathrm{B}$）下的活动。对于每种条件，都收集了独立的试验数据，并计算了每次试验的放电率（单位：放电次数/秒）。根据经验，试验间的变异性在不同条件下有所不同，因此等方差假设是不合理的。设条件内的样本量为 $n_{\\mathrm{A}} = 40$ 和 $n_{\\mathrm{B}} = 30$，条件内的样本均值为 $\\bar{x}_{\\mathrm{A}} = 22.1$ 和 $\\bar{x}_{\\mathrm{B}} = 18.9$，条件内的无偏样本方差为 $s_{\\mathrm{A}}^{2} = 64.0$ 和 $s_{\\mathrm{B}}^{2} = 36.0$，其中均值的单位为“放电次数/秒”，方差的单位为“（放电次数/秒）的平方”。假设跨试验和条件的抽样是独立的，二阶矩有限，并且根据中心极限定理（CLT），所涉及的估计量适用正态近似。\n\n从样本均值、无偏样本方差的定义以及独立样本的期望和方差的性质出发，在不施加等方差假设的情况下，推导异方差双样本设定（Welch 框架）下均值差 $\\Delta = \\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}}$ 的点估计量、其估计标准误以及置信水平为 $0.95$ 的双侧置信区间。为了确保在异方差性下的正确覆盖率，推导相应学生 t 分位数所使用的自由度的 Satterthwaite 近似。然后，使用所提供的数据，数值计算 Satterthwaite 自由度。\n\n以“放电次数/秒”为单位表示任何置信区间的端点。仅报告 Satterthwaite 自由度作为最终答案，并将其四舍五入到 $4$ 位有效数字。自由度是无量纲的量。",
            "solution": "该问题是有效的，因为它代表了一个标准的、适定的统计估计任务（Behrens-Fisher 问题），该任务基于现实的生物物理数据分析。它提供了所有必要的信息，没有矛盾，并要求基于既定的统计原则进行具体的推导和计算。\n\n目标是在不假设等方差的情况下，推导两种条件之间平均放电率差异 $\\Delta = \\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}}$ 的点估计量、其标准误以及相关的置信区间。这需要使用 Welch-Satterthwaite 近似来计算自由度。\n\n设代表两种条件下放电率的随机变量为 $X_{\\mathrm{A}}$ 和 $X_{\\mathrm{B}}$，其总体均值为 $E[X_{\\mathrm{A}}] = \\mu_{\\mathrm{A}}$ 和 $E[X_{\\mathrm{B}}] = \\mu_{\\mathrm{B}}$，总体方差为 $\\text{Var}(X_{\\mathrm{A}}) = \\sigma_{\\mathrm{A}}^2$ 和 $\\text{Var}(X_{\\mathrm{B}}) = \\sigma_{\\mathrm{B}}^2$。数据由两个大小分别为 $n_{\\mathrm{A}}$ 和 $n_{\\mathrm{B}}$ 的独立样本组成。\n\n**1. 点估计量及其性质**\n\n我们感兴趣的参数是总体均值之差，$\\Delta = \\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}}$。$\\Delta$ 的一个自然点估计量是样本均值之差，$\\hat{\\Delta} = \\bar{X}_{\\mathrm{A}} - \\bar{X}_{\\mathrm{B}}$。\n\n估计量 $\\hat{\\Delta}$ 是无偏的，因为其期望值等于真实参数 $\\Delta$：\n$$ E[\\hat{\\Delta}] = E[\\bar{X}_{\\mathrm{A}} - \\bar{X}_{\\mathrm{B}}] = E[\\bar{X}_{\\mathrm{A}}] - E[\\bar{X}_{\\mathrm{B}}] = \\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}} = \\Delta $$\n\n假设样本独立，此估计量的方差是各个样本均值方差之和：\n$$ \\text{Var}(\\hat{\\Delta}) = \\text{Var}(\\bar{X}_{\\mathrm{A}} - \\bar{X}_{\\mathrm{B}}) = \\text{Var}(\\bar{X}_{\\mathrm{A}}) + \\text{Var}(\\bar{X}_{\\mathrm{B}}) $$\n由于 $\\text{Var}(\\bar{X}) = \\frac{\\sigma^2}{n}$，我们有：\n$$ \\text{Var}(\\hat{\\Delta}) = \\frac{\\sigma_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{\\sigma_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} $$\n\n**2. 估计标准误**\n\n真实的总体方差 $\\sigma_{\\mathrm{A}}^2$ 和 $\\sigma_{\\mathrm{B}}^2$ 是未知的。我们使用无偏样本方差 $s_{\\mathrm{A}}^2$ 和 $s_{\\mathrm{B}}^2$ 来估计它们。$\\hat{\\Delta}$ 的估计方差是：\n$$ \\widehat{\\text{Var}}(\\hat{\\Delta}) = \\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} $$\n该差值的估计标准误是此估计方差的平方根：\n$$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} } $$\n\n**3. 置信区间和 Welch t-统计量**\n\n为构建置信区间，我们使用枢轴量（一种其分布已知的检验统计量）：\n$$ T = \\frac{\\hat{\\Delta} - \\Delta}{\\widehat{SE}(\\hat{\\Delta})} = \\frac{(\\bar{X}_{\\mathrm{A}} - \\bar{X}_{\\mathrm{B}}) - (\\mu_{\\mathrm{A}} - \\mu_{\\mathrm{B}})}{\\sqrt{\\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}}} $$\n在异方差性（方差不等）的假设下，$T$ 的精确分布不是学生 t 分布。Welch-Satterthwaite 近似表明，$T$ 可以用具有有效自由度 $\\nu$ 的学生 t 分布来近似。\n那么，$\\Delta$ 的双侧 $100(1-\\alpha)\\%$ 置信区间由下式给出：\n$$ \\hat{\\Delta} \\pm t_{\\alpha/2, \\nu} \\cdot \\widehat{SE}(\\hat{\\Delta}) $$\n其中 $t_{\\alpha/2, \\nu}$ 是来自具有 $\\nu$ 个自由度的学生 t 分布的临界值，其尾部概率为 $\\alpha/2$。\n\n**4. 自由度 ($\\nu$) 的 Satterthwaite 近似**\n\n$\\nu$ 的 Satterthwaite 近似是通过将分母平方 $\\widehat{\\text{Var}}(\\hat{\\Delta}) = \\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}$ 的前两阶矩与一个缩放的卡方分布的矩相匹配来推导的。样本方差 $s^2$ 的分布与卡方分布有关：$\\frac{(n-1)s^2}{\\sigma^2} \\sim \\chi^2_{n-1}$。这意味着 $\\text{Var}(s^2) = \\frac{2(\\sigma^2)^2}{n-1}$。\n估计方差分量之和的方差是：\n$$ \\text{Var}\\left(\\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}\\right) = \\frac{\\text{Var}(s_{\\mathrm{A}}^2)}{n_{\\mathrm{A}}^2} + \\frac{\\text{Var}(s_{\\mathrm{B}}^2)}{n_{\\mathrm{B}}^2} = \\frac{2(\\sigma_{\\mathrm{A}}^2)^2}{n_{\\mathrm{A}}^2(n_{\\mathrm{A}}-1)} + \\frac{2(\\sigma_{\\mathrm{B}}^2)^2}{n_{\\mathrm{B}}^2(n_{\\mathrm{B}}-1)} $$\n通过匹配矩，可以找到有效自由度 $\\nu$ 为：\n$$ \\nu = \\frac{\\left( \\frac{\\sigma_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{\\sigma_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} \\right)^2}{\\frac{\\left(\\frac{\\sigma_{\\mathrm{A}}^2}{n_{\\mathrm{A}}}\\right)^2}{n_{\\mathrm{A}}-1} + \\frac{\\left(\\frac{\\sigma_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}\\right)^2}{n_{\\mathrm{B}}-1}} $$\n在实践中，未知的总体方差 $\\sigma^2$ 被其样本估计值 $s^2$ 替代：\n$$ \\nu \\approx \\frac{\\left( \\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} \\right)^2}{\\frac{\\left(\\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}}\\right)^2}{n_{\\mathrm{A}}-1} + \\frac{\\left(\\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}\\right)^2}{n_{\\mathrm{B}}-1}} $$\n\n**5. 自由度的数值计算**\n\n我们被给予以下数据：\n- 样本量：$n_{\\mathrm{A}} = 40$, $n_{\\mathrm{B}} = 30$\n- 样本方差：$s_{\\mathrm{A}}^2 = 64.0$, $s_{\\mathrm{B}}^2 = 36.0$\n\n首先，我们计算估计的方差分量：\n$$ \\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} = \\frac{64.0}{40} = 1.6 $$\n$$ \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} = \\frac{36.0}{30} = 1.2 $$\n\n接下来，我们将这些代入 Satterthwaite 公式。\n分子是：\n$$ \\left( \\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}} + \\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}} \\right)^2 = (1.6 + 1.2)^2 = (2.8)^2 = 7.84 $$\n分母是：\n$$ \\frac{\\left(\\frac{s_{\\mathrm{A}}^2}{n_{\\mathrm{A}}}\\right)^2}{n_{\\mathrm{A}}-1} + \\frac{\\left(\\frac{s_{\\mathrm{B}}^2}{n_{\\mathrm{B}}}\\right)^2}{n_{\\mathrm{B}}-1} = \\frac{(1.6)^2}{40-1} + \\frac{(1.2)^2}{30-1} = \\frac{2.56}{39} + \\frac{1.44}{29} $$\n现在，我们计算分母的值：\n$$ \\frac{2.56}{39} + \\frac{1.44}{29} = \\frac{2.56 \\times 29 + 1.44 \\times 39}{39 \\times 29} = \\frac{74.24 + 56.16}{1131} = \\frac{130.4}{1131} $$\n最后，我们计算 $\\nu$：\n$$ \\nu = \\frac{7.84}{\\frac{130.4}{1131}} = \\frac{7.84 \\times 1131}{130.4} = \\frac{8867.04}{130.4} \\approx 67.998773... $$\n将此结果四舍五入到 $4$ 位有效数字，得到 $68.00$。自由度是无量纲的量。",
            "answer": "$$ \\boxed{68.00} $$"
        },
        {
            "introduction": "贝叶斯推断为神经数据分析提供了强大的框架，它能够将先验知识与实验数据相结合。本练习将带您进入贝叶斯世界，通过一个经典的泊松-伽马共轭模型来分析神经元发放计数。您将通过编程实践，系统地检验不同先验假设如何影响后验分布和可信区间，从而亲身体验贝叶斯分析的核心思想——先验信念与数据如何相互作用，共同塑造我们的科学结论。",
            "id": "4159910",
            "problem": "记录了来自单个皮层神经元的脉冲序列，该记录跨越了多个不重叠的时间窗口，并在每个窗口中汇总了脉冲计数。对于索引为 $k$ 的每个窗口，观测到的脉冲计数表示为 $y_k \\in \\{0,1,2,\\dots\\}$，曝光时长表示为 $t_k  0$（单位为秒）。假设各窗口的计数是条件独立的，并使用泊松过程对计数进行建模，该过程在所有窗口上具有恒定的速率参数 $\\lambda$。因此，窗口 $k$ 的似然因子由泊松概率质量函数给出：$p(y_k \\mid \\lambda) = \\exp(-\\lambda t_k) (\\lambda t_k)^{y_k} / y_k!$。假设 $\\lambda$ 服从形状-速率参数化的伽马先验分布，其密度函数为 $p(\\lambda \\mid a,b) = b^{a} \\lambda^{a-1} \\exp(-b \\lambda) / \\Gamma(a)$，其中 $\\lambda  0$，形状参数 $a  0$，速率参数 $b  0$，且 $\\Gamma(\\cdot)$ 表示伽马函数。\n\n从贝叶斯法则以及上述泊松似然和伽马先验的定义出发，推导在给定数据集 $\\{(y_k, t_k)\\}_{k=1}^{K}$ 和超参数 $(a,b)$ 的情况下 $\\lambda$ 的后验分布。使用此后验分布构建一个名义水平为 $1-\\alpha$ 的等尾贝叶斯可信区间（BCI），其中 $\\alpha \\in (0,1)$ 会在每个测试案例中指定。该区间的端点必须使用后验分布的累积分布函数（CDF）的反函数（即分位数函数）来定义。将可信区间宽度定义为上端点减去下端点。宽度必须以“脉冲/秒”为单位表示，并以“脉冲/秒”为单位报告为一个实数。所有可信水平都必须以小数形式表示（例如，对于 $95\\%$ 的可信区间，表示为 $0.95$）。\n\n通过计算以下测试套件中几种 $(a,b)$ 选择下的可信区间宽度，来进行先验敏感性分析。对于每个测试案例，您必须使用指定的数据 $\\{y_k\\}$、曝光时长 $\\{t_k\\}$（单位为秒）、可信水平 $1-\\alpha$ (其中 $\\alpha=0.05$)，以及按顺序排列的超参数对 $(a,b)$ 列表。您的程序必须按照给定的顺序为每个测试案例计算每个 $(a,b)$ 对的宽度，并将所有宽度按该确切顺序汇总到一个扁平列表中。最终输出必须四舍五入到 $6$ 位小数。\n\n测试套件：\n- 测试案例 1（中等计数，相等曝光时长）：计数 $\\{4,3,5,2,6\\}$，曝光时长（秒） $\\{1,1,1,1,1\\}$，可信水平 $1-\\alpha$ (其中 $\\alpha=0.05$)，超参数 $(a,b)$ 顺序为：$(1,1)$, $(10,10)$, $(0.1,0.1)$。\n- 测试案例 2（全零计数，不同曝光时长）：计数 $\\{0,0,0,0\\}$，曝光时长（秒） $\\{2,1,3,4\\}$，可信水平 $1-\\alpha$ (其中 $\\alpha=0.05$)，超参数 $(a,b)$ 顺序为：$(0.5,0.5)$, $(5,5)$, $(0.1,0.1)$。\n- 测试案例 3（高计数，长曝光时长）：计数 $\\{50,55,47,60\\}$，曝光时长（秒） $\\{2,2,2,2\\}$，可信水平 $1-\\alpha$ (其中 $\\alpha=0.01$)，超参数 $(a,b)$ 顺序为：$(1,1)$, $(20,20)$, $(100,1)$。\n- 测试案例 4（稀疏计数，相等曝光时长，先验-数据冲突探索）：计数 $\\{1,0,2,1,1\\}$，曝光时长（秒） $\\{1,1,1,1,1\\}$，可信水平 $1-\\alpha$ (其中 $\\alpha=0.10$)，超参数 $(a,b)$ 顺序为：$(20,1)$, $(1,20)$, $(1,1)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[w_1,w_2,\\dots]$。其中每个 $w_i$ 是针对一个 $(a,b)$ 设置的可信区间宽度（单位为脉冲/秒），其顺序与上述所有测试案例中指定的顺序一致。每个 $w_i$ 都必须是精确到 $6$ 位小数的浮点数。",
            "solution": "问题陈述经评估有效，因为它具有科学依据、问题明确、客观，并为得出唯一解提供了所有必要信息。该模型基于用于脉冲计数的泊松过程和用于速率参数的共轭伽马先验，是计算神经科学中分析此类数据的标准且合适的框架。任务是执行贝叶斯分析以计算可信区间宽度，这是一个定义明确的统计过程。\n\n解的推导过程如下，遵循贝叶斯推断的原则。\n\n首先，我们定义贝叶斯法则的各个组成部分。该法则指出，后验分布与似然和先验分布的乘积成正比：\n$$\np(\\lambda \\mid \\text{data}, a, b) \\propto p(\\text{data} \\mid \\lambda) \\times p(\\lambda \\mid a, b)\n$$\n\n数据由一组脉冲计数和曝光时长组成，即 $\\{(y_k, t_k)\\}_{k=1}^{K}$。\n\n似然函数 $p(\\text{data} \\mid \\lambda)$ 是在给定速率参数 $\\lambda$ 的特定值的情况下，观测到整个数据集的概率。由于假设各窗口的计数是条件独立的，总似然是每个窗口的泊松概率的乘积：\n$$\nL(\\lambda) = p(\\{(y_k, t_k)\\}_{k=1}^{K} \\mid \\lambda) = \\prod_{k=1}^{K} p(y_k \\mid \\lambda) = \\prod_{k=1}^{K} \\frac{\\exp(-\\lambda t_k) (\\lambda t_k)^{y_k}}{y_k!}\n$$\n为了找到 $\\lambda$ 的后验分布，我们可以忽略不依赖于 $\\lambda$ 的项。这使得似然函数正比于：\n$$\nL(\\lambda) \\propto \\prod_{k=1}^{K} \\exp(-\\lambda t_k) \\lambda^{y_k}\n$$\n通过合并指数，我们可以简化此表达式：\n$$\nL(\\lambda) \\propto \\exp\\left(-\\lambda \\sum_{k=1}^{K} t_k\\right) \\lambda^{\\sum_{k=1}^{K} y_k}\n$$\n我们定义总脉冲计数为 $Y = \\sum_{k=1}^{K} y_k$，总曝光时间为 $T = \\sum_{k=1}^{K} t_k$。似然函数简化为：\n$$\nL(\\lambda) \\propto \\lambda^{Y} \\exp(-\\lambda T)\n$$\n\n$\\lambda$ 的先验分布是形状参数为 $a  0$、速率参数为 $b  0$ 的伽马分布：\n$$\np(\\lambda \\mid a, b) = \\frac{b^{a}}{\\Gamma(a)} \\lambda^{a-1} \\exp(-b \\lambda)\n$$\n作为 $\\lambda$ 的函数，先验分布正比于：\n$$\np(\\lambda \\mid a, b) \\propto \\lambda^{a-1} \\exp(-b \\lambda)\n$$\n\n现在，我们通过将（成比例的）似然和先验相乘来应用贝叶斯法则：\n$$\np(\\lambda \\mid \\{(y_k, t_k)\\}, a, b) \\propto \\left( \\lambda^{Y} \\exp(-\\lambda T) \\right) \\times \\left( \\lambda^{a-1} \\exp(-b \\lambda) \\right)\n$$\n合并包含 $\\lambda$ 的项：\n$$\np(\\lambda \\mid \\{(y_k, t_k)\\}, a, b) \\propto \\lambda^{Y + a - 1} \\exp(-\\lambda (T + b))\n$$\n这个结果表达式是伽马分布的核。这证明了伽马分布是泊松似然的共轭先验。因此，$\\lambda$ 的后验分布也是一个伽马分布，其参数已更新。设后验形状参数为 $a'$，后验速率参数为 $b'$：\n$$\na' = a + Y = a + \\sum_{k=1}^{K} y_k\n$$\n$$\nb' = b + T = b + \\sum_{k=1}^{K} t_k\n$$\n因此，后验分布为 $\\lambda \\mid \\text{data}, a, b \\sim \\text{Gamma}(a', b')$。\n\n问题要求构建一个名义水平为 $1-\\alpha$ 的等尾贝叶斯可信区间（BCI）。该区间由后验分布的下分位数和上分位数定义。设 $F_{\\text{post}}^{-1}(q)$ 为后验伽马分布 $\\text{Gamma}(a', b')$ 在给定概率 $q \\in (0,1)$ 下的分位数函数（即累积分布函数 CDF 的反函数）。\n\n可信区间的下端点 $\\lambda_L$ 是这样一个值，其下方的后验概率质量为 $\\alpha/2$：\n$$\n\\lambda_L = F_{\\text{post}}^{-1}(\\alpha/2)\n$$\n上端点 $\\lambda_U$ 是这样一个值，其下方的后验概率质量为 $1 - \\alpha/2$：\n$$\n\\lambda_U = F_{\\text{post}}^{-1}(1 - \\alpha/2)\n$$\n那么 $\\lambda$ 的可信区间就是 $[\\lambda_L, \\lambda_U]$。\n\n该可信区间的宽度 $W$ 是上端点和下端点之差：\n$$\nW = \\lambda_U - \\lambda_L = F_{\\text{post}}^{-1}(1 - \\alpha/2) - F_{\\text{post}}^{-1}(\\alpha/2)\n$$\n$\\lambda$ 的单位，因此也是宽度 $W$ 的单位，是“脉冲/秒”。\n\n每个测试案例的计算步骤如下：\n1.  给定数据 $\\{y_k\\}$ 和 $\\{t_k\\}$，计算充分统计量 $Y = \\sum y_k$ 和 $T = \\sum t_k$。\n2.  对于每对先验超参数 $(a, b)$，计算后验参数 $a' = a + Y$ 和 $b' = b + T$。\n3.  使用形状为 $a'$、速率为 $b'$ 的伽马分布的分位数函数，找到 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数。请注意，许多软件库使用形状参数 $a'$ 和尺度参数 $\\theta = 1/b'$ 来参数化伽马分布。\n4.  计算宽度 $W$，即这些分位数之差。\n5.  存储结果，并对所有超参数对和测试案例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\n\ndef solve():\n    \"\"\"\n    Computes the width of Bayesian credible intervals for a Poisson rate parameter\n    based on spike count data, using a conjugate Gamma prior.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (counts, exposures, alpha, list_of_hyperparameters).\n    test_cases = [\n        # Test case 1\n        (\n            np.array([4, 3, 5, 2, 6]),\n            np.array([1, 1, 1, 1, 1]),\n            0.05,\n            [(1, 1), (10, 10), (0.1, 0.1)]\n        ),\n        # Test case 2\n        (\n            np.array([0, 0, 0, 0]),\n            np.array([2, 1, 3, 4]),\n            0.05,\n            [(0.5, 0.5), (5, 5), (0.1, 0.1)]\n        ),\n        # Test case 3\n        (\n            np.array([50, 55, 47, 60]),\n            np.array([2, 2, 2, 2]),\n            0.01,\n            [(1, 1), (20, 20), (100, 1)]\n        ),\n        # Test case 4\n        (\n            np.array([1, 0, 2, 1, 1]),\n            np.array([1, 1, 1, 1, 1]),\n            0.10,\n            [(20, 1), (1, 20), (1, 1)]\n        ),\n    ]\n\n    results = []\n    \n    # Iterate through each test case\n    for counts, exposures, alpha, hyper_params_list in test_cases:\n        \n        # Calculate sufficient statistics from the data\n        total_counts = np.sum(counts)\n        total_exposure = np.sum(exposures)\n        \n        # Iterate through each set of hyperparameters for the current test case\n        for a_prior, b_prior in hyper_params_list:\n            \n            # Calculate posterior parameters for the Gamma distribution\n            # Posterior shape a' = a_prior + sum(y_k)\n            # Posterior rate b' = b_prior + sum(t_k)\n            a_posterior = a_prior + total_counts\n            b_posterior = b_prior + total_exposure\n            \n            # The scipy.stats.gamma distribution is parameterized by\n            # shape `a` and scale `scale`, where scale = 1 / rate.\n            scale_posterior = 1 / b_posterior\n            \n            # Define the lower and upper quantile levels for the equal-tailed interval\n            lower_quantile_level = alpha / 2.0\n            upper_quantile_level = 1.0 - (alpha / 2.0)\n            \n            # Use the percent point function (ppf), which is the inverse of the CDF,\n            # to find the interval endpoints.\n            lambda_lower = gamma.ppf(\n                lower_quantile_level, a=a_posterior, scale=scale_posterior\n            )\n            lambda_upper = gamma.ppf(\n                upper_quantile_level, a=a_posterior, scale=scale_posterior\n            )\n            \n            # Calculate the width of the credible interval\n            width = lambda_upper - lambda_lower\n            \n            # Round the result to 6 decimal places and append to the list\n            results.append(round(width, 6))\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}