{
    "hands_on_practices": [
        {
            "introduction": "Victor-Purpura (VP) 距离将比较两个脉冲序列的问题转化为一个经典的优化问题，即寻找将一个序列变换为另一个序列的最小“编辑”成本。理解其核心机制的最佳方法是亲手构建成本矩阵。本练习将引导你使用动态规划方法，通过填充分割问题的成本矩阵，不仅能计算出最终距离，还能揭示脉冲间的最佳匹配、插入或删除策略。",
            "id": "4194680",
            "problem": "给定两个以毫秒为单位观测的单神经元脉冲序列 $S_1$ 和 $S_2$，表示为有序事件时间 $S_1 = (0, 10, 20)~\\mathrm{ms}$ 和 $S_2 = (5, 12, 22)~\\mathrm{ms}$。考虑 Victor-Purpura (VP) 脉冲序列距离，它被定义为将一个脉冲序列转换为另一个脉冲序列的一系列允许的编辑操作的最小总代价。其中，插入一个脉冲的代价为 $1$，删除一个脉冲的代价为 $1$，将单个脉冲进行 $\\Delta t$ 的连续时间平移的代价为 $q|\\Delta t|$。这里 $q = 0.1~\\mathrm{ms}^{-1}$。\n\n从这些核心定义以及动态规划通过利用最优子结构和重叠子问题来解决最优序列比对问题的公认原则出发，完成以下任务：\n\n1. 对于两个有限脉冲序列 $S_1 = (t_1,\\dots,t_m)$ 和 $S_2 = (u_1,\\dots,u_n)$，推导一个与上述操作集和代价一致的 Victor-Purpura 距离 $d_{\\mathrm{VP}}(S_1, S_2)$ 的动态规划递推关系。你的推导必须从 $d_{\\mathrm{VP}}$ 作为最小代价变换的定义开始，并通过最优子结构来证明该递推关系的合理性，不得假设任何已有的封闭形式的比对公式。\n2. 使用你的递推关系，计算特定序列 $S_1 = (0, 10, 20)~\\mathrm{ms}$ 和 $S_2 = (5, 12, 22)~\\mathrm{ms}$ 在 $q = 0.1~\\mathrm{ms}^{-1}$ 时的 $d_{\\mathrm{VP}}(S_1, S_2)$，并展示所有支持最终值的中间量。\n\n将最终答案表示为一个不带单位的实数。无需四舍五入。",
            "solution": "该问题陈述清晰，具有科学依据，并提供了推导所需递推关系和计算指定距离的所有必要信息。我们分两部分进行解答。\n\n### 第 1 部分：动态规划递推关系的推导\n\n两个脉冲序列 $S_1 = (t_1, \\dots, t_m)$ 和 $S_2 = (u_1, \\dots, u_n)$ 之间的 Victor-Purpura (VP) 距离 $d_{\\mathrm{VP}}(S_1, S_2)$ 是使用一组允许的操作将 $S_1$ 变换为 $S_2$ 的最小总代价。此问题具有最优子结构，因此适合采用动态规划求解。\n\n我们来定义一个子问题。设 $S_{1,i} = (t_1, \\dots, t_i)$ 是 $S_1$ 的包含其前 $i$ 个脉冲的前缀，而 $S_{2,j} = (u_1, \\dots, u_j)$ 是 $S_2$ 的包含其前 $j$ 个脉冲的前缀。我们定义 $D(i, j)$ 为这些前缀之间的 VP 距离：$D(i, j) = d_{\\mathrm{VP}}(S_{1,i}, S_{2,j})$。我们的目标是计算 $D(m, n)$。\n\n该解构建在一个大小为 $(m+1) \\times (n+1)$ 的代价矩阵 $D$ 之上，其中索引 $i$ 的范围是从 $0$ 到 $m$，$j$ 的范围是从 $0$ 到 $n$。\n\n**基本情况：**\n将一个空脉冲序列变换为另一个脉冲序列的代价取决于所需的插入或删除次数。\n1. 两个空脉冲序列之间的距离为零：\n$$D(0, 0) = 0$$\n2. 要将一个包含 $i$ 个脉冲的脉冲序列 $S_{1,i}$ 变换为空序列，我们必须删除所有 $i$ 个脉冲。每次删除的代价为 $1$。因此，总代价为 $i$：\n$$D(i, 0) = i \\quad \\text{for } i > 0$$\n3. 要将一个空脉冲序列变换为一个包含 $j$ 个脉冲的脉冲序列 $S_{2,j}$，我们必须插入所有 $j$ 个脉冲。每次插入的代价为 $1$。因此，总代价为 $j$：\n$$D(0, j) = j \\quad \\text{for } j > 0$$\n\n**递推关系：**\n对于 $i > 0$ 和 $j > 0$ 的一般情况 $D(i, j)$，我们考虑将 $S_{1,i}$ 变换为 $S_{2,j}$。最优子结构原理指出，计算 $D(i, j)$ 的最优（最小代价）路径必须建立在更小子问题的最优解之上。变换序列中的最后一步操作必然涉及最后的脉冲 $t_i$ 和 $u_j$。最后一步有三种可能性：\n\n1.  **删除：** 从 $S_{1,i}$ 中删除脉冲 $t_i$。此操作的代价为 $1$。余下的问题是将前缀 $S_{1, i-1}$ 变换为 $S_{2,j}$。根据定义，此子问题的最小代价是 $D(i-1, j)$。因此，通过此路径的总代价为 $D(i-1, j) + 1$。\n\n2.  **插入：** 插入脉冲 $u_j$。这意味着我们已经将 $S_{1,i}$ 最优地变换为 $S_{2, j-1}$，然后执行最后一次插入 $u_j$ 的操作。插入的代价是 $1$。前一个子问题的代价是 $D(i, j-1)$。因此，通过此路径的总代价为 $D(i, j-1) + 1$。\n\n3.  **平移（或匹配）：** 脉冲 $t_i$ 被认为与脉冲 $u_j$ 对应。这被建模为将 $t_i$ 平移到 $u_j$ 的时间。此操作的代价为 $q|t_i - u_j|$。余下的问题是将前缀 $S_{1, i-1}$ 变换为 $S_{2, j-1}$，其最小代价为 $D(i-1, j-1)$。因此，通过此路径的总代价为 $D(i-1, j-1) + q|t_i - u_j|$。\n\nVP 距离 $D(i, j)$ 是这三个互斥的最后操作的代价中的最小值。这给出了递推关系：\n$$D(i, j) = \\min\\left( D(i-1, j) + 1, \\quad D(i, j-1) + 1, \\quad D(i-1, j-1) + q|t_i - u_j| \\right)$$\n这个递推关系连同基本情况，允许系统地计算整个代价矩阵 $D$，最终答案即为 $D(m, n)$。\n\n### 第 2 部分：针对特定脉冲序列的计算\n\n给定：\n- 脉冲序列 $S_1 = (t_1, t_2, t_3) = (0, 10, 20)~\\mathrm{ms}$。因此，$m = 3$。\n- 脉冲序列 $S_2 = (u_1, u_2, u_3) = (5, 12, 22)~\\mathrm{ms}$。因此，$n = 3$。\n- 代价参数 $q = 0.1~\\mathrm{ms}^{-1}$。\n\n我们将计算 $i, j \\in \\{0, 1, 2, 3\\}$ 的 $4 \\times 4$ 矩阵 $D(i, j)$。\n\n**初始化（基本情况）：**\n$D(0, 0) = 0$。\n$D(i, 0) = i$：\n$D(1, 0) = 1$\n$D(2, 0) = 2$\n$D(3, 0) = 3$\n\n$D(0, j) = j$：\n$D(0, 1) = 1$\n$D(0, 2) = 2$\n$D(0, 3) = 3$\n\n初始矩阵为：\n$$\nD = \\begin{pmatrix}\n0   1   2   3 \\\\\n1   ?   ?   ? \\\\\n2   ?   ?   ? \\\\\n3   ?   ?   ?\n\\end{pmatrix}\n$$\n\n**填充矩阵：**\n我们逐行计算其余元素。\n\n- **$D(1, 1)$：** 使用 $t_1=0, u_1=5$：\n$$ D(1, 1) = \\min(D(0, 1)+1, D(1, 0)+1, D(0, 0) + q|t_1-u_1|) $$\n$$ D(1, 1) = \\min(1+1, 1+1, 0 + 0.1|0-5|) = \\min(2, 2, 0.5) = 0.5 $$\n\n- **$D(1, 2)$：** 使用 $t_1=0, u_2=12$：\n$$ D(1, 2) = \\min(D(0, 2)+1, D(1, 1)+1, D(0, 1) + q|t_1-u_2|) $$\n$$ D(1, 2) = \\min(2+1, 0.5+1, 1 + 0.1|0-12|) = \\min(3, 1.5, 1+1.2) = \\min(3, 1.5, 2.2) = 1.5 $$\n\n- **$D(1, 3)$：** 使用 $t_1=0, u_3=22$：\n$$ D(1, 3) = \\min(D(0, 3)+1, D(1, 2)+1, D(0, 2) + q|t_1-u_3|) $$\n$$ D(1, 3) = \\min(3+1, 1.5+1, 2 + 0.1|0-22|) = \\min(4, 2.5, 2+2.2) = \\min(4, 2.5, 4.2) = 2.5 $$\n\n- **$D(2, 1)$：** 使用 $t_2=10, u_1=5$：\n$$ D(2, 1) = \\min(D(1, 1)+1, D(2, 0)+1, D(1, 0) + q|t_2-u_1|) $$\n$$ D(2, 1) = \\min(0.5+1, 2+1, 1 + 0.1|10-5|) = \\min(1.5, 3, 1+0.5) = \\min(1.5, 3, 1.5) = 1.5 $$\n\n- **$D(2, 2)$：** 使用 $t_2=10, u_2=12$：\n$$ D(2, 2) = \\min(D(1, 2)+1, D(2, 1)+1, D(1, 1) + q|t_2-u_2|) $$\n$$ D(2, 2) = \\min(1.5+1, 1.5+1, 0.5 + 0.1|10-12|) = \\min(2.5, 2.5, 0.5+0.2) = \\min(2.5, 2.5, 0.7) = 0.7 $$\n\n- **$D(2, 3)$：** 使用 $t_2=10, u_3=22$：\n$$ D(2, 3) = \\min(D(1, 3)+1, D(2, 2)+1, D(1, 2) + q|t_2-u_3|) $$\n$$ D(2, 3) = \\min(2.5+1, 0.7+1, 1.5 + 0.1|10-22|) = \\min(3.5, 1.7, 1.5+1.2) = \\min(3.5, 1.7, 2.7) = 1.7 $$\n\n- **$D(3, 1)$：** 使用 $t_3=20, u_1=5$：\n$$ D(3, 1) = \\min(D(2, 1)+1, D(3, 0)+1, D(2, 0) + q|t_3-u_1|) $$\n$$ D(3, 1) = \\min(1.5+1, 3+1, 2 + 0.1|20-5|) = \\min(2.5, 4, 2+1.5) = \\min(2.5, 4, 3.5) = 2.5 $$\n\n- **$D(3, 2)$：** 使用 $t_3=20, u_2=12$：\n$$ D(3, 2) = \\min(D(2, 2)+1, D(3, 1)+1, D(2, 1) + q|t_3-u_2|) $$\n$$ D(3, 2) = \\min(0.7+1, 2.5+1, 1.5 + 0.1|20-12|) = \\min(1.7, 3.5, 1.5+0.8) = \\min(1.7, 3.5, 2.3) = 1.7 $$\n\n- **$D(3, 3)$：** 使用 $t_3=20, u_3=22$：\n$$ D(3, 3) = \\min(D(2, 3)+1, D(3, 2)+1, D(2, 2) + q|t_3-u_3|) $$\n$$ D(3, 3) = \\min(1.7+1, 1.7+1, 0.7 + 0.1|20-22|) = \\min(2.7, 2.7, 0.7+0.2) = \\min(2.7, 2.7, 0.9) = 0.9 $$\n\n最终填充的代价矩阵为：\n$$\nD = \\begin{pmatrix}\n0     1     2     3   \\\\\n1     0.5   1.5   2.5 \\\\\n2     1.5   0.7   1.7 \\\\\n3     2.5   1.7   0.9\n\\end{pmatrix}\n$$\n$S_1$ 和 $S_2$ 之间的 Victor-Purpura 距离是矩阵右下角的值 $D(3, 3)$。\n$$ d_{\\mathrm{VP}}(S_1, S_2) = D(3, 3) = 0.9 $$",
            "answer": "$$\n\\boxed{0.9}\n$$"
        },
        {
            "introduction": "与基于“编辑”操作的VP距离不同，van Rossum (vR) 距离从信号处理的视角出发，将离散的脉冲序列转换为连续的时间函数。本练习要求你从vR距离的积分定义开始，通过计算经指数核函数卷积后信号的重叠程度，推导出其解析表达式。这个过程将加深你对vR距离如何量化经时间平滑后神经活动差异的理解。",
            "id": "4194684",
            "problem": "考虑两个脉冲序列，表示为狄拉克δ分布的和，$s_{1}(t)=\\sum_{i=1}^{N_{1}}\\delta(t-t_{i})$ 和 $s_{2}(t)=\\sum_{j=1}^{N_{2}}\\delta(t-u_{j})$，其中 $\\delta(\\cdot)$ 表示狄拉克δ分布，$\\{t_{i}\\}$、$\\{u_{j}\\}$ 是脉冲时间。令指数衰减核为 $h(t)=\\exp(-t/\\tau)H(t)$，其中 $H(t)$ 是亥维赛阶跃函数，$\\tau>0$ 是时间常数。定义滤波后的信号 $x_{1}(t)=(h*s_{1})(t)$ 和 $x_{2}(t)=(h*s_{2})(t)$，其中 $*$ 表示卷积。van Rossum (vR) 距离由平方 $L^{2}$ 范数定义\n$$\nd_{\\mathrm{vR}}^{2}=\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\left[x_{1}(t)-x_{2}(t)\\right]^{2}\\,\\mathrm{d}t.\n$$\n从这些定义出发，并且不使用任何快捷公式，推导出一个关于脉冲时间 $\\{t_{i}\\}$、$\\{u_{j}\\}$ 以及成对指数重叠的 $d_{\\mathrm{vR}}^{2}$ 的闭式表达式。然后，对于脉冲序列 $S_{1}=\\{0,10\\}$ ms 和 $S_{2}=\\{5,12\\}$ ms，以及 $\\tau=5$ ms，计算 $d_{\\mathrm{vR}}^{2}$ 的值。将最终数值表示为无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导 van Rossum 距离 $d_{\\mathrm{vR}}^{2}$ 的闭式表达式，并随后对两个特定的脉冲序列进行求值。\n\n### 步骤 1：问题验证\n问题陈述给出了以下已知条件：\n- 脉冲序列 1：$s_{1}(t)=\\sum_{i=1}^{N_{1}}\\delta(t-t_{i})$。\n- 脉冲序列 2：$s_{2}(t)=\\sum_{j=1}^{N_{2}}\\delta(t-u_{j})$。\n- 指数核：$h(t)=\\exp(-t/\\tau)H(t)$，其中 $\\tau>0$。$H(t)$ 是亥维赛阶跃函数。\n- 滤波后的信号：$x_{1}(t)=(h*s_{1})(t)$ 和 $x_{2}(t)=(h*s_{2})(t)$，其中 $*$ 是卷积。\n- van Rossum 距离平方的定义：$d_{\\mathrm{vR}}^{2}=\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\left[x_{1}(t)-x_{2}(t)\\right]^{2}\\,\\mathrm{d}t$。\n- 用于求值的特定脉冲序列：$S_{1}=\\{0,10\\}$ ms 和 $S_{2}=\\{5,12\\}$ ms。\n- 特定的时间常数：$\\tau=5$ ms。\n\n该问题具有科学依据，提法明确，且客观。它基于计算神经科学和数学的标准定义。所有必要的信息都已提供，且没有矛盾之处。该问题是有效的。\n\n### 步骤 2：推导闭式表达式\n\nvan Rossum 距离的平方由下式给出\n$$\nd_{\\mathrm{vR}}^{2}=\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\left[x_{1}(t)-x_{2}(t)\\right]^{2}\\,\\mathrm{d}t\n$$\n展开被积函数中的平方项，得到\n$$\nd_{\\mathrm{vR}}^{2} = \\frac{1}{\\tau}\\left(\\int_{-\\infty}^{\\infty} x_1(t)^2 \\,\\mathrm{d}t - 2\\int_{-\\infty}^{\\infty} x_1(t)x_2(t) \\,\\mathrm{d}t + \\int_{-\\infty}^{\\infty} x_2(t)^2 \\,\\mathrm{d}t\\right)\n$$\n首先，我们明确地写出滤波后的信号 $x_1(t)$ 和 $x_2(t)$。核 $h(t)$ 与脉冲序列 $s(t) = \\sum_k \\delta(t-t_k)$ 的卷积是\n$$\n(h*s)(t) = \\int_{-\\infty}^{\\infty} h(t-t') \\sum_k \\delta(t'-t_k) \\,\\mathrm{d}t' = \\sum_k h(t-t_k)\n$$\n使用给定的核 $h(t)=\\exp(-t/\\tau)H(t)$，滤波后的信号为\n$$\nx_{1}(t) = \\sum_{i=1}^{N_1} \\exp\\left(-\\frac{t-t_i}{\\tau}\\right) H(t-t_i)\n$$\n$$\nx_{2}(t) = \\sum_{j=1}^{N_2} \\exp\\left(-\\frac{t-u_j}{\\tau}\\right) H(t-u_j)\n$$\n现在，我们来计算积分。我们从交叉项积分 $\\int_{-\\infty}^{\\infty} x_1(t)x_2(t) \\,\\mathrm{d}t$ 开始。\n\\begin{align*}\n\\int_{-\\infty}^{\\infty} x_1(t)x_2(t) \\,\\mathrm{d}t = \\int_{-\\infty}^{\\infty} \\left(\\sum_{i=1}^{N_1} h(t-t_i)\\right) \\left(\\sum_{j=1}^{N_2} h(t-u_j)\\right) \\,\\mathrm{d}t \\\\\n= \\sum_{i=1}^{N_1} \\sum_{j=1}^{N_2} \\int_{-\\infty}^{\\infty} h(t-t_i) h(t-u_j) \\,\\mathrm{d}t\n\\end{align*}\n我们来计算一对脉冲 $(t_i, u_j)$ 的内层积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-t_i}{\\tau}\\right)H(t-t_i) \\exp\\left(-\\frac{t-u_j}{\\tau}\\right)H(t-u_j) \\,\\mathrm{d}t\n$$\n亥维赛函数之积 $H(t-t_i)H(t-u_j)$ 仅在 $t \\ge t_i$ 和 $t \\ge u_j$ 时非零，即 $t \\ge \\max(t_i, u_j)$。令 $t_{\\max} = \\max(t_i, u_j)$。积分变为：\n\\begin{align*}\n\\int_{t_{\\max}}^{\\infty} \\exp\\left(-\\frac{t-t_i}{\\tau} - \\frac{t-u_j}{\\tau}\\right) \\,\\mathrm{d}t = \\exp\\left(\\frac{t_i+u_j}{\\tau}\\right) \\int_{t_{\\max}}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\,\\mathrm{d}t \\\\\n= \\exp\\left(\\frac{t_i+u_j}{\\tau}\\right) \\left[-\\frac{\\tau}{2}\\exp\\left(-\\frac{2t}{\\tau}\\right)\\right]_{t_{\\max}}^{\\infty} \\\\\n= \\exp\\left(\\frac{t_i+u_j}{\\tau}\\right) \\left(0 - \\left(-\\frac{\\tau}{2}\\exp\\left(-\\frac{2t_{\\max}}{\\tau}\\right)\\right)\\right) \\\\\n= \\frac{\\tau}{2}\\exp\\left(\\frac{t_i+u_j-2t_{\\max}}{\\tau}\\right)\n\\end{align*}\n如果 $t_i \\ge u_j$，那么 $t_{\\max} = t_i$，指数项为 $(t_i+u_j-2t_i)/\\tau = (u_j-t_i)/\\tau = -|t_i-u_j|/\\tau$。\n如果 $u_j > t_i$，那么 $t_{\\max} = u_j$，指数项为 $(t_i+u_j-2u_j)/\\tau = (t_i-u_j)/\\tau = -|t_i-u_j|/\\tau$。\n在这两种情况下，结果都是 $\\frac{\\tau}{2}\\exp\\left(-\\frac{|t_i-u_j|}{\\tau}\\right)$。\n因此，交叉项积分为\n$$\n\\int_{-\\infty}^{\\infty} x_1(t)x_2(t) \\,\\mathrm{d}t = \\sum_{i=1}^{N_1} \\sum_{j=1}^{N_2} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_i-u_j|}{\\tau}\\right)\n$$\n通过将 $s_2$ 替换为 $s_1$（即 $u_j \\to t_k$, $N_2 \\to N_1$），我们得到自相关项积分 $\\int x_1(t)^2 \\,\\mathrm{d}t$：\n$$\n\\int_{-\\infty}^{\\infty} x_1(t)^2 \\,\\mathrm{d}t = \\sum_{i=1}^{N_1} \\sum_{k=1}^{N_1} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right)\n$$\n同理，对于 $x_2(t)$：\n$$\n\\int_{-\\infty}^{\\infty} x_2(t)^2 \\,\\mathrm{d}t = \\sum_{j=1}^{N_2} \\sum_{l=1}^{N_2} \\frac{\\tau}{2}\\exp\\left(-\\frac{|u_j-u_l|}{\\tau}\\right)\n$$\n将这些结果代回 $d_{\\mathrm{vR}}^{2}$ 的表达式中：\n\\begin{align*}\nd_{\\mathrm{vR}}^{2} = \\frac{1}{\\tau} \\left[ \\sum_{i,k} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right) - 2\\sum_{i,j} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_i-u_j|}{\\tau}\\right) + \\sum_{j,l} \\frac{\\tau}{2}\\exp\\left(-\\frac{|u_j-u_l|}{\\tau}\\right) \\right] \\\\\n= \\frac{1}{2} \\left[ \\sum_{i=1}^{N_1}\\sum_{k=1}^{N_1} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right) - 2\\sum_{i=1}^{N_1}\\sum_{j=1}^{N_2} \\exp\\left(-\\frac{|t_i-u_j|}{\\tau}\\right) + \\sum_{j=1}^{N_2}\\sum_{l=1}^{N_2} \\exp\\left(-\\frac{|u_j-u_l|}{\\tau}\\right) \\right]\n\\end{align*}\n这就是所要求的闭式表达式。\n\n### 步骤 3：数值计算\n\n我们已知 $S_{1}=\\{t_1, t_2\\}=\\{0, 10\\}$ ms，$S_{2}=\\{u_1, u_2\\}=\\{5, 12\\}$ ms，以及 $\\tau=5$ ms。像 $|t_i-u_j|/\\tau$ 这样的比率是无量纲的。\n\n我们来计算 $d_{\\mathrm{vR}}^{2}$ 表达式中的三项：\n1.  第一项（$S_1$ 内部的相互作用）：\n\\begin{align*}\n\\sum_{i=1}^{2}\\sum_{k=1}^{2} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right) = \\exp\\left(-\\frac{|0-0|}{5}\\right) + \\exp\\left(-\\frac{|0-10|}{5}\\right) + \\exp\\left(-\\frac{|10-0|}{5}\\right) + \\exp\\left(-\\frac{|10-10|}{5}\\right) \\\\\n= \\exp(0) + \\exp(-2) + \\exp(-2) + \\exp(0) = 2 + 2\\exp(-2)\n\\end{align*}\n2.  第二项（$S_1$ 和 $S_2$ 之间的交叉相互作用）：\n\\begin{align*}\n-2\\sum_{i=1}^{2}\\sum_{j=1}^{2} \\exp\\left(-\\frac{|t_i-u_j|}{\\tau}\\right) = -2 \\left[ \\exp\\left(-\\frac{|0-5|}{5}\\right) + \\exp\\left(-\\frac{|0-12|}{5}\\right) + \\exp\\left(-\\frac{|10-5|}{5}\\right) + \\exp\\left(-\\frac{|10-12|}{5}\\right) \\right] \\\\\n= -2 \\left[ \\exp(-1) + \\exp(-2.4) + \\exp(-1) + \\exp(-0.4) \\right] \\\\\n= -4\\exp(-1) - 2\\exp(-2.4) - 2\\exp(-0.4)\n\\end{align*}\n3.  第三项（$S_2$ 内部的相互作用）：\n\\begin{align*}\n\\sum_{j=1}^{2}\\sum_{l=1}^{2} \\exp\\left(-\\frac{|u_j-u_l|}{\\tau}\\right) = \\exp\\left(-\\frac{|5-5|}{5}\\right) + \\exp\\left(-\\frac{|5-12|}{5}\\right) + \\exp\\left(-\\frac{|12-5|}{5}\\right) + \\exp\\left(-\\frac{|12-12|}{5}\\right) \\\\\n= \\exp(0) + \\exp(-1.4) + \\exp(-1.4) + \\exp(0) = 2 + 2\\exp(-1.4)\n\\end{align*}\n将这些项合并到 $d_{\\mathrm{vR}}^{2}$ 的表达式中：\n\\begin{align*}\nd_{\\mathrm{vR}}^{2} = \\frac{1}{2} \\left[ (2 + 2\\exp(-2)) + (-4\\exp(-1) - 2\\exp(-2.4) - 2\\exp(-0.4)) + (2 + 2\\exp(-1.4)) \\right] \\\\\n= (1 + \\exp(-2)) - (2\\exp(-1) + \\exp(-2.4) + \\exp(-0.4)) + (1 + \\exp(-1.4)) \\\\\n= 2 + \\exp(-2) + \\exp(-1.4) - 2\\exp(-1) - \\exp(-2.4) - \\exp(-0.4)\n\\end{align*}\n现在，我们代入指数函数的数值：\n$\\exp(-1) \\approx 0.367879$\n$\\exp(-2) \\approx 0.135335$\n$\\exp(-0.4) \\approx 0.670320$\n$\\exp(-1.4) \\approx 0.246597$\n$\\exp(-2.4) \\approx 0.090718$\n\n\\begin{align*}\nd_{\\mathrm{vR}}^{2} \\approx 2 + 0.135335 + 0.246597 - 2(0.367879) - 0.090718 - 0.670320 \\\\\n\\approx 2.381932 - 0.735758 - 0.090718 - 0.670320 \\\\\n\\approx 2.381932 - 1.496796 \\\\\n\\approx 0.885136\n\\end{align*}\n四舍五入到四位有效数字，我们得到 $0.8851$。",
            "answer": "$$\\boxed{0.8851}$$"
        },
        {
            "introduction": "在分别掌握了Victor-Purpura和van Rossum距离的计算方法后，关键的下一步是直接比较它们的行为。本练习提供了一个具体的场景，让你对同一组脉冲序列同时计算这两种距离。通过分析和比较结果，你将体会到各自的参数——VP的成本参数 $q$ 和vR的时间常数 $\\tau$——如何使它们对脉冲计时的不同方面（如精确时间抖动与整体速率变化）产生差异化的敏感性。",
            "id": "4194638",
            "problem": "在 $30$ ms 的时间窗口内观测到两个单神经元的脉冲序列：$S_{1}=\\{0,10,20\\}$ ms 和 $S_{2}=\\{2,12,18\\}$ ms。您将使用两种标准的脉冲序列距离度量，基于它们的核心定义来对这两个序列进行比较。\n\n1.  带有代价参数 $q$ 的 Victor-Purpura (VP) 度量，量化了通过对脉冲进行三种基本操作将一个脉冲序列变换为另一个所需的最小总代价：插入（代价为 $1$）、删除（代价为 $1$）以及时间平移量 $\\Delta t$（代价为 $q|\\Delta t|$）。从这些操作代价和在所有操作序列上取最小总代价的原理出发，确定当 $q=0.2~\\mathrm{ms}^{-1}$ 时，给定脉冲序列的 VP 距离。\n\n2.  带有时间常数 $\\tau$ 的 van Rossum (vR) 度量，其定义为首先将每个脉冲序列 $s(t)=\\sum_{i}\\delta(t-t_{i})$ 与一个因果指数核 $h_{\\tau}(t)=\\exp(-t/\\tau)\\,H(t)$ 进行卷积，其中 $H(t)$ 是亥维赛德阶跃函数。将滤波后的信号记为 $x_{1}(t)=(h_{\\tau}\\ast s_{1})(t)$ 和 $x_{2}(t)=(h_{\\tau}\\ast s_{2})(t)$。仅使用这些定义以及卷积和指数函数积分的性质，推导 van Rossum 距离的解析表达式\n$$\nD_{\\mathrm{vR}}(S_{1},S_{2};\\tau)=\\sqrt{\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\big(x_{1}(t)-x_{2}(t)\\big)^{2}\\,dt}\n$$\n并当 $\\tau=5$ ms 时，对给定的脉冲序列计算其值。\n\n请根据您的推导和所得结果，解释每种度量如何相对于其参数（VP 的 $q$，vR 的 $\\tau$）强调脉冲时间变异性的不同方面。将您的数值答案四舍五入到四位有效数字。将每个距离表示为无量纲数。在您的最终答案中，以行矩阵的形式按顺序报告 $\\big(D_{\\mathrm{vR}},D_{\\mathrm{VP}}\\big)$ 这对数值。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于 Victor-Purpura 和 van Rossum 脉冲序列距离度量的标准定义，这些都是计算神经科学中的公认工具。该问题是适定的，提供了所有必要的数据（$S_1$、$S_2$）、参数（$q$、$\\tau$）和定义，以得出一个唯一且有意义的解。语言客观、精确，设定内部一致且无矛盾。单位在量纲上是一致的，按要求可以得到无量纲的距离值。\n\n问题的第一部分要求计算 Victor-Purpura (VP) 距离 $D_{\\mathrm{VP}}$。给定的脉冲序列为 $S_{1}=\\{0, 10, 20\\}$ ms 和 $S_{2}=\\{2, 12, 18\\}$ ms。代价参数为 $q=0.2~\\mathrm{ms}^{-1}$。VP 距离是将 $S_1$ 变换为 $S_2$ 所需的最小总代价，可使用的三种基本操作为：插入一个脉冲（代价为 $1$）、删除一个脉冲（代价为 $1$），以及将一个脉冲平移一个时间间隔 $\\Delta t$（代价为 $q|\\Delta t|$）。\n\n由于两个脉冲序列都包含相同数量的脉冲（$3$ 个），一个可能的最小代价路径是通过时间平移将 $S_1$ 中的脉冲一一映射到 $S_2$ 中，而没有任何插入或删除操作。我们来分析将 $S_1$ 中的每个脉冲平移到 $S_2$ 中对应脉冲的代价：\n\\begin{enumerate}\n    \\item 将 $t_1=0$ ms 的脉冲平移到 $t'_1=2$ ms：$\\Delta t_1 = 2$ ms。代价 = $q|\\Delta t_1| = 0.2 \\times 2 = 0.4$。\n    \\item 将 $t_2=10$ ms 的脉冲平移到 $t'_2=12$ ms：$\\Delta t_2 = 2$ ms。代价 = $q|\\Delta t_2| = 0.2 \\times 2 = 0.4$。\n    \\item 将 $t_3=20$ ms 的脉冲平移到 $t'_3=18$ ms：$\\Delta t_3 = -2$ ms。代价 = $q|\\Delta t_3| = 0.2 \\times |-2| = 0.4$。\n\\end{enumerate}\n这个平移序列的总代价是 $0.4 + 0.4 + 0.4 = 1.2$。\n\n我们必须确认这是最小代价。将一个脉冲从 $t_i$ 平移到 $t'_i$ 的另一种方法是删除在 $t_i$ 的脉冲并在 $t'_i$ 插入一个新脉冲。这对操作的代价将是 $1 (\\text{删除}) + 1 (\\text{插入}) = 2$。如果 $q|\\Delta t|  2$，则平移是更便宜的选项。当 $q=0.2~\\mathrm{ms}^{-1}$ 时，此条件变为 $0.2|\\Delta t|  2$，可简化为 $|\\Delta t|  10$ ms。对于上述所有三个脉冲配对，时间平移量为 $|\\Delta t| = 2$ ms，小于 $10$ ms。因此，对于每个脉冲，平移都比删除和插入更便宜。更复杂的操作序列（例如，删除两个脉冲并插入另外两个）代价会更高。通过保持脉冲的一一对应关系并对平移代价求和，可以找到最小代价。\n因此，Victor-Purpura 距离为 $D_{\\mathrm{VP}} = 1.2$。四舍五入到四位有效数字得到 $D_{\\mathrm{VP}} = 1.200$。\n\n问题的第二部分要求计算时间常数为 $\\tau=5$ ms 的 van Rossum (vR) 距离 $D_{\\mathrm{vR}}$。该距离定义为：\n$$D_{\\mathrm{vR}}(S_{1},S_{2};\\tau)=\\sqrt{\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\big(x_{1}(t)-x_{2}(t)\\big)^{2}\\,dt}$$\n其中 $x_j(t) = (h_\\tau \\ast s_j)(t)$ 且 $s_j(t) = \\sum_i \\delta(t-t_{j,i})$。核函数为 $h_\\tau(t) = \\exp(-t/\\tau)H(t)$。\n滤波后的信号为 $x_j(t) = \\sum_i (h_\\tau \\ast \\delta(t-t_{j,i}))(t) = \\sum_i h_\\tau(t-t_{j,i})$。\n距离的平方是 $D_{\\mathrm{vR}}^2 = \\frac{1}{\\tau} \\int (x_1(t) - x_2(t))^2 dt = \\frac{1}{\\tau} \\left( \\int x_1^2(t) dt - 2\\int x_1(t)x_2(t) dt + \\int x_2^2(t) dt \\right)$。\n我们首先推导交叉积分项 $\\int h_\\tau(t-t_a) h_\\tau(t-t_b) dt$ 的表达式。\n$$\\int_{-\\infty}^{\\infty} h_\\tau(t-t_a)h_\\tau(t-t_b) dt = \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{t-t_a}{\\tau}\\right) \\exp\\left(-\\frac{t-t_b}{\\tau}\\right) dt$$\n$$= \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) dt = \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\left[ -\\frac{\\tau}{2}\\exp\\left(-\\frac{2t}{\\tau}\\right) \\right]_{\\max(t_a, t_b)}^{\\infty}$$\n$$= \\frac{\\tau}{2} \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right) = \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_a-t_b|}{\\tau}\\right)$$\n使用这个结果，距离的平方可以写成：\n$$D_{\\mathrm{vR}}^2 = \\frac{1}{\\tau} \\left( \\sum_{i,j} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_{1,i}-t_{1,j}|}{\\tau}\\right) - 2\\sum_{i,j} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_{1,i}-t_{2,j}|}{\\tau}\\right) + \\sum_{i,j} \\frac{\\tau}{2}\\exp\\left(-\\frac{|t_{2,i}-t_{2,j}|}{\\tau}\\right) \\right)$$\n$$D_{\\mathrm{vR}}^2 = \\frac{1}{2} \\left( \\sum_{i,j} \\exp\\left(-\\frac{|t_{1,i}-t_{1,j}|}{\\tau}\\right) - 2\\sum_{i,j} \\exp\\left(-\\frac{|t_{1,i}-t_{2,j}|}{\\tau}\\right) + \\sum_{i,j} \\exp\\left(-\\frac{|t_{2,i}-t_{2,j}|}{\\tau}\\right) \\right)$$\n这就是所要求的解析表达式。现在我们用 $S_1 = \\{0, 10, 20\\}$、$S_2 = \\{2, 12, 18\\}$ 和 $\\tau=5$ 来计算它。\n\n第 1 项（$S_1$ 的自相关）：$\\sum_{i,j} \\exp(-|t_{1,i}-t_{1,j}|/5)$。时间差为 $|0|$、 $|10|$、 $|20|$、 $|10|$、 $|0|$、 $|10|$、 $|20|$、 $|10|$、 $|0|$。和为 $3\\exp(0) + 4\\exp(-2) + 2\\exp(-4) \\approx 3 + 4(0.135335) + 2(0.018316) \\approx 3.57797$。\n\n第 3 项（$S_2$ 的自相关）：$\\sum_{i,j} \\exp(-|t_{2,i}-t_{2,j}|/5)$。时间差为 $|0|$、 $|10|$、 $|16|$、 $|10|$、 $|0|$、 $|6|$、 $|16|$、 $|6|$、 $|0|$。和为 $3\\exp(0) + 2\\exp(-2) + 2\\exp(-1.2) + 2\\exp(-3.2) \\approx 3 + 2(0.135335) + 2(0.301194) + 2(0.040762) \\approx 3.95458$。\n\n第 2 项（$S_1$ 和 $S_2$ 之间的互相关）：$\\sum_{i,j} \\exp(-|t_{1,i}-t_{2,j}|/5)$。时间差矩阵 $|t_{1,i}-t_{2,j}|$ 为 $\\begin{pmatrix} 2   12  18 \\\\ 8   2   8 \\\\ 18  8   2 \\end{pmatrix}$。$\\exp(-|\\Delta t|/5)$ 项的和为 $3\\exp(-2/5) + 3\\exp(-8/5) + \\exp(-12/5) + 2\\exp(-18/5) = 3\\exp(-0.4) + 3\\exp(-1.6) + \\exp(-2.4) + 2\\exp(-3.6) \\approx 3(0.670320) + 3(0.201897) + (0.090718) + 2(0.027324) \\approx 2.76202$。\n\n组合这些项：\n$$D_{\\mathrm{vR}}^2 = \\frac{1}{2}(3.57797 - 2 \\times 2.76202 + 3.95458) = \\frac{1}{2}(3.57797 - 5.52404 + 3.95458) = \\frac{1}{2}(2.00851) = 1.004255$$\n$$D_{\\mathrm{vR}} = \\sqrt{1.004255} \\approx 1.002125$$\n四舍五入到四位有效数字得到 $D_{\\mathrm{vR}} = 1.002$。\n\n对度量侧重点的解释：\nVictor–Purpura (VP) 度量是一种直接比较脉冲时间的“编辑距离”。代价参数 $q$ 通过定义一个特征时间间隔 $2/q$ 来设定时间精度。小于此间隔的脉冲平移被视为时间抖动（代价为 $q|\\Delta t|$），而大于此间隔的平移则被视为独立事件（代价为 $2$，即一次删除和一次插入）。在我们的问题中，$2/q = 10$ ms。由于所有脉冲时间差异都是 $2$ ms，它们远低于此阈值，因此距离反映了这些小幅平移的累积代价。更大的 $q$ 会更重地惩罚这些平移，表明对时间具有更高的敏感度。\n\nvan Rossum (vR) 度量是一种基于信号的距离。它通过将脉冲序列与指数核 $h_\\tau(t)$ 卷积，将其转换为连续函数。时间常数 $\\tau$ 定义了该核的衰减率，从而定义了应用于脉冲序列的时间“平滑”程度。当 $\\tau=5$ ms 时，每个脉冲的影响在几毫秒内衰减，使得该度量对该尺度上的时间差异敏感。所得距离是两个滤波后信号之差的 $L_2$ 范数，它通过这些函数的重叠来捕捉脉冲时间和数量上的差异。较小的 $\\tau$ 会导致更尖锐的滤波信号和对精确时间更高的敏感度，而较大的 $\\tau$ 会使信号更平滑，使度量对发放率而非精确脉冲时间更敏感。在本例中，所选的 $\\tau=5$ ms 与 $1/q=5$ ms 处于同一数量级，导致两种度量在相似的时间分辨率上运行，对毫秒级的抖动都很敏感。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.002  1.200\n\\end{pmatrix}\n}\n$$"
        }
    ]
}