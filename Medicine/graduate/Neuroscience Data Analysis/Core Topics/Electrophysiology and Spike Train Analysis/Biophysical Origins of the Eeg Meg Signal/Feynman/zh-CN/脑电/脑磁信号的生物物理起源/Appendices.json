{
    "hands_on_practices": [
        {
            "introduction": "脑电图(EEG)和脑磁图(MEG)信号的频率内容不仅由突触输入的模式决定，也受到神经元自身生物物理特性的影响。这项练习将使用一个简化的$RC$电路模型来阐明神经元的树突如何充当低通滤波器，从而衰减高频的突触后电位 。这是理解细胞层面活动与宏观信号之间联系的第一步。",
            "id": "4142652",
            "problem": "一群排列整齐的皮层锥体神经元产生宏观电流偶极矩向量 $\\mathbf{p}(t)$，这是脑电图 (EEG) 信号的基础。假设每个神经元的远端顶树突可以近似为一个无源集总膜，其电阻为 $R_{m}$，电容为 $C_{m}$，由施加在远端树突附近的正弦突触电流密度 $i_{s}(t) = i_{0} \\cos(2 \\pi f t)$ 驱动。胞体作为参考点，因此我们感兴趣的输出变量是沿树突轴的远端-胞体膜电位差 $V(t)$，它通过几何形状和轴向耦合对 $\\mathbf{p}(t)$ 产生线性贡献。在脑电图频率下，细胞外介质和头部组织可以用麦克斯韦方程组的准静态近似很好地描述，因此头皮电位与 $\\mathbf{p}(t)$ 成正比，在所考虑的频带内比例常数与频率无关。\n\n从线性膜电流平衡和膜时间常数 $\\tau_{m} = R_{m} C_{m}$ 的定义出发，推导在正弦驱动 $i_{s}(t)$ 下 $\\mathbf{p}(t)$ 振幅的频率依赖性，并说明无源树突滤波如何产生频率依赖性衰减。然后，利用准静态容积传导假设，对于膜时间常数 $\\tau_{m} = 20$ ms，预测在 $f_{2} = 100$ Hz 时的头皮脑电图增益相对于 $f_{1} = 10$ Hz 时的相对下降，假设两种频率下的驱动振幅 $i_{0}$ 相同，且神经元排列和头部几何形状相同。\n\n将最终结果表示为 $f_{2} = 100$ Hz 时与 $f_{1} = 10$ Hz 时头皮脑电图增益的无量纲比值，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求基于一个简化的生物物理模型，推导神经元偶极矩的频率依赖性衰减，并随后计算在两个不同频率下的相对脑电图增益。\n\n首先，我们验证问题陈述。\n**步骤 1：提取已知条件**\n- 系统：一群排列整齐的皮层锥体神经元。\n- 宏观源：电流偶极矩向量 $\\mathbf{p}(t)$。\n- 神经元模型：每个神经元的远端顶树突是一个无源集总膜。\n- 集总参数：电阻 $R_{m}$，电容 $C_{m}$。\n- 输入：正弦突触电流密度 $i_{s}(t) = i_{0} \\cos(2 \\pi f t)$。\n- 输出变量：远端-胞体膜电位差 $V(t)$。\n- 源-输出关系：$V(t)$ 对 $\\mathbf{p}(t)$ 产生线性贡献。\n- 容积导体模型：麦克斯韦方程组的准静态近似。\n- 头皮电位关系：与 $\\mathbf{p}(t)$ 成正比，比例常数与频率无关。\n- 定义：膜时间常数 $\\tau_{m} = R_{m} C_{m}$。\n- 任务 1：推导 $\\mathbf{p}(t)$ 振幅的频率依赖性。\n- 任务 2：预测在 $f_{2} = 100$ Hz 时的头皮脑电图增益相对于 $f_{1} = 10$ Hz 时的相对下降。\n- 参数值：$\\tau_{m} = 20$ ms, $f_{1} = 10$ Hz, $f_{2} = 100$ Hz。\n- 假设：两种频率下的驱动振幅 $i_{0}$ 相同。\n- 最终输出格式：$f_{2}$ 与 $f_{1}$ 时的头皮脑电图增益的无量纲比值，四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了计算神经科学中的标准模型：用于无源膜片的集总 RC 电路模型和用于脑电图容积传导的准静态近似。问题提法严谨，提供了得出唯一解所需的所有信息和假设。语言客观、精确。问题有效。\n\n**步骤 3：结论与行动**\n问题有效。我们开始求解。\n\n集总无源膜的电流平衡将神经元建模为一个并联 RC 电路。总注入突触电流 $I_{s}(t)$ 分布在电阻通路（漏电流）和电容通路（膜的充电/放电）之间。控制微分方程为：\n$$I_{s}(t) = \\frac{V(t)}{R_{m}} + C_{m} \\frac{dV(t)}{dt}$$\n其中 $V(t)$ 是膜电位差。注入电流 $I_{s}(t)$ 与给定的突触电流密度 $i_{s}(t)$ 成正比，因此我们可以写成 $I_{s}(t) = I_{0}\\cos(\\omega t)$，其中 $\\omega = 2\\pi f$ 是角频率，振幅 $I_{0}$ 与 $i_{0}$ 成正比。\n\n使用膜时间常数 $\\tau_{m} = R_{m}C_{m}$ 的定义，我们将方程两边乘以 $R_{m}$：\n$$R_{m}I_{s}(t) = V(t) + R_{m}C_{m}\\frac{dV(t)}{dt}$$\n$$\\tau_{m} \\frac{dV(t)}{dt} + V(t) = R_{m}I_{s}(t)$$\n为了求正弦稳态响应，我们使用复相量。设 $I_{s}(t) = \\text{Re}\\{\\tilde{I}_{s}(t)\\}$，其中 $\\tilde{I}_{s}(t) = I_{0}\\exp(j\\omega t)$，并假设解的形式为 $V(t) = \\text{Re}\\{\\tilde{V}(t)\\}$，其中 $\\tilde{V}(t) = \\tilde{V}_{\\text{amp}}\\exp(j\\omega t)$，$\\tilde{V}_{\\text{amp}}$ 是复振幅。代入常微分方程 (ODE)：\n$$\\tau_{m} \\frac{d}{dt}(\\tilde{V}_{\\text{amp}}\\exp(j\\omega t)) + \\tilde{V}_{\\text{amp}}\\exp(j\\omega t) = R_{m}I_{0}\\exp(j\\omega t)$$\n$$\\tau_{m}(j\\omega)\\tilde{V}_{\\text{amp}}\\exp(j\\omega t) + \\tilde{V}_{\\text{amp}}\\exp(j\\omega t) = R_{m}I_{0}\\exp(j\\omega t)$$\n两边除以 $\\exp(j\\omega t)$：\n$$(1 + j\\omega\\tau_{m})\\tilde{V}_{\\text{amp}} = R_{m}I_{0}$$\n电压的复振幅是：\n$$\\tilde{V}_{\\text{amp}}(f) = \\frac{R_{m}I_{0}}{1 + j(2\\pi f)\\tau_{m}}$$\n电压的实值振幅 $V_{\\text{amp}}(f)$ 是这个复数的模：\n$$V_{\\text{amp}}(f) = |\\tilde{V}_{\\text{amp}}(f)| = \\left|\\frac{R_{m}I_{0}}{1 + j(2\\pi f)\\tau_{m}}\\right| = \\frac{R_{m}I_{0}}{|1 + j(2\\pi f)\\tau_{m}|} = \\frac{R_{m}I_{0}}{\\sqrt{1^{2} + (2\\pi f \\tau_{m})^{2}}}$$\n问题指出，偶极矩振幅 $p_{\\text{amp}}(f)$ 与 $V_{\\text{amp}}(f)$ 线性成正比。因此，$p_{\\text{amp}}(f)$ 的频率依赖性为：\n$$p_{\\text{amp}}(f) \\propto \\frac{1}{\\sqrt{1 + (2\\pi f \\tau_{m})^{2}}}$$\n这个结果表明，无源树突膜起到低通滤波器的作用，衰减较高频率的信号。\n\n接下来，我们讨论头皮脑电图增益。准静态假设意味着头皮电位振幅 $V_{\\text{scalp, amp}}(f)$ 通过一个与频率无关的常数与 $p_{\\text{amp}}(f)$ 成正比。因此，我们有一系列的比例关系：\n$$V_{\\text{scalp, amp}}(f) \\propto p_{\\text{amp}}(f) \\propto V_{\\text{amp}}(f)$$\n脑电图增益定义为输出振幅与输入振幅之比。问题要求的是增益的相对下降，即增益的比值。我们将增益 $G(f)$ 定义为在给定突触驱动振幅 $i_{0}$ 下与头皮电位振幅成正比。由于 $I_{0} \\propto i_{0}$，且所有其他比例常数都与频率无关：\n$$G(f) \\propto \\frac{V_{\\text{scalp, amp}}(f)}{i_{0}} \\propto \\frac{V_{\\text{amp}}(f)}{i_{0}} \\propto \\frac{R_{m}I_{0}}{i_{0}\\sqrt{1 + (2\\pi f \\tau_{m})^{2}}} \\propto \\frac{1}{\\sqrt{1 + (2\\pi f \\tau_{m})^{2}}}$$\n我们需要计算在 $f_{2}=100$ Hz 时的增益与在 $f_{1}=10$ Hz 时的增益之比。\n$$\\text{Ratio} = \\frac{G(f_{2})}{G(f_{1})} = \\frac{C/\\sqrt{1 + (2\\pi f_{2} \\tau_{m})^{2}}}{C/\\sqrt{1 + (2\\pi f_{1} \\tau_{m})^{2}}} = \\sqrt{\\frac{1 + (2\\pi f_{1} \\tau_{m})^{2}}{1 + (2\\pi f_{2} \\tau_{m})^{2}}}$$\n给定的值为：\n$f_{1} = 10\\text{ Hz}$\n$f_{2} = 100\\text{ Hz}$\n$\\tau_{m} = 20\\text{ ms} = 20 \\times 10^{-3}\\text{ s} = 0.02\\text{ s}$\n\n首先，我们计算无量纲乘积 $2\\pi f \\tau_{m}$：\n对于 $f_{1}$：$2\\pi f_{1} \\tau_{m} = 2\\pi(10)(0.02) = 0.4\\pi$\n对于 $f_{2}$：$2\\pi f_{2} \\tau_{m} = 2\\pi(100)(0.02) = 4\\pi$\n\n现在，我们将这些值代入比值表达式：\n$$\\text{Ratio} = \\sqrt{\\frac{1 + (0.4\\pi)^{2}}{1 + (4\\pi)^{2}}} = \\sqrt{\\frac{1 + 0.16\\pi^{2}}{1 + 16\\pi^{2}}}$$\n使用计算器计算数值：\n$$ \\text{Ratio} = \\sqrt{\\frac{1 + 0.16(9.8696...)}{1 + 16(9.8696...)}} = \\sqrt{\\frac{1 + 1.5791...}{1 + 157.9136...}} = \\sqrt{\\frac{2.5791...}{158.9136...}} $$\n$$ \\text{Ratio} \\approx \\sqrt{0.0162295} \\approx 0.127395... $$\n四舍五入到四位有效数字，结果是 $0.1274$。",
            "answer": "$$\\boxed{0.1274}$$"
        },
        {
            "introduction": "在理解了源信号的特性之后，一个关键问题是我们能在多大程度上从头皮外测量到它。本练习将在现实条件下比较脑电图(EEG)和脑磁图(MEG)的信噪比($SNR$) 。通过计算预期信号强度并将其与典型的仪器噪声进行比较，您将对两种技术之间的根本物理差异有定量的理解，并明白为何在特定情境下一种模态可能比另一种更适用。",
            "id": "4142677",
            "problem": "一个基本皮层源被建模为一个矩为 $p = 50\\,\\mathrm{nA\\cdot m}$ 的点电流偶极子，嵌入在一个球对称的欧姆头模型中。头部半径为 $R = 0.09\\,\\mathrm{m}$。对于脑电图（EEG），考虑一个径向偶极子，位于头皮下方皮层深度 $d = 0.015\\,\\mathrm{m}$ 处，测量点在源正上方的头皮上。对于脑磁图（MEG），考虑在相同位置的一个切向偶极子（与局部径向垂直），由一个磁力计测量，该磁力计沿局部径向放置在头皮上方 $s = 0.020\\,\\mathrm{m}$ 的探测距离处。假设脑组织电导率 $\\sigma = 0.33\\,\\mathrm{S/m}$，自由空间磁导率 $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。为捕捉真实的头部物理特性，使用乘法因子 $\\alpha = 0.20$ 来模拟颅骨引起的脑电电位衰减，并对所描述的脑磁图配置，使用几何因子 $\\gamma = 0.15$ 来模拟外部磁场相对于自由空间电流偶极子表达式的减小。\n\n仪器噪声规定如下：在分析带宽内，脑电电极的均方根（RMS）噪声为 $v_{n} = 1\\,\\mathrm{\\mu V}$；脑磁图磁力计的噪声谱密度为 $b_{n0} = 3\\,\\mathrm{fT}/\\sqrt{\\mathrm{Hz}}$，在带宽 $\\Delta f = 40\\,\\mathrm{Hz}$ 上进行分析，因此脑磁图的均方根噪声等于 $b_{n0}\\sqrt{\\Delta f}$。仅使用准静态麦克斯韦方程组、导体中的欧姆定律以及信噪比（SNR）的定义，推导在指定传感器处、针对所述源方向的脑电头皮电位和脑磁图磁场的主阶表达式，并计算特定模态的信噪比：\n- $\\,\\mathrm{SNR}_{\\mathrm{EEG}} = \\dfrac{\\text{EEG 信号幅度}}{v_{n}}$，\n- $\\,\\mathrm{SNR}_{\\mathrm{MEG}} = \\dfrac{\\text{MEG 信号幅度}}{b_{n0}\\sqrt{\\Delta f}}$。\n\n将最终的信噪比数值四舍五入到三位有效数字，并按 $\\left(\\mathrm{SNR}_{\\mathrm{EEG}},\\,\\mathrm{SNR}_{\\mathrm{MEG}}\\right)$ 的顺序以一个二元行矩阵的形式报告。信噪比是无量纲的。然后，根据你的推导，论证哪种模态对指定的源具有更高的可探测性。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定的，并且是客观的。计算所需的所有参数都已提供，并且该场景是神经影像生物物理学中使用的一个标准（尽管简化了）模型。\n\n目标是计算径向皮层源的脑电图（EEG）测量和切向皮层源的脑磁图（MEG）测量的信噪比（SNR），并比较它们的可探测性。\n\n**1. 脑电信号与信噪比计算**\n\n脑电信号的生物物理起源是由同步神经活动产生的体电流，这可以建模为一个电流偶极子 $\\vec{p}$。对于在电导率为 $\\sigma$ 的无限、均匀、导电介质中的一个电流偶极子，在相对于偶极子的位置矢量 $\\vec{r}$ 处的电位 $V$ 由以下公式给出：\n$$\nV(\\vec{r}) = \\frac{1}{4\\pi\\sigma} \\frac{\\vec{p} \\cdot \\vec{r}}{|\\vec{r}|^3}\n$$\n问题指定了一个径向偶极子。脑电电极放置在源正上方的头皮上。这意味着偶极矩矢量 $\\vec{p}$ 和从源到电极的位置矢量 $\\vec{r}$ 是共线的。$\\vec{r}$ 的模是皮层深度 $d$。因此，点积变为 $\\vec{p} \\cdot \\vec{r} = |\\vec{p}| |\\vec{r}| \\cos(0) = p d$。在无限介质中，电位的主阶表达式为：\n$$\nV_{\\infty} = \\frac{1}{4\\pi\\sigma} \\frac{p d}{d^3} = \\frac{p}{4\\pi\\sigma d^2}\n$$\n问题指出，颅骨引起的衰减和其他几何效应由一个乘法因子 $\\alpha$ 建模。因此，头皮处的脑电信号幅度 $V_{\\mathrm{EEG}}$ 为：\n$$\nV_{\\mathrm{EEG}} = \\alpha V_{\\infty} = \\frac{\\alpha p}{4\\pi\\sigma d^2}\n$$\n脑电图的信噪比 $\\mathrm{SNR}_{\\mathrm{EEG}}$ 定义为该信号幅度与均方根噪声电压 $v_{n}$ 的比值：\n$$\n\\mathrm{SNR}_{\\mathrm{EEG}} = \\frac{V_{\\mathrm{EEG}}}{v_{n}} = \\frac{\\alpha p}{4\\pi\\sigma d^2 v_{n}}\n$$\n代入给定值：\n- $p = 50\\,\\mathrm{nA\\cdot m} = 50 \\times 10^{-9}\\,\\mathrm{A\\cdot m}$\n- $\\alpha = 0.20$\n- $\\sigma = 0.33\\,\\mathrm{S/m}$\n- $d = 0.015\\,\\mathrm{m}$\n- $v_{n} = 1\\,\\mathrm{\\mu V} = 1 \\times 10^{-6}\\,\\mathrm{V}$\n\n$$\n\\mathrm{SNR}_{\\mathrm{EEG}} = \\frac{0.20 \\times (50 \\times 10^{-9}\\,\\mathrm{A\\cdot m})}{4\\pi (0.33\\,\\mathrm{S/m}) (0.015\\,\\mathrm{m})^2 (1 \\times 10^{-6}\\,\\mathrm{V})}\n$$\n$$\n\\mathrm{SNR}_{\\mathrm{EEG}} = \\frac{10 \\times 10^{-9}}{4\\pi (0.33) (2.25 \\times 10^{-4}) (1 \\times 10^{-6})} = \\frac{10^{-8}}{9.3283 \\times 10^{-10}} \\approx 10.720\n$$\n四舍五入到三位有效数字，$\\mathrm{SNR}_{\\mathrm{EEG}} \\approx 10.7$。\n\n**2. 脑磁信号与信噪比计算**\n\n脑磁信号的生物物理起源是神经元中初级胞内电流产生的磁场。根据毕奥-萨伐尔定律的准静态形式，来自电流偶极子 $\\vec{p}$ 在位置 $\\vec{r}$ 处的磁场 $\\vec{B}$ 为：\n$$\n\\vec{B}(\\vec{r}) = \\frac{\\mu_0}{4\\pi} \\frac{\\vec{p} \\times \\vec{r}}{|\\vec{r}|^3}\n$$\n其中 $\\mu_0$ 是自由空间的磁导率。对于脑磁图，考虑的是一个切向偶极子，因为在球对称导体中的径向偶极子不会产生外部磁场。设偶极子位于原点，其矩 $\\vec{p}$ 沿 x 轴方向，$\\vec{p} = p\\hat{x}$。传感器位于局部径向（z 轴）上，距离为 $d+s$（深度加探测距离），所以 $\\vec{r} = (d+s)\\hat{z}$。叉积为 $\\vec{p} \\times \\vec{r} = (p\\hat{x}) \\times ((d+s)\\hat{z}) = -p(d+s)\\hat{y}$。磁场矢量 $B_{\\infty}$ 的模为：\n$$\nB_{\\infty} = |\\vec{B}| = \\frac{\\mu_0}{4\\pi} \\frac{|\\vec{p} \\times \\vec{r}|}{|\\vec{r}|^3} = \\frac{\\mu_0}{4\\pi} \\frac{p(d+s)}{(d+s)^3} = \\frac{\\mu_0 p}{4\\pi (d+s)^2}\n$$\n问题使用一个减小因子 $\\gamma$ 来模拟头部几何形状和体电流的影响。脑磁信号幅度为：\n$$\nB_{\\mathrm{MEG}} = \\gamma B_{\\infty} = \\frac{\\gamma \\mu_0 p}{4\\pi (d+s)^2}\n$$\n脑磁图的均方根噪声 $b_n$ 由噪声谱密度 $b_{n0}$ 在分析带宽 $\\Delta f$ 内给出：\n$$\nb_n = b_{n0} \\sqrt{\\Delta f}\n$$\n脑磁图的信噪比 $\\mathrm{SNR}_{\\mathrm{MEG}}$ 为：\n$$\n\\mathrm{SNR}_{\\mathrm{MEG}} = \\frac{B_{\\mathrm{MEG}}}{b_n} = \\frac{\\gamma \\mu_0 p}{4\\pi (d+s)^2 b_{n0} \\sqrt{\\Delta f}}\n$$\n代入给定值：\n- $\\gamma = 0.15$\n- $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n- $p = 50 \\times 10^{-9}\\,\\mathrm{A\\cdot m}$\n- $d = 0.015\\,\\mathrm{m}$\n- $s = 0.020\\,\\mathrm{m}$\n- $b_{n0} = 3\\,\\mathrm{fT}/\\sqrt{\\mathrm{Hz}} = 3 \\times 10^{-15}\\,\\mathrm{T}/\\sqrt{\\mathrm{Hz}}$\n- $\\Delta f = 40\\,\\mathrm{Hz}$\n\n$$\n\\mathrm{SNR}_{\\mathrm{MEG}} = \\frac{0.15 \\times (4\\pi \\times 10^{-7}\\,\\mathrm{H/m}) (50 \\times 10^{-9}\\,\\mathrm{A\\cdot m})}{4\\pi (0.015\\,\\mathrm{m} + 0.020\\,\\mathrm{m})^2 (3 \\times 10^{-15}\\,\\mathrm{T}/\\sqrt{\\mathrm{Hz}}) \\sqrt{40\\,\\mathrm{Hz}}}\n$$\n$4\\pi$ 项相互抵消：\n$$\n\\mathrm{SNR}_{\\mathrm{MEG}} = \\frac{0.15 \\times (10^{-7}) (50 \\times 10^{-9})}{(0.035)^2 (3 \\times 10^{-15}) \\sqrt{40}} = \\frac{7.5 \\times 10^{-16}}{(1.225 \\times 10^{-3}) (3 \\times 10^{-15}) (6.3245...)}\n$$\n$$\n\\mathrm{SNR}_{\\mathrm{MEG}} = \\frac{7.5 \\times 10^{-16}}{2.3216 \\times 10^{-17}} \\approx 32.305\n$$\n四舍五入到三位有效数字，$\\mathrm{SNR}_{\\mathrm{MEG}} \\approx 32.3$。\n\n**3. 比较与结论**\n\n计算出的信噪比为 $\\mathrm{SNR}_{\\mathrm{EEG}} \\approx 10.7$ 和 $\\mathrm{SNR}_{\\mathrm{MEG}} \\approx 32.3$。\n对于指定的源配置，脑磁图产生的信噪比显著高于脑电图（$\\mathrm{SNR}_{\\mathrm{MEG}} > \\mathrm{SNR}_{\\mathrm{EEG}}$）。这表明，对于一个浅层（$d=0.015\\,\\mathrm{m}$）的切向皮层源，在给定的仪器噪声水平下，与相同位置的径向源的脑电图相比，脑磁图提供了更优越的可探测性。\n\n这一结果的物理原因蕴含在推导出的表达式中：\n1.  **电导率依赖性**：脑电信号与头部组织的电导率 $\\sigma$ 成反比。更关键的是，低电导率的颅骨会严重衰减和模糊化电位，这一效应在这里由小的衰减因子 $\\alpha = 0.20$ 捕捉到。相比之下，脑磁图测量的磁场在很大程度上不受颅骨电阻率的影响，因为生物组织的磁导率与自由空间的磁导率几乎相同。\n2.  **源方向**：问题正确地评估了每种模态的优势：脑电图对径向和切向源都敏感，但对于在此建模的径向源的解释最为清晰。脑磁图主要对切向源敏感，因为在球形头部模型中，径向源不产生外部磁场。\n3.  **距离依赖性**：脑磁信号按 $1/(d+s)^2$ 规律衰减，其中包括了仪器探测距离 $s$。脑电信号（在此模型中）按 $1/d^2$ 规律衰减。对于这个浅层源，脑磁图增加的探测距离所带来的劣势，被其不受颅骨衰减影响的优势所弥补而有余。\n\n因此，在这些特定的、现实的条件下，脑磁图展示了更高的可探测性。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 10.7  32.3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "脑磁图(MEG)的灵敏度高度依赖于神经源的方向，这一特性使其与脑电图(EEG)显著不同。这项计算练习将探讨该原理的一个关键推论：来自大脑皮层沟回相对壁上的神经源所产生的磁场会相互抵消 。通过实现一个简单的模拟，您将可视化并量化为何位于沟回中的切向偶极子可能对MEG“不可见”，这是解释MEG数据时的一个关键考量。",
            "id": "4142688",
            "problem": "一个程序必须使用球形头部模型和电磁学的准静态极限，在一个简化的模型中评估位于大脑皮层沟相对壁上的成对切向电流偶极子的磁场抵消。其目标是量化具有相反切向方向的成对偶极子如何减小脑磁图（MEG）外部测量的磁场。计算模型必须遵守以下物理假设和定义：\n\n- 准静态麦克斯韦方程组适用，因此位移电流相对于传导电流可以忽略不计。磁场 $\\mathbf{B}(\\mathbf{r})$ 遵循 $\\nabla \\times \\mathbf{B} = \\mu_{0}\\mathbf{J}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，其中 $\\mathbf{J}$ 是电流密度，$\\mu_{0}$ 是真空磁导率。\n- 主电流源被建模为一个理想电流偶极子，其偶极矩为 $\\mathbf{p}$（单位：安培-米），位于位置 $\\mathbf{r}_{0}$（单位：米），表示为电流密度 $\\mathbf{J}_{p}(\\mathbf{r}) = \\mathbf{p}\\,\\delta(\\mathbf{r} - \\mathbf{r}_{0})$。\n- 头部被建模为半径 $R_{\\text{head}} = 0.09$ 米的球对称导体。由于球对称性和准静态状态，头部外部的磁场与主电流在均匀无限介质中产生的磁场相同。因此，由电流偶极子产生的外部磁场可简化为自由空间中点电流偶极子的 Biot–Savart 表达式。\n\n根据这些假设，位于 $\\mathbf{r}_{0}$ 的单个电流偶极子 $\\mathbf{p}$ 在位置 $\\mathbf{r}$ 处产生的磁场，可通过计算 $\\mathbf{J}_{p}$ 的 Biot–Savart 积分得到，结果为\n$$\n\\mathbf{B}(\\mathbf{r}) \\;=\\; \\frac{\\mu_{0}}{4\\pi}\\,\\frac{\\mathbf{p}\\times(\\mathbf{r}-\\mathbf{r}_{0})}{\\lVert \\mathbf{r}-\\mathbf{r}_{0}\\rVert^{3}}\\quad\\text{for}\\quad \\mathbf{r}\\neq \\mathbf{r}_{0},\n$$\n其中 $\\mu_{0} = 4\\pi\\times 10^{-7}$ 特斯拉-米/安培。\n\n定义一个固定的 MEG 传感器阵列，这些传感器是位于球面半径 $r_{\\text{sens}} = 0.10$ 米的圆环上的点，与 z 轴正方向的极角恒为 $\\theta_{\\text{sens}} = 0.60$ 弧度，方位角为 $\\phi_{k} = \\frac{2\\pi k}{N}$，其中 $k\\in\\{0,1,\\dots,N-1\\}$ 且 $N=16$。传感器的笛卡尔坐标为\n$$\n\\mathbf{r}_{k} \\;=\\; r_{\\text{sens}}\\begin{bmatrix}\n\\cos\\phi_{k}\\,\\sin\\theta_{\\text{sens}} \\\\\n\\sin\\phi_{k}\\,\\sin\\theta_{\\text{sens}} \\\\\n\\cos\\theta_{\\text{sens}}\n\\end{bmatrix}.\n$$\n\n将大脑皮层沟建模为位于相对壁上的两个邻近源位置，它们关于 y-z 平面对称排列，并且在头部内部具有相同的深度 $z=z_{0}$。设沿 x 轴的壁间距为 $d$，则偶极子位置为\n$$\n\\mathbf{r}_{1} \\;=\\; \\begin{bmatrix} d/2 \\\\ 0 \\\\ z_{0}\\end{bmatrix},\\quad\n\\mathbf{r}_{2} \\;=\\; \\begin{bmatrix} -d/2 \\\\ 0 \\\\ z_{0}\\end{bmatrix}.\n$$\n假设在相对的壁上，偶极子沿 y 轴方向且方向相反，因此偶极矩为\n$$\n\\mathbf{p}_{1} \\;=\\; \\begin{bmatrix} 0 \\\\ p_{0} \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{p}_{2} \\;=\\; \\begin{bmatrix} 0 \\\\ -s\\,p_{0} \\\\ 0 \\end{bmatrix},\n$$\n其中 $p_{0}$ 是标称偶极子强度（单位：安培-米），$s$ 是描述壁间振幅不对称性的非负标量。使用 $p_{0} = 1.0\\times 10^{-7}$ 安培-米。\n\n对于每个传感器 $\\mathbf{r}_{k}$，给定偶极子配置产生的总磁场是各个磁场的矢量和。对于每个测试用例，将仅由位于 $\\mathbf{r}_{1}$ 的 $\\mathbf{p}_{1}$ 产生的磁场定义为单偶极子基线，将由位于 $\\mathbf{r}_{1}$ 的 $\\mathbf{p}_{1}$ 和位于 $\\mathbf{r}_{2}$ 的 $\\mathbf{p}_{2}$ 共同产生的磁场定义为成对配置。\n\n对于每个测试用例，计算以下两个标量度量：\n- 抵消比 $C$，定义为成对磁场在传感器环上的最大范数与单偶极子基线磁场最大范数之比：\n$$\nC \\;=\\; \\frac{\\max_{k}\\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k})\\rVert}{\\max_{k}\\lVert \\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k})\\rVert}.\n$$\n- 方向偏差角 $\\alpha$（单位：弧度），在使单偶极子磁场范数最大化的传感器索引 $k^{\\star}$ 处定义：\n$$\nk^{\\star} \\;=\\; \\arg\\max_{k}\\lVert \\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k})\\rVert,\\qquad\n\\alpha \\;=\\; \\arccos\\!\\left(\\frac{\\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k^{\\star}})\\cdot \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})}{\\lVert \\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k^{\\star}})\\rVert\\,\\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})\\rVert}\\right),\n$$\n并约定如果 $\\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})\\rVert = 0$，则设 $\\alpha = 0$。\n\n所有磁场矢量单位为特斯拉，距离单位为米，偶极矩单位为安培-米，角度单位为弧度。$C$ 和 $\\alpha$ 的最终数值输出必须是四舍五入到六位小数的浮点值。\n\n测试套件。使用以下四个参数集，每个参数集指定为 $(d,s,z_{0})$，单位分别为米、无单位和米：\n- 情况 1：$(d,s,z_{0}) = (0.010,\\,1.0,\\,0.060)$\n- 情况 2：$(d,s,z_{0}) = (0.010,\\,0.8,\\,0.060)$\n- 情况 3：$(d,s,z_{0}) = (0.000,\\,1.0,\\,0.060)$\n- 情况 4：$(d,s,z_{0}) = (0.020,\\,1.0,\\,0.030)$\n\n程序要求行为：\n- 实现上述物理模型，为每个测试用例计算 $N=16$ 个传感器处的磁场。\n- 对于每种情况，按定义计算抵消比 $C$ 和方向偏差角 $\\alpha$。\n- 你的程序应生成单行输出，包含结果，格式为逗号分隔的列表的列表，每个内部列表为 $[C,\\alpha]$，按指定用例的顺序排列，每个浮点数四舍五入到六位小数。例如：\"[[c1,a1],[c2,a2],[c3,a3],[c4,a4]]\"。",
            "solution": "我们从电磁学的准静态极限开始，其中位移电流与传导电流相比可以忽略不计。磁场 $\\mathbf{B}(\\mathbf{r})$ 和电流密度 $\\mathbf{J}(\\mathbf{r})$ 遵循基本关系 $\\nabla \\times \\mathbf{B} = \\mu_{0}\\mathbf{J}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$。Biot–Savart 定律给出了由稳恒电流密度 $\\mathbf{J}(\\mathbf{r}')$ 在位置 $\\mathbf{r}$ 处产生的磁场：\n$$\n\\mathbf{B}(\\mathbf{r}) \\;=\\; \\frac{\\mu_{0}}{4\\pi}\\int_{\\mathbb{R}^{3}}\\frac{\\mathbf{J}(\\mathbf{r}')\\times(\\mathbf{r}-\\mathbf{r}')}{\\lVert \\mathbf{r}-\\mathbf{r}'\\rVert^{3}}\\,d^{3}\\mathbf{r}'.\n$$\n位于 $\\mathbf{r}_{0}$ 处、偶极矩为 $\\mathbf{p}$ 的主电流偶极子被建模为 $\\mathbf{J}_{p}(\\mathbf{r}') = \\mathbf{p}\\,\\delta(\\mathbf{r}'-\\mathbf{r}_{0})$。将其代入 Biot–Savart 积分可得\n$$\n\\mathbf{B}_{p}(\\mathbf{r}) \\;=\\; \\frac{\\mu_{0}}{4\\pi}\\,\\frac{\\mathbf{p}\\times(\\mathbf{r}-\\mathbf{r}_{0})}{\\lVert \\mathbf{r}-\\mathbf{r}_{0}\\rVert^{3}},\\quad \\mathbf{r}\\neq \\mathbf{r}_{0}.\n$$\n在真实的头部模型中，次级（体积）电流也存在，但对于准静态状态下的球对称导体，外部磁场仅取决于主电流。这是根据对称性论证以及球体外部磁场不受各向同性电导率影响这一结果得出的，因此外部磁场等于主电流在均匀无限介质中产生的磁场。所以，在头部外部，我们可以使用上述偶极子表达式计算磁场。\n\n我们现在定义用于评估脑沟抵消的几何结构和算法：\n\n1. 头部模型和常数：\n   - 球形头部半径 $R_{\\text{head}} = 0.09$ 米。\n   - 真空磁导率 $\\mu_{0} = 4\\pi\\times 10^{-7}$ 特斯拉-米/安培。\n   - 标称偶极子强度 $p_{0} = 1.0\\times 10^{-7}$ 安培-米。\n\n2. 传感器配置：\n   - 传感器数量 $N = 16$。\n   - 传感器球面半径 $r_{\\text{sens}} = 0.10$ 米。\n   - 极角 $\\theta_{\\text{sens}} = 0.60$ 弧度。\n   - 方位角 $\\phi_{k} = \\frac{2\\pi k}{N}$，其中 $k\\in\\{0,\\dots,N-1\\}$。\n   - 传感器笛卡尔坐标\n     $$\n     \\mathbf{r}_{k} \\;=\\; r_{\\text{sens}}\\begin{bmatrix}\\cos\\phi_{k}\\,\\sin\\theta_{\\text{sens}}\\\\ \\sin\\phi_{k}\\,\\sin\\theta_{\\text{sens}}\\\\ \\cos\\theta_{\\text{sens}}\\end{bmatrix}.\n     $$\n\n3. 每个测试用例的偶极子配置：\n   - 两个偶极子，位置分别为 $\\mathbf{r}_{1} = \\begin{bmatrix} d/2 \\\\ 0 \\\\ z_{0}\\end{bmatrix}$ 和 $\\mathbf{r}_{2} = \\begin{bmatrix} -d/2 \\\\ 0 \\\\ z_{0}\\end{bmatrix}$。\n   - 沿 y 轴的切向矩，方向相反：$\\mathbf{p}_{1} = \\begin{bmatrix} 0 \\\\ p_{0} \\\\ 0 \\end{bmatrix}$ 和 $\\mathbf{p}_{2} = \\begin{bmatrix} 0 \\\\ -s\\,p_{0} \\\\ 0 \\end{bmatrix}$。\n   - 四个测试用例为 $(d,s,z_{0})\\in\\{(0.010,1.0,0.060),(0.010,0.8,0.060),(0.000,1.0,0.060),(0.020,1.0,0.030)\\}$，其中 $d,z_{0}$ 的单位为米，$s$ 无单位。\n\n4. 磁场计算：\n   - 对于每个传感器 $\\mathbf{r}_{k}$ 和偶极子 $(\\mathbf{p},\\mathbf{r}_{0})$，计算\n     $$\n     \\mathbf{B}(\\mathbf{r}_{k};\\mathbf{p},\\mathbf{r}_{0}) \\;=\\; \\frac{\\mu_{0}}{4\\pi}\\,\\frac{\\mathbf{p}\\times(\\mathbf{r}_{k}-\\mathbf{r}_{0})}{\\lVert \\mathbf{r}_{k}-\\mathbf{r}_{0}\\rVert^{3}}.\n     $$\n   - 将单偶极子基线磁场定义为 $\\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k}) = \\mathbf{B}(\\mathbf{r}_{k};\\mathbf{p}_{1},\\mathbf{r}_{1})$。\n   - 将成对磁场定义为 $\\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k}) = \\mathbf{B}(\\mathbf{r}_{k};\\mathbf{p}_{1},\\mathbf{r}_{1}) + \\mathbf{B}(\\mathbf{r}_{k};\\mathbf{p}_{2},\\mathbf{r}_{2})$。\n\n5. 度量：\n   - 计算范数 $b_{\\text{single},k} = \\lVert \\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k})\\rVert$ 和 $b_{\\text{pair},k} = \\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k})\\rVert$。\n   - 令 $b_{\\text{single},\\max} = \\max_{k} b_{\\text{single},k}$ 和 $b_{\\text{pair},\\max} = \\max_{k} b_{\\text{pair},k}$，则\n     $$\n     C \\;=\\; \\frac{b_{\\text{pair},\\max}}{b_{\\text{single},\\max}}.\n     $$\n   - 令 $k^{\\star} = \\arg\\max_{k} b_{\\text{single},k}$。定义角度\n     $$\n     \\alpha \\;=\\; \\begin{cases}\n     \\arccos\\!\\left(\\dfrac{\\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k^{\\star}})\\cdot \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})}{\\lVert \\mathbf{B}_{\\text{single}}(\\mathbf{r}_{k^{\\star}})\\rVert\\,\\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})\\rVert}\\right),  \\text{若 } \\lVert \\mathbf{B}_{\\text{pair}}(\\mathbf{r}_{k^{\\star}})\\rVert > 0 \\\\\n     0,  \\text{其他情况。}\n     \\end{cases}\n     $$\n\n6. 数值计算注意事项：\n   - 通过检查 $\\lVert \\mathbf{r}-\\mathbf{r}_{0}\\rVert > 0$ 来避免除以零。\n   - 在计算 $\\arccos$ 之前，将余弦函数的参数裁剪到区间 $[-1,1]$ 内，以保持数值稳定性。\n\n7. 输出：\n   - 对每个测试用例，生成数值对 $[C,\\alpha]$，两个值都四舍五入到六位小数。\n   - 将所有结果按测试用例的顺序汇总到一个 Python 风格的列表的列表中，并作为单行打印。\n\n该过程通过主电流偶极子将 MEG 信号的生物物理起源操作化，通过叠加位于相对壁上的方向相反的切向源来捕捉脑沟抵消现象，并为具有最大单偶极子响应的传感器提供了振幅减小和方向偏差的定量测量。特定的几何设置确保了科学真实性：源位于头颅球体内，传感器位于外部，偶极子强度在神经元电流偶极子的合理范围内。边界情况，包括零间距 $(d=0)$，用于探究完全抵消行为，而不对称性 $(s=0.8)$ 以及增大的间距或深度则改变了抵消的程度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dipole_field_at_r(r, r0, p, mu0=4e-7*np.pi):\n    \"\"\"\n    Magnetic field at point r due to a current dipole p at r0 in free space:\n    B(r) = mu0/(4*pi) * p x (r - r0) / |r - r0|^3\n    \"\"\"\n    R = r - r0\n    R_norm = np.linalg.norm(R)\n    if R_norm == 0.0:\n        return np.zeros(3)\n    return (mu0 / (4.0 * np.pi)) * np.cross(p, R) / (R_norm**3)\n\ndef generate_sensors(N=16, r_sens=0.10, theta=0.60):\n    \"\"\"\n    Generate N sensors on a ring at radius r_sens and polar angle theta.\n    \"\"\"\n    sensors = []\n    for k in range(N):\n        phi = 2.0 * np.pi * k / N\n        x = r_sens * np.cos(phi) * np.sin(theta)\n        y = r_sens * np.sin(phi) * np.sin(theta)\n        z = r_sens * np.cos(theta)\n        sensors.append(np.array([x, y, z], dtype=float))\n    return np.array(sensors)\n\ndef case_metrics(d, s, z0, sensors, p0=1.0e-7):\n    \"\"\"\n    Compute cancellation ratio C and direction deviation angle alpha (radians)\n    for a given case (d, s, z0).\n    \"\"\"\n    # Dipole locations and moments\n    r1 = np.array([d/2.0, 0.0, z0], dtype=float)\n    r2 = np.array([-d/2.0, 0.0, z0], dtype=float)\n    p1 = np.array([0.0, p0, 0.0], dtype=float)\n    p2 = np.array([0.0, -s * p0, 0.0], dtype=float)\n\n    # Compute fields at sensors\n    B_single = np.array([dipole_field_at_r(r, r1, p1) for r in sensors])\n    B_pair = np.array([dipole_field_at_r(r, r1, p1) + dipole_field_at_r(r, r2, p2) for r in sensors])\n\n    # Norms\n    norms_single = np.linalg.norm(B_single, axis=1)\n    norms_pair = np.linalg.norm(B_pair, axis=1)\n\n    # Max norms and indices\n    idx_max_single = int(np.argmax(norms_single))\n    max_single = norms_single[idx_max_single]\n    max_pair = float(np.max(norms_pair))\n\n    # Cancellation ratio C\n    C = 0.0\n    if max_single > 0.0:\n        C = max_pair / max_single\n    else:\n        C = 0.0  # Convention if single baseline is zero (should not occur with tangential p1)\n\n    # Direction deviation angle alpha at idx_max_single\n    b_single_vec = B_single[idx_max_single]\n    b_pair_vec = B_pair[idx_max_single]\n    norm_single_vec = np.linalg.norm(b_single_vec)\n    norm_pair_vec = np.linalg.norm(b_pair_vec)\n    if norm_pair_vec == 0.0 or norm_single_vec == 0.0:\n        alpha = 0.0\n    else:\n        cosang = float(np.dot(b_single_vec, b_pair_vec) / (norm_single_vec * norm_pair_vec))\n        # Numerical robustness\n        cosang = max(-1.0, min(1.0, cosang))\n        alpha = float(np.arccos(cosang))\n\n    # Round to six decimals\n    C = round(C, 6)\n    alpha = round(alpha, 6)\n    return [C, alpha]\n\ndef solve():\n    # Constants\n    N = 16\n    r_sens = 0.10  # meters\n    theta = 0.60   # radians\n\n    # Sensors\n    sensors = generate_sensors(N=N, r_sens=r_sens, theta=theta)\n\n    # Test cases: (d, s, z0)\n    test_cases = [\n        (0.010, 1.0, 0.060),  # Case 1: symmetric opposite tangential, shallow\n        (0.010, 0.8, 0.060),  # Case 2: asymmetric magnitude\n        (0.000, 1.0, 0.060),  # Case 3: coincident anti-parallel (perfect cancellation)\n        (0.020, 1.0, 0.030),  # Case 4: increased separation, deeper\n    ]\n\n    results = []\n    for d, s, z0 in test_cases:\n        res = case_metrics(d, s, z0, sensors)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Ensure standard Python list-of-lists formatting.\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}