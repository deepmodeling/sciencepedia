{
    "hands_on_practices": [
        {
            "introduction": "基线校正是分析事件相关电位（ERP）时一个标准且看似简单的步骤，旨在消除刺激前的信号波动。然而，理解其内在假设和潜在缺陷至关重要。本练习将通过数学推导，揭示脑电图（EEG）或脑磁图（MEG）数据中常见的缓慢漂移（slow drifts）如何在基线校正后系统性地扭曲振幅估计值。",
            "id": "4160321",
            "problem": "考虑一个在事件相关电位 (ERP) 或事件相关场 (ERF) 实验中，围绕时间点 $0$ 的刺激起始点记录的单变量脑电图时间序列。设观测信号建模为线性叠加 $x(t) = s(t) + o(t) + n(t)$，其中 $s(t)$ 是与刺激锁时的 ERP/ERF 成分，满足当 $t  0$ 时 $s(t) = 0$；$o(t)$ 是一个不严格与刺激锁时的重叠过程（例如，慢漂移或先前事件的残留活动）；$n(t)$ 是零均值随机噪声。基线校正定义为减去观测信号在刺激前区间 $[-T_{b}, 0)$（其中 $T_{b}  0$）上的均值，因此经基线校正的信号为 $y(t) = x(t) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau$。设在某个刺激后时间 $t_{0}  0$ 的幅度估计值为 $y(t_{0})$。\n\n从叠加原理和上述定义出发，推导期望 $\\mathbb{E}[y(t_{0})]$ 关于 $s(t_{0})$ 和 $o(t)$ 的表达式，并将偏差 $b(t_{0})$ 定义为 $\\mathbb{E}[y(t_{0})]$ 与真实锁时刺激幅度 $s(t_{0})$ 之间的差值。然后，在特定的重叠过程模型 $o(t) = \\alpha + \\beta t$（对于所有 $t \\in \\mathbb{R}$，其中 $\\alpha \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$ 是常数）下，明确地计算 $b(t_{0})$。将最终答案表示为关于 $b(t_{0})$ 的单一闭式解析表达式。不需要进行数值近似或四舍五入。",
            "solution": "用户提供的问题陈述已被分析和验证，其在科学上是合理的、良定的且完整的。因此，我们可以着手推导解答。\n\n观测信号被建模为线性叠加：\n$$x(t) = s(t) + o(t) + n(t)$$\n其中 $s(t)$ 是与刺激锁时的信号，$o(t)$ 是一个重叠过程，$n(t)$ 是零均值随机噪声，这意味着对所有 $t$ 都有 $\\mathbb{E}[n(t)] = 0$。已知当 $t  0$ 时，$s(t) = 0$。刺激起始点在 $t=0$。\n\n经基线校正的信号 $y(t)$ 定义为减去信号在刺激前区间 $[-T_{b}, 0)$（其中 $T_{b}  0$）上的均值：\n$$y(t) = x(t) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau$$\n\n目标是确定在刺激后时间 $t_{0}  0$ 时幅度估计值 $y(t_0)$ 的期望。我们首先对 $y(t_0)$ 的表达式取期望：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}\\left[x(t_{0}) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau\\right]$$\n\n根据期望算子的线性性质，我们可以将其分配到各项上：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}[x(t_{0})] - \\mathbb{E}\\left[\\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau\\right]$$\n\n由于积分是线性算子，并假设我们可以交换期望和积分的顺序（根据 Fubini 定理，对于良态随机过程，这个条件通常是满足的），表达式变为：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}[x(t_{0})] - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} \\mathbb{E}[x(\\tau)]\\, d\\tau$$\n\n接下来，我们将 $x(t)$ 的模型代入期望 $\\mathbb{E}[x(t)]$ 中：\n$$\\mathbb{E}[x(t)] = \\mathbb{E}[s(t) + o(t) + n(t)]$$\n再次应用期望的线性性质：\n$$\\mathbb{E}[x(t)] = \\mathbb{E}[s(t)] + \\mathbb{E}[o(t)] + \\mathbb{E}[n(t)]$$\n\n在此模型中，$s(t)$ 和 $o(t)$ 被视为确定性信号，因此它们不受期望算子的影响（即 $\\mathbb{E}[s(t)] = s(t)$ 且 $\\mathbb{E}[o(t)] = o(t)$）。噪声项 $n(t)$ 被定义为零均值，所以 $\\mathbb{E}[n(t)] = 0$。这将观测信号的期望简化为：\n$$\\mathbb{E}[x(t)] = s(t) + o(t)$$\n\n将此结果代回 $\\mathbb{E}[y(t_{0})]$ 的表达式中：\n$$\\mathbb{E}[y(t_{0})] = (s(t_0) + o(t_0)) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} (s(\\tau) + o(\\tau))\\, d\\tau$$\n$$\\mathbb{E}[y(t_{0})] = s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} s(\\tau)\\, d\\tau - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n\n根据问题陈述，与刺激锁时的成分 $s(t)$ 在所有负数时间上均为零，即当 $t  0$ 时 $s(t) = 0$。基线的积分区间是 $[-T_{b}, 0)$，它完全位于该区域内。因此，$s(\\tau)$ 在此区间上的积分为零：\n$$\\int_{-T_{b}}^{0} s(\\tau)\\, d\\tau = \\int_{-T_{b}}^{0} 0\\, d\\tau = 0$$\n\n经基线校正信号的期望值表达式简化为：\n$$\\mathbb{E}[y(t_{0})] = s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n\n偏差 $b(t_0)$ 定义为该期望与真实锁时刺激幅度 $s(t_0)$ 之间的差值：\n$$b(t_{0}) = \\mathbb{E}[y(t_{0})] - s(t_{0})$$\n代入我们推导出的 $\\mathbb{E}[y(t_{0})]$ 表达式：\n$$b(t_{0}) = \\left( s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau \\right) - s(t_0)$$\n$$b(t_{0}) = o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n这个通用表达式表明，偏差是重叠过程在时间 $t_0$ 的值减去其在刺激前基线区间上的平均值。\n\n我们现在的任务是计算当重叠过程是时间的线性函数时的偏差：\n$$o(t) = \\alpha + \\beta t$$\n其中 $\\alpha \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$ 为常数。\n\n首先，我们计算 $o(t_0)$ 的值：\n$$o(t_0) = \\alpha + \\beta t_0$$\n\n其次，我们计算积分项：\n$$\\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau = \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} (\\alpha + \\beta \\tau)\\, d\\tau$$\n计算该定积分：\n$$\\int_{-T_{b}}^{0} (\\alpha + \\beta \\tau)\\, d\\tau = \\left[ \\alpha\\tau + \\frac{\\beta}{2}\\tau^{2} \\right]_{-T_{b}}^{0}$$\n$$= \\left( \\alpha(0) + \\frac{\\beta}{2}(0)^{2} \\right) - \\left( \\alpha(-T_{b}) + \\frac{\\beta}{2}(-T_{b})^{2} \\right)$$\n$$= 0 - \\left( -\\alpha T_{b} + \\frac{\\beta}{2}T_{b}^{2} \\right) = \\alpha T_{b} - \\frac{\\beta}{2}T_{b}^{2}$$\n现在，除以 $T_b$：\n$$\\frac{1}{T_{b}} \\left( \\alpha T_{b} - \\frac{\\beta}{2}T_{b}^{2} \\right) = \\alpha - \\frac{\\beta T_{b}}{2}$$\n\n最后，我们将这些结果代回偏差 $b(t_0)$ 的表达式中：\n$$b(t_{0}) = (\\alpha + \\beta t_0) - \\left(\\alpha - \\frac{\\beta T_{b}}{2}\\right)$$\n$$b(t_{0}) = \\alpha + \\beta t_0 - \\alpha + \\frac{\\beta T_{b}}{2}$$\n$$b(t_{0}) = \\beta t_0 + \\frac{\\beta T_{b}}{2}$$\n这可以写作因式分解形式：\n$$b(t_{0}) = \\beta \\left( t_0 + \\frac{T_{b}}{2} \\right)$$\n这是在线性漂移存在的情况下，应用刺激前基线校正所引入偏差的闭式解析表达式。该偏差与漂移的斜率 $\\beta$ 成正比，并且同时取决于测量时间 $t_0$ 和基线周期时长 $T_b$。常数偏移量 $\\alpha$ 被基线校正过程完全移除。",
            "answer": "$$\\boxed{\\beta \\left(t_{0} + \\frac{T_{b}}{2}\\right)}$$"
        },
        {
            "introduction": "滤波对于提高信噪比至关重要，但它并非一个无损过程。本练习将探讨一个与直觉相悖的效应：即使是旨在避免时间延迟的“零相位”滤波器，也可能通过改变波形形状来移动神经事件的表观时间。你将通过解析推导来揭示这一效应，从而理解滤波对峰值潜伏期估计的微妙影响。",
            "id": "4160331",
            "problem": "在一个事件相关电位 (ERP) 的高信噪比平均中，考虑一个单一的双相成分，其可以局部近似为一个在时间 $t=0$ 处居中的高斯凸包的一阶时间导数。具体来说，将未滤波的成分建模为\n$$\ns(t) \\;=\\; A \\,\\frac{t}{\\sigma_{s}^{2}}\\,\\exp\\!\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big),\n$$\n其中 $A0$ 是一个幅度常数，$\\sigma_{s}0$ 设定了该成分的内在时间尺度。通过将信号与一个对称高斯核进行卷积来施加一个零相位低通滤波器\n$$\nh_{f}(t) \\;=\\; \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{f}}\\,\\exp\\!\\Big(-\\frac{t^{2}}{2\\sigma_{f}^{2}}\\Big),\n$$\n其中 $\\sigma_{f}0$，该滤波器实现平滑处理而无相位延迟。假设处理是线性时不变的，且时间是连续的。\n\n仅使用卷积、线性时不变性和微分的基本性质，推导滤波后波形的解析形式（在忽略一个整体乘法常数的情况下），确定其正波瓣最大值的时间 $t_{\\text{peak}}$，并表示此正波峰相对于未滤波正波峰的潜伏期漂移 $\\Delta t$。然后，对于 $\\sigma_{s} = 20$ 毫秒 和 $\\sigma_{f} = 10$ 毫秒，计算这个漂移。将最终数值答案四舍五入到四位有效数字，并以毫秒为单位表示。只报告以毫秒为单位的潜伏期漂移的数值。",
            "solution": "用户提供了一个需要验证的问题，如果有效，则需要一个完整的解答。\n\n### 第1步：提取已知条件\n- 未滤波信号成分：$s(t) = A \\frac{t}{\\sigma_{s}^{2}}\\exp\\big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\big)$\n- 幅度常数：$A0$\n- 信号的内在时间尺度：$\\sigma_{s}0$\n- 低通滤波器核：$h_{f}(t) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{f}}\\exp\\big(-\\frac{t^{2}}{2\\sigma_{f}^{2}}\\big)$\n- 滤波器的时间尺度：$\\sigma_{f}0$\n- 系统性质：线性时不变 (LTI)，连续时间。\n- 滤波后波形：$y(t) = s(t) * h_{f}(t)$ (卷积)。\n- 任务：\n  1. 推导滤波后波形 $y(t)$ 的解析形式（在忽略一个乘法常数的情况下）。\n  2. 确定 $y(t)$ 正波瓣最大值的时间 $t_{\\text{peak}}$。\n  3. 表示此波峰相对于未滤波正波峰的潜伏期漂移 $\\Delta t$。\n  4. 计算当 $\\sigma_{s} = 20$ 毫秒 且 $\\sigma_{f} = 10$ 毫秒 时的 $\\Delta t$。\n  5. 将 $\\Delta t$ 的最终数值四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n这个问题具有科学依据。ERP成分的模型，即高斯函数的导数，是该领域的标准模型（例如，Gabor 函数，小波）。通过与高斯核进行卷积实现低通滤波是信号处理中的一项基本技术。这个问题是适定的，提供了推导唯一解所需的所有函数和参数。语言客观而精确。该问题没有违反任何指定的无效性标准。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n\n滤波后的波形 $y(t)$ 是信号 $s(t)$ 和滤波器核 $h_{f}(t)$ 的卷积：\n$$\ny(t) = s(t) * h_{f}(t) = \\int_{-\\infty}^{\\infty} s(\\tau) h_{f}(t-\\tau) d\\tau\n$$\n为解决此问题，我们首先将信号 $s(t)$ 表示为一种更方便的形式。我们定义一个方差为 $\\sigma_{s}^{2}$、单位幅度的 Gaussian 函数 $g_{s}(t)$：\n$$\ng_{s}(t) = \\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big)\n$$\n$g_{s}(t)$ 的一阶时间导数是：\n$$\n\\frac{d}{dt}g_{s}(t) = \\frac{d}{dt}\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big) = \\Big(-\\frac{2t}{2\\sigma_{s}^{2}}\\Big)\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big) = -\\frac{t}{\\sigma_{s}^{2}}\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big)\n$$\n通过将其与给定的 $s(t)$ 表达式进行比较，我们可以用 $g_{s}(t)$ 的导数来表示 $s(t)$：\n$$\ns(t) = A \\frac{t}{\\sigma_{s}^{2}}\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big) = -A \\left( -\\frac{t}{\\sigma_{s}^{2}}\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{s}^{2}}\\Big) \\right) = -A \\frac{d}{dt}g_{s}(t)\n$$\n现在，我们可以将其代入 $y(t)$ 的卷积积分中：\n$$\ny(t) = \\left(-A \\frac{d}{dt}g_{s}(t)\\right) * h_{f}(t)\n$$\n对于 LTI 系统，卷积的一个基本性质是微分与卷积运算可以交换：$(\\frac{d}{dt} f) * g = \\frac{d}{dt} (f * g)$。应用此性质，我们得到：\n$$\ny(t) = -A \\frac{d}{dt} \\Big( g_{s}(t) * h_{f}(t) \\Big)\n$$\n下一步是计算两个高斯函数 $g_{s}(t)$ 和 $h_{f}(t)$ 的卷积。两个高斯函数的卷积是另一个高斯函数。所得高斯函数的方差是两个被卷积高斯函数方差的和。\n$$\n\\sigma_{sf}^{2} = \\sigma_{s}^{2} + \\sigma_{f}^{2}\n$$\n由于 $g_{s}(t)$ 和 $h_{f}(t)$ 都以 $t=0$ 为中心，它们的卷积也以 $t=0$ 为中心。因此，卷积乘积 $g_{s}(t) * h_{f}(t)$ 是一个形式为 $C \\exp\\big(-\\frac{t^{2}}{2\\sigma_{sf}^{2}}\\big)$ 的高斯函数，其中 $C$ 是一个常数。由于问题要求形式在忽略一个乘法常数的情况下，我们可以写成：\n$$\ng_{s}(t) * h_{f}(t) \\propto \\exp\\Big(-\\frac{t^{2}}{2(\\sigma_{s}^{2} + \\sigma_{f}^{2})}\\Big) = \\exp\\Big(-\\frac{t^{2}}{2\\sigma_{sf}^{2}}\\Big)\n$$\n将此代回 $y(t)$ 的表达式中，我们得到滤波后波形的解析形式：\n$$\ny(t) \\propto \\frac{d}{dt} \\exp\\Big(-\\frac{t^{2}}{2\\sigma_{sf}^{2}}\\Big) = \\Big(-\\frac{t}{\\sigma_{sf}^{2}}\\Big)\\exp\\Big(-\\frac{t^{2}}{2\\sigma_{sf}^{2}}\\Big)\n$$\n由于我们关心的是正波瓣（对于 $t  0$），并且整体符号只是乘法常数的一部分，所以滤波后波形的函数形式是：\n$$\ny(t) \\propto t \\exp\\Big(-\\frac{t^{2}}{2(\\sigma_{s}^{2} + \\sigma_{f}^{2})}\\Big)\n$$\n\n接下来，我们确定未滤波和已滤波信号的正波瓣最大值的时间。对于形式为 $f(t) = K t \\exp(-\\frac{t^2}{2\\sigma^2})$ 的通用信号，其最大值可以通过将其导数设为零来找到：\n$$\n\\frac{df}{dt} = K \\left[ \\exp\\Big(-\\frac{t^2}{2\\sigma^2}\\Big) + t \\Big(-\\frac{t}{\\sigma^{2}}\\Big)\\exp\\Big(-\\frac{t^2}{2\\sigma^2}\\Big) \\right] = 0\n$$\n$$\nK \\exp\\Big(-\\frac{t^2}{2\\sigma^2}\\Big) \\left[ 1 - \\frac{t^2}{\\sigma^2} \\right] = 0\n$$\n由于 $K \\neq 0$ 且指数项始终为正，极值的条件是 $1 - \\frac{t^2}{\\sigma^2} = 0$，这给出 $t^2 = \\sigma^2$。对于正波瓣，我们取正根，$t_{\\text{peak}} = \\sigma$。\n\n对于未滤波的信号 $s(t)$，参数 $\\sigma$ 对应于 $\\sigma_s$。因此，未滤波正波瓣的峰值时间是：\n$$\nt_{\\text{peak, s}} = \\sigma_{s}\n$$\n对于滤波后的信号 $y(t)$，函数形式相同，但方差参数是 $\\sigma_{sf}^{2} = \\sigma_{s}^{2} + \\sigma_{f}^{2}$。因此，有效的 $\\sigma$ 是 $\\sigma_{sf} = \\sqrt{\\sigma_{s}^{2} + \\sigma_{f}^{2}}$。滤波后正波瓣的峰值时间，在问题中表示为 $t_{\\text{peak}}$，是：\n$$\nt_{\\text{peak}} = t_{\\text{peak, y}} = \\sigma_{sf} = \\sqrt{\\sigma_{s}^{2} + \\sigma_{f}^{2}}\n$$\n潜伏期漂移 $\\Delta t$ 是滤波信号的峰值时间与未滤波信号的峰值时间之差：\n$$\n\\Delta t = t_{\\text{peak, y}} - t_{\\text{peak, s}} = \\sqrt{\\sigma_{s}^{2} + \\sigma_{f}^{2}} - \\sigma_{s}\n$$\n这是潜伏期漂移的一般表达式。\n\n最后，我们使用给定的值 $\\sigma_{s} = 20$ 毫秒 和 $\\sigma_{f} = 10$ 毫秒 来计算这个漂移。\n$$\n\\Delta t = \\sqrt{(20 \\text{ ms})^{2} + (10 \\text{ ms})^{2}} - 20 \\text{ ms}\n$$\n$$\n\\Delta t = \\sqrt{400 + 100} \\text{ ms} - 20 \\text{ ms} = \\sqrt{500} \\text{ ms} - 20 \\text{ ms}\n$$\n$$\n\\Delta t = \\sqrt{100 \\times 5} \\text{ ms} - 20 \\text{ ms} = 10\\sqrt{5} \\text{ ms} - 20 \\text{ ms}\n$$\n现在，我们计算数值：\n$$\n\\sqrt{5} \\approx 2.236067977...\n$$\n$$\n\\Delta t \\approx (10 \\times 2.236067977 - 20) \\text{ ms} = (22.36067977 - 20) \\text{ ms} = 2.36067977 \\text{ ms}\n$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t \\approx 2.361 \\text{ ms}\n$$\n问题只要求提供数值。",
            "answer": "$$\\boxed{2.361}$$"
        },
        {
            "introduction": "在掌握了基本信号处理后，我们将转向一个具体而关键的挑战：去除如眼动等大幅度伪迹。本练习从线性代数的角度，对比了两种强大的伪迹去除方法——信号空间投影（SSP）和独立成分分析（ICA）。你将计算每种方法在去除伪迹时，会意外移除多少我们感兴趣的神经信号（即“信号泄漏”），从而揭示数据清洗过程中固有的权衡与选择。",
            "id": "4160391",
            "problem": "您正在分析脑磁图（MEG）的事件相关场（ERFs），并希望去除眼动伪影。考虑一个单一条件，其中传感器空间的数据矩阵为 $X \\in \\mathbb{R}^{M \\times T}$，有 $M$ 个传感器和 $T$ 个时间样本。假设以下设置基于线性建模和基本的线性代数定义。\n\n1. MEG传感器数据可以表示为潜源的线性瞬时混合加上噪声，即 $X = A S + E$，其中 $A \\in \\mathbb{R}^{M \\times Q}$ 是混合矩阵，$S \\in \\mathbb{R}^{Q \\times T}$ 包含源时间序列，$E$ 是传感器噪声。眼动伪影张成一个 k 维子空间 $\\mathcal{N} \\subset \\mathbb{R}^{M}$，而在峰值延迟处感兴趣的事件相关场具有单位范数的空间拓扑 $v \\in \\mathbb{R}^{M}$。\n\n2. 信号空间投影（SSP）将眼动伪影建模为局限于 $\\mathcal{N}$ 中，并通过投影到其正交补空间 $\\mathcal{N}^{\\perp}$上来去除它。设 $U \\in \\mathbb{R}^{M \\times k}$ 的列是标准正交的，张成 $\\mathcal{N}$，并假设 $U^{\\top}U = I_{k}$。该投影从左侧应用于传感器数据。请仅使用线性子空间、正交补空间、正交投影和矩阵秩的定义，来推导这种投影如何影响数据矩阵的秩以及诱发拓扑 $v$ 的保留功率分数。\n\n3. 独立成分分析（ICA）识别出一个眼动独立成分，其混合向量为 $a \\in \\mathbb{R}^{M}$，且 $\\|a\\|_{2} = 1$。在传感器空间中移除该 ICA 成分，对应于减去沿向量 $a$ 的贡献。请仅使用线性投影和正交性的定义，来表示移除 ICA 成分后 $v$ 的保留功率分数。\n\n使用以下科学上合理的数值：\n- 传感器维度: $M = 306$。\n- 原始数据矩阵的秩: $\\operatorname{rank}(X) = r_{X} = 140$。\n- 眼动子空间维度: $k = 2$。\n- 眼动伪影的标准正交基: $U = [u_{1}, u_{2}]$，其中 $u_{1}, u_{2} \\in \\mathbb{R}^{M}$ 且 $u_{i}^{\\top} u_{j} = \\delta_{ij}$。\n- 诱发拓扑是单位范数: $\\|v\\|_{2} = 1$。\n- 与眼动基的内积: $v^{\\top} u_{1} = 0.5$ 且 $v^{\\top} u_{2} = 0.4$。\n- ICA 眼动混合向量单位范数: $\\|a\\|_{2} = 1$ 且 $v^{\\top} a = 0.3$。\n\n任务：\n(a) 从第一性原理出发，推导 $\\operatorname{rank}(P_{\\perp} X)$ 关于 $r_{X}$、$M$ 和 $k$ 的表达式，其中 $P_{\\perp}$ 是实现 SSP 的正交投影算子。根据上面给出的数值计算该秩。\n(b) 仅使用投影和正交性的定义，推导经过 SSP 处理后 $v$ 的保留功率分数（用 $v^{\\top} u_{1}$ 和 $v^{\\top} u_{2}$ 表示），并进行数值计算。\n(c) 推导在通过 ICA 去除混合向量为 $a$ 的单个眼动成分后，$v$ 的保留功率分数（用 $v^{\\top} a$ 表示），并进行数值计算。\n(d) 最后，使用上述数值计算 $v$ 经 SSP 处理后保留的功率与经 ICA 处理后保留的功率之比 $R$。\n\n将最终答案表示为单个实数值 $R$，四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "该问题要求基于线性代数原理，分析脑磁图（MEG）中两种常见的伪影校正技术：信号空间投影（SSP）和独立成分分析（ICA）。我们将依次解决这四个任务。\n\n首先，我们解决任务（a），该任务要求计算应用 SSP 后数据矩阵 $X$ 的秩。SSP 方法将数据投影到伪影子空间 $\\mathcal{N}$ 的正交补空间上。伪影子空间 $\\mathcal{N}$ 是 k 维的，由矩阵 $U \\in \\mathbb{R}^{M \\times k}$ 的标准正交列张成。投影到 $\\mathcal{N}$ 上的正交投影算子是 $P = UU^{\\top}$，这里我们利用了 $U^{\\top}U = I_k$ 这一事实。因此，投影到正交补空间 $\\mathcal{N}^{\\perp}$ 上的 SSP 投影算子由 $P_{\\perp} = I - P = I - UU^{\\top}$ 给出。\n\n经过 SSP 处理后的数据矩阵是 $P_{\\perp}X$。我们需要求它的秩，即 $\\operatorname{rank}(P_{\\perp}X)$。一个矩阵的秩是其列空间（也称为值域）的维度。$P_{\\perp}X$ 的列空间是所有形如 $P_{\\perp}y$ 的向量集合，其中 $y$ 位于 $X$ 的列空间中，记作 $\\operatorname{col}(X)$。令 $\\mathcal{C} = \\operatorname{col}(X)$。$P_{\\perp}X$ 的秩是子空间 $P_{\\perp}(\\mathcal{C})$ 的维度。\n\n对限制在子空间 $\\mathcal{C}$ 上的线性映射 $P_{\\perp}$ 使用秩-零度定理，我们有：\n$$\n\\dim(\\mathcal{C}) = \\dim(\\ker(P_{\\perp}|_{\\mathcal{C}})) + \\dim(\\operatorname{Im}(P_{\\perp}|_{\\mathcal{C}}))\n$$\n项 $\\dim(\\mathcal{C})$ 是原始数据矩阵的秩，给定为 $r_X = \\operatorname{rank}(X)$。项 $\\dim(\\operatorname{Im}(P_{\\perp}|_{\\mathcal{C}}))$ 是 $\\mathcal{C}$ 在 $P_{\\perp}$ 映射下的像的维度，这正是我们想要求的秩 $\\operatorname{rank}(P_{\\perp}X)$。作用于 $\\mathcal{C}$ 上的 $P_{\\perp}$ 的核，是 $\\mathcal{C}$ 中被投影到零的向量集合，即完全位于伪影子空间 $\\mathcal{N}$ 内的向量。因此，$\\ker(P_{\\perp}|_{\\mathcal{C}}) = \\mathcal{C} \\cap \\mathcal{N}$。\n这给出了关系式：\n$$\n\\operatorname{rank}(P_{\\perp}X) = \\operatorname{rank}(X) - \\dim(\\operatorname{col}(X) \\cap \\mathcal{N}) = r_X - \\dim(\\mathcal{C} \\cap \\mathcal{N})\n$$\n问题没有明确说明数据列空间与伪影子空间交集的维度。然而，为了使问题是适定的并且有一个唯一的数值解，我们必须推断一个合理的假设。SSP 的前提是待去除的伪影存在于数据中。这意味着伪影子空间 $\\mathcal{N}$ 与数据的信号空间 $\\mathcal{C} = \\operatorname{col}(X)$ 有着很大的交集。最直接和标准的假设是伪影子空间完全包含在数据的列空间内，即 $\\mathcal{N} \\subset \\mathcal{C}$。鉴于 $r_X = 140$ 远大于 $k=2$，这个假设是合理的。在此假设下，$\\mathcal{C} \\cap \\mathcal{N} = \\mathcal{N}$，因此 $\\dim(\\mathcal{C} \\cap \\mathcal{N}) = \\dim(\\mathcal{N}) = k$。\n秩的表达式变为：\n$$\n\\operatorname{rank}(P_{\\perp}X) = r_X - k\n$$\n使用提供的数值 $r_X = 140$ 和 $k=2$，我们求得秩为：\n$$\n\\operatorname{rank}(P_{\\perp}X) = 140 - 2 = 138\n$$\n\n对于任务（b），我们推导经 SSP 处理后诱发拓扑向量 $v$ 的保留功率分数。原始功率与 $\\|v\\|_2^2$ 成正比。应用 SSP 投影算子 $P_{\\perp}$ 后，新的拓扑为 $v' = P_{\\perp}v$。保留的功率与 $\\|v'\\|_2^2$ 成正比。保留功率的分数为 $\\|v'\\|_2^2 / \\|v\\|_2^2$。\n鉴于 $v$ 具有单位范数，即 $\\|v\\|_2 = 1$，此分数就是 $\\|v'\\|_2^2$。\n$$\nv' = P_{\\perp}v = (I - UU^{\\top})v = v - UU^{\\top}v\n$$\n向量 $UU^{\\top}v$ 是 $v$ 在子空间 $\\mathcal{N}$ 上的正交投影。向量 $v'$ 是 $v$ 在 $\\mathcal{N}^{\\perp}$ 上的正交投影。根据勾股定理，$\\|v\\|^2 = \\|P_{\\perp}v\\|^2 + \\|Pv\\|^2$，这意味着 $\\|v'\\|^2 = \\|v\\|^2 - \\|UU^{\\top}v\\|^2$。\n让我们计算被剔除部分的范数：\n$$\n\\|UU^{\\top}v\\|^2 = (UU^{\\top}v)^{\\top}(UU^{\\top}v) = v^{\\top}U(U^{\\top}U)U^{\\top}v\n$$\n由于 $U$ 的列是标准正交的，所以 $U^{\\top}U = I_k$。\n$$\n\\|UU^{\\top}v\\|^2 = v^{\\top}UI_kU^{\\top}v = v^{\\top}UU^{\\top}v\n$$\n矩阵 $U$ 被给定为 $U = [u_1, u_2]$。因此，$U^{\\top}v = \\begin{pmatrix} u_1^{\\top}v \\\\ u_2^{\\top}v \\end{pmatrix}$。\n$$\n\\|UU^{\\top}v\\|^2 = (v^{\\top}U)(U^{\\top}v) = [v^{\\top}u_1, v^{\\top}u_2] \\begin{pmatrix} v^{\\top}u_1 \\\\ v^{\\top}u_2 \\end{pmatrix} = (v^{\\top}u_1)^2 + (v^{\\top}u_2)^2\n$$\n因此，保留功率的分数为 $\\|v'\\|^2 = \\|v\\|^2 - ((v^{\\top}u_1)^2 + (v^{\\top}u_2)^2)$。根据 $\\|v\\|_2=1$ 和给定的内积 $v^{\\top}u_1 = 0.5$ 和 $v^{\\top}u_2 = 0.4$，我们得到：\n$$\n\\text{Fraction}_{\\text{SSP}} = 1 - (0.5^2 + 0.4^2) = 1 - (0.25 + 0.16) = 1 - 0.41 = 0.59\n$$\n\n对于任务（c），我们分析基于 ICA 的伪影去除效果。移除一个混合向量为 $a$ 的单个成分，等价于将数据投影到与 $a$ 正交的子空间上。这是 SSP 的一个特例，其中 $k=1$，伪影子空间的基是单个向量 $a$。\n给定 $\\|a\\|_2 = 1$，投影到由 $a$ 张成的直线上的投影算子是 $P_a = aa^{\\top}$。移除此成分的投影算子是 $P_{a^{\\perp}} = I - aa^{\\top}$。\n经过基于 ICA 的清洗后的拓扑是 $v'' = P_{a^{\\perp}}v$。保留功率的分数是 $\\|v''\\|_2^2 / \\|v\\|_2^2$。由于 $\\|v\\|_2=1$，这个分数就是 $\\|v''\\|_2^2$。\n$$\n\\|v''\\|^2 = \\|(I - aa^{\\top})v\\|^2\n$$\n使用与（b）部分相同的逻辑，这等于：\n$$\n\\|v''\\|^2 = \\|v\\|^2 - \\|aa^{\\top}v\\|^2 = 1 - (v^{\\top}a)^2\n$$\n使用给定值 $v^{\\top}a = 0.3$：\n$$\n\\text{Fraction}_{\\text{ICA}} = 1 - (0.3)^2 = 1 - 0.09 = 0.91\n$$\n\n最后，对于任务（d），我们计算拓扑 $v$ 经 SSP 处理后保留的功率与经 ICA 处理后保留的功率之比 $R$。\n$$\nR = \\frac{\\text{Fraction}_{\\text{SSP}}}{\\text{Fraction}_{\\text{ICA}}}\n$$\n使用（b）和（c）部分计算出的值：\n$$\nR = \\frac{0.59}{0.91} \\approx 0.648351648\n$$\n四舍五入到四位有效数字，我们得到 $R = 0.6484$。",
            "answer": "$$\\boxed{0.6484}$$"
        }
    ]
}