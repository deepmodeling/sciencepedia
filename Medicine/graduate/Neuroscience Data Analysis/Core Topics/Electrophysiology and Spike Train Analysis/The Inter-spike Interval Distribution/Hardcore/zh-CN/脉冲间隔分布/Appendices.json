{
    "hands_on_practices": [
        {
            "introduction": "均匀泊松过程是描述神经脉冲序列最核心的基准模型，其关键假设是脉冲发放的无记忆性，这直接导出了脉冲间期（ISI）服从指数分布的结论。本练习  将指导您应用最大似然估计（MLE）原理，从一组观测到的ISI数据中推导出模型发放率 $\\lambda$ 的估计量。通过这个过程，您不仅将得到符合直觉的估计结果，还将学会如何利用费雪信息（Fisher Information）来量化该估计量的不确定性，为后续更复杂的统计推断奠定坚实基础。",
            "id": "4200038",
            "problem": "在平稳条件下观察一个孤立的神经元，因此，在一个长记录窗口内的脉冲序列可以被建模为时间上的齐次泊松过程。在此模型下，脉冲间间隔（ISI），定义为连续脉冲之间的时间，是独立同分布（i.i.d.）的指数随机变量，其速率参数 $\\lambda$ 未知，概率密度函数为 $f(\\tau;\\lambda) = \\lambda \\exp(-\\lambda \\tau)$，其中 $\\tau \\ge 0$。您收集了 $n$ 个观测到的ISI $\\tau_1,\\tau_2,\\ldots,\\tau_n$，并假设它们遵循这个独立同分布的指数模型。\n\n从独立性假设和指数概率密度出发，使用最大似然原理推导速率参数 $\\lambda$ 的最大似然估计（MLE），并用ISI的样本均值表示。然后，基于 $n$ 个独立同分布的ISI计算 $\\lambda$ 的费雪信息（Fisher information），并利用标准的大样本MLE理论，得到MLE的渐近方差，作为 $n$ 和 $\\lambda$ 的函数。\n\n请将您的最终答案表示为一个单行向量，按顺序包含：仅用ISI样本均值表示的 $\\lambda$ 的MLE、基于 $n$ 个样本的 $\\lambda$ 的费雪信息，以及MLE的渐近方差。不需要数值近似。在最终的方框答案中不要包含单位。",
            "solution": "问题陈述经评估有效。它在科学上基于计算神经科学和统计推断的标准理论框架，特别是使用泊松过程对神经元脉冲序列进行建模。该问题定义明确、客观、自成一体，并要求进行标准的、可验证的数学推导。不存在不一致、模糊或事实错误。\n\n根据要求，解答过程分三个阶段进行：推导最大似然估计（MLE）、计算费雪信息以及确定MLE的渐近方差。\n\n设 $n$ 个独立同分布（i.i.d.）的脉冲间间隔（ISI）样本为 $\\mathcal{D} = \\{\\tau_1, \\tau_2, \\ldots, \\tau_n\\}$。单个ISI $\\tau$ 的概率密度函数（PDF）由指数分布给出：\n$$f(\\tau; \\lambda) = \\lambda \\exp(-\\lambda \\tau), \\quad \\tau \\ge 0$$\n其中 $\\lambda$ 是未知的速率参数。\n\n**1. $\\lambda$ 的最大似然估计（MLE）**\n\n似然函数 $L(\\lambda; \\mathcal{D})$ 是观测到给定样本的联合概率密度。由于独立同分布的假设，它是各个PDF的乘积：\n$$L(\\lambda; \\mathcal{D}) = \\prod_{i=1}^{n} f(\\tau_i; \\lambda) = \\prod_{i=1}^{n} \\lambda \\exp(-\\lambda \\tau_i)$$\n$$L(\\lambda; \\mathcal{D}) = \\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)$$\n为了找到MLE，数学上更方便的是最大化对数似然函数 $\\ell(\\lambda; \\mathcal{D}) = \\ln(L(\\lambda; \\mathcal{D}))$，因为对数是严格递增函数。\n$$\\ell(\\lambda; \\mathcal{D}) = \\ln\\left(\\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)\\right)$$\n$$\\ell(\\lambda; \\mathcal{D}) = \\ln(\\lambda^n) + \\ln\\left(\\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)\\right)$$\n$$\\ell(\\lambda; \\mathcal{D}) = n \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} \\tau_i$$\n为了找到使 $\\ell(\\lambda)$ 最大化的 $\\lambda$ 值，我们计算关于 $\\lambda$ 的一阶导数，将其设为零，然后求解 $\\lambda$。\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda}\\left(n \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} \\tau_i\\right) = \\frac{n}{\\lambda} - \\sum_{i=1}^{n} \\tau_i$$\n将导数设为零，得到：\n$$\\frac{n}{\\hat{\\lambda}} - \\sum_{i=1}^{n} \\tau_i = 0$$\n其中 $\\hat{\\lambda}$ 表示MLE。求解 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^{n} \\tau_i}$$\nISI的样本均值定义为 $\\bar{\\tau} = \\frac{1}{n} \\sum_{i=1}^{n} \\tau_i$。我们可以用 $\\bar{\\tau}$ 来表示 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{n}{n \\bar{\\tau}} = \\frac{1}{\\bar{\\tau}}$$\n为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{d\\lambda^2} = \\frac{d}{d\\lambda}\\left(\\frac{n}{\\lambda} - \\sum_{i=1}^{n} \\tau_i\\right) = -\\frac{n}{\\lambda^2}$$\n由于 $n  0$ 且 $\\lambda^2  0$，二阶导数恒为负，这证实了 $\\hat{\\lambda} = 1/\\bar{\\tau}$ 确实是最大似然估计。\n\n**2. 费雪信息**\n\n费雪信息量化了可观测随机变量所携带的关于未知参数的信息量。对于 $n$ 个独立同分布的观测，总费雪信息 $I_n(\\lambda)$ 是单个观测的费雪信息 $I_1(\\lambda)$ 的 $n$ 倍。\n$$I_n(\\lambda) = n I_1(\\lambda)$$\n单个观测的费雪信息 $I_1(\\lambda)$ 可以计算为单次观测对数似然函数二阶导数的负期望值：\n$$I_1(\\lambda) = -E\\left[\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda)\\right]$$\n单个观测 $\\tau$ 的对数似然函数是：\n$$\\ln f(\\tau; \\lambda) = \\ln(\\lambda) - \\lambda \\tau$$\n关于 $\\lambda$ 的一阶导数是：\n$$\\frac{\\partial}{\\partial\\lambda} \\ln f(\\tau; \\lambda) = \\frac{1}{\\lambda} - \\tau$$\n二阶导数是：\n$$\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda) = -\\frac{1}{\\lambda^2}$$\n这个二阶导数相对于随机变量 $\\tau$ 是一个常数。因此，它的期望就是它本身：\n$$E\\left[\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda)\\right] = E\\left[-\\frac{1}{\\lambda^2}\\right] = -\\frac{1}{\\lambda^2}$$\n将此代入 $I_1(\\lambda)$ 的公式中：\n$$I_1(\\lambda) = -\\left(-\\frac{1}{\\lambda^2}\\right) = \\frac{1}{\\lambda^2}$$\n因此，$n$ 个观测的总费雪信息是：\n$$I_n(\\lambda) = n I_1(\\lambda) = \\frac{n}{\\lambda^2}$$\n\n**3. MLE的渐近方差**\n\n根据最大似然估计的大样本理论，对于大样本 $n$，MLE $\\hat{\\lambda}$ 的抽样分布近似为均值为 $\\lambda$、方差为费雪信息逆矩阵的正态分布。这也是Cramér-Rao下界，MLE渐近地达到此界。\n渐近方差为：\n$$\\text{Var}(\\hat{\\lambda}) \\approx [I_n(\\lambda)]^{-1}$$\n使用上一节中 $I_n(\\lambda)$ 的结果：\n$$\\text{Var}(\\hat{\\lambda}) \\approx \\left(\\frac{n}{\\lambda^2}\\right)^{-1} = \\frac{\\lambda^2}{n}$$\n\n因此，所要求的三个量是：\n1. $\\lambda$ 的MLE：$\\hat{\\lambda} = \\frac{1}{\\bar{\\tau}}$\n2. $n$ 个样本的费雪信息：$I_n(\\lambda) = \\frac{n}{\\lambda^2}$\n3. MLE的渐近方差：$\\text{Var}(\\hat{\\lambda}) = \\frac{\\lambda^2}{n}$\n这些量将以一个单行向量的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\bar{\\tau}}  \\frac{n}{\\lambda^2}  \\frac{\\lambda^2}{n}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际的电生理记录中，数据采集窗口的长度是有限的，这意味着记录经常在某个脉冲间期（ISI）尚未结束时就终止了。这种不完整的观测被称为“右删失”，如果处理不当，会系统性地低估平均ISI，从而高估神经元发放率。本练习  将教您如何修正似然函数，从而能够严谨地整合完全观测到的ISI和右删失的ISI，这是从有限实验数据中获得无偏估计的一项至关重要的实用技能。",
            "id": "4199999",
            "problem": "在一个有限的时间窗口内记录一个神经元。识别尖峰并测量尖峰间期（ISI；Inter-Spike Interval），直到记录在一个进行中的时间间隔内终止，产生一个右删失观测：观察到从最后一个尖峰到记录终止所经过的时间，但下一个尖峰没有在记录期间内发生。假设这是一个更新过程，其尖峰间期是独立同分布的，概率密度函数为 $f(t \\mid \\boldsymbol{\\theta})$，生存函数为 $S(t \\mid \\boldsymbol{\\theta}) = 1 - F(t \\mid \\boldsymbol{\\theta})$，其中 $F$ 是累积分布函数。\n\n从区间独立性的定义、完整尖峰间期的密度以及右删失时长的生存函数出发，推导包含 $n$ 个完整尖峰间期 $t_{1},\\dots,t_{n}$ 和一个长度为 $\\tau_{\\text{cens}}$ 的右删失最终区间的似然函数 $L(\\boldsymbol{\\theta})$。然后，将其特化为一个指数更新模型，其速率参数为 $\\lambda$，使得 $f(t \\mid \\lambda) = \\lambda \\exp(-\\lambda t)$ 且 $S(t \\mid \\lambda) = \\exp(-\\lambda t)$。以闭合形式推导最大似然估计量（Maximum Likelihood Estimation, MLE）$\\hat{\\lambda}$。\n\n最后，将你的结果应用于以下完整尖峰间期数据集（单位为秒）：$t_{1} = 0.102$，$t_{2} = 0.087$，$t_{3} = 0.094$，$t_{4} = 0.110$，以及一个长度为 $\\tau_{\\text{cens}} = 0.060$ 秒的右删失最终区间。计算该数据集下 $\\hat{\\lambda}$ 的数值。将答案四舍五入到四位有效数字。以赫兹（Hz）为单位表示答案，但不要在最终的方框答案中包含单位。",
            "solution": "该问题陈述具有科学依据，提法恰当且客观。它提供了一个神经数据统计建模中的标准问题，特别是在更新过程背景下处理右删失数据。所有必要的信息都已提供，并且问题内部逻辑一致。因此，该问题是有效的，将推导其解。\n\n推导过程分三个阶段：首先，构建删失和非删失数据的通用似然函数；其次，将此似然函数特化为指数分布；第三，推导指数速率参数的最大似然估计量（MLE），并针对给定数据进行计算。\n\n设观测数据集为 $n$ 个完整观测到的尖峰间期（ISI）$t_1, t_2, \\dots, t_n$，以及一个持续时间为 $\\tau_{\\text{cens}}$ 的右删失区间。该过程被假设为一个更新过程，这意味着尖峰间期是独立同分布（i.i.d.）的随机变量。持续时间为 $t$ 的尖峰间期的概率密度函数（PDF）为 $f(t \\mid \\boldsymbol{\\theta})$，生存函数为 $S(t \\mid \\boldsymbol{\\theta})$，其中 $\\boldsymbol{\\theta}$ 是模型参数的向量。\n\n似然函数 $L(\\boldsymbol{\\theta})$ 是观测数据的联合概率，被视为 $\\boldsymbol{\\theta}$ 的函数。由于各区间的独立性，总似然是每个观测贡献的乘积。\n对于一个完整观测到的尖峰间期 $t_i$，其对似然的贡献是其概率密度 $f(t_i \\mid \\boldsymbol{\\theta})$。\n对于右删失区间 $\\tau_{\\text{cens}}$，观测到的是该区间的真实持续时间 $T$ 大于 $\\tau_{\\text{cens}}$。此事件的概率由生存函数给出，$P(T  \\tau_{\\text{cens}}) = S(\\tau_{\\text{cens}} \\mid \\boldsymbol{\\theta})$。\n\n因此，通用似然函数是 $n$ 个完整区间的密度与一个删失区间的生存概率的乘积：\n$$L(\\boldsymbol{\\theta}) = \\left( \\prod_{i=1}^{n} f(t_i \\mid \\boldsymbol{\\theta}) \\right) S(\\tau_{\\text{cens}} \\mid \\boldsymbol{\\theta})$$\n\n接下来，我们将其特化为指数更新模型。对于此模型，参数是速率 $\\lambda$，因此 $\\boldsymbol{\\theta} = \\lambda$。PDF 和生存函数如下所示：\n$$f(t \\mid \\lambda) = \\lambda \\exp(-\\lambda t)$$\n$$S(t \\mid \\lambda) = \\exp(-\\lambda t)$$\n将这些代入通用似然函数，得到：\n$$L(\\lambda) = \\left( \\prod_{i=1}^{n} \\left[ \\lambda \\exp(-\\lambda t_i) \\right] \\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n简化乘积：\n$$L(\\lambda) = \\lambda^n \\left( \\prod_{i=1}^{n} \\exp(-\\lambda t_i) \\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n指数的乘积等于各指数之和的指数：\n$$L(\\lambda) = \\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n$$L(\\lambda) = \\lambda^n \\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right)$$\n\n为了找到 $\\lambda$ 的 MLE，我们最大化 $L(\\lambda)$。这等同于最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$，后者在分析上通常更简单。\n$$\\ell(\\lambda) = \\ln\\left[ \\lambda^n \\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right) \\right]$$\n利用对数的性质：\n$$\\ell(\\lambda) = \\ln(\\lambda^n) + \\ln\\left(\\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right)\\right)$$\n$$\\ell(\\lambda) = n \\ln(\\lambda) - \\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)$$\n为了找到最大值，我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求导，并令结果为零。\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda} \\left[ n \\ln(\\lambda) - \\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right) \\right] = \\frac{n}{\\lambda} - \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)$$\n为求 MLE $\\hat{\\lambda}$，将导数设为零：\n$$\\frac{n}{\\hat{\\lambda}} - \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right) = 0$$\n解出 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}}}$$\n这个结果在直觉上是令人满意的：估计的速率是观测到的事件（尖峰）数量除以总观测时间，总观测时间包括所有完整的区间和最后一个删失区间。\n\n最后，我们将此公式应用于给定的数据集：\n完整区间的数量，$n=4$。\n完整的尖峰间期（单位：秒）：$t_1 = 0.102$，$t_2 = 0.087$，$t_3 = 0.094$，$t_4 = 0.110$。\n右删失区间（单位：秒）：$\\tau_{\\text{cens}} = 0.060$。\n\n首先，我们计算完整尖峰间期的持续时间之和：\n$$\\sum_{i=1}^{4} t_i = 0.102 + 0.087 + 0.094 + 0.110 = 0.393$$\n分母中的总时间是所有观测到的持续时间之和：\n$$\\sum_{i=1}^{4} t_i + \\tau_{\\text{cens}} = 0.393 + 0.060 = 0.453$$\n现在，我们可以计算 MLE $\\hat{\\lambda}$ 的值：\n$$\\hat{\\lambda} = \\frac{4}{0.453} \\approx 8.830022...$$\n问题要求将结果四舍五入到四位有效数字。\n$$\\hat{\\lambda} \\approx 8.830$$\n$\\hat{\\lambda}$ 的单位是秒的倒数（$s^{-1}$），即赫兹（Hz）。",
            "answer": "$$\\boxed{8.830}$$"
        }
    ]
}