{
    "hands_on_practices": [
        {
            "introduction": "我们从分析神经元发放模式最基础的模型——泊松过程——开始。这个练习将指导你使用最大似然估计（Maximum Likelihood Estimation, MLE）这一基本统计原理，从观测到的脉冲间期（Inter-Spike Intervals, ISIs）数据中推断出潜在的神经元发放率。通过推导发放率 $\\lambda$ 的估计量，并计算其Fisher信息和渐近方差，你将掌握如何量化模型参数估计的精度和可靠性，这是定量神经科学研究中的一项核心技能 。",
            "id": "4200038",
            "problem": "在稳态条件下观察一个单个孤立的神经元，其在长记录窗口内的脉冲序列可以被建模为时间上的齐次泊松过程。在此模型下，峰间期 (ISI)——定义为连续脉冲之间的时间——是独立同分布 (i.i.d.) 的指数随机变量，其未知率参数为 $\\lambda$，概率密度函数为 $f(\\tau;\\lambda) = \\lambda \\exp(-\\lambda \\tau)$（对于 $\\tau \\ge 0$）。您收集了 $n$ 个观测到的 ISI $\\tau_1,\\tau_2,\\ldots,\\tau_n$，并假设它们遵循此独立同分布的指数模型。\n\n从独立性假设和指数概率密度出发，使用最大似然原理推导率参数 $\\lambda$ 的最大似然估计量 (MLE)，并用 ISI 的样本均值表示。然后，基于 $n$ 个独立同分布的 ISI 计算 $\\lambda$ 的费雪信息，并使用标准的大样本 MLE 理论，以 $n$ 和 $\\lambda$ 的函数形式，求得 MLE 的渐近方差。\n\n将您的最终答案表示为一个单行向量，按顺序包含：仅用 ISI 样本均值表示的 $\\lambda$ 的 MLE、基于 $n$ 个样本的 $\\lambda$ 的费雪信息，以及 MLE 的渐近方差。不需要数值近似。最终的答案框中不要包含单位。",
            "solution": "经评估，问题陈述有效。其科学基础在于计算神经科学和统计推断的标准理论框架，特别是使用泊松过程对神经元脉冲序列进行建模。该问题定义明确、客观、自洽，并要求进行标准的、可验证的数学推导。不存在不一致、歧义或事实错误。\n\n解答过程按要求分三步进行：推导最大似然估计量 (MLE)，计算费雪信息，以及确定 MLE 的渐近方差。\n\n设 $n$ 个独立同分布 (i.i.d.) 的峰间期 (ISI) 样本为 $\\mathcal{D} = \\{\\tau_1, \\tau_2, \\ldots, \\tau_n\\}$。单个 ISI $\\tau$ 的概率密度函数 (PDF) 由指数分布给出：\n$$f(\\tau; \\lambda) = \\lambda \\exp(-\\lambda \\tau), \\quad \\tau \\ge 0$$\n其中 $\\lambda$ 是未知的率参数。\n\n**1. $\\lambda$ 的最大似然估计量 (MLE)**\n\n似然函数 $L(\\lambda; \\mathcal{D})$ 是观测到给定样本的联合概率密度。根据独立同分布的假设，它是各个 PDF 的乘积：\n$$L(\\lambda; \\mathcal{D}) = \\prod_{i=1}^{n} f(\\tau_i; \\lambda) = \\prod_{i=1}^{n} \\lambda \\exp(-\\lambda \\tau_i)$$\n$$L(\\lambda; \\mathcal{D}) = \\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)$$\n为了找到 MLE，数学上更方便的是最大化对数似然函数 $\\ell(\\lambda; \\mathcal{D}) = \\ln(L(\\lambda; \\mathcal{D}))$，因为对数函数是严格单调递增的。\n$$\\ell(\\lambda; \\mathcal{D}) = \\ln\\left(\\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)\\right)$$\n$$\\ell(\\lambda; \\mathcal{D}) = \\ln(\\lambda^n) + \\ln\\left(\\exp\\left(-\\lambda \\sum_{i=1}^{n} \\tau_i\\right)\\right)$$\n$$\\ell(\\lambda; \\mathcal{D}) = n \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} \\tau_i$$\n为了找到使 $\\ell(\\lambda)$ 最大化的 $\\lambda$ 值，我们计算其关于 $\\lambda$ 的一阶导数，将其设为零，然后求解 $\\lambda$。\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda}\\left(n \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} \\tau_i\\right) = \\frac{n}{\\lambda} - \\sum_{i=1}^{n} \\tau_i$$\n将导数设为零，得到：\n$$\\frac{n}{\\hat{\\lambda}} - \\sum_{i=1}^{n} \\tau_i = 0$$\n其中 $\\hat{\\lambda}$ 表示 MLE。求解 $\\hat{\\lambda}$：\n$$\\frac{n}{\\hat{\\lambda}} = \\sum_{i=1}^{n} \\tau_i \\implies \\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^{n} \\tau_i}$$\nISI 的样本均值定义为 $\\bar{\\tau} = \\frac{1}{n} \\sum_{i=1}^{n} \\tau_i$。我们可以用 $\\bar{\\tau}$ 来表示 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{n}{n \\bar{\\tau}} = \\frac{1}{\\bar{\\tau}}$$\n为了确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{d\\lambda^2} = \\frac{d}{d\\lambda}\\left(\\frac{n}{\\lambda} - \\sum_{i=1}^{n} \\tau_i\\right) = -\\frac{n}{\\lambda^2}$$\n由于 $n  0$ 且 $\\lambda^2  0$，二阶导数恒为负，这证实了 $\\hat{\\lambda} = 1/\\bar{\\tau}$ 确实是一个最大似然估计。\n\n**2. 费雪信息**\n\n费雪信息量化了一个可观测随机变量所包含的关于未知参数的信息量。对于 $n$ 个独立同分布的观测，总费雪信息 $I_n(\\lambda)$ 是单个观测的费雪信息 $I_1(\\lambda)$ 的 $n$ 倍。\n$$I_n(\\lambda) = n I_1(\\lambda)$$\n单个观测的费雪信息 $I_1(\\lambda)$ 可以通过计算单观测对数似然函数二阶导数的负期望值来获得：\n$$I_1(\\lambda) = -E\\left[\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda)\\right]$$\n单个观测 $\\tau$ 的对数似然函数为：\n$$\\ln f(\\tau; \\lambda) = \\ln(\\lambda) - \\lambda \\tau$$\n关于 $\\lambda$ 的一阶导数是：\n$$\\frac{\\partial}{\\partial\\lambda} \\ln f(\\tau; \\lambda) = \\frac{1}{\\lambda} - \\tau$$\n二阶导数是：\n$$\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda) = -\\frac{1}{\\lambda^2}$$\n这个二阶导数相对于随机变量 $\\tau$ 是一个常数。因此，它的期望就是这个常数本身：\n$$E\\left[\\frac{\\partial^2}{\\partial\\lambda^2} \\ln f(\\tau; \\lambda)\\right] = E\\left[-\\frac{1}{\\lambda^2}\\right] = -\\frac{1}{\\lambda^2}$$\n将此代入 $I_1(\\lambda)$ 的公式中：\n$$I_1(\\lambda) = -\\left(-\\frac{1}{\\lambda^2}\\right) = \\frac{1}{\\lambda^2}$$\n因此，对于 $n$ 个观测，总费雪信息为：\n$$I_n(\\lambda) = n I_1(\\lambda) = \\frac{n}{\\lambda^2}$$\n\n**3. MLE 的渐近方差**\n\n根据最大似然估计量的标准大样本理论，当 $n$ 很大时，MLE $\\hat{\\lambda}$ 的抽样分布近似为正态分布，其均值为 $\\lambda$，方差由费雪信息的倒数给出。这也是克拉美-拉奥下界 (Cramér-Rao lower bound)，MLE 在渐近情况下能够达到此界。\n渐近方差为：\n$$\\text{Var}(\\hat{\\lambda}) \\approx [I_n(\\lambda)]^{-1}$$\n使用上一节中 $I_n(\\lambda)$ 的结果：\n$$\\text{Var}(\\hat{\\lambda}) \\approx \\left(\\frac{n}{\\lambda^2}\\right)^{-1} = \\frac{\\lambda^2}{n}$$\n\n因此，所要求的三个量是：\n1. $\\lambda$ 的 MLE: $\\hat{\\lambda} = \\frac{1}{\\bar{\\tau}}$\n2. $n$ 个样本的费雪信息: $I_n(\\lambda) = \\frac{n}{\\lambda^2}$\n3. MLE 的渐近方差: $\\text{Var}(\\hat{\\lambda}) = \\frac{\\lambda^2}{n}$\n这些量需要以单行向量的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\bar{\\tau}}  \\frac{n}{\\lambda^2}  \\frac{\\lambda^2}{n}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的电生理实验中，记录时间总是有限的，这会导致最后一个脉冲间期可能在记录结束时仍未完成，从而产生“右删失”数据。这个练习将教你如何处理这种常见的数据不完整性问题，通过将删失观测的生存函数（survival function）纳入似然函数中，来修正你的模型估计。掌握这项技术对于从有限的实验数据中获得无偏的、精确的模型参数至关重要 。",
            "id": "4199999",
            "problem": "在一个有限的时间窗口内记录单个神经元。识别尖峰并测量峰间期（ISI; Inter-Spike Interval），直到记录在一个进行中的时间间隔内终止，从而产生一个右删失观测：从最后一个尖峰到记录终止所经过的时间被观测到，但下一个尖峰并未在记录期间内发生。假设这是一个更新过程，其峰间期是独立同分布的，概率密度函数为 $f(t \\mid \\boldsymbol{\\theta})$，生存函数为 $S(t \\mid \\boldsymbol{\\theta}) = 1 - F(t \\mid \\boldsymbol{\\theta})$，其中 $F$ 是累积分布函数。\n\n从区间独立性的定义、已完成峰间期的密度以及右删失时长的生存函数出发，推导包含 $n$ 个已完成的峰间期 $t_{1},\\dots,t_{n}$ 和一个长度为 $\\tau_{\\text{cens}}$ 的右删失最终区间的似然函数 $L(\\boldsymbol{\\theta})$。然后，将其特化为一个率参数为 $\\lambda$ 的指数更新模型，使得 $f(t \\mid \\lambda) = \\lambda \\exp(-\\lambda t)$ 且 $S(t \\mid \\lambda) = \\exp(-\\lambda t)$。推导最大似然估计（Maximum Likelihood Estimation, MLE）$\\hat{\\lambda}$ 的闭式解。\n\n最后，将您的结果应用于以下已完成峰间期（单位：秒）的数据集：$t_{1} = 0.102$, $t_{2} = 0.087$, $t_{3} = 0.094$, $t_{4} = 0.110$，以及一个长度为 $\\tau_{\\text{cens}} = 0.060$ 秒的右删失最终区间。计算该数据集下 $\\hat{\\lambda}$ 的数值。将您的答案四舍五入到四位有效数字。以赫兹（Hz）为单位表示答案，但不要在最终的方框答案中包含单位。",
            "solution": "该问题陈述具有科学依据，表述清晰且客观。它提供了一个神经数据统计建模中的标准问题，特别是在更新过程背景下处理右删失数据。所有必要信息均已提供，且问题内部一致。因此，该问题是有效的，将推导其解法。\n\n推导过程分三个阶段：首先，构建删失和非删失数据的通用似然函数；其次，将此似然函数特化为指数分布；第三，推导指数率参数的最大似然估计（MLE）并为给定数据计算其值。\n\n设观测集为 $n$ 个完全观测到的峰间期（ISI）$t_1, t_2, \\dots, t_n$ 和一个持续时间为 $\\tau_{\\text{cens}}$ 的右删失区间。该过程被假定为一个更新过程，意味着峰间期是独立同分布（i.i.d.）的随机变量。持续时间为 $t$ 的峰间期的概率密度函数（PDF）为 $f(t \\mid \\boldsymbol{\\theta})$，生存函数为 $S(t \\mid \\boldsymbol{\\theta})$，其中 $\\boldsymbol{\\theta}$ 是模型参数的向量。\n\n似然函数 $L(\\boldsymbol{\\theta})$ 是观测数据的联合概率，被视为 $\\boldsymbol{\\theta}$ 的函数。由于各区间的独立性，总似然是每次观测贡献的乘积。\n对于一个完全观测到的峰间期 $t_i$，其对似然的贡献是其概率密度 $f(t_i \\mid \\boldsymbol{\\theta})$。\n对于右删失区间 $\\tau_{\\text{cens}}$，观测到的是该区间的真实持续时间 $T$ 大于 $\\tau_{\\text{cens}}$。此事件的概率由生存函数给出，$P(T  \\tau_{\\text{cens}}) = S(\\tau_{\\text{cens}} \\mid \\boldsymbol{\\theta})$。\n\n因此，通用似然函数是 $n$ 个已完成区间的密度与一个删失区间的生存概率的乘积：\n$$L(\\boldsymbol{\\theta}) = \\left( \\prod_{i=1}^{n} f(t_i \\mid \\boldsymbol{\\theta}) \\right) S(\\tau_{\\text{cens}} \\mid \\boldsymbol{\\theta})$$\n\n接下来，我们将其特化为指数更新模型。对于此模型，参数是率 $\\lambda$，所以 $\\boldsymbol{\\theta} = \\lambda$。PDF 和生存函数如下所示：\n$$f(t \\mid \\lambda) = \\lambda \\exp(-\\lambda t)$$\n$$S(t \\mid \\lambda) = \\exp(-\\lambda t)$$\n将这些代入通用似然函数，得到：\n$$L(\\lambda) = \\left( \\prod_{i=1}^{n} \\left[ \\lambda \\exp(-\\lambda t_i) \\right] \\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n简化乘积：\n$$L(\\lambda) = \\lambda^n \\left( \\prod_{i=1}^{n} \\exp(-\\lambda t_i) \\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n指数的乘积等于指数的和的指数函数：\n$$L(\\lambda) = \\lambda^n \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right) \\exp(-\\lambda \\tau_{\\text{cens}})$$\n$$L(\\lambda) = \\lambda^n \\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right)$$\n\n为了找到 $\\lambda$ 的最大似然估计，我们最大化 $L(\\lambda)$。这等同于最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$，后者在分析上通常更简单。\n$$\\ell(\\lambda) = \\ln\\left[ \\lambda^n \\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right) \\right]$$\n利用对数的性质：\n$$\\ell(\\lambda) = \\ln(\\lambda^n) + \\ln\\left(\\exp\\left(-\\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)\\right)\\right)$$\n$$\\ell(\\lambda) = n \\ln(\\lambda) - \\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)$$\n为了求最大值，我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求导，并令结果为零。\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda} \\left[ n \\ln(\\lambda) - \\lambda \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right) \\right] = \\frac{n}{\\lambda} - \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right)$$\n为求最大似然估计 $\\hat{\\lambda}$，令导数为零：\n$$\\frac{n}{\\hat{\\lambda}} - \\left( \\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}} \\right) = 0$$\n求解 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^{n} t_i + \\tau_{\\text{cens}}}$$\n这个结果在直觉上是令人满意的：估计的率是观测到的事件（尖峰）数除以总观测时间，总观测时间包括所有已完成的区间和最后的删失区间。\n\n最后，我们将此公式应用于给定的数据集：\n已完成区间的数量，$n=4$。\n已完成的峰间期（单位：秒）：$t_1 = 0.102$，$t_2 = 0.087$，$t_3 = 0.094$，$t_4 = 0.110$。\n右删失区间（单位：秒）：$\\tau_{\\text{cens}} = 0.060$。\n\n首先，我们计算已完成峰间期的持续时间总和：\n$$\\sum_{i=1}^{4} t_i = 0.102 + 0.087 + 0.094 + 0.110 = 0.393$$\n分母中的总时间是所有观测到的持续时间的总和：\n$$\\sum_{i=1}^{4} t_i + \\tau_{\\text{cens}} = 0.393 + 0.060 = 0.453$$\n现在，我们可以计算最大似然估计 $\\hat{\\lambda}$ 的值：\n$$\\hat{\\lambda} = \\frac{4}{0.453} \\approx 8.830022...$$\n问题要求将结果四舍五入到四位有效数字。\n$$\\hat{\\lambda} \\approx 8.830$$\n$\\hat{\\lambda}$ 的单位是秒的倒数（$s^{-1}$），即赫兹（Hz）。",
            "answer": "$$\\boxed{8.830}$$"
        },
        {
            "introduction": "虽然指数分布是描述脉冲间期的默认模型，但它是否总是最佳选择？更复杂的模型（如伽马分布）是否能更好地捕捉数据的特征？本练习将引导你应用似然比检验（Likelihood Ratio Test, LRT），这是一个强大的统计工具，用于在嵌套模型之间进行选择。通过编程实现对指数模型（作为零假设）与伽马模型（作为备择假设）的比较，你将学会如何基于数据做出严谨的模型选择决策，这是从参数估计迈向高级统计推断的关键一步 。",
            "id": "4200088",
            "problem": "您将获得多组峰间期（Inter-Spike Interval, ISI）测量数据，每组数据代表在平稳条件下单个神经元连续神经脉冲之间的时间间隔，这些时间间隔是独立同分布的。所有 ISI 的单位均为秒，且必须视为严格为正的实数。您的任务是，使用似然比检验（Likelihood Ratio Test, LRT）以编程方式实现一个有原则的假设检验，用于比较 ISI 的指数更新模型和伽马更新模型。该检验应基于独立性假设下的似然性第一性原理推导得出。\n\n从以下基本概念开始：\n- 连续随机变量的概率密度函数定义以及观测的独立性，这意味着似然是密度的乘积，对数似然是对数密度的和。\n- 速率参数为 $\\lambda$ 的指数模型是形状参数为 $k=1$ 的伽马模型的一个特例。\n- 最大似然估计（Maximum Likelihood Estimation, MLE）通过最大化关于模型参数的对数似然函数来执行。\n- 似然比检验（LRT）统计量定义为 $T = 2(\\ell_{\\text{alt}} - \\ell_{\\text{null}})$，其中 $\\ell$ 表示在相应模型下最大化的对数似然。在正则性条件下，并且当零假设模型嵌套在备择模型中且自由参数数量相差一个时，LRT 统计量渐近服从自由度为 1 的卡方随机变量分布。\n\n需要实现的任务：\n1.  对于每组 ISI 数据集 $\\{x_i\\}_{i=1}^n$（单位为秒），从第一性原理推导指数模型下的对数似然，并获得其参数的 MLE。在 MLE 处评估最大化对数似然 $\\ell_{\\text{exp}}$。\n2.  对于每组 ISI 数据集 $\\{x_i\\}_{i=1}^n$（单位为秒），从第一性原理推导伽马模型下的对数似然，并获得其参数的 MLE。这需要基于对数似然的导数，使用一种一致且收敛的数值方法来求解形状参数方程。在 MLE 处评估最大化对数似然 $\\ell_{\\text{gamma}}$。\n3.  为每组数据集计算 LRT 统计量 $T = 2(\\ell_{\\text{gamma}} - \\ell_{\\text{exp}})$。\n4.  在零假设（即 ISI 服从指数分布，等价于形状参数 $k=1$ 的伽马分布）下，通过计算自由度为 1 的卡方分布下的尾部概率（即 p 值 $p = \\Pr(\\chi^2_1 \\ge T)$）来评估显著性。\n5.  使用显著性水平 $\\alpha=0.05$，为每个数据集返回一个布尔决策，决定是否拒绝零假设。如果 $p  \\alpha$，则拒绝。\n\n物理单位要求：\n- 所有 ISI 的单位均为秒。无需进行单位转换。除 ISI 本身为以秒为单位的输入值外，所有结果均以无单位形式报告。\n\n角度单位要求：\n- 不适用。\n\n百分比要求：\n- 如果出现任何类似比例的量，必须表示为小数值。\n\n测试套件：\n为以下 ISI 数据集提供结果（每个值的单位均为秒）：\n- 测试用例 1 (典型的非规则性发放，类似指数分布): [0.012, 0.033, 0.078, 0.041, 0.052, 0.090, 0.005, 0.061, 0.045, 0.066, 0.031, 0.084, 0.057, 0.049, 0.022, 0.073, 0.038, 0.059, 0.047, 0.055]。\n- 测试用例 2 (比指数分布更规则，类似伽马分布，$k1$): [0.023, 0.071, 0.041, 0.064, 0.089, 0.055, 0.050, 0.082, 0.035, 0.058, 0.062, 0.046, 0.074, 0.069, 0.039, 0.053, 0.067, 0.101, 0.044, 0.060]。\n- 测试用例 3 (小样本量，非规则): [0.040, 0.061, 0.018, 0.079, 0.052]。\n- 测试用例 4 (高度规则性发放): [0.048, 0.051, 0.050, 0.049, 0.052, 0.047, 0.053, 0.050, 0.051, 0.049]。\n\n最终输出格式：\n- 对于每个测试用例，输出一个子列表 `[T, p, decision]`，其中 `T` 是 LRT 统计量，`p` 是在 $\\chi^2_1$ 分布下的 p 值，`decision` 是一个布尔值，如果零假设在 $\\alpha=0.05$ 水平下被拒绝，则为 `True`，否则为 `False`。\n- 将 `T` 和 `p` 四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如：`[[T_1,p_1,decision_1], [T_2,p_2,decision_2], ...]`。",
            "solution": "所述问题是有效的。它在计算神经科学和统计推断的原理上具有科学依据，特别是针对神经脉冲序列的建模问题。该问题定义明确，提供了清晰的目标、所有必要的数据和常量（模型、检验统计量、显著性水平），并且没有歧义或矛盾。它代表了数据分析中一个标准的、可形式化的任务。\n\n在此，将逐步介绍推导和求解方法。\n\n### 1. 模型构建与最大似然估计 (MLE)\n\n任务的核心是比较两种用于描述峰间期（ISI）的嵌套概率模型，数据集表示为 $\\{x_i\\}_{i=1}^n$。\n\n#### 1.1. 零假设 ($H_0$): 指数更新模型\n\n指数分布由单个速率参数 $\\lambda  0$ 表征。其概率密度函数 (PDF) 为：\n$$ f(x | \\lambda) = \\lambda e^{-\\lambda x} $$\n对于一组 $n$ 个独立同分布 (i.i.d.) 的观测值 $\\{x_i\\}$，似然函数 $L(\\lambda)$ 是各个密度的乘积：\n$$ L(\\lambda | \\{x_i\\}) = \\prod_{i=1}^n \\lambda e^{-\\lambda x_i} = \\lambda^n e^{-\\lambda \\sum_{i=1}^n x_i} $$\n在计算上，使用对数似然 $\\ell(\\lambda) = \\ln L(\\lambda)$ 更为方便：\n$$ \\ell(\\lambda) = n \\ln(\\lambda) - \\lambda \\sum_{i=1}^n x_i $$\n为了找到 $\\lambda$ 的最大似然估计 (MLE)，我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求导并令其为零：\n$$ \\frac{d\\ell}{d\\lambda} = \\frac{n}{\\lambda} - \\sum_{i=1}^n x_i = 0 $$\n解出 $\\lambda$ 得到 MLE $\\hat{\\lambda}$：\n$$ \\hat{\\lambda} = \\frac{n}{\\sum_{i=1}^n x_i} = \\frac{1}{\\bar{x}} $$\n其中 $\\bar{x}$ 是样本均值。将 $\\hat{\\lambda}$ 代入对数似然函数，得到指数模型下的最大化对数似然 $\\ell_{\\text{exp}}$：\n$$ \\ell_{\\text{exp}} = \\ell(\\hat{\\lambda}) = n \\ln(\\hat{\\lambda}) - \\hat{\\lambda} \\sum_{i=1}^n x_i = n \\ln\\left(\\frac{1}{\\bar{x}}\\right) - \\frac{1}{\\bar{x}} (n\\bar{x}) = -n \\ln(\\bar{x}) - n $$\n\n#### 1.2. 备择假设 ($H_1$): 伽马更新模型\n\n伽马分布是一个更通用的模型，有两个参数：形状参数 $k  0$ 和尺度参数 $\\theta  0$。其 PDF 为：\n$$ f(x | k, \\theta) = \\frac{1}{\\Gamma(k)\\theta^k} x^{k-1} e^{-x/\\theta} $$\n其中 $\\Gamma(k)$ 是伽马函数。对于 $n$ 个 i.i.d. 观测值，对数似然为：\n$$ \\ell(k, \\theta) = \\sum_{i=1}^n \\left[ (k-1)\\ln(x_i) - \\frac{x_i}{\\theta} - k\\ln(\\theta) - \\ln(\\Gamma(k)) \\right] $$\n$$ \\ell(k, \\theta) = (k-1)\\sum_{i=1}^n \\ln(x_i) - \\frac{1}{\\theta}\\sum_{i=1}^n x_i - nk\\ln(\\theta) - n\\ln(\\Gamma(k)) $$\n为求 MLE，我们分别对 $\\theta$ 和 $k$ 取偏导数并令其为零。\n$$ \\frac{\\partial\\ell}{\\partial\\theta} = \\frac{1}{\\theta^2}\\sum_{i=1}^n x_i - \\frac{nk}{\\theta} = 0 \\implies \\sum_{i=1}^n x_i = nk\\theta $$\n由此得到关于 $k$ 和数据的 $\\theta$ 的 MLE：\n$$ \\hat{\\theta} = \\frac{\\sum x_i}{nk} = \\frac{\\bar{x}}{k} $$\n接下来，对 $k$ 求偏导：\n$$ \\frac{\\partial\\ell}{\\partial k} = \\sum_{i=1}^n \\ln(x_i) - n\\ln(\\theta) - n\\psi(k) = 0 $$\n其中 $\\psi(k) = \\frac{d}{dk}\\ln(\\Gamma(k))$ 是双伽马函数。将 $\\hat{\\theta} = \\bar{x}/k$ 代入此方程，得到关于 $k$ 的 MLE $\\hat{k}$ 的方程：\n$$ \\sum_{i=1}^n \\ln(x_i) - n\\ln\\left(\\frac{\\bar{x}}{k}\\right) - n\\psi(k) = 0 $$\n$$ \\frac{1}{n}\\sum_{i=1}^n \\ln(x_i) - \\ln(\\bar{x}) + \\ln(k) - \\psi(k) = 0 $$\n$$ \\ln(k) - \\psi(k) = \\ln(\\bar{x}) - \\overline{\\ln(x)} $$\n其中 $\\overline{\\ln(x)}$ 是对数转换后数据的样本均值。这个关于 $\\hat{k}$ 的方程没有闭式解，必须通过数值方法求解，例如使用牛顿法。一旦求得 $\\hat{k}$，就可以计算 $\\hat{\\theta} = \\bar{x}/\\hat{k}$。然后，最大化对数似然 $\\ell_{\\text{gamma}}$ 为：\n$$ \\ell_{\\text{gamma}} = \\ell(\\hat{k}, \\hat{\\theta}) = (\\hat{k}-1)\\sum_{i=1}^n\\ln(x_i) - \\frac{n\\bar{x}}{\\hat{\\theta}} - n\\hat{k}\\ln(\\hat{\\theta}) - n\\ln(\\Gamma(\\hat{k})) $$\n\n### 2. 似然比检验 (LRT)\n\n指数分布是伽马分布在形状参数 $k=1$ 时的特例。这意味着零假设模型嵌套在备择假设模型之中。对于此类嵌套模型，似然比检验 (LRT) 是一个强大的工具。LRT 统计量 $T$ 定义为：\n$$ T = 2 (\\ell_{\\text{gamma}} - \\ell_{\\text{exp}}) $$\n根据定义，$\\ell_{\\text{gamma}} \\ge \\ell_{\\text{exp}}$，所以 $T \\ge 0$。根据 Wilks 定理，在零假设 $H_0$ 下，统计量 $T$ 渐近服从卡方 ($\\chi^2$) 随机变量分布。该分布的自由度是备择模型和零假设模型自由参数数量之差。这里，伽马模型有两个参数 ($k, \\theta$)，指数模型有一个参数 ($\\lambda$)，因此自由度为 $2 - 1 = 1$。\n$$ T \\sim \\chi^2_1 $$\n\n### 3. 假设检验决策\n\n为了决定是否拒绝零假设，我们计算一个 p 值。p 值是在假设 $H_0$ 为真的情况下，观测到至少与从我们数据中计算出的检验统计量一样极端的检验统计量的概率。\n$$ p = \\Pr(\\chi^2_1 \\ge T) $$\n这通过计算 $\\chi^2_1$ 分布在 $T$ 处的生存函数来得到。然后，我们将 p 值与预先设定的显著性水平 $\\alpha = 0.05$ 进行比较。\n- 如果 $p  \\alpha$：我们拒绝零假设 ($H_0$)。证据表明，伽马分布比指数分布能更好地描述数据。\n- 如果 $p \\ge \\alpha$：我们未能拒绝零假设 ($H_0$)。没有足够的证据表明更复杂的伽马模型优于更简单的指数模型。\n\n算法实现将对每个给定的数据集遵循这些推导出的步骤。将使用数值求根算法（牛顿-拉弗森法）来找到 $\\hat{k}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import special, stats\n\ndef perform_lrt(isi_data: list[float], alpha: float) - list:\n    \"\"\"\n    Performs a Likelihood Ratio Test to compare an exponential model vs. a gamma model.\n\n    Args:\n        isi_data: A list of inter-spike intervals in seconds.\n        alpha: The significance level for the hypothesis test.\n\n    Returns:\n        A list containing the LRT statistic T, the p-value, and the boolean decision.\n    \"\"\"\n    x = np.array(isi_data, dtype=np.float64)\n    n = len(x)\n    mean_x = np.mean(x)\n\n    # 1. Exponential Model (Null Hypothesis H0)\n    # The maximized log-likelihood is ell_exp = -n * ln(mean_x) - n\n    if mean_x == 0:\n        # Invalid data, cannot proceed. Should not happen with problem constraints.\n        return [np.nan, np.nan, False]\n    log_L_exp = -n * np.log(mean_x) - n\n\n    # 2. Gamma Model (Alternative Hypothesis H1)\n    # The MLE for k requires solving ln(k) - digamma(k) = ln(mean(x)) - mean(ln(x))\n    log_x = np.log(x)\n    mean_log_x = np.mean(log_x)\n    s = np.log(mean_x) - mean_log_x\n    sum_log_x = np.sum(log_x)\n\n    # Numerical solution for k_hat using Newton-Raphson method\n    # Initial guess for k from Minka (2002), stable for s - 0\n    if s > 1e-9: # Protection against s being zero or negative\n        k_hat = (3.0 - s + np.sqrt((s - 3.0)**2 + 24.0 * s)) / (12.0 * s)\n        for _ in range(10): # 10 iterations are more than enough for convergence\n            log_k = np.log(k_hat)\n            digamma_k = special.digamma(k_hat)\n            f_k = log_k - digamma_k - s\n            if abs(f_k)  1e-12:\n                break\n            # Derivative f'(k) = 1/k - trigamma(k)\n            f_prime_k = 1.0 / k_hat - special.polygamma(1, k_hat)\n            k_hat -= f_k / f_prime_k\n    else:\n        # If s is effectively zero, data is constant, k - infinity.\n        # The likelihood becomes infinite. We set k to a very large number.\n        # This case is physically implausible and not in the test data.\n        # For LRT, this implies a clear rejection of k=1.\n        k_hat = 1e15\n\n    # Compute maximized log-likelihood for the gamma model\n    # ell_gamma = (k-1)*sum(ln(x)) - sum(x)/theta - n*k*ln(theta) - n*ln(Gamma(k))\n    # where theta = mean_x / k\n    theta_hat = mean_x / k_hat\n    log_L_gamma = (k_hat - 1) * sum_log_x - n * mean_x / theta_hat - n * k_hat * np.log(theta_hat) - n * special.gammaln(k_hat)\n\n    # 3. Compute LRT statistic T\n    T = 2 * (log_L_gamma - log_L_exp)\n    if T  0: # Clamp to zero in case of floating point inaccuracies\n        T = 0.0\n\n    # 4. Compute p-value\n    # Under H0, T is asymptotically chi-square distributed with df=1\n    df = 1\n    p_value = stats.chi2.sf(T, df)\n    \n    # 5. Make decision\n    decision = p_value  alpha\n\n    return [round(T, 6), round(p_value, 6), decision]\n    \ndef solve():\n    \"\"\"\n    Main function to run the analysis on the provided test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        [0.012, 0.033, 0.078, 0.041, 0.052, 0.090, 0.005, 0.061, 0.045, 0.066, 0.031, 0.084, 0.057, 0.049, 0.022, 0.073, 0.038, 0.059, 0.047, 0.055],\n        # Test case 2\n        [0.023, 0.071, 0.041, 0.064, 0.089, 0.055, 0.050, 0.082, 0.035, 0.058, 0.062, 0.046, 0.074, 0.069, 0.039, 0.053, 0.067, 0.101, 0.044, 0.060],\n        # Test case 3\n        [0.040, 0.061, 0.018, 0.079, 0.052],\n        # Test case 4\n        [0.048, 0.051, 0.050, 0.049, 0.052, 0.047, 0.053, 0.050, 0.051, 0.049]\n    ]\n\n    alpha = 0.05\n    results = []\n\n    for case_data in test_cases:\n        result = perform_lrt(case_data, alpha)\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    # str() on a list in Python produces the desired format with spaces.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}