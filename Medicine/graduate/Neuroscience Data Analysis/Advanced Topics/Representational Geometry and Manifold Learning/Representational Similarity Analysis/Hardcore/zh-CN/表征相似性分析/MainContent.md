## 引言
在现代神经科学中，一个核心挑战在于理解大脑如何将外部世界和内部思想转化为具体的神经活动模式。我们如何才能超越对单个神经元反应的描述，去检验关于信息如何在神经群体中被表征和计算的抽象理论？表征相似性分析（Representational Similarity Analysis, RSA）的出现，正是为了应对这一挑战，它提供了一个强大而灵活的框架，用以连接高维神经数据、[计算模型](@entry_id:637456)和行为。其核心思想是，不直接比较不同系统（如大脑与人工智能模型）中难以捉摸的活动模式本身，而是比较这些模式之间的关系结构——即“[表征几何](@entry_id:1130876)”。

本文旨在为您提供一份关于RSA的全面指南，系统性地解决从理论基础到前沿应用的关键问题。我们将带领您深入理解这一方法论的精髓，并掌握其在科研实践中的应用。

文章将分为三个核心章节。在第一章“原理与机制”中，我们将奠定理论基石，详细拆解RSA的核心构件——[表征非相似性矩阵](@entry_id:1130874)（RDM），探讨如何构建、比较它们，并进行稳健的[统计推断](@entry_id:172747)。接着，在第二章“应用与跨学科连接”中，我们将展示RSA在实际研究中的强大威力，从检验深度学习模型与大脑[视觉通路](@entry_id:895544)的对应关系，到在全脑范围定位和追踪表征的时空动态，再到其在进化生物学和人工智能等领域的跨学科应用。最后，在第三章“动手实践”中，您将通过具体的编程练习，亲手实现RDM的计算、[交叉验证](@entry_id:164650)和噪声[天花](@entry_id:920451)板的估计，将理论知识转化为实践技能。

通过这三个章节的学习，您将能够不仅理解RSA“是什么”和“为什么”重要，更将学会“如何”有效地将其应用于自己的研究中，从而开启一扇探索智能奥秘的新窗口。

## 原理与机制

在本章中，我们将深入探讨表征相似性分析（Representational Similarity Analysis, RSA）的核心原理与关键机制。我们将从其核心构建模块——[表征非相似性矩阵](@entry_id:1130874)（Representational Dissimilarity Matrix, RDM）——开始，系统性地阐述如何构建、比较和解释这些矩阵，从而测试关于[神经表征](@entry_id:1128614)的[计算理论](@entry_id:273524)。

### [表征非相似性矩阵](@entry_id:1130874)（RDM）：捕获表征几何

表征相似性分析的核心思想是通过一个明确定义的数学对象来刻画一组实验条件下神经活动模式之间的关系结构。这个对象就是**[表征非相似性矩阵](@entry_id:1130874)（Representational Dissimilarity Matrix, RDM）**。

假设我们有一个包含 $n$ 个实验条件（例如，呈现 $n$ 种不同的刺激）的实验。对于每个条件 $i$，我们测量到一个多变量的神经活动模式，表示为一个向量 $\mathbf{r}_i \in \mathbb{R}^p$，其中 $p$ 是测量通道的数量（例如，体素、神经元或传感器）。RDM 是一个 $n \times n$ 的矩阵 $D$，其每个元素 $D_{ij}$ 量化了条件 $i$ 和条件 $j$ 的神经活动模式 $\mathbf{r}_i$ 和 $\mathbf{r}_j$ 之间的非相似性。

根据其定义，RDM 具有两个基本属性  ：
1.  **对称性**：任何合理的非[相似性度量](@entry_id:896637) $d$ 都应满足对称性，即 $d(\mathbf{r}_i, \mathbf{r}_j) = d(\mathbf{r}_j, \mathbf{r}_i)$。因此，RDM 是一个对称矩阵，即 $D_{ij} = D_{ji}$。
2.  **零对角线**：一个活动模式与其自身的非相似性为零，即 $d(\mathbf{r}_i, \mathbf{r}_i) = 0$。因此，RDM 的对角[线元](@entry_id:196833)素 $D_{ii}$ 均为零。

由于这两个属性，RDM 的所有独特信息都包含在其上三角或下三角部分。在分析中，我们通常将上三角（不包括对角线）的 $n(n-1)/2$ 个元素[向量化](@entry_id:193244)，以进行后续的比较。

RDM 的关[键价](@entry_id:201326)值在于它提供了一个关于**[表征几何](@entry_id:1130876)（representational geometry）**的抽象描述。它不关注活动模式向量在 $p$ 维空间中的绝对位置或方向，而是关注这些向量之间的内在关系结构——即所有成对的非相似性。这个几何结构是连接神经活动与[计算模型](@entry_id:637456)和行为的桥梁。

### 非[相似性度量](@entry_id:896637)：定义几何

RDM 的具体形式取决于我们选择的非[相似性度量](@entry_id:896637) $d(\mathbf{r}_i, \mathbf{r}_j)$。这个选择并非无关紧要，因为它隐含地定义了我们认为[神经编码](@entry_id:263658)中哪些方面是重要的“信号”，哪些是无关的“噪声”。不同的度量具有不同的[不变性](@entry_id:140168)，从而对[神经表征](@entry_id:1128614)的不同方面敏感 。

#### 常用度量的[不变性](@entry_id:140168)属性

让我们分析几种常用非[相似性度量](@entry_id:896637)在以下常见变换下的[不变性](@entry_id:140168)：
-   **平移**：所有模式向量加上一个共同的向量 $c$，即 $\mathbf{r}_i \to \mathbf{r}_i + \mathbf{c}$。
-   **旋转**：所有模式向量乘以一个[正交矩阵](@entry_id:169220) $Q$，即 $\mathbf{r}_i \to Q\mathbf{r}_i$。
-   **[均匀缩放](@entry_id:267671)**：所有模式向量乘以一个正常数 $a$，即 $\mathbf{r}_i \to a\mathbf{r}_i$。

1.  **[欧几里得距离](@entry_id:143990)（Euclidean distance）**: $d_{\mathrm{E}}(\mathbf{r}_i, \mathbf{r}_j) = \lVert \mathbf{r}_i - \mathbf{r}_j \rVert_2$。
    -   **不变性**：对平移和旋转不变。
    -   **敏感性**：对缩放敏感。$d_{\mathrm{E}}(a\mathbf{r}_i, a\mathbf{r}_j) = a \cdot d_{\mathrm{E}}(\mathbf{r}_i, \mathbf{r}_j)$。这意味着欧氏距离对神经活动的整体幅度（例如，平均激活水平）敏感。

2.  **余[弦距离](@entry_id:170189)（Cosine distance）**: $d_{\mathrm{COS}}(\mathbf{r}_i, \mathbf{r}_j) = 1 - \frac{\mathbf{r}_i^\top \mathbf{r}_j}{\lVert \mathbf{r}_i \rVert_2 \lVert \mathbf{r}_j \rVert_2}$。
    -   **[不变性](@entry_id:140168)**：对旋转和[均匀缩放](@entry_id:267671)不变。
    -   **敏感性**：对平移敏感。由于对缩放不变，余[弦距离](@entry_id:170189)忽略了向量的长度（幅度），而只关注它们在 $p$ 维空间中的方向。它对活动模式的“轮廓”或“形状”敏感。

3.  **[相关距离](@entry_id:634939)（Correlation distance）**: $d_{\mathrm{COR}}(\mathbf{r}_i, \mathbf{r}_j) = 1 - \rho(\mathbf{r}_i, \mathbf{r}_j)$，其中 $\rho$ 是皮尔逊相关系数。
    -   **[不变性](@entry_id:140168)**：对[均匀缩放](@entry_id:267671)和向每个向量的所有元素添加一个常数（即沿全一向量 $\mathbf{1}$ 方向的平移）不变。
    -   **敏感性**：对任意平移和任意旋转敏感。[相关距离](@entry_id:634939)可以被看作是中心化（减去均值）后的向量之间的余[弦距离](@entry_id:170189)。它不仅忽略了向量的整体幅度，还忽略了其各通道的平均激活水平，使其成为一种纯粹关注活动模式“轮廓”的度量。

4.  **[马氏距离](@entry_id:269828)（Mahalanobis distance）**: $d_{\mathrm{M}}(\mathbf{r}_i, \mathbf{r}_j) = \sqrt{(\mathbf{r}_i - \mathbf{r}_j)^\top \Sigma^{-1} (\mathbf{r}_i - \mathbf{r}_j)}$，其中 $\Sigma$ 是[噪声协方差](@entry_id:1128754)矩阵。
    -   **不变性**：对平移不变。如果对数据进行任意[可逆线性变换](@entry_id:149915) $A$，并通过变换后的[协方差矩阵](@entry_id:139155)重新计算[马氏距离](@entry_id:269828)，则距离值不变。这使其成为一种非常强大的度量。
    -   **作用**：[马氏距离](@entry_id:269828)通过[噪声协方差](@entry_id:1128754)的逆矩阵 $\Sigma^{-1}$ 对数据进行“白化”（whitening）。这[实质](@entry_id:149406)上是将数据转换到一个新的空间，其中噪声是各向同性的（即在所有维度上方差相等且不相关）。这使得距离计算不会被噪声较大的通道所主导，从而提供了一个更可靠的、与测量单位无关的几何度量  。

#### 选择度量以检验假设

选择哪种度量取决于研究者关于[神经编码](@entry_id:263658)的先验假设 。
-   如果假设信息编码在**平均激活率（mean-rate coding）**中（即，不同条件主要引起活动总量的差异），那么对幅度敏感的度量（如欧氏距离）可能是合适的。
-   如果假设信息编码在**活动模式的[精细结构](@entry_id:1124953)（pattern-based coding）**中，而整体激活水平是无关紧要的，那么对幅度不敏感的度量（如[相关距离](@entry_id:634939)）是更好的选择。
-   当测量通道的噪声水平不同或噪声存在相关性时（这在 fMRI 等数据中很常见），使用马氏距离来对噪声进行归一化，是统计上最优的选择。

### 实际 RDM 估计：偏差与交叉验证

神经测量本质上是嘈杂的。使用嘈杂的活动模式估计来计算非相似性会引入一个系统性的**正向偏差（positive bias）**。

让我们考虑在同一次运行（run）中估计的两个活动模式 $\hat{\boldsymbol{\beta}}_{i,r}$ 和 $\hat{\boldsymbol{\beta}}_{j,r}$ 之间的平方欧氏距离。假设观测模型为 $\hat{\boldsymbol{\beta}}_{c,r} = \boldsymbol{\mu}_c + \boldsymbol{\epsilon}_{c,r}$，其中 $\boldsymbol{\mu}_c$ 是真实的无噪声模式，$\boldsymbol{\epsilon}_{c,r}$ 是均值为零的独立噪声。非[交叉验证](@entry_id:164650)的距离估计的[期望值](@entry_id:150961)为 ：
$$
E\left[\lVert \hat{\boldsymbol{\beta}}_{i,r} - \hat{\boldsymbol{\beta}}_{j,r} \rVert^2\right] = E\left[\lVert (\boldsymbol{\mu}_i - \boldsymbol{\mu}_j) + (\boldsymbol{\epsilon}_{i,r} - \boldsymbol{\epsilon}_{j,r}) \rVert^2\right] = \lVert \boldsymbol{\mu}_i - \boldsymbol{\mu}_j \rVert^2 + E\left[\lVert \boldsymbol{\epsilon}_{i,r} - \boldsymbol{\epsilon}_{j,r} \rVert^2\right]
$$
该[期望值](@entry_id:150961)等于真实的平方距离（信号）加上一个由噪声方差决定的正项（偏差）。这个偏差会人为地夸大非相似性，尤其会使得对相同条件的重复测量看起来也存在非零的非相似性。

为了消除这种偏差，我们必须使用**交叉验证（cross-validation）**。标准的做法是将数据分割成两个或多个统计上独立的部分（称为“折”，folds），例如，使用奇数次运行和偶数次运行的数据。然后，我们使用来自不同折的活动模式估计来计算非相似性 。例如，一个无偏的平方欧氏距离估计量可以通过计算来自两个独立折 $a$ 和 $b$ 的差向量的点积来获得：
$$
d^2_{CV}(i,j) = (\hat{\boldsymbol{\beta}}_{i,a} - \hat{\boldsymbol{\beta}}_{j,a})^\top (\hat{\boldsymbol{\beta}}_{i,b} - \hat{\boldsymbol{\beta}}_{j,b})
$$
由于来自不同折的噪声项 $\boldsymbol{\epsilon}_{a}$ 和 $\boldsymbol{\epsilon}_{b}$ 是独立的，它们的交叉项的期望为零。因此，该估计量的[期望值](@entry_id:150961)等于真实的平方距离，从而消除了偏差：
$$
E[d^2_{CV}(i,j)] = \lVert \boldsymbol{\mu}_i - \boldsymbol{\mu}_j \rVert^2
$$
值得注意的是，为了保证[交叉验证](@entry_id:164650)的有效性，必须严格维护数据折之间的独立性。任何在分割数据前跨折进行的[数据预处理](@entry_id:197920)（例如，跨所有运行进行归一化或主成分分析）都会导致信息“泄露”，从而重新引入偏差 。

### 跨模态[比较几何](@entry_id:180578)

RSA 的核心应用是比较不同模态（modality）的[表征几何](@entry_id:1130876)。例如，我们可以比较：
-   一个大脑区域的神经 RDM 与另一个区域的神经 RDM。
-   一个大脑区域的神经 RDM 与一个[计算模型](@entry_id:637456)（如深度神经网络）生成的模型 RDM。
-   一个大脑区域的神经 RDM 与一个描述刺激物理或语义属性的行为 RDM。

这种比较面临一个深刻的认知科学问题：我们如何能声称两个系统具有相似的“抽象表征内容”，即使它们的[测量尺度](@entry_id:909861)完全不同？例如，fMRI 的 BOLD 信号与神经网络的单元激活值在物理上毫无可比性。

答案在于关注表征几何的**[序数](@entry_id:150084)结构（ordinal structure）** 。假设我们从大脑和模型中测得的非相似性 $D_B$ 和 $D_M$ 是由潜在的“真实”非相似性 $d_B$ 和 $d_M$ 经过未知的、单调递增的[非线性](@entry_id:637147)函数 $h_B$ 和 $h_M$ 扭曲而成的。即，$D_X = h_X(d_X)$（暂不考虑噪声）。由于 $h_X$ 是单调递增的，它会保留其参数的顺[序关系](@entry_id:138937)。例如，如果 $d_B(i,j)  d_B(k,l)$，那么必然有 $D_B(i,j)  D_B(k,l)$。这意味着，尽管我们不知道 $h_B$ 和 $h_M$ 的具体形式，但测量到的 RDM 的非相似性值的**秩次排序（rank-ordering）**与潜在的真实 RDM 的秩次排序是相同的。

因此，为了独立于这些未知的测量[非线性](@entry_id:637147)来检验共享的抽象表征几何，我们应该使用基于秩次的关联统计量。**[斯皮尔曼等级相关](@entry_id:755150)（Spearman's rank correlation, $\rho$）**是 RSA 中最常用的度量，它正是通过计算两个 RDM [向量化](@entry_id:193244)后的上三角元素的秩次之间的[皮尔逊相关](@entry_id:260880)性来实现这一目标的。一个显著的[斯皮尔曼相关](@entry_id:896527)性表明，两个模态以相似的方式组织了对不同条件的表征，即使它们的表征在物理实现和[测量尺度](@entry_id:909861)上截然不同。

### RDM 比较的[统计推断](@entry_id:172747)

在计算了两个 RDM（例如，一个神经 RDM 和一个模型 RDM）之间的[斯皮尔曼相关](@entry_id:896527)系数后，我们需要评估其[统计显著性](@entry_id:147554)。一个关键的挑战是，RDM 的元素不是[相互独立](@entry_id:273670)的  。例如，非相似性 $D_{ij}$ 和 $D_{ik}$ 都依赖于对条件 $i$ 的测量，因此它们的测量误差是相关的。

这种依赖性使得传统的[参数化](@entry_id:265163)统计检验（例如，基于 $t$ 分布的对[相关系数](@entry_id:147037)的显著性检验，其自由度假设为[独立样本](@entry_id:177139)数）变得无效，因为它会严重夸大[统计显著性](@entry_id:147554)（即，产生过多的假阳性）。

正确的做法是使用**非参数[置换检验](@entry_id:175392)（non-parametric permutation test）**，该检验能够尊重 RDM 的内在依赖结构。标准的做法是**条件标签[置换检验](@entry_id:175392)（condition-label permutation test）**  ：
1.  计算观测到的神经 RDM 和模型 RDM 之间的真实相关性 $\rho_{obs}$。
2.  重复数千次以下步骤来构建一个[零分布](@entry_id:195412)（null distribution）：
    a.  随机打乱神经 RDM 的条件标签。这相当于同时置换其行和列。
    b.  计算打乱标签后的神经 RDM 与固定的模型 RDM 之间的相关性 $\rho_{perm}$。
3.  通过计算在零分布中有多少比例的 $\rho_{perm}$ 值大于或等于 $\rho_{obs}$，来得到 $p$ 值。

这个过程通过保持每个 RDM 内部的依赖结构（因为我们只是重新标记了条件，而不是打乱单个非相似性值），有效地模拟了“神经表征几何与模型几何无关”这一零假设。

### 噪声[天花](@entry_id:920451)板：[解释模型](@entry_id:925527)性能的背景

一个模型与神经数据之间的相关性是高是低？这个问题的答案取决于数据本身的质量。如果数据噪声很大，即使是“完美”的模型也不可能与数据达到很高的相关性。为了在[解释模型](@entry_id:925527)性能时考虑数据质量，我们引入了**噪声[天花](@entry_id:920451)板（noise ceiling）**的概念 。

噪声天花板估计了在给定数据噪声的情况下，任何模型所能达到的预期最高性能。它为模型性能提供了一个基准。噪声天花板通常由一个下界和一个[上界](@entry_id:274738)构成，这两个界都是通过评估跨被试数据的可靠性来估计的。

-   **下界（Lower bound）**：通过留一法（leave-one-out）估计。对于每个被试 $s$，计算其 RDM 与所有*其他*被试的平均 RDM 之间的相关性。因为被试 $s$ 的噪声与其余被试平均后的噪声是独立的，所以这种相关性会因为噪[声衰减](@entry_id:189896)而被低估，从而提供一个保守的下界。
-   **[上界](@entry_id:274738)（Upper bound）**：对于每个被试 $s$，计算其 RDM 与*所有*被试（包括其自身）的平均 RDM 之间的相关性。因为被试 $s$ 的噪声与其自身贡献给平均值的那部分噪声是相同的，所以这种相关性会被人为地拔高，从而提供一个偏高的[上界](@entry_id:274738)。

噪声[天花](@entry_id:920451)板的范围 $[r^{\mathrm{lower}}, r^{\mathrm{upper}}]$ 界定了数据所能支持的最佳模型性能的区域。如果一个模型的性能接近或进入这个区域，我们就可以认为该模型已经解释了数据中几乎所有可靠的变异。

### RSA 在[神经数据分析](@entry_id:1128577)中的定位

最后，将 RSA 置于更广阔的[神经数据分析](@entry_id:1128577)方法中进行比较，有助于我们理解其独特的贡献  。

-   **单变量分析（Univariate analysis）**：这类方法通常关注每个测量通道（如体素）的平均激活强度，或者将多变量活动投影到一个单一维度上。它们丢弃了关于活动模式的丰富多变量信息。
-   **多变量解码（Multivariate decoding, 或 MVPA）**：解码方法旨在从神经活动模式中预测出实验条件。其最终的输出通常是一个分类准确率，这个单一的数值总结了不同条件表征的[可分性](@entry_id:143854)。然而，它丢弃了条件之间连续的几何关系（例如，条件A在表征上是更像B还是更像C？）。
-   **表征相似性分析（RSA）**：RSA 占据了一个中间地带。它不像单变量分析那样丢弃模式信息，也不像解码那样将表征几何压缩成一个单一的准确率分数。相反，RSA 明确地对表征空间中所有成对的几何关系进行建模。通过抽象出活动模式在测量空间中的具体实现细节（如绝对位置和方向），RSA 专注于表征的内在几何结构，使其成为一个强大且灵活的框架，用以检验关于神经信息处理的明确[计算模型](@entry_id:637456)。

通过这种方式，RSA 为我们提供了一套独特的工具，使我们能够以一种定量和可检验的方式，深入探究大脑和[计算模型](@entry_id:637456)中表征的内容与格式。