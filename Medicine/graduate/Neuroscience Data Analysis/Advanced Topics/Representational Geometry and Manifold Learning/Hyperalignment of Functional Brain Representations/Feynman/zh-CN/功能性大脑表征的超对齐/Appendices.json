{
    "hands_on_practices": [
        {
            "introduction": "超对齐的核心假设是，尽管个体间的功能地形（functional topography）不同，但他们共享一个共同的表征几何结构。这个练习旨在通过一个具体的计算来巩固这一基本原则。你将亲手验证，一个正交变换（超对齐所使用的变换类型）在改变激活模式的坐标系的同时，并不会改变由这些模式定义的表征几何关系 。",
            "id": "4168872",
            "problem": "考虑一个简化的功能性磁共振成像 (fMRI) 表征数据集，其包含 $T=6$ 个时间点和 $d=3$ 个特征，组织成一个矩阵 $X \\in \\mathbb{R}^{T \\times d}$，其中每一行是一个时间点的多体素模式。这些时间点被划分为三个刺激条件，标记为 $1$、$2$ 和 $3$，每个条件有两个重复。设数据和标签由下式给出\n$$\nX = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n2  0  1 \\\\\n3  1  -1 \\\\\n-1  2  2 \\\\\n4  -1  2\n\\end{pmatrix}, \\quad c = \\begin{pmatrix}\n1,\\, 2,\\, 3,\\, 1,\\, 2,\\, 3\n\\end{pmatrix},\n$$\n其中 $c_t \\in \\{1,2,3\\}$ 是时间点 $t$ 的条件标签。在超对齐 (hyperalignment) 中，特定于被试的多变量模式通过正交变换进行对齐，以保持跨被试的表征几何结构。在本问题中，我们检验表征相异性矩阵 (RDM) 在此类正交旋转下的不变性。\n\n执行以下步骤：\n\n1. 对于每个条件 $i \\in \\{1,2,3\\}$，计算特定于条件的模式向量 $\\mu_i \\in \\mathbb{R}^{3}$，其为 $X$ 中标签等于 $i$ 的行的算术平均值。\n\n2. 构建一个 $3 \\times 3$ 的表征相异性矩阵 (RDM)，记为 $R$，其中非对角线元素为 $R_{ij} = \\|\\mu_i - \\mu_j\\|_2^2$ ($i \\neq j$)，对角线元素为 $R_{ii} = 0$。这里 $\\|\\cdot\\|_2$ 表示欧几里得范数。\n\n3. 令 $Q \\in \\mathbb{R}^{3 \\times 3}$ 为正交旋转矩阵\n$$\nQ = \\begin{pmatrix}\n0  -1  0 \\\\\n1  0  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n其满足 $Q^{\\top}Q = I$。计算旋转后的条件向量 $\\nu_i = Q \\mu_i$，并构建旋转后的 RDM $R'$，其元素为 $R'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2$ ($i \\neq j$) 和 $R'_{ii} = 0$。\n\n4. 仅使用欧几里得范数和正交矩阵的定义，判断 $R$ 和 $R'$ 是否必然相同。\n\n5. 计算两个 RDM 之差的弗罗贝尼乌斯范数，$\\|R - R'\\|_F$，其中对于任意矩阵 $A$，$\\|A\\|_F = \\sqrt{\\sum_{i,j} a_{ij}^2}$。将你的最终答案表示为单个实数。无需四舍五入。",
            "solution": "该问题要求我们分析正交旋转对从简化的 fMRI 数据集导出的表征相异性矩阵 (RDM) 的影响。我们已知数据矩阵 $X \\in \\mathbb{R}^{T \\times d}$（其中 $T=6$，$d=3$）以及条件标签向量 $c$。\n$$\nX = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n2  0  1 \\\\\n3  1  -1 \\\\\n-1  2  2 \\\\\n4  -1  2\n\\end{pmatrix}, \\quad c = \\begin{pmatrix}\n1  2  3  1  2  3\n\\end{pmatrix}\n$$\n\n我们将按指定步骤进行。\n\n**步骤 1：计算特定于条件的模式向量 $\\mu_i$**\n\n对于条件 $i \\in \\{1, 2, 3\\}$，向量 $\\mu_i$ 是 $X$ 中对应于该条件的行的算术平均值。\n\n对于条件 $i=1$，相关的行是 $X$ 的第 1 行和第 4 行：\n$$\n\\mu_1 = \\frac{1}{2} \\left( \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 3 \\\\ 1 \\\\ -1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 4 \\\\ 3 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix}\n$$\n\n对于条件 $i=2$，相关的行是 $X$ 的第 2 行和第 5 行：\n$$\n\\mu_2 = \\frac{1}{2} \\left( \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 2 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} -1 \\\\ 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix}\n$$\n\n对于条件 $i=3$，相关的行是 $X$ 的第 3 行和第 6 行：\n$$\n\\mu_3 = \\frac{1}{2} \\left( \\begin{pmatrix} 2 \\\\ 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 4 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 6 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n\n**步骤 2：构建表征相异性矩阵 $R$**\n\nRDM $R$ 是一个 $3 \\times 3$ 矩阵，其元素为 $R_{ij} = \\|\\mu_i - \\mu_j\\|_2^2$ ($i \\neq j$) 和 $R_{ii} = 0$。\n\n对角线元素为 $R_{11} = R_{22} = R_{33} = 0$。\n对于非对角线元素：\n$R_{12} = \\|\\mu_1 - \\mu_2\\|_2^2$：\n$$\n\\mu_1 - \\mu_2 = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 5/2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR_{12} = \\left(\\frac{5}{2}\\right)^2 + 0^2 + (-2)^2 = \\frac{25}{4} + 4 = \\frac{25+16}{4} = \\frac{41}{4}\n$$\n\n$R_{13} = \\|\\mu_1 - \\mu_3\\|_2^2$：\n$$\n\\mu_1 - \\mu_3 = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR_{13} = (-1)^2 + 2^2 + (-2)^2 = 1 + 4 + 4 = 9\n$$\n\n$R_{23} = \\|\\mu_2 - \\mu_3\\|_2^2$：\n$$\n\\mu_2 - \\mu_3 = \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -7/2 \\\\ 2 \\\\ 0 \\end{pmatrix}\n$$\n$$\nR_{23} = \\left(-\\frac{7}{2}\\right)^2 + 2^2 + 0^2 = \\frac{49}{4} + 4 = \\frac{49+16}{4} = \\frac{65}{4}\n$$\n\n由于平方欧几里得距离是对称的，因此 $R_{ij} = R_{ji}$。完整的 RDM 为：\n$$\nR = \\begin{pmatrix} 0  \\frac{41}{4}  9 \\\\ \\frac{41}{4}  0  \\frac{65}{4} \\\\ 9  \\frac{65}{4}  0 \\end{pmatrix}\n$$\n\n**步骤 3：计算旋转后的向量 $\\nu_i$ 和 RDM $R'$**\n\n正交旋转矩阵为 $Q = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix}$。我们计算 $\\nu_i = Q \\mu_i$。\n$$\n\\nu_1 = Q \\mu_1 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix}\n$$\n$$\n\\nu_2 = Q \\mu_2 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n$$\n\\nu_3 = Q \\mu_3 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix}\n$$\n现在我们构建旋转后的 RDM $R'$，其元素为 $R'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2$。\n$R'_{12} = \\|\\nu_1 - \\nu_2\\|_2^2$：\n$$\n\\nu_1 - \\nu_2 = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 5/2 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR'_{12} = 0^2 + \\left(\\frac{5}{2}\\right)^2 + (-2)^2 = \\frac{25}{4} + 4 = \\frac{41}{4}\n$$\n这与 $R_{12}$ 相同。\n\n$R'_{13} = \\|\\nu_1 - \\nu_3\\|_2^2$：\n$$\n\\nu_1 - \\nu_3 = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR'_{13} = (-2)^2 + (-1)^2 + (-2)^2 = 4 + 1 + 4 = 9\n$$\n这与 $R_{13}$ 相同。\n\n$R'_{23} = \\|\\nu_2 - \\nu_3\\|_2^2$：\n$$\n\\nu_2 - \\nu_3 = \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -7/2 \\\\ 0 \\end{pmatrix}\n$$\n$$\nR'_{23} = (-2)^2 + \\left(-\\frac{7}{2}\\right)^2 + 0^2 = 4 + \\frac{49}{4} = \\frac{16+49}{4} = \\frac{65}{4}\n$$\n这与 $R_{23}$ 相同。\n得到的 RDM $R'$ 与 $R$ 相同：\n$$\nR' = \\begin{pmatrix} 0  \\frac{41}{4}  9 \\\\ \\frac{41}{4}  0  \\frac{65}{4} \\\\ 9  \\frac{65}{4}  0 \\end{pmatrix}\n$$\n\n**步骤 4：判断 $R$ 和 $R'$ 是否必然相同**\n\n是的，$R$ 和 $R'$ 必然相同。这是正交变换的一个普遍性质。\n设 $v$ 是 $\\mathbb{R}^d$ 中的任意向量。其平方欧几里得范数为 $\\|v\\|_2^2 = v^\\top v$。\n考虑一个向量 $v$ 经过正交矩阵 $Q$ 变换后的平方范数：\n$$\n\\|Qv\\|_2^2 = (Qv)^\\top (Qv)\n$$\n使用转置性质 $(AB)^\\top = B^\\top A^\\top$，我们有：\n$$\n\\|Qv\\|_2^2 = v^\\top Q^\\top Q v\n$$\n根据定义，正交矩阵 $Q$ 满足 $Q^\\top Q = I$，其中 $I$ 是单位矩阵。将此代入方程：\n$$\n\\|Qv\\|_2^2 = v^\\top I v = v^\\top v = \\|v\\|_2^2\n$$\n这表明正交变换保持任意向量的范数不变。这个性质被称为等距变换（isometry）。\n\n现在，考虑 RDM 的元素。对于任意 $i \\neq j$：\n$$\nR_{ij} = \\|\\mu_i - \\mu_j\\|_2^2\n$$\n$$\nR'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2 = \\|Q\\mu_i - Q\\mu_j\\|_2^2\n$$\n利用矩阵乘法的线性性质，$Q\\mu_i - Q\\mu_j = Q(\\mu_i - \\mu_j)$。令差向量为 $v_{ij} = \\mu_i - \\mu_j$。\n那么 $R'_{ij} = \\|Q v_{ij}\\|_2^2$。\n根据我们上面的证明，$\\|Q v_{ij}\\|_2^2 = \\|v_{ij}\\|_2^2$。\n因此，\n$$\nR'_{ij} = \\|v_{ij}\\|_2^2 = \\|\\mu_i - \\mu_j\\|_2^2 = R_{ij}\n$$\n对角线元素 $R_{ii} = 0$ 和 $R'_{ii} = 0$ 也相等。由于对于任意选择的向量 $\\mu_i$ 和任意正交矩阵 $Q$，矩阵 $R$ 和 $R'$ 的所有对应元素都相等，因此这两个矩阵必然相同，$R = R'$。\n\n**步骤 5：计算差的弗罗贝尼乌斯范数 $\\|R - R'\\|_F$**\n\n基于步骤 4 的理论论证，并通过步骤 2 和步骤 3 的显式计算得到证实，我们已经确定 $R = R'$。\n因此，差矩阵是零矩阵：\n$$\nR - R' = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n矩阵 $A$ 的弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} a_{ij}^2}$。对于零矩阵，所有元素都是 $0$，所以它们的平方也都是 $0$。\n$$\n\\|R - R'\\|_F = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = \\sqrt{0} = 0\n$$\n两个 RDM之差的弗罗贝尼乌斯范数为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在理解了表征几何在旋转下的不变性之后，下一个关键问题是，我们如何找到能使不同被试的表征空间对齐的特定旋转？这个思想实验通过一个理想化的情景——其中一个被试的体素响应是另一个被试响应的完美置换——来探讨这个问题。通过分析这个案例，你将深入理解超对齐作为正交普氏分析（Orthogonal Procrustes）问题的本质，以及它如何精确地恢复共享的几何结构 。",
            "id": "4168877",
            "problem": "考虑在相同的时间锁定的自然刺激协议中，通过功能性磁共振成像 (fMRI) 观察到的两个被试。对于被试 $1$，令时间×体素的数据矩阵为 $X \\in \\mathbb{R}^{T \\times V}$，其中 $T$ 是时间点的数量，$V$ 是体素的数量。假设 $X$ 的列是线性无关的，并且处于一般位置（没有重复或零列）。对于被试 $2$，假设测量到相同的基础功能表征，但体素顺序被 $\\{1,\\dots,V\\}$ 的一个偶置换 $\\pi$ 所改变，得到 $Y = X P$，其中 $P \\in \\mathbb{R}^{V \\times V}$ 是与 $\\pi$ 相关联的置换矩阵。回想一下，一个置换矩阵 $P$ 满足 $P^\\top P = I$，并且如果 $\\pi$ 是偶置换，则 $\\det(P) = +1$，因此 $P \\in \\mathrm{SO}(V)$，即特殊正交群。\n\n超对齐 (Hyperalignment) 可以建模为一个正交普罗克汝斯忒斯问题 (orthogonal Procrustes problem)：找到一个 $R \\in \\mathbb{R}^{V \\times V}$，它在约束条件 $R^\\top R = I$ 下（以及可选的约束条件 $\\det(R) = +1$）最小化目标函数 $\\lVert Y R - X \\rVert_F^2$。这里 $\\lVert \\cdot \\rVert_F$ 表示弗罗贝尼乌斯范数 (Frobenius norm)。跨体素的表征几何可以通过格拉姆矩阵 (Gram matrix) $G_X = X^\\top X$ 来表征，该矩阵编码了体素随时间变化的响应模式之间的内积。\n\n仅使用正交矩阵、置换矩阵、欧几里得范数和内积的基本性质，在上述背景下对以下陈述进行推理。选择所有正确的陈述。\n\nA. 在 $Y = X P$ 且 $\\pi$ 是偶置换的情况下，存在一个 $R \\in \\mathrm{SO}(V)$ 可以实现零误差的精确对齐，具体来说是 $R = P^\\top$，此时有 $Y R = X$ 且 $\\lVert Y R - X \\rVert_F^2 = 0$。\n\nB. 对于任何置换（偶置换或奇置换），$X$ 的行（体素空间中的时间点向量）之间的成对欧几里得距离与 $Y$ 的行之间的距离相同，因为右乘任何置换矩阵都相当于对体素坐标进行正交变换，并保持欧几里得距离不变。\n\nC. 如果超对齐变换被约束在特殊正交群 $\\mathrm{SO}(V)$ 内，并且被试之间的体素置换是奇置换（因此 $\\det(P) = -1$），那么在所述假设下，精确恢复是不可能的；最小对齐误差严格为正。\n\nD. 格拉姆矩阵 $G_X = X^\\top X$ 在列置换下会发生改变，从而破坏共享的几何结构；因此，当体素顺序被置换时，被试之间的共享几何结构不会被保留。\n\nE. 在 $Y = X P$ 且 $X$ 为满列秩的设定下，正交普罗克汝斯忒斯解 $R$ 是唯一的且等于 $P^\\top$，无论是否施加行列式约束 $\\det(R) = +1$。\n\n选择正确的选项。",
            "solution": "用户希望对问题陈述进行严格验证，如果有效，则提供包含对每个选项进行分析的完整解决方案。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 被试 1 的数据：$X \\in \\mathbb{R}^{T \\times V}$（$T$ 个时间点，$V$ 个体素）。\n- $X$ 的列是线性无关且处于一般位置。\n- 被试 2 的数据：$Y = X P$，其中 $P \\in \\mathbb{R}^{V \\times V}$ 是一个偶置换 $\\pi$ 的置换矩阵。\n- 置换矩阵 $P$ 的性质：$P^\\top P = I$ 且 $\\det(P) = +1$，因此 $P \\in \\mathrm{SO}(V)$（特殊正交群）。\n- 超对齐目标：关于 $R \\in \\mathbb{R}^{V \\times V}$ 最小化 $\\lVert Y R - X \\rVert_F^2$。\n- $R$ 的约束条件：$R^\\top R = I$（正交群, $\\mathrm{O}(V)$）。\n- $R$ 的可选约束条件：$\\det(R) = +1$（特殊正交群, $\\mathrm{SO}(V)$）。\n- 格拉姆矩阵的定义：$G_X = X^\\top X$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：**该问题使用正交普罗克汝斯忒斯框架来为 fMRI 数据的超对齐建模，这是计算神经科学中一种标准且成熟的方法。变量 $X$、$Y$、$P$、$R$ 和目标函数的定义与该主题的科学文献一致。\n- **适定性：**该问题在数学上是适定的。它提出了一个具有指定矩阵和约束的清晰优化问题。$X$ 的列线性无关的假设确保了矩阵 $X^\\top X$ 是可逆的，这保证了普罗克汝斯忒斯问题的唯一解。\n- **客观性：**问题陈述以精确、客观的数学语言表达，没有歧义或主观陈述。\n\n**步骤 3：结论和行动**\n该问题是有效的。它具有科学依据、适定性和客观性。没有可识别的缺陷。我将继续进行解的推导和选项分析。\n\n### 解题推导\n\n问题的核心是在 $R$ 的正交性约束下，最小化目标函数 $f(R) = \\lVert YR - X \\rVert_F^2$。我们已知理想化的关系 $Y = XP$，其中 $P$ 是一个置换矩阵。\n\n我们将 $Y=XP$ 代入目标函数：\n$$ \\lVert YR - X \\rVert_F^2 = \\lVert (XP)R - X \\rVert_F^2 $$\n弗罗贝尼乌斯范数由迹内积导出，$\\lVert A \\rVert_F^2 = \\text{tr}(A^\\top A)$。其可能的最小值为 $0$，这当且仅当其参数为零矩阵时发生。如果可能，我们寻求一个正交矩阵 $R$ 使得误差为零。\n$$ (XP)R - X = 0 $$\n$$ X(PR - I) = 0 $$\n其中 $I$ 是 $V \\times V$ 的单位矩阵。\n问题陈述说明 $X$ 的列是线性无关的。这意味着如果对于某个矩阵 $A \\in \\mathbb{R}^{V \\times V}$ 有 $X A = 0$，那么必然有 $A=0$。在我们的情况下，这意味着我们需要：\n$$ PR - I = 0 \\implies PR = I $$\n由于 $P$ 是一个置换矩阵，它是正交的，所以它的逆是它的转置：$P^{-1} = P^\\top$。\n$$ R = P^{-1} = P^\\top $$\n这表明如果我们选择 $R = P^\\top$，对齐误差恰好为零：\n$$ \\lVert Y(P^\\top) - X \\rVert_F^2 = \\lVert (XP)P^\\top - X \\rVert_F^2 = \\lVert X(PP^\\top) - X \\rVert_F^2 = \\lVert XI - X \\rVert_F^2 = \\lVert 0 \\rVert_F^2 = 0 $$\n由于 $P$ 是正交的，$P^\\top$ 也是正交的，所以 $R = P^\\top$ 是无约束正交普罗克汝斯忒斯问题（其中 $R \\in \\mathrm{O}(V)$）的一个有效解。因为可能的最小误差是 $0$，所以这是最优解。\n\n如果矩阵 $B^\\top A$ 是满秩的，则正交普罗克汝斯忒斯问题 $\\min_{R^\\top R=I} \\lVert AR-B \\rVert_F^2$ 的解的唯一性得到保证。在我们的情况下，这个矩阵是 $X^\\top Y = X^\\top (XP) = (X^\\top X)P$。由于 $X$ 的列是线性无关的，所以 $X^\\top X$ 是正定的，因此是可逆的。$P$ 也是可逆的。因此，它们的乘积 $(X^\\top X)P$ 是可逆的（满秩），解是唯一的。\n\n我们现在将使用这些发现来评估每个陈述。\n\n### 逐项分析\n\n**A. 在 $Y = X P$ 且 $\\pi$ 是偶置换的情况下，存在一个 $R \\in \\mathrm{SO}(V)$ 可以实现零误差的精确对齐，具体来说是 $R = P^\\top$，此时有 $Y R = X$ 且 $\\lVert Y R - X \\rVert_F^2 = 0$。**\n\n如上推导，选择 $R = P^\\top$ 会导致零对齐误差：$\\lVert Y P^\\top - X \\rVert_F^2 = 0$，这意味着 $Y P^\\top = X$。\n该陈述要求解 $R$ 属于特殊正交群 $\\mathrm{SO}(V)$。这意味着必须满足两个条件：\n1.  $R$ 必须是正交的：$R^\\top R = I$。\n2.  $R$ 的行列式必须是 $+1$：$\\det(R) = +1$。\n\n对于 $R = P^\\top$：\n1.  由于 $P$ 是一个置换矩阵，它是正交的（$P^\\top P = I$）。它的转置 $R=P^\\top$ 也是正交的，因为 $R^\\top R = (P^\\top)^\\top P^\\top = P P^\\top = I$。\n2.  矩阵的转置的行列式等于矩阵本身的行列式：$\\det(R) = \\det(P^\\top) = \\det(P)$。问题陈述中指出置换 $\\pi$ 是偶置换，其对应的置换矩阵 $P$ 的行列式为 $\\det(P) = +1$。因此，$\\det(R) = +1$。\n\n由于 $R = P^\\top$ 是正交的并且行列式为 $+1$，它属于 $\\mathrm{SO}(V)$。该陈述的所有部分都是正确的。\n**结论：正确。**\n\n**B. 对于任何置换（偶置换或奇置换），$X$ 的行（体素空间中的时间点向量）之间的成对欧几里得距离与 $Y$ 的行之间的距离相同，因为右乘任何置换矩阵都相当于对体素坐标进行正交变换，并保持欧几里得距离不变。**\n\n令 $x_i^\\top$ 和 $x_j^\\top$ 分别是矩阵 $X$ 的第 $i$ 行和第 $j$ 行。它们是 $\\mathbb{R}^{1 \\times V}$ 中的向量。这两个时间点在体素空间中的欧几里得距离平方是 $\\lVert x_i^\\top - x_j^\\top \\rVert_2^2$。\n$Y = XP$ 对应的行是 $y_i^\\top = x_i^\\top P$ 和 $y_j^\\top = x_j^\\top P$。\n被试 2 的欧几里得距离平方是：\n$$ \\lVert y_i^\\top - y_j^\\top \\rVert_2^2 = \\lVert x_i^\\top P - x_j^\\top P \\rVert_2^2 = \\lVert (x_i^\\top - x_j^\\top)P \\rVert_2^2 $$\n令 $v^\\top = x_i^\\top - x_j^\\top$。平方范数为 $\\lVert v^\\top P \\rVert_2^2 = (v^\\top P)(v^\\top P)^\\top = v^\\top P P^\\top v$。\n任何置换矩阵 $P$（无论是偶置换还是奇置换）都是正交的，即 $P P^\\top = I$。\n$$ v^\\top P P^\\top v = v^\\top I v = v^\\top v = \\lVert v^\\top \\rVert_2^2 $$\n因此，$\\lVert y_i^\\top - y_j^\\top \\rVert_2^2 = \\lVert x_i^\\top - x_j^\\top \\rVert_2^2$。欧几里得距离被保留。陈述中提供的推理也是正确的：右乘一个正交矩阵（$P$）会保持欧几里得范数不变。\n**结论：正确。**\n\n**C. 如果超对齐变换被约束在特殊正交群 $\\mathrm{SO}(V)$ 内，并且被试之间的体素置换是奇置换（因此 $\\det(P) = -1$），那么在所述假设下，精确恢复是不可能的；最小对齐误差严格为正。**\n\n在这种情况下，我们有 $Y=XP$ 且 $\\det(P)=-1$。我们寻求在 $R \\in \\mathrm{SO}(V)$ 的约束下最小化 $\\lVert YR - X \\rVert_F^2$。\n如初始推导所示，当且仅当 $R = P^\\top$ 时，才能实现零误差（$\\lVert YR - X \\rVert_F^2 = 0$）。\n我们来检查这个最优解 $R=P^\\top$ 是否满足约束条件 $R \\in \\mathrm{SO}(V)$。\n矩阵 $P^\\top$ 是正交的。然而，它的行列式是 $\\det(P^\\top) = \\det(P) = -1$。\n由于 $\\det(P^\\top) = -1$，矩阵 $R=P^\\top$ 属于 $\\mathrm{O}(V)$ 但不属于 $\\mathrm{SO}(V)$。\n约束要求解 $R$ 必须在 $\\mathrm{SO}(V)$ 中，因此唯一能给出零误差的变换 $R=P^\\top$ 是被禁止的。\n任何其他变换 $R' \\in \\mathrm{SO}(V)$ 都不等于 $P^\\top$。对于任何 $R' \\neq P^\\top$，我们有 $PR' \\neq I$。\n由于 $X$ 的列是线性无关的，所以 $X(PR' - I) \\neq 0$。\n因此，对于任何 $R' \\in \\mathrm{SO}(V)$，误差 $\\lVert YR' - X \\rVert_F^2 = \\lVert X(PR' - I) \\rVert_F^2$ 必须严格大于 $0$。\n所以，精确恢复是不可能的，并且最小误差严格为正。\n**结论：正确。**\n\n**D. 格拉姆矩阵 $G_X = X^\\top X$ 在列置换下会发生改变，从而破坏共享的几何结构；因此，当体素顺序被置换时，被试之间的共享几何结构不会被保留。**\n\n我们来计算被试 2 的格拉姆矩阵 $G_Y = Y^\\top Y$。\n$$ G_Y = (XP)^\\top(XP) = P^\\top X^\\top X P = P^\\top G_X P $$\n矩阵 $G_Y$ 通过正交矩阵 $P$ 的相似变换与 $G_X$ 相关。这种变换保留了基本的几何性质，最显著的是特征值。体素响应模式之间的成对内积集合被保留下来，尽管它们在矩阵中的排列被置换了。具体来说，如果 $Y$ 的列是 $y_k$，$X$ 的列是 $x_j$，且有 $y_k = x_{\\pi(k)}$，那么 $G_Y$ 的 $(i, j)$ 项是 $y_i^\\top y_j = x_{\\pi(i)}^\\top x_{\\pi(j)}$，这正是 $G_X$ 的 $(\\pi(i), \\pi(j))$ 项。这只是对体素索引的重新标记，而不是对几何结构的破坏。许多对齐方法的核心假设正是这种几何结构被保留下来并且可以被恢复。该陈述根本上是错误的。\n**结论：不正确。**\n\n**E. 在 $Y = X P$ 且 $X$ 为满列秩的设定下，正交普罗克汝斯忒斯解 $R$ 是唯一的且等于 $P^\\top$，无论是否施加行列式约束 $\\det(R) = +1$。**\n\n这个陈述声称，对于无约束的正交问题（$R \\in \\mathrm{O}(V)$）和有约束的特殊正交问题（$R \\in \\mathrm{SO}(V)$），解都是 $R = P^\\top$。\n我们来分析这个说法。\n情况 1：无约束问题（$R \\in \\mathrm{O}(V)$）。如前所述，最小化 $\\lVert YR - X \\rVert_F^2$ 的唯一解确实是 $R = P^\\top$。\n情况 2：有约束问题（$R \\in \\mathrm{SO}(V)$）。解必须满足 $\\det(R)=+1$。\n\n考虑当置换 $P$ 是奇置换时会发生什么，此时 $\\det(P)=-1$。\n无约束解是 $R = P^\\top$。其行列式为 $\\det(P^\\top) = \\det(P) = -1$。\n有约束的解必须具有 $+1$ 的行列式。因此，有约束的解不能是 $P^\\top$。\n在这种情况下，无约束问题的解与有约束问题的解是不同的。因此，“无论是否施加行列式约束”这一说法是错误的。只需一个反例即可证伪这个普遍性断言，而奇置换的情况就提供了这个反例。\n**结论：不正确。**\n\n最终正确的陈述是 A、B 和 C。",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "虽然理想化的模型假设被试间的大脑表征仅通过纯旋转相关联，但真实数据往往含有噪声且是病态的（ill-conditioned）。在这种情况下，标准的正交普氏解可能不稳定。这个练习将引导你推导并应用一种更稳健的方法——正则化超对齐——并探讨它在偏差-方差权衡（bias-variance tradeoff）中的作用 。",
            "id": "4168818",
            "problem": "在功能性大脑表征的超对齐中，研究者试图将被试特定的多元时间序列对齐到一个共同的表征空间中，从而使得同源刺激在不同被试间诱发出相似的响应模式。考虑通过功能性磁共振成像（fMRI）观察到的两名被试，产生了时间对齐的响应矩阵 $X \\in \\mathbb{R}^{T \\times d}$ 和 $Y \\in \\mathbb{R}^{T \\times d}$，其中 $T$ 是时间点的数量， $d$ 是特征的数量（例如，一个脑区内的体素或主成分）。超对齐通常将被试间的对齐建模为从 $X$ 到 $Y$ 的一个线性映射 $R \\in \\mathbb{R}^{d \\times d}$。\n\n从标准的最小二乘对齐原理出发，选择对齐映射 $R$ 以最小化由弗罗贝尼乌斯范数衡量的 $X R$ 和 $Y$ 之间的差异平方和。在存在噪声和病态条件的情况下，引入了对 $R$ 能量的二次惩罚（岭正则化）。使用弗罗贝尼乌斯范数的最小二乘法基本定义以及 Tikhonov（岭）正则化原理，推导形式为\n$$\n\\min_{R \\in \\mathbb{R}^{d \\times d}} \\ \\|X R - Y\\|_{F}^{2} + \\lambda \\|R\\|_{F}^{2},\n$$\n的岭正则化 Procrustes 目标函数，其中 $\\lambda > 0$ 是正则化参数，并从矩阵微积分的第一性原理出发，证明其无约束全局最小值点 $R^{\\star}$ 如何偏离正交性（即，通常情况下 $R^{\\star \\top} R^{\\star} \\neq I$）。基于 $X$ 的奇异值结构和岭惩罚的影响，解释这种偏离对于含噪数据的优缺点。\n\n然后，对于一个具体的二维玩具超对齐实例，其中 $T = 3$，$d = 2$，令\n$$\nX = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1\n\\end{pmatrix},\n\\qquad\nY = \\begin{pmatrix}\n1  1 \\\\\n1  0 \\\\\n2  1\n\\end{pmatrix},\n$$\n并选择 $\\lambda = 1$。计算全局最小值点 $R^{\\star}$，并通过弗罗贝尼乌斯范数差异\n$$\n\\Delta \\equiv \\|R^{\\star \\top} R^{\\star} - I\\|_{F}\n$$\n来量化其与正交性的偏离。将最终的 $\\Delta$ 表示为一个精确的闭式解析表达式；不要近似或四舍五入。由于 $\\Delta$ 是无量纲的，因此不需要物理单位。",
            "solution": "所述问题具有科学依据、是良定的且客观的。它基于应用于计算神经科学中一个标准问题的线性代数、矩阵微积分和正则化理论的既定原理。所有必要的数据和定义都已提供，不存在内部矛盾。因此，该问题被认为是有效的，可以构建解决方案。\n\n该问题要求完成两个主要部分：首先，对岭正则化 Procrustes 目标函数进行一般性推导和分析；其次，对一个玩具示例进行具体计算。\n\n**第一部分：一般性推导与分析**\n\n需要最小化的目标函数由下式给出\n$$\nL(R) = \\|X R - Y\\|_{F}^{2} + \\lambda \\|R\\|_{F}^{2}\n$$\n其中 $X \\in \\mathbb{R}^{T \\times d}$，$Y \\in \\mathbb{R}^{T \\times d}$，$R \\in \\mathbb{R}^{d \\times d}$，且 $\\lambda > 0$。矩阵 $A$ 的弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} A_{ij}^2}$，其平方可以方便地使用迹算子表示：$\\|A\\|_{F}^{2} = \\text{Tr}(A^{\\top} A)$。\n\n将此性质应用于目标函数，我们得到：\n$$\nL(R) = \\text{Tr}((X R - Y)^{\\top}(X R - Y)) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n我们展开第一项：\n$$\nL(R) = \\text{Tr}((R^{\\top}X^{\\top} - Y^{\\top})(X R - Y)) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n$$\nL(R) = \\text{Tr}(R^{\\top}X^{\\top}XR - R^{\\top}X^{\\top}Y - Y^{\\top}XR + Y^{\\top}Y) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n使用迹算子的线性性质 $\\text{Tr}(A+B) = \\text{Tr}(A) + \\text{Tr}(B)$ 及其循环性质 $\\text{Tr}(ABC) = \\text{Tr}(CAB)$，我们注意到 $\\text{Tr}(Y^{\\top}XR) = \\text{Tr}(R Y^{\\top}X)$。此外，由于矩阵的迹等于其转置的迹，即 $\\text{Tr}(A) = \\text{Tr}(A^\\top)$，我们有 $\\text{Tr}(Y^\\top X R) = \\text{Tr}((Y^\\top X R)^\\top) = \\text{Tr}(R^\\top X^\\top Y)$。因此，这两个交叉项是相同的。目标函数变为：\n$$\nL(R) = \\text{Tr}(R^{\\top}X^{\\top}XR) - 2\\text{Tr}(R^{\\top}X^{\\top}Y) + \\text{Tr}(Y^{\\top}Y) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n为了找到最小值点 $R^{\\star}$，我们计算 $L(R)$ 相对于 $R$ 的梯度，并将其设为零矩阵。使用标准的矩阵微积分法则：\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}A R B) = A^{\\top} R B^{\\top} + A R B \\quad (\\text{这里, } A=X^\\top X, B=I) \\implies \\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}X^{\\top}XR) = 2 X^{\\top}XR\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}C) = C \\quad (\\text{这里, } C=X^\\top Y) \\implies \\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}X^{\\top}Y) = X^{\\top}Y\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}R) = 2R\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(Y^{\\top}Y) = 0\n$$\n因此，$L(R)$ 的梯度为：\n$$\n\\nabla_R L(R) = 2X^{\\top}XR - 2X^{\\top}Y + 2\\lambda R\n$$\n将梯度设为零以求最优的 $R^{\\star}$：\n$$\n2X^{\\top}XR^{\\star} - 2X^{\\top}Y + 2\\lambda R^{\\star} = 0\n$$\n$$\nX^{\\top}XR^{\\star} + \\lambda R^{\\star} = X^{\\top}Y\n$$\n$$\n(X^{\\top}X + \\lambda I)R^{\\star} = X^{\\top}Y\n$$\n矩阵 $X^{\\top}X$ 是半正定的。因为 $\\lambda > 0$，矩阵 $\\lambda I$ 是正定的。因此，和 $(X^{\\top}X + \\lambda I)$ 是正定的，从而也是可逆的。我们可以解出 $R^{\\star}$：\n$$\nR^{\\star} = (X^{\\top}X + \\lambda I)^{-1} X^{\\top}Y\n$$\n这是唯一的全局最小值点，因为目标函数是严格凸的。\n\n现在我们分析其与正交性的偏离。一个正交矩阵 $R_o$ 满足 $R_o^{\\top}R_o = I$。推导出的解 $R^{\\star}$ 通常不是正交的。项 $\\lambda \\|R\\|_F^2$ 惩罚具有大弗罗贝尼乌斯范数的解。由于 $\\|R\\|_F^2 = \\text{Tr}(R^\\top R) = \\sum_i \\sigma_i^2$，其中 $\\sigma_i$ 是 $R$ 的奇异值，这个惩罚项会使解的奇异值“收缩”到零。一个正交矩阵的所有奇异值都等于 1。正则化项将解从这个约束中拉开，导致变换不仅仅是纯粹的旋转/反射，还包括了缩放。\n\n这种偏离的**优点**源于解的稳定化。来自真实数据的矩阵 $X$ 通常是病态的，意味着其列高度相关。这使得 $X^{\\top}X$ 接近奇异，具有一些非常小的特征值。在非正则化的情况下（$\\lambda=0$），解 $R_0 = (X^{\\top}X)^{-1}X^{\\top}Y$ 将涉及对这个病态矩阵求逆。$X^{\\top}X$ 的小特征值在其逆矩阵中会变成非常大的特征值，从而放大了 $Y$ 中存在的任何噪声。解 $R_0$ 会非常不稳定并过拟合数据。通过加上 $\\lambda I$，我们在求逆之前将正常数 $\\lambda$ 加到 $X^{\\top}X$ 的每个特征值上。如果 $\\sigma_i^2$ 是 $X^\\top X$ 的特征值，那么 $(X^\\top X + \\lambda I)^{-1}$ 的特征值是 $1/(\\sigma_i^2 + \\lambda)$。这可以防止分母接近于零，从而稳定了逆矩阵，进而稳定了解 $R^{\\star}$。这是一个经典的偏差-方差权衡：我们引入偏差（解不再是真正的最小二乘拟合），以减小方差（解对噪声更具鲁棒性）。\n\n**缺点**是所得到的变换 $R^{\\star}$ 是有偏的，并且不是一个等距变换。它会收缩数据，尤其是在 $X$ 的低方差方向（对应于 $X^\\top X$ 的小特征值）。如果根本的科学假设是大脑表征之间通过纯旋转（一种等距变换）相关联，那么这种收缩会扭曲几何关系，这可能是不希望看到的。正则化可能会衰减那些恰好位于低方差方向上的微弱但有意义的信号。\n\n**第二部分：具体计算**\n\n给定 $T=3$，$d=2$，$\\lambda=1$ 以及矩阵：\n$$\nX = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix}, \\qquad Y = \\begin{pmatrix} 1  1 \\\\ 1  0 \\\\ 2  1 \\end{pmatrix}\n$$\n首先，我们计算 $X^{\\top}X$ 和 $X^{\\top}Y$：\n$$\nX^{\\top}X = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1+0+1  0+0+1 \\\\ 0+0+1  0+1+1 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\nX^{\\top}Y = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  0 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} 1+0+2  1+0+1 \\\\ 0+1+2  0+0+1 \\end{pmatrix} = \\begin{pmatrix} 3  2 \\\\ 3  1 \\end{pmatrix}\n$$\n接下来，我们计算 $R^{\\star} = (X^{\\top}X + \\lambda I)^{-1} X^{\\top}Y$，其中 $\\lambda=1$：\n$$\nX^{\\top}X + \\lambda I = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + 1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}\n$$\n该矩阵的逆是：\n$$\n(X^{\\top}X + \\lambda I)^{-1} = \\frac{1}{3 \\cdot 3 - 1 \\cdot 1} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}\n$$\n现在，我们可以求出 $R^{\\star}$：\n$$\nR^{\\star} = \\frac{1}{8} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix} \\begin{pmatrix} 3  2 \\\\ 3  1 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 9-3  6-1 \\\\ -3+9  -2+3 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 6  5 \\\\ 6  1 \\end{pmatrix}\n$$\n为了量化与正交性的偏离，我们计算 $\\Delta = \\|R^{\\star \\top} R^{\\star} - I\\|_{F}$。首先，我们计算 $R^{\\star \\top} R^{\\star}$：\n$$\nR^{\\star \\top} = \\frac{1}{8} \\begin{pmatrix} 6  6 \\\\ 5  1 \\end{pmatrix}\n$$\n$$\nR^{\\star \\top} R^{\\star} = \\left(\\frac{1}{8}\\right)^2 \\begin{pmatrix} 6  6 \\\\ 5  1 \\end{pmatrix} \\begin{pmatrix} 6  5 \\\\ 6  1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 36+36  30+6 \\\\ 30+6  25+1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 72  36 \\\\ 36  26 \\end{pmatrix}\n$$\n接下来，我们减去单位矩阵 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$：\n$$\nR^{\\star \\top} R^{\\star} - I = \\frac{1}{64} \\begin{pmatrix} 72  36 \\\\ 36  26 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 72-64  36 \\\\ 36  26-64 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 8  36 \\\\ 36  -38 \\end{pmatrix}\n$$\n最后，我们计算这个差分矩阵的弗罗贝尼乌斯范数：\n$$\n\\Delta^2 = \\|R^{\\star \\top} R^{\\star} - I\\|_{F}^{2} = \\left(\\frac{1}{64}\\right)^2 \\left( 8^2 + 36^2 + 36^2 + (-38)^2 \\right)\n$$\n$$\n\\Delta^2 = \\frac{1}{4096} \\left( 64 + 1296 + 1296 + 1444 \\right) = \\frac{1}{4096} \\left( 4100 \\right) = \\frac{4100}{4096}\n$$\n我们可以通过将分子和分母同时除以 4 来简化这个分数：\n$$\n\\Delta^2 = \\frac{1025}{1024}\n$$\n取平方根得到 $\\Delta$：\n$$\n\\Delta = \\sqrt{\\frac{1025}{1024}} = \\frac{\\sqrt{1025}}{\\sqrt{1024}} = \\frac{\\sqrt{25 \\cdot 41}}{32} = \\frac{5\\sqrt{41}}{32}\n$$\n这就是与正交性偏离的最终精确表达式。",
            "answer": "$$\n\\boxed{\\frac{5\\sqrt{41}}{32}}\n$$"
        }
    ]
}