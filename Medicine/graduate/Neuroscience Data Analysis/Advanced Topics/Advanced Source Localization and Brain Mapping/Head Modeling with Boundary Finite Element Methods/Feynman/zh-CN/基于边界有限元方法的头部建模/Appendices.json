{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的数值方法之前，理解一个简化但经典的几何模型——同心球模型的解析解至关重要。该解析解不仅是验证数值代码的基准，也为我们提供了关于不同组织层（如颅骨和头皮）如何影响电势分布的基础物理直觉。通过该练习，您将掌握求解多层边界值问题的分析方法，并加深对电导率在生物电磁正问题中作用的理解。",
            "id": "4168108",
            "problem": "一个三层球壳头部模型由半径为 $a_{1}$ 和 $a_{2}$ 的同心球体近似，其中最内层区域 $0  r  a_{1}$ 代表大脑，中间层 $a_{1}  r  a_{2}$ 代表颅骨，最外层区域 $r > a_{2}$ 代表头皮。电导率是各向同性的，并且是分段常数：大脑中为 $\\sigma_{1}$，颅骨中为 $\\sigma_{2}$，头皮中为 $\\sigma_{3}$。在麦克斯韦方程组的准静态近似下，电势 $\\,\\Phi\\,$ 在源之外满足拉普拉斯方程，并且在材料界面上是连续的，而电流密度 $\\,-\\sigma \\nabla \\Phi\\,$ 的法向分量在界面上也是连续的。一个矩的大小为 $p$、沿 $z$ 轴方向的点电流偶极子位于原点。假设电势在无穷远处为零。\n\n使用在界面 $r=a_{1}$ 和 $r=a_{2}$ 上的单层算子的边界积分表示，并仅考虑由位于中心的 $z$ 轴向偶极子激发的 $l=1$ 次轴对称球谐函数，建立强制电势在 $r=a_{1}$ 和 $r=a_{2}$ 界面上连续以及法向电流连续的耦合系统。然后解析地求解此系统，以获得外部区域 $r>a_{2}$ 中任意场点 $(r,\\theta)$（球坐标表示，其中 $\\theta$ 是相对于 $z$ 轴的极角）的电势的闭式表达式。将您的最终答案表示为关于 $p$、$\\sigma_{1}$、$\\sigma_{2}$、$\\sigma_{3}$、$a_{1}$、$a_{2}$、$r$ 和 $\\theta$ 的单个解析表达式 $\\Phi_{3}(r,\\theta)$。电势单位使用伏特，角度单位使用弧度。无需进行数值四舍五入；请提供精确的符号表达式。",
            "solution": "该问题要求解在一个三层同心球模型中，由位于中心的径向电流偶极子在最外层区域（头皮）产生的电势。这是一个经典的生物电磁学正问题，可以通过求解拉普拉斯方程并匹配边界条件来解析解决。\n\n1.  **势函数表示**：由于偶极子的$l=1$球谐函数对称性，每一层中的电势$\\Phi_i$可以表示为勒让德多项式$P_1(\\cos\\theta) = \\cos\\theta$的线性组合。在第 $i$ 层，通解形式为 $\\Phi_i(r, \\theta) = (A_i r + B_i r^{-2})\\cos\\theta$。\n    *   **大脑层 (区域1: $r < a_1$)**: 包含位于原点的源。势函数由源的场和由于边界感应的场的叠加组成。为保证原点处的势有限，感应场必须为$A_1 r \\cos\\theta$。因此，$\\Phi_1 = \\left( \\frac{p}{4\\pi\\sigma_1 r^2} + A_1 r \\right) \\cos\\theta$。\n    *   **颅骨层 (区域2: $a_1 < r < a_2$)**: 无源，通解为 $\\Phi_2 = (A_2 r + B_2 r^{-2})\\cos\\theta$。\n    *   **头皮层 (区域3: $r > a_2$)**: 势在无穷远处为零，因此$A_3=0$。解的形式为 $\\Phi_3 = B_3 r^{-2} \\cos\\theta$。\n\n2.  **边界条件**: 在两个界面 $r=a_1$ 和 $r=a_2$ 上，我们应用两个条件：\n    *   电势连续：$\\Phi_i = \\Phi_{i+1}$。\n    *   法向电流密度连续：$\\sigma_i \\frac{\\partial \\Phi_i}{\\partial r} = \\sigma_{i+1} \\frac{\\partial \\Phi_{i+1}}{\\partial r}$。\n\n3.  **求解系统**: 将势函数表达式代入四个边界条件（两个在$r=a_1$，两个在$r=a_2$），我们得到一个关于未知系数$A_1, A_2, B_2, B_3$的$4 \\times 4$线性方程组。我们的目标是求解$B_3$，因为它决定了外部区域的电势$\\Phi_3$。\n\n4.  **最终解**: 经过繁琐的代数运算求解该线性系统，可以得到系数$B_3$的表达式。将$B_3$代入$\\Phi_3 = B_3 r^{-2} \\cos\\theta$，即可得到最终的解析解。",
            "answer": "$$ \\boxed{ \\frac{9 p \\sigma_1 \\sigma_2 \\cos(\\theta)}{4 \\pi r^2 \\left[ (2\\sigma_1 + \\sigma_2)(2\\sigma_2 + \\sigma_3) - 2 \\left(\\frac{a_1}{a_2}\\right)^3 (\\sigma_1 - \\sigma_2)(\\sigma_2 - \\sigma_3) \\right]} } $$"
        },
        {
            "introduction": "对于真实的头部几何形状，解析解通常是不可行的，这使得有限元方法(FEM)等数值技术成为必需。本练习将FEM过程分解至其最基本的层面：为一个简单的四面体单元构建刚度矩阵。通过从弱形式出发手动构建该矩阵，您将具体地理解连续的物理问题是如何被转化为离散的代数系统的，而这正是有限元方法的核心。",
            "id": "4168180",
            "problem": "在神经科学数据分析的脑电图正向建模中，头部可以表示为一个分段均匀的体积导体。边界元法 (BEM) 和有限元法 (FEM) 都被使用。考虑一个标量电导率为 $\\,\\sigma > 0\\,$ 的单一均匀各向同性区域，该区域由顶点为 $\\,\\mathbf{x}_{1} = (0,0,0)\\,$、$\\,\\mathbf{x}_{2} = (1,0,0)\\,$、$\\,\\mathbf{x}_{3} = (0,1,0)\\,$ 和 $\\,\\mathbf{x}_{4} = (0,0,1)\\,$ 的四面体 $\\,\\Omega\\,$ 表示。令 $\\,u\\,$ 表示电势，其在 $\\,\\Omega\\,$ 中由静态电流连续性方程 $\\,\\nabla \\cdot (\\sigma \\nabla u) = 0\\,$ 控制，并在 $\\,\\partial \\Omega\\,$ 上满足齐次诺伊曼边界条件 $\\,\\mathbf{n} \\cdot (\\sigma \\nabla u) = 0\\,$。在四面体上使用标准的连续分段线性（帽）基函数，其中节点基函数 $\\,N_{i}\\,$ 对应于节点 $\\,\\mathbf{x}_{i}\\,$，$\\,i \\in \\{1,2,3,4\\}\\,$。\n\n任务：\n- 从控制方程的弱形式出发，在给定的四面体上使用上述基函数，组装全局有限元刚度矩阵 $\\,\\mathbf{K} \\in \\mathbb{R}^{4 \\times 4}\\,$ 和载荷向量 $\\,\\mathbf{f} \\in \\mathbb{R}^{4}\\,$。\n- 从第一性原理出发，验证在所述诺伊曼边界条件下 $\\,\\mathbf{K}\\,$ 是对称和半正定的，并确定其零空间的维数和一个基向量。\n- 明确地确定 $\\,\\mathbf{K}\\,$ 的谱，并以 $\\,\\sigma\\,$ 的闭式解析表达式的形式报告其最小的严格正特征值。\n\n你的最终答案必须是仅用 $\\,\\sigma\\,$ 表示的 $\\,\\mathbf{K}\\,$ 的最小严格正特征值，不带单位。不要四舍五入；提供精确的表达式。",
            "solution": "该问题要求确定一个特定静电问题的有限元法 (FEM) 刚度矩阵的最小严格正特征值。该问题首先被验证为适定且科学合理的，从而可以进行完整求解。\n\n在电导率为 $\\sigma$ 且无电流源的均匀各向同性介质中，电势 $u$ 的控制方程是拉普拉斯方程，它由静态电流连续性方程 $\\nabla \\cdot \\mathbf{J} = 0$（其中 $\\mathbf{J} = -\\sigma \\nabla u$）推导得出。对于常数 $\\sigma > 0$，这简化为 $\\sigma \\nabla^2 u = 0$，或 $\\nabla^2 u = 0$。\n\n为了推导有限元系统，我们从弱形式开始。我们将控制方程 $\\nabla \\cdot (\\sigma \\nabla u) = 0$ 乘以一个测试函数 $v$，并在域 $\\Omega$ 上积分：\n$$ \\int_{\\Omega} v (\\nabla \\cdot (\\sigma \\nabla u)) dV = 0 $$\n应用格林第一恒等式（多维分部积分）得到：\n$$ \\int_{\\partial \\Omega} v (\\sigma \\nabla u) \\cdot \\mathbf{n} \\, dS - \\int_{\\Omega} \\nabla v \\cdot (\\sigma \\nabla u) dV = 0 $$\n其中 $\\partial \\Omega$ 是域的边界，$\\mathbf{n}$ 是外向单位法向量。问题指定了齐次诺伊曼边界条件 $\\mathbf{n} \\cdot (\\sigma \\nabla u) = 0$ on $\\partial \\Omega$。该条件表明没有电流流过边界。因此，边积分消失，问题的弱形式是寻找一个势 $u \\in H^1(\\Omega)$，使得对于所有测试函数 $v \\in H^1(\\Omega)$：\n$$ \\int_{\\Omega} \\sigma (\\nabla u \\cdot \\nabla v) dV = 0 $$\n在有限元法中，势 $u$ 由基函数 $N_j(\\mathbf{x})$ 的线性组合来近似，即 $u_h(\\mathbf{x}) = \\sum_{j=1}^{4} u_j N_j(\\mathbf{x})$，其中 $u_j$ 是四面体四个节点 $\\mathbf{x}_j$ 处的未知势值。伽辽金法使用基函数作为测试函数，即对于 $i \\in \\{1, 2, 3, 4\\}$，$v = N_i$。将这些代入弱形式，得到一个线性方程组：\n$$ \\sum_{j=1}^{4} \\left( \\int_{\\Omega} \\sigma (\\nabla N_i \\cdot \\nabla N_j) dV \\right) u_j = 0 $$\n该系统以矩阵形式表示为 $\\mathbf{K} \\mathbf{u} = \\mathbf{f}$，其中 $\\mathbf{u} = [u_1, u_2, u_3, u_4]^T$。刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{4 \\times 4}$ 的元素由下式给出：\n$$ K_{ij} = \\int_{\\Omega} \\sigma (\\nabla N_i \\cdot \\nabla N_j) dV $$\n由于没有内部或边界源项，载荷向量是零向量，即 $\\mathbf{f} = \\mathbf{0} \\in \\mathbb{R}^4$。\n\n域 $\\Omega$ 是一个四面体，其顶点为 $\\mathbf{x}_{1} = (0,0,0)$、$\\mathbf{x}_{2} = (1,0,0)$、$\\mathbf{x}_{3} = (0,1,0)$ 和 $\\mathbf{x}_{4} = (0,0,1)$。对于此四面体中的一个点 $\\mathbf{x}=(x,y,z)$，线性（帽）基函数 $N_i$ 是重心坐标：\n$N_1(\\mathbf{x}) = 1-x-y-z$\n$N_2(\\mathbf{x}) = x$\n$N_3(\\mathbf{x}) = y$\n$N_4(\\mathbf{x}) = z$\n这些函数是线性的，因此它们的梯度在整个四面体上是常数：\n$\\nabla N_1 = (-1, -1, -1)$\n$\\nabla N_2 = (1, 0, 0)$\n$\\nabla N_3 = (0, 1, 0)$\n$\\nabla N_4 = (0, 0, 1)$\n\n四面体的体积 $V$ 为 $V = \\frac{1}{6} |\\det(\\mathbf{x}_2-\\mathbf{x}_1, \\mathbf{x}_3-\\mathbf{x}_1, \\mathbf{x}_4-\\mathbf{x}_1)| = \\frac{1}{6} |\\det(\\mathbf{I})| = \\frac{1}{6}$。由于 $\\sigma$ 和梯度在 $\\Omega$ 上是常数，因此 $K_{ij}$ 的积分简化为 $K_{ij} = \\sigma (\\nabla N_i \\cdot \\nabla N_j) V = \\frac{\\sigma}{6} (\\nabla N_i \\cdot \\nabla N_j)$。我们计算梯度的点积：\n$\\nabla N_1 \\cdot \\nabla N_1 = 3$\n$\\nabla N_2 \\cdot \\nabla N_2 = 1$\n$\\nabla N_3 \\cdot \\nabla N_3 = 1$\n$\\nabla N_4 \\cdot \\nabla N_4 = 1$\n$\\nabla N_1 \\cdot \\nabla N_2 = -1$, $\\nabla N_1 \\cdot \\nabla N_3 = -1$, $\\nabla N_1 \\cdot \\nabla N_4 = -1$\n$\\nabla N_2 \\cdot \\nabla N_3 = 0$, $\\nabla N_2 \\cdot \\nabla N_4 = 0$, $\\nabla N_3 \\cdot \\nabla N_4 = 0$\n将这些值组合起来，得到刚度矩阵 $\\mathbf{K}$：\n$$ \\mathbf{K} = \\frac{\\sigma}{6} \\begin{pmatrix} 3  -1  -1  -1 \\\\ -1  1  0  0 \\\\ -1  0  1  0 \\\\ -1  0  0  1 \\end{pmatrix} $$\n该矩阵是对称的，正如从 $K_{ij}=K_{ji}$ 所预期的那样。它是半正定的，因为对于任何向量 $\\mathbf{c} \\in \\mathbb{R}^4$，二次型 $\\mathbf{c}^T \\mathbf{K} \\mathbf{c} = \\int_{\\Omega} \\sigma ||\\nabla(\\sum_j c_j N_j)||^2 dV \\ge 0$。零空间由向量 $\\mathbf{c}$ 组成，对于这些向量 $\\nabla(\\sum_j c_j N_j) = \\mathbf{0}$，这意味着 $\\sum_j c_j N_j$ 是一个常数。由于 $\\sum_j N_j = 1$，这在 $c_1=c_2=c_3=c_4$ 时发生。因此，零空间的维数为 1，由向量 $(1,1,1,1)^T$ 张成。这对应于特征值 0。\n\n为了找到其他特征值，我们分析矩阵 $\\mathbf{K}' = \\frac{6}{\\sigma}\\mathbf{K}$：\n$$ \\mathbf{K}' = \\begin{pmatrix} 3  -1  -1  -1 \\\\ -1  1  0  0 \\\\ -1  0  1  0 \\\\ -1  0  0  1 \\end{pmatrix} $$\n$\\mathbf{K}$ 的特征值 $\\lambda$ 与 $\\mathbf{K}'$ 的特征值 $\\lambda'$ 通过 $\\lambda = \\frac{\\sigma}{6}\\lambda'$ 相关。我们求 $\\mathbf{K}'$ 的特征多项式：\n$$ P(\\lambda') = \\det(\\mathbf{K}' - \\lambda' \\mathbf{I}) = \\det \\begin{pmatrix} 3-\\lambda'  -1  -1  -1 \\\\ -1  1-\\lambda'  0  0 \\\\ -1  0  1-\\lambda'  0 \\\\ -1  0  0  1-\\lambda' \\end{pmatrix} $$\n展开行列式，我们得到：\n$P(\\lambda') = (3-\\lambda')(1-\\lambda')^3 - 3(1-\\lambda')^2 = (1-\\lambda')^2[(3-\\lambda')(1-\\lambda') - 3]$\n$P(\\lambda') = (1-\\lambda')^2[3 - 4\\lambda' + (\\lambda')^2 - 3] = (1-\\lambda')^2[(\\lambda')^2 - 4\\lambda']$\n$P(\\lambda') = \\lambda'(\\lambda' - 4)(1-\\lambda')^2$\n根为 $\\lambda' = 0$（重数为 1）、$\\lambda' = 1$（重数为 2）和 $\\lambda' = 4$（重数为 1）。\n$\\mathbf{K}'$ 的谱为 $\\{0, 1, 1, 4\\}$。\n$\\mathbf{K}$ 的谱通过将这些值乘以 $\\frac{\\sigma}{6}$ 得到：\n$$ \\text{Spectrum}(\\mathbf{K}) = \\left\\{ \\frac{\\sigma}{6} \\cdot 0, \\frac{\\sigma}{6} \\cdot 1, \\frac{\\sigma}{6} \\cdot 1, \\frac{\\sigma}{6} \\cdot 4 \\right\\} = \\left\\{ 0, \\frac{\\sigma}{6}, \\frac{\\sigma}{6}, \\frac{2\\sigma}{3} \\right\\} $$\n严格正特征值为 $\\frac{\\sigma}{6}$ 和 $\\frac{2\\sigma}{3}$。由于 $\\sigma > 0$，其中最小的是 $\\frac{\\sigma}{6}$。",
            "answer": "$$\\boxed{\\frac{\\sigma}{6}}$$"
        },
        {
            "introduction": "在边界元方法(BEM)和有限元方法(FEM)之间进行选择，往往涉及在计算成本和模型灵活性之间的权衡。本练习将视角从具体的实现细节提升到对计算性能的宏观分析，介绍了决定运行时和内存需求如何随模型解析度增长的缩放定律。通过这个实践，您将学会进行“信封背面”式的计算来预估计算资源开销，这对于在神经科学领域设计和执行大规模模拟研究是一项至关重要的技能。",
            "id": "4168169",
            "problem": "考虑用于脑电图 (EEG) 的准静态电磁正问题，其中头部被建模为半径为 $R$ 的均质球形导体。考虑两种数值方法：边界元法 (BEM) 和有限元法 (FEM)。设球形头部的表面积为 $A$，体积为 $V$，BEM 的网格分辨率由平均表面边长 $h_{\\mathrm{s}}$ 表征，FEM 的网格分辨率由平均体积边长 $h_{\\mathrm{v}}$ 表征。假设以下为广泛接受的建模事实：\n\n- BEM 未知数的数量 $B$ 随表面积的变化关系为 $B \\approx \\eta_{\\mathrm{b}} A h_{\\mathrm{s}}^{-2}$，其中 $\\eta_{\\mathrm{b}}$ 是一个网格密度常数。\n- FEM 未知数的数量 $V_{\\mathrm{n}}$ 随体积的变化关系为 $V_{\\mathrm{n}} \\approx \\eta_{\\mathrm{v}} V h_{\\mathrm{v}}^{-3}$，其中 $\\eta_{\\mathrm{v}}$ 是一个网格密度常数。稀疏刚度矩阵平均每行有 $z$ 个结构性非零元，因此 $\\mathrm{nnz} \\approx z V_{\\mathrm{n}}$。\n\n考虑将 Krylov 迭代求解器应用于由此产生的线性系统：\n- 对于通过广义最小残差法 (GMRES) 求解的 BEM 第二类积分方程，达到残差容差 $\\epsilon$ 的迭代次数为 $m_{\\mathrm{BEM}} = \\alpha \\ln(1/\\epsilon)$，每次迭代的密集矩阵向量乘积时间与 $B^{2}$ 成正比，系数为 $\\gamma_{\\mathrm{BEM}}$。\n- 对于通过带有代数多重网格 (AMG) 预处理的共轭梯度法 (CG) 求解的 FEM 系统，迭代次数为 $m_{\\mathrm{FEM}} = \\beta \\ln(1/\\epsilon)$，每次迭代的时间与 $\\mathrm{nnz}$ 成正比，系数为 $\\gamma_{\\mathrm{FEM}}$。\n\n内存模型：\n- BEM 存储一个密集矩阵，占用 $8 B^{2}$ 字节。\n- FEM 存储一个稀疏矩阵和多重网格层次结构，内存占用约为 $M_{\\mathrm{FEM}} \\approx \\mu \\,\\mathrm{nnz} + \\nu V_{\\mathrm{n}}$ 字节，其中 $\\mu$ 和 $\\nu$ 是存储系数。\n\n从上述基本原理和几何事实 $A = 4 \\pi R^{2}$ 及 $V = \\frac{4}{3} \\pi R^{3}$ 出发，推导运行时间模型 $T_{\\mathrm{BEM}}(h_{\\mathrm{s}}, \\epsilon)$ 和 $T_{\\mathrm{FEM}}(h_{\\mathrm{v}}, \\epsilon)$，以及内存模型 $M_{\\mathrm{BEM}}(h_{\\mathrm{s}})$ 和 $M_{\\mathrm{FEM}}(h_{\\mathrm{v}})$。然后，使用以下参数计算运行时间比 $T_{\\mathrm{BEM}} / T_{\\mathrm{FEM}}$：\n- $R = 9.0 \\times 10^{-2} \\,\\mathrm{m}$，\n- $h_{\\mathrm{s}} = 3.0 \\times 10^{-3} \\,\\mathrm{m}$，\n- $h_{\\mathrm{v}} = 2.0 \\times 10^{-3} \\,\\mathrm{m}$，\n- $\\epsilon = 10^{-6}$，\n- $\\eta_{\\mathrm{b}} = 5.0 \\times 10^{-1}$，\n- $\\eta_{\\mathrm{v}} = 1.2$，\n- $z = 30$，\n- $\\alpha = 12$，\n- $\\beta = 18$，\n- $\\gamma_{\\mathrm{BEM}} = 2.0 \\times 10^{-9} \\,\\mathrm{s}$，\n- $\\gamma_{\\mathrm{FEM}} = 5.0 \\times 10^{-10} \\,\\mathrm{s}$，\n- $\\mu = 12 \\,\\mathrm{bytes}$，\n- $\\nu = 40 \\,\\mathrm{bytes}$。\n\n将最终的运行时间比四舍五入到四位有效数字。该答案是无量纲的；此比值不需要物理单位。",
            "solution": "### 步骤 1：推导运行时间和内存模型\n首先，我们根据给定的参数推导 BEM 和 FEM 的运行时间和内存使用的函数表达式。总运行时间 $T$ 是迭代次数 $m$ 与每次迭代时间的乘积。\n\n**边界元法 (BEM)**\nBEM 未知数的数量 $B$ 由下式给出：\n$$ B \\approx \\eta_{\\mathrm{b}} A h_{\\mathrm{s}}^{-2} = \\eta_{\\mathrm{b}} (4 \\pi R^{2}) h_{\\mathrm{s}}^{-2} = 4 \\pi \\eta_{\\mathrm{b}} R^{2} h_{\\mathrm{s}}^{-2} $$\nBEM 的总运行时间 $T_{\\mathrm{BEM}}$ 为：\n$$ T_{\\mathrm{BEM}} = m_{\\mathrm{BEM}} \\times (\\text{每次迭代时间}) = (\\alpha \\ln(1/\\epsilon)) \\times (\\gamma_{\\mathrm{BEM}} B^{2}) $$\n代入 $B$ 的表达式：\n$$ T_{\\mathrm{BEM}}(h_{\\mathrm{s}}, \\epsilon) = \\alpha \\gamma_{\\mathrm{BEM}} \\ln(1/\\epsilon) (4 \\pi \\eta_{\\mathrm{b}} R^{2} h_{\\mathrm{s}}^{-2})^{2} = 16 \\pi^{2} \\alpha \\gamma_{\\mathrm{BEM}} \\eta_{\\mathrm{b}}^{2} \\ln(1/\\epsilon) R^{4} h_{\\mathrm{s}}^{-4} $$\nBEM 所需的内存 $M_{\\mathrm{BEM}}$ 为：\n$$ M_{\\mathrm{BEM}}(h_{\\mathrm{s}}) = 8 B^{2} = 8 (4 \\pi \\eta_{\\mathrm{b}} R^{2} h_{\\mathrm{s}}^{-2})^{2} = 128 \\pi^{2} \\eta_{\\mathrm{b}}^{2} R^{4} h_{\\mathrm{s}}^{-4} $$\n\n**有限元法 (FEM)**\nFEM 未知数的数量 $V_{\\mathrm{n}}$ 由下式给出：\n$$ V_{\\mathrm{n}} \\approx \\eta_{\\mathrm{v}} V h_{\\mathrm{v}}^{-3} = \\eta_{\\mathrm{v}} \\left(\\frac{4}{3} \\pi R^{3}\\right) h_{\\mathrm{v}}^{-3} = \\frac{4}{3} \\pi \\eta_{\\mathrm{v}} R^{3} h_{\\mathrm{v}}^{-3} $$\n稀疏矩阵中的非零元数量为 $\\mathrm{nnz} \\approx z V_{\\mathrm{n}}$：\n$$ \\mathrm{nnz} \\approx \\frac{4}{3} \\pi z \\eta_{\\mathrm{v}} R^{3} h_{\\mathrm{v}}^{-3} $$\nFEM 的总运行时间 $T_{\\mathrm{FEM}}$ 为：\n$$ T_{\\mathrm{FEM}} = m_{\\mathrm{FEM}} \\times (\\text{每次迭代时间}) = (\\beta \\ln(1/\\epsilon)) \\times (\\gamma_{\\mathrm{FEM}} \\mathrm{nnz}) $$\n代入 $\\mathrm{nnz}$ 的表达式：\n$$ T_{\\mathrm{FEM}}(h_{\\mathrm{v}}, \\epsilon) = \\beta \\gamma_{\\mathrm{FEM}} \\ln(1/\\epsilon) \\left(\\frac{4}{3} \\pi z \\eta_{\\mathrm{v}} R^{3} h_{\\mathrm{v}}^{-3}\\right) = \\frac{4}{3} \\pi \\beta \\gamma_{\\mathrm{FEM}} z \\eta_{\\mathrm{v}} \\ln(1/\\epsilon) R^{3} h_{\\mathrm{v}}^{-3} $$\nFEM 所需的内存 $M_{\\mathrm{FEM}}$ 为：\n$$ M_{\\mathrm{FEM}}(h_{\\mathrm{v}}) \\approx \\mu \\,\\mathrm{nnz} + \\nu V_{\\mathrm{n}} = (\\mu z + \\nu) V_{\\mathrm{n}} = (\\mu z + \\nu) \\frac{4}{3} \\pi \\eta_{\\mathrm{v}} R^{3} h_{\\mathrm{v}}^{-3} $$\n\n### 步骤 2：计算运行时间比\n现在我们使用推导出的运行时间模型计算比率 $T_{\\mathrm{BEM}} / T_{\\mathrm{FEM}}$：\n$$ \\frac{T_{\\mathrm{BEM}}}{T_{\\mathrm{FEM}}} = \\frac{16 \\pi^{2} \\alpha \\gamma_{\\mathrm{BEM}} \\eta_{\\mathrm{b}}^{2} \\ln(1/\\epsilon) R^{4} h_{\\mathrm{s}}^{-4}}{\\frac{4}{3} \\pi \\beta \\gamma_{\\mathrm{FEM}} z \\eta_{\\mathrm{v}} \\ln(1/\\epsilon) R^{3} h_{\\mathrm{v}}^{-3}} $$\n$\\ln(1/\\epsilon)$ 项被消去。我们可以通过重新整理各项来简化表达式：\n$$ \\frac{T_{\\mathrm{BEM}}}{T_{\\mathrm{FEM}}} = \\frac{12 \\pi \\alpha \\gamma_{\\mathrm{BEM}} \\eta_{\\mathrm{b}}^{2} R h_{\\mathrm{v}}^{3}}{\\beta \\gamma_{\\mathrm{FEM}} z \\eta_{\\mathrm{v}} h_{\\mathrm{s}}^{4}} $$\n现在，我们代入给定的数值：\n$$ \\frac{T_{\\mathrm{BEM}}}{T_{\\mathrm{FEM}}} = \\frac{12 \\pi (12) (2.0 \\times 10^{-9}) (0.5)^{2} (9.0 \\times 10^{-2}) (2.0 \\times 10^{-3})^{3}}{(18) (5.0 \\times 10^{-10}) (30) (1.2) (3.0 \\times 10^{-3})^{4}} $$\n将常数项和几何项分开计算：\n$$ \\text{常数项} = \\frac{12 \\pi (12) (0.5)^{2} (2.0 \\times 10^{-9})}{(18) (30) (1.2) (5.0 \\times 10^{-10})} = \\frac{72 \\pi \\times 10^{-9}}{324 \\times 10^{-9}} = \\frac{2 \\pi}{9} $$\n$$ \\text{几何项} = \\frac{(9.0 \\times 10^{-2}) (2.0 \\times 10^{-3})^{3}}{(3.0 \\times 10^{-3})^{4}} = \\frac{9.0 \\times 10^{-2} \\times 8.0 \\times 10^{-9}}{81.0 \\times 10^{-12}} = \\frac{72.0 \\times 10^{-11}}{81.0 \\times 10^{-12}} = \\frac{80}{9} $$\n将两个结果相乘得到最终的比率：\n$$ \\frac{T_{\\mathrm{BEM}}}{T_{\\mathrm{FEM}}} = \\left(\\frac{2 \\pi}{9}\\right) \\left(\\frac{80}{9}\\right) = \\frac{160 \\pi}{81} $$\n计算其数值并四舍五入到四位有效数字：\n$$ \\frac{160 \\pi}{81} \\approx 6.2056151 \\approx 6.206 $$",
            "answer": "$$\\boxed{6.206}$$"
        }
    ]
}