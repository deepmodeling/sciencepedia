{
    "hands_on_practices": [
        {
            "introduction": "钙成像实验的原始数据是荧光强度，而非钙离子浓度本身。为了进行有意义的生物学解读，我们必须将这些荧光测量值转换回钙离子浓度。本练习将引导您使用指示剂-钙离子结合的基本生物物理模型来完成这一关键转换，这不仅能教会您如何进行计算，更重要的是，能让您学会如何批判性地评估在指示剂整个动态范围内估计值的可靠性 。",
            "id": "4188020",
            "problem": "一种比率型钙指示剂根据与游离钙结合的指示剂分子的比例来报告荧光强度。假设一个充分混合的隔室，并采用以下基于质量作用结合和 Hill 协同性描述的物理模型：结合指示剂的比例由下式给出：$$\\theta = \\frac{([\\mathrm{Ca}]/K_{d})^{n}}{1 + ([\\mathrm{Ca}]/K_{d})^{n}},$$ 其中 $[\\mathrm{Ca}]$ 是游离钙浓度，$K_{d}$ 是解离常数，$n$ 是 Hill 系数。测得的荧光是未结合态和结合态的线性混合，$$F = F_{\\min} + (F_{\\max} - F_{\\min})\\,\\theta,$$ 其中 $F_{\\min}$ 和 $F_{\\max}$ 分别是基线荧光和饱和荧光。假设 $F_{\\min} = 120$ 任意单位，$F_{\\max} = 1020$ 任意单位，$K_{d} = 300$ 纳摩尔 (nM)，且 $n = 2$。假设荧光测量上存在附加的、零均值的高斯噪声，其标准差为 $ \\sigma_{F} = 15$ 任意单位。获得了三个荧光测量值：$F_{1} = 165$ 任意单位，$F_{2} = 570$ 任意单位，以及 $F_{3} = 975$ 任意单位。\n\n仅以上述定义为出发点：\n\n1. 推导 $[\\mathrm{Ca}]$ 作为 $F$, $F_{\\min}$, $F_{\\max}$, $K_{d}$ 和 $n$ 的函数的闭式表达式。\n2. 使用推导出的表达式，计算与 $F_{1}$、$F_{2}$ 和 $F_{3}$ 对应的 $[\\mathrm{Ca}]$，并以纳摩尔为单位表示。\n3. 使用一阶误差传播，推导推断出的 $[\\mathrm{Ca}]$ 的局部相对标准差（用 $F$、$F_{\\min}$、$F_{\\max}$、$n$ 和 $\\sigma_{F}$ 表示），并根据此表达式解释在基线和饱和附近的可识别性。\n4. 最后，计算在 $F_{1}$ 或 $F_{3}$ 处（以较差者为准）推断出的 $[\\mathrm{Ca}]$ 的相对标准差与在 $F_{2}$ 处的相对标准差之比。将该比率表示为无量纲小数，并四舍五入至四位有效数字。",
            "solution": "问题陈述提供了一组有效且适定的问题，这些问题基于钙成像分析中使用的标准生物物理模型。所有必需的常数和数据都已给出，并且没有科学或逻辑上的不一致。因此，我将进行完整的解答。\n\n该问题分为四个部分。我将按顺序逐一解答。\n\n第 1 部分：推导 $[\\mathrm{Ca}]$ 作为荧光 $F$ 的函数。\n\n我们有两个基本方程：\n1. 关于结合指示剂比例 $\\theta$ 的 Hill 方程：\n$$ \\theta = \\frac{([\\mathrm{Ca}]/K_{d})^{n}}{1 + ([\\mathrm{Ca}]/K_{d})^{n}} $$\n2. 关于荧光 $F$ 的线性模型：\n$$ F = F_{\\min} + (F_{\\max} - F_{\\min})\\,\\theta $$\n\n我们的目标是推导钙浓度 $[\\mathrm{Ca}]$ 的闭式表达式，该表达式用 $F$ 和已知参数 $F_{\\min}$、$F_{\\max}$、$K_{d}$ 和 $n$ 表示。\n\n首先，我们求解荧光方程得到 $\\theta$。\n$$ F - F_{\\min} = (F_{\\max} - F_{\\min})\\,\\theta $$\n$$ \\theta = \\frac{F - F_{\\min}}{F_{\\max} - F_{\\min}} $$\n该表达式表示归一化荧光，它等同于结合指示剂的比例。\n\n接下来，我们将这个 $\\theta$ 的表达式与 Hill 方程等同起来：\n$$ \\frac{F - F_{\\min}}{F_{\\max} - F_{\\min}} = \\frac{([\\mathrm{Ca}]/K_{d})^{n}}{1 + ([\\mathrm{Ca}]/K_{d})^{n}} $$\n为了简化代数运算，我们定义一个变量 $X = ([\\mathrm{Ca}]/K_{d})^{n}$。方程变为：\n$$ \\frac{F - F_{\\min}}{F_{\\max} - F_{\\min}} = \\frac{X}{1 + X} $$\n现在，我们求解 $X$：\n$$ (F - F_{\\min})(1 + X) = (F_{\\max} - F_{\\min})X $$\n$$ F - F_{\\min} + (F - F_{\\min})X = (F_{\\max} - F_{\\min})X $$\n$$ F - F_{\\min} = [(F_{\\max} - F_{\\min}) - (F - F_{\\min})]X $$\n$$ F - F_{\\min} = (F_{\\max} - F)X $$\n$$ X = \\frac{F - F_{\\min}}{F_{\\max} - F} $$\n现在，我们代回 $X = ([\\mathrm{Ca}]/K_{d})^{n}$：\n$$ \\left(\\frac{[\\mathrm{Ca}]}{K_{d}}\\right)^{n} = \\frac{F - F_{\\min}}{F_{\\max} - F} $$\n为了分离出 $[\\mathrm{Ca}]$，我们对两边取 $n$ 次方根，然后乘以 $K_{d}$：\n$$ \\frac{[\\mathrm{Ca}]}{K_{d}} = \\left(\\frac{F - F_{\\min}}{F_{\\max} - F}\\right)^{1/n} $$\n$$ [\\mathrm{Ca}] = K_{d} \\left(\\frac{F - F_{\\min}}{F_{\\max} - F}\\right)^{1/n} $$\n这就是所要求的 $[\\mathrm{Ca}]$ 的闭式表达式。\n\n第 2 部分：根据给定的荧光值计算 $[\\mathrm{Ca}]$。\n\n我们使用推导出的表达式以及给定的常数：$F_{\\min} = 120$，$F_{\\max} = 1020$，$K_{d} = 300$ 纳摩尔 (nM)，以及 $n = 2$。\n\n对于 $F_{1} = 165$：\n$$ [\\mathrm{Ca}]_{1} = 300 \\left(\\frac{165 - 120}{1020 - 165}\\right)^{1/2} = 300 \\left(\\frac{45}{855}\\right)^{1/2} = 300 \\left(\\frac{1}{19}\\right)^{1/2} = \\frac{300}{\\sqrt{19}} \\, \\mathrm{nM} \\approx 68.82 \\, \\mathrm{nM} $$\n\n对于 $F_{2} = 570$：\n$$ [\\mathrm{Ca}]_{2} = 300 \\left(\\frac{570 - 120}{1020 - 570}\\right)^{1/2} = 300 \\left(\\frac{450}{450}\\right)^{1/2} = 300 \\left(1\\right)^{1/2} = 300 \\, \\mathrm{nM} $$\n这个结果是预料之中的，因为 $F_2 = 570$ 是荧光范围的中点，对应于 $\\theta = 0.5$，根据 Hill 方程的定义，这在 $[\\mathrm{Ca}] = K_{d}$ 时发生。\n\n对于 $F_{3} = 975$：\n$$ [\\mathrm{Ca}]_{3} = 300 \\left(\\frac{975 - 120}{1020 - 975}\\right)^{1/2} = 300 \\left(\\frac{855}{45}\\right)^{1/2} = 300 \\left(19\\right)^{1/2} = 300\\sqrt{19} \\, \\mathrm{nM} \\approx 1307.67 \\, \\mathrm{nM} $$\n\n第 3 部分：相对标准差的推导与解释。\n\n我们使用一阶误差传播公式。对于函数 $y = f(x)$，其不确定度 $\\sigma_y$ 与不确定度 $\\sigma_x$ 的关系为 $\\sigma_y \\approx |\\frac{dy}{dx}|\\sigma_x$。\n在这里，我们的函数是 $[\\mathrm{Ca}](F)$，测量不确定度是 $\\sigma_F$。推断出的钙浓度标准差 $\\sigma_{[\\mathrm{Ca}]}$ 为：\n$$ \\sigma_{[\\mathrm{Ca}]} \\approx \\left| \\frac{d[\\mathrm{Ca}]}{dF} \\right| \\sigma_{F} $$\n相对标准差是 $\\frac{\\sigma_{[\\mathrm{Ca}]}}{[\\mathrm{Ca}]}$。\n$$ \\frac{\\sigma_{[\\mathrm{Ca}]}}{[\\mathrm{Ca}]} \\approx \\frac{1}{[\\mathrm{Ca}]} \\left| \\frac{d[\\mathrm{Ca}]}{dF} \\right| \\sigma_{F} $$\n让我们使用第 1 部分的表达式来计算导数 $\\frac{d[\\mathrm{Ca}]}{dF}$。为简化起见，令 $C = [\\mathrm{Ca}]$ 并使用链式法则。\n$$ C = K_{d} \\left(\\frac{F - F_{\\min}}{F_{\\max} - F}\\right)^{1/n} \\implies \\ln(C) = \\ln(K_{d}) + \\frac{1}{n}\\left[ \\ln(F - F_{\\min}) - \\ln(F_{\\max} - F) \\right] $$\n对 $F$ 求导：\n$$ \\frac{1}{C}\\frac{dC}{dF} = \\frac{1}{n} \\left[ \\frac{1}{F - F_{\\min}} - \\frac{-1}{F_{\\max} - F} \\right] = \\frac{1}{n} \\left[ \\frac{1}{F - F_{\\min}} + \\frac{1}{F_{\\max} - F} \\right] $$\n$$ \\frac{1}{C}\\frac{dC}{dF} = \\frac{1}{n} \\frac{(F_{\\max} - F) + (F - F_{\\min})}{(F - F_{\\min})(F_{\\max} - F)} = \\frac{1}{n} \\frac{F_{\\max} - F_{\\min}}{(F - F_{\\min})(F_{\\max} - F)} $$\n由于当 $F_{\\min}  F  F_{\\max}$ 时，$\\frac{1}{[\\mathrm{Ca}]} \\frac{d[\\mathrm{Ca}]}{dF}$ 为正，我们可以去掉绝对值符号。\n$$ \\frac{\\sigma_{[\\mathrm{Ca}]}}{[\\mathrm{Ca}]} \\approx \\left( \\frac{1}{[\\mathrm{Ca}]} \\frac{d[\\mathrm{Ca}]}{dF} \\right) \\sigma_F = \\frac{1}{n} \\frac{F_{\\max} - F_{\\min}}{(F - F_{\\min})(F_{\\max} - F)} \\sigma_{F} $$\n这就是推导出的 $[\\mathrm{Ca}]$ 的局部相对标准差的表达式。\n\n解释：相对标准差，即钙浓度估计的相对误差，与乘积 $(F - F_{\\min})(F_{\\max} - F)$ 成反比。该乘积项在边界 $F=F_{\\min}$ 和 $F=F_{\\max}$ 处为零，在范围的中心 $F = (F_{\\min}+F_{\\max})/2$ 处达到最大值。因此，当测量的荧光 $F$ 接近基线 ($F_{\\min}$) 或饱和 ($F_{\\max}$) 时，分母接近零，相对误差 $\\frac{\\sigma_{[\\mathrm{Ca}]}}{[\\mathrm{Ca}]}$ 发散至无穷大。这标志着可识别性的灾难性丧失。在基线和饱和附近，$[\\mathrm{Ca}]$ 和 $F$ 之间的关系非常平坦，意味着钙浓度的巨大变化仅产生微小且被噪声掩盖的荧光变化。因此，指示剂在这些区域不敏感，测量结果对于量化 $[\\mathrm{Ca}]$ 是不可靠的。\n\n第 4 部分：计算相对标准差的比率。\n\n令 $RSD(F)$ 表示在荧光 $F$ 处的相对标准差。\n$$ RSD(F) = \\frac{\\sigma_F}{n} \\frac{F_{\\max} - F_{\\min}}{(F - F_{\\min})(F_{\\max} - F)} $$\n我们需要比较 $RSD(F_1)$、$RSD(F_2)$ 和 $RSD(F_3)$。“较差”一词意味着相对标准差更大。\n让我们为每个测量点计算分母项 $(F - F_{\\min})(F_{\\max} - F)$ 的值。$F_{\\min}=120$，$F_{\\max}=1020$。\n\n对于 $F_{1} = 165$：\n$$ (165 - 120)(1020 - 165) = (45)(855) = 38475 $$\n\n对于 $F_{2} = 570$：\n$$ (570 - 120)(1020 - 570) = (450)(450) = 202500 $$\n\n对于 $F_{3} = 975$：\n$$ (975 - 120)(1020 - 975) = (855)(45) = 38475 $$\n\n由于 $RSD$ 表达式的分子是相同的，最大的 $RSD$ 将对应于最小的分母。这里，$RSD(F_1) = RSD(F_3)$，且两者都大于 $RSD(F_2)$。因此，“较差”的情况对应于 $F_1$ 或 $F_3$。\n\n我们需要计算较差的 $RSD$ 与在 $F_2$ 处的 $RSD$ 之比。\n$$ \\frac{RSD(F_1)}{RSD(F_2)} = \\frac{\\frac{\\sigma_F}{n} \\frac{F_{\\max} - F_{\\min}}{(F_1 - F_{\\min})(F_{\\max} - F_1)}}{\\frac{\\sigma_F}{n} \\frac{F_{\\max} - F_{\\min}}{(F_2 - F_{\\min})(F_{\\max} - F_2)}} = \\frac{(F_2 - F_{\\min})(F_{\\max} - F_2)}{(F_1 - F_{\\min})(F_{\\max} - F_1)} $$\n代入计算出的分母值：\n$$ \\mathrm{Ratio} = \\frac{202500}{38475} $$\n化简该分数：\n$$ \\mathrm{Ratio} = \\frac{202500 \\div 25}{38475 \\div 25} = \\frac{8100}{1539} $$\n$$ \\mathrm{Ratio} = \\frac{8100 \\div 9}{1539 \\div 9} = \\frac{900}{171} $$\n$$ \\mathrm{Ratio} = \\frac{900 \\div 9}{171 \\div 9} = \\frac{100}{19} $$\n作为小数，此比率为 $100 \\div 19 \\approx 5.263157...$。\n四舍五入到四位有效数字，该比率为 $5.263$。",
            "answer": "$$\\boxed{5.263}$$"
        },
        {
            "introduction": "在量子力学中，“观察者效应”描述了测量行为本身会改变被观测系统的状态。一个类似的原理也适用于钙成像：我们引入的指示剂分子本身就是钙缓冲剂，它们会改变我们旨在测量的钙动态过程。本练习深入探讨了这一关键问题，教您如何量化指示剂的“缓冲效应”，并确定一个合适的浓度以最大限度地减少这种实验伪影 。",
            "id": "4188084",
            "problem": "一个单室神经元通过基于荧光的钙成像进行观察。胞质溶胶中含有一种内源性钙结合缓冲液和一种添加的合成指示剂，每种都被建模为质量作用定律下的单一位点、快速、可逆的结合反应：$B + \\mathrm{Ca}^{2+} \\rightleftharpoons BC$，其解离常数为 $K_{d} = \\frac{[B][\\mathrm{Ca}^{2+}]}{[BC]}$。基线游离钙浓度为 $[\\mathrm{Ca}^{2+}]_0$。对于 $[\\mathrm{Ca}^{2+}]_0$ 附近的小瞬变，单个缓冲液的线性缓冲能力定义为 $\\kappa \\equiv \\frac{d[BC]}{d[\\mathrm{Ca}^{2+}]}$，它取决于总缓冲液浓度 $B_{T}$ 和在 $[\\mathrm{Ca}^{2+}]_0$ 处的 $K_{d}$。假设一级钙外排作用于总胞质钙，速率常数为 $\\gamma$，并且瞬变足够小且足够快，使得快速缓冲近似和在 $[\\mathrm{Ca}^{2+}]_0$ 附近的线性化是有效的。\n\n给定以下科学上真实的参数：\n- 基线游离钙 $[\\mathrm{Ca}^{2+}]_{0} = 50\\,\\mathrm{nM}$。\n- 内源性缓冲液总浓度 $B_{e,T} = 60\\,\\mathrm{\\mu M}$，解离常数 $K_{e,d} = 500\\,\\mathrm{nM}$。\n- 指示剂解离常数 $K_{d} = 200\\,\\mathrm{nM}$。\n- 用于评估的指示剂总浓度 $B_{d,T} = 5\\,\\mathrm{\\mu M}$。\n- 测量噪声水平表示为分数幅度不确定性 $\\eta = 0.05$。\n\n仅从 $K_{d}$ 的质量作用定义、线性缓冲能力 $\\kappa \\equiv \\frac{d[BC]}{d[\\mathrm{Ca}^{2+}]}$ 的定义、对于增加少量总胞质钙的流入的钙守恒，以及总钙以速率常数 $\\gamma$ 进行的一级外排开始：\n1. 推导由于添加指示剂相对于没有指示剂的情况，游离钙增量峰值的分数扰动的表达式，用内源性和指示剂缓冲能力表示。\n2. 在相同假设下，推导由于添加指示剂相对于没有指示剂的情况，观察到的游离钙瞬变衰减率的分数扰动的表达式。\n3. 使用给定的参数值，计算评估浓度 $B_{d,T} = 5\\,\\mathrm{\\mu M}$ 时峰值和衰减率的数值分数扰动。\n4. 通过将染料引起的扰动可忽略的区域定义为染料引起的峰值和衰减率的分数减少均不超过测量噪声水平 $\\eta$ 的条件，求解最大允许指示剂浓度 $B_{d,T}^{\\ast}$ 的封闭形式解，然后进行数值计算。\n\n以 $\\mathrm{\\mu M}$ 为单位表示您的 $B_{d,T}^{\\ast}$ 最终答案，并四舍五入到三位有效数字。最终答案必须是单个实数。不要在最终答案框内包含任何单位。",
            "solution": "该问题要求分析合成钙指示剂对神经元钙瞬变的扰动效应。问题陈述的验证已确认其具有科学依据、问题设定良好且客观。因此，我们可以进行完整解答。\n\n该分析基于一个单室模型，该模型在快速缓冲近似下包含两种钙结合缓冲液（内源性“e”和指示剂染料“d”）。\n\n首先，我们推导一个通用缓冲液的线性缓冲能力 $\\kappa$ 的表达式，其总浓度为 $B_T$，解离常数为 $K_d$。结合反应为 $B + \\mathrm{Ca}^{2+} \\rightleftharpoons BC$。\n总缓冲液浓度是守恒的：$B_T = [B] + [BC]$。\n解离常数定义为 $K_d = \\frac{[B][\\mathrm{Ca}^{2+}]}{[BC]}$。由此，我们将游离缓冲液浓度表示为 $[B] = \\frac{K_d [BC]}{[\\mathrm{Ca}^{2+}]}$。\n将其代入守恒方程，得到 $B_T = [BC] \\left(1 + \\frac{K_d}{[\\mathrm{Ca}^{2+}]}\\right)$。\n求解钙结合缓冲液的浓度 $[BC]$，得到：\n$$[BC] = \\frac{B_T [\\mathrm{Ca}^{2+}]}{K_d + [\\mathrm{Ca}^{2+}]}$$\n线性缓冲能力 $\\kappa$ 定义为 $[BC]$ 相对于 $[\\mathrm{Ca}^{2+}]$ 的导数，在基线游离钙浓度 $[\\mathrm{Ca}^{2+}]_0$ 处求值。使用除法定则进行微分：\n$$\\kappa \\equiv \\frac{d[BC]}{d[\\mathrm{Ca}^{2+}]} \\bigg|_{[\\mathrm{Ca}^{2+}]_0} = \\frac{B_T(K_d + [\\mathrm{Ca}^{2+}]_0) - B_T[\\mathrm{Ca}^{2+}]_0(1)}{(K_d + [\\mathrm{Ca}^{2+}]_0)^2} = \\frac{B_T K_d}{(K_d + [\\mathrm{Ca}^{2+}]_0)^2}$$\n该表达式将缓冲能力 $\\kappa$ 与缓冲液的性质和静息钙水平联系起来。\n\n接下来，我们对钙动力学进行建模。令 $[\\mathrm{Ca}]_T$ 为胞质溶胶中的总钙浓度。它是游离钙、与内源性缓冲液结合的钙 ($BC_e$) 和与指示剂染料结合的钙 ($BC_d$) 的总和：\n$$[\\mathrm{Ca}]_T = [\\mathrm{Ca}^{2+}] + [BC_e] + [BC_d]$$\n对于静息状态附近的微小扰动 ($\\Delta$)，我们可以使用线性缓冲能力 $\\kappa_e$ 和 $\\kappa_d$：\n$$\\Delta[\\mathrm{Ca}]_T = \\Delta[\\mathrm{Ca}^{2+}] + \\Delta[BC_e] + \\Delta[BC_d] \\approx \\Delta[\\mathrm{Ca}^{2+}] + \\kappa_e \\Delta[\\mathrm{Ca}^{2+}] + \\kappa_d \\Delta[\\mathrm{Ca}^{2+}]$$\n$$\\Delta[\\mathrm{Ca}]_T = (1 + \\kappa_e + \\kappa_d) \\Delta[\\mathrm{Ca}^{2+}]$$\n项 $(1 + \\kappa_e + \\kappa_d)$ 是总钙变化与由此产生的游离钙变化之间的比率。\n\n总钙的动力学由流入 $I_{Ca}(t)$ 和一个作用于总胞质钙、速率常数为 $\\gamma$ 的一级外排过程所控制。这在问题中已明确说明。总钙变化 $\\Delta[\\mathrm{Ca}]_T$ 的速率方程为：\n$$\\frac{d(\\Delta[\\mathrm{Ca}]_T)}{dt} = I_{Ca}(t) - \\gamma \\Delta[\\mathrm{Ca}]_T$$\n令 $\\Delta c(t) = \\Delta[\\mathrm{Ca}^{2+}](t)$。我们代入 $\\Delta[\\mathrm{Ca}]_T = (1 + \\kappa_e + \\kappa_d) \\Delta c(t)$：\n$$\\frac{d}{dt} \\left[ (1 + \\kappa_e + \\kappa_d) \\Delta c(t) \\right] = I_{Ca}(t) - \\gamma (1 + \\kappa_e + \\kappa_d) \\Delta c(t)$$\n由于对于小瞬变，$\\kappa_e$ 和 $\\kappa_d$ 是常数，我们有：\n$$(1 + \\kappa_e + \\kappa_d) \\frac{d(\\Delta c)}{dt} = I_{Ca}(t) - \\gamma (1 + \\kappa_e + \\kappa_d) \\Delta c(t)$$\n$$\\frac{d(\\Delta c)}{dt} = \\frac{I_{Ca}(t)}{1 + \\kappa_e + \\kappa_d} - \\gamma \\Delta c(t)$$\n这是控制游离钙瞬变的一阶常微分方程。\n\n为了找到峰值振幅和衰减率，我们将流入建模为 $t=0$ 时的瞬时脉冲，$I_{Ca}(t) = J_{Ca} \\delta(t)$，其中 $J_{Ca}$ 是单位体积的总钙流入量。该脉冲导致总钙瞬时增加，$\\Delta[\\mathrm{Ca}]_T(0^+) = J_{Ca}$。\n由此产生的游离钙增量峰值为：\n$$\\Delta c_{peak} = \\Delta c(0^+) = \\frac{\\Delta[\\mathrm{Ca}]_T(0^+)}{1 + \\kappa_e + \\kappa_d} = \\frac{J_{Ca}}{1 + \\kappa_e + \\kappa_d}$$\n对于 $t > 0$，$I_{Ca}(t) = 0$，动力学方程简化为：\n$$\\frac{d(\\Delta c)}{dt} = - \\gamma \\Delta c(t)$$\n解为指数衰减 $\\Delta c(t) = \\Delta c_{peak} \\exp(-\\gamma t)$。因此，游离钙瞬变的衰减率为 $\\gamma$。\n\n现在我们可以解决问题的具体部分了。\n\n**1. 游离钙增量峰值的分数扰动**\n没有指示剂时，$\\kappa_d = 0$。峰值振幅为 $\\Delta c_{peak,0} = \\frac{J_{Ca}}{1 + \\kappa_e}$。\n有指示剂时，峰值振幅为 $\\Delta c_{peak,d} = \\frac{J_{Ca}}{1 + \\kappa_e + \\kappa_d}$。\n分数扰动 $P_{peak}$ 为：\n$$P_{peak} = \\frac{\\Delta c_{peak,d} - \\Delta c_{peak,0}}{\\Delta c_{peak,0}} = \\frac{\\Delta c_{peak,d}}{\\Delta c_{peak,0}} - 1 = \\frac{1 + \\kappa_e}{1 + \\kappa_e + \\kappa_d} - 1 = \\frac{(1 + \\kappa_e) - (1 + \\kappa_e + \\kappa_d)}{1 + \\kappa_e + \\kappa_d}$$\n$$P_{peak} = \\frac{-\\kappa_d}{1 + \\kappa_e + \\kappa_d}$$\n\n**2. 观察到的衰减率的分数扰动**\n根据我们直接从问题陈述推导出的模型，无论是否存在指示剂，衰减率都是 $\\gamma$。\n无指示剂时的衰减率：$\\gamma_0 = \\gamma$。\n有指示剂时的衰减率：$\\gamma_d = \\gamma$。\n分数扰动 $P_{rate}$ 为：\n$$P_{rate} = \\frac{\\gamma_d - \\gamma_0}{\\gamma_0} = \\frac{\\gamma - \\gamma}{\\gamma} = 0$$\n\n**3. 数值分数扰动**\n首先，我们使用给定参数计算缓冲能力 $\\kappa_e$ 和 $\\kappa_d$。我们必须使用一致的单位，因此我们将所有浓度转换为 $\\mathrm{\\mu M}$。\n$[\\mathrm{Ca}^{2+}]_{0} = 50\\,\\mathrm{nM} = 0.05\\,\\mathrm{\\mu M}$。\n内源性缓冲液：$B_{e,T} = 60\\,\\mathrm{\\mu M}$，$K_{e,d} = 500\\,\\mathrm{nM} = 0.5\\,\\mathrm{\\mu M}$。\n$$\\kappa_e = \\frac{B_{e,T} K_{e,d}}{(K_{e,d} + [\\mathrm{Ca}^{2+}]_{0})^2} = \\frac{(60)(0.5)}{(0.5 + 0.05)^2} = \\frac{30}{0.55^2} = \\frac{30}{0.3025} \\approx 99.17355$$\n指示剂：$B_{d,T} = 5\\,\\mathrm{\\mu M}$，$K_{d} = 200\\,\\mathrm{nM} = 0.2\\,\\mathrm{\\mu M}$。\n$$\\kappa_d = \\frac{B_{d,T} K_{d}}{(K_{d} + [\\mathrm{Ca}^{2+}]_{0})^2} = \\frac{(5)(0.2)}{(0.2 + 0.05)^2} = \\frac{1}{0.25^2} = \\frac{1}{0.0625} = 16$$\n现在我们计算扰动：\n$$P_{peak} = \\frac{-16}{1 + 99.17355 + 16} = \\frac{-16}{116.17355} \\approx -0.1377$$\n$$P_{rate} = 0$$\n因此，浓度为 $5\\,\\mathrm{\\mu M}$ 的指示剂使峰值振幅降低了约 $13.8\\%$，并且对衰减率没有影响。\n\n**4. 最大允许指示剂浓度 $B_{d,T}^{\\ast}$**\n条件是峰值和衰减率的分数*减少*量均不超过噪声水平 $\\eta = 0.05$。分数减少量是分数扰动的绝对值（对于减少的情况）。\n对于衰减率，减少量为 $|P_{rate}| = 0$，小于 $\\eta = 0.05$，因此该条件始终满足。\n对于峰值振幅，减少量为 $|P_{peak}| = \\frac{\\kappa_d}{1 + \\kappa_e + \\kappa_d}$。条件是：\n$$\\frac{\\kappa_d}{1 + \\kappa_e + \\kappa_d} \\le \\eta$$\n我们求解这个关于 $\\kappa_d$ 的不等式：\n$$\\kappa_d \\le \\eta(1 + \\kappa_e + \\kappa_d)$$\n$$\\kappa_d(1 - \\eta) \\le \\eta(1 + \\kappa_e)$$\n$$\\kappa_d \\le \\frac{\\eta(1 + \\kappa_e)}{1 - \\eta}$$\n这定义了指示剂的最大允许缓冲能力 $\\kappa_d^{\\ast}$。现在，我们求解相应的最大浓度 $B_{d,T}^{\\ast}$。\n根据 $\\kappa_d$ 的定义，我们有 $\\kappa_d = \\frac{B_{d,T} K_{d}}{(K_{d} + [\\mathrm{Ca}^{2+}]_{0})^2}$。令 $\\kappa_d = \\kappa_d^{\\ast}$ 和 $B_{d,T} = B_{d,T}^{\\ast}$：\n$$B_{d,T}^{\\ast} = \\kappa_d^{\\ast} \\frac{(K_{d} + [\\mathrm{Ca}^{2+}]_{0})^2}{K_{d}}$$\n代入 $\\kappa_d^{\\ast}$ 的表达式，我们得到 $B_{d,T}^{\\ast}$ 的封闭形式解：\n$$B_{d,T}^{\\ast} = \\frac{\\eta(1 + \\kappa_e)}{1 - \\eta} \\frac{(K_{d} + [\\mathrm{Ca}^{2+}]_{0})^2}{K_{d}}$$\n最后，我们对此表达式进行数值计算。\n$\\eta = 0.05$。\n$\\kappa_e \\approx 99.17355$。\n$$ \\kappa_d^{\\ast} = \\frac{0.05(1 + 99.17355)}{1 - 0.05} = \\frac{0.05(100.17355)}{0.95} \\approx 5.27229 $$\n现在我们计算以 $\\mathrm{\\mu M}$ 为单位的浓度：\n$$ B_{d,T}^{\\ast} = (5.27229) \\frac{(0.2 + 0.05)^2}{0.2} = (5.27229) \\frac{0.25^2}{0.2} = (5.27229) \\frac{0.0625}{0.2} = (5.27229)(0.3125) $$\n$$ B_{d,T}^{\\ast} \\approx 1.64759\\,\\mathrm{\\mu M} $$\n四舍五入到三位有效数字，最大允许指示剂浓度为 $1.65\\,\\mathrm{\\mu M}$。",
            "answer": "$$\\boxed{1.65}$$"
        },
        {
            "introduction": "在理解了指示剂的生物物理特性及其与细胞的相互作用之后，我们必须将注意力转向测量设备本身。任何相机采集的数据都不可避免地会受到噪声的干扰，这些噪声主要来源于光的量子性质（散粒噪声）和相机的电子器件（读出噪声）。这个实践练习提供了一个实用的框架来为这些噪声源建模，使您能够表征成像系统的性能，并从噪声中分离出真实的信号 。",
            "id": "4188069",
            "problem": "您正在使用光子计数模型和带有电子读出装置的相机来分析钙成像中的荧光信号。基本假设是：光子到达遵循泊松统计，具有独立的电子读出噪声，并且相机响应是线性的。从以下基本原理出发：(i) 泊松统计意味着，如果检测到的光电子数量用 $N$ 表示，其均值为 $E[N] = \\mu_e$，那么方差为 $Var(N) = \\mu_e$；(ii) 随机变量 $X$ 通过 $Y = a X$ 进行线性变换，其方差会按 $Var(Y) = a^2 Var(X)$ 的比例缩放；(iii) 独立随机变量的方差相加，因此如果 $X$ 和 $Z$ 是独立的，则 $Var(X+Z) = Var(X) + Var(Z)$；以及 (iv) 相机读出噪声可以建模为一个零均值高斯随机变量，其方差为 $Var(R) = \\sigma_r^2$。在这些假设下，以计数单位推导连接测量计数的方差与测量计数的均值之间的函数关系，并说明如何从测量数据中推断出由散粒噪声和读出噪声引起的贡献。然后，构建 Fano 因子（定义为方差与均值的比率），并用它来验证模型在不同亮度水平下的有效性。\n\n您的程序必须为每个提供的测试数据集执行以下操作：\n- 通过将一个线性模型拟合到上述从第一性原理推导出的方差-均值关系，从测量的平均计数和计数方差中估计有效增益 $k$（单位：计数/电子）和读出噪声标准差 $\\sigma_r$（单位：计数），并强制参数具有物理上的非负性。\n- 在每个亮度水平 $\\mu_i$（单位：计数）下计算测量的 Fano 因子 $F_i = Var_i / \\mu_i$，并使用您拟合的参数在相同的亮度水平下计算模型预测的 Fano 因子。\n- 对于每个数据集，报告一个三元组，其中包含估计的有效增益 $k$（单位：计数/电子）、估计的读出噪声标准差 $\\sigma_r$（单位：计数），以及在所有亮度水平上测量的和预测的 Fano 因子之间的最大绝对偏差（无量纲）。\n\n使用以下测试数据集套件，每个数据集由一个测量的平均计数数组和相应的测量计数方差数组指定。所有计数单位均为“计数”，所有方差单位均为“计数的平方”。亮度水平是使用线性传感器测量的荧光钙成像的典型值。\n\n- 数据集 1（中等亮度范围，混合噪声贡献）：\n  - 平均计数：$[\\;10,\\;30,\\;60,\\;120,\\;240,\\;480\\;]$\n  - 计数方差：$[\\;19.25,\\;45.25,\\;84.25,\\;162.25,\\;318.25,\\;630.25\\;]$\n\n- 数据集 2（低亮度范围，读出噪声更显著）：\n  - 平均计数：$[\\;2,\\;4,\\;8,\\;16,\\;32,\\;64\\;]$\n  - 计数方差：$[\\;17.8,\\;19.6,\\;23.2,\\;30.4,\\;44.8,\\;73.6\\;]$\n\n- 数据集 3（高亮度范围，散粒噪声占主导）：\n  - 平均计数：$[\\;1000,\\;2000,\\;4000,\\;8000\\;]$\n  - 计数方差：$[\\;1802.25,\\;3602.25,\\;7202.25,\\;14402.25\\;]$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个数据集，其本身也是一个 $[\\;k,\\;\\sigma_r,\\;d\\;]$ 形式的列表，其中 $k$ 的单位是计数/电子，$\\sigma_r$ 的单位是计数，而 $d$ 是 Fano 因子的最大绝对偏差（无量纲）。例如，输出格式必须为 $[\\;[k_1,\\sigma_{r,1},d_1],[k_2,\\sigma_{r,2},d_2],[k_3,\\sigma_{r,3},d_3]\\;]$。",
            "solution": "该问题要求推导相机噪声的函数关系，并应用该模型从实验数据中估计关键的传感器参数。推导和分析将基于所提供的第一性原理进行。\n\n首先，我们推导以相机计数表示的荧光信号的测量方差与测量均值之间的函数关系。设 $N_e$ 为一个像素在给定时间间隔内检测到的光电子数量。这是一个随机变量。根据原理 (i)，光子到达是一个泊松过程，因此如果光电子的平均数量为 $E[N_e] = \\mu_e$，那么方差为 $Var(N_e) = \\mu_e$。\n\n相机电子器件将这些光电子转换为以计数为单位的数字信号。设这个转换因子或增益为 $k$ 计数/电子。相机响应被认为是线性的。除了由光子产生的信号（散粒噪声）外，相机还引入了其自身的电子读出噪声，我们用随机变量 $R$ 表示。总的测量信号 $C$（以计数为单位）是这两个分量的和：\n$$C = k N_e + R$$\n读出噪声 $R$ 被假定为与光电子信号 $N_e$ 无关。\n\n我们首先求出测量信号的均值 $\\mu_c = E[C]$。利用期望算子的线性性质：\n$$\\mu_c = E[k N_e + R] = E[k N_e] + E[R] = k E[N_e] + E[R]$$\n根据原理 (iv)，读出噪声 $R$ 是一个零均值过程，因此 $E[R]=0$。所以，测量的平均信号与光电子的平均数量成正比：\n$$\\mu_c = k \\mu_e$$\n该方程通过增益 $k$ 将以计数为单位的平均信号 $\\mu_c$ 与以光电子为单位的平均信号 $\\mu_e$ 联系起来。我们可以用可测量量 $\\mu_c$ 来表示 $\\mu_e$，即 $\\mu_e = \\mu_c / k$。\n\n接下来，我们推导测量信号的方差 $Var_c = Var(C)$。由于信号分量 $k N_e$ 和读出噪声 $R$ 是独立的，根据原理 (iii)，它们的方差相加：\n$$Var_c = Var(k N_e + R) = Var(k N_e) + Var(R)$$\n根据原理 (iv)，读出噪声的方差为 $Var(R) = \\sigma_r^2$，其中 $\\sigma_r$ 是以计数为单位的读出噪声标准差。\n对于信号分量，我们使用原理 (ii) 关于线性变换下方差的缩放规则：\n$$Var(k N_e) = k^2 Var(N_e)$$\n代入原理 (i) 中的泊松性质 $Var(N_e) = \\mu_e$：\n$$Var(k N_e) = k^2 \\mu_e$$\n这一项 $k^2 \\mu_e$ 代表散粒噪声方差。为了用测量的平均计数 $\\mu_c$ 来表示它，我们代入 $\\mu_e = \\mu_c / k$：\n$$Var(k N_e) = k^2 \\left(\\frac{\\mu_c}{k}\\right) = k \\mu_c$$\n结合散粒噪声和读出噪声的方差分量，我们得到最终的函数关系：\n$$Var_c = k \\mu_c + \\sigma_r^2$$\n这个方程对于平均信号 $\\mu_c$ 是线性的。它表明，总的测量方差 $Var_c$ 是散粒噪声方差（与平均信号成线性关系）和读出噪声方差（一个恒定的偏移量）之和。这是许多科学成像传感器噪声特性的基本模型。\n\n为了从测量数据对 $(\\mu_{c,i}, Var_{c,i})$ 中推断参数 $k$ 和 $\\sigma_r^2$，可以对 $Var_c$ 与 $\\mu_c$ 进行线性回归。拟合线的斜率提供了增益 $k$ 的估计值，y轴截距提供了读出噪声方差 $\\sigma_r^2$ 的估计值。这两个参数在物理上都必须是非负的，即 $k \\ge 0$ 和 $\\sigma_r^2 \\ge 0$。因此，非负最小二乘线性拟合是合适的估计方法。\n\nFano 因子，定义为方差与均值的比率，是模型验证的一个有用工具。测量的 Fano 因子为 $F_{meas} = Var_c / \\mu_c$。使用我们推导的模型，预测的 Fano 因子为：\n$$F_{pred} = \\frac{k \\mu_c + \\sigma_r^2}{\\mu_c} = k + \\frac{\\sigma_r^2}{\\mu_c}$$\n该模型预测 Fano 因子不是恒定的，而是取决于信号水平 $\\mu_c$。对于高信号水平（$\\mu_c \\gg \\sigma_r^2/k$），Fano 因子接近一个等于增益 $k$ 的常数值。对于低信号水平，Fano 因子主要由读出噪声项决定并变得很大。测量的和预测的 Fano 因子之间的偏差 $d = \\max_i |F_{meas,i} - F_{pred,i}|$，可作为模型与数据拟合优度的度量。\n\n解决该问题的算法如下：\n1. 对于每个包含测量平均计数 $(\\mu_{c,i})$ 和方差 $(Var_{c,i})$ 的数据集，构建一个线性系统 $A \\mathbf{x} \\approx \\mathbf{b}$，其中 $\\mathbf{x} = [k, \\sigma_r^2]^T$，设计矩阵 $A$ 的列为 $[\\mu_{c,i}]$ 和一列 1，而 $\\mathbf{b}$ 是向量 $[Var_{c,i}]$。\n2. 使用非负最小二乘算法求解 $\\mathbf{x}$，以找到估计的增益 $k$ 和读出噪声方差 $\\sigma_r^2$，同时遵循物理约束条件 $k \\ge 0$ 和 $\\sigma_r^2 \\ge 0$。\n3. 计算读出噪声标准差 $\\sigma_r = \\sqrt{\\sigma_r^2}$。\n4. 对于每个数据点 $i$，计算测量的 Fano 因子 $F_{meas,i} = Var_{c,i} / \\mu_{c,i}$ 和预测的 Fano 因子 $F_{pred,i} = k + \\sigma_r^2 / \\mu_{c,i}$。\n5. 找出最大绝对偏差 $d = \\max_i |F_{meas,i} - F_{pred,i}|$。\n6. 报告每个数据集的三元组 $[k, \\sigma_r, d]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import lsq_linear\n\ndef solve():\n    \"\"\"\n    Derives sensor parameters from noise measurements and validates the model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            np.array([10., 30., 60., 120., 240., 480.]),\n            np.array([19.25, 45.25, 84.25, 162.25, 318.25, 630.25])\n        ),\n        (\n            np.array([2., 4., 8., 16., 32., 64.]),\n            np.array([17.8, 19.6, 23.2, 30.4, 44.8, 73.6])\n        ),\n        (\n            np.array([1000., 2000., 4000., 8000.]),\n            np.array([1802.25, 3602.25, 7202.25, 14402.25])\n        )\n    ]\n\n    results = []\n    for mean_counts, var_counts in test_cases:\n        # The derived model is Var = k * mu + sigma_r^2.\n        # This is a linear model y = m*x + c, where:\n        # y = Var (variance of counts)\n        # x = mu (mean counts)\n        # m = k (effective gain, counts/electron)\n        # c = sigma_r^2 (read noise variance, counts^2)\n\n        # Set up the linear least-squares problem Ax = b.\n        # The design matrix A has the mean counts as the first column\n        # and a column of ones for the intercept term.\n        A = np.vstack([mean_counts, np.ones(len(mean_counts))]).T\n        b = var_counts\n\n        # We need to solve for x = [k, sigma_r^2] subject to non-negativity.\n        # We use scipy.optimize.lsq_linear for this constrained regression.\n        # The bounds are [0, inf] for both parameters.\n        bounds = ([0, 0], [np.inf, np.inf])\n        res = lsq_linear(A, b, bounds=bounds)\n        \n        # Extract the estimated parameters\n        k_est, sigma_r_sq_est = res.x\n        \n        # Calculate the read noise standard deviation\n        sigma_r_est = np.sqrt(sigma_r_sq_est)\n\n        # Compute the Fano factors and the maximum deviation\n        # Measured Fano factor: F_meas = Var_i / mu_i\n        fano_meas = var_counts / mean_counts\n        \n        # Predicted Fano factor from the model: F_pred = k + sigma_r^2 / mu_i\n        fano_pred = k_est + sigma_r_sq_est / mean_counts\n        \n        # Maximum absolute deviation between measured and predicted Fano factors\n        max_fano_dev = np.max(np.abs(fano_meas - fano_pred))\n\n        # Store the results for this dataset\n        results.append([k_est, sigma_r_est, max_fano_dev])\n\n    # Final print statement in the exact required format.\n    # The output format is a list of lists: [[k1, sr1, d1], [k2, sr2, d2], ...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}