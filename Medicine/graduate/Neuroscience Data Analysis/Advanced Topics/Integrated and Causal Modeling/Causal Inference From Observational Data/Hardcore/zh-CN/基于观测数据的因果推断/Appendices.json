{
    "hands_on_practices": [
        {
            "introduction": "从观察数据中推断因果关系的核心挑战是处理混淆。有向无环图（DAGs）为我们提供了一个严谨的框架，以识别和阻断混淆路径。这个练习 () 旨在通过应用后门准则，教会您如何系统地识别一个有效的调整集，从而消除混淆并准确估计总因果效应。掌握这项技能对于任何希望从复杂的观测数据中得出可靠因果结论的研究人员都至关重要。",
            "id": "4145163",
            "problem": "一个行为神经科学实验室分析了无创海马体刺激强度对记忆表现的观察效应。设 $A$ 表示刺激强度，$Y$ 表示延迟回忆记忆分数，$M$ 表示编码过程中的海马体θ波段功率（$A$ 到 $Y$ 因果路径上的一个生理中介变量），$Z_1$ 表示基线海马体放电率，$Z_2$ 表示神经炎症指数。此外，数据集还包含以下测量的协变量：$I$（一个影响 $A$ 但不影响 $Y$ 的诊所排班工具变量），$C$（一个受 $Z_1$ 和 $Z_2$ 影响但对 $A$ 或 $Y$ 没有直接影响的病例选择指标），以及 $B$（一个与所有其他变量在统计上独立且对 $A$ 或 $Y$ 没有因果效应的基线问卷分数）。假设存在以下有向无环图（DAG）：存在有向边 $Z_1 \\to A$、$Z_1 \\to Y$、$Z_2 \\to A$、$Z_2 \\to Y$、$A \\to M$、$M \\to Y$ 和 $I \\to A$，以及 $Z_1 \\to C$ 和 $Z_2 \\to C$。图中没有其他箭头，并且除了已显示的变量外，不存在未测量的混杂因素。所有变量的测量均无误差。目标是在一致性、正性以及稳定单元处理值假设（SUTVA）等标准可识别性条件下，$A$ 对 $Y$ 的总因果效应。\n\n使用因果图模型中的后门准则，识别以下哪些候选协变量集是用于从观测数据中识别 $A$ 对 $Y$ 的总效应的有效调整集。然后，根据该图解释为什么 $\\{Z_1, Z_2\\}$ 是一个最小有效调整集。\n\n选择所有适用项。\n\nA. $\\{Z_1, Z_2\\}$\n\nB. $\\{Z_1\\}$\n\nC. $\\{Z_2\\}$\n\nD. $\\{Z_1, Z_2, M\\}$\n\nE. $\\{Z_1, Z_2, C\\}$\n\nF. $\\{Z_1, Z_2, I\\}$\n\nG. $\\{Z_1, Z_2, B\\}$\n\nH. $\\{Z_1, Z_2, I, B\\}$\n\n请从 d-分离 和后门准则的定义开始，阐述你的推理，并论证为什么在此图中 $\\{Z_1, Z_2\\}$ 是用于识别总效应的最小集，而不会引入偏差或阻断 $A$ 对 $Y$ 的任何部分因果效应。",
            "solution": "我们从基本原理开始。在有向无环图（DAG）中，如果满足以下任一条件，一条路径就被一个节点集所阻断：（i）路径包含一个被该节点集作为条件的非对撞节点，或者（ii）路径包含一个未被该节点集作为条件且其任何后代节点也未被作为条件的对撞节点。如果两组变量之间的每一条路径都被某个条件集所阻断，则称这两组变量在该条件集下是d-分离的。后门准则规定：一个集合 $\\mathcal{S}$ 是识别 $A$ 对 $Y$ 总效应的有效调整集，需要满足（i）$\\mathcal{S}$ 中没有任何元素是 $A$ 的后代节点，以及（ii）$\\mathcal{S}$ 阻断了从 $A$ 到 $Y$ 的每一条后门路径（即，每一条以指向 $A$ 的箭头开始的、$A$ 与 $Y$ 之间的路径）。在一致性、正性和稳定单元处理值假设（SUTVA）下，如果后门准则成立，那么总效应可以通过对 $\\mathcal{S}$ 进行调整来识别。\n\n现在我们分析给定的DAG。从 $A$ 到 $Y$ 的因果（前门）路径是 $A \\to M \\to Y$。当目标是总效应时，我们绝不能阻断任何因果路径；特别是，我们不能对中介变量 $M$ 或 $A$ 的任何后代节点进行调整。\n\n从 $A$ 到 $Y$ 的后门路径是那些以指向 $A$ 的箭头开始的路径。根据该图：\n- 存在一条后门路径 $A \\leftarrow Z_1 \\to Y$。\n- 存在一条后门路径 $A \\leftarrow Z_2 \\to Y$。\n- 存在一个涉及对撞节点 $C$ 的后门结构：$A \\leftarrow Z_1 \\to C \\leftarrow Z_2 \\to Y$。这条路径在对撞节点 $C$ 处默认是阻断的，但如果我们以 $C$ 为条件（或其任何后代节点，此处不存在），我们就会打开这条路径，从而引入偏差。\n- 变量 $I$ 是一个工具变量，仅有 $I \\to A$，并且从 $I$ 到 $Y$ 除了通过 $A$ 之外没有其他路径。不存在通过 $I$ 的后门路径，因为 $I$ 没有父节点，也没有指向 $Y$ 的箭头。\n\n因此，要阻断所有后门路径，只需对 $Z_1$ 和 $Z_2$ 进行调整，前提是我们不以像 $C$ 这样的对撞节点或像 $M$ 这样的 $A$ 的后代节点为条件。\n\n我们根据后门准则来评估每个候选集。\n\n选项 A: $\\{Z_1, Z_2\\}$。此集合不包含 $A$ 的后代节点。以 $Z_1$ 为条件阻断了 $A \\leftarrow Z_1 \\to Y$，以 $Z_2$ 为条件阻断了 $A \\leftarrow Z_2 \\to Y$。通过 $C$ 的对撞路径仍然是阻断的，因为我们没有以 $C$ 或 $C$ 的任何后代节点为条件。因此，所有后门路径都被阻断，且没有因果路径被阻断。结论：正确。\n\n选项 B: $\\{Z_1\\}$。这以 $Z_1$ 为条件，但没有以 $Z_2$ 为条件，使得后门路径 $A \\leftarrow Z_2 \\to Y$ 未被阻断。因此，偏差仍然存在。结论：不正确。\n\n选项 C: $\\{Z_2\\}$。与选项 B 对称，这使得后门路径 $A \\leftarrow Z_1 \\to Y$ 未被阻断。结论：不正确。\n\n选项 D: $\\{Z_1, Z_2, M\\}$。虽然 $\\{Z_1, Z_2\\}$ 阻断了所有后门路径，但添加 $M$ 会对因果路径 $A \\to M \\to Y$ 上的一个中介变量进行控制。对于总效应而言，这将阻断部分因果效应，并且在这种调整下只能识别受控直接效应，而不是总效应。此外，后门准则要求集合中不包含 $A$ 的后代节点。由于 $M$ 是 $A$ 的后代节点，这违反了该准则。结论：不正确。\n\n选项 E: $\\{Z_1, Z_2, C\\}$。以 $C$ 为条件会打开对撞路径 $A \\leftarrow Z_1 \\to C \\leftarrow Z_2 \\to Y$，从而在 $A$ 和 $Y$ 之间产生一条新的后门路径，引入了伪关联。因此，即使包含了 $Z_1$ 和 $Z_2$，添加 $C$ 也会引入偏差。结论：不正确。\n\n选项 F: $\\{Z_1, Z_2, I\\}$。将 $I$ 添加到 $\\{Z_1, Z_2\\}$ 中不会引入任何新的开放后门路径，因为 $I$ 不是 $A$ 的后代节点，不是对撞节点，并且除了通过 $A$ 之外没有到 $Y$ 的路径。该集合阻断了所有后门路径，并且没有阻断任何因果路径。虽然对于识别而言是多余的，但它仍然是一个有效的调整集。结论：正确。\n\n选项 G: $\\{Z_1, Z_2, B\\}$。变量 $B$ 与所有变量独立，并且没有因果关系；以 $B$ 为条件不会打开或关闭任何路径。因此，该集合仍然通过 $Z_1$ 和 $Z_2$ 阻断了必要的后门路径，并且没有阻断任何因果路径。结论：正确。\n\n选项 H: $\\{Z_1, Z_2, I, B\\}$。根据与选项 F 和 G 相同的推理，将 $I$ 和 $B$ 添加到 $\\{Z_1, Z_2\\}$ 中不会产生偏差或阻断因果路径。后门路径仍然被阻断，并且没有以 $A$ 的后代节点或对撞节点为条件。结论：正确。\n\n为什么 $\\{Z_1, Z_2\\}$ 是最小的：一个有效的调整集是最小的，如果它的任何真子集都不是有效的调整集。考虑两个真子集 $\\{Z_1\\}$ 和 $\\{Z_2\\}$。集合 $\\{Z_1\\}$ 未能阻断后门路径 $A \\leftarrow Z_2 \\to Y$，使得由 $Z_2$ 引起的混杂未被处理。集合 $\\{Z_2\\}$ 未能阻断后门路径 $A \\leftarrow Z_1 \\to Y$，使得由 $Z_1$ 引起的混杂未被处理。空集和任何其他真子集（例如 $\\varnothing$）也显然不成立。因此，$\\{Z_1, Z_2\\}$ 是阻断所有后门路径且不包含 $A$ 的后代节点或对撞节点的最小集合，使其成为识别总效应的最小集。任何不包含像 $M$ 或 $C$ 这样的禁止变量的 $\\{Z_1, Z_2\\}$ 的严格超集也是有效的，但不是最小的；这些超集（例如 $\\{Z_1, Z_2, I\\}$, $\\{Z_1, Z_2, B\\}$）不会改变 $A$ 和 $Y$ 之间的d-分离关系，但可能会影响统计效率，而不影响可识别性。",
            "answer": "$$\\boxed{AFGH}$$"
        },
        {
            "introduction": "在控制变量时，一个常见的直觉是“调整的变量越多越好”，但这可能是一个危险的误区。调整不当的变量，特别是“对撞机”（collider），不仅无益，反而会引入原本不存在的偏误。这个练习 () 通过一个具体的神经科学场景和数学推导，揭示了调节对撞机如何打开非因果路径，从而产生虚假关联。理解对撞机偏误对于避免在数据分析中得出错误结论至关重要。",
            "id": "4145204",
            "problem": "一项观察性脑电图（EEG）研究检验了连续的刺激强度 $X$ 是否影响伽马波段功率 $Y$。一种预处理算法通过结合与刺激锁时的特征和信号方差特征来生成一个伪迹检测标志 $M$。假设存在一个未被观测到的运动相关伪迹源 $U$，它污染了伽马波段。考虑一个有向无环图（DAG），其箭头为 $X \\to M \\leftarrow U \\to Y$，且没有从 $X$ 到 $Y$ 的直接箭头。假设一个结构因果模型（SCM），其具有线性高斯方程：$X \\sim \\mathcal{N}(0,1)$，$U \\sim \\mathcal{N}(0,1)$，$\\varepsilon_M \\sim \\mathcal{N}(0,\\sigma_M^2)$，$\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$，所有这些都是相互独立的；$M = aX + bU + \\varepsilon_M$ 且 $Y = cU + \\varepsilon_Y$，其中 $a$、$b$、$c$ 是严格为正的常数。使用高斯图模型中 d-分离和条件独立性的第一性原理，确定以 $M$ 为条件（通过回归调整或限制在具有特定 $M$ 值的时期）对 $X$ 和 $Y$ 之间关联的影响。哪个选项是正确的？\n\nA. 在此模型中 $X \\perp Y \\mid M$ 成立，因此按 $M$ 进行筛选或调整不会引入偏倚。\n\nB. 如果 $a, b, c  0$，那么 $\\operatorname{Cov}(X,Y \\mid M) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} \\neq 0$，因此以 $M$ 为条件会打开 $X$ 和 $Y$ 之间的伪关联。\n\nC. $\\operatorname{Cov}(X,Y \\mid M) = \\dfrac{ab}{c}$，因此以 $M$ 为条件会产生一个正关联，其大小与 $\\sigma_M^2$ 无关。\n\nD. 以 $M$ 为条件会阻断 $U$ 对 $Y$ 的影响，从而从观察数据中得到 $X$ 对 $Y$ 的平均因果效应的无偏估计。",
            "solution": "给定的有向无环图（DAG）是 $X \\to M \\leftarrow U \\to Y$。节点 $M$ 是 $X$ 和 $Y$ 之间路径上的一个对撞节点，因为有两条箭头指向它。问题要求确定以这个对撞节点 $M$ 为条件的影响。\n\n首先，我们使用 d-分离的规则来分析因果结构。\n1.  在刺激 $X$ 和神经响应 $Y$ 之间存在一条路径：$X \\to M \\leftarrow U \\to Y$。\n2.  无条件地，这条路径被对撞节点 $M$ 阻断。由于 $X$ 和 $Y$ 之间没有其他路径，$X$ 和 $Y$ 是 d-分离的。在因果图模型中，d-分离意味着条件独立性。因此，$X$ 和 $Y$ 是边缘独立的，记作 $X \\perp Y$。这意味着在没有条件限制的情况下，$X$ 和 $Y$ 之间没有统计关联。$X$ 对 $Y$ 的真实平均因果效应是 $0$，因为没有从 $X$ 到 $Y$ 的有向路径。观测到的关联正确地反映了这一点。\n3.  当我们以对撞节点 $M$ 为条件时，路径 $X \\to M \\leftarrow U \\to Y$ 变得未被阻断或“打开”。这会在 $X$ 和 $Y$ 之间引入一个统计关联。因此，$X$ 和 $Y$ 在以 $M$ 为条件下不是独立的，记作 $X \\not\\perp Y \\mid M$。这种引入的关联是伪关联；它不反映 $X$ 和 $Y$ 之间的因果关系。以这种方式对对撞节点进行条件化是一种偏倚的来源，称为对撞偏倚或伯克森悖论。\n\n接下来，我们使用所提供的线性高斯结构因果模型（SCM）对条件协方差 $\\operatorname{Cov}(X, Y \\mid M)$ 进行定量计算，以证实这一定性分析。对于多元高斯分布，零协方差等价于统计独立性。\n\nSCM方程为：\n$M = aX + bU + \\varepsilon_M$\n$Y = cU + \\varepsilon_Y$\n\n变量 $X, U, \\varepsilon_M, \\varepsilon_Y$ 相互独立，其分布如下：\n$X \\sim \\mathcal{N}(0,1)$，所以 $\\operatorname{Var}(X) = 1$。\n$U \\sim \\mathcal{N}(0,1)$，所以 $\\operatorname{Var}(U) = 1$。\n$\\varepsilon_M \\sim \\mathcal{N}(0,\\sigma_M^2)$，所以 $\\operatorname{Var}(\\varepsilon_M) = \\sigma_M^2$。\n$\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$，所以 $\\operatorname{Var}(\\varepsilon_Y) = \\sigma_Y^2$。\n\n在多元高斯系统中，条件协方差的公式为：\n$$ \\operatorname{Cov}(X, Y \\mid M) = \\operatorname{Cov}(X, Y) - \\operatorname{Cov}(X, M) \\operatorname{Var}(M)^{-1} \\operatorname{Cov}(M, Y) $$\n\n我们计算每一项：\n1.  $\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(X, cU + \\varepsilon_Y) = c \\operatorname{Cov}(X, U) + \\operatorname{Cov}(X, \\varepsilon_Y)$。由于 $X$、$U$ 和 $\\varepsilon_Y$ 是独立的，$\\operatorname{Cov}(X, U) = 0$ 且 $\\operatorname{Cov}(X, \\varepsilon_Y) = 0$。因此，$\\operatorname{Cov}(X, Y) = 0$。这证实了边缘独立性（$X \\perp Y$）。\n\n2.  $\\operatorname{Cov}(X, M) = \\operatorname{Cov}(X, aX + bU + \\varepsilon_M) = a \\operatorname{Cov}(X, X) + b \\operatorname{Cov}(X, U) + \\operatorname{Cov}(X, \\varepsilon_M)$。由于独立性，这简化为 $a \\operatorname{Var}(X) = a(1) = a$。\n\n3.  $\\operatorname{Cov}(M, Y) = \\operatorname{Cov}(aX + bU + \\varepsilon_M, cU + \\varepsilon_Y)$。利用协方差的双线性和注意到外生变量的独立性进行展开，唯一的非零项是 $\\operatorname{Cov}(bU, cU) = bc \\operatorname{Var}(U) = bc(1) = bc$。\n\n4.  $\\operatorname{Var}(M) = \\operatorname{Var}(aX + bU + \\varepsilon_M)$。由于 $X, U, \\varepsilon_M$ 的独立性，和的方差是方差的和：$\\operatorname{Var}(M) = a^2 \\operatorname{Var}(X) + b^2 \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_M) = a^2(1) + b^2(1) + \\sigma_M^2 = a^2 + b^2 + \\sigma_M^2$。\n\n将这些分量代回条件协方差公式：\n$$ \\operatorname{Cov}(X, Y \\mid M) = 0 - (a) (a^2 + b^2 + \\sigma_M^2)^{-1} (bc) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} $$\n由于 $a, b, c$ 是严格为正的常数，分子 $abc$ 是正的。分母 $a^2 + b^2 + \\sigma_M^2$ 也严格为正。因此，$\\operatorname{Cov}(X, Y \\mid M)$ 是一个非零的负值。这证实了以 $M$ 为条件会在 $X$ 和 $Y$ 之间引入一个伪负关联。\n\n现在，我们评估每个选项：\n\nA. 在此模型中 $X \\perp Y \\mid M$ 成立，因此按 $M$ 进行筛选或调整不会引入偏倚。\n该陈述是错误的。我们的推导表明 $\\operatorname{Cov}(X, Y \\mid M) \\neq 0$，对于高斯系统，这意味着 $X \\not\\perp Y \\mid M$。以 $M$ 为条件正是引入偏倚的原因。\n**结论：不正确。**\n\nB. 如果 $a, b, c  0$，那么 $\\operatorname{Cov}(X,Y \\mid M) = -\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2} \\neq 0$，因此以 $M$ 为条件会打开 $X$ 和 $Y$ 之间的伪关联。\n该陈述给出了从第一性原理推导出的精确公式，并提供了正确的因果解释。计算出的协方差非零，这就是通过以对撞节点为条件来打开伪路径的定义。\n**结论：正确。**\n\nC. $\\operatorname{Cov}(X,Y \\mid M) = \\dfrac{ab}{c}$，因此以 $M$ 为条件会产生一个正关联，其大小与 $\\sigma_M^2$ 无关。\n这个公式是不正确的。我们推导出的协方差是 $-\\dfrac{abc}{a^2 + b^2 + \\sigma_M^2}$。关联是负的，不是正的，并且其大小在分母中明确地依赖于 $\\sigma_M^2$。\n**结论：不正确。**\n\nD. 以 $M$ 为条件会阻断 $U$ 对 $Y$ 的影响，从而从观察数据中得到 $X$ 对 $Y$ 的平均因果效应的无偏估计。\n该陈述从根本上误解了图结构。$M$ 是一个对撞节点，而不是需要阻断的路径上的混杂因素或中介变量。以对撞节点为条件会*创建*一条非因果的关联路径，而不是阻断一条路径。$X$ 对 $Y$ 的真实因果效应是 $0$。以 $M$ 为条件导致非零关联，根据定义，这是对因果效应的有偏估计。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "即使我们正确地识别了混淆变量并构建了因果图，我们的分析仍然可能受到数据本身性质的限制。为了使因果推断有效，必须满足“正定性”（positivity）或“共同支撑”（common support）的假设，即在任何给定的协变量组合下，接受和未接受干预的个体都存在。这个练习 () 将理论与实践相结合，指导您如何诊断和处理正定性假设的违规问题，这是确保基于倾向得分等方法的因果估计稳健可靠的关键一步。",
            "id": "4145210",
            "problem": "一项观察性脑电图（EEG；electroencephalography）研究旨在估计镇静剂暴露对后续α波段功率的平均因果效应。设二元暴露为 $A \\in \\{0,1\\}$，结局为 $Y$，基线协变量为向量 $X$。基线时的警觉状态根据暴露前的EEG特征和临床观察分为三个层次 $V \\in \\{v_1, v_2, v_3\\}$。研究人员拟合了一个关于暴露概率的倾向性得分模型 $e(X) = \\mathbb{P}(A=1 \\mid X)$，并获得了所有单元的估计得分 $\\hat{e}(X)$。在初步诊断中，他们发现在层次 $V=v_3$ 中，处理组的 $\\hat{e}(X)$ 值集中在 $1$ 附近，而对照组的 $\\hat{e}(X)$ 值集中在 $0$ 附近，而在 $V=v_1$ 中似乎有很好的重叠。\n\n根据观察性研究中因果推断的基本原则，正定性假设要求对于目标人群中具有正概率的所有协变量值 $x$，两种暴露水平都具有非零概率：对于 $a \\in \\{0,1\\}$，有 $0  \\mathbb{P}(A=a \\mid X=x)  1$。违反正定性通常表现为估计的倾向性得分极端接近 $0$ 或 $1$，以及在给定 $X$（或在有意义的层次如 $V$ 内）的条件下，暴露组和非暴露组之间缺乏共同支撑域。研究人员希望通过检查不同警觉状态层次的估计倾向性得分和重叠图来诊断潜在的正定性违规，并提出科学上合理的补救措施。\n\n在本次EEG研究中，以下哪些程序适合用于诊断和处理正定性违规问题？选择所有适用项。\n\nA. 在每个警觉状态层次 $V=v$ 内，分别为 $A=1$ 和 $A=0$ 的组叠加 $\\hat{e}(X)$ 的直方图或核密度图，并标记出支撑域不相交或集中在 $0$ 或 $1$ 附近的层次。作为补救措施，对尾部的极端逆概率权重进行截断（例如在 $1\\%$ 和 $99\\%$ 分位数处），并报告估计值对此截断的敏感性。\n\nB. 在重叠性差的层次中，通过基于设计的子抽样或匹配，将分析限制在共同支撑域区域，从而使得在 $V=v$ 内，$A=1$ 和 $A=0$ 组的 $X$ 的经验分布更加相似。明确地为修剪后的人群重新定义并记录目标估计量。\n\nC. 通过计算每个层次 $V=v$ 中 $\\hat{e}(X)  \\epsilon$ 或 $\\hat{e}(X)  1-\\epsilon$（对于一个小的 $\\epsilon  0$）的单元比例来量化极端性，并检查逆概率权重的分布。如果存在重尾且有效样本量小，则考虑权重截断和基于重叠的修剪。\n\nD. 为了改善重叠性，将暴露后测量的EEG特征（例如，镇静后即刻的光谱变化）添加到倾向性得分模型中，以便处理组和对照组的 $\\hat{e}(X)$ 在 $V$ 的各个层次中更加混合。\n\nE. 拟合日益灵活的倾向性得分模型（例如，高阶多项式和交互作用），直到所有单元的 $\\hat{e}(X)$ 值都严格位于 $0.1$ 和 $0.9$ 之间，然后在模型灵活性解决了正定性问题的理由下，不进行任何设计更改继续分析。",
            "solution": "首先将验证问题陈述的科学性和逻辑合理性。\n\n### 第1步：提取已知信息\n- **研究类型**：观察性脑电图（EEG）研究。\n- **目标**：估计镇静剂暴露对后续α波段功率的平均因果效应。\n- **暴露**：二元变量 $A \\in \\{0,1\\}$，其中 $A=1$ 为镇静剂暴露，$A=0$ 为无暴露（对照）。\n- **结局**：$Y$，代表后续的α波段功率。\n- **协变量**：$X$，基线协变量向量。\n- **分层变量**：$V \\in \\{v_1, v_2, v_3\\}$，代表基线警觉状态，源自暴露前的EEG和临床观察。\n- **方法论**：使用倾向性得分模型 $e(X) = \\mathbb{P}(A=1 \\mid X)$，并带有估计得分 $\\hat{e}(X)$。\n- **经验观察**：在层次 $V=v_3$ 中，处理组（$A=1$）的 $\\hat{e}(X)$ 分布集中在1附近，对照组（$A=0$）的 $\\hat{e}(X)$ 分布集中在0附近。在层次 $V=v_1$ 中，存在良好的重叠。\n- **理论原则**：正定性假设要求对于目标人群中具有正概率的所有协变量 $x$ 和 $a \\in \\{0,1\\}$，有 $0  \\mathbb{P}(A=a \\mid X=x)  1$。\n- **问题任务**：评估几种旨在诊断和解决潜在正定性假设违规的提议程序的适当性。\n\n### 第2步：使用提取的已知信息进行验证\n1.  **科学依据**：该问题在观察性数据的因果推断理论与实践中有充分依据，这是生物统计学和流行病学的核心课题。倾向性得分、正定性假设（也称为共同支撑域）、分层以及EEG数据的使用等概念都是标准的、科学有效的。所描述的场景是临床和药理学研究中的一个现实挑战。\n2.  **问题明确**：该问题提法明确。它提出了一个清晰的场景，并要求对具体的、定义明确的统计程序进行评估。任务是基于已建立的因果推断原则来评估这些程序的正确性。\n3.  **客观性**：该问题以精确、客观和技术性的语言陈述。“倾向性得分”、“正定性假设”和“共同支撑域”等术语在该领域有标准定义。没有歧义或主观内容。\n\n### 第3步：结论与行动\n问题陈述是有效的。它科学合理、提法明确、客观，并与神经科学数据分析中的因果推断直接相关。我将继续推导解决方案并评估给定的选项。\n\n### 解决方案推导\n\n该问题涉及正定性假设，这是使用逆概率处理加权（IPTW）等方法从观察性数据中无偏估计因果效应的一个基本先决条件。该假设指出，对于任何给定的协变量集 $X=x$，接受处理和不接受处理的概率都非零。形式上，为 $0  e(x)  1$，其中 $e(x) = \\mathbb{P}(A=1 \\mid X=x)$。\n\n如层次 $V=v_3$ 的诊断结果所示，违背或接近违背此假设意味着，对于某些受试者，处理分配基于其基线特征是（近乎）确定性的。这对因果推断构成了重大问题，因为它使得为处理组受试者找到可比的对照组受试者（反之亦然）变得不可能或困难。在IPTW中，这表现为极端权重：一个 $\\hat{e}(X) \\approx 1$ 的处理组受试者得到的权重为 $1/\\hat{e}(X) \\approx 1$，但一个 $\\hat{e}(X) \\approx 1$ 的未处理受试者将得到一个天文数字般大的权重 $1/(1-\\hat{e}(X))$。类似地，一个 $\\hat{e}(X) \\approx 0$ 的处理组受试者会得到一个巨大的权重。这些极端权重会极大地增加因果效应估计量的方差，并使其对倾向性得分模型的错误设定高度敏感。\n\n任务是评估为诊断和解决此问题而提出的程序。\n\n### 逐项分析\n\n**A. 在每个警觉状态层次 $V=v$ 内，分别为 $A=1$ 和 $A=0$ 的组叠加 $\\hat{e}(X)$ 的直方图或核密度图，并标记出支撑域不相交或集中在 $0$ 或 $1$ 附近的层次。作为补救措施，对尾部的极端逆概率权重进行截断（例如在 $1\\%$ 和 $99\\%$ 分位数处），并报告估计值对此截断的敏感性。**\n\n- **诊断**：为处理组和对照组叠加估计的倾向性得分 $\\hat{e}(X)$ 的分布是评估正定性和重叠性的经典图形方法。缺乏重叠（即分布分离）是正定性违规的清晰视觉指标。这种诊断是标准实践，并被高度推荐。\n- **补救措施**：权重截断是处理因接近违反正定性而产生的极端权重的一种常用且公认的方法。通过为逆概率权重设定上限（例如，在权重分布的第 $1$ 和第 $99$ 百分位数），可以显著降低估计量的方差。但这会引入一定量的偏差，因为截断后的权重不再能完美地平衡协变量分布。因此，进行并报告敏感性分析，展示最终因果估计如何随不同截断阈值变化，是至关重要的。整个程序是符合原则且适当的。\n- **结论**：**正确**。\n\n**B. 在重叠性差的层次中，通过基于设计的子抽样或匹配，将分析限制在共同支撑域区域，从而使得在 $V=v$ 内，$A=1$ 和 $A=0$ 组的 $X$ 的经验分布更加相似。明确地为修剪后的人群重新定义并记录目标估计量。**\n\n- **补救措施**：这个过程通常被称为“修剪样本”，涉及丢弃在另一处理组中没有可比对应者的受试者。例如，可以丢弃倾向性得分 $\\hat{e}(X)$ 低于处理组最低值的对照组受试者，以及倾向性得分 $\\hat{e}(X)$ 高于对照组最高值的处理组受试者。这将分析限制在一个正定性假设更强成立的子群体中。\n- **重新定义估计量**：这是此程序最关键的部分。通过修剪样本，分析不再估计原始完整人群的平均处理效应（ATE）。相反，它估计的是剩余的“重叠”子群体的ATE。这个新的估计目标（估计量）必须被清晰地定义和报告。例如，结果现在是“对于那些特征既不使其几乎肯定接受镇静剂也不使其几乎肯定不接受镇静剂的患者的平均因果效应”。不承认估计量的这种变化是一个严重的方法论错误。所描述的程序正确地包含了这个关键步骤。\n- **结论**：**正确**。\n\n**C. 通过计算每个层次 $V=v$ 中 $\\hat{e}(X)  \\epsilon$ 或 $\\hat{e}(X)  1-\\epsilon$（对于一个小的 $\\epsilon  0$）的单元比例来量化极端性，并检查逆概率权重的分布。如果存在重尾且有效样本量小，则考虑权重截断和基于重叠的修剪。**\n\n- **诊断**：这提出了定量诊断方法来补充选项A中的图形方法。计算具有极端倾向性得分的受试者比例（对于选定的一个小 $\\epsilon$，例如 $0.01$）是衡量正定性问题普遍性的直接指标。检查逆概率权重的分布，特别是其偏度和重尾的存在，也是评估接近违反正定性对最终估计量方差影响的直接方法。由高变异性权重导致的有效样本量（ESS）小是另一个关键指标。这些都是出色且标准的定量诊断方法。\n- **行动**：基于这些诊断发现，考虑采用权重截断（来自选项A）和修剪（来自选项B）等补救措施的提议是一个逻辑上和方法论上都合理的流程。它代表了一种系统性地解决问题的方法。\n- **结论**：**正确**。\n\n**D. 为了改善重叠性，将暴露后测量的EEG特征（例如，镇静后即刻的光谱变化）添加到倾向性得分模型中，以便处理组和对照组的 $\\hat{e}(X)$ 在 $V$ 的各个层次中更加混合。**\n\n- **分析**：这个程序存在根本性缺陷。用于建模倾向性得分 $e(X) = \\mathbb{P}(A=1 \\mid X)$ 的协变量集合必须完全由暴露前变量组成。一个在暴露*之后*测量的变量本身可能是暴露的一个*效应*。在倾向性得分模型的条件集中包含这样一个处理后变量会引入严重的偏倚。例如，如果镇静剂本身引起即时的光谱变化，那么将这些变化包含在模型中就意味着我们正在调整处理的部分效应。这是对撞因子或中介变量进行条件化的典型例子，会打开虚假的通路并使因果效应估计产生偏倚。倾向性得分的目的是解释处理前的混杂，而不是利用处理后的信息人为地强制重叠。\n- **结论**：**不正确**。\n\n**E. 拟合日益灵活的倾向性得分模型（例如，高阶多项式和交互作用），直到所有单元的 $\\hat{e}(X)$ 值都严格位于 $0.1$ 和 $0.9$ 之间，然后在模型灵活性解决了正定性问题的理由下，不进行任何设计更改继续分析。**\n\n- **分析**：这个程序基于对问题的深刻误解。正定性假设是现实世界数据生成过程的一个特征，而不是统计模型的缺陷。如果现实中某些患者几乎总是接受治疗（真实的 $e(X)$ 接近 $1$），一个*更灵活、设定更好*的倾向性得分模型将产生*更接近* $1$ 的估计值 $\\hat{e}(X)$，而不是远离它。这将正确地揭示正定性问题，而不是解决它。通过调整模型将 $\\hat{e}(X)$ 估计值推离边界（$0$ 和 $1$）是一种无原则的、临时的做法，它掩盖了根本问题。这相当于为了得到一个“更好看”的得分分布而故意错误地设定模型，这很可能因未能充分控制混杂而导致有偏的估计。问题在于数据本身（缺乏重叠），必须通过设计阶段的补救措施如修剪（选项B）或分析阶段的补救措施如权重截断（选项A）来解决，而不是通过操纵模型来隐藏问题。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}