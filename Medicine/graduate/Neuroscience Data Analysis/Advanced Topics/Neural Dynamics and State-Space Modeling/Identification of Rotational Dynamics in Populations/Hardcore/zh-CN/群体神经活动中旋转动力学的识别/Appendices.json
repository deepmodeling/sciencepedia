{
    "hands_on_practices": [
        {
            "introduction": "jPCA分析的核心在于量化一个二维平面内的旋转速度。本练习将旋转这个抽象概念具体化为一个实际的计算，要求您使用最小二乘法原理，从状态向量及其时间导数中推导出角速度 $\\bar{\\omega}$ 的最佳估计值。通过这个推导过程，您将理解jPCA算法是如何将复杂的高维神经活动提炼成一个代表旋转速度的可解释数值 ()。",
            "id": "4169453",
            "problem": "考虑一个二维神经群体状态轨迹 $x(t) \\in \\mathbb{R}^{2}$，它是通过将高维放电率向量投影到一个捕获主导旋转结构的平面上获得的。假设该平面上的动力学可以由一个带有斜对称生成元的线性时不变模型很好地近似，因此时间导数 $\\dot{x}(t)$ 满足 $\\dot{x}(t) \\approx M x(t)$，其中 $M$ 是斜对称的。在二维空间中，任何斜对称矩阵都可以写成 $M = \\omega J$ 的形式，其中 $\\omega \\in \\mathbb{R}$ 是角速度，$J$ 是逆时针旋转 $90^{\\circ}$ 的旋转矩阵\n$$\nJ \\;=\\; \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}.\n$$\n将垂直速度定义为 $\\dot{x}_{\\perp}(t) := J^{\\top} \\dot{x}(t)$，它将 $\\dot{x}(t)$ 顺时针旋转 $90^{\\circ}$，因此对于理想的旋转动力学，$\\dot{x}_{\\perp}(t) = \\omega x(t)$ 瞬时成立。\n\n仅从这些定义和最小二乘法原理出发，推导通过在 $K$ 个样本 $\\{x(t_k), \\dot{x}(t_k)\\}_{k=1}^{K}$ 上将 $\\dot{x}_{\\perp}(t)$ 对 $x(t)$ 进行零截距回归而得到的平均角速度 $\\bar{\\omega}$ 的闭式表达式。你的推导必须阐明为什么这个斜率可以解释为平均角速度，以及状态幅值的加权是如何产生的。\n\n然后，根据以下三个样本计算 $\\bar{\\omega}$ 的数值（单位为弧度/秒）。将这些样本视为同步样本 $(x(t_k), \\dot{x}(t_k))$，并使用如上所述的 $J$：\n- $x(t_1) = \\begin{pmatrix} 1.0 \\\\ 0.0 \\end{pmatrix}$, $\\dot{x}(t_1) = \\begin{pmatrix} 0.05 \\\\ 2.05 \\end{pmatrix}$,\n- $x(t_2) = \\begin{pmatrix} 0.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}(t_2) = \\begin{pmatrix} -2.02 \\\\ -0.03 \\end{pmatrix}$,\n- $x(t_3) = \\begin{pmatrix} 1.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}(t_3) = \\begin{pmatrix} -2.10 \\\\ 1.90 \\end{pmatrix}$.\n\n将最终数值答案四舍五入到四位有效数字。以弧度/秒为单位表示最终值。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤1：提取已知条件\n- 神经状态是一个二维轨迹 $x(t) \\in \\mathbb{R}^{2}$。\n- 动力学由一个线性时不变模型近似：$\\dot{x}(t) \\approx M x(t)$。\n- 矩阵 $M$ 是斜对称的，在二维空间中可以写成 $M = \\omega J$。\n- $\\omega \\in \\mathbb{R}$ 是角速度。\n- $J$ 是逆时针旋转 $90^{\\circ}$ 的旋转矩阵：$J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。\n- 垂直速度定义为 $\\dot{x}_{\\perp}(t) := J^{\\top} \\dot{x}(t)$。\n- 理想动力学关系由 $\\dot{x}_{\\perp}(t) = \\omega x(t)$ 给出。\n- 任务是使用最小二乘法原理，通过在 $K$ 个样本 $\\{x(t_k), \\dot{x}(t_k)\\}_{k=1}^{K}$ 上将 $\\dot{x}_{\\perp}(t)$ 对 $x(t)$ 进行零截距回归，推导平均角速度 $\\bar{\\omega}$ 的闭式表达式。\n- 需要对 $K=3$ 个样本进行 $\\bar{\\omega}$ 的数值计算：\n    - 样本1：$x(t_1) = \\begin{pmatrix} 1.0 \\\\ 0.0 \\end{pmatrix}$, $\\dot{x}(t_1) = \\begin{pmatrix} 0.05 \\\\ 2.05 \\end{pmatrix}$。\n    - 样本2：$x(t_2) = \\begin{pmatrix} 0.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}(t_2) = \\begin{pmatrix} -2.02 \\\\ -0.03 \\end{pmatrix}$。\n    - 样本3：$x(t_3) = \\begin{pmatrix} 1.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}(t_3) = \\begin{pmatrix} -2.10 \\\\ 1.90 \\end{pmatrix}$。\n- 最终数值答案必须四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是 j-主成分分析 (jPCA) 核心原理的直接应用，jPCA 是计算神经科学中一种成熟且科学合理的方法，用于识别神经数据中的旋转动力学。其数学公式，包括使用斜对称生成矩阵和垂直速度的定义，是该领域的标准做法。\n- **适定性**：该问题是适定的。它要求使用最小二乘法原理推导一个参数，这是一个具有唯一解的标准优化问题。为数值计算提供的数据是完整且充分的。\n- **客观性**：问题陈述使用精确的数学语言编写，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：该问题是自洽的。所有必要的定义、方程和数据都已提供。没有矛盾之处。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它科学合理、适定且完整。可以继续进行解答过程。\n\n### 解答推导\n目标是找到标量 $\\bar{\\omega}$，它能最好地拟合一组 $K$ 个离散样本的模型 $\\dot{x}_{\\perp}(t_k) \\approx \\bar{\\omega} x(t_k)$。这是一个零截距的线性回归问题。“因变量”是向量 $\\dot{x}_{\\perp}(t_k)​$，“自变量”是向量 $x(t_k)$。\n\n根据最小二乘法原理，我们必须最小化误差平方和。第 $k$ 个样本的误差是向量差 $e_k = \\dot{x}_{\\perp}(t_k) - \\bar{\\omega} x(t_k)$。需要最小化的量是这些误差向量的欧几里得范数平方和：\n$$\nS(\\bar{\\omega}) = \\sum_{k=1}^{K} \\| e_k \\|^2 = \\sum_{k=1}^{K} \\| \\dot{x}_{\\perp}(t_k) - \\bar{\\omega} x(t_k) \\|^2\n$$\n向量 $v$ 的范数平方是 $v^{\\top}v$。展开单个样本的项（为清晰起见，省略索引 $k$）：\n$$\n\\| \\dot{x}_{\\perp} - \\bar{\\omega} x \\|^2 = ( \\dot{x}_{\\perp} - \\bar{\\omega} x )^{\\top} ( \\dot{x}_{\\perp} - \\bar{\\omega} x )\n$$\n$$\n= (\\dot{x}_{\\perp}^{\\top} - \\bar{\\omega} x^{\\top}) ( \\dot{x}_{\\perp} - \\bar{\\omega} x )\n$$\n$$\n= \\dot{x}_{\\perp}^{\\top}\\dot{x}_{\\perp} - \\bar{\\omega} \\dot{x}_{\\perp}^{\\top}x - \\bar{\\omega} x^{\\top}\\dot{x}_{\\perp} + \\bar{\\omega}^2 x^{\\top}x\n$$\n由于 $x^{\\top}\\dot{x}_{\\perp}$ 是一个标量，它等于其转置：$(x^{\\top}\\dot{x}_{\\perp})^{\\top} = \\dot{x}_{\\perp}^{\\top}x$。因此，中间两项是相同的。\n$$\n\\| \\dot{x}_{\\perp} - \\bar{\\omega} x \\|^2 = \\| \\dot{x}_{\\perp} \\|^2 - 2\\bar{\\omega} x^{\\top}\\dot{x}_{\\perp} + \\bar{\\omega}^2 \\|x\\|^2\n$$\n现在，我们恢复对所有 $K$ 个样本的求和：\n$$\nS(\\bar{\\omega}) = \\sum_{k=1}^{K} \\left( \\| \\dot{x}_{\\perp}(t_k) \\|^2 - 2\\bar{\\omega} x(t_k)^{\\top}\\dot{x}_{\\perp}(t_k) + \\bar{\\omega}^2 \\|x(t_k)\\|^2 \\right)\n$$\n为了找到使 $S$ 最小化的 $\\bar{\\omega}$ 值，我们对 $S$ 关于 $\\bar{\\omega}$ 求导，并令其为零：\n$$\n\\frac{dS}{d\\bar{\\omega}} = \\frac{d}{d\\bar{\\omega}} \\sum_{k=1}^{K} \\left( \\| \\dot{x}_{\\perp}(t_k) \\|^2 - 2\\bar{\\omega} x(t_k)^{\\top}\\dot{x}_{\\perp}(t_k) + \\bar{\\omega}^2 \\|x(t_k)\\|^2 \\right) = 0\n$$\n$$\n\\sum_{k=1}^{K} \\left( -2 x(t_k)^{\\top}\\dot{x}_{\\perp}(t_k) + 2\\bar{\\omega} \\|x(t_k)\\|^2 \\right) = 0\n$$\n除以 $2$ 并重新整理各项以求解 $\\bar{\\omega}$：\n$$\n\\bar{\\omega} \\sum_{k=1}^{K} \\|x(t_k)\\|^2 = \\sum_{k=1}^{K} x(t_k)^{\\top}\\dot{x}_{\\perp}(t_k)\n$$\n这就得出了 $\\bar{\\omega}$ 的闭式表达式：\n$$\n\\bar{\\omega} = \\frac{\\sum_{k=1}^{K} x(t_k)^{\\top}\\dot{x}_{\\perp}(t_k)}{\\sum_{k=1}^{K} \\|x(t_k)\\|^2}\n$$\n代入定义 $\\dot{x}_{\\perp}(t_k) = J^{\\top}\\dot{x}(t_k)$，我们得到：\n$$\n\\bar{\\omega} = \\frac{\\sum_{k=1}^{K} x(t_k)^{\\top} J^{\\top} \\dot{x}(t_k)}{\\sum_{k=1}^{K} x(t_k)^{\\top}x(t_k)}\n$$\n这个表达式可以解释为平均角速度。对于每个样本 $k$，可以估计一个瞬时角速度为 $\\omega_k = (x_k^{\\top}\\dot{x}_{\\perp,k}) / \\|x_k\\|^2$。$\\bar{\\omega}$ 的公式是这些瞬时估计值的加权平均，其中每个样本的权重是其幅度的平方，即 $\\|x_k\\|^2$。这种加权方案是合理的：远离原点的状态（$\\|x_k\\|$ 较大）在给定的角速度下具有较大的切向速度，因此为其估计提供了更鲁棒的信号。相反，靠近原点的状态更容易受到噪声的影响，提供的信号较弱，因此它们的权重被降低。\n\n### 数值计算\n我们现在将此公式应用于提供的 $K=3$ 个数据样本。\n给定 $J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$，其转置为 $J^{\\top} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$。\n分子是 $N = \\sum_{k=1}^{3} x(t_k)^{\\top} J^{\\top} \\dot{x}(t_k)$，分母是 $D = \\sum_{k=1}^{3} \\|x(t_k)\\|^2$。\n\n对于 $k=1$：\n- $x_1 = \\begin{pmatrix} 1.0 \\\\ 0.0 \\end{pmatrix}$, $\\dot{x}_1 = \\begin{pmatrix} 0.05 \\\\ 2.05 \\end{pmatrix}$\n- 分子项：$x_1^{\\top}J^{\\top}\\dot{x}_1 = \\begin{pmatrix} 1.0  0.0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 2.05 \\end{pmatrix} = \\begin{pmatrix} 1.0  0.0 \\end{pmatrix} \\begin{pmatrix} 2.05 \\\\ -0.05 \\end{pmatrix} = 2.05$\n- 分母项：$\\|x_1\\|^2 = (1.0)^2 + (0.0)^2 = 1.0$\n\n对于 $k=2$：\n- $x_2 = \\begin{pmatrix} 0.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}_2 = \\begin{pmatrix} -2.02 \\\\ -0.03 \\end{pmatrix}$\n- 分子项：$x_2^{\\top}J^{\\top}\\dot{x}_2 = \\begin{pmatrix} 0.0  1.0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} -2.02 \\\\ -0.03 \\end{pmatrix} = \\begin{pmatrix} 0.0  1.0 \\end{pmatrix} \\begin{pmatrix} -0.03 \\\\ 2.02 \\end{pmatrix} = 2.02$\n- 分母项：$\\|x_2\\|^2 = (0.0)^2 + (1.0)^2 = 1.0$\n\n对于 $k=3$：\n- $x_3 = \\begin{pmatrix} 1.0 \\\\ 1.0 \\end{pmatrix}$, $\\dot{x}_3 = \\begin{pmatrix} -2.10 \\\\ 1.90 \\end{pmatrix}$\n- 分子项：$x_3^{\\top}J^{\\top}\\dot{x}_3 = \\begin{pmatrix} 1.0  1.0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} -2.10 \\\\ 1.90 \\end{pmatrix} = \\begin{pmatrix} 1.0  1.0 \\end{pmatrix} \\begin{pmatrix} 1.90 \\\\ 2.10 \\end{pmatrix} = 1.90 + 2.10 = 4.00$\n- 分母项：$\\|x_3\\|^2 = (1.0)^2 + (1.0)^2 = 2.0$\n\n现在，我们对各项求和以计算总分子 $N$ 和总分母 $D$：\n- $N = 2.05 + 2.02 + 4.00 = 8.07$\n- $D = 1.0 + 1.0 + 2.0 = 4.0$\n\n最后，我们计算 $\\bar{\\omega}$：\n$$\n\\bar{\\omega} = \\frac{N}{D} = \\frac{8.07}{4.0} = 2.0175\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\bar{\\omega} \\approx 2.018\n$$\n单位是弧度/秒。",
            "answer": "$$\n\\boxed{2.018}\n$$"
        },
        {
            "introduction": "虽然我们通常将理想的旋转建构成潜在空间中的圆形轨迹，但在我们通过主成分分析（PCA）所观察到的投影中，这种完美的圆形可能无法保持。本练习探讨线性变换的几何学，展示一个非正交的映射（从潜在空间到观测到的PCA空间）如何将圆形轨迹转变为椭圆形 ()。这为解读jPCA图提供了关键的几何直觉，并帮助您理解为什么观测到的旋转轨迹通常是椭圆形的，同时将椭圆的形状与底层线性映射的属性联系起来。",
            "id": "4169442",
            "problem": "考虑一个二维潜在动力学系统，该系统旨在模拟神经群体中通过通常称为 jPCA 的方法识别出的主导旋转模式。设潜在状态为 $z(t) \\in \\mathbb{R}^{2}$，其演化遵循时不变线性常微分方程 (ODE)\n$$\n\\frac{d z}{d t} = \\Omega J z, \\quad J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix},\n$$\n其中角频率 $\\Omega \\in \\mathbb{R}$ 为常数。假设展示给分析师的二维平面（“jPC 平面”）通过可逆线性映射 $y = B z$ 与潜在平面相关联，其中 $B \\in \\mathbb{R}^{2 \\times 2}$ 是满秩的。假设展示平面中的欧几里得距离和角度是使用 $\\mathbb{R}^{2}$ 上的标准内积来测量的。\n\n仅利用以下基本事实：(i) 线性时不变常微分方程的解由矩阵指数给出，(ii) 斜对称生成元在其原生坐标系中保持欧几里得范数不变，以及 (iii) 线性映射将圆形映射为椭圆，除非在正交缩放映射的特殊情况下。请完成以下任务：\n\n1. 证明在潜在坐标 $z(t)$ 中，轨迹位于以原点为中心的圆上，并给出与此不变性相关的守恒量。\n\n2. 将动力学变换到展示平面，并证明轨迹 $y(t)$ 位于正定二次型的水平集上。推导使这些水平集在展示平面中成为圆的关于 $B$ 的充要条件。\n\n3. 推导展示平面中轨迹的长半轴与短半轴长度之比的闭式表达式，该表达式仅用 $B$ 表示（独立于 $\\Omega$ 和初始条件），并且仅使用不依赖于特定坐标系的矩阵运算来表示。\n\n4. 对于特定的非正交缩放\n$$\nB = \\begin{pmatrix} 2  1 \\\\ 0  1 \\end{pmatrix},\n$$\n计算您在第 3 步中推导出的半轴长度比的精确值。请给出您最终的答案，形式为一个简化的闭式表达式。不要近似；无需四舍五入。",
            "solution": "该问题陈述是线性代数和常微分方程理论中的一个有效练习，其背景是神经群体动力学建模。该问题是自洽的、适定的且科学上合理的。我们开始求解。\n\n问题要求对一个二维线性动力学系统进行四部分的推导。我们将按顺序处理每个部分。\n\n1. 潜在空间 $z(t)$ 中的轨迹。\n\n潜在空间中的动力学由以下线性时不变常微分方程（ODE）给出：\n$$\n\\frac{d z}{d t} = \\Omega J z, \\quad \\text{其中} \\quad z(t) = \\begin{pmatrix} z_1(t) \\\\ z_2(t) \\end{pmatrix} \\in \\mathbb{R}^2, \\quad J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}, \\quad \\Omega \\in \\mathbb{R}.\n$$\n该动力学系统的生成元是矩阵 $A_z = \\Omega J$。该矩阵是斜对称的，因为 $A_z^T = (\\Omega J)^T = \\Omega J^T = \\Omega (-J) = -A_z$。如基本事实 (ii) 所述，斜对称生成元在其原生坐标系中保持欧几里得范数不变。为了明确证明这一点，我们考虑状态向量的欧几里得范数的平方，$\\|z(t)\\|^2 = z(t)^T z(t)$。我们将此量对时间 $t$ 求导：\n$$\n\\frac{d}{dt} \\left( z^T z \\right) = \\left( \\frac{dz}{dt} \\right)^T z + z^T \\left( \\frac{dz}{dt} \\right).\n$$\n代入给定的 ODE，$\\frac{dz}{dt} = A_z z$：\n$$\n\\frac{d}{dt} \\left( z^T z \\right) = (A_z z)^T z + z^T (A_z z) = z^T A_z^T z + z^T A_z z.\n$$\n利用斜对称性 $A_z^T = -A_z$，我们得到：\n$$\n\\frac{d}{dt} \\left( z^T z \\right) = z^T (-A_z) z + z^T A_z z = -z^T A_z z + z^T A_z z = 0.\n$$\n由于 $z^T z$ 的时间导数为零，该量是一个运动常数，或称为守恒量。设此常数为 $R^2$，由初始条件 $z(0)$ 决定：$R^2 = \\|z(0)\\|^2 = z_1(0)^2 + z_2(0)^2$。方程 $\\|z(t)\\|^2 = R^2$ 描述了在 $z_1$-$z_2$ 平面中一个以原点为中心、半径为 $R$ 的圆。因此，轨迹 $z(t)$ 位于以原点为中心的圆上。相关的守恒量是潜在状态的欧几里得范数的平方，$C = \\|z(t)\\|^2 = z_1(t)^2 + z_2(t)^2$。\n\n2. 展示平面 $y(t)$ 中的轨迹。\n\n展示坐标 $y(t)$ 通过可逆线性映射 $y = B z$ 与潜在坐标 $z(t)$ 相关。这意味着 $z = B^{-1} y$。为了找到 $y(t)$ 的动力学，我们对其定义对时间求导：\n$$\n\\frac{dy}{dt} = \\frac{d}{dt} (B z) = B \\frac{dz}{dt}.\n$$\n代入潜在动力学 $\\frac{dz}{dt} = \\Omega J z$：\n$$\n\\frac{dy}{dt} = B (\\Omega J z).\n$$\n为了仅用 $y$ 来表示动力学，我们代入 $z = B^{-1} y$：\n$$\n\\frac{dy}{dt} = B (\\Omega J B^{-1} y) = \\Omega (B J B^{-1}) y.\n$$\n展示平面中的动力学由线性 ODE $\\frac{dy}{dt} = A_y y$ 控制，其中生成元是 $A_y = \\Omega B J B^{-1}$。\n\n轨迹 $y(t)$ 位于从潜在空间变换到 $y$ 坐标的守恒量的水平集上。守恒量为 $z^T z = R^2$。代入 $z = B^{-1} y$：\n$$\n(B^{-1} y)^T (B^{-1} y) = R^2 \\implies y^T (B^{-1})^T B^{-1} y = R^2 \\implies y^T (B B^T)^{-1} y = R^2.\n$$\n这个方程定义了轨迹 $y(t)$ 的水平集。矩阵 $Q = (B B^T)^{-1}$ 是对称正定的，因为 $B$ 是可逆的。因此，方程 $y^T Q y = R^2$ 描述了一族以原点为中心的椭圆。这证明了展示平面中的轨迹位于正定二次型的水平集上。\n\n要使这些椭圆轨迹成为圆，水平集必须具有 $\\|y\\|^2 = \\text{常数}$ 的形式。这种情况发生当且仅当二次型矩阵 $Q = (B B^T)^{-1}$ 是单位矩阵的标量倍，即 $Q = c I$，其中 $c$ 是某个正常数。\n$$\n(B B^T)^{-1} = c I \\implies B B^T = (c I)^{-1} = \\frac{1}{c} I.\n$$\n令 $k^2 = 1/c$。条件是 $B B^T = k^2 I$。满足此条件的矩阵 $B$ 是一个缩放正交矩阵。这可以通过考虑矩阵 $U = \\frac{1}{k} B$ 来看出。那么 $U U^T = (\\frac{1}{k} B)(\\frac{1}{k} B)^T = \\frac{1}{k^2} B B^T = \\frac{1}{k^2} (k^2 I) = I$，这是正交矩阵的定义。因此，使展示平面中的轨迹成为圆的关于 $B$ 的充要条件是 $B$ 必须是一个缩放正交矩阵。这与基本事实 (iii) 一致，即只有特殊的线性映射（正交缩放）才会将圆映射为圆。\n\n3. 半轴长度之比。\n\n轨迹 $y(t)$ 是由方程 $y^T (B B^T)^{-1} y = R^2$ 定义的椭圆。由 $y^T Q y = 1$ 定义的椭圆的半轴长度由 $1/\\sqrt{\\lambda_i}$ 给出，其中 $\\lambda_i$ 是矩阵 $Q$ 的特征值。在我们的例子中，方程是 $y^T (B B^T)^{-1} y = R^2$，可以写成 $y^T (\\frac{1}{R^2} (B B^T)^{-1}) y = 1$。因此半轴长度为 $1/\\sqrt{\\lambda_i'}$，其中 $\\lambda_i'$ 是 $\\frac{1}{R^2} (B B^T)^{-1}$ 的特征值。\n$\\frac{1}{R^2} (B B^T)^{-1}$ 的特征值是 $\\frac{1}{R^2} \\lambda_i( (B B^T)^{-1} )$。一个逆矩阵的特征值是原矩阵特征值的倒数。设 $\\mu_i$ 是 $B B^T$ 的特征值。那么 $(B B^T)^{-1}$ 的特征值是 $1/\\mu_i$。所以，$\\lambda_i' = \\frac{1}{R^2 \\mu_i}$。\n半轴长度为 $a_j = 1/\\sqrt{\\lambda_j'} = \\sqrt{R^2 \\mu_j} = R \\sqrt{\\mu_j}$。\n长半轴对应于 $B B^T$ 的最大特征值 $\\mu_{\\max}$，短半轴对应于最小特征值 $\\mu_{\\min}$。\n长半轴长度：$a_{\\text{major}} = R \\sqrt{\\mu_{\\max}(B B^T)}$。\n短半轴长度：$a_{\\text{minor}} = R \\sqrt{\\mu_{\\min}(B B^T)}$。\n这些长度的比值为：\n$$\n\\text{Ratio} = \\frac{a_{\\text{major}}}{a_{\\text{minor}}} = \\frac{R \\sqrt{\\mu_{\\max}(B B^T)}}{R \\sqrt{\\mu_{\\min}(B B^T)}} = \\sqrt{\\frac{\\mu_{\\max}(B B^T)}{\\mu_{\\min}(B B^T)}}.\n$$\n$B B^T$ 的特征值是 $B$ 的奇异值 $\\sigma_i$ 的平方。所以 $\\mu_i = \\sigma_i^2$。该比值变为：\n$$\n\\text{Ratio} = \\sqrt{\\frac{\\sigma_{\\max}(B)^2}{\\sigma_{\\min}(B)^2}} = \\frac{\\sigma_{\\max}(B)}{\\sigma_{\\min}(B)}.\n$$\n这个比值是矩阵 $B$ 的条件数，$\\kappa_2(B)$。为了用矩阵运算表示为一个闭式解，我们求对称正定矩阵 $C = B^T B$ 的特征值，它与 $B B^T$ 的特征值相同。对于一个 $2 \\times 2$ 矩阵 $C$，其特征值 $\\mu$ 是特征多项式 $\\lambda^2 - \\text{tr}(C)\\lambda + \\det(C) = 0$ 的根。\n根为 $\\mu = \\frac{\\text{tr}(C) \\pm \\sqrt{\\text{tr}(C)^2 - 4\\det(C)}}{2}$。\n所以，$\\mu_{\\max} = \\frac{\\text{tr}(B^T B) + \\sqrt{(\\text{tr}(B^T B))^2 - 4\\det(B^T B)}}{2}$ 并且 $\\mu_{\\min} = \\frac{\\text{tr}(B^T B) - \\sqrt{(\\text{tr}(B^T B))^2 - 4\\det(B^T B)}}{2}$。\n半轴长度的比值为 $\\sqrt{\\mu_{\\max}/\\mu_{\\min}}$。令 $T = \\text{tr}(B^T B)$ 且 $D = \\det(B^T B)$。\n$$\n\\left(\\frac{a_{\\text{major}}}{a_{\\text{minor}}}\\right)^2 = \\frac{T + \\sqrt{T^2 - 4D}}{T - \\sqrt{T^2 - 4D}} = \\frac{(T + \\sqrt{T^2 - 4D})^2}{(T - \\sqrt{T^2 - 4D})(T + \\sqrt{T^2 - 4D})} = \\frac{(T + \\sqrt{T^2 - 4D})^2}{T^2 - (T^2 - 4D)} = \\frac{(T + \\sqrt{T^2 - 4D})^2}{4D}.\n$$\n取平方根，并注意到 $D = \\det(B^T B) = \\det(B^T)\\det(B) = (\\det(B))^2 > 0$：\n$$\n\\text{Ratio} = \\frac{T + \\sqrt{T^2 - 4D}}{2\\sqrt{D}} = \\frac{\\text{tr}(B^T B) + \\sqrt{(\\text{tr}(B^T B))^2 - 4(\\det(B))^2}}{2|\\det(B)|}.\n$$\n这就是所求的、使用不依赖坐标系的矩阵运算表示的闭式表达式。\n\n4. 对特定矩阵 $B$ 进行计算。\n\n我们被给予特定的矩阵：\n$$\nB = \\begin{pmatrix} 2  1 \\\\ 0  1 \\end{pmatrix}.\n$$\n我们首先计算 $B^T B$：\n$$\nB^T = \\begin{pmatrix} 2  0 \\\\ 1  1 \\end{pmatrix},\n$$\n$$\nB^T B = \\begin{pmatrix} 2  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 2  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4  2 \\\\ 2  2 \\end{pmatrix}.\n$$\n接下来，我们计算我们公式所需的量：$B^T B$ 的迹和 $B$ 的行列式。\n$$\n\\text{tr}(B^T B) = 4 + 2 = 6.\n$$\n$$\n\\det(B) = (2)(1) - (1)(0) = 2.\n$$\n因此， $|\\det(B)| = 2$。\n现在，我们将这些值代入第 3 部分推导出的比值表达式中：\n$$\n\\text{Ratio} = \\frac{6 + \\sqrt{6^2 - 4(2)^2}}{2|2|} = \\frac{6 + \\sqrt{36 - 16}}{4} = \\frac{6 + \\sqrt{20}}{4}.\n$$\n简化平方根，$\\sqrt{20} = \\sqrt{4 \\times 5} = 2\\sqrt{5}$：\n$$\n\\text{Ratio} = \\frac{6 + 2\\sqrt{5}}{4} = \\frac{2(3 + \\sqrt{5})}{4} = \\frac{3 + \\sqrt{5}}{2}.\n$$\n半轴长度比的精确值为 $\\frac{3 + \\sqrt{5}}{2}$。这被认为是黄金比例，$\\phi$。",
            "answer": "$$\n\\boxed{\\frac{3 + \\sqrt{5}}{2}}\n$$"
        },
        {
            "introduction": "在应用jPCA时，我们通过一个线性模型（$\\dot{X} \\approx AX$）来拟合数据。一个关键且常见的问题是，数据可能并未充分探索整个状态空间，导致在唯一地确定动力学矩阵 $A$ 时出现困难。本练习旨在解决当数据矩阵秩亏时（这是神经活动被限制在低维流形上时的常见情况）模型的可辨识性问题 ()。它突出了一个重要的实践挑战，并促使您思考如何通过降维选择等原则性方法来确保拟合出的模型是定义良好且有意义的。",
            "id": "4169469",
            "problem": "您有经过试验平均的神经群体活动，这些活动已通过主成分分析（PCA）投影到一个状态矩阵 $X \\in \\mathbb{R}^{k \\times T}$ 中，其中 $k$ 是保留的主成分数量，$T$ 是所有条件下的时间点数量。您通过有限差分法估计了一个时间导数矩阵 $\\dot{X} \\in \\mathbb{R}^{k \\times T}$。在j-主成分分析（jPCA）框架中，人们通过一个形如 $\\dot{X} \\approx A X$ 的线性时不变系统来模拟旋转群体动力学，其中 $A \\in \\mathbb{R}^{k \\times k}$ 被约束为斜对称矩阵，以强调旋转。然而，对于您的数据集，由于任务结构的原因，某些PCA维度的方差有限，并且 $X$ 在数值上是秩亏的，其 $\\operatorname{rank}(X) = r  k$。您考虑在斜对称约束下通过普通最小二乘法（OLS）来拟合 $A$，并希望了解 $A$ 的可辨识性以及如何使用维度选择来纠正任何问题。\n\n哪个选项正确地描述了在这种情况下 $A$ 何时是可辨识的，并提出了一种既能保留捕捉旋转动力学目标又符合原则的维度选择补救措施？\n\nA. 当 $\\operatorname{rank}(X) = r  k$ 时，该映射仅在由观测到的状态轨迹张成的子空间 $\\mathcal{R}(X) \\subset \\mathbb{R}^{k}$ 上是可辨识的，因为 $A$ 的任何作用于与 $\\mathcal{R}(X)$ 正交方向上的分量都不会影响 $\\dot{X}$。一个原则性的补救措施是，使用奇异值分解（SVD）通过对奇异值进行阈值处理（例如，通过交叉验证或噪声基底标准）来选择一个等于 $X$ 的数值秩的降维维度 $r' \\leq r$，将 $X$ 和 $\\dot{X}$ 投影到前 $r'$ 个主成分上，并在这个 $r'$ 维子空间内拟合斜对称矩阵 $A$。\n\nB. 当 $\\operatorname{rank}(X) = r  k$ 时，增加时间点数量 $T$ 会使 $X X^{\\top}$ 变得可逆，因此 $A$ 在原始的 $k$ 维空间中变得完全可辨识；无需进行维度选择。\n\nC. 斜对称约束 $A^{\\top} = -A$ 减少了足够多的自由参数，使得即使 $\\operatorname{rank}(X)  k$，$A$ 也是唯一可辨识的。因此，仅强制执行斜对称性就足够了；维度选择是不必要的。\n\nD. 为了解决秩亏问题，用 $(k-r)$ 个零方差PCA轴填充 $X$，使其在期望上有效地成为方形和可逆的；然后在完整的 $k$ 维空间中拟合 $A$，以便可以在不丢弃任何PCA轴的情况下恢复旋转平面。",
            "solution": "用户希望我验证问题陈述，如果有效，则通过推导正确答案和评估每个选项来解决问题。\n\n### 第1步：提取已知信息\n- 状态矩阵：$X \\in \\mathbb{R}^{k \\times T}$，来自试验平均的神经群体活动投影到 $k$ 个主成分上。\n- 时间导数矩阵：$\\dot{X} \\in \\mathbb{R}^{k \\times T}$，通过有限差分估计。\n- $T$ 是时间点的数量。\n- 线性时不变系统模型：$\\dot{X} \\approx A X$。\n- 动力学矩阵：$A \\in \\mathbb{R}^{k \\times k}$。\n- 对 $A$ 的约束：斜对称，$A^{\\top} = -A$。\n- 数据属性：$X$ 在数值上是秩亏的，$\\operatorname{rank}(X) = r  k$。\n- 目标：描述 $A$ 的可辨识性，并提出一种原则性的维度选择补救措施。\n\n### 第2步：使用提取的已知信息进行验证\n该问题陈述在科学上和数学上都是合理的。它描述了j-主成分分析（jPCA），这是一种计算神经科学中用于识别神经数据中旋转动力学的成熟方法。其设置涉及线性代数和系统理论中的标准概念：状态空间模型（$\\dot{X} = AX$）、主成分分析（PCA）、秩亏和约束普通最小二乘法（OLS）。一个斜对称矩阵 $A$ 产生对应于纯旋转的动力学，因为 $\\dot{x} = Ax$ 的解是 $x(t) = e^{At}x(0)$，如果 $A$ 是斜对称的，$e^{At}$ 就是一个正交矩阵，代表一个旋转。数据矩阵 $X$ 的秩亏问题是该领域中一个实际且常见的问题，通常是因为在结构化任务期间的神经活动被限制在整个神经状态空间内的一个较低维流形中。所提出的问题——关于 $A$ 的可辨识性以及如何解决它——是一个定义明确且对该方法的有效应用至关重要的问题。该问题是客观的，没有矛盾，并包含足够的信息来解决。\n\n### 第3步：结论与行动\n问题有效。我现在将继续解决。\n\n### 推导\n问题是找到一个斜对称矩阵 $A$，使得残差的平方和（由弗罗贝尼乌斯范数表示）最小化：\n$$ \\min_{A \\in \\mathbb{R}^{k \\times k}, A^{\\top} = -A} \\|\\dot{X} - AX\\|_F^2 $$\n没有斜对称约束时，$A$ 的标准普通最小二乘（OLS）解由 $A_{OLS} = (\\dot{X}X^{\\top})(XX^{\\top})^{-1}$ 给出。此解要求矩阵 $XX^{\\top}$ 是可逆的。矩阵 $X$ 的大小是 $k \\times T$，所以 $XX^{\\top}$ 是一个 $k \\times k$ 的矩阵。$XX^{\\top}$ 的秩与 $X$ 的秩相同。问题陈述中指出 $\\operatorname{rank}(X) = r  k$。一个大小为 $k \\times k$ 的方阵是可逆的，当且仅当其秩为 $k$。由于 $\\operatorname{rank}(XX^{\\top}) = r  k$，矩阵 $XX^{\\top}$ 是奇异的（不可逆）。因此，即使对于无约束问题，在完整的 $k \\times k$ 空间中也不存在 $A$ 的唯一解。\n\n让我们更深入地分析这种非唯一性。模型方程 $\\dot{X} \\approx AX$ 决定了 $A$ 对 $X$ 的列向量的作用。$X$ 的所有列向量都位于 $X$ 的列空间（或值域）内，记为 $\\mathcal{R}(X)$，它是 $\\mathbb{R}^k$ 的一个子空间。根据秩-零度定理，这个子空间的维度是 $\\dim(\\mathcal{R}(X)) = \\operatorname{rank}(X) = r$。由于 $r  k$，这是 $\\mathbb{R}^k$ 的一个真子空间。数据没有提供任何关于 $A$ 如何作用于该子空间的正交补 $\\mathcal{R}(X)^{\\perp}$ 中的向量的信息。\n\n假设 $A_1$ 是一个使误差最小化的矩阵。让我们考虑另一个矩阵 $A_2 = A_1 + \\Delta A$。$A_2$ 的残差是\n$$ \\dot{X} - A_2 X = \\dot{X} - (A_1 + \\Delta A)X = (\\dot{X} - A_1 X) - \\Delta A X $$\n如果我们能找到一个非零矩阵 $\\Delta A$ 使得 $\\Delta A X = 0$，那么 $A_2$ 将产生与 $A_1$ 完全相同的残差，因此也将是一个最小化解。如果矩阵 $\\Delta A$ 将子空间 $\\mathcal{R}(X)$ 中的每个向量都映射到零向量，这种情况就会发生。如果 $\\mathcal{R}(X)$ 是 $\\mathbb{R}^k$ 的一个真子空间，那么肯定可以构造一个具有此性质的非零矩阵。\n\n现在，让我们考虑斜对称约束 $A^{\\top} = -A$。这个约束会使解唯一吗？如果我们能找到一个非零的斜对称矩阵 $\\Delta A$ 使得 $\\Delta A X = 0$，那么解仍然不是唯一的。设 $\\{u_1, \\dots, u_{k-r}\\}$ 是 $\\mathcal{R}(X)^{\\perp}$ 的一个标准正交基。如果 $k-r \\ge 2$，我们可以从这个基中选取两个向量，比如 $u_1$ 和 $u_2$。让我们定义矩阵 $\\Delta A = \\alpha(u_1 u_2^{\\top} - u_2 u_1^{\\top})$，对于任何非零标量 $\\alpha$。这个矩阵是非零且斜对称的，因为 $(\\Delta A)^{\\top} = \\alpha(u_2 u_1^{\\top} - u_1 u_2^{\\top}) = -\\Delta A$。对于 $X$ 的任意列 $x_t$，我们有 $x_t \\in \\mathcal{R}(X)$，这意味着 $u_1^{\\top} x_t = 0$ 和 $u_2^{\\top} x_t = 0$。因此，\n$$ \\Delta A x_t = \\alpha(u_1(u_2^{\\top}x_t) - u_2(u_1^{\\top}x_t)) = \\alpha(u_1 \\cdot 0 - u_2 \\cdot 0) = 0 $$\n由于这对 $X$ 的所有列都成立，我们有 $\\Delta A X = 0$。因此，如果 $A_1$ 是一个解，那么 $A_1 + \\Delta A$ 也是一个具有相同误差的斜对称解。$A$ 的解在完整的 $k \\times k$ 空间中是不可辨识的。该映射仅在其对子空间 $\\mathcal{R}(X)$ 的作用上是可辨识的。\n\n对于这种不可辨识性，原则性的补救措施是将问题的维度降低到数据实际所在的子空间。\n1.  **识别子空间**：使用数据矩阵的奇异值分解（SVD），$X = U \\Sigma V^{\\top}$。$U$ 的列是左奇异向量，它们也是 $XX^{\\top}$ 的特征向量，并构成 $\\mathbb{R}^k$ 的一个标准正交基。$U$ 的前 $r = \\operatorname{rank}(X)$ 列，我们记为 $U_r \\in \\mathbb{R}^{k \\times r}$，构成了 $\\mathcal{R}(X)$ 的一个标准正交基。实际上，由于噪声的存在，$X$ 在技术上可能是满秩的，但有许多非常小的奇异值。这时，人们通过选择对应于高于某个阈值（通过交叉验证、碎石图或与噪声基底比较等方法确定）的奇异值的维度来确定一个数值秩 $r' \\le r$。我们称这个基为 $U_{r'}$。\n2.  **投影动力学**：将状态及其导数都投影到这个 $r'$ 维子空间上：\n    $$ X' = U_{r'}^{\\top} X \\in \\mathbb{R}^{r' \\times T} $$\n    $$ \\dot{X}' = U_{r'}^{\\top} \\dot{X} \\in \\mathbb{R}^{r' \\times T} $$\n3.  **解决降维问题**：拟合一个新的、更小的动力学矩阵 $A' \\in \\mathbb{R}^{r' \\times r'}$，该矩阵是斜对称的，通过解决这个适定问题：\n    $$ \\min_{A' \\in \\mathbb{R}^{r' \\times r'}, (A')^{\\top} = -A'} \\|\\dot{X}' - A'X'\\|_F^2 $$\n    在这个降维空间中，矩阵 $X'$ 具有满行秩 $r'$。因此，$r' \\times r'$ 矩阵 $X'(X')^{\\top}$ 是可逆的，可以找到 $A'$ 的唯一解。这保留了捕捉旋转动力学的目标，因为我们是在数据丰富的子空间内拟合一个斜对称矩阵（它产生旋转）。\n\n### 逐项分析\n\n**A. 当 $\\operatorname{rank}(X) = r  k$ 时，该映射仅在由观测到的状态轨迹张成的子空间 $\\mathcal{R}(X) \\subset \\mathbb{R}^{k}$ 上是可辨识的，因为 $A$ 的任何作用于与 $\\mathcal{R}(X)$ 正交方向上的分量都不会影响 $\\dot{X}$。一个原则性的补救措施是，使用奇异值分解（SVD）通过对奇异值进行阈值处理（例如，通过交叉验证或噪声基底标准）来选择一个等于 $X$ 的数值秩的降维维度 $r' \\leq r$，将 $X$ 和 $\\dot{X}$ 投影到前 $r'$ 个主成分上，并在这个 $r'$ 维子空间内拟合斜对称矩阵 $A$。**\n这个选项正确地指出了可辨识性仅限于子空间 $\\mathcal{R}(X)$。其给出的理由是合理的。所提出的补救措施——使用SVD确定数值秩，将数据及其导数投影到相应的子空间，然后在这个降维空间中拟合模型——正是正确且符合原则的程序。术语“主成分”在这里正确地指代了 $X$ 的SVD分解中的 $U$ 矩阵的列。\n**结论：正确。**\n\n**B. 当 $\\operatorname{rank}(X) = r  k$ 时，增加时间点数量 $T$ 会使 $X X^{\\top}$ 变得可逆，因此 $A$ 在原始的 $k$ 维空间中变得完全可辨识；无需进行维度选择。**\n这是不正确的。秩亏 $r  k$ 被陈述为数据集的一个属性，通常是由于任务约束将神经活动限制在一个较低维流形上。随着时间的推移收集更多的数据点（$T \\to \\infty$）将更密集地描绘出这个流形，但不会导致轨迹离开该流形。因此，数据矩阵 $X$ 的秩将保持为 $r$。由于 $\\operatorname{rank}(XX^{\\top}) = \\operatorname{rank}(X) = r  k$，无论 $T$ 变得多大，$XX^{\\top}$ 矩阵都将保持奇异。\n**结论：不正确。**\n\n**C. 斜对称约束 $A^{\\top} = -A$ 减少了足够多的自由参数，使得即使 $\\operatorname{rank}(X)  k$，$A$ 也是唯一可辨识的。因此，仅强制执行斜对称性就足够了；维度选择是不必要的。**\n这是不正确的。如推导中所示，即使有斜对称约束，如果 $A$ 对数据空间作用的零空间非平凡（如果 $r  k$ 并且我们在 $k$ 维空间中，情况就是如此），我们仍然可以构造一个非零的斜对称矩阵 $\\Delta A$ 使得 $\\Delta A X = 0$。这意味着解不是唯一的。虽然该约束将参数数量从 $k^2$ 减少到 $k(k-1)/2$，但这不足以克服在与 $\\mathcal{R}(X)$ 正交的方向上缺乏信息的问题。\n**结论：不正确。**\n\n**D. 为了解决秩亏问题，用 $(k-r)$ 个零方差PCA轴填充 $X$，使其在期望上有效地成为方形和可逆的；然后在完整的 $k$ 维空间中拟合 $A$，以便可以在不丢弃任何PCA轴的情况下恢复旋转平面。**\n这个选项是无稽之谈。用零行填充矩阵会向系统添加平凡的方程（$0=0$）；它不增加信息或提高 $XX^{\\top}$ 的秩。“在期望上有效地成为方形和可逆的”在此上下文中不是一个有效的数学或统计概念。在完整的 $k$ 维空间中进行拟合正是问题所在，因为没有数据来约束在 $(k-r)$ 个对应于零方差轴的维度上的动力学。人们无法恢复涉及那些没有观察到方差（因此也没有动力学）的轴的旋转平面。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}