{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂计算之前，首先掌握李雅普诺夫指数的基本性质至关重要。本练习旨在建立连续时间理论定义与离散时间数据测量之间的桥梁，探讨时间尺度的变换如何影响指数的值 。通过这个实践，您将巩固对李雅普诺夫指数物理意义和单位的理解，这是正确解释分析结果的基石。",
            "id": "4182450",
            "problem": "一个皮层群体信号通过微电极阵列被记录为标量时间序列，并用于通过延迟坐标嵌入重建状态空间。为了量化对初始条件的敏感性，最大李雅普诺夫指数通过附近重构轨迹之间分离的短期增长来估计。具体来说，对于小的整数延迟 $k$（以样本为单位），系综平均的对数分离近似地呈线性关系 $\\ln\\!\\big(d(k)/d(0)\\big) \\approx \\mu\\,k$，其中 $d(k)$ 是延迟 $k$ 处的平均分离，$\\mu$ 是斜率，单位是“每样本”。\n\n假设潜在的连续时间神经动力学由 $\\dot{\\mathbf{x}}(t)=\\mathbf{F}(\\mathbf{x}(t))$ 概括描述，并回顾最大李雅普诺夫指数的核心定义，即单位时间内的渐近指数分离率，\n$$\n\\lambda \\;=\\; \\lim_{t\\to\\infty}\\frac{1}{t}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right),\n$$\n对于足够小的 $\\|\\delta\\mathbf{x}(0)\\|$。你考虑通过变量变换 $t' = c\\,t$ 对时间进行一个因子为 $c0$ 的均匀重标度，这会引出一个新的流 $\\dfrac{d\\mathbf{x}}{dt'} = \\dfrac{1}{c}\\,\\mathbf{F}(\\mathbf{x})$。\n\n从上述定义出发，并且不使用任何快捷公式，推导最大李雅普诺夫指数在均匀时间重标度下如何变换，并解释在给定采样间隔 $\\Delta t$ 的情况下，离散时间斜率 $\\mu$（每样本）与连续时间 $\\lambda$（每秒）之间的关系。然后，将您的推导应用于以下测量量：\n- 采样间隔 $\\Delta t = 1\\,\\mathrm{ms} = 0.001\\,\\mathrm{s}$，\n- 测量的短延迟斜率 $\\mu = 0.015$ (每样本)，\n- 均匀时间重标度因子 $c = 5$ (即，$t' = c\\,t$)。\n\n计算时间重标度系统的重标度最大李雅普诺夫指数 $\\lambda'$，单位为 $\\mathrm{s}^{-1}$。以 $\\mathrm{s}^{-1}$ 为单位表示最终答案。无需四舍五入。",
            "solution": "该问题要求推导在均匀时间重标度下最大李雅普诺夫指数的变换规则，离散测量的斜率与连续时间指数之间的关系，以及最后根据给定数据计算重标度指数。\n\n首先，我们确定最大李雅普诺夫指数 $\\lambda$ 在均匀时间重标度下如何变换。原始系统的动力学由 $\\dot{\\mathbf{x}}(t)=\\mathbf{F}(\\mathbf{x}(t))$ 给出，最大李雅普诺夫指数定义为：\n$$ \\lambda = \\lim_{t\\to\\infty}\\frac{1}{t}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) $$\n其中 $\\delta\\mathbf{x}(t)$ 是在时间 $t$ 两个邻近轨迹之间的无穷小分离向量。\n\n引入一个新的时间变量 $t'$，使得对于常数 $c  0$ 有 $t' = c\\,t$。用这个新时间变量表示的动力学是 $\\frac{d\\mathbf{x}}{dt'} = \\frac{1}{c}\\,\\mathbf{F}(\\mathbf{x})$。这个重标度系统的最大李雅普诺夫指数，我们记为 $\\lambda'$，是关于时间 $t'$ 定义的：\n$$ \\lambda' = \\lim_{t'\\to\\infty}\\frac{1}{t'}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t')\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) $$\n系统在重标度时间 $t'$ 的状态与原始系统在时间 $t = t'/c$ 的状态相同。因此，重标度系统中在时间 $t'$ 的分离向量 $\\delta\\mathbf{x}$ 与原始系统中在时间 $t=t'/c$ 处计算的分离向量相同。我们可以将其表示为 $\\|\\delta\\mathbf{x}(t')\\|_{\\text{rescaled}} = \\|\\delta\\mathbf{x}(t'/c)\\|_{\\text{original}}$。将此代入 $\\lambda'$ 的定义中：\n$$ \\lambda' = \\lim_{t'\\to\\infty}\\frac{1}{t'}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t'/c)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) $$\n为了将其与 $\\lambda$ 的原始定义联系起来，我们在极限中进行变量替换，使用 $t = t'/c$。当 $t' \\to \\infty$ 且 $c0$ 时，可以得出 $t \\to \\infty$。代入 $t' = ct$ 得到：\n$$ \\lambda' = \\lim_{t\\to\\infty}\\frac{1}{ct}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) $$\n常数因子 $1/c$ 与极限无关，可以提出：\n$$ \\lambda' = \\frac{1}{c} \\left( \\lim_{t\\to\\infty}\\frac{1}{t}\\,\\ln\\!\\left(\\frac{\\|\\delta\\mathbf{x}(t)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) \\right) $$\n括号中的表达式是原始李雅普诺夫指数 $\\lambda$ 的定义。因此，变换规则是：\n$$ \\lambda' = \\frac{\\lambda}{c} $$\n\n其次，我们确定离散时间斜率 $\\mu$ 和连续时间指数 $\\lambda$ 之间的关系。对于一个连续系统，$\\lambda$ 的定义意味着对于一个小的初始分离，分离的增长近似为 $\\|\\delta\\mathbf{x}(t)\\| \\approx \\|\\delta\\mathbf{x}(0)\\| \\exp(\\lambda t)$。取自然对数得到：\n$$ \\ln\\left(\\frac{\\|\\delta\\mathbf{x}(t)\\|}{\\|\\delta\\mathbf{x}(0)\\|}\\right) \\approx \\lambda t $$\n在实验背景下，信号是在均匀间隔 $\\Delta t$ 采样的时序。分离 $d(k)$ 是在 $k$ 个整数时间步后测量的，这对应于总时间 $t = k\\Delta t$。因此，$d(k)$ 对应于 $\\|\\delta\\mathbf{x}(k\\Delta t)\\|$，$d(0)$ 对应于 $\\|\\delta\\mathbf{x}(0)\\|$。将这些代入连续关系式中得到：\n$$ \\ln\\left(\\frac{d(k)}{d(0)}\\right) \\approx \\lambda (k\\Delta t) $$\n问题为小的 $k$ 提供了经验观察到的线性关系：\n$$ \\ln\\left(\\frac{d(k)}{d(0)}\\right) \\approx \\mu k $$\n其中 $\\mu$ 是一个以“每样本”为单位测量的无量纲斜率。通过令这两个近似式的右侧相等，我们得到：\n$$ \\mu k = \\lambda k \\Delta t $$\n除以非零整数 $k$ 得到关系式：\n$$ \\mu = \\lambda \\Delta t $$\n这个方程将实验测量的无量纲量 $\\mu$ 与基本的连续时间物理量 $\\lambda$ 联系起来。为了从测量的斜率中求出 $\\lambda$，我们可以将其重新排列为 $\\lambda = \\mu / \\Delta t$。\n\n第三，我们应用这些结果，使用提供的数值计算重标度指数 $\\lambda'$：\n- 采样间隔 $\\Delta t = 1\\,\\mathrm{ms} = 0.001\\,\\mathrm{s}$\n- 测量的斜率 $\\mu = 0.015$ (每样本)\n- 时间重标度因子 $c = 5$\n\n首先，我们根据测量数据计算原始系统的最大李雅普诺夫指数 $\\lambda$：\n$$ \\lambda = \\frac{\\mu}{\\Delta t} = \\frac{0.015}{0.001\\,\\mathrm{s}} = 15\\,\\mathrm{s}^{-1} $$\n接下来，我们使用推导出的变换规则来计算时间重标度系统的最大李雅普诺夫指数 $\\lambda'$：\n$$ \\lambda' = \\frac{\\lambda}{c} = \\frac{15\\,\\mathrm{s}^{-1}}{5} = 3\\,\\mathrm{s}^{-1} $$\n重标度的最大李雅普诺夫指数是 $3\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在理解了单个最大李雅普诺夫指数的含义之后，我们可以进一步探索完整的李雅普诺夫指数谱。整个指数谱包含了关于系统吸引子几何结构的丰富信息 。本练习将向您展示如何将整个谱综合成一个强大的描述符——卡普兰-约克维度（Kaplan-Yorke dimension），它量化了系统动态的有效自由度或分形维度。",
            "id": "4182471",
            "problem": "从麻醉啮齿动物的初级体感皮层记录了皮层局部场电位 (LFP) 时间序列 $x(t)$，记录时长为 $1{,}200$ 秒，采样率为 $1{,}000$ 赫兹。在进行 $1$ 赫兹至 $120$ 赫兹的带通滤波后，根据 Takens 定理，采用时间延迟 $\\tau = 5$ 毫秒和通过伪近邻判据选择的嵌入维度 $m = 12$，通过延迟坐标嵌入法重构了吸引子。利用带有 Gram–Schmidt 再正交化（Benettin 方法）的局部线性雅可比近似，从重构的动力学中估算了李雅普诺夫指数集 $\\{\\lambda_i\\}_{i=1}^{m}$，然后按非递增顺序对其进行排序。估算出的谱（单位为 $\\mathrm{s}^{-1}$）为\n$$\n\\lambda_1 = 0.58,\\ \\lambda_2 = 0.17,\\ \\lambda_3 = 0.04,\\ \\lambda_4 = 0.01,\\ \\lambda_5 = -0.05,\\ \\lambda_6 = -0.22,\\ \\lambda_7 = -0.31,\\ \\lambda_8 = -0.44,\\ \\lambda_9 = -0.62,\\ \\lambda_{10} = -0.88,\\ \\lambda_{11} = -1.15,\\ \\lambda_{12} = -1.50.\n$$\n从李雅普诺夫指数作为相邻轨道分离的渐近指数率的基本定义，以及谱的部分和作为维度递增子空间中净体积增长率的概念出发，确定重构吸引子的 Kaplan–Yorke（李雅普诺夫）维度 $D_{KY}$。这需要首先识别出合适的索引 $j$，在该索引处累积体积增长从非负过渡到负，然后进行插值以获得介于 $j$ 和 $j+1$ 之间的分数维度。将计算出的 $D_{KY}$ 解释为皮层动力学的有效系统维度。将最终数值答案四舍五入至四位有效数字。最终量 $D_{KY}$ 是无量纲的；请将最终答案表示为不带单位的纯数。",
            "solution": "任务是根据给定的李雅普诺夫指数谱计算 Kaplan–Yorke 维度，记为 $D_{KY}$。李雅普诺夫指数 $\\{\\lambda_i\\}$ 量化了重构相空间中相邻轨道发散或收敛的平均指数率。对于一个 $m$ 维系统，定义了一组 $m$ 个指数，通常按降序排列：$\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_m$。正指数表示对初始条件的敏感依赖性（混沌），因为它们对应于相空间体积局部拉伸的方向。负指数对应于局部收缩的方向。\n\nKaplan–Yorke 维度是关于动力系统吸引子信息维度的猜想，它提供了系统有效自由度的估计值。它是根据李雅普诺夫谱计算得出的。前 $k$ 个指数的累积和 $\\sum_{i=1}^{k} \\lambda_i$ 表示相空间中 $k$ 维体积元的平均指数变化率。Kaplan–Yorke 维度定义为该体积变化率从非负（扩张）过渡到负（收缩）时的维度。\n\nKaplan–Yorke 维度的计算公式为：\n$$\nD_{KY} = j + \\frac{\\sum_{i=1}^{j} \\lambda_i}{|\\lambda_{j+1}|}\n$$\n其中 $j$ 是使前 $j$ 个李雅普诺夫指数之和为非负的最大整数，即 $\\sum_{i=1}^{j} \\lambda_i \\ge 0$ 且 $\\sum_{i=1}^{j+1} \\lambda_i   0$。整数部分 $j$ 表示平均而言处于扩张或稳定状态的子空间的维度。小数部分表示为平衡扩张所需的第一个收缩方向的贡献，实际上是“填满”下一个维度。\n\n我们已知嵌入维度 $m=12$ 和排序后的李雅普诺夫谱（单位为 $\\mathrm{s}^{-1}$）：\n$\\lambda_1 = 0.58$, $\\lambda_2 = 0.17$, $\\lambda_3 = 0.04$, $\\lambda_4 = 0.01$, $\\lambda_5 = -0.05$, $\\lambda_6 = -0.22$, $\\lambda_7 = -0.31$, $\\lambda_8 = -0.44$, $\\lambda_9 = -0.62$, $\\lambda_{10} = -0.88$, $\\lambda_{11} = -1.15$, $\\lambda_{12} = -1.50$。\n\n首先，我们必须通过计算指数的累积和 $S_k = \\sum_{i=1}^{k} \\lambda_i$ 来找到索引 $j$。\n$$S_1 = \\lambda_1 = 0.58$$\n$$S_2 = S_1 + \\lambda_2 = 0.58 + 0.17 = 0.75$$\n$$S_3 = S_2 + \\lambda_3 = 0.75 + 0.04 = 0.79$$\n$$S_4 = S_3 + \\lambda_4 = 0.79 + 0.01 = 0.80$$\n$$S_5 = S_4 + \\lambda_5 = 0.80 + (-0.05) = 0.75$$\n$$S_6 = S_5 + \\lambda_6 = 0.75 + (-0.22) = 0.53$$\n$$S_7 = S_6 + \\lambda_7 = 0.53 + (-0.31) = 0.22$$\n$$S_8 = S_7 + \\lambda_8 = 0.22 + (-0.44) = -0.22$$\n\n累积和 $S_k$ 在 $k \\le 7$ 时为非负，在 $k=8$ 时变为负。因此，索引 $j$ 为 $7$。\n\n现在，我们可以将 $j=7$ 应用于 Kaplan–Yorke 公式：\n$$D_{KY} = j + \\frac{\\sum_{i=1}^{j} \\lambda_i}{|\\lambda_{j+1}|} = 7 + \\frac{S_7}{|\\lambda_8|}$$\n\n我们有所需的数值：\n- 直到 $j=7$ 的和为 $S_7 = 0.22$。\n- 下一个李雅普诺夫指数为 $\\lambda_8 = -0.44$。\n- 其绝对值为 $|\\lambda_8| = |-0.44| = 0.44$。\n\n将这些值代入公式：\n$$D_{KY} = 7 + \\frac{0.22}{0.44} = 7 + 0.5 = 7.5$$\n\n问题要求将答案四舍五入至四位有效数字。计算值为 $7.5$，按要求格式即为 $7.500$。\n\n对该结果的解释是，皮层局部场电位的复杂动力学，尽管为分析目的嵌入了一个 $12$ 维空间，但它实际上是在一个分形维度约为 $7.500$ 的几何结构（奇异吸引子）上展开的。这种非整数维度是混沌系统的一个特征。它意味着，要模拟这种神经活动的核心动力学，至少需要 $\\lceil D_{KY} \\rceil = \\lceil 7.500 \\rceil = 8$ 个常微分方程，并且该吸引子并未完全填满其所处的 $8$ 维空间。计算出的值为了解大脑潜在动力学的复杂性提供了一个定量度量。",
            "answer": "$$\\boxed{7.500}$$"
        },
        {
            "introduction": "理论与实践之间的一个关键差距在于噪声的存在，尤其是在神经科学等实验领域。本练习直面这一挑战，探讨了加性测量噪声如何对相空间中的距离计算产生系统性偏差，而这种计算是估算李雅普诺夫指数的基础 。通过分析噪声的统计效应并探索噪声感知的度量方法，您将掌握进行稳健数据分析的关键技能，这对于任何处理真实实验数据的人来说都至关重要。",
            "id": "4182542",
            "problem": "单通道神经时间序列 $\\{x_t^{\\text{obs}}\\}_{t=1}^T$（例如，局部场电位振幅）被建模为一个确定性动力学信号上叠加了附加测量噪声：$x_t^{\\text{obs}} = x_t + \\eta_t$，其中 $\\eta_t \\sim \\mathcal{N}(0,\\sigma^2)$ 在时间 $t$ 上是独立的。为了通过相邻点发散来重构状态空间以估计最大李雅普诺夫指数，您需要构建延迟为 $\\tau \\ge 1$ 的 $m$ 维延迟向量 $y_t^{\\text{obs}} = \\left(x_t^{\\text{obs}}, x_{t-\\tau}^{\\text{obs}}, \\dots, x_{t-(m-1)\\tau}^{\\text{obs}}\\right) \\in \\mathbb{R}^m$，并施加Theiler窗以避免时间上相邻的点。令 $y_t$ 表示由 $\\{x_t\\}$ 构建的无噪声延迟向量，并将两个嵌入点 $i \\neq j$ 之间的观测差值定义为 $\\Delta y_{ij}^{\\text{obs}} = y_i^{\\text{obs}} - y_j^{\\text{obs}}$，无噪声差值定义为 $\\Delta y_{ij} = y_i - y_j$。\n\n首先假设在 $m$ 个延迟坐标上的测量噪声保持独立同分布，方差为 $\\sigma^2$（当延迟至少为 $\\tau \\ge 1$ 个样本且测量过程在时间上是白噪声时，此条件成立）。然后考虑一种推广情况，其中影响 $y_t^{\\text{obs}}$ 的 $m$ 维噪声具有零均值和协方差矩阵 $\\Sigma \\in \\mathbb{R}^{m \\times m}$（例如，由于通道间的差异传感器噪声，或引入跨延迟相关性的预处理），且在不同的时间索引 $t$ 上的噪声是独立的。\n\n选择所有关于附加测量噪声如何影响延迟嵌入空间中的邻居搜索，以及关于用于邻居选择和李雅普诺夫指数估计的噪声感知距离度量的正确陈述：\n\nA. 在 $m$ 个延迟坐标上存在方差为 $\\sigma^2$ 的独立同分布高斯噪声的情况下，观测到的点间平方距离的条件期望满足 $\\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2 m \\sigma^2$。\n\nB. 对于每个嵌入点上均值为零、协方差为 $\\Sigma$ 的高斯噪声，噪声差值 $\\Delta n_{ij} = n_i - n_j$ 的协方差为 $2\\Sigma$，因此 $\\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2\\,\\mathrm{tr}(\\Sigma)$。从观测到的平方距离中减去 $2\\,\\mathrm{tr}(\\Sigma)$ 会得到真实平方距离 $\\left\\|\\Delta y_{ij}\\right\\|^2$ 的一个（在期望意义上）无偏估计量。\n\nC. 当噪声是各向同性的，协方差为 $\\sigma^2 I_m$ 时，使用协方差 $2 \\sigma^2 I_m$ 的马氏距离替换欧几里得距离会改变邻居排序，使其对噪声更具鲁棒性。\n\nD. 如果延迟坐标具有异质噪声方差 $\\sigma_1^2,\\dots,\\sigma_m^2$（因此 $\\Sigma = \\mathrm{diag}(\\sigma_1^2,\\dots,\\sigma_m^2)$），通过加权欧几里得度量 $\\sum_{k=1}^m \\left(\\Delta y_{ij,k}^{\\text{obs}}\\right)^2 / \\sigma_k^2$（等价于使用协方差 $2\\Sigma$ 的马氏距离）对邻居进行排序，是在高斯噪声下选择最近邻的最大似然准则。\n\nE. 为了减少用于最大李雅普诺夫指数估计的短时发散曲线中的噪声偏差，将初始观测分离距离 $\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|$ 替换为 $\\sqrt{\\max\\!\\left(\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 - 2 m \\sigma^2,\\; 0\\right)}$ 会在期望上得到真实分离幅度 $\\left\\|\\Delta y_{ij}\\right\\|$ 的一个无偏估计量。",
            "solution": "令时间 $t$ 的观测 $m$ 维延迟向量为 $y_t^{\\text{obs}}$，真实的无噪声向量为 $y_t$。它们之间的关系是 $y_t^{\\text{obs}} = y_t + n_t$，其中 $n_t$ 是噪声向量。问题陈述指出，噪声向量 $n_t$ 在不同的时间 $t$ 上是独立的。每个噪声向量 $n_t$ 都从一个零均值的多元高斯分布中抽取，$n_t \\sim \\mathcal{N}(0, \\Sigma)$。\n\n我们关心的是两个不同点（索引为 $i$ 和 $j$，$i \\neq j$）之间的距离。观测差值向量为 $\\Delta y_{ij}^{\\text{obs}} = y_i^{\\text{obs}} - y_j^{\\text{obs}}$。真实差值向量为 $\\Delta y_{ij} = y_i - y_j$。噪声差值向量为 $\\Delta n_{ij} = n_i - n_j$。它们之间的关系是：\n$$ \\Delta y_{ij}^{\\text{obs}} = (y_i + n_i) - (y_j + n_j) = (y_i - y_j) + (n_i - n_j) = \\Delta y_{ij} + \\Delta n_{ij} $$\n由于当 $i \\neq j$ 时，$n_i$ 和 $n_j$ 是独立的，并且都来自 $\\mathcal{N}(0, \\Sigma)$，它们的差 $\\Delta n_{ij}$ 也是一个高斯随机向量。\n噪声差值的均值为 $\\mathbb{E}[\\Delta n_{ij}] = \\mathbb{E}[n_i] - \\mathbb{E}[n_j] = 0 - 0 = 0$。\n噪声差值的协方差为 $\\mathrm{Cov}(\\Delta n_{ij}) = \\mathrm{Cov}(n_i - n_j) = \\mathrm{Cov}(n_i) + \\mathrm{Cov}(n_j) = \\Sigma + \\Sigma = 2\\Sigma$，因为 $n_i$ 和 $n_j$ 是独立的。所以，$\\Delta n_{ij} \\sim \\mathcal{N}(0, 2\\Sigma)$。\n\n我们通常关心的是欧几里得距离的平方，即 $\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2$。我们来展开它：\n$$ \\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 = \\left\\| \\Delta y_{ij} + \\Delta n_{ij} \\right\\|^2 = (\\Delta y_{ij} + \\Delta n_{ij})^T (\\Delta y_{ij} + \\Delta n_{ij}) $$\n$$ = \\Delta y_{ij}^T \\Delta y_{ij} + 2 \\Delta y_{ij}^T \\Delta n_{ij} + \\Delta n_{ij}^T \\Delta n_{ij} = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2 \\Delta y_{ij}^T \\Delta n_{ij} + \\left\\|\\Delta n_{ij}\\right\\|^2 $$\n现在我们取关于噪声的条件期望，给定真实的确定性向量（因此，给定 $\\Delta y_{ij}$）：\n$$ \\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}\\right\\|^2 \\mid \\Delta y_{ij}\\right] + 2 \\Delta y_{ij}^T \\mathbb{E}\\!\\left[\\Delta n_{ij} \\mid \\Delta y_{ij}\\right] + \\mathbb{E}\\!\\left[\\left\\|\\Delta n_{ij}\\right\\|^2 \\mid \\Delta y_{ij}\\right] $$\n由于 $\\Delta n_{ij}$ 与确定性信号无关，所以条件对于噪声项是无关的。因为 $\\mathbb{E}[\\Delta n_{ij}] = 0$，中间项消失。\n$$ \\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + \\mathbb{E}[\\left\\|\\Delta n_{ij}\\right\\|^2] $$\n对于任何均值为 $\\mu$、协方差为 $C$ 的随机向量 $Z$，其期望平方范数为 $\\mathbb{E}[\\left\\|Z\\right\\|^2] = \\mathrm{tr}(C) + \\left\\|\\mu\\right\\|^2$。对于我们的噪声差值向量 $Z = \\Delta n_{ij}$，均值为 $\\mu = 0$，协方差为 $C = 2\\Sigma$。\n因此，$\\mathbb{E}[\\left\\|\\Delta n_{ij}\\right\\|^2] = \\mathrm{tr}(2\\Sigma) = 2\\,\\mathrm{tr}(\\Sigma)$。\n这给了我们观测平方距离期望的通用公式：\n$$ \\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2\\,\\mathrm{tr}(\\Sigma) $$\n这个表达式表明，附加噪声会给欧几里得距离的平方引入一个正偏差，该偏差与噪声协方差矩阵的迹成正比。\n\n现在我们来评估每个选项。\n\n**A. 在 $m$ 个延迟坐标上存在方差为 $\\sigma^2$ 的独立同分布高斯噪声的情况下，观测到的点间平方距离的条件期望满足 $\\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2 m \\sigma^2$。**\n\n这对应于延迟向量中的噪声分量是独立同分布的特殊情况。噪声向量 $n_t$ 的协方差矩阵是 $\\Sigma = \\sigma^2 I_m$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。\n我们使用上面推导出的通用公式，代入这个特定的 $\\Sigma$：\n$\\Sigma$ 的迹是 $\\mathrm{tr}(\\Sigma) = \\mathrm{tr}(\\sigma^2 I_m) = \\sigma^2 \\mathrm{tr}(I_m) = \\sigma^2 \\sum_{k=1}^m 1 = m\\sigma^2$。\n将此代入期望平方距离的通用表达式中：\n$$ \\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2(m\\sigma^2) = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2 m \\sigma^2 $$\n这个表达式与选项 A 中的陈述相符。\n结论：**正确**。\n\n**B. 对于每个嵌入点上均值为零、协方差为 $\\Sigma$ 的高斯噪声，噪声差值 $\\Delta n_{ij} = n_i - n_j$ 的协方差为 $2\\Sigma$，因此 $\\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2\\,\\mathrm{tr}(\\Sigma)$。从观测到的平方距离中减去 $2\\,\\mathrm{tr}(\\Sigma)$ 会得到真实平方距离 $\\left\\|\\Delta y_{ij}\\right\\|^2$ 的一个（在期望意义上）无偏估计量。**\n\n这个陈述包含两部分。第一部分是 $\\mathrm{Cov}(\\Delta n_{ij}) = 2\\Sigma$ 和 $\\mathbb{E}\\!\\left[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}\\right] = \\left\\|\\Delta y_{ij}\\right\\|^2 + 2\\,\\mathrm{tr}(\\Sigma)$。正如初始推导所示，这两点都是正确的。\n第二部分声称 $\\hat{d^2} = \\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 - 2\\,\\mathrm{tr}(\\Sigma)$ 是真实平方距离 $\\left\\|\\Delta y_{ij}\\right\\|^2$ 的无偏估计量。如果一个估计量的期望等于被估计参数的真实值，则该估计量是无偏的。我们来计算 $\\hat{d^2}$ 的期望：\n$$ \\mathbb{E}[\\hat{d^2} \\mid \\Delta y_{ij}] = \\mathbb{E}[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 - 2\\,\\mathrm{tr}(\\Sigma) \\mid \\Delta y_{ij}] $$\n$$ = \\mathbb{E}[\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 \\mid \\Delta y_{ij}] - 2\\,\\mathrm{tr}(\\Sigma) $$\n使用第一部分的结果，我们代入观测平方距离期望的表达式：\n$$ \\mathbb{E}[\\hat{d^2} \\mid \\Delta y_{ij}] = (\\left\\|\\Delta y_{ij}\\right\\|^2 + 2\\,\\mathrm{tr}(\\Sigma)) - 2\\,\\mathrm{tr}(\\Sigma) = \\left\\|\\Delta y_{ij}\\right\\|^2 $$\n该估计量的期望确实是真实平方距离。因此，它是一个无偏估计量。陈述的两部分都正确。\n结论：**正确**。\n\n**C. 当噪声是各向同性的，协方差为 $\\sigma^2 I_m$ 时，使用协方差 $2 \\sigma^2 I_m$ 的马氏距离替换欧几里得距离会改变邻居排序，使其对噪声更具鲁棒性。**\n\n关于协方差矩阵 $S$ 的 $y_i^{\\text{obs}}$ 和 $y_j^{\\text{obs}}$ 之间的马氏距离平方由 $d_M^2 = (\\Delta y_{ij}^{\\text{obs}})^T S^{-1} (\\Delta y_{ij}^{\\text{obs}})$ 给出。\n在这种情况下，差值向量 $\\Delta n_{ij}$ 上的噪声具有协方差 $S = 2\\Sigma = 2\\sigma^2 I_m$。\n其逆矩阵为 $S^{-1} = (2\\sigma^2 I_m)^{-1} = \\frac{1}{2\\sigma^2} I_m$。\n马氏距离的平方是：\n$$ d_M^2 = (\\Delta y_{ij}^{\\text{obs}})^T \\left(\\frac{1}{2\\sigma^2} I_m\\right) (\\Delta y_{ij}^{\\text{obs}}) = \\frac{1}{2\\sigma^2} (\\Delta y_{ij}^{\\text{obs}})^T (\\Delta y_{ij}^{\\text{obs}}) = \\frac{1}{2\\sigma^2} \\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 $$\n马氏距离为 $d_M = \\sqrt{\\frac{1}{2\\sigma^2} \\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2} = \\frac{1}{\\sqrt{2}\\sigma} \\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|$。\n由于 $\\sigma$ 是一个常数，马氏距离仅仅是欧几里得距离 $\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|$ 按一个常数因子 $1/(\\sqrt{2}\\sigma)$ 缩放。当对一个给定点的潜在邻居进行排序时，将所有距离乘以同一个正常数不会改变它们的顺序。因此，邻居排序与使用欧几里得距离得到的排序相同。陈述中“改变”排序的说法是错误的。\n结论：**不正确**。\n\n**D. 如果延迟坐标具有异质噪声方差 $\\sigma_1^2,\\dots,\\sigma_m^2$（因此 $\\Sigma = \\mathrm{diag}(\\sigma_1^2,\\dots,\\sigma_m^2)$），通过加权欧几里得度量 $\\sum_{k=1}^m \\left(\\Delta y_{ij,k}^{\\text{obs}}\\right)^2 / \\sigma_k^2$（等价于使用协方差 $2\\Sigma$ 的马氏距离）对邻居进行排序，是在高斯噪声下选择最近邻的最大似然准则。**\n\n首先，我们来验证这些度量在排序上的等价性。噪声向量的协方差为 $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_m^2)$。噪声差值的协方差为 $S = 2\\Sigma = \\mathrm{diag}(2\\sigma_1^2, \\dots, 2\\sigma_m^2)$。其逆矩阵为 $S^{-1} = \\frac{1}{2} \\mathrm{diag}(1/\\sigma_1^2, \\dots, 1/\\sigma_m^2)$。\n马氏距离的平方是：\n$$ d_M^2 = (\\Delta y_{ij}^{\\text{obs}})^T S^{-1} (\\Delta y_{ij}^{\\text{obs}}) = \\sum_{k=1}^m \\frac{1}{2\\sigma_k^2} (\\Delta y_{ij,k}^{\\text{obs}})^2 = \\frac{1}{2} \\sum_{k=1}^m \\frac{(\\Delta y_{ij,k}^{\\text{obs}})^2}{\\sigma_k^2} $$\n陈述中的加权欧几里得度量是 $d_W^2 = \\sum_{k=1}^m (\\Delta y_{ij,k}^{\\text{obs}})^2 / \\sigma_k^2$。由于 $d_M^2 = \\frac{1}{2} d_W^2$，使用任一度量进行排序都会得到相同的结果。对于排序而言，等价性的说法是正确的。\n\n现在，我们评估这是否是一个最大似然（ML）准则。在有噪声的环境中寻找“最近邻”可以解释为寻找最有可能成为“真实”邻居的对 $(i,j)$，即其真实分离距离 $\\Delta y_{ij}$ 为零或非常小。让我们考虑假设 $H_0: \\Delta y_{ij}=0$。在此假设下，$\\Delta y_{ij}^{\\text{obs}} = \\Delta n_{ij} \\sim \\mathcal{N}(0, 2\\Sigma)$。观测到 $\\Delta y_{ij}^{\\text{obs}}$ 的对数似然为：\n$$ \\log p(\\Delta y_{ij}^{\\text{obs}} \\mid H_0) = -\\frac{1}{2} (\\Delta y_{ij}^{\\text{obs}})^T (2\\Sigma)^{-1} (\\Delta y_{ij}^{\\text{obs}}) - \\frac{1}{2}\\log\\det(2\\Sigma) - \\frac{m}{2}\\log(2\\pi) $$\n为了在选择邻居 $j$ 时最大化这个似然，我们必须最小化二次项 $(\\Delta y_{ij}^{\\text{obs}})^T (2\\Sigma)^{-1} (\\Delta y_{ij}^{\\text{obs}})$，这正是使用协方差 $2\\Sigma$ 的马氏距离平方。该度量适当地降低了具有高噪声方差（$\\sigma_k^2$）的坐标的权重，使其成为在存在异方差高斯噪声时识别相近点对的最佳方法。这是统计估计理论中的一个标准结果。\n结论：**正确**。\n\n**E. 为了减少用于最大李雅普诺夫指数估计的短时发散曲线中的噪声偏差，将初始观测分离距离 $\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|$ 替换为 $\\sqrt{\\max\\!\\left(\\left\\|\\Delta y_{ij}^{\\text{obs}}\\right\\|^2 - 2 m \\sigma^2,\\; 0\\right)}$ 会在期望上得到真实分离幅度 $\\left\\|\\Delta y_{ij}\\right\\|$ 的一个无偏估计量。**\n\n该选项提出了一个真实距离大小 $\\|\\Delta y_{ij}\\|$ 的估计量，而不是距离的平方。令 $d_{\\text{true}} = \\|\\Delta y_{ij}\\|$ 且 $d_{\\text{obs}} = \\|\\Delta y_{ij}^{\\text{obs}}\\|$。\n从选项 A，我们知道 $\\mathbb{E}[d_{\\text{obs}}^2] = d_{\\text{true}}^2 + 2m\\sigma^2$。\n令 $X = d_{\\text{obs}}^2 - 2m\\sigma^2$。那么 $\\mathbb{E}[X] = d_{\\text{true}}^2$。所以，$X$ 是平方距离的无偏估计量。\n所提出的距离大小的估计量是 $\\hat{d} = \\sqrt{\\max(X, 0)}$。\n我们需要检查是否 $\\mathbb{E}[\\hat{d}] = d_{\\text{true}}$。\n函数 $f(X) = \\sqrt{\\max(X, 0)}$ 是一个非线性的凹函数。根据琴生不等式，对于一个凹函数 $f$ 和一个随机变量 $X$，我们有 $\\mathbb{E}[f(X)] \\le f(\\mathbb{E}[X])$。如果 $f$ 是严格凹函数且 $X$ 不是一个常数，则不等式是严格的。\n将此应用于这里：\n$$ \\mathbb{E}[\\hat{d}] = \\mathbb{E}[\\sqrt{\\max(X, 0)}] \\le \\sqrt{\\max(\\mathbb{E}[X], 0)} $$\n由于 $\\mathbb{E}[X] = d_{\\text{true}}^2 \\ge 0$：\n$$ \\mathbb{E}[\\hat{d}] \\le \\sqrt{d_{\\text{true}}^2} = d_{\\text{true}} $$\n因为 $d_{\\text{obs}}^2$ 是一个随机变量（由于噪声），$X$ 也是一个随机变量，且不等式是严格的。这意味着 $\\mathbb{E}[\\hat{d}]   d_{\\text{true}}$。该估计量是有偏的；它系统性地低估了真实的距离大小。关于它是无偏估计量的陈述是错误的。\n结论：**不正确**。\n\n最终总结：选项 A、B 和 D 是正确的。选项 C 和 E 是不正确的。",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}