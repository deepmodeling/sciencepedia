{
    "hands_on_practices": [
        {
            "introduction": "在进行任何神经科学实验之前，确定研究是否具备足够的统计功效来检测预期的效应是至关重要的一步。本练习将通过一个关于脑磁图（MEG）研究的假设场景，指导你计算所需的样本量，这是设计具有统计鲁棒性研究的基础。通过这个实践，你将理解效应大小、显著性水平和统计功效三者之间的相互作用。",
            "id": "4169064",
            "problem": "一个研究团队正在计划一项组间研究，使用脑磁图（MEG）传感器来检测两个独立参与者队列之间平均传感器振幅的差异，并对两个队列进行均等分配。设队列 $1$ 的平均振幅为 $\\mu_{1}$，队列 $2$ 的平均振幅为 $\\mu_{2}$，并假设参与者间的振幅近似呈高斯分布，且两个队列具有共同的标准差 $\\sigma$。该团队将使用显著性水平为 $\\alpha = 0.05$ 的双侧独立样本 $t$ 检验来检验零假设 $H_{0}: \\mu_{1} - \\mu_{2} = 0$ 与备择假设 $H_{1}: \\mu_{1} - \\mu_{2} \\neq 0$。效应量被先验地指定为 Cohen’s $d = 0.5$，其中 $d = (\\mu_{1} - \\mu_{2})/\\sigma$，目标功效为 $0.8$。\n\n从假设检验的定义、样本均值之差的抽样分布以及 Cohen’s $d$ 的定义出发，推导为达到指定检验的目标功效所需的每组最小样本量 $n$。请清楚地说明你所采用的统计假设以及所使用的任何近似方法。数值计算 $n$。如果你的计算结果为非整数，请报告满足功效要求的每组最小整数 $n$。给出最终的 $n$，不带单位。",
            "solution": "该问题要求对一项双侧、双独立样本研究进行功效分析，以确定所需的样本量 $n$。我们给定了显著性水平 $\\alpha = 0.05$、目标功效 $1-\\beta = 0.8$ 以及由 Cohen's $d = 0.5$ 定义的效应量。\n\n原假设为 $H_{0}: \\mu_{1} - \\mu_{2} = 0$，备择假设为 $H_{1}: \\mu_{1} - \\mu_{2} \\neq 0$。\n\n在功效计算中，当样本量较大时，通常使用正态分布来近似 $t$ 分布。在零假设 $H_0$ 下，检验统计量 $Z_{test} = \\frac{\\bar{X}_1 - \\bar{X}_2}{\\sigma \\sqrt{\\frac{2}{n}}}$ 近似服从标准正态分布 $N(0, 1)$。对于双侧检验，在显著性水平 $\\alpha$ 下，当 $|Z_{test}| > z_{1-\\alpha/2}$ 时，我们拒绝 $H_0$。\n\n功效是在备择假设 $H_1$ 为真的情况下拒绝 $H_0$ 的概率。在 $H_1$ 下，真实均值差为 $\\mu_1 - \\mu_2 = \\delta$。根据 Cohen's $d$ 的定义，$\\delta = d\\sigma$。样本均值之差 $\\bar{X}_1 - \\bar{X}_2$ 的抽样分布近似为均值为 $\\delta$、方差为 $\\frac{2\\sigma^2}{n}$ 的正态分布。因此，在 $H_1$ 下，检验统计量 $Z_{test}$ 近似服从均值为 $E[Z_{test}] = \\frac{d\\sigma}{\\sigma \\sqrt{2/n}} = d\\sqrt{\\frac{n}{2}}$、方差为 $1$ 的正态分布。\n\n功效是 $P(\\text{拒绝 } H_0 | H_1 \\text{ 为真}) = P(|Z_{test}| > z_{1-\\alpha/2} | H_1)$。对于正的效应量 $d>0$，我们可以忽略在错误方向上拒绝的极小概率，从而将功效近似为：\n$$ \\text{功效} = 1-\\beta \\approx P\\left(Z_{test} > z_{1-\\alpha/2} | H_1\\right) $$\n将 $Z_{test}$ 用一个标准正态变量 $Z \\sim N(0,1)$ 表示为 $Z_{test} = Z + d\\sqrt{n/2}$，我们得到：\n$$ 1-\\beta \\approx P\\left(Z + d\\sqrt{\\frac{n}{2}} > z_{1-\\alpha/2}\\right) = P\\left(Z > z_{1-\\alpha/2} - d\\sqrt{\\frac{n}{2}}\\right) $$\n这等价于要求 $z_{1-\\beta} \\approx d\\sqrt{\\frac{n}{2}} - z_{1-\\alpha/2}$，或更常见地写作：\n$$ z_{1-\\beta} + z_{1-\\alpha/2} \\approx d\\sqrt{\\frac{n}{2}} $$\n重新整理以求解样本量 $n$：\n$$ n \\approx 2 \\left( \\frac{z_{1-\\alpha/2} + z_{1-\\beta}}{d} \\right)^2 $$\n现在，我们代入给定的值：\n- 显著性水平 $\\alpha = 0.05$ (双侧)，因此 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$。\n- 目标功效 $1-\\beta = 0.8$，因此 $\\beta = 0.2$，$z_{1-\\beta} = z_{0.8} \\approx 0.8416$。\n- 效应量 $d = 0.5$。\n\n将这些值代入公式：\n$$ n \\approx 2 \\left( \\frac{1.96 + 0.8416}{0.5} \\right)^2 $$\n$$ n \\approx 2 \\left( \\frac{2.8016}{0.5} \\right)^2 $$\n$$ n \\approx 2 \\left( 5.6032 \\right)^2 $$\n$$ n \\approx 2 (31.3958) $$\n$$ n \\approx 62.7916 $$\n由于样本量必须是整数，我们向上取整到下一个整数，以确保达到或超过功效要求。因此，每组所需的最小样本量是 $n=63$。",
            "answer": "$$\\boxed{63}$$"
        },
        {
            "introduction": "收集到数据后，一项核心任务是检验关于大脑激活的特定假设。通用线性模型（GLM）为此提供了一个强大而灵活的框架，尤其在功能性磁共振成像（fMRI）分析中。本练习将引导你构建一个对比向量（contrast vector），以检验两种实验条件下的激活差异，这是解读GLM结果的一项核心技能。",
            "id": "4169094",
            "problem": "来自功能性磁共振成像 (fMRI) 实验的单个体素时间序列，使用通用线性模型 (GLM) 进行建模。设计矩阵有 $p=4$ 列，分别对应：一个截距（基线）、一个编码条件 $\\mathcal{A}$ 的回归量（例如，人脸）、一个编码条件 $\\mathcal{B}$ 的回归量（例如，形状），以及一个用于头部运动的无关回归量。设扫描次数为 $N=240$。拟合的普通最小二乘估计量得到的系数向量为\n$$\n\\hat{\\boldsymbol{\\beta}}=\\begin{pmatrix}510.0 \\\\ 1.5 \\\\ 0.6 \\\\ 0.02\\end{pmatrix},\n$$\n且残差平方和为\n$$\n\\mathrm{RSS}=432.0.\n$$\n假设标准的同方差高斯噪声模型，其误差为 $\\boldsymbol{\\varepsilon}\\sim \\mathcal{N}(\\boldsymbol{0},\\sigma^{2}\\boldsymbol{I})$，并且估计量的协方差由 $\\sigma^{2}( \\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1}$ 给出，其中提供的矩阵\n$$\n(\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1}=\\begin{pmatrix}\n0.002  0  0  0 \\\\\n0  0.010  -0.004  0 \\\\\n0  -0.004  0.012  0 \\\\\n0  0  0  0.005\n\\end{pmatrix}\n$$\n是对称的。\n\n您的目标是检验定义为条件 $\\mathcal{A}$ 和条件 $\\mathcal{B}$ 回归量之间差异的实验效应，同时保持截距和运动回归量固定。使用线性对比为此效应建立零假设 $H_{0}$ 和备择假设 $H_{1}$，构造相应的对比向量 $\\boldsymbol{c}$，并计算用于检验 $H_{0}$ 与 $H_{1}$ 的相应的一自由度对比 $t$-统计量。使用无偏残差方差估计量 $\\hat{\\sigma}^{2}=\\mathrm{RSS}/(N-p)$。\n\n提供 $t$-统计量的最终数值。$t$-统计量是无量纲的。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在通用线性模型 (GLM) 框架内，计算特定线性对比的 $t$-统计量。\n\n首先，我们定义假设和对比向量。目标是检验条件 $\\mathcal{A}$（由系数 $\\beta_2$ 代表）和条件 $\\mathcal{B}$（由系数 $\\beta_3$ 代表）的效应是否存在差异。\n- **零假设 ($H_0$)**: 两种条件的效果没有差异，即 $\\beta_2 - \\beta_3 = 0$。\n- **备择假设 ($H_1$)**: 两种条件的效果存在差异，即 $\\beta_2 - \\beta_3 \\neq 0$。\n\n该假设可以用线性对比 $\\boldsymbol{c}^\\top \\boldsymbol{\\beta} = 0$ 的形式表示。相应的对比向量 $\\boldsymbol{c}$ 为：\n$$\n\\boldsymbol{c} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n\n$t$-统计量的通用公式为：\n$$\nt = \\frac{\\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}}{\\sqrt{\\hat{\\sigma}^2 \\boldsymbol{c}^\\top (\\boldsymbol{X}^\\top \\boldsymbol{X})^{-1} \\boldsymbol{c}}}\n$$\n该 $t$-统计量的自由度为 $\\nu = N - p$。\n\n我们逐步计算公式的各个组成部分：\n\n1.  **分子：对比效应大小** $\\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}$\n    $$\n    \\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} 0  1  -1  0 \\end{pmatrix} \\begin{pmatrix} 510.0 \\\\ 1.5 \\\\ 0.6 \\\\ 0.02 \\end{pmatrix} = (1)(1.5) - (1)(0.6) = 0.9\n    $$\n\n2.  **分母：对比的标准误** $\\mathrm{SE}(\\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}) = \\sqrt{\\hat{\\sigma}^2 \\boldsymbol{c}^\\top (\\boldsymbol{X}^\\top \\boldsymbol{X})^{-1} \\boldsymbol{c}}$\n    首先计算无偏残差方差估计量 $\\hat{\\sigma}^2$：\n    - 自由度 $\\nu = N - p = 240 - 4 = 236$。\n    - 残差平方和 $\\mathrm{RSS} = 432.0$。\n    $$\n    \\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{N-p} = \\frac{432.0}{236}\n    $$\n    接着计算对比的方差项 $\\boldsymbol{c}^\\top (\\boldsymbol{X}^\\top \\boldsymbol{X})^{-1} \\boldsymbol{c}$：\n    $$\n    \\boldsymbol{c}^\\top (\\boldsymbol{X}^\\top \\boldsymbol{X})^{-1} \\boldsymbol{c} = \\begin{pmatrix} 0  1  -1  0 \\end{pmatrix} \\begin{pmatrix}\n    0.002   0       0       0 \\\\\n    0       0.010   -0.004  0 \\\\\n    0       -0.004  0.012   0 \\\\\n    0       0       0       0.005\n    \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\\\ 0 \\end{pmatrix}\n    $$\n    这等价于 $(\\boldsymbol{X}^\\top \\boldsymbol{X})^{-1}$ 矩阵中与 $\\beta_2, \\beta_3$ 相关的项的组合：\n    $$ \\mathrm{Var}(\\hat{\\beta}_2 - \\hat{\\beta}_3) / \\sigma^2 = \\mathrm{Var}(\\hat{\\beta}_2)/\\sigma^2 + \\mathrm{Var}(\\hat{\\beta}_3)/\\sigma^2 - 2 \\mathrm{Cov}(\\hat{\\beta}_2, \\hat{\\beta}_3)/\\sigma^2 $$\n    $$ = 0.010 + 0.012 - 2(-0.004) = 0.022 + 0.008 = 0.030 $$\n    现在计算标准误：\n    $$\n    \\mathrm{SE}(\\boldsymbol{c}^\\top \\hat{\\boldsymbol{\\beta}}) = \\sqrt{\\left(\\frac{432.0}{236}\\right) \\times 0.030} = \\sqrt{\\frac{12.96}{236}} \\approx \\sqrt{0.05491525} \\approx 0.23434004\n    $$\n\n3.  **计算最终的 $t$-统计量**\n    $$\n    t = \\frac{0.9}{0.23434004} \\approx 3.8405026\n    $$\n\n将结果四舍五入到四位有效数字，得到 $3.841$。",
            "answer": "$$\n\\boxed{3.841}\n$$"
        },
        {
            "introduction": "标准的假设检验旨在寻找存在“差异”的证据。但是，如果你的科学假设是两种方法或条件在实际上是“相同”的，该怎么办？本练习将介绍双单侧检验（TOST）程序，当你关心的是相似性而非差异性时，这是一个必不可少的工具。我们将把这个方法应用于一个假设的脑电图（EEG）数据场景，以判断两种实验方案是否产生等效的结果。",
            "id": "4169101",
            "problem": "一个研究团队研究在两种视觉刺激方案（记为方案A和方案B）下，通过脑电图（EEG；electroencephalography）测量的早期视觉P1成分的振幅。由于伪影拒绝率不同，每种方案应用于不同且独立的队列，因此将样本视为方差不等的独立样本。振幅以微伏为单位进行测量，并被建模为来自均值和方差未知的近似正态总体。\n\n从经过质量控制的数据段中，获得了以下样本摘要：\n- 方案A：样本量 $n_{A} = 120$，样本均值 $\\bar{x}_{A} = 5.3$，样本标准差 $s_{A} = 2.8$。\n- 方案B：样本量 $n_{B} = 130$，样本均值 $\\bar{x}_{B} = 4.9$，样本标准差 $s_{B} = 3.2$。\n\n为了确定两种方案产生的平均P1振幅是否在科学上合理的边界 $\\Delta = 1.5$ 内等效，请在显著性水平 $\\alpha = 0.05$ 下，针对总体均值之差 $\\mu_{A} - \\mu_{B}$，在方差不等（Welch）框架下进行双单侧检验（TOST）等效性检验。\n\n使用以下假设结构：\n- 零假设（复合）：$H_{0}: \\mu_{A} - \\mu_{B} \\leq -\\Delta \\ \\text{or} \\ \\mu_{A} - \\mu_{B} \\geq \\Delta$。\n- 备择假设（等效性）：$H_{1}: -\\Delta  \\mu_{A} - \\mu_{B}  \\Delta$。\n\n定义等效性判定指数 $D$ 为\n$$\nD = \\begin{cases}\n1,  \\text{如果在TOST程序下，在水平} \\alpha \\text{上得出等效性结论}, \\\\\n0,  \\text{否则}.\n\\end{cases}\n$$\n\n根据给定的摘要，在 Welch t-检验推断的科学标准假设下，计算 $D$。将最终答案报告为单个数字 $D$。最终答案无需四舍五入。",
            "solution": "该问题要求执行双单侧检验（TOST）以判断两种方案的平均P1振幅是否等效。等效性检验通过检验两个单侧零假设来进行：\n1.  $H_{01}: \\mu_{A} - \\mu_{B} \\geq \\Delta$ (差异至少为 $\\Delta$)\n2.  $H_{02}: \\mu_{A} - \\mu_{B} \\leq -\\Delta$ (差异至少为 $-\\Delta$)\n\n只有当这两个零假设都被拒绝时，我们才能得出等效性结论（即 $D=1$）。由于样本方差不等，我们使用 Welch t-检验框架。\n\n**第 1 步：计算样本均值之差及其标准误**\n- 样本均值之差：$\\bar{x}_A - \\bar{x}_B = 5.3 - 4.9 = 0.4$。\n- 标准误 $SE_{(\\bar{x}_A - \\bar{x}_B)}$：\n$$ SE = \\sqrt{\\frac{s_A^2}{n_A} + \\frac{s_B^2}{n_B}} = \\sqrt{\\frac{2.8^2}{120} + \\frac{3.2^2}{130}} = \\sqrt{\\frac{7.84}{120} + \\frac{10.24}{130}} $$\n$$ SE \\approx \\sqrt{0.065333 + 0.078769} = \\sqrt{0.144102} \\approx 0.379608 $$\n\n**第 2 步：计算 Welch-Satterthwaite 自由度 $(\\nu)$**\n$$ \\nu = \\frac{\\left(\\frac{s_A^2}{n_A} + \\frac{s_B^2}{n_B}\\right)^2}{\\frac{(s_A^2/n_A)^2}{n_A - 1} + \\frac{(s_B^2/n_B)^2}{n_B - 1}} \\approx \\frac{(0.144102)^2}{\\frac{(0.065333)^2}{119} + \\frac{(0.078769)^2}{129}} $$\n$$ \\nu \\approx \\frac{0.020765}{3.587 \\times 10^{-5} + 4.810 \\times 10^{-5}} \\approx \\frac{0.020765}{8.397 \\times 10^{-5}} \\approx 247.3 $$\n我们使用向下取整的自由度 $\\nu = 247$。\n\n**第 3 步：确定临界值**\n对于显著性水平 $\\alpha = 0.05$ 的单侧检验和 $\\nu = 247$ 的自由度，临界值为 $t_{crit} = t_{0.05, 247}$。该值非常接近标准正态分位数 $z_{0.05} \\approx 1.645$。精确值为 $t_{0.05, 247} \\approx 1.651$。\n\n**第 4 步：进行两个单侧检验**\n- **检验 $H_{01}: \\mu_{A} - \\mu_{B} \\geq \\Delta$**\n  我们计算针对上边界 $\\Delta = 1.5$ 的 t-统计量：\n  $$ t_1 = \\frac{(\\bar{x}_A - \\bar{x}_B) - \\Delta}{SE} = \\frac{0.4 - 1.5}{0.379608} = \\frac{-1.1}{0.379608} \\approx -2.898 $$\n  检验规则是：如果 $t_1  -t_{crit}$，则拒绝 $H_{01}$。\n  因为 $-2.898  -1.651$，我们拒绝 $H_{01}$。\n\n- **检验 $H_{02}: \\mu_{A} - \\mu_{B} \\leq -\\Delta$**\n  我们计算针对下边界 $-\\Delta = -1.5$ 的 t-统计量：\n  $$ t_2 = \\frac{(\\bar{x}_A - \\bar{x}_B) - (-\\Delta)}{SE} = \\frac{0.4 - (-1.5)}{0.379608} = \\frac{1.9}{0.379608} \\approx 5.005 $$\n  检验规则是：如果 $t_2 > t_{crit}$，则拒绝 $H_{02}$。\n  因为 $5.005 > 1.651$，我们拒绝 $H_{02}$。\n\n**第 5 步：得出结论**\n由于两个单侧零假设（$H_{01}$ 和 $H_{02}$）均被拒绝，我们得出结论，均值之差在统计上与零等效，即它落在 $(-\\Delta, \\Delta)$ 区间内。\n因此，等效性判定指数 $D=1$。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}