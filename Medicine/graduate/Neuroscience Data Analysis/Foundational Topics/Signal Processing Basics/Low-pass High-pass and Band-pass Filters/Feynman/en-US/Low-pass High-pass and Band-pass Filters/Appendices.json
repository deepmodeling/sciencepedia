{
    "hands_on_practices": [
        {
            "introduction": "A central challenge in filter design is translating performance requirements, like passband flatness and stopband attenuation, into a concrete filter architecture. This practice explores this fundamental trade-off by calculating the minimum required order for a Butterworth low-pass filter. By working from first principles, you will see how specifications for transition sharpness directly determine the filter's complexity, a crucial skill for designing components like analog anti-aliasing front-ends. ",
            "id": "4176290",
            "problem": "A neuroengineering team is building an analog anti-aliasing low-pass front-end for extracellular recordings of local field potentials (LFPs). The passband is intended to preserve oscillations up to angular frequency $\\omega_p$ with at most an absolute amplitude deviation $\\delta_p$ relative to unit direct current (DC) gain, and the stopband must suppress power at and beyond angular frequency $\\omega_s$ by at least $A_s$ decibels. The filter family is constrained to the classical Butterworth class. Assume a standard continuous-time design and that the passband specification is enforced at $\\omega_p$ and the stopband specification at $\\omega_s$.\n\nYou are given the following specifications:\n- Passband edge: $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$.\n- Stopband edge: $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$.\n- Maximum passband deviation: $\\delta_p = 0.01$ (dimensionless, relative to unit DC gain).\n- Minimum stopband attenuation: $A_s = 60\\,\\mathrm{dB}$.\n\nStarting from the fundamental magnitude response property of Butterworth low-pass filters and the definitions of amplitude tolerance and decibel attenuation, determine the minimum integer filter order $N$ that guarantees both the passband and stopband specifications are simultaneously satisfied.\n\nReport the final answer as a single integer with no units. No rounding instruction is needed beyond selecting the minimal integer $N$ that meets the specifications.",
            "solution": "The problem requires finding the minimum integer order $N$ for a Butterworth low-pass filter that satisfies specific passband and stopband criteria. We begin with the squared magnitude response of an $N$-th order Butterworth low-pass filter with a unit direct current (DC) gain, which is given by:\n$$|H(j\\omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2N}}$$\nHere, $\\omega$ is the angular frequency, $N$ is the filter order, and $\\omega_c$ is the cutoff frequency, defined as the frequency at which the magnitude is attenuated by $3\\,\\mathrm{dB}$.\n\nFirst, we formalize the passband specification. The problem states that in the passband, up to the angular frequency $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$, the magnitude response must have at most an absolute deviation of $\\delta_p = 0.01$ relative to the unit DC gain. This is enforced at the passband edge $\\omega_p$, meaning the magnitude $|H(j\\omega_p)|$ must be at least $1 - \\delta_p$.\n$$|H(j\\omega_p)| \\ge 1 - \\delta_p$$\nTo simplify the algebra, we work with the squared magnitude:\n$$|H(j\\omega_p)|^2 \\ge (1 - \\delta_p)^2$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}} \\ge (1 - \\delta_p)^2$$\nWe can rearrange this inequality to establish a constraint on the cutoff frequency $\\omega_c$:\n$$1 \\ge (1 - \\delta_p)^2 \\left(1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}\\right)$$\n$$\\frac{1}{(1 - \\delta_p)^2} \\ge 1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N} \\le \\frac{1}{(1 - \\delta_p)^2} - 1$$\nThis inequality provides a lower bound for $\\omega_c^{2N}$:\n$$\\omega_c^{2N} \\ge \\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\n\nNext, we formalize the stopband specification. The attenuation in decibels, $A(\\omega)$, is defined as $A(\\omega) = -20 \\log_{10}(|H(j\\omega)|)$. The problem requires a minimum attenuation of $A_s = 60\\,\\mathrm{dB}$ at and beyond the stopband edge $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$. Enforcing this at $\\omega_s$:\n$$A(\\omega_s) \\ge A_s$$\n$$-20 \\log_{10}(|H(j\\omega_s)|) \\ge A_s$$\n$$\\log_{10}(|H(j\\omega_s)|) \\le -\\frac{A_s}{20}$$\n$$|H(j\\omega_s)| \\le 10^{-A_s/20}$$\nWorking with the squared magnitude:\n$$|H(j\\omega_s)|^2 \\le 10^{-A_s/10}$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}} \\le 10^{-A_s/10}$$\nRearranging this inequality gives an upper bound on $\\omega_c^{2N}$:\n$$1 \\le 10^{-A_s/10} \\left(1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}\\right)$$\n$$10^{A_s/10} \\le 1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N} \\ge 10^{A_s/10} - 1$$\n$$\\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\n\nWe now have both a lower and an upper bound for the term $\\omega_c^{2N}$. For a valid filter to exist, the lower bound must be less than or equal to the upper bound:\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\nFrom this, we can form a single inequality that relates the filter order $N$ to the given specifications, eliminating the unknown cutoff frequency $\\omega_c$:\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\nTo solve for $N$, we rearrange the terms:\n$$\\left(\\frac{\\omega_s}{\\omega_p}\\right)^{2N} \\ge \\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\nTaking the natural logarithm of both sides (the inequality direction is preserved since $\\omega_s/\\omega_p > 1$):\n$$2N \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right) \\ge \\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)$$\nFinally, we solve for the minimum order $N$:\n$$N \\ge \\frac{\\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)}{2 \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right)}$$\nNow, we substitute the provided values into this expression: $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$, $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$, $\\delta_p = 0.01$, and $A_s = 60\\,\\mathrm{dB}$.\n\nThe ratio of the edge frequencies is:\n$$\\frac{\\omega_s}{\\omega_p} = \\frac{2\\pi \\times 1000}{2\\pi \\times 200} = 5$$\nThe stopband term in the numerator of the logarithm's argument is:\n$$10^{A_s/10} - 1 = 10^{60/10} - 1 = 10^6 - 1 = 999999$$\nThe passband term in the denominator of the logarithm's argument is:\n$$\\frac{1}{(1 - \\delta_p)^2} - 1 = \\frac{1}{(1 - 0.01)^2} - 1 = \\frac{1}{0.99^2} - 1 = \\frac{1}{0.9801} - 1 = \\frac{1 - 0.9801}{0.9801} = \\frac{0.0199}{0.9801}$$\nSubstituting these into the inequality for $N$:\n$$N \\ge \\frac{\\ln\\left(\\frac{999999}{0.0199/0.9801}\\right)}{2 \\ln(5)} = \\frac{\\ln\\left(\\frac{999999 \\times 0.9801}{0.0199}\\right)}{2 \\ln(5)}$$\nWe calculate the argument of the logarithm:\n$$\\frac{999999 \\times 0.9801}{0.0199} \\approx \\frac{980099.0199}{0.0199} \\approx 49251207.03$$\nNow, we compute the value for $N$:\n$$N \\ge \\frac{\\ln(49251207.03)}{2 \\ln(5)} \\approx \\frac{17.7126}{2 \\times 1.6094} \\approx \\frac{17.7126}{3.2188} \\approx 5.5028$$\nSince the filter order $N$ must be an integer, we must choose the smallest integer that satisfies this condition. This is found by taking the ceiling of the calculated value:\n$$N = \\lceil 5.5028 \\rceil = 6$$\nTherefore, the minimum integer filter order required to meet both specifications simultaneously is $6$.",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "Designing every filter type—low-pass, high-pass, band-pass—from scratch would be inefficient. Instead, engineers use powerful frequency transformations to convert a single, well-understood low-pass prototype into any other desired type. This hands-on exercise guides you through the derivation and application of the classic low-pass to band-pass transformation, providing a deep understanding of how to create filters that isolate specific frequency bands, such as the alpha rhythm in neural signals. ",
            "id": "4176388",
            "problem": "A neuroscientist is designing an analog band-pass filter to isolate alpha-band oscillations around a center frequency of $10\\ \\mathrm{Hz}$ in local field potential recordings. The desired bandwidth is $5\\ \\mathrm{Hz}$. Starting from the normalized second-order Butterworth low-pass prototype with transfer function $H_{p}(s) = \\frac{1}{s^{2} + \\sqrt{2}\\,s + 1}$, derive the corresponding band-pass filter $H_{bp}(s)$ by constructing the appropriate frequency transformation from first principles.\n\nUse the following foundational bases:\n- The frequency response of a continuous-time linear time-invariant filter is obtained by evaluating its transfer function on the imaginary axis, $H(j\\omega)$, where $\\omega$ is the radian frequency.\n- A band-pass mapping from low-pass to band-pass must send the center frequency to direct current, i.e., the normalized low-pass frequency variable $\\Omega$ satisfies $\\Omega(\\omega_{0}) = 0$.\n- The mapping must produce a real normalized low-pass frequency variable $\\Omega$ on the imaginary axis, so that $s_{lp}(j\\omega) = j\\,\\Omega(\\omega)$ with $\\Omega(\\omega) \\in \\mathbb{R}$.\n- The local bandwidth scaling near the center frequency should be controlled by the parameter $B$ via the slope condition $\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{2}{B}$.\n\nTasks:\n1. Assume a rational mapping of the form $s_{lp}(s) = \\frac{a s^{2} + b}{c s}$ with real constants $a$, $b$, and $c$. Impose the three conditions above to determine $a$, $b$, and $c$ in terms of the center radian frequency $\\omega_{0}$ and bandwidth $B$.\n2. Using your result for $s_{lp}(s)$, write the band-pass transfer function $H_{bp}(s)$ obtained by substituting $s \\mapsto s_{lp}(s)$ into $H_{p}(s)$.\n3. By evaluating $s = j\\omega$, derive the explicit normalized low-pass frequency variable $\\Omega(\\omega)$ and prove the symmetry property $\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\,\\Omega(\\omega)$. Conclude from this that the magnitude response $|H_{bp}(j\\omega)|$ is symmetric on a logarithmic frequency scale around $\\omega_{0}$.\n4. For the specific design with $\\omega_{0} = 2\\pi \\times 10\\ \\mathrm{rad/s}$ and $B = 2\\pi \\times 5\\ \\mathrm{rad/s}$, compute the lower and upper $-3\\ \\mathrm{dB}$ band edges in Hertz by solving $|\\Omega(\\omega)| = 1$ in $\\omega$, and then converting to frequency $f = \\frac{\\omega}{2\\pi}$. Express the final edge frequencies in $\\mathrm{Hz}$ and round each to four significant figures.\n\nYour final answer must be the pair of edge frequencies as a single two-entry row matrix.",
            "solution": "The problem asks for the derivation and application of a low-pass to band-pass frequency transformation for designing an analog filter. The problem is well-posed, scientifically grounded, and provides sufficient information for a complete solution. We will address each of the four tasks sequentially.\n\n### Task 1: Derivation of the Frequency Transformation\n\nWe are asked to determine the real constants $a$, $b$, and $c$ in the rational mapping $s_{lp}(s) = \\frac{a s^{2} + b}{c s}$ by imposing three foundational conditions.\n\n**Condition 1: Reality of the normalized frequency**\nThe mapping must produce a real normalized low-pass frequency variable $\\Omega$ on the imaginary axis, such that $s_{lp}(j\\omega) = j\\,\\Omega(\\omega)$ with $\\Omega(\\omega) \\in \\mathbb{R}$. We substitute $s = j\\omega$ into the expression for $s_{lp}(s)$:\n$$\ns_{lp}(j\\omega) = \\frac{a (j\\omega)^{2} + b}{c (j\\omega)} = \\frac{-a\\omega^{2} + b}{jc\\omega} = -j\\frac{-a\\omega^{2} + b}{c\\omega} = j\\frac{a\\omega^{2} - b}{c\\omega}\n$$\nBy comparing this to the required form $s_{lp}(j\\omega) = j\\Omega(\\omega)$, we identify the normalized low-pass frequency variable as:\n$$\n\\Omega(\\omega) = \\frac{a\\omega^{2} - b}{c\\omega}\n$$\nSince $a$, $b$, $c$ are specified as real constants, $\\Omega(\\omega)$ is a real-valued function for any real $\\omega$, satisfying the condition.\n\n**Condition 2: Mapping of the center frequency**\nThe mapping must send the center frequency $\\omega_{0}$ to direct current (DC) in the low-pass domain, which corresponds to a normalized frequency of $0$. Mathematically, $\\Omega(\\omega_{0}) = 0$.\n$$\n\\Omega(\\omega_{0}) = \\frac{a\\omega_{0}^{2} - b}{c\\omega_{0}} = 0\n$$\nAssuming a non-trivial filter design where $c \\neq 0$ and $\\omega_{0} > 0$, this implies the numerator must be zero:\n$$\na\\omega_{0}^{2} - b = 0 \\implies b = a\\omega_{0}^{2}\n$$\n\n**Condition 3: Bandwidth scaling**\nThe local bandwidth scaling near the center frequency is specified by the slope condition $\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{2}{B}$.\nFirst, we find the derivative of $\\Omega(\\omega)$ with respect to $\\omega$. It is easier to differentiate the form $\\Omega(\\omega) = \\frac{a}{c}\\omega - \\frac{b}{c\\omega}$:\n$$\n\\frac{d\\Omega}{d\\omega} = \\frac{a}{c} - \\frac{b}{c}(-\\omega^{-2}) = \\frac{a}{c} + \\frac{b}{c\\omega^{2}}\n$$\nNext, we evaluate this derivative at $\\omega = \\omega_{0}$:\n$$\n\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{a}{c} + \\frac{b}{c\\omega_{0}^{2}}\n$$\nSubstituting the result from Condition $2$, $b = a\\omega_{0}^{2}$:\n$$\n\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{a}{c} + \\frac{a\\omega_{0}^{2}}{c\\omega_{0}^{2}} = \\frac{a}{c} + \\frac{a}{c} = \\frac{2a}{c}\n$$\nEquating this with the given condition:\n$$\n\\frac{2a}{c} = \\frac{2}{B} \\implies \\frac{a}{c} = \\frac{1}{B}\n$$\nThe ratio of $a$ to $c$ is determined. We have the freedom to choose a scaling factor. The simplest choice is to set $a=1$. This implies $c=B$. With $a=1$, the expression for $b$ becomes $b = 1 \\cdot \\omega_{0}^{2} = \\omega_{0}^{2}$.\n\nThus, the parameters are $a=1$, $b=\\omega_{0}^{2}$, and $c=B$. The required frequency transformation is:\n$$\ns_{lp}(s) = \\frac{s^{2} + \\omega_{0}^{2}}{Bs}\n$$\n\n### Task 2: The Band-Pass Transfer Function\n\nThe band-pass filter's transfer function, $H_{bp}(s)$, is obtained by applying the substitution $s \\mapsto s_{lp}(s)$ to the normalized low-pass prototype transfer function $H_{p}(s) = \\frac{1}{s^{2} + \\sqrt{2}\\,s + 1}$.\n$$\nH_{bp}(s) = H_p(s_{lp}(s)) = H_p\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right)\n$$\nSubstituting into the expression for $H_p(s)$:\n$$\nH_{bp}(s) = \\frac{1}{\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right)^{2} + \\sqrt{2}\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right) + 1}\n$$\nTo simplify this expression, we multiply the numerator and the denominator by the common denominator $(Bs)^{2} = B^{2}s^{2}$:\n$$\nH_{bp}(s) = \\frac{B^{2}s^{2}}{(s^{2} + \\omega_{0}^{2})^{2} + \\sqrt{2}\\,(Bs)(s^{2} + \\omega_{0}^{2}) + B^{2}s^{2}}\n$$\nThis is the transfer function of the resulting 4th-order band-pass filter.\n\n### Task 3: Symmetry Properties\n\nFirst, we write the explicit expression for $\\Omega(\\omega)$ using the determined parameters $a=1$, $b=\\omega_{0}^{2}$, and $c=B$:\n$$\n\\Omega(\\omega) = \\frac{1 \\cdot \\omega^{2} - \\omega_{0}^{2}}{B\\omega} = \\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right)\n$$\nNow, we prove the symmetry property $\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\,\\Omega(\\omega)$. We substitute $\\frac{\\omega_{0}^{2}}{\\omega}$ for $\\omega$ in the expression for $\\Omega(\\omega)$:\n$$\n\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = \\frac{1}{B}\\left(\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) - \\frac{\\omega_{0}^{2}}{\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right)}\\right) = \\frac{1}{B}\\left(\\frac{\\omega_{0}^{2}}{\\omega} - \\omega\\right) = -\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\Omega(\\omega)\n$$\nThe property is proven.\n\nThe frequency response of the band-pass filter is $H_{bp}(j\\omega) = H_p(j\\Omega(\\omega))$. The magnitude response is $|H_{bp}(j\\omega)| = |H_p(j\\Omega(\\omega))|$. For a filter with a real-valued impulse response, the magnitude of its frequency response is an even function, i.e., $|H_p(j\\Omega)| = |H_p(-j\\Omega)|$. Using this and the symmetry property of $\\Omega(\\omega)$:\n$$\n\\left|H_{bp}\\left(j\\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right| = \\left|H_p\\left(j\\Omega\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right)\\right| = |H_p(j(-\\Omega(\\omega)))| = |H_p(j\\Omega(\\omega))| = |H_{bp}(j\\omega)|\n$$\nThis shows that the magnitude response is identical at frequencies $\\omega$ and $\\frac{\\omega_{0}^{2}}{\\omega}$. These two frequencies are equidistant from $\\omega_{0}$ on a logarithmic scale because $\\log(\\omega) - \\log(\\omega_{0}) = \\log(\\omega/\\omega_{0})$ and $\\log(\\frac{\\omega_{0}^{2}}{\\omega}) - \\log(\\omega_{0}) = \\log(\\omega_{0}/\\omega) = -\\log(\\omega/\\omega_{0})$. Therefore, the magnitude response $|H_{bp}(j\\omega)|$ is symmetric on a logarithmic frequency scale around the center frequency $\\omega_{0}$.\n\n### Task 4: Calculation of Band-Edge Frequencies\n\nThe $-3\\ \\mathrm{dB}$ cutoff frequencies of the band-pass filter correspond to the frequencies at which the magnitude response drops to $1/\\sqrt{2}$ of its peak value. For a Butterworth prototype, this occurs at a normalized frequency $|\\Omega|=1$. We need to solve $|\\Omega(\\omega)| = 1$ for $\\omega$.\n\nThe given design parameters are $f_{0} = 10\\ \\mathrm{Hz}$ and a bandwidth of $5\\ \\mathrm{Hz}$. The corresponding radian frequencies are:\n$\\omega_{0} = 2\\pi f_{0} = 2\\pi(10) = 20\\pi\\ \\mathrm{rad/s}$.\n$B = 2\\pi (5) = 10\\pi\\ \\mathrm{rad/s}$.\n\nThe equation $|\\Omega(\\omega)| = 1$ becomes:\n$$\n\\left|\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right| = 1\n$$\nThis splits into two separate equations:\n1. $\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = 1 \\implies \\omega^{2} - B\\omega - \\omega_{0}^{2} = 0$\n2. $\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = -1 \\implies \\omega^{2} + B\\omega - \\omega_{0}^{2} = 0$\n\nWe solve these quadratic equations for $\\omega > 0$.\nFor the first equation, the positive root gives the upper cutoff frequency, $\\omega_{2}$:\n$$\n\\omega_{2} = \\frac{B + \\sqrt{B^{2} - 4(1)(-\\omega_{0}^{2})}}{2} = \\frac{B + \\sqrt{B^{2} + 4\\omega_{0}^{2}}}{2}\n$$\nFor the second equation, the positive root gives the lower cutoff frequency, $\\omega_{1}$:\n$$\n\\omega_{1} = \\frac{-B + \\sqrt{B^{2} - 4(1)(-\\omega_{0}^{2})}}{2} = \\frac{-B + \\sqrt{B^{2} + 4\\omega_{0}^{2}}}{2}\n$$\nNow, we substitute the numerical values for $\\omega_0$ and $B$:\n$$\n\\sqrt{B^{2} + 4\\omega_{0}^{2}} = \\sqrt{(10\\pi)^{2} + 4(20\\pi)^{2}} = \\sqrt{100\\pi^{2} + 1600\\pi^{2}} = \\sqrt{1700\\pi^{2}} = 10\\pi\\sqrt{17}\n$$\nSubstituting this into the expressions for $\\omega_{1}$ and $\\omega_{2}$:\n$$\n\\omega_{1} = \\frac{-10\\pi + 10\\pi\\sqrt{17}}{2} = 5\\pi(\\sqrt{17}-1)\\ \\mathrm{rad/s}\n$$\n$$\n\\omega_{2} = \\frac{10\\pi + 10\\pi\\sqrt{17}}{2} = 5\\pi(\\sqrt{17}+1)\\ \\mathrm{rad/s}\n$$\nFinally, we convert these radian frequencies to frequencies in Hertz ($f = \\omega/2\\pi$) and round to four significant figures.\nLower edge frequency, $f_{1}$:\n$$\nf_{1} = \\frac{\\omega_{1}}{2\\pi} = \\frac{5\\pi(\\sqrt{17}-1)}{2\\pi} = \\frac{5}{2}(\\sqrt{17}-1) \\approx 2.5(4.1231056 - 1) = 7.807764\\ \\mathrm{Hz}\n$$\nRounding to four significant figures, $f_{1} \\approx 7.808\\ \\mathrm{Hz}$.\n\nUpper edge frequency, $f_{2}$:\n$$\nf_{2} = \\frac{\\omega_{2}}{2\\pi} = \\frac{5\\pi(\\sqrt{17}+1)}{2\\pi} = \\frac{5}{2}(\\sqrt{17}+1) \\approx 2.5(4.1231056 + 1) = 12.807764\\ \\mathrm{Hz}\n$$\nRounding to four significant figures, $f_{2} \\approx 12.81\\ \\mathrm{Hz}$.\n\nThe lower and upper $-3\\ \\mathrm{dB}$ band edges are approximately $7.808\\ \\mathrm{Hz}$ and $12.81\\ \\mathrm{Hz}$, respectively.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.808 & 12.81\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from the analog to the digital domain, designing Finite Impulse Response (FIR) filters presents its own set of practical challenges and powerful methods. The Kaiser window technique is a widely-used approach that offers excellent control over the trade-off between transition bandwidth and stopband attenuation. In this practice, you will apply a well-established empirical formula to determine the minimum filter order needed to satisfy stringent design specifications, a common and essential task in building digital signal processing pipelines for neuroscience data. ",
            "id": "4176438",
            "problem": "A neuroscience laboratory is preparing to low-pass filter local field potential recordings sampled at $f_{s} = 1000\\ \\mathrm{Hz}$ in order to isolate slow dynamics. They will implement a linear-phase finite impulse response (FIR) filter, designed by windowing an ideal low-pass impulse response with a Kaiser window. The passband should be essentially flat up to $40\\ \\mathrm{Hz}$, with a monotone transition band from $40\\ \\mathrm{Hz}$ to $60\\ \\mathrm{Hz}$, and the magnitude in the stopband (from $60\\ \\mathrm{Hz}$ up to the Nyquist frequency) must be attenuated by at least $A_{s} = 70\\ \\mathrm{dB}$.\n\nStarting from the standard definitions of discrete-time frequency normalization (mapping physical frequency in $\\mathrm{Hz}$ to discrete-time angular frequency in radians per sample) and the well-tested Kaiser window order approximation that relates the minimum filter order to the required stopband attenuation and transition width in normalized angular frequency, determine the minimum FIR filter order $N$ that guarantees the stated stopband attenuation given the specified transition width. Assume that the stopband attenuation requirement dominates the design (that is, it sets the design parameter in the Kaiser approximation).\n\nReport the minimum integer filter order $N$ that satisfies the specification. Do not provide any intermediate quantities. The answer is unitless and should be given as an integer.",
            "solution": "The task is to determine the minimum order $N$ for a linear-phase FIR filter that meets the given specifications. The design is based on the windowing method using a Kaiser window. The required parameters for the design are the sampling frequency $f_s$, the passband edge frequency $f_p$, the stopband edge frequency $f_{st}$, and the minimum stopband attenuation $A_s$.\n\nThe given values are:\n-   Sampling frequency: $f_s = 1000\\ \\mathrm{Hz}$\n-   Passband edge frequency: $f_p = 40\\ \\mathrm{Hz}$\n-   Stopband edge frequency: $f_{st} = 60\\ \\mathrm{Hz}$\n-   Minimum stopband attenuation: $A_s = 70\\ \\mathrm{dB}$\n\nThe design formulas for window-based FIR filters typically operate on normalized angular frequencies. The physical frequency $f$ in $\\mathrm{Hz}$ is normalized to an angular frequency $\\omega$ in radians per sample. The normalization maps the frequency range from $0$ to the Nyquist frequency ($f_s/2$) to the angular frequency range from $0$ to $\\pi$. The conversion formula is:\n$$ \\omega = 2\\pi \\frac{f}{f_s} $$\n\nWe first convert the passband and stopband edge frequencies to their normalized angular frequency equivalents, $\\omega_p$ and $\\omega_{st}$:\n$$ \\omega_p = 2\\pi \\frac{f_p}{f_s} = 2\\pi \\frac{40}{1000} = 0.08\\pi \\ \\text{radians/sample} $$\n$$ \\omega_{st} = 2\\pi \\frac{f_{st}}{f_s} = 2\\pi \\frac{60}{1000} = 0.12\\pi \\ \\text{radians/sample} $$\n\nThe transition width of the filter, $\\Delta\\omega$, is the difference between the stopband and passband angular frequencies:\n$$ \\Delta\\omega = \\omega_{st} - \\omega_p = 0.12\\pi - 0.08\\pi = 0.04\\pi \\ \\text{radians/sample} $$\n\nThe problem directs us to use the well-tested Kaiser window order approximation. A standard empirical formula developed by James Kaiser relates the minimum filter order $N$, the stopband attenuation $A_s$ (in dB), and the normalized transition width $\\Delta\\omega$:\n$$ N \\ge \\frac{A_s - 8}{2.285 \\Delta\\omega} $$\nThis formula provides an estimate for the minimum filter order $N$ required to achieve the specified attenuation with the given transition width. The problem states that the attenuation requirement dominates the design, which justifies the direct use of this formula.\n\nWe substitute the given values into this inequality:\n-   $A_s = 70$\n-   $\\Delta\\omega = 0.04\\pi$\n\n$$ N \\ge \\frac{70 - 8}{2.285 (0.04\\pi)} $$\n$$ N \\ge \\frac{62}{0.0914\\pi} $$\n\nNow, we compute the numerical value for the right-hand side:\n$$ N \\ge \\frac{62}{0.0914 \\times 3.14159...} \\approx \\frac{62}{0.28714...} $$\n$$ N \\ge 215.899... $$\n\nSince the filter order $N$ must be an integer, we must take the ceiling of this value to ensure the filter specifications are met or exceeded.\n$$ N = \\lceil 215.899... \\rceil = 216 $$\nTherefore, the minimum integer filter order that guarantees the stopband attenuation of at least $70\\ \\mathrm{dB}$ with the specified transition width is $216$. This corresponds to a filter with an impulse response of length $L = N+1 = 217$.",
            "answer": "$$\\boxed{216}$$"
        }
    ]
}