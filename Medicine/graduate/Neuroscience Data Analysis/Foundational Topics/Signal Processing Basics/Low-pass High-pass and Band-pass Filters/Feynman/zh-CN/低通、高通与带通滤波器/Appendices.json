{
    "hands_on_practices": [
        {
            "introduction": "实践中滤波器设计的第一步是将性能目标转化为具体的硬件或软件参数。本练习将通过从基本规格——即需要通过多少信号、阻止多少信号——出发，推导出巴特沃斯低通滤波器所需的最小复杂度，从而揭开这一过程的神秘面纱。掌握这项计算 () 为在滤波器性能和计算成本之间做出明智的权衡提供了基础。",
            "id": "4176290",
            "problem": "一个神经工程团队正在为局部场电位 (LFP; local field potential) 的细胞外记录构建一个模拟抗混叠低通前端。该通带旨在保留角频率高达 $\\omega_p$ 的振荡，相对于单位直流 (DC) 增益，其绝对幅值偏差最多为 $\\delta_p$，而阻带必须将角频率在 $\\omega_s$ 及以上区域的功率抑制至少 $A_s$ 分贝。滤波器系列被限制为经典的巴特沃斯类型。假设采用标准的连续时间设计，并且通带规范在 $\\omega_p$ 处强制执行，阻带规范在 $\\omega_s$ 处强制执行。\n\n给定以下技术规格：\n- 通带边缘：$\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$。\n- 阻带边缘：$\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$。\n- 最大通带偏差：$\\delta_p = 0.01$ (无量纲，相对于单位直流增益)。\n- 最小阻带衰减：$A_s = 60\\,\\mathrm{dB}$。\n\n从巴特沃斯低通滤波器的基本幅度响应特性以及幅值容差和分贝衰减的定义出发，确定能够同时满足通带和阻带规范的最小整数滤波器阶数 $N$。\n\n将最终答案报告为一个没有单位的整数。除了选择满足规范的最小整数 $N$ 外，不需要其他舍入指令。",
            "solution": "该问题要求找到一个巴特沃斯低通滤波器的最小整数阶数 $N$，使其满足特定的通带和阻带标准。我们从具有单位直流 (DC) 增益的 $N$ 阶巴特沃斯低通滤波器的幅度平方响应开始，其表达式为：\n$$|H(j\\omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2N}}$$\n此处，$\\omega$ 是角频率，$N$ 是滤波器阶数，$\\omega_c$ 是截止频率，定义为幅度衰减 $3\\,\\mathrm{dB}$ 时的频率。\n\n首先，我们将通带规范公式化。问题指出，在通带内，直到角频率 $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$，幅度响应相对于单位直流增益的绝对偏差最多为 $\\delta_p = 0.01$。该规范在通带边缘 $\\omega_p$ 处强制执行，意味着幅度 $|H(j\\omega_p)|$ 必须至少为 $1 - \\delta_p$。\n$$|H(j\\omega_p)| \\ge 1 - \\delta_p$$\n为简化代数运算，我们使用幅度平方：\n$$|H(j\\omega_p)|^2 \\ge (1 - \\delta_p)^2$$\n代入巴特沃斯响应公式：\n$$\\frac{1}{1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}} \\ge (1 - \\delta_p)^2$$\n我们可以重新整理这个不等式，以建立对截止频率 $\\omega_c$ 的约束：\n$$1 \\ge (1 - \\delta_p)^2 \\left(1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}\\right)$$\n$$\\frac{1}{(1 - \\delta_p)^2} \\ge 1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N} \\le \\frac{1}{(1 - \\delta_p)^2} - 1$$\n这个不等式为 $\\omega_c^{2N}$ 提供了一个下界：\n$$\\omega_c^{2N} \\ge \\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\n\n接下来，我们将阻带规范公式化。以分贝为单位的衰减 $A(\\omega)$ 定义为 $A(\\omega) = -20 \\log_{10}(|H(j\\omega)|)$。问题要求在阻带边缘 $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$ 及以上频率处，最小衰减为 $A_s = 60\\,\\mathrm{dB}$。在 $\\omega_s$ 处强制执行此规范：\n$$A(\\omega_s) \\ge A_s$$\n$$-20 \\log_{10}(|H(j\\omega_s)|) \\ge A_s$$\n$$\\log_{10}(|H(j\\omega_s)|) \\le -\\frac{A_s}{20}$$\n$$|H(j\\omega_s)| \\le 10^{-A_s/20}$$\n使用幅度平方进行计算：\n$$|H(j\\omega_s)|^2 \\le 10^{-A_s/10}$$\n代入巴特沃斯响应公式：\n$$\\frac{1}{1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}} \\le 10^{-A_s/10}$$\n重新整理这个不等式，得到 $\\omega_c^{2N}$ 的一个上界：\n$$1 \\le 10^{-A_s/10} \\left(1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}\\right)$$\n$$10^{A_s/10} \\le 1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N} \\ge 10^{A_s/10} - 1$$\n$$\\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\n\n现在我们得到了项 $\\omega_c^{2N}$ 的下界和上界。为了使有效的滤波器存在，下界必须小于或等于上界：\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\n由此，我们可以形成一个单一的不等式，将滤波器阶数 $N$ 与给定的规范联系起来，从而消去未知的截止频率 $\\omega_c$：\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\n为了求解 $N$，我们重新整理这些项：\n$$\\left(\\frac{\\omega_s}{\\omega_p}\\right)^{2N} \\ge \\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\n对两边取自然对数（由于 $\\omega_s/\\omega_p > 1$，不等式方向保持不变）：\n$$2N \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right) \\ge \\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)$$\n最后，我们求解最小阶数 $N$：\n$$N \\ge \\frac{\\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)}{2 \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right)}$$\n现在，我们将给定的值代入此表达式：$\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$，$\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$，$\\delta_p = 0.01$ 以及 $A_s = 60\\,\\mathrm{dB}$。\n\n边缘频率之比为：\n$$\\frac{\\omega_s}{\\omega_p} = \\frac{2\\pi \\times 1000}{2\\pi \\times 200} = 5$$\n对数参数中分子部分的阻带项为：\n$$10^{A_s/10} - 1 = 10^{60/10} - 1 = 10^6 - 1 = 999999$$\n对数参数中分母部分的通带项为：\n$$\\frac{1}{(1 - \\delta_p)^2} - 1 = \\frac{1}{(1 - 0.01)^2} - 1 = \\frac{1}{0.99^2} - 1 = \\frac{1}{0.9801} - 1 = \\frac{1 - 0.9801}{0.9801} = \\frac{0.0199}{0.9801}$$\n将这些代入关于 $N$ 的不等式中：\n$$N \\ge \\frac{\\ln\\left(\\frac{999999}{0.0199/0.9801}\\right)}{2 \\ln(5)} = \\frac{\\ln\\left(\\frac{999999 \\times 0.9801}{0.0199}\\right)}{2 \\ln(5)}$$\n我们计算对数的参数：\n$$\\frac{999999 \\times 0.9801}{0.0199} \\approx \\frac{980099.0199}{0.0199} \\approx 49251207.03$$\n现在，我们计算 $N$ 的值：\n$$N \\ge \\frac{\\ln(49251207.03)}{2 \\ln(5)} \\approx \\frac{17.7126}{2 \\times 1.6094} \\approx \\frac{17.7126}{3.2188} \\approx 5.5028$$\n由于滤波器阶数 $N$ 必须是整数，我们必须选择满足此条件的最小整数。这可以通过对计算值取上整得到：\n$$N = \\lceil 5.5028 \\rceil = 6$$\n因此，同时满足两种规范所需的最小整数滤波器阶数为 $6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "工程师们通常不需从头设计每一种类型的滤波器，而是使用一种称为频率变换的强大技术，将一个简单的低通“原型”转换为高通、带通或带阻滤波器。本练习 () 将引导你从第一性原理出发，推导低通到带通的变换，这是模拟和IIR滤波器设计的基石。通过运用此方法，你将学会如何精确地针对一个特定的神经频率带，例如alpha节律。",
            "id": "4176388",
            "problem": "一位神经科学家正在设计一个模拟带通滤波器，用于从局部场电位记录中分离出中心频率约为 $10\\ \\mathrm{Hz}$ 的α波段振荡。所需带宽为 $5\\ \\mathrm{Hz}$。从传递函数为 $H_{p}(s) = \\frac{1}{s^{2} + \\sqrt{2}\\,s + 1}$ 的归一化二阶巴特沃斯低通原型出发，通过从第一性原理构建适当的频率变换，推导出相应的带通滤波器 $H_{bp}(s)$。\n\n使用以下基本依据：\n- 连续时间线性时不变滤波器的频率响应是通过在其传递函数上对虚轴进行求值得到的，即 $H(j\\omega)$，其中 $\\omega$ 是角频率。\n- 从低通到带通的映射必须将中心频率映射到直流，即归一化低通频率变量 $\\Omega$ 满足 $\\Omega(\\omega_{0}) = 0$。\n- 该映射必须在虚轴上产生一个实的归一化低通频率变量 $\\Omega$，使得 $s_{lp}(j\\omega) = j\\,\\Omega(\\omega)$，其中 $\\Omega(\\omega) \\in \\mathbb{R}$。\n- 中心频率附近的局部带宽定标应由参数 $B$ 通过斜率条件 $\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{2}{B}$ 来控制。\n\n任务：\n1. 假设一个形式为 $s_{lp}(s) = \\frac{a s^{2} + b}{c s}$ 的有理映射，其中 $a$、$b$ 和 $c$ 为实常数。施加上述三个条件，以中心角频率 $\\omega_{0}$ 和带宽 $B$ 来确定 $a$、$b$ 和 $c$。\n2. 使用你对 $s_{lp}(s)$ 的结果，通过将 $s \\mapsto s_{lp}(s)$ 代入 $H_{p}(s)$，写出所得到的带通传递函数 $H_{bp}(s)$。\n3. 通过对 $s = j\\omega$ 求值，推导出显式的归一化低通频率变量 $\\Omega(\\omega)$，并证明对称性质 $\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\,\\Omega(\\omega)$。由此得出结论，幅频响应 $|H_{bp}(j\\omega)|$ 在以 $\\omega_{0}$ 为中心的对数频率标度上是对称的。\n4. 对于 $\\omega_{0} = 2\\pi \\times 10\\ \\mathrm{rad/s}$ 和 $B = 2\\pi \\times 5\\ \\mathrm{rad/s}$ 的具体设计，通过求解 $\\omega$ 的方程 $|\\Omega(\\omega)| = 1$ 来计算下和上 $-3\\ \\mathrm{dB}$ 带边，然后转换为频率 $f = \\frac{\\omega}{2\\pi}$。将最终的带边频率以 $\\mathrm{Hz}$ 表示，并各自四舍五入至四位有效数字。\n\n你的最终答案必须是表示为单个二元行矩阵的一对带边频率。",
            "solution": "该问题要求推导和应用一个低通到带通的频率变换来设计一个模拟滤波器。问题陈述清晰，科学依据扎实，并为得出完整解提供了充分信息。我们将依次处理这四个任务。\n\n### 任务1：频率变换的推导\n\n我们被要求通过施加三个基本条件来确定有理映射 $s_{lp}(s) = \\frac{a s^{2} + b}{c s}$ 中的实常数 $a$、$b$ 和 $c$。\n\n**条件1：归一化频率的实数特性**\n该映射必须在虚轴上产生一个实的归一化低通频率变量 $\\Omega$，使得 $s_{lp}(j\\omega) = j\\,\\Omega(\\omega)$，其中 $\\Omega(\\omega) \\in \\mathbb{R}$。我们将 $s = j\\omega$ 代入 $s_{lp}(s)$ 的表达式中：\n$$\ns_{lp}(j\\omega) = \\frac{a (j\\omega)^{2} + b}{c (j\\omega)} = \\frac{-a\\omega^{2} + b}{jc\\omega} = -j\\frac{-a\\omega^{2} + b}{c\\omega} = j\\frac{a\\omega^{2} - b}{c\\omega}\n$$\n通过与所需形式 $s_{lp}(j\\omega) = j\\Omega(\\omega)$ 进行比较，我们确定归一化低通频率变量为：\n$$\n\\Omega(\\omega) = \\frac{a\\omega^{2} - b}{c\\omega}\n$$\n由于 $a$、$b$、$c$ 被指定为实常数，$\\Omega(\\omega)$ 对任何实数 $\\omega$ 都是一个实值函数，满足该条件。\n\n**条件2：中心频率的映射**\n该映射必须将中心频率 $\\omega_{0}$ 映射到低通域中的直流（DC），这对应于归一化频率为 $0$。数学上，$\\Omega(\\omega_{0}) = 0$。\n$$\n\\Omega(\\omega_{0}) = \\frac{a\\omega_{0}^{2} - b}{c\\omega_{0}} = 0\n$$\n假设一个非平凡的滤波器设计，其中 $c \\neq 0$ 且 $\\omega_{0} > 0$，这意味着分子必须为零：\n$$\na\\omega_{0}^{2} - b = 0 \\implies b = a\\omega_{0}^{2}\n$$\n\n**条件3：带宽定标**\n中心频率附近的局部带宽定标由斜率条件 $\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{2}{B}$ 指定。\n首先，我们求 $\\Omega(\\omega)$ 关于 $\\omega$ 的导数。对 $\\Omega(\\omega) = \\frac{a}{c}\\omega - \\frac{b}{c\\omega}$ 的形式求导更容易：\n$$\n\\frac{d\\Omega}{d\\omega} = \\frac{a}{c} - \\frac{b}{c}(-\\omega^{-2}) = \\frac{a}{c} + \\frac{b}{c\\omega^{2}}\n$$\n接下来，我们在 $\\omega = \\omega_{0}$ 处计算这个导数：\n$$\n\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{a}{c} + \\frac{b}{c\\omega_{0}^{2}}\n$$\n代入条件2的结果，$b = a\\omega_{0}^{2}$：\n$$\n\\left.\\frac{d\\Omega}{d\\omega}\\right|_{\\omega=\\omega_{0}} = \\frac{a}{c} + \\frac{a\\omega_{0}^{2}}{c\\omega_{0}^{2}} = \\frac{a}{c} + \\frac{a}{c} = \\frac{2a}{c}\n$$\n将此与给定条件相等：\n$$\n\\frac{2a}{c} = \\frac{2}{B} \\implies \\frac{a}{c} = \\frac{1}{B}\n$$\n$a$ 与 $c$ 的比值已确定。我们可以自由选择一个比例因子。最简单的选择是令 $a=1$。这意味着 $c=B$。当 $a=1$ 时，$b$ 的表达式变为 $b = 1 \\cdot \\omega_{0}^{2} = \\omega_{0}^{2}$。\n\n因此，参数为 $a=1$、$b=\\omega_{0}^{2}$ 和 $c=B$。所需的频率变换是：\n$$\ns_{lp}(s) = \\frac{s^{2} + \\omega_{0}^{2}}{Bs}\n$$\n\n### 任务2：带通传递函数\n\n带通滤波器的传递函数 $H_{bp}(s)$ 是通过将替换 $s \\mapsto s_{lp}(s)$ 应用于归一化低通原型传递函数 $H_{p}(s) = \\frac{1}{s^{2} + \\sqrt{2}\\,s + 1}$ 得到的。\n$$\nH_{bp}(s) = H_p(s_{lp}(s)) = H_p\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right)\n$$\n代入 $H_p(s)$ 的表达式：\n$$\nH_{bp}(s) = \\frac{1}{\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right)^{2} + \\sqrt{2}\\left(\\frac{s^{2} + \\omega_{0}^{2}}{Bs}\\right) + 1}\n$$\n为了简化这个表达式，我们将分子和分母同乘以公分母 $(Bs)^{2} = B^{2}s^{2}$：\n$$\nH_{bp}(s) = \\frac{B^{2}s^{2}}{(s^{2} + \\omega_{0}^{2})^{2} + \\sqrt{2}\\,(Bs)(s^{2} + \\omega_{0}^{2}) + B^{2}s^{2}}\n$$\n这是得到的四阶带通滤波器的传递函数。\n\n### 任务3：对称性质\n\n首先，我们使用已确定的参数 $a=1$、$b=\\omega_{0}^{2}$ 和 $c=B$ 写出 $\\Omega(\\omega)$ 的显式表达式：\n$$\n\\Omega(\\omega) = \\frac{1 \\cdot \\omega^{2} - \\omega_{0}^{2}}{B\\omega} = \\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right)\n$$\n现在，我们证明对称性质 $\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\,\\Omega(\\omega)$。我们将 $\\frac{\\omega_{0}^{2}}{\\omega}$ 代入 $\\Omega(\\omega)$ 的表达式中代替 $\\omega$：\n$$\n\\Omega\\!\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) = \\frac{1}{B}\\left(\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right) - \\frac{\\omega_{0}^{2}}{\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right)}\\right) = \\frac{1}{B}\\left(\\frac{\\omega_{0}^{2}}{\\omega} - \\omega\\right) = -\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = -\\Omega(\\omega)\n$$\n该性质得证。\n\n带通滤波器的频率响应为 $H_{bp}(j\\omega) = H_p(j\\Omega(\\omega))$。幅频响应为 $|H_{bp}(j\\omega)| = |H_p(j\\Omega(\\omega))|$。对于具有实值冲激响应的滤波器，其频率响应的幅度是偶函数，即 $|H_p(j\\Omega)| = |H_p(-j\\Omega)|$。利用这一点和 $\\Omega(\\omega)$ 的对称性质：\n$$\n\\left|H_{bp}\\left(j\\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right| = \\left|H_p\\left(j\\Omega\\left(\\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right)\\right| = |H_p(j(-\\Omega(\\omega)))| = |H_p(j\\Omega(\\omega))| = |H_{bp}(j\\omega)|\n$$\n这表明幅频响应在频率 $\\omega$ 和 $\\frac{\\omega_{0}^{2}}{\\omega}$ 处是相同的。这两个频率在对数标度上与 $\\omega_{0}$ 等距，因为 $\\log(\\omega) - \\log(\\omega_{0}) = \\log(\\omega/\\omega_{0})$ 和 $\\log(\\frac{\\omega_{0}^{2}}{\\omega}) - \\log(\\omega_{0}) = \\log(\\omega_{0}/\\omega) = -\\log(\\omega/\\omega_{0})$。因此，幅频响应 $|H_{bp}(j\\omega)|$ 在以中心频率 $\\omega_{0}$ 为中心的对数频率标度上是对称的。\n\n### 任务4：带边频率的计算\n\n带通滤波器的 $-3\\ \\mathrm{dB}$ 截止频率对应于幅频响应降至其峰值的 $1/\\sqrt{2}$ 时的频率。对于巴特沃斯原型，这发生在归一化频率 $|\\Omega|=1$ 处。我们需要求解关于 $\\omega$ 的方程 $|\\Omega(\\omega)| = 1$。\n\n给定的设计参数是 $f_{0} = 10\\ \\mathrm{Hz}$ 和带宽 $5\\ \\mathrm{Hz}$。相应的角频率是：\n$\\omega_{0} = 2\\pi f_{0} = 2\\pi(10) = 20\\pi\\ \\mathrm{rad/s}$。\n$B = 2\\pi (5) = 10\\pi\\ \\mathrm{rad/s}$。\n\n方程 $|\\Omega(\\omega)| = 1$ 变为：\n$$\n\\left|\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right)\\right| = 1\n$$\n这可以分解为两个独立的方程：\n1. $\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = 1 \\implies \\omega^{2} - B\\omega - \\omega_{0}^{2} = 0$\n2. $\\frac{1}{B}\\left(\\omega - \\frac{\\omega_{0}^{2}}{\\omega}\\right) = -1 \\implies \\omega^{2} + B\\omega - \\omega_{0}^{2} = 0$\n\n我们求解这些关于 $\\omega > 0$ 的二次方程。\n对于第一个方程，正根给出了上截止频率 $\\omega_{2}$：\n$$\n\\omega_{2} = \\frac{B + \\sqrt{B^{2} - 4(1)(-\\omega_{0}^{2})}}{2} = \\frac{B + \\sqrt{B^{2} + 4\\omega_{0}^{2}}}{2}\n$$\n对于第二个方程，正根给出了下截止频率 $\\omega_{1}$：\n$$\n\\omega_{1} = \\frac{-B + \\sqrt{B^{2} - 4(1)(-\\omega_{0}^{2})}}{2} = \\frac{-B + \\sqrt{B^{2} + 4\\omega_{0}^{2}}}{2}\n$$\n现在，我们代入 $\\omega_0$ 和 $B$ 的数值：\n$$\n\\sqrt{B^{2} + 4\\omega_{0}^{2}} = \\sqrt{(10\\pi)^{2} + 4(20\\pi)^{2}} = \\sqrt{100\\pi^{2} + 1600\\pi^{2}} = \\sqrt{1700\\pi^{2}} = 10\\pi\\sqrt{17}\n$$\n将此代入 $\\omega_{1}$ 和 $\\omega_{2}$ 的表达式中：\n$$\n\\omega_{1} = \\frac{-10\\pi + 10\\pi\\sqrt{17}}{2} = 5\\pi(\\sqrt{17}-1)\\ \\mathrm{rad/s}\n$$\n$$\n\\omega_{2} = \\frac{10\\pi + 10\\pi\\sqrt{17}}{2} = 5\\pi(\\sqrt{17}+1)\\ \\mathrm{rad/s}\n$$\n最后，我们将这些角频率转换为以赫兹为单位的频率（$f = \\omega/2\\pi$）并四舍五入至四位有效数字。\n下带边频率 $f_{1}$：\n$$\nf_{1} = \\frac{\\omega_{1}}{2\\pi} = \\frac{5\\pi(\\sqrt{17}-1)}{2\\pi} = \\frac{5}{2}(\\sqrt{17}-1) \\approx 2.5(4.1231056 - 1) = 7.807764\\ \\mathrm{Hz}\n$$\n四舍五入至四位有效数字，$f_{1} \\approx 7.808\\ \\mathrm{Hz}$。\n\n上带边频率 $f_{2}$：\n$$\nf_{2} = \\frac{\\omega_{2}}{2\\pi} = \\frac{5\\pi(\\sqrt{17}+1)}{2\\pi} = \\frac{5}{2}(\\sqrt{17}+1) \\approx 2.5(4.1231056 + 1) = 12.807764\\ \\mathrm{Hz}\n$$\n四舍五入至四位有效数字，$f_{2} \\approx 12.81\\ \\mathrm{Hz}$。\n\n下和上 $-3\\ \\mathrm{dB}$ 带边分别约为 $7.808\\ \\mathrm{Hz}$ 和 $12.81\\ \\mathrm{Hz}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7.808  12.81\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "滤波器不仅改变信号的频率成分，还会引入时间延迟，即所谓的群延迟，它可能随频率而变化。在分析神经波形时，恒定的群延迟（或“线性相位”）对于保持信号形状至关重要。本练习 () 探讨了这一关键概念，演示了如何计算线性相位FIR滤波器的恒定群延迟，并阐明了为何当时间精度至关重要时，这类滤波器通常是首选。",
            "id": "4176297",
            "problem": "在用于局部场电位 (LFP) 记录的神经科学数据分析流程中，使用一个有限冲激响应 (FIR) 带通滤波器来分离出感兴趣的振荡，同时保持波形形态。考虑一个离散时间、实值、线性相位的 FIR 带通滤波器，其设计长度为奇数 $N=401$，在采样频率 $f_{s}=1000\\ \\mathrm{Hz}$ 下具有对称的冲激响应 $h[n]$。仅使用以下基本事实：\n- 因果线性时不变 (LTI) 滤波器的离散时间频率响应 $H(\\omega)$ 通过离散时间傅里叶变换定义为 $H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$。\n- 群延迟 $\\tau_{g}(\\omega)$ 定义为 $\\tau_{g}(\\omega) = -\\frac{d}{d\\omega}\\,\\phi(\\omega)$，其中 $\\phi(\\omega)$ 是 $H(\\omega)$ 的相位。\n- 一个关于 $\\omega$ 的实偶函数，在其严格为正或严格为负的区域，其相位分别为 $0$ 或 $\\pi$，因此在其符号不变的区域，其相位是局部恒定的。\n\n基于这些基础，推导该滤波器恒定群延迟的表达式（以秒为单位），然后在给定的采样频率下计算其数值（以毫秒为单位）。将最终数值答案表示为以毫秒为单位的单个数字。如果需要四舍五入，则保留四位有效数字。",
            "solution": "滤波器的群延迟 $\\tau_{g}(\\omega)$ 是从其频率响应 $H(\\omega)$ 推导出来的。该滤波器是一个长度为 $N=401$ 的实值、因果 FIR 滤波器。其频率响应由其冲激响应 $h[n]$ 的离散时间傅里叶变换给出：\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$$\n长度 $N=401$ 是奇数。我们定义一个整数 $M$ 使得 $N = 2M+1$。\n$$M = \\frac{N-1}{2} = \\frac{401-1}{2} = \\frac{400}{2} = 200$$\n冲激响应 $h[n]$ 被陈述为对称的。对于一个奇数长度的因果滤波器，这意味着冲激响应关于 $n=M$ 处的样本是对称的：\n$$h[n] = h[N-1-n] = h[2M-n] \\quad \\text{for } n = 0, 1, \\dots, N-1$$\n我们可以通过拆分求和并利用这种对称性来重写 $H(\\omega)$ 的表达式。\n$$H(\\omega) = \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n) + h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=M+1}^{2M} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$$\n在第三项（第二个求和）中，我们进行变量替换。令 $k = 2M-n$，这意味着 $n = 2M-k$。当 $n=M+1$ 时，$k=M-1$。当 $n=2M$ 时，$k=0$。求和变为：\n$$\\sum_{k=0}^{M-1} h[2M-k] \\exp(-\\mathrm{j}\\,\\omega (2M-k))$$\n使用对称性质 $h[2M-k] = h[k]$，这变为：\n$$\\sum_{k=0}^{M-1} h[k] \\exp(-\\mathrm{j}\\,\\omega (2M-k))$$\n将哑索引 $k$ 还原为 $n$ 后，将其代回 $H(\\omega)$ 的表达式中：\n$$H(\\omega) = \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n) + h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega (2M-n))$$\n$$H(\\omega) = h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\left( \\exp(-\\mathrm{j}\\,\\omega n) + \\exp(-\\mathrm{j}\\,\\omega (2M-n)) \\right)$$\n我们可以从括号中的表达式中提取一个公因相位项：\n$$\\exp(-\\mathrm{j}\\,\\omega n) + \\exp(-\\mathrm{j}\\,\\omega (2M-n)) = \\exp(-\\mathrm{j}\\,\\omega M) \\left( \\exp(\\mathrm{j}\\,\\omega (M-n)) + \\exp(-\\mathrm{j}\\,\\omega (M-n)) \\right)$$\n使用欧拉公式 $\\cos(x) = \\frac{\\exp(\\mathrm{j}x) + \\exp(-\\mathrm{j}x)}{2}$，括号中的项简化为 $2\\cos(\\omega(M-n))$。\n将此代回可得：\n$$H(\\omega) = h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\left( \\exp(-\\mathrm{j}\\,\\omega M) \\, 2\\cos(\\omega(M-n)) \\right)$$\n现在，我们从整个 $H(\\omega)$ 表达式中提取公因项 $\\exp(-\\mathrm{j}\\,\\omega M)$：\n$$H(\\omega) = \\exp(-\\mathrm{j}\\,\\omega M) \\left[ h[M] + \\sum_{n=0}^{M-1} 2h[n] \\cos(\\omega(M-n)) \\right]$$\n这具有 $H(\\omega) = A(\\omega) \\exp(\\mathrm{j}\\,\\theta(\\omega))$ 的形式，其中相位是关于 $\\omega$ 的线性函数。具体来说，我们确定：\n$$A(\\omega) = h[M] + \\sum_{n=0}^{M-1} 2h[n] \\cos(\\omega(M-n))$$\n且相位项为 $\\exp(-\\mathrm{j}\\,\\omega M)$。\n由于冲激响应 $h[n]$ 是实值的，且余弦函数是实值的，所以 $A(\\omega)$ 是一个关于 $\\omega$ 的纯实值函数。此外，由于 $\\cos(x) = \\cos(-x)$，$A(\\omega)$ 是 $\\omega$ 的一个偶函数，即 $A(\\omega) = A(-\\omega)$。\n因此，频率响应为 $H(\\omega) = A(\\omega) \\exp(-\\mathrm{j}\\,\\omega M)$。滤波器的总相位 $\\phi(\\omega)$ 是 $A(\\omega)$ 的相位与复指数项的相位之和：\n$$\\phi(\\omega) = \\arg(A(\\omega)) - \\omega M$$\n根据基本事实，对于实函数 $A(\\omega)$，其相位 $\\arg(A(\\omega))$ 在 $A(\\omega) > 0$ 时为 $0$，在 $A(\\omega) < 0$ 时为 $\\pi$。至关重要的是，在 $A(\\omega)$ 符号不改变的频带内（例如设计良好的滤波器的通带），相位 $\\arg(A(\\omega))$ 是恒定的。\n群延迟 $\\tau_g(\\omega)$ 定义为：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\phi(\\omega) = -\\frac{d}{d\\omega} \\left( \\arg(A(\\omega)) - \\omega M \\right)$$\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega}\\arg(A(\\omega)) + \\frac{d}{d\\omega}(\\omega M)$$\n由于 $\\arg(A(\\omega))$ 是分段常数（为 $0$ 或 $\\pi$），它关于 $\\omega$ 的导数处处为零，除了在 $A(\\omega)=0$ 的频率点。因此，对于所有 $A(\\omega) \\neq 0$ 的频率：\n$$\\frac{d}{d\\omega}\\arg(A(\\omega)) = 0$$\n线性相位分量的导数是：\n$$\\frac{d}{d\\omega}(\\omega M) = M$$\n因此，群延迟是恒定的，并由下式给出：\n$$\\tau_g(\\omega) = M$$\n这个结果给出了以样本为单位的群延迟。要将其转换为以秒为单位的物理时间，我们乘以采样周期 $T_s = 1/f_s$。\n$$\\tau_g = M \\cdot T_s = \\frac{N-1}{2} \\cdot \\frac{1}{f_s}$$\n使用给定的数值：$N=401$ 和 $f_s = 1000\\ \\mathrm{Hz}$。\n$$\\tau_g = \\frac{401-1}{2} \\cdot \\frac{1}{1000} = \\frac{200}{1000} = 0.2\\ \\mathrm{s}$$\n题目要求答案以毫秒为单位。\n$$\\tau_g = 0.2\\ \\mathrm{s} \\times 1000\\ \\frac{\\mathrm{ms}}{\\mathrm{s}} = 200\\ \\mathrm{ms}$$\n题目要求最终数值答案如果需要四舍五入，则保留四位有效数字。结果 $200$ 是精确值。为表示为四位有效数字，我们将其写为 $200.0$。",
            "answer": "$$\\boxed{200.0}$$"
        }
    ]
}