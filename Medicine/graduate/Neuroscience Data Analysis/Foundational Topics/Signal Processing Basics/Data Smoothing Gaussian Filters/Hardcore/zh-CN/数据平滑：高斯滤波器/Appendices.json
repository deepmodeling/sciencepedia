{
    "hands_on_practices": [
        {
            "introduction": "高斯滤波器的核心参数是其标准差 $\\sigma$，它决定了平滑的程度。为了直观地理解 $\\sigma$ 的作用，一个有效的方法是将其与我们更熟悉的系统联系起来。本练习  旨在通过比较高斯滤波器与一阶低通滤波器的频率响应，将抽象的参数 $\\sigma$ 与物理意义明确的时间常数 $\\tau$ 建立起量化关系，从而帮助你深入理解平滑带宽对信号频率成分的具体影响。",
            "id": "4153045",
            "problem": "一个实验室正在分析一个振荡性局部场电位（LFP; local field potential）信号，其振幅包络将通过使用零相位高斯核对原始时间序列进行平滑来估计。设连续时间高斯平滑核为\n$$\ng(t) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{t^{2}}{2\\sigma^{2}}\\right),\n$$\n其中 $\\sigma$ 是以秒为单位的标准差。目标是选择 $\\sigma$，使得平滑后信号的半功率频率（即幅度相对于直流分量衰减为 $1/\\sqrt{2}$ 倍时的频率）与时间常数为 $\\tau$ 秒的一阶因果低通滤波器相同。在整个问题中，使用以弧度/秒为单位的角频率。\n\n从卷积和傅里叶变换的定义出发，仅使用高斯系统和一阶低通系统的基本性质，通过要求高斯平滑器在角频率 $\\omega = 1/\\tau$ 处的幅度等于半功率值，来确定 $\\sigma$ 与 $\\tau$ 的关系。然后，对于一个输入正弦波\n$$\nx(t) = A\\cos(\\omega_{0} t),\n$$\n推导用上面选定的高斯核进行平滑后正弦波的振幅。将最终答案表示为关于 $A$、$\\omega_{0}$ 和 $\\tau$ 的单个闭式解析表达式。不需要进行数值计算，最终表达式中不应出现单位。角度必须以弧度为单位处理。",
            "solution": "该问题陈述具有科学依据、适定、客观且内部一致。它是线性系统理论和信号处理中的一个标准问题，与神经科学数据的分析相关。所有必要信息都已提供，以推导出一个唯一的解。该问题是有效的。\n\n求解过程分为两部分。首先，我们根据时间常数 $\\tau$ 确定高斯核的标准差 $\\sigma$。其次，我们利用这个结果来找出正弦信号经过这个特定高斯滤波器平滑后的振幅。\n\n平滑操作是输入信号 $x(t)$ 与高斯核 $g(t)$ 的卷积。在频域中，该卷积变成了它们各自傅里叶变换的乘积。设 $X(\\omega)$ 是 $x(t)$ 的傅里叶变换，$G(\\omega)$ 是 $g(t)$ 的傅里叶变换。输出信号 $y(t)$ 的傅里叶变换为 $Y(\\omega) = G(\\omega)X(\\omega)$。函数 $G(\\omega)$ 是高斯滤波器的频率响应或传递函数。\n\n高斯核由下式给出：\n$$\ng(t) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n$$\n一个归一化高斯函数 $\\exp(-at^2)$ 的傅里叶变换是 $\\sqrt{\\pi/a} \\exp(-\\omega^2/(4a))$。在我们的例子中，$g(t)$ 中包含了前置因子，以将其积分归一化为1。$g(t)$ 的傅里叶变换是一个标准结果：\n$$\nG(\\omega) = \\mathcal{F}\\{g(t)\\}(\\omega) = \\exp\\left(-\\frac{\\sigma^2\\omega^2}{2}\\right)\n$$\n这个频率响应 $G(\\omega)$ 是纯实数且为正，这表明高斯滤波器是一个零相位滤波器，意味着它不会对信号的频谱分量引入任何相位偏移。频率响应的幅度为 $|G(\\omega)| = G(\\omega)$。\n\n问题要求我们选择 $\\sigma$，使得滤波器在角频率 $\\omega = 1/\\tau$ 处的幅度等于半功率值，即相对于直流增益的 $1/\\sqrt{2}$。直流增益是 $\\omega=0$ 时的增益：\n$$\n|G(0)| = \\exp(0) = 1\n$$\n所以，半功率条件是 $|G(\\omega)| = 1/\\sqrt{2}$。我们必须在 $\\omega = 1/\\tau$ 处强制执行此条件：\n$$\n\\left|G\\left(\\frac{1}{\\tau}\\right)\\right| = \\exp\\left(-\\frac{\\sigma^2(1/\\tau)^2}{2}\\right) = \\frac{1}{\\sqrt{2}}\n$$\n使用自然底数 $e$ 重写右侧：\n$$\n\\exp\\left(-\\frac{\\sigma^2}{2\\tau^2}\\right) = 2^{-1/2} = \\exp\\left(\\ln\\left(2^{-1/2}\\right)\\right) = \\exp\\left(-\\frac{\\ln(2)}{2}\\right)\n$$\n通过令指数函数的参数相等，我们得到：\n$$\n-\\frac{\\sigma^2}{2\\tau^2} = -\\frac{\\ln(2)}{2}\n$$\n解出 $\\sigma^2$：\n$$\n\\sigma^2 = \\tau^2 \\ln(2)\n$$\n这给出了所需高斯核方差与时间常数 $\\tau$ 的关系。由于 $\\sigma$ 代表标准差，它必须为正，所以 $\\sigma = \\tau\\sqrt{\\ln(2)}$。\n\n现在，我们进行问题的第二部分。将一个正弦输入信号 $x(t) = A\\cos(\\omega_0 t)$ 应用于由高斯滤波器定义的LTI系统。对于一个频率响应为 $H(\\omega)$ 的通用LTI系统，该输入的稳态输出由下式给出：\n$$\ny(t) = A |H(\\omega_0)| \\cos(\\omega_0 t + \\angle H(\\omega_0))\n$$\n在我们的例子中，滤波器是高斯平滑器，所以 $H(\\omega) = G(\\omega) = \\exp(-\\sigma^2\\omega^2/2)$。如前所述，这是一个零相位滤波器，所以 $\\angle G(\\omega_0) = 0$。幅度为 $|G(\\omega_0)| = \\exp(-\\sigma^2\\omega_0^2/2)$。\n\n因此，输出信号为：\n$$\ny(t) = A \\exp\\left(-\\frac{\\sigma^2\\omega_0^2}{2}\\right) \\cos(\\omega_0 t)\n$$\n该输出正弦波的振幅是余弦项的前置因子。我们称之为 $A_{out}$：\n$$\nA_{out} = A \\exp\\left(-\\frac{\\sigma^2\\omega_0^2}{2}\\right)\n$$\n为了用 $A$、$\\omega_0$ 和 $\\tau$ 表示这个振幅，我们代入之前推导出的 $\\sigma^2$ 的表达式，即 $\\sigma^2 = \\tau^2 \\ln(2)$：\n$$\nA_{out} = A \\exp\\left(-\\frac{(\\tau^2 \\ln(2))\\omega_0^2}{2}\\right)\n$$\n整理指数中的项，得到输出振幅的最终闭式表达式：\n$$\nA_{out} = A \\exp\\left(-\\frac{\\ln(2)\\omega_0^2\\tau^2}{2}\\right)\n$$\n该表达式表示原始正弦波的振幅 $A$ 被一个取决于信号频率 $\\omega_0$ 和滤波器参数 $\\tau$ 的因子所衰减。",
            "answer": "$$\n\\boxed{A \\exp\\left(-\\frac{\\ln(2)\\omega_0^2\\tau^2}{2}\\right)}\n$$"
        },
        {
            "introduction": "虽然高斯平滑能有效抑制噪声，但它不可避免地会以模糊信号特征为代价。本练习  聚焦于这一核心权衡，通过分析理想化的阶跃信号和脉冲信号，你将推导出平滑操作如何系统性地降低这些快速瞬变信号的幅度。理解这种由平滑引入的振幅偏差，对于准确解释神经科学中常见的突触电流或钙信号等事件至关重要。",
            "id": "4153092",
            "problem": "在神经科学数据分析中，高斯平滑常用于降低时间序列（如突触电流或钙荧光信号）中的噪声。考虑一个连续时间信号 $x(t)$，通过与标准差为 $\\sigma$ 的归一化高斯核 $G_{\\sigma}(t)$ 进行卷积平滑，该高斯核定义为\n$$\nG_{\\sigma}(t) = \\frac{1}{\\sqrt{2 \\pi} \\, \\sigma} \\exp\\!\\left(-\\frac{t^{2}}{2 \\sigma^{2}}\\right), \\quad \\int_{-\\infty}^{\\infty} G_{\\sigma}(t) \\, dt = 1,\n$$\n平滑后的输出为 $y(t) = (x * G_{\\sigma})(t) = \\int_{-\\infty}^{\\infty} x(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau$。\n\n考虑两种典型的急剧瞬变信号：\n- 阶跃输入 $x_{\\text{step}}(t) = A \\, H(t)$，其中 $H(t)$ 是 Heaviside 阶跃函数，$A > 0$ 是阶跃高度。将跃变点处的逐点振幅估计定义为 $y_{\\text{step}}(0)$，衰减因子定义为 $b_{\\text{step}}(\\sigma) = y_{\\text{step}}(0)/A$。\n- 类脉冲输入，建模为中心在 $t = 0$、宽度为 $\\varepsilon > 0$、振幅为 $A > 0$ 的窄矩形脉冲，\n$$\nx_{\\text{imp},\\varepsilon}(t) = A \\, \\mathbf{1}_{\\{|t| \\le \\varepsilon/2\\}}(t),\n$$\n其中 $\\mathbf{1}_{\\{|t| \\le \\varepsilon/2\\}}$ 是区间 $[-\\varepsilon/2, \\varepsilon/2]$ 的指示函数。对于平滑后的响应 $y_{\\text{imp},\\varepsilon}(t) = (x_{\\text{imp},\\varepsilon} * G_{\\sigma})(t)$，将振幅估计定义为峰值 $y_{\\text{imp},\\varepsilon}(0)$，衰减因子定义为 $b_{\\text{imp}}(\\sigma, \\varepsilon) = y_{\\text{imp},\\varepsilon}(0)/A$。\n\n仅从以上定义以及与偶函数、归一化核进行卷积的性质出发，推导以下表达式：\n- $b_{\\text{step}}(\\sigma)$ 的闭式常数形式。\n- 在小宽度条件 $\\varepsilon/\\sigma \\ll 1$ 下，$b_{\\text{imp}}(\\sigma, \\varepsilon)$ 的主阶近似。\n\n请将您的最终答案以单个行向量 $\\big[b_{\\text{step}}(\\sigma), \\, b_{\\text{imp}}(\\sigma, \\varepsilon)\\big]$ 的形式给出，其中包含闭式解析表达式。无需进行数值计算，也无需在最终答案中报告单位。如果需要近似，仅报告 $\\varepsilon/\\sigma$ 的主阶项。",
            "solution": "用户希望解决一个关于信号高斯平滑的问题，这是神经科学数据分析中的一种常用技术。\n\n### 第 1 步：问题验证\n\n**提取已知条件：**\n*   **高斯核：** $G_{\\sigma}(t) = \\frac{1}{\\sqrt{2 \\pi} \\, \\sigma} \\exp\\left(-\\frac{t^{2}}{2 \\sigma^{2}}\\right)$\n*   **归一化：** $\\int_{-\\infty}^{\\infty} G_{\\sigma}(t) \\, dt = 1$\n*   **卷积：** $y(t) = (x * G_{\\sigma})(t) = \\int_{-\\infty}^{\\infty} x(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau$\n*   **阶跃输入：** $x_{\\text{step}}(t) = A \\, H(t)$，其中 $H(t)$ 是 Heaviside 阶跃函数，$A > 0$。\n*   **阶跃衰减因子：** $b_{\\text{step}}(\\sigma) = y_{\\text{step}}(0)/A$，其中 $y_{\\text{step}}(0)$ 是 $t=0$ 处的平滑输出。\n*   **类脉冲输入（矩形脉冲）：** $x_{\\text{imp},\\varepsilon}(t) = A \\, \\mathbf{1}_{\\{|t| \\le \\varepsilon/2\\}}(t)$，其中 $\\varepsilon > 0$ 且 $A > 0$。$\\mathbf{1}_{\\{\\cdot\\}}$ 是指示函数。\n*   **脉冲衰减因子：** $b_{\\text{imp}}(\\sigma, \\varepsilon) = y_{\\text{imp},\\varepsilon}(0)/A$，其中 $y_{\\text{imp},\\varepsilon}(0)$ 是 $t=0$ 处的平滑输出。\n*   **任务 1：** 推导 $b_{\\text{step}}(\\sigma)$ 的闭式表达式。\n*   **任务 2：** 推导在 $\\varepsilon/\\sigma \\ll 1$ 条件下 $b_{\\text{imp}}(\\sigma, \\varepsilon)$ 的主阶近似。\n\n**验证分析：**\n1.  **科学依据：** 该问题牢固地植根于信号处理和傅里叶分析，采用了卷积、高斯函数以及像 Heaviside 阶跃和矩形脉冲这类理想化信号的标准定义。这些是在许多科学领域（包括神经科学）中分析时间序列数据的基本工具。该问题在科学上是合理的。\n2.  **适定性：** 目标陈述清晰，所有必要的数学定义和约束都已提供。问题是自洽的，其结构可以引导出所求量的唯一、有意义的解。\n3.  **客观性：** 该问题使用精确的数学语言表述，没有任何主观或模糊的术语。\n\n**结论：**\n该问题是有效的。这是一个信号分析中的标准、适定问题，需要根据所提供的定义应用积分学和近似方法。\n\n### 第 2 步：求解推导\n\n#### 第 1 部分：阶跃输入的衰减 $b_{\\text{step}}(\\sigma)$\n\n对于阶跃输入 $x_{\\text{step}}(t) = A \\, H(t)$，其平滑后的输出由卷积给出：\n$$\ny_{\\text{step}}(t) = \\int_{-\\infty}^{\\infty} x_{\\text{step}}(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\n代入 $x_{\\text{step}}(\\tau)$ 的表达式：\n$$\ny_{\\text{step}}(t) = \\int_{-\\infty}^{\\infty} A \\, H(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\nHeaviside 函数 $H(\\tau)$ 在 $\\tau  0$ 时为 0，在 $\\tau \\ge 0$ 时为 1。此性质将积分下限从 $-\\infty$ 更改为 $0$：\n$$\ny_{\\text{step}}(t) = A \\int_{0}^{\\infty} G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\n我们必须在 $t=0$ 处计算此表达式，以找到逐点振幅估计 $y_{\\text{step}}(0)$：\n$$\ny_{\\text{step}}(0) = A \\int_{0}^{\\infty} G_{\\sigma}(-\\tau) \\, d\\tau\n$$\n高斯核 $G_{\\sigma}(t)$ 是一个偶函数，因为它的定义取决于 $t^2$。因此，$G_{\\sigma}(-\\tau) = G_{\\sigma}(\\tau)$。将此代入积分可得：\n$$\ny_{\\text{step}}(0) = A \\int_{0}^{\\infty} G_{\\sigma}(\\tau) \\, d\\tau\n$$\n已知核是归一化的，即 $\\int_{-\\infty}^{\\infty} G_{\\sigma}(\\tau) \\, d\\tau = 1$。由于 $G_{\\sigma}(\\tau)$ 是一个偶函数，其在正实轴上的积分恰好是其总积分的一半：\n$$\n\\int_{0}^{\\infty} G_{\\sigma}(\\tau) \\, d\\tau = \\frac{1}{2} \\int_{-\\infty}^{\\infty} G_{\\sigma}(\\tau) \\, d\\tau = \\frac{1}{2}\n$$\n将此结果代回 $y_{\\text{step}}(0)$ 的表达式中：\n$$\ny_{\\text{step}}(0) = A \\cdot \\frac{1}{2} = \\frac{A}{2}\n$$\n衰减因子 $b_{\\text{step}}(\\sigma)$ 定义为 $y_{\\text{step}}(0)/A$。因此：\n$$\nb_{\\text{step}}(\\sigma) = \\frac{A/2}{A} = \\frac{1}{2}\n$$\n这个结果是一个常数，与核的标准差 $\\sigma$ 无关。\n\n#### 第 2 部分：类脉冲输入的衰减 $b_{\\text{imp}}(\\sigma, \\varepsilon)$\n\n对于矩形脉冲输入 $x_{\\text{imp},\\varepsilon}(t)$，其平滑后的输出为：\n$$\ny_{\\text{imp},\\varepsilon}(t) = \\int_{-\\infty}^{\\infty} x_{\\text{imp},\\varepsilon}(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\n代入 $x_{\\text{imp},\\varepsilon}(\\tau) = A \\, \\mathbf{1}_{\\{|\\tau| \\le \\varepsilon/2\\}}(\\tau)$ 的表达式：\n$$\ny_{\\text{imp},\\varepsilon}(t) = \\int_{-\\infty}^{\\infty} A \\, \\mathbf{1}_{\\{|\\tau| \\le \\varepsilon/2\\}}(\\tau) \\, G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\n指示函数将积分区间限制在 $[-\\varepsilon/2, \\varepsilon/2]$：\n$$\ny_{\\text{imp},\\varepsilon}(t) = A \\int_{-\\varepsilon/2}^{\\varepsilon/2} G_{\\sigma}(t - \\tau) \\, d\\tau\n$$\n振幅估计是峰值，由于输入脉冲和核都具有对称性，峰值出现在 $t=0$ 处：\n$$\ny_{\\text{imp},\\varepsilon}(0) = A \\int_{-\\varepsilon/2}^{\\varepsilon/2} G_{\\sigma}(-\\tau) \\, d\\tau\n$$\n再次使用偶函数性质 $G_{\\sigma}(-\\tau) = G_{\\sigma}(\\tau)$：\n$$\ny_{\\text{imp},\\varepsilon}(0) = A \\int_{-\\varepsilon/2}^{\\varepsilon/2} G_{\\sigma}(\\tau) \\, d\\tau\n$$\n衰减因子 $b_{\\text{imp}}(\\sigma, \\varepsilon)$ 定义为 $y_{\\text{imp},\\varepsilon}(0)/A$：\n$$\nb_{\\text{imp}}(\\sigma, \\varepsilon) = \\int_{-\\varepsilon/2}^{\\varepsilon/2} G_{\\sigma}(\\tau) \\, d\\tau\n$$\n题目要求在 $\\varepsilon/\\sigma \\ll 1$ 条件下的主阶近似。这个条件意味着积分区间 $[-\\varepsilon/2, \\varepsilon/2]$ 相对于高斯函数的宽度 $\\sigma$ 非常窄。在这个小区间上，我们可以用被积函数 $G_{\\sigma}(\\tau)$ 在区间中心点 $\\tau = 0$ 处的值来近似它。这对应于取 $G_{\\sigma}(\\tau)$ 在 $\\tau=0$ 附近的泰勒展开的零阶项。\n$$\nG_{\\sigma}(\\tau) \\approx G_{\\sigma}(0) \\quad \\text{for} \\quad \\tau \\in [-\\varepsilon/2, \\varepsilon/2]\n$$\n高斯核在其中心点的值为：\n$$\nG_{\\sigma}(0) = \\frac{1}{\\sqrt{2 \\pi} \\, \\sigma} \\exp\\left(-\\frac{0^{2}}{2 \\sigma^{2}}\\right) = \\frac{1}{\\sqrt{2 \\pi} \\, \\sigma}\n$$\n将此常数近似代入 $b_{\\text{imp}}(\\sigma, \\varepsilon)$ 的积分中：\n$$\nb_{\\text{imp}}(\\sigma, \\varepsilon) \\approx \\int_{-\\varepsilon/2}^{\\varepsilon/2} G_{\\sigma}(0) \\, d\\tau = G_{\\sigma}(0) \\int_{-\\varepsilon/2}^{\\varepsilon/2} 1 \\, d\\tau\n$$\n该积分的计算结果就是区间的长度，即 $\\varepsilon/2 - (-\\varepsilon/2) = \\varepsilon$。\n$$\nb_{\\text{imp}}(\\sigma, \\varepsilon) \\approx G_{\\sigma}(0) \\cdot \\varepsilon = \\left(\\frac{1}{\\sqrt{2 \\pi} \\, \\sigma}\\right) \\varepsilon\n$$\n重写此式以强调无量纲比率 $\\varepsilon/\\sigma$：\n$$\nb_{\\text{imp}}(\\sigma, \\varepsilon) \\approx \\frac{\\varepsilon}{\\sigma \\sqrt{2 \\pi}}\n$$\n这就是所要求的主阶近似。\n\n#### 结果总结\n\n推导出的两个量是：\n1.  $b_{\\text{step}}(\\sigma) = \\frac{1}{2}$\n2.  $b_{\\text{imp}}(\\sigma, \\varepsilon) \\approx \\frac{\\varepsilon}{\\sigma \\sqrt{2 \\pi}}$\n\n最终答案应以包含这两个表达式的行向量形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{\\varepsilon}{\\sigma \\sqrt{2 \\pi}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理论中，我们常常假设信号是无限长的，但在实际数据分析中，我们处理的总是有限长度的记录。在数据段的边界附近应用平滑会产生“边缘伪影”，这是一个必须解决的实际问题。本练习  将引导你探讨几种常见的边界处理技术（“填充”），并量化不同填充方案（如零填充、反射填充）对平滑结果引入的误差。通过这个练习，你将学会如何在实践中识别并减轻这些伪影，确保数据分析的准确性。",
            "id": "4153097",
            "problem": "在神经科学数据分析中，一个常见的操作是使用高斯滤波器平滑刺激-时间直方图 (PSTH)，以估计时变的发放率。考虑一个连续时间的PSTH，其模型为在刺激开始时发生阶跃变化，当时间 $t  0$ 时基线发放率为 $B \\ge 0$，当时间 $t \\ge 0$ 时阶跃至 $B + A$，其中 $A  0$ 是阶跃幅度。令高斯滤波器核为 $g_{\\sigma}(t) = \\frac{1}{\\sigma \\sqrt{2 \\pi}} \\exp\\!\\left(-\\frac{t^{2}}{2 \\sigma^{2}}\\right)$，其中标准差 $\\sigma  0$，并将信号 $x(t)$ 的高斯平滑定义为卷积 $(x * g_{\\sigma})(t) = \\int_{-\\infty}^{\\infty} g_{\\sigma}(\\tau)\\, x(t - \\tau)\\, d\\tau$。理想的全数据平滑输出为 $y^{\\star}(t) = (x_{\\star} * g_{\\sigma})(t)$，其中全数据信号 $x_{\\star}(t)$ 定义为当 $t  0$ 时 $x_{\\star}(t) = B$，当 $t \\ge 0$ 时 $x_{\\star}(t) = B + A$。\n\n在实践中，由于只有 $t \\ge 0$ 的数据可用，因此在 $t = 0$ 的刺激开始边界附近进行平滑需要一种填充方案。定义三种填充方案，将观测信号 $x(t)$（仅在 $t \\ge 0$ 时已知）扩展为对所有 $t \\in \\mathbb{R}$ 的填充信号 $\\tilde{x}(t)$：\n- 零填充：当 $t \\ge 0$ 时，$\\tilde{x}(t) = x(t)$；当 $t  0$ 时，$\\tilde{x}(t) = 0$。\n- 反射填充：当 $t \\ge 0$ 时，$\\tilde{x}(t) = x(t)$；当 $t  0$ 时，$\\tilde{x}(t) = x(|t|)$。\n- 常数扩展填充：当 $t \\ge 0$ 时，$\\tilde{x}(t) = x(t)$；当 $t  0$ 时，$\\tilde{x}(t) = x(0)$。\n\n对于每种填充方案，从卷积的定义和高斯核的性质出发，推导在时间 $t \\ge 0$ 时的平滑输出 $\\tilde{y}(t) = (\\tilde{x} * g_{\\sigma})(t)$。然后，将每种方案的边缘伪影幅度 $M$ 定义为在非负时间内，填充平滑输出与理想全数据平滑输出之间的最大绝对偏差，\n$$\nM \\equiv \\sup_{t \\ge 0} \\left| \\tilde{y}(t) - y^{\\star}(t) \\right|.\n$$\n通过报告上述指定顺序（零填充、反射填充、常数扩展填充）的三种方案的 $M/A$，将最终结果表示为阶跃幅度的无量纲分数。在一个行矩阵中提供这三个值。无需四舍五入。",
            "solution": "该问题具有科学依据，提法恰当且客观。所有术语和条件都得到了正式定义，从而可以进行严格的数学求解。因此，该问题被认为是有效的。\n\n求解过程需要计算三种不同填充方案的平滑输出，并将每种输出与理想的平滑输出进行比较。问题的核心在于计算与高斯核的卷积积分。\n\n首先，我们建立必要的定义并计算理想的平滑输出，它将作为共同的参考。代表发放率阶跃变化的理想信号由下式给出\n$$\nx_{\\star}(t) = \\begin{cases} B  t  0 \\\\ B+A  t \\ge 0 \\end{cases}\n$$\n这可以使用亥维赛阶跃函数 $H(t)$（当 $t \\ge 0$ 时 $H(t)=1$，当 $t  0$ 时 $H(t)=0$）表示为 $x_{\\star}(t) = B + A H(t)$。\n\n高斯滤波器核为 $g_{\\sigma}(t) = \\frac{1}{\\sigma \\sqrt{2 \\pi}} \\exp\\left(-\\frac{t^{2}}{2 \\sigma^{2}}\\right)$。该核的积分是卷积运算的核心。令 $\\Phi(u)$ 为标准正态分布 $N(0, 1)$ 的累积分布函数 (CDF)：\n$$\n\\Phi(u) = \\int_{-\\infty}^{u} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{v^2}{2}\\right) dv\n$$\n通过变量替换 $v = \\tau/\\sigma$，我们可以证明指定高斯核的积分与 $\\Phi(u)$ 相关：\n$$\n\\int_{-\\infty}^{t} g_{\\sigma}(\\tau) d\\tau = \\int_{-\\infty}^{t/\\sigma} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{v^2}{2}\\right) dv = \\Phi\\left(\\frac{t}{\\sigma}\\right)\n$$\n$\\Phi(u)$ 的一个关键性质是 $\\Phi(0) = 1/2$。\n\n理想的平滑输出 $y^{\\star}(t)$ 是卷积 $(x_{\\star} * g_{\\sigma})(t)$：\n$$\ny^{\\star}(t) = \\int_{-\\infty}^{\\infty} g_{\\sigma}(\\tau) x_{\\star}(t - \\tau) d\\tau\n$$\n根据卷积的线性性，$y^{\\star}(t) = ((B + A H) * g_{\\sigma})(t) = (B * g_{\\sigma})(t) + (A H * g_{\\sigma})(t)$。\n常数 $B$ 与归一化核 $g_{\\sigma}$ 的卷积就是 $B$。缩放的亥维赛函数 $A H(t)$ 的卷积是：\n$$\n(A H * g_{\\sigma})(t) = A \\int_{-\\infty}^{\\infty} g_{\\sigma}(\\tau) H(t - \\tau) d\\tau = A \\int_{-\\infty}^{t} g_{\\sigma}(\\tau) d\\tau = A \\Phi\\left(\\frac{t}{\\sigma}\\right)\n$$\n因此，理想的平滑输出为：\n$$\ny^{\\star}(t) = B + A \\Phi\\left(\\frac{t}{\\sigma}\\right)\n$$\n\n现在我们分析对于观测信号 $x(t) = B+A$（$t \\ge 0$），每种填充方案的情况。\n\n**1. 零填充**\n填充信号 $\\tilde{x}_{zero}(t)$ 定义为当 $t \\ge 0$ 时 $\\tilde{x}_{zero}(t) = x(t)$，当 $t  0$ 时 $\\tilde{x}_{zero}(t) = 0$。这可以写成 $\\tilde{x}_{zero}(t) = (B+A)H(t)$。\n平滑输出 $\\tilde{y}_{zero}(t)$ 为：\n$$\n\\tilde{y}_{zero}(t) = (\\tilde{x}_{zero} * g_{\\sigma})(t) = ((B+A)H * g_{\\sigma})(t) = (B+A) \\Phi\\left(\\frac{t}{\\sigma}\\right)\n$$\n对于 $t \\ge 0$，与理想输出的偏差为：\n$$\nD_{zero}(t) = \\tilde{y}_{zero}(t) - y^{\\star}(t) = (B+A) \\Phi\\left(\\frac{t}{\\sigma}\\right) - \\left(B + A \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right) = B \\Phi\\left(\\frac{t}{\\sigma}\\right) - B = B\\left(\\Phi\\left(\\frac{t}{\\sigma}\\right) - 1\\right)\n$$\n边缘伪影幅度 $M_{zero}$ 是在 $t \\ge 0$ 上绝对偏差的上确界：\n$$\nM_{zero} = \\sup_{t \\ge 0} \\left| B\\left(\\Phi\\left(\\frac{t}{\\sigma}\\right) - 1\\right) \\right|\n$$\n由于 $B \\ge 0$ 且 $\\Phi(u) \\le 1$，绝对值内的表达式为非正数。因此：\n$$\nM_{zero} = \\sup_{t \\ge 0} -B\\left(\\Phi\\left(\\frac{t}{\\sigma}\\right) - 1\\right) = \\sup_{t \\ge 0} B\\left(1 - \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right)\n$$\n对于 $t \\ge 0$，函数 $\\Phi(t/\\sigma)$ 是单调递增的，从 $\\Phi(0)=1/2$ 开始。因此，$1 - \\Phi(t/\\sigma)$ 是单调递减的。上确界出现在定义域的下界，即 $t=0$ 处：\n$$\nM_{zero} = B\\left(1 - \\Phi(0)\\right) = B\\left(1 - \\frac{1}{2}\\right) = \\frac{B}{2}\n$$\n所需的无量纲分数为 $M_{zero}/A = \\frac{B}{2A}$。\n\n**2. 反射填充**\n填充信号 $\\tilde{x}_{refl}(t)$ 定义为当 $t \\ge 0$ 时 $\\tilde{x}_{refl}(t) = x(t)$，当 $t  0$ 时 $\\tilde{x}_{refl}(t) = x(|t|)$。\n给定当 $t \\ge 0$ 时 $x(t) = B+A$，我们有：\n- 当 $t \\ge 0$ 时，$\\tilde{x}_{refl}(t) = B+A$。\n- 当 $t  0$ 时，$|t| > 0$，所以 $\\tilde{x}_{refl}(t) = x(|t|) = B+A$。\n因此，对于所有 $t \\in \\mathbb{R}$ 都有 $\\tilde{x}_{refl}(t) = B+A$。\n平滑输出 $\\tilde{y}_{refl}(t)$ 是一个常数与 $g_{\\sigma}(t)$ 的卷积：\n$$\n\\tilde{y}_{refl}(t) = \\int_{-\\infty}^{\\infty} g_{\\sigma}(\\tau) (B+A) d\\tau = (B+A) \\int_{-\\infty}^{\\infty} g_{\\sigma}(\\tau) d\\tau = B+A\n$$\n对于 $t \\ge 0$，与理想输出的偏差为：\n$$\nD_{refl}(t) = \\tilde{y}_{refl}(t) - y^{\\star}(t) = (B+A) - \\left(B + A \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right) = A - A \\Phi\\left(\\frac{t}{\\sigma}\\right) = A\\left(1 - \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right)\n$$\n边缘伪影幅度 $M_{refl}$ 为：\n$$\nM_{refl} = \\sup_{t \\ge 0} \\left| A\\left(1 - \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right) \\right|\n$$\n由于 $A  0$ 且对于 $t \\ge 0$ 有 $1 - \\Phi(t/\\sigma) \\ge 0$，所以绝对值是多余的。需要最大化的函数在 $t \\ge 0$ 上是单调递减的，因此上确界在 $t=0$ 处：\n$$\nM_{refl} = A\\left(1 - \\Phi(0)\\right) = A\\left(1 - \\frac{1}{2}\\right) = \\frac{A}{2}\n$$\n所需的无量纲分数为 $M_{refl}/A = \\frac{1}{2}$。\n\n**3. 常数扩展填充**\n填充信号 $\\tilde{x}_{const}(t)$ 定义为当 $t \\ge 0$ 时 $\\tilde{x}_{const}(t) = x(t)$，当 $t  0$ 时 $\\tilde{x}_{const}(t) = x(0)$。\n给定当 $t \\ge 0$ 时 $x(t) = B+A$，我们有 $x(0)=B+A$。因此：\n- 当 $t \\ge 0$ 时，$\\tilde{x}_{const}(t) = B+A$。\n- 当 $t  0$ 时，$\\tilde{x}_{const}(t) = x(0) = B+A$。\n这得到对于所有 $t \\in \\mathbb{R}$ 都有 $\\tilde{x}_{const}(t) = B+A$，这与本特定问题中反射填充情况下的填充信号相同。\n因此，所有后续计算都与反射填充的情况相同。\n$$\n\\tilde{y}_{const}(t) = B+A\n$$\n$$\nM_{const} = \\frac{A}{2}\n$$\n所需的无量纲分数为 $M_{const}/A = \\frac{1}{2}$。\n\n按指定顺序（零填充、反射填充、常数扩展填充），三个无量纲伪影幅度 $M/A$ 分别是 $\\frac{B}{2A}$、$\\frac{1}{2}$ 和 $\\frac{1}{2}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{B}{2A}  \\frac{1}{2}  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}