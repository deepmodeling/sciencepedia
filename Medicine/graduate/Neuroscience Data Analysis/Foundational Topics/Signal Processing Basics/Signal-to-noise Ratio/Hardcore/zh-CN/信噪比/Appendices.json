{
    "hands_on_practices": [
        {
            "introduction": "掌握信噪比（SNR）的第一步是能够根据信号和噪声的功率进行基本计算。这个练习将指导你完成这一核心任务，让你能够熟练地在神经信号分析中，将信号功率和噪声功率转化为线性和分贝（dB）这两种常用的信噪比标度。理解这两种表示方法对于准确量化和报告数据质量至关重要。",
            "id": "4192874",
            "problem": "您正在分析来自初级视皮层的局部场电位（LFP）的长时间平稳细胞外记录。测得的时间序列建模为 $x(t) = s(t) + n(t)$，其中 $s(t)$ 是神经信号，$n(t)$ 是加性噪声。假设 $s(t)$ 和 $n(t)$ 是广义平稳的、相互独立的，并且 $n(t)$ 是零均值加性高斯白噪声（AWGN）。通过对 $x^{2}(t)$ 的长时间平均和对带宽的频谱积分，神经信号的平均功率估计为 $P_{s} = 2 \\times 10^{-9}\\,\\mathrm{W}$，噪声的平均功率估计为 $P_{n} = 5 \\times 10^{-10}\\,\\mathrm{W}$。从平稳随机过程的功率定义出发，其中对于具有有限二阶矩的过程 $y(t)$，平均功率为 $P_{y} = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} y^{2}(t)\\,dt = \\mathbb{E}[y^{2}(t)]$，并使用应用于功率比的标准工程分贝定义，从 $P_{s}$ 和 $P_{n}$ 推导出线性的信噪比和以分贝表示的信噪比。然后计算它们的数值，并简要解释在固定积分时间的基于能量的检测下，这些值对于 $x(t)$ 中 $s(t)$ 的可检测性意味着什么。将线性信噪比表示为纯比率，将分贝信噪比表示为分贝。将您的数值结果四舍五入到四位有效数字。在需要时使用瓦特（$\\mathrm{W}$）作为功率单位，并用分贝（dB）表示分贝信噪比。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确、客观，并包含完整解决方案所需的所有必要信息。它提出了一个应用于神经科学数据分析的标准信号处理场景。\n\n我们给定一个测量的时间序列 $x(t)$，建模为神经信号 $s(t)$ 和加性噪声 $n(t)$ 的和：\n$$x(t) = s(t) + n(t)$$\n问题陈述 $s(t)$ 和 $n(t)$ 是广义平稳（WSS）随机过程，它们相互独立，且噪声 $n(t)$ 是零均值的，即 $\\mathbb{E}[n(t)] = 0$。\n\n一个广义平稳过程 $y(t)$ 的平均功率定义为其二阶矩：\n$$P_{y} = \\mathbb{E}[y^{2}(t)]$$\n我们已知神经信号的平均功率 $P_{s}$ 和噪声的平均功率 $P_{n}$：\n$$P_{s} = \\mathbb{E}[s^{2}(t)] = 2 \\times 10^{-9}\\,\\mathrm{W}$$\n$$P_{n} = \\mathbb{E}[n^{2}(t)] = 5 \\times 10^{-10}\\,\\mathrm{W}$$\n\n线性信噪比，下文记作 $\\text{SNR}_{\\text{linear}}$，定义为信号功率与噪声功率之比。\n$$\\text{SNR}_{\\text{linear}} = \\frac{P_{s}}{P_{n}}$$\n代入给定的数值：\n$$\\text{SNR}_{\\text{linear}} = \\frac{2 \\times 10^{-9}\\,\\mathrm{W}}{5 \\times 10^{-10}\\,\\mathrm{W}} = \\frac{2 \\times 10^{-9}}{0.5 \\times 10^{-9}} = 4$$\n作为一个纯比率，四舍五入到四位有效数字后为 $4.000$。\n\n以分贝表示的信噪比，下文记作 $\\text{SNR}_{\\text{dB}}$，是基于功率比的以10为底的对数定义的。标准的工程定义是：\n$$\\text{SNR}_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{P_{s}}{P_{n}}\\right) = 10 \\log_{10}(\\text{SNR}_{\\text{linear}})$$\n代入计算出的线性信噪比值：\n$$\\text{SNR}_{\\text{dB}} = 10 \\log_{10}(4)$$\n为了计算数值：\n$$\\text{SNR}_{\\text{dB}} = 10 \\log_{10}(2^{2}) = 20 \\log_{10}(2)$$\n使用 $\\log_{10}(2) \\approx 0.30103$ 的值，我们得到：\n$$\\text{SNR}_{\\text{dB}} \\approx 20 \\times 0.30103 = 6.0206\\,\\mathrm{dB}$$\n将此结果四舍五入到四位有效数字，得到 $6.021\\,\\mathrm{dB}$。\n\n为了进行解释，我们考虑一个基于能量的检测器，它在固定的时间间隔 $T$ 内对信号的平方进行积分。在此区间内，测得信号 $x(t)$ 的总能量为 $E_x = \\int_0^T x^2(t)\\,dt$。期望能量为 $\\mathbb{E}[E_x] = \\mathbb{E}[\\int_0^T (s(t)+n(t))^2\\,dt]$。由于 $s(t)$ 和 $n(t)$ 的独立性以及 $n(t)$ 的零均值特性，总功率为 $P_x = P_s + P_n$。因此，期望总能量为 $\\mathbb{E}[E_x] = (P_s + P_n)T$。\n线性信噪比为 $4$ 意味着信号功率是噪声功率的四倍。约 $6.021\\,\\mathrm{dB}$ 的分贝信噪比证实信号明显强于噪声；一个常见的经验法则是，当 $\\text{SNR}_{\\text{dB}} > 3\\,\\mathrm{dB}$（即信号功率大于噪声功率的两倍）时，信号被认为是清晰可检测的。\n在这种情况下，在任何给定的积分窗口内，来自信号的能量贡献 $P_s T$ 是来自噪声的能量贡献 $P_n T$ 的四倍。因此，一个对测量能量设定阈值的基于能量的检测器可以很可靠地区分信号加噪声的情况和只有噪声的情况。因此，在复合测量 $x(t)$ 中信号 $s(t)$ 的可检测性相当好。",
            "answer": "$$\\boxed{\\begin{pmatrix} 4.000 & 6.021 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在神经科学实验中，我们常常需要从强噪声中提取微弱的生物信号，例如事件相关电位（ERP）。信号平均法是一种用于提高信噪比的强大核心技术。这个练习模拟了一个典型的场景，让你通过计算来确定需要叠加平均多少次试验才能达到理想的信号质量，从而深入理解信号平均法是如何通过利用信号的相干性和噪声的非相干性来有效提升信噪比的。",
            "id": "1333055",
            "problem": "在神经科学研究中，一个常见的挑战是检测淹没在强得多的随机背景噪声中的微弱周期性生物信号。提高信号可见度的一种标准方法是同步平均法。考虑一个场景，实验者正在使用脑电图 (EEG) 测量诱发电位。感兴趣的信号是与刺激时间锁定的重复性神经响应，而噪声则由不相关的背景脑活动和仪器噪声组成。\n\n对于单次试验，信噪比 (SNR)——定义为信号功率与噪声功率之比——测量为 5.0 dB。为了进行可靠的分析，研究人员需要处理数据，使最终的信噪比至少达到 40.0 dB。这通过对多次试验记录的波形进行同步平均来实现。\n\n假设在多次试验中，信号是相干叠加的，而噪声是非相干叠加（正交叠加）的，确定为达到所需信噪比必须平均的最小整数试验次数 $N$。",
            "solution": "设单次试验在线性功率单位下的信噪比为 $S_{1}$。根据功率比的分贝定义，\n$$\n\\text{SNR}_{1,\\mathrm{dB}}=10\\log_{10}(S_{1})=5.0 \\quad\\Rightarrow\\quad S_{1}=10^{\\frac{5.0}{10}}.\n$$\n当对 $N$ 次时间锁定的试验进行平均时，信号相干叠加，而噪声由于不相关而正交叠加。对于平均后的波形（即对总和应用了 $\\frac{1}{N}$ 的因子），信号功率保持不变，而噪声功率减少了 $N$ 倍。因此，平均后在线性功率单位下的信噪比为\n$$\nS_{N}=N\\,S_{1}.\n$$\n转换为分贝，\n$$\n\\text{SNR}_{N,\\mathrm{dB}}=10\\log_{10}(S_{N})=10\\log_{10}(N\\,S_{1})=10\\log_{10}(N)+10\\log_{10}(S_{1})=10\\log_{10}(N)+5.0.\n$$\n要求是 $\\text{SNR}_{N,\\mathrm{dB}}\\geq 40.0$，因此\n$$\n10\\log_{10}(N)+5.0\\geq 40.0 \\;\\Rightarrow\\; 10\\log_{10}(N)\\geq 35.0 \\;\\Rightarrow\\; \\log_{10}(N)\\geq 3.5 \\;\\Rightarrow\\; N\\geq 10^{3.5}.\n$$\n由于 $N$ 必须是整数，\n$$\nN_{\\min}=\\left\\lceil 10^{3.5}\\right\\rceil=\\left\\lceil 10^{3}\\sqrt{10}\\right\\rceil=\\left\\lceil 1000\\sqrt{10}\\right\\rceil.\n$$\n使用 $\\sqrt{10}\\approx 3.16227766$，我们得到 $1000\\sqrt{10}\\approx 3162.27766$，所以\n$$\nN_{\\min}=3163.\n$$",
            "answer": "$$\\boxed{3163}$$"
        },
        {
            "introduction": "高信噪比的最终目的往往是为了做出更可靠的决策，例如，判断一个神经元是否发放了动作电位。这个练习将信噪比的概念与信号检测理论（Signal Detection Theory, SDT）直接联系起来，让你在一个模拟的尖峰检测任务中，计算给定信噪比下的检测性能指标，如真阳性率（TPR）和假阳性率（FPR）。通过这个练习，你将学会如何量化信噪比对科学结论可靠性的直接影响，并了解奈曼-皮尔逊准则（Neyman-Pearson lemma）在优化检测阈值中的应用。",
            "id": "4192868",
            "problem": "一个皮层微电极记录胞外电压，并应用一个白化匹配滤波器来检测短暂的脉冲状事件。设标量检测统计量记为 $T$。由于白化，在仅有噪声的条件下，匹配滤波器输出端的加性背景噪声被建模为均值为零、方差为一的高斯分布。具体来说，在原假设 $H_{0}$（仅有噪声）下，$T$ 的分布为 $T \\sim \\mathcal{N}(0, 1)$；在备择假设 $H_{1}$（存在信号）下，$T$ 的分布为 $T \\sim \\mathcal{N}(\\mu_{1}, 1)$，其中均值偏移 $\\mu_{1}$ 是由脉冲模板的存在引起的。\n\n在信号检测论的意义下，将信噪比 (SNR) 定义为敏感性指数 $d'$，由 $d' = (\\mu_{1} - \\mu_{0})/\\sigma$ 给出，其中 $\\mu_{0}$ 和 $\\sigma$ 分别是 $H_{0}$ 下 $T$ 的均值和标准差。在此白化设置中，$\\mu_{0} = 0$ 且 $\\sigma = 1$，因此 $d' = \\mu_{1}$。假设在此实验样本中，已知匹配滤波器输出的敏感性指数为 $d' = \\mu_{1} = 3.5$。\n\n使用一个固定的决策阈值 $ \\tau $，每当 $T \\geq \\tau$ 时，就判定存在一个脉冲。考虑阈值 $\\tau = 1.8$。\n\n任务：\n1. 从 $H_{0}$ 和 $H_{1}$ 下的高斯模型定义以及 SNR 定义 $d'$ 出发，用标准正态累积分布函数推导假阳性率 $\\mathrm{FPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{0})$ 和真阳性率 $\\mathrm{TPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{1})$ 的表达式。\n2. 使用 $d' = 3.5$ 和 $\\tau = 1.8$，计算 $\\mathrm{FPR}$ 和 $\\mathrm{TPR}$ 的数值。将所有概率表示为小数（而非百分比）。\n3. 使用 Neyman–Pearson 引理（该引理保证了在固定假阳性率下对于简单假设的最强检验），为指定的高斯模型推导似然比检验，并证明最优检验是针对 $T$ 的阈值检验。对于假阳性率约束 $\\alpha = 0.01$，确定相应的 Neyman–Pearson 阈值 $\\tau_{\\mathrm{NP}}$ 并计算 $H_{1}$ 下相关的 $\\mathrm{TPR}$。\n4. 将所有数值结果四舍五入到四位有效数字。将你的最终答案报告为一个单行矩阵，按顺序包含四个量 $[\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau), \\tau_{\\mathrm{NP}}, \\mathrm{TPR}(\\tau_{\\mathrm{NP}})]$。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法恰当。\n\n### 步骤 1：提取已知条件\n- 检测统计量是一个记为 $T$ 的标量。\n- 在原假设 $H_{0}$（仅有噪声）下，$T$ 的分布为 $T \\sim \\mathcal{N}(0, 1)$，其中 $\\mathcal{N}(\\mu, \\sigma^2)$ 是均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯分布。\n- 在备择假设 $H_{1}$（存在信号）下，$T$ 的分布为 $T \\sim \\mathcal{N}(\\mu_{1}, 1)$。\n- 敏感性指数定义为 $d' = (\\mu_{1} - \\mu_{0})/\\sigma$。\n- 对于本问题，$\\mu_{0} = 0$ 且 $H_0$ 下的标准差为 $\\sigma = 1$，因此 $d' = \\mu_{1}$。\n- 给定的敏感性指数数值为 $d' = \\mu_{1} = 3.5$。\n- 通过将 $T$ 与固定阈值 $\\tau$ 进行比较来做出决策。如果 $T \\geq \\tau$，则判定存在一个脉冲。\n- 对于前两个任务，给定的阈值为 $\\tau = 1.8$。\n- 假阳性率定义为 $\\mathrm{FPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{0})$。\n- 真阳性率定义为 $\\mathrm{TPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{1})$。\n- 对于第三个任务，给定的假阳性率约束为 $\\alpha = 0.01$。\n- 所有最终数值结果必须四舍五入到四位有效数字。\n- 最终答案必须是一个包含四个特定量的行矩阵：$[\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau), \\tau_{\\mathrm{NP}}, \\mathrm{TPR}(\\tau_{\\mathrm{NP}})]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是信号检测论 (SDT) 和假设检验的一个标准应用，特别是在分析神经科学数据（脉冲检测）的背景下。对白化匹配滤波器输出使用高斯模型、$d'$、$\\mathrm{FPR}$ 和 $\\mathrm{TPR}$ 的定义，以及 Neyman-Pearson 引理的应用，都是统计信号处理中基本且科学上正确的概念。该问题是良定的，提供了所有必要的参数和定义。语言客观且无歧义。所提供的数值（$d'=3.5$, $\\tau=1.8$, $\\alpha=0.01$）在此类应用中是符合实际的。因此，该问题被认为是有效的。\n\n### 步骤 3：进行求解\n\n令 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数 (CDF)，定义为 $\\Phi(z) = \\mathbb{P}(Z \\leq z)$，其中 $Z \\sim \\mathcal{N}(0, 1)$。相应的生存函数为 $1 - \\Phi(z) = \\mathbb{P}(Z > z)$。\n\n**任务 1：推导 FPR 和 TPR 的表达式。**\n\n假阳性率（$\\mathrm{FPR}$）是在 $H_0$ 为真时做出 $H_1$ 决策的概率。这种情况发生在检验统计量 $T$ 超过阈值 $\\tau$ 时，且此时 $T$ 服从 $H_0$ 下的分布。\n$$ \\mathrm{FPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{0}) $$\n在 $H_0$ 下，$T \\sim \\mathcal{N}(0, 1)$。因此，$T$ 是一个标准正态变量。该概率为：\n$$ \\mathrm{FPR} = \\mathbb{P}(T \\geq \\tau) = 1 - \\mathbb{P}(T  \\tau) = 1 - \\Phi(\\tau) $$\n\n真阳性率（$\\mathrm{TPR}$），也称为检测概率或敏感度，是在 $H_1$ 为真时做出 $H_1$ 决策的概率。\n$$ \\mathrm{TPR} = \\mathbb{P}(T \\geq \\tau \\mid H_{1}) $$\n在 $H_1$ 下，$T \\sim \\mathcal{N}(\\mu_1, 1)$。为了使用标准正态 CDF 计算这个概率，我们对变量 $T$ 进行标准化。令 $Z = (T - \\mu_{1}) / 1$。那么 $Z \\sim \\mathcal{N}(0, 1)$。不等式 $T \\geq \\tau$ 等价于 $T - \\mu_{1} \\geq \\tau - \\mu_{1}$。\n$$ \\mathrm{TPR} = \\mathbb{P}(Z \\geq \\tau - \\mu_{1}) = 1 - \\Phi(\\tau - \\mu_{1}) $$\n使用给定的定义 $d' = \\mu_{1}$，表达式变为：\n$$ \\mathrm{TPR} = 1 - \\Phi(\\tau - d') $$\n\n**任务 2：计算 FPR 和 TPR 的数值。**\n\n给定 $d' = 3.5$ 和 $\\tau = 1.8$。\n假阳性率为：\n$$ \\mathrm{FPR} = 1 - \\Phi(1.8) $$\n使用标准正态分布表或计算器，$\\Phi(1.8) \\approx 0.96407$。\n$$ \\mathrm{FPR} \\approx 1 - 0.96407 = 0.03593 $$\n四舍五入到四位有效数字，$\\mathrm{FPR} = 0.03593$。\n\n真阳性率为：\n$$ \\mathrm{TPR} = 1 - \\Phi(1.8 - 3.5) = 1 - \\Phi(-1.7) $$\n利用正态 CDF 的性质 $\\Phi(-z) = 1 - \\Phi(z)$，我们有：\n$$ \\mathrm{TPR} = 1 - (1 - \\Phi(1.7)) = \\Phi(1.7) $$\n使用表或计算器，$\\Phi(1.7) \\approx 0.95543$。\n四舍五入到四位有效数字，$\\mathrm{TPR} = 0.9554$。\n\n**任务 3：应用 Neyman–Pearson 引理。**\n\nNeyman–Pearson (NP) 引理为给定的假阳性率 $\\alpha$ 提供了最强检验。该检验基于似然比 $\\Lambda(t) = p(t \\mid H_{1}) / p(t \\mid H_{0})$，其中 $p(t \\mid H_i)$ 是假设 $H_i$ 下的概率密度函数 (PDF)。\n$H_0$ 的 PDF 为 $p(t \\mid H_{0}) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{t^2}{2}\\right)$。\n$H_1$ 的 PDF 为 $p(t \\mid H_{1}) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t-\\mu_1)^2}{2}\\right)$。\n\n似然比为：\n$$ \\Lambda(t) = \\frac{\\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t-\\mu_1)^2}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{t^2}{2}\\right)} = \\exp\\left( -\\frac{(t-\\mu_1)^2 - t^2}{2} \\right) $$\n$$ \\Lambda(t) = \\exp\\left( -\\frac{t^2 - 2t\\mu_1 + \\mu_1^2 - t^2}{2} \\right) = \\exp\\left( \\frac{2t\\mu_1 - \\mu_1^2}{2} \\right) = \\exp\\left( t\\mu_1 - \\frac{\\mu_1^2}{2} \\right) $$\nNP 检验在 $\\Lambda(t) \\geq \\eta$ 时判定 $H_1$ 成立，其中 $\\eta$ 是某个阈值。对两边取自然对数（因为 $\\ln$ 是一个单调函数）：\n$$ t\\mu_1 - \\frac{\\mu_1^2}{2} \\geq \\ln(\\eta) $$\n因为 $\\mu_1 = 3.5  0$，我们可以重排不等式以分离 $t$：\n$$ t \\geq \\frac{\\ln(\\eta) + \\frac{\\mu_1^2}{2}}{\\mu_1} $$\n这表明似然比检验等价于对统计量 $T$ 的阈值检验，$T \\geq \\tau_{\\mathrm{NP}}$，其中 $\\tau_{\\mathrm{NP}}$ 是一个新的阈值。\n\n我们必须找到满足假阳性率约束 $\\alpha = 0.01$ 的阈值 $\\tau_{\\mathrm{NP}}$。\n$$ \\mathbb{P}(T \\geq \\tau_{\\mathrm{NP}} \\mid H_{0}) = \\alpha = 0.01 $$\n在 $H_0$ 下，$T \\sim \\mathcal{N}(0, 1)$，所以 $1 - \\Phi(\\tau_{\\mathrm{NP}}) = 0.01$，这意味着 $\\Phi(\\tau_{\\mathrm{NP}}) = 0.99$。\n我们需要找到标准正态分布在 $0.99$ 处的逆 CDF：\n$$ \\tau_{\\mathrm{NP}} = \\Phi^{-1}(0.99) \\approx 2.326348 $$\n四舍五入到四位有效数字，$\\tau_{\\mathrm{NP}} = 2.326$。\n\n现在，我们计算与此 Neyman-Pearson 阈值 $\\tau_{\\mathrm{NP}}$ 相关的 $\\mathrm{TPR}$。\n$$ \\mathrm{TPR}(\\tau_{\\mathrm{NP}}) = \\mathbb{P}(T \\geq \\tau_{\\mathrm{NP}} \\mid H_{1}) = 1 - \\Phi(\\tau_{\\mathrm{NP}} - \\mu_1) $$\n使用未四舍五入的 $\\tau_{\\mathrm{NP}}$ 值和 $\\mu_1 = 3.5$：\n$$ \\mathrm{TPR}(\\tau_{\\mathrm{NP}}) = 1 - \\Phi(2.326348 - 3.5) = 1 - \\Phi(-1.173652) = \\Phi(1.173652) $$\n$$ \\mathrm{TPR}(\\tau_{\\mathrm{NP}}) \\approx 0.879738 $$\n四舍五入到四位有效数字，$\\mathrm{TPR}(\\tau_{\\mathrm{NP}}) = 0.8797$。\n\n**任务 4：报告最终答案。**\n\n需要报告的四个量是 $[\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau), \\tau_{\\mathrm{NP}}, \\mathrm{TPR}(\\tau_{\\mathrm{NP}})]$。\n- $\\mathrm{FPR}(\\tau=1.8) = 0.03593$\n- $\\mathrm{TPR}(\\tau=1.8) = 0.9554$\n- $\\tau_{\\mathrm{NP}} = 2.326$\n- $\\mathrm{TPR}(\\tau_{\\mathrm{NP}}) = 0.8797$\n\n按要求将这些数组合成一个单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.03593  0.9554  2.326  0.8797\n\\end{pmatrix}\n}\n$$"
        }
    ]
}