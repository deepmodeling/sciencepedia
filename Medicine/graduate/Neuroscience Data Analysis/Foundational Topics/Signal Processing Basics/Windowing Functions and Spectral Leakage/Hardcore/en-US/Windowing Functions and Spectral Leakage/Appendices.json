{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring the mathematical origins of spectral leakage from first principles. This exercise demonstrates how applying a rectangular window to a finite signal segment—the default operation in any standard Fourier analysis—inevitably leads to the smearing of spectral energy. By analytically deriving the power of a non-bin-centered sinusoid that 'leaks' into adjacent frequency bins, you will gain a concrete intuition for the behavior of the Dirichlet kernel, which is the Fourier transform of the rectangular window.",
            "id": "4204104",
            "problem": "You are analyzing a local field potential segment in a cortical recording and wish to quantify spectral leakage caused by using a rectangular window in the Discrete Fourier Transform (DFT). Consider a length-$N$ time series windowed by a rectangular window, where the measured signal segment contains a single complex sinusoid\n$$\nx[n] = A \\exp\\!\\Big(j\\big(2\\pi \\tfrac{k_{0}+\\varepsilon}{N}\\,n + \\phi\\big)\\Big), \\quad n=0,1,\\dots,N-1,\n$$\nwith amplitude $A \\in \\mathbb{C}$, arbitrary phase $\\phi \\in \\mathbb{R}$, an integer bin index $k_{0}$, and a non-bin-centered fractional offset $0<\\varepsilon<\\tfrac{1}{2}$. The $N$-point Discrete Fourier Transform (DFT) is defined by\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\Big(-j\\,2\\pi \\tfrac{k}{N}\\,n\\Big), \\quad k=0,1,\\dots,N-1.\n$$\nStarting from the DFT definition and first principles about finite geometric sums, derive a closed-form expression for the total leakage power into the two immediate neighboring DFT bins $k=k_{0}-1$ and $k=k_{0}+1$ produced by the rectangular window when the sinusoid is not bin-centered. That is, compute\n$$\nP_{\\text{leak}} \\equiv |X[k_{0}-1]|^{2} + |X[k_{0}+1]|^{2}\n$$\nas a closed-form analytic expression in terms of $A$, $N$, and $\\varepsilon$. Provide your final answer as a single simplified analytic expression. Do not substitute numerical values. Express the final answer without units.",
            "solution": "The problem statement is a well-posed and scientifically grounded exercise in digital signal processing, a core component of quantitative neuroscience. It requires the derivation of a specific quantity related to spectral leakage from first principles. The problem is valid and will be solved as follows.\n\nOur goal is to compute the total leakage power, $P_{\\text{leak}}$, in the DFT bins adjacent to the central frequency component of a windowed complex sinusoid. The signal is given by\n$$\nx[n] = A \\exp\\left(j\\left(2\\pi \\frac{k_{0}+\\varepsilon}{N}\\,n + \\phi\\right)\\right), \\quad n=0, 1, \\dots, N-1\n$$\nwhere $A \\in \\mathbb{C}$ is a complex amplitude, $\\phi$ is an arbitrary phase, $k_{0}$ is an integer bin index, and $0 < \\varepsilon < \\frac{1}{2}$ is the fractional frequency offset.\n\nThe $N$-point Discrete Fourier Transform (DFT) is defined as\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j\\,2\\pi \\frac{k}{N}\\,n\\right)\n$$\nWe begin by substituting the expression for $x[n]$ into the DFT definition:\n$$\nX[k] = \\sum_{n=0}^{N-1} \\left[ A \\exp\\left(j\\left(2\\pi \\frac{k_{0}+\\varepsilon}{N}\\,n + \\phi\\right)\\right) \\right] \\exp\\left(-j\\,2\\pi \\frac{k}{N}\\,n\\right)\n$$\nWe can factor out the terms that do not depend on the summation index $n$, which are $A$ and $\\exp(j\\phi)$, and combine the exponential terms inside the sum:\n$$\nX[k] = A \\exp(j\\phi) \\sum_{n=0}^{N-1} \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon}{N}\\,n - j\\,2\\pi \\frac{k}{N}\\,n\\right)\n$$\n$$\nX[k] = A \\exp(j\\phi) \\sum_{n=0}^{N-1} \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\,n\\right)\n$$\nThis sum is a finite geometric series of the form $\\sum_{n=0}^{N-1} r^n$, with the common ratio $r$ given by\n$$\nr = \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)\n$$\nThe sum of a finite geometric series is given by the formula $\\sum_{n=0}^{N-1} r^n = \\frac{1-r^N}{1-r}$, provided that $r \\neq 1$. The condition $r=1$ would imply that the exponent is an integer multiple of $j2\\pi$. This would mean that $\\frac{k_{0}+\\varepsilon-k}{N}$ is an integer. However, since $k_0$ and $k$ are integers and $0 < \\varepsilon < \\frac{1}{2}$, the term $k_0+\\varepsilon-k$ is never an integer multiple of $N$ (unless $N=1$, in which case $k_0+\\varepsilon-k$ is not an integer). Thus, $r \\neq 1$ for all integer values of $k$, and the formula is applicable.\n\nLet's compute $r^N$:\n$$\nr^N = \\left[\\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)\\right]^N = \\exp\\left(j\\,2\\pi (k_{0}+\\varepsilon-k)\\right)\n$$\nSince $k_0$ and $k$ are integers, $\\exp(j\\,2\\pi(k_0-k)) = (\\exp(j2\\pi))^{k_0-k} = 1^{k_0-k} = 1$. Therefore,\n$$\nr^N = \\exp(j\\,2\\pi\\varepsilon)\n$$\nSubstituting this into the sum formula, we get:\n$$\n\\sum_{n=0}^{N-1} r^n = \\frac{1 - \\exp(j\\,2\\pi\\varepsilon)}{1 - \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)}\n$$\nNow, we can write the full expression for $X[k]$:\n$$\nX[k] = A \\exp(j\\phi) \\frac{1 - \\exp(j\\,2\\pi\\varepsilon)}{1 - \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)}\n$$\nTo simplify this expression and find its magnitude, we use the identity $1 - \\exp(j\\theta) = \\exp(j\\theta/2)(\\exp(-j\\theta/2) - \\exp(j\\theta/2)) = -2j\\exp(j\\theta/2)\\sin(\\theta/2)$. Applying this to the numerator and denominator:\n- Numerator: $1 - \\exp(j\\,2\\pi\\varepsilon) = -2j\\exp(j\\pi\\varepsilon)\\sin(\\pi\\varepsilon)$\n- Denominator: $1 - \\exp\\left(j\\,2\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right) = -2j\\exp\\left(j\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)\\sin\\left(\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)$\n\nSubstituting these back into the expression for $X[k]$:\n$$\nX[k] = A \\exp(j\\phi) \\frac{-2j\\exp(j\\pi\\varepsilon)\\sin(\\pi\\varepsilon)}{-2j\\exp\\left(j\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)\\sin\\left(\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)}\n$$\n$$\nX[k] = A \\exp(j\\phi) \\exp\\left(j\\pi\\varepsilon - j\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right) \\frac{\\sin(\\pi\\varepsilon)}{\\sin\\left(\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)}\n$$\nThis expression is the discrete-time Fourier transform of the rectangularly windowed sinusoid, which is a scaled and frequency-shifted Dirichlet kernel.\n\nWe need to compute the power at specific bins, which is $|X[k]|^2$. The magnitude of any complex exponential term of the form $\\exp(j\\theta)$ is $1$. The phase term $\\exp(j\\phi)$ and the derived phase term also have unit magnitude. Therefore, the squared magnitude is:\n$$\n|X[k]|^2 = |A|^2 \\left| \\frac{\\sin(\\pi\\varepsilon)}{\\sin\\left(\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)} \\right|^2 = |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{k_{0}+\\varepsilon-k}{N}\\right)}\n$$\nThe problem asks for the total leakage power into the two immediate neighboring bins, $k=k_0-1$ and $k=k_0+1$. We evaluate $|X[k]|^2$ for these two values of $k$.\n\nFor the bin $k=k_0-1$:\nThe argument of the sine function in the denominator becomes $\\pi \\frac{k_0+\\varepsilon-(k_0-1)}{N} = \\pi \\frac{1+\\varepsilon}{N}$.\nThe power in this bin is:\n$$\n|X[k_0-1]|^2 = |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{1+\\varepsilon}{N}\\right)}\n$$\nFor the bin $k=k_0+1$:\nThe argument of the sine function in the denominator becomes $\\pi \\frac{k_0+\\varepsilon-(k_0+1)}{N} = \\pi \\frac{\\varepsilon-1}{N}$.\nThe power in this bin is:\n$$\n|X[k_0+1]|^2 = |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{\\varepsilon-1}{N}\\right)}\n$$\nUsing the property $\\sin(-x) = -\\sin(x)$, we have $\\sin^2(-x) = (-\\sin(x))^2 = \\sin^2(x)$. Thus:\n$$\n\\sin^2\\left(\\pi \\frac{\\varepsilon-1}{N}\\right) = \\sin^2\\left(-\\pi \\frac{1-\\varepsilon}{N}\\right) = \\sin^2\\left(\\pi \\frac{1-\\varepsilon}{N}\\right)\n$$\nSo, the power in the $k=k_0+1$ bin is:\n$$\n|X[k_0+1]|^2 = |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{1-\\varepsilon}{N}\\right)}\n$$\nThe total leakage power $P_{\\text{leak}}$ is the sum of the power in these two bins:\n$$\nP_{\\text{leak}} = |X[k_0-1]|^2 + |X[k_0+1]|^2\n$$\n$$\nP_{\\text{leak}} = |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{1+\\varepsilon}{N}\\right)} + |A|^2 \\frac{\\sin^2(\\pi\\varepsilon)}{\\sin^2\\left(\\pi \\frac{1-\\varepsilon}{N}\\right)}\n$$\nFactoring out the common term $|A|^2 \\sin^2(\\pi\\varepsilon)$, we arrive at the final closed-form expression:\n$$\nP_{\\text{leak}} = |A|^2 \\sin^2(\\pi\\varepsilon) \\left[ \\frac{1}{\\sin^2\\left(\\frac{\\pi(1+\\varepsilon)}{N}\\right)} + \\frac{1}{\\sin^2\\left(\\frac{\\pi(1-\\varepsilon)}{N}\\right)} \\right]\n$$\nThis expression depends only on $|A|^2$, $N$, and $\\varepsilon$, as required.",
            "answer": "$$\n\\boxed{|A|^{2} \\sin^{2}(\\pi\\varepsilon) \\left[ \\frac{1}{\\sin^{2}\\left(\\frac{\\pi(1+\\varepsilon)}{N}\\right)} + \\frac{1}{\\sin^{2}\\left(\\frac{\\pi(1-\\varepsilon)}{N}\\right)} \\right]}\n$$"
        },
        {
            "introduction": "After deriving the mathematical basis of leakage from a rectangular window , we now investigate the other critical consequence: its mainlobe width, which dictates spectral resolution. This practice challenges you to determine when two closely spaced sinusoids can be distinguished in a spectrum, moving beyond simple heuristics to a rigorous, computational definition of resolvability. You will see firsthand how the window length and the exact frequencies of the components interact to either merge or separate their spectral peaks.",
            "id": "4204076",
            "problem": "A neuroscience laboratory is analyzing an electroencephalography (EEG) segment to distinguish two oscillatory components close in frequency. The observation is modeled as a sum of two sinusoids plus truncation by a finite-length window. You are to determine, by principled spectral analysis, conditions where a rectangular window fails to separate two nearby peaks due to the mainlobe width of the window-induced spectral kernel. All computations must be done on synthetic signals as specified below.\n\nBase assumptions and definitions:\n- The discrete-time signal is $x[n] = a_1 \\cos\\!\\left(2\\pi \\frac{f_1}{f_s} n + \\phi_1\\right) + a_2 \\cos\\!\\left(2\\pi \\frac{f_2}{f_s} n + \\phi_2\\right)$ for $n \\in \\{0,1,\\dots,N-1\\}$, where $f_s$ is the sampling frequency in $\\mathrm{Hz}$, $N$ is the window length in samples, $f_1$ and $f_2$ are sinusoid frequencies in $\\mathrm{Hz}$, $a_1$ and $a_2$ are amplitudes, and $\\phi_1$ and $\\phi_2$ are phases in radians.\n- The rectangular window is $w[n]=1$ for $0\\le n \\le N-1$ and $w[n]=0$ otherwise. The windowed signal is $x_w[n]=x[n] w[n]$.\n- The Discrete Fourier Transform (DFT) is defined for $k\\in\\{0,1,\\dots,N-1\\}$ by $X[k]=\\sum_{n=0}^{N-1} x_w[n] e^{-j 2\\pi kn/N}$, and its Fast Fourier Transform (FFT) is an efficient algorithm to compute samples of the DFT. Multiplication in time corresponds to convolution in frequency under the Discrete-Time Fourier Transform (DTFT). The spectral response of the rectangular window has a sinc-shaped magnitude with a mainlobe whose first zeros are at frequency offsets of $\\pm \\Delta f$, where $\\Delta f = f_s/N$.\n- The DFT bin spacing is $\\Delta f = f_s/N$ in $\\mathrm{Hz}$, and the mainlobe width between first zeros of the rectangular window is $2\\,\\Delta f$ in $\\mathrm{Hz}$.\n\nTask:\n- For each test case below, generate $x[n]$ with $a_1=a_2=1$ and $\\phi_1=\\phi_2=0$ (radians), apply the rectangular window of length $N$, and compute a finely sampled magnitude spectrum $|X(f)|$ by zero-padding the windowed sequence prior to the FFT to achieve a frequency grid with resolution substantially finer than $\\Delta f$. Use this to decide if two resolvable peaks exist near the true sinusoid frequencies.\n- Define a peak-resolvability decision as follows. Let $f_{\\min}=\\min(f_1,f_2)$ and $f_{\\max}=\\max(f_1,f_2)$. Consider a search band $[f_{\\min}-1, f_{\\max}+1]$ in $\\mathrm{Hz}$. Declare that the two peaks are resolved if and only if all of the following hold:\n  1. There exist at least two local maxima of $|X(f)|$ in the search band with prominence at least a fixed fraction $\\alpha$ of the maximum magnitude in the band, with $\\alpha$ specified below.\n  2. The frequency separation between the two most prominent maxima in the band is at least $0.49\\,\\mathrm{Hz}$.\n  3. The minimum magnitude between these two maxima (the valley) is at most a fraction $\\tau$ of the smaller of the two peak magnitudes, with $\\tau$ specified below.\n- Use $\\alpha=0.2$ and $\\tau=0.85$ for all test cases. Output a boolean `True` if the above conditions are satisfied, and `False` otherwise.\n\nTest suite:\n- Case A (bin-centered, separation equals one bin of the rectangular window): $f_s=500\\,\\mathrm{Hz}$, $N=1000$, $f_1=10.0\\,\\mathrm{Hz}$, $f_2=10.5\\,\\mathrm{Hz}$.\n- Case B (off-bin detuning by a quarter bin each, same nominal separation): $f_s=500\\,\\mathrm{Hz}$, $N=1000$, $f_1=10.125\\,\\mathrm{Hz}$, $f_2=10.625\\,\\mathrm{Hz}$.\n- Case C (separation less than one bin): $f_s=500\\,\\mathrm{Hz}$, $N=1000$, $f_1=10.0\\,\\mathrm{Hz}$, $f_2=10.4\\,\\mathrm{Hz}$.\n- Case D (shorter window makes one-bin width larger than separation): $f_s=500\\,\\mathrm{Hz}$, $N=500$, $f_1=10.0\\,\\mathrm{Hz}$, $f_2=10.5\\,\\mathrm{Hz}$.\n\nImplementation requirements:\n- Compute the FFT magnitude on a zero-padded grid such that the frequency resolution is at most $0.01\\,\\mathrm{Hz}$.\n- Use radians for any internal angle computations, and $\\mathrm{Hz}$ for all frequencies.\n- The final output must be a single line containing a Python list literal with the four booleans corresponding to Cases A, B, C, and D in that order, for example: `[True, False, False, True]` (without any additional text).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\").",
            "solution": "The problem requires a determination of spectral resolvability for two closely spaced sinusoids based on a set of precise, quantitative criteria. The analysis is grounded in the principles of Fourier analysis and the effects of windowing on discrete-time signals.\n\n**1. Theoretical Framework**\n\nThe signal under consideration is a sum of two discrete-time sinusoids:\n$$\nx[n] = a_1 \\cos\\left(2\\pi \\frac{f_1}{f_s} n + \\phi_1\\right) + a_2 \\cos\\left(2pi \\frac{f_2}{f_s} n + \\phi_2\\right)\n$$\nThis signal is observed over a finite duration, from $n=0$ to $n=N-1$. This finite observation is equivalent to multiplying the infinite-duration signal by a rectangular window $w[n]$, where:\n$$\nw[n] = \\begin{cases} 1 & 0 \\le n \\le N-1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nThe observed signal is $x_w[n] = x[n] w[n]$. According to the convolution theorem of the Fourier transform, multiplication in the time domain corresponds to convolution in the frequency domain. The Discrete-Time Fourier Transform (DTFT) of the windowed signal, $X_w(e^{j\\omega})$, is the circular convolution of the DTFT of the ideal signal, $X(e^{j\\omega})$, and the DTFT of the window, $W(e^{j\\omega})$:\n$$\nX_w(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} X(e^{j\\theta}) W(e^{j(\\omega-\\theta)}) d\\theta\n$$\nThe DTFT of the ideal signal $x[n]$ consists of pairs of Dirac delta functions at the normalized frequencies corresponding to $\\pm f_1$ and $\\pm f_2$. The DTFT of the rectangular window, $W(e^{j\\omega})$, is given by:\n$$\nW(e^{j\\omega}) = e^{-j\\omega\\frac{N-1}{2}} \\frac{\\sin(\\omega N/2)}{\\sin(\\omega/2)}\n$$\nThe magnitude of this function, $|W(e^{j\\omega})|$, is a sinc-like function with a mainlobe and decaying sidelobes. The convolution operation effectively replaces each ideal delta function in the signal's spectrum with a scaled and shifted version of the window's spectrum, $W(e^{j\\omega})$.\n\n**2. Spectral Resolution**\n\nTwo frequency components are considered resolved if their corresponding mainlobes in the spectrum are distinguishable as separate peaks. A classical rule of thumb is the Rayleigh criterion, which states that two peaks are just resolvable if the maximum of one falls on the first minimum (null) of the other. For a rectangular window, the first nulls of the mainlobe occur at frequency offsets of $\\pm f_s/N$ from the center frequency. Therefore, the Rayleigh criterion suggests that two equal-amplitude sinusoids are resolvable if their frequency separation $|f_1 - f_2|$ is at least the DFT bin spacing, $\\Delta f = f_s/N$.\n\nThe problem provides a more rigorous and quantitative definition of resolvability based on three specific conditions applied to the computed magnitude spectrum.\n\n**3. Computational Procedure**\n\nFor each test case, the following steps are executed:\n\n1.  **Signal Synthesis**: The discrete-time signal $x[n]$ is generated for $n \\in \\{0, 1, \\dots, N-1\\}$ using the specified parameters $f_s, N, f_1, f_2$, with amplitudes $a_1=a_2=1$ and phases $\\phi_1=\\phi_2=0$.\n\n2.  **High-Resolution Spectrum Calculation**: To accurately assess the shape of the continuous DTFT, we compute the Discrete Fourier Transform (DFT) on a finely sampled frequency grid. This is achieved by zero-padding the $N$-sample signal $x[n]$ to a much greater length, $N_{\\text{FFT}}$, before applying the Fast Fourier Transform (FFT) algorithm. The required frequency grid resolution of at most $0.01\\,\\mathrm{Hz}$ dictates the length $N_{\\text{FFT}} \\ge f_s / 0.01$. For $f_s = 500\\,\\mathrm{Hz}$, this implies $N_{\\text{FFT}} \\ge 50000$. A standard choice is a power of $2$, such as $N_{\\text{FFT}} = 2^{16} = 65536$.\n\n3.  **Spectrum Analysis in the Search Band**:\n    a. The magnitude spectrum $|X(f)|$ is computed from the FFT result.\n    b. A specific search band in the frequency domain is defined as $[f_{\\min}-1, f_{\\max}+1]\\,\\mathrm{Hz}$, where $f_{\\min} = \\min(f_1, f_2)$ and $f_{\\max} = \\max(f_1, f_2)$.\n    c. The analysis proceeds by applying the three resolvability conditions within this band.\n\n4.  **Application of Resolvability Criteria**:\n\n    *   **Condition 1 (Peak Prominence)**: We identify all local maxima within the search band whose prominence is at least a fraction $\\alpha=0.2$ of the maximum spectral magnitude found within that same band. A peak's prominence is its vertical distance from the peak's summit to the lowest contour line encircling it but no higher peak. If fewer than two such prominent peaks are found, the components are deemed unresolved.\n\n    *   **Condition 2 (Peak Separation)**: If two or more peaks satisfy Condition 1, we select the two with the highest prominence values. We then check if the frequency separation between these two most prominent peaks is at least $0.49\\,\\mathrm{Hz}$. If this condition is not met, the components are unresolved.\n\n    *   **Condition 3 (Valley Depth)**: We find the minimum spectral magnitude (the \"valley\") in the frequency range between the two most prominent peaks. This valley magnitude must be no more than a fraction $\\tau=0.85$ of the smaller of the two peak magnitudes. If the valley is too shallow, the components are considered unresolved.\n\n    A result of `True` (resolved) is returned only if all three conditions are satisfied. Otherwise, the result is `False` (unresolved).\n\n**4. Analysis of Test Cases**\n\n*   **Case A**: $f_s=500\\,\\mathrm{Hz}, N=1000, f_1=10.0\\,\\mathrm{Hz}, f_2=10.5\\,\\mathrm{Hz}$. Here, the DFT bin spacing is $\\Delta f = f_s/N = 0.5\\,\\mathrm{Hz}$. The frequency separation is $|f_1-f_2| = 0.5\\,\\mathrm{Hz}$, which is exactly $\\Delta f$. This is the borderline case according to the Rayleigh criterion. The provided quantitative criteria will yield a definitive answer.\n\n*   **Case B**: $f_s=500\\,\\mathrm{Hz}, N=1000, f_1=10.125\\,\\mathrm{Hz}, f_2=10.625\\,\\mathrm{Hz}$. The separation is again $0.5\\,\\mathrm{Hz}$, but the frequencies are now situated between DFT bins. This typically leads to a higher valley between peaks compared to the bin-centered case, which may cause a failure of Condition 3.\n\n*   **Case C**: $f_s=500\\,\\mathrm{Hz}, N=1000, f_1=10.0\\,\\mathrm{Hz}, f_2=10.4\\,\\mathrm{Hz}$. The separation is $|f_1-f_2| = 0.4\\,\\mathrm{Hz}$, which is less than $\\Delta f = 0.5\\,\\mathrm{Hz}$. The mainlobes are expected to merge significantly, likely failing to produce two distinct peaks that satisfy the prominence and valley depth criteria.\n\n*   **Case D**: $f_s=500\\,\\mathrm{Hz}, N=500, f_1=10.0\\,\\mathrm{Hz}, f_2=10.5\\,\\mathrm{Hz}$. The window is shorter, so the bin spacing is wider: $\\Delta f = f_s/N = 1.0\\,\\mathrm{Hz}$. The frequency separation is $0.5\\,\\mathrm{Hz}$, which is only $0.5\\,\\Delta f$. The mainlobe of the window's spectrum is twice as wide as in Case A. The two spectral components are expected to merge into a single, unresolvable peak.\n\nThe provided Python code implements this entire procedure to determine the resolvability for each case.",
            "answer": "[True, False, False, False]"
        },
        {
            "introduction": "Having established the theoretical challenges of leakage  and resolution , we turn to a practical solution: applying a tapered window to improve spectral estimates. This exercise simulates a common scenario in neuroscience—analyzing a transient event-related potential (ERP)—where sharp onsets create significant leakage. You will implement a quantitative comparison between a rectangular window and a tapered Tukey window, measuring the reduction in leakage to demonstrate the practical benefit of choosing a window function appropriate for your signal.",
            "id": "4204150",
            "problem": "You are given the task of quantifying spectral leakage in the frequency-domain analysis of an event-related potential (ERP) segment with a sharp onset. Consider a discrete-time signal modeled as a damped sinusoid with a causal sharp onset at time zero, defined for samples $n \\in \\{0,1,\\dots,N-1\\}$ by the equation\n$$\nx[n] = A \\, e^{-n / (\\tau f_s)} \\, \\sin\\left(2\\pi f_0 \\frac{n}{f_s}\\right),\n$$\nwhere $A$ is the amplitude, $f_s$ is the sampling frequency in Hertz, $f_0$ is the dominant oscillation frequency in Hertz, and $\\tau$ is the decay time constant in seconds. The angle argument in the sine function is measured in radians.\n\nYou are to compute the reduction in spectral leakage achieved by applying a Tukey window, parameterized by the taper fraction $\\alpha \\in [0,1]$, relative to the rectangular window (which is equivalent to the Tukey window with $\\alpha = 0$). Windowing corresponds to multiplying $x[n]$ by $w[n]$, which in the frequency domain is a convolution of the spectra of $x[n]$ and $w[n]$. Spectral leakage is operationally defined here as the fraction of the discrete Fourier transform (DFT) magnitude-squared energy that lies outside a band-of-interest centered at the dominant oscillation frequency. Specifically, let $X_w[k]$ denote the DFT of the windowed signal $x[n] w[n]$, and let $f[k]$ denote the DFT bin frequencies in Hertz. Define the band-of-interest half-width by\n$$\nB = \\frac{2}{T},\n$$\nwhere $T = \\frac{N}{f_s}$ is the segment duration in seconds. The band-of-interest comprises two symmetric intervals of width $2B$ centered at $+f_0$ and $-f_0$ (to accommodate the conjugate symmetry of real-valued signals). The total spectral energy is\n$$\nP_{\\text{tot}} = \\sum_{k=0}^{N-1} \\left|X_w[k]\\right|^2,\n$$\nand the leakage energy is\n$$\nP_{\\text{leak}} = \\sum_{k=0}^{N-1} \\left|X_w[k]\\right|^2 \\cdot \\mathbf{1}\\left(\\min\\left(\\left|f[k]-f_0\\right|,\\left|f[k]+f_0\\right|\\right) > B\\right),\n$$\nwhere $\\mathbf{1}(\\cdot)$ is the indicator function. The leakage fraction is then\n$$\nL = \\frac{P_{\\text{leak}}}{P_{\\text{tot}}}.\n$$\nFor a given $(f_s, T, f_0, \\tau, \\alpha)$, compute $L_{\\text{rect}}$ using a rectangular window $w_{\\text{rect}}[n] = 1$ and $L_{\\text{tukey}}$ using a Tukey window with taper fraction $\\alpha$. Finally, compute the fractional reduction in leakage\n$$\nR = \\frac{L_{\\text{rect}} - L_{\\text{tukey}}}{L_{\\text{rect}}},\n$$\nexpressed as a decimal number. If $L_{\\text{rect}} = 0$, define $R = 0$.\n\nImplement a program that, for each parameter set in the test suite below, generates the ERP segment $x[n]$ with $A = 1$, applies the rectangular and Tukey windows, computes the DFT using the standard discrete Fourier transform, and outputs $R$ as a floating-point number rounded to $6$ decimal places. Use the following test suite, which includes general cases, boundary conditions, and edge cases:\n\n- Test case $1$: $f_s = 1000$ Hz, $T = 0.5$ s, $f_0 = 20$ Hz, $\\tau = 0.08$ s, $\\alpha = 0.5$.\n- Test case $2$: $f_s = 500$ Hz, $T = 1.0$ s, $f_0 = 37.3$ Hz, $\\tau = 0.1$ s, $\\alpha = 0.8$.\n- Test case $3$: $f_s = 1000$ Hz, $T = 0.2$ s, $f_0 = 60$ Hz, $\\tau = 0.03$ s, $\\alpha = 0.2$.\n- Test case $4$: $f_s = 2000$ Hz, $T = 0.25$ s, $f_0 = 100$ Hz, $\\tau = 0.05$ s, $\\alpha = 0.6$.\n- Test case $5$ (boundary condition): $f_s = 1000$ Hz, $T = 0.5$ s, $f_0 = 20$ Hz, $\\tau = 0.08$ s, $\\alpha = 0.0$.\n\nAll time and frequency quantities must be handled in seconds and Hertz, respectively. Angles are in radians. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$), where each entry corresponds to $R$ for the respective test case, rounded to $6$ decimal places.",
            "solution": "The problem requires the quantification of spectral leakage reduction when analyzing a transient oscillatory signal, a common task in fields like neuroscience for studying event-related potentials (ERPs). The analysis proceeds by first acknowledging the source of spectral leakage, defining a clear metric for it, and then algorithmically computing this metric for two different windowing functions to find the relative improvement.\n\nThe signal under consideration is a discrete-time damped sinusoid with a sharp onset, modeled for time samples $n \\in \\{0, 1, \\dots, N-1\\}$ as:\n$$\nx[n] = A \\, e^{-n / (\\tau f_s)} \\, \\sin\\left(2\\pi f_0 \\frac{n}{f_s}\\right)\n$$\nHere, $A$ is the amplitude, which is set to $1$. The number of samples is $N = T f_s$, where $f_s$ is the sampling frequency and $T$ is the total duration of the signal segment. The signal oscillates at a dominant frequency $f_0$ and decays with a time constant $\\tau$.\n\nThe analysis of a finite-duration signal using the Discrete Fourier Transform (DFT) is mathematically equivalent to analyzing an infinitely long signal multiplied by a rectangular window of duration $T$. The sharp start and end of this implicit rectangular window introduce broadband artifacts in the frequency domain, a phenomenon known as spectral leakage. This can be understood through the convolution theorem of the Fourier transform: if a windowed signal is $x_w[n] = x[n] \\cdot w[n]$, its spectrum is the convolution of the individual spectra, $X_w(f) = X(f) * W(f)$. A rectangular window's spectrum, a sinc function, has high-amplitude sidelobes that \"smear\" the signal's true spectrum $X(f)$ across the frequency domain.\n\nTo mitigate this, one applies a different window function $w[n]$ that has lower sidelobes in its spectrum, at the cost of a wider main lobe. This problem compares the performance of the default rectangular window, $w_{\\text{rect}}[n] = 1$, with a Tukey window, which is a rectangular window with tapered cosine ends. The Tukey window is parameterized by a taper fraction $\\alpha$.\n\nA rigorous, quantitative definition of spectral leakage is provided. The analysis is performed in the frequency domain using the DFT of the windowed signal, $X_w[k]$. The corresponding frequency for each DFT bin $k$ is given by $f[k] = k f_s / N$.\nFirst, a band-of-interest is defined around the known dominant frequency $f_0$. This band consists of two symmetric intervals, $[f_0 - B, f_0 + B]$ and $[-f_0 - B, -f_0 + B]$, where the half-width $B = 2/T$ is chosen based on the main-lobe width of the rectangular window's transform. The inclusion of the negative frequency band is necessary due to the conjugate symmetry of the DFT for real-valued signals.\n\nThe total energy of the signal in the frequency domain is given by Parseval's theorem:\n$$\nP_{\\text{tot}} = \\sum_{k=0}^{N-1} \\left|X_w[k]\\right|^2\n$$\nThe leakage energy, $P_{\\text{leak}}$, is defined as the portion of the total energy that falls *outside* the band-of-interest:\n$$\nP_{\\text{leak}} = \\sum_{k=0}^{N-1} \\left|X_w[k]\\right|^2 \\cdot \\mathbf{1}\\left(\\min\\left(\\left|f[k]-f_0\\right|,\\left|f[k]+f_0\\right|\\right) > B\\right)\n$$\nwhere $\\mathbf{1}(\\cdot)$ is the indicator function. The leakage fraction is the ratio $L = P_{\\text{leak}} / P_{\\text{tot}}$.\n\nThe solution is implemented via the following algorithm:\n1.  For a given set of parameters $(f_s, T, f_0, \\tau, \\alpha)$, the number of samples $N = \\text{int}(T f_s)$ is calculated.\n2.  The discrete signal $x[n]$ is generated over the time indices $n = 0, 1, \\dots, N-1$.\n3.  A dedicated function is defined to compute the leakage fraction $L$ for a given window. This function executes the following steps:\n    a. It receives the signal parameters and a windowing parameter (in this case, $\\alpha$).\n    b. It generates the appropriate window $w[n]$ of length $N$. A rectangular window corresponds to a Tukey window with $\\alpha=0$.\n    c. It computes the windowed signal $x_w[n] = x[n] \\cdot w[n]$.\n    d. It calculates the DFT, $X_w[k]$, of the windowed signal.\n    e. It determines the frequency bins $f[k]$ corresponding to each DFT index $k$.\n    f. It calculates the total energy $P_{\\text{tot}}$ and the leakage energy $P_{\\text{leak}}$ by summing the squared magnitudes of $X_w[k]$ over all bins and over the out-of-band bins, respectively.\n    g. It returns the leakage fraction $L$.\n4.  This function is called twice: once with $\\alpha=0$ to obtain $L_{\\text{rect}}$, and once with the specified $\\alpha$ from the test case to obtain $L_{\\text{tukey}}$.\n5.  The final metric, the fractional reduction in leakage $R$, is computed as:\n$$\nR = \\frac{L_{\\text{rect}} - L_{\\text{tukey}}}{L_{\\text{rect}}}\n$$\nThe special case where $L_{\\text{rect}} = 0$ is handled by setting $R = 0$.\n6.  This process is repeated for each test case provided, and the resulting values of $R$ are rounded and formatted as specified.",
            "answer": "[0.655823, 0.854655, 0.26477, 0.68652, 0.0]"
        }
    ]
}