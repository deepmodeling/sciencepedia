{
    "hands_on_practices": [
        {
            "introduction": "尖峰放电排序是分析神经记录的基础步骤，但其输出是估计值而非绝对真理。本练习将利用光遗传学标记等技术提供的“金标准”数据，来评估尖峰放电排序算法的准确性，从而巩固对分类性能指标的理解。通过计算精确率、召回率和错误发现率，你将亲身体会决策阈值如何影响这些指标，这是信号检测理论中的一个核心权衡。",
            "id": "4181531",
            "problem": "您正在分析一种神经元尖峰数据，该模式通过光遗传学标记（optotagging）提供配对的基准真相。对于由尖峰分类算法生成的每个候选尖峰，您都有一个置信度分数和一个二进制配对标签，该标签指示此候选事件是否与一个基准真相标记事件相匹配。一个决策阈值决定了一个候选尖峰是否被接受为属于被标记的神经元。\n\n基本原理：在二元决策分析中，对于任何阈值 $\\tau \\in [0,1]$，一个分数为 $s_i \\in [0,1]$ 的事件，如果 $s_i \\ge \\tau$，则被分类为预测为正，否则分类为预测为负。使用基准真值标签 $g_i \\in \\{0,1\\}$，在阈值 $\\tau$ 下的混淆计数从第一性原理定义如下：真正例 (true positive) 是 $g_i = 1$ 的预测为正的事件，假正例 (false positive) 是 $g_i = 0$ 的预测为正的事件，而假负例 (false negative) 是 $g_i = 1$ 的预测为负的事件。令 $TP(\\tau)$、$FP(\\tau)$ 和 $FN(\\tau)$ 表示这些计数。使用从这些计数派生的标准定义，计算下面每个测试用例的精确率、召回率和错误发现率。所有指标必须表示为无单位的小数。\n\n必须应用边界情况约定以确保在边缘情况下的输出是良定义的：如果 $TP(\\tau)+FP(\\tau)=0$，则定义精确率为 $1$、错误发现率为 $0$；如果 $TP(\\tau)+FN(\\tau)=0$，则定义召回率为 $1$。\n\n输入规范：每个测试用例提供一个分数列表 $[s_1,\\dots,s_n]$、一个配对的基准真值标签列表 $[g_1,\\dots,g_n]$ 和一个阈值 $\\tau$。假定配对已使用适用于光遗传学标记的时间窗匹配方法执行和验证；您只需使用提供的标签 $g_i$。\n\n任务：对于每个测试用例，严格根据上述基本原理，计算在给定阈值 $\\tau$ 下的精确率、召回率和错误发现率。\n\n测试套件：\n- 案例 A（混合基准真值，中等阈值）：分数 $[0.9,0.8,0.1,0.4,0.6,0.3,0.95,0.2]$，标签 $[1,1,0,1,0,0,1,0]$，阈值 $\\tau=0.5$。\n- 案例 B（相同数据，最低阈值）：分数 $[0.9,0.8,0.1,0.4,0.6,0.3,0.95,0.2]$，标签 $[1,1,0,1,0,0,1,0]$，阈值 $\\tau=0.0$。\n- 案例 C（相同数据，最高阈值且无接受的尖峰）：分数 $[0.9,0.8,0.1,0.4,0.6,0.3,0.95,0.2]$，标签 $[1,1,0,1,0,0,1,0]$，阈值 $\\tau=1.0$。\n- 案例 D（无基准真值正例）：分数 $[0.7,0.2,0.9]$，标签 $[0,0,0]$，阈值 $\\tau=0.8$。\n- 案例 E（所有基准真值均为正例，分数与阈值持平）：分数 $[0.51,0.49,0.5]$，标签 $[1,1,1]$，阈值 $\\tau=0.5$。\n- 案例 F（相同混合数据，更严格的阈值）：分数 $[0.9,0.8,0.1,0.4,0.6,0.3,0.95,0.2]$，标签 $[1,1,0,1,0,0,1,0]$，阈值 $\\tau=0.7$。\n\n输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例按其指定阈值计算的 $\\left[\\text{精确率},\\text{召回率},\\text{错误发现率}\\right]$ 顺序贡献一个子列表。例如，输出格式必须类似于 $[[p_A,r_A,f_A],[p_B,r_B,f_B],\\dots]$，其中每个 $p_X$、$r_X$ 和 $f_X$ 都是四舍五入到六位小数的十进制数。",
            "solution": "所提出的问题是一个有效且定义明确的练习，它将二元分类分析的基本原则应用于神经科学中的一个具体、现实的场景：使用光遗传学标记的基准真值来验证尖峰分类结果。问题陈述提供了所有必要的数据、混淆矩阵计数的明确定义，以及处理性能指标中分母为零的边缘情况的清晰约定。任务是为几个测试用例计算精确率、召回率和错误发现率。\n\n我们首先将所提供的定义形式化。假设有 $n$ 个候选尖峰事件。对于每个事件 $i \\in \\{1, \\dots, n\\}$，我们给定一个置信度分数 $s_i \\in [0, 1]$ 和一个二元基准真值标签 $g_i \\in \\{0, 1\\}$，其中 $g_i=1$ 表示来自被标记神经元的真实尖峰，$g_i=0$ 表示非真实尖峰。\n\n给定一个决策阈值 $\\tau \\in [0, 1]$，如果候选尖峰的分数 $s_i$ 满足 $s_i \\ge \\tau$，则将其分类为“预测为正”。否则，它被分类为“预测为负”。\n\n根据这些预测和基准真值标签，我们可以计算在给定阈值 $\\tau$ 下的混淆计数：\n-   真正例 (True Positives), $TP(\\tau)$: 满足 $s_i \\ge \\tau$ 且 $g_i=1$ 的事件数量。\n-   假正例 (False Positives), $FP(\\tau)$: 满足 $s_i \\ge \\tau$ 且 $g_i=0$ 的事件数量。\n-   假负例 (False Negatives), $FN(\\tau)$: 满足 $s_i  \\tau$ 且 $g_i=1$ 的事件数量。\n\n被分类为正例的事件总数为 $TP(\\tau) + FP(\\tau)$。数据集中实际正例的总数是 $P = TP(\\tau) + FN(\\tau)$，这个量与阈值 $\\tau$ 无关。\n\n使用这些计数，所需指标的标准定义如下：\n-   **精确率 (Precision)**: $\\text{Precision}(\\tau) = \\frac{TP(\\tau)}{TP(\\tau) + FP(\\tau)}$\n-   **召回率 (Recall)** (也称为真正例率或灵敏度): $\\text{Recall}(\\tau) = \\frac{TP(\\tau)}{TP(\\tau) + FN(\\tau)} = \\frac{TP(\\tau)}{P}$\n-   **错误发现率 (False Discovery Rate)**: $\\text{FDR}(\\tau) = \\frac{FP(\\tau)}{TP(\\tau) + FP(\\tau)}$\n\n问题指定了分母为零的边缘情况的约定：\n1.  如果 $TP(\\tau) + FP(\\tau) = 0$，则 $\\text{Precision}(\\tau)$ 定义为 $1$，$\\text{FDR}(\\tau)$ 定义为 $0$。这发生在阈值 $\\tau$ 处没有接受任何尖峰时。\n2.  如果 $TP(\\tau) + FN(\\tau) = 0$，则 $\\text{Recall}(\\tau)$ 定义为 $1$。这发生在数据集中没有基准真值正例时。\n\n现在我们将这些原则应用于每个测试用例。\n\n**案例 A**：`scores = [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2]`，`labels = [1, 1, 0, 1, 0, 0, 1, 0]`，$\\tau=0.5$。\n-   $s_i \\ge 0.5$ 的事件：分数 $0.9, 0.8, 0.6, 0.95$。\n-   对应的标签：$1, 1, 0, 1$。\n-   $TP(0.5) = 3$（来自得分 $0.9, 0.8, 0.95$）。\n-   $FP(0.5) = 1$（来自得分 $0.6$）。\n-   $s_i  0.5$ 的事件：分数 $0.1, 0.4, 0.3, 0.2$。\n-   对应的标签：$0, 1, 0, 0$。\n-   $FN(0.5) = 1$（来自得分 $0.4$）。\n-   $\\text{精确率} = \\frac{3}{3+1} = 0.75$。\n-   $\\text{召回率} = \\frac{3}{3+1} = 0.75$。\n-   $\\text{错误发现率} = \\frac{1}{3+1} = 0.25$。\n\n**案例 B**：相同数据，$\\tau=0.0$。\n-   $s_i \\ge 0.0$ 的事件：全部 $8$ 个事件。\n-   对应的标签：$1, 1, 0, 1, 0, 0, 1, 0$。\n-   $TP(0.0) = 4$。\n-   $FP(0.0) = 4$。\n-   $s_i  0.0$ 的事件：无。\n-   $FN(0.0) = 0$。\n-   $\\text{精确率} = \\frac{4}{4+4} = 0.5$。\n-   $\\text{召回率} = \\frac{4}{4+0} = 1.0$。\n-   $\\text{错误发现率} = \\frac{4}{4+4} = 0.5$。\n\n**案例 C**：相同数据，$\\tau=1.0$。\n-   $s_i \\ge 1.0$ 的事件：无。\n-   $TP(1.0) = 0$。\n-   $FP(1.0) = 0$。\n-   分母 $TP+FP = 0$，所以我们使用边界情况约定。\n-   $\\text{精确率} = 1.0$。\n-   $\\text{错误发现率} = 0.0$。\n-   $s_i  1.0$ 的事件：全部 $8$ 个事件。\n-   实际正例的总数为 $4$。所有都被错过了。\n-   $FN(1.0) = 4$。\n-   $\\text{召回率} = \\frac{TP}{TP+FN} = \\frac{0}{0+4} = 0.0$。\n\n**案例 D**：`scores = [0.7, 0.2, 0.9]`，`labels = [0, 0, 0]`，$\\tau=0.8$。\n-   $s_i \\ge 0.8$ 的事件：分数 $0.9$。\n-   对应的标签：$0$。\n-   $TP(0.8) = 0$。\n-   $FP(0.8) = 1$。\n-   $\\text{精确率} = \\frac{0}{0+1} = 0.0$。\n-   $\\text{错误发现率} = \\frac{1}{0+1} = 1.0$。\n-   数据中没有基准真值正例，所以无论 $\\tau$ 是多少，$TP+FN=0$。\n-   这是召回率的边界情况。$\\text{召回率} = 1.0$。\n\n**案例 E**：`scores = [0.51, 0.49, 0.5]`，`labels = [1, 1, 1]`，$\\tau=0.5$。\n-   $s_i \\ge 0.5$ 的事件：分数 $0.51, 0.5$。\n-   对应的标签：$1, 1$。\n-   $TP(0.5) = 2$。\n-   $FP(0.5) = 0$。\n-   $\\text{精确率} = \\frac{2}{2+0} = 1.0$。\n-   $\\text{错误发现率} = \\frac{0}{2+0} = 0.0$。\n-   $s_i  0.5$ 的事件：分数 $0.49$。\n-   对应的标签：$1$。\n-   $FN(0.5) = 1$。\n-   实际正例的总数为 $3$。\n-   $\\text{召回率} = \\frac{2}{2+1} = \\frac{2}{3} \\approx 0.666667$。\n\n**案例 F**：与案例 A 相同数据，$\\tau=0.7$。\n-   `scores = [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2]`，`labels = [1, 1, 0, 1, 0, 0, 1, 0]`。\n-   $s_i \\ge 0.7$ 的事件：分数 $0.9, 0.8, 0.95$。\n-   对应的标签：$1, 1, 1$。\n-   $TP(0.7) = 3$。\n-   $FP(0.7) = 0$。\n-   $\\text{精确率} = \\frac{3}{3+0} = 1.0$。\n-   $\\text{错误发现率} = \\frac{0}{3+0} = 0.0$。\n-   实际正例总数为 $4$。\n-   $FN(0.7) = (\\text{总正例数}) - TP(0.7) = 4 - 3 = 1$。被错过的正例分数为 $0.4$。\n-   $\\text{召回率} = \\frac{3}{3+1} = \\frac{3}{4} = 0.75$。\n\n这些计算将在最终的程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes precision, recall, and false discovery rate for several test cases\n    of neuronal spike classification, adhering to specified definitions and\n    corner cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A (mixed ground truth, moderate threshold)\n        {'scores': [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2], 'labels': [1, 1, 0, 1, 0, 0, 1, 0], 'threshold': 0.5},\n        # Case B (same data, lowest threshold)\n        {'scores': [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2], 'labels': [1, 1, 0, 1, 0, 0, 1, 0], 'threshold': 0.0},\n        # Case C (same data, highest threshold with no accepted spikes)\n        {'scores': [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2], 'labels': [1, 1, 0, 1, 0, 0, 1, 0], 'threshold': 1.0},\n        # Case D (no ground-truth positives)\n        {'scores': [0.7, 0.2, 0.9], 'labels': [0, 0, 0], 'threshold': 0.8},\n        # Case E (all ground-truth positives, ties at threshold)\n        {'scores': [0.51, 0.49, 0.5], 'labels': [1, 1, 1], 'threshold': 0.5},\n        # Case F (same mixed data, stricter threshold)\n        {'scores': [0.9, 0.8, 0.1, 0.4, 0.6, 0.3, 0.95, 0.2], 'labels': [1, 1, 0, 1, 0, 0, 1, 0], 'threshold': 0.7},\n    ]\n\n    def compute_metrics(scores, labels, threshold):\n        \"\"\"\n        Calculates precision, recall, and FDR from fundamental counts.\n\n        Args:\n            scores (list[float]): List of confidence scores.\n            labels (list[int]): List of binary ground-truth labels.\n            threshold (float): The decision threshold.\n\n        Returns:\n            tuple[float, float, float]: A tuple containing precision, recall, and FDR.\n        \"\"\"\n        scores = np.array(scores)\n        labels = np.array(labels)\n        \n        # Predictions based on the threshold\n        predicted_positives_mask = scores >= threshold\n        \n        # Calculate confusion counts from first principles\n        tp = np.sum((predicted_positives_mask)  (labels == 1))\n        fp = np.sum((predicted_positives_mask)  (labels == 0))\n        \n        predicted_negatives_mask = scores  threshold\n        fn = np.sum((predicted_negatives_mask)  (labels == 1))\n        \n        # Total number of predicted positives\n        total_predicted_positives = tp + fp\n        \n        # Apply corner conventions for precision and FDR\n        if total_predicted_positives == 0:\n            precision = 1.0\n            fdr = 0.0\n        else:\n            precision = tp / total_predicted_positives\n            fdr = fp / total_predicted_positives\n\n        # Total number of actual positives\n        total_actual_positives = tp + fn\n\n        # Apply corner convention for recall\n        if total_actual_positives == 0:\n            recall = 1.0\n        else:\n            recall = tp / total_actual_positives\n            \n        return precision, recall, fdr\n\n    results = []\n    for case in test_cases:\n        p, r, f = compute_metrics(case['scores'], case['labels'], case['threshold'])\n        results.append(f\"[{p:.6f},{r:.6f},{f:.6f}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在处理皮层脑电图（ECoG）等多通道电生理数据时，选择参考电极方案是一项关键的预处理步骤。不同的参考方案，如共同平均参考（CAR）或双极参考，本质上是施加不同的空间滤波器。本练习旨在通过推导和计算相干性（一种功能连接性度量）如何随参考方案的改变而变化，来揭示预处理选择对最终科学结论的深远影响。",
            "id": "4181539",
            "problem": "一个研究团队正在分析从一个由 $M=5$ 个电极组成的线性阵列在固定频率 $f_0$ 下记录的颅内脑电图 (ECoG) 信号。设原始的零均值信号为 $x_i(t)$，$i \\in \\{1,2,3,4,5\\}$，其被建模为一个平稳多元过程，在频率 $f_0$ 处的交叉谱密度矩阵是一个对称 Toeplitz 矩阵，其元素为\n$$\nS_{ij}(f_0) \\equiv S_{ij} = s \\exp\\!\\big(-|i-j|\\big) + n \\,\\delta_{ij},\n$$\n其中 $s  0$ 捕获了空间相关场，$n  0$ 捕获了独立通道噪声。假设 $s=1$ 且 $n=0.2$。\n\n考虑将两种参考方案作为空间线性滤波器：\n- 全局平均参考 (CAR)：$y = R_{\\mathrm{CAR}} x$，其中 $R_{\\mathrm{CAR}} = I - \\frac{1}{M} \\mathbf{1}\\mathbf{1}^{\\top}$，$\\mathbf{1}$ 是 $M \\times 1$ 的全一向量，$I$ 是 $M \\times M$ 的单位矩阵。经过 CAR 参考的信号为 $y_i(t)$。\n- 相邻电极间的双极参考：定义 $b_k(t) = x_k(t) - x_{k+1}(t)$，其中 $k \\in \\{1,2,3,4\\}$，将这些信号集合成 $b = R_{\\mathrm{BIP}} x$，其中 $R_{\\mathrm{BIP}}$ 是沿阵列的 $(M-1)\\times M$ 一阶差分算子。\n\n仅从线性滤波和谱密度的定义，以及两个零均值平稳过程 $u(t)$ 和 $v(t)$ 在频率 $f_0$ 的幅度平方相干性定义出发，\n$$\nC(u,v; f_0) = \\frac{|S_{uv}(f_0)|^2}{S_{uu}(f_0)\\,S_{vv}(f_0)},\n$$\n推导两种参考方案对交叉谱密度的空间滤波作用，并计算 $y_2(t)$ 和 $y_3(t)$ 之间的幅度平方相干性（记为 $C_{\\mathrm{CAR}}$），以及 $b_2(t)$ 和 $b_3(t)$ 之间的幅度平方相干性（记为 $C_{\\mathrm{BIP}}$）。然后，通过计算以下比率来量化参考方法对相干性的影响\n$$\n\\rho = \\frac{C_{\\mathrm{CAR}}}{C_{\\mathrm{BIP}}}.\n$$\n根据上述模型，对空间相关项使用 $s=1$、$n=0.2$ 和 $\\exp(-1)$、$\\exp(-2)$、$\\exp(-3)$、$\\exp(-4)$。将 $\\rho$ 的最终数值四舍五入到四位有效数字。将答案表示为一个无量纲小数。",
            "solution": "该问题要求分析两种不同的空间参考方案，即全局平均参考 (CAR) 和双极参考，如何影响颅内脑电图 (ECoG) 通道对之间的幅度平方相干性。我们必须从第一性原理出发，计算应用每种方案后的相干性比率。\n\n交叉谱密度在线性空间滤波器作用下变换的基本原理如下。设 $x(t)$ 是一个由 $M$ 个零均值平稳时间序列组成的向量，其交叉谱密度矩阵为 $S_x(f)$。如果通过线性变换 $y(t) = R x(t)$ 得到一组新的时间序列 $y(t)$，其中 $R$ 是一个变换矩阵，则其交叉谱密度矩阵 $S_y(f)$ 由下式给出：\n$$S_y(f) = R S_x(f) R^{\\dagger}$$\n其中 $R^{\\dagger}$ 是 $R$ 的共轭转置。由于本问题中的参考矩阵是实数矩阵，该式可简化为 $S_y(f) = R S_x(f) R^{\\top}$。所有计算都在固定频率 $f_0$ 下进行，因此为简洁起见，我们将省略参数 $f_0$，记为 $S_{ij}$ 而不是 $S_{ij}(f_0)$。\n\n首先，我们为原始信号 $x_i(t)$ 构建 $M \\times M$ 输入交叉谱密度矩阵 $S_x$。\n问题陈述 $M=5$，矩阵元素为 $S_{ij} = s \\exp(-|i-j|) + n \\delta_{ij}$，参数值为 $s=1$ 和 $n=0.2$。因此，矩阵 $S_x$ 是一个 $5 \\times 5$ 的对称 Toeplitz 矩阵：\n$$S_x = \\begin{pmatrix}\n1+n  s e^{-1}  s e^{-2}  s e^{-3}  s e^{-4} \\\\\ns e^{-1}  1+n  s e^{-1}  s e^{-2}  s e^{-3} \\\\\ns e^{-2}  s e^{-1}  1+n  s e^{-1}  s e^{-2} \\\\\ns e^{-3}  s e^{-2}  s e^{-1}  1+n  s e^{-1} \\\\\ns e^{-4}  s e^{-3}  s e^{-2}  s e^{-1}  1+n\n\\end{pmatrix}$$\n代入 $s=1$ 和 $n=0.2$：\n$$S_x = \\begin{pmatrix}\n1.2  e^{-1}  e^{-2}  e^{-3}  e^{-4} \\\\\ne^{-1}  1.2  e^{-1}  e^{-2}  e^{-3} \\\\\ne^{-2}  e^{-1}  1.2  e^{-1}  e^{-2} \\\\\ne^{-3}  e^{-2}  e^{-1}  1.2  e^{-1} \\\\\ne^{-4}  e^{-3}  e^{-2}  e^{-1}  1.2\n\\end{pmatrix}$$\n\n我们需要为这两种参考方案计算幅度平方相干性 $C(u,v) = \\frac{|S_{uv}|^2}{S_{uu} S_{vv}}$。\n\n**1. 全局平均参考 (CAR)**\n\nCAR 变换由 $y = R_{\\mathrm{CAR}} x$ 给出，其中 $R_{\\mathrm{CAR}} = I - \\frac{1}{M} \\mathbf{1}\\mathbf{1}^{\\top}$。该矩阵是对称的，所以 $R_{\\mathrm{CAR}}^{\\top} = R_{\\mathrm{CAR}}$。经过 CAR 参考的信号 $y_i(t)$ 的交叉谱矩阵为 $S_y = R_{\\mathrm{CAR}} S_x R_{\\mathrm{CAR}}$。\n该矩阵的元素 $(S_y)_{ij}$ 可以表示为：\n$$(S_y)_{ij} = (S_x)_{ij} - \\frac{1}{M} \\sum_{k=1}^{M} (S_x)_{ik} - \\frac{1}{M} \\sum_{k=1}^{M} (S_x)_{kj} + \\frac{1}{M^2} \\sum_{k=1}^{M}\\sum_{l=1}^{M} (S_x)_{kl}$$\n设 $R_i = \\sum_{k=1}^{M}(S_x)_{ik}$ 为 $S_x$ 第 $i$ 行的和，$T = \\sum_{i,j} (S_x)_{ij}$ 为所有元素的和。由于 $S_x$ 是对称的，第 $j$ 列的和等于第 $j$ 行的和，即 $R_j$。该公式变为：\n$$(S_y)_{ij} = (S_x)_{ij} - \\frac{R_i}{M} - \\frac{R_j}{M} + \\frac{T}{M^2}$$\n我们需要计算 $C_{\\mathrm{CAR}} = \\frac{|(S_y)_{23}|^2}{(S_y)_{22}(S_y)_{33}}$。这需要计算 $M=5$ 时 $S_x$ 的行和。设 $c_k = \\exp(-k)$。\n$R_1 = (1.2 + c_1 + c_2 + c_3 + c_4)$\n$R_2 = (c_1 + 1.2 + c_1 + c_2 + c_3) = 1.2 + 2c_1 + c_2 + c_3$\n$R_3 = (c_2 + c_1 + 1.2 + c_1 + c_2) = 1.2 + 2c_1 + 2c_2$\n根据对称性，$R_4 = R_2$ 且 $R_5 = R_1$。总和为 $T = 2R_1 + 2R_2 + R_3$。\n\n使用近似值 $c_1 \\approx 0.367879$、$c_2 \\approx 0.135335$、$c_3 \\approx 0.049787$、$c_4 \\approx 0.018316$：\n$R_1 \\approx 1.2 + 0.367879 + 0.135335 + 0.049787 + 0.018316 = 1.771317$\n$R_2 \\approx 1.2 + 2(0.367879) + 0.135335 + 0.049787 = 2.120880$\n$R_3 \\approx 1.2 + 2(0.367879) + 2(0.135335) = 2.206429$\n$T \\approx 2(1.771317) + 2(2.120880) + 2.206429 = 9.990822$\n并且 $\\frac{T}{M^2} = \\frac{T}{25} \\approx 0.399633$。\n\n现在我们计算 $S_y$ 所需的元素：\n$(S_y)_{22} = (S_x)_{22} - \\frac{2R_2}{M} + \\frac{T}{M^2} \\approx 1.2 - \\frac{2(2.120880)}{5} + 0.399633 = 1.2 - 0.848352 + 0.399633 = 0.751281$\n$(S_y)_{33} = (S_x)_{33} - \\frac{2R_3}{M} + \\frac{T}{M^2} \\approx 1.2 - \\frac{2(2.206429)}{5} + 0.399633 = 1.2 - 0.882572 + 0.399633 = 0.717061$\n$(S_y)_{23} = (S_x)_{23} - \\frac{R_2+R_3}{M} + \\frac{T}{M^2} \\approx c_1 - \\frac{2.120880+2.206429}{5} + 0.399633 = 0.367879 - 0.865462 + 0.399633 = -0.097950$\n\n那么相干性为：\n$$C_{\\mathrm{CAR}} = \\frac{(-0.097950)^2}{(0.751281)(0.717061)} \\approx \\frac{0.0095942}{0.538722} \\approx 0.017809$$\n\n**2. 双极参考**\n\n双极信号为 $b_k(t) = x_k(t) - x_{k+1}(t)$，其中 $k \\in \\{1,2,3,4\\}$。我们需要计算 $b_2(t) = x_2(t) - x_3(t)$ 和 $b_3(t) = x_3(t) - x_4(t)$ 之间的相干性。交叉谱密度通过线性组合推导得出：\n$S_{b_i b_j} = \\mathbb{E}[\\tilde{b}_i(f) \\tilde{b}_j(f)^*]$。对于 $i=2, j=2$：\n$S_{b_2 b_2} = S_{(x_2-x_3)(x_2-x_3)} = S_{22} - S_{23} - S_{32} + S_{33}$。由于 $S_x$ 是实对称矩阵，所以 $S_{23}=S_{32}$。\n$S_{b_2 b_2} = S_{22} + S_{33} - 2S_{23} = 1.2 + 1.2 - 2 e^{-1} = 2.4 - 2e^{-1}$。\n对于 $i=3, j=3$：\n$S_{b_3 b_3} = S_{(x_3-x_4)(x_3-x_4)} = S_{33} + S_{44} - 2S_{34}$。根据 Toeplitz 属性，$S_{33}=S_{44}=1.2$ 且 $S_{34}=e^{-1}$。\n$S_{b_3 b_3} = 1.2 + 1.2 - 2 e^{-1} = 2.4 - 2e^{-1}$。\n因此，$S_{b_2 b_2} = S_{b_3 b_3}$。\n\n交叉项为：\n$S_{b_2 b_3} = S_{(x_2-x_3)(x_3-x_4)} = S_{23} - S_{24} - S_{33} + S_{34}$。\n使用 $S_x$ 的元素：\n$S_{b_2 b_3} = e^{-1} - e^{-2} - 1.2 + e^{-1} = 2e^{-1} - e^{-2} - 1.2$。\n\n现在，我们代入数值：\n$S_{b_2 b_2} = S_{b_3 b_3} \\approx 2.4 - 2(0.367879) = 1.664242$。\n$S_{b_2 b_3} \\approx 2(0.367879) - 0.135335 - 1.2 = 0.735758 - 0.135335 - 1.2 = -0.599577$。\n\n双极相干性为：\n$$C_{\\mathrm{BIP}} = \\frac{|S_{b_2 b_3}|^2}{S_{b_2 b_2} S_{b_3 b_3}} = \\frac{(S_{b_2 b_3})^2}{(S_{b_2 b_2})^2} \\approx \\frac{(-0.599577)^2}{(1.664242)^2} \\approx \\frac{0.359493}{2.769696} \\approx 0.129795$$\n\n**3. 相干性比率**\n\n最后，我们计算比率 $\\rho = \\frac{C_{\\mathrm{CAR}}}{C_{\\mathrm{BIP}}}$。\n$$\\rho \\approx \\frac{0.017809}{0.129795} \\approx 0.137209$$\n四舍五入到四位有效数字，我们得到 $0.1372$。这个结果量化了两种参考方案对所测量的通道间相干性的相对影响。在这个特定场景下，CAR 比双极参考更显著地降低了相干性。",
            "answer": "$$\\boxed{0.1372}$$"
        }
    ]
}