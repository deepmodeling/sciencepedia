{
    "hands_on_practices": [
        {
            "introduction": "可电离药物的吸收在很大程度上取决于周围环境的$\\mathrm{pH}$值，这一原则被概括为$\\mathrm{pH}$-分配假说。本练习  提供了该理论的一个实际应用，要求您推导并量化肠道$\\mathrm{pH}$值的变化如何改变一种弱碱性药物的吸收通量。掌握这一计算对于预测药物在胃肠道不同区域的行为至关重要。",
            "id": "4565468",
            "problem": "一种单质子弱碱，其中心形式为$B$，共轭酸为$BH^{+}$，主要通过跨细胞被动扩散穿过肠上皮。跨细胞通量主要由中性形式$B$决定，因为只有非离子化物种能有效分配到脂质双分子层中。考虑一种情况，肠腔内$\\mathrm{pH}$值从$\\mathrm{pH} = 6.2$变为$\\mathrm{pH} = 8.0$，而肠腔内总药物浓度、膜厚度、膜表面积和扩散系数保持不变。该药物的共轭酸的酸解离常数满足$pK_{a} = 7.8$。假设存在基底外侧的汇集条件，使得中性物种$B$在基底外侧被有效清除，并且细胞旁转运可以忽略不计。\n\n从酸碱平衡的质量作用定律和Fick第一扩散定律出发，推导药物在肠腔中非离子化部分占总量的分数与$pK_{a}$和$\\mathrm{pH}$的函数关系式，然后用它来确定在$\\mathrm{pH} = 8.0$与$\\mathrm{pH} = 6.2$时稳态跨细胞吸收通量的比率。将最终答案以一个无量纲数的形式给出，该数等于$\\mathrm{pH} = 8.0$时的通量除以$\\mathrm{pH} = 6.2$时的通量，并将答案四舍五入到四位有效数字。",
            "solution": "该药物是一种单质子弱碱，其平衡为\n$$BH^{+} \\rightleftharpoons B + H^{+}.$$\n$BH^{+}$的酸解离常数$K_{a}$定义为\n$$K_{a} = \\frac{[B][H^{+}]}{[BH^{+}]}.$$\n使用$pK_{a} = -\\log_{10}(K_{a})$和$\\mathrm{pH} = -\\log_{10}([H^{+}])$，我们可以写出\n$$\\frac{[BH^{+}]}{[B]} = \\frac{[H^{+}]}{K_{a}} = 10^{pK_{a} - \\mathrm{pH}}.$$\n药物在肠腔中非离子化（中性碱$B$）的部分占总量的分数为\n$$f_{u} = \\frac{[B]}{[B] + [BH^{+}]} = \\frac{1}{1 + \\frac{[BH^{+}]}{[B]}} = \\frac{1}{1 + 10^{pK_{a} - \\mathrm{pH}}}.$$\n\n对于跨细胞被动扩散，Fick第一扩散定律指出，通量与跨膜的浓度梯度成正比：\n$$J = -D \\frac{dC}{dx}.$$\n在厚度为$L$的膜上达到稳态条件下，这可以表示为\n$$J = \\frac{D K}{L} \\Delta C_{u},$$\n其中$K$是非离子化物种的膜-水分配系数，$\\Delta C_{u}$是跨膜的非离子化浓度差。在基底外侧的汇集条件下，基底外侧的非离子化浓度实际上为零，因此$\\Delta C_{u}$就是肠腔内的非离子化浓度。如果在两种$\\mathrm{pH}$条件下，肠腔内总浓度$C_{\\text{tot}}$相同，并且$D$、$K$和$L$保持不变，那么通量满足\n$$J \\propto f_{u} C_{\\text{tot}},$$\n并且在两个$\\mathrm{pH}$值下的通量比简化为非离子化分数的比：\n$$R \\equiv \\frac{J(\\mathrm{pH}_{2})}{J(\\mathrm{pH}_{1})} = \\frac{f_{u}(\\mathrm{pH}_{2})}{f_{u}(\\mathrm{pH}_{1})} = \\frac{1 + 10^{pK_{a} - \\mathrm{pH}_{1}}}{1 + 10^{pK_{a} - \\mathrm{pH}_{2}}}.$$\n\n应用$pK_{a} = 7.8$，$\\mathrm{pH}_{1} = 6.2$和$\\mathrm{pH}_{2} = 8.0$：\n$$10^{pK_{a} - \\mathrm{pH}_{1}} = 10^{7.8 - 6.2} = 10^{1.6},$$\n$$10^{pK_{a} - \\mathrm{pH}_{2}} = 10^{7.8 - 8.0} = 10^{-0.2}.$$\n因此，\n$$R = \\frac{1 + 10^{1.6}}{1 + 10^{-0.2}}.$$\n计算$10$的幂，\n$$10^{1.6} \\approx 39.81071706,\\quad 10^{-0.2} \\approx 0.6309573445,$$\n所以\n$$R \\approx \\frac{1 + 39.81071706}{1 + 0.6309573445} = \\frac{40.81071706}{1.6309573445} \\approx 25.0226.$$\n\n四舍五入到四位有效数字，无量纲通量比为$25.02$。大于$1$的比率表明，将肠腔$\\mathrm{pH}$从$6.2$增加到$8.0$会增加跨细胞吸收，其增加的幅度由计算出的比率所反映。",
            "answer": "$$\\boxed{25.02}$$"
        },
        {
            "introduction": "在现实中，药物穿过肠壁的转运是被动扩散和主动的、载体介导过程的结合。本练习  将指导您分析来自PAMPA和Caco-2实验的数据，以区分并量化被动渗透与主动外排的贡献。这项技能对于解读体外数据和预测药物在体内的复杂吸收动力学以及潜在的药物-药物相互作用至关重要。",
            "id": "4565527",
            "problem": "一种亲脂性弱碱（分子量在“五规则”范围内）在匹配的缓冲液条件下，使用两种体外系统进行肠道吸收评估。使用平行人工膜渗透性测定 (PAMPA) 来估计纯被动跨细胞扩散，并使用人结直肠腺癌细胞系 Caco-2 来捕捉被动和转运体介导的两种组分。怀疑该化合物是顶侧外排转运体 P-糖蛋白 (P-gp; ATP 结合盒亚家族 B 成员 1, ABCB1) 的底物。所有测量均在模拟空肠腔和浆膜侧的 pH 值下进行，并已验证满足漏槽条件和稳态。在足够低的供体浓度下获得以下数据，在该浓度下转运体动力学相对于浓度处于线性区间：\n- PAMPA 有效渗透率：$P_{\\mathrm{PAMPA}} = 1.5 \\times 10^{-5}\\ \\mathrm{cm/s}$。\n- Caco-2 在吸收方向（顶侧到基底外侧）的表观渗透率：$P_{\\mathrm{app},A \\to B} = 2.0 \\times 10^{-6}\\ \\mathrm{cm/s}$。\n- Caco-2 在分泌方向（基底外侧到顶侧）的表观渗透率：$P_{\\mathrm{app},B \\to A} = 2.6 \\times 10^{-5}\\ \\mathrm{cm/s}$。\n\n从适用于药物吸收机制的第一性原理出发，按以下步骤进行：\n- 使用 Fick 第一定律描述被动跨细胞通量，并使用在 $C \\ll K_{m}$ 条件下的转运体介导通量的线性化形式（因此转运体介导的通量相对于浓度表现为一级清除率）。在稳态漏槽条件下，推导双向 Caco-2 表观渗透系数如何分解为纯被动组分和净外排清除率，并用测得的双向表观渗透率符号求解被动渗透率和有效外排清除率。\n- 将被动分数 $f_{\\mathrm{pass}}$ 定义为在这些低浓度条件下，Caco-2 中总跨细胞转运能力中可归因于被动扩散的部分，即被动渗透率与被动渗透率和有效外排清除率之和的比率。用测得的双向表观渗透率符号表示 $f_{\\mathrm{pass}}$。\n- 使用提供的数值计算 $f_{\\mathrm{pass}}$。将答案四舍五入至四位有效数字。最终答案以无单位的纯数表示。\n\n在你的推理中，简要说明你将如何使用 PAMPA 值来评估其与从 Caco-2 推断出的被动渗透率之间的任何差异，并指出至少两种不同的验证性实验来帮助验证转运体的参与，而不使用未经检验的快捷公式或无根据的假设。只有 $f_{\\mathrm{pass}}$ 的数值将被作为最终答案评分；所有其他元素仅用于展示基于第一性原理的推理过程。",
            "solution": "在稳态漏槽条件下，化合物穿过细胞单层的总通量 ($J$) 可以建模为被动和主动转运（输运）通量之和。表观渗透率 ($P_{\\text{app}}$) 定义为总通量除以供体浓度 ($C_{\\text{donor}}$) 进行归一化，即 $P_{\\text{app}} = J / C_{\\text{donor}}$。\n\n总通量是被动扩散和主动转运的叠加。被动扩散被假设为对称的，并由被动渗透率 $P_{\\text{pass}}$ 表征；而主动转运是有方向性的。问题指定了一个顶侧外排转运体 P-糖蛋白 (P-gp)，它将底物从基底外侧 (B) 室主动泵到顶侧 (A) 室。在指定的线性动力学条件 ($C \\ll K_m$) 下，该主动转运组分可以用有效外排清除率或渗透率 $P_{\\text{efflux}}$ 来表征。\n\n我们可以建立一个模型，其中观察到的双向表观渗透率是对称的被动组分和有方向性的主动组分的组合。\n\n在吸收方向（顶侧到基底外侧，A→B），净通量是药物穿过单层的被动扩散与 P-gp 外排泵将其送回顶侧的作用相抵消的结果。因此，有效渗透率是被动渗透率减去外排组分。\n$$P_{\\mathrm{app},A \\to B} = P_{\\text{pass}} - P_{\\text{efflux}} \\quad (1)$$\n\n在分泌方向（基底外侧到顶侧，B→A），被动扩散通量与 P-gp 介导的外排方向相同。它们的贡献是相加的。\n$$P_{\\mathrm{app},B \\to A} = P_{\\text{pass}} + P_{\\text{efflux}} \\quad (2)$$\n\n现在我们得到了一个包含两个未知数 $P_{\\text{pass}}$ 和 $P_{\\text{efflux}}$ 的二元线性方程组。\n\n为了求解 $P_{\\text{pass}}$，我们将方程 $(1)$ 和方程 $(2)$ 相加：\n$$P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A} = (P_{\\text{pass}} - P_{\\text{efflux}}) + (P_{\\text{pass}} + P_{\\text{efflux}})$$\n$$P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A} = 2 P_{\\text{pass}}$$\n$$P_{\\text{pass}} = \\frac{P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A}}{2}$$\n\n为了求解 $P_{\\text{efflux}}$，我们将方程 $(1)$ 从方程 $(2)$ 中减去：\n$$P_{\\mathrm{app},B \\to A} - P_{\\mathrm{app},A \\to B} = (P_{\\text{pass}} + P_{\\text{efflux}}) - (P_{\\text{pass}} - P_{\\text{efflux}})$$\n$$P_{\\mathrm{app},B \\to A} - P_{\\mathrm{app},A \\to B} = 2 P_{\\text{efflux}}$$\n$$P_{\\text{efflux}} = \\frac{P_{\\mathrm{app},B \\to A} - P_{\\mathrm{app},A \\to B}}{2}$$\n\n问题将被动分数 $f_{\\mathrm{pass}}$ 定义为被动渗透率与被动渗透率和有效外排清除率之和的比率：\n$$f_{\\mathrm{pass}} = \\frac{P_{\\text{pass}}}{P_{\\text{pass}} + P_{\\text{efflux}}}$$\n\n代入我们推导出的 $P_{\\text{pass}}$ 和 $(P_{\\text{pass}} + P_{\\text{efflux}})$ 的表达式：\n分子是 $P_{\\text{pass}} = \\frac{P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A}}{2}$。\n分母是 $(P_{\\text{pass}} + P_{\\text{efflux}})$，根据方程 $(2)$，它就是 $P_{\\mathrm{app},B \\to A}$。\n因此，$f_{\\mathrm{pass}}$ 的符号表达式是：\n$$f_{\\mathrm{pass}} = \\frac{\\left(\\frac{P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A}}{2}\\right)}{P_{\\mathrm{app},B \\to A}} = \\frac{P_{\\mathrm{app},A \\to B} + P_{\\mathrm{app},B \\to A}}{2 P_{\\mathrm{app},B \\to A}}$$\n\n现在，我们使用提供的数值数据计算这个表达式：\n$P_{\\mathrm{app},A \\to B} = 2.0 \\times 10^{-6}\\ \\mathrm{cm/s}$\n$P_{\\mathrm{app},B \\to A} = 2.6 \\times 10^{-5}\\ \\mathrm{cm/s}$\n\n$$f_{\\mathrm{pass}} = \\frac{(2.0 \\times 10^{-6}) + (2.6 \\times 10^{-5})}{2 \\times (2.6 \\times 10^{-5})} = \\frac{(0.2 \\times 10^{-5}) + (2.6 \\times 10^{-5})}{5.2 \\times 10^{-5}} = \\frac{2.8 \\times 10^{-5}}{5.2 \\times 10^{-5}}$$\n$$f_{\\mathrm{pass}} = \\frac{2.8}{5.2} \\approx 0.5384615...$$\n四舍五入到四位有效数字，我们得到 $f_{\\mathrm{pass}} = 0.5385$。\n\nPAMPA 渗透率值 $P_{\\mathrm{PAMPA}} = 1.5 \\times 10^{-5}\\ \\mathrm{cm/s}$ 可作为纯被动跨细胞扩散的独立测量值。使用我们推导出的模型，我们可以从 Caco-2 数据中计算出被动渗透率：\n$$P_{\\text{pass}} = \\frac{(2.0 \\times 10^{-6}) + (2.6 \\times 10^{-5})}{2} = \\frac{2.8 \\times 10^{-5}}{2} = 1.4 \\times 10^{-5}\\ \\mathrm{cm/s}$$\n从 Caco-2 推导出的 $P_{\\text{pass}}~(=1.4 \\times 10^{-5}\\ \\mathrm{cm/s})$ 与实验测定的 $P_{\\mathrm{PAMPA}}~(=1.5 \\times 10^{-5}\\ \\mathrm{cm/s})$ 之间的高度一致性，有力地支持了所使用的简单加和模型的有效性，这意味着观察到的渗透不对称性主要是由叠加在对称被动扩散之上的主动外排过程主导的。若存在显著差异，则表明该模型可能不完整（例如，存在未计入的摄取转运体或被动屏障本身的不对称性）。\n\n为了进一步验证 P-gp 的参与，可以进行两种不同的验证性实验：\n1.  **抑制实验**：在已知的、强效且特异性的 P-gp 抑制剂（例如 zosuquidar 或 elacridar）存在下，重复进行双向 Caco-2 渗透性测定。如果 P-gp 是起作用的转运体，对其的抑制将消除 $P_{\\text{efflux}}$ 组分。这将导致 $P_{\\mathrm{app},B \\to A}$ 降低，而 $P_{\\mathrm{app},A \\to B}$ 升高，使得两个值都收敛于真实的被动渗透率 $P_{\\text{pass}}$。外排比 ($ER = P_{\\mathrm{app},B \\to A} / P_{\\mathrm{app},A \\to B}$) 将从目前的 $(2.6 \\times 10^{-5}) / (2.0 \\times 10^{-6}) = 13$ 降低至接近 $1$ 的值。\n\n2.  **饱和实验**：在覆盖 $C \\ge K_m$ 区域的一系列递增底物浓度下进行双向测定。与被动扩散不同，转运体介导的通量是可饱和的。随着供体浓度的增加，容量固定的主动转运组分 ($V_{\\text{max}}$) 将占总通量中越来越小的比例。因此，包含主动转运项的分泌方向表观渗透率 $P_{\\mathrm{app},B \\to A}$ 将随浓度增加而降低。在高浓度下，外排比也将朝 $1$ 降低。",
            "answer": "$$\\boxed{0.5385}$$"
        },
        {
            "introduction": "为了真正理解转运体介导的吸收所带来的影响，我们可以建立量化模型来模拟这些复杂的相互作用。这项计算练习  要求您开发一个包含被动扩散和可饱和外排的肠道转运稳态模型，从而探索非线性吸收的根源。通过确定饱和阈值和分析剂量依赖性通量，您将更深刻地理解转运体动力学如何决定药物的口服暴露量。",
            "id": "4565500",
            "problem": "考虑一个单一的肠上皮节段，其模型包含一个顶膜（腔膜）和一个基底外侧膜（面向血液）。一种外源性化合物在两种膜上都表现出被动扩散，并且受到诸如P-糖蛋白（P-gp）等三磷酸腺苷结合盒（ABC）转运蛋白的主动顶膜外排作用。假设细胞外腔室混合均匀，浓度为 $C_{L}$，且基底外侧汇集区足够大，以至于血液浓度实际上为零。设细胞内浓度为 $C_{i}$。\n\n基本原理：\n- Fick 被动扩散定律：对于浓度为 $C$、渗透率为 $P$ 的物质穿过膜，当接收侧浓度可忽略不计时，通量为 $J_{\\mathrm{pass}} = P \\cdot C$。\n- 转运蛋白介导的外排的 Michaelis–Menten 动力学：对于细胞内浓度 $C_{i}$、最大外排能力 $V_{\\max}$ 和 Michaelis 常数 $K_{m}$，外排速率为 $v_{\\mathrm{efflux}} = \\dfrac{V_{\\max} \\, C_{i}}{K_{m} + C_{i}}$。\n\n模型假设和稳态质量平衡：\n- 从管腔进入的顶膜被动内流：$J_{\\mathrm{in}} = P_{a} \\, C_{L}$。\n- 进入血液的基底外侧被动外流：$J_{\\mathrm{out}} = P_{b} \\, C_{i}$。\n- 返回管腔的顶膜主动外排：$v_{\\mathrm{efflux}} = \\dfrac{V_{\\max} \\, C_{i}}{K_{m} + C_{i}}$。\n- 在稳态下，细胞内质量平衡要求 $J_{\\mathrm{in}} = J_{\\mathrm{out}} + v_{\\mathrm{efflux}}$。\n\n将进入血液的净吸收通量定义为 $J_{\\mathrm{abs}} = J_{\\mathrm{out}} = P_{b} \\, C_{i}$，它通过 $C_{i}$ 非线性地依赖于 $C_{L}$。您的程序必须：\n1. 仅使用所述基本原理，推导并求解关于 $C_{i}$ 的稳态代数方程，将其表示为 $C_{L}$ 和参数 $\\{P_{a}, P_{b}, V_{\\max}, K_{m}\\}$ 的函数。从 $C_{i}$ 计算 $J_{\\mathrm{abs}}$。\n2. 在管腔浓度范围 $C_{L} \\in \\{0.1, 1, 10, 100\\}$（单位为 $\\mu\\mathrm{M}$，即微摩尔/升）内模拟 $J_{\\mathrm{abs}}$。在内部，使用等式 $1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$ 将 $C_{L}$ 从 $\\mu\\mathrm{M}$ 转换为 $\\mathrm{pmol}/\\mathrm{cm}^{3}$，以保持单位表面积的通量单位一致。\n3. 基于最大外排的分数来确定外排饱和的管腔浓度阈值：找到使 $v_{\\mathrm{efflux}} \\geq s \\, V_{\\max}$ 成立的最小 $C_{L}$，其中 $s \\in \\{0.5, 0.9\\}$（百分之五十和百分之九十饱和度）。以 $\\mu\\mathrm{M}$ 为单位报告这些阈值。\n4. 通过计算 $J_{\\mathrm{abs}}$ 相对于 $C_{L}$ 在浓度范围的低端和高端的局部对数-对数弹性来量化口服暴露的非线性。对于给定的参考 $C_{L}$ 和一个分数扰动 $\\delta$，使用对称有限差分来近似弹性：\n$$\n\\mathcal{E}(C_{L}) \\approx \\frac{\\ln\\big(J_{\\mathrm{abs}}(C_{L}(1+\\delta))\\big) - \\ln\\big(J_{\\mathrm{abs}}(C_{L}(1-\\delta))\\big)}{\\ln\\big(C_{L}(1+\\delta)\\big) - \\ln\\big(C_{L}(1-\\delta))\\big)}.\n$$\n使用 $\\delta = 0.1$ 并计算在 $C_{L} = 0.1\\,\\mu\\mathrm{M}$ 和 $C_{L} = 100\\,\\mu\\mathrm{M}$ 处的 $\\mathcal{E}(C_{L})$。\n5. 计算在 $C_{L} = 10\\,\\mu\\mathrm{M}$ 时的 $J_{\\mathrm{abs}}$。\n\n单位：\n- 以 $\\mu\\mathrm{M}$ 为单位报告 $C_{L}$ 阈值，四舍五入到三位有效数字。\n- 以 $\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$ 为单位报告 $J_{\\mathrm{abs}}$，四舍五入到三位有效数字。\n- 将弹性报告为无量纲浮点数，四舍五入到三位有效数字。\n\n测试套件：\n为以下每组科学上合理的参数集提供输出：\n- 情况 A（基线）：$P_{a} = 1\\times 10^{-4}\\,\\mathrm{cm}/\\mathrm{s}$，$P_{b} = 5\\times 10^{-5}\\,\\mathrm{cm}/\\mathrm{s}$，$V_{\\max} = 0.5\\,\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$，$K_{m} = 1.0\\times 10^{4}\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$。\n- 情况 B（强外排能力）：$P_{a} = 1\\times 10^{-4}\\,\\mathrm{cm}/\\mathrm{s}$，$P_{b} = 5\\times 10^{-5}\\,\\mathrm{cm}/\\mathrm{s}$，$V_{\\max} = 2.0\\,\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$，$K_{m} = 1.0\\times 10^{4}\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$。\n- 情况 C（弱外排能力）：$P_{a} = 1\\times 10^{-4}\\,\\mathrm{cm}/\\mathrm{s}$，$P_{b} = 5\\times 10^{-5}\\,\\mathrm{cm}/\\mathrm{s}$，$V_{\\max} = 0.05\\,\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$，$K_{m} = 1.0\\times 10^{4}\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$。\n- 情况 D（高亲和力外排）：$P_{a} = 1\\times 10^{-4}\\,\\mathrm{cm}/\\mathrm{s}$，$P_{b} = 5\\times 10^{-5}\\,\\mathrm{cm}/\\mathrm{s}$，$V_{\\max} = 0.5\\,\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$，$K_{m} = 2.0\\times 10^{3}\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$。\n- 情况 E（有限的基底外侧渗透性）：$P_{a} = 1\\times 10^{-4}\\,\\mathrm{cm}/\\mathrm{s}$，$P_{b} = 1\\times 10^{-6}\\,\\mathrm{cm}/\\mathrm{s}$，$V_{\\max} = 0.5\\,\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$，$K_{m} = 1.0\\times 10^{4}\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个子列表对应一个情况，并按上述顺序列出。每个内部列表必须采用 $[C_{L,0.5}, C_{L,0.9}, \\mathcal{E}(0.1\\,\\mu\\mathrm{M}), \\mathcal{E}(100\\,\\mu\\mathrm{M}), J_{\\mathrm{abs}}(10\\,\\mu\\mathrm{M})]$ 的形式，数值四舍五入到三位有效数字，最终产生类似 $[[\\ldots],[\\ldots],\\ldots]$ 的字符串。",
            "solution": "问题的核心是确定外源性物质的稳态细胞内浓度 $C_{i}$，该浓度是肠上皮屏障上三个过程平衡的结果：被动顶膜内流、被动基底外侧外流和主动顶膜外排。一旦 $C_{i}$ 被确定为管腔浓度 $C_{L}$ 的函数，所有其他关注的量都可以计算出来。\n\n细胞内室的稳态质量平衡由内流和外流速率相等给出：\n$$\nJ_{\\mathrm{in}} = J_{\\mathrm{out}} + v_{\\mathrm{efflux}}\n$$\n代入各项的表达式：\n- 顶膜被动内流：$J_{\\mathrm{in}} = P_{a} \\, C_{L}$\n- 基底外侧被动外流：$J_{\\mathrm{out}} = P_{b} \\, C_{i}$\n- 顶膜主动外排：$v_{\\mathrm{efflux}} = \\dfrac{V_{\\max} \\, C_{i}}{K_{m} + C_{i}}$\n我们得到控制方程：\n$$\nP_{a} \\, C_{L} = P_{b} \\, C_{i} + \\frac{V_{\\max} \\, C_{i}}{K_{m} + C_{i}}\n$$\n所有计算将使用一套一致的单位进行：浓度单位为 $\\mathrm{pmol}/\\mathrm{cm}^{3}$，渗透率单位为 $\\mathrm{cm}/\\mathrm{s}$，通量（$V_{\\max}$, $J$）单位为 $\\mathrm{pmol}/(\\mathrm{cm}^{2}\\cdot\\mathrm{s})$。以 $\\mu\\mathrm{M}$ 为单位给出的输入管腔浓度 $C_{L}$，使用所提供的等式 $1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{pmol}/\\mathrm{cm}^{3}$ 进行转换。\n\n**1. 求解稳态细胞内浓度 ($C_{i}$)**\n\n为了求解 $C_{i}$，我们将控制方程重新排列成多项式形式。我们将整个方程乘以 $(K_{m} + C_{i})$ 以消除分母：\n$$\nP_{a} \\, C_{L} (K_{m} + C_{i}) = P_{b} \\, C_{i} (K_{m} + C_{i}) + V_{\\max} \\, C_{i}\n$$\n展开各项可得：\n$$\nP_{a} C_{L} K_{m} + P_{a} C_{L} C_{i} = P_{b} K_{m} C_{i} + P_{b} C_{i}^2 + V_{\\max} C_{i}\n$$\n这可以重新排列成标准二次方程的形式 $aC_{i}^2 + bC_{i} + c = 0$：\n$$\nP_{b} C_{i}^2 + (P_{b} K_{m} + V_{\\max} - P_{a} C_{L}) C_{i} - P_{a} C_{L} K_{m} = 0\n$$\n二次方程的系数是：\n- $a = P_{b}$\n- $b = P_{b} K_{m} + V_{\\max} - P_{a} C_{L}$\n- $c = -P_{a} C_{L} K_{m}$\n\n使用二次公式 $C_{i} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求得 $C_{i}$ 的解。由于 $C_{i}$ 必须是一个非负的物理浓度，我们必须选择适当的根。项 $-4ac = -4(P_{b})(-P_{a} C_{L} K_{m}) = 4 P_{b} P_{a} C_{L} K_{m}$ 总是非负的，确保判别式 $b^2 - 4ac$ 是实数且为正。为确保 $C_i > 0$，我们必须取正根，因为项 $\\sqrt{b^2-4ac}$ 总是大于 $|b|$。因此，具有物理意义的 $C_i$ 解为：\n$$\nC_{i} = \\frac{-(P_{b} K_{m} + V_{\\max} - P_{a} C_{L}) + \\sqrt{(P_{b} K_{m} + V_{\\max} - P_{a} C_{L})^2 + 4 P_{b} P_{a} C_{L} K_{m}}}{2 P_{b}}\n$$\n由此，进入血液的净吸收通量 $J_{\\mathrm{abs}}$ 计算如下：\n$$\nJ_{\\mathrm{abs}} = J_{\\mathrm{out}} = P_{b} \\, C_{i}\n$$\n\n**2. 计算外排饱和的管腔浓度阈值**\n\n问题要求找到管腔浓度 $C_{L}$，在该浓度下，外排速率 $v_{\\mathrm{efflux}}$ 达到其最大速率 $V_{\\max}$ 的特定分数 $s$。该条件表示为：\n$$\nv_{\\mathrm{efflux}} = s \\cdot V_{\\max}\n$$\n代入 $v_{\\mathrm{efflux}}$ 的 Michaelis-Menten 表达式：\n$$\n\\frac{V_{\\max} \\, C_{i}}{K_{m} + C_{i}} = s \\cdot V_{\\max}\n$$\n求解所需的细胞内浓度 $C_{i, \\text{target}}$：\n$$\n\\frac{C_{i, \\text{target}}}{K_{m} + C_{i, \\text{target}}} = s \\implies C_{i, \\text{target}} (1-s) = s K_{m} \\implies C_{i, \\text{target}} = \\frac{s K_{m}}{1-s}\n$$\n为了找到相应的管腔浓度 $C_{L}$，我们将此 $C_{i, \\text{target}}$ 和条件 $v_{\\mathrm{efflux}} = s \\cdot V_{\\max}$ 代回到原始的稳态质量平衡方程中：\n$$\nP_{a} \\, C_{L} = P_{b} \\, C_{i, \\text{target}} + s V_{\\max}\n$$\n求解 $C_{L}$ 得到饱和阈值公式：\n$$\nC_{L}(s) = \\frac{P_{b} \\, C_{i, \\text{target}} + s V_{\\max}}{P_{a}} = \\frac{P_{b} \\left( \\frac{s K_{m}}{1-s} \\right) + s V_{\\max}}{P_{a}}\n$$\n此公式用于计算 $s=0.5$（50% 饱和度）和 $s=0.9$（90% 饱和度）的阈值。结果从 $\\mathrm{pmol}/\\mathrm{cm}^{3}$ 转换为 $\\mu\\mathrm{M}$ 进行报告。\n\n**3. 计算吸收的对数-对数弹性**\n\n弹性 $\\mathcal{E}(C_{L})$ 衡量吸收通量 $J_{\\mathrm{abs}}$ 响应于管腔浓度 $C_{L}$ 的分数变化的局部性分数变化。它使用对数尺度上的对称有限差分来近似：\n$$\n\\mathcal{E}(C_{L}) \\approx \\frac{\\ln\\big(J_{\\mathrm{abs}}(C_{L}(1+\\delta))\\big) - \\ln\\big(J_{\\mathrm{abs}}(C_{L}(1-\\delta))\\big)}{\\ln\\big(C_{L}(1+\\delta)\\big) - \\ln\\big(C_{L}(1-\\delta))\\big)}\n$$\n分母可以简化为：$\\ln(C_{L}(1+\\delta)) - \\ln(C_{L}(1-\\delta)) = \\ln\\left(\\frac{1+\\delta}{1-\\delta}\\right)$。\n对于给定的 $C_{L}$ 和扰动 $\\delta=0.1$，计算过程包括：\n1. 计算在 $C_{L, \\text{high}} = C_{L}(1+\\delta)$ 和 $C_{L, \\text{low}} = C_{L}(1-\\delta)$ 处的 $J_{\\mathrm{abs}}$。\n2. 将这些通量值代入弹性公式。\n这对 $C_L = 0.1\\,\\mu\\mathrm{M}$ 和 $C_L = 100\\,\\mu\\mathrm{M}$ 执行。\n\n最终的实现涉及创建一个封装了这些推导公式的 Python 程序。对于每个参数集，它计算五个所需的值：两个 $C_L$ 阈值、两个弹性值，以及在 $C_L = 10\\,\\mu\\mathrm{M}$ 时的吸收通量。所有结果都按要求四舍五入到三位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the drug absorption problem for all test cases.\n    \"\"\"\n\n    # Conversion factor from uM to pmol/cm^3\n    CONV_FACTOR = 1000.0\n    # Fractional perturbation for elasticity calculation\n    DELTA = 0.1\n\n    def get_C_i(C_L_pmol, Pa, Pb, Vmax, Km):\n        \"\"\"\n        Solves the quadratic equation for the steady-state intracellular concentration Ci.\n        Args:\n            C_L_pmol (float): Luminal concentration in pmol/cm^3.\n            Pa, Pb, Vmax, Km (float): Model parameters.\n        Returns:\n            float: Intracellular concentration Ci in pmol/cm^3.\n        \"\"\"\n        # Coefficients of the quadratic equation a*Ci^2 + b*Ci + c = 0\n        a = Pb\n        b = Pb * Km + Vmax - Pa * C_L_pmol\n        c = -Pa * C_L_pmol * Km\n\n        # The discriminant is guaranteed to be non-negative for physical parameters.\n        discriminant = b**2 - 4 * a * c\n        sqrt_discriminant = np.sqrt(discriminant)\n        \n        # The positive root is the only physically meaningful solution for concentration.\n        Ci = (-b + sqrt_discriminant) / (2 * a)\n        return Ci\n\n    def get_J_abs(C_L_uM, Pa, Pb, Vmax, Km):\n        \"\"\"\n        Calculates the net absorptive flux J_abs for a given luminal concentration.\n        Args:\n            C_L_uM (float): Luminal concentration in uM.\n            Pa, Pb, Vmax, Km (float): Model parameters.\n        Returns:\n            float: Absorptive flux in pmol/(cm^2*s).\n        \"\"\"\n        C_L_pmol = C_L_uM * CONV_FACTOR\n        Ci = get_C_i(C_L_pmol, Pa, Pb, Vmax, Km)\n        J_abs = Pb * Ci\n        return J_abs\n\n    def calculate_elasticity(C_L_ref_uM, Pa, Pb, Vmax, Km):\n        \"\"\"\n        Computes the log-log elasticity of J_abs with respect to C_L.\n        Args:\n            C_L_ref_uM (float): Reference luminal concentration in uM.\n            Pa, Pb, Vmax, Km (float): Model parameters.\n        Returns:\n            float: Dimensionless elasticity.\n        \"\"\"\n        C_L_high_uM = C_L_ref_uM * (1 + DELTA)\n        C_L_low_uM = C_L_ref_uM * (1 - DELTA)\n\n        J_abs_high = get_J_abs(C_L_high_uM, Pa, Pb, Vmax, Km)\n        J_abs_low = get_J_abs(C_L_low_uM, Pa, Pb, Vmax, Km)\n        \n        numerator = np.log(J_abs_high) - np.log(J_abs_low)\n        denominator = np.log((1 + DELTA) / (1 - DELTA))\n\n        return numerator / denominator\n\n    def process_case(Pa, Pb, Vmax, Km):\n        \"\"\"\n        Calculates all required outputs for a single parameter set.\n        Args:\n            Pa, Pb, Vmax, Km (float): Model parameters.\n        Returns:\n            list: A list of the five computed metrics.\n        \"\"\"\n        # 1. Calculate C_L thresholds for efflux saturation\n        # For s=0.5 (50% saturation), C_i_target = K_m\n        C_i_target_05 = Km\n        C_L_05_pmol = (Pb * C_i_target_05 + 0.5 * Vmax) / Pa\n        C_L_05_uM = C_L_05_pmol / CONV_FACTOR\n\n        # For s=0.9 (90% saturation), C_i_target = 9 * K_m\n        C_i_target_09 = 9 * Km\n        C_L_09_pmol = (Pb * C_i_target_09 + 0.9 * Vmax) / Pa\n        C_L_09_uM = C_L_09_pmol / CONV_FACTOR\n\n        # 2. Compute elasticities\n        E_low = calculate_elasticity(0.1, Pa, Pb, Vmax, Km)\n        E_high = calculate_elasticity(100.0, Pa, Pb, Vmax, Km)\n\n        # 3. Compute J_abs at C_L = 10 uM\n        J_abs_10 = get_J_abs(10.0, Pa, Pb, Vmax, Km)\n        \n        return [C_L_05_uM, C_L_09_uM, E_low, E_high, J_abs_10]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (baseline)\n        (1e-4, 5e-5, 0.5, 1e4),\n        # Case B (strong efflux capacity)\n        (1e-4, 5e-5, 2.0, 1e4),\n        # Case C (weak efflux capacity)\n        (1e-4, 5e-5, 0.05, 1e4),\n        # Case D (high-affinity efflux)\n        (1e-4, 5e-5, 0.5, 2e3),\n        # Case E (limited basolateral permeability)\n        (1e-4, 1e-6, 0.5, 1e4),\n    ]\n\n    all_results = []\n    for case_params in test_cases:\n        results = process_case(*case_params)\n        all_results.append(results)\n\n    # Format the final output string to match the required format.\n    # Each value is formatted to 3 significant figures.\n    # The list of lists is converted to a string without extra spaces.\n    result_strings = []\n    for res_list in all_results:\n        # Using .3g format specifier handles rounding to 3 significant figures.\n        formatted_vals = [f\"{val:.3g}\" for val in res_list]\n        result_strings.append(f\"[{','.join(formatted_vals)}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n\n```"
        }
    ]
}