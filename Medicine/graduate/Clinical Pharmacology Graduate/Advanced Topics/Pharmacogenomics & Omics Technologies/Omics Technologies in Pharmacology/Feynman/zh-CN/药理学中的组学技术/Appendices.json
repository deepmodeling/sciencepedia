{
    "hands_on_practices": [
        {
            "introduction": "在启动任何组学研究之前，严谨的实验设计是确保研究成功的基石。本练习将引导你完成一项关键的实验设计任务：为RNA测序（RNA-seq）实验进行功效分析（power analysis）。通过应用RNA-seq数据中标准的负二项分布模型，你将计算出检测到预定基因表达变化所需的最小样本量，这是避免研究资源浪费并确保结果可靠性的关键一步。",
            "id": "4569652",
            "problem": "一项临床药理学研究旨在使用RNA测序（RNA-seq）技术，检测药物对某个预先指定的药物基因的诱导调控作用。每个样本中该基因的标准化读取计数被建模为独立的负二项随机变量，这是RNA-seq分析的一种标准方法。具体而言，假设对于条件 $k \\in \\{1,2\\}$，第 $i$ 个生物学重复的计数 $Y_{ik}$ 的均值为 $\\mu_k$，离散度为 $\\phi$，其方差由 $\\mathrm{Var}(Y_{ik}) = \\mu_k + \\phi \\mu_k^{2}$ 给出。这个方差模型同时捕捉了泊松抽样噪声和过度离散现象。\n\n你将比较两组，每组具有相同数量的生物学重复，并且在标准化后具有相同的文库大小。主要分析是使用一种Wald型z检验来检验自然对数尺度上的平均表达量差异，该检验基于对数转换后组均值的差异。假设大样本正态近似适用于对数均值差异估计量。考虑一个双侧检验，其I型错误率 $\\alpha = 0.05$，期望的统计功效为 $1 - \\beta = 0.80$。\n\n关于该基因的初步数据显示，在参考条件下，基线标准化均值为 $\\mu_2 = 10$，在处理条件下预期有两倍的诱导，因此 $\\mu_1 = 20$。离散度估计值为 $\\phi = 0.20$。假设在生物学重复之间和条件之间是独立的。\n\n在这些假设下，确定每组所需生物学重复的最小整数数量 $n$，以达到至少目标统计功效。将任何中间的正态分位数四舍五入至至少六位有效数字。报告每组满足统计功效标准的最小整数 $n$。最终答案必须是一个单一的数字（无单位）。",
            "solution": "本题旨在计算RNA-seq实验所需的样本量，以达到预定的统计功效。我们将使用基于负二项分布模型的功效分析公式。\n\n### 步骤1：定义假设和检验统计量\n我们要检验的参数是两组平均表达水平自然对数的差异，即对数倍数变化（log-fold change），$\\delta = \\log(\\mu_1) - \\log(\\mu_2)$。\n- 零假设 $H_0: \\delta = 0$（两组表达水平无差异）。\n- 备择假设 $H_A: \\delta \\neq 0$（两组表达水平有差异）。\n- 检验统计量基于 $\\delta$ 的估计量 $\\hat{\\delta} = \\log(\\bar{Y}_1) - \\log(\\bar{Y}_2)$，其中 $\\bar{Y}_k$ 是第 $k$ 组的样本均值。\n\n### 步骤2：推导估计量的方差\n根据delta方法，$\\log(\\bar{Y}_k)$ 的方差近似为：\n$$ \\mathrm{Var}(\\log(\\bar{Y}_k)) \\approx \\left(\\frac{d}{d\\bar{Y}_k} \\log(\\bar{Y}_k)\\bigg|_{E[\\bar{Y}_k]=\\mu_k}\\right)^2 \\mathrm{Var}(\\bar{Y}_k) = \\left(\\frac{1}{\\mu_k}\\right)^2 \\mathrm{Var}(\\bar{Y}_k) $$\n首先计算样本均值的方差 $\\mathrm{Var}(\\bar{Y}_k)$：\n$$ \\mathrm{Var}(\\bar{Y}_k) = \\mathrm{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} Y_{ik}\\right) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\mathrm{Var}(Y_{ik}) = \\frac{1}{n} (\\mu_k + \\phi \\mu_k^2) $$\n代入上式可得：\n$$ \\mathrm{Var}(\\log(\\bar{Y}_k)) \\approx \\left(\\frac{1}{\\mu_k}\\right)^2 \\frac{\\mu_k + \\phi \\mu_k^2}{n} = \\frac{1}{n} \\left(\\frac{1}{\\mu_k} + \\phi\\right) $$\n由于两组独立，$\\hat{\\delta}$ 的方差是两组方差之和：\n$$ \\mathrm{Var}(\\hat{\\delta}) = \\mathrm{Var}(\\log(\\bar{Y}_1)) + \\mathrm{Var}(\\log(\\bar{Y}_2)) = \\frac{1}{n} \\left(\\frac{1}{\\mu_1} + \\frac{1}{\\mu_2} + 2\\phi\\right) $$\n\n### 步骤3：建立功效分析公式\n对于双侧检验，样本量 $n$ 必须满足以下条件：\n$$ n \\ge \\frac{\\left(\\frac{1}{\\mu_1} + \\frac{1}{\\mu_2} + 2\\phi\\right) (z_{1-\\alpha/2} + z_{1-\\beta})^2}{(\\log(\\mu_1/\\mu_2))^2} $$\n其中 $z_q$ 是标准正态分布的第 $q$ 个分位数。\n\n### 步骤4：代入数值进行计算\n- 均值：$\\mu_1 = 20, \\mu_2 = 10$\n- 离散度：$\\phi = 0.20$\n- I型错误率：$\\alpha = 0.05 \\implies z_{1-\\alpha/2} = z_{0.975} \\approx 1.959964$\n- 统计功效：$1 - \\beta = 0.80 \\implies z_{1-\\beta} = z_{0.80} \\approx 0.841621$\n\n计算公式中的各项：\n- 分子中的方差项：$\\frac{1}{\\mu_1} + \\frac{1}{\\mu_2} + 2\\phi = \\frac{1}{20} + \\frac{1}{10} + 2(0.20) = 0.05 + 0.1 + 0.4 = 0.55$\n- 分母中的效应量平方：$(\\log(\\mu_1/\\mu_2))^2 = (\\log(2))^2 \\approx (0.693147)^2 \\approx 0.480453$\n- Z值之和的平方：$(z_{0.975} + z_{0.80})^2 \\approx (1.959964 + 0.841621)^2 = (2.801585)^2 \\approx 7.848879$\n\n代入公式：\n$$ n \\ge \\frac{0.55 \\times 7.848879}{0.480453} \\approx \\frac{4.316883}{0.480453} \\approx 8.985 $$\n由于样本量 $n$ 必须是整数，我们需要向上取整：\n$$ n = \\lceil 8.985 \\rceil = 9 $$\n因此，每组至少需要9个生物学重复才能达到目标统计功效。",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "RNA测序实验产生的原始读数（raw counts）受到转录本长度和测序深度的影响，因此无法直接用于比较基因表达水平。本练习将深入探讨数据标准化的核心概念，要求你从第一性原理出发，推导并计算“每百万转录本”（TPM）这一关键指标。掌握这项技能对于从原始测序数据中准确量化和比较基因丰度至关重要。",
            "id": "4569575",
            "problem": "一个临床药理学实验室正在使用RNA测序（RNA-seq）技术，对药物代谢酶和转运体的肝脏信使核糖核酸（mRNA）表达进行定量分析。该实验室旨在比较单一样本中不同转录本的表达水平，而不受转录本长度或测序深度的混杂影响。请从分子生物学的中心法则（脱氧核糖核酸转录为核糖核酸，再翻译为蛋白质）以及RNA-seq的抽样本质出发，用文字定义“每百万转录本数”（TPM）和“每千碱基每百万映射片段数”（FPKM），并从概念上解释它们与未标准化的片段计数有何不同。然后，仅使用核心定义，根据一个转录本观测到的片段计数、长度以及样本的总长度标准化信号，推导出一个计算该转录本TPM值的公式。\n\n给定一份双末端RNA-seq数据，其总映射片段数为 $N = 28 \\times 10^{6}$。对于一个用于指导窄治疗指数药物剂量的肝细胞样本，为了本次计算的目的，只有以下五个转录本有明显表达：\n\n- CYP3A4：比对上的片段数 $r_{\\mathrm{A4}} = 380{,}000$，有效转录本长度 $\\ell_{\\mathrm{A4}} = 4.8 \\ \\mathrm{kb}$。\n- CYP2C9：比对上的片段数 $r_{\\mathrm{2C9}} = 140{,}000$，有效转录本长度 $\\ell_{\\mathrm{2C9}} = 3.2 \\ \\mathrm{kb}$。\n- CYP2D6：比对上的片段数 $r_{\\mathrm{2D6}} = 60{,}000$，有效转录本长度 $\\ell_{\\mathrm{2D6}} = 4.4 \\ \\mathrm{kb}$。\n- ABCB1：比对上的片段数 $r_{\\mathrm{ABCB1}} = 90{,}000$，有效转录本长度 $\\ell_{\\mathrm{ABCB1}} = 4.6 \\ \\mathrm{kb}$。\n- UGT1A1：比对上的片段数 $r_{\\mathrm{UGT1A1}} = 110{,}000$，有效转录本长度 $\\ell_{\\mathrm{UGT1A1}} = 2.0 \\ \\mathrm{kb}$。\n\n请使用与上述定义一致的第一性原理推导，计算此样本中CYP3A4的TPM值，在此计算中，将所列的五个转录本视为构成整个表达的转录组。将TPM报告为无量纲量，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "本题要求定义两种常用的RNA-seq标准化方法（FPKM和TPM），并计算给定基因的TPM值。\n\n### 第一部分：概念定义与推导\n\nRNA-seq实验中，一个基因的原始片段计数（raw count）受两个主要因素影响：1) 转录本的长度（越长的转录本，随机片段化后产生的片段越多）；2) 测序深度（总测序量越大，每个基因的计数也越高）。因此，直接比较原始计数是不可靠的。\n\n-   **每千碱基每百万映射片段数 (FPKM - Fragments Per Kilobase of transcript per Million mapped reads)**：FPKM同时对转录本长度和测序深度进行校正。其计算方法是，先将一个基因的片段计数除以其转录本长度（以kb为单位），再除以该样本的总映射片段数（以百万为单位）。\n    $$ \\mathrm{FPKM}_i = \\frac{r_i}{\\ell_i \\times (N/10^6)} $$\n    其中 $r_i$ 是基因 $i$ 的片段数，$\\ell_i$ 是其长度（kb），$N$ 是总映射片段数。FPKM的主要缺点是，不同样本的FPKM值总和不相等，这给样本间的比较带来不便。\n\n-   **每百万转录本数 (TPM - Transcripts Per Million)**：TPM是另一种标准化方法，它解决了FPKM的上述问题。TPM的计算分两步：\n    1.  **长度标准化**：首先，将每个基因的原始片段计数 $r_j$ 除以其长度 $\\ell_j$（kb）。这个值 $r_j/\\ell_j$ 与基因的相对摩尔丰度成正比。\n    2.  **文库大小标准化**：将第一步得到的所有基因的 $r_j/\\ell_j$ 值相加，得到一个总和 $S = \\sum_j (r_j/\\ell_j)$。然后，用每个基因的 $r_i/\\ell_i$ 值除以这个总和 $S$，得到该基因在转录本总数中的比例。最后将此比例乘以 $10^6$。\n    $$ \\mathrm{TPM}_i = \\left( \\frac{r_i / \\ell_i}{\\sum_j (r_j / \\ell_j)} \\right) \\times 10^6 $$\n    TPM的优点是，一个样本中所有基因的TPM值之和恒为一百万 ($10^6$)，这使得TPM值可以被直观地理解为一个基因在所有转录本中的相对丰度，更适合样本间的比较。\n\n### 第二部分：CYP3A4的TPM计算\n\n根据题目要求，我们将仅使用给定的五个转录本计算TPM。\n\n1.  计算每个转录本的长度标准化信号 ($r_j/\\ell_j$)：\n    -   $c_{\\mathrm{A4}} = \\frac{380000}{4.8} \\approx 79166.67$\n    -   $c_{\\mathrm{2C9}} = \\frac{140000}{3.2} = 43750$\n    -   $c_{\\mathrm{2D6}} = \\frac{60000}{4.4} \\approx 13636.36$\n    -   $c_{\\mathrm{ABCB1}} = \\frac{90000}{4.6} \\approx 19565.22$\n    -   $c_{\\mathrm{UGT1A1}} = \\frac{110000}{2.0} = 55000$\n\n2.  计算总的长度标准化信号 $S$：\n    $$ S = 79166.67 + 43750 + 13636.36 + 19565.22 + 55000 \\approx 211118.25 $$\n\n3.  计算CYP3A4的TPM值：\n    $$ \\mathrm{TPM}_{\\mathrm{A4}} = \\left( \\frac{c_{\\mathrm{A4}}}{S} \\right) \\times 10^6 = \\left( \\frac{79166.67}{211118.25} \\right) \\times 10^6 \\approx 375000.08 $$\n\n4.  按要求四舍五入至四位有效数字：\n    $$ \\mathrm{TPM}_{\\mathrm{A4}} \\approx 3.750 \\times 10^5 $$",
            "answer": "$$\n\\boxed{3.750 \\times 10^5}\n$$"
        },
        {
            "introduction": "组学技术的最终目标之一是实现个体化精准医疗。本练习模拟了一个经典的临床药理学场景，即如何利用患者的遗传信息来调整药物剂量。基于稳态药代动力学的基本原理，你将计算一个因特定基因型导致药物清除率降低的患者所需的新维持剂量，从而深刻理解药理基因组学如何将基因信息转化为具体的临床决策。",
            "id": "4569593",
            "problem": "一种用于慢性治疗的亲脂性口服药物主要通过肝酶细胞色素P450 2D6亚家族（CYP2D6）清除。在强代谢者中，临床药代动力学特征表明，在口服生物利用度 $F = 0.80$ 的情况下，每 $\\tau = 12\\,\\mathrm{h}$ 服用 $D_{\\mathrm{EM}} = 250\\,\\mathrm{mg}$ 的剂量，在线性药代动力学条件下可达到所需的目标平均稳态浓度 $C_{ss,\\mathrm{avg}}^{*}$。一名患者的全基因组测序显示其具有功能丧失型基因型，导致其清除率相对于强代谢者降低了 $50\\%$，因此 $CL_{\\mathrm{PM}} = 0.50 \\times CL_{\\mathrm{EM}}$。假设药代动力学为线性，$\\tau$ 和 $F$ 不受基因型影响，且稳态由质量平衡决定，即一个给药间隔内的平均给药速率等于平均消除速率，并且消除遵循一级动力学和清除率。\n\n根据这些原理，确定弱代谢者为维持相同的目标平均稳态浓度 $C_{ss,\\mathrm{avg}}^{*}$ 所需的新维持剂量 $D_{\\mathrm{PM}}$。将您的答案四舍五入至三位有效数字，并以 $\\mathrm{mg}$ 为单位表示最终剂量。",
            "solution": "本题要求根据药代动力学原理，为一个因基因型导致药物清除率降低的患者计算新的维持剂量。\n\n### 核心原理：稳态质量平衡\n\n在稳态（steady state）下，药物进入体内的平均速率等于药物从体内消除的平均速率。\n\n-   **平均给药速率**：对于口服药物，进入体循环的平均速率为 $\\frac{F \\times D}{\\tau}$，其中 $D$ 是维持剂量， $F$ 是生物利用度，$\\tau$ 是给药间隔。\n-   **平均消除速率**：对于遵循一级动力学的药物，平均消除速率为 $CL \\times C_{ss,\\mathrm{avg}}$，其中 $CL$ 是药物的总清除率，$C_{ss,\\mathrm{avg}}$ 是平均稳态血浆浓度。\n\n在稳态下，两个速率相等：\n$$ \\frac{F \\times D}{\\tau} = CL \\times C_{ss,\\mathrm{avg}} $$\n由此可得平均稳态浓度的计算公式：\n$$ C_{ss,\\mathrm{avg}} = \\frac{F \\times D}{CL \\times \\tau} $$\n\n### 计算步骤\n\n1.  **建立强代谢者（EM）的方程**\n    对于强代谢者，给定的给药方案能够达到目标平均稳态浓度 $C_{ss,\\mathrm{avg}}^{*}$：\n    $$ C_{ss,\\mathrm{avg}}^{*} = \\frac{F \\times D_{\\mathrm{EM}}}{CL_{\\mathrm{EM}} \\times \\tau} $$\n    其中，$D_{\\mathrm{EM}} = 250\\,\\mathrm{mg}$。\n\n2.  **建立弱代谢者（PM）的方程**\n    对于弱代谢者，我们需要找到一个新的剂量 $D_{\\mathrm{PM}}$，以达到相同的目标浓度 $C_{ss,\\mathrm{avg}}^{*}$。该患者的清除率为 $CL_{\\mathrm{PM}}$：\n    $$ C_{ss,\\mathrm{avg}}^{*} = \\frac{F \\times D_{\\mathrm{PM}}}{CL_{\\mathrm{PM}} \\times \\tau} $$\n\n3.  **求解新剂量 $D_{\\mathrm{PM}}$**\n    由于目标浓度相同，我们可以令上述两个方程相等：\n    $$ \\frac{F \\times D_{\\mathrm{EM}}}{CL_{\\mathrm{EM}} \\times \\tau} = \\frac{F \\times D_{\\mathrm{PM}}}{CL_{\\mathrm{PM}} \\times \\tau} $$\n    消去等式两边的公共项 $F$ 和 $\\tau$，得到：\n    $$ \\frac{D_{\\mathrm{EM}}}{CL_{\\mathrm{EM}}} = \\frac{D_{\\mathrm{PM}}}{CL_{\\mathrm{PM}}} $$\n    这个关系表明，要维持相同的稳态浓度，剂量必须与清除率成正比。\n\n    整理后可得 $D_{\\mathrm{PM}}$ 的计算公式：\n    $$ D_{\\mathrm{PM}} = D_{\\mathrm{EM}} \\times \\frac{CL_{\\mathrm{PM}}}{CL_{\\mathrm{EM}}} $$\n\n4.  **代入数值**\n    题目给出弱代谢者的清除率是强代谢者的 $50\\%$，即 $CL_{\\mathrm{PM}} = 0.50 \\times CL_{\\mathrm{EM}}$。因此，清除率之比为：\n    $$ \\frac{CL_{\\mathrm{PM}}}{CL_{\\mathrm{EM}}} = 0.50 $$\n    将已知值代入公式：\n    $$ D_{\\mathrm{PM}} = 250\\,\\mathrm{mg} \\times 0.50 = 125\\,\\mathrm{mg} $$\n\n    该结果已有三位有效数字，符合题目要求。因此，弱代谢者所需的新维持剂量为 $125\\,\\mathrm{mg}$。",
            "answer": "$$\\boxed{125}$$"
        }
    ]
}