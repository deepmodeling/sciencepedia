{
    "hands_on_practices": [
        {
            "introduction": "在任何真实世界数据（RWD）研究中，至关重要的第一步是精确地定义研究队列。这项练习 () 将挑战你像数据科学家和流行病学家一样思考，将识别他汀类药物“新用户”的临床标准转化为一个精确的、可计算的表型。通过处理诸如洗脱期、最低用药天数和剂量阈值等实际问题，你将掌握从庞杂的原始数据中筛选出合格研究对象的基础技能，这是确保研究有效性的基石。",
            "id": "4587684",
            "problem": "您将获得从临床药理学领域的真实世界数据 (RWD) 中提取的纵向处方配药记录，并需要使用世界卫生组织解剖学治疗学及化学分类系统 (ATC) 编码来构建他汀类药物新用的可计算表型。输出必须仅根据所提供的数据和常量进行计算。您必须实现一个程序，为每个测试用例确定是否存在至少一个有效的队列入口（指标配药），该入口同时满足以下所有规则：\n\n1.  指标配药属于他汀类药物，通过以 $C10AA$ 为前缀的 ATC 编码（3-羟基-3-甲基戊二酰辅酶A (HMG-CoA) 还原酶抑制剂）来识别。\n2.  指标配药的最短供应天数至少为 $D_{\\min} = 30$ 天，其中天数以整天为单位计算。\n3.  指标配药的平均日剂量，定义为总配发量除以供应天数，必须达到或超过特定成分的剂量阈值。平均日剂量 $\\delta$ 必须计算为 $$\\delta = \\frac{s \\cdot q}{d},$$ 其中 $s$ 是每单位的药物强度（单位：$\\mathrm{mg}$），$q$ 是配发的单位数量，而 $d$ 是记录的供应天数（单位：天）。剂量阈值（单位：$\\mathrm{mg/day}$）如下：\n    -   Atorvastatin ($C10AA05$)：阈值 $10$，\n    -   Rosuvastatin ($C10AA07$)：阈值 $5$，\n    -   Simvastatin ($C10AA01$)：阈值 $20$，\n    -   Pravastatin ($C10AA03$)：阈值 $40$。\n4.  指标配药前必须有一个 $W = 180$ 天的洗脱期。洗脱期意味着区间 $[t_{\\mathrm{index}} - W, t_{\\mathrm{index}} - 1]$ 内不包含任何更早配药的他汀类药物暴露覆盖期。一次从第 $t_i$ 天开始、供应天数为 $d_i$ 的配药，其覆盖期为闭区间 $[t_i, t_i + d_i - 1]$（单位：天）。此覆盖区间与洗脱区间的任何重叠都会使候选指标配药无效。洗脱期规则适用于任何他汀类药物暴露，无论剂量或供应天数如何。非他汀类药物的配药（ATC 编码不以 $C10AA$ 开头）不计入洗脱期。\n\n附加说明：\n- 所有日期 $t$ 均表示为距离名义队列开始时间的整数天数偏移量；除了整数算術外，没有日历逻辑。所有剂量计算必须以 $\\mathrm{mg/day}$ 为单位。所有时长必须以天为单位。\n- 如果没有满足最短供应天数和剂量阈值规则的配药，则该测试用例的结果为 $False$。如果至少有一次配药满足规则 $1$–$3$ 并且也满足洗脱期规则 $4$，则该测试用例的结果为 $True$。如果一个较早的候选配药因洗脱期而失败，较晚的候选配药只要满足所有相对于其自身配药日期之前的暴露期的规则，仍然可以符合资格。\n- 原则上允许使用 RxNorm，但在这些测试用例中仅使用 ATC 编码。\n\n您的程序必须处理以下测试套件，其中每个测试用例是一个元组列表 $(p, t, c_s, c, s, q, d)$，分别代表患者标识符 $p$、配药日 $t$（整数天）、编码系统 $c_s$、ATC 编码 $c$、每单位强度 $s$（单位 $\\mathrm{mg}$）、数量 $q$（单位：片等）和供应天数 $d$（单位：天）。\n\n所有测试用例的常量：\n- 洗脫窗口长度 $W = 180$ 天。\n- 最短供应天数 $D_{\\min} = 30$ 天。\n- 剂量阈值（单位 $\\mathrm{mg/day}$）：atorvastatin ($10$)、rosuvastatin ($5$)、simvastatin ($20$)、pravastatin ($40$)。\n\n测试用例：\n\n- Case $1$ (顺利通过，新用符合资格):\n  - $[(1, 200, \\text{\"ATC\"}, \\text{\"C10AA05\"}, 20, 30, 30)]$。\n\n- Case $2$ (之前的他汀类药物覆盖期违反了洗脱期规则):\n  - $[(2, 50, \\text{\"ATC\"}, \\text{\"C10AA01\"}, 20, 30, 30), (2, 200, \\text{\"ATC\"}, \\text{\"C10AA05\"}, 20, 30, 30)]$。\n\n- Case $3$ (未满足最短供应天数):\n  - $[(3, 100, \\text{\"ATC\"}, \\text{\"C10AA07\"}, 10, 14, 14)]$。\n\n- Case $4$ (剂量恰好在阈值上，符合资格):\n  - $[(4, 500, \\text{\"ATC\"}, \\text{\"C10AA01\"}, 20, 30, 30)]$。\n\n- Case $5$ (之前的非他汀类药物暴露被忽略；他汀类药物符合资格):\n  - $[(5, 10, \\text{\"ATC\"}, \\text{\"C10AB04\"}, 600, 60, 30), (5, 200, \\text{\"ATC\"}, \\text{\"C10AA03\"}, 40, 30, 30)]$。\n\n- Case $6$ (较早的低剂量他汀类药物破坏了较晚候选配药的洗脱期):\n  - $[(6, 400, \\text{\"ATC\"}, \\text{\"C10AA05\"}, 10, 30, 60), (6, 500, \\text{\"ATC\"}, \\text{\"C10AA05\"}, 20, 30, 30)]$。\n\n- Case $7$ (边界情况：最后一次覆盖期在 $t_{\\mathrm{index}} - W$ 结束，洗脱期失败):\n  - $[(7, 200, \\text{\"ATC\"}, \\text{\"C10AA01\"}, 20, 21, 21), (7, 400, \\text{\"ATC\"}, \\text{\"C10AA07\"}, 10, 30, 30)]$。\n\n- Case $8$ (边界情况：最后一次覆盖期在 $t_{\\mathrm{index}} - W - 1$ 结束，洗脱期通过):\n  - $[(8, 200, \\text{\"ATC\"}, \\text{\"C10AA01\"}, 20, 20, 20), (8, 400, \\text{\"ATC\"}, \\text{\"C10AA07\"}, 10, 30, 30)]$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的结果列表，并用方括号括起来（例如 $[\\text{result}_1,\\text{result}_2,\\dots]$），其中每个 $\\text{result}_i$ 是一个布尔值，指示相应测试用例是否满足表型标准（按上面列出的顺序）。",
            "solution": "该问题陈述已经过验证，并被确定为合理。它在科学上基于临床药理学和药物流行病学的原理，问题定义明确，并采用客观、可形式化的标准进行阐述。该问题要求基于一套应用于纵向处方数据的精确规则，实现一个用于他汀类药物新用的可计算表型。\n\n问题的核心是确定对于给定患者的处方史，是否存在至少一次配药可以作为有效的“指标配药”，标志着他汀类药物的新使用。解决方案要求对每个处方记录按照四个规则序列进行系统性评估。\n\n算法的设计基于以下原则：\n\n1.  **表型规则形式化**：可计算表型由一组明确的、可由机器执行的规则定义。提供的四个规则形式化如下：\n    *   **规则 1 (他汀类药物)**：处方必须是针对 HMG-CoA 还原酶抑制剂（一种他汀类药物）。这通过其解剖学治疗学及化学分类系统 (ATC) 编码 `$c$` 来识别，该编码必须具有前缀 `$C10AA$`。这是一个字符串匹配条件。\n    *   **规则 2 (供应天数)**：治疗持续时间必须是实质性的。配药的供应天数 `$d$` 必须至少为 `$D_{\\min} = 30$` 天。这是一个简单的不等式：`$d \\ge 30$`。\n    *   **规则 3 (剂量阈值)**：配药必须代表治疗剂量，而不是亚治疗剂量或递减剂量。平均日剂量 `$\\delta$` 计算为 `$$ \\delta = \\frac{s \\cdot q}{d} $$`，其中 `$s$` 是每单位的强度（单位 `$\\mathrm{mg}$`），`$q$` 是单位数量，`$d$` 是供应天数。计算出的剂量 `$\\delta$` 必须大于或等于预先指定的阈值 `$\\delta_{\\text{threshold}}$`，该阈值特定于药物成分。问题为四种他汀类药物提供了阈值：Atorvastatin (`$C10AA05$`，`$\\delta_{\\text{threshold}} = 10 \\mathrm{mg/day}$`)、Rosuvastatin (`$C10AA07$`，`$\\delta_{\\text{threshold}} = 5 \\mathrm{mg/day}$`)、Simvastatin (`$C10AA01$`，`$\\delta_{\\text{threshold}} = 20 \\mathrm{mg/day}$`) 和 Pravastatin (`$C10AA03$`，`$\\delta_{\\text{threshold}} = 40 \\mathrm{mg/day}$`)。\n    *   **规则 4 (洗脱期)**：为了符合“新用”资格，患者在指标配药前必须有一段确定的时间内未使用他汀类药物治疗。需要一个 `$W = 180$` 天的洗脫期。对于一个在配药日 `$t_{\\text{index}}$` 的候选指标配药，洗脱区间定义为闭区间 `$I_W = [t_{\\text{index}} - W, t_{\\text{index}} - 1]$`，即 `$[t_{\\text{index}} - 180, t_{\\text{index}} - 1]$`。此区间内必须没有任何先前他汀类药物配药的暴露覆盖期。任何在 `$t_i$` 配药、供应 `$d_i$` 天的先前配药，其暴露覆盖期为闭区间 `$I_{C,i} = [t_i, t_i + d_i - 1]$`。如果对于任何先前的他汀类药物配药 `$i$`，其覆盖区间与洗脱区间的交集非空，即 `$I_W \\cap I_{C,i} \\neq \\emptyset$`，则违反洗脱期规则。两个闭区间 `$[a, b]$` 和 `$[c, d]$` 相交当且仅当 `$a \\le d$` 和 `$c \\le b$`。\n\n2.  **迭代候选评估**：问题要求寻找*至少一个*符合条件的指标配药的存在性。因此，算法必须遍历患者的处方记录，将每一条记录视为一个潜在的候选。为确保洗脱期规则的时间评估正确，记录必须首先按配药日 `$t$` 进行时间排序。设排序后的记录为 `$R_0, R_1, \\dots, R_{N-1}$`。\n    算法过程如下：\n    *   对于每个记录 `$R_i$`（其中 `$i$` 从 `$0$` 到 `$N-1$`）：\n        1.  将 `$R_i$` 视为 `candidate_fill`。\n        2.  检查 `$R_i$` 是否满足内在标准：规则 1 (他汀类药物)、规则 2 (最短供应天数) 和规则 3 (剂量阈值)。如果其中任何一条失败，`$R_i$` 不能作为指标配药，算法继续处理下一个候选 `$R_{i+1}$`。\n        3.  如果规则 1-3 得到满足，则评估规则 4 (洗脱期)。这涉及到检查 `$R_i$` 与所有按时间顺序更早的记录 `$R_j$`（其中 `$j  i$`）。\n        4.  对于每个先前的记录 `$R_j$`：\n            *   如果 `$R_j$` 是他汀类药物配药（满足规则 1），则计算其覆盖区间 `$I_C$`。\n            *   检查 `$I_C$` 是否与 `$R_i$` 的洗脱区间 `$I_W$` 重叠。\n            *   如果发现重叠，`$R_i$` 违反洗脱期规则。对此候选的检查终止，算法继续处理 `$R_{i+1}$`。\n        5.  如果遍历所有先前记录 `$R_j$` 的循环完成而未发现任何他汀类药物暴露重叠，则 `candidate_fill` `$R_i$` 已成功通过所有四个规则。\n\n3.  **终止条件**：\n    *   如果发现任何候选 `$R_i$` 满足所有四个规则，则“存在至少一个有效的队列入口”的条件得到满足。针对该患者记录集的过程终止，返回结果 `$\\text{True}$`。\n    *   如果算法遍历了从 `$R_0$` 到 `$R_{N-1}$` 的所有记录，并且没有记录满足所有四个规则，则该患者不符合表型标准。过程终止，返回结果 `$\\text{False}$`。\n\n这种结构化的、基于规则的方法保证了对每个测试用例都能根据问题的形式化规范进行确定性和正确的评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for statin new-use phenotype.\n    \"\"\"\n\n    # Define constants from the problem statement.\n    W = 180  # Washout window length in days\n    D_MIN = 30  # Minimum supply duration in days\n    DOSE_THRESHOLDS = {\n        \"C10AA05\": 10,  # Atorvastatin\n        \"C10AA07\": 5,   # Rosuvastatin\n        \"C10AA01\": 20,  # Simvastatin\n        \"C10AA03\": 40   # Pravastatin\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path, new-use qualifies\n        [(1, 200, \"ATC\", \"C10AA05\", 20, 30, 30)],\n        # Case 2: washout violated by prior statin coverage for second fill, but first fill qualifies\n        [(2, 50, \"ATC\", \"C10AA01\", 20, 30, 30), (2, 200, \"ATC\", \"C10AA05\", 20, 30, 30)],\n        # Case 3: minimum supply not met\n        [(3, 100, \"ATC\", \"C10AA07\", 10, 14, 14)],\n        # Case 4: dose exactly at threshold qualifies\n        [(4, 500, \"ATC\", \"C10AA01\", 20, 30, 30)],\n        # Case 5: prior non-statin exposure ignored; statin qualifies\n        [(5, 10, \"ATC\", \"C10AB04\", 600, 60, 30), (5, 200, \"ATC\", \"C10AA03\", 40, 30, 30)],\n        # Case 6: earlier low-dose statin breaks washout for later candidate\n        [(6, 400, \"ATC\", \"C10AA05\", 10, 30, 60), (6, 500, \"ATC\", \"C10AA05\", 20, 30, 30)],\n        # Case 7: boundary: last coverage ends at t_index - W, fails washout\n        [(7, 200, \"ATC\", \"C10AA01\", 20, 21, 21), (7, 400, \"ATC\", \"C10AA07\", 10, 30, 30)],\n        # Case 8: boundary: last coverage ends at t_index - W - 1, passes washout\n        [(8, 200, \"ATC\", \"C10AA01\", 20, 20, 20), (8, 400, \"ATC\", \"C10AA07\", 10, 30, 30)],\n    ]\n\n    def has_valid_new_use(records):\n        \"\"\"\n        Determines if there exists at least one valid new-use index fill\n        for a single patient's record history.\n\n        Args:\n            records: A list of prescription fill tuples for one patient.\n                     Tuple format: (p, t, c_s, c, s, q, d)\n\n        Returns:\n            True if a valid index fill is found, False otherwise.\n        \"\"\"\n        # Sort records by dispense day `t` to ensure chronological order.\n        sorted_records = sorted(records, key=lambda r: r[1])\n\n        for i, candidate_fill in enumerate(sorted_records):\n            # Unpack the candidate fill record for clarity.\n            # p, t, c_s, c, s, q, d\n            _p_cand, t_index, _cs_cand, c_index, s_cand, q_cand, d_cand = candidate_fill\n\n            # Rule 1: Must be a statin (ATC starts with C10AA).\n            if not c_index.startswith(\"C10AA\"):\n                continue\n\n            # Must be a statin for which a dose threshold is defined to be an index candidate.\n            if c_index not in DOSE_THRESHOLDS:\n                continue\n\n            # Rule 2: Minimum supply duration must be met.\n            if d_cand  D_MIN:\n                continue\n\n            # Rule 3: Average daily dose must meet the threshold.\n            avg_daily_dose = (s_cand * q_cand) / d_cand\n            if avg_daily_dose  DOSE_THRESHOLDS[c_index]:\n                continue\n            \n            # If rules 1-3 are met, proceed to Rule 4 (washout).\n            washout_ok = True\n            washout_start = t_index - W\n            washout_end = t_index - 1\n            \n            for j in range(i):\n                prior_fill = sorted_records[j]\n                # p, t, c_s, c, s, q, d\n                _p_prior, t_prior, _cs_prior, c_prior, _s_prior, _q_prior, d_prior = prior_fill\n\n                # Washout is only affected by prior STATIN fills.\n                if not c_prior.startswith(\"C10AA\"):\n                    continue\n\n                coverage_start = t_prior\n                coverage_end = t_prior + d_prior - 1\n\n                # Check for overlap between prior fill's coverage and washout period.\n                # Two closed intervals [a, b] and [c, d] overlap if a = d and c = b.\n                if coverage_start = washout_end and washout_start = coverage_end:\n                    washout_ok = False\n                    break  # Washout violated, this candidate is invalid.\n            \n            if washout_ok:\n                # Found a valid index fill that satisfies all 4 rules.\n                return True\n        \n        # Iterated through all records, no valid index fill was found.\n        return False\n\n    results = []\n    for case in test_cases:\n        results.append(has_valid_new_use(case))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在观察性研究中，一旦定义了治疗组和对照组，下一个核心挑战便是处理混杂偏倚。这项实践 () 专注于一个关键的质量控制步骤：在使用倾向性评分等方法进行统计学校正后，评估协变量是否达到了平衡。你将计算标准化均数差（Standardized Mean Difference, SMD），并依据公认的阈值来判断组间是否具有可比性，从而为后续的效应估计建立一个有效的基础。",
            "id": "4587751",
            "problem": "一项药物流行病学研究使用真实世界数据（RWD）来模拟一个目标试验，该试验在一个大型综合医疗系统中比较开始使用抗高血压药物与不使用。在基于倾向性得分模型构建治疗概率倒数权重后，研究者评估了一个代表收缩压的连续基线协变量的协变量平衡性。治疗组的加权均值为 $m_{1}=130$，未治疗组的加权均值为 $m_{0}=125$，两组的合并加权标准差为 $s_{p}=20$。使用标准化均值差的核心定义，即组间均值之差相对于该协变量变异性尺度的表达，计算加权后该协变量的标准化均值差。然后，使用在观察性真实世界证据（RWE）分析中广泛接受的协变量平衡启发式法则，即如果一个协变量的标准化均值差绝对值小于 $0.10$，则认为该协变量是平衡的，来判断该协变量是否已达到平衡。\n\n将标准化均值差报告为一个无单位小数，并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题要求在药物流行病学研究中应用治疗概率倒数加权后，计算连续协变量（收缩压）的标准化均值差（SMD）。它还要求根据一个常见的启发式法则来评估是否已达到协变量平衡。\n\n标准化均值差是衡量两组均值之间差异的无标度度量。如问题所述，它被定义为组间均值之差除以合并标准差的度量。对于加权数据，这是加权均值之差除以合并加权标准差。\n\n设 $m_{1}$ 为治疗组中协变量的加权均值，$m_{0}$ 为未治疗组中的加权均值。设 $s_{p}$ 为合并加权标准差。标准化均值差的公式为：\n$$\n\\text{SMD} = \\frac{m_{1} - m_{0}}{s_{p}}\n$$\n问题提供了以下数值：\n-   治疗组的加权均值，$m_{1} = 130$。\n-   未治疗组的加权均值，$m_{0} = 125$。\n-   合并加权标准差，$s_{p} = 20$。\n\n将这些值代入公式，我们可以计算SMD：\n$$\n\\text{SMD} = \\frac{130 - 125}{20}\n$$\n$$\n\\text{SMD} = \\frac{5}{20}\n$$\n$$\n\\text{SMD} = \\frac{1}{4} = 0.25\n$$\n问题要求答案四舍五入到三位有效数字。精确值 $0.25$ 可以写成 $0.250$ 来满足此要求。\n\n任务的第二部分是判断是否已达到协变量平衡。提供的启发式法则是，如果一个协变量的标准化均值差绝对值小于 $0.10$，则认为该协变量是平衡的。\n我们必须计算SMD的绝对值：\n$$\n|\\text{SMD}| = |0.250| = 0.250\n$$\n现在，我们将此值与 $0.10$ 的先验阈值进行比较：\n$$\n0.250 \\ge 0.10\n$$\n由于标准化均值差的绝对值 $0.250$ 不小于阈值 $0.10$，我们得出结论，根据这个广泛使用的启发式法则，加权后收缩压的协变量平衡尚未达到。这个重要协变量中剩余的不平衡将严重影响研究结果的有效性，这表明倾向性得分模型可能设定有误，或者可能需要使用其他技术（例如，分层、进一步的模型调整）。\n\n最终要求的答案是标准化均值差的数值，四舍五入到三位有效数字。",
            "answer": "$$\n\\boxed{0.250}\n$$"
        },
        {
            "introduction": "即便我们完美地平衡了所有已测量的协变量，研究结果的有效性仍可能受到未测量混杂因素的威胁。这最后一项练习 () 引入了一个强大的敏感性分析工具——E值（E-value），用以量化研究结果对于潜在未测量混杂的稳健性。通过计算和解释E值，你将学会评估需要多强的未知混杂因素才能完全“解释掉”观测到的效应，这是批判性审视和解读真实世界证据时不可或缺的高阶技能。",
            "id": "4587714",
            "problem": "一个临床药理学研究团队使用来自整合电子健康记录和理赔数据库的真实世界数据 (RWD)，以评估一种新型口服抗凝药与一种已确立的对照药物相比的安全性。在一项队列研究中，他们估计了一个具有临床意义的出血结局的观察风险比，记为 $RR_{\\text{obs}}$，其值为 $RR_{\\text{obs}} = 1.6$。他们旨在通过量化一个未测量的二元混杂因素需要与暴露和结局同时具有的最小关联强度，以评估此真实世界证据 (RWE) 对未测量混杂的稳健性，从而将观察到的关联在风险比尺度上降至零效应。这个量被称为E值。\n\n从流行病学和药理学中风险比和混杂的核心定义出发，考虑一个单一的二元未测量混杂因素 $U$，它可能同时影响治疗分配 $A$ 和结局 $Y$。令 $RR_{\\text{true}}$ 表示在完全控制混杂情况下获得的 $A$ 对 $Y$ 的因果风险比，并假设不存在测量误差、选择偏倚，并且在两个治疗组中对于 $U$ 都满足正定性。将 $RR_{UY}$ 定义为衡量 $U$ 与 $Y$ 之间关联的风险比（在 $A$ 的各层内），并将 $RR_{UA}$ 定义为衡量 $U$ 与 $A$ 之间关联的风险比。\n\n仅使用 $RR_{\\text{obs}}$、$RR_{\\text{true}}$、$RR_{UY}$ 和 $RR_{UA}$ 的基本定义，以及观察风险是 $U$ 各分层上混合风险的原理，推导混杂偏倚因子 $B$ 的代数界限，使得 $RR_{\\text{obs}} = RR_{\\text{true}} \\times B$。然后，在约束条件 $RR_{UY} = RR_{UA} = x$ （暴露和结局间的最小相等强度）下，求解当 $RR_{\\text{obs}} = 1.6$ 时，足以使 $RR_{\\text{true}} = 1$ 的最小 $x$ 值。这个 $x$ 就是E值。计算 $RR_{\\text{obs}} = 1.6$ 时的E值。将最终数值结果四舍五入至四位有效数字，并表示为一个无单位的量。此外，用语言解释需要多大的最小未测量混杂强度才能完全解释观察到的关联。",
            "solution": "问题是推导并计算观察风险比 $RR_{\\text{obs}}$ 为 $1.6$ 时的E值。E值量化了一个未测量的混杂因素需要与暴露和结局同时具有的最小关联强度，才能完全解释观察到的关联，即将真实的因果风险比 $RR_{\\text{true}}$ 移至零效应值 $1$。\n\n首先，让我们建立观察风险比 ($RR_{\\text{obs}}$)、真实因果风险比 ($RR_{\\text{true}}$) 和由混杂引起的偏倚因子 ($B$) 之间的基本关系。在风险比尺度上，这种关系是乘法关系：\n$$RR_{\\text{obs}} = RR_{\\text{true}} \\times B$$\n为了将观察到的关联降至零效应，我们设定 $RR_{\\text{true}} = 1$。在这种情况下，偏倚因子必须等于观察风险比：\n$$B = RR_{\\text{obs}}$$\n\n下一步是将偏倚因子 $B$ 与未测量混杂因素 $U$ 同暴露 $A$ 和结局 $Y$ 的关联强度联系起来。令 $RR_{AU}$ 为混杂因素与暴露之间关联的风险比，定义为 $RR_{AU} = \\frac{P(A=1|U=1)}{P(A=1|U=0)}$。令 $RR_{UY}$ 为混杂因素与结局之间关联的风险比，定义为 $RR_{UY} = \\frac{P(Y=1|U=1, A=a)}{P(Y=1|U=0, A=a)}$，并假设在暴露 $a$ 的不同水平上是恒定的。请注意，问题中的 $RR_{UA}$ 在此背景下被解释为标准的 $RR_{AU}$ 项。\n\n对于一个未测量的混杂因素（其中 $RR_{AU} \\ge 1$ 且 $RR_{UY} \\ge 1$），它能产生的最大可能偏倚因子 $B$ 由以下界限给出：\n$$B \\le \\frac{RR_{AU} \\times RR_{UY}}{RR_{AU} + RR_{UY} - 1}$$\nE值的计算寻求最小的相等关联强度，因此我们施加约束条件 $RR_{AU} = RR_{UY} = x$。将此代入不等式，对于给定的强度 $x$，最大偏倚为：\n$$B_{\\text{max}}(x) = \\frac{x \\times x}{x + x - 1} = \\frac{x^2}{2x - 1}$$\n要完全解释观察到的风险比，这个最大可能偏倚必须至少与 $RR_{\\text{obs}}$ 一样大。我们关心的是能实现这一点的最小 $x$ 值。因此，我们将最大偏倚设定为等于观察风险比：\n$$RR_{\\text{obs}} = \\frac{x^2}{2x - 1}$$\n给定 $RR_{\\text{obs}} = 1.6$，我们有：\n$$1.6 = \\frac{x^2}{2x - 1}$$\n我们必须解这个关于 $x$ 的方程。整理各项，我们得到一个二次方程：\n$$1.6(2x - 1) = x^2$$\n$$3.2x - 1.6 = x^2$$\n$$x^2 - 3.2x + 1.6 = 0$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $x$ 的方程，其中 $a=1$，$b=-3.2$，$c=1.6$。\n$$x = \\frac{-(-3.2) \\pm \\sqrt{(-3.2)^2 - 4(1)(1.6)}}{2(1)}$$\n$$x = \\frac{3.2 \\pm \\sqrt{10.24 - 6.4}}{2}$$\n$$x = \\frac{3.2 \\pm \\sqrt{3.84}}{2}$$\n$x$ 的两个可能解是：\n$$x = \\frac{3.2 + \\sqrt{3.84}}{2} \\quad \\text{和} \\quad x = \\frac{3.2 - \\sqrt{3.84}}{2}$$\nE值是为大于 $1$ 的风险比定义的，这意味着我们寻找的混杂强度 $x \\ge 1$。表达式 $\\sqrt{3.84}$ 小于 $\\sqrt{4} = 2$，也小于 $3.2$。第二个根 $\\frac{3.2 - \\sqrt{3.84}}{2}$ 将小于 $\\frac{3.2 - 0}{2} = 1.6$ 且大于 $\\frac{3.2-2}{2} = 0.6$。第一个根明显大于 $1$。E值对应于较大的根，它代表了产生观察到的关联所需的混杂强度。\n对于观察风险比 $RR_{\\text{obs}} > 1$，E值的通用公式是 $x = RR_{\\text{obs}} + \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)}$。让我们验证这等同于我们二次方程的较大根：\n从 $x^2 - (2RR_{\\text{obs}})x + RR_{\\text{obs}} = 0$ 出发，根为 $x = \\frac{2RR_{\\text{obs}} \\pm \\sqrt{4RR_{\\text{obs}}^2 - 4RR_{\\text{obs}}}}{2} = RR_{\\text{obs}} \\pm \\sqrt{RR_{\\text{obs}}^2 - RR_{\\text{obs}}} = RR_{\\text{obs}} \\pm \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}}-1)}$。E值是较大的那个根。\n因此，对于 $RR_{\\text{obs}} = 1.6$：\n$$x = 1.6 + \\sqrt{1.6(1.6 - 1)}$$\n$$x = 1.6 + \\sqrt{1.6(0.6)}$$\n$$x = 1.6 + \\sqrt{0.96}$$\n现在，我们计算数值：\n$$\\sqrt{0.96} \\approx 0.9797959...$$\n$$x \\approx 1.6 + 0.9797959... = 2.5797959...$$\n问题要求四舍五入到四位有效数字。\n$$x \\approx 2.580$$\n这个值，即E值，是 $2.580$。\n\n其解释如下：要让一个未测量的混杂因素完全解释观察到的 $1.6$ 的风险比，在控制了已测量协变量的条件下，它需要与暴露（新型抗凝药）和结局（出血）均存在至少为 $2.580$ 的风险比关联。如果不存在具有如此强度关联的混杂因素，那么观察到的关联不太可能完全由混杂造成。反之，如果认为存在一个与暴露和结局的关联风险比均达到或超过 $2.580$ 的混杂因素是合理的，那么对观察结果的因果解释就值得怀疑。",
            "answer": "$$\\boxed{2.580}$$"
        }
    ]
}