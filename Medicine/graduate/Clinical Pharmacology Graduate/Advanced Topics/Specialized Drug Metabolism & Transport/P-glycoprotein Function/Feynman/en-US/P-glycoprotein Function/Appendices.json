{
    "hands_on_practices": [
        {
            "introduction": "A fundamental tenet in pharmacology is the \"free drug hypothesis,\" which posits that only the unbound drug is pharmacologically active and available to interact with targets like enzymes or transporters. This practice will guide you through a crucial two-step calculation: first, determining the intracellular free drug concentration from total levels by applying the principles of saturable protein binding, and second, using this free concentration to accurately predict the rate of P-glycoprotein efflux. Mastering this concept is essential for correctly interpreting in vitro data and building robust pharmacokinetic models.",
            "id": "4570748",
            "problem": "A polarized human intestinal epithelial monolayer expresses P-glycoprotein (P-gp) at the apical membrane. Only the pharmacologically free (unbound) drug within the cytosol is a substrate for P-gp-mediated efflux. The drug binds reversibly and rapidly to an abundant cytosolic protein with a single binding site per protein and follows the law of mass action. The total intracellular drug concentration, $C_T$, equals the sum of free drug concentration, $C_u$, and bound drug concentration, $C_b$. The reversible binding is characterized by a dissociation constant, $K_d$, and a total cytosolic binding site concentration, $P_T$, and follows a one-site saturable binding isotherm. For the free drug, P-gp efflux obeys Michaelis-Menten kinetics with maximal rate $V_{\\max}$ and Michaelis constant $K_m$, so that the instantaneous efflux rate is $v = V_{\\max} \\frac{C_u}{K_m + C_u}$.\n\nAt a time point when the measured total intracellular drug concentration is $C_T = 5.275 \\, \\mathrm{\\mu M}$, the cytosolic protein binding parameters are $P_T = 100.275 \\, \\mathrm{\\mu M}$ and $K_d = 10.0 \\, \\mathrm{\\mu M}$, and the P-gp kinetic parameters for the free drug are $V_{\\max} = 1.8 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$ and $K_m = 2.0 \\, \\mathrm{\\mu M}$.\n\nUsing first principles (mass action for binding and Michaelis-Menten for transport), derive the intracellular free drug concentration $C_u$ from $C_T$, $P_T$, and $K_d$, and then compute the instantaneous P-gp efflux rate $v$. Round your final answer to four significant figures and express it in $\\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$.",
            "solution": "The user wants me to solve a problem based on the provided text.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n-   System: A polarized human intestinal epithelial monolayer expressing P-glycoprotein (P-gp) at the apical membrane.\n-   Drug binding: The free drug in the cytosol is the substrate for P-gp. The drug binds reversibly and rapidly to a cytosolic protein with a single binding site.\n-   Relationship 1: Total intracellular drug concentration, $C_T$, equals the sum of free drug concentration, $C_u$, and bound drug concentration, $C_b$. So, $C_T = C_u + C_b$.\n-   Binding parameters: The reversible binding is characterized by a dissociation constant, $K_d$, and a total cytosolic binding site concentration, $P_T$.\n-   Binding model: One-site saturable binding isotherm, following the law of mass action.\n-   Transport kinetics: P-gp efflux obeys Michaelis-Menten kinetics with maximal rate $V_{\\max}$ and Michaelis constant $K_m$.\n-   Transport rate equation: $v = V_{\\max} \\frac{C_u}{K_m + C_u}$.\n-   Numerical values:\n    -   $C_T = 5.275 \\, \\mathrm{\\mu M}$\n    -   $P_T = 100.275 \\, \\mathrm{\\mu M}$\n    -   $K_d = 10.0 \\, \\mathrm{\\mu M}$\n    -   $V_{\\max} = 1.8 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$\n    -   $K_m = 2.0 \\, \\mathrm{\\mu M}$\n-   Task: Derive $C_u$ from $C_T$, $P_T$, and $K_d$, then compute the instantaneous P-gp efflux rate $v$.\n-   Rounding: Round the final answer to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is based on fundamental principles of pharmacology and biochemistry: the law of mass action for ligand-protein binding and Michaelis-Menten kinetics for enzyme/transporter-mediated processes. These are well-established and scientifically sound models.\n-   **Well-Posed**: The problem provides all necessary data and equations to determine a unique, stable, and meaningful solution. It is a standard quantitative problem in pharmacokinetics.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n\nThe problem does not exhibit any flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, or ill-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n### **Solution Derivation and Calculation**\n\nThe solution proceeds in two stages: first, determining the intracellular free drug concentration ($C_u$), and second, using this value to calculate the P-gp efflux rate ($v$).\n\n**Stage 1: Calculation of Intracellular Free Drug Concentration ($C_u$)**\n\nThe problem states that the total intracellular drug concentration, $C_T$, is the sum of the free drug concentration, $C_u$, and the drug concentration bound to cytosolic proteins, $C_b$:\n$$C_T = C_u + C_b$$\n\nThe binding of the drug to a single site on the protein follows the law of mass action. The dissociation constant, $K_d$, is defined as:\n$$K_d = \\frac{[D][P]}{[DP]}$$\nwhere $[D]$ is the concentration of free drug ($C_u$), $[P]$ is the concentration of unbound protein binding sites ($P_u$), and $[DP]$ is the concentration of the drug-protein complex ($C_b$).\nThus, we can write:\n$$K_d = \\frac{C_u P_u}{C_b}$$\n\nThe total concentration of protein binding sites, $P_T$, is the sum of the unbound sites, $P_u$, and the bound sites, $C_b$:\n$$P_T = P_u + C_b$$\nFrom this, we can express the concentration of unbound sites as $P_u = P_T - C_b$.\n\nSubstituting this expression for $P_u$ into the equation for $K_d$:\n$$K_d = \\frac{C_u (P_T - C_b)}{C_b}$$\n\nWe can rearrange this equation to solve for $C_b$ in terms of $C_u$, $P_T$, and $K_d$:\n$$K_d C_b = C_u P_T - C_u C_b$$\n$$K_d C_b + C_u C_b = C_u P_T$$\n$$C_b (K_d + C_u) = C_u P_T$$\n$$C_b = \\frac{P_T C_u}{K_d + C_u}$$\nThis is the one-site saturable binding isotherm equation.\n\nNow, we substitute this expression for $C_b$ into the equation for the total drug concentration, $C_T$:\n$$C_T = C_u + \\frac{P_T C_u}{K_d + C_u}$$\n\nTo solve for $C_u$, we rearrange this equation into a standard quadratic form, $a x^2 + b x + c = 0$.\nMultiply all terms by $(K_d + C_u)$:\n$$C_T (K_d + C_u) = C_u (K_d + C_u) + P_T C_u$$\n$$C_T K_d + C_T C_u = K_d C_u + C_u^2 + P_T C_u$$\nRearranging the terms to one side gives the quadratic equation for $C_u$:\n$$C_u^2 + (K_d + P_T - C_T)C_u - C_T K_d = 0$$\n\nUsing the quadratic formula, $C_u = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b = (K_d + P_T - C_T)$, and $c = -C_T K_d$:\n$$C_u = \\frac{-(K_d + P_T - C_T) \\pm \\sqrt{(K_d + P_T - C_T)^2 - 4(1)(-C_T K_d)}}{2}$$\n$$C_u = \\frac{-(K_d + P_T - C_T) \\pm \\sqrt{(K_d + P_T - C_T)^2 + 4C_T K_d}}{2}$$\nSince concentration must be a non-negative value, we take the positive root. The term under the square root is strictly greater than $(K_d + P_T - C_T)^2$, so its square root is greater than $|K_d + P_T - C_T|$. Therefore, the positive sign must be chosen to ensure $C_u > 0$.\n$$C_u = \\frac{-(K_d + P_T - C_T) + \\sqrt{(K_d + P_T - C_T)^2 + 4C_T K_d}}{2}$$\n\nNow, we substitute the given numerical values: $C_T = 5.275 \\, \\mu M$, $P_T = 100.275 \\, \\mu M$, and $K_d = 10.0 \\, \\mu M$.\nFirst, calculate the coefficient of the linear term, $b$:\n$$b = K_d + P_T - C_T = 10.0 + 100.275 - 5.275 = 105.0 \\, \\mu M$$\nNext, calculate the term $4C_T K_d$:\n$$4C_T K_d = 4 \\times 5.275 \\times 10.0 = 211.0 \\, (\\mu M)^2$$\nNow, substitute these into the solution for $C_u$:\n$$C_u = \\frac{-105.0 + \\sqrt{(105.0)^2 + 211.0}}{2}$$\n$$C_u = \\frac{-105.0 + \\sqrt{11025 + 211.0}}{2}$$\n$$C_u = \\frac{-105.0 + \\sqrt{11236}}{2}$$\n$$C_u = \\frac{-105.0 + 106.0}{2}$$\n$$C_u = \\frac{1.0}{2} = 0.50 \\, \\mu M$$\n\n**Stage 2: Calculation of the P-gp Efflux Rate ($v$)**\n\nThe instantaneous P-gp efflux rate, $v$, is given by the Michaelis-Menten equation:\n$$v = V_{\\max} \\frac{C_u}{K_m + C_u}$$\n\nWe use the calculated value $C_u = 0.50 \\, \\mu M$ and the given parameters $V_{\\max} = 1.8 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$ and $K_m = 2.0 \\, \\mu M$.\n$$v = (1.8 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}) \\times \\frac{0.50 \\, \\mu M}{2.0 \\, \\mu M + 0.50 \\, \\mu M}$$\n$$v = 1.8 \\times \\frac{0.50}{2.50} \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$$\n$$v = 1.8 \\times 0.2 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$$\n$$v = 0.36 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$v = 0.3600 \\, \\mathrm{pmol \\, min^{-1} \\, mg^{-1}}$$",
            "answer": "$$\n\\boxed{0.3600}\n$$"
        },
        {
            "introduction": "P-glycoprotein at the blood-brain barrier (BBB) acts as a vigilant gatekeeper, actively pumping many drugs out of the central nervous system and limiting their efficacy. This exercise challenges you to quantify the impact of a P-gp inhibitor on this process. By setting up and solving a steady-state flux-balance equation that combines passive diffusion and inhibited active efflux, you will calculate the new, higher unbound drug concentration in the brain, a core skill for predicting the magnitude of transporter-mediated drug-drug interactions at the BBB.",
            "id": "4570759",
            "problem": "A small-molecule central nervous system substrate of adenosine triphosphate-binding cassette subfamily B member 1 (ABCB1), also known as P-glycoprotein (P-gp), is administered by constant-rate intravenous infusion to achieve a constant unbound plasma concentration across the blood-brain barrier (BBB). Assume the following:\n\n- The unbound plasma concentration is held at $C_{p,u} = 0.50$ µM.\n- The unbound interstitial (brain) concentration is $C_{b,u}$ (unknown).\n- Passive trans-BBB movement of the unbound drug is bidirectional and follows Fick’s law with a permeability-surface area product $PS = 0.20$ mL min$^{-1}$ g$^{-1}$.\n- ABCB1 (P-gp) mediates active efflux from brain to plasma with saturable kinetics characterized by maximum rate $V_{\\max} = 0.040$ nmol min$^{-1}$ g$^{-1}$ and Michaelis constant $K_{m} = 0.25$ µM under control conditions.\n- A pharmacologic inhibitor of ABCB1 is co-administered at a constant unbound concentration $I = 1.00$ µM and acts as a competitive inhibitor with inhibition constant $K_{i} = 0.50$ µM.\n- Ignore all other transporters, metabolism, or bulk clearance within the brain parenchyma, and assume that the passive permeability is symmetric and that unbound fractions are correctly accounted for in $C_{p,u}$ and $C_{b,u}$.\n\nStarting from first principles—Fick’s law for passive flux and Michaelis–Menten kinetics for transporter-mediated efflux—together with the definition of competitive inhibition, write the steady-state flux-balance condition for the BBB and solve for the unbound brain concentration $C_{b,u}$ in the presence of the inhibitor. Express your final answer in µM and round to four significant figures.",
            "solution": "The problem is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- Unbound plasma concentration: $C_{p,u} = 0.50$ µM\n- Unbound interstitial (brain) concentration: $C_{b,u}$ (unknown)\n- Permeability-surface area product: $PS = 0.20$ mL min$^{-1}$ g$^{-1}$\n- Maximum rate of active efflux: $V_{\\max} = 0.040$ nmol min$^{-1}$ g$^{-1}$\n- Michaelis constant for active efflux: $K_{m} = 0.25$ µM\n- Unbound concentration of competitive inhibitor: $I = 1.00$ µM\n- Inhibition constant of the competitive inhibitor: $K_{i} = 0.50$ µM\n- The system is at steady state.\n- Passive transport follows Fick's law.\n- Active transport is mediated by ABCB1 (P-gp) and follows Michaelis-Menten kinetics.\n- The co-administered drug is a competitive inhibitor of ABCB1.\n- All other transport and clearance mechanisms are ignored.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The problem is based on fundamental principles of pharmacokinetics, namely Fick's law for passive diffusion and Michaelis-Menten kinetics for transporter-mediated flux, including the standard model of competitive inhibition. These are cornerstone concepts in clinical pharmacology and drug disposition modeling. The context of P-glycoprotein (ABCB1) at the blood-brain barrier is a classic and well-studied example.\n- **Well-Posedness**: The problem provides a complete set of parameters necessary to define the system's state. By assuming steady-state, the problem reduces to solving an algebraic equation for a single unknown variable, $C_{b,u}$. The setup ensures that a unique and physically meaningful solution exists.\n- **Objectivity**: The problem is stated using precise, quantitative language and established scientific terminology. It is free from ambiguity, subjectivity, or any non-scientific claims. The data provided are dimensionally consistent. The units for flux from passive diffusion ($PS \\times C$) are `(mL min⁻¹ g⁻¹) × (nmol mL⁻¹) = nmol min⁻¹ g⁻¹`, which match the units of $V_{\\max}$. This confirms dimensional homogeneity.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, self-contained, and quantitatively rigorous. A complete solution will now be derived.\n\nThe core principle for solving this problem is the steady-state flux-balance condition at the blood-brain barrier (BBB). At steady state, the total flux of the drug into the brain must equal the total flux out of the brain. The net flux is zero.\n\nThe fluxes involved are:\n1.  Passive diffusion, which occurs in both directions across the BBB.\n2.  Active efflux, which is a unidirectional transport from the brain to the plasma, mediated by P-glycoprotein (ABCB1).\n\nFirst, we define the passive flux component. According to Fick's law, the rate of diffusion is proportional to the permeability-surface area product ($PS$) and the concentration gradient. The net passive flux into the brain, $J_{pass, net}$, is the difference between passive influx and passive efflux:\n$$J_{pass, net} = (PS \\cdot C_{p,u}) - (PS \\cdot C_{b,u}) = PS (C_{p,u} - C_{b,u})$$\nHere, $C_{p,u}$ is the unbound drug concentration in plasma and $C_{b,u}$ is the unbound drug concentration in the brain's interstitial fluid. For unit consistency, concentrations given in µM are treated as nmol mL$^{-1}$, since $1$ µM $= 1$ µmol L$^{-1} = 1$ nmol mL$^{-1}$. Thus, the flux $J_{pass, net}$ has units of (mL min$^{-1}$ g$^{-1}$) $\\times$ (nmol mL$^{-1}$) = nmol min$^{-1}$ g$^{-1}$.\n\nNext, we define the active efflux component, $J_{active, out}$. This process is mediated by P-gp and follows Michaelis-Menten kinetics. The substrate for this efflux pump is the unbound drug within the brain, $C_{b,u}$. In the presence of a competitive inhibitor at concentration $I$, the standard Michaelis-Menten equation is modified. The apparent Michaelis constant, $K_{m,app}$, is given by:\n$$K_{m,app} = K_m \\left(1 + \\frac{I}{K_i}\\right)$$\nThe rate of active efflux from brain to plasma is then:\n$$J_{active, out} = \\frac{V_{\\max} \\cdot C_{b,u}}{K_{m,app} + C_{b,u}}$$\nwhere $V_{\\max}$ is the maximum rate of transport.\n\nAt steady state, the net flux across the BBB is zero. This means the net passive influx must be equal to the active efflux:\n$$J_{pass, net} = J_{active, out}$$\n$$PS (C_{p,u} - C_{b,u}) = \\frac{V_{\\max} \\cdot C_{b,u}}{K_{m,app} + C_{b,u}}$$\n\nTo solve for $C_{b,u}$, we rearrange this equation.\n$$PS (C_{p,u} - C_{b,u}) (K_{m,app} + C_{b,u}) = V_{\\max} \\cdot C_{b,u}$$\nExpanding the left side:\n$$PS (C_{p,u}K_{m,app} + C_{p,u}C_{b,u} - C_{b,u}K_{m,app} - C_{b,u}^2) = V_{\\max} \\cdot C_{b,u}$$\nDistributing $PS$:\n$$PS \\cdot C_{p,u}K_{m,app} + PS \\cdot C_{p,u}C_{b,u} - PS \\cdot K_{m,app}C_{b,u} - PS \\cdot C_{b,u}^2 = V_{\\max} \\cdot C_{b,u}$$\nRearranging into the standard quadratic form $a x^2 + b x + c = 0$, where $x = C_{b,u}$:\n$$(PS)C_{b,u}^2 + (V_{\\max} + PS \\cdot K_{m,app} - PS \\cdot C_{p,u})C_{b,u} - PS \\cdot C_{p,u}K_{m,app} = 0$$\nThe coefficients are:\n$a = PS$\n$b = V_{\\max} + PS(K_{m,app} - C_{p,u})$\n$c = -PS \\cdot C_{p,u}K_{m,app}$\n\nNow, we substitute the given numerical values. First, we calculate $K_{m,app}$:\n$$K_{m,app} = K_m \\left(1 + \\frac{I}{K_i}\\right) = 0.25 \\, \\text{µM} \\left(1 + \\frac{1.00 \\, \\text{µM}}{0.50 \\, \\text{µM}}\\right) = 0.25 (1 + 2) = 0.75 \\, \\text{µM}$$\n\nNext, we calculate the coefficients of the quadratic equation. The units are consistent, so we can use the numerical values directly.\n$a = PS = 0.20$\n$b = V_{\\max} + PS(K_{m,app} - C_{p,u}) = 0.040 + 0.20(0.75 - 0.50) = 0.040 + 0.20(0.25) = 0.040 + 0.050 = 0.090$\n$c = -PS \\cdot C_{p,u} \\cdot K_{m,app} = -0.20 \\cdot 0.50 \\cdot 0.75 = -0.10 \\cdot 0.75 = -0.075$\n\nThe quadratic equation for $C_{b,u}$ is:\n$$0.20 C_{b,u}^2 + 0.090 C_{b,u} - 0.075 = 0$$\n\nWe solve for $C_{b,u}$ using the quadratic formula:\n$$C_{b,u} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n$$C_{b,u} = \\frac{-0.090 \\pm \\sqrt{(0.090)^2 - 4(0.20)(-0.075)}}{2(0.20)}$$\n$$C_{b,u} = \\frac{-0.090 \\pm \\sqrt{0.0081 + 0.06}}{0.40}$$\n$$C_{b,u} = \\frac{-0.090 \\pm \\sqrt{0.0681}}{0.40}$$\nCalculating the value of the square root:\n$$\\sqrt{0.0681} \\approx 0.260959767$$\nThe two possible solutions for $C_{b,u}$ are:\n$$C_{b,u,1} = \\frac{-0.090 + 0.260959767}{0.40} = \\frac{0.170959767}{0.40} \\approx 0.4273994175$$\n$$C_{b,u,2} = \\frac{-0.090 - 0.260959767}{0.40} = \\frac{-0.350959767}{0.40} \\approx -0.8773994175$$\n\nSince concentration must be a non-negative physical quantity, we select the positive root.\n$$C_{b,u} \\approx 0.4273994175 \\, \\text{µM}$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$C_{b,u} = 0.4274 \\, \\text{µM}$$",
            "answer": "$$\\boxed{0.4274}$$"
        },
        {
            "introduction": "While steady-state models are powerful, real physiological processes are dynamic. This capstone practice moves from static algebraic equations to a dynamic simulation of intestinal drug absorption, a key component of oral bioavailability. You will construct a multi-compartment model incorporating passive permeation, saturable P-gp efflux, and metabolism, and then solve the system of ordinary differential equations (ODEs) to predict the fraction of a drug dose that reaches the portal circulation. This exercise provides a hands-on introduction to the principles of physiologically based pharmacokinetic (PBPK) modeling, a cornerstone of modern drug development.",
            "id": "4570792",
            "problem": "Consider a single intestinal segment modeled as three well-stirred compartments: lumen, enterocyte, and portal blood. A small molecule drug undergoes passive transcellular permeation across the apical and basolateral membranes, saturable apical efflux by P-glycoprotein (P-gp), and intracellular first-order metabolism. The objective is to compute the fraction of the administered oral dose that reaches the portal vein over a fixed observation window by integrating mass-balance ordinary differential equations derived from fundamental transport and reaction laws. Your program must implement the model, run the specified test suite, and output the fraction for each case as decimals (no percent sign), rounded to six decimal places, in a single line as a comma-separated list enclosed in square brackets.\n\nFundamental base to be used:\n- Mass conservation for each compartment.\n- Fick's law for passive transmembrane flux: the flux from compartment $1$ with concentration $C_1$ to compartment $2$ with concentration $C_2$ across a membrane of area $A$ with permeability $P$ is $J = P \\, A \\, (C_1 - C_2)$.\n- Michaelis–Menten kinetics for saturable transport: $v = \\dfrac{V_{\\max} \\, S}{K_m + S}$, where $S$ is the substrate concentration.\n- First-order transit and metabolism: rates proportional to the substrate mass or concentration with rate constants and clearances.\n\nModel definitions:\n- Let $M_L(t)$, $M_E(t)$, and $M_P(t)$ denote the drug mass in lumen, enterocyte, and portal blood, respectively, in $\\mathrm{mg}$.\n- Let $V_L$, $V_E$, and $V_P$ be the compartment volumes in $\\mathrm{mL}$.\n- Let $C_L(t) = \\dfrac{M_L(t)}{V_L}$, $C_E(t) = \\dfrac{M_E(t)}{V_E}$, and $C_P(t) = \\dfrac{M_P(t)}{V_P}$ be the concentrations in $\\mathrm{mg}/\\mathrm{mL}$.\n- Apical passive flux from lumen to enterocyte: $J_{\\mathrm{ap}}(t) = P_{\\mathrm{ap}} \\, A_{\\mathrm{ap}} \\, (C_L(t) - C_E(t))$ in $\\mathrm{mg}/\\mathrm{s}$.\n- Basolateral passive flux from enterocyte to portal blood: $J_{\\mathrm{bas}}(t) = P_{\\mathrm{bas}} \\, A_{\\mathrm{bas}} \\, (C_E(t) - C_P(t))$ in $\\mathrm{mg}/\\mathrm{s}$.\n- P-glycoprotein apical efflux from enterocyte to lumen (saturable): $v_{\\mathrm{pgp}}(t) = \\dfrac{V_{\\max,\\mathrm{pgp}} \\, C_E(t)}{K_{m,\\mathrm{pgp}} + C_E(t)}$ in $\\mathrm{mg}/\\mathrm{s}$, where $V_{\\max,\\mathrm{pgp}}$ is expressed for the specified effective enterocyte volume and $K_{m,\\mathrm{pgp}}$ is in $\\mathrm{mg}/\\mathrm{mL}$.\n- Enterocyte metabolism: $v_{\\mathrm{met}}(t) = CL_{\\mathrm{int}} \\, C_E(t)$ in $\\mathrm{mg}/\\mathrm{s}$.\n- Lumen transit loss: $k_{\\mathrm{trans}} \\, M_L(t)$ in $\\mathrm{mg}/\\mathrm{s}$.\n- Initial conditions at $t=0$: $M_L(0) = D_0$, $M_E(0) = 0$, $M_P(0) = 0$, where $D_0$ is the oral dose in $\\mathrm{mg}$.\n- Observation window: integrate from $t = 0$ to $t = T_{\\mathrm{obs}}$ in $\\mathrm{s}$.\n\nMass-balance ordinary differential equations to implement:\n$$\\frac{dM_L}{dt} = - J_{\\mathrm{ap}}(t) + v_{\\mathrm{pgp}}(t) - k_{\\mathrm{trans}} \\, M_L(t),$$\n$$\\frac{dM_E}{dt} = + J_{\\mathrm{ap}}(t) - J_{\\mathrm{bas}}(t) - v_{\\mathrm{pgp}}(t) - v_{\\mathrm{met}}(t),$$\n$$\\frac{dM_P}{dt} = + J_{\\mathrm{bas}}(t).$$\n\nThe quantity of interest is the fraction escaping intestinal first-pass into portal blood over the observation window, defined as:\n$$F_{\\mathrm{portal}} = \\frac{M_P(T_{\\mathrm{obs}})}{D_0},$$\nwhich is unitless. Report $F_{\\mathrm{portal}}$ as a decimal rounded to six decimal places.\n\nYour program should implement numerical integration of the above system and produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.123456,0.654321]$).\n\nUse the following test suite that spans different regimes of permeability, efflux saturation, and metabolism. All parameters not explicitly mentioned for a given case should take their default values listed under \"Shared defaults.\"\n\nShared defaults (apply unless overridden in a case):\n- $V_L = 250$ $\\mathrm{mL}$,\n- $V_E = 1$ $\\mathrm{mL}$,\n- $V_P = 1000$ $\\mathrm{mL}$,\n- $A_{\\mathrm{ap}} = 1500$ $\\mathrm{cm}^2$,\n- $A_{\\mathrm{bas}} = 1500$ $\\mathrm{cm}^2$,\n- $P_{\\mathrm{ap}} = 2 \\times 10^{-5}$ $\\mathrm{cm}/\\mathrm{s}$,\n- $P_{\\mathrm{bas}} = 2 \\times 10^{-5}$ $\\mathrm{cm}/\\mathrm{s}$,\n- $V_{\\max,\\mathrm{pgp}} = 0.02$ $\\mathrm{mg}/\\mathrm{s}$,\n- $K_{m,\\mathrm{pgp}} = 0.1$ $\\mathrm{mg}/\\mathrm{mL}$,\n- $CL_{\\mathrm{int}} = 0.05$ $\\mathrm{mL}/\\mathrm{s}$,\n- $k_{\\mathrm{trans}} = 2 \\times 10^{-4}$ $\\mathrm{s}^{-1}$,\n- $T_{\\mathrm{obs}} = 7200$ $\\mathrm{s}$.\n\nTest cases:\n- Case $1$ (baseline): $D_0 = 100$ $\\mathrm{mg}$.\n- Case $2$ (high efflux): $D_0 = 100$ $\\mathrm{mg}$, $V_{\\max,\\mathrm{pgp}} = 0.1$ $\\mathrm{mg}/\\mathrm{s}$.\n- Case $3$ (high dose, saturating efflux): $D_0 = 500$ $\\mathrm{mg}$, $V_{\\max,\\mathrm{pgp}} = 0.1$ $\\mathrm{mg}/\\mathrm{s}$.\n- Case $4$ (no efflux): $D_0 = 100$ $\\mathrm{mg}$, $V_{\\max,\\mathrm{pgp}} = 0$ $\\mathrm{mg}/\\mathrm{s}$.\n- Case $5$ (low permeability): $D_0 = 100$ $\\mathrm{mg}$, $P_{\\mathrm{ap}} = 5 \\times 10^{-6}$ $\\mathrm{cm}/\\mathrm{s}$, $P_{\\mathrm{bas}} = 5 \\times 10^{-6}$ $\\mathrm{cm}/\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry must be $F_{\\mathrm{portal}}$ for the corresponding case, rounded to six decimal places, expressed as a decimal (unitless).",
            "solution": "The problem presents a valid, well-posed initial value problem grounded in the principles of clinical pharmacology and pharmacokinetics. All necessary parameters, initial conditions, and governing equations are provided, and no scientific, logical, or formal inconsistencies are found. The units are consistent throughout the model definition. We can, therefore, proceed with the derivation and implementation of the solution.\n\nThe problem requires the calculation of the fraction of an orally administered drug dose that reaches the portal circulation, accounting for intestinal absorption, efflux, and metabolism. This is achieved by modeling the intestine as a series of three well-stirred compartments: the gut lumen (L), the enterocytes (E), and the portal blood (P). The dynamics of the drug mass in each compartment are described by a system of ordinary differential equations (ODEs) based on the principle of mass conservation.\n\nLet $M_L(t)$, $M_E(t)$, and $M_P(t)$ be the mass of the drug in milligrams ($\\mathrm{mg}$) in the lumen, enterocyte, and portal blood compartments at time $t$ in seconds ($\\mathrm{s}$), respectively. The corresponding volumes are $V_L$, $V_E$, and $V_P$ in milliliters ($\\mathrm{mL}$), leading to concentrations $C(t) = M(t)/V$ in $\\mathrm{mg}/\\mathrm{mL}$.\n\nThe rate of change of mass in each compartment, $\\frac{dM}{dt}$, is the sum of all influx and efflux rates. These rates are defined as follows:\n1.  **Lumen to Enterocyte Passive Permeation**: The flux from lumen to enterocyte, $J_{\\mathrm{ap}}(t)$, is governed by Fick's first law of diffusion. It is proportional to the concentration gradient across the apical membrane and the membrane's permeability-surface area product ($PS_{\\mathrm{ap}} = P_{\\mathrm{ap}}A_{\\mathrm{ap}}$).\n    $$J_{\\mathrm{ap}}(t) = P_{\\mathrm{ap}} A_{\\mathrm{ap}} (C_L(t) - C_E(t))$$\n    The units are $(\\mathrm{cm}/\\mathrm{s}) \\cdot (\\mathrm{cm}^2) \\cdot (\\mathrm{mg}/\\mathrm{mL}) = (\\mathrm{cm}^3/\\mathrm{s}) \\cdot (\\mathrm{mg}/\\mathrm{mL})$. Since $1 \\ \\mathrm{cm}^3 = 1 \\ \\mathrm{mL}$, this simplifies to $\\mathrm{mg}/\\mathrm{s}$.\n\n2.  **Enterocyte to Portal Blood Passive Permeation**: Similarly, the flux from the enterocyte to portal blood, $J_{\\mathrm{bas}}(t)$, across the basolateral membrane is driven by the corresponding concentration gradient.\n    $$J_{\\mathrm{bas}}(t) = P_{\\mathrm{bas}} A_{\\mathrm{bas}} (C_E(t) - C_P(t))$$\n\n3.  **P-glycoprotein (P-gp) Efflux**: This is a saturable active transport process that pumps the drug from the enterocyte back into the lumen. Its rate, $v_{\\mathrm{pgp}}(t)$, is described by Michaelis-Menten kinetics.\n    $$v_{\\mathrm{pgp}}(t) = \\frac{V_{\\max,\\mathrm{pgp}} C_E(t)}{K_{m,\\mathrm{pgp}} + C_E(t)}$$\n    Here, $V_{\\max,\\mathrm{pgp}}$ is the maximum efflux rate in $\\mathrm{mg}/\\mathrm{s}$, and $K_{m,\\mathrm{pgp}}$ is the Michaelis constant in $\\mathrm{mg}/\\mathrm{mL}$.\n\n4.  **Enterocyte Metabolism**: The drug is metabolized within the enterocyte via a first-order process, where the rate, $v_{\\mathrm{met}}(t)$, is proportional to the enterocyte concentration, with an intrinsic clearance $CL_{\\mathrm{int}}$ in $\\mathrm{mL}/\\mathrm{s}$.\n    $$v_{\\mathrm{met}}(t) = CL_{\\mathrm{int}} C_E(t)$$\n\n5.  **Lumen Transit**: The drug that is not absorbed is eventually cleared from the lumen. This is modeled as a first-order process with a rate constant $k_{\\mathrm{trans}}$ in $\\mathrm{s}^{-1}$, proportional to the mass of drug in the lumen.\n    $$\\text{Rate}_{\\mathrm{trans}}(t) = k_{\\mathrm{trans}} M_L(t)$$\n\nCombining these terms, we construct the mass-balance ODE system:\n$$ \\frac{dM_L}{dt} = -J_{\\mathrm{ap}}(t) + v_{\\mathrm{pgp}}(t) - k_{\\mathrm{trans}} M_L(t) $$\n$$ \\frac{dM_E}{dt} = +J_{\\mathrm{ap}}(t) - J_{\\mathrm{bas}}(t) - v_{\\mathrm{pgp}}(t) - v_{\\mathrm{met}}(t) $$\n$$ \\frac{dM_P}{dt} = +J_{\\mathrm{bas}}(t) $$\nSubstituting the expressions for concentrations $C_L = M_L/V_L$, $C_E = M_E/V_E$, $C_P = M_P/V_P$ into the flux and rate equations gives the final system in terms of the state variables $M_L, M_E, M_P$:\n$$ \\frac{dM_L}{dt} = -P_{\\mathrm{ap}} A_{\\mathrm{ap}} \\left(\\frac{M_L}{V_L} - \\frac{M_E}{V_E}\\right) + \\frac{V_{\\max,\\mathrm{pgp}} \\frac{M_E}{V_E}}{K_{m,\\mathrm{pgp}} + \\frac{M_E}{V_E}} - k_{\\mathrm{trans}} M_L $$\n$$ \\frac{dM_E}{dt} = P_{\\mathrm{ap}} A_{\\mathrm{ap}} \\left(\\frac{M_L}{V_L} - \\frac{M_E}{V_E}\\right) - P_{\\mathrm{bas}} A_{\\mathrm{bas}} \\left(\\frac{M_E}{V_E} - \\frac{M_P}{V_P}\\right) - \\frac{V_{\\max,\\mathrm{pgp}} \\frac{M_E}{V_E}}{K_{m,\\mathrm{pgp}} + \\frac{M_E}{V_E}} - CL_{\\mathrm{int}} \\frac{M_E}{V_E} $$\n$$ \\frac{dM_P}{dt} = P_{\\mathrm{bas}} A_{\\mathrm{bas}} \\left(\\frac{M_E}{V_E} - \\frac{M_P}{V_P}\\right) $$\nThis is an initial value problem (IVP) with initial conditions at time $t=0$: $M_L(0) = D_0$, $M_E(0) = 0$, and $M_P(0) = 0$, where $D_0$ is the initial oral dose.\n\nThe system of non-linear ODEs is solved numerically. We use an appropriate IVP solver, such as `solve_ivp` from the `scipy.integrate` library in Python, to integrate the system from $t=0$ to the specified observation time, $t=T_{\\mathrm{obs}}$. The solver computes the state vector $[M_L(t), M_E(t), M_P(t)]$ over this interval.\n\nThe final quantity of interest is the fraction of the dose that has reached the portal blood by time $T_{\\mathrm{obs}}$, denoted $F_{\\mathrm{portal}}$. This is calculated from the solution of the ODE system as:\n$$ F_{\\mathrm{portal}} = \\frac{M_P(T_{\\mathrm{obs}})}{D_0} $$\nThe implementation will process a suite of test cases. A set of default parameters is defined, and for each test case, these defaults are updated with case-specific values. For each parameter set, the IVP is solved, and $F_{\\mathrm{portal}}$ is calculated, rounded to six decimal places, and stored. The final output is a comma-separated list of these fractions enclosed in square brackets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the P-glycoprotein intestinal absorption model for a suite of test cases.\n    \"\"\"\n\n    def pbpk_model(t, M, params):\n        \"\"\"\n        Defines the system of ODEs for the three-compartment intestinal model.\n        \n        Args:\n            t (float): Current time (unused, for solver compatibility).\n            M (list or np.ndarray): State vector [M_L, M_E, M_P].\n            params (dict): Dictionary of model parameters.\n\n        Returns:\n            list: List of derivatives [dM_L/dt, dM_E/dt, dM_P/dt].\n        \"\"\"\n        M_L, M_E, M_P = M\n\n        # To prevent numerical instability with negative masses from solver steps\n        M_L = max(0, M_L)\n        M_E = max(0, M_E)\n\n        # Unpack parameters\n        V_L = params['V_L']\n        V_E = params['V_E']\n        V_P = params['V_P']\n        PS_ap = params['P_ap'] * params['A_ap'] # cm^3/s = mL/s\n        PS_bas = params['P_bas'] * params['A_bas'] # cm^3/s = mL/s\n        V_max_pgp = params['V_max_pgp']\n        K_m_pgp = params['K_m_pgp']\n        CL_int = params['CL_int']\n        k_trans = params['k_trans']\n\n        # Calculate concentrations\n        C_L = M_L / V_L\n        C_E = M_E / V_E\n        C_P = M_P / V_P\n\n        # Calculate fluxes and reaction rates (mg/s)\n        J_ap = PS_ap * (C_L - C_E)\n        J_bas = PS_bas * (C_E - C_P)\n        \n        if C_E > 0:\n            v_pgp = (V_max_pgp * C_E) / (K_m_pgp + C_E)\n        else:\n            v_pgp = 0.0\n\n        v_met = CL_int * C_E\n        rate_trans = k_trans * M_L\n\n        # Define the ODEs\n        dM_L_dt = -J_ap + v_pgp - rate_trans\n        dM_E_dt = J_ap - J_bas - v_pgp - v_met\n        dM_P_dt = J_bas\n\n        return [dM_L_dt, dM_E_dt, dM_P_dt]\n\n    # Shared default parameters\n    default_params = {\n        'V_L': 250.0,       # mL\n        'V_E': 1.0,         # mL\n        'V_P': 1000.0,      # mL\n        'A_ap': 1500.0,     # cm^2\n        'A_bas': 1500.0,    # cm^2\n        'P_ap': 2.0e-5,     # cm/s\n        'P_bas': 2.0e-5,    # cm/s\n        'V_max_pgp': 0.02,  # mg/s\n        'K_m_pgp': 0.1,     # mg/mL\n        'CL_int': 0.05,     # mL/s\n        'k_trans': 2.0e-4,  # s^-1\n        'T_obs': 7200.0,    # s\n    }\n\n    # Define the test cases with their specific parameters\n    test_cases = [\n        # Case 1 (baseline)\n        {'D_0': 100.0},\n        # Case 2 (high efflux)\n        {'D_0': 100.0, 'V_max_pgp': 0.1},\n        # Case 3 (high dose, saturating efflux)\n        {'D_0': 500.0, 'V_max_pgp': 0.1},\n        # Case 4 (no efflux)\n        {'D_0': 100.0, 'V_max_pgp': 0.0},\n        # Case 5 (low permeability)\n        {'D_0': 100.0, 'P_ap': 5.0e-6, 'P_bas': 5.0e-6},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        # Create a full parameter set for the current case\n        params = default_params.copy()\n        params.update(case_params)\n\n        # Set up the initial conditions and time span\n        D_0 = params['D_0']\n        M0 = [D_0, 0.0, 0.0]\n        t_span = (0, params['T_obs'])\n        \n        # Solve the ODE system\n        # Use t_eval to get the solution only at the final time point\n        sol = solve_ivp(\n            pbpk_model,\n            t_span,\n            M0,\n            method='RK45',\n            args=(params,),\n            t_eval=[params['T_obs']],\n            rtol=1e-8,\n            atol=1e-8\n        )\n        \n        # Extract the final mass in the portal blood compartment\n        M_P_final = sol.y[2, -1]\n        \n        # Calculate the fraction absorbed into the portal vein\n        F_portal = M_P_final / D_0\n        \n        results.append(F_portal)\n\n    # Format the results as specified\n    # The f-string formatting f'{r:.6f}' correctly rounds to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}