{
    "hands_on_practices": [
        {
            "introduction": "药物基因组学是个体间药物反应差异的关键来源之一。本练习将运用群体遗传学的核心原理——哈迪-温伯格平衡，来阐明基因频率与基因型频率之间的关系。通过这项实践，你将掌握如何估算特定人群中由基因决定的表型（例如“慢代谢者”）的预期比例，这是理解药物基因组学影响的基础。",
            "id": "4592054",
            "problem": "一个影响肝脏药物清除率的双等位基因药物基因在单个常染色体基因座上表现出两个等位基因：一个功能性等位基因（表示为 $A$）和一个功能丧失性等位基因（表示为 $a$）。在一个大型随机交配群体中，配子的等位基因频率为：$A$ 的频率 $p=0.8$，$a$ 的频率 $q=0.2$，且 $p+q=1$。弱代谢者表型在操作上定义为具有纯合功能丧失性基因型 $aa$（无功能性酶活性）的个体。假设群体处于哈迪-温伯格平衡（HWE）状态，这要求随机交配、无选择、无突变、无迁移以及足够大的群体规模，并将从交配配子中抽样的等位基因视为从配子库中的独立抽取。\n\n从 HWE 的概率解释（即独立配子等位基因抽取的乘积）出发，推导群体中弱代谢者的期望比例（用 $p$ 和 $q$ 表示），然后使用 $p=0.8$ 和 $q=0.2$ 计算其数值。将最终结果表示为一个无量纲的小数，无需四舍五入。",
            "solution": "该问题已经过验证，被认为是具有科学依据、良定且客观的。它代表了哈迪-温伯格原理（群体遗传学中的一个基本概念及其在药物遗传学中的应用）的标准应用。所有必要信息均已提供，且前提条件一致且在科学上是现实的。\n\n该问题要求计算群体中弱代谢者的期望比例，弱代谢者被定义为基因型为 $aa$ 的个体。推导过程必须从哈迪-温伯格平衡（HWE）的概率解释开始。\n\n设在一个大型随机交配群体的配子库中，$p$ 是功能性等位基因 $A$ 的频率，$q$ 是功能丧失性等位基因 $a$ 的频率。给定值为 $p = 0.8$ 和 $q = 0.2$。条件 $p + q = 0.8 + 0.2 = 1$ 得到满足。\n\n在 HWE 条件下，二倍体合子基因型的形成被建模为从群体配子库中进行两次独立随机抽取的结果。一次抽取代表父方配子，另一次抽取代表母方配子。\n\n抽取一个携带等位基因 $A$ 的配子的概率等于其频率，即 $P(A) = p$。\n抽取一个携带等位基因 $a$ 的配子的概率等于其频率，即 $P(a) = q$。\n\n如果一个个体的基因型是 $aa$，那么他/她就是一个弱代谢者。要形成这种基因型，该个体必须从第一个配子（例如父方）遗传一个等位基因 $a$，并且从第二个配子（例如母方）遗传一个等位基因 $a$。\n\n设 $E_1$ 为第一个随机选择的配子携带等位基因 $a$ 的事件。该事件的概率为 $P(E_1) = q$。\n设 $E_2$ 为第二个随机选择的配子携带等位基因 $a$ 的事件。该事件的概率为 $P(E_2) = q$。\n\n由于在 HWE 假设下，这两次抽取是独立事件，因此两个事件同时发生的概率是它们各自概率的乘积。这个联合概率对应于群体中 $aa$ 基因型的期望频率，我们将其记为 $f(aa)$。\n\n$$f(aa) = P(E_1 \\cap E_2) = P(E_1) \\times P(E_2)$$\n将概率用等位基因频率 $q$ 代入：\n$$f(aa) = q \\times q = q^2$$\n这个表达式 $f(aa) = q^2$ 就是用等位基因频率 $q$ 表示的群体中弱代谢者的推导比例。由于 $q = 1-p$，它也可以用 $p$ 表示为 $f(aa) = (1-p)^2$。题目要求用 $p$ 和 $q$ 进行推导，而 $q^2$ 是最直接的形式。\n\n现在，我们使用给定的等位基因频率 $q = 0.2$ 来计算其数值。\n$$f(aa) = (0.2)^2$$\n$$f(aa) = 0.04$$\n结果是一个无量纲的小数，符合题目要求。该群体中弱代谢者的期望比例为 $0.04$。",
            "answer": "$$\\boxed{0.04}$$"
        },
        {
            "introduction": "在理解了群体中的基因频率后，我们进一步探讨特定基因变异如何影响个体内的药物代谢过程。本练习模拟了一个前药 (prodrug) 的药代动力学情景，其中负责激活药物的酶（如*CYP2C19*）存在基因多态性。通过运用清除率和稳态质量平衡等基本概念，你将推导并计算功能缺失型基因如何改变活性代谢物的体内暴露水平，这种量化分析能力对于实现个体化给药至关重要。",
            "id": "4592091",
            "problem": "一种前体药物 $P$ 以恒定的零级速率 $R_{\\text{in}}$ 给药，并表现出线性（一级）药代动力学特性。活性代谢物 $M$ 仅通过由细胞色素P450 2C19（*CYP2C19*）介导的 $P$ 的肝脏激活形成，其特征是激活清除率为 $CL_{\\text{activation}}$。母体前体药物 $P$ 通过两条平行途径消除：清除率为 $CL_{\\text{activation}}$ 的激活途径和清除率为 $CL_{\\text{other}}$ 的非激活途径。活性代谢物 $M$ 以 $CL_{\\text{metabolite}}$ 的清除率被消除。假设已达到稳态，并且所有过程都是线性和时不变的。\n\n与野生型相比，一种功能丧失型基因型使 $CL_{\\text{activation}}$ 减半，同时保持 $R_{\\text{in}}$、$CL_{\\text{other}}$、$CL_{\\text{metabolite}}$ 和给药间隔 $\\tau$ 不变。设野生型的值为 $CL_{\\text{activation,WT}} = 20\\ \\text{L}\\ \\text{h}^{-1}$ 和 $CL_{\\text{other}} = 30\\ \\text{L}\\ \\text{h}^{-1}$。突变体具有 $CL_{\\text{activation,Mut}} = \\tfrac{1}{2} CL_{\\text{activation,WT}}$。\n\n仅使用质量平衡和清除率的定义，推导活性代谢物在一个给药间隔内的稳态浓度-时间曲线下面积 $AUC_{M}$ 的表达式，该表达式是 $R_{\\text{in}}$、$CL_{\\text{activation}}$、$CL_{\\text{other}}$、$CL_{\\text{metabolite}}$ 和 $\\tau$ 的函数。然后，计算由功能丧失型基因型引起的 $AUC_{M}$ 的倍数变化，其定义为\n$$\\text{Fold-change} = \\frac{AUC_{M,\\text{Mut}}}{AUC_{M,\\text{WT}}}.$$\n以单个无单位数字的形式提供您的最终答案。不要包含任何单位。如果进行任何取整，请将最终答案取至四位有效数字。",
            "solution": "用户要求解答一个药代动力学问题。\n\n### 步骤1：提取已知条件\n-   **系统**：前体药物 $P$ 及其活性代谢物 $M$。\n-   **输入**：以速率 $R_{\\text{in}}$ 恒定零级输入 $P$。\n-   **药代动力学**：所有过程均为线性（一级）且时不变。系统处于稳态。\n-   **前体药物消除**：\n    -   $P$ 的总清除率为 $CL_P = CL_{\\text{activation}} + CL_{\\text{other}}$。\n    -   激活途径（形成 $M$）：清除率为 $CL_{\\text{activation}}$。此途径由 *CYP2C19* 介导。\n    -   非激活途径：清除率为 $CL_{\\text{other}}$。\n-   **代谢物消除**：$M$ 的清除率为 $CL_{\\text{metabolite}}$。\n-   **基因型**：\n    -   野生型（WT）：$CL_{\\text{activation,WT}} = 20\\ \\text{L}\\ \\text{h}^{-1}$。\n    -   功能丧失型突变体（Mut）：$CL_{\\text{activation,Mut}} = \\frac{1}{2} CL_{\\text{activation,WT}}$。\n-   **常数**：$CL_{\\text{other}} = 30\\ \\text{L}\\ \\text{h}^{-1}$。参数 $R_{\\text{in}}$、$CL_{\\text{other}}$、$CL_{\\text{metabolite}}$ 以及给药间隔 $\\tau$ 在不同基因型之间保持不变。\n-   **要求输出**：\n    1.  活性代谢物在一个给药间隔内的稳态浓度-时间曲线下面积 $AUC_{M}$ 的表达式，该表达式是 $R_{\\text{in}}$、$CL_{\\text{activation}}$、$CL_{\\text{other}}$、$CL_{\\text{metabolite}}$ 和 $\\tau$ 的函数。\n    2.  倍数变化的数值，定义为 $\\frac{AUC_{M,\\text{Mut}}}{AUC_{M,\\text{WT}}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n问题定义明确，科学上基于临床药理学和药代动力学的原理。它描述了一种常见且现实的场景：一种前体药物由多态性酶激活，导致个体间反应的差异。所使用的概念——清除率、零级输入、一级消除、稳态和曲线下面积（AUC）——都是标准概念。问题陈述是自洽的、客观的，并提供了推导表达式和计算所需比率的所有必要信息。没有矛盾或违反科学原理之处。该问题是有效的。\n\n### 步骤3：推导与求解\n\n该问题将通过应用稳态下的质量平衡原理来解决。在稳态下，物质进入系统或房室的速率等于其消除速率。\n\n**第1部分：$AUC_M$ 通用表达式的推导**\n\n首先，考虑前体药物 $P$。它以恒定速率 $R_{\\text{in}}$ 给药。其从体内的总消除通过两条平行的一级途径发生，其特征清除率分别为 $CL_{\\text{activation}}$ 和 $CL_{\\text{other}}$。前体药物的总清除率 $CL_P$ 是这些平行清除率的总和：\n$$CL_P = CL_{\\text{activation}} + CL_{\\text{other}}$$\n在稳态下，$P$ 的给药速率必须等于其总消除速率：\n$$R_{\\text{in}} = CL_P \\cdot C_{P,ss}$$\n其中 $C_{P,ss}$ 是前体药物的稳态浓度。代入 $CL_P$ 的表达式，我们得到：\n$$R_{\\text{in}} = (CL_{\\text{activation}} + CL_{\\text{other}}) \\cdot C_{P,ss}$$\n\n接下来，考虑活性代谢物 $M$。它仅通过激活途径由前体药物 $P$ 形成。在稳态下，$M$ 的形成速率，记为 $R_{\\text{form,M,ss}}$，等于 $P$ 通过此特定途径的消除速率：\n$$R_{\\text{form,M,ss}} = CL_{\\text{activation}} \\cdot C_{P,ss}$$\n我们可以从前体药物的质量平衡方程中用 $R_{\\text{in}}$ 表示 $C_{P,ss}$：$C_{P,ss} = \\frac{R_{\\text{in}}}{CL_{\\text{activation}} + CL_{\\text{other}}}$。将其代入 $M$ 的形成速率方程：\n$$R_{\\text{form,M,ss}} = CL_{\\text{activation}} \\left( \\frac{R_{\\text{in}}}{CL_{\\text{activation}} + CL_{\\text{other}}} \\right)$$\n对于代谢物 $M$，在稳态下，其形成速率必须等于其消除速率。$M$ 的消除速率由 $CL_{\\text{metabolite}} \\cdot C_{M,ss}$ 给出，其中 $C_{M,ss}$ 是代谢物的稳态浓度。然而，为了求出在一个间隔 $\\tau$ 内的曲线下面积 $AUC_M$，我们使用一个更基本的稳态原理：在一个给药间隔 $\\tau$ 内消除的物质总量必须等于在同一间隔内进入体循环（即形成）的物质总量。\n\n在间隔 $\\tau$ 内形成的总量 $M$ 为：\n$$\\text{Amount}_{M,\\text{formed}} = R_{\\text{form,M,ss}} \\cdot \\tau = \\left( \\frac{R_{\\text{in}} \\cdot CL_{\\text{activation}}}{CL_{\\text{activation}} + CL_{\\text{other}}} \\right) \\cdot \\tau$$\n根据定义，清除率将消除速率与浓度联系起来。在一个间隔内积分，它将消除的总量与浓度-时间曲线下面积（$AUC$）联系起来。在间隔 $\\tau$ 内消除的总量 $M$ 为：\n$$\\text{Amount}_{M,\\text{eliminated}} = CL_{\\text{metabolite}} \\cdot AUC_M$$\n其中 $AUC_M$ 是在稳态下，代谢物在间隔 $\\tau$ 内的曲线下面积。\n\n将形成量与消除量相等：\n$$\\text{Amount}_{M,\\text{formed}} = \\text{Amount}_{M,\\text{eliminated}}$$\n$$\\left( \\frac{R_{\\text{in}} \\cdot CL_{\\text{activation}}}{CL_{\\text{activation}} + CL_{\\text{other}}} \\right) \\cdot \\tau = CL_{\\text{metabolite}} \\cdot AUC_M$$\n求解 $AUC_M$，我们得到所需的通用表达式：\n$$AUC_M = \\frac{R_{\\text{in}} \\cdot \\tau \\cdot CL_{\\text{activation}}}{(CL_{\\text{activation}} + CL_{\\text{other}}) \\cdot CL_{\\text{metabolite}}}$$\n\n**第2部分：$AUC_M$ 倍数变化的计算**\n\n倍数变化是突变基因型的 $AUC_M$ 与野生型基因型的 $AUC_M$ 之比。\n$$\\text{Fold-change} = \\frac{AUC_{M,\\text{Mut}}}{AUC_{M,\\text{WT}}}$$\n使用上面推导的通用表达式，我们可以写出 $AUC_{M,\\text{Mut}}$ 和 $AUC_{M,\\text{WT}}$ 的表达式。参数 $R_{\\text{in}}$、$\\tau$、$CL_{\\text{other}}$ 和 $CL_{\\text{metabolite}}$ 对于两种基因型都是相同的。\n\n对于野生型（WT）：\n$$AUC_{M,\\text{WT}} = \\frac{R_{\\text{in}} \\cdot \\tau \\cdot CL_{\\text{activation,WT}}}{(CL_{\\text{activation,WT}} + CL_{\\text{other}}) \\cdot CL_{\\text{metabolite}}}$$\n对于突变体（Mut）：\n$$AUC_{M,\\text{Mut}} = \\frac{R_{\\text{in}} \\cdot \\tau \\cdot CL_{\\text{activation,Mut}}}{(CL_{\\text{activation,Mut}} + CL_{\\text{other}}) \\cdot CL_{\\text{metabolite}}}$$\n现在，我们计算比率。公共项（$R_{\\text{in}}$、$\\tau$、$CL_{\\text{metabolite}}$）被约去：\n$$\\text{Fold-change} = \\frac{\\frac{CL_{\\text{activation,Mut}}}{CL_{\\text{activation,Mut}} + CL_{\\text{other}}}}{\\frac{CL_{\\text{activation,WT}}}{CL_{\\text{activation,WT}} + CL_{\\text{other}}}}$$\n这可以重新排列为：\n$$\\text{Fold-change} = \\left( \\frac{CL_{\\text{activation,Mut}}}{CL_{\\text{activation,WT}}} \\right) \\cdot \\left( \\frac{CL_{\\text{activation,WT}} + CL_{\\text{other}}}{CL_{\\text{activation,Mut}} + CL_{\\text{other}}} \\right)$$\n现在我们代入给定的数值：\n$CL_{\\text{activation,WT}} = 20\\ \\text{L}\\ \\text{h}^{-1}$\n$CL_{\\text{other}} = 30\\ \\text{L}\\ \\text{h}^{-1}$\n$CL_{\\text{activation,Mut}} = \\frac{1}{2} CL_{\\text{activation,WT}} = \\frac{1}{2} \\cdot 20\\ \\text{L}\\ \\text{h}^{-1} = 10\\ \\text{L}\\ \\text{h}^{-1}$\n\n将这些值代入倍数变化表达式：\n$$\\text{Fold-change} = \\left( \\frac{10}{20} \\right) \\cdot \\left( \\frac{20 + 30}{10 + 30} \\right)$$\n$$\\text{Fold-change} = \\left( \\frac{1}{2} \\right) \\cdot \\left( \\frac{50}{40} \\right)$$\n$$\\text{Fold-change} = \\frac{1}{2} \\cdot \\frac{5}{4} = \\frac{5}{8}$$\n将此分数转换为小数得到：\n$$\\text{Fold-change} = 0.625$$\n由于这是一个精确值，且要求如果进行取整则需保留四位有效数字，我们将答案表示为 $0.6250$。",
            "answer": "$$\\boxed{0.6250}$$"
        },
        {
            "introduction": "药物反应的差异不仅源于遗传和生理因素，患者的行为也扮演着关键角色。本练习将通过计算机模拟，展示不依从医嘱（如漏服药物）如何导致药物浓度偏低，而这种现象可能被误解为患者具有异常高的药物清除率。这项编程实践将让你直观地理解行为因素如何干扰临床药代动力学数据的解读，这对于临床实践和科学研究都具有重要的警示意义。",
            "id": "4592100",
            "problem": "设计并实现一个程序，通过比较单室模型（具有一级消除和瞬时输入）中完美依从性与不完美依从性下的谷浓度，来量化不依从性（漏服剂量）如何被误解为异常高的清除率。\n\n使用的基本原理：\n- 在两次给药事件之间，浓度 $C(t)$ 遵循常微分方程 $dC/dt = -k \\, C$，其中 $k$ 是一级消除速率常数。\n- 在一次给药事件中，给予剂量大小为 $D$（单位 mg）、绝对生物利用度为 $F$（无单位）的药物，会产生瞬时浓度增量 $\\Delta C = F \\, D / V_{\\mathrm{d}}$，其中 $V_{\\mathrm{d}}$（单位 L）是表观分布容积。\n- 清除率 $CL$ 与 $k$ 和 $V_{\\mathrm{d}}$ 的关系为 $CL = k \\, V_{\\mathrm{d}}$。\n- 每隔 $\\tau$ 小时安排一次给药。谷浓度定义为下一次计划给药前瞬间的浓度。\n\n根据指定的依从性模式计算观察谷浓度的模拟方案：\n- 将给药方案表示为一个序列 $\\{s_i\\}_{i=1}^N$，包含 $N$ 个给药间隔，其中 $s_i \\in \\{0,1\\}$，$s_i = 1$ 表示在第 $i$ 个间隔结束时服用了计划的剂量，$s_i = 0$ 表示漏服。\n- 令 $A = F \\, D / V_{\\mathrm{d}}$。令 $r = \\exp(-k \\, \\tau)$。将时间 $0$ 时的给药后浓度初始化为 $C^{+}_0 = 0$。\n- 对于每个间隔 $i = 1,2,\\dots,N$，计算在该间隔结束时、计划给药时间点之前的给药前（谷）浓度为 $C^{-}_i = C^{+}_{i-1} \\, r$。然后，如果 $s_i = 1$，则更新给药后浓度为 $C^{+}_i = C^{-}_i + A$；如果 $s_i = 0$，则更新为 $C^{+}_i = C^{-}_i$。模拟结束时的观察谷浓度为 $C^{-}_N$（单位 mg/L）。\n\n朴素推断步骤（将在您的解决方案中从第一性原理推导）：\n- 一个不了解漏服情况的朴素研究者，假设在稳态下是完美依从性，并使用观察到的谷浓度 $C^{-}_N$ 以及已知的 $D$、$F$、$V_{\\mathrm{d}}$ 和 $\\tau$ 来反向计算一个由完美依从性稳态谷浓度逻辑所隐含的表观消除速率常数 $k_{\\mathrm{app}}$。由此，表观清除率为 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$。\n- 您的任务是为每个测试用例计算比率 $R = CL_{\\mathrm{app}} / CL$（无量纲），其中 $CL$ 是真实清除率。这个比率量化了由于不依从性被错误归因于药代动力学而导致的清除率膨胀（值大于1）或收缩（值小于1）。\n\n物理和数值单位：\n- 剂量使用 mg，容积使用 L，时间使用小时，清除率使用 L/h，浓度使用 mg/L。输出的比率是无单位的。\n- 所有角度（如果出现）在此均不相关。\n- 不要将任何值表示为百分比；使用小数。\n\n测试套件：\n对于每个测试用例，给定 $(CL, V_{\\mathrm{d}}, D, F, \\tau, \\{s_i\\}_{i=1}^N)$。\n\n1) 完美依从性，半衰期相对于给药间隔为中等：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h.\n- 方案：$N = 80$，对于所有 $i = 1,\\dots,80$，$s_i = 1$。\n\n2) 在测量的谷浓度之前立即漏服单次剂量（此前长期依从）：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h.\n- 方案：$N = 62$，对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$, $s_{62} = 1$。\n\n3) 在测量的谷浓度之前立即连续漏服两次剂量（此前长期依从）：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h.\n- 方案：$N = 63$，对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$, $s_{62} = 0$, $s_{63} = 1$。\n\n4) 漏服单次剂量，长半衰期（$k$ 相对于给药频率较小）：\n- $CL = 1$ L/h, $V_{\\mathrm{d}} = 100$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h.\n- 方案：$N = 62$，对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$, $s_{62} = 1$。\n\n5) 漏服单次剂量，短半衰期（$k$ 相对于给药频率较大）：\n- $CL = 20$ L/h, $V_{\\mathrm{d}} = 40$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h.\n- 方案：$N = 62$，对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$, $s_{62} = 1$。\n\n程序要求：\n- 根据上述递推关系，为每个测试用例实现 $C^{-}_N$ 的模拟。\n- 推导并实现朴素的完美依从性反演，从观察到的谷浓度 $C^{-}_N$ 中获得 $k_{\\mathrm{app}}$，然后计算 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$ 和比率 $R = CL_{\\mathrm{app}} / CL$。\n- 您的程序应生成单行输出，其中包含按测试用例顺序排列的五个比率，格式为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_j$ 是一个四舍五入到小数点后六位的小数。",
            "solution": "我们从单室线性药代动力学（具有一级消除和瞬时输入）的第一性原理构建解决方案。\n\n1. 两次给药之间的动力学。在两次给药事件之间，浓度 $C(t)$ 遵循 $dC/dt = -k \\, C$。在长度为 $\\tau$ 的固定给药间隔内，解为 $C(t+\\tau) = C(t)\\, \\exp(-k \\, \\tau)$。定义 $r = \\exp(-k \\, \\tau)$ 表示一个给药间隔内的衰减因子。\n\n2. 给药时的瞬时变化。剂量为 $D$（mg）且绝对生物利用度为 $F$ 的药物使浓度瞬时增加 $\\Delta C = A$，其中 $A = F \\, D / V_{\\mathrm{d}}$（mg/L），$V_{\\mathrm{d}}$（L）是表观分布容积。因此，如果 $C^{-}_i$ 表示在第 $i$ 个间隔结束时、计划给药前的瞬时浓度（谷浓度），而 $C^{+}_i$ 表示在那个时间点、计划给药后的瞬时浓度，那么如果服药，则 $C^{+}_i = C^{-}_i + A$，如果漏服，则 $C^{+}_i = C^{-}_i$。\n\n3. 跨给药方案的递推关系。令 $\\{s_i\\}_{i=1}^N$ 是一个序列，其中 $s_i \\in \\{0,1\\}$ 表示在第 $i$ 个间隔结束时漏服（0）或服用（1）剂量。初始化 $C^{+}_0 = 0$。对于每个间隔 $i = 1,2,\\dots,N$：\n- 通过消除过程传播至给药前谷浓度：$C^{-}_i = C^{+}_{i-1} \\, r$，其中 $r = \\exp(-k \\, \\tau)$。\n- 如果服药，则应用瞬时剂量：$C^{+}_i = C^{-}_i + s_i \\, A$。\n模拟结束时的观察谷浓度为 $C^{-}_N$。\n\n4. 完美依从性稳态。在完美依从性（对所有 $i$，$s_i=1$）下，经过多个间隔后，过程达到稳态，此时每个间隔的给药前谷浓度 $C^{-}$ 和给药后浓度 $C^{+}$ 会重复。令 $C^{-}_{\\mathrm{ss}}$ 和 $C^{+}_{\\mathrm{ss}}$ 为稳态谷浓度和给药后浓度值。它们的关系是 $C^{-}_{\\mathrm{ss}} = C^{+}_{\\mathrm{ss}} \\, r$ 和 $C^{+}_{\\mathrm{ss}} = C^{-}_{\\mathrm{ss}} + A$。消去 $C^{+}_{\\mathrm{ss}}$ 可得\n$$\nC^{-}_{\\mathrm{ss}} = (C^{-}_{\\mathrm{ss}} + A)\\, r \\quad \\Rightarrow \\quad C^{-}_{\\mathrm{ss}} (1 - r) = A \\, r \\quad \\Rightarrow \\quad C^{-}_{\\mathrm{ss}} = \\frac{A \\, r}{1 - r}.\n$$\n\n5. 基于完美依从性假设的朴素反演。假设一位研究者观察到一个谷浓度 $C_{\\mathrm{obs}}$，并假设它是在完美依从性稳态下产生的。然后，使用稳态关系式，\n$$\nC_{\\mathrm{obs}} = \\frac{A \\, r}{1 - r},\n$$\n在 $A = F \\, D / V_{\\mathrm{d}}$ 已知的情况下，研究者在没有任何关于 $k$ 的先验知识的情况下求解 $r$。重新整理，\n$$\nC_{\\mathrm{obs}} (1 - r) = A \\, r \\quad \\Rightarrow \\quad C_{\\mathrm{obs}} = r (C_{\\mathrm{obs}} + A) \\quad \\Rightarrow \\quad r = \\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{obs}} + A}.\n$$\n之后，由于 $r = \\exp(-k_{\\mathrm{app}} \\, \\tau)$，表观消除速率常数为\n$$\nk_{\\mathrm{app}} = -\\frac{1}{\\tau} \\ln r = -\\frac{1}{\\tau} \\ln\\left(\\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{obs}} + A}\\right).\n$$\n最后，表观清除率为 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$，表观清除率与真实清除率之比为\n$$\nR = \\frac{CL_{\\mathrm{app}}}{CL} = \\frac{k_{\\mathrm{app}} \\, V_{\\mathrm{d}}}{CL}.\n$$\n\n6. 每个测试用例的算法实现。\n7. 测试套件覆盖范围。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_trough(CL, Vd, D, F, tau, schedule):\n    \"\"\"\n    Simulate the observed trough concentration C_obs (mg/L) given:\n    - CL: clearance (L/h)\n    - Vd: volume of distribution (L)\n    - D: dose (mg)\n    - F: absolute bioavailability (unitless)\n    - tau: dosing interval (h)\n    - schedule: list of integers 0/1 indicating missed/taken doses per interval\n    \"\"\"\n    k = CL / Vd  # h^-1\n    A = F * D / Vd  # mg/L\n    r = np.exp(-k * tau)\n\n    C_post = 0.0  # C^+_0\n    last_trough = 0.0\n    for s in schedule:\n        C_pre = C_post * r  # trough before scheduled dose at end of interval\n        last_trough = C_pre\n        # apply dose if taken\n        if s == 1:\n            C_post = C_pre + A\n        else:\n            C_post = C_pre\n    return last_trough  # mg/L\n\ndef apparent_clearance_ratio(CL, Vd, D, F, tau, schedule):\n    \"\"\"\n    Compute the ratio R = CL_app / CL using the naive perfect-adherence inversion\n    from the observed trough simulated under the given schedule.\n    \"\"\"\n    C_obs = simulate_trough(CL, Vd, D, F, tau, schedule)\n    A = F * D / Vd\n    # Guard against degenerate zero (should not occur with schedules chosen here)\n    # r_app = C_obs / (C_obs + A)\n    r_app = C_obs / (C_obs + A)\n    # Numerical safety: clip r_app to (0, 1) open interval\n    r_app = min(max(r_app, np.finfo(float).tiny), 1.0 - 1e-15)\n    k_app = -np.log(r_app) / tau\n    CL_app = k_app * Vd\n    return CL_app / CL\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1) Perfect adherence, moderate half-life\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*80\n        },\n        # 2) Single missed dose immediately before measured trough\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n        # 3) Two consecutive missed doses immediately before measured trough\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 0, 1]\n        },\n        # 4) Single missed dose, long half-life\n        {\n            \"CL\": 1.0, \"Vd\": 100.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n        # 5) Single missed dose, short half-life\n        {\n            \"CL\": 20.0, \"Vd\": 40.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        ratio = apparent_clearance_ratio(\n            case[\"CL\"], case[\"Vd\"], case[\"D\"], case[\"F\"], case[\"tau\"], case[\"schedule\"]\n        )\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```\n程序实现了这一逻辑，并以方括号括起来的逗号分隔列表形式输出五个比率，每个比率四舍五入到小数点后六位。",
            "answer": "[1.000000,1.803322,2.441999,1.116668,1.996996]"
        }
    ]
}