{
    "hands_on_practices": [
        {
            "introduction": "A leading theory for the generation of tinnitus posits that the central auditory system increases its internal \"volume\" or gain to compensate for a loss of input from the periphery. This exercise  allows you to formalize this concept using a simple but powerful homeostatic gain-control model. By deriving the steady-state gain under different conditions, you will develop a tangible understanding of how auditory deafferentation can lead to a state of central hyperexcitability, providing a theoretical foundation for the emergence of tinnitus.",
            "id": "5078403",
            "problem": "You are tasked with formalizing and simulating a minimal homeostatic gain-control model used to reason about tinnitus emergence after a decrease in peripheral auditory input, using first principles of linear dynamical systems and explicit definitions of model components. Consider a scalar central gain $G(t)$ that modulates the effective input $I(t)$ arriving from the periphery, defined by $I(t) = G(t)\\,I_{\\mathrm{ext}}(t)$, where $I_{\\mathrm{ext}}(t)$ is the externally provided cochlear drive. Assume a homeostatic control law that changes $G(t)$ according to the mismatch between a target drive $I_0$ and the current effective input $I(t)$:\n$$\n\\frac{dG}{dt} = k\\left(I_0 - I(t)\\right),\n$$\nwith $k > 0$ a rate constant. After a step change at time $t=0$, the external drive becomes constant, $I_{\\mathrm{ext}}(t) = I_{\\mathrm{post}}$ for all $t \\ge 0$; before the step, $I_{\\mathrm{ext}}(t) = I_{\\mathrm{pre}}$ for $t  0$. Physiologically, central gain is bounded, so you must impose saturation $0 \\le G(t) \\le G_{\\max}$ at all times. Assume an initial gain $G(0)=G_0$. For tinnitus emergence in quiet, adopt the following operational criterion: let $N$ denote the internal noise amplitude and $T$ the detection threshold, both in the same arbitrary units (a.u.) as $I_0$. Tinnitus is deemed to emerge at steady state if and only if $G_{\\mathrm{ss}}\\,N \\ge T$, where $G_{\\mathrm{ss}}$ is the steady-state gain after the step.\n\nUsing only the fundamental rules of solving first-order linear ordinary differential equations and the above definitions, do the following:\n- For $I_{\\mathrm{post}} > 0$, derive the steady-state gain $G_{\\mathrm{ss}}$ that the system converges to under the saturation constraint $0 \\le G \\le G_{\\max}$. For $I_{\\mathrm{post}}=0$, deduce the appropriate steady-state $G_{\\mathrm{ss}}$ given the same saturation constraint.\n- Implement an algorithm that, given parameters $(k, I_0, I_{\\mathrm{pre}}, I_{\\mathrm{post}}, G_0, G_{\\max}, N, T)$, computes $G_{\\mathrm{ss}}$ and the tinnitus-emergence boolean defined by $G_{\\mathrm{ss}}\\,N \\ge T$.\n\nUnits and conventions:\n- Time $t$ is in seconds (s).\n- The rate constant $k$ is in $\\mathrm{s}^{-1}$.\n- The target input $I_0$, external inputs $I_{\\mathrm{pre}}$ and $I_{\\mathrm{post}}$, internal noise $N$, and threshold $T$ are in arbitrary units (a.u.).\n- Gain $G$ and $G_{\\max}$ are dimensionless.\n- Angles are not involved.\n- Express the steady-state gain $G_{\\mathrm{ss}}$ numerically rounded to exactly $6$ decimal places. Represent the tinnitus-emergence boolean as an integer, with $1$ for true (emerges) and $0$ for false (does not emerge).\n\nTest suite:\nCompute results for each of the following parameter sets. Each set is a tuple $(k, I_0, I_{\\mathrm{pre}}, I_{\\mathrm{post}}, G_0, G_{\\max}, N, T)$:\n1. $(0.5, 1.0, 1.0, 0.5, 1.0, 10.0, 0.08, 0.06)$\n2. $(0.3, 1.0, 1.0, 0.8, 0.9, 10.0, 0.08, 0.10)$\n3. $(0.4, 1.0, 1.0, 0.05, 1.0, 8.0, 0.01, 0.12)$\n4. $(1.0, 1.0, 1.0, 1.0, 1.0, 10.0, 0.04, 0.05)$\n5. $(0.5, 1.0, 1.0, 0.0, 1.0, 8.0, 0.02, 0.12)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, in the order of the test suite above. Each inner list must be of the form $[G_{\\mathrm{ss}}, b]$ where $G_{\\mathrm{ss}}$ is rounded to exactly $6$ decimal places and $b$ is the integer tinnitus-emergence flag ($1$ if $G_{\\mathrm{ss}}\\,N \\ge T$, otherwise $0$). For example, a valid output might look like $[[0.123456,1],[1.234000,0]]$ for two hypothetical cases.",
            "solution": "The user has provided a valid, well-posed problem that is scientifically grounded in the principles of linear dynamical systems as applied to a simplified model of neural homeostasis. The problem is to determine the steady-state central gain and evaluate a criterion for tinnitus emergence based on this gain. We will proceed with the derivation and solution.\n\nThe dynamics of the central gain $G(t)$ are governed by the first-order ordinary differential equation (ODE):\n$$\n\\frac{dG}{dt} = k(I_0 - I(t))\n$$\nwhere $k > 0$ is a rate constant, $I_0$ is the target neural drive, and $I(t) = G(t)I_{\\mathrm{ext}}(t)$ is the effective input. For time $t \\ge 0$, the external input $I_{\\mathrm{ext}}(t)$ is a constant, $I_{\\mathrm{ext}}(t) = I_{\\mathrm{post}}$. Substituting this into the ODE gives:\n$$\n\\frac{dG}{dt} = k(I_0 - G(t)I_{\\mathrm{post}})\n$$\nThis is a first-order linear inhomogeneous ODE. The steady-state gain, denoted $G_{\\mathrm{ss}}$, is the value of $G(t)$ as $t \\to \\infty$. At steady state, the system is in equilibrium, which means the rate of change of the gain is zero, i.e., $\\frac{dG}{dt} = 0$.\n\nSetting the derivative to zero, we can find the unconstrained fixed point, which we will call $G^*$:\n$$\n0 = k(I_0 - G^* I_{\\mathrm{post}})\n$$\nSince $k > 0$, this simplifies to:\n$$\nI_0 = G^* I_{\\mathrm{post}}\n$$\nWe analyze the solution for $G^*$ by considering two cases for the value of $I_{\\mathrm{post}}$.\n\n**Case 1: $I_{\\mathrm{post}} > 0$**\n\nIf the post-lesion external input $I_{\\mathrm{post}}$ is positive, we can solve for the unconstrained steady-state gain $G^*$:\n$$\nG^* = \\frac{I_0}{I_{\\mathrm{post}}}\n$$\nThis is the value the gain would converge to if there were no bounds. However, the problem imposes saturation constraints, such that the gain must remain within the range $[0, G_{\\max}]$. The actual steady-state gain $G_{\\mathrm{ss}}$ is therefore the value of $G^*$ clipped to this valid range.\n\nGiven that the target input $I_0$ and the external input $I_{\\mathrm{post}}$ represent physical drives, they are non-negative ($I_0 \\ge 0$, $I_{\\mathrm{post}} > 0$), which implies $G^* \\ge 0$. Therefore, we only need to consider the upper saturation boundary $G_{\\max}$.\n- If $G^* \\le G_{\\max}$, the fixed point is reachable and the system will settle at $G_{\\mathrm{ss}} = G^*$.\n- If $G^* > G_{\\max}$, the gain will be driven towards a value it can never reach. The gain will increase until it hits the upper boundary $G_{\\max}$ and remains there. At $G(t) = G_{\\max}$, the derivative is $\\frac{dG}{dt} = k(I_0 - G_{\\max} I_{\\mathrm{post}})$. Since $I_0/I_{\\mathrm{post}} > G_{\\max}$, it follows that $I_0 > G_{\\max} I_{\\mathrm{post}}$, and thus $\\frac{dG}{dt} > 0$. This positive derivative indicates that the gain is being pushed against the ceiling $G_{\\max}$, confirming that $G_{\\mathrm{ss}} = G_{\\max}$.\n\nCombining these two conditions, the steady-state gain for $I_{\\mathrm{post}} > 0$ is:\n$$\nG_{\\mathrm{ss}} = \\min\\left(\\frac{I_0}{I_{\\mathrm{post}}}, G_{\\max}\\right)\n$$\n\n**Case 2: $I_{\\mathrm{post}} = 0$**\n\nIf the post-lesion external input is zero (representing complete auditory deafferentation), the ODE for the gain becomes:\n$$\n\\frac{dG}{dt} = k(I_0 - G(t) \\cdot 0) = k I_0\n$$\nAssuming a non-zero homeostatic target ($I_0 > 0$), the derivative $\\frac{dG}{dt}$ is a positive constant. This means the gain $G(t)$ will increase linearly and without bound: $G(t) = G(0) + kI_0 t$. Such a system has no a finite fixed point.\n\nHowever, with the saturation constraint $G(t) \\le G_{\\max}$, the gain will increase until it reaches the maximum allowed value, $G_{\\max}$. Once $G(t) = G_{\\max}$, it cannot increase further. The system will thus settle at this upper boundary. Therefore, for $I_{\\mathrm{post}} = 0$:\n$$\nG_{\\mathrm{ss}} = G_{\\max}\n$$\nThis case models the physiological hypothesis that in the absence of auditory input, the central auditory system compensates by increasing its gain to the maximum possible level.\n\nThe parameters $k$, $I_{\\mathrm{pre}}$, and $G_0$ define the initial state and the transient dynamics (i.e., the path and speed of convergence to the steady state), but they do not influence the final steady-state value $G_{\\mathrm{ss}}$ itself.\n\n**Tinnitus Emergence Criterion**\n\nWith the steady-state gain $G_{\\mathrm{ss}}$ determined, the emergence of tinnitus is evaluated by the given operational criterion. Tinnitus is deemed to emerge if the internally generated noise, amplified by the steady-state gain, surpasses a detection threshold $T$. Mathematically, tinnitus emerges if:\n$$\nG_{\\mathrm{ss}} \\cdot N \\ge T\n$$\nwhere $N$ is the internal noise amplitude. This condition is evaluated to a boolean value, represented as $1$ for true and $0$ for false.\n\nThe algorithm to be implemented will first calculate $G_{\\mathrm{ss}}$ using the logic derived above and then apply this inequality to determine the tinnitus emergence flag.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes steady-state gain and tinnitus emergence for a homeostatic model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (k, I_0, I_pre, I_post, G_0, G_max, N, T)\n    test_cases = [\n        (0.5, 1.0, 1.0, 0.5, 1.0, 10.0, 0.08, 0.06),\n        (0.3, 1.0, 1.0, 0.8, 0.9, 10.0, 0.08, 0.10),\n        (0.4, 1.0, 1.0, 0.05, 1.0, 8.0, 0.01, 0.12),\n        (1.0, 1.0, 1.0, 1.0, 1.0, 10.0, 0.04, 0.05),\n        (0.5, 1.0, 1.0, 0.0, 1.0, 8.0, 0.02, 0.12),\n    ]\n\n    all_results_str = []\n    \n    for case in test_cases:\n        # Unpack parameters. Note that k, I_pre, and G_0 are not needed\n        # for the steady-state calculation, only for transient dynamics.\n        _k, I_0, _I_pre, I_post, _G_0, G_max, N, T = case\n\n        g_ss = 0.0\n\n        if I_post  0:\n            # Case 1: External input is positive.\n            # The unconstrained steady-state gain is I_0 / I_post.\n            g_ss_unconstrained = I_0 / I_post\n            # The actual steady-state gain is capped by the saturation limit G_max.\n            g_ss = min(g_ss_unconstrained, G_max)\n        else: # I_post == 0\n            # Case 2: No external input.\n            # The gain increases until it saturates at the maximum value.\n            g_ss = G_max\n            \n        # Evaluate the tinnitus emergence criterion.\n        # Use the full-precision g_ss for the comparison.\n        # Condition: G_ss * N = T\n        tinnitus_emerges = 1 if g_ss * N = T else 0\n\n        # Format the result for this case as specified: [G_ss (6dp), boolean_int]\n        # The g_ss value is rounded for display only.\n        result_str = f\"[{g_ss:.6f},{tinnitus_emerges}]\"\n        all_results_str.append(result_str)\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After exploring a theoretical model of tinnitus generation, the next step is to quantify the clinical phenomenon itself. This practice  focuses on a foundational psychoacoustic procedure: tinnitus loudness matching. By working through this calculation, you will learn to translate a patient's report into a standard clinical metric, applying the crucial concepts of decibels Hearing Level ($L_\\text{HL}$) and decibels Sensation Level ($L_\\text{SL}$) to determine the perceived intensity of their tinnitus.",
            "id": "5078349",
            "problem": "A patient with chronic tonal tinnitus undergoes psychoacoustic loudness matching during audiologic evaluation. The loudness match is performed at the patient’s pitch-matched frequency of $6\\,\\mathrm{kHz}$. The audiogram shows an absolute threshold at $6\\,\\mathrm{kHz}$ of $20\\,\\mathrm{dB\\ HL}$ (decibels hearing level), where $0\\,\\mathrm{dB\\ HL}$ denotes the average normal-hearing threshold for that frequency. In the loudness matching task, a pure tone at $6\\,\\mathrm{kHz}$ is adjusted until the patient reports that its perceived loudness equals the tinnitus loudness. At equality, the matched tone intensity is $12\\,\\mathrm{dB\\ SL}$ (decibels sensation level) above the patient’s threshold at $6\\,\\mathrm{kHz}$.\n\nUsing only fundamental definitions that relate decibels sensation level and decibels hearing level at a given frequency—namely, that decibels sensation level at frequency $f$ is the difference between the stimulus level in decibels hearing level and the individual’s threshold in decibels hearing level at that frequency—derive, from first principles, the expression for the matched tone level in decibels hearing level in terms of the threshold and the sensation level. Then compute the tinnitus loudness as the matched tone level in decibels hearing level for this patient.\n\nAssume standard clinical audiometric referencing where $0\\,\\mathrm{dB\\ HL}$ corresponds to the average normal-hearing threshold at each frequency, and neglect spread of excitation or loudness recruitment effects for the purpose of this computation. Express your final answer in decibels hearing level ($\\mathrm{dB\\ HL}$). No rounding is necessary.",
            "solution": "The problem requires the derivation of an expression for a stimulus level in decibels hearing level ($\\mathrm{dB\\ HL}$) and its subsequent calculation for a specific clinical case of tinnitus evaluation. The derivation must originate from the fundamental definitions provided in the problem statement.\n\nFirst, we must formalize the relationship between the different decibel scales as stated. The problem defines decibels sensation level ($\\mathrm{dB\\ SL}$) at a given frequency, $f$, as \"the difference between the stimulus level in decibels hearing level and the individual’s threshold in decibels hearing level at that frequency.\"\n\nLet us denote the relevant quantities with symbols:\n- $L_{SL}$ represents the level of the stimulus in decibels sensation level.\n- $L_{HL}$ represents the level of the stimulus in decibels hearing level.\n- $T_{HL}$ represents the individual's hearing threshold in decibels hearing level.\n\nThe provided definition can be translated directly into a mathematical equation:\n$$L_{SL} = L_{HL} - T_{HL}$$\n\nThe first part of the task is to derive the expression for the matched tone level in decibels hearing level, which is $L_{HL}$, in terms of the threshold, $T_{HL}$, and the sensation level, $L_{SL}$. To achieve this, we perform a simple algebraic rearrangement of the equation above to isolate the term $L_{HL}$:\n$$L_{HL} = L_{SL} + T_{HL}$$\nThis is the required expression derived from the first principle as stated in the problem. It demonstrates that the stimulus level in $\\mathrm{dB\\ HL}$ is the arithmetic sum of the individual's hearing threshold in $\\mathrm{dB\\ HL}$ and the stimulus level in $\\mathrm{dB\\ SL}$ relative to that threshold.\n\nThe second part of the task is to compute the tinnitus loudness for the patient. The problem specifies that the tinnitus loudness is considered equal to the level of the psychoacoustically matched pure tone. We are given the following values for the patient at the pitch-matched frequency of $f = 6\\,\\mathrm{kHz}$:\n- The patient's absolute hearing threshold at this frequency: $T_{HL} = 20\\,\\mathrm{dB\\ HL}$.\n- The intensity of the tone that matches the tinnitus loudness, expressed in sensation level: $L_{SL} = 12\\,\\mathrm{dB\\ SL}$.\n\nWe can now substitute these numerical values into our derived expression for $L_{HL}$ to find the matched tone level, which represents the tinnitus loudness:\n$$L_{HL} = 12\\,\\mathrm{dB\\ SL} + 20\\,\\mathrm{dB\\ HL}$$\n\nPerforming the addition yields the result:\n$$L_{HL} = 32\\,\\mathrm{dB\\ HL}$$\n\nThus, the tinnitus loudness, as quantified by the matched tone level, is $32\\,\\mathrm{dB\\ HL}$. This calculation is a direct application of audiometric definitions under the specified simplifying assumption that loudness recruitment and other complex psychoacoustic phenomena are to be ignored.",
            "answer": "$$\\boxed{32}$$"
        },
        {
            "introduction": "A critical role for the clinician is to determine when tinnitus may signal a serious underlying condition. This exercise  places you in a common diagnostic scenario: evaluating the risk of vestibular schwannoma in a patient with unilateral tinnitus who receives an MRI. By applying Bayes’ theorem, you will learn to calculate the true post-test probability of the disease, demonstrating how to integrate pre-test prevalence with test sensitivity and specificity to make an evidence-based clinical judgment.",
            "id": "5078460",
            "problem": "A patient presents to an advanced otology clinic with unilateral, nonpulsatile tinnitus of $8$ months duration, normal otoscopy, and no focal neurological deficits. For this referral cohort, the pretest prevalence of vestibular schwannoma is $p = 0.015$. An abbreviated screening Magnetic Resonance Imaging (MRI) protocol of the internal auditory canal and cerebellopontine angle is used. The MRI protocol’s sensitivity is $Se = 0.95$ for detecting vestibular schwannoma and its specificity is $Sp = 0.98$ for ruling out vestibular schwannoma.\n\nStarting from the fundamental definitions of sensitivity and specificity and applying the law of total probability and Bayes’ theorem, derive the general expression for the posterior probability of vestibular schwannoma conditional on a positive MRI result. Then, using the given values of $p$, $Se$, and $Sp$, compute the patient’s post-test probability of vestibular schwannoma given a positive MRI result. Express your final answer as a decimal and round to four significant figures.",
            "solution": "The problem requires the derivation of the general expression for the posterior probability of a disease given a positive test result, and then the calculation of this probability for a specific case. This is a classic application of Bayes' theorem in the context of medical diagnostics.\n\nFirst, we perform the problem validation.\n\n**Step 1: Extract Givens**\n- Pretest prevalence of vestibular schwannoma: $p = 0.015$.\n- Sensitivity of the MRI protocol: $Se = 0.95$.\n- Specificity of the MRI protocol: $Sp = 0.98$.\n- The patient receives a positive MRI result.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It utilizes fundamental principles of probability theory (Bayes' theorem, law of total probability) and standard epidemiological definitions (prevalence, sensitivity, specificity). The data provided ($p$, $Se$, $Sp$) are self-contained, consistent, and plausible for a specialized clinical scenario. The problem is formalizable and asks for a verifiable quantitative result. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. We proceed with the solution.\n\nLet us define the following events:\n- $D$: The event that the patient has a vestibular schwannoma (the 'disease').\n- $D^c$: The event that the patient does not have a vestibular schwannoma.\n- $T^+$: The event that the MRI result is positive.\n- $T^-$: The event that the MRI result is negative.\n\nFrom the problem statement, we can translate the given information into probabilistic terms:\n1.  The pretest probability, or prevalence, is the probability of having the disease before the test is performed:\n    $$P(D) = p = 0.015$$\n    The probability of not having the disease is therefore:\n    $$P(D^c) = 1 - P(D) = 1 - p$$\n\n2.  Sensitivity is the probability of a positive test result given that the patient has the disease:\n    $$P(T^+ | D) = Se = 0.95$$\n\n3.  Specificity is the probability of a negative test result given that the patient does not have the disease:\n    $$P(T^- | D^c) = Sp = 0.98$$\n\nThe quantity we need to find is the posterior probability of having the disease given a positive test result, which is denoted as $P(D | T^+)$.\n\nWe start with the definition of conditional probability, which rearranges to form Bayes' theorem:\n$$P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\nUsing the multiplication rule for conditional probability, $P(D \\cap T^+) = P(T^+ | D) P(D)$. Substituting this into the numerator gives:\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n\nNext, we must find an expression for the denominator, $P(T^+)$, which is the total probability of a positive test result. We can expand $P(T^+)$ using the law of total probability, considering the two mutually exclusive scenarios in which a positive test can occur: the patient has the disease and tests positive, or the patient does not have the disease and tests positive.\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\nApplying the multiplication rule to each term:\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n\nWe are given $P(T^+ | D) = Se$ and $P(D) = p$. We also have $P(D^c) = 1 - p$. The term $P(T^+ | D^c)$ is the probability of a positive test in a patient without the disease, which is also known as the false positive rate. We can derive this from the specificity, $Sp$. Since a patient without the disease can either test positive or negative, we have:\n$$P(T^+ | D^c) + P(T^- | D^c) = 1$$\nTherefore, the false positive rate is:\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$$\n\nSubstituting all these components back into the expression for $P(T^+)$:\n$$P(T^+) = (Se)(p) + (1 - Sp)(1 - p)$$\n\nNow we can write the final, general expression for the posterior probability $P(D | T^+)$ by substituting the expansion of $P(T^+)$ into the denominator of Bayes' theorem:\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)}$$\n$$P(D | T^+) = \\frac{(Se)(p)}{(Se)(p) + (1 - Sp)(1 - p)}$$\nThis is the required general expression.\n\nNow, we substitute the given numerical values to compute the patient's specific post-test probability:\n- $p = 0.015$\n- $Se = 0.95$\n- $Sp = 0.98$\n\n$$P(D | T^+) = \\frac{(0.95)(0.015)}{(0.95)(0.015) + (1 - 0.98)(1 - 0.015)}$$\n\nFirst, let's calculate the terms:\n- Numerator (True Positives): $(0.95)(0.015) = 0.01425$\n- Denominator Term 1 (True Positives): $(0.95)(0.015) = 0.01425$\n- Denominator Term 2 (False Positives): $(1 - 0.98)(1 - 0.015) = (0.02)(0.985) = 0.0197$\n\nNow, we substitute these values back into the equation:\n$$P(D | T^+) = \\frac{0.01425}{0.01425 + 0.0197} = \\frac{0.01425}{0.03395}$$\n\nPerforming the final division:\n$$P(D | T^+) \\approx 0.419734904...$$\n\nRounding to four significant figures as requested, we get $0.4197$.\n\nThus, for a patient in this cohort with a positive screening MRI, the probability of having a vestibular schwannoma is approximately $41.97\\%$.",
            "answer": "$$\\boxed{0.4197}$$"
        }
    ]
}