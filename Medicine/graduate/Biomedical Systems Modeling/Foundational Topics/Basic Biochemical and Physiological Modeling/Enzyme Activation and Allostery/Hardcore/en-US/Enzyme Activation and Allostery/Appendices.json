{
    "hands_on_practices": [
        {
            "introduction": "This practice centers on the Monod-Wyman-Changeux (MWC) model, a cornerstone of allostery theory, exploring its behavior under the specific limiting condition of low substrate concentration. This exercise is valuable as it demonstrates a key skill in systems modeling: approximating complex systems with simpler, more familiar forms like the Michaelis-Menten equation. By deriving an effective Michaelis constant, $K_{m}^{\\mathrm{eff}}$, you will gain an intuitive understanding of how underlying allosteric parameters shape enzyme behavior in physiologically relevant regimes .",
            "id": "3884071",
            "problem": "An oligomeric allosteric enzyme is modeled using the Monod–Wyman–Changeux (MWC) framework, in which each catalytic site can exist in a relaxed state $R$ or a tense state $T$. In the absence of substrate, the conformational equilibrium is characterized by the dimensionless constant $L$, defined as $L = [T]/[R]$. Substrate $S$ binds to $R$ with dissociation constant $K_{R}$ and to $T$ with dissociation constant $K_{T}$, and only the $R$-bound enzyme turns over product with catalytic rate constant $k_{\\mathrm{cat}}^{R}$, while $T$-bound enzyme is catalytically negligible, $k_{\\mathrm{cat}}^{T} \\approx 0$. Assume rapid equilibrium in conformational exchange and substrate binding compared to catalysis, and let $E_{\\mathrm{tot}}$ denote the total concentration of catalytic sites (not enzyme molecules).\n\nStarting from mass-action binding and the MWC conformational ensemble, derive the low-$[S]$ expansion of the initial rate $v([S])$ to first order in $[S]$. From this expansion, determine the conditions under which the Hill coefficient $n_{H}$ evaluated at low $[S]$ satisfies $n_{H} \\approx 1$ (i.e., quasi-Michaelis behavior). Under those conditions, linearize the Michaelis–Menten form $v([S]) = V_{\\max}[S]/(K_{m}^{\\mathrm{eff}} + [S])$ around $[S] = 0$, with $V_{\\max} = k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}$ (assume saturating substrate converts all enzyme to $R$ and saturates binding), and match the linear term to the low-$[S]$ expansion to recover an analytic expression for the effective Michaelis constant $K_{m}^{\\mathrm{eff}}$ in terms of $L$, $K_{R}$, and any relevant parameters of the model.\n\nProvide the final answer as a single closed-form analytic expression for $K_{m}^{\\mathrm{eff}}$ (no units are required). The problem does not require numerical evaluation or rounding.",
            "solution": "The problem asks for the derivation of an effective Michaelis constant, $K_{m}^{\\mathrm{eff}}$, for an allosteric enzyme described by the Monod–Wyman–Changeux (MWC) model in the limit of low substrate concentration. The derivation requires a comparison between the low-substrate expansion of the MWC rate equation and the linearized form of a Michaelis–Menten equation.\n\nFirst, we state the initial rate equation, $v$, for the MWC model. The enzyme is an oligomer of $n$ identical protomers, each with a catalytic site. The entire enzyme molecule exists in one of two conformations: a relaxed, catalytically active state ($R$) or a tense, inactive state ($T$). The initial rate $v$ is proportional to the concentration of substrate-bound active sites, which are exclusively on enzyme molecules in the $R$ state.\n\nLet $[S]$ be the substrate concentration. We define the normalized substrate concentration $\\alpha = [S]/K_{R}$, where $K_{R}$ is the substrate dissociation constant for the $R$ state. The ratio of dissociation constants is $c = K_{R}/K_{T}$, where $K_{T}$ is the substrate dissociation constant for the $T$ state. The allosteric constant $L$ is the equilibrium ratio of the two states in the absence of any ligand, $L = [T_0]/[R_0]$.\n\nThe rate of product formation $v$ is given by $k_{\\mathrm{cat}}^{R}$ multiplied by the total concentration of substrate-bound $R$-state sites. This concentration can be derived from the MWC partition function. The resulting rate equation is:\n$$\nv([S]) = k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}} \\frac{\\alpha(1+\\alpha)^{n-1}}{(1+\\alpha)^n + L(1+c\\alpha)^n}\n$$\nwhere $E_{\\mathrm{tot}}$ is the total concentration of catalytic sites and $n$ is the number of protomers in the oligomer.\n\nThe first step is to derive the low-$[S]$ expansion of this rate equation to first order in $[S]$. This corresponds to the limit where $\\alpha \\to 0$. We perform a Taylor expansion of the numerator and denominator for small $\\alpha$:\nNumerator:\n$$\n\\alpha(1+\\alpha)^{n-1} = \\alpha(1 + (n-1)\\alpha + O(\\alpha^2)) = \\alpha + O(\\alpha^2)\n$$\nDenominator:\n$$\n(1+\\alpha)^n + L(1+c\\alpha)^n = (1 + n\\alpha + O(\\alpha^2)) + L(1 + nc\\alpha + O(\\alpha^2)) = (1+L) + n(1+Lc)\\alpha + O(\\alpha^2)\n$$\nSubstituting these expansions into the rate equation gives:\n$$\nv([S]) = k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}} \\frac{\\alpha + O(\\alpha^2)}{(1+L) + n(1+Lc)\\alpha + O(\\alpha^2)}\n$$\nTo find the first-order term, we take the leading term from the numerator and the constant term from the denominator:\n$$\nv([S]) \\approx k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}} \\frac{\\alpha}{1+L}\n$$\nSubstituting back $\\alpha = [S]/K_{R}$, we obtain the linear approximation for the initial rate at low substrate concentrations:\n$$\nv([S]) \\approx \\left(\\frac{k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}}{(1+L)K_{R}}\\right) [S]\n$$\n\nThe second step is to determine the conditions under which the Hill coefficient, $n_{H}$, is approximately $1$ at low $[S]$. The Hill coefficient is generally defined as $n_{H} = \\frac{d(\\ln v)}{d(\\ln [S])} = \\frac{[S]}{v} \\frac{dv}{d[S]}$. Using our linear approximation $v([S]) \\approx A[S]$, where $A$ is a constant, we can evaluate $n_{H}$ in the limit $[S] \\to 0$:\n$$\nn_{H} \\to \\lim_{[S]\\to 0} \\frac{[S]}{A[S]} \\frac{d}{d[S]}(A[S]) = \\lim_{[S]\\to 0} \\frac{1}{A} (A) = 1\n$$\nThis demonstrates that for any MWC system, the Hill coefficient approaches $1$ as the substrate concentration approaches zero. Therefore, the condition for \"quasi-Michaelis behavior\" ($n_{H} \\approx 1$) is met in the low-$[S]$ regime for any valid set of MWC parameters ($L$, $c$, $n$). No further specific conditions are required for the subsequent steps.\n\nThe third step is to linearize the Michaelis–Menten (MM) form provided in the problem statement around $[S] = 0$. The given form is:\n$$\nv([S]) = \\frac{V_{\\max}[S]}{K_{m}^{\\mathrm{eff}} + [S]}\n$$\nwith the maximum velocity defined as $V_{\\max} = k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}$. For low $[S]$ (i.e., $[S] \\ll K_{m}^{\\mathrm{eff}}$), the denominator can be approximated as $K_{m}^{\\mathrm{eff}} + [S] \\approx K_{m}^{\\mathrm{eff}}$. The linearized MM equation is thus:\n$$\nv([S]) \\approx \\frac{V_{\\max}}{K_{m}^{\\mathrm{eff}}} [S]\n$$\nSubstituting the given expression for $V_{\\max}$:\n$$\nv([S]) \\approx \\frac{k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}}{K_{m}^{\\mathrm{eff}}} [S]\n$$\n\nFinally, we match the linear term derived from the MWC model to the linear term from the effective MM model. By equating the coefficients of $[S]$ from both expansions, we can solve for $K_{m}^{\\mathrm{eff}}$.\n$$\n\\frac{k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}}{(1+L)K_{R}} = \\frac{k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}}{K_{m}^{\\mathrm{eff}}}\n$$\nThe term $k_{\\mathrm{cat}}^{R} E_{\\mathrm{tot}}$ cancels from both sides, leaving:\n$$\n\\frac{1}{(1+L)K_{R}} = \\frac{1}{K_{m}^{\\mathrm{eff}}}\n$$\nSolving for $K_{m}^{\\mathrm{eff}}$ yields the final expression:\n$$\nK_{m}^{\\mathrm{eff}} = (1+L)K_{R}\n$$\nThis result indicates that the effective Michaelis constant at low substrate concentrations is the intrinsic dissociation constant for the R state, $K_R$, scaled up by a factor of $(1+L)$. This factor accounts for the population of enzymes residing in the inactive T-state, which must be overcome by the T-to-R equilibrium shift to achieve a given rate. Notably, this effective constant is independent of the number of subunits $n$ and the binding affinity to the T-state $K_T$, as these parameters only influence higher-order terms in the substrate concentration.",
            "answer": "$$\n\\boxed{(1+L)K_{R}}\n$$"
        },
        {
            "introduction": "Moving from mechanistic descriptions to phenomenological ones, this practice challenges you to derive the celebrated Hill equation from a set of empirical observations. Rather than starting with a physical model of binding sites and conformations, you will construct the equation from abstract properties like symmetry and scale invariance. This exercise provides a deeper appreciation for the Hill equation as a powerful, albeit empirical, tool and sharpens your ability to distinguish between models that describe *what* happens and those that explain *how* it happens .",
            "id": "3884108",
            "problem": "Consider a ligand-activated allosteric enzyme with a single observable output that increases monotonically with the free ligand concentration $[L]$ and saturates at a maximum value when $[L]$ is very large. Let the fractional activation (also called fractional occupancy) be denoted by $\\theta([L])$, defined as the probability that the enzyme is in its active state. Assume the following properties, motivated by the empirical features of sigmoidal responses observed in many cooperative binding and activation systems:\n\n1. Scale invariance of the shape with respect to a characteristic concentration $K$: there exists a dimensionless function $f$ such that $\\theta([L]) = f([L]/K)$, with $K$ defined by the half-activation condition $\\theta(K) = \\tfrac{1}{2}$. The quantities $[L]$ and $K$ are both to be expressed in molarity (M).\n\n2. Proper asymptotic limits consistent with mass-action activation: \n   $$\\lim_{[L]\\to 0} \\theta([L]) = 0, \\quad \\lim_{[L]\\to \\infty} \\theta([L]) = 1.$$\n\n3. Symmetry around the half-activation point on a logarithmic concentration axis: for all positive $x$, the function satisfies \n   $$f(x) + f\\!\\left(\\frac{1}{x}\\right) = 1,$$\n   which implies that the log-odds $\\ln\\!\\big(\\theta([L])/(1-\\theta([L]))\\big)$ is an odd function of $\\ln([L]/K)$.\n\n4. A constant logarithmic sensitivity of the log-odds with respect to relative changes in ligand concentration over the dynamic range, characterized by a positive constant $n_H$ (the Hill coefficient): the slope of $\\ln\\!\\big(\\theta([L])/(1-\\theta([L]))\\big)$ versus $\\ln([L]/K)$ is independent of $[L]$ and equal to $n_H$ at the half-activation point and, by assumption, everywhere in the dynamic range.\n\nStarting only from these properties and standard definitions of fractional activation and log-odds, derive the unique analytic expression for $\\theta([L])$ consistent with all four properties in terms of $[L]$, $K$, and $n_H$. Express $[L]$ and $K$ in molarity (M). Then, based on first principles from mechanistic allostery, discuss the limitations of this empirical representation as a phenomenological fit, including its relationship to microscopic mass-action models of allostery. The final answer must be the single closed-form expression for $\\theta([L])$; no rounding is required.",
            "solution": "The goal is to derive an expression for $\\theta([L])$ that is consistent with the given properties. We begin by restating the essential mathematical constructs that will be used. The fractional activation $\\theta([L])$ is a dimensionless quantity between $0$ and $1$, interpreted as the probability the enzyme is active at a given ligand concentration $[L]$. The log-odds, also called the logit, is defined by \n$$\\mathrm{logit}(\\theta) = \\ln\\!\\left(\\frac{\\theta}{1-\\theta}\\right).$$\n\nBy property $1$ (scale invariance), $\\theta([L]) = f([L]/K)$ for some function $f$ with $\\theta(K)=\\tfrac{1}{2}$. By property $2$ (proper asymptotics), we have $f(x)\\to 0$ as $x\\to 0$ and $f(x)\\to 1$ as $x\\to \\infty$. By property $3$ (symmetry), for all $x>0$,\n$$f(x) + f\\!\\left(\\frac{1}{x}\\right) = 1.$$\nThis symmetry implies that\n$$\\frac{f(x)}{1-f(x)} = \\left(\\frac{1}{f(1/x)}\\right) - 1 = \\frac{f(x)}{f(1/x)}.$$\nTaking logarithms, the symmetry condition can be recast in terms of the log-odds of $f(x)$:\n$$\\ln\\!\\left(\\frac{f(x)}{1-f(x)}\\right) = -\\,\\ln\\!\\left(\\frac{f(1/x)}{1-f(1/x)}\\right),$$\nwhich shows that the function $g(y) \\equiv \\ln\\!\\left(\\frac{f(\\exp(y))}{1-f(\\exp(y))}\\right)$ is odd in $y$, that is $g(-y) = -g(y)$. In terms of the original variables, this means\n$$\\ln\\!\\left(\\frac{\\theta([L])}{1-\\theta([L])}\\right)$$\nis an odd function of $\\ln([L]/K)$.\n\nBy property $4$ (constant logarithmic sensitivity of the log-odds), we assert that the slope of the log-odds with respect to $\\ln([L]/K)$ is independent of $[L]$ and equal to $n_H$ at the half-activation point $\\theta(K)=\\tfrac{1}{2}$ and, by assumption, everywhere in the dynamic range. Let $y \\equiv \\ln([L]/K)$, and define \n$$g(y) \\equiv \\ln\\!\\left(\\frac{\\theta([L])}{1-\\theta([L])}\\right) = \\ln\\!\\left(\\frac{f(\\exp(y))}{1-f(\\exp(y))}\\right).$$\nProperty $4$ states that\n$$\\frac{d g(y)}{d y} = n_H,$$\nfor all $y$ in the dynamic range. This is a first-order ordinary differential equation with constant slope. Integrating with respect to $y$ yields\n$$g(y) = n_H\\,y + C,$$\nwhere $C$ is an integration constant. Property $3$ states that $g(y)$ is an odd function, which implies $g(0)=0$. Evaluating at $y=0$ (which corresponds to $[L]=K$ and $\\theta=\\tfrac{1}{2}$), we find $g(0) = \\ln\\!\\left(\\frac{1/2}{1-1/2}\\right) = \\ln(1) = 0$, hence $C=0$. Therefore,\n$$\\ln\\!\\left(\\frac{\\theta([L])}{1-\\theta([L])}\\right) = n_H \\,\\ln\\!\\left(\\frac{[L]}{K}\\right).$$\n\nExponentiating both sides gives\n$$\\frac{\\theta([L])}{1-\\theta([L])} = \\left(\\frac{[L]}{K}\\right)^{n_H}.$$\nSolving for $\\theta([L])$,\n$$\\theta([L]) = \\frac{\\left(\\frac{[L]}{K}\\right)^{n_H}}{1+\\left(\\frac{[L]}{K}\\right)^{n_H}} = \\frac{[L]^{n_H}}{K^{n_H} + [L]^{n_H}}.$$\nThis expression satisfies the scale invariance with respect to $K$, yields $\\theta(K)=\\tfrac{1}{2}$, and obeys the asymptotics: as $[L]\\to 0$, the numerator is negligible relative to the denominator, giving $\\theta\\to 0$; as $[L]\\to \\infty$, the denominator is dominated by $[L]^{n_H}$, giving $\\theta\\to 1$. Moreover, the symmetry $f(x)+f(1/x)=1$ is satisfied because\n$$\\frac{x^{n_H}}{1+x^{n_H}} + \\frac{(1/x)^{n_H}}{1+(1/x)^{n_H}} = \\frac{x^{n_H}}{1+x^{n_H}} + \\frac{1}{1+x^{n_H}} = 1.$$\n\nThus, under the stated assumptions, the unique analytic expression consistent with all four properties is\n$$\\theta([L]) = \\frac{[L]^{n_H}}{K^{n_H} + [L]^{n_H}},$$\nwith $[L]$ and $K$ expressed in molarity (M), and $\\theta$ dimensionless.\n\nLimitations as a phenomenological fit and relationship to mechanistic allostery:\n\n- Microscopic interpretability of $n_H$: The parameter $n_H$ is defined here as the constant slope of the log-odds versus $\\ln([L]/K)$ over the dynamic range. In real allosteric systems derived from microscopic mass-action models, such as the Monod–Wyman–Changeux (MWC) model or the Koshland–Némethy–Filmer (KNF) model, the slope generally varies with $[L]$. The Hill coefficient equals the slope at half-activation, but it does not generally equal the number of binding sites, nor remain constant across $[L]$. Therefore, $n_H$ is a phenomenological parameter that captures apparent cooperativity but cannot be uniquely mapped to a specific mechanism or site count.\n\n- Thermodynamic consistency and microstate resolution: The Hill form lumps multi-state binding and conformational equilibria into a single effective isotherm. It does not encode the binding polynomial that arises from enumerating microstates consistent with microscopic reversibility and detailed balance. As a result, the Hill isotherm may violate constraints that would be imposed by thermodynamic linkage and multi-ligand coupling in heterotropic allostery, and it cannot predict subtleties such as sequential binding steps, negative cooperativity, or state-dependent affinity changes except through an average slope.\n\n- Modulator and effector actions: In mechanistic models, an allosteric modulator changes specific equilibrium constants (e.g., conformational energies or site affinities). The Hill equation can mimic a left- or right-shift (effective change in $K$) and an apparent slope change (effective change in $n_H$), but it cannot disentangle whether changes arise from altered conformational equilibria, altered site affinities, or changes in the number of active sites. Consequently, it has limited predictive power for mutation effects and effector-specific perturbations.\n\n- Ligand depletion and finite receptor concentration: The Hill form assumes $[L]$ is effectively constant (bath approximation). In cellular contexts where ligand is not in large excess, binding depletes free ligand, and the correct isotherm involves conservation constraints. The Hill form does not incorporate these constraints and may misestimate activation in regimes of comparable ligand and receptor concentrations.\n\n- Global slope constancy: The derivation assumed a constant slope of the log-odds with respect to $\\ln([L]/K)$. Real cooperative systems often exhibit nonconstant log-sensitivity; for example, steepness may be maximal near half-activation and shallower in the tails. The Hill form therefore may over- or under-estimate sensitivity away from midrange concentrations and can misrepresent noise filtering and ultrasensitivity in systems models.\n\nIn summary, the derived expression is a compact, scale-invariant sigmoid that captures an average cooperativity via $n_H$, but it is phenomenological and may not conform to microscopic mass-action constraints or provide mechanistic insight into allosteric regulation. It should be used with caution when mechanistic interpretation or predictive modeling of perturbations is required.",
            "answer": "$$\\boxed{\\frac{[L]^{n_H}}{K^{n_H} + [L]^{n_H}}}$$"
        },
        {
            "introduction": "This final practice bridges the gap between the static analysis of enzyme kinetics and the dynamic behavior of biological systems. You will embed an MWC allosteric enzyme within a positive feedback loop and use computational bifurcation analysis to explore the emergent properties of the network. By mapping regions of bistability and simulating hysteresis, you will gain hands-on experience with how the molecular property of allostery can generate complex, switch-like behaviors at the systems level .",
            "id": "3884074",
            "problem": "Consider an enzyme that can exist in two conformational states, a relaxed state $R$ and a tense state $T$, following the Monod–Wyman–Changeux (MWC) model of allostery. Let $x$ denote the dimensionless concentration of an allosteric activator (scaled by the relaxed-state dissociation constant), and suppose the enzyme produces this activator, thereby creating positive feedback. The fraction of enzyme in the $R$ state, denoted $f_R(x)$, is given by a standard MWC occupancy formula based on mass-action binding, where $L$ is the allosteric constant ($T/R$ ratio in the absence of ligand), $m$ is the number of identical binding sites per enzyme, and $K_R$ and $K_T$ are the dissociation constants of the activator for the $R$ and $T$ states, respectively. Assume $K_T \\gg K_R$ to model an activator that preferentially stabilizes the $R$ state.\n\nLet the production-degradation dynamics of the activator be modeled by the ordinary differential equation (ODE)\n$$\n\\frac{dx}{dt} = k_b + k_p\\, f_R(x; L, m, K_R, K_T) - k_d\\, x,\n$$\nwhere $k_b \\ge 0$ is a basal production rate (dimensionless), $k_p \\ge 0$ is the maximal activation-induced production rate (dimensionless), and $k_d > 0$ is a first-order degradation rate (dimensionless). The system exhibits steady states at values $x^\\ast$ satisfying\n$$\n0 = k_b + k_p\\, f_R(x^\\ast; L, m, K_R, K_T) - k_d\\, x^\\ast.\n$$\nA steady state $x^\\ast$ is locally stable if the Jacobian (the derivative of the right-hand side with respect to $x$) evaluated at $x^\\ast$ is negative:\n$$\nJ(x^\\ast) = k_p\\, \\frac{df_R}{dx}(x^\\ast; L, m, K_R, K_T) - k_d  0.\n$$\n\nTasks:\n1. Starting from the Monod–Wyman–Changeux (MWC) model assumptions and mass-action binding, derive a computational expression for $f_R(x; L, m, K_R, K_T)$ and its derivative $\\frac{df_R}{dx}(x; L, m, K_R, K_T)$ as functions of $x$.\n2. Using these expressions and the ODE above, implement a numerical bifurcation analysis for given parameter sets. Specifically:\n   - Compute all real nonnegative steady states $x^\\ast$ for a given parameter set and classify their stability using $J(x^\\ast)$.\n   - Determine whether the system is bistable (two distinct stable steady states separated by an unstable steady state) for that parameter set.\n3. Map regions of bistability by scanning a small grid in the $(k_p, k_d)$ parameter plane for fixed $(L, m, K_R, K_T, k_b)$. Return the count of grid points that are bistable.\n4. Illustrate hysteresis by performing a parameter sweep in $k_p$:\n   - Conduct a forward sweep: increase $k_p$ from a low value to a high value stepwise, selecting the stable steady state at each step by continuity (choose the stable equilibrium closest to the previous step’s equilibrium). Record the first $k_p$ value at which the tracked stable branch disappears (jump to the other branch).\n   - Conduct a backward sweep: decrease $k_p$ from a high value to a low value stepwise, similarly tracking the stable branch and recording the jump $k_p$.\n   - Compute the hysteresis width as the difference between the backward-sweep jump and the forward-sweep jump in $k_p$. If no jumps occur in either sweep, define the hysteresis width as $0$.\nAll variables are dimensionless due to scaling; no physical units are involved. Use robust numerical root bracketing on a finite domain $x \\in [0, x_{\\max}]$ with $x_{\\max}$ chosen large enough to include all intersections. If $k_b + k_p \\le 0$, treat the system as having no production beyond basal and handle accordingly. Ensure nonnegativity of $x$ throughout.\n\nTest suite:\nProvide three parameter sets to test different facets:\n- Case A (happy path, monostable): $(L, m, K_R, K_T, k_b) = (10, 3, 1.0, 10.0, 0.01)$; scan $(k_p, k_d)$ on a $3 \\times 3$ grid with $k_p \\in \\{0.2, 0.4, 0.6\\}$ and $k_d \\in \\{0.8, 1.0, 1.2\\}$; perform hysteresis sweep in $k_p$ from $0.0$ to $2.0$ with step $0.02$.\n- Case B (bistable region expected): $(L, m, K_R, K_T, k_b) = (200, 4, 1.0, 50.0, 0.01)$; scan $(k_p, k_d)$ on a $5 \\times 5$ grid with $k_p \\in \\{0.5, 0.75, 1.0, 1.25, 1.5\\}$ and $k_d \\in \\{0.10, 0.175, 0.25, 0.325, 0.40\\}$; perform hysteresis sweep in $k_p$ from $0.0$ to $2.0$ with step $0.02$.\n- Case C (near boundary, sensitive): $(L, m, K_R, K_T, k_b) = (80, 4, 1.0, 30.0, 0.01)$; scan $(k_p, k_d)$ on a $4 \\times 4$ grid with $k_p \\in \\{0.6, 0.8, 1.0, 1.2\\}$ and $k_d \\in \\{0.20, 0.23, 0.26, 0.29\\}$; perform hysteresis sweep in $k_p$ from $0.0$ to $2.0$ with step $0.02$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each of the three cases, output a two-element list $[B, H]$ where $B$ is the integer count of bistable grid points found in the $(k_p, k_d)$ scan and $H$ is the hysteresis width (a float in dimensionless units) computed from the $k_p$ sweep. The final output must be of the form:\n$$\n[[B_A, H_A],[B_B, H_B],[B_C, H_C]]\n$$\nwith no additional text.",
            "solution": "We start from the Monod–Wyman–Changeux (MWC) model for allosteric regulation. The enzyme has two conformational states, relaxed $R$ and tense $T$, with an allosteric constant $L$ equal to the ratio of $T$ to $R$ in the absence of ligand. An allosteric activator binds to both $R$ and $T$ with dissociation constants $K_R$ and $K_T$, respectively, across $m$ identical binding sites. Under rapid equilibrium and mass-action binding, the statistical weights of ligand occupancy for each state are\n$$\nA_R(x) = \\left(1 + \\frac{x}{K_R}\\right)^m,\\quad A_T(x) = \\left(1 + \\frac{x}{K_T}\\right)^m,\n$$\nand their ratio is\n$$\nR(x) = \\frac{A_T(x)}{A_R(x)} = \\left(\\frac{1 + x/K_T}{1 + x/K_R}\\right)^m.\n$$\nThe fraction of enzyme molecules in the $R$ state is the conditional probability\n$$\nf_R(x; L, m, K_R, K_T) = \\frac{1}{1 + L\\, R(x)} = \\frac{1}{1 + L \\left(\\frac{1 + x/K_T}{1 + x/K_R}\\right)^m}.\n$$\nThis is a well-tested formula derived from the MWC framework and mass-action binding equilibria.\n\nTo use the ODE\n$$\n\\frac{dx}{dt} = k_b + k_p\\, f_R(x; L, m, K_R, K_T) - k_d\\, x,\n$$\nwe need the derivative of $f_R(x)$ with respect to $x$ for stability analysis. Differentiate $R(x)$ via the chain rule using\n$$\n\\frac{d}{dx}\\ln R(x) = m\\left(\\frac{1/K_T}{1 + x/K_T} - \\frac{1/K_R}{1 + x/K_R}\\right),\n$$\nso\n$$\n\\frac{dR}{dx} = R(x)\\, m\\left(\\frac{1/K_T}{1 + x/K_T} - \\frac{1/K_R}{1 + x/K_R}\\right).\n$$\nApplying the derivative of $f_R(x) = \\left(1 + L R(x)\\right)^{-1}$ yields\n$$\n\\frac{df_R}{dx}(x; L, m, K_R, K_T) = -\\frac{L\\, \\frac{dR}{dx}}{\\left(1 + L R(x)\\right)^2}\n= -\\frac{L\\, R(x)\\, m\\left(\\frac{1/K_T}{1 + x/K_T} - \\frac{1/K_R}{1 + x/K_R}\\right)}{\\left(1 + L R(x)\\right)^2}.\n$$\nFor an activator with $K_T \\gg K_R$, the term in parentheses is negative, so the overall derivative is positive as expected for an activating ligand.\n\nA steady state $x^\\ast$ satisfies\n$$\nh(x^\\ast) \\equiv k_b + k_p\\, f_R(x^\\ast) - k_d\\, x^\\ast = 0.\n$$\nTo find all nonnegative steady states numerically, we bracket roots of $h(x)$ on a finite domain $x \\in [0, x_{\\max}]$ for a suitably large $x_{\\max}$. Since $f_R(x) \\in (0, 1)$, as $x \\to \\infty$, $h(x) \\sim k_b + k_p - k_d x$, which eventually becomes negative; at $x = 0$, $h(0) = k_b + k_p f_R(0) \\ge 0$ for nonnegative $k_b$ and $k_p$. Therefore, at least one root exists. We sample $h(x)$ on a grid and use robust bracketing (for example, the Brent method) to refine root locations where sign changes occur.\n\nTo classify stability, we compute the Jacobian at each steady state:\n$$\nJ(x^\\ast) = k_p\\, \\frac{df_R}{dx}(x^\\ast) - k_d.\n$$\nIf $J(x^\\ast)  0$, the fixed point is locally stable; if $J(x^\\ast)  0$, it is unstable. In a one-dimensional continuous-time autonomous ODE, local stability follows from the sign of the derivative of the vector field at the fixed point.\n\nBistability occurs when there are three real nonnegative fixed points: two stable equilibria separated by an unstable equilibrium. Using the procedure above, we can determine whether a given parameter pair $(k_p, k_d)$ yields bistability for fixed $(L, m, K_R, K_T, k_b)$. Mapping regions of bistability means scanning a grid in the $(k_p, k_d)$ plane and counting the number of parameter pairs that yield this pattern.\n\nTo illustrate hysteresis from fold (saddle-node) bifurcations, we perform a sweep in the control parameter $k_p$:\n- In a forward sweep increasing $k_p$, we start from a low $k_p$ value, compute all stable steady states, and select the one closest to the previously selected stable state (continuation by proximity). As $k_p$ increases, if the tracked stable branch ceases to exist (a saddle-node annihilates the branch), the system must jump to the other stable branch. We record the $k_p$ value at the jump.\n- In a backward sweep decreasing $k_p$, we similarly track the high-$x$ branch from high $k_p$. When this branch disappears, the system jumps down. We record that jump value.\nThe hysteresis width is the difference between the backward-sweep jump and the forward-sweep jump in $k_p$. If no jumps occur (monostable regime at all $k_p$), the hysteresis width is zero.\n\nAlgorithmic details:\n1. Choose $x_{\\max}$ sufficiently large, for example $x_{\\max} = \\max\\left(5, \\frac{5(k_b + k_p)}{\\max(k_d, \\varepsilon)}\\right)$ with a small $\\varepsilon > 0$ to avoid division by zero. Sample $h(x)$ on a fine grid over $[0, x_{\\max}]$, detect sign changes, and apply a bracketing root-finder to obtain all nonnegative steady states.\n2. Compute $\\frac{df_R}{dx}$ using the analytical expression above, evaluate $J(x^\\ast)$, and classify stability.\n3. For grid mapping, iterate over $(k_p, k_d)$ values, apply steps 1–2, and count bistable cases.\n4. For hysteresis, construct a list of $k_p$ values. For each, find all stable steady states. At each step select the stable root closest to the previously selected root (in Euclidean distance along $x$), detecting a jump when the previously tracked branch disappears and no nearby stable root exists. Record the jump values for increasing and decreasing sweeps, then compute the hysteresis width.\n\nEdge cases are handled by ensuring nonnegativity of $x$, guarding against absence of sign changes by enlarging $x_{\\max}$, and treating cases with only one fixed point as monostable. All quantities are dimensionless due to scaling by the dissociation constants, and the output hysteresis widths are reported in dimensionless units.\n\nThe test suite comprises three parameter sets:\n- Case A focuses on a monostable regime and verifies zero counts of bistability and zero hysteresis width.\n- Case B explores strong positive feedback with likely bistability and nonzero hysteresis width.\n- Case C probes near-boundary sensitivity with potentially small bistability regions and small hysteresis width.\n\nThe program outputs a single line of the form $[[B_A, H_A],[B_B, H_B],[B_C, H_C]]$, where $B_\\cdot$ are integers and $H_\\cdot$ are floats.",
            "answer": "[[0, 0.0], [10, 0.36], [6, 0.1]]"
        }
    ]
}