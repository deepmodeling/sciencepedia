{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践将巩固您对米氏方程和希尔方程之间关系的理解。您将从基本原理出发，证明一个简单的、非协同的酶促反应可以完美地用希尔指数为 $1$ 的希尔方程来描述。这个练习至关重要，它能帮助您认识到希尔方程是一个普适的框架，既包含了非协同系统，也包含了协同系统。",
            "id": "3879836",
            "problem": "要求你从质量作用定律和质量守恒的基本原理出发，证明在准稳态近似（QSSA）下单底物酶促反应可以表示为Hill指数等于$1$的Hill型输入-输出关系。你的推导必须从基本反应方案 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 开始，其中正向结合速率常数为$k_{1}$，反向解离速率常数为$k_{-1}$，催化速率常数为$k_{\\mathrm{cat}}$。设总酶浓度为$E_{\\mathrm{tot}}$，底物浓度为$S$，产物浓度为$P$。假设$S$是缓冲的，因此其值在$ES$形成的时间尺度上有效恒定。只使用质量作用定律、质量守恒以及对中间体$ES$的准稳态近似（QSSA）。\n\n任务：\n1) 仅使用质量作用定律和对中间体复合物的QSSA，推导产物生成速度$v$关于$k_{1}$、$k_{-1}$、$k_{\\mathrm{cat}}$、$E_{\\mathrm{tot}}$和$S$的闭式表达式。同时推导复合物中酶的无量纲分数，定义为占有率$\\theta = [ES]/E_{\\mathrm{tot}}$。\n2) 单独地，对于一个单位点非协同结合系统（即Hill型模型的$n=1$情况），写出与单个结合位点相容的最通用占有率函数，该函数对配体浓度单调，在配体浓度为零时等于$0$，在配体趋于无穷大时趋于$1$。将该函数中的单个参数与第(1)部分中必要的动力学参数组合进行匹配，使得对于所有$S \\ge 0$，归一化反应速度$v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$等于占有率$\\theta$。\n3) 从第(1)部分的结果和你从第(2)部分选择的单位点占有率函数出发，通过显式代数操作证明在第(2)部分中发现的等价性。\n4) 实现一个程序，对于下面的每个测试用例，计算：(i) 从你在第(1)部分的推导中获得的速度，(ii) 在你进行参数识别后，由第(2)部分的$n=1$ Hill型占有率预测的速度，以及 (iii) 这两个速度之间的绝对差。程序必须按照“最终输出格式”的规定，将所有测试用例的输出聚合到最后一行。\n\n科学真实性和单位：\n- 浓度单位必须是摩尔浓度 (mol/L)。\n- 时间单位必须是秒。\n- 速率常数：$k_{1}$的单位为$\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$，$k_{-1}$的单位为$\\mathrm{s}^{-1}$，$k_{\\mathrm{cat}}$的单位为$\\mathrm{s}^{-1}$。\n- 速度$v$必须以小数形式表示，单位为$\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$。\n\n测试套件：\n使用以下参数集。每个测试用例都是一个有序元组$(k_{1}, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, S)$，单位如上所述。\n- 案例 A：($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $1.5 \\times 10^{-4}$)\n- 案例 B：($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $0.0$)\n- 案例 C：($1.0 \\times 10^6$, $100.0$, $50.0$, $2.0 \\times 10^{-6}$, $1.0 \\times 10^{-2}$)\n- 案例 D：($1.0 \\times 10^6$, $100.0$, $0.0$, $5.0 \\times 10^{-6}$, $1.0 \\times 10^{-3}$)\n- 案例 E：($2.0 \\times 10^5$, $20.0$, $200.0$, $5.0 \\times 10^{-7}$, $1.0 \\times 10^{-3}$)\n\n对于每个案例，程序必须计算：\n- 任务1中推导出的速度$v_{\\mathrm{QSSA}}$。\n- 任务2中参数识别后预测的速度$v_{\\mathrm{Hill}, n=1}$。\n- 绝对差$\\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含结果，形式为以逗号分隔的各案例子列表，每个子列表的顺序为$[v_{\\mathrm{QSSA}}, v_{\\mathrm{Hill}, n=1}, \\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert]$。整个输出必须是表示一个列表的列表的单行，不含空格，例如：\"[[x11,x12,x13],[x21,x22,x23],...]\"，其中每个$x_{ij}$都是一个十进制数。所有速度的单位均为$\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$。",
            "solution": "该问题被认为是有效的，因为它在科学上基于化学动力学和生物医学系统建模的原理，是适定的，具有唯一且有意义的解，并且以一套完整且一致的给定条件客观地表述。这些任务涉及Michaelis-Menten方程的标准推导，并将其与Hill方程进行比较，这是生物化学中的一个基本概念。\n\n以下是按要求进行的逐步推导和证明。\n\n单底物酶促反应的基本反应方案如下：\n$$\nE + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_{\\mathrm{cat}}}{\\longrightarrow} E + P\n$$\n其中$E$是酶，$S$是底物，$ES$是酶-底物复合物，$P$是产物。速率常数分别为$k_1$（正向结合）、$k_{-1}$（反向解离）和$k_{\\mathrm{cat}}$（催化）。\n\n该问题要求基于三个核心原理进行推导：\n1.  质量作用定律：反应速率与反应物浓度的乘积成正比。\n2.  质量守恒：酶的总量是恒定的。\n3.  准稳态近似（QSSA）：假设中间体复合物$ES$的浓度在产物形成的时间尺度上是恒定的。\n\n**任务1：产物生成速度 ($v$) 和占有率 ($\\theta$) 的推导**\n\n首先，我们应用质量作用定律来写出酶-底物复合物浓度$[ES]$变化率的微分方程：\n$$\n\\frac{d[ES]}{dt} = (ES \\text{的生成速率}) - (ES \\text{的分解速率})\n$$\n$ES$由$E$和$S$以速率常数$k_1$生成。$ES$的分解则通过以速率常数$k_{-1}$解离回$E$和$S$，或通过以速率常数$k_{\\mathrm{cat}}$催化生成$E$和$P$。这得到：\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\n反应速度$v$定义为产物的生成速率：\n$$\nv = \\frac{d[P]}{dt} = k_{\\mathrm{cat}}[ES]\n$$\n接下来，我们对酶应用质量守恒原理。总酶浓度$E_{\\mathrm{tot}}$是游离酶浓度$[E]$和结合在复合物中的酶浓度$[ES]$之和：\n$$\nE_{\\mathrm{tot}} = [E] + [ES]\n$$\n这使我们能够将游离酶的浓度表示为：\n$$\n[E] = E_{\\mathrm{tot}} - [ES]\n$$\n现在，我们应用准稳态近似（QSSA），该近似假设中间体复合物$[ES]$的浓度变化远慢于底物和产物的浓度变化，因此可以认为其处于稳态，即$\\frac{d[ES]}{dt} \\approx 0$。\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n将质量守恒定律中$[E]$的表达式代入稳态方程，得到：\n$$\nk_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n我们现在求解这个关于$[ES]$的代数方程。展开第一项：\n$$\nk_1 E_{\\mathrm{tot}}[S] - k_1 [ES][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n将所有含$[ES]$的项归到一边：\n$$\nk_1 E_{\\mathrm{tot}}[S] = k_1 [ES][S] + (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\n$$\nk_1 E_{\\mathrm{tot}}[S] = [ES] (k_1 [S] + k_{-1} + k_{\\mathrm{cat}})\n$$\n分离出$[ES]$：\n$$\n[ES] = \\frac{k_1 E_{\\mathrm{tot}}[S]}{k_1 [S] + k_{-1} + k_{\\mathrm{cat}}}\n$$\n为简化，我们将分子和分母同除以$k_1$：\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{[S] + \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}}\n$$\n我们定义Michaelis常数$K_M$为速率常数的特定组合：\n$$\nK_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\n将$K_M$代入$[ES]$的表达式中，得到：\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\n现在我们可以通过将此结果代入速度方程$v = k_{\\mathrm{cat}}[ES]$来推导反应速度$v$的表达式：\n$$\nv = k_{\\mathrm{cat}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\n这就是著名的Michaelis-Menten方程。当酶被底物饱和时（即当$[S] \\to \\infty$时），达到最大速度$v_{\\mathrm{max}}$，此时$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。\n\n最后，我们推导无量纲占有率$\\theta$，其定义为复合物中结合的酶的分数：\n$$\n\\theta = \\frac{[ES]}{E_{\\mathrm{tot}}}\n$$\n代入$[ES]$的表达式：\n$$\n\\theta = \\frac{1}{E_{\\mathrm{tot}}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\n这完成了任务1的推导。\n\n**任务2：单位点占有率函数和参数识别**\n\nHill方程描述了协同结合。对于一个普适的结合位点数$n$，占有率$\\theta$作为配体浓度$[S]$的函数由下式给出：\n$$\n\\theta([S]) = \\frac{[S]^n}{K_d^n + [S]^n}\n$$\n其中$n$是Hill指数，$K_d$是表观解离常数。一个单位点非协同结合系统对应于Hill指数$n=1$。因此，占有率函数为：\n$$\n\\theta([S]) = \\frac{[S]}{K_d + [S]}\n$$\n该函数满足所需性质：\n- 它对$[S]$是单调的。\n- 在配体浓度为零时，$\\theta(0) = 0$。\n- 在高配体浓度下饱和，$\\lim_{[S]\\to\\infty} \\theta([S]) = 1$。\n该模型中的单个参数是解离常数$K_d$。\n\n问题要求我们通过将占有率$\\theta$与归一化反应速度$\\frac{v}{v_{\\mathrm{max}}}$相等来识别此参数$K_d$。从任务1中，我们有$v = \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]}$，其中$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。\n归一化速度为：\n$$\n\\frac{v}{v_{\\mathrm{max}}} = \\frac{1}{v_{\\mathrm{max}}} \\left( \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\n将$n=1$的Hill占有率函数与此归一化速度相等：\n$$\n\\frac{[S]}{K_d + [S]} = \\frac{[S]}{K_M + [S]}\n$$\n为使此等式对所有底物浓度$[S] \\ge 0$成立，分母中的参数必须相等。因此，我们将结合模型中的解离常数$K_d$与动力学模型中的Michaelis常数$K_M$等同起来：\n$$\nK_d = K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\n这一识别表明，Michaelis-Menten动力学模型在数学上是$n=1$时Hill模型的一个特例。\n\n**任务3：等价性证明**\n\n我们被要求通过显式代数操作来证明任务2中发现的等价性。目标是证明从QSSA推导出的归一化反应速度与单位点Hill模型预测的占有率是相同的。\n\n1.  根据任务1中的QSSA推导，反应速度为 $v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}$。\n2.  由单位点Hill模型预测的速度$v_{\\mathrm{Hill}, n=1}$是最大可能速度$v_{\\mathrm{max}}$与$n=1$时的Hill占有率函数$\\theta([S])$的乘积：\n    $$\n    v_{\\mathrm{Hill}, n=1} = v_{\\mathrm{max}} \\cdot \\theta([S])\n    $$\n3.  最大速度为$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。单位点Hill占有率函数为$\\theta([S]) = \\frac{[S]}{K_d + [S]}$。因此：\n    $$\n    v_{\\mathrm{Hill}, n=1} = (k_{\\mathrm{cat}}E_{\\mathrm{tot}}) \\left(\\frac{[S]}{K_d + [S]}\\right)\n    $$\n4.  应用任务2中的参数识别，我们令$K_d = K_M$：\n    $$\n    v_{\\mathrm{Hill}, n=1} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n5.  将此表达式与从QSSA推导出的表达式进行比较：\n    $$\n    v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n    这两个表达式在代数上是完全相同的。因此，我们明确证明了在$K_d = K_M$的识别条件下，$v_{\\mathrm{QSSA}} = v_{\\mathrm{Hill}, n=1}$。这证实了在QSSA下的单底物酶动力学可以由Hill指数为$n=1$的Hill型关系表示。证毕 (Q.E.D.)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes enzyme reaction velocities based on Michaelis-Menten kinetics (derived from QSSA)\n    and a corresponding Hill n=1 model, and calculates the absolute difference.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k1, k_neg1, k_cat, E_tot, S)\n    test_cases = [\n        (1.0e6, 100.0, 50.0, 1.0e-6, 1.5e-4),   # Case A\n        (1.0e6, 100.0, 50.0, 1.0e-6, 0.0),      # Case B\n        (1.0e6, 100.0, 50.0, 2.0e-6, 1.0e-2),   # Case C\n        (1.0e6, 100.0, 0.0, 5.0e-6, 1.0e-3),    # Case D\n        (2.0e5, 20.0, 200.0, 5.0e-7, 1.0e-3)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        k1, k_neg1, k_cat, E_tot, S = case\n\n        # The derivation shows that the underlying mathematical expressions for\n        # v_QSSA and v_Hill_n=1 are identical. The calculation is performed once.\n        \n        # Avoid division by zero if k1 is zero.\n        if k1 == 0:\n            # If k1 is 0, no complex can form, so velocity is 0. K_M would be infinite.\n            # This case is not in the test suite but is good practice.\n            v = 0.0\n        else:\n            # Calculate the Michaelis constant, K_M\n            # K_M has units of concentration (mol/L)\n            K_M = (k_neg1 + k_cat) / k1\n\n            # Calculate the maximum velocity, v_max\n            # v_max has units of mol L^-1 s^-1\n            v_max = k_cat * E_tot\n\n            # Calculate the reaction velocity using the Michaelis-Menten equation\n            # Denominator cannot be zero since S >= 0 and K_M > 0 for non-zero rates.\n            v = v_max * S / (K_M + S)\n\n        v_qssa = v\n        v_hill_n1 = v\n        \n        # Calculate the absolute difference. Due to identical algebraic forms,\n        # this should be 0.0, subject to floating-point precision.\n        abs_diff = np.abs(v_qssa - v_hill_n1)\n\n        results.append([v_qssa, v_hill_n1, abs_diff])\n\n    # Format the final output string as a list of lists with no spaces.\n    # str(results) produces a string like '[[...], [...]]' with spaces.\n    # We remove the spaces to match the required format.\n    final_output_string = str(results).replace(\" \", \"\")\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在理论模型的基础上，本练习将进入数据分析的实践领域。您将推导并实现希尔图，这是一种经典的线性化技术，用于从结合数据中估算希尔系数 ($n$) 和表观解离常数 ($K_d$) 。这项实践对于将理论模型与实验观察联系起来，并量化生物系统中的协同程度至关重要。",
            "id": "3879800",
            "problem": "观察到一个处于等温平衡状态的受体-配体系统，其中受体 $R$ 可以与配体 $L$ 进行协同结合。设分数占据率 $Y \\in (0,1)$，定义为平衡状态下被占据的结合位点的比例。本题的基础是应用于化学平衡的热力学质量作用定律以及分数占据率的定义。仅从此基础出发，推导用于Hill图的线性化方法，该方法捕捉了协同结合模型下 $Y$ 与配体浓度 $[L]$ 之间的关系，并解释如何从此线性化关系中估算Hill系数 $n$ 和表观解离常数 $K_d$。然后，在代码中实现所推导的方法，以分析以下数据集。\n\n您的算法必须：\n- 使用分数占据率 $Y$ 的定义和质量作用平衡来论证一个变换，该变换能产生一个关于 $Y$ 和 $[L]$ 的适当组合的对数（$\\log$）的线性关系，且该关系适用于普通最小二乘法（OLS）估计。此处，普通最小二乘法（OLS）指在线性模型中最小化残差平方和的方法。\n- 除非另有明确说明，否则一律使用自然对数 $\\log$（以 $e$ 为底）。\n- 通过在应用任何对数变换之前，将 $Y$ 裁剪到开放区间 $(\\varepsilon, 1-\\varepsilon)$（其中 $\\varepsilon = 10^{-12}$），来处理当 $Y$ 接近 $0$ 或 $1$ 时出现的数值奇异点。\n- 从所选Hill图坐标中拟合直线的斜率和截距估算Hill系数 $n$ 和表观解离常数 $K_d$。\n- 以摩尔单位 $M$ 报告 $K_d$。\n\n测试套件（每个案例提供以 $M$ 为单位的 $[L]$ 和无量纲的分数占据率 $Y$）：\n- 案例1（基线，近似非协同行为）：$[L] = [\\,10^{-8},\\,5\\times 10^{-8},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,5\\times 10^{-6}\\,]$, $Y = [\\,0.019608,\\,0.090909,\\,0.166667,\\,0.500000,\\,0.666667,\\,0.909091\\,]$。\n- 案例2（正协同性）：$[L] = [\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,2\\times 10^{-6},\\,5\\times 10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.002494,\\,0.058824,\\,0.200000,\\,0.500000,\\,0.862069,\\,0.961538\\,]$。\n- 案例3（负协同性）：$[L] = [\\,10^{-9},\\,10^{-8},\\,10^{-7},\\,10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.030657,\\,0.090909,\\,0.240253,\\,0.500000,\\,0.759141\\,]$。\n- 案例4（极端边界情况）：$[L] = [\\,10^{-9},\\,5\\times 10^{-9},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6}\\,]$, $Y = [\\,0.000001,\\,0.000125,\\,0.500000,\\,0.992063,\\,0.999001\\,]$。\n- 案例5（稀疏采样）：$[L] = [\\,10^{-6},\\,3\\times 10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.161398,\\,0.500000,\\,0.858026\\,]$。\n\n您的程序应该：\n- 根据您为每个案例推导的线性化方法构建Hill图。\n- 在变换后的坐标系中使用OLS拟合一条直线。\n- 按顺序为每个案例返回估算出的Hill系数 $n$ 和以 $M$ 为单位的表观解离常数 $K_d$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该列表必须是扁平化的，即对于案例1，您输出 $n$ 后跟 $K_d$，然后对于案例2，输出 $n$ 后跟 $K_d$，以此类推。例如，格式为 $[\\text{n}_1,\\text{K\\_d}_1,\\text{n}_2,\\text{K\\_d}_2,\\dots]$。",
            "solution": "该问题要求从质量作用定律出发，推导用于Hill图的线性化方法，并解释如何从中估算Hill系数 $n$ 和表观解离常数 $K_d$。该模型的基础是配体 $L$ 与受体 $R$ 的协同结合。\n\n我们首先将 $n$ 个配体分子与一个受体 $R$ 的结合唯象地建模为一个单一的协同步骤：\n$$ R + nL \\rightleftharpoons RL_n $$\n该反应假设受体上的所有 $n$ 个结合位点要么同时为空，要么同时被占据。虽然这是一种简化，但它为协同结合提供了一个有用的宏观描述。\n\n根据质量作用定律，在平衡状态下，宏观结合常数 $K_a$ 由产物浓度与反应物浓度的比值给出：\n$$ K_a = \\frac{[RL_n]}{[R][L]^n} $$\n通常使用宏观解离常数 $K_D$ 更为方便，它是 $K_a$ 的倒数：\n$$ K_D = \\frac{1}{K_a} = \\frac{[R][L]^n}{[RL_n]} $$\n\n分数占据率 $Y$ 定义为被配体占据的总受体结合位点的比例。在这个全或无模型中，被占据位点的浓度由完全结合的复合物浓度 $[RL_n]$ 表示，而总受体位点浓度与总受体浓度 $[R]_{\\text{total}} = [R] + [RL_n]$ 成正比。因此，分数占据率为：\n$$ Y = \\frac{[RL_n]}{[R]_{\\text{total}}} = \\frac{[RL_n]}{[R] + [RL_n]} $$\n\n为了将 $Y$ 表示为配体浓度 $[L]$ 的函数，我们可以重新整理 $K_D$ 的平衡表达式，以求解游离受体浓度 $[R]$：\n$$ [R] = \\frac{K_D [RL_n]}{[L]^n} $$\n将这个 $[R]$ 的表达式代入 $Y$ 的方程中：\n$$ Y = \\frac{[RL_n]}{\\frac{K_D [RL_n]}{[L]^n} + [RL_n]} $$\n我们可以从分子和分母中消去 $[RL_n]$ 项：\n$$ Y = \\frac{1}{\\frac{K_D}{[L]^n} + 1} = \\frac{[L]^n}{K_D + [L]^n} $$\n这个方程是Hill方程的一种形式。常数 $K_D$ 与导致半最大占据率的配体浓度有关。我们精确地将表观解离常数 $K_d$ 定义为这个浓度：即当 $Y=0.5$ 时的 $[L]$ 值。将 $Y=0.5$ 和 $[L]=K_d$ 代入方程中：\n$$ 0.5 = \\frac{K_d^n}{K_D + K_d^n} \\implies 0.5(K_D + K_d^n) = K_d^n \\implies 0.5 K_D = 0.5 K_d^n \\implies K_D = K_d^n $$\n通过将 $K_D = K_d^n$ 代回到我们的 $Y$ 方程中，我们得到了以表观解离常数 $K_d$ 表示的标准Hill方程：\n$$ Y = \\frac{[L]^n}{K_d^n + [L]^n} $$\n在这里，$n$ 是Hill系数，它量化了协同程度（$n>1$ 表示正协同性，$n1$ 表示负协同性，$n=1$ 表示非协同结合），而 $K_d$ 是产生半数占据时的配体浓度。\n\n为了从实验数据 $([L]_i, Y_i)$ 中估算 $n$ 和 $K_d$，我们必须首先对Hill方程进行线性化。我们可以重新整理该方程，以表示已占据位点与未占据位点的比率：\n$$ Y(K_d^n + [L]^n) = [L]^n $$\n$$ Y K_d^n = [L]^n - Y[L]^n = [L]^n(1-Y) $$\n$$ \\frac{Y}{1-Y} = \\frac{[L]^n}{K_d^n} = \\left(\\frac{[L]}{K_d}\\right)^n $$\n术语 $Y/(1-Y)$ 被称为结合几率。对等式两边取自然对数（按题目要求），得到一个线性关系：\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = \\log\\left(\\left(\\frac{[L]}{K_d}\\right)^n\\right) $$\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = n \\log\\left(\\frac{[L]}{K_d}\\right) = n\\log([L]) - n\\log(K_d) $$\n这个方程是直线方程 $y_{\\text{fit}} = m x_{\\text{fit}} + c$ 的形式，这是Hill图的基础。我们可以确定以下分量：\n- 因变量是 $y_{\\text{fit}} = \\log\\left(\\frac{Y}{1-Y}\\right)$。\n- 自变量是 $x_{\\text{fit}} = \\log([L])$。\n- 斜率是 $m = n$。\n- y轴截距是 $c = -n\\log(K_d)$。\n\n给定一组实验数据点 $([L]_i, Y_i)$，我们首先将它们转换为坐标 $(x_{\\text{fit}, i}, y_{\\text{fit}, i}) = (\\log([L]_i), \\log(Y_i/(1-Y_i)))$。一个实际的考虑是，当 $Y$ 的值非常接近 $0$ 或 $1$ 时，项 $\\log(Y/(1-Y))$ 将分别趋近于 $-\\infty$ 或 $+\\infty$。为避免数值不稳定，我们首先将观测到的 $Y$ 值裁剪到一个远离边界的、机器可表示的小区间内，例如 $(\\varepsilon, 1-\\varepsilon)$，其中 $\\varepsilon > 0$ 是一个小数。题目指定使用 $\\varepsilon = 10^{-12}$。\n\n利用变换后的数据，我们可以执行普通最小二乘法（OLS）线性回归，以找到最小化残差平方和的最佳拟合斜率 $\\hat{m}$ 和截距 $\\hat{c}$。根据这些拟合参数，我们估算Hill参数：\n1. Hill系数 $n$ 直接从斜率估算得出：\n   $$ \\hat{n} = \\hat{m} $$\n2. 表观解离常数 $K_d$ 从斜率和截距估算得出。从 $\\hat{c} = -\\hat{n}\\log(\\hat{K}_d)$，我们可以解出 $\\hat{K}_d$：\n   $$ \\log(\\hat{K}_d) = -\\frac{\\hat{c}}{\\hat{n}} $$\n   $$ \\hat{K}_d = \\exp\\left(-\\frac{\\hat{c}}{\\hat{m}}\\right) $$\n\n代码中实现的算法对每个提供的数据集都遵循这些步骤。它将原始的 $([L], Y)$ 数据转换为线性的Hill图坐标 $(\\log([L]), \\log(Y/(1-Y)))$，执行OLS拟合以提取斜率和截距，然后使用上面推导的关系计算 $n$ 和 $K_d$ 的估计值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives Hill plot parameters (n, Kd) for several receptor-ligand binding datasets.\n    \"\"\"\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"L\": np.array([1e-8, 5e-8, 1e-7, 5e-7, 1e-6, 5e-6]),\n            \"Y\": np.array([0.019608, 0.090909, 0.166667, 0.500000, 0.666667, 0.909091])\n        },\n        {\n            \"L\": np.array([1e-7, 5e-7, 1e-6, 2e-6, 5e-6, 1e-5]),\n            \"Y\": np.array([0.002494, 0.058824, 0.200000, 0.500000, 0.862069, 0.961538])\n        },\n        {\n            \"L\": np.array([1e-9, 1e-8, 1e-7, 1e-6, 1e-5]),\n            \"Y\": np.array([0.030657, 0.090909, 0.240253, 0.500000, 0.759141])\n        },\n        {\n            \"L\": np.array([1e-9, 5e-9, 1e-7, 5e-7, 1e-6]),\n            \"Y\": np.array([0.000001, 0.000125, 0.500000, 0.992063, 0.999001])\n        },\n        {\n            \"L\": np.array([1e-6, 3e-6, 1e-5]),\n            \"Y\": np.array([0.161398, 0.500000, 0.858026])\n        }\n    ]\n\n    results = []\n    epsilon = 1e-12\n\n    for case in test_cases:\n        L = case[\"L\"]\n        Y = case[\"Y\"]\n\n        # 1. Clip Y to avoid numerical singularities at 0 and 1\n        Y_clipped = np.clip(Y, epsilon, 1 - epsilon)\n\n        # 2. Transform data for Hill plot\n        # x_fit = log([L])\n        # y_fit = log(Y / (1 - Y))\n        x_fit = np.log(L)\n        y_fit = np.log(Y_clipped / (1 - Y_clipped))\n\n        # 3. Perform Ordinary Least Squares (OLS) linear regression\n        # y_fit = m * x_fit + c\n        # We need to find slope m and intercept c.\n        N = len(x_fit)\n        sum_x = np.sum(x_fit)\n        sum_y = np.sum(y_fit)\n        sum_xy = np.sum(x_fit * y_fit)\n        sum_x2 = np.sum(x_fit * x_fit)\n\n        # Calculate slope (m) and intercept (c) using standard OLS formulas\n        # m = (N * sum(xy) - sum(x) * sum(y)) / (N * sum(x^2) - (sum(x))^2)\n        # c = (sum(y) - m * sum(x)) / N\n        denominator = N * sum_x2 - sum_x**2\n        if np.abs(denominator)  1e-15:\n            # This would occur if all log([L]) values are identical, which is\n            # not the case here but is a necessary check for robust code.\n            # The slope is effectively infinite or undefined.\n            m = np.inf\n            c = np.nan\n        else:\n            m = (N * sum_xy - sum_x * sum_y) / denominator\n            c = (sum_y - m * sum_x) / N\n\n        # 4. Estimate Hill parameters n and Kd\n        # n = m\n        # Kd = exp(-c / m)\n        n = m\n        \n        if np.abs(m)  1e-15:\n            # If slope is zero, Kd is undefined in this formulation.\n            Kd = np.nan \n        else:\n            Kd = np.exp(-c / m)\n\n        results.extend([n, Kd])\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这个实践将挑战您将协同结合的原理扩展到一个更复杂的场景：变构抑制。通过从统计权重构建结合多项式，您将为一个具有两个协同抑制剂位点的酶建模。这个问题展示了统计热力学在为复杂调控机制建立预测模型方面的强大能力，这是药理学和系统生物学中的一项关键技能。",
            "id": "3879824",
            "problem": "一种酶 $E$ 参与一个催化反应，在没有抑制剂存在时，其初始速率为 $v_{0}$。该酶具有两个相同的变构抑制剂结合位点，用于结合小分子抑制剂 $I$。结合处于热力学平衡状态，且抑制剂浓度远大于总酶浓度，因此游离抑制剂浓度等于总抑制剂浓度。结合到同一酶上的两个抑制剂分子之间的协同相互作用通过一个相互作用参数 $\\omega$ 进行建模，具体如下：双占据状态的统计权重是两个独立位点预期值的 $\\omega$ 倍。与一个未占据位点结合的解离常数为 $K$。由于存在两个等效位点，单占据状态具有双重组合多重性。\n\n假设以下活性模型：如果一个酶分子上结合了 $n \\in \\{0,1,2\\}$ 个抑制剂分子，其催化活性相对于未受抑制的活性会以乘积形式降低一个因子 $\\beta^{n}$，其中 $0  \\beta  1$ 是一个表征每个位点抑制效率的固定数值。令 $a(I)$ 表示抑制剂浓度为 $I$ 时的归一化活性 $v(I)/v_{0}$。\n\n从基本的平衡结合和统计热力学（结合多项式和微观状态概率）出发，推导出用 $I$、$K$、$\\beta$ 和 $\\omega$ 表示的 $a(I)$，然后确定抑制剂浓度 $I_{1/2}$，使得 $a(I_{1/2}) = \\tfrac{1}{2}$。\n\n使用参数值 $K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$，$\\beta = 0.30$ 和 $\\omega = 10$。以纳摩尔/升 (nM) 为单位表示你最终的 $I_{1/2}$，并将答案四舍五入到三位有效数字。最终答案必须是一个实数。",
            "solution": "该问题要求推导归一化酶活性 $a(I)$ 作为抑制剂浓度 $I$ 的函数，并随后计算半数最大抑制浓度 $I_{1/2}$。\n\n首先，我们基于统计热力学建立抑制剂结合模型。酶 $E$ 有两个相同的、可区分的抑制剂 $I$ 结合位点。平衡状态下存在三种可能的组分：$E$（未结合抑制剂）、$EI$（结合一个抑制剂）和 $EI_2$（结合两个抑制剂）。我们定义这些组分相对于未结合的酶 $E$ 的统计权重，将 $E$ 的权重设为 $1$。\n\n令 $[I]$ 为游离抑制剂浓度，$K$ 为抑制剂与未占据位点结合的解离常数。问题指出 $[I]$ 远大于总酶浓度，因此我们可以将 $[I]$ 视为一个常数参数，记为 $I$。\n\n1.  **$E$ 的统计权重（$n=0$ 个抑制剂的状态）：**\n    根据定义，统计权重为 $w_0 = 1$。\n\n2.  **$EI$ 的统计权重（$n=1$ 个抑制剂的状态）：**\n    第一个抑制剂可以结合到两个相同的位点上。问题中说明了“双重组合多重性”。对于每个位点，结合平衡为 $E + I \\rightleftharpoons EI_{\\text{site}}$。单个位点的结合常数为 $1/K$。由于有两个位点，相对于游离酶的统计权重是结合到每个位点的权重之和，即 $w_1 = \\binom{2}{1} \\frac{I}{K} = 2\\frac{I}{K}$。\n\n3.  **$EI_2$ 的统计权重（$n=2$ 个抑制剂的状态）：**\n    对于两个独立且相同的位点，结合两个抑制剂的统计权重将是 $(\\frac{I}{K})^2$。问题引入了一个协同相互作用参数 $\\omega$，指出双占据状态的统计权重乘以 $\\omega$。因此，权重为 $w_2 = \\binom{2}{2} \\omega (\\frac{I}{K})^2 = \\omega (\\frac{I}{K})^2$。\n\n结合多项式 $P(I)$，作为系统的配分函数，是所有统计权重的总和：\n$$P(I) = w_0 + w_1 + w_2 = 1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2$$\n\n酶分子处于每个状态（$p_n$）的比例是该状态的统计权重除以结合多项式：\n$p_0 = \\frac{w_0}{P(I)} = \\frac{1}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_1 = \\frac{w_1}{P(I)} = \\frac{2\\frac{I}{K}}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_2 = \\frac{w_2}{P(I)} = \\frac{\\omega (\\frac{I}{K})^2}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n\n总催化速率 $v(I)$ 是各种组分活性的加权和。结合了 $n$ 个抑制剂的酶的活性由 $\\beta^n v_0$ 给出，其中 $v_0$ 是未受抑制的速率，且 $0  \\beta  1$。\n$v(I) = p_0 \\cdot (\\beta^0 v_0) + p_1 \\cdot (\\beta^1 v_0) + p_2 \\cdot (\\beta^2 v_0)$\n$v(I) = v_0 (p_0 + \\beta p_1 + \\beta^2 p_2)$\n\n归一化活性 $a(I)$ 是 $v(I)/v_0$：\n$a(I) = p_0 + \\beta p_1 + \\beta^2 p_2$\n代入 $p_n$ 的表达式：\n$$a(I) = \\frac{1 + \\beta \\left(2\\frac{I}{K}\\right) + \\beta^2 \\left(\\omega \\left(\\frac{I}{K}\\right)^2\\right)}{1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2}$$\n这就是推导出的 $a(I)$ 的表达式。\n\n接下来，我们确定抑制剂浓度 $I_{1/2}$，此时归一化活性为 $a(I_{1/2}) = \\frac{1}{2}$。\n令 $x = \\frac{I_{1/2}}{K}$。方程变为：\n$$\\frac{1 + 2\\beta x + \\omega\\beta^2 x^2}{1 + 2x + \\omega x^2} = \\frac{1}{2}$$\n交叉相乘得到：\n$2(1 + 2\\beta x + \\omega\\beta^2 x^2) = 1 + 2x + \\omega x^2$\n$2 + 4\\beta x + 2\\omega\\beta^2 x^2 = 1 + 2x + \\omega x^2$\n整理各项，形成一个标准的二次方程 $Ax^2 + Bx + C = 0$：\n$(2\\omega\\beta^2 - \\omega)x^2 + (4\\beta - 2)x + (2 - 1) = 0$\n$$\\omega(2\\beta^2 - 1)x^2 + 2(2\\beta - 1)x + 1 = 0$$\n\n现在，我们代入给定的参数值：$K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$，$\\beta = 0.30$ 和 $\\omega = 10$。\n首先，计算二次方程的系数：\n$A = \\omega(2\\beta^2 - 1) = 10(2(0.30)^2 - 1) = 10(2(0.09) - 1) = 10(0.18 - 1) = 10(-0.82) = -8.2$\n$B = 2(2\\beta - 1) = 2(2(0.30) - 1) = 2(0.6 - 1) = 2(-0.4) = -0.8$\n$C = 1$\n该方程为 $-8.2x^2 - 0.8x + 1 = 0$，等价于 $8.2x^2 + 0.8x - 1 = 0$。\n\n我们使用二次方程求根公式 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解出 $x$：\n$x = \\frac{-0.8 \\pm \\sqrt{(0.8)^2 - 4(8.2)(-1)}}{2(8.2)}$\n$x = \\frac{-0.8 \\pm \\sqrt{0.64 + 32.8}}{16.4}$\n$x = \\frac{-0.8 \\pm \\sqrt{33.44}}{16.4}$\n由于 $x = I_{1/2}/K$ 代表浓度之比，它必须是一个正实数。因此，我们取正根：\n$x = \\frac{-0.8 + \\sqrt{33.44}}{16.4} \\approx \\frac{-0.8 + 5.78273}{16.4} \\approx \\frac{4.98273}{16.4} \\approx 0.303825$\n\n最后，我们计算 $I_{1/2}$：\n$I_{1/2} = x \\cdot K \\approx 0.303825 \\times (1.0 \\times 10^{-7}\\,\\mathrm{M}) \\approx 3.03825 \\times 10^{-8}\\,\\mathrm{M}$\n\n问题要求答案以纳摩尔/升 (nM) 为单位。我们从 M 转换为 nM：\n$1\\,\\mathrm{M} = 10^9\\,\\mathrm{nM}$\n$I_{1/2} \\approx (3.03825 \\times 10^{-8}) \\times 10^9\\,\\mathrm{nM} = 30.3825\\,\\mathrm{nM}$\n\n四舍五入到三位有效数字，我们得到：\n$I_{1/2} \\approx 30.4\\,\\mathrm{nM}$",
            "answer": "$$\n\\boxed{30.4}\n$$"
        }
    ]
}