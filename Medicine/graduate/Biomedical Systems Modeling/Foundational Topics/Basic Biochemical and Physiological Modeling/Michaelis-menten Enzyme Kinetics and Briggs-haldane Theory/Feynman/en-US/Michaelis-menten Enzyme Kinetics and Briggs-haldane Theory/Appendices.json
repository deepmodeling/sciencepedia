{
    "hands_on_practices": [
        {
            "introduction": "Mastering enzyme kinetics begins with understanding how the widely-used Michaelis-Menten equation is derived from the elementary steps of a reaction. This first practice exercise guides you through this fundamental process using the Briggs-Haldane quasi-steady-state approximation (QSSA). You will not only derive the expressions for $K_M$ and $k_{\\text{cat}}$ but also apply them to calculate an initial reaction velocity and, critically, to assess the practical validity of the initial-rate assumption by quantifying substrate depletion over time .",
            "id": "2649716",
            "problem": "An enzyme-catalyzed reaction used to benchmark inhibition mechanisms is studied under conditions designed to validate the initial-rate regime in the absence of inhibitor as a control. The elementary mechanism is the two-step binding and catalysis scheme\n$$\nE + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P,\n$$\nwith total enzyme concentration conserved so that $[E]_{0} = [E] + [ES]$. Assume mass-action kinetics, negligible reverse product formation at early times, and that $[S]_{0} \\gg [E]_{0}$. The Quasi-Steady-State Approximation (QSSA) is defined as the assumption that $d[ES]/dt \\approx 0$ over the initial-rate window.\n\nGiven the following physically plausible parameters:\n- Association rate constant $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$,\n- Dissociation rate constant $k_{-1} = 180\\ \\mathrm{s}^{-1}$,\n- Catalytic rate constant $k_{2} = 20\\ \\mathrm{s}^{-1}$,\n- Total enzyme concentration $[E]_{0} = 12\\ \\mathrm{nM}$,\n- Initial substrate concentration $[S]_{0} = 50\\ \\mathrm{\\mu M}$,\n\nperform the following, starting from mass-action rate equations and conservation laws, without invoking any result that has not been derived from these principles:\n\n1) Derive the definitions of the Michaelis constant $K_{M}$ and the catalytic constant $k_{\\text{cat}}$ in terms of $k_{1}$, $k_{-1}$, and $k_{2}$ under the QSSA.\n\n2) Using your derived relations, compute $K_{M}$ (in $\\mathrm{M}$), $k_{\\text{cat}}$ (in $\\mathrm{s}^{-1}$), and the initial velocity $v_{0}$ (in $\\mathrm{M}\\ \\mathrm{s}^{-1}$) at $t=0$.\n\n3) Using the stoichiometry $S \\to P$ and assuming the initial velocity remains approximately constant over the first $5$ s, estimate the fraction of substrate depleted after $5$ s as a unitless decimal fraction. Based on this fraction, assess whether the initial-rate approximation remains valid over $5$ s by comparing the fraction to a conservative small-change criterion (for example, less than $0.05$).\n\nRound your final reported fraction in part $3$ to four significant figures. Express the final answer as a unitless decimal fraction. Report only this final fraction as your answer.",
            "solution": "**Part 1: Derivation of $K_M$ and $k_{\\text{cat}}$**\n\nThe rate of change of the enzyme-substrate complex concentration, $[ES]$, is described by the law of mass action applied to the given mechanism:\n$$\n\\frac{d[ES]}{dt} = k_{1}[E][S] - k_{-1}[ES] - k_{2}[ES] = k_{1}[E][S] - (k_{-1} + k_{2})[ES]\n$$\nThe velocity of the reaction, $v$, is the rate of formation of the product, $P$:\n$$\nv = \\frac{d[P]}{dt} = k_{2}[ES]\n$$\nThe Quasi-Steady-State Approximation (QSSA) assumes that the concentration of the intermediate complex $[ES]$ remains nearly constant over the time scale of the initial rate measurement, meaning $\\frac{d[ES]}{dt} \\approx 0$. Applying this approximation to the rate equation for $[ES]$ gives:\n$$\nk_{1}[E][S] \\approx (k_{-1} + k_{2})[ES]\n$$\nThe total enzyme concentration $[E]_{0}$ is conserved: $[E]_{0} = [E] + [ES]$. This allows us to express the concentration of free enzyme, $[E]$, as $[E] = [E]_{0} - [ES]$. Substituting this into the steady-state equation yields:\n$$\nk_{1}([E]_{0} - [ES])[S] \\approx (k_{-1} + k_{2})[ES]\n$$\nWe rearrange this expression to solve for $[ES]$:\n$$\nk_{1}[E]_{0}[S] - k_{1}[ES][S] \\approx (k_{-1} + k_{2})[ES]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx (k_{-1} + k_{2})[ES] + k_{1}[ES][S]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx [ES]((k_{-1} + k_{2}) + k_{1}[S])\n$$\n$$\n[ES] \\approx \\frac{k_{1}[E]_{0}[S]}{(k_{-1} + k_{2}) + k_{1}[S]}\n$$\nTo obtain the standard form of the rate law, we divide the numerator and denominator by $k_{1}$:\n$$\n[ES] \\approx \\frac{[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\nNow, substitute this expression for $[ES]$ back into the equation for the reaction velocity $v$:\n$$\nv = k_{2}[ES] \\approx \\frac{k_{2}[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\nThis equation is the Michaelis-Menten rate law, which is conventionally written as $v = \\frac{k_{\\text{cat}}[E]_{0}[S]}{K_{M} + [S]}$. By direct comparison of the derived equation with the standard form, we identify the definitions of the catalytic constant $k_{\\text{cat}}$ and the Michaelis constant $K_{M}$:\n$$\nk_{\\text{cat}} = k_{2}\n$$\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}}\n$$\nThis completes the derivation.\n\n**Part 2: Calculation of $K_{M}$, $k_{\\text{cat}}$, and $v_{0}$**\n\nUsing the given parameter values:\n-   $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n-   $k_{-1} = 180\\ \\mathrm{s}^{-1}$\n-   $k_{2} = 20\\ \\mathrm{s}^{-1}$\n-   $[E]_{0} = 12\\ \\mathrm{nM} = 1.2 \\times 10^{-8}\\ \\mathrm{M}$\n-   $[S]_{0} = 50\\ \\mathrm{\\mu M} = 5.0 \\times 10^{-5}\\ \\mathrm{M}$\n\nWe compute $k_{\\text{cat}}$:\n$$\nk_{\\text{cat}} = k_{2} = 20\\ \\mathrm{s}^{-1}\n$$\nNext, we compute $K_{M}$:\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}} = \\frac{180\\ \\mathrm{s}^{-1} + 20\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}} = \\frac{200\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}}\n$$\n$$\nK_{M} = \\frac{2}{1.2} \\times 10^{-5}\\ \\mathrm{M} = \\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M} \\approx 1.67 \\times 10^{-5}\\ \\mathrm{M}\n$$\nThe initial velocity $v_{0}$ is the velocity at $t=0$, where $[S] = [S]_{0}$. We use the derived rate law:\n$$\nv_{0} = \\frac{k_{\\text{cat}}[E]_{0}[S]_{0}}{K_{M} + [S]_{0}}\n$$\nSubstituting the numerical values:\n$$\nv_{0} = \\frac{(20\\ \\mathrm{s}^{-1})(1.2 \\times 10^{-8}\\ \\mathrm{M})(5.0 \\times 10^{-5}\\ \\mathrm{M})}{(\\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M}) + (5.0 \\times 10^{-5}\\ \\mathrm{M})}\n$$\nThe numerator is:\n$$\n(20)(1.2 \\times 10^{-8})(5.0 \\times 10^{-5})\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 120 \\times 10^{-13}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}\n$$\nThe denominator is:\n$$\n\\left(\\frac{5}{3} + 5\\right) \\times 10^{-5}\\ \\mathrm{M} = \\left(\\frac{5}{3} + \\frac{15}{3}\\right) \\times 10^{-5}\\ \\mathrm{M} = \\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}\n$$\nThus, the initial velocity is:\n$$\nv_{0} = \\frac{1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}}{\\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}} = \\frac{1.2 \\times 3}{20} \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 0.18 \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}\n$$\n\n**Part 3: Substrate Depletion and Validity Assessment**\n\nThe initial-rate approximation assumes that the velocity $v \\approx v_{0}$ for a short time interval $\\Delta t$. The velocity is related to substrate depletion by $v = -\\frac{d[S]}{dt}$. If $v$ is constant, the amount of substrate consumed over $\\Delta t$ is $|\\Delta[S]| \\approx v_{0} \\Delta t$.\nGiven $\\Delta t = 5\\ \\mathrm{s}$:\n$$\n|\\Delta[S]| \\approx (1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}) \\times (5\\ \\mathrm{s}) = 9.0 \\times 10^{-7}\\ \\mathrm{M}\n$$\nThe fraction of substrate depleted is the ratio of substrate consumed to the initial substrate concentration, $[S]_{0}$:\n$$\n\\text{Fraction depleted} = \\frac{|\\Delta[S]|}{[S]_{0}} \\approx \\frac{v_{0} \\Delta t}{[S]_{0}}\n$$\nSubstituting the values:\n$$\n\\text{Fraction depleted} \\approx \\frac{9.0 \\times 10^{-7}\\ \\mathrm{M}}{5.0 \\times 10^{-5}\\ \\mathrm{M}} = \\frac{9.0}{500} = \\frac{1.8}{100} = 0.018\n$$\nThe problem asks for this fraction to be reported to four significant figures. Thus, the fraction is $0.01800$.\nTo assess the validity of the initial-rate approximation, we compare this fraction to the criterion of being less than $0.05$. Since $0.01800 < 0.05$, the depletion of substrate is approximately $1.8\\%$, which is well within the acceptable limit for the initial-rate assumption to be valid over the $5\\ \\mathrm{s}$ interval. The concentration of substrate does not change sufficiently to cause a significant deviation from the initial velocity.\n\nThe final answer is the unitless decimal fraction of substrate depleted, rounded to four significant figures.",
            "answer": "$$\\boxed{0.01800}$$"
        },
        {
            "introduction": "Once a model like the Michaelis-Menten equation is established, a crucial next step in systems modeling is to understand which parameters have the most influence on the model's output. This practice introduces you to sensitivity analysis, a powerful technique for quantifying the impact of each parameter on the reaction rate. By deriving and calculating the normalized sensitivity coefficients, you will gain quantitative insight into how substrate concentration shifts control from one kinetic parameter to another, a cornerstone of understanding and manipulating biological pathways .",
            "id": "3901785",
            "problem": "Consider a single-substrate, single-product enzymatic reaction with the elementary mass-action scheme $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$, where $E$ is free enzyme, $S$ is substrate, $ES$ is the enzyme-substrate complex, and $P$ is product. Let the total enzyme concentration be $E_{T} = [E] + [ES]$. Under the Quasi-Steady-State Approximation (QSSA), the rate of product formation $v$ can be expressed in terms of $k_{1}$, $k_{-1}$, $k_{2}$, $E_{T}$, and $[S]$ through well-tested biochemical kinetics and algebraic manipulation. The Briggs-Haldane perspective interprets the Michaelis-Menten constant $K_{M}$ in terms of the elementary rate constants $k_{1}$, $k_{-1}$, and $k_{2}$.\n\nYour task is to start from the mass-action description and the QSSA concept and derive an expression for $v$ as a function of the parameters $k_{1}$, $k_{-1}$, $k_{2}$, $E_{T}$, and $[S]$, and then analytically compute the normalized sensitivity coefficients of $v$ with respect to each parameter $p \\in \\{k_{1}, k_{-1}, k_{2}, E_{T}, [S]\\}$, defined by $S_{p} = \\left(\\dfrac{p}{v}\\right)\\dfrac{\\partial v}{\\partial p}$. You must implement these closed-form sensitivity coefficients in a program. All quantities are to be treated in consistent physical units: $k_{1}$ in $\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{-1}$ in $\\mathrm{s}^{-1}$, $k_{2}$ in $\\mathrm{s}^{-1}$, $E_{T}$ in $\\mathrm{M}$, and $[S]$ in $\\mathrm{M}$. The outputs are dimensionless normalized sensitivities and must be expressed as decimal numbers (no percentage sign).\n\nImplement a program that, for each parameter set in the test suite below, computes and returns the vector of five normalized sensitivity coefficients $[S_{k_{1}}, S_{k_{-1}}, S_{k_{2}}, S_{E_{T}}, S_{[S]}]$ using your derived analytic expressions. Do not use numerical differentiation in your final outputs; the expected results are from your analytic derivation.\n\nTest Suite (provide all parameters in the specified units):\n- Case A (balanced regime): $k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$, $k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$, $E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$, $[S] = 1.0 \\times 10^{-4}\\ \\mathrm{M}$.\n- Case B (low substrate): $k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$, $k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$, $E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$, $[S] = 1.0 \\times 10^{-8}\\ \\mathrm{M}$.\n- Case C (saturating substrate): $k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$, $k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$, $E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$, $[S] = 1.0 \\times 10^{-2}\\ \\mathrm{M}$.\n- Case D (high turnover): $k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$, $k_{2} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$, $E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$, $[S] = 1.0 \\times 10^{-4}\\ \\mathrm{M}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of test cases A, B, C, D, and within each case in the fixed parameter order $[S_{k_{1}}, S_{k_{-1}}, S_{k_{2}}, S_{E_{T}}, S_{[S]}]$. For example, the output should look like $[a_{1},a_{2},a_{3},a_{4},a_{5},b_{1},b_{2},\\dots,d_{5}]$, where each $a_{i}, b_{i}, c_{i}, d_{i}$ is a decimal number representing the corresponding sensitivity coefficient.",
            "solution": "The user wants to derive the normalized sensitivity coefficients for the rate of an enzymatic reaction with respect to all system parameters, starting from the elementary reaction mechanism and the Quasi-Steady-State Approximation (QSSA).\n\n### Derivation of the Reaction Rate Expression\n\nThe problem describes a single-substrate enzymatic reaction based on the mass-action scheme:\n$$ E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P $$\nwhere $[E]$, $[S]$, $[ES]$, and $[P]$ are the concentrations of free enzyme, substrate, enzyme-substrate complex, and product, respectively. The rate constants are $k_1$, $k_{-1}$, and $k_2$.\n\nThe rates of change for the concentrations of the species involved are given by the following set of ordinary differential equations:\n$$ \\frac{d[E]}{dt} = -k_1 [E][S] + (k_{-1} + k_2) [ES] $$\n$$ \\frac{d[S]}{dt} = -k_1 [E][S] + k_{-1} [ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_2) [ES] $$\nThe rate of product formation, $v$, is given by:\n$$ v = \\frac{d[P]}{dt} = k_2 [ES] $$\nThe total enzyme concentration, $E_T$, is conserved:\n$$ E_T = [E] + [ES] \\implies [E] = E_T - [ES] $$\nThe Quasi-Steady-State Approximation (QSSA), also known as the Briggs-Haldane approximation, assumes that the concentration of the intermediate enzyme-substrate complex $[ES]$ changes much more slowly than the concentrations of the substrate and product. We can thus set its rate of change to zero:\n$$ \\frac{d[ES]}{dt} \\approx 0 $$\nApplying this approximation to the rate equation for $[ES]$:\n$$ k_1 [E][S] - (k_{-1} + k_2) [ES] = 0 $$\nNow, we substitute the expression for the free enzyme concentration $[E]$ from the conservation law into this steady-state equation:\n$$ k_1 (E_T - [ES])[S] - (k_{-1} + k_2) [ES] = 0 $$\nWe can now solve this algebraic equation for the steady-state concentration of the enzyme-substrate complex, $[ES]$:\n$$ k_1 E_T [S] - k_1 [ES][S] - (k_{-1} + k_2) [ES] = 0 $$\n$$ k_1 E_T [S] = [ES] (k_1 [S] + k_{-1} + k_2) $$\n$$ [ES] = \\frac{k_1 E_T [S]}{k_{-1} + k_2 + k_1 [S]} $$\nFinally, we substitute this expression for $[ES]$ into the equation for the reaction rate $v = k_2 [ES]$:\n$$ v = \\frac{k_1 k_2 E_T [S]}{k_{-1} + k_2 + k_1 [S]} $$\nThis expression gives the reaction rate $v$ as a function of the elementary rate constants $k_1, k_{-1}, k_2$, the total enzyme concentration $E_T$, and the substrate concentration $[S]$. This is the Michaelis-Menten rate law, which can be written as $v = \\frac{V_{\\text{max}}[S]}{K_M + [S]}$, where the maximum velocity is $V_{\\text{max}} = k_2 E_T$ and the Michaelis constant under the Briggs-Haldane interpretation is $K_M = \\frac{k_{-1} + k_2}{k_1}$.\n\n### Derivation of Normalized Sensitivity Coefficients\n\nThe normalized sensitivity coefficient of the rate $v$ with respect to a parameter $p$ is defined as:\n$$ S_p = \\frac{\\partial \\ln v}{\\partial \\ln p} = \\frac{p}{v} \\frac{\\partial v}{\\partial p} $$\nThis dimensionless quantity measures the fractional change in $v$ resulting from a fractional change in $p$. We will derive the analytical expressions for $S_p$ for each parameter $p \\in \\{k_1, k_{-1}, k_2, E_T, [S]\\}$. A convenient approach is to first take the natural logarithm of the rate expression:\n$$ \\ln v = \\ln(k_1 k_2 E_T [S]) - \\ln(k_{-1} + k_2 + k_1 [S]) $$\n$$ \\ln v = \\ln(k_1) + \\ln(k_2) + \\ln(E_T) + \\ln([S]) - \\ln(k_{-1} + k_2 + k_1 [S]) $$\nLet's denote the common denominator term $D = k_{-1} + k_2 + k_1 [S]$.\n\n1.  **Sensitivity with respect to $k_1$ ($S_{k_1}$):**\n    $$ S_{k_1} = k_1 \\frac{\\partial (\\ln v)}{\\partial k_1} = k_1 \\left( \\frac{1}{k_1} - \\frac{[S]}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_1 [S]}{D} = \\frac{D - k_1 [S]}{D} $$\n    $$ S_{k_1} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_1 [S]}{D} = \\frac{k_{-1} + k_2}{D} $$\n\n2.  **Sensitivity with respect to $k_{-1}$ ($S_{k_{-1}}$):**\n    $$ S_{k_{-1}} = k_{-1} \\frac{\\partial (\\ln v)}{\\partial k_{-1}} = k_{-1} \\left( 0 - \\frac{1}{k_{-1} + k_2 + k_1 [S]} \\right) = -\\frac{k_{-1}}{D} $$\n\n3.  **Sensitivity with respect to $k_2$ ($S_{k_2}$):**\n    $$ S_{k_2} = k_2 \\frac{\\partial (\\ln v)}{\\partial k_2} = k_2 \\left( \\frac{1}{k_2} - \\frac{1}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_2}{D} = \\frac{D - k_2}{D} $$\n    $$ S_{k_2} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_2}{D} = \\frac{k_{-1} + k_1 [S]}{D} $$\n\n4.  **Sensitivity with respect to $E_T$ ($S_{E_T}$):**\n    Since $v$ is directly proportional to $E_T$, the normalized sensitivity is $1$.\n    $$ S_{E_T} = E_T \\frac{\\partial (\\ln v)}{\\partial E_T} = E_T \\left( \\frac{1}{E_T} \\right) = 1 $$\n\n5.  **Sensitivity with respect to $[S]$ ($S_{[S]}$):**\n    $$ S_{[S]} = [S] \\frac{\\partial (\\ln v)}{\\partial [S]} = [S] \\left( \\frac{1}{[S]} - \\frac{k_1}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_1 [S]}{D} = \\frac{D - k_1 [S]}{D} $$\n    $$ S_{[S]} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_1 [S]}{D} = \\frac{k_{-1} + k_2}{D} $$\n\n### Summary of Analytical Expressions\n\nThe five normalized sensitivity coefficients are:\nLet $D = k_{-1} + k_2 + k_1 [S]$.\n$$ S_{k_1} = \\frac{k_{-1} + k_2}{D} $$\n$$ S_{k_{-1}} = \\frac{-k_{-1}}{D} $$\n$$ S_{k_2} = \\frac{k_{-1} + k_1 [S]}{D} $$\n$$ S_{E_T} = 1 $$\n$$ S_{[S]} = \\frac{k_{-1} + k_2}{D} $$\nAn important observation is that $S_{k_1} = S_{[S]}$ for this model. Furthermore, a summation property holds for the kinetic parameters:\n$$ S_{k_1} + S_{k_{-1}} + S_{k_2} = \\frac{k_{-1} + k_2}{D} + \\frac{-k_{-1}}{D} + \\frac{k_{-1} + k_1 [S]}{D} = \\frac{k_{-1} + k_2 - k_{-1} + k_{-1} + k_1[S]}{D} = \\frac{k_{-1} + k_2 + k_1[S]}{D} = 1 $$\nThis serves as a consistency check for the derivations. These final analytic expressions will be implemented in the program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized sensitivity coefficients for the Michaelis-Menten\n    reaction rate based on analytical derivations.\n    \"\"\"\n\n    # Test suite of parameter sets.\n    # Parameters are (k1, k_minus1, k2, E_T, S).\n    # Units: k1 in M^-1 s^-1, k_minus1 in s^-1, k2 in s^-1, E_T in M, S in M.\n    test_cases = [\n        # Case A (balanced regime)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-4),\n        # Case B (low substrate)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-8),\n        # Case C (saturating substrate)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-2),\n        # Case D (high turnover)\n        (1.0e6, 1.0e2, 1.0e5, 1.0e-7, 1.0e-4),\n    ]\n\n    all_results = []\n\n    def calculate_sensitivities(k1, k_minus1, k2, E_T, S):\n        \"\"\"\n        Calculates the vector of five normalized sensitivity coefficients\n        using the derived closed-form expressions.\n\n        Args:\n            k1 (float): Forward rate constant for ES formation.\n            k_minus1 (float): Reverse rate constant for ES dissociation.\n            k2 (float): Catalytic rate constant (turnover number).\n            E_T (float): Total enzyme concentration.\n            S (float): Substrate concentration.\n\n        Returns:\n            list: A list of the five sensitivity coefficients\n                  [S_k1, S_k_minus1, S_k2, S_ET, S_S].\n        \"\"\"\n        # Common denominator term from the derived expressions\n        # D = k_(-1) + k_2 + k_1 * [S]\n        D = k_minus1 + k2 + k1 * S\n\n        # S_k1 = (k_(-1) + k_2) / D\n        s_k1 = (k_minus1 + k2) / D\n\n        # S_k_minus1 = -k_(-1) / D\n        s_k_minus1 = -k_minus1 / D\n\n        # S_k2 = (k_(-1) + k_1 * [S]) / D\n        s_k2 = (k_minus1 + k1 * S) / D\n\n        # S_ET = 1\n        s_ET = 1.0\n\n        # S_S = (k_(-1) + k_2) / D\n        s_S = (k_minus1 + k2) / D\n        \n        return [s_k1, s_k_minus1, s_k2, s_ET, s_S]\n\n    for case in test_cases:\n        k1, k_minus1, k2, E_T, S = case\n        sensitivities = calculate_sensitivities(k1, k_minus1, k2, E_T, S)\n        all_results.extend(sensitivities)\n\n    # Format the final output string as a comma-separated list of numbers\n    # enclosed in square brackets.\n    # The str() conversion is sufficient as it provides high precision.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While initial-rate analysis provides a valuable snapshot of enzyme behavior, modeling the complete consumption of substrate over time requires a different approach. This exercise challenges you to move beyond initial rates by deriving the integrated Michaelis-Menten equation, which provides a closed-form analytical solution for the substrate's progress curve. You will then compare this approximate analytical solution to the \"exact\" numerical solution of the full underlying mass-action system, offering a direct and tangible way to evaluate the accuracy of the QSSA throughout the entire course of the reaction .",
            "id": "3901788",
            "problem": "Consider the irreversible enzyme-catalyzed reaction system described by the elementary steps $E + S \\rightleftharpoons ES$ and $ES \\rightarrow E + P$, where $E$ is free enzyme, $S$ is substrate, $ES$ is enzyme-substrate complex, and $P$ is product. The forward binding, reverse unbinding, and catalytic rate constants are $k_1$, $k_{-1}$, and $k_{\\mathrm{cat}}$, respectively, all strictly positive. Assume a well-mixed, closed system with constant total enzyme $E_{\\mathrm{tot}}$ and an initially substrate-only solution with $S(0) = S_0$, $ES(0) = 0$, $P(0) = 0$, and $E(0) = E_{\\mathrm{tot}}$. Concentrations are in moles per liter (M) and time in seconds (s).\n\nStarting from the law of mass action for the above reactions, derive from first principles the substrate time-course under the Briggs-Haldane Quasi-Steady-State Approximation (QSSA), and express it as a closed-form analytic function of $t$, $S_0$, $E_{\\mathrm{tot}}$, $k_1$, $k_{-1}$, and $k_{\\mathrm{cat}}$. Also set up the full finite-dimensional mass-action ordinary differential equation (ODE) model without approximations and compute the substrate time-course numerically. Use these two approaches to evaluate, for each specified parameter set and final time $t$, the absolute difference between the substrate predicted by the full mass-action ODE model and the substrate predicted by the QSSA-derived analytic progress curve. Express the final differences as floats in moles per liter (M).\n\nYour program must implement both:\n- The analytic time-course solution derived under the Briggs-Haldane Quasi-Steady-State Approximation (QSSA).\n- The numerical integration of the exact mass-action ODEs.\n\nFor each parameter set below, compute the absolute difference $\\Delta S$ defined by $\\Delta S = \\lvert S_{\\mathrm{ODE}}(t) - S_{\\mathrm{QSSA}}(t) \\rvert$, where $S_{\\mathrm{ODE}}(t)$ is the substrate concentration obtained from numerically integrating the full mass-action ODEs and $S_{\\mathrm{QSSA}}(t)$ is the substrate concentration obtained from the analytic QSSA progress curve. Report $\\Delta S$ in moles per liter (M) as a float.\n\nUse the following test suite of parameter sets, with all concentrations in M and times in s:\n- Test case $1$ (general regime): $k_1 = 10^6$, $k_{-1} = 10$, $k_{\\mathrm{cat}} = 100$, $E_{\\mathrm{tot}} = 10^{-7}$, $S_0 = 10^{-4}$, $t = 5 \\times 10^{-2}$.\n- Test case $2$ (substrate in large excess): $k_1 = 10^6$, $k_{-1} = 10$, $k_{\\mathrm{cat}} = 100$, $E_{\\mathrm{tot}} = 10^{-7}$, $S_0 = 10^{-3}$, $t = 10^{-2}$.\n- Test case $3$ (enzyme comparable to substrate, challenging QSSA): $k_1 = 5 \\times 10^5$, $k_{-1} = 2$, $k_{\\mathrm{cat}} = 20$, $E_{\\mathrm{tot}} = 10^{-5}$, $S_0 = 2 \\times 10^{-6}$, $t = 2 \\times 10^{-2}$.\n- Test case $4$ (boundary at initial time): $k_1 = 10^6$, $k_{-1} = 1$, $k_{\\mathrm{cat}} = 50$, $E_{\\mathrm{tot}} = 5 \\times 10^{-8}$, $S_0 = 5 \\times 10^{-5}$, $t = 0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases (for example, $[x_1,x_2,x_3,x_4]$), where each $x_i$ is the computed $\\Delta S$ in M for the corresponding test case.",
            "solution": "The problem requires the derivation and comparison of two models for substrate concentration over time in an enzyme-catalyzed reaction: the full mass-action ordinary differential equation (ODE) model and the analytic solution derived from the Briggs-Haldane Quasi-Steady-State Approximation (QSSA).\n\nThe reaction mechanism is given by two elementary steps:\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\quad \\text{(fast reversible binding)} $$\n$$ ES \\stackrel{k_{\\mathrm{cat}}}{\\rightarrow} E + P \\quad \\text{(slow irreversible catalysis)} $$\nwhere $E$, $S$, $ES$, and $P$ represent the free enzyme, substrate, enzyme-substrate complex, and product, respectively. The rate constants $k_1$ (forward binding, units: M$^{-1}$s$^{-1}$), $k_{-1}$ (reverse unbinding, units: s$^{-1}$), and $k_{\\mathrm{cat}}$ (catalysis, units: s$^{-1}$) are all strictly positive. The system is closed, with a constant total enzyme concentration $E_{\\mathrm{tot}}$. The initial conditions at time $t=0$ are $[S](0) = S_0$, $[E](0) = E_{\\mathrm{tot}}$, $[ES](0) = 0$, and $[P](0) = 0$.\n\n### Step 1: Formulation of the Full Mass-Action ODE Model\n\nApplying the law of mass action to the reaction scheme yields a system of ordinary differential equations describing the time evolution of the concentrations of the chemical species. Let $[S]$, $[E]$, $[ES]$, and $[P]$ denote these concentrations.\n\n$$ \\frac{d[S]}{dt} = -k_1 [E][S] + k_{-1}[ES] $$\n$$ \\frac{d[E]}{dt} = -k_1 [E][S] + (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ \\frac{d[P]}{dt} = k_{\\mathrm{cat}}[ES] $$\n\nThe total enzyme concentration is conserved:\n$$ [E](t) + [ES](t) = E_{\\mathrm{tot}} $$\nThis conservation law allows us to eliminate $[E]$ from the system by substituting $[E] = E_{\\mathrm{tot}} - [ES]$. The dynamics of the system can be fully described by the concentrations of $[S]$ and $[ES]$:\n\n$$ \\frac{d[S]}{dt} = -k_1 (E_{\\mathrm{tot}} - [ES])[S] + k_{-1}[ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n\nThese two coupled, non-linear ODEs, along with the initial conditions $[S](0) = S_0$ and $[ES](0) = 0$, constitute the full mass-action model. This system does not have a general closed-form analytic solution and must be solved numerically. This model will be referred to as the \"ODE model\".\n\n### Step 2: Derivation of the QSSA Analytic Progress Curve\n\nThe Briggs-Haldane Quasi-Steady-State Approximation (QSSA) simplifies the system by assuming that after a very short initial transient period, the concentration of the enzyme-substrate complex $[ES]$ changes much more slowly than the substrate and product concentrations. Mathematically, this is expressed as:\n$$ \\frac{d[ES]}{dt} \\approx 0 $$\n\nApplying this approximation to the ODE for $[ES]$:\n$$ k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] \\approx 0 $$\nAgain, substituting the enzyme conservation law $[E] = E_{\\mathrm{tot}} - [ES]$:\n$$ k_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] \\approx 0 $$\nWe can now solve this algebraic equation for the quasi-steady-state concentration of the complex, $[ES]_{\\mathrm{ss}}$:\n$$ k_1 E_{\\mathrm{tot}}[S] - k_1 [ES]_{\\mathrm{ss}}[S] \\approx (k_{-1} + k_{\\mathrm{cat}})[ES]_{\\mathrm{ss}} $$\n$$ k_1 E_{\\mathrm{tot}}[S] \\approx (k_1[S] + k_{-1} + k_{\\mathrm{cat}})[ES]_{\\mathrm{ss}} $$\n$$ [ES]_{\\mathrm{ss}} \\approx \\frac{k_1 E_{\\mathrm{tot}}[S]}{k_1[S] + k_{-1} + k_{\\mathrm{cat}}} = \\frac{E_{\\mathrm{tot}}[S]}{\\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1} + [S]} $$\n\nThis leads to the familiar Michaelis-Menten form. We define the Michaelis constant $K_M$ as:\n$$ K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1} $$\nSo, the steady-state complex concentration is:\n$$ [ES]_{\\mathrm{ss}} \\approx \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} $$\nThe rate of substrate consumption is then approximated by the rate of conversion to product, assuming that the change in $[S]$ due to binding and unbinding is at equilibrium. A more formal approach is to note that the total amount of substrate in the system, $[S]_{\\mathrm{total}} = [S] + [ES]$, is consumed only by the catalytic step: $d[S]_{\\mathrm{total}}/dt = -k_{\\mathrm{cat}}[ES]$. Under the QSSA, it is assumed that $[ES] \\ll [S]$, so $d[S]/dt \\approx d[S]_{\\mathrm{total}}/dt$. This gives the Michaelis-Menten rate law:\n$$ \\frac{d[S]}{dt} \\approx -k_{\\mathrm{cat}}[ES]_{\\mathrm{ss}} = - \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]} $$\nLet $V_{\\text{max}} = k_{\\mathrm{cat}} E_{\\mathrm{tot}}$ be the maximum reaction velocity. The equation becomes:\n$$ \\frac{d[S]}{dt} = - \\frac{V_{\\text{max}}[S]}{K_M + [S]} $$\nThis first-order ODE is separable. We can integrate it to find the substrate concentration as a function of time, $[S](t)$, known as the progress curve.\n$$ \\frac{K_M + [S]}{[S]} d[S] = -V_{\\text{max}} dt $$\n$$ \\left( \\frac{K_M}{[S]} + 1 \\right) d[S] = -V_{\\text{max}} dt $$\nIntegrating from $t=0$ to $t$ (and from $[S](0)=S_0$ to $[S](t)$):\n$$ \\int_{S_0}^{[S](t)} \\left( \\frac{K_M}{[S']} + 1 \\right) d[S'] = \\int_0^t -V_{\\text{max}} dt' $$\n$$ \\left[ K_M \\ln([S']) + [S'] \\right]_{S_0}^{[S](t)} = -V_{\\text{max}} t $$\n$$ (K_M \\ln([S](t)) + [S](t)) - (K_M \\ln(S_0) + S_0) = -V_{\\text{max}} t $$\nThis provides an implicit solution for $[S](t)$. To obtain a closed-form explicit solution, we can use the Lambert W function, which is defined as the solution to the equation $W(z)e^{W(z)} = z$. Rearranging the implicit equation:\n$$ K_M \\ln\\left(\\frac{[S](t)}{S_0}\\right) + [S](t) - S_0 = -V_{\\text{max}} t $$\n$$ \\frac{[S](t)}{K_M} - \\frac{S_0}{K_M} + \\ln\\left(\\frac{[S](t)}{K_M}\\right) - \\ln\\left(\\frac{S_0}{K_M}\\right) = -\\frac{V_{\\text{max}} t}{K_M} $$\n$$ \\ln\\left(\\frac{[S](t)}{K_M}\\right) + \\frac{[S](t)}{K_M} = \\ln\\left(\\frac{S_0}{K_M}\\right) + \\frac{S_0}{K_M} - \\frac{V_{\\text{max}} t}{K_M} $$\nLet $y(t) = \\frac{[S](t)}{K_M}$. Then $\\ln(y) + y = C(t)$, where $C(t)$ is the right-hand side. Exponentiating both sides gives $y e^y = e^{C(t)}$.\nThis is of the form $W(z)e^{W(z)}=z$. A more direct rearrangement is:\n$$ [S](t) e^{[S](t)/K_M} = S_0 e^{(S_0 - V_{\\text{max}}t)/K_M} $$\nMultiplying by $1/K_M$:\n$$ \\frac{[S](t)}{K_M} e^{[S](t)/K_M} = \\frac{S_0}{K_M} e^{\\frac{S_0 - V_{\\text{max}}t}{K_M}} $$\nApplying the Lambert W function to both sides gives:\n$$ \\frac{[S](t)}{K_M} = W\\left( \\frac{S_0}{K_M} \\exp\\left(\\frac{S_0 - V_{\\text{max}}t}{K_M}\\right) \\right) $$\nThus, the explicit analytic solution for the substrate concentration under the QSSA is:\n$$ [S]_{\\mathrm{QSSA}}(t) = K_M \\cdot W\\left( \\frac{S_0}{K_M} \\exp\\left(\\frac{S_0 - V_{\\text{max}} t}{K_M}\\right) \\right) $$\nwhere $W$ is the principal branch ($k=0$) of the Lambert W function.\n\n### Step 3: Computation of the Difference\n\nFor each test case, we compute two values for the substrate concentration at the specified final time $t$:\n1.  $S_{\\mathrm{ODE}}(t)$: The substrate concentration obtained by numerically integrating the full mass-action ODE system from $t=0$ to the final time.\n2.  $S_{\\mathrm{QSSA}}(t)$: The substrate concentration calculated using the derived analytic formula involving the Lambert W function.\n\nThe final quantity to be reported is the absolute difference between these two values:\n$$ \\Delta S = \\lvert S_{\\mathrm{ODE}}(t) - S_{\\mathrm{QSSA}}(t) \\rvert $$\nThis difference quantifies the error introduced by the Quasi-Steady-State Approximation for the given parameters and time. The QSSA is generally valid when the total enzyme concentration is much smaller than the sum of the substrate concentration and the Michaelis constant ($E_{\\mathrm{tot}} \\ll [S] + K_M$). The test cases are designed to explore regimes where this condition holds and where it is violated.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.special import lambertw\n\ndef solve():\n    \"\"\"\n    Solves the problem by comparing the full mass-action ODE model with the\n    QSSA-derived analytic solution for enzyme kinetics.\n    \"\"\"\n    \n    # Test cases: (k1, k_neg1, k_cat, E_tot, S0, t)\n    test_cases = [\n        # Test case 1 (general regime)\n        (1e6, 10, 100, 1e-7, 1e-4, 5e-2),\n        # Test case 2 (substrate in large excess)\n        (1e6, 10, 100, 1e-7, 1e-3, 1e-2),\n        # Test case 3 (enzyme comparable to substrate, challenging QSSA)\n        (5e5, 2, 20, 1e-5, 2e-6, 2e-2),\n        # Test case 4 (boundary at initial time)\n        (1e6, 1, 50, 5e-8, 5e-5, 0.0),\n    ]\n\n    results = []\n\n    def mass_action_ode(t, y, k1, k_neg1, k_cat, E_tot):\n        \"\"\"\n        Defines the system of ODEs for the full mass-action model.\n        y[0] is substrate concentration [S]\n        y[1] is enzyme-substrate complex concentration [ES]\n        \"\"\"\n        S, ES = y\n        E = E_tot - ES\n        \n        dS_dt = -k1 * E * S + k_neg1 * ES\n        dES_dt = k1 * E * S - (k_neg1 + k_cat) * ES\n        \n        return [dS_dt, dES_dt]\n\n    def qssa_analytic_solution(t, S0, E_tot, k1, k_neg1, k_cat):\n        \"\"\"\n        Calculates the substrate concentration using the analytic solution\n        derived from the QSSA, which involves the Lambert W function.\n        \"\"\"\n        if t == 0:\n            return S0\n\n        Km = (k_neg1 + k_cat) / k1\n        Vmax = k_cat * E_tot\n        \n        # The argument for the Lambert W function\n        # Using np.exp for safe handling of large exponents\n        arg = (S0 / Km) * np.exp((S0 - Vmax * t) / Km)\n        \n        # The lambertw function returns a complex number; we take the real part.\n        # For positive real arguments, the principal branch (k=0) is real.\n        s_qssa = Km * np.real(lambertw(arg, k=0))\n        \n        return s_qssa\n\n    for case in test_cases:\n        k1, k_neg1, k_cat, E_tot, S0, t_final = case\n        \n        # For t=0, the difference is trivially zero as both models start at S0.\n        if t_final == 0:\n            results.append(0.0)\n            continue\n\n        # 1. Numerical solution of the full mass-action ODEs\n        y0 = [S0, 0] # Initial conditions: [S(0), ES(0)]\n        t_span = [0, t_final]\n        \n        # Use a stiff solver with tight tolerances for high accuracy\n        sol = solve_ivp(\n            mass_action_ode, \n            t_span, \n            y0, \n            args=(k1, k_neg1, k_cat, E_tot),\n            method='Radau',\n            dense_output=True,\n            rtol=1e-9, \n            atol=1e-12\n        )\n        \n        S_ode = sol.sol(t_final)[0]\n\n        # 2. Analytic solution from QSSA\n        S_qssa = qssa_analytic_solution(t_final, S0, E_tot, k1, k_neg1, k_cat)\n\n        # 3. Compute absolute difference\n        delta_S = np.abs(S_ode - S_qssa)\n        results.append(delta_S)\n        \n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(f'{r:.18e}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}