{
    "hands_on_practices": [
        {
            "introduction": "This foundational exercise guides you from elementary reaction steps to the operational Michaelis-Menten equation. By applying the Quasi-Steady-State Approximation (QSSA), you will derive the definitions of $K_M$ and $k_{\\text{cat}}$ and use them to assess the validity of an initial-rate experiment . This practice solidifies the connection between microscopic kinetics and the macroscopic parameters used in everyday biochemistry.",
            "id": "2649716",
            "problem": "An enzyme-catalyzed reaction used to benchmark inhibition mechanisms is studied under conditions designed to validate the initial-rate regime in the absence of inhibitor as a control. The elementary mechanism is the two-step binding and catalysis scheme\n$$\nE + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P,\n$$\nwith total enzyme concentration conserved so that $[E]_{0} = [E] + [ES]$. Assume mass-action kinetics, negligible reverse product formation at early times, and that $[S]_{0} \\gg [E]_{0}$. The Quasi-Steady-State Approximation (QSSA) is defined as the assumption that $d[ES]/dt \\approx 0$ over the initial-rate window.\n\nGiven the following physically plausible parameters:\n- Association rate constant $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$,\n- Dissociation rate constant $k_{-1} = 180\\ \\mathrm{s}^{-1}$,\n- Catalytic rate constant $k_{2} = 20\\ \\mathrm{s}^{-1}$,\n- Total enzyme concentration $[E]_{0} = 12\\ \\mathrm{nM}$,\n- Initial substrate concentration $[S]_{0} = 50\\ \\mathrm{\\mu M}$,\n\nperform the following, starting from mass-action rate equations and conservation laws, without invoking any result that has not been derived from these principles:\n\n1) Derive the definitions of the Michaelis constant $K_{M}$ and the catalytic constant $k_{\\text{cat}}$ in terms of $k_{1}$, $k_{-1}$, and $k_{2}$ under the QSSA.\n\n2) Using your derived relations, compute $K_{M}$ (in $\\mathrm{M}$), $k_{\\text{cat}}$ (in $\\mathrm{s}^{-1}$), and the initial velocity $v_{0}$ (in $\\mathrm{M}\\ \\mathrm{s}^{-1}$) at $t=0$.\n\n3) Using the stoichiometry $S \\to P$ and assuming the initial velocity remains approximately constant over the first $5$ s, estimate the fraction of substrate depleted after $5$ s as a unitless decimal fraction. Based on this fraction, assess whether the initial-rate approximation remains valid over $5$ s by comparing the fraction to a conservative small-change criterion (for example, less than $0.05$).\n\nRound your final reported fraction in part $3$ to four significant figures. Express the final answer as a unitless decimal fraction. Report only this final fraction as your answer.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n-   Mechanism: $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$\n-   Conservation Law: $[E]_{0} = [E] + [ES]$\n-   Assumptions: Mass-action kinetics, negligible reverse product formation, $[S]_{0} \\gg [E]_{0}$, Quasi-Steady-State Approximation (QSSA) $d[ES]/dt \\approx 0$.\n-   Parameters:\n    -   $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n    -   $k_{-1} = 180\\ \\mathrm{s}^{-1}$\n    -   $k_{2} = 20\\ \\mathrm{s}^{-1}$\n    -   $[E]_{0} = 12\\ \\mathrm{nM}$\n    -   $[S]_{0} = 50\\ \\mathrm{\\mu M}$\n\n**Step 2: Validation Using Extracted Givens**\nThe problem presents a standard scenario in enzyme kinetics, based on the Briggs-Haldane treatment of the Michaelis-Menten mechanism.\n-   **Scientifically Grounded:** The problem is based on fundamental principles of chemical kinetics, specifically the law of mass action and the quasi-steady-state approximation. All concepts are central to physical chemistry and biochemistry.\n-   **Well-Posed:** The problem is clearly defined, with all necessary parameters and assumptions provided to derive a unique solution for the requested quantities. The condition $[S]_{0} \\gg [E]_{0}$ is satisfied, as $50 \\times 10^{-6}\\ \\mathrm{M} \\gg 12 \\times 10^{-9}\\ \\mathrm{M}$.\n-   **Objective:** The language is precise and quantitative, free of any subjective or ambiguous terminology.\n-   **Completeness and Consistency:** The data are sufficient and consistent. The units of the rate constants and concentrations are appropriate and dimensionally consistent for the calculations required.\n-   **Plausibility:** The provided kinetic parameters and concentrations are physically realistic for enzyme systems.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a well-posed, scientifically sound problem that can be solved from first principles as requested. The solution proceeds.\n\nThe solution is constructed in three parts as required by the problem statement.\n\n**Part 1: Derivation of $K_M$ and $k_{\\text{cat}}$**\n\nThe rate of change of the enzyme-substrate complex concentration, $[ES]$, is described by the law of mass action applied to the given mechanism:\n$$\n\\frac{d[ES]}{dt} = k_{1}[E][S] - k_{-1}[ES] - k_{2}[ES] = k_{1}[E][S] - (k_{-1} + k_{2})[ES]\n$$\nThe velocity of the reaction, $v$, is the rate of formation of the product, $P$:\n$$\nv = \\frac{d[P]}{dt} = k_{2}[ES]\n$$\nThe Quasi-Steady-State Approximation (QSSA) assumes that the concentration of the intermediate complex $[ES]$ remains nearly constant over the time scale of the initial rate measurement, meaning $\\frac{d[ES]}{dt} \\approx 0$. Applying this approximation to the rate equation for $[ES]$ gives:\n$$\nk_{1}[E][S] \\approx (k_{-1} + k_{2})[ES]\n$$\nThe total enzyme concentration $[E]_{0}$ is conserved: $[E]_{0} = [E] + [ES]$. This allows us to express the concentration of free enzyme, $[E]$, as $[E] = [E]_{0} - [ES]$. Substituting this into the steady-state equation yields:\n$$\nk_{1}([E]_{0} - [ES])[S] \\approx (k_{-1} + k_{2})[ES]\n$$\nWe rearrange this expression to solve for $[ES]$:\n$$\nk_{1}[E]_{0}[S] - k_{1}[ES][S] \\approx (k_{-1} + k_{2})[ES]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx (k_{-1} + k_{2})[ES] + k_{1}[ES][S]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx [ES]((k_{-1} + k_{2}) + k_{1}[S])\n$$\n$$\n[ES] \\approx \\frac{k_{1}[E]_{0}[S]}{(k_{-1} + k_{2}) + k_{1}[S]}\n$$\nTo obtain the standard form of the rate law, we divide the numerator and denominator by $k_{1}$:\n$$\n[ES] \\approx \\frac{[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\nNow, substitute this expression for $[ES]$ back into the equation for the reaction velocity $v$:\n$$\nv = k_{2}[ES] \\approx \\frac{k_{2}[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\nThis equation is the Michaelis-Menten rate law, which is conventionally written as $v = \\frac{k_{\\text{cat}}[E]_{0}[S]}{K_{M} + [S]}$. By direct comparison of the derived equation with the standard form, we identify the definitions of the catalytic constant $k_{\\text{cat}}$ and the Michaelis constant $K_{M}$:\n$$\nk_{\\text{cat}} = k_{2}\n$$\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}}\n$$\nThis completes the derivation.\n\n**Part 2: Calculation of $K_{M}$, $k_{\\text{cat}}$, and $v_{0}$**\n\nUsing the given parameter values:\n-   $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n-   $k_{-1} = 180\\ \\mathrm{s}^{-1}$\n-   $k_{2} = 20\\ \\mathrm{s}^{-1}$\n-   $[E]_{0} = 12\\ \\mathrm{nM} = 1.2 \\times 10^{-8}\\ \\mathrm{M}$\n-   $[S]_{0} = 50\\ \\mathrm{\\mu M} = 5.0 \\times 10^{-5}\\ \\mathrm{M}$\n\nWe compute $k_{\\text{cat}}$:\n$$\nk_{\\text{cat}} = k_{2} = 20\\ \\mathrm{s}^{-1}\n$$\nNext, we compute $K_{M}$:\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}} = \\frac{180\\ \\mathrm{s}^{-1} + 20\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}} = \\frac{200\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}}\n$$\n$$\nK_{M} = \\frac{2}{1.2} \\times 10^{-5}\\ \\mathrm{M} = \\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M} \\approx 1.67 \\times 10^{-5}\\ \\mathrm{M}\n$$\nThe initial velocity $v_{0}$ is the velocity at $t=0$, where $[S] = [S]_{0}$. We use the derived rate law:\n$$\nv_{0} = \\frac{k_{\\text{cat}}[E]_{0}[S]_{0}}{K_{M} + [S]_{0}}\n$$\nSubstituting the numerical values:\n$$\nv_{0} = \\frac{(20\\ \\mathrm{s}^{-1})(1.2 \\times 10^{-8}\\ \\mathrm{M})(5.0 \\times 10^{-5}\\ \\mathrm{M})}{(\\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M}) + (5.0 \\times 10^{-5}\\ \\mathrm{M})}\n$$\nThe numerator is:\n$$\n(20)(1.2 \\times 10^{-8})(5.0 \\times 10^{-5})\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 120 \\times 10^{-13}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}\n$$\nThe denominator is:\n$$\n\\left(\\frac{5}{3} + 5\\right) \\times 10^{-5}\\ \\mathrm{M} = \\left(\\frac{5}{3} + \\frac{15}{3}\\right) \\times 10^{-5}\\ \\mathrm{M} = \\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}\n$$\nThus, the initial velocity is:\n$$\nv_{0} = \\frac{1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}}{\\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}} = \\frac{1.2 \\times 3}{20} \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 0.18 \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}\n$$\n\n**Part 3: Substrate Depletion and Validity Assessment**\n\nThe initial-rate approximation assumes that the velocity $v \\approx v_{0}$ for a short time interval $\\Delta t$. The velocity is related to substrate depletion by $v = -\\frac{d[S]}{dt}$. If $v$ is constant, the amount of substrate consumed over $\\Delta t$ is $|\\Delta[S]| \\approx v_{0} \\Delta t$.\nGiven $\\Delta t = 5\\ \\mathrm{s}$:\n$$\n|\\Delta[S]| \\approx (1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}) \\times (5\\ \\mathrm{s}) = 9.0 \\times 10^{-7}\\ \\mathrm{M}\n$$\nThe fraction of substrate depleted is the ratio of substrate consumed to the initial substrate concentration, $[S]_{0}$:\n$$\n\\text{Fraction depleted} = \\frac{|\\Delta[S]|}{[S]_{0}} \\approx \\frac{v_{0} \\Delta t}{[S]_{0}}\n$$\nSubstituting the values:\n$$\n\\text{Fraction depleted} \\approx \\frac{9.0 \\times 10^{-7}\\ \\mathrm{M}}{5.0 \\times 10^{-5}\\ \\mathrm{M}} = \\frac{9.0}{500} = \\frac{1.8}{100} = 0.018\n$$\nThe problem asks for this fraction to be reported to four significant figures. Thus, the fraction is $0.01800$.\nTo assess the validity of the initial-rate approximation, we compare this fraction to the criterion of being less than $0.05$. Since $0.01800 < 0.05$, the depletion of substrate is approximately $1.8\\%$, which is well within the acceptable limit for the initial-rate assumption to be valid over the $5\\ \\mathrm{s}$ interval. The concentration of substrate does not change sufficiently to cause a significant deviation from the initial velocity.\n\nThe final answer is the unitless decimal fraction of substrate depleted, rounded to four significant figures.",
            "answer": "$$\\boxed{0.01800}$$"
        },
        {
            "introduction": "The Quasi-Steady-State Approximation is a cornerstone of enzyme kinetics, but when is it truly justified? This computational practice has you derive the mathematical condition for QSSA validity through a rigorous timescale analysis . By implementing both the full and approximate models, you will numerically quantify the error introduced by the QSSA and gain a deep, practical understanding of its limitations.",
            "id": "3306344",
            "problem": "Consider an enzyme-catalyzed reaction governed by the Law of Mass Action: an enzyme $E$ binds a substrate $S$ to form a complex $ES$, which then releases product $P$ while regenerating $E$. The elementary reaction scheme is $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$. The total enzyme concentration is conserved, so $[E](t) + [ES](t) = [E]_0$. The Michaelis constant is defined as $K_m = \\frac{k_{-1} + k_{2}}{k_{1}}$. Define the small parameter $\\epsilon = \\frac{[E]_0}{K_m + [S]_0}$.\n\nYour tasks are:\n1. Starting from the Law of Mass Action and the conservation of total enzyme, perform a timescale analysis to derive a condition under which the quasi-steady-state approximation (QSSA) is valid. Express this condition in terms of the small parameter $\\epsilon$ and the relative magnitude of $k_{2}$ to $k_{-1}$, without invoking any pre-specified target formulas beyond the given definitions. Your derivation must justify why the derived condition captures the separation of timescales between the fast transient to form $ES$ and the slower substrate consumption producing $P$.\n2. Implement a program that, for each specified parameter set, computes:\n   - The exact solution by numerically integrating the full mass-action system for $( [S](t), [ES](t), [P](t) )$ using the reduced dimensionality $[E](t) = [E]_0 - [ES](t)$.\n   - The QSSA solution by numerically integrating the reduced substrate-product dynamics where the rate law $v(t)$ depends only on $[S](t)$ and constants and uses enzyme conservation consistently.\n   - The timescale ratio $r$ obtained from your derivation in Task $1$.\n   - A boolean validity indicator that is $true$ when the timescale separation condition is satisfied using the numerical threshold $r < 0.1$ and $false$ otherwise.\n   - A quantitative error defined as the maximum of the absolute difference between the exact and QSSA product trajectories, normalized by the exact final product at the end time: $\\max_{t \\in [0,T_{\\text{end}}]} \\frac{|[P]_{\\text{exact}}(t) - [P]_{\\text{QSSA}}(t)|}{\\max([P]_{\\text{exact}}(T_{\\text{end}}), \\delta)}$, with a small regularization constant $\\delta = 10^{-12}$ expressed as a pure number (unitless).\n\nAll concentrations must be expressed in millimolar (mM) and time in seconds (s). The error is a dimensionless float; do not use a percentage sign. Use $N = 1000$ equally spaced sample points for evaluating the trajectories and computing the error over time. For numerical integration, use methods appropriate for potentially stiff systems.\n\nUse the following test suite of parameter values. Each test case is a tuple $(k_1, k_{-1}, k_2, [E]_0, [S]_0, T_{\\text{end}})$ where $k_1$ has units $\\text{mM}^{-1}\\,\\text{s}^{-1}$, $k_{-1}$ and $k_2$ have units $\\text{s}^{-1}$, $[E]_0$ and $[S]_0$ have units $\\text{mM}$, and $T_{\\text{end}}$ has units $\\text{s}$:\n- Test Case $1$: $(1000, 1, 1, 0.005, 1.0, 50)$.\n- Test Case $2$: $(1000, 0.5, 5, 0.05, 0.2, 5)$.\n- Test Case $3$: $(1000, 0.5, 50, 0.005, 0.01, 1)$.\n- Test Case $4$: $(1000, 0.1, 100, 0.2, 0.05, 0.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of three elements $[ \\text{error}, r, \\text{valid} ]$. For example, the output format must be exactly like $[[e_1,r_1,v_1],[e_2,r_2,v_2],\\ldots]$, where each $e_i$ and $r_i$ is a float and each $v_i$ is a boolean.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of enzyme kinetics, is mathematically well-posed, and is defined with objective, precise language. All necessary parameters and conditions for a unique solution are provided. We will proceed with the derivation and implementation.\n\nThe kinetics of the enzyme-catalyzed reaction $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$ are described by a set of ordinary differential equations (ODEs) derived from the Law of Mass Action. Let the concentrations of the species be denoted by $[S](t)$, $[E](t)$, $[ES](t)$, and $[P](t)$. The ODE system is:\n$$ \\frac{d[S]}{dt} = -k_1 [E](t) [S](t) + k_{-1} [ES](t) $$\n$$ \\frac{d[E]}{dt} = -k_1 [E](t) [S](t) + (k_{-1} + k_2) [ES](t) $$\n$$ \\frac{d[ES]}{dt} = k_1 [E](t) [S](t) - (k_{-1} + k_2) [ES](t) $$\n$$ \\frac{d[P]}{dt} = k_2 [ES](t) $$\nThe total enzyme concentration is conserved: $[E](t) + [ES](t) = [E]_0$. Using this, we can eliminate $[E](t) = [E]_0 - [ES](t)$ and reduce the system. The dynamics of the substrate $[S]$ and the enzyme-substrate complex $[ES]$ are governed by:\n$$ \\frac{d[S]}{dt} = -k_1 ([E]_0 - [ES](t)) [S](t) + k_{-1} [ES](t) $$\n$$ \\frac{d[ES]}{dt} = k_1 ([E]_0 - [ES](t)) [S](t) - (k_{-1} + k_2) [ES](t) $$\nThe initial conditions at $t=0$ are $[S](0) = [S]_0$, $[ES](0) = 0$, $[E](0) = [E]_0$, and $[P](0) = 0$.\n\n### Task 1: Timescale Analysis and Quasi-Steady-State Approximation (QSSA) Validity\n\nThe QSSA is valid when the concentration of the intermediate complex, $[ES]$, equilibrates to a pseudo-steady-state value on a timescale that is much faster than the timescale on which the substrate concentration, $[S]$, changes. This separation of timescales allows us to approximate the differential equation for $[ES]$ with an algebraic equation.\n\nLet's derive the two relevant timescales.\n\n**1. Fast Timescale of Complex Formation ($\\tau_c$)**\nThe dynamics of the complex $[ES]$ are described by the ODE:\n$$ \\frac{d[ES]}{dt} = k_1 [E]_0 [S](t) - (k_1 [S](t) + k_{-1} + k_2) [ES](t) $$\nFor a given (momentarily fixed) substrate concentration $[S]$, this is a linear first-order ODE for $[ES]$. The solution approaches its steady state, $[ES]_{qss} = \\frac{k_1 [E]_0 [S]}{k_1 [S] + k_{-1} + k_2}$, with a characteristic relaxation time, which we identify as the fast timescale $\\tau_c$:\n$$ \\tau_c([S]) = \\frac{1}{k_1 [S](t) + k_{-1} + k_2} $$\nUsing the definition of the Michaelis constant, $K_m = \\frac{k_{-1} + k_2}{k_1}$, we can rewrite this as:\n$$ \\tau_c([S]) = \\frac{1}{k_1([S](t) + K_m)} $$\n\n**2. Slow Timescale of Substrate Consumption ($\\tau_s$)**\nThe QSSA assumes that $d[ES]/dt \\approx 0$, which implies that $[ES](t)$ is always near its quasi-steady-state value:\n$$ [ES]_{qss}(t) = \\frac{[E]_0 [S](t)}{[S](t) + K_m} $$\nUnder this approximation, the rate of product formation, or velocity $v(t)$, is $v(t) = k_2 [ES]_{qss}(t)$, and the rate of substrate consumption is $\\frac{d[S]}{dt} = -v(t)$. This gives the well-known Michaelis-Menten equation:\n$$ \\frac{d[S]}{dt} = -\\frac{k_2 [E]_0 [S](t)}{[S](t) + K_m} $$\nThe characteristic time for the change in substrate concentration can be estimated as $\\tau_s \\approx |[S] / \\frac{d[S]}{dt}|$.\n$$ \\tau_s([S]) = \\left| \\frac{[S](t)}{-\\frac{k_2 [E]_0 [S](t)}{[S](t) + K_m}} \\right| = \\frac{[S](t) + K_m}{k_2 [E]_0} $$\n\n**3. Validity Condition**\nThe QSSA is valid if the fast dynamics of $[ES]$ are much faster than the slow dynamics of $[S]$, i.e., $\\tau_c \\ll \\tau_s$. We define a dimensionless timescale ratio, $r$, to quantify this condition:\n$$ r = \\frac{\\tau_c}{\\tau_s} = \\frac{1 / (k_1([S] + K_m))}{( [S] + K_m) / (k_2 [E]_0)} = \\frac{k_2 [E]_0}{k_1([S] + K_m)^2} $$\nThe validity of the QSSA depends on the concentration of the substrate $[S]$, and the condition is typically most restrictive at the beginning of the reaction. We therefore evaluate $r$ at $t=0$, where $[S](0) = [S]_0$:\n$$ r = \\frac{k_2 [E]_0}{k_1([S]_0 + K_m)^2} $$\nThe condition for the QSSA to be valid is $r \\ll 1$. This derivation explicitly justifies the separation of timescales by comparing the relaxation time of the enzyme-substrate complex to the characteristic time of substrate depletion. The smallness of $r$ ensures that $[ES](t)$ can rapidly adjust and track its quasi-steady-state value, $[ES]_{qss}$, which changes slowly as $[S](t)$ is consumed.\n\nThe problem asks to express this condition using $\\epsilon = \\frac{[E]_0}{K_m + [S]_0}$. We can rewrite $r$ as:\n$$ r = \\left(\\frac{[E]_0}{K_m + [S]_0}\\right) \\frac{k_2}{k_1(K_m + [S]_0)} = \\epsilon \\frac{k_2}{k_1(K_m + [S]_0)} $$\nSubstituting $K_m = (k_{-1} + k_2)/k_1$:\n$$ r = \\epsilon \\frac{k_2}{k_1(\\frac{k_{-1}+k_2}{k_1} + [S]_0)} = \\epsilon \\frac{k_2}{k_{-1}+k_2+k_1[S]_0} $$\nThis expression involves $\\epsilon$ and other parameters, including the ratio of $k_2$ to $k_{-1}$ implicitly. For computation, we will use the formula $r = \\frac{k_2 [E]_0}{k_1([S]_0 + K_m)^2}$.\n\n### Task 2: Algorithmic Implementation\n\n**Exact Solution:** We numerically integrate the full system of two coupled ODEs for the state vector $\\vec{y}(t) = ([S](t), [ES](t))$:\n$$ \\frac{d[S]}{dt} = -k_1 ([E]_0 - [ES])[S] + k_{-1}[ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 ([E]_0 - [ES])[S] - (k_{-1} + k_2)[ES] $$\nwith initial conditions $\\vec{y}(0) = ([S]_0, 0)$. Since enzyme kinetic systems can be stiff, we use an appropriate numerical integrator, such as `Radau` or `BDF` from `scipy.integrate.solve_ivp`. The product concentration is then recovered from mass conservation: $[P]_{\\text{exact}}(t) = [S]_0 - [S]_{\\text{exact}}(t) - [ES]_{\\text{exact}}(t)$.\n\n**QSSA Solution:** We numerically integrate the reduced one-dimensional Michaelis-Menten ODE for $[S](t)$:\n$$ \\frac{d[S]}{dt} = -\\frac{k_2 [E]_0 [S]}{K_m + [S]} $$\nwith the initial condition $[S](0) = [S]_0$. The product concentration is recovered by mass balance, $[P]_{QSSA}(t) = [S]_0 - [S]_{QSSA}(t)$, since the QSSA assumes $[ES](t)$ is negligible compared to $[S](t)$.\n\n**Calculations:**\nFor each test case, we perform the following steps:\n1.  Calculate $K_m = (k_{-1} + k_2) / k_1$.\n2.  Numerically solve the exact and QSSA systems over the interval $[0, T_{\\text{end}}]$ at $N=1000$ points.\n3.  Calculate the trajectories $[P]_{\\text{exact}}(t)$ and $[P]_{QSSA}(t)$.\n4.  Compute the timescale ratio $r = \\frac{k_2 [E]_0}{k_1([S]_0 + K_m)^2}$.\n5.  Set the validity indicator: `valid` is `true` if $r < 0.1$, and `false` otherwise.\n6.  Compute the normalized error: $Error = \\max_{t \\in [0,T_{\\text{end}}]} \\frac{|[P]_{\\text{exact}}(t) - [P]_{QSSA}(t)|}{\\max([P]_{\\text{exact}}(T_{\\text{end}}), \\delta)}$, with $\\delta = 10^{-12}$.\n7.  Collect the results $[\\text{Error}, r, \\text{valid}]$ for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nimport json\n\ndef solve():\n    \"\"\"\n    Solves the enzyme kinetics problem for a suite of test cases.\n    For each case, it computes the exact and QSSA solutions, the timescale ratio 'r',\n    the validity of the QSSA, and the normalized error between the two solutions.\n    \"\"\"\n    \n    # Test cases: (k1, k_1, k2, E0, S0, T_end)\n    test_cases = [\n        (1000.0, 1.0, 1.0, 0.005, 1.0, 50.0),\n        (1000.0, 0.5, 5.0, 0.05, 0.2, 5.0),\n        (1000.0, 0.5, 50.0, 0.005, 0.01, 1.0),\n        (1000.0, 0.1, 100.0, 0.2, 0.05, 0.05),\n    ]\n\n    # Numerical parameters\n    N_POINTS = 1000\n    DELTA = 1e-12\n\n    results = []\n\n    for case in test_cases:\n        k1, k_neg1, k2, E0, S0, T_end = case\n\n        # --- 1. Compute constants ---\n        Km = (k_neg1 + k2) / k1\n\n        # --- 2. Solve the exact (full) system ---\n        def full_system(t, y, k1, k_neg1, k2, E0):\n            S, ES = y\n            E = E0 - ES\n            dS_dt = -k1 * E * S + k_neg1 * ES\n            dES_dt = k1 * E * S - (k_neg1 + k2) * ES\n            return [dS_dt, dES_dt]\n\n        t_span = [0, T_end]\n        t_eval = np.linspace(t_span[0], t_span[1], N_POINTS)\n        y0_full = [S0, 0.0]\n\n        sol_exact = solve_ivp(\n            full_system,\n            t_span,\n            y0_full,\n            method='Radau',\n            t_eval=t_eval,\n            args=(k1, k_neg1, k2, E0),\n            rtol=1e-8,\n            atol=1e-11\n        )\n        \n        S_exact = sol_exact.y[0, :]\n        ES_exact = sol_exact.y[1, :]\n        # P_exact from mass balance: S0 + E0 = S + E + ES + P\n        # and E0 = E + ES, so S0 = S + ES + P\n        P_exact = S0 - S_exact - ES_exact\n        # Ensure P_exact does not become negative due to numerical noise\n        P_exact = np.maximum(P_exact, 0)\n        \n        # --- 3. Solve the QSSA (reduced) system ---\n        Vmax = k2 * E0\n        def qssa_system(t, y, Vmax, Km):\n            S = y[0]\n            dS_dt = -Vmax * S / (Km + S)\n            return [dS_dt]\n\n        y0_qssa = [S0]\n        \n        sol_qssa = solve_ivp(\n            qssa_system,\n            t_span,\n            y0_qssa,\n            method='Radau',\n            t_eval=t_eval,\n            args=(Vmax, Km),\n            rtol=1e-8,\n            atol=1e-11\n        )\n\n        S_qssa = sol_qssa.y[0,:]\n        # P_qssa from mass balance: S0 = S + P (since ES is assumed negligible)\n        P_qssa = S0 - S_qssa\n\n        # --- 4. Calculate timescale ratio r and validity ---\n        r = (k2 * E0) / (k1 * (S0 + Km)**2)\n        valid = r < 0.1\n\n        # --- 5. Calculate quantitative error ---\n        abs_diff_P = np.abs(P_exact - P_qssa)\n        max_abs_diff = np.max(abs_diff_P)\n        \n        # Denominator for normalization\n        normalization_factor = max(P_exact[-1], DELTA)\n        \n        error = max_abs_diff / normalization_factor\n\n        results.append([error, r, valid])\n\n    # --- 6. Format and print the final output ---\n    # Use json.dumps to handle boolean and float formatting, then adjust for exact format\n    # The problem requires 'true'/'false' instead of 'True'/'False'\n    formatted_results = []\n    for res in results:\n        err_str = f\"{res[0]:.6g}\"  # Scientific notation for small numbers, float for others\n        r_str = f\"{res[1]:.6g}\"\n        valid_str = str(res[2]).lower()\n        formatted_results.append(f\"[{err_str},{r_str},{valid_str}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In biomedical research, models are tools for designing experiments and interpreting data. This capstone practice immerses you in this process by combining kinetic theory with statistical methods for D-optimal experimental design and model selection using the Akaike Information Criterion (AIC) . You will generate synthetic noisy data and then determine whether the simplified Michaelis-Menten model or the full mechanistic model provides a better explanation, a crucial skill in systems modeling.",
            "id": "3901792",
            "problem": "A single-substrate, single-enzyme reaction is described by the elementary mechanism of enzyme-substrate complex formation and turnover under the Law of Mass Action: $$E + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P,$$ where $[E]$ denotes free enzyme concentration, $[S]$ denotes substrate concentration, $[ES]$ denotes the enzyme-substrate complex concentration, and $[P]$ denotes product concentration. The rate constants are $k_1$ in $\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$, $k_{-1}$ in $\\mathrm{s}^{-1}$, and $k_2$ in $\\mathrm{s}^{-1}$. Let the initial conditions be $[E](0)=E_0$ in $\\mu\\mathrm{M}$, $[S](0)=S_0$ in $\\mu\\mathrm{M}$, $[ES](0)=0$ in $\\mu\\mathrm{M}$, and $[P](0)=0$ in $\\mu\\mathrm{M}$. The time evolution under the Law of Mass Action is governed by the ordinary differential equations\n$$\\frac{d[E]}{dt}=-k_1[E][S] + (k_{-1}+k_2)[ES],\\quad \\frac{d[S]}{dt}=-k_1[E][S] + k_{-1}[ES],\\quad \\frac{d[ES]}{dt}=k_1[E][S] - (k_{-1}+k_2)[ES],\\quad \\frac{d[P]}{dt}=k_2 [ES],$$\nsubject to the conservation law $[E](t)+[ES](t)=E_0$ for all $t\\ge 0$. An initial-rate experiment measures $\\frac{d[P]}{dt}$ at steady initial conditions by varying substrate concentrations and assumes additive Gaussian noise with constant variance. A progress-curve experiment measures $[P](t)$ at specified time points and also assumes additive Gaussian noise with a known variance.\n\nYour tasks combine experimental design and model validation for the quasi-steady-state theory of Briggs and Haldane and the reduced Michaelis-Menten description in the context of biomedical systems modeling. Starting from the Law of Mass Action and conservation relationships, you must derive the reduced two-parameter initial-rate model under a well-justified approximation and construct its Fisher Information for experimental design. You must also fit both the reduced model and the full mechanistic model to noisy progress-curve data to assess model adequacy using a rigorously defined information criterion.\n\nPrecisely:\n\n1. Using only first principles (the Law of Mass Action and algebraic conservation), derive an initial-rate expression in terms of two lumped parameters obtained under the quasi-steady-state approximation for the intermediate complex. Define these two parameters and explain how they arise from the rate constants and the initial enzyme concentration $E_0$. Do not introduce any formula as an assumption; justify the approximation and derivation.\n\n2. Consider an initial-rate experimental design where you may choose $4$ substrate concentrations $S$ from a fixed candidate set, and each chosen concentration is measured once. Assume the initial-rate measurements have independent, identically distributed Gaussian noise with variance $\\sigma_v^2$ (in $(\\mu\\mathrm{M}/\\mathrm{s})^2$) and that the reduced initial-rate model derived in Task 1 is locally linearizable for the purpose of constructing the Fisher Information Matrix. Construct the Fisher Information Matrix $\\mathcal{I}(\\theta)$ for the two parameters and select the $4$-point design that maximizes $\\det\\mathcal{I}(\\theta)$ (\"D-optimality\"). Use the nominal parameter values implied by the true mechanistic parameters of the test case to evaluate $\\mathcal{I}(\\theta)$.\n\n3. Generate synthetic progress-curve product data $[P](t)$ for each test case by numerically integrating the full mechanistic Law of Mass Action system with the given parameters and initial conditions, and add independent, identically distributed Gaussian noise with the specified variance $\\sigma_P^2$ (in $\\mu\\mathrm{M}^2$). Fit two competing models to these noisy data by nonlinear least squares: (a) the reduced two-parameter progress-curve model implied by the derivation in Task 1, and (b) the full mechanistic model with unknown $k_1$, $k_{-1}$, and $k_2$. For each fit, compute the Akaike Information Criterion (AIC), defined as $$\\mathrm{AIC}=n\\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right)+2p,$$ where $n$ is the number of time points, $\\mathrm{RSS}$ is the residual sum of squares, and $p$ is the number of fitted parameters. Select the model with the lower AIC.\n\n4. Implementation constraints: All numerical integration must be performed in seconds, concentrations in $\\mu\\mathrm{M}$, and rates in $\\mu\\mathrm{M}/\\mathrm{s}$. The Gaussian noise must be generated with a fixed seed for reproducibility. The nonlinear least squares must enforce positivity of parameters. Your derived reduced model must be the only source of any formulas used for initial-rate design and progress-curve fitting.\n\nTest suite and parameters:\n- Case A (happy path quasi-steady-state): $k_1=1.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$, $k_{-1}=10.0\\,\\mathrm{s}^{-1}$, $k_2=2.0\\,\\mathrm{s}^{-1}$, $E_0=0.1\\,\\mu\\mathrm{M}$, $S_0=100.0\\,\\mu\\mathrm{M}$. Initial-rate candidate set (all in $\\mu\\mathrm{M}$): $\\{2,5,10,20,50,100,200,500,1000,2000\\}$. Initial-rate noise variance $\\sigma_v^2=(0.02)^2$. Progress-curve time points $t\\in\\{0.1,0.2,0.5,1.0,2.0,5.0\\}$ seconds. Progress-curve noise variance $\\sigma_P^2=(0.5)^2$.\n- Case B (quasi-steady-state violation due to high enzyme): $k_1=1.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$, $k_{-1}=1.0\\,\\mathrm{s}^{-1}$, $k_2=50.0\\,\\mathrm{s}^{-1}$, $E_0=50.0\\,\\mu\\mathrm{M}$, $S_0=100.0\\,\\mu\\mathrm{M}$. Candidate set identical to Case A. Initial-rate noise variance $\\sigma_v^2=(0.5)^2$. Progress-curve time points $t\\in\\{0.01,0.02,0.05,0.1,0.2,0.5\\}$ seconds. Progress-curve noise variance $\\sigma_P^2=(2.0)^2$.\n- Case C (pre-steady-state and low substrate): $k_1=0.1\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$, $k_{-1}=0.01\\,\\mathrm{s}^{-1}$, $k_2=5.0\\,\\mathrm{s}^{-1}$, $E_0=1.0\\,\\mu\\mathrm{M}$, $S_0=5.0\\,\\mu\\mathrm{M}$. Candidate set identical to Case A. Initial-rate noise variance $\\sigma_v^2=(0.1)^2$. Progress-curve time points $t\\in\\{0.02,0.05,0.1,0.2,0.5,1.0\\}$ seconds. Progress-curve noise variance $\\sigma_P^2=(0.2)^2$.\n\nFinal output format:\nYour program should produce a single line of output containing all results aggregated as a comma-separated list enclosed in square brackets. For each test case, output the four selected substrate concentrations in $\\mu\\mathrm{M}$ (as floats) followed by an integer model-choice indicator, where $0$ indicates the reduced two-parameter model is preferred and $1$ indicates the full mechanistic model is preferred. Thus, with three test cases, the output should contain $15$ comma-separated entries in the order Case A, then Case B, then Case C (e.g., \"[S1,S2,S3,S4,mA,S1,S2,S3,S4,mB,S1,S2,S3,S4,mC]\").",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and complete. It describes a standard but comprehensive exercise in enzyme kinetics modeling, combining theoretical derivation, optimal experimental design, and statistical model selection. I will now proceed with the solution.\n\nThe solution is presented in three parts, corresponding to the main tasks requested.\n\n### Task 1: Derivation of the Reduced Initial-Rate Model\n\nThe starting point is the full mechanistic model for a single-substrate enzyme reaction, governed by the Law of Mass Action. The elementary steps are:\n$$E + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P$$\nThe time evolution of the concentrations of the chemical species is described by a system of ordinary differential equations (ODEs):\n$$\n\\begin{align*}\n\\frac{d[E]}{dt} &= -k_1[E][S] + k_{-1}[ES] + k_2[ES] \\\\\n\\frac{d[S]}{dt} &= -k_1[E][S] + k_{-1}[ES] \\\\\n\\frac{d[ES]}{dt} &= k_1[E][S] - (k_{-1}+k_2)[ES] \\\\\n\\frac{d[P]}{dt} &= k_2[ES]\n\\end{align*}\n$$\nHere, $[E]$, $[S]$, $[ES]$, and $[P]$ represent the concentrations of free enzyme, substrate, enzyme-substrate complex, and product, respectively. The total enzyme concentration is conserved:\n$$[E](t) + [ES](t) = E_0$$\nwhere $E_0$ is the initial total enzyme concentration. This conservation law allows us to eliminate $[E]$ from the system: $[E] = E_0 - [ES]$.\n\nThe Briggs-Haldane quasi-steady-state approximation (QSSA) is now applied. This approximation assumes that after a very brief initial transient phase, the concentration of the intermediate enzyme-substrate complex $[ES]$ becomes nearly constant, i.e., its rate of change is approximately zero:\n$$\\frac{d[ES]}{dt} \\approx 0$$\nThis approximation is physically justified when the concentration of the enzyme is much smaller than the sum of the substrate concentration and the Michaelis constant ($E_0 \\ll [S_0] + K_M$), ensuring that the formation and breakdown of the complex quickly reach a balance.\n\nSetting the ODE for $[ES]$ to zero gives an algebraic equation:\n$$k_1[E][S] - (k_{-1}+k_2)[ES] \\approx 0$$\nSubstituting the conservation law, $[E] = E_0 - [ES]$, into this equation yields:\n$$k_1(E_0 - [ES])[S] - (k_{-1}+k_2)[ES] \\approx 0$$\nWe can now solve for the quasi-steady-state concentration of the complex, $[ES]_{qssa}$:\n$$k_1 E_0 [S] - k_1 [ES][S] \\approx (k_{-1}+k_2)[ES]$$\n$$k_1 E_0 [S] \\approx [ES](k_1[S] + k_{-1} + k_2)$$\n$$[ES]_{qssa} \\approx \\frac{k_1 E_0 [S]}{k_1[S] + k_{-1} + k_2}$$\nTo express this in a more standard form, we divide the numerator and denominator by $k_1$:\n$$[ES]_{qssa} \\approx \\frac{E_0 [S]}{[S] + \\frac{k_{-1}+k_2}{k_1}}$$\nThe initial rate of product formation, $v_0$, is given by $v_0 = \\left(\\frac{d[P]}{dt}\\right)_{t \\approx 0} = k_2[ES]_{qssa}$. For an initial-rate experiment, $[S]$ is taken as the initial substrate concentration, which we will denote simply as $S$. Substituting the expression for $[ES]_{qssa}$:\n$$v_0(S) = \\frac{k_2 E_0 S}{S + \\frac{k_{-1}+k_2}{k_1}}$$\nThis is the celebrated Michaelis-Menten equation. The problem requires its expression in terms of two lumped parameters. These parameters are defined as follows:\n\n1.  **Maximum Velocity ($V_{\\max}$)**: This is the theoretical maximum rate of the reaction, achieved when the enzyme is fully saturated with substrate ($S \\to \\infty$). In this limit, $[ES] \\to E_0$, and the rate becomes $k_2 E_0$.\n    $$V_{\\max} = k_2 E_0$$\n    Its units are concentration per time (e.g., $\\mu\\mathrm{M}/\\mathrm{s}$).\n\n2.  **Michaelis Constant ($K_M$)**: This is the substrate concentration at which the reaction rate is half of $V_{\\max}$. It represents the affinity of the enzyme for its substrate under the Briggs-Haldane assumptions.\n    $$K_M = \\frac{k_{-1}+k_2}{k_1}$$\n    Its units are concentration (e.g., $\\mu\\mathrm{M}$).\n\nUsing these two lumped parameters, the reduced initial-rate model is:\n$$v(S; V_{\\max}, K_M) = \\frac{V_{\\max} S}{K_M + S}$$\n\n### Task 2: D-Optimal Experimental Design\n\nFor an initial-rate experiment measuring the rate $v$ at $N$ different substrate concentrations $\\{S_1, \\dots, S_N\\}$, where the measurements are corrupted by additive i.i.d. Gaussian noise with variance $\\sigma_v^2$, the Fisher Information Matrix (FIM) for the parameters $\\theta = [V_{\\max}, K_M]^T$ is given by:\n$$\\mathcal{I}(\\theta) = \\frac{1}{\\sigma_v^2} \\sum_{i=1}^{N} \\nabla_\\theta v(S_i; \\theta) [\\nabla_\\theta v(S_i; \\theta)]^T$$\nwhere $\\nabla_\\theta v$ is the gradient of the rate equation with respect to the parameters. The components of the gradient are the partial derivatives:\n$$\\frac{\\partial v}{\\partial V_{\\max}} = \\frac{S}{K_M + S}$$\n$$\\frac{\\partial v}{\\partial K_M} = V_{\\max}S \\cdot \\frac{-1}{(K_M + S)^2} = -\\frac{V_{\\max}S}{(K_M + S)^2}$$\nThe FIM for a single measurement at substrate concentration $S_i$ is a $2 \\times 2$ matrix:\n$$\\mathcal{I}_i(\\theta) = \\frac{1}{\\sigma_v^2} \\begin{pmatrix} \\left(\\frac{S_i}{K_M+S_i}\\right)^2 & -\\frac{V_{\\max}S_i^2}{(K_M+S_i)^3} \\\\ -\\frac{V_{\\max}S_i^2}{(K_M+S_i)^3} & \\left(\\frac{V_{\\max}S_i}{(K_M+S_i)^2}\\right)^2 \\end{pmatrix}$$\nThe total FIM is the sum over the $N=4$ chosen design points. D-optimality requires us to choose the set of $4$ distinct concentrations from the candidate pool that maximizes $\\det\\mathcal{I}(\\theta)$. Since $\\det(c A) = c^k \\det(A)$ for a $k \\times k$ matrix $A$ and scalar $c$, the constant factor $1/\\sigma_v^2$ does not affect which design is optimal. We therefore seek to maximize the determinant of the sum of the matrices without this factor. This is accomplished by iterating through all $\\binom{10}{4}=210$ combinations of $4$ substrate concentrations from the candidate set, computing the total FIM for each combination using the nominal parameter values derived from the true mechanistic parameters of each test case, and selecting the combination that yields the largest determinant.\n\n### Task 3: Progress-Curve Fitting and Model Selection\n\nThis task involves two main steps: data generation and model comparison.\n\n**Data Generation**: Synthetic progress-curve data for the product concentration $[P](t)$ is generated by numerically integrating the full mechanistic system of three ODEs for $[S]$, $[ES]$, and $[P]$ using the true parameters for each test case. The initial conditions are $[S](0)=S_0$, $[ES](0)=0$, $[P](0)=0$. After obtaining the true values $P_{true}(t_i)$ at the specified time points, i.i.d. Gaussian noise is added: $P_{noisy}(t_i) = P_{true}(t_i) + \\epsilon_i$, where $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_P^2)$.\n\n**Model Fitting**: Two models are fitted to this noisy data using nonlinear least squares, with the constraint that all parameters must be positive.\n1.  **Reduced Model (a)**: This model assumes the QSSA holds for the entire time course. The system is described by a single ODE for $[P](t)$, derived by using the mass balance relation $[S](t) = S_0 - [P](t)$:\n    $$\\frac{d[P]}{dt} = \\frac{V_{\\max} (S_0 - [P](t))}{K_M + S_0 - [P](t)}, \\quad [P](0)=0$$\n    This ODE is numerically integrated during the fitting process to find the optimal values of the two parameters, $p_a=2$: $V_{\\max}$ and $K_M$.\n\n2.  **Full Mechanistic Model (b)**: This model uses the original system of three coupled ODEs. The fitting process involves numerically integrating this system to find the optimal values of the three parameters, $p_b=3$: $k_1$, $k_{-1}$, and $k_2$.\n\n**Model Selection**: After fitting both models, the Akaike Information Criterion (AIC) is calculated for each fit:\n$$\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{RSS}}{n}\\right) + 2p$$\nwhere $n$ is the number of data points, $p$ is the number of fitted parameters, and $\\mathrm{RSS}$ is the residual sum of squares from the least-squares fit. The model with the lower AIC value is considered to provide a better balance between goodness of fit (low RSS) and model parsimony (low $p$), and is thus selected as the preferred model. A model choice indicator of $0$ is assigned to the reduced model and $1$ to the full model. This process is repeated for each of the three test cases, which are designed to probe different regimes of the QSSA's validity.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import curve_fit\nfrom itertools import combinations\nimport math\n\n# Use a fixed seed for the random number generator for reproducibility as required.\nRNG = np.random.default_rng(seed=42)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the D-optimal design and model fitting/selection tasks.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'A',\n            'k1': 1.0, 'k_1': 10.0, 'k2': 2.0, 'E0': 0.1, 'S0': 100.0,\n            'S_candidates': np.array([2., 5., 10., 20., 50., 100., 200., 500., 1000., 2000.]),\n            'sigma_v_sq': 0.02**2,\n            't_points': np.array([0.1, 0.2, 0.5, 1.0, 2.0, 5.0]),\n            'sigma_P_sq': 0.5**2,\n        },\n        {\n            'name': 'B',\n            'k1': 1.0, 'k_1': 1.0, 'k2': 50.0, 'E0': 50.0, 'S0': 100.0,\n            'S_candidates': np.array([2., 5., 10., 20., 50., 100., 200., 500., 1000., 2000.]),\n            'sigma_v_sq': 0.5**2,\n            't_points': np.array([0.01, 0.02, 0.05, 0.1, 0.2, 0.5]),\n            'sigma_P_sq': 2.0**2,\n        },\n        {\n            'name': 'C',\n            'k1': 0.1, 'k_1': 0.01, 'k2': 5.0, 'E0': 1.0, 'S0': 5.0,\n            'S_candidates': np.array([2., 5., 10., 20., 50., 100., 200., 500., 1000., 2000.]),\n            'sigma_v_sq': 0.1**2,\n            't_points': np.array([0.02, 0.05, 0.1, 0.2, 0.5, 1.0]),\n            'sigma_P_sq': 0.2**2,\n        }\n    ]\n\n    final_results = []\n    \n    for case in test_cases:\n        # --- Task 2: D-Optimal Design ---\n        Vmax_nom = case['k2'] * case['E0']\n        Km_nom = (case['k_1'] + case['k2']) / case['k1']\n\n        best_design = None\n        max_det = -1.0\n        \n        # Iterate through all combinations of 4 substrate concentrations\n        for s_design in combinations(case['S_candidates'], 4):\n            fim = np.zeros((2, 2))\n            s_design_np = np.array(s_design)\n            \n            # Calculate FIM for the current design\n            df_dV = s_design_np / (Km_nom + s_design_np)\n            df_dK = -Vmax_nom * s_design_np / (Km_nom + s_design_np)**2\n            \n            fim[0, 0] = np.sum(df_dV**2)\n            fim[1, 1] = np.sum(df_dK**2)\n            fim[0, 1] = fim[1, 0] = np.sum(df_dV * df_dK)\n            \n            det = np.linalg.det(fim)\n            if det > max_det:\n                max_det = det\n                best_design = sorted(list(s_design))\n\n        final_results.extend(best_design)\n\n        # --- Task 3: Progress-Curve Fitting and Model Selection ---\n        \n        # 1. Generate synthetic data\n        def full_ode_system(t, y, k1, k_1, k2, E0):\n            S, ES, P = y\n            E = E0 - ES\n            dS_dt = -k1 * E * S + k_1 * ES\n            dES_dt = k1 * E * S - (k_1 + k2) * ES\n            dP_dt = k2 * ES\n            return [dS_dt, dES_dt, dP_dt]\n\n        y0 = [case['S0'], 0, 0]\n        t_span = [0, max(case['t_points'])]\n        \n        sol_true = solve_ivp(\n            full_ode_system, t_span, y0,\n            args=(case['k1'], case['k_1'], case['k2'], case['E0']),\n            dense_output=True, method='Radau'\n        )\n        p_true = sol_true.sol(case['t_points'])[2]\n        noise = RNG.normal(0, np.sqrt(case['sigma_P_sq']), len(case['t_points']))\n        p_noisy = p_true + noise\n        p_noisy[p_noisy < 0] = 0 # Product concentration cannot be negative.\n\n        # 2. Fit Reduced Model\n        def reduced_model_curve(t_points, Vmax, Km, S0):\n            def ode(t, P):\n                denominator = Km + S0 - P\n                if denominator <= 1e-9: return 0.0\n                return Vmax * (S0 - P) / denominator\n            \n            sol = solve_ivp(ode, [0, max(t_points)], [0], dense_output=True, method='Radau')\n            return sol.sol(t_points)[0]\n\n        try:\n            popt_red, _ = curve_fit(\n                lambda t, Vmax, Km: reduced_model_curve(t, Vmax, Km, case['S0']),\n                case['t_points'], p_noisy,\n                p0=[Vmax_nom, Km_nom], bounds=(0, np.inf)\n            )\n            p_fit_red = reduced_model_curve(case['t_points'], *popt_red, case['S0'])\n            rss_red = np.sum((p_noisy - p_fit_red)**2)\n            n = len(case['t_points'])\n            p = 2\n            # Handle RSS being close to zero\n            if rss_red < 1e-20: rss_red = 1e-20\n            aic_red = n * math.log(rss_red / n) + 2 * p\n        except (RuntimeError, ValueError):\n            aic_red = np.inf # Failed fit\n\n        # 3. Fit Full Model\n        def full_model_curve(t_points, k1, k_1, k2, E0, S0):\n            y0_fit = [S0, 0, 0]\n            sol = solve_ivp(\n                lambda t, y: full_ode_system(t, y, k1, k_1, k2, E0),\n                [0, max(t_points)], y0_fit, dense_output=True, method='Radau'\n            )\n            return sol.sol(t_points)[2]\n\n        try:\n            popt_full, _ = curve_fit(\n                lambda t, k1, k_1, k2: full_model_curve(t, k1, k_1, k2, case['E0'], case['S0']),\n                case['t_points'], p_noisy,\n                p0=[case['k1'], case['k_1'], case['k2']], bounds=(0, np.inf)\n            )\n            p_fit_full = full_model_curve(case['t_points'], *popt_full, case['E0'], case['S0'])\n            rss_full = np.sum((p_noisy - p_fit_full)**2)\n            n = len(case['t_points'])\n            p = 3\n            if rss_full < 1e-20: rss_full = 1e-20\n            aic_full = n * math.log(rss_full / n) + 2 * p\n        except (RuntimeError, ValueError):\n            aic_full = np.inf # Failed fit\n\n        # 4. Compare AICs and select model\n        model_choice = 1 if aic_full < aic_red else 0\n        final_results.append(model_choice)\n        \n    print(f\"[{','.join(map(str, final_results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}