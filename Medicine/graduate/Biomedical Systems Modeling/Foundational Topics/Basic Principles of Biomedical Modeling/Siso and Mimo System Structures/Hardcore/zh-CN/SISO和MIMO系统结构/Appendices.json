{
    "hands_on_practices": [
        {
            "introduction": "从外部的传递函数描述转向内部的状态空间模型，是现代控制理论中的一个基本步骤。这个练习旨在实践这一“实现”过程，并介绍可控性和可观测性这两个关键概念，它们共同定义了一个无冗余的最小化模型。通过构建一个心肺交互作用模型，这个练习将帮助你巩固这些基本技能。",
            "id": "3928584",
            "problem": "一个符合生理学的 $3$ 状态模型被用于捕捉一个线性时不变 (LTI) 单输入多输出 (SIMO) 系统中的心肺相互作用。状态向量为 $x(t) \\in \\mathbb{R}^{3}$，其分量 $x_{1}(t)$ 代表心率代理指标，$x_{2}(t)$ 代表通气幅度，$x_{3}(t)$ 代表化学感受器反射积分器。单一输入 $u(t)$ 代表自主神经驱动。考虑两个可测输出：$y_{1}(t)$ 对应于动脉压脉动幅度，$y_{2}(t)$ 对应于通气流量幅度。\n\n从输入 $u(t)$到输出 $\\begin{pmatrix} y_{1}(t) \\\\ y_{2}(t) \\end{pmatrix}$ 的期望传递函数矩阵被指定为\n$$\nG(s) \\in \\mathbb{R}^{2 \\times 1}, \\quad\nG(s) =\n\\begin{pmatrix}\n\\displaystyle \\frac{s^{2} + 2 s + 1}{s^{3} + 5 s^{2} + 6 s + 4} \\\\\n\\displaystyle \\frac{3 s^{2} + 2 s + 1}{s^{3} + 5 s^{2} + 6 s + 4}\n\\end{pmatrix}.\n$$\n从 LTI 系统的基本定义出发，即状态空间输入-输出关系 $G(s) = C (s I - A)^{-1} B + D$ 和 Kalman 可控性与可观测性概念，执行以下操作：\n\n1. 构建一个阶数为 $3$ 的实现 $(A, B, C, D)$，该实现能产生指定的 $G(s)$，且 $D = 0$。您的构建过程必须从第一性原理出发，通过使用核心线性系统恒等式将 $C (s I - A)^{-1} B$ 与 $G(s)$ 进行匹配，而不能调用快捷公式。\n2. 通过证明其可控性和可观测性来证明您实现的最小性：证明可控性矩阵 $\\mathcal{C} = [\\, B \\;\\; A B \\;\\; A^{2} B \\,]$ 的秩为 $3$，以及可观测性矩阵 $\\mathcal{O} = \\begin{pmatrix} C \\\\ C A \\\\ C A^{2} \\end{pmatrix}$ 的秩为 $3$。\n3. 计算您的实现的可控性矩阵的行列式 $\\det(\\mathcal{C})$，并将此值作为最终答案报告。将最终答案表示为精确的实数。无需单位。\n\n推导和构建过程应基于生物医学系统建模的真实性以及单输入单输出 (SISO) 和多输入多输出 (MIMO) 系统的结构，但最终报告的量必须是如上所述的单个实数值。",
            "solution": "该问题经评估是有效的。这是一个在标准线性时不变 (LTI) 系统框架下，提法恰当、有科学依据的问题，提供了所有必要信息且无矛盾之处。\n\n任务是为一个给定的单输入多输出 (SIMO) 传递函数矩阵 $G(s)$ 寻找一个3阶状态空间实现 $(A, B, C, D)$，证明其最小性，并计算其可控性矩阵的行列式。\n\n给定的传递函数矩阵为：\n$$\nG(s) = \\begin{pmatrix} G_1(s) \\\\ G_2(s) \\end{pmatrix} =\n\\begin{pmatrix}\n\\displaystyle \\frac{s^{2} + 2 s + 1}{s^{3} + 5 s^{2} + 6 s + 4} \\\\\n\\displaystyle \\frac{3 s^{2} + 2 s + 1}{s^{3} + 5 s^{2} + 6 s + 4}\n\\end{pmatrix}\n$$\n系统指定为 $n=3$ 阶，前馈矩阵 $D$ 给定为 $D=0$。\n\n### 第1部分：构建实现 $(A, B, C, D)$\n\n我们被要求从第一性原理出发构建一个实现。实现传递函数的一种标准且系统的方法是使用规范型。我们将构建可控规范型。\n\n公分母多项式是 $d(s) = s^{3} + a_{2}s^{2} + a_{1}s + a_0 = s^{3} + 5s^{2} + 6s + 4$。通过比较，我们确定系数：$a_{2} = 5$，$a_{1} = 6$，$a_{0} = 4$。\n\n在可控规范型中，对于一个 $n=3$ 阶的单输入系统，状态矩阵 $A$ 和输入矩阵 $B$ 直接由分母多项式 $d(s)$ 的系数构建：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -a_0 & -a_1 & -a_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n为了从第一性原理推导输出矩阵 $C$，我们分析这种特定结构下输入 $u(t)$ 和状态 $x(t)$ 之间的关系。拉普拉斯域中的状态空间方程为 $sX(s) = AX(s) + BU(s)$，可以写成：\n$sX_1(s) = X_2(s)$\n$sX_2(s) = X_3(s)$\n$sX_3(s) = -a_0 X_1(s) - a_1 X_2(s) - a_2 X_3(s) + U(s)$\n\n将前两个方程代入第三个方程得到：\n$s(s X_2(s)) = -a_0 X_1(s) - a_1(sX_1(s)) - a_2(s^2 X_1(s)) + U(s)$\n$s^3 X_1(s) = -a_0 X_1(s) - a_1 s X_1(s) - a_2 s^2 X_1(s) + U(s)$\n重新整理，我们得到：\n$(s^3 + a_2 s^2 + a_1 s + a_0) X_1(s) = U(s)$\n这意味着 $X_1(s) = \\frac{1}{d(s)} U(s)$。\n因此，其他状态为：\n$X_2(s) = s X_1(s) = \\frac{s}{d(s)} U(s)$\n$X_3(s) = s X_2(s) = \\frac{s^2}{d(s)} U(s)$\n\n输出方程为 $Y(s) = CX(s)$ (因为 $D=0$)。对于我们的双输出系统，设 $C = \\begin{pmatrix} C_1 \\\\ C_2 \\end{pmatrix} = \\begin{pmatrix} c_{11} & c_{12} & c_{13} \\\\ c_{21} & c_{22} & c_{23} \\end{pmatrix}$。\n第一个输出 $Y_1(s)$ 是：\n$Y_1(s) = C_1 X(s) = c_{11} X_1(s) + c_{12} X_2(s) + c_{13} X_3(s) = \\frac{c_{11} + c_{12} s + c_{13} s^2}{d(s)} U(s)$\n第二个输出 $Y_2(s)$ 是：\n$Y_2(s) = C_2 X(s) = c_{21} X_1(s) + c_{22} X_2(s) + c_{23} X_3(s) = \\frac{c_{21} + c_{22} s + c_{23} s^2}{d(s)} U(s)$\n\n我们将这些表达式与给定的传递函数 $G_1(s) = \\frac{Y_1(s)}{U(s)}$ 和 $G_2(s) = \\frac{Y_2(s)}{U(s)}$ 进行匹配。\n对于 $G_1(s) = \\frac{s^2 + 2s + 1}{d(s)}$，分子是 $s^2 + 2s + 1$。与 $c_{13}s^2 + c_{12}s + c_{11}$ 的系数进行比较，我们得到 $c_{13}=1$, $c_{12}=2$, $c_{11}=1$。\n对于 $G_2(s) = \\frac{3s^2 + 2s + 1}{d(s)}$，分子是 $3s^2 + 2s + 1$。与 $c_{23}s^2 + c_{22}s + c_{21}$ 的系数进行比较，我们得到 $c_{23}=3$, $c_{22}=2$, $c_{21}=1$。\n\n因此，输出矩阵 $C$ 为：\n$$\nC = \\begin{pmatrix} 1 & 2 & 1 \\\\ 1 & 2 & 3 \\end{pmatrix}\n$$\n构建的实现 $(A, B, C, D)$ 为：\n$A = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 2 & 1 \\\\ 1 & 2 & 3 \\end{pmatrix}$, $D = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n### 第2部分：最小性证明\n\n一个实现是最小的，当且仅当它既是可控的又是可观测的。\n\n**可控性：**\n我们必须证明可控性矩阵 $\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}$ 是满秩的，即 $\\text{rank}(\\mathcal{C}) = 3$。\n首先，我们计算向量 $AB$ 和 $A^2B$：\n$B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n$AB = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -5 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ -6 + 25 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -5 \\\\ 19 \\end{pmatrix}$\n\n可控性矩阵为：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -5 \\\\ 1 & -5 & 19 \\end{pmatrix}\n$$\n为了检查是否满秩，我们计算其行列式：\n$\\det(\\mathcal{C}) = 0 \\cdot \\det \\begin{pmatrix} 1 & -5 \\\\ -5 & 19 \\end{pmatrix} - 0 \\cdot \\det \\begin{pmatrix} 0 & -5 \\\\ 1 & 19 \\end{pmatrix} + 1 \\cdot \\det \\begin{pmatrix} 0 & 1 \\\\ 1 & -5 \\end{pmatrix} = 1 \\cdot (0 \\cdot (-5) - 1 \\cdot 1) = -1$。\n因为 $\\det(\\mathcal{C}) = -1 \\neq 0$，所以该矩阵的秩为 $3$。该实现是可控的。\n\n**可观测性：**\n我们必须证明可观测性矩阵 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}$ 是满秩的，即 $\\text{rank}(\\mathcal{O}) = 3$。\n首先，我们计算矩阵 $CA$ 和 $CA^2$：\n$CA = \\begin{pmatrix} 1 & 2 & 1 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix} = \\begin{pmatrix} 1(0)+2(0)+1(-4) & 1(1)+2(0)+1(-6) & 1(0)+2(1)+1(-5) \\\\ 1(0)+2(0)+3(-4) & 1(1)+2(0)+3(-6) & 1(0)+2(1)+3(-5) \\end{pmatrix} = \\begin{pmatrix} -4 & -5 & -3 \\\\ -12 & -17 & -13 \\end{pmatrix}$\n$CA^2 = (CA)A = \\begin{pmatrix} -4 & -5 & -3 \\\\ -12 & -17 & -13 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -4 & -6 & -5 \\end{pmatrix} = \\begin{pmatrix} 12 & -4+18 & -5+15 \\\\ 52 & -12+78 & -17+65 \\end{pmatrix} = \\begin{pmatrix} 12 & 14 & 10 \\\\ 52 & 66 & 48 \\end{pmatrix}$\n\n可观测性矩阵是一个 $6 \\times 3$ 的矩阵：\n$$\n\\mathcal{O} = \\begin{pmatrix} 1 & 2 & 1 \\\\ 1 & 2 & 3 \\\\ -4 & -5 & -3 \\\\ -12 & -17 & -13 \\\\ 12 & 14 & 10 \\\\ 52 & 66 & 48 \\end{pmatrix}\n$$\n为了证明 $\\text{rank}(\\mathcal{O}) = 3$，我们只需要找到一个行列式不为零的 $3 \\times 3$ 子矩阵。我们取前三行：\n$$\nM = \\begin{pmatrix} 1 & 2 & 1 \\\\ 1 & 2 & 3 \\\\ -4 & -5 & -3 \\end{pmatrix}\n$$\n$\\det(M) = 1 \\cdot \\det \\begin{pmatrix} 2 & 3 \\\\ -5 & -3 \\end{pmatrix} - 2 \\cdot \\det \\begin{pmatrix} 1 & 3 \\\\ -4 & -3 \\end{pmatrix} + 1 \\cdot \\det \\begin{pmatrix} 1 & 2 \\\\ -4 & -5 \\end{pmatrix}$\n$\\det(M) = 1(2(-3) - 3(-5)) - 2(1(-3) - 3(-4)) + 1(1(-5) - 2(-4))$\n$\\det(M) = 1(-6 + 15) - 2(-3 + 12) + 1(-5 + 8) = 1(9) - 2(9) + 1(3) = 9 - 18 + 3 = -6$。\n因为 $\\det(M) = -6 \\neq 0$，所以前三行是线性无关的。因此，$\\mathcal{O}$ 的秩为 $3$。该实现是可观测的。\n\n因为该实现既是可控的又是可观测的，所以它是一个最小实现。\n\n### 第3部分：计算可控性矩阵的行列式\n\n这在最小性证明部分已经计算过了。可控性矩阵为\n$$\n\\mathcal{C} = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 1 & -5 \\\\ 1 & -5 & 19 \\end{pmatrix}\n$$\n其行列式为\n$$\n\\det(\\mathcal{C}) = -1\n$$\n这就是问题所要求的最终数值。",
            "answer": "$$ \\boxed{-1} $$"
        },
        {
            "introduction": "多输入多输出（MIMO）系统的一个核心挑战是理解输入和输出之间的交叉耦合。本练习将介绍相对增益矩阵（RGA）这一强大的工具，用以量化这些相互作用。通过一个药物输注的生物医学实例，我们将揭示稳态分析与动态分析之间的关键差异，并理解为何看似合理的控制配对在动态条件下可能会失效。",
            "id": "3928521",
            "problem": "考虑一个用于在血管活性药物输注下调节平均动脉压和心率的线性化双输入双输出生物医学调节系统。输入 $u_1$ 和 $u_2$ 是两种药物的输注速率，输出 $y_1$ 和 $y_2$ 分别是平均动脉压和心率与稳态基线的偏差。该被控对象由 $2 \\times 2$ 的传递函数矩阵建模\n$$\nG(s) \\;=\\;\n\\begin{pmatrix}\n\\displaystyle \\frac{1}{50 s + 1} & \\displaystyle 0.05\\,\\frac{1 + 50 s}{5 s + 1} \\\\\n\\displaystyle 0.05\\,\\frac{1 + 40 s}{4 s + 1} & \\displaystyle \\frac{1}{30 s + 1}\n\\end{pmatrix}.\n$$\n该结构源于质量平衡线性化和反射通路动力学：对角线元素是缓慢的一阶药效学效应，而非对角线元素是由压力反射通路介导的超前-滞后交叉耦合，这种耦合在稳态时较弱，但在动态过程中更强。\n\n要求您使用相对增益阵列（RGA）评估对角配对（输入 $u_1$ 与输出 $y_1$ 配对，输入 $u_2$ 与输出 $y_2$ 配对）的质量。对于一个方形多输入多输出（MIMO）被控对象 $G(s)$，其在复频率 $s$ 处的相对增益阵列（RGA）定义为\n$$\n\\Lambda(s) \\;=\\; G(s) \\,\\circ\\, \\big(G(s)^{-T}\\big),\n$$\n其中 $\\circ$ 表示哈达玛（Hadamard）积（即逐元素乘积），$^{-T}$ 表示逆转置。在稳态下，$s = 0$，RGA $\\Lambda(0)$ 指示了配对质量；接近 $1$ 的对角线元素和小的非对角线元素表明对角配对是理想的。然而，即使稳态 RGA 是理想的，如果动态相互作用在预期的回路带宽附近很强，对角配对的性能也可能很差。\n\n从给定的模型和 RGA 定义出发，完成以下任务：\n\n1. 评估稳态 RGA $\\Lambda(0)$，并根据其对角线和非对角线元素评论对角配对的质量。\n2. 将频率 $\\omega$ 处的动态 RGA 定义为 $\\Lambda(j\\omega)$，并在频率 $\\omega^\\star = 0.2$（单位：弧度/秒）处评估其 $(1,1)$ 元素 $\\Lambda_{11}(j\\omega)$。对于给定的缓慢对角线动力学，此频率代表了单输入单输出（SISO）分散式设计的典型目标带宽。\n3. 通过计算标量来量化对角配对的动态相互作用的严重程度\n$$\nS \\;=\\; \\big|\\Lambda_{11}(j\\omega^\\star)\\big|.\n$$\n\n将 $S$ 的最终值表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。最终答案中不得报告其他任何量。",
            "solution": "问题陈述经评估有效。它内容完整，在控制理论和生物医学系统建模方面有科学依据，并且在数学上是适定的。所有必要的数据和定义都已提供。\n\n该问题要求使用相对增益阵列（RGA）$\\Lambda(s)$ 分析一个 $2 \\times 2$ 的多输入多输出（MIMO）系统。RGA 定义为\n$$\n\\Lambda(s) = G(s) \\circ \\left(G(s)^{-T}\\right)\n$$\n其中 $G(s)$ 是被控对象的传递函数矩阵，$\\circ$ 表示哈达玛（Hadamard）积（即逐元素乘积），$^{-T}$ 表示逆转置。\n\n给定的被控对象传递函数为\n$$\nG(s) =\n\\begin{pmatrix}\ng_{11}(s) & g_{12}(s) \\\\\ng_{21}(s) & g_{22}(s)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\displaystyle \\frac{1}{50 s + 1} & \\displaystyle 0.05\\,\\frac{1 + 50 s}{5 s + 1} \\\\\n\\displaystyle 0.05\\,\\frac{1 + 40 s}{4 s + 1} & \\displaystyle \\frac{1}{30 s + 1}\n\\end{pmatrix}\n$$\n\n对于一个通用的 $2 \\times 2$ 矩阵 $G(s)$，其逆矩阵为\n$$\nG(s)^{-1} = \\frac{1}{\\det(G(s))}\n\\begin{pmatrix}\ng_{22}(s) & -g_{12}(s) \\\\\n-g_{21}(s) & g_{11}(s)\n\\end{pmatrix}\n$$\n因此，逆转置矩阵为\n$$\nG(s)^{-T} = \\left(G(s)^{-1}\\right)^T = \\frac{1}{\\det(G(s))}\n\\begin{pmatrix}\ng_{22}(s) & -g_{21}(s) \\\\\n-g_{12}(s) & g_{11}(s)\n\\end{pmatrix}\n$$\n然后通过逐元素乘法计算 RGA 矩阵 $\\Lambda(s)$：\n$$\n\\Lambda(s) = \\frac{1}{\\det(G(s))}\n\\begin{pmatrix}\ng_{11}(s)g_{22}(s) & -g_{12}(s)g_{21}(s) \\\\\n-g_{21}(s)g_{12}(s) & g_{22}(s)g_{11}(s)\n\\end{pmatrix}\n$$\n$G(s)$ 的行列式是 $\\det(G(s)) = g_{11}(s)g_{22}(s) - g_{12}(s)g_{21}(s)$。\nRGA 的 $(1,1)$ 元素 $\\Lambda_{11}(s)$ 由下式给出\n$$\n\\Lambda_{11}(s) = \\frac{g_{11}(s)g_{22}(s)}{\\det(G(s))} = \\frac{g_{11}(s)g_{22}(s)}{g_{11}(s)g_{22}(s) - g_{12}(s)g_{21}(s)} = \\frac{1}{1 - \\frac{g_{12}(s)g_{21}(s)}{g_{11}(s)g_{22}(s)}}\n$$\n\n**1. 稳态 RGA 评估**\n\n首先，我们通过令 $s=0$ 来评估稳态增益矩阵 $G(0)$：\n$$\nG(0) =\n\\begin{pmatrix}\n\\displaystyle \\frac{1}{1} & \\displaystyle 0.05\\,\\frac{1}{1} \\\\\n\\displaystyle 0.05\\,\\frac{1}{1} & \\displaystyle \\frac{1}{1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0.05 \\\\\n0.05 & 1\n\\end{pmatrix}\n$$\n行列式为 $\\det(G(0)) = (1)(1) - (0.05)(0.05) = 1 - 0.0025 = 0.9975$。\n逆转置矩阵为\n$$\nG(0)^{-T} = \\frac{1}{0.9975}\n\\begin{pmatrix}\n1 & -0.05 \\\\\n-0.05 & 1\n\\end{pmatrix}\n$$\n稳态 RGA $\\Lambda(0)$ 为\n$$\n\\Lambda(0) = G(0) \\circ G(0)^{-T} =\n\\begin{pmatrix}\n1 & 0.05 \\\\\n0.05 & 1\n\\end{pmatrix}\n\\circ\n\\frac{1}{0.9975}\n\\begin{pmatrix}\n1 & -0.05 \\\\\n-0.05 & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{0.9975} & \\frac{-0.0025}{0.9975} \\\\\n\\frac{-0.0025}{0.9975} & \\frac{1}{0.9975}\n\\end{pmatrix}\n$$\n数值上，\n$$\n\\Lambda(0) \\approx\n\\begin{pmatrix}\n1.0025 & -0.0025 \\\\\n-0.0025 & 1.0025\n\\end{pmatrix}\n$$\n一个对角线元素接近 $1$、非对角线元素接近 $0$ 的 RGA 矩阵表明相互作用很弱，适合采用对角配对。基于 $\\Lambda(0)$，稳态相互作用是最小的，这表明将 $u_1$ 与 $y_1$ 配对、将 $u_2$ 与 $y_2$ 配对的分散式控制策略对于慢速的稳态指令跟踪是有效的。\n\n**2. 动态 RGA 评估**\n\n接下来，我们在频率 $\\omega^\\star = 0.2 \\, \\text{rad/s}$ 处评估动态相互作用。我们关注元素 $\\Lambda_{11}(j\\omega^\\star)$。让我们定义相互作用度量 $\\lambda(s) = \\frac{g_{12}(s)g_{21}(s)}{g_{11}(s)g_{22}(s)}$，从而有 $\\Lambda_{11}(s) = \\frac{1}{1-\\lambda(s)}$。\n\n首先，我们用给定的传递函数来表示 $\\lambda(s)$：\n$$\n\\lambda(s) = \\frac{\\left(0.05\\,\\frac{1 + 50s}{5s + 1}\\right) \\left(0.05\\,\\frac{1 + 40s}{4s + 1}\\right)}{\\left(\\frac{1}{50s + 1}\\right) \\left(\\frac{1}{30s + 1}\\right)} = 0.0025 \\frac{(1+50s)(1+40s)(50s+1)(30s+1)}{(5s+1)(4s+1)}\n$$\n由于 $1+50s = 50s+1$，上式可简化为：\n$$\n\\lambda(s) = 0.0025 \\frac{(1+50s)^2(1+40s)(1+30s)}{(1+5s)(1+4s)}\n$$\n我们将其在 $s = j\\omega^\\star = j(0.2)$ 处进行评估：\n各项变为：\n$1+50s = 1+j50(0.2) = 1+j10$\n$1+40s = 1+j40(0.2) = 1+j8$\n$1+30s = 1+j30(0.2) = 1+j6$\n$1+5s = 1+j5(0.2) = 1+j1$\n$1+4s = 1+j4(0.2) = 1+j0.8$\n\n将这些代入 $\\lambda(j0.2)$ 的表达式中：\n$$\n\\lambda(j0.2) = 0.0025 \\frac{(1+j10)^2(1+j8)(1+j6)}{(1+j1)(1+j0.8)}\n$$\n我们进行复数运算：\n分子项：\n$(1+j10)^2 = 1^2 + 2(j10) + (j10)^2 = 1 + j20 - 100 = -99 + j20$\n$(1+j8)(1+j6) = 1 + j6 + j8 + j^2(48) = 1 + j14 - 48 = -47 + j14$\n分子乘积：$(-99+j20)(-47+j14) = (-99)(-47) + (-99)(j14) + (j20)(-47) + (j20)(j14) = 4653 - j1386 - j940 - 280 = 4373 - j2326$。\n\n分母乘积：$(1+j1)(1+j0.8) = 1 + j0.8 + j1 + j^2(0.8) = 1 + j1.8 - 0.8 = 0.2 + j1.8$。\n\n所以，\n$$\n\\lambda(j0.2) = 0.0025 \\frac{4373 - j2326}{0.2 + j1.8}\n$$\n为了进行除法，我们将分子和分母同乘以分母的共轭复数，即 $0.2 - j1.8$：\n$$\n\\lambda(j0.2) = 0.0025 \\frac{(4373 - j2326)(0.2 - j1.8)}{(0.2 + j1.8)(0.2 - j1.8)} = 0.0025 \\frac{4373(0.2) - j4373(1.8) - j2326(0.2) + j^2(2326)(1.8)}{0.2^2 + 1.8^2}\n$$\n$$\n\\lambda(j0.2) = 0.0025 \\frac{874.6 - j7871.4 - j465.2 - 4186.8}{0.04 + 3.24} = 0.0025 \\frac{-3312.2 - j8336.6}{3.28}\n$$\n$$\n\\lambda(j0.2) = \\frac{-8.2805 - j20.8415}{3.28} \\approx -2.5245 - j6.3541\n$$\n现在我们计算 $\\Lambda_{11}(j\\omega^\\star)$：\n$$\n\\Lambda_{11}(j0.2) = \\frac{1}{1 - \\lambda(j0.2)} = \\frac{1}{1 - (-2.5245 - j6.3541)} = \\frac{1}{3.5245 + j6.3541}\n$$\n\n**3. 动态相互作用的严重程度**\n\n动态相互作用的严重程度由 $S = |\\Lambda_{11}(j\\omega^\\star)|$ 来量化。\n$$\nS = \\left| \\frac{1}{3.5245 + j6.3541} \\right| = \\frac{1}{|3.5245 + j6.3541|}\n$$\n分母的模为：\n$$\n|3.5245 + j6.3541| = \\sqrt{3.5245^2 + 6.3541^2} \\approx \\sqrt{12.4221 + 40.3745} = \\sqrt{52.7966} \\approx 7.2661\n$$\n因此，\n$$\nS = \\frac{1}{7.2661} \\approx 0.137627\n$$\n四舍五入到四位有效数字，其值为 $S=0.1376$。\n这个值 $|\\Lambda_{11}(j\\omega^\\star)| \\approx 0.1376$ 与稳态值 $\\Lambda_{11}(0) \\approx 1.0025$ 有显著差异。$|\\Lambda_{11}(j\\omega)|$ 的值远不等于 $1$ 表明在频率 $\\omega$ 处存在强烈的动态耦合。在本案例中，分析揭示了尽管系统具有良好的稳态特性，但在目标带宽附近表现出严重的动态相互作用，这会损害简单的对角分散式控制器的性能和稳定性。",
            "answer": "$$\n\\boxed{0.1376}\n$$"
        },
        {
            "introduction": "在临床环境中，基于模型的估算和控制策略的可靠性取决于模型的数值稳定性。本练习探讨了这一实际问题，使用矩阵的条件数来量化模型求逆过程中测量噪声被放大的程度。通过这个练习，你将把数值线性代数中的核心概念与临床设备应用的实际安全性联系起来。",
            "id": "3928578",
            "problem": "一名生物医学工程师的任务是评估基于逆运算的输入重构对于在临床设备中遇到的、用于感知和刺激生理信号的线性多输入多输出系统是否安全。该工程师考虑对一个线性时不变（LTI）模型进行频域逆运算，并试图量化在每个角频率下逆运算过程中测量噪声的最坏情况放大。这种放大由频率响应矩阵的条件数来表征。从基本定义出发，一个以状态空间形式给出，由矩阵 $A \\in \\mathbb{R}^{n \\times n}$、$B \\in \\mathbb{R}^{n \\times m}$、$C \\in \\mathbb{R}^{p \\times n}$ 和 $D \\in \\mathbb{R}^{p \\times m}$ 描述的 LTI 模型的频率响应，是一个复数矩阵值函数 $G(j\\omega)$，它是通过在虚轴上评估输入输出映射得到的，其中 $j$ 表示虚数单位，$\\omega$ 表示角频率，单位为弧度/秒。在固定 $\\omega$ 下，逆运算中相对误差的乘性放大由欧几里得范数诱导的矩阵 $G(j\\omega)$ 的条件数量化。如果在某个频带内，最大条件数不超过指定的界限，则认为临床输入重构在该频带上的逆运算是安全的。\n\n您的任务是编写一个程序，对于下面指定的每个测试系统和频率网格，计算整个网格上的最大条件数，并根据一个固定的阈值得出安全性决策。角频率的单位是弧度/秒。所有浮点结果必须四舍五入到三位小数。\n\n需要使用的定义和要求：\n- 频率响应由线性时不变状态空间系统的基本输入输出关系定义，并在虚轴 $s = j\\omega$ 上进行评估。\n- 频率 $\\omega$ 处的条件数是相对于欧几里得范数定义的，它评估了在该频率下逆运算的相对误差放大。对于任何复数矩阵，该量都是实数且非负的。\n- 对于一个标量非零复数，由欧几里得范数诱导的条件数等于 $1$。\n\n安全性决策规则：\n- 定义安全阈值为 $K_{\\text{safe}} = 50$（无量纲）。\n- 对于每个测试用例，在提供的离散频率集 $\\Omega$ 上计算 $K_{\\max} = \\max_{\\omega \\in \\Omega} \\kappa\\big(G(j\\omega)\\big)$。\n- 当且仅当 $K_{\\max} \\le K_{\\text{safe}}$ 时，声明逆运算为“安全”。\n\n测试套件：\n- 所有测试用例使用相同的频率集，定义为 $\\Omega = \\{\\omega_k\\}_{k=1}^{200}$，其中 $\\omega_k$ 是从 $10^{-2}$ 到 $10^{2}$ 弧度/秒之间的 $200$ 个对数间隔点。\n- 测试用例 1（单输入单输出）：$A_1 = [-2]$, $B_1 = [1]$, $C_1 = [1]$, $D_1 = [0]$。这是一个在-2处有单极点的基准。\n- 测试用例 2（双输入双输出，对角且良态的）：\n  $$\n  A_2 = \\begin{bmatrix} -1 & 0 \\\\ 0 & -0.1 \\end{bmatrix},\\quad\n  B_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix},\\quad\n  C_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix},\\quad\n  D_2 = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}.\n  $$\n- 测试用例 3（双输入双输出，几乎共线的输出导致接近奇异）：\n  $$\n  A_3 = \\begin{bmatrix} -1 & 0 \\\\ 0 & -1 \\end{bmatrix},\\quad\n  B_3 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix},\\quad\n  C_3 = \\begin{bmatrix} 1 & 1 \\\\ 1 & 1+\\varepsilon \\end{bmatrix},\\quad\n  D_3 = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix},\n  $$\n  其中 $\\varepsilon = 10^{-3}$。\n\n计算任务：\n- 对于每个测试用例和每个 $\\omega \\in \\Omega$，使用状态空间数据计算复数矩阵 $G(j\\omega)$。\n- 对于每个 $G(j\\omega)$，计算由欧几里得范数诱导的条件数。对于秩亏矩阵，将其条件数视为 $+\\infty$。\n- 对于每个测试用例，计算 $K_{\\max}$ 并根据上述规则确定安全性的布尔值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 每个测试用例的结果必须是一个长度为二的列表：第一个元素是四舍五入到三位小数的 $K_{\\max}$，第二个元素是表示安全性的布尔值（安全为 True，否则为 False）。\n- 因此，最后一行必须具有 `[[K_{\\max,1},\\text{Safe}_1],[K_{\\max,2},\\text{Safe}_2],[K_{\\max,3},\\text{Safe}_3]]` 的形式，不含任何额外文本。\n\n单位和舍入要求：\n- 角频率必须以弧度/秒为单位处理。\n- 在打印前将每个 $K_{\\max}$ 四舍五入到三位小数。",
            "solution": "提交审议的问题陈述是有效的。它在科学上是合理的，提法恰当，客观，并包含唯一可验证解所需的所有必要信息。其基本原理是线性系统理论和数值线性代数中的基本概念。因此，我们可以进行形式化的求解。\n\n主要目标是通过量化噪声的最坏情况放大来评估线性时不变（LTI）系统逆运算的安全性。这种放大由系统的频率响应矩阵 $G(j\\omega)$ 的条件数来衡量。一个最大允许条件数 $K_{\\text{safe}}$ 作为安全阈值。\n\n首先，我们建立理论基础。一个由状态空间表示描述的 LTI 系统\n$$\n\\begin{align*}\n\\dot{x}(t) = Ax(t) + Bu(t) \\\\\ny(t) = Cx(t) + Du(t)\n\\end{align*}\n$$\n其中 $x \\in \\mathbb{R}^n$ 是状态向量，$u \\in \\mathbb{R}^m$ 是输入向量，$y \\in \\mathbb{R}^p$ 是输出向量，其传递函数矩阵 $G(s)$ 将输入的拉普拉斯变换 $U(s)$ 映射到输出的拉普拉斯变换 $Y(s)$。该关系由 $Y(s) = G(s)U(s)$ 给出。传递函数矩阵由状态空间矩阵（$A, B, C, D$）导出为：\n$$\nG(s) = C(sI - A)^{-1}B + D\n$$\n系统的频率响应是通过在虚轴上计算该传递函数得到的，即令复变量 $s$ 等于 $j\\omega$，其中 $j$ 是虚数单位，$\\omega$ 是角频率，单位为弧度/秒。因此，频率响应是复数矩阵值函数：\n$$\nG(j\\omega) = C(j\\omega I - A)^{-1}B + D\n$$\n该矩阵 $G(j\\omega)$ 将频率为 $\\omega$ 的正弦输入与稳态下的相应正弦输出关联起来。\n\n输入重构问题涉及估计产生测量输出 $y$ 的输入 $u$。在频域中，这对应于求解线性系统 $Y(j\\omega) = G(j\\omega)U(j\\omega)$ 以得到 $U(j\\omega)$，这需要计算 $U(j\\omega) = G(j\\omega)^{-1}Y(j\\omega)$。这种逆运算的数值稳定性至关重要，尤其是在 $Y(j\\omega)$ 中存在测量噪声的情况下。\n\n矩阵的条件数量化了线性系统解对数据误差的敏感度。对于一个矩阵 $M$，关于欧几里得范数（也称为谱范数或 $2$-范数）的条件数定义为其最大奇异值 $\\sigma_{\\max}(M)$ 与其最小奇异值 $\\sigma_{\\min}(M)$ 之比：\n$$\n\\kappa(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}\n$$\n如果 $M$ 是奇异的，则 $\\sigma_{\\min}(M) = 0$，条件数被认为是无穷大。大的条件数表明该矩阵接近奇异，其逆运算对小扰动高度敏感，导致相对误差的大幅放大。\n\n如指定，对于一个非零标量复数 $z \\in \\mathbb{C}$，只有一个奇异值 $|z|$。因此，$\\sigma_{\\max} = \\sigma_{\\min} = |z|$，其条件数为 $\\kappa(z) = |z|/|z| = 1$。\n\n每个测试用例的计算过程如下：\n1. 将频率网格 $\\Omega$ 定义为一个由 $10^{-2}$ 到 $10^2$ rad/s 之间 $200$ 个对数间隔点组成的集合。\n2. 对于每个频率 $\\omega \\in \\Omega$，计算频率响应矩阵 $G(j\\omega)$。在数值上，更稳定的方法是先求解线性系统 $(j\\omega I - A)X = B$ 以得到矩阵 $X$，然后计算 $G(j\\omega) = CX + D$。\n3. 计算条件数 $\\kappa(G(j\\omega))$。\n4. 测试用例的最大条件数是 $K_{\\max} = \\max_{\\omega \\in \\Omega} \\kappa(G(j\\omega))$。\n5. 根据规则做出安全性决策：当且仅当 $K_{\\max} \\le K_{\\text{safe}}$ 时，系统是“安全的”，其中 $K_{\\text{safe}} = 50$。\n\n我们现在分析每个测试用例：\n\n**测试用例 1 (SISO):**\n系统由 $A_1 = [-2]$，$B_1 = [1]$，$C_1 = [1]$ 和 $D_1 = [0]$ 给出。这是一个单输入单输出系统。\n其传递函数是一个标量：\n$$\nG_1(s) = C_1(sI - A_1)^{-1}B_1 + D_1 = [1](s - [-2])^{-1}[1] + [0] = \\frac{1}{s+2}\n$$\n频率响应为 $G_1(j\\omega) = \\frac{1}{j\\omega+2}$。对于任何实数频率 $\\omega$，$j\\omega+2 \\neq 0$，所以 $G_1(j\\omega)$ 是一个非零复数标量。根据所给定义，任何非零标量的条件数都是 $1$。因此，对于该系统，对所有 $\\omega$，$\\kappa(G_1(j\\omega)) = 1$。\n这得到 $K_{\\max,1} = \\max_{\\omega \\in \\Omega} (1) = 1$。\n由于 $1 \\le 50$，该系统被声明为**安全**。\n\n**测试用例 2 (MIMO, 良态):**\n系统矩阵是对角的：$A_2 = \\text{diag}(-1, -0.1)$，$B_2=I$，$C_2=I$，$D_2=0$。\n该系统是解耦的，其频率响应矩阵也是对角的：\n$$\nG_2(j\\omega) = (j\\omega I - A_2)^{-1} = \\begin{bmatrix} (j\\omega+1)^{-1} & 0 \\\\ 0 & (j\\omega+0.1)^{-1} \\end{bmatrix}\n$$\n对角矩阵的奇异值是其对角线元素的绝对值。\n$$\n\\sigma_1 = \\left|\\frac{1}{j\\omega+1}\\right| = \\frac{1}{\\sqrt{\\omega^2+1}}, \\quad \\sigma_2 = \\left|\\frac{1}{j\\omega+0.1}\\right| = \\frac{1}{\\sqrt{\\omega^2+0.01}}\n$$\n对于任何 $\\omega \\ge 0$，我们有 $\\omega^2+1 > \\omega^2+0.01$，这意味着 $\\sigma_1 < \\sigma_2$。因此，$\\sigma_{\\max} = \\sigma_2$ 且 $\\sigma_{\\min} = \\sigma_1$。\n条件数为：\n$$\n\\kappa(G_2(j\\omega)) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{\\sigma_2}{\\sigma_1} = \\frac{\\sqrt{\\omega^2+1}}{\\sqrt{\\omega^2+0.01}}\n$$\n为了找到 $K_{\\max,2}$，我们必须在 $\\omega \\in [10^{-2}, 10^2]$ 上找到该函数的最大值。该函数对于 $\\omega > 0$ 是单调递减的。因此，最大值出现在网格中的最低频率处，即 $\\omega = 10^{-2}$。\n$$\nK_{\\max,2} = \\kappa(G_2(j \\cdot 10^{-2})) = \\sqrt{\\frac{(10^{-2})^2+1}{(10^{-2})^2+0.01}} = \\sqrt{\\frac{1.0001}{0.0101}} \\approx 9.95086\n$$\n四舍五入到三位小数得到 $K_{\\max,2} = 9.951$。\n由于 $9.951 \\le 50$，该系统被声明为**安全**。\n\n**测试用例 3 (MIMO, 病态):**\n系统由 $A_3 = -I$，$B_3 = I$，$C_3 = \\begin{bmatrix} 1 & 1 \\\\ 1 & 1+\\varepsilon \\end{bmatrix}$（其中 $\\varepsilon = 10^{-3}$）和 $D_3 = 0$ 给出。\n频率响应为：\n$$\nG_3(j\\omega) = C_3(j\\omega I - (-I))^{-1}B_3 + D_3 = C_3((j\\omega+1)I)^{-1}I = \\frac{1}{j\\omega+1}C_3\n$$\n条件数具有这样的性质：对于任何非零标量 $\\alpha$，$\\kappa(\\alpha M) = \\kappa(M)$。项 $\\frac{1}{j\\omega+1}$ 对于所有 $\\omega$ 都是一个非零标量。因此，条件数在所有频率上都是恒定的：\n$$\n\\kappa(G_3(j\\omega)) = \\kappa(C_3) = \\kappa\\left(\\begin{bmatrix} 1 & 1 \\\\ 1 & 1+10^{-3} \\end{bmatrix}\\right)\n$$\n矩阵 $C_3$ 近似奇异，因为它的列向量几乎共线，这表明其条件数很高。我们可以数值计算这个值。$C_3$ 的奇异值约为 $\\sigma_{\\max} \\approx 2.0005$ 和 $\\sigma_{\\min} \\approx 0.0005$。\n条件数为 $\\kappa(C_3) = \\sigma_{\\max}/\\sigma_{\\min} \\approx 4002.0005$。\n因此，$K_{\\max,3} = \\kappa(C_3) \\approx 4002.0005$。\n四舍五入到三位小数得到 $K_{\\max,3} = 4002.000$。\n由于 $4002.000 > 50$，该系统被声明为**不安全**。\n\n结果总结如下：\n- 案例1：$K_{\\max,1} = 1.000$，安全性 = 真。\n- 案例2：$K_{\\max,2} = 9.951$，安全性 = 真。\n- 案例3：$K_{\\max,3} = 4002.000$，安全性 = 假。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum condition number for three LTI systems over a\n    frequency grid and determines if inversion is 'safe' based on a threshold.\n    \"\"\"\n    K_SAFE = 50.0\n    omega_grid = np.logspace(-2, 2, num=200)\n\n    # Test Case 1: SISO system\n    A1 = np.array([[-2.0]])\n    B1 = np.array([[1.0]])\n    C1 = np.array([[1.0]])\n    D1 = np.array([[0.0]])\n\n    # Test Case 2: MIMO, well-conditioned\n    A2 = np.array([[-1.0, 0.0], [0.0, -0.1]])\n    B2 = np.array([[1.0, 0.0], [0.0, 1.0]])\n    C2 = np.array([[1.0, 0.0], [0.0, 1.0]])\n    D2 = np.array([[0.0, 0.0]])\n\n    # Test Case 3: MIMO, ill-conditioned\n    epsilon = 1e-3\n    A3 = np.array([[-1.0, 0.0], [0.0, -1.0]])\n    B3 = np.array([[1.0, 0.0], [0.0, 1.0]])\n    C3 = np.array([[1.0, 1.0], [1.0, 1.0 + epsilon]])\n    D3 = np.array([[0.0, 0.0]])\n\n    test_cases = [\n        (A1, B1, C1, D1),\n        (A2, B2, C2, D2),\n        (A3, B3, C3, D3)\n    ]\n\n    final_results = []\n\n    for A, B, C, D in test_cases:\n        k_max = 0.0\n        n = A.shape[0]\n        m = B.shape[1]\n        p = C.shape[0]\n\n        condition_numbers = []\n\n        for omega in omega_grid:\n            s = 1j * omega\n            \n            # G(jω) = C * (jωI - A)^-1 * B + D\n            # A numerically stable way to compute this is to solve\n            # (jωI - A)X = B for X, then G = CX + D.\n            try:\n                # The matrix (sI - A) is guaranteed to be invertible for stable A\n                # and real omega.\n                X = np.linalg.solve(s * np.eye(n) - A, B)\n                G_jw = C @ X + D\n            except np.linalg.LinAlgError:\n                # This case should not be reached with the given stable systems.\n                # If it were, the condition number would be infinite.\n                condition_numbers.append(np.inf)\n                continue\n\n            # For a scalar, the condition number is 1 (for non-zero case).\n            if p == 1 and m == 1:\n                # G_jw is a 1x1 matrix.\n                if np.abs(G_jw[0, 0]) > 1e-12: # Check for non-zero to be safe\n                    cond_num = 1.0\n                else: \n                    # If G_jw is zero, it is singular.\n                    cond_num = np.inf\n            else:\n                cond_num = np.linalg.cond(G_jw)\n            \n            condition_numbers.append(cond_num)\n        \n        k_max = np.max(condition_numbers)\n        \n        is_safe = k_max <= K_SAFE\n        \n        # Round the final maximum condition number to three decimal places.\n        # np.round doesn't work on inf, but the problem cases give finite numbers.\n        rounded_k_max = round(k_max, 3)\n        \n        final_results.append([rounded_k_max, is_safe])\n\n    # Format the output string exactly as required.\n    output_parts = []\n    for k_val, safe_bool in final_results:\n        # Format the float to always have three decimal places\n        k_str = f\"{k_val:.3f}\"\n        # str(bool) correctly gives 'True' or 'False'\n        s_str = str(safe_bool)\n        output_parts.append(f\"[{k_str},{s_str}]\")\n        \n    print(f\"[[{','.join(output_parts)}]]\")\n\nsolve()\n```"
        }
    ]
}