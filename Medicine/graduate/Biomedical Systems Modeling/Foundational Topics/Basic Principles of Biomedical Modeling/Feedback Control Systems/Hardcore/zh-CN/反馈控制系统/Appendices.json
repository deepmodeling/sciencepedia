{
    "hands_on_practices": [
        {
            "introduction": "在将理论应用于实践时，一个核心挑战是将连续时间的生理过程与离散时间的数字控制器连接起来。本练习将指导您完成一个基础但至关重要的任务：为一个连续时间的药代动力学（PK）模型推导其在零阶保持（ZOH）下的精确离散时间表示 。掌握这项技术对于任何生理系统的数字反馈控制的实际实现、仿真和分析都至关重要。",
            "id": "3885564",
            "problem": "考虑一个用于镇静患者药物输注反馈控制的双室静脉药代动力学（PK）模型。设状态分别为中央室中的药物量 $x_{1}(t)$ 和外周室中的药物量 $x_{2}(t)$。输入 $u(t)$ 是进入中央室的输注速率（单位时间内的质量）。室间转移速率常数为 $k_{12} > 0$（从中央室到外周室）和 $k_{21} > 0$（从外周室到中央室），从中央室的消除速率常数为 $k_{10} > 0$。根据质量平衡原理和一级动力学，连续时间线性时不变模型为\n$$\n\\frac{d}{dt}\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix}\n-(k_{10} + k_{12})  k_{21} \\\\\nk_{12}  -k_{21}\n\\end{pmatrix}}_{A}\n\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n+\n\\underbrace{\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}}_{B} u(t).\n$$\n一个数字控制器每 $T_{s} > 0$ 秒对系统进行采样，并在每个采样间隔内向输液泵施加分段恒定的指令。具体来说，在零阶保持器（ZOH）下，每个采样间隔内的输入保持恒定：$u(t) = u_{k}$，其中 $t \\in [k T_{s}, (k+1) T_{s})$，$u_{k}$ 是控制器在时间 $k T_{s}$ 计算的采样输入。\n\n请根据上述连续时间动态和 ZOH 输入，推导形式为 $x_{k+1} = A_{d} x_{k} + B_{d} u_{k}$ 的离散时间模型，其中 $x_{k} \\triangleq x(k T_{s})$。请将 $A_{d}$ 和 $B_{d}$ 表示为 $A$、$B$ 和 $T_{s}$ 的闭式解析表达式。您必须只提供符号表达式；不要代入数值。最终答案必须是使用矩阵表示法写在单行中的有序对 $(A_{d}, B_{d})$，且最终答案中不应包含物理单位。",
            "solution": "起点是由质量平衡和一级动力学推导出的连续时间线性时不变状态空间模型：\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\n其中 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$ 是药物量的状态向量，$u(t)$ 是输注速率输入，而矩阵\n$$\nA = \\begin{pmatrix}\n-(k_{10} + k_{12})  k_{21} \\\\\nk_{12}  -k_{21}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n汇集了速率常数和跨室的输入分布。该模型是线性时不变的，因此其在任何输入下的解都可以通过常数变易法公式很好地描述，这是线性系统理论中一个经过充分检验的结果：\n$$\nx(t) = \\exp(A (t - t_{0})) x(t_{0}) + \\int_{t_{0}}^{t} \\exp(A (t - \\tau)) B u(\\tau) \\, d\\tau,\n$$\n其中 $\\exp(\\cdot)$ 表示矩阵指数，$t_{0}$ 是初始时间。\n\n在零阶保持器（ZOH）下，$u(t)$ 在每个采样间隔内是分段恒定的，即 $u(t) = u_{k}$，其中 $t \\in [k T_{s}, (k+1) T_{s})$。设 $t_{0} = k T_{s}$ 和 $t = (k+1) T_{s}$，并定义 $x_{k} \\triangleq x(k T_{s})$ 和 $x_{k+1} \\triangleq x((k+1) T_{s})$，解变为\n$$\nx_{k+1} = \\exp(A T_{s}) x_{k} + \\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B u(\\tau) \\, d\\tau.\n$$\n由于在 $[k T_{s}, (k+1) T_{s})$ 上 $u(\\tau) = u_{k}$ 是常数，我们可以将 $u_{k}$ 从积分中提出并进行变量代换。令 $\\theta = (k+1) T_{s} - \\tau$，那么当 $\\tau$ 从 $k T_{s}$ 变为 $(k+1) T_{s}$ 时，$\\theta$ 从 $T_{s}$ 减小到 $0$。反转积分限，\n$$\n\\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B \\, d\\tau\n= \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\n因此，在 ZOH 下的精确离散时间模型是\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k},\n$$\n其中\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\n\n为了得到 $B_{d}$ 的闭式表达式，我们使用一个关于矩阵指数积分的熟知恒等式。假定 $A$ 是非奇异的，此条件在此成立，因为\n$$\n\\det(A) = k_{21} k_{10} > 0,\n$$\n我们有\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta = A^{-1} \\left( \\exp(A T_{s}) - I \\right),\n$$\n其中 $I$ 是适当维度的单位矩阵。这个恒等式可以通过对 $\\exp(A \\theta)$ 关于 $\\theta$ 求导并观察到 $A \\exp(A \\theta) = \\frac{d}{d\\theta} \\exp(A \\theta)$ 而得出，从而得到\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta\n= \\left[ A^{-1} \\exp(A \\theta) \\right]_{0}^{T_{s}}\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right).\n$$\n在右侧乘以 $B$ 得到\n$$\nB_{d} = \\left( \\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta \\right) B\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right) B.\n$$\n\n汇总结果，离散时间模型矩阵为\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = A^{-1} \\left( \\exp(A T_{s}) - I \\right) B,\n$$\n它们是关于 $A$、$B$ 和 $T_{s}$ 的闭式解析表达式，在对 PK 模型进行零阶保持器采样的情况下有效。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\exp(A T_{s})  A^{-1}\\!\\left(\\exp(A T_{s}) - I\\right) B \\end{pmatrix}}$$"
        },
        {
            "introduction": "时间延迟是生物反馈回路中一个普遍存在的特征，例如激素信号传导或药物转运过程，它往往是导致系统振荡或不稳定的根源。本练习探讨如何通过“线性链技巧”（一种Pade近似）来为分布式延迟建立一个有限维模型，并分析其对闭环系统稳定性的影响 。通过推导使系统失稳的临界延迟时间，您将对内在延迟如何限制反馈控制性能获得深刻的洞察。",
            "id": "3885548",
            "problem": "考虑一个标量生物医学变量 $x(t)$（例如，受调控的血液变量浓度与设定点之间的偏差）在负反馈下的线性时不变（LTI）闭环模型。开环对象是一个具有一阶消除和驱动有效性的单室，由以下质量平衡方程描述：\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t),\n$$\n其中 $a>0$ 是消除率，$b>0$ 是驱动有效性，$u_{\\text{del}}(t)$ 是经过分布式延迟（代表合成、运输和受体结合效应）后的驱动信号。反馈控制器是比例控制器，$u(t) = -k\\,x(t)$，其中 $k>0$。\n\n为近似平均延迟为 $\\tau>0$ 的分布式延迟，使用具有 $N=2$ 个一阶阶段的线性链技巧，每个阶段具有共同的转移率 $\\alpha$，因此平均延迟满足 $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$。链状态 $z_{1}(t)$ 和 $z_{2}(t)$ 满足由未延迟的控制信号 $u(t)$ 驱动的质量平衡动态，进入对象的延迟驱动信号为 $u_{\\text{del}}(t) = z_{2}(t)$。假设所有信号都是围绕一个受调控平衡点的小偏差，因此线性化是有效的。\n\n从这些建模假设和核心定义出发，通过线性链技巧构建有限维近似，推导闭环特征方程，并分析当平均延迟 $\\tau$ 增加时（等价于 $\\alpha$ 减小时）稳定性的变化。在假设 $b\\,k > 8 a$ 以便存在有限的正临界延迟的条件下，确定闭环系统首次因一对共轭复根穿过虚轴而失去渐近稳定性的最小正平均延迟 $\\tau_{c}$。将你的最终答案 $\\tau_{c}$（以秒为单位）表示为关于 $a$、$b$ 和 $k$ 的单个闭式解析表达式，其中 $a>0$, $b>0$, $k>0$。无需进行数值计算。",
            "solution": "该问题是良定的，具有科学依据，并包含足以确定唯一解的充分信息。它描述了控制理论中的一个标准问题——时滞反馈系统的稳定性分析。使用线性链技巧来近似分布式延迟是一种有效且常用的技术。所给条件 $b\\,k > 8 a$ 确保了系统失去稳定性存在一个有限的临界延迟，这与此类系统的物理特性一致。因此，该问题是有效的。\n\n系统动态由以下线性时不变（LTI）常微分方程组描述。生物医学变量 $x(t)$ 的对象动态由下式给出：\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t)\n$$\n其中 $a>0$，$b>0$。驱动信号 $u_{\\text{del}}(t)$ 是一个近似分布式延迟的两阶线性链的输出。该链的输入是比例控制律：\n$$\nu(t) = -k\\,x(t)\n$$\n其中 $k>0$。具有 $N=2$ 个阶段和转移率 $\\alpha$ 的线性链由状态变量 $z_1(t)$ 和 $z_2(t)$ 描述：\n$$\n\\frac{d z_1(t)}{d t} = \\alpha\\,(u(t) - z_1(t)) = \\alpha\\,(-k\\,x(t) - z_1(t))\n$$\n$$\n\\frac{d z_2(t)}{d t} = \\alpha\\,(z_1(t) - z_2(t))\n$$\n延迟后的驱动是第二阶段的输出，$u_{\\text{del}}(t) = z_2(t)$。平均延迟为 $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$。\n\n我们可以将这些方程组合成一个单一的状态空间模型。设状态向量为 $\\mathbf{v}(t) = \\begin{pmatrix} x(t)  z_1(t)  z_2(t) \\end{pmatrix}^T$。系统动态为 $\\frac{d\\mathbf{v}}{dt} = \\mathbf{A}\\,\\mathbf{v}$，其中系统矩阵 $\\mathbf{A}$ 为：\n$$\n\\mathbf{A} = \\begin{pmatrix} -a  0  b \\\\ -\\alpha k  -\\alpha  0 \\\\ 0  \\alpha  -\\alpha \\end{pmatrix}\n$$\n系统的稳定性由 $\\mathbf{A}$ 的特征值决定，这些特征值是特征方程 $\\det(s\\mathbf{I} - \\mathbf{A}) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} s+a  0  -b \\\\ \\alpha k  s+\\alpha  0 \\\\ 0  -\\alpha  s+\\alpha \\end{pmatrix} = 0\n$$\n我们沿第一行进行代数余子式展开来计算行列式：\n$$\n(s+a) \\det \\begin{pmatrix} s+\\alpha  0 \\\\ -\\alpha  s+\\alpha \\end{pmatrix} - (0) \\cdot (\\dots) + (-b) \\det \\begin{pmatrix} \\alpha k  s+\\alpha \\\\ 0  -\\alpha \\end{pmatrix} = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 - b((\\alpha k)(-\\alpha) - 0) = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 + b k \\alpha^2 = 0\n$$\n展开多项式得到特征方程：\n$$\n(s+a)(s^2 + 2\\alpha s + \\alpha^2) + b k \\alpha^2 = 0\n$$\n$$\ns^3 + 2\\alpha s^2 + \\alpha^2 s + a s^2 + 2a\\alpha s + a\\alpha^2 + b k \\alpha^2 = 0\n$$\n$$\ns^3 + (a+2\\alpha)s^2 + \\alpha(\\alpha+2a)s + \\alpha^2(a+bk) = 0\n$$\n当一对共轭复根穿过虚轴时，系统失去稳定性。这发生在存在某个实频率 $\\omega > 0$ 的根 $s=i\\omega$ 时。我们将 $s=i\\omega$ 代入特征方程：\n$$\n(i\\omega)^3 + (a+2\\alpha)(i\\omega)^2 + \\alpha(\\alpha+2a)(i\\omega) + \\alpha^2(a+bk) = 0\n$$\n$$\n-i\\omega^3 - (a+2\\alpha)\\omega^2 + i\\alpha(\\alpha+2a)\\omega + \\alpha^2(a+bk) = 0\n$$\n要使该方程成立，其实部和虚部都必须为零。\n实部：\n$$\n-(a+2\\alpha)\\omega^2 + \\alpha^2(a+bk) = 0 \\quad (1)\n$$\n虚部：\n$$\n-\\omega^3 + \\alpha(\\alpha+2a)\\omega = 0\n$$\n对虚部方程进行因式分解得到 $\\omega(-\\omega^2 + \\alpha(\\alpha+2a)) = 0$。一个解是 $\\omega=0$，对应于非振荡性失稳。如果 $s=0$，特征方程变为 $\\alpha^2(a+bk)=0$。由于 $a, b, k, \\alpha$ 均为正数，此式不能为零。因此，稳定性是通过振荡性失稳（霍普夫分岔）失去的，这意味着 $\\omega \\neq 0$。这表明：\n$$\n\\omega^2 = \\alpha(\\alpha+2a) \\quad (2)\n$$\n由于 $\\omega^2 > 0$ 且 $a>0$，这要求 $\\alpha>0$，这与其作为速率的定义一致。现在我们将 $\\omega^2$ 的这个表达式代入实部方程 $(1)$：\n$$\n-(a+2\\alpha)[\\alpha(\\alpha+2a)] + \\alpha^2(a+bk) = 0\n$$\n由于 $\\alpha$ 的临界值必须为正，我们可以除以 $\\alpha$：\n$$\n-(a+2\\alpha)(\\alpha+2a) + \\alpha(a+bk) = 0\n$$\n$$\n-(2\\alpha^2 + 4a\\alpha + a\\alpha + 2a^2) + \\alpha a + \\alpha bk = 0\n$$\n$$\n-2\\alpha^2 - 5a\\alpha - 2a^2 + a\\alpha + bk\\alpha = 0\n$$\n$$\n-2\\alpha^2 + (bk - 4a)\\alpha - 2a^2 = 0\n$$\n乘以 $-1$ 得到一个关于 $\\alpha$ 的临界值（记为 $\\alpha_c$）的二次方程：\n$$\n2\\alpha_c^2 - (bk-4a)\\alpha_c + 2a^2 = 0\n$$\n我们使用二次方程求根公式求解 $\\alpha_c$：\n$$\n\\alpha_c = \\frac{(bk-4a) \\pm \\sqrt{(-(bk-4a))^2 - 4(2)(2a^2)}}{2(2)}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{(bk-4a)^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk + 16a^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk}}{4} = \\frac{bk-4a \\pm \\sqrt{bk(bk - 8a)}}{4}\n$$\n问题陈述 $bk > 8a$，这确保了判别式 $bk(bk-8a)$ 为正，因此存在两个不同的正实根 $\\alpha_c$。我们称它们为 $\\alpha_{c1}$ 和 $\\alpha_{c2}$。\n当满足劳斯-赫尔维茨条件时，系统是稳定的。临界条件是 $p_2 p_1 - p_0 > 0$，其中 $p_2=(a+2\\alpha)$，$p_1=\\alpha(\\alpha+2a)$，$p_0=\\alpha^2(a+bk)$。稳定性边界在 $p_2 p_1 - p_0 = 0$ 处，这导出了我们关于 $\\alpha_c$ 的二次方程。表达式 $2\\alpha^2 - (bk-4a)\\alpha + 2a^2$ 是一个开口向上的抛物线。在它的两个根 $\\alpha_{c2}$（较小的根）和 $\\alpha_{c1}$（较大的根）之间，该表达式为负，这对应于不稳定。\n系统以一个非常小的延迟 $\\tau \\approx 0$ 开始，这对应于一个非常大的速率 $\\alpha \\to \\infty$。在此极限下，系统是稳定的。随着延迟 $\\tau$ 从 $0$ 增加，$\\alpha = 2/\\tau$ 从 $\\infty$ 减小。当 $\\alpha$ 减小到较大的根 $\\alpha_{c1}$ 时，系统首次失去稳定性：\n$$\n\\alpha_{c1} = \\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}\n$$\n问题要求的是系统首次失去稳定性的最小正平均延迟 $\\tau_c$。这对应于最大的临界速率 $\\alpha_{c1}$。临界延迟为：\n$$\n\\tau_c = \\frac{2}{\\alpha_{c1}} = \\frac{2}{\\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}}\n$$\n$$\n\\tau_c = \\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}\n$$\n这就是临界延迟的闭式表达式。",
            "answer": "$$\\boxed{\\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}}$$"
        },
        {
            "introduction": "许多生物医学系统，如信号级联或基因调控网络，其固有的非线性特性对传统的线性控制方法构成了巨大挑战。本练习将引导您运用一种强大的非线性控制技术——精确输入-输出线性化，为一个非线性的生理级联模型设计控制器 。您不仅将学习如何精确抵消系统的非线性，还将深入探索“零动态”这一关键概念，并学会如何通过设计输出来确保系统内部状态的稳定性，这是高级控制设计中的一个核心考量。",
            "id": "3885559",
            "problem": "一个三状态单输入单输出 (SISO) 生理级联被建模为一个控制仿射非线性系统，其状态向量为 $x = (x_{1}, x_{2}, x_{3})$，其中 $x_{1}$ 代表循环生物标志物浓度，$x_{2}$ 是一个中间介质，$x_{3}$ 是一个受体占据状态。输注控制输入 $u$ 作用于该中间介质。其动力学方程为\n$$\n\\begin{aligned}\n\\dot{x}_{1} = -a\\,x_{1} + x_{2}, \\\\\n\\dot{x}_{2} = -b\\,x_{2} + s\\,x_{3} + u, \\\\\n\\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2},\n\\end{aligned}\n$$\n其中 $a, b, c, d, s \\in \\mathbb{R}_{0}$ 均为严格正常数。测量的输出选择为 $y = h(x) = x_{1} + p\\,x_{3}$，其中 $p \\in \\mathbb{R}$ 是一个设计参数。\n\n从控制仿射系统的李导数定义出发，即 $L_{f} h(x) = \\nabla h(x) \\cdot f(x)$ 和 $L_{g} h(x) = \\nabla h(x) \\cdot g(x)$，其中 $f(x)$ 是漂移向量场，$g(x)$ 是 $\\dot{x} = f(x) + g(x)\\,u$ 中的输入向量场，执行以下操作：\n\n1. 计算一阶李导数 $L_{f} h(x)$ 和 $L_{g} h(x)$，并在条件 $p \\neq -\\frac{1}{d}$ 下确定在 $x$ 处的相对阶。\n2. 计算相对阶为二的精确输入输出线性化所需的高阶李导数，特别是 $L_{f}^{2} h(x)$ 和 $L_{g} L_{f} h(x)$。\n3. 使用SISO控制仿射系统的基本输入输出线性化原理（不调用问题中给出的任何快捷公式），推导状态依赖的输入变换，使得输入输出动力学对于新输入 $v$ 呈二阶线性，从而闭环输入输出行为是一个由 $v$ 驱动的双积分器。\n4. 推导与限制在零输出流形 $y \\equiv 0$ 和 $v \\equiv 0$ 上得到的内部坐标相关的零动态。说明 $p$ 的选择如何影响零动态的稳定性，并选择 $p$ 以确保内部动态的指数稳定性。从第一性原理证明你的选择。\n\n你的最终答案必须是关于输入变换的一个单一闭式解析表达式，用 $x_{1}$, $x_{2}$, $x_{3}$, $a$, $b$, $c$, $d$, $s$, $p$ 和 $v$ 表示。最终答案中不要包含等号。不需要单位。不需要四舍五入。",
            "solution": "该问题提出了一个控制仿射非线性系统，并要求推导一个输入输出线性化控制器，同时分析系统的零动态。问题陈述在控制理论和系统生物学方面具有科学依据，问题提出得当且客观。所有必要信息均已提供。因此，该问题是有效的，我们开始求解。\n\n系统动力学由 $\\dot{x} = f(x) + g(x)u$ 给出，其中 $x = (x_{1}, x_{2}, x_{3})$ 是状态向量，$u$ 是控制输入。\n根据给定的方程：\n$$\n\\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\end{pmatrix} = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} u\n$$\n漂移向量场 $f(x)$ 和输入向量场 $g(x)$ 是：\n$$\nf(x) = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n输出为 $y = h(x) = x_{1} + p\\,x_{3}$。\n\n**1. 一阶李导数与相对阶**\n\n为了求相对阶，我们连续计算 $h(x)$ 的李导数，直到输入 $u$ 显式出现为止。输出的时间导数为 $\\dot{y} = \\frac{\\partial h}{\\partial x} \\dot{x} = \\nabla h(x) \\cdot (f(x) + g(x)u) = L_f h(x) + L_g h(x) u$。\n\n$h(x)$ 的梯度是 $\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1}  \\frac{\\partial h}{\\partial x_2}  \\frac{\\partial h}{\\partial x_3} \\end{pmatrix} = \\begin{pmatrix} 1  0  p \\end{pmatrix}$。\n\n首先，我们计算 $h(x)$ 关于 $g(x)$ 的李导数：\n$$\nL_{g} h(x) = \\nabla h(x) \\cdot g(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 0\n$$\n由于 $L_{g} h(x) = 0$，输入 $u$ 不会出现在输出的一阶导数中。相对阶至少为二。\n\n接下来，我们计算 $h(x)$ 关于 $f(x)$ 的李导数：\n$$\nL_{f} h(x) = \\nabla h(x) \\cdot f(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f} h(x) = 1(-a\\,x_{1} + x_{2}) + 0(-b\\,x_{2} + s\\,x_{3}) + p(-c\\,x_{3} + d\\,x_{2}) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}\n$$\n所以，输出的一阶时间导数为 $\\dot{y} = L_{f} h(x)$。\n\n**2. 相对阶为二的高阶李导数**\n\n为了求输出的二阶导数，我们对 $\\dot{y}$ 求导：\n$$\n\\ddot{y} = \\frac{d}{dt}(L_{f} h(x)) = \\nabla(L_{f} h(x)) \\cdot \\dot{x} = \\nabla(L_{f} h(x)) \\cdot (f(x) + g(x)u)\n$$\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u\n$$\n我们需要计算 $L_{f}^{2} h(x)$ 和 $L_{g} L_{f} h(x)$ 这两项。令 $\\psi(x) = L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}$。$\\psi(x)$ 的梯度是：\n$$\n\\nabla \\psi(x) = \\nabla(L_{f} h(x)) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix}\n$$\n现在我们可以计算 $L_{g} L_{f} h(x)$:\n$$\nL_{g} L_{f} h(x) = \\nabla(L_{f} h(x)) \\cdot g(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 1+p\\,d\n$$\n问题陈述了条件 $p \\neq -1/d$，这确保了 $L_{g} L_{f} h(x) = 1+p\\,d \\neq 0$。由于 $L_{g} h(x) = 0$ 且 $L_{g} L_{f} h(x) \\neq 0$，系统的相对阶对于所有 $x$ 都恰好为二。\n\n接下来，我们计算 $L_{f}^{2} h(x) = L_{f}(L_f h(x))$:\n$$\nL_{f}^{2} h(x) = \\nabla(L_{f} h(x)) \\cdot f(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f}^{2} h(x) = -a(-a\\,x_{1} + x_{2}) + (1+p\\,d)(-b\\,x_{2} + s\\,x_{3}) - p\\,c(-c\\,x_{3} + d\\,x_{2})\n$$\n展开并合并 $x_{1}$、$x_{2}$ 和 $x_{3}$ 的项：\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - a\\,x_{2} - b\\,x_{2} - b\\,p\\,d\\,x_{2} + s\\,x_{3} + s\\,p\\,d\\,x_{3} + p\\,c^{2}x_{3} - p\\,c\\,d\\,x_{2}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} + (-a - b - b\\,p\\,d - p\\,c\\,d)x_{2} + (s + s\\,p\\,d + p\\,c^{2})x_{3}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3}\n$$\n\n**3. 输入输出线性化控制律**\n\n目标是找到一个关于 $u$ 的状态反馈控制律，使得输入输出动力学呈线性 $\\ddot{y} = v$，其中 $v$ 是一个新的外部输入。我们将推导出的 $\\ddot{y}$ 表达式设为等于 $v$：\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u = v\n$$\n$$\na^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} + (1+p\\,d)u = v\n$$\n解出控制输入 $u$：\n$$\n(1+p\\,d)u = v - \\left[ a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} \\right]\n$$\n$$\nu = \\frac{1}{1+p\\,d} \\left( v - a^{2}x_{1} + (a+b+p(b\\,d+c\\,d))x_{2} - (s+p(s\\,d+c^{2}))x_{3} \\right)\n$$\n这就是所要求的输入变换。\n\n**4. 零动态分析**\n\n零动态是当输出在所有时间内保持为零（即 $y(t) \\equiv 0$）时系统的内部动态。这意味着输出的所有时间导数也为零。对于一个相对阶为二的系统，我们要求 $y(t)=0$ 和 $\\dot{y}(t)=0$。\n这可以通过设置新输入 $v=0$ 来实现，从而使 $\\ddot{y}=0$。状态轨迹则被限制在零动态流形 $Z^* = \\{x \\in \\mathbb{R}^3 \\mid h(x)=0, L_f h(x)=0 \\}$ 上。\n\n1.  $h(x) = x_{1} + p\\,x_{3} = 0 \\implies x_{1} = -p\\,x_{3}$\n2.  $L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0$\n\n将第一个方程中的 $x_{1}$ 代入第二个方程：\n$$\n-a(-p\\,x_{3}) + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\na\\,p\\,x_{3} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\n(1+p\\,d)x_{2} + p(a-c)x_{3} = 0\n$$\n由于 $1+p\\,d \\neq 0$，我们可以解出 $x_{2}$：\n$$\nx_{2} = -\\frac{p(a-c)}{1+p\\,d} x_{3}\n$$\n在 $Z^*$ 上，系统的状态完全由 $x_3$ 决定。我们选择 $\\eta = x_3$ 作为一维内部动态的坐标。该动态由在 $Z^*$ 上计算的 $\\dot{\\eta} = \\dot{x}_{3}$ 给出。\n$$\n\\dot{\\eta} = \\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2}\n$$\n代入在 $Z^*$ 上的 $x_{2}$ 表达式：\n$$\n\\dot{\\eta} = -c\\,\\eta + d \\left( -\\frac{p(a-c)}{1+p\\,d} \\eta \\right) = \\left( -c - \\frac{d\\,p(a-c)}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c(1+p\\,d) - d\\,p(a-c)}{1+p\\,d} \\right) \\eta = \\left( \\frac{-c - c\\,p\\,d - a\\,d\\,p + c\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c - a\\,d\\,p}{1+p\\,d} \\right) \\eta = -\\left( \\frac{c + a\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\n如果特征值 $\\lambda = -\\frac{c + a\\,d\\,p}{1+p\\,d}$ 严格为负，则零动态是指数稳定的。这要求该分式为正：\n$$\n\\frac{c + a\\,d\\,p}{1+p\\,d} > 0\n$$\n由于 $a, c, d$ 都是严格正常数，保证稳定性的一个充分条件是选择设计参数 $p$，使分子和分母都为正。\n1. 分母为正：$1+p\\,d > 0 \\implies p\\,d > -1 \\implies p > -1/d$。\n2. 分子为正：$c+a\\,d\\,p > 0 \\implies a\\,d\\,p > -c \\implies p > -c/(a\\,d)$。\n为同时满足这两个条件，我们必须选择 $p > \\max\\left(-\\frac{1}{d}, -\\frac{c}{a\\,d}\\right)$。由于两个阈值都为负，任何 $p \\ge 0$ 的选择都能确保零动态的指数稳定性。一个简单有效的选择是 $p=0$。这个选择对应于仅测量生物标志物浓度 $x_{1}$ 作为输出。\n\n根据要求，输入变换的最终表达式仍然用通用参数 $p$ 表示。",
            "answer": "$$\n\\boxed{\\frac{1}{1+p\\,d} \\left( v - a^{2} x_{1} + \\left( a+b+p(b\\,d+c\\,d) \\right) x_{2} - \\left( s+p(s\\,d+c^{2}) \\right) x_{3} \\right)}\n$$"
        }
    ]
}