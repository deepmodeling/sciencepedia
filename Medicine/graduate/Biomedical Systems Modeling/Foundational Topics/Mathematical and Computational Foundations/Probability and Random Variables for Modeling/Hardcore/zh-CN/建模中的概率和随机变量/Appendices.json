{
    "hands_on_practices": [
        {
            "introduction": "本练习从概率论的基础出发，要求从第一性原理推导条件概率密度函数的公式，从而加深对理论基础的理解。将其应用于二元正态分布不仅是一项数学练习，更揭示了“向均值回归”这一重要的统计现象。在比较或校准两种不同的生物医学测量技术时，理解这一效应至关重要 。",
            "id": "3922069",
            "problem": "在一项旨在评估方法间一致性的配对生物标志物评估中，一个研究团队比较了通过酶联免疫吸附测定（ELISA）和质谱法（MS）测量的血浆白细胞介素-6浓度。令$X$表示同一份样本的MS读数，$Y$表示其ELISA读数。该团队将这对读数$(X,Y)$建模为一个连续随机向量，其联合概率密度函数（pdf）为$f_{X,Y}(x,y)$，边际概率密度函数分别为$f_{X}(x)$和$f_{Y}(y)$。\n\n任务1（从第一性原理推导）：仅从连续随机变量的联合概率密度函数、边际概率密度函数以及条件概率的定义出发，推导条件概率密度函数$f_{X \\mid Y}(x \\mid y)$，并用$f_{X,Y}(x,y)$和$f_{Y}(y)$表示。\n\n任务2（二元正态分布特例与计算）：假设$(X,Y)$服从联合高斯分布（二元正态分布），其均值分别为$\\mu_{X}$和$\\mu_{Y}$，标准差分别为$\\sigma_{X}$和$\\sigma_{Y}$，相关系数为$\\rho$。使用任务1的结果以及已知的二元正态概率密度函数形式，推导条件分布$X \\mid Y=y$，并用参数$(\\mu_{X},\\mu_{Y},\\sigma_{X},\\sigma_{Y},\\rho)$和实现值$y$来表示其均值和方差。然后，在以下科学上合理的场景中，计算条件均值，以展示$X$向由$Y$决定的回归线收缩的典型特征：\n- $\\mu_{X} = 5$ $\\mathrm{ng/mL}$，$\\mu_{Y} = 5$ $\\mathrm{ng/mL}$，\n- $\\sigma_{X} = 1.2$ $\\mathrm{ng/mL}$，$\\sigma_{Y} = 1.6$ $\\mathrm{ng/mL}$，\n- $\\rho = 0.65$，\n- 观测值 $Y = y = 8.2$ $\\mathrm{ng/mL}$。\n\n答案规范：\n- 仅报告此场景下的条件均值$\\mathbb{E}[X \\mid Y=y]$作为最终答案。\n- 将答案四舍五入至四位有效数字。\n- 以 $\\mathrm{ng/mL}$ 为单位表示最终数值。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题设定良好、客观，并包含得出唯一解所需的所有信息。其背景和参数在生物医学应用中是合理的。\n\n该问题包含两个任务。第一个任务是从第一性原理推导条件概率密度函数（pdf）的公式。第二个任务是将此公式应用于二元正态分布的特定情况，以推导条件均值和方差，然后进行数值计算。\n\n**任务1：条件概率密度函数的推导**\n\n我们从两个事件$A$和$B$的条件概率定义开始，$P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$，其中$P(B)  0$。对于连续随机变量$X$和$Y$，$Y$取特定值$y$的概率为零，即$P(Y=y)=0$。因此，我们必须使用极限论证。\n\n我们定义在$Y=y$的条件下$X$的条件累积分布函数（CDF）为$F_{X \\mid Y}(x \\mid y)$，表示概率$P(X \\le x \\mid Y=y)$。我们考虑事件$Y$落在一个小区间$(y, y+\\Delta y]$内，其中$\\Delta y  0$。条件概率为：\n$$\nP(X \\le x \\mid y  Y \\le y+\\Delta y) = \\frac{P(X \\le x, y  Y \\le y+\\Delta y)}{P(y  Y \\le y+\\Delta y)}\n$$\n对于一个小的$\\Delta y$，分子和分母中的概率可以分别使用联合概率密度函数$f_{X,Y}(u,v)$和边际概率密度函数$f_Y(v)$来近似。\n分母中的概率是：\n$$\nP(y  Y \\le y+\\Delta y) = \\int_y^{y+\\Delta y} f_Y(v) \\, dv \\approx f_Y(y) \\Delta y\n$$\n分子中的概率是：\n$$\nP(X \\le x, y  Y \\le y+\\Delta y) = \\int_{-\\infty}^x \\int_y^{y+\\Delta y} f_{X,Y}(u,v) \\, dv \\, du \\approx \\int_{-\\infty}^x f_{X,Y}(u,y) \\Delta y \\, du\n$$\n将这些近似值代入比率中，得到：\n$$\nP(X \\le x \\mid y  Y \\le y+\\Delta y) \\approx \\frac{\\left( \\int_{-\\infty}^x f_{X,Y}(u,y) \\, du \\right) \\Delta y}{f_Y(y) \\Delta y} = \\frac{\\int_{-\\infty}^x f_{X,Y}(u,y) \\, du}{f_Y(y)}\n$$\n当$\\Delta y \\to 0$时取极限，该近似变得精确，我们得到条件CDF：\n$$\nF_{X \\mid Y}(x \\mid y) = \\lim_{\\Delta y \\to 0} P(X \\le x \\mid y  Y \\le y+\\Delta y) = \\frac{\\int_{-\\infty}^x f_{X,Y}(u,y) \\, du}{f_Y(y)}\n$$\n条件概率密度函数$f_{X \\mid Y}(x \\mid y)$是条件CDF对$x$的导数。应用微积分基本定理：\n$$\nf_{X \\mid Y}(x \\mid y) = \\frac{d}{dx} F_{X \\mid Y}(x \\mid y) = \\frac{d}{dx} \\left[ \\frac{\\int_{-\\infty}^x f_{X,Y}(u,y) \\, du}{f_Y(y)} \\right] = \\frac{f_{X,Y}(x,y)}{f_Y(y)}\n$$\n这就是我们所求的条件概率密度函数的表达式，在$f_Y(y)0$的任何区域都有效。\n\n**任务2：二元正态分布特例与计算**\n\n已知$(X,Y)$服从参数为$(\\mu_X, \\mu_Y, \\sigma_X, \\sigma_Y, \\rho)$的二元正态分布。其联合概率密度函数为：\n$$\nf_{X,Y}(x,y) = \\frac{1}{2\\pi \\sigma_X \\sigma_Y \\sqrt{1-\\rho^2}} \\exp\\left( -\\frac{1}{2(1-\\rho^2)} \\left[ \\left(\\frac{x-\\mu_X}{\\sigma_X}\\right)^2 - 2\\rho\\left(\\frac{x-\\mu_X}{\\sigma_X}\\right)\\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right) + \\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right)^2 \\right] \\right)\n$$\n$Y$的边际分布也是正态分布，$Y \\sim N(\\mu_Y, \\sigma_Y^2)$，其概率密度函数为：\n$$\nf_Y(y) = \\frac{1}{\\sqrt{2\\pi} \\sigma_Y} \\exp\\left( -\\frac{1}{2} \\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right)^2 \\right)\n$$\n利用任务1的结果，我们通过将$f_{X,Y}(x,y)$除以$f_Y(y)$来求得条件概率密度函数$f_{X \\mid Y}(x \\mid y)$。\n常数前因子的比值为：\n$$\n\\frac{1/(2\\pi \\sigma_X \\sigma_Y \\sqrt{1-\\rho^2})}{1/(\\sqrt{2\\pi} \\sigma_Y)} = \\frac{1}{\\sqrt{2\\pi} \\sigma_X \\sqrt{1-\\rho^2}}\n$$\n条件概率密度函数的指数是联合概率密度函数和边际概率密度函数指数之差：\n$$\nE = -\\frac{1}{2(1-\\rho^2)} \\left[ \\left(\\frac{x-\\mu_X}{\\sigma_X}\\right)^2 - 2\\rho\\left(\\frac{x-\\mu_X}{\\sigma_X}\\right)\\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right) + \\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right)^2 \\right] - \\left( -\\frac{1}{2} \\left(\\frac{y-\\mu_Y}{\\sigma_Y}\\right)^2 \\right)\n$$\n为简化起见，令$z_x = \\frac{x-\\mu_X}{\\sigma_X}$ 和 $z_y = \\frac{y-\\mu_Y}{\\sigma_Y}$。\n$$\nE = -\\frac{1}{2(1-\\rho^2)} [ z_x^2 - 2\\rho z_x z_y + z_y^2 ] + \\frac{1-\\rho^2}{2(1-\\rho^2)} z_y^2 = -\\frac{1}{2(1-\\rho^2)} [z_x^2 - 2\\rho z_x z_y + z_y^2 - (1-\\rho^2)z_y^2]\n$$\n$$\nE = -\\frac{1}{2(1-\\rho^2)} [z_x^2 - 2\\rho z_x z_y + z_y^2 - z_y^2 + \\rho^2 z_y^2] = -\\frac{1}{2(1-\\rho^2)} [z_x^2 - 2\\rho z_x z_y + \\rho^2 z_y^2]\n$$\n方括号中的项是一个完全平方：$[z_x - \\rho z_y]^2$。\n$$\nE = -\\frac{1}{2(1-\\rho^2)} (z_x - \\rho z_y)^2\n$$\n将$z_x$和$z_y$代回：\n$$\nE = -\\frac{1}{2(1-\\rho^2)} \\left( \\frac{x-\\mu_X}{\\sigma_X} - \\rho \\frac{y-\\mu_Y}{\\sigma_Y} \\right)^2\n$$\n我们对括号内的项进行重排以分离出$x$：\n$$\n\\frac{x-\\mu_X}{\\sigma_X} - \\rho \\frac{y-\\mu_Y}{\\sigma_Y} = \\frac{1}{\\sigma_X} \\left( (x-\\mu_X) - \\rho \\frac{\\sigma_X}{\\sigma_Y}(y-\\mu_Y) \\right) = \\frac{1}{\\sigma_X} \\left( x - \\left[\\mu_X + \\rho\\frac{\\sigma_X}{\\sigma_Y}(y-\\mu_Y)\\right] \\right)\n$$\n将此代回指数表达式中：\n$$\nE = -\\frac{1}{2(1-\\rho^2)\\sigma_X^2} \\left( x - \\left[\\mu_X + \\rho\\frac{\\sigma_X}{\\sigma_Y}(y-\\mu_Y)\\right] \\right)^2\n$$\n这是一个形式为$-\\frac{(x-\\mu)^2}{2\\sigma^2}$的正态分布概率密度函数的指数。通过观察，我们可以确定条件分布$X \\mid Y=y$的参数。\n条件均值为：\n$$\n\\mathbb{E}[X \\mid Y=y] = \\mu_{X \\mid Y=y} = \\mu_X + \\rho \\frac{\\sigma_X}{\\sigma_Y}(y-\\mu_Y)\n$$\n条件方差为：\n$$\n\\mathrm{Var}(X \\mid Y=y) = \\sigma^2_{X \\mid Y=y} = \\sigma_X^2 (1-\\rho^2)\n$$\n因此，在给定$Y=y$的条件下，$X$的条件分布是正态分布：$X \\mid Y=y \\sim N(\\mu_X + \\rho\\frac{\\sigma_X}{\\sigma_Y}(y-\\mu_Y), \\sigma_X^2(1-\\rho^2))$。\n\n现在我们计算给定场景下的条件均值：\n- $\\mu_{X} = 5$\n- $\\mu_{Y} = 5$\n- $\\sigma_{X} = 1.2$\n- $\\sigma_{Y} = 1.6$\n- $\\rho = 0.65$\n- $y = 8.2$\n\n我们将这些值代入条件均值的公式中：\n$$\n\\mathbb{E}[X \\mid Y=8.2] = 5 + (0.65) \\frac{1.2}{1.6} (8.2 - 5)\n$$\n首先，计算表达式中的各项：\n$$\n\\frac{1.2}{1.6} = \\frac{3 \\times 0.4}{4 \\times 0.4} = \\frac{3}{4} = 0.75\n$$\n$$\n8.2 - 5 = 3.2\n$$\n现在，将这些结果代回均值方程中：\n$$\n\\mathbb{E}[X \\mid Y=8.2] = 5 + (0.65)(0.75)(3.2)\n$$\n$$\n\\mathbb{E}[X \\mid Y=8.2] = 5 + (0.4875)(3.2)\n$$\n$$\n\\mathbb{E}[X \\mid Y=8.2] = 5 + 1.56\n$$\n$$\n\\mathbb{E}[X \\mid Y=8.2] = 6.56\n$$\n问题要求答案四舍五入至四位有效数字。因此，结果是$6.560$。",
            "answer": "$$\n\\boxed{6.560}\n$$"
        },
        {
            "introduction": "在基础概率论之上，本练习旨在解决临床研究中的一个常见挑战：数据不完整性。通过引入在生存分析中常见的右删失概念，并推导指数生存模型的似然函数及最大似然估计（Maximum Likelihood Estimator, MLE），您将学习如何正确地整合来自观测事件和删失观测的信息。这是生物统计学中一项基石性的技能 。",
            "id": "3921993",
            "problem": "在一项关于植入式心室辅助装置的队列研究中，早期机械性堵塞被建模为具有随时间恒定的瞬时故障风险。设受试者 $i$ 的堵塞时间为连续随机变量 $T_i$，假设受试者之间相互独立，并遵循具有恒定风险率 $\\lambda$ 的指数模型。由于研究终止或失访，会发生右删失，从而得到观测时间 $Y_i = \\min(T_i, C_i)$ 和事件指示符 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$，其中 $C_i$ 是独立的删失时间。请利用风险函数 $h(t)$、生存函数 $S(t)$ 和概率密度函数 $f(t)$ 之间的基本关系，结合独立性及似然的定义，推导出在独立右删失情况下 $\\lambda$ 的似然函数。\n\n然后，使用最大似然估计（MLE）原理，求出 $\\lambda$ 的最大似然估计量关于可观测量的闭式表达式。最后，根据以下 $n=12$ 组观测对 $(Y_i, \\Delta_i)$（时间单位为天）计算其数值：\n$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$.\n将您的数值答案四舍五入至四位有效数字，并以 $\\text{day}^{-1}$ 为单位表示最终速率。\n\n此外，根据对数似然函数的曲率，简要讨论在该指数生存模型中，相对于完整（无删失）数据，右删失如何改变关于 $\\lambda$ 的信息。最终数值答案必须是单个实数。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 受试者 $i$ 的堵塞时间 $T_i$ 是一个连续随机变量。\n- 各受试者的 $T_i$ 相互独立。\n- $T_i$ 遵循具有恒定风险率 $\\lambda$ 的指数模型。\n- 发生右删失，其中 $C_i$ 是独立的删失时间。\n- 观测时间为 $Y_i = \\min(T_i, C_i)$。\n- 事件指示符为 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 受试者数量为 $n=12$。\n- 观测数据对 $(Y_i, \\Delta_i)$ 为：$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$。\n- 最终数值答案必须四舍五入至四位有效数字，并以 $\\text{day}^{-1}$ 为单位表示。\n- 最终答案框必须包含一个实数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在生存分析的统计理论中有充分依据，这是生物统计学和生物医学建模的核心课题。用于故障时间的指数模型、恒定风险率的概念、独立右删失和最大似然估计都是标准的、成熟的原理。\n- **适定性**：该问题是适定的。它清晰地定义了模型、数据结构和推断目标（推导并计算 $\\lambda$ 的最大似然估计）。它为获得唯一解提供了所有必要的信息。\n- **客观性**：该问题使用精确、客观的数学和统计术语进行陈述。\n- **完整性与一致性**：该问题是自洽且一致的。它提供了求解所需的模型、参数和数据。没有矛盾之处。\n- **现实性**：使用指数分布对设备故障进行建模并考虑删失的情景，是生物医学工程和临床试验中的一个标准且现实的应用。数据值是合理的。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。有必要给出完整解答。\n\n**似然函数的推导**\n事件时间 $T$ 由具有恒定风险率 $\\lambda$ 的指数分布建模。与此模型相关的基本函数是：\n1.  风险函数：$h(t) = \\lambda$ for $t \\ge 0$。\n2.  生存函数：$S(t) = P(T  t) = \\exp\\left(-\\int_0^t h(u) \\,du\\right) = \\exp\\left(-\\int_0^t \\lambda \\,du\\right) = \\exp(-\\lambda t)$。\n3.  概率密度函数 (PDF)：$f(t) = -\\frac{dS(t)}{dt} = - \\frac{d}{dt}\\exp(-\\lambda t) = \\lambda \\exp(-\\lambda t)$。\n\n似然函数由 $n$ 个独立受试者各自的贡献构成。受试者 $i$ 的贡献取决于其事件是被观测到还是被删失，这由 $\\Delta_i$ 指示。\n\n- 如果观测到受试者 $i$ 的事件（$\\Delta_i = 1$），则意味着故障发生在时间 $T_i = Y_i$，并且这发生在删失时间 $C_i$ 之前。对似然的贡献是在时间 $Y_i$ 发生故障的概率密度，即 $f(Y_i) = \\lambda \\exp(-\\lambda Y_i)$。\n- 如果受试者 $i$ 的观测值是右删失的（$\\Delta_i = 0$），则意味着故障时间 $T_i$ 大于删失时间 $C_i$，且观测时间为 $Y_i = C_i$。我们只知道该受试者至少存活到时间 $Y_i$。对似然的贡献是这一事件的概率，即 $P(T_i  Y_i) = S(Y_i) = \\exp(-\\lambda Y_i)$。\n\n使用事件指示符 $\\Delta_i$，可以为受试者 $i$ 的似然贡献 $L_i(\\lambda)$ 写出一个单一的表达式：\n$$L_i(\\lambda) = [f(Y_i)]^{\\Delta_i} [S(Y_i)]^{1-\\Delta_i}$$\n代入 $f(t)$ 和 $S(t)$ 的表达式：\n$$L_i(\\lambda) = [\\lambda \\exp(-\\lambda Y_i)]^{\\Delta_i} [\\exp(-\\lambda Y_i)]^{1-\\Delta_i}$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i \\Delta_i) \\exp(-\\lambda Y_i (1-\\Delta_i))$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i (\\Delta_i + 1 - \\Delta_i))$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i)$$\n由于所有受试者都是独立的，因此 $n$ 个受试者样本的总似然 $L(\\lambda)$ 是各个贡献的乘积：\n$$L(\\lambda) = \\prod_{i=1}^n L_i(\\lambda) = \\prod_{i=1}^n \\left( \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i) \\right)$$\n$$L(\\lambda) = \\left( \\prod_{i=1}^n \\lambda^{\\Delta_i} \\right) \\left( \\prod_{i=1}^n \\exp(-\\lambda Y_i) \\right)$$\n$$L(\\lambda) = \\lambda^{\\sum_{i=1}^n \\Delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^n Y_i\\right)$$\n设 $d = \\sum_{i=1}^n \\Delta_i$ 为观测到的事件总数，并设 $Y_{\\text{total}} = \\sum_{i=1}^n Y_i$ 为总观测风险时间。似然函数简化为：\n$$L(\\lambda) = \\lambda^d \\exp(-\\lambda Y_{\\text{total}})$$\n\n**最大似然估计量 (MLE) 的推导**\n为了找到 $\\lambda$ 的最大似然估计，我们需要最大化 $L(\\lambda)$。在计算上，最大化似然的自然对数，即对数似然函数 $\\ell(\\lambda)$，更为简单：\n$$\\ell(\\lambda) = \\ln(L(\\lambda)) = \\ln\\left( \\lambda^d \\exp(-\\lambda Y_{\\text{total}}) \\right)$$\n$$\\ell(\\lambda) = d \\ln(\\lambda) - \\lambda Y_{\\text{total}}$$\n为了找到最大值，我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求一阶导数，并将其设为零：\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda} (d \\ln(\\lambda) - \\lambda Y_{\\text{total}}) = \\frac{d}{\\lambda} - Y_{\\text{total}}$$\n将导数设为零以求得估计量 $\\hat{\\lambda}$：\n$$\\frac{d}{\\hat{\\lambda}} - Y_{\\text{total}} = 0 \\implies \\frac{d}{\\hat{\\lambda}} = Y_{\\text{total}}$$\n解出 $\\hat{\\lambda}$ 得到最大似然估计量：\n$$\\hat{\\lambda}_{\\text{MLE}} = \\frac{d}{Y_{\\text{total}}} = \\frac{\\sum_{i=1}^n \\Delta_i}{\\sum_{i=1}^n Y_i}$$\n这个表达式是事件总数除以总人时随访时间。为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{d\\lambda^2} = -\\frac{d}{\\lambda^2}$$\n由于事件数 $d \\ge 0$ 且 $\\lambda^2  0$，二阶导数是非正的。对于 $d  0$ 的情况，二阶导数是严格为负的，这证实了 $\\hat{\\lambda}_{\\text{MLE}}$ 对应于一个局部最大值。\n\n**数值计算**\n所提供的数据包含 $n=12$ 对 $(Y_i, \\Delta_i)$：\n$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$.\n\n首先，我们计算事件总数 $d$：\n$$d = \\sum_{i=1}^{12} \\Delta_i = 1+1+1+1+1+1+1+1+0+0+0+0 = 8$$\n接着，我们计算总风险时间 $Y_{\\text{total}}$：\n$$Y_{\\text{total}} = \\sum_{i=1}^{12} Y_i = (5+6+7+8+9+10+12+13) + (1.5+3.0+2.5+3.0)$$\n$$Y_{\\text{total}} = 70 + 10 = 80$$\n时间单位为天。现在，我们计算 $\\lambda$ 的最大似然估计：\n$$\\hat{\\lambda}_{\\text{MLE}} = \\frac{d}{Y_{\\text{total}}} = \\frac{8}{80} = \\frac{1}{10} = 0.1$$\n题目要求将答案四舍五入至四位有效数字。\n$$\\hat{\\lambda}_{\\text{MLE}} = 0.1000 \\, \\text{day}^{-1}$$\n\n**关于删失对信息改变的讨论**\n关于参数 $\\lambda$ 的信息与对数似然函数在最大似然估计处的曲率有关。观测Fisher信息定义为 $I(\\lambda) = -\\frac{d^2\\ell}{d\\lambda^2}$。在这个模型中，我们得到：\n$$I(\\lambda) = - \\left(-\\frac{d}{\\lambda^2}\\right) = \\frac{d}{\\lambda^2}$$\n较大的 $I(\\lambda)$ 值意味着似然函数的峰值更尖锐，对应于更多关于 $\\lambda$ 的信息以及其估计量的方差更小（因为 $\\text{Var}(\\hat{\\lambda}) \\approx 1/I(\\hat{\\lambda})$）。\n信息与观测到的事件数 $d$ 成正比。根据定义，右删失意味着对于给定大小为 $n$ 的样本，事件数 $d$ 小于或等于 $n$（$d \\le n$）。如果没有删失（一个完整的故障数据集），每个受试者都会贡献一个事件，因此我们会有 $d=n$。\n右删失的存在将观测到的事件数从潜在的最大值 $n$ 减少到观测值 $d$。$d$ 的减少直接导致信息 $I(\\lambda)$ 的值变小。较小的信息值意味着对数似然函数的峰度较低（曲率较小），这反映了对 $\\lambda$ 估计的更大不确定性。因此，右删失通过减少信息来改变信息；被删失的观测值对总风险时间（$\\hat{\\lambda}$ 的分母）有贡献，但对事件计数（分子）没有贡献，而事件计数是该模型中统计信息的唯一驱动因素。",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "最后的这项练习将我们带入动态系统和时间序列分析的领域。通过从贝叶斯推断的视角推导卡尔曼滤波器（Kalman filter）的更新方程，您将理解如何将模型预测与含噪声的测量数据进行最优融合，以追踪一个随时间变化的隐藏生理状态。将其应用于连续血糖监测的具体场景，清晰地展示了这一强大算法如何将原始传感器数据转化为具有临床意义的信息 。",
            "id": "3921987",
            "problem": "患者的组织间液葡萄糖浓度（在离散时间索引 $k$ 时用潜状态 $x_k$ 表示）被建模为一个线性高斯状态空间过程。该模型适用于短期生理学，其中未建模的输入（例如胰岛素作用和碳水化合物吸收）被归入过程噪声中。具体来说，假设状态演化为随机游走 $x_k = x_{k-1} + w_k$，其中 $w_k \\sim \\mathcal{N}(0,Q)$，连续血糖监测仪 (CGM) 测量的观测模型为 $z_k = x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0,R)$。此处，$\\mathcal{N}$ 表示正态分布，$Q \\ge 0$ 和 $R  0$ 是已知标量，所有噪声相互独立且与初始状态无关。在时间 $k$，给定 $x_k$ 的高斯先验（来自过程模型的预测），形式为 $x_k \\mid \\mathcal{Z}_{k-1} \\sim \\mathcal{N}(\\hat{x}_{k \\mid k-1}, P_{k \\mid k-1})$（其中 $\\mathcal{Z}_{k-1}$ 表示截至时间 $k-1$ 的所有测量值），以及一个新的 CGM 测量值 $z_k$。\n\n任务：\n1. 从贝叶斯法则和多元正态分布的性质出发（不使用任何预先推导的卡尔曼滤波器公式），推导上述标量情况下的后验均值 $\\hat{x}_{k \\mid k}$ 和后验方差 $P_{k \\mid k}$ 的递归测量更新方程。您的推导必须明确地用 $P_{k \\mid k-1}$ 和 $R$ 来表示通常称为卡尔曼增益的量。\n2. 将您推导的更新方程应用于以下生理上合理的情景：时间 $k$ 的先验为 $\\hat{x}_{k \\mid k-1} = 150 \\text{ mg/dL}$ 和 $P_{k \\mid k-1} = 400 (\\text{mg/dL})^2$，CGM 报告的测量值为 $z_k = 172 \\text{ mg/dL}$，已知测量噪声方差为 $R = 100 (\\text{mg/dL})^2$。报告后验均值 $\\hat{x}_{k \\mid k}$，单位为 $\\text{mg/dL}$。\n按以下说明表达最终的数值答案。\n\n答案规格：\n- 最终答案必须是后验均值 $\\hat{x}_{k \\mid k}$ 的数值，以 $\\text{mg/dL}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于状态估计和生物医学建模的既定原则，在数学上是适定的，有足够的信息得出唯一解，并以客观、无歧义的语言表达。因此，我们可以进行推导和计算。\n\n**1. 测量更新方程的推导**\n\n目标是求出在给定截至时间 $k$ 的所有测量值 $\\mathcal{Z}_k = \\{\\mathcal{Z}_{k-1}, z_k\\}$ 的条件下，状态 $x_k$ 的后验概率密度函数 (PDF)。该 PDF 为 $p(x_k \\mid \\mathcal{Z}_k)$。根据贝叶斯法则，后验概率与似然和先验的乘积成正比：\n$$p(x_k \\mid \\mathcal{Z}_k) = p(x_k \\mid z_k, \\mathcal{Z}_{k-1}) \\propto p(z_k \\mid x_k, \\mathcal{Z}_{k-1}) p(x_k \\mid \\mathcal{Z}_{k-1})$$\n\n该表达式中的各项定义如下：\n*   先验分布为高斯分布：$p(x_k \\mid \\mathcal{Z}_{k-1}) \\sim \\mathcal{N}(\\hat{x}_{k \\mid k-1}, P_{k \\mid k-1})$。其 PDF 为：\n$$p(x_k \\mid \\mathcal{Z}_{k-1}) = \\frac{1}{\\sqrt{2\\pi P_{k \\mid k-1}}} \\exp\\left(-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}}\\right)$$\n\n*   似然函数 $p(z_k \\mid x_k, \\mathcal{Z}_{k-1})$ 由测量模型 $z_k = x_k + v_k$ 决定。由于测量噪声 $v_k$ 与状态 $x_k$ 和过去的测量值 $\\mathcal{Z}_{k-1}$ 无关，我们有 $p(z_k \\mid x_k, \\mathcal{Z}_{k-1}) = p(z_k \\mid x_k)$。噪声 $v_k = z_k - x_k$ 服从 $\\mathcal{N}(0, R)$ 分布，这意味着似然（作为 $x_k$ 的函数）是一个以 $z_k$ 为中心、方差为 $R$ 的高斯函数：\n$$p(z_k \\mid x_k) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2} \\frac{(z_k - x_k)^2}{R}\\right)$$\n\n两个高斯 PDF 的乘积与另一个高斯 PDF 成正比。因此，后验 $p(x_k \\mid \\mathcal{Z}_k)$ 是高斯分布，我们可以写成 $x_k \\mid \\mathcal{Z}_k \\sim \\mathcal{N}(\\hat{x}_{k \\mid k}, P_{k \\mid k})$。为了求出后验均值 $\\hat{x}_{k \\mid k}$ 和方差 $P_{k \\mid k}$，我们分析后验 PDF 的指数部分。\n$$p(x_k \\mid \\mathcal{Z}_k) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(x_k - z_k)^2}{R}\\right)$$\n$$p(x_k \\mid \\mathcal{Z}_k) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}} + \\frac{(x_k - z_k)^2}{R} \\right] \\right)$$\n\n令 $\\Phi$ 为指数中括号内的表达式。我们展开并按 $x_k$ 的幂次合并各项：\n$$\\Phi = \\frac{x_k^2 - 2x_k\\hat{x}_{k \\mid k-1} + \\hat{x}_{k \\mid k-1}^2}{P_{k \\mid k-1}} + \\frac{x_k^2 - 2x_k z_k + z_k^2}{R}$$\n$$\\Phi = x_k^2 \\left(\\frac{1}{P_{k \\mid k-1}} + \\frac{1}{R}\\right) - 2x_k \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right) + C$$\n其中 $C$ 包含不依赖于 $x_k$ 的项。\n\n后验 PDF $\\mathcal{N}(\\hat{x}_{k \\mid k}, P_{k \\mid k})$ 的指数形式为 $-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k})^2}{P_{k \\mid k}}$，展开为：\n$$-\\frac{1}{2} \\left[ \\frac{1}{P_{k \\mid k}}x_k^2 - \\frac{2\\hat{x}_{k \\mid k}}{P_{k \\mid k}}x_k + \\frac{\\hat{x}_{k \\mid k}^2}{P_{k \\mid k}} \\right]$$\n\n通过比较 $\\Phi$ 和后验指数中 $x_k^2$ 项的系数，我们确定后验方差 $P_{k \\mid k}$ 的倒数：\n$$\\frac{1}{P_{k \\mid k}} = \\frac{1}{P_{k \\mid k-1}} + \\frac{1}{R} = \\frac{P_{k \\mid k-1} + R}{P_{k \\mid k-1} R}$$\n解出 $P_{k \\mid k}$ 得到后验方差更新方程：\n$$P_{k \\mid k} = \\frac{P_{k \\mid k-1} R}{P_{k \\mid k-1} + R}$$\n\n接下来，通过比较线性项 $x_k$ 的系数，我们有：\n$$\\frac{\\hat{x}_{k \\mid k}}{P_{k \\mid k}} = \\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}$$\n解出 $\\hat{x}_{k \\mid k}$ 得到后验均值：\n$$\\hat{x}_{k \\mid k} = P_{k \\mid k} \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right)$$\n代入 $P_{k \\mid k}$ 的表达式：\n$$\\hat{x}_{k \\mid k} = \\frac{P_{k \\mid k-1} R}{P_{k \\mid k-1} + R} \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right) = \\frac{R\\hat{x}_{k \\mid k-1} + P_{k \\mid k-1}z_k}{P_{k \\mid k-1} + R}$$\n该表达式显示更新后的均值是先验均值和测量值的加权平均。为了将其表示为包含卡尔曼增益的常规形式，我们进行代数变换：\n$$\\hat{x}_{k \\mid k} = \\frac{(P_{k \\mid k-1} + R)\\hat{x}_{k \\mid k-1} - P_{k \\mid k-1}\\hat{x}_{k \\mid k-1} + P_{k \\mid k-1}z_k}{P_{k \\mid k-1} + R}$$\n$$\\hat{x}_{k \\mid k} = \\frac{(P_{k \\mid k-1} + R)\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1} + R} + \\frac{P_{k \\mid k-1}(z_k - \\hat{x}_{k \\mid k-1})}{P_{k \\mid k-1} + R}$$\n$$\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + \\left(\\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}\\right)(z_k - \\hat{x}_{k \\mid k-1})$$\n这就是后验均值的测量更新方程。乘以新息 $(z_k - \\hat{x}_{k \\mid k-1})$ 的项被定义为卡尔曼增益 $K_k$：\n$$K_k = \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}$$\n因此，均值的更新方程为 $\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + K_k(z_k - \\hat{x}_{k \\mid k-1})$。\n\n后验方差的更新也可以用 $K_k$ 表示：\n$$P_{k \\mid k} = \\left(1 - \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}\\right) P_{k \\mid k-1} = (1 - K_k)P_{k \\mid k-1}$$\n至此，递归测量更新方程的推导完成。\n\n**2. 在生理情景中的应用**\n\n给定以下数值：\n*   先验均值: $\\hat{x}_{k \\mid k-1} = 150 \\text{ mg/dL}$\n*   先验方差: $P_{k \\mid k-1} = 400 (\\text{mg/dL})^2$\n*   测量值: $z_k = 172 \\text{ mg/dL}$\n*   测量噪声方差: $R = 100 (\\text{mg/dL})^2$\n\n首先，我们计算卡尔曼增益 $K_k$：\n$$K_k = \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R} = \\frac{400}{400 + 100} = \\frac{400}{500} = 0.8$$\n增益 $K_k=0.8$ 是无量纲的。它决定了对均值的修正量将是新息（测量值与先验估计值之差）的 $80\\%$。\n\n接下来，我们应用后验均值 $\\hat{x}_{k \\mid k}$ 的测量更新方程：\n$$\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + K_k(z_k - \\hat{x}_{k \\mid k-1})$$\n代入数值：\n$$\\hat{x}_{k \\mid k} = 150 + 0.8 \\times (172 - 150)$$\n$$\\hat{x}_{k \\mid k} = 150 + 0.8 \\times (22)$$\n$$\\hat{x}_{k \\mid k} = 150 + 17.6$$\n$$\\hat{x}_{k \\mid k} = 167.6$$\n\n后验平均葡萄糖浓度为 $167.6 \\text{ mg/dL}$。该值介于先验估计值 ($150$) 和新测量值 ($172$) 之间，并且更接近测量值，因为先验方差 ($P_{k \\mid k-1}=400$) 大于测量方差 ($R=100$)，表明我们对新测量值有更高的置信度。结果 $167.6$ 已经满足了四舍五入到四位有效数字的要求。",
            "answer": "$$\n\\boxed{167.6}\n$$"
        }
    ]
}