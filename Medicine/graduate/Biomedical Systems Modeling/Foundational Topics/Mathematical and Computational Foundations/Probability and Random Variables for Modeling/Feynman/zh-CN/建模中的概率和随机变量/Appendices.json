{
    "hands_on_practices": [
        {
            "introduction": "在生物医学研究中，对事件发生时间（如设备故障或患者康复）进行建模至关重要。本练习将引导您处理一个常见的数据难题——右删失，即并非所有研究对象都在观察期内经历事件。您将从基本原理出发，为指数生存模型推导似然函数，并计算关键参数的最大似然估计（MLE），这是处理删失数据的核心技能。",
            "id": "3921993",
            "problem": "在一项关于植入式心室辅助装置的队列研究中，早期机械性阻塞被建模为随时间推移具有恒定的瞬时失效风险。设受试者 $i$ 的阻塞时间为连续随机变量 $T_i$，假设各受试者之间相互独立，并服从风险率恒为 $\\lambda$ 的指数模型。由于研究终止或失访会发生右删失，从而得到观测时间 $Y_i = \\min(T_i, C_i)$ 和事件指示符 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$，其中 $C_i$ 是独立的删失时间。利用风险函数 $h(t)$、生存函数 $S(t)$ 和概率密度函数 $f(t)$ 之间的基本关系，结合独立性及似然的定义，推导在独立右删失情况下 $\\lambda$ 的似然函数。\n\n然后，利用最大似然估计 (MLE) 原理，求出以可观测量表示的 $\\lambda$ 的最大似然估计量的闭式表达式。最后，根据以下 $n=12$ 对观测值 $(Y_i, \\Delta_i)$（时间单位：天）计算其数值：\n$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$。\n将您的数值答案四舍五入到四位有效数字，并以 $\\text{day}^{-1}$ 为单位表示最终的率。\n\n此外，根据对数似然函数的曲率，简要讨论在此指数生存模型中，相对于完整（未经删失）的数据，右删失是如何改变关于 $\\lambda$ 的信息的。最终的数值答案必须是单个实数。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 受试者 $i$ 的阻塞时间 $T_i$ 是一个连续随机变量。\n- $T_i$ 在各受试者之间是独立的。\n- $T_i$ 服从风险率恒为 $\\lambda$ 的指数模型。\n- 发生右删失，其中 $C_i$ 是独立的删失时间。\n- 观测时间为 $Y_i = \\min(T_i, C_i)$。\n- 事件指示符为 $\\Delta_i = \\mathbf{1}\\{T_i \\leq C_i\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 受试者数量为 $n=12$。\n- 观测到的数据对 $(Y_i, \\Delta_i)$ 为：$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$。\n- 最终的数值答案必须四舍五入到四位有效数字，并以 $\\text{day}^{-1}$ 为单位表示。\n- 最终答案框必须包含一个实数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在生存分析的统计理论方面有充分的依据，这是生物统计学和生物医学建模的核心课题。失效时间的指数模型、恒定风险率的概念、独立右删失以及最大似然估计都是标准且成熟的原理。\n- **适定性**：该问题是适定的。它清晰地定义了模型、数据结构和推断目标（推导和计算 $\\lambda$ 的最大似然估计）。它为得到唯一解提供了所有必要信息。\n- **客观性**：该问题使用精确、客观的数学和统计术语进行陈述。\n- **完整性与一致性**：该问题是自洽且一致的。它提供了求解所需的模型、参数和数据。没有矛盾之处。\n- **现实性**：使用指数分布对设备失效进行建模并考虑删失的情景，是生物医学工程和临床试验中的一个标准且现实的应用。所给的数据值是合理的。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。有必要给出完整解答。\n\n**似然函数的推导**\n事件发生时间 $T$ 由风险率恒为 $\\lambda$ 的指数分布建模。与此模型相关的基本函数如下：\n1.  风险函数：$h(t) = \\lambda$，$t \\ge 0$。\n2.  生存函数：$S(t) = P(T > t) = \\exp\\left(-\\int_0^t h(u) \\,du\\right) = \\exp\\left(-\\int_0^t \\lambda \\,du\\right) = \\exp(-\\lambda t)$。\n3.  概率密度函数 (PDF)：$f(t) = -\\frac{dS(t)}{dt} = - \\frac{d}{dt}\\exp(-\\lambda t) = \\lambda \\exp(-\\lambda t)$。\n\n似然函数由 $n$ 个独立受试者各自的贡献构成。受试者 $i$ 的贡献取决于其事件是被观测到还是被删失，这由 $\\Delta_i$ 指示。\n\n- 如果受试者 $i$ 的事件被观测到 ($\\Delta_i = 1$)，这意味着失效发生在时间 $T_i = Y_i$，且发生在删失时间 $C_i$ 之前。对似然的贡献是在时间 $Y_i$ 发生失效的概率密度，即 $f(Y_i) = \\lambda \\exp(-\\lambda Y_i)$。\n- 如果受试者 $i$ 的观测是右删失的 ($\\Delta_i = 0$)，这意味着失效时间 $T_i$ 大于删失时间 $C_i$，而观测时间为 $Y_i = C_i$。我们只知道该受试者至少存活到时间 $Y_i$。对似然的贡献是这一事件的概率，即 $P(T_i > Y_i) = S(Y_i) = \\exp(-\\lambda Y_i)$。\n\n使用事件指示符 $\\Delta_i$，可以为受试者 $i$ 的似然贡献 $L_i(\\lambda)$ 写出一个单一的表达式：\n$$L_i(\\lambda) = [f(Y_i)]^{\\Delta_i} [S(Y_i)]^{1-\\Delta_i}$$\n代入 $f(t)$ 和 $S(t)$ 的表达式：\n$$L_i(\\lambda) = [\\lambda \\exp(-\\lambda Y_i)]^{\\Delta_i} [\\exp(-\\lambda Y_i)]^{1-\\Delta_i}$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i \\Delta_i) \\exp(-\\lambda Y_i (1-\\Delta_i))$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i (\\Delta_i + 1 - \\Delta_i))$$\n$$L_i(\\lambda) = \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i)$$\n由于所有受试者都是独立的，$n$ 个受试者样本的总似然 $L(\\lambda)$ 是各个体贡献的乘积：\n$$L(\\lambda) = \\prod_{i=1}^n L_i(\\lambda) = \\prod_{i=1}^n \\left( \\lambda^{\\Delta_i} \\exp(-\\lambda Y_i) \\right)$$\n$$L(\\lambda) = \\left( \\prod_{i=1}^n \\lambda^{\\Delta_i} \\right) \\left( \\prod_{i=1}^n \\exp(-\\lambda Y_i) \\right)$$\n$$L(\\lambda) = \\lambda^{\\sum_{i=1}^n \\Delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^n Y_i\\right)$$\n设 $d = \\sum_{i=1}^n \\Delta_i$ 为观测到的事件总数，设 $Y_{\\text{total}} = \\sum_{i=1}^n Y_i$ 为总观测风险时间。似然函数简化为：\n$$L(\\lambda) = \\lambda^d \\exp(-\\lambda Y_{\\text{total}})$$\n\n**最大似然估计量 (MLE) 的推导**\n为了求出 $\\lambda$ 的最大似然估计，我们需要最大化 $L(\\lambda)$。在计算上，最大化似然函数的自然对数，即对数似然函数 $\\ell(\\lambda)$，会更简单：\n$$\\ell(\\lambda) = \\ln(L(\\lambda)) = \\ln\\left( \\lambda^d \\exp(-\\lambda Y_{\\text{total}}) \\right)$$\n$$\\ell(\\lambda) = d \\ln(\\lambda) - \\lambda Y_{\\text{total}}$$\n为了找到最大值，我们对 $\\ell(\\lambda)$ 关于 $\\lambda$ 求一阶导数，并将其设为零：\n$$\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda} (d \\ln(\\lambda) - \\lambda Y_{\\text{total}}) = \\frac{d}{\\lambda} - Y_{\\text{total}}$$\n将导数设为零以求得估计量 $\\hat{\\lambda}$：\n$$\\frac{d}{\\hat{\\lambda}} - Y_{\\text{total}} = 0 \\implies \\frac{d}{\\hat{\\lambda}} = Y_{\\text{total}}$$\n解出 $\\hat{\\lambda}$ 得到最大似然估计量：\n$$\\hat{\\lambda}_{\\text{MLE}} = \\frac{d}{Y_{\\text{total}}} = \\frac{\\sum_{i=1}^n \\Delta_i}{\\sum_{i=1}^n Y_i}$$\n该表达式为事件总数除以总人时随访时间。为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{d\\lambda^2} = -\\frac{d}{\\lambda^2}$$\n由于事件数 $d \\ge 0$ 且 $\\lambda^2 > 0$，二阶导数非正。当 $d > 0$ 时，二阶导数严格为负，这证实了 $\\hat{\\lambda}_{\\text{MLE}}$ 对应一个局部最大值。\n\n**数值计算**\n所提供的数据包含 $n=12$ 对 $(Y_i, \\Delta_i)$：\n$(5, 1)$, $(6, 1)$, $(7, 1)$, $(8, 1)$, $(9, 1)$, $(10, 1)$, $(12, 1)$, $(13, 1)$, $(1.5, 0)$, $(3.0, 0)$, $(2.5, 0)$, $(3.0, 0)$。\n\n首先，我们计算事件总数 $d$：\n$$d = \\sum_{i=1}^{12} \\Delta_i = 1+1+1+1+1+1+1+1+0+0+0+0 = 8$$\n接着，我们计算总风险时间 $Y_{\\text{total}}$：\n$$Y_{\\text{total}} = \\sum_{i=1}^{12} Y_i = (5+6+7+8+9+10+12+13) + (1.5+3.0+2.5+3.0)$$\n$$Y_{\\text{total}} = 70 + 10 = 80$$\n时间单位为天。现在，我们计算 $\\lambda$ 的最大似然估计：\n$$\\hat{\\lambda}_{\\text{MLE}} = \\frac{d}{Y_{\\text{total}}} = \\frac{8}{80} = \\frac{1}{10} = 0.1$$\n题目要求答案四舍五入到四位有效数字。\n$$\\hat{\\lambda}_{\\text{MLE}} = 0.1000 \\, \\text{day}^{-1}$$\n\n**关于删失对信息改变的讨论**\n关于参数 $\\lambda$ 的信息与对数似然函数在最大似然估计处的曲率有关。观测到的费雪信息 (Fisher information) 定义为 $I(\\lambda) = -\\frac{d^2\\ell}{d\\lambda^2}$。在此模型中，我们得到：\n$$I(\\lambda) = - \\left(-\\frac{d}{\\lambda^2}\\right) = \\frac{d}{\\lambda^2}$$\n较大的 $I(\\lambda)$ 值意味着似然函数有更尖锐的峰值，这对应着关于 $\\lambda$ 的更多信息以及其估计量的更小方差（因为 $\\text{Var}(\\hat{\\lambda}) \\approx 1/I(\\hat{\\lambda})$）。\n信息量与观测到的事件数 $d$ 成正比。根据定义，右删失意味着对于一个大小为 $n$ 的样本，事件数 $d$ 小于或等于 $n$ ($d \\le n$)。如果没有删失（一个完整的失效数据集），每个受试者都会贡献一个事件，因此我们会有 $d=n$。\n右删失的存在将观测到的事件数从潜在的最大值 $n$ 减少到观测值 $d$。$d$ 的这种减少直接导致信息量 $I(\\lambda)$ 的值变小。较小的信息量意味着对数似然函数不那么尖锐（曲率较小），这反映了 $\\lambda$ 估计值中更大的不确定性。因此，右删失通过减少信息量来改变信息；删失的观测值对总风险时间（$\\hat{\\lambda}$ 的分母）有贡献，但对事件计数（分子）没有贡献，而事件计数是此模型统计信息的唯一驱动因素。",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "从对单一事件的建模，我们转向追踪随时间动态变化的生理状态。本练习介绍状态空间模型，这是一个用于从带有噪声的连续测量（如连续血糖监测）中估计潜在生理变量（如真实血糖水平）的强大框架。您将通过从贝叶斯定理推导卡尔曼滤波器更新方程，学习如何以最优方式融合模型预测与新数据，从而精确地估计系统的真实状态。",
            "id": "3921987",
            "problem": "一名患者的组织间液血糖浓度（用离散时间索引 $k$ 处的潜状态 $x_k$ 表示）被建模为一个线性高斯状态空间过程，该过程适用于短期生理学，其中未建模的输入（例如，胰岛素作用和碳水化合物吸收）被归入过程噪声。具体来说，假设一个随机游走状态演化 $x_k = x_{k-1} + w_k$，其中 $w_k \\sim \\mathcal{N}(0,Q)$，以及一个连续血糖监测仪 (CGM) 测量的观测模型 $z_k = x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0,R)$。此处 $\\mathcal{N}$ 表示正态分布，$Q \\ge 0$ 和 $R > 0$ 是已知的标量，所有噪声相互独立且独立于初始状态。在时间 $k$，您被提供了一个关于 $x_k$ 的高斯先验（来自过程模型的预测），形式为 $x_k \\mid \\mathcal{Z}_{k-1} \\sim \\mathcal{N}(\\hat{x}_{k \\mid k-1}, P_{k \\mid k-1})$，其中 $\\mathcal{Z}_{k-1}$ 表示截至时间 $k-1$ 的所有测量值，以及一个新的 CGM 测量值 $z_k$。\n\n任务：\n1. 从贝叶斯法则和多元正态分布的性质出发（不使用任何预先推导的卡尔曼滤波器公式），为上述标量情况推导后验均值 $\\hat{x}_{k \\mid k}$ 和后验方差 $P_{k \\mid k}$ 的递归测量更新方程。您的推导必须根据 $P_{k \\mid k-1}$ 和 $R$ 明确指出通常被称为卡尔曼增益的量。\n2. 将您推导的更新公式应用于以下生理上合理的情景：时间 $k$ 的先验是 $\\hat{x}_{k \\mid k-1} = 150 \\text{ mg/dL}$ 和 $P_{k \\mid k-1} = 400 \\text{ (mg/dL)}^2$，CGM 报告 $z_k = 172 \\text{ mg/dL}$，已知测量噪声方差 $R = 100 \\text{ (mg/dL)}^2$。报告后验均值 $\\hat{x}_{k \\mid k}$，单位为 $\\text{mg/dL}$。\n按照下文说明表达最终的数值答案。\n\n答案规格：\n- 最终答案必须是后验均值 $\\hat{x}_{k \\mid k}$ 的数值，以 $\\text{mg/dL}$ 为单位，四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于既定的状态估计和生物医学建模原理，数学上是适定的，并有足够的信息得到唯一解，且以客观、明确的语言表达。因此，我们可以继续进行推导和计算。\n\n**1. 测量更新方程的推导**\n\n目标是找到在给定截至时间 $k$ 的所有测量值（表示为 $\\mathcal{Z}_k = \\{\\mathcal{Z}_{k-1}, z_k\\}$）的条件下，状态 $x_k$ 的后验概率密度函数 (PDF)。该 PDF 为 $p(x_k \\mid \\mathcal{Z}_k)$。根据贝叶斯法则，后验概率与似然和先验的乘积成正比：\n$$p(x_k \\mid \\mathcal{Z}_k) = p(x_k \\mid z_k, \\mathcal{Z}_{k-1}) \\propto p(z_k \\mid x_k, \\mathcal{Z}_{k-1}) p(x_k \\mid \\mathcal{Z}_{k-1})$$\n\n此表达式中的各项定义如下：\n*   先验分布给定为高斯分布：$p(x_k \\mid \\mathcal{Z}_{k-1}) \\sim \\mathcal{N}(\\hat{x}_{k \\mid k-1}, P_{k \\mid k-1})$。其 PDF 为：\n$$p(x_k \\mid \\mathcal{Z}_{k-1}) = \\frac{1}{\\sqrt{2\\pi P_{k \\mid k-1}}} \\exp\\left(-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}}\\right)$$\n\n*   似然函数 $p(z_k \\mid x_k, \\mathcal{Z}_{k-1})$ 由测量模型 $z_k = x_k + v_k$ 决定。由于测量噪声 $v_k$ 独立于状态 $x_k$ 和过去的测量值 $\\mathcal{Z}_{k-1}$，我们有 $p(z_k \\mid x_k, \\mathcal{Z}_{k-1}) = p(z_k \\mid x_k)$。噪声 $v_k = z_k - x_k$ 服从 $\\mathcal{N}(0, R)$ 分布，这意味着作为 $x_k$ 的函数的似然是一个以 $z_k$ 为中心、方差为 $R$ 的高斯分布：\n$$p(z_k \\mid x_k) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2} \\frac{(z_k - x_k)^2}{R}\\right)$$\n\n两个高斯概率密度函数的乘积与另一个高斯概率密度函数成正比。因此，后验 $p(x_k \\mid \\mathcal{Z}_k)$ 也是高斯分布，我们可以写成 $x_k \\mid \\mathcal{Z}_k \\sim \\mathcal{N}(\\hat{x}_{k \\mid k}, P_{k \\mid k})$。为了找到后验均值 $\\hat{x}_{k \\mid k}$ 和方差 $P_{k \\mid k}$，我们分析后验 PDF 的指数部分。\n$$p(x_k \\mid \\mathcal{Z}_k) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(x_k - z_k)^2}{R}\\right)$$\n$$p(x_k \\mid \\mathcal{Z}_k) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(x_k - \\hat{x}_{k \\mid k-1})^2}{P_{k \\mid k-1}} + \\frac{(x_k - z_k)^2}{R} \\right] \\right)$$\n\n设 $\\Phi$ 为指数括号内的表达式。我们展开并按 $x_k$ 的幂次合并项：\n$$\\Phi = \\frac{x_k^2 - 2x_k\\hat{x}_{k \\mid k-1} + \\hat{x}_{k \\mid k-1}^2}{P_{k \\mid k-1}} + \\frac{x_k^2 - 2x_k z_k + z_k^2}{R}$$\n$$\\Phi = x_k^2 \\left(\\frac{1}{P_{k \\mid k-1}} + \\frac{1}{R}\\right) - 2x_k \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right) + C$$\n其中 $C$ 包含不依赖于 $x_k$ 的项。\n\n后验 PDF $\\mathcal{N}(\\hat{x}_{k \\mid k}, P_{k \\mid k})$ 的指数部分形式为 $-\\frac{1}{2} \\frac{(x_k - \\hat{x}_{k \\mid k})^2}{P_{k \\mid k}}$，展开为：\n$$-\\frac{1}{2} \\left[ \\frac{1}{P_{k \\mid k}}x_k^2 - \\frac{2\\hat{x}_{k \\mid k}}{P_{k \\mid k}}x_k + \\frac{\\hat{x}_{k \\mid k}^2}{P_{k \\mid k}} \\right]$$\n\n通过比较 $\\Phi$ 和后验指数中 $x_k^2$ 项的系数，我们得到后验方差 $P_{k \\mid k}$ 的倒数：\n$$\\frac{1}{P_{k \\mid k}} = \\frac{1}{P_{k \\mid k-1}} + \\frac{1}{R} = \\frac{P_{k \\mid k-1} + R}{P_{k \\mid k-1} R}$$\n求解 $P_{k \\mid k}$ 得到后验方差更新方程：\n$$P_{k \\mid k} = \\frac{P_{k \\mid k-1} R}{P_{k \\mid k-1} + R}$$\n\n接下来，通过比较线性项 $x_k$ 的系数，我们有：\n$$\\frac{\\hat{x}_{k \\mid k}}{P_{k \\mid k}} = \\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}$$\n求解 $\\hat{x}_{k \\mid k}$ 得到后验均值：\n$$\\hat{x}_{k \\mid k} = P_{k \\mid k} \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right)$$\n代入 $P_{k \\mid k}$ 的表达式：\n$$\\hat{x}_{k \\mid k} = \\frac{P_{k \\mid k-1} R}{P_{k \\mid k-1} + R} \\left(\\frac{\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1}} + \\frac{z_k}{R}\\right) = \\frac{R\\hat{x}_{k \\mid k-1} + P_{k \\mid k-1}z_k}{P_{k \\mid k-1} + R}$$\n此表达式显示更新后的均值是先验均值和测量值的加权平均。为了将其表示为包含卡尔曼增益的常规形式，我们进行代数操作：\n$$\\hat{x}_{k \\mid k} = \\frac{(P_{k \\mid k-1} + R)\\hat{x}_{k \\mid k-1} - P_{k \\mid k-1}\\hat{x}_{k \\mid k-1} + P_{k \\mid k-1}z_k}{P_{k \\mid k-1} + R}$$\n$$\\hat{x}_{k \\mid k} = \\frac{(P_{k \\mid k-1} + R)\\hat{x}_{k \\mid k-1}}{P_{k \\mid k-1} + R} + \\frac{P_{k \\mid k-1}(z_k - \\hat{x}_{k \\mid k-1})}{P_{k \\mid k-1} + R}$$\n$$\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + \\left(\\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}\\right)(z_k - \\hat{x}_{k \\mid k-1})$$\n这是后验均值的测量更新方程。乘以新息 $(z_k - \\hat{x}_{k \\mid k-1})$ 的项被定义为卡尔曼增益 $K_k$：\n$$K_k = \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}$$\n因此，均值的更新方程为 $\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + K_k(z_k - \\hat{x}_{k \\mid k-1})$。\n\n后验方差更新也可以用 $K_k$ 表示：\n$$P_{k \\mid k} = \\frac{P_{k \\mid k-1} R}{P_{k \\mid k-1} + R} = \\left(1 - \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R}\\right) P_{k \\mid k-1} = (1 - K_k)P_{k \\mid k-1}$$\n至此，递归测量更新方程的推导完成。\n\n**2. 在生理情景中的应用**\n\n我们有以下给定值：\n*   先验均值：$\\hat{x}_{k \\mid k-1} = 150 \\text{ mg/dL}$\n*   先验方差：$P_{k \\mid k-1} = 400 \\text{ (mg/dL)}^2$\n*   测量值：$z_k = 172 \\text{ mg/dL}$\n*   测量噪声方差：$R = 100 \\text{ (mg/dL)}^2$\n\n首先，我们计算卡尔曼增益 $K_k$：\n$$K_k = \\frac{P_{k \\mid k-1}}{P_{k \\mid k-1} + R} = \\frac{400}{400 + 100} = \\frac{400}{500} = 0.8$$\n增益 $K_k=0.8$ 是无量纲的。它决定了对均值的修正将是新息（测量值与先验估计之差）的 $80\\%$。\n\n接下来，我们应用后验均值 $\\hat{x}_{k \\mid k}$ 的测量更新方程：\n$$\\hat{x}_{k \\mid k} = \\hat{x}_{k \\mid k-1} + K_k(z_k - \\hat{x}_{k \\mid k-1})$$\n代入数值：\n$$\\hat{x}_{k \\mid k} = 150 + 0.8 \\times (172 - 150)$$\n$$\\hat{x}_{k \\mid k} = 150 + 0.8 \\times (22)$$\n$$\\hat{x}_{k \\mid k} = 150 + 17.6$$\n$$\\hat{x}_{k \\mid k} = 167.6$$\n\n后验平均血糖浓度为 $167.6 \\text{ mg/dL}$。该值位于先验估计 ($150$) 和新测量值 ($172$) 之间，并且更接近测量值，因为先验方差 ($P_{k \\mid k-1}=400$) 大于测量方差 ($R=100$)，表明我们对新测量值更有信心。结果 $167.6$ 已满足四舍五入到四位有效数字的要求。",
            "answer": "$$\n\\boxed{167.6}\n$$"
        },
        {
            "introduction": "除了追踪动态变化，概率模型还能揭示数据中隐藏的结构，例如识别不同的患者亚群。本练习将介绍高斯混合模型（GMM），这是一种强大的无监督学习工具，用于发现异质群体中的潜在聚类。您将推导期望最大化（EM）算法——一种处理含潜在变量模型的关键迭代方法，并将其应用于根据生物标志物数据对患者进行概率性聚类。",
            "id": "3922004",
            "problem": "一个生物医学系统建模团队试图使用一个考虑了患者间异质性的概率模型，将患者血清生物标志物图谱聚类为表型亚组。考虑一个用于生物标志物向量的多元高斯分量混合模型，其中每个患者 $n$ 有一个二维生物标志物向量 $x_{n} = (x_{n,1}, x_{n,2})$（生物标志物 $1$ 的单位为 $\\mathrm{ng/mL}$，生物标志物 $2$ 的单位为 $\\mathrm{U/L}$）。设该混合模型有 $K$ 个分量，其混合比例为 $\\pi_{k}$，分量均值为 $\\mu_{k} \\in \\mathbb{R}^{2}$，分量协方差矩阵为 $\\Sigma_{k} \\in \\mathbb{R}^{2 \\times 2}$。观测数据的似然函数为 $p(x_{n} \\mid \\Theta) = \\sum_{k=1}^{K} \\pi_{k} \\, \\mathcal{N}(x_{n} \\mid \\mu_{k}, \\Sigma_{k})$，其中 $\\Theta = \\{\\pi_{k}, \\mu_{k}, \\Sigma_{k}\\}_{k=1}^{K}$，$\\mathcal{N}(\\cdot \\mid \\mu, \\Sigma)$ 表示多元正态密度。\n\n从不完整数据的最大似然原理出发，并引入潜在指示变量 $z_{nk} \\in \\{0, 1\\}$（满足 $\\sum_{k=1}^{K} z_{nk} = 1$），推导此高斯混合模型（Gaussian Mixture Model (GMM)）的期望最大化（Expectation-Maximization (EM)）算法。您的推导必须从完整数据对数似然函数开始，通过正式定义期望步骤和最大化步骤来进行，最终得出以下各项的显式表达式：\n- 期望步骤中的响应度 $\\gamma_{nk} = \\mathbb{E}[z_{nk} \\mid x_{n}, \\Theta^{(t)}]$。\n- 最大化步骤中 $\\pi_{k}^{(t+1)}$、$\\mu_{k}^{(t+1)}$ 和 $\\Sigma_{k}^{(t+1)}$ 的更新。\n\n然后，对以下生物标志物数据集和 $K=2$ 个分量的初始参数值，应用一次 EM 迭代（一个期望步骤后跟一个仅针对混合比例的最大化步骤）。三个患者的图谱如下\n$$\nx_{1} = (12,\\, 110), \\quad x_{2} = (9,\\, 90), \\quad x_{3} = (21,\\, 210),\n$$\n生物标志物 $1$ 的单位为 $\\mathrm{ng/mL}$，生物标志物 $2$ 的单位为 $\\mathrm{U/L}$。初始参数为\n$$\n\\pi_{1}^{(0)} = 0.6, \\quad \\pi_{2}^{(0)} = 0.4, \\quad\n\\mu_{1}^{(0)} = (10,\\, 100), \\quad \\mu_{2}^{(0)} = (20,\\, 200),\n$$\n且对角协方差矩阵为\n$$\n\\Sigma_{1}^{(0)} = \\mathrm{diag}(4,\\, 400), \\quad \\Sigma_{2}^{(0)} = \\mathrm{diag}(9,\\, 900).\n$$\n使用这些初始参数执行期望步骤，计算 $n \\in \\{1,2,3\\}$ 和 $k \\in \\{1,2\\}$ 的响应度 $\\gamma_{nk}^{(0)}$。然后执行针对混合比例的最大化步骤，以获得 $\\pi_{1}^{(1)}$。\n\n将更新后的混合比例 $\\pi_{1}^{(1)}$ 的最终答案表示为四舍五入到四位有效数字的小数。最终答案不需要单位。",
            "solution": "该问题是有效的，因为它具有科学依据、问题定义清晰、客观，并包含得出唯一解所需的所有必要信息。它涉及期望最大化（EM）算法在高斯混合模型（GMM）上的标准应用，这是生物医学系统概率建模中的一个核心课题。\n\nGMM 的 EM 算法推导分为两部分：更新方程的一般推导，以及一次迭代的数值应用。\n\n**第1部分：GMM 的 EM 算法的一般推导**\n\n设观测数据集为 $X = \\{x_1, x_2, \\dots, x_N\\}$，其中每个 $x_n$ 是一个 $D$ 维实向量。GMM 假设每个数据点都由 $K$ 个高斯分量的混合生成。单个数据点 $x_n$ 的似然函数由下式给出：\n$$p(x_n \\mid \\Theta) = \\sum_{k=1}^{K} \\pi_k \\mathcal{N}(x_n \\mid \\mu_k, \\Sigma_k)$$\n其中 $\\Theta = \\{\\pi_k, \\mu_k, \\Sigma_k\\}_{k=1}^{K}$ 是模型参数：$\\pi_k$ 是满足 $0 \\le \\pi_k \\le 1$ 和 $\\sum_{k=1}^K \\pi_k = 1$ 的混合比例，$\\mu_k$ 是均值向量，$\\Sigma_k$ 是协方差矩阵。\n\nEM 算法适用于具有潜在变量的模型的最大似然估计。我们引入一组潜在指示变量 $Z = \\{z_1, z_2, \\dots, z_N\\}$，其中每个 $z_n$ 是一个 $K$ 维二元向量，其元素为 $z_{nk} \\in \\{0, 1\\}$ 且满足 $\\sum_{k=1}^K z_{nk} = 1$。变量 $z_{nk}=1$ 表示数据点 $x_n$ 是由分量 $k$ 生成的。\n\n集合 $\\{X, Z\\}$ 的完整数据似然函数由下式给出：\n$$p(X, Z \\mid \\Theta) = \\prod_{n=1}^N p(x_n, z_n \\mid \\Theta) = \\prod_{n=1}^N \\prod_{k=1}^K \\left[ \\pi_k \\mathcal{N}(x_n \\mid \\mu_k, \\Sigma_k) \\right]^{z_{nk}}$$\n完整数据对数似然函数 $\\mathcal{L}_c(\\Theta) = \\ln p(X, Z \\mid \\Theta)$ 为：\n$$\\mathcal{L}_c(\\Theta) = \\sum_{n=1}^N \\sum_{k=1}^K z_{nk} \\left( \\ln \\pi_k + \\ln \\mathcal{N}(x_n \\mid \\mu_k, \\Sigma_k) \\right)$$\nEM 算法在两个步骤之间迭代：期望（E）步骤和最大化（M）步骤。\n\n**1. 期望（E）步骤**\n在 E 步骤中，我们计算完整数据对数似然函数关于潜在变量在给定观测数据 $X$ 和当前参数估计 $\\Theta^{(t)}$ 下的后验分布的期望。这定义了 $Q$ 函数：\n$$Q(\\Theta \\mid \\Theta^{(t)}) = \\mathbb{E}_{Z \\mid X, \\Theta^{(t)}}[\\mathcal{L}_c(\\Theta)]$$\n$z_{nk}$ 的期望是点 $x_n$ 属于分量 $k$ 的后验概率，称为响应度，用 $\\gamma_{nk}^{(t)}$ 表示：\n$$\\gamma_{nk}^{(t)} = \\mathbb{E}[z_{nk} \\mid x_n, \\Theta^{(t)}] = p(z_{nk}=1 \\mid x_n, \\Theta^{(t)})$$\n使用贝叶斯定理：\n$$\\gamma_{nk}^{(t)} = \\frac{p(x_n \\mid z_{nk}=1, \\Theta^{(t)}) p(z_{nk}=1 \\mid \\Theta^{(t)})}{\\sum_{j=1}^K p(x_n \\mid z_{nj}=1, \\Theta^{(t)}) p(z_{nj}=1 \\mid \\Theta^{(t)})} = \\frac{\\pi_k^{(t)} \\mathcal{N}(x_n \\mid \\mu_k^{(t)}, \\Sigma_k^{(t)})}{\\sum_{j=1}^K \\pi_j^{(t)} \\mathcal{N}(x_n \\mid \\mu_j^{(t)}, \\Sigma_j^{(t)})}$$\n这是在 E 步骤中计算的响应度的显式表达式。\n$Q$ 函数变为：\n$$Q(\\Theta \\mid \\Theta^{(t)}) = \\sum_{n=1}^N \\sum_{k=1}^K \\gamma_{nk}^{(t)} \\left( \\ln \\pi_k + \\ln \\mathcal{N}(x_n \\mid \\mu_k, \\Sigma_k) \\right)$$\n\n**2. 最大化（M）步骤**\n在 M 步骤中，我们通过最大化 $Q$ 函数关于 $\\Theta$ 来找到新的参数估计 $\\Theta^{(t+1)}$：\n$$\\Theta^{(t+1)} = \\arg\\max_{\\Theta} Q(\\Theta \\mid \\Theta^{(t)})$$\n我们分别对 $\\pi_k$、$\\mu_k$ 和 $\\Sigma_k$ 进行最大化。\n\n$\\pi_k$ 的更新：我们在约束条件 $\\sum_{k=1}^K \\pi_k = 1$ 下最大化 $\\sum_{n=1}^N \\sum_{k=1}^K \\gamma_{nk}^{(t)} \\ln \\pi_k$。使用拉格朗日乘子，我们得到：\n$$\\pi_k^{(t+1)} = \\frac{1}{N} \\sum_{n=1}^N \\gamma_{nk}^{(t)}$$\n\n$\\mu_k$ 的更新：我们对 $\\mu_k$ 最大化 $\\sum_{n=1}^N \\sum_{k=1}^K \\gamma_{nk}^{(t)} \\ln \\mathcal{N}(x_n \\mid \\mu_k, \\Sigma_k)$。项 $\\ln \\mathcal{N}$ 包含 $-\\frac{1}{2}(x_n - \\mu_k)^T \\Sigma_k^{-1} (x_n - \\mu_k)$。对 $\\mu_k$ 求导并令其为零，得到：\n$$\\mu_k^{(t+1)} = \\frac{\\sum_{n=1}^N \\gamma_{nk}^{(t)} x_n}{\\sum_{n=1}^N \\gamma_{nk}^{(t)}}$$\n\n$\\Sigma_k$ 的更新：我们对 $\\Sigma_k$ 最大化同一项。这更复杂，但结果是：\n$$\\Sigma_k^{(t+1)} = \\frac{\\sum_{n=1}^N \\gamma_{nk}^{(t)} (x_n - \\mu_k^{(t+1)})(x_n - \\mu_k^{(t+1)})^T}{\\sum_{n=1}^N \\gamma_{nk}^{(t)}}$$\n为方便起见，我们将聚类 $k$ 中的有效点数定义为 $N_k = \\sum_{n=1}^N \\gamma_{nk}^{(t)}$。更新规则可以紧凑地写为：\n$$\\pi_k^{(t+1)} = \\frac{N_k}{N}, \\quad \\mu_k^{(t+1)} = \\frac{1}{N_k}\\sum_{n=1}^N \\gamma_{nk}^{(t)} x_n, \\quad \\Sigma_k^{(t+1)} = \\frac{1}{N_k}\\sum_{n=1}^N \\gamma_{nk}^{(t)} (x_n - \\mu_k^{(t+1)})(x_n - \\mu_k^{(t+1)})^T$$\n\n**第2部分：一次迭代的数值应用**\n\n我们给定 $D=2$ 维中的 $N=3$ 个数据点：\n$x_1 = (12, 110)$, $x_2 = (9, 90)$, $x_3 = (21, 210)$.\n分量数为 $K=2$。在迭代 $t=0$ 时的初始参数为：\n$\\pi_1^{(0)} = 0.6$, $\\pi_2^{(0)} = 0.4$\n$\\mu_1^{(0)} = (10, 100)$, $\\mu_2^{(0)} = (20, 200)$\n$\\Sigma_1^{(0)} = \\begin{pmatrix} 4  0 \\\\ 0  400 \\end{pmatrix}$, $\\Sigma_2^{(0)} = \\begin{pmatrix} 9  0 \\\\ 0  900 \\end{pmatrix}$\n\n一个 $D$ 维向量 $x$ 的多元正态密度为：\n$$\\mathcal{N}(x \\mid \\mu, \\Sigma) = \\frac{1}{(2\\pi)^{D/2} |\\Sigma|^{1/2}} \\exp\\left(-\\frac{1}{2}(x - \\mu)^T \\Sigma^{-1} (x - \\mu)\\right)$$\n对于对角协方差矩阵 $\\Sigma = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_D^2)$，这可以简化为：\n$$(x - \\mu)^T \\Sigma^{-1} (x - \\mu) = \\sum_{d=1}^D \\frac{(x_d - \\mu_d)^2}{\\sigma_d^2}$$\n\n**E 步骤：计算响应度 $\\gamma_{nk}^{(0)}$**\n我们需要为每个 $n \\in \\{1,2,3\\}$ 和 $k \\in \\{1,2\\}$ 计算 $\\mathcal{N}(x_n \\mid \\mu_k^{(0)}, \\Sigma_k^{(0)})$。让我们用 $p_{nk} = \\mathcal{N}(x_n \\mid \\mu_k^{(0)}, \\Sigma_k^{(0)})$ 表示未归一化的概率密度。\n\n对于分量 $k=1$：$|\\Sigma_1^{(0)}| = 4 \\times 400 = 1600$。归一化常数为 $C_1 = (2\\pi \\sqrt{1600})^{-1} = (80\\pi)^{-1}$。\n- $n=1, x_1=(12, 110)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(12-10)^2}{4} + \\frac{(110-100)^2}{400}\\right) = -\\frac{1}{2}(1 + 0.25) = -0.625$。因此，$p_{11} = C_1 \\exp(-0.625)$。\n- $n=2, x_2=(9, 90)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(9-10)^2}{4} + \\frac{(90-100)^2}{400}\\right) = -\\frac{1}{2}(0.25 + 0.25) = -0.25$。因此，$p_{21} = C_1 \\exp(-0.25)$。\n- $n=3, x_3=(21, 210)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(21-10)^2}{4} + \\frac{(210-100)^2}{400}\\right) = -\\frac{1}{2}(30.25 + 30.25) = -30.25$。因此，$p_{31} = C_1 \\exp(-30.25)$。\n\n对于分量 $k=2$：$|\\Sigma_2^{(0)}| = 9 \\times 900 = 8100$。归一化常数为 $C_2 = (2\\pi \\sqrt{8100})^{-1} = (180\\pi)^{-1}$。\n- $n=1, x_1=(12, 110)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(12-20)^2}{9} + \\frac{(110-200)^2}{900}\\right) = -\\frac{1}{2}(\\frac{64}{9} + \\frac{8100}{900}) = -\\frac{1}{2}(\\frac{64}{9} + 9) = -\\frac{145}{18} \\approx -8.0556$。因此，$p_{12} = C_2 \\exp(-145/18)$。\n- $n=2, x_2=(9, 90)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(9-20)^2}{9} + \\frac{(90-200)^2}{900}\\right) = -\\frac{1}{2}(\\frac{121}{9} + \\frac{12100}{900}) = -\\frac{1}{2}(\\frac{121}{9} + \\frac{121}{9}) = -\\frac{121}{9} \\approx -13.4444$。因此，$p_{22} = C_2 \\exp(-121/9)$。\n- $n=3, x_3=(21, 210)$: 指数参数为 $-\\frac{1}{2}\\left(\\frac{(21-20)^2}{9} + \\frac{(210-200)^2}{900}\\right) = -\\frac{1}{2}(\\frac{1}{9} + \\frac{100}{900}) = -\\frac{1}{2}(\\frac{1}{9} + \\frac{1}{9}) = -\\frac{1}{9} \\approx -0.1111$。因此，$p_{32} = C_2 \\exp(-1/9)$。\n\n现在我们计算响应度的分子，$A_{nk} = \\pi_k^{(0)} p_{nk}$。因子 $(2\\pi)^{-1}$ 在 $\\gamma_{nk}$ 中被抵消了。\n- $A_{11} = 0.6 \\frac{1}{40} \\exp(-0.625) \\approx 0.015 \\times 0.53526 = 0.0080289$\n- $A_{12} = 0.4 \\frac{1}{90} \\exp(-145/18) \\approx 0.00444 \\times 3.173 \\times 10^{-4} = 1.410 \\times 10^{-6}$\n- $A_{21} = 0.6 \\frac{1}{40} \\exp(-0.25) \\approx 0.015 \\times 0.77880 = 0.0116820$\n- $A_{22} = 0.4 \\frac{1}{90} \\exp(-121/9) \\approx 0.00444 \\times 1.450 \\times 10^{-6} = 6.442 \\times 10^{-9}$\n- $A_{31} = 0.6 \\frac{1}{40} \\exp(-30.25) \\approx 0.015 \\times 7.271 \\times 10^{-14} = 1.091 \\times 10^{-15}$\n- $A_{32} = 0.4 \\frac{1}{90} \\exp(-1/9) \\approx 0.00444 \\times 0.89484 = 0.0039771$\n\n现在，我们计算响应度 $\\gamma_{nk}^{(0)} = A_{nk} / (A_{n1} + A_{n2})$：\n- $\\gamma_{11} = \\frac{0.0080289}{0.0080289 + 1.410 \\times 10^{-6}} = 0.999824$\n- $\\gamma_{21} = \\frac{0.0116820}{0.0116820 + 6.442 \\times 10^{-9}} = 0.999999$\n- $\\gamma_{31} = \\frac{1.091 \\times 10^{-15}}{1.091 \\times 10^{-15} + 0.0039771} \\approx 2.743 \\times 10^{-13} \\approx 0$\n\n**M 步骤：更新混合比例（仅针对 $\\pi_1^{(1)}$）**\n该问题仅要求更新混合比例。我们首先计算 $N_k = \\sum_{n=1}^3 \\gamma_{nk}^{(0)}$。\n$$N_1 = \\gamma_{11} + \\gamma_{21} + \\gamma_{31} \\approx 0.999824 + 0.999999 + 0 = 1.999823$$\n分量 $1$ 的更新混合比例为：\n$$\\pi_1^{(1)} = \\frac{N_1}{N} = \\frac{1.999823}{3} \\approx 0.66660766...$$\n四舍五入到四位有效数字，我们得到 $0.6666$。",
            "answer": "$$\\boxed{0.6666}$$"
        }
    ]
}