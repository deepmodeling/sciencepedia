{
    "hands_on_practices": [
        {
            "introduction": "在深入研究纠正测量误差的方法之前，我们首先需要理解一个根本性问题：为什么简单的统计模型无法处理带有误差的预测变量？本练习将引导你通过第一性原理探索参数可识别性（parameter identifiability）的概念 。你将发现，在缺乏额外信息时，我们无法将预测变量的真实变异与测量误差分离开来，并学习如何通过重复测量或验证子样本等设计来克服这一挑战。",
            "id": "3884562",
            "problem": "在一项生物医学队列研究中，一个生物标志物被用来预测一个连续性临床结局，但其测量存在误差。设临床结局由带加性噪声的经典线性回归模型建模，生物标志物的测量受到加性测量误差的污染。具体来说，对于每个个体 $i$，假设潜伏的真实生物标志物 $X_i$ 和观测值 $(W_i, Y_i)$ 满足\n- $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，\n- $W_i = X_i + U_i$，\n其中 $U_i$ 表示预测变量测量误差，$\\varepsilon_i$ 表示结局噪声。假设 $U_i$ 和 $\\varepsilon_i$ 均值为零，方差有限，并且与 $X_i$ 相互独立，彼此也相互独立。我们关注的参数是 $(\\beta_0, \\beta_1, \\sigma_U^2)$，其中 $\\sigma_U^2 = \\operatorname{Var}(U_i)$。在研究层面，你只能观测到 $(W_i, Y_i)$，目标是推断 $(\\beta_0, \\beta_1, \\sigma_U^2)$。\n\n使用参数可识别性的定义（即不同的参数值会引出可观测数据的不同总体分布），从基本原理出发，推断上述模型的可观测推论。然后，在仅观测到 $(W_i, Y_i)$ 且没有外部信息的情况下，评估 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性是成立还是不成立。最后，考虑两种常见的生物医学设计：（i）对每个受试者进行重复的生物标志物测量，即两次独立的测量 $W_{i1} = X_i + U_{i1}$ 和 $W_{i2} = X_i + U_{i2}$，其中给定 $X_i$ 时，$U_{i1}$ 和 $U_{i2}$ 独立同分布；以及（ii）一个验证子样本，其中一部分受试者除了 $W_i$ 和 $Y_i$ 之外，还能获得 $X_i$ 的金标准测量值。确定这些设计如何影响 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。\n\n在上述设定下，以下哪个陈述正确地描述了 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性失效与恢复？\n\nA. 在没有外部信息的情况下，仅观测 $(W_i, Y_i)$ 无法识别 $(\\beta_0, \\beta_1, \\sigma_U^2)$，因为 $\\operatorname{Var}(W_i)$ 分解为 $\\operatorname{Var}(X_i)$ 和 $\\sigma_U^2$ 的方式无法由可观测分布确定。对每个受试者进行带独立误差的重复生物标志物测量可以识别 $\\sigma_U^2$ 和 $\\operatorname{Var}(X_i)$，从而能够从可观测的交叉协方差中识别 $\\beta_1$，进而从可观测的均值中识别 $\\beta_0$。带有金标准 $X_i$ 的验证子样本同样可以识别 $\\sigma_U^2$ 和 $\\operatorname{Var}(X_i)$，从而恢复 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。\n\nB. 如果 $U_i$ 和 $\\varepsilon_i$ 是高斯分布的，那么 $(W_i, Y_i)$ 的联合分布是二元正态分布，并唯一确定 $(\\beta_0, \\beta_1, \\sigma_U^2)$，因此无需重复测量或验证即可满足可识别性。\n\nC. 因为 $U_i$ 的均值为零，所以即使在 $\\beta_1$ 和 $\\sigma_U^2$ 未知的情况下，仅从 $\\operatorname{E}[Y_i]$ 和 $\\operatorname{E}[W_i]$ 就可以识别 $\\beta_0$，因此只有 $\\beta_1$ 和 $\\sigma_U^2$ 存在可识别性问题。\n\nD. 带独立 $\\varepsilon_{i1}$ 和 $\\varepsilon_{i2}$ 的重复结局测量 $Y_{i1}$ 和 $Y_{i2}$（但只有一个生物标志物测量值 $W_i$）足以恢复 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性，因为它们可以从 $Y_{i1} - Y_{i2}$ 的变异性中揭示 $\\sigma_U^2$。",
            "solution": "用户要求对经典测量误差模型中的参数可识别性进行分析，这是生物医学统计学中的一个典型问题。分析将分三个阶段进行：首先，在仅给定可观测数据 $(W_i, Y_i)$ 的情况下，评估模型参数 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性；其次，研究重复生物标志物测量的设计如何影响可识别性；第三，研究验证子样本的影响。\n\n### 问题验证\n\n**第一步：提取已知条件**\n-   临床结局模型：$Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$。\n-   生物标志物测量模型：$W_i = X_i + U_i$。\n-   潜伏（未观测）变量：$X_i$（真实生物标志物值）。\n-   可观测变量：$(W_i, Y_i)$。\n-   误差项：$U_i$（预测变量测量误差）和 $\\varepsilon_i$（结局噪声）。\n-   关于误差和潜伏变量的假设：\n    -   $\\operatorname{E}[U_i] = 0$，$\\operatorname{Var}(U_i) = \\sigma_U^2$。\n    -   $\\operatorname{E}[\\varepsilon_i] = 0$，$\\operatorname{Var}(\\varepsilon_i) = \\sigma_\\varepsilon^2$。\n    -   $U_i$、$\\varepsilon_i$ 和 $X_i$ 相互独立。\n-   关注的参数：$(\\beta_0, \\beta_1, \\sigma_U^2)$。\n-   待考虑的额外设计：\n    -   (i) 重复测量：两次独立的测量 $W_{i1} = X_i + U_{i1}$ 和 $W_{i2} = X_i + U_{i2}$，其中 $U_{i1}, U_{i2}$ 独立同分布。\n    -   (ii) 验证子样本：一部分受试者拥有 $X_i$ 的金标准（真实）测量值。\n\n**第二步：使用提取的已知条件进行验证**\n问题陈述定义明确且有科学依据。它提出了标准的经典线性测量误差模型，这是统计学、生物统计学和计量经济学中的一个基本课题。这些假设是标准的，关于参数可识别性的问题是此框架内一个核心的、非平凡的问题。该问题是客观的、形式化的，并且不违反任何科学或数学原理。这是一个有效的可供分析的问题。\n\n**第三步：结论和行动**\n问题有效。将从基本原理推导解决方案。\n\n### 推导与分析\n\n一组参数的可识别性取决于它们是否能从可观测数据的概率分布中唯一确定。分布由其矩来表征。我们将用模型参数和讨厌参数来表示可观测变量 $(W_i, Y_i)$ 的总体矩。设 $\\operatorname{E}[X_i] = \\mu_X$ 且 $\\operatorname{Var}(X_i) = \\sigma_X^2$。全部未知参数的集合是 $(\\beta_0, \\beta_1, \\sigma_U^2, \\mu_X, \\sigma_X^2, \\sigma_\\varepsilon^2)$。\n\n**第一部分：基本情况分析（仅观测 $(W_i, Y_i)$）**\n\n我们计算可观测向量 $(W_i, Y_i)$ 的一阶矩和二阶矩。\n\n1.  **期望值：**\n    -   $\\operatorname{E}[W_i] = \\operatorname{E}[X_i + U_i] = \\operatorname{E}[X_i] + \\operatorname{E}[U_i] = \\mu_X + 0 = \\mu_X$。\n    -   $\\operatorname{E}[Y_i] = \\operatorname{E}[\\beta_0 + \\beta_1 X_i + \\varepsilon_i] = \\beta_0 + \\beta_1 \\operatorname{E}[X_i] + \\operatorname{E}[\\varepsilon_i] = \\beta_0 + \\beta_1 \\mu_X + 0 = \\beta_0 + \\beta_1 \\mu_X$。\n\n2.  **方差和协方差：**\n    -   $\\operatorname{Var}(W_i) = \\operatorname{Var}(X_i + U_i) = \\operatorname{Var}(X_i) + \\operatorname{Var}(U_i) + 2\\operatorname{Cov}(X_i, U_i) = \\sigma_X^2 + \\sigma_U^2$（由于 $X_i$ 和 $U_i$ 的独立性）。\n    -   $\\operatorname{Var}(Y_i) = \\operatorname{Var}(\\beta_0 + \\beta_1 X_i + \\varepsilon_i) = \\beta_1^2 \\operatorname{Var}(X_i) + \\operatorname{Var}(\\varepsilon_i) = \\beta_1^2 \\sigma_X^2 + \\sigma_\\varepsilon^2$（由于 $X_i$ 和 $\\varepsilon_i$ 的独立性）。\n    -   $\\operatorname{Cov}(W_i, Y_i) = \\operatorname{Cov}(X_i + U_i, \\beta_0 + \\beta_1 X_i + \\varepsilon_i)$。展开此式并利用 $X_i, U_i, \\varepsilon_i$ 的相互独立性：\n        $\\operatorname{Cov}(W_i, Y_i) = \\operatorname{Cov}(X_i, \\beta_1 X_i) + \\operatorname{Cov}(X_i, \\varepsilon_i) + \\operatorname{Cov}(U_i, \\beta_1 X_i) + \\operatorname{Cov}(U_i, \\varepsilon_i)$\n        $= \\beta_1 \\operatorname{Var}(X_i) + 0 + 0 + 0 = \\beta_1 \\sigma_X^2$。\n\n从 $(W_i, Y_i)$ 的分布中，我们可以确定方程左侧的可观测矩。我们来评估一下是否可以唯一地求解出我们关注的参数 $(\\beta_0, \\beta_1, \\sigma_U^2)$。\n\n-   从 $\\operatorname{E}[W_i] = \\mu_X$ 可知，参数 $\\mu_X$ 是可识别的。\n-   涉及二阶矩的方程是：\n    (I) $\\operatorname{Var}(W_i) = \\sigma_X^2 + \\sigma_U^2$\n    (II) $\\operatorname{Cov}(W_i, Y_i) = \\beta_1 \\sigma_X^2$\n    (III) $\\operatorname{Var}(Y_i) = \\beta_1^2 \\sigma_X^2 + \\sigma_\\varepsilon^2$\n\n从这三个方程中，我们必须求解未知数 $\\beta_1, \\sigma_U^2, \\sigma_X^2, \\sigma_\\varepsilon^2$。这个方程组有四个未知数但只有三个方程。具体来说，从方程（I）和（II）我们得到两个方程，却有三个未知数：$\\beta_1, \\sigma_X^2, \\sigma_U^2$。这个子系统是欠定的。对于任何给定的可观测值 $\\operatorname{Var}(W_i)$ 和 $\\operatorname{Cov}(W_i, Y_i)$，我们可以选择任何有效的 $\\sigma_X^2 \\in (0, \\operatorname{Var}(W_i))$，这会确定 $\\sigma_U^2 = \\operatorname{Var}(W_i) - \\sigma_X^2$ 和 $\\beta_1 = \\operatorname{Cov}(W_i, Y_i) / \\sigma_X^2$。由于 $\\sigma_X^2$ 没有唯一解，因此 $\\beta_1$ 和 $\\sigma_U^2$ 也没有唯一解。它们是不可识别的。\n-   由于 $\\beta_1$ 不可识别，我们无法从方程 $\\operatorname{E}[Y_i] = \\beta_0 + \\beta_1 \\mu_X$ 中识别 $\\beta_0$，因为 $\\beta_0 = \\operatorname{E}[Y_i] - \\beta_1 \\operatorname{E}[W_i]$ 依赖于不可识别的参数 $\\beta_1$。\n-   基本情况的结论：当仅观测到 $(W_i, Y_i)$ 时，参数 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 是不可识别的。根本问题在于无法将观测到的预测变量的总方差 $\\operatorname{Var}(W_i)$ 分解为其组成部分：真实方差 $\\sigma_X^2$ 和误差方差 $\\sigma_U^2$。\n\n**第二部分：设计（i）分析 - 重复测量**\n\n现在，我们对每个受试者都有可观测数据 $(W_{i1}, W_{i2}, Y_i)$，其中 $W_{i1} = X_i + U_{i1}$ 和 $W_{i2} = X_i + U_{i2}$，而 $U_{i1}, U_{i2}$ 是从 $U_i$ 的分布中抽取的独立同分布样本。这种设计提供了新的可观测矩。一个关键的新信息是重复测量值之间的协方差：\n\n-   $\\operatorname{Cov}(W_{i1}, W_{i2}) = \\operatorname{Cov}(X_i + U_{i1}, X_i + U_{i2})$\n    $= \\operatorname{Cov}(X_i, X_i) + \\operatorname{Cov}(X_i, U_{i2}) + \\operatorname{Cov}(U_{i1}, X_i) + \\operatorname{Cov}(U_{i1}, U_{i2})$\n    $= \\operatorname{Var}(X_i) + 0 + 0 + 0 = \\sigma_X^2$。\n    此处，测量误差的独立性（$U_{i1} \\perp U_{i2}$）至关重要。\n\n现在，$\\sigma_X^2$ 可以从可观测的协方差 $\\operatorname{Cov}(W_{i1}, W_{i2})$ 中识别出来。一旦 $\\sigma_X^2$ 被识别，我们就可以求解其他参数：\n-   从 $\\operatorname{Var}(W_{i1}) = \\sigma_X^2 + \\sigma_U^2$，我们可以识别 $\\sigma_U^2 = \\operatorname{Var}(W_{i1}) - \\operatorname{Cov}(W_{i1}, W_{i2})$。\n-   从 $\\operatorname{Cov}(W_{i1}, Y_i) = \\beta_1 \\sigma_X^2$，我们可以识别 $\\beta_1 = \\operatorname{Cov}(W_{i1}, Y_i) / \\sigma_X^2$（假设 $\\sigma_X^2 > 0$）。\n-   最后，在 $\\beta_1$ 和 $\\mu_X = \\operatorname{E}[W_{i1}]$ 被识别后，我们可以识别 $\\beta_0 = \\operatorname{E}[Y_i] - \\beta_1 \\operatorname{E}[W_{i1}]$。\n\n设计（i）的结论：重复的生物标志物测量恢复了我们关注的整个参数向量 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。\n\n**第三部分：设计（ii）分析 - 验证子样本**\n\n在验证子样本中，对于一部分受试者，我们观测到三元组 $(W_i, Y_i, X_i)$。真实预测变量 $X_i$ 的可获得性提供了直接信息。\n-   从验证受试者中，我们可以直接计算测量误差 $U_i = W_i - X_i$。这些误差的方差 $\\operatorname{Var}(W_i - X_i)$ 直接识别了 $\\sigma_U^2$。\n-   类似地，我们可以直接计算验证集中观测到的 $X_i$ 值的样本方差，从而识别 $\\sigma_X^2$。\n-   更直接地，由于 $X_i$ 是可观测的，我们可以使用验证数据通过标准普通最小二乘法来拟合回归模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$。这个回归直接识别了 $\\beta_0$ 和 $\\beta_1$。在 $\\beta_1$ 已知的情况下，我们便可以像重复测量的情况一样继续进行。\n\n设计（ii）的结论：验证子样本恢复了 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。\n\n### 逐项分析\n\n**A. 在没有外部信息的情况下，仅观测 $(W_i, Y_i)$ 无法识别 $(\\beta_0, \\beta_1, \\sigma_U^2)$，因为 $\\operatorname{Var}(W_i)$ 分解为 $\\operatorname{Var}(X_i)$ 和 $\\sigma_U^2$ 的方式无法由可观测分布确定。对每个受试者进行带独立误差的重复生物标志物测量可以识别 $\\sigma_U^2$ 和 $\\operatorname{Var}(X_i)$，从而能够从可观测的交叉协方差中识别 $\\beta_1$，进而从可观测的均值中识别 $\\beta_0$。带有金标准 $X_i$ 的验证子样本同样可以识别 $\\sigma_U^2$ 和 $\\operatorname{Var}(X_i)$，从而恢复 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。**\n该陈述准确地总结了上述分析所有三个部分的结论。不可识别性的原因陈述正确。通过重复测量和验证子样本恢复可识别性的机制也描述正确。\n**结论：正确**\n\n**B. 如果 $U_i$ 和 $\\varepsilon_i$ 是高斯分布的，那么 $(W_i, Y_i)$ 的联合分布是二元正态分布，并唯一确定 $(\\beta_0, \\beta_1, \\sigma_U^2)$，因此无需重复测量或验证即可满足可识别性。**\n如果 $X_i, U_i, \\varepsilon_i$ 均为高斯分布，那么 $(W_i, Y_i)$ 确实是二元正态分布。一个二元正态分布由其五个矩（两个均值，两个方差，一个协方差）完全确定。我们在第一部分的分析完全基于这五个矩，并证明了它们不足以唯一确定参数。正态性假设没有提供额外的方程或约束来解决这个欠定系统。因此，即使在高斯假设下，不可识别性问题依然存在。这是测量误差模型中的一个经典结论。\n**结论：不正确**\n\n**C. 因为 $U_i$ 的均值为零，所以即使在 $\\beta_1$ 和 $\\sigma_U^2$ 未知的情况下，仅从 $\\operatorname{E}[Y_i]$ 和 $\\operatorname{E}[W_i]$ 就可以识别 $\\beta_0$，因此只有 $\\beta_1$ 和 $\\sigma_U^2$ 存在可识别性问题。**\n根据我们的分析，$\\operatorname{E}[Y_i] = \\beta_0 + \\beta_1 \\operatorname{E}[W_i]$。整理后得到 $\\beta_0 = \\operatorname{E}[Y_i] - \\beta_1 \\operatorname{E}[W_i]$。这个表达式表明，识别 $\\beta_0$ 需要知道 $\\beta_1$。正如我们所证，在基本情况下 $\\beta_1$ 是不可识别的，因此 $\\beta_0$ 也是不可识别的。$\\beta_1$ 的不可识别性会传播给 $\\beta_0$。\n**结论：不正确**\n\n**D. 带独立 $\\varepsilon_{i1}$ 和 $\\varepsilon_{i2}$ 的重复结局测量 $Y_{i1}$ 和 $Y_{i2}$（但只有一个生物标志物测量值 $W_i$）足以恢复 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性，因为它们可以从 $Y_{i1} - Y_{i2}$ 的变异性中揭示 $\\sigma_U^2$。**\n我们来分析这个提议的设计。我们有 $Y_{i1} = \\beta_0 + \\beta_1 X_i + \\varepsilon_{i1}$ 和 $Y_{i2} = \\beta_0 + \\beta_1 X_i + \\varepsilon_{i2}$。它们的差为 $Y_{i1} - Y_{i2} = \\varepsilon_{i1} - \\varepsilon_{i2}$。这个差的方差是 $\\operatorname{Var}(Y_{i1} - Y_{i2}) = \\operatorname{Var}(\\varepsilon_{i1}) + \\operatorname{Var}(\\varepsilon_{i2}) = 2\\sigma_\\varepsilon^2$。这个设计揭示了结局噪声方差 $\\sigma_\\varepsilon^2$，而不是预测变量误差方差 $\\sigma_U^2$。在方程 $\\operatorname{Var}(W_i) = \\sigma_X^2 + \\sigma_U^2$ 中，$\\sigma_X^2$ 和 $\\sigma_U^2$ 之间的混淆这一根本问题完全没有解决。这个设计不能恢复 $(\\beta_0, \\beta_1, \\sigma_U^2)$ 的可识别性。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "了解了可识别性问题后，下一步是学习如何实际估计存在测量误差时的真实关系。这个练习将带你从理论走向实践，应用矩估计法来推导一个针对测量误差的校正斜率估计量 。更进一步，该练习还要求你分析这个估计量在有限样本下的偏差，揭示了一个重要事实：即使是理论上一致的估计量，在实际数据分析中也可能存在系统性偏差。",
            "id": "3884491",
            "problem": "一项队列研究旨在对调节心输出量的潜在血浆生物标志物与血流动力学结果之间的关系进行建模。对于每个受试者 $i \\in \\{1,\\dots,n\\}$，潜在生物标志物浓度 $X_i$ 无法直接观测。替代地，一台检测设备产生观测测量值 $W_i = X_i + U_i$，其中 $U_i$ 是加性测量误差，其方差 $\\sigma_U^2$ 通过检测校准已知。临床结果满足 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$。假设以下数据生成过程：\n- $X_i \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$，$U_i \\sim \\mathcal{N}(0, \\sigma_U^2)$，$\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_{\\varepsilon}^2)$，\n- $\\{X_i, U_i, \\varepsilon_i\\}$ 在受试者之间和受试者内部均相互独立，\n- $\\sigma_U^2$ 已知；$\\sigma_X^2$ 和 $\\sigma_{\\varepsilon}^2$ 未知。\n\n令 $\\bar{W} = \\frac{1}{n}\\sum_{i=1}^{n} W_i$，$\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$，并定义无偏样本协方差和方差\n$$\nS_{WY} = \\frac{1}{n-1} \\sum_{i=1}^{n} (W_i - \\bar{W})(Y_i - \\bar{Y}), \\quad S_W^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (W_i - \\bar{W})^2.\n$$\n从经典加性测量误差模型以及方差和协方差的定义出发，通过调整 $S_{WY}$ 和 $S_W^2$ 来估计 $\\operatorname{Cov}(X,Y)$ 和 $\\operatorname{Var}(X)$，从而推导出生物标志物-结果斜率 $\\beta_1$ 的校正最小二乘估计量。然后，在给定的正态性和独立性假设下，通过获得其期望的一阶（关于 $1/(n-1)$）近似来评估此校正估计量的有限样本偏差。您的近似必须表示为关于 $\\beta_1$、$\\sigma_X^2$、$\\sigma_U^2$ 和 $n$ 的单一闭式解析表达式。\n\n给出校正估计量期望的一阶近似的最终表达式。无需进行数值计算。",
            "solution": "用户希望我验证并解决一个涉及变量误差模型的统计问题。\n\n### 第 1 步：提取已知条件\n- **观测测量值模型：** $W_i = X_i + U_i$，对于 $i \\in \\{1,\\dots,n\\}$。\n- **临床结果模型：** $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$。\n- **潜在变量分布：** $X_i \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$。\n- **测量误差分布：** $U_i \\sim \\mathcal{N}(0, \\sigma_U^2)$。\n- **模型误差分布：** $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_{\\varepsilon}^2)$。\n- **独立性：** 随机变量 $\\{X_i, U_i, \\varepsilon_i\\}$ 相互独立。\n- **已知/未知参数：** $\\sigma_U^2$ 已知；$\\sigma_X^2$ 和 $\\sigma_{\\varepsilon}^2$ 未知。\n- **样本统计量：**\n  - $\\bar{W} = \\frac{1}{n}\\sum_{i=1}^{n} W_i$\n  - $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$\n  - $S_{WY} = \\frac{1}{n-1} \\sum_{i=1}^{n} (W_i - \\bar{W})(Y_i - \\bar{Y})$\n  - $S_W^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (W_i - \\bar{W})^2$\n- **任务：**\n  1. 推导 $\\beta_1$ 的校正最小二乘估计量。\n  2. 获得此校正估计量期望的一阶（关于 $1/(n-1)$）近似，用 $\\beta_1$、$\\sigma_X^2$、$\\sigma_U^2$ 和 $n$ 表示。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：**该问题描述了一个经典的加性测量误差模型（变量误差模型），这是统计学、生物统计学和计量经济学中的一个标准基础课题。正态性和独立性的假设是常见的，并构成了易于理解的分析基础。整个设置在科学上是合理的，并基于已建立的统计学原理。\n- **适定性：**问题陈述清晰，提供了推导所要求的估计量及其近似期望所需的所有必要定义、假设和模型。目标明确且可实现。\n- **客观性：**问题是用精确、客观的数学语言表述的。\n- **结论：**该问题没有任何科学或逻辑上的缺陷，是完全指定的，并且是统计理论中一个标准的、非平凡的问题。因此，它是有效的。\n\n### 第 3 步：结论与行动\n该问题有效。我将继续进行解答。\n\n解答过程分为两部分。首先，我们推导斜率参数 $\\beta_1$ 的校正估计量。其次，我们推导该估计量期望的一阶近似，以评估其有限样本偏差。\n\n**第 1 部分：校正估计量的推导**\n\n$Y_i$ 对 $X_i$ 回归中的真实斜率参数 $\\beta_1$ 由协方差与方差之比给出：\n$$\n\\beta_1 = \\frac{\\operatorname{Cov}(X,Y)}{\\operatorname{Var}(X)}\n$$\n我们的目标是用可观测变量 $W_i$ 和 $Y_i$ 的矩来表示 $\\operatorname{Cov}(X,Y)$ 和 $\\operatorname{Var}(X)$。我们使用给定的模型定义和独立性假设。\n\n首先，我们求出可观测测量值 $W$ 与结果 $Y$ 之间的协方差：\n$$\n\\begin{aligned}\n\\operatorname{Cov}(W,Y) = \\operatorname{Cov}(X_i + U_i, \\beta_0 + \\beta_1 X_i + \\varepsilon_i) \\\\\n= \\operatorname{Cov}(X_i, \\beta_1 X_i) + \\operatorname{Cov}(X_i, \\varepsilon_i) + \\operatorname{Cov}(U_i, \\beta_1 X_i) + \\operatorname{Cov}(U_i, \\varepsilon_i) \\\\\n= \\beta_1 \\operatorname{Cov}(X_i, X_i) + 0 + 0 + 0 \\\\\n= \\beta_1 \\operatorname{Var}(X) = \\beta_1 \\sigma_X^2\n\\end{aligned}\n$$\n由于 $X_i$、$U_i$ 和 $\\varepsilon_i$ 相互独立，其他协方差项均为零。这表明 $\\operatorname{Cov}(X,Y) = \\operatorname{Cov}(W,Y)$。\n\n接下来，我们求出可观测测量值 $W$ 的方差：\n$$\n\\begin{aligned}\n\\operatorname{Var}(W) = \\operatorname{Var}(X_i + U_i) \\\\\n= \\operatorname{Var}(X_i) + \\operatorname{Var}(U_i) + 2\\operatorname{Cov}(X_i, U_i) \\\\\n= \\sigma_X^2 + \\sigma_U^2 + 0 = \\sigma_X^2 + \\sigma_U^2\n\\end{aligned}\n$$\n这是因为 $X_i$ 和 $U_i$ 是独立的。由此，我们可以将潜在变量 $X$ 的方差表示为：\n$$\n\\operatorname{Var}(X) = \\sigma_X^2 = \\operatorname{Var}(W) - \\sigma_U^2\n$$\n将这些矩关系代入 $\\beta_1$ 的定义中：\n$$\n\\beta_1 = \\frac{\\operatorname{Cov}(W,Y)}{\\operatorname{Var}(W) - \\sigma_U^2}\n$$\n这是矩估计量的基础。我们用它们的无偏样本估计量 $S_{WY}$ 和 $S_W^2$ 分别替换总体矩 $\\operatorname{Cov}(W,Y)$ 和 $\\operatorname{Var}(W)$。由于 $\\sigma_U^2$ 已知，我们可以构造校正最小二乘估计量，我们将其表示为 $\\hat{\\beta}_1$：\n$$\n\\hat{\\beta}_1 = \\frac{S_{WY}}{S_W^2 - \\sigma_U^2}\n$$\n\n**第 2 部分：校正估计量的有限样本偏差**\n\n估计量 $\\hat{\\beta}_1$ 是两个随机变量的比值，因此通常情况下，$\\mathbb{E}[\\hat{\\beta}_1] \\neq \\mathbb{E}[S_{WY}] / \\mathbb{E}[S_W^2 - \\sigma_U^2]$。为了求其期望的近似值，我们对随机变量之比 $A/B$ 的期望使用二阶泰勒级数展开（德尔塔方法的一种形式）：\n$$\n\\mathbb{E}\\left[\\frac{A}{B}\\right] \\approx \\frac{\\mathbb{E}[A]}{\\mathbb{E}[B]} \\left( 1 + \\frac{\\operatorname{Var}(B)}{(\\mathbb{E}[B])^2} - \\frac{\\operatorname{Cov}(A,B)}{\\mathbb{E}[A]\\mathbb{E}[B]} \\right)\n$$\n该近似在方差和协方差上是一阶的，其阶数为 $1/(n-1)$。\n令 $A = S_{WY}$ 且 $B = S_W^2 - \\sigma_U^2$。我们需要求出这些项的期望、方差和协方差。\n\n期望为：\n$$\n\\mathbb{E}[A] = \\mathbb{E}[S_{WY}] = \\operatorname{Cov}(W,Y) = \\beta_1 \\sigma_X^2\n$$\n$$\n\\mathbb{E}[B] = \\mathbb{E}[S_W^2 - \\sigma_U^2] = \\mathbb{E}[S_W^2] - \\sigma_U^2 = \\operatorname{Var}(W) - \\sigma_U^2 = (\\sigma_X^2 + \\sigma_U^2) - \\sigma_U^2 = \\sigma_X^2\n$$\n期望之比为 $\\frac{\\mathbb{E}[A]}{\\mathbb{E}[B]} = \\frac{\\beta_1 \\sigma_X^2}{\\sigma_X^2} = \\beta_1$，这证实了该估计量是一致的。\n\n接下来，我们求方差和协方差项。由于 $W_i$ 和 $Y_i$ 是独立正态变量的线性组合，向量 $(W_i, Y_i)$ 服从二元正态分布。对于大小为 $n$ 的二元正态样本，样本方差的方差以及样本方差与样本协方差之间的协方差由以下公式给出：\n$$\n\\operatorname{Var}(S_W^2) = \\frac{2(\\operatorname{Var}(W))^2}{n-1}\n$$\n$$\n\\operatorname{Cov}(S_{WY}, S_W^2) = \\frac{2\\operatorname{Var}(W)\\operatorname{Cov}(W,Y)}{n-1}\n$$\n我们有 $\\operatorname{Var}(B) = \\operatorname{Var}(S_W^2 - \\sigma_U^2) = \\operatorname{Var}(S_W^2)$，因为 $\\sigma_U^2$ 是一个已知常数。\n$$\n\\operatorname{Var}(B) = \\frac{2(\\sigma_X^2 + \\sigma_U^2)^2}{n-1}\n$$\n对于 $A$ 和 $B$ 之间的协方差：\n$$\n\\operatorname{Cov}(A,B) = \\operatorname{Cov}(S_{WY}, S_W^2 - \\sigma_U^2) = \\operatorname{Cov}(S_{WY}, S_W^2) = \\frac{2(\\sigma_X^2 + \\sigma_U^2)(\\beta_1 \\sigma_X^2)}{n-1}\n$$\n现在，我们将这些分量代入泰勒近似公式。\n校正项为 $1 + \\frac{\\operatorname{Var}(B)}{(\\mathbb{E}[B])^2} - \\frac{\\operatorname{Cov}(A,B)}{\\mathbb{E}[A]\\mathbb{E}[B]}$。我们来计算这两个分数：\n$$\n\\frac{\\operatorname{Var}(B)}{(\\mathbb{E}[B])^2} = \\frac{\\frac{2(\\sigma_X^2 + \\sigma_U^2)^2}{n-1}}{(\\sigma_X^2)^2} = \\frac{2(\\sigma_X^2 + \\sigma_U^2)^2}{(n-1)(\\sigma_X^2)^2}\n$$\n$$\n\\frac{\\operatorname{Cov}(A,B)}{\\mathbb{E}[A]\\mathbb{E}[B]} = \\frac{\\frac{2(\\sigma_X^2 + \\sigma_U^2)(\\beta_1 \\sigma_X^2)}{n-1}}{(\\beta_1 \\sigma_X^2)(\\sigma_X^2)} = \\frac{2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)\\sigma_X^2}\n$$\n用第一个减去第二个：\n$$\n\\begin{aligned}\n\\frac{\\operatorname{Var}(B)}{(\\mathbb{E}[B])^2} - \\frac{\\operatorname{Cov}(A,B)}{\\mathbb{E}[A]\\mathbb{E}[B]} = \\frac{2(\\sigma_X^2 + \\sigma_U^2)^2}{(n-1)(\\sigma_X^2)^2} - \\frac{2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)\\sigma_X^2} \\\\\n= \\frac{2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)(\\sigma_X^2)^2} \\left[ (\\sigma_X^2 + \\sigma_U^2) - \\sigma_X^2 \\right] \\\\\n= \\frac{2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)(\\sigma_X^2)^2} [\\sigma_U^2] \\\\\n= \\frac{2\\sigma_U^2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)(\\sigma_X^2)^2}\n\\end{aligned}\n$$\n最后，我们将其代回近似期望的完整表达式中：\n$$\n\\mathbb{E}[\\hat{\\beta}_1] \\approx \\beta_1 \\left( 1 + \\frac{2\\sigma_U^2(\\sigma_X^2 + \\sigma_U^2)}{(n-1)(\\sigma_X^2)^2} \\right)\n$$\n这就是所求的校正估计量期望的一阶近似。偏差是第二项，其阶数为 $O(1/n)$ 且为正（假设 $\\beta_1 \\neq 0$），这表明在有限样本中，该估计量倾向于高估 $\\beta_1$ 的量级。",
            "answer": "$$\n\\boxed{\\beta_1 \\left( 1 + \\frac{2\\sigma_U^2 (\\sigma_X^2 + \\sigma_U^2)}{(n-1)(\\sigma_X^2)^2} \\right)}\n$$"
        },
        {
            "introduction": "我们目前为止都聚焦于经典的测量误差模型，其中观测值是真实值加上一个独立的误差。然而，在生物医学研究中，误差的来源和结构多种多样。本练习将介绍另一种重要的误差模型——Berkson误差模型，并要求你设计一个思想实验来区分这两种模型 。这个挑战性的练习将促使你深入思考不同误差结构背后的因果机制，并体会巧妙的实验设计如何在模型辨识中发挥关键作用。",
            "id": "3884496",
            "problem": "您正在研究一个暴露-反应系统，其中，对于受试者 $i$，标量结果 $Y_i$ 是通过一个带有加性噪声的线性结构模型，由潜在的真实暴露 $X_i$ 生成的，$Y_i = \\alpha + \\beta X_i + \\epsilon_i$，其中 $\\epsilon_i$ 是零均值、有限方差的噪声，并且与所有暴露相关量以及任何实验设计随机化均独立。对于每个受试者 $i$，您可以获得三个重复的替代暴露读数 $W_{ij}$，其中 $j \\in \\{1,2,3\\}$。您将实施一个随机化方案，在确定 $Y_i$ 时，从三个替代读数中精确地使用一个来设定驱动 $Y_i$ 的暴露剂量；将随机选择的索引表示为 $J_i \\in \\{1,2,3\\}$，它是从所有其他变量中均匀且独立地选择的。\n\n两种相互竞争的误差结构似乎是合理的：\n\n- 经典误差：替代读数是对受试者 $i$ 的单一固定真实暴露的重复带噪测量，因此 $W_{ij} = X_i + U_{ij}$，其中 $U_{ij}$ 是独立同分布 (IID) 的，均值为零，方差为 $\\sigma_U^2$，并且与 $X_i$、$\\epsilon_i$ 和 $J_i$ 独立。在结果确定时，$J_i$ 的随机选择不影响 $X_i$。\n\n- 带有随机化设定点的 Berkson 误差：随机化索引 $J_i$ 指示在结果确定时实施哪个替代设定点，实现的真实暴露为 $X_i = W_{iJ_i} + V_i$，其中 $V_i$ 均值为零，与所有 $j$ 的 $W_{ij}$、$\\epsilon_i$ 和 $J_i$ 均独立。未被 $J_i$ 选中的另外两个替代读数被测量但未被实施。\n\n令 $\\bar{W}_i = (W_{i1} + W_{i2} + W_{i3})/3$ 为受试者内均值，$D_{ij} = W_{ij} - \\bar{W}_i$ 为受试者内偏差。您可以假设所有相关变量都是平方可积的，并且联合分布使得条件化和协方差运算是有效的。\n\n请设计一个检验，在该随机化方案下能够区分经典误差模型和 Berkson 误差模型，仅使用涉及 $Y_i$ 和偏差 $D_{ij}$ 的条件方差和协方差（可能通过其条件方差进行标准化），并在适当的情况下以 $\\bar{W}_i$ 和 $J_i$ 为条件。哪个选项正确地指定了一个科学有效、可检验的标准及其理由？\n\nA. 均匀地随机选择 $J_i$ 来确定哪个 $W_{ij}$ 在结果确定时设定暴露量。然后检验原假设 $H_0$: $\\operatorname{Cov}\\!\\big(Y_i, D_{ij} \\mid \\bar W_i, J_i\\big) = 0$ 对所有 $j \\in \\{1,2,3\\}$ 成立，备择假设为 $H_1$: $\\operatorname{Cov}\\!\\big(Y_i, D_{iJ_i} \\mid \\bar W_i, J_i\\big) \\neq 0$。一个相合的、无尺度的统计量是标准化的条件协方差\n$$\nS \\;=\\; \\frac{\\mathbb{E}\\!\\left[\\left(Y_i - \\mathbb{E}[Y_i \\mid \\bar W_i]\\right)\\left(W_{iJ_i} - \\bar W_i\\right)\\right]}{\\mathbb{E}\\!\\left[(W_{iJ_i} - \\bar W_i)^2\\right]}.\n$$\n在经典误差下，$S = 0$；在 Berkson 误差下，$S = \\beta$（因此当 $\\beta \\neq 0$ 时非零）。\n\nB. 不进行任何随机化或条件化，计算 $R = \\operatorname{Cov}(Y_i, \\bar W_i)/\\operatorname{Var}(\\bar W_i)$。如果 $R > 0$ 则断定为 Berkson 误差，如果 $R = 0$ 则断定为经典误差，因为只有经典误差会将 $Y_i$ 对 $\\bar W_i$ 的回归衰减至零。\n\nC. 使用三个重复读数的差值来检验 $\\operatorname{Cov}(Y_i, W_{i1} - W_{i2} \\mid \\bar W_i) \\neq 0$ 作为经典误差的证据，$\\operatorname{Cov}(Y_i, W_{i1} - W_{i2} \\mid \\bar W_i) = 0$ 作为 Berkson 误差的证据；在经典误差中，两个替代读数的差值携带了真实的暴露信号，而在 Berkson 误差中则没有。\n\nD. 将受试者按其受试者内方差 $\\operatorname{Var}(W_{ij} \\mid i)$ 的三分位数进行分层，并比较不同三分位数组的 $\\operatorname{Var}(Y_i \\mid \\text{tertile})$。如果 $\\operatorname{Var}(Y_i)$ 随着 $W_{ij}$ 的受试者内方差的增加而增加，则断定为经典误差；如果不是，则断定为 Berkson 误差。这只使用条件方差，不需要随机化。",
            "solution": "用户希望我扮演一名 STEM 教授，验证一个关于区分经典和 Berkson 测量误差模型的问题陈述，然后提供详细的解答。\n\n### 第一步：提取已知条件\n\n-   **结果模型**：$Y_i = \\alpha + \\beta X_i + \\epsilon_i$。\n-   **误差项 $\\epsilon_i$**：零均值、有限方差，与所有暴露相关量和随机化独立。\n-   **替代读数**：对每个受试者 $i$，有三个重复读数 $W_{ij}$，其中 $j \\in \\{1,2,3\\}$。\n-   **随机化**：选择一个替代读数 $W_{iJ_i}$ 来设定暴露剂量。索引 $J_i$ 从 $\\{1,2,3\\}$ 中均匀选择，并与所有其他变量独立。\n-   **模型1（经典误差）**：\n    -   $W_{ij} = X_i + U_{ij}$。\n    -   $U_{ij}$ 是独立同分布的，均值为零，方差为 $\\sigma_U^2$，且与 $X_i$、$\\epsilon_i$ 和 $J_i$ 独立。\n    -   潜在真实暴露 $X_i$ 是受试者 $i$ 的一个固定特征，不受 $J_i$ 选择的影响。结果 $Y_i$ 依赖于这个潜在的 $X_i$。\n-   **模型2（Berkson 误差）**：\n    -   $X_i = W_{iJ_i} + V_i$。\n    -   $V_i$ 是零均值，且与所有的 $W_{ij}$、$\\epsilon_i$ 和 $J_i$ 独立。\n    -   真实暴露 $X_i$ 是基于随机选择的替代设定点 $W_{iJ_i}$ 的一个实现。\n-   **定义**：\n    -   受试者内均值：$\\bar{W}_i = (W_{i1} + W_{i2} + W_{i3})/3$。\n    -   受试者内偏差：$D_{ij} = W_{ij} - \\bar{W}_i$。\n-   **假设**：变量是平方可积的；条件化和协方差运算是有效的。\n-   **任务**：设计一个检验，使用涉及 $Y_i$ 和 $D_{ij}$ 的条件（协）方差，并在 $\\bar{W}_i$ 和 $J_i$ 上进行条件化，以区分这两个模型。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学基础**：该问题在统计学和流行病学中有坚实的基础。经典和 Berkson 误差模型是测量误差领域的基本概念。所描述的实验设计是一个合理（尽管理想化）的随机化方案。\n-   **适定性**：该问题是适定的。它为数据生成过程定义了两个不同且互斥的模型，并要求基于可观测数量给出一个统计标准来区分它们。目标明确，检验所需的组成部分也已指定。\n-   **客观性**：该问题以精确、客观的数学语言陈述。所有模型和变量都得到了正式定义。\n\n该问题通过了所有验证检查。没有科学缺陷、模糊之处或矛盾。这是一个在统计建模中非平凡但可解的问题。\n\n### 第三步：结论和行动\n\n问题是**有效的**。我将继续推导解决方案。\n\n### 基于原理的推导\n\n任务是找到一个基于 $\\operatorname{Cov}(Y_i, D_{ij} \\mid \\bar{W}_i, J_i)$ 的统计检验，该检验在两种误差模型下的表现不同。让我们为每个模型分析这个条件协方差。核心挑战在于正确处理条件化和每个模型的结构。\n\n我们将首先建立的一个关键见解是受试者内均值 $\\bar{W}_i$ 与偏差 $D_{ij}$ 之间的关系。这个性质对经典误差模型至关重要。\n\n**经典误差模型分析**\n在此模型下，$Y_i = \\alpha + \\beta X_i + \\epsilon_i$ 且 $W_{ij} = X_i + U_{ij}$。随机化索引 $J_i$ 不影响 $X_i$ 或 $Y_i$。\n可观测变量可以用潜变量表示：\n-   $\\bar{W}_i = \\frac{1}{3}\\sum_{j=1}^3(X_i + U_{ij}) = X_i + \\bar{U}_i$，其中 $\\bar{U}_i = \\frac{1}{3}\\sum_j U_{ij}$。\n-   $D_{ij} = W_{ij} - \\bar{W}_i = (X_i + U_{ij}) - (X_i + \\bar{U}_i) = U_{ij} - \\bar{U}_i$。\n\n$D_{ij}$ 项仅是测量误差 $U_{ik}$ 的函数。关键的是，偏差集合 $\\{D_{i1}, D_{i2}, D_{i3}\\}$ 与受试者内均值 $\\bar{W}_i$ 不相关：\n$$ \\operatorname{Cov}(D_{ij}, \\bar{W}_i) = \\operatorname{Cov}(U_{ij} - \\bar{U}_i, X_i + \\bar{U}_i) $$\n根据 $X_i$ 和所有 $U_{ik}$ 的独立性，这等于：\n$$ \\operatorname{Cov}(U_{ij} - \\bar{U}_i, \\bar{U}_i) = \\operatorname{Cov}(U_{ij}, \\bar{U}_i) - \\operatorname{Var}(\\bar{U}_i) $$\n由于 $U_{ij}$ 是独立同分布的，方差为 $\\sigma_U^2$：\n$$ \\operatorname{Cov}(U_{ij}, \\bar{U}_i) = \\operatorname{Cov}\\left(U_{ij}, \\frac{1}{3}\\sum_{k=1}^3 U_{ik}\\right) = \\frac{1}{3}\\operatorname{Var}(U_{ij}) = \\frac{\\sigma_U^2}{3} $$\n$$ \\operatorname{Var}(\\bar{U}_i) = \\operatorname{Var}\\left(\\frac{1}{3}\\sum_{k=1}^3 U_{ik}\\right) = \\frac{1}{9}\\sum_{k=1}^3 \\operatorname{Var}(U_{ik}) = \\frac{3\\sigma_U^2}{9} = \\frac{\\sigma_U^2}{3} $$\n因此，$\\operatorname{Cov}(D_{ij}, \\bar{W}_i) = \\frac{\\sigma_U^2}{3} - \\frac{\\sigma_U^2}{3} = 0$。\n\n在标准假设下（例如，误差的正态性，或只考虑线性关系），不相关性意味着以 $\\bar{W}_i$ 为条件并不能提供关于 $D_{ij}$ 的信息。因此，$\\operatorname{Cov}(Y_i, D_{ij} \\mid \\bar{W}_i) = \\operatorname{Cov}(Y_i, D_{ij})$。此外，由于在该模型中 $Y_i$ 和 $D_{ij}$ 与随机化索引 $J_i$ 独立，我们有 $\\operatorname{Cov}(Y_i, D_{ij} \\mid \\bar{W}_i, J_i) = \\operatorname{Cov}(Y_i, D_{ij})$。\n\n让我们计算这个无条件协方差：\n$$ \\operatorname{Cov}(Y_i, D_{ij}) = \\operatorname{Cov}(\\alpha + \\beta X_i + \\epsilon_i, U_{ij} - \\bar{U}_i) $$\n根据 $X_i$、$\\epsilon_i$ 和所有 $U_{ik}$ 的独立性，协方差展开中的每一项都为零。例如，$\\operatorname{Cov}(\\beta X_i, U_{ij} - \\bar{U}_i) = 0$。\n所以，在经典误差模型下：\n$$ \\operatorname{Cov}(Y_i, D_{ij} \\mid \\bar{W}_i, J_i) = 0 \\quad \\text{for all } j \\in \\{1,2,3\\}. $$\n\n**Berkson 误差模型分析**\n在此模型下，$X_i = W_{iJ_i} + V_i$，这导致 $Y_i = \\alpha + \\beta(W_{iJ_i} + V_i) + \\epsilon_i$。\n需要计算的表达式是 $\\operatorname{Cov}(Y_i, D_{ij} \\mid \\bar{W}_i, J_i)$。问题提出了一个基于 $j=J_i$ 这一特定情况的检验，即使用与实际实施的替代读数相对应的偏差。让我们分析 $\\operatorname{Cov}(Y_i, D_{iJ_i} \\mid \\bar{W}_i, J_i)$。\n$$ D_{iJ_i} = W_{iJ_i} - \\bar{W}_i $$\n协方差为：\n$$ \\operatorname{Cov}(Y_i, D_{iJ_i} \\mid \\bar{W}_i, J_i) = \\operatorname{Cov}(\\alpha + \\beta W_{iJ_i} + \\beta V_i + \\epsilon_i, W_{iJ_i} - \\bar{W}_i \\mid \\bar{W}_i, J_i) $$\n常数 $\\alpha$ 消失。涉及 $V_i$ 和 $\\epsilon_i$ 的项为零，因为 $V_i$ 和 $\\epsilon_i$ 与所有 $W_{ij}$ 和 $J_i$（因此也与它们的任何函数，如 $\\bar{W}_i$ 和 $D_{iJ_i}$）独立。\n$$ = \\operatorname{Cov}(\\beta W_{iJ_i}, W_{iJ_i} - \\bar{W}_i \\mid \\bar{W}_i, J_i) $$\n$$ = \\beta \\operatorname{Cov}(W_{iJ_i}, W_{iJ_i} - \\bar{W}_i \\mid \\bar{W}_i, J_i) $$\n根据协方差的线性性质以及 $\\bar{W}_i$ 在条件集中是固定的事实：\n$$ = \\beta \\left( \\operatorname{Cov}(W_{iJ_i}, W_{iJ_i} \\mid \\bar{W}_i, J_i) - \\operatorname{Cov}(W_{iJ_i}, \\bar{W}_i \\mid \\bar{W}_i, J_i) \\right) $$\n第二项是一个随机变量与一个常数的协方差，为零。\n$$ = \\beta \\operatorname{Var}(W_{iJ_i} \\mid \\bar{W}_i, J_i) $$\n只要三个重复的替代读数 $W_{ij}$ 不完全由它们的平均值 $\\bar{W}_i$ 决定，这个方差项 $\\operatorname{Var}(W_{iJ_i} \\mid \\bar{W}_i, J_i)$ 将是非零的。除非 $W_{ij}$ 全部相同（这将是一种退化情况），否则这是可以保证的。\n因此，在 Berkson 误差模型下（且对于 $\\beta \\neq 0$）：\n$$ \\operatorname{Cov}(Y_i, D_{iJ_i} \\mid \\bar{W}_i, J_i) \\neq 0 $$\n这建立了一个清晰的理论区别：对于经典模型，协方差为零，但对于 Berkson 模型，协方差不为零。这构成了一个有效统计检验的基础。\n\n### 逐选项分析\n\n**A. 均匀地随机选择 $J_i$ 来确定哪个 $W_{ij}$ 在结果确定时设定暴露量。然后检验原假设 $H_0$: $\\operatorname{Cov}\\!\\big(Y_i, D_{ij} \\mid \\bar W_i, J_i\\big) = 0$ 对所有 $j \\in \\{1,2,3\\}$ 成立，备择假设为 $H_1$: $\\operatorname{Cov}\\!\\big(Y_i, D_{iJ_i} \\mid \\bar W_i, J_i\\big) \\neq 0$。一个相合的、无尺度的统计量是标准化的条件协方差 ... 在经典误差下，$S = 0$；在 Berkson 误差下，$S = \\beta$。**\n\n该选项正确地确定了可检验的假设。零协方差的原假设对应于经典模型，非零协方差的备择假设对应于 Berkson 模型。让我们分析所提出的统计量 $S$：\n$$ S \\;=\\; \\frac{\\mathbb{E}\\!\\left[\\left(Y_i - \\mathbb{E}[Y_i \\mid \\bar W_i]\\right)\\left(W_{iJ_i} - \\bar W_i\\right)\\right]}{\\mathbb{E}\\!\\left[(W_{iJ_i} - \\bar W_i)^2\\right]} $$\n-   **经典模型**：如前所示，$D_{ij}$ 与 $\\bar{W}_i$ 不相关。假设线性条件期望，$\\mathbb{E}[Y_i \\mid \\bar{W}_i]$ 是 $\\bar{W}_i$ 的线性函数。分子变为 $\\mathbb{E}[ (Y_i - f(\\bar{W}_i)) D_{iJ_i} ]$。$D_{iJ_i}$ 与 $\\bar{W}_i$ 及其函数不相关，得到 $\\mathbb{E}[f(\\bar{W}_i) D_{iJ_i}] \\approx \\mathbb{E}[f(\\bar{W}_i)]\\mathbb{E}[D_{iJ_i}]=0$。分子简化为 $\\mathbb{E}[Y_i D_{iJ_i}] = \\operatorname{Cov}(Y_i, D_{iJ_i}) = 0$。因此，$S=0$。\n-   **Berkson 模型**：假设替代读数 $W_{ij}$ 是独立同分布的，使得 $D_{iJ_i}$ 和 $\\bar{W}_i$ 不相关。那么 $\\mathbb{E}[D_{iJ_i} \\mid \\bar{W}_i]=\\mathbb{E}[D_{iJ_i}]=0$。我们有 $Y_i = \\alpha + \\beta(\\bar{W}_i + D_{iJ_i}) + \\beta V_i + \\epsilon_i$，并且 $\\mathbb{E}[Y_i \\mid \\bar{W}_i] = \\alpha + \\beta \\bar{W}_i$。残差是 $Y_i - \\mathbb{E}[Y_i \\mid \\bar{W}_i] = \\beta D_{iJ_i} + \\beta V_i + \\epsilon_i$。$S$ 的分子是 $\\mathbb{E}[(\\beta D_{iJ_i} + \\beta V_i + \\epsilon_i) D_{iJ_i}] = \\beta \\mathbb{E}[D_{iJ_i}^2] = \\beta \\mathbb{E}[(W_{iJ_i} - \\bar{W}_i)^2]$。分母是 $\\mathbb{E}[(W_{iJ_i} - \\bar{W}_i)^2]$。因此，$S = \\beta$。\n该检验统计量正确地区分了模型。术语“无尺度”(scale-free)略有不精确，因为该统计量的单位与 $\\beta$相同，但核心逻辑和结果是正确的。\n**结论：正确。**\n\n**B. 不进行任何随机化或条件化，计算 $R = \\operatorname{Cov}(Y_i, \\bar W_i)/\\operatorname{Var}(\\bar W_i)$。如果 $R > 0$ 则断定为 Berkson 误差，如果 $R = 0$ 则断定为经典误差，因为只有经典误差会将 $Y_i$ 对 $\\bar W_i$ 的回归衰减至零。**\n\n这是不正确的。对于经典模型，$R = \\beta \\frac{\\sigma_X^2}{\\sigma_X^2 + \\sigma_U^2/3}$。这就是众所周知的衰减偏倚；$R$ 会向零衰减，但其本身不为零（除非 $\\beta=0$ 或 $\\sigma_X^2=0$）。对于 Berkson 模型（假设 $W_{ij}$ 独立同分布），$R = \\beta$。由于两种模型都预测 $R > 0$（对于 $\\beta > 0$），这个检验无法区分它们。其前提是有缺陷的。\n**结论：不正确。**\n\n**C. 使用三个重复读数的差值来检验 $\\operatorname{Cov}(Y_i, W_{i1} - W_{i2} \\mid \\bar W_i) \\neq 0$ 作为经典误差的证据，$\\operatorname{Cov}(Y_i, W_{i1} - W_{i2} \\mid \\bar W_i) = 0$ 作为 Berkson 误差的证据；在经典误差中，两个替代读数的差值携带了真实的暴露信号，而在 Berkson 误差中则没有。**\n\n所提供的理由在事实上是错误的。对于经典误差，$W_{i1} - W_{i2} = (X_i + U_{i1}) - (X_i + U_{i2}) = U_{i1} - U_{i2}$，其中不包含来自 $X_i$ 的信号。更详细的计算表明，在两种模型下（在标准假设下），这个协方差都为零。\n-   经典模型：$\\operatorname{Cov}(Y_i, U_{i1}-U_{i2} \\mid \\bar{W}_i) = 0$，因为 $U_{i1}-U_{i2}$ 与 $\\bar{W}_i$ 和 $Y_i$ 都不相关。\n-   Berkson 模型：对 $J_i \\in \\{1,2,3\\}$ 进行平均的详细计算表明，协方差也为零。\n由于检验统计量在两种模型下都为零，因此它没有区分能力。\n**结论：不正确。**\n\n**D. 将受试者按其受试者内方差 $\\operatorname{Var}(W_{ij} \\mid i)$ 的三分位数进行分层，并比较不同三分位数组的 $\\operatorname{Var}(Y_i \\mid \\text{tertile})$。如果 $\\operatorname{Var}(Y_i)$ 随着 $W_{ij}$ 的受试者内方差的增加而增加，则断定为经典误差；如果不是，则断定为 Berkson 误差。这只使用条件方差，不需要随机化。**\n\n一个受试者的 $W_{ij}$ 的受试者内方差是这些替代读数变异性的一个估计。\n-   经典模型：$Y_i = \\alpha + \\beta X_i + \\epsilon_i$。$Y_i$ 的方差取决于 $\\operatorname{Var}(X_i)$ 和 $\\operatorname{Var}(\\epsilon_i)$。$W_{ij}$ 的受试者内方差取决于 $\\sigma_U^2$。根据 $X_i, \\epsilon_i, U_{ij}$ 的独立性，根据 $U_{ij}$ 的一个属性进行分层不应影响 $Y_i$ 的方差。所以，$\\operatorname{Var}(Y_i \\mid \\text{tertile})$ 应该是常数。\n-   Berkson 模型：$Y_i = \\alpha + \\beta W_{iJ_i} + \\beta V_i + \\epsilon_i$。方差为 $\\operatorname{Var}(Y_i) = \\beta^2\\operatorname{Var}(W_{iJ_i}) + \\beta^2\\operatorname{Var}(V_i) + \\operatorname{Var}(\\epsilon_i)$。具有较高 $W_{ij}$ 受试者内方差的受试者，在该分层内平均会有更大的 $\\operatorname{Var}(W_{iJ_i})$。因此，$\\operatorname{Var}(Y_i \\mid \\text{tertile})$ 应该随着受试者内方差的三分位数的增加而增加。\n该选项将两种模型的预测搞反了。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}