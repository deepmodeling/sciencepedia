{
    "hands_on_practices": [
        {
            "introduction": "细胞的响应通常取决于受体如何与配体结合。第一个练习将探讨协同性，这是多位点受体的一个关键特征，即一个位点的结合会影响其他位点。您将从一个统计力学模型出发，推导出用于衡量协同性的标准指标——希尔系数（Hill coefficient, $n_H$），从而将分子间的相互作用与信号响应的宏观陡峭度直接联系起来。",
            "id": "3875044",
            "problem": "考虑一个细胞表面受体 $R$，它会二聚化并为信号配体 $L$ 提供两个相同的配体结合位点。该受体通过占据依赖的构象变化来调节下游激酶，使得受体处于活性信号状态的概率随其配体占据分数 $\\theta(L)$（被占据位点的分数）的增加而增加。假设环境是充分混合的等温环境，且平衡结合遵循质量作用定律。设与未占据位点结合的微观解离常数为 $K_{d}$，并设有一个协同因子 $c>0$，它相对于独立结合情况调节双占据状态的稳定性。具体来说，与单位点权重的乘积相比，两个配体结合的微观状态的统计权重按 $c$ 进行缩放，这反映了第二个结合事件的构象稳定化（$c>1$）或去稳定化（$c1$）。\n\n在这些假设下，根据平衡统计力学推导出的受体结合微观状态的结合多项式为\n$$\nQ(L) \\;=\\; 1 \\;+\\; 2\\,\\frac{L}{K_{d}} \\;+\\; c\\,\\left(\\frac{L}{K_{d}}\\right)^{2},\n$$\n且占据分数 $\\theta(L)$ 定义为平衡时被占据位点的期望分数。\n\n仅使用上述物理设置和基本定义，完成以下任务：\n- 从第一性原理出发，推导占据分数 $\\theta(L)$。\n- 使用Hill系数的定义，即Hill图在半饱和点处的斜率，计算\n$$\nn_{H} \\;=\\; \\left.\\frac{d\\,\\ln\\!\\left(\\frac{\\theta}{1-\\theta}\\right)}{d\\,\\ln L}\\right|_{\\theta\\,=\\,0.5}.\n$$\n请用仅含协同因子 $c$ 的单个闭式解析表达式表示您的最终答案。无需四舍五入。Hill系数是无量纲的。此外，请用文字解释您的结果的大小如何反映此双位点受体系统中协同作用的强度和符号。",
            "solution": "该问题陈述经评估为**有效**。它在科学上基于平衡统计力学和生物物理化学的原理，特别是用于协同配体结合的Adair-Klotz模型。该问题是适定的，提供了所有必要的定义和一个一致的数学框架（$Q(L)$），以推导出唯一的解。语言客观而精确。\n\n第一个任务是从第一性原理出发推导占据分数 $\\theta(L)$。结合多项式，或称配分函数 $Q(L)$，是对所有可能的结合微观状态的统计权重求和。给出的多项式为：\n$$Q(L) = 1 + 2\\frac{L}{K_{d}} + c\\left(\\frac{L}{K_{d}}\\right)^{2}$$\n在这里，项 $1$ 是未占据受体（$R$）的权重，项 $2\\frac{L}{K_{d}}$ 是两种可能的单占据状态（$RL$）的权重，项 $c\\left(\\frac{L}{K_{d}}\\right)^{2}$ 是双占据状态（$RL_2$）的权重。\n\n每个受体结合的平均配体数 $\\langle\\nu\\rangle$ 可以从结合多项式使用统计力学的基本关系推导得出：\n$$\\langle\\nu\\rangle = L \\frac{d}{dL} \\ln(Q(L)) = \\frac{L}{Q(L)} \\frac{dQ(L)}{dL}$$\n首先，我们计算 $Q(L)$ 对配体浓度 $L$ 的导数：\n$$\\frac{dQ(L)}{dL} = \\frac{d}{dL} \\left( 1 + \\frac{2L}{K_d} + \\frac{cL^2}{K_d^2} \\right) = \\frac{2}{K_d} + \\frac{2cL}{K_d^2}$$\n将此代入 $\\langle\\nu\\rangle$ 的表达式中：\n$$\\langle\\nu\\rangle = \\frac{L}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}} \\left( \\frac{2}{K_d} + \\frac{2cL}{K_d^2} \\right) = \\frac{2\\frac{L}{K_d} + 2c\\frac{L^2}{K_d^2}}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}}$$\n占据分数 $\\theta(L)$ 是平均结合配体数 $\\langle\\nu\\rangle$ 除以总结合位点数，对于这个二聚体受体，该值为 $N=2$。\n$$\\theta(L) = \\frac{\\langle\\nu\\rangle}{N} = \\frac{1}{2} \\left( \\frac{2\\frac{L}{K_d} + 2c\\frac{L^2}{K_d^2}}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}} \\right) = \\frac{\\frac{L}{K_d} + c\\left(\\frac{L}{K_d}\\right)^2}{1 + 2\\frac{L}{K_d} + c\\left(\\frac{L}{K_d}\\right)^2}$$\n这完成了任务的第一部分。\n\n第二个任务是计算在半饱和（$\\theta=0.5$）时的Hill系数 $n_H$。Hill系数定义为：\n$$n_H = \\frac{d \\ln(\\frac{\\theta}{1-\\theta})}{d \\ln L}$$\n我们定义一个归一化的配体浓度 $x = L/K_d$。那么 $d \\ln L = d \\ln(xK_d) = d \\ln x$。$n_H$ 的表达式变为：\n$$n_H = \\frac{d \\ln(\\frac{\\theta}{1-\\theta})}{d \\ln x}$$\n首先，我们用 $x$ 来表示比率 $\\frac{\\theta}{1-\\theta}$。\n$$\\theta(x) = \\frac{x + cx^2}{1 + 2x + cx^2}$$\n$$1 - \\theta(x) = 1 - \\frac{x + cx^2}{1 + 2x + cx^2} = \\frac{(1 + 2x + cx^2) - (x + cx^2)}{1 + 2x + cx^2} = \\frac{1+x}{1 + 2x + cx^2}$$\n该比率为：\n$$\\frac{\\theta}{1-\\theta} = \\frac{x+cx^2}{1+x} = \\frac{x(1+cx)}{1+x}$$\n现在，我们取自然对数：\n$$\\ln\\left(\\frac{\\theta}{1-\\theta}\\right) = \\ln(x) + \\ln(1+cx) - \\ln(1+x)$$\n我们现在可以对 $\\ln x$ 求导：\n$$n_H(x) = \\frac{d}{d \\ln x} \\left[ \\ln(x) + \\ln(1+cx) - \\ln(1+x) \\right]$$\n使用链式法则 $\\frac{d f(x)}{d \\ln x} = x \\frac{d f(x)}{dx}$，我们计算每一项：\n$$n_H(x) = \\frac{d \\ln x}{d \\ln x} + \\frac{d \\ln(1+cx)}{d \\ln x} - \\frac{d \\ln(1+x)}{d \\ln x}$$\n$$n_H(x) = 1 + x \\frac{d}{dx}\\ln(1+cx) - x \\frac{d}{dx}\\ln(1+x)$$\n$$n_H(x) = 1 + x \\left(\\frac{c}{1+cx}\\right) - x \\left(\\frac{1}{1+x}\\right) = 1 + \\frac{cx}{1+cx} - \\frac{x}{1+x}$$\n这是Hill系数作为配体浓度函数的通用表达式。\n\n我们必须在半饱和时，即 $\\theta=0.5$ 时，计算这个表达式的值。我们找到满足此条件的 $x$ 的值。\n$$\\theta(x) = 0.5 \\implies \\frac{x + cx^2}{1 + 2x + cx^2} = \\frac{1}{2}$$\n$$2(x + cx^2) = 1 + 2x + cx^2$$\n$$2x + 2cx^2 = 1 + 2x + cx^2$$\n$$2cx^2 - cx^2 = 1$$\n$$cx^2 = 1$$\n由于 $x = L/K_d > 0$ 且 $c > 0$，我们得到 $x = \\frac{1}{\\sqrt{c}}$。\n\n最后，我们将这个特定的 $x$ 值代入 $n_H(x)$ 的表达式中：\n$$n_H \\bigg|_{\\theta=0.5} = 1 + \\frac{c(\\frac{1}{\\sqrt{c}})}{1+c(\\frac{1}{\\sqrt{c}})} - \\frac{\\frac{1}{\\sqrt{c}}}{1+\\frac{1}{\\sqrt{c}}}$$\n$$n_H = 1 + \\frac{\\sqrt{c}}{1+\\sqrt{c}} - \\frac{\\frac{1}{\\sqrt{c}}}{\\frac{\\sqrt{c}+1}{\\sqrt{c}}}$$\n$$n_H = 1 + \\frac{\\sqrt{c}}{1+\\sqrt{c}} - \\frac{1}{1+\\sqrt{c}}$$\n将各项合并，使用共同的分母：\n$$n_H = \\frac{1+\\sqrt{c}}{1+\\sqrt{c}} + \\frac{\\sqrt{c}-1}{1+\\sqrt{c}} = \\frac{1+\\sqrt{c}+\\sqrt{c}-1}{1+\\sqrt{c}}$$\n$$n_H = \\frac{2\\sqrt{c}}{1+\\sqrt{c}}$$\n这是在半饱和时，用协同因子 $c$ 表示的Hill系数的最终闭式表达式。\n\n协同作用的大小和符号反映在这个结果中。Hill系数 $n_H$ 衡量剂量反应曲线在其中心点的陡峭程度，这是协同作用的一个关键指标。\n1.  对于**非协同结合**，结合事件是独立的，对应于 $c=1$。在这种情况下，$n_H = \\frac{2\\sqrt{1}}{1+\\sqrt{1}} = \\frac{2}{2} = 1$，这是独立、相同位点的期望值。\n2.  对于**正协同性**，第一个配体的结合增强了对第二个配体的亲和力，因此 $c>1$。这导致 $n_H > 1$。当 $c \\to \\infty$（无限强的协同性）时，$n_H \\to \\frac{2\\sqrt{c}}{\\sqrt{c}} = 2$。因此，$1  n_H  2$。一个更大的 $n_H$ 值表示更强的正协同性以及更具开关特性的系统响应。上限 $2$ 反映了相互作用位点的总数。\n3.  对于**负协同性**，第一个配体的结合降低了对第二个配体的亲和力，因此 $0  c  1$。这导致 $n_H  1$。当 $c \\to 0$（无限强的负协同性，此时第一个位点被占据后第二个位点基本上无法结合），$n_H \\to 0$。因此，$0  n_H  1$。一个更小的 $n_H$ 值表示更强的负协同性以及一个更平缓、分布在更宽配体浓度范围内的结合曲线。\n总而言之，$n_H$ 相对于 $1$ 的值直接反映了这个双位点系统中协同作用的性质和强度。",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{c}}{1+\\sqrt{c}}}\n$$"
        },
        {
            "introduction": "除了简单的结合，信号通路还是动态系统，其中相互拮抗的流（fluxes）会建立起稳态。本练习将介绍使用常微分方程（Ordinary Differential Equations, ODEs）对钙离子动力学进行建模，这是系统生物学的基石。您将确定系统的稳态，然后进行线性稳定性分析，以评估该状态对于扰动是否具有鲁棒性，这是细胞稳态的一个关键属性。",
            "id": "3875085",
            "problem": "考虑一个描述细胞内钙离子($\\mathrm{Ca}^{2+}$)动力学的简化双室模型，其中胞质浓度为 $c(t)$，内质网(ER)腔内浓度为 $e(t)$。假设1,4,5-三磷酸肌醇(IP$_3$)浓度恒定，使得从内质网到胞质的有效释放与浓度差成线性关系。该模型包括遵循希尔动力学（希尔系数 $n=2$）的肌/内质网$\\mathrm{Ca}^{2+}$-ATP酶（SERCA）摄取、线性质膜排出以及恒定的基础内流。控制常微分方程(ODEs)为\n$$\n\\frac{dc}{dt} \\;=\\; k_{r}\\,(e - c)\\;-\\;J_{\\mathrm{SERCA}}(c)\\;-\\;k_{e}\\,c\\;+\\;s,\n$$\n$$\n\\frac{de}{dt} \\;=\\; \\gamma\\left[J_{\\mathrm{SERCA}}(c)\\;-\\;k_{r}\\,(e - c)\\right],\n$$\n其中 $J_{\\mathrm{SERCA}}(c)$ 是SERCA摄取通量，\n$$\nJ_{\\mathrm{SERCA}}(c) \\;=\\; V\\,\\frac{c^{2}}{K^{2} + c^{2}}.\n$$\n此处，$k_{r}$ 是有效的内质网释放速率（包含了恒定IP$_3$浓度下IP$_3$受体的开放概率和被动泄漏），$k_{e}$ 是质膜排出速率，$s$ 是恒定的基础内流，$\\gamma$ 是内质网与胞质的体积比。所有参数不随时间变化。使用以下参数值（这些值被选择为具有生理学上的合理性）：\n$$\nk_{r} \\;=\\; 1\\ \\mathrm{s}^{-1},\\quad k_{e} \\;=\\; 0.5\\ \\mathrm{s}^{-1},\\quad V \\;=\\; 1\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1},\\quad K \\;=\\; 0.3\\ \\mu\\mathrm{M},\\quad s \\;=\\; 0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1},\\quad \\gamma \\;=\\; 0.1.\n$$\n从室间质量守恒原理和上述通量的定义出发，完成以下任务：\n- 在恒定IP$_3$和给定动力学的条件下，推导稳态胞质钙浓度 $c^{*}$。\n- 在稳态点 $(c^{*}, e^{*})$ 附近对系统进行线性化，并计算雅可比矩阵的特征值以评估局部稳定性。报告具有最大实部的特征值。\n将所有数值答案四舍五入至四位有效数字。以微摩尔（$\\mu\\mathrm{M}$）为单位表示 $c^{*}$，以反秒（$\\mathrm{s}^{-1}$）为单位表示特征值。最终答案必须是一次计算，以包含两个数字的单个实体形式报告。",
            "solution": "该问题经评估是有效的。它在科学上基于已确立的生物化学动力学和动力系统理论原理，提法严谨，信息充分，可得到唯一解，并且使用客观、正式的语言陈述。所有必需的参数和方程均已提供，并且所要求的任务（寻找稳态和进行线性稳定性分析）是数学生物学中的标准程序。\n\n### 第1部分：稳态分析\n\n该系统由以下常微分方程(ODEs)描述：\n$$\n\\frac{dc}{dt} = k_{r}(e - c) - V\\frac{c^{2}}{K^{2} + c^{2}} - k_{e}c + s\n$$\n$$\n\\frac{de}{dt} = \\gamma\\left[V\\frac{c^{2}}{K^{2} + c^{2}} - k_{r}(e - c)\\right]\n$$\n\n在稳态下，浓度是恒定的，因此时间导数为零。设稳态浓度为 $c^{*}$ 和 $e^{*}$。\n$$\n\\frac{dc}{dt} = 0 \\quad \\text{and} \\quad \\frac{de}{dt} = 0\n$$\n\n根据第二个方程 $\\frac{de}{dt} = 0$：\n$$\n\\gamma\\left[V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} - k_{r}(e^{*} - c^{*})\\right] = 0\n$$\n由于体积比 $\\gamma$ 非零（$\\gamma = 0.1$），括号内的项必须为零。这表示在稳态下，从胞质到内质网（ER）的SERCA摄取通量等于从内质网到胞质的释放通量。\n$$\nV\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} = k_{r}(e^{*} - c^{*})\n$$\n\n现在，我们将第一个方程 $\\frac{dc}{dt}$ 设为零：\n$$\nk_{r}(e^{*} - c^{*}) - V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} - k_{e}c^{*} + s = 0\n$$\n将第二个ODE的稳态条件结果代入此方程，得到：\n$$\n\\left( V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} \\right) - \\left( V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} \\right) - k_{e}c^{*} + s = 0\n$$\n代表胞质与内质网之间通量的项相互抵消，得到一个简单的关系式：\n$$\n-k_{e}c^{*} + s = 0\n$$\n这个结果表明，在稳态下，进入胞质的$\\mathrm{Ca}^{2+}$基础内流（$s$）与通过质膜排出的$\\mathrm{Ca}^{2+}$（$k_{e}c^{*}$）完全平衡。\n\n解出稳态胞质浓度 $c^{*}$：\n$$\nc^{*} = \\frac{s}{k_{e}}\n$$\n使用给定的参数值：\n$s = 0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$k_{e} = 0.5\\ \\mathrm{s}^{-1}$\n$$\nc^{*} = \\frac{0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{0.5\\ \\mathrm{s}^{-1}} = 0.1\\ \\mu\\mathrm{M}\n$$\n按要求四舍五入到四位有效数字，$c^{*} = 0.1000\\ \\mu\\mathrm{M}$。\n\n### 第2部分：线性稳定性分析\n\n为了评估稳态点 $(c^{*}, e^{*})$ 的局部稳定性，我们通过计算在该不动点处取值的雅可比矩阵 $J$ 来对系统进行线性化。该系统的形式为 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = \\begin{pmatrix} c \\\\ e \\end{pmatrix}$。雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial F_c}{\\partial c}  \\frac{\\partial F_c}{\\partial e} \\\\ \\frac{\\partial F_e}{\\partial c}  \\frac{\\partial F_e}{\\partial e} \\end{pmatrix}\n$$\n其中 $F_c(c, e) = k_{r}(e - c) - V\\frac{c^{2}}{K^{2} + c^{2}} - k_{e}c + s$ 且 $F_e(c, e) = \\gamma(V\\frac{c^{2}}{K^{2} + c^{2}} - k_{r}(e - c))$。\n\n首先，我们计算偏导数：\n$\\frac{\\partial F_c}{\\partial c} = -k_{r} - \\frac{d}{dc}\\left(V\\frac{c^{2}}{K^{2} + c^{2}}\\right) - k_{e} = -k_{r} - V\\frac{2cK^{2}}{(K^{2} + c^{2})^{2}} - k_{e}$\n$\\frac{\\partial F_c}{\\partial e} = k_{r}$\n$\\frac{\\partial F_e}{\\partial c} = \\gamma\\left[\\frac{d}{dc}\\left(V\\frac{c^{2}}{K^{2} + c^{2}}\\right) - k_{r}(-1)\\right] = \\gamma\\left[V\\frac{2cK^{2}}{(K^{2} + c^{2})^{2}} + k_{r}\\right]$\n$\\frac{\\partial F_e}{\\partial e} = \\gamma(-k_{r}) = -\\gamma k_{r}$\n\n接下来，我们在稳态点 $c^{*} = 0.1\\ \\mu\\mathrm{M}$ 处计算这些导数的值。计算导数本身不需要 $e^{*}$ 的值。\n让我们首先计算SERCA通量项在 $c^{*}$ 处的导数值：\n$$\nV\\frac{2c^{*}K^{2}}{(K^{2} + (c^{*})^{2})^{2}} = (1)\\frac{2(0.1)(0.3)^{2}}{((0.3)^{2} + (0.1)^{2})^{2}} = \\frac{2(0.1)(0.09)}{(0.09 + 0.01)^{2}} = \\frac{0.018}{(0.1)^{2}} = \\frac{0.018}{0.01} = 1.8\\ \\mathrm{s}^{-1}\n$$\n\n现在我们可以计算雅可比矩阵 $J$ 的元素：\n$J_{11} = \\frac{\\partial F_c}{\\partial c}\\Big|_{c^{*}} = -k_{r} - 1.8 - k_{e} = -1 - 1.8 - 0.5 = -3.3\\ \\mathrm{s}^{-1}$\n$J_{12} = \\frac{\\partial F_c}{\\partial e}\\Big|_{e^{*}} = k_{r} = 1\\ \\mathrm{s}^{-1}$\n$J_{21} = \\frac{\\partial F_e}{\\partial c}\\Big|_{c^{*}} = \\gamma(1.8 + k_{r}) = 0.1(1.8 + 1) = 0.28\\ \\mathrm{s}^{-1}$\n$J_{22} = \\frac{\\partial F_e}{\\partial e}\\Big|_{e^{*}} = -\\gamma k_{r} = -0.1(1) = -0.1\\ \\mathrm{s}^{-1}$\n\n在稳态点的雅可比矩阵是：\n$$\nJ = \\begin{pmatrix} -3.3  1 \\\\ 0.28  -0.1 \\end{pmatrix}\n$$\n该矩阵的特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根：\n$$\n\\begin{vmatrix} -3.3 - \\lambda  1 \\\\ 0.28  -0.1 - \\lambda \\end{vmatrix} = 0\n$$\n$$\n(-3.3 - \\lambda)(-0.1 - \\lambda) - (1)(0.28) = 0\n$$\n$$\n(\\lambda + 3.3)(\\lambda + 0.1) - 0.28 = 0\n$$\n$$\n\\lambda^{2} + 3.4\\lambda + 0.33 - 0.28 = 0\n$$\n$$\n\\lambda^{2} + 3.4\\lambda + 0.05 = 0\n$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-3.4 \\pm \\sqrt{(3.4)^{2} - 4(1)(0.05)}}{2(1)} = \\frac{-3.4 \\pm \\sqrt{11.56 - 0.2}}{2} = \\frac{-3.4 \\pm \\sqrt{11.36}}{2}\n$$\n两个特征值是：\n$$\n\\lambda_1 = \\frac{-3.4 + \\sqrt{11.36}}{2} \\approx \\frac{-3.4 + 3.370460}{2} = \\frac{-0.029540}{2} \\approx -0.014770\\ \\mathrm{s}^{-1}\n$$\n$$\n\\lambda_2 = \\frac{-3.4 - \\sqrt{11.36}}{2} \\approx \\frac{-3.4 - 3.370460}{2} = \\frac{-6.770460}{2} \\approx -3.38523\\ \\mathrm{s}^{-1}\n$$\n两个特征值都是实数且为负，表明该稳态是一个稳定节点。问题要求报告具有最大实部的特征值，即 $\\lambda_1$。\n四舍五入到四位有效数字，该特征值为 $-0.01477\\ \\mathrm{s}^{-1}$。\n\n最终要求的值是 $c^{*} = 0.1000\\ \\mu\\mathrm{M}$ 和具有最大实部的特征值 $\\lambda = -0.01477\\ \\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  -0.01477 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多关键的细胞决策都具有开关特性，这种行为通常由产生双稳态的正反馈回路驱动。最后一个计算实践将通过对一个激酶激活模型进行分岔分析，深入研究此类开关的工作原理。您将以数值方式确定系统在低活性和高活性状态之间翻转的关键输入阈值（鞍结分岔点），这是分析复杂非线性信号网络的一项核心技能。",
            "id": "3875043",
            "problem": "考虑一个激酶激活模块，其模型为一个单变量常微分方程 (ODE)，用于描述无量纲活性分数 $x \\in [0,1]$，该分数受无量纲输入 $u \\geq 0$ 的影响。该模块包含一个带正反馈的饱和激活通路和一个饱和失活通路。其动力学由 ODE $dx/dt = F(x,u)$ 给出，其中 $F(x,u)$ 定义为激活速率与失活速率之差。激活速率为 $v_{\\mathrm{act}}(x,u) = k_a A(u,x) (1 - x)$，其中 $A(u,x) = \\dfrac{u + \\alpha x^n}{K_a + u + \\alpha x^n}$；失活速率为 $v_{\\mathrm{deact}}(x) = k_d \\dfrac{x}{K_d + x}$。所有变量和参数均为无量纲。因此，函数 $F(x,u)$ 为 $F(x,u) = k_a A(u,x) (1 - x) - k_d \\dfrac{x}{K_d + x}$。\n\n你的任务是通过数值延拓计算活性激酶分数 $x$ 相对于输入 $u$ 的稳态分岔图，并识别出稳定性发生变化的临界输入值。在这个一维系统中，稳定性变化发生在鞍结分岔处，可通过联立条件 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$ 来检测。你必须：\n- 从第一性原理出发，推导 $F(x,u)$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的表达式，确保科学真实性和内部一致性。\n- 通过在指定范围内扫描 $u$ 来实现数值延拓，为每个 $u$ 计算稳态 $x$，并通过稳态处 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的符号来分类其稳定性。稳定的稳态满足 $\\dfrac{\\partial F}{\\partial x}(x,u)  0$，不稳定的稳态满足 $\\dfrac{\\partial F}{\\partial x}(x,u) > 0$。\n- 通过联立求解系统 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$ 来识别发生鞍结分岔的临界输入值 $u$。\n- 汇总每个测试用例的临界输入值，并按升序排列。\n\n所有计算都是无量纲的；不需要物理单位。不涉及角度。不得使用百分比；任何比例都必须表示为小数。\n\n以下参数集构成了测试套件。每个参数集指定 $(k_a, K_a, k_d, K_d, \\alpha, n, u_{\\max})$，其中 $u$ 的扫描范围为从 $u = 0$ 到 $u = u_{\\max}$：\n\n- 测试用例 $1$ (强正反馈，预期双稳态): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 6.0$, $n = 4$, $u_{\\max} = 5.0$。\n- 测试用例 $2$ (弱反馈，预期单稳态): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 0.2$, $n = 2$, $u_{\\max} = 5.0$。\n- 测试用例 $3$ (接近阈值，临界反馈): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 2.0$, $n = 3$, $u_{\\max} = 5.0$。\n\n你的程序必须：\n- 对每个测试用例，在 $u \\in [0, u_{\\max}]$ 范围内执行数值延拓，计算满足 $F(x,u) = 0$ 的所有稳态 $x \\in [0,1]$，通过 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的符号确定其稳定性，并独立地将鞍结分岔点定位为 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$ 的解。\n- 对每个测试用例，返回发生鞍结分岔的临界输入值 $u$ 的列表。如果未找到鞍结分岔，则为该测试用例返回一个空列表。\n- 将报告的每个临界输入值 $u$ 四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，其本身是一个四舍五入的临界输入值列表。例如，输出应具有 $[L_1,L_2,L_3]$ 的形式，其中 $L_i$ 是测试用例 $i$ 的浮点数列表。\n\n通过以下方式确保科学真实性：\n- 仅使用定义的 ODE 结构和饱和动力学作为基本基础。\n- 除了推导出的 $F$ 和 $\\dfrac{\\partial F}{\\partial x}$ 表达式外，不引入任何无关的快捷公式。\n- 遵守定义域约束 $x \\in [0,1]$ 和 $u \\geq 0$。\n\n该算法必须可在任何现代编程语言中实现和运行；你必须在指定环境中提供一个完整、可运行的程序，该程序能完全按照描述计算所要求的输出。",
            "solution": "用户提供了有效的问题陈述。\n\n### 第1步：提取给定信息\n- **控制方程**：无量纲活性激酶分数 $x(t) \\in [0,1]$ 的动力学由常微分方程 (ODE) 描述：\n  $$ \\frac{dx}{dt} = F(x,u) $$\n- **速率函数定义**：函数 $F(x,u)$ 是激活速率 $v_{\\mathrm{act}}(x,u)$ 和失活速率 $v_{\\mathrm{deact}}(x)$ 之差：\n  $$ F(x,u) = v_{\\mathrm{act}}(x,u) - v_{\\mathrm{deact}}(x) $$\n- **激活速率**：激活速率包含一个正反馈项：\n  $$ v_{\\mathrm{act}}(x,u) = k_a A(u,x) (1 - x) $$\n  其中 $A(u,x)$ 是一个饱和函数：\n  $$ A(u,x) = \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} $$\n- **失活速率**：失活速率遵循类米氏动力学：\n  $$ v_{\\mathrm{deact}}(x) = k_d \\frac{x}{K_d + x} $$\n- **鞍结分岔条件**：当以下两个条件同时满足时，发生稳定性变化（鞍结分岔）：\n  1.  稳态：$F(x,u) = 0$\n  2.  边际稳定性：$\\dfrac{\\partial F}{\\partial x}(x,u) = 0$\n- **稳定性判据**：如果 $\\dfrac{\\partial F}{\\partial x}  0$，则稳态是稳定的；如果 $\\dfrac{\\partial F}{\\partial x} > 0$，则是不稳定的。\n- **测试用例 (参数集)**：每个测试用例由一个元组 $(k_a, K_a, k_d, K_d, \\alpha, n, u_{\\max})$ 给出。\n  -   用例 1: $(2.0, 0.5, 1.0, 0.1, 6.0, 4, 5.0)$\n  -   用例 2: $(2.0, 0.5, 1.0, 0.1, 0.2, 2, 5.0)$\n  -   用例 3: $(2.0, 0.5, 1.0, 0.1, 2.0, 3, 5.0)$\n- **任务**：对每个测试用例，找到对应于鞍结分岔的临界输入值 $u$。这些值必须四舍五入到 $6$ 位小数并按升序排列。\n\n### 第2步：使用提取的给定信息进行验证\n该问题具有科学依据、适定且客观。\n-   **科学依据**：该模型使用标准的动力学形式（类希尔正反馈、类米氏酶促反应），这些是生化信号网络建模的基础。整体结构是双稳态开关的常见模体。\n-   **适定性**：该问题定义了一个明确的数学任务：求解特定非线性方程组的解 $(x, u)$。所有参数和约束均已提供，使得问题可解。\n-   **客观性**：该问题以精确的数学术语陈述，没有主观或模糊的语言。\n\n该问题有效。\n\n### 基于原理的设计与求解\n\n该问题要求找到发生鞍结分岔的临界输入值 $u$。这些是参数空间 $(x, u)$ 中的点，在这些点上系统的定性行为发生变化，特别是稳态对（一个稳定，一个不稳定）产生或消失的地方。\n\n**1. 系统公式化**\n系统变化率的完整表达式为：\n$$ F(x,u) = k_a \\left( \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right) (1 - x) - k_d \\frac{x}{K_d + x} $$\n鞍结分岔通过求解以下关于变量 $(x, u)$ 的两个非线性方程组来确定：\n$$\n\\begin{cases}\nF(x,u) = 0 \\\\\n\\dfrac{\\partial F}{\\partial x}(x,u) = 0\n\\end{cases}\n$$\n\n**2. 雅可比项 $\\dfrac{\\partial F}{\\partial x}$ 的推导**\n为了构建第二个方程，我们必须计算 $F(x,u)$ 关于 $x$ 的偏导数。我们可以写出 $\\dfrac{\\partial F}{\\partial x} = \\dfrac{\\partial v_{\\mathrm{act}}}{\\partial x} - \\dfrac{\\partial v_{\\mathrm{deact}}}{\\partial x}$。\n\n首先，我们推导 $\\dfrac{\\partial v_{\\mathrm{act}}}{\\partial x}$：\n令 $A(u,x) = \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n}$。对 $v_{\\mathrm{act}} = k_a A(u,x) (1-x)$ 使用乘法法则：\n$$ \\frac{\\partial v_{\\mathrm{act}}}{\\partial x} = k_a \\left[ \\frac{\\partial A}{\\partial x}(1-x) - A(u,x) \\right] $$\n现在，我们使用除法法则求 $\\dfrac{\\partial A}{\\partial x}$。令 $N(x) = u + \\alpha x^n$ 且 $D(x) = K_a + u + \\alpha x^n$。\n$$ \\frac{\\partial A}{\\partial x} = \\frac{(\\frac{dN}{dx})D(x) - N(x)(\\frac{dD}{dx})}{D(x)^2} $$\n分子和分母的导数相同：$\\frac{dN}{dx} = \\frac{dD}{dx} = n \\alpha x^{n-1}$。\n$$ \\frac{\\partial A}{\\partial x} = \\frac{(n \\alpha x^{n-1})(K_a + u + \\alpha x^n) - (u + \\alpha x^n)(n \\alpha x^{n-1})}{(K_a + u + \\alpha x^n)^2} = \\frac{n \\alpha x^{n-1} K_a}{(K_a + u + \\alpha x^n)^2} $$\n将此代回得到：\n$$ \\frac{\\partial v_{\\mathrm{act}}}{\\partial x} = k_a \\left[ \\frac{n \\alpha K_a x^{n-1}(1-x)}{(K_a + u + \\alpha x^n)^2} - \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right] $$\n接下来，我们对 $v_{\\mathrm{deact}}(x) = k_d \\frac{x}{K_d + x}$ 使用除法法则推导 $\\dfrac{\\partial v_{\\mathrm{deact}}}{\\partial x}$：\n$$ \\frac{\\partial v_{\\mathrm{deact}}}{\\partial x} = k_d \\frac{1(K_d+x) - x(1)}{(K_d+x)^2} = \\frac{k_d K_d}{(K_d+x)^2} $$\n最后，合并各项得到雅可比行列式的完整表达式：\n$$ \\frac{\\partial F}{\\partial x}(x,u) = k_a \\left[ \\frac{n \\alpha K_a x^{n-1}(1-x)}{(K_a + u + \\alpha x^n)^2} - \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right] - \\frac{k_d K_d}{(K_d+x)^2} $$\n\n**3. 数值求解策略**\n方程组 $F(x,u)=0$ 和 $\\frac{\\partial F}{\\partial x}(x,u)=0$ 对于解析解来说过于复杂。我们必须采用数值求根算法。对每个测试用例，实现将遵循以下步骤：\n- 定义 Python 函数，根据推导出的表达式计算 $F(x,u)$ 和 $\\frac{\\partial F}{\\partial x}(x,u)$。\n- 为数值求解器创建一个目标函数，该函数接受一个向量 $[x, u]$ 并返回 $[F(x,u), \\frac{\\partial F}{\\partial x}(x,u)]$ 的值。\n- 为了在指定定义域（$x \\in [0,1], u \\in [0, u_{max}]$）内找到所有分岔点，我们将使用 `scipy.optimize.root` 函数。该函数需要一个初始猜测。为确保找到所有解，我们将系统地在相关域上生成一个初始猜测 $(x_0, u_0)$ 的网格，并对每个猜测运行求解器。\n- 对求解器返回的每个解，我们执行验证检查：\n    1.  确认求解器成功收敛。\n    2.  验证解 $(x_{sol}, u_{sol})$ 位于物理现实域内，即 $0 \\le x_{sol} \\le 1$ 和 $0 \\le u_{sol} \\le u_{\\max}$。\n    3.  检查解处的函数值确实接近于零，确认它是一个真根。\n- 收集所有有效且唯一的临界输入值 $u_{sol}$。使用数值容差检查唯一性，以避免存储来自不同初始猜测的多个几乎相同的结果。\n- 对每个测试用例收集的临界值按升序排序，并按要求四舍五入到 $6$ 位小数。\n- 如果没有找到分岔点（正如对单稳态系统的预期），则为该用例返回一个空列表。\n这种系统性方法确保了对给定参数集的所有鞍结分岔点的稳健而准确的确定。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Computes the critical input values for saddle-node bifurcations\n    in a kinase activation model for given parameter sets.\n    \"\"\"\n    test_cases = [\n        # (ka, Ka, kd, Kd, alpha, n, u_max)\n        (2.0, 0.5, 1.0, 0.1, 6.0, 4, 5.0),  # Case 1: Strong feedback\n        (2.0, 0.5, 1.0, 0.1, 0.2, 2, 5.0),  # Case 2: Weak feedback\n        (2.0, 0.5, 1.0, 0.1, 2.0, 3, 5.0),  # Case 3: Borderline feedback\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        ka, Ka, kd, Kd, alpha, n, u_max = params\n\n        def F(x, u, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"Computes the rate function F(x, u).\"\"\"\n            x_c = np.clip(x, 0, 1)\n            term_act_num = u + alpha * x_c**n\n            term_act_den = Ka + u + alpha * x_c**n\n            \n            # Avoid division by zero if denominator is zero, though unlikely with K_a > 0\n            if term_act_den == 0: return 1e6\n            \n            v_act = ka * (term_act_num / term_act_den) * (1 - x_c)\n            \n            # Avoid division by zero at x = -K_d\n            if Kd + x_c == 0: return 1e6\n            v_deact = kd * (x_c / (Kd + x_c))\n            \n            return v_act - v_deact\n\n        def dFdx(x, u, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"Computes the partial derivative dF/dx.\"\"\"\n            x_c = np.clip(x, 0, 1)\n\n            # Denominator for the activation term derivative part\n            act_denom = Ka + u + alpha * x_c**n\n            if act_denom == 0: return 1e6\n\n            # Denominator for the deactivation term derivative part\n            deact_denom = Kd + x_c\n            if deact_denom == 0: return 1e6\n            \n            # Handle x=0 case for n1, although not relevant here (n>=2)\n            if x_c == 0 and n  1:\n                term_dAdx = 0\n            else:\n                term_dAdx = (n * alpha * Ka * x_c**(n - 1) * (1 - x_c)) / (act_denom**2)\n\n            # d(v_act)/dx\n            term_A = (u + alpha * x_c**n) / act_denom\n            d_v_act_dx = ka * (term_dAdx - term_A)\n\n            # d(v_deact)/dx\n            d_v_deact_dx = kd * Kd / (deact_denom**2)\n            \n            return d_v_act_dx - d_v_deact_dx\n\n        def bifurcation_system(vars, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"System of equations [F=0, dF/dx=0] for root finding.\"\"\"\n            x, u = vars\n            # Penalize solutions outside the valid domain\n            if not (0 = x = 1 and u >= 0):\n                return [1e6, 1e6]\n            \n            f_val = F(x, u, ka, Ka, kd, Kd, alpha, n)\n            dfdx_val = dFdx(x, u, ka, Ka, kd, Kd, alpha, n)\n            return [f_val, dfdx_val]\n\n        found_bifurcations_u = []\n        \n        # Grid search for initial guesses to find all roots\n        x_guesses = np.linspace(0.01, 0.99, 20)\n        u_guesses = np.linspace(0, u_max, 25)\n\n        for x0 in x_guesses:\n            for u0 in u_guesses:\n                initial_guess = [x0, u0]\n                sol = root(bifurcation_system, initial_guess, args=(ka, Ka, kd, Kd, alpha, n), method='hybr', tol=1e-9)\n\n                if sol.success:\n                    x_sol, u_sol = sol.x\n                    \n                    # Validate the solution\n                    if 0 = x_sol = 1 and 0 = u_sol = u_max:\n                        # Check if it's a true root\n                        residuals = bifurcation_system([x_sol, u_sol], ka, Ka, kd, Kd, alpha, n)\n                        if np.all(np.isclose(residuals, 0, atol=1e-7)):\n                            # Check for uniqueness before adding\n                            is_new = all(not np.isclose(u_sol, bf_u, atol=1e-5) for bf_u in found_bifurcations_u)\n                            if is_new:\n                                found_bifurcations_u.append(u_sol)\n        \n        # Sort and round the results for the current test case\n        rounded_bifurcations = sorted([round(u, 6) for u in found_bifurcations_u])\n        all_results.append(rounded_bifurcations)\n\n    # Format the final output string to precisely match the required format:\n    # a list of lists of floats, represented as a string with no spaces.\n    # e.g., [[0.1,0.2],[],[0.3]]\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}