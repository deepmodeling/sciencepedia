{
    "hands_on_practices": [
        {
            "introduction": "复杂的非线性模型（如 Li-Rinzel 模型）对于描述钙振荡等生物现象至关重要，但它们的数学复杂性往往阻碍了分析求解。为了获得对核心机制的深刻理解，我们可以构建一个“分段线性 caricature”，它保留了原始系统零斜线的关键几何特征。这项练习将引导您通过这种简化方法，分析计算弛豫振荡的周期，从而将快慢动力学理论应用于一个具体的生物物理问题，揭示节律行为产生的基本原理 。",
            "id": "3904781",
            "problem": "考虑一个关于1,4,5-三磷酸肌醇 ($\\text{IP}_3$) 介导的细胞内钙振荡的简化 Li–Rinzel 模型，该模型被构建为一个描述胞浆钙浓度和失活门的二维快慢系统，\n$$\n\\frac{dc}{dt} \\;=\\; F(c,h), \\qquad \\frac{dh}{dt} \\;=\\; \\epsilon\\,\\Phi(c,h),\n$$\n其中 $c$ 是无量纲化的胞浆钙浓度，$h$ 是可用（未失活）的$\\text{IP}_3$受体亚基的比例，而 $0  \\epsilon\\ll 1$ 表示时间尺度的分离。钙零斜线是集合 $\\{(c,h):F(c,h)=0\\}$，$h$-零斜线是集合 $\\{(c,h):\\Phi(c,h)=0\\}$。在表现出弛豫振荡的经典 Li–Rinzel 机制中，$c$-零斜线是类三次曲线（在 $(c,h)$-平面上呈N形曲线），具有两个折叠点，而 $h$-零斜线关于 $c$ 单调递增。你将构建一个保留了这种零斜线几何结构的分段线性简化模型，并用它根据快慢动力学的基本原理来计算振荡周期。\n\n假设 $c$-零斜线 $\\{F(c,h)=0\\}$ 的分段线性近似如下，该近似保留了位于 $h=h_{-}$ 和 $h=h_{+}$ 的两个折叠点，且 $h_{-}  h_{+}$：\n\n-   左稳定分支 $\\mathcal{L}$，其中 $h_{-} \\le h \\le h_{+}$\n-   右稳定分支 $\\mathcal{R}$，其中 $h_{-} \\le h \\le h_{+}$\n-   不稳定的中间分支，连接了这两个稳定分支。\n\n$h$-零斜线 $\\Phi(c,h)=0$ 仅与中间（不稳定）分支相交。因此，系统演化为沿这两个稳定分支交替进行的慢速运动。\n\n在慢速运动的分支上，$c$ 变量被假定为“受 $h$ 支配”，系统演化近似由慢变量方程 $\\frac{dh}{dt} = \\epsilon \\Phi(c(h),h)$ 描述。对于这个分段线性简化模型，我们假设在每个稳定分支上，这个函数 $\\Phi$ 是 $h$ 的线性函数：\n-   在左分支 $\\mathcal{L}$ 上：$\\Phi(c(h),h) = H_L - K_L h$\n-   在右分支 $\\mathcal{R}$ 上：$\\Phi(c(h),h) = H_R - K_R h$\n\n您的任务是推导并计算弛豫振荡的周期 $T$。使用以下参数值（无单位，除非另有说明）：\n-   时间尺度分离参数：$\\epsilon = 0.05$ s$^{-1}$\n-   折叠点：$h_{-} = 0.2$，$h_{+} = 0.8$\n-   左分支参数：$H_L = 0.95$，$K_L = 1$\n-   右分支参数：$H_R = 0.05$，$K_R = 1$\n\n将您的最终答案（以秒为单位）四舍五入到四位有效数字。",
            "solution": "问题要求计算 Li–Rinzel 模型分段线性简化模型中弛豫振荡的周期 $T$。该系统由以下快慢动力学描述：\n$$\n\\frac{dc}{dt} = F(c,h) \\qquad (1)\n$$\n$$\n\\frac{dh}{dt} = \\epsilon\\,\\Phi(c,h) \\qquad (2)\n$$\n其中 $c$ 是快变量，$h$ 是慢变量，时间尺度分离参数为 $0  \\epsilon \\ll 1$。\n\n振荡是 $(c,h)$-平面上的一个极限环。根据快慢动力系统的原理，这种弛豫振荡的周期主要由沿 $c$-零斜线 $\\{ (c,h) : F(c,h)=0 \\}$ 的稳定分支运动所花费的时间决定。稳定分支之间的跳跃被假定为瞬时发生，并且对总周期没有贡献。\n\n周期由两个慢阶段组成：\n1.  沿左稳定分支 $\\mathcal{L}$ 的缓慢移动，在此期间 $h$ 从 $h_{-}$ 增加到 $h_{+}$。此阶段所花费的时间为 $T_L$。\n2.  沿右稳定分支 $\\mathcal{R}$ 的缓慢移动，在此期间 $h$ 从 $h_{+}$ 减小到 $h_{-}$。此阶段所花费的时间为 $T_R$。\n\n总振荡周期是这两个慢阶段持续时间的总和：\n$$\nT = T_L + T_R\n$$\n\n我们现在将通过对慢变量 $h$ 的方程沿每个分支进行积分来计算 $T_L$ 和 $T_R$。\n\n**计算在左分支上的移动时间 ($T_L$)：**\n\n在左稳定分支 $\\mathcal{L}$ 上，$h$ 的动力学由 $\\frac{dh}{dt} = \\epsilon \\Phi(c,h)$ 给出。问题为此分支上的 $\\Phi$ 提供了一个简化形式：\n$$\n\\frac{dh}{dt} = \\epsilon (H_L - K_L h)\n$$\n其中 $h$ 从 $h(0) = h_{-}$ 演化到 $h(T_L) = h_{+}$。这是一个一阶线性常微分方程，可以通过分离变量法求解：\n$$\n\\frac{dh}{H_L - K_L h} = \\epsilon \\, dt\n$$\n我们对等式两边在该阶段的持续时间内进行积分。左边对 $h$ 从 $h_{-}$ 到 $h_{+}$ 积分，右边对 $t$ 从 $0$ 到 $T_L$ 积分：\n$$\n\\int_{h_{-}}^{h_{+}} \\frac{dh}{H_L - K_L h} = \\int_{0}^{T_L} \\epsilon \\, dt\n$$\n右侧的积分很简单：\n$$\n\\int_{0}^{T_L} \\epsilon \\, dt = \\epsilon T_L\n$$\n左侧的积分是：\n$$\n\\int \\frac{dh}{H_L - K_L h} = -\\frac{1}{K_L} \\ln|H_L - K_L h|\n$$\n计算该定积分，并注意到对于 $h \\in [h_{-}, h_{+}]=[0.2, 0.8]$，参数 $H_L - K_L h = 0.95 - h$ 为正，我们得到：\n$$\n\\left[ -\\frac{1}{K_L} \\ln(H_L - K_L h) \\right]_{h_{-}}^{h_{+}} = -\\frac{1}{K_L} \\left( \\ln(H_L - K_L h_{+}) - \\ln(H_L - K_L h_{-}) \\right) = \\frac{1}{K_L} \\ln\\left(\\frac{H_L - K_L h_{-}}{H_L - K_L h_{+}}\\right)\n$$\n令两边的结果相等，得到：\n$$\n\\epsilon T_L = \\frac{1}{K_L} \\ln\\left(\\frac{H_L - K_L h_{-}}{H_L - K_L h_{+}}\\right)\n$$\n解出 $T_L$：\n$$\nT_L = \\frac{1}{\\epsilon K_L} \\ln\\left(\\frac{H_L - K_L h_{-}}{H_L - K_L h_{+}}\\right) \\qquad (3)\n$$\n\n**计算在右分支上的移动时间 ($T_R$)：**\n\n类似地，在右稳定分支 $\\mathcal{R}$ 上，$h$ 的动力学由下式给出：\n$$\n\\frac{dh}{dt} = \\epsilon (H_R - K_R h)\n$$\n此处，$h$ 从 $h(0) = h_{+}$ 演化到 $h(T_R) = h_{-}$。我们再次分离变量并积分：\n$$\n\\int_{h_{+}}^{h_{-}} \\frac{dh}{H_R - K_R h} = \\int_{0}^{T_R} \\epsilon \\, dt = \\epsilon T_R\n$$\n对于左边的积分，我们注意到对于 $h \\in [h_{-}, h_{+}]=[0.2, 0.8]$，参数 $H_R - K_R h = 0.05 - h$ 为负。因此，$|H_R - K_R h| = -(H_R - K_R h) = K_R h - H_R$。\n$$\n\\int_{h_{+}}^{h_{-}} \\frac{dh}{H_R - K_R h} = \\left[ -\\frac{1}{K_R} \\ln(K_R h - H_R) \\right]_{h_{+}}^{h_{-}}\n$$\n$$\n= -\\frac{1}{K_R} \\left( \\ln(K_R h_{-} - H_R) - \\ln(K_R h_{+} - H_R) \\right) = \\frac{1}{K_R} \\ln\\left(\\frac{K_R h_{+} - H_R}{K_R h_{-} - H_R}\\right)\n$$\n将此结果与 $\\epsilon T_R$ 相等，得到：\n$$\nT_R = \\frac{1}{\\epsilon K_R} \\ln\\left(\\frac{K_R h_{+} - H_R}{K_R h_{-} - H_R}\\right) \\qquad (4)\n$$\n\n**计算总周期 ($T$)：**\n\n总周期为 $T = T_L + T_R$。代入表达式 (3) 和 (4)：\n$$\nT = \\frac{1}{\\epsilon K_L} \\ln\\left(\\frac{H_L - K_L h_{-}}{H_L - K_L h_{+}}\\right) + \\frac{1}{\\epsilon K_R} \\ln\\left(\\frac{K_R h_{+} - H_R}{K_R h_{-} - H_R}\\right)\n$$\n给定的参数值为：\n$\\epsilon = 0.05$ s$^{-1}$，$h_{-} = 0.2$，$h_{+} = 0.8$，$H_L = 0.95$，$K_L = 1$，$H_R = 0.05$，$K_R = 1$。\n\n将这些值代入 $T_L$ 的表达式中：\n$$\nT_L = \\frac{1}{0.05 \\times 1} \\ln\\left(\\frac{0.95 - 1 \\times 0.2}{0.95 - 1 \\times 0.8}\\right) = 20 \\ln\\left(\\frac{0.75}{0.15}\\right) = 20 \\ln(5)\n$$\n将这些值代入 $T_R$ 的表达式中：\n$$\nT_R = \\frac{1}{0.05 \\times 1} \\ln\\left(\\frac{1 \\times 0.8 - 0.05}{1 \\times 0.2 - 0.05}\\right) = 20 \\ln\\left(\\frac{0.75}{0.15}\\right) = 20 \\ln(5)\n$$\n总周期为：\n$$\nT = T_L + T_R = 20 \\ln(5) + 20 \\ln(5) = 40 \\ln(5)\n$$\n现在，我们对此表达式进行数值计算。5 的自然对数近似为 $\\ln(5) \\approx 1.6094379$。\n$$\nT = 40 \\times 1.6094379 \\ldots \\approx 64.377516 \\text{ s}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nT \\approx 64.38 \\text{ s}\n$$\n这就是在给定的分段线性模型中振荡的周期。",
            "answer": "$$\n\\boxed{64.38}\n$$"
        },
        {
            "introduction": "生物信号通路中充满了“全或无”式的阈值触发事件，这在数学上通常通过分段光滑的微分方程来建模。标准的固定步长数值积分器在处理这些非光滑系统的事件点时可能表现不佳，导致显著的时间和幅度误差。这项练习将演示实现精确“事件检测”的重要性，通过对比朴素方法和步内线性插值法，展示如何准确地模拟这类混合动态系统，并正确捕捉关键生物开关的触发时机 。",
            "id": "3904743",
            "problem": "您需要为一个胞浆钙浓度动态的分段光滑模型设计和分析阈值穿越的事件检测。考虑一个单室胞浆钙浓度 $c(t)$，其受质量守恒和通量平衡控制，其中通量被假定为集总且混合均匀。胞浆接收恒定的流入，并通过有效的线性排出失去钙，而一个阈值触发的释放项仅在胞浆钙浓度超过阈值时从内部储库中增加钙。该模型定义为\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c + H\\!\\left(c - c_{\\mathrm{th}}\\right)\\,v_{\\mathrm{rel}}\\left(c_s - c\\right),\n$$\n其中 $J_{\\mathrm{in}}$ 是恒定流入（单位：微摩尔/秒），$k_{\\mathrm{eff}}$ 是有效的一阶排出速率常数（单位：/秒），$H$ 是 Heaviside 阶跃函数，$c_{\\mathrm{th}}$ 是阈值浓度（单位：微摩尔），$v_{\\mathrm{rel}}$ 是通道打开时的比例释放速率（单位：/秒），$c_s$ 是储库钙浓度（单位：微摩尔），在感兴趣的短时间尺度上被视为常数。感兴趣的阈值事件是第一个时间 $t^\\star$，使得 $c(t^\\star) = c_{\\mathrm{th}}$ 并且是向上穿越，即对于 $t  t^\\star$ 有 $c(t)  c_{\\mathrm{th}}$，而在 $t^\\star$ 时有 $c(t) \\ge c_{\\mathrm{th}}$。\n\n在达到阈值之前，释放项不活动，动态由线性时不变常微分方程控制\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c,\n$$\n其解为\n$$\nc(t) = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t},\\quad c_{\\infty} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}},\n$$\n其中 $c_0$ 是 $t=0$ 时的初始胞浆浓度。如果发生从下方的向上穿越，则精确的阈值穿越时间 $t^\\star$ 满足\n$$\nc_{\\mathrm{th}} = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t^\\star},\n$$\n因此可以通过求解给定的容许参数来确定 $t^\\star$。\n\n您的任务是：\n1. 为事件前动态（即当 $c(t)  c_{\\mathrm{th}}$ 时）实现一个使用步长 $h$ 的固定步长显式欧拉积分器，并计算第一个离散样本时间 $t_{n+1}$，在该时间点 $c_{n+1} \\ge c_{\\mathrm{th}}$。这是没有任何步内精化的朴素事件检测。\n2. 实现一个步内事件检测，通过在阈值下的最后一个样本和等于或高于阈值的第一个样本之间进行线性插值，来精化步内的穿越时间。具体来说，如果 $c_n  c_{\\mathrm{th}} \\le c_{n+1}$，则用 $t_{\\mathrm{lin}} = t_n + \\alpha h$ 来近似穿越时间，其中 $\\alpha = \\dfrac{c_{\\mathrm{th}} - c_n}{c_{n+1} - c_n}$。\n3. 使用事件前的解析解推导并实现精确的阈值穿越时间 $t^\\star$。如果 $c_0 \\ge c_{\\mathrm{th}}$，定义 $t^\\star = 0$。如果 $c_{\\infty} \\le c_{\\mathrm{th}}$ 且 $c_0  c_{\\mathrm{th}}$，定义在有限时间内不发生穿越。\n4. 对于每个测试用例，计算三个指标：朴素时间绝对误差 $|t_{n+1} - t^\\star|$（单位：秒，四舍五入到六位小数），精化时间绝对误差 $|t_{\\mathrm{lin}} - t^\\star|$（单位：秒，四舍五入到六位小数），以及朴素过冲幅度 $c_{n+1} - c_{\\mathrm{th}}$（单位：微摩尔，四舍五入到六位小数）。如果在仿真时域内没有发生穿越，或者由于 $c_{\\infty} \\le c_{\\mathrm{th}}$ 而 $t^\\star$ 未定义，则所有三个指标输出 $0.0$。如果 $c_0 \\ge c_{\\mathrm{th}}$，则所有三个指标输出 $0.0$。\n\n基本基础和物理建模假设：\n- 在一个混合均匀的胞浆室中应用通量平衡，得出 $\\dfrac{dc}{dt}$ 等于流入和流出项的总和。\n- 事件前动态由一个稳定的线性时不变系统控制，其精确解如上所述。\n- 阈值触发的释放仅在穿越后激活，不影响事件前的轨迹。\n\n测试套件：\n使用以下五个参数集，每个参数集都使用与微摩尔（用于浓度）和秒（用于时间）一致的物理单位表示。\n- 用例 1 (一般向上穿越)：$J_{\\mathrm{in}} = 0.06$ 微摩尔/秒, $k_{\\mathrm{eff}} = 0.02$ /秒, $c_{\\mathrm{th}} = 0.4$ 微摩尔, $c_0 = 0.05$ 微摩尔, $h = 0.2$ 秒, $t_{\\mathrm{end}} = 100$ 秒, $v_{\\mathrm{rel}} = 0.5$ /秒, $c_s = 400$ 微摩尔。\n- 用例 2 (接近阈值的初始条件)：$J_{\\mathrm{in}} = 0.06$ 微摩尔/秒, $k_{\\mathrm{eff}} = 0.02$ /秒, $c_{\\mathrm{th}} = 0.4$ 微摩尔, $c_0 = 0.399$ 微摩尔, $h = 0.5$ 秒, $t_{\\mathrm{end}} = 100$ 秒, $v_{\\mathrm{rel}} = 0.5$ /秒, $c_s = 400$ 微摩尔。\n- 用例 3 (无穿越，从下方渐近于阈值)：$J_{\\mathrm{in}} = 0.008$ 微摩尔/秒, $k_{\\mathrm{eff}} = 0.02$ /秒, $c_{\\mathrm{th}} = 0.4$ 微摩尔, $c_0 = 0.05$ 微摩尔, $h = 0.2$ 秒, $t_{\\mathrm{end}} = 100$ 秒, $v_{\\mathrm{rel}} = 0.5$ /秒, $c_s = 400$ 微摩尔。\n- 用例 4 (初始在阈值上)：$J_{\\mathrm{in}} = 0.06$ 微摩尔/秒, $k_{\\mathrm{eff}} = 0.02$ /秒, $c_{\\mathrm{th}} = 0.4$ 微摩尔, $c_0 = 0.4$ 微摩尔, $h = 0.1$ 秒, $t_{\\mathrm{end}} = 100$ 秒, $v_{\\mathrm{rel}} = 0.5$ /秒, $c_s = 400$ 微摩尔。\n- 用例 5 (粗步长穿越)：$J_{\\mathrm{in}} = 0.8$ 微摩尔/秒, $k_{\\mathrm{eff}} = 0.01$ /秒, $c_{\\mathrm{th}} = 0.5$ 微摩尔, $c_0 = 0.05$ 微摩尔, $h = 1.0$ 秒, $t_{\\mathrm{end}} = 50$ 秒, $v_{\\mathrm{rel}} = 0.5$ /秒, $c_s = 400$ 微摩尔。\n\n输出规范：\n- 单位：时间误差以秒为单位报告，过冲幅度以微摩尔为单位报告。将每个报告值四舍五入到六位小数。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须恰好包含十五个数字，按用例顺序分组：$[|t_{n+1} - t^\\star|_{\\mathrm{用例\\ 1}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{用例\\ 1}}, \\mathrm{过冲}_{\\mathrm{用例\\ 1}}, |t_{n+1} - t^\\star|_{\\mathrm{用例\\ 2}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{用例\\ 2}}, \\mathrm{过冲}_{\\mathrm{用例\\ 2}}, \\ldots, |t_{n+1} - t^\\star|_{\\mathrm{用例\\ 5}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{用例\\ 5}}, \\mathrm{过冲}_{\\mathrm{用例\\ 5}}]$。",
            "solution": "我们从一个混合均匀的胞浆室中的通量平衡开始。令 $c(t)$ 表示以微摩尔为单位的胞浆游离钙浓度，并考虑流入、流出和阈值触发的释放。守恒定律规定\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c + H\\!\\left(c - c_{\\mathrm{th}}\\right)\\,v_{\\mathrm{rel}}\\left(c_s - c\\right),\n$$\n其中 $J_{\\mathrm{in}}$ 和 $k_{\\mathrm{eff}}$ 是代表净恒定流入和线性排出的常数参数。Heaviside 阶跃函数 $H(\\cdot)$ 编码了当达到阈值 $c_{\\mathrm{th}}$ 时通道的开放，引入了一个分段光滑的向量场。\n\n感兴趣的事件是第一次向上穿越 $c_{\\mathrm{th}}$。在事件发生之前，通道释放是不活动的，动态简化为线性时不变常微分方程\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c.\n$$\n这个方程有精确解\n$$\nc(t) = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t},\\quad c_{\\infty} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}},\n$$\n其中 $c_0$ 是 $t=0$ 时的初始浓度。阈值穿越时间 $t^\\star$ 由 $c(t^\\star) = c_{\\mathrm{th}}$ 且为向上穿越来定义。将精确解设为等于 $c_{\\mathrm{th}}$ 得到\n$$\nc_{\\mathrm{th}} = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t^\\star}.\n$$\n求解 $t^\\star$ 得\n$$\ne^{-k_{\\mathrm{eff}} t^\\star} = \\frac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}},\n\\quad t^\\star = -\\frac{1}{k_{\\mathrm{eff}}}\\ln\\!\\left(\\frac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}}\\right).\n$$\n对于从下方开始的向上穿越，我们需要 $c_0  c_{\\mathrm{th}}  c_{\\infty}$，这确保了分子和分母都是负数，其比值为小于1的正数，使得 $t^\\star$ 为正。如果 $c_0 \\ge c_{\\mathrm{th}}$，则根据定义，穿越时间为 $t^\\star = 0$。如果 $c_{\\infty} \\le c_{\\mathrm{th}}$ 且 $c_0  c_{\\mathrm{th}}$，那么 $c(t)$ 单调增加到 $c_{\\infty}$ 但在有限时间内永远不会达到 $c_{\\mathrm{th}}$；我们声明没有穿越发生。\n\n为了分析事件附近的时间离散化误差，我们研究了在事件前动态上使用固定步长显式欧拉方法。对于步长 $h$，定义\n$$\nc_{n+1} = c_n + h\\left(J_{\\mathrm{in}} - k_{\\mathrm{eff}} c_n\\right),\\quad t_{n+1} = t_n + h,\n$$\n其中 $c_0$ 是给定的。朴素事件检测在第一个离散时间 $t_{n+1}$ 使得 $c_{n+1} \\ge c_{\\mathrm{th}}$ 时声明穿越发生。这会产生一个时间延迟误差，因为实际的穿越通常发生在 $t_n$ 和 $t_{n+1}$ 之间。\n\n一个精化的步内事件检测通过在步内进行线性插值来改进这一点。如果 $c_n  c_{\\mathrm{th}} \\le c_{n+1}$，定义\n$$\n\\alpha = \\frac{c_{\\mathrm{th}} - c_n}{c_{n+1} - c_n},\\quad t_{\\mathrm{lin}} = t_n + \\alpha h.\n$$\n这是一个使用离散解序列上的线性插值的标准零点穿越近似。虽然事件前动态是精确的指数形式，但线性插值提供了一种易于处理的步内精化方法，通常能以适度的计算成本显著减少时间检测误差。\n\n我们为每个测试用例比较三个量：\n- 朴素时间绝对误差 $|t_{n+1} - t^\\star|$（单位：秒）。\n- 精化时间绝对误差 $|t_{\\mathrm{lin}} - t^\\star|$（单位：秒）。\n- 朴素过冲幅度 $c_{n+1} - c_{\\mathrm{th}}$（单位：微摩尔），它量化了欧拉方法在步内错过阈值的程度。\n\n计算算法：\n1. 给定参数 $(J_{\\mathrm{in}}, k_{\\mathrm{eff}}, c_{\\mathrm{th}}, c_0, h, t_{\\mathrm{end}})$，计算 $c_{\\infty} = J_{\\mathrm{in}}/k_{\\mathrm{eff}}$。\n2. 按如下方式确定 $t^\\star$：\n   - 如果 $c_0 \\ge c_{\\mathrm{th}}$，设 $t^\\star = 0$。\n   - 否则如果 $c_{\\infty} \\le c_{\\mathrm{th}}$，设 $t^\\star$ 未定义并声明无穿越；为指标输出零。\n   - 否则计算 $t^\\star = -\\dfrac{1}{k_{\\mathrm{eff}}}\\ln\\!\\left(\\dfrac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}}\\right)$。\n3. 对事件前动态执行固定步长欧拉迭代，直到检测到穿越或达到 $t_{\\mathrm{end}}$：\n   - 初始化 $t=0$, $c=c_0$。\n   - 如果 $c \\ge c_{\\mathrm{th}}$，立即为指标返回零（与 $t^\\star = 0$ 一致）。\n   - 否则，迭代 $c_{\\mathrm{new}} = c + h(J_{\\mathrm{in}} - k_{\\mathrm{eff}} c)$, $t_{\\mathrm{new}} = t + h$。如果 $c  c_{\\mathrm{th}} \\le c_{\\mathrm{new}}$，记录朴素事件时间 $t_{n+1} = t_{\\mathrm{new}}$，过冲 $c_{\\mathrm{new}} - c_{\\mathrm{th}}$，和精化事件时间 $t_{\\mathrm{lin}} = t + \\alpha h$，其中 $\\alpha = \\dfrac{c_{\\mathrm{th}} - c}{c_{\\mathrm{new}} - c}$。\n4. 计算误差 $|t_{n+1} - t^\\star|$ 和 $|t_{\\mathrm{lin}} - t^\\star|$。如果在步内未找到穿越且 $t^\\star$ 未定义或超出 $t_{\\mathrm{end}}$，则输出零。\n\n科学现实性：\n- 参数在微摩尔浓度和每秒速率的物理上合理的范围内。\n- 阈值触发项在穿越前不活动，不影响事件前动态，确保精确的 $t^\\star$ 公式适用。\n- 事件处理在步内使用线性插值，这是一种经过充分检验的数值实践。\n\n该程序实现了上述算法，评估了五个指定的测试用例，将每个报告的指标四舍五入到六位小数，并打印一个包含十五个逗号分隔数字的方括号列表，这些数字对应于指定顺序的指标。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef exact_cross_time(c0, Jin, keff, cth):\n    \"\"\"\n    Compute the exact upward threshold crossing time for the pre-event dynamics:\n        dc/dt = Jin - keff * c\n    Returns:\n        t_star (float) if crossing occurs,\n        0.0 if c0 >= cth (event at t=0),\n        None if no crossing occurs in finite time (c_infty = cth and c0  cth).\n    \"\"\"\n    c_inf = Jin / keff\n    if c0 >= cth:\n        return 0.0\n    if c_inf = cth:\n        return None\n    \n    num = cth - c_inf\n    den = c0 - c_inf\n    \n    # For a valid upward crossing from below, we need c0  cth  c_inf.\n    # This ensures den  0 and num  0, so ratio > 0.\n    ratio = num / den\n    if ratio = 0:\n        return None\n        \n    return -(1.0 / keff) * np.log(ratio)\n\ndef simulate_naive_and_linear(c0, Jin, keff, cth, h, t_end):\n    \"\"\"\n    Simulate pre-event dynamics using fixed-step explicit Euler until crossing.\n    Returns:\n        t_naive: naive event time (first sample at/above threshold), or None if not found.\n        t_linear: in-step linear interpolation event time, or None if not found.\n        overshoot: c_{n+1} - cth (>=0 when crossing), or 0.0 if not found.\n    Edge cases:\n        If c0 >= cth, return (0.0, 0.0, 0.0).\n    \"\"\"\n    t = 0.0\n    c = float(c0)\n    if c >= cth:\n        return 0.0, 0.0, 0.0\n\n    n_steps = int(np.ceil(t_end / h))\n    for _ in range(n_steps):\n        # Pre-event Euler step (release term is inactive before crossing)\n        c_new = c + h * (Jin - keff * c)\n        t_new = t + h\n\n        if c  cth = c_new:\n            # Crossing occurred within this step\n            t_naive = t_new\n            # Linear interpolation fraction within the step\n            delta = c_new - c\n            if delta == 0.0:\n                alpha = 0.0\n            else:\n                alpha = (cth - c) / delta\n                # Clamp alpha to [0,1] for numerical safety\n                alpha = max(0.0, min(1.0, alpha))\n            t_linear = t + alpha * h\n            overshoot = c_new - cth\n            return t_naive, t_linear, overshoot\n\n        # Advance\n        t, c = t_new, c_new\n\n    # No crossing detected within t_end\n    return None, None, 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (J_in, k_eff, c_th, c0, h, t_end, v_rel, c_s)\n    test_cases = [\n        (0.06, 0.02, 0.4, 0.05, 0.2, 100.0, 0.5, 400.0),  # Case 1\n        (0.06, 0.02, 0.4, 0.399, 0.5, 100.0, 0.5, 400.0), # Case 2\n        (0.008, 0.02, 0.4, 0.05, 0.2, 100.0, 0.5, 400.0), # Case 3\n        (0.06, 0.02, 0.4, 0.4, 0.1, 100.0, 0.5, 400.0),   # Case 4\n        (0.8, 0.01, 0.5, 0.05, 1.0, 50.0, 0.5, 400.0),    # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        Jin, keff, cth, c0, h, t_end, v_rel, c_s = case\n\n        # Exact crossing time from analytical pre-threshold solution\n        t_star = exact_cross_time(c0, Jin, keff, cth)\n\n        # Naive and linear event detection on discrete Euler stepping\n        t_naive, t_linear, overshoot = simulate_naive_and_linear(c0, Jin, keff, cth, h, t_end)\n\n        # Compute errors based on rules\n        if t_star is None:\n            # No crossing in finite time: output zeros\n            naive_err = 0.0\n            linear_err = 0.0\n            overshoot_val = 0.0\n        else:\n            # If crossing exists (including t_star == 0)\n            if t_naive is None:\n                # No crossing detected within t_end despite t_star defined; treat as zeros\n                naive_err = 0.0\n                linear_err = 0.0\n                overshoot_val = 0.0\n            else:\n                naive_err = abs(t_naive - t_star)\n                linear_err = abs(t_linear - t_star) if t_linear is not None else abs(t_naive - t_star)\n                overshoot_val = max(0.0, overshoot)\n\n        # Round to six decimal places\n        naive_err = round(naive_err, 6)\n        linear_err = round(linear_err, 6)\n        overshoot_val = round(overshoot_val, 6)\n\n        results.extend([naive_err, linear_err, overshoot_val])\n\n    # Format output: single line, bracketed, comma-separated, no spaces.\n    # Ensure six decimal places formatting for consistency.\n    formatted = \"[\" + \",\".join(f\"{x:.6f}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        },
        {
            "introduction": "将钙动力学模型从单室模型扩展到空间域，需要使用反应-扩散偏微分方程（PDEs）进行描述，这对于研究钙波等时空现象至关重要。然而，用于求解这些方程的显式数值格式只有在满足特定稳定性条件时才是可靠的，该条件关联了时间步长、空间网格间距、扩散系数和反应速率。通过执行冯·诺依曼稳定性分析，本练习旨在推导出一个缓冲钙扩散模型的稳定性约束条件，这是开发稳定高效的细胞内钙信号时空模拟所必备的一项关键技能 。",
            "id": "3904753",
            "problem": "考虑由单位点固定缓冲剂缓冲的胞浆钙。令 $c(\\mathbf{x},t)$ 表示游离钙浓度，$b(\\mathbf{x},t)$ 表示结合缓冲剂浓度。游离缓冲剂为 $f(\\mathbf{x},t) = B_T - b(\\mathbf{x},t)$，其中 $B_T$ 是空间均匀的总缓冲剂浓度。钙以扩散系数 $D_c$ 扩散，而缓冲剂是固定的。结合反应遵循质量作用动力学，其正向速率常数为 $k_{\\mathrm{on}}$，逆向速率常数为 $k_{\\mathrm{off}}$。控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial c}{\\partial t} = D_c \\nabla^2 c - k_{\\mathrm{on}}\\,c\\,f + k_{\\mathrm{off}}\\,b,\\qquad\n\\frac{\\partial b}{\\partial t} = k_{\\mathrm{on}}\\,c\\,f - k_{\\mathrm{off}}\\,b,\n$$\n其中 $f = B_T - b$。假设存在一个空间均匀稳态 $(c^\\ast,b^\\ast)$，且有 $f^\\ast = B_T - b^\\ast$。\n\n在间距为 $\\Delta x_1,\\dots,\\Delta x_d$ 的 $d$ 维笛卡尔网格上使用二阶中心差分拉普拉斯算子对空间进行离散化，并使用步长为 $\\Delta t$ 的前向欧拉 (FE) 方法对时间进行离散化。您可以假设域是周期性的或足够大，以便对内部点进行线性稳定性的傅里叶模态分析是合理的。\n\n从基本建模原理（菲克扩散定律和质量作用动力学）出发，将反应项在 $(c^\\ast,b^\\ast)$ 附近线性化，将“最快反应速率”$k_{\\mathrm{fast}}$ 定义为在 $(c^\\ast,b^\\ast)$ 处求值的局部 $2\\times 2$ 反应雅可比矩阵的最负特征值的绝对值，并用 $k_{\\mathrm{on}}$、$k_{\\mathrm{off}}$、$c^\\ast$ 和 $f^\\ast$ 显式计算 $k_{\\mathrm{fast}}$。\n\n然后，通过分析空间傅里叶模态的线性化前向欧拉更新，并仅使用离散拉普拉斯谱的性质，为显式格式推导一个充分的稳定性约束，以确保对所有空间模态的线性稳定性。将最大允许时间步长 $\\Delta t_{\\max}$ 表示为 $k_{\\mathrm{fast}}$、$D_c$、$d$ 和网格间距 $\\Delta x_1,\\dots,\\Delta x_d$ 的单个闭式解析表达式。给出 $\\Delta t_{\\max}$ 的最终表达式（最终表达式中无需单位）。无需进行数值计算。",
            "solution": "我们首先通过线性化反应动力学来确定最快反应速率 $k_{\\mathrm{fast}}$。反应系统为：\n$$\n\\frac{dc}{dt} = -k_{\\mathrm{on}}c(B_T - b) + k_{\\mathrm{off}}b\n$$\n$$\n\\frac{db}{dt} = k_{\\mathrm{on}}c(B_T - b) - k_{\\mathrm{off}}b\n$$\n在稳态 $(c^\\ast, b^\\ast)$ 处，其中 $f^\\ast = B_T - b^\\ast$，反应雅可比矩阵 $J_R$ 为：\n$$\nJ_R^\\ast = \\begin{pmatrix} -k_{\\mathrm{on}}f^\\ast  k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f^\\ast  -(k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}}) \\end{pmatrix}\n$$\n该矩阵的特征值为 $\\lambda_1 = 0$（反映了总钙守恒）和 $\\lambda_2 = -(k_{\\mathrm{on}}(c^\\ast + f^\\ast) + k_{\\mathrm{off}})$。最负特征值的绝对值，即最快反应速率，为：\n$$\nk_{\\mathrm{fast}} = |\\lambda_2| = k_{\\mathrm{on}}(c^\\ast + f^\\ast) + k_{\\mathrm{off}}\n$$\n\n接下来，我们为前向欧拉/中心差分格式推导稳定性约束。线性化的、空间离散的系统可以为每个傅里叶模态 $\\mathbf{k}$ 写作：\n$$\n\\frac{d}{dt}\\hat{\\mathbf{u}}_\\mathbf{k} = M_{\\mathbf{k},h} \\hat{\\mathbf{u}}_\\mathbf{k}\n$$\n其中 $\\hat{\\mathbf{u}}_\\mathbf{k}$ 是模态振幅向量，系统矩阵为：\n$$\nM_{\\mathbf{k},h} = \\begin{pmatrix} D_c \\Lambda_\\mathbf{k}  0 \\\\ 0  0 \\end{pmatrix} + J_R^\\ast = \\begin{pmatrix} D_c \\Lambda_\\mathbf{k} - k_{\\mathrm{on}}f^\\ast  k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f^\\ast  -(k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}}) \\end{pmatrix}\n$$\n这里，$\\Lambda_\\mathbf{k}$ 是离散拉普拉斯算子对模态 $\\mathbf{k}$ 的特征值。前向欧拉格式是稳定的，如果对所有模态 $\\mathbf{k}$，矩阵 $I + \\Delta t M_{\\mathbf{k},h}$ 的谱半径 $\\rho(I + \\Delta t M_{\\mathbf{k},h}) \\le 1$。\n对于具有实数、非正特征值的系统，这等价于 $\\Delta t \\le 2 / \\rho(-M_{\\mathbf{k},h})$。一个更通用的充分条件可以通过使用矩阵范数来获得。谱半径由任何诱导范数界定，$\\rho(A) \\le \\|A\\|$。我们使用无穷范数（最大绝对行和）：\n$$\n\\rho(-M_{\\mathbf{k},h}) \\le \\|-M_{\\mathbf{k},h}\\|_\\infty = \\|M_{\\mathbf{k},h}\\|_\\infty\n$$\n$M_{\\mathbf{k},h}$ 的绝对行和为：\n$$\nS_1 = |-D_c\\Lambda_\\mathbf{k} + k_{\\mathrm{on}}f^\\ast| + |-(k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}})| = -D_c\\Lambda_\\mathbf{k} + k_{\\mathrm{on}}f^\\ast + k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}} = -D_c\\Lambda_\\mathbf{k} + k_{\\mathrm{fast}}\n$$\n$$\nS_2 = |-k_{\\mathrm{on}}f^\\ast| + |k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}}| = k_{\\mathrm{on}}f^\\ast + k_{\\mathrm{on}}c^\\ast + k_{\\mathrm{off}} = k_{\\mathrm{fast}}\n$$\n由于离散拉普拉斯算子的特征值 $\\Lambda_\\mathbf{k} \\le 0$，我们有 $-D_c\\Lambda_\\mathbf{k} \\ge 0$。因此，$\\|M_{\\mathbf{k},h}\\|_\\infty = \\max(S_1, S_2) = -D_c\\Lambda_\\mathbf{k} + k_{\\mathrm{fast}}$。\n\n为了保证对所有模态的稳定性，我们必须考虑这个范数在所有 $\\mathbf{k}$ 上的最大值：\n$$\n\\max_{\\mathbf{k}} \\|M_{\\mathbf{k},h}\\|_\\infty = \\max_{\\mathbf{k}}(-D_c\\Lambda_\\mathbf{k} + k_{\\mathrm{fast}}) = D_c \\max_{\\mathbf{k}}(-\\Lambda_\\mathbf{k}) + k_{\\mathrm{fast}}\n$$\n离散拉普拉斯算子特征值的最大绝对值对应于最高频率的模态：\n$$\n\\max_{\\mathbf{k}}(-\\Lambda_\\mathbf{k}) = \\max_{\\mathbf{k}} \\sum_{j=1}^{d} \\frac{4}{(\\Delta x_j)^2} \\sin^2\\left(\\frac{k_j \\Delta x_j}{2}\\right) = \\sum_{j=1}^{d} \\frac{4}{(\\Delta x_j)^2} = 4 \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}\n$$\n将此代入稳定性条件 $\\Delta t \\cdot \\max_{\\mathbf{k}} \\|M_{\\mathbf{k},h}\\|_\\infty \\le 2$，得到：\n$$\n\\Delta t \\left( D_c \\left(4 \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}\\right) + k_{\\mathrm{fast}} \\right) \\le 2\n$$\n求解 $\\Delta t$，我们得到最大允许时间步长的充分条件：\n$$\n\\Delta t_{\\max} = \\frac{2}{k_{\\mathrm{fast}} + 4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}}\n$$",
            "answer": "$$\\boxed{\\frac{2}{k_{\\mathrm{fast}} + 4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}}}$$"
        }
    ]
}