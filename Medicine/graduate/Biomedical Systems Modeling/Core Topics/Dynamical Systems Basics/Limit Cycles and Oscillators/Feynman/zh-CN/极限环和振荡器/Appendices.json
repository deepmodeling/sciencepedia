{
    "hands_on_practices": [
        {
            "introduction": "生物系统中的节律现象，如心跳或昼夜节律，必须在充满噪声和参数波动的环境中稳定运行。这个练习通过对比一个真正的极限环振荡器和一个理想化的线性中心，揭示了“结构稳定性”这一关键概念的重要性。通过分析这两种原型振荡器对微小扰动的不同响应，你将深刻理解为何极限环是模拟稳健生物节律的首选数学模型。",
            "id": "3896249",
            "problem": "在生物医学系统建模中，常使用振荡生化网络的平面简化模型来分析节律的定性行为，例如糖酵解振荡或膜电位发放。考虑两个捕获了形成对比的振荡器原型的平面常微分方程 (ODE) 模型。\n\nL 模型（径向等时钟）：在极坐标下，令\n$$\n\\dot r = r\\left(\\alpha - r^2\\right), \\qquad \\dot \\theta = \\omega,\n$$\n其中常数 $\\alpha0$ 且 $\\omega0$。这可以看作是具有半径依赖增益饱和的自持生化振荡器的范式。\n\nC 模型（无损线性中心）：在笛卡尔坐标下，令\n$$\n\\dot x = -\\omega y, \\qquad \\dot y = \\omega x,\n$$\n其中常数 $\\omega0$。这可以看作是耦合生化物质在平衡点附近的理想化、能量守恒的线性化模型。\n\n两个模型中都存在闭合轨迹。使用周期轨道、极限环（孤立周期轨道）、线性化与稳定性以及关于矢量场的小光滑扰动的结构稳定性的基本定义，确定哪些陈述是正确的。您可以根据需要使用极坐标变换 $x=r\\cos\\theta$，$y=r\\sin\\theta$。除非另有说明，假设提到的所有扰动都是 $C^1$-小的。\n\n选择所有适用项：\n\nA. 在 L 模型中，在 $r=\\sqrt{\\alpha}$ 处存在一个唯一的周期轨道，它是一个孤立的、渐近稳定的双曲极限环，并且在矢量场的足够小的光滑扰动下它仍然存在。\n\nB. 在 C 模型中，对于每个 $r0$ 都存在闭合轨迹，但它们不是孤立的；一般而言，矢量场的一个任意小的耗散扰动会通过将中心点转化为焦点来破坏所有非平凡的周期轨道，因此振荡不具有鲁棒性。\n\nC. 在 C 模型中，添加弱线性阻尼，\n$$\n\\dot x = -\\omega y - \\epsilon x,\\qquad \\dot y = \\omega x - \\epsilon y,\\qquad \\epsilon0,\n$$\n会产生一族振幅缓慢衰减的闭合轨迹；因此周期轨道持续存在但是是弱稳定的。\n\nD. 在 L 模型中，如果仅将角动力学扰动为\n$$\n\\dot r = r\\left(\\alpha - r^2\\right),\\qquad \\dot \\theta = \\omega + \\epsilon h(r,\\theta),\n$$\n其中 $\\epsilon$ 足够小且 $h$ 光滑，那么即使径向方程没有改变，$r=\\sqrt{\\alpha}$ 周期轨道的渐近轨道稳定性也会被破坏。\n\nE. 在 C 模型中，函数 $H(x,y)=\\tfrac{1}{2}(x^2+y^2)$ 是守恒的；在保持哈密顿量在原点的非退化最小值的小哈密顿扰动的受限类中，一参数族的邻近闭合轨道作为受扰动哈密顿量的等值集而持续存在，因此在该保守类中振荡是鲁棒的，尽管它们在一般情况下不具有鲁棒性。",
            "solution": "问题陈述是有效的。它展示了两个来自常微分方程理论的定义明确的经典平面振荡器模型，并要求基于周期轨道、极限环和稳定性等基本的、公认的概念进行分析。这些模型在科学上和数学上都是合理的，并且问题是自洽且明确的。\n\n我们将首先分析每个模型，然后评估给定的选项。\n\n**L 模型的分析**\n\n系统在极坐标 $(r, \\theta)$ 下给出为：\n$$\n\\dot r = r\\left(\\alpha - r^2\\right)\n$$\n$$\n\\dot \\theta = \\omega\n$$\n其中常数 $\\alpha  0$ 且 $\\omega  0$。\n\n径向动力学方程 $\\dot r = r(\\alpha - r^2)$ 可以作为 $r \\ge 0$ 的一维系统进行分析。通过令 $\\dot r = 0$ 来找到不动点，得到 $r=0$ 或 $\\alpha - r^2 = 0$。由于 $r \\ge 0$ 且 $\\alpha > 0$，不动点为 $r=0$ 和 $r=\\sqrt{\\alpha}$。\n\n这些不动点对于径向动力学的稳定性由 $\\dot r$ 的符号决定：\n- 对于 $0  r  \\sqrt{\\alpha}$，我们有 $r^2  \\alpha$，因此 $\\dot r = r(\\alpha - r^2) > 0$。半径 $r$ 增加。\n- 对于 $r > \\sqrt{\\alpha}$，我们有 $r^2 > \\alpha$，因此 $\\dot r = r(\\alpha - r^2)  0$。半径 $r$ 减小。\n\n这表明对于径向动力学，$r=\\sqrt{\\alpha}$ 是一个稳定不动点，而 $r=0$ 是一个不稳定不动点。\n在完整的二维系统中：\n- 当 $r(t) = \\sqrt{\\alpha}$ 时，我们有 $\\dot r = 0$。角动力学为 $\\dot \\theta = \\omega$，积分得到 $\\theta(t) = \\theta_0 + \\omega t$。这描述了一个半径为 $\\sqrt{\\alpha}$、周期为 $T = 2\\pi/\\omega$ 的圆形轨迹。这是一个周期轨道。\n- 由于所有初始半径 $r_0 \\in (0, \\infty)$ 且 $r_0 \\neq \\sqrt{\\alpha}$ 的轨迹在 $t \\to \\infty$ 时都收敛到圆 $r=\\sqrt{\\alpha}$，因此这个周期轨道是渐近稳定的。\n- 极限环是一个孤立的周期轨道。在这个系统中，唯一的周期轨道（除了原点的平凡不动点）是圆 $r=\\sqrt{\\alpha}$。因此，它是一个孤立的周期轨道，根据定义，它是一个极限环。\n- 如果一个极限环的 Floquet 乘子不在单位圆上（除了那个恒为 1 的乘子），那么它就是双曲的。极限环在横截于轨道方向上的稳定性由径向动力学在 $r=\\sqrt{\\alpha}$ 附近的线性化决定。令 $f(r) = r(\\alpha-r^2)$。那么 $f'(r) = \\alpha - 3r^2$。在极限环处，$f'(\\sqrt{\\alpha}) = \\alpha - 3\\alpha = -2\\alpha$。由于 $-2\\alpha  0$，该环是强吸引的。这对应于一个 Floquet 乘子 $e^{-2\\alpha T} \\in (0,1)$，它不在单位圆上。因此，该极限环是双曲的。\n- 双曲极限环是结构稳定的。它们在矢量场的小的光滑扰动下仍然存在。\n\n**C 模型的分析**\n\n系统在笛卡尔坐标 $(x, y)$ 下给出为：\n$$\n\\dot x = -\\omega y\n$$\n$$\n\\dot y = \\omega x\n$$\n其中 $\\omega  0$。这是一个线性系统。为了分析其轨迹，我们可以使用 $x=r\\cos\\theta$ 和 $y=r\\sin\\theta$ 转换到极坐标。由此，我们有 $r^2 = x^2+y^2$。对时间求导：\n$$\n2r\\dot r = 2x\\dot x + 2y\\dot y \\implies r\\dot r = x(-\\omega y) + y(\\omega x) = 0\n$$\n对于 $r\\neq 0$，这意味着 $\\dot r = 0$。任何轨迹的半径都是恒定的。\n对 $\\tan\\theta = y/x$ 关于时间求导：\n$$\n(\\sec^2\\theta)\\dot\\theta = \\frac{x\\dot y - y\\dot x}{x^2} = \\frac{x(\\omega x) - y(-\\omega y)}{x^2} = \\frac{\\omega(x^2+y^2)}{x^2} = \\frac{\\omega r^2}{r^2\\cos^2\\theta} = \\omega \\sec^2\\theta\n$$\n这意味着 $\\dot\\theta = \\omega$。因此，在极坐标下，C 模型为 $\\dot r=0$，$\\dot\\theta=\\omega$。\n- 对于任何初始条件 $(x_0, y_0) \\neq (0,0)$，其初始半径为 $r_0 = \\sqrt{x_0^2+y_0^2}$，其轨迹是一个半径为 $r_0$ 的圆，并以恒定角速度 $\\omega$ 遍历。\n- 这意味着存在一个连续的周期轨道族，每个半径 $r_0 > 0$ 对应一个。\n- 这些周期轨道不是孤立的，所以它们不是极限环。\n- 这些轨道是中性稳定的（或 Lyapunov 稳定的）：一个小的扰动将系统移动到邻近的轨道上，并且系统会停留在那里。\n- 这种被称为中心点的系统不是结构稳定的。一个一般的小扰动将破坏整个周期轨道族。\n\n我们现在评估每个选项。\n\n**A. 在 L 模型中，在 $r=\\sqrt{\\alpha}$ 处存在一个唯一的周期轨道，它是一个孤立的、渐近稳定的双曲极限环，并且在矢量场的足够小的光滑扰动下它仍然存在。**\n我们对 L 模型的分析证实了这一陈述的每一部分。在 $r=\\sqrt{\\alpha}$ 处存在一个唯一的、非平凡的周期轨道。它是孤立的，因为它是唯一的。它是渐近稳定的，因为所有邻近的轨迹都收敛于它。它是双曲的，因为横截特征值非零（为 $-2\\alpha$）。作为一个双曲极限环，它是结构稳定的，并在小的光滑扰动下持续存在。\n**结论：正确**\n\n**B. 在 C 模型中，对于每个 $r>0$ 都存在闭合轨迹，但它们不是孤立的；一般而言，矢量场的一个任意小的耗散扰动会通过将中心点转化为焦点来破坏所有非平凡的周期轨道，因此振荡不具有鲁棒性。**\n我们对 C 模型的分析表明，对于每个初始半径 $r_0 > 0$，都存在一个周期轨道（一个圆）。这是一个轨道的连续体，所以它们不是孤立的。一个耗散扰动，例如对于小的 $\\epsilon > 0$ 的线性阻尼 $\\dot{x} = -\\omega y - \\epsilon x, \\dot{y} = \\omega x - \\epsilon y$，会改变径向动力学。我们计算 $r\\dot{r} = x\\dot{x} + y\\dot{y} = x(-\\omega y - \\epsilon x) + y(\\omega x - \\epsilon y) = -\\epsilon(x^2+y^2) = -\\epsilon r^2$，这意味着 $\\dot{r} = -\\epsilon r$。对于任何 $r_0 > 0$，半径都呈指数衰减，$r(t) = r_0 e^{-\\epsilon t}$。所有轨迹都螺旋进入原点，原点成为一个稳定的焦点。没有非平凡的周期轨道留下。这证明了中心点振荡的脆弱性（缺乏鲁棒性）。\n**结论：正确**\n\n**C. 在 C 模型中，添加弱线性阻尼，$\\dot x = -\\omega y - \\epsilon x,\\qquad \\dot y = \\omega x - \\epsilon y,\\qquad \\epsilon>0$，会产生一族振幅缓慢衰减的闭合轨迹；因此周期轨道持续存在但是是弱稳定的。**\n这个陈述是自相矛盾的。一个振幅衰减的轨迹不可能是闭合轨迹（周期轨道），根据定义，闭合轨迹必须返回其起始状态。如选项 B 的分析所示，这种扰动导致 $\\dot r = -\\epsilon r$。对于任何从 $r(0) > 0$ 开始的解，半径都是严格递减的。因此，对于 $r>0$ 不存在周期轨道。陈述“周期轨道持续存在”是错误的。系统的轨迹是螺旋线，而不是闭合轨道。\n**结论：错误**\n\n**D. 在 L 模型中，如果仅将角动力学扰动为 $\\dot r = r\\left(\\alpha - r^2\\right),\\qquad \\dot \\theta = \\omega + \\epsilon h(r,\\theta)$，其中 $\\epsilon$ 足够小且 $h$ 光滑，那么即使径向方程没有改变，$r=\\sqrt{\\alpha}$ 周期轨道的渐近轨道稳定性也会被破坏。**\n$r=\\sqrt{\\alpha}$ 处极限环的渐近轨道稳定性是由该圆附近的轨迹行为决定的。径向动力学 $\\dot r = r(\\alpha-r^2)$ 是轨迹被吸引到该圆的唯一原因。由于该方程未改变，任何从半径 $r_0 \\neq \\sqrt{\\alpha}$ 开始的轨迹，其半径仍将收敛到 $\\sqrt{\\alpha}$。$\\dot\\theta$ 的扰动只改变了沿轨迹行进的速度，但不影响它们趋近圆 $r=\\sqrt{\\alpha}$ 的趋势。因此，渐近轨道稳定性得以保持。\n**结论：错误**\n\n**E. 在 C 模型中，函数 $H(x,y)=\\tfrac{1}{2}(x^2+y^2)$ 是守恒的；在保持哈密顿量在原点的非退化最小值的小哈密顿扰动的受限类中，一参数族的邻近闭合轨道作为受扰动哈密顿量的等值集而持续存在，因此在该保守类中振荡是鲁棒的，尽管它们在一般情况下不具有鲁棒性。**\n对于 C 模型，我们可以检查 $H(x,y) = \\frac{1}{2}(x^2+y^2)$ 的时间导数：$\\frac{dH}{dt} = x\\dot x + y\\dot y = x(-\\omega y) + y(\\omega x) = 0$。所以 $H$ 是一个守恒量。该系统是哈密顿系统，其哈密顿量为 $\\mathcal{H}(x,y) = \\frac{\\omega}{2}(x^2+y^2)$，因为 $\\dot x = -\\frac{\\partial \\mathcal{H}}{\\partial y}$ 和 $\\dot y = \\frac{\\partial \\mathcal{H}}{\\partial x}$ 并不完全正确。一个正确的哈密顿量是 $\\mathcal{H}(x,y) = \\frac{\\omega}{2}(x^2+y^2)$，导致 $\\dot x = \\frac{\\partial \\mathcal{H}}{\\partial y} = \\omega y$，$\\dot y = -\\frac{\\partial \\mathcal{H}}{\\partial x} = -\\omega x$。这是一个旋转方向相反的中心点。我们使用给定的矢量场。对于 $\\dot x = -\\omega y, \\dot y = \\omega x$，一个哈密顿量是 $\\mathcal{H}(x,y) = \\frac{\\omega}{2}(x^2+y^2)$，但是具有非正则结构矩阵 $J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。更简单地说，如果我们令 $\\mathcal{H}(x,y) = \\frac{\\omega}{2}(x^2+y^2)$，那么 $\\dot x = -\\omega y = -\\frac{\\partial\\mathcal{H}}{\\partial y}$ 和 $\\dot y = \\omega x = \\frac{\\partial\\mathcal{H}}{\\partial x}$，这对应于泊松括号力学，那么该系统在标准意义上是哈密顿系统。然而，关键点在于它是一个保守系统，其轨迹是能量函数 $H(x,y) = \\text{const}$ 的等值集。函数 $H(x,y)=\\tfrac{1}{2}(x^2+y^2)$ 在原点有一个非退化最小值。一个保持系统哈密顿性的小扰动，即对于一个受扰动的哈密顿量 $\\mathcal{H}_{pert}$，其形式为 $\\dot{\\mathbf{x}} = J\\nabla \\mathcal{H}_{pert}$，其轨迹仍将局限于 $\\mathcal{H}_{pert}$ 的等值集。如果 $\\mathcal{H}_{pert}$ 在原点保留一个非退化最小值，其在原点附近的等值集将是一族闭合曲线。这些就是持续存在的周期轨道。因此，在哈密顿扰动类中振荡确实是鲁棒的，这是与一般的、非哈密顿扰动的一个关键区别。\n**结论：正确**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "在理解了极限环为何对生物系统至关重要之后，我们接着探索它们是如何在数学模型中产生的。这个练习将指导你完成一次霍普夫分岔（Hopf bifurcation）分析，这是动力系统中的一项基本技术。通过对一个典型的昼夜节律基因网络模型进行线性化，你将亲手计算出系统从一个稳定的静止状态转变为稳定振荡状态的关键参数阈值，从而见证一个极限环的诞生。",
            "id": "3896223",
            "problem": "考虑一个最小的三阶段昼夜节律基因网络模型，该模型包含一个从蛋白质到其自身mRNA的单负转录反馈，由以下动力学系统表示\n$$\n\\frac{dM}{dt} \\;=\\; \\Phi(P) \\;-\\; \\delta_{m}\\,M,\\qquad\n\\frac{dX}{dt} \\;=\\; \\beta_{1}\\,M \\;-\\; \\delta_{x}\\,X,\\qquad\n\\frac{dP}{dt} \\;=\\; \\beta_{2}\\,X \\;-\\; \\delta_{p}\\,P,\n$$\n其中 $M$、$X$ 和 $P$ 分别表示信使核糖核酸（mRNA）、一种中间蛋白质和活性蛋白质的无量纲浓度；$\\delta_{m}$、$\\delta_{x}$ 和 $\\delta_{p}$ 是正的一阶降解率；$\\beta_{1}$、$\\beta_{2}$ 是正的产物增益。抑制函数 $\\Phi(P)$ 是关于 $P$ 的光滑严格递减函数。令 $(M^{\\ast},X^{\\ast},P^{\\ast})$ 为一个稳态。将在稳态处的局部抑制斜率大小定义为\n$$\nk \\;\\equiv\\; -\\left.\\frac{\\partial \\Phi}{\\partial P}\\right|_{P^{\\ast}},\n$$\n该值可以通过启动子工程进行实验性调整，同时保持 $\\delta_{m}$、$\\delta_{x}$、$\\delta_{p}$、$\\beta_{1}$ 和 $\\beta_{2}$ 不变。\n\n从线性化、雅可比矩阵以及由 $\\det(\\lambda I - J)=0$ 得到的特征多项式的定义出发，确定在稳态处，一对共轭复特征值穿过虚轴时的临界值 $k_{\\mathrm{crit}}$，并计算初始振荡时对应的微幅振荡角频率 $\\omega_{0}$。您必须通过代入纯虚特征值并分离实部和虚部，从第一性原理推导出您的条件。\n\n使用以下参数值，这些值在昼夜节律时间尺度上是生理学上合理的：\n$$\n\\delta_{m} = 0.30\\ \\mathrm{h}^{-1},\\quad\n\\delta_{x} = 0.20\\ \\mathrm{h}^{-1},\\quad\n\\delta_{p} = 0.10\\ \\mathrm{h}^{-1},\\quad\n\\beta_{1} = 1.50\\ \\mathrm{h}^{-1},\\quad\n\\beta_{2} = 0.80\\ \\mathrm{h}^{-1}.\n$$\n\n以数对 $[\\,k_{\\mathrm{crit}},\\ \\omega_{0}\\,]$ 的形式报告您的最终结果。$k_{\\mathrm{crit}}$ 以 $\\mathrm{h}^{-1}$ 为单位，$\\omega_{0}$ 以弧度/小时为单位。将两个值四舍五入到三位有效数字。最终答案必须是指定形式的 $1 \\times 2$ 矩阵形式的单行向量。",
            "solution": "该问题陈述具有科学依据，提法恰当，客观，并为获得唯一解提供了所有必要信息。这是一个生物学中动力学系统分析的标准问题，具体研究通过霍普夫分岔（Hopf bifurcation）引发的振荡起始。因此，该问题被认为是有效的。\n\n该动力学系统由以下三个常微分方程组给出：\n$$\n\\frac{dM}{dt} \\;=\\; \\Phi(P) \\;-\\; \\delta_{m}\\,M\n$$\n$$\n\\frac{dX}{dt} \\;=\\; \\beta_{1}\\,M \\;-\\; \\delta_{x}\\,X\n$$\n$$\n\\frac{dP}{dt} \\;=\\; \\beta_{2}\\,X \\;-\\; \\delta_{p}\\,P\n$$\n其中 $M$、$X$ 和 $P$ 是状态变量，$\\delta_{m}$、$\\delta_{x}$、$\\delta_{p}$、$\\beta_{1}$、$\\beta_{2}$ 是正常数。函数 $\\Phi(P)$ 是一个光滑、严格递减的抑制函数。\n\n为了确定稳态 $(M^{\\ast},X^{\\ast},P^{\\ast})$ 的稳定性，我们在此点附近对系统进行线性化。局部动力学由雅可比矩阵 $J$ 描述，其元素是微分方程右侧函数在稳态处求值的偏导数。\n设系统为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y})$，其中 $\\mathbf{y} = (M, X, P)^T$。雅可比矩阵为 $J_{ij} = \\frac{\\partial F_i}{\\partial y_j}\\Big|_{\\mathbf{y}^{\\ast}}$。\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial}{\\partial M}(\\Phi(P) - \\delta_{m}M)  \\frac{\\partial}{\\partial X}(\\Phi(P) - \\delta_{m}M)  \\frac{\\partial}{\\partial P}(\\Phi(P) - \\delta_{m}M) \\\\\n\\frac{\\partial}{\\partial M}(\\beta_{1}M - \\delta_{x}X)  \\frac{\\partial}{\\partial X}(\\beta_{1}M - \\delta_{x}X)  \\frac{\\partial}{\\partial P}(\\beta_{1}M - \\delta_{x}X) \\\\\n\\frac{\\partial}{\\partial M}(\\beta_{2}X - \\delta_{p}P)  \\frac{\\partial}{\\partial X}(\\beta_{2}X - \\delta_{p}P)  \\frac{\\partial}{\\partial P}(\\beta_{2}X - \\delta_{p}P)\n\\end{pmatrix}_{\\mathbf{y}=\\mathbf{y}^{\\ast}}\n$$\n计算偏导数：\n$$\nJ = \\begin{pmatrix}\n-\\delta_{m}  0  \\frac{\\partial \\Phi}{\\partial P} \\\\\n\\beta_{1}  -\\delta_{x}  0 \\\\\n0  \\beta_{2}  -\\delta_{p}\n\\end{pmatrix}_{\\mathbf{y}=\\mathbf{y}^{\\ast}}\n$$\n根据局部抑制斜率大小 $k \\equiv -\\left.\\frac{\\partial \\Phi}{\\partial P}\\right|_{P^{\\ast}}$ 的定义，将其代入雅可比矩阵得到：\n$$\nJ = \\begin{pmatrix}\n-\\delta_{m}  0  -k \\\\\n\\beta_{1}  -\\delta_{x}  0 \\\\\n0  \\beta_{2}  -\\delta_{p}\n\\end{pmatrix}\n$$\n稳态的稳定性由 $J$ 的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(\\lambda I - J) = 0$ 的根。\n$$\n\\det\\begin{pmatrix}\n\\lambda + \\delta_{m}  0  k \\\\\n-\\beta_{1}  \\lambda + \\delta_{x}  0 \\\\\n0  -\\beta_{2}  \\lambda + \\delta_{p}\n\\end{pmatrix} = 0\n$$\n我们沿第一行进行代数余子式展开来计算行列式：\n$$\n(\\lambda + \\delta_{m}) \\det\\begin{pmatrix} \\lambda + \\delta_{x}  0 \\\\ -\\beta_{2}  \\lambda + \\delta_{p} \\end{pmatrix} - 0 + k \\det\\begin{pmatrix} -\\beta_{1}  \\lambda + \\delta_{x} \\\\ 0  -\\beta_{2} \\end{pmatrix} = 0\n$$\n$$\n(\\lambda + \\delta_{m})[(\\lambda + \\delta_{x})(\\lambda + \\delta_{p})] + k[(-\\beta_{1})(-\\beta_{2})] = 0\n$$\n$$\n(\\lambda + \\delta_{m})(\\lambda + \\delta_{x})(\\lambda + \\delta_{p}) + k\\beta_{1}\\beta_{2} = 0\n$$\n展开多项式：\n$$\n(\\lambda^2 + (\\delta_{m}+\\delta_{x})\\lambda + \\delta_{m}\\delta_{x})(\\lambda + \\delta_{p}) + k\\beta_{1}\\beta_{2} = 0\n$$\n$$\n\\lambda^3 + \\delta_{p}\\lambda^2 + (\\delta_{m}+\\delta_{x})\\lambda^2 + \\delta_{p}(\\delta_{m}+\\delta_{x})\\lambda + \\delta_{m}\\delta_{x}\\lambda + \\delta_{m}\\delta_{x}\\delta_{p} + k\\beta_{1}\\beta_{2} = 0\n$$\n按 $\\lambda$ 的幂次对各项进行分组：\n$$\n\\lambda^3 + (\\delta_{m}+\\delta_{x}+\\delta_{p})\\lambda^2 + (\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p})\\lambda + (\\delta_{m}\\delta_{x}\\delta_{p} + k\\beta_{1}\\beta_{2}) = 0\n$$\n当一对共轭复特征值穿过虚轴时，发生霍普夫分岔。在分岔点，特征值为纯虚数，$\\lambda = \\pm i\\omega_{0}$，其中 $\\omega_{0}$ 是新生振荡的角频率。我们将 $\\lambda = i\\omega_{0}$（其中 $\\omega_{0} > 0$）代入特征方程：\n$$\n(i\\omega_{0})^3 + (\\delta_{m}+\\delta_{x}+\\delta_{p})(i\\omega_{0})^2 + (\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p})(i\\omega_{0}) + (\\delta_{m}\\delta_{x}\\delta_{p} + k\\beta_{1}\\beta_{2}) = 0\n$$\n$$\n-i\\omega_{0}^3 - (\\delta_{m}+\\delta_{x}+\\delta_{p})\\omega_{0}^2 + i(\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p})\\omega_{0} + \\delta_{m}\\delta_{x}\\delta_{p} + k\\beta_{1}\\beta_{2} = 0\n$$\n要使此复数为零，其实部和虚部都必须为零。我们分离实部和虚部，此时 $k = k_{\\mathrm{crit}}$：\n实部：\n$$\n-(\\delta_{m}+\\delta_{x}+\\delta_{p})\\omega_{0}^2 + \\delta_{m}\\delta_{x}\\delta_{p} + k_{\\mathrm{crit}}\\beta_{1}\\beta_{2} = 0\n$$\n虚部：\n$$\n-\\omega_{0}^3 + (\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p})\\omega_{0} = 0\n$$\n由于在振荡起始时 $\\omega_{0} > 0$，我们可以将虚部方程两边同除以 $\\omega_{0}$：\n$$\n-\\omega_{0}^2 + (\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p}) = 0\n$$\n这给出了振荡频率 $\\omega_{0}$ 的表达式：\n$$\n\\omega_{0}^2 = \\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p}\n$$\n现在我们求解实部方程以得到 $k_{\\mathrm{crit}}$：\n$$\nk_{\\mathrm{crit}}\\beta_{1}\\beta_{2} = (\\delta_{m}+\\delta_{x}+\\delta_{p})\\omega_{0}^2 - \\delta_{m}\\delta_{x}\\delta_{p}\n$$\n$$\nk_{\\mathrm{crit}} = \\frac{(\\delta_{m}+\\delta_{x}+\\delta_{p})\\omega_{0}^2 - \\delta_{m}\\delta_{x}\\delta_{p}}{\\beta_{1}\\beta_{2}}\n$$\n我们代入 $\\omega_{0}^2$ 的表达式，得到以系统参数表示的 $k_{\\mathrm{crit}}$ 的通用公式：\n$$\nk_{\\mathrm{crit}} = \\frac{(\\delta_{m}+\\delta_{x}+\\delta_{p})(\\delta_{m}\\delta_{x} + \\delta_{m}\\delta_{p} + \\delta_{x}\\delta_{p}) - \\delta_{m}\\delta_{x}\\delta_{p}}{\\beta_{1}\\beta_{2}}\n$$\n现在，我们代入给定的参数值：\n$$\n\\delta_{m} = 0.30\\ \\mathrm{h}^{-1}, \\quad \\delta_{x} = 0.20\\ \\mathrm{h}^{-1}, \\quad \\delta_{p} = 0.10\\ \\mathrm{h}^{-1}\n$$\n$$\n\\beta_{1} = 1.50\\ \\mathrm{h}^{-1}, \\quad \\beta_{2} = 0.80\\ \\mathrm{h}^{-1}\n$$\n首先，我们计算 $\\omega_{0}^2$：\n$$\n\\omega_{0}^2 = (0.30)(0.20) + (0.30)(0.10) + (0.20)(0.10) = 0.06 + 0.03 + 0.02 = 0.11\\ \\mathrm{h}^{-2}\n$$\n角频率为：\n$$\n\\omega_{0} = \\sqrt{0.11} \\approx 0.33166\\ \\mathrm{rad/h}\n$$\n四舍五入到三位有效数字，$\\omega_{0} \\approx 0.332\\ \\mathrm{rad/h}$。\n\n接下来，我们计算 $k_{\\mathrm{crit}}$。我们首先需要降解率的和与积：\n$$\n\\delta_{m}+\\delta_{x}+\\delta_{p} = 0.30 + 0.20 + 0.10 = 0.60\\ \\mathrm{h}^{-1}\n$$\n$$\n\\delta_{m}\\delta_{x}\\delta_{p} = (0.30)(0.20)(0.10) = 0.006\\ \\mathrm{h}^{-3}\n$$\n以及产物增益的乘积：\n$$\n\\beta_{1}\\beta_{2} = (1.50)(0.80) = 1.20\\ \\mathrm{h}^{-2}\n$$\n现在，我们将这些值代入 $k_{\\mathrm{crit}}$ 的表达式中：\n$$\nk_{\\mathrm{crit}} = \\frac{(0.60)(0.11) - 0.006}{1.20} = \\frac{0.066 - 0.006}{1.20} = \\frac{0.06}{1.20} = 0.05\\ \\mathrm{h}^{-1}\n$$\n$k_{\\mathrm{crit}}$ 的精确值为 $0.05$。为报告三位有效数字，我们记为 $0.0500\\ \\mathrm{h}^{-1}$。\n\n抑制斜率大小的临界值为 $k_{\\mathrm{crit}} = 0.0500\\ \\mathrm{h}^{-1}$，对应的振荡角频率为 $\\omega_{0} = 0.332\\ \\mathrm{rad/h}$。\n最终结果为数对 $[k_{\\mathrm{crit}},\\ \\omega_{0}]$。\n$$\n[\\,k_{\\mathrm{crit}},\\ \\omega_{0}\\,] = [\\,0.0500,\\ 0.332\\,]\n$$\n根据要求，$k_{\\mathrm{crit}}$ 的单位是 $\\mathrm{h}^{-1}$，$\\omega_{0}$ 的单位是 $\\mathrm{rad/h}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0500  0.332 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "像霍普夫分岔这样的分析方法虽然强大，但通常只适用于相对简单的模型或分岔点附近的局部分析。对于更复杂、非线性更强或受外部驱动的系统，我们必须依赖数值方法。这个练习介绍了一种强大的计算技术——单次打靶法（single-shooting method），用于寻找这类系统中的周期轨道，并要求你亲自推导其收敛准则，从而将理论与解决实际问题的算法实现联系起来。",
            "id": "3896166",
            "problem": "考虑一个二维、时间周期性受迫的非线性振子，其灵感来源于可兴奋生物医学组织中简化的膜动力学。设状态为 $x(t) = [x_1(t), x_2(t)]^\\top \\in \\mathbb{R}^2$，其中 $x_1(t)$ 是一个无量纲的类膜电压变量，$x_2(t)$ 是其无量纲的变化率。其动力学由受迫范德波尔方程决定\n$$\n\\frac{dx_1}{dt} = x_2, \\quad \\frac{dx_2}{dt} = \\mu \\left(1 - x_1^2\\right) x_2 - x_1 + A \\cos(\\omega t),\n$$\n其中 $\\mu  0$ 控制非线性度，$A \\ge 0$ 是策动力振幅，$\\omega  0$ 是策动角频率。策动周期为 $T = \\frac{2\\pi}{\\omega}$ 秒。\n\n将流映射 $\\phi_t(x_0)$ 定义为初始条件为 $x(0) = x_0$ 的系统在时间 $t$ 的解。对于一个周期为 $T$ 的时间周期非自治系统，一个 $T$-周期轨道对应于庞加莱映射在一个周期内的不动点，即方程\n$$\nF(x_0) \\equiv \\phi_T(x_0) - x_0 = 0\n$$\n的一个解 $x_0^\\star$。这是一个二维非线性方程组。通过以下步骤，实现使用牛顿迭代的单次打靶法，以求解给定 $(\\mu, A, \\omega)$ 下的 $x_0^\\star$：\n1. 从 $t = 0$ 到 $t = T$ 数值积分初始条件为 $x(0) = x_0$ 的原始系统，以计算 $\\phi_T(x_0)$。\n2. 同时积分变分（灵敏度）方程\n$$\n\\frac{d\\Phi}{dt} = J_f\\big(x(t), t\\big)\\,\\Phi, \\quad \\Phi(0) = I,\n$$\n其中 $J_f(x,t) = \\frac{\\partial f}{\\partial x}(x,t)$ 是 $f(x,t) = [x_2,\\ \\mu(1 - x_1^2) x_2 - x_1 + A \\cos(\\omega t)]^\\top$ 关于 $x$ 的雅可比矩阵，而 $I$ 是 $2 \\times 2$ 的单位矩阵。使用结果 $\\Phi(T) = D\\phi_T(x_0)$ 来构建牛顿更新\n$$\nx_0^{(k+1)} = x_0^{(k)} - \\left(D\\phi_T(x_0^{(k)}) - I\\right)^{-1} \\left(\\phi_T(x_0^{(k)}) - x_0^{(k)}\\right).\n$$\n包含一个回溯线搜索，如果残差范数没有减小，则减小步长，并在残差范数 $\\|F(x_0^{(k)})\\|_2$ 低于一个容差时终止。\n\n从动力系统和数值分析的第一性原理出发，推导并解释该方法的收敛判据，具体说明牛顿迭代与单次打靶法在何种条件下会局部收敛到一个 $T$-周期轨道。你的推导必须源自流映射、流的雅可比矩阵以及牛顿法的标准局部收敛性质的定义，不使用简化的公式。\n\n实现一个执行单次打靶法的程序，并为每个测试用例返回在给定的迭代预算和容差内达到收敛时的最终残差范数 $\\|F(x_0^\\star)\\|_2$，或者在收敛失败（由于残差不减小、雅可比矩阵奇异或积分失败）时返回哨兵值 $-1.0$。除周期 T（以秒为单位）外，所有计算都是无量纲的，但输出的残差范数也是无量纲的。\n\n使用以下测试套件（每个用例为 $(\\mu, A, \\omega, x_0^{(0)}, \\text{tol}, \\text{max\\_iter})$）：\n- 用例 1 (正常路径): $(\\mu = 1.0, A = 0.2, \\omega = 1.0, x_0^{(0)} = [0.1, 0.0], \\text{tol} = 10^{-8}, \\text{max\\_iter} = 15)$。\n- 用例 2 (边界，自治极限): $(\\mu = 1.0, A = 0.0, \\omega = 1.0, x_0^{(0)} = [1.0, 0.0], \\text{tol} = 10^{-8}, \\text{max\\_iter} = 15)$。\n- 用例 3 (刚性动力学): $(\\mu = 5.0, A = 0.1, \\omega = 1.0, x_0^{(0)} = [0.0, 0.0], \\text{tol} = 10^{-8}, \\text{max\\_iter} = 20)$。\n\n最终输出格式必须是单行，包含一个由三个浮点数组成的列表，每个数对应一个测试用例的返回值，以逗号分隔并用方括号括起来（例如，\"[v1,v2,v3]\"）。",
            "solution": "该问题要求我们通过实现基于牛顿法的单次打靶法来寻找受迫范德波尔振子的一个 $T$-周期轨道。这涉及寻找庞加莱映射 $F(x_0) = \\phi_T(x_0) - x_0 = 0$ 的一个不动点 $x_0^\\star$，其中 $\\phi_T(x_0)$ 是系统从 $x_0$ 出发在时间 $T$ 的状态。我们必须首先验证问题的有效性，然后推导数值方法的收敛判据，最后实现算法以求解给定的测试用例。该问题在科学上是合理的、适定的，并为求解提供了所有必要信息。\n\n系统动力学由二维非自治常微分方程（ODE）给出：\n$$\n\\frac{dx}{dt} = f(x, t) = \\begin{pmatrix} x_2 \\\\ \\mu(1 - x_1^2)x_2 - x_1 + A \\cos(\\omega t) \\end{pmatrix}\n$$\n其中 $x(t) = [x_1(t), x_2(t)]^\\top$。一个周期为 $T = 2\\pi/\\omega$ 的 $T$-周期解是一条轨迹 $x(t)$，满足对所有 $t$ 都有 $x(t+T) = x(t)$。这等价于找到一个初始条件 $x_0 = x(0)$，使得一个周期后的解 $\\phi_T(x_0)$ 返回到起始点，即 $\\phi_T(x_0) = x_0$。这是一个关于函数 $F(x_0) = \\phi_T(x_0) - x_0$ 的求根问题。\n\n**收敛判据的推导**\n\n牛顿法是用于寻找可微函数 $G(y)$ 的根的一种迭代方案。其迭代定义为：\n$$\ny^{(k+1)} = y^{(k)} - [DG(y^{(k)})]^{-1} G(y^{(k)})\n$$\n其中 $DG(y^{(k)})$ 是 $G$ 在第 $k$ 次迭代点 $y^{(k)}$ 处的雅可比矩阵。数值分析的一个标准结果表明，如果初始猜测 $y^{(0)}$ 足够接近一个单根 $y^\\star$（其中 $G(y^\\star)=0$ 且 $DG(y^\\star)$ 可逆），牛顿法将局部二次收敛到该根。\n\n在我们的问题中，变量是初始状态 $x_0 \\in \\mathbb{R}^2$，函数是 $F(x_0) = \\phi_T(x_0) - x_0$。$F(x_0)$ 关于 $x_0$ 的雅可比矩阵是：\n$$\nDF(x_0) = D\\phi_T(x_0) - I\n$$\n其中 $D\\phi_T(x_0) = \\frac{\\partial \\phi_T(x_0)}{\\partial x_0}$ 是流映射 $\\phi_T$ 的雅可比矩阵，而 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n因此，我们问题的牛顿迭代是：\n$$\nx_0^{(k+1)} = x_0^{(k)} - [D\\phi_T(x_0^{(k)}) - I]^{-1} (\\phi_T(x_0^{(k)}) - x_0^{(k)})\n$$\n这与问题陈述中给出的公式相符。\n\n该方法的收敛判据可以直接从牛顿法的一般条件推导出来：\n$1$. **单根的存在性**：必须存在一个周期轨道 $x^\\star(t)$，其初始条件为 $x_0^\\star = x^\\star(0)$，使得 $F(x_0^\\star) = 0$。为了牛顿法的局部收敛，这个根必须是单根，这意味着雅可比矩阵 $DF(x_0^\\star)$ 必须是可逆的。$DF(x_0^\\star) = D\\phi_T(x_0^\\star) - I$ 的可逆性等价于矩阵 $D\\phi_T(x_0^\\star)$ 的特征值中没有 $1$。\n$2$. **弗洛凯理论 (Floquet Theory)**：矩阵 $D\\phi_T(x_0^\\star)$ 被称为始于 $x_0^\\star$ 的周期轨道的单值矩阵。其特征值是该轨道的弗洛凯乘子。弗洛凯乘子为 $1$ 意味着该周期轨道是非双曲的，这通常对应于一个分岔点（例如，周期轨道的鞍结分岔、跨临界分岔或叉式分岔）。在这样的点上，标准的牛顿法会失去其二次收敛速度，甚至可能无法收敛。因此，第一个收敛判据是目标周期轨道必须是双曲的，即没有任何模为 $1$ 的弗洛凯乘子，特别地，没有任何等于 $1$ 的弗洛凯乘子。\n$3$. **足够接近的初始猜测**：对于牛顿迭代映射，初始猜测 $x_0^{(0)}$ 必须位于根 $x_0^\\star$ 的吸引盆内。这个吸引盆的大小和形状取决于系统的非线性。对于具有强非线性或刚性（例如，范德波尔方程中较大的 $\\mu$）的系统，吸引盆可能很小或具有复杂的几何形状，使得收敛性对 $x_0^{(0)}$ 的选择高度敏感。引入回溯线搜索有助于防止牛顿法在远离解时可能采取的大步长，从而扩大有效的收敛域。\n\n总之，单次打靶牛顿法将局部收敛到一个 $T$-周期轨道，如果：\na) 该轨道存在且是双曲的（没有模为 $1$ 的弗洛凯乘子，特别是没有等于 $1$ 的乘子）。\nb) 轨道的起始点的初始猜测在相空间中足够接近真实的起始点。\n\n**数值实现**\n\n为了实现牛顿迭代，我们需要在每一步 $k$ 计算 $\\phi_T(x_0^{(k)})$ 及其雅可比矩阵 $D\\phi_T(x_0^{(k)})$。这可以通过积分一个增广的 ODE 系统来高效地完成。流映射的雅可比矩阵 $D\\phi_T(x_0)$ 是变分方程的状态转移矩阵 $\\Phi(T)$：\n$$\n\\frac{d\\Phi}{dt} = J_f(x(t), t) \\Phi(t), \\quad \\Phi(0) = I\n$$\n其中 $J_f$ 是向量场 $f(x,t)$ 关于状态 $x$ 的雅可比矩阵：\n$$\nJ_f(x, t) = \\frac{\\partial f}{\\partial x} = \\begin{pmatrix} 0  1 \\\\ -2\\mu x_1 x_2 - 1  \\mu(1-x_1^2) \\end{pmatrix}\n$$\n我们定义一个增广状态向量 $z(t) \\in \\mathbb{R}^6$，它结合了原始状态 $x(t) \\in \\mathbb{R}^2$ 和矩阵 $\\Phi(t) \\in \\mathbb{R}^{2 \\times 2}$ 的扁平化分量：\n$$\nz(t) = [x_1(t), x_2(t), \\Phi_{11}(t), \\Phi_{12}(t), \\Phi_{21}(t), \\Phi_{22}(t)]^\\top\n$$\n这个增广系统的动力学由一个 $6$ 维 ODE 系统决定：\n$$\n\\frac{dz}{dt} = \\begin{pmatrix} f(x,t) \\\\ \\text{vec}(J_f(x,t) \\Phi) \\end{pmatrix}\n$$\n其中 $\\text{vec}(\\cdot)$ 表示矩阵乘积的向量化。在第 $k$ 个牛顿步骤中，该系统的初始条件为：\n$$\nz(0) = [x_{0,1}^{(k)}, x_{0,2}^{(k)}, 1, 0, 0, 1]^\\top\n$$\n通过将该系统从 $t=0$ 积分到 $t=T$，我们得到 $z(T)$。$z(T)$ 的前两个分量给出了 $\\phi_T(x_0^{(k)})$，后四个分量重塑为一个 $2 \\times 2$ 矩阵，给出了 $D\\phi_T(x_0^{(k)})$。\n\n带回溯线搜索的单次打靶算法如下：\n$1$. 初始化 $k=0$ 和起始猜测 $x_0^{(0)}$。\n$2$. 对于 $k=0, 1, \\ldots, \\text{max\\_iter}-1$：\n    a. 以基于 $x_0^{(k)}$ 的初始条件，将 $6$ 维增广 ODE 从 $t=0$ 数值积分到 $t=T$。\n    b. 从 $t=T$ 的解中，提取 $\\phi_T(x_0^{(k)})$ 和 $D\\phi_T(x_0^{(k)})$。\n    c. 计算残差 $F_k = \\phi_T(x_0^{(k)}) - x_0^{(k)}$ 及其范数 $\\|F_k\\|_2$。\n    d. 如果 $\\|F_k\\|_2  \\text{tol}$，则收敛成功。返回 $\\|F_k\\|_2$。\n    e. 计算牛顿步的雅可比矩阵 $J_N = D\\phi_T(x_0^{(k)}) - I$。\n    f. 求解线性系统 $J_N \\Delta x = -F_k$ 以获得更新步长 $\\Delta x$。如果 $J_N$ 是奇异的，则方法失败。\n    g. 执行回溯线搜索：从步长 $\\alpha=1$ 开始。在有限的尝试次数内，检查建议的更新 $x_{next} = x_0^{(k)} + \\alpha \\Delta x$ 是否减小了残差范数。即，计算 $F_{next} = \\phi_T(x_{next}) - x_{next}$（这需要另一次 ODE 积分，但这次仅针对二维状态），并检查是否 $\\|F_{next}\\|_2  \\|F_k\\|_2$。如果不满足，则减小 $\\alpha$ （例如，$\\alpha \\leftarrow \\alpha/2$）。\n    h. 如果找到了一个合适的 $\\alpha$，则更新 $x_0^{(k+1)} = x_{next}$ 并继续下一次迭代。如果线搜索未能找到一个减小残差的步长，则方法失败。\n$3$. 如果循环完成而未收敛，则方法失败。\n任何一步（积分、线性求解、线搜索、达到最大迭代次数）的失败都会导致返回值为 $-1.0$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef find_periodic_orbit(mu, A, omega, x0_initial, tol, max_iter):\n    \"\"\"\n    Finds a periodic orbit of the forced van der Pol oscillator using single-shooting.\n\n    Args:\n        mu (float): Nonlinearity parameter.\n        A (float): Forcing amplitude.\n        omega (float): Forcing angular frequency.\n        x0_initial (np.ndarray): Initial guess for the state at t=0.\n        tol (float): Convergence tolerance for the residual norm.\n        max_iter (int): Maximum number of Newton iterations.\n\n    Returns:\n        float: The final residual norm if convergence is achieved, otherwise -1.0.\n    \"\"\"\n    T = 2.0 * np.pi / omega\n    x0_current = np.array(x0_initial, dtype=float)\n\n    def f_augmented(t, z, mu, A, omega):\n        \"\"\"Augmented ODE system for state and sensitivity matrix.\"\"\"\n        x1, x2 = z[0], z[1]\n        Phi = z[2:].reshape((2, 2))\n\n        # ODE for the state variables\n        dx1_dt = x2\n        dx2_dt = mu * (1 - x1**2) * x2 - x1 + A * np.cos(omega * t)\n        \n        # Jacobian of the vector field J_f\n        Jf = np.array([\n            [0.0, 1.0],\n            [-2.0 * mu * x1 * x2 - 1.0, mu * (1 - x1**2)]\n        ])\n\n        # ODE for the sensitivity matrix\n        dPhi_dt = Jf @ Phi\n        \n        return np.concatenate(([dx1_dt, dx2_dt], dPhi_dt.flatten()))\n\n    def f_state_only(t, x, mu, A, omega):\n        \"\"\"ODE system for state variables only (for line search).\"\"\"\n        x1, x2 = x\n        dx1_dt = x2\n        dx2_dt = mu * (1 - x1**2) * x2 - x1 + A * np.cos(omega * t)\n        return [dx1_dt, dx2_dt]\n\n    for k in range(max_iter):\n        # 1. Integrate the augmented system\n        z0 = np.concatenate((x0_current, np.eye(2).flatten()))\n        sol_aug = solve_ivp(\n            f_augmented, [0, T], z0, args=(mu, A, omega),\n            dense_output=True, rtol=1e-10, atol=1e-10\n        )\n        if not sol_aug.success:\n            return -1.0\n        \n        zT = sol_aug.y[:, -1]\n        phi_T_x0 = zT[:2]\n        D_phi_T_x0 = zT[2:].reshape((2, 2))\n\n        # 2. Compute residual and check for convergence\n        F_x0 = phi_T_x0 - x0_current\n        residual_norm = np.linalg.norm(F_x0)\n        \n        if residual_norm  tol:\n            return residual_norm\n\n        # 3. Compute Newton step\n        J_newton = D_phi_T_x0 - np.eye(2)\n        try:\n            delta_x = np.linalg.solve(J_newton, -F_x0)\n        except np.linalg.LinAlgError:\n            return -1.0\n\n        # 4. Backtracking line search\n        alpha = 1.0\n        step_found = False\n        for _ in range(10): # Max 10 backtracking steps\n            x_next = x0_current + alpha * delta_x\n            \n            sol_state = solve_ivp(\n                f_state_only, [0, T], x_next, args=(mu, A, omega),\n                dense_output=False, rtol=1e-10, atol=1e-10\n            )\n\n            if not sol_state.success:\n                alpha /= 2.0\n                continue\n                \n            phi_T_x_next = sol_state.y[:, -1]\n            F_x_next = phi_T_x_next - x_next\n            new_norm = np.linalg.norm(F_x_next)\n\n            if new_norm  residual_norm:\n                x0_current = x_next\n                step_found = True\n                break\n            \n            alpha /= 2.0\n\n        if not step_found:\n            return -1.0 # Line search failed\n\n    return -1.0 # Max iterations reached\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (mu, A, omega, x0_initial, tol, max_iter)\n        (1.0, 0.2, 1.0, [0.1, 0.0], 1e-8, 15),\n        (1.0, 0.0, 1.0, [1.0, 0.0], 1e-8, 15),\n        (5.0, 0.1, 1.0, [0.0, 0.0], 1e-8, 20),\n    ]\n\n    results = []\n    for params in test_cases:\n        mu, A, omega, x0_initial, tol, max_iter = params\n        result = find_periodic_orbit(mu, A, omega, x0_initial, tol, max_iter)\n        results.append(result)\n\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}