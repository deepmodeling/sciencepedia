{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在建立大多数转运模型的数学基础。我们将从基本原理出发，推导描述转运蛋白活性如何随底物浓度增加而饱和的米氏方程（Michaelis-Menten equation）。掌握这个基本构建模块对于构建更复杂的肾小管转运模型至关重要 ()。",
            "id": "3939756",
            "problem": "考虑一个嵌入在近端小管上皮细胞顶端膜中的单溶质重吸收转运体。该转运体与管腔溶质结合，并经历催化转换将溶质移入细胞内。该结合-转换机制被建模为\n$$\nT + S \\xrightleftharpoons[k_{-1}]{k_{1}} TS \\xrightarrow{k_{\\text{cat}}} T + P,\n$$\n其中，$T$ 是游离转运体，$S$ 是管腔中的溶质，$TS$ 是转运体-溶质复合物，$P$ 是产物状态（细胞内侧的溶质），$k_{1}$ 和 $k_{-1}$ 分别是正向和反向结合速率常数，$k_{\\text{cat}}$ 是催化转换速率。设总转运体浓度为 $E_{T} = [T] + [TS]$。假设 $[TS]$ 处于 Briggs–Haldane 准稳态 (QSS)，并且产物在顶端侧的再结合可忽略不计，因此单向摄取通量等于每单位膜面积的催化通量 $J = k_{\\text{cat}}[TS]$。根据源自 QSS 的标准单底物定义，定义最大单位面积摄取能力 $V_{\\max} = k_{\\text{cat}} E_{T}$ 和半饱和常数 $K_{m}$。\n\n从质量作用动力学和 QSS 假设出发，推导出稳态单位面积摄取通量 $J$ 作为管腔溶质浓度 $C$ 以及参数 $V_{\\max}$ 和 $K_{m}$ 的函数。然后，对于 $V_{\\max} = $ $1$ nmol s$^{-1}$ cm$^{-2}$，$K_{m} = $ $2$ mM，管腔浓度 $C = $ $4$ mM 的具体情况，计算：\n- 净摄取速率 $J$（答案以 nmol s$^{-1}$ cm$^{-2}$ 为单位表示），以及\n- 饱和分数 $f = J / V_{\\max}$。\n\n为了评估的目的，操作上将“接近饱和”定义为 $f \\geq $ $0.9$。将您的数值结果四舍五入至四位有效数字。",
            "solution": "该问题是有效的。它是一个标准的转运激动力学练习，基于 Michaelis-Menten 模型和 Briggs-Haldane 准稳态近似这些科学上已确立的原理。所有必要的信息都已提供，问题提法恰当且客观。\n\n解答过程分两部分。首先，推导稳态摄取通量 $J$ 的通用表达式。其次，使用该表达式计算所提供具体情况所需的数值。\n\n**第一部分：稳态摄取通量 $J$ 的推导**\n\n转运过程由以下反应方案描述：\n$$\nT + S \\xrightleftharpoons[k_{-1}]{k_{1}} TS \\xrightarrow{k_{\\text{cat}}} T + P\n$$\n转运体-溶质复合物浓度 $[TS]$ 的变化率由质量作用定律给出：\n$$\n\\frac{d[TS]}{dt} = k_{1}[T][S] - k_{-1}[TS] - k_{\\text{cat}}[TS]\n$$\n问题指定使用 Briggs-Haldane 准稳态 (QSS) 近似，该近似假设中间复合物 $[TS]$ 的浓度很快达到稳态，即 $\\frac{d[TS]}{dt} \\approx 0$。应用此假设可得：\n$$\nk_{1}[T][S] = (k_{-1} + k_{\\text{cat}})[TS]\n$$\n总转运体浓度 $E_{T}$ 是恒定的，由游离形式和结合形式的浓度之和给出：\n$$\nE_{T} = [T] + [TS]\n$$\n这使我们能够将游离转运体浓度 $[T]$ 表示为：\n$$\n[T] = E_{T} - [TS]\n$$\n将 $[T]$ 的这个表达式代入 QSS 方程可得：\n$$\nk_{1}(E_{T} - [TS])[S] = (k_{-1} + k_{\\text{cat}})[TS]\n$$\n问题将管腔溶质浓度 $[S]$ 表示为 $C$。用 $C$ 代替 $[S]$ 并重新整理方程以求解 $[TS]$：\n$$\nk_{1}E_{T}C - k_{1}[TS]C = (k_{-1} + k_{\\text{cat}})[TS]\n$$\n$$\nk_{1}E_{T}C = [TS](k_{1}C + k_{-1} + k_{\\text{cat}})\n$$\n$$\n[TS] = \\frac{k_{1}E_{T}C}{k_{1}C + k_{-1} + k_{\\text{cat}}}\n$$\n为将此表达式简化为标准形式，我们将分子和分母同除以 $k_{1}$：\n$$\n[TS] = \\frac{E_{T}C}{C + \\frac{k_{-1} + k_{\\text{cat}}}{k_{1}}}\n$$\n问题根据源自 QSS (Briggs-Haldane) 假设的标准定义来定义半饱和常数 $K_{m}$，即：\n$$\nK_{m} = \\frac{k_{-1} + k_{\\text{cat}}}{k_{1}}\n$$\n将 $K_{m}$ 代入 $[TS]$ 的表达式中可得：\n$$\n[TS] = \\frac{E_{T}C}{K_{m} + C}\n$$\n单向摄取通量 $J$ 定义为催化通量 $J = k_{\\text{cat}}[TS]$。代入 $[TS]$ 的表达式：\n$$\nJ = k_{\\text{cat}} \\left( \\frac{E_{T}C}{K_{m} + C} \\right) = \\frac{k_{\\text{cat}}E_{T}C}{K_{m} + C}\n$$\n最后，我们使用最大单位面积摄取能力 $V_{\\max} = k_{\\text{cat}}E_{T}$ 的定义。将其代入 $J$ 的方程中，得到最终的推导表达式，即著名的 Michaelis-Menten 方程：\n$$\nJ = \\frac{V_{\\max}C}{K_{m} + C}\n$$\n\n**第二部分：数值计算**\n\n问题提供了以下具体值：\n- 最大摄取能力：$V_{\\max} = 1 \\, \\text{nmol s}^{-1} \\text{cm}^{-2}$\n- 半饱和常数：$K_{m} = 2 \\, \\text{mM}$\n- 管腔浓度：$C = 4 \\, \\text{mM}$\n\n我们需要计算净摄取速率 $J$ 和饱和分数 $f = J / V_{\\max}$。\n\n首先，我们计算净摄取速率 $J$。注意，$K_{m}$ 和 $C$ 的单位 (mM) 是一致的，将会抵消，使得 $J$ 的单位由 $V_{\\max}$ 的单位决定。\n$$\nJ = \\frac{V_{\\max}C}{K_{m} + C} = \\frac{(1 \\, \\text{nmol s}^{-1} \\text{cm}^{-2})(4 \\, \\text{mM})}{(2 \\, \\text{mM}) + (4 \\, \\text{mM})} = \\frac{4}{6} \\, \\text{nmol s}^{-1} \\text{cm}^{-2} = \\frac{2}{3} \\, \\text{nmol s}^{-1} \\text{cm}^{-2}\n$$\n问题要求将数值结果四舍五入至四位有效数字。\n$$\nJ \\approx 0.66666... \\, \\text{nmol s}^{-1} \\text{cm}^{-2} \\approx 0.6667 \\, \\text{nmol s}^{-1} \\text{cm}^{-2}\n$$\n接下来，我们计算饱和分数 $f$。\n$$\nf = \\frac{J}{V_{\\max}}\n$$\n从推导出的方程中，我们也可以看到：\n$$\nf = \\frac{J}{V_{\\max}} = \\frac{V_{\\max}C / (K_{m} + C)}{V_{\\max}} = \\frac{C}{K_{m} + C}\n$$\n使用给定的值：\n$$\nf = \\frac{4 \\, \\text{mM}}{2 \\, \\text{mM} + 4 \\, \\text{mM}} = \\frac{4}{6} = \\frac{2}{3}\n$$\n四舍五入至四位有效数字：\n$$\nf \\approx 0.66666... \\approx 0.6667\n$$\n饱和分数是一个无量纲量。它表明在此条件下，转运体大约以其最大能力的 $66.67\\%$ 运行。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6667  0.6667 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在膜转运概念的基础上，本练习将整个上皮细胞模拟为串联的两个膜。您将应用质量守恒原理，在考虑跨膜转运和细胞内反应的情况下，确定溶质穿过细胞的净通量。这项练习是理解单个膜特性如何决定整体上皮功能的关键 ()。",
            "id": "3939754",
            "problem": "一个上皮层被建模为两个串联的膜，面向管腔的顶膜和面向间质的基底外侧膜，它们共享一个细胞内区室。一种中性溶质被动地穿过每个膜，并且没有旁细胞转运。设顶膜和基底外侧膜的渗透性分别为 $P_{a}$ 和 $P_{b}$。管腔浓度为 $C_{\\ell}$，间质浓度为 $C_{i}$，细胞内浓度为 $C_{c}(t)$。单位上皮面积的细胞内体积为 $v$（因此 $v C_{c}$ 的单位是摩尔每单位面积）。该溶质还以速率常数 $k$ 进行一级细胞内消耗，因此细胞内汇项等于 $k v C_{c}(t)$。假设是等温条件和稀溶液，因此被动转运可以由线性唯象定律充分描述。\n\n采用跨细胞通量从管腔到间质方向为正的符号约定。在准稳态跨细胞转运条件下，$C_{c}(t)$ 已达到稳态，请根据基本的质量守恒和被动转运假设，推导净跨细胞通量 $J_{\\text{net}}$ 关于 $P_{a}$、$P_{b}$、$v$、$k$、$C_{\\ell}$ 和 $C_{i}$ 的表达式。最终通量的单位用 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 表示。最终答案必须是单一的闭式解析表达式。",
            "solution": "该问题被认为是有效的，因为它是科学上合理的、适定的、客观的和自洽的。我们可以开始推导。\n\n该系统是一个上皮层，它将管腔区室与间质区室分开，中间有一个细胞内区室。我们被要求在稳态条件下求出一种中性溶质的净跨细胞通量。\n\n首先，我们根据所给的被动转运的线性唯象定律来定义穿过顶膜和基底外侧膜的通量。这些可以用菲克定律来描述，即穿过膜的通量 $J$ 与渗透性 $P$ 和浓度差 $\\Delta C$ 成正比。\n\n设 $J_a$ 为从管腔穿过顶膜进入细胞的通量。给定管腔浓度 $C_{\\ell}$ 和细胞内浓度 $C_c(t)$，该通量为：\n$$\nJ_a = P_a (C_{\\ell} - C_c(t))\n$$\n这里，$P_a$ 是顶膜渗透性。正的 $J_a$ 表示向细胞内运动。\n\n设 $J_b$ 为从细胞穿过基底外侧膜进入间质的通量。给定间质浓度 $C_i$，该通量为：\n$$\nJ_b = P_b (C_c(t) - C_i)\n$$\n这里，$P_b$ 是基底外侧膜渗透性。正的 $J_b$ 表示从细胞向间质运动。\n\n接下来，我们建立细胞内区室中溶质的质量平衡。单位上皮面积的溶质量由 $v C_c(t)$ 给出，其中 $v$ 是单位面积的细胞内体积。该量的变化率等于流入速率减去流出速率和消耗速率。\n\n质量平衡方程为：\n$$\n\\frac{d(v C_c(t))}{dt} = J_a - J_b - J_{\\text{sink}}\n$$\n其中 $J_{\\text{sink}}$ 是单位面积的消耗速率。问题指出，该溶质以速率常数 $k$ 进行一级细胞内消耗，且汇项为 $k v C_c(t)$。假设 $v$ 是常数，质量平衡方程变为：\n$$\nv \\frac{dC_c(t)}{dt} = P_a (C_{\\ell} - C_c(t)) - P_b (C_c(t) - C_i) - k v C_c(t)\n$$\n\n问题指定了准稳态的条件，其中细胞内浓度 $C_c(t)$ 已达到一个恒定值，我们将其记为 $C_{c,ss}$。在此条件下，细胞内浓度的变化率为零：\n$$\n\\frac{dC_c}{dt} \\bigg|_{t \\to \\infty} = 0\n$$\n因此，稳态下的质量平衡方程为：\n$$\n0 = P_a (C_{\\ell} - C_{c,ss}) - P_b (C_{c,ss} - C_i) - k v C_{c,ss}\n$$\n\n我们现在求解这个代数方程，以得到稳态细胞内浓度 $C_{c,ss}$。我们展开各项：\n$$\n0 = P_a C_{\\ell} - P_a C_{c,ss} - P_b C_{c,ss} + P_b C_i - k v C_{c,ss}\n$$\n将包含 $C_{c,ss}$ 的项组合在一起：\n$$\nP_a C_{c,ss} + P_b C_{c,ss} + k v C_{c,ss} = P_a C_{\\ell} + P_b C_i\n$$\n提出因子 $C_{c,ss}$：\n$$\nC_{c,ss} (P_a + P_b + k v) = P_a C_{\\ell} + P_b C_i\n$$\n分离出 $C_{c,ss}$ 得到：\n$$\nC_{c,ss} = \\frac{P_a C_{\\ell} + P_b C_i}{P_a + P_b + k v}\n$$\n\n问题要求净跨细胞通量 $J_{\\text{net}}$，并规定通量从管腔到间质方向为正。在上皮生理学中，物质从管腔侧到间质（或血液）侧的净通量定义为穿过基底外侧膜离开细胞的通量 $J_b$。这表示单位面积和时间内成功穿过整个细胞层的物质的量。在稳态下，该通量为 $J_b = P_b (C_{c,ss} - C_i)$。因此我们定义 $J_{\\text{net}} = J_b$。\n\n我们将推导出的 $C_{c,ss}$ 表达式代入 $J_{\\text{net}}$ 的方程中：\n$$\nJ_{\\text{net}} = P_b \\left( \\left( \\frac{P_a C_{\\ell} + P_b C_i}{P_a + P_b + k v} \\right) - C_i \\right)\n$$\n为简化，我们对括号内的项通分：\n$$\nJ_{\\text{net}} = P_b \\left( \\frac{P_a C_{\\ell} + P_b C_i - C_i (P_a + P_b + k v)}{P_a + P_b + k v} \\right)\n$$\n在分子中分配 $-C_i$：\n$$\nJ_{\\text{net}} = P_b \\left( \\frac{P_a C_{\\ell} + P_b C_i - P_a C_i - P_b C_i - k v C_i}{P_a + P_b + k v} \\right)\n$$\n$P_b C_i$ 和 $-P_b C_i$ 项相互抵消：\n$$\nJ_{\\text{net}} = P_b \\left( \\frac{P_a C_{\\ell} - P_a C_i - k v C_i}{P_a + P_b + k v} \\right)\n$$\n最后，我们可以将分子中的项组合起来，得到净跨细胞通量的最终表达式。我们可以从前两项中提出因子 $P_a$，并将表达式写为：\n$$\nJ_{\\text{net}} = \\frac{P_b (P_a(C_{\\ell} - C_i) - k v C_i)}{P_a + P_b + k v}\n$$\n或者，通过分配 $P_b$：\n$$\nJ_{\\text{net}} = \\frac{P_a P_b (C_{\\ell} - C_i) - k v P_b C_i}{P_a + P_b + k v}\n$$\n该表达式代表了从管腔到间质的溶质净通量，考虑了穿过两层膜的被动转运和细胞内的一级消耗。\n可以验证该表达式的量纲一致性。渗透性 $P$ 的单位是长度/时间（例如 $\\text{m}\\,\\text{s}^{-1}$），浓度 $C$ 的单位是摩尔/体积（例如 $\\text{mol}\\,\\text{m}^{-3}$），$k$ 的单位是 1/时间（例如 $\\text{s}^{-1}$），$v$ 的单位是体积/面积，即长度（例如 $\\text{m}$）。分母 $P_a + P_b + k v$ 的单位是 $\\text{m}\\,\\text{s}^{-1}$。分子中的每一项，例如 $P_a P_b C_{\\ell}$，其单位为 $(\\text{m}\\,\\text{s}^{-1})(\\text{m}\\,\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3}) = \\text{mol}\\,\\text{m}^{-1}\\,\\text{s}^{-2}$。这是不正确的。让我们重新检查最终因式分解前一步的完整分子：$P_b (P_a C_{\\ell} - P_a C_i - k v C_i)$。\n$P_a C_{\\ell}$ 项的单位是 $(\\text{m}\\,\\text{s}^{-1})(\\text{mol}\\,\\text{m}^{-3}) = \\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。\n$k v C_i$ 项的单位是 $(\\text{s}^{-1})(\\text{m})(\\text{mol}\\,\\text{m}^{-3}) = \\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。\n因此，括号中的项 $P_a(C_{\\ell} - C_i) - k v C_i$ 的单位是通量，即 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。\n整个表达式是 $J_{\\text{net}} = P_b \\times (\\text{通量}) / (\\text{速度})$。\n所以，$J_{\\text{net}}$ 的单位是 $(\\text{m}\\,\\text{s}^{-1}) \\times (\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}) / (\\text{m}\\,\\text{s}^{-1}) = \\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$，这是正确的。\n\n最终推导出的表达式是：\n$$\nJ_{\\text{net}} = \\frac{P_a P_b (C_{\\ell} - C_i) - k v P_b C_i}{P_a + P_b + k v}\n$$\n这个单一的闭式表达式就是所求的解。",
            "answer": "$$\n\\boxed{\\frac{P_{a} P_{b} (C_{\\ell} - C_{i}) - k v P_{b} C_{i}}{P_{a} + P_{b} + k v}}\n$$"
        },
        {
            "introduction": "这项最终练习将前面练习中的概念整合到一个全面的、空间分布式的肾单位模型中。您将通过编写一个计算模拟程序，来追踪溶质浓度沿具有不同特性的肾小管各段的变化。此练习不仅是肾小管转运建模的顶级应用，也展示了如何基于组件特性构建强大的器官级功能预测模型 ()。",
            "id": "3939777",
            "problem": "考虑一种溶质，它沿着一个由四个连续段组成的单一肾单位进行主动性肾小管重吸收：近曲小管 (PT)、亨利氏袢 (LH)、远曲小管 (DT) 和集合管 (CD)。每个段内溶质浓度 $C(x)$ 沿轴向坐标 $x$ 的变化由物种质量守恒和可饱和转运力学决定。假设以下基础：\n\n- 一维稳态对流-反应中的物种质量守恒：对于体积流量 $Q(x)$ 和管腔浓度 $C(x)$，轴向质量通量 $M(x)$ 满足\n$$\n\\frac{d}{dx}\\left(M(x)\\right) = - \\mathcal{S}(x)\\, j(x),\n$$\n其中 $M(x) = \\gamma\\, Q(x)\\, C(x)$，$\\gamma = 10^{-3}$ 用于将 $mM \\cdot nL$ 转换为 $nmol$，$\\mathcal{S}(x)$ 是单位长度的上皮表面积（单位为 $\\mathrm{mm}$），而 $j(x)$ 是单位面积的重吸收通量密度（单位为 $nmol/(min\\cdot mm^2)$）。\n\n- 可饱和转运力学 (Michaelis–Menten)，具有位置依赖的最大速率 $V_{\\max}(x)$ 和半饱和常数 $K_m(x)$：\n$$\nj(x) = V_{\\max}(x)\\, \\frac{C(x)}{K_m(x) + C(x)}.\n$$\n\n- 每个肾小管段 $s \\in \\{\\mathrm{PT}, \\mathrm{LH}, \\mathrm{DT}, \\mathrm{CD}\\}$ 均为圆柱几何形状，具有恒定的半径 $r_s$ 和长度 $L_s$，因此单位长度的表面积为\n$$\n\\mathcal{S}_s = 2\\pi r_s.\n$$\n\n- 体积流量 $Q(x)$ 被视为外源变量，并且在每个肾小管段内是分段恒定的：$Q(x) \\equiv Q_s$ 对于段 $s$ 内的 $x$。溶质质量在段边界处是连续的；如果 $Q$ 在段之间发生变化，$C$ 会进行调整以使 $M$ 保持连续。\n\n从上述定律和定义出发，推导出一个计算方案，该方案在给定 $V_{\\max}(x)$ 和 $K_m(x)$ 的图谱（每段分段恒定）、肾小管段几何形状 $(L_s, r_s)$ 和分段流量 $Q_s$ 的情况下，计算：\n1. 通过积分\n$$\n\\frac{dM}{dx} = -\\mathcal{S}_s\\, V_{\\max,s}\\, \\frac{C}{K_{m,s} + C}, \\quad \\text{with} \\quad C = \\frac{M}{\\gamma Q_s},\n$$\n在每个段 $s$ 内使用均匀步长 $\\Delta x$ 来计算沿肾单位的 $C(x)$ 和 $M(x)$ 的轴向分布。\n2. 各段的重吸收量\n$$\nR_s = \\int_{0}^{L_s} \\mathcal{S}_s\\, V_{\\max,s}\\, \\frac{C(x)}{K_{m,s} + C(x)}\\, dx,\n$$\n以及各段相对于进入近曲小管 (PT) 的滤过溶质负荷的贡献分数：\n$$\n\\phi_s = \\frac{R_s}{M_{\\mathrm{in}}}, \\quad \\text{where} \\quad M_{\\mathrm{in}} = \\gamma\\, Q_{\\mathrm{PT}}\\, C_{\\mathrm{in}}.\n$$\n\n科学和数值假设：\n- 假设每个肾小管段内的转运是准稳态的（不随时间变化），每段的 $Q_s$ 是恒定的，并且溶质质量在段连接处是连续的。\n- 如果由于重吸收超过可用溶质而导致 $M(x)$ 变为负值，则将 $M(x)$ 限制在 $0$，并在此后终止重吸收。\n- 使用固定步长的显式积分法，其中 $\\Delta x$ 对于数值稳定性而言足够小。\n\n您的任务是实现一个完整的程序，对指定的测试套件执行上述计算。所有量都必须使用下面指定的单位进行处理，最终的程序输出必须遵循要求的格式。\n\n单位：\n- $Q_s$ 的单位是 $nL/min$。\n- $C$ 和 $K_m$ 的单位是 $mM$。\n- $V_{\\max}$ 的单位是 $nmol/(min\\cdot mm^2)$。\n- $r_s$ 和 $L_s$ 的单位是 $mm$。\n- $\\Delta x$ 的单位是 $mm$。\n- $R_s$ 和 $M_{\\mathrm{in}}$ 的单位是 $nmol/min$。\n- 各段贡献分数 $\\phi_s$ 是无单位的；将其表示为四舍五入到六位小数的小数，不带百分号。\n\n所有测试用例的固定几何形状和动力学图谱（每段分段恒定）：\n- 段长度：$L_{\\mathrm{PT}} = 12$, $L_{\\mathrm{LH}} = 10$, $L_{\\mathrm{DT}} = 5$, $L_{\\mathrm{CD}} = 8$ (单位均为 $mm$)。\n- 段半径：$r_{\\mathrm{PT}} = 0.025$, $r_{\\mathrm{LH}} = 0.015$, $r_{\\mathrm{DT}} = 0.015$, $r_{\\mathrm{CD}} = 0.020$ (单位均为 $mm$)。\n- 基线 $V_{\\max}$：$V_{\\max,\\mathrm{PT}} = 0.005$, $V_{\\max,\\mathrm{LH}} = 0.0005$, $V_{\\max,\\mathrm{DT}} = 0.001$, $V_{\\max,\\mathrm{CD}} = 0.0002$ (单位均为 $nmol/(min\\cdot mm^2)$)。\n- 基线 $K_m$：$K_{m,\\mathrm{PT}} = 2.0$, $K_{m,\\mathrm{LH}} = 4.0$, $K_{m,\\mathrm{DT}} = 3.0$, $K_{m,\\mathrm{CD}} = 5.0$ (单位均为 $mM$)。\n- 积分步长：$\\Delta x = 0.01$ (单位为 $mm$)。\n- 转换：$\\gamma = 10^{-3}$ (将 $mM\\cdot nL$ 转换为 $nmol$)。\n\n测试套件：\n提供四个测试用例，每个用例由 $(Q_{\\mathrm{PT}}, Q_{\\mathrm{LH}}, Q_{\\mathrm{DT}}, Q_{\\mathrm{CD}}, C_{\\mathrm{in}}, \\text{V}_{\\max}\\ \\text{覆盖})$ 定义：\n1. 基线情况（理想路径）：流量 $Q_{\\mathrm{PT}} = 2.0$, $Q_{\\mathrm{LH}} = 1.2$, $Q_{\\mathrm{DT}} = 0.9$, $Q_{\\mathrm{CD}} = 0.8$ (单位为 $nL/min$)，入口浓度 $C_{\\mathrm{in}} = 5.0$ (单位为 $mM$)，无 $V_{\\max}$ 覆盖（使用基线值）。\n2. 饱和挑战：流量与情况1相同，但 $C_{\\mathrm{in}} = 50.0$ (单位为 $mM$)，无 $V_{\\max}$ 覆盖。\n3. 无转运边缘情况：流量与情况1相同，$C_{\\mathrm{in}} = 5.0$ (单位为 $mM$)，且所有段的 $V_{\\max}$ 被覆盖为 $0$。\n4. 低流量边界：流量 $Q_{\\mathrm{PT}} = 0.1$, $Q_{\\mathrm{LH}} = 0.1$, $Q_{\\mathrm{DT}} = 0.1$, $Q_{\\mathrm{CD}} = 0.1$ (单位为 $nL/min$)，$C_{\\mathrm{in}} = 5.0$ (单位为 $mM$)，使用基线 $V_{\\max}$。\n\n程序要求：\n- 使用给定的 $\\Delta x$ 实现 $M(x)$ 沿每个段的显式积分，通过 $M(x)$ 和 $Q_s$ 计算 $C(x)$，并通过 Michaelis–Menten 关系评估 $j(x)$。\n- 如有必要，通过限制来强制 $M(x) \\ge 0$；如果 $M$ 在任何段达到 $0$，则下游段接收的 $M=0$。\n- 对于每个测试用例，计算各段贡献列表 $\\left[\\phi_{\\mathrm{PT}}, \\phi_{\\mathrm{LH}}, \\phi_{\\mathrm{DT}}, \\phi_{\\mathrm{CD}}\\right]$。\n- 将每个 $\\phi_s$ 四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个项目本身是对应测试用例的四个分段贡献的方括号逗号分隔列表。例如，两个测试用例的有效输出将类似于 $\\left[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4]\\right]$，所有条目均为小数。在此问题中，请以相同的嵌套方括号格式打印四个测试用例的结果，并确保打印的字符串中没有空格。",
            "solution": "该问题是有效的。它在科学上基于质量输运和酶动力学原理，作为一个常微分方程组的初值问题，其提法是适定的，并且客观地陈述了所有必要的参数和条件。\n\n问题的核心是求解溶质沿模型肾单位的轴向质量通量 $M(x)$。质量通量的变化率由以下微分方程给出：\n$$\n\\frac{dM(x)}{dx} = - \\mathcal{S}(x)\\, j(x)\n$$\n其中 $\\mathcal{S}(x)$ 是单位长度的上皮表面积，而 $j(x)$ 是重吸收通量密度。问题陈述，在每个肾小管段 $s \\in \\{\\mathrm{PT}, \\mathrm{LH}, \\mathrm{DT}, \\mathrm{CD}\\}$ 内，几何形状和转运特性是恒定的。对于半径为 $r_s$ 的圆柱形小管，单位长度的表面积为 $\\mathcal{S}_s = 2\\pi r_s$。通量 $j(x)$ 遵循 Michaelis-Menten 动力学：\n$$\nj(x) = V_{\\max,s}\\, \\frac{C(x)}{K_{m,s} + C(x)}\n$$\n管腔浓度 $C(x)$ 通过 $M(x) = \\gamma Q_s C(x)$ 与质量通量 $M(x)$ 和恒定的段体积流量 $Q_s$ 相关联，其中 $\\gamma = 10^{-3}$ 是一个单位转换因子。因此，我们可以将浓度表示为 $C(x) = M(x) / (\\gamma Q_s)$。将此表达式代入 $j(x)$ 的方程，然后再代入控制微分方程，得到每个段 $s$ 内关于 $M(x)$ 的常微分方程（ODE）：\n$$\n\\frac{dM}{dx} = - (2\\pi r_s) V_{\\max,s} \\frac{M/(\\gamma Q_s)}{K_{m,s} + M/(\\gamma Q_s)}\n$$\n简化该分数可得：\n$$\n\\frac{dM}{dx} = - (2\\pi r_s) V_{\\max,s} \\frac{M}{\\gamma Q_s K_{m,s} + M}\n$$\n这个一阶常微分方程描述了在给定段 $s$ 中，质量通量 $M$ 沿轴向坐标 $x$ 的演变。为了数值求解该方程，我们采用固定步长 $\\Delta x$ 的显式前向欧拉法。对于从位置 $x_i$ 到 $x_{i+1} = x_i + \\Delta x$ 的一个步长，质量通量 $M_{i+1} = M(x_{i+1})$ 可近似为：\n$$\nM_{i+1} \\approx M_i + \\Delta x \\cdot \\left(\\frac{dM}{dx}\\right)_{x=x_i}\n$$\n代入导数的表达式，每一步的更新规则变为：\n$$\nM_{i+1} = M_i - \\Delta x (2\\pi r_s) V_{\\max,s} \\frac{M_i}{\\gamma Q_s K_{m,s} + M_i}\n$$\n一个重要的约束是质量通量不能为负。如果在任何步骤中计算出的 $M_{i+1}$ 小于 $0$，则必须将其限制为 $0$。这意味着 $M_{i+1} = \\max(0, M_{i+1})$。一旦 $M$ 达到 $0$，它在所有后续位置都保持为 $0$，因为重吸收项变为 $0$。\n\n每个测试用例的计算过程如下：\n\n1.  **初始化**：在近曲小管 (PT) 的起始处，$x=0$，初始滤过负荷 $M_{\\mathrm{in}}$ 由入口浓度 $C_{\\mathrm{in}}$ 和近曲小管流量 $Q_{\\mathrm{PT}}$ 计算得出：\n    $$\n    M_{\\mathrm{in}} = \\gamma Q_{\\mathrm{PT}} C_{\\mathrm{in}}\n    $$\n    这个 $M_{\\mathrm{in}}$ 作为总溶质负荷，所有重吸收分数都将对其进行归一化。进入第一段 (PT) 的质量通量是 $M_{\\mathrm{in}}$。\n\n2.  **分段积分**：我们按顺序依次处理四个肾小管段：PT、LH、DT 和 CD。对于每个段 $s$：\n    a. 进入该段的质量通量 $M_{\\text{in},s}$ 是从前一段流出的质量通量。对于 PT，$M_{\\text{in},\\mathrm{PT}} = M_{\\mathrm{in}}$。\n    b. 该段的长度为 $L_s$，因此积分步数为 $N_s = \\lfloor L_s / \\Delta x \\rfloor$。\n    c. 我们从 $M_0 = M_{\\text{in},s}$ 开始，使用前向欧拉更新规则迭代 $N_s$ 次。\n    d. 在每一步 $i$，我们计算 $M_{i+1}$ 并强制执行非负性约束。\n    e. 经过 $N_s$ 步后质量通量的最终值 $M_{\\text{out},s}$ 成为下一段的输入。\n\n3.  **重吸收量和分数的计算**：\n    a. 在 $s$ 段重吸收的溶质总量，记为 $R_s$，是进入和流出该段的质量通量之差：\n    $$\n    R_s = M_{\\text{in},s} - M_{\\text{out},s}\n    $$\n    b. $s$ 段对总重吸收的贡献分数（相对于初始滤过负荷）是：\n    $$\n    \\phi_s = \\frac{R_s}{M_{\\mathrm{in}}}\n    $$\n    对所有四个肾小管段重复此过程。一个测试用例的最终结果是四个贡献分数组成的列表 $[\\phi_{\\mathrm{PT}}, \\phi_{\\mathrm{LH}}, \\phi_{\\mathrm{DT}}, \\phi_{\\mathrm{CD}}]$，每个值都四舍五入到六位小数。然后对问题中指定的四个测试用例中的每一个重复整个计算过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nephron tubular reabsorption problem for a given set of test cases.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    # Segment geometry and properties\n    SEGMENTS = ['PT', 'LH', 'DT', 'CD']\n    L = {'PT': 12.0, 'LH': 10.0, 'DT': 5.0, 'CD': 8.0}  # Length (mm)\n    r = {'PT': 0.025, 'LH': 0.015, 'DT': 0.015, 'CD': 0.020} # Radius (mm)\n    V_max_base = {'PT': 0.005, 'LH': 0.0005, 'DT': 0.001, 'CD': 0.0002} # nmol/(min*mm^2)\n    K_m = {'PT': 2.0, 'LH': 4.0, 'DT': 3.0, 'CD': 5.0} # mM\n\n    # Numerical and physical constants\n    DELTA_X = 0.01  # Integration step size (mm)\n    GAMMA = 1e-3    # Conversion factor from mM*nL to nmol\n\n    # --- Test Suite ---\n    test_cases = [\n        # (Q_PT, Q_LH, Q_DT, Q_CD, C_in, V_max_override flag)\n        {'Q': {'PT': 2.0, 'LH': 1.2, 'DT': 0.9, 'CD': 0.8}, 'C_in': 5.0, 'vmax_zero': False},\n        {'Q': {'PT': 2.0, 'LH': 1.2, 'DT': 0.9, 'CD': 0.8}, 'C_in': 50.0, 'vmax_zero': False},\n        {'Q': {'PT': 2.0, 'LH': 1.2, 'DT': 0.9, 'CD': 0.8}, 'C_in': 5.0, 'vmax_zero': True},\n        {'Q': {'PT': 0.1, 'LH': 0.1, 'DT': 0.1, 'CD': 0.1}, 'C_in': 5.0, 'vmax_zero': False},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Q = case['Q']\n        C_in = case['C_in']\n        vmax_zero = case['vmax_zero']\n\n        # Determine V_max for the current case\n        V_max = {s: 0.0 for s in SEGMENTS} if vmax_zero else V_max_base\n\n        # Calculate initial filtered load\n        M_in_total = GAMMA * Q['PT'] * C_in\n        \n        # Initialize mass flux for the first segment\n        m_flux_in = M_in_total\n\n        segmental_reabsorptions = {}\n\n        # Sequentially process each segment\n        for s in SEGMENTS:\n            L_s, r_s, V_max_s, K_m_s, Q_s = L[s], r[s], V_max[s], K_m[s], Q[s]\n            \n            m_flux_current = m_flux_in\n            \n            # If no mass flux is entering or no transport capacity, skip integration\n            if m_flux_current == 0 or V_max_s == 0:\n                m_flux_out = m_flux_current\n            else:\n                num_steps = int(L_s / DELTA_X)\n                S_s = 2 * np.pi * r_s\n                \n                # Pre-calculate constant part of the denominator for efficiency\n                denominator_const = GAMMA * Q_s * K_m_s\n\n                # Explicit Forward Euler integration\n                for _ in range(num_steps):\n                    if m_flux_current == 0:\n                        m_flux_current = 0\n                        break # No more reabsorption if all solute is gone\n                    \n                    # Mass reabsorbed over the step dx\n                    reabsorbed_rate = S_s * V_max_s * m_flux_current / (denominator_const + m_flux_current)\n                    delta_m = reabsorbed_rate * DELTA_X\n                    \n                    m_flux_current -= delta_m\n                \n                # Clamp at zero\n                m_flux_out = max(0, m_flux_current)\n\n            # Store segmental reabsorption and update mass flux for the next segment\n            R_s = m_flux_in - m_flux_out\n            segmental_reabsorptions[s] = R_s\n            m_flux_in = m_flux_out\n        \n        # Calculate fractional contributions for the current case\n        phis = []\n        if M_in_total > 0:\n            for s in SEGMENTS:\n                phi_s = round(segmental_reabsorptions[s] / M_in_total, 6)\n                phis.append(phi_s)\n        else:\n            # If no initial load, all fractions are 0\n            phis = [0.0, 0.0, 0.0, 0.0]\n\n        all_results.append(phis)\n\n    # Format the final output string without spaces\n    case_results_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(case_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}