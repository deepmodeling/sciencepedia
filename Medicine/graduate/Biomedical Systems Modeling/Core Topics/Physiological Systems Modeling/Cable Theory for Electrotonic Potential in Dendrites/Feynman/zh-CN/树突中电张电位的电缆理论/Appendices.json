{
    "hands_on_practices": [
        {
            "introduction": "神经元在时间上整合突触输入的能力由其基本的电路特性决定，其中膜时间常数 $\\tau_{m}$ 是一个核心参数。这个练习将带你从基本物理原理出发，探讨细胞膜的比电阻 $R_{m}$ 和比电容 $C_{m}$ 如何共同决定 $\\tau_{m}$ 及其对突触整合带宽的影响，从而加深对神经信号时间滤波特性的理解。",
            "id": "3874780",
            "problem": "一个无源树突段由两种互补的描述来建模：(i) 一个用于时间动态的局部等电位膜片，其中膜遵循电流守恒，即电容电流和泄漏电流之和等于注入电流；(ii) 一根用于空间传播的均匀、半无限长圆柱形电缆，其中轴向电流根据欧姆定律流动，并且膜泄漏沿电缆分布。假设处于线性的、亚阈值状态，没有电压依赖性电导。设比膜电阻为 $R_m$ (单位 $\\Omega\\cdot\\mathrm{m}^2$)，比膜电容为 $C_m$ (单位 $\\mathrm{F}/\\mathrm{m}^2$)，轴向电阻率为 $R_i$ (单位 $\\Omega\\cdot\\mathrm{m}$)，树突半径为 $a$ (单位 $\\mathrm{m}$)。考虑局部膜片对一个小的正弦输入电流的响应：膜电位充当输入的线性滤波器，并将突触整合带宽操作性地定义为局部膜电位对该正弦输入响应的 $-3\\,\\mathrm{dB}$ 截止频率。对于稳态下的空间传播，用电缆参数来表征电紧张长度常数。\n\n现在比较两种独立应用的操纵：\n- 操纵 $\\mathrm{M1}$：将 $C_m$ 替换为 $C_m/2$，同时保持 $R_m$ 不变。\n- 操纵 $\\mathrm{M2}$：将 $R_m$ 替换为 $2R_m$，同时保持 $C_m$ 不变。\n\n从所述的电流守恒和欧姆定律基础出发，并且不考虑任何电压依赖性效应，选择最能描述每次操纵后膜时间常数的定量变化、突触整合带宽的变化方向以及稳态电紧张长度常数的定性变化的选项。\n\nA. 在 $\\mathrm{M1}$ 操纵下，膜时间常数减半，突触整合带宽加倍，稳态电紧张长度常数不变；在 $\\mathrm{M2}$ 操纵下，膜时间常数加倍，突触整合带宽减半，稳态电紧张长度常数增加 $\\sqrt{2}$ 倍。\n\nB. 在 $\\mathrm{M1}$ 操纵下，膜时间常数减半，突触整合带宽减半，稳态电紧张长度常数减少 $1/\\sqrt{2}$ 倍；在 $\\mathrm{M2}$ 操纵下，膜时间常数加倍，突触整合带宽加倍，稳态电紧张长度常数不变。\n\nC. $\\mathrm{M1}$ 和 $\\mathrm{M2}$ 两种操纵都使膜时间常数保持不变，因为 $C_m$ 和 $R_m$ 的效应相互抵消；因此，两种情况下突触整合带宽都不变；在 $\\mathrm{M2}$ 操纵下，稳态电紧张长度常数增加 $\\sqrt{2}$ 倍。\n\nD. 在 $\\mathrm{M1}$ 操纵下，由于充电更快，膜时间常数加倍，突触整合带宽减半，稳态电紧张长度常数增加；在 $\\mathrm{M2}$ 操纵下，膜时间常数减半，突触整合带宽加倍，稳态电紧张长度常数减少。",
            "solution": "问题陈述具有科学依据、提法严谨且客观。它提供了一个无源电缆理论中的标准、可形式化的问题，这是生物医学系统建模和计算神经科学中的一个基本主题。所有必要的参数和物理定律都已陈述，问题没有歧义。该问题是有效的，我将从所提供的第一性原理出发推导解答。\n\n解题步骤结构如下：首先，我将从所述原理中推导出三个关键量的表达式——膜时间常数($\\tau_m$)、突触整合带宽($f_c$)和稳态电紧张长度常数($\\lambda$)。其次，我将分析操纵 $\\mathrm{M1}$ 和 $\\mathrm{M2}$ 对这些量的影响。最后，我将根据这些推导出的结果评估每个选项。\n\n**1. 基本量的推导**\n\n**a. 膜时间常数 ($\\tau_m$)**\n问题描述了一个局部等电位膜片，其中电流守恒成立：注入电流 ($I_{inj}$) 等于电容电流 ($I_C$) 和泄漏电流 ($I_L$) 之和。\n对于一个总电容为 $C$、总电阻为 $R$ 的膜片，电流由以下公式给出：\n- 电容电流：$I_C = C \\frac{dV_m}{dt}$，其中 $V_m$ 是膜电位。\n- 泄漏电流：$I_L = \\frac{V_m}{R}$，假设静息电位为 $0$。\n\n电流守恒方程为：\n$$I_{inj} = I_C + I_L = C \\frac{dV_m}{dt} + \\frac{V_m}{R}$$\n这可以重排为一阶线性常微分方程的标准形式：\n$$RC \\frac{dV_m}{dt} + V_m = R \\cdot I_{inj}$$\n项 $RC$ 是膜时间常数，$\\tau_m$。\n参数 $R$ 和 $C$ 与比膜特性 ($R_m$, $C_m$) 和膜片面积 $A$ 相关。\n- 总电阻 $R = R_m / A$ (单位：$\\Omega = (\\Omega \\cdot \\mathrm{m}^2) / \\mathrm{m}^2$）。\n- 总电容 $C = C_m \\cdot A$ (单位：$\\mathrm{F} = (\\mathrm{F} / \\mathrm{m}^2) \\cdot \\mathrm{m}^2$）。\n因此，时间常数与膜片面积无关：\n$$\\tau_m = RC = \\left(\\frac{R_m}{A}\\right) (C_m A) = R_m C_m$$\n\n**b. 突触整合带宽 ($f_c$)**\n带宽被定义为对正弦输入电流的局部响应的 $-3\\,\\mathrm{dB}$ 截止频率。我们在频域中分析系统的传递函数。设 $V_m(\\omega)$ 和 $I_{inj}(\\omega)$ 分别是电压和电流的傅里叶变换。微分算子 $\\frac{d}{dt}$ 变为乘以 $j\\omega$。控制方程变换为：\n$$j\\omega \\tau_m V_m(\\omega) + V_m(\\omega) = R \\cdot I_{inj}(\\omega)$$\n传递函数 $H(\\omega) = \\frac{V_m(\\omega)}{I_{inj}(\\omega)}$ 为：\n$$H(\\omega) = \\frac{R}{1 + j\\omega \\tau_m}$$\n频率响应的幅值为 $|H(\\omega)| = \\frac{|R|}{|1 + j\\omega \\tau_m|} = \\frac{R}{\\sqrt{1^2 + (\\omega \\tau_m)^2}}$。\n$-3\\,\\mathrm{dB}$ 点是功率下降一半，或幅值下降到其最大值 (直流，$\\omega=0$) 的 $1/\\sqrt{2}$ 处。最大幅值为 $|H(0)| = R$。\n我们设 $|H(\\omega_c)| = \\frac{|H(0)|}{\\sqrt{2}}$：\n$$\\frac{R}{\\sqrt{1 + (\\omega_c \\tau_m)^2}} = \\frac{R}{\\sqrt{2}}$$\n$$1 + (\\omega_c \\tau_m)^2 = 2 \\implies (\\omega_c \\tau_m)^2 = 1 \\implies \\omega_c \\tau_m = 1$$\n截止角频率为 $\\omega_c = 1/\\tau_m$。以赫兹为单位的截止频率是 $f_c = \\omega_c / (2\\pi) = 1/(2\\pi \\tau_m)$。\n因此，突触整合带宽与膜时间常数成反比：\n$$f_c \\propto \\frac{1}{\\tau_m}$$\n\n**c. 稳态电紧张长度常数 ($\\lambda$)**\n对于均匀电缆中的空间传播，我们使用从轴向电流的欧姆定律和分布式泄漏推导出的电缆方程。我们需要找到单位长度膜电阻 ($r_m$) 和单位长度轴向电阻 ($r_a$) 的表达式。对于半径为 $a$ 的圆柱体：\n- 周长为 $2\\pi a$。单位长度的膜电阻为 $r_m = R_m / (2\\pi a)$ (单位：$\\Omega\\cdot\\mathrm{m}$)。\n- 横截面积为 $\\pi a^2$。单位长度的轴向电阻为 $r_a = R_i / (\\pi a^2)$ (单位：$\\Omega/\\mathrm{m}$)。\n稳态电紧张长度常数 $\\lambda$ 定义为：\n$$\\lambda = \\sqrt{\\frac{r_m}{r_a}}$$\n代入 $r_m$ 和 $r_a$ 的表达式：\n$$\\lambda = \\sqrt{\\frac{R_m/(2\\pi a)}{R_i/(\\pi a^2)}} = \\sqrt{\\frac{R_m}{2\\pi a} \\cdot \\frac{\\pi a^2}{R_i}} = \\sqrt{\\frac{R_m a}{2 R_i}}$$\n这个 $\\lambda$ 的表达式不依赖于比膜电容 $C_m$，因为在稳态下($\\partial/\\partial t = 0$)电容是无关紧要的。\n\n**2. 操纵分析**\n\n**操纵 M1: $C_m \\rightarrow C_m' = C_m/2$；$R_m$ 不变。**\n- **时间常数:** $\\tau_m' = R_m C_m' = R_m (C_m/2) = \\frac{1}{2}\\tau_m$。时间常数减半。\n- **带宽:** $f_c' \\propto 1/\\tau_m' = 1/(\\frac{1}{2}\\tau_m) = 2(1/\\tau_m) \\propto 2f_c$。带宽加倍。\n- **长度常数:** $\\lambda' = \\sqrt{\\frac{R_m a}{2 R_i}}$。该值不变，因为它不依赖于 $C_m$。\n\n**操纵 M2: $R_m \\rightarrow R_m'' = 2R_m$；$C_m$ 不变。**\n- **时间常数:** $\\tau_m'' = R_m'' C_m = (2R_m) C_m = 2\\tau_m$。时间常数加倍。\n- **带宽:** $f_c'' \\propto 1/\\tau_m'' = 1/(2\\tau_m) \\propto \\frac{1}{2}f_c$。带宽减半。\n- **长度常数:** $\\lambda'' = \\sqrt{\\frac{R_m'' a}{2 R_i}} = \\sqrt{\\frac{(2R_m) a}{2 R_i}} = \\sqrt{2} \\sqrt{\\frac{R_m a}{2 R_i}} = \\sqrt{2}\\lambda$。长度常数增加 $\\sqrt{2}$ 倍。\n\n**3. 选项评估**\n\n**A. 在 $\\mathrm{M1}$ 操纵下，膜时间常数减半，突触整合带宽加倍，稳态电紧张长度常数不变；在 $\\mathrm{M2}$ 操纵下，膜时间常数加倍，突触整合带宽减半，稳态电紧张长度常数增加 $\\sqrt{2}$ 倍。**\n- $\\mathrm{M1}$ 分析：时间常数减半 (正确)。带宽加倍 (正确)。长度常数不变 (正确)。\n- $\\mathrm{M2}$ 分析：时间常数加倍 (正确)。带宽减半 (正确)。长度常数增加 $\\sqrt{2}$ 倍 (正确)。\n此选项中的所有陈述都与我们的推导一致。\n**结论：正确。**\n\n**B. 在 $\\mathrm{M1}$ 操纵下，膜时间常数减半，突触整合带宽减半，稳态电紧张长度常数减少 $1/\\sqrt{2}$ 倍；在 $\\mathrm{M2}$ 操纵下，膜时间常数加倍，突触整合带宽加倍，稳态电紧张长度常数不变。**\n- $\\mathrm{M1}$ 分析：带宽减半 (不正确，应为加倍)。长度常数减少 (不正确，应为不变)。\n- $\\mathrm{M2}$ 分析：带宽加倍 (不正确，应为减半)。长度常数不变 (不正确，应增加 $\\sqrt{2}$ 倍)。\n**结论：不正确。**\n\n**C. $\\mathrm{M1}$ 和 $\\mathrm{M2}$ 两种操纵都使膜时间常数保持不变，因为 $C_m$ 和 $R_m$ 的效应相互抵消；因此，两种情况下突触整合带宽都不变；在 $\\mathrm{M2}$ 操纵下，稳态电紧张长度常数增加 $\\sqrt{2}$ 倍。**\n- 初始前提，即 $\\tau_m = R_m C_m$ 在任一操纵下都不变，是根本错误的。$\\mathrm{M1}$ 使 $\\tau_m$ 减半，而 $\\mathrm{M2}$ 使 $\\tau_m$ 加倍。\n**结论：不正确。**\n\n**D. 在 $\\mathrm{M1}$ 操纵下，由于充电更快，膜时间常数加倍，突触整合带宽减半，稳态电紧张长度常数增加；在 $\\mathrm{M2}$ 操纵下，膜时间常数减半，突触整合带宽加倍，稳态电紧张长度常数减少。**\n- $\\mathrm{M1}$ 分析：时间常数加倍 (不正确，应为减半)。其理由也是错误的：“充电更快”对应于*更小*的时间常数。带宽减半 (不正确，应为加倍)。长度常数增加 (不正确，应为不变)。\n- $\\mathrm{M2}$ 分析：时间常数减半 (不正确，应为加倍)。带宽加倍 (不正确，应为减半)。长度常数减少 (不正确，应为增加)。\n**结论：不正确。**\n\n基于从第一性原理的系统推导，只有选项 A 准确描述了两种操纵的后果。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了局部膜片的时间特性后，我们转向研究信号如何在空间上传播。此练习聚焦于稳态条件下沿树突的电压衰减，这一过程由长度常数 $\\lambda$ 控制。通过比较改变树突半径与改变内部电阻率对电信号传播的不同影响，我们将量化地理解决定电紧张电位衰减的关键物理因素。",
            "id": "3874757",
            "problem": "考虑一个均匀、被动的树突电缆，其被建模为一个半径为 $a$、胞内电阻率为 $R_{i}$、比膜电阻为 $R_{m}$ 的直圆柱体。假设处于稳态（无时间依赖性），因此膜电容不起作用。该电缆从 $x=0$ 延伸至 $x \\to \\infty$（半无限长），且在 $x=0$ 处，相对于静息电位，膜电位被钳制在一个恒定值 $V_{0}$。请利用电流守恒定律和欧姆定律，推导膜电位沿电缆的稳态空间分布，以及相应的长度常数（用 $a$、$R_{i}$ 和 $R_{m}$ 表示）。从电阻率和电缆几何结构的第一性原理出发，定义单位长度的轴向电阻 $r_{i}$ 和单位长度的膜电阻 $r_{m}$，并用 $r_{i}$ 和长度常数表示在 $x=0$ 处进入电缆的轴向电流。\n\n现在比较两种操作：\n- 情景 A：半径加倍，$a \\to 2a$，保持 $R_{i}$ 和 $R_{m}$ 不变。\n- 情景 B：胞内电阻率减半，$R_{i} \\to R_{i}/2$，保持 $a$ 和 $R_{m}$ 不变。\n\n对于一个固定的钳制电压 $V_{0}$ 以及其他几何结构如上所述，分析在每种情景下，$r_{i}$、长度常数 $\\lambda$ 以及在固定距离 $x=d$ 处的稳态衰减如何变化。然后，利用您推导出的表达式，计算情景 A 与情景 B 在 $x=0$ 处的轴向电流流入之比。将最终比率表示为一个无单位的纯数。无需四舍五入。",
            "solution": "该问题经检验具有科学依据，是适定的、客观且完整的。这是生物医学系统建模中的一个标准问题，特别是关于电缆理论在神经元树突中的应用。所有必要的参数和条件都已提供，以获得唯一解。\n\n解答过程分为三个部分。首先，我们从第一性原理推导膜电位稳态、长度常数和输入电流的基本方程。其次，我们分析两种拟议情景对这些推导量的影响。第三，我们计算所要求的输入电流之比。\n\n**第一部分：基本方程的推导**\n\n我们将树突电缆建模为一个半径为 $a$、胞内电阻率为 $R_i$ 的圆柱体。单位长度的轴向电阻 $r_i$ 是电缆单位长度的胞内电阻。对于长度为 $L$、横截面积为 $A$、电阻率为 $\\rho$ 的电阻，其电阻为 $R = \\rho L / A$。因此，单位长度的电阻为 $\\rho/A$。在我们的情况中，横截面积为 $A = \\pi a^2$，电阻率为 $R_i$。因此，\n$$r_i = \\frac{R_i}{\\pi a^2}$$\n$r_i$ 的单位是 $\\Omega/\\text{m}$。\n\n膜具有比膜电阻 $R_m$（单位：$\\Omega \\cdot \\text{m}^2$）。长度为 $\\Delta x$ 的一段电缆的膜电阻与该段的表面积成反比，表面积为 $2\\pi a \\Delta x$。这段电缆的总膜电导为 $G_m = (2\\pi a \\Delta x) / R_m$。单位长度的膜电导为 $g_m = G_m / \\Delta x = 2\\pi a / R_m$。单位长度的膜电阻 $r_m$ 定义为单位长度电导的倒数：\n$$r_m = \\frac{1}{g_m} = \\frac{R_m}{2\\pi a}$$\n$r_m$ 的单位是 $\\Omega \\cdot \\text{m}$。\n\n现在，我们推导稳态电缆方程。设 $V(x)$ 为相对于静息电位的膜电位，$I_i(x)$ 为沿电缆内部的轴向电流。根据欧姆定律应用于长度为 $dx$ 的微小段，沿轴向电阻的电压降为 $dV = -I_i(x) r_i dx$。这给出了我们的第一个微分关系：\n$$\\frac{dV}{dx} = -I_i r_i \\quad (1)$$\n根据电流守恒定律，在 $dx$ 段上轴向电流的变化量 $dI_i$ 必须等于通过膜泄漏出去的电流 $I_m$。单位长度的膜电流为 $i_m = V(x)/r_m$。因此，对于 $dx$ 段，泄漏电流为 $I_m = i_m dx = (V/r_m) dx$。轴向电流的变化量是 $dI_i = I_i(x) - I_i(x+dx)$，所以 $dI_i = -I_m = -(V/r_m) dx$。这给出了我们的第二个微分关系：\n$$\\frac{dI_i}{dx} = -\\frac{V}{r_m} \\quad (2)$$\n为了得到关于 $V(x)$ 的单一方程，我们将方程 (1) 对 $x$ 求导：\n$$\\frac{d^2V}{dx^2} = -r_i \\frac{dI_i}{dx}$$\n将方程 (2) 代入此表达式，得到：\n$$\\frac{d^2V}{dx^2} = -r_i \\left(-\\frac{V}{r_m}\\right) = \\frac{r_i}{r_m} V$$\n这就是稳态电缆方程。我们定义长度常数 $\\lambda$ 使得 $\\lambda^2 = r_m / r_i$。方程变为：\n$$\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$$\n这个二阶线性常微分方程的通解是：\n$$V(x) = C_1 \\exp(x/\\lambda) + C_2 \\exp(-x/\\lambda)$$\n我们应用半无限长电缆（$x \\in [0, \\infty)$）的边界条件：\n1. 在 $x=0$ 处电位被钳制：$V(0) = V_0$。\n2. 当 $x \\to \\infty$ 时，电位必须衰减到静息电位（即 $V \\to 0$）。这是因为电缆是被动的，并且在无穷远处没有能量源。\n\n第二个边界条件要求 $C_1 = 0$，因为当 $x \\to \\infty$ 时，$\\exp(x/\\lambda)$ 会无界增长。解简化为 $V(x) = C_2 \\exp(-x/\\lambda)$。应用第一个边界条件，$V(0) = V_0 = C_2 \\exp(0) = C_2$。\n因此，膜电位的稳态空间分布为：\n$$V(x) = V_0 \\exp(-x/\\lambda)$$\n长度常数 $\\lambda$ 可以用基本参数 $a$、$R_i$ 和 $R_m$ 表示：\n$$\\lambda = \\sqrt{\\frac{r_m}{r_i}} = \\sqrt{\\frac{R_m/(2\\pi a)}{R_i/(\\pi a^2)}} = \\sqrt{\\frac{R_m}{2\\pi a} \\frac{\\pi a^2}{R_i}} = \\sqrt{\\frac{a R_m}{2 R_i}}$$\n进入电缆在 $x=0$ 处的轴向电流，记为 $I_{in}$，即 $I_i(0)$。根据方程 (1)，$I_i(x) = -\\frac{1}{r_i}\\frac{dV}{dx}$。我们计算 $V(x)$ 的导数：\n$$\\frac{dV}{dx} = V_0 \\frac{d}{dx} \\exp(-x/\\lambda) = -\\frac{V_0}{\\lambda} \\exp(-x/\\lambda)$$\n所以，轴向电流是：\n$$I_i(x) = -\\frac{1}{r_i} \\left(-\\frac{V_0}{\\lambda} \\exp(-x/\\lambda)\\right) = \\frac{V_0}{r_i \\lambda} \\exp(-x/\\lambda)$$\n在 $x=0$ 处的输入电流是：\n$$I_{in} = I_i(0) = \\frac{V_0}{r_i \\lambda}$$\n\n**第二部分：情景分析**\n\n设初始参数用下标‘0’表示：$a_0$、$R_{i0}$、$R_{m0}$。初始的推导量为：\n$r_{i0} = \\frac{R_{i0}}{\\pi a_0^2}$\n$\\lambda_0 = \\sqrt{\\frac{a_0 R_{m0}}{2 R_{i0}}}$\n$I_{in0} = \\frac{V_0}{r_{i0} \\lambda_0}$\n\n**情景 A：$a_A = 2a_0$，$R_i$ 和 $R_m$ 固定。**\n- 单位长度轴向电阻：\n  $r_{iA} = \\frac{R_{i0}}{\\pi a_A^2} = \\frac{R_{i0}}{\\pi (2a_0)^2} = \\frac{1}{4} \\frac{R_{i0}}{\\pi a_0^2} = \\frac{1}{4} r_{i0}$。\n- 长度常数：\n  $\\lambda_A = \\sqrt{\\frac{a_A R_{m0}}{2 R_{i0}}} = \\sqrt{\\frac{(2a_0) R_{m0}}{2 R_{i0}}} = \\sqrt{2} \\sqrt{\\frac{a_0 R_{m0}}{2 R_{i0}}} = \\sqrt{2} \\lambda_0$。\n- 在 $x=d$ 处的衰减：电压为 $V(d) = V_0 \\exp(-d/\\lambda)$。由于 $\\lambda_A > \\lambda_0$，指数 $-d/\\lambda_A$ 的负值比 $-d/\\lambda_0$ 小。这意味着 $\\exp(-d/\\lambda_A) > \\exp(-d/\\lambda_0)$，所以衰减更弱（在距离 $d$ 处电压更高）。\n- 输入电流：\n  $I_{inA} = \\frac{V_0}{r_{iA} \\lambda_A} = \\frac{V_0}{(\\frac{1}{4}r_{i0})(\\sqrt{2}\\lambda_0)} = \\frac{4}{\\sqrt{2}} \\frac{V_0}{r_{i0}\\lambda_0} = 2\\sqrt{2} I_{in0}$。\n\n**情景 B：$R_{iB} = R_{i0}/2$，$a$ 和 $R_m$ 固定。**\n- 单位长度轴向电阻：\n  $r_{iB} = \\frac{R_{iB}}{\\pi a_0^2} = \\frac{R_{i0}/2}{\\pi a_0^2} = \\frac{1}{2} \\frac{R_{i0}}{\\pi a_0^2} = \\frac{1}{2} r_{i0}$。\n- 长度常数：\n  $\\lambda_B = \\sqrt{\\frac{a_0 R_{m0}}{2 R_{iB}}} = \\sqrt{\\frac{a_0 R_{m0}}{2 (R_{i0}/2)}} = \\sqrt{\\frac{a_0 R_{m0}}{R_{i0}}} = \\sqrt{2} \\sqrt{\\frac{a_0 R_{m0}}{2 R_{i0}}} = \\sqrt{2} \\lambda_0$。\n- 在 $x=d$ 处的衰减：由于 $\\lambda_B = \\lambda_A$，与基准情况相比，衰减的变化与情景 A 相同。衰减更弱。\n- 输入电流：\n  $I_{inB} = \\frac{V_0}{r_{iB} \\lambda_B} = \\frac{V_0}{(\\frac{1}{2}r_{i0})(\\sqrt{2}\\lambda_0)} = \\frac{2}{\\sqrt{2}} \\frac{V_0}{r_{i0}\\lambda_0} = \\sqrt{2} I_{in0}$。\n\n**第三部分：最终计算**\n\n问题要求计算情景 A 与情景 B 在 $x=0$ 处的轴向电流流入之比。\n$$\\frac{I_{inA}}{I_{inB}} = \\frac{2\\sqrt{2} I_{in0}}{\\sqrt{2} I_{in0}} = 2$$\n该比率是一个纯数。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "真实的树突并非理想的均匀圆柱体，其半径常沿长度变化，这给解析分析带来了挑战。本练习旨在连接理想化理论与生物学现实，通过引入一个半径线性变化的锥形树突模型来解决这一问题。我们将构建一个数值方法来求解这种更复杂情况下的电缆方程，展示计算工具在现代神经科学研究中的强大作用。",
            "id": "3874804",
            "problem": "考虑一个无源树突电缆段，其空间坐标为 $x \\in [0,L]$，胞质轴向电阻率为 $r_i$ (单位为 $\\Omega \\cdot \\mathrm{m}$)，单位膜电导为 $g_m$ (单位为 $\\mathrm{S} \\cdot \\mathrm{m}^{-2}$)，半径呈线性变化 $r(x) = r_0 + s x$，其中 $r_0$ 和 $s$ 是常数，单位分别为 $\\mathrm{m}$ 和 $\\mathrm{m}^{-1}$。假设系统处于稳态，在电缆上的位置 $x_0 \\in (0,L)$ 处有幅度为 $I_0$ (单位为 $\\mathrm{A}$) 的点电流注入，近端存在 Dirichlet 边界条件 $V(0) = 0$ (代表在胞体处的电压钳)，远端存在密封端的 Neumann 边界条件 $\\frac{dV}{dx}(L) = 0$ (代表在尖端没有轴向电流流出)。该电缆是无源的，泄漏反转电位设为 $0$，因此膜电流密度与膜电压成正比。\n\n您需要仅从轴向电流守恒、轴向电流流动的欧姆定律以及膜泄漏电流密度与膜电压成正比的定义出发，推导并实现一种数值方法，以计算在指定几何形状和边界条件下沿电缆的稳态电压分布 $V(x)$。您必须在均匀空间网格上使用数值求积来构建计算解，而不依赖于闭式简便公式。特别地，您需要建立在 $x=x_0$ 处带有分布源的适当的二阶边值问题，确定一个遵循边界条件的、有原则的计算策略，并加以实现。\n\n作为比较基准，定义一个均匀半径的预测，方法是将线性变化的半径 $r(x)$ 替换为空间平均值 $\\bar{r} = r_0 + \\frac{1}{2} s L$。使用相同的物理参数（$r_i$、$g_m$、$I_0$、$L$、$x_0$）和相同的边界条件，使用相同的数值求积策略，计算均匀半径电缆对应的稳态电压分布 $V_\\mathrm{uni}(x)$。\n\n您的程序必须：\n- 将电缆离散化为一个包含 $N$ 个点的均匀网格，并使用数值求积来积分构建计算解所需的齐次方程，该计算解在点源注入下，使用具有物理合理性的匹配条件。\n- 计算锥形电缆的 $V(x)$ 和均匀半径参考的 $V_\\mathrm{uni}(x)$。\n- 使用网格上的均方根 (RMS) 差量化 $V(x)$ 和 $V_\\mathrm{uni}(x)$ 之间的差异：\n$$ \\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(V(x_i) - V_\\mathrm{uni}(x_i)\\right)^2}.$$\n- 以伏特 (V) 为单位表示 RMS 差异。\n\n使用以下参数集测试套件，每个参数集均指定为 $\\left(r_i, g_m, r_0, s, L, x_0, I_0\\right)$，所有量均采用国际单位制 (SI) 单位：\n- 测试 1：$\\left(1.0, 0.1, 1.0 \\times 10^{-6}, -1.2 \\times 10^{-3}, 5.0 \\times 10^{-4}, 2.5 \\times 10^{-4}, 1.0 \\times 10^{-12}\\right)$。\n- 测试 2：$\\left(1.0, 0.1, 1.0 \\times 10^{-6}, 0.0, 5.0 \\times 10^{-4}, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-12}\\right)$。\n- 测试 3：$\\left(1.5, 0.05, 2.0 \\times 10^{-6}, -1.5 \\times 10^{-3}, 1.0 \\times 10^{-3}, 9.0 \\times 10^{-4}, 5.0 \\times 10^{-12}\\right)$。\n- 测试 4：$\\left(0.8, 0.2, 0.8 \\times 10^{-6}, 5.0 \\times 10^{-4}, 4.0 \\times 10^{-4}, 1.0 \\times 10^{-5}, 2.0 \\times 10^{-12}\\right)$。\n- 测试 5：$\\left(1.0, 0.15, 1.0 \\times 10^{-6}, -2.0 \\times 10^{-4}, 2.0 \\times 10^{-3}, 1.0 \\times 10^{-3}, 3.0 \\times 10^{-12}\\right)$。\n\n科学真实性约束：\n- 确保对所有 $x \\in [0,L]$ 都有 $r(x) = r_0 + s x > 0$。\n- 使用足够精细的网格，以可靠地解析给定物理尺度内的空间电压分布。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试 1 到 5 的 RMS 差异，格式为一个用方括号括起来的逗号分隔列表（例如，$[d_1,d_2,d_3,d_4,d_5]$），其中每个 $d_k$ 是按规定计算的浮点数，单位为 V。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于生物物理电缆理论的原理，作为一个线性的二阶边值问题是适定的，并且其参数设定在物理现实的范围内。通过选择一个包含 $N=2001$ 个点的网格，满足了使用“足够精细的网格”的要求，这为给定的长度尺度提供了足够的空间分辨率。所有测试用例都满足物理约束 $r(x)>0$。因此，我们可以继续进行求解。\n\n### 1. 控制方程的推导\n\n无源树突电缆中的稳态电压分布 $V(x)$ 受电流守恒原理控制。考虑电缆在 $x$ 和 $x+dx$ 之间的一个小段。沿此段的轴向电流 $I_a(x)$ 的变化必须与流出膜的电流 $dI_m$ 相平衡。\n\n根据欧姆定律，轴向电流 $I_a(x)$ 由电压梯度驱动：\n$$ \\frac{dV}{dx} = -I_a(x) R_a(x) $$\n其中 $R_a(x)$ 是单位长度的轴向电阻。对于一个胞质电阻率为 $r_i$、半径为 $r(x)$ 的圆柱段， $R_a(x) = \\frac{r_i}{A(x)} = \\frac{r_i}{\\pi r(x)^2}$，其中 $A(x)$ 是横截面积。因此，轴向电流为：\n$$ I_a(x) = -\\frac{\\pi r(x)^2}{r_i} \\frac{dV}{dx} $$\n\n单位长度的膜电流 $I_m'(x)$ 由膜电流密度 $j_m(x)$ 与周长 $2\\pi r(x)$ 的乘积给出。问题陈述指出泄漏反转电位为 $0$，所以 $j_m(x) = g_m V(x)$，其中 $g_m$ 是单位膜电导。因此：\n$$ I_m'(x) = 2 \\pi r(x) g_m V(x) $$\n\n电流守恒表明 $\\frac{dI_a}{dx} = -I_m'(x)$。对 $I_a(x)$ 的表达式求导并代入 $I_m'(x)$ 可得：\n$$ \\frac{d}{dx} \\left( -\\frac{\\pi r(x)^2}{r_i} \\frac{dV}{dx} \\right) = -2 \\pi r(x) g_m V(x) $$\n消去项并重新整理，我们得到半径可变的无源电缆的稳态电缆方程：\n$$ \\frac{d}{dx} \\left( r(x)^2 \\frac{dV}{dx} \\right) = 2 r_i g_m r(x) V(x) $$\n展开导数并使用 $r(x) = r_0 + sx$（这意味着 $r'(x) = s$），我们得到：\n$$ r(x) \\frac{d^2V}{dx^2} + 2s \\frac{dV}{dx} - 2 r_i g_m V(x) = 0 $$\n这是一个带有可变系数的二阶线性齐次常微分方程 (ODE)。该方程在 $x \\in [0, L]$ 上成立，但在电流注入点 $x_0$ 处除外。\n\n在 $x=x_0$ 处幅度为 $I_0$ 的点电流注入被建模为一个 Dirac delta 函数源项。完整的边值问题 (BVP) 是：\n$$ -\\frac{d}{dx} \\left( \\frac{\\pi r(x)^2}{r_i} \\frac{dV}{dx} \\right) + 2 \\pi r(x) g_m V(x) = I_0 \\delta(x-x_0) $$\n服从以下边界条件：\n$$ V(0) = 0 \\quad (\\text{在 } x=0 \\text{ 处的 Dirichlet 条件}) $$\n$$ \\frac{dV}{dx}(L) = 0 \\quad (\\text{在 } x=L \\text{ 处的 Neumann 条件}) $$\n\n### 2. 数值解法策略\n\n该问题将使用叠加法求解，这是处理带点源的线性边值问题的一种标准技术（与格林函数法相关）。解 $V(x)$ 由齐次常微分方程的线性无关解构造而成。\n\n电压 $V(x)$ 必须处处连续，包括在 $x_0$ 处。对完整的 BVP 在一个无穷小区间 $[x_0-\\epsilon, x_0+\\epsilon]$ 上积分，揭示了电压导数的一个跳跃条件。根据电流守恒，在注入点 $x_0$ 处，流入的轴向电流加上注入电流必须等于流出的轴向电流：$I_a(x_0^-) + I_0 = I_a(x_0^+)$。这导致 $I_a(x_0^+) - I_a(x_0^-) = I_0$。代入轴向电流的表达式 $I_a(x) = -\\frac{\\pi r(x)^2}{r_i} \\frac{dV}{dx}$，我们得到：\n$$ \\left(-\\frac{\\pi r(x_0)^2}{r_i} \\frac{dV}{dx}\\bigg|_{x_0^+}\\right) - \\left(-\\frac{\\pi r(x_0)^2}{r_i} \\frac{dV}{dx}\\bigg|_{x_0^-}\\right) = I_0 $$\n整理后得到正确的跳跃条件：\n$$ \\frac{dV}{dx}\\bigg|_{x_0^+} - \\frac{dV}{dx}\\bigg|_{x_0^-} = -\\frac{I_0 r_i}{\\pi r(x_0)^2} $$\n\n为构造解，我们寻找齐次方程的两个基本解 $u_1(x)$ 和 $u_2(x)$：\n1.  $u_1(x)$ 满足左边界条件：$u_1(0)=0$。我们可以通过从 $x=0$ 开始积分齐次 ODE 得到，初始条件为 $u_1(0)=0$ 和 $u_1'(0)=1$。\n2.  $u_2(x)$ 满足右边界条件：$u_2'(L)=0$。我们可以通过从 $x=L$ 反向积分齐次 ODE 得到，“初始”条件为 $u_2(L)=1$ 和 $u_2'(L)=0$。\n\n最终解 $V(x)$ 随后被构造成这些基本解的分段组合：\n$$ V(x) = \\begin{cases} A \\, u_1(x) & 0 \\le x \\le x_0 \\\\ B \\, u_2(x) & x_0  x \\le L \\end{cases} $$\n这种形式自动满足了在 $x=0$ 和 $x=L$ 处的边界条件。未知系数 $A$ 和 $B$ 通过在 $x=x_0$ 处应用匹配条件来确定：\n1.  电压连续性：$V(x_0^-) = V(x_0^+)$ 意味着 $A u_1(x_0) = B u_2(x_0)$。\n2.  导数跳跃：$V'(x_0^+) - V'(x_0^-) = -\\frac{I_0 r_i}{\\pi r(x_0)^2}$ 意味着 $B u_2'(x_0) - A u_1'(x_0) = -\\frac{I_0 r_i}{\\pi r(x_0)^2}$。\n\n这给出了一个关于 $A$ 和 $B$ 的 $2 \\times 2$ 线性系统：\n$$ \\begin{pmatrix} u_1(x_0)  -u_2(x_0) \\\\ -u_1'(x_0)  u_2'(x_0) \\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{I_0 r_i}{\\pi r(x_0)^2} \\end{pmatrix} $$\n求解该系统得到 $A$ 和 $B$，从而可以构建完整的解 $V(x)$。\n\n### 3. 数值实现\n\n为实现此策略，我们将二阶齐次 ODE 转换为一个由两个一阶 ODE 组成的系统。令 $\\mathbf{y}(x) = [V(x), V'(x)]^T$。该系统为：\n$$ \\frac{d\\mathbf{y}}{dx} = \\begin{pmatrix} y_2 \\\\ \\frac{1}{r(x)}(-2s y_2 + 2 r_i g_m y_1) \\end{pmatrix} $$\n我们使用一个数值 ODE 求解器 (`scipy.integrate.solve_ivp`) 在一个包含 $N=2001$ 个点的均匀空间网格上求得解 $u_1(x)$ 和 $u_2(x)$。\n-   `u1_sol` 通过从 $x=0$ 开始，以初始条件 $\\mathbf{y}(0) = [0, 1]^T$ 向前积分得到。\n-   `u2_sol` 通过从 $x=L$ 开始，以初始条件 $\\mathbf{y}(L) = [1, 0]^T$ 向后积分得到。\n\n这些数值解提供了在最接近 $x_0$ 的网格点上 $u_1, u_1', u_2, u_2'$ 的值，然后用这些值来求解 $A$ 和 $B$。\n\n### 4. 均匀半径参考与差异\n\n对于均匀半径基准，我们将锥形半径 $r(x)$ 替换为其空间平均值 $\\bar{r} = r_0 + \\frac{1}{2}sL$。应用相同的数值程序，但使用对应于均匀电缆的简化 ODE（即，设置 $s=0$ 并使用 $r_0 = \\bar{r}$）。计算电压分布 $V_{\\text{uni}}(x)$。锥形解和均匀解之间的差异通过均方根 (RMS) 差进行量化：\n$$ \\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(V(x_i) - V_\\mathrm{uni}(x_i)\\right)^2} $$\n\n将此整个过程应用于问题陈述中提供的每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef compute_voltage_profile(params, N_POINTS=2001):\n    \"\"\"\n    Computes the steady-state voltage profile for a passive cable.\n\n    This function implements a superposition (Green's function) method to solve\n    the second-order boundary value problem for a tapered or uniform cable with\n    a single point current injection.\n\n    Args:\n        params (tuple): A tuple containing the physical parameters:\n            (ri, gm, r0, s, L, x0, I0).\n        N_POINTS (int): The number of points in the spatial discretization grid.\n\n    Returns:\n        numpy.ndarray: An array of voltage values at each grid point.\n    \"\"\"\n    ri, gm, r0, s, L, x0, I0 = params\n    x_grid = np.linspace(0, L, N_POINTS)\n\n    def radius(x):\n        return r0 + s * x\n\n    # Define the system of first-order ODEs y' = f(t, y) where y = [V, V']\n    # t is used instead of x as the independent variable for the solver.\n    def ode_system(t, y):\n        r_t = radius(t)\n        # Avoid division by zero if r(t) is ever zero\n        if r_t == 0:\n            # This case should not be reached due to problem constraints\n            raise ValueError(\"Radius must be positive.\")\n        \n        # y[0] is V, y[1] is dV/dx\n        # dV/dx = y[1]\n        # dV'/dx = (-2*s/r)*V' + (2*ri*gm/r)*V\n        dydt = [\n            y[1],\n            (-2.0 * s / r_t) * y[1] + (2.0 * ri * gm / r_t) * y[0]\n        ]\n        return dydt\n\n    # 1. Compute u1(x): homogeneous solution satisfying u1(0)=0, u1'(0)=1\n    y0_1 = [0.0, 1.0]\n    sol_u1 = solve_ivp(ode_system, [0, L], y0_1, t_eval=x_grid, method='RK45')\n    u1 = sol_u1.y[0]\n    u1_prime = sol_u1.y[1]\n\n    # 2. Compute u2(x): homogeneous solution satisfying u2(L)=1, u2'(L)=0\n    y0_2 = [1.0, 0.0]\n    # Integrate backward from L to 0\n    sol_u2 = solve_ivp(ode_system, [L, 0], y0_2, t_eval=np.flip(x_grid), method='RK45')\n    # Flip the results to align with x_grid\n    u2 = np.flip(sol_u2.y[0])\n    u2_prime = np.flip(sol_u2.y[1])\n\n    # 3. Find the grid index for the injection point x0\n    i0 = np.argmin(np.abs(x_grid - x0))\n    x0_grid = x_grid[i0]\n\n    # 4. Get values of u1, u1', u2, u2' at x0\n    u1_at_x0 = u1[i0]\n    u1_prime_at_x0 = u1_prime[i0]\n    u2_at_x0 = u2[i0]\n    u2_prime_at_x0 = u2_prime[i0]\n\n    # 5. Set up and solve the 2x2 linear system for coefficients A and B\n    # [ u1(x0)     -u2(x0)   ] [ A ] = [ 0                      ]\n    # [ -u1'(x0)   u2'(x0)   ] [ B ] = [ -I0*ri/(pi*r(x0)^2)    ]\n    \n    # Check if radius at injection is positive\n    r_at_x0 = radius(x0_grid)\n    if r_at_x0 == 0:\n        raise ValueError(\"Radius at injection point must be positive.\")\n\n    A_matrix = np.array([\n        [u1_at_x0, -u2_at_x0],\n        [-u1_prime_at_x0, u2_prime_at_x0]\n    ])\n    \n    b_vector = np.array([\n        0.0,\n        -(I0 * ri) / (np.pi * r_at_x0**2)\n    ])\n\n    try:\n        coeffs = np.linalg.solve(A_matrix, b_vector)\n        A, B = coeffs[0], coeffs[1]\n    except np.linalg.LinAlgError:\n        # This should not happen for a well-posed problem.\n        # It would imply the homogeneous solutions are linearly dependent.\n        return np.full_like(x_grid, np.nan)\n\n\n    # 6. Construct the final solution V(x)\n    V = np.zeros_like(x_grid)\n    V[:i0+1] = A * u1[:i0+1]\n    V[i0+1:] = B * u2[i0+1:]\n    \n    return V\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and compute RMS differences.\n    \"\"\"\n    # Test suite: (ri, gm, r0, s, L, x0, I0) in SI units\n    test_cases = [\n        (1.0, 0.1, 1.0e-6, -1.2e-3, 5.0e-4, 2.5e-4, 1.0e-12),\n        (1.0, 0.1, 1.0e-6, 0.0, 5.0e-4, 1.0e-5, 1.0e-12),\n        (1.5, 0.05, 2.0e-6, -1.5e-3, 1.0e-3, 9.0e-4, 5.0e-12),\n        (0.8, 0.2, 0.8e-6, 5.0e-4, 4.0e-4, 1.0e-5, 2.0e-12),\n        (1.0, 0.15, 1.0e-6, -2.0e-4, 2.0e-3, 1.0e-3, 3.0e-12),\n    ]\n\n    results = []\n    \n    # Use a fixed number of grid points for all simulations\n    N_POINTS = 2001\n\n    for case in test_cases:\n        ri, gm, r0, s, L, x0, I0 = case\n\n        # --- Tapered Cable Calculation ---\n        tapered_params = (ri, gm, r0, s, L, x0, I0)\n        V_tapered = compute_voltage_profile(tapered_params, N_POINTS)\n\n        # --- Uniform-Radius Reference Calculation ---\n        r_bar = r0 + 0.5 * s * L\n        # For the uniform case, s=0 and r0 is set to r_bar.\n        uniform_params = (ri, gm, r_bar, 0.0, L, x0, I0)\n        V_uniform = compute_voltage_profile(uniform_params, N_POINTS)\n\n        # --- RMS Difference Calculation ---\n        # Ensure results are valid before calculating RMS\n        if np.any(np.isnan(V_tapered)) or np.any(np.isnan(V_uniform)):\n            rms_diff = np.nan\n        else:\n            rms_diff = np.sqrt(np.mean((V_tapered - V_uniform)**2))\n        \n        results.append(rms_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}