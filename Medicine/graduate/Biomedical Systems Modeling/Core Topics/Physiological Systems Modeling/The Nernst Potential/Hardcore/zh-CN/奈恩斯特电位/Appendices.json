{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握能斯特势，第一步是能够从基本原理出发进行推导和计算。本练习将指导您从电化学势平衡的条件出发，推导出氯离子的能斯特势，并在给定的生理条件下计算其数值。这个基础练习旨在巩固您对理想稀溶液模型中电化学驱动力的理解。",
            "id": "3938291",
            "problem": "一个单室神经元膜主要对氯离子具有通透性。设 $\\phi_i$ 和 $\\phi_o$ 分别表示细胞内和细胞外的电势，并设 $E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$ 为使氯离子净通量为零的跨膜电势差。对于一种可渗透的离子，在平衡状态下，其在膜两侧的电化学势相等。假设为理想稀溶液，因此化学活度等于摩尔浓度。细胞内和细胞外的氯离子浓度分别为 $[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$ 和 $[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$。绝对温度为 $T = 310\\,\\mathrm{K}$，氯离子的化合价为 $z = -1$。使用气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和法拉第常数 $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。\n\n从化学势的定义和电化学平衡的条件出发，推导 $E_{\\mathrm{Cl}^-}$ 的表达式（用给定物理量表示），并根据所提供的数据计算其数值。最终答案以毫伏为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确、客观且完整。它是一个生物物理化学中的标准练习，要求推导和计算氯离子的能斯特电势。所有必要的数据和常数都已提供，并且条件在物理和生物学上都是现实的。\n\n控制可渗透离子跨膜平衡分布的基本原理是其在膜两侧的电化学势相等。溶液中离子种类 $j$ 的电化学势 $\\tilde{\\mu}_j$ 由其化学势和每摩尔的电势能之和给出：\n$$ \\tilde{\\mu}_j = \\mu_j^0 + RT \\ln(a_j) + z_j F \\phi $$\n其中 $\\mu_j^0$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$a_j$ 是离子的化学活度，$z_j$ 是其化合价（电荷数），$F$ 是法拉第常数，$\\phi$ 是局部电势。\n\n问题指明系统对于氯离子 ($\\mathrm{Cl}^-$) 处于平衡状态。因此，细胞内侧 ($i$) 的氯离子电化学势必须等于细胞外侧 ($o$) 的电化学势：\n$$ \\tilde{\\mu}_{\\mathrm{Cl}^-, i} = \\tilde{\\mu}_{\\mathrm{Cl}^-, o} $$\n代入两侧的电化学势表达式，得到：\n$$ \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n标准化学势 $\\mu_{\\mathrm{Cl}^-}^0$ 是离子在给定溶剂和温度下的固有属性，因此在两侧是相同的，可以消去：\n$$ RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n问题陈述假设为理想稀溶液，这意味着化学活度 $a_j$ 可以用摩尔浓度 $[\\mathrm{Cl}^-]_j$ 来近似。因此，$a_i = [\\mathrm{Cl}^-]_i$ 且 $a_o = [\\mathrm{Cl}^-]_o$。方程变为：\n$$ RT \\ln([\\mathrm{Cl}^-]_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln([\\mathrm{Cl}^-]_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\n我们需要求解氯离子的能斯特电势 $E_{\\mathrm{Cl}^-}$，其定义为平衡时的跨膜电势差，$E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$。重新整理方程以求解该电势差：\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln([\\mathrm{Cl}^-]_o) - RT \\ln([\\mathrm{Cl}^-]_i) $$\n利用对数的性质 $\\ln(x) - \\ln(y) = \\ln(x/y)$：\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\n分离出电势差 $\\phi_i - \\phi_o$，得到氯离子的能斯特方程：\n$$ E_{\\mathrm{Cl}^-} = \\phi_i - \\phi_o = \\frac{RT}{z_{\\mathrm{Cl}^-} F} \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\n现在，我们将给定的数值代入这个推导出的表达式中：\n细胞内氯离子浓度，$[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$。\n细胞外氯离子浓度，$[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$。\n绝对温度，$T = 310\\,\\mathrm{K}$。\n氯离子的化合价，$z = z_{\\mathrm{Cl}^-} = -1$。\n气体常数，$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n法拉第常数，$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$。\n\n浓度比是一个无量纲的量：\n$$ \\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i} = \\frac{120\\,\\mathrm{mM}}{5\\,\\mathrm{mM}} = 24 $$\n将所有数值代入能斯特方程：\n$$ E_{\\mathrm{Cl}^-} = \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(-1) \\times (96485.33212\\,\\mathrm{C\\,mol^{-1}})} \\ln(24) $$\n单位 $\\mathrm{J\\,C^{-1}}$ 等同于伏特 ($\\mathrm{V}$)。我们来计算数值：\n$$ E_{\\mathrm{Cl}^-} = -\\frac{2577.48341158}{96485.33212} \\times \\ln(24) \\,\\mathrm{V} $$\n$$ E_{\\mathrm{Cl}^-} \\approx -(0.0267140866\\,\\mathrm{V}) \\times (3.17805383) $$\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386\\,\\mathrm{V} $$\n问题要求答案以毫伏 ($\\mathrm{mV}$) 为单位，并四舍五入到四位有效数字。为了从伏特转换为毫伏，我们乘以 $1000$：\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386 \\times 1000\\,\\mathrm{mV} = -84.918386\\,\\mathrm{mV} $$\n四舍五入到四位有效数字，我们得到：\n$$ E_{\\mathrm{Cl}^-} \\approx -84.92\\,\\mathrm{mV} $$\n这个负值表明，在平衡状态下，细胞内部相对于外部是带负电的，这是为了抵消化学梯度，该梯度有利于氯离子从较高浓度的细胞外流入较低浓度的细胞内。",
            "answer": "$$\n\\boxed{-84.92}\n$$"
        },
        {
            "introduction": "在真实的生理系统中，离子浓度常常受到缓冲剂的严格调控，这为计算能斯特势带来了新的挑战。本练习以细胞内钙离子为例，探讨了在存在快速缓冲的情况下，如何区分总离子浓度和自由离子浓度，并计算出真实的钙离子平衡电位。通过这个练习，您将深刻理解为何在应用能斯特方程时，必须使用自由离子的活度或浓度。",
            "id": "3938258",
            "problem": "一个单室神经元制剂浸泡在含有钙离子且不含螯合剂的细胞外溶液中，而胞质溶胶中含有一种具有一对一结合化学计量的快速钙缓冲剂。假设细胞膜对钙离子具有完全选择性。细胞外溶液不含钙螯合剂，钙浓度为 $[{\\text{Ca}^{2+}}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$。细胞内溶液的总螯合剂浓度为 $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$，总钙浓度为 $[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$。缓冲反应为\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B,\n$$\n其基于活度的解离常数为 $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$，定义为\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}},\n$$\n其中 $a_{i}$ 表示物质 $i$ 的活度。\n\n假设如下：\n- 活度与浓度的关系为 $a_{i} = \\gamma_{i} [i]$，其中 $\\gamma_{i}$ 是物质 $i$ 的活度系数。\n- 细胞内活度系数满足 $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$，$\\gamma_{B,\\text{in}} = 1$ 以及 $\\gamma_{\\text{Ca}B,\\text{in}} = 1$。\n- 细胞外钙的活度系数为 $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$。\n- 忽略螯合剂的质子化或竞争性结合以及任何其他离子相互作用；将缓冲剂视为快速反应且处于平衡状态。\n\n利用平衡状态下钙离子在膜两侧的电化学势相等，推导并计算钙的平衡膜电位 $E_{\\text{Ca}^{2+}}$，使用两侧的游离钙活度（而非总浓度）。使用气体常数 $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$，绝对温度 $T = 310 \\ \\text{K}$，法拉第常数 $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$，以及钙的化合价 $z = 2$。以毫伏为单位表示最终答案，并四舍五入至四位有效数字。",
            "solution": "该问题陈述清晰，具有科学依据，并提供了计算钙平衡膜电位所需的所有信息。其前提基于电化学和生物物理学的基本原理，即能斯特方程和缓冲平衡。所提供的值对于神经生理学实验是物理上现实的。因此，该问题是有效的，并且可以确定一个解。\n\n离子的平衡膜电位，也称为能斯特电位，由跨膜的电势梯度和化学势梯度的平衡决定。当一种离子的电化学势在膜两侧相等时，该离子的净通量为零。对于钙离子（${\\text{Ca}^{2+}}$），这种平衡由能斯特方程描述，根据规定使用活度，其形式为：\n$$\nE_{\\text{Ca}^{2+}} = \\frac{RT}{zF} \\ln\\left(\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}}\\right)\n$$\n在此，R 是理想气体常数，T 是绝对温度，z 是钙离子的化合价（z=2），F 是法拉第常数， $a_{\\text{Ca}^{2+},\\text{out}}$ 是细胞外溶液中钙的活度，而 $a_{\\text{Ca}^{2+},\\text{in}}$ 是细胞内溶液（胞质溶胶）中游离钙的活度。\n\n求解过程需要两个步骤：首先，确定膜两侧游离钙的活度；其次，将这些值代入能斯特方程。\n\n**1. 钙活度的计算**\n\n**a. 细胞外钙活度 ($a_{\\text{Ca}^{2+},\\text{out}}$)**\n活度与浓度的关系为 $a_i = \\gamma_i [i]$。\n已知：\n- 细胞外钙浓度: $[{\\text{Ca}^{2+}}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- 细胞外钙活度系数: $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$\n\n细胞外活度计算如下：\n$$\na_{\\text{Ca}^{2+},\\text{out}} = \\gamma_{\\text{Ca}^{2+},\\text{out}} [{\\text{Ca}^{2+}}]_{\\text{out}} = (0.25) \\times (1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}) = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**b. 细胞内钙活度 ($a_{\\text{Ca}^{2+},\\text{in}}$)**\n细胞内活度取决于*游离*钙离子的浓度 $[{\\text{Ca}^{2+}}]_{\\text{in,free}}$。该浓度由钙缓冲反应的平衡决定：\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B\n$$\n我们需要使用给定的总浓度和解离常数来求解 $[{\\text{Ca}^{2+}}]_{\\text{in,free}}$。我们将细胞内游离钙、缓冲剂和复合物的浓度分别表示为 $[{\\text{Ca}^{2+}}]$、$[B]$ 和 $[{\\text{Ca}}B]$。\n\n守恒方程为：\n$$\n[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = [{\\text{Ca}^{2+}}] + [{\\text{Ca}}B]\n$$\n$$\n[B]_{\\text{tot,in}} = [B] + [{\\text{Ca}}B]\n$$\n基于活度的解离常数为：\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}} = \\frac{(\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}]) \\, (\\gamma_{B,\\text{in}} [B])}{\\gamma_{\\text{Ca}B,\\text{in}} [{\\text{Ca}}B]}\n$$\n已知 $\\gamma_{B,\\text{in}} = 1$ 和 $\\gamma_{\\text{Ca}B,\\text{in}} = 1$，方程简化为：\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}] [B]}{[{\\text{Ca}}B]}\n$$\n根据守恒方程，我们将 $[{\\text{Ca}}B]$ 和 $[B]$ 用 $[{\\text{Ca}^{2+}}]$ 表示：\n$$\n[{\\text{Ca}}B] = [{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]\n$$\n$$\n[B] = [B]_{\\text{tot,in}} - [{\\text{Ca}}B] = [B]_{\\text{tot,in}} - ([{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}])\n$$\n将这些代入解离常数方程：\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}] \\left( [B]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]_{\\text{tot,in}} + [{\\text{Ca}^{2+}}] \\right)}{[{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]}\n$$\n重新整理后得到一个关于 $[{\\text{Ca}^{2+}}]$ 的二次方程，形式为 $ax^2+bx+c=0$，其中 $x = [{\\text{Ca}^{2+}}]$：\n$$\n(\\gamma_{\\text{Ca}^{2+},\\text{in}}) [{\\text{Ca}^{2+}}]^2 + (\\gamma_{\\text{Ca}^{2+},\\text{in}}([B]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]_{\\text{tot,in}}) + K_{d}) [{\\text{Ca}^{2+}}] - K_{d}[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 0\n$$\n让我们代入给定值来求系数 $a$、$b$ 和 $c$：\n- $[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$\n\n系数为：\n$$\na = 0.35\n$$\n$$\nb = 0.35 \\times (1.0 \\times 10^{-3} - 1.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 0.35 \\times (9.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 3.15 \\times 10^{-4} + 1.5 \\times 10^{-7} = 3.1515 \\times 10^{-4}\n$$\n$$\nc = -(1.5 \\times 10^{-7}) \\times (1.0 \\times 10^{-4}) = -1.5 \\times 10^{-11}\n$$\n求解二次方程 $ax^2+bx+c=0$，取物理上有意义的正根 $x = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$：\n$$\nb^2 - 4ac = (3.1515 \\times 10^{-4})^2 - 4(0.35)(-1.5 \\times 10^{-11}) \\approx 9.93195 \\times 10^{-8} + 2.1 \\times 10^{-11} \\approx 9.93405 \\times 10^{-8}\n$$\n$$\n\\sqrt{b^2 - 4ac} \\approx \\sqrt{9.93405 \\times 10^{-8}} \\approx 3.15183 \\times 10^{-4}\n$$\n$$\n[{\\text{Ca}^{2+}}] = \\frac{-3.1515 \\times 10^{-4} + 3.15183 \\times 10^{-4}}{2 \\times 0.35} \\approx \\frac{3.3 \\times 10^{-8}}{0.7} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n因此，游离的细胞内钙浓度为 $[{\\text{Ca}^{2+}}]_{\\text{in,free}} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$。\n\n现在我们可以求出细胞内活度：\n$$\na_{\\text{Ca}^{2+},\\text{in}} = \\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}]_{\\text{in,free}} = 0.35 \\times (4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}) \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**2. 能斯特电位 ($E_{\\text{Ca}^{2+}}$) 的计算**\n\n现在我们将活度和常数代入能斯特方程：\n- $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n- $T = 310 \\ \\text{K}$\n- $z = 2$\n- $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{out}} = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{in}} \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n\n我们首先计算前置因子 $\\frac{RT}{zF}$：\n$$\n\\frac{RT}{zF} = \\frac{(8.314462618)(310)}{2 \\times 96485.33212} \\ \\text{V} \\approx 0.013357 \\ \\text{V}\n$$\n接下来，计算活度比：\n$$\n\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}} = \\frac{3.0 \\times 10^{-4}}{1.6658 \\times 10^{-8}} \\approx 18009.6\n$$\n现在，计算能斯特电位：\n$$\nE_{\\text{Ca}^{2+}} = (0.013357 \\ \\text{V}) \\times \\ln(18009.6) \\approx (0.013357 \\ \\text{V}) \\times (9.7987) \\approx 0.13088 \\ \\text{V}\n$$\n问题要求以毫伏 ($mV$) 为单位给出答案。\n$$\nE_{\\text{Ca}^{2+}} = 0.13088 \\ \\text{V} \\times 1000 \\ \\frac{\\text{mV}}{\\text{V}} = 130.88 \\ \\text{mV}\n$$\n四舍五入到四位有效数字，最终结果是 $130.9 \\ \\text{mV}$。",
            "answer": "$$\\boxed{130.9}$$"
        },
        {
            "introduction": "能斯特势不仅仅是一个静态的平衡值，它在描述离子跨膜流动的动力学模型中扮演着核心角色。本练习将理论推导与计算实践相结合，阐明了能斯特势如何定义离子流的“驱动力”，并验证了当膜电位被钳制在平衡电位时，净离子流为零。这项综合练习旨在将热力学平衡的概念与基于电导的电流模型联系起来，为您进行更复杂的生物系统建模奠定基础。",
            "id": "3938313",
            "problem": "您正在为一种价态为 $z_i$ 的离子物种 $i$ 建模，该模型涉及一个单一的选择性渗透膜，该膜隔开了两个充分搅拌的理想稀溶液，其摩尔浓度分别为 $c_{i,\\text{out}}$ 和 $c_{i,\\text{in}}$。相 $\\alpha \\in \\{\\text{out},\\text{in}\\}$ 中物种 $i$ 的总电化学势定义为 $\\tilde{\\mu}_{i,\\alpha} = \\mu_{i,\\alpha} + z_i F \\phi_{\\alpha}$，其中 $F$ 是法拉第常数，$\\phi_{\\alpha}$ 是相 $\\alpha$ 中的电势。对于理想稀溶液，化学势由 $\\mu_{i,\\alpha} = \\mu_i^0 + R T \\ln c_{i,\\alpha}$ 给出，其中 $R$ 是普适气体常数，$T$ 是绝对温度。设膜电位为 $V_m = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。\n\n任务1（推导）：仅从平衡状态下电化学势相等（零净通量时 $\\tilde{\\mu}_{i,\\text{in}} = \\tilde{\\mu}_{i,\\text{out}}$）以及上面给出的理想稀溶液化学势表达式出发，推导出在物种 $i$ 的净通量为零时，平衡膜电位 $V_m$ 关于 $T$、$z_i$、$c_{i,\\text{out}}$ 和 $c_{i,\\text{in}}$ 的显式表达式。除了这些基础定义，请勿使用或假设任何目标公式。\n\n任务2（电导模型一致性）：考虑一个基于电导的物种 $i$ 的跨膜电流密度模型，定义为 $j_i = g_i \\Delta V_i$，其中 $g_i$ 是一个恒定的电导密度，$\\Delta V_i$ 是实际膜电位与物种 $i$ 的平衡电位之间的驱动力。使用您在任务1中推导出的表达式来定义物种 $i$ 的平衡电位，解释为什么将膜电位钳制在该电位（$V_m$ 等于平衡电位）会导致 $j_i = 0$，并根据零净离子通量来解释 $j_i = 0$。\n\n任务3（数值演示）：实现一个程序，对下面提供的每个测试用例，计算任务1中离子物种 $i$ 的平衡电位，然后评估电导模型电流密度 $j_i = g_i (V_m - E_i)$，其中 $E_i$ 是您推导出的平衡电位，$V_m$ 是该测试中施加的膜电位。使用普适气体常数 $R = 8.31446261815324$ J/(mol·K) 和法拉第常数 $F = 96485.33212$ C/mol。应使用自然对数。对于物理单位，所有电流密度 $j_i$ 均以 A/m$^2$ 表示。使用科学记数法格式化每个结果，小数点后精确到 $12$ 位。\n\n测试套件（每个元组为 ($T$, $z_i$, $c_{i,\\text{out}}$, $c_{i,\\text{in}}$, $g_i$, `Vm_mode`)，其中 `Vm_mode` 指定如何设置 $V_m$）：\n- 测试1（正常路径，生理温度下的单价阳离子）：($310$, $+1$, $5\\times 10^{-3}$, $140\\times 10^{-3}$, $10.0$, `clamp`)。此处 `clamp` 表示设置 $V_m = E_i$，其中 $E_i$ 根据您的推导计算得出。\n- 测试2（与平衡点的微小偏差）：($310$, $+1$, $5\\times 10^{-3}$, $140\\times 10^{-3}$, $10.0$, `clamp_plus`, $0.005$)。此处 `clamp_plus` 表示设置 $V_m = E_i + \\delta$，其中 $\\delta = 0.005$ V。\n- 测试3（室温下的阴离子）：($298$, $-1$, $110\\times 10^{-3}$, $5\\times 10^{-3}$, $5.0$, `clamp`)。\n- 测试4（具有大浓度梯度的二价阳离子）：($310$, $+2$, $2\\times 10^{-3}$, $1\\times 10^{-7}$, $0.5$, `clamp`)。\n- 测试5（边界情况：浓度相等）：($310$, $+1$, $100\\times 10^{-3}$, $100\\times 10^{-3}$, $1.0$, `set`, $0.0$)。此处 `set` 表示将 $V_m$ 直接设置为所提供的 V 值。\n- 测试6（极小电导，大驱动力）：($310$, $+1$, $150\\times 10^{-3}$, $15\\times 10^{-3}$, $1\\times 10^{-9}$, `clamp_plus`, $0.1$)。\n\n您的程序必须：\n- 在内部硬编码上述测试套件，不读取任何输入。\n- 对于每个测试，使用 $T$、$z_i$、$c_{i,\\text{out}}$、$c_{i,\\text{in}}$ 根据您在任务1中的推导计算 $E_i$，然后根据 `Vm_mode` 设置 $V_m$，再计算 $j_i = g_i (V_m - E_i)$（单位 A/m$^2$）。\n- 将得到的6个电流密度值聚合到单行输出中，该行包含一个用方括号括起来的逗号分隔列表，结果顺序与上述测试顺序相同。每个值必须格式化为科学记数法，小数点后精确到 $12$ 位（例如，$1.234000000000\\text{e-03}$），并且该行不得包含任何其他字符。\n\n所有推导出的表达式，电位单位应为伏特，电流密度单位应为 A/m$^2$，仅在最后打印时按要求格式进行四舍五入。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于热力学和电生理学原理，问题阐述清晰，并提供了一套完整且一致的定义、条件和数据。因此，我们可以着手进行形式化求解。\n\n该问题分为三个任务，将按顺序解决：理论推导、概念一致性检验和数值实现。\n\n### 任务1：平衡电位的推导\n\n我们的任务是推导离子物种 $i$ 的平衡膜电位（此处表示为 $E_i$）的表达式。推导必须从电化学平衡条件和给定的化学势表达式开始。\n\n平衡的基本条件是离子跨膜的净通量为零。当物种 $i$ 在膜两侧隔开的两个隔室中的电化学势相等时，就会出现这种情况。设隔室表示为“in”代表细胞内，“out”代表细胞外。因此，平衡条件是：\n$$\n\\tilde{\\mu}_{i,\\text{in}} = \\tilde{\\mu}_{i,\\text{out}}\n$$\n根据问题陈述，相 $\\alpha$ 中的电化学势 $\\tilde{\\mu}_{i,\\alpha}$ 定义为化学势 $\\mu_{i,\\alpha}$ 和电势能项 $z_i F \\phi_{\\alpha}$ 的和。\n$$\n\\tilde{\\mu}_{i,\\alpha} = \\mu_{i,\\alpha} + z_i F \\phi_{\\alpha}\n$$\n这里，$z_i$ 是离子的价态，$F$ 是法拉第常数，$\\phi_{\\alpha}$ 是相 $\\alpha$ 的电势。将此定义代入平衡条件，得到：\n$$\n\\mu_{i,\\text{in}} + z_i F \\phi_{\\text{in}} = \\mu_{i,\\text{out}} + z_i F \\phi_{\\text{out}}\n$$\n问题还提供了理想稀溶液中化学势的表达式：\n$$\n\\mu_{i,\\alpha} = \\mu_i^0 + R T \\ln c_{i,\\alpha}\n$$\n其中 $\\mu_i^0$ 是标准化学势，$R$ 是普适气体常数，$T$ 是绝对温度，$c_{i,\\alpha}$ 是物种在相 $\\alpha$ 中的摩尔浓度。将此代入我们的电势相等方程：\n$$\n(\\mu_i^0 + R T \\ln c_{i,\\text{in}}) + z_i F \\phi_{\\text{in}} = (\\mu_i^0 + R T \\ln c_{i,\\text{out}}) + z_i F \\phi_{\\text{out}}\n$$\n标准化学势项 $\\mu_i^0$ 是离子物种自身的属性，与浓度或电势无关。因此，它在方程两边是相同的，可以消去。\n$$\nR T \\ln c_{i,\\text{in}} + z_i F \\phi_{\\text{in}} = R T \\ln c_{i,\\text{out}} + z_i F \\phi_{\\text{out}}\n$$\n为了求出膜电位，我们必须分离出涉及电势 $\\phi_{\\text{in}}$ 和 $\\phi_{\\text{out}}$ 的项。重新整理方程得到：\n$$\nz_i F \\phi_{\\text{in}} - z_i F \\phi_{\\text{out}} = R T \\ln c_{i,\\text{out}} - R T \\ln c_{i,\\text{in}}\n$$\n提取两边的公因式：\n$$\nz_i F (\\phi_{\\text{in}} - \\phi_{\\text{out}}) = R T (\\ln c_{i,\\text{out}} - \\ln c_{i,\\text{in}})\n$$\n利用对数性质 $\\ln a - \\ln b = \\ln(a/b)$，右侧可以简化为：\n$$\nz_i F (\\phi_{\\text{in}} - \\phi_{\\text{out}}) = R T \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\n膜电位 $V_m$ 定义为内部和外部的电势差：$V_m = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。满足此平衡条件的 $V_m$ 的特定值是平衡电位，记为 $E_i$。用 $E_i$ 代替 $(\\phi_{\\text{in}} - \\phi_{\\text{out}})$：\n$$\nz_i F E_i = R T \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\n最后，求解 $E_i$ 得到能斯特方程（Nernst equation）：\n$$\nE_i = \\frac{R T}{z_i F} \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\n该表达式以温度 $T$（单位开尔文，K）、离子价态 $z_i$（无量纲）、离子浓度 $c_{i,\\text{out}}$ 和 $c_{i,\\text{in}}$（单位一致，例如 mol/m$^3$）以及物理常数 $R$（单位 J/(mol·K)）和 $F$（单位 C/mol）的函数形式，给出了平衡电位（单位伏特，V）。\n\n### 任务2：电导模型一致性\n\n我们被要求分析基于电导的电流密度模型 $j_i = g_i \\Delta V_i$，并证明其与推导出的平衡电位的一致性。问题明确指出驱动力为 $\\Delta V_i = V_m - E_i$，因此模型是：\n$$\nj_i = g_i (V_m - E_i)\n$$\n这里，$j_i$ 是物种 $i$ 的跨膜电流密度（单位 A/m$^2$），$g_i$ 是恒定电导密度（单位 S/m$^2$），$V_m$ 是实际膜电位，$E_i$ 是任务1中推导的物种 $i$ 的能斯特平衡电位。\n\n问题是解释为什么将膜电位钳制在平衡电位（$V_m = E_i$）会导致零电流密度（$j_i = 0$）。通过直接代入模型方程：\n$$\nj_i = g_i (E_i - E_i) = g_i (0) = 0\n$$\n从数学上讲，这个结果是显而易见的。其物理释义才是重要的。电流密度 $j_i$ 表示物种 $i$ 每单位时间穿过单位膜面积的净电荷流。$j_i = 0$ 的值表示没有*净*电荷跨膜传输。由于电荷载体是物种 $i$ 的离子，零净电荷通量等同于零净离子通量。\n\n这个结果与任务1中的推导完全一致。能斯特电位 $E_i$ 是在零净离子通量（即热力学平衡）的明确条件下推导出来的。电导模型是一种离子流动的动力学描述，它正确地预测了当电驱动力（$V_m$）恰好平衡化学驱动力（封装在 $E_i$ 中）时，净驱动电位 $(V_m - E_i)$ 为零，因此净电流为零。这证明了平衡的热力学定义与离子电流的唯象（欧姆）模型之间的内在一致性。\n\n### 任务3：数值演示\n\n对于最后一项任务，需要实现一个程序来计算一套6个测试用例的电流密度 $j_i$。实现将遵循上述原则。\n\n对于每个由参数元组 $(T, z_i, c_{i,\\text{out}}, c_{i,\\text{in}}, g_i, \\text{Vm\\_mode}, ...)$ 定义的测试用例，程序必须首先使用推导的公式计算能斯特电位 $E_i$：\n$$\nE_i = \\frac{R T}{z_i F} \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\n所需的物理常数是 $R = 8.31446261815324$ J/(mol·K) 和 $F = 96485.33212$ C/mol。\n\n接下来，根据测试用例的 `Vm_mode` 确定膜电位 $V_m$：\n- 如果 `Vm_mode` 是 `\"clamp\"`，$V_m$ 设置为等于计算出的 $E_i$。\n- 如果 `Vm_mode` 是 `\"clamp_plus\"`，$V_m$ 设置为 $E_i + \\delta$，其中 $\\delta$ 是测试用例中提供的附加参数。\n- 如果 `Vm_mode` 是 `\"set\"`，$V_m$ 设置为测试用例中提供的特定值。\n\n最后，使用电导模型计算电流密度 $j_i$：\n$$\nj_i = g_i (V_m - E_i)\n$$\n然后，将所有6个测试的 $j_i$ 结果值按照问题规范进行格式化和打印。对于 $V_m$ 设置为 $E_i$ 的情况，我们预计 $j_i$ 精确为零。对于 $V_m \\neq E_i$ 的情况，将有非零电流流过，其大小与电导 $g_i$ 和驱动电位 $(V_m - E_i)$ 成正比。电流的符号将指示其方向（按照惯例，正电流是正电荷的向外流动）。\n数值实现将在下一节中提供。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the transmembrane current density for a series of test cases\n    based on the Nernst potential and a conductance model.\n    \"\"\"\n\n    # Define physical constants as specified in the problem\n    R = 8.31446261815324  # Universal gas constant in J/(mol·K)\n    F = 96485.33212       # Faraday constant in C/mol\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (T, z_i, c_out, c_in, g_i, Vm_mode, *args)\n    # where T is temperature (K), z_i is valence, c_out/c_in are concentrations (M),\n    # g_i is conductance density (S/m^2), and Vm_mode specifies how to set Vm.\n    test_cases = [\n        # Test 1 (happy path, monovalent cation at physiological temperature)\n        (310.0, 1, 5e-3, 140e-3, 10.0, \"clamp\"),\n        # Test 2 (small deviation from equilibrium)\n        (310.0, 1, 5e-3, 140e-3, 10.0, \"clamp_plus\", 0.005),\n        # Test 3 (anion at room temperature)\n        (298.0, -1, 110e-3, 5e-3, 5.0, \"clamp\"),\n        # Test 4 (divalent cation with large concentration gradient)\n        (310.0, 2, 2e-3, 1e-7, 0.5, \"clamp\"),\n        # Test 5 (boundary case: equal concentrations)\n        (310.0, 1, 100e-3, 100e-3, 1.0, \"set\", 0.0),\n        # Test 6 (very small conductance, large driving force)\n        (310.0, 1, 150e-3, 15e-3, 1e-9, \"clamp_plus\", 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for the current test case\n        T, z_i, c_out, c_in, g_i, vm_mode, *args = case\n\n        # Task 1: Calculate the Nernst equilibrium potential (E_i)\n        # E_i = (R * T) / (z_i * F) * ln(c_out / c_in)\n        # Note: numpy.log is the natural logarithm.\n        # Handle the case where concentrations are equal to avoid log(1) computation issues,\n        # though it resolves to 0. Also, z_i cannot be 0.\n        if z_i == 0:\n            # The Nernst equation is undefined for uncharged species.\n            # This case is not in the test suite but is good practice to handle.\n            e_i = np.nan\n        elif c_out == 0 or c_in == 0:\n            # Logarithm is undefined for non-positive concentrations.\n            e_i = np.nan\n        else:\n            e_i = (R * T) / (z_i * F) * np.log(c_out / c_in)\n\n        # Set the membrane potential (V_m) based on the specified mode\n        v_m = 0.0\n        if vm_mode == \"clamp\":\n            v_m = e_i\n        elif vm_mode == \"clamp_plus\":\n            delta = args[0]\n            v_m = e_i + delta\n        elif vm_mode == \"set\":\n            v_m = args[0]\n\n        # Task 3: Evaluate the conductance-model current density (j_i)\n        # j_i = g_i * (V_m - E_i)\n        j_i = g_i * (v_m - e_i)\n\n        results.append(j_i)\n\n    # Format the results as specified and print to standard output.\n    # Each value in scientific notation with exactly 12 digits after the decimal point.\n    formatted_results = [f\"{res:.12e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}