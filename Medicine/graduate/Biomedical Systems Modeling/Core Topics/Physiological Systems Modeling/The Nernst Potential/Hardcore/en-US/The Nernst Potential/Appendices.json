{
    "hands_on_practices": [
        {
            "introduction": "A robust understanding of any physical principle begins with its derivation from fundamental laws. This exercise grounds your knowledge of the Nernst potential by requiring you to derive it directly from the condition of electrochemical equilibrium, where the net flux of an ion across a membrane is zero. By applying this derived formula to calculate the equilibrium potential for chloride ions ($E_{\\text{Cl}}$), you will translate thermodynamic theory into a tangible, physiologically relevant value. ",
            "id": "3938291",
            "problem": "A single-compartment neuronal membrane is permeable predominantly to chloride ions. Let $\\phi_i$ and $\\phi_o$ denote the intracellular and extracellular electric potentials, respectively, and let $E_{\\text{Cl}} \\equiv \\phi_i - \\phi_o$ be the transmembrane potential difference that sets the net flux of chloride to zero. At equilibrium for a permeant ion, the electrochemical potential is equal on both sides of the membrane. Assume ideal dilute solutions so that the chemical activity equals the molar concentration. The intracellular and extracellular chloride concentrations are given by $[\\text{Cl}^-]_{\\text{i}} = 5\\,\\mathrm{mM}$ and $[\\text{Cl}^-]_{\\text{o}} = 120\\,\\mathrm{mM}$. The absolute temperature is $T = 310\\,\\mathrm{K}$ and the valence of chloride is $z = -1$. Use the gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and the Faraday constant $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$. \n\nStarting from the definition of chemical potential and the condition of electrochemical equilibrium, derive the expression for $E_{\\text{Cl}}$ in terms of the given quantities and evaluate its numerical value for the data provided. Express your final answer in millivolts and round to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and complete. It presents a standard exercise in biophysical chemistry, requiring the derivation and calculation of the Nernst potential for chloride ions. All necessary data and constants are provided, and the conditions are physically and biologically realistic.\n\nThe fundamental principle governing the equilibrium distribution of a permeant ion across a membrane is the equality of its electrochemical potential on both sides. The electrochemical potential, $\\tilde{\\mu}_j$, for an ionic species $j$ in a solution is given by the sum of its chemical potential and its electrical potential energy per mole:\n$$ \\tilde{\\mu}_j = \\mu_j^0 + RT \\ln(a_j) + z_j F \\phi $$\nwhere $\\mu_j^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, $a_j$ is the chemical activity of the ion, $z_j$ is its valence (charge number), $F$ is the Faraday constant, and $\\phi$ is the local electric potential.\n\nThe problem specifies that the system is at equilibrium for chloride ions ($\\text{Cl}^-$). Therefore, the electrochemical potential for chloride on the intracellular side ($i$) must be equal to its electrochemical potential on the extracellular side ($o$):\n$$ \\tilde{\\mu}_{\\text{Cl}, i} = \\tilde{\\mu}_{\\text{Cl}, o} $$\nSubstituting the expression for electrochemical potential for both sides gives:\n$$ \\mu_{\\text{Cl}}^0 + RT \\ln(a_i) + z_{\\text{Cl}} F \\phi_i = \\mu_{\\text{Cl}}^0 + RT \\ln(a_o) + z_{\\text{Cl}} F \\phi_o $$\nThe standard chemical potential, $\\mu_{\\text{Cl}}^0$, is an intrinsic property of the ion in a given solvent and temperature, so it is identical on both sides and cancels out:\n$$ RT \\ln(a_i) + z_{\\text{Cl}} F \\phi_i = RT \\ln(a_o) + z_{\\text{Cl}} F \\phi_o $$\nThe problem states to assume ideal dilute solutions, which means the chemical activity, $a_j$, can be approximated by the molar concentration, $[\\text{Cl}^-]_j$. Thus, $a_i = [\\text{Cl}^-]_{\\text{i}}$ and $a_o = [\\text{Cl}^-]_{\\text{o}}$. The equation becomes:\n$$ RT \\ln([\\text{Cl}^-]_{\\text{i}}) + z_{\\text{Cl}} F \\phi_i = RT \\ln([\\text{Cl}^-]_{\\text{o}}) + z_{\\text{Cl}} F \\phi_o $$\nWe are asked to find the Nernst potential for chloride, $E_{\\text{Cl}}$, which is defined as the transmembrane potential difference at equilibrium, $E_{\\text{Cl}} \\equiv \\phi_i - \\phi_o$. Rearranging the equation to solve for this difference:\n$$ z_{\\text{Cl}} F (\\phi_i - \\phi_o) = RT \\ln([\\text{Cl}^-]_{\\text{o}}) - RT \\ln([\\text{Cl}^-]_{\\text{i}}) $$\nUsing the properties of logarithms, $\\ln(x) - \\ln(y) = \\ln(x/y)$:\n$$ z_{\\text{Cl}} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\text{Cl}^-]_{\\text{o}}}{[\\text{Cl}^-]_{\\text{i}}}\\right) $$\nIsolating the potential difference $\\phi_i - \\phi_o$ yields the Nernst equation for chloride:\n$$ E_{\\text{Cl}} = \\phi_i - \\phi_o = \\frac{RT}{z_{\\text{Cl}} F} \\ln\\left(\\frac{[\\text{Cl}^-]_{\\text{o}}}{[\\text{Cl}^-]_{\\text{i}}}\\right) $$\nNow, we substitute the given numerical values into this derived expression:\nIntracellular chloride concentration, $[\\text{Cl}^-]_{\\text{i}} = 5\\,\\mathrm{mM}$.\nExtracellular chloride concentration, $[\\text{Cl}^-]_{\\text{o}} = 120\\,\\mathrm{mM}$.\nAbsolute temperature, $T = 310\\,\\mathrm{K}$.\nValence of chloride, $z = z_{\\text{Cl}} = -1$.\nGas constant, $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\nFaraday constant, $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n\nThe concentration ratio is a dimensionless quantity:\n$$ \\frac{[\\text{Cl}^-]_{\\text{o}}}{[\\text{Cl}^-]_{\\text{i}}} = \\frac{120\\,\\mathrm{mM}}{5\\,\\mathrm{mM}} = 24 $$\nSubstituting all values into the Nernst equation:\n$$ E_{\\text{Cl}} = \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(-1) \\times (96485.33212\\,\\mathrm{C\\,mol^{-1}})} \\ln(24) $$\nThe units $\\mathrm{J\\,C^{-1}}$ are equivalent to Volts ($\\mathrm{V}$). Let's compute the numerical value:\n$$ E_{\\text{Cl}} = -\\frac{2577.48341158}{96485.33212} \\times \\ln(24) \\,\\mathrm{V} $$\n$$ E_{\\text{Cl}} \\approx -(0.0267140866\\,\\mathrm{V}) \\times (3.17805383) $$\n$$ E_{\\text{Cl}} \\approx -0.084918386\\,\\mathrm{V} $$\nThe problem requires the answer to be in millivolts ($\\mathrm{mV}$) and rounded to four significant figures. To convert from volts to millivolts, we multiply by $1000$:\n$$ E_{\\text{Cl}} \\approx -0.084918386 \\times 1000\\,\\mathrm{mV} = -84.918386\\,\\mathrm{mV} $$\nRounding to four significant figures, we get:\n$$ E_{\\text{Cl}} \\approx -84.92\\,\\mathrm{mV} $$\nThis negative value indicates that, at equilibrium, the inside of the cell is electrically negative relative to the outside, which is required to counteract the chemical gradient that favors the influx of chloride ions from the higher extracellular concentration to the lower intracellular concentration.",
            "answer": "$$\n\\boxed{-84.92}\n$$"
        },
        {
            "introduction": "Biological systems are far more complex than ideal dilute solutions. This practice challenges you to incorporate two critical aspects of physiological realism into your calculations: intracellular buffering and ionic activity. You will first determine the *free* intracellular calcium concentration, which is tightly controlled by chelators, and then use thermodynamically accurate activities instead of molar concentrations to compute the calcium Nernst potential ($E_{\\text{Ca}^{2+}}$). ",
            "id": "3938258",
            "problem": "A single-compartment neuronal preparation is bathed in an extracellular solution containing calcium ions and no chelator, while the cytosol contains a fast calcium buffer with one-to-one binding stoichiometry. The membrane is assumed perfectly selective to calcium ions. The extracellular solution has no calcium chelator and a calcium concentration of $[\\text{Ca}^{2+}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$. The intracellular solution contains a total chelator concentration $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$ and a total calcium concentration $[\\text{Ca}^{2+}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$. The buffer reaction is\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B,\n$$\nwith activity-based dissociation constant $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$, defined by\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}},\n$$\nwhere $a_{i}$ denotes the activity of species $i$.\n\nAssume the following:\n- The activities are related to concentrations by $a_{i} = \\gamma_{i} [i]$, where $\\gamma_{i}$ is the activity coefficient of species $i$.\n- Intracellular activity coefficients satisfy $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$, $\\gamma_{B,\\text{in}} = 1$, and $\\gamma_{\\text{Ca}B,\\text{in}} = 1$.\n- Extracellular calcium has activity coefficient $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$.\n- Ignore protonation or competing binding of the chelator and any other ion interactions; treat the buffer as rapid and at equilibrium.\n\nUsing the equality of electrochemical potentials for calcium across the membrane at equilibrium, derive and compute the equilibrium membrane potential for calcium, $E_{\\text{Ca}^{2+}}$, using the free calcium activities on each side (not the totals). Use gas constant $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$, absolute temperature $T = 310 \\ \\text{K}$, Faraday constant $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$, and valence $z = 2$ for calcium. Express your final answer in millivolts and round your answer to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information to compute the equilibrium membrane potential for calcium. The premise is based on fundamental principles of electrochemistry and biophysics, namely the Nernst equation and buffer equilibrium. The provided values are physically realistic for a neurophysiological experiment. Therefore, the problem is valid, and a solution can be determined.\n\nThe equilibrium membrane potential for an ion, also known as the Nernst potential, is determined by the balance of the electrical and chemical potential gradients across the membrane. When the electrochemical potential for an ion is equal on both sides of the membrane, there is no net flux of that ion. For calcium ions ($\\text{Ca}^{2+}$), this equilibrium is described by the Nernst equation, which, using activities as stipulated, is:\n$$\nE_{\\text{Ca}^{2+}} = \\frac{RT}{zF} \\ln\\left(\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}}\\right)\n$$\nHere, $R$ is the ideal gas constant, $T$ is the absolute temperature, $z$ is the valence of the calcium ion ($z=2$), $F$ is the Faraday constant, $a_{\\text{Ca}^{2+},\\text{out}}$ is the activity of calcium in the extracellular solution, and $a_{\\text{Ca}^{2+},\\text{in}}$ is the activity of free calcium in the intracellular solution (cytosol).\n\nThe solution requires a two-step process: first, determine the activities of free calcium on both sides of the membrane, and second, substitute these values into the Nernst equation.\n\n**1. Calculation of Calcium Activities**\n\n**a. Extracellular Calcium Activity ($a_{\\text{Ca}^{2+},\\text{out}}$)**\nThe activity is related to the concentration by $a_i = \\gamma_i [i]$.\nGiven:\n- Extracellular calcium concentration: $[\\text{Ca}^{2+}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- Extracellular activity coefficient for calcium: $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$\n\nThe extracellular activity is calculated as:\n$$\na_{\\text{Ca}^{2+},\\text{out}} = \\gamma_{\\text{Ca}^{2+},\\text{out}} [\\text{Ca}^{2+}]_{\\text{out}} = (0.25) \\times (1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}) = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**b. Intracellular Calcium Activity ($a_{\\text{Ca}^{2+},\\text{in}}$)**\nThe intracellular activity depends on the concentration of *free* calcium ions, $[\\text{Ca}^{2+}]_{\\text{in,free}}$. This concentration is determined by the equilibrium of the calcium buffer reaction:\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B\n$$\nWe need to solve for $[\\text{Ca}^{2+}]_{\\text{in,free}}$ using the given total concentrations and the dissociation constant. Let's denote the free concentrations of intracellular calcium, buffer, and complex as $[\\text{Ca}^{2+}]$, $[B]$, and $[\\text{Ca}B]$, respectively.\n\nThe conservation equations are:\n$$\n[\\text{Ca}^{2+}]_{\\text{tot,in}} = [\\text{Ca}^{2+}] + [\\text{Ca}B]\n$$\n$$\n[B]_{\\text{tot,in}} = [B] + [\\text{Ca}B]\n$$\nThe activity-based dissociation constant is:\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}} = \\frac{(\\gamma_{\\text{Ca}^{2+},\\text{in}} [\\text{Ca}^{2+}]) \\, (\\gamma_{B,\\text{in}} [B])}{\\gamma_{\\text{Ca}B,\\text{in}} [\\text{Ca}B]}\n$$\nGiven $\\gamma_{B,\\text{in}} = 1$ and $\\gamma_{\\text{Ca}B,\\text{in}} = 1$, the equation simplifies to:\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [\\text{Ca}^{2+}] [B]}{[\\text{Ca}B]}\n$$\nFrom the conservation equations, we express $[\\text{Ca}B]$ and $[B]$ in terms of $[\\text{Ca}^{2+}]$:\n$$\n[\\text{Ca}B] = [\\text{Ca}^{2+}]_{\\text{tot,in}} - [\\text{Ca}^{2+}]\n$$\n$$\n[B] = [B]_{\\text{tot,in}} - [\\text{Ca}B] = [B]_{\\text{tot,in}} - ([\\text{Ca}^{2+}]_{\\text{tot,in}} - [\\text{Ca}^{2+}])\n$$\nSubstituting these into the dissociation constant equation:\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [\\text{Ca}^{2+}] \\left( [B]_{\\text{tot,in}} - [\\text{Ca}^{2+}]_{\\text{tot,in}} + [\\text{Ca}^{2+}] \\right)}{[\\text{Ca}^{2+}]_{\\text{tot,in}} - [\\text{Ca}^{2+}]}\n$$\nRearranging this yields a quadratic equation for $[\\text{Ca}^{2+}]$ of the form $ax^2+bx+c=0$, where $x = [\\text{Ca}^{2+}}]$:\n$$\n(\\gamma_{\\text{Ca}^{2+},\\text{in}}) [\\text{Ca}^{2+}}]^2 + (\\gamma_{\\text{Ca}^{2+},\\text{in}}([B]_{\\text{tot,in}} - [\\text{Ca}^{2+}]_{\\text{tot,in}}) + K_{d}) [\\text{Ca}^{2+}}] - K_{d}[\\text{Ca}^{2+}]_{\\text{tot,in}} = 0\n$$\nLet's substitute the given values to find the coefficients $a$, $b$, and $c$:\n- $[\\text{Ca}^{2+}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$\n\nThe coefficients are:\n$$\na = 0.35\n$$\n$$\nb = 0.35 \\times (1.0 \\times 10^{-3} - 1.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 0.35 \\times (9.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 3.15 \\times 10^{-4} + 1.5 \\times 10^{-7} = 3.1515 \\times 10^{-4}\n$$\n$$\nc = -(1.5 \\times 10^{-7}) \\times (1.0 \\times 10^{-4}) = -1.5 \\times 10^{-11}\n$$\nSolving the quadratic equation $ax^2+bx+c=0$ for the physically meaningful positive root $x = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$:\n$$\nb^2 - 4ac = (3.1515 \\times 10^{-4})^2 - 4(0.35)(-1.5 \\times 10^{-11}) \\approx 9.93195 \\times 10^{-8} + 2.1 \\times 10^{-11} \\approx 9.93405 \\times 10^{-8}\n$$\n$$\n\\sqrt{b^2 - 4ac} \\approx \\sqrt{9.93405 \\times 10^{-8}} \\approx 3.15183 \\times 10^{-4}\n$$\n$$\n[\\text{Ca}^{2+}] = \\frac{-3.1515 \\times 10^{-4} + 3.15183 \\times 10^{-4}}{2 \\times 0.35} \\approx \\frac{3.3 \\times 10^{-8}}{0.7} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\nSo, the free intracellular calcium concentration is $[\\text{Ca}^{2+}]_{\\text{in,free}} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$.\n\nNow we can find the intracellular activity:\n$$\na_{\\text{Ca}^{2+},\\text{in}} = \\gamma_{\\text{Ca}^{2+},\\text{in}} [\\text{Ca}^{2+}]_{\\text{in,free}} = 0.35 \\times (4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}) \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**2. Calculation of the Nernst Potential ($E_{\\text{Ca}^{2+}}$)**\n\nNow we substitute the activities and constants into the Nernst equation:\n- $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n- $T = 310 \\ \\text{K}$\n- $z = 2$\n- $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{out}} = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{in}} \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n\nLet's first compute the pre-factor $\\frac{RT}{zF}$:\n$$\n\\frac{RT}{zF} = \\frac{(8.314462618)(310)}{2 \\times 96485.33212} \\ \\text{V} \\approx 0.013357 \\ \\text{V}\n$$\nNext, the ratio of activities:\n$$\n\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}} = \\frac{3.0 \\times 10^{-4}}{1.6658 \\times 10^{-8}} \\approx 18009.6\n$$\nNow, calculate the Nernst potential:\n$$\nE_{\\text{Ca}^{2+}} = (0.013357 \\ \\text{V}) \\times \\ln(18009.6) \\approx (0.013357 \\ \\text{V}) \\times (9.7987) \\approx 0.13088 \\ \\text{V}\n$$\nThe problem asks for the answer in millivolts ($mV$).\n$$\nE_{\\text{Ca}^{2+}} = 0.13088 \\ \\text{V} \\times 1000 \\ \\frac{\\text{mV}}{\\text{V}} = 130.88 \\ \\text{mV}\n$$\nRounding to four significant figures, the final result is $130.9 \\ \\text{mV}$.",
            "answer": "$$\\boxed{130.9}$$"
        },
        {
            "introduction": "In computational neuroscience, the Nernst potential is not an endpoint but a key parameter in dynamic models of ion flow. This exercise bridges the gap between static thermodynamics and membrane kinetics by integrating the Nernst potential into a conductance-based current model. Through conceptual analysis and a hands-on coding task, you will demonstrate how the Nernst potential defines the zero-current point, or reversal potential, which is fundamental to simulating neuronal behavior. ",
            "id": "3938313",
            "problem": "You are modeling a single, selectively permeable membrane for an ionic species $i$ with valence $z_i$ separating two well-stirred, ideal dilute solutions with molar concentrations $c_{i,\\text{out}}$ and $c_{i,\\text{in}}$, respectively. The total electrochemical potential of species $i$ in phase $\\alpha \\in \\{\\text{out},\\text{in}\\}$ is defined as $\\tilde{\\mu}_{i,\\alpha} = \\mu_{i,\\alpha} + z_i F \\phi_{\\alpha}$, where $F$ is the Faraday constant and $\\phi_{\\alpha}$ is the electric potential in phase $\\alpha$. For ideal dilute solutions, the chemical potential is given by $\\mu_{i,\\alpha} = \\mu_i^0 + R T \\ln c_{i,\\alpha}$, where $R$ is the universal gas constant and $T$ is the absolute temperature. Let the membrane potential be $V_m = \\phi_{\\text{in}} - \\phi_{\\text{out}}$.\n\nTask 1 (Derivation): Starting only from the equality of electrochemical potentials at equilibrium ($\\tilde{\\mu}_{i,\\text{in}} = \\tilde{\\mu}_{i,\\text{out}}$ for zero net flux) and the ideal dilute solution expression for chemical potential given above, derive an explicit expression for the equilibrium membrane potential $V_m$ that enforces zero net flux for species $i$ in terms of $T$, $z_i$, $c_{i,\\text{out}}$, and $c_{i,\\text{in}}$. Do not use or assume any target formulas beyond these foundational definitions.\n\nTask 2 (Conductance model consistency): Consider a conductance-based transmembrane current density model for species $i$ defined by $j_i = g_i \\Delta V_i$, where $g_i$ is a constant conductance density and $\\Delta V_i$ is the driving force between the actual membrane potential and the equilibrium potential of species $i$. Using your derived expression from Task 1 to define the equilibrium potential of species $i$, explain why clamping the membrane to that potential ($V_m$ equal to the equilibrium potential) leads to $j_i = 0$, and interpret $j_i = 0$ in terms of zero net ion flux.\n\nTask 3 (Numerical demonstration): Implement a program that, for each test case provided below, computes the equilibrium potential for the ionic species $i$ from Task 1 and then evaluates the conductance-model current density $j_i = g_i (V_m - E_i)$, where $E_i$ is the equilibrium potential you derived and $V_m$ is the imposed membrane potential for that test. Use the universal gas constant $R = 8.31446261815324$ in J/(mol路K) and the Faraday constant $F = 96485.33212$ in C/mol. The natural logarithm is to be used. For physical units, express all current densities $j_i$ in A/m$^2$. Format each result using scientific notation with exactly $12$ digits after the decimal point.\n\nTest Suite (each tuple is $(T,\\; z_i,\\; c_{i,\\text{out}},\\; c_{i,\\text{in}},\\; g_i,\\; \\text{Vm\\_mode})$, where Vm_mode specifies how to set $V_m$):\n- Test 1 (happy path, monovalent cation at physiological temperature): $(310,\\; +1,\\; 5\\times 10^{-3},\\; 140\\times 10^{-3},\\; 10.0,\\; \\text{\"clamp\"})$. Here \"clamp\" means set $V_m = E_i$ computed from your derivation.\n- Test 2 (small deviation from equilibrium): $(310,\\; +1,\\; 5\\times 10^{-3},\\; 140\\times 10^{-3},\\; 10.0,\\; \\text{\"clamp\\_plus\"},\\; 0.005)$. Here \"clamp_plus\" means set $V_m = E_i + \\delta$ with $\\delta = 0.005$ in V.\n- Test 3 (anion at room temperature): $(298,\\; -1,\\; 110\\times 10^{-3},\\; 5\\times 10^{-3},\\; 5.0,\\; \\text{\"clamp\"})$.\n- Test 4 (divalent cation with large concentration gradient): $(310,\\; +2,\\; 2\\times 10^{-3},\\; 1\\times 10^{-7},\\; 0.5,\\; \\text{\"clamp\"})$.\n- Test 5 (boundary case: equal concentrations): $(310,\\; +1,\\; 100\\times 10^{-3},\\; 100\\times 10^{-3},\\; 1.0,\\; \\text{\"set\"},\\; 0.0)$. Here \"set\" means directly set $V_m$ to the provided value in V.\n- Test 6 (very small conductance, large driving force): $(310,\\; +1,\\; 150\\times 10^{-3},\\; 15\\times 10^{-3},\\; 1\\times 10^{-9},\\; \\text{\"clamp\\_plus\"},\\; 0.1)$.\n\nYour program must:\n- Hard-code the above test suite internally without reading any input.\n- For each test, compute $E_i$ from your derivation in Task 1 using $T$, $z_i$, $c_{i,\\text{out}}$, $c_{i,\\text{in}}$, then set $V_m$ according to Vm_mode, then compute $j_i = g_i (V_m - E_i)$ in A/m$^2$.\n- Aggregate the $6$ resulting current density values into a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the tests above. Each value must be formatted in scientific notation with exactly $12$ digits after the decimal point (for example, $1.234000000000\\text{e-03}$), and the line must contain no other characters.\n\nAnswer all derived expressions in volts for potentials and A/m$^2$ for current densities, rounded only at the final print to the required format.",
            "solution": "The problem statement has been meticulously reviewed and is determined to be valid. It is scientifically grounded in the principles of thermodynamics and electrophysiology, well-posed, and provides a complete and consistent set of definitions, conditions, and data. We may therefore proceed with a formal solution.\n\nThe problem is structured into three tasks, which will be addressed in sequence: a theoretical derivation, a conceptual consistency check, and a numerical implementation.\n\n### Task 1: Derivation of the Equilibrium Potential\n\nWe are tasked with deriving the expression for the equilibrium membrane potential, denoted here as $E_i$, for an ionic species $i$. The derivation must start from the condition of electrochemical equilibrium and the provided expression for chemical potential.\n\nThe fundamental condition for equilibrium is that the net flux of the ion across the membrane is zero. This occurs when the electrochemical potential of the species $i$ is equal in the two compartments separated by the membrane. Let the compartments be denoted 'in' for intracellular and 'out' for extracellular. The equilibrium condition is thus:\n$$\n\\tilde{\\mu}_{i,\\text{in}} = \\tilde{\\mu}_{i,\\text{out}}\n$$\nFrom the problem statement, the electrochemical potential $\\tilde{\\mu}_{i,\\alpha}$ in a phase $\\alpha$ is defined as the sum of the chemical potential $\\mu_{i,\\alpha}$ and the electrical potential energy term $z_i F \\phi_{\\alpha}$.\n$$\n\\tilde{\\mu}_{i,\\alpha} = \\mu_{i,\\alpha} + z_i F \\phi_{\\alpha}\n$$\nHere, $z_i$ is the valence of the ion, $F$ is the Faraday constant, and $\\phi_{\\alpha}$ is the electric potential of the phase $\\alpha$. Substituting this definition into the equilibrium condition gives:\n$$\n\\mu_{i,\\text{in}} + z_i F \\phi_{\\text{in}} = \\mu_{i,\\text{out}} + z_i F \\phi_{\\text{out}}\n$$\nThe problem also provides the expression for the chemical potential in an ideal dilute solution:\n$$\n\\mu_{i,\\alpha} = \\mu_i^0 + R T \\ln c_{i,\\alpha}\n$$\nwhere $\\mu_i^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $c_{i,\\alpha}$ is the molar concentration of the species in phase $\\alpha$. Substituting this into our equation for potential equality:\n$$\n(\\mu_i^0 + R T \\ln c_{i,\\text{in}}) + z_i F \\phi_{\\text{in}} = (\\mu_i^0 + R T \\ln c_{i,\\text{out}}) + z_i F \\phi_{\\text{out}}\n$$\nThe standard chemical potential term $\\mu_i^0$ is a property of the ionic species itself and is independent of concentration or electric potential. It is therefore identical on both sides of the equation and can be cancelled.\n$$\nR T \\ln c_{i,\\text{in}} + z_i F \\phi_{\\text{in}} = R T \\ln c_{i,\\text{out}} + z_i F \\phi_{\\text{out}}\n$$\nTo find the membrane potential, we must isolate the terms involving the electric potentials $\\phi_{\\text{in}}$ and $\\phi_{\\text{out}}$. Rearranging the equation yields:\n$$\nz_i F \\phi_{\\text{in}} - z_i F \\phi_{\\text{out}} = R T \\ln c_{i,\\text{out}} - R T \\ln c_{i,\\text{in}}\n$$\nFactoring out the common terms on both sides:\n$$\nz_i F (\\phi_{\\text{in}} - \\phi_{\\text{out}}) = R T (\\ln c_{i,\\text{out}} - \\ln c_{i,\\text{in}})\n$$\nUsing the property of logarithms, $\\ln a - \\ln b = \\ln(a/b)$, the right side can be simplified:\n$$\nz_i F (\\phi_{\\text{in}} - \\phi_{\\text{out}}) = R T \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\nThe membrane potential, $V_m$, is defined as the difference in electric potential between the inside and the outside: $V_m = \\phi_{\\text{in}} - \\phi_{\\text{out}}$. The specific value of $V_m$ that satisfies this equilibrium condition is the equilibrium potential, denoted $E_i$. Substituting $E_i$ for $(\\phi_{\\text{in}} - \\phi_{\\text{out}})$:\n$$\nz_i F E_i = R T \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\nFinally, solving for $E_i$ gives the Nernst equation:\n$$\nE_i = \\frac{R T}{z_i F} \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\nThis expression provides the equilibrium potential in volts ($V$) as a function of temperature $T$ (in Kelvin, $K$), the ion's valence $z_i$ (dimensionless), the ion concentrations $c_{i,\\text{out}}$ and $c_{i,\\text{in}}$ (in consistent units, e.g., mol/m$^3$), and the physical constants $R$ (in J/(mol路K)) and $F$ (in C/mol).\n\n### Task 2: Conductance Model Consistency\n\nWe are asked to analyze the conductance-based current density model, $j_i = g_i \\Delta V_i$, and show its consistency with the derived equilibrium potential. The problem specifies that the driving force is $\\Delta V_i = V_m - E_i$, so the model is:\n$$\nj_i = g_i (V_m - E_i)\n$$\nHere, $j_i$ is the transmembrane current density for species $i$ (in A/m$^2$), $g_i$ is the constant conductance density (in S/m$^2$), $V_m$ is the actual membrane potential, and $E_i$ is the Nernst equilibrium potential for species $i$ as derived in Task $1$.\n\nThe question is to explain why clamping the membrane potential to the equilibrium potential ($V_m = E_i$) results in a zero current density ($j_i = 0$). By direct substitution into the model equation:\n$$\nj_i = g_i (E_i - E_i) = g_i (0) = 0\n$$\nMathematically, the result is trivial. The physical interpretation is what is significant. The current density $j_i$ represents the net flow of charge carried by species $i$ across a unit area of the membrane per unit time. A value of $j_i = 0$ signifies that there is no *net* charge transport across the membrane. Since the charge carriers are the ions of species $i$, zero net charge flux is equivalent to zero net ion flux.\n\nThis outcome is perfectly consistent with the derivation in Task $1$. The Nernst potential $E_i$ was derived under the explicit condition of zero net ion flux (i.e., thermodynamic equilibrium). The conductance model, a kinetic description of ion flow, correctly predicts that when the electrical driving force ($V_m$) exactly counterbalances the chemical driving force (encapsulated in $E_i$), the net driving potential $(V_m - E_i)$ is zero, and consequently, the net current is zero. This demonstrates the internal consistency between the thermodynamic definition of equilibrium and the phenomenological (Ohmic) model of ion current.\n\n### Task 3: Numerical Demonstration\n\nFor the final task, a program is to be implemented to compute the current density $j_i$ for a suite of $6$ test cases. The implementation will follow the principles outlined above.\n\nFor each test case, defined by a tuple of parameters $(T, z_i, c_{i,\\text{out}}, c_{i,\\text{in}}, g_i, \\text{Vm\\_mode}, ...)$, the program must first calculate the Nernst potential $E_i$ using the derived formula:\n$$\nE_i = \\frac{R T}{z_i F} \\ln \\left(\\frac{c_{i,\\text{out}}}{c_{i,\\text{in}}}\\right)\n$$\nThe required physical constants are $R = 8.31446261815324$ J/(mol路K) and $F = 96485.33212$ C/mol.\n\nNext, the membrane potential $V_m$ is determined based on the `Vm_mode` for the test case:\n- If `Vm_mode` is `\"clamp\"`, $V_m$ is set equal to the computed $E_i$.\n- If `Vm_mode` is `\"clamp_plus\"`, $V_m$ is set to $E_i + \\delta$, where $\\delta$ is an additional parameter provided in the test case.\n- If `Vm_mode` is `\"set\"`, $V_m$ is set to a specific value provided in the test case.\n\nFinally, the current density $j_i$ is calculated using the conductance model:\n$$\nj_i = g_i (V_m - E_i)\n$$\nThe resulting values for $j_i$ for all $6$ tests are then formatted and printed according to the problem specification. For cases where $V_m$ is set to $E_i$, we expect $j_i$ to be exactly zero. For cases where $V_m \\neq E_i$, a non-zero current will flow, with its magnitude proportional to the conductance $g_i$ and the driving potential $(V_m - E_i)$. The sign of the current will indicate its direction (by convention, positive current is outward flow of positive charge).\nThe numerical implementation will be provided in the following section.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the transmembrane current density for a series of test cases\n    based on the Nernst potential and a conductance model.\n    \"\"\"\n\n    # Define physical constants as specified in the problem\n    R = 8.31446261815324  # Universal gas constant in J/(mol路K)\n    F = 96485.33212       # Faraday constant in C/mol\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (T, z_i, c_out, c_in, g_i, Vm_mode, *args)\n    # where T is temperature (K), z_i is valence, c_out/c_in are concentrations (M),\n    # g_i is conductance density (S/m^2), and Vm_mode specifies how to set Vm.\n    test_cases = [\n        # Test 1 (happy path, monovalent cation at physiological temperature)\n        (310.0, 1, 5e-3, 140e-3, 10.0, \"clamp\"),\n        # Test 2 (small deviation from equilibrium)\n        (310.0, 1, 5e-3, 140e-3, 10.0, \"clamp_plus\", 0.005),\n        # Test 3 (anion at room temperature)\n        (298.0, -1, 110e-3, 5e-3, 5.0, \"clamp\"),\n        # Test 4 (divalent cation with large concentration gradient)\n        (310.0, 2, 2e-3, 1e-7, 0.5, \"clamp\"),\n        # Test 5 (boundary case: equal concentrations)\n        (310.0, 1, 100e-3, 100e-3, 1.0, \"set\", 0.0),\n        # Test 6 (very small conductance, large driving force)\n        (310.0, 1, 150e-3, 15e-3, 1e-9, \"clamp_plus\", 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for the current test case\n        T, z_i, c_out, c_in, g_i, vm_mode, *args = case\n\n        # Task 1: Calculate the Nernst equilibrium potential (E_i)\n        # E_i = (R * T) / (z_i * F) * ln(c_out / c_in)\n        # Note: numpy.log is the natural logarithm.\n        # Handle the case where concentrations are equal to avoid log(1) computation issues,\n        # though it resolves to 0. Also, z_i cannot be 0.\n        if z_i == 0:\n            # The Nernst equation is undefined for uncharged species.\n            # This case is not in the test suite but is good practice to handle.\n            e_i = np.nan\n        elif c_out = 0 or c_in = 0:\n            # Logarithm is undefined for non-positive concentrations.\n            e_i = np.nan\n        else:\n            e_i = (R * T) / (z_i * F) * np.log(c_out / c_in)\n\n        # Set the membrane potential (V_m) based on the specified mode\n        v_m = 0.0\n        if vm_mode == \"clamp\":\n            v_m = e_i\n        elif vm_mode == \"clamp_plus\":\n            delta = args[0]\n            v_m = e_i + delta\n        elif vm_mode == \"set\":\n            v_m = args[0]\n\n        # Task 3: Evaluate the conductance-model current density (j_i)\n        # j_i = g_i * (V_m - E_i)\n        j_i = g_i * (v_m - e_i)\n\n        results.append(j_i)\n\n    # Format the results as specified and print to standard output.\n    # Each value in scientific notation with exactly 12 digits after the decimal point.\n    formatted_results = [f\"{res:.12e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}