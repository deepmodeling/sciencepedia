{
    "hands_on_practices": [
        {
            "introduction": "要理解神经元模型的复杂动态，一个关键的起点是分析其在特定状态下的局部行为。雅可比矩阵为我们提供了这种分析的数学工具，它通过线性化来近似平衡点或任何其他点附近的非线性动力学。通过推导和解释菲茨休-南云（FitzHugh-Nagumo）模型的雅可比矩阵，你将学会如何量化快电压变量和慢恢复变量之间的相互作用，并理解它们在决定神经元局部稳定性和兴奋性中的作用。",
            "id": "3924729",
            "problem": "考虑一个简化神经元的无量纲 FitzHugh–Nagumo (FHN) 模型，其状态变量为膜电位代理 $v$ 和恢复变量 $w$，并由恒定输入电流 $I$ 驱动：\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\;\\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\\qquad\n\\frac{dw}{dt} \\;=\\; \\varepsilon\\left(v \\;+\\; a \\;-\\; b\\,w\\right),\n$$\n其中 $\\varepsilon > 0$ 设定了快速电压子系统和慢速恢复子系统之间的时间尺度分离，而 $a > 0$, $b > 0$ 是参数。从向量场的雅可比矩阵的定义（即其右侧函数关于状态变量的一阶偏导数矩阵）出发，完成以下任务：\n\n(1) 推导 FHN 向量场在任意点 $(v,w)$ 处的雅可比矩阵 $J(v,w)$。\n\n(2) 解释 $J(v,w)$ 的每个元素如何表示从一个状态到另一个状态瞬时变化率的局部增益，以及 $\\varepsilon$ 相对于 $1$ 的小量级如何在局部线性化中反映时间尺度分离。\n\n(3) 施加参数关系 $I = a/b$，并验证 $(v^{\\ast},w^{\\ast}) = (0,\\,I)$ 是系统的一个平衡点。然后，计算该平衡点处的雅可比矩阵行列式 $\\det J(v^{\\ast},w^{\\ast})$。\n\n你的最终答案应为仅包含 $\\varepsilon$ 和 $b$ 的单个闭式解析表达式。最终答案无需单位。如果你选择代入数值，请精确表示你的最终数字，无需四舍五入。",
            "solution": "该问题要求分析 FitzHugh-Nagumo (FHN) 模型，这是一个由两个耦合常微分方程组成的系统。分析内容包括推导雅可比矩阵、解释其元素，并在一个特定的平衡点处计算其行列式。\n\n系统的状态由向量 $\\mathbf{x}(t) = \\begin{pmatrix} v(t) \\\\ w(t) \\end{pmatrix}$ 描述，其中 $v$ 是膜电位代理，$w$ 是恢复变量。其动力学由向量场 $\\mathbf{F}(v,w)$ 控制：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix} f(v,w) \\\\ g(v,w) \\end{pmatrix} = \\begin{pmatrix} v - \\frac{v^{3}}{3} - w + I \\\\ \\varepsilon(v + a - bw) \\end{pmatrix}\n$$\n参数 $\\varepsilon$、$a$ 和 $b$ 均为正常数。\n\n(1) 推导雅可比矩阵 $J(v,w)$。\n\n向量场 $\\mathbf{F}$ 的雅可比矩阵是其关于状态变量 $v$ 和 $w$ 的所有一阶偏导数组成的矩阵。根据定义：\n$$\nJ(v,w) = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} = \\begin{pmatrix} \\frac{\\partial f}{\\partial v}  \\frac{\\partial f}{\\partial w} \\\\ \\frac{\\partial g}{\\partial v}  \\frac{\\partial g}{\\partial w} \\end{pmatrix}\n$$\n我们根据给定的函数 $f(v,w)$ 和 $g(v,w)$ 计算每个偏导数：\n- 函数 $f(v,w) = v - \\frac{v^{3}}{3} - w + I$ 关于 $v$ 的偏导数为：\n$$\n\\frac{\\partial f}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = 1 - v^{2}\n$$\n- 函数 $f(v,w)$ 关于 $w$ 的偏导数为：\n$$\n\\frac{\\partial f}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = -1\n$$\n- 函数 $g(v,w) = \\varepsilon(v + a - bw)$ 关于 $v$ 的偏导数为：\n$$\n\\frac{\\partial g}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = \\varepsilon\n$$\n- 函数 $g(v,w)$ 关于 $w$ 的偏导数为：\n$$\n\\frac{\\partial g}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = -\\varepsilon b\n$$\n将这些分量组合起来，FHN 系统在任意点 $(v,w)$ 处的雅可比矩阵为：\n$$\nJ(v,w) = \\begin{pmatrix} 1 - v^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\n\n(2) 雅可比矩阵和时间尺度分离参数 $\\varepsilon$ 的解释。\n\n在点 $(v_0, w_0)$ 处的雅可比矩阵 $J(v_0, w_0)$ 表示了该点附近非线性动力学的最佳线性近似。从 $(v_0, w_0)$ 出发的一个小扰动 $(\\delta v, \\delta w)$ 将根据线性系统 $\\frac{d}{dt}\\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix} \\approx J(v_0, w_0) \\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix}$ 演化。雅可比矩阵的每个元素 $J_{ij}$ 代表第 $i$ 个状态变量的变化率对第 $j$ 个状态变量微小变化的局部“增益”或线性灵敏度。\n\n- $J_{11} = 1 - v^{2}$：此项描述了电位 $v$ 对其自身变化率 $\\frac{dv}{dt}$ 的局部影响。当 $|v|  1$ 时，$J_{11} > 0$，表示局部自激（正反馈）。当 $|v| > 1$ 时，$J_{11}  0$，表示局部自抑制（负反馈）。这种三次非线性是模型可兴奋性的来源。\n- $J_{12} = -1$：此项是恢复变量 $w$ 到电位变化率 $\\frac{dv}{dt}$ 的增益。其恒定的负值意味着 $w$ 总是起到降低 $v$ 的作用，这证明了其作为“恢复”或“抑制”变量的角色。\n- $J_{21} = \\varepsilon$：此项是电位 $v$ 到恢复变量变化率 $\\frac{dw}{dt}$ 的增益。其正值表示 $v$ 的增加会倾向于增加 $w$，代表了从 $v$ 到 $w$ 的兴奋性耦合。\n- $J_{22} = -\\varepsilon b$：此项描述了 $w$ 对其自身变化率 $\\frac{dw}{dt}$ 的局部影响。由于 $\\varepsilon > 0$ 且 $b > 0$，此项恒为负，代表了恢复变量的自抑制或衰减过程。\n\n参数 $\\varepsilon$ 设定了 $w$ 动力学的时间尺度。问题中指出 $\\varepsilon > 0$ 并说明它控制时间尺度分离，这通常意味着 $\\varepsilon \\ll 1$。决定 $w$ 动力学的雅可比矩阵元素，即 $J_{21} = \\varepsilon$ 和 $J_{22} = -\\varepsilon b$，都与 $\\varepsilon$ 成正比。在线性化系统中，这意味着扰动 $\\delta w$ 的变化率远小于扰动 $\\delta v$ 的变化率。具体来说，$\\frac{d(\\delta w)}{dt} = \\varepsilon(\\delta v - b\\delta w)$，而 $\\frac{d(\\delta v)}{dt} = (1 - v^2)\\delta v - \\delta w$。对于 $\\varepsilon \\ll 1$ 的情况，$w$ 的响应比 $v$ 的响应慢得多，这就是局部动力学中时间尺度分离的本质。\n\n(3) 平衡点分析与行列式计算。\n\n平衡点 $(v^{\\ast}, w^{\\ast})$ 是向量场为零的点，即 $\\frac{dv}{dt} = 0$ 且 $\\frac{dw}{dt} = 0$。\n$$\nv^{\\ast} - \\frac{(v^{\\ast})^{3}}{3} - w^{\\ast} + I = 0\n$$\n$$\n\\varepsilon(v^{\\ast} + a - bw^{\\ast}) = 0\n$$\n问题要求施加参数关系 $I = a/b$ 并验证 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 是一个平衡点。我们将 $v^{\\ast}=0$ 和 $w^{\\ast}=I$ 代入两个平衡方程。\n- 对第一个方程：\n$$\n(0) - \\frac{(0)^{3}}{3} - (I) + I = 0 - 0 - I + I = 0\n$$\n该方程成立。\n- 对第二个方程，由于 $\\varepsilon > 0$，我们需要检查是否 $v^{\\ast} + a - bw^{\\ast} = 0$：\n$$\n(0) + a - b(I) = a - bI = 0\n$$\n该方程当且仅当 $a = bI$ (即 $I = a/b$) 时成立。由于这是施加的条件，因此点 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 在此条件下确实是系统的一个平衡点。\n\n接下来，我们计算该平衡点 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 处的雅可比矩阵。我们将 $v=0$ 和 $w=I$ 代入 $J(v,w)$ 的通用表达式中：\n$$\nJ(v^{\\ast}, w^{\\ast}) = J(0, I) = \\begin{pmatrix} 1 - (0)^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\n最后，我们计算该矩阵的行列式：\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = \\det \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = (1)(-\\varepsilon b) - (-1)(\\varepsilon)\n$$\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = -\\varepsilon b + \\varepsilon = \\varepsilon(1-b)\n$$\n在条件 $I=a/b$ 下，平衡点 $(0, I)$ 处的雅可比矩阵行列式为 $\\varepsilon(1-b)$。此表达式使用了所要求的参数 $\\varepsilon$ 和 $b$ 来表示。",
            "answer": "$$\\boxed{\\varepsilon(1-b)}$$"
        },
        {
            "introduction": "在掌握了局部稳定性分析之后，下一步是探究当输入电流等参数变化时，模型的整体行为如何发生质的改变——这一领域被称为分岔分析。鞍结分岔是神经元模型中一种至关重要的分岔类型，它标志着平衡点的产生或消失，并常常对应于神经元从静息态到放电态的阈值。这项练习将通过几何（零斜线相切）和代数（判别式为零）两种方法，让你亲手计算出这一临界转变发生的点，从而深化对神经元兴奋性阈值机制的理解。",
            "id": "3924768",
            "problem": "考虑由以下耦合常微分方程给出的菲茨休-南云（FHN）简化神经元模型\n$$\n\\frac{dv}{dt} = v - \\frac{v^{3}}{3} - w + I, \\qquad \\frac{dw}{dt} = \\epsilon \\left(v + a - b w\\right),\n$$\n其中，$v$ 是膜电位，$w$ 是恢复变量，$I$ 是无量纲恒定输入电流，而 $\\epsilon$、$a$ 和 $b$ 是固定参数，且 $\\epsilon > 0$。在平衡状态下，零斜线满足\n$$\nw = v - \\frac{v^{3}}{3} + I, \\qquad w = \\frac{v + a}{b}.\n$$\n当这些零斜线在 $(v,w)$ 平面上彼此相切时，会发生平衡点的鞍结分岔。从零斜线的定义和相切的几何条件出发，确定在参数值 $a = 0.3$ 和 $b = 2$ 的情况下，发生鞍结分岔时无量纲输入电流 $I$ 的正值。然后，通过证明在此 $I$ 值下，关于 $v$ 的三次平衡方程的判别式为零，来验证您的结果。将最终数值答案四舍五入至四位有效数字。电流 $I$ 是无量纲的；不包含单位。",
            "solution": "用户希望找到在菲茨休-南云模型中发生鞍结分岔的输入电流 $I$ 的正值，并验证此结果。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- 菲茨休-南云模型方程：\n  $$ \\frac{dv}{dt} = v - \\frac{v^{3}}{3} - w + I $$\n  $$ \\frac{dw}{dt} = \\epsilon \\left(v + a - b w\\right) $$\n- 参数：$\\epsilon > 0$, $a = 0.3$, $b = 2$。\n- 平衡状态下的零斜线方程：\n  1. $v$-零斜线：$w = v - \\frac{v^{3}}{3} + I$\n  2. $w$-零斜线：$w = \\frac{v + a}{b}$\n- 鞍结分岔的条件：零斜线在 $(v,w)$ 平面上彼此相切。\n- 任务：\n  1. 对给定的参数，确定导致这种相切的 $I$ 的正值。\n  2. 通过证明关于 $v$ 的三次平衡方程的判别式为零来验证结果。\n  3. 将 $I$ 的最终答案四舍五入至四位有效数字。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：菲茨休-南云模型是理论神经科学中的一个经典模型。通过零斜线、不动点（平衡点）和分岔（如鞍结分岔）来分析其动力学是研究动力系统的标准和基本技术。该问题在科学上和数学上都是合理的。\n- **适定性**：问题定义明确。它提供了所有必要的方程和参数值。分岔的条件（零斜线相切）是一个清晰的几何和代数约束，允许对参数 $I$ 求得唯一解。通过第二种标准方法（三次方程的判别式）进行验证的要求进一步强化了问题的良好结构。\n- **客观性**：问题以精确的数学语言陈述，没有任何主观性或模糊性。\n\n**1.3. 结论与行动**\n问题有效。我将继续提供完整的解答。\n\n### 步骤 2：解答\n\n当零斜线相切时，会发生平衡点的鞍结分岔。这意味着在切点 $(v_c, w_c)$，零斜线曲线的 $w$ 值和斜率 $\\frac{dw}{dv}$ 都必须相等。\n\n两条零斜线由以下方程给出：\n1. 三次零斜线 ($dv/dt = 0$)：$w = v - \\frac{v^3}{3} + I$\n2. 线性零斜线 ($dw/dt = 0$)：$w = \\frac{v + a}{b}$\n\n首先，我们通过对每个 $w$ 的表达式关于 $v$ 求导来找到斜率：\n1. 三次零斜线的斜率：$\\frac{dw}{dv} = \\frac{d}{dv} \\left(v - \\frac{v^3}{3} + I\\right) = 1 - v^2$\n2. 线性零斜线的斜率：$\\frac{dw}{dv} = \\frac{d}{dv} \\left(\\frac{v + a}{b}\\right) = \\frac{1}{b}$\n\n在切点 $v_c$ 处，这些斜率必须相等：\n$$ 1 - v_c^2 = \\frac{1}{b} $$\n问题给出了参数值 $b=2$。代入此值可得：\n$$ 1 - v_c^2 = \\frac{1}{2} $$\n$$ v_c^2 = 1 - \\frac{1}{2} = \\frac{1}{2} $$\n这得出了在分岔点膜电位的两个可能值：\n$$ v_c = \\pm \\frac{1}{\\sqrt{2}} $$\n\n现在我们使用相切的第二个条件：在 $v = v_c$ 时，$w$ 的值也必须相等。\n$$ v_c - \\frac{v_c^3}{3} + I = \\frac{v_c + a}{b} $$\n我们可以重新整理这个方程来解出输入电流 $I$：\n$$ I = \\frac{v_c + a}{b} - v_c + \\frac{v_c^3}{3} $$\n给定 $a = 0.3$ 和 $b = 2$。让我们检查 $v_c$ 的两种可能情况。\n\n情况 1：$v_c = +\\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{\\frac{1}{\\sqrt{2}} + 0.3}{2} - \\frac{1}{\\sqrt{2}} + \\frac{\\left(\\frac{1}{\\sqrt{2}}\\right)^3}{3} $$\n$$ I = \\frac{1}{2\\sqrt{2}} + 0.15 - \\frac{1}{\\sqrt{2}} + \\frac{1}{3 \\cdot 2\\sqrt{2}} = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{1}{2} - 1 + \\frac{1}{6}\\right) $$\n$$ I = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{3 - 6 + 1}{6}\\right) = 0.15 - \\frac{2}{6\\sqrt{2}} = 0.15 - \\frac{1}{3\\sqrt{2}} $$\n数值上，$I \\approx 0.15 - \\frac{1}{4.2426} \\approx 0.15 - 0.2357 = -0.0857$。这是一个负值。\n\n情况 2：$v_c = -\\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{-\\frac{1}{\\sqrt{2}} + 0.3}{2} - \\left(-\\frac{1}{\\sqrt{2}}\\right) + \\frac{\\left(-\\frac{1}{\\sqrt{2}}\\right)^3}{3} $$\n$$ I = -\\frac{1}{2\\sqrt{2}} + 0.15 + \\frac{1}{\\sqrt{2}} - \\frac{1}{3 \\cdot 2\\sqrt{2}} = 0.15 + \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{2} + 1 - \\frac{1}{6}\\right) $$\n$$ I = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{-3 + 6 - 1}{6}\\right) = 0.15 + \\frac{2}{6\\sqrt{2}} = 0.15 + \\frac{1}{3\\sqrt{2}} $$\n数值上，$I \\approx 0.15 + 0.2357 = 0.3857$。这是一个正值。\n\n问题要求 $I$ 的正值，即 $I = 0.15 + \\frac{1}{3\\sqrt{2}}$。\n\n### 使用三次平衡方程的判别式进行验证\n\n系统的平衡点是零斜线的交点。我们通过消去 $w$ 来找到关于 $v$ 的平衡方程：\n$$ v - \\frac{v^3}{3} + I = \\frac{v + a}{b} $$\n代入参数值 $a=0.3$ 和 $b=2$：\n$$ v - \\frac{v^3}{3} + I = \\frac{v + 0.3}{2} $$\n为了得到一个多项式方程，我们乘以 $6$：\n$$ 6v - 2v^3 + 6I = 3v + 0.9 $$\n整理成三次方程的标准形式 ($Ax^3+Bx^2+Cx+D=0$)：\n$$ 2v^3 - 3v - 6I + 0.9 = 0 $$\n为了使用降次三次方程 ($x^3+px+q=0$) 的标准判别式公式，我们除以 $2$：\n$$ v^3 - \\frac{3}{2}v + (0.45 - 3I) = 0 $$\n对于此方程，系数为 $p = -\\frac{3}{2}$ 和 $q = 0.45 - 3I$。\n鞍结分岔对应于两个实根的合并，这发生在三次方程的判别式为零时。对于 $x^3+px+q=0$，判别式 $\\Delta$ 由 $\\Delta = -4p^3 - 27q^2$ 给出。\n将判别式设为零：\n$$ -4\\left(-\\frac{3}{2}\\right)^3 - 27(0.45 - 3I)^2 = 0 $$\n$$ -4\\left(-\\frac{27}{8}\\right) - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{27}{2} - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{1}{2} = (0.45 - 3I)^2 $$\n两边取平方根：\n$$ \\pm \\frac{1}{\\sqrt{2}} = 0.45 - 3I $$\n解出 $I$：\n$$ 3I = 0.45 \\mp \\frac{1}{\\sqrt{2}} $$\n$$ I = \\frac{0.45}{3} \\mp \\frac{1}{3\\sqrt{2}} = 0.15 \\mp \\frac{1}{3\\sqrt{2}} $$\n这得出了与相切法相同的两个 $I$ 值：\n$$ I_1 = 0.15 - \\frac{1}{3\\sqrt{2}} \\approx -0.0857 $$\n$$ I_2 = 0.15 + \\frac{1}{3\\sqrt{2}} \\approx 0.3857 $$\n问题要求验证早前找到的 $I$ 的正值 ($I = 0.15 + \\frac{1}{3\\sqrt{2}}$) 是否使判别式为零。让我们将此值代入判别式的表达式中：\n判别式表达式中平方项内的项是 $(0.45 - 3I)$。让我们用我们的正值 $I$ 来计算它：\n$$ 0.45 - 3I = 0.45 - 3\\left(0.15 + \\frac{1}{3\\sqrt{2}}\\right) = 0.45 - \\left(0.45 + \\frac{1}{\\sqrt{2}}\\right) = -\\frac{1}{\\sqrt{2}} $$\n现在将此代回判别式方程：\n$$ \\Delta = \\frac{27}{2} - 27\\left(-\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{27}{2} - 27\\left(\\frac{1}{2}\\right) = 0 $$\n对于这个 $I$ 值，判别式确实为零。这验证了结果。\n\n所要求的 $I$ 的正值为：\n$$ I = 0.15 + \\frac{1}{3\\sqrt{2}} = 0.15 + \\frac{\\sqrt{2}}{6} \\approx 0.15 + \\frac{1.41421356}{6} \\approx 0.15 + 0.23570226 \\approx 0.38570226 $$\n四舍五入到四位有效数字，我们得到 $I = 0.3857$。",
            "answer": "$$ \\boxed{0.3857} $$"
        },
        {
            "introduction": "理论分析虽然强大，但计算模拟是探索更复杂的生物物理模型的不可或缺的工具。本练习将从菲茨休-南云模型转向更具生物细节的莫里斯-勒卡（Morris-Lecar）模型，并要求你通过编写代码来研究一个核心的神经计算问题。你将通过模拟计算频率-电流（F-I）曲线——这是表征神经元输入-输出关系的基本工具——并分析漏导（$g_L$）如何影响其斜率（即神经元增益）。这项实践将理论与应用相结合，让你能够直接探究特定离子通道参数如何塑造神经元的信息处理特性。",
            "id": "3924732",
            "problem": "考虑一个单室电导神经元模型，其中膜电位 $V$ 遵循空间等电位区域的电流平衡定律：电容性电流和离子电流之和等于外部注入电流。Morris–Lecar (ML) 模型描述了快速再生钙电流和较慢的恢复性钾电流之间的相互作用。在此问题中，您将通过数值模拟来量化漏电导 $g_L$ 如何使频率-电流 (F–I) 曲线变平或变陡，并通过对再生内向电流的有效分流来解释结果。\n\n基本原理：\n- 单室电流平衡为 $C \\,\\dfrac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}$，其中 $C$ 是膜电容，$I_{\\text{ext}}$ 是注入电流，$I_L$ 是漏电流，$I_{\\text{Ca}}$ 是钙电流，$I_{\\text{K}}$ 是钾电流。\n- 在 Morris–Lecar 框架中，$I_L = g_L \\,(V - E_L)$，$I_{\\text{Ca}} = g_{\\text{Ca}} \\, m_{\\infty}(V)\\,(V - E_{\\text{Ca}})$，$I_{\\text{K}} = g_{\\text{K}} \\, w \\,(V - E_{\\text{K}})$，且门控变量 $w$ 遵循一级动力学 $ \\dfrac{dw}{dt} = \\phi \\,\\dfrac{w_{\\infty}(V) - w}{\\tau_w(V)}$。\n- 稳态激活函数为 $m_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_1}{V_2}\\right)\\right)$ 和 $w_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_3}{V_4}\\right)\\right)$，电压依赖性时间尺度为 $\\tau_w(V) = \\dfrac{1}{\\cosh\\left(\\dfrac{V - V_3}{2 V_4}\\right)}$。\n\n模型参数 (使用以下固定值)：\n- $C = 20$ $\\mu\\mathrm{F}/\\mathrm{cm}^2$，\n- $g_{\\text{Ca}} = 4.4$ $\\mathrm{mS}/\\mathrm{cm}^2$，\n- $g_{\\text{K}} = 8$ $\\mathrm{mS}/\\mathrm{cm}^2$，\n- $E_{\\text{Ca}} = 120$ $\\mathrm{mV}$，\n- $E_{\\text{K}} = -84$ $\\mathrm{mV}$，\n- $E_L = -60$ $\\mathrm{mV}$，\n- $V_1 = -1.2$ $\\mathrm{mV}$，\n- $V_2 = 18$ $\\mathrm{mV}$，\n- $V_3 = 2$ $\\mathrm{mV}$，\n- $V_4 = 30$ $\\mathrm{mV}$，\n- $\\phi = 0.04$ $\\mathrm{ms}^{-1}$。\n\n模拟设置与定义：\n- 使用固定步长四阶龙格－库塔方法，以恒定步长 $\\Delta t = 0.05$ $\\mathrm{ms}$ 模拟该模型，总时长为 $T_{\\text{total}} = 1000$ $\\mathrm{ms}$。\n- 使用初始条件 $V(0) = -60$ $\\mathrm{mV}$ 和 $w(0) = w_{\\infty}(V(0))$。\n- 施加恒定的注入电流 $I_{\\text{ext}}$ (单位 $\\mu\\mathrm{A}/\\mathrm{cm}^2$)。\n- 脉冲定义为膜电位向上穿越阈值 $V_{\\text{th}} = 0$ $\\mathrm{mV}$ 的事件。\n- 将发放频率 $f$ (单位 Hz) 计算为脉冲数量除以分析窗口的持续时间（以秒为单位）；使用一个从 $t_{\\text{start}} = 300$ $\\mathrm{ms}$ 开始到 $T_{\\text{total}}$ 结束的分析窗口。\n- 对于每个漏电导 $g_L$，使用有限差分计算频率-电流斜率 $S$ (单位 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$)：\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1},\n$$\n其中 $I_1$ 和 $I_2$ 是两个注入电流，且 $I_2 > I_1$。\n\n任务：\n- 实现上述 ML 模型和模拟协议。\n- 对于给定的电流对 $\\{I_1, I_2\\}$，计算每个指定 $g_L$ 对应的 $S$。\n- 将每个 $S$ 作为浮点数返回，四舍五入至六位小数，单位 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$ 被隐式理解。\n\n测试套件：\n- 对所有测试使用电流对 $\\{I_1, I_2\\} = \\{90.0, 130.0\\}$ $\\mu\\mathrm{A}/\\mathrm{cm}^2$。\n- 评估四种漏电导情况：\n    1. 正常路径：$g_L = 2.0$ $\\mathrm{mS}/\\mathrm{cm}^2$。\n    2. 中等漏电导增加：$g_L = 4.0$ $\\mathrm{mS}/\\mathrm{cm}^2$。\n    3. 大漏电导：$g_L = 8.0$ $\\mathrm{mS}/\\mathrm{cm}^2$。\n    4. 极端漏电导 (边缘情况)：$g_L = 16.0$ $\\mathrm{mS}/\\mathrm{cm}^2$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述测试套件顺序排列的四个斜率结果，形式为逗号分隔的列表，并用方括号括起来 (例如, $\\left[ s_1, s_2, s_3, s_4 \\right]$)。\n- 每个条目必须是四舍五入到六位小数的浮点数。\n- 斜率的单位是 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$。",
            "solution": "该问题要求计算 Morris-Lecar 神经元模型在不同漏电导值 $g_L$ 下的频率-电流 (F-I) 曲线斜率。这通过数值模拟来实现。解决方案涉及实现模型的动力学，使用指定的数值积分方案进行模拟，并分析产生的脉冲序列以计算发放频率。\n\nMorris-Lecar 模型是一个二维耦合常微分方程 (ODE) 系统，描述了膜电位 $V$ (单位 $\\mathrm{mV}$) 和钾通道门控变量 $w$ (无量纲) 的演化。方程如下：\n$$\nC \\frac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}\n$$\n$$\n\\frac{dw}{dt} = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\n其中 $C$ 是膜电容，$I_{\\text{ext}}$ 是外部注入电流，离子电流由以下公式给出：\n- 漏电流：$I_L = g_L (V - E_L)$\n- 钙电流：$I_{\\text{Ca}} = g_{\\text{Ca}} m_{\\infty}(V) (V - E_{\\text{Ca}})$\n- 钾电流：$I_{\\text{K}} = g_{\\text{K}} w (V - E_{\\text{K}})$\n\n电压依赖的稳态激活函数 ($m_{\\infty}(V)$、$w_{\\infty}(V)$) 和 $w$ 变量的时间尺度 ($\\tau_w(V)$) 定义如下：\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right)\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\n\n模型的固定参数指定如下：\n- $C = 20 \\, \\mu\\mathrm{F}/\\mathrm{cm}^2$\n- $g_{\\text{Ca}} = 4.4 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $g_{\\text{K}} = 8 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $E_{\\text{Ca}} = 120 \\, \\mathrm{mV}$\n- $E_{\\text{K}} = -84 \\, \\mathrm{mV}$\n- $E_L = -60 \\, \\mathrm{mV}$\n- $V_1 = -1.2 \\, \\mathrm{mV}$\n- $V_2 = 18 \\, \\mathrm{mV}$\n- $V_3 = 2 \\, \\mathrm{mV}$\n- $V_4 = 30 \\, \\mathrm{mV}$\n- $\\phi = 0.04 \\, \\mathrm{ms}^{-1}$\n\n为求解此常微分方程组，我们采用固定时间步长 $\\Delta t = 0.05$ ms 的四阶龙格－库塔 (RK4) 方法。对于时间 $t_n$ 的状态向量 $\\mathbf{y}_n = [V_n, w_n]^T$，下一个时间步 $t_{n+1} = t_n + \\Delta t$ 的状态计算如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n其中 $\\mathbf{f}(\\mathbf{y}) = [dV/dt, dw/dt]^T$ 且：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\mathbf{k}_3)\n\\end{aligned}\n$$\n每次模拟的总时长为 $T_{\\text{total}} = 1000$ ms，从初始条件 $V(0) = -60$ mV 和 $w(0) = w_{\\infty}(V(0))$ 开始。\n\n每次模拟后，计算发放频率 $f$。一个脉冲定义为膜电位 $V$ 向上穿越阈值 $V_{\\text{th}} = 0$ mV 的事件。在一个从 $t_{\\text{start}} = 300$ ms 开始到 $T_{\\text{total}}$ 结束的分析窗口内对脉冲数量 $N_{\\text{spikes}}$ 进行计数。丢弃最初的 $300$ ms 是为了确保分析在初始瞬态衰减后，对神经元的稳态响应进行。发放频率 (单位赫兹 Hz) 则为：\n$$\nf = \\frac{N_{\\text{spikes}}}{(T_{\\text{total}} - t_{\\text{start}}) / 1000}\n$$\n分母 $(1000 - 300)/1000 = 0.7$ s 是分析窗口的持续时间（以秒为单位）。\n\n核心任务是计算四种不同漏电导 $g_L$ 值（$\\{2.0, 4.0, 8.0, 16.0\\}$ $\\mathrm{mS}/\\mathrm{cm}^2$）下 F-I 曲线的斜率 $S$。对于每个 $g_L$，使用注入电流 $I_1 = 90.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ 和 $I_2 = 130.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ 进行两次模拟，以获得相应的发放频率 $f(I_1)$ 和 $f(I_2)$。然后使用有限差分近似计算斜率 $S$：\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1}\n$$\n每个 $g_L$ 的最终结果四舍五入到六位小数。整个过程通过一个 Python 脚本实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation and calculation of F-I curve slopes\n    for the Morris-Lecar model.\n    \"\"\"\n\n    class MorrisLecarModel:\n        \"\"\"\n        Encapsulates the Morris-Lecar model parameters and differential equations.\n        \"\"\"\n        def __init__(self, g_L):\n            # Fixed parameters as specified in the problem\n            self.C = 20.0        # uF/cm^2\n            self.g_Ca = 4.4      # mS/cm^2\n            self.g_K = 8.0       # mS/cm^2\n            self.E_Ca = 120.0    # mV\n            self.E_K = -84.0     # mV\n            self.E_L = -60.0     # mV\n            self.V1 = -1.2       # mV\n            self.V2 = 18.0       # mV\n            self.V3 = 2.0        # mV\n            self.V4 = 30.0       # mV\n            self.phi = 0.04      # ms^-1\n            \n            # Variable parameter\n            self.g_L = g_L       # mS/cm^2\n            \n        def m_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V1) / self.V2))\n            \n        def w_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V3) / self.V4))\n            \n        def tau_w(self, V):\n            return 1.0 / np.cosh((V - self.V3) / (2.0 * self.V4))\n\n        def derivatives(self, state, I_ext):\n            \"\"\"\n            Computes the derivatives [dV/dt, dw/dt] for the Morris-Lecar model.\n            \n            Args:\n                state (np.array): Current state [V, w].\n                I_ext (float): External injected current.\n            \n            Returns:\n                np.array: The derivatives [dV/dt, dw/dt].\n            \"\"\"\n            V, w = state\n            \n            # Ionic currents\n            I_L = self.g_L * (V - self.E_L)\n            I_Ca = self.g_Ca * self.m_inf(V) * (V - self.E_Ca)\n            I_K = self.g_K * w * (V - self.E_K)\n            \n            # ODEs from current balance equation\n            dV_dt = (I_ext - I_L - I_Ca - I_K) / self.C\n            dw_dt = self.phi * (self.w_inf(V) - w) / self.tau_w(V)\n            \n            return np.array([dV_dt, dw_dt])\n\n    def run_simulation_and_get_rate(g_L, I_ext):\n        \"\"\"\n        Runs a simulation of the ML model and calculates the firing rate.\n\n        Args:\n            g_L (float): Leak conductance.\n            I_ext (float): External injected current.\n        \n        Returns:\n            float: The calculated firing rate in Hz.\n        \"\"\"\n        # Simulation parameters\n        dt = 0.05          # ms\n        T_total = 1000.0   # ms\n        t_start = 300.0    # ms\n        V_th = 0.0         # mV\n\n        model = MorrisLecarModel(g_L)\n        \n        num_steps = int(T_total / dt)\n        \n        # State variable arrays to store trajectory\n        V_trace = np.zeros(num_steps + 1)\n        w_trace = np.zeros(num_steps + 1)\n        \n        # Initial conditions\n        V_trace[0] = -60.0\n        w_trace[0] = model.w_inf(V_trace[0])\n        \n        # Simulation loop using fourth-order Runge-Kutta (RK4)\n        for i in range(num_steps):\n            state = np.array([V_trace[i], w_trace[i]])\n            \n            k1 = dt * model.derivatives(state, I_ext)\n            k2 = dt * model.derivatives(state + 0.5 * k1, I_ext)\n            k3 = dt * model.derivatives(state + 0.5 * k2, I_ext)\n            k4 = dt * model.derivatives(state + k3, I_ext)\n            \n            new_state = state + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n            \n            V_trace[i+1] = new_state[0]\n            w_trace[i+1] = new_state[1]\n\n        # Spike counting within the analysis window\n        spike_count = 0\n        analysis_start_index = int(t_start / dt)\n        \n        for i in range(analysis_start_index, num_steps + 1):\n            if V_trace[i-1]  V_th and V_trace[i] >= V_th:\n                spike_count += 1\n                \n        # Firing rate calculation\n        analysis_duration_s = (T_total - t_start) / 1000.0\n        firing_rate = spike_count / analysis_duration_s\n        \n        return firing_rate\n\n    # Test suite parameters from the problem statement\n    I1, I2 = 90.0, 130.0\n    g_L_cases = [2.0, 4.0, 8.0, 16.0]\n    \n    results = []\n    \n    # Loop through each test case for leak conductance\n    for g_L in g_L_cases:\n        # Calculate firing rate for the two current levels\n        f1 = run_simulation_and_get_rate(g_L=g_L, I_ext=I1)\n        f2 = run_simulation_and_get_rate(g_L=g_L, I_ext=I2)\n\n        # Calculate the F-I slope S using a finite difference\n        S = (f2 - f1) / (I2 - I1)\n            \n        results.append(round(S, 6))\n        \n    # Print the final output in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}