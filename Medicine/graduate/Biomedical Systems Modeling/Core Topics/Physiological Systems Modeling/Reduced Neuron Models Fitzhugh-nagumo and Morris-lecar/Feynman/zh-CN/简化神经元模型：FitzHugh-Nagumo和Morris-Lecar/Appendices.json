{
    "hands_on_practices": [
        {
            "introduction": "FitzHugh-Nagumo (FHN) 模型是理解神经元兴奋性的经典简化模型。分析任何动力系统的第一步是理解其在任意状态点周围的局部行为。本练习将指导您推导雅可比矩阵，这是一个将非线性动力学局部线性化的强大工具，揭示了膜电位和恢复变量如何相互影响对方的变化率，以及快慢时间尺度的分离是如何体现在模型中的 。",
            "id": "3924729",
            "problem": "考虑一个简化神经元的无量纲 FitzHugh–Nagumo (FHN) 模型，其状态变量为膜电位代理 $v$ 和恢复变量 $w$，并由恒定输入电流 $I$ 驱动：\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\;\\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\\qquad\n\\frac{dw}{dt} \\;=\\; \\varepsilon\\left(v \\;+\\; a \\;-\\; b\\,w\\right),\n$$\n其中 $\\varepsilon>0$ 设定了快电压子系统和慢恢复子系统之间的时间尺度分离，而 $a>0$，$b>0$ 是参数。从向量场的雅可比矩阵定义（即其右侧函数关于状态变量的一阶偏导数矩阵）出发，完成以下任务：\n\n(1) 推导 FHN 向量场在任意点 $(v,w)$ 处的雅可比矩阵 $J(v,w)$。\n\n(2) 解释 $J(v,w)$ 的每个元素如何编码从一个状态到另一个状态瞬时变化率的局部增益，以及 $\\varepsilon$ 相对于 $1$ 的小值如何在局部线性化中反映时间尺度分离。\n\n(3) 施加参数关系 $I = a/b$，并验证 $(v^{\\ast},w^{\\ast}) = (0,\\,I)$ 是系统的一个平衡点。然后，计算在该平衡点处的雅可比矩阵行列式 $\\det J(v^{\\ast},w^{\\ast})$。\n\n请用包含 $\\varepsilon$ 和 $b$ 的单个闭式解析表达式给出最终答案。最终答案不需要单位。如果您选择代入数值，请精确表示最终数字，无需四舍五入。",
            "solution": "该问题要求分析 FitzHugh-Nagumo (FHN) 模型，这是一个由两个耦合常微分方程组成的系统。分析内容包括推导雅可比矩阵、解释其元素，并在一个特定的平衡点处计算其行列式。\n\n系统的状态由向量 $\\mathbf{x}(t) = \\begin{pmatrix} v(t) \\\\ w(t) \\end{pmatrix}$ 描述，其中 $v$ 是膜电位代理，$w$ 是恢复变量。动力学由向量场 $\\mathbf{F}(v,w)$ 控制：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix} f(v,w) \\\\ g(v,w) \\end{pmatrix} = \\begin{pmatrix} v - \\frac{v^{3}}{3} - w + I \\\\ \\varepsilon(v + a - bw) \\end{pmatrix}\n$$\n参数 $\\varepsilon$、$a$ 和 $b$ 都是正常数。\n\n(1) 雅可比矩阵 $J(v,w)$ 的推导。\n\n向量场 $\\mathbf{F}$ 的雅可比矩阵是其关于状态变量 $v$ 和 $w$ 的所有一阶偏导数组成的矩阵。根据定义：\n$$\nJ(v,w) = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} = \\begin{pmatrix} \\frac{\\partial f}{\\partial v}  \\frac{\\partial f}{\\partial w} \\\\ \\frac{\\partial g}{\\partial v}  \\frac{\\partial g}{\\partial w} \\end{pmatrix}\n$$\n我们根据给定的函数 $f(v,w)$ 和 $g(v,w)$ 计算每个偏导数：\n- $f(v,w) = v - \\frac{v^{3}}{3} - w + I$ 关于 $v$ 的偏导数是：\n$$\n\\frac{\\partial f}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = 1 - v^{2}\n$$\n- $f(v,w)$ 关于 $w$ 的偏导数是：\n$$\n\\frac{\\partial f}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = -1\n$$\n- $g(v,w) = \\varepsilon(v + a - bw)$ 关于 $v$ 的偏导数是：\n$$\n\\frac{\\partial g}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = \\varepsilon\n$$\n- $g(v,w)$ 关于 $w$ 的偏导数是：\n$$\n\\frac{\\partial g}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = -\\varepsilon b\n$$\n将这些分量组合起来，FHN 系统在任意点 $(v,w)$ 的雅可比矩阵为：\n$$\nJ(v,w) = \\begin{pmatrix} 1 - v^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\n\n(2) 雅可比矩阵和时间尺度分离参数 $\\varepsilon$ 的解释。\n\n在点 $(v_0, w_0)$ 处的雅可比矩阵 $J(v_0, w_0)$ 代表了非线性动力学在该点邻域内的最佳线性近似。一个来自 $(v_0, w_0)$ 的小微扰 $(\\delta v, \\delta w)$ 根据线性系统 $\\frac{d}{dt}\\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix} \\approx J(v_0, w_0) \\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix}$ 演化。雅可比矩阵的每个元素 $J_{ij}$ 代表了第 $i$ 个状态变量的变化率对第 $j$ 个状态变量微小变化的局部“增益”或线性灵敏度。\n\n- $J_{11} = 1 - v^{2}$: 该项描述了电位 $v$ 对其自身变化率 $\\frac{dv}{dt}$ 的局部效应。当 $|v|  1$ 时，$J_{11} > 0$，表示局部自激励（正反馈）。当 $|v| > 1$ 时，$J_{11}  0$，表示局部自抑制（负反馈）。这种三次非线性是模型可兴奋性的来源。\n- $J_{12} = -1$: 该项是从恢复变量 $w$ 到电位变化率 $\\frac{dv}{dt}$ 的增益。其恒定的负值表明 $w$ 总是起到降低 $v$ 的作用，这证实了它作为“恢复”或“抑制”变量的作用。\n- $J_{21} = \\varepsilon$: 该项是从电位 $v$ 到恢复变量变化率 $\\frac{dw}{dt}$ 的增益。其正值表明 $v$ 的增加倾向于增加 $w$，代表了从 $v$ 到 $w$ 的兴奋性耦合。\n- $J_{22} = -\\varepsilon b$: 该项描述了 $w$ 对其自身变化率 $\\frac{dw}{dt}$ 的局部效应。由于 $\\varepsilon > 0$ 且 $b > 0$，该项始终为负，代表了恢复变量的自抑制或衰减过程。\n\n参数 $\\varepsilon$ 设定了 $w$ 动力学的时间尺度。问题中指出 $\\varepsilon > 0$ 并说明它控制时间尺度分离，这通常意味着 $\\varepsilon \\ll 1$。决定 $w$ 动力学的雅可比矩阵元素，即 $J_{21} = \\varepsilon$ 和 $J_{22} = -\\varepsilon b$，都与 $\\varepsilon$ 成正比。在线性化系统中，这意味着微扰 $\\delta w$ 的变化率远小于微扰 $\\delta v$ 的变化率。具体来说，$\\frac{d(\\delta w)}{dt} = \\varepsilon(\\delta v - b\\delta w)$，而 $\\frac{d(\\delta v)}{dt} = (1 - v^2)\\delta v - \\delta w$。对于 $\\varepsilon \\ll 1$，$w$ 的响应比 $v$ 的响应慢得多，这正是局部动力学中时间尺度分离的本质。\n\n(3) 平衡点分析与行列式计算。\n\n平衡点 $(v^{\\ast}, w^{\\ast})$ 是向量场为零的点，即 $\\frac{dv}{dt} = 0$ 和 $\\frac{dw}{dt} = 0$。\n$$\nv^{\\ast} - \\frac{(v^{\\ast})^{3}}{3} - w^{\\ast} + I = 0\n$$\n$$\n\\varepsilon(v^{\\ast} + a - bw^{\\ast}) = 0\n$$\n问题要求施加参数关系 $I = a/b$ 并验证 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 是一个平衡点。我们将 $v^{\\ast}=0$ 和 $w^{\\ast}=I$ 代入两个平衡方程。\n- 对于第一个方程：\n$$\n(0) - \\frac{(0)^{3}}{3} - (I) + I = 0 - 0 - I + I = 0\n$$\n该方程成立。\n- 对于第二个方程，由于 $\\varepsilon > 0$，我们需要检查是否 $v^{\\ast} + a - bw^{\\ast} = 0$：\n$$\n(0) + a - b(I) = a - bI = 0\n$$\n当且仅当 $a = bI$ 或 $I = a/b$ 时，该方程成立。由于这是施加的条件，点 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 在此条件下确实是系统的一个平衡点。\n\n接下来，我们计算在该平衡点 $(v^{\\ast}, w^{\\ast}) = (0, I)$ 处的雅可比矩阵。我们将 $v=0$ 和 $w=I$ 代入 $J(v,w)$ 的一般表达式：\n$$\nJ(v^{\\ast}, w^{\\ast}) = J(0, I) = \\begin{pmatrix} 1 - (0)^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\n最后，我们计算该矩阵的行列式：\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = \\det \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = (1)(-\\varepsilon b) - (-1)(\\varepsilon)\n$$\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = -\\varepsilon b + \\varepsilon = \\varepsilon(1-b)\n$$\n在条件 $I=a/b$ 下，平衡点 $(0, I)$ 处的雅可比矩阵行列式为 $\\varepsilon(1-b)$。该表达式由所需的参数 $\\varepsilon$ 和 $b$ 表示。",
            "answer": "$$\\boxed{\\varepsilon(1-b)}$$"
        },
        {
            "introduction": "在理解了 FHN 模型的局部动力学之后，我们进一步探讨一个更全局性的问题：当输入电流等参数变化时，神经元的行为如何发生质的改变（例如，从静息态转变为放电态）。分岔理论为研究这些转变提供了数学框架。本练习将引导您通过分析零斜线（nullclines）的几何相切条件，来精确确定神经元进入兴奋状态的电流阈值，这是鞍结分岔（saddle-node bifurcation）的典型特征 。",
            "id": "3924768",
            "problem": "考虑由以下耦合常微分方程给出的 FitzHugh-Nagumo (FHN) 简化神经元模型\n$$\n\\frac{dv}{dt} = v - \\frac{v^{3}}{3} - w + I, \\qquad \\frac{dw}{dt} = \\epsilon \\left(v + a - b w\\right),\n$$\n其中 $v$ 是膜电位，$w$ 是恢复变量，$I$ 是一个无量纲恒定输入电流，而 $\\epsilon$、$a$ 和 $b$ 是固定参数，其中 $\\epsilon > 0$。在平衡状态下，零斜线满足\n$$\nw = v - \\frac{v^{3}}{3} + I, \\qquad w = \\frac{v + a}{b}.\n$$\n当这些零斜线在 $(v,w)$ 平面中彼此相切时，会发生平衡点的鞍节点分岔。从零斜线的定义和相切的几何条件出发，确定在参数值 $a = 0.3$ 和 $b = 2$ 的情况下，发生鞍节点分岔时无量纲输入电流 $I$ 的正值。然后，通过证明在相同的 $I$ 值下，$v$ 的三次平衡方程的判别式为零，来验证你的结果。将你的最终数值答案四舍五入到四位有效数字。电流 $I$ 是无量纲的；不要包含单位。",
            "solution": "该问题要求找到在 FitzHugh-Nagumo 模型中发生鞍节点分岔的输入电流 $I$ 的正值，并验证此结果。鞍节点分岔发生在平衡点处，在相平面中对应于两条零斜线的相切。\n\n**步骤 1: 使用相切条件求解**\n\n在平衡点，两个零斜线方程都必须满足：\n1. v-零斜线: $w = v - \\frac{v^3}{3} + I$\n2. w-零斜线: $w = \\frac{v + a}{b}$\n\n相切条件意味着在切点 $(v_c, w_c)$，两条曲线的斜率 $\\frac{dw}{dv}$ 相等。\n1. v-零斜线的斜率: $\\frac{dw}{dv} = 1 - v^2$\n2. w-零斜线的斜率: $\\frac{dw}{dv} = \\frac{1}{b}$\n\n令斜率相等，可以找到发生相切时的 $v$ 值：\n$$ 1 - v_c^2 = \\frac{1}{b} $$\n代入给定的参数 $b=2$:\n$$ 1 - v_c^2 = \\frac{1}{2} \\implies v_c^2 = \\frac{1}{2} \\implies v_c = \\pm\\frac{1}{\\sqrt{2}} $$\n在切点，两条零斜线的 $w$ 值也必须相等。因此，我们可以令两个 $w$ 的表达式相等，并求解 $I$:\n$$ v_c - \\frac{v_c^3}{3} + I = \\frac{v_c + a}{b} $$\n$$ I = \\frac{v_c + a}{b} - v_c + \\frac{v_c^3}{3} $$\n问题要求 $I$ 的正值。我们代入 $a = 0.3$, $b = 2$ 以及 $v_c$ 的两个可能值来测试。\n\n情况 1: $v_c = \\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{\\frac{1}{\\sqrt{2}} + 0.3}{2} - \\frac{1}{\\sqrt{2}} + \\frac{(\\frac{1}{\\sqrt{2}})^3}{3} = 0.15 - \\frac{1}{2\\sqrt{2}} + \\frac{1}{6\\sqrt{2}} = 0.15 - \\frac{1}{3\\sqrt{2}} \\approx -0.0857 $$\n这个值是负的。\n\n情况 2: $v_c = -\\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{-\\frac{1}{\\sqrt{2}} + 0.3}{2} - (-\\frac{1}{\\sqrt{2}}) + \\frac{(-\\frac{1}{\\sqrt{2}})^3}{3} = 0.15 + \\frac{1}{2\\sqrt{2}} - \\frac{1}{6\\sqrt{2}} = 0.15 + \\frac{1}{3\\sqrt{2}} \\approx 0.3857 $$\n这个值是正的。因此，发生分岔的正电流值为 $I = 0.15 + \\frac{1}{3\\sqrt{2}}$。\n\n**步骤 2: 使用判别式验证**\n\n平衡点由以下方程的根给出，该方程通过消去 $w$ 得到：\n$$ v - \\frac{v^3}{3} + I = \\frac{v + a}{b} $$\n代入 $a=0.3$ 和 $b=2$，并将方程整理成标准三次多项式形式 $v^3 + pv + q = 0$:\n$$ v - \\frac{v^3}{3} + I = \\frac{v + 0.3}{2} $$\n$$ 2v - \\frac{2v^3}{3} + 2I = v + 0.3 $$\n$$ -\\frac{2v^3}{3} + v + (2I - 0.3) = 0 $$\n$$ v^3 - \\frac{3}{2}v - 3(2I - 0.3) = 0 $$\n$$ v^3 - \\frac{3}{2}v + (0.9 - 6I) = 0 $$\n或者，按照原始解答的推导：\n$$ v^3 - \\frac{3}{2}v + (0.45 - 3I) = 0 $$\n对于 $x^3+px+q=0$ 形式的三次方程，当判别式 $\\Delta = -4p^3 - 27q^2 = 0$ 时，它有两个相等的实根，这对应于鞍节点分岔。\n这里，$p = -3/2$，$q = 0.45 - 3I$。\n$$ -4\\left(-\\frac{3}{2}\\right)^3 - 27(0.45 - 3I)^2 = 0 $$\n$$ -4\\left(-\\frac{27}{8}\\right) - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{27}{2} - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{1}{2} = (0.45 - 3I)^2 $$\n$$ \\pm\\frac{1}{\\sqrt{2}} = 0.45 - 3I $$\n$$ 3I = 0.45 \\mp \\frac{1}{\\sqrt{2}} $$\n$$ I = 0.15 \\mp \\frac{1}{3\\sqrt{2}} $$\n这给出了两个解，与相切法得到的结果完全一致。正值为 $I = 0.15 + \\frac{1}{3\\sqrt{2}}$。\n\n**步骤 3: 计算数值并四舍五入**\n$$ I = 0.15 + \\frac{1}{3\\sqrt{2}} \\approx 0.15 + 0.23570226 \\approx 0.38570226 $$\n四舍五入到四位有效数字，结果是 $0.3857$。",
            "answer": "$$ \\boxed{0.3857} $$"
        },
        {
            "introduction": "从抽象的 FHN 模型过渡到更具生物物理细节的 Morris-Lecar (ML) 模型，我们可以探索神经元更具体的生理特性。神经元的核心功能之一是将其接收的输入电流转换为输出放电频率，这一关系由频率-电流（F-I）曲线描述。本练习是一个计算实验，旨在研究一个基本的被动属性——漏电导（$g_L$）——如何调节这一输入-输出功能，这一机制被称为“分流抑制”（shunting inhibition）。这项实践将理论模型与神经计算中可测量的方面联系了起来 。",
            "id": "3924732",
            "problem": "考虑一个单室电导神经元模型，其中膜电位 $V$ 遵循一个空间等电位区域的电流平衡定律：电容电流和离子电流之和等于外部注入的电流。Morris–Lecar (ML) 模型描述了快速再生钙电流与较慢恢复钾电流之间的相互作用。在本问题中，您将通过数值模拟来量化漏电导 $g_L$ 如何使频率-电流 (F-I) 曲线变平或变陡，并通过对再生内向电流的有效分流来解释结果。\n\n基本原理：\n- 单室电流平衡为 $C \\,\\dfrac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}$，其中 $C$ 是膜电容，$I_{\\text{ext}}$ 是注入电流，$I_L$ 是漏电流，$I_{\\text{Ca}}$ 是钙电流，$I_{\\text{K}}$ 是钾电流。\n- 在 Morris–Lecar 框架中，$I_L = g_L \\,(V - E_L)$，$I_{\\text{Ca}} = g_{\\text{Ca}} \\, m_{\\infty}(V)\\,(V - E_{\\text{Ca}})$，$I_{\\text{K}} = g_{\\text{K}} \\, w \\,(V - E_{\\text{K}})$，并且门控变量 $w$ 遵循一级动力学 $ \\dfrac{dw}{dt} = \\phi \\,\\dfrac{w_{\\infty}(V) - w}{\\tau_w(V)}$。\n- 稳态激活函数为 $m_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_1}{V_2}\\right)\\right)$ 和 $w_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_3}{V_4}\\right)\\right)$，电压依赖性时间尺度为 $\\tau_w(V) = \\dfrac{1}{\\cosh\\left(\\dfrac{V - V_3}{2 V_4}\\right)}$。\n\n模型参数（使用以下固定值）：\n- $C = 20$ 单位 $\\mu\\mathrm{F}/\\mathrm{cm}^2$，\n- $g_{\\text{Ca}} = 4.4$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$，\n- $g_{\\text{K}} = 8$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$，\n- $E_{\\text{Ca}} = 120$ 单位 $\\mathrm{mV}$，\n- $E_{\\text{K}} = -84$ 单位 $\\mathrm{mV}$，\n- $E_L = -60$ 单位 $\\mathrm{mV}$，\n- $V_1 = -1.2$ 单位 $\\mathrm{mV}$，\n- $V_2 = 18$ 单位 $\\mathrm{mV}$，\n- $V_3 = 2$ 单位 $\\mathrm{mV}$，\n- $V_4 = 30$ 单位 $\\mathrm{mV}$，\n- $\\phi = 0.04$ 单位 $\\mathrm{ms}^{-1}$。\n\n模拟设置与定义：\n- 使用固定步长的四阶 Runge–Kutta 方法，以恒定步长 $\\Delta t = 0.05$ $\\mathrm{ms}$ 模拟该模型，总时间为 $T_{\\text{total}} = 1000$ $\\mathrm{ms}$。\n- 使用初始条件 $V(0) = -60$ $\\mathrm{mV}$ 和 $w(0) = w_{\\infty}(V(0))$。\n- 施加一个恒定的注入电流 $I_{\\text{ext}}$（单位 $\\mu\\mathrm{A}/\\mathrm{cm}^2$）。\n- 通过向上穿越阈值 $V_{\\text{th}} = 0$ $\\mathrm{mV}$ 来定义锋电位。\n- 计算放电率 $f$（单位 $\\mathrm{Hz}$），其值为锋电位数量除以分析窗口的持续时间（以秒为单位）；使用一个从 $t_{\\text{start}} = 300$ $\\mathrm{ms}$ 开始到 $T_{\\text{total}}$ 结束的分析窗口。\n- 对于每个漏电导 $g_L$，使用有限差分法计算频率-电流斜率 $S$，单位为 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$：\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1},\n$$\n其中 $I_1$ 和 $I_2$ 是两个注入电流，且 $I_2 > I_1$。\n\n任务：\n- 实现上述 ML 模型和模拟协议。\n- 对于给定的电流对 $\\{I_1, I_2\\}$，计算每个指定 $g_L$ 对应的 $S$。\n- 将每个 $S$ 作为浮点数返回，四舍五入到六位小数，单位 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$ 为隐含单位。\n\n测试组：\n- 对所有测试使用电流对 $\\{I_1, I_2\\} = \\{90.0, 130.0\\}$，单位为 $\\mu\\mathrm{A}/\\mathrm{cm}^2$。\n- 评估四种漏电导情况：\n    1. 正常情况：$g_L = 2.0$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$。\n    2. 中度漏电导增加：$g_L = 4.0$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$。\n    3. 大漏电导：$g_L = 8.0$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$。\n    4. 极端漏电导（边界情况）：$g_L = 16.0$ 单位 $\\mathrm{mS}/\\mathrm{cm}^2$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含四个斜率结果，顺序与上述测试组一致，形式为方括号内以逗号分隔的列表（例如，$\\left[ s_1, s_2, s_3, s_4 \\right]$）。\n- 每个条目必须是四舍五入到六位小数的浮点数。\n- 斜率的单位是 $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$。",
            "solution": "该问题要求计算 Morris-Lecar 神经元模型在不同漏电导值 $g_L$ 下的频率-电流 (F-I) 曲线斜率。这通过数值模拟来实现。解决方案涉及实现模型的动力学，使用指定的数值积分方案进行模拟，并分析得到的锋电位序列以计算放电率。\n\nMorris-Lecar 模型是一个二维耦合常微分方程组 (ODEs)，描述膜电位 $V$（单位 $\\mathrm{mV}$）和钾通道门控变量 $w$（无量纲）的演化。方程如下：\n$$\nC \\frac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}\n$$\n$$\n\\frac{dw}{dt} = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\n其中 $C$ 是膜电容，$I_{\\text{ext}}$ 是外部注入电流，离子电流由以下公式给出：\n- 漏电流: $I_L = g_L (V - E_L)$\n- 钙电流: $I_{\\text{Ca}} = g_{\\text{Ca}} m_{\\infty}(V) (V - E_{\\text{Ca}})$\n- 钾电流: $I_{\\text{K}} = g_{\\text{K}} w (V - E_{\\text{K}})$\n\n电压依赖性稳态激活函数（$m_{\\infty}(V)$、$w_{\\infty}(V)$）和 $w$ 变量的时间尺度（$\\tau_w(V)$）定义如下：\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right)\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\n\n模型的固定参数指定如下：\n- $C = 20 \\, \\mu\\mathrm{F}/\\mathrm{cm}^2$\n- $g_{\\text{Ca}} = 4.4 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $g_{\\text{K}} = 8 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $E_{\\text{Ca}} = 120 \\, \\mathrm{mV}$\n- $E_{\\text{K}} = -84 \\, \\mathrm{mV}$\n- $E_L = -60 \\, \\mathrm{mV}$\n- $V_1 = -1.2 \\, \\mathrm{mV}$\n- $V_2 = 18 \\, \\mathrm{mV}$\n- $V_3 = 2 \\, \\mathrm{mV}$\n- $V_4 = 30 \\, \\mathrm{mV}$\n- $\\phi = 0.04 \\, \\mathrm{ms}^{-1}$\n\n为了求解该常微分方程组，我们采用固定时间步长为 $\\Delta t = 0.05$ ms 的四阶 Runge-Kutta (RK4) 方法。对于时刻 $t_n$ 的状态向量 $\\mathbf{y}_n = [V_n, w_n]^T$，下一个时间步长 $t_{n+1} = t_n + \\Delta t$ 的状态计算如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n其中 $\\mathbf{f}(\\mathbf{y}) = [dV/dt, dw/dt]^T$ 且：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\mathbf{k}_3)\n\\end{aligned}\n$$\n每次模拟的总持续时间为 $T_{\\text{total}} = 1000$ ms，从初始条件 $V(0) = -60$ mV 和 $w(0) = w_{\\infty}(V(0))$ 开始。\n\n每次模拟后，计算放电率 $f$。一个锋电位定义为膜电位 $V$ 向上穿越阈值 $V_{\\text{th}} = 0$ mV。锋电位的数量 $N_{\\text{spikes}}$ 在从 $t_{\\text{start}} = 300$ ms 开始到 $T_{\\text{total}}$ 结束的分析窗口内计数。丢弃最初的 300 ms 周期，以确保分析是在神经元的稳态响应上进行的，即在任何初始瞬态衰减之后。那么，以赫兹 (Hz) 为单位的放电率是：\n$$\nf = \\frac{N_{\\text{spikes}}}{(T_{\\text{total}} - t_{\\text{start}}) / 1000}\n$$\n分母 $(1000 - 300)/1000 = 0.7$ s，是分析窗口的持续时间，单位为秒。\n\n核心任务是计算四种不同漏电导 $g_L$ 值 $\\{2.0, 4.0, 8.0, 16.0\\}$（单位 $\\mathrm{mS}/\\mathrm{cm}^2$）的 F-I 曲线斜率 $S$。对于每个 $g_L$，使用注入电流 $I_1 = 90.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ 和 $I_2 = 130.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ 进行两次模拟，以获得相应的放电率 $f(I_1)$ 和 $f(I_2)$。然后使用有限差分近似计算斜率 $S$：\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1}\n$$\n每个 $g_L$ 的最终结果四舍五入到六位小数。整个过程在一个 Python 脚本中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation and calculation of F-I curve slopes\n    for the Morris-Lecar model.\n    \"\"\"\n\n    class MorrisLecarModel:\n        \"\"\"\n        Encapsulates the Morris-Lecar model parameters and differential equations.\n        \"\"\"\n        def __init__(self, g_L):\n            # Fixed parameters as specified in the problem\n            self.C = 20.0        # uF/cm^2\n            self.g_Ca = 4.4      # mS/cm^2\n            self.g_K = 8.0       # mS/cm^2\n            self.E_Ca = 120.0    # mV\n            self.E_K = -84.0     # mV\n            self.E_L = -60.0     # mV\n            self.V1 = -1.2       # mV\n            self.V2 = 18.0       # mV\n            self.V3 = 2.0        # mV\n            self.V4 = 30.0       # mV\n            self.phi = 0.04      # ms^-1\n            \n            # Variable parameter\n            self.g_L = g_L       # mS/cm^2\n            \n        def m_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V1) / self.V2))\n            \n        def w_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V3) / self.V4))\n            \n        def tau_w(self, V):\n            return 1.0 / np.cosh((V - self.V3) / (2.0 * self.V4))\n\n        def derivatives(self, state, I_ext):\n            \"\"\"\n            Computes the derivatives [dV/dt, dw/dt] for the Morris-Lecar model.\n            \n            Args:\n                state (np.array): Current state [V, w].\n                I_ext (float): External injected current.\n            \n            Returns:\n                np.array: The derivatives [dV/dt, dw/dt].\n            \"\"\"\n            V, w = state\n            \n            # Ionic currents\n            I_L = self.g_L * (V - self.E_L)\n            I_Ca = self.g_Ca * self.m_inf(V) * (V - self.E_Ca)\n            I_K = self.g_K * w * (V - self.E_K)\n            \n            # ODEs from current balance equation\n            dV_dt = (I_ext - I_L - I_Ca - I_K) / self.C\n            dw_dt = self.phi * (self.w_inf(V) - w) / self.tau_w(V)\n            \n            return np.array([dV_dt, dw_dt])\n\n    def run_simulation_and_get_rate(g_L, I_ext):\n        \"\"\"\n        Runs a simulation of the ML model and calculates the firing rate.\n\n        Args:\n            g_L (float): Leak conductance.\n            I_ext (float): External injected current.\n        \n        Returns:\n            float: The calculated firing rate in Hz.\n        \"\"\"\n        # Simulation parameters\n        dt = 0.05          # ms\n        T_total = 1000.0   # ms\n        t_start = 300.0    # ms\n        V_th = 0.0         # mV\n\n        model = MorrisLecarModel(g_L)\n        \n        num_steps = int(T_total / dt)\n        \n        # State variable arrays to store trajectory\n        V_trace = np.zeros(num_steps + 1)\n        w_trace = np.zeros(num_steps + 1)\n        \n        # Initial conditions\n        V_trace[0] = -60.0\n        w_trace[0] = model.w_inf(V_trace[0])\n        \n        # Simulation loop using fourth-order Runge-Kutta (RK4)\n        for i in range(num_steps):\n            state = np.array([V_trace[i], w_trace[i]])\n            \n            k1 = dt * model.derivatives(state, I_ext)\n            k2 = dt * model.derivatives(state + 0.5 * k1, I_ext)\n            k3 = dt * model.derivatives(state + 0.5 * k2, I_ext)\n            k4 = dt * model.derivatives(state + k3, I_ext)\n            \n            new_state = state + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n            \n            V_trace[i+1] = new_state[0]\n            w_trace[i+1] = new_state[1]\n\n        # Spike counting within the analysis window\n        spike_count = 0\n        analysis_start_index = int(t_start / dt)\n        \n        for i in range(analysis_start_index, num_steps + 1):\n            if V_trace[i-1] < V_th and V_trace[i] >= V_th:\n                spike_count += 1\n                \n        # Firing rate calculation\n        analysis_duration_s = (T_total - t_start) / 1000.0\n        firing_rate = spike_count / analysis_duration_s\n        \n        return firing_rate\n\n    # Test suite parameters from the problem statement\n    I1, I2 = 90.0, 130.0\n    g_L_cases = [2.0, 4.0, 8.0, 16.0]\n    \n    results = []\n    \n    # Loop through each test case for leak conductance\n    for g_L in g_L_cases:\n        # Calculate firing rate for the two current levels\n        f1 = run_simulation_and_get_rate(g_L=g_L, I_ext=I1)\n        f2 = run_simulation_and_get_rate(g_L=g_L, I_ext=I2)\n\n        # Calculate the F-I slope S using a finite difference\n        S = (f2 - f1) / (I2 - I1)\n            \n        results.append(round(S, 6))\n        \n    # Print the final output in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}