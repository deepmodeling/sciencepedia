{
    "hands_on_practices": [
        {
            "introduction": "要掌握脉搏波传播模型，第一步是理解决定其速度的基本物理原理。脉搏波速度（Pulse Wave Velocity, PWV）是评估动脉僵硬度的关键临床指标。本练习将通过从流体动力学和线性弹性力学的第一性原理出发，推导经典的莫恩斯-科特韦格（Moens-Korteweg）方程，从而将动脉的材料属性（如杨氏模量 $E$）和几何结构（如半径 $R$ 和壁厚 $h$）与波速 $c$ 直接联系起来。通过这个实践，你将不仅掌握一个核心公式，还将深入理解动脉老化等生理变化如何影响血流动力学。",
            "id": "3922840",
            "problem": "一理想化的直动脉段，其参考半径为 $R$，壁厚为 $h$，承载着质量密度为 $\\rho$ 的血液。假设血液不可压缩，并且在确定波速时可以忽略粘性损失。动脉壁是薄壁、各向同性且线性弹性的，其增量杨氏模量为 $E$，脉搏波由围绕参考状态的微小轴对称扰动组成。在这些假设下，从可变形管中流动的一维质量守恒和线性动量守恒方程出发，结合线性弹性和薄壁圆筒的周向力平衡，推导出小振幅压力波的局部速度 $c$（用 $E$、$h$、$R$ 和 $\\rho$ 表示）。然后，使用 $E=0.6\\,\\text{MPa}$、$h=1.2\\,\\text{mm}$、$R=4\\,\\text{mm}$ 和 $\\rho=1050\\,\\text{kg/m}^3$ 这些数值，评估基线脉搏波速度（PWV），并确定因老化导致 $E$ 增加 $20\\%$ 后的新PWV。解释你的推导所蕴含的 $c$ 随 $E$ 变化的标度关系。将你的最终数值答案表示为新的PWV，单位为米/秒，并四舍五入到四位有效数字。",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n-   动脉段是理想化的直管。\n-   参考半径：$R$\n-   壁厚：$h$\n-   血液质量密度：$\\rho$\n-   血液不可压缩。\n-   粘性损失可以忽略。\n-   动脉壁是薄壁、各向同性且线性弹性的。\n-   管壁的增量杨氏模量：$E$\n-   脉搏波由围绕参考状态的微小轴对称扰动组成。\n-   推导必须从可变形管中流动的一维质量守恒和线性动量守恒、线性弹性以及薄壁圆筒的周向力平衡出发。\n-   目标是推导小振幅压力波的局部速度 $c$。\n-   用于评估的数值：\n    -   $E = 0.6\\,\\text{MPa}$\n    -   $h = 1.2\\,\\text{mm}$\n    -   $R = 4\\,\\text{mm}$\n    -   $\\rho = 1050\\,\\text{kg/m}^3$\n-   次要任务是计算 $E$ 增加 $20\\%$ 后的新脉搏波速度（PWV）。\n-   最终数值答案必须是新的PWV，单位为米/秒，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是生物力学和流体动力学中的一个标准教科书练习，具体涉及动脉中脉搏波传播的建模。\n-   **科学依据（关键）**：该问题基于流体力学（质量守恒和动量守恒）和固体力学（线性弹性、薄壁圆筒理论）的基本原理。所作假设（无粘性、不可压缩流、小扰动、线性弹性）是推导Moens-Korteweg方程的标准简化，该方程是此领域的基石。\n-   **适定性**：问题提供了所有必要的参数和明确的目标，从而可以得到波速 $c$ 的唯一解。所提供的数值对于大动脉而言是物理上现实的。\n-   **客观性（关键）**：语言精确、专业，没有主观性或歧义。\n\n该问题没有违反任何无效性标准。这是一个定义明确、科学合理的问题。\n\n### 步骤3：结论和行动\n问题是**有效**的。将提供完整解答。\n\n### 脉搏波速度（PWV）的推导\n\n该推导基于可变形管中的一维质量和动量守恒方程，并与描述管弹性特性的方程（“管定律”）相结合。\n\n设 $A(x, t)$ 为动脉的横截面积，$u(x, t)$ 为轴向流体速度，$P(x, t)$ 为压力，它们都是轴向位置 $x$ 和时间 $t$ 的函数。流体密度 $\\rho$ 是恒定的。\n\n1.  **质量守恒（连续性方程）**\n    对于面积变化的管中的无粘性、不可压缩流体，一维连续性方程为：\n    $$ \\frac{\\partial A}{\\partial t} + \\frac{\\partial (Au)}{\\partial x} = 0 $$\n    展开第二项：\n    $$ \\frac{\\partial A}{\\partial t} + A \\frac{\\partial u}{\\partial x} + u \\frac{\\partial A}{\\partial x} = 0 $$\n\n2.  **动量守恒（欧拉方程）**\n    对于无粘性流体，一维动量方程为：\n    $$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} \\right) = - \\frac{\\partial P}{\\partial x} $$\n\n3.  **小扰动线性化**\n    问题指定了围绕零流速（$u_0 = 0$）、恒定参考半径 $R$ 和参考面积 $A_0 = \\pi R^2$ 的参考状态的微小扰动。我们将扰动定义为：\n    $A(x, t) = A_0 + a'(x, t)$\n    $u(x, t) = u'(x, t)$\n    $P(x, t) = P_0 + p'(x, t)$\n    将这些代入控制方程，并舍去小扰动的二阶项（例如 $u' \\frac{\\partial a'}{\\partial x}$、$(u')^2$），得到线性化方程：\n\n    线性化连续性方程：\n    $$ \\frac{\\partial a'}{\\partial t} + A_0 \\frac{\\partial u'}{\\partial x} = 0 $$\n\n    线性化动量方程：\n    $$ \\rho \\frac{\\partial u'}{\\partial t} = - \\frac{\\partial p'}{\\partial x} $$\n\n4.  **管定律（弹性特性）**\n    我们需要压力变化 $p'$ 和面积变化 $a'$ 之间的关系。我们将动脉建模为薄壁弹性圆筒。环向应力 $\\sigma_\\theta$ 由周向力平衡给出：\n    $$ \\sigma_\\theta = \\frac{P r}{h} $$\n    其中 $P$ 是跨壁压力，$r$ 是瞬时半径。相对于参考半径 $R$ 的周向应变 $\\epsilon_\\theta$ 为：\n    $$ \\epsilon_\\theta = \\frac{r - R}{R} $$\n    管壁是线性弹性的，因此应力通过杨氏模量 $E$ 与应变成正比：\n    $$ \\sigma_\\theta = E \\epsilon_\\theta $$\n    结合这些可得：\n    $$ \\frac{P r}{h} = E \\frac{r - R}{R} $$\n    为使此关系线性化，我们考虑小变化 $r = R + r'$ 和 $P = P_0 + p'$，其中 $p'$ 引起 $r'$。\n    $$ \\frac{(P_0 + p')(R + r')}{h} = E \\frac{r'}{R} $$\n    假设压力引起的应力远大于预应力效应（一种标准简化，等同于 $P_0 \\ll Eh/R$）并舍去二阶项 ($p'r'$)，我们得到：\n    $$ \\frac{p' R}{h} \\approx E \\frac{r'}{R} \\implies p' \\approx \\frac{Eh}{R^2} r' $$\n    现在，我们将半径变化 $r'$ 与面积变化 $a'$ 联系起来。\n    $A = \\pi r^2 \\implies dA = 2 \\pi r dr$。对于小扰动，$a' \\approx 2 \\pi R r'$。因此，$r' \\approx \\frac{a'}{2 \\pi R}$。\n    将 $r'$ 代入压力关系式：\n    $$ p' \\approx \\frac{Eh}{R^2} \\left( \\frac{a'}{2 \\pi R} \\right) = \\frac{Eh}{2 \\pi R^3} a' $$\n    这提供了关联压力和面积扰动的线性管定律，可以用导数的形式表示为：\n    $$ \\frac{dp'}{da'} = \\frac{Eh}{2 \\pi R^3} \\quad \\text{或} \\quad \\frac{da'}{dp'} = \\frac{2 \\pi R^3}{Eh} $$\n\n5.  **波动方程的推导**\n    我们现在有了一个由三个方程组成的系统：\n    (i) $\\frac{\\partial a'}{\\partial t} = -A_0 \\frac{\\partial u'}{\\partial x}$\n    (ii) $\\frac{\\partial p'}{\\partial x} = -\\rho \\frac{\\partial u'}{\\partial t}$\n    (iii) $a' = \\left(\\frac{2 \\pi R^3}{Eh}\\right) p'$\n\n    从(iii)式，我们可以写出 $\\frac{\\partial a'}{\\partial t} = \\frac{2 \\pi R^3}{Eh} \\frac{\\partial p'}{\\partial t}$。将此式与 $A_0 = \\pi R^2$ 一起代入(i)式：\n    $$ \\frac{2 \\pi R^3}{Eh} \\frac{\\partial p'}{\\partial t} = -(\\pi R^2) \\frac{\\partial u'}{\\partial x} \\implies \\frac{2 R}{Eh} \\frac{\\partial p'}{\\partial t} = - \\frac{\\partial u'}{\\partial x} $$\n    现在，将此方程对 $t$ 求导，并将线性化动量方程(ii)对 $x$ 求导：\n    $$ \\frac{2 R}{Eh} \\frac{\\partial^2 p'}{\\partial t^2} = - \\frac{\\partial^2 u'}{\\partial x \\partial t} $$\n    $$ \\frac{\\partial^2 p'}{\\partial x^2} = - \\rho \\frac{\\partial^2 u'}{\\partial t \\partial x} $$\n    假设函数足够光滑，可以交换求导顺序（$\\frac{\\partial^2 u'}{\\partial x \\partial t} = \\frac{\\partial^2 u'}{\\partial t \\partial x}$）。我们可以令混合偏导数的表达式相等：\n    $$ \\frac{2 R}{Eh} \\frac{\\partial^2 p'}{\\partial t^2} = \\frac{1}{\\rho} \\frac{\\partial^2 p'}{\\partial x^2} $$\n    将其重排为一维波动方程的标准形式 $\\frac{\\partial^2 p'}{\\partial t^2} = c^2 \\frac{\\partial^2 p'}{\\partial x^2}$，我们得到：\n    $$ \\frac{\\partial^2 p'}{\\partial t^2} = \\left(\\frac{Eh}{2 \\rho R}\\right) \\frac{\\partial^2 p'}{\\partial x^2} $$\n    通过比较，波传播速度 $c$ 的平方是：\n    $$ c^2 = \\frac{Eh}{2 \\rho R} $$\n    因此，脉搏波速度由 Moens-Korteweg 方程给出：\n    $$ c = \\sqrt{\\frac{Eh}{2 \\rho R}} $$\n\n### PWV随杨氏模量的标度关系\n推导出的公式表明，脉搏波速度 $c$ 与杨氏模量 $E$ 的平方根成正比：\n$$ c \\propto \\sqrt{E} $$\n这种关系意味着随着动脉壁变得更硬（即 $E$ 增加），脉搏波传播得更快。这与临床观察一致，即由于老化或疾病引起的动脉硬化会导致PWV增加。\n\n### 数值计算\n给定的基线值为：\n$E_{base} = 0.6\\,\\text{MPa} = 0.6 \\times 10^6\\,\\text{Pa}$\n$h = 1.2\\,\\text{mm} = 1.2 \\times 10^{-3}\\,\\text{m}$\n$R = 4\\,\\text{mm} = 4 \\times 10^{-3}\\,\\text{m}$\n$\\rho = 1050\\,\\text{kg/m}^3$\n\n动脉老化导致 $E$ 增加 $20\\%$。新的杨氏模量 $E_{new}$ 为：\n$E_{new} = E_{base} \\times (1 + 0.20) = 1.20 \\times E_{base}$\n$E_{new} = 1.20 \\times (0.6 \\times 10^6\\,\\text{Pa}) = 0.72 \\times 10^6\\,\\text{Pa}$\n\n我们现在使用推导出的公式计算新的脉搏波速度 $c_{new}$：\n$$ c_{new} = \\sqrt{\\frac{E_{new} h}{2 \\rho R}} $$\n代入数值：\n$$ c_{new} = \\sqrt{\\frac{(0.72 \\times 10^6\\,\\text{Pa}) \\times (1.2 \\times 10^{-3}\\,\\text{m})}{2 \\times (1050\\,\\text{kg/m}^3) \\times (4 \\times 10^{-3}\\,\\text{m})}} $$\n$$ c_{new} = \\sqrt{\\frac{0.864 \\times 10^3}{8.4}} = \\sqrt{\\frac{864}{8.4}} $$\n$$ c_{new} = \\sqrt{102.85714...} \\approx 10.141849\\,\\text{m/s} $$\n四舍五入到四位有效数字，新的脉搏波速度是 $10.14\\,\\text{m/s}$。",
            "answer": "$$ \\boxed{10.14} $$"
        },
        {
            "introduction": "真实的动脉系统是一个复杂的分支网络，而不是单一的血管。为了模拟系统级的血流动力学，我们必须将单个血管的模型扩展到整个动脉树。本练习采用频域中的传输线理论，这是一种分析波在网络中传播和反射的高效方法。你将通过计算一个三代动脉树模型中的输入阻抗、流量分布以及各分叉点的反射系数，来实践系统建模。这项实践突显了阻抗匹配在维持有效血液灌注和减少心脏负荷中的生理重要性，是连接基础波动理论与系统生理学应用的关键一环。",
            "id": "3922852",
            "problem": "考虑一个三代动脉树，使用一维（1D）线性化脉搏波传播框架进行建模。根段分叉成两个子段，每个子段再分叉成两个末梢段，最终形成四个末梢分支。假设血液是密度为 $\\rho$ 的不可压缩牛顿流体，并且每个动脉段都是直的、轴对称的薄壁管。对于每个段 $i$，设其半径为 $R_i$，长度为 $L_i$，杨氏模量为 $E_i$，壁厚为 $h_i = \\alpha R_i$，其中 $\\alpha$ 是在同一测试案例中共享的给定壁厚与半径之比。Moens-Korteweg 公式给出了波速 $c_i = \\sqrt{E_i h_i/(2\\rho R_i)}$，特征阻抗为 $Z_{c,i} = \\rho c_i/A_i$，其中 $A_i = \\pi R_i^2$。假设传播是无损的，因此波数为 $k_i = \\omega/c_i$，其中角频率 $\\omega = 2\\pi f$，$f$ 是驱动频率。\n\n在每个远端，定义局部负载阻抗 $Z_{\\text{load}}$ 如下：\n- 对于末梢段，$Z_{\\text{load}}$ 等于给定的末梢阻力 $R_{\\text{term}}$。\n- 对于分叉连接处，$Z_{\\text{load}}$ 等于下游子段输入阻抗的并联组合。\n\n设入口由频率为 $f$ 的谐波压力源驱动，其复振幅为 $P_{\\text{in}}$（假设零相位，即 $P_{\\text{in}}$ 是实数且为正）。在每个连接处使用质量守恒（流量连续）和压力连续。对每个段使用前向/后向波分解，其中位置 $x$ 处的压力和流量分别是前向波和后向波的和与差，并通过其负载阻抗在每个远端施加终止条件。\n\n任务：\n1. 从末梢向上游计算到根部，使用标准的无损传输线关系和连接处的并联组合，计算每个段近端的复输入阻抗。\n2. 计算根部的入口流量振幅 $Q_{\\text{in}}$（单位：$\\text{m}^3/\\text{s}$）以及进入每个末梢负载的流量振幅（单位：$\\text{m}^3/\\text{s}$），所有值均以模（绝对值）表示。\n3. 对于每个远端位置（总共七个位置：三个分叉连接处和四个末梢），计算由 $\\Gamma = (Z_{\\text{load}} - Z_c)/(Z_{\\text{load}} + Z_c)$ 定义的局部反射系数模，其中 $Z_c$ 是上游段的特征阻抗。识别出 $|\\Gamma| \\ge \\tau$ 的位置索引，阈值 $\\tau$ 在下方的每个测试套件中指定。位置索引定义如下：\n   - 位置 $0$：根段的远端（第一次分叉），\n   - 位置 $1$：左子段的远端（左侧第二次分叉），\n   - 位置 $2$：右子段的远端（右侧第二次分叉），\n   - 位置 $3,4$：左子树上两个末梢段的远端，\n   - 位置 $5,6$：右子树上两个末梢段的远端。\n4. 所有流量模以 $\\text{m}^3/\\text{s}$ 表示，所有压力以帕斯卡表示，所有角度以弧度表示。仅报告流量振幅的模（无相位）。将所有浮点输出四舍五入到六位小数。\n\n您的程序必须实现上述内容，并生成单行输出，其中包含所有测试案例的结果，格式为一个由方括号括起来的逗号分隔列表，每个测试案例的结果本身是一个列表，格式如下：\n[$Q_{\\text{in}}$, $Q_3$, $Q_4$, $Q_5$, $Q_6$, $\\max|\\Gamma|$, [主要反射位置的索引]],\n其中流量模的单位为 $\\text{m}^3/\\text{s}$，$\\max|\\Gamma|$ 是无量纲的。因此，最终输出格式必须为：\n[[case1_result],[case2_result],[case3_result]]\n字符串中任何地方都不能有空格，并且浮点数需四舍五入到六位小数。\n\n测试套件：\n使用以下科学上合理的参数集，涵盖典型情况、近匹配边界情况和强不对称情况。\n\n案例 1（对称树，中度失配）：\n- $\\rho = 1060\\,\\text{kg}/\\text{m}^3$，$E_i = 6.0\\times 10^5\\,\\text{Pa}$（对所有段），$\\alpha = 0.10$，$f = 2.0\\,\\text{Hz}$，$P_{\\text{in}} = 5000\\,\\text{Pa}$。\n- 半径（米）：$[R_0,R_1,R_2,R_3,R_4,R_5,R_6] = [0.005, 0.004, 0.004, 0.003, 0.003, 0.003, 0.003]$。\n- 长度（米）：$[L_0,L_1,L_2,L_3,L_4,L_5,L_6] = [0.20, 0.15, 0.15, 0.10, 0.10, 0.10, 0.10]$。\n- 末梢阻力（Pa·s/m$^3$）：$[1.0\\times 10^8, 1.0\\times 10^8, 1.0\\times 10^8, 1.0\\times 10^8]$。\n- 阈值：$\\tau = 0.25$。\n\n案例 2（末梢处近似阻抗匹配）：\n- $\\rho = 1060\\,\\text{kg}/\\text{m}^3$，$E_i = 5.0\\times 10^5\\,\\text{Pa}$（对所有段），$\\alpha = 0.09$，$f = 1.0\\,\\text{Hz}$，$P_{\\text{in}} = 4000\\,\\text{Pa}$。\n- 半径（米）：$[R_0,R_1,R_2,R_3,R_4,R_5,R_6] = [0.006, 0.0045, 0.0045, 0.0035, 0.0035, 0.0035, 0.0035]$。\n- 长度（米）：$[L_0,L_1,L_2,L_3,L_4,L_5,L_6] = [0.25, 0.18, 0.18, 0.12, 0.12, 0.12, 0.12]$。\n- 末梢阻力（Pa·s/m$^3$）：$[7.0\\times 10^7, 7.0\\times 10^7, 7.0\\times 10^7, 7.0\\times 10^7]$。\n- 阈值：$\\tau = 0.25$。\n\n案例 3（强不对称树，较大失配）：\n- $\\rho = 1060\\,\\text{kg}/\\text{m}^3$，$E_i = 6.5\\times 10^5\\,\\text{Pa}$（对所有段），$\\alpha = 0.12$，$f = 4.0\\,\\text{Hz}$，$P_{\\text{in}} = 6000\\,\\text{Pa}$。\n- 半径（米）：$[R_0,R_1,R_2,R_3,R_4,R_5,R_6] = [0.005, 0.003, 0.005, 0.002, 0.0025, 0.005, 0.005]$。\n- 长度（米）：$[L_0,L_1,L_2,L_3,L_4,L_5,L_6] = [0.18, 0.16, 0.16, 0.10, 0.10, 0.12, 0.12]$。\n- 末梢阻力（Pa·s/m$^3$）：$[8.0\\times 10^7, 9.0\\times 10^7, 6.0\\times 10^7, 6.0\\times 10^7]$。\n- 阈值：$\\tau = 0.25$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来、无空格的逗号分隔列表的结果，格式完全如下：\n[[Qin_case1,Q3_case1,Q4_case1,Q5_case1,Q6_case1,maxGamma_case1,[indices_case1]],[Qin_case2,Q3_case2,Q4_case2,Q5_case2,Q6_case2,maxGamma_case2,[indices_case2]],[Qin_case3,Q3_case3,Q4_case3,Q5_case3,Q6_case3,maxGamma_case3,[indices_case3]]]\n所有浮点值必须四舍五入到六位小数。",
            "solution": "该建模基础是用于顺应性血管中脉搏波传播的一维（1D）线性化方程，这些方程源于可变形管中不可压缩流动的质量守恒和动量守恒。在频域中，围绕稳态进行小扰动时，这些方程会产生支持压力和流量前向和后向行波的波动方程。波速和特征阻抗取决于管壁力学和几何形状。\n\n基本原理：\n- 质量守恒意味着横截面积变化与轴向流量变化相关，而动量守恒提供了压力梯度与流体加速度之间的关系。\n- 对于薄壁、轴对称的管，Moens-Korteweg 波速为 $c_i = \\sqrt{\\dfrac{E_i h_i}{2\\rho R_i}}$，其中 $E_i$ 是杨氏模量，$h_i$ 是壁厚，$\\rho$ 是流体密度，$R_i$ 是半径。在薄壁近似下，该公式是经过充分验证的动脉脉搏波速度关系式。\n- 特征阻抗为 $Z_{c,i} = \\dfrac{\\rho c_i}{A_i}$，其中 $A_i = \\pi R_i^2$ 是横截面积。该阻抗关联了均匀管中单一行波的压力和流量。\n- 在角频率为 $\\omega = 2\\pi f$ 的频域中，波数为 $k_i = \\omega/c_i$。假设在所关注的尺度上粘性阻尼可忽略不计，且波幅较小（无损近似），则前向和后向波在长度 $L_i$ 上的传播由乘法相位因子 $\\exp(\\pm j k_i L_i)$ 描述。\n\n传输线关系：\n- 对于一个具有特征阻抗 $Z_{c,i}$ 和波数 $k_i$ 的均匀段 $i$，设 $P_i(x)$ 和 $Q_i(x)$ 为复压力和流量相量。通解可以写为 $P_i(x) = P_i^+ e^{-j k_i x} + P_i^- e^{j k_i x}$ 和 $Q_i(x) = \\dfrac{1}{Z_{c,i}}\\left(P_i^+ e^{-j k_i x} - P_i^- e^{j k_i x}\\right)$，其中 $P_i^+$ 和 $P_i^-$ 是近端（$x=0$）的前向和后向压力波振幅。\n- 在远端（$x=L_i$），负载阻抗 $Z_{\\text{load}}$ 施加了条件 $P_i(L_i) = Z_{\\text{load}}\\,Q_i(L_i)$。这个终止条件通过局部反射系数 $\\Gamma = \\dfrac{Z_{\\text{load}} - Z_{c,i}}{Z_{\\text{load}} + Z_{c,i}}$ 将 $x=L_i$ 处的 $P_i^-$ 与 $x=L_i$ 处的 $P_i^+$ 联系起来。近端的后向波满足 $P_i^- (0) = \\Gamma e^{-2 j k_i L_i} P_i^+ (0)$，我们使用往返因子 $R = \\Gamma e^{-2 j k_i L_i}$ 来表示。\n- 近端的输入阻抗定义为 $Z_{\\text{in},i} = P_i(0)/Q_i(0)$，通过将前向/后向分解与终止条件相结合，可得 $Z_{\\text{in},i} = Z_{c,i}\\dfrac{1 + R}{1 - R}$。这种递归关系允许从远端到近端计算输入阻抗。\n\n连接处条件：\n- 在分叉处，各分支的压力是连续的，流量相加：如果节点压力为 $P_{\\text{node}}$，子段的输入阻抗为 $Z_{\\text{in},a}$ 和 $Z_{\\text{in},b}$，那么父段所见的等效负载是并联组合 $Z_{\\text{load}} = \\left(\\dfrac{1}{Z_{\\text{in},a}} + \\dfrac{1}{Z_{\\text{in},b}}\\right)^{-1}$。父段使用这个 $Z_{\\text{load}}$ 来形成其反射系数和输入阻抗，如上所述。进入子段的流量为 $Q_a = P_{\\text{node}}/Z_{\\text{in},a}$ 和 $Q_b = P_{\\text{node}}/Z_{\\text{in},b}$，这与流量连续性和线性关系一致。\n\n算法步骤：\n1. 对于每个测试案例，计算所有七个段（$i=0,\\ldots,6$）的壁厚 $h_i = \\alpha R_i$、面积 $A_i$、波速 $c_i = \\sqrt{\\dfrac{E_i h_i}{2\\rho R_i}}$、特征阻抗 $Z_{c,i} = \\dfrac{\\rho c_i}{A_i}$ 和波数 $k_i = \\omega/c_i$。\n2. 从四个末梢段（$i=3,4,5,6$）开始递归计算输入阻抗。对于每个末梢，负载阻抗是给定的阻力 $R_{\\text{term}}$，反射系数为 $\\Gamma_i = \\dfrac{R_{\\text{term}} - Z_{c,i}}{R_{\\text{term}} + Z_{c,i}}$。往返因子为 $R_i = \\Gamma_i e^{-2 j k_i L_i}$，输入阻抗为 $Z_{\\text{in},i} = Z_{c,i}\\dfrac{1 + R_i}{1 - R_i}$。\n3. 在第二代分叉处（位置 $1$ 和 $2$），由两个子段的输入阻抗形成并联负载 $Z_{\\text{load}}$，并使用相同的公式计算段 $i=1$ 和 $i=2$ 相应的反射系数和输入阻抗。\n4. 在第一代分叉处（位置 $0$），由 $Z_{\\text{in},1}$ 和 $Z_{\\text{in},2}$ 形成并联负载，并计算根段 $i=0$ 的反射系数和输入阻抗。\n5. 利用根输入阻抗 $Z_{\\text{in},0}$，计算入口流量 $Q_{\\text{in}} = P_{\\text{in}}/Z_{\\text{in},0}$。将根部近端的压力和流量分解为前向波和后向波：$P_0^+ = \\dfrac{P_{\\text{in}} + Z_{c,0} Q_{\\text{in}}}{2}$ 和 $P_0^- = \\dfrac{P_{\\text{in}} - Z_{c,0} Q_{\\text{in}}}{2}$。传播到远端：$P_{\\text{node},0} = P_0^+ e^{-j k_0 L_0} + P_0^- e^{j k_0 L_0}$。\n6. 使用 $P_{\\text{node},0}$ 确定进入左右子段的近端流量：$Q_1(0) = \\dfrac{P_{\\text{node},0}}{Z_{\\text{in},1}}$ 和 $Q_2(0) = \\dfrac{P_{\\text{node},0}}{Z_{\\text{in},2}}$。对于每个子段，类似地将近端状态分解为前向波和后向波，并进行传播以获得其远端节点压力 $P_{\\text{node},1}$ 和 $P_{\\text{node},2}$。\n7. 在每个末梢段，应用相同的分解，使用近端状态 $P_{\\text{node}}$ 和 $Q(0) = \\dfrac{P_{\\text{node}}}{Z_{\\text{in}}}$ 来计算远端压力 $P(L)$，然后计算末梢负载流量 $Q_{\\text{term}} = \\dfrac{P(L)}{R_{\\text{term}}}$，根据终止处的连续性，该流量等于该段的远端流量。\n8. 使用 $\\Gamma = \\dfrac{Z_{\\text{load}} - Z_c}{Z_{\\text{load}} + Z_c}$ 计算每个远端位置（三个连接处和四个末梢）的局部反射系数模 $|\\Gamma|$，其中 $Z_{\\text{load}}$ 按每个位置定义；收集所有七个模值，确定最大值以及哪些位置索引满足 $|\\Gamma| \\ge \\tau$。\n9. 报告入口流量模 $|Q_{\\text{in}}|$ 和末梢 $3$ 到 $6$ 的流量模 $|Q_{\\text{term}}|$（单位：$\\text{m}^3/\\text{s}$），以及 $\\max|\\Gamma|$ 和 $|\\Gamma| \\ge \\tau$ 的位置列表。将所有浮点值四舍五入到六位小数，并以无空格的单个方括号列表格式输出。\n\n科学真实性与合理性：\n- 所选的半径、长度和材料特性均在生理学上中型动脉的范围内。\n- Moens-Korteweg 波速和特征阻抗被广泛接受用于薄壁管中的小振幅波。\n- 频率范围 $1$ 到 $4\\,\\text{Hz}$ 对应于心率及其谐波。\n- 电阻性末梢负载代表远端的微循环阻抗。\n\n该设计确保算法遵循第一性原理（守恒定律、波分解、管壁力学），并为涵盖对称、近匹配和不对称网络的多样化测试套件生成可量化的输出。最终程序计算所要求的量，使用指定的阈值识别主要反射位置，并以要求的单行格式打印结果，浮点数四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef parallel_impedance(z1, z2):\n    return 1.0 / (1.0 / z1 + 1.0 / z2)\n\ndef segment_input_impedance(Zc, k, L, Zload):\n    # Reflection coefficient at distal end (local mismatch)\n    Gamma = (Zload - Zc) / (Zload + Zc)\n    Rfactor = Gamma * np.exp(-2j * k * L)\n    Zin = Zc * (1.0 + Rfactor) / (1.0 - Rfactor)\n    return Zin, Gamma\n\ndef propagate_distal_pressure(P_prox, Q_prox, Zc, k, L):\n    # Decompose into forward/backward waves at proximal end\n    Pf = (P_prox + Zc * Q_prox) / 2.0\n    Pb = (P_prox - Zc * Q_prox) / 2.0\n    # Propagate to distal end\n    P_dist = Pf * np.exp(-1j * k * L) + Pb * np.exp(1j * k * L)\n    Q_dist = (Pf * np.exp(-1j * k * L) - Pb * np.exp(1j * k * L)) / Zc\n    return P_dist, Q_dist\n\ndef compute_case(params):\n    rho = params[\"rho\"]\n    E = params[\"E\"]\n    alpha = params[\"alpha\"]\n    f = params[\"f\"]\n    Pin = params[\"Pin\"]\n    R = np.array(params[\"radii\"], dtype=float)  # length 7\n    L = np.array(params[\"lengths\"], dtype=float)  # length 7\n    Rterm = np.array(params[\"Rterm\"], dtype=float)  # length 4\n    tau = params[\"tau\"]\n\n    omega = 2.0 * np.pi * f\n    h = alpha * R\n    A = np.pi * R**2\n    c = np.sqrt(E * h / (2.0 * rho * R))\n    Zc = rho * c / A\n    k = omega / c\n\n    # Indices: 0 root; 1 left daughter; 2 right daughter; 3,4 left terminals; 5,6 right terminals\n    Zin = np.zeros(7, dtype=complex)\n    Gamma_sites = np.zeros(7, dtype=complex)\n\n    # Terminals 3,4,5,6\n    for idx, t in enumerate([3, 4, 5, 6]):\n        Zload = Rterm[idx]\n        Zin[t], Gamma_sites[t] = segment_input_impedance(Zc[t], k[t], L[t], Zload)\n\n    # Second-generation bifurcations for segments 1 and 2\n    # Segment 1 loads: terminals 3 and 4 in parallel\n    Zload_1 = parallel_impedance(Zin[3], Zin[4])\n    Zin[1], Gamma_sites[1] = segment_input_impedance(Zc[1], k[1], L[1], Zload_1)\n\n    # Segment 2 loads: terminals 5 and 6 in parallel\n    Zload_2 = parallel_impedance(Zin[5], Zin[6])\n    Zin[2], Gamma_sites[2] = segment_input_impedance(Zc[2], k[2], L[2], Zload_2)\n\n    # First-generation bifurcation for root segment 0\n    Zload_0 = parallel_impedance(Zin[1], Zin[2])\n    Zin[0], Gamma_sites[0] = segment_input_impedance(Zc[0], k[0], L[0], Zload_0)\n\n    # Inlet flow\n    Qin = Pin / Zin[0]\n\n    # Root distal node pressure\n    Pnode0, Qdist0 = propagate_distal_pressure(Pin, Qin, Zc[0], k[0], L[0])\n\n    # Flows into daughters at proximal ends\n    Q1_prox = Pnode0 / Zin[1]\n    Q2_prox = Pnode0 / Zin[2]\n\n    # Left daughter distal node pressure\n    Pnode1, Qdist1 = propagate_distal_pressure(Pnode0, Q1_prox, Zc[1], k[1], L[1])\n    # Right daughter distal node pressure\n    Pnode2, Qdist2 = propagate_distal_pressure(Pnode0, Q2_prox, Zc[2], k[2], L[2])\n\n    # Left terminals proximal flows\n    Q3_prox = Pnode1 / Zin[3]\n    Q4_prox = Pnode1 / Zin[4]\n    # Right terminals proximal flows\n    Q5_prox = Pnode2 / Zin[5]\n    Q6_prox = Pnode2 / Zin[6]\n\n    # Propagate through terminal segments to distal load pressures\n    P3_dist, Q3_dist = propagate_distal_pressure(Pnode1, Q3_prox, Zc[3], k[3], L[3])\n    P4_dist, Q4_dist = propagate_distal_pressure(Pnode1, Q4_prox, Zc[4], k[4], L[4])\n    P5_dist, Q5_dist = propagate_distal_pressure(Pnode2, Q5_prox, Zc[5], k[5], L[5])\n    P6_dist, Q6_dist = propagate_distal_pressure(Pnode2, Q6_prox, Zc[6], k[6], L[6])\n\n    # Terminal load flows (should equal segment distal flows)\n    Q3_term = P3_dist / Rterm[0]\n    Q4_term = P4_dist / Rterm[1]\n    Q5_term = P5_dist / Rterm[2]\n    Q6_term = P6_dist / Rterm[3]\n\n    # Magnitudes\n    Qin_mag = float(np.abs(Qin))\n    Q3_mag = float(np.abs(Q3_term))\n    Q4_mag = float(np.abs(Q4_term))\n    Q5_mag = float(np.abs(Q5_term))\n    Q6_mag = float(np.abs(Q6_term))\n\n    # Reflection magnitudes at sites 0..6\n    Gamma_mags = [float(np.abs(Gamma_sites[i])) for i in range(7)]\n    max_reflection = max(Gamma_mags)\n    major_sites = [i for i, g in enumerate(Gamma_mags) if g >= tau]\n\n    return [Qin_mag, Q3_mag, Q4_mag, Q5_mag, Q6_mag, max_reflection, major_sites]\n\ndef format_number(x):\n    # Ensure six decimal places\n    return f\"{x:.6f}\"\n\ndef format_nested(obj):\n    # Format nested list with no spaces, floats to six decimals\n    if isinstance(obj, list):\n        return \"[\" + \",\".join(format_nested(x) for x in obj) + \"]\"\n    elif isinstance(obj, (float, np.floating)):\n        return format_number(float(obj))\n    elif isinstance(obj, (int, np.integer)):\n        return str(int(obj))\n    else:\n        # Should not occur; fallback to float formatting if possible\n        try:\n            return format_number(float(obj))\n        except Exception:\n            return str(obj)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"rho\": 1060.0,\n            \"E\": 6.0e5,\n            \"alpha\": 0.10,\n            \"f\": 2.0,\n            \"Pin\": 5000.0,\n            \"radii\": [0.005, 0.004, 0.004, 0.003, 0.003, 0.003, 0.003],\n            \"lengths\": [0.20, 0.15, 0.15, 0.10, 0.10, 0.10, 0.10],\n            \"Rterm\": [1.0e8, 1.0e8, 1.0e8, 1.0e8],\n            \"tau\": 0.25,\n        },\n        {\n            \"rho\": 1060.0,\n            \"E\": 5.0e5,\n            \"alpha\": 0.09,\n            \"f\": 1.0,\n            \"Pin\": 4000.0,\n            \"radii\": [0.006, 0.0045, 0.0045, 0.0035, 0.0035, 0.0035, 0.0035],\n            \"lengths\": [0.25, 0.18, 0.18, 0.12, 0.12, 0.12, 0.12],\n            \"Rterm\": [7.0e7, 7.0e7, 7.0e7, 7.0e7],\n            \"tau\": 0.25,\n        },\n        {\n            \"rho\": 1060.0,\n            \"E\": 6.5e5,\n            \"alpha\": 0.12,\n            \"f\": 4.0,\n            \"Pin\": 6000.0,\n            \"radii\": [0.005, 0.003, 0.005, 0.002, 0.0025, 0.005, 0.005],\n            \"lengths\": [0.18, 0.16, 0.16, 0.10, 0.10, 0.12, 0.12],\n            \"Rterm\": [8.0e7, 9.0e7, 6.0e7, 6.0e7],\n            \"tau\": 0.25,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        res = compute_case(case)\n        # Round float entries to six decimals for output consistency\n        rounded = []\n        for item in res:\n            if isinstance(item, list):\n                # list of integers (major sites)\n                rounded.append(item)\n            else:\n                rounded.append(float(f\"{item:.6f}\"))\n        results.append(rounded)\n\n    # Final print statement in the exact required format: no spaces.\n    print(format_nested(results))\n\nsolve()\n```"
        }
    ]
}