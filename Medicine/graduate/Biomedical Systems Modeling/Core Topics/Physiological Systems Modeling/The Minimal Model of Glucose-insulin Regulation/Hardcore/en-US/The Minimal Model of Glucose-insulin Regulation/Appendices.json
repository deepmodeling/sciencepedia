{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in understanding any physiological system is analyzing its behavior around a steady state. This practice explores the local stability of the Minimal Model at the basal (fasting) state by applying linearization, a cornerstone technique in systems biology. By computing the Jacobian matrix and its eigenvalues, you will determine whether the system is inherently stable, meaning it naturally returns to equilibrium after small perturbations, a property known as homeostasis. ",
            "id": "3937941",
            "problem": "Consider the canonical two-state subsystem of the minimal model of glucose-insulin regulation describing glucose concentration and insulin action. Let $G(t)$ denote plasma glucose concentration and $X(t)$ denote insulin action on glucose disposal. The accepted basal glucose concentration is $G_{b}$ and the accepted basal insulin concentration is $I_{b}$. The model parameters $p_{1}$, $p_{2}$, and $p_{3}$ are positive and time-invariant. In the absence of exogenous glucose appearance and at basal insulin, the glucose dynamics and insulin action dynamics satisfy the following widely used relationships:\n$$\\frac{dG}{dt} = -\\left(p_{1} + X\\right)G + p_{1} G_{b},$$\n$$\\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I - I_{b}\\right),$$\nwhere $I(t)$ denotes plasma insulin concentration. Define the glucose deviation variable $\\tilde{G}(t) \\equiv G(t) - G_{b}$. At basal equilibrium, take $I(t) = I_{b}$ and assume no exogenous glucose appearance. Using only these foundational relationships and the deviation variable definition, derive the autonomous dynamics for the state vector $(\\tilde{G}, X)$, identify the basal equilibrium point $(\\tilde{G}, X)$, and compute the Jacobian matrix of the resulting $(\\tilde{G}, X)$ dynamics evaluated at that basal equilibrium. Then, discuss the eigenvalues of this Jacobian in terms of the parameters $p_{1}$ and $p_{2}$, including their signs and any implications for local stability. Express your final answer as the symbolic Jacobian matrix evaluated at the basal equilibrium. Do not substitute numerical values for any parameters.",
            "solution": "The problem requires an analysis of a two-state subsystem of the minimal model of glucose-insulin regulation. The analysis involves transforming the state variables, finding the equilibrium point of the transformed system, computing the Jacobian matrix at this equilibrium, and discussing its eigenvalues and the implications for system stability.\n\nThe given system dynamics are:\n$$ \\frac{dG}{dt} = -\\left(p_{1} + X\\right)G + p_{1} G_{b} $$\n$$ \\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I - I_{b}\\right) $$\nwhere $G(t)$ is plasma glucose concentration, $X(t)$ is insulin action, $I(t)$ is plasma insulin concentration, and $p_{1}, p_{2}, p_{3}, G_{b}, I_{b}$ are positive constants.\n\nFirst, we derive the dynamics for the state vector $(\\tilde{G}, X)$, where $\\tilde{G}(t)$ is the glucose deviation from basal, defined as $\\tilde{G}(t) \\equiv G(t) - G_{b}$. From this definition, we have $G(t) = \\tilde{G}(t) + G_{b}$. Since $G_{b}$ is a constant, the time derivative of $\\tilde{G}(t)$ is $\\frac{d\\tilde{G}}{dt} = \\frac{dG}{dt}$.\n\nWe substitute $G(t) = \\tilde{G}(t) + G_{b}$ into the first differential equation:\n$$ \\frac{d\\tilde{G}}{dt} = -\\left(p_{1} + X\\right)\\left(\\tilde{G} + G_{b}\\right) + p_{1} G_{b} $$\nExpanding the terms on the right-hand side gives:\n$$ \\frac{d\\tilde{G}}{dt} = -p_{1}\\tilde{G} - p_{1}G_{b} - X\\tilde{G} - XG_{b} + p_{1} G_{b} $$\nThe terms $-p_{1}G_{b}$ and $+p_{1}G_{b}$ cancel out, yielding:\n$$ \\frac{d\\tilde{G}}{dt} = -p_{1}\\tilde{G} - X\\tilde{G} - XG_{b} $$\nThis can be written as:\n$$ \\frac{d\\tilde{G}}{dt} = -(p_{1} + X)\\tilde{G} - G_{b}X $$\nThis is the first equation for our transformed system.\n\nFor the second equation, we consider the system at basal equilibrium, where the insulin concentration is at its basal level, $I(t) = I_{b}$. Substituting this into the equation for $\\frac{dX}{dt}$:\n$$ \\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I_{b} - I_{b}\\right) $$\n$$ \\frac{dX}{dt} = -p_{2} X $$\nThis is the second equation for our transformed system.\n\nThe autonomous system of differential equations for the state vector $(\\tilde{G}, X)$ is therefore:\n$$ \\frac{d\\tilde{G}}{dt} = f_1(\\tilde{G}, X) = -(p_{1} + X)\\tilde{G} - G_{b}X $$\n$$ \\frac{dX}{dt} = f_2(\\tilde{G}, X) = -p_{2} X $$\n\nNext, we identify the basal equilibrium point $(\\tilde{G}_{eq}, X_{eq})$ by setting the time derivatives to zero:\n$$ \\frac{d\\tilde{G}}{dt} = 0 $$\n$$ \\frac{dX}{dt} = 0 $$\nFrom the second equation, $0 = -p_{2} X_{eq}$. Since the parameter $p_{2}$ is positive, this implies $X_{eq} = 0$.\nSubstituting $X_{eq} = 0$ into the first equation:\n$$ 0 = -(p_{1} + 0)\\tilde{G}_{eq} - G_{b}(0) $$\n$$ 0 = -p_{1}\\tilde{G}_{eq} $$\nSince the parameter $p_{1}$ is positive, this implies $\\tilde{G}_{eq} = 0$.\nThus, the basal equilibrium point for the $(\\tilde{G}, X)$ dynamics is $(0, 0)$. This corresponds to the state where glucose is at its basal level ($G = G_b$) and insulin action is at its basal level ($X=0$).\n\nNow, we compute the Jacobian matrix, $J$, of the system, which is defined as:\n$$ J = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial \\tilde{G}} & \\frac{\\partial f_1}{\\partial X} \\\\ \\frac{\\partial f_2}{\\partial \\tilde{G}} & \\frac{\\partial f_2}{\\partial X} \\end{pmatrix} $$\nWe compute the necessary partial derivatives from $f_1(\\tilde{G}, X) = -p_{1}\\tilde{G} - X\\tilde{G} - G_{b}X$ and $f_2(\\tilde{G}, X) = -p_{2}X$:\n$$ \\frac{\\partial f_1}{\\partial \\tilde{G}} = -p_{1} - X $$\n$$ \\frac{\\partial f_1}{\\partial X} = -\\tilde{G} - G_{b} $$\n$$ \\frac{\\partial f_2}{\\partial \\tilde{G}} = 0 $$\n$$ \\frac{\\partial f_2}{\\partial X} = -p_{2} $$\nThe Jacobian matrix is:\n$$ J(\\tilde{G}, X) = \\begin{pmatrix} -p_{1} - X & -\\tilde{G} - G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} $$\nThe final step is to evaluate this Jacobian at the basal equilibrium point $(\\tilde{G}_{eq}, X_{eq}) = (0, 0)$:\n$$ J(0, 0) = \\begin{pmatrix} -p_{1} - 0 & -0 - G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} = \\begin{pmatrix} -p_{1} & -G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} $$\nThis is the Jacobian matrix of the linearized system at the basal equilibrium.\n\nFinally, we discuss the eigenvalues of this Jacobian and the implications for local stability. The Jacobian matrix is an upper triangular matrix. The eigenvalues of a triangular matrix are its diagonal entries. Therefore, the eigenvalues are:\n$$ \\lambda_1 = -p_{1} $$\n$$ \\lambda_2 = -p_{2} $$\nThe problem statement specifies that the parameters $p_{1}$ and $p_{2}$ are positive. Consequently, both eigenvalues, $\\lambda_1$ and $\\lambda_2$, are strictly negative real numbers.\nAccording to linear stability analysis, if all eigenvalues of the Jacobian matrix evaluated at an equilibrium point have negative real parts, the equilibrium is locally asymptotically stable. Since both $\\lambda_1 < 0$ and $\\lambda_2 < 0$, the basal equilibrium point $(0, 0)$ is a stable node. This implies that for any small perturbation away from this equilibrium, the system will naturally return to the basal state over time. This mathematical result is consistent with the physiological principle of homeostasis.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -p_1 & -G_b \\\\ 0 & -p_2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The Minimal Model includes a \"hidden\" state, the remote insulin action $X(t)$, which is not directly measurable in a clinical setting. This raises a fundamental question: can we uniquely determine the behavior of $X(t)$ by observing only the plasma glucose concentration $G(t)$? This practice delves into the concept of observability from linear systems theory to formally answer this question, revealing the conditions under which the full state of the system can be inferred from its output. ",
            "id": "3937913",
            "problem": "Consider the Bergman minimal model of glucose-insulin regulation linearized around the basal steady state, where $G(t)$ is plasma glucose concentration, $I(t)$ is plasma insulin concentration, $G_b$ and $I_b$ are their basal values, and the insulin action state is $X(t)$. Define the deviations $\\tilde G(t) \\equiv G(t)-G_b$ and the insulin input deviation $u(t) \\equiv I(t)-I_b$. The linearized dynamics in the absence of exogenous glucose appearance are given by the following two-dimensional state-space model:\n$$\n\\frac{d}{dt}\\tilde G(t) = -p_1\\,\\tilde G(t) - G_b\\,X(t), \\quad \\frac{d}{dt}X(t) = -p_2\\,X(t) + p_3\\,u(t),\n$$\nwith output\n$$\ny(t) = \\tilde G(t).\n$$\nHere $p_1$, $p_2$, and $p_3$ are positive constants with units chosen so that the equations are dimensionally consistent, and $G_b > 0$ is the basal glucose concentration. Let the state vector be $x(t) \\equiv [\\tilde G(t)\\;\\;X(t)]^{\\top}$, the input be $u(t)$, and the output be $y(t)$.\n\nUsing only fundamental definitions from linear systems theory, do the following:\n- Write the state-space matrices $A$, $B$, $C$, and $D$ for this linearized system.\n- Construct the observability matrix $\\mathcal{O}$ for the pair $(A,C)$ with $y(t)=\\tilde G(t)$.\n- Determine the analytic conditions on $p_1$ and $p_2$ under which the system is observable.\n\nProvide as your final answer the closed-form expression for $\\det(\\mathcal{O})$ in terms of the model parameters. No numerical evaluation is required, and no rounding is needed. Do not include units in the final answer.",
            "solution": "We begin from the linearized state equations and output definition. By inspection, with $x(t) \\equiv [\\tilde G(t)\\;\\;X(t)]^{\\top}$ and $u(t) \\equiv I(t)-I_b$, the state-space form $\\dot{x}(t) = A x(t) + B u(t)$ and $y(t) = C x(t) + D u(t)$ follows directly from the given dynamics:\n$$\n\\frac{d}{dt}\\tilde G(t) = -p_1\\,\\tilde G(t) - G_b\\,X(t), \\quad \\frac{d}{dt}X(t) = -p_2\\,X(t) + p_3\\,u(t), \\quad y(t) = \\tilde G(t).\n$$\nTherefore, the matrices are\n$$\nA = \\begin{bmatrix}\n-p_1 & -G_b \\\\\n0 & -p_2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\\np_3\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1 & 0\n\\end{bmatrix}, \\quad\nD = \\begin{bmatrix}\n0\n\\end{bmatrix}.\n$$\n\nBy definition, the observability matrix for a linear time-invariant system with state matrix $A \\in \\mathbb{R}^{n \\times n}$ and output matrix $C \\in \\mathbb{R}^{p \\times n}$ is\n$$\n\\mathcal{O} = \\begin{bmatrix}\nC \\\\\nC A \\\\\n\\vdots \\\\\nC A^{n-1}\n\\end{bmatrix}.\n$$\nSince $n = 2$ in this problem and $C \\in \\mathbb{R}^{1 \\times 2}$, we have\n$$\n\\mathcal{O} = \\begin{bmatrix}\nC \\\\\nC A\n\\end{bmatrix}.\n$$\nCompute $C A$:\n$$\nC A = \\begin{bmatrix} 1 & 0 \\end{bmatrix}\n\\begin{bmatrix}\n-p_1 & -G_b \\\\\n0 & -p_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-p_1 & -G_b\n\\end{bmatrix}.\n$$\nThus,\n$$\n\\mathcal{O} = \\begin{bmatrix}\n1 & 0 \\\\\n-p_1 & -G_b\n\\end{bmatrix}.\n$$\n\nA necessary and sufficient condition for observability of the pair $(A,C)$ in the two-dimensional case is that $\\mathcal{O}$ has full column rank, equivalently that $\\det(\\mathcal{O}) \\neq 0$. The determinant is\n$$\n\\det(\\mathcal{O}) =\n\\begin{vmatrix}\n1 & 0 \\\\\n-p_1 & -G_b\n\\end{vmatrix}\n= (1)\\cdot(-G_b) - (0)\\cdot(-p_1) = -G_b.\n$$\nTherefore, $\\mathcal{O}$ is full rank if and only if $G_b \\neq 0$. Since physiological basal glucose $G_b$ is strictly positive, the model is observable for all positive $p_1$ and $p_2$. In particular, there are no additional restrictions on $p_1$ and $p_2$; observability does not depend on their values beyond the standard assumption that they are finite real parameters. Concretely, for any $p_1 \\in \\mathbb{R}$ and $p_2 \\in \\mathbb{R}$, with $G_b \\neq 0$, the pair $(A,C)$ is observable.\n\nIn summary, the observability matrix is $\\mathcal{O} = \\begin{bmatrix} 1 & 0 \\\\ -p_1 & -G_b \\end{bmatrix}$, the determinant is $\\det(\\mathcal{O}) = -G_b$, and the system is observable for all $p_1$ and $p_2$ provided $G_b \\neq 0$ (which holds in any physiological setting where $G_b > 0$).",
            "answer": "$$\\boxed{-G_b}$$"
        },
        {
            "introduction": "While analytical methods provide deep insight, real-world applications of the Minimal Model rely heavily on numerical simulation. This practice bridges theory and computation by focusing on the insulin action sub-model, which is a linear ordinary differential equation. You will derive an \"exact\" discrete-time update formula—assuming a piecewise-constant insulin input—and compare its accuracy and stability against the widely used but approximate forward Euler method, providing a tangible lesson on the nuances of numerical modeling. ",
            "id": "3937936",
            "problem": "Consider the insulin action compartment of the Minimal Model of Glucose-Insulin Regulation, which describes the dynamics of insulin-mediated glucose uptake. The compartment variable, denoted by $X(t)$, represents insulin action on glucose disposal and has units of $\\mathrm{min}^{-1}$. A widely accepted representation for this compartment is a first-order linear Ordinary Differential Equation (ODE) with a constant decay rate and a forcing term proportional to the deviation of plasma insulin concentration $I(t)$ from a basal level $I_b$:\n$$\n\\frac{dX(t)}{dt} = -p_2\\,X(t) + p_3\\left(I(t) - I_b\\right),\n$$\nwhere $p_2$ has units of $\\mathrm{min}^{-1}$ and $p_3$ has units of $\\mathrm{min}^{-2}/(\\mu\\mathrm{U/mL})$. Assume $I(t)$ is piecewise-constant over a grid of intervals $[t_k, t_{k+1})$ of lengths $\\Delta_k = t_{k+1} - t_k$, with values $I_k$ on each interval. Let the initial condition be $X(0) = X_0$.\n\nTask 1. Starting from the fundamental definition of a linear time-invariant ODE and the method of integrating factors, derive the exact discrete-time mapping that advances $X$ from $t_k$ to $t_{k+1}$ when $I(t)$ is constant on $[t_k, t_{k+1})$. Specifically, derive a mapping of the form\n$$\nX_{k+1} = \\alpha_k\\,X_k + \\beta_k\\,\\left(I_k - I_b\\right),\n$$\nexpressing $\\alpha_k$ and $\\beta_k$ in terms of $p_2$, $p_3$, and $\\Delta_k$. Do not use any shortcut formulas; start from the ODE and apply first principles.\n\nTask 2. Implement two simulation schemes on the same grid $\\{t_k\\}$ with piecewise-constant $I_k$:\n- The exact discretization derived in Task 1.\n- The forward Euler method for the ODE:\n$$\nX_{k+1}^{\\text{Euler}} = X_k^{\\text{Euler}} + \\Delta_k\\left(-p_2\\,X_k^{\\text{Euler}} + p_3\\left(I_k - I_b\\right)\\right).\n$$\n\nTask 3. For each parameter set in the test suite below, simulate $X$ across all intervals from $k=0$ to $k=N-1$ and compute the Root Mean Square (RMS) absolute error between the exact-discretization sequence $\\{X_k\\}$ and the forward Euler sequence $\\{X_k^{\\text{Euler}}\\}$ over the grid points $\\{t_{k+1}\\}_{k=0}^{N-1}$:\n$$\n\\text{RMS error} = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1}\\left(X_{k+1}^{\\text{Euler}} - X_{k+1}\\right)^2}.\n$$\nExpress the RMS error in units of $\\mathrm{min}^{-1}$ as a floating-point number.\n\nTest Suite. Use the following scientifically plausible parameter sets and insulin profiles that are piecewise-constant per interval. In all cases, $X_0 = 0~\\mathrm{min}^{-1}$.\n\n- Case A (happy path):\n  - $p_2 = 0.02~\\mathrm{min}^{-1}$, $p_3 = 5\\times 10^{-4}~\\mathrm{min}^{-2}/(\\mu\\mathrm{U/mL})$, $I_b = 15~\\mu\\mathrm{U/mL}$.\n  - Uniform grid: $N=12$ intervals, $\\Delta_k = 5~\\mathrm{min}$ for all $k$ (total $60~\\mathrm{min}$).\n  - Insulin profile: $I_k = 60~\\mu\\mathrm{U/mL}$ for $k=0,1,2,3,4,5$ (first $30~\\mathrm{min}$), and $I_k = 15~\\mu\\mathrm{U/mL}$ for $k=6,7,8,9,10,11$.\n\n- Case B (small step edge case):\n  - $p_2 = 0.1~\\mathrm{min}^{-1}$, $p_3 = 10^{-3}~\\mathrm{min}^{-2}/(\\mu\\mathrm{U/mL})$, $I_b = 10~\\mu\\mathrm{U/mL}$.\n  - Uniform grid: $N=160$ intervals, $\\Delta_k = 0.25~\\mathrm{min}$ for all $k$ (total $40~\\mathrm{min}$).\n  - Insulin profile: $I_k = 30~\\mu\\mathrm{U/mL}$ for $k=0,1,\\dots,39$ (first $10~\\mathrm{min}$), and $I_k = 10~\\mu\\mathrm{U/mL}$ for $k=40,41,\\dots,159$.\n\n- Case C (stiff decay and coarse step):\n  - $p_2 = 0.5~\\mathrm{min}^{-1}$, $p_3 = 2\\times 10^{-3}~\\mathrm{min}^{-2}/(\\mu\\mathrm{U/mL})$, $I_b = 15~\\mu\\mathrm{U/mL}$.\n  - Uniform grid: $N=6$ intervals, $\\Delta_k = 10~\\mathrm{min}$ for all $k$ (total $60~\\mathrm{min}$).\n  - Insulin profile: $I_k = 100~\\mu\\mathrm{U/mL}$ for $k=0,1$ (first $20~\\mathrm{min}$), and $I_k = 15~\\mu\\mathrm{U/mL}$ for $k=2,3,4,5$.\n\n- Case D (basal insulin only):\n  - $p_2 = 0.05~\\mathrm{min}^{-1}$, $p_3 = 8\\times 10^{-4}~\\mathrm{min}^{-2}/(\\mu\\mathrm{U/mL})$, $I_b = 12~\\mu\\mathrm{U/mL}$.\n  - Uniform grid: $N=12$ intervals, $\\Delta_k = 5~\\mathrm{min}$ for all $k$ (total $60~\\mathrm{min}$).\n  - Insulin profile: $I_k = 12~\\mu\\mathrm{U/mL}$ for all $k=0,1,\\dots,11$.\n\nFinal Output Format. Your program should produce a single line of output containing the RMS errors for the four cases, in order A, B, C, D, as a comma-separated list enclosed in square brackets (for example, `[x_A,x_B,x_C,x_D]`). Each entry must be a floating-point number in $\\mathrm{min}^{-1}$ units.",
            "solution": "We start from the insulin action compartment ODE\n$$\n\\frac{dX(t)}{dt} = -p_2\\,X(t) + p_3\\left(I(t) - I_b\\right),\n$$\nwith $p_2 > 0$, and piecewise-constant $I(t)$ over intervals $[t_k, t_{k+1})$ of length $\\Delta_k = t_{k+1} - t_k$. On each interval, $I(t) = I_k$ is constant, and the ODE becomes a linear time-invariant ODE with constant coefficients and a constant input:\n$$\n\\frac{dX(t)}{dt} + p_2\\,X(t) = p_3\\left(I_k - I_b\\right).\n$$\n\nTo derive the exact discrete-time mapping, we use the integrating factor method. The integrating factor for this linear ODE is $e^{p_2 t}$. Multiplying both sides by the integrating factor yields\n$$\ne^{p_2 t}\\frac{dX(t)}{dt} + p_2 e^{p_2 t} X(t) = p_3\\left(I_k - I_b\\right) e^{p_2 t}.\n$$\nRecognizing the left-hand side as the derivative of $e^{p_2 t} X(t)$, we write\n$$\n\\frac{d}{dt}\\left(e^{p_2 t} X(t)\\right) = p_3\\left(I_k - I_b\\right) e^{p_2 t}.\n$$\nIntegrating from $t_k$ to $t_{k+1} = t_k + \\Delta_k$ and denoting $X_k = X(t_k)$ and $X_{k+1} = X(t_{k+1})$, we obtain\n$$\ne^{p_2 t_{k+1}} X_{k+1} - e^{p_2 t_k} X_k = p_3\\left(I_k - I_b\\right) \\int_{t_k}^{t_{k+1}} e^{p_2 s}\\,ds.\n$$\nCompute the integral:\n$$\n\\int_{t_k}^{t_{k+1}} e^{p_2 s}\\,ds = \\frac{1}{p_2}\\left(e^{p_2 t_{k+1}} - e^{p_2 t_k}\\right).\n$$\nSubstitute:\n$$\ne^{p_2 t_{k+1}} X_{k+1} - e^{p_2 t_k} X_k = \\frac{p_3}{p_2}\\left(I_k - I_b\\right)\\left(e^{p_2 t_{k+1}} - e^{p_2 t_k}\\right).\n$$\nDivide both sides by $e^{p_2 t_{k+1}}$:\n$$\nX_{k+1} - e^{-p_2 \\Delta_k} X_k = \\frac{p_3}{p_2}\\left(I_k - I_b\\right)\\left(1 - e^{-p_2 \\Delta_k}\\right).\n$$\nTherefore, the exact discrete-time mapping is\n$$\nX_{k+1} = \\alpha_k\\,X_k + \\beta_k\\,\\left(I_k - I_b\\right),\n$$\nwith\n$$\n\\alpha_k = e^{-p_2 \\Delta_k}, \\qquad \\beta_k = \\frac{p_3}{p_2}\\left(1 - e^{-p_2 \\Delta_k}\\right).\n$$\nThis mapping is exact at the grid points for each interval with constant $I_k$.\n\nFor the forward Euler method, we apply the explicit time-stepping formula on each interval:\n$$\nX_{k+1}^{\\text{Euler}} = X_k^{\\text{Euler}} + \\Delta_k \\left(-p_2\\,X_k^{\\text{Euler}} + p_3\\left(I_k - I_b\\right)\\right) = \\left(1 - p_2 \\Delta_k\\right) X_k^{\\text{Euler}} + \\Delta_k p_3 \\left(I_k - I_b\\right).\n$$\nEuler's method is a first-order accurate scheme, and for the scalar linear decay term $-p_2 X$, its stability with respect to the homogeneous part requires $\\left|1 - p_2 \\Delta_k\\right| < 1$, that is, $0 < p_2 \\Delta_k < 2$. When $p_2 \\Delta_k$ is large, Euler may produce oscillatory or diverging behavior, whereas the exact discretization remains stable because $e^{-p_2 \\Delta_k}$ is always bounded in magnitude by $1$ for $p_2 > 0$.\n\nAlgorithmic design:\n- Given $(p_2, p_3, I_b, X_0)$, a grid of lengths $\\{\\Delta_k\\}$, and insulin values $\\{I_k\\}$, compute the exact sequence $\\{X_k\\}$ using $X_{k+1} = e^{-p_2 \\Delta_k} X_k + \\frac{p_3}{p_2}\\left(1 - e^{-p_2 \\Delta_k}\\right)\\left(I_k - I_b\\right)$.\n- Independently compute the forward Euler sequence $\\{X_{k+1}^{\\text{Euler}}\\}$ using $X_{k+1}^{\\text{Euler}} = \\left(1 - p_2 \\Delta_k\\right) X_k^{\\text{Euler}} + \\Delta_k p_3 \\left(I_k - I_b\\right)$.\n- Compute the Root Mean Square (RMS) absolute error over all steps:\n$$\n\\text{RMS error} = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1}\\left(X_{k+1}^{\\text{Euler}} - X_{k+1}\\right)^2}.\n$$\nThis error is in units of $\\mathrm{min}^{-1}$.\n\nEdge-case behavior in the test suite:\n- Case A uses moderate $p_2$ and interval length, so Euler error is moderate and exact discretization provides a clear improvement.\n- Case B uses very small $\\Delta_k$, so Euler error should be small; exact discretization yields machine-precision agreement at grid points.\n- Case C uses a large $p_2$ and coarse $\\Delta_k$, making $p_2 \\Delta_k \\gg 2$, so Euler can be unstable, leading to large error, whereas the exact discretization remains well-behaved.\n- Case D uses basal insulin throughout, so the forcing term vanishes. The exact solution reduces to pure exponential decay $X_{k+1} = e^{-p_2 \\Delta_k} X_k$, while Euler provides a linearized decay; their difference quantifies discretization error without input.\n\nThe final program implements these computations precisely and prints a single line in the required format with four floating-point RMS error values for cases A, B, C, and D, each in $\\mathrm{min}^{-1}$ units.",
            "answer": "```python\nimport numpy as np\n\ndef exact_discretization_sequence(p2, p3, Ib, X0, deltas, I_values):\n    \"\"\"\n    Compute X_k using the exact discretization for dX/dt = -p2 X + p3 (I - Ib),\n    with piecewise-constant I over each interval [t_k, t_{k+1}).\n    \"\"\"\n    N = len(deltas)\n    X = np.zeros(N + 1, dtype=float)\n    X[0] = X0\n    for k in range(N):\n        delta = deltas[k]\n        Ik = I_values[k]\n        alpha = np.exp(-p2 * delta)\n        beta = (p3 / p2) * (1.0 - alpha)\n        X[k + 1] = alpha * X[k] + beta * (Ik - Ib)\n    return X\n\ndef euler_sequence(p2, p3, Ib, X0, deltas, I_values):\n    \"\"\"\n    Compute X_k using forward Euler for the same ODE and piecewise-constant I.\n    \"\"\"\n    N = len(deltas)\n    X = np.zeros(N + 1, dtype=float)\n    X[0] = X0\n    for k in range(N):\n        delta = deltas[k]\n        Ik = I_values[k]\n        X[k + 1] = (1.0 - p2 * delta) * X[k] + delta * p3 * (Ik - Ib)\n    return X\n\ndef rms_error(sequence_a, sequence_b):\n    \"\"\"\n    Compute RMS error over steps k=0..N-1 comparing the values at k+1.\n    Both sequences are length N+1; compare entries 1..N.\n    \"\"\"\n    diff = sequence_a[1:] - sequence_b[1:]\n    return float(np.sqrt(np.mean(diff * diff)))\n\ndef case_A():\n    # Parameters\n    p2 = 0.02  # 1/min\n    p3 = 5e-4  # 1/(min^2 * microU/mL)\n    Ib = 15.0  # microU/mL\n    X0 = 0.0   # 1/min\n    N = 12\n    delta = 5.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([60.0]*6 + [15.0]*6, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_B():\n    p2 = 0.1   # 1/min\n    p3 = 1e-3  # 1/(min^2 * microU/mL)\n    Ib = 10.0  # microU/mL\n    X0 = 0.0   # 1/min\n    N = 160\n    delta = 0.25  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([30.0]*40 + [10.0]*120, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_C():\n    p2 = 0.5    # 1/min\n    p3 = 2e-3   # 1/(min^2 * microU/mL)\n    Ib = 15.0   # microU/mL\n    X0 = 0.0    # 1/min\n    N = 6\n    delta = 10.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([100.0]*2 + [15.0]*4, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_D():\n    p2 = 0.05   # 1/min\n    p3 = 8e-4   # 1/(min^2 * microU/mL)\n    Ib = 12.0   # microU/mL\n    X0 = 0.0    # 1/min\n    N = 12\n    delta = 5.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([12.0]*N, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef solve():\n    test_cases = [case_A(), case_B(), case_C(), case_D()]\n    results = []\n    for (p2, p3, Ib, X0, deltas, I_values) in test_cases:\n        X_exact = exact_discretization_sequence(p2, p3, Ib, X0, deltas, I_values)\n        X_euler = euler_sequence(p2, p3, Ib, X0, deltas, I_values)\n        err = rms_error(X_euler, X_exact)\n        results.append(err)\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}