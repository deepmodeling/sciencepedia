{
    "hands_on_practices": [
        {
            "introduction": "理论模型的美妙之处在于其普适性。通过无量纲化这一数学技巧，我们可以剥离模型中的物理单位，揭示其最核心的动态行为。本练习将引导你对标准的漏放-整合（LIF）神经元方程进行无量纲化()，将诸如膜电容 $C_m$ 和漏电导 $g_L$ 等多个生物物理参数，合并为少数几个关键的无量纲组合。这个过程不仅能简化模型的数学分析，还能让你深刻理解为何具有不同参数的神经元可能表现出相同的基本响应模式。",
            "id": "3893999",
            "problem": "一个单室神经元由漏泄积分-发放 (LIF) 阈下膜方程建模，该方程源于应用于膜电容和漏泄支路的基尔霍夫电流定律，其形式为 $C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\big(V - E_{L}\\big) + I(t)$。这里，$C_{m}$ 是膜电容，$g_{L}$ 是漏泄电导，$E_{L}$ 是漏泄反转电位，$V(t)$ 是膜电压，$I(t)$ 是一个随时间变化的输入电流。峰电位的生成机制是通过一个位于 $V_{\\text{th}}$ 的阈值和一个复位来外部施加的，但对于本任务，只需关注连续的阈下动力学。\n\n定义膜时间常数 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$。引入无量纲变量 $u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$ 和 $s = \\frac{t}{\\tau_{m}}$，并定义无量纲输入 $\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$，其中应使用依赖关系 $t = \\tau_{m}\\,s$ 将 $\\tilde{I}$ 视为 $s$ 的函数。\n\n从物理的 LIF 定律 $C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\big(V - E_{L}\\big) + I(t)$ 和上述定义出发，进行无量纲化，以获得 $u(s)$ 的简化动力学，其一阶形式为 $\\frac{du}{ds} = F(u,s)$。推导右手侧函数 $F(u,s)$ 的闭式表达式，使其仅用 $u$ 和 $\\tilde{I}(s)$ 表示，不含任何有量纲的参数。\n\n你的最终答案必须是 $F(u,s)$ 的单个解析表达式（不要写成方程），不需要单位。不需要进行数值舍入。",
            "solution": "该问题是有效的。这是一个适定且有科学依据的练习，内容是关于一个标准生物物理模型——漏泄积分-发放神经元的无量纲化。所有定义都清晰、一致，并足以进行所需的推导。\n\n分析从所提供的阈下膜动力学开始：\n$$C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\left(V - E_{L}\\right) + I(t)$$\n目标是使用指定的变量替换，将此方程转换为无量纲形式 $\\frac{du}{ds} = F(u,s)$。\n\n无量纲变量定义如下：\n1. 无量纲电压: $u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$\n2. 无量纲时间: $s = \\frac{t}{\\tau_{m}}$\n3. 无量纲输入电流: $\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$\n\n此外，膜时间常数定义为 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$。\n\n首先，我们必须用新变量 $u$ 和 $s$ 来表示导数 $\\frac{dV}{dt}$。这需要应用链式法则：\n$$\\frac{dV}{dt} = \\frac{dV}{du} \\frac{du}{ds} \\frac{ds}{dt}$$\n我们必须求出右手边三个导数中每一个的表达式。\n\n为了求出 $\\frac{dV}{du}$，我们重排 $u$ 的定义，将 $V$ 表示为 $u$ 的函数：\n$$u \\left(V_{\\text{th}} - E_{L}\\right) = V - E_{L}$$\n$$V(u) = u \\left(V_{\\text{th}} - E_{L}\\right) + E_{L}$$\n由于 $V_{\\text{th}}$ 和 $E_{L}$ 是常数，$V$ 对 $u$ 的导数是：\n$$\\frac{dV}{du} = V_{\\text{th}} - E_{L}$$\n\n为了求出 $\\frac{ds}{dt}$，我们使用 $s$ 的定义：\n$$s(t) = \\frac{t}{\\tau_{m}}$$\n$s$ 对 $t$ 的导数是：\n$$\\frac{ds}{dt} = \\frac{1}{\\tau_{m}}$$\n\n现在，我们将这些导数代回到链式法则表达式中：\n$$\\frac{dV}{dt} = \\left(V_{\\text{th}} - E_{L}\\right) \\frac{du}{ds} \\left(\\frac{1}{\\tau_{m}}\\right) = \\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{du}{ds}$$\n\n接下来，我们将 $\\frac{dV}{dt}$ 的这个表达式代入原始的 LIF 方程：\n$$C_{m} \\left(\\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{du}{ds}\\right) = -g_{L}\\,\\left(V - E_{L}\\right) + I(t)$$\n\n我们的目标是分离出 $\\frac{du}{ds}$，所以我们重排方程：\n$$\\frac{du}{ds} = \\frac{\\tau_{m}}{C_{m}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n现在，代入时间常数的定义 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$：\n$$\\frac{du}{ds} = \\frac{C_{m}/g_{L}}{C_{m}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n电容 $C_{m}$ 被消去：\n$$\\frac{du}{ds} = \\frac{1}{g_{L}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n将括号外的项分配进去得到：\n$$\\frac{du}{ds} = -\\frac{g_{L}\\,(V - E_{L})}{g_{L}\\,(V_{\\text{th}} - E_{L})} + \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$$\n右手侧第一项中的漏泄电导 $g_{L}$ 被消去：\n$$\\frac{du}{ds} = -\\frac{V - E_{L}}{V_{\\text{th}} - E_{L}} + \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$$\n\n最后，我们代入无量纲电压 $u$ 和无量纲电流 $\\tilde{I}(s)$ 的定义：\n- 第一项根据定义是 $u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$。\n- 第二项根据定义是 $\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$。\n\n代入这些定义，得到最终的无量纲方程：\n$$\\frac{du}{ds} = -u + \\tilde{I}(s)$$\n\n问题要求的是形式为 $\\frac{du}{ds} = F(u,s)$ 的函数 $F(u,s)$。通过直接比较，我们确定该函数为：\n$$F(u,s) = -u + \\tilde{I}(s)$$\n此表达式完全由无量纲变量 $u$ 和 $\\tilde{I}(s)$ 表示，所有有量纲的参数都已按要求消除。",
            "answer": "$$\\boxed{-u + \\tilde{I}(s)}$$"
        },
        {
            "introduction": "模型只有在能预测可测量的行为时才具有价值。本练习将理论与实践联系起来，要求你推导漏放-整合神经元在恒定电流输入下的一个核心特性——频率-电流（F-I）曲线()。通过精确求解膜电位微分方程，你将计算出神经元达到放电阈值所需的时间，并理解膜时间常数 $\\tau_m$ 和绝对不应期 $t_{\\text{ref}}$ 等参数如何塑造神经元的响应。这个过程将让你亲身体验如何从模型的底层参数出发，预测神经元编码信息的基本方式。",
            "id": "4049955",
            "problem": "考虑一个由恒定输入电流驱动的单室漏放电积分（Leaky Integrate-and-Fire, LIF）神经元。膜电压遵循基尔霍夫电流定律，结合了电容电流和泄漏电流，得到一阶线性微分方程 $C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$，其中 $C$ 是膜电容，$g_{L}$ 是泄漏电导，$E_{L}$ 是泄漏反转电位，$I_{0}$ 是恒定输入电流。当 $V(t)$ 达到阈值 $V_{\\text{th}}$ 时，会发放一个脉冲，此时电压瞬时重置为 $V_{r}$ 并在此值保持一个绝对不应期 $t_{\\text{ref}}$，然后动力学过程继续。假设在恒定驱动下，神经元会重复、稳定地发放脉冲。\n\n仅从上述物理定律和每个周期开始时的初始条件 $V(0)=V_{r}$ 出发，推导稳态发放频率作为恒定电流 $I_{0}$ 和神经元参数的函数的闭式表达式。然后，使用该表达式计算以下参数值下的发放频率：\n- $C=250\\,\\text{pF}$，\n- $g_{L}=12.5\\,\\text{nS}$，\n- $E_{L}=-65\\,\\text{mV}$，\n- $V_{\\text{th}}=-50\\,\\text{mV}$，\n- $V_{r}=-65\\,\\text{mV}$，\n- $I_{0}=0.75\\,\\text{nA}$，\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$。\n\n将最终频率以 $\\text{Hz}$ 为单位表示，并将答案四舍五入到四位有效数字。确保推导从给定的微分方程开始，并遵循第一性原理，不使用目标公式的快捷方式。",
            "solution": "此问题已经过验证。\n\n### 步骤 1：提取已知条件\n问题给出了膜电压 $V(t)$ 的控制微分方程：\n$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$\n\n参数和条件如下：\n- $C$：膜电容\n- $g_{L}$：泄漏电导\n- $E_{L}$：泄漏反转电位\n- $I_{0}$：恒定输入电流\n- $V_{\\text{th}}$：阈值电压\n- $V_{r}$：重置电压\n- $t_{\\text{ref}}$：绝对不应期\n\n每个周期积分阶段的初始条件是 $V(0)=V_{r}$。\n\n参数的数值如下：\n- $C=250\\,\\text{pF}$\n- $g_{L}=12.5\\,\\text{nS}$\n- $E_{L}=-65\\,\\text{mV}$\n- $V_{\\text{th}}=-50\\,\\text{mV}$\n- $V_{r}=-65\\,\\text{mV}$\n- $I_{0}=0.75\\,\\text{nA}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了漏放电积分（LIF）模型，这是计算神经科学中一个标准且基础的模型。其控制方程是 Kirchhoff 电流定律在 RC 电路上的直接应用，这是对简单神经元模型的有效物理类比。所有概念在相关科学领域内都已得到公认。\n2.  **适定性：** 该问题提供了一个具有明确初始条件的一阶线性常微分方程。脉冲发放和重置的动力学过程有明确定义。任务是推导一个闭式表达式，然后计算一个数值，这两者都可以从给定信息中实现。只要输入电流足以将电压驱动至阈值，发放频率就存在唯一解。\n3.  **客观性：** 语言正式且精确。参数给出了具体的数值和单位。问题没有歧义。\n4.  **完整性：** 问题是自洽的。求解发放频率所需的所有必要参数和条件都已提供。\n5.  **一致性：** 参数及其单位是一致的。例如，电容单位为法拉（Farads），电导单位为西门子（Siemens），电位单位为伏特（Volts），电流单位为安培（Amperes），时间单位为秒（seconds）（从前缀转换后）。设置中没有矛盾之处。\n6.  **真实性：** 参数值是生物神经元模型的典型值。\n\n### 步骤 3：结论与行动\n该问题科学上有效、适定且自洽。可以进行求解。\n\n第一步是求解膜电位 $V(t)$ 的微分方程。给定的方程是：\n$$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$$\n我们可以通过两边同除以 $g_{L}$ 来重新整理这个方程：\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -\\big(V(t)-E_{L}\\big) + \\frac{I_{0}}{g_{L}}$$\n我们定义膜时间常数 $\\tau_{m} = C/g_{L}$ 和稳态电压（或总电流的反转电位）$V_{\\infty} = E_{L} + I_{0}/g_{L}$。将这些代入方程得到：\n$$\\tau_{m}\\frac{dV}{dt} = -(V - V_{\\infty})$$\n这是一个一阶线性常微分方程。我们可以通过分离变量法来求解它：\n$$\\frac{dV}{V-V_{\\infty}} = -\\frac{dt}{\\tau_{m}}$$\n我们对这个方程进行积分。电压在时间 $t=0$ 时从重置电位 $V_{r}$ 开始（这个时间点标志着不应期的结束），并一直增加，直到在某个我们称之为 $t_{\\text{charge}}$ 的时刻达到阈值 $V_{\\text{th}}$。\n$$\\int_{V_{r}}^{V_{\\text{th}}} \\frac{dV}{V-V_{\\infty}} = \\int_{0}^{t_{\\text{charge}}} -\\frac{dt}{\\tau_{m}}$$\n$$[\\ln|V-V_{\\infty}|]_{V_{r}}^{V_{\\text{th}}} = [-\\frac{t}{\\tau_{m}}]_{0}^{t_{\\text{charge}}}$$\n为了让神经元发放脉冲，稳态电压 $V_{\\infty}$ 必须大于阈值电压 $V_{\\text{th}}$。鉴于通常情况下 $V_{\\text{th}} > V_{r}$，我们有 $V_{\\infty} > V_{\\text{th}} > V_{r}$。因此，在积分上下限中，$V-V_{\\infty}$ 这两项都是负数，它们的绝对值是 $V_{\\infty}-V$。\n$$\\ln(V_{\\infty}-V_{\\text{th}}) - \\ln(V_{\\infty}-V_{r}) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n$$\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n求解充电时间 $t_{\\text{charge}}$：\n$$t_{\\text{charge}} = -\\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n这个 $t_{\\text{charge}}$ 的表达式仅在 $V_{\\infty} > V_{\\text{th}}$ 时有效，这等价于条件 $E_{L} + I_{0}/g_{L} > V_{\\text{th}}$，或者 $I_{0} > g_{L}(V_{\\text{th}} - E_{L})$。如果不满足这个条件，神经元将永远不会发放脉冲。\n\n一个周期的总时间，即脉冲间期（$T_{\\text{ISI}}$），是充电时间 $t_{\\text{charge}}$ 和绝对不应期 $t_{\\text{ref}}$ 的和。\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = t_{\\text{ref}} + \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n稳态发放频率 $f$ 是脉冲间期的倒数，$f = 1/T_{\\text{ISI}}$。\n代入 $\\tau_{m}$ 和 $V_{\\infty}$ 的表达式：\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{(E_{L} + I_{0}/g_{L}) - V_{r}}{(E_{L} + I_{0}/g_{L}) - V_{\\text{th}}}\\right)\\right]^{-1}$$\n这就是发放频率的闭式表达式。通过重新整理对数内的项，可以将其改写为：\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{I_{0} + g_{L}(E_{L} - V_{r})}{I_{0} + g_{L}(E_{L} - V_{\\text{th}})}\\right)\\right]^{-1}$$\n\n现在，我们使用给定的参数计算数值。首先，我们将所有参数转换为国际单位制（SI）基本单位：\n- $C=250\\,\\text{pF} = 250 \\times 10^{-12}\\,\\text{F}$\n- $g_{L}=12.5\\,\\text{nS} = 12.5 \\times 10^{-9}\\,\\text{S}$\n- $E_{L}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $V_{\\text{th}}=-50\\,\\text{mV} = -0.050\\,\\text{V}$\n- $V_{r}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $I_{0}=0.75\\,\\text{nA} = 0.75 \\times 10^{-9}\\,\\text{A}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms} = 1.5 \\times 10^{-3}\\,\\text{s}$\n\n我们计算中间值 $\\tau_m$ 和 $V_{\\infty}$：\n$$\\tau_{m} = \\frac{C}{g_{L}} = \\frac{250 \\times 10^{-12}\\,\\text{F}}{12.5 \\times 10^{-9}\\,\\text{S}} = 20 \\times 10^{-3}\\,\\text{s} = 0.02\\,\\text{s}$$\n$$V_{\\infty} = E_{L} + \\frac{I_{0}}{g_{L}} = -0.065\\,\\text{V} + \\frac{0.75 \\times 10^{-9}\\,\\text{A}}{12.5 \\times 10^{-9}\\,\\text{S}} = -0.065\\,\\text{V} + 0.06\\,\\text{V} = -0.005\\,\\text{V}$$\n\n我们检查发放条件：$V_{\\infty} > V_{\\text{th}}$ 是否成立？\n$-0.005\\,\\text{V} > -0.050\\,\\text{V}$。条件满足，因此神经元会发放脉冲。\n\n现在，我们计算 $t_{\\text{charge}}$。请注意，由于 $V_r = E_L$，在更通用的推导公式中，$g_L(E_L - V_r)$ 这一项为零。\n$$t_{\\text{charge}} = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{-0.005\\,\\text{V} - (-0.065\\,\\text{V})}{-0.005\\,\\text{V} - (-0.050\\,\\text{V})}\\right)$$\n$$t_{\\text{charge}} = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{0.060\\,\\text{V}}{0.045\\,\\text{V}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\n使用 $\\ln(4/3) \\approx 0.287682$：\n$$t_{\\text{charge}} \\approx 0.02 \\times 0.287682\\,\\text{s} \\approx 0.00575364\\,\\text{s}$$\n接下来，我们计算总的脉冲间期 $T_{\\text{ISI}}$：\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = 1.5 \\times 10^{-3}\\,\\text{s} + 0.00575364\\,\\text{s} = 0.0015\\,\\text{s} + 0.00575364\\,\\text{s} = 0.00725364\\,\\text{s}$$\n最后，我们计算发放频率 $f$：\n$$f = \\frac{1}{T_{\\text{ISI}}} = \\frac{1}{0.00725364\\,\\text{s}} \\approx 137.862\\,\\text{Hz}$$\n将结果四舍五入到四位有效数字，得到 $137.9\\,\\text{Hz}$。",
            "answer": "$$\\boxed{137.9}$$"
        },
        {
            "introduction": "将数学模型转化为可工作的计算机模拟，是理论神经科学的核心实践。传统的固定步长时间积分方法会引入数值误差，而事件驱动算法则能提供精确解。在本练习中，你将设计并实现一个针对漏放-整合神经元的事件驱动模拟器()。这个练习要求你将解析解转化为一种高效的算法，用于精确计算脉冲发放时间，从而避免离散化带来的误差，并为模拟更复杂的神经元网络打下坚实的基础。",
            "id": "3893993",
            "problem": "您的任务是为漏电积分-发放（LIF）神经元设计并实现一个事件驱动的模拟算法，该算法需适用于高级研究生水平的生物医学系统建模。该算法必须能精确地积分阈下动力学，并在正确的物理时间检测到阈值穿越，以避免数值时间步长误差。模型和所有必需的组件在下文中有详细说明，同时提供了一个测试套件，用于验证您实现的正确性和对边界情况的鲁棒性。\n\n漏电积分-发放神经元的阈下动力学遵循电容-漏电方程，这是经典生物物理膜模型的核心要素。其基本原理是膜电容电流等于漏电电流与输入电流之和：$$C \\frac{dV}{dt} = -g_L (V - E_L) + I(t),$$ 其中 $C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏电反转（静息）电位，$V(t)$ 是膜电位，$I(t)$ 是外部施加的电流。当 $V(t)$ 从下方达到阈值 $V_{\\mathrm{th}}$ 时，定义为发生一次尖峰。尖峰发生后，膜电位瞬时重置为 $V_{\\mathrm{reset}}$，并进入一个持续时间为 $t_{\\mathrm{ref}}$ 的绝对不应期，在此期间膜电位被钳制在 $V_{\\mathrm{reset}}$，且不能产生尖峰。\n\n您的事件驱动模拟必须依赖于在 $I(t)$ 的分段恒定段上的精确闭式积分，并具有精确的阈值穿越时间。假设 $I(t)$ 在指定的时间区间内是分段恒定的。您必须正确处理以下情况：\n- 每个恒定电流段内的阈下演化。\n- 段内精确的阈值穿越检测（包括恰好在段边界发生的穿越）。\n- 重置和绝对不应期，在此期间 $V(t)$ 被钳制在 $V_{\\mathrm{reset}}$。\n- 跨段边界的连续传播，无时间步长离散化误差。\n\n所有变量都必须使用国际单位制（SI）。具体来说，$V$ 的单位是伏特，$C$ 是法拉，$g_L$ 是西门子，$I$ 是安培，时间是秒。最终输出必须以秒为单位报告尖峰时间。\n\n您的程序必须实现事件驱动算法，并计算以下五个测试用例的尖峰时间。在每个用例中，输入电流 $I(t)$ 通过覆盖整个模拟持续时间的不重叠、连续的段 $(t_{\\mathrm{start}}, t_{\\mathrm{end}}, I)$ 来指定。参数如下：\n- 膜电容 $C$，\n- 漏电导 $g_L$，\n- 漏电反转电位 $E_L$，\n- 阈值 $V_{\\mathrm{th}}$，\n- 重置电位 $V_{\\mathrm{reset}}$，\n- 绝对不应期持续时间 $t_{\\mathrm{ref}}$，\n- $t=0$ 时的初始膜电位 $V_0$。\n\n测试套件（所有量均使用国际单位制）：\n1. 恒定超阈值驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$,\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$,\n   - $E_L = -0.065 \\text{ V}$,\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$,\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$,\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$,\n   - $V_0 = -0.065 \\text{ V}$,\n   - 段：$(0.0, 0.5, 5.0 \\times 10^{-10} \\text{ A})$。\n2. 恒定阈下驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$,\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$,\n   - $E_L = -0.065 \\text{ V}$,\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$,\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$,\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$,\n   - $V_0 = -0.065 \\text{ V}$,\n   - 段：$(0.0, 0.5, 1.0 \\times 10^{-10} \\text{ A})$。\n3. 阶跃电流：静息，然后活动，再静息：\n   - $C = 200 \\times 10^{-12} \\text{ F}$,\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$,\n   - $E_L = -0.065 \\text{ V}$,\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$,\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$,\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$,\n   - $V_0 = -0.065 \\text{ V}$,\n   - 段：$(0.0, 0.05, 0.0 \\text{ A}), (0.05, 0.2, 3.0 \\times 10^{-10} \\text{ A}), (0.2, 0.5, 0.0 \\text{ A})$。\n4. 边界穿越情况（阈值恰好在段末端）：\n   - $C = 200 \\times 10^{-12} \\text{ F}$,\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$,\n   - $E_L = -0.065 \\text{ V}$,\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$,\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$,\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$,\n   - $V_0 = -0.065 \\text{ V}$,\n   - 段：$(0.0, 0.05, 1.6345909609556877 \\times 10^{-10} \\text{ A})$。\n5. 不同初始条件下的超阈值恒定驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$,\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$,\n   - $E_L = -0.065 \\text{ V}$,\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$,\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$,\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$,\n   - $V_0 = -0.060 \\text{ V}$,\n   - 段：$(0.0, 0.1, 3.0 \\times 10^{-10} \\text{ A})$。\n\n您的程序必须使用精确检测逻辑计算每个用例的尖峰时间，并生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个Python风格的浮点数列表，表示以秒为单位的尖峰时间，并四舍五入到六位小数。例如，您的最终输出应类似于 $$[ [t_{1,1}, t_{1,2}, \\dots], [t_{2,1}, \\dots], \\dots ]$$，显示在单行上，其中每个 $t_{i,j}$ 是一个以秒为单位、四舍五入到六位小数的浮点数。不应打印任何其他文本。\n\n您的算法必须是事件驱动的，并且必须避免使用时间步进方法。您的实现必须对边界情况具有鲁棒性，包括段内没有尖峰发生、渐近电位低于阈值以及在段边界处恰好达到阈值的情况。所有计算和输出都必须按规定使用秒、伏特、西门子、法拉和安培。所有最终的尖峰时间都以秒表示，并四舍五入到六位小数。最终输出必须是单行，格式为 $[result_1, result_2, result_3, result_4, result_5]$，其中每个 $result_i$ 是一个包含四舍五入后浮点数的列表。",
            "solution": "该问题要求为漏电积分-发放（LIF）神经元模型设计并实现一个事件驱动的模拟算法。该算法必须是精确的，通过利用模型对分段恒定输入电流的控制微分方程的解析解来避免数值离散化。\n\n**1. 阈下动力学的解析解**\n\n膜电位 $V(t)$ 在发放阈值以下的动力学由以下一阶线性常微分方程（ODE）描述：\n$$C \\frac{dV}{dt} = -g_L (V - E_L) + I(t)$$\n其中 $C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏电反转电位，$I(t)$ 是输入电流。\n\n问题指定输入电流 $I(t)$ 是分段恒定的。在 $I(t)$ 为恒定值 $I$ 的任何时间区间内，我们可以将ODE重新整理为：\n$$ \\frac{dV}{dt} = -\\frac{g_L}{C} (V - E_L) + \\frac{I}{C} $$\n通过定义膜时间常数 $\\tau_m = C/g_L$ 和稳态（或渐近）电位 $V_{\\infty} = E_L + I/g_L$，该方程可简化为：\n$$ \\frac{dV}{dt} = -\\frac{1}{\\tau_m} (V - V_{\\infty}) $$\n这个ODE描述了电位 $V(t)$ 以特征时间常数 $\\tau_m$ 向稳态值 $V_{\\infty}$ 弛豫的过程。\n\n给定初始条件 $(t_0, V(t_0) = V_0)$，我们可以通过分离变量法和积分来求解这个方程：\n$$ \\int_{V_0}^{V(t)} \\frac{dV'}{V' - V_{\\infty}} = -\\int_{t_0}^{t} \\frac{dt'}{\\tau_m} $$\n这得出了在恒定电流段内任意时间 $t \\ge t_0$ 的膜电位精确解：\n$$ V(t) = V_{\\infty} + (V_0 - V_{\\infty}) e^{-(t - t_0)/\\tau_m} $$\n这个方程是我们事件驱动模拟的基础，因为它使我们能够精确地确定未来任何时间的电压，而无需逐步进行数值积分。\n\n**2. 精确尖峰时间计算**\n\n当膜电位 $V(t)$ 从下方达到阈值 $V_{\\mathrm{th}}$ 时，会产生一个尖峰。为了找到尖峰的精确时间 $t_{\\mathrm{spike}}$，我们在上述解中设 $V(t_{\\mathrm{spike}}) = V_{\\mathrm{th}}$ 并求解 $t_{\\mathrm{spike}}$：\n$$ V_{\\mathrm{th}} = V_{\\infty} + (V_0 - V_{\\infty}) e^{-(t_{\\mathrm{spike}} - t_0)/\\tau_m} $$\n求解 $t_{\\mathrm{spike}}$：\n$$ \\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_0 - V_{\\infty}} = e^{-(t_{\\mathrm{spike}} - t_0)/\\tau_m} $$\n$$ t_{\\mathrm{spike}} - t_0 = -\\tau_m \\ln{\\left( \\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_0 - V_{\\infty}} \\right)} $$\n$$ t_{\\mathrm{spike}} = t_0 + \\tau_m \\ln{\\left( \\frac{V_0 - V_{\\infty}}{V_{\\mathrm{th}} - V_{\\infty}} \\right)} $$\n这个方程给出了到下一个尖峰的精确时间（如果会发生的话）。只有当电位向阈值移动时，才可能发生尖峰。假设神经元起始于阈值以下（$V_0  V_{\\mathrm{th}}$），只有当渐近电位高于阈值时，即 $V_{\\infty} > V_{\\mathrm{th}}$，才可能发生尖峰。在这种情况下，$(V_0 - V_{\\infty})$ 和 $(V_{\\mathrm{th}} - V_{\\infty})$ 均为负值，使其比值为正，对数有明确定义。如果 $V_{\\infty} \\le V_{\\mathrm{th}}$，电压将永远不会从下方达到阈值，对数的参数将为非正数，这正确地表明不会发生尖峰。\n\n**3. 事件驱动模拟算法**\n\n模拟通过将时间从一个离散“事件”推进到下一个来进行。系统状态由当前时间 $t$ 和膜电位 $V$ 定义。关键事件是：\n1. 发生一次尖峰。\n2. 输入电流发生变化（即，我们到达了电流段的末端）。\n3. 绝对不应期结束。\n\n该算法实现为一个循环，该循环持续进行，直到模拟时间超过总持续时间。\n\n**初始化：**\n- 当前时间 $t_{\\mathrm{curr}} = 0$。\n- 当前电压 $V_{\\mathrm{curr}} = V_0$。\n- 不应期结束时间 $t_{\\mathrm{ref\\_end}} = -1.0$（或任何小于0的值，表示不在不应期内）。\n- 一个用于存储尖峰时间的列表，`spike_times`。\n\n**主模拟循环（当 $t_{\\mathrm{curr}}$  模拟结束时间时）：**\n\n1.  **处理不应期：**\n    如果 $t_{\\mathrm{curr}}  t_{\\mathrm{ref\\_end}}$，神经元被钳制在 $V_{\\mathrm{reset}}$。下一个事件是不应期结束或当前输入段结束。将时间推进到这个下一个事件：$t_{\\mathrm{next}} = \\min(t_{\\mathrm{ref\\_end}}, t_{\\mathrm{segment\\_end}})$。更新 $t_{\\mathrm{curr}} = t_{\\mathrm{next}}$ 并保持 $V_{\\mathrm{curr}} = V_{\\mathrm{reset}}$。\n\n2.  **处理阈下动力学：**\n    如果神经元不在不应期内：\n    a. 根据 $t_{\\mathrm{curr}}$ 识别当前输入段 $(t_{\\mathrm{start}}, t_{\\mathrm{end}}, I)$。\n    b. 计算特定于段的参数：$\\tau_m = C/g_L$ 和 $V_{\\infty} = E_L + I/g_L$。\n    c. **检查发生尖峰的可能性：**\n        如果 $V_{\\infty} \\le V_{\\mathrm{th}}$，则在此电流下该段内不会发生尖峰。唯一的下一个事件是段的结束，$t_{\\mathrm{end}}$。使用解析解计算段结束时的电压：$V_{\\mathrm{end}} = V_{\\infty} + (V_{\\mathrm{curr}} - V_{\\infty}) \\exp(-(t_{\\mathrm{end}} - t_{\\mathrm{curr}})/\\tau_m)$。更新状态：$t_{\\mathrm{curr}} = t_{\\mathrm{end}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{end}}$。\n    d. **计算潜在的尖峰：**\n        如果 $V_{\\infty} > V_{\\mathrm{th}}$，则可能会发生尖峰。使用第2节中推导的公式，以 $t_0 = t_{\\mathrm{curr}}$ 和 $V_0 = V_{\\mathrm{curr}}$ 计算潜在的尖峰时间 $t_{\\mathrm{spike}}$。\n        - **段内发生尖峰：** 如果 $t_{\\mathrm{spike}} \\le t_{\\mathrm{end}}$，则发生一次尖峰。在 `spike_times` 列表中记录 $t_{\\mathrm{spike}}$。更新系统状态：$t_{\\mathrm{curr}} = t_{\\mathrm{spike}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{reset}}$，并设置不应期结束时间 $t_{\\mathrm{ref\\_end}} = t_{\\mathrm{spike}} + t_{\\mathrm{ref}}$。\n        - **段内无尖峰：** 如果 $t_{\\mathrm{spike}} > t_{\\mathrm{end}}$，神经元的电位演化，但在电流变化前未达到阈值。下一个事件是段的结束，$t_{\\mathrm{end}}$。如步骤2c所示，将电位演化至 $t_{\\mathrm{end}}$。更新状态：$t_{\\mathrm{curr}} = t_{\\mathrm{end}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{end}}$。\n\n这种事件驱动的方法保证了尖峰时间的计算是精确的，并且模拟能够正确地跨段边界传播状态，而不会引入离散化误差。该逻辑能够鲁棒地处理所有情况，包括阈下驱动、超阈值驱动以及在段边界恰好发生尖峰的边界情况（$t_{\\mathrm{spike}} = t_{\\mathrm{end}}$）。实现将对所有计算使用双精度浮点数以保持准确性，并仅对最终输出按要求应用四舍五入到六位小数。",
            "answer": "[[0.007133, 0.019267, 0.0314, 0.043533, 0.055667, 0.0678, 0.079933, 0.092067, 0.1042, 0.116333, 0.128467, 0.1406, 0.152733, 0.164867, 0.177, 0.189133, 0.201267, 0.2134, 0.225533, 0.237667, 0.2498, 0.261933, 0.274067, 0.2862, 0.298333, 0.310467, 0.3226, 0.334733, 0.346867, 0.359, 0.371133, 0.383267, 0.3954, 0.407533, 0.419667, 0.4318, 0.443933, 0.456067, 0.4682, 0.480333, 0.492467], [], [0.063863, 0.082726, 0.101589, 0.120452, 0.139315, 0.158178, 0.177041, 0.195904], [0.05], [0.010217, 0.029079, 0.047942, 0.066805, 0.085668]]"
        }
    ]
}