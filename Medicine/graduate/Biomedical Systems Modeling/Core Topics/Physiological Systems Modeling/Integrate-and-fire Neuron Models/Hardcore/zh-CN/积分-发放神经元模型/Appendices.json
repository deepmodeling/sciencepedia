{
    "hands_on_practices": [
        {
            "introduction": "在处理复杂的生物物理模型时，无量纲化是一种揭示其核心动态的强大技术。通过将方程转换为无量纲形式，我们可以减少参数数量，并以更通用的方式理解系统的行为。本练习  将指导您完成对漏电整合-发放（LIF）模型方程的无量纲化过程，这是理解所有整合-发放模型变体的基础。",
            "id": "3893999",
            "problem": "一个单室神经元由漏电积分-发放（LIF）亚阈值膜方程建模，该方程源自应用于膜电容和漏电支路的 Kirchhoff 电流定律，其形式为 $C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\big(V - E_{L}\\big) + I(t)$。此处，$C_{m}$ 是膜电容，$g_{L}$ 是漏电导，$E_{L}$ 是漏电反转电位，$V(t)$ 是膜电压，$I(t)$ 是随时间变化的输入电流。尖峰生成机制通过一个阈值 $V_{\\text{th}}$ 和一个重置来外部施加，但在本任务中，仅关注连续的亚阈值动力学。\n\n定义膜时间常数 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$。引入无量纲变量 $u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$ 和 $s = \\frac{t}{\\tau_{m}}$，并定义无量纲输入 $\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$，其中应使用依赖关系 $t = \\tau_{m}\\,s$ 将 $\\tilde{I}$ 视为 $s$ 的函数。\n\n从物理 LIF 定律 $C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\big(V - E_{L}\\big) + I(t)$ 和上述定义出发，进行无量纲化，以获得 $u(s)$ 的一阶形式 $\\frac{du}{ds} = F(u,s)$ 的简化动力学。推导右侧函数 $F(u,s)$ 的闭式表达式，该表达式仅用 $u$ 和 $\\tilde{I}(s)$ 表示，不保留任何有量纲的参数。\n\n您的最终答案必须是 $F(u,s)$ 的单个解析表达式（不要写成方程），不需要单位。不需要进行数值取整。",
            "solution": "该问题是有效的。这是一个适定、有科学依据的练习，内容是对一个标准生物物理模型——漏电积分-发放神经元模型——进行无量纲化。所有定义都清晰、一致，并足以执行所需的推导。\n\n分析从所提供的亚阈值膜动力学开始：\n$$C_{m}\\,\\frac{dV}{dt} = -g_{L}\\,\\left(V - E_{L}\\right) + I(t)$$\n目标是使用指定的变量替换，将此方程转换为无量纲形式 $\\frac{du}{ds} = F(u,s)$。\n\n无量纲变量定义如下：\n1. 无量纲电压：$u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$\n2. 无量纲时间：$s = \\frac{t}{\\tau_{m}}$\n3. 无量纲输入电流：$\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$\n\n此外，膜时间常数定义为 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$。\n\n首先，我们必须用新变量 $u$ 和 $s$ 来表示导数 $\\frac{dV}{dt}$。这需要应用链式法则：\n$$\\frac{dV}{dt} = \\frac{dV}{du} \\frac{du}{ds} \\frac{ds}{dt}$$\n我们必须找到右侧三个导数中每一个的表达式。\n\n为了求得 $\\frac{dV}{du}$，我们重新整理 $u$ 的定义，将 $V$ 表示为 $u$ 的函数：\n$$u \\left(V_{\\text{th}} - E_{L}\\right) = V - E_{L}$$\n$$V(u) = u \\left(V_{\\text{th}} - E_{L}\\right) + E_{L}$$\n由于 $V_{\\text{th}}$ 和 $E_{L}$ 是常数，$V$ 对 $u$ 的导数是：\n$$\\frac{dV}{du} = V_{\\text{th}} - E_{L}$$\n\n为了求得 $\\frac{ds}{dt}$，我们使用 $s$ 的定义：\n$$s(t) = \\frac{t}{\\tau_{m}}$$\n$s$ 对 $t$ 的导数是：\n$$\\frac{ds}{dt} = \\frac{1}{\\tau_{m}}$$\n\n现在，我们将这些导数代回链式法则表达式：\n$$\\frac{dV}{dt} = \\left(V_{\\text{th}} - E_{L}\\right) \\frac{du}{ds} \\left(\\frac{1}{\\tau_{m}}\\right) = \\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{du}{ds}$$\n\n接下来，我们将这个 $\\frac{dV}{dt}$ 的表达式代入原始的 LIF 方程：\n$$C_{m} \\left(\\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{du}{ds}\\right) = -g_{L}\\,\\left(V - E_{L}\\right) + I(t)$$\n\n我们的目标是分离出 $\\frac{du}{ds}$，所以我们重新整理方程：\n$$\\frac{du}{ds} = \\frac{\\tau_{m}}{C_{m}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n现在，代入时间常数的定义 $\\tau_{m} = \\frac{C_{m}}{g_{L}}$：\n$$\\frac{du}{ds} = \\frac{C_{m}/g_{L}}{C_{m}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n电容 $C_{m}$ 被消去：\n$$\\frac{du}{ds} = \\frac{1}{g_{L}\\,(V_{\\text{th}} - E_{L})} \\left[-g_{L}\\,\\left(V - E_{L}\\right) + I(t)\\right]$$\n将括号外的项分配进去得到：\n$$\\frac{du}{ds} = -\\frac{g_{L}\\,(V - E_{L})}{g_{L}\\,(V_{\\text{th}} - E_{L})} + \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$$\n右侧第一项中的漏电导 $g_{L}$ 被消去：\n$$\\frac{du}{ds} = -\\frac{V - E_{L}}{V_{\\text{th}} - E_{L}} + \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$$\n\n最后，我们代入无量纲电压 $u$ 和无量纲电流 $\\tilde{I}(s)$ 的定义：\n- 根据定义，第一项是 $u = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$。\n- 根据定义，第二项是 $\\tilde{I}(s) = \\frac{I(t)}{g_{L}\\,(V_{\\text{th}} - E_{L})}$。\n\n代入这些就得到了最终的无量纲方程：\n$$\\frac{du}{ds} = -u + \\tilde{I}(s)$$\n\n问题要求的是 $\\frac{du}{ds} = F(u,s)$ 形式中的函数 $F(u,s)$。通过直接比较，我们确定该函数为：\n$$F(u,s) = -u + \\tilde{I}(s)$$\n该表达式完全由无量纲变量 $u$ 和 $\\tilde{I}(s)$ 表示，所有有量纲的参数都已按要求消除。",
            "answer": "$$\\boxed{-u + \\tilde{I}(s)}$$"
        },
        {
            "introduction": "模型的一个核心预测能力在于它能描述神经元如何将输入电流转化为输出放电率，即频率-电流（F-I）曲线。这个关系是神经元编码信息的基础。在本练习  中，您将从第一性原理出发，推导出在恒定电流输入下LIF模型的稳态放电率，并将理论应用于具体参数的计算。",
            "id": "4049955",
            "problem": "考虑一个由恒定输入电流驱动的单室漏泄整合发放 (Leaky Integrate-and-Fire, LIF) 神经元。膜电压遵循 Kirchhoff 电流定律，结合了电容电流和漏泄电流，得到一阶线性微分方程 $C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$，其中 $C$ 是膜电容，$g_{L}$ 是漏泄电导，$E_{L}$ 是漏泄反转电位，$I_{0}$ 是恒定输入电流。当 $V(t)$ 达到阈值 $V_{\\text{th}}$ 时，会发放一个脉冲，此时电压瞬间重置为 $V_{r}$，并在动力学恢复之前保持该状态一个绝对不应期 $t_{\\text{ref}}$。假设在恒定驱动下，神经元进行重复、稳态的脉冲发放。\n\n仅从上述物理定律和每个周期开始时的初始条件 $V(0)=V_{r}$ 出发，推导稳态发放频率作为恒定电流 $I_{0}$ 和神经元参数的函数的闭式表达式。然后，使用该表达式计算下列参数值下的发放频率：\n- $C=250\\,\\text{pF}$，\n- $g_{L}=12.5\\,\\text{nS}$，\n- $E_{L}=-65\\,\\text{mV}$，\n- $V_{\\text{th}}=-50\\,\\text{mV}$，\n- $V_{r}=-65\\,\\text{mV}$，\n- $I_{0}=0.75\\,\\text{nA}$，\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$。\n\n将最终频率以 $\\text{Hz}$ 为单位表示，并将您的答案四舍五入到四位有效数字。确保推导从给定的微分方程开始，并遵循第一性原理进行，不使用目标公式的快捷方式。",
            "solution": "第一步是求解膜电位 $V(t)$ 的微分方程。给定的方程是：\n$$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$$\n我们可以通过两边同除以 $g_{L}$ 来重新整理这个方程：\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -\\big(V(t)-E_{L}\\big) + \\frac{I_{0}}{g_{L}}$$\n我们定义膜时间常数 $\\tau_{m} = C/g_{L}$ 和稳态电压（或总电流的反转电位）$V_{\\infty} = E_{L} + I_{0}/g_{L}$。将这些代入方程得到：\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L} - \\frac{I_{0}}{g_{L}}) = -(V - V_{\\infty})$$\n这是一个一阶线性常微分方程。我们可以用分离变量法来求解它：\n$$\\frac{dV}{V-V_{\\infty}} = -\\frac{dt}{\\tau_{m}}$$\n我们对这个方程进行积分。电压在时间 $t=0$ 时（该时间点标志着不应期的结束）从重置电位 $V_{r}$ 开始，不断增加，直到在某个我们称之为 $t_{\\text{charge}}$ 的时刻达到阈值 $V_{\\text{th}}$。\n$$\\int_{V_{r}}^{V_{\\text{th}}} \\frac{dV}{V-V_{\\infty}} = \\int_{0}^{t_{\\text{charge}}} -\\frac{dt}{\\tau_{m}}$$\n$$[\\ln|V-V_{\\infty}|]_{V_{r}}^{V_{\\text{th}}} = [-\\frac{t}{\\tau_{m}}]_{0}^{t_{\\text{charge}}}$$\n为了使神经元发放脉冲，稳态电压 $V_{\\infty}$ 必须大于阈值电压 $V_{\\text{th}}$。通常情况下 $V_{\\text{th}} > V_{r}$，因此我们有 $V_{\\infty} > V_{\\text{th}} > V_{r}$。所以，在积分上下限中，$V-V_{\\infty}$ 均为负值，其绝对值为 $V_{\\infty}-V$。\n$$\\ln(V_{\\infty}-V_{\\text{th}}) - \\ln(V_{\\infty}-V_{r}) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n$$\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n求解充电时间 $t_{\\text{charge}}$：\n$$t_{\\text{charge}} = -\\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n这个 $t_{\\text{charge}}$ 的表达式仅当 $V_{\\infty} > V_{\\text{th}}$ 时有效，这等价于条件 $E_{L} + I_{0}/g_{L} > V_{\\text{th}}$，或者 $I_{0} > g_{L}(V_{\\text{th}} - E_{L})$。如果不满足此条件，神经元将永远不会发放脉冲。\n\n一个周期的总时间，即脉冲间期 ($T_{\\text{ISI}}$)，是充电时间 $t_{\\text{charge}}$ 和绝对不应期 $t_{\\text{ref}}$ 的总和。\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = t_{\\text{ref}} + \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n稳态发放频率 $f$ 是脉冲间期的倒数，$f = 1/T_{\\text{ISI}}$。\n代入 $\\tau_{m}$ 和 $V_{\\infty}$ 的表达式：\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{(E_{L} + I_{0}/g_{L}) - V_{r}}{(E_{L} + I_{0}/g_{L}) - V_{\\text{th}}}\\right)\\right]^{-1}$$\n这就是发放频率的闭式表达式。通过重新整理对数内的项，可以将其改写为：\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{I_{0} + g_{L}(E_{L} - V_{r})}{I_{0} + g_{L}(E_{L} - V_{\\text{th}})}\\right)\\right]^{-1}$$\n\n现在，我们使用给定的参数计算数值。首先，我们将所有参数转换为国际单位制 (SI) 的基本单位：\n- $C=250\\,\\text{pF} = 250 \\times 10^{-12}\\,\\text{F}$\n- $g_{L}=12.5\\,\\text{nS} = 12.5 \\times 10^{-9}\\,\\text{S}$\n- $E_{L}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $V_{\\text{th}}=-50\\,\\text{mV} = -0.050\\,\\text{V}$\n- $V_{r}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $I_{0}=0.75\\,\\text{nA} = 0.75 \\times 10^{-9}\\,\\text{A}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms} = 1.5 \\times 10^{-3}\\,\\text{s}$\n\n我们计算中间值 $\\tau_m$ 和 $V_{\\infty}$：\n$$\\tau_{m} = \\frac{C}{g_{L}} = \\frac{250 \\times 10^{-12}\\,\\text{F}}{12.5 \\times 10^{-9}\\,\\text{S}} = 20 \\times 10^{-3}\\,\\text{s} = 0.02\\,\\text{s}$$\n$$V_{\\infty} = E_{L} + \\frac{I_{0}}{g_{L}} = -0.065\\,\\text{V} + \\frac{0.75 \\times 10^{-9}\\,\\text{A}}{12.5 \\times 10^{-9}\\,\\text{S}} = -0.065\\,\\text{V} + 0.06\\,\\text{V} = -0.005\\,\\text{V}$$\n\n我们来检查发放条件：$V_{\\infty} > V_{\\text{th}}$ 是否成立？\n$-0.005\\,\\text{V} > -0.050\\,\\text{V}$。条件满足，因此神经元会发放脉冲。\n\n现在，我们计算 $t_{\\text{charge}}$。注意，由于 $V_r = E_L$，在更通用的推导公式中，$g_L(E_L - V_r)$ 项为零。\n$$t_{\\text{charge}} = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{-0.005\\,\\text{V} - (-0.065\\,\\text{V})}{-0.005\\,\\text{V} - (-0.050\\,\\text{V})}\\right)$$\n$$t_{\\text{charge}} = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{0.060\\,\\text{V}}{0.045\\,\\text{V}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\n使用 $\\ln(4/3) \\approx 0.287682$ 的值：\n$$t_{\\text{charge}} \\approx 0.02 \\times 0.287682\\,\\text{s} \\approx 0.00575364\\,\\text{s}$$\n接下来，我们计算总的脉冲间期 $T_{\\text{ISI}}$：\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = 1.5 \\times 10^{-3}\\,\\text{s} + 0.00575364\\,\\text{s} = 0.0015\\,\\text{s} + 0.00575364\\,\\text{s} = 0.00725364\\,\\text{s}$$\n最后，我们计算发放频率 $f$：\n$$f = \\frac{1}{T_{\\text{ISI}}} = \\frac{1}{0.00725364\\,\\text{s}} \\approx 137.862\\,\\text{Hz}$$\n将结果四舍五入到四位有效数字，得到 $137.9\\,\\text{Hz}$。",
            "answer": "$$\\boxed{137.9}$$"
        },
        {
            "introduction": "理论分析之后，计算模拟是探索神经元和网络行为不可或缺的工具。与基于固定时间步长的近似方法不同，事件驱动模拟能够精确地计算发放时间，避免数值误差。本练习  是一项综合性实践，要求您设计并实现一个事件驱动的LIF神经元模拟器，这是构建大规模、高精度神经网络模型的一项关键技能。",
            "id": "3893993",
            "problem": "您的任务是设计并实现一种用于漏积分放电 (LIF) 神经元的事件驱动模拟算法，该算法需适用于高级研究生水平的生物医学系统建模。该算法必须精确积分阈下动力学，并在正确的物理时间检测到阈值穿越，以避免数值时间步长误差。模型和所有必需的组件在下文中有详细说明，并附有一套测试组，以验证您实现的正确性和边缘情况的鲁棒性。\n\n漏积分放电神经元的阈下动力学遵循电容-漏电方程，这是经典生物物理膜模型的核心要素。其基本原理是膜电容电流等于漏电流与输入电流之和：$$C \\frac{dV}{dt} = -g_L (V - E_L) + I(t),$$ 其中 $C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏反转（静息）电位，$V(t)$ 是膜电位，$I(t)$ 是外部施加的电流。当 $V(t)$ 从下方达到阈值 $V_{\\mathrm{th}}$ 时，定义为发生一次脉冲。脉冲发生后，膜电位瞬时重置为 $V_{\\mathrm{reset}}$，并强制执行一个持续时间为 $t_{\\mathrm{ref}}$ 的绝对不应期，在此期间膜电位被钳制在 $V_{\\mathrm{reset}}$，且不能发生脉冲。\n\n您的事件驱动模拟必须依赖于对 $I(t)$ 的分段恒定段进行精确的闭式积分，并具有精确的阈值穿越时间。假设 $I(t)$ 在指定的时间间隔内是分段恒定的。您必须正确处理以下情况：\n- 每个恒定电流段内的阈下演化。\n- 在一个段内精确检测阈值穿越（包括恰好在段边界发生的穿越）。\n- 重置和绝对不应期，在此期间 $V(t)$ 被钳制在 $V_{\\mathrm{reset}}$。\n- 跨段边界的连续传播，无时间步长离散化误差。\n\n所有变量必须采用国际单位制 (SI)。具体来说，$V$ 以伏特为单位，$C$ 以法拉为单位，$g_L$ 以西门子为单位，$I$ 以安培为单位，时间以秒为单位。最终输出必须以秒为单位报告脉冲时间。\n\n您的程序必须实现事件驱动算法，并计算以下五个测试用例的脉冲时间。在每个用例中，输入电流 $I(t)$ 通过覆盖整个模拟持续时间的非重叠、连续的段 $(t_{\\mathrm{start}}, t_{\\mathrm{end}}, I)$ 来指定。参数如下：\n- 膜电容 $C$，\n- 漏电导 $g_L$，\n- 漏反转电位 $E_L$，\n- 阈值 $V_{\\mathrm{th}}$，\n- 重置电位 $V_{\\mathrm{reset}}$，\n- 绝对不应期持续时间 $t_{\\mathrm{ref}}$，\n- $t=0$ 时的初始膜电位 $V_0$。\n\n测试组（所有量均采用国际单位制）：\n1. 恒定超阈值驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$，\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$，\n   - $E_L = -0.065 \\text{ V}$，\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$，\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$，\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$，\n   - $V_0 = -0.065 \\text{ V}$，\n   - 段：$(0.0, 0.5, 5.0 \\times 10^{-10} \\text{ A})$。\n2. 恒定阈下驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$，\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$，\n   - $E_L = -0.065 \\text{ V}$，\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$，\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$，\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$，\n   - $V_0 = -0.065 \\text{ V}$，\n   - 段：$(0.0, 0.5, 1.0 \\times 10^{-10} \\text{ A})$。\n3. 阶跃电流：静息，然后活动，然后静息：\n   - $C = 200 \\times 10^{-12} \\text{ F}$，\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$，\n   - $E_L = -0.065 \\text{ V}$，\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$，\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$，\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$，\n   - $V_0 = -0.065 \\text{ V}$，\n   - 段：$(0.0, 0.05, 0.0 \\text{ A}), (0.05, 0.2, 3.0 \\times 10^{-10} \\text{ A}), (0.2, 0.5, 0.0 \\text{ A})$。\n4. 边界穿越情况（阈值在段的精确末端）：\n   - $C = 200 \\times 10^{-12} \\text{ F}$，\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$，\n   - $E_L = -0.065 \\text{ V}$，\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$，\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$，\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$，\n   - $V_0 = -0.065 \\text{ V}$，\n   - 段：$(0.0, 0.05, 1.6345909609556877 \\times 10^{-10} \\text{ A})$。\n5. 不同初始条件下的超阈值恒定驱动：\n   - $C = 200 \\times 10^{-12} \\text{ F}$，\n   - $g_L = 10 \\times 10^{-9} \\text{ S}$，\n   - $E_L = -0.065 \\text{ V}$，\n   - $V_{\\mathrm{th}} = -0.050 \\text{ V}$，\n   - $V_{\\mathrm{reset}} = -0.065 \\text{ V}$，\n   - $t_{\\mathrm{ref}} = 0.005 \\text{ s}$，\n   - $V_0 = -0.060 \\text{ V}$，\n   - 段：$(0.0, 0.1, 3.0 \\times 10^{-10} \\text{ A})$。\n\n您的程序必须使用精确检测逻辑计算每个用例的脉冲时间，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个Python风格的浮点数列表，表示以秒为单位的脉冲时间，并四舍五入到六位小数。例如，您的最终输出应类似于单行上的 $$[ [t_{1,1}, t_{1,2}, \\dots], [t_{2,1}, \\dots], \\dots ]$$，其中每个 $t_{i,j}$ 是一个四舍五入到六位小数的以秒为单位的浮点数。不应打印任何其他文本。\n\n您的算法必须是事件驱动的，并且必须避免使用时间步长方法。您的实现必须对边缘情况具有鲁棒性，包括在段内没有脉冲发生时、渐进电位低于阈值时，以及在段边界上精确达到阈值时。所有计算和输出必须按规定使用秒、伏特、西门子、法拉和安培。将所有最终脉冲时间以秒表示，并四舍五入到六位小数。最终输出必须是格式为 $[result_1, result_2, result_3, result_4, result_5]$ 的单行，其中每个 $result_i$ 是一个四舍五入的浮点数列表。",
            "solution": "该问题要求为漏积分放电 (LIF) 神经元模型设计并实现一种事件驱动的模拟算法。该算法必须是精确的，通过利用模型控制微分方程在分段恒定输入电流下的解析解来避免数值离散化。\n\n**1. 阈下动力学的解析解**\n\n膜电位 $V(t)$ 在放电阈值以下的动力学由以下一阶线性常微分方程 (ODE) 描述：\n$$C \\frac{dV}{dt} = -g_L (V - E_L) + I(t)$$\n其中 $C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏反转电位，$I(t)$ 是输入电流。\n\n问题指定输入电流 $I(t)$ 是分段恒定的。在 $I(t)$ 为恒定值 $I$ 的任何时间间隔内，我们可以将 ODE 重新排列为：\n$$ \\frac{dV}{dt} = -\\frac{g_L}{C} (V - E_L) + \\frac{I}{C} $$\n通过定义膜时间常数 $\\tau_m = C/g_L$ 和稳态（或渐进）电位 $V_{\\infty} = E_L + I/g_L$，方程简化为：\n$$ \\frac{dV}{dt} = -\\frac{1}{\\tau_m} (V - V_{\\infty}) $$\n这个 ODE 描述了电位 $V(t)$ 以特征时间常数 $\\tau_m$ 向稳态值 $V_{\\infty}$ 松弛的过程。\n\n给定初始条件 $(t_0, V(t_0) = V_0)$，我们可以通过分离变量和积分来求解此方程：\n$$ \\int_{V_0}^{V(t)} \\frac{dV'}{V' - V_{\\infty}} = -\\int_{t_0}^{t} \\frac{dt'}{\\tau_m} $$\n这得到了在恒定电流段内任意时间 $t \\ge t_0$ 时膜电位的精确解：\n$$ V(t) = V_{\\infty} + (V_0 - V_{\\infty}) e^{-(t - t_0)/\\tau_m} $$\n该方程是我们事件驱动模拟的基础，因为它使我们能够精确地确定未来任何时间的电压，而无需进行数值步进积分。\n\n**2. 精确脉冲时间的计算**\n\n当膜电位 $V(t)$ 从下方达到阈值 $V_{\\mathrm{th}}$ 时，产生一个脉冲。为了找到脉冲的精确时间 $t_{\\mathrm{spike}}$，我们将上述解中的 $V(t_{\\mathrm{spike}})$ 设置为 $V_{\\mathrm{th}}$ 并求解 $t_{\\mathrm{spike}}$：\n$$ V_{\\mathrm{th}} = V_{\\infty} + (V_0 - V_{\\infty}) e^{-(t_{\\mathrm{spike}} - t_0)/\\tau_m} $$\n求解 $t_{\\mathrm{spike}}$：\n$$ \\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_0 - V_{\\infty}} = e^{-(t_{\\mathrm{spike}} - t_0)/\\tau_m} $$\n$$ t_{\\mathrm{spike}} - t_0 = -\\tau_m \\ln{\\left( \\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_0 - V_{\\infty}} \\right)} $$\n$$ t_{\\mathrm{spike}} = t_0 + \\tau_m \\ln{\\left( \\frac{V_0 - V_{\\infty}}{V_{\\mathrm{th}} - V_{\\infty}} \\right)} $$\n这个方程给出了到下一次脉冲的精确时间，前提是会发生脉冲。只有当电位向阈值移动时才可能发生脉冲。假设神经元起始于阈值以下 ($V_0  V_{\\mathrm{th}}$)，只有当渐进电位高于阈值时，即 $V_{\\infty} > V_{\\mathrm{th}}$，才可能发生脉冲。在这种情况下，$(V_0 - V_{\\infty})$ 和 $(V_{\\mathrm{th}} - V_{\\infty})$ 均为负值，使其比值为正，对数函数有明确定义。如果 $V_{\\infty} \\le V_{\\mathrm{th}}$，电压将永远不会从下方达到阈值，对数的参数将为非正数，这正确地表明不会发生脉冲。\n\n**3. 事件驱动模拟算法**\n\n模拟通过将时间从一个离散“事件”推进到下一个来进行。系统的状态由当前时间 $t$ 和膜电位 $V$ 定义。关键事件是：\n1. 发生一次脉冲。\n2. 输入电流改变（即，我们到达了当前段的末尾）。\n3. 绝对不应期结束。\n\n该算法实现为一个循环，持续到模拟时间超过总持续时间。\n\n**初始化：**\n- 当前时间 $t_{\\mathrm{curr}} = 0$。\n- 当前电压 $V_{\\mathrm{curr}} = V_0$。\n- 不应期结束时间 $t_{\\mathrm{ref\\_end}} = -1.0$（或任何  0 的值，表示不处于不应期）。\n- 一个用于存储脉冲时间的列表，`spike_times`。\n\n**主模拟循环（当 $t_{\\mathrm{curr}}$  模拟结束时间时）：**\n\n1.  **处理不应期：**\n    如果 $t_{\\mathrm{curr}}  t_{\\mathrm{ref\\_end}}$，神经元被钳制在 $V_{\\mathrm{reset}}$。下一个事件是不应期的结束或当前输入段的结束。将时间推进到这个下一个事件：$t_{\\mathrm{next}} = \\min(t_{\\mathrm{ref\\_end}}, t_{\\mathrm{segment\\_end}})$。更新 $t_{\\mathrm{curr}} = t_{\\mathrm{next}}$ 并保持 $V_{\\mathrm{curr}} = V_{\\mathrm{reset}}$。\n\n2.  **处理阈下动力学：**\n    如果神经元不处于不应期：\n    a. 根据 $t_{\\mathrm{curr}}$ 确定当前的输入段 $(t_{\\mathrm{start}}, t_{\\mathrm{end}}, I)$。\n    b. 计算段特定参数：$\\tau_m = C/g_L$ 和 $V_{\\infty} = E_L + I/g_L$。\n    c. **检查脉冲可能性：**\n        如果 $V_{\\infty} \\le V_{\\mathrm{th}}$，在此段内使用此电流不会发生脉冲。唯一的下一个事件是段的结束，$t_{\\mathrm{end}}$。使用解析解计算段结束时的电压：$V_{\\mathrm{end}} = V_{\\infty} + (V_{\\mathrm{curr}} - V_{\\infty}) \\exp(-(t_{\\mathrm{end}} - t_{\\mathrm{curr}})/\\tau_m)$。更新状态：$t_{\\mathrm{curr}} = t_{\\mathrm{end}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{end}}$。\n    d. **计算潜在脉冲：**\n        如果 $V_{\\infty} > V_{\\mathrm{th}}$，可能会发生脉冲。使用第2节中推导的公式计算潜在的脉冲时间 $t_{\\mathrm{spike}}$，其中 $t_0 = t_{\\mathrm{curr}}$ 和 $V_0 = V_{\\mathrm{curr}}$。\n        - **段内脉冲：** 如果 $t_{\\mathrm{spike}} \\le t_{\\mathrm{end}}$，则发生一次脉冲。在 `spike_times` 列表中记录 $t_{\\mathrm{spike}}$。更新系统状态：$t_{\\mathrm{curr}} = t_{\\mathrm{spike}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{reset}}$，并设置不应期结束时间 $t_{\\mathrm{ref\\_end}} = t_{\\mathrm{spike}} + t_{\\mathrm{ref}}$。\n        - **段内无脉冲：** 如果 $t_{\\mathrm{spike}} > t_{\\mathrm{end}}$，神经元的电位演化但未在电流改变前达到阈值。下一个事件是段结束，$t_{\\mathrm{end}}$。将电位演化到 $t_{\\mathrm{end}}$，如步骤 2c 中所述。更新状态：$t_{\\mathrm{curr}} = t_{\\mathrm{end}}$，$V_{\\mathrm{curr}} = V_{\\mathrm{end}}$。\n\n这种事件驱动的方法保证了脉冲时间的精确计算，并且模拟能够正确地跨段边界传播状态，而不会引入离散化误差。该逻辑稳健地处理所有情况，包括阈下驱动、超阈值驱动，以及脉冲恰好在段边界发生的边缘情况 ($t_{\\mathrm{spike}} = t_{\\mathrm{end}}$)。实现将对所有计算使用双精度浮点数以保持准确性，仅在最终输出时按规定四舍五入到六位小数。",
            "answer": "[[0.007134, 0.019267, 0.0314, 0.043533, 0.055666, 0.0678, 0.079933, 0.092066, 0.104199, 0.116333, 0.128466, 0.140599, 0.152733, 0.164866, 0.176999, 0.189132, 0.201266, 0.213399, 0.225532, 0.237665, 0.249799, 0.261932, 0.274065, 0.286198, 0.298332, 0.310465, 0.322598, 0.334731, 0.346865, 0.358998, 0.371131, 0.383264, 0.395398, 0.407531, 0.419664, 0.431797, 0.443931, 0.456064, 0.468197, 0.48033, 0.492464],[],[0.063863, 0.082726, 0.101589, 0.120452, 0.139315, 0.158178, 0.177041, 0.195904],[0.05],[0.010217, 0.02908, 0.047943, 0.066806, 0.085669]]"
        }
    ]
}