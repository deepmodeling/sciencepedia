{
    "hands_on_practices": [
        {
            "introduction": "任何动态模型的分析都始于理解其平衡或稳态。此练习提供了确定系统平衡点的基础实践，在该点上调节力达到平衡。通过将变化率设为零，我们可以求解系统的基线工作状态，这是进行任何进一步动态分析的第一步 。",
            "id": "3925078",
            "problem": "在肾脏自身调节中，入球小动脉阻力（表示为 $R_{a}$）通过管球反馈 (TGF) 进行调节，以稳定肾小球滤过。考虑一个简化的集总参数模型，其中致密斑将血管调节介质 $N$ 转导为收缩驱动的过程由一个抑制性希尔函数 $f(N)$ 描述，而对收缩驱动的小动脉机械响应则由一个线性映射 $g(R_{a})$ 进行局部近似。具体来说，假设\n$$f(N) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}$$\n其中 $k>0$，$N_{50}>0$，$h>0$，并且\n$$g(R_{a}) = \\beta \\left(R_{a} - R_{a0}\\right)$$\n其中 $\\beta>0$，$R_{a0}>0$，$R_{a0}$ 是基础入球小动脉阻力。假设闭环动力学是一阶的，由下式给出\n$$\\frac{dR_{a}}{dt} = \\gamma \\left[f(N) - g(R_{a})\\right],$$\n其中 $\\gamma>0$，反映了对转导和机械响应之间平衡的一种比例响应。\n\n仅使用稳态原理（即在平衡状态下时间导数为零），推导平衡入球小动脉阻力 $R_{a}^{*}$ 关于 $N$、$k$、$N_{50}$、$h$、$\\beta$ 和 $R_{a0}$ 的表达式。然后，使用参数值 $N = 200\\,\\mathrm{nM}$、$k = 9\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$、$N_{50} = 300\\,\\mathrm{nM}$、$h = 3$、$\\beta = 0.45$（无量纲）和 $R_{a0} = 8\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$ 对 $R_{a}^{*}$ 进行数值计算。以 $\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$ 为单位表示最终阻力，并将您的答案四舍五入到四位有效数字。在首次使用时定义所有缩略语，包括管球反馈 (Tubuloglomerular Feedback, TGF) 以及可能提及的一氧化氮 (Nitric Oxide, NO)。",
            "solution": "该问题要求基于一个简化的肾脏自身调节一阶模型，推导平衡入球小动脉阻力 $R_{a}^{*}$，并对其进行数值计算。该调节由管球反馈 (Tubuloglomerular Feedback, TGF) 介导，这是稳定肾小球血液动力学的关键机制。\n\n该动力学系统由以下一阶常微分方程描述：\n$$\n\\frac{dR_{a}}{dt} = \\gamma \\left[f(N) - g(R_{a})\\right]\n$$\n其中 $\\gamma > 0$ 是一个速率常数。函数 $f(N)$ 代表来自致密斑的收缩驱动，由一个抑制性希尔函数给出：\n$$\nf(N) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\n函数 $g(R_{a})$ 代表小动脉的机械响应，建模为一个线性映射：\n$$\ng(R_{a}) = \\beta \\left(R_{a} - R_{a0}\\right)\n$$\n这里，$k$、$N_{50}$、$h$、$\\beta$ 和 $R_{a0}$ 均为正常数。\n\n为了求得平衡入球小动脉阻力，记为 $R_{a}^{*}$，我们应用稳态原理。在平衡状态下，系统的状态变量不随时间变化。因此，阻力的时间导数必须为零：\n$$\n\\frac{dR_{a}}{dt} = 0\n$$\n将此条件代入动力学方程，得到：\n$$\n\\gamma \\left[f(N) - g(R_{a}^{*})\\right] = 0\n$$\n由于问题说明 $\\gamma > 0$，为了使方程成立，方括号中的项必须为零：\n$$\nf(N) - g(R_{a}^{*}) = 0\n$$\n这意味着在平衡状态下，收缩驱动与机械响应完全平衡：\n$$\ng(R_{a}^{*}) = f(N)\n$$\n现在，我们将函数 $f(N)$ 和 $g(R_{a})$ 的具体形式代入这个平衡条件：\n$$\n\\beta \\left(R_{a}^{*} - R_{a0}\\right) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\n我们的目标是解出这个代数方程中的 $R_{a}^{*}$。我们可以按以下代数步骤进行。首先，两边同除以 $\\beta$（因为 $\\beta > 0$）：\n$$\nR_{a}^{*} - R_{a0} = \\frac{1}{\\beta} \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\n接下来，通过在方程两边加上基础阻力 $R_{a0}$ 来分离 $R_{a}^{*}$：\n$$\nR_{a}^{*} = R_{a0} + \\frac{k}{\\beta \\left[1 + \\left(\\frac{N}{N_{50}}\\right)^{h}\\right]}\n$$\n这就是平衡入球小动脉阻力 $R_{a}^{*}$ 关于给定参数的符号表达式。\n\n任务的第二部分是使用提供的参数值对 $R_{a}^{*}$ 进行数值计算：\n$N = 200\\,\\mathrm{nM}$\n$k = 9\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$\n$N_{50} = 300\\,\\mathrm{nM}$\n$h = 3$\n$\\beta = 0.45$ (无量纲)\n$R_{a0} = 8\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$\n\n我们将这些值代入推导出的 $R_{a}^{*}$ 表达式中。首先，计算希尔函数中的项：\n$$\n\\frac{N}{N_{50}} = \\frac{200}{300} = \\frac{2}{3}\n$$\n接下来，我们将此比率提升到希尔系数 $h=3$ 的幂：\n$$\n\\left(\\frac{N}{N_{50}}\\right)^{h} = \\left(\\frac{2}{3}\\right)^{3} = \\frac{2^3}{3^3} = \\frac{8}{27}\n$$\n现在，我们可以计算分数项的分母：\n$$\n1 + \\left(\\frac{N}{N_{50}}\\right)^{h} = 1 + \\frac{8}{27} = \\frac{27}{27} + \\frac{8}{27} = \\frac{35}{27}\n$$\n让我们将此结果代回 $R_{a}^{*}$ 的表达式中：\n$$\nR_{a}^{*} = R_{a0} + \\frac{k}{\\beta \\left(\\frac{35}{27}\\right)}\n$$\n代入 $R_{a0}$、$k$ 和 $\\beta$ 的值：\n$$\nR_{a}^{*} = 8 + \\frac{9}{0.45 \\left(\\frac{35}{27}\\right)}\n$$\n我们可以简化分母。注意 $0.45 = \\frac{45}{100} = \\frac{9}{20}$。\n$$\n0.45 \\left(\\frac{35}{27}\\right) = \\frac{9}{20} \\times \\frac{35}{27} = \\frac{1}{20} \\times \\frac{35}{3} = \\frac{35}{60} = \\frac{7}{12}\n$$\n所以，分数项变为：\n$$\n\\frac{9}{\\frac{7}{12}} = 9 \\times \\frac{12}{7} = \\frac{108}{7}\n$$\n最后，我们将 $R_{a0}$ 加到这个结果上：\n$$\nR_{a}^{*} = 8 + \\frac{108}{7}\n$$\n为了合并这些项，我们找到一个公分母：\n$$\nR_{a}^{*} = \\frac{8 \\times 7}{7} + \\frac{108}{7} = \\frac{56 + 108}{7} = \\frac{164}{7}\n$$\n现在我们计算数值并按要求四舍五入到四位有效数字。\n$$\nR_{a}^{*} = \\frac{164}{7} \\approx 23.4285714...\n$$\n四舍五入到四位有效数字得到 $23.43$。阻力的单位是 $\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$，这与 $R_{a0}$ 以及我们加到它上面的项的单位一致。",
            "answer": "$$\\boxed{23.43}$$"
        },
        {
            "introduction": "真实的生理系统是高度非线性的，但它们在工作点附近的行为通常可以通过线性模型来近似。此练习介绍了小信号线性化这一关键技术，用以推导传递函数，该函数描述了系统的动态输入-输出关系。计算低频增益使我们能够量化自动调节机制在缓冲持续性动脉压力变化方面的有效性 。",
            "id": "3925106",
            "problem": "考虑一个肾血流量（RBF）自动调节的集总参数模型，在该模型中，入球小动脉阻力对感受到的肾小管流量做出动态响应。肾血管系统由一个入球小动脉阻力 $R_a$ 与一个下游阻力 $R_d$（代表肾小球后段和静脉段）串联表示。动脉压为 $P_a$，静脉压为 $P_v$（视为恒定）。体积流量 $Q$ 满足血流动力学关系，即流量等于压降除以总阻力。入球小动脉阻力根据一阶松弛过程向由管球反馈设定的非线性目标演化。具体而言，控制方程为\n$$\nQ \\;=\\; \\frac{P_a - P_v}{R_a + R_d},\n$$\n$$\n\\frac{d R_a}{dt} \\;=\\; \\frac{1}{\\tau}\\Big(R_a^{\\ast}(Q) - R_a\\Big),\n$$\n$$\nR_a^{\\ast}(Q) \\;=\\; R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big],\n$$\n其中 $R_{a0} > 0$ 是工作点处的稳态入球阻力，$Q_0 > 0$ 是稳态流量，$\\tau > 0$ 是阻力适应时间常数，$\\alpha > 0$ 和 $\\beta > 0$ 表征了管球反馈的灵敏度和饱和度。假设系统在满足 $Q_0 = (P_{a0} - P_v)/(R_{a0} + R_d)$ 和 $R_a^{\\ast}(Q_0) = R_{a0}$ 的平衡点 $(P_{a0}, Q_0, R_{a0})$ 附近进行线性化。\n\n从这些方程出发，将 $P_a$ 视为输入，在平衡点周围进行小信号线性化，以获得从动脉压扰动到流量扰动的传递函数 $G(s)$，即 $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$，其中波浪号表示与平衡点的小偏差。然后，计算闭式形式的低频增益 $G(0)$。\n\n使用符号 $R_{a0}$、$R_d$、$Q_0$、$\\alpha$ 和 $\\beta$ 以解析形式表示低频增益。量 $G(0)$ 的物理单位是体积/时间/压力；如果您之后选择对表达式进行数值计算，请以 $\\mathrm{mL}\\,\\mathrm{s}^{-1}\\,\\mathrm{mmHg}^{-1}$ 为单位表示增益。不要在带框的最终答案中包含单位。",
            "solution": "该问题要求推导肾脏自动调节线性化模型的低频增益。系统的行为由一组耦合的代数和微分方程描述。这个过程包括：围绕指定的平衡点对这些方程进行线性化，推导从动脉压到肾血流量的传递函数，然后评估该传递函数在零频率处的值。\n\n首先，我们用变量 $(P_{a0}, Q_0, R_{a0})$ 定义系统的平衡状态。围绕该平衡点的扰动定义为：\n$P_a(t) = P_{a0} + \\tilde{P}_a(t)$\n$Q(t) = Q_0 + \\tilde{Q}(t)$\n$R_a(t) = R_{a0} + \\tilde{R}_a(t)$\n\n给定的方程是：\n1. 血流动力学：$Q = \\frac{P_a - P_v}{R_a + R_d}$\n2. 阻力动力学：$\\frac{dR_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q) - R_a\\Big)$\n3. 反馈函数：$R_a^{\\ast}(Q) = R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big]$\n\n平衡由条件 $Q_0 = \\frac{P_{a0} - P_v}{R_{a0} + R_d}$ 和 $R_a^{\\ast}(Q_0) = R_{a0}$ 定义。\n\n我们通过对每个方程进行小扰动线性化来继续。\n\n**血流动力学方程的线性化**\n\n我们在平衡点附近对方程 $Q = \\frac{P_a - P_v}{R_a + R_d}$ 进行线性化。我们可以对 $Q(P_a, R_a)$ 使用一阶多元泰勒级数展开：\n$\\tilde{Q} \\approx \\frac{\\partial Q}{\\partial P_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{P}_a + \\frac{\\partial Q}{\\partial R_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{R}_a$\n\n偏导数是：\n$\\frac{\\partial Q}{\\partial P_a} = \\frac{1}{R_a + R_d}$。在平衡点，此值为 $\\frac{1}{R_{a0} + R_d}$。\n$\\frac{\\partial Q}{\\partial R_a} = -\\frac{P_a - P_v}{(R_a + R_d)^2} = -\\frac{Q}{R_a + R_d}$。在平衡点，此值为 $-\\frac{Q_0}{R_{a0} + R_d}$。\n\n将这些代入泰勒展开式，得到第一个线性化方程：\n$$\n\\tilde{Q} = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a\n$$\n\n**阻力动力学方程的线性化**\n\n我们将扰动变量代入微分方程：\n$\\frac{d(R_{a0} + \\tilde{R}_a)}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - (R_{a0} + \\tilde{R}_a)\\Big)$\n由于 $R_{a0}$ 是一个常数，其导数为零：\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\n\n接下来，我们在 $Q_0$ 附近对反馈函数 $R_a^{\\ast}(Q)$ 进行线性化：\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_a^{\\ast}(Q_0) + \\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} \\tilde{Q}$\n从问题陈述中我们知道 $R_a^{\\ast}(Q_0) = R_{a0}$。我们计算导数：\n$\\frac{dR_a^{\\ast}}{dQ} = R_{a0} \\frac{d}{dQ} \\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big] = R_{a0} \\alpha \\beta \\text{sech}^2\\big(\\beta(Q - Q_0)\\big)$\n在 $Q=Q_0$ 处求值：\n$\\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} = R_{a0} \\alpha \\beta \\text{sech}^2(0) = R_{a0} \\alpha \\beta$\n我们定义反馈增益 $K_{TGF} = R_{a0} \\alpha \\beta$。\n线性化的反馈函数是：\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_{a0} + K_{TGF} \\tilde{Q}$\n\n将此代入 $\\tilde{R}_a$ 的动态方程：\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big((R_{a0} + K_{TGF} \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\n这可以简化为第二个线性化方程：\n$$\n\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q} - \\tilde{R}_a)\n$$\n\n**传递函数的推导**\n\n为了求得传递函数 $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$，我们对两个线性化方程应用拉普拉斯变换，并假设扰动的初始条件为零。令 $\\tilde{Q}(s)$、$\\tilde{P}_a(s)$ 和 $\\tilde{R}_a(s)$ 分别为 $\\tilde{Q}(t)$、$\\tilde{P}_a(t)$ 和 $\\tilde{R}_a(t)$ 的拉普拉斯变换。\n\n变换后的方程是：\n1. $\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a(s)$\n2. $s \\tilde{R}_a(s) = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q}(s) - \\tilde{R}_a(s))$\n\n从方程(2)中，我们求解 $\\tilde{R}_a(s)$ 关于 $\\tilde{Q}(s)$ 的表达式：\n$s \\tilde{R}_a(s) + \\frac{1}{\\tau} \\tilde{R}_a(s) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) \\left(s + \\frac{1}{\\tau}\\right) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) = \\frac{K_{TGF}/\\tau}{s + 1/\\tau} \\tilde{Q}(s) = \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s)$\n\n现在我们将 $\\tilde{R}_a(s)$ 的这个表达式代入方程(1)：\n$\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\left( \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s) \\right)$\n\n我们将含有 $\\tilde{Q}(s)$ 的项组合在一起：\n$\\tilde{Q}(s) \\left[ 1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)} \\right] = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s)$\n\n现在我们求解传递函数 $G(s) = \\frac{\\tilde{Q}(s)}{\\tilde{P}_a(s)}$：\n$G(s) = \\frac{\\frac{1}{R_{a0} + R_d}}{1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)}}$\n为了简化，我们将分子和分母同乘以 $(R_{a0} + R_d)(1 + \\tau s)$：\n$G(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 K_{TGF}}$\n\n将 $K_{TGF} = R_{a0} \\alpha \\beta$ 代回：\n$$\nG(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 R_{a0} \\alpha \\beta}\n$$\n\n**低频增益的计算**\n\n低频增益，记为 $G(0)$，是传递函数在 $s=0$ 处的值。这代表了输出（流量扰动）对输入（压力扰动）阶跃变化的稳态响应。\n我们在 $G(s)$ 的表达式中令 $s=0$：\n$G(0) = \\frac{1 + \\tau(0)}{(R_{a0} + R_d)(1 + \\tau(0)) + Q_0 R_{a0} \\alpha \\beta}$\n$G(0) = \\frac{1}{(R_{a0} + R_d)(1) + Q_0 R_{a0} \\alpha \\beta}$\n\n低频增益的最终表达式为：\n$$\nG(0) = \\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}\n$$\n该表达式符合要求的解析形式，使用了指定的符号。分母表示在稳态下，存在管球反馈时血管系统的总有效阻力。项 $Q_0 R_{a0} \\alpha \\beta$ 反映了由主动反馈机制贡献的额外“阻力”，该机制起到稳定流量的作用。",
            "answer": "$$\n\\boxed{\\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}}\n$$"
        },
        {
            "introduction": "反馈回路功能强大，但生物信号传导中固有的时间延迟可能会引入不稳定性，导致振荡。这项高级计算练习探讨了反馈性能与稳定性之间的基本权衡。通过使用奈奎斯特图和增益裕度等频域工具，您将研究反馈增益和时间延迟如何决定调节系统是保持稳定还是产生振荡——这是管球反馈（TGF）中观察到的一个关键特征 。",
            "id": "3925090",
            "problem": "考虑一个肾脏自动调节的线性化小信号模型，其中入球小动脉和反馈传感构成一个由动脉压扰动驱动的单输入单输出回路。两个主要的生理机制是肌源性反应和管球反馈（TGF）。肌源性反应调节入球小动脉阻力以响应跨壁压力变化，而管球反馈（TGF）则基于致密斑对远曲小管液流速的传感来调节入球动脉张力。对于围绕一个稳定工作点的小扰动，将开环对象建模为一阶环节和纯时间延迟的串联，以捕捉传输和信号延迟：\n- 一个用于肌源性反应的一阶滞后环节，其转折频率为 $\\omega_{\\mathrm{m}}$，单位为 $\\mathrm{rad/s}$。\n- 一个用于管球反馈的一阶滞后环节，其转折频率为 $\\omega_{\\mathrm{tgf}}$，单位为 $\\mathrm{rad/s}$。\n- 一个转折频率为 $\\omega_{\\mathrm{z}}$（单位为 $\\mathrm{rad/s}$）的单个零点，代表传感路径中的净直接流量依赖性。\n- 一个纯时间延迟 $\\tau_{\\mathrm{d}}$（单位为 $\\mathrm{s}$），代表传输和信号延迟。\n令对象的无量纲稳态增益为 $G_{\\mathrm{p}}$。令无量纲反馈增益为 $K$。用 $s$ 表示拉普拉斯变量，频率轴为 $s = j \\omega$，其中角度以弧度为单位。\n\n使用以下标准构建模块来构造开环传递函数：\n- 一阶滞后环节 $B(s)$ 的形式为 $B(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{b}}}$，转折频率为 $\\omega_{\\mathrm{b}}$。\n- 单个零点环节 $Z(s)$ 的形式为 $Z(s) = 1 + s/\\omega_{\\mathrm{z}}$。\n- 纯时间延迟 $D(s)$ 的形式为 $D(s) = e^{- s \\tau_{\\mathrm{d}}}$。\n组合这些元素以获得开环对象 $P(s)$，然后得到开环回路传递函数 $L(s) = K \\, P(s)$。\n\n将用于扰动抑制的灵敏度函数 $S(s)$ 定义为 $S(s) = \\dfrac{1}{1 + L(s)}$。低频扰动抑制质量由小 $\\omega$ 下的幅值 $\\left| S(j \\omega) \\right|$ 指示，特别是在 $\\omega = 0$ 处。\n\n使用 $L(s)$ 的奈奎斯特图定义增益裕度如下。令 $\\omega_{\\mathrm{pc}}$ 为满足 $\\arg\\!\\left( L(j \\omega_{\\mathrm{pc}}) \\right) = - \\pi$（角度以弧度为单位）的任意相位穿越频率。如果存在这样的 $\\omega_{\\mathrm{pc}}$，则增益裕度为 $GM = \\dfrac{1}{\\left| L(j \\omega_{\\mathrm{pc}}) \\right|}$；如果在所考虑的频率范围内不存在相位穿越，则将 $GM$ 设置为 $+\\infty$。假设开环对象 $P(s)$ 没有右半平面极点。使用奈奎斯特稳定性判据，通过计算 $L(s)$ 的奈奎斯特图围绕复平面中点 $-1$ 的环绕数来确定闭环稳定性；零次环绕意味着闭环稳定，非零次环绕意味着闭环不稳定。\n\n您的任务是实现一个程序，对于每个指定的测试用例，根据提供的参数构造 $L(s)$，计算低频灵敏度幅值 $\\left| S(j 0) \\right|$，基于上述相位穿越定义从奈奎斯特图计算增益裕度 $GM$，并使用奈奎斯特环绕判据确定闭环稳定性。所有频率必须以 $\\mathrm{rad/s}$ 为单位处理，时间延迟以 $\\mathrm{s}$ 为单位。每个测试用例的输出必须是一个包含三个元素的列表：浮点数 $\\left| S(j 0) \\right|$（四舍五入到 $6$ 位小数），浮点数 $GM$（四舍五入到 $6$ 位小数，如果不存在相位穿越则为 $+\\infty$），以及一个指示闭环稳定性的布尔值，顺序如此。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的列表形式的结果（例如，$\\left[ [a,b,c],[d,e,f] \\right]$）。\n\n使用以下测试套件（每个参数元组的顺序为 $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$）：\n- 测试用例 1（一般情况，中等延迟和中等增益）：$(1.0, 0.7, 0.05, 0.02, 6.0, 2.0)$。\n- 测试用例 2（增加增益以探测裕度减小）：$(1.0, 0.7, 0.05, 0.02, 6.0, 8.0)$。\n- 测试用例 3（边缘情况：零延迟导致在实际频带内无相位穿越）：$(1.0, 0.5, 0.05, 0.01, 0.0, 20.0)$。\n- 测试用例 4（大延迟和显著增益以引发振荡趋势）：$(1.2, 0.5, 0.04, 0.01, 20.0, 5.0)$。\n\n科学真实性约束：\n- 转折频率 $\\omega_{\\mathrm{m}}$ 和 $\\omega_{\\mathrm{tgf}}$ 分别反映了肌源性机制和管球反馈（TGF）的特征响应速率。\n- 延迟 $\\tau_{\\mathrm{d}}$ 整合了反馈回路中的传输和信号延迟。\n\n角度单位必须是弧度。将所有计算出的幅值表示为无量纲浮点数。最终输出必须是单行文本，其中包含用方括号括起来的、以逗号分隔的每个测试用例结果的Python列表表示形式。在打印前，将所有指定的浮点数四舍五入到 $6$ 位小数。",
            "solution": "该问题被评估为有效，因为它在科学上基于应用于标准生物医学模型的控制理论，问题陈述适定，具有足够的数据和明确的目标，并且没有矛盾或歧义。\n\n此处提供解决方案的逐步推导。\n\n### 1. 模型构建\n该问题描述了一个用于肾脏自动调节的单输入单输出（SISO）反馈回路。开环对象传递函数 $P(s)$ 是几个环节的串联。基于所提供的构建模块，$P(s)$ 的构造如下：\n- 肌源性反应滞后：$B_{\\mathrm{m}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{m}}}$\n- 管球反馈（TGF）滞后：$B_{\\mathrm{tgf}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{tgf}}}$\n- 传感路径零点：$Z(s) = 1 + s/\\omega_{\\mathrm{z}}$\n- 纯时间延迟：$D(s) = e^{-s \\tau_{\\mathrm{d}}}$\n- 稳态对象增益：$G_{\\mathrm{p}}$\n\n完整的对象传递函数 $P(s)$ 是这些组件的乘积：\n$$ P(s) = G_{\\mathrm{p}} \\cdot B_{\\mathrm{m}}(s) \\cdot B_{\\mathrm{tgf}}(s) \\cdot Z(s) \\cdot D(s) = G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\n开环回路传递函数 $L(s)$ 包含反馈增益 $K$：\n$$ L(s) = K \\cdot P(s) = K G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\n\n### 2. 低频灵敏度幅值\n灵敏度函数 $S(s)$ 定义为 $S(s) = \\dfrac{1}{1 + L(s)}$。它量化了系统抑制扰动的能力。低频扰动抑制在 $\\omega = 0$ 处进行评估，这对应于 $s = j\\omega = 0$。\n\n首先，我们求出回路传递函数的直流增益 $L(j0)$：\n$$ L(j0) = K G_{\\mathrm{p}} \\frac{1 + j0/\\omega_{\\mathrm{z}}}{(1 + j0/\\omega_{\\mathrm{m}})(1 + j0/\\omega_{\\mathrm{tgf}})} e^{-j0 \\cdot \\tau_{\\mathrm{d}}} = K G_{\\mathrm{p}} \\frac{1}{1 \\cdot 1} e^{0} = K G_{\\mathrm{p}} $$\n那么在 $s=0$ 处的灵敏度为：\n$$ S(j0) = \\frac{1}{1 + L(j0)} = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\n由于对于给定的测试用例，参数 $K$ 和 $G_{\\mathrm{p}}$ 都是正实数，其幅值就是：\n$$ |S(j0)| = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\n\n### 3. 增益裕度 (GM)\n增益裕度由 $L(j\\omega)$ 的奈奎斯特图确定。这需要找到相位穿越频率 $\\omega_{\\mathrm{pc}}$，即 $L(j\\omega)$ 的相位恰好为 $-\\pi$ 弧度（或 $-180^{\\circ}$）的任意频率。\n$L(j\\omega)$ 的相位，记为 $\\arg(L(j\\omega))$，是其各分量相位之和：\n$$ \\arg(L(j\\omega)) = \\arg(K G_{\\mathrm{p}}) + \\arg(1 + j\\omega/\\omega_{\\mathrm{z}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{m}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{tgf}}) + \\arg(e^{-j\\omega\\tau_{\\mathrm{d}}}) $$\n鉴于 $K G_{\\mathrm{p}} > 0$，其相位为 $0$。复数 $1 + jx$ 的相位是 $\\arctan(x)$，而 $e^{-j\\theta}$ 的相位是 $-\\theta$。因此：\n$$ \\arg(L(j\\omega)) = \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega \\tau_{\\mathrm{d}} $$\n相位穿越频率 $\\omega_{\\mathrm{pc}}$ 是以下超越方程的一个正根：\n$$ \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega_{\\mathrm{pc}} \\tau_{\\mathrm{d}} = -\\pi $$\n该方程需要数值求解。一个数值求根算法，如Brent-Dekker方法（`brentq`），是合适的。我们寻找一个根 $\\omega_{\\mathrm{pc}} > 0$。\n- 如果不存在这样的正根，则没有相位穿越。例如，当 $\\tau_{\\mathrm{d}}=0$ 时会发生这种情况，因为传递函数有理部分的组合相位界于 $0$ 和 $-\\pi/2$ 之间。在这种情况下，增益裕度 $GM$ 定义为 $+\\infty$。\n- 如果找到了一个根 $\\omega_{\\mathrm{pc}}$，我们接着计算幅值 $|L(j\\omega_{\\mathrm{pc}})|$：\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}}|}{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}}||1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}}|} |e^{-j\\omega_{\\mathrm{pc}}\\tau_{\\mathrm{d}}|} $$\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}})^2}}{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}})^2} \\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}})^2}} $$\n增益裕度就是该幅值的倒数：\n$$ GM = \\frac{1}{|L(j\\omega_{\\mathrm{pc}})|} $$\n\n### 4. 闭环稳定性\n奈奎斯特稳定性判据用于确定闭环稳定性。问题陈述开环对象 $P(s)$ 在复平面右半部分没有极点（$P=0$）。因此，要使闭环系统稳定，回路传递函数 $L(j\\omega)$ 的奈奎斯特图不得环绕临界点 $-1+j0$（$N=0$）。\n\n对于这类系统（稳定的开环对象），稳定性可以从增益裕度推断：\n- 如果不存在相位穿越（$GM=+\\infty$），奈奎斯特图不会穿过原点左侧的负实轴，因此不能环绕 $-1$。系统是稳定的。\n- 如果存在相位穿越，系统稳定的充要条件是该穿越点的增益小于1：$|L(j\\omega_{\\mathrm{pc}})|  < 1$。这等价于增益裕度 $GM > 1$。\n- 如果 $GM \\le 1$，系统是不稳定或临界稳定的。问题要求输出一个布尔值，所以我们将 $GM \\le 1$ 归类为不稳定。\n\n因此，稳定性由条件：`stable = (GM > 1) or (GM is infinite)` 确定。\n\n### 算法实现\n每个测试用例的总体算法是：\n1.  读取参数 $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$。\n2.  计算 $|S(j0)| = 1 / (1 + K G_{\\mathrm{p}})$。\n3.  定义相位函数 $\\Phi(\\omega) = \\arctan(\\omega/\\omega_{\\mathrm{z}}) - \\arctan(\\omega/\\omega_{\\mathrm{m}}) - \\arctan(\\omega/\\omega_{\\mathrm{tgf}}) - \\omega\\tau_{\\mathrm{d}} + \\pi$。\n4.  如果 $\\tau_{\\mathrm{d}} = 0$，设置 $GM = +\\infty$。\n5.  如果 $\\tau_{\\mathrm{d}} > 0$，使用数值求解器找到 $\\Phi(\\omega)=0$ 的最小正根 $\\omega_{\\mathrm{pc}}$。如果在合理的频率范围内未找到根，则设置 $GM = +\\infty$。否则，计算 $|L(j\\omega_{\\mathrm{pc}})|$ 并设置 $GM = 1 / |L(j\\omega_{\\mathrm{pc}})|$。\n6.  判定稳定性：`is_stable = (GM > 1.0 or GM is infinite)`。\n7.  收集结果：$[|S(j0)|, GM, \\text{is_stable}]$，确保浮点数四舍五入到 $6$ 位小数。\n\n此过程将应用于所有提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the renal autoregulation control problem for a given set of test cases.\n    \"\"\"\n\n    # Test cases: (Gp, wm, wtgf, wz, td, K)\n    test_cases = [\n        (1.0, 0.7, 0.05, 0.02, 6.0, 2.0),\n        (1.0, 0.7, 0.05, 0.02, 6.0, 8.0),\n        (1.0, 0.5, 0.05, 0.01, 0.0, 20.0),\n        (1.2, 0.5, 0.04, 0.01, 20.0, 5.0),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Gp, wm, wtgf, wz, td, K = case\n\n        # 1. Calculate low-frequency sensitivity magnitude |S(j0)|\n        L_dc = K * Gp\n        s_at_0 = 1.0 / (1.0 + L_dc)\n\n        # 2. Calculate Gain Margin (GM)\n        # The phase of L(jw) must equal -pi.\n        # arg(L) = atan(w/wz) - atan(w/wm) - atan(w/wtgf) - w*td\n        # We need to find the root of phase_equation(w) = 0\n        def phase_equation(w):\n            if w == 0:\n                # Avoid division by zero and handle limit. Phase is 0 at w=0.\n                return np.pi\n            return np.arctan(w / wz) - np.arctan(w / wm) - np.arctan(w / wtgf) - w * td + np.pi\n\n        gm = np.inf\n        w_pc = None\n\n        # A phase crossover can only occur if the time delay td is positive.\n        # If td=0, the phase asymptotically approaches -pi/2 rad.\n        if td > 0:\n            try:\n                # Search for the phase-crossover frequency w_pc in a reasonable range.\n                # The phase equation starts at +pi for w->0 and becomes negative for large w.\n                # A bracket [a, b] where f(a) * f(b)  0 is required for brentq.\n                search_bracket = [1e-9, 100.0]\n                w_pc = brentq(phase_equation, search_bracket[0], search_bracket[1])\n            except ValueError:\n                # brentq raises ValueError if no root is found in the bracket\n                w_pc = None\n\n        if w_pc is not None:\n            # Calculate magnitude at phase crossover frequency w_pc\n            mag_at_w_pc = (K * Gp *\n                           np.sqrt(1 + (w_pc / wz)**2) /\n                           (np.sqrt(1 + (w_pc / wm)**2) * np.sqrt(1 + (w_pc / wtgf)**2)))\n\n            if mag_at_w_pc > 0:\n                gm = 1.0 / mag_at_w_pc\n\n        # 3. Determine closed-loop stability\n        # For a stable open-loop plant, stability requires GM > 1.\n        is_stable = (gm > 1.0) or np.isinf(gm)\n\n        # 4. Format results\n        s_at_0_rounded = round(s_at_0, 6)\n        \n        if np.isinf(gm):\n            gm_rounded = gm\n        else:\n            gm_rounded = round(gm, 6)\n        \n        all_results.append([s_at_0_rounded, gm_rounded, is_stable])\n\n    # Final print statement in the exact required format.\n    print(all_results)\n\nsolve()\n\n```"
        }
    ]
}