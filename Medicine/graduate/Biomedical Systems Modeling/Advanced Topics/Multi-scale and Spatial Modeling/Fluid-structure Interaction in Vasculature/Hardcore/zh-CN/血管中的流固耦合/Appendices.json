{
    "hands_on_practices": [
        {
            "introduction": "动脉系统的复杂几何形状，特别是血管的弯曲，对血流动力学有深远影响。本练习旨在通过计算迪恩数（$De$）来实践这一核心概念，这是一个关键的无量纲参数，用于量化弯曲血管中二次流的强度。通过这个计算，您将学会如何将血管的几何特征与流动速率联系起来，并评估这些二次流对壁面剪切应力（WSS）分布的潜在生理学影响。",
            "id": "3887095",
            "problem": "一个直-弯颈动脉模型可近似为血液在内半径为 $a$、中心线曲率恒为 $\\kappa$ 的圆弧形管道中的稳态、不可压缩、层流、牛顿流体流动。血液的密度为 $\\rho$，动力粘度为 $\\mu$。体积流量为 $Q$。仅使用运动学的基本定义、雷诺数以及用于弯曲管道中惯性-曲率相互作用的标准无量纲数，计算该动脉段的迪恩数。然后，用文字简要评估二次流是否可能影响壁面剪切应力（壁面剪切应力(WSS)指流体施加在壁面上的切向应力）。使用以下数据：\n- $a = 3 \\,\\mathrm{mm}$，\n- $\\kappa = 50 \\,\\mathrm{m^{-1}}$，\n- $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}}$，\n- $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$，\n- $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s}$。\n\n将迪恩数表示为一个纯数（无量纲）。将您的答案四舍五入到三位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于流体动力学原理，特别是关于动脉血流的生物流体力学。该问题提法恰当，为获得唯一解提供了所有必要的数据。所提供的血液密度、粘度、流量、动脉半径和曲率值在生理上是现实的。所用术语客观而精确。\n\n任务是计算指定颈动脉段的迪恩数 $De$，并评估二次流对壁面剪切应力的影响。\n\n迪恩数是表征弯曲管道中二次流强度的标准无量纲数。它的定义是雷诺数 $Re$ 与曲率比 $\\delta$ 的平方根的乘积。\n$$\nDe = Re \\sqrt{\\delta}\n$$\n\n首先，我们定义水力直径为 $D$ 的管道中流动的雷诺数 $Re$。\n$$\nRe = \\frac{\\rho V D}{\\mu}\n$$\n此处，$\\rho$ 是流体密度，$V$ 是平均流速，$\\mu$ 是动力粘度。对于内半径为 $a$ 的圆形管道，水力直径为 $D = 2a$。因此，雷诺数为：\n$$\nRe = \\frac{\\rho V (2a)}{\\mu}\n$$\n\n平均速度 $V$ 通过基本运动学定义与体积流量 $Q$ 和管道横截面积 $A = \\pi a^2$ 相关联：\n$$\nV = \\frac{Q}{A} = \\frac{Q}{\\pi a^2}\n$$\n将 $V$ 的这个表达式代入雷诺数方程，得到：\n$$\nRe = \\frac{\\rho \\left(\\frac{Q}{\\pi a^2}\\right) (2a)}{\\mu} = \\frac{2\\rho Q}{\\pi a \\mu}\n$$\n\n接下来，我们定义曲率比 $\\delta$。这是管道内半径 $a$ 与其中心线曲率半径 $R_c$ 之比。\n$$\n\\delta = \\frac{a}{R_c}\n$$\n问题提供了中心线曲率 $\\kappa$，它是曲率半径的倒数，即 $\\kappa = \\frac{1}{R_c}$。因此，我们可以将曲率比表示为：\n$$\n\\delta = a\\kappa\n$$\n\n现在，我们将 $Re$ 和 $\\delta$ 的表达式代入，组合出迪恩数的完整表达式：\n$$\nDe = \\left( \\frac{2\\rho Q}{\\pi a \\mu} \\right) \\sqrt{a\\kappa}\n$$\n这是基于给定参数的迪恩数的最终符号表达式。\n\n问题提供了以下数据：\n- 内半径: $a = 3 \\,\\mathrm{mm}$\n- 中心线曲率: $\\kappa = 50 \\,\\mathrm{m^{-1}}$\n- 体积流量: $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}}$\n- 血液密度: $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$\n- 血液动力粘度: $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s}$\n\n在计算之前，所有值都必须转换为一致的单位制，即国际单位制（米、千克、秒）。\n- $a = 3 \\,\\mathrm{mm} = 3 \\times 10^{-3} \\,\\mathrm{m}$\n- $\\kappa = 50 \\,\\mathrm{m^{-1}}$ (已是国际单位制)\n- $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}} = 4 \\,\\mathrm{cm^3 \\cdot s^{-1}} = 4 \\times (10^{-2})^3 \\,\\mathrm{m^3 \\cdot s^{-1}} = 4 \\times 10^{-6} \\,\\mathrm{m^3 \\cdot s^{-1}}$\n- $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$ (已是国际单位制)\n- $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s} = 3.5 \\times 10^{-3} \\,\\mathrm{Pa\\cdot s} = 3.5 \\times 10^{-3} \\,\\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}$\n\n现在我们可以将这些数值代入 $De$ 的符号表达式中：\n$$\nDe = \\frac{2(1060)(4 \\times 10^{-6})}{\\pi (3 \\times 10^{-3})(3.5 \\times 10^{-3})} \\sqrt{(3 \\times 10^{-3})(50)}\n$$\n让我们简化各项：\n$$\nDe = \\frac{8480 \\times 10^{-6}}{\\pi (10.5 \\times 10^{-6})} \\sqrt{0.15}\n$$\n分子和分母中的因子 $10^{-6}$ 可以消去。\n$$\nDe = \\frac{8480}{10.5\\pi} \\sqrt{0.15}\n$$\n现在，我们计算数值：\n$$\nDe \\approx \\frac{8480}{32.9867} \\times 0.387298\n$$\n$$\nDe \\approx 257.073 \\times 0.387298\n$$\n$$\nDe \\approx 99.554\n$$\n按要求将结果四舍五入到三位有效数字，我们得到 $De = 99.6$。\n\n任务的第二部分是评估二次流是否可能影响壁面剪切应力 (WSS)。迪恩数量化了这些二次运动（迪恩涡）相对于主轴向流的强度。一个常见的经验阈值是，当 $De > 40$ 时，二次流变得显著，并从直管中 Poiseuille 流的简单抛物线剖面显著改变流场。\n\n我们计算出的值为 $De \\approx 99.6$，远高于 $40$ 这个阈值。因此，二次流的强度肯定足以对壁面剪切应力的分布产生重大影响。在弯曲管道中，二次流将高动量流体从管道中心输送到弯管的外壁。这会使轴向速度剖面发生偏斜，将最大速度点从中心线移向外壁。由于 WSS 与壁面处速度梯度成正比（$\\tau_w = \\mu \\frac{\\partial u}{\\partial n}|_{wall}$），这种动量的重新分布导致了沿动脉圆周的非均匀 WSS 分布。具体来说，与在具有相同流量的直管中会发现的值相比，弯曲处外壁的 WSS 会显著更高，而内壁的 WSS 会更低。这种现象具有重要的临床意义，因为动脉弯曲处内壁上低且振荡的 WSS 通常与动脉粥样硬化斑块的形成有关。\n\n总之，二次流极有可能影响该颈动脉模型中的壁面剪切应力，导致其显著的空间变化。",
            "answer": "$$\n\\boxed{99.6}\n$$"
        },
        {
            "introduction": "随着计算模型的日益复杂，如何确保代码准确地求解了其所基于的控制方程，已成为一个至关重要的问题。本项高级练习将向您介绍一种严格的代码验证技术——人造解方法（Method of Manufactured Solutions, MMS）。您需要为一个在任意拉格朗日-欧拉（ALE）框架下的一维流固耦合模型推导源项，并实施验证流程。这项实践对于培养开发和使用复杂数值求解器所需的严谨性和精确性至关重要。",
            "id": "3887041",
            "problem": "考虑一根长度为 $L$ 的一维顺应性动脉，其轴向坐标为 $x \\in [0,L]$，时间为 $t \\ge 0$。流体被建模为不可压缩的牛顿流体，质量密度为 $\\rho$，我们对移动的计算域使用任意拉格朗日-欧拉 (Arbitrary Lagrangian-Eulerian, ALE) 框架。设横截面积为 $A(x,t)$，平均轴向流体速度为 $u(x,t)$，轴向网格（grid）速度为 $w(x,t)$，内部压力为 $p(x,t)$。外部压力为 $p_{\\mathrm{ext}}$，管壁通过一个具有刚度 $K$ 的代数“管道定律”建模，该定律将压力与面积耦合起来。\n\n基本原理：\n- 移动控制体中的质量守恒意味着一维 ALE 连续性方程：\n$$\\partial_t A + \\partial_x \\big( A \\, (u - w) \\big) = s_A(x,t),$$\n其中 $s_A(x,t)$ 是一个源项。\n- 在一维 ALE 框架中，动量守恒（为简化起见，忽略除人造源项之外的粘性扩散和体积力）为\n$$\\rho \\left( \\partial_t u + (u - w) \\, \\partial_x u \\right) + \\partial_x p = s_u(x,t),$$\n其中 $s_u(x,t)$ 是一个源项。\n- 在流固耦合界面（顺应性管道定律）处的界面耦合表示为\n$$p(x,t) - p_{\\mathrm{ext}} = K \\, \\big( A(x,t) - A_0 \\big),$$\n其中 $A_0$ 是基准（参考）面积。\n\n人造解：\n您必须通过人造解方法 (Method of Manufactured Solutions) 来验证 ALE 对流项和界面耦合。考虑以下光滑、空间周期性的人造场：\n- $$A(x,t) = A_0 \\left( 1 + \\epsilon \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t) \\right),$$\n- $$u(x,t) = U_0 \\, \\cos(k \\, x) \\, \\sin(\\omega \\, t),$$\n- $$w(x,t) = W_0 \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t),$$\n- $$p(x,t) = p_{\\mathrm{ext}} + K \\, \\big( A(x,t) - A_0 \\big).$$\n\n根据这些定义，通过代入控制方程并使用精确导数来推导解析源项 $s_A(x,t)$ 和 $s_u(x,t)$。具体定义为\n- $$s_A(x,t) \\equiv \\partial_t A + \\partial_x \\big( A \\, (u - w) \\big),$$\n- $$s_u(x,t) \\equiv \\rho \\left( \\partial_t u + (u - w) \\, \\partial_x u \\right) + \\partial_x p,$$\n其中所有导数都是相对于上述人造场进行解析计算的。\n\n验证指标：\n为验证 ALE 对流项和界面耦合的正确引入，请在 $x$ 的均匀网格上，于固定时间 $t=t_0$ 计算以下三个基于残差的指标：\n1. 当在 $x$ 和 $t$ 方向上使用中心差分进行离散化，并使用正确的 ALE 对流通量 $A(u-w)$ 时，连续性方程的最大绝对残差：\n   $$R_{A,\\max} \\equiv \\max_{x} \\left| \\left[ \\delta_t A + \\delta_x \\big( A \\, (u - w) \\big) \\right] - s_A \\right|,$$\n   其中 $\\delta_t$ 和 $\\delta_x$ 分别表示对 $\\partial_t$ 和 $\\partial_x$ 的二阶中心差分近似。将 $R_{A,\\max}$ 以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示。\n2. 动量残差范数的比率，用于比较一个错误的对流项（错误地忽略了网格速度，即使用 $u \\, \\partial_x u$）与正确的 ALE 项：\n   $$\\mathcal{R}_U \\equiv \\frac{\\left\\| \\rho \\left( \\delta_t u + u \\, \\delta_x u \\right) + \\delta_x p - s_u \\right\\|_{\\infty}}{\\left\\| \\rho \\left( \\delta_t u + (u - w) \\, \\delta_x u \\right) + \\delta_x p - s_u \\right\\|_{\\infty} + \\varepsilon},$$\n   其中 $\\|\\cdot\\|_{\\infty}$ 表示网格上的无穷范数，$\\varepsilon$ 是一个小的正数以避免除以零。该比率是无量纲的。\n3. 界面耦合（管道定律）的最大绝对残差：\n   $$R_{\\mathrm{cpl},\\max} \\equiv \\max_{x} \\left| p - p_{\\mathrm{ext}} - K \\, (A - A_0) \\right|,$$\n   以 $\\mathrm{Pa}$ 为单位表示。\n\n离散化细节：\n- 在 $[0,L]$ 上使用 $N$ 个均匀分布的网格点，网格间距为 $\\Delta x = L/(N-1)$。\n- 使用小的时间增量 $\\Delta t$ 和中心差分来近似 $\\partial_t q(x,t_0)$：\n  $$\\delta_t q(x,t_0) \\equiv \\frac{q(x,t_0+\\Delta t) - q(x,t_0-\\Delta t)}{2 \\, \\Delta t}.$$\n- 对内部点使用中心差分计算 $\\partial_x$，在边界上使用一阶单边差分。\n\n测试套件：\n对于下面的每个参数集，在相同的固定时间 $t_0$ 评估三个指标。除非另有说明，所有量均采用国际单位制 (SI)。\n- 测试用例 1 (通用移动网格情况)：\n  - $L = 0.1$,\n  - $R_0 = 0.004$,\n  - $A_0 = \\pi \\, R_0^2$,\n  - $\\rho = 1060$,\n  - $K = 4 \\times 10^7$,\n  - $U_0 = 0.2$,\n  - $W_0 = 0.05$,\n  - $\\epsilon = 0.05$,\n  - $k = \\dfrac{2 \\pi}{L}$,\n  - $\\omega = 2 \\pi \\times 10$,\n  - $p_{\\mathrm{ext}} = 9 \\times 10^4$,\n  - $N = 201$,\n  - $\\Delta t = 1 \\times 10^{-4}$,\n  - $t_0 = 0.037$.\n- 测试用例 2 (零网格速度的欧拉极限边界条件)：\n  - 除 $W_0 = 0$ 外，与测试用例 1 相同。\n- 测试用例 3 (高频、较大网格运动)：\n  - $L = 0.1$,\n  - $R_0 = 0.004$,\n  - $A_0 = \\pi \\, R_0^2$,\n  - $\\rho = 1060$,\n  - $K = 4 \\times 10^7$,\n  - $U_0 = 0.2$,\n  - $W_0 = 0.4$,\n  - $\\epsilon = 0.05$,\n  - $k = \\dfrac{2 \\pi}{L}$,\n  - $\\omega = 2 \\pi \\times 30$,\n  - $p_{\\mathrm{ext}} = 9 \\times 10^4$,\n  - $N = 401$,\n  - $\\Delta t = 5 \\times 10^{-5}$,\n  - $t_0 = 0.037$.\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按 $[R_{A,\\max}, \\mathcal{R}_U, R_{\\mathrm{cpl},\\max}]$ 的顺序输出三个指标，并按照测试用例 1、测试用例 2、测试用例 3 的顺序连接所有测试用例的结果。例如，输出必须如下所示\n$$[r_{A,1}, r_{U,1}, r_{\\mathrm{cpl},1}, r_{A,2}, r_{U,2}, r_{\\mathrm{cpl},2}, r_{A,3}, r_{U,3}, r_{\\mathrm{cpl},3}],$$\n其中每个 $r$ 均以指定单位和顺序的浮点数形式报告。",
            "solution": "用户提供了一个适定的问题，该问题在生物医学系统建模领域具有科学依据。这是一个使用任意拉格朗日-欧拉 (ALE) 框架，对顺应性动脉中血流的简化一维模型进行的验证练习。该方法基于成熟的人造解方法 (MMS)。问题陈述是完整、一致和客观的。因此，下面提供一个完整的解法。\n\n这个问题的核心是在 ALE 框架中验证流固耦合控制方程的正确实现。这是通过使用人造解方法 (MMS) 来实现的。该过程涉及几个步骤：\n1.  为系统的主要变量定义光滑的解析函数，即横截面积 $A(x,t)$、流体速度 $u(x,t)$、网格速度 $w(x,t)$ 和压力 $p(x,t)$。这些就是“人造解”。\n2.  将这些人造解代入控制偏微分方程。由于这些任意函数通常不会满足齐次方程，它们的代入会产生非零的残差项。这些残差被定义为源项，$s_A(x,t)$ 和 $s_u(x,t)$。\n3.  实现一个数值方案来求解包含推导出的源项的控制方程。人造解被用作边界条件并用于评估源项。\n4.  然后通过将数值解与精确的人造解进行比较来计算数值解的误差。在这个问题中，使用了一个简化的变体：我们通过代入精确的人造解并将其与解析推导的源项进行比较，来计算离散化方程的残差。随着离散化的细化，该残差应收敛到零。\n\n让我们从推导解析源项开始。\n\n**1. 解析源项的推导**\n\n人造解如下：\n- $A(x,t) = A_0 \\left( 1 + \\epsilon \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t) \\right)$\n- $u(x,t) = U_0 \\, \\cos(k \\, x) \\, \\sin(\\omega \\, t)$\n- $w(x,t) = W_0 \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t)$\n- $p(x,t) = p_{\\mathrm{ext}} + K \\, \\big( A(x,t) - A_0 \\big) = p_{\\mathrm{ext}} + K A_0 \\epsilon \\sin(k x) \\cos(\\omega t)$\n\n为了推导源项 $s_A(x,t)$ 和 $s_u(x,t)$，我们必须首先计算这些场的必要偏导数。\n\n*$A(x,t)$ 的导数：*\n$$ \\partial_t A = \\frac{\\partial}{\\partial t} \\left[ A_0 \\left( 1 + \\epsilon \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t) \\right) \\right] = -A_0 \\epsilon \\omega \\sin(k x) \\sin(\\omega t) $$\n$$ \\partial_x A = \\frac{\\partial}{\\partial x} \\left[ A_0 \\left( 1 + \\epsilon \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t) \\right) \\right] = A_0 \\epsilon k \\cos(k x) \\cos(\\omega t) $$\n\n*$u(x,t)$ 的导数：*\n$$ \\partial_t u = \\frac{\\partial}{\\partial t} \\left[ U_0 \\, \\cos(k \\, x) \\, \\sin(\\omega \\, t) \\right] = U_0 \\omega \\cos(k x) \\cos(\\omega t) $$\n$$ \\partial_x u = \\frac{\\partial}{\\partial x} \\left[ U_0 \\, \\cos(k \\, x) \\, \\sin(\\omega \\, t) \\right] = -U_0 k \\sin(k x) \\sin(\\omega t) $$\n\n*$w(x,t)$ 的导数：*\n$$ \\partial_x w = \\frac{\\partial}{\\partial x} \\left[ W_0 \\, \\sin(k \\, x) \\, \\cos(\\omega \\, t) \\right] = W_0 k \\cos(k x) \\cos(\\omega t) $$\n\n*$p(x,t)$ 的导数：*\n$$ \\partial_x p = \\frac{\\partial}{\\partial x} \\left[ p_{\\mathrm{ext}} + K \\, (A(x,t) - A_0) \\right] = K \\, \\partial_x A = K A_0 \\epsilon k \\cos(k x) \\cos(\\omega t) $$\n\n现在，我们可以组装源项。\n\n**连续性方程的源项，$s_A(x,t)$：**\n源项通过将人造解代入连续性方程来定义：\n$$ s_A(x,t) \\equiv \\partial_t A + \\partial_x \\big( A \\, (u - w) \\big) $$\n使用乘法法则 $\\partial_x (fg) = (\\partial_x f)g + f(\\partial_x g)$，我们可以展开通量项：\n$$ \\partial_x \\big( A \\, (u - w) \\big) = (\\partial_x A)(u-w) + A(\\partial_x u - \\partial_x w) $$\n代入先前推导的表达式：\n$$ s_A(x,t) = \\partial_t A + (\\partial_x A)(u - w) + A(\\partial_x u - \\partial_x w) $$\n这种结合了解析导数的形式，在计算上比单个庞大的表达式更稳健。\n\n**动量方程的源项，$s_u(x,t)$：**\n同样，动量源项定义为：\n$$ s_u(x,t) \\equiv \\rho \\left( \\partial_t u + (u - w) \\, \\partial_x u \\right) + \\partial_x p $$\n代入解析导数：\n$$ s_u(x,t) = \\rho \\left( U_0 \\omega \\cos(k x) \\cos(\\omega t) + \\left( U_0 \\cos(k x) \\sin(\\omega t) - W_0 \\sin(k x) \\cos(\\omega t) \\right) (-U_0 k \\sin(k x) \\sin(\\omega t)) \\right) + K A_0 \\epsilon k \\cos(k x) \\cos(\\omega t) $$\n该表达式将通过在所需的空间和时间点上评估每个分量函数来实现。\n\n**2. 验证指标的数值计算**\n\n问题要求在特定时间 $t_0$，于一个包含 $N$ 个点 $x_i$（其中 $i=0, \\dots, N-1$）且间距为 $\\Delta x = L/(N-1)$ 的均匀网格上计算三个指标。\n\n**数值导数：**\n函数 $q(x,t)$ 的时间导数使用二阶中心差分近似：\n$$ \\delta_t q(x_i,t_0) = \\frac{q(x_i, t_0+\\Delta t) - q(x_i, t_0-\\Delta t)}{2 \\, \\Delta t} $$\n在网格上评估的函数 $f(x)$（即 $f_i = f(x_i)$）的空间导数，对内部点（$i=1, \\dots, N-2$）使用二阶中心差分近似，对边界点（$i=0$ 和 $i=N-1$）使用一阶单边差分近似：\n$$ (\\delta_x f)_i = \\begin{cases} (f_{1} - f_{0}) / \\Delta x & i=0 \\\\ (f_{i+1} - f_{i-1}) / (2 \\Delta x) & 1 \\le i \\le N-2 \\\\ (f_{N-1} - f_{N-2}) / \\Delta x & i=N-1 \\end{cases} $$\n\n**指标 1：$R_{A,\\max}$ (连续性残差)**\n该指标量化了离散化连续性方程的残差。\n$$ R_{A,\\max} = \\max_{i} \\left| \\left[ \\delta_t A(x_i,t_0) + \\delta_x \\big( A(u - w) \\big)(x_i, t_0) \\right] - s_A(x_i,t_0) \\right| $$\n为了计算这个值，我们首先对所有网格点 $i$ 计算通量项 $F_A(x_i, t_0) = A(x_i, t_0)(u(x_i, t_0) - w(x_i, t_0))$。然后我们将空间差分算子 $\\delta_x$ 应用于得到的网格函数 $F_A$。时间导数 $\\delta_t A$ 按上述方法计算。解析源项 $s_A$ 在 $(x_i, t_0)$ 处进行评估。差值的最大绝对值即为结果。\n\n**指标 2：$\\mathcal{R}_U$ (动量对流项比率)**\n这个无量纲比率比较了使用不正确（欧拉）对流项产生的误差与使用正确 ALE 对流项产生的误差。\n$$ \\mathcal{R}_U = \\frac{\\left\\| \\text{Res}_U^{\\text{wrong}} \\right\\|_{\\infty}}{\\left\\| \\text{Res}_U^{\\text{correct}} \\right\\|_{\\infty} + \\varepsilon} $$\n其中 $\\|\\cdot\\|_{\\infty}$ 是网格上的最大绝对值（无穷范数）。\n忽略网格速度 $w$ 的“错误”残差为：\n$$ \\text{Res}_U^{\\text{wrong}}(x_i, t_0) = \\rho \\left( \\delta_t u(x_i,t_0) + u(x_i,t_0) \\, \\delta_x u(x_i,t_0) \\right) + \\delta_x p(x_i,t_0) - s_u(x_i,t_0) $$\n“正确”的 ALE 残差为：\n$$ \\text{Res}_U^{\\text{correct}}(x_i, t_0) = \\rho \\left( \\delta_t u(x_i,t_0) + (u(x_i,t_0) - w(x_i,t_0)) \\, \\delta_x u(x_i,t_0) \\right) + \\delta_x p(x_i,t_0) - s_u(x_i,t_0) $$\n小的正常数 $\\varepsilon$（例如 $10^{-16}$）确保了数值稳定性，避免除以零。当 $w \\neq 0$ 时，我们期望 $\\mathcal{R}_U \\gg 1$，这突出了网格速度项的重要性。对于 $W_0=0$ 的特殊情况，我们期望 $\\mathcal{R}_U \\approx 1$。\n\n**指标 3：$R_{\\mathrm{cpl},\\max}$ (界面耦合残差)**\n该指标检查流固耦合定律的实现情况。\n$$ R_{\\mathrm{cpl},\\max} = \\max_{i} \\left| p(x_i,t_0) - p_{\\mathrm{ext}} - K \\, (A(x_i,t_0) - A_0) \\right| $$\n根据构造，压力 $p(x,t)$ 的人造解被定义为精确满足此关系。因此，在数值评估时，此残差应接近浮点机器精度（即接近于零）。这为 $A$ 和 $p$ 的人造函数的正确实现提供了有价值的合理性检查。\n\n最终的实现将封装这些推导和数值方法，以处理给定的测试用例并生成所需的输出。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fluid-structure interaction verification problem\n    using the Method of Manufactured Solutions.\n    \"\"\"\n\n    def diff_x(f_vals, dx):\n        \"\"\"\n        Computes the spatial derivative on a uniform grid using\n        second-order central differences for the interior and\n        first-order one-sided differences at the boundaries.\n        \"\"\"\n        n = len(f_vals)\n        if n  2:\n            return np.zeros(n)\n        \n        df_dx = np.zeros(n)\n        # Forward difference at i=0\n        df_dx[0] = (f_vals[1] - f_vals[0]) / dx\n        # Backward difference at i=n-1\n        df_dx[-1] = (f_vals[-1] - f_vals[-2]) / dx\n        # Central difference for interior points\n        if n > 2:\n            df_dx[1:-1] = (f_vals[2:] - f_vals[:-2]) / (2 * dx)\n            \n        return df_dx\n\n    def calculate_metrics(params):\n        \"\"\"\n        Calculates the three verification metrics for a single test case.\n        \"\"\"\n        L, R0, rho, K, U0, W0, epsilon_amp, k_str, omega_str, p_ext, N, dt, t0 = params\n        \n        A0 = np.pi * R0**2\n        k = eval(k_str, {\"np\": np, \"pi\": np.pi, \"L\": L})\n        omega = eval(omega_str, {\"np\": np, \"pi\": np.pi})\n\n        # Define grid\n        x_grid = np.linspace(0, L, int(N))\n        dx = L / (int(N) - 1)\n        \n        # Time points for central difference\n        t_plus = t0 + dt\n        t_minus = t0 - dt\n\n        # --- Manufactured Solution Functions  Derivatives ---\n        # Primitives\n        A = lambda x, t: A0 * (1 + epsilon_amp * np.sin(k * x) * np.cos(omega * t))\n        u = lambda x, t: U0 * np.cos(k * x) * np.sin(omega * t)\n        w = lambda x, t: W0 * np.sin(k * x) * np.cos(omega * t)\n        p = lambda x, t: p_ext + K * (A(x, t) - A0)\n\n        # Derivatives\n        dt_A = lambda x, t: -A0 * epsilon_amp * omega * np.sin(k * x) * np.sin(omega * t)\n        dx_A = lambda x, t: A0 * epsilon_amp * k * np.cos(k * x) * np.cos(omega * t)\n        dt_u = lambda x, t: U0 * omega * np.cos(k * x) * np.cos(omega * t)\n        dx_u = lambda x, t: -U0 * k * np.sin(k * x) * np.sin(omega * t)\n        dx_w = lambda x, t: W0 * k * np.cos(k * x) * np.cos(omega * t)\n        dx_p = lambda x, t: K * dx_A(x, t)\n\n        # --- Analytical Source Terms ---\n        def s_A(x, t):\n            A_val, u_val, w_val = A(x, t), u(x, t), w(x, t)\n            dt_A_val, dx_A_val = dt_A(x, t), dx_A(x, t)\n            dx_u_val, dx_w_val = dx_u(x, t), dx_w(x, t)\n            return dt_A_val + dx_A_val * (u_val - w_val) + A_val * (dx_u_val - dx_w_val)\n\n        def s_u(x, t):\n            u_val, w_val = u(x, t), w(x, t)\n            dt_u_val, dx_u_val = dt_u(x, t), dx_u(x, t)\n            dx_p_val = dx_p(x, t)\n            return rho * (dt_u_val + (u_val - w_val) * dx_u_val) + dx_p_val\n        \n        # --- Metric 1: R_A,max (Continuity Residual) ---\n        s_A_vals = s_A(x_grid, t0)\n        \n        A_plus, A_minus = A(x_grid, t_plus), A(x_grid, t_minus)\n        delta_t_A_vals = (A_plus - A_minus) / (2 * dt)\n        \n        A_t0, u_t0, w_t0 = A(x_grid, t0), u(x_grid, t0), w(x_grid, t0)\n        flux_A_vals = A_t0 * (u_t0 - w_t0)\n        delta_x_flux_A_vals = diff_x(flux_A_vals, dx)\n        \n        res_A = delta_t_A_vals + delta_x_flux_A_vals - s_A_vals\n        R_A_max = np.max(np.abs(res_A))\n\n        # --- Metric 2: R_U (Momentum Residual Ratio) ---\n        s_u_vals = s_u(x_grid, t0)\n        \n        u_plus, u_minus = u(x_grid, t_plus), u(x_grid, t_minus)\n        delta_t_u_vals = (u_plus - u_minus) / (2 * dt)\n        \n        p_t0 = p(x_grid, t0)\n        delta_x_p_vals = diff_x(p_t0, dx)\n        \n        delta_x_u_vals = diff_x(u_t0, dx)\n\n        res_U_wrong = rho * (delta_t_u_vals + u_t0 * delta_x_u_vals) + delta_x_p_vals - s_u_vals\n        norm_wrong = np.linalg.norm(res_U_wrong, np.inf)\n\n        res_U_correct = rho * (delta_t_u_vals + (u_t0 - w_t0) * delta_x_u_vals) + delta_x_p_vals - s_u_vals\n        norm_correct = np.linalg.norm(res_U_correct, np.inf)\n\n        epsilon_machine = 1e-16\n        R_U = norm_wrong / (norm_correct + epsilon_machine)\n        \n        # --- Metric 3: R_cpl,max (Coupling Residual) ---\n        res_cpl = p_t0 - p_ext - K * (A_t0 - A0)\n        R_cpl_max = np.max(np.abs(res_cpl))\n        \n        return R_A_max, R_U, R_cpl_max\n\n    # Parameters from problem statement\n    params1 = (0.1, 0.004, 1060, 4e7, 0.2, 0.05, 0.05, '2 * pi / L', '2 * pi * 10', 9e4, 201, 1e-4, 0.037)\n    params2 = (0.1, 0.004, 1060, 4e7, 0.2, 0.0, 0.05, '2 * pi / L', '2 * pi * 10', 9e4, 201, 1e-4, 0.037)\n    params3 = (0.1, 0.004, 1060, 4e7, 0.2, 0.4, 0.05, '2 * pi / L', '2 * pi * 30', 9e4, 401, 5e-5, 0.037)\n    \n    results = []\n    results.extend(calculate_metrics(params1))\n    results.extend(calculate_metrics(params2))\n    results.extend(calculate_metrics(params3))\n    \n    return f\"[{','.join(map(str, results))}]\"\n\n# The original script in the answer tag was a bit malformed. This corrected version runs.\n# The following is the output from this script.\n# [8.59992985165977e-07,3.42436151747806,1.4210854715202004e-11,2.502016550275529e-08,1.0,1.4210854715202004e-11,2.4593453303698016e-05,114.71714578160088,1.4210854715202004e-11]\n```",
            "answer": "[8.59992985165977e-07,3.42436151747806,1.4210854715202004e-11,2.502016550275529e-08,1.0,1.4210854715202004e-11,2.4593453303698016e-05,114.71714578160088,1.4210854715202004e-11]"
        }
    ]
}