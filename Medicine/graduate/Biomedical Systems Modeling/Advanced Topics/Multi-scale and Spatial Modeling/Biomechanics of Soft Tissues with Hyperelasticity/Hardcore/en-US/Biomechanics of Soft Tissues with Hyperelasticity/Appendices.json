{
    "hands_on_practices": [
        {
            "introduction": "Understanding the mechanics of large deformations begins with a solid grasp of kinematics. This first practice establishes the fundamental physical meaning of the Jacobian determinant, $J = \\det(\\mathbf{F})$, by deriving its relationship to local volume change from first principles . Mastering this concept is essential for correctly formulating constitutive models, particularly for distinguishing between compressible and incompressible material behavior.",
            "id": "3873237",
            "problem": "Consider a finite deformation of a soft, hyperelastic tissue modeled as a smooth, orientation-preserving deformation mapping $\\boldsymbol{\\chi}: \\mathcal{B}_{0} \\rightarrow \\mathcal{B}_{t}$, with current position $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X})$ for reference position $\\mathbf{X} \\in \\mathcal{B}_{0}$. The deformation gradient is defined by $\\mathbf{F}(\\mathbf{X}) = \\nabla_{\\! \\mathbf{X}} \\boldsymbol{\\chi}(\\mathbf{X})$. Using only (i) the definition of $\\mathbf{F}$ as the best local linear approximation of $\\boldsymbol{\\chi}$ and (ii) the change-of-variables theorem from multivariable calculus together with conservation of mass for a material volume element, derive the interpretation of the Jacobian $J(\\mathbf{X}) = \\det \\mathbf{F}(\\mathbf{X})$ as the local ratio between the deformed and reference differential volume elements. You may assume smoothness sufficient to justify first-order Taylor expansion of $\\boldsymbol{\\chi}$.\n\nThen, consider a homogeneous simple shear deformation representative of a planar shear test of a nearly incompressible soft tissue, with constant deformation gradient\n$$\n\\mathbf{F} = \n\\begin{bmatrix}\n1 & k & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\nwhere $k \\in \\mathbb{R}$ is the shear parameter. Compute the corresponding Jacobian $J = \\det \\mathbf{F}$.\n\nExpress your final answer as a dimensionless number. No rounding is required; provide the exact value.",
            "solution": "The problem consists of two parts. First, we must derive the physical interpretation of the Jacobian of the deformation gradient, $J = \\det \\mathbf{F}$, as the local ratio of deformed to reference volume elements. The derivation must use the provided definitions and theorems. Second, we must compute the value of $J$ for a specific simple shear deformation.\n\nPart 1: Derivation of the physical interpretation of $J$.\n\nWe are tasked with showing that $J(\\mathbf{X}) = \\frac{dv}{dV}$, where $dV$ is a differential volume element in the reference configuration $\\mathcal{B}_{0}$ centered at a material point $\\mathbf{X}$, and $dv$ is the corresponding differential volume element in the current configuration $\\mathcal{B}_{t}$ into which $dV$ is mapped by the deformation $\\boldsymbol{\\chi}$. The derivation will proceed by invoking the principle of conservation of mass and the change-of-variables theorem for multiple integrals, as specified in the problem statement.\n\nThe principle of conservation of mass states that the mass of a body, or any arbitrary sub-volume of it, remains constant during deformation. Let $\\mathcal{V}_0$ be an arbitrary material sub-volume in the reference configuration $\\mathcal{B}_0$, and let $\\mathcal{V}_t = \\boldsymbol{\\chi}(\\mathcal{V}_0)$ be the corresponding sub-volume in the current configuration $\\mathcal{B}_t$. Let $\\rho_0(\\mathbf{X})$ be the material density field in the reference configuration and $\\rho(\\mathbf{x})$ be the spatial density field in the current configuration. The total mass $m$ of the sub-volume can be expressed as an integral over either configuration:\n$$m = \\int_{\\mathcal{V}_0} \\rho_0(\\mathbf{X}) \\, dV = \\int_{\\mathcal{V}_t} \\rho(\\mathbf{x}) \\, dv$$\nwhere $dV$ is the differential volume element in $\\mathcal{B}_0$ and $dv$ is the differential volume element in $\\mathcal{B}_t$.\n\nThe change-of-variables theorem relates integration over $\\mathcal{V}_t$ to integration over $\\mathcal{V}_0$ via the deformation mapping $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X})$. The theorem states that for an integrable function $f(\\mathbf{x})$:\n$$\\int_{\\mathcal{V}_t} f(\\mathbf{x}) \\, dv = \\int_{\\mathcal{V}_0} f(\\boldsymbol{\\chi}(\\mathbf{X})) |\\det(\\nabla_{\\! \\mathbf{X}} \\boldsymbol{\\chi})| \\, dV$$\nBy definition, the deformation gradient is $\\mathbf{F} = \\nabla_{\\! \\mathbf{X}} \\boldsymbol{\\chi}$, and its determinant is the Jacobian, $J = \\det \\mathbf{F}$. The problem specifies that the deformation is orientation-preserving, which implies $J > 0$. Thus, $|\\det(\\mathbf{F})| = J$. Applying the change-of-variables theorem to the mass integral over the current configuration, we get:\n$$\\int_{\\mathcal{V}_t} \\rho(\\mathbf{x}) \\, dv = \\int_{\\mathcal{V}_0} \\rho(\\boldsymbol{\\chi}(\\mathbf{X})) J(\\mathbf{X}) \\, dV$$\n\nNow, substituting this back into the mass conservation equation:\n$$\\int_{\\mathcal{V}_0} \\rho_0(\\mathbf{X}) \\, dV = \\int_{\\mathcal{V}_0} \\rho(\\boldsymbol{\\chi}(\\mathbf{X})) J(\\mathbf{X}) \\, dV$$\nThis can be rewritten as a single integral:\n$$\\int_{\\mathcal{V}_0} \\left[ \\rho_0(\\mathbf{X}) - \\rho(\\boldsymbol{\\chi}(\\mathbf{X})) J(\\mathbf{X}) \\right] dV = 0$$\nSince this equality must hold for any arbitrary choice of the sub-volume $\\mathcal{V}_0$, and assuming the integrand is a continuous function of $\\mathbf{X}$, the integrand itself must be identically zero throughout the domain $\\mathcal{B}_0$. This gives the local (pointwise) form of the continuity equation in the material description:\n$$\\rho_0(\\mathbf{X}) = \\rho(\\boldsymbol{\\chi}(\\mathbf{X})) J(\\mathbf{X})$$\nFor simplicity, we can write this as $\\rho_0 = \\rho J$.\n\nNow, consider a differential mass element $dm$ associated with a differential volume element $dV$ at point $\\mathbf{X}$ in the reference configuration. Its mass is given by $dm = \\rho_0 dV$. Under the deformation, this same mass element $dm$ occupies the differential volume $dv$ at point $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X})$ in the current configuration. Its mass can also be written as $dm = \\rho dv$.\nEquating the two expressions for the same differential mass element, we have:\n$$\\rho_0 dV = \\rho dv$$\nSubstituting the local mass conservation result, $\\rho_0 = \\rho J$, into this equation yields:\n$$(\\rho J) dV = \\rho dv$$\nAssuming the material has a non-zero density, $\\rho \\neq 0$, we can divide both sides by $\\rho$ to obtain:\n$$J dV = dv$$\nFinally, rearranging this equation gives the desired physical interpretation of the Jacobian $J$ as the local ratio of the deformed to the reference differential volume elements:\n$$J = \\frac{dv}{dV}$$\nThis completes the required derivation.\n\nPart 2: Calculation of the Jacobian for a simple shear deformation.\n\nWe are given the deformation gradient for a homogeneous simple shear deformation as a constant tensor:\n$$\n\\mathbf{F} = \n\\begin{bmatrix}\n1 & k & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}\n$$\nThe Jacobian $J$ is the determinant of this matrix, $J = \\det \\mathbf{F}$. We can compute the determinant of this $3 \\times 3$ matrix. Since $\\mathbf{F}$ is an upper triangular matrix, its determinant is the product of its diagonal entries.\n$$J = \\det(\\mathbf{F}) = (1) \\times (1) \\times (1) = 1$$\nAlternatively, using cofactor expansion along the third row:\n$$J = (0) \\cdot C_{31} + (0) \\cdot C_{32} + (1) \\cdot \\det \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix} = 1 \\cdot ((1)(1) - (k)(0)) = 1$$\nThe result $J=1$ signifies that this specific simple shear deformation is isochoric, meaning it preserves volume. This is consistent with the modeling of nearly incompressible soft tissues. The value is a dimensionless number as required.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "With the kinematics established, we now explore the kinetic consequences of large deformations. This exercise delves into the Poynting effect—a hallmark of nonlinear elasticity where simple shear induces normal stresses—and demonstrates how different hyperelastic constitutive models predict this phenomenon . By comparing the results from neo-Hookean, Mooney-Rivlin, and Gent models, you will gain insight into how the mathematical form of a strain-energy function dictates a material's mechanical signature.",
            "id": "3873240",
            "problem": "Consider a homogeneous simple shear deformation of an incompressible, isotropic hyperelastic soft tissue block. The motion is defined by $\\boldsymbol{x} = \\boldsymbol{X} + k X_{2} \\boldsymbol{e}_{1}$, where $\\boldsymbol{X}$ and $\\boldsymbol{x}$ denote the reference and current position vectors, respectively, $k$ is the scalar shear amount, and $\\boldsymbol{e}_{1}$ is the unit vector along the shear direction. The associated deformation gradient is $\\boldsymbol{F} = \\boldsymbol{I} + k \\boldsymbol{e}_{1} \\otimes \\boldsymbol{e}_{2}$. The sheared faces normal to the $x_{2}$-axis are free of normal traction so that $\\sigma_{22} = 0$ on those faces. Assume incompressibility and the standard constitutive framework for isotropic hyperelastic materials, where the Cauchy stress $\\boldsymbol{\\sigma}$ is obtained from the strain-energy density function $W$ via its derivatives with respect to the first and second invariants $I_{1}$ and $I_{2}$ of the left Cauchy-Green tensor $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$.\n\nStarting from these fundamental definitions, derive the normal stress component $\\sigma_{11}$ induced by simple shear (the Poynting effect) in terms of $k$ and material parameters for each of the following strain-energy functions:\n(i) generalized neo-Hookean $W(I_{1}) = \\frac{\\mu}{2}(I_{1} - 3) + \\frac{\\alpha}{4}(I_{1} - 3)^{2}$ with $\\mu > 0$ and $\\alpha \\ge 0$,\n(ii) Mooney-Rivlin $W(I_{1}, I_{2}) = \\frac{C_{1}}{2}(I_{1} - 3) + \\frac{C_{2}}{2}(I_{2} - 3)$ with $C_{1} > 0$ and $C_{2} \\ge 0$,\n(iii) Gent $W(I_{1}) = -\\frac{\\mu J_{m}}{2} \\ln\\!\\left(1 - \\frac{I_{1} - 3}{J_{m}}\\right)$ with $\\mu > 0$ and $J_{m} > 0$.\n\nUse the traction-free condition on the sheared faces to eliminate the Lagrange multiplier associated with incompressibility. Express your final results solely as functions of $k$ and the model parameters, highlighting how the nonlinearity of $W$ modulates the magnitude of $\\sigma_{11}$. Your final answer must be the single row matrix containing the three resulting analytic expressions for $\\sigma_{11}(k)$, ordered as (i), (ii), (iii). No numerical evaluation or rounding is required, and no units should be included in the final boxed answer.",
            "solution": "The problem describes the simple shear of an incompressible, isotropic hyperelastic material. The goal is to derive the normal stress component $\\sigma_{11}$ induced by this shear, known as the Poynting effect, for three different strain-energy functions. We begin with the general framework of nonlinear continuum mechanics.\n\nThe deformation is defined by the motion $\\boldsymbol{x} = \\boldsymbol{X} + k X_{2} \\boldsymbol{e}_{1}$. The corresponding deformation gradient tensor $\\boldsymbol{F}$ is given as $\\boldsymbol{F} = \\boldsymbol{I} + k \\boldsymbol{e}_{1} \\otimes \\boldsymbol{e}_{2}$. In a Cartesian basis $\\{\\boldsymbol{e}_{1}, \\boldsymbol{e}_{2}, \\boldsymbol{e}_{3}\\}$, its matrix representation is:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} 1 & k & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe material is incompressible, which requires $\\det(\\boldsymbol{F}) = 1$. Indeed, $\\det(\\boldsymbol{F}) = (1)(1) - (k)(0) = 1$, so the constraint is satisfied.\n\nThe left Cauchy-Green deformation tensor, $\\boldsymbol{B}$, is defined as $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$.\n$$\n\\boldsymbol{B} = \\begin{pmatrix} 1 & k & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ k & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1+k^{2} & k & 0 \\\\ k & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe principal invariants of $\\boldsymbol{B}$ are required. For an incompressible material, the third invariant $I_{3} = \\det(\\boldsymbol{B}) = (\\det(\\boldsymbol{F}))^{2} = 1^{2} = 1$. The first and second invariants, $I_{1}$ and $I_{2}$, are:\n$$\nI_{1} = \\mathrm{tr}(\\boldsymbol{B}) = (1+k^{2}) + 1 + 1 = 3+k^{2}\n$$\n$$\nI_{2} = \\frac{1}{2} \\left[ (\\mathrm{tr}(\\boldsymbol{B}))^{2} - \\mathrm{tr}(\\boldsymbol{B}^{2}) \\right]\n$$\nFor incompressible materials, $I_{2}$ can also be calculated as $I_{2} = I_{3} \\mathrm{tr}(\\boldsymbol{B}^{-1}) = \\mathrm{tr}(\\boldsymbol{B}^{-1})$. The inverse of $\\boldsymbol{B}$ is:\n$$\n\\boldsymbol{B}^{-1} = \\frac{1}{\\det(\\boldsymbol{B})} \\mathrm{adj}(\\boldsymbol{B}) = \\begin{pmatrix} 1 & -k & 0 \\\\ -k & 1+k^{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThen, $I_{2}$ is:\n$$\nI_{2} = \\mathrm{tr}(\\boldsymbol{B}^{-1}) = 1 + (1+k^{2}) + 1 = 3+k^{2}\n$$\nThus, for simple shear, we have the notable result that $I_{1} = I_{2} = 3+k^{2}$.\n\nThe Cauchy stress tensor $\\boldsymbol{\\sigma}$ for an incompressible isotropic hyperelastic material is given by:\n$$\n\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2 \\frac{\\partial W}{\\partial I_{1}} \\boldsymbol{B} - 2 \\frac{\\partial W}{\\partial I_{2}} \\boldsymbol{B}^{-1}\n$$\nwhere $p$ is the indeterminate hydrostatic pressure (a Lagrange multiplier enforcing incompressibility), and $W(I_{1}, I_{2})$ is the strain-energy density function.\n\nLet's write out the relevant components of the stress tensor:\n$$\n\\sigma_{11} = -p + 2 \\frac{\\partial W}{\\partial I_{1}} B_{11} - 2 \\frac{\\partial W}{\\partial I_{2}} B_{11}^{-1} = -p + 2 \\frac{\\partial W}{\\partial I_{1}} (1+k^{2}) - 2 \\frac{\\partial W}{\\partial I_{2}} (1)\n$$\n$$\n\\sigma_{22} = -p + 2 \\frac{\\partial W}{\\partial I_{1}} B_{22} - 2 \\frac{\\partial W}{\\partial I_{2}} B_{22}^{-1} = -p + 2 \\frac{\\partial W}{\\partial I_{1}} (1) - 2 \\frac{\\partial W}{\\partial I_{2}} (1+k^{2})\n$$\nThe problem specifies that the sheared faces, normal to the $\\boldsymbol{e}_{2}$ direction, are free of normal traction. This implies the boundary condition $\\sigma_{22} = 0$. We use this condition to determine $p$:\n$$\n0 = -p + 2 \\frac{\\partial W}{\\partial I_{1}} - 2 \\frac{\\partial W}{\\partial I_{2}} (1+k^{2}) \\implies p = 2 \\frac{\\partial W}{\\partial I_{1}} - 2 \\frac{\\partial W}{\\partial I_{2}} (1+k^{2})\n$$\nNow, substitute this expression for $p$ back into the equation for $\\sigma_{11}$:\n$$\n\\sigma_{11} = -\\left(2 \\frac{\\partial W}{\\partial I_{1}} - 2 \\frac{\\partial W}{\\partial I_{2}} (1+k^{2})\\right) + 2 \\frac{\\partial W}{\\partial I_{1}} (1+k^{2}) - 2 \\frac{\\partial W}{\\partial I_{2}}\n$$\n$$\n\\sigma_{11} = -2\\frac{\\partial W}{\\partial I_{1}} + 2\\frac{\\partial W}{\\partial I_{1}}(1+k^{2}) + 2\\frac{\\partial W}{\\partial I_{2}}(1+k^{2}) - 2\\frac{\\partial W}{\\partial I_{2}}\n$$\n$$\n\\sigma_{11} = 2\\frac{\\partial W}{\\partial I_{1}} (-1 + 1+k^{2}) + 2\\frac{\\partial W}{\\partial I_{2}} (1+k^{2}-1)\n$$\n$$\n\\sigma_{11} = 2k^{2} \\left( \\frac{\\partial W}{\\partial I_{1}} + \\frac{\\partial W}{\\partial I_{2}} \\right)\n$$\nThis is the general expression for the normal stress $\\sigma_{11}$ in simple shear under the condition $\\sigma_{22}=0$. The derivatives of $W$ must be evaluated at $I_{1}=I_{2}=3+k^{2}$. This result highlights how the Poynting effect depends on the amount of shear $k$ and the material's constitutive response.\n\nWe now apply this general formula to the three specified strain-energy functions.\n\n(i) Generalized neo-Hookean model: $W(I_{1}) = \\frac{\\mu}{2}(I_{1} - 3) + \\frac{\\alpha}{4}(I_{1} - 3)^{2}$.\nThis model is independent of $I_{2}$, so $\\frac{\\partial W}{\\partial I_{2}} = 0$. The derivative with respect to $I_{1}$ is:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{\\mu}{2} + \\frac{\\alpha}{2}(I_{1} - 3)\n$$\nSubstituting $I_{1} = 3+k^{2}$:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{\\mu}{2} + \\frac{\\alpha}{2}((3+k^{2}) - 3) = \\frac{\\mu}{2} + \\frac{\\alpha}{2}k^{2}\n$$\nThe normal stress $\\sigma_{11}$ is then:\n$$\n\\sigma_{11} = 2k^{2} \\left( \\frac{\\mu}{2} + \\frac{\\alpha}{2}k^{2} + 0 \\right) = \\mu k^{2} + \\alpha k^{4}\n$$\nThe nonlinearity in $W$ (the $\\alpha$ term) introduces a $k^{4}$ dependence, causing a shear-stiffening normal stress response that grows faster than quadratically with shear. For $\\alpha=0$, we recover the standard neo-Hookean result $\\sigma_{11} = \\mu k^{2}$.\n\n(ii) Mooney-Rivlin model: $W(I_{1}, I_{2}) = \\frac{C_{1}}{2}(I_{1} - 3) + \\frac{C_{2}}{2}(I_{2} - 3)$.\nThe derivatives are constants:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{C_{1}}{2}, \\quad \\frac{\\partial W}{\\partial I_{2}} = \\frac{C_{2}}{2}\n$$\nSubstituting these into the general expression for $\\sigma_{11}$:\n$$\n\\sigma_{11} = 2k^{2} \\left( \\frac{C_{1}}{2} + \\frac{C_{2}}{2} \\right) = (C_{1} + C_{2})k^{2}\n$$\nIn this case, even though $W$ depends on both invariants, the normal stress $\\sigma_{11}$ remains purely quadratic in the amount of shear $k$. The magnitude is determined by the sum of the material parameters $C_{1}$ and $C_{2}$.\n\n(iii) Gent model: $W(I_{1}) = -\\frac{\\mu J_{m}}{2} \\ln\\!\\left(1 - \\frac{I_{1} - 3}{J_{m}}\\right)$.\nThis model is independent of $I_{2}$, so $\\frac{\\partial W}{\\partial I_{2}} = 0$. The derivative with respect to $I_{1}$ is:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = -\\frac{\\mu J_{m}}{2} \\cdot \\frac{1}{1 - \\frac{I_{1}-3}{J_{m}}} \\cdot \\left(-\\frac{1}{J_{m}}\\right) = \\frac{\\mu}{2} \\frac{1}{\\frac{J_{m} - (I_{1}-3)}{J_{m}}} = \\frac{\\mu J_{m}}{2(J_{m} - I_{1} + 3)}\n$$\nSubstituting $I_{1} = 3+k^{2}$:\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{\\mu J_{m}}{2(J_{m} - (3+k^{2}) + 3)} = \\frac{\\mu J_{m}}{2(J_{m} - k^{2})}\n$$\nThe normal stress $\\sigma_{11}$ is:\n$$\n\\sigma_{11} = 2k^{2} \\left( \\frac{\\mu J_{m}}{2(J_{m} - k^{2})} + 0 \\right) = \\frac{\\mu J_{m} k^{2}}{J_{m} - k^{2}}\n$$\nThe Gent model exhibits a strong nonlinear dependence on $k$. As the shear term $k^{2}$ approaches the material parameter $J_{m}$, the denominator approaches zero, and $\\sigma_{11}$ tends towards infinity. This represents the chain-locking effect in polymer networks, where the material becomes infinitely stiff at a limiting strain.\n\nThe three derived expressions for $\\sigma_{11}$ are collected in a row matrix as the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu k^{2} + \\alpha k^{4} & (C_{1} + C_{2})k^{2} & \\frac{\\mu J_{m} k^{2}}{J_{m} - k^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The final practice bridges theory and computational application, a critical skill in modern biomechanics. This exercise guides you through the implementation of the essential mechanics for handling boundary interactions in a large-deformation finite element context . You will apply Nanson's relation to map surface normals and areas, compute boundary tractions from a compressible neo-Hookean model, and enforce physical contact constraints, solidifying your understanding of how continuum principles are translated into numerical code.",
            "id": "3873184",
            "problem": "You are tasked with designing and implementing a program that computes boundary tractions and enforces essential boundary conditions for a hyperelastic soft tissue undergoing large deformation, by correctly mapping surface normals and areas between the undeformed (reference) and deformed (current) configurations. Your solution must start from fundamental continuum mechanics principles and well-established hyperelastic constitutive modeling. The tissue is modeled as a compressible neo-Hookean material. The program must operate purely on the mathematical constructs specified here and produce quantitatively testable outputs.\n\nFundamental base and modeling assumptions:\n- Let the deformation gradient be denoted by $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$, with Jacobian determinant $J = \\det(\\mathbf{F})$ and identity tensor $\\mathbf{I} \\in \\mathbb{R}^{3 \\times 3}$.\n- The left Cauchy-Green tensor is $\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\top}$.\n- The strain energy density for a compressible neo-Hookean material is given by\n$$\nW(\\mathbf{F}) = \\frac{\\mu}{2} \\left( I_1 - 3 \\right) - \\mu \\ln(J) + \\frac{\\kappa}{2} \\left( \\ln(J) \\right)^2,\n$$\nwhere $I_1 = \\mathrm{tr}(\\mathbf{C})$ and $\\mathbf{C} = \\mathbf{F}^{\\top} \\mathbf{F}$, with $\\mu$ the shear modulus and $\\kappa$ the bulk modulus. The Cauchy stress tensor follows from $W(\\mathbf{F})$ via standard hyperelasticity.\n- Traction acting on a surface in the current configuration is defined as the Cauchy stress vector $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress and $\\mathbf{n}$ is the outward unit normal in the current configuration.\n- The reference surface unit normal is $\\mathbf{N}$, and the reference area is $A_{\\mathrm{ref}}$.\n- For essential (Dirichlet) boundary conditions that restrict motion through the boundary in large deformation, enforce zero motion normal to the deformed surface by removing the component of displacement along the current unit normal $\\mathbf{n}$.\n\nRequired computations for each test case:\n1. Map the reference surface normal and area to the current configuration under large deformation. Use continuum principles that relate the deformation gradient to the transformation of surface orientation and area.\n2. Compute the Cauchy stress tensor $\\boldsymbol{\\sigma}$ from the strain energy function $W(\\mathbf{F})$ for the compressible neo-Hookean model.\n3. Compute the current traction vector $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$ and its magnitude.\n4. Enforce the essential boundary condition \"no motion through the boundary\" by correcting a given trial displacement $\\mathbf{u}_{\\mathrm{trial}}$ via projection that removes its component along the current unit normal $\\mathbf{n}$. Report the magnitude of the corrected displacement vector $\\mathbf{u}_{\\mathrm{corr}}$.\n5. Verify force consistency between the reference and current configurations by comparing forces obtained from nominal and Cauchy descriptions for the same surface patch. Report a boolean indicating whether they match within a small numerical tolerance.\n\nPhysical units and reporting:\n- Report areas in $\\mathrm{m}^2$, stresses and traction magnitudes in $\\mathrm{Pa}$, and displacement magnitudes in $\\mathrm{m}$.\n- All angles provided are in radians.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list with the following entries:\n[$A_{\\mathrm{cur}}$, $n_x$, $n_y$, $n_z$, $\\|t\\|$, $\\|u_{\\mathrm{corr}}\\|$, force\\_match],\nwhere $A_{\\mathrm{cur}}$ is the current area, $(n_x,n_y,n_z)$ are the components of the current unit normal, $\\|t\\|$ is the traction magnitude, $\\|u_{\\mathrm{corr}}\\|$ is the corrected displacement magnitude, and force\\_match is a boolean indicating whether the reference and current force computations agree within tolerance.\n\nTest suite:\nProvide computations for the following scientifically plausible test cases that cover a general case, pure rotation (boundary condition mapping edge case), uniaxial stretch, and nearly incompressible shear:\n\n- Test case $1$ (general shear-stretch):\n  - $\\mathbf{F} = \\begin{bmatrix} 1.2 & 0.1 & 0.0 \\\\ 0.0 & 1.1 & 0.2 \\\\ 0.0 & 0.0 & 0.9 \\end{bmatrix}$,\n  - $\\mu = 6.0 \\times 10^{4}~\\mathrm{Pa}$,\n  - $\\kappa = 2.0 \\times 10^{6}~\\mathrm{Pa}$,\n  - $\\mathbf{N} = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $A_{\\mathrm{ref}} = 1.0 \\times 10^{-2}~\\mathrm{m}^2$,\n  - $\\mathbf{u}_{\\mathrm{trial}} = \\begin{bmatrix} 2.0 \\times 10^{-3} \\\\ -1.0 \\times 10^{-3} \\\\ 5.0 \\times 10^{-4} \\end{bmatrix}~\\mathrm{m}$.\n\n- Test case $2$ (pure rotation about $z$-axis with angle $\\theta$):\n  - $\\theta = \\pi / 6~\\mathrm{rad}$,\n  - $\\mathbf{F} = \\begin{bmatrix} \\cos(\\theta) & -\\sin(\\theta) & 0.0 \\\\ \\sin(\\theta) & \\cos(\\theta) & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$,\n  - $\\mu = 8.0 \\times 10^{4}~\\mathrm{Pa}$,\n  - $\\kappa = 1.0 \\times 10^{6}~\\mathrm{Pa}$,\n  - $\\mathbf{N} = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $A_{\\mathrm{ref}} = 2.0 \\times 10^{-2}~\\mathrm{m}^2$,\n  - $\\mathbf{u}_{\\mathrm{trial}} = \\begin{bmatrix} -1.0 \\times 10^{-3} \\\\ 1.5 \\times 10^{-3} \\\\ 0.0 \\end{bmatrix}~\\mathrm{m}$.\n\n- Test case $3$ (uniaxial stretch along $z$ direction):\n  - $\\mathbf{F} = \\mathrm{diag}\\left(1.0, 1.0, 1.3\\right)$,\n  - $\\mu = 5.0 \\times 10^{4}~\\mathrm{Pa}$,\n  - $\\kappa = 5.0 \\times 10^{6}~\\mathrm{Pa}$,\n  - $\\mathbf{N} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 1.0 \\end{bmatrix}$,\n  - $A_{\\mathrm{ref}} = 1.5 \\times 10^{-2}~\\mathrm{m}^2$,\n  - $\\mathbf{u}_{\\mathrm{trial}} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 2.0 \\times 10^{-3} \\end{bmatrix}~\\mathrm{m}$.\n\n- Test case $4$ (nearly incompressible simple shear in $x$-$y$ plane):\n  - $\\mathbf{F} = \\begin{bmatrix} 1.0 & 0.5 & 0.0 \\\\ 0.0 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$,\n  - $\\mu = 1.0 \\times 10^{5}~\\mathrm{Pa}$,\n  - $\\kappa = 1.0 \\times 10^{7}~\\mathrm{Pa}$,\n  - $\\mathbf{N} = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$,\n  - $A_{\\mathrm{ref}} = 1.0 \\times 10^{-2}~\\mathrm{m}^2$,\n  - $\\mathbf{u}_{\\mathrm{trial}} = \\begin{bmatrix} 1.0 \\times 10^{-3} \\\\ 2.0 \\times 10^{-3} \\\\ -5.0 \\times 10^{-4} \\end{bmatrix}~\\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case. Each entry must be a list in the order [$A_{\\mathrm{cur}}$, $n_x$, $n_y$, $n_z$, $\\|t\\|$, $\\|u_{\\mathrm{corr}}\\|$, force\\_match], for the test cases $1$ through $4$ specified above.",
            "solution": "We begin from continuum mechanics definitions and hyperelastic constitutive modeling, and derive the required mappings and computational procedure.\n\nKinematics and area-normal mapping:\n- The deformation gradient is $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$, mapping reference coordinates $\\mathbf{X}$ to current coordinates $\\mathbf{x}$. Its determinant $J = \\det(\\mathbf{F})$ quantifies local volume change. Covectors (such as normals) transform via the inverse transpose under push-forward. Considering a differential oriented area in the reference configuration, the area vector is $\\mathbf{N} \\, \\mathrm{d}A$, and in the current configuration it is $\\mathbf{n} \\, \\mathrm{d}a$. From conservation of matter and the geometric transformation of surfaces under $\\mathbf{F}$, the classical Nanson’s relation is obtained:\n$$\n\\mathbf{n} \\, \\mathrm{d}a = J \\, \\mathbf{F}^{-\\top} \\mathbf{N} \\, \\mathrm{d}A.\n$$\nThis implies that the current (spatial) area magnitude and unit normal are given by\n$$\n\\mathrm{d}a = \\mathrm{d}A \\, \\left\\| J \\, \\mathbf{F}^{-\\top} \\mathbf{N} \\right\\|, \\quad\n\\mathbf{n} = \\frac{J \\, \\mathbf{F}^{-\\top} \\mathbf{N}}{\\left\\| J \\, \\mathbf{F}^{-\\top} \\mathbf{N} \\right\\|}.\n$$\nThus, for a finite patch with reference area $A_{\\mathrm{ref}}$, the current area is $A_{\\mathrm{cur}} = A_{\\mathrm{ref}} \\, \\left\\| J \\, \\mathbf{F}^{-\\top} \\mathbf{N} \\right\\|$ and the current unit normal is the normalized push-forward of the reference normal covector.\n\nHyperelastic constitutive law and Cauchy stress:\n- The compressible neo-Hookean strain energy function is\n$$\nW(\\mathbf{F}) = \\frac{\\mu}{2} \\left( I_1 - 3 \\right) - \\mu \\ln(J) + \\frac{\\kappa}{2} \\left( \\ln(J) \\right)^2,\n$$\nwith $I_1 = \\mathrm{tr}(\\mathbf{C})$ and $\\mathbf{C} = \\mathbf{F}^{\\top} \\mathbf{F}$. The First Piola–Kirchhoff stress is $\\mathbf{P} = \\frac{\\partial W}{\\partial \\mathbf{F}}$. For this model, after standard derivation using tensor calculus and invariants, the Cauchy stress $\\boldsymbol{\\sigma}$ can be expressed in terms of $\\mathbf{F}$ as\n$$\n\\boldsymbol{\\sigma} = \\frac{\\mu}{J} \\left( \\mathbf{B} - \\mathbf{I} \\right) + \\frac{\\kappa \\, \\ln(J)}{J} \\, \\mathbf{I},\n$$\nwhere $\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\top}$ is the left Cauchy–Green tensor. This follows from the general relation $\\boldsymbol{\\sigma} = \\frac{1}{J} \\mathbf{P} \\mathbf{F}^{\\top}$ for hyperelastic materials together with $\\mathbf{P}$ derived from $W(\\mathbf{F})$.\n\nTraction and force consistency:\n- The traction vector acting on the current surface is defined by $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$. The differential force on the surface patch in the current configuration is $\\mathbf{t} \\, \\mathrm{d}a$. In the reference configuration, the nominal traction is $\\mathbf{P} \\mathbf{N}$, and the corresponding force is $\\mathbf{P} \\mathbf{N} \\, \\mathrm{d}A$. Using Nanson’s relation and the relationship between $\\mathbf{P}$ and $\\boldsymbol{\\sigma}$, one obtains the force equivalence\n$$\n\\mathbf{t} \\, \\mathrm{d}a = \\mathbf{P} \\mathbf{N} \\, \\mathrm{d}A,\n$$\nwhich provides a consistency check. For a finite patch, we compute $\\mathbf{f}_{\\mathrm{cur}} = \\mathbf{t} \\, A_{\\mathrm{cur}}$ and $\\mathbf{f}_{\\mathrm{ref}} = (\\mathbf{P} \\mathbf{N}) \\, A_{\\mathrm{ref}}$ and verify that they match within numerical tolerance.\n\nEssential boundary condition enforcement under large deformation:\n- A common essential boundary condition is to prevent motion through a boundary surface under large deformation. Physically, this constrains the normal component of displacement (or velocity) at the current configuration to be zero. Given an unconstrained trial displacement $\\mathbf{u}_{\\mathrm{trial}}$, the corrected displacement $\\mathbf{u}_{\\mathrm{corr}}$ that enforces zero normal motion is obtained by removing the component along the current unit normal $\\mathbf{n}$:\n$$\n\\mathbf{u}_{\\mathrm{corr}} = \\mathbf{u}_{\\mathrm{trial}} - \\left( \\mathbf{u}_{\\mathrm{trial}} \\cdot \\mathbf{n} \\right) \\mathbf{n}.\n$$\nThis projection enforces $\\mathbf{u}_{\\mathrm{corr}} \\cdot \\mathbf{n} = 0$ while preserving the tangential components, consistent with the physical impenetrability of the boundary.\n\nAlgorithmic procedure for each test case:\n1. Read $\\mathbf{F}$, compute $J = \\det(\\mathbf{F})$, $\\mathbf{F}^{-\\top}$, and $\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\top}$.\n2. Compute the Cauchy stress\n$$\n\\boldsymbol{\\sigma} = \\frac{\\mu}{J} \\left( \\mathbf{B} - \\mathbf{I} \\right) + \\frac{\\kappa \\ln(J)}{J} \\mathbf{I}.\n$$\n3. Given unit reference normal $\\mathbf{N}$ and reference area $A_{\\mathrm{ref}}$, compute\n$$\n\\mathbf{q} = J \\, \\mathbf{F}^{-\\top} \\mathbf{N}, \\quad \\mathbf{n} = \\frac{\\mathbf{q}}{\\|\\mathbf{q}\\|}, \\quad A_{\\mathrm{cur}} = A_{\\mathrm{ref}} \\, \\|\\mathbf{q}\\|.\n$$\n4. Compute traction $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$ and its magnitude $\\|\\mathbf{t}\\|$.\n5. Compute corrected displacement $\\mathbf{u}_{\\mathrm{corr}} = \\mathbf{u}_{\\mathrm{trial}} - (\\mathbf{u}_{\\mathrm{trial}} \\cdot \\mathbf{n}) \\mathbf{n}$ and report $\\|\\mathbf{u}_{\\mathrm{corr}}\\|$.\n6. Compute $\\mathbf{P} = J \\, \\boldsymbol{\\sigma} \\, \\mathbf{F}^{-\\top}$, then forces $\\mathbf{f}_{\\mathrm{cur}} = \\mathbf{t} \\, A_{\\mathrm{cur}}$ and $\\mathbf{f}_{\\mathrm{ref}} = (\\mathbf{P} \\mathbf{N}) \\, A_{\\mathrm{ref}}$. Check whether $\\| \\mathbf{f}_{\\mathrm{cur}} - \\mathbf{f}_{\\mathrm{ref}} \\|$ is below a small tolerance (for instance a relative tolerance proportional to $\\max(1, \\|\\mathbf{f}_{\\mathrm{cur}}\\|)$), and report the boolean.\n\nUnits and output:\n- Areas are in $\\mathrm{m}^2$, stresses and traction magnitudes in $\\mathrm{Pa}$, and displacement magnitudes in $\\mathrm{m}$.\n- Each test case outputs the list [$A_{\\mathrm{cur}}$, $n_x$, $n_y$, $n_z$, $\\|t\\|$, $\\|u_{\\mathrm{corr}}\\|$, force\\_match], and the program prints a single-line list of the four test case results.\n\nThis procedure ensures scientifically realistic computation of boundary tractions and enforcement of essential boundary conditions under large deformations, grounded in fundamental kinematics, hyperelastic constitutive equations, and geometric mappings between configurations.",
            "answer": "```python\nimport numpy as np\n\ndef compute_sigma(F, mu, kappa):\n    \"\"\"\n    Compute Cauchy stress for compressible neo-Hookean material:\n    sigma = (mu/J)*(b - I) + (kappa*ln(J)/J)*I\n    \"\"\"\n    J = np.linalg.det(F)\n    if J <= 0:\n        raise ValueError(\"Jacobian determinant J must be positive for physical deformation.\")\n    b = F @ F.T\n    I = np.eye(3)\n    sigma = (mu / J) * (b - I) + (kappa * np.log(J) / J) * I\n    return sigma, J\n\ndef map_normal_and_area(F, J, N, A_ref):\n    \"\"\"\n    Map reference unit normal N and reference area A_ref to current configuration using Nanson's relation:\n    q = J * F^{-T} * N\n    n = q / ||q||\n    A_cur = A_ref * ||q||\n    \"\"\"\n    FinvT = np.linalg.inv(F).T\n    q = J * (FinvT @ N)\n    norm_q = np.linalg.norm(q)\n    if norm_q == 0:\n        raise ValueError(\"Mapped normal vector has zero magnitude, check F and N.\")\n    n = q / norm_q\n    A_cur = A_ref * norm_q\n    return n, A_cur\n\ndef enforce_no_normal_motion(u_trial, n):\n    \"\"\"\n    Enforce essential BC: zero motion through the boundary by removing normal component.\n    u_corr = u_trial - (u_trial · n) n\n    \"\"\"\n    u_dot_n = float(np.dot(u_trial, n))\n    u_corr = u_trial - u_dot_n * n\n    return u_corr\n\ndef compute_first_piola(F, sigma, J):\n    \"\"\"\n    Compute First Piola-Kirchhoff stress from Cauchy stress:\n    P = J * sigma * F^{-T}\n    \"\"\"\n    FinvT = np.linalg.inv(F).T\n    P = J * (sigma @ FinvT)\n    return P\n\ndef forces_consistency(t, A_cur, P, N, A_ref, tol_factor=1e-9):\n    \"\"\"\n    Check t*A_cur == (P N)*A_ref within tolerance.\n    \"\"\"\n    f_cur = t * A_cur\n    f_ref = (P @ N) * A_ref\n    diff = np.linalg.norm(f_cur - f_ref)\n    scale = max(1.0, np.linalg.norm(f_cur))\n    return diff <= tol_factor * scale\n\ndef solve():\n    # Define test cases per the problem statement.\n    # Each test case is a dict with keys: F or theta, mu, kappa, N, A_ref, u_trial.\n    test_cases = []\n\n    # Test case 1: general shear-stretch\n    F1 = np.array([[1.2, 0.1, 0.0],\n                   [0.0, 1.1, 0.2],\n                   [0.0, 0.0, 0.9]])\n    mu1 = 6.0e4\n    kappa1 = 2.0e6\n    N1 = np.array([0.0, 1.0, 0.0])\n    A_ref1 = 1.0e-2\n    u_trial1 = np.array([2.0e-3, -1.0e-3, 5.0e-4])\n    test_cases.append({\"F\": F1, \"mu\": mu1, \"kappa\": kappa1, \"N\": N1, \"A_ref\": A_ref1, \"u_trial\": u_trial1})\n\n    # Test case 2: pure rotation about z with angle theta = pi/6\n    theta2 = np.pi / 6.0\n    cos_t = np.cos(theta2)\n    sin_t = np.sin(theta2)\n    F2 = np.array([[cos_t, -sin_t, 0.0],\n                   [sin_t,  cos_t, 0.0],\n                   [0.0,    0.0,   1.0]])\n    mu2 = 8.0e4\n    kappa2 = 1.0e6\n    N2 = np.array([1.0, 0.0, 0.0])\n    A_ref2 = 2.0e-2\n    u_trial2 = np.array([-1.0e-3, 1.5e-3, 0.0])\n    test_cases.append({\"F\": F2, \"mu\": mu2, \"kappa\": kappa2, \"N\": N2, \"A_ref\": A_ref2, \"u_trial\": u_trial2})\n\n    # Test case 3: uniaxial stretch along z direction\n    F3 = np.diag([1.0, 1.0, 1.3])\n    mu3 = 5.0e4\n    kappa3 = 5.0e6\n    N3 = np.array([0.0, 0.0, 1.0])\n    A_ref3 = 1.5e-2\n    u_trial3 = np.array([0.0, 0.0, 2.0e-3])\n    test_cases.append({\"F\": F3, \"mu\": mu3, \"kappa\": kappa3, \"N\": N3, \"A_ref\": A_ref3, \"u_trial\": u_trial3})\n\n    # Test case 4: nearly incompressible simple shear in x-y plane\n    F4 = np.array([[1.0, 0.5, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]])\n    mu4 = 1.0e5\n    kappa4 = 1.0e7\n    N4 = np.array([0.0, 1.0, 0.0])\n    A_ref4 = 1.0e-2\n    u_trial4 = np.array([1.0e-3, 2.0e-3, -5.0e-4])\n    test_cases.append({\"F\": F4, \"mu\": mu4, \"kappa\": kappa4, \"N\": N4, \"A_ref\": A_ref4, \"u_trial\": u_trial4})\n\n    results = []\n    for case in test_cases:\n        F = case[\"F\"]\n        mu = case[\"mu\"]\n        kappa = case[\"kappa\"]\n        N = case[\"N\"]\n        # Ensure N is unit\n        N_norm = np.linalg.norm(N)\n        if N_norm == 0.0:\n            raise ValueError(\"Reference normal N must be nonzero.\")\n        N_unit = N / N_norm\n        A_ref = case[\"A_ref\"]\n        u_trial = case[\"u_trial\"]\n\n        # Compute stress and Jacobian\n        sigma, J = compute_sigma(F, mu, kappa)\n\n        # Map normal and area\n        n, A_cur = map_normal_and_area(F, J, N_unit, A_ref)\n\n        # Traction\n        t = sigma @ n\n        t_norm = float(np.linalg.norm(t))\n\n        # Enforce essential BC: no normal motion\n        u_corr = enforce_no_normal_motion(u_trial, n)\n        u_corr_norm = float(np.linalg.norm(u_corr))\n\n        # Force consistency check\n        P = compute_first_piola(F, sigma, J)\n        force_match = forces_consistency(t, A_cur, P, N_unit, A_ref)\n\n        # Append result for this case: [A_cur, n_x, n_y, n_z, ||t||, ||u_corr||, force_match]\n        results.append([float(A_cur), float(n[0]), float(n[1]), float(n[2]), t_norm, u_corr_norm, force_match])\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists, comma-separated.\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}