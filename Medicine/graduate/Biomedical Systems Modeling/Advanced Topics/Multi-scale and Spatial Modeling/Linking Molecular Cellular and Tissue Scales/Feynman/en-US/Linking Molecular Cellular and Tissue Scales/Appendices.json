{
    "hands_on_practices": [
        {
            "introduction": "This first practice provides a foundational exercise in deriving and applying a continuum model to a tissue-scale problem. By starting from the fundamental principle of mass conservation, you will model the diffusion and consumption of oxygen in a tumor spheroid, directly linking cellular metabolic activity to the emergence of hypoxic regions. This exercise  demonstrates the power of reaction-diffusion equations in bridging the gap between cellular function and tissue-level environmental gradients.",
            "id": "3898110",
            "problem": "A multicellular tumor spheroid of radius $R$ is embedded in well-oxygenated tissue. Oxygen is supplied by diffusion from the spheroid surface at radius $r=R$ where the oxygen concentration is maintained at $c(R)=c_{\\mathrm{ext}}$. Cells within the spheroid consume oxygen. Link molecular-scale consumption to a tissue-scale model and derive the steady-state radial oxygen concentration profile $c(r)$ under spherical symmetry, then compute the radius $r_{\\mathrm{h}}$ at which $c(r)$ first falls to a prescribed hypoxia threshold $c_{\\mathrm{h}}$.\n\nAssumptions and starting points:\n- The conservation of mass for oxygen combined with Fick’s first law implies the governing partial differential equation (PDE) $\\partial c/\\partial t = D \\nabla^{2} c - q(c)$, where $c$ is oxygen concentration, $D$ is the oxygen diffusivity, and $q(c)$ is the volumetric consumption rate.\n- The cellular oxygen uptake follows a Michaelis–Menten (MM) form at the molecular scale, with single-cell maximum uptake $v_{\\max}$ and Michaelis constant $K_{m}$. For a uniform cell number density $\\rho$ and in the regime $c \\gg K_{m}$, approximate $q(c)$ by a constant $q \\approx \\rho\\, v_{\\max}$.\n- At steady state with spherical symmetry, and for $0 \\le r \\le R$, consumption is spatially uniform and equal to $q$.\n- Boundary conditions: $c(R)=c_{\\mathrm{ext}}$ and $c(r)$ remains finite at $r=0$.\n\nTasks:\n1. Starting from the conservation law and Fick’s first law, specialize to steady state under spherical symmetry and derive the ordinary differential equation for $c(r)$ and its general solution subject to the stated boundary conditions. Express your result for $c(r)$ in terms of $D$, $q$, $R$, and $c_{\\mathrm{ext}}$.\n2. Define the hypoxic radius $r_{\\mathrm{h}}$ implicitly by $c(r_{\\mathrm{h}})=c_{\\mathrm{h}}$ with $0 < c_{\\mathrm{h}} < c_{\\mathrm{ext}}$. Using your result from part $1$, derive a closed-form expression for $r_{\\mathrm{h}}$ in terms of $D$, $q$, $R$, $c_{\\mathrm{ext}}$, and $c_{\\mathrm{h}}$. State the condition under which a real-valued $r_{\\mathrm{h}}$ exists within the spheroid.\n3. Compute $r_{\\mathrm{h}}$ for $D = 2.0 \\times 10^{-9}$ m$^{2}$/s, $q = 5.0 \\times 10^{-3}$ mol m$^{-3}$ s$^{-1}$, $R = 8.00 \\times 10^{-4}$ m, $c_{\\mathrm{ext}} = 0.20$ mol m$^{-3}$, and $c_{\\mathrm{h}} = 0.020$ mol m$^{-3}$. Express your final numerical answer in micrometers and round to three significant figures.\n\nYour final answer must be a single real number equal to the hypoxic radius in micrometers, rounded as specified. Do not include units in your final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. It represents a classic problem in transport phenomena within biological systems, specifically modeling oxygen diffusion and consumption in a tumor spheroid. The provided assumptions and data are consistent and physically realistic. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe solution is structured into three parts as requested by the problem statement.\n\n**Part 1: Derivation of the Oxygen Concentration Profile $c(r)$**\n\nWe begin with the governing partial differential equation for the conservation of mass of oxygen:\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^{2} c - q(c)\n$$\nHere, $c$ is the oxygen concentration, $D$ is the constant oxygen diffusivity, and $q(c)$ is the volumetric oxygen consumption rate.\n\nThe problem specifies several simplifying conditions:\n1.  **Steady state**: The system does not change in time, so $\\frac{\\partial c}{\\partial t} = 0$.\n2.  **Constant consumption**: The oxygen concentration is assumed to be much larger than the Michaelis constant ($c \\gg K_m$), leading to a zero-order, spatially uniform consumption rate $q(c) = q$.\n3.  **Spherical symmetry**: The concentration $c$ depends only on the radial coordinate $r$, so $c = c(r)$.\n\nApplying these conditions, the governing PDE simplifies. At steady state, the equation becomes:\n$$\nD \\nabla^{2} c - q = 0 \\quad \\implies \\quad \\nabla^{2} c = \\frac{q}{D}\n$$\nThis is a Poisson equation for the concentration $c$. In spherical coordinates, for a function that depends only on the radius $r$, the Laplacian operator $\\nabla^2$ is given by:\n$$\n\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right)\n$$\nSubstituting this into the Poisson equation gives the ordinary differential equation (ODE) for $c(r)$:\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{q}{D}\n$$\nTo solve this ODE, we integrate it twice. First, we multiply by $r^2$ and integrate with respect to $r$:\n$$\n\\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{q}{D} r^2\n$$\n$$\n\\int \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) dr = \\int \\frac{q}{D} r^2 dr\n$$\n$$\nr^2 \\frac{dc}{dr} = \\frac{q}{3D} r^3 + C_1\n$$\nwhere $C_1$ is the first integration constant. To find the derivative $\\frac{dc}{dr}$, we divide by $r^2$:\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r + \\frac{C_1}{r^2}\n$$\nIntegrating a second time with respect to $r$ yields the general solution for $c(r)$:\n$$\nc(r) = \\int \\left( \\frac{q}{3D} r + \\frac{C_1}{r^2} \\right) dr = \\frac{q}{6D} r^2 - \\frac{C_1}{r} + C_2\n$$\nwhere $C_2$ is the second integration constant.\n\nWe determine the constants $C_1$ and $C_2$ using the two boundary conditions provided:\n1.  The concentration $c(r)$ must remain finite at the center of the spheroid ($r=0$). As $r \\to 0$, the term $-C_1/r$ diverges unless $C_1 = 0$. Therefore, this physical constraint requires $C_1=0$.\nThe solution thus simplifies to:\n$$\nc(r) = \\frac{q}{6D} r^2 + C_2\n$$\n2.  The oxygen concentration at the spheroid surface ($r=R$) is maintained at a constant external value, $c(R) = c_{\\mathrm{ext}}$. Applying this condition:\n$$\nc(R) = \\frac{q}{6D} R^2 + C_2 = c_{\\mathrm{ext}}\n$$\nSolving for $C_2$:\n$$\nC_2 = c_{\\mathrm{ext}} - \\frac{q}{6D} R^2\n$$\nSubstituting this expression for $C_2$ back into the solution for $c(r)$, we obtain the final expression for the steady-state radial oxygen concentration profile:\n$$\nc(r) = \\frac{q}{6D} r^2 + c_{\\mathrm{ext}} - \\frac{q}{6D} R^2\n$$\nThis can be rearranged into a more insightful form:\n$$\nc(r) = c_{\\mathrm{ext}} - \\frac{q}{6D} (R^2 - r^2)\n$$\n\n**Part 2: Derivation of the Hypoxic Radius $r_{\\mathrm{h}}$**\n\nThe hypoxic radius, $r_{\\mathrm{h}}$, is defined as the radius where the oxygen concentration drops to a specified hypoxic threshold, $c_{\\mathrm{h}}$. That is, $c(r_{\\mathrm{h}}) = c_{\\mathrm{h}}$. We use the derived profile $c(r)$ to find an expression for $r_{\\mathrm{h}}$:\n$$\nc_{\\mathrm{h}} = c_{\\mathrm{ext}} - \\frac{q}{6D} (R^2 - r_{\\mathrm{h}}^2)\n$$\nWe now solve this equation for $r_{\\mathrm{h}}$. Rearranging the terms:\n$$\n\\frac{q}{6D} (R^2 - r_{\\mathrm{h}}^2) = c_{\\mathrm{ext}} - c_{\\mathrm{h}}\n$$\n$$\nR^2 - r_{\\mathrm{h}}^2 = \\frac{6D}{q} (c_{\\mathrm{ext}} - c_{\\mathrm{h}})\n$$\n$$\nr_{\\mathrm{h}}^2 = R^2 - \\frac{6D}{q} (c_{\\mathrm{ext}} - c_{\\mathrm{h}})\n$$\nTaking the non-negative square root (since radius must be non-negative), we get the closed-form expression for the hypoxic radius:\n$$\nr_{\\mathrm{h}} = \\sqrt{R^2 - \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}}\n$$\nA real-valued hypoxic radius $r_{\\mathrm{h}}$ exists only if the term inside the square root is non-negative. This leads to the condition:\n$$\nR^2 - \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q} \\ge 0 \\quad \\implies \\quad R^2 \\ge \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}\n$$\nPhysically, this condition means that a hypoxic core ($r_{\\mathrm{h}} > 0$) will form only if the spheroid is large enough, or the consumption rate is high enough, to deplete the oxygen concentration at the center to a level below the hypoxic threshold $c_{\\mathrm{h}}$. If this condition is not met, the entire spheroid remains well-oxygenated (i.e., $c(r) > c_{\\mathrm{h}}$ for all $r \\in [0, R]$).\n\n**Part 3: Numerical Computation of $r_{\\mathrm{h}}$**\n\nWe are given the following parameter values:\n- $D = 2.0 \\times 10^{-9}$ m$^{2}$ s$^{-1}$\n- $q = 5.0 \\times 10^{-3}$ mol m$^{-3}$ s$^{-1}$\n- $R = 8.00 \\times 10^{-4}$ m\n- $c_{\\mathrm{ext}} = 0.20$ mol m$^{-3}$\n- $c_{\\mathrm{h}} = 0.020$ mol m$^{-3}$\n\nFirst, we calculate the terms required for the expression for $r_{\\mathrm{h}}^2$. All units are in the SI system, so they are consistent.\nThe difference in concentration is:\n$$\nc_{\\mathrm{ext}} - c_{\\mathrm{h}} = 0.20 - 0.020 = 0.18 \\text{ mol m}^{-3}\n$$\nNext, we calculate the term $\\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}$:\n$$\n\\frac{6(2.0 \\times 10^{-9})(0.18)}{5.0 \\times 10^{-3}} = \\frac{2.16 \\times 10^{-9}}{5.0 \\times 10^{-3}} = 4.32 \\times 10^{-7} \\text{ m}^2\n$$\nThe square of the spheroid radius is:\n$$\nR^2 = (8.00 \\times 10^{-4})^2 = 64.0 \\times 10^{-8} = 6.40 \\times 10^{-7} \\text{ m}^2\n$$\nSince $R^2 > \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}$ ($6.40 \\times 10^{-7} > 4.32 \\times 10^{-7}$), a real-valued hypoxic radius exists.\nNow we substitute these values into the equation for $r_{\\mathrm{h}}^2$:\n$$\nr_{\\mathrm{h}}^2 = (6.40 \\times 10^{-7}) - (4.32 \\times 10^{-7}) = 2.08 \\times 10^{-7} \\text{ m}^2\n$$\nTaking the square root to find $r_{\\mathrm{h}}$:\n$$\nr_{\\mathrm{h}} = \\sqrt{2.08 \\times 10^{-7}} \\approx 4.5607 \\times 10^{-4} \\text{ m}\n$$\nThe problem requires the answer in micrometers ($\\mu$m). We convert from meters to micrometers ($1$ m $= 10^6$ $\\mu$m):\n$$\nr_{\\mathrm{h}} \\approx (4.5607 \\times 10^{-4}) \\times 10^6 \\text{ }\\mu\\text{m} = 456.07 \\text{ }\\mu\\text{m}\n$$\nFinally, rounding the result to three significant figures as requested:\n$$\nr_{\\mathrm{h}} \\approx 456 \\text{ }\\mu\\text{m}\n$$",
            "answer": "$$\n\\boxed{456}\n$$"
        },
        {
            "introduction": "While continuum models are powerful, they often overlook the inherent stochasticity of molecular processes, which becomes critical at low molecule counts. This practice delves into the realm of stochastic dynamics, using Kramers' rate theory to calculate the switching time between two stable cell fates in a bistable gene network. By working through this problem , you will gain insight into how molecular noise can drive significant cellular-level events, a phenomenon that deterministic models cannot capture.",
            "id": "3898167",
            "problem": "A single-gene, self-activating regulatory network exhibits two stable cell fates due to bistability in the transcription factor concentration. Let the dimensionless gene-expression state be denoted by $x$, and assume time has been nondimensionalized so that the dynamics are overdamped and governed by the stochastic differential equation (SDE) $\\dot{x} = -U'(x) + \\sqrt{2D}\\,\\xi(t)$, where $\\xi(t)$ is unit-variance Gaussian white noise with $\\langle \\xi(t)\\xi(t') \\rangle = \\delta(t-t')$, and $D>0$ is the dimensionless noise intensity arising from finite molecular copy-number fluctuations. The effective potential landscape is given by $U(x) = \\frac{\\beta}{4}x^{4} - \\frac{\\alpha}{2}x^{2}$ with $\\alpha>0$ and $\\beta>0$, which produces two basins of attraction at $x = \\pm \\sqrt{\\alpha/\\beta}$ separated by a barrier at $x=0$. The two basins correspond to distinct cell fates at the cellular scale. At the molecular scale, the barrier height and the curvature of the landscape are influenced by transcription factor–deoxyribonucleic acid binding cooperativity and promoter saturation, and the noise intensity $D$ is set by copy-number fluctuations that scale inversely with system size. At the tissue scale, rare switching events between fates give rise to effective transition rates that shape the spatiotemporal patterning of cell populations.\n\nUsing Kramers’ approximation for escape in one dimension in the regime of small $D$ relative to the potential barrier height, derive from first principles the leading-order asymptotic expression for the mean first passage time (MFPT) $\\tau$ to transition from the right-hand well at $x = +\\sqrt{\\alpha/\\beta}$ to the left-hand well at $x = -\\sqrt{\\alpha/\\beta}$. Your derivation must explicitly identify the barrier height and the local curvatures at the well and the barrier, and show how they enter $\\tau$. Express the final answer as a single closed-form analytic expression in terms of $\\alpha$, $\\beta$, and $D$, in nondimensional time units. Do not evaluate numerically and do not introduce any parameters beyond $\\alpha$, $\\beta$, and $D$ in the final expression.",
            "solution": "The problem asks for the mean first passage time (MFPT) for a particle to escape from a potential well, governed by the overdamped Langevin equation $\\dot{x} = -U'(x) + \\sqrt{2D}\\,\\xi(t)$. For a small noise intensity $D$ relative to the potential barrier height, the MFPT $\\tau$ can be found using Kramers' approximation.\n\nFirst, we analyze the potential $U(x) = \\frac{\\beta}{4}x^{4} - \\frac{\\alpha}{2}x^{2}$. The stable states (wells) and the unstable state (barrier) are the critical points where the force $-U'(x)$ is zero.\n$$\nU'(x) = \\beta x^3 - \\alpha x = x(\\beta x^2 - \\alpha)\n$$\nSetting $U'(x) = 0$ gives the critical points: $x_B = 0$ and $x_W = \\pm\\sqrt{\\alpha/\\beta}$.\nTo classify them, we use the second derivative:\n$$\nU''(x) = 3\\beta x^2 - \\alpha\n$$\n-   At $x_B = 0$, $U''(0) = -\\alpha < 0$. This is a local maximum, the top of the potential barrier.\n-   At $x_W = \\pm\\sqrt{\\alpha/\\beta}$, $U''(\\pm\\sqrt{\\alpha/\\beta}) = 3\\beta(\\alpha/\\beta) - \\alpha = 2\\alpha > 0$. These are local minima, the bottoms of the potential wells.\n\nThe escape is from the right well at $x=+\\sqrt{\\alpha/\\beta}$ over the barrier at $x=0$.\nThe Kramers' formula for the MFPT in the overdamped limit is given by:\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{|U''(x_B)| \\cdot U''(x_W)}} \\exp\\left(\\frac{\\Delta U}{D}\\right)\n$$\nwhere $\\Delta U$ is the barrier height.\n\nWe now compute the necessary components:\n1.  **Barrier Height ($\\Delta U$)**: This is the difference in potential between the barrier top and the well bottom.\n    $$ U(x_B) = U(0) = 0 $$\n    $$ U(x_W) = U(\\sqrt{\\alpha/\\beta}) = \\frac{\\beta}{4}\\left(\\frac{\\alpha}{\\beta}\\right)^2 - \\frac{\\alpha}{2}\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\alpha^2}{4\\beta} - \\frac{\\alpha^2}{2\\beta} = -\\frac{\\alpha^2}{4\\beta} $$\n    $$ \\Delta U = U(x_B) - U(x_W) = 0 - \\left(-\\frac{\\alpha^2}{4\\beta}\\right) = \\frac{\\alpha^2}{4\\beta} $$\n2.  **Curvatures**: We have already calculated the second derivatives at the barrier and the well.\n    -   Curvature at the well: $U''(x_W) = 2\\alpha$\n    -   Curvature at the barrier: $U''(x_B) = -\\alpha$, so $|U''(x_B)| = \\alpha$\n\nNow we substitute these into the Kramers' formula:\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{\\alpha \\cdot 2\\alpha}} \\exp\\left(\\frac{\\alpha^2/4\\beta}{D}\\right) = \\frac{2\\pi}{\\sqrt{2\\alpha^2}} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right) = \\frac{2\\pi}{\\alpha\\sqrt{2}} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right)\n$$\nSimplifying the pre-factor gives the final expression:\n$$\n\\tau = \\frac{\\pi\\sqrt{2}}{\\alpha} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right)\n$$\nThis expression gives the mean time for the system to stochastically switch from the cell fate corresponding to the well at $x=+\\sqrt{\\alpha/\\beta}$ to the other fate.",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{\\alpha} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right)}\n$$"
        },
        {
            "introduction": "The final practice synthesizes these concepts by tasking you with building a complete, multi-scale computational model from the ground up. You will connect a molecular-level regulatory network—the Rb-E2F cell cycle switch—to a probabilistic cellular decision and ultimately to tissue-scale population growth. This coding exercise  provides hands-on experience in implementing and analyzing a hierarchical model, a core skill for modern biomedical systems modeling.",
            "id": "3898097",
            "problem": "You are tasked with constructing and analyzing a minimal, scientifically realistic model that links molecular regulation of E2F (E2 promoter binding factor) to tissue-scale population growth, and to use it to predict the effect of Cyclin-Dependent Kinase (CDK) inhibition. The modeling and analysis must be expressed in purely mathematical terms using well-tested foundations: chemical reaction kinetics and mass-action, Hill-type regulatory approximations, and birth-death population processes.\n\nModeling assumptions and required structure:\n- Molecular scale: The retinoblastoma protein ($\\mathrm{Rb}$) has two states: unphosphorylated (active inhibitor) and phosphorylated (inactive inhibitor). Denote $x(t) \\in [0,1]$ as the fraction of phosphorylated Rb, and $E(t) \\ge 0$ as the activity of E2F. CDK activity is an increasing function of E2F due to cyclin expression, and pharmacological CDK inhibition reduces CDK activity according to the inhibitory factor $ \\gamma(I) = \\frac{1}{1 + I/K_i} $, where $I$ is the inhibitor concentration and $K_i$ is an inhibition constant.\n- Cellular scale: E2F activity increases when Rb is phosphorylated. E2F also degrades proportionally to its level.\n- Tissue scale: A cell enters the proliferative cycle if its molecular E2F activity exceeds an effective threshold. Across a population, the threshold is heterogeneous and modeled as a normal distribution. The fraction of cycling cells is the probability that the random threshold does not exceed the molecular steady-state activity. The net population growth rate is the birth rate of cycling cells minus a constant death rate.\n\nUse the following specific model components, grounded in mass-action kinetics and Hill-type regulation:\n1. CDK-dependent Rb phosphorylation and dephosphorylation:\n   $$ \\frac{dx}{dt} = k_{\\mathrm{phos}} \\, C(E, I) \\, (1 - x) - k_{\\mathrm{dephos}} \\, x, $$\n   where $C(E,I) = \\gamma(I)\\left(C_0 + C_1 \\frac{E^m}{K_c^m + E^m}\\right)$ and $\\gamma(I) = \\frac{1}{1 + I/K_i}$.\n2. E2F production and degradation:\n   $$ \\frac{dE}{dt} = k_{\\mathrm{basal}} + k_E \\frac{x^n}{K_x^n + x^n} - k_{\\mathrm{deg}} E. $$\n3. Fraction of cycling cells given molecular steady-state $E_{\\mathrm{ss}}$ and heterogeneous threshold $T \\sim \\mathcal{N}(\\mu_{\\mathrm{thr}}, \\sigma_{\\mathrm{thr}}^2)$:\n   $$ f = \\mathbb{P}(T \\le E_{\\mathrm{ss}}) = \\Phi\\left(\\frac{E_{\\mathrm{ss}} - \\mu_{\\mathrm{thr}}}{\\sigma_{\\mathrm{thr}}}\\right), $$\n   where $\\Phi(\\cdot)$ is the cumulative distribution function of the standard normal distribution.\n4. Net population growth rate:\n   $$ r = b \\, f - d. $$\n\nAll parameters are constant in time within each test case. Time is measured in hours, inhibitor concentration in micromolar (µM), and E2F activity and phosphorylated fraction are dimensionless.\n\nYou must compute, for each test case, the net population growth rate $r$ in units of inverse hours ($\\mathrm{h}^{-1}$). Determine $E_{\\mathrm{ss}}$ and $x_{\\mathrm{ss}}$ by simulating the dynamical system until it reaches steady state under constant parameters. Use the initial conditions $x(0) = 0$ and $E(0) = 0$.\n\nFixed parameter values (common across all test cases):\n- $k_{\\mathrm{phos}} = 1.5 \\, \\mathrm{h}^{-1}$,\n- $k_{\\mathrm{dephos}} = 0.5 \\, \\mathrm{h}^{-1}$,\n- $C_0 = 0.1$ (dimensionless baseline CDK activity),\n- $C_1 = 1.0$ (dimensionless CDK amplification),\n- $K_i = 0.5 \\, \\mu\\mathrm{M}$,\n- $K_c = 0.4$ (dimensionless),\n- $m = 2$,\n- $k_{\\mathrm{basal}} = 0.02 \\, \\mathrm{h}^{-1}$,\n- $k_E = 1.0 \\, \\mathrm{h}^{-1}$,\n- $K_x = 0.6$ (dimensionless),\n- $n = 4$,\n- $k_{\\mathrm{deg}} = 0.3 \\, \\mathrm{h}^{-1}$,\n- Birth rate when cycling $b = \\ln(2)/24 \\, \\mathrm{h}^{-1}$,\n- Threshold heterogeneity $\\mu_{\\mathrm{thr}} = 1.5$ (dimensionless), $\\sigma_{\\mathrm{thr}} = 0.5$ (dimensionless).\n\nTest suite (each case specifies inhibitor concentration $I$ in $\\mu\\mathrm{M}$ and death rate $d$ in $\\mathrm{h}^{-1}$; $\\mu_{\\mathrm{thr}}$ and $\\sigma_{\\mathrm{thr}}$ are as above unless explicitly overridden):\n1. Case 1 (happy path): $I = 0.0$, $d = 0.005$.\n2. Case 2 (moderate inhibition): $I = 0.5$, $d = 0.005$.\n3. Case 3 (strong inhibition): $I = 2.0$, $d = 0.005$.\n4. Case 4 (near-neutral growth): $I = 0.5$, $d = 0.02$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the four cases in the order listed. Each result must be the net population growth rate $r$ in $\\mathrm{h}^{-1}$, represented as a floating-point number. For example: \"[r1,r2,r3,r4]\".",
            "solution": "The objective is to calculate the net population growth rate, $r$, for four different scenarios by constructing and solving a multi-scale model that links molecular regulation to tissue-level growth.\n\nThe solution strategy involves a hierarchical, bottom-up calculation:\n1.  **Molecular Steady State**: The core of the model is a system of two coupled nonlinear ordinary differential equations (ODEs) describing the dynamics of the phosphorylated Rb fraction, $x(t)$, and E2F activity, $E(t)$. To find the long-term cellular state, we must determine the steady-state values of these variables, $(x_{\\mathrm{ss}}, E_{\\mathrm{ss}})$. This is achieved by setting the time derivatives to zero and solving the resulting algebraic system. However, due to the nonlinear feedback and Hill functions, an analytical solution is intractable. Instead, we numerically integrate the ODE system from the specified initial conditions, $x(0) = 0$ and $E(0) = 0$, over a sufficiently long time interval (e.g., 200 hours) until the system converges to a stable fixed point. This yields the steady-state E2F activity, $E_{\\mathrm{ss}}$, for a given inhibitor concentration $I$.\n\n2.  **Cellular Proliferation Decision**: The model links the molecular state to a cellular decision. It assumes that cell proliferation is not a deterministic outcome but a probabilistic one, where the propensity to enter the cell cycle depends on $E_{\\mathrm{ss}}$. The fraction of cells in the population that become proliferative, $f$, is calculated as the probability that the steady-state E2F activity exceeds a heterogeneous, normally distributed threshold $T \\sim \\mathcal{N}(\\mu_{\\mathrm{thr}}, \\sigma_{\\mathrm{thr}}^2)$. This probability is computed using the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi$:\n    $$ f = \\mathbb{P}(T \\le E_{\\mathrm{ss}}) = \\Phi\\left(\\frac{E_{\\mathrm{ss}} - \\mu_{\\mathrm{thr}}}{\\sigma_{\\mathrm{thr}}}\\right) $$\n\n3.  **Tissue-Scale Population Growth**: Finally, the net growth rate of the cell population, $r$, is determined by a simple birth-death process. The overall birth rate is the intrinsic birth rate of a cycling cell, $b$, multiplied by the fraction of cycling cells, $f$. The net growth rate is this term minus the constant death rate, $d$:\n    $$ r = b \\cdot f - d $$\n\nThis entire procedure is implemented computationally. For each of the four test cases defined by a specific inhibitor concentration $I$ and death rate $d$, the ODEs are solved numerically to find $E_{\\mathrm{ss}}$, which is then used to calculate $f$ and, finally, the net growth rate $r$. The provided code implements this logic using standard numerical libraries in Python.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the multi-scale model of cell proliferation for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (I, d)\n        (0.0, 0.005),  # Case 1\n        (0.5, 0.005),  # Case 2\n        (2.0, 0.005),  # Case 3\n        (0.5, 0.020),   # Case 4\n    ]\n\n    # Fixed parameter values\n    k_phos = 1.5      # h^-1\n    k_dephos = 0.5    # h^-1\n    C0 = 0.1          # dimensionless\n    C1 = 1.0          # dimensionless\n    K_i = 0.5         # µM\n    K_c = 0.4         # dimensionless\n    m = 2             # dimensionless\n    k_basal = 0.02    # h^-1\n    k_E = 1.0         # h^-1\n    K_x = 0.6         # dimensionless\n    n = 4             # dimensionless\n    k_deg = 0.3       # h^-1\n    b = np.log(2) / 24  # h^-1\n    mu_thr = 1.5      # dimensionless\n    sigma_thr = 0.5   # dimensionless\n\n    def model_odes(t, y, I):\n        \"\"\"\n        Defines the system of ODEs for Rb phosphorylation and E2F activity.\n        \n        Args:\n            t (float): Time (unused, for solver compatibility).\n            y (list or array): State vector [x, E].\n            I (float): Inhibitor concentration.\n        \n        Returns:\n            list: The derivatives [dx/dt, dE/dt].\n        \"\"\"\n        x, E = y\n\n        # Ensure state variables are within physical bounds\n        x = max(0.0, min(1.0, x))\n        E = max(0.0, E)\n        \n        # Calculate C(E, I), the CDK activity\n        gamma = 1.0 / (1.0 + I / K_i)\n        cdk_e_feedback = C1 * (E**m / (K_c**m + E**m))\n        C_E_I = gamma * (C0 + cdk_e_feedback)\n        \n        # Calculate dx/dt\n        dxdt = k_phos * C_E_I * (1.0 - x) - k_dephos * x\n        \n        # Calculate dE/dt\n        e2f_rb_feedback = k_E * (x**n / (K_x**n + x**n))\n        dEdt = k_basal + e2f_rb_feedback - k_deg * E\n        \n        return [dxdt, dEdt]\n\n    def std_normal_cdf(z):\n        \"\"\"\n        Computes the cumulative distribution function (CDF) of the standard normal distribution.\n        \"\"\"\n        return 0.5 * (1.0 + erf(z / np.sqrt(2)))\n\n    results = []\n    \n    # Simulation settings\n    y0 = [0.0, 0.0]  # Initial conditions x(0)=0, E(0)=0\n    t_final = 200.0   # Sufficiently long time to reach steady state\n    t_span = [0, t_final]\n\n    for I_case, d_case in test_cases:\n        # Solve the ODE system to find the steady state\n        solution = solve_ivp(\n            fun=lambda t, y: model_odes(t, y, I_case),\n            t_span=t_span,\n            y0=y0,\n            method='Radau',  # A robust solver suitable for stiff systems\n            t_eval=[t_final] # We only need the solution at the final time point\n        )\n        \n        # Extract steady state values\n        x_ss, E_ss = solution.y[:, 0]\n        \n        # Calculate the fraction of cycling cells\n        z_score = (E_ss - mu_thr) / sigma_thr\n        f = std_normal_cdf(z_score)\n        \n        # Calculate the net population growth rate\n        r = b * f - d_case\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}