{
    "hands_on_practices": [
        {
            "introduction": "生物组织内的物质运输是连接细胞尺度与组织尺度功能的关键过程。本练习将引导你推导一个经典的反应-扩散模型，用于描述肿瘤微球内的氧气浓度分布。通过将细胞的耗氧率（微观尺度）与物理扩散定律（宏观尺度）相结合，你将学会如何预测组织层面出现的关键现象，例如缺氧区的形成，这对于理解癌症生物学和治疗至关重要。",
            "id": "3898110",
            "problem": "一个半径为 $R$ 的多细胞肿瘤球体嵌入在富氧组织中。氧气通过球体表面（半径 $r=R$ 处）的扩散供应，该处的氧浓度维持在 $c(R)=c_{\\mathrm{ext}}$。球体内的细胞消耗氧气。将分子尺度的消耗与组织尺度的模型联系起来，在球对称条件下推导稳态径向氧浓度分布 $c(r)$，然后计算 $c(r)$ 首次降至预定缺氧阈值 $c_{\\mathrm{h}}$ 时的半径 $r_{\\mathrm{h}}$。\n\n假设与出发点：\n- 氧气的质量守恒结合菲克第一定律（Fick’s first law）可得到控制性偏微分方程（PDE）$\\partial c/\\partial t = D \\nabla^{2} c - q(c)$，其中 $c$ 是氧浓度，$D$ 是氧扩散系数，$q(c)$ 是单位体积消耗率。\n- 在分子尺度上，细胞的氧气摄取遵循米氏-孟顿（Michaelis–Menten, MM）形式，单个细胞的最大摄取率为 $v_{\\max}$，米氏常数为 $K_{m}$。对于均匀的细胞数密度 $\\rho$ 并且在 $c \\gg K_{m}$ 的情况下，将 $q(c)$ 近似为一个常数 $q \\approx \\rho\\, v_{\\max}$。\n- 在稳态和球对称条件下，对于 $0 \\le r \\le R$，消耗在空间上是均匀的，等于 $q$。\n- 边界条件：$c(R)=c_{\\mathrm{ext}}$ 且 $c(r)$ 在 $r=0$ 处保持有限。\n\n任务：\n1. 从质量守恒定律和菲克第一定律出发，将其应用于稳态和球对称条件，推导出关于 $c(r)$ 的常微分方程及其在给定边界条件下的通解。用 $D$, $q$, $R$ 和 $c_{\\mathrm{ext}}$ 表示你的 $c(r)$ 结果。\n2. 通过 $c(r_{\\mathrm{h}})=c_{\\mathrm{h}}$（其中 $0  c_{\\mathrm{h}}  c_{\\mathrm{ext}}$）隐式定义缺氧半径 $r_{\\mathrm{h}}$。利用第1部分的结果，推导出 $r_{\\mathrm{h}}$ 关于 $D$, $q$, $R$, $c_{\\mathrm{ext}}$ 和 $c_{\\mathrm{h}}$ 的闭式表达式。说明在何种条件下，球体内存在实数值的 $r_{\\mathrm{h}}$。\n3. 当 $D = 2.0 \\times 10^{-9} \\text{ m}^2/\\text{s}$，$q = 5.0 \\times 10^{-3} \\text{ mol m}^{-3}\\text{s}^{-1}$，$R = 8.00 \\times 10^{-4} \\text{ m}$，$c_{\\mathrm{ext}} = 0.20 \\text{ mol m}^{-3}$，$c_{\\mathrm{h}} = 0.020 \\text{ mol m}^{-3}$ 时，计算 $r_{\\mathrm{h}}$。你的最终数值答案需以微米为单位，并四舍五入到三位有效数字。\n\n你的最终答案必须是等于缺氧半径（以微米为单位）的单个实数，按要求进行四舍五入。最终答案中不要包含单位。",
            "solution": "所述问题具有科学依据、提法恰当、客观且完整。它代表了生物系统内输运现象的一个经典问题，特别是对肿瘤球体中氧气扩散和消耗的建模。所提供的假设和数据是一致且符合物理实际的。因此，该问题是有效的，我们可以继续进行求解。\n\n解答过程按题目要求分为三个部分。\n\n**第1部分：氧浓度分布 $c(r)$ 的推导**\n\n我们从氧气质量守恒的控制性偏微分方程开始：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^{2} c - q(c)\n$$\n此处，$c$ 是氧浓度，$D$ 是恒定的氧扩散系数，$q(c)$ 是单位体积氧气消耗率。\n\n题目指定了几个简化条件：\n1.  **稳态**：系统不随时间变化，因此 $\\frac{\\partial c}{\\partial t} = 0$。\n2.  **恒定消耗**：假设氧浓度远大于米氏常数（$c \\gg K_m$），从而得到一个零级、空间均匀的消耗率 $q(c) = q$。\n3.  **球对称**：浓度 $c$ 仅依赖于径向坐标 $r$，因此 $c = c(r)$。\n\n应用这些条件，控制性偏微分方程得以简化。在稳态下，方程变为：\n$$\nD \\nabla^{2} c - q = 0 \\quad \\implies \\quad \\nabla^{2} c = \\frac{q}{D}\n$$\n这是关于浓度 $c$ 的泊松方程（Poisson equation）。在球坐标系中，对于一个只依赖于半径 $r$ 的函数，拉普拉斯算子（Laplacian operator）$\\nabla^2$ 由下式给出：\n$$\n\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right)\n$$\n将此代入泊松方程，得到关于 $c(r)$ 的常微分方程（ODE）：\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{q}{D}\n$$\n为求解此常微分方程，我们进行两次积分。首先，两边乘以 $r^2$ 并对 $r$ 积分：\n$$\n\\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{q}{D} r^2\n$$\n$$\n\\int \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) dr = \\int \\frac{q}{D} r^2 dr\n$$\n$$\nr^2 \\frac{dc}{dr} = \\frac{q}{3D} r^3 + C_1\n$$\n其中 $C_1$ 是第一个积分常数。为了求出导数 $\\frac{dc}{dr}$，我们将方程两边除以 $r^2$：\n$$\n\\frac{dc}{dr} = \\frac{q}{3D} r + \\frac{C_1}{r^2}\n$$\n再次对 $r$ 积分，得到 $c(r)$ 的通解：\n$$\nc(r) = \\int \\left( \\frac{q}{3D} r + \\frac{C_1}{r^2} \\right) dr = \\frac{q}{6D} r^2 - \\frac{C_1}{r} + C_2\n$$\n其中 $C_2$ 是第二个积分常数。\n\n我们利用给定的两个边界条件来确定常数 $C_1$ 和 $C_2$：\n1.  浓度 $c(r)$ 在球体中心（$r=0$）必须保持有限。当 $r \\to 0$ 时，项 $-C_1/r$ 会发散，除非 $C_1 = 0$。因此，这一物理约束要求 $C_1=0$。\n因此，解简化为：\n$$\nc(r) = \\frac{q}{6D} r^2 + C_2\n$$\n2.  在球体表面（$r=R$）的氧浓度维持在一个恒定的外部值 $c(R) = c_{\\mathrm{ext}}$。应用此条件：\n$$\nc(R) = \\frac{q}{6D} R^2 + C_2 = c_{\\mathrm{ext}}\n$$\n解出 $C_2$：\n$$\nC_2 = c_{\\mathrm{ext}} - \\frac{q}{6D} R^2\n$$\n将 $C_2$ 的表达式代回 $c(r)$ 的解中，我们得到稳态径向氧浓度分布的最终表达式：\n$$\nc(r) = \\frac{q}{6D} r^2 + c_{\\mathrm{ext}} - \\frac{q}{6D} R^2\n$$\n这可以重排成一个更具洞察力的形式：\n$$\nc(r) = c_{\\mathrm{ext}} - \\frac{q}{6D} (R^2 - r^2)\n$$\n\n**第2部分：缺氧半径 $r_{\\mathrm{h}}$ 的推导**\n\n缺氧半径 $r_{\\mathrm{h}}$ 定义为氧浓度下降到指定缺氧阈值 $c_{\\mathrm{h}}$ 时的半径。即 $c(r_{\\mathrm{h}}) = c_{\\mathrm{h}}$。我们使用推导出的分布 $c(r)$ 来寻找 $r_{\\mathrm{h}}$ 的表达式：\n$$\nc_{\\mathrm{h}} = c_{\\mathrm{ext}} - \\frac{q}{6D} (R^2 - r_{\\mathrm{h}}^2)\n$$\n现在我们求解此方程以得到 $r_{\\mathrm{h}}$。整理各项：\n$$\n\\frac{q}{6D} (R^2 - r_{\\mathrm{h}}^2) = c_{\\mathrm{ext}} - c_{\\mathrm{h}}\n$$\n$$\nR^2 - r_{\\mathrm{h}}^2 = \\frac{6D}{q} (c_{\\mathrm{ext}} - c_{\\mathrm{h}})\n$$\n$$\nr_{\\mathrm{h}}^2 = R^2 - \\frac{6D}{q} (c_{\\mathrm{ext}} - c_{\\mathrm{h}})\n$$\n取非负平方根（因为半径必须为非负），我们得到缺氧半径的闭式表达式：\n$$\nr_{\\mathrm{h}} = \\sqrt{R^2 - \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}}\n$$\n只有当平方根内的项为非负时，才存在实数值的缺氧半径 $r_{\\mathrm{h}}$。这导出以下条件：\n$$\nR^2 - \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q} \\ge 0 \\quad \\implies \\quad R^2 \\ge \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}\n$$\n在物理上，这个条件意味着只有当球体足够大，或消耗率足够高，使得中心氧浓度降至缺氧阈值 $c_{\\mathrm{h}}$ 以下时，才会形成缺氧核心（$r_{\\mathrm{h}} > 0$）。如果不满足此条件，则整个球体都保持富氧状态（即，对于所有 $r \\in [0, R]$，都有 $c(r) > c_{\\mathrm{h}}$）。\n\n**第3部分：$r_{\\mathrm{h}}$ 的数值计算**\n\n给定以下参数值：\n- $D = 2.0 \\times 10^{-9} \\text{ m}^2\\text{s}^{-1}$\n- $q = 5.0 \\times 10^{-3} \\text{ mol m}^{-3}\\text{s}^{-1}$\n- $R = 8.00 \\times 10^{-4} \\text{ m}$\n- $c_{\\mathrm{ext}} = 0.20 \\text{ mol m}^{-3}$\n- $c_{\\mathrm{h}} = 0.020 \\text{ mol m}^{-3}$\n\n首先，我们计算 $r_{\\mathrm{h}}^2$ 表达式中所需的各项。所有单位均为国际单位制（SI），因此它们是一致的。\n浓度差为：\n$$\nc_{\\mathrm{ext}} - c_{\\mathrm{h}} = 0.20 - 0.020 = 0.18 \\text{ mol m}^{-3}\n$$\n接下来，我们计算项 $\\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}$：\n$$\n\\frac{6(2.0 \\times 10^{-9})(0.18)}{5.0 \\times 10^{-3}} = \\frac{2.16 \\times 10^{-9}}{5.0 \\times 10^{-3}} = 4.32 \\times 10^{-7} \\text{ m}^2\n$$\n球体半径的平方是：\n$$\nR^2 = (8.00 \\times 10^{-4})^2 = 64.0 \\times 10^{-8} = 6.40 \\times 10^{-7} \\text{ m}^2\n$$\n由于 $R^2 > \\frac{6D(c_{\\mathrm{ext}} - c_{\\mathrm{h}})}{q}$（$6.40 \\times 10^{-7} > 4.32 \\times 10^{-7}$），存在实数值的缺氧半径。\n现在我们将这些值代入 $r_{\\mathrm{h}}^2$ 的方程中：\n$$\nr_{\\mathrm{h}}^2 = (6.40 \\times 10^{-7}) - (4.32 \\times 10^{-7}) = 2.08 \\times 10^{-7} \\text{ m}^2\n$$\n取平方根求得 $r_{\\mathrm{h}}$：\n$$\nr_{\\mathrm{h}} = \\sqrt{2.08 \\times 10^{-7}} \\approx 4.5607 \\times 10^{-4} \\text{ m}\n$$\n题目要求答案以微米（$\\mu$m）为单位。我们从米转换为微米（$1 \\text{ m} = 10^6 \\mu\\text{m}$）：\n$$\nr_{\\mathrm{h}} \\approx (4.5607 \\times 10^{-4}) \\times 10^6 \\mu\\text{m} = 456.07 \\mu\\text{m}\n$$\n最后，按要求将结果四舍五入到三位有效数字：\n$$\nr_{\\mathrm{h}} \\approx 456 \\mu\\text{m}\n$$",
            "answer": "$$\n\\boxed{456}\n$$"
        },
        {
            "introduction": "细胞的命运决定过程，如分化或对压力的反应，往往不是确定性的，而是受到分子层面随机性的深刻影响。本练习探讨了基因调控网络中的随机性如何驱动细胞在不同稳定状态（即细胞命运）之间切换。你将运用统计物理学中的克拉默斯近似理论，从第一性原理出发，推导细胞状态转变的平均时间，从而量化分子噪声在细胞决策中的关键作用。",
            "id": "3898167",
            "problem": "一个单基因、自激活的调控网络，由于转录因子浓度的双稳态性，表现出两种稳定的细胞命运。设无量纲的基因表达状态由 $x$ 表示，并假设时间已被无量纲化，使得动力学是过阻尼的，并由随机微分方程（SDE）$\\dot{x} = -U'(x) + \\sqrt{2D}\\,\\xi(t)$ 控制，其中 $\\xi(t)$ 是单位方差的高斯白噪声，满足 $\\langle \\xi(t)\\xi(t') \\rangle = \\delta(t-t')$，且 $D0$ 是由有限分子拷贝数波动引起的无量纲噪声强度。有效势场由 $U(x) = \\frac{\\beta}{4}x^{4} - \\frac{\\alpha}{2}x^{2}$ 给出，其中 $\\alpha0$ 和 $\\beta0$。该势场在 $x = \\pm \\sqrt{\\alpha/\\beta}$ 处产生两个吸引盆，由位于 $x=0$ 处的势垒隔开。这两个吸引盆在细胞尺度上对应于不同的细胞命运。在分子尺度上，势垒高度和势场曲率受到转录因子-脱氧核糖核酸结合协同性以及启动子饱和度的影响，而噪声强度 $D$ 由与系统大小成反比的拷贝数波动决定。在组织尺度上，命运之间的罕见转换事件产生了有效的跃迁速率，从而塑造了细胞群体的时空模式。\n\n使用 Kramers' 在一维逃逸问题中，对于 $D$ 相对于势垒高度很小的情况下的近似，从第一性原理推导从右侧势阱 $x = +\\sqrt{\\alpha/\\beta}$ 跃迁到左侧势阱 $x = -\\sqrt{\\alpha/\\beta}$ 的平均首达时间（MFPT）$\\tau$ 的主阶渐近表达式。你的推导必须明确指出势垒高度以及在势阱和势垒处的局部曲率，并展示它们如何影响 $\\tau$。将最终答案表示为仅含 $\\alpha$、$\\beta$ 和 $D$ 的单一闭式解析表达式，以无量纲时间单位表示。不要进行数值计算，也不要在最终表达式中引入除 $\\alpha$、$\\beta$ 和 $D$ 之外的任何参数。",
            "solution": "该问题要求计算由朗之万方程 $\\dot{x} = -U'(x) + \\sqrt{2D}\\,\\xi(t)$ 描述的粒子从一个势阱跃迁到另一个势阱的平均首达时间（MFPT）。势由 $U(x) = \\frac{\\beta}{4}x^4 - \\frac{\\alpha}{2}x^2$ 给出。\n\n首先，我们通过求其导数 $U'(x)$ 的根来确定势的临界点。\n$$\nU'(x) = \\frac{d}{dx}\\left(\\frac{\\beta}{4}x^4 - \\frac{\\alpha}{2}x^2\\right) = \\beta x^3 - \\alpha x = x(\\beta x^2 - \\alpha)\n$$\n令 $U'(x) = 0$ 得到临界点 $x_0 = 0$ 和 $x_\\pm = \\pm\\sqrt{\\alpha/\\beta}$。\n\n为了对这些点进行分类，我们考察二阶导数 $U''(x)$。\n$$\nU''(x) = \\frac{d}{dx}(\\beta x^3 - \\alpha x) = 3\\beta x^2 - \\alpha\n$$\n在 $x=x_0=0$ 处，我们有 $U''(0) = -\\alpha$。因为 $\\alpha > 0$，这是一个局部极大值，对应于势垒。\n在 $x=x_\\pm=\\pm\\sqrt{\\alpha/\\beta}$ 处，我们有 $U''(\\pm\\sqrt{\\alpha/\\beta}) = 3\\beta(\\alpha/\\beta) - \\alpha = 2\\alpha$。因为 $\\alpha > 0$，这些是局部极小值，对应于稳定势阱或细胞命运。我们记右侧势阱为 $x_R = +\\sqrt{\\alpha/\\beta}$，左侧势阱为 $x_L = -\\sqrt{\\alpha/\\beta}$。势垒位于 $x_B = 0$。\n\n任务是求从势阱 $x_R$ 跃迁到势阱 $x_L$ 的 MFPT $\\tau$。对于相对于势垒高度较小的噪声强度 $D$，该时间主要由逃离初始势阱的罕见事件决定。从 $x_0 = x_R$ 出发的粒子的 MFPT 由以下积分给出：\n$$\n\\tau = \\frac{1}{D} \\int_{x_L}^{x_R} dy \\exp\\left(\\frac{U(y)}{D}\\right) \\int_{y}^{+\\infty} dz \\exp\\left(-\\frac{U(z)}{D}\\right)\n$$\n在低噪声极限下（$D \\to 0$），我们可以使用鞍点法（拉普拉斯方法）来计算这些积分。\n内部积分 $I_{inner}(y) = \\int_{y}^{+\\infty} dz \\exp\\left(-\\frac{U(z)}{D}\\right)$ 主要由积分域中 $U(z)$ 的最小值决定，该最小值位于势阱 $z=x_R$ 处。\n外部积分包含项 $\\exp(U(y)/D)$，该项主要由位于势垒 $y=x_B=0$ 处的 $U(y)$ 的最大值决定。\n\n因此，我们可以通过在外部被积函数峰值处（即 $y=x_B=0$）计算缓慢变化部分（内部积分）来近似整个积分。\n对于第一个积分，被积函数 $\\exp(-U(z)/D)$ 在势阱最小值 $z=x_R$ 处有一个尖峰。我们在 $x_R$ 附近展开 $U(z)$：\n$$\nU(z) \\approx U(x_R) + \\frac{1}{2}U''(x_R)(z-x_R)^2 = U(x_R) + \\alpha(z-x_R)^2\n$$\n由于 $D$ 很小，我们可以将积分限扩展到 $(-\\infty, \\infty)$：\n$$\n\\int_{0}^{+\\infty} dz \\exp\\left(-\\frac{U(x_R) + \\alpha(z-x_R)^2}{D}\\right) \\approx \\exp\\left(-\\frac{U(x_R)}{D}\\right) \\int_{-\\infty}^{+\\infty} dz \\exp\\left(-\\frac{\\alpha(z-x_R)^2}{D}\\right) = \\sqrt{\\frac{\\pi D}{\\alpha}} \\exp\\left(-\\frac{U(x_R)}{D}\\right)\n$$\n\n对于第二个积分，被积函数 $\\exp(U(y)/D)$ 在势垒最大值 $y=x_B=0$ 处有一个尖峰。我们在 $x_B=0$ 附近展开 $U(y)$：\n$$\nU(y) \\approx U(x_B) + \\frac{1}{2}U''(x_B)(y-x_B)^2 = U(0) - \\frac{1}{2}\\alpha y^2\n$$\n同样，由于 $D$ 很小，我们可以将积分限从 $[x_L, x_R]$ 扩展到 $(-\\infty, \\infty)$：\n$$\n\\int_{x_L}^{x_R} dy \\exp\\left(\\frac{U(0) - \\frac{1}{2}\\alpha y^2}{D}\\right) \\approx \\exp\\left(\\frac{U(0)}{D}\\right) \\int_{-\\infty}^{+\\infty} dy \\exp\\left(-\\frac{\\alpha y^2}{2D}\\right) = \\sqrt{\\frac{2\\pi D}{\\alpha}} \\exp\\left(\\frac{U(0)}{D}\\right)\n$$\n\n现在，我们将这些结果结合起来求 $\\tau$：\n$$\n\\tau \\approx \\frac{1}{D} \\left( \\sqrt{\\frac{\\pi D}{\\alpha}} \\exp\\left(-\\frac{U(x_R)}{D}\\right) \\right) \\left( \\sqrt{\\frac{2\\pi D}{\\alpha}} \\exp\\left(\\frac{U(0)}{D}\\right) \\right)\n$$\n$$\n\\tau \\approx \\frac{1}{D} \\sqrt{\\frac{2\\pi^2 D^2}{\\alpha^2}} \\exp\\left(\\frac{U(0) - U(x_R)}{D}\\right) = \\frac{\\pi\\sqrt{2}}{\\alpha} \\exp\\left(\\frac{\\Delta U}{D}\\right)\n$$\n其中 $\\Delta U = U(x_B) - U(x_R)$ 是相对于势阱的势垒高度。\n\n我们现在计算 $\\Delta U$。\n势阱最小值 $x_R = \\sqrt{\\alpha/\\beta}$ 处的势为：\n$$\nU(x_R) = \\frac{\\beta}{4}\\left(\\frac{\\alpha}{\\beta}\\right)^2 - \\frac{\\alpha}{2}\\left(\\frac{\\alpha}{\\beta}\\right) = \\frac{\\alpha^2}{4\\beta} - \\frac{\\alpha^2}{2\\beta} = -\\frac{\\alpha^2}{4\\beta}\n$$\n势垒最大值 $x_B = 0$ 处的势为：\n$$\nU(x_B) = U(0) = 0\n$$\n因此，势垒高度为：\n$$\n\\Delta U = U(0) - U(\\sqrt{\\alpha/\\beta}) = 0 - \\left(-\\frac{\\alpha^2}{4\\beta}\\right) = \\frac{\\alpha^2}{4\\beta}\n$$\n将此代入我们关于 $\\tau$ 的表达式：\n$$\n\\tau = \\frac{\\pi\\sqrt{2}}{\\alpha} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right)\n$$\n这就是 MFPT 的主阶渐近表达式。这个结果是过阻尼极限下的 Kramers' 逃逸率公式 $\\tau=1/k$。指数前因子可以用势阱和势垒处的曲率（“频率”）来表示。势阱的曲率是 $U''(x_R) = 2\\alpha$，势垒的曲率是 $U''(x_B) = -\\alpha$。这些量分别决定了 MFPT 的指数前因子和指数因子。",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{\\alpha} \\exp\\left(\\frac{\\alpha^2}{4\\beta D}\\right)}\n$$"
        },
        {
            "introduction": "将分子、细胞和组织尺度的复杂相互作用整合到一个统一的计算模型中，是生物医学系统建模的核心挑战。本练习提供了一个实践机会，要求你构建一个连接 Rb-E2F 分子调控网络、细胞周期进入和细胞群体增长的多尺度模型。通过这个编码实践，你将获得建立预测性模型的实践经验，并用它来量化分子靶向药物（如CDK抑制剂）对宏观群体行为（如生长速率）的影响。",
            "id": "3898097",
            "problem": "您的任务是构建和分析一个简约且科学上真实的模型，该模型将 E2F（E2 启动子结合因子）的分子调控与组织尺度的人口增长联系起来，并用它来预测细胞周期蛋白依赖性激酶（CDK）抑制的影响。建模和分析必须使用经过充分检验的基础理论，以纯数学术语表达：化学反应动力学和质量作用、Hill 型调控近似以及生死人口过程。\n\n建模假设和所需结构：\n- 分子尺度：视网膜母细胞瘤蛋白（$\\mathrm{Rb}$）有两种状态：未磷酸化（活性抑制剂）和磷酸化（非活性抑制剂）。记 $x(t) \\in [0,1]$ 为磷酸化 Rb 的比例，记 $E(t) \\ge 0$ 为 E2F 的活性。由于细胞周期蛋白的表达，CDK 活性是 E2F 的增函数，而药理学上的 CDK 抑制根据抑制因子 $ \\gamma(I) = \\frac{1}{1 + I/K_i} $ 降低 CDK 活性，其中 $I$ 是抑制剂浓度，$K_i$ 是抑制常数。\n- 细胞尺度：当 Rb 被磷酸化时，E2F 活性增加。E2F 也以与其水平成比例的速率降解。\n- 组织尺度：如果一个细胞的分子 E2F 活性超过一个有效阈值，它就会进入增殖周期。在整个细胞群体中，该阈值是异质的，并被建模为正态分布。处于增殖周期的细胞比例是随机阈值不超过分子稳态活性的概率。净群体增长率是增殖细胞的出生率减去一个恒定的死亡率。\n\n使用以下基于质量作用动力学和 Hill 型调控的具体模型组件：\n1. 依赖于 CDK 的 Rb 磷酸化和去磷酸化：\n   $$ \\frac{dx}{dt} = k_{\\mathrm{phos}} \\, C(E, I) \\, (1 - x) - k_{\\mathrm{dephos}} \\, x, $$\n   其中 $C(E,I) = \\gamma(I)\\left(C_0 + C_1 \\frac{E^m}{K_c^m + E^m}\\right)$ 且 $\\gamma(I) = \\frac{1}{1 + I/K_i}$。\n2. E2F 的产生和降解：\n   $$ \\frac{dE}{dt} = k_{\\mathrm{basal}} + k_E \\frac{x^n}{K_x^n + x^n} - k_{\\mathrm{deg}} E. $$\n3. 在给定分子稳态 $E_{\\mathrm{ss}}$ 和异质性阈值 $T \\sim \\mathcal{N}(\\mu_{\\mathrm{thr}}, \\sigma_{\\mathrm{thr}}^2)$ 的情况下，处于增殖周期的细胞比例：\n   $$ f = \\mathbb{P}(T \\le E_{\\mathrm{ss}}) = \\Phi\\left(\\frac{E_{\\mathrm{ss}} - \\mu_{\\mathrm{thr}}}{\\sigma_{\\mathrm{thr}}}\\right), $$\n   其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n4. 净群体增长率：\n   $$ r = b \\, f - d. $$\n\n在每个测试案例中，所有参数随时间保持不变。时间以小时（hours）为单位，抑制剂浓度以微摩尔（µM）为单位，E2F 活性和磷酸化比例是无量纲的。\n\n您必须为每个测试案例计算净群体增长率 $r$，单位为小时的倒数（$\\mathrm{h}^{-1}$）。通过模拟动力学系统，直到它在恒定参数下达到稳态，来确定 $E_{\\mathrm{ss}}$ 和 $x_{\\mathrm{ss}}$。使用初始条件 $x(0) = 0$ 和 $E(0) = 0$。\n\n固定参数值（所有测试案例通用）：\n- $k_{\\mathrm{phos}} = 1.5 \\, \\mathrm{h}^{-1}$,\n- $k_{\\mathrm{dephos}} = 0.5 \\, \\mathrm{h}^{-1}$,\n- $C_0 = 0.1$ (无量纲基线 CDK 活性),\n- $C_1 = 1.0$ (无量纲 CDK 放大系数),\n- $K_i = 0.5 \\, \\mu\\text{M}$,\n- $K_c = 0.4$ (无量纲),\n- $m = 2$,\n- $k_{\\mathrm{basal}} = 0.02 \\, \\mathrm{h}^{-1}$,\n- $k_E = 1.0 \\, \\mathrm{h}^{-1}$,\n- $K_x = 0.6$ (无量纲),\n- $n = 4$,\n- $k_{\\mathrm{deg}} = 0.3 \\, \\mathrm{h}^{-1}$,\n- 增殖周期中的出生率 $b = \\ln(2)/24 \\, \\mathrm{h}^{-1}$,\n- 阈值异质性 $\\mu_{\\mathrm{thr}} = 1.5$ (无量纲), $\\sigma_{\\mathrm{thr}} = 0.5$ (无量纲)。\n\n测试套件（每个案例指定抑制剂浓度 $I$（单位 µM）和死亡率 $d$（单位 $\\mathrm{h}^{-1}$）；除非明确覆盖，$\\mu_{\\mathrm{thr}}$ 和 $\\sigma_{\\mathrm{thr}}$ 如上所述）：\n1. 案例 1 (理想情况): $I = 0.0$, $d = 0.005$.\n2. 案例 2 (中度抑制): $I = 0.5$, $d = 0.005$.\n3. 案例 3 (强度抑制): $I = 2.0$, $d = 0.005$.\n4. 案例 4 (接近中性增长): $I = 0.5$, $d = 0.02$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按所列顺序包含四个案例的结果。每个结果必须是净群体增长率 $r$（单位 $\\mathrm{h}^{-1}$），表示为浮点数。例如：“[r1,r2,r3,r4]”。",
            "solution": "该问题的目标是计算四种不同情景下的净群体增长率 $r$，这些情景的特点是 CDK 抑制剂 $I$ 的水平和细胞死亡率 $d$ 的不同。计算过程通过将分子尺度模型与组织尺度结果联系起来进行。\n\n该模型的核心是一个由两个耦合的非线性常微分方程（ODE）组成的系统，该系统描述了磷酸化视网膜母细胞瘤蛋白的比例 $x(t)$ 和 E2F 转录因子活性 $E(t)$ 的动力学。\n方程为：\n$$ \\frac{dx}{dt} = k_{\\mathrm{phos}} \\, C(E, I) \\, (1 - x) - k_{\\mathrm{dephos}} \\, x $$\n$$ \\frac{dE}{dt} = k_{\\mathrm{basal}} + k_E \\frac{x^n}{K_x^n + x^n} - k_{\\mathrm{deg}} E $$\n$C(E, I)$ 项代表细胞周期蛋白依赖性激酶（CDK）的活性，它本身是 E2F 活性的函数，形成一个正反馈回路。该活性受到浓度为 $I$ 的外部抑制剂的调节：\n$$ C(E,I) = \\frac{1}{1 + I/K_i} \\left(C_0 + C_1 \\frac{E^m}{K_c^m + E^m}\\right) $$\n为确定细胞群体的长期行为，我们必须首先找到分子物质的稳态值，记为 $x_{\\mathrm{ss}}$ 和 $E_{\\mathrm{ss}}$。这些值可以通过将时间导数设为零来找到：$dx/dt = 0$ 和 $dE/dt = 0$。由于非线性的 Hill 函数，找到这个代数方程组的解析解是不可行的。指定的方法是从给定的初始条件 $x(0) = 0$ 和 $E(0) = 0$ 开始，模拟系统的时间演化，直到系统收敛到一个稳定的稳态。这是通过对 ODE 系统在足够长的时间间隔内进行数值积分来实现的。选择了 $200$ 小时的时间跨度，这比系统的特征时间尺度（例如 $1/k_{\\mathrm{deg}} \\approx 3.3$ 小时）要长得多。\n\n一旦确定了稳态 E2F 活性 $E_{\\mathrm{ss}}$，它就被用来连接到细胞和组织尺度。模型假定，如果一个细胞的分子 E2F 活性超过某个阈值，它就会进入增殖周期。这个阈值 $T$ 在细胞群体中不是统一的，而是由一个正态分布 $T \\sim \\mathcal{N}(\\mu_{\\mathrm{thr}}, \\sigma_{\\mathrm{thr}}^2)$ 描述。群体中处于活跃增殖周期的细胞比例 $f$，是随机选择的细胞的阈值小于或等于稳态 E2F 活性的概率：\n$$ f = \\mathbb{P}(T \\le E_{\\mathrm{ss}}) $$\n这个概率是使用正态分布的累积分布函数（CDF）计算的。通过对变量进行标准化，我们得到：\n$$ f = \\Phi\\left(\\frac{E_{\\mathrm{ss}} - \\mu_{\\mathrm{thr}}}{\\sigma_{\\mathrm{thr}}}\\right) $$\n其中 $\\Phi(z)$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数。这个函数可以使用误差函数 $\\mathrm{erf}(z)$，通过关系式 $\\Phi(z) = \\frac{1}{2}\\left(1 + \\mathrm{erf}\\left(\\frac{z}{\\sqrt{2}}\\right)\\right)$ 来计算。\n\n最后，净群体增长率 $r$ 是使用一个简单的生死模型计算的，其中出生率与处于增殖周期的细胞比例成正比：\n$$ r = b \\cdot f - d $$\n这里，$b$ 是一个增殖细胞的内在出生率（给定为 $\\ln(2)/24 \\, \\mathrm{h}^{-1}$，对应于 $24$ 小时的倍增时间），$d$ 是恒定的死亡率。\n\n该解决方案通过创建一个封装 ODE 系统的 Python 函数来实现。对于每个测试案例，此函数连同相应的抑制剂浓度 $I$ 被传递给一个数值求解器（`scipy.integrate.solve_ivp`）。求解器从 $t=0$ 到 $t=200$ 小时进行积分，从初始状态 $(x, E)=(0, 0)$ 开始。$x$ 和 $E$ 的最终值被视为稳态 $(x_{\\mathrm{ss}}, E_{\\mathrm{ss}})$。根据 $E_{\\mathrm{ss}}$，使用该案例特定的死亡率 $d$ 值计算出比例 $f$ 以及随后的增长率 $r$。对所有四个测试案例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the multi-scale model of cell proliferation for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (I, d)\n        (0.0, 0.005),  # Case 1\n        (0.5, 0.005),  # Case 2\n        (2.0, 0.005),  # Case 3\n        (0.5, 0.020),   # Case 4\n    ]\n\n    # Fixed parameter values\n    k_phos = 1.5      # h^-1\n    k_dephos = 0.5    # h^-1\n    C0 = 0.1          # dimensionless\n    C1 = 1.0          # dimensionless\n    K_i = 0.5         # µM\n    K_c = 0.4         # dimensionless\n    m = 2             # dimensionless\n    k_basal = 0.02    # h^-1\n    k_E = 1.0         # h^-1\n    K_x = 0.6         # dimensionless\n    n = 4             # dimensionless\n    k_deg = 0.3       # h^-1\n    b = np.log(2) / 24  # h^-1\n    mu_thr = 1.5      # dimensionless\n    sigma_thr = 0.5   # dimensionless\n\n    def model_odes(t, y, I):\n        \"\"\"\n        Defines the system of ODEs for Rb phosphorylation and E2F activity.\n        \n        Args:\n            t (float): Time (unused, for solver compatibility).\n            y (list or array): State vector [x, E].\n            I (float): Inhibitor concentration.\n        \n        Returns:\n            list: The derivatives [dx/dt, dE/dt].\n        \"\"\"\n        x, E = y\n\n        # Ensure state variables are within physical bounds\n        x = max(0.0, min(1.0, x))\n        E = max(0.0, E)\n        \n        # Calculate C(E, I), the CDK activity\n        gamma = 1.0 / (1.0 + I / K_i)\n        cdk_e_feedback = C1 * (E**m / (K_c**m + E**m))\n        C_E_I = gamma * (C0 + cdk_e_feedback)\n        \n        # Calculate dx/dt\n        dxdt = k_phos * C_E_I * (1.0 - x) - k_dephos * x\n        \n        # Calculate dE/dt\n        e2f_rb_feedback = k_E * (x**n / (K_x**n + x**n))\n        dEdt = k_basal + e2f_rb_feedback - k_deg * E\n        \n        return [dxdt, dEdt]\n\n    def std_normal_cdf(z):\n        \"\"\"\n        Computes the cumulative distribution function (CDF) of the standard normal distribution.\n        \"\"\"\n        return 0.5 * (1.0 + erf(z / np.sqrt(2)))\n\n    results = []\n    \n    # Simulation settings\n    y0 = [0.0, 0.0]  # Initial conditions x(0)=0, E(0)=0\n    t_final = 200.0   # Sufficiently long time to reach steady state\n    t_span = [0, t_final]\n\n    for I_case, d_case in test_cases:\n        # Solve the ODE system to find the steady state\n        solution = solve_ivp(\n            fun=lambda t, y: model_odes(t, y, I_case),\n            t_span=t_span,\n            y0=y0,\n            method='Radau',  # A robust solver suitable for stiff systems\n            t_eval=[t_final] # We only need the solution at the final time point\n        )\n        \n        # Extract steady state values\n        x_ss, E_ss = solution.y[:, 0]\n        \n        # Calculate the fraction of cycling cells\n        z_score = (E_ss - mu_thr) / sigma_thr\n        f = std_normal_cdf(z_score)\n        \n        # Calculate the net population growth rate\n        r = b * f - d_case\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}