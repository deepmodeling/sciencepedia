{
    "hands_on_practices": [
        {
            "introduction": "我们从一个最简单的情形入手：一个空间均匀的组织。这个练习剥离了空间的复杂性，以揭示力学和化学之间的反馈如何导致不稳定性的核心原理。通过分析一个简单的收缩单元何时会变得不稳定，我们将为自发的形态发生建立最基本的直觉。",
            "id": "3900545",
            "problem": "考虑一个经历微小变形的一维上皮组织片段，其被建模为开尔文-沃伊特（Kelvin-Voigt）粘弹性材料。被动柯西应力由 $\\,\\sigma_{\\mathrm{passive}} = E\\,\\epsilon + \\eta\\,\\dot{\\epsilon}\\,$ 给出，其中 $\\,E  0\\,$ 是弹性模量，$\\,\\eta  0\\,$ 是粘度，$\\,\\epsilon\\,$ 是无穷小应变，且 $\\,\\dot{\\epsilon} = d\\epsilon/dt\\,$。主动细胞收缩性产生一个附加应力 $\\,\\sigma_{\\mathrm{active}} = -\\zeta(\\epsilon)\\,$，其力敏反馈由 $\\,\\zeta(\\epsilon) = \\zeta_{0} + \\beta\\,\\epsilon\\,$ 描述，其中 $\\,\\zeta_{0} \\ge 0\\,$ 是基线收缩应力，$\\,\\beta\\,$ 是将应变与收缩性耦合的反馈增益。假设准静态力平衡（惯性可忽略）和无牵引力边界，因此总应力是均匀且等于零的，即 $\\,\\sigma_{\\mathrm{total}} = \\sigma_{\\mathrm{passive}} + \\sigma_{\\mathrm{active}} = 0\\,$。\n\n从这些定义和定律出发，推导控制 $\\,\\epsilon(t)\\,$ 的常微分方程（ODE），确定稳态应变 $\\,\\epsilon^{\\ast}\\,$，并对 $\\,\\epsilon^{\\ast}\\,$ 关于小扰动进行线性稳定性分析。利用此分析，将“自发收缩”定义为稳态因力化学反馈而失去线性稳定性，并求出此不稳定性开始时的临界反馈强度 $\\,\\beta_{c}\\,$。\n\n将您的最终结果报告为 $\\,\\beta_{c}\\,$ 的单个闭式符号表达式。不需要数值计算或四舍五入。最终表达式中不需要单位。",
            "solution": "问题指定了开尔文-沃伊特（Kelvin-Voigt）粘弹性本构关系以及由具有力敏反馈的细胞收缩性产生的主动应力。被动应力为 $\\,\\sigma_{\\mathrm{passive}} = E\\,\\epsilon + \\eta\\,\\dot{\\epsilon}\\,$，主动应力为 $\\,\\sigma_{\\mathrm{active}} = -\\zeta(\\epsilon)\\,$，其中 $\\,\\zeta(\\epsilon) = \\zeta_{0} + \\beta\\,\\epsilon\\,$。在无牵引力边界条件和准静态力平衡（惯性可忽略）下，总应力是均匀且等于零的：\n$$\n\\sigma_{\\mathrm{total}} \\;=\\; \\sigma_{\\mathrm{passive}} + \\sigma_{\\mathrm{active}} \\;=\\; E\\,\\epsilon + \\eta\\,\\dot{\\epsilon} - \\zeta(\\epsilon) \\;=\\; 0.\n$$\n将反馈定律 $\\,\\zeta(\\epsilon) = \\zeta_{0} + \\beta\\,\\epsilon\\,$ 代入力平衡关系，得到控制应变 $\\,\\epsilon(t)\\,$ 的常微分方程（ODE）：\n$$\nE\\,\\epsilon + \\eta\\,\\dot{\\epsilon} - \\left(\\zeta_{0} + \\beta\\,\\epsilon\\right) \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\;\n\\eta\\,\\dot{\\epsilon} \\;=\\; \\zeta_{0} + (\\beta - E)\\,\\epsilon.\n$$\n这是一个一阶线性常微分方程。通过设置 $\\,\\dot{\\epsilon} = 0\\,$ 来获得稳态 $\\,\\epsilon^{\\ast}\\,$：\n$$\n0 \\;=\\; \\zeta_{0} + (\\beta - E)\\,\\epsilon^{\\ast}\n\\;\\;\\Longrightarrow\\;\\;\n\\epsilon^{\\ast} \\;=\\; -\\,\\frac{\\zeta_{0}}{\\beta - E}.\n$$\n为评估线性稳定性，考虑稳态附近的一个小扰动 $\\,\\delta\\epsilon\\,$：$\\,\\epsilon(t) = \\epsilon^{\\ast} + \\delta\\epsilon(t)\\,$，其中 $\\,|\\delta\\epsilon| \\ll 1\\,$。将其代入常微分方程并使用稳态条件 $\\,\\zeta_{0} + (\\beta - E)\\,\\epsilon^{\\ast} = 0\\,$，我们得到关于扰动的方程：\n$$\n\\eta\\,\\frac{d}{dt}\\left(\\epsilon^{\\ast} + \\delta\\epsilon\\right) \\;=\\; \\zeta_{0} + (\\beta - E)\\,\\left(\\epsilon^{\\ast} + \\delta\\epsilon\\right)\n\\;\\;\\Longrightarrow\\;\\;\n\\eta\\,\\frac{d}{dt}\\delta\\epsilon \\;=\\; (\\beta - E)\\,\\delta\\epsilon.\n$$\n这个线性化动力学系统的解为 $\\,\\delta\\epsilon(t) = \\delta\\epsilon(0)\\,\\exp\\!\\left(\\lambda\\,t\\right)\\,$，其增长率为\n$$\n\\lambda \\;=\\; \\frac{\\beta - E}{\\eta}.\n$$\n线性稳定性要求 $\\,\\lambda  0\\,$，即 $\\,\\beta - E  0\\,$。当 $\\,\\lambda = 0\\,$ 时，稳定性丧失（在问题所定义的意义上，自发收缩开始），这定义了临界反馈强度：\n$$\n\\beta_{c} \\;=\\; E.\n$$\n在物理上，力化学反馈将有效弹性刚度从 $\\,E\\,$ 降低到 $\\,E_{\\mathrm{eff}} = E - \\beta\\,$；当 $\\,E_{\\mathrm{eff}}  0\\,$ 时，稳态失去稳定性，系统表现出由主动收缩性驱动的自放大变形，这里解释为无牵引力条件下的自发收缩。常数项 $\\,\\zeta_{0}\\,$ 设定了稳态应变的大小，但不影响线性稳定性阈值，该阈值仅取决于斜率 $\\,d\\zeta/d\\epsilon = \\beta\\,$ 相对于弹性模量 $\\,E\\,$ 和粘度 $\\,\\eta\\,$ 的关系，具体通过 $\\,\\beta - E\\,$ 的符号来体现。",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "在建立了不稳定性的概念基础之上，我们现在将探讨它如何导致空间模式的形成。本练习介绍了一种强大的技术——对一个耦合的反应-扩散-力学系统进行线性稳定性分析。通过推导色散关系 $\\omega(k)$，我们将能够预测哪些模式（即哪些波数 $k$）会被系统自发地选择和放大。",
            "id": "3900586",
            "problem": "考虑一个一维上皮组织，其模型为一个线性弹性活性连续体，通过应力依赖的反应动力学与一个信号浓度场发生力学耦合。令 $x$ 表示位置，$t$ 表示时间。包含基底摩擦的力学动量平衡由 $ \\rho \\,\\partial_{t} v = \\partial_{x} \\sigma - \\xi \\, v$ 给出，其中 $\\rho$ 是质量密度，$v = \\partial_{t} u$ 是由位移场 $u(x,t)$ 导出的物质速度，$\\sigma$ 是总应力，$\\xi$ 是基底摩擦系数。总应力是被动弹性应力与各向同性主动应力之和，$\\sigma = \\sigma_{p} + \\sigma_{a}$，其中 $\\sigma_{p} = E \\,\\partial_{x} u$（胡克定律，弹性模量为 $E$），$\\sigma_{a} = - \\chi \\, c$（收缩应力，与浓度 $c$ 成正比，耦合系数 $\\chi  0$）。信号浓度根据反应-扩散方程 $\\partial_{t} c = D \\,\\partial_{xx} c + R(c,\\sigma)$ 演化，其中 $D$ 是扩散系数，$R(c,\\sigma)$ 是一个依赖于 $c$ 和局部应力 $\\sigma$ 的平滑反应项。\n\n假设存在一个均匀稳态 $(u_{0}, c_{0}, v_{0})$，其中 $v_{0} = 0$，并围绕此状态对系统进行线性化。令 $r = \\left.\\frac{\\partial R}{\\partial c}\\right|_{(c_{0},\\sigma_{0})}$ 和 $s = \\left.\\frac{\\partial R}{\\partial \\sigma}\\right|_{(c_{0},\\sigma_{0})}$ 表示在稳态下（稳态应力为 $\\sigma_{0}$）计算的反应动力学的偏导数。考虑形式为 $u(x,t) = u_{1} \\exp(\\omega t + i k x)$ 和 $c(x,t) = c_{1} \\exp(\\omega t + i k x)$ 的微小纵向平面波微扰，其中 $k$ 是实波数，$\\omega$ 是复数时间增长率（色散关系）。\n\n从给定的力学动量平衡、线性弹性本构定律、定义 $v = \\partial_{t} u$ 以及反应-扩散方程出发，对均匀稳态进行线性化，并消去 $u$ 和 $\\sigma$，以获得浓度微扰的色散关系 $\\omega(k)$。为了模拟在相关时间尺度上与形态发生相关的过阻尼、纯弹性区域，假设 $\\rho = 0$ 并忽略粘弹性（即 Kelvin-Voigt 粘性可忽略不计），因此被动应力遵循 $\\sigma_{p} = E \\,\\partial_{x} u$。\n\n推导 $\\omega(k)$ 具有最大实部的分支的显式闭式表达式，该表达式仅用参数 $E$, $\\xi$, $D$, $r$, $s$, $\\chi$ 和 $k$ 表示。不需要数值，也不需要四舍五入。最终答案必须是单个解析表达式。",
            "solution": "该问题要求对一个耦合的力-化学系统进行线性稳定性分析，以推导色散关系 $\\omega(k)$。我们从给定的控制方程开始，并围绕均匀稳态进行线性化。\n\n1.  **方程线性化**\n\n    我们考虑围绕均匀稳态 $(u_0, c_0)$ 的小扰动，其中位移 $u(x,t) = u_0 + \\delta u(x,t)$，浓度 $c(x,t) = c_0 + \\delta c(x,t)$。稳态是均匀的，因此所有空间导数均为零，且速度 $v_0=0$。\n\n    a. **力平衡方程**:\n    在过阻尼近似 ($\\rho=0$) 下，力平衡方程为 $\\partial_x \\sigma - \\xi v = 0$。其中速度 $v = \\partial_t u$。\n    总应力为 $\\sigma = \\sigma_p + \\sigma_a = E \\partial_x u - \\chi c$。\n    将应力表达式代入力平衡方程，得到：\n    $$ \\partial_x (E \\partial_x u - \\chi c) = \\xi \\partial_t u $$\n    $$ E \\partial_{xx} u - \\chi \\partial_x c = \\xi \\partial_t u $$\n    将扰动代入并注意到稳态解 $u_0, c_0$ 满足平衡方程（由于均匀性，各项为零），我们得到线性化的方程：\n    $$ E \\partial_{xx} (\\delta u) - \\chi \\partial_x (\\delta c) = \\xi \\partial_t (\\delta u) \\quad (*)$$\n\n    b. **反应-扩散方程**:\n    方程为 $\\partial_t c = D \\partial_{xx} c + R(c, \\sigma)$。\n    我们围绕稳态 $(c_0, \\sigma_0)$ 对反应项 $R$ 进行泰勒展开：\n    $R(c, \\sigma) \\approx R(c_0, \\sigma_0) + \\left.\\frac{\\partial R}{\\partial c}\\right|_{(c_0,\\sigma_0)} \\delta c + \\left.\\frac{\\partial R}{\\partial \\sigma}\\right|_{(c_0,\\sigma_0)} \\delta \\sigma$。\n    由于是稳态，$R(c_0, \\sigma_0) = 0$。扰动应力为 $\\delta \\sigma = E \\partial_x (\\delta u) - \\chi \\delta c$。\n    代入后，线性化的反应-扩散方程为：\n    $$ \\partial_t (\\delta c) = D \\partial_{xx} (\\delta c) + r \\delta c + s (E \\partial_x (\\delta u) - \\chi \\delta c) $$\n    $$ \\partial_t (\\delta c) = D \\partial_{xx} (\\delta c) + (r - s\\chi) \\delta c + sE \\partial_x (\\delta u) \\quad (**) $$\n\n2.  **傅里叶分析**\n\n    我们将平面波扰动形式 $\\delta u = u_1 e^{\\omega t + ikx}$ 和 $\\delta c = c_1 e^{\\omega t + ikx}$ 代入线性化的方程 $(*)$ 和 $(**)$。\n    代换规则为：$\\partial_t \\to \\omega$, $\\partial_x \\to ik$, $\\partial_{xx} \\to -k^2$。\n\n    从方程 $(*)$ 得到：\n    $$ E (-k^2) u_1 - \\chi (ik) c_1 = \\xi \\omega u_1 $$\n    $$ (-E k^2 - \\xi \\omega) u_1 - i\\chi k c_1 = 0 $$\n\n    从方程 $(**)$ 得到：\n    $$ \\omega c_1 = D (-k^2) c_1 + (r - s\\chi) c_1 + sE (ik) u_1 $$\n    $$ (\\omega + Dk^2 - r + s\\chi) c_1 - isEk u_1 = 0 $$\n\n3.  **推导色散关系**\n\n    我们得到了一个关于扰动幅度 $(u_1, c_1)$ 的齐次线性方程组：\n    $$\n    \\begin{pmatrix}\n    -E k^2 - \\xi \\omega  -i\\chi k \\\\\n    -isEk  \\omega + Dk^2 - r + s\\chi\n    \\end{pmatrix}\n    \\begin{pmatrix} u_1 \\\\ c_1 \\end{pmatrix}\n    = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n    $$\n    为了得到非平凡解，该 $2 \\times 2$ 矩阵的行列式必须为零：\n    $$ (-E k^2 - \\xi \\omega)(\\omega + Dk^2 - r + s\\chi) - (-i\\chi k)(-isEk) = 0 $$\n    $$ -(E k^2 + \\xi \\omega)(\\omega + Dk^2 - r + s\\chi) - sE\\chi k^2 = 0 $$\n    展开后，我们得到一个关于 $\\omega$ 的二次方程：\n    $$ \\xi \\omega^2 + \\left( \\xi(Dk^2 - r + s\\chi) + Ek^2 \\right) \\omega + \\left( Ek^2(Dk^2 - r + s\\chi) + sE\\chi k^2 \\right) = 0 $$\n    $$ \\xi \\omega^2 + \\left( (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right) \\omega + Ek^2(Dk^2 - r) = 0 $$\n    这是一个形式为 $a\\omega^2 + b\\omega + c = 0$ 的二次方程，其中：\n    $a = \\xi$\n    $b = (\\xi D + E)k^2 + \\xi(s\\chi - r)$\n    $c = Ek^2(Dk^2 - r)$\n\n4.  **求解 $\\omega(k)$**\n\n    使用二次方程求根公式 $\\omega = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，我们得到：\n    $$ \\omega(k) = \\frac{ - \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right] \\pm \\sqrt{ \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right]^2 - 4 \\xi E k^2 (D k^2 - r) } }{2\\xi} $$\n    问题要求具有最大实部的分支，这对应于求根公式中的“+”号。因此，最终的色散关系为：\n    $$ \\omega(k) = \\frac{ - \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right] + \\sqrt{ \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right]^2 - 4 \\xi E k^2 (D k^2 - r) } }{2\\xi} $$",
            "answer": "$$ \\boxed{ \\frac{ - \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right] + \\sqrt{ \\left[ (\\xi D + E)k^2 + \\xi(s\\chi - r) \\right]^2 - 4 \\xi E k^2 (D k^2 - r) } }{2\\xi} } $$"
        },
        {
            "introduction": "真实的形态发生过程发生在主动变形的组织上。这最后一个练习通过解决在移动域上建模的挑战，将理论与计算现实联系起来。你将推导并实现任意拉格朗日-欧拉（Arbitrary Lagrangian-Eulerian, ALE）变换，这是在变化的几何背景上正确模拟反应-扩散过程的关键工具。",
            "id": "3900555",
            "problem": "考虑一个变形组织上的二维形态发生素场，该场由任意拉格朗日-欧拉（ALE）映射表示。令 $\\mathbf{X} = (X_1,X_2)$ 表示参考（物质）坐标，$\\mathbf{x} = (x_1,x_2)$ 表示当前（空间）坐标。ALE 映射是一个可微双射 $\\boldsymbol{\\varphi}(\\mathbf{X},t)$，其变形梯度为 $\\mathbf{F}(\\mathbf{X},t) = \\nabla_{\\mathbf{X}} \\boldsymbol{\\varphi}(\\mathbf{X},t)$，雅可比行列式为 $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$。当前构型上的标量形态发生素浓度 $u(\\mathbf{x},t)$ 在参考构型上有一个拉回（pullback）$\\hat{u}(\\mathbf{X},t) = u(\\boldsymbol{\\varphi}(\\mathbf{X},t),t)$。假设所有场都足够光滑且无量纲。\n\n仅从多元微积分中的链式法则、向量场的散度以及连续介质力学中的 Piola 变换（通过 $\\mathbf{F}$ 的协因子矩阵连接不同构型之间的通量）的基本定义出发，完成以下任务：\n\n1) 推导变换法则，用参考梯度 $\\nabla_{\\mathbf{X}} \\hat{u}$ 和变形梯度 $\\mathbf{F}$ 表示空间梯度 $\\nabla_{\\mathbf{x}} u$。你的推导必须从 $\\hat{u}(\\mathbf{X},t)$ 作为 $u(\\boldsymbol{\\varphi}(\\mathbf{X},t),t)$ 复合函数的定义开始，并严格应用链式法则。\n\n2) 推导空间拉普拉斯算子 $\\Delta_{\\mathbf{x}} u$ 的变换，用参考坐标微分算子以及 $\\mathbf{F}$ 和 $J$ 来表示。从定义 $\\Delta_{\\mathbf{x}} u = \\nabla_{\\mathbf{x}} \\cdot (\\nabla_{\\mathbf{x}} u)$ 开始，使用第 (1) 部分的结果，并调用 Piola 恒等式来连接 ALE 映射两边的散度。你的最终表达式必须纯粹用作用于拉回场 $\\hat{u}$ 的参考坐标导数以及 $\\mathbf{F}$ 和 $J$ 来写出。\n\n3) 实现一个程序，在指定的参考点 $\\mathbf{X}$ 和 ALE 映射 $\\boldsymbol{\\varphi}$ 下，评估由拉回场\n$$\n\\hat{u}(\\mathbf{X}) = e^{X_1} + \\sin(X_2) + X_1 X_2.\n$$\n所诱导的形态发生素场的空间梯度 $\\nabla_{\\mathbf{x}} u$ 和空间拉普拉斯算子 $\\Delta_{\\mathbf{x}} u$。对于空间梯度，使用你从第 (1) 部分推导的变换。对于拉普拉斯算子，实现第 (2) 部分的变换后的散度算子。当变形梯度在空间上变化时，使用步长为 $h = 10^{-6}$ 的二阶中心有限差分法来近似计算每个坐标方向上的参考坐标散度。在 $\\mathbf{F}$ 为常数的情况下，使用精确的解析表达式。\n\n4) 形态发生中的力化学耦合：在反应-扩散描述中，机械变形通过 ALE 映射进入扩散算子。在你的实现中，显式计算参考坐标系下的对称扩散张量，\n$$\n\\mathbf{B}(\\mathbf{X}) = J(\\mathbf{X})\\,\\mathbf{F}(\\mathbf{X})^{-1}\\,\\mathbf{F}(\\mathbf{X})^{-T},\n$$\n并根据你的推导，在变换后的拉普拉斯算子中使用它。假设在空间构型中扩散是各向同性的，因此力化学耦合完全由 $\\mathbf{B}$ 表示。\n\n使用以下测试套件，每个套件由一个 ALE 映射 $\\boldsymbol{\\varphi}$ 和一个评估点 $\\mathbf{X}$ 定义：\n\n- 测试 1 (正常路径，恒等映射): $\\boldsymbol{\\varphi}(\\mathbf{X}) = \\mathbf{X}$，于 $\\mathbf{X} = (0.1,-0.2)$。\n- 测试 2 (均匀各向同性扩张): $\\boldsymbol{\\varphi}(\\mathbf{X}) = s\\,\\mathbf{X}$，其中 $s=1.5$，于 $\\mathbf{X} = (0.1,-0.2)$。\n- 测试 3 (简单剪切): $\\boldsymbol{\\varphi}(\\mathbf{X}) = (X_1 + \\gamma X_2,\\, X_2)$，其中 $\\gamma=0.7$，于 $\\mathbf{X} = (0.3,0.4)$。\n- 测试 4 (非线性、空间变化的拉伸): $\\boldsymbol{\\varphi}(\\mathbf{X}) = \\big(X_1 + a \\sin(k X_1),\\, X_2 + b \\cos(k X_2)\\big)$，其中 $a=0.1$, $b=0.2$, $k=2.0$，于 $\\mathbf{X} = (0.3,-0.5)$。\n- 测试 5 (近奇异但可容许的映射): $\\boldsymbol{\\varphi}(\\mathbf{X}) = s\\,\\mathbf{X}$，其中 $s=0.05$，于 $\\mathbf{X} = (1.0,1.0)$。\n\n你的程序必须为每个测试计算空间梯度 $\\nabla_{\\mathbf{x}} u$ 的两个分量和标量空间拉普拉斯算子 $\\Delta_{\\mathbf{x}} u$，并按以下确切格式输出它们：一个单行，包含一个用方括号括起来的逗号分隔列表，该列表由测试 1 到 5 的三元组 $[\\text{grad}_{x,1},\\text{grad}_{x,2},\\Delta_x]$ 串联而成。每个数字必须四舍五入到八位小数。例如，包含两个测试的输出应如下所示：\n$[\\text{g}_{1,1},\\text{g}_{1,2},\\text{L}_1,\\text{g}_{2,1},\\text{g}_{2,2},\\text{L}_2]$。\n所有量都是无量纲的。如果出现角度，将以弧度为单位，但此处未使用。\n\n仅使用基本定义以确保科学真实性；除了你在第 (1) 和 (2) 部分推导出的公式外，不要假设任何快捷公式。你的最终程序必须是自包含的，并且不需要外部输入。",
            "solution": "此问题被评估为有效。它在科学上基于连续介质力学和反应扩散系统理论，特别是使用了在生物医学系统（如组织形态发生）建模中作为标准的任意拉格朗日-欧拉（ALE）表述。该问题是适定的，所有必要的函数、参数和数值方法都已明确定义，确保存在唯一且可验证的解。语言客观且数学上精确。该任务要求推导和应用基本的变换规则，这是一个非平凡但可行的问题。\n\n### 1) 空间梯度变换的推导\n\n梯度的变换规则由拉回浓度场 $\\hat{u}(\\mathbf{X}, t)$ 的定义和多元链式法则推导得出。为简化符号，由于所有运算都在一个固定的瞬间进行，因此省略了显式的时间依赖 $t$。\n\n拉回场 $\\hat{u}$ 定义为空间浓度场 $u$ 和 ALE 映射 $\\boldsymbol{\\varphi}$ 的复合：\n$$\n\\hat{u}(\\mathbf{X}) = u(\\boldsymbol{\\varphi}(\\mathbf{X}))\n$$\n令 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X})$。我们使用链式法则计算 $\\hat{u}$ 关于参考坐标 $\\mathbf{X}$ 的梯度。对于梯度 $\\nabla_{\\mathbf{X}}\\hat{u}$ 的第 $i$ 个分量，其分量形式为：\n$$\n(\\nabla_{\\mathbf{X}}\\hat{u})_i = \\frac{\\partial \\hat{u}}{\\partial X_i} = \\sum_{j=1}^{2} \\frac{\\partial u}{\\partial x_j} \\frac{\\partial x_j}{\\partial X_i}\n$$\n项 $\\frac{\\partial u}{\\partial x_j}$ 是空间梯度 $(\\nabla_{\\mathbf{x}}u)_j$ 的分量。项 $\\frac{\\partial x_j}{\\partial X_i}$ 是变形梯度张量 $\\mathbf{F}$ 的分量，其中 $F_{ji} = \\frac{\\partial x_j}{\\partial X_i}$。该求和可以用矩阵-向量表示法写出。认识到该表达式是行向量 $(\\nabla_{\\mathbf{x}}u)^T$ 和矩阵 $\\mathbf{F}$ 的乘积：\n$$\n(\\nabla_{\\mathbf{X}}\\hat{u})^T = (\\nabla_{\\mathbf{x}}u)^T \\mathbf{F}\n$$\n对两边进行转置得到：\n$$\n\\nabla_{\\mathbf{X}}\\hat{u} = (\\mathbf{F}^T) (\\nabla_{\\mathbf{x}}u)\n$$\n为了求解空间梯度 $\\nabla_{\\mathbf{x}}u$，我们用 $\\mathbf{F}^T$ 的逆矩阵进行左乘，假设变形是非奇异的，即 $\\det(\\mathbf{F}) \\neq 0$：\n$$\n\\nabla_{\\mathbf{x}}u = (\\mathbf{F}^T)^{-1} \\nabla_{\\mathbf{X}}\\hat{u}\n$$\n这通常写作 $\\nabla_{\\mathbf{x}}u = \\mathbf{F}^{-T} \\nabla_{\\mathbf{X}}\\hat{u}$，即所要求的变换法则。\n\n### 2) 空间拉普拉斯算子变换的推导\n\n空间拉普拉斯算子定义为空间梯度的散度：$\\Delta_{\\mathbf{x}} u = \\nabla_{\\mathbf{x}} \\cdot (\\nabla_{\\mathbf{x}} u)$。令空间通量向量为 $\\mathbf{q} = \\nabla_{\\mathbf{x}} u$。则 $\\Delta_{\\mathbf{x}} u = \\nabla_{\\mathbf{x}} \\cdot \\mathbf{q}$。\n\n空间坐标和参考坐标之间散度算子的变换由 Piola 恒等式给出。对于空间构型中的向量场 $\\mathbf{q}(\\mathbf{x})$，其在参考构型中的第一 Piola-Kirchhoff 表示是向量场 $\\mathbf{Q}(\\mathbf{X})$，定义为 $\\mathbf{Q} = J \\mathbf{F}^{-1} \\mathbf{q}$，其中 $J = \\det(\\mathbf{F})$。Piola 恒等式表明：\n$$\n\\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q} = J (\\nabla_{\\mathbf{x}} \\cdot \\mathbf{q})\n$$\n为求解空间散度，我们重新整理得到：\n$$\n\\nabla_{\\mathbf{x}} \\cdot \\mathbf{q} = \\frac{1}{J} \\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q}\n$$\n现在，我们必须用参考梯度 $\\nabla_{\\mathbf{X}}\\hat{u}$ 来表示参考通量 $\\mathbf{Q}$。我们首先将第 1 部分的结果 $\\mathbf{q} = \\nabla_{\\mathbf{x}}u = \\mathbf{F}^{-T} \\nabla_{\\mathbf{X}}\\hat{u}$ 代入 $\\mathbf{Q}$ 的定义中：\n$$\n\\mathbf{Q} = J \\mathbf{F}^{-1} (\\mathbf{F}^{-T} \\nabla_{\\mathbf{X}}\\hat{u})\n$$\n我们将张量项组合起来，定义问题陈述中给出的参考坐标扩散张量 $\\mathbf{B}(\\mathbf{X})$：\n$$\n\\mathbf{B}(\\mathbf{X}) = J \\mathbf{F}^{-1} \\mathbf{F}^{-T}\n$$\n因此，参考通量为 $\\mathbf{Q} = \\mathbf{B} (\\nabla_{\\mathbf{X}}\\hat{u})$。将其代回变换后的散度公式，得到空间拉普拉斯算子的最终表达式：\n$$\n\\Delta_{\\mathbf{x}} u = \\frac{1}{J} \\nabla_{\\mathbf{X}} \\cdot ( \\mathbf{B} \\nabla_{\\mathbf{X}}\\hat{u} )\n$$\n该表达式纯粹由参考坐标微分算子（$\\nabla_{\\mathbf{X}}\\cdot$ 和 $\\nabla_{\\mathbf{X}}$）、拉回场 $\\hat{u}$ 以及从 ALE 映射导出的几何量（$\\mathbf{F}$ 和 $J$）表示。\n\n### 3) 和 4) 实现计划\n\n程序将为五个测试用例评估空间梯度和拉普拉斯算子。拉回浓度场为 $\\hat{u}(\\mathbf{X}) = e^{X_1} + \\sin(X_2) + X_1 X_2$。\n\n其参考梯度和 Hessian 矩阵通过解析计算得出：\n$$\n\\nabla_{\\mathbf{X}} \\hat{u} = \\begin{pmatrix} e^{X_1} + X_2 \\\\ \\cos(X_2) + X_1 \\end{pmatrix}\n$$\n$$\n\\mathbf{H}_{\\hat{u}} = \\nabla_{\\mathbf{X}} \\nabla_{\\mathbf{X}} \\hat{u} = \\begin{pmatrix} e^{X_1}  1 \\\\ 1  -\\sin(X_2) \\end{pmatrix}\n$$\n对于每个测试用例，执行以下步骤：\n1.  根据给定的 ALE 映射 $\\boldsymbol{\\varphi}(\\mathbf{X})$，定义变形梯度 $\\mathbf{F}(\\mathbf{X})$ 的函数。\n2.  在指定点 $\\mathbf{X}_0$ 处计算 $\\mathbf{F}$。\n3.  计算雅可比行列式 $J = \\det(\\mathbf{F})$、逆矩阵 $\\mathbf{F}^{-1}$ 和逆转置矩阵 $\\mathbf{F}^{-T}$。\n4.  在 $\\mathbf{X}_0$ 处计算参考梯度 $\\nabla_{\\mathbf{X}}\\hat{u}$。\n5.  计算空间梯度：$\\nabla_{\\mathbf{x}}u = \\mathbf{F}^{-T} \\nabla_{\\mathbf{X}}\\hat{u}$。\n\n为了计算空间拉普拉斯算子 $\\Delta_{\\mathbf{x}} u$，我们必须评估项 $\\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q}$，其中 $\\mathbf{Q} = \\mathbf{B} \\nabla_{\\mathbf{X}}\\hat{u}$ 且 $\\mathbf{B} = J \\mathbf{F}^{-1} \\mathbf{F}^{-T}$。具体方法取决于 $\\mathbf{F}$ 是否在空间上为常数。\n\n- **常数 $\\mathbf{F}$ (测试 1, 2, 3, 5)：** 如果 $\\mathbf{F}$ 是常数，那么 $J$ 和 $\\mathbf{B}$ 也是常数。散度变为：\n  $$\n  \\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q} = \\nabla_{\\mathbf{X}} \\cdot (\\mathbf{B} \\nabla_{\\mathbf{X}}\\hat{u}) = \\mathbf{B} : (\\nabla_{\\mathbf{X}} \\nabla_{\\mathbf{X}}\\hat{u}) = \\text{Tr}(\\mathbf{B} \\mathbf{H}_{\\hat{u}})\n  $$\n  其中 $\\mathbf{H}_{\\hat{u}}$ 是 $\\hat{u}$ 的 Hessian 矩阵。这部分通过解析计算。\n\n- **空间变化的 $\\mathbf{F}$ (测试 4)：** 如果 $\\mathbf{F}$ 随 $\\mathbf{X}$ 变化，那么 $\\mathbf{Q}$ 也随之变化。散度 $\\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q} = \\frac{\\partial Q_1}{\\partial X_1} + \\frac{\\partial Q_2}{\\partial X_2}$ 使用步长为 $h = 10^{-6}$ 的二阶中心有限差分格式进行近似：\n  $$\n  \\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q}(\\mathbf{X}_0) \\approx \\frac{Q_1(X_{0,1}+h, X_{0,2}) - Q_1(X_{0,1}-h, X_{0,2})}{2h} + \\frac{Q_2(X_{0,1}, X_{0,2}+h) - Q_2(X_{0,1}, X_{0,2}-h)}{2h}\n  $$\n  这需要在 $\\mathbf{X}_0$ 周围的四个相邻点上计算完整的向量 $\\mathbf{Q}$。每次计算 $\\mathbf{Q}$ 都涉及在相应的相邻坐标上评估 $\\mathbf{F}(\\mathbf{X})$、 $J(\\mathbf{X})$、 $\\mathbf{B}(\\mathbf{X})$ 和 $\\nabla_{\\mathbf{X}}\\hat{u}(\\mathbf{X})$。\n\n最后，对于所有情况，通过将计算出的散度除以中心点 $\\mathbf{X}_0$ 处的雅可比行列式来获得空间拉普拉斯算子：$\\Delta_{\\mathbf{x}} u = \\frac{1}{J(\\mathbf{X}_0)} (\\nabla_{\\mathbf{X}} \\cdot \\mathbf{Q})(\\mathbf{X}_0)$。结果按指定格式进行格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mechanochemical coupling problem by deriving and implementing\n    transformations for gradient and Laplacian operators under an ALE map.\n    \"\"\"\n\n    # Define the pullback morphogen concentration field and its derivatives\n    def u_hat(X):\n        X1, X2 = X\n        return np.exp(X1) + np.sin(X2) + X1 * X2\n\n    def grad_u_hat(X):\n        X1, X2 = X\n        return np.array([\n            np.exp(X1) + X2,\n            np.cos(X2) + X1\n        ])\n\n    def hessian_u_hat(X):\n        X1, X2 = X\n        return np.array([\n            [np.exp(X1), 1.0],\n            [1.0, -np.sin(X2)]\n        ])\n\n    # Define the test cases\n    test_cases = [\n        {\n            'id': 1,\n            'X0': np.array([0.1, -0.2]),\n            'params': {},\n            'F_func': lambda X, p: np.identity(2),\n            'is_F_const': True\n        },\n        {\n            'id': 2,\n            'X0': np.array([0.1, -0.2]),\n            'params': {'s': 1.5},\n            'F_func': lambda X, p: p['s'] * np.identity(2),\n            'is_F_const': True\n        },\n        {\n            'id': 3,\n            'X0': np.array([0.3, 0.4]),\n            'params': {'gamma': 0.7},\n            'F_func': lambda X, p: np.array([[1.0, p['gamma']], [0.0, 1.0]]),\n            'is_F_const': True\n        },\n        {\n            'id': 4,\n            'X0': np.array([0.3, -0.5]),\n            'params': {'a': 0.1, 'b': 0.2, 'k': 2.0},\n            'F_func': lambda X, p: np.array([\n                [1.0 + p['a'] * p['k'] * np.cos(p['k'] * X[0]), 0.0],\n                [0.0, 1.0 - p['b'] * p['k'] * np.sin(p['k'] * X[1])]\n            ]),\n            'is_F_const': False\n        },\n        {\n            'id': 5,\n            'X0': np.array([1.0, 1.0]),\n            'params': {'s': 0.05},\n            'F_func': lambda X, p: p['s'] * np.identity(2),\n            'is_F_const': True\n        }\n    ]\n\n    all_results = []\n    h = 1e-6  # Finite difference step size\n\n    for case in test_cases:\n        X0 = case['X0']\n        params = case['params']\n        F_func = case['F_func']\n\n        # --- Base calculations at X0 ---\n        F0 = F_func(X0, params)\n        J0 = np.linalg.det(F0)\n        F0_inv = np.linalg.inv(F0)\n        F0_inv_T = F0_inv.T\n        \n        grad_u_hat0 = grad_u_hat(X0)\n\n        # --- 1. Compute Spatial Gradient ---\n        spatial_grad = F0_inv_T @ grad_u_hat0\n\n        # --- 2. Compute Spatial Laplacian ---\n        div_Q = 0.0\n        if case['is_F_const']:\n            # Analytical method for constant F\n            B0 = J0 * F0_inv @ F0_inv_T\n            H0 = hessian_u_hat(X0)\n            # div(Q) = Tr(B * H_u_hat) for constant B\n            div_Q = np.trace(B0 @ H0)\n        else:\n            # Finite difference method for varying F\n            def compute_Q(X_point, p, f_func):\n                F_point = f_func(X_point, p)\n                J_point = np.linalg.det(F_point)\n                F_inv_point = np.linalg.inv(F_point)\n                \n                # B = J * F^-1 * F^-T\n                B_point = J_point * F_inv_point @ F_inv_point.T\n                \n                grad_u_hat_point = grad_u_hat(X_point)\n                \n                # Q = B * grad(u_hat)\n                Q_point = B_point @ grad_u_hat_point\n                return Q_point\n\n            # Points for central difference\n            X1_plus_h = X0 + np.array([h, 0.0])\n            X1_minus_h = X0 - np.array([h, 0.0])\n            X2_plus_h = X0 + np.array([0.0, h])\n            X2_minus_h = X0 - np.array([0.0, h])\n\n            Q_x1_plus = compute_Q(X1_plus_h, params, F_func)\n            Q_x1_minus = compute_Q(X1_minus_h, params, F_func)\n            \n            Q_x2_plus = compute_Q(X2_plus_h, params, F_func)\n            Q_x2_minus = compute_Q(X2_minus_h, params, F_func)\n\n            # dQ1/dX1 + dQ2/dX2\n            dQ1_dX1 = (Q_x1_plus[0] - Q_x1_minus[0]) / (2 * h)\n            dQ2_dX2 = (Q_x2_plus[1] - Q_x2_minus[1]) / (2 * h)\n            div_Q = dQ1_dX1 + dQ2_dX2\n        \n        spatial_laplacian = div_Q / J0\n\n        all_results.extend([spatial_grad[0], spatial_grad[1], spatial_laplacian])\n\n    # Format the final output\n    formatted_results = [f\"{val:.8f}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}