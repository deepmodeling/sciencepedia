{
    "hands_on_practices": [
        {
            "introduction": "掌握非牛顿流体模型的第一步是能够在一个明确定义的流动场景中，应用其本构关系。本练习将引导你使用Carreau-Yasuda模型——一个广泛用于描述血液剪切稀化特性的模型——来计算简单剪切流中的剪切应力。通过从最基本的张量定义出发，你将巩固对广义牛顿流体框架下应力与应变率之间关系的理解 。",
            "id": "3911168",
            "problem": "血浆中的红细胞悬浮液被建模为一种不可压缩的广义牛顿流体，其表观粘度依赖于剪切速率。考虑一个矩形微通道段中的稳态简单剪切流，其速度场为 $\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$，其中 $\\dot{\\gamma} > 0$ 是一个恒定的工程剪切速率。广义牛顿流体的偏柯西应力定义为 $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$，其中 $\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$ 是应变率张量，而 $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$ 是基于第二不变量的剪切速率大小。表观粘度服从 Carreau–Yasuda 模型\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\\,,\n$$\n参数值为 $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$，$\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$，$\\lambda = 3.313\\,\\text{s}$，$a = 2$，以及 $n = 0.3568$。取 $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$。 \n\n从上述定义出发（不使用额外的本构简化），推导在此简单剪切条件下剪切应力分量 $\\tau_{xy}$ 的表达式，用 $\\eta(\\dot{\\gamma}_{\\text{eff}})$ 和 $\\dot{\\gamma}$ 表示。计算 Carreau–Yasuda 流体的 $\\tau_{xy}$ 的数值，单位为帕斯卡。为了比较，也请计算在恒定粘度等于 $\\eta_{\\infty}$ 情况下的牛顿剪切应力，单位为帕斯卡。最后，报告无量纲比值\n$$\nR \\;=\\; \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}\\,.\n$$\n将最终报告的比值 $R$ 四舍五入到四位有效数字。剪切应力以帕斯卡为单位表示。",
            "solution": "该问题已根据指定标准进行验证。\n\n### 第1步：提取已知条件\n- 速度场：$\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$，其中 $\\dot{\\gamma} > 0$。\n- 偏柯西应力：$\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$。\n- 应变率张量定义：$\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$。\n- 有效剪切速率定义：$\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$。\n- Carreau–Yasuda 表观粘度模型：\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\n$$\n- 参数值：\n  - $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$ (零剪切粘度)\n  - $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$ (无穷剪切粘度)\n  - $\\lambda = 3.313\\,\\text{s}$ (松弛时间)\n  - $a = 2$ (模型参数)\n  - $n = 0.3568$ (幂律指数)\n- 工程剪切速率：$\\dot{\\gamma} = 100\\,\\text{s}^{-1}$。\n- 任务：\n  1. 推导用 $\\eta(\\dot{\\gamma}_{\\text{eff}})$ 和 $\\dot{\\gamma}$ 表示的 $\\tau_{xy}$ 表达式。\n  2. 计算 Carreau–Yasuda 流体的 $\\tau_{xy}$ 数值，单位为帕斯卡。\n  3. 计算恒定粘度 $\\eta = \\eta_{\\infty}$ 的牛顿剪切应力，单位为帕斯卡。\n  4. 报告无量纲比值 $R = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}$，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了广义牛顿流体和 Carreau–Yasuda 模型的概念，这些都是非牛顿流体力学和血液流变学中的标准和成熟模型。物理设置（简单剪切流）是一个基础案例研究。所有概念都基于连续介质力学的既定原理。\n- **良态问题：** 问题陈述提供了所有必要的定义、方程和参数值，以唯一确定待求量。任务具体，并能得出比值 $R$ 的唯一数值答案。\n- **客观性：** 问题以精确、定量和无偏见的科学语言陈述。没有主观因素。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n分析从给定的稳态简单剪切流的速度场 $\\mathbf{u} = (u_x, u_y, u_z) = (\\dot{\\gamma}y, 0, 0)$ 开始。\n\n首先，我们计算速度梯度张量 $\\nabla\\mathbf{u}$：\n$$\n\\nabla\\mathbf{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y}  \\frac{\\partial u_x}{\\partial z} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y}  \\frac{\\partial u_y}{\\partial z} \\\\ \\frac{\\partial u_z}{\\partial x}  \\frac{\\partial u_z}{\\partial y}  \\frac{\\partial u_z}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n接着，我们求应变率张量 $\\mathbf{D} = \\frac{1}{2}(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^{\\mathsf{T}})$：\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\dot{\\gamma}}{2}  0 \\\\ \\frac{\\dot{\\gamma}}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n唯一非零的分量是 $D_{xy} = D_{yx} = \\frac{\\dot{\\gamma}}{2}$。\n\n现在，我们计算有效剪切速率 $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$。双点积 $\\mathbf{D}:\\mathbf{D}$ 是张量各分量平方的总和：\n$$\n\\mathbf{D}:\\mathbf{D} = \\sum_{i,j} D_{ij} D_{ij} = D_{xy}^2 + D_{yx}^2 = \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 + \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 = 2 \\left(\\frac{\\dot{\\gamma}^2}{4}\\right) = \\frac{\\dot{\\gamma}^2}{2}\n$$\n将此代入 $\\dot{\\gamma}_{\\text{eff}}$ 的定义中：\n$$\n\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2 \\left(\\frac{\\dot{\\gamma}^2}{2}\\right)} = \\sqrt{\\dot{\\gamma}^2} = |\\dot{\\gamma}|\n$$\n由于题目说明 $\\dot{\\gamma} > 0$，我们得到 $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$。\n\n偏柯西应力张量由 $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$ 给出。我们关心的是剪切应力分量 $\\tau_{xy}$。以分量形式表示，该关系为 $\\tau_{ij} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{ij}$。\n对于 $xy$ 分量：\n$$\n\\tau_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\left(\\frac{\\dot{\\gamma}}{2}\\right) = \\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\dot{\\gamma}\n$$\n由于对于此流动 $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$，该表达式也可以写作 $\\tau_{xy} = \\eta(\\dot{\\gamma})\\,\\dot{\\gamma}$。这就完成了任务的第一部分。\n\n接下来，我们计算数值。剪切速率为 $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$，所以 $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$。\n我们使用 Carreau–Yasuda 模型计算表观粘度：\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) = \\eta_{\\infty} + (\\eta_{0} - \\eta_{\\infty})\\,\\Big[1 + (\\lambda\\,\\dot{\\gamma}_{\\text{eff}})^{a}\\Big]^{\\frac{n-1}{a}}\n$$\n代入给定的参数值：\n- $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$\n- $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$\n- $\\lambda = 3.313\\,\\text{s}$\n- $a = 2$\n- $n = 0.3568$\n- $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$\n\n项 $\\lambda\\,\\dot{\\gamma}_{\\text{eff}} = (3.313\\,\\text{s})(100\\,\\text{s}^{-1}) = 331.3$。\n指数为 $\\frac{n-1}{a} = \\frac{0.3568 - 1}{2} = \\frac{-0.6432}{2} = -0.3216$。\n粘度为：\n$$\n\\eta(100) = 0.00345 + (0.056 - 0.00345)\\,\\Big[1 + (331.3)^{2}\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[1 + 109759.69\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[109760.69\\Big]^{-0.3216}\n$$\n计算方括号中的项：\n$$\n[109760.69]^{-0.3216} \\approx 0.02390553\n$$\n所以，表观粘度为：\n$$\n\\eta(100) \\approx 0.00345 + (0.05255)(0.02390553) \\approx 0.00345 + 0.00125623 \\approx 0.00470623\\,\\text{Pa}\\cdot\\text{s}\n$$\nCarreau–Yasuda 流体的剪切应力为：\n$$\n\\tau_{xy}^{\\text{(Carreau–Yasuda)}} = \\eta(100)\\,\\dot{\\gamma} \\approx (0.00470623\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) \\approx 0.470623\\,\\text{Pa}\n$$\n为了比较，我们计算恒定粘度为 $\\eta = \\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$ 的牛顿流体的剪切应力。\n$$\n\\tau_{xy}^{\\text{(Newtonian)}} = \\eta_{\\infty}\\,\\dot{\\gamma} = (0.00345\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) = 0.345\\,\\text{Pa}\n$$\n最后，我们计算无量纲比值 $R$：\n$$\nR = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian)}}} \\approx \\frac{0.470623}{0.345} \\approx 1.3641246\n$$\n按要求四舍五入到四位有效数字，我们得到 $R = 1.364$。",
            "answer": "$$\n\\boxed{1.364}\n$$"
        },
        {
            "introduction": "血液在极低剪切率下的行为，特别是其屈服应力（yield stress）的存在，是血液流变学中的一个核心概念。不同的本构模型对此有不同的数学描述，这直接影响到模型的物理真实性和计算稳定性。本练习通过比较Casson、Herschel-Bulkley以及经过正则化处理的Papanastasiou模型在零剪切极限下的应力表现，让你深入理解理想屈服应力模型与计算友好型模型之间的关键差异 。",
            "id": "3911152",
            "problem": "在生理温度下，对一份人体血液样本施加均匀简单剪切，剪切速率趋近于零。考虑三种广为接受的非牛顿本构描述：Casson 模型、Herschel–Bulkley 模型和 Papanastasiou 正则化 Herschel–Bulkley 模型。“低剪切应力平台”定义为极限 $ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) $，其中 $ \\tau $ 是剪切应力，$ \\dot{\\gamma} $ 是剪切速率。使用一组在 $ 37\\,^{\\circ}\\mathrm{C} $ 且红细胞比容接近 $ 45\\,\\% $ 时人体血液的典型参数：\n- Casson 模型参数：屈服应力 $ \\tau_{y,C} = 0.010 $ Pa，Casson 粘度参数 $ \\eta_{C} = 3.5 \\times 10^{-3} $ Pa·s。\n- Herschel–Bulkley 模型参数：屈服应力 $ \\tau_{y,HB} = 0.010 $ Pa，稠度系数 $ K = 1.40 \\times 10^{-2} $ Pa·s$^{n} $，流动指数 $ n = 0.70 $。\n- Papanastasiou 正则化 Herschel–Bulkley 模型参数：$ \\tau_{y,P} = 0.010 $ Pa，$ K = 1.40 \\times 10^{-2} $ Pa·s$^{n} $，$ n = 0.70 $，正则化参数 $ m = 100 $ s。\n\n从每种模型的剪切应力和剪切速率的本构定义出发，推导这三种模型各自的低剪切应力平台，并使用上述参数计算其数值。将每个平台应力以帕斯卡 (Pa) 为单位表示。将您的答案保留到四位有效数字。以行矩阵的形式给出您的最终答案，其中的元素按以下顺序排列：Casson、Herschel–Bulkley、Papanastasiou。",
            "solution": "该问题要求针对应用于人体血液的三种非牛顿流体模型，推导并计算“低剪切应力平台”。低剪切应力平台被明确定义为剪切应力 $ \\tau $ 在剪切速率 $ \\dot{\\gamma} $ 从正方向趋近于零时的极限：$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) $。\n\n验证过程确认了该问题具有科学依据、提法明确且信息完整。所提供的模型是血液流变学中的标准模型，参数是符合实际的，且目标在数学上是精确的。因此，我们可以开始求解。\n\n对于每种模型，我们将陈述关联 $ \\tau $ 和 $ \\dot{\\gamma} $ 的本构方程，然后计算指定的极限。\n\n1.  **Casson 模型**\n    对于屈服应力流体，当剪切速率 $ \\dot{\\gamma} > 0 $ 时，Casson 模型由以下关系式定义：\n    $$ \\sqrt{\\tau} = \\sqrt{\\tau_{y,C}} + \\sqrt{\\eta_{C} \\dot{\\gamma}} $$\n    其中 $ \\tau_{y,C} $ 是屈服应力，$ \\eta_{C} $ 是 Casson 粘度参数。当应力低于屈服应力 $ \\tau  \\tau_{y,C} $ 时，流体不流动，即 $ \\dot{\\gamma} = 0 $。为了求得函数 $ \\tau(\\dot{\\gamma}) $，我们将方程两边平方：\n    $$ \\tau(\\dot{\\gamma}) = \\left( \\sqrt{\\tau_{y,C}} + \\sqrt{\\eta_{C} \\dot{\\gamma}} \\right)^2 = \\tau_{y,C} + 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} + \\eta_{C}\\dot{\\gamma} $$\n    此表达式在 $ \\dot{\\gamma} > 0 $ 时有效。现在，我们计算当 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,C} + 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} + \\eta_{C}\\dot{\\gamma} \\right) $$\n    当 $ \\dot{\\gamma} $ 趋近于 $ 0 $ 时，$ 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} $ 项和 $ \\eta_{C}\\dot{\\gamma} $ 项都趋近于 $ 0 $。因此，极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\tau_{y,C} + 0 + 0 = \\tau_{y,C} $$\n    低剪切应力平台就是屈服应力本身。使用给定参数 $ \\tau_{y,C} = 0.010 $ Pa，并保留到四位有效数字，其值为 $ 0.01000 $ Pa。\n\n2.  **Herschel–Bulkley 模型**\n    Herschel–Bulkley 模型是另一种屈服应力模型，对于 $ \\dot{\\gamma} > 0 $，其定义为：\n    $$ \\tau(\\dot{\\gamma}) = \\tau_{y,HB} + K \\dot{\\gamma}^{n} $$\n    其中 $ \\tau_{y,HB} $ 是屈服应力，$ K $ 是稠度指数，$ n $ 是流动行为指数。当 $ \\tau  \\tau_{y,HB} $ 时，我们有 $ \\dot{\\gamma} = 0 $。我们计算该函数在 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,HB} + K \\dot{\\gamma}^{n} \\right) $$\n    鉴于流动指数 $ n = 0.70 > 0 $，当 $ \\dot{\\gamma} \\to 0^{+} $ 时，$ \\dot{\\gamma}^{n} $ 项趋近于 $ 0 $。因此，极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\tau_{y,HB} + K(0) = \\tau_{y,HB} $$\n    与 Casson 模型类似，Herschel–Bulkley 模型的低剪切应力平台也是其屈服应力。使用给定参数 $ \\tau_{y,HB} = 0.010 $ Pa，并保留到四位有效数字，其值为 $ 0.01000 $ Pa。\n\n3.  **Papanastasiou 正则化 Herschel–Bulkley 模型**\n    Papanastasiou 模型对 Herschel–Bulkley 模型进行正则化，以创建一个对所有剪切速率（包括 $ \\dot{\\gamma}=0 $）都有效的单一、连续的应力表达式。这是通过用一个指数函数来修正屈服应力项实现的。其本构方程为：\n    $$ \\tau(\\dot{\\gamma}) = \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] + K \\dot{\\gamma}^{n} $$\n    其中 $ m $ 是正则化参数。与前两个模型不同，该方程在 $ \\dot{\\gamma}=0 $ 处有定义且是连续的。我们计算当 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] + K \\dot{\\gamma}^{n} \\right) $$\n    我们可以分别计算每一项的极限。\n    对于第一项，当 $ \\dot{\\gamma} \\to 0^{+} $ 时，指数 $ -m\\dot{\\gamma} \\to 0 $。因此，$ \\exp(-m\\dot{\\gamma}) \\to \\exp(0) = 1 $。第一项变为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] = \\tau_{y,P} \\left[ 1 - 1 \\right] = 0 $$\n    对于第二项，因为 $ n=0.70 > 0 $，我们有：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} K \\dot{\\gamma}^{n} = K (0)^{n} = 0 $$\n    综合这些结果，总极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = 0 + 0 = 0 $$\n    正则化通过消除在 $ \\dot{\\gamma}=0 $ 处的不连续性使模型在计算上更加稳定，其结果是在零剪切速率下应力为零。因此，由极限定义的低剪切应力平台恰好为 $ 0 $。\n    数值为 $ 0 $ Pa。用四位有效数字表示，即为 $ 0.0000 $ Pa。\n\n最终计算值为：\n- Casson: $ 0.01000 $ Pa\n- Herschel–Bulkley: $ 0.01000 $ Pa\n- Papanastasiou: $ 0.0000 $ Pa",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01000  0.01000  0.0000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将流变模型应用于生物医学系统（如动脉血管）的计算流体动力学（CFD）模拟时，保证计算结果的准确性至关重要。本练习是一个高级计算实践，旨在通过对颈动脉分叉简化模型中的壁面剪切应力（Wall Shear Stress, WSS）进行网格收敛性研究，来量化数值不确定性。你将学习并应用Richardson外推法和网格收敛指数（GCI）等关键技术，这是验证和确认计算模型可靠性的标准方法 。",
            "id": "3911098",
            "problem": "您的任务是设计并实现一个数值网格加密研究，使用剪切稀化广义牛顿血液模型来估算简化的颈动脉分叉段中的壁面剪切应力（WSS），并量化数值不确定性。目标是展示如何从离散化的速度场计算出的 WSS 收敛到一个参考值，并使用 Richardson 外推法计算观测到的精度阶和网格收敛指数（GCI）。颈动脉分叉将由三个直的、轴对称的、圆柱形的管段来表示，分别近似于颈总动脉、颈内动脉和颈外动脉。流动被假定为稳态、不可压缩、层流，并且在每个管段内都是充分发展的，血液被建模为通过 Carreau-Yasuda（CY）黏度模型表现出剪切稀化特性的广义牛顿流体。\n\n基本原理：\n- 在直圆管中，对于稳态、充分发展、轴对称、不可压缩的流动，其动量平衡意味着壁面剪切应力源于轴向压力梯度和径向剪切应力分布。该控制平衡基于线性动量守恒和柱坐标系下的对称性。\n- 广义牛顿本构关系通过一个依赖于剪切率的黏度函数，将剪切应力与剪切率联系起来。\n- Carreau-Yasuda 黏度函数是公认的用于表示血液剪切稀化行为的模型。\n\n您的任务：\n1. 对于每个圆柱形管段，将轴向压力梯度 $dp/dz$ 视为空间均匀的，管半径 $R$ 视为常数。广义牛顿流体遵循 Carreau-Yasuda 黏度函数，其参数为 $(\\mu_0, \\mu_{\\infty}, \\lambda, a, n)$，其中 $\\mu(\\dot{\\gamma})$ 依赖于剪切率 $\\dot{\\gamma}$。\n2. 使用充分发展的动量平衡来获得剪切应力作为半径的函数分布，然后对于每个径向位置 $r$，通过 Carreau-Yasuda 模型数值求解剪切应力与剪切率之间的代数关系，以获得 $\\dot{\\gamma}(r)$。接着，根据关系式 $dv/dr = -\\dot{\\gamma}(r)$ 和无滑移边界条件 $v(R) = 0$ 重构速度剖面 $v(r)$。\n3. 使用壁面处的单边有限差分近似，从近壁速度梯度计算数值壁面剪切应力（WSS）。具体来说，在一个包含 $N+1$ 个节点、间距为 $h = R/N$ 且 $v(R)=0$ 的均匀径向网格上，通过 $\\dot{\\gamma}_w \\approx \\left[v(r_{N-1}) - v(R)\\right]/h$ 来近似壁面剪切率，然后计算数值 WSS 为 $\\tau_w^{(h)} = \\mu(\\dot{\\gamma}_w)\\dot{\\gamma}_w$。\n4. 对每个测试用例，执行一个三级网格加密研究，使用恒定的加密比 $r = h_1/h_2 = h_2/h_3$，并采用 $N_1, N_2, N_3$ 使得 $N_2 = 2N_1$ 且 $N_3 = 2N_2$。使用三个数值 WSS 值 $\\phi_1 = \\tau_w^{(h_1)}$、$\\phi_2 = \\tau_w^{(h_2)}$ 和 $\\phi_3 = \\tau_w^{(h_3)}$，计算：\n   - 通过 Richardson 分析得到的观测精度阶 $p$。\n   - 在零网格间距极限下的 Richardson 外推 WSS 值 $\\phi_{\\text{ext}}$。\n   - 在最细网格上，安全因子为 $1.25$ 时的网格收敛指数（GCI）。\n5. 为了验证，还需计算直接从充分发展轴对称流动的动量平衡得到的解析参考 WSS，该值是压力梯度和半径的函数。\n6. 以帕斯卡（Pa）为单位表示 WSS 值。不涉及角度。所有输出必须是数值浮点数。\n\nCarreau-Yasuda 黏度模型定义：\n- Carreau-Yasuda (CY) 黏度模型 (Carreau-Yasuda)：给定剪切率 $\\dot{\\gamma}$，定义\n$$\n\\mu(\\dot{\\gamma}) = \\mu_{\\infty} + \\left(\\mu_0 - \\mu_{\\infty}\\right)\\left[1 + \\left(\\lambda \\dot{\\gamma}\\right)^a\\right]^{\\frac{n-1}{a}}.\n$$\n\n用于验证的参考 WSS：\n- 对于直圆管中的充分发展轴对称流动，壁面剪切应力满足\n$$\n\\tau_w^{(\\text{ref})} = -\\frac{dp}{dz}\\frac{R}{2},\n$$\n其中，对于沿轴线从高压流向低压的流动，$dp/dz  0$。使用此解析值作为误差评估的参考。\n\n数值程序约束：\n- 使用一个具有 $N+1$ 个节点的均匀径向网格，节点位置为 $r_i = i h$，其中 $i=0,\\ldots,N$，间距为 $h = R/N$。\n- 在每个半径 $r_i$ 处，通过数值求解代数方程 $\\mu(\\dot{\\gamma})\\dot{\\gamma} = \\tau(r_i)$ 来确定 $\\dot{\\gamma}(r_i)$，其中 $\\tau(r)$ 是由充分发展动量平衡给出的剪切应力分布。然后通过数值积分计算 $v(r)$，以重构与 $dv/dr = -\\dot{\\gamma}(r)$ 和 $v(R)=0$ 一致的速度剖面。\n- 使用单边差分近似近壁剪切率，并计算相应的数值 WSS。\n- 应用加密比为 $r=2$ 的三层网格 Richardson 分析来估算 $p$、$\\phi_{\\text{ext}}$ 和 GCI。\n\n测试套件：\n用指定的参数实现以下三个测试用例。在每个用例中，计算并报告四个量：解析参考 WSS $\\tau_w^{(\\text{ref})}$、最细网格的数值 WSS $\\phi_3 = \\tau_w^{(h_3)}$、观测到的精度阶 $p$ 以及最细网格的 GCI。\n\n- 测试用例 1（颈总动脉替代模型）：\n  - 半径 $R = 0.0045$ m\n  - 轴向压力梯度 $dp/dz = -1000$ Pa/m\n  - Carreau-Yasuda 参数：$\\mu_0 = 0.16$ Pa·s, $\\mu_{\\infty} = 0.0035$ Pa·s, $\\lambda = 3.313$ s, $a = 0.64$, $n = 0.2128$\n  - 网格：$N_1 = 32$, $N_2 = 64$, $N_3 = 128$\n- 测试用例 2（颈内动脉替代模型，更强的剪切稀化）：\n  - 半径 $R = 0.0028$ m\n  - 轴向压力梯度 $dp/dz = -1500$ Pa/m\n  - Carreau-Yasuda 参数：$\\mu_0 = 0.20$ Pa·s, $\\mu_{\\infty} = 0.0030$ Pa·s, $\\lambda = 2.5$ s, $a = 0.64$, $n = 0.20$\n  - 网格：$N_1 = 16$, $N_2 = 32$, $N_3 = 64$\n- 测试用例 3（近牛顿流体极限）：\n  - 半径 $R = 0.0035$ m\n  - 轴向压力梯度 $dp/dz = -800$ Pa/m\n  - Carreau-Yasuda 参数：$\\mu_0 = 0.0035$ Pa·s, $\\mu_{\\infty} = 0.0035$ Pa·s, $\\lambda = 10^{-6}$ s, $a = 0.64$, $n = 1.0$\n  - 网格：$N_1 = 8$, $N_2 = 16$, $N_3 = 32$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例的结果本身也是一个列表，形式为 $[\\tau_w^{(\\text{ref})}, \\phi_3, p, \\text{GCI}_{\\text{fine}}]$。例如：$[[\\dots],[\\dots],[\\dots]]$。\n- 每个测试用例的四个值都必须是国际单位制（SI 单位）下的浮点数，其中 WSS 的单位是帕斯卡。",
            "solution": "用户提供了一个定义明确且科学上合理的问题。任务是使用 Carreau-Yasuda 血液黏度模型，在理想化的动脉段中执行网格加密研究，以计算壁面剪切应力（WSS）。该解决方案需要结合多种数值方法：用于本构方程的求根、用于速度剖面的数值积分、用于壁面剪切率的有限差分以及用于收敛性分析的 Richardson 外推法。\n\n该问题的有效性验证如下：\n- **科学基础**：问题基于充分发展的内部流动的动量平衡基本原理，并使用了已建立的 Carreau-Yasuda 模型来描述非牛顿流体的流变学特性。数值分析技术（Richardson 外推法、网格收敛指数）是计算流体动力学中用于验证和确认的标准方法。\n- **良态问题**：所有必需的参数、方程和边界条件均已提供。程序被明确无误地指定，从而导向一个唯一的数值解。待求解的关于剪切率的非线性代数方程是单调的，确保了根的唯一性。\n- **目标**：问题以精确的数学术语陈述，没有任何主观或定性的语言。\n\n问题被认定为有效，并构建了分步解决方案。\n\n**第 1 步：解析与本构关系**\n\n对于半径为 $R$ 的圆管内稳态、不可压缩、充分发展、轴对称的流动，轴向动量方程简化为：\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\tau_{rz}\\right) = \\frac{dp}{dz}\n$$\n其中 $\\tau_{rz}$ 是剪切应力，$dp/dz$ 是恒定的轴向压力梯度。对 $r$ 积分并应用应力在轴心（$r=0$）处必须有限的边界条件，得到线性剪切应力分布：\n$$\n\\tau_{rz}(r) = \\frac{r}{2}\\frac{dp}{dz}\n$$\n剪切应力大小为 $\\tau(r) = |\\tau_{rz}(r)|$。由于流动是由压力降驱动的，因此 $dp/dz  0$，所以：\n$$\n\\tau(r) = -\\frac{r}{2}\\frac{dp}{dz}\n$$\n在壁面（$r=R$）处，这给出了解析参考壁面剪切应力（WSS）：\n$$\n\\tau_w^{(\\text{ref})} = -\\frac{R}{2}\\frac{dp}{dz}\n$$\n\n流体被建模为广义牛顿流体，其中剪切应力 $\\tau$ 与剪切率 $\\dot{\\gamma}$ 通过 $\\tau = \\mu(\\dot{\\gamma})\\dot{\\gamma}$ 相关联。黏度 $\\mu$ 是剪切率的函数，并由 Carreau-Yasuda 模型描述：\n$$\n\\mu(\\dot{\\gamma}) = \\mu_{\\infty} + \\left(\\mu_0 - \\mu_{\\infty}\\right)\\left[1 + \\left(\\lambda \\dot{\\gamma}\\right)^a\\right]^{\\frac{n-1}{a}}\n$$\n其中 $\\mu_0$ 是零剪切率黏度，$\\mu_{\\infty}$ 是无限剪切率黏度，$\\lambda$ 是时间常数，而 $a$ 和 $n$ 是控制过渡区和幂律区的无量纲参数。\n\n**第 2 步：单个网格的数值程序**\n\n对于给定的具有 $N$ 个区间和间距 $h = R/N$ 的网格，我们计算数值 WSS，即 $\\tau_w^{(h)}$。\n\n1.  **离散化域**：为 $i = 0, 1, \\dots, N$ 定义一个包含 $N+1$ 个节点的均匀网格 $r_i = i \\cdot h$。\n2.  **计算剪切应力剖面**：在每个节点 $r_i$ 处，计算局部剪切应力 $\\tau(r_i) = -(dp/dz) \\cdot r_i / 2$。\n3.  **计算剪切率剖面**：在每个节点 $r_i$ 处（对于 $i>0$，因为 $\\tau(0)=0 \\implies \\dot{\\gamma}(0)=0$），通过数值求解非线性代数方程来找到剪切率 $\\dot{\\gamma}(r_i)$：\n    $$\n    f(\\dot{\\gamma}) = \\mu(\\dot{\\gamma})\\dot{\\gamma} - \\tau(r_i) = 0\n    $$\n    使用数值求根算法（如 Brent-Dekker 方法，`scipy.optimize.brentq`），为 $\\dot{\\gamma} = \\dot{\\gamma}(r_i)$ 求解此方程，该算法对单调函数非常高效。\n4.  **重构速度剖面**：速度剖面 $v(r)$ 通过 $\\dot{\\gamma}(r) = -dv/dr$ 与剪切率剖面相关联。应用无滑移边界条件 $v(R)=0$，我们可以通过积分找到任意径向位置 $r$ 处的速度：\n    $$\n    v(r) = \\int_r^R \\dot{\\gamma}(s) ds\n    $$\n    该积分在离散剪切率剖面 $\\dot{\\gamma}(r_j)$ 上使用梯形法则对每个网格节点 $r_i$ 进行数值计算。`scipy.integrate.cumulative_trapezoid` 函数适用于此任务。\n5.  **计算数值壁面剪切应力**：WSS 从近壁速度梯度计算得出。按照规定，壁面剪切率 $\\dot{\\gamma}_w$ 使用一阶单边有限差分进行近似：\n    $$\n    \\dot{\\gamma}_{w, \\text{approx}} \\approx \\frac{v(r_{N-1}) - v(R)}{h} = \\frac{v(R-h)}{h}\n    $$\n    在壁面处的相应黏度为 $\\mu(\\dot{\\gamma}_{w, \\text{approx}})$。此网格上的数值 WSS 随之为：\n    $$\n    \\tau_w^{(h)} = \\mu(\\dot{\\gamma}_{w, \\text{approx}}) \\cdot \\dot{\\gamma}_{w, \\text{approx}}\n    $$\n\n**第 3 步：网格收敛性分析**\n\n此程序在三个系统性加密的网格上执行，其尺寸为 $N_1$、$N_2=r \\cdot N_1$ 和 $N_3=r \\cdot N_2$，其中加密比为 $r=2$。这将产生三个数值 WSS 值：$\\phi_1 = \\tau_w^{(h_1)}$、$\\phi_2 = \\tau_w^{(h_2)}$ 和 $\\phi_3 = \\tau_w^{(h_3)}$。这些值用于评估数值解的质量。\n\n1.  **观测精度阶 ($p$)**：数值解收敛到精确解的速率估计为：\n    $$\n    p = \\frac{\\ln\\left( \\frac{\\phi_1 - \\phi_2}{\\phi_2 - \\phi_3} \\right)}{\\ln(r)}\n    $$\n    此公式假定单调收敛，其中差值 $(\\phi_1-\\phi_2)$ 和 $(\\phi_2-\\phi_3)$ 符号相同。\n\n2.  **Richardson 外推法 ($\\phi_{\\text{ext}}$)**：通过 Richardson 外推法获得无限精细网格（$h \\to 0$）上的 WSS 值的估计：\n    $$\n    \\phi_{\\text{ext}} = \\phi_3 + \\frac{\\phi_3 - \\phi_2}{r^p - 1}\n    $$\n    该值不是问题陈述所要求的，但它是一个中间概念步骤。\n\n3.  **网格收敛指数 (GCI)**：GCI 为精细网格解提供了一个保守的误差范围。对于最细的网格，其计算公式为：\n    $$\n    \\text{GCI}_{\\text{fine}} = F_s \\frac{\\left| \\frac{\\phi_2 - \\phi_3}{\\phi_3} \\right|}{r^p - 1}\n    $$\n    其中 $F_s=1.25$ 是指定的安全因子。该值将离散化不确定性量化为计算出的精细网格解的一部分。\n\n通过为三个测试用例中的每一个实施这些步骤，我们可以计算出四个必需的量：解析参考 WSS（$\\tau_w^{(\\text{ref})}$）、最细网格的数值 WSS（$\\phi_3$）、观测精度阶（$p$）以及最细网格上的 GCI。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Main function to execute the grid refinement study for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (common carotid surrogate)\n        {\n            \"R\": 0.0045, \"dpdz\": -1000.0,\n            \"mu0\": 0.16, \"mu_inf\": 0.0035, \"lam\": 3.313, \"a\": 0.64, \"n\": 0.2128,\n            \"grids\": [32, 64, 128]\n        },\n        # Test case 2 (internal carotid surrogate)\n        {\n            \"R\": 0.0028, \"dpdz\": -1500.0,\n            \"mu0\": 0.20, \"mu_inf\": 0.0030, \"lam\": 2.5, \"a\": 0.64, \"n\": 0.20,\n            \"grids\": [16, 32, 64]\n        },\n        # Test case 3 (near-Newtonian limit)\n        {\n            \"R\": 0.0035, \"dpdz\": -800.0,\n            \"mu0\": 0.0035, \"mu_inf\": 0.0035, \"lam\": 1.0e-6, \"a\": 0.64, \"n\": 1.0,\n            \"grids\": [8, 16, 32]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = perform_convergence_study(case)\n        results.append(case_results)\n\n    # Format output as a list of lists: [[res1],[res2],[res3]]\n    sub_results_str = [f\"[{','.join(map(str, res))}]\" for res in results]\n    final_output_str = f\"[{','.join(sub_results_str)}]\"\n    \n    print(final_output_str)\n\ndef carreau_yasuda_viscosity(gamma_dot, mu0, mu_inf, lam, a, n):\n    \"\"\"\n    Calculates viscosity using the Carreau-Yasuda model.\n    \"\"\"\n    if gamma_dot  0:\n        gamma_dot = 0.0\n    term = 1.0 + (lam * gamma_dot)**a\n    return mu_inf + (mu0 - mu_inf) * (term**((n - 1.0) / a))\n\ndef compute_numerical_wss_for_grid(params, N):\n    \"\"\"\n    Computes the numerical Wall Shear Stress for a single grid configuration.\n    \"\"\"\n    R = params[\"R\"]\n    dpdz = params[\"dpdz\"]\n    mu0, mu_inf, lam, a, n = params[\"mu0\"], params[\"mu_inf\"], params[\"lam\"], params[\"a\"], params[\"n\"]\n\n    h = R / N\n    r_nodes = np.linspace(0, R, N + 1)\n    \n    # 1. Shear stress profile from momentum balance\n    tau_profile = -(dpdz / 2.0) * r_nodes\n    \n    # 2. Shear rate profile by solving the constitutive equation\n    gamma_dot_profile = np.zeros(N + 1)\n    \n    # Root-finding function: f(gamma_dot) = mu(gamma_dot)*gamma_dot - tau = 0\n    def f_root(g_dot, tau, mu0, mu_inf, lam, a, n):\n        if g_dot = 0: return -tau\n        return carreau_yasuda_viscosity(g_dot, mu0, mu_inf, lam, a, n) * g_dot - tau\n\n    for i in range(1, N + 1):\n        tau_i = tau_profile[i]\n        if tau_i > 0:\n            # Set a safe upper bound for the root search\n            upper_bound = (tau_i / mu_inf) * 2.0 if mu_inf > 0 else (tau_i / 1e-9) * 2.0\n            gamma_dot_profile[i] = brentq(f_root, 0, upper_bound, args=(tau_i, mu0, mu_inf, lam, a, n))\n\n    # 3. Reconstruct velocity profile by numerical integration\n    # v(r) = Integral from r to R of gamma_dot(s) ds\n    # Using scipy's cumulative trapezoidal integration\n    integral_values = cumulative_trapezoid(gamma_dot_profile, x=r_nodes, initial=0)\n    v_profile = integral_values[-1] - integral_values\n    \n    # 4. Compute numerical WSS\n    # Get velocity at the node adjacent to the wall\n    v_at_R_minus_h = v_profile[N-1]\n    \n    # Approximate wall shear rate using a one-sided finite difference\n    gamma_dot_w_approx = v_at_R_minus_h / h\n\n    # Calculate viscosity at the approximated wall shear rate\n    mu_w_approx = carreau_yasuda_viscosity(gamma_dot_w_approx, mu0, mu_inf, lam, a, n)\n\n    # Compute numerical WSS\n    tau_w_h = mu_w_approx * gamma_dot_w_approx\n    \n    return tau_w_h\n\n\ndef perform_convergence_study(case_params):\n    \"\"\"\n    Performs the 3-grid convergence study for a given test case.\n    \"\"\"\n    R, dpdz, grids = case_params[\"R\"], case_params[\"dpdz\"], case_params[\"grids\"]\n    \n    # Compute analytical reference WSS\n    tau_w_ref = -(dpdz * R) / 2.0\n    \n    # Compute numerical WSS for the three grid levels\n    N1, N2, N3 = grids[0], grids[1], grids[2]\n    phi_1 = compute_numerical_wss_for_grid(case_params, N1) # coarse\n    phi_2 = compute_numerical_wss_for_grid(case_params, N2) # medium\n    phi_3 = compute_numerical_wss_for_grid(case_params, N3) # fine\n    \n    # Grid refinement ratio\n    r = N2 / N1 \n    \n    # Compute observed order of accuracy, p\n    # Handle potential for zero difference or non-monotonic convergence\n    diff_12 = phi_1 - phi_2\n    diff_23 = phi_2 - phi_3\n    \n    if diff_23 == 0 or diff_12/diff_23 = 0:\n        p = np.nan # Not converging monotonically or has converged numerically\n    else:\n        p = np.log(diff_12 / diff_23) / np.log(r)\n\n    # Compute Grid Convergence Index (GCI)\n    Fs = 1.25 # Factor of safety\n    if phi_3 == 0 or np.isnan(p) or (r**p - 1) == 0:\n      gci_fine = np.nan\n    else:\n      # GCI_fine = Fs * |(phi2 - phi3) / phi3| / (r^p - 1)\n      relative_approx_error = abs((phi_2 - phi_3) / phi_3)\n      gci_fine = Fs * relative_approx_error / (r**p - 1.0)\n      \n    # Return the four required values\n    return [tau_w_ref, phi_3, p, gci_fine]\n\nsolve()\n```"
        }
    ]
}