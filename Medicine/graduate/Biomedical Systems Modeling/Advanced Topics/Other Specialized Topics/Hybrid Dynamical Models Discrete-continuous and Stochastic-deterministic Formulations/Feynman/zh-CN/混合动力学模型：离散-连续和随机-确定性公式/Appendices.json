{
    "hands_on_practices": [
        {
            "introduction": "药物剂量方案是混合系统的一个典型例子，连续的药物消除过程被离散的给药事件所打断。本练习旨在分析这种系统在稳态下的周期性行为，通过推导关键性能指标来确保药物浓度维持在安全有效的治疗窗口内。这项实践将加强你对混合系统周期性轨道和参数约束的分析能力。",
            "id": "3892135",
            "problem": "单室静脉推注给药方案被建模为一个混合动力学系统，在离散的给药事件之间存在连续的消除过程。设血浆药物浓度为 $C(t)$，在两次给药之间由常微分方程（ODE）$dC/dt=-k\\,C$ 控制，其中 $k0$ 是一级消除速率常数（单位为 $\\text{h}^{-1}$）。每隔 $\\Delta$ 小时，在时间 $t=n\\Delta$（对于整数 $n\\geq 1$）瞬时给药。每次给药是剂量为 $d$ 毫克的脉冲，在表观分布容积 $V$ 升中瞬时均匀混合，在每个给药时间产生一个瞬时跳跃 $C(t^{+})=C(t^{-})+d/V$。\n\n假设该给药方案已维持足够长的时间，使得浓度轨迹已达到其周期性稳态。设 $C^{+}$ 表示给药后瞬间的稳态浓度，$C^{-}$ 表示下一次给药前瞬间的稳态浓度。治疗窗由下限 $L$ 和上限 $U$ （单位均为 $\\text{mg}\\,\\text{L}^{-1}$）指定，其中 $0  L  U$。求在存在一个合适的剂量 $d$ （即 $d>0$）能使整个稳态浓度轨迹保持在治疗窗内（即 $L \\le C(t) \\le U$）的情况下，两次给药之间的最大允许时间间隔 $\\Delta_{\\max}$ 是多少。将您的答案表示为 $k$、$L$ 和 $U$ 的函数。",
            "solution": "问题陈述经核实具有科学依据、问题明确、客观且完整。它代表了药代动力学建模（生物医学系统工程的一个子领域）中的一个标准问题，并且适合进行严格的数学分析。\n\n系统动力学由一个混合模型描述。两次给药之间的连续动力学由以下一级线性常微分方程（ODE）控制：\n$$\n\\frac{dC}{dt} = -kC\n$$\n其中 $C(t)$ 是药物浓度，$k  0$ 是消除速率常数。该ODE在长度为 $\\Delta$ 的时间间隔内，从初始浓度 $C_0$ 开始的解是 $C(t) = C_0 \\exp(-kt')$，其中 $t'$ 是自该间隔开始以来经过的时间。\n\n在稳态下，浓度曲线是周期性的，周期为 $\\Delta$。设 $C^{+}$ 为给药后瞬间的浓度（峰浓度），$C^{-}$ 为下一次给药前瞬间的浓度（谷浓度）。在给药间隔 $\\Delta$ 内，浓度从 $C^{+}$ 开始衰减。因此，峰浓度与随后的谷浓度之间的关系是：\n$$\nC^{-} = C^{+} \\exp(-k\\Delta)\n$$\n离散的给药事件被建模为浓度的瞬时跳跃。在每个给药时间，将剂量为 $d$ 的药物加入分布容积 $V$ 中。这导致浓度瞬时增加 $d/V$。在稳态下，谷浓度 $C^{-}$ 增加此量后成为下一个峰浓度 $C^{+}$：\n$$\nC^{+} = C^{-} + \\frac{d}{V}\n$$\n我们现在得到了一个关于两个未知数 $C^{+}$ 和 $C^{-}$ 的二元线性方程组。我们可以解这个方程组，将它们表示为模型参数 $d$、$V$、$k$ 和 $\\Delta$ 的函数。将第一个方程代入第二个方程，得到：\n$$\nC^{+} = C^{+} \\exp(-k\\Delta) + \\frac{d}{V}\n$$\n整理以求解 $C^{+}$：\n$$\nC^{+} \\left(1 - \\exp(-k\\Delta)\\right) = \\frac{d}{V}\n$$\n$$\nC^{+} = \\frac{d/V}{1 - \\exp(-k\\Delta)}\n$$\n这是稳态峰浓度的表达式。为了求稳态谷浓度 $C^{-}$，我们将此结果代回衰减方程：\n$$\nC^{-} = \\left( \\frac{d/V}{1 - \\exp(-k\\Delta)} \\right) \\exp(-k\\Delta) = \\frac{(d/V)\\exp(-k\\Delta)}{1 - \\exp(-k\\Delta)}\n$$\n问题陈述指出，为了临床安全，稳态下的浓度轨迹对于所有时间 $t$ 必须保持在由 $L \\le C(t) \\le U$ 定义的治疗窗内。由于浓度 $C(t)$ 在两次给药之间是单调递减函数，因此在任何周期内，其最大值为 $C_{max} = C^{+}$，最小值为 $C_{min} = C^{-}$。因此，安全条件简化为两个要求：\n1. $C^{+} \\le U$\n2. $C^{-} \\ge L$\n\n现在我们将推导出的 $C^{+}$ 和 $C^{-}$ 表达式代入这些不等式，以找出对剂量 $d$ 的条件。\n\n从 $C^{+} \\le U$ 得：\n$$\n\\frac{d/V}{1 - \\exp(-k\\Delta)} \\le U\n$$\n由于 $d$、$V$、$k$ 和 $\\Delta$ 均为正数，项 $1 - \\exp(-k\\Delta)$ 也为正。我们可以整理不等式以求解 $d$：\n$$\nd \\le U \\cdot V \\cdot \\left(1 - \\exp(-k\\Delta)\\right)\n$$\n这个不等式为允许的剂量 $d$ 提供了一个上限。\n\n从 $C^{-} \\ge L$ 得：\n$$\n\\frac{(d/V)\\exp(-k\\Delta)}{1 - \\exp(-k\\Delta)} \\ge L\n$$\n同样，我们整理以求解 $d$：\n$$\nd \\ge \\frac{L \\cdot V \\cdot \\left(1 - \\exp(-k\\Delta)\\right)}{\\exp(-k\\Delta)} = L \\cdot V \\cdot \\left(\\frac{1}{\\exp(-k\\Delta)} - 1\\right) = L \\cdot V \\cdot \\left(\\exp(k\\Delta) - 1\\right)\n$$\n这个不等式为允许的剂量 $d$ 提供了一个下限。\n\n对于给定的间隔 $\\Delta$，要存在一个可行的给药方案，必须至少有一个剂量 $d$ 的值能同时满足这两个条件。这意味着 $d$ 的下限必须小于或等于 $d$ 的上限：\n$$\nL \\cdot V \\cdot \\left(\\exp(k\\Delta) - 1\\right) \\le U \\cdot V \\cdot \\left(1 - \\exp(-k\\Delta)\\right)\n$$\n由于 $L  0$ 和 $V  0$，我们可以用 $L \\cdot V$ 除不等式两边而不改变不等号方向：\n$$\n\\exp(k\\Delta) - 1 \\le \\frac{U}{L} \\left(1 - \\exp(-k\\Delta)\\right)\n$$\n为了求解 $\\Delta$，我们可以将 $\\exp(-k\\Delta)$ 写成 $1/\\exp(k\\Delta)$：\n$$\n\\exp(k\\Delta) - 1 \\le \\frac{U}{L} \\left(1 - \\frac{1}{\\exp(k\\Delta)}\\right) = \\frac{U}{L} \\left(\\frac{\\exp(k\\Delta) - 1}{\\exp(k\\Delta)}\\right)\n$$\n因为我们关心的是非零给药间隔 $\\Delta  0$（且 $k0$），所以项 $\\exp(k\\Delta) - 1$ 是严格为正的。我们可以用这一项除不等式两边：\n$$\n1 \\le \\frac{U/L}{\\exp(k\\Delta)}\n$$\n两边乘以 $\\exp(k\\Delta)$ 得：\n$$\n\\exp(k\\Delta) \\le \\frac{U}{L}\n$$\n为了分离出 $\\Delta$，我们取两边的自然对数。由于自然对数是单调递增函数且 $U/L  1$，不等号方向保持不变：\n$$\n\\ln\\left(\\exp(k\\Delta)\\right) \\le \\ln\\left(\\frac{U}{L}\\right)\n$$\n$$\nk\\Delta \\le \\ln\\left(\\frac{U}{L}\\right)\n$$\n最后，除以正常数 $k$ 得到关于 $\\Delta$ 的条件：\n$$\n\\Delta \\le \\frac{1}{k} \\ln\\left(\\frac{U}{L}\\right)\n$$\n问题要求的是存在合适剂量 $d$ 的最大给药间隔 $\\Delta_{\\max}$。这对应于所推导不等式的上限。\n$$\n\\Delta_{\\max} = \\frac{1}{k} \\ln\\left(\\frac{U}{L}\\right)\n$$\n此表达式给出了两次给药之间可能的最长时间，在此时间内仍有可能找到一个剂量 $d$，使得稳态下的药物浓度保持在治疗窗 $[L, U]$ 内。",
            "answer": "$$\n\\boxed{\\frac{1}{k}\\ln\\left(\\frac{U}{L}\\right)}\n$$"
        },
        {
            "introduction": "许多生物过程本质上是随机的，这为确定性模型带来了挑战和机遇。本练习探讨了如何在基因表达模型中量化这种内在噪声，我们引入线性噪声近似（LNA）这一强大工具，它将潜在的离散随机事件（如转录和翻译）与围绕确定性平均行为的连续噪声的数学描述联系起来。通过这个练习，你将学会如何推导随机波动的统计特性，例如蛋白质数量的方差。",
            "id": "3892040",
            "problem": "考虑一个单细胞基因表达的混合动力学模型，其中离散的启动子转换相对于转录和翻译而言是快速的，并且分子拷贝数的波动通过连续随机近似进行建模。启动子以恒定速率在活性状态和非活性状态之间切换，其中速率 $\\alpha$ 对应从非活性到活性，速率 $\\beta$ 对应从活性到非活性。在时间尺度分离的假设下，启动子处于活性状态的时间分数由其稳态均值 $s^{\\ast} = \\alpha/(\\alpha+\\beta)$ 近似，信使核糖核酸 (mRNA) 和蛋白质的平均分子数（分别表示为 $m$ 和 $p$）的连续动力学遵循由以下公式给出的确定性漂移：\n$$\n\\frac{dm}{dt} = k_{m} s^{\\ast} - \\gamma_{m} m, \n\\qquad\n\\frac{dp}{dt} = k_{p} m - \\gamma_{p} p,\n$$\n其中 $k_{m}$ 是转录速率（条件是启动子处于活性状态），$\\gamma_{m}$ 是 mRNA 降解速率，$k_{p}$ 是翻译速率，$\\gamma_{p}$ 是蛋白质降解速率。其基础的离散反应事件为：\n- 转录：$\\varnothing \\rightarrow m$，倾向为 $a_{1}(x) = k_{m} s^{\\ast}$，\n- mRNA降解：$m \\rightarrow \\varnothing$，倾向为 $a_{2}(x) = \\gamma_{m} m$，\n- 翻译：$m \\rightarrow m + p$，倾向为 $a_{3}(x) = k_{p} m$，\n- 蛋白质降解：$p \\rightarrow \\varnothing$，倾向为 $a_{4}(x) = \\gamma_{p} p$，\n其中 $x = (m,p)^{\\top}$。\n\n假设线性噪声近似 (LNA) 有效，并且围绕唯一稳定平衡点的波动可以由关于 $(m,p)$ 的高斯-奥恩斯坦-乌伦贝克过程很好地近似。令 $x^{\\ast} = (m^{\\ast},p^{\\ast})^{\\top}$ 表示该平衡点。使用反应网络随机表述的第一性原理，推导出蛋白质波动稳态方差 $\\sigma_{pp}$（即 $(m,p)$ 的稳态协方差矩阵的 $(2,2)$ 元）的闭式解析表达式，该表达式应以参数 $\\alpha$、$\\beta$、$k_{m}$、$k_{p}$、$\\gamma_{m}$ 和 $\\gamma_{p}$ 表示。\n\n请将您的最终答案表示为符号表达式。不要提供数值计算，也不要附加单位。",
            "solution": "用户希望使用线性噪声近似 (LNA) 方法，为一个给定的基因表达混合模型求出蛋白质波动的稳态方差 $\\sigma_{pp}$。\n\n### 第1步：提取已知条件\n- **状态变量**：$m$ (mRNA 数量)，$p$ (蛋白质数量)。状态向量 $x = (m, p)^{\\top}$。\n- **参数**：\n  - 启动子转换速率：$\\alpha$ (非活性到活性)，$\\beta$ (活性到非活性)。\n  - 转录速率 (启动子活性时)：$k_m$。\n  - mRNA 降解速率：$\\gamma_m$。\n  - 翻译速率：$k_p$。\n  - 蛋白质降解速率：$\\gamma_p$。\n- **导出量**：启动子活性时间的稳态分数：$s^{\\ast} = \\frac{\\alpha}{\\alpha+\\beta}$。\n- **确定性动力学**：\n  $$ \\frac{dm}{dt} = k_{m} s^{\\ast} - \\gamma_{m} m $$\n  $$ \\frac{dp}{dt} = k_{p} m - \\gamma_{p} p $$\n- **随机反应方案**：令 $x=(m,p)$。\n  - R1: $\\varnothing \\rightarrow m$，倾向 $a_{1}(x) = k_{m} s^{\\ast}$，化学计量向量 $v_1 = (1, 0)^{\\top}$。\n  - R2: $m \\rightarrow \\varnothing$，倾向 $a_{2}(x) = \\gamma_{m} m$，化学计量向量 $v_2 = (-1, 0)^{\\top}$。\n  - R3: $m \\rightarrow m + p$，倾向 $a_{3}(x) = k_{p} m$，化学计量向量 $v_3 = (0, 1)^{\\top}$。\n  - R4: $p \\rightarrow \\varnothing$，倾向 $a_{4}(x) = \\gamma_{p} p$，化学计量向量 $v_4 = (0, -1)^{\\top}$。\n- **目标**：推导稳态方差 $\\sigma_{pp}$，即 $(m,p)$ 的稳态协方差矩阵的 $(2,2)$ 元。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是线性噪声近似 (LNA) 在一个成熟的基因表达两阶段模型上的标准应用。\n- **科学依据**：该模型是随机基因表达理论的基石。LNA 是一个严谨且被广泛接受的方法，它是在大系统尺寸的假设下从化学主方程推导出来的。\n- **适定性**：确定性系统有一个唯一的、全局稳定的不动点。LNA 框架为求解稳态协方差矩阵提供了一条清晰的路径，前提是系统是稳定的，而该系统确实是稳定的。\n- **目标**：问题以精确的数学术语陈述，没有歧义或主观论断。\n- **完整性**：所有必需的参数、速率和反应定义都已提供。\n\n### 第3步：结论与行动\n问题有效。我将继续进行求解。\n\n### 稳态蛋白质方差的推导\n\n线性噪声近似 (LNA) 描述了围绕一个稳定确定性平衡点 $x^{\\ast}$ 的波动 $\\eta(t) = x(t) - x^{\\ast}$ 的动力学。这些波动遵循一个奥恩斯坦-乌伦贝克过程，其协方差矩阵 $C(t) = \\langle \\eta(t) \\eta(t)^{\\top} \\rangle$ 根据李雅普诺夫方程演化：\n$$ \\frac{dC}{dt} = J C(t) + C(t) J^{\\top} + D $$\n在稳态时，$\\frac{dC}{dt} = 0$，稳态协方差矩阵 $C_{ss}$ 满足代数李雅普诺夫方程：\n$$ J C_{ss} + C_{ss} J^{\\top} + D = 0 $$\n我们的目标是求出 $C_{ss}$ 的 $(2,2)$ 元，我们将其表示为 $\\sigma_{pp}$。\n\n**1. 确定确定性平衡点 $x^{\\ast} = (m^{\\ast}, p^{\\ast})^{\\top}$**\n我们将确定性方程的时间导数设为零：\n$k_{m} s^{\\ast} - \\gamma_{m} m^{\\ast} = 0 \\implies m^{\\ast} = \\frac{k_{m} s^{\\ast}}{\\gamma_{m}}$\n$k_{p} m^{\\ast} - \\gamma_{p} p^{\\ast} = 0 \\implies p^{\\ast} = \\frac{k_{p} m^{\\ast}}{\\gamma_{p}}$\n将 $m^{\\ast}$ 的表达式代入 $p^{\\ast}$ 的方程中：\n$p^{\\ast} = \\frac{k_{p}}{\\gamma_{p}} \\left( \\frac{k_{m} s^{\\ast}}{\\gamma_{m}} \\right) = \\frac{k_{p} k_{m} s^{\\ast}}{\\gamma_{p} \\gamma_{m}}$。\n\n**2. 计算雅可比矩阵 $J$**\n令确定性速率向量为 $f(x) = (f_m, f_p)^{\\top} = (k_m s^{\\ast} - \\gamma_m m, k_p m - \\gamma_p p)^{\\top}$。雅可比矩阵 $J$ 由 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$ 在 $x^{\\ast}$ 处求值得到。\n$J_{11} = \\frac{\\partial f_m}{\\partial m} = -\\gamma_m$\n$J_{12} = \\frac{\\partial f_m}{\\partial p} = 0$\n$J_{21} = \\frac{\\partial f_p}{\\partial m} = k_p$\n$J_{22} = \\frac{\\partial f_p}{\\partial p} = -\\gamma_p$\n雅可比矩阵是常数，不依赖于平衡点：\n$$ J = \\begin{pmatrix} -\\gamma_m   0 \\\\ k_p   -\\gamma_p \\end{pmatrix} $$\n\n**3. 计算扩散矩阵 $D$**\n扩散矩阵 $D$ 由 $D = \\sum_{j} v_j v_j^{\\top} a_j(x^{\\ast})$ 给出，其中 $v_j$ 是化学计量向量，$a_j(x^{\\ast})$ 是在平衡点 $x^{\\ast}$ 处求值的倾向。\n平衡点处的倾向为：\n$a_1(x^{\\ast}) = k_m s^{\\ast}$\n$a_2(x^{\\ast}) = \\gamma_m m^{\\ast} = \\gamma_m \\left(\\frac{k_m s^{\\ast}}{\\gamma_m}\\right) = k_m s^{\\ast}$\n$a_3(x^{\\ast}) = k_p m^{\\ast}$\n$a_4(x^{\\ast}) = \\gamma_p p^{\\ast} = \\gamma_p \\left(\\frac{k_p m^{\\ast}}{\\gamma_p}\\right) = k_p m^{\\ast}$\n$D$ 的分量为：\n$D_{11} = (1)^2 a_1(x^{\\ast}) + (-1)^2 a_2(x^{\\ast}) = k_m s^{\\ast} + k_m s^{\\ast} = 2k_m s^{\\ast}$\n$D_{22} = (1)^2 a_3(x^{\\ast}) + (-1)^2 a_4(x^{\\ast}) = k_p m^{\\ast} + k_p m^{\\ast} = 2k_p m^{\\ast}$\n$D_{12} = D_{21} = 0$，因为没有单一反应同时影响 $m$ 和 $p$。\n因此，扩散矩阵为：\n$$ D = \\begin{pmatrix} 2k_m s^{\\ast}   0 \\\\ 0   2k_p m^{\\ast} \\end{pmatrix} $$\n\n**4. 求解代数李雅普诺夫方程**\n令 $C_{ss} = \\begin{pmatrix} \\sigma_{mm}   \\sigma_{mp} \\\\ \\sigma_{mp}   \\sigma_{pp} \\end{pmatrix}$。方程 $J C_{ss} + C_{ss} J^{\\top} + D = 0$ 变为：\n$$ \\begin{pmatrix} -\\gamma_m   0 \\\\ k_p   -\\gamma_p \\end{pmatrix} \\begin{pmatrix} \\sigma_{mm}   \\sigma_{mp} \\\\ \\sigma_{mp}   \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} \\sigma_{mm}   \\sigma_{mp} \\\\ \\sigma_{mp}   \\sigma_{pp} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m   k_p \\\\ 0   -\\gamma_p \\end{pmatrix} + \\begin{pmatrix} D_{11}   0 \\\\ 0   D_{22} \\end{pmatrix} = \\begin{pmatrix} 0   0 \\\\ 0   0 \\end{pmatrix} $$\n展开此矩阵方程，得到一个关于 $C_{ss}$ 元素的线性方程组：\n$$ \\begin{pmatrix} -2\\gamma_m \\sigma_{mm}   k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} \\\\ k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp}   2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} D_{11}   0 \\\\ 0   D_{22} \\end{pmatrix} = \\begin{pmatrix} 0   0 \\\\ 0   0 \\end{pmatrix} $$\n从矩阵元素中，我们得到：\n(1,1)元：$-2\\gamma_m \\sigma_{mm} + D_{11} = 0 \\implies \\sigma_{mm} = \\frac{D_{11}}{2\\gamma_m} = \\frac{2k_m s^{\\ast}}{2\\gamma_m} = \\frac{k_m s^{\\ast}}{\\gamma_m} = m^{\\ast}$。\n(1,2)元：$k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} = 0 \\implies \\sigma_{mp} = \\frac{k_p \\sigma_{mm}}{\\gamma_m+\\gamma_p} = \\frac{k_p m^{\\ast}}{\\gamma_m+\\gamma_p}$。\n(2,2)元：$2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} + D_{22} = 0 \\implies \\sigma_{pp} = \\frac{k_p \\sigma_{mp}}{\\gamma_p} + \\frac{D_{22}}{2\\gamma_p}$。\n\n现在，我们代入 $\\sigma_{mp}$ 和 $D_{22}$ 的表达式来求解 $\\sigma_{pp}$：\n$$ \\sigma_{pp} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_p m^{\\ast}}{\\gamma_m+\\gamma_p} \\right) + \\frac{2k_p m^{\\ast}}{2\\gamma_p} $$\n$$ \\sigma_{pp} = \\frac{k_p^2 m^{\\ast}}{\\gamma_p(\\gamma_m+\\gamma_p)} + \\frac{k_p m^{\\ast}}{\\gamma_p} $$\n注意到 $p^{\\ast} = \\frac{k_p m^{\\ast}}{\\gamma_p}$，我们可以简化为：\n$$ \\sigma_{pp} = \\frac{k_p}{\\gamma_m+\\gamma_p} \\left(\\frac{k_p m^{\\ast}}{\\gamma_p}\\right) + p^{\\ast} = p^{\\ast} \\frac{k_p}{\\gamma_m+\\gamma_p} + p^{\\ast} $$\n提出公因子 $p^{\\ast}$：\n$$ \\sigma_{pp} = p^{\\ast} \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right) $$\n最后，代入 $p^{\\ast} = \\frac{k_p k_m s^{\\ast}}{\\gamma_p \\gamma_m}$ 和 $s^{\\ast} = \\frac{\\alpha}{\\alpha+\\beta}$ 的表达式：\n$$ \\sigma_{pp} = \\left(\\frac{k_p k_m}{\\gamma_p \\gamma_m} \\frac{\\alpha}{\\alpha+\\beta}\\right) \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right) $$\n为了得到一个单一的表达式，我们合并括号内的项：\n$$ 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} = \\frac{\\gamma_m+\\gamma_p+k_p}{\\gamma_m+\\gamma_p} $$\n将其代回，得到稳态蛋白质方差的最终表达式：\n$$ \\sigma_{pp} = \\left(\\frac{k_p k_m}{\\gamma_p \\gamma_m} \\frac{\\alpha}{\\alpha+\\beta}\\right) \\left(\\frac{\\gamma_m+\\gamma_p+k_p}{\\gamma_m+\\gamma_p}\\right) $$\n$$ \\sigma_{pp} = \\frac{\\alpha k_m k_p (\\gamma_m + \\gamma_p + k_p)}{(\\alpha+\\beta)\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} $$\n这就是以基本模型参数表示的蛋白质波动稳态方差的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\alpha k_m k_p (\\gamma_m + \\gamma_p + k_p)}{(\\alpha+\\beta)\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}}$$"
        },
        {
            "introduction": "混合系统在生物医学控制中扮演着核心角色，例如人工胰腺的设计。本练习将理论付诸实践，要求你设计并仿真一个用于血糖调节的事件触发控制器，其中离散的干预措施（胰岛素注射）由连续的、带噪声的传感器读数触发。通过这项实践，你将整合连续动力学、离散逻辑和随机性，并学习如何通过计算仿真来评估闭环系统的稳定性，这是连接理论模型与实际应用的关键一步。",
            "id": "3892153",
            "problem": "考虑一个患有1型糖尿病的患者的闭环葡萄糖调节，该调节被建模为一个混合动态系统，它将连续的葡萄糖-胰岛素动力学与由带噪声的葡萄糖测量值驱动的事件触发胰岛素推注耦合起来。连续时间状态是序对 $(G(t), I(t))$，其中 $G(t)$ 是血浆葡萄糖浓度，单位为 $\\mathrm{mg/dL}$，$I(t)$ 是一个有效的皮下胰岛素室，单位为 $\\mathrm{mU}$。基线葡萄糖设定点是 $G_b$，单位为 $\\mathrm{mg/dL}$。连续动态遵循常用于最小模型的一阶质量平衡和药物动力学：\n$$\n\\frac{dG}{dt} = -k_g \\left(G(t) - G_b\\right) - S_I\\, I(t)\\, \\left(G(t) - G_b\\right) + d(t),\n$$\n$$\n\\frac{dI}{dt} = -k_i\\, I(t) + u_{\\mathrm{basal}},\n$$\n其中 $k_g$（单位 $\\mathrm{min^{-1}}$）是葡萄糖清除率，$S_I$（单位 $\\mathrm{(mU\\cdot min)^{-1}}$）是胰岛素敏感性，$k_i$（单位 $\\mathrm{min^{-1}}$）是胰岛素衰减率，$u_{\\mathrm{basal}}$（单位 $\\mathrm{mU/min}$）是基础胰岛素输注，$d(t)$（单位 $\\mathrm{mg/dL\\cdot min}$）是外源葡萄糖扰动（在本问题中假设 $d(t) = 0$）。测量的葡萄糖 $y(t)$ 受到加性测量噪声的影响，\n$$\ny(t) = G(t) + \\varepsilon(t),\n$$\n其中 $\\varepsilon(t)$ 是一个零均值随机变量，在离散的仿真步长上独立采样，并满足方差为 $\\sigma^2$（单位 $\\mathrm{(mg/dL)^2}$）的高斯分布 $\\varepsilon(t) \\sim \\mathcal{N}(0,\\sigma^2)$。使用保护和重置来定义事件触发的推注控制，如下所示。保护函数为\n$$\n\\gamma(t) = y(t) - \\theta,\n$$\n阈值为 $\\theta$，单位为 $\\mathrm{mg/dL}$。当 $\\gamma(t)$ 从负值变为非负值，并且自上一个事件以来已经过了至少一个最小事件间停留时间 $\\tau$（单位 $\\mathrm{min}$）时，就会发生一个事件。在事件时间 $t_k$，重置映射施加一个大小为 $B$（单位 $\\mathrm{mU}$）的胰岛素推注，\n$$\nG(t_k^+) = G(t_k^-), \\quad I(t_k^+) = I(t_k^-) + B,\n$$\n然后从 $(G(t_k^+), I(t_k^+))$ 恢复连续演化。假设采样步长为 $h$（单位 $\\mathrm{min}$）的分段常数采样，并使用前向欧拉格式在该网格上近似连续动态。\n\n任务。从这些基本定义出发，推导由保护和重置指定的事件触发控制器，并使用类李雅普诺夫论证分析存在测量噪声时的闭环稳定性，解释为何有界的事件间时间和有界的推注大小可以导致 $G(t)$ 在 $G_b$ 附近均方有界。然后实施一个基于仿真的测试来操作上评估稳定性：对于给定的参数集，仿真持续时间 $T$（单位 $\\mathrm{min}$），计算最后 $T/2$ 分钟内 $G(t)$ 的样本均值 $\\mu$ 和样本方差 $v$，如果满足\n$$\n\\left|\\mu - G_b\\right| \\leq \\epsilon_\\mu \\quad \\text{and} \\quad v \\leq v_{\\max},\n$$\n则宣布闭环“稳定”，其中容差 $\\epsilon_\\mu$ 的单位为 $\\mathrm{mg/dL}$，$v_{\\max}$ 的单位为 $\\mathrm{(mg/dL)^2}$。仅使用随机测量值 $y(t)$ 来触发事件；状态更新必须使用无噪声的 $G(t)$ 和 $I(t)$。在整个过程中假设 $u_{\\mathrm{basal}} = 0$ 且 $d(t) = 0$。\n\n实现细节。使用步长为 $h$ 的前向欧拉法来积分连续动态。在每个离散步骤 $t_n = n h$，独立生成 $\\varepsilon_n \\sim \\mathcal{N}(0,\\sigma^2)$，设置 $y_n = G_n + \\varepsilon_n$，并应用带有停留时间约束 $\\tau$ 的保护和重置；在任何重置之后，继续积分。为每个测试用例使用提供的整数种子初始化随机数生成器，以保证可复现性。初始条件为 $G(0) = G_0$（单位 $\\mathrm{mg/dL}$）和 $I(0) = I_0$（单位 $\\mathrm{mU}$）。仿真持续时间为 $T$ 分钟，步长为 $h$，共产生 $N = T/h$ 个步骤。\n\n单位。所有葡萄糖量必须以 $\\mathrm{mg/dL}$ 为单位，时间以 $\\mathrm{min}$ 为单位，胰岛素单位以 $\\mathrm{mU}$ 为单位。为每个测试用例报告稳定性决策（布尔值）。不使用角度。不使用百分比。\n\n测试套件。实现程序以评估以下四个参数集，这些参数集探索了不同的工况，包括“理想路径”、高噪声工况、小推注工况和无噪声边界情况。在每种情况下，使用容差 $\\epsilon_\\mu = 5$ $\\mathrm{mg/dL}$ 和 $v_{\\max} = 400$ $\\mathrm{(mg/dL)^2}$。\n\n- 情况1（理想路径）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 180$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 140$ $\\mathrm{mg/dL}$，$B = 30$ $\\mathrm{mU}$，$\\sigma = 5$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，种子 $= 1$。\n\n- 情况2（高噪声，频繁事件）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 130$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 110$ $\\mathrm{mg/dL}$，$B = 50$ $\\mathrm{mU}$，$\\sigma = 30$ $\\mathrm{mg/dL}$，$\\tau = 5$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，种子 $= 2$。\n\n- 情况3（小推注）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 160$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 140$ $\\mathrm{mg/dL}$，$B = 5$ $\\mathrm{mU}$，$\\sigma = 5$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，种子 $= 3$。\n\n- 情况4（无噪声边界）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 150$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 120$ $\\mathrm{mg/dL}$，$B = 20$ $\\mathrm{mU}$，$\\sigma = 0$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，种子 $= 4$。\n\n输出规范。您的程序应生成一行输出，其中包含一个方括号括起来的逗号分隔的结果列表（例如，$\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$），其中每个 $\\mathrm{result}$ 是一个布尔值，表示相应测试用例在上述操作标准下闭环是否稳定。",
            "solution": "问题陈述已经过验证，被认为是有效的。它科学地基于生物医学系统建模的既定原则，特别是葡萄糖调节的药物动力学和药效学。该问题定义明确，提供了所有必要的参数、初始条件和清晰、客观的任务。它没有歧义、矛盾和事实错误。\n\n### 理论框架\n\n#### 1. 混合动态模型\n\n该系统将闭环葡萄糖控制描述为一个混合自动机。状态为 $\\mathbf{x}(t) = [G(t), I(t)]^T$，其中 $G(t)$ 是血浆葡萄糖浓度，单位为 $\\mathrm{mg/dL}$，$I(t)$ 是有效皮下胰岛素浓度，单位为 $\\mathrm{mU}$。该模型包括两个主要部分：连续演化（流）和离散事件（跳跃）。\n\n**连续动态（流）：** 在事件之间，状态根据一组常微分方程（ODE）演化。根据问题约束，基础胰岛素输注 $u_{\\mathrm{basal}} = 0$ 且葡萄糖扰动 $d(t) = 0$，动态方程为：\n$$\n\\frac{dG}{dt} = -k_g \\left(G(t) - G_b\\right) - S_I\\, I(t)\\, \\left(G(t) - G_b\\right)\n$$\n$$\n\\frac{dI}{dt} = -k_i\\, I(t)\n$$\n这里，$k_g$ 是不依赖胰岛素的葡萄糖清除率，$S_I$ 是胰岛素敏感性，$k_i$ 是胰岛素清除率，$G_b$ 是基础葡萄糖设定点。这些方程描述了葡萄糖如何自然地返回到基线水平，以及这个过程如何被胰岛素加速，而胰岛素本身会随时间衰减。\n\n**离散动态（跳跃）：** 系统状态在特定的事件时间 $t_k$ 发生瞬时改变。这些事件由一个基于带噪声的葡萄糖测量值 $y(t) = G(t) + \\varepsilon(t)$（其中 $\\varepsilon(t) \\sim \\mathcal{N}(0, \\sigma^2)$）的控制器触发。如果以下所有三个条件都满足，则发生一个事件：\n1.  **保护条件：** 噪声测量值 $y(t)$ 从下方穿越阈值 $\\theta$。也就是说，保护函数 $\\gamma(t) = y(t) - \\theta$ 变为非负，而此前瞬间为负。\n2.  **停留时间约束：** 自上一个事件 $t_{k-1}$ 以来已过最小时间 $\\tau$，即 $t_k - t_{k-1} \\ge \\tau$。\n3.  **重置映射：** 在事件时间 $t_k$，施加一个大小为 $B$ 的胰岛素推注。状态重置如下：\n    $$\n    G(t_k^+) = G(t_k^-)\n    $$\n    $$\n    I(t_k^+) = I(t_k^-) + B\n    $$\n其中 $t_k^-$ 和 $t_k^+$ 分别表示事件发生前后的瞬间。\n\n#### 2. 通过类李雅普诺夫论证进行稳定性分析\n\n任务要求论证为何这种控制策略能导致 $G(t)$ 在其设定点 $G_b$ 附近均方有界。让我们定义葡萄糖与设定点的偏差为 $g(t) = G(t) - G_b$。这个子系统的一个简单李雅普诺夫候选函数是 $V(g) = \\frac{1}{2}g^2$。在连续流阶段，$V$ 的时间导数为：\n$$\n\\dot{V} = \\frac{dV}{dg}\\frac{dg}{dt} = g \\cdot \\left[ -k_g g - S_I I(t) g \\right] = -(k_g + S_I I(t)) g^2\n$$\n由于 $k_g  0$，$S_I  0$，且 $I(t) \\ge 0$（胰岛素浓度不能为负），项 $(k_g + S_I I(t))$ 严格为正。因此，$\\dot{V} \\le 0$。如果 $g \\neq 0$，导数严格为负，这表明在事件之间，葡萄糖水平 $G(t)$ 总是被驱动向设定点 $G_b$。系统的流动态是内在稳定的。\n\n离散事件（推注注射）作为一种纠正性控制动作。当 $y(t) = G(t) + \\varepsilon(t) \\ge \\theta$ 时触发推注，这通常发生在 $G(t)$ 显著高于 $G_b$ 时。推注 $B$ 导致 $I(t)$ 瞬时增加，这使得项 $S_I I(t)$ 变大，从而使 $\\dot{V}$ 更负，加速 $G(t)$ 返回到 $G_b$。\n\n在存在噪声的情况下的稳定性可以理解如下：\n*   **有界输入：** 推注大小 $B$ 是有限的。这可以防止单个、可能错误的测量值注入无限量的胰岛素，从而导致严重的低血糖。系统不会因单个事件而失稳。\n*   **停留时间：** 最小事件间时间 $\\tau$ 可以防止推注频率过高（在混合系统中称为Zeno行为，在糖尿病护理中称为“胰岛素叠加”）。这限制了在任何有限时间段内注入的胰岛素总量，确保 $I(t)$ 保持有界，并为系统在施用下一次推注前对上一次推注做出反应提供了时间。\n*   **噪声效应：** 零均值测量噪声 $\\varepsilon(t)$ 可能导致过早触发（当一个正的 $\\varepsilon(t)$ 即使在 $G(t)  \\theta$ 时也将 $y(t)$ 推高到 $\\theta$ 以上）和错失触发（当一个负的 $\\varepsilon(t)$ 即使在 $G(t) \\ge \\theta$ 时也使 $y(t)$ 保持在 $\\theta$ 以下）。虽然单个触发可能不是最优的，但噪声的零均值特性意味着没有系统性偏差。随着时间的推移，控制器的行为平均而言是纠正性的。\n*   **均方有界性：** 稳定的连续动态和有界的、非Zeno的、纠正性的离散控制器相结合，意味着状态轨迹被“困”在平衡点 $(G_b, 0)$ 周围的某个区域内。噪声引入随机扰动，导致状态波动。然而，由于恢复力（连续的和离散的）随着状态远离设定点而増大，这些波动的方差保持有限。这就是均方有界性的本质。这个有界区域的大小（以及方差 $v$）将取决于噪声方差 $\\sigma^2$ 和控制器参数（$\\theta, B, \\tau$）。\n\n#### 3. 数值实现\n\n为了测试这个模型，我们使用前向欧拉方法和固定时间步长 $h$ 来实现一个离散时间仿真。\n\n**离散化：** 令 $t_n = n h$ 时的 $G_n \\approx G(t_n)$ 和 $I_n \\approx I(t_n)$。ODE 的欧拉近似为：\n$$\nG_{n+1} = G_n + h \\cdot \\left[ -k_g(G_n - G_b) - S_I I_{\\mathrm{eff},n} (G_n - G_b) \\right]\n$$\n$$\nI_{n+1} = I_{\\mathrm{eff},n} + h \\cdot \\left[ -k_i I_{\\mathrm{eff},n} \\right] = I_{\\mathrm{eff},n}(1 - h k_i)\n$$\n其中 $I_{\\mathrm{eff},n}$ 是在区间 $[t_n, t_{n+1}]$ 开始时的有效胰岛素水平。\n\n**仿真算法：**\n1.  初始化状态变量 $G_0, I_0$，仿真时间 $t=0$，并将 `last_event_time` 初始化为一个足够小的值（例如 $-\\infty$），以允许初始事件发生。初始化一个 `y_prev` 变量来检测阈值穿越。\n2.  对于从 $0$ 到 $N-1 = T/h - 1$ 的每个时间步 $n$：\n    a. 令 $t_n = n \\cdot h$。\n    b. 生成一个测量噪声样本 $\\varepsilon_n \\sim \\mathcal{N}(0, \\sigma^2)$。\n    c. 计算带噪声的测量值 $y_n = G_n + \\varepsilon_n$。\n    d. 检查事件触发：条件是 (`y_n = \\theta`)、(`y_{prev}  \\theta`) 和 (`t_n - \\text{last\\_event\\_time} \\ge \\tau`)。`y_{prev}  \\theta` 条件离散化了“从负值穿越”的要求。\n    e. 定义当前步骤的有效胰岛素 $I_{\\mathrm{eff},n} = I_n$。\n    f. 如果事件被触发，应用重置映射：更新 $I_{\\mathrm{eff},n} \\leftarrow I_{\\mathrm{eff},n} + B$ 并记录事件时间：$\\text{last\\_event\\_time} = t_n$。\n    g. 更新 `y_prev = y_n` 以供下次迭代使用。\n    h. 使用欧拉公式以及 $G_n$ 和（可能已更新的）$I_{\\mathrm{eff},n}$ 计算下一个时间步的状态 $G_{n+1}$ 和 $I_{n+1}$。\n3.  仿真完成后，收集仿真后半段（即 $t \\in [T/2, T]$）的葡萄糖历史 $G(t)$。\n4.  计算此收集数据的样本均值 $\\mu$ 和样本方差 $v$（使用Bessel校正，ddof=1）。\n5.  应用操作稳定性测试：如果 $|\\mu - G_b| \\leq \\epsilon_\\mu$ 且 $v \\leq v_{\\max}$，则宣布系统“稳定”。对于此问题，$\\epsilon_\\mu = 5 \\, \\mathrm{mg/dL}$ 且 $v_{\\max} = 400 \\, (\\mathrm{mg/dL})^2$。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation of the hybrid glucose-insulin model.\n    \"\"\"\n    # Unpack parameters\n    k_g = params[\"k_g\"]\n    S_I = params[\"S_I\"]\n    k_i = params[\"k_i\"]\n    G_b = params[\"G_b\"]\n    G_0 = params[\"G_0\"]\n    I_0 = params[\"I_0\"]\n    theta = params[\"theta\"]\n    B = params[\"B\"]\n    sigma = params[\"sigma\"]\n    tau = params[\"tau\"]\n    T = params[\"T\"]\n    h = params[\"h\"]\n    seed = params[\"seed\"]\n    epsilon_mu = params[\"epsilon_mu\"]\n    v_max = params[\"v_max\"]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n\n    # Simulation setup\n    num_steps = int(T / h)\n    G = np.zeros(num_steps + 1)\n    I = np.zeros(num_steps + 1)\n\n    # Initial conditions\n    G[0] = G_0\n    I[0] = I_0\n\n    last_event_time = -np.inf\n    # Initialize y_prev to ensure a trigger can occur at t=0 if y_0 = theta\n    y_prev = -np.inf \n\n    # Simulation loop\n    for n in range(num_steps):\n        t_n = n * h\n        G_n = G[n]\n        I_n = I[n]\n\n        # Generate noisy measurement\n        epsilon_n = rng.normal(0.0, sigma)\n        y_n = G_n + epsilon_n\n\n        # Event trigger logic\n        # 1. Guard check: y_n = theta\n        # 2. Crossing condition: y_prev  theta\n        # 3. Dwell-time constraint: t_n - last_event_time = tau\n        is_event_triggered = (y_n = theta) and (y_prev  theta) and (t_n - last_event_time = tau)\n        \n        # Store current y_n for the next iteration's crossing check\n        y_prev = y_n\n\n        # The effective insulin for the current step's dynamics\n        I_eff_n = I_n\n        if is_event_triggered:\n            I_eff_n += B\n            last_event_time = t_n\n\n        # Forward Euler step for continuous dynamics\n        # Note: u_basal and d(t) are zero as per problem statement\n        dG_dt = -k_g * (G_n - G_b) - S_I * I_eff_n * (G_n - G_b)\n        dI_dt = -k_i * I_eff_n\n\n        G[n + 1] = G_n + h * dG_dt\n        # The Euler step for insulin starts from the post-bolus value\n        I[n + 1] = I_eff_n + h * dI_dt\n\n    # Stability assessment over the last T/2 minutes\n    analysis_start_index = int(num_steps / 2)\n    G_analysis_slice = G[analysis_start_index:]\n    \n    mu = np.mean(G_analysis_slice)\n    # Use ddof=1 for sample variance as is standard\n    v = np.var(G_analysis_slice, ddof=1)\n    \n    is_stable = (abs(mu - G_b) = epsilon_mu) and (v = v_max)\n    \n    return is_stable\n\ndef solve():\n    \"\"\"\n    Defines test cases and runs the simulation for each to determine stability.\n    \"\"\"\n    common_tolerances = {\n        \"epsilon_mu\": 5.0,     # mg/dL\n        \"v_max\": 400.0       # (mg/dL)^2\n    }\n\n    test_cases = [\n        # Case 1 (happy path)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 180, \"I_0\": 0,\n         \"theta\": 140, \"B\": 30, \"sigma\": 5, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 1, **common_tolerances},\n        # Case 2 (high noise, frequent events)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 130, \"I_0\": 0,\n         \"theta\": 110, \"B\": 50, \"sigma\": 30, \"tau\": 5, \"T\": 360, \"h\": 0.5, \"seed\": 2, **common_tolerances},\n        # Case 3 (small bolus)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 160, \"I_0\": 0,\n         \"theta\": 140, \"B\": 5, \"sigma\": 5, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 3, **common_tolerances},\n        # Case 4 (noise-free boundary)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 150, \"I_0\": 0,\n         \"theta\": 120, \"B\": 20, \"sigma\": 0, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 4, **common_tolerances}\n    ]\n\n    results = []\n    for params in test_cases:\n        is_stable = run_simulation(params)\n        results.append(is_stable)\n\n    # Format the final output as specified\n    # The boolean values need to be lowercase for the final output string\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\nsolve()\n```"
        }
    ]
}