{
    "hands_on_practices": [
        {
            "introduction": "平衡截断的理论优雅背后是一套具体的数值算法。这项练习将揭示平衡变换的计算过程，引导您完成一个涉及 Cholesky 分解和奇异值分解 (SVD) 的稳健流程 。理解这一过程是掌握处理真实世界生物医学模型时，诸如病态条件等数值稳定性考量的关键。",
            "id": "3903279",
            "problem": "对于一个危重病人，其线性化的输液控制葡萄糖-胰岛素子系统可以近似为一个稳定的线性时不变 (LTI) 模型，其状态、输入和输出由以下公式定义：\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\n其中 $x(t) \\in \\mathbb{R}^n$，$u(t) \\in \\mathbb{R}^m$，$y(t) \\in \\mathbb{R}^p$，并且 $A \\in \\mathbb{R}^{n \\times n}$ 是 Hurwitz 矩阵（所有特征值的实部均为严格负数）。需要通过平衡截断进行模型降阶，以生成一个能够保留对剂量-反应安全性至关重要的输入-输出行为的降阶表示。\n\n从无限时域可控性格拉姆矩阵和可观测性格拉姆矩阵的基本定义出发：\n$$\nW_c = \\int_0^{\\infty} e^{A t} B B^{\\top} e^{A^{\\top} t} \\, dt, \\quad\nW_o = \\int_0^{\\infty} e^{A^{\\top} t} C^{\\top} C \\, e^{A t} \\, dt,\n$$\n它们等价地满足连续时间 Lyapunov 方程：\n$$\nA W_c + W_c A^{\\top} + B B^{\\top} = 0, \\qquad\nA^{\\top} W_o + W_o A + C^{\\top} C = 0,\n$$\n请选择一个选项，该选项正确地概述了一个原则性步骤，即使用 $W_c$ 和 $W_o$ 的 Cholesky 分解以及奇异值分解 (SVD) 来计算一个平衡变换，并同时指出了在病态或刚性生物医学模型中主要存在的数值陷阱和相应的补救措施。\n\nA. 假设 $A$ 是 Hurwitz 矩阵且实现是最小的。求解 Lyapunov 方程得到 $W_c$ 和 $W_o$。计算 Cholesky 分解 $W_c = R_c R_c^{\\top}$ 和 $W_o = R_o R_o^{\\top}$，其中 $R_c, R_o$ 为上三角矩阵。计算 $R_o^{\\top} R_c$ 的 SVD 为 $U \\Sigma V^{\\top}$，其中 $U, V$ 是正交矩阵，$\\Sigma$ 是对角线上为非负项的对角矩阵。使用 Cholesky 因子和正交-对角结构定义一个相似性变换，使得在平衡坐标系中，两个变换后的格拉姆矩阵都相等且对角化，其对角项由 $\\Sigma$ 给出。截断与最小对角项相关的状态以获得一个降阶模型。数值陷阱包括：$W_c$ 或 $W_o$ 的近奇异性或病态条件导致正定性丧失和 Cholesky 分解失败；$A$ 的刚性降低了 Lyapunov 方程求解的精度并放大了舍入误差，使得 $\\Sigma$ 的小项不可靠；非最小性导致格拉姆矩阵秩亏。补救措施包括：对状态和输入/输出进行预缩放以改善条件数；使用平方根平衡截断以避免显式求逆并保持正交性；对近奇异的格拉姆矩阵采用带主元的 Cholesky 分解或对称的 $L D L^{\\top}$ 分解；验证稳定性和最小性或约简到最小实现；以及在处理大规模问题时使用低秩 Lyapunov 求解器。\n\nB. 从 Lyapunov 方程计算 $W_c$ 和 $W_o$，然后对 $W_c$ 进行特征值分解，得到 $W_c = Q \\Lambda Q^{-1}$，设置变换为 $T = Q \\Lambda^{1/2}$，使得 $T W_c T^{\\top}$ 是单位矩阵，并截断与 $W_c$ 最小特征值对应的状态。由于 $Q$ 对角化了 $W_c$，所以避免了数值问题，且由于只使用了 $W_c$，$A$ 的不稳定性无关紧要。\n\nC. 构造乘积 $W_c W_o$，计算其 SVD 为 $W_c W_o = U \\Sigma V^{\\top}$，并通过直接使用 $U$ 和 $V$ 来定义平衡变换，从而使乘积格拉姆矩阵对角化。Lyapunov 方程无需求解；而是从脉冲响应来估计 $W_c$ 和 $W_o$。数值陷阱仅限于 SVD 收敛问题，这可以通过选择更大的容差来处理，截断基于 $W_c W_o$ 的最小奇异值。\n\nD. 从仿真的阶跃或脉冲响应中收集状态快照 $x(t_k)$，组装一个数据矩阵，并通过 SVD 执行本征正交分解 (POD) 以获得主模态。使用这些模态作为平衡变换来对系统进行降阶。数值陷阱与采样不足和 $x(t_k)$ 中的噪声有关，这可以通过滤波和增加快照数量来缓解；$W_c$ 和 $W_o$ 的平衡是不必要的，因为 POD 已经捕获了主要的状态能量。",
            "solution": "问题陈述是有效的。它针对控制理论中的一个标准程序——平衡截断，在一个合理的生物医学背景下，提出了一个清晰、有科学依据且提法恰当的问题。所有给出的定义和条件都是标准的且自洽的。\n\n平衡截断的核心原理是找到一个状态空间相似性变换 $x = T\\hat{x}$，将系统 $(A, B, C)$ 变换为一个新的表示 $(\\hat{A}, \\hat{B}, \\hat{C}) = (T^{-1}AT, T^{-1}B, CT)$，在这个表示中，可控性和可观测性格拉姆矩阵相等且对角化：\n$$ \\hat{W}_c = \\hat{W}_o = \\Sigma = \\text{diag}(\\sigma_1, \\sigma_2, \\dots, \\sigma_n) $$\n值 $\\sigma_i$ 是系统的 Hankel 奇异值 (HSVs)，它量化了每个状态模态相对于输入到状态和状态到输出这两个映射的联合“能量”。与小的 HSV 对应的状态是弱可控和/或弱可观测的，可以被截断以产生一个能精确保留输入-输出行为的低阶模型。问题要求提供一个实现这一目标的数值上稳健的程序，并分析其潜在的陷阱。\n\n一个数值上鲁棒的方法，通常称为平方根平衡截断算法，避免了显式地构造乘积 $W_c W_o$，因为这会使问题的条件数平方，导致小的 Hankel 奇异值的精度损失。这样的一个程序如下：\n1.  给定一个稳定的（$A$ 是 Hurwitz 矩阵）和最小的实现 $(A, B, C)$，求解 Lyapunov 方程得到格拉姆矩阵 $W_c$ 和 $W_o$。最小性确保 $W_c, W_o$ 是正定的。\n2.  计算格拉姆矩阵的 Cholesky 分解。我们使用惯例 $W_c = L_c L_c^\\top$ 和 $W_o = L_o L_o^\\top$，其中 $L_c, L_o$ 是下三角矩阵。\n3.  构造矩阵乘积 $L_o^\\top L_c$ 并计算其奇异值分解 (SVD)：$L_o^\\top L_c = U \\Sigma V^\\top$。$\\Sigma$ 的对角项是 Hankel 奇异值 $\\sigma_i$。\n4.  构造平衡变换矩阵 $T = L_c V \\Sigma^{-1/2}$ 及其逆矩阵 $T^{-1} = \\Sigma^{1/2} V^\\top L_c^{-1}$。这个变换平衡了系统，即 $T^{-1}W_c(T^{-1})^\\top = \\Sigma$ 且 $T^\\top W_o T = \\Sigma$。\n5.  根据期望的降阶阶数 $k$（对应于 $k$ 个最大的 HSV），对平衡后的系统进行划分，并保留 $\\hat{A}$ 的前导 $k \\times k$ 子块以及 $\\hat{B}$ 和 $\\hat{C}$ 的相应部分。\n\n我们现在将根据这个原则性框架来评估每个选项。\n\nA. 这个选项概述的程序与上述的平方根方法完全一致。使用上三角因子 $R_c, R_o$ 使得 $W_c = R_c R_c^\\top$ 是一种有效但不太常见的 Cholesky 分解惯例；后续涉及 $R_o^\\top R_c$ 的 SVD 的步骤在数学上是等价且可靠的。关于结果的描述——变换后的格拉姆矩阵变得相等且对角化（$\\Sigma$）——是正确的。截断的方法也是正确的。\n至关重要的是，该选项提供了一个详尽而准确的数值陷阱及其相应补救措施的列表。它正确地指出了：\n- 由病态格拉姆矩阵（由于接近不可控/不可观测）引起的 Cholesky 分解失败的风险，以及使用带主元的 Cholesky 分解或 $LDL^\\top$ 分解的补救措施。\n- $A$ 的刚性对 Lyapunov 方程求解精度和小的 $\\sigma_i$ 可靠性的影响。\n- 最小性对于格拉姆矩阵可逆的必要性，以及约简到最小实现的补救措施。\n- 预缩放对改善条件数的好处。\n- 平方根方法（本选项所描述的）在避免数值退化方面的作用。\n- 在大规模系统中使用低秩求解器。\n这种对算法及其实际数值考虑的全面而正确的处理使得该选项高度可信。\n结论：**正确**。\n\nB. 这个选项根本上是错误的。它提出了一个仅基于可控性格拉姆矩阵 $W_c$ 的变换。程序 $T=Q\\Lambda^{1/2}$（其中 $W_c=Q\\Lambda Q^\\top$）创建了一个*输入标准型*实现，其中 $\\hat{W}_c=I$，但它完全忽略了可观测性格拉姆矩阵 $W_o$。变换后的 $\\hat{W}_o$ 通常不会是对角的，因此系统不是平衡的。仅基于 $W_c$ 的特征值进行截断会丢弃关于可观测性的必要信息。此外，声称“$A$ 的不稳定性无关紧要”是错误的；$A$ 的稳定性（Hurwitz）是无限时域格拉姆矩阵有明确定义的必要条件。\n结论：**不正确**。\n\nC. 这个选项描述了一种较旧的、数值上较差的方法，该方法涉及构造乘积 $W_c W_o$。这一步会使问题的条件数平方，可能导致对截断至关重要的小 Hankel 奇异值变得不准确。声称平衡变换是“直接使用 $U$ 和 $V$”从 $W_c W_o$ 的 SVD 中定义的说法是模糊且不正确的。声明“数值陷阱仅限于 SVD 收敛问题”是一种严重的过度简化和错误；主要的陷阱在于构造 $W_c W_o$ 本身所带来的病态问题。\n结论：**不正确**。\n\nD. 这个选项错误地将两种不同的模型降阶技术混为一谈：本征正交分解 (POD) 和平衡截断 (BT)。POD 为一组给定的状态“快照”（来自特定输入的仿真数据）生成一个最优基，以最小化重构该数据的 L2 误差。相比之下，BT 是一种基于可控性和可观测性这些内在系统属性的、与输入无关的方法。POD 基不是一个平衡变换，它不保证变换后的格拉姆矩阵是对角且相等的。声称平衡是“不必要的”表明了对这两种方法不同目标的根本性误解。虽然列出的陷阱与 POD 相关，但问题明确地是关于平衡截断的。\n结论：**不正确**。\n\n总之，只有选项 A 提供了数学上可靠、数值上鲁棒的平衡截断程序，并正确地指出了相关的实际挑战和解决方案。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦系统被平衡，关键问题就变为：应该保留多少个状态？这项练习将汉克尔奇异值的理论基础与选择满足特定误差容限的降阶模型阶数 $r$ 的实际任务联系起来 。您将应用平衡截断的误差界来做出明智的决策，并在临床背景下权衡模型保真度与计算效率之间的利弊。",
            "id": "3903299",
            "problem": "一个经临床验证的、用于标称工作点附近闭环药物输注的药代动力学-药效动力学线性时不变 (LTI) 模型由以下状态空间方程给出：$ \\dot{x}(t) = A x(t) + B u(t) $，$ y(t) = C x(t) $，其中 $ x(t) \\in \\mathbb{R}^n $，$ u(t) \\in \\mathbb{R}^m $，$ y(t) \\in \\mathbb{R}^p $。假设 $ A $ 是赫尔维茨的 (内部稳定)，且该实现是最小的。对于稳定的 $ A $，可控性格拉姆矩阵 $ W_c $ 和可观测性格拉姆矩阵 $ W_o $ 分别定义为 $ W_c = \\int_{0}^{\\infty} e^{A t} B B^{\\top} e^{A^{\\top} t} \\, dt $ 和 $ W_o = \\int_{0}^{\\infty} e^{A^{\\top} t} C^{\\top} C e^{A t} \\, dt $。汉克尔奇异值 (HSV) $ \\{ \\sigma_i \\}_{i=1}^n $ 定义为 $ W_c W_o $ 特征值的平方根，并按 $ \\sigma_1 \\ge \\sigma_2 \\ge \\cdots \\ge \\sigma_n > 0 $ 的顺序排列。在平衡实现中，$ W_c = W_o = \\Sigma = \\operatorname{diag}(\\sigma_1, \\ldots, \\sigma_n) $，且平衡截断 (BT) 通过截断与最小汉克尔奇异值相关的状态来降阶。\n\n你的任务是为平衡截断选择一个降阶后的阶数 $ r $，以满足给定的感应 $ \\mathcal{H}_{\\infty} $ 输入-输出误差容限 $ \\varepsilon $，同时遵守临床控制的实时性和安全性约束。考虑一个特定的针对患者的平衡实现，其参数为 $ n = 5 $，汉克尔奇异值为 $ \\sigma = [\\, 3.2,\\, 0.8,\\, 0.15,\\, 0.07,\\, 0.02 \\,] $ (单位已归一化)，容限为 $ \\varepsilon = 0.3 $。\n\n选择所有正确的陈述。\n\nA. 为保证平衡截断满足 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $，应选择最小的 $ r $ 使得 $ 2 \\sum_{i=r+1}^{n} \\sigma_i \\le \\varepsilon $。对于给定的汉克尔奇异值和 $ \\varepsilon $，这得到 $ r = 3 $。\n\nB. 一个实用的规则是选择 $ r $ 等于超过 $ \\varepsilon $ 的汉克尔奇异值的数量，即计算满足 $ \\sigma_i > \\varepsilon $ 的个数。对于给定的汉克尔奇异值和 $ \\varepsilon $，这得到 $ r = 2 $，并且它保证 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $。\n\nC. 如果选择的 $ r $ 满足 $ \\sum_{i=r+1}^{n} \\sigma_i^2 \\le \\varepsilon^2 / 4 $，那么平衡截断保证感应 $ \\mathcal{H}_{\\infty} $ 范数误差 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $。\n\nD. 在闭环临床应用中，较小的 $ r $ 会减少计算延迟并可能提高数值鲁棒性，但过于激进的降阶可能会移除对患者安全至关重要的、具有临床意义的快速瞬态动力学；因此，应通过考虑患者变异性和安全裕度的闭环仿真来验证 $ r $，因为平衡截断的界是频率上的最坏情况，并且没有解决参数不确定性问题。\n\nE. 平衡截断能精确地保持稳态 (直流) 增益，所以减小 $ r $ 不会影响基础输注速率的预测；因此，选择较小的 $ r $ 对稳态精度没有风险。\n\nF. 基于汉克尔奇异值的平衡截断 $ \\mathcal{H}_{\\infty} $ 误差界即使在 $ A $ 不稳定的情况下也同样适用；因此，对于在急性临床状态下出现的不稳定线性化模型，可以不加修改地使用相同的 $ r $ 选择规则。",
            "solution": "问题陈述已经过验证，并被认为是科学上合理的、适定的和完整的。我们可以继续进行分析。\n\n问题要求评估关于将平衡截断 (BT)应用于一个稳定的、最小的、线性时不变 (LTI) 系统的模型降阶的几个陈述，特别是在生物医学应用的背景下。该系统的阶数为 $n=5$，汉克尔奇异值 (HSV) 由向量 $\\sigma = [\\, 3.2,\\, 0.8,\\, 0.15,\\, 0.07,\\, 0.02 \\,]$ 给出，期望的 $\\mathcal{H}_{\\infty}$ 误差容限为 $\\varepsilon = 0.3$。\n\n设 $G(s)$ 为原系统的传递函数，$G_r(s)$ 为通过平衡截断获得的 $r$ 阶降阶模型的传递函数。问题围绕平衡截断的性质及其相关的误差界展开。控制理论中关于稳定LTI系统的一个关键结果是误差系统的 $\\mathcal{H}_{\\infty}$ 范数的先验误差界：\n$$ \\| G - G_r \\|_{\\infty} \\le 2 \\sum_{i=r+1}^{n} \\sigma_i $$\n这个界是平衡截断的基石，并提供了一个充分条件，用以指导选择降阶后的阶数 $ r $ 来满足指定的误差容限 $\\varepsilon$。\n\n我们现在将逐个分析每个陈述。\n\n**A. 为保证平衡截断满足 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $，应选择最小的 $ r $ 使得 $ 2 \\sum_{i=r+1}^{n} \\sigma_i \\le \\varepsilon $。对于给定的汉克尔奇异值和 $ \\varepsilon $，这得到 $ r = 3 $。**\n\n该陈述包含两部分：选择 $r$ 的规则以及将其应用于给定数据。\n\n$1$. 规则：条件 $ 2 \\sum_{i=r+1}^{n} \\sigma_i \\le \\varepsilon $ 是一个标准的、公认的充分条件，用于保证对于一个稳定系统，降阶误差的 $\\mathcal{H}_{\\infty}$ 范数 $\\| G - G_r \\|_{\\infty}$ 小于或等于容限 $\\varepsilon$。陈述的这部分是正确的。\n\n$2$. 计算：给定 $n=5$，$\\sigma = [\\, 3.2,\\, 0.8,\\, 0.15,\\, 0.07,\\, 0.02 \\,]$，以及 $\\varepsilon = 0.3$。我们必须在 $[0, 4]$ 范围内找到满足该不等式的最小整数 $r$。\n- 对于 $r=1$：界为 $2 \\sum_{i=2}^{5} \\sigma_i = 2(\\sigma_2 + \\sigma_3 + \\sigma_4 + \\sigma_5) = 2(0.8 + 0.15 + 0.07 + 0.02) = 2(1.04) = 2.08$。这不满足 $\\le 0.3$。\n- 对于 $r=2$：界为 $2 \\sum_{i=3}^{5} \\sigma_i = 2(\\sigma_3 + \\sigma_4 + \\sigma_5) = 2(0.15 + 0.07 + 0.02) = 2(0.24) = 0.48$。这不满足 $\\le 0.3$。\n- 对于 $r=3$：界为 $2 \\sum_{i=4}^{5} \\sigma_i = 2(\\sigma_4 + \\sigma_5) = 2(0.07 + 0.02) = 2(0.09) = 0.18$。这满足 $\\le 0.3$。\n\n由于 $r=3$ 是满足该条件的最小整数，所以计算是正确的。\n陈述的两部分都是正确的。\n\n结论：**正确**。\n\n**B. 一个实用的规则是选择 $ r $ 等于超过 $ \\varepsilon $ 的汉克尔奇异值的数量，即计算满足 $ \\sigma_i > \\varepsilon $ 的个数。对于给定的汉克尔奇异值和 $ \\varepsilon $，这得到 $ r = 2 $，并且它保证 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $。**\n\n这个陈述提出了一个启发式规则，并声称它提供了一个保证。\n$1$. 规则和计算：我们计算满足 $\\sigma_i > \\varepsilon = 0.3$ 的汉克尔奇异值 $\\sigma_i$ 的数量。\n- $\\sigma_1 = 3.2 > 0.3$\n- $\\sigma_2 = 0.8 > 0.3$\n- $\\sigma_3 = 0.15 \\le 0.3$\n数量为2。所以，这个规则建议 $r=2$。计算是正确的。\n\n$2$. 保证：该陈述声称选择 $r=2$ *保证* $\\| G - G_r \\|_{\\infty} \\le \\varepsilon$。正如在选项A的分析中计算的，对于 $r=2$，保证的误差界是 $0.48$，大于 $\\varepsilon = 0.3$。因此，选择 $r=2$ 并不能保证误差低于容限。这个规则是一个启发式方法，有时用于初步猜测，但它不是 $\\mathcal{H}_{\\infty}$ 误差的正式保证。声称的保证是错误的。\n\n结论：**不正确**。\n\n**C. 如果选择的 $ r $ 满足 $ \\sum_{i=r+1}^{n} \\sigma_i^2 \\le \\varepsilon^2 / 4 $，那么平衡截断保证感应 $ \\mathcal{H}_{\\infty} $ 范数误差 $ \\| G - G_r \\|_{\\infty} \\le \\varepsilon $。**\n\n这个陈述为 $\\mathcal{H}_{\\infty}$ 误差界提出了一个替代条件。量 $\\sqrt{\\sum_{i=r+1}^{n} \\sigma_i^2}$ 已知是误差系统 $\\| G - G_r \\|_{2}$ 的精确 $\\mathcal{H}_2$ 范数。因此，陈述中给出的条件等价于 $\\| G - G_r \\|_{2}^2 \\le \\varepsilon^2 / 4$，即 $\\| G - G_r \\|_{2} \\le \\varepsilon / 2$。控制理论中没有普适定理表明 $\\| G - G_r \\|_{2} \\le \\varepsilon/2$ 蕴含 $\\| G - G_r \\|_{\\infty} \\le \\varepsilon$。事实上，根据柯西-施瓦茨不等式，我们有 $(\\sum_{i=r+1}^{n} \\sigma_i)^2 \\le (n-r) \\sum_{i=r+1}^{n} \\sigma_i^2$。标准的充分条件是 $\\sum_{i=r+1}^{n} \\sigma_i \\le \\varepsilon / 2$。本陈述中的条件通常不足以保证所需的 $\\mathcal{H}_{\\infty}$ 界。例如，如果 $n-r > 4$，本陈述中的条件比标准条件要弱。因此，所提出的条件不是 $\\mathcal{H}_{\\infty}$ 误差界的有效保证。\n\n结论：**不正确**。\n\n**D. 在闭环临床应用中，较小的 $ r $ 会减少计算延迟并可能提高数值鲁棒性，但过于激进的降阶可能会移除对患者安全至关重要的、具有临床意义的快速瞬态动力学；因此，应通过考虑患者变异性和安全裕度的闭环仿真来验证 $ r $，因为平衡截断的界是频率上的最坏情况，并且没有解决参数不确定性问题。**\n\n这个陈述讨论了在安全关键领域应用模型降阶的实际工程考虑。\n- 较小的模型阶数 $r$ 意味着系统状态更少，模拟和控制律实现所需的计算也更少。这减少了计算延迟，并通过移除难以控制或观测的状态来改善数值条件。\n- 平衡截断倾向于截断对应于具有低能量（小的汉克尔奇异值）的快速动态的状态。虽然这些状态对开环频率响应幅值的影响可能很小，但它们对于闭环稳定性、瞬态性能和患者安全可能是至关重要的。\n- $\\mathcal{H}_{\\infty}$ 误差界是针对所有输入信号和所有频率的最坏情况度量。在感兴趣的频率上，实际误差可能要小得多。\n- 模型降阶是在一个标称模型上执行的，该模型未考虑患者间的变异性或单个患者生理状况随时间的变化（参数不确定性）。鲁棒控制设计必须考虑这一点。\n- 因此，在最终的闭环控制系统中，通过在各种患者模型和场景下进行广泛的仿真来验证降阶模型，是生物医学控制工程中确保安全性和性能的一个必要且标准的做法。\n此陈述中的每一个论断都是正确的，并反映了安全关键应用的合理工程原则。\n\n结论：**正确**。\n\n**E. 平衡截断能精确地保持稳态 (直流) 增益，所以减小 $ r $ 不会影响基础输注速率的预测；因此，选择较小的 $ r $ 对稳态精度没有风险。**\n\n稳定LTI系统的稳态或直流 (DC) 增益由其传递函数 $G(s)$ 在 $s=0$ 处的值给出，即 $G(0) = -CA^{-1}B$。标准的平衡截断，如问题中所定义，通常不保留系统的直流增益。也就是说，对于降阶模型 $G_r(s)$，通常情况下 $G_r(0) \\neq G(0)$。有一些平衡截断的特定变体（例如，直流匹配平衡截断）被设计用来强制实现这一属性，但这并非标准算法的特性。由于平衡截断保留直流增益的前提是错误的，所以它不会影响稳态预测（如基础输注速率）的结论也是错误的。这使得该陈述不正确，并且如果在实践中不加注意地应用，可能会很危险。\n\n结论：**不正确**。\n\n**F. 基于汉克尔奇异值的平衡截断 $ \\mathcal{H}_{\\infty} $ 误差界即使在 $ A $ 不稳定的情况下也同样适用；因此，对于在急性临床状态下出现的不稳定线性化模型，可以不加修改地使用相同的 $ r $ 选择规则。**\n\n这个陈述声称用于稳定系统的平衡截断理论可以直接扩展到不稳定系统。这从根本上是错误的。可控性格拉姆矩阵 $W_c$ 和可观测性格拉姆矩阵 $W_o$ 是通过从 $t=0$ 到 $t=\\infty$ 的积分来定义的。这些积分仅当状态矩阵 $A$ 是赫尔维茨的（即其所有特征值的实部都为负）时才收敛。如果 $A$ 不稳定，则格拉姆矩阵是未定义的，因此，汉克尔奇异值和整个标准的平衡截断框架，包括误差界，都不适用。不稳定系统的模型降阶需要不同的技术，例如将系统分解为其稳定和不稳定部分，并仅对稳定部分应用平衡截断。其过程和误差界是不同的，也更复杂。声称该理论“同样适用”并且规则可以“不加修改地使用”是错误的。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "这项综合性练习在一个完整的工作流中集成了模型构建与降阶，从一个基础的反应-扩散偏微分方程开始。您将应用有限元方法创建高保真模型，然后使用仿真数据执行恰当正交分解 (POD)——一种强大的数据驱动降阶技术 。通过将结果与平衡截断 (BT) 的见解进行对比，您将对从头开始为复杂生物医学系统创建高效且精确的模型获得全面的理解。",
            "id": "3903225",
            "problem": "考虑一个在生物医学系统建模中常用于组织内信号分子传输的一维空间分布反应扩散模型。其控制偏微分方程是线性抛物型方程\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = d\\,\\frac{\\partial^2 u}{\\partial x^2}(x,t) - \\lambda\\,u(x,t) + b(x)\\,w(t), \\quad x \\in (0,L), \\; t \\ge 0,\n$$\n其中，$u(x,t)$ 表示无量纲浓度，$d > 0$ 是一个扩散系数（无量纲化后为无量纲），$\\lambda > 0$ 是一个反应衰减率（无量纲化后为无量纲），$b(x)$ 是一个空间分布的输入形状，$w(t)$ 是一个标量输入信号。输出可以看作是状态的线性泛函，$y(t) = c^\\top u(t)$，其中 $c$ 是一个空间权重向量。\n\n使用有限元法（FEM）对空间域进行离散化，在 $[0,L]$ 上使用包含 $N$ 个单元的均匀网格，并采用分段线性基函数，其中 $L = 1$。设节点位置为 $x_i = i h$，对于 $i = 0,1,\\dots,N$，其中 $h = L/N$。使用规范单元矩阵\n$$\nM_e = \\frac{h}{6}\\begin{bmatrix}2  1 \\\\ 1  2\\end{bmatrix}, \\quad\nK_e = \\frac{1}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}\n$$\n来组装标准质量矩阵 $M \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 和刚度矩阵 $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$。\n半离散模型为\n$$\nM\\,\\dot{u}(t) = -d\\,K\\,u(t) - \\lambda\\,M\\,u(t) + B\\,w(t),\n$$\n其中 $u(t) \\in \\mathbb{R}^{N+1}$ 是节点值的向量，$B \\in \\mathbb{R}^{N+1}$ 是通过对 $b(x)$ 进行一致的有限元组装得到的离散化输入向量，即 $B_i = \\int_0^L \\varphi_i(x)\\,b(x)\\,dx$，其中 $\\varphi_i(x)$ 是有限元基函数。对于使用节点求积的实际实现，您可以将 $B$ 近似为 $M\\,b$，其中 $b \\in \\mathbb{R}^{N+1}$ 是 $b(x)$ 的节点采样值向量。\n\n边界条件必须一致地施加。对于齐次狄利克雷边界条件，$u(0,t) = 0$ 和/或 $u(L,t) = 0$，消除受约束的自由度并处理内部未知量。对于齐次诺伊曼边界条件（零通量），自然边界条件已在有限元公式中得到考虑，不需要消除。\n\n您必须构建按质量矩阵 $M$ 加权的本征正交分解（POD）模态（记为 $M$-加权 POD）。设快照矩阵为 $X = [u(t_1),u(t_2),\\dots,u(t_m)] \\in \\mathbb{R}^{n\\times m}$，由施加边界条件后的内部自由度组成，其中 $n$ 是内部节点的数量。定义 $\\mathbb{R}^n$ 上的 $M$-加权内积为 $\\langle v,w\\rangle_M = v^\\top M\\,w$。$r$ 个领先的 $M$-加权 POD 模态必须是满足 $\\Phi^\\top M\\,\\Phi = I_r$ 的矩阵 $\\Phi \\in \\mathbb{R}^{n\\times r}$ 的列。使用这些模态对半离散模型进行伽辽金投影，确保降阶模型与边界条件一致（即，降阶状态仅跨越内部自由度，并且当提升回全空间时，在齐次狄利克雷约束下，边界值恒为零）。降阶模型应以质量归一化坐标表示，得到\n$$\n\\dot{q}(t) = A_r\\,q(t) + B_r\\,w(t), \\quad A_r = \\Phi^\\top(-d\\,K - \\lambda\\,M)\\Phi, \\; B_r = \\Phi^\\top B,\n$$\n其中 $q(t) \\in \\mathbb{R}^r$ 是降阶坐标，且 $\\Phi^\\top M\\,\\Phi = I_r$。\n\n此外，对于一个小实例，通过将半离散模型左乘 $M^{-1}$ 得到 $\\dot{u}(t) = A\\,u(t) + B_s\\,w(t)$，其中 $A = -d\\,M^{-1}K - \\lambda\\,I$ 和 $B_s = M^{-1}B$，从而推导出标准的状态空间表示。通过求解可控性格拉姆矩阵和可观测性格拉姆矩阵的连续时间李雅普诺夫方程来计算平衡截断（BT）汉克尔奇异值，\n$$\nA\\,P + P\\,A^\\top + B_s\\,B_s^\\top = 0, \\quad A^\\top Q + Q\\,A + C^\\top C = 0,\n$$\n其中 $C \\in \\mathbb{R}^{1\\times n}$ 定义了一个标量输出 $y(t) = C\\,u(t)$。\n\n您的程序必须以自包含的方式实现上述内容，并为以下测试套件生成结果。所有量均为无量纲。时间积分必须使用后向欧拉法以保证稳定性。\n\n测试用例 1（正常路径，两端齐次狄利克雷条件）：\n- 参数：$N = 40$，$L = 1$，$d = 0.02$，$\\lambda = 1.5$，$r = 6$，$T = 1.0$，$\\Delta t = 0.002$。\n- 边界条件：$u(0,t) = 0$，$u(L,t) = 0$。\n- 输入：$w(t) = \\sin(2\\pi t)$。\n- 输入形状：在节点处采样的 $b(x) = \\exp\\left(-\\left(\\frac{x - 0.5}{0.1}\\right)^2\\right)$。\n- 初始条件：$u(x,0) = 0$。\n- 任务：模拟全阶半离散模型，在每个时间步收集 $m$ 个快照。构建 $r = 6$ 的 $M$-加权 POD 模态，对模型进行投影，并使用相同的输入和时间步长模拟降阶模型。报告所有快照中的最大 $M$-范数状态误差，\n$$\n\\max_k \\sqrt{(u_k - \\hat{u}_k)^\\top M\\,(u_k - \\hat{u}_k)},\n$$\n其中 $u_k$ 是内部全阶状态，$\\hat{u}_k$ 是提升后的降阶状态。将此值作为浮点数输出。\n\n测试用例 2（混合边界条件的边界处理）：\n- 参数：$N = 40$，$L = 1$，$d = 0.05$，$\\lambda = 0.5$，$r = 5$，$T = 1.0$，$\\Delta t = 0.002$。\n- 边界条件：$u(0,t) = 0$（狄利克雷），$\\frac{\\partial u}{\\partial x}(L,t) = 0$（诺伊曼）。\n- 输入：$w(t) = \\cos(2\\pi t)$。\n- 输入形状：在节点处采样的 $b(x) = \\exp\\left(-\\left(\\frac{x - 0.3}{0.08}\\right)^2\\right)$。\n- 初始条件：$u(x,0) = 0$。\n- 任务：使用指定的边界条件和参数重复测试用例 1 中的过程。将所有快照中的最大 $M$-范数状态误差作为浮点数报告。\n\n测试用例 3（平衡截断汉克尔奇异值）：\n- 参数：$N = 20$，$L = 1$，$d = 0.03$，$\\lambda = 1.0$。\n- 边界条件：$u(0,t) = 0$，$u(L,t) = 0$。\n- 输入形状向量：在节点处采样的 $b(x) = \\exp\\left(-\\left(\\frac{x - 0.6}{0.12}\\right)^2\\right)$，以及 $B = M\\,b$。\n- 输出向量：$C$ 定义为在内部节点上具有条目 $c_i = b(x_i)$ 的行向量，得到 $y(t) = C\\,u(t)$。\n- 任务：在内部自由度上构建标准状态空间矩阵 $A = -d\\,M^{-1}K - \\lambda\\,I$，$B_s = M^{-1}B$，并通过求解连续李雅普诺夫方程计算可控性格拉姆矩阵 $P$ 和可观测性格拉姆矩阵 $Q$。计算汉克尔奇异值，即 $P\\,Q$ 的特征值的平方根，按降序排序，并返回前 3 个值作为浮点数列表。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，第三个条目本身是一个列表。格式必须是\n$[$result1$,$result2$,$[hsv1$,$hsv2$,$hsv3]$]$，例如 $[0.123,0.456,[1.23,0.45,0.12]]$。",
            "solution": "用户提供的问题是关于偏微分方程数值方法和模型降阶的一个综合性练习。该问题具有科学依据、适定的，且其公式是内部一致的。我将提供一个完整的解决方案。解决方案的方法如下：\n\n首先，使用具有线性基函数的有限元法（FEM）对一维反应扩散偏微分方程（PDE）的空间域进行离散化。此过程将PDE转换为一个大型的耦合常微分方程（ODEs）系统，称为半离散模型或全阶模型（FOM）。该系统的结构为 $M\\,\\dot{u}(t) = \\mathbf{A}\\,u(t) + B\\,w(t)$，其中 $M$ 是质量矩阵，$\\mathbf{A} = -d\\,K - \\lambda\\,M$ 包含刚度矩阵 $K$ 和质量矩阵 $M$。通过将系统限制在其内部自由度来施加齐次边界条件。\n\n其次，对于测试用例1和2，使用稳定的后向欧拉法对FOM进行时间上的模拟。状态向量的时间历程被收集到一个快照矩阵 $X$ 中。该矩阵包含了FOM的基本动态行为。\n\n第三，将本征正交分解（POD）应用于快照数据以提取一个低维基。问题指定了 $M$-加权 POD，这适用于FEM离散化的系统，因为它尊重由质量矩阵定义的底层能量范数。$M$-加权 POD 模态 $\\Phi$ 构成一个 $M$-标准正交基，能够最优地捕捉记录在快照中的系统“能量”。计算这些模态的过程包括对内部质量矩阵进行Cholesky分解 $M_{int} = L\\,L^\\top$，然后对加权快照矩阵 $\\tilde{X} = L^\\top X$ 进行标准的奇异值分解（SVD）。然后通过求解一个三角系统来恢复POD模态。\n\n第四，通过将FOM伽辽金投影到POD基 $\\Phi$ 上来构建一个降阶模型（ROM）。这将产生一个规模小得多的常微分方程系统 $\\dot{q}(t) = A_r\\,q(t) + B_r\\,w(t)$，其中状态 $q(t)$ 的维数 $r$ 远低于FOM状态 $u(t)$。降阶系统矩阵由 $A_r = \\Phi^\\top(-d\\,K_{int} - \\lambda\\,M_{int})\\Phi$ 和 $B_r = \\Phi^\\top B_{int}$ 给出。这个ROM也使用后向欧拉法进行模拟。\n\n第五，通过将其解与FOM的解进行比较来评估ROM的准确性。每个时间步的ROM状态 $q_k$ 被“提升”回全维空间，即 $\\hat{u}_k = \\Phi\\,q_k$。误差计算为所有时间步上全阶状态 $u_k$ 与提升后的降阶状态 $\\hat{u}_k$ 之差的 $M$-范数的最大值，即 $\\max_k \\sqrt{(u_k - \\hat{u}_k)^\\top M_{int}\\,(u_k - \\hat{u}_k)}$。\n\n第六，对于测试用例3，探讨了另一种模型降阶技术，即平衡截断（BT）。这需要通过左乘 $M_{int}^{-1}$ 将半离散系统转换为标准状态空间形式 $\\dot{u}(t) = A\\,u(t) + B_s\\,w(t)$。BT的核心在于分别计算可控性格拉姆矩阵 $P$ 和可观测性格拉姆矩阵 $Q$。这些是通过求解连续时间代数李雅普诺夫方程得到的。然后，汉克尔奇异值（HSVs）$\\sigma_i$ 被计算为格拉姆矩阵乘积的特征值的平方根，即 $\\sigma_i = \\sqrt{\\lambda_i(P\\,Q)}$。这些值量化了状态的联合可控性和可观测性，为模型降阶提供了一个度量标准。任务是计算并报告前三个HSV。\n\n实现将遵循这些步骤，仔细处理矩阵组装、边界条件施加以及POD和BT的具体数值算法。\n\n**分步推导**\n\n**1. 有限元离散化和组装**\n空间域 $[0, L]$ 被划分为 $N$ 个大小为 $h = L/N$ 的单元。全局质量矩阵 $M \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 和刚度矩阵 $K \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 通过遍历每个单元并将单元质量矩阵 $M_e = \\frac{h}{6}\\begin{bmatrix}2  1 \\\\ 1  2\\end{bmatrix}$ 和单元刚度矩阵 $K_e = \\frac{1}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$ 的局部贡献加到全局矩阵的相应条目中来组装。\n\n**2. 边界条件（BC）施加**\n对于齐次狄利克雷边界条件，$u_i = 0$，从系统矩阵 $M, K$ 和向量 $B$ 中移除第 $i$ 行和第 $i$ 列。对于齐次诺伊曼边界条件，这是此有限元公式中的自然边界条件，在诺伊曼边界节点处无需修改。设得到的内部矩阵为 $M_{int}, K_{int}$，向量为 $B_{int}$。\n\n**3. 全阶模型（FOM）仿真**\n内部节点 $u_{int}$ 的FOM为 $M_{int}\\,\\dot{u}_{int}(t) = (-d K_{int} - \\lambda M_{int})u_{int}(t) + B_{int}w(t)$。应用时间步长为 $\\Delta t$ 的后向欧拉离散化，我们有：\n$$ M_{int}\\,\\frac{u_{k+1}-u_k}{\\Delta t} = (-d K_{int} - \\lambda M_{int})u_{k+1} + B_{int}w_{k+1} $$\n重新整理以求解下一时间步的状态 $u_{k+1}$，得到线性系统：\n$$ (M_{int} + \\Delta t(d K_{int} + \\lambda M_{int}))\\,u_{k+1} = M_{int}\\,u_k + \\Delta t B_{int}w_{k+1} $$\n左侧的矩阵是恒定的，可以进行一次分解（例如LU分解）以实现高效的重复求解。\n\n**4. M-加权本征正交分解（POD）**\n给定内部状态的快照矩阵 $X = [u_1, \\dots, u_m] \\in \\mathbb{R}^{n \\times m}$，目标是找到在 $M_{int}$-内积下是标准正交的模态 $\\Phi \\in \\mathbb{R}^{n \\times r}$，即 $\\Phi^\\top M_{int} \\Phi = I_r$。\na. 计算对称正定质量矩阵的Cholesky分解：$M_{int} = L\\,L^\\top$。\nb. 对快照进行加权：$\\tilde{X} = L^\\top X$。\nc. 计算加权快照的SVD：$\\tilde{X} = U \\Sigma V^\\top$。左奇异向量 $U$ 是加权坐标系中的POD模态。\nd. 选择 $U$ 的前 $r$ 列构成 $\\tilde{\\Phi} = U[:, :r]$。\ne. 通过求解线性系统 $L^\\top \\Phi = \\tilde{\\Phi}$ 将模态变换回原始坐标系。\n\n**5. 降阶模型（ROM）仿真**\nROM为 $\\dot{q}(t) = A_r q(t) + B_r w(t)$，其中 $A_r = \\Phi^\\top(-d K_{int} - \\lambda M_{int})\\Phi$ 且 $B_r = \\Phi^\\top B_{int}$。使用后向欧拉法：\n$$ \\frac{q_{k+1}-q_k}{\\Delta t} = A_r q_{k+1} + B_r w_{k+1} \\implies (I_r - \\Delta t A_r)q_{k+1} = q_k + \\Delta t B_r w_{k+1} $$\n这个 $r \\times r$ 的线性系统在每个时间步求解。\n\n**6. 平衡截断（BT）**\na. 为内部节点构建状态空间矩阵：$A = -d\\,M_{int}^{-1}K_{int} - \\lambda\\,I$，$B_s = M_{int}^{-1}B_{int}$ 和 $C$。\nb. 求解可控性格拉姆矩阵 $P$ 和可观测性格拉姆矩阵 $Q$ 的连续时间李雅普诺夫方程：\n   $$ A\\,P + P\\,A^\\top + B_s\\,B_s^\\top = 0 $$\n   $$ A^\\top Q + Q\\,A + C^\\top C = 0 $$\nc. 计算乘积 $P Q$ 的特征值 $\\lambda_i$。\nd. 汉克尔奇异值为 $\\sigma_i = \\sqrt{\\lambda_i}$。这些值按降序排序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the execution of all test cases.\n    \"\"\"\n\n    def assemble_matrices(N, L):\n        \"\"\"\n        Assembles the global mass (M) and stiffness (K) matrices for a 1D problem\n        with N linear finite elements.\n        \"\"\"\n        h = L / N\n        M_e = (h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n        K_e = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n\n        M = np.zeros((N + 1, N + 1))\n        K = np.zeros((N + 1, N + 1))\n\n        for i in range(N):\n            M[i:i+2, i:i+2] += M_e\n            K[i:i+2, i:i+2] += K_e\n        return M, K\n\n    def solve_pod_case(N, L, d, lmbda, r, T, dt, bc_type, w_func, b_func):\n        \"\"\"\n        Solves test cases 1 and 2, which involve POD model reduction.\n        \"\"\"\n        # 1. Setup and FEM Assembly\n        M, K = assemble_matrices(N, L)\n        nodes = np.linspace(0, L, N + 1)\n        b_vec = b_func(nodes)\n        B_vec = M @ b_vec\n\n        # 2. Boundary Condition Enforcement\n        if bc_type == 'dirichlet-dirichlet':\n            # u(0)=0, u(L)=0. Interior nodes are 1 to N-1\n            int_indices = np.arange(1, N)\n        elif bc_type == 'dirichlet-neumann':\n            # u(0)=0, u'(L)=0. Interior nodes are 1 to N\n            int_indices = np.arange(1, N + 1)\n        else:\n            raise ValueError(\"Unknown BC type\")\n        \n        M_int = M[np.ix_(int_indices, int_indices)]\n        K_int = K[np.ix_(int_indices, int_indices)]\n        B_int = B_vec[int_indices]\n        n_int = len(int_indices)\n\n        # 3. Full-Order Model (FOM) Simulation\n        num_steps = int(T / dt)\n        times = np.linspace(0, T, num_steps + 1)\n        \n        u_int = np.zeros(n_int)\n        snapshots = np.zeros((n_int, num_steps + 1))\n        snapshots[:, 0] = u_int\n\n        A_fom_sys = -d * K_int - lmbda * M_int\n        LHS_fom = M_int - dt * A_fom_sys\n        LHS_fom_lu = linalg.lu_factor(LHS_fom)\n\n        for k in range(num_steps):\n            w_next = w_func(times[k+1])\n            rhs_fom = M_int @ u_int + dt * B_int * w_next\n            u_int = linalg.lu_solve(LHS_fom_lu, rhs_fom)\n            snapshots[:, k+1] = u_int\n\n        # 4. M-weighted POD\n        L_M = linalg.cholesky(M_int, lower=True)\n        X_tilde = L_M.T @ snapshots\n        U, s, Vh = linalg.svd(X_tilde, full_matrices=False)\n        Phi_tilde = U[:, :r]\n        Phi = linalg.solve_triangular(L_M.T, Phi_tilde, lower=False)\n\n        # 5. Reduced-Order Model (ROM) Simulation\n        A_r = Phi.T @ A_fom_sys @ Phi\n        B_r = Phi.T @ B_int\n\n        q = np.zeros(r)\n        u_hat_snapshots = np.zeros((n_int, num_steps + 1))\n        u_hat_snapshots[:, 0] = Phi @ q\n\n        LHS_rom = np.eye(r) - dt * A_r\n        LHS_rom_inv = linalg.inv(LHS_rom)\n\n        for k in range(num_steps):\n            w_next = w_func(times[k+1])\n            rhs_rom = q + dt * B_r * w_next\n            q = LHS_rom_inv @ rhs_rom\n            u_hat_snapshots[:, k+1] = Phi @ q\n        \n        # 6. Error Calculation\n        max_err_sq = 0.0\n        for k in range(num_steps + 1):\n            error_vec = snapshots[:, k] - u_hat_snapshots[:, k]\n            weighted_error_vec = L_M.T @ error_vec\n            err_norm_sq = weighted_error_vec.T @ weighted_error_vec\n            if err_norm_sq  max_err_sq:\n                max_err_sq = err_norm_sq\n        \n        return np.sqrt(max_err_sq)\n        \n    def solve_bt_case(N, L, d, lmbda, b_func, c_func):\n        \"\"\"\n        Solves test case 3, which involves Balanced Truncation.\n        \"\"\"\n        # 1. Setup and FEM Assembly\n        M, K = assemble_matrices(N, L)\n        nodes = np.linspace(0, L, N + 1)\n        b_vec = b_func(nodes)\n        B_vec = M @ b_vec\n\n        # 2. BC Enforcement (Dirichlet-Dirichlet)\n        int_indices = np.arange(1, N)\n        M_int = M[np.ix_(int_indices, int_indices)]\n        K_int = K[np.ix_(int_indices, int_indices)]\n        B_int = B_vec[int_indices]\n        C_int = c_func(nodes[int_indices])\n        \n        # 3. State-Space Matrices\n        M_int_inv = linalg.inv(M_int)\n        A = -d * (M_int_inv @ K_int) - lmbda * np.eye(N - 1)\n        Bs = M_int_inv @ B_int\n        C = C_int.reshape(1, -1)\n        \n        Bs_col = Bs.reshape(-1, 1)\n\n        # 4. Solve Lyapunov Equations\n        P = linalg.solve_continuous_lyapunov(A, -Bs_col @ Bs_col.T)\n        Q = linalg.solve_continuous_lyapunov(A.T, -C.T @ C)\n\n        # 5. Hankel Singular Values\n        hsv_sq = linalg.eigvals(P @ Q)\n        # Eigenvalues of PQ should be real, but can have small imag part due to numerics\n        hsv = np.sqrt(np.abs(hsv_sq))\n        hsv_sorted = np.sort(hsv)[::-1]\n\n        return list(hsv_sorted[:3])\n\n    # Test Case 1\n    result1 = solve_pod_case(\n        N=40, L=1.0, d=0.02, lmbda=1.5, r=6, T=1.0, dt=0.002,\n        bc_type='dirichlet-dirichlet',\n        w_func=lambda t: np.sin(2 * np.pi * t),\n        b_func=lambda x: np.exp(-((x - 0.5) / 0.1)**2)\n    )\n\n    # Test Case 2\n    result2 = solve_pod_case(\n        N=40, L=1.0, d=0.05, lmbda=0.5, r=5, T=1.0, dt=0.002,\n        bc_type='dirichlet-neumann',\n        w_func=lambda t: np.cos(2 * np.pi * t),\n        b_func=lambda x: np.exp(-((x - 0.3) / 0.08)**2)\n    )\n\n    # Test Case 3\n    result3 = solve_bt_case(\n        N=20, L=1.0, d=0.03, lmbda=1.0,\n        b_func=lambda x: np.exp(-((x - 0.6) / 0.12)**2),\n        c_func=lambda x: np.exp(-((x - 0.6) / 0.12)**2)\n    )\n\n    result3_str = f\"[{','.join(map(str, result3))}]\"\n    print(f\"[{result1},{result2},{result3_str}]\")\n\nsolve()\n```"
        }
    ]
}