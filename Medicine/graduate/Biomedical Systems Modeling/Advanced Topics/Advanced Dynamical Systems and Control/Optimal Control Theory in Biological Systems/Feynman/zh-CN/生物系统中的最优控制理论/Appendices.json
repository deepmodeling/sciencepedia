{
    "hands_on_practices": [
        {
            "introduction": "这项练习将指导您将庞特里亚金极小值原理（Pontryagin's Minimum Principle, PMP）应用于一个经典的生物医学控制问题：利用胰岛素调节血糖。通过推导葡萄糖-胰岛素模型的哈密顿量和协态动力学，您将确定在考虑控制成本的同时，最小化血糖偏差的最优胰岛素输注策略。该练习为在生理学相关背景下应用最优控制理论的核心原则提供了一个基础性的动手实践。",
            "id": "3914940",
            "problem": "考虑外源性胰岛素输注期间的单个个体葡萄糖-胰岛素调节模型。葡萄糖状态、胰岛素作用和血浆胰岛素分别由 $G(t)$、$X(t)$ 和 $I(t)$ 表示。外源性碳水化合物扰动 $D(t)$ 是已知且非负的，控制输入 $u(t)$ 是外部输注的胰岛素。令 $G_{\\mathrm{b}}$ 表示基础葡萄糖水平，$G_{\\mathrm{ref}}$ 表示期望的葡萄糖设定点。其动力学由以下方程组指定\n$$\n\\begin{aligned}\n\\dot{G}(t) = -k_{g}\\big(G(t)-G_{\\mathrm{b}}\\big) - X(t)\\,G(t) + D(t), \\\\\n\\dot{X}(t) = -k_{x} X(t) + s\\, I(t), \\\\\n\\dot{I}(t) = -k_{i} I(t) + u(t),\n\\end{aligned}\n$$\n其中 $k_{g}>0$、$k_{x}>0$、$k_{i}>0$ 和 $s>0$ 是已知的生理参数。控制是有界的，即 $0 \\leq u(t) \\leq u_{\\max}$，时间范围为 $t\\in[0,T]$，其中 $T>0$。性能指标通过以下方式惩罚葡萄糖偏移和控制能量\n$$\nJ[u] \\;=\\; \\frac{1}{2} \\int_{0}^{T} \\left( q\\,\\big(G(t)-G_{\\mathrm{ref}}\\big)^{2} \\;+\\; r\\, u(t)^{2} \\right)\\, dt \\;+\\; \\frac{1}{2}\\, p\\,\\big(G(T)-G_{\\mathrm{ref}}\\big)^{2},\n$$\n其中 $q>0$、$r>0$ 和 $p\\ge 0$ 是权重系数，$G_{\\mathrm{ref}}$ 是一个常数。\n\n使用庞特里亚金极小值原理 (Pontryagin's Minimum Principle, PMP)，从第一性原理出发，推导哈密顿函数 $H(x,\\lambda,u,t)$ 和协态动力学 $\\dot{\\lambda}(t) = -\\partial H/\\partial x$，其中 $x(t) = \\big(G(t), X(t), I(t)\\big)^{\\top}$ 且协态为 $\\lambda(t) = \\big(\\lambda_{G}(t), \\lambda_{X}(t), \\lambda_{I}(t)\\big)^{\\top}$。然后，确定此输入仿射系统的平稳控制律 $u^{\\ast}(t)$，用切换函数表示，并明确考虑控制边界。\n\n请将您的最终结果按以下顺序表示在一个单行矩阵中：\n1) 哈密顿函数 $H$，\n2) 表示为三元组 $\\big(\\dot{\\lambda}_{G},\\dot{\\lambda}_{X},\\dot{\\lambda}_{I}\\big)$ 的协态动力学，\n3) 明确用切换函数表示的平稳控制 $u^{\\ast}(t)$。\n\n不需要进行数值计算。您的最终答案必须是单一的闭式解析表达式。如果使用任何缩写，请在首次出现时写出其全名。不要包含单位。",
            "solution": "用户提供了一个应用于生物系统的最优控制理论问题。任务是使用庞特里亚金极小值原理 (PMP) 推导哈密顿函数、协态动力学和最优控制律。\n\n### 步骤 1：提取已知条件\n\n状态向量为 $x(t) = \\big(G(t), X(t), I(t)\\big)^{\\top}$，分别代表葡萄糖浓度、胰岛素作用和血浆胰岛素。控制输入是外部胰岛素输注率 $u(t)$。\n\n状态动力学由以下常微分方程组给出：\n$$\n\\begin{aligned}\n\\dot{G}(t) = -k_{g}\\big(G(t)-G_{\\mathrm{b}}\\big) - X(t)\\,G(t) + D(t) \\\\\n\\dot{X}(t) = -k_{x} X(t) + s\\, I(t) \\\\\n\\dot{I}(t) = -k_{i} I(t) + u(t)\n\\end{aligned}\n$$\n参数 $k_{g}$、$k_{x}$、$k_{i}$ 和 $s$ 是正常数。$G_{\\mathrm{b}}$ 是基础葡萄糖水平，是一个常数。$D(t)$ 是一个已知的非负扰动函数。\n\n控制输入是有界的：$0 \\leq u(t) \\leq u_{\\max}$。\n\n需要最小化的性能指标（成本泛函）是：\n$$\nJ[u] \\;=\\; \\frac{1}{2} \\int_{0}^{T} \\left( q\\,\\big(G(t)-G_{\\mathrm{ref}}\\big)^{2} \\;+\\; r\\, u(t)^{2} \\right)\\, dt \\;+\\; \\frac{1}{2}\\, p\\,\\big(G(T)-G_{\\mathrm{ref}}\\big)^{2}\n$$\n权重系数 $q$、$r$ 是正数，$p$ 是非负数。$G_{\\mathrm{ref}}$ 是恒定的期望葡萄糖设定点。时间范围为 $t \\in [0, T]$，其中 $T>0$。\n\n协态向量表示为 $\\lambda(t) = \\big(\\lambda_{G}(t), \\lambda_{X}(t), \\lambda_{I}(t)\\big)^{\\top}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学依据：**该问题使用了伯格曼最小模型 (Bergman minimal model) 的简化版本，这是一个广泛接受的葡萄糖-胰岛素动力学数学模型。目标函数是最优控制中用于惩罚偏离设定点和控制努力的标准二次型。该设置在科学上和数学上都是合理的。\n2.  **适定性：**该问题提供了应用庞特里亚金极小值原理 (PMP)所需的所有必要组件。动力学已定义，成本泛函已指定，控制约束已给出。对于此类问题，预期存在解。\n3.  **客观性：**该问题使用精确的数学语言陈述，没有歧义或主观因素。\n4.  **完整性和一致性：**所有参数和函数都已定义。对于推导哈密顿函数、协态方程和控制律的任务，没有缺失数据或矛盾的约束。\n5.  **无其他缺陷：**在数学建模的背景下，该问题并非微不足道、不适定或不切实际。\n\n### 步骤 3：结论与行动\n\n问题陈述有效。我将继续进行推导。\n\n### 使用庞特里亚金极小值原理 (PMP) 进行推导\n\nPMP为最优控制提供了必要条件。它涉及定义一个哈密顿函数并分析其性质。\n\n**1. 哈密顿函数**\n\n哈密顿函数 $H(x, \\lambda, u, t)$ 定义为 $H = L + \\lambda^{\\top}f$，其中 $L(x, u, t)$ 是成本泛函的被积函数，$f(x, u, t)$ 是状态动力学的向量场。\n\n被积函数 $L$ 是：\n$$\nL(G, X, I, u) = \\frac{1}{2} q \\left(G - G_{\\mathrm{ref}}\\right)^{2} + \\frac{1}{2} r u^{2}\n$$\n状态动力学向量 $f$ 是：\n$$\nf(G, X, I, u, t) = \\begin{pmatrix} -k_{g}\\big(G-G_{\\mathrm{b}}\\big) - XG + D(t) \\\\ -k_{x} X + sI \\\\ -k_{i} I + u \\end{pmatrix}\n$$\n因此，哈密顿函数是：\n$$\nH = L + \\lambda_{G} \\dot{G} + \\lambda_{X} \\dot{X} + \\lambda_{I} \\dot{I}\n$$\n代入 $L$ 和状态导数的表达式，得到哈密顿函数，为清晰起见，省略了变量的时间依赖性：\n$$\nH = \\frac{1}{2} q \\left(G - G_{\\mathrm{ref}}\\right)^{2} + \\frac{1}{2} r u^{2} + \\lambda_{G} \\left(-k_{g}(G - G_{\\mathrm{b}}) - XG + D(t)\\right) + \\lambda_{X} \\left(-k_{x} X + sI\\right) + \\lambda_{I} \\left(-k_{i} I + u\\right)\n$$\n\n**2. 协态动力学**\n\n协态（或伴随）方程由 $\\dot{\\lambda}(t) = -\\frac{\\partial H}{\\partial x}$ 给出。我们计算哈密顿函数对每个状态变量的偏导数。\n\n对于 $\\lambda_{G}$：\n$$\n\\frac{\\partial H}{\\partial G} = q\\left(G - G_{\\mathrm{ref}}\\right) + \\lambda_{G}\\left(-k_{g} - X\\right)\n$$\n$$\n\\dot{\\lambda}_{G} = -\\frac{\\partial H}{\\partial G} = -q\\left(G - G_{\\mathrm{ref}}\\right) + \\lambda_{G}\\left(k_{g} + X\\right)\n$$\n对于 $\\lambda_{X}$：\n$$\n\\frac{\\partial H}{\\partial X} = \\lambda_{G}(-G) + \\lambda_{X}(-k_{x}) = -G\\lambda_{G} - k_{x}\\lambda_{X}\n$$\n$$\n\\dot{\\lambda}_{X} = -\\frac{\\partial H}{\\partial X} = G\\lambda_{G} + k_{x}\\lambda_{X}\n$$\n对于 $\\lambda_{I}$：\n$$\n\\frac{\\partial H}{\\partial I} = \\lambda_{X}(s) + \\lambda_{I}(-k_{i}) = s\\lambda_{X} - k_{i}\\lambda_{I}\n$$\n$$\n\\dot{\\lambda}_{I} = -\\frac{\\partial H}{\\partial I} = -s\\lambda_{X} + k_{i}\\lambda_{I}\n$$\n因此，协态动力学是以下三元组：\n$$\n\\left(\\dot{\\lambda}_{G}, \\dot{\\lambda}_{X}, \\dot{\\lambda}_{I}\\right) = \\left(-q(G - G_{\\mathrm{ref}}) + \\lambda_{G}(k_{g} + X), \\quad G\\lambda_{G} + k_{x}\\lambda_{X}, \\quad -s\\lambda_{X} + k_{i}\\lambda_{I}\\right)\n$$\n\n**3. 平稳控制律**\n\n根据PMP，最优控制 $u^{\\ast}(t)$ 必须在每个时间 $t$ 在容许控制集 $\\mathcal{U} = [0, u_{\\max}]$ 上使哈密顿函数 $H$ 最小化。\n哈密顿函数是 $u$ 的函数：\n$$\nH(u) = \\frac{1}{2} r u^{2} + \\lambda_{I} u + (\\text{不含 u 的项})\n$$\n由于 $r > 0$，$H(u)$ 是关于 $u$ 的凸抛物线。为了找到其最小值，我们计算关于 $u$ 的导数：\n$$\n\\frac{\\partial H}{\\partial u} = ru + \\lambda_{I}\n$$\n将导数设为零，得到无约束最小值位于 $u = -\\frac{\\lambda_{I}}{r}$。\n\n为了考虑边界 $0 \\leq u \\leq u_{\\max}$，我们将此无约束解投影到容许区间 $[0, u_{\\max}]$ 上。这产生了一个饱和控制律。分析如下：\n- 如果 $-\\frac{\\lambda_{I}}{r}  0$，这等价于 $\\lambda_{I} > 0$，则增函数 $H(u)$ 在 $[0, u_{\\max}]$ 上的最小值出现在下界处，即 $u^{\\ast} = 0$。\n- 如果 $-\\frac{\\lambda_{I}}{r} > u_{\\max}$，这等价于 $\\lambda_{I}  -r u_{\\max}$，则减函数 $H(u)$ 在 $[0, u_{\\max}]$ 上的最小值出现在上界处，即 $u^{\\ast} = u_{\\max}$。\n- 如果 $0 \\leq -\\frac{\\lambda_{I}}{r} \\leq u_{\\max}$，这等价于 $-r u_{\\max} \\leq \\lambda_{I} \\leq 0$，则无约束最小值位于容许区间内，因此 $u^{\\ast} = -\\frac{\\lambda_{I}}{r}$。\n\n问题提到了“切换函数”。在此背景下，协态 $\\lambda_{I}(t)$ 充当切换函数，因为它的值决定了哪个控制区域（下界、上界或内部）是激活的。最优控制律 $u^{\\ast}(t)$ 被明确表示为这个切换函数 $\\lambda_{I}(t)$ 的分段函数：\n$$\nu^{\\ast}(t) = \\begin{cases} u_{\\max}  \\text{if } \\lambda_I(t)  -r u_{\\max} \\\\ -\\frac{\\lambda_I(t)}{r}  \\text{if } -r u_{\\max} \\le \\lambda_I(t) \\le 0 \\\\ 0  \\text{if } \\lambda_I(t) > 0 \\end{cases}\n$$\n这样就完成了所需的推导。结果将被组装成指定的矩阵格式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} q (G - G_{\\mathrm{ref}})^{2} + \\frac{1}{2} r u^{2} + \\lambda_{G} (-k_{g}(G - G_{\\mathrm{b}}) - XG + D(t)) + \\lambda_{X} (-k_{x} X + sI) + \\lambda_{I} (-k_{i} I + u)  \\begin{pmatrix} -q(G - G_{\\mathrm{ref}}) + \\lambda_{G}(k_{g} + X) \\\\ G\\lambda_{G} + k_{x}\\lambda_{X} \\\\ -s\\lambda_{X} + k_{i}\\lambda_{I} \\end{pmatrix}  \\begin{cases} u_{\\max}  \\text{if } \\lambda_I  -r u_{\\max} \\\\ -\\frac{\\lambda_I}{r}  \\text{if } -r u_{\\max} \\le \\lambda_I \\le 0 \\\\ 0  \\text{if } \\lambda_I > 0 \\end{cases} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "有效的建模通常始于简化系统以揭示其核心动态。本问题聚焦于无量纲化这一强大技术，并将其应用于有害生物标志物的治疗模型。您将学习如何缩放系统的方程和成本泛函，以揭示一个单一的无量纲参数，该参数支配着治疗效果和毒性之间的关键权衡，从而提供超越从有量纲形式中直接观察到的更深刻见解。",
            "id": "3914953",
            "problem": "考虑一个接受治疗的患者体内循环有害生物标志物的第一性原理质量平衡模型。令 $X(t)$ 表示在时间 $t$ 时的生物标志物负荷，以一致的浓度单位计量。在连续输注控制 $u(t)$（以一致的输注速率单位计量）下，$X(t)$ 的时间演化由以下常微分方程 (ODE) 建模：\n$$\n\\frac{dX}{dt} \\;=\\; s \\;-\\; k\\,X \\;-\\; \\beta\\,u(t),\n$$\n其中 $s0$ 是生物标志物的内源性生成速率，$k0$ 是生物标志物的一级清除速率常数，$\\beta0$ 是将输注与清除关联起来的药效学效能系数。治疗会产生毒性成本，该成本随输注速率的平方而增长，而生理损害则通过对生物标志物负荷的二次惩罚来建模。无穷时域目标是\n$$\nJ[u] \\;=\\; \\int_{0}^{\\infty} \\Big( w_{E}\\,X(t)^{2} \\;+\\; w_{T}\\,u(t)^{2} \\Big)\\,dt,\n$$\n其中 $w_{E}0$ 和 $w_{T}0$ 分别表示效能和毒性权重。定义初始条件为 $X(0)=X_{\\mathrm{ref}}$，其中 $X_{\\mathrm{ref}}$ 是满足 $s-k\\,X_{\\mathrm{ref}}=0$ 的无控制稳态。\n\n您的任务是：\n- 从质量平衡定律出发，并基于系统的特征时间和稳态量级进行标准标度选择，通过引入无量纲时间 $\\tau=t/T_{\\mathrm{ref}}$、无量纲状态 $x(\\tau)=X(t)/X_{\\mathrm{ref}}$ 和无量纲控制 $v(\\tau)=u(t)/U_{\\mathrm{ref}}$，对常微分方程和成本泛函进行无量纲化。选择 $T_{\\mathrm{ref}}$、$X_{\\mathrm{ref}}$ 和 $U_{\\mathrm{ref}}$，使得无量纲动力学呈现最简正则形式，并且所有物理参数都被吸收到无量纲权重中。\n- 推导出由此产生的无量纲动力学和无量纲成本泛函，并确定体现效能与毒性相对权重的无量纲比率。\n- 使用第一性原理（庞特里亚金极小值原理 (PMP) 或由严格凸性和线性稳定性保证的稳态最优性），确定在无量纲稳态约束下使无穷时域成本最小化的恒定无量纲控制 $v^{*}$。然后将 $v^{*}$ 映射回有量纲单位，以获得相应的恒定最优输注 $u^{*}$，该表达式仅用有量纲参数 $s$、$k$、$\\beta$、$w_{E}$ 和 $w_{T}$ 表示。\n\n给出最优恒定输注速率 $u^{*}$ 关于 $s$、$k$、$\\beta$、$w_{E}$ 和 $w_{T}$ 的最终表达式。不要进行数值计算。",
            "solution": "首先根据科学合理性、适定性和客观性的标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n给定信息如下：\n-   **状态动力学**：生物标志物负荷 $X(t)$ 由以下常微分方程 (ODE) 控制：\n    $$\n    \\frac{dX}{dt} = s - k X - \\beta u(t)\n    $$\n-   **参数**：\n    -   $s  0$：内源性生成速率。\n    -   $k  0$：一级清除速率常数。\n    -   $\\beta  0$：药效学效能系数。\n-   **控制**：$u(t)$ 是连续输注控制。\n-   **成本泛函**：目标是最小化无穷时域成本 $J[u]$：\n    $$\n    J[u] = \\int_{0}^{\\infty} \\left( w_{E} X(t)^{2} + w_{T} u(t)^{2} \\right) dt\n    $$\n-   **权重**：\n    -   $w_{E}  0$：效能权重（对生物标志物负荷的惩罚）。\n    -   $w_{T}  0$：毒性权重（对控制努力的惩罚）。\n-   **初始条件**：$X(0) = X_{\\mathrm{ref}}$。\n-   **参考状态**：$X_{\\mathrm{ref}}$ 是无控制稳态，由条件 $s - k X_{\\mathrm{ref}} = 0$ 定义。\n-   **无量纲化**：引入无量纲变量：\n    -   时间：$\\tau = t/T_{\\mathrm{ref}}$\n    -   状态：$x(\\tau) = X(t)/X_{\\mathrm{ref}}$\n    -   控制：$v(\\tau) = u(t)/U_{\\mathrm{ref}}$\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学基础**：该模型是一个标准的一阶线性常微分方程，代表质量平衡，是药代动力学和药效动力学 (PK/PD) 建模的基石。各项分别代表生成、自然清除和药物诱导的清除。成本泛函是一种标准的二次型，在最优控制中很常见，尤其是在线性二次调节器 (LQR) 理论中，代表了临床疗效与治疗相关毒性之间的权衡。该模型在科学上是有效的，并且基础牢固。\n-   **适定性**：该问题是一个适定的无穷时域 LQR 问题。由于 $k0$，系统矩阵是内在稳定的；由于 $w_E0$ 和 $w_T0$，成本泛函在状态 $X$ 和控制 $u$ 上都是严格凸的。这些条件保证了唯一、稳定且有意义的最优控制解的存在。\n-   **客观性**：问题以精确的数学语言陈述，没有歧义、主观性或意见。\n-   **完整性和一致性**：所有必需的参数（$s, k, \\beta, w_E, w_T$）、初始条件和定义都已提供并且相互一致。$X_{\\mathrm{ref}}$ 的定义是明确的。\n-   **现实性**：该模型是对治疗场景的简化但现实的表示，用作系统药理学中的基础模型。所有参数都具有清晰的物理或生物学解释。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学基础、适定、客观、完整且一致。可以继续求解过程。\n\n### 无量纲化\n第一个任务是使用指定的无量纲变量对系统进行无量纲化。我们必须选择参考标度 $T_{\\mathrm{ref}}$、$X_{\\mathrm{ref}}$ 和 $U_{\\mathrm{ref}}$。\n\n1.  **参考状态 $X_{\\mathrm{ref}}$**：问题将 $X_{\\mathrm{ref}}$ 定义为无控制（$u(t)=0$）稳态。在状态方程中设 $dX/dt=0$ 和 $u=0$，得到 $0 = s - k X_{\\mathrm{ref}}$，从而得出：\n    $$\n    X_{\\mathrm{ref}} = \\frac{s}{k}\n    $$\n2.  **参考时间 $T_{\\mathrm{ref}}$**：系统的特征时间由衰减项 $-kX$ 决定。这个一阶过程的时间常数是 $1/k$。我们选择它作为参考时间：\n    $$\n    T_{\\mathrm{ref}} = \\frac{1}{k}\n    $$\n3.  **变换常微分方程**：我们将导数 $dX/dt$ 用无量纲变量 $x$ 和 $\\tau$ 表示：\n    $$\n    \\frac{dX}{dt} = \\frac{d(X_{\\mathrm{ref}}x)}{d(T_{\\mathrm{ref}}\\tau)} = \\frac{X_{\\mathrm{ref}}}{T_{\\mathrm{ref}}} \\frac{dx}{d\\tau}\n    $$\n    将此式及变量关系代入常微分方程：\n    $$\n    \\frac{X_{\\mathrm{ref}}}{T_{\\mathrm{ref}}} \\frac{dx}{d\\tau} = s - k (X_{\\mathrm{ref}} x) - \\beta (U_{\\mathrm{ref}} v)\n    $$\n    现在，我们代入 $X_{\\mathrm{ref}}$ 和 $T_{\\mathrm{ref}}$ 的表达式：\n    $$\n    \\frac{s/k}{1/k} \\frac{dx}{d\\tau} = s - k \\left(\\frac{s}{k}\\right) x - \\beta U_{\\mathrm{ref}} v\n    $$\n    $$\n    s \\frac{dx}{d\\tau} = s - s x - \\beta U_{\\mathrm{ref}} v\n    $$\n    两边同除以 $s$（因为 $s0$）：\n    $$\n    \\frac{dx}{d\\tau} = 1 - x - \\frac{\\beta U_{\\mathrm{ref}}}{s} v\n    $$\n4.  **参考控制 $U_{\\mathrm{ref}}$**：为获得最简正则形式，我们选择 $U_{\\mathrm{ref}}$，使得无量纲控制 $v$ 的系数为1。\n    $$\n    \\frac{\\beta U_{\\mathrm{ref}}}{s} = 1 \\implies U_{\\mathrm{ref}} = \\frac{s}{\\beta}\n    $$\n    这一选择赋予了 $U_{\\mathrm{ref}}$ 清晰的物理意义：它恰好是能平衡内源性生成速率 $s$ 的输注速率。通过这种选择，无量纲常微分方程变为：\n    $$\n    \\frac{dx}{d\\tau} = 1 - x(\\tau) - v(\\tau)\n    $$\n    初始条件 $X(0) = X_{\\mathrm{ref}}$ 变为 $x(0) = X(0)/X_{\\mathrm{ref}} = X_{\\mathrm{ref}}/X_{\\mathrm{ref}} = 1$。\n\n5.  **变换成本泛函**：我们将无量纲变量代入成本泛函 $J[u]$：\n    $$\n    J = \\int_{0}^{\\infty} \\left( w_{E} (X_{\\mathrm{ref}} x)^{2} + w_{T} (U_{\\mathrm{ref}} v)^{2} \\right) (T_{\\mathrm{ref}} d\\tau)\n    $$\n    $$\n    J = T_{\\mathrm{ref}} \\int_{0}^{\\infty} \\left( w_{E} X_{\\mathrm{ref}}^{2} x^{2} + w_{T} U_{\\mathrm{ref}}^{2} v^{2} \\right) d\\tau\n    $$\n    我们提出 $x^2$ 的权重项作为公因子，来定义一个无量纲成本泛函 $j[v]$：\n    $$\n    J = (w_{E} X_{\\mathrm{ref}}^{2} T_{\\mathrm{ref}}) \\int_{0}^{\\infty} \\left( x^{2} + \\frac{w_{T} U_{\\mathrm{ref}}^{2}}{w_{E} X_{\\mathrm{ref}}^{2}} v^{2} \\right) d\\tau\n    $$\n    无量纲成本泛函为 $j[v] = J / (w_{E} X_{\\mathrm{ref}}^{2} T_{\\mathrm{ref}})$，由下式给出：\n    $$\n    j[v] = \\int_{0}^{\\infty} \\left( x(\\tau)^{2} + W v(\\tau)^{2} \\right) d\\tau\n    $$\n    其中无量纲权重比 $W$ 是：\n    $$\n    W = \\frac{w_{T} U_{\\mathrm{ref}}^{2}}{w_{E} X_{\\mathrm{ref}}^{2}}\n    $$\n    代入 $U_{\\mathrm{ref}}$ 和 $X_{\\mathrm{ref}}$ 的表达式：\n    $$\n    W = \\frac{w_{T} (s/\\beta)^{2}}{w_{E} (s/k)^{2}} = \\frac{w_{T} s^{2}/\\beta^{2}}{w_{E} s^{2}/k^{2}} = \\frac{w_{T} k^{2}}{w_{E} \\beta^{2}}\n    $$\n    这个无量纲参数 $W$ 概括了控制毒性（$w_T$）与生物标志物相关损害（$w_E$）的相对权重，并由系统的动力学特性（$k, \\beta$）进行缩放。\n\n### 最优稳态控制\n问题要求的是恒定最优控制 $u^{*}$，这对应于寻找最优稳态工作点。这意味着我们要寻找一个恒定的无量纲控制 $v^{*}$ 和一个相应的恒定无量纲状态 $x^{*}$，以最小化成本被积函数。\n\n在稳态下，$dx/d\\tau = 0$。从无量纲常微分方程，我们得到约束条件：\n$$\n0 = 1 - x^{*} - v^{*} \\implies x^{*} = 1 - v^{*}\n$$\n我们需要最小化无量纲成本泛函的被积函数，我们将其表示为稳态成本速率 $C_{ss}$：\n$$\nC_{ss}(v^{*}) = (x^{*})^{2} + W (v^{*})^{2}\n$$\n将稳态约束代入成本速率：\n$$\nC_{ss}(v^{*}) = (1 - v^{*})^{2} + W (v^{*})^{2} = 1 - 2v^{*} + (v^{*})^{2} + W (v^{*})^{2}\n$$\n为求最小值，我们将 $C_{ss}$ 对 $v^{*}$ 求导，并令其结果为零：\n$$\n\\frac{dC_{ss}}{dv^{*}} = -2 + 2v^{*} + 2W v^{*} = 0\n$$\n$$\n2v^{*}(1 + W) = 2\n$$\n$$\nv^{*} = \\frac{1}{1+W}\n$$\n二阶导数是 $d^{2}C_{ss}/(dv^{*})^{2} = 2 + 2W$。由于 $w_E, w_T, k, \\beta$ 均为正数，所以 $W  0$，因此二阶导数为正，这确认了 $v^{*}$ 是一个唯一的最小值。\n\n### 有量纲最优控制\n最后，我们使用关系式 $u^{*} = U_{\\mathrm{ref}} v^{*}$ 将最优无量纲控制 $v^{*}$ 映射回有量纲控制 $u^{*}$：\n$$\nu^{*} = U_{\\mathrm{ref}} \\left( \\frac{1}{1+W} \\right)\n$$\n代入 $U_{\\mathrm{ref}}$ 和 $W$ 的表达式：\n$$\nu^{*} = \\left( \\frac{s}{\\beta} \\right) \\left( \\frac{1}{1 + \\frac{w_{T} k^{2}}{w_{E} \\beta^{2}}} \\right)\n$$\n为简化起见，我们对括号中的项通分：\n$$\nu^{*} = \\left( \\frac{s}{\\beta} \\right) \\left( \\frac{1}{\\frac{w_{E} \\beta^{2} + w_{T} k^{2}}{w_{E} \\beta^{2}}} \\right) = \\left( \\frac{s}{\\beta} \\right) \\left( \\frac{w_{E} \\beta^{2}}{w_{E} \\beta^{2} + w_{T} k^{2}} \\right)\n$$\n消去一个因子 $\\beta$：\n$$\nu^{*} = \\frac{s w_{E} \\beta}{w_{E} \\beta^{2} + w_{T} k^{2}}\n$$\n这就是用原始有量纲参数表示的最优恒定输注速率的最终表达式。",
            "answer": "$$\\boxed{\\frac{s w_{E} \\beta}{w_{E} \\beta^{2} + w_{T} k^{2}}}$$"
        },
        {
            "introduction": "并非所有最优控制问题都会产生简单的“开关式”或饱和解。这项高级练习探讨了奇异控制这一有趣的现象，它发生在控制输入在哈密顿量中呈线性关系时。通过分析一个线性化的基因表达模型，您将确定奇异弧可能出现的条件，并推导出相应的奇异控制律，该控制律通常表现为一种状态反馈策略。",
            "id": "3914914",
            "problem": "考虑一个关于非零基础工作点的、用于光遗传学调控下单个蛋白质的线性化两阶段基因表达模型。令状态向量为 $x(t) = \\begin{pmatrix} m(t) \\\\ p(t) \\end{pmatrix}$，其中 $m(t)$ 是信使核糖核酸 (mRNA) 浓度与基线的偏差，$p(t)$ 是蛋白质浓度与基线的偏差。标量控制 $u(t)$ 表示转录起始速率与基线的偏差，由于小信号线性化，其可取正值或负值。动力学方程为\n$$\n\\dot{m}(t) = k_{m}\\,u(t) - \\delta_{m}\\,m(t), \\qquad\n\\dot{p}(t) = k_{p}\\,m(t) - \\delta_{p}\\,p(t),\n$$\n其中参数 $k_{m}$、$k_{p}$、$\\delta_{m}$ 和 $\\delta_{p}$ 均为严格正值。考虑在 $[0,T]$ 上的有限时域最优控制问题，其代价泛函为\n$$\nJ[u] = \\int_{0}^{T} \\left( \\tfrac{1}{2}\\,q_{m}\\,m(t)^{2} + \\tfrac{1}{2}\\,q_{p}\\,p(t)^{2} + \\rho\\,u(t) \\right)\\,dt,\n$$\n其中 $q_{m}0$、$q_{p}0$ 且 $\\rho0$。为进行奇异弧分析，问题不设终端代价，也没有明确的控制界限。\n\n使用用于最小化的庞特里亚金极小值原理 (PMP)，分析最优性的必要条件，并确定是否可能出现奇异弧。如果可能，确定奇异阶数（使得开关函数的 $r$ 阶时间导数显式地依赖于 $u$ 的最小整数 $r \\geq 0$），并计算相应的奇异控制律 $u_{\\mathrm{sing}}(t)$，其表达式应仅包含 $m(t)$、$p(t)$ 和模型参数。假设协态是绝对连续的，并且所有函数对于所需的微分都足够光滑。\n\n你的最终答案必须是一个包含两个元素的行矩阵：第一个元素是奇异性的整数阶数，第二个元素是奇异控制的闭式表达式。不需要进行数值计算；请以符号形式表示最终结果。如果你选择定义任何中间符号，请在最终表达式中将它们消去，以使奇异控制直接用 $m(t)$、$p(t)$ 和给定参数表示。",
            "solution": "所述问题是有效的。这是一个基于系统生物学和控制理论标准原理的适定最优控制问题。系统动力学代表了一个线性化的两阶段基因表达模型，这是一种常见且科学上合理的构造。目标泛函定义清晰，所有参数都带有必要的条件（例如，正性）。该任务要求应用庞特里亚金极小值原理 (PMP) 来分析奇异弧，这是最优控制理论中的一个标准程序。该问题是自洽的、数学上一致的，并且没有任何科学或逻辑上的缺陷。\n\n我们应用用于最小化的庞特里亚金极小值原理。状态向量为 $x(t) = \\begin{pmatrix} m(t) \\\\ p(t) \\end{pmatrix}$，协态向量为 $\\lambda(t) = \\begin{pmatrix} \\lambda_m(t) \\\\ \\lambda_p(t) \\end{pmatrix}$。该系统的哈密顿量 $H$ 定义为：\n$$\nH(x, u, \\lambda) = L(x, u) + \\lambda^{T}f(x, u)\n$$\n其中 $L(x, u) = \\tfrac{1}{2}\\,q_{m}\\,m(t)^{2} + \\tfrac{1}{2}\\,q_{p}\\,p(t)^{2} + \\rho\\,u(t)$ 是代价泛函的被积函数，$f(x, u)$ 是描述系统动力学的向量场。\n代入给定表达式，哈密顿量为：\n$$\nH = \\left( \\tfrac{1}{2}\\,q_{m}\\,m^{2} + \\tfrac{1}{2}\\,q_{p}\\,p^{2} + \\rho\\,u \\right) + \\lambda_{m}(k_{m}\\,u - \\delta_{m}\\,m) + \\lambda_{p}(k_{p}\\,m - \\delta_{p}\\,p)\n$$\n我们可以根据控制输入 $u(t)$ 对各项进行重组：\n$$\nH = (k_{m}\\lambda_{m} + \\rho)u + \\tfrac{1}{2}\\,q_{m}\\,m^{2} + \\tfrac{1}{2}\\,q_{p}\\,p^{2} - \\delta_{m}\\lambda_{m}m + k_{p}\\lambda_{p}m - \\delta_{p}\\lambda_{p}p\n$$\nPMP 指出，最优控制 $u^{*}(t)$ 必须在每个时刻 $t \\in [0,T]$ 最小化哈密顿量 $H$。由于哈密顿量是关于控制 $u$ 的线性函数，因此最小化控制取决于其系数的符号，该系数被称为开关函数 $\\Phi(t)$。\n$$\n\\Phi(t) = \\frac{\\partial H}{\\partial u} = k_{m}\\lambda_{m}(t) + \\rho\n$$\n由于对 $u$ 没有明确的界限，非奇异最优控制将是具有无限幅度的“bang-bang”控制，这在物理上是不现实的，并表明最优轨迹可能位于奇异弧上。如果开关函数在一个有限时间区间内为零，即对于 $t \\in [t_1, t_2] \\subseteq [0,T]$ 有 $\\Phi(t) = 0$，则可能出现奇异弧。为使此条件成立，$\\Phi(t)$ 的所有时间导数在该区间内也必须为零。\n\n奇异阶数 $r$ 是使得 $\\Phi(t)$ 的 $r$ 阶全时间导数（记为 $\\Phi^{(r)}(t)$）显式依赖于控制 $u(t)$ 的最小整数。我们计算这些导数。\n\n奇异弧存在的第一个条件是：\n$$\n\\Phi(t) = k_{m}\\lambda_{m}(t) + \\rho = 0\n$$\n这意味着在奇异弧上，协态 $\\lambda_m(t)$ 必须是常数：\n$$\n\\lambda_{m}(t) = -\\frac{\\rho}{k_{m}}\n$$\n这是零阶条件 ($r=0$)。它不包含 $u$。我们继续计算一阶导数 $\\dot{\\Phi}(t)$。\n$$\n\\dot{\\Phi}(t) = k_{m}\\dot{\\lambda}_{m}(t)\n$$\n协态动力学由 $\\dot{\\lambda} = -\\frac{\\partial H}{\\partial x}$ 给出。\n$$\n\\dot{\\lambda}_{m} = -\\frac{\\partial H}{\\partial m} = -\\left( q_{m}m - \\delta_{m}\\lambda_{m} + k_{p}\\lambda_{p} \\right) = -q_{m}m + \\delta_{m}\\lambda_{m} - k_{p}\\lambda_{p}\n$$\n$$\n\\dot{\\lambda}_{p} = -\\frac{\\partial H}{\\partial p} = -\\left( q_{p}p - \\delta_{p}\\lambda_{p} \\right) = -q_{p}p + \\delta_{p}\\lambda_{p}\n$$\n因此，开关函数的一阶导数为：\n$$\n\\dot{\\Phi}(t) = k_{m}(-q_{m}m + \\delta_{m}\\lambda_{m} - k_{p}\\lambda_{p})\n$$\n$\\dot{\\Phi}(t)$ 的这个表达式不显式依赖于 $u(t)$。对于奇异弧，我们要求 $\\dot{\\Phi}(t) = 0$。\n$$\n-q_{m}m(t) + \\delta_{m}\\lambda_{m}(t) - k_{p}\\lambda_{p}(t) = 0\n$$\n从 $\\Phi(t)=0$ 条件中代入 $\\lambda_m(t)$ 的常数值：\n$$\n-q_{m}m(t) + \\delta_{m}\\left(-\\frac{\\rho}{k_{m}}\\right) - k_{p}\\lambda_{p}(t) = 0\n$$\n这使我们能够用状态 $m(t)$ 来表示奇异弧上的协态 $\\lambda_p(t)$：\n$$\n\\lambda_{p}(t) = -\\frac{q_{m}}{k_{p}}m(t) - \\frac{\\rho\\delta_{m}}{k_{m}k_{p}}\n$$\n现在，我们计算二阶时间导数 $\\ddot{\\Phi}(t)$。\n$$\n\\ddot{\\Phi}(t) = \\frac{d}{dt}\\left( \\dot{\\Phi}(t) \\right) = k_{m}(-q_{m}\\dot{m} + \\delta_{m}\\dot{\\lambda}_{m} - k_{p}\\dot{\\lambda}_{p})\n$$\n在奇异弧上，$\\lambda_m(t)$ 是常数，所以 $\\dot{\\lambda}_m(t)=0$。表达式简化为：\n$$\n\\ddot{\\Phi}(t) = k_{m}(-q_{m}\\dot{m} - k_{p}\\dot{\\lambda}_{p})\n$$\n我们代入状态和协态动力学的表达式：\n$\\dot{m}(t) = k_{m}u(t) - \\delta_{m}m(t)$\n$\\dot{\\lambda}_{p}(t) = -q_{p}p(t) + \\delta_{p}\\lambda_{p}(t)$\n将这些代入 $\\ddot{\\Phi}(t)$：\n$$\n\\ddot{\\Phi}(t) = k_{m}\\left( -q_{m}(k_{m}u - \\delta_{m}m) - k_{p}(-q_{p}p + \\delta_{p}\\lambda_{p}) \\right)\n$$\n$$\n\\ddot{\\Phi}(t) = k_{m}\\left( -q_{m}k_{m}u + q_{m}\\delta_{m}m + k_{p}q_{p}p-k_{p}\\delta_{p}\\lambda_{p} \\right)\n$$\n控制 $u(t)$ 首次显式出现在开关函数的二阶导数中。因此，奇异阶数为 $r=2$。\n\n为了找到奇异控制 $u_{\\mathrm{sing}}(t)$，我们令 $\\ddot{\\Phi}(t)=0$ 并求解 $u$：\n$$\n-q_{m}k_{m}u_{\\mathrm{sing}} + q_{m}\\delta_{m}m + k_{p}q_{p}p - k_{p}\\delta_{p}\\lambda_{p} = 0\n$$\n$$\nu_{\\mathrm{sing}}(t) = \\frac{1}{q_{m}k_{m}}\\left( q_{m}\\delta_{m}m(t) + k_{p}q_{p}p(t) - k_{p}\\delta_{p}\\lambda_{p}(t) \\right)\n$$\n这个表达式目前依赖于协态 $\\lambda_p(t)$。我们使用从 $\\dot{\\Phi}(t)=0$ 条件导出的关系来消去它：\n$$\n\\lambda_{p}(t) = -\\frac{q_{m}}{k_{p}}m(t) - \\frac{\\rho\\delta_{m}}{k_{m}k_{p}}\n$$\n将此代入 $u_{\\mathrm{sing}}(t)$ 的表达式中：\n$$\nu_{\\mathrm{sing}}(t) = \\frac{1}{q_{m}k_{m}}\\left[ q_{m}\\delta_{m}m(t) + k_{p}q_{p}p(t) - k_{p}\\delta_{p}\\left(-\\frac{q_{m}}{k_{p}}m(t) - \\frac{\\rho\\delta_{m}}{k_{m}k_{p}}\\right) \\right]\n$$\n$$\nu_{\\mathrm{sing}}(t) = \\frac{1}{q_{m}k_{m}}\\left[ q_{m}\\delta_{m}m(t) + k_{p}q_{p}p(t) + q_{m}\\delta_{p}m(t) + \\frac{\\rho\\delta_{m}\\delta_{p}}{k_{m}} \\right]\n$$\n对含有 $m(t)$ 的项进行分组和简化：\n$$\nu_{\\mathrm{sing}}(t) = \\frac{1}{q_{m}k_{m}}\\left[ q_{m}(\\delta_{m}+\\delta_{p})m(t) + q_{p}k_{p}p(t) + \\frac{\\rho\\delta_{m}\\delta_{p}}{k_{m}} \\right]\n$$\n最后，分配外面的项，得到作为状态和系统参数函数的奇异控制：\n$$\nu_{\\mathrm{sing}}(t) = \\frac{\\delta_{m} + \\delta_{p}}{k_{m}} m(t) + \\frac{q_{p}k_{p}}{q_{m}k_{m}} p(t) + \\frac{\\rho\\delta_{m}\\delta_{p}}{q_{m}k_{m}^{2}}\n$$\n这代表了一个带有仿射偏移的线性状态反馈控制律。\n\n答案的两个部分是奇异阶数 $r=2$ 和推导出的 $u_{\\mathrm{sing}}(t)$ 的表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2  \\frac{\\delta_{m}+\\delta_{p}}{k_{m}}m(t) + \\frac{q_{p}k_{p}}{q_{m}k_{m}}p(t) + \\frac{\\rho\\delta_{m}\\delta_{p}}{q_{m}k_{m}^{2}} \\end{pmatrix}}\n$$"
        }
    ]
}