{
    "hands_on_practices": [
        {
            "introduction": "掌握了可控性的理论定义后，第一个实践步骤是将其应用于具体的生物医学模型。本练习将引导你通过一个简化的双基因信号模块的线性化模型，来应用可控性的基本判据——卡尔曼秩条件。这个过程不仅是检验一个系统是否可以被外部输入完全调控的试金石，也代表了在系统生物学中分析基因调控网络和药物干预效果的基础方法。",
            "id": "4364519",
            "problem": "一个细胞通路中的双基因信号模块在一个稳态平衡点附近被线性化，以研究由代表药物输注的外部控制输入引起的小信号调节。线性化的状态空间模型是一个单输入线性时不变（LTI）系统，由 $\\dot{x}(t)=A x(t)+B u(t)$ 给出，其中 $x(t)\\in\\mathbb{R}^{2}$ 是基因活动偏离稳态的量，$u(t)\\in\\mathbb{R}$ 是控制输入。矩阵为\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n仅使用线性时不变系统能控性的基本定义，计算与 $\\left(A,B\\right)$ 相关的能控性矩阵的秩，并判断线性化的基因模块在平衡点附近是否在小信号意义下是能控的。将能控性矩阵的秩 $\\operatorname{rank}(\\mathcal{C})$ 作为最终答案报告，该答案应为一个无单位的整数。无需四舍五入。",
            "solution": "该问题要求评估一个由线性时不变（LTI）状态空间模型描述的线性化双基因信号模块的能控性。该模型由方程 $\\dot{x}(t)=A x(t)+B u(t)$ 给出，其中状态维度为 $n=2$。给定的矩阵为：\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\n一个LTI系统的能控性由其能控性矩阵的秩决定，该矩阵记为 $\\mathcal{C}$。对于一个维度为 $n$ 的系统，其能控性矩阵构造如下：\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB  A^2B  \\cdots  A^{n-1}B \\end{bmatrix}\n$$\n当且仅当能控性矩阵 $\\mathcal{C}$ 满秩时，系统是能控的，即 $\\operatorname{rank}(\\mathcal{C}) = n$。这被称为能控性的 Kalman 秩条件。\n\n对于给定系统，状态维度为 $n=2$。因此，能控性矩阵由下式给出：\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix}\n$$\n$\\mathcal{C}$ 的第一列是输入矩阵 $B$ 本身：\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n$\\mathcal{C}$ 的第二列是状态矩阵 $A$ 和输入矩阵 $B$ 的乘积。我们计算这个乘积：\n$$\nAB = \\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}\n$$\n现在，我们可以通过连接列向量 $B$ 和 $AB$ 来构建能控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{bmatrix} 0  1 \\\\ 1  -3 \\end{bmatrix}\n$$\n为了确定 $2 \\times 2$ 矩阵 $\\mathcal{C}$ 的秩，我们可以计算其行列式。一个方阵满秩当且仅当其行列式不为零。\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = 0 - 1 = -1\n$$\n由于 $\\det(\\mathcal{C}) = -1 \\neq 0$，矩阵 $\\mathcal{C}$ 的列向量是线性无关的。对于一个 $2 \\times 2$ 矩阵，这意味着它的秩为 $2$。\n$$\n\\operatorname{rank}(\\mathcal{C}) = 2\n$$\n根据 Kalman 秩条件，如果 $\\operatorname{rank}(\\mathcal{C})$ 等于状态空间的维度 $n$，则系统是能控的。在本例中，我们已求得 $\\operatorname{rank}(\\mathcal{C}) = 2$，且状态维度为 $n=2$。由于 $\\operatorname{rank}(\\mathcal{C}) = n$，该系统是完全能控的。这意味着可以使用适当的控制输入 $u(t)$，在有限时间内将线性化基因模块的状态从任意初始状态驱动到任意期望的最终状态。\n\n问题要求计算能控性矩阵的秩，我们已计算出其值为 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "系统的状态空间表示与其传递函数之间存在着深刻的联系，这种联系对理解可控性和可观测性至关重要。本练习探讨了一个看似简单的传递函数，其背后却隐藏着一个关键的陷阱：极点-零点对消。通过分析这种情况，你将揭示为何任何实现该传递函数的二维状态空间模型都必然是非最小的，从而导致系统失去可控性或可观测性。这个思想实验强调了在从传递函数构建状态空间模型时，识别并理解内部模态耦合的重要性。",
            "id": "1706947",
            "problem": "考虑一个单输入单输出（SISO）的线性时不变（LTI）系统。输入 $U(s)$ 的拉普拉斯变换与输出 $Y(s)$ 的拉普拉斯变换之间的关系由以下传递函数给出：\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{s + 1}{s^2 + 3s + 2}$$\n一位控制工程师希望使用如下形式的二维状态空间模型来实现该系统：\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n$$ y(t) = C \\mathbf{x}(t) + D u(t) $$\n其中 $\\mathbf{x}(t)$ 是 2x1 的状态向量，$A$ 是 2x2 矩阵，$B$ 是 2x1 矩阵，$C$ 是 1x2 矩阵，并且我们可以假设标量 $D=0$。\n\n对于该传递函数的*任何*有效的二维状态空间实现，以下哪个陈述必然为真？\n\nA. 该实现总是能控且总是能观的。\n\nB. 该实现总是能控的，但可能不能观。\n\nC. 该实现总是能观的，但可能不能控。\n\nD. 该实现必须是不能控，或不能观，或两者皆是。\n\nE. 该实现是能控还是能观完全取决于所选的状态变量，并且有可能找到一个既能控又能观的实现。",
            "solution": "我们从给定的传递函数开始\n$$G(s)=\\frac{Y(s)}{U(s)}=\\frac{s+1}{s^{2}+3s+2}.$$\n对分母进行因式分解：\n$$s^{2}+3s+2=(s+1)(s+2),$$\n因此\n$$G(s)=\\frac{s+1}{(s+1)(s+2)}=\\frac{1}{s+2}.$$\n因此，该传递函数可以化简为一阶严格真分式形式，其麦克米兰阶（McMillan degree）为\n$$n_{\\min}=1.$$\n\n任何状态空间实现 $(A,B,C,D)$（其中 $D=0$）都满足\n$$G(s)=C(sI-A)^{-1}B.$$\n根据基本实现理论：\n- 一个实现是最小的，当且仅当它既是能控的又是能观的。\n- 任何实现的最小维数等于 $G(s)$ 的麦克米兰阶。\n\n由于 $n_{\\min}=1$，任何二维实现必然是非最小的。因此，根据最小实现准则，它不可能同时是能控和能观的。等价地，每一个这样的二维实现必须是不能控，或不能观，或两者皆是。\n\n因此，在这些选项中，对于任何有效的二维实现必然为真的陈述是：它必须是不能控，或不能观，或两者皆是。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在理想化的模型中，可控性通常是一个非黑即白的概念。然而，在真实的生物医学应用中，系统参数的不确定性和变化使得问题变得更加复杂。本高级练习通过一个三节点胰岛素信号级联的案例，探讨了“结构可控性”与“数值可控性”之间的区别。你将通过符号推导发现，即使系统结构上允许控制，特定的参数值组合也可能导致“灾难性”的数学对消，从而使系统变得不可控。理解这种现象对于设计在参数变化时依然安全、有效的鲁棒生物医学控制器（如人工胰腺）至关重要。",
            "id": "3879501",
            "problem": "考虑一个线性时不变 (LTI) 状态空间模型，该模型是通过在一个受控葡萄糖输注实验中，将一个三节点胰岛素信号级联在其生理平衡点附近进行线性化得到的。三个状态分别是：受体占有率 $x_{1}$、下游激酶活性 $x_{2}$ 和葡萄糖摄取率 $x_{3}$。输入 $u(t)$ 是静脉注射的胰岛素输注率。线性化后的动力学由下式给出\n$$\n\\dot{x} = A x + B u,\n$$\n其中\n$$\nA =\n\\begin{pmatrix}\n- a  0  t \\\\\np  - b  0 \\\\\nr  q  - c\n\\end{pmatrix},\n\\qquad\nB =\n\\begin{pmatrix}\nu \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\n这里 $a$、$b$、$c$ 是正常数清除率 ($a,b,c>0$)，$p$、$q$、$r$、$t$ 是耦合增益，满足 $p,q,t>0$ 且 $r \\in \\mathbb{R}$（$r$ 的符号取决于受体占有率对葡萄糖摄取的直接影响是增强还是抵消激酶介导的通路）。输注增益 $u>0$ 对受体处的输入通道进行缩放。$A$ 中所有条目的单位均为 $\\mathrm{min}^{-1}$，$B$ 的单位为每单位输入 $\\mathrm{min}^{-1}$。与 $(A,B)$ 相关的有向图的非零模式展示了从输入节点到每个状态的路径，包括速率为 $p$ 的弧 $x_{1} \\to x_{2}$、速率为 $q$ 的弧 $x_{2} \\to x_{3}$、速率为 $r$ 的直接弧 $x_{1} \\to x_{3}$，以及速率为 $t$ 的反馈 $x_{3} \\to x_{1}$。\n\n从 LTI 系统的可控性基本定义出发，推导可控性矩阵行列式关于参数 $a$、$b$、$c$、$p$、$q$、$r$、$t$ 和 $u$ 的解析表达式，并用它来确定使得系统不可控的特定值 $r^{\\star}$，尽管非零模式意味着系统具有结构可控性。\n\n然后，使用数值上合理的参数选择\n$$\na = 0.8,\\quad b = 0.3,\\quad c = 0.5,\\quad p = 0.2,\\quad q = 0.25,\\quad t = 0.1,\\quad u = 1.0,\n$$\n计算出导致可控性因对消而丧失的唯一值 $r^{\\star}$（单位为 $\\mathrm{min}^{-1}$），并简要讨论在此生物医学背景下，在 $r^{\\star}$ 附近操作对数据驱动控制器设计的鲁棒性影响。用 $\\mathrm{min}^{-1}$ 表示您最终的 $r^{\\star}$ 数值答案，并将答案四舍五入到四位有效数字。",
            "solution": "问题要求推导给定的线性时不变 (LTI) 生物医学系统失去可控性的条件，并计算导致这种损失的特定参数值。\n\n首先，我们验证问题陈述的有效性。\n给定的 LTI 系统由状态空间方程 $\\dot{x} = A x + B u$ 描述，其中 $x \\in \\mathbb{R}^3$ 是状态向量，$u \\in \\mathbb{R}$ 是控制输入，矩阵 $A$ 和 $B$ 为：\n$$\nA =\n\\begin{pmatrix}\n- a  0  t \\\\\np  - b  0 \\\\\nr  q  - c\n\\end{pmatrix},\n\\qquad\nB =\n\\begin{pmatrix}\nu \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n参数受限于 $a, b, c > 0$、$p, q, t > 0$ 和 $u > 0$ 的约束，其中 $r \\in \\mathbb{R}$。为进行特定计算提供了数值：$a = 0.8$、$b = 0.3$、$c = 0.5$、$p = 0.2$、$q = 0.25$、$t = 0.1$、$u = 1.0$。所有这些量都有明确的定义，其物理释义（清除率、耦合增益）与生物医学系统建模一致。该问题具有科学依据，提法得当，且不含矛盾。这是一项线性控制理论的标准练习。因此，该问题被认为是有效的。\n\n我们继续求解。LTI 系统的可控性基本定义指出，如果对于任意初始状态 $x(0)$ 和任意最终状态 $x_f$，都存在一个在有限时间区间 $[0, t_f]$ 内的控制输入 $u(t)$，能够将状态从 $x(0)$ 驱动到 $x_f$，则系统是可控的。对于 LTI 系统，这等价于卡尔曼秩条件，即要求可控性矩阵 $\\mathcal{C}$ 必须是满秩的。状态维度为 $n=3$，输入维度为 $m=1$。可控性矩阵由下式给出：\n$$\n\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}\n$$\n对于这个 $3 \\times 3$ 矩阵，满秩（秩为 3）等价于其行列式不为零。系统可控当且仅当 $\\det(\\mathcal{C}) \\neq 0$。当 $\\det(\\mathcal{C}) = 0$ 时，系统变得不可控。\n\n现在我们通过计算其各列来构建可控性矩阵 $\\mathcal{C}$。\n第一列是矩阵 $B$：\n$$\nB = \\begin{pmatrix} u \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第二列是乘积 $AB$：\n$$\nAB = \\begin{pmatrix} -a  0  t \\\\ p  -b  0 \\\\ r  q  -c \\end{pmatrix} \\begin{pmatrix} u \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -au \\\\ pu \\\\ ru \\end{pmatrix}\n$$\n第三列是 $A^2B = A(AB)$：\n$$\nA^2B = \\begin{pmatrix} -a  0  t \\\\ p  -b  0 \\\\ r  q  -c \\end{pmatrix} \\begin{pmatrix} -au \\\\ pu \\\\ ru \\end{pmatrix} = \\begin{pmatrix} (-a)(-au) + (0)(pu) + (t)(ru) \\\\ (p)(-au) + (-b)(pu) + (0)(ru) \\\\ (r)(-au) + (q)(pu) + (-c)(ru) \\end{pmatrix} = \\begin{pmatrix} (a^2 + tr)u \\\\ (-ap - bp)u \\\\ (-ar + pq - cr)u \\end{pmatrix} = u \\begin{pmatrix} a^2 + tr \\\\ -(a+b)p \\\\ pq - (a+c)r \\end{pmatrix}\n$$\n现在，我们组装可控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{pmatrix} u  -au  (a^2+tr)u \\\\ 0  pu  -(a+b)pu \\\\ 0  ru  (pq - (a+c)r)u \\end{pmatrix}\n$$\n接下来，我们计算 $\\mathcal{C}$ 的行列式。我们可以从三列中分别提出因子 $u$：\n$$\n\\det(\\mathcal{C}) = u^3 \\det \\begin{pmatrix} 1  -a  a^2+tr \\\\ 0  p  -(a+b)p \\\\ 0  r  pq - (a+c)r \\end{pmatrix}\n$$\n沿第一列进行代数余子式展开，行列式为：\n$$\n\\det(\\mathcal{C}) = u^3 \\cdot 1 \\cdot \\det \\begin{pmatrix} p  -(a+b)p \\\\ r  pq - (a+c)r \\end{pmatrix}\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p(pq - (a+c)r) - r(-(a+b)p) \\right)\n$$\n展开并化简括号内的表达式：\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q - p(a+c)r + pr(a+b) \\right)\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q - apr - cpr + apr + bpr \\right)\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q + (b-c)pr \\right)\n$$\n这可以进一步因式分解，得到行列式的最终解析表达式：\n$$\n\\det(\\mathcal{C}) = u^3 p \\left( pq + (b-c)r \\right)\n$$\n当 $\\det(\\mathcal{C}) = 0$ 时，系统变得不可控。考虑到问题约束 $u > 0$ 和 $p > 0$，项 $u^3p$ 非零。因此，不可控的条件是：\n$$\npq + (b-c)r = 0\n$$\n我们求解这个关于 $r$ 的方程，以找到导致可控性丧失的特定值 $r^\\star$。假设 $b \\neq c$：\n$$\n(b-c)r = -pq\n$$\n$$\nr^\\star = -\\frac{pq}{b-c} = \\frac{pq}{c-b}\n$$\n这就是 $r$ 的值，在该值下会发生特定的数值对消，使得系统变得不可控，尽管其结构（如其有向图所示）对于通用参数值是可控的。这是可控性的失效，而不是结构可控性的失效。\n\n接下来，我们使用给定的参数计算 $r^\\star$ 的数值：$p = 0.2$、$q = 0.25$、$b = 0.3$ 和 $c = 0.5$。\n$$\nr^\\star = \\frac{(0.2)(0.25)}{0.5 - 0.3} = \\frac{0.05}{0.2} = 0.25\n$$\n矩阵 $A$ 中所有条目（包括 $r$）的单位都为 $\\mathrm{min}^{-1}$。所以，$r^\\star = 0.25 \\, \\mathrm{min}^{-1}$。根据要求四舍五入到四位有效数字，我们得到 $r^\\star = 0.2500 \\, \\mathrm{min}^{-1}$。\n\n最后，我们讨论鲁棒性方面的影响。在 $r = r^\\star$ 时可控性的丧失是精确数学对消的结果。在现实世界的生物医学背景中，系统参数永远无法以无限精度得知。它们是从含噪声的数据中估计出来的，并受到生物变异性的影响。如果一个病人的参数 $r$ 的真实值接近 $r^\\star$，系统将是“近乎不可控的”。这是因为可控性矩阵的行列式 $\\det(\\mathcal{C})$ 会变得非常小，表明可控子空间接近于坍缩。\n\n近乎不可控对控制器设计有严重影响。\n1. **高控制能量**：试图将系统状态驱动到“困难”方向（那些几乎在可控子空间之外的方向）将需要过大的控制输入，即高胰岛素输注率，这对患者可能是危险的（例如，导致低血糖）。\n2. **模型辨识与数据驱动设计**：如果一个系统在接近不可控点的状态下运行，所收集的输入输出数据可能缺乏足够的信息丰富度来精确辨识系统动力学。输入对某些状态组合的影响会被减弱，导致病态估计问题和不准确的模型。基于这种有缺陷的数据驱动模型设计的控制器很可能不具备鲁棒性且性能不佳，并可能因患者参数的微小变化而变得不稳定。\n3. **敏感性**：当系统近乎不可控时，控制器的性能和稳定性可能对参数误差变得极其敏感。为一个估计的 $r$ 值设计的控制器，如果患者的真实 $r$ 值略有不同且更接近 $r^\\star$，则可能会失效。\n因此，在接近不可控点的情况下操作生物医学控制系统（如人工胰腺）是极其不鲁棒的，并带来巨大风险。在基于模型或数据驱动的设计中，评估系统与不可控状态的“距离”以确保安全性和有效性是一个关键的考虑因素。",
            "answer": "$$\n\\boxed{0.2500}\n$$"
        }
    ]
}