{
    "hands_on_practices": [
        {
            "introduction": "掌握时间尺度分离的理论后，关键在于将其应用于具体问题。本章的动手实践旨在引导您完成从基本分析到计算验证的全过程，从而巩固您的建模与分析技能。第一个练习  将带您回到数学基础。通过分析一个典型的奇异摄动系统，您将学习如何规范地分离快慢变量，推导系统的快时间尺度形式，并确定作为拟稳态近似核心的临界流形。",
            "id": "3938798",
            "problem": "考虑一个用于生物分子传感器的二维奇异摄动模型，该模型具有一个快读出变量和一个慢目标变量，由以下耦合常微分方程给出\n$$\\dot{x} = -\\frac{1}{\\epsilon}\\left(x - y\\right), \\quad \\dot{y} = -y + u(t),$$\n其中 $\\epsilon \\in (0,1)$ 是一个小的无量纲参数，$x(t)$ 是快读出变量，$y(t)$ 是慢目标变量，$u(t)$ 是一个外部施加的输入信号，用于模拟受控灌注。假设输入 $u(t)$ 在 $t \\geq 0$ 上有界且连续可微，其导数也有界。初始条件为 $x(0) = x_{0}$ 和 $y(0) = y_{0}$。该问题的基本依据是快慢系统的奇异摄动理论，以及临界流形的定义，即快动力学在奇异极限下消失的集合。\n\n任务：\n1. 引入快时间 $ \\tau = t / \\epsilon $，并将系统重写为标准的快慢形式，确保时间尺度的分离是明确的。\n2. 确定哪个变量是快变量，哪个是慢变量。\n3. 通过在奇异极限中将快动力学设为零来推导临界流形，并将其明确地表示为一个解析关系。\n4. 将快子系统在临界流形周围线性化，同时将 $y$ 视为一个冻结参数（在快时间尺度上为常数），并讨论快动力学的稳定性。\n5. 报告线性化快子系统的特征值。最终答案以一个无单位的实数表示。\n\n你的最终答案应为任务5中获得的特征值。无需四舍五入。",
            "solution": "该问题提出了一个二维奇异摄动常微分方程（ODE）系统。我们将按照指定的任务分析该系统。\n\n给定的系统是：\n$$ \\dot{x} = -\\frac{1}{\\epsilon}\\left(x - y\\right) $$\n$$ \\dot{y} = -y + u(t) $$\n初始条件为 $x(0) = x_{0}$ 和 $y(0) = y_{0}$。参数 $\\epsilon$ 位于区间 $\\epsilon \\in (0,1)$ 内，并被认为是小的，这表示时间尺度的分离。\n\n**任务1：用快时间 $\\tau$ 重写系统**\n\n为了明确时间尺度的分离，我们引入快时间变量 $\\tau = \\frac{t}{\\epsilon}$。时间导数之间的关系可以通过链式法则找到：\n$$ \\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = \\frac{1}{\\epsilon} \\frac{d}{d\\tau} $$\n让撇号（'）表示对 $\\tau$ 的微分。状态变量的导数变为：\n$$ \\dot{x} = \\frac{dx}{dt} = \\frac{1}{\\epsilon} \\frac{dx}{d\\tau} = \\frac{1}{\\epsilon} x' $$\n$$ \\dot{y} = \\frac{dy}{dt} = \\frac{1}{\\epsilon} \\frac{dy}{d\\tau} = \\frac{1}{\\epsilon} y' $$\n将这些代入原始的常微分方程组，我们得到：\n$$ \\frac{1}{\\epsilon} x' = -\\frac{1}{\\epsilon}(x - y) $$\n$$ \\frac{1}{\\epsilon} y' = -y + u(t) $$\n将第一个方程乘以 $\\epsilon$ 得到快变量在快时间尺度下的动力学：\n$$ x' = -(x - y) = -x + y $$\n对于第二个方程，我们乘以 $\\epsilon$ 并将输入 $u(t)$ 的时间参数用 $\\tau$ 表示，使用 $t = \\epsilon\\tau$：\n$$ y' = \\epsilon(-y + u(\\epsilon\\tau)) $$\n在快时间尺度 $\\tau$ 下表示的完整系统是：\n$$ \\frac{dx}{d\\tau} = -x + y $$\n$$ \\frac{dy}{d\\tau} = \\epsilon(-y + u(\\epsilon\\tau)) $$\n这是快慢系统的标准形式，其中慢变量的动力学被 $\\epsilon$ 明确地缩放。\n\n**任务2：确定快变量和慢变量**\n\n在原始时间尺度 $t$ 下，$x$ 的变化率 $\\dot{x}$ 与 $\\frac{1}{\\epsilon}$ 成正比。由于 $\\epsilon$ 很小，$\\frac{1}{\\epsilon}$ 很大，这意味着 $x(t)$ 变化非常迅速。相比之下，$y$ 的变化率 $\\dot{y}$ 是 $\\mathcal{O}(1)$ 阶的。因此，$x(t)$ 是快变量，$y(t)$ 是慢变量。\n这在快时间尺度 $\\tau$ 下得到了证实。导数 $\\frac{dx}{d\\tau}$ 是 $\\mathcal{O}(1)$ 阶的，而导数 $\\frac{dy}{d\\tau}$ 是 $\\mathcal{O}(\\epsilon)$ 阶的。当 $\\epsilon \\to 0$ 时，$\\frac{dy}{d\\tau} \\to 0$，表明在快时间尺度上，$y$ 实际上是冻结的（准静态的）。\n\n**任务3：推导临界流形**\n\n临界流形 $M_0$ 是状态空间中快动力学处于平衡状态的几何轨迹。这通过将快变量的时间导数设为零来获得。在快时间尺度下，这对应于设置 $\\frac{dx}{d\\tau} = 0$：\n$$ \\frac{dx}{d\\tau} = -x + y = 0 $$\n解这个关于 $x$ 的代数方程，得到临界流形的表达式：\n$$ x = y $$\n该流形代表了快变量的准稳态。对于慢变量 $y$ 的任何给定值，快变量 $x$ 会迅速收敛到这个状态。\n\n**任务4：线性化快子系统并讨论其稳定性**\n\n快子系统描述了在快时间尺度 $\\tau$ 上快变量 $x$ 的动力学，并将慢变量 $y$ 视为一个常数参数。快子系统是：\n$$ \\frac{dx}{d\\tau} = f(x; y) = -x + y $$\n对于一个固定的 $y$，该子系统的平衡点通过设置 $f(x; y) = 0$ 找到，这给出 $x_{eq} = y$。这些点构成了临界流形 $M_0$。\n为了分析临界流形的稳定性，我们将快子系统在这些平衡点周围进行线性化。我们计算 $f(x; y)$ 相对于快变量 $x$ 的雅可比矩阵：\n$$ J = \\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x}(-x + y) $$\n偏导数是：\n$$ J = -1 $$\n雅可比矩阵是一个常数，与 $x$ 和 $y$ 都无关。线性化一维系统的特征值就是这个雅可比矩阵的值，$\\lambda = -1$。\n由于特征值 $\\lambda = -1$ 是严格为负的，快子系统的平衡点是渐近稳定的。这意味着临界流形 $M_0$ 是一个吸引流形。任何从流形外开始的轨迹都将迅速被吸引到它上面。\n\n**任务5：报告线性化快子系统的特征值**\n\n如上一步所确定的，线性化快子系统由雅可比矩阵 $J = -1$ 控制。对于这个一维系统，雅可比矩阵本身就是唯一的特征值。\n因此，特征值为 $\\lambda = -1$。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "掌握了快慢系统分析的基本数学方法后，下一步是学会如何在实际生物模型中判断何时可以使用QSSA。这个练习  提供了一个关于细胞钙信号转导的具体案例。您将通过推导和比较缓冲蛋白结合与离子泵外排这两个过程的特征时间尺度，为应用QSSA提供定量的依据，深刻理解“快”与“慢”在物理世界中的相对性。",
            "id": "3938876",
            "problem": "在一个充分混合的细胞中，胞质游离钙浓度 $C(t)$ 与一个总浓度固定为 $B_{T}$ 的可移动缓冲物种 $B$ 发生可逆结合，同时钙被质膜钙ATP酶（PMCA）泵排出。缓冲反应遵循质量作用定律：$C + B \\rightleftharpoons CB$，其结合速率为 $k_{\\text{on}}$，解离速率为 $k_{\\text{off}}$。泵流是可饱和的，并根据Michaelis–Menten形式依赖于 $C$：$J_{\\text{pump}}(C) = \\dfrac{V_{\\max} C}{K_{m} + C}$，其中 $V_{\\max}$ 是最大泵速率，$K_{m}$ 是Michaelis浓度。假设系统处于静息游离钙水平 $C_{0}$ 附近，并考虑围绕 $C_{0}$ 的小扰动。仅从这些基本定义出发，推导在 $C_{0}$ 处评估的特征缓冲结合弛豫时间 $\\tau_{\\text{bind}}$，以及通过对 $C_{0}$ 附近的钙平衡进行线性化得到的特征泵弛豫时间 $\\tau_{\\text{pump}}$。定义无量纲时间尺度比 $\\varepsilon \\equiv \\dfrac{\\tau_{\\text{bind}}}{\\tau_{\\text{pump}}}$，并将其简化为一个用 $k_{\\text{on}}$、$k_{\\text{off}}$、$V_{\\max}$、$K_{m}$ 和 $C_{0}$ 表示的闭合形式。使用参数值 $C_{0} = 1.0 \\times 10^{-7}\\ \\text{M}$，$k_{\\text{on}} = 5.0 \\times 10^{7}\\ \\text{M}^{-1}\\ \\text{s}^{-1}$，$K_{d} = 5.0 \\times 10^{-7}\\ \\text{M}$（根据解离常数的定义，$k_{\\text{off}} = K_{d}\\,k_{\\text{on}}$），$K_{m} = 3.0 \\times 10^{-7}\\ \\text{M}$，以及 $V_{\\max} = 6.0 \\times 10^{-7}\\ \\text{M}\\ \\text{s}^{-1}$，计算 $\\varepsilon$ 的值。将 $\\varepsilon \\ll 1$ 的情况解释为快速缓冲准稳态近似有效的区域。将 $\\varepsilon$ 的最终数值四舍五入到三位有效数字。仅报告 $\\varepsilon$ 的最终值；不包括单位。",
            "solution": "问题要求推导和计算一个无量纲时间尺度比 $\\varepsilon$，它比较了简化细胞模型中钙缓冲剂的特征弛豫时间与钙泵的特征弛豫时间。我将首先推导这两个特征时间的解析表达式，然后将它们组合起来求出 $\\varepsilon$，最后使用提供的参数计算其数值。\n\n首先，我们推导特征缓冲结合弛豫时间 $\\tau_{\\text{bind}}$。反应为 $C + B \\rightleftharpoons CB$，结合速率为 $k_{\\text{on}}$，解离速率为 $k_{\\text{off}}$。复合物浓度 $[CB]$ 的变化率由质量作用定律给出：\n$$\n\\frac{d[CB]}{dt} = k_{\\text{on}} [C] [B] - k_{\\text{off}} [CB]\n$$\n为了确定结合过程本身的弛豫时间，我们考虑系统对围绕一个化学平衡的小扰动的响应，该平衡对应于固定的游离钙浓度 $[C] = C_{0}$。总缓冲剂浓度是恒定的，$B_{T} = [B] + [CB]$，这意味着 $[B] = B_{T} - [CB]$。将此代入速率方程，我们得到：\n$$\n\\frac{d[CB]}{dt} = k_{\\text{on}} C_{0} (B_{T} - [CB]) - k_{\\text{off}} [CB]\n$$\n这是一个关于 $[CB]$ 的一阶线性常微分方程。我们将其重新整理：\n$$\n\\frac{d[CB]}{dt} = k_{\\text{on}} C_{0} B_{T} - (k_{\\text{on}} C_{0} + k_{\\text{off}}) [CB]\n$$\n该方程的形式为 $\\frac{dy}{dt} = A - By$。解以速率常数 $B$ 指数松弛到稳态值 $A/B$。在我们的例子中，弛豫的速率常数为 $\\lambda_{\\text{bind}} = k_{\\text{on}} C_{0} + k_{\\text{off}}$。特征弛豫时间是速率常数的倒数：\n$$\n\\tau_{\\text{bind}} = \\frac{1}{\\lambda_{\\text{bind}}} = \\frac{1}{k_{\\text{on}} C_{0} + k_{\\text{off}}}\n$$\n\n接下来，我们推导特征泵弛豫时间 $\\tau_{\\text{pump}}$。这是通过对静息水平 $C_{0}$ 附近的钙平衡方程进行线性化得到的。我们考虑一个由PMCA泵和维持稳态的平衡恒定流入 $J_{\\text{in}}$ 控制的游离钙 $C$ 的演化方程：\n$$\n\\frac{dC}{dt} = -J_{\\text{pump}}(C) + J_{\\text{in}}\n$$\n泵流由 $J_{\\text{pump}}(C) = \\dfrac{V_{\\max} C}{K_{m} + C}$ 给出。在稳态 $C = C_{0}$ 时，我们必须有 $\\frac{dC}{dt} = 0$，这意味着 $J_{\\text{in}} = J_{\\text{pump}}(C_{0})$。\n\n我们现在通过考虑一个小扰动 $C(t) = C_{0} + \\delta_C(t)$ 来对系统在 $C_{0}$ 附近进行线性化。\n$$\n\\frac{d}{dt}(C_{0} + \\delta_C) = \\frac{d\\delta_C}{dt} = -J_{\\text{pump}}(C_{0} + \\delta_C) + J_{\\text{pump}}(C_{0})\n$$\n使用 $J_{\\text{pump}}$ 在 $C_{0}$ 附近的一阶泰勒展开：\n$$\nJ_{\\text{pump}}(C_{0} + \\delta_C) \\approx J_{\\text{pump}}(C_{0}) + \\left. \\frac{dJ_{\\text{pump}}}{dC} \\right|_{C=C_{0}} \\delta_C\n$$\n将此代入 $\\delta_C$ 的方程：\n$$\n\\frac{d\\delta_C}{dt} \\approx -\\left( J_{\\text{pump}}(C_{0}) + \\left. \\frac{dJ_{\\text{pump}}}{dC} \\right|_{C_{0}} \\delta_C \\right) + J_{\\text{pump}}(C_{0}) = - \\left. \\frac{dJ_{\\text{pump}}}{dC} \\right|_{C_{0}} \\delta_C\n$$\n泵流的导数是：\n$$\n\\frac{dJ_{\\text{pump}}}{dC} = \\frac{d}{dC}\\left(\\frac{V_{\\max} C}{K_{m} + C}\\right) = \\frac{V_{\\max}(K_{m} + C) - V_{\\max}C(1)}{(K_{m} + C)^2} = \\frac{V_{\\max} K_{m}}{(K_{m} + C)^2}\n$$\n在 $C = C_{0}$ 处计算导数，得到泵介导的弛豫速率常数 $\\lambda_{\\text{pump}}$：\n$$\n\\lambda_{\\text{pump}} = \\left. \\frac{dJ_{\\text{pump}}}{dC} \\right|_{C_{0}} = \\frac{V_{\\max} K_{m}}{(K_{m} + C_{0})^2}\n$$\n特征泵弛豫时间是该速率常数的倒数：\n$$\n\\tau_{\\text{pump}} = \\frac{1}{\\lambda_{\\text{pump}}} = \\frac{(K_{m} + C_{0})^2}{V_{\\max} K_{m}}\n$$\n\n现在我们可以定义无量纲时间尺度比 $\\varepsilon \\equiv \\dfrac{\\tau_{\\text{bind}}}{\\tau_{\\text{pump}}}$ 并找到它的闭合形式。\n$$\n\\varepsilon = \\frac{\\tau_{\\text{bind}}}{\\tau_{\\text{pump}}} = \\frac{1 / (k_{\\text{on}} C_{0} + k_{\\text{off}})}{(K_{m} + C_{0})^2 / (V_{\\max} K_{m})} = \\frac{V_{\\max} K_{m}}{(k_{\\text{on}} C_{0} + k_{\\text{off}}) (K_{m} + C_{0})^2}\n$$\n这是 $\\varepsilon$ 所需的解析表达式。\n\n最后，我们使用给定的参数值计算 $\\varepsilon$：\n- $C_{0} = 1.0 \\times 10^{-7}\\ \\text{M}$\n- $k_{\\text{on}} = 5.0 \\times 10^{7}\\ \\text{M}^{-1}\\ \\text{s}^{-1}$\n- $K_{d} = 5.0 \\times 10^{-7}\\ \\text{M}$\n- $K_{m} = 3.0 \\times 10^{-7}\\ \\text{M}$\n- $V_{\\max} = 6.0 \\times 10^{-7}\\ \\text{M}\\ \\text{s}^{-1}$\n\n首先，我们根据解离常数的定义 $K_{d} = k_{\\text{off}} / k_{\\text{on}}$ 计算 $k_{\\text{off}}$：\n$$\nk_{\\text{off}} = K_{d} k_{\\text{on}} = (5.0 \\times 10^{-7}\\ \\text{M}) \\times (5.0 \\times 10^{7}\\ \\text{M}^{-1}\\ \\text{s}^{-1}) = 25\\ \\text{s}^{-1}\n$$\n接下来，我们计算 $\\varepsilon$ 表达式分母中的各项：\n在 $C_0$ 处的缓冲平衡速率：\n$$\nk_{\\text{on}} C_{0} + k_{\\text{off}} = (5.0 \\times 10^{7}\\ \\text{M}^{-1}\\ \\text{s}^{-1})(1.0 \\times 10^{-7}\\ \\text{M}) + 25\\ \\text{s}^{-1} = 5.0\\ \\text{s}^{-1} + 25\\ \\text{s}^{-1} = 30\\ \\text{s}^{-1}\n$$\n与泵饱和度相关的项：\n$$\nK_{m} + C_{0} = 3.0 \\times 10^{-7}\\ \\text{M} + 1.0 \\times 10^{-7}\\ \\text{M} = 4.0 \\times 10^{-7}\\ \\text{M}\n$$\n$$\n(K_{m} + C_{0})^2 = (4.0 \\times 10^{-7}\\ \\text{M})^2 = 16.0 \\times 10^{-14}\\ \\text{M}^2\n$$\n现在我们计算分子：\n$$\nV_{\\max} K_{m} = (6.0 \\times 10^{-7}\\ \\text{M}\\ \\text{s}^{-1}) (3.0 \\times 10^{-7}\\ \\text{M}) = 18.0 \\times 10^{-14}\\ \\text{M}^2\\ \\text{s}^{-1}\n$$\n最后，我们将这些值代入 $\\varepsilon$ 的表达式中：\n$$\n\\varepsilon = \\frac{18.0 \\times 10^{-14}\\ \\text{M}^2\\ \\text{s}^{-1}}{(30\\ \\text{s}^{-1}) (16.0 \\times 10^{-14}\\ \\text{M}^2)} = \\frac{18.0}{30 \\times 16.0} = \\frac{18}{480} = \\frac{3}{80} = 0.0375\n$$\n问题要求将结果四舍五入到三位有效数字。值 $0.0375$ 已经有三位有效数字（数字 $3$、$7$ 和 $5$）。条件 $\\varepsilon \\ll 1$ 得到满足，表明时间尺度有明显的分离，这证明了对缓冲动力学使用准稳态近似是合理的。",
            "answer": "$$\\boxed{0.0375}$$"
        },
        {
            "introduction": "理论分析和合理性判断是模型简化的基础，但最终的检验标准是近似的准确性。最后一个实践练习  将引导您进入计算验证的层面。您需要编写程序，对一个共价修饰循环的完整质量作用动力学模型及其QSSA简化模型进行数值模拟，并比较两者在动态输入下的响应。这个练习不仅能让您直观地看到QSSA的精确度，还能探索其在某些条件下（例如底物与酶浓度相当时）为何会失效，这是成为一名优秀建模者不可或缺的实践经验。",
            "id": "3938842",
            "problem": "给定一个可逆共价修饰循环，该循环在质量作用动力学下模拟底物经历磷酸化和去磷酸化过程，同时活性激酶浓度发生阶跃变化。底物以两种形式存在，未修饰底物和修饰底物，分别表示为 $S$ 和 $S^*$。激酶（表示为 $E_1$）通过酶-底物复合物 $C_1$ 催化反应 $S \\rightarrow S^*$。类似地，磷酸酶（表示为 $E_2$）通过酶-底物复合物 $C_2$ 催化反应 $S^* \\rightarrow S$。其基本原理是化学质量作用动力学，包含以下基元反应步骤：\n$$\nE_1 + S \\xrightleftharpoons[k_{1,\\mathrm{off}}]{k_{1,\\mathrm{on}}} C_1 \\xrightarrow{k_{1,\\mathrm{cat}}} E_1 + S^*,\n\\quad\nE_2 + S^* \\xrightleftharpoons[k_{2,\\mathrm{off}}]{k_{2,\\mathrm{on}}} C_2 \\xrightarrow{k_{2,\\mathrm{cat}}} E_2 + S.\n$$\n设总酶浓度为 $E_{1,T}$ 和 $E_{2,T}$（单位为微摩尔），且 $E_1 = E_{1,T} - C_1$ 和 $E_2 = E_{2,T} - C_2$。总底物浓度 $S_T$（单位为微摩尔）满足 $S + S^* + C_1 + C_2 = S_T$ 并且是守恒的。\n\n以 $(S, S^*, C_1, C_2)$ 表示的完整质量作用模型为\n$$\n\\frac{dC_1}{dt} = k_{1,\\mathrm{on}} E_1 S - (k_{1,\\mathrm{off}} + k_{1,\\mathrm{cat}}) C_1,\n\\quad\n\\frac{dC_2}{dt} = k_{2,\\mathrm{on}} E_2 S^* - (k_{2,\\mathrm{off}} + k_{2,\\mathrm{cat}}) C_2,\n$$\n$$\n\\frac{dS}{dt} = -k_{1,\\mathrm{on}} E_1 S + k_{1,\\mathrm{off}} C_1 + k_{2,\\mathrm{cat}} C_2,\n\\quad\n\\frac{dS^*}{dt} = k_{1,\\mathrm{cat}} C_1 - k_{2,\\mathrm{on}} E_2 S^* + k_{2,\\mathrm{off}} C_2,\n$$\n其中 $E_1 = E_{1,T} - C_1$ 且 $E_2 = E_{2,T} - C_2$。\n\n在准稳态近似 (Quasi-Steady-State Approximation, QSSA) 下，假设与底物形式的变化相比，酶-底物复合物 $C_1$ 和 $C_2$ 能迅速达到弛豫。定义米氏常数 $K_{m1} = \\frac{k_{1,\\mathrm{off}} + k_{1,\\mathrm{cat}}}{k_{1,\\mathrm{on}}}$ 和 $K_{m2} = \\frac{k_{2,\\mathrm{off}} + k_{2,\\mathrm{cat}}}{k_{2,\\mathrm{on}}}$（单位为微摩尔）。简化模型只追踪 $S^*$，其中 $S = S_T - S^*$，有效速率为\n$$\nv_1 = \\frac{k_{1,\\mathrm{cat}} E_{1,T} S}{K_{m1} + S}, \\quad v_2 = \\frac{k_{2,\\mathrm{cat}} E_{2,T} S^*}{K_{m2} + S^*},\n$$\n因此\n$$\n\\frac{dS^*}{dt} = v_1 - v_2, \\quad S = S_T - S^*.\n$$\n\n对活性激酶浓度 $E_{1,T}$ 施加一个阶跃输入：当 $t  0$ 时，系统在 $E_{1,T} = E_{1,\\mathrm{low}}$ 条件下处于稳态；在 $t = 0$ 时，浓度阶跃至 $E_{1,\\mathrm{high}}$ 并保持恒定直到 $t = T_{\\mathrm{rise}}$，然后在 $t \\in [T_{\\mathrm{rise}}, T_{\\mathrm{rise}} + T_{\\mathrm{relax}}]$ 期间阶跃回 $E_{1,\\mathrm{low}}$。您必须使用完整的质量作用模型和简化的 QSSA 模型，计算 $S^*$ 响应此输入的瞬态动力学。初始条件在 $t = 0$ 时为在 $E_{1,\\mathrm{low}}$ 下达到的稳态。\n\n您的程序必须：\n- 模拟一个在 $E_{1,T} = E_{1,\\mathrm{low}}$ 条件下，$t \\in [0, T_{\\mathrm{pre}}]$ 的预平衡阶段，以近似稳态，这需要对完整质量作用模型和简化模型都进行模拟。\n- 模拟在 $E_{1,T} = E_{1,\\mathrm{high}}$ 条件下，$t \\in [0, T_{\\mathrm{rise}}]$ 的上升阶段，从预平衡的初始条件开始，并计算在此区间内完整模型和简化模型之间 $S^*$ 的最大绝对偏差。\n- 模拟在 $E_{1,T} = E_{1,\\mathrm{low}}$ 条件下，$t \\in [T_{\\mathrm{rise}}, T_{\\mathrm{rise}} + T_{\\mathrm{relax}}]$ 的弛豫阶段，从上升阶段的末尾开始，并计算在此区间内完整模型和简化模型之间 $S^*$ 的最大绝对偏差。\n- 将 $S^*$ 和所有浓度以微摩尔（$\\mu\\mathrm{M}$）表示；将时间以秒表示；最终的偏差必须以微摩尔为单位的浮点数形式返回。\n\n测试套件和参数（所有浓度单位为微摩尔，速率单位 $k_{\\mathrm{on}}$ 为 $\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，$k_{\\mathrm{off}}$ 和 $k_{\\mathrm{cat}}$ 为 $\\mathrm{s}^{-1}$，时间单位为秒）：\n- 案例1（常规理想情况，尺度分离良好）：$S_T = 10$, $E_{1,\\mathrm{low}} = 0.05$, $E_{1,\\mathrm{high}} = 0.20$, $E_{2,T} = 0.10$, $k_{1,\\mathrm{on}} = 5$, $k_{1,\\mathrm{off}} = 10$, $k_{1,\\mathrm{cat}} = 1$, $k_{2,\\mathrm{on}} = 5$, $k_{2,\\mathrm{off}} = 10$, $k_{2,\\mathrm{cat}} = 1$, $T_{\\mathrm{pre}} = 50$, $T_{\\mathrm{rise}} = 20$, $T_{\\mathrm{relax}} = 20$。\n- 案例2（边界情况，底物浓度与酶浓度相当）：$S_T = 0.5$, $E_{1,\\mathrm{low}} = 0.05$, $E_{1,\\mathrm{high}} = 0.20$, $E_{2,T} = 0.10$, $k_{1,\\mathrm{on}} = 5$, $k_{1,\\mathrm{off}} = 10$, $k_{1,\\mathrm{cat}} = 1$, $k_{2,\\mathrm{on}} = 5$, $k_{2,\\mathrm{off}} = 10$, $k_{2,\\mathrm{cat}} = 1$, $T_{\\mathrm{pre}} = 50$, $T_{\\mathrm{rise}} = 20$, $T_{\\mathrm{relax}} = 20$。\n- 案例3（边缘情况，弱结合动力学）：$S_T = 10$, $E_{1,\\mathrm{low}} = 0.05$, $E_{1,\\mathrm{high}} = 0.20$, $E_{2,T} = 0.10$, $k_{1,\\mathrm{on}} = 0.2$, $k_{1,\\mathrm{off}} = 10$, $k_{1,\\mathrm{cat}} = 1$, $k_{2,\\mathrm{on}} = 0.2$, $k_{2,\\mathrm{off}} = 10$, $k_{2,\\mathrm{cat}} = 1$, $T_{\\mathrm{pre}} = 50$, $T_{\\mathrm{rise}} = 20$, $T_{\\mathrm{relax}} = 20$。\n- 案例4（边缘情况，小阶跃幅度）：$S_T = 10$, $E_{1,\\mathrm{low}} = 0.05$, $E_{1,\\mathrm{high}} = 0.08$, $E_{2,T} = 0.10$, $k_{1,\\mathrm{on}} = 5$, $k_{1,\\mathrm{off}} = 10$, $k_{1,\\mathrm{cat}} = 1$, $k_{2,\\mathrm{on}} = 5$, $k_{2,\\mathrm{off}} = 10$, $k_{2,\\mathrm{cat}} = 1$, $T_{\\mathrm{pre}} = 50$, $T_{\\mathrm{rise}} = 20$, $T_{\\mathrm{relax}} = 20$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。输出必须按顺序为案例1到4，列出每个案例在上升阶段的最大绝对偏差和弛豫阶段的最大绝对偏差，两者都以微摩尔为单位，因此最终格式为\n$$\n[ \\Delta_{\\mathrm{rise},1}, \\Delta_{\\mathrm{relax},1}, \\Delta_{\\mathrm{rise},2}, \\Delta_{\\mathrm{relax},2}, \\Delta_{\\mathrm{rise},3}, \\Delta_{\\mathrm{relax},3}, \\Delta_{\\mathrm{rise},4}, \\Delta_{\\mathrm{relax},4} ].\n$$",
            "solution": "用户提供了一个生物化学系统建模中明确定义的问题，要求对一个共价修饰循环的完整质量作用动力学模型及其准稳态近似(QSSA)进行定量比较。该问题具有科学依据、形式上明确且计算上可行。以下将提供一个完整的解决方案。\n\n问题的核心是使用两种不同的数学模型，模拟修饰底物浓度 $S^*$ 的时间演化，并量化它们在特定动态输入下的差异。这两种模型是：\n1.  一个**完整的质量作用模型**，它是一个描述所有物种浓度（$S$、$S^*$ 以及酶-底物复合物 $C_1$ 和 $C_2$）的耦合常微分方程(ODE)组。\n2.  一个**简化的 QSSA 模型**，它通过假设复合物 $C_1$ 和 $C_2$ 相对于底物动力学瞬时达到平衡，将系统简化为关于 $S^*$ 的单个 ODE。这一假设导出了经典的米氏速率定律。\n\n模拟协议对每个模型分为三个阶段：\n1.  一个初始的**预平衡阶段**，用于数值近似与低激酶水平 $E_{1,T} = E_{1,\\mathrm{low}}$ 对应的稳态浓度。\n2.  一个**上升阶段**，其中激酶浓度阶跃上升至 $E_{1,T} = E_{1,\\mathrm{high}}$，从而引发瞬态响应。\n3.  一个**弛豫阶段**，其中激酶浓度阶跃回落至 $E_{1,T} = E_{1,\\mathrm{low}}$，使系统向初始稳态弛豫。\n\n主要输出是在上升和弛豫阶段，两种模型之间 $S^*$ 浓度的最大绝对偏差。\n\n让我们将数学模型和模拟过程形式化。\n\n**1. 完整质量作用模型**\n\n该系统包含四种浓度随时间变化的物种：$C_1(t)$、$C_2(t)$、$S(t)$ 和 $S^*(t)$。然而，总底物是守恒的：$S_T = S(t) + S^*(t) + C_1(t) + C_2(t)$。这使我们可以消去一个变量，例如 $S$。我们选择状态向量为 $y(t) = [C_1(t), C_2(t), S^*(t)]^T$。其他物种的浓度则由状态变量和总浓度导出：\n- $C_1 = y_0$\n- $C_2 = y_1$\n- $S^* = y_2$\n- $E_1 = E_{1,T} - C_1$\n- $E_2 = E_{2,T} - C_2$\n- $S = S_T - S^* - C_1 - C_2$\n\n常微分方程组由 $\\frac{dy}{dt} = f(y, t)$ 给出：\n$$\n\\frac{dC_1}{dt} = k_{1,\\mathrm{on}} E_1 S - (k_{1,\\mathrm{off}} + k_{1,\\mathrm{cat}}) C_1\n$$\n$$\n\\frac{dC_2}{dt} = k_{2,\\mathrm{on}} E_2 S^* - (k_{2,\\mathrm{off}} + k_{2,\\mathrm{cat}}) C_2\n$$\n$$\n\\frac{dS^*}{dt} = k_{1,\\mathrm{cat}} C_1 - k_{2,\\mathrm{on}} E_2 S^* + k_{2,\\mathrm{off}} C_2\n$$\n代入 $E_1$、$E_2$ 和 $S$ 的导出表达式，可以得到用状态向量 $y$ 表示的 ODE 系统右侧。预平衡阶段的初始条件假定为 $y(0) = [0, 0, 0]^T$，表示所有底物都处于其未修饰形式 $S(0) = S_T$。\n\n**2. 简化的 QSSA 模型**\n\nQSSA 模型通过假设 $\\frac{dC_1}{dt} \\approx 0$ 和 $\\frac{dC_2}{dt} \\approx 0$ 来简化系统。这种代数简化导致了正向 ($v_1$) 和反向 ($v_2$) 通量的米氏速率表达式。该模型只追踪修饰底物的浓度 $S^*$。状态向量为 $y(t) = [S^*(t)]$。\n未修饰底物 $S$ 的浓度近似为 $S(t) = S_T - S^*(t)$，这假设与 $S_T$ 相比，复合物 $C_1$ 和 $C_2$ 的浓度可以忽略不计。\nQSSA 模型的 ODE 为：\n$$\n\\frac{dS^*}{dt} = v_1 - v_2 = \\frac{k_{1,\\mathrm{cat}} E_{1,T} S}{K_{m1} + S} - \\frac{k_{2,\\mathrm{cat}} E_{2,T} S^*}{K_{m2} + S^*}\n$$\n其中米氏常数定义为 $K_{m1} = \\frac{k_{1,\\mathrm{off}} + k_{1,\\mathrm{cat}}}{k_{1,\\mathrm{on}}}$ 和 $K_{m2} = \\frac{k_{2,\\mathrm{off}} + k_{2,\\mathrm{cat}}}{k_{2,\\mathrm{on}}}$。\n代入 $S = S_T - S^*$：\n$$\n\\frac{dS^*}{dt} = \\frac{k_{1,\\mathrm{cat}} E_{1,T} (S_T - S^*)}{K_{m1} + S_T - S^*} - \\frac{k_{2,\\mathrm{cat}} E_{2,T} S^*}{K_{m2} + S^*}\n$$\n预平衡的初始条件是 $y(0) = [0]$。\n\n**3. 数值模拟算法**\n\n对于提供的每个测试案例：\n- **步骤 A：预平衡。** 在 $E_{1,T} = E_{1,\\mathrm{low}}$ 条件下，我们对完整模型和 QSSA 模型从 $t=0$ 到 $t=T_{\\mathrm{pre}}$ 进行积分。初始状态为 $y_{\\text{full}}(0) = [0,0,0]^T$ 和 $y_{\\text{QSSA}}(0) = [0]$。最终状态 $y_{\\text{full}}(T_{\\mathrm{pre}})$ 和 $y_{\\text{QSSA}}(T_{\\mathrm{pre}})$ 作为下一阶段的初始条件。\n\n- **步骤 B：上升阶段。** 在 $E_{1,T} = E_{1,\\mathrm{high}}$ 条件下，我们对两个模型从 $t=0$ 到 $t=T_{\\mathrm{rise}}$ 进行积分。初始条件是步骤 A 的最终状态。我们在区间 $[0, T_{\\mathrm{rise}}]$ 的密集时间点网格上求解 ODE，以获得轨迹 $S^*_{\\text{full}}(t)$ 和 $S^*_{\\text{QSSA}}(t)$。然后计算最大绝对偏差为 $\\Delta_{\\text{rise}} = \\max_{t \\in [0, T_{\\mathrm{rise}}]} |S^*_{\\text{full}}(t) - S^*_{\\text{QSSA}}(t)|$。在 $t=T_{\\mathrm{rise}}$ 时的最终状态被存储用于下一阶段。\n\n- **步骤 C：弛豫阶段。** 在 $E_{1,T} = E_{1,\\mathrm{low}}$ 条件下，我们对两个模型从相对时间 $t=0$ 到 $t=T_{\\mathrm{relax}}$ 进行积分（对应于绝对时间从 $T_{\\mathrm{rise}}$ 到 $T_{\\mathrm{rise}}+T_{\\mathrm{relax}}$）。初始条件是步骤 B 的最终状态。同样，我们计算轨迹和最大绝对偏差 $\\Delta_{\\text{relax}} = \\max_{t \\in [0, T_{\\mathrm{relax}}]} |S^*_{\\text{full}}(t) - S^*_{\\text{QSSA}}(t)|$。\n\n数值积分是使用 `scipy.integrate` 库中的 `solve_ivp` 函数来执行的，该函数适用于求解 ODE 系统。我们采用 `BDF` (后向差分公式) 方法，该方法对于刚性系统非常高效，而刚性是具有时间尺度分离的模型的共同特征。使用高精度容差（$rtol=10^{-8}$，$atol=10^{-10}$）以确保数值准确性。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef run_simulation_for_case(params):\n    \"\"\"\n    Runs the full simulation for a single parameter set.\n    \"\"\"\n    # Unpack parameters for the case\n    S_T, E1_low, E1_high, E2_T, k1_on, k1_off, k1_cat, \\\n    k2_on, k2_off, k2_cat, T_pre, T_rise, T_relax = params\n\n    # Derived Michaelis constants for QSSA model\n    Km1 = (k1_off + k1_cat) / k1_on\n    Km2 = (k2_off + k2_cat) / k2_on\n\n    # Define the ODE systems\n    def full_model_rhs(t, y, E1_T_val):\n        C1, C2, S_star = y\n        # Check for physically unrealistic negative concentrations due to solver steps\n        C1 = max(0, C1)\n        C2 = max(0, C2)\n        S_star = max(0, S_star)\n\n        S = S_T - S_star - C1 - C2\n        S = max(0, S) # Ensure S is not negative\n\n        E1 = E1_T_val - C1\n        E2 = E2_T - C2\n\n        dC1_dt = k1_on * E1 * S - (k1_off + k1_cat) * C1\n        dC2_dt = k2_on * E2 * S_star - (k2_off + k2_cat) * C2\n        dS_star_dt = k1_cat * C1 - (k2_on * E2 * S_star - k2_off * C2)\n        \n        return [dC1_dt, dC2_dt, dS_star_dt]\n\n    def qssa_model_rhs(t, y, E1_T_val):\n        S_star = y[0]\n        S_star = max(0, min(S_star, S_T)) # Keep S_star within bounds\n\n        S = S_T - S_star\n        \n        v1 = (k1_cat * E1_T_val * S) / (Km1 + S)\n        v2 = (k2_cat * E2_T * S_star) / (Km2 + S_star)\n        \n        dS_star_dt = v1 - v2\n        return [dS_star_dt]\n\n    # Common solver settings\n    solver_method = 'BDF'\n    rtol = 1e-8\n    atol = 1e-10\n\n    # --- 1. Pre-equilibration phase ---\n    y0_full = [0.0, 0.0, 0.0]\n    y0_qssa = [0.0]\n    t_span_pre = [0, T_pre]\n\n    sol_full_pre = solve_ivp(\n        lambda t, y: full_model_rhs(t, y, E1_low),\n        t_span_pre, y0_full, method=solver_method, rtol=rtol, atol=atol\n    )\n    ic_full_rise = sol_full_pre.y[:, -1]\n\n    sol_qssa_pre = solve_ivp(\n        lambda t, y: qssa_model_rhs(t, y, E1_low),\n        t_span_pre, y0_qssa, method=solver_method, rtol=rtol, atol=atol\n    )\n    ic_qssa_rise = sol_qssa_pre.y[:, -1]\n\n    # --- 2. Rise phase ---\n    t_span_rise = [0, T_rise]\n    t_eval_rise = np.linspace(t_span_rise[0], t_span_rise[1], 2001)\n\n    sol_full_rise = solve_ivp(\n        lambda t, y: full_model_rhs(t, y, E1_high),\n        t_span_rise, ic_full_rise, method=solver_method, t_eval=t_eval_rise,\n        rtol=rtol, atol=atol\n    )\n    ic_full_relax = sol_full_rise.y[:, -1]\n    s_star_full_rise = sol_full_rise.y[2]\n\n    sol_qssa_rise = solve_ivp(\n        lambda t, y: qssa_model_rhs(t, y, E1_high),\n        t_span_rise, ic_qssa_rise, method=solver_method, t_eval=t_eval_rise,\n        rtol=rtol, atol=atol\n    )\n    ic_qssa_relax = sol_qssa_rise.y[:, -1]\n    s_star_qssa_rise = sol_qssa_rise.y[0]\n\n    dev_rise = np.max(np.abs(s_star_full_rise - s_star_qssa_rise))\n    \n    # --- 3. Relaxation phase ---\n    t_span_relax = [0, T_relax]\n    t_eval_relax = np.linspace(t_span_relax[0], t_span_relax[1], 2001)\n\n    sol_full_relax = solve_ivp(\n        lambda t, y: full_model_rhs(t, y, E1_low),\n        t_span_relax, ic_full_relax, method=solver_method, t_eval=t_eval_relax,\n        rtol=rtol, atol=atol\n    )\n    s_star_full_relax = sol_full_relax.y[2]\n    \n    sol_qssa_relax = solve_ivp(\n        lambda t, y: qssa_model_rhs(t, y, E1_low),\n        t_span_relax, ic_qssa_relax, method=solver_method, t_eval=t_eval_relax,\n        rtol=rtol, atol=atol\n    )\n    s_star_qssa_relax = sol_qssa_relax.y[0]\n\n    dev_relax = np.max(np.abs(s_star_full_relax - s_star_qssa_relax))\n\n    return dev_rise, dev_relax\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Parameters from problem description\n    base_params = {\n        'S_T': 10.0, 'E1_low': 0.05, 'E1_high': 0.20, 'E2_T': 0.10,\n        'k1_on': 5.0, 'k1_off': 10.0, 'k1_cat': 1.0,\n        'k2_on': 5.0, 'k2_off': 10.0, 'k2_cat': 1.0,\n        'T_pre': 50.0, 'T_rise': 20.0, 'T_relax': 20.0\n    }\n\n    # Define test cases by modifying the base parameters\n    case1_params = base_params.copy()\n    case2_params = base_params.copy()\n    case2_params.update({'S_T': 0.5})\n    case3_params = base_params.copy()\n    case3_params.update({'k1_on': 0.2, 'k2_on': 0.2})\n    case4_params = base_params.copy()\n    case4_params.update({'E1_high': 0.08})\n\n    test_cases = [\n        list(case1_params.values()),\n        list(case2_params.values()),\n        list(case3_params.values()),\n        list(case4_params.values())\n    ]\n\n    results = []\n    for case_params in test_cases:\n        dev_rise, dev_relax = run_simulation_for_case(case_params)\n        results.extend([dev_rise, dev_relax])\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}