{
    "hands_on_practices": [
        {
            "introduction": "在我们开始使用延迟微分方程进行建模之前，我们必须首先理解它们为何采用特定的形式。这项练习旨在挑战你思考因果性这一基本原则。你将探讨为何依赖于未来状态的模型在物理上是不现实的，并且在数学上对于预测是“不适定的”(ill-posed)，从而鞏固在生理建模中使用“滞后型”延迟微分方程的重要性，即系统的当前状态只依赖于其过去的状态。",
            "id": "3881464",
            "problem": "考虑一个标量生理状态变量 $x(t)$，例如，它代表反馈作用下循環激素的浓度。在生理系统中，表示有限传播和处理时间的常用方法是延迟微分方程（DDE），其中时间 $t$ 的变化率取决于过去的状态值 $x(t-\\tau)$，这里 $\\tau0$ 是一个生理延迟（例如，轴突传导、转录-翻译延迟或传输时间）。设 $g:\\mathbb{R}\\to\\mathbb{R}$ 是一个全局利普希茨反馈函数，利普希茨常数为 $L0$，并考虑以下两个模型：\n1) 滞后型 DDE：$x'(t)=-a\\,x(t)+g\\big(x(t-\\tau)\\big)$，其中 $a0$，给定历史 $x(t)=\\varphi(t)$，$t\\in[-\\tau,0]$，且 $\\varphi\\in C([-\\tau,0];\\mathbb{R})$。\n2) 超前型 DDE：$x'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)$，其中 $a0$ 相同，历史规定也相同，$x(t)=\\varphi(t)$，$t\\in[-\\tau,0]$。\n\n仅使用适用于生物医学系统建模的第一性原理——具体而言：因果性定义（时间 $t$ 的状态和输出可能依赖于直到时间 $t$ 为止的输入和状态，但不能依赖于未来的值）、Hadamard 适定性概念（存在性、唯一性和对给定数据的连续依赖性）以及从初始历史片段构造滞后型 DDE 解的标准方法——回答以下关于超前型 DDE 模型的生理可容许性和数学适定性的多项选择题。\n\n下列哪个陈述是正确的？\n\nA. 在生理模型中，将 $x(t-\\tau)$ 替换为 $x(t+\\tau)$ 违反了因果性，因为 $x'(t)$ 将依赖于未来的状态值 $x(t+\\tau)$，而该值无法仅从历史 $x|_{[-\\tau,0]}$ 和当前输入确定。\n\nB. 仅给定历史 $x(t)=\\varphi(t)$，$t\\in[-\\tau,0]$，方程 $x'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)$ 的初值问题不是 Hadamard 适定的：从 $t=0$ 开始的正向演化通常在没有额外未来数据的情况下，不满足对 $\\varphi$ 的唯一性和连续依赖性，并且可能没有解或有无限多个扩展解。\n\nC. 如果 $g$ 是全局利普希茨的，那么方程 $x'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)$ 在给定历史 $x|_{[-\\tau,0]}=\\varphi$ 的情况下成为一个适定的初值问题，因为仅凭利普希茨性质就保证了存在性和唯一性。\n\nD. 在有限区间 $[0,T]$（其中 $T\\tau$）上，规定终端片段数据 $x(t)=\\psi(t)$，$t\\in[T,T+\\tau]$，可以将超前型 DDE $x'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)$ 转化为在 $[0,T]$ 上的一个适定的反向问题；在变量变换 $y(s)=x(T-s)$ 下，它变成了一个关于 $y$ 的、具有已知历史 $y|_{[-\\tau,0]}$ 的滞后型 DDE。\n\nE. 具有常数 $a0$, $b\\in\\mathbb{R}$ 的线性超前型 DDE $x'(t)=-a\\,x(t)+b\\,x(t+\\tau)$ 在连续历史的巴拿赫空间 $C([-\\tau,0];\\mathbb{R})$ 上生成一个强连续半群，因此作为一个给定 $x|_{[-\\tau,0]}$ 的初值问题是时间正向适定的。\n\n选择所有正确选项。",
            "solution": "问题陈述提出了一个关于超前型与滞后型延迟微分方程（DDEs）的数学性质和生理可解释性的有效且基本的问题。模型定义清晰，问题需要使用因果性和适定性的第一性原理来解决，这些原理是物理和生物系统建模的核心。\n\n问题的核心在于比较状态变量 $x(t)$ 的两种标量DDE：\n1) 滞后型 DDE：$x'(t)=-a\\,x(t)+g\\big(x(t-\\tau)\\big)$\n2) 超前型 DDE：$x'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)$\n\n两者都考虑了在 $t\\in[-\\tau,0]$ 上规定的历史 $x(t)=\\varphi(t)$。任务是评估超前型 DDE 作为初值问题（IVP）的性质。\n\n求解滞后型 DDE 的标准方法是步进法。对于 $t \\in [0, \\tau]$，延迟项的自变量 $t-\\tau$ 位于区间 $[-\\tau, 0]$ 内。由于对于 $s \\in [-\\tau, 0]$，$x(s)=\\varphi(s)$ 是已知的，因此在 $[0, \\tau]$ 上的方程变成一个常微分方程（ODE）：\n$$\nx'(t) = -a\\,x(t) + g\\big(\\varphi(t-\\tau)\\big)\n$$\n其初值条件为 $x(0)=\\varphi(0)$。由于 $g$ 是全局利普希茨的，方程右侧关于 $x$ 是利普希茨的，关于 $t$ 是连续的，根据 Picard-Lindelöf 定理，这保证了在区间 $[0, \\tau]$ 上解 $x(t)$ 的存在性和唯一性。这个过程可以迭代，在相继的区间 $[\\tau, 2\\tau], [2\\tau, 3\\tau], \\dots$ 上求解 $x(t)$。这种分步构造方法表明滞后型 DDE 的初值问题是适定的：存在唯一的解，并且它连续地依赖于初始历史 $\\varphi$。\n\n现在，我们将同样的逻辑应用于超前型 DDE：\n$$\nx'(t)=-a\\,x(t)+g\\big(x(t+\\tau)\\big)\n$$\n为了确定从 $t=0$ 开始的 $t \\ge 0$ 上的解，我们需要计算方程的右侧。在 $t=0$ 时，方程为：\n$$\nx'(0) = -a\\,x(0) + g\\big(x(\\tau)\\big) = -a\\,\\varphi(0) + g\\big(x(\\tau)\\big)\n$$\n值 $x(\\tau)$ 是系统在未来时间 $\\tau$ 的状态。这个值不是由初始历史 $\\varphi$ 提供的，因为 $\\varphi$ 仅在 $[-\\tau, 0]$ 上有定义。因此，我们甚至无法从给定数据中确定初始变化率 $x'(0)$。步进法在第一步就失败了，因为求解在 $[0, \\tau]$ 上的状态需要知道在 $[\\tau, 2\\tau]$ 上的状态。这一根本性障碍为分析每个选项提供了信息。\n\n**选项 A 分析：**\n因果性原理规定，系统在时间 $t$ 的状态只能受到其直到时间 $t$ 为止的历史的影响，而不能受到未来事件的影响。变化率 $x'(t)$ 是由系统在时间 $t$ 的状态决定的一个结果。在超前型 DDE 模型中，$x'(t)$ 明确地依赖于 $x(t+\\tau)$，这是未来 $\\tau  0$ 时间后的一个状态值。这直接违反了因果性。一个生理过程不能基于尚未获得的信息来演化。该陈述正确地指出了这一违规及其后果：未来的值 $x(t+\\tau)$ 无法从规定的历史 $x|_{[-\\tau,0]}$ 中确定。\n因此，该陈述是 **正确的**。\n\n**选项 B 分析：**\n如果一个问题的解存在、唯一且连续依赖于初始数据，那么它就是 Hadamard 适定的。如前所述，为了从 $t=0$ 开始正向积分超前型 DDE，我们甚至需要知道 $x(t)$ 在区间 $[\\tau, 2\\tau]$ 上的信息才能开始在 $[0, \\tau]$ 上进行积分。由于此信息不属于初始历史 $\\varphi$ 的一部分，我们无法构造唯一的解。人们可以假设 $x(t)$ 在 $[\\tau, \\infty)$ 上有任意多种可能满足方程的行为，导致解的非唯一性（无限多个解），或者相反，可能无法找到任何在所有时间上都满足约束的函数（无解）。初值问题（IVP）的这种存在性和唯一性的失败意味着该问题不是 Hadamard 适定的。该陈述准确地描述了这种情况。\n因此，该陈述是 **正确的**。\n\n**选项 C 分析：**\n$g$ 的利普希茨性质是非线性反馈函数的一个正则性条件。对于滞后型 DDE，此性质对于确保步进法构造产生唯一解至关重要。然而，超前型 DDE 作为初值问题的缺陷是结构性的，与 $g$ 的正则性无关。问题在于时间自变量 $t+\\tau$，它使得问题非因果，并阻止了从初始数据进行时间正向构造。无论 $g$ 多么正则，其自变量 $x(t+\\tau)$ 的值仍然是未定的。因此，$g$ 的利普希茨性质无法纠正初值问题的不适定性。\n因此，该陈述是 **不正确的**。\n\n**选项 D 分析：**\n这个选项建议将超前型 DDE 重新构建为在有限区间 $[0, T]$ 上的一个反向问题，并规定*终端*数据 $x(t)=\\psi(t)$，$t\\in[T,T+\\tau]$。我们来验证所提出的变量变换：$y(s)=x(T-s)$，这意味着 $t=T-s$ 且 $dt = -ds$。\n导数变换为 $\\frac{dy}{ds} = \\frac{dx}{dt}\\frac{dt}{ds} = x'(t) \\cdot (-1)$，所以 $x'(t) = -y'(s)$。\n原方程为 $x'(t) = -a\\,x(t) + g\\big(x(t+\\tau)\\big)$。代入 $t=T-s$ 以及 $x$ 和 $x'$ 的表达式：\n$$\n-y'(s) = -a\\,y(s) + g\\big(x(T-s+\\tau)\\big)\n$$\n$g$ 的自变量是 $x\\big(T-(s-\\tau)\\big)$，它等于 $y(s-\\tau)$。\n关于 $y(s)$ 的方程变为：\n$$\n-y'(s) = -a\\,y(s) + g\\big(y(s-\\tau)\\big) \\implies y'(s) = a\\,y(s) - g\\big(y(s-\\tau)\\big)\n$$\n这是一个关于变量 $y$ 的滞后型 DDE。要在 $s \\in [0, T]$ 上求解（这对应于从 $T$ 开始反向求解 $t \\in [0, T]$ 上的 $x$），我们需要 $y$ 在区间 $s \\in [-\\tau, 0]$ 上的初始历史。这个历史由 $y(s) = x(T-s)$ 给出（对于 $s \\in [-\\tau, 0]$），这对应于 $t \\in [T, T+\\tau]$ 上的 $x(t)$。\n由于问题假设这个终端片段 $x(t)=\\psi(t)$（对于 $t \\in [T, T+\\tau]$）是给定的，我们便有了关于 $y$ 的滞后型 DDE 的已知历史。由此产生的关于 $y$ 的问题是一个适定的初值问题。因此，原来的超前型 DDE 作为一个终端值问题是适定的。该陈述是对这一数学事实的正确描述。\n因此，该陈述是 **正确的**。\n\n**选项 E 分析：**\n强连续半群（$C_0$-半群）理论为分析线性演化方程的适定性提供了一个框架。对于线性滞后型函数微分方程（FDE），一个标准结果是解算子在连续历史函数的态空间 $C([-\\tau,0];\\mathbb{R})$ 上形成一个 $C_0$-半群。这个半群的生成元是一个定义明确的算子。然而，对于超前型 DDE，情况并非如此。定义正向演化解算子的尝试失败了，因为如前所述，需要未来的信息。与线性超前型 DDE 右侧相关联的算子不满足 Hille-Yosida 定理的条件，因此不能成为 $C([-\\tau,0];\\mathbb{R})$ 上的 $C_0$-半群的生成元。这种用于形式化正向适定性的机制不适用于作为初值问题的超前型方程。\n因此，该陈述是 **不正确的**。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "时间延迟在生理反馈回路中最常见的影响之一是振荡的出现。本练习通过一个简化的血糖控制模型提供了一个具体的例子。通过进行稳定性分析，你将推导出系统稳态失稳并产生持续振荡的精确临界延迟，这一现象被称为霍普夫分岔 (Hopf bifurcation)。",
            "id": "3881494",
            "problem": "一种基于生理学的血糖浓度 $G(t)$ 质量平衡描述将 $G(t)$ 的变化率视作血糖出现与消失之间的差值。在禁食或近稳态条件下，血糖的出现主要由肝脏输出调节，而血糖的消失则源于组织的摄取，这种摄取既有非胰岛素介导的，也有胰岛素介导的。围绕基准稳态 $G^{\\ast}$ 和 $I^{\\ast}$ 进行线性化，并将胰岛素对葡萄糖摄取的延迟作用聚合为一个等效项，可以写出一个描述偏差 $\\Delta G(t) = G(t) - G^{\\ast}$ 的最小负反馈模型，它是一个一阶延迟微分方程 (DDE)：\n$$\n\\frac{d \\Delta G(t)}{dt} = -a \\,\\Delta G(t) - b \\,\\Delta G(t-\\tau),\n$$\n其中 $a0$ 代表非胰岛素介导的葡萄糖处置和快速肝脏稳定的有效速率常数，$b0$ 代表胰岛素介导的葡萄糖处置的有效增益，$\\tau0$ 是反映胰岛素分泌、肝脏处理、转运、受体结合和细胞内信号动力学的生理延迟。当稳态随着 $\\tau$ 的增加通过霍普夫分岔 (Hopf bifurcation) 失去稳定性时，$\\Delta G(t)$ 中会出现持续振荡。\n\n从上述质量平衡和反馈原理出发，并且不使用任何未提供的简化公式，通过分析线性化DDE的特征根，推导出振荡发生的条件。得到纯虚特征根出现时的最小正临界延迟 $\\tau_{\\mathrm{crit}}$ 关于 $a$ 和 $b$ 的显式解析表达式。然后，使用生理上合理的参数值 $a = 0.03 \\,\\text{min}^{-1}$ 和 $b = 0.075 \\,\\text{min}^{-1}$，计算 $\\tau_{\\mathrm{crit}}$ 的数值。答案以分钟为单位表示，并四舍五入到四位有效数字。\n\n为了与人体观测联系起来，假设连续血糖监测 (CGM) 测量显示，在禁食条件下，超日节律振荡的周期在 $80$ 到 $150$ 分钟之间。根据你的推导，简要评估所选 $(a,b)$ 在不稳定性出现时的理论振荡周期是否在观测到的超日节律范围内，但仅报告计算出的 $\\tau_{\\mathrm{crit}}$ 作为最终数值答案。",
            "solution": "该问题要求推导临界时间延迟 $\\tau_{\\mathrm{crit}}$，在该延迟下，一个线性化的葡萄糖动力学模型会经历霍普夫分岔，从而导致振荡的发生。该模型由以下一阶延迟微分方程 (DDE) 给出：\n$$\n\\frac{d \\Delta G(t)}{dt} = -a \\,\\Delta G(t) - b \\,\\Delta G(t-\\tau)\n$$\n其中 $\\Delta G(t)$ 是与稳态血糖浓度的偏差，参数 $a$、$b$ 和 $\\tau$ 均为正实数。\n\n为了分析稳态 $\\Delta G(t) = 0$ 的稳定性，我们研究与该DDE相关的特征方程的根。我们寻找形式为 $\\Delta G(t) = C \\exp(\\lambda t)$ 的解，其中 $C$ 是一个常数，$\\lambda$ 是一个复数。将这个拟设代入DDE中：\n$$\n\\frac{d}{dt} \\left(C \\exp(\\lambda t)\\right) = -a \\left(C \\exp(\\lambda t)\\right) - b \\left(C \\exp(\\lambda(t-\\tau))\\right)\n$$\n对左边求导并提取公因式，我们得到：\n$$\n\\lambda C \\exp(\\lambda t) = -a C \\exp(\\lambda t) - b C \\exp(\\lambda t) \\exp(-\\lambda \\tau)\n$$\n假设存在非平凡解 ($C \\neq 0$)，我们可以将整个方程除以 $C \\exp(\\lambda t)$ 来获得关于特征值 $\\lambda$ 的特征方程：\n$$\n\\lambda = -a - b \\exp(-\\lambda \\tau)\n$$\n重新整理得到标准形式：\n$$\n\\lambda + a + b \\exp(-\\lambda \\tau) = 0\n$$\n稳态 $\\Delta G(t) = 0$ 稳定的充要条件是所有特征根 $\\lambda$ 的实部均为负 ($\\text{Re}(\\lambda)  0$)。持续振荡的开始，即霍普夫分岔，发生在当一对共轭复数根穿过虚轴时。在这个分岔点，根的形式为 $\\lambda = \\pm i\\omega_c$，其中 $\\omega_c$ 是一个实数且非零的角频率 ($\\omega_c  0$)。\n\n我们将 $\\lambda = i\\omega_c$ 代入特征方程：\n$$\ni\\omega_c + a + b \\exp(-i\\omega_c \\tau) = 0\n$$\n使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以写出：\n$$\ni\\omega_c + a + b(\\cos(\\omega_c \\tau) - i\\sin(\\omega_c \\tau)) = 0\n$$\n为了满足这个方程，表达式的实部和虚部都必须等于零。我们将实部项和虚部项分组：\n$$\n(a + b \\cos(\\omega_c \\tau)) + i(\\omega_c - b \\sin(\\omega_c \\tau)) = 0\n$$\n这产生了一个由两个方程组成的系统：\n1. 实部：$a + b \\cos(\\omega_c \\tau) = 0 \\implies \\cos(\\omega_c \\tau) = -\\frac{a}{b}$\n2. 虚部：$\\omega_c - b \\sin(\\omega_c \\tau) = 0 \\implies \\sin(\\omega_c \\tau) = \\frac{\\omega_c}{b}$\n\n为了求解 $\\omega_c$，我们使用基本三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$，其中 $\\theta = \\omega_c \\tau$：\n$$\n\\left(-\\frac{a}{b}\\right)^2 + \\left(\\frac{\\omega_c}{b}\\right)^2 = 1\n$$\n$$\n\\frac{a^2}{b^2} + \\frac{\\omega_c^2}{b^2} = 1\n$$\n两边乘以 $b^2$，我们有 $a^2 + \\omega_c^2 = b^2$。现在我们可以解出 $\\omega_c^2$：\n$$\n\\omega_c^2 = b^2 - a^2\n$$\n为了使振荡解存在（$\\omega_c$ 必须是实数且非零），我们必须有 $\\omega_c^2  0$，这意味着 $b^2  a^2$。因为给定的 $a$ 和 $b$ 都是正数，这个条件简化为 $b  a$。因此，分岔点的振荡频率为：\n$$\n\\omega_c = \\sqrt{b^2 - a^2}\n$$\n现在我们来求临界延迟 $\\tau_{\\mathrm{crit}}$。我们有关于角度 $\\omega_c \\tau$ 的两个条件。由于 $a  0$，$b  0$ 且 $\\omega_c  0$，我们有 $\\cos(\\omega_c \\tau) = -a/b  0$ 和 $\\sin(\\omega_c \\tau) = \\omega_c/b  0$。这两个条件意味着角度 $\\omega_c \\tau$ 必须位于第二象限。\n\n从 $\\cos(\\omega_c \\tau) = -a/b$，$\\omega_c \\tau$ 的可能值由下式给出：\n$$\n\\omega_c \\tau = \\arccos\\left(-\\frac{a}{b}\\right) + 2k\\pi\n$$\n对于任意整数 $k$。$\\arccos$ 函数返回一个在 $[0, \\pi]$ 区间内的值。由于其参数 $-a/b$ 在 $-1$ 和 $0$ 之间（因为 $ba$），主值 $\\arccos(-a/b)$ 在 $(\\pi/2, \\pi]$ 区间内，这正好将其置于第二象限。满足此条件的最小正延迟 $\\tau$ 对应于 $k=0$。这个最小延迟就是临界延迟 $\\tau_{\\mathrm{crit}}$。\n$$\n\\omega_c \\tau_{\\mathrm{crit}} = \\arccos\\left(-\\frac{a}{b}\\right)\n$$\n求解 $\\tau_{\\mathrm{crit}}$ 并代入 $\\omega_c$ 的表达式，我们得到显式解析表达式：\n$$\n\\tau_{\\mathrm{crit}} = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{a}{b}\\right) = \\frac{1}{\\sqrt{b^2 - a^2}} \\arccos\\left(-\\frac{a}{b}\\right)\n$$\n现在，我们使用给定的参数 $a = 0.03 \\,\\text{min}^{-1}$ 和 $b = 0.075 \\,\\text{min}^{-1}$ 来计算 $\\tau_{\\mathrm{crit}}$ 的数值。首先，检查振荡条件：$b = 0.075  a = 0.03$，所以条件满足。\n\n振荡频率 $\\omega_c$ 是：\n$$\n\\omega_c = \\sqrt{(0.075)^2 - (0.03)^2} = \\sqrt{0.005625 - 0.0009} = \\sqrt{0.004725} \\,\\text{min}^{-1}\n$$\n反余弦函数的参数是：\n$$\n-\\frac{a}{b} = -\\frac{0.03}{0.075} = -0.4\n$$\n现在，我们可以计算 $\\tau_{\\mathrm{crit}}$：\n$$\n\\tau_{\\mathrm{crit}} = \\frac{1}{\\sqrt{0.004725}} \\arccos(-0.4) \\approx \\frac{1}{0.068738635} \\times 1.98231317 \\approx 28.84158 \\,\\text{min}\n$$\n将结果四舍五入到四位有效数字，得到 $\\tau_{\\mathrm{crit}} = 28.84 \\,\\text{min}$。\n\n对于所要求的简要评估，不稳定性出现时的振荡周期是 $T = 2\\pi/\\omega_c$。\n$$\nT = \\frac{2\\pi}{\\sqrt{0.004725}} \\approx \\frac{2\\pi}{0.068738635} \\approx 91.41 \\,\\text{min}\n$$\n这个大约 $91$ 分钟的理论周期位于观测到的 $80$ 至 $150$ 分钟的生理超日节律范围内，这表明这个最小模型尽管简单，却捕捉到了葡萄糖动力学的相关时间尺度。",
            "answer": "$$\\boxed{28.84}$$"
        },
        {
            "introduction": "时间延迟与系统非线性的相互作用方式丰富多样，有时甚至出人意料。这项实践超越了简单的振荡，探讨了在一个自激活基因模型中的双稳态 (bistability)——即两个稳定平衡点的共存。你将结合解析方法寻找系统的平衡点，并通过数值模拟来描绘它们的吸引盆 (basins of attraction)，从而获得关于初始条件和延迟如何决定一个复杂生物系统最终命运的实践经验。",
            "id": "3881514",
            "problem": "考虑一个标量延迟微分方程 (DDE) 模型，用于描述具有S型反馈和线性清除的自激活生物化学物质，这是生理调节和基因回路建模中的一个标准抽象。令 $x(t)$ 表示该物质在时间 $t$（单位为秒）的浓度，该浓度已经无量纲化，因此 $x(t)$ 是无单位的。其动力学由下式给出\n$$\n\\frac{dx}{dt}(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t),\n$$\n其中 $p \\ge 0$ 是基础生产速率，$b \\ge 0$ 是最大正反馈强度，$a  0$ 是一阶清除速率，$\\tau \\ge 0$ 是生理时间延迟。S型激活函数 $H(\\cdot)$ 是Hill函数\n$$\nH(x) = \\frac{x^n}{K^n + x^n},\n$$\n其中 $n \\ge 1$ 是Hill系数，$K  0$ 是激活阈值。除了时间 $t$（单位为秒）外，所有参数都是无量纲的，但本问题中的输出应被视为无量纲的数值。\n\n任务：\n1. 从平衡点的定义出发，证明平衡点 $x^\\ast$ 满足代数方程\n$$\na\\,x^\\ast = p + b\\,H(x^\\ast),\n$$\n并解释为什么延迟 $\\tau$ 不会进入平衡条件。然后，从DDE在平衡点 $x^\\ast$ 附近的线性化出发，推导出标量特征方程\n$$\n\\lambda + a - b\\,H'(x^\\ast)\\,e^{-\\lambda \\tau} = 0,\n$$\n并用它来获得一个仅依赖于 $a$ 和 $b\\,H'(x^\\ast)$ 而不依赖于 $\\tau$ 的局部稳定性的充分必要判据。\n\n2. 实现一个数值方法，通过求解 $a\\,x = p + b\\,H(x)$ 来找到给定参数下的所有平衡点 $x^\\ast \\ge 0$。在 $x \\in [0, x_{\\max}]$ 上使用稳健的区间法，其中 $x_{\\max}$ 足够大以包含所有交点，并在函数变号的区间内应用二分法来定位根。将平衡点按升序排序。\n\n3. 对于每个平衡点 $x^\\ast$，计算 $c^\\ast = b\\,H'(x^\\ast)$，其中\n$$\nH'(x) = \\frac{n\\,K^n\\,x^{n-1}}{\\big(K^n + x^n\\big)^2},\n$$\n并将 $x^\\ast$ 分类为局部渐近稳定当且仅当 $c^\\ast  a$；否则将其分类为不稳定。基于此分类，确定系统是否表现出双稳态（两个或更多稳定平衡点）。\n\n4. 为了在常数历史函数的子空间内近似吸引盆，使用步进法显式欧拉格式，并对延迟项使用线性插值，从多个常数历史初始化 $x(t) \\equiv x_0$（对于 $t \\in [-\\tau,0]$）来模拟DDE。使用固定的步长和足够长的仿真时域 $T$ 以使系统稳定下来。对于每个初始条件 $x_0$，通过将最终状态 $x(T)$ 分配给已排序的平衡点列表中最近的稳定平衡点来确定吸引子。如果不存在稳定平衡点，则返回吸引子索引 $-1$。\n\n5. 对于以下参数集和初始条件的测试套件，执行上述完整的分析和仿真。使用 $x_{\\max} = \\max\\{10\\,K,\\,2\\,(p+b)/a\\}$ 进行区间划分，使用至少 $10000$ 个点的均匀网格进行符号变化检测，使用 $\\Delta t = 0.01$ 秒的欧拉步长和 $T = 100$ 秒的仿真时域。对于每种情况，报告：\n   - 找到的不同平衡点的整数数量，\n   - 局部稳定平衡点的整数数量，\n   - 如果存在两个或更多稳定平衡点，则双稳态标志为 $1$，否则为 $0$，\n   - 平衡点值列表，四舍五入到六位小数，\n   - 针对给定顺序中每个初始历史的吸引子索引（整数）列表，其中索引是已排序平衡点列表中的从0开始的位置，$-1$ 表示没有稳定吸引子。\n\n测试套件：\n- 情况1：$a=0.3$, $b=6.0$, $p=0.5$, $K=1.0$, $n=10$, $\\tau=2.0$，初始常数 $[0.1,\\,0.4,\\,0.8,\\,1.2,\\,2.5,\\,5.0]$。\n- 情况2：$a=2.0$, $b=1.5$, $p=0.1$, $K=1.0$, $n=4$, $\\tau=0.5$，初始常数 $[0.05,\\,0.2,\\,0.5,\\,1.0,\\,2.0]$。\n- 情况3：$a=0.5$, $b=2.0$, $p=0.1$, $K=1.0$, $n=6$, $\\tau=1.0$，初始常数 $[0.05,\\,0.2,\\,0.5,\\,1.0,\\,2.0]$。\n- 情况4：$a=0.8$, $b=4.0$, $p=0.15$, $K=1.2$, $n=5$, $\\tau=5.0$，初始常数 $[0.1,\\,0.6,\\,1.2,\\,1.8,\\,3.0]$。\n\n最终输出格式：\n你的程序应生成单行输出，包含四个案例的结果，形式为用逗号分隔的每个案例的结果列表，并用方括号括起来。每个案例的结果列表必须采用以下格式：\n$$\n[\\text{num\\_eq},\\,\\text{num\\_stable},\\,\\text{bistable\\_flag},\\,\\text{equilibria\\_rounded},\\,\\text{attractor\\_indices}],\n$$\n其中 $\\text{equilibria\\_rounded}$ 是一个浮点数列表，$\\text{attractor\\_indices}$ 是一个允许为 $-1$ 的整数列表。例如，程序应打印类似以下内容：\n$$\n\\big[\\,[2,1,0,[0.123456,1.234567],[0,0,0,0]],\\,\\ldots\\,\\big],\n$$\n具体数值由您的计算确定。",
            "solution": "我们从基本原理出发。延迟微分方程的平衡点 $x^\\ast$ 由一个常数解 $x(t) \\equiv x^\\ast$（对于所有 $t \\in \\mathbb{R}$）定义，使得对所有 $t$，$\\frac{dx}{dt}(t) = 0$。将 $x(t) \\equiv x^\\ast$ 和 $x(t-\\tau) \\equiv x^\\ast$ 代入给定的DDE中，\n$$\n\\frac{dx}{dt}(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t),\n$$\n我们得到代数平衡条件\n$$\n0 = p + b\\,H(x^\\ast) - a\\,x^\\ast \\quad \\Leftrightarrow \\quad a\\,x^\\ast = p + b\\,H(x^\\ast).\n$$\n延迟 $\\tau$ 不进入此平衡条件，因为在平衡状态下，状态是恒定的，所以对所有 $t$ 都有 $x(t-\\tau) = x(t) = x^\\ast$，这使得延迟项与当前项坍缩为相同的常数。\n\n为评估局部稳定性，我们在平衡点 $x^\\ast$ 附近进行线性化。设 $x(t) = x^\\ast + \\eta(t)$，其中 $\\eta(t)$ 是一个小扰动。使用 $H(\\cdot)$ 在 $x^\\ast$ 附近的一阶泰勒展开，\n$$\nH\\big(x^\\ast + \\eta(t-\\tau)\\big) \\approx H(x^\\ast) + H'(x^\\ast)\\,\\eta(t-\\tau),\n$$\n并代入DDE，同时注意到平衡条件抵消了常数项，我们得到线性化的DDE\n$$\n\\eta'(t) = -a\\,\\eta(t) + b\\,H'(x^\\ast)\\,\\eta(t-\\tau).\n$$\n寻找指数解 $\\eta(t) = e^{\\lambda t}$ 得到特征方程\n$$\n\\lambda + a - b\\,H'(x^\\ast)\\,e^{-\\lambda \\tau} = 0.\n$$\n为简洁起见，记作 $c^\\ast = b\\,H'(x^\\ast)$。标量延迟线性DDE\n$$\n\\eta'(t) = -a\\,\\eta(t) + c^\\ast\\,\\eta(t-\\tau)\n$$\n有一个众所周知的稳定性分类，我们可以直接推导出来。首先，考虑实根 $\\lambda \\in \\mathbb{R}$。特征方程简化为\n$$\n\\lambda + a = c^\\ast\\,e^{-\\lambda \\tau}.\n$$\n如果 $c^\\ast  a$，则在 $\\lambda = 0$ 时，右侧为 $c^\\ast  a$，而左侧为 $a$。随着 $\\lambda$ 增加，左侧线性增加，而右侧指数减小；根据连续性和单调性，存在一个唯一的 $\\lambda  0$ 满足该方程，从而证明了正实根的存在，因此对于任何 $\\tau \\ge 0$ 都是不稳定的。如果 $c^\\ast  a$，则不存在正实数解，因为左侧在 $\\lambda = 0$ 时至少为 $a-c^*0$，对 $\\lambda  0$ 则严格更大；而右侧对 $\\lambda  0$ 则严格更小。为了检查是否有非实根穿过虚轴，设 $\\lambda = i\\omega$ 并令实部和虚部分别相等：\n$$\ni\\omega + a - c^\\ast\\big(\\cos(\\omega \\tau) - i\\sin(\\omega \\tau)\\big) = 0 \\\\\n\\Rightarrow \\quad a - c^\\ast\\cos(\\omega \\tau) = 0, \\quad \\omega + c^\\ast\\sin(\\omega \\tau) = 0.\n$$\n平方相加得到\n$$\na^2 + \\omega^2 = (c^\\ast)^2,\n$$\n所以，只有当 $(c^\\ast)^2 - a^2  0$，即 $c^\\ast  a$ (因为$c^* \\ge 0$)时，才存在非零的实数 $\\omega$。当 $c^\\ast  a$ 时，没有穿越虚轴的情况，结合实根分析，可以证明对于所有 $\\tau \\ge 0$，平衡点是局部渐近稳定的。反之，当 $c^\\ast  a$ 时，对于所有 $\\tau \\ge 0$，平衡点是局部不稳定的。因此，局部渐近稳定性的充分必要条件是\n$$\n\\text{稳定} \\iff c^\\ast = b\\,H'(x^\\ast)  a,\n$$\n这个条件只依赖于 $a$ 和 $b\\,H'(x^\\ast)$，而不依赖于延迟 $\\tau$。\n\nHill函数 $H(x) = \\frac{x^n}{K^n+x^n}$ 对于 $n1$ 是单调递增且呈S型的，其导数\n$$\nH'(x) = \\frac{n\\,K^n\\,x^{n-1}}{(K^n + x^n)^2}\n$$\n是单峰的，在 $x=K$ 附近有最大值。平衡条件 $a\\,x = p + b\\,H(x)$ 将一条直线与一个有界、单调递增的S型函数等同起来。对于足够大的 $n$ 和 $b$，S型函数的斜率在中心区域超过直线的斜率，导致差值函数 $f(x) = a\\,x - p - b\\,H(x)$ 有两个临界点（一个局部最大值和一个局部最小值）和最多三个与零的交点，对应于中间一个不稳定的平衡点（其中 $c^\\ast$ 较大）和在较低及较高浓度处的两个稳定平衡点（其中 $c^\\ast$ 较小）。这产生了双稳态：由一个不稳定平衡点分隔的两个吸引盆。\n\n算法设计：\n- 平衡点计算：定义 $f(x) = a\\,x - p - b\\,H(x)$。选择 $x_{\\max} = \\max\\{10K,\\,2(p+b)/a\\}$ 以确保线性项超过饱和的右侧项。在 $[0, x_{\\max}]$ 上的密集网格上对 $f(x)$ 进行采样。识别 $f(x)$ 改变符号的子区间。在每个区间内应用二分法寻找根。将不同的根按升序排序，并通过一个小的容差过滤掉重复的根。\n- 稳定性分类：对于每个平衡点 $x^\\ast$，评估 $H'(x^\\ast)$ 并计算 $c^\\ast = b\\,H'(x^\\ast)$。如果 $c^\\ast  a$，则声明 $x^\\ast$ 稳定，否则为不稳定。\n- 用于吸引盆的DDE仿真：对于每个初始常数历史 $x(t) \\equiv x_0$（在 $[-\\tau, 0]$ 上），使用步进法欧拉格式，时间步长为 $\\Delta t$，并对 $x(t-\\tau)$ 使用线性插值来模拟\n$$\nx'(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t)\n$$\n当 $t-\\tau \\le 0$ 时，设 $x(t-\\tau) = x_0$。对于 $t \\ge 0$，保留 $(t, x(t))$ 的记录以插值延迟值。积分至时域 $T$。通过选择最接近 $x(T)$ 的稳定平衡点来分配吸引子索引；如果没有稳定平衡点，则分配 $-1$。\n- 输出：对于每种情况，输出列表 $[\\text{num\\_eq},\\,\\text{num\\_stable},\\,\\text{bistable\\_flag},\\,\\text{equilibria\\_rounded},\\,\\text{attractor\\_indices}]$，并将所有案例的结果聚合为单行打印的列表，如指定格式。\n\n科学真实性考量：\n- 所选的DDE是具有生理延迟（例如，转录-翻译机制或激素信号回路）的自激活的标准模型。\n- Hill函数及其导数是经过充分检验的用于协同结合与激活的抽象。\n- 稳定性判据源自标量延迟DDE的特征方程，不依赖于快捷公式。它正确地表明，对于此类模型，局部稳定性与延迟 $\\tau$ 无关，尽管延迟的存在会影响瞬态动力学和吸引盆的无限维性质。双稳态源于非线性S型反馈，并在延迟设置中持续存在；在这种标量情况下，延迟不会创造新的稳定平衡点，但可以影响轨迹到达平衡点的路径。",
            "answer": "```\n[[3,2,1,[0.893126,1.13406,21.666617],[0,0,2,2,2,2]],[1,1,0,[0.106209],[0,0,0,0,0]],[3,2,1,[0.201736,0.727514,4.19524],[0,0,2,2,2]],[3,2,1,[0.191783,0.957519,5.183427],[0,0,2,2,2]]]\n```"
        }
    ]
}