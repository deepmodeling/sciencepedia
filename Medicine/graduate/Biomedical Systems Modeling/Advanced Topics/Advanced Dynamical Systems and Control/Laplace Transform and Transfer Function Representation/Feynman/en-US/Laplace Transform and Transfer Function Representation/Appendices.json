{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing many biomedical systems is translating their physical description into a mathematical model amenable to control theory. This practice  provides a foundational exercise in this process, starting with a simple mass-balance ordinary differential equation for a single-compartment pharmacokinetic model. By applying the Laplace transform, you will derive the system's transfer function, a compact representation that is essential for frequency-domain analysis and design.",
            "id": "3895697",
            "problem": "A single-compartment pharmacokinetic model for an intravenous infusion with first-order elimination is described by a linear mass balance. The compartment concentration $c(t)$ changes according to the difference between the input rate and the first-order elimination. Assume a homogeneous and well-mixed compartment and linear elimination kinetics characterized by a positive rate constant $k0$. Let $u(t)$ denote the externally applied input rate (with units consistent so that both sides of the differential equation match). The governing ordinary differential equation is\n$$\n\\frac{dc(t)}{dt}=-k\\,c(t)+u(t).\n$$\nUsing the unilateral Laplace transform defined by\n$$\n\\mathcal{L}\\{x(t)\\}(s)=\\int_{0^-}^{\\infty} x(t)\\,\\exp(-s t)\\,dt,\n$$\ntreat the system as linear time-invariant (LTI) and assume zero initial condition $c(0^-)=0$. Derive from first principles the transfer function $G(s)$ that maps the input rate $u(t)$ to the concentration $c(t)$, where $G(s)$ is defined as the ratio $C(s)/U(s)$ under zero initial condition. Then, identify the pole of $G(s)$ by determining the value of $s$ at which its denominator is zero. Express your final answer as closed-form analytic expressions. No numerical approximation is required. Provide both the transfer function and the pole as your answer. Do not include units in your final expressions.",
            "solution": "The problem presents a first-order linear ordinary differential equation (ODE) that models a single-compartment pharmacokinetic system. The governing equation is given as:\n$$\n\\frac{dc(t)}{dt}=-k\\,c(t)+u(t)\n$$\nHere, $c(t)$ represents the concentration in the compartment, $u(t)$ is the input rate, and $k$ is a positive constant ($k0$) representing the rate of first-order elimination. The system is to be treated as linear time-invariant (LTI), and the initial condition is specified as zero, i.e., $c(0^-)=0$. The objective is to derive the transfer function $G(s)$ that maps the input $U(s)$ to the output $C(s)$, and to identify the pole of this transfer function. The transfer function is defined as $G(s) = \\frac{C(s)}{U(s)}$ under zero initial conditions, where $C(s)$ and $U(s)$ are the unilateral Laplace transforms of $c(t)$ and $u(t)$, respectively.\n\nThe derivation proceeds by applying the unilateral Laplace transform, denoted by $\\mathcal{L}\\{\\cdot\\}$, to both sides of the governing ODE.\n$$\n\\mathcal{L}\\left\\{\\frac{dc(t)}{dt}\\right\\}(s) = \\mathcal{L}\\{-k\\,c(t)+u(t)\\}(s)\n$$\nBy the linearity property of the Laplace transform, the right-hand side can be written as:\n$$\n\\mathcal{L}\\{-k\\,c(t)+u(t)\\}(s) = -k\\,\\mathcal{L}\\{c(t)\\}(s) + \\mathcal{L}\\{u(t)\\}(s)\n$$\nLet us denote the Laplace transform of $c(t)$ as $C(s)$ and the Laplace transform of $u(t)$ as $U(s)$. The equation becomes:\n$$\n\\mathcal{L}\\left\\{\\frac{dc(t)}{dt}\\right\\}(s) = -k\\,C(s) + U(s)\n$$\nNow, we apply the differentiation property of the unilateral Laplace transform to the left-hand side:\n$$\n\\mathcal{L}\\left\\{\\frac{df(t)}{dt}\\right\\}(s) = s\\,F(s) - f(0^-)\n$$\nApplying this property to our function $c(t)$, we get:\n$$\n\\mathcal{L}\\left\\{\\frac{dc(t)}{dt}\\right\\}(s) = s\\,C(s) - c(0^-)\n$$\nThe problem states that the system has a zero initial condition, $c(0^-)=0$. Substituting this into the expression gives:\n$$\n\\mathcal{L}\\left\\{\\frac{dc(t)}{dt}\\right\\}(s) = s\\,C(s)\n$$\nNow, we substitute this result back into the transformed ODE:\n$$\ns\\,C(s) = -k\\,C(s) + U(s)\n$$\nTo find the transfer function $G(s) = \\frac{C(s)}{U(s)}$, we rearrange the equation algebraically to isolate the terms with $C(s)$ on one side.\n$$\ns\\,C(s) + k\\,C(s) = U(s)\n$$\nFactoring out $C(s)$ from the left-hand side yields:\n$$\nC(s)(s+k) = U(s)\n$$\nFinally, dividing both sides by $U(s)$ and by $(s+k)$, we obtain the expression for the transfer function $G(s)$:\n$$\nG(s) = \\frac{C(s)}{U(s)} = \\frac{1}{s+k}\n$$\nThis is the first part of the required answer.\n\nThe second part of the task is to identify the pole of the transfer function $G(s)$. A pole of a transfer function is a value of the complex variable $s$ at which the denominator of the function becomes zero. For the transfer function $G(s) = \\frac{1}{s+k}$, the denominator is the polynomial $s+k$.\nTo find the pole, we set the denominator to zero and solve for $s$:\n$$\ns+k = 0\n$$\nSolving for $s$ gives:\n$$\ns = -k\n$$\nSince the problem states that $k0$, the pole is a single, real, and negative value. This confirms the system is stable, as all poles lie in the open left-half of the complex plane.\n\nThe two required results are the transfer function $G(s)$ and its pole.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{s+k}  -k \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While a transfer function describes the input-output relationship, the state-space representation provides a more detailed internal view of a system's dynamics. This exercise  explores the vital connection between these two formalisms through the lens of controllability and observability. You will discover how these properties determine whether a state-space model is 'minimal' and see how uncontrollable or unobservable dynamics manifest as pole-zero cancellations in the transfer function.",
            "id": "3895671",
            "problem": "A linearized three-compartment cardiovascular model around a steady operating point is given by the continuous-time state equations for arterial pressure deviation, venous pressure deviation, and a slow compliance reservoir:\n$$\n\\dot{x}(t) = A\\,x(t) + B\\,u(t), \\quad y(t) = C\\,x(t) + D\\,u(t),\n$$\nwhere $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\\\ x_{3}(t) \\end{pmatrix}$, $u(t)$ is the left-ventricular inflow deviation, and $y(t)$ is the measured arterial pressure deviation. The matrices are\n$$\nA = \\begin{pmatrix}\n- a_{1}  a_{2}  0 \\\\\nb_{1}  - b_{2}  0 \\\\\n0  0  - k\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\nb_{u} \\\\ c_{u} \\\\ 0\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n1  0  0\n\\end{pmatrix}, \\quad\nD = 0,\n$$\nwith constants satisfying $a_{1}  0$, $a_{2}  0$, $b_{1}  0$, $b_{2}  0$, $k  0$, $b_{u}  0$, and $c_{u}  0$, reflecting outflow and coupling between arterial and venous compartments, and a slow compliance reservoir that does not directly receive input or appear in the output.\n\nUsing foundational definitions from linear systems and the unilateral Laplace transform, perform the following:\n\n1. Starting from the definition of state controllability, construct the controllability matrix and determine its rank for the given $A$ and $B$. Conclude whether the realization is controllable.\n2. Starting from the definition of state observability, construct the observability matrix and determine its rank for the given $A$ and $C$. Conclude whether the realization is observable.\n3. Explain, from first principles, how controllability and observability relate to minimality of a transfer function $G(s)$ that maps $u(t)$ to $y(t)$.\n4. Assuming zero initial conditions and using the unilateral Laplace transform definition, derive the transfer function $G(s)$ from $u(t)$ to $y(t)$ and reduce it to the minimal transfer function $G_{\\min}(s)$ by eliminating any dynamics that are neither controllable nor observable.\n\nYour final answer must be a single closed-form analytic expression for $G_{\\min}(s)$ in terms of the parameters $a_{1}$, $a_{2}$, $b_{1}$, $b_{2}$, $k$, $b_{u}$, and $c_{u}$. No rounding is required and no physical units should be included in the final expression.",
            "solution": "The problem provides a linearized three-compartment state-space model of a cardiovascular system and asks for an analysis of its properties—controllability, observability, and minimality—culminating in the derivation of the minimal transfer function.\n\n**1. Controllability Analysis**\nThe state-space system has dimension $n=3$. A system is controllable if its controllability matrix $\\mathcal{C}$ has full rank, i.e., $\\text{rank}(\\mathcal{C}) = n$. The controllability matrix is defined as:\n$$\n\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}\n$$\nFirst, we compute the matrix products $AB$ and $A^2B$.\n$$\nAB = \\begin{pmatrix}\n- a_{1}  a_{2}  0 \\\\\nb_{1}  - b_{2}  0 \\\\\n0  0  -k\n\\end{pmatrix}\n\\begin{pmatrix}\nb_{u} \\\\\nc_{u} \\\\\n0\n\\end{pmatrix} =\n\\begin{pmatrix}\n-a_{1}b_{u} + a_{2}c_{u} \\\\\nb_{1}b_{u} - b_{2}c_{u} \\\\\n0\n\\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix}\n- a_{1}  a_{2}  0 \\\\\nb_{1}  - b_{2}  0 \\\\\n0  0  -k\n\\end{pmatrix}\n\\begin{pmatrix}\n-a_{1}b_{u} + a_{2}c_{u} \\\\\nb_{1}b_{u} - b_{2}c_{u} \\\\\n0\n\\end{pmatrix} =\n\\begin{pmatrix}\n-a_{1}(-a_{1}b_{u} + a_{2}c_{u}) + a_{2}(b_{1}b_{u} - b_{2}c_{u}) \\\\\nb_{1}(-a_{1}b_{u} + a_{2}c_{u}) - b_{2}(b_{1}b_{u} - b_{2}c_{u}) \\\\\n0\n\\end{pmatrix}\n$$\nThe controllability matrix $\\mathcal{C}$ is thus:\n$$\n\\mathcal{C} = \\begin{pmatrix}\nb_{u}  -a_{1}b_{u} + a_{2}c_{u}  (a_{1}^2+a_{2}b_{1})b_{u} - (a_{1}a_{2}+a_{2}b_{2})c_{u} \\\\\nc_{u}  b_{1}b_{u} - b_{2}c_{u}  (-a_{1}b_{1}-b_{1}b_{2})b_{u} + (a_{2}b_{1}+b_{2}^2)c_{u} \\\\\n0  0  0\n\\end{pmatrix}\n$$\nThe third row of $\\mathcal{C}$ is a zero vector. This implies that the three column vectors of $\\mathcal{C}$ are linearly dependent and lie in a plane, specifically the $x_1$-$x_2$ plane. Therefore, the rank of the matrix $\\mathcal{C}$ must be less than $3$.\n$$\n\\text{rank}(\\mathcal{C}) \\le 2  3\n$$\nSince the controllability matrix is not full rank, the realization is **not controllable**. The state $x_3(t)$, corresponding to the slow compliance reservoir, cannot be influenced by the input $u(t)$. This is evident from the system equation $\\dot{x}_{3}(t) = -k x_{3}(t)$, which is decoupled from the input $u(t)$.\n\n**2. Observability Analysis**\nA system is observable if its observability matrix $\\mathcal{O}$ has full rank, i.e., $\\text{rank}(\\mathcal{O}) = n$. The observability matrix is defined as:\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}\n$$\nFirst, we compute the matrix products $CA$ and $CA^2$.\n$$\nC = \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n$$\n$$\nCA = \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n\\begin{pmatrix}\n- a_{1}  a_{2}  0 \\\\\nb_{1}  - b_{2}  0 \\\\\n0  0  -k\n\\end{pmatrix} =\n\\begin{pmatrix} -a_{1}  a_{2}  0 \\end{pmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{pmatrix} -a_{1}  a_{2}  0 \\end{pmatrix}\n\\begin{pmatrix}\n- a_{1}  a_{2}  0 \\\\\nb_{1}  - b_{2}  0 \\\\\n0  0  -k\n\\end{pmatrix} =\n\\begin{pmatrix} a_{1}^2+a_{2}b_{1}  -a_{1}a_{2}-a_{2}b_{2}  0 \\end{pmatrix}\n$$\nThe observability matrix $\\mathcal{O}$ is thus:\n$$\n\\mathcal{O} = \\begin{pmatrix}\n1  0  0 \\\\\n-a_{1}  a_{2}  0 \\\\\na_{1}^2+a_{2}b_{1}  -a_{1}a_{2}-a_{2}b_{2}  0\n\\end{pmatrix}\n$$\nThe third column of $\\mathcal{O}$ is a zero vector. This implies that the three row vectors of $\\mathcal{O}$ are linearly dependent. Therefore, the rank of the matrix $\\mathcal{O}$ must be less than $3$. The determinant of this $3 \\times 3$ matrix is clearly $0$.\n$$\n\\text{rank}(\\mathcal{O}) \\le 2  3\n$$\nSince the observability matrix is not full rank, the realization is **not observable**. The state $x_3(t)$ does not affect the output $y(t) = x_1(t)$. This is evident from the output equation itself.\n\n**3. Controllability, Observability, and Minimality**\nA state-space realization $\\{A, B, C, D\\}$ of order $n$ is defined as **minimal** if it has the smallest possible state dimension $n$ that can produce a given input-output transfer function $G(s)$. A fundamental theorem of linear systems theory states that a realization is minimal if and only if it is both completely controllable and completely observable.\n\n- **Controllability** relates to whether the system's states can be influenced by the input $u(t)$. An uncontrollable state or mode evolves according to its own dynamics, independent of any control action. In the transfer function, this corresponds to a pole of the system that is cancelled by a zero, making that dynamic mode \"disappear\" from the input-output relationship.\n- **Observability** relates to whether the system's states can be inferred from the output $y(t)$. An unobservable state or mode evolves without any effect on the measured output. In the transfer function, this also corresponds to a pole that is cancelled by a zero, making that dynamic mode \"hidden\" from the output.\n\nThe Kalman decomposition theorem shows that any linear time-invariant system's state space can be decomposed into four mutually exclusive subspaces: (1) controllable and observable, (2) controllable but unobservable, (3) uncontrollable but observable, and (4) uncontrollable and unobservable. The transfer function $G(s)$ only captures the dynamics of the controllable and observable subspace. Therefore, if a system is not controllable or not observable, its state-space representation is non-minimal, and its transfer function will contain pole-zero cancellations. The minimal realization corresponds to the system description after these cancellations are performed.\n\n**4. Transfer Function Derivation and Minimization**\nThe transfer function $G(s)$ for a linear time-invariant system with zero initial conditions is given by the formula:\n$$\nG(s) = Y(s)/U(s) = C(sI - A)^{-1}B + D\n$$\nGiven $D=0$, we need to compute $C(sI - A)^{-1}B$.\nFirst, we find the matrix $(sI - A)$:\n$$\nsI - A = \\begin{pmatrix} s+a_{1}  -a_{2}  0 \\\\ -b_{1}  s+b_{2}  0 \\\\ 0  0  s+k \\end{pmatrix}\n$$\nNext, we compute the inverse, $(sI - A)^{-1} = \\frac{1}{\\det(sI-A)}\\text{adj}(sI-A)$. The determinant is found by cofactor expansion along the third row:\n$$\n\\det(sI - A) = (s+k) \\det \\begin{pmatrix} s+a_{1}  -a_{2} \\\\ -b_{1}  s+b_{2} \\end{pmatrix} = (s+k)[(s+a_{1})(s+b_{2}) - a_{2}b_{1}]\n$$\n$$\n\\det(sI - A) = (s+k)[s^2 + (a_1+b_2)s + a_{1}b_{2} - a_{2}b_{1}]\n$$\nNow we compute the product $C \\cdot \\text{adj}(sI-A) \\cdot B$. We only need the $(1,1)$, $(1,2)$, and $(1,3)$ elements of the adjugate matrix, which are the cofactors $C_{11}$, $C_{21}$, and $C_{31}$ of $(sI-A)^T$. The needed cofactors of $(sI-A)$ are:\n$C_{11} = (s+b_2)(s+k)$\n$C_{12} = -(-b_1)(s+k) = b_1(s+k)$\nThus the first row of the adjugate matrix is $\\begin{pmatrix} (s+b_2)(s+k)  a_2(s+k)  0 \\end{pmatrix}$.\nThe calculation proceeds as:\n$$\nY(s) = C(sI-A)^{-1}B U(s) = \\frac{1}{\\det(sI-A)} C \\cdot \\text{adj}(sI-A) \\cdot B \\cdot U(s)\n$$\n$$\nC \\cdot \\text{adj}(sI-A) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} (s+b_2)(s+k)  a_2(s+k)  0 \\\\ b_1(s+k)  (s+a_1)(s+k)  0 \\\\ \\dots  \\dots  \\dots \\end{pmatrix} = \\begin{pmatrix} (s+b_2)(s+k)  a_2(s+k)  0 \\end{pmatrix}\n$$\n$$\n[C \\cdot \\text{adj}(sI-A)] \\cdot B = \\begin{pmatrix} (s+b_2)(s+k)  a_2(s+k)  0 \\end{pmatrix} \\begin{pmatrix} b_{u} \\\\ c_{u} \\\\ 0 \\end{pmatrix}\n$$\n$$\n= b_u(s+b_2)(s+k) + c_u a_2(s+k) = (s+k)[b_u(s+b_2) + c_u a_2] = (s+k)[b_u s + b_u b_2 + c_u a_2]\n$$\nThe full transfer function is:\n$$\nG(s) = \\frac{(s+k)[b_u s + b_u b_2 + c_u a_2]}{(s+k)[s^2 + (a_1+b_2)s + a_{1}b_{2} - a_{2}b_{1}]}\n$$\nAs predicted by the controllability and observability analysis, the mode associated with the eigenvalue $\\lambda = -k$ (the pole at $s = -k$) is both uncontrollable and unobservable. This manifests as a pole-zero cancellation of the term $(s+k)$. To obtain the minimal transfer function $G_{\\min}(s)$, which describes the controllable and observable dynamics, we cancel this common factor:\n$$\nG_{\\min}(s) = \\frac{b_u s + b_u b_2 + c_u a_2}{s^2 + (a_1+b_2)s + a_1 b_2 - a_2 b_1}\n$$\nThis second-order transfer function represents the minimal realization of the system, corresponding to the dynamics of the states $x_1$ and $x_2$.",
            "answer": "$$\\boxed{\\frac{b_{u}s + b_{u}b_{2} + a_{2}c_{u}}{s^2 + (a_{1} + b_{2})s + a_{1}b_{2} - a_{2}b_{1}}}$$"
        },
        {
            "introduction": "A ubiquitous challenge in modeling biomedical processes is accounting for pure time delays, which arise from transport phenomena or sensing lags. This practice  delves into the stability analysis of such systems, a task complicated by the transcendental nature of the delay term $\\exp(-s \\tau)$. You will learn to apply Padé approximations to create a rational transfer function, enabling the use of the Routh-Hurwitz criterion to determine stability bounds for a feedback-controlled drug infusion system.",
            "id": "3895698",
            "problem": "A closed-loop vasoactive drug infusion system is modeled around a steady operating point using linear time-invariant transfer functions. The drug effect dynamics on arterial pressure are approximated by a single-compartment linear process with transfer function $G(s) = \\frac{\\alpha}{s + \\beta}$, where $\\alpha  0$ represents the steady-state sensitivity and $\\beta  0$ represents the inverse of the time constant. The feedback controller is purely proportional with gain $K  0$, and the loop includes a pure physiological delay of duration $\\tau  0$ in the feedback path due to actuation and sensing.\n\nStarting from first principles of the Laplace transform, model the delay as $\\exp(-s \\tau)$ in the loop. Form the closed-loop characteristic equation from the loop transfer representation and analyze stability using the Routh–Hurwitz criterion applied to rational, finite-dimensional approximations of the delay obtained via Padé approximation. In particular:\n\n1. Use a first-order Padé approximation of the delay and derive the resulting polynomial characteristic equation. Apply the Routh–Hurwitz test to find the largest proportional gain $K$ that guarantees closed-loop stability.\n\n2. Use a second-order Padé approximation of the delay and derive the resulting polynomial characteristic equation. Apply the Routh–Hurwitz test to find the largest proportional gain $K$ that guarantees closed-loop stability.\n\nExplain, in terms of the Routh–Hurwitz conditions, how increasing the Padé approximation order changes the stability verdict for this loop.\n\nFor numerical evaluation, use $\\alpha = 1$, $\\beta = 1$, and $\\tau = 1$. Express the final gain bounds as exact values (do not round), and report them as a row matrix in the order “first-order Padé bound, second-order Padé bound.” The gain is dimensionless; express your answer as dimensionless numbers.",
            "solution": "The problem requires an analysis of the stability of a closed-loop drug infusion system. The system consists of a plant with transfer function $G(s)$, a proportional controller with gain $K$, and a pure time delay $\\tau$ in the feedback loop.\n\nThe plant transfer function is given by $G(s) = \\frac{\\alpha}{s + \\beta}$. The controller is $C(s) = K$. The time delay is modeled by the transfer function $D(s) = \\exp(-s \\tau)$. The loop transfer function for this negative feedback system is $L(s) = C(s)G(s)D(s)$.\n$$L(s) = \\frac{K \\alpha \\exp(-s \\tau)}{s + \\beta}$$\nThe closed-loop characteristic equation is given by $1 + L(s) = 0$.\n$$1 + \\frac{K \\alpha \\exp(-s \\tau)}{s + \\beta} = 0$$\nMultiplying by $s + \\beta$ gives:\n$$s + \\beta + K \\alpha \\exp(-s \\tau) = 0$$\nThis is a transcendental equation due to the $\\exp(-s \\tau)$ term. To use the Routh-Hurwitz criterion, we must first approximate this term with a rational polynomial function using Padé approximations. The numerical values provided are $\\alpha = 1$, $\\beta = 1$, and $\\tau = 1$. The problem also states that $K  0$ and $\\tau  0$.\nSubstituting the numerical values, the characteristic equation becomes:\n$$s + 1 + K \\exp(-s) = 0$$\n\nThe $[n, n]$ Padé approximant for $\\exp(-x)$ is given by $R_{n,n}(x) = \\frac{P_n(-x)}{P_n(x)}$, where $P_n(x)$ is a polynomial.\nFor $n=1$, the first-order Padé approximation of $\\exp(-s\\tau)$ is:\n$$R_{1,1}(s\\tau) = \\frac{1 - \\frac{s\\tau}{2}}{1 + \\frac{s\\tau}{2}}$$\nFor $n=2$, the second-order Padé approximation of $\\exp(-s\\tau)$ is:\n$$R_{2,2}(s\\tau) = \\frac{1 - \\frac{s\\tau}{2} + \\frac{(s\\tau)^2}{12}}{1 + \\frac{s\\tau}{2} + \\frac{(s\\tau)^2}{12}}$$\n\nWith $\\tau=1$, these become:\n$$R_{1,1}(s) = \\frac{2-s}{2+s}$$\n$$R_{2,2}(s) = \\frac{s^2 - 6s + 12}{s^2 + 6s + 12}$$\n\n1. First-Order Padé Approximation Analysis\n\nWe substitute the first-order approximation $R_{1,1}(s)$ into the characteristic equation:\n$$s + 1 + K \\left(\\frac{2-s}{2+s}\\right) = 0$$\nTo form a polynomial, we multiply the entire equation by $(2+s)$, assuming $s \\neq -2$:\n$$(s+1)(s+2) + K(2-s) = 0$$\n$$s^2 + 3s + 2 + 2K - Ks = 0$$\n$$s^2 + (3-K)s + (2+2K) = 0$$\nThis is a second-order polynomial characteristic equation of the form $a_2 s^2 + a_1 s + a_0 = 0$, with coefficients:\n$a_2 = 1$\n$a_1 = 3-K$\n$a_0 = 2+2K$\nFor a second-order system, the Routh-Hurwitz stability criterion requires that all coefficients have the same sign. Since $a_2 = 1  0$, we must have $a_1  0$ and $a_0  0$.\nThe condition $a_1  0$ implies:\n$$3-K  0 \\implies K  3$$\nThe condition $a_0  0$ implies:\n$$2+2K  0 \\implies 2K  -2 \\implies K  -1$$\nThe problem statement specifies that the gain $K  0$. Combining all conditions ($K  0$, $K  -1$, and $K  3$), we find the range for stability to be $0  K  3$.\nThe largest proportional gain for stability under the first-order approximation is $K=3$.\n\n2. Second-Order Padé Approximation Analysis\n\nNext, we substitute the second-order approximation $R_{2,2}(s)$ into the characteristic equation:\n$$s + 1 + K \\left(\\frac{s^2 - 6s + 12}{s^2 + 6s + 12}\\right) = 0$$\nMultiply by $(s^2 + 6s + 12)$ to clear the denominator:\n$$(s+1)(s^2 + 6s + 12) + K(s^2 - 6s + 12) = 0$$\n$$s^3 + 6s^2 + 12s + s^2 + 6s + 12 + Ks^2 - 6Ks + 12K = 0$$\n$$s^3 + (7+K)s^2 + (18 - 6K)s + (12 + 12K) = 0$$\nThis is a third-order polynomial characteristic equation $a_3 s^3 + a_2 s^2 + a_1 s + a_0 = 0$, with coefficients:\n$a_3 = 1$\n$a_2 = 7+K$\n$a_1 = 18 - 6K$\n$a_0 = 12 + 12K$\nThe Routh-Hurwitz conditions for a third-order system are:\n(i) All coefficients must be positive.\n$a_3 = 1  0$ is always true.\n$a_2 = 7+K  0 \\implies K  -7$. Since $K0$ is given, this is satisfied.\n$a_1 = 18 - 6K  0 \\implies 18  6K \\implies K  3$.\n$a_0 = 12 + 12K  0 \\implies K  -1$. Since $K0$ is given, this is satisfied.\nFrom these conditions, we have $0  K  3$.\n\n(ii) The main stability criterion from the Routh array: $a_2 a_1 - a_3 a_0  0$.\n$$(7+K)(18 - 6K) - (1)(12 + 12K)  0$$\n$$126 - 42K + 18K - 6K^2 - 12 - 12K  0$$\n$$-6K^2 - 36K + 114  0$$\nDivide by $-6$ and reverse the inequality sign:\n$$K^2 + 6K - 19  0$$\nTo find the range of $K$ that satisfies this inequality, we find the roots of the quadratic equation $K^2 + 6K - 19 = 0$ using the quadratic formula $K = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$K = \\frac{-6 \\pm \\sqrt{6^2 - 4(1)(-19)}}{2(1)} = \\frac{-6 \\pm \\sqrt{36 + 76}}{2} = \\frac{-6 \\pm \\sqrt{112}}{2}$$\nSince $112 = 16 \\times 7$, $\\sqrt{112} = 4\\sqrt{7}$.\n$$K = \\frac{-6 \\pm 4\\sqrt{7}}{2} = -3 \\pm 2\\sqrt{7}$$\nThe quadratic $K^2 + 6K - 19$ is a parabola opening upwards, so it is negative between its roots. The inequality is satisfied for:\n$$-3 - 2\\sqrt{7}  K  -3 + 2\\sqrt{7}$$\nWe must satisfy all conditions simultaneously: $K  0$, $K  3$, and $-3 - 2\\sqrt{7}  K  -3 + 2\\sqrt{7}$.\nSince $\\sqrt{7} \\approx 2.645$, the second root is $-3 + 2\\sqrt{7} \\approx -3 + 5.29 = 2.29$. This value is less than $3$. The first root is clearly negative.\nThe intersection of the conditions is $0  K  -3 + 2\\sqrt{7}$.\nTherefore, the largest proportional gain for stability under the second-order approximation is $K = -3 + 2\\sqrt{7}$.\n\nExplanation of Change in Stability Verdict\n\nIncreasing the order of the Padé approximation from first to second increases the order of the resulting polynomial characteristic equation from $2$ to $3$. This has a profound effect on the stability analysis via the Routh-Hurwitz criterion.\nFor the second-order polynomial, stability simply requires all coefficients to be positive. The limiting condition was $a_1 = 3-K  0$, leading to $K  3$.\nFor the third-order polynomial, stability requires not only that all coefficients are positive but also that an additional, more stringent condition, $a_2 a_1  a_3 a_0$, is met. This condition captures the interaction between the system's dynamics (represented by coefficients $a_1, a_2$) and its steady-state behavior (related to $a_0$), which is crucial for stability in systems of order $3$ and higher. The new condition, which reduced to $K^2 + 6K - 19  0$, imposed a tighter upper bound on $K$ (around $2.29$) than the positivity condition ($K  3$) alone.\n\nThis mathematical change reflects a more accurate physical modeling of the time delay. A pure time delay introduces a phase lag that increases linearly and unboundedly with frequency ($\\phi(\\omega) = -\\omega\\tau$). This phase lag is the primary source of instability. A first-order Padé approximation only accurately models this phase\nlag at very low frequencies and its phase is bounded at $-\\pi$. A second-order Padé approximation provides a better phase match over a wider frequency range and its phase is bounded at $-2\\pi$. By more accurately capturing the destabilizing phase lag of the true delay element, the higher-order approximation yields a more realistic (and more restrictive) stability bound. The Routh-Hurwitz criterion, when applied to this more faithful polynomial model, naturally reflects this increased propensity for instability by imposing stronger constraints, leading to a smaller maximum stable gain $K$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 3  -3+2\\sqrt{7} \\end{pmatrix}}$$"
        }
    ]
}