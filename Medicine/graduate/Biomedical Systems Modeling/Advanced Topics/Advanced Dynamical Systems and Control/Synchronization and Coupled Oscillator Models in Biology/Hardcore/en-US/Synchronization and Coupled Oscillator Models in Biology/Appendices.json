{
    "hands_on_practices": [
        {
            "introduction": "Understanding synchronization begins with its simplest form: the interaction between two oscillators. Through a powerful mathematical technique known as phase reduction, the complex dynamics of many biological oscillators can be simplified to an equation governing their phase difference. This exercise  provides foundational practice with the resulting canonical model, the Adler equation. By analyzing this equation from first principles, you will determine the conditions required for two oscillators to achieve a stable phase-locked state and calculate their precise phase relationship.",
            "id": "3934528",
            "problem": "Consider a pair of weakly coupled, self-sustained biological oscillators (for example, two interacting circadian neurons) with phases $\\theta_{1}(t)$ and $\\theta_{2}(t)$ and natural angular frequencies $\\omega_{1}$ and $\\omega_{2}$. Under standard phase reduction and averaging for weak coupling, the phase difference $\\phi(t) \\equiv \\theta_{1}(t) - \\theta_{2}(t)$ evolves according to the reduced Adler–Kuramoto-type dynamics\n$$\n\\dot{\\phi} = \\Delta \\omega - K \\sin \\phi,\n$$\nwhere $\\Delta \\omega \\equiv \\omega_{1} - \\omega_{2}$ and $K  0$ represents the effective coupling gain arising from the interaction function and coupling strength. Using only the definitions of steady state and linear stability based on Taylor expansion of the right-hand side about an equilibrium, derive from first principles the general steady-state phase differences and their stability in terms of $\\Delta \\omega$ and $K$, and identify the condition under which a stable phase-locked equilibrium exists. Then, for the parameter values $\\Delta \\omega = 0.8$ radians per second and $K = 1.2$ radians per second, compute the stable steady-state phase difference $\\phi^{\\ast}$ in radians. State which oscillator leads in the phase-locked state in terms of $\\phi^{\\ast}$ and the sign of $\\Delta \\omega$. Express the final phase difference in radians, and round your answer to four significant figures. The answer must be reported in radians. Do not include units in the final boxed answer.",
            "solution": "The user has provided a problem statement that requires validation before a solution can be produced.\n\n### Step 1: Extract Givens\n- **Model:** A pair of weakly coupled, self-sustained biological oscillators.\n- **Variables:** Oscillator phases $\\theta_{1}(t)$ and $\\theta_{2}(t)$. Natural angular frequencies $\\omega_{1}$ and $\\omega_{2}$.\n- **Phase Difference:** $\\phi(t) \\equiv \\theta_{1}(t) - \\theta_{2}(t)$.\n- **Dynamical Equation:** $\\dot{\\phi} = \\Delta \\omega - K \\sin \\phi$.\n- **Definitions:** Frequency detuning $\\Delta \\omega \\equiv \\omega_{1} - \\omega_{2}$. Effective coupling gain $K  0$.\n- **Task 1:** Derive the general steady-state phase differences and their stability from first principles (Taylor expansion).\n- **Task 2:** Identify the condition for the existence of a stable phase-locked equilibrium.\n- **Task 3:** For parameter values $\\Delta \\omega = 0.8$ radians per second and $K = 1.2$ radians per second, compute the stable steady-state phase difference $\\phi^{\\ast}$.\n- **Task 4:** State which oscillator leads in the phase-locked state.\n- **Output Format:** The final answer for $\\phi^{\\ast}$ must be in radians, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the Adler equation, a canonical model for phase synchronization that arises from phase reduction techniques applied to coupled oscillators. This is a standard, well-established model in physics, engineering, and mathematical biology (e.g., modeling of circadian neurons, cardiac pacemaker cells). The model is scientifically sound and fundamental to the topic.\n2.  **Well-Posed:** The problem is well-posed. It presents a first-order ordinary differential equation and asks for the location and stability of its fixed points, which is a standard analysis. The provided parameters allow for the existence of a unique, stable solution.\n3.  **Objective:** The language is technical, precise, and free of any subjective or opinion-based statements.\n4.  **Incomplete or Contradictory Setup:** The problem is self-contained. All necessary variables, definitions, and the governing equation are provided. There are no contradictions.\n5.  **Unrealistic or Infeasible:** The model is an idealization but is scientifically plausible and widely used. The parameter values are physically reasonable.\n6.  **Ill-Posed or Poorly Structured:** The problem asks for a standard equilibrium and stability analysis, which admits a unique and meaningful solution. The terminology is standard in the field of nonlinear dynamics.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in biomedical systems modeling that is scientifically grounded and objective. The solution process will now proceed.\n\nThe governing dynamical equation for the phase difference $\\phi(t)$ between the two oscillators is given by:\n$$\n\\dot{\\phi} = \\Delta \\omega - K \\sin \\phi\n$$\nwhere $\\Delta \\omega = \\omega_{1} - \\omega_{2}$ is the difference in natural frequencies and $K  0$ is the coupling gain.\n\n**Derivation of Steady-State Equilibria and Stability**\n\nA steady state, or equilibrium, corresponds to a phase-locked state where the phase difference $\\phi$ is constant over time. This condition is met when its time derivative is zero, i.e., $\\dot{\\phi} = 0$. Let $\\phi^{\\ast}$ denote a steady-state value. Setting the right-hand side of the governing equation to zero yields:\n$$\n\\Delta \\omega - K \\sin \\phi^{\\ast} = 0\n$$\nSolving for $\\sin \\phi^{\\ast}$, we obtain:\n$$\n\\sin \\phi^{\\ast} = \\frac{\\Delta \\omega}{K}\n$$\nFor a real-valued solution for $\\phi^{\\ast}$ to exist, the value of the sine function must lie within its range, which is $[-1, 1]$. This imposes the following condition on the parameters:\n$$\n\\left| \\frac{\\Delta \\omega}{K} \\right| \\le 1 \\quad \\text{or, equivalently,} \\quad |\\Delta \\omega| \\le K\n$$\nThis is the condition for phase-locking. When it is satisfied, there exist two distinct families of equilibrium solutions for $\\phi^{\\ast}$ within any interval of length $2\\pi$, such as $[-\\pi, \\pi)$. These are:\n$$\n\\phi^{\\ast}_1 = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)\n$$\n$$\n\\phi^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)\n$$\nTo determine the stability of these equilibria, we perform a linear stability analysis. Let the right-hand side of the differential equation be denoted by the function $f(\\phi) = \\Delta \\omega - K \\sin \\phi$. The stability of an equilibrium point $\\phi^{\\ast}$ is determined by the sign of the derivative $f'(\\phi) = \\frac{df}{d\\phi}$ evaluated at $\\phi^{\\ast}$. An equilibrium is locally stable if small perturbations decay, which occurs when $f'(\\phi^{\\ast})  0$. It is unstable if perturbations grow, which occurs when $f'(\\phi^{\\ast})  0$.\n\nFirst, we compute the derivative of $f(\\phi)$:\n$$\nf'(\\phi) = \\frac{d}{d\\phi} (\\Delta \\omega - K \\sin \\phi) = -K \\cos \\phi\n$$\nNext, we evaluate this derivative at the equilibrium points. To do this, we need the value of $\\cos \\phi^{\\ast}$. Using the trigonometric identity $\\cos^2 \\phi^{\\ast} + \\sin^2 \\phi^{\\ast} = 1$ and the equilibrium condition $\\sin \\phi^{\\ast} = \\frac{\\Delta \\omega}{K}$, we find:\n$$\n\\cos^2 \\phi^{\\ast} = 1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2 \\implies \\cos \\phi^{\\ast} = \\pm \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\nThis is valid for $|\\Delta \\omega|  K$.\n\nFor the first equilibrium, $\\phi^{\\ast}_1 = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$:\nThe range of the principal value of the arcsin function is $[-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$. For any angle in this range, its cosine is non-negative. Thus, we must take the positive root:\n$$\n\\cos \\phi^{\\ast}_1 = +\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\nThe stability is then given by the sign of:\n$$\nf'(\\phi^{\\ast}_1) = -K \\cos \\phi^{\\ast}_1 = -K \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\nSince $K  0$ and the square root term is non-negative, we have $f'(\\phi^{\\ast}_1) \\le 0$. If $|\\Delta \\omega|  K$, then $f'(\\phi^{\\ast}_1)  0$, which signifies that the equilibrium $\\phi^{\\ast}_1$ is **stable**. This is the stable phase-locked state.\n\nFor the second equilibrium, $\\phi^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$:\nLet $\\alpha = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$. Then $\\phi^{\\ast}_2 = \\pi - \\alpha$. Using the identity $\\cos(\\pi - \\alpha) = -\\cos(\\alpha)$, and knowing that $\\cos(\\alpha) \\ge 0$, we find that $\\cos(\\phi^{\\ast}_2) \\le 0$. Thus, we must take the negative root:\n$$\n\\cos \\phi^{\\ast}_2 = -\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\nThe stability is then given by the sign of:\n$$\nf'(\\phi^{\\ast}_2) = -K \\cos \\phi^{\\ast}_2 = -K \\left(-\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\\right) = +K \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\nSince $K  0$, we have $f'(\\phi^{\\ast}_2) \\ge 0$. If $|\\Delta \\omega|  K$, then $f'(\\phi^{\\ast}_2)  0$, which signifies that the equilibrium $\\phi^{\\ast}_2$ is **unstable**.\n\nTherefore, the condition for a stable phase-locked equilibrium to exist is $|\\Delta \\omega| \\le K$. The stable steady-state phase difference is $\\phi^{\\ast} = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$.\n\n**Calculation for Specific Parameters**\n\nWe are given the parameter values $\\Delta \\omega = 0.8$ radians per second and $K = 1.2$ radians per second.\nWe first verify the condition for phase-locking:\n$$\n|\\Delta \\omega| = |0.8| = 0.8\n$$\n$$\nK = 1.2\n$$\nSince $0.8 \\le 1.2$, the condition $|\\Delta \\omega| \\le K$ is met, and a stable phase-locked equilibrium exists.\n\nThe stable steady-state phase difference $\\phi^{\\ast}$ is calculated using the formula derived for the stable equilibrium:\n$$\n\\phi^{\\ast} = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right) = \\arcsin\\left(\\frac{0.8}{1.2}\\right) = \\arcsin\\left(\\frac{2}{3}\\right)\n$$\nComputing the numerical value in radians and rounding to four significant figures:\n$$\n\\phi^{\\ast} \\approx \\arcsin(0.6666...) \\approx 0.729727656... \\text{ radians}\n$$\n$$\n\\phi^{\\ast} \\approx 0.7297 \\text{ radians}\n$$\n\n**Determination of the Leading Oscillator**\n\nThe phase difference is defined as $\\phi(t) = \\theta_{1}(t) - \\theta_{2}(t)$, and the frequency difference is $\\Delta \\omega = \\omega_{1} - \\omega_{2} = 0.8  0$. This means oscillator $1$ has a higher natural frequency than oscillator $2$ ($\\omega_1  \\omega_2$). In the phase-locked state, the stable phase difference is $\\phi^{\\ast} \\approx 0.7297$ radians. Since $\\phi^{\\ast}$ is positive, this implies that $\\theta_{1} - \\theta_{2}  0$, or $\\theta_{1}  \\theta_{2}$. By convention, this means that oscillator $1$ leads oscillator $2$. The faster oscillator leads the slower one, and the phase difference $\\phi^{\\ast}$ quantifies this lead.",
            "answer": "$$\n\\boxed{0.7297}\n$$"
        },
        {
            "introduction": "The principles of pairwise synchronization extend directly to modeling how a single biological oscillator, such as our internal circadian clock, entrains to an external periodic signal, or zeitgeber, like the daily light-dark cycle. This computational practice  applies the same Adler equation to a classic and intuitive biological scenario: recovering from jet lag. Moving beyond static, steady-state analysis, you will simulate the dynamic, transient process of re-synchronization after a sudden shift in the external cycle, gaining hands-on experience in modeling the temporal adaptation of biological rhythms.",
            "id": "3934554",
            "problem": "Consider a single circadian oscillator modeled by phase reduction in the weak-coupling limit. The organism’s internal oscillator has an intrinsic angular frequency $\\omega$ (in $\\mathrm{rad}/\\mathrm{h}$), and it is driven by a periodic light-dark cycle (zeitgeber) with angular frequency $\\Omega$ (in $\\mathrm{rad}/\\mathrm{h}$). Under a sinusoidal first-harmonic approximation of the phase response, the phase dynamics of the internal oscillator under forcing is given by the scalar phase equation\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\omega \\;+\\; K \\,\\sin\\!\\big(\\phi_Z(t) \\;-\\; \\theta(t)\\big),\n$$\nwhere $\\theta(t)$ is the internal phase, $\\phi_Z(t)$ is the zeitgeber phase, and $K$ (in $\\mathrm{rad}/\\mathrm{h}$) is the coupling strength. Assume that for $t  0$ the zeitgeber phase is $\\phi_Z(t) = \\Omega t$ and at $t = 0$ a sudden time-zone shift occurs so that for $t \\ge 0$ the zeitgeber phase becomes $\\phi_Z(t) = \\Omega t + \\Delta$, where $\\Delta$ (in $\\mathrm{rad}$) is a step change corresponding to a prescribed hour shift. The step change $\\Delta$ is related to the hour shift $s$ (in $\\mathrm{h}$) by $\\Delta = \\Omega \\, s$.\n\nDefine the phase difference $\\psi(t) = \\phi_Z(t) - \\theta(t)$, expressed in $\\mathrm{rad}$. The entrained steady-state phase difference after the shift is a constant $\\psi^\\star$ satisfying the model’s dynamics for a constant $\\psi$. The transient recovery to entrainment is quantified as follows: starting from the pre-shift entrained state at $t=0^{-}$, the recovery time $T_{\\text{rec}}$ (in $\\mathrm{h}$) is the smallest $t \\ge 0$ such that $|\\mathrm{wrap}(\\psi(t) - \\psi^\\star)| \\le \\varepsilon$ and this condition remains satisfied continuously for at least $T_{\\text{hold}}$ hours thereafter. The function $\\mathrm{wrap}(\\cdot)$ maps any angle to the principal branch $(-\\pi,\\pi]$, i.e., $\\mathrm{wrap}(x) = \\operatorname{mod}(x+\\pi, 2\\pi) - \\pi$. The angle unit throughout is radians, and time is in hours.\n\nYour task is to:\n- Formulate the initial condition at $t=0^{+}$ based on the pre-shift entrained state and the step change $\\Delta$.\n- Evolve $\\psi(t)$ forward in time using the phase-difference dynamics implied by the given model for $t \\ge 0$.\n- Determine $\\psi^\\star$ corresponding to the post-shift entrained state and evaluate the recovery time $T_{\\text{rec}}$ according to the criterion above.\n- If the system cannot entrain under the given parameters, or if $T_{\\text{rec}}$ cannot be established within a prescribed maximum simulation time $T_{\\max}$, return a sentinel value of $-1.00$ (in hours) for the recovery time and a boolean indicating that recovery was not achieved in the available simulation window.\n\nExpress the recovery time in hours, rounded to two decimal places. Use radians for all angle calculations.\n\nTest Suite and Parameter Sets:\nFor each test case, use the following parameters. All angle quantities are in radians, time is in hours.\n\n- Case $1$ (typical strong coupling, large advance):\n    - $\\Omega = \\dfrac{2\\pi}{24}$,\n    - $\\omega = \\dfrac{2\\pi}{24.3}$,\n    - $K = 0.07$,\n    - hour shift $s = +8$,\n    - tolerance $\\varepsilon = 0.05$,\n    - hold time $T_{\\text{hold}} = 48$,\n    - maximum simulation time $T_{\\max} = 300$.\n\n- Case $2$ (borderline coupling at the entrainment threshold, large delay):\n    - $\\Omega = \\dfrac{2\\pi}{24}$,\n    - $\\omega = \\dfrac{2\\pi}{23.5}$,\n    - $K = |\\Omega - \\omega|$,\n    - hour shift $s = -6$,\n    - tolerance $\\varepsilon = 0.05$,\n    - hold time $T_{\\text{hold}} = 72$,\n    - maximum simulation time $T_{\\max} = 600$.\n\n- Case $3$ (near-threshold weak coupling, small advance):\n    - $\\Omega = \\dfrac{2\\pi}{24}$,\n    - $\\omega = \\dfrac{2\\pi}{24.6}$,\n    - $K = |\\Omega - \\omega| + 0.001$,\n    - hour shift $s = +1$,\n    - tolerance $\\varepsilon = 0.05$,\n    - hold time $T_{\\text{hold}} = 48$,\n    - maximum simulation time $T_{\\max} = 500$.\n\nProgram Requirements:\n- Implement the model and recovery-time estimation for each test case independently.\n- Use a numerical integrator to evolve the phase difference $\\psi(t)$ for $t \\in [0, T_{\\max}]$.\n- The initial condition for $\\psi(0^{+})$ must be consistent with an entrained pre-shift state at $t=0^{-}$ and the instantaneous jump $\\Delta = \\Omega s$ at $t=0$.\n- If the model’s parameters do not permit entrainment, or the recovery condition is not met for at least $T_{\\text{hold}}$ hours within $T_{\\max}$, output a recovery time of $-1.00$ and mark recovery as not achieved.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of two elements: the recovery time (a float in hours, rounded to two decimals) and a boolean indicating whether recovery was achieved within $T_{\\max}$. For example, the output must look like\n$$\n[\\,[T_1,\\;B_1],\\,[T_2,\\;B_2],\\,[T_3,\\;B_3]\\,],\n$$\nwhere $T_i$ is the recovery time in hours (rounded to two decimals) and $B_i$ is a boolean.",
            "solution": "The problem asks for the calculation of recovery time for a circadian oscillator model subjected to a sudden phase shift, akin to jet lag. The analysis proceeds in three main steps: first, deriving the governing equation for the phase difference; second, determining the stable entrained state and the initial condition after the shift; and third, numerically solving the equation and applying the specified recovery criterion.\n\nThe dynamics of the internal oscillator phase $\\theta(t)$ are given by the Adler equation:\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\omega \\;+\\; K \\,\\sin\\!\\big(\\phi_Z(t) \\;-\\; \\theta(t)\\big)\n$$\nwhere $\\omega$ is the intrinsic angular frequency, $\\Omega$ is the zeitgeber's angular frequency, $K$ is the coupling strength, and $\\phi_Z(t)$ is the zeitgeber phase.\n\n**1. Dynamics of the Phase Difference**\n\nWe define the phase difference as $\\psi(t) = \\phi_Z(t) - \\theta(t)$. To find its governing equation, we compute its time derivative:\n$$\n\\frac{d\\psi}{dt} = \\frac{d\\phi_Z}{dt} - \\frac{d\\theta}{dt}\n$$\nFor $t \\ge 0$, the zeitgeber phase is $\\phi_Z(t) = \\Omega t + \\Delta$, so its derivative is $\\frac{d\\phi_Z}{dt} = \\Omega$. Substituting the given equation for $\\frac{d\\theta}{dt}$ and the definition of $\\psi(t)$, we get:\n$$\n\\frac{d\\psi}{dt} = \\Omega - \\left( \\omega + K \\sin(\\psi(t)) \\right)\n$$\nLetting $\\Delta\\omega = \\Omega - \\omega$ be the frequency detuning, the dynamics of the phase difference for $t \\ge 0$ are described by the autonomous ordinary differential equation (ODE):\n$$\n\\frac{d\\psi}{dt} = \\Delta\\omega - K \\sin(\\psi)\n$$\n\n**2. Entrainment and Steady-State Analysis**\n\nEntrainment occurs when the internal oscillator synchronizes with the external zeitgeber, resulting in a constant phase difference, $\\psi(t) = \\psi^\\star$. For this to happen, $\\frac{d\\psi}{dt}$ must be zero.\n$$\n0 = \\Delta\\omega - K \\sin(\\psi^\\star) \\implies \\sin(\\psi^\\star) = \\frac{\\Delta\\omega}{K}\n$$\nA real solution for $\\psi^\\star$ exists only if $|\\frac{\\Delta\\omega}{K}| \\le 1$, which is the necessary condition for entrainment. If $K  |\\Delta\\omega|$, the oscillator cannot lock to the zeitgeber frequency, and its phase will continuously drift (phase slipping).\n\nAssuming entrainment is possible and $K0$, there are generally two solutions for $\\psi^\\star$. To find the stable one, we analyze the stability of the fixed points. Let $f(\\psi) = \\Delta\\omega - K \\sin(\\psi)$. A fixed point $\\psi^\\star$ is stable if $f'(\\psi^\\star)  0$. The derivative is $f'(\\psi) = -K \\cos(\\psi)$. For stability, we need $-K \\cos(\\psi^\\star)  0$, which, for $K0$, simplifies to $\\cos(\\psi^\\star)  0$. This condition is met for angles in the first and fourth quadrants, i.e., $\\psi^\\star \\in (-\\pi/2, \\pi/2)$.\n\nThe principal value of the arcsin function yields a result in $[-\\pi/2, \\pi/2]$, which satisfies the stability condition. Therefore, the unique stable entrained phase difference is:\n$$\n\\psi^\\star = \\arcsin\\left(\\frac{\\Omega - \\omega}{K}\\right)\n$$\n\n**3. Initial Condition for Recovery Dynamics**\n\nThe system is assumed to be in a stable entrained state for $t  0$. The governing dynamics are the same, so the pre-shift phase difference at $t=0^-$ is $\\psi(0^-) = \\psi^\\star$. By definition, $\\psi(0^-) = \\phi_Z(0^-) - \\theta(0^-)$. Since $\\phi_Z(t) = \\Omega t$ for $t0$, we have $\\phi_Z(0^-) = 0$. Thus, $\\psi^\\star = 0 - \\theta(0^-)$, which implies $\\theta(0^-) = -\\psi^\\star$.\n\nThe internal phase $\\theta(t)$ is a state variable and cannot change instantaneously. Therefore, $\\theta(0^+) = \\theta(0^-) = -\\psi^\\star$.\nAt $t=0$, the zeitgeber phase undergoes a step change $\\Delta = \\Omega s$, so $\\phi_Z(0^+) = \\Omega(0) + \\Delta = \\Delta$.\nThe initial phase difference for the post-shift dynamics at $t=0^+$ is:\n$$\n\\psi(0^+) = \\phi_Z(0^+) - \\theta(0^+) = \\Delta - (-\\psi^\\star) = \\Delta + \\psi^\\star\n$$\nSubstituting the expressions for $\\Delta$ and $\\psi^\\star$, the initial condition for our numerical integration is:\n$$\n\\psi_0 = \\psi(0) = \\Omega s + \\arcsin\\left(\\frac{\\Omega - \\omega}{K}\\right)\n$$\n\n**4. Numerical Solution and Recovery Time Evaluation**\n\nThe problem now reduces to solving the initial value problem:\n$$\n\\frac{d\\psi}{dt} = \\Delta\\omega - K \\sin(\\psi), \\quad \\psi(0) = \\psi_0\n$$\nfrom $t=0$ up to $t=T_{\\max}$. We use a numerical ODE solver, such as `scipy.integrate.solve_ivp` from SciPy, to obtain the trajectory $\\psi(t)$.\n\nThe recovery time $T_{\\text{rec}}$ is the smallest time $t \\ge 0$ where the error $|\\mathrm{wrap}(\\psi(t) - \\psi^\\star)|$ falls below a tolerance $\\varepsilon$ and remains so for a continuous duration of $T_{\\text{hold}}$. The function $\\mathrm{wrap}(x)$ maps an angle $x$ to the interval $(-\\pi, \\pi]$.\n\nThe algorithm to find $T_{\\text{rec}}$ is as follows:\n1.  For a given set of parameters, first check the entrainment condition $K \\ge |\\Omega - \\omega|$. If not met, recovery is impossible, and we return $T_{\\text{rec}} = -1.00$.\n2.  Calculate the stable state $\\psi^\\star$ and the initial condition $\\psi_0$.\n3.  Numerically integrate the ODE for $\\psi(t)$ over the interval $[0, T_{\\max}]$.\n4.  Create a fine-grained time grid over this interval. At each point on the grid, evaluate the error $|\\mathrm{wrap}(\\psi(t) - \\psi^\\star)|$ and determine if it is within the tolerance $\\varepsilon$.\n5.  Search this grid for the first time $t_i$ at which the tolerance condition is met.\n6.  Verify if the condition holds for all time points in the subsequent interval $[t_i, t_i + T_{\\text{hold}}]$.\n7.  If the hold condition is satisfied, $T_{\\text{rec}} = t_i$.\n8.  If not, continue the search from the point where the tolerance was violated, looking for the next entry into the tolerance band.\n9.  If no such time is found within the simulation window $[0, T_{\\max}]$, recovery is not achieved, and we return $T_{\\text{rec}} = -1.00$.\n\nCase 2 is a special borderline case where $K = |\\Omega - \\omega|$, which places the system at a saddle-node bifurcation. The approach to steady state is algebraically slow ($1/t$ scaling), not exponential. It is thus anticipated that the system will fail to meet the recovery criterion within the specified $T_{\\max}$.\n\n```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the recovery time of a circadian oscillator model after a phase shift.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (typical strong coupling, large advance)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 24.3,\n            \"K\": 0.07,\n            \"s\": 8,\n            \"epsilon\": 0.05,\n            \"T_hold\": 48,\n            \"T_max\": 300,\n        },\n        # Case 2 (borderline coupling at the entrainment threshold, large delay)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 23.5,\n            \"K\": abs(2 * np.pi / 24 - 2 * np.pi / 23.5),\n            \"s\": -6,\n            \"epsilon\": 0.05,\n            \"T_hold\": 72,\n            \"T_max\": 600,\n        },\n        # Case 3 (near-threshold weak coupling, small advance)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 24.6,\n            \"K\": abs(2 * np.pi / 24 - 2 * np.pi / 24.6) + 0.001,\n            \"s\": 1,\n            \"epsilon\": 0.05,\n            \"T_hold\": 48,\n            \"T_max\": 500,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        T_rec, recovered = calculate_recovery_time(**params)\n        results.append([round(T_rec, 2), recovered])\n\n    # Format the output exactly as required\n    print(str(results).replace(\" \", \"\"))\n\ndef wrap_angle(x):\n    \"\"\"Wraps an angle to the principal branch (-pi, pi].\"\"\"\n    return (x + np.pi) % (2 * np.pi) - np.pi\n\ndef calculate_recovery_time(Omega, omega, K, s, epsilon, T_hold, T_max):\n    \"\"\"\n    Solves the model and calculates the recovery time for a single test case.\n    \"\"\"\n    delta_omega = Omega - omega\n\n    # Step 1: Check for entrainment possibility\n    if K  abs(delta_omega):\n        return -1.0, False\n\n    # Step 2: Calculate steady state and initial condition\n    psi_star = np.arcsin(delta_omega / K)\n    delta_phase = Omega * s\n    psi_0 = delta_phase + psi_star\n\n    # Step 3: Define and integrate the ODE\n    def phase_model(t, y):\n        return delta_omega - K * np.sin(y)\n\n    sol = solve_ivp(\n        phase_model,\n        (0, T_max),\n        [psi_0],\n        dense_output=True,\n        method='RK45'\n    )\n\n    # Step 4: Analyze solution to find recovery time\n    dt = 0.1  # Time step for checking the condition\n    t_eval = np.arange(0, T_max, dt)\n    psi_t = sol.sol(t_eval)[0]\n\n    error = np.abs(wrap_angle(psi_t - psi_star))\n    is_in_tolerance = error = epsilon\n    \n    hold_steps = int(np.ceil(T_hold / dt))\n\n    is_searching = True\n    search_start_idx = 0\n    \n    while is_searching and search_start_idx  len(t_eval):\n        # Find the next entry into the tolerance zone\n        potential_entries = np.where(is_in_tolerance[search_start_idx:])[0]\n        if len(potential_entries) == 0:\n            # No more entries into tolerance zone\n            is_searching = False\n            continue\n            \n        entry_idx = search_start_idx + potential_entries[0]\n        \n        # Check if the T_hold window fits within the simulation time\n        if entry_idx + hold_steps >= len(t_eval):\n            is_searching = False\n            continue\n\n        # Check if the condition holds for the entire T_hold duration\n        hold_window = is_in_tolerance[entry_idx : entry_idx + hold_steps + 1]\n        \n        if np.all(hold_window):\n            # Recovery found\n            recovery_time = t_eval[entry_idx]\n            return recovery_time, True\n        else:\n            # Did not hold, find where it failed and start search from there\n            first_fail_in_window = np.where(~hold_window)[0][0]\n            search_start_idx = entry_idx + first_fail_in_window\n\n    # If loop completes without finding a valid recovery period\n    return -1.0, False\n\nif __name__ == \"__main__\":\n    solve()\n\n```",
            "answer": "```\n[[86.50, True], [-1.00, False], [185.70, True]]\n```"
        },
        {
            "introduction": "While pairwise interactions are fundamental, many biological systems, from neural networks in the suprachiasmatic nucleus to pacemaker cells in the heart, involve the collective behavior of vast populations of oscillators. The Kuramoto model is the cornerstone for studying this emergent mass synchronization. This advanced analytical exercise  invites you to explore the fascinating phase transition where a disordered population spontaneously locks into a coherent rhythm. You will derive the \"critical exponent\" that governs the onset of synchronization, revealing how the nature of this transition depends on the statistical properties of the oscillator population and uncovering a deep connection between systems biology and statistical physics.",
            "id": "3934483",
            "problem": "A population of $N$ weakly coupled biological phase oscillators (e.g., suprachiasmatic nucleus neurons or cardiomyocyte pacemaker cells) is modeled in the continuum limit by the mean-field Kuramoto equations\n$$\n\\frac{d\\theta_{i}}{dt} \\;=\\; \\omega_{i} \\;+\\; \\frac{K}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{j}-\\theta_{i}\\big),\n$$\nwhere $\\theta_{i}$ is the phase of oscillator $i$, $\\omega_{i}$ is its intrinsic frequency drawn independently from a symmetric, unimodal probability density $g(\\omega)$, and $K$ is the global coupling strength. Define the macroscopic order parameter $r$ and mean phase $\\psi$ by\n$$\nre^{i\\psi} \\;=\\; \\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}.\n$$\nIn the stationary partially synchronized regime just above the onset of macroscopic phase coherence, a finite fraction of oscillators becomes frequency-locked, and the remainder drift. Starting only from the Kuramoto model, the definition of $r$, and first-principles continuum reasoning about locked and drifting subpopulations, derive the leading scaling of the order parameter $r$ as the coupling $K$ exceeds the critical coupling $K_{c}$, for the following two biologically plausible frequency distributions:\n- A Lorentzian (Cauchy) distribution $g_{L}(\\omega)=\\dfrac{\\Delta}{\\pi\\left(\\Delta^{2}+\\omega^{2}\\right)}$ with half-width at half-maximum $\\Delta0$.\n- A symmetric triangular distribution with compact support $g_{T}(\\omega)=\\dfrac{1}{\\gamma}\\left(1-\\dfrac{|\\omega|}{\\gamma}\\right)$ for $|\\omega|\\le\\gamma$ and $g_{T}(\\omega)=0$ for $|\\omega|\\gamma$, with $\\gamma0$.\n\nLet the asymptotic scaling be defined by $r \\sim C \\left(K-K_{c}\\right)^{\\beta}$ as $K\\downarrow K_{c}^{+}$, where $C$ is a positive constant that may depend on details of $g(\\omega)$ but does not affect the exponent. Determine the critical exponent $\\beta$ for each case by explicit derivation from the model. Express your final answer as a row matrix $(\\beta_{L}\\;\\\\;\\beta_{T})$, where $\\beta_{L}$ corresponds to $g_{L}$ and $\\beta_{T}$ corresponds to $g_{T}$. No rounding is required; the exponents are dimensionless.",
            "solution": "The problem asks for the critical exponent $\\beta$ describing the scaling of the order parameter $r$ just above the critical coupling $K_c$ for the Kuramoto model, where $r \\sim C(K-K_c)^\\beta$. The derivation must be performed for two different intrinsic frequency distributions, $g(\\omega)$.\n\nThe starting point is the Kuramoto model for $N$ oscillators:\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega_{i} + \\frac{K}{N}\\sum_{j=1}^{N}\\sin(\\theta_{j}-\\theta_{i})\n$$\nThe macroscopic order parameter $r$ and mean phase $\\psi$ are defined in the continuum limit ($N\\to\\infty$) as:\n$$\nre^{i\\psi} = \\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}\n$$\nWe can rewrite the coupling term using the order parameter:\n$$\n\\frac{K}{N}\\sum_{j=1}^{N}\\sin(\\theta_{j}-\\theta_{i}) = \\frac{K}{N}\\text{Im}\\left[\\sum_{j=1}^{N}e^{i(\\theta_{j}-\\theta_{i})}\\right] = \\text{Im}\\left[Ke^{-i\\theta_{i}}\\left(\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}\\right)\\right]\n$$\nIn the continuum limit, this becomes $\\text{Im}[K e^{-i\\theta_i} r e^{i\\psi}] = Kr\\sin(\\psi-\\theta_i)$. The equation of motion for a single oscillator from the continuum is thus:\n$$\n\\frac{d\\theta}{dt} = \\omega + Kr\\sin(\\psi-\\theta)\n$$\nIn a stationary, synchronized state, the mean phase may rotate at a constant collective frequency, $\\psi(t) = \\Omega t$. By moving to a rotating frame with this frequency and noting that for a symmetric distribution $g(\\omega)$ centered at $\\omega=0$, we have $\\Omega=0$ and can set $\\psi=0$ without loss of generality. The order parameter $r$ becomes a real, time-independent quantity. The dynamics of an oscillator with intrinsic frequency $\\omega$ are governed by:\n$$\n\\frac{d\\theta}{dt} = \\omega - Kr\\sin(\\theta)\n$$\nIn this stationary state, oscillators partition into two groups.\n$1$. **Locked oscillators**: These have a constant phase, $\\frac{d\\theta}{dt}=0$. This requires $\\omega = Kr\\sin(\\theta)$, which is only possible if $|\\omega| \\le Kr$. The stable locked phase is $\\theta_{\\text{locked}} = \\arcsin(\\frac{\\omega}{Kr})$, chosen such that $\\cos(\\theta_{\\text{locked}})0$.\n$2$. **Drifting oscillators**: These have $|\\omega|Kr$. Their phase $\\theta(t)$ perpetually increases or decreases.\n\nThe order parameter $r$ is the population average of $\\cos(\\theta)$, since we set $\\psi=0$.\n$$\nr = \\langle \\cos(\\theta) \\rangle = \\int_{-\\infty}^{\\infty} \\langle \\cos(\\theta) \\rangle_{\\omega} g(\\omega) d\\omega\n$$\nwhere $\\langle \\cos(\\theta) \\rangle_{\\omega}$ is the time-average for an oscillator with frequency $\\omega$.\nFor locked oscillators, $\\langle \\cos(\\theta) \\rangle_{\\omega} = \\cos(\\theta_{\\text{locked}}) = \\sqrt{1-\\sin^2(\\theta_{\\text{locked}})} = \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2}$.\nFor drifting oscillators, the phase continually cycles through $[0, 2\\pi)$, and their contribution to the time-average of $e^{i\\theta}$ is zero. Thus, $\\langle \\cos(\\theta) \\rangle_{\\omega}=0$ for $|\\omega|Kr$.\nThis leads to the self-consistency equation for the order parameter $r$:\n$$\nr = \\int_{-Kr}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} g(\\omega) d\\omega\n$$\nThe onset of synchronization ($r0$) occurs when the coupling $K$ exceeds a critical value $K_c$. We analyze this equation for $r \\to 0^{+}$ to find the scaling. The behavior depends on the properties of $g(\\omega)$ near $\\omega=0$.\n\n**Case 1: Lorentzian Distribution**\n\nThe distribution is $g_{L}(\\omega)=\\dfrac{\\Delta}{\\pi\\left(\\Delta^{2}+\\omega^{2}\\right)}$. This function is analytic (infinitely differentiable) at $\\omega=0$. We can use a Taylor series expansion around $\\omega=0$:\n$$\ng_{L}(\\omega) = \\frac{\\Delta}{\\pi\\Delta^2}\\left(1+\\frac{\\omega^2}{\\Delta^2}\\right)^{-1} = \\frac{1}{\\pi\\Delta}\\left(1 - \\frac{\\omega^2}{\\Delta^2} + O(\\omega^4)\\right)\n$$\nComparing with the general form $g(\\omega) = g(0) + \\frac{g''(0)}{2}\\omega^2 + \\dots$, we identify:\n$$\ng_{L}(0) = \\frac{1}{\\pi\\Delta}, \\quad g_{L}''(0) = -\\frac{2}{\\pi\\Delta^3}\n$$\nSince $g_L''(0)  0$, the distribution is unimodal at $\\omega=0$. We substitute the expansion into the self-consistency equation. Let's perform a change of variables $\\omega = Krx$, so $d\\omega = Kr\\,dx$.\n$$\nr = \\int_{-1}^{1} \\sqrt{1-x^2} \\, g_{L}(Krx) \\, (Kr\\,dx)\n$$\n$$\nr = Kr \\int_{-1}^{1} \\sqrt{1-x^2} \\left[ g_L(0) + \\frac{g_L''(0)}{2} (Krx)^2 + O(r^4) \\right] dx\n$$\nThe integrand is an even function of $x$. We use the standard definite integrals:\n$\\int_{-1}^{1} \\sqrt{1-x^2} dx = \\frac{\\pi}{2}$ (area of a unit semicircle).\n$\\int_{-1}^{1} x^2\\sqrt{1-x^2} dx = \\frac{\\pi}{8}$.\n$$\nr = Kr \\left( g_L(0) \\frac{\\pi}{2} + \\frac{g_L''(0)}{2} K^2 r^2 \\frac{\\pi}{8} + \\dots \\right)\n$$\nFor a non-trivial solution $r0$, we can divide by $r$:\n$$\n1 = K \\frac{\\pi g_L(0)}{2} + K^3 r^2 \\frac{\\pi g_L''(0)}{16} + O(r^4)\n$$\nThe critical coupling $K_{c,L}$ is found in the limit $r \\to 0$: $1 = K_{c,L} \\frac{\\pi g_L(0)}{2}$, which gives $K_{c,L} = \\frac{2}{\\pi g_L(0)} = \\frac{2}{\\pi(1/\\pi\\Delta)} = 2\\Delta$.\nNow let $K = K_{c,L} + \\delta K$ for small $\\delta K  0$:\n$$\n1 = \\frac{K_{c,L}+\\delta K}{K_{c,L}} + K^3 r^2 \\frac{\\pi g_L''(0)}{16} \\approx 1 + \\frac{\\delta K}{K_{c,L}} + K_{c,L}^3 r^2 \\frac{\\pi g_L''(0)}{16}\n$$\n$$\n0 = \\frac{\\delta K}{K_{c,L}} + K_{c,L}^3 r^2 \\frac{\\pi g_L''(0)}{16}\n$$\n$$\nr^2 = -\\frac{16 \\, \\delta K}{K_{c,L}^4 \\, \\pi \\, g_L''(0)}\n$$\nSince $g_L''(0)  0$ and $\\delta K = K-K_{c,L}  0$, $r^2$ is positive. The scaling is $r^2 \\propto (K-K_{c,L})$. Therefore, the order parameter scales as:\n$$\nr \\propto (K-K_{c,L})^{1/2}\n$$\nThe critical exponent for the Lorentzian case is $\\beta_L = \\frac{1}{2}$.\n\n**Case 2: Symmetric Triangular Distribution**\n\nThe distribution is $g_{T}(\\omega)=\\dfrac{1}{\\gamma}\\left(1-\\dfrac{|\\omega|}{\\gamma}\\right)$ for $|\\omega|\\le\\gamma$.\nThis function is not analytic at $\\omega=0$ due to the absolute value term $|\\omega|$. Its first derivative is discontinuous at $\\omega=0$, and its second derivative is not defined in the standard sense. The Taylor expansion used above is invalid. We must use the form of $g_T(\\omega)$ for small $\\omega$ directly in the self-consistency integral. For small $r$, the integration range $[-Kr, Kr]$ is small, so we can use $g_T(\\omega) = \\frac{1}{\\gamma} - \\frac{|\\omega|}{\\gamma^2}$.\n$$\nr = \\int_{-Kr}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} \\left(\\frac{1}{\\gamma} - \\frac{|\\omega|}{\\gamma^2}\\right) d\\omega\n$$\nThe integrand is an even function of $\\omega$, so we can integrate from $0$ to $Kr$ and multiply by $2$:\n$$\nr = 2 \\int_{0}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} \\left(\\frac{1}{\\gamma} - \\frac{\\omega}{\\gamma^2}\\right) d\\omega\n$$\n$$\nr = \\frac{2}{\\gamma} \\int_{0}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega - \\frac{2}{\\gamma^2} \\int_{0}^{Kr} \\omega \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega\n$$\nWe evaluate the two integrals.\nThe first integral is the area of a quarter-circle of radius $Kr$: $\\int_{0}^{Kr} \\sqrt{1 - (\\omega/Kr)^2} d\\omega = \\frac{\\pi (Kr)^2}{4} \\frac{1}{Kr} = \\frac{\\pi Kr}{4}$.\nFor the second integral, let $u = 1 - (\\omega/Kr)^2$, so $du = -2\\omega/(Kr)^2 d\\omega$.\n$$\n\\int_0^{Kr} \\omega \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega = \\int_1^0 \\sqrt{u} \\left(-\\frac{(Kr)^2}{2} du\\right) = \\frac{(Kr)^2}{2} \\int_0^1 u^{1/2} du = \\frac{(Kr)^2}{2} \\left[\\frac{2}{3}u^{3/2}\\right]_0^1 = \\frac{(Kr)^2}{3}\n$$\nSubstituting these results back into the equation for $r$:\n$$\nr = \\frac{2}{\\gamma} \\left( \\frac{\\pi K r}{4} \\right) - \\frac{2}{\\gamma^2} \\left( \\frac{K^2 r^2}{3} \\right) = \\frac{\\pi K r}{2\\gamma} - \\frac{2 K^2 r^2}{3\\gamma^2}\n$$\nFor $r0$, we divide by $r$:\n$$\n1 = \\frac{\\pi K}{2\\gamma} - \\frac{2 K^2 r}{3\\gamma^2}\n$$\nThe critical coupling $K_{c,T}$ is found for $r \\to 0$, giving $1 = \\frac{\\pi K_{c,T}}{2\\gamma}$, so $K_{c,T} = \\frac{2\\gamma}{\\pi}$.\nLet $K=K_{c,T}+\\delta K$ and substitute $K_{c,T}$ back into the equation:\n$$\n1 = \\frac{K_{c,T}+\\delta K}{K_{c,T}} - \\frac{2 (K_{c,T}+\\delta K)^2 r}{3\\gamma^2} \\approx 1 + \\frac{\\delta K}{K_{c,T}} - \\frac{2 K_{c,T}^2 r}{3\\gamma^2}\n$$\n$$\n0 = \\frac{\\delta K}{K_{c,T}} - \\frac{2 K_{c,T}^2 r}{3\\gamma^2}\n$$\nSolving for $r$:\n$$\nr = \\frac{3\\gamma^2}{2 K_{c,T}^3} \\delta K = \\left(\\frac{3\\gamma^2}{2 \\left(\\frac{2\\gamma}{\\pi}\\right)^3}\\right) (K-K_{c,T}) = \\frac{3\\pi^3}{16\\gamma}(K-K_{c,T})\n$$\nThe scaling is linear, $r \\propto (K-K_{c,T})$.\nThe critical exponent for the triangular case is $\\beta_T = 1$.\n\nThe two exponents are $\\beta_L = 1/2$ and $\\beta_T = 1$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}