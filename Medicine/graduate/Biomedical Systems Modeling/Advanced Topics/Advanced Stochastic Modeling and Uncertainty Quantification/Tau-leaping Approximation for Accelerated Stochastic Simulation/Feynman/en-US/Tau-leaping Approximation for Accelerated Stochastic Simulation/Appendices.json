{
    "hands_on_practices": [
        {
            "introduction": "The central challenge in tau-leaping is selecting a time step $\\tau$ that is large enough to accelerate the simulation, yet small enough to ensure the reaction propensities remain nearly constant. This exercise  guides you through the derivation of a standard adaptive tau-selection procedure. By translating the abstract \"leap condition\" into concrete mathematical constraints on the mean and variance of species population changes, you will develop a practical tool for dynamically adjusting $\\tau$ to balance computational speed with simulation accuracy.",
            "id": "3935710",
            "problem": "Consider a well-mixed biochemical system modeled by the Chemical Master Equation (CME), simulated under the Stochastic Simulation Algorithm (SSA). The system consists of three molecular species with discrete copy numbers, denoted by $X_{A}$, $X_{B}$, and $X_{C}$, undergoing two reaction channels under mass-action kinetics:\n$$\nR_{1}: A + B \\to C, \\quad R_{2}: C \\to A + B.\n$$\nLet the stoichiometric change vector for reaction $j$ be $\\boldsymbol{\\nu}_{j} = (\\nu_{jA}, \\nu_{jB}, \\nu_{jC})$, with $j \\in \\{1,2\\}$. Under mass-action kinetics, the propensity function for reaction $j$ is $a_{j}(\\boldsymbol{X}) = c_{j} h_{j}(\\boldsymbol{X})$, where $c_{j} > 0$ is the rate constant and $h_{j}(\\boldsymbol{X})$ counts the number of distinct reactant combinations consistent with the stoichiometric requirements. For the reactions above, this yields\n$$\na_{1}(\\boldsymbol{X}) = c_{1} X_{A} X_{B}, \\quad a_{2}(\\boldsymbol{X}) = c_{2} X_{C}.\n$$\nIn the $\\tau$-leaping approximation for accelerated stochastic simulation, one chooses a leap interval $\\tau > 0$ such that each propensity remains approximately constant over $[t, t+\\tau)$, which can be enforced by bounding the expected and typical fluctuations of each species count relative to its current value.\n\nStarting from the definition of $\\tau$-leaping as an approximation in which the number of firings of reaction $j$ in $[t, t+\\tau)$ is modeled as a Poisson random variable with mean $a_{j}(\\boldsymbol{X})\\,\\tau$, derive an adaptive upper bound for $\\tau$ in terms of the species counts $\\boldsymbol{X}$, the stoichiometric coefficients $\\nu_{ji}$, and the mass-action propensities $a_{j}(\\boldsymbol{X})$, by requiring that both the mean and variance contributions to the relative change of each species $i \\in \\{A,B,C\\}$ are bounded by a prescribed tolerance $\\epsilon \\in (0,1)$.\n\nThen, for the state\n$$\nX_{A} = 120, \\quad X_{B} = 80, \\quad X_{C} = 30,\n$$\nwith rate constants\n$$\nc_{1} = 1.0 \\times 10^{-4} \\ \\text{s}^{-1}, \\quad c_{2} = 5.0 \\times 10^{-2} \\ \\text{s}^{-1},\n$$\nand tolerance\n$$\n\\epsilon = 0.05,\n$$\ncompute the corresponding adaptive $\\tau$ satisfying your derived bound. Express your final answer in seconds and round your answer to four significant figures.",
            "solution": "We begin from the Chemical Master Equation (CME) perspective, where the state $\\boldsymbol{X}(t)$ evolves as a continuous-time Markov jump process. Under the $\\tau$-leaping approximation, when the leap condition holds (i.e., propensities remain approximately constant over a short interval), the number of firings of reaction $j$ during a time interval $[t,t+\\tau)$ can be approximated as a Poisson random variable $P_{j}(\\tau)$ with mean $a_{j}(\\boldsymbol{X}(t))\\,\\tau$.\n\nLet the stoichiometric change vector of reaction $j$ be $\\boldsymbol{\\nu}_{j} = (\\nu_{jA}, \\nu_{jB}, \\nu_{jC})$, so the net change in species $i$ over the leap is\n$$\n\\Delta X_{i}(\\tau) = \\sum_{j} \\nu_{ji} P_{j}(\\tau).\n$$\nBecause the $P_{j}(\\tau)$ are (approximately) independent Poisson random variables with parameters $a_{j}(\\boldsymbol{X})\\,\\tau$, their means and variances are\n$$\n\\mathbb{E}[P_{j}(\\tau)] = a_{j}(\\boldsymbol{X})\\,\\tau, \\quad \\mathrm{Var}[P_{j}(\\tau)] = a_{j}(\\boldsymbol{X})\\,\\tau.\n$$\nTherefore, for each species $i$, the mean and variance of its net change are\n$$\n\\mathbb{E}[\\Delta X_{i}(\\tau)] = \\sum_{j} \\nu_{ji} \\, \\mathbb{E}[P_{j}(\\tau)] = \\left( \\sum_{j} \\nu_{ji} a_{j}(\\boldsymbol{X}) \\right) \\tau \\equiv \\mu_{i}(\\boldsymbol{X}) \\, \\tau,\n$$\n$$\n\\mathrm{Var}[\\Delta X_{i}(\\tau)] = \\sum_{j} \\nu_{ji}^{2} \\, \\mathrm{Var}[P_{j}(\\tau)] = \\left( \\sum_{j} \\nu_{ji}^{2} a_{j}(\\boldsymbol{X}) \\right) \\tau \\equiv \\sigma_{i}^{2}(\\boldsymbol{X}) \\, \\tau,\n$$\nusing independence and the fact that $\\mathrm{Var}\\left(\\sum_{j} Z_{j}\\right)=\\sum_{j} \\mathrm{Var}(Z_{j})$ for independent $Z_{j}$.\n\nTo maintain the leap condition, a common criterion is to bound both the expected relative change and a measure of typical fluctuation (via variance) for each species $i$ by a small tolerance $\\epsilon \\in (0,1)$. Specifically, we enforce\n$$\n\\frac{|\\mathbb{E}[\\Delta X_{i}(\\tau)]|}{X_{i}} \\le \\epsilon, \\quad \\frac{\\sqrt{\\mathrm{Var}[\\Delta X_{i}(\\tau)]}}{X_{i}} \\le \\epsilon,\n$$\nfor all species $i$. Substituting the expressions for the mean and variance yields\n$$\n\\frac{|\\mu_{i}(\\boldsymbol{X})|\\,\\tau}{X_{i}} \\le \\epsilon \\quad \\Rightarrow \\quad \\tau \\le \\frac{\\epsilon X_{i}}{|\\mu_{i}(\\boldsymbol{X})|},\n$$\nand\n$$\n\\frac{\\sqrt{\\sigma_{i}^{2}(\\boldsymbol{X})\\,\\tau}}{X_{i}} \\le \\epsilon \\quad \\Rightarrow \\quad \\sqrt{\\tau} \\le \\frac{\\epsilon X_{i}}{\\sqrt{\\sigma_{i}^{2}(\\boldsymbol{X})}} \\quad \\Rightarrow \\quad \\tau \\le \\frac{(\\epsilon X_{i})^{2}}{\\sigma_{i}^{2}(\\boldsymbol{X})}.\n$$\nTo satisfy both constraints for all species, the adaptive upper bound for $\\tau$ is therefore\n$$\n\\tau \\le \\min_{i} \\left\\{ \\min \\left( \\frac{\\epsilon X_{i}}{|\\mu_{i}(\\boldsymbol{X})|}, \\ \\frac{(\\epsilon X_{i})^{2}}{\\sigma_{i}^{2}(\\boldsymbol{X})} \\right) \\right\\},\n$$\nwith\n$$\n\\mu_{i}(\\boldsymbol{X}) = \\sum_{j} \\nu_{ji} a_{j}(\\boldsymbol{X}), \\quad \\sigma_{i}^{2}(\\boldsymbol{X}) = \\sum_{j} \\nu_{ji}^{2} a_{j}(\\boldsymbol{X}).\n$$\nThis expresses the adaptive $\\tau$ bound in terms of species counts $X_{i}$, stoichiometric coefficients $\\nu_{ji}$, and mass-action propensities $a_{j}(\\boldsymbol{X})$.\n\nWe now compute $\\tau$ for the specific system. The stoichiometries are\n$$\n\\boldsymbol{\\nu}_{1} = (-1, -1, +1), \\quad \\boldsymbol{\\nu}_{2} = (+1, +1, -1).\n$$\nThe propensities under the given state and rate constants are\n$$\na_{1}(\\boldsymbol{X}) = c_{1} X_{A} X_{B} = \\left(1.0 \\times 10^{-4}\\right) \\cdot 120 \\cdot 80 = 0.96,\n$$\n$$\na_{2}(\\boldsymbol{X}) = c_{2} X_{C} = \\left(5.0 \\times 10^{-2}\\right) \\cdot 30 = 1.5.\n$$\nCompute $\\mu_{i}(\\boldsymbol{X})$ for each species:\n$$\n\\mu_{A} = \\nu_{1A} a_{1} + \\nu_{2A} a_{2} = (-1)\\cdot 0.96 + (+1)\\cdot 1.5 = 0.54,\n$$\n$$\n\\mu_{B} = \\nu_{1B} a_{1} + \\nu_{2B} a_{2} = (-1)\\cdot 0.96 + (+1)\\cdot 1.5 = 0.54,\n$$\n$$\n\\mu_{C} = \\nu_{1C} a_{1} + \\nu_{2C} a_{2} = (+1)\\cdot 0.96 + (-1)\\cdot 1.5 = -0.54.\n$$\nCompute $\\sigma_{i}^{2}(\\boldsymbol{X})$ for each species (note the squares of stoichiometric coefficients):\n$$\n\\sigma_{A}^{2} = \\nu_{1A}^{2} a_{1} + \\nu_{2A}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46,\n$$\n$$\n\\sigma_{B}^{2} = \\nu_{1B}^{2} a_{1} + \\nu_{2B}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46,\n$$\n$$\n\\sigma_{C}^{2} = \\nu_{1C}^{2} a_{1} + \\nu_{2C}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46.\n$$\nWith $\\epsilon = 0.05$, the species-wise constraints are:\n\nFor species $A$ ($X_{A} = 120$):\n$$\n\\frac{\\epsilon X_{A}}{|\\mu_{A}|} = \\frac{0.05 \\cdot 120}{0.54} = \\frac{6}{0.54} \\approx 11.111111\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{A})^{2}}{\\sigma_{A}^{2}} = \\frac{(6)^{2}}{2.46} = \\frac{36}{2.46} \\approx 14.634146\\ldots,\n$$\nthus $\\tau_{A} \\le \\min(11.111111\\ldots, 14.634146\\ldots) = 11.111111\\ldots$.\n\nFor species $B$ ($X_{B} = 80$):\n$$\n\\frac{\\epsilon X_{B}}{|\\mu_{B}|} = \\frac{0.05 \\cdot 80}{0.54} = \\frac{4}{0.54} \\approx 7.407407\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{B})^{2}}{\\sigma_{B}^{2}} = \\frac{(4)^{2}}{2.46} = \\frac{16}{2.46} \\approx 6.504065\\ldots,\n$$\nthus $\\tau_{B} \\le \\min(7.407407\\ldots, 6.504065\\ldots) = 6.504065\\ldots$.\n\nFor species $C$ ($X_{C} = 30$):\n$$\n\\frac{\\epsilon X_{C}}{|\\mu_{C}|} = \\frac{0.05 \\cdot 30}{0.54} = \\frac{1.5}{0.54} \\approx 2.777777\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{C})^{2}}{\\sigma_{C}^{2}} = \\frac{(1.5)^{2}}{2.46} = \\frac{2.25}{2.46} \\approx 0.914634\\ldots,\n$$\nthus $\\tau_{C} \\le \\min(2.777777\\ldots, 0.914634\\ldots) = 0.914634\\ldots$.\n\nTo satisfy all species simultaneously, we must take\n$$\n\\tau \\le \\min\\left( \\tau_{A}, \\tau_{B}, \\tau_{C} \\right) = 0.914634\\ldots \\ \\text{seconds}.\n$$\nTherefore, the adaptive $\\tau$ chosen under this bound is\n$$\n\\tau = 0.914634\\ldots \\ \\text{seconds}.\n$$\nRounded to four significant figures, this gives\n$$\n\\tau \\approx 0.9146 \\ \\text{seconds}.\n$$",
            "answer": "$$\\boxed{0.9146}$$"
        },
        {
            "introduction": "While the tau-selection method from the previous practice controls for accuracy, it does not inherently prevent a critical numerical artifact: species populations dropping below zero. This problem  confronts this common pitfall, which arises from modeling the consumption of a finite number of reactants with an unbounded Poisson distribution. You will analyze why this issue occurs and evaluate standard algorithmic modifications designed to guarantee the physical non-negativity of molecular counts in every leap.",
            "id": "3935736",
            "problem": "In a well-mixed cytosolic compartment of a biomedical system, consider the bimolecular reaction $A + B \\to C$ under the Chemical Master Equation (CME) framework. Under stochastic mass-action kinetics, the propensity for this reaction at state $(X_A, X_B)$ is $a(X_A, X_B) = c\\,X_A\\,X_B$, where $c$ is the stochastic rate constant. The $\\tau$-leaping approximation accelerates simulation by assuming propensities remain approximately constant over a leap of duration $\\tau$ and drawing the number of firings over the leap, $K(\\tau)$, as independent Poisson random variables with mean $a(X_A, X_B)\\,\\tau$.\n\nSuppose the initial molecule counts are $X_A(0) = 100$, $X_B(0) = 5$, the stochastic rate constant is $c = 0.003$ (per unit time per molecule pair), and the leap size is $\\tau = 8$ (time units). Under the mass-action propensity, the expected number of firings over the leap is $\\mu = a(X_A(0), X_B(0))\\,\\tau$. If one draws $K(\\tau) \\sim \\mathrm{Poisson}(\\mu)$, note that each firing consumes one molecule of $A$ and one molecule of $B$, so any realization with $K(\\tau) > \\min\\{X_A(0), X_B(0)\\}$ would lead to negative counts of at least one reactant.\n\nUsing the CME definition of propensity, the $\\tau$-leaping assumption of locally constant propensities, and the properties of the Poisson distribution, demonstrate why unbounded Poisson draws $K(\\tau)$ can produce negative $X_A$ or $X_B$ in this scenario, and compute the maximum number of firings $m$ that can occur without violating nonnegativity. Then, select all modifications to $K(\\tau)$ that guarantee $X_A$ and $X_B$ remain nonnegative for any realization while preserving the accelerated spirit of the $\\tau$-leap.\n\nWhich of the following modifications to $K(\\tau)$ satisfy this guarantee?\n\nA. Replace $K(\\tau)$ by $K^{\\star}(\\tau) = \\min\\{\\mathrm{Poisson}(a(X_A, X_B)\\,\\tau),\\,m\\}$, where $m = \\min\\{X_A, X_B\\}$ at the beginning of the leap.\n\nB. Replace $K(\\tau)$ by $K^{\\star}(\\tau) \\sim \\mathrm{Binomial}(m, p)$ with $m = \\min\\{X_A, X_B\\}$ and $p = a(X_A, X_B)\\,\\tau / m$ if $p \\le 1$, otherwise reduce $\\tau$ so that $p \\le 1$.\n\nC. Keep $K(\\tau) \\sim \\mathrm{Poisson}(a(X_A, X_B)\\,\\tau)$ but choose $\\tau$ so that $a(X_A, X_B)\\,\\tau \\le m$.\n\nD. Approximate $K(\\tau)$ by a Gaussian random variable $\\mathcal{N}(a(X_A, X_B)\\,\\tau,\\,a(X_A, X_B)\\,\\tau)$ and clip negative realizations to zero.\n\nE. Partition reactions into critical and noncritical, treat $A + B \\to C$ as critical, and select $\\tau$ so that the probability $\\mathbb{P}\\{K(\\tau) > m\\}$ is below a small threshold, but otherwise keep $K(\\tau) \\sim \\mathrm{Poisson}(a(X_A, X_B)\\,\\tau)$ unmodified.\n\nAnswer with all correct options.",
            "solution": "First, we analyze why the standard explicit tau-leaping method can fail. The propensity of the reaction $A + B \\to C$ at the start of the leap is:\n$$ a(X_A(0), X_B(0)) = c \\cdot X_A(0) \\cdot X_B(0) = 0.003 \\cdot 100 \\cdot 5 = 1.5 $$\nThe mean number of reaction firings over the time leap $\\tau = 8$ is:\n$$ \\mu = a(X_A(0), X_B(0)) \\cdot \\tau = 1.5 \\cdot 8 = 12 $$\nThe tau-leaping algorithm draws the number of firings, $K(\\tau)$, from a Poisson distribution with this mean: $K(\\tau) \\sim \\mathrm{Poisson}(12)$.\n\nEach reaction consumes one molecule of species A and one of B. To ensure that the populations remain non-negative, the number of firings $K(\\tau)$ must not exceed the available number of molecules of any reactant. This sets an upper bound on $K(\\tau)$:\n$$ K(\\tau) \\le \\min\\{X_A(0), X_B(0)\\} = \\min\\{100, 5\\} = 5 $$\nThe maximum number of firings that can occur is $m = 5$.\n\nThe standard algorithm draws from $\\mathrm{Poisson}(12)$. The support of a Poisson distribution is all non-negative integers, and with a mean of 12, the probability of drawing a number greater than 5 is very high ($\\mathbb{P}(K(\\tau) > 5) \\approx 0.997$). Any such draw would result in a negative population for species B.\n\nThe task is to identify modifications that *guarantee* non-negativity for *any* realization. This means the number of firings drawn, $K^{\\star}(\\tau)$, must be less than or equal to $m=5$ with probability 1.\n\nLet's evaluate each option:\n\n**A. Replace $K(\\tau)$ by $K^{\\star}(\\tau) = \\min\\{\\mathrm{Poisson}(a(X_A, X_B)\\,\\tau),\\,m\\}$...**\nThis method, known as clipping, draws a number from the Poisson distribution and then takes the minimum of that number and the non-negativity bound $m$. By definition, the result $K^{\\star}(\\tau)$ cannot be greater than $m$. This guarantees that the reactant populations will remain non-negative. **This option is correct.**\n\n**B. Replace $K(\\tau)$ by $K^{\\star}(\\tau) \\sim \\mathrm{Binomial}(m, p)$...**\nThis method replaces the Poisson draw with a binomial draw. A random variable from a binomial distribution $\\mathrm{Binomial}(n, p)$ can only take integer values between 0 and $n$ (inclusive). Here, the number of trials is set to $n=m=\\min\\{X_A, X_B\\}$. Therefore, any realization of $K^{\\star}(\\tau)$ will be in the range $[0, m]$, guaranteeing non-negativity. This is a standard and physically motivated approach known as binomial tau-leaping. **This option is correct.**\n\n**C. Keep $K(\\tau) \\sim \\mathrm{Poisson}(a(X_A, X_B)\\,\\tau)$ but choose $\\tau$ so that $a(X_A, X_B)\\,\\tau \\le m$.**\nThis modification only limits the *mean* of the Poisson distribution. However, the Poisson distribution has non-zero probability for any integer value greater than its mean. Even if the mean is $\\le m$, there is still a finite probability that the drawn number of firings will be $> m$. Therefore, this method does not provide a guarantee. **This option is incorrect.**\n\n**D. Approximate $K(\\tau)$ by a Gaussian random variable...**\nThe Gaussian (normal) distribution is continuous and has support on the entire real line $(-\\infty, \\infty)$. A draw from this distribution can be greater than $m$, so it does not guarantee non-negativity. **This option is incorrect.**\n\n**E. Partition reactions into critical and noncritical... and select $\\tau$ so that the probability $\\mathbb{P}\\{K(\\tau) > m\\}$ is below a small threshold...**\nThis method aims to make the probability of failure very small, but not zero. Since the problem asks for a *guarantee* for *any* realization, a method that allows for failure with a non-zero (even if tiny) probability is not a valid answer. **This option is incorrect.**\n\nThe only options that provide an absolute guarantee of non-negativity are A and B.",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "Having learned to select $\\tau$ and ensure non-negativity, we now turn to a more formal analysis of the approximation itself. This practice  provides a direct comparison between the one-step moment dynamics of the tau-leaping algorithm and the exact moment equations derived from the Chemical Master Equation for a linear system. By calculating the difference in the updated mean and variance, you will gain a precise understanding of how the tau-leaping approximation captures the system's drift and diffusion, and you will pinpoint the source of its leading-order error.",
            "id": "3935735",
            "problem": "Consider a single-species transcriptional birthâ€“death process used in biomedical systems modeling of messenger ribonucleic acid (mRNA) dynamics. The state $X(t)$ is the mRNA copy number. The network consists of two reactions: a zero-order birth $\\varnothing \\to X$ with intensity $k_{s}$ (molecules per minute), and a first-order death $X \\to \\varnothing$ with intensity $k_{d} X$ (per minute). Let the stoichiometric changes be $\\nu_{1} = +1$ for birth and $\\nu_{2} = -1$ for death, and the propensity functions be $a_{1}(x) = k_{s}$ and $a_{2}(x) = k_{d} x$.\n\nSuppose the initial distribution of $X(0)$ has mean $m_{0} = 100$ and covariance (variance, in the scalar case) $S_{0} = 100$, representative of a Poisson-like initialization. Take $k_{s} = 60$ (molecules per minute), $k_{d} = 0.5$ (per minute), and a one-step explicit tau-leaping time increment $\\tau = 0.5$ (minutes). The explicit tau-leaping algorithm freezes propensities at the current state and samples reaction counts from independent Poisson distributions.\n\nStarting from fundamental definitions of the Chemical Master Equation (CME) and the tau-leaping construction, derive from first principles the one-step updates for the mean and covariance of $X$ produced by explicit tau-leaping. Independently, derive the exact first-order moment dynamics for this linear reaction network and obtain the corresponding one-step updates for the mean and covariance using a first-order forward Euler time discretization of the exact moment ordinary differential equations (ODEs).\n\nFinally, compute the numerical values of the differences $\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau)$ and $\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau)$, where the subscripts $\\mathrm{TL}$ and $\\mathrm{EX}$ denote the tau-leaping and the exact moment updates, respectively. Round your final numbers to four significant figures. Express counts in molecules.",
            "solution": "The problem asks for a comparison of moment dynamics after one time step, $\\tau$, using two different methods: explicit tau-leaping and a forward Euler discretization of the exact moment ordinary differential equations (ODEs). Let $X_0 = X(0)$ be the initial state. The initial mean is $m_0 = \\langle X_0 \\rangle$ and the initial variance is $S_0 = \\langle (X_0 - m_0)^2 \\rangle$.\n\n**Part 1: Explicit Tau-Leaping (TL) Updates**\n\nThe explicit tau-leaping approximation updates the state $X(t)$ over a time interval $\\tau$ as:\n$$\nX(t+\\tau) \\approx X(t) + \\sum_{j=1}^{2} \\nu_j K_j\n$$\nwhere $K_j$ is the number of times reaction $j$ occurs in $[t, t+\\tau)$. For explicit tau-leaping, $K_j$ is a random variable drawn from a Poisson distribution with parameter $a_j(X(t))\\tau$. The two reactions are independent.\n$$\nK_1 \\sim \\mathrm{Pois}(a_1(X(t))\\tau) = \\mathrm{Pois}(k_s \\tau) \\\\\nK_2 \\sim \\mathrm{Pois}(a_2(X(t))\\tau) = \\mathrm{Pois}(k_d X(t) \\tau)\n$$\nThe state update from $t=0$ is:\n$$\nX(\\tau) = X_0 + \\nu_1 K_1 + \\nu_2 K_2 = X_0 + K_1 - K_2\n$$\n\nTo find the moments of $X(\\tau)$, we use the laws of total expectation and total variance, conditioning on the initial state $X_0$.\nLet $x_0$ be a realization of $X_0$.\n\nThe conditional mean of $X(\\tau)$ given $X_0 = x_0$ is:\n$$\n\\mathbb{E}[X(\\tau) | X_0=x_0] = \\mathbb{E}[x_0 + K_1 - K_2 | X_0=x_0] = x_0 + \\mathbb{E}[K_1|X_0=x_0] - \\mathbb{E}[K_2|X_0=x_0]\n$$\nThe mean of a Poisson-distributed variable is its parameter.\n$$\n\\mathbb{E}[K_1|X_0=x_0] = k_s \\tau \\\\\n\\mathbb{E}[K_2|X_0=x_0] = k_d x_0 \\tau\n$$\nThus,\n$$\n\\mathbb{E}[X(\\tau) | X_0=x_0] = x_0 + k_s \\tau - k_d x_0 \\tau = (1 - k_d \\tau)x_0 + k_s \\tau\n$$\nThe unconditional mean $m_{\\mathrm{TL}}(\\tau) = \\langle X(\\tau) \\rangle$ is the expectation of the conditional mean over the distribution of $X_0$:\n$$\nm_{\\mathrm{TL}}(\\tau) = \\langle \\mathbb{E}[X(\\tau) | X_0] \\rangle = \\langle (1 - k_d \\tau)X_0 + k_s \\tau \\rangle = (1 - k_d \\tau)\\langle X_0 \\rangle + k_s \\tau\n$$\n$$\nm_{\\mathrm{TL}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n\nThe conditional variance of $X(\\tau)$ given $X_0=x_0$ is:\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = \\mathrm{Var}(x_0 + K_1 - K_2 | X_0=x_0)\n$$\nSince $K_1$ and $K_2$ are independent conditional on $x_0$:\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = \\mathrm{Var}(K_1|X_0=x_0) + \\mathrm{Var}(K_2|X_0=x_0)\n$$\nThe variance of a Poisson-distributed variable is equal to its mean.\n$$\n\\mathrm{Var}(K_1|X_0=x_0) = k_s \\tau \\\\\n\\mathrm{Var}(K_2|X_0=x_0) = k_d x_0 \\tau\n$$\nSo,\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = k_s \\tau + k_d x_0 \\tau\n$$\nThe unconditional variance $S_{\\mathrm{TL}}(\\tau) = \\mathrm{Var}(X(\\tau))$ is given by the law of total variance:\n$$\nS_{\\mathrm{TL}}(\\tau) = \\mathbb{E}[\\mathrm{Var}(X(\\tau)|X_0)] + \\mathrm{Var}(\\mathbb{E}[X(\\tau)|X_0])\n$$\nThe first term is:\n$$\n\\mathbb{E}[\\mathrm{Var}(X(\\tau)|X_0)] = \\langle k_s \\tau + k_d X_0 \\tau \\rangle = k_s \\tau + k_d \\tau \\langle X_0 \\rangle = (k_s + k_d m_0)\\tau\n$$\nThe second term is:\n$$\n\\mathrm{Var}(\\mathbb{E}[X(\\tau)|X_0]) = \\mathrm{Var}((1 - k_d \\tau)X_0 + k_s \\tau) = (1 - k_d \\tau)^2 \\mathrm{Var}(X_0) = (1 - k_d \\tau)^2 S_0\n$$\nCombining the terms:\n$$\nS_{\\mathrm{TL}}(\\tau) = (k_s + k_d m_0)\\tau + (1 - k_d \\tau)^2 S_0\n$$\n\n**Part 2: Exact Moment (EX) ODEs and Euler Discretization**\n\nThe time evolution of the expectation of any function $f(X)$ is given by:\n$$\n\\frac{d\\langle f(X) \\rangle}{dt} = \\sum_{j=1}^{2} \\langle a_j(X) [f(X+\\nu_j) - f(X)] \\rangle\n$$\nFor the mean $m(t)=\\langle X(t) \\rangle$, we set $f(X)=X$:\n$$\n\\frac{dm}{dt} = \\langle a_1(X)[(X+1)-X] \\rangle + \\langle a_2(X)[(X-1)-X] \\rangle\n$$\n$$\n\\frac{dm}{dt} = \\langle k_s(1) \\rangle + \\langle k_d X(-1) \\rangle = k_s - k_d \\langle X \\rangle = k_s - k_d m\n$$\nThis ODE is exact and closed as the network is linear.\n\nFor the variance $S(t) = \\langle X^2 \\rangle - m^2$, we first find the ODE for the second moment $\\langle X^2 \\rangle$ by setting $f(X)=X^2$:\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = \\langle k_s[(X+1)^2-X^2] \\rangle + \\langle k_d X[(X-1)^2-X^2] \\rangle\n$$\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = \\langle k_s(2X+1) \\rangle + \\langle k_d X(-2X+1) \\rangle = 2k_s\\langle X \\rangle + k_s - 2k_d\\langle X^2 \\rangle + k_d\\langle X \\rangle\n$$\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = (2k_s+k_d)m - 2k_d\\langle X^2 \\rangle + k_s\n$$\nNow, we find the ODE for the variance $S(t)$:\n$$\n\\frac{dS}{dt} = \\frac{d\\langle X^2 \\rangle}{dt} - \\frac{d(m^2)}{dt} = \\frac{d\\langle X^2 \\rangle}{dt} - 2m\\frac{dm}{dt}\n$$\n$$\n\\frac{dS}{dt} = \\left( (2k_s+k_d)m - 2k_d\\langle X^2 \\rangle + k_s \\right) - 2m(k_s - k_d m)\n$$\n$$\n\\frac{dS}{dt} = 2k_sm + k_dm - 2k_d\\langle X^2 \\rangle + k_s - 2k_sm + 2k_dm^2\n$$\n$$\n\\frac{dS}{dt} = k_dm + k_s - 2k_d(\\langle X^2 \\rangle - m^2) = k_s + k_d m - 2k_d S\n$$\nThis ODE is also exact and closed.\n\nNow, we discretize these ODEs using the first-order forward Euler method, $y(t+\\tau) \\approx y(t) + \\tau y'(t)$, starting from $t=0$:\n$$\nm_{\\mathrm{EX}}(\\tau) = m_0 + \\tau \\left. \\frac{dm}{dt} \\right|_{t=0} = m_0 + \\tau (k_s - k_d m_0) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\nS_{\\mathrm{EX}}(\\tau) = S_0 + \\tau \\left. \\frac{dS}{dt} \\right|_{t=0} = S_0 + \\tau (k_s + k_d m_0 - 2k_d S_0)\n$$\n\n**Part 3: Comparison and Numerical Calculation**\n\nWe compute the differences $\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau)$ and $\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau)$.\n\nDifference in mean:\n$$\nm_{\\mathrm{TL}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\nm_{\\mathrm{EX}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\n\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau) = 0\n$$\n\nDifference in variance:\n$$\nS_{\\mathrm{TL}}(\\tau) = (k_s + k_d m_0)\\tau + (1 - k_d \\tau)^2 S_0 = (k_s + k_d m_0)\\tau + (1 - 2k_d \\tau + k_d^2 \\tau^2) S_0\n$$\n$$\nS_{\\mathrm{TL}}(\\tau) = k_s \\tau + k_d m_0 \\tau + S_0 - 2k_d S_0 \\tau + k_d^2 \\tau^2 S_0\n$$\n$$\nS_{\\mathrm{EX}}(\\tau) = S_0 + \\tau(k_s + k_d m_0 - 2k_d S_0) = S_0 + k_s \\tau + k_d m_0 \\tau - 2k_d S_0 \\tau\n$$\nThe difference is:\n$$\n\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau) = (k_s \\tau + k_d m_0 \\tau + S_0 - 2k_d S_0 \\tau + k_d^2 \\tau^2 S_0) - (S_0 + k_s \\tau + k_d m_0 \\tau - 2k_d S_0 \\tau)\n$$\nAll terms cancel except for the last term in the $S_{\\mathrm{TL}}(\\tau)$ expansion:\n$$\n\\Delta S = k_d^2 \\tau^2 S_0\n$$\nThis shows that the variance from tau-leaping method includes an additional term of order $\\tau^2$ compared to the forward-Euler approximation of the exact variance dynamics.\n\nFinally, we substitute the numerical values:\n- $k_s = 60$\n- $k_d = 0.5$\n- $\\tau = 0.5$\n- $m_0 = 100$\n- $S_0 = 100$\n\n$$\n\\Delta m = 0\n$$\n$$\n\\Delta S = (0.5)^2 \\times (0.5)^2 \\times 100 = 0.25 \\times 0.25 \\times 100 = 0.0625 \\times 100 = 6.25\n$$\nRounding to four significant figures, we get $\\Delta m = 0$ and $\\Delta S = 6.250$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & 6.250 \\end{pmatrix}}$$"
        }
    ]
}