{
    "hands_on_practices": [
        {
            "introduction": "Tau-leaping方法的核心在于选择一个时间步长$\\tau$，它既要足够大以实现模拟加速，又要足够小以满足“跳跃条件”，即倾向函数在时间步内保持近似恒定。本练习将指导您通过限制各物种数量的期望漂移和随机扩散来推导出一个标准的自适应$\\tau$选择准则。通过这个实践，您将理解tau-leaping算法的基石——自适应时间步长选择背后的数学原理 。",
            "id": "3935710",
            "problem": "考虑一个由化学主方程（CME）建模、在随机模拟算法（SSA）下模拟的充分混合的生化系统。该系统包含三种分子种类，其离散的拷贝数表示为 $X_{A}$、$X_{B}$ 和 $X_{C}$，在质量作用动力学下经历两个反应通道：\n$$\nR_{1}: A + B \\to C, \\quad R_{2}: C \\to A + B.\n$$\n令反应 $j$ 的化学计量变化向量为 $\\boldsymbol{\\nu}_{j} = (\\nu_{jA}, \\nu_{jB}, \\nu_{jC})$，其中 $j \\in \\{1,2\\}$。在质量作用动力学下，反应 $j$ 的倾向函数为 $a_{j}(\\boldsymbol{X}) = c_{j} h_{j}(\\boldsymbol{X})$，其中 $c_{j} > 0$ 是速率常数，$h_{j}(\\boldsymbol{X})$ 计算与化学计量要求一致的不同反应物组合的数量。对于上述反应，可得\n$$\na_{1}(\\boldsymbol{X}) = c_{1} X_{A} X_{B}, \\quad a_{2}(\\boldsymbol{X}) = c_{2} X_{C}.\n$$\n在用于加速随机模拟的 $\\tau$-跳跃近似中，选择一个跳跃间隔 $\\tau > 0$，使得每个倾向函数在 $[t, t+\\tau)$ 上大致保持恒定，这一点可以通过对每个物种数量相对于其当前值的期望涨落和典型涨落进行限制来保证。\n\n从 $\\tau$-跳跃的定义出发——即反应 $j$ 在 $[t, t+\\tau)$ 内的发生次数被建模为均值为 $a_{j}(\\boldsymbol{X})\\,\\tau$ 的泊松随机变量——通过要求每个物种 $i \\in \\{A,B,C\\}$ 的相对变化的均值和方差贡献都受预设容差 $\\epsilon \\in (0,1)$ 的限制，推导出一个用物种数量 $\\boldsymbol{X}$、化学计量系数 $\\nu_{ji}$ 和质量作用倾向函数 $a_{j}(\\boldsymbol{X})$ 表示的 $\\tau$ 的自适应上界。\n\n然后，对于状态\n$$\nX_{A} = 120, \\quad X_{B} = 80, \\quad X_{C} = 30,\n$$\n速率常数\n$$\nc_{1} = 1.0 \\times 10^{-4} \\ \\text{s}^{-1}, \\quad c_{2} = 5.0 \\times 10^{-2} \\ \\text{s}^{-1},\n$$\n以及容差\n$$\n\\epsilon = 0.05,\n$$\n计算满足您推导出的界限的相应自适应 $\\tau$。以秒为单位表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "我们从化学主方程（CME）的角度开始，其中状态 $\\boldsymbol{X}(t)$ 作为一个连续时间马尔可夫跳跃过程演化。在 $\\tau$-跳跃近似下，当跳跃条件成立时（即倾向函数在短时间内大致保持恒定），反应 $j$ 在时间间隔 $[t,t+\\tau)$ 内的发生次数可以近似为一个均值为 $a_{j}(\\boldsymbol{X}(t))\\,\\tau$ 的泊松随机变量 $P_{j}(\\tau)$。\n\n令反应 $j$ 的化学计量变化向量为 $\\boldsymbol{\\nu}_{j} = (\\nu_{jA}, \\nu_{jB}, \\nu_{jC})$，那么物种 $i$ 在跳跃间隔内的净变化为\n$$\n\\Delta X_{i}(\\tau) = \\sum_{j} \\nu_{ji} P_{j}(\\tau).\n$$\n因为 $P_{j}(\\tau)$ 是参数为 $a_{j}(\\boldsymbol{X})\\,\\tau$ 的（近似）独立的泊松随机变量，所以它们的均值和方差为\n$$\n\\mathbb{E}[P_{j}(\\tau)] = a_{j}(\\boldsymbol{X})\\,\\tau, \\quad \\mathrm{Var}[P_{j}(\\tau)] = a_{j}(\\boldsymbol{X})\\,\\tau.\n$$\n因此，对于每个物种 $i$，其净变化的均值和方差为\n$$\n\\mathbb{E}[\\Delta X_{i}(\\tau)] = \\sum_{j} \\nu_{ji} \\, \\mathbb{E}[P_{j}(\\tau)] = \\left( \\sum_{j} \\nu_{ji} a_{j}(\\boldsymbol{X}) \\right) \\tau \\equiv \\mu_{i}(\\boldsymbol{X}) \\, \\tau,\n$$\n$$\n\\mathrm{Var}[\\Delta X_{i}(\\tau)] = \\sum_{j} \\nu_{ji}^{2} \\, \\mathrm{Var}[P_{j}(\\tau)] = \\left( \\sum_{j} \\nu_{ji}^{2} a_{j}(\\boldsymbol{X}) \\right) \\tau \\equiv \\sigma_{i}^{2}(\\boldsymbol{X}) \\, \\tau,\n$$\n利用独立性以及对于独立的 $Z_j$，有 $\\mathrm{Var}\\left(\\sum_{j} Z_{j}\\right)=\\sum_{j} \\mathrm{Var}(Z_{j})$ 这一性质。\n\n为了维持跳跃条件，一个常见的准则是将每个物种 $i$ 的期望相对变化和典型涨落的一个度量（通过方差）都限制在一个小的容差 $\\epsilon \\in (0,1)$ 内。具体来说，我们强制要求\n$$\n\\frac{|\\mathbb{E}[\\Delta X_{i}(\\tau)]|}{X_{i}} \\le \\epsilon, \\quad \\frac{\\sqrt{\\mathrm{Var}[\\Delta X_{i}(\\tau)]}}{X_{i}} \\le \\epsilon,\n$$\n对于所有物种 $i$。代入均值和方差的表达式可得\n$$\n\\frac{|\\mu_{i}(\\boldsymbol{X})|\\,\\tau}{X_{i}} \\le \\epsilon \\quad \\Rightarrow \\quad \\tau \\le \\frac{\\epsilon X_{i}}{|\\mu_{i}(\\boldsymbol{X})|},\n$$\n和\n$$\n\\frac{\\sqrt{\\sigma_{i}^{2}(\\boldsymbol{X})\\,\\tau}}{X_{i}} \\le \\epsilon \\quad \\Rightarrow \\quad \\sqrt{\\tau} \\le \\frac{\\epsilon X_{i}}{\\sqrt{\\sigma_{i}^{2}(\\boldsymbol{X})}} \\quad \\Rightarrow \\quad \\tau \\le \\frac{(\\epsilon X_{i})^{2}}{\\sigma_{i}^{2}(\\boldsymbol{X})}.\n$$\n为了对所有物种都满足这两个约束，$\\tau$ 的自适应上界因此是\n$$\n\\tau \\le \\min_{i} \\left\\{ \\min \\left( \\frac{\\epsilon X_{i}}{|\\mu_{i}(\\boldsymbol{X})|}, \\ \\frac{(\\epsilon X_{i})^{2}}{\\sigma_{i}^{2}(\\boldsymbol{X})} \\right) \\right\\},\n$$\n其中\n$$\n\\mu_{i}(\\boldsymbol{X}) = \\sum_{j} \\nu_{ji} a_{j}(\\boldsymbol{X}), \\quad \\sigma_{i}^{2}(\\boldsymbol{X}) = \\sum_{j} \\nu_{ji}^{2} a_{j}(\\boldsymbol{X}).\n$$\n这表示了用物种数量 $X_{i}$、化学计量系数 $\\nu_{ji}$ 和质量作用倾向函数 $a_{j}(\\boldsymbol{X})$ 表示的自适应 $\\tau$ 界限。\n\n我们现在为这个特定系统计算 $\\tau$。化学计量关系为\n$$\n\\boldsymbol{\\nu}_{1} = (-1, -1, +1), \\quad \\boldsymbol{\\nu}_{2} = (+1, +1, -1).\n$$\n在给定状态和速率常数下，倾向函数为\n$$\na_{1}(\\boldsymbol{X}) = c_{1} X_{A} X_{B} = \\left(1.0 \\times 10^{-4}\\right) \\cdot 120 \\cdot 80 = 0.96,\n$$\n$$\na_{2}(\\boldsymbol{X}) = c_{2} X_{C} = \\left(5.0 \\times 10^{-2}\\right) \\cdot 30 = 1.5.\n$$\n计算每个物种的 $\\mu_{i}(\\boldsymbol{X})$：\n$$\n\\mu_{A} = \\nu_{1A} a_{1} + \\nu_{2A} a_{2} = (-1)\\cdot 0.96 + (+1)\\cdot 1.5 = 0.54,\n$$\n$$\n\\mu_{B} = \\nu_{1B} a_{1} + \\nu_{2B} a_{2} = (-1)\\cdot 0.96 + (+1)\\cdot 1.5 = 0.54,\n$$\n$$\n\\mu_{C} = \\nu_{1C} a_{1} + \\nu_{2C} a_{2} = (+1)\\cdot 0.96 + (-1)\\cdot 1.5 = -0.54.\n$$\n计算每个物种的 $\\sigma_{i}^{2}(\\boldsymbol{X})$（注意化学计量系数的平方）：\n$$\n\\sigma_{A}^{2} = \\nu_{1A}^{2} a_{1} + \\nu_{2A}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46,\n$$\n$$\n\\sigma_{B}^{2} = \\nu_{1B}^{2} a_{1} + \\nu_{2B}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46,\n$$\n$$\n\\sigma_{C}^{2} = \\nu_{1C}^{2} a_{1} + \\nu_{2C}^{2} a_{2} = (1)\\cdot 0.96 + (1)\\cdot 1.5 = 2.46.\n$$\n当 $\\epsilon = 0.05$ 时，各物种的约束条件为：\n\n对于物种 A ($X_{A} = 120$)：\n$$\n\\frac{\\epsilon X_{A}}{|\\mu_{A}|} = \\frac{0.05 \\cdot 120}{0.54} = \\frac{6}{0.54} \\approx 11.111111\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{A})^{2}}{\\sigma_{A}^{2}} = \\frac{(6)^{2}}{2.46} = \\frac{36}{2.46} \\approx 14.634146\\ldots,\n$$\n因此 $\\tau_{A} \\le \\min(11.111111\\ldots, 14.634146\\ldots) = 11.111111\\ldots$。\n\n对于物种 B ($X_{B} = 80$)：\n$$\n\\frac{\\epsilon X_{B}}{|\\mu_{B}|} = \\frac{0.05 \\cdot 80}{0.54} = \\frac{4}{0.54} \\approx 7.407407\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{B})^{2}}{\\sigma_{B}^{2}} = \\frac{(4)^{2}}{2.46} = \\frac{16}{2.46} \\approx 6.504065\\ldots,\n$$\n因此 $\\tau_{B} \\le \\min(7.407407\\ldots, 6.504065\\ldots) = 6.504065\\ldots$。\n\n对于物种 C ($X_{C} = 30$)：\n$$\n\\frac{\\epsilon X_{C}}{|\\mu_{C}|} = \\frac{0.05 \\cdot 30}{0.54} = \\frac{1.5}{0.54} \\approx 2.777777\\ldots,\n$$\n$$\n\\frac{(\\epsilon X_{C})^{2}}{\\sigma_{C}^{2}} = \\frac{(1.5)^{2}}{2.46} = \\frac{2.25}{2.46} \\approx 0.914634\\ldots,\n$$\n因此 $\\tau_{C} \\le \\min(2.777777\\ldots, 0.914634\\ldots) = 0.914634\\ldots$。\n\n为了同时满足所有物种的条件，我们必须取\n$$\n\\tau \\le \\min\\left( \\tau_{A}, \\tau_{B}, \\tau_{C} \\right) = 0.914634\\ldots \\ \\text{seconds}.\n$$\n因此，在此界限下选择的自适应 $\\tau$ 为\n$$\n\\tau = 0.914634\\ldots \\ \\text{seconds}.\n$$\n四舍五入到四位有效数字，得到\n$$\n\\tau \\approx 0.9146 \\ \\text{seconds}.\n$$",
            "answer": "$$\\boxed{0.9146}$$"
        },
        {
            "introduction": "Tau-leaping方法是一种近似，但它到底近似了什么？本练习将为这个问题提供一个精确的答案，通过比较tau-leaping方法与从化学主方程（CME）推导出的精确矩动力学，来分析系统状态的前两个矩（均值和方差）的演化。这个对比不仅揭示了该方法所引入的误差的性质和阶数，而且加深了我们对tau-leaping作为随机过程近似的理解 。",
            "id": "3935735",
            "problem": "考虑一个用于信使核糖核酸（mRNA）动力学的生物医学系统建模的单物种转录生灭过程。状态 $X(t)$ 是 mRNA 的拷贝数。该网络包含两个反应：强度为 $k_{s}$（分子/分钟）的零级生成反应 $\\varnothing \\to X$，以及强度为 $k_{d} X$（每分钟）的一级降解反应 $X \\to \\varnothing$。令生成反应的化学计量变化为 $\\nu_{1} = +1$，降解反应的化学计量变化为 $\\nu_{2} = -1$，倾向函数分别为 $a_{1}(x) = k_{s}$ 和 $a_{2}(x) = k_{d} x$。\n\n假设 $X(0)$ 的初始分布均值为 $m_{0} = 100$，协方差（在标量情况下为方差）为 $S_{0} = 100$，代表一个类泊松分布的初始化。取 $k_{s} = 60$（分子/分钟），$k_{d} = 0.5$（每分钟），以及一步显式 tau-leaping 时间增量 $\\tau = 0.5$（分钟）。显式 tau-leaping 算法在当前状态下冻结倾向函数，并从独立的泊松分布中采样反应计数。\n\n从化学主方程（CME）和 tau-leaping 构造的基本定义出发，根据第一性原理推导由显式 tau-leaping 产生的一步更新后的 $X$ 的均值和协方差。独立地，推导该线性反应网络精确的一阶矩动力学，并使用精确矩常微分方程（ODE）的一阶前向欧拉时间离散化方法，获得对应的均值和协方差的一步更新。\n\n最后，计算差值 $\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau)$ 和 $\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau)$ 的数值，其中下标 $\\mathrm{TL}$ 和 $\\mathrm{EX}$ 分别表示 tau-leaping 和精确矩更新。将最终数值四舍五入到四位有效数字。计数单位为分子。",
            "solution": "首先根据所需准则对问题进行验证。\n\n### 问题验证\n**第 1 步：提取已知条件**\n- 系统：单物种转录生灭过程。\n- 状态变量：$X(t)$，mRNA 拷贝数。\n- 反应 1（生成）：$\\varnothing \\to X$。反应 2（降解）：$X \\to \\varnothing$。\n- 化学计量向量：$\\nu_{1} = +1$，$\\nu_{2} = -1$。\n- 倾向函数：$a_{1}(x) = k_{s}$，$a_{2}(x) = k_{d} x$。\n- $X(0)$ 的初始均值：$m_{0} = 100$。\n- $X(0)$ 的初始协方差（方差）：$S_{0} = 100$。\n- 生成速率常数：$k_{s} = 60$ 分子/分钟。\n- 降解速率常数：$k_{d} = 0.5$ 每分钟。\n- 时间增量：$\\tau = 0.5$ 分钟。\n- 模拟方法：显式 tau-leaping，其中反应计数从独立的泊松分布中采样。\n- 任务 1：从显式 tau-leaping 推导均值和协方差的一步更新。\n- 任务 2：推导精确矩 ODE 及其均值和协方差的一阶前向欧拉离散化更新。\n- 任务 3：计算数值差 $\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau)$ 和 $\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau)$。\n- 舍入：将最终数值差舍入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：**该问题描述了一个基本的生灭过程，这是随机化学动力学和系统生物学中用于模拟 mRNA 和蛋白质表达等现象的经典模型。所有原理都是公认的。\n- **适定性：**该问题是自洽的。所有必要的参数（$k_s, k_d$）、初始条件（$m_0, S_0$）和时间步长（$\\tau$）都已提供。目标陈述清晰，可以导出一个唯一且有意义的解。\n- **客观性：**问题以精确、正式且无偏见的数学语言陈述。\n\n**第 3 步：结论与行动**\n问题有效。这是一个计算系统生物学中的标准、适定问题。将提供完整解答。\n\n### 推导与求解\n该问题要求使用两种不同方法比较一个时间步长 $\\tau$ 后的矩动力学：显式 tau-leaping 和精确矩常微分方程（ODE）的前向欧拉离散化。令 $X_0 = X(0)$ 为初始状态。初始均值为 $m_0 = \\langle X_0 \\rangle$，初始方差为 $S_0 = \\langle (X_0 - m_0)^2 \\rangle$。\n\n**第 1 部分：显式 Tau-Leaping (TL) 更新**\n\n显式 tau-leaping 近似在一个时间间隔 $\\tau$ 内按如下方式更新状态 $X(t)$：\n$$\nX(t+\\tau) \\approx X(t) + \\sum_{j=1}^{2} \\nu_j K_j\n$$\n其中 $K_j$ 是反应 $j$ 在 $[t, t+\\tau)$ 时间内发生的次数。对于显式 tau-leaping， $K_j$ 是一个从参数为 $a_j(X(t))\\tau$ 的泊松分布中抽取的随机变量。这两个反应是独立的。\n$$\nK_1 \\sim \\mathrm{Pois}(a_1(X(t))\\tau) = \\mathrm{Pois}(k_s \\tau) \\\\\nK_2 \\sim \\mathrm{Pois}(a_2(X(t))\\tau) = \\mathrm{Pois}(k_d X(t) \\tau)\n$$\n从 $t=0$ 开始的状态更新为：\n$$\nX(\\tau) = X_0 + \\nu_1 K_1 + \\nu_2 K_2 = X_0 + K_1 - K_2\n$$\n\n为了求 $X(\\tau)$ 的矩，我们使用全期望定律和全方差定律，以初始状态 $X_0$为条件。\n令 $x_0$ 为 $X_0$ 的一个实现。\n\n给定 $X_0 = x_0$ 时 $X(\\tau)$ 的条件均值为：\n$$\n\\mathbb{E}[X(\\tau) | X_0=x_0] = \\mathbb{E}[x_0 + K_1 - K_2 | X_0=x_0] = x_0 + \\mathbb{E}[K_1|X_0=x_0] - \\mathbb{E}[K_2|X_0=x_0]\n$$\n泊松分布变量的均值等于其参数。\n$$\n\\mathbb{E}[K_1|X_0=x_0] = k_s \\tau \\\\\n\\mathbb{E}[K_2|X_0=x_0] = k_d x_0 \\tau\n$$\n因此，\n$$\n\\mathbb{E}[X(\\tau) | X_0=x_0] = x_0 + k_s \\tau - k_d x_0 \\tau = (1 - k_d \\tau)x_0 + k_s \\tau\n$$\n无条件均值 $m_{\\mathrm{TL}}(\\tau) = \\langle X(\\tau) \\rangle$ 是条件均值在 $X_0$ 分布上的期望：\n$$\nm_{\\mathrm{TL}}(\\tau) = \\langle \\mathbb{E}[X(\\tau) | X_0] \\rangle = \\langle (1 - k_d \\tau)X_0 + k_s \\tau \\rangle = (1 - k_d \\tau)\\langle X_0 \\rangle + k_s \\tau\n$$\n$$\nm_{\\mathrm{TL}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n\n给定 $X_0=x_0$ 时 $X(\\tau)$ 的条件方差为：\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = \\mathrm{Var}(x_0 + K_1 - K_2 | X_0=x_0)\n$$\n因为在给定 $x_0$ 的条件下 $K_1$ 和 $K_2$ 是独立的：\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = \\mathrm{Var}(K_1|X_0=x_0) + \\mathrm{Var}(K_2|X_0=x_0)\n$$\n泊松分布变量的方差等于其均值。\n$$\n\\mathrm{Var}(K_1|X_0=x_0) = k_s \\tau \\\\\n\\mathrm{Var}(K_2|X_0=x_0) = k_d x_0 \\tau\n$$\n所以，\n$$\n\\mathrm{Var}(X(\\tau) | X_0=x_0) = k_s \\tau + k_d x_0 \\tau\n$$\n无条件方差 $S_{\\mathrm{TL}}(\\tau) = \\mathrm{Var}(X(\\tau))$ 由全方差定律给出：\n$$\nS_{\\mathrm{TL}}(\\tau) = \\mathbb{E}[\\mathrm{Var}(X(\\tau)|X_0)] + \\mathrm{Var}(\\mathbb{E}[X(\\tau)|X_0])\n$$\n第一项是：\n$$\n\\mathbb{E}[\\mathrm{Var}(X(\\tau)|X_0)] = \\langle k_s \\tau + k_d X_0 \\tau \\rangle = k_s \\tau + k_d \\tau \\langle X_0 \\rangle = (k_s + k_d m_0)\\tau\n$$\n第二项是：\n$$\n\\mathrm{Var}(\\mathbb{E}[X(\\tau)|X_0]) = \\mathrm{Var}((1 - k_d \\tau)X_0 + k_s \\tau) = (1 - k_d \\tau)^2 \\mathrm{Var}(X_0) = (1 - k_d \\tau)^2 S_0\n$$\n合并各项：\n$$\nS_{\\mathrm{TL}}(\\tau) = (k_s + k_d m_0)\\tau + (1 - k_d \\tau)^2 S_0\n$$\n\n**第 2 部分：精确矩 (EX) ODE 和欧拉离散化**\n\n任意函数 $f(X)$ 的期望的时间演化由以下公式给出：\n$$\n\\frac{d\\langle f(X) \\rangle}{dt} = \\sum_{j=1}^{2} \\langle a_j(X) [f(X+\\nu_j) - f(X)] \\rangle\n$$\n对于均值 $m(t)=\\langle X(t) \\rangle$，我们设 $f(X)=X$：\n$$\n\\frac{dm}{dt} = \\langle a_1(X)[(X+1)-X] \\rangle + \\langle a_2(X)[(X-1)-X] \\rangle\n$$\n$$\n\\frac{dm}{dt} = \\langle k_s(1) \\rangle + \\langle k_d X(-1) \\rangle = k_s - k_d \\langle X \\rangle = k_s - k_d m\n$$\n由于该网络是线性的，这个 ODE 是精确且封闭的。\n\n对于方差 $S(t) = \\langle X^2 \\rangle - m^2$，我们首先通过设 $f(X)=X^2$ 来找到二阶矩 $\\langle X^2 \\rangle$ 的 ODE：\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = \\langle k_s[(X+1)^2-X^2] \\rangle + \\langle k_d X[(X-1)^2-X^2] \\rangle\n$$\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = \\langle k_s(2X+1) \\rangle + \\langle k_d X(-2X+1) \\rangle = 2k_s\\langle X \\rangle + k_s - 2k_d\\langle X^2 \\rangle + k_d\\langle X \\rangle\n$$\n$$\n\\frac{d\\langle X^2 \\rangle}{dt} = (2k_s+k_d)m - 2k_d\\langle X^2 \\rangle + k_s\n$$\n现在，我们求方差 $S(t)$ 的 ODE：\n$$\n\\frac{dS}{dt} = \\frac{d\\langle X^2 \\rangle}{dt} - \\frac{d(m^2)}{dt} = \\frac{d\\langle X^2 \\rangle}{dt} - 2m\\frac{dm}{dt}\n$$\n$$\n\\frac{dS}{dt} = \\left( (2k_s+k_d)m - 2k_d\\langle X^2 \\rangle + k_s \\right) - 2m(k_s - k_d m)\n$$\n$$\n\\frac{dS}{dt} = 2k_sm + k_dm - 2k_d\\langle X^2 \\rangle + k_s - 2k_sm + 2k_dm^2\n$$\n$$\n\\frac{dS}{dt} = k_dm + k_s - 2k_d(\\langle X^2 \\rangle - m^2) = k_s + k_d m - 2k_d S\n$$\n这个 ODE 也是精确且封闭的。\n\n现在，我们使用一阶前向欧拉方法 $y(t+\\tau) \\approx y(t) + \\tau y'(t)$，从 $t=0$ 开始离散化这些 ODE：\n$$\nm_{\\mathrm{EX}}(\\tau) = m_0 + \\tau \\left. \\frac{dm}{dt} \\right|_{t=0} = m_0 + \\tau (k_s - k_d m_0) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\nS_{\\mathrm{EX}}(\\tau) = S_0 + \\tau \\left. \\frac{dS}{dt} \\right|_{t=0} = S_0 + \\tau (k_s + k_d m_0 - 2k_d S_0)\n$$\n\n**第 3 部分：比较和数值计算**\n\n我们计算差值 $\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau)$ 和 $\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau)$。\n\n均值之差：\n$$\nm_{\\mathrm{TL}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\nm_{\\mathrm{EX}}(\\tau) = (1 - k_d \\tau)m_0 + k_s \\tau\n$$\n$$\n\\Delta m = m_{\\mathrm{TL}}(\\tau) - m_{\\mathrm{EX}}(\\tau) = 0\n$$\n\n方差之差：\n$$\nS_{\\mathrm{TL}}(\\tau) = (k_s + k_d m_0)\\tau + (1 - k_d \\tau)^2 S_0 = (k_s + k_d m_0)\\tau + (1 - 2k_d \\tau + k_d^2 \\tau^2) S_0\n$$\n$$\nS_{\\mathrm{TL}}(\\tau) = k_s \\tau + k_d m_0 \\tau + S_0 - 2k_d S_0 \\tau + k_d^2 \\tau^2 S_0\n$$\n$$\nS_{\\mathrm{EX}}(\\tau) = S_0 + \\tau(k_s + k_d m_0 - 2k_d S_0) = S_0 + k_s \\tau + k_d m_0 \\tau - 2k_d S_0 \\tau\n$$\n差值为：\n$$\n\\Delta S = S_{\\mathrm{TL}}(\\tau) - S_{\\mathrm{EX}}(\\tau) = (k_s \\tau + k_d m_0 \\tau + S_0 - 2k_d S_0 \\tau + k_d^2 \\tau^2 S_0) - (S_0 + k_s \\tau + k_d m_0 \\tau - 2k_d S_0 \\tau)\n$$\n除了 $S_{\\mathrm{TL}}(\\tau)$ 展开式中的最后一项外，所有项都抵消了：\n$$\n\\Delta S = k_d^2 \\tau^2 S_0\n$$\n这表明，与精确方差动力学的前向欧拉近似相比，tau-leaping 方法得到的方差包含一个额外的 $\\tau^2$ 阶项。\n\n最后，我们代入数值：\n- $k_s = 60$\n- $k_d = 0.5$\n- $\\tau = 0.5$\n- $m_0 = 100$\n- $S_0 = 100$\n\n$$\n\\Delta m = 0\n$$\n$$\n\\Delta S = (0.5)^2 \\times (0.5)^2 \\times 100 = 0.25 \\times 0.25 \\times 100 = 0.0625 \\times 100 = 6.25\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta m = 0$ 和 $\\Delta S = 6.250$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & 6.250 \\end{pmatrix}}$$"
        }
    ]
}