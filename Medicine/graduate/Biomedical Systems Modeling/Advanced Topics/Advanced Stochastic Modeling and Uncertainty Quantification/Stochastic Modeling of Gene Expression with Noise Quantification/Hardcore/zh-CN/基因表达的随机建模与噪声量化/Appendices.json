{
    "hands_on_practices": [
        {
            "introduction": "我们从最简单的基因表达模型开始，即基因持续处于“开启”状态。这个练习要求你使用化学主方程，从第一性原理出发，推导mRNA分子的稳态统计特性。掌握这个基本的生灭过程至关重要()，因为它揭示了随机生产和降解过程所固有的泊松性质，为理解更复杂的噪声来源提供了基准。",
            "id": "3932263",
            "problem": "考虑一个单基因，其信使核糖核酸（mRNA）分子以恒定的转录速率 $k_{m}$ 组成性产生，并以一阶速率 $\\gamma_{m}$（每个分子）独立降解。令 $m(t)$ 表示在时间 $t$ 的随机 mRNA 拷贝数，它被建模为一个在非负整数上的连续时间马尔可夫跳跃过程，其生成速率为 $k_{m}$，消亡速率为 $\\gamma_{m} m(t)$。假设系统在这种线性生灭动力学下达到一个唯一的平稳分布。\n\n从化学主方程（CME）出发，推导 $m$ 的平稳分布，并由此计算 mRNA 拷贝数的平稳均值 $\\mathrm{E}[m]$、方差 $\\mathrm{Var}(m)$ 和法诺因子（定义为 $\\mathrm{Var}(m)/\\mathrm{E}[m]$）。将您的最终答案表示为关于 $k_{m}$ 和 $\\gamma_{m}$ 的闭式解析表达式。按顺序报告这三个量：$\\mathrm{E}[m]$、$\\mathrm{Var}(m)$ 和法诺因子。mRNA 拷贝数是无量纲的；不要包含单位。不需要进行数值近似或四舍五入。",
            "solution": "该问题提出了一个关于 mRNA 分子数量 $m$ 的线性生灭过程。我们需要推导其平稳分布，并计算其前两个矩和法诺因子。\n\n首先，我们为在时间 $t$ 具有 $m$ 个分子的概率 $P(m, t)$ 建立化学主方程（CME）。该过程涉及两个反应：\n1. 生成（出生）：$\\emptyset \\xrightarrow{k_m} \\text{mRNA}$，以恒定速率 $k_m$ 发生。\n2. 降解（死亡）：$\\text{mRNA} \\xrightarrow{\\gamma_m} \\emptyset$，以速率 $\\gamma_m m$ 发生。\n\nCME 通过计算进出状态 $m$ 的概率流来描述 $P(m, t)$ 的变化率。对于一个具有 $m$ 个分子的状态，其中 $m \\ge 1$：\n- 由于生成，从状态 $m-1$ 流入的通量：$k_m P(m-1, t)$。\n- 由于降解，从状态 $m+1$ 流入的通量：$\\gamma_m (m+1) P(m+1, t)$。\n- 由于生成，流出到状态 $m+1$ 的通量：$k_m P(m, t)$。\n- 由于降解，流出到状态 $m-1$ 的通量：$\\gamma_m m P(m, t)$。\n\n将这些项合并，得到当 $m \\ge 1$ 时的 CME：\n$$\n\\frac{dP(m, t)}{dt} = k_m P(m-1, t) + \\gamma_m (m+1) P(m+1, t) - (k_m + \\gamma_m m) P(m, t)\n$$\n对于边界情况 $m=0$，没有降解，而生成只能从具有负数个分子的状态发生，这是不可能的。该方程为：\n$$\n\\frac{dP(0, t)}{dt} = \\gamma_m (1) P(1, t) - k_m P(0, t)\n$$\n\n问题指出系统达到了一个唯一的平稳分布。在平稳状态下，概率随时间恒定，因此对于所有 $m$，都有 $\\frac{dP(m, t)}{dt} = 0$。令 $P_m$ 表示具有 $m$ 个分子的平稳概率。方程组变为：\n对于 $m=0$：\n$$\n0 = \\gamma_m P_1 - k_m P_0 \\implies k_m P_0 = \\gamma_m P_1\n$$\n对于 $m \\ge 1$：\n$$\n0 = k_m P_{m-1} + \\gamma_m (m+1) P_{m+1} - (k_m + \\gamma_m m) P_m\n$$\n这组方程被细致平衡条件所满足，即在稳态下，任何两个相邻状态之间的净通量为零。从状态 $m-1$ 到 $m$ 的通量（生成）必须与从状态 $m$ 到 $m-1$ 的通量（降解）相平衡：\n$$\nk_m P_{m-1} = \\gamma_m m P_m \\quad \\text{对于 } m \\ge 1\n$$\n这可以通过将其代入平稳 CME 来验证。如果 $k_m P_{m-1} = \\gamma_m m P_m$，那么也必须有 $k_m P_m = \\gamma_m (m+1) P_{m+1}$。将这些代入 $m \\ge 1$ 的平稳方程中：\n$$\n0 = (\\gamma_m m P_m) + (k_m P_m) - (k_m + \\gamma_m m) P_m = 0\n$$\n该条件成立。因此，递推关系为 $P_m = \\frac{k_m}{\\gamma_m m} P_{m-1}$，其中 $m \\ge 1$。\n\n我们可以通过迭代求解此递推关系，以 $P_0$ 表示 $P_m$：\n对于 $m=1$：$P_1 = \\frac{k_m}{\\gamma_m} P_0$。\n对于 $m=2$：$P_2 = \\frac{k_m}{2\\gamma_m} P_1 = \\frac{k_m}{2\\gamma_m} \\left( \\frac{k_m}{\\gamma_m} P_0 \\right) = \\frac{1}{2!} \\left( \\frac{k_m}{\\gamma_m} \\right)^2 P_0$。\n对于 $m=3$：$P_3 = \\frac{k_m}{3\\gamma_m} P_2 = \\frac{k_m}{3\\gamma_m} \\left( \\frac{1}{2!} \\left( \\frac{k_m}{\\gamma_m} \\right)^2 P_0 \\right) = \\frac{1}{3!} \\left( \\frac{k_m}{\\gamma_m} \\right)^3 P_0$。\n通过归纳法，通解为：\n$$\nP_m = \\frac{1}{m!} \\left( \\frac{k_m}{\\gamma_m} \\right)^m P_0\n$$\n为了找到 $P_0$，我们使用归一化条件，即所有概率的总和必须等于 $1$：\n$$\n\\sum_{m=0}^{\\infty} P_m = 1\n$$\n代入 $P_m$ 的表达式：\n$$\n\\sum_{m=0}^{\\infty} \\frac{1}{m!} \\left( \\frac{k_m}{\\gamma_m} \\right)^m P_0 = P_0 \\sum_{m=0}^{\\infty} \\frac{1}{m!} \\left( \\frac{k_m}{\\gamma_m} \\right)^m = 1\n$$\n该和是指数函数的泰勒级数展开，$\\exp(x) = \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}$。令参数 $\\lambda = \\frac{k_m}{\\gamma_m}$。\n$$\nP_0 \\exp(\\lambda) = 1 \\implies P_0 = \\exp(-\\lambda)\n$$\n将 $P_0$ 代回，得到最终的平稳分布：\n$$\nP_m = \\frac{\\lambda^m \\exp(-\\lambda)}{m!} \\quad \\text{其中 } \\lambda = \\frac{k_m}{\\gamma_m}\n$$\n这是参数为 $\\lambda$ 的泊松分布的概率质量函数。\n\n现在我们根据这个分布计算所需的统计特性。对于参数为 $\\lambda$ 的泊松分布，其均值和方差是众所周知的结果：\n$m$ 的均值（期望值）是：\n$$\n\\mathrm{E}[m] = \\lambda = \\frac{k_m}{\\gamma_m}\n$$\n$m$ 的方差是：\n$$\n\\mathrm{Var}(m) = \\mathrm{E}[(m-\\mathrm{E}[m])^2] = \\lambda = \\frac{k_m}{\\gamma_m}\n$$\n法诺因子的定义是方差与均值的比率：\n$$\n\\text{法诺因子} = \\frac{\\mathrm{Var}(m)}{\\mathrm{E}[m]} = \\frac{\\lambda}{\\lambda} = 1\n$$\n$1$ 的法诺因子是泊松过程的一个特征。\n\n所要求的三个量是平稳均值 $\\mathrm{E}[m]$、方差 $\\mathrm{Var}(m)$ 和法诺因子，用 $k_m$ 和 $\\gamma_m$ 表示。\n1. $\\mathrm{E}[m] = \\frac{k_m}{\\gamma_m}$\n2. $\\mathrm{Var}(m) = \\frac{k_m}{\\gamma_m}$\n3. 法诺因子 $= 1$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{k_m}{\\gamma_m}  \\frac{k_m}{\\gamma_m}  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实的基因表达很少是恒定的；它通常受到基因启动子在活性和非活性状态之间切换的调控。本练习探讨这种切换的时间尺度相对于mRNA寿命如何影响最终的mRNA水平噪声。通过分析快切换和慢切换两种极限情况()，你将对启动子动态如何产生“外在”噪声并导致细胞中观察到的“脉冲式”转录获得深刻的直观理解。",
            "id": "3932233",
            "problem": "考虑一个单基因转录调控的典型双态启动子模型。启动子状态 $s(t) \\in \\{0,1\\}$ 作为一个连续时间马尔可夫链进行切换，其从状态 $0$ 转换到状态 $1$ 的速率为 $k_{\\mathrm{on}}$，从状态 $1$ 转换到状态 $0$ 的速率为 $k_{\\mathrm{off}}$。当启动子处于状态 $i \\in \\{0,1\\}$ 时，信使核糖核酸 (mRNA) 分子以速率 $\\alpha_{i}$ 通过一个零级生成过程合成，且每个 mRNA 分子以速率 $\\gamma$ 独立降解。令 $n(t) \\in \\mathbb{N}_{0}$ 表示在时间 $t$ 的 mRNA 拷贝数。联合过程 $\\{(s(t),n(t))\\}_{t \\ge 0}$ 是一个由化学主方程 (CME) 控制的连续时间马尔可夫过程，其状态转换由速率为 $\\alpha_{s(t)}$ 的生成过程 $n \\to n+1$、速率为 $\\gamma n$ 的降解过程 $n \\to n-1$ 以及具有给定速率的启动子切换过程 $0 \\leftrightarrow 1$ 给出。假设该过程是遍历的，并且对于所考虑的所有参数值，都达到一个唯一的稳态分布。\n\n令 $p \\equiv \\frac{k_{\\mathrm{on}}}{k_{\\mathrm{on}} + k_{\\mathrm{off}}}$ 表示启动子状态 $1$ 的稳态占据率。你将仅使用 CME 和马尔可夫过程中时间尺度分离的基本原理，在两个不同的时间尺度分离极限下分析稳态 mRNA 计数分布：\n\n1. 快切换机制：$k_{\\mathrm{on}}, k_{\\mathrm{off}} \\to \\infty$，同时保持 $p$ 固定，且 $\\alpha_{0}, \\alpha_{1}$ 和 $\\gamma$ 为固定的有限值。\n2. 慢切换机制：$k_{\\mathrm{on}}, k_{\\mathrm{off}} \\to 0$，同时保持 $p$ 固定，且 $\\alpha_{0}, \\alpha_{1}$ 和 $\\gamma$ 为固定的有限值，并且降解动力学的时间尺度比启动子切换的时间尺度快。\n\n从联合概率 $P_{i}(n,t)$（其中 $i \\in \\{0,1\\}$）的 CME 出发，通过调用适当的时间尺度分离推理，仔细论证在每种机制下，是哪个有效的简化随机过程控制着稳态 mRNA 的统计特性。从这些简化描述中，推导出每种极限机制下的稳态 mRNA 计数分布，而无需调用任何预先记忆的公式，然后推导出每种机制下相应的稳态法诺因子 $F \\equiv \\frac{\\mathrm{Var}[n]}{\\mathbb{E}[n]}$ 的闭合形式。你的最终答案仅用 $\\alpha_{0}$、$\\alpha_{1}$、$\\gamma$ 和 $p$ 表示。\n\n以单行矩阵 $\\bigl[F_{\\mathrm{fast}} \\; F_{\\mathrm{slow}}\\bigr]$ 的形式给出你的最终答案，其中包含两个稳态法诺因子的表达式。无需进行数值近似或舍入。最终答案中不包括单位。",
            "solution": "该问题陈述在科学上是合理的、适定的和客观的。它描述了随机化学动力学中的一个典型模型，并提出了一个关于马尔可夫过程中时间尺度分离分析的标准、非平凡问题。所有必要的参数和条件都已提供，且没有内部矛盾。因此，我们可以着手求解。\n\n系统的状态由对 $(s, n)$ 给出，其中 $s \\in \\{0, 1\\}$ 是启动子状态， $n \\in \\mathbb{N}_0$ 是 mRNA 分子的数量。稳态化学主方程 (CME) 描述了在稳态下发现系统处于状态 $(i, n)$ 的概率 $P_i(n)$。平衡方程为：\n$$\n0 = \\alpha_0 P_0(n-1) + \\gamma (n+1) P_0(n+1) + k_{\\mathrm{off}} P_1(n) - (\\alpha_0 + \\gamma n + k_{\\mathrm{on}}) P_0(n)\n$$\n$$\n0 = \\alpha_1 P_1(n-1) + \\gamma (n+1) P_1(n+1) + k_{\\mathrm{on}} P_0(n) - (\\alpha_1 + \\gamma n + k_{\\mathrm{off}}) P_1(n)\n$$\n其中约定当 $n=0$ 时，$P_i(n-1)=0$。我们分析两种指定的极限机制。\n\n**1. 快切换机制：$k_{\\mathrm{on}}, k_{\\mathrm{off}} \\to \\infty$，同时保持 $p = \\frac{k_{\\mathrm{on}}}{k_{\\mathrm{on}} + k_{\\mathrm{off}}}$ 固定。**\n\n在此极限下，启动子切换的时间尺度（约为 $(k_{\\mathrm{on}} + k_{\\mathrm{off}})^{-1}$）远小于 mRNA 合成和降解的时间尺度（分别约为 $\\alpha_i^{-1}$ 和 $\\gamma^{-1}$）。因此，相对于 mRNA 拷贝数的任何变化，启动子状态几乎是瞬时达到平衡的。启动子快速地抽样其稳态分布，该分布由 $P(s=0) = 1-p$ 和 $P(s=1) = p$ 给出。\n\n从较慢的 mRNA 动力学角度来看，有效合成速率是两种速率 $\\alpha_0$ 和 $\\alpha_1$ 的平均值，并由启动子处于相应状态的概率加权。这个有效速率 $\\langle\\alpha\\rangle$ 是一个常数：\n$$\n\\langle\\alpha\\rangle = \\alpha_0 P(s=0) + \\alpha_1 P(s=1) = \\alpha_0 (1-p) + \\alpha_1 p\n$$\n因此，mRNA 计数 $n$ 的系统动力学被简化为一个简单的生灭过程，其生成速率为常数 $\\langle\\alpha\\rangle$，降解速率为依赖于状态的 $\\gamma n$。这个有效过程的稳态主方程为：\n$$\n0 = \\langle\\alpha\\rangle P(n-1) + \\gamma(n+1)P(n+1) - (\\langle\\alpha\\rangle + \\gamma n)P(n)\n$$\n该方程意味着在稳态下存在一个细致平衡条件：$\\langle\\alpha\\rangle P(n-1) = \\gamma n P(n)$。通过递推，我们发现：\n$$\nP(n) = \\frac{\\langle\\alpha\\rangle}{\\gamma n} P(n-1) = \\frac{(\\langle\\alpha\\rangle/\\gamma)^n}{n!} P(0)\n$$\n归一化条件 $\\sum_{n=0}^\\infty P(n) = 1$ 要求 $P(0) \\sum_{n=0}^\\infty \\frac{(\\langle\\alpha\\rangle/\\gamma)^n}{n!} = P(0)\\exp(\\langle\\alpha\\rangle/\\gamma) = 1$。因此，稳态分布是一个泊松分布：\n$$\nP(n) = \\frac{(\\langle\\alpha\\rangle/\\gamma)^n}{n!} \\exp\\left(-\\frac{\\langle\\alpha\\rangle}{\\gamma}\\right)\n$$\n对于参数为 $\\lambda = \\langle\\alpha\\rangle/\\gamma$ 的泊松分布，其均值和方差都等于 $\\lambda$。\n$$\n\\mathbb{E}[n] = \\frac{\\langle\\alpha\\rangle}{\\gamma} = \\frac{\\alpha_0(1-p) + \\alpha_1 p}{\\gamma}\n$$\n$$\n\\mathrm{Var}[n] = \\frac{\\langle\\alpha\\rangle}{\\gamma} = \\frac{\\alpha_0(1-p) + \\alpha_1 p}{\\gamma}\n$$\n因此，快切换极限下的法诺因子 $F_{\\mathrm{fast}}$ 为：\n$$\nF_{\\mathrm{fast}} = \\frac{\\mathrm{Var}[n]}{\\mathbb{E}[n]} = 1\n$$\n\n**2. 慢切换机制：$k_{\\mathrm{on}}, k_{\\mathrm{off}} \\to 0$，同时保持 $p$ 固定，且 $\\gamma$ 远大于切换速率。**\n\n在此极限下，启动子切换事件与 mRNA 分子的寿命 $\\gamma^{-1}$ 相比是稀有的。这意味着对于一个给定的启动子状态（$0$ 或 $1$），mRNA 拷贝数有足够的时间在启动子状态改变之前达到其自身的条件稳态分布。因此，总的稳态 mRNA 分布是这两个条件分布的混合。\n\n令 $\\pi_i(n)$ 为在启动子处于状态 $i \\in \\{0, 1\\}$ 条件下的稳态 mRNA 分布。\n- 如果 $s=0$，mRNA 动力学是一个生灭过程，生成速率为 $\\alpha_0$，降解速率为 $\\gamma n$。如前所示，其稳态分布 $\\pi_0(n)$ 是均值为 $\\lambda_0 = \\alpha_0/\\gamma$ 的泊松分布。\n- 如果 $s=1$，mRNA 动力学是一个生灭过程，生成速率为 $\\alpha_1$，降解速率为 $\\gamma n$。其稳态分布 $\\pi_1(n)$ 是均值为 $\\lambda_1 = \\alpha_1/\\gamma$ 的泊松分布。\n\n总的稳态分布 $P(n)$ 是这两个泊松分布的加权平均，权重为启动子状态的稳态概率 $1-p$ 和 $p$：\n$$\nP(n) = (1-p) \\pi_0(n) + p \\pi_1(n)\n$$\n为了求出法诺因子 $F_{\\mathrm{slow}}$，我们必须计算这个混合分布的均值和方差。设启动子状态 $S$ 是一个随机变量，取值为 $\\{0, 1\\}$，概率为 $\\{1-p, p\\}$。\n\n均值 $\\mathbb{E}[n]$ 是条件均值的期望：\n$$\n\\mathbb{E}[n] = \\mathbb{E}[\\mathbb{E}[n|S]] = (1-p)\\mathbb{E}[n|S=0] + p\\mathbb{E}[n|S=1] = (1-p) \\lambda_0 + p \\lambda_1\n$$\n$$\n\\mathbb{E}[n] = (1-p)\\frac{\\alpha_0}{\\gamma} + p\\frac{\\alpha_1}{\\gamma} = \\frac{\\alpha_0(1-p)+\\alpha_1 p}{\\gamma}\n$$\n方差 $\\mathrm{Var}[n]$ 由全方差定律给出：\n$$\n\\mathrm{Var}[n] = \\mathbb{E}[\\mathrm{Var}[n|S]] + \\mathrm{Var}[\\mathbb{E}[n|S]]\n$$\n第一项是条件方差的期望。由于条件分布是泊松分布，其方差等于其均值：$\\mathrm{Var}[n|S=i] = \\lambda_i$。\n$$\n\\mathbb{E}[\\mathrm{Var}[n|S]] = (1-p)\\mathrm{Var}[n|S=0] + p\\mathrm{Var}[n|S=1] = (1-p)\\lambda_0 + p\\lambda_1 = \\mathbb{E}[n]\n$$\n第二项是条件均值的方差。随机变量 $\\mathbb{E}[n|S]$ 以概率 $1-p$ 取值 $\\lambda_0$，以概率 $p$ 取值 $\\lambda_1$。其方差为：\n$$\n\\mathrm{Var}[\\mathbb{E}[n|S]] = \\mathbb{E}[(\\mathbb{E}[n|S])^2] - (\\mathbb{E}[\\mathbb{E}[n|S]])^2\n$$\n$$\n= \\left( (1-p)\\lambda_0^2 + p\\lambda_1^2 \\right) - \\left( (1-p)\\lambda_0 + p\\lambda_1 \\right)^2\n$$\n$$\n= (1-p)\\lambda_0^2 + p\\lambda_1^2 - \\left( (1-p)^2\\lambda_0^2 + p^2\\lambda_1^2 + 2p(1-p)\\lambda_0\\lambda_1 \\right)\n$$\n$$\n= ( (1-p)-(1-p)^2 )\\lambda_0^2 + (p-p^2)\\lambda_1^2 - 2p(1-p)\\lambda_0\\lambda_1\n$$\n$$\n= p(1-p)\\lambda_0^2 + p(1-p)\\lambda_1^2 - 2p(1-p)\\lambda_0\\lambda_1\n$$\n$$\n= p(1-p)(\\lambda_1 - \\lambda_0)^2 = p(1-p)\\left(\\frac{\\alpha_1}{\\gamma} - \\frac{\\alpha_0}{\\gamma}\\right)^2 = \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma^2}\n$$\n合并各项，总方差为：\n$$\n\\mathrm{Var}[n] = \\mathbb{E}[n] + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma^2}\n$$\n慢切换极限下的法诺因子 $F_{\\mathrm{slow}}$ 为：\n$$\nF_{\\mathrm{slow}} = \\frac{\\mathrm{Var}[n]}{\\mathbb{E}[n]} = \\frac{\\mathbb{E}[n] + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma^2}}{\\mathbb{E}[n]} = 1 + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma^2 \\mathbb{E}[n]}\n$$\n代入 $\\mathbb{E}[n]$ 的表达式：\n$$\nF_{\\mathrm{slow}} = 1 + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma^2 \\left(\\frac{\\alpha_0(1-p)+\\alpha_1 p}{\\gamma}\\right)} = 1 + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma(\\alpha_0(1-p)+\\alpha_1 p)}\n$$\n该表达式包含内在噪声项 $1$（来自泊松生灭过程）和由生产速率之间慢切换引起的外在噪声项。\n\n两个所需的表达式是 $F_{\\mathrm{fast}} = 1$ 和 $F_{\\mathrm{slow}} = 1 + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma(\\alpha_0(1-p)+\\alpha_1 p)}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1 + \\frac{p(1-p)(\\alpha_1 - \\alpha_0)^2}{\\gamma (\\alpha_0(1-p) + \\alpha_1 p)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在分析性地探讨了两态模型之后，我们现在转向其计算模拟。这个练习要求你在Gillespie随机模拟算法（SSA）的框架内将该模型形式化()，Gillespie算法是模拟随机生化系统精确轨迹的黄金标准方法。正确定义事件、倾向函数和更新规则，是计算研究那些过于复杂而无法解析求解的模型的关键第一步。",
            "id": "3932209",
            "problem": "考虑一个单基因，其启动子具有两种状态，由二元变量 $S \\in \\{0,1\\}$ 表示，其中 $S=0$ 表示启动子处于非活性状态，$S=1$ 表示启动子处于活性状态。令 $m \\in \\mathbb{Z}_{\\ge 0}$ 表示信使核糖核酸 (mRNA) 的拷贝数。该基因可以在非活性和活性状态之间切换，其恒定转换速率分别为 $k_{\\mathrm{on}}$ (从非活性到活性) 和 $k_{\\mathrm{off}}$ (从活性到非活性)。当启动子处于活性状态 ($S=1$) 时，mRNA以恒定速率 $k_{\\mathrm{tx}}$ 合成，且每个mRNA分子以速率 $\\gamma_m$ 独立降解。假设体积内混合均匀，且只有一个启动子，并且所有事件都是无记忆的，因此其动力学由一个连续时间马尔可夫过程控制，该过程由化学主方程 (CME) 描述。\n\n从CME的解释出发，即每个基本转换都是一个泊松过程，其风险率依赖于状态，且等于其倾向性 (propensity)，Gillespie随机模拟算法 (SSA) 为 $(S,m)$ 定义了一个事件集、相关的倾向性函数和状态更新规则。\n\n在双态基因表达模型下，哪个选项正确地指定了状态 $(S,m)$ 的事件集、倾向性函数和状态更新规则，并且与Gillespie SSA一致？\n\nA. 事件集：\n- 启动子激活：$(S,m) \\to (1,m)$。\n- 启动子失活：$(S,m) \\to (0,m)$。\n- 转录：$(S,m) \\to (S,m+1)$。\n- mRNA降解：$(S,m) \\to (S,m-1)$。\n倾向性：\n- $a_1 = k_{\\mathrm{on}}(1-S)$，\n- $a_2 = k_{\\mathrm{off}} S$，\n- $a_3 = k_{\\mathrm{tx}} S$，\n- $a_4 = \\gamma_m m$。\n更新规则：\n- 如果启动子激活事件发生，设置 $S \\leftarrow 1$ 且 $m$ 保持不变。\n- 如果启动子失活事件发生，设置 $S \\leftarrow 0$ 且 $m$ 保持不变。\n- 如果转录事件发生，设置 $m \\leftarrow m+1$ 且 $S$ 保持不变。\n- 如果降解事件发生，设置 $m \\leftarrow m-1$ 且 $S$ 保持不变。\n\nB. 事件集：\n- 启动子激活：$(S,m) \\to (1,m)$。\n- 启动子失活：$(S,m) \\to (0,m)$。\n- 转录：$(S,m) \\to (S,m+1)$。\n- mRNA降解：$(S,m) \\to (S,m-1)$。\n倾向性：\n- $a_1 = k_{\\mathrm{on}} S$，\n- $a_2 = k_{\\mathrm{off}} (1-S)$，\n- $a_3 = k_{\\mathrm{tx}}$，\n- $a_4 = \\gamma_m S m$。\n更新规则：\n- 结构性更新与选项A相同。\n\nC. 事件集：\n- 启动子激活：$(S,m) \\to (1,m)$。\n- 启动子失活：$(S,m) \\to (0,m)$。\n- 转录：$(S,m) \\to (S,m+1)$。\n- mRNA降解：$(S,m) \\to (S,m-1)$。\n倾向性：\n- $a_1 = k_{\\mathrm{on}} S$，\n- $a_2 = k_{\\mathrm{off}} (1-S)$，\n- $a_3 = k_{\\mathrm{tx}} (1-S)$，\n- $a_4 = \\gamma_m m$。\n更新规则：\n- 结构性更新与选项A相同。\n\nD. 事件集：\n- 启动子激活：$(S,m) \\to (1,m)$。\n- 启动子失活：$(S,m) \\to (0,m)$，并同时清除mRNA $(S,m) \\to (0,0)$。\n- 转录爆发：$(S,m) \\to (S,m+B)$，爆发大小为 $B \\in \\{1,2,\\dots\\}$。\n- mRNA降解：$(S,m) \\to (S,m-1)$。\n倾向性：\n- $a_1 = k_{\\mathrm{on}}(1-S)$，\n- $a_2 = k_{\\mathrm{off}} S$，\n- $a_3 = k_{\\mathrm{tx}} S$ 对于爆发，\n- $a_4 = \\gamma_m$。\n更新规则：\n- 如果启动子失活事件发生，设置 $S \\leftarrow 0$ 和 $m \\leftarrow 0$。\n- 如果转录爆发事件发生，从几何分布中抽取 $B$ 并设置 $m \\leftarrow m+B$。\n- 如果降解事件发生，设置 $m \\leftarrow m-1$。\n\n选择与基于CME的风险构建以及此双态基因表达模型的Gillespie SSA一致的选项。假设 $m$ 不能为负，并且由于风险率的状态依赖性，导致 $m$ 降至0以下的事件的倾向性为零。",
            "solution": "用户提供了一个问题陈述，描述了一个双态随机基因表达模型，并要求正确指定相应的Gillespie随机模拟算法 (SSA)。验证和求解过程如下。\n\n### 第1步：提取已知条件\n\n问题陈述中提供的数据和条件如下：\n- 状态变量：一个用于启动子状态的二元变量 $S \\in \\{0,1\\}$（$S=0$ 代表非活性，$S=1$ 代表活性），以及一个用于信使核糖核酸 (mRNA) 拷贝数的整数 $m \\in \\mathbb{Z}_{\\ge 0}$。系统状态为 $(S,m)$。\n- 基本转换：\n    1.  启动子从非活性切换到活性，恒定转换速率为 $k_{\\mathrm{on}}$。\n    2.  启动子从活性切换到非活性，恒定转换速率为 $k_{\\mathrm{off}}$。\n    3.  当启动子处于活性状态 ($S=1$) 时，以恒定速率 $k_{\\mathrm{tx}}$ 合成mRNA。\n    4.  每个mRNA分子以速率 $\\gamma_m$ 独立降解。\n- 模型框架：动力学被描述为一个连续时间马尔可夫过程，由化学主方程 (CME) 控制，并使用Gillespie SSA进行模拟。\n\n### 第2步：使用提取的已知条件进行验证\n\n问题陈述描述了基因表达的标准“电报模型”，这是系统生物学中用于研究转录噪声的一个基石模型。\n\n- **科学依据**：该模型基于应用于生物大分子的化学动力学基本原理。它是生物物理学和计算生物学中一个被广泛接受和研究的模型。该模型在科学上是合理的。\n- **适定性**：这个问题是适定的。在给定基本过程及其速率的描述下，Gillespie SSA的构建（包括定义事件、倾向性函数和状态更新向量）是一个基于随机化学动力学理论的标准、明确的过程。存在一个唯一且正确的表述。\n- **客观性**：问题陈述使用了该领域精确、客观和标准的术语（例如，“连续时间马尔可夫过程”、“倾向性 (propensity)”、“Gillespie SSA”、“速率常数”）。没有模糊或主观的语言。\n\n该问题没有表现出验证清单中列出的任何缺陷。它是生物医学系统建模领域一个有效、定义明确的问题。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。现在推导解决方案。\n\n### Gillespie SSA 表述的推导\n\nGillespie SSA通过在每一步选择下一个将发生哪个反应以及何时发生，来模拟一个随机化学系统的轨迹。这需要定义所有可能反应（事件）的集合、它们对应的倾向性函数，以及它们在系统状态中引起的变化。对于反应 $i$，倾向性函数 $a_i(\\mathbf{x})$ 给出了在系统处于状态 $\\mathbf{x}$ 时该反应发生的风险率。对于一个状态 $\\mathbf{x} = (S, m)$，我们推导所描述的四个基本过程的倾向性。\n\n1.  **启动子激活**：这是从非活性状态 ($S=0$) 到活性状态 ($S=1$) 的转换。这可以表示为“非活性启动子”物种的一阶反应。\n    - 事件：$S \\to S+1$ (或更精确地，$S=0 \\to S=1$)。\n    - 这个转换只有在启动子当前为非活性 ($S=0$) 时才可能发生。非活性启动子的数量是 $(1-S)$。\n    - 速率常数为 $k_{\\mathrm{on}}$。\n    - 倾向性函数是速率常数乘以反应物组合的数量。在这里，它是 $k_{\\mathrm{on}} \\times (1-S)$。这正确地在 $S=0$ 时得到倾向性 $k_{\\mathrm{on}}$，在 $S=1$ 时得到0。\n    - 状态更新为 $S \\leftarrow 1$。\n\n2.  **启动子失活**：这是从活性状态 ($S=1$) 到非活性状态 ($S=0$) 的转换。这是“活性启动子”物种的一阶反应。\n    - 事件：$S \\to S-1$ (或更精确地，$S=1 \\to S=0$)。\n    - 这个转换只有在启动子当前为活性 ($S=1$) 时才可能发生。活性启动子的数量是 $S$。\n    - 速率常数为 $k_{\\mathrm{off}}$。\n    - 倾向性函数是 $k_{\\mathrm{off}} \\times S$。这正确地在 $S=1$ 时得到倾向性 $k_{\\mathrm{off}}$，在 $S=0$ 时得到0。\n    - 状态更新为 $S \\leftarrow 0$。\n\n3.  **转录 (mRNA 合成)**：这个过程产生一个mRNA分子。\n    - 事件：$m \\to m+1$。\n    - 这只在启动子处于活性状态 ($S=1$) 时发生。活性启动子充当催化剂。合成速率给定为 $k_{\\mathrm{tx}}$。\n    - 倾向性是内在速率 $k_{\\mathrm{tx}}$ 乘以活性启动子的数量，即 $S$。\n    - 倾向性函数是 $k_{\\mathrm{tx}} \\times S$。这正确地在 $S=1$ 时得到倾向性 $k_{\\mathrm{tx}}$，在 $S=0$ 时得到0。\n    - 状态更新为 $m \\leftarrow m+1$。\n\n4.  **mRNA降解**：$m$ 个mRNA分子中的每一个都独立降解。\n    - 事件：$m \\to m-1$。\n    - 这是mRNA物种的一阶衰变过程。\n    - 每个分子的降解速率是 $\\gamma_m$。当存在 $m$ 个分子时，总降解事件的速率是单个速率的总和。\n    - 倾向性函数是 $\\gamma_m \\times m$。这与mRNA分子的数量成正比，并在 $m=0$ 时变为0，从而防止mRNA计数变为负数。\n    - 状态更新为 $m \\leftarrow m-1$。\n\n正确表述的总结：\n- 事件集：\n    1.  启动子激活：$(S,m) \\to (1,m)$\n    2.  启动子失活：$(S,m) \\to (0,m)$\n    3.  转录：$(S,m) \\to (S,m+1)$\n    4.  mRNA降解：$(S,m) \\to (S,m-1)$\n- 倾向性：\n    1.  激活：$a_1 = k_{\\mathrm{on}}(1-S)$\n    2.  失活：$a_2 = k_{\\mathrm{off}} S$\n    3.  转录：$a_3 = k_{\\mathrm{tx}} S$\n    4.  降解：$a_4 = \\gamma_m m$\n- 更新规则是这些事件的直接结果。\n\n### 逐个选项分析\n\n**选项 A**\n- **事件集**：正确地列出了四个基本过程：启动子激活、启动子失活、转录和mRNA降解。\n- **倾向性**：\n    - $a_1 = k_{\\mathrm{on}}(1-S)$：正确。该反应只有在 $S=0$ 时才能发生。\n    - $a_2 = k_{\\mathrm{off}} S$：正确。该反应只有在 $S=1$ 时才能发生。\n    - $a_3 = k_{\\mathrm{tx}} S$：正确。转录只有在 $S=1$ 时才发生。\n    - $a_4 = \\gamma_m m$：正确。总降解速率与mRNA分子数 $m$ 成正比。\n- **更新规则**：为每个事件正确指定。\n- **结论**：**正确**。该选项与为所描述模型推导出的SSA表述完全匹配。\n\n**选项 B**\n- **倾向性**：\n    - $a_1 = k_{\\mathrm{on}} S$：不正确。这意味着激活发生在启动子已经处于活性状态 ($S=1$) 时，这是一个逻辑矛盾。\n    - $a_2 = k_{\\mathrm{off}} (1-S)$：不正确。这意味着失活发生在启动子已经处于非活性状态 ($S=0$) 时，这也是一个矛盾。\n    - $a_3 = k_{\\mathrm{tx}}$：不正确。这意味着转录与启动子状态无关，这与问题陈述中“当启动子处于活性状态时”发生转录的说法相矛盾。\n    - $a_4 = \\gamma_m S m$：不正确。这意味着mRNA降解依赖于启动子是否处于活性状态，这与“每个mRNA独立降解”的陈述相矛盾。\n- **结论**：**不正确**。\n\n**选项 C**\n- **倾向性**：\n    - $a_1 = k_{\\mathrm{on}} S$：不正确。与选项B中的错误相同。\n    - $a_2 = k_{\\mathrm{off}} (1-S)$：不正确。与选项B中的错误相同。\n    - $a_3 = k_{\\mathrm{tx}} (1-S)$：不正确。这意味着转录在启动子非活性 ($S=0$) 时发生，这与问题描述相反。\n    - $a_4 = \\gamma_m m$：这个倾向性是正确的，但其他的不是。\n- **结论**：**不正确**。\n\n**选项 D**\n- **事件集和更新规则**：这个选项描述了一个不同的物理模型。\n    - 它引入了“转录爆发”，其中 $m \\leftarrow m+B$ 且 $B$ 是一个随机变量，而不是单分子合成事件 ($m \\leftarrow m+1$)。这是一个不同的模型，通常用作近似，但不是所述过程的直接实现。\n    - 它在启动子失活时引入了“同时清除mRNA”，其中 $m \\leftarrow 0$。这在问题描述中没有说明，代表了一个根本不同的生物学假设。\n- **倾向性**：\n    - $a_4 = \\gamma_m$：这个降解的倾向性是不正确的。它意味着一个恒定的总降解速率，与mRNA分子的数量无关，这违反了独立、按分子衰变的前提。\n- **结论**：**不正确**。这个选项描述了一个不同的、且部分不一致的生物物理模型，而不是问题中指定的那个。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}