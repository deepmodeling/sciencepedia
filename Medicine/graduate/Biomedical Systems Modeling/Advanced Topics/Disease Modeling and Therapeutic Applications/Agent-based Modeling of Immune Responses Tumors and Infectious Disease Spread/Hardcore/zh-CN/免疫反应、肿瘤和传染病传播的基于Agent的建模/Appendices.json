{
    "hands_on_practices": [
        {
            "introduction": "在代理人基模型（ABM）中，一个核心任务是将控制单个代理人行为的微观规则与宏观尺度上涌现的集体模式联系起来。本练习通过从一个简单的随机游走模型出发，推导出宏观的扩散方程，来阐明这一关键联系。这项实践使我们能够理解如何基于代理人的基本运动参数（如步长和时间步）来校准模型中的有效扩散系数 。",
            "id": "3870843",
            "problem": "一个免疫细胞巡逻的基于智能体的模型（ABM）在一个二维方形晶格上实现，用以表示肿瘤微环境的薄组织切片。一个单一的细胞毒性T淋巴细胞（CTL）智能体从原点开始，在每个离散时间增量 $\\,\\Delta t\\,$ 内，以相等的概率向四个最近邻位点之一移动一个长度为 $\\,h\\,$ 的晶格步长。环境是均匀且各向同性的，没有外部信号（无趋化性），因此行走是无偏的。智能体在时间 $\\,t\\,$ 的位置被建模为其独立同分布的晶格位移的累积和。\n\n从适用于生物医学系统建模和随机过程的第一性原理出发，论证从离散时间、离散空间的无偏随机行走过渡到智能体位置概率密度 $\\,p(x,y,t)\\,$ 的连续空间、连续时间描述的合理性。根据此连续谱描述和二维空间中各向同性扩散的扩散系数定义，推导出有效扩散系数 $\\,D\\,$ 作为晶格步长 $\\,h\\,$ 和时间步长 $\\,\\Delta t\\,$ 的函数。\n\n您的最终答案必须是 $\\,D\\,$ 关于 $\\,h\\,$ 和 $\\,\\Delta t\\,$ 的单一、封闭形式的符号表达式。不要代入数值。如果 $\\,h\\,$ 的单位是微米，$\\,\\Delta t\\,$ 的单位是秒，请用平方微米每秒表示扩散系数。无需四舍五入。",
            "solution": "该问题陈述经评估具有科学依据、问题明确且客观。它描述了一个标准的物理模型——离散随机行走，并要求严格推导其连续谱极限，这是统计物理学及其在生物学中应用的一个基本过程。所有必要的参数都已提供，没有矛盾或含糊之处。该问题是有效的。\n\n该问题要求论证从离散时间、离散空间的随机行走过渡到连续扩散方程的合理性，并随后推导出有效扩散系数 $D$。\n\n设细胞毒性T淋巴细胞（CTL）智能体在二维方形晶格上的位置由坐标 $(x, y)$ 给出，它们是晶格步长 $h$ 的整数倍。设 $P(x, y, t)$ 为在时间 $t$ 时在位点 $(x, y)$ 找到该智能体的概率，其中时间是离散时间增量 $\\Delta t$ 的倍数。\n\n智能体的运动是一个离散时间的马尔可夫过程。在每个时间步 $t$，位于 $(x, y)$ 的智能体以 $\\frac{1}{4}$ 的相等概率移动到其四个最近邻之一 $(x+h, y)$、$(x-h, y)$、$(x, y+h)$ 或 $(x, y-h)$。在时间 $t + \\Delta t$ 时位于位点 $(x, y)$ 的概率取决于在时间 $t$ 时位于相邻位点的概率。该关系由该过程的主方程描述：\n$$P(x, y, t + \\Delta t) = \\frac{1}{4} \\left[ P(x-h, y, t) + P(x+h, y, t) + P(x, y-h, t) + P(x, y+h, t) \\right]$$\n\n为了论证并执行向连续描述的过渡，我们假设 $P(x, y, t)$ 可以由一个光滑、二次可微的概率密度函数 $p(x, y, t)$ 来近似。这个假设在远大于基本步长 $h$ 和时间步长 $\\Delta t$ 的空间和时间尺度上是有效的。我们通过对函数 $p(x, y, t)$ 在点 $(x, y, t)$ 周围进行泰勒级数展开来分析主方程。\n\n主方程的左侧在时间上展开：\n$$p(x, y, t + \\Delta t) = p(x, y, t) + \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2)$$\n\n右侧的项在空间上围绕 $(x, y)$ 展开：\n$$p(x \\pm h, y, t) = p(x, y, t) \\pm h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2} \\pm \\frac{h^3}{6} \\frac{\\partial^3 p}{\\partial x^3} + O(h^4)$$\n$$p(x, y \\pm h, t) = p(x, y, t) \\pm h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2} \\pm \\frac{h^3}{6} \\frac{\\partial^3 p}{\\partial y^3} + O(h^4)$$\n\n将这些展开式代入主方程的右侧：\n$$ \\frac{1}{4} \\left[ (p - h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2}) + (p + h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2}) + (p - h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2}) + (p + h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2}) \\right] + \\dots $$\n这里我们截断了 $h^3$ 及更高阶的项。由于行走的对称性，一阶导数项（以及所有奇数阶项）在求和时抵消：\n$$ \\frac{1}{4} \\left[ 4p(x,y,t) + h^2 \\left( \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} \\right) \\right] + O(h^4) = p(x,y,t) + \\frac{h^2}{4} \\nabla^2 p(x,y,t) + O(h^4) $$\n其中 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是二维拉普拉斯算子。\n\n现在我们将展开的左侧和右侧相等：\n$$ p(x, y, t) + \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2) = p(x, y, t) + \\frac{h^2}{4} \\nabla^2 p(x,y,t) + O(h^4) $$\n\n从两边减去 $p(x, y, t)$ 得到：\n$$ \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2) = \\frac{h^2}{4} \\nabla^2 p + O(h^4) $$\n\n除以 $\\Delta t$：\n$$ \\frac{\\partial p}{\\partial t} + O(\\Delta t) = \\frac{h^2}{4\\Delta t} \\nabla^2 p + O\\left(\\frac{h^4}{\\Delta t}\\right) $$\n\n从离散主方程到连续偏微分方程的过渡在扩散极限下是合理的，其中 $\\Delta t \\to 0$ 和 $h \\to 0$ 同时发生，使得比率 $\\frac{h^2}{\\Delta t}$ 保持有限且非零。在此极限下，高阶项 $O(\\Delta t)$ 和 $O(\\frac{h^4}{\\Delta t})$ 消失。这得到了连续谱方程：\n$$ \\frac{\\partial p}{\\partial t} = \\left( \\frac{h^2}{4\\Delta t} \\right) \\nabla^2 p $$\n\n该方程具有二维标准各向同性扩散方程（也称为菲克第二定律）的形式：\n$$ \\frac{\\partial p}{\\partial t} = D \\nabla^2 p $$\n其中 $D$ 是有效扩散系数。\n\n通过将推导出的方程与标准形式进行比较，我们可以确定扩散系数 $D$ 的直接表达式：\n$$ D = \\frac{h^2}{4\\Delta t} $$\n该表达式给出了一个在步长为 $h$、时间步长为 $\\Delta t$ 的二维方形晶格上进行无偏随机行走的智能体的有效扩散系数。\n\n$D$ 的单位由 $h$ 和 $\\Delta t$ 的单位决定。如果 $h$ 的单位是微米（$\\mu m$），$\\Delta t$ 的单位是秒（$s$），那么 $D$ 的单位是 $(\\mu m)^2 / s$，或 $\\mu m^2 s^{-1}$，这是细胞生物学中扩散系数的标准单位。",
            "answer": "$$\\boxed{\\frac{h^2}{4 \\Delta t}}$$"
        },
        {
            "introduction": "在模拟了代理人的运动之后，下一个逻辑步骤是量化它们之间的相互作用，这对于免疫监视等生物过程至关重要。本练习提供了一个基本工具，用于计算代理人之间接触的预期频率。通过将代理人密度和相互作用半径与接触事件的发生率联系起来，我们可以为模拟中更复杂的相互作用规则（例如，细胞杀伤）奠定基础 。",
            "id": "3870809",
            "problem": "考虑一个二维（$2$-D）非网格的基于智能体模型（ABM），该模型模拟免疫效应细胞监视肿瘤单层。在每个离散时间步，假设所有智能体的瞬时位置在平面上呈强度为 $\\rho$（单位面积的智能体数量）的均匀泊松点过程分布，这反映了由运动性驱动的空间随机性以及在感兴趣的尺度上空间相关性的缺失。当另一个智能体在某个时间步位于一个焦点智能体位置的相互作用半径 $r$ 范围内时，就为该焦点智能体记录一次二元“接触”。假设焦点智能体与任何边界的距离至少为 $r$，因此可以忽略边缘效应，并且排除了自我接触。仅使用均匀泊松点过程的基本性质和标准定义，推导单个时间步内该焦点智能体观察到的智能体-智能体接触次数的期望值的闭式解析表达式，该表达式用 $\\rho$ 和 $r$ 表示。将最终答案表示为精确的解析表达式。期望接触次数是一个无量纲量；无需四舍五入。",
            "solution": "该问题要求推导在单个离散时间步内，一个焦点智能体的智能体-智能体接触次数的期望值。智能体的位置被建模为均匀泊松点过程。\n\n设二维平面 $\\mathbb{R}^{2}$ 上的智能体位置集合是均匀泊松点过程的一次实现，记为 $\\Phi$，其强度为常数 $\\rho$。强度 $\\rho$ 表示单位面积内的平均智能体数量。\n\n对于一个焦点智能体，“接触”事件定义为在其为中心的半径为 $r$ 的圆形区域内存在至少一个其他智能体。我们的任务是求出此类接触的期望次数，这等同于求出此圆形区域内其他智能体的期望数量。\n\n由于泊松点过程的平稳性（或空间均匀性），该过程的统计特性在平移下是不变的。这使我们可以在不失一般性的情况下，将焦点智能体放置在任何方便的位置。我们选择原点 $(0,0)$ 作为焦点智能体的位置。\n\n问题明确指出排除了自我接触。这是一个关键细节。我们感兴趣的是，在给定我们的焦点智能体（其本身是 $\\Phi$ 的一个点）位于原点的情况下，来自过程 $\\Phi$ 并落入相互作用区域内的智能体数量。平稳泊松点过程的一个基本性质，即斯利夫尼亚克-梅克定理（Slivnyak-Mecke theorem）的一个推论，指出以过程中的一个点存在于原点为条件，并不会改变其余点的分布。因此，所有*其他*智能体的位置仍然构成一个强度同为 $\\rho$ 的均匀泊松点过程。\n\n围绕位于原点的焦点智能体的相互作用区域是一个半径为 $r$ 的开圆盘，我们将其记为 $D_r$。该圆盘的面积 $A(D_r)$ 由下式给出：\n$$A(D_r) = \\pi r^{2}$$\n问题指出我们可以忽略边缘效应，这证明了我们在无限平面 $\\mathbb{R}^{2}$ 上使用一个完整圆盘是合理的。\n\n设 $N_c$ 为表示焦点智能体接触次数的随机变量。这恰好是位于圆盘 $D_r$ 内的其他智能体的数量。对于强度为 $\\rho$ 的均匀泊松点过程，任何有界区域 $B \\subset \\mathbb{R}^{2}$ 内的点数（我们称此计数为 $N(B)$）遵循泊松分布。该分布的期望值（均值）由强度与该区域面积的乘积给出：\n$$E[N(B)] = \\rho \\cdot \\text{Area}(B)$$\n\n将此性质应用于我们的问题，接触次数 $N_c$ 是来自“其他智能体”过程（其强度为 $\\rho$）且落入区域 $D_r$ 的点数。因此，期望接触次数 $E[N_c]$ 为：\n$$E[N_c] = \\rho \\cdot A(D_r)$$\n代入圆盘面积的表达式，我们得到最终表达式：\n$$E[N_c] = \\rho \\pi r^{2}$$\n该表达式是根据给定参数 $\\rho$ 和 $r$ 得出的一个闭式解析结果。其量纲一致性得到验证，因为 $\\rho$ 的量纲为 $[\\text{长度}]^{-2}$，$r^{2}$ 的量纲为 $[\\text{长度}]^{2}$，最终得到一个无量纲的期望接触次数，符合问题陈述的要求。",
            "answer": "$$\\boxed{\\rho \\pi r^{2}}$$"
        },
        {
            "introduction": "除了运动和相互作用，ABM 还经常用于模拟群体动态，如增殖、衰退或灭绝。本练习介绍了高尔顿-沃森（Galton-Watson）分支过程，这是一个强大的理论框架，用于根据单个细胞的凋亡、存活和分裂概率来分析群体的最终命运。这项实践对于预测肿瘤清除、免疫逃逸或克隆选择等结果至关重要 。",
            "id": "3870840",
            "problem": "在一个增殖性肿瘤细胞克隆的基于智能体的模型 (ABM; Agent-Based Model) 中，每个智能体代表一个活的肿瘤细胞。在每个细胞周期结束时，一个智能体根据以下生物学上可能的结果被替换为随机数量的活的子细胞，并假设这些结果在所有智能体和各代之间是独立同分布的：\n- 细胞凋亡：以 $p_0$ 的概率不产生任何活的子细胞。\n- 不对称分裂（例如，保留一个活的子细胞，而另一个是非存活结果）：以 $p_1$ 的概率产生一个活的子细胞。\n- 对称分裂：以 $p_2$ 的概率产生两个活的子细胞。\n假设没有其他结果，因此 $p_0 + p_1 + p_2 = 1$。初始种群由一个活细胞组成。\n\n设 $K$ 表示单个细胞在其周期结束时产生的活子细胞数量，并定义后代生成函数 $f(s)$ 为 $f(s) = \\mathbb{E}[s^{K}]$，其中 $s \\in [0,1]$。仅使用后代生成函数的核心定义以及 Galton-Watson 分支过程的独立性结构，推导决定从单个初始细胞开始的克隆的灭绝概率 $q$ 的表达式，然后为以下每个参数集计算 $q$：\n- 集合 A：$p_0 = 0.55$, $p_1 = 0.25$, $p_2 = 0.20$。\n- 集合 B：$p_0 = 0.20$, $p_1 = 0.15$, $p_2 = 0.65$。\n\n以行矩阵的形式表示您的最终答案，顺序为 (集合 A, 集合 B)。如果任何值是精确有理数，请以精确分数形式表示；否则，请以精确代数值表示。无需四舍五入。灭绝概率是无量纲的；不要包含单位。",
            "solution": "该问题陈述经评估具有科学依据、适定且客观。它为一个分支过程理论中的标准问题提供了完整且一致的设定，分支过程是生物医学系统建模中的常用工具。因此，该问题被认为是有效的。\n\n所描述的模型是一个 Galton-Watson 分支过程。设 $Z_n$ 为第 $n$ 代的活肿瘤细胞数量，初始条件为 $Z_0=1$。单个细胞产生的后代（活子细胞）数量 $K$ 是一个随机变量，其概率分布如下：\n$$\n\\mathbb{P}(K=k) =\n\\begin{cases}\np_0  \\text{for } k=0 \\\\\np_1  \\text{for } k=1 \\\\\np_2  \\text{for } k=2 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n问题要求使用后代生成函数 $f(s)$，其定义为 $f(s) = \\mathbb{E}[s^{K}]$。根据离散随机变量期望值的定义，我们有：\n$$\nf(s) = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k)s^k = p_0 s^0 + p_1 s^1 + p_2 s^2 = p_0 + p_1s + p_2s^2\n$$\n问题要求推导决定灭绝概率 $q$ 的表达式。灭绝概率定义为 $q = \\mathbb{P}(\\text{灭绝} | Z_0=1)$。 “灭绝”事件意味着种群大小在某一代变为 0。设 $q_n = \\mathbb{P}(Z_n=0 | Z_0=1)$ 为种群到第 $n$ 代时已经灭绝的概率。序列 $\\{q_n\\}_{n \\ge 0}$ 是非递减的，并以 1 为上界，因此其极限 $q = \\lim_{n \\to \\infty} q_n$ 存在，即为灭绝概率。\n\n第 $n+1$ 代的种群 $Z_{n+1}$ 是前一代 $Z_n$ 个体的后代总和。种群在第 $n+1$ 代灭绝，当且仅当从单个初始细胞开始的所有后代谱系到第 $n+1$ 代时都已消亡。这等价于说，对于初始细胞的 $K$ 个后代中的每一个，其自身的子分支过程（在统计上与原始过程相同）在 $n$ 代内灭绝。由于这些子过程的独立性，我们可以写出 $q_{n+1}$ 关于 $q_n$ 的递推关系：\n$$\nq_{n+1} = \\mathbb{P}(Z_{n+1}=0) = \\sum_{k=0}^{2} \\mathbb{P}(Z_{n+1}=0|K=k)\\mathbb{P}(K=k) = \\sum_{k=0}^{2} (q_n)^k p_k\n$$\n这得到 $q_{n+1} = p_0(q_n)^0 + p_1(q_n)^1 + p_2(q_n)^2 = f(q_n)$。当 $n \\to \\infty$ 时取极限，并利用多项式函数 $f(s)$ 的连续性，我们发现 $q$ 必须是 $f(s)$ 的一个不动点：\n$$\nq = f(q)\n$$\n因此，灭绝概率 $q$ 是方程 $s = f(s)$ 的一个解。代入 $f(s)$ 的表达式，我们得到：\n$$\ns = p_0 + p_1s + p_2s^2\n$$\n这可以整理成一个标准二次方程：\n$$\np_2s^2 + (p_1-1)s + p_0 = 0\n$$\n我们有约束条件 $p_0+p_1+p_2=1$，这意味着 $p_1-1 = -p_0-p_2$。将此代入二次方程得到：\n$$\np_2s^2 - (p_0+p_2)s + p_0 = 0\n$$\n我们可以观察到 $s=1$ 是一个根：$p_2(1)^2 - (p_0+p_2)(1) + p_0 = p_2 - p_0 - p_2 + p_0 = 0$。由于 $s=1$ 是一个根，$(s-1)$ 必定是该二次多项式的一个因子。对多项式进行因式分解得到：\n$$\n(s-1)(p_2s - p_0) = 0\n$$\n因此，方程 $s=f(s)$ 的两个根是 $s=1$ 和 $s = \\frac{p_0}{p_2}$（如果 $p_2 \\ne 0$）。如果 $p_2=0$，方程是线性的，唯一的根是 $s=1$。\n\n分支过程的一个基本定理指出，灭绝概率 $q$ 是方程 $s=f(s)$ 的最小非负根。因此，我们必须在两个根 $1$ 和 $\\frac{p_0}{p_2}$ 中选择较小的一个。概率 $p_0$ 和 $p_2$ 是非负的，所以根 $\\frac{p_0}{p_2}$ 是非负的。因此，灭绝概率由下式给出：\n$$\nq = \\min\\left(1, \\frac{p_0}{p_2}\\right)\n$$\n这个结果与平均后代数 $\\mu = \\mathbb{E}[K] = f'(1) = p_1 + 2p_2$ 有关。如果 $\\mu \\le 1$，灭绝是必然的 ($q=1$)。如果 $\\mu > 1$，则有正的存活概率，所以 $q  1$。条件 $\\mu > 1$ 等价于 $p_1+2p_2 > 1 = p_0+p_1+p_2$，简化为 $p_2 > p_0$，即 $\\frac{p_0}{p_2}  1$。因此，推导出的 $q$ 的表达式与一般理论是一致的。\n\n现在我们为给定的两个参数集计算 $q$。\n\n**集合 A：** $p_0 = 0.55$, $p_1 = 0.25$, $p_2 = 0.20$。\n首先，我们计算比率 $\\frac{p_0}{p_2}$：\n$$\n\\frac{p_0}{p_2} = \\frac{0.55}{0.20} = \\frac{55}{20} = \\frac{11}{4}\n$$\n灭绝概率 $q_A$ 是 $1$ 和 $\\frac{11}{4}$ 中的最小值：\n$$\nq_A = \\min\\left(1, \\frac{11}{4}\\right) = 1\n$$\n或者，平均后代数是 $\\mu_A = p_1 + 2p_2 = 0.25 + 2(0.20) = 0.25 + 0.40 = 0.65$。由于 $\\mu_A \\le 1$，灭绝概率为 $1$。\n\n**集合 B：** $p_0 = 0.20$, $p_1 = 0.15$, $p_2 = 0.65$。\n首先，我们计算比率 $\\frac{p_0}{p_2}$：\n$$\n\\frac{p_0}{p_2} = \\frac{0.20}{0.65} = \\frac{20}{65} = \\frac{4}{13}\n$$\n灭绝概率 $q_B$ 是 $1$ 和 $\\frac{4}{13}$ 中的最小值：\n$$\nq_B = \\min\\left(1, \\frac{4}{13}\\right) = \\frac{4}{13}\n$$\n或者，平均后代数是 $\\mu_B = p_1 + 2p_2 = 0.15 + 2(0.65) = 0.15 + 1.30 = 1.45$。由于 $\\mu_B > 1$，灭绝概率小于 $1$，这证实了 $q_B = \\frac{4}{13}$ 是正确的根。\n\n最终答案是集合 A 和集合 B 的灭绝概率组成的行矩阵。\n对于集合 A，$q_A = 1$。\n对于集合 B，$q_B = \\frac{4}{13}$。\n最终答案以所要求的矩阵格式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{4}{13} \\end{pmatrix}}\n$$"
        }
    ]
}