{
    "hands_on_practices": [
        {
            "introduction": "流行病模型，如SEIR模型，可能包含多个参数，使得分析其动态行为变得复杂。无量纲化是一种强大的数学技术，通过重新缩放变量和时间，将模型的参数数量减少到一组最小的、独立的无量纲组合。本练习  将引导你对包含生命动力学的SEIR模型进行无量纲化，揭示控制流行病传播动力学的基本参数比率，从而深化对模型内在结构的理解。",
            "id": "3928198",
            "problem": "考虑一个标准的易感–暴露–感染–康复（SEIR）仓室模型，该模型包含生命动态，适用于一个大小恒定为 $N$ 的封闭宿主种群（出生与死亡相平衡）。这些仓室分别为：$S(t)$ 代表易感个体，$E(t)$ 代表已暴露但尚未具传染性的个体，$I(t)$ 代表感染个体，$R(t)$ 代表具有免疫力的康复个体。该模型假设传播是频率依赖性的，具有恒定的人均出生率 $\\mu$ 和死亡率 $\\mu$，从暴露到感染的进展率为 $\\sigma$，感染恢复率为 $\\gamma$。其控制方程为：\n$$\n\\frac{dS}{dt} = \\mu N - \\beta \\frac{S I}{N} - \\mu S,\\quad\n\\frac{dE}{dt} = \\beta \\frac{S I}{N} - \\sigma E - \\mu E,\\quad\n\\frac{dI}{dt} = \\sigma E - \\gamma I - \\mu I,\\quad\n\\frac{dR}{dt} = \\gamma I - \\mu R,\n$$\n其中对于所有 $t\\ge 0$ 都有 $S(t)+E(t)+I(t)+R(t)=N$。从仓室间流动的核心定义和种群守恒出发，使用重标定的时间 $\\tau=\\gamma t$ 和种群分数 $x(\\tau)=S(t)/N$，$y(\\tau)=E(t)/N$，$z(\\tau)=I(t)/N$，$w(\\tau)=R(t)/N$ 进行无量纲化。推导以变量 $(x,y,z,w)$ 表示的无量纲系统，并确定在此标度下完全刻画该动力学的独立的无量纲参数的最小集合。将最终答案表示为列出最小独立无量纲参数的单行矩阵。无需进行数值计算。",
            "solution": "问题陈述描述了一个标准的带有生命动态的易感–暴露–感染–康复（SEIR）仓室模型，这是数理流行病学的基石。所提供的常微分方程组精确地表示了所描述的仓室之间的流动，并且守恒定律与该动力学一致。该问题有科学依据、适定且客观。它提出了动力系统分析中的一个标准任务：无量纲化。因此，该问题是有效的，我们可以继续求解。\n\n目标是对给定的微分方程组进行无量纲化：\n$$\n\\frac{dS}{dt} = \\mu N - \\beta \\frac{S I}{N} - \\mu S\n$$\n$$\n\\frac{dE}{dt} = \\beta \\frac{S I}{N} - \\sigma E - \\mu E\n$$\n$$\n\\frac{dI}{dt} = \\sigma E - \\gamma I - \\mu I\n$$\n$$\n\\frac{dR}{dt} = \\gamma I - \\mu R\n$$\n种群大小 $N$ 是恒定的，且各仓室之和为 $N$：$S(t) + E(t) + I(t) + R(t) = N$。\n\n题目要求我们使用以下重标定：\n1.  无量纲时间 $\\tau = \\gamma t$。\n2.  无量纲种群分数：$x(\\tau) = \\frac{S(t)}{N}$，$y(\\tau) = \\frac{E(t)}{N}$，$z(\\tau) = \\frac{I(t)}{N}$，以及 $w(\\tau) = \\frac{R(t)}{N}$。\n\n首先，我们使用链式法则变换时间导数。从 $\\tau = \\gamma t$，我们有 $t = \\frac{\\tau}{\\gamma}$。导数算子变换为：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = \\gamma \\frac{d}{d\\tau}\n$$\n\n接下来，我们将原始状态变量 $S, E, I, R$ 及其导数用新的无量纲变量 $x, y, z, w$ 表示。\n$$\nS(t) = N x(\\tau) \\implies \\frac{dS}{dt} = \\gamma \\frac{d(Nx)}{d\\tau} = N\\gamma \\frac{dx}{d\\tau}\n$$\n$$\nE(t) = N y(\\tau) \\implies \\frac{dE}{dt} = \\gamma \\frac{d(Ny)}{d\\tau} = N\\gamma \\frac{dy}{d\\tau}\n$$\n$$\nI(t) = N z(\\tau) \\implies \\frac{dI}{dt} = \\gamma \\frac{d(Nz)}{d\\tau} = N\\gamma \\frac{dz}{d\\tau}\n$$\n$$\nR(t) = N w(\\tau) \\implies \\frac{dR}{dt} = \\gamma \\frac{d(Nw)}{d\\tau} = N\\gamma \\frac{dw}{d\\tau}\n$$\n\n现在，我们将这些表达式代入四个控制方程中的每一个。\n\n对于易感仓室方程：\n$$\nN\\gamma \\frac{dx}{d\\tau} = \\mu N - \\beta \\frac{(Nx)(Nz)}{N} - \\mu(Nx)\n$$\n我们将整个方程除以 $N\\gamma$：\n$$\n\\frac{dx}{d\\tau} = \\frac{\\mu}{\\gamma} - \\frac{\\beta}{\\gamma} xz - \\frac{\\mu}{\\gamma} x\n$$\n这可以重排为：\n$$\n\\frac{dx}{d\\tau} = \\frac{\\mu}{\\gamma}(1 - x) - \\frac{\\beta}{\\gamma} xz\n$$\n\n对于暴露仓室方程：\n$$\nN\\gamma \\frac{dy}{d\\tau} = \\beta \\frac{(Nx)(Nz)}{N} - \\sigma(Ny) - \\mu(Ny)\n$$\n除以 $N\\gamma$：\n$$\n\\frac{dy}{d\\tau} = \\frac{\\beta}{\\gamma} xz - \\frac{\\sigma}{\\gamma}y - \\frac{\\mu}{\\gamma}y\n$$\n合并含有 $y$ 的项：\n$$\n\\frac{dy}{d\\tau} = \\frac{\\beta}{\\gamma} xz - \\left(\\frac{\\sigma+\\mu}{\\gamma}\\right)y\n$$\n\n对于感染仓室方程：\n$$\nN\\gamma \\frac{dz}{d\\tau} = \\sigma(Ny) - \\gamma(Nz) - \\mu(Nz)\n$$\n除以 $N\\gamma$：\n$$\n\\frac{dz}{d\\tau} = \\frac{\\sigma}{\\gamma}y - \\frac{\\gamma}{\\gamma}z - \\frac{\\mu}{\\gamma}z\n$$\n合并含有 $z$ 的项：\n$$\n\\frac{dz}{d\\tau} = \\frac{\\sigma}{\\gamma}y - \\left(1 + \\frac{\\mu}{\\gamma}\\right)z\n$$\n\n对于康复仓室方程：\n$$\nN\\gamma \\frac{dw}{d\\tau} = \\gamma(Nz) - \\mu(Nw)\n$$\n除以 $N\\gamma$：\n$$\n\\frac{dw}{d\\tau} = \\frac{\\gamma}{\\gamma}z - \\frac{\\mu}{\\gamma}w\n$$\n$$\n\\frac{dw}{d\\tau} = z - \\frac{\\mu}{\\gamma}w\n$$\n\n完整的无量纲系统是：\n$$\n\\frac{dx}{d\\tau} = \\frac{\\mu}{\\gamma}(1 - x) - \\frac{\\beta}{\\gamma} xz\n$$\n$$\n\\frac{dy}{d\\tau} = \\frac{\\beta}{\\gamma} xz - \\left(\\frac{\\sigma+\\mu}{\\gamma}\\right)y\n$$\n$$\n\\frac{dz}{d\\tau} = \\frac{\\sigma}{\\gamma}y - \\left(1 + \\frac{\\mu}{\\gamma}\\right)z\n$$\n$$\n\\frac{dw}{d\\tau} = z - \\frac{\\mu}{\\gamma}w\n$$\n守恒定律 $S+E+I+R=N$ 变为 $N(x+y+z+w)=N$，简化为 $x+y+z+w=1$。这意味着系统维度可以从 $4$ 降到 $3$，例如通过表示 $w = 1-x-y-z$。\n\n通过检查无量纲方程组中的系数，我们确定了控制动力学的独立的无量纲参数群。这些参数是原始速率的比值，反映了它们的相对大小。原始系统有四个参数：$\\beta$、$\\sigma$、$\\gamma$ 和 $\\mu$，单位均为时间倒数。通过相对于恢复期 $1/\\gamma$ 对时间进行标度，无量纲化减小了参数空间。完全刻画该动力学的独立的无量纲参数的最小集合由以下三个群组成：\n1.  $\\frac{\\beta}{\\gamma}$：传播率与恢复率之比。这通常被称为接触数。\n2.  $\\frac{\\sigma}{\\gamma}$：从暴露到感染的进展率与恢复率之比。\n3.  $\\frac{\\mu}{\\gamma}$：人口更替率与恢复率之比，表明生命动态相对于流行病时间尺度的相对重要性。\n\n这三个无量纲量构成了在所选标度下描述系统行为所必需的独立的参数的最小集合。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\beta}{\\gamma} & \\frac{\\sigma}{\\gamma} & \\frac{\\mu}{\\gamma} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "模型分析的一个核心目标是进行预测，而衡量流行病最终影响的一个关键指标是“最终侵袭率”，即最终被感染的人口比例。这个实践练习  让你推导并求解著名的“最终规模方程”，该方程将基本再生数 $R_0$ 与这一最终结果联系起来。通过这个过程，你不仅能理解理论，还能通过编写代码来获得解决流行病学中经典问题的数值计算经验。",
            "id": "3928237",
            "problem": "考虑经典的易感-感染-移除（SIR）模型，其中总人口恒定为 $N$，易感者人数为 $S(t)$，感染者人数为 $I(t)$，移除者人数为 $R(t)$。该模型假设均匀混合和频率依赖型发生率。基本再生数（BRN）$R_0$ 定义为在完全易感的人群中引入单个感染者所产生的平均二次感染数。\n\n假设初始感染者人数可忽略不计，移除者人数为零，因此 $S(0) = N$，$I(0) \\ll N$ 且 $R(0) = 0$。在这些假设下，存在一个明确的最终规模关系，它将基本再生数 $R_0$ 与 $t \\to \\infty$ 时的最终易感者人数 $S(\\infty)$ 联系起来。最终侵袭率 $A$ 定义为 $A = 1 - S(\\infty)/N$。您的任务是根据给定的 $R_0$ 值，从 SIR 模型所蕴含的隐式最终规模关系中数值计算 $A$。\n\n您的程序必须：\n- 从模型的基本定义出发，在给定假设下推导出定义 SIR 模型中 $A$ 的隐式标量方程，然后数值求解该方程，以获得每个给定 $R_0$ 对应的 $A$。\n- 对于 $R_0 \\leq 1$，返回对 $A$ 具有生物学意义的解。\n- 对于 $R_0 > 1$，在区间 $(0,1)$ 内找到 $A$ 的唯一非平凡解。\n\n所有输出都是无量纲的，并且必须表示为小数。将每个计算出的 $A$ 四舍五入到小数点后8位。\n\n测试套件：\n- 情况 1：$R_0 = 0.0$（无传播）。\n- 情况 2：$R_0 = 0.5$（亚临界传播）。\n- 情况 3：$R_0 = 1.0$（阈值情况）。\n- 情况 4：$R_0 = 2.0$（超临界传播）。\n- 情况 5：$R_0 = 5.0$（强传播）。\n- 情况 6：$R_0 = 10.0$（非常强的传播）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表（例如 $[a_1,a_2,a_3,a_4,a_5,a_6]$），其中每个 $a_i$ 是按上述顺序列出的相应测试用例的四舍五入后的最终侵袭率。",
            "solution": "该问题要求推导易感-感染-移除（SIR）模型的最终规模关系，并对其进行数值求解，以找出给定基本再生数 $R_0$ 值下的最终侵袭率 $A$。\n\n该问题已经过验证，被认为是具有科学依据、提法明确且客观的。这是数理流行病学中的一个标准问题。\n\n经典的 SIR 模型将一个恒定的总人口 $N$ 划分为三个仓室：易感者（$S$）、感染者（$I$）和移除者（$R$）。假设采用频率依赖型发生率，其动力学由以下常微分方程（ODEs）组描述：\n$$\n\\frac{dS}{dt} = -\\frac{\\beta S I}{N}\n$$\n$$\n\\frac{dI}{dt} = \\frac{\\beta S I}{N} - \\gamma I\n$$\n$$\n\\frac{dR}{dt} = \\gamma I\n$$\n这里，$\\beta$ 是有效接触率（传播率乘以单位时间内的接触次数），$\\gamma$ 是恢复率，因此 $1/\\gamma$ 是平均感染期。总人口 $N = S(t) + I(t) + R(t)$ 保持不变。\n\n基本再生数 $R_0$ 定义为在完全易感的人群中，由单个感染者引起的平均二次感染数。在流行病开始时，$S(t) \\approx S(0) = N$。从 $dI/dt$ 的方程可知，如果 $(\\beta S(0) / N - \\gamma) > 0$，感染者人数将会增加，这可简化为 $\\beta/\\gamma > 1$。因此，$R_0$ 由下式给出：\n$$\nR_0 = \\frac{\\beta}{\\gamma}\n$$\n\n为了找到流行病的最终规模，我们寻求一个与时间 $t$ 无关的状态变量之间的关系。我们可以将 $dS/dt$ 的方程除以 $dR/dt$ 的方程：\n$$\n\\frac{dS}{dR} = \\frac{-(\\beta S I / N)}{\\gamma I} = -\\frac{\\beta}{\\gamma} \\frac{S}{N} = -R_0 \\frac{S}{N}\n$$\n这是一个可分离的常微分方程。我们可以重新整理并从流行病开始（$t=0$）到结束（$t \\to \\infty$）进行积分：\n$$\n\\int_{S(0)}^{S(\\infty)} \\frac{dS}{S} = -\\frac{R_0}{N} \\int_{R(0)}^{R(\\infty)} dR\n$$\n使用问题中提供的初始条件 $S(0) = N$ 和 $R(0) = 0$：\n$$\n[\\ln(S)]_{N}^{S(\\infty)} = -\\frac{R_0}{N} [R]_{0}^{R(\\infty)}\n$$\n$$\n\\ln(S(\\infty)) - \\ln(N) = -\\frac{R_0}{N} R(\\infty)\n$$\n$$\n\\ln\\left(\\frac{S(\\infty)}{N}\\right) = -\\frac{R_0}{N} R(\\infty)\n$$\n当 $t \\to \\infty$ 时，流行病结束，因此感染者人数趋近于零，$I(\\infty) = 0$。由于总人口守恒，$N = S(\\infty) + I(\\infty) + R(\\infty) = S(\\infty) + R(\\infty)$。这意味着在流行病结束时被移除的总人数为 $R(\\infty) = N - S(\\infty)$。将此代入我们的积分方程，得到最终规模关系：\n$$\n\\ln\\left(\\frac{S(\\infty)}{N}\\right) = -R_0 \\left(1 - \\frac{S(\\infty)}{N}\\right)\n$$\n问题将最终侵袭率 $A$ 定义为被感染的初始人口比例，即 $A = R(\\infty)/N = (N - S(\\infty))/N = 1 - S(\\infty)/N$。由此得出，最终易感者比例为 $S(\\infty)/N = 1 - A$。将这些定义代入最终规模关系，得到关于 $A$ 的隐式方程：\n$$\n\\ln(1 - A) = -R_0 A\n$$\n该方程可以重写为函数 $f(A)$ 的求根问题：\n$$\nf(A) = \\ln(1 - A) + R_0 A = 0\n$$\n我们必须在区间 $[0, 1)$ 内求解该方程以得到 $A$。\n\n解的性质取决于 $R_0$ 的值：\n1.  情况 $R_0 \\le 1$：\n    一个明显的解是 $A=0$，因为 $f(0) = \\ln(1) + 0 = 0$。这对应于零规模的流行病。为了检查是否存在其他解，我们考察 $f(A)$ 的导数：$f'(A) = -1/(1-A) + R_0$。对于 $A \\in (0,1)$，我们有 $1/(1-A) > 1$。如果 $R_0 \\le 1$，则对于所有 $A \\in (0,1)$，有 $f'(A) < 1 - 1 = 0$。这意味着 $f(A)$ 从 $f(0)=0$ 开始严格递减。因此，对于所有 $A \\in (0,1)$，有 $f(A) < 0$，所以 $A=0$ 是唯一的解。这是具有生物学意义的结果：没有大规模疫情暴发。\n\n2.  情况 $R_0 > 1$：\n    $A=0$ 仍然是一个解（平凡解）。然而，在 $A=0$ 处，导数为 $f'(0) = R_0 - 1 > 0$，所以函数初始是递增的。当 $A \\to 1^-$ 时，$\\ln(1-A) \\to -\\infty$，所以 $f(A) \\to -\\infty$。由于函数从 $f(0)=0$ 开始，先递增，然后递减至 $-\\infty$，根据介值定理，保证在 $(0, 1)$ 区间内至少存在另一个根 $A$。二阶导数是 $f''(A) = -1/(1-A)^2 < 0$，这意味着函数是严格凹的。一个严格凹函数最多与一条水平线相交两次。既然我们已经找到了两个根（$A=0$ 和另一个在 $(0,1)$ 区间内的根），那么对于 $A$ 存在唯一的非平凡解。问题要求的就是这个唯一的非平凡解。\n\n对于数值实现，我们将按以下方式求解 $A$：\n- 对于 $R_0 \\le 1$ 的测试用例，最终侵袭率 $A$ 为 $0$。\n- 对于 $R_0 > 1$ 的测试用例，我们将在区间 $(0,1)$ 内数值求解方程 $f(A) = \\ln(1-A) + R_0 A = 0$ 的根。像 Brent-Dekker 方法（'brentq'）这样的稳健的区间法是合适的。我们可以使用一个狭窄的区间，如 $[10^{-9}, 1-10^{-9}]$，来安全地找到非平凡根。最终结果将四舍五入到小数点后8位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the final attack rate for the SIR model for a given set of\n    basic reproduction numbers (R0).\n\n    The final attack rate A is the solution to the implicit equation:\n    ln(1 - A) + R0 * A = 0\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,  # Case 1: no transmission\n        0.5,  # Case 2: subcritical transmission\n        1.0,  # Case 3: threshold case\n        2.0,  # Case 4: supercritical transmission\n        5.0,  # Case 5: strong transmission\n        10.0, # Case 6: very strong transmission\n    ]\n\n    results = []\n    for r0 in test_cases:\n        # For R0 = 1, the only biologically stable solution is A=0 (no epidemic).\n        if r0 = 1.0:\n            attack_rate = 0.0\n        else:\n            # For R0 > 1, there is a unique non-trivial solution for A in (0, 1).\n            # We need to find the root of the function f(A) = ln(1-A) + R0*A.\n            def final_size_equation(a, r0_val):\n                # Ensure a is within the valid domain for np.log\n                if a >= 1.0 or a = 0.0:\n                    # Return a large number to guide the solver away from boundaries\n                    # This is a safeguard, though brentq should stay within the bracket.\n                    return np.inf\n                return np.log(1.0 - a) + r0_val * a\n\n            # The bracket for the root-finding algorithm.\n            # We know the non-trivial root is strictly between 0 and 1.\n            # A small epsilon is used to avoid division by zero or log(0).\n            bracket = (1e-9, 1.0 - 1e-9)\n\n            # Use SciPy's root_scalar with the brentq method, which is robust\n            # for finding a root within a given bracket.\n            sol = root_scalar(final_size_equation, args=(r0,), method='brentq', bracket=bracket)\n            attack_rate = sol.root\n\n        # Format the result to 8 decimal places as required.\n        # The f-string format specifier {:.8f} also handles rounding.\n        results.append(f\"{attack_rate:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将理论模型应用于现实世界数据时，我们必须面对数据不完整性的挑战，其中病例报告不足是一个普遍存在的问题。本练习  探讨了“结构可辨识性”这一关键概念，揭示了为什么仅凭报告的发病率数据无法唯一地区分传播率和报告率。通过分析这个问题，你将学会批判性地思考从特定数据流中可以推断出什么，以及需要哪些额外的信息（如血清学调查）来解决这种模糊性。",
            "id": "3928240",
            "problem": "考虑一个总人口数为 $N$ 的易感-感染-移除 (SIR) 模型，其初始条件 $S(0)$、$I(0)$、$R(0)$ 以及参数：传播率 $\\beta$、移除率 $\\gamma$ 和病例报告率 $\\rho$ 均为未知。其控制方程为\n$$\n\\frac{dS}{dt} \\;=\\; -\\frac{\\beta}{N}\\,S(t)\\,I(t), \\qquad\n\\frac{dI}{dt} \\;=\\; \\frac{\\beta}{N}\\,S(t)\\,I(t) \\;-\\; \\gamma\\,I(t), \\qquad\n\\frac{dR}{dt} \\;=\\; \\gamma\\,I(t).\n$$\n假设唯一可观测的数据流是报告发病率的时间序列 $y(t)$，由测量模型定义\n$$\ny(t) \\;=\\; \\rho\\,\\frac{\\beta}{N}\\,S(t)\\,I(t),\n$$\n即，$y(t)$ 等于真实发病率 $\\frac{\\beta}{N}\\,S(t)\\,I(t)$ 的一小部分 $\\rho$。没有其他状态或参数被直接测量，并且对 $\\rho$、$\\beta$、$\\gamma$ 或初始条件没有外部约束。\n\n从第一性原理出发，不引入任何快捷公式，仅从 $y(t)$ 推理 $\\beta$ 和 $\\rho$ 的结构可辨识性。具体来说，使用模型和测量映射的定义，以及在 $t=0$ 附近和 $I(0)$ 很小的早期流行阶段的局部推理，来评估不同的参数三元组是否能对 $t\\in[0,T]$ 生成相同的 $y(t)$。然后，评估在科学上现实的假设下，哪些补救措施可以解决这种不可辨识性问题。\n\n选择所有正确的陈述：\n\nA. 当 $y(t)$ 是唯一可观测量且没有外部约束时，$(\\beta,\\rho)$ 是结构不可辨识的，因为 $y(t)$ 依赖于乘积 $\\rho\\,\\frac{\\beta}{N}S(t)I(t)$，而未观测到的仓室动力学无法将由 $\\rho$ 引起的缩放与由 $\\beta$ 引起的传播强度分离开来。\n\nB. 如果独立的血清学调查估计了随时间变化的累计感染比例（从而约束了 $S(t)$ 或累计发病率），并且临床数据提供了 $\\gamma$，那么可以从 $y(t)$ 和血清学数据中辨识出 $\\rho$，随后可以通过将 SIR 动力学拟合到受约束的 $S(t)$ 和 $y(t)$ 来辨识出 $\\beta$。\n\nC. 将 SIR 模型替换为易感-暴露-感染-移除 (SEIR) 模型，其方程为\n$$\n\\frac{dS}{dt}=-\\frac{\\beta}{N}S(t)I(t), \\quad \\frac{dE}{dt}=\\frac{\\beta}{N}S(t)I(t)-\\sigma E(t), \\quad \\frac{dI}{dt}=\\sigma E(t)-\\gamma I(t), \\quad \\frac{dR}{dt}=\\gamma I(t),\n$$\n并保持相同的测量 $y(t)=\\rho\\,\\frac{\\beta}{N}S(t)I(t)$，并不能仅从 $y(t)$ 中消除 $(\\beta,\\rho)$ 的结构不可辨识性。\n\nD. 如果 $I(t)$ 和 $S(t)$ 都随时间被观测到，并且 $\\gamma$ 已知，那么 $(\\beta,\\rho)$ 变得结构可辨识，因为可以从状态方程 $\\frac{dI}{dt}=\\frac{\\beta}{N}S(t)I(t)-\\gamma I(t)$ 中计算出 $\\beta$，然后从测量方程 $y(t)=\\rho\\,\\frac{\\beta}{N}S(t)I(t)$ 中恢复 $\\rho$。\n\nE. 仅延长 $y(t)$ 的时间范围（即收集更长的发病率时间序列）本身最终会将 $\\beta$ 与 $\\rho$ 分离开来，因为易感者的耗尽会改变 $S(t)$，从而将 $\\beta$ 唯一地印刻在 $y(t)$ 中。",
            "solution": "用户需要对一个关于仓室模型（特别是 SIR 和 SEIR 模型）中结构可辨识性的问题进行批判性分析，该问题基于单一的报告发病率数据流。\n\n### 步骤 1：提取已知条件\n\n-   **模型**：易感-感染-移除 (SIR) 模型。\n-   **人口规模**：总人口 $N$。\n-   **状态变量**：$S(t)$、 $I(t)$、 $R(t)$。\n-   **模型方程**：\n    $$\n    \\frac{dS}{dt} \\;=\\; -\\frac{\\beta}{N}\\,S(t)\\,I(t)\n    $$\n    $$\n    \\frac{dI}{dt} \\;=\\; \\frac{\\beta}{N}\\,S(t)\\,I(t) \\;-\\; \\gamma\\,I(t)\n    $$\n    $$\n    \\frac{dR}{dt} \\;=\\; \\gamma\\,I(t)\n    $$\n-   **未知数**：\n    -   初始条件：$S(0)$、$I(0)$、$R(0)$。\n    -   参数：传播率 $\\beta$、移除率 $\\gamma$、病例报告率 $\\rho$。\n-   **可观测量**：报告发病率的时间序列 $y(t)$。\n-   **测量模型**：\n    $$\n    y(t) \\;=\\; \\rho\\,\\frac{\\beta}{N}\\,S(t)\\,I(t)\n    $$\n-   **约束条件**：\n    -   $y(t)$ 是唯一可观测的数据流。\n    -   没有其他状态或参数被直接测量。\n    -   对 $\\rho, \\beta, \\gamma$ 或初始条件没有外部约束。\n-   **任务**：仅从 $y(t)$ 分析 $\\beta$ 和 $\\rho$ 的结构可辨识性，并评估选项中提出的补救措施的有效性。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于标准的 SIR 和 SEIR 仓室模型，这些是数理流行病学中的基本工具。结构可辨识性的概念是系统理论和数学生物学中一个成熟的课题。测量模型假设报告病例是真实发病率的一部分，这是一个标准且现实的假设。该问题没有科学错误。\n-   **良态性 (Well-Posed)**：该问题是一个关于动力系统性质的明确定义的问题。它询问在给定模型结构和指定输出的情况下，是否可能唯一地确定某些参数。这是一个标准的、可解的（即可证明或证伪的）问题。\n-   **客观性**：该问题以精确、技术性的语言陈述，没有模糊性、主观性或偏见。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。这是生物医学系统建模领域一个标准的、良态的问题。我现在将进行求解和逐项分析。\n\n***\n\n### 基于原理的推导与分析\n\n问题的核心是确定在给定模型结构的情况下，参数 $\\beta$ 和 $\\rho$ 是否可以从测量值 $y(t)$ 中被唯一地辨识出来。结构可辨识性问题询问的是，对于所有 $t$，从 $y(t; \\Theta_1) = y(t; \\Theta_2)$ 是否必然能推导出 $\\Theta_1 = \\Theta_2$，其中 $\\Theta$ 是所有未知参数和初始条件的集合。如果我们能找到两个不同的参数集 $\\Theta_1 \\neq \\Theta_2$ 产生完全相同的输出 $y(t)$，那么该模型就是结构不可辨识的。\n\n我们通过定义一组新的缩放状态变量来分析该系统：\n令 $\\tilde{S}(t) = \\rho S(t)$，$\\tilde{I}(t) = \\rho I(t)$，以及 $\\tilde{R}(t) = \\rho R(t)$。初始条件也同样进行缩放：$\\tilde{S}(0) = \\rho S(0)$，$\\tilde{I}(0) = \\rho I(0)$，$\\tilde{R}(0) = \\rho R(0)$。\n\n我们可以用这些缩放变量重写 SIR 系统和测量方程。\n真实发病率为 $Inc(t) = \\frac{\\beta}{N}S(t)I(t)$。测量值为 $y(t) = \\rho \\cdot Inc(t)$。\n这意味着 $Inc(t) = y(t)/\\rho$。\n\nSIR 方程变为：\n$$\n\\frac{dS}{dt} = - \\frac{y(t)}{\\rho} \\implies \\frac{d\\tilde{S}}{dt} = \\rho \\frac{dS}{dt} = -y(t)\n$$\n$$\n\\frac{dI}{dt} = \\frac{y(t)}{\\rho} - \\gamma I(t) \\implies \\frac{d\\tilde{I}}{dt} = \\rho \\frac{dI}{dt} = y(t) - \\gamma \\tilde{I}(t)\n$$\n$$\n\\frac{dR}{dt} = \\gamma I(t) \\implies \\frac{d\\tilde{R}}{dt} = \\rho \\frac{dR}{dt} = \\gamma \\tilde{I}(t)\n$$\n观测输出 $y(t)$ 由一个涉及缩放状态 $(\\tilde{S}, \\tilde{I}, \\tilde{R})$ 的“元系统”生成，并由参数组 $\\{\\beta/\\rho, \\gamma, \\tilde{S}(0), \\tilde{I}(0)\\}$ 控制。\n\n从数据 $y(t)$ 中，我们可以尝试辨识这些组合参数。例如，我们可以对第一个方程进行积分得到 $\\tilde{S}(t) = \\tilde{S}(0) - \\int_0^t y(\\tau) d\\tau$。第二个方程是关于 $\\tilde{I}(t)$ 的、由 $y(t)$ 驱动的线性常微分方程。通过将这个元系统拟合到数据 $y(t)$，我们或许能够辨识出这些组合参数的值，例如，找到复合参数 $\\kappa = \\beta/\\rho$ 的值，以及 $\\gamma$ 和缩放后的初始条件 $\\tilde{S}(0)$ 和 $\\tilde{I}(0)$ 的值。\n\n然而，这并不能让我们唯一地确定原始参数。假设我们找到了一个有效的参数集 $\\{\\beta_1, \\rho_1, \\gamma_1, S_1(0), I_1(0)\\}$。这对应于一组元参数 $\\{\\kappa_1, \\gamma_1, \\tilde{S}_1(0), \\tilde{I}_1(0)\\}$，其中 $\\kappa_1 = \\beta_1/\\rho_1$，$\\tilde{S}_1(0) = \\rho_1 S_1(0)$，并且 $\\tilde{I}_1(0) = \\rho_1 I_1(0)$。\n\n现在，考虑任何其他参数集 $\\{\\beta_2, \\rho_2\\}$ 使得 $\\beta_2/\\rho_2 = \\kappa_1$。例如，令 $\\beta_2 = c\\beta_1$ 和 $\\rho_2 = c\\rho_1$ 对于任何 $c0$。这个选择保持了比率不变。然后我们可以选择新的初始条件 $S_2(0) = S_1(0)/c$ 和 $I_2(0) = I_1(0)/c$，使得 $\\tilde{S}_2(0) = \\rho_2 S_2(0) = (c\\rho_1)(S_1(0)/c) = \\rho_1 S_1(0) = \\tilde{S}_1(0)$ 并且 $\\tilde{I}_2(0) = \\rho_2 I_2(0) = (c\\rho_1)(I_1(0)/c) = \\rho_1 I_1(0) = \\tilde{I_1}(0)$。\n\n由于这组新的元参数与第一组完全相同，它将生成完全相同的 $y(t)$ 轨迹。然而，当 $c\\neq 1$ 时，其底层参数 $(\\beta_2, \\rho_2) = (c\\beta_1, c\\rho_1)$ 与 $(\\beta_1, \\rho_1)$ 是不同的。这证明了结构的不可辨识性。\n\n### 逐项分析\n\n**A. 当 $y(t)$ 是唯一可观测量且没有外部约束时，$(\\beta,\\rho)$ 是结构不可辨识的，因为 $y(t)$ 依赖于乘积 $\\rho\\,\\frac{\\beta}{N}S(t)I(t)$，而未观测到的仓室动力学无法将由 $\\rho$ 引起的缩放与由 $\\beta$ 引起的传播强度分离开来。**\n\n这个陈述是对情况的正确而精辟的总结。如上文正式推导的，系统的输出 $y(t)$ 是由一个结构生成的，其中参数 $\\beta$ 和 $\\rho$ 密不可分地联系在一起。我们可以找到无限对 $(\\beta, \\rho)$ 及相应的初始条件，它们能产生完全相同的 $y(t)$ 时间序列。核心问题是，驱动动力学的真实发病率 $\\frac{\\beta}{N}S(t)I(t)$ 只能通过一个本身未知的缩放因子 $\\rho$ 来观测。$\\beta$ 的任何变化都可以通过 $\\rho$ 和未知初始条件的变化来补偿。\n\n**结论：正确**\n\n**B. 如果独立的血清学调查估计了随时间变化的累计感染比例（从而约束了 $S(t)$ 或累计发病率），并且临床数据提供了 $\\gamma$，那么可以从 $y(t)$ 和血清学数据中辨识出 $\\rho$，随后可以通过将 SIR 动力学拟合到受约束的 $S(t)$ 和 $y(t)$ 来辨识出 $\\beta$。**\n\n我们来分析这个新情景。给定条件：\n1.  $y(t)$（观测到的报告发病率）\n2.  $S(t)$（从血清学调查中观测到）\n3.  $\\gamma$（从临床数据中已知）\n\n从 SIR 模型可知，新感染的速率（真实发病率）是 $-\\frac{dS}{dt}$。\n测量模型是 $y(t) = \\rho \\times (\\text{真实发病率})$。\n代入真实发病率的表达式，我们得到：\n$$\ny(t) = \\rho \\left( -\\frac{dS}{dt} \\right)\n$$\n由于 $y(t)$ 是观测值，$S(t)$ 也是观测值（意味着其导数 $\\frac{dS}{dt}$ 可以计算），我们可以解出 $\\rho$：\n$$\n\\rho = - \\frac{y(t)}{dS/dt}\n$$\n假设疫情不是静态的（$dS/dt \\neq 0$），$\\rho$ 是可辨识的。一旦 $\\rho$ 已知，与 $\\beta$ 的模糊性就被打破了。\n\n为了辨识 $\\beta$，我们可以使用关于 $I(t)$ 的方程。从 $S(t)$ 的方程中，我们首先可以找到 $I(t)$：\n$$\n\\frac{dS}{dt} = -\\frac{\\beta}{N}S(t)I(t) \\implies I(t) = -\\frac{N}{\\beta S(t)}\\frac{dS}{dt}\n$$\n现在，我们使用 $I(t)$ 的方程：\n$$\n\\frac{dI}{dt} = \\frac{\\beta}{N}S(t)I(t) - \\gamma I(t) = -\\frac{dS}{dt} - \\gamma I(t)\n$$\n代入 $I(t)$ 的表达式：\n$$\n\\frac{d}{dt}\\left(-\\frac{N}{\\beta S(t)}\\frac{dS}{dt}\\right) = -\\frac{dS}{dt} - \\gamma \\left(-\\frac{N}{\\beta S(t)}\\frac{dS}{dt}\\right)\n$$\n这是一个微分方程，其中唯一的未知数是常数 $\\beta$。所有其他量（$S(t)$ 及其导数、$\\gamma, N$）都是已知的。因此，$\\beta$ 可以被唯一确定（例如，通过数值拟合）。该陈述的逻辑是合理的。\n\n**结论：正确**\n\n**C. 将 SIR 模型替换为易感-暴露-感染-移除 (SEIR) 模型，其方程为 [...] 并保持相同的测量 $y(t)=\\rho\\,\\frac{\\beta}{N}S(t)I(t)$，并不能仅从 $y(t)$ 中消除 $(\\beta,\\rho)$ 的结构不可辨识性。**\n\n主要分析中的逻辑可以扩展到 SEIR 模型。真实发病率仍然是 $Inc(t) = \\frac{\\beta}{N}S(t)I(t)$，测量值是 $y(t) = \\rho \\cdot Inc(t)$。现在的动力学方程是：\n$$\n\\frac{dS}{dt} = -Inc(t) = -\\frac{y(t)}{\\rho}\n$$\n$$\n\\frac{dE}{dt} = Inc(t) - \\sigma E(t) = \\frac{y(t)}{\\rho} - \\sigma E(t)\n$$\n$$\n\\frac{dI}{dt} = \\sigma E(t) - \\gamma I(t)\n$$\n整个系统的动力学由项 $y(t)/\\rho$ 驱动。使用相同的缩放技巧 $\\tilde{S}=\\rho S$, $\\tilde{E}=\\rho E$, $\\tilde{I}=\\rho I$，我们发现这些缩放状态的动力学由 $\\{\\beta/\\rho, \\sigma, \\gamma, \\tilde{S}(0), \\tilde{E}(0), \\tilde{I}(0)\\}$ 控制。与 SIR 模型一样，我们只能辨识比率 $\\beta/\\rho$，而不能辨识单个参数。引入未观测的“暴露”仓室，它起着线性转移步骤的作用，但并未提供打破 $\\beta$ 和 $\\rho$ 之间基本缩放模糊性所需的信息。\n\n**结论：正确**\n\n**D. 如果 $I(t)$ 和 $S(t)$ 都随时间被观测到，并且 $\\gamma$ 已知，那么 $(\\beta,\\rho)$ 变得结构可辨识，因为可以从状态方程 $\\frac{dI}{dt}=\\frac{\\beta}{N}S(t)I(t)-\\gamma I(t)$ 中计算出 $\\beta$，然后从测量方程 $y(t)=\\rho\\,\\frac{\\beta}{N}S(t)I(t)$ 中恢复 $\\rho$。**\n\n我们来分析这个情景。给定条件：\n1.  $y(t)$（观测到的报告发病率）\n2.  $S(t)$（观测到的状态）\n3.  $I(t)$（观测到的状态）\n4.  $\\gamma$（已知参数）\n\n未知数是常数参数 $\\beta$ 和 $\\rho$。选项中的符号 $\\beta(t), \\rho(t)$ 应解释为在每个时间点 $t$ 可以计算出的参数值。如果模型是正确的，这个值必须是常数。\n\n从 SIR 的 $I(t)$ 方程：\n$$\n\\frac{dI}{dt} = \\frac{\\beta}{N}S(t)I(t) - \\gamma I(t)\n$$\n由于 $I(t)$ 是观测值，我们可以计算其导数 $\\frac{dI}{dt}$。我们可以重新排列方程来解出 $\\beta$：\n$$\n\\frac{\\beta}{N}S(t)I(t) = \\frac{dI}{dt} + \\gamma I(t) \\implies \\beta = \\frac{N}{S(t)I(t)}\\left(\\frac{dI}{dt} + \\gamma I(t)\\right)\n$$\n由于 $S(t)$, $I(t)$, $dI/dt$, $\\gamma$ 和 $N$ 都是已知的，$\\beta$ 可以被计算出来。因此，$\\beta$ 是可辨识的。\n\n接下来，我们使用测量方程：\n$$\ny(t) = \\rho \\frac{\\beta}{N} S(t) I(t)\n$$\n我们可以重新排列来解出 $\\rho$：\n$$\n\\rho = \\frac{y(t)}{\\frac{\\beta}{N}S(t)I(t)}\n$$\n由于 $y(t)$, $S(t)$, $I(t)$ 是已知的，并且我们刚刚辨识出 $\\beta$，所以右边的所有项都是已知的。因此，$\\rho$ 也是可辨识的。选项中的推理完全正确。\n\n**结论：正确**\n\n**E. 仅延长 $y(t)$ 的时间范围（即收集更长的发病率时间序列）本身最终会将 $\\beta$ 与 $\\rho$ 分离开来，因为易感者的耗尽会改变 $S(t)$，从而将 $\\beta$ 唯一地印刻在 $y(t)$ 中。**\n\n这个陈述是错误的。结构不可辨识性是模型代数和微分结构的一个基本属性，而不是数据量的问题。如选项 A 的分析所示，存在不同的参数集，它们能为*所有*时间 $t \\ge 0$ 生成*完全相同*的输出轨迹 $y(t)$。如果两条轨迹在区间 $[0, T_1]$ 上相同，那么它们在更长的区间 $[0, T_2]$（其中 $T_2  T_1$）上也必然相同。因此，收集更多相同的数据流无法解决这种模糊性。易感者耗尽效应已经是产生不可辨识输出的动力学的一部分；它没有提供新的、独立的信息来打破对称性。$\\beta$ 在 $S(t)$ 上的印记不是唯一的，因为它总是通过 $\\rho$ 和初始条件来调节。\n\n**结论：错误**",
            "answer": "$$\\boxed{ABCD}$$"
        }
    ]
}