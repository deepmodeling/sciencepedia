{
    "hands_on_practices": [
        {
            "introduction": "Arrhythmias often begin with an abnormal electrical impulse. This exercise  strips this event down to its biophysical core, asking you to determine if a transient ionic current can deliver enough charge to trigger a full action potential. By modeling the cell membrane as a simple capacitor, you will apply fundamental principles to understand the threshold nature of cellular excitability and the origins of triggered activity.",
            "id": "3905441",
            "problem": "Consider a single-compartment ventricular myocyte model in which a delayed afterdepolarization (DAD) is driven solely by the sodium-calcium exchanger (NCX). Assume the transmembrane region is modeled as a capacitor with capacitance per unit area $C_{m}$, and that, prior to any triggered action potential (AP), other ionic currents are negligible over the DAD time scale. The NCX-mediated DAD current density is given for $t \\ge 0$ by $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$, where inward current is negative by convention. The resting membrane potential is $V_{\\mathrm{rest}}$, the threshold potential is $V_{\\mathrm{th}}$, and the AP peak potential is $V_{\\mathrm{peak}}$.\n\nFundamental bases to use:\n- The total charge per unit area delivered by a current density $i(t)$ is $q = \\int_{0}^{\\infty} i(t)\\,dt$.\n- For a capacitive membrane, the relation between charge per unit area and voltage change is $q = C_{m}\\,\\Delta V$.\n\nDefine the threshold charge per unit area required to move the membrane from $V_{\\mathrm{rest}}$ to $V_{\\mathrm{th}}$ as $q_{\\mathrm{th}} = C_{m}\\,(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$. Let the magnitude of inward NCX-delivered charge be $|q_{\\mathrm{NCX}}|$. A triggered beat occurs if $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$. If a triggered beat occurs, define its amplitude as $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$. If no triggered beat occurs, define $A = \\Delta V_{\\mathrm{DAD}}$, where $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_{m}$ is the depolarization caused by the DAD current alone.\n\nUse the following parameter values:\n- $I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$,\n- $\\tau = 80\\,\\mathrm{ms}$,\n- $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$,\n- $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$,\n- $V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$,\n- $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$.\n\nCompute the amplitude $A$ as defined above by integrating the NCX current over time, comparing the resulting charge to the threshold charge, and selecting the appropriate expression for $A$. Express your final answer in millivolts. No rounding beyond exact arithmetic is required.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of cardiac electrophysiology and membrane biophysics, presenting a simplified but coherent model of a delayed afterdepolarization (DAD). The problem is well-posed, objective, and self-contained, providing all necessary parameters, definitions, and a clear logical path to a unique solution. The provided values are physiologically plausible.\n\nThe objective is to compute the amplitude $A$ of the voltage response to an NCX-driven DAD. The definition of $A$ is conditional, depending on whether the DAD is large enough to trigger a full action potential. The first step is to determine the total charge per unit area, $q_{\\mathrm{NCX}}$, delivered by the sodium-calcium exchanger current, $i_{\\mathrm{NCX}}(t)$.\n\nThe current density is given as $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$ for $t \\ge 0$. The total charge per unit area is found by integrating this current density over all time.\n$$q_{\\mathrm{NCX}} = \\int_{0}^{\\infty} i_{\\mathrm{NCX}}(t)\\,dt = \\int_{0}^{\\infty} -I_{0}\\,\\exp(-t/\\tau)\\,dt$$\nWe can factor out the constant $-I_{0}$:\n$$q_{\\mathrm{NCX}} = -I_{0} \\int_{0}^{\\infty} \\exp(-t/\\tau)\\,dt$$\nThe integral of the exponential function is:\n$$q_{\\mathrm{NCX}} = -I_{0} \\left[ -\\tau\\,\\exp(-t/\\tau) \\right]_{0}^{\\infty}$$\nEvaluating the expression at the limits of integration:\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( \\lim_{t\\to\\infty} (-\\tau\\,\\exp(-t/\\tau)) - (-\\tau\\,\\exp(-0/\\tau)) \\right)$$\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( 0 - (-\\tau \\cdot 1) \\right) = -I_{0}\\tau$$\nThe magnitude of this inward charge is $|q_{\\mathrm{NCX}}| = I_{0}\\tau$. We can now substitute the given parameter values: $I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$ and $\\tau = 80\\,\\mathrm{ms}$. It is critical to maintain consistent units. We convert milliseconds to seconds: $80\\,\\mathrm{ms} = 80 \\times 10^{-3}\\,\\mathrm{s}$.\n$$|q_{\\mathrm{NCX}}| = (0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80\\,\\mathrm{ms}) = (0.30 \\times 10^{-6}\\,\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80 \\times 10^{-3}\\,\\mathrm{s})$$\n$$|q_{\\mathrm{NCX}}| = 24 \\times 10^{-9}\\,\\mathrm{A}\\cdot\\mathrm{s}\\,\\mathrm{cm}^{-2} = 24 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\nThe next step is to calculate the threshold charge per unit area, $q_{\\mathrm{th}}$, required to depolarize the membrane from the resting potential $V_{\\mathrm{rest}}$ to the threshold potential $V_{\\mathrm{th}}$. The problem defines this as $q_{\\mathrm{th}} = C_{m}(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$.\nThe given parameters are $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$, $V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$, and $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$.\nFirst, calculate the required voltage change:\n$$\\Delta V = V_{\\mathrm{th}} - V_{\\mathrm{rest}} = (-65\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 20\\,\\mathrm{mV}$$\nNow, calculate $q_{\\mathrm{th}}$. We must again ensure unit consistency by converting millivolts to volts: $20\\,\\mathrm{mV} = 20 \\times 10^{-3}\\,\\mathrm{V}$. A Farad is a Coulomb per Volt, $\\mathrm{F} = \\mathrm{C}/\\mathrm{V}$.\n$$q_{\\mathrm{th}} = (1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20\\,\\mathrm{mV}) = (1.0 \\times 10^{-6}\\,\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20 \\times 10^{-3}\\,\\mathrm{V})$$\n$$q_{\\mathrm{th}} = 20 \\times 10^{-9}\\,\\mathrm{F}\\cdot\\mathrm{V}\\,\\mathrm{cm}^{-2} = 20 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\nNow we must compare $|q_{\\mathrm{NCX}}|$ with $q_{\\mathrm{th}}$ to determine if a triggered beat occurs. The condition for a triggered beat is $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$.\nWe found $|q_{\\mathrm{NCX}}| = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$ and $q_{\\mathrm{th}} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$.\nSince $0.024 > 0.020$, the condition $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$ is satisfied.\nTherefore, a triggered beat occurs.\n\nAccording to the problem definition, if a triggered beat occurs, the amplitude is given by $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$.\nUsing the provided values $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$ and $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$:\n$$A = (+30\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 30\\,\\mathrm{mV} + 85\\,\\mathrm{mV} = 115\\,\\mathrm{mV}$$\nIf the condition for a triggered beat had not been met (i.e., if $|q_{\\mathrm{NCX}}|  q_{\\mathrm{th}}$), the amplitude would have been the subthreshold depolarization $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_m = (0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2})/(1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) = 24\\,\\mathrm{mV}$. However, since the threshold was exceeded, the regenerative action potential is triggered, and its amplitude is determined by the peak and resting potentials.\n\nThe final computed amplitude is $115\\,\\mathrm{mV}$.",
            "answer": "$$\\boxed{115}$$"
        },
        {
            "introduction": "Successful propagation of the heart's electrical wave is not guaranteed, especially in structurally complex or diseased tissue. This practice  challenges you to model the \"source-sink\" balance that governs whether a wavefront successfully navigates a geometric bottleneck or is extinguished. This exercise is key to understanding how anatomical features can create the conditions for conduction block, a crucial ingredient for reentrant arrhythmias.",
            "id": "3905454",
            "problem": "A two-dimensional cardiac tissue slab of thickness $t$ is connected upstream to a cylindrical isthmus of radius $a$ and length $L$ through which an action potential wavefront propagates at constant speed $c$ into the slab. The tissue is described by the monodomain model with isotropic bulk conductivity $\\sigma$ (units S/m), membrane capacitance per unit area $C_{m}$ (units F/m$^{2}$), and membrane surface-to-volume ratio $\\chi$ (units m$^{-1}$). Assume during the rapid depolarization (upstroke) phase, the ionic current density is dominated by fast inward current that acts as a trigger, while the diffusive source–sink balance governs whether propagation succeeds across geometric heterogeneities. You may model the depolarization requirement downstream of the isthmus as the need to raise the transmembrane potential by $\\Delta V$ over a characteristic downstream volume $V_{\\text{down}}$ during the upstroke, and the source as the diffusive axial current delivered through the isthmus during the same time interval. The slab is wide relative to the isthmus, so upon exit the wavefront diverges in-plane; approximate the downstream volume that must be brought near threshold as a semicircular disk of radius $\\lambda$ (the electrotonic reach) extruded through the thickness $t$, so that $V_{\\text{down}} = \\tfrac{1}{2}\\pi \\lambda^{2} t$. The isthmus cross-section is $A_{i} = \\pi a^{2}$.\n\nStarting only from the monodomain equation, the definition of membrane capacitance and surface-to-volume ratio, conservation of charge, Ohm’s law for the intracellular medium, and the kinematics of a steadily propagating wavefront, derive the condition for successful downstream propagation by equating the diffusive source charge delivered through the isthmus during the upstroke to the capacitive charge required to depolarize the downstream volume. From this, obtain an explicit expression for the minimum isthmus diameter $D^{\\ast} = 2a^{\\ast}$ required for propagation into the slab.\n\nUse the following physiologically plausible parameter values: $\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, and $\\lambda = 1.0 \\times 10^{-3}$ m. Express the final $D^{\\ast}$ in millimeters, and round your answer to three significant figures. Explain qualitatively why this criterion predicts block in narrow isthmuses and successful propagation in wide bundles by referring to the dependence on tissue thickness and geometric divergence.",
            "solution": "The starting point is the monodomain equation\n$$\n\\chi C_{m} \\frac{\\partial V}{\\partial t} \\;=\\; \\nabla \\cdot \\left( \\sigma \\nabla V \\right) \\;-\\; I_{\\text{ion}},\n$$\nwhere $\\chi$ is the membrane surface-to-volume ratio, $C_{m}$ is the membrane capacitance per unit area, $\\sigma$ is the bulk conductivity, $V$ is the transmembrane potential, and $I_{\\text{ion}}$ is the ionic current density per unit volume. During the rapid upstroke, the success of propagation across a geometric bottleneck is governed by a source–sink balance: the source is the diffusive axial current that can be delivered through the isthmus, and the sink is the capacitive demand of the downstream tissue volume that must be charged toward threshold.\n\nThe capacitive charge required to raise a downstream volume $V_{\\text{down}}$ by a potential increment $\\Delta V$ is given by\n$$\nQ_{\\text{req}} \\;=\\; \\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V,\n$$\nbecause $\\chi C_{m}$ is the membrane capacitance per unit volume and $\\Delta V$ is the voltage increment.\n\nOn the source side, the axial diffusive current density along the isthmus is given by Ohm’s law:\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\,\\frac{\\partial V}{\\partial x}.\n$$\nFor a steadily propagating wavefront traveling with speed $c$ in the $+x$ direction, the kinematic relation for traveling waves $V(x,t) = \\hat{V}(x - ct)$ implies\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; -\\,c\\,\\frac{\\partial V}{\\partial x}\n\\quad\\Longrightarrow\\quad\n\\frac{\\partial V}{\\partial x} \\;=\\; -\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\nTherefore, the axial current density becomes\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\left(-\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}\\right)\n\\;=\\; \\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\nThe total axial current through the isthmus cross-section $A_{i}$ is\n$$\nI_{\\text{src}} \\;=\\; A_{i}\\,J_{x} \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\nIntegrating over the upstroke time interval (during which the potential rises by $\\Delta V$) gives the total delivered charge:\n$$\nQ_{\\text{del}} \\;=\\; \\int I_{\\text{src}}\\,dt \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\int \\frac{\\partial V}{\\partial t}\\,dt\n\\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\Delta V.\n$$\nThe safety factor for propagation into the downstream volume is the ratio\n$$\n\\text{SF} \\;=\\; \\frac{Q_{\\text{del}}}{Q_{\\text{req}}}\n\\;=\\; \\frac{A_{i}\\,\\dfrac{\\sigma}{c}\\,\\Delta V}{\\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V}\n\\;=\\; \\frac{\\sigma\\,A_{i}}{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}.\n$$\nA minimal requirement for successful propagation is $\\text{SF} \\geq 1$, which yields the critical cross-sectional area\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\sigma}.\n$$\nFor a cylindrical isthmus of radius $a$, $A_{i} = \\pi a^{2}$, so the critical radius is\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}},\n$$\nand the critical diameter is\n$$\nD^{\\ast} \\;=\\; 2a^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}}.\n$$\n\nFor the given geometry, the downstream volume is approximated as a semicircular disk of radius $\\lambda$ extruded through thickness $t$:\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t.\n$$\nSubstituting this into the expression for $D^{\\ast}$ gives\n$$\nD^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}}{\\pi\\,\\sigma}\\,\\left(\\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t\\right)}\n\\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,\\lambda^{2}\\,t}{2\\,\\sigma}}.\n$$\n\nNow substitute the numerical values (keeping symbolic reasoning until the final step): $\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, $\\lambda = 1.0 \\times 10^{-3}$ m.\n\nFirst compute $V_{\\text{down}}$:\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-3})^{2}\\,(1.5 \\times 10^{-3})\n\\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-6})\\,(1.5 \\times 10^{-3})\n\\;=\\; 0.75\\,\\pi \\times 10^{-9}\\ \\text{m}^{3}.\n$$\nCompute $A_{i}^{\\ast}$:\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{5})\\,(1.0 \\times 10^{-2})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{3})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{420\\,\\pi \\times 10^{-9}}{0.20}\n\\;=\\; 6.59734 \\times 10^{-6}\\ \\text{m}^{2},\n$$\nwhere the intermediate simplification used $(0.40)\\times(1.4 \\times 10^{3})\\times 0.75 = 420$. The critical radius is\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{6.59734 \\times 10^{-6}}{\\pi}}\n\\;=\\; \\sqrt{2.10000 \\times 10^{-6}}\\ \\text{m}\n\\;=\\; 1.449 \\times 10^{-3}\\ \\text{m},\n$$\nso the critical diameter is\n$$\nD^{\\ast} \\;=\\; 2\\,a^{\\ast} \\;=\\; 2.898 \\times 10^{-3}\\ \\text{m} \\;=\\; 2.898\\ \\text{mm}.\n$$\nRounded to three significant figures, this yields $2.90$ mm.\n\nQualitative interpretation: The critical diameter scales as $D^{\\ast} \\propto \\sqrt{\\lambda^{2} t}$ and increases with thickness $t$ and electrotonic reach $\\lambda$, both of which enlarge the downstream capacitive sink. It decreases with higher conductivity $\\sigma$ and increases with wave speed $c$ and $\\chi C_{m}$, reflecting the source strength and capacitive demand, respectively. Narrow isthmuses (small $D$) supply insufficient diffusive charge to depolarize the large divergent volume in the wide slab, predicting block. In contrast, within wide bundles where the wavefront remains less divergent and the effective $V_{\\text{down}}$ is closer to a column $A_{\\text{bundle}}\\lambda$ (smaller than the semicircular disk), the sink is reduced and the same source suffices, predicting successful propagation.",
            "answer": "$$\\boxed{2.90}$$"
        },
        {
            "introduction": "When conduction block and slow propagation combine, they can give rise to a reentrant circuit, the engine behind many dangerous arrhythmias. This problem  guides you through the development of a kinematic model for a spiral wave rotor, a form of reentry. You will determine a rotor's properties by balancing the wave's travel time with the tissue's refractory period, providing a quantitative look at the dynamics of a self-sustaining arrhythmia.",
            "id": "3905471",
            "problem": "You are asked to design and implement a program that computes the rotation period and core geometry of a spiral wave (rotor) in cardiac tissue by balancing the path length around the core with the local wavefront speed, and to analyze how the Effective Refractory Period (ERP) and conduction anisotropy modulate the core size and rotor frequency. The context is homogeneous two-dimensional excitable tissue governed by reaction-diffusion dynamics, where the excitable medium supports spiral waves. The derivation must start from fundamental principles appropriate for Biomedical Systems Modeling and heart electrophysiology.\n\nFundamental base and assumptions to use:\n- Begin from the interpretation of wavefront propagation in excitable tissue as a front with local normal speed that depends on tissue properties. In spatially homogeneous tissue with conduction anisotropy, the local conduction speed depends on direction due to the anisotropic diffusion tensor. Let the principal fiber direction be the longitudinal axis with speed $v_{\\ell}$ and the transverse direction have speed $v_{t}$.\n- The Effective Refractory Period (ERP) is the minimal time $T_{\\min}$ necessary for tissue to recover excitability after activation. For sustained reentry, the total travel time $T$ around the core must satisfy $T \\ge \\text{ERP}$. At the marginal (balanced) case of sustained rotation, the equality $T = \\text{ERP}$ is enforced.\n- The rotor core in an anisotropic medium forms an approximately elliptical trajectory due to directional dependence of speed. In this problem, model the core trajectory as an ellipse with semiaxes $a$ (aligned with the longitudinal direction) and $b$ (aligned with the transverse direction), and assume the aspect ratio is set by the ratio of conduction speeds, i.e., $a/b = r$ where $r = v_{\\ell}/v_{t}$. Let $s$ be a scalar scale factor such that $a = r s$ and $b = s$.\n- The rotation period $T$ equals the integral of the local path length element divided by the local tangential conduction speed along the path: \n$$\nT = \\int_{0}^{2\\pi} \\frac{ds(\\theta)}{v(\\phi(\\theta))}.\n$$\nHere $\\theta$ parametrizes the ellipse, $ds(\\theta)$ is the differential arc length, and $v(\\phi(\\theta))$ is the local conduction speed along the tangent direction at angle $\\phi(\\theta)$ relative to the longitudinal axis.\n- The arc length element for the ellipse parametrized by $x(\\theta) = a \\cos\\theta$, $y(\\theta) = b \\sin\\theta$ is \n$$\nds(\\theta) = \\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}\\, d\\theta = s \\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}\\, d\\theta.\n$$\n- In an anisotropic medium with principal conduction speeds $v_{\\ell}$ and $v_{t}$, the direction-dependent speed $v(\\phi)$ along a unit vector at angle $\\phi$ to the longitudinal axis is modeled by the diagonal metric relation\n$$\n\\frac{1}{v(\\phi)^{2}} = \\frac{\\cos^{2}\\phi}{v_{\\ell}^{2}} + \\frac{\\sin^{2}\\phi}{v_{t}^{2}},\n$$\nwhich is consistent with propagation in anisotropic media where speed depends on the projection onto principal axes. The unit tangent direction of the ellipse is\n$$\n\\hat{\\mathbf{t}}(\\theta) = \\frac{(-a\\sin\\theta,\\; b\\cos\\theta)}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}},\n$$\nso $\\cos\\phi(\\theta) = \\hat{t}_{x}(\\theta)$ and $\\sin\\phi(\\theta) = \\hat{t}_{y}(\\theta)$.\n\nTasks:\n1. Derive the expression for the total rotation time $T(s)$ in terms of the integral\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))}\\, d\\theta,\n$$\nwhere $r = v_{\\ell}/v_{t}$ and $a = r s$, $b = s$. Show that $T(s)$ is linear in $s$.\n2. Impose the marginal reentry balance condition $T(s^{\\star}) = \\text{ERP}$ and solve for the scale $s^{\\star}$, then compute the semiaxes $a^{\\star} = r s^{\\star}$ and $b^{\\star} = s^{\\star}$.\n3. Report the rotation period $T$ in seconds, the rotor frequency $f = 1/T$ in hertz, and the core semiaxes $a$ and $b$ in meters for each test case.\n\nPhysical units:\n- Conduction speeds $v_{\\ell}$ and $v_{t}$ must be provided in meters per second (m/s).\n- Effective Refractory Period $\\text{ERP}$ must be provided in seconds (s).\n- Semiaxes $a$ and $b$ must be reported in meters (m).\n- Rotor period $T$ must be reported in seconds (s), and rotor frequency $f$ must be reported in hertz (Hz).\n\nAngle unit:\n- All angular quantities (e.g., the parameter $\\theta$) are in radians.\n\nAnswer specification and numerical requirements:\n- Use numerical quadrature to evaluate the integral defining $T(s)$; any consistent Riemann-sum based method is acceptable.\n- Express each reported float rounded to six decimal places.\n- For each test case, output four floats in the order $[T, f, a, b]$.\n\nTest suite:\n- Case 1 (isotropic baseline): $v_{\\ell} = 0.6$ m/s, $v_{t} = 0.6$ m/s, $\\text{ERP} = 0.25$ s.\n- Case 2 (moderate anisotropy): $v_{\\ell} = 0.8$ m/s, $v_{t} = 0.4$ m/s, $\\text{ERP} = 0.25$ s.\n- Case 3 (short refractory period): $v_{\\ell} = 0.6$ m/s, $v_{t} = 0.3$ m/s, $\\text{ERP} = 0.12$ s.\n- Case 4 (strong anisotropy): $v_{\\ell} = 1.0$ m/s, $v_{t} = 0.2$ m/s, $\\text{ERP} = 0.30$ s.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of all floats for the four test cases, flattened in case order, rounded to six decimals, enclosed in square brackets. For example, the format is $[T_{1}, f_{1}, a_{1}, b_{1}, T_{2}, f_{2}, a_{2}, b_{2}, T_{3}, f_{3}, a_{3}, b_{3}, T_{4}, f_{4}, a_{4}, b_{4}]$.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of cardiac electrophysiology and reaction-diffusion systems, is mathematically well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe problem asks for the derivation and computation of the properties of a spiral wave rotor in a two-dimensional anisotropic excitable medium. The solution proceeds by first deriving the analytical expression for the rotation period $T$, then using the given balancing condition to determine the geometry of the rotor core, and finally applying these results to the specified test cases.\n\n### Step 1: Derivation of the Rotor Period $T(s)$\n\nThe starting point is the general formula for the travel time $T$ around a closed path, which is the integral of the differential arc length $ds$ divided by the local propagation speed $v$:\n$$\nT = \\oint \\frac{ds}{v}\n$$\nThe problem provides a parameterization for an elliptical core trajectory and the associated expressions for the arc length element $ds(\\theta)$ and the direction-dependent speed $v(\\phi(\\theta))$. The rotor period $T$ as a function of the scaling parameter $s$ is given by:\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))}\\, d\\theta\n$$\nwhere $r = v_{\\ell}/v_{t}$ is the anisotropy ratio, $v_{\\ell}$ and $v_{t}$ are the longitudinal and transverse conduction speeds, and $\\theta$ is the elliptic angle parameter. Our first task is to evaluate the integrand.\n\nThe local conduction speed $v(\\phi)$ at an angle $\\phi$ to the longitudinal axis is given by the relation:\n$$\n\\frac{1}{v(\\phi)^{2}} = \\frac{\\cos^{2}\\phi}{v_{\\ell}^{2}} + \\frac{\\sin^{2}\\phi}{v_{t}^{2}}\n$$\nThe angle $\\phi(\\theta)$ corresponds to the direction of the tangent vector to the ellipse at parameter $\\theta$. The elliptical path is $(x(\\theta), y(\\theta)) = (a\\cos\\theta, b\\sin\\theta)$, where $a=rs$ and $b=s$. The un-normalized tangent vector is $(x'(\\theta), y'(\\theta)) = (-a\\sin\\theta, b\\cos\\theta)$. The unit tangent vector $\\hat{\\mathbf{t}}(\\theta)$ provides the components $\\cos\\phi(\\theta)$ and $\\sin\\phi(\\theta)$:\n$$\n\\cos\\phi(\\theta) = \\frac{-a\\sin\\theta}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}}\n$$\n$$\n\\sin\\phi(\\theta) = \\frac{b\\cos\\theta}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}}\n$$\nSubstituting these into the expression for $1/v(\\phi)^2$:\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{1}{v_{\\ell}^{2}} \\left( \\frac{a^{2}\\sin^{2}\\theta}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta} \\right) + \\frac{1}{v_{t}^{2}} \\left( \\frac{b^{2}\\cos^{2}\\theta}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta} \\right)\n$$\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{a^{2}\\sin^{2}\\theta/v_{\\ell}^{2} + b^{2}\\cos^{2}\\theta/v_{t}^{2}}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}\n$$\nNow, we substitute $a = rs$, $b = s$, and $v_{t} = v_{\\ell}/r$:\n$$\n\\frac{a^{2}}{v_{\\ell}^{2}} = \\frac{(rs)^{2}}{v_{\\ell}^{2}} = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\n$$\n$$\n\\frac{b^{2}}{v_{t}^{2}} = \\frac{s^{2}}{(v_{\\ell}/r)^{2}} = \\frac{s^{2}r^{2}}{v_{\\ell}^{2}}\n$$\nThe numerator of the expression for $1/v(\\phi(\\theta))^2$ becomes:\n$$\n\\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\\sin^{2}\\theta + \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\\cos^{2}\\theta = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}(\\sin^{2}\\theta + \\cos^{2}\\theta) = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\n$$\nThe denominator is:\n$$\na^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta = (rs)^{2}\\sin^{2}\\theta + s^{2}\\cos^{2}\\theta = s^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)\n$$\nCombining these, we get:\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{r^{2}s^{2}/v_{\\ell}^{2}}{s^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)} = \\frac{r^{2}}{v_{\\ell}^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)}\n$$\nTaking the square root gives the expression for the inverse speed:\n$$\n\\frac{1}{v(\\phi(\\theta))} = \\frac{r}{v_{\\ell}\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}\n$$\nNow, we can evaluate the integrand of $T(s)$. The integrand is the product of this term and the term from the arc length definition:\n$$\n\\text{Integrand} = \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))} = \\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta} \\cdot \\left( \\frac{r}{v_{\\ell}\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}} \\right) = \\frac{r}{v_{\\ell}}\n$$\nThe integrand simplifies to a constant. This elegant result demonstrates that the geometric complexity of the arc length is perfectly balanced by the geometric dependence of the propagation speed for this specific elliptical path. The requirement for numerical quadrature mentioned in the problem is therefore obviated by this analytical simplification.\n\nThe integral for the period $T(s)$ becomes:\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{r}{v_{\\ell}} \\, d\\theta = s \\frac{r}{v_{\\ell}} [\\theta]_{0}^{2\\pi} = s \\frac{2\\pi r}{v_{\\ell}}\n$$\nThis expression demonstrates that $T(s)$ is indeed linear in the scale factor $s$, with a constant of proportionality $K = 2\\pi r / v_{\\ell}$.\n\n### Step 2: Solving for Core Geometry\nThe problem states that for a sustained rotor at the margin of stability, the rotation period must equal the Effective Refractory Period (ERP):\n$$\nT(s^{\\star}) = \\text{ERP}\n$$\nwhere $s^{\\star}$ is the specific scale factor that satisfies this condition.\n$$\ns^{\\star} \\frac{2\\pi r}{v_{\\ell}} = \\text{ERP}\n$$\nSolving for $s^{\\star}$:\n$$\ns^{\\star} = \\text{ERP} \\cdot \\frac{v_{\\ell}}{2\\pi r}\n$$\nSubstituting $r = v_{\\ell}/v_t$:\n$$\ns^{\\star} = \\text{ERP} \\cdot \\frac{v_{\\ell}}{2\\pi (v_{\\ell}/v_t)} = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n$$\nThis gives the scale factor $s^{\\star}$. The semiaxes of the elliptical core, $a^{\\star}$ and $b^{\\star}$, can now be determined:\nThe semi-minor axis is:\n$$\nb^{\\star} = s^{\\star} = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n$$\nThe semi-major axis is:\n$$\na^{\\star} = r s^{\\star} = \\frac{v_{\\ell}}{v_{t}} \\cdot \\left( \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi} \\right) = \\frac{\\text{ERP} \\cdot v_{\\ell}}{2\\pi}\n$$\n\n### Step 3: Calculation for Test Cases\nFor each test case, we are given $v_{\\ell}$, $v_{t}$, and $\\text{ERP}$. We can now compute the required quantities.\n1.  **Rotation Period ($T$)**: By the marginal stability condition, the period is simply the ERP.  $T = \\text{ERP}$.\n2.  **Rotor Frequency ($f$)**: The frequency is the reciprocal of the period. $f = 1/T = 1/\\text{ERP}$.\n3.  **Core Semiaxes ($a, b$)**: The semiaxes are calculated using the derived formulae:\n    $$\n    a = \\frac{\\text{ERP} \\cdot v_{\\ell}}{2\\pi}\n    $$\n    $$\n    b = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n    $$\nThese formulae will be implemented to compute the results for the provided test suite. All numerical results will be rounded to six decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for spiral wave rotor properties based on a kinematic model in anisotropic tissue.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (v_l, v_t, ERP)\n    # v_l: longitudinal velocity (m/s)\n    # v_t: transverse velocity (m/s)\n    # ERP: effective refractory period (s)\n    test_cases = [\n        (0.6, 0.6, 0.25),  # Case 1 (isotropic baseline)\n        (0.8, 0.4, 0.25),  # Case 2 (moderate anisotropy)\n        (0.6, 0.3, 0.12),  # Case 3 (short refractory period)\n        (1.0, 0.2, 0.30),  # Case 4 (strong anisotropy)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        v_l, v_t, erp = case\n        \n        # 1. Calculate the rotation period T and frequency f.\n        # At the marginal stability condition for sustained reentry, the rotation period\n        # T is equal to the Effective Refractory Period (ERP).\n        # T is in seconds (s).\n        T = erp\n        \n        # The frequency f is the reciprocal of the period T.\n        # f is in hertz (Hz).\n        f = 1.0 / T\n        \n        # 2. Calculate the core semiaxes a and b.\n        # The derivation shows that the semiaxes are given by:\n        # a = (ERP * v_l) / (2 * pi)\n        # b = (ERP * v_t) / (2 * pi)\n        # a and b are in meters (m).\n        \n        a = (erp * v_l) / (2 * np.pi)\n        b = (erp * v_t) / (2 * np.pi)\n        \n        # 3. Round results to six decimal places as required.\n        T_rounded = round(T, 6)\n        f_rounded = round(f, 6)\n        a_rounded = round(a, 6)\n        b_rounded = round(b, 6)\n        \n        # Append the four calculated values for the current case to the results list.\n        results.extend([T_rounded, f_rounded, a_rounded, b_rounded])\n\n    # Final print statement in the exact required format.\n    # Example format: [T1,f1,a1,b1,T2,f2,a2,b2,...]\n    # The map(str, ...) converts each float to a string for joining.\n    # The \"g\" format specifier is used to avoid trailing zeros for whole numbers like 4.0\n    # but the problem asks for floats, so a direct str() conversion of the rounded\n    # floats is appropriate. Let's ensure format consistency. The requirement to\n    # round to 6 places implies a fixed-point representation might be desired.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}