{
    "hands_on_practices": [
        {
            "introduction": "在设计任何状态估计器（如卡尔曼滤波器）之前，我们必须首先回答一个基本问题：我们想要估计的系统状态是否能被我们的测量所“看见”？这个概念被称为“能观性”，它决定了状态估计是否从根本上可行。本练习  将引导你通过一个生物医学药代动力学模型，应用标准的能观性判据来评估系统，并理解其对卡尔曼滤波性能的深远影响。",
            "id": "3895442",
            "problem": "一个双室生物医学药代动力学模型描述了示踪剂在血浆和外周组织室之间分布的动态过程。在连续时间下，状态向量为 $x(t) = \\begin{bmatrix}x_{1}(t) \\\\ x_{2}(t)\\end{bmatrix}$，其中 $x_{1}(t)$ 是血浆浓度，$x_{2}(t)$ 是组织浓度。动态和测量被建模为一个线性时不变随机系统：\n$$\n\\frac{d x(t)}{d t} = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),\n$$\n其中 $w(t)$ 是协方差为 $Q$ 的零均值高斯白过程噪声，$v(t)$ 是协方差为 $R$ 的零均值高斯白测量噪声。这种设置是卡尔曼滤波器 (KF) 的标准配置，并作为用于非线性生物医学系统的扩展卡尔曼滤波器 (EKF) 和无迹卡尔曼滤波器 (UKF) 的线性极限情况。\n\n给定\n$$\nA = \\begin{bmatrix} -0.1 & 0 \\\\ 0 & -0.05 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad Q = \\mathrm{diag}\\!\\big(10^{-4},\\,10^{-5}\\big), \\quad R = 10^{-3}.\n$$\n\n从线性时不变系统的可观测性形式化定义出发，构建一个合适的准则来判断矩阵对 $(A, C)$ 是否可观测。计算相应的可观测性矩阵的秩，并用它来断定系统是否可观测。然后，将此结论与有限时域可观测性格拉姆矩阵的性质以及其在生物医学建模中对卡尔曼滤波的影响联系起来。将可观测性矩阵的秩作为最终答案报告。最终答案无需四舍五入，也不应包含单位。",
            "solution": "该问题要求分析一个给定的线性时不变 (LTI) 生物医学系统的可观测性。问题陈述的验证已确认其具有科学依据、问题适定且客观。我们现在可以进行求解。\n\n该系统由状态空间方程描述：\n$$\n\\frac{d x(t)}{d t} = A x(t) + w(t), \\quad y(t) = C x(t) + v(t)\n$$\n状态向量 $x(t) \\in \\mathbb{R}^n$，其中状态空间的维度为 $n=2$。给定的系统矩阵为：\n$$\nA = \\begin{bmatrix} -0.1 & 0 \\\\ 0 & -0.05 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}\n$$\n$w(t)$ 和 $v(t)$ 分别代表过程噪声和测量噪声，它们的协方差 $Q$ 和 $R$ 与卡尔曼滤波器的设计相关，但与可观测性这一基本属性无关，可观测性仅由矩阵对 $(A, C)$ 决定。\n\n一个连续时间 LTI 系统被定义为可观测的，如果对于任意初始状态 $x(t_0)$，存在一个有限时间 $t_1 > t_0$，使得在区间 $[t_0, t_1]$ 上的系统输出 $y(t)$ 的知识足以唯一确定初始状态 $x(t_0)$。对于时不变系统，这等价于从区间 $[0, t_f]$ 上的 $y(t)$ 确定 $x(0)$。\n\n可观测性的标准代数判据是卡尔曼秩条件。一个状态维度为 $n$ 的系统是可观测的，当且仅当其可观测性矩阵（记为 $\\mathcal{O}$）满秩，即 $\\mathrm{rank}(\\mathcal{O}) = n$。\n\n对于一个 $n$ 维系统，其可观测性矩阵构造如下：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix}\n$$\n对于给定系统，状态维度为 $n=2$。因此，可观测性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}\n$$\n我们继续计算该矩阵的块分量。矩阵 $C$ 给定为 $\\begin{bmatrix} 1 & 0 \\end{bmatrix}$。乘积 $CA$ 计算如下：\n$$\nCA = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} -0.1 & 0 \\\\ 0 & -0.05 \\end{bmatrix} = \\begin{bmatrix} (1)(-0.1) + (0)(0) & (1)(0) + (0)(-0.05) \\end{bmatrix} = \\begin{bmatrix} -0.1 & 0 \\end{bmatrix}\n$$\n现在，我们组装可观测性矩阵 $\\mathcal{O}$：\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ -0.1 & 0 \\end{bmatrix}\n$$\n为了判断系统是否可观测，我们必须计算这个 $2 \\times 2$ 矩阵的秩。一个矩阵的秩是由其列（或行）向量张成的向量空间的维度，等价于线性无关的列（或行）的数量。\n\n$\\mathcal{O}$ 的列向量是 $\\begin{bmatrix} 1 \\\\ -0.1 \\end{bmatrix}$ 和 $\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。由于第二列是零向量，它与第一列线性相关。第一列是非零向量。因此，列空间由单个向量张成，秩为 $1$。\n或者，看行向量，第一行是 $\\begin{bmatrix} 1 & 0 \\end{bmatrix}$，第二行是 $\\begin{bmatrix} -0.1 & 0 \\end{bmatrix}$。第二行只是第一行的 $-0.1$ 倍，所以这两行是线性相关的。因此秩小于 $2$。由于该矩阵不是零矩阵，其秩为 $1$。\n第三种方法是计算 $\\mathcal{O}$ 的行列式。一个方阵满秩当且仅当其行列式不为零。\n$$\n\\det(\\mathcal{O}) = (1)(0) - (0)(-0.1) = 0\n$$\n由于行列式为零，该矩阵是奇异的，不是满秩。$\\mathcal{O}$ 的秩为 $1$。\n\n状态空间的维度是 $n=2$，但我们发现 $\\mathrm{rank}(\\mathcal{O}) < n$，该系统**不可观测**。\n\n这个结论具有重要意义。状态 $x_1(t)$ 代表血浆浓度，$x_2(t)$ 代表组织浓度。测量值为 $y(t) = C x(t) = x_1(t)$，这意味着只测量了血浆浓度。系统动力学矩阵 $A$ 是对角矩阵，这意味着两个状态是解耦的：\n$$\n\\frac{dx_1}{dt} = -0.1 x_1(t)\n$$\n$$\n\\frac{dx_2}{dt} = -0.05 x_2(t)\n$$\n组织浓度 $x_2(t)$ 的演化对血浆浓度 $x_1(t)$ 的演化没有影响。由于我们只测量 $x_1(t)$，因此无法从输出 $y(t)$ 中推断出任何关于状态 $x_2(t)$ 的信息。状态 $x_2$ 是不可观测的。\n\n这种不可观测性与有限时域可观测性格拉姆矩阵的性质直接相关，其定义为 $W_o(t) = \\int_0^t e^{A^\\top \\tau} C^\\top C e^{A\\tau} d\\tau$。一个系统是可观测的，当且仅当对于任意 $t>0$，$W_o(t)$ 是正定的（因此是可逆的）。对于一个不可观测的系统，$W_o(t)$ 对所有 $t$ 都是奇异的。可观测性矩阵 $\\mathcal{O}$ 的零空间定义了不可观测子空间。任何位于此子空间中的初始状态 $x(0)$ 都会产生对所有 $t \\ge 0$ 均为 $y(t) = 0$ 的输出，使其无法与零状态区分开来。在这种情况下，不可观测子空间由向量 $\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 张成，对应于状态 $x_2$。\n\n对于卡尔曼滤波 (KF) 及其非线性扩展 (EKF, UKF)，可观测性对状态估计至关重要。如果一个系统是不可观测的，滤波器将无法从测量中估计出不可观测的状态。与状态估计相关的误差协方差矩阵 $P(t)$，即使在没有噪声的情况下，其对应于不可观测状态分量的部分也不会收敛到零。对于这个问题，卡尔曼滤波器可以有效地估计 $x_1$，但其对 $x_2$ 的估计本质上将是对模型动力学 $\\dot{\\hat{x}}_2 = -0.05 \\hat{x}_2 + \\dots$ 的纯粹模拟，而没有任何来自测量的校正反馈。$x_2$ 的估计误差的方差不会因测量更新而减小。在生物医学背景下，这表明实验设置（即测量的选择）在根本上不足以确定模型的所有内部状态。\n\n具体问题要求的是可观测性矩阵的秩。如上计算，秩为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "能观性保证了状态估计的可行性，而卡尔曼滤波器的核心在于其预测-校正循环。本练习  将聚焦于“校正”或“测量更新”步骤，这是滤波器融合新信息、降低不确定性的关键。通过一个简化的生理状态监测场景，你将亲手计算卡尔曼增益和后验协方差，从而深入理解贝叶斯更新在线性高斯系统中的具体实现。",
            "id": "3895426",
            "problem": "一种可穿戴生物医学传感器用于监测两种潜在的生理状态，该系统被建模为一个离散时间线性高斯系统。潜在状态向量为 $x_{k} \\in \\mathbb{R}^{2}$，并由一个稳定的时不变线性动力学矩阵 $A=\\begin{bmatrix}0.9 & 0 \\\\ 0 & 0.8\\end{bmatrix}$ 控制。过程噪声 $w_{k}$ 是零均值高斯噪声，其协方差为 $Q=0.01\\,I$，其中 $I$ 表示大小为 $2 \\times 2$ 的单位矩阵。传感器产生一个标量测量值 $y_{k}$，该值通过测量矩阵 $C=\\begin{bmatrix}1 & 1\\end{bmatrix}$ 线性聚合了这两个状态。测量噪声 $v_{k}$ 是零均值高斯噪声，其方差为 $R=0.02$。\n\n假设在时刻 $k$ 进行一次测量更新，其先验（预测）协方差为 $P_{k|k-1}=I$，这与线性高斯模型的预测步骤一致。在给定模型下，利用多元高斯分布中的条件化基本原理以及线性高斯系统的相关贝叶斯更新，计算卡尔曼滤波器（KF）的单步测量更新量，即卡尔曼增益 $K_{k}$ 和后验协方差 $P_{k|k}$。\n\n就本问题而言，你可以注意到，对于线性系统，当测量和动力学是线性时，扩展卡尔曼滤波器（EKF）和无迹卡尔曼滤波器（UKF）会简化为KF更新，因此在所述的线性高斯假设下，计算出的 $K_{k}$ 和 $P_{k|k}$ 对这三种滤波器在本次单步更新中都适用。将你的最终答案表示为一个单行向量，按以下顺序包含六个条目：\n$$\\big[\\,K_{k}^{(1)},\\;K_{k}^{(2)},\\;P_{k|k}^{(1,1)},\\;P_{k|k}^{(1,2)},\\;P_{k|k}^{(2,1)},\\;P_{k|k}^{(2,2)}\\,\\big],$$\n其中 $K_{k}^{(i)}$ 是卡尔曼增益的第 $i$ 个分量，$P_{k|k}^{(i,j)}$ 是后验协方差的第 $(i,j)$ 个元素。将所有量表示为精确值；无需四舍五入。",
            "solution": "问题陈述需经过验证。\n\n### 步骤 1：提取已知条件\n-   潜在状态向量：$x_{k} \\in \\mathbb{R}^{2}$\n-   系统动力学矩阵：$A=\\begin{bmatrix}0.9 & 0 \\\\ 0 & 0.8\\end{bmatrix}$\n-   过程噪声协方差：$Q=0.01\\,I$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n-   测量值：标量 $y_{k}$\n-   测量矩阵：$C=\\begin{bmatrix}1 & 1\\end{bmatrix}$\n-   测量噪声方差：$R=0.02$\n-   时刻 $k$ 的先验状态协方差：$P_{k|k-1}=I$\n-   要求解的量：卡尔曼增益 $K_{k}$ 和后验协方差 $P_{k|k}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n-   **科学依据**：该问题描述了一个离散时间线性高斯状态空间模型，这是估计理论和控制系统中的一个基本概念。卡尔曼滤波器是此类系统的最优线性估计器。该问题基于成熟的数学原理。\n-   **适定性**：计算测量更新所需的所有必要参数（$C$、$R$、$P_{k|k-1}$）均已提供。所有矩阵和向量的维度一致。存在唯一且稳定的解。\n-   **客观性**：问题使用精确的数学语言陈述，没有任何主观或模糊的术语。\n-   **完整性与一致性**：问题为所要求的任务提供了完整的信息集。所提供的值与模型结构一致。关于 $A$ 和 $Q$ 的信息虽然是完整系统模型的一部分，但对于本问题关注的测量更新步骤而言并非必需。这不构成不一致，而是一个范围明确的问题。\n-   **不切实际或不可行**：模型参数的数值是合理的，不代表任何物理或数学上的不可能性。\n-   **伪深刻、琐碎或同义反复**：该问题是卡尔曼滤波器方程的标准应用。它要求正确应用矩阵代数并理解贝叶斯更新机制，因此并非琐碎问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**，因为它具有科学依据、适定且内部一致。将推导解答。\n\n卡尔曼滤波器测量更新方程用于从先验状态协方差 $P_{k|k-1}$ 计算卡尔曼增益 $K_k$ 和后验状态协方差 $P_{k|k}$。相关方程如下：\n$$S_{k} = C P_{k|k-1} C^{T} + R$$\n$$K_{k} = P_{k|k-1} C^{T} S_{k}^{-1}$$\n$$P_{k|k} = (I - K_{k} C) P_{k|k-1}$$\n其中 $S_k$ 是新息（或残差）协方差。\n\n给定数量为：\n$$P_{k|k-1} = I = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$$\n$$C = \\begin{bmatrix} 1 & 1 \\end{bmatrix}$$\n$$R = 0.02 = \\frac{2}{100} = \\frac{1}{50}$$\n测量矩阵 $C$ 的转置是：\n$$C^{T} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$$\n\n首先，我们计算新息协方差 $S_k$。由于测量值 $y_k$ 是一个标量，所以 $S_k$ 也将是一个标量。\n$$S_{k} = \\begin{bmatrix} 1 & 1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} + \\frac{1}{50}$$\n$$S_{k} = \\begin{bmatrix} 1 & 1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} + \\frac{1}{50}$$\n$$S_{k} = (1 \\cdot 1 + 1 \\cdot 1) + \\frac{1}{50} = 2 + \\frac{1}{50} = \\frac{100}{50} + \\frac{1}{50} = \\frac{101}{50}$$\n标量 $S_k$ 的逆是：\n$$S_{k}^{-1} = \\frac{50}{101}$$\n\n接下来，我们计算卡尔曼增益 $K_k$。由于状态是二维的，测量是标量，因此增益 $K_k$ 将是一个 $2 \\times 1$ 的向量。\n$$K_{k} = P_{k|k-1} C^{T} S_{k}^{-1} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\frac{50}{101}$$\n$$K_{k} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\frac{50}{101} = \\begin{bmatrix} \\frac{50}{101} \\\\ \\frac{50}{101} \\end{bmatrix}$$\n卡尔曼增益的分量是 $K_{k}^{(1)} = \\frac{50}{101}$ 和 $K_{k}^{(2)} = \\frac{50}{101}$。\n\n最后，我们计算后验协方差矩阵 $P_{k|k}$。它将是一个 $2 \\times 2$ 的矩阵。\n$$P_{k|k} = (I - K_{k} C) P_{k|k-1}$$\n由于 $P_{k|k-1}=I$，表达式简化为 $P_{k|k} = I - K_{k} C$。\n首先，计算乘积 $K_k C$：\n$$K_{k} C = \\begin{bmatrix} \\frac{50}{101} \\\\ \\frac{50}{101} \\end{bmatrix} \\begin{bmatrix} 1 & 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{50}{101} & \\frac{50}{101} \\\\ \\frac{50}{101} & \\frac{50}{101} \\end{bmatrix}$$\n现在，从单位矩阵 $I$ 中减去这个结果：\n$$P_{k|k} = I - K_{k} C = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} \\frac{50}{101} & \\frac{50}{101} \\\\ \\frac{50}{101} & \\frac{50}{101} \\end{bmatrix}$$\n$$P_{k|k} = \\begin{bmatrix} 1 - \\frac{50}{101} & 0 - \\frac{50}{101} \\\\ 0 - \\frac{50}{101} & 1 - \\frac{50}{101} \\end{bmatrix} = \\begin{bmatrix} \\frac{101-50}{101} & -\\frac{50}{101} \\\\ -\\frac{50}{101} & \\frac{101-50}{101} \\end{bmatrix}$$\n$$P_{k|k} = \\begin{bmatrix} \\frac{51}{101} & -\\frac{50}{101} \\\\ -\\frac{50}{101} & \\frac{51}{101} \\end{bmatrix}$$\n后验协方差的分量是 $P_{k|k}^{(1,1)} = \\frac{51}{101}$，$P_{k|k}^{(1,2)} = -\\frac{50}{101}$，$P_{k|k}^{(2,1)} = -\\frac{50}{101}$，和 $P_{k|k}^{(2,2)} = \\frac{51}{101}$。\n\n最终答案要求一个按顺序包含六个指定条目的行向量：\n$\\big[\\,K_{k}^{(1)},\\;K_{k}^{(2)},\\;P_{k|k}^{(1,1)},\\;P_{k|k}^{(1,2)},\\;P_{k|k}^{(2,1)},\\;P_{k|k}^{(2,2)}\\,\\big]$\n代入计算出的值得到：\n$\\left[ \\frac{50}{101}, \\frac{50}{101}, \\frac{51}{101}, -\\frac{50}{101}, -\\frac{50}{101}, \\frac{51}{101} \\right]$。",
            "answer": "$$\\boxed{\\left[ \\frac{50}{101}, \\frac{50}{101}, \\frac{51}{101}, -\\frac{50}{101}, -\\frac{50}{101}, \\frac{51}{101} \\right]}$$"
        },
        {
            "introduction": "真实世界的生物医学系统往往是非线性的，这就需要扩展卡尔曼滤波器（EKF）等工具。本练习  将你置于一个更实际的糖尿病血糖监测情境中，虽然测量模型恰好是线性的，但它让你能够在一个复杂的增强状态空间中应用卡尔曼更新原理。你不仅要完成一次状态更新计算，还要思考过程噪声参数的调整如何影响滤波器的性能，这是滤波器设计与调试中的一个核心挑战。",
            "id": "3895433",
            "problem": "一名1型糖尿病患者由连续血糖监测仪（CGM）进行监测。您将血浆葡萄糖和一个集总的膳食扰动输入建模为一个增广状态。状态向量为 $x_k = \\begin{pmatrix} G_k \\\\ u_k \\end{pmatrix}$，其中 $G_k$ 是血浆葡萄糖浓度，单位为 $\\mathrm{mg}/\\mathrm{dL}$，$u_k$ 是有效膳食扰动，单位为 $\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min})$。过程模型遵循单室葡萄糖平衡和一阶膳食输入动态，\n$$\n\\begin{aligned}\nG_{k} = G_{k-1} + \\Delta t\\left[-\\frac{G_{k-1} - G_b}{\\tau} + S_u\\,u_{k-1}\\right] + w_{G,k-1},\\\\\nu_{k} = \\rho\\,u_{k-1} + w_{u,k-1},\n\\end{aligned}\n$$\n其中 $\\Delta t=5\\,\\mathrm{min}$，$G_b=100\\,\\mathrm{mg}/\\mathrm{dL}$，$\\tau=60\\,\\mathrm{min}$，$S_u=1\\,\\mathrm{min}^{-1}$，$\\rho=0.9$。过程噪声 $w_{k-1}=\\begin{pmatrix} w_{G,k-1} \\\\ w_{u,k-1}\\end{pmatrix}$ 是零均值高斯噪声，其协方差为 $Q=\\mathrm{diag}(q_G,q_u)$，其中 $q_G=1\\,\\mathrm{mg}^2/\\mathrm{dL}^2$，$q_u=0.25\\,\\mathrm{mg}^2/(\\mathrm{dL}^2\\cdot\\mathrm{min}^2)$。\n\n测量模型为 $y_k = h(x_k) + v_k$，其中 $h(x_k)=G_k$，传感器噪声 $v_k\\sim\\mathcal{N}(0,R)$，且 $R=5\\,\\mathrm{mg}^2/\\mathrm{dL}^2$。\n\n在特定的更新时刻 $k$，您刚刚使用上述 $Q$完成了时间传播，并获得了预测的先验（也称为时间更新的）状态均值和协方差\n$$\nx_k^{-}=\\begin{pmatrix} 150\\,\\mathrm{mg}/\\mathrm{dL} \\\\ 2\\,\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min}) \\end{pmatrix},\\qquad\nP_k^{-}=\\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix},\n$$\n其中 $P_k^{-}$ 的条目采用相应状态的平方单位。在同一时刻，CGM报告 $y_k=160\\,\\mathrm{mg}/\\mathrm{dL}$。\n\n使用高斯随机变量的贝叶斯估计第一原理和定义了扩展卡尔曼滤波器（EKF）的一阶线性化方法，计算在融合 $y_k$ 后膳食扰动输入 $u_k$ 的后验（也称为测量更新的）估计。将最终值以 $\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min})$ 表示，并将答案四舍五入到四位有效数字。\n\n然后，从业界协方差传播和卡尔曼增益结构的角度，简要讨论在更新步骤中，增加 $Q$ 中的膳食不确定性参数 $q_u$ 将如何改变 $u_k$ 的后验估计，同时保持所有其他量不变，除了那些在时间更新中受 $q_u$ 因果影响的量。",
            "solution": "用户提供了一个需要将卡尔曼滤波原理应用于生物医学系统的问题。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 状态向量：$x_k = \\begin{pmatrix} G_k \\\\ u_k \\end{pmatrix}$，其中 $G_k$ 是血浆葡萄糖，$u_k$ 是有效膳食扰动。\n- 过程模型：\n  $$G_{k} = G_{k-1} + \\Delta t\\left[-\\frac{G_{k-1} - G_b}{\\tau} + S_u\\,u_{k-1}\\right] + w_{G,k-1}$$\n  $$u_{k} = \\rho\\,u_{k-1} + w_{u,k-1}$$\n- 参数：\n  - $\\Delta t=5\\,\\mathrm{min}$\n  - $G_b=100\\,\\mathrm{mg}/\\mathrm{dL}$\n  - $\\tau=60\\,\\mathrm{min}$\n  - $S_u=1\\,\\mathrm{min}^{-1}$\n  - $\\rho=0.9$\n- 过程噪声：$w_{k-1}=\\begin{pmatrix} w_{G,k-1} \\\\ w_{u,k-1}\\end{pmatrix} \\sim \\mathcal{N}(0, Q)$。\n- 过程噪声协方差：$Q=\\mathrm{diag}(q_G,q_u)$，其中 $q_G=1\\,\\mathrm{mg}^2/\\mathrm{dL}^2$，$q_u=0.25\\,\\mathrm{mg}^2/(\\mathrm{dL}^2\\cdot\\mathrm{min}^2)$。\n- 测量模型：$y_k = h(x_k) + v_k$。\n- 测量函数：$h(x_k)=G_k$。\n- 测量噪声：$v_k\\sim\\mathcal{N}(0,R)$，其中 $R=5\\,\\mathrm{mg}^2/\\mathrm{dL}^2$。\n- 时刻 $k$ 的先验（时间更新）状态估计：$x_k^{-}=\\begin{pmatrix} 150\\,\\mathrm{mg}/\\mathrm{dL} \\\\ 2\\,\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min}) \\end{pmatrix}$。\n- 时刻 $k$ 的先验（时间更新）协方差：$P_k^{-}=\\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix}$。\n- 时刻 $k$ 的测量值：$y_k=160\\,\\mathrm{mg}/\\mathrm{dL}$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了一个简化但标准且科学上接受的线性房室模型来描述葡萄糖-膳食动态。这类模型在人工胰腺开发和生理建模领域很常见。所有参数都具有物理上的合理性。\n- **适定性：** 问题是适定的。它提供了所有必要的信息（先验估计、测量值、噪声特性），以使用卡尔曼滤波器算法计算出唯一的后验估计。\n- **客观性：** 问题以精确、客观的数学和工程术语陈述。没有歧义和主观性。\n- **完整性：** 问题是自洽的。更新步骤所需的所有方程、常数和初始数据都已提供。\n所有其他验证标准都已满足。该问题是估计理论的标准应用。\n\n**第三步：结论与行动**\n问题有效。将提供解答。\n\n### 解答\n\n该问题要求分两部分解答：第一，计算膳食扰动 $u_k$ 的测量更新（后验）估计；第二，讨论增加过程噪声参数 $q_u$ 的影响。这里使用卡尔曼滤波器（或扩展卡尔曼滤波器，由于测量模型是线性的，它简化为前者）的测量更新步骤。\n\n**第一部分：计算 $u_k$ 的后验估计**\n\n状态估计 $x_k$ 的测量更新方程为：\n1.  新息（残差）：$\\tilde{y}_k = y_k - h(x_k^{-})$\n2.  新息协方差：$S_k = H_k P_k^{-} H_k^T + R$\n3.  卡尔曼增益：$K_k = P_k^{-} H_k^T S_k^{-1}$\n4.  后验状态估计：$x_k^{+} = x_k^{-} + K_k \\tilde{y}_k$\n\n测量函数给定为 $h(x_k) = G_k$。对于状态向量 $x_k = \\begin{pmatrix} G_k \\\\ u_k \\end{pmatrix}$，这可以写成 $h(x_k) = H_k x_k$，其中 $H_k$ 是测量雅可比矩阵。\n$$H_k = \\frac{\\partial h}{\\partial x_k} = \\begin{pmatrix} \\frac{\\partial G_k}{\\partial G_k} & \\frac{\\partial G_k}{\\partial u_k} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$$\n该矩阵是常数，不依赖于状态，因此EKF方程与线性卡尔曼滤波器方程相同。\n\n我们给定的数值如下：\n$x_k^{-} = \\begin{pmatrix} 150 \\\\ 2 \\end{pmatrix}$，$P_k^{-} = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix}$，$y_k = 160$，$R=5$。\n\n1.  **计算新息 $\\tilde{y}_k$**：\n    预测的测量值为 $h(x_k^{-}) = H_k x_k^{-} = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 150 \\\\ 2 \\end{pmatrix} = 150$。\n    新息是实际测量值与预测测量值之差：\n    $$\\tilde{y}_k = y_k - h(x_k^{-}) = 160 - 150 = 10$$\n\n2.  **计算新息协方差 $S_k$**：\n    $$S_k = H_k P_k^{-} H_k^T + R = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 5$$\n    $$S_k = \\begin{pmatrix} 20 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 5 = 20 + 5 = 25$$\n\n3.  **计算卡尔曼增益 $K_k$**：\n    $$K_k = P_k^{-} H_k^T S_k^{-1} = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (25)^{-1}$$\n    $$K_k = \\begin{pmatrix} 20 \\\\ 2 \\end{pmatrix} \\frac{1}{25} = \\begin{pmatrix} 0.8 \\\\ 0.08 \\end{pmatrix}$$\n\n4.  **计算后验状态估计 $x_k^{+}$**：\n    $$x_k^{+} = x_k^{-} + K_k \\tilde{y}_k = \\begin{pmatrix} 150 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 0.8 \\\\ 0.08 \\end{pmatrix} (10)$$\n    $$x_k^{+} = \\begin{pmatrix} 150 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 8 \\\\ 0.8 \\end{pmatrix} = \\begin{pmatrix} 158 \\\\ 2.8 \\end{pmatrix}$$\n\n后验状态估计为 $x_k^{+} = \\begin{pmatrix} G_k^{+} \\\\ u_k^{+} \\end{pmatrix} = \\begin{pmatrix} 158 \\\\ 2.8 \\end{pmatrix}$。膳食扰动的后验估计是第二个分量，$u_k^{+} = 2.8\\,\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min})$。四舍五入到四位有效数字为 $2.800\\,\\mathrm{mg}/(\\mathrm{dL}\\cdot\\mathrm{min})$。\n\n**第二部分：讨论增加 $q_u$ 的影响**\n\n问题询问在更新步骤中，增加膳食不确定性参数 $q_u$ 将如何改变 $u_k$ 的后验估计，假设所有其他参数都保持不变，除了那些在时间更新阶段受 $q_u$ 因果影响的参数。\n\n1.  **对先验协方差 $P_k^{-}$ 的影响**：先验协方差 $P_k^{-}$ 是通过前一步的后验协方差 $P_{k-1}^{+}$ 的时间传播得到的：\n    $$P_k^{-} = F_{k-1} P_{k-1}^{+} F_{k-1}^T + Q$$\n    其中 $F_{k-1}$ 是状态转移矩阵，$Q = \\mathrm{diag}(q_G, q_u)$。将 $q_u$ 增加到一个新值 $q_u' > q_u$ 会得到一个新的过程噪声协方差 $Q' = \\mathrm{diag}(q_G, q_u')$。这个变化直接影响传播的先验协方差。新的先验协方差 $P_k'^{-}$ 将是：\n    $$P_k'^{-} = F_{k-1} P_{k-1}^{+} F_{k-1}^T + Q' = (P_k^{-} - Q) + Q' = P_k^{-} + (Q' - Q)$$\n    $$P_k'^{-} = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix} + \\left( \\begin{pmatrix} q_G & 0 \\\\ 0 & q_u' \\end{pmatrix} - \\begin{pmatrix} q_G & 0 \\\\ 0 & q_u \\end{pmatrix} \\right) = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & q_u' - q_u \\end{pmatrix}$$\n    因此，增加 $q_u$ 只会增加先验协方差矩阵 $P_k^{-}$ 的 $(2,2)$ 元素（即膳食扰动状态的方差 $\\mathrm{Var}(u_k^{-})$）。设新的先验协方差为 $P_k'^{-} = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 + \\delta \\end{pmatrix}$，其中 $\\delta = q_u' - q_u > 0$。\n\n2.  **对卡尔曼增益 $K_k$ 的影响**：卡尔曼增益计算为 $K_k = P_k^{-} H_k^T (H_k P_k^{-} H_k^T + R)^{-1}$。我们来分析 $P_k^{-}$ 的变化如何传播到 $K_k$。\n    - 测量矩阵 $H_k = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$ 是常数。\n    - 新息协方差 $S_k$ 取决于 $H_k P_k^{-} H_k^T$。我们用新的 $P_k'^{-}$ 计算这一项：\n      $$H_k P_k'^{-} H_k^T = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 + \\delta \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = P_{k,11}'^{-} = 20$$\n      这一项没有改变，因为它只依赖于先验协方差的 $(1,1)$ 元素，而该元素不受 $q_u$ 的影响。因此，新息协方差 $S_k = 20 + R = 25$ 也没有改变。\n    - $P_k^{-} H_k^T$ 项变为：\n      $$P_k'^{-} H_k^T = \\begin{pmatrix} 20 & 2 \\\\ 2 & 1 + \\delta \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 2 \\end{pmatrix}$$\n      这一项代表状态向量与测量量之间的先验协方差，它也没有改变，因为它对应于先验协方差矩阵的第一列。元素 $P_{k,11}'^{-}$ 和 $P_{k,21}'^{-}$ 不受 $q_u$ 变化的影响。\n\n    由于 $P_k^{-} H_k^T$ 和 $S_k$ 都对 $q_u$ 的变化不敏感，所以卡尔曼增益 $K_k = \\begin{pmatrix} 0.8 \\\\ 0.08 \\end{pmatrix}$ 保持完全不变。\n\n3.  **对后验估计 $u_k^{+}$ 的影响**：后验状态通过 $x_k^{+} = x_k^{-} + K_k \\tilde{y}_k$ 更新。\n    - 先验状态估计 $x_k^{-} = F_{k-1}x_{k-1}^{+}$ 不是过程噪声协方差 $Q$ 的函数，因此保持不变。\n    - 测量值 $y_k$ 是一个给定值，保持不变。\n    - 因此，新息 $\\tilde{y}_k = y_k - H_k x_k^{-}$ 也保持不变。\n    - 如上所示，卡尔曼增益 $K_k$ 保持不变。\n\n    由于更新方程右侧的每一项都保持不变，后验状态估计 $x_k^{+}$ 将不会改变。因此，其第二个分量，即膳食扰动的后验估计 $u_k^{+}$，也将保持不变。\n\n    **讨论总结**：增加膳食不确定性参数 $q_u$ 会增加我们对膳食扰动先验估计 $u_k^{-}$ 的不确定性，这反映在方差项 $P_{k,22}^{-}$ 的增加上。然而，因为测量值仅为葡萄糖（$G_k$），用于更新膳食扰动估计的葡萄糖新息增益 $K_{k,2}$ 仅取决于葡萄糖和膳食扰动之间的先验互协方差（$P_{k,21}^{-}$）以及总的预测测量方差（$S_k$）。这两者都不受 $P_{k,22}^{-}$ 的影响。因此，在这个特定的模型结构中，后验估计 $u_k^{+}$ 不会因为 $q_u$ 的增加而改变。然而，增加的不确定性会传播到后验协方差矩阵 $P_k^{+}$，导致对 $u_k$ 的估计具有更大的最终方差。",
            "answer": "$$\\boxed{2.800}$$"
        }
    ]
}