{
    "hands_on_practices": [
        {
            "introduction": "心脏动作电位是触发每一次心跳的基础电信号。在这个动手实践中，你将实现一个心肌细胞的计算模型来模拟其动作电位。通过探索诸如 $I_{Kr}$ 和 $I_{CaL}$ 等离子通道电导的变化如何影响动作电位时程，你将掌握心脏电生理学建模的基础技能。",
            "id": "3917274",
            "problem": "您的任务是为一个特定患者的心脏数字孪生实现一个最小化的、符合生物物理学的单细胞膜模型，以计算百分之九十复极化时的动作电位时程 (APD90)，并检验其对快速延迟整流钾电流 (IKr) 和L型钙电流 (ICaL) 电导变化的敏感性。该模型将基于电流平衡和门控动力学的第一性原理，所有量均以一致的单位表示。您必须生成以毫秒 (ms) 为单位的数值输出，四舍五入到一位小数，并将所有测试用例的结果汇总到一个单行打印的列表中。\n\n基本原理：\n- 膜电压动力学由一个集总电容膜的电流平衡方程决定，\n$$C_m \\frac{dV}{dt} = -\\left(I_{CaL} + I_{Kr} + I_\\text{leak}\\right) + I_\\text{stim}(t),$$\n其中 $V$ 是以毫伏 (mV) 为单位的膜电压，$t$ 是以毫秒 (ms) 为单位的时间，$C_m$ 是以微法拉每平方厘米 ($\\mu\\text{F}/\\text{cm}^2$) 为单位的膜电容，$I_{CaL}$ 是以微安每平方厘米 ($\\mu\\text{A}/\\text{cm}^2$) 为单位的L型钙电流，$I_{Kr}$ 是以 $\\mu\\text{A}/\\text{cm}^2$ 为单位的快速延迟整流钾电流，$I_\\text{leak}$ 是以 $\\mu\\text{A}/\\text{cm}^2$ 为单位的线性漏电流，$I_\\text{stim}(t)$ 是以 $\\mu\\text{A}/\\text{cm}^2$ 为单位的外部施加的刺激电流。\n\n- 电流遵循带有反转电位的欧姆定律，\n$$I_{CaL} = G_{CaL}\\,d\\,h\\,\\left(V - E_{Ca}\\right), \\quad I_{Kr} = G_{Kr}\\,x_r\\,\\left(V - E_K\\right), \\quad I_\\text{leak} = G_\\text{leak}\\,\\left(V - E_\\text{leak}\\right),$$\n其中 $G_{CaL}$、$G_{Kr}$ 和 $G_\\text{leak}$ 是以毫西门子每平方厘米 ($\\text{mS}/\\text{cm}^2$) 为单位的电导，$E_{Ca}$ 和 $E_K$ 是以 mV 为单位的反转电位，$E_\\text{leak}$ 是以 mV 为单位的漏电流反转电位，而 $d$、$h$ 和 $x_r$ 是在无单位区间 $[0,1]$ 内的门控变量。\n\n- 门控变量根据一级动力学向具有时间常数的稳态值演化：\n$$\\frac{dd}{dt} = \\frac{d_\\infty(V) - d}{\\tau_d(V)}, \\quad \\frac{dh}{dt} = \\frac{h_\\infty(V) - h}{\\tau_h(V)}, \\quad \\frac{dx_r}{dt} = \\frac{x_{r,\\infty}(V) - x_r}{\\tau_{xr}(V)}.$$\n\n- 稳态（无限时间）门控值和时间常数由经过充分检验的S型函数定义：\n$$d_\\infty(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{d,1/2}}{k_d}\\right)}, \\quad h_\\infty(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{h,1/2}}{k_h}\\right)}, \\quad x_{r,\\infty}(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{xr,1/2}}{k_{xr}}\\right)},$$\n$$\\tau_d(V) = \\tau_{d,0} + \\frac{\\tau_{d,1}}{1 + \\exp\\left(-\\frac{V - V_{td}}{k_{td}}\\right)}, \\quad \\tau_h(V) = \\tau_{h,0}, \\quad \\tau_{xr}(V) = \\tau_{xr,0}.$$\n\n- 使用以下对于心室心肌在生理学上合理的固定参数：\n$$C_m = 1.0 \\ \\mu\\text{F}/\\text{cm}^2, \\quad E_{Ca} = 60 \\ \\text{mV}, \\quad E_K = -90 \\ \\text{mV}, \\quad E_\\text{leak} = -60 \\ \\text{mV}, \\quad G_\\text{leak} = 0.02 \\ \\text{mS}/\\text{cm}^2.$$\n门控参数：\n$$V_{d,1/2} = -10 \\ \\text{mV}, \\quad k_d = 6 \\ \\text{mV}, \\quad \\tau_{d,0} = 2 \\ \\text{ms}, \\quad \\tau_{d,1} = 10 \\ \\text{ms}, \\quad V_{td} = -10 \\ \\text{mV}, \\quad k_{td} = 5 \\ \\text{mV},$$\n$$V_{h,1/2} = -30 \\ \\text{mV}, \\quad k_h = 6 \\ \\text{mV}, \\quad \\tau_{h,0} = 40 \\ \\text{ms},$$\n$$V_{xr,1/2} = -20 \\ \\text{mV}, \\quad k_{xr} = 7 \\ \\text{mV}, \\quad \\tau_{xr,0} = 100 \\ \\text{ms}.$$\n\n- 用于引发单个动作电位的外部刺激电流：\n$$I_\\text{stim}(t) = \\begin{cases}\nI_0  \\text{if } t \\in [t_\\text{start}, t_\\text{end}],\\\\\n0  \\text{otherwise},\n\\end{cases}$$\n其中 $I_0 = 2.5 \\ \\mu\\text{A}/\\text{cm}^2$, $t_\\text{start} = 1.0 \\ \\text{ms}$, $t_\\text{end} = 3.0 \\ \\text{ms}$。初始条件为 $V(0) = -80 \\ \\text{mV}$ 以及 $d(0) = d_\\infty(-80 \\ \\text{mV})$, $h(0) = h_\\infty(-80 \\ \\text{mV})$, $x_r(0) = x_{r,\\infty}(-80 \\ \\text{mV})$。\n\nAPD90的定义：\n- 令 $V_\\text{rest}$ 为静息电位，估算为 $t \\in [0, 0.8] \\ \\text{ms}$ 期间 $V(t)$ 的平均值。\n- 令 $V_\\text{peak}$ 为模拟窗口内 $V(t)$ 的最大值。\n- 定义动作电位振幅 $A = V_\\text{peak} - V_\\text{rest}$。\n- 如果 $A  20 \\ \\text{mV}$，则认为没有引发动作电位，并定义 $\\text{APD90} = 0.0 \\ \\text{ms}$。\n- 否则，定义 $V_{50} = V_\\text{rest} + 0.5 A$ 和 $V_{90} = V_\\text{rest} + 0.1 A$。\n- 令 $t_\\text{up}$ 为上升支期间 $V(t)$ 从下向上穿过 $V_{50}$ 的第一个时间点，令 $t_{90}$ 为 $V_\\text{peak}$ 之后 $V(t)$ 从上向下穿过 $V_{90}$ 的第一个时间点。那么\n$$\\text{APD90} = t_{90} - t_\\text{up}.$$\n使用相邻时间样本之间的线性插值来估计穿越时间。\n\n数值规格：\n- 使用一个数值稳定的常微分方程求解器，在 $t \\in [0, 400] \\ \\text{ms}$ 范围内进行模拟，时间分辨率需足够精细以解析穿越点。所有内部计算和输出必须以毫秒 (ms) 和毫伏 (mV) 为单位。\n- 最终的APD90值以ms为单位表示，每个值四舍五入到一位小数。\n\n测试套件：\n在五种电导配置下评估模型以评估其敏感性：\n1. 基线：$(G_{Kr}, G_{CaL}) = (0.12, 0.10)$，单位为 $\\text{mS}/\\text{cm}^2$。\n2. 降低的快速延迟整流钾电导：$(G_{Kr}, G_{CaL}) = (0.06, 0.10)$。\n3. 增加的L型钙电导：$(G_{Kr}, G_{CaL}) = (0.12, 0.13)$。\n4. 增加的快速延迟整流钾电导：$(G_{Kr}, G_{CaL}) = (0.20, 0.10)$。\n5. 降低的L型钙电导：$(G_{Kr}, G_{CaL}) = (0.12, 0.07)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的APD90结果，格式为方括号内以逗号分隔的列表（例如，“[result1,result2,result3,result4,result5]”），其中每个结果都是一个以ms为单位、四舍五入到一位小数的浮点数。",
            "solution": "所呈现的问题是计算心脏电生理学领域中一个有效的、适定的初值问题。它在科学上基于用于模拟离子通道动力学的 Hodgkin-Huxley 范式，并且是自洽的，提供了所有必要的方程、参数、初始条件和分析程序。单位在内部是一致的，任务是客观且计算上可行的。因此，我们可以着手提供一个完整的解决方案。\n\n这个问题的核心是模拟心脏细胞膜电压 $V(t)$ 的时间演化，该演化由跨细胞膜的电荷守恒原理所支配。该原理表示为一个一阶常微分方程 (ODE)：\n$$C_m \\frac{dV}{dt} = -I_\\text{total} + I_\\text{stim}(t)$$\n此处，$C_m$ 是单位面积的膜电容，电压的变化率 $dV/dt$ 与流经膜的净电流成正比。总离子电流 $I_\\text{total}$ 是来自不同离子通道和泵的贡献之和。在这个简化模型中，我们考虑三种主要电流：L型钙电流 ($I_{CaL}$)、快速延迟整流钾电流 ($I_{Kr}$) 和一个被动的漏电流 ($I_\\text{leak}$)。\n$$I_\\text{total} = I_{CaL} + I_{Kr} + I_\\text{leak}$$\n外部刺激电流 $I_\\text{stim}(t)$ 是一个短暂的、外部施加的电流，旨在将细胞从其静息状态扰动并触发一个动作电位。\n\n每个离子电流都使用欧姆关系进行建模，其中电流是电导 ($G$) 和驱动力 ($V - E_{ion}$) 的乘积：\n$$I_{ion} = G_{ion} \\cdot (\\text{gating variables}) \\cdot (V - E_{ion})$$\n驱动力是膜电压 $V$ 与该特定离子的能斯特平衡电位 $E_{ion}$ 之间的差值。电压门控通道的电导不是恒定的；它取决于通道蛋白的构象状态，由无单位的门控变量表示，我们在此记为 $d$、$h$ 和 $x_r$。\n\n具体的电流是：\n1.  $I_{CaL} = G_{CaL}\\,d\\,h\\,(V - E_{Ca})$：该钙电流是心脏动作电位特征性平台期的原因。它由一个激活门 $d$ 和一个失活门 $h$ 控制。\n2.  $I_{Kr} = G_{Kr}\\,x_r\\,(V - E_K)$：该钾电流是膜复极化的主要驱动力，使电压返回到其静息水平。它由一个激活门 $x_r$ 控制。\n3.  $I_\\text{leak} = G_\\text{leak}\\,(V - E_\\text{leak})$：这是一个不依赖于时间的门控、线性的背景电流，有助于稳定静息膜电位。\n\n门控变量本身的动力学由一阶常微分方程描述，代表了允许（开放）和不允许（关闭/失活）状态之间的转换：\n$$\\frac{dy}{dt} = \\frac{y_\\infty(V) - y}{\\tau_y(V)}$$\n其中 $y$ 代表一个通用的门控变量（$d$、$h$ 或 $x_r$）。变量 $y$ 以一个特征性的、依赖于电压（或恒定）的时间常数 $\\tau_y(V)$ 向一个依赖于电压的稳态值 $y_\\infty(V)$ 松弛。稳态激活/失活函数（$d_\\infty, h_\\infty, x_{r,\\infty}$）通常是S型的，反映了通道响应电压变化时开放和关闭的协同性质。\n\n该公式形成了一个关于状态向量 $\\mathbf{y}(t) = [V(t), d(t), h(t), x_r(t)]^T$ 的四个耦合、一阶、非线性常微分方程组：\n$$\n\\begin{cases}\n\\frac{dV}{dt} = \\frac{1}{C_m} \\left[ - (G_{CaL}\\,d\\,h\\,(V - E_{Ca}) + G_{Kr}\\,x_r\\,(V - E_K) + G_\\text{leak}\\,(V - E_\\text{leak})) + I_\\text{stim}(t) \\right] \\\\\n\\frac{dd}{dt} = \\frac{d_\\infty(V) - d}{\\tau_d(V)} \\\\\n\\frac{dh}{dt} = \\frac{h_\\infty(V) - h}{\\tau_h(V)} \\\\\n\\frac{dx_r}{dt} = \\frac{x_{r,\\infty}(V) - x_r}{\\tau_{xr}(V)}\n\\end{cases}\n$$\n给定 $t=0$ 时的初始条件，该系统必须进行数值求解。我们将采用一个先进的自适应ODE求解器，例如 `scipy.integrate.solve_ivp` 中可用的 `Radau` 方法，该方法非常适合电生理学中常见的潜在刚性系统。求解器将被配置为生成密集输出，从而允许在任何时间点精确评估解。\n\n在从 $t=0$ 到 $t=400$ ms 的模拟之后，我们将分析得到的电压轨迹 $V(t)$ 以计算90%复极化时的动作电位时程 (APD90)。该指标量化了动作电位的持续时间。计算过程按规定进行：\n1.  从刺激前的初始阶段确定静息电位 $V_\\text{rest}$。\n2.  找到峰值电压 $V_\\text{peak}$。\n3.  计算动作电位振幅 $A = V_\\text{peak} - V_\\text{rest}$。如果 $A  20$ mV，则没有动作电位被触发，APD90 为 $0.0$。\n4.  将去极化时间 $t_\\text{up}$ 确定为上升支电压穿过 $V_\\text{rest} + 0.5A$ 的时刻。\n5.  将复极化时间 $t_{90}$ 确定为下降支（峰值后）电压穿过 $V_\\text{rest} + 0.1A$ 的时刻。\n6.  然后将APD90计算为 $t_{90} - t_\\text{up}$。\n将使用线性插值法在数值解的离散时间步之间找到精确的穿越时间。\n\n这整个过程——模拟和分析——将对五个指定的电导对 $(G_{Kr}, G_{CaL})$ 中的每一个执行，以系统地评估模型对这两个关键参数的敏感性。然后将结果汇总并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the cardiac cell model problem: simulates action potentials for\n    different conductance values and calculates APD90.\n    \"\"\"\n    # Fixed parameters as defined in the problem\n    params = {\n        'C_m': 1.0,      # uF/cm^2\n        'E_Ca': 60.0,    # mV\n        'E_K': -90.0,    # mV\n        'E_leak': -60.0, # mV\n        'G_leak': 0.02,  # mS/cm^2\n        # Gating parameters\n        'V_d_half': -10.0, 'k_d': 6.0,\n        'tau_d0': 2.0, 'tau_d1': 10.0, 'V_td': -10.0, 'k_td': 5.0,\n        'V_h_half': -30.0, 'k_h': 6.0, 'tau_h0': 40.0,\n        'V_xr_half': -20.0, 'k_xr': 7.0, 'tau_xr0': 100.0,\n        # Stimulus parameters\n        'I0': 2.5,       # uA/cm^2\n        't_start': 1.0,  # ms\n        't_end': 3.0,    # ms\n    }\n\n    test_cases = [\n        (0.12, 0.10), # Baseline\n        (0.06, 0.10), # Reduced IKr\n        (0.12, 0.13), # Increased ICaL\n        (0.20, 0.10), # Increased IKr\n        (0.12, 0.07), # Reduced ICaL\n    ]\n\n    results = []\n    \n    for G_Kr, G_CaL in test_cases:\n        \n        # Define steady-state and time constant functions\n        def d_inf(V): return 1.0 / (1.0 + np.exp(-(V - params['V_d_half']) / params['k_d']))\n        def h_inf(V): return 1.0 / (1.0 + np.exp((V - params['V_h_half']) / params['k_h']))\n        def xr_inf(V): return 1.0 / (1.0 + np.exp(-(V - params['V_xr_half']) / params['k_xr']))\n        \n        def tau_d(V): return params['tau_d0'] + params['tau_d1'] / (1.0 + np.exp(-(V - params['V_td']) / params['k_td']))\n        def tau_h(V): return params['tau_h0']\n        def tau_xr(V): return params['tau_xr0']\n        \n        # Define the ODE system\n        def model(t, y):\n            V, d, h, xr = y\n            \n            # Stimulus current\n            I_stim = params['I0'] if params['t_start'] = t = params['t_end'] else 0.0\n            \n            # Ionic currents\n            I_CaL = G_CaL * d * h * (V - params['E_Ca'])\n            I_Kr = G_Kr * xr * (V - params['E_K'])\n            I_leak = params['G_leak'] * (V - params['E_leak'])\n            \n            # Derivatives\n            dV_dt = (-I_CaL - I_Kr - I_leak + I_stim) / params['C_m']\n            dd_dt = (d_inf(V) - d) / tau_d(V)\n            dh_dt = (h_inf(V) - h) / tau_h(V)\n            dxr_dt = (xr_inf(V) - xr) / tau_xr(V)\n            \n            return [dV_dt, dd_dt, dh_dt, dxr_dt]\n\n        # Initial conditions\n        V0 = -80.0\n        y0 = [V0, d_inf(V0), h_inf(V0), xr_inf(V0)]\n        \n        # Simulation time span\n        t_span = [0, 400]\n        \n        # Solve the ODE system\n        sol = solve_ivp(\n            model, \n            t_span, \n            y0, \n            method='Radau', \n            dense_output=True, \n            atol=1e-8, \n            rtol=1e-8\n        )\n        \n        # Evaluate solution on a fine time grid\n        t_eval = np.linspace(t_span[0], t_span[1], 4001) # 0.1 ms resolution\n        V_eval = sol.sol(t_eval)[0]\n        \n        # Calculate APD90\n        # 1. V_rest\n        rest_mask = t_eval = 0.8\n        V_rest = np.mean(V_eval[rest_mask])\n        \n        # 2. V_peak\n        peak_idx = np.argmax(V_eval)\n        V_peak = V_eval[peak_idx]\n        t_peak = t_eval[peak_idx]\n        \n        # 3. Amplitude and check for AP\n        A = V_peak - V_rest\n        if A  20.0:\n            results.append(0.0)\n            continue\n            \n        # 4. Thresholds\n        V_50 = V_rest + 0.5 * A\n        V_90 = V_rest + 0.1 * A\n        \n        # Helper for linear interpolation\n        def find_crossing(t_data, V_data, threshold, direction):\n            for i in range(1, len(V_data)):\n                v1, v2 = V_data[i-1], V_data[i]\n                t1, t2 = t_data[i-1], t_data[i]\n                if direction == 'up' and v1  threshold = v2:\n                    return t1 + (t2 - t1) * (threshold - v1) / (v2 - v1)\n                if direction == 'down' and v1 > threshold >= v2:\n                    return t1 + (t2 - t1) * (threshold - v1) / (v2 - v1)\n            return None # Should not happen if AP is valid\n            \n        # 5. Find t_up\n        upstroke_mask = t_eval = t_peak\n        t_up = find_crossing(t_eval[upstroke_mask], V_eval[upstroke_mask], V_50, 'up')\n        \n        # 6. Find t_90\n        downstroke_mask = t_eval >= t_peak\n        t_90 = find_crossing(t_eval[downstroke_mask], V_eval[downstroke_mask], V_90, 'down')\n\n        if t_up is None or t_90 is None:\n            apd90 = 0.0 # Could happen in edge cases\n        else:\n            apd90 = t_90 - t_up\n        \n        results.append(round(apd90, 1))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "心脏数字孪的一个关键功能是将心脏的结构与其机械性能（例如压力产生）联系起来。本练习将基础的杨-拉普拉斯定律应用于简化的左心室模型，以根据心壁应力和几何形状估算压力。这项实践不仅在组织力学和器官功能之间建立了定量的联系，而且还促使你批判性地评估此类模型的假设和局限性。",
            "id": "3917320",
            "problem": "利用磁共振成像（MRI）和计算机断层扫描（CT）获取解剖结构，并使用有限元（FE）机电模型预测应力，构建了一个患者特异性的左心室（LV）心脏数字孪生。在收缩峰期，心室中部短轴切面上的心内膜表面近似为球形，其主曲率半径均为 $R$，且环向柯西应力的跨壁梯度不大。有限元模型报告的室壁中层环向柯西应力为 $\\sigma_{\\theta}$，影像得出的室壁厚度为 $h$。将左心室壁局部处理为一个薄膜，其面内各向同性张力 $T$ 与室壁中层环向柯西应力通过 $T \\approx \\sigma_{\\theta} h$ 相关联。从薄曲面膜的静态力学平衡和基于曲率的力平衡出发，推导球形情况下内部压力 $P$ 关于张力 $T$ 和主曲率的表达式，然后使用以下患者特异性值计算 $P$：$R = 25\\ \\mathrm{mm}$，$h = 10\\ \\mathrm{mm}$，以及 $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$。最终压力以千帕斯卡（kPa）为单位表示，并将答案四舍五入至四位有效数字。简要论证建模假设的合理性，并在您的推导和论证过程中，指出与心脏力学的厚壁模型相比，薄壁近似法的关键局限性。最终答案中不要提供定性评论；最终答案必须是单一的计算值。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n**步骤1：提取已知条件**\n- **系统：** 一个患者特异性的左心室（LV）心脏数字孪生。\n- **几何形状：** 在收缩峰期，心内膜表面被建模为球形。\n- **主曲率半径：** 两个主曲率半径均等于 $R$。\n- **室壁厚度：** $h$。\n- **室壁中层环向柯西应力：** $\\sigma_{\\theta}$。\n- **近似：** 左心室壁被处理为薄膜。\n- **面内各向同性张力：** $T \\approx \\sigma_{\\theta} h$。\n- **控制原理：** 薄曲面膜的静态力学平衡和基于曲率的力平衡。\n- **患者特异性值：**\n  - $R = 25\\ \\mathrm{mm}$\n  - $h = 10\\ \\mathrm{mm}$\n  - $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$\n- **目标：**\n  1. 推导内部压力 $P$ 关于张力 $T$ 和主曲率的表达式。\n  2. 使用给定值计算 $P$。\n- **输出格式：** 最终压力以千帕斯卡为单位表示，并四舍五入至四位有效数字。\n- **附加要求：** 论证建模假设的合理性，并指出薄壁近似法的局限性。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于杨-拉普拉斯方程，这是力学中的一个基本原理，用于描述跨越弯曲界面或膜的压力差。将其应用于左心室的简化模型是生物力学中一种标准且成熟的方法。变量及其关系具有物理意义。\n- **适定性：** 该问题提供了所有必要的参数（$R$，$h$，$\\sigma_{\\theta}$）、一个本构关系（$T \\approx \\sigma_{\\theta} h$）和一个明确的物理定律来应用。它可以导出一个唯一的解。\n- **客观性：** 问题以精确、客观的语言陈述，没有主观性论断。\n- **潜在缺陷分析：** 问题指示使用薄壁近似法。所提供的数据给出的厚度与半径之比为 $h/R = 10\\ \\mathrm{mm} / 25\\ \\mathrm{mm} = 0.4$。这个值远大于薄壁有效性的典型阈值（例如 $h/R  0.1$）。然而，问题明确要求指出这种近似的局限性。这是一种标准的教学方法：将一个简化模型应用于其严格无效的范围，以突显其局限性。因此，这并未使问题无效，而是使对模型的批判成为任务的核心部分。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n在压差作用下，薄曲面膜处于静态平衡的物理学原理由杨-拉普拉斯方程描述。该方程建立了由内部压力 $P$ 产生的向外力与由膜张力 $T$ 沿曲面作用产生的向内拉力之间的平衡。对于具有两个主曲率 $\\kappa_1$ 和 $\\kappa_2$ 的一般曲面，方程为：\n$$\nP = T (\\kappa_1 + \\kappa_2)\n$$\n这假设张力 $T$ 是各向同性的，意味着它在膜表面内的所有方向上都相同，这与问题的设置一致。\n\n问题陈述左心室的心内膜表面被建模为半径为 $R$ 的球体。对于球体，其表面在所有方向上均匀弯曲。两个主曲率是相同的，等于球体半径的倒数：\n$$\n\\kappa_1 = \\kappa_2 = \\frac{1}{R}\n$$\n将这些曲率代入通用的杨-拉普拉斯方程，得到球形膜的特定形式：\n$$\nP = T \\left(\\frac{1}{R} + \\frac{1}{R}\\right) = \\frac{2T}{R}\n$$\n这就是所要求的压力 $P$ 关于张力 $T$ 和主曲率（通过 $R$ 隐式表示）的表达式。\n\n问题提供了一个将二维膜张力 $T$ 与三维壁应力相关联的近似。张力 $T$（单位长度的力）近似为室壁中层环向柯西应力 $\\sigma_{\\theta}$（单位面积的力）乘以室壁厚度 $h$：\n$$\nT \\approx \\sigma_{\\theta} h\n$$\n这个近似是厚壁的连续介质力学与理想化膜的简化力学之间的联系。\n\n将这个 $T$ 的表达式代入球形拉普拉斯方程，得到压力 $P$ 关于给定模型参数的最终公式：\n$$\nP \\approx \\frac{2(\\sigma_{\\theta} h)}{R}\n$$\n现在我们可以使用患者特异性值进行数值计算：\n- $R = 25\\ \\mathrm{mm}$\n- $h = 10\\ \\mathrm{mm}$\n- $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$\n\n长度单位（$h$ 和 $R$ 的单位 $\\mathrm{mm}$）将相互抵消，使得压力 $P$ 的单位与应力 $\\sigma_{\\theta}$ 的单位相同，即千帕斯卡（$\\mathrm{kPa}$）。\n$$\nP = \\frac{2 \\times (20\\ \\mathrm{kPa}) \\times (10\\ \\mathrm{mm})}{25\\ \\mathrm{mm}} = \\frac{400}{25}\\ \\mathrm{kPa} = 16\\ \\mathrm{kPa}\n$$\n问题要求答案四舍五入至四位有效数字。计算值恰好为 $16$，可以写成 $16.00$。\n\n此问题的一个关键方面是对薄壁近似法的合理性论证和批判。\n\n**建模假设的合理性论证：**\n将左心室简化为薄球壳是一个一阶模型，它在压力、几何形状和室壁应力之间提供了直接的代数联系。该模型计算成本低，并能提供对心脏功能的基本见解，例如，在心动周期中，压力的产生如何与室壁增厚和半径变化相关联。跨壁应力梯度“不大”的假设为使用单一的室壁中层应力值 $\\sigma_{\\theta}$ 作为整个室壁厚度的代表值提供了理由，这是进行近似 $T \\approx \\sigma_{\\theta} h$ 的前提条件。\n\n**薄壁近似法的局限性：**\n实际上，心壁是一个厚壁结构。薄壁模型的主要局限性，尤其是在本案例中，源于其违反了其基本几何假设。\n1.  **厚度与半径之比：** 当室壁厚度远小于曲率半径（$h \\ll R$）时，薄壁假设才有效。一个常见的工程经验法则是 $h/R  0.1$。在此问题中，$h/R = 10/25 = 0.4$，这个值很大。这表明薄壁模型正被应用于其精度范围之外，其预测结果应谨慎看待。\n2.  **跨壁应力梯度：** 受压的厚壁结构会经历显著的应力梯度。对于厚壁球体，环向应力 $\\sigma_{\\theta}$ 在内表面（心内膜）处最大，在外表面（心外膜）处最小。薄壁模型通过使用单一应力值，完全忽略了这种变化。这是一个主要局限性，因为心内膜处的峰值应力通常是心脏病理生理学（例如，心内膜下缺血）中的一个关键因素。\n3.  **径向应力：** 厚壁理论能正确地模拟径向应力 $\\sigma_r$，该应力从心内膜处的 $-P$ 变化到心外膜处的接近零。薄壁假设等同于假定径向应力与环向应力相比可以忽略不计（$\\sigma_r \\ll \\sigma_{\\theta}$），但这在整个室壁厚度上并不成立。\n4.  **几何简化：** 该模型使用单一半径 $R$。在厚壁中，曲率半径从心内膜到心外膜是变化的。厚壁模型通过对厚度进行积分来考虑这一点。\n\n总之，虽然薄壁模型提供了一个简单而有用的概念框架，但对左心室进行更精确的分析将需要一个厚壁模型（例如，基于厚壁球体的拉梅方程），该模型能恰当处理大的 $h/R$ 比值以及由此产生的跨壁应力分布。",
            "answer": "$$\n\\boxed{16.00}\n$$"
        },
        {
            "introduction": "在心脏中，电功能和机械功能并非相互独立，而是通过机电反馈错综复杂地联系在一起。这个高级实践通过将拉伸激活离子通道整合到心肌细胞模型中来探索这种耦合。你将研究机械预负荷如何改变细胞的电行为，这一现象对于理解正常的心脏适应和心脏疾病的进展都至关重要。",
            "id": "3917266",
            "problem": "一个单细胞患者特异性心脏数字孪生通过在膜方程中包含一个拉伸激活电流来模拟机电反馈。考虑一个由电流平衡和基于基本电荷守恒的唯象恢复变量所描述的起搏兴奋膜。其出发点是表达电容器上电荷守恒的膜方程： $$C_m \\frac{dV}{dt} = -\\left(I_{\\text{ion}}(V,w) + I_{\\text{SAC}}(V,\\lambda)\\right) + I_{\\text{stim}}(t),$$ 其中 $C_m$ 是膜电容，$V$ 是跨膜电位，$w$ 是一个捕捉缓慢离子过程的恢复变量，$I_{\\text{ion}}$ 代表兴奋膜的净离子电流，$I_{\\text{SAC}}$ 是拉伸激活电流，$I_{\\text{stim}}(t)$ 是一个外部起搏刺激，而 $\\lambda$ 是一个无量纲的前负荷（拉伸比）。使用以下经过充分检验的兴奋膜方程来实例化 $I_{\\text{ion}}$ 和恢复动力学（一个为心脏兴奋性调整的双变量 FitzHugh–Nagumo 型模型）：\n$$\\frac{dV}{dt} = \\frac{1}{C_m}\\left(V - \\frac{V^3}{3} - w + I_{\\text{stim}}(t) - I_{\\text{SAC}}(V,\\lambda)\\right),$$\n$$\\frac{dw}{dt} = \\frac{1}{\\tau}\\left(V + a - b\\,w\\right),$$\n其中参数 $a$、$b$、$\\tau$、$C_m$ 的选择是为了产生生理上合理的动作电位时程。将拉伸激活电流建模为一个由前负荷门控的具有欧姆电导的非选择性阳离子电流：\n$$I_{\\text{SAC}}(V,\\lambda) = g_{\\text{SAC}}(\\lambda)\\,\\left(V - E_{\\text{SAC}}\\right),\\quad g_{\\text{SAC}}(\\lambda) = g_{\\max}\\,\\min\\left(1,\\max\\left(0,\\frac{\\lambda - 1}{\\Delta}\\right)\\right),$$\n其中 $E_{\\text{SAC}}$ 是拉伸激活通道的逆转电位，$g_{\\max}$ 是高拉伸下的最大电导，而 $\\Delta$ 设定了拉伸敏感性窗口。外部刺激是一个周期性的方波脉冲，振幅为 $I_0$，持续时间为 $d$，每隔一个基本周期长度 $\\text{CL}$ 施加一次：\n$$I_{\\text{stim}}(t) = \\begin{cases}\nI_0,  \\text{if } (t \\bmod \\text{CL}) \\in [0,d),\\\\\n0,  \\text{otherwise}.\n\\end{cases}$$\n将一次心跳的动作电位时程（APD）定义为在该次心跳中，从上冲支穿过阈值 $V_{\\text{th}}$ 到随后的下冲支穿过该阈值之间，$V$ 超过 $V_{\\text{th}}$ 的时间间隔。对于起搏稳态，将舒张间期（DI）定义为 $DI = \\text{CL} - \\text{APD}$。在增加的前负荷 $\\lambda  1$ 条件下，通过 $I_{\\text{SAC}}$ 的机电反馈预计会改变 $\\text{APD}$，从而使 $\\text{APD}$ 恢复曲线发生偏移。\n\n实现一个程序，对于每个测试用例，模拟重复起搏直至达到稳态，然后计算基线前负荷 $\\lambda_{\\text{base}} = 1$（无拉伸激活）和增加的前负荷 $\\lambda_{\\text{inc}}  1$（有拉伸激活）下的稳态 $\\text{APD}$。通过标量差量化在给定基本周期长度下的恢复曲线偏移：\n$$\\Delta \\text{APD} = \\text{APD}(\\lambda_{\\text{inc}}) - \\text{APD}(\\lambda_{\\text{base}}),$$\n以毫秒（ms）为单位表示，并四舍五入到三位小数。\n\n在所有模拟中，除非另有说明，否则使用以下科学上合理的参数值：$C_m = 1$ (无量纲标度)，$a = 0.7$，$b = 0.8$，$\\tau = 12$，$E_{\\text{SAC}} = 1.0$ (无量纲膜电位，对应于此标度模型中相对于平台期的去极化逆转电位)，$g_{\\max} = 0.02$，$\\Delta = 0.1$，$I_0 = 0.8$，$d = 1\\,\\mathrm{ms}$，$V_{\\text{th}} = 0.0$。使用固定步长数值积分器，时间步长为 $dt = 0.05\\,\\mathrm{ms}$。模拟 $N = 40$ 次心跳，并计算最后一次成功夺获的心跳的 $\\text{APD}$。如果一次起搏心跳未能成功夺获（即未发生阈值穿越），则将该次心跳的 $\\text{APD}$ 赋值为 0。\n\n您必须实现的测试套件包含以下输入参数集 $(\\text{CL}, \\lambda_{\\text{inc}})$，其中 $\\text{CL}$ 以毫秒为单位，$\\lambda_{\\text{inc}}$ 是无量纲的：\n- 用例 $1$ (正常路径): $(\\text{CL} = 600\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- 用例 $2$ (速率依赖性): $(\\text{CL} = 400\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- 用例 $3$ (接近不应期边界): $(\\text{CL} = 200\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- 用例 $4$ (无前负荷变化对照): $(\\text{CL} = 500\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.00)$.\n- 用例 $5$ (更强的前负荷): $(\\text{CL} = 300\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.12)$.\n\n对于每个用例，按照上述定义计算以 $\\mathrm{ms}$ 为单位的 $\\Delta \\text{APD}$。您的程序应生成单行输出，其中包含按给定用例顺序排列的结果，格式为方括号内的逗号分隔列表（例如，$[\\Delta \\text{APD}_1,\\Delta \\text{APD}_2,\\Delta \\text{APD}_3,\\Delta \\text{APD}_4,\\Delta \\text{APD}_5]$），每个条目都四舍五入到三位小数，并以十进制数形式表示，单位为 $\\mathrm{ms}$。",
            "solution": "该问题是有效的，因为它在计算心脏电生理学领域提出了一个有科学依据、适定且客观的任务。它提供了一整套模型方程、参数和模拟协议，从而可以得出一个唯一且可验证的解。\n\n该问题要求模拟一个患者特异性的单细胞心脏模型，以量化机电反馈对动作电位时程（APD）的影响。该模型是一个 FitzHugh-Nagumo 型系统，描述了跨膜电位 $V$ 和一个恢复变量 $w$ 的演化。该系统增加了一个拉伸激活电流 $I_{\\text{SAC}}$，用以模拟机械影响（前负荷 $\\lambda$）对细胞电活动的作用。\n\n控制常微分方程（ODEs）如下：\n$$\n\\frac{dV}{dt} = \\frac{1}{C_m}\\left(V - \\frac{V^3}{3} - w + I_{\\text{stim}}(t) - I_{\\text{SAC}}(V,\\lambda)\\right)\n$$\n$$\n\\frac{dw}{dt} = \\frac{1}{\\tau}\\left(V + a - b\\,w\\right)\n$$\n\n拉伸激活电流 $I_{\\text{SAC}}$ 及其电导 $g_{\\text{SAC}}$ 定义如下：\n$$\nI_{\\text{SAC}}(V,\\lambda) = g_{\\text{SAC}}(\\lambda)\\,\\left(V - E_{\\text{SAC}}\\right)\n$$\n$$\ng_{\\text{SAC}}(\\lambda) = g_{\\max}\\,\\min\\left(1,\\max\\left(0,\\frac{\\lambda - 1}{\\Delta}\\right)\\right)\n$$\n该公式表明，当没有前负荷时（$\\lambda \\le 1$），拉伸激活电流为零；在 $[1, 1+\\Delta]$ 范围内，它随拉伸 $\\lambda$ 线性增加；当 $\\lambda  1+\\Delta$ 时，它在最大电导 $g_{\\max}$ 处饱和。当 $V  E_{\\text{SAC}}$ 时，电流是内向的（去极化）；当 $V  E_{\\text{SAC}}$ 时，电流是外向的（复极化）。鉴于 $E_{\\text{SAC}} = 1.0$ 在此模型中接近典型的动作电位平台期电压，预计 $I_{\\text{SAC}}$ 在复极化期间主要是一个内向电流，从而延长 APD。\n\n外部刺激 $I_{\\text{stim}}(t)$ 是一连串方波脉冲，振幅为 $I_0$，持续时间为 $d$，周期等于基本周期长度 $\\text{CL}$。\n\n为了求解该系统，我们采用一种数值积分方案。根据题目要求，使用步长为 $dt = 0.05\\,\\mathrm{ms}$ 的固定步长前向欧拉法。对于时刻 $t_n$ 的状态 $(V_n, w_n)$，下一个时间步长 $t_{n+1} = t_n + dt$ 的状态近似为：\n$$\nV_{n+1} = V_n + dt \\cdot \\frac{1}{C_m}\\left(V_n - \\frac{V_n^3}{3} - w_n + I_{\\text{stim}}(t_n) - g_{\\text{SAC}}(\\lambda)\\left(V_n - E_{\\text{SAC}}\\right)\\right)\n$$\n$$\nw_{n+1} = w_n + dt \\cdot \\frac{1}{\\tau}\\left(V_n + a - b\\,w_n\\right)\n$$\n模拟以 $(V, w) = (0, 0)$ 初始化，并运行 $N=40$ 次心跳，以确保系统达到周期性稳态，此时每次心跳的动力学行为几乎相同。\n\n动作电位时程（APD）是为最后一次（第40次）心跳计算的。它被定义为膜电位 $V$ 超过阈值 $V_{\\text{th}} = 0.0$ 的时间间隔。我们确定上冲支的时间（$t_{\\text{up}}$），即 $V$ 首次从下方穿越 $V_{\\text{th}}$ 的时刻，以及随后的下冲支的时间（$t_{\\text{down}}$），即 $V$ 从上方穿越 $V_{\\text{th}}$ 的时刻。APD 则为 $t_{\\text{down}} - t_{\\text{up}}$。如果没有发生上冲支，表明刺激失败（未夺获），则 APD 的值被赋为 0。\n\n对于由 $(\\text{CL}, \\lambda_{\\text{inc}})$ 指定的每个测试用例，执行以下步骤：\n1.  使用基线前负荷 $\\lambda = \\lambda_{\\text{base}} = 1.0$ 进行模拟。在此前负荷下，$g_{\\text{SAC}}(\\lambda_{\\text{base}})$ 为零，因此 $I_{\\text{SAC}} = 0$。计算最后一次心跳的 APD，得到 $\\text{APD}(\\lambda_{\\text{base}})$。\n2.  使用增加的前负荷 $\\lambda = \\lambda_{\\text{inc}}$ 进行第二次模拟。计算最后一次心跳的 APD，得到 $\\text{APD}(\\lambda_{\\text{inc}})$。\n3.  APD 的变化量 $\\Delta \\text{APD}$ 计算为差值：$\\Delta \\text{APD} = \\text{APD}(\\lambda_{\\text{inc}}) - \\text{APD}(\\lambda_{\\text{base}})$。\n4.  根据要求将结果四舍五入到三位小数。\n\n对所有五个提供的测试用例重复整个过程。代码以结构化的方式实现了这一逻辑，使用一个专用函数来执行模拟并为给定的一组参数提取 APD。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the change in Action Potential Duration (APD) due to\n    mechano-electric feedback for several pacing and preload conditions.\n    \"\"\"\n\n    # Define model and simulation parameters from the problem statement.\n    params = {\n        'Cm': 1.0,         # Membrane capacitance (dimensionless)\n        'a': 0.7,          # FHN model parameter\n        'b': 0.8,          # FHN model parameter\n        'tau': 12.0,       # Recovery variable time constant (ms)\n        'E_SAC': 1.0,      # Reversal potential for SAC (dimensionless V)\n        'g_max': 0.02,     # Max conductance for SAC (dimensionless)\n        'Delta': 0.1,      # Stretch sensitivity window for SAC\n        'I0': 0.8,         # Stimulus amplitude (dimensionless)\n        'd': 1.0,          # Stimulus duration (ms)\n        'V_th': 0.0,       # APD threshold (dimensionless V)\n        'dt': 0.05,        # Time step for numerical integration (ms)\n        'N': 40,           # Number of beats to simulate\n        'lambda_base': 1.0 # Baseline preload (no stretch)\n    }\n\n    # Define the test cases (CL in ms, lambda_inc dimensionless).\n    test_cases = [\n        (600.0, 1.08),  # Case 1: happy path\n        (400.0, 1.08),  # Case 2: rate-dependent\n        (200.0, 1.08),  # Case 3: near refractory boundary\n        (500.0, 1.00),  # Case 4: no preload change control\n        (300.0, 1.12),  # Case 5: stronger preload\n    ]\n\n    results = []\n    for case in test_cases:\n        CL, lambda_inc = case\n\n        # Calculate APD for baseline preload.\n        apd_base = simulate_and_get_apd(CL, params['lambda_base'], params)\n        \n        # Calculate APD for increased preload.\n        apd_inc = simulate_and_get_apd(CL, lambda_inc, params)\n\n        # Calculate the difference in APD.\n        delta_apd = apd_inc - apd_base\n        results.append(round(delta_apd, 3))\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef simulate_and_get_apd(CL, lambda_val, params):\n    \"\"\"\n    Simulates the cardiac cell model for a given cycle length (CL) and\n    preload (lambda_val), and computes the APD of the last beat.\n\n    Args:\n        CL (float): Basic Cycle Length in ms.\n        lambda_val (float): Preload value (dimensionless).\n        params (dict): Dictionary of model and simulation parameters.\n\n    Returns:\n        float: The calculated Action Potential Duration (APD) in ms.\n    \"\"\"\n    # Unpack parameters for convenience.\n    Cm, a, b, tau = params['Cm'], params['a'], params['b'], params['tau']\n    g_max, Delta, E_SAC = params['g_max'], params['Delta'], params['E_SAC']\n    I0, d, V_th = params['I0'], params['d'], params['V_th']\n    dt, N = params['dt'], params['N']\n\n    # Calculate stretch-activated conductance g_SAC.\n    g_sac_factor = (lambda_val - 1.0) / Delta\n    g_sac = g_max * min(1.0, max(0.0, g_sac_factor))\n\n    # Simulation setup.\n    total_time = N * CL\n    num_steps = int(round(total_time / dt))\n    last_beat_start_step = int(round((N - 1) * CL / dt))\n    \n    # Initial conditions for V and w.\n    V, w = 0.0, 0.0\n    \n    v_trace_last_beat = []\n\n    # Main simulation loop using forward Euler integration.\n    for i in range(num_steps):\n        t = i * dt\n        \n        # Determine stimulus current.\n        I_stim = I0 if (t % CL)  d else 0.0\n        \n        # Calculate stretch-activated current.\n        I_sac = g_sac * (V - E_SAC)\n        \n        # FitzHugh-Nagumo ODEs.\n        dV_dt = (1.0 / Cm) * (V - (V**3) / 3.0 - w + I_stim - I_sac)\n        dw_dt = (1.0 / tau) * (V + a - b * w)\n        \n        # Update state variables.\n        V += dt * dV_dt\n        w += dt * dw_dt\n        \n        # Store voltage trace for the last beat.\n        if i >= last_beat_start_step:\n            v_trace_last_beat.append(V)\n\n    # Calculate APD from the stored trace of the last beat.\n    upstroke_idx, downstroke_idx = -1, -1\n    \n    # Find the first upstroke.\n    for i in range(1, len(v_trace_last_beat)):\n        if v_trace_last_beat[i-1]  V_th and v_trace_last_beat[i] >= V_th:\n            if upstroke_idx == -1:\n                upstroke_idx = i\n                break\n\n    # If an upstroke was found, find the subsequent downstroke.\n    if upstroke_idx != -1:\n        for i in range(upstroke_idx + 1, len(v_trace_last_beat)):\n            if v_trace_last_beat[i-1] >= V_th and v_trace_last_beat[i]  V_th:\n                downstroke_idx = i\n                break\n    \n    # Compute APD. If capture failed, APD is 0.\n    if upstroke_idx == -1 or downstroke_idx == -1:\n        return 0.0\n    else:\n        apd = (downstroke_idx - upstroke_idx) * dt\n        return apd\n\nsolve()\n```"
        }
    ]
}