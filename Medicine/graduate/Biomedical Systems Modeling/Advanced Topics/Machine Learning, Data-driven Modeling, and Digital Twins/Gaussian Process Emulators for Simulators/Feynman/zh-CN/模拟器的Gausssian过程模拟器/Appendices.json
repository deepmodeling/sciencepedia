{
    "hands_on_practices": [
        {
            "introduction": "掌握高斯过程的核心在于理解其预测机制。本练习将引导你完成一个基本但至关重要的计算：在给定训练数据、协方差和噪声的情况下，推导新输入点的预测均值。通过遵循基于Cholesky分解的数值稳定方法，你不仅能得到一个具体答案，还能深入理解模型如何权衡先验知识（由协方差矩阵$K$体现）和观测数据$\\mathbf{y}$来形成预测 。",
            "id": "3888319",
            "problem": "一个计算密集型的葡萄糖-胰岛素稳态模拟器将一个生理输入向量映射到一个标量的、无量纲的、归一化的生物标志物响应。为降低评估成本，一个高斯过程（GP）模拟器在输入设置为 $\\mathbf{x}_{1}$、$\\mathbf{x}_{2}$ 和 $\\mathbf{x}_{3}$ 的三次模拟器运行上进行训练。该模拟器使用零均值先验和一个平稳协方差函数，其在训练输入处的格拉姆矩阵 (Gram matrix) 为\n$$\nK=\\begin{pmatrix}\n1  0.8  0.6\\\\\n0.8  1  0.8\\\\\n0.6  0.8  1\n\\end{pmatrix},\n$$\n并假设存在方差为 $\\sigma^{2}=0.1$ 的独立加性高斯观测噪声。观测到的归一化模拟器输出为\n$$\n\\mathbf{y}=\\begin{pmatrix}0.25\\\\0.27\\\\0.25\\end{pmatrix}.\n$$\n令 $\\mathbf{k}_{*}=\\begin{pmatrix}0.7\\\\0.7\\\\0.7\\end{pmatrix}$ 表示在新输入 $\\mathbf{x}_{*}$ 和训练输入之间，在相同协方差函数下的协方差向量。从适用于带有独立高斯噪声的高斯过程回归的第一性原理以及多元正态分布的性质出发，使用以下计算步骤推导在 $\\mathbf{x}_{*}$ 处的后验预测均值：构建 $K_{y}=K+\\sigma^{2}I$，计算其下三角 Cholesky 因子 $L$ 使得 $LL^{\\top}=K_{y}$，求解三角系统以获得满足 $K_{y}\\boldsymbol{\\alpha}=\\mathbf{y}$ 的向量 $\\boldsymbol{\\alpha}$，然后通过与 $\\mathbf{k}_{*}$ 的内积计算预测均值。执行此计算以获得在 $\\mathbf{x}_{*}$ 处预测均值的最终数值。将您的答案四舍五入到四位有效数字。最终答案是无量纲的；不需要单位表达式。",
            "solution": "题目陈述经过严格审查，认定是有效的。这是一个在统计机器学习领域，特别是高斯过程回归中的良构问题，具有自洽、科学合理且明确的设定。所有必要的数据和定义都已提供，并且没有矛盾或事实错误。\n\n任务是计算高斯过程（GP）模拟器在新输入点 $\\mathbf{x}_{*}$ 处的后验预测均值。我们首先从第一性原理出发推导预测均值的表达式。\n\nGP 是随机变量的集合，其中任意有限个随机变量都服从联合高斯分布。该模拟器由一个均值函数（假设为零）和一个协方差函数 $k(\\mathbf{x}, \\mathbf{x}')$ 定义。\n\n令 $\\mathbf{X} = \\{\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3\\}$ 为训练输入集，并令 $\\mathbf{f} = (f(\\mathbf{x}_1), f(\\mathbf{x}_2), f(\\mathbf{x}_3))^\\top$ 为在这些输入处的真实（潜在）模拟器输出向量。这些潜在函数值的先验是一个多元正态分布：\n$$\n\\mathbf{f} \\sim \\mathcal{N}(\\mathbf{0}, K)\n$$\n其中 $K$ 是格拉姆矩阵，其元素为 $K_{ij} = k(\\mathbf{x}_i, \\mathbf{x}_j)$。题目提供了这个矩阵：\n$$\nK=\\begin{pmatrix}\n1  0.8  0.6\\\\\n0.8  1  0.8\\\\\n0.6  0.8  1\n\\end{pmatrix}\n$$\n观测输出 $\\mathbf{y}$ 被假定为真实输出的带噪声版本，带有独立同分布的高斯噪声 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$，其中噪声方差为 $\\sigma^2=0.1$。因此，$\\mathbf{y} = \\mathbf{f} + \\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 I)$。观测输出 $\\mathbf{y}$ 的分布为：\n$$\n\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{0}, K + \\sigma^2 I)\n$$\n我们将带噪声观测的协方差矩阵表示为 $K_y = K + \\sigma^2 I$。\n\n我们感兴趣的是在新输入点 $\\mathbf{x}_{*}$ 处潜在函数值 $f_{*} = f(\\mathbf{x}_{*})$ 的预测分布。观测输出 $\\mathbf{y}$ 和新输出 $f_{*}$ 的联合分布也是一个多元高斯分布：\n$$\n\\begin{pmatrix} \\mathbf{y} \\\\ f_{*} \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\mathbf{0} \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} K_y  \\mathbf{k}_{*} \\\\ \\mathbf{k}_{*}^{\\top}  k_{**} \\end{pmatrix} \\right)\n$$\n其中 $\\mathbf{k}_{*} = (k(\\mathbf{x}_{*}, \\mathbf{x}_1), k(\\mathbf{x}_{*}, \\mathbf{x}_2), k(\\mathbf{x}_{*}, \\mathbf{x}_3))^\\top$ 是新点与训练点之间的协方差向量，而 $k_{**} = k(\\mathbf{x}_{*}, \\mathbf{x}_{*})$ 是新点处的先验方差。\n\n使用条件高斯分布的标准公式，后验预测分布 $p(f_{*}|\\mathbf{y}, \\mathbf{X}, \\mathbf{x}_{*})$ 是一个均值为 $\\bar{f}_{*}$、方差为 $\\text{var}(f_{*})$ 的高斯分布。后验预测均值由下式给出：\n$$\n\\bar{f}_{*} = \\mathbb{E}[f_{*} | \\mathbf{y}] = \\mathbf{k}_{*}^{\\top} K_y^{-1} \\mathbf{y}\n$$\n这个表达式是从多元正态分布的第一性原理推导出来的。题目要求通过首先求解满足 $K_y\\boldsymbol{\\alpha} = \\mathbf{y}$ 的向量 $\\boldsymbol{\\alpha}$ 来计算这个量，这意味着 $\\boldsymbol{\\alpha} = K_y^{-1}\\mathbf{y}$。然后，预测均值计算为 $\\bar{f}_{*} = \\mathbf{k}_{*}^{\\top} \\boldsymbol{\\alpha}$。\n\n我们现在按照指定的计算步骤进行。\n\n**步骤 1：构建矩阵 $K_y$**\n给定 $K$、$\\sigma^2=0.1$ 以及 $3 \\times 3$ 的单位矩阵 $I$：\n$$\nK_y = K + \\sigma^2 I = \\begin{pmatrix}\n1  0.8  0.6\\\\\n0.8  1  0.8\\\\\n0.6  0.8  1\n\\end{pmatrix} + 0.1 \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n1.1  0.8  0.6\\\\\n0.8  1.1  0.8\\\\\n0.6  0.8  1.1\n\\end{pmatrix}\n$$\n\n**步骤 2 & 3：计算 Cholesky 因子并求解 $\\boldsymbol{\\alpha}$**\n问题要求我们求解线性系统 $K_y \\boldsymbol{\\alpha} = \\mathbf{y}$ 以得到 $\\boldsymbol{\\alpha}$。指定的方法包括计算 Cholesky 分解 $K_y = LL^\\top$，然后求解两个三角系统：通过前向替换求解 $L\\mathbf{v} = \\mathbf{y}$ 得到 $\\mathbf{v}$，以及通过后向替换求解 $L^\\top \\boldsymbol{\\alpha} = \\mathbf{v}$ 得到 $\\boldsymbol{\\alpha}$。\n\n待求解的线性系统是：\n$$\n\\begin{pmatrix}\n1.1  0.8  0.6\\\\\n0.8  1.1  0.8\\\\\n0.6  0.8  1.1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\alpha_1\\\\\n\\alpha_2\\\\\n\\alpha_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.25\\\\\n0.27\\\\\n0.25\n\\end{pmatrix}\n$$\n虽然 Cholesky 方法在数值上是稳健的，但对于这样的小型系统，我们也可以通过代数方法求解以找到精确解。我们写出方程组：\n1. $1.1\\alpha_1 + 0.8\\alpha_2 + 0.6\\alpha_3 = 0.25$\n2. $0.8\\alpha_1 + 1.1\\alpha_2 + 0.8\\alpha_3 = 0.27$\n3. $0.6\\alpha_1 + 0.8\\alpha_2 + 1.1\\alpha_3 = 0.25$\n\n观察方程 (1) 和 (3)，它们的右边相等。\n$1.1\\alpha_1 + 0.8\\alpha_2 + 0.6\\alpha_3 = 0.6\\alpha_1 + 0.8\\alpha_2 + 1.1\\alpha_3$\n$0.5\\alpha_1 = 0.5\\alpha_3 \\implies \\alpha_1 = \\alpha_3$。\n\n将 $\\alpha_3 = \\alpha_1$ 代入方程 (1) 和 (2)，得到一个关于 $\\alpha_1$ 和 $\\alpha_2$ 的简化系统：\n1'. $1.1\\alpha_1 + 0.8\\alpha_2 + 0.6\\alpha_1 = 0.25 \\implies 1.7\\alpha_1 + 0.8\\alpha_2 = 0.25$\n2'. $0.8\\alpha_1 + 1.1\\alpha_2 + 0.8\\alpha_1 = 0.27 \\implies 1.6\\alpha_1 + 1.1\\alpha_2 = 0.27$\n\n我们可以求解这个 $2 \\times 2$ 系统。将 (1') 乘以 $1.1$，将 (2') 乘以 $0.8$：\n$1.1 \\times (1.7\\alpha_1 + 0.8\\alpha_2) = 1.1 \\times 0.25 \\implies 1.87\\alpha_1 + 0.88\\alpha_2 = 0.275$\n$0.8 \\times (1.6\\alpha_1 + 1.1\\alpha_2) = 0.8 \\times 0.27 \\implies 1.28\\alpha_1 + 0.88\\alpha_2 = 0.216$\n\n用第一个新方程减去第二个新方程：\n$(1.87 - 1.28)\\alpha_1 = 0.275 - 0.216$\n$0.59\\alpha_1 = 0.059 \\implies \\alpha_1 = 0.1$。\n\n因为 $\\alpha_1 = \\alpha_3$，所以我们有 $\\alpha_3 = 0.1$。\n将 $\\alpha_1=0.1$ 代入方程 (1')：\n$1.7(0.1) + 0.8\\alpha_2 = 0.25$\n$0.17 + 0.8\\alpha_2 = 0.25$\n$0.8\\alpha_2 = 0.08 \\implies \\alpha_2 = 0.1$。\n\n因此，解向量为：\n$$\n\\boldsymbol{\\alpha} = \\begin{pmatrix} 0.1 \\\\ 0.1 \\\\ 0.1 \\end{pmatrix}\n$$\n执行基于 Cholesky 的求解会得到这个精确的向量。\n\n**步骤 4：计算预测均值 $\\bar{f}_{*}$。**\n预测均值通过内积 $\\bar{f}_{*} = \\mathbf{k}_{*}^{\\top} \\boldsymbol{\\alpha}$ 计算。\n给定 $\\mathbf{k}_{*} = \\begin{pmatrix}0.7\\\\0.7\\\\0.7\\end{pmatrix}$：\n$$\n\\bar{f}_{*} = \\begin{pmatrix}0.7  0.7  0.7\\end{pmatrix} \\begin{pmatrix} 0.1 \\\\ 0.1 \\\\ 0.1 \\end{pmatrix}\n$$\n$$\n\\bar{f}_{*} = (0.7)(0.1) + (0.7)(0.1) + (0.7)(0.1) = 0.07 + 0.07 + 0.07 = 0.21\n$$\n后验预测均值精确地为 $0.21$。题目要求答案四舍五入到四位有效数字。为了用四位有效数字表示 $0.21$，我们将其写为 $0.2100$。",
            "answer": "$$\n\\boxed{0.2100}\n$$"
        },
        {
            "introduction": "在了解了高斯过程如何进行预测之后，一个关键的实际问题是“它的计算成本是多少？”。本练习将理论与现实世界中时间和内存的限制联系起来，指导你从第一性原理推导出精确高斯过程训练的$O(n^3)$时间复杂度和$O(n^2)$内存复杂度。掌握这种分析能力对于任何建模者在项目开始时评估其可行性至关重要，确保计算预算能够支持所需的数据集规模 。",
            "id": "3888304",
            "problem": "一个研究小组正在为一个患者特异性机理模拟器构建一个高斯过程 (GP) 模拟器，以加速药代动力学建模中的不确定性量化。训练集由 $n$ 个模拟器输入-输出对组成。该模拟器使用一个精确高斯过程，其稠密协方差矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 是由一个平稳核应用于 $d$ 维空间中的 $n$ 个输入而构建的。学习目标是对数边缘似然，这需要计算 $\\ln|K+\\sigma^{2}I|$ 并求解以 $K+\\sigma^{2}I$ 为系数矩阵的线性系统，其中 $\\sigma^{2}>0$ 是一个已知的噪声方差。\n\n仅从以下基本依据出发：\n- 高斯过程后验和对数边缘似然的定义要求解一个线性系统并计算 $n \\times n$ 对称正定矩阵 $K+\\sigma^{2}I$ 的对数行列式。\n- 对于对称正定矩阵，稳定的精确稠密线性代数运算是通过 Cholesky 分解、三角求解以及为计算对数行列式而累加对角线元素来进行的。\n- 稠密矩阵的标准内存布局存储所有 $n^{2}$ 个元素。\n\n从第一性原理推导精确高斯过程训练关于 $n$ 的领头阶渐近时间复杂度和空间复杂度。然后，应用这些复杂度关系，根据以下实验室预算确定实际的数据集大小限制：\n- 持续双精度每秒浮点运算次数 (FLOPS) 吞吐量 $S = 5 \\times 10^{9}$。\n- 墙上时钟训练时间预算 $T_{\\max} = 1800$ 秒。\n- 可用随机存取存储器 (RAM) $M_{\\max} = 24$ 吉字节，其中 $1$ 吉字节 $=$ $10^{9}$ 字节。\n- 协方差矩阵以双精度稠密存储，每个元素 $8$ 字节，并进行原地 Cholesky 分解（不产生第二个完整的 $n \\times n$ 矩阵副本）。\n\n将主要算术成本建模为稠密 $n \\times n$ 对称正定矩阵的 Cholesky 分解，并忽略诸如核矩阵构建和向量运算等低阶成本。使用持续吞吐量 $S$ 将浮点运算次数转换为时间。使用稠密存储需求将矩阵大小转换为内存需求。计算同时满足时间和内存预算的最大整数 $n$。将最终的 $n$ 表示为无单位的计数。不需要按有效数字进行四舍五入；报告由预算所隐含的确切整数。",
            "solution": "该问题被评估为有效，因为它在科学上基于数值线性代数和机器学习的原理，提法得当，目标明确且信息充分，并使用客观、正式的语言。它代表了计算科学中一种标准的、实用的“封底估算”。\n\n解题过程分为两部分。首先，我们从第一性原理推导精确高斯过程 (GP) 训练的领头阶渐近时间复杂度和空间复杂度。其次，我们将这些推导出的复杂度应用于给定的预算限制，以找到最大实际数据集大小 $n$。\n\n**第一部分：时间与空间复杂度的推导**\n\n问题指出，GP 训练的核心计算任务是计算对数行列式 $\\ln|K+\\sigma^{2}I|$ 并求解涉及矩阵 $C = K+\\sigma^{2}I$ 的线性系统，其中 $C$ 是一个 $n \\times n$ 的对称正定矩阵。\n\n**空间复杂度**\n\n问题指明 $n \\times n$ 的协方差矩阵 $C$ 是稠密存储的。题目陈述内存布局“存储所有 $n^{2}$ 个元素”。每个元素是一个双精度浮点数，需要 $8$ 字节的存储空间。Cholesky 分解是原地执行的，这意味着不需要分配额外的 $n \\times n$ 矩阵。因此，总内存需求 $M(n)$ 由存储这一个矩阵决定。\n\n$M(n) = n^2 \\times (\\text{每个元素的字节数})$\n$M(n) = 8n^2 \\text{ 字节}$\n\n内存需求随数据点数量 $n$ 呈二次方增长。因此，领头阶渐近空间复杂度为 $O(n^2)$。\n\n**时间复杂度**\n\n问题将主要计算成本确定为稠密 $n \\times n$ 矩阵 $C$ 的 Cholesky 分解。该分解将 $C$ 分解为一个下三角矩阵 $L$ 与其转置 $L^T$ 的乘积，即 $C = LL^T$。我们根据算法步骤的定义来推导浮点运算 (FLOPs) 的次数。\n\n$L$ 的元素是逐列计算的。对于从 $1$ 到 $n$ 的每一列 $j$，满足 $i \\ge j$ 的元素 $L_{ij}$ 按如下方式计算：\n\n对于对角线元素 $L_{jj}$：\n$$L_{jj} = \\sqrt{C_{jj} - \\sum_{k=1}^{j-1} L_{jk}^2}$$\n求和 $\\sum_{k=1}^{j-1} L_{jk}^2$ 需要 $j-1$ 次乘法和 $j-2$ 次加法。之后是一次减法和一次平方根运算。将一次乘加运算对近似为 $2$ 次 FLOPs，则求和的成本约为 $2(j-1)$ FLOPs。\n\n对于非对角线元素 $L_{ij}$ (其中 $i > j$)：\n$$L_{ij} = \\frac{1}{L_{jj}} \\left( C_{ij} - \\sum_{k=1}^{j-1} L_{ik}L_{jk} \\right)$$\n求和 $\\sum_{k=1}^{j-1} L_{ik}L_{jk}$（一个点积）需要 $j-1$ 次乘法和 $j-2$ 次加法，总计约 $2(j-1)$ FLOPs。之后是一次减法和一次除法。因此，每个 $L_{ij}$ 的计算成本约为 $2j-1$ FLOPs。\n\n总 FLOPs 次数是所有列 $j=1, \\dots, n$ 的成本之和。对于每一列 $j$，我们计算一个对角线元素 $L_{jj}$ 和 $n-j$ 个非对角线元素 $L_{ij}$。\n\n总成本约为：\n$$ \\text{总 FLOPs} \\approx \\sum_{j=1}^{n} \\left[ 2(j-1) + (n-j)(2j-1) \\right] $$\n我们关心的是大 $n$ 情况下的领头阶。求和式中的主导项是 $(n-j)(2j) = 2nj - 2j^2$。\n$$ \\text{总 FLOPs} \\approx \\sum_{j=1}^{n} (2nj - 2j^2) = 2n \\sum_{j=1}^{n} j - 2 \\sum_{j=1}^{n} j^2 $$\n使用前 $n$ 个整数和平方和的标准公式（对于大 $n$，$\\sum_{j=1}^{n} j = \\frac{n(n+1)}{2} \\approx \\frac{n^2}{2}$ 且 $\\sum_{j=1}^{n} j^2 = \\frac{n(n+1)(2n+1)}{6} \\approx \\frac{n^3}{3}$），我们得到：\n$$ \\text{总 FLOPs} \\approx 2n \\left(\\frac{n^2}{2}\\right) - 2 \\left(\\frac{n^3}{3}\\right) = n^3 - \\frac{2}{3}n^3 = \\frac{1}{3}n^3 $$\n这是稠密 Cholesky 分解计算成本的标准结果。随后的三角求解（$O(n^2)$）和对数行列式计算（$O(n)$）的成本是低阶的，根据问题陈述可以忽略。因此，训练精确 GP 的领头阶时间复杂度是 $O(n^3)$。\n\n**第二部分：应用于预算限制**\n\n现在我们使用推导出的复杂度关系来计算满足给定时间和内存预算的最大数据集大小 $n$。\n\n**时间限制**\n\n可用的总浮点运算次数 $N_{ops}$ 是持续吞吐量 $S$ 和最大时间 $T_{\\max}$ 的乘积。\n$N_{ops} = S \\times T_{\\max} = (5 \\times 10^9 \\text{ FLOPS}) \\times (1800 \\text{ s}) = 9 \\times 10^{12} \\text{ FLOPs}$\n我们将所需的操作次数设为小于或等于此预算：\n$$\\frac{1}{3}n^3 \\leq N_{ops}$$\n$$n^3 \\leq 3 \\times (9 \\times 10^{12}) = 27 \\times 10^{12}$$\n求解 $n$，我们找到受时间限制的最大大小 $n_{\\text{time}}$：\n$n_{\\text{time}} \\leq \\sqrt[3]{27 \\times 10^{12}} = (\\sqrt[3]{27}) \\times (\\sqrt[3]{10^{12}}) = 3 \\times 10^4 = 30000$\n\n**内存限制**\n\n可用随机存取存储器为 $M_{\\max} = 24 \\text{ 吉字节} = 24 \\times 10^9 \\text{ 字节}$。\n存储矩阵所需的内存是 $M(n) = 8n^2$ 字节。我们将其设置为小于或等于可用内存：\n$$8n^2 \\leq M_{\\max}$$\n$$8n^2 \\leq 24 \\times 10^9$$\n$$n^2 \\leq \\frac{24 \\times 10^9}{8} = 3 \\times 10^9$$\n求解 $n$，我们找到受内存限制的最大大小 $n_{\\text{mem}}$：\n$$n_{\\text{mem}} \\leq \\sqrt{3 \\times 10^9} = \\sqrt{30 \\times 10^8} = 10^4\\sqrt{30}$$\n数值上，$\\sqrt{30} \\approx 5.477225575$。\n$$n_{\\text{mem}} \\leq 10^4 \\times 5.477225575 \\approx 54772.25$$\n因为 $n$ 必须是整数，所以最大值为 $n_{\\text{mem}} \\leq \\lfloor 54772.25 \\rfloor = 54772$。\n\n**综合限制**\n\n实际的数据集大小限制必须同时满足时间和内存限制。因此，最大允许的 $n$ 是每个限制所施加的上限中的较小者。\n$n_{\\max} = \\min(n_{\\text{time}}, n_{\\text{mem}})$\n$n_{\\max} = \\min(30000, 54772) = 30000$\n时间预算是对数据集大小更严格的限制。同时满足两个预算的最大整数 $n$ 是 $30000$。",
            "answer": "$$\\boxed{30000}$$"
        },
        {
            "introduction": "正如上一个练习所示，精确高斯过程的计算成本很高，因此明智地选择训练点至关重要。本练习深入探讨了“计算机实验设计”的原则，要求你在不同的设计策略（如拉丁超立方抽样和最大最小距离设计）之间做出选择。通过将设计的几何属性（如填充距离）与最小化模拟器不确定性的目标联系起来，你将学会如何在有限的计算预算下最大化信息收益 。",
            "id": "3888252",
            "problem": "一个机制性生物医学模拟器将一个 $6$ 维输入向量 $x \\in \\Omega = [0,1]^6$（六个无量纲、归一化的生理参数）映射到一个标量输出 $g(x)$，该输出代表稳态生物标志物浓度。该模拟器是确定性的且计算昂贵；您希望在 $N$ 次模拟器运行的固定预算内，构建一个高斯过程 (GP) 仿真器来近似 $\\Omega$ 上的 $g(x)$。\n\n假设一个零均值高斯过程 (GP) 先验，其具有各向异性平方指数协方差核\n$$\nk(x,x') \\;=\\; \\sigma^2 \\exp\\!\\left(-\\sum_{j=1}^6 \\frac{(x_j - x'_j)^2}{2\\,\\ell_j^2}\\right),\n$$\n其中 $\\sigma^2 > 0$ 且长度尺度 $(\\ell_1,\\ldots,\\ell_6)$ 通过一项预备研究已知，并满足 $\\ell_j \\in (0,1)$，例如 $\\ell = (0.15,\\,0.30,\\,0.25,\\,0.10,\\,0.20,\\,0.40)$。您计划从三个候选的 $N$ 点设计 $X = \\{x_i\\}_{i=1}^N \\subset \\Omega$ 中选择一个，每个设计都是在没有进行模拟器评估的情况下构建的：$X_{\\mathrm{LHS}}$ 通过拉丁超立方抽样 (LHS) 构建，$X_{\\mathrm{Sobol}}$ 通过加扰的 Sobol 低差异序列构建，以及 $X_{\\mathrm{maximin}}$ 通过优化最大最小准则构建。\n\n定义核诱导的加权范数 $\\|z\\|_{L^{-1}} = \\sqrt{\\sum_{j=1}^6 (z_j/\\ell_j)^2}$，其中 $L = \\mathrm{diag}(\\ell_1,\\ldots,\\ell_6)$，最小成对分离度为\n$$\nd_{\\min}(X) \\;=\\; \\min_{i\\neq j} \\,\\big\\|\\,L^{-1}(x_i - x_j)\\,\\big\\|_2,\n$$\n以及填充距离为\n$$\nh_{X,\\Omega} \\;=\\; \\sup_{x \\in \\Omega} \\;\\min_{x_i \\in X} \\,\\big\\|\\,L^{-1}(x - x_i)\\,\\big\\|_2.\n$$\n\n在运行模拟器之前，您必须从 $X_{\\mathrm{LHS}}$、$X_{\\mathrm{Sobol}}$ 和 $X_{\\mathrm{maximin}}$ 中选择一个设计，并且您正在寻找一个有原则的、仅基于几何的选择准则，该准则在理论上与在给定的各向异性核和预算下减少最坏情况下的 GP 后验不确定性相关联。在这种情况下，以下哪个决策规则最合理，并应用于在这三个候选设计中进行选择？\n\nA. 通过选择具有最大长度尺度加权最小分离度 $d_{\\min}(X)$ 的设计，来最小化核诱导度量下的填充距离 $h_{X,\\Omega}$；在实践中，如果 $X_{\\mathrm{maximin}}$ 在通过 $(\\ell_j)$ 重新缩放后实现了最大的 $d_{\\min}(X)$，则优先选择它。\n\nB. 选择 $X_{\\mathrm{Sobol}}$，因为低差异性对于任何核和任何 $(\\ell_j)$ 都能直接均匀地最小化 $\\Omega$ 上的 GP 后验方差，使其在固定预算下成为普适最优的选择。\n\nC. 选择 $X_{\\mathrm{LHS}}$，因为每个边际维度的分层意味着输入的近正交性，从而最大化 GP 协方差矩阵 $K$ 的行列式 $\\det(K)$，这普适地最小化了后验方差。\n\nD. 选择具有最大未缩放欧几里得最小成对距离 $\\min_{i\\neq j}\\|x_i-x_j\\|_2$ 的设计，忽略 $(\\ell_j)$，因为 GP 核是旋转不变的，并且绝对尺度不影响不确定性。",
            "solution": "问题陈述是有效的。它提出了一个用于高斯过程仿真的计算机实验设计中的标准、适定的问题。所有术语都是按常规定义的，并且其前提在科学上是合理的。\n\n目标是选择一个设计准则，以最小化高斯过程 (GP) 仿真器的最坏情况后验不确定性。在域 $\\Omega$ 上的最坏情况不确定性对应于最大后验预测方差 $\\sup_{x \\in \\Omega} \\mathbb{V}[g(x) | g(X)]$，其中 $X$ 是设计点集。在给定 $X$ 处的观测值的情况下，点 $x$ 处的后验方差由下式给出\n$$\n\\mathbb{V}[g(x) | g(X)] = k(x, x) - k(x, X)^\\top K^{-1} k(x, X)\n$$\n其中 $k(x, X)$ 是 $x$ 与 $X$ 中各点之间的协方差向量，$K$ 是设计点的协方差矩阵。由于 $k(x,x) = \\sigma^2$ 是常数，最小化最大后验方差等价于选择 $X$ 来最大化 $\\inf_{x \\in \\Omega} [k(x, X)^\\top K^{-1} k(x, X)]$。\n\n问题指定了一个各向异性平方指数核：\n$$\nk(x,x') \\;=\\; \\sigma^2 \\exp\\!\\left(-\\sum_{j=1}^6 \\frac{(x_j - x'_j)^2}{2\\,\\ell_j^2}\\right)\n$$\n这可以使用提供的核诱导范数来表示：\n$$\nk(x,x') \\;=\\; \\sigma^2 \\exp\\!\\left(-\\frac{1}{2}\\big\\|L^{-1}(x-x')\\big\\|_2^2\\right)\n$$\n其中 $L = \\mathrm{diag}(\\ell_1, \\ldots, \\ell_6)$。这个公式表明，两点之间的协方差是在一个变换后的输入空间中它们之间欧几里得距离的函数，其中每个坐标轴 $j$ 都被缩放了 $1/\\ell_j$。较小的长度尺度 $\\ell_j$ 意味着函数对第 $j$ 维的变化更敏感，在核的视角下有效地“拉伸”了该维度。\n\n对于像平方指数核这样的平稳核，有已建立的理论界限将最大后验方差与设计 $X$ 的几何形状联系起来。具体来说，最大后验方差是填充距离 $h_{X,\\Omega}$ 的单调递增函数。填充距离衡量设计中最大的“间隙”，即域中不包含任何设计点的最大可能球体的半径。为了最小化最大（最坏情况）后验误差，必须选择一个能最小化填充距离的设计。关键是，这个距离必须在由核诱导的度量中测量，这正是问题中定义的度量：$\\big\\|L^{-1}(x - x_i)\\big\\|_2$。\n\n直接最小化填充距离 $h_{X,\\Omega}$ 在计算上是困难的。一个常用且有理论依据的替代方法是最大化设计点之间的最小分离距离 $d_{\\min}(X)$。一种最大化最小点间距离的设计，称为“最大最小”设计，往往具有高度的空间填充性，因此表现出较小的填充距离。其逻辑是，通过迫使点彼此分开，它们被迫散布在整个域中，不留下大的间隙。因此，一个用于最小化最坏情况误差的有原则的、仅基于几何的准则是选择能够最大化 $d_{\\min}(X) = \\min_{i\\neq j} \\,\\big\\|\\,L^{-1}(x_i - x_j)\\,\\big\\|_2$ 的设计。\n\n现在，我们基于这一原则评估每个选项。\n\nA. 这个陈述与我们的推导完全一致。它正确地将最小化填充距离 $h_{X,\\Omega}$（在正确的度量下）确定为理论目标。它提出最大化最小分离度 $d_{\\min}(X)$（在同样正确的度量下）作为实践策略。最后，它指出 $X_{\\mathrm{maximin}}$ 设计，根据其构造本身，就是为了在该准则下达到最优，因此很可能是最佳选择。具体步骤是，使用已知的 $\\ell_j$ 值为所有三个候选设计计算 $d_{\\min}(X)$，并选择具有最大值的那个设计。这是最合理的方法。**正确**。\n\nB. 这个陈述是不正确的。低差异序列是为了最小化数值积分（准蒙特卡洛方法）中的误差而设计的。在 GP 的背景下，这关系到最小化*积分*后验方差 $\\int_{\\Omega} \\mathbb{V}[g(x)|g(X)]dx$，而不是*最大*后验方差。此外，一个设计的最优性高度依赖于核及其长度尺度。没有单一的设计策略对于任何核和任何 $(\\ell_j)$ 都是“普适最优”的。其声称“均匀地”最小化方差也是错误的。**不正确**。\n\nC. 这个陈述是不正确的。虽然 LHS 设计具有良好的投影特性，但并不能保证这会导致 $\\det(K)$ 最大化。更重要的是，最大化 $\\det(K)$ 是一个设计准则（有时称为 D-最优性），它与最小化后验不确定性椭球的对数体积或最大化关于函数参数的信息增益有关。与低差异性一样，该准则更密切地关系到*积分*方差，而非*最大*方差。一个具有大 $\\det(K)$ 的设计可能有点聚集在一起（以减少它们的相关性），从而留下大的空白区域，这会导致这些区域的后验方差很高。其普适最优性的说法也是错误的。**不正确**。\n\nD. 这个陈述包含几个基本错误。核心缺陷是“忽略 $(\\ell_j)$”。长度尺度定义了问题的各向异性，并且对于定义相关几何至关重要。忽略它们意味着将所有输入维度视为同等重要，这与给定的各向异性核相矛盾。“GP 核是旋转不变的”这一说法仅对*各向同性*核（其中所有 $\\ell_j$ 相等）成立。给定的核是明确的各向异性核，在原始空间中不是旋转不变的。“绝对尺度不影响不确定性”的说法显然是错误的；长度尺度 $\\ell_j$ 正是定义变化尺度并因此定义不确定性结构的参数。使用未缩放的度量将导致次优设计。**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}