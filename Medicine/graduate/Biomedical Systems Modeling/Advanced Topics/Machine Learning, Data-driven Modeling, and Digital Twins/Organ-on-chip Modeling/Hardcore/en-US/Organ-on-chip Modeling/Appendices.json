{
    "hands_on_practices": [
        {
            "introduction": "Building a robust organ-on-chip model begins with a firm grasp of the underlying physical principles governing fluid flow and mass transport. This first exercise provides a foundational analysis using dimensionless numbers to characterize the operating regime of a typical microfluidic channel. By calculating the Reynolds ($Re$), Péclet ($Pe$), and Damköhler ($Da$) numbers, you will develop an intuition for the interplay between inertia, viscosity, convection, diffusion, and reaction, which is essential for making valid modeling assumptions .",
            "id": "4371134",
            "problem": "An organ-on-chip microfluidic channel is used to model solute transport and surface reaction at a perfused tissue interface. The channel can be represented by a straight conduit with hydraulic diameter $h$, carrying a Newtonian aqueous medium of density $\\rho$ and dynamic viscosity $\\mu$ at average axial velocity $U$. A solute of molecular diffusivity $D$ in the medium is transported from the bulk toward reactive walls that consume the solute via first-order surface kinetics with rate constant $k$ (units of $\\mathrm{s}^{-1}$) representing the intrinsic reaction timescale at the interface. Using the hydraulic diameter $h$ as the characteristic length, compute the following dimensionless groups from first principles: the Reynolds number (Re), the Péclet number (Pe), and the Damköhler number (Da), where Da should be defined as the ratio of the transverse diffusive timescale across $h$ to the first-order reaction timescale at the wall. Then, based on the magnitudes of these dimensionless numbers, briefly interpret the dominant transport regime in the channel in terms of inertia versus viscosity, convection versus diffusion, and reaction versus mass transport.\n\nUse the following parameter values: hydraulic diameter $h=150 \\times 10^{-6}\\,\\mathrm{m}$, average velocity $U=5 \\times 10^{-3}\\,\\mathrm{m\\,s^{-1}}$, fluid density $\\rho=1000\\,\\mathrm{kg\\,m^{-3}}$, dynamic viscosity $\\mu=1 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}$, solute diffusivity $D=5 \\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$, and first-order surface reaction rate constant $k=5.0 \\times 10^{-2}\\,\\mathrm{s}^{-1}$. Express all dimensionless quantities as pure numbers and round each to four significant figures.",
            "solution": "The problem statement is critically validated and deemed to be self-contained, scientifically grounded, and well-posed. All required physical parameters, definitions, and boundary conditions are explicitly provided. The scenario described is a standard problem in transport phenomena relevant to microfluidics and bioengineering. No inconsistencies, ambiguities, or violations of physical principles are present. Thus, proceeding to a solution is warranted.\n\nThe problem asks for the calculation of three dimensionless groups—the Reynolds number ($\\text{Re}$), the Péclet number ($\\text{Pe}$), and the Damköhler number ($\\text{Da}$)—using the provided parameters, and an interpretation of the transport regime. The given parameters are:\nHydraulic diameter, $h=150 \\times 10^{-6}\\,\\mathrm{m}$\nAverage velocity, $U=5 \\times 10^{-3}\\,\\mathrm{m\\,s^{-1}}$\nFluid density, $\\rho=1000\\,\\mathrm{kg\\,m^{-3}}$\nDynamic viscosity, $\\mu=1 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}$\nSolute diffusivity, $D=5 \\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}$\nFirst-order surface reaction rate constant, $k=5.0 \\times 10^{-2}\\,\\mathrm{s}^{-1}$\n\n1.  **Reynolds Number ($\\text{Re}$)**\nThe Reynolds number represents the ratio of inertial forces to viscous forces in a fluid. From first principles, the inertial force per unit volume in a fluid can be scaled from the convective acceleration term in the Navier-Stokes equation, $\\rho(\\mathbf{v}\\cdot\\nabla)\\mathbf{v}$, which scales as $\\rho U^2/h$. The viscous force per unit volume scales from the term $\\mu\\nabla^2\\mathbf{v}$, which scales as $\\mu U/h^2$. The ratio of these two scales gives the Reynolds number:\n$$\n\\text{Re} = \\frac{\\text{Inertial forces}}{\\text{Viscous forces}} \\sim \\frac{\\rho U^2 / h}{\\mu U / h^2} = \\frac{\\rho U h}{\\mu}\n$$\nSubstituting the given values:\n$$\n\\text{Re} = \\frac{(1000\\,\\mathrm{kg\\,m^{-3}})(5 \\times 10^{-3}\\,\\mathrm{m\\,s^{-1}})(150 \\times 10^{-6}\\,\\mathrm{m})}{1 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}} = \\frac{7.5 \\times 10^{-4}}{1 \\times 10^{-3}} = 0.75\n$$\nRounding to four significant figures, $\\text{Re} = 0.7500$.\n\n2.  **Péclet Number ($\\text{Pe}$)**\nThe Péclet number for mass transport compares the rate of advective (convective) transport to the rate of diffusive transport. The characteristic time for a solute to be transported by convection over a length $h$ is $\\tau_{\\text{conv}} \\sim h/U$. The characteristic time for a solute to diffuse across the same length $h$ is $\\tau_{\\text{diff}} \\sim h^2/D$. The Péclet number is the ratio of the diffusive timescale to the convective timescale:\n$$\n\\text{Pe} = \\frac{\\tau_{\\text{diff}}}{\\tau_{\\text{conv}}} = \\frac{h^2/D}{h/U} = \\frac{U h}{D}\n$$\nSubstituting the given values:\n$$\n\\text{Pe} = \\frac{(5 \\times 10^{-3}\\,\\mathrm{m\\,s^{-1}})(150 \\times 10^{-6}\\,\\mathrm{m})}{5 \\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}} = \\frac{7.5 \\times 10^{-7}}{5 \\times 10^{-10}} = 1500\n$$\nTo four significant figures, $\\text{Pe} = 1.500 \\times 10^3$.\n\n3.  **Damköhler Number ($\\text{Da}$)**\nThe problem explicitly defines the Damköhler number as the ratio of the transverse diffusive timescale across $h$ to the first-order reaction timescale at the wall.\nThe transverse diffusive timescale is, as defined before, $\\tau_{\\text{diff}} = h^2/D$.\nThe characteristic timescale for a first-order reaction is the inverse of the rate constant, $\\tau_{\\text{rxn}} = 1/k$.\nTherefore, the Damköhler number is:\n$$\n\\text{Da} = \\frac{\\tau_{\\text{diff}}}{\\tau_{\\text{rxn}}} = \\frac{h^2/D}{1/k} = \\frac{k h^2}{D}\n$$\nSubstituting the given values:\n$$\n\\text{Da} = \\frac{(5.0 \\times 10^{-2}\\,\\mathrm{s}^{-1})(150 \\times 10^{-6}\\,\\mathrm{m})^2}{5 \\times 10^{-10}\\,\\mathrm{m^{2}\\,s^{-1}}} = \\frac{(5.0 \\times 10^{-2})(2.25 \\times 10^{-8})}{5 \\times 10^{-10}} = \\frac{1.125 \\times 10^{-9}}{5 \\times 10^{-10}} = 2.25\n$$\nRounding to four significant figures, $\\text{Da} = 2.250$.\n\n**Interpretation of Transport Regime**\n\n*   **Inertia vs. Viscosity ($\\text{Re} = 0.7500$):** Since $\\text{Re}  1$, viscous forces are dominant over inertial forces. This signifies that the flow is laminar and falls into the creeping flow (or Stokes flow) regime. The fluid motion is smooth and orderly, which is typical for microfluidic systems.\n\n*   **Convection vs. Diffusion ($\\text{Pe} = 1.500 \\times 10^3$):** Since $\\text{Pe} \\gg 1$, mass transport is strongly dominated by convection in the direction of flow. The solute is carried downstream by the bulk fluid motion much more rapidly than it spreads out by molecular diffusion. This leads to the formation of a thin concentration boundary layer near the reactive walls.\n\n*   **Reaction vs. Mass Transport ($\\text{Da} = 2.250$):** This Damköhler number compares the characteristic time of diffusion to the characteristic time of reaction. Since $\\text{Da}  1$ (specifically, $2.250$), the time required for diffusion to the wall is longer than the time required for the reaction to occur. This implies that the reaction is fast relative to the transport of solute to the surface. Consequently, the overall process is **mass-transport-limited** (or diffusion-limited). The rate of solute consumption is controlled by how quickly the solute can diffuse across the boundary layer to the reactive wall, rather than by the intrinsic kinetics of the surface reaction. This will result in a significant depletion of the solute concentration near the wall.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.7500  1.500 \\times 10^3  2.250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "All mathematical models are simplifications of a more complex reality, and a key skill for any modeler is to understand the limitations imposed by these simplifications. This practice challenges you to quantify the consequences of a common simplification in OOC models: the omission of a key biological pathway. By analyzing a lung-on-chip model that neglects immune cell feedback, you will derive and apply a \"missing-mechanism bias\" factor to determine the conditions under which the simplified model remains acceptably accurate, a critical step in defining a model's predictive domain .",
            "id": "3915591",
            "problem": "Consider a microfluidic lung-on-chip epithelial compartment that secretes a proinflammatory cytokine, modeled as an interleukin concentration $c(t)$ in the effluent. The microchannel has perfusion volumetric flow rate $Q$ and fluid volume $V$, inducing convective clearance. Assume first-order intracellular degradation with rate constant $k$. Let an external agonist stimulus of concentration $S$ drive saturable epithelial cytokine production with maximal rate $p_{1}$ and half-saturation constant $K_{S}$. The measured inflammatory response is the steady-state effluent cytokine concentration.\n\nYou are told that a computational model lacking immune cells uses the steady-state mass balance based on conservation under flow and first-order kinetics for $c(t)$:\n$$\n\\frac{dc}{dt} = p_{0} + \\frac{p_{1}\\,S}{K_{S}+S} - \\left(k + \\frac{Q}{V}\\right)c,\n$$\nwith baseline epithelial production $p_{0} \\approx 0$. The true system includes an immune-cell-mediated positive production feedback that is saturable with respect to $c$, adding a term $\\alpha \\,\\frac{c}{K_{c}+c}$, where $\\alpha$ is the maximal immune-mediated production rate and $K_{c}$ is the feedback half-saturation constant. The true mass balance is thus\n$$\n\\frac{dc}{dt} = p_{0} + \\frac{p_{1}\\,S}{K_{S}+S} + \\alpha \\,\\frac{c}{K_{c}+c} - \\left(k + \\frac{Q}{V}\\right)c.\n$$\n\nDefine the missing-mechanism bias as the multiplicative underprediction factor at steady state,\n$$\nB(S) \\equiv \\frac{c_{\\text{true}}(S)}{c_{\\text{model}}(S)},\n$$\nwhere $c_{\\text{model}}(S)$ is the epithelial-only steady state and $c_{\\text{true}}(S)$ is the immune-inclusive steady state.\n\nUsing the model structure above and the following scientifically plausible parameter values consistent with microfluidic organ-on-chip practice,\n- $p_{0} = 0$,\n- $p_{1} = 60\\,\\mathrm{ng\\,mL^{-1}\\,h^{-1}}$,\n- $K_{S} = 15\\,\\mathrm{ng\\,mL^{-1}}$,\n- $k = 0.5\\,\\mathrm{h^{-1}}$,\n- $\\frac{Q}{V} = 1.5\\,\\mathrm{h^{-1}}$,\n- $\\alpha = 20\\,\\mathrm{ng\\,mL^{-1}\\,h^{-1}}$,\n- $K_{c} = 40\\,\\mathrm{ng\\,mL^{-1}}$,\n\nstart from mass conservation and steady-state conditions to derive $B(S)$ in terms of the parameters and $S$. Then formalize an acceptability criterion for extrapolation in the absence of immune cells as $B(S) \\le \\tau$, with $\\tau = 1.20$, meaning the epithelial-only model underpredicts by no more than $0.20$ in multiplicative factor. Determine the minimal agonist concentration $S_{\\min}$ (in $\\mathrm{ng\\,mL^{-1}}$) such that the criterion $B(S) \\le 1.20$ is satisfied. Express your final $S_{\\min}$ in $\\mathrm{ng\\,mL^{-1}}$ and round your answer to four significant figures.\n\nAll reasoning must begin from the mass balance and steady-state definitions given above and must not invoke any shortcut formula not derived from these principles. Ensure your derivation is scientifically self-consistent and uses only the information provided here.",
            "solution": "The problem requires the determination of the minimal agonist concentration $S_{\\min}$ for which a simplified epithelial-only model of cytokine concentration is acceptably accurate compared to a more complete model that includes immune cell feedback. The acceptability criterion is defined by a multiplicative bias factor $B(S)$ being less than or equal to a threshold $\\tau$.\n\nThe first step is to formalize the steady-state concentrations for both the simplified model and the true system. We are given the governing differential equations for the cytokine concentration $c(t)$. At steady state, the rate of change of concentration is zero, i.e., $\\frac{dc}{dt} = 0$.\n\nLet's define a total clearance rate constant, $k_{cl}$, as the sum of the intracellular degradation rate $k$ and the convective clearance rate $\\frac{Q}{V}$.\n$$k_{cl} = k + \\frac{Q}{V}$$\nUsing the provided values, $k = 0.5\\,\\mathrm{h^{-1}}$ and $\\frac{Q}{V} = 1.5\\,\\mathrm{h^{-1}}$, we have:\n$$k_{cl} = 0.5 + 1.5 = 2.0\\,\\mathrm{h^{-1}}$$\nLet's also define the stimulus-dependent production rate from the epithelium, $P(S)$, as:\n$$P(S) = p_{0} + \\frac{p_{1}S}{K_{S}+S}$$\nGiven $p_{0} = 0$, this simplifies to:\n$$P(S) = \\frac{p_{1}S}{K_{S}+S}$$\n\nFor the simplified epithelial-only model, the steady-state concentration, denoted as $c_{\\text{model}}(S)$, is found by setting its governing equation to zero:\n$$0 = P(S) - k_{cl} c_{\\text{model}}(S)$$\nSolving for $c_{\\text{model}}(S)$ gives a linear relationship with the production term:\n$$c_{\\text{model}}(S) = \\frac{P(S)}{k_{cl}} = \\frac{1}{k_{cl}} \\frac{p_{1}S}{K_{S}+S}$$\n\nFor the true system, which includes immune-cell-mediated feedback, the steady-state concentration, denoted as $c_{\\text{true}}(S)$, is found by setting its governing equation to zero. Let $c = c_{\\text{true}}(S)$ for simplicity:\n$$0 = P(S) + \\frac{\\alpha c}{K_{c}+c} - k_{cl} c$$\nThis equation must be solved for $c$. Rearranging the terms, we get:\n$$k_{cl} c - \\frac{\\alpha c}{K_{c}+c} = P(S)$$\nTo solve for $c$, we can multiply by $(K_{c}+c)$ to clear the denominator:\n$$c \\left( k_{cl} - \\frac{\\alpha}{K_{c}+c} \\right) = P(S)$$\n$$c \\frac{k_{cl}(K_{c}+c) - \\alpha}{K_{c}+c} = P(S)$$\n$$k_{cl}c(K_{c}+c) - \\alpha c = P(S)(K_{c}+c)$$\n$$k_{cl}K_{c}c + k_{cl}c^2 - \\alpha c = P(S)K_{c} + P(S)c$$\nArranging this into the standard form of a quadratic equation, $Ax^2+Bx+C=0$, for $c$:\n$$k_{cl}c^2 + (k_{cl}K_{c} - \\alpha - P(S))c - P(S)K_{c} = 0$$\nThis quadratic equation determines the true steady-state concentration $c_{\\text{true}}(S)$.\n\nThe missing-mechanism bias is defined as $B(S) = \\frac{c_{\\text{true}}(S)}{c_{\\text{model}}(S)}$. We can derive an equation for $B(S)$ directly. From the steady-state equation for the true system:\n$$k_{cl} c_{\\text{true}} = P(S) + \\frac{\\alpha c_{\\text{true}}}{K_{c}+c_{\\text{true}}}$$\nDividing by $k_{cl}$ and substituting $P(S) = k_{cl}c_{\\text{model}}$:\n$$c_{\\text{true}} = c_{\\text{model}} + \\frac{\\alpha}{k_{cl}} \\frac{c_{\\text{true}}}{K_{c}+c_{\\text{true}}}$$\nNow, we divide by $c_{\\text{model}}$:\n$$\\frac{c_{\\text{true}}}{c_{\\text{model}}} = 1 + \\frac{\\alpha}{k_{cl}c_{\\text{model}}} \\frac{c_{\\text{true}}}{K_{c}+c_{\\text{true}}}$$\nSubstituting $B(S) = \\frac{c_{\\text{true}}}{c_{\\text{model}}}$ and $c_{\\text{true}} = B(S)c_{\\text{model}}$:\n$$B(S) = 1 + \\frac{\\alpha}{k_{cl}c_{\\text{model}}} \\frac{B(S)c_{\\text{model}}}{K_{c}+B(S)c_{\\text{model}}}$$\n$$B(S) - 1 = \\frac{\\alpha B(S)}{k_{cl}(K_{c}+B(S)c_{\\text{model}})}$$\nRearranging to solve for parameters at a given $B(S)$ value:\n$$(B(S) - 1) k_{cl} (K_{c} + B(S)c_{\\text{model}}) = \\alpha B(S)$$\n$$c_{\\text{model}} B(S)^2 (B(S)-1)k_{cl} + (B(S)-1)k_{cl}K_c = \\alpha B(S)$$\nIt is more direct to rearrange the equation into a quadratic in $B(S)$:\n$$(B(S)-1)(K_c + B(S)c_{\\text{model}}) = \\frac{\\alpha}{k_{cl}} B(S)$$\n$$B(S)K_c + B(S)^2 c_{\\text{model}} - K_c - B(S)c_{\\text{model}} = \\frac{\\alpha}{k_{cl}} B(S)$$\n$$c_{\\text{model}}(S) B(S)^2 + \\left( K_{c} - c_{\\text{model}}(S) - \\frac{\\alpha}{k_{cl}} \\right) B(S) - K_{c} = 0$$\nThis equation implicitly defines $B(S)$ as a function of $S$ through $c_{\\text{model}}(S)$.\n\nThe problem specifies an acceptability criterion $B(S) \\le \\tau$, where $\\tau = 1.20$. We need to find the minimal $S$ that satisfies this. Let's analyze the behavior of $B(S)$. As $S \\to 0$, $c_{\\text{model}}(S) \\to 0$. The quadratic equation for $B$ becomes:\n$$\\left( K_c - \\frac{\\alpha}{k_{cl}} \\right) B(0) - K_c \\approx 0 \\implies B(0) = \\frac{K_c}{K_c - \\alpha/k_{cl}}$$\nNumerically, $B(0) = \\frac{40}{40 - 20/2.0} = \\frac{40}{30} = \\frac{4}{3} \\approx 1.333$.\nAs $S \\to \\infty$, $c_{\\text{model}}(S) \\to \\frac{p_1}{k_{cl}} = \\frac{60}{2.0} = 30$. The equation for $B$ becomes:\n$$30 B(\\infty)^2 + (40 - 30 - 10)B(\\infty) - 40 = 0 \\implies 30 B(\\infty)^2 - 40 = 0$$\n$$B(\\infty) = \\sqrt{\\frac{40}{30}} = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}} \\approx 1.155$$\nSince $B(0) \\approx 1.333 > 1.20$ and $B(\\infty) \\approx 1.155  1.20$, and $B(S)$ is a monotonically decreasing function of $S$ (as $c_{\\text{model}}$ increases with $S$), there exists a unique value $S_{\\min}$ where $B(S_{\\min}) = \\tau$. For all $S>S_{\\min}$, the criterion $B(S)  \\tau$ will be met. Thus, we must solve for $S$ when $B(S) = \\tau$.\n\nFirst, we find the required value of $c_{\\text{model}}$, let's call it $c_{\\text{model}}^*$, that corresponds to $B(S)=\\tau$:\n$$c_{\\text{model}}^* \\tau^2 + \\left( K_{c} - c_{\\text{model}}^* - \\frac{\\alpha}{k_{cl}} \\right) \\tau - K_{c} = 0$$\nWe solve for $c_{\\text{model}}^*$:\n$$c_{\\text{model}}^*(\\tau^2 - \\tau) = K_c - \\tau\\left(K_c - \\frac{\\alpha}{k_{cl}}\\right)$$\n$$c_{\\text{model}}^*\\tau(\\tau - 1) = K_c(1 - \\tau) + \\frac{\\alpha\\tau}{k_{cl}}$$\n$$c_{\\text{model}}^* = \\frac{K_c(1 - \\tau) + \\frac{\\alpha\\tau}{k_{cl}}}{\\tau(\\tau - 1)}$$\nSubstituting the parameter values: $\\tau=1.20$, $K_c=40$, $\\alpha=20$, $k_{cl}=2.0$:\n$$c_{\\text{model}}^* = \\frac{40(1 - 1.20) + \\frac{20 \\times 1.20}{2.0}}{1.20(1.20 - 1)} = \\frac{40(-0.20) + 12}{1.20(0.20)} = \\frac{-8 + 12}{0.24} = \\frac{4}{0.24} = \\frac{400}{24} = \\frac{50}{3}$$\nSo, $c_{\\text{model}}^* = \\frac{50}{3}\\,\\mathrm{ng\\,mL^{-1}}$.\n\nNext, we find the value of $S$, which is $S_{\\min}$, that yields this $c_{\\text{model}}^*$.\n$$c_{\\text{model}}^* = \\frac{1}{k_{cl}} \\frac{p_{1}S_{\\min}}{K_{S}+S_{\\min}}$$\n$$c_{\\text{model}}^* k_{cl} (K_S + S_{\\min}) = p_1 S_{\\min}$$\n$$c_{\\text{model}}^* k_{cl} K_S + c_{\\text{model}}^* k_{cl} S_{\\min} = p_1 S_{\\min}$$\n$$c_{\\text{model}}^* k_{cl} K_S = (p_1 - c_{\\text{model}}^* k_{cl}) S_{\\min}$$\n$$S_{\\min} = \\frac{c_{\\text{model}}^* k_{cl} K_S}{p_1 - c_{\\text{model}}^* k_{cl}}$$\nNow, we substitute the numerical values: $c_{\\text{model}}^* = \\frac{50}{3}$, $k_{cl}=2.0$, $K_S=15$, $p_1=60$.\nThe term $c_{\\text{model}}^* k_{cl} = \\frac{50}{3} \\times 2.0 = \\frac{100}{3}$.\n$$S_{\\min} = \\frac{\\left(\\frac{100}{3}\\right) \\times 15}{60 - \\frac{100}{3}}$$\n$$S_{\\min} = \\frac{\\frac{1500}{3}}{\\frac{180 - 100}{3}} = \\frac{500}{\\frac{80}{3}} = \\frac{500 \\times 3}{80} = \\frac{50 \\times 3}{8} = \\frac{150}{8} = \\frac{75}{4}$$\n$$S_{\\min} = 18.75$$\nThe unit is $\\mathrm{ng\\,mL^{-1}}$, consistent with $K_S$. The question asks for the answer to be rounded to four significant figures. The exact value $18.75$ has four significant figures.",
            "answer": "$$\\boxed{18.75}$$"
        },
        {
            "introduction": "A theoretical model becomes a practical tool only when its parameters can be determined from experimental data. This computational exercise addresses this crucial link by exploring the concept of parameter identifiability in a two-compartment OOC model. You will implement a forward sensitivity analysis to determine whether the model's kinetic parameters can be uniquely estimated from measurements of the lumen concentration, learning to diagnose and interpret one of the most common challenges in systems biology modeling .",
            "id": "3915575",
            "problem": "Consider an Organ-on-Chip (OOC) model where a solute is transported between a perfused microchannel lumen and an adjacent tissue compartment. The model adheres to conservation of mass for each compartment and first-order kinetics for exchange and degradation. Let $c_L(t)$ denote the solute concentration in the lumen and $c_T(t)$ denote the solute concentration in the tissue at time $t$. The volumetric washout in the lumen is modeled as a first-order loss with rate $q$, the bidirectional permeability exchange from lumen to tissue is parameterized by $k_{\\text{in}}$, the efflux from tissue back to lumen by $k_{\\text{out}}$, and tissue degradation by $k_{\\text{deg}}$. An external infusion adds solute to the lumen as a square pulse of constant rate $r_{\\text{in}}(t)$ over a finite duration. The governing system is\n$$\n\\frac{d c_L}{d t} = -(q + k_{\\text{in}})\\, c_L + k_{\\text{out}}\\, c_T + r_{\\text{in}}(t),\n\\quad\n\\frac{d c_T}{d t} = k_{\\text{in}}\\, c_L - (k_{\\text{out}} + k_{\\text{deg}})\\, c_T,\n$$\nwith initial condition $c_L(0) = 0$ and $c_T(0) = 0$. The infusion is $r_{\\text{in}}(t) = R_0$ for $0 \\le t \\le T_{\\text{in}}$ and $r_{\\text{in}}(t) = 0$ for $t  T_{\\text{in}}$.\n\nMeasurements are taken only in the lumen; define the measurement vector $\\mathbf{y} \\in \\mathbb{R}^m$ by $y_i = c_L(t_i)$ for specified times $\\{t_i\\}_{i=1}^m$. The parameter vector to be analyzed is $\\boldsymbol{\\theta} = [k_{\\text{in}}, k_{\\text{out}}, k_{\\text{deg}}]^\\top$. The sensitivity matrix $S \\in \\mathbb{R}^{m \\times p}$, with $p = 3$ parameters, is defined component-wise by\n$$\nS_{ij} = \\frac{\\partial y_i}{\\partial \\theta_j} = \\frac{\\partial c_L(t_i)}{\\partial \\theta_j}.\n$$\n\nTask:\n- Starting from conservation of mass and first-order kinetics, derive the forward sensitivity equations necessary to compute $S_{ij} = \\partial c_L(t_i)/\\partial \\theta_j$ for the model above. Use the chain rule and the Jacobian of the right-hand side with respect to the states and parameters.\n- Implement a numerically stable algorithm to compute the sensitivity matrix $S$ for each test case below by integrating the coupled system for the states and their forward sensitivities at the measurement times.\n- Perform a local identifiability analysis by computing the rank of $S$ for each test case. A parameter vector $\\boldsymbol{\\theta}$ is locally identifiable at the given measurement times if and only if $\\mathrm{rank}(S) = p$.\n- For each test case, output two quantities: the integer $\\mathrm{rank}(S)$ and a boolean indicating local identifiability at the given times.\n\nUse the following constants and test suite. All rates are in $\\mathrm{s}^{-1}$ and times are in $\\mathrm{s}$; the infusion rate $R_0$ is in the same concentration-per-time units as $d c_L/d t$, and $T_{\\text{in}}$ is in $\\mathrm{s}$. Initial conditions are $c_L(0)=0$ and $c_T(0)=0$ in concentration units.\n\nFixed constant:\n- $q = 0.1$.\n\nTest suite (each case lists $(k_{\\text{in}}, k_{\\text{out}}, k_{\\text{deg}})$, $R_0$, $T_{\\text{in}}$, and measurement times $\\{t_i\\}$):\n1. Case A (general, informative sampling): $(0.06, 0.03, 0.01)$, $R_0 = 0.5$, $T_{\\text{in}} = 50$, times $\\{5, 10, 20, 40, 70, 100, 140, 200\\}$.\n2. Case B (edge case with insufficient measurements): $(0.06, 0.03, 0.01)$, $R_0 = 0.5$, $T_{\\text{in}} = 50$, times $\\{1, 2\\}$.\n3. Case C (boundary case with no excitation): $(0.06, 0.03, 0.01)$, $R_0 = 0$, $T_{\\text{in}} = 0$, times $\\{10, 20, 40, 80\\}$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[\\mathrm{rank}(S), \\text{identifiable}]$. For example, the output must look like:\n- $[[r_A, b_A],[r_B, b_B],[r_C, b_C]]$\nwhere $r_\\cdot$ are integers and $b_\\cdot$ are booleans.\n\nThe final output does not include physical units; it consists only of integers and booleans, as specified.",
            "solution": "The model equations embody conservation of mass and first-order kinetics in a two-compartment Organ-on-Chip (OOC) system. The lumen concentration $c_L(t)$ is decreased by washout proportional to $q$ and by influx into the tissue proportional to $k_{\\text{in}}$, is increased by efflux from the tissue proportional to $k_{\\text{out}}$, and is externally excited by the infusion $r_{\\text{in}}(t)$. The tissue concentration $c_T(t)$ is increased by influx from the lumen proportional to $k_{\\text{in}}$, decreased by efflux to the lumen proportional to $k_{\\text{out}}$, and decreased by degradation proportional to $k_{\\text{deg}}$. With initial conditions $c_L(0)=0$ and $c_T(0)=0$, the dynamics are\n$$\n\\frac{d}{dt} \\begin{bmatrix} c_L \\\\ c_T \\end{bmatrix}\n=\n\\begin{bmatrix}\n-(q + k_{\\text{in}})  k_{\\text{out}} \\\\\nk_{\\text{in}}  -(k_{\\text{out}} + k_{\\text{deg}})\n\\end{bmatrix}\n\\begin{bmatrix} c_L \\\\ c_T \\end{bmatrix}\n+\n\\begin{bmatrix} r_{\\text{in}}(t) \\\\ 0 \\end{bmatrix}.\n$$\n\nDefine the output mapping $y(t) = h(\\mathbf{x}(t), \\boldsymbol{\\theta}) = c_L(t)$ with $\\mathbf{x}(t) = [c_L(t), c_T(t)]^\\top$ and $\\boldsymbol{\\theta} = [k_{\\text{in}}, k_{\\text{out}}, k_{\\text{deg}}]^\\top$. The sensitivity matrix $S$ stacks the partial derivatives of $y$ at measurement times with respect to parameters:\n$$\nS_{ij} = \\frac{\\partial y(t_i)}{\\partial \\theta_j} = \\frac{\\partial c_L(t_i)}{\\partial \\theta_j}.\n$$\n\nTo compute $S$, we employ forward sensitivity analysis. Let $\\mathbf{f}(\\mathbf{x}, \\boldsymbol{\\theta}, t)$ denote the right-hand side of the state equations:\n$$\n\\mathbf{f}(\\mathbf{x}, \\boldsymbol{\\theta}, t) =\n\\begin{bmatrix}\n-(q + k_{\\text{in}}) c_L + k_{\\text{out}} c_T + r_{\\text{in}}(t) \\\\\nk_{\\text{in}} c_L - (k_{\\text{out}} + k_{\\text{deg}}) c_T\n\\end{bmatrix}.\n$$\nThe Jacobian with respect to the states is\n$$\n\\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}(\\mathbf{x}, \\boldsymbol{\\theta}, t) =\n\\begin{bmatrix}\n-(q + k_{\\text{in}})  k_{\\text{out}} \\\\\nk_{\\text{in}}  -(k_{\\text{out}} + k_{\\text{deg}})\n\\end{bmatrix},\n$$\nand the partial derivatives of $\\mathbf{f}$ with respect to each parameter, treating $\\mathbf{x}$ as constant, are\n$$\n\\frac{\\partial \\mathbf{f}}{\\partial k_{\\text{in}}} =\n\\begin{bmatrix}\n- c_L \\\\ + c_L\n\\end{bmatrix}, \\quad\n\\frac{\\partial \\mathbf{f}}{\\partial k_{\\text{out}}} =\n\\begin{bmatrix}\n+ c_T \\\\ - c_T\n\\end{bmatrix}, \\quad\n\\frac{\\partial \\mathbf{f}}{\\partial k_{\\text{deg}}} =\n\\begin{bmatrix}\n0 \\\\ - c_T\n\\end{bmatrix}.\n$$\n\nThe forward sensitivity vectors $\\mathbf{s}^{(j)}(t) = \\frac{\\partial \\mathbf{x}(t)}{\\partial \\theta_j} \\in \\mathbb{R}^2$ satisfy, by differentiating the state equations with respect to $\\theta_j$ and applying the chain rule,\n$$\n\\frac{d \\mathbf{s}^{(j)}}{d t} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}\\, \\mathbf{s}^{(j)} + \\frac{\\partial \\mathbf{f}}{\\partial \\theta_j},\n\\quad \\mathbf{s}^{(j)}(0) = \\frac{\\partial \\mathbf{x}(0)}{\\partial \\theta_j} = \\mathbf{0},\n$$\nsince the initial conditions do not depend on parameters. The output sensitivity at time $t$ for parameter $\\theta_j$ is\n$$\n\\frac{\\partial y(t)}{\\partial \\theta_j} = \\frac{\\partial h}{\\partial \\mathbf{x}} \\, \\mathbf{s}^{(j)}(t) + \\frac{\\partial h}{\\partial \\theta_j} = [1, 0] \\, \\mathbf{s}^{(j)}(t),\n$$\nbecause $h(\\mathbf{x}, \\boldsymbol{\\theta}) = c_L$ depends only on $c_L$ and not explicitly on $\\boldsymbol{\\theta}$.\n\nAlgorithmic steps:\n- For each test case, define parameters $(q, k_{\\text{in}}, k_{\\text{out}}, k_{\\text{deg}})$, infusion $(R_0, T_{\\text{in}})$, and measurement times $\\{t_i\\}$.\n- Construct the augmented system comprising the original states $\\mathbf{x}$ and three sensitivity vectors $\\mathbf{s}^{(1)}, \\mathbf{s}^{(2)}, \\mathbf{s}^{(3)}$, yielding an $8$-dimensional system:\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\nc_L \\\\ c_T \\\\\ns^{(1)}_L \\\\ s^{(1)}_T \\\\\ns^{(2)}_L \\\\ s^{(2)}_T \\\\\ns^{(3)}_L \\\\ s^{(3)}_T\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\text{state derivatives as above} \\\\\n\\text{sensitivity derivatives as above for each parameter}\n\\end{bmatrix},\n$$\nwith zero initial conditions for all sensitivities.\n- Integrate the augmented system from $t=0$ to $\\max_i t_i$ and evaluate at the specified $\\{t_i\\}$.\n- Form $S \\in \\mathbb{R}^{m \\times 3}$ with columns\n$$\nS_{\\cdot,1} = \\left[ s^{(1)}_L(t_1), \\ldots, s^{(1)}_L(t_m) \\right]^\\top, \\quad\nS_{\\cdot,2} = \\left[ s^{(2)}_L(t_1), \\ldots, s^{(2)}_L(t_m) \\right]^\\top, \\quad\nS_{\\cdot,3} = \\left[ s^{(3)}_L(t_1), \\ldots, s^{(3)}_L(t_m) \\right]^\\top.\n$$\n- Compute $\\mathrm{rank}(S)$ via singular value decomposition and declare local identifiability if $\\mathrm{rank}(S) = 3$.\n\nInterpretation for the provided test cases:\n- Case A includes an excitation ($R_0  0$) and a diverse set of early, middle, and late measurement times, which typically yields a full-rank sensitivity matrix because parameters $k_{\\text{in}}$, $k_{\\text{out}}$, and $k_{\\text{deg}}$ influence transient and asymptotic behaviors differently. Therefore, $\\mathrm{rank}(S)$ is expected to be $3$, indicating local identifiability at those times.\n- Case B has only two measurement times while there are three parameters ($p=3$). Even with excitation, an $m \\times p$ matrix with $m=2$ cannot have rank $3$, so $\\mathrm{rank}(S) \\le 2  3$, and local identifiability fails for this sampling.\n- Case C has no excitation ($R_0 = 0$) and zero initial conditions, so the state remains at zero for all times. The sensitivities remain zero due to the homogeneous sensitivity equations with zero forcing, yielding $S = 0$, $\\mathrm{rank}(S) = 0$, and no identifiability.\n\nThe program implements this procedure and outputs, for each case, the integer rank and a boolean indicating local identifiability.",
            "answer": "[[3,True],[2,False],[0,False]]"
        }
    ]
}