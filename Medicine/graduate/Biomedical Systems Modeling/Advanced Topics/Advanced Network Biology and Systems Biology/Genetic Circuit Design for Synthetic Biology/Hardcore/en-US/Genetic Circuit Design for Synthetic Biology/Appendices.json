{
    "hands_on_practices": [
        {
            "introduction": "Before we can design intricate genetic networks, we must first master the quantitative description of their fundamental component: a single, constitutively expressed gene. This foundational practice  involves constructing and solving a simple system of ordinary differential equations (ODEs) that model the central dogma. By calculating the steady-state concentrations of messenger RNA and protein, you will develop a core competency in modeling the basic input-output characteristics of a genetic part.",
            "id": "3888639",
            "problem": "A constitutive single-gene expression cassette in a bacterial cell line is modeled at the population-averaged concentration level under the assumptions of a well-mixed cytoplasm and exponential cell growth. Let $m(t)$ denote the concentration of messenger Ribonucleic Acid (mRNA) and $p(t)$ denote the concentration of protein. The system follows the central principle that, for each species, the rate of change of concentration equals production minus loss. Assume:\n- Transcription produces mRNA at a constant zeroth-order rate $k_{\\text{tx}}$ (per gene copy) in units of nanomolar per minute.\n- Translation produces protein at a first-order rate $k_{\\text{tl}} m(t)$, where $k_{\\text{tl}}$ has units of per minute and $m(t)$ is the mRNA concentration.\n- mRNA is removed by first-order biochemical degradation at rate $\\gamma_m m(t)$ and by dilution due to exponential cell growth at specific growth rate $\\mu$; the net first-order mRNA loss rate is $(\\gamma_m + \\mu) m(t)$.\n- Protein is removed by first-order biochemical degradation at rate $\\gamma_p p(t)$ and by dilution due to growth; the net first-order protein loss rate is $(\\gamma_p + \\mu) p(t)$.\n\nUsing only mass balance and first-order kinetics as the modeling base, derive the deterministic ordinary differential equations for $m(t)$ and $p(t)$ and then compute the unique steady-state concentrations $m^{\\ast}$ and $p^{\\ast}$ for the parameter values $k_{\\text{tx}} = 1$ nM min$^{-1}$, $k_{\\text{tl}} = 0.1$ min$^{-1}$, $\\gamma_m = 0.2$ min$^{-1}$, $\\gamma_p = 0.01$ min$^{-1}$, and $\\mu = 0.02$ min$^{-1}$. Express your final numerical answers in nanomolar (nM) and round each to four significant figures. Report your final result as a single row vector $\\big[m^{\\ast} \\;\\; p^{\\ast}\\big]$.",
            "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of biochemical kinetics, well-posed with a unique and stable solution, and formulated with objective, unambiguous language. All necessary parameters are provided, and their values are physically plausible. We may therefore proceed with the solution.\n\nThe dynamics of the mRNA concentration, $m(t)$, and protein concentration, $p(t)$, are governed by ordinary differential equations (ODEs) derived from the principle of mass balance, which states that the rate of change of a species' concentration is the sum of its production rates minus the sum of its loss rates.\n\nFirst, we establish the ODE for the mRNA concentration, $m(t)$.\nThe production of mRNA is described as a constant, zeroth-order process with rate $k_{\\text{tx}}$.\nThe loss of mRNA occurs through two first-order processes: enzymatic degradation with rate constant $\\gamma_m$ and dilution due to cell growth with specific growth rate $\\mu$. The total loss rate is thus $(\\gamma_m + \\mu)m(t)$.\nCombining these terms, the ODE for $m(t)$ is:\n$$\n\\frac{dm}{dt} = \\text{production} - \\text{loss} = k_{\\text{tx}} - (\\gamma_m + \\mu)m(t)\n$$\n\nNext, we establish the ODE for the protein concentration, $p(t)$.\nThe production of protein (translation) is a first-order process dependent on the mRNA concentration, occurring at a rate $k_{\\text{tl}}m(t)$.\nThe loss of protein, similar to mRNA, occurs through enzymatic degradation with rate constant $\\gamma_p$ and dilution due to cell growth at rate $\\mu$. The total loss rate for the protein is $(\\gamma_p + \\mu)p(t)$.\nCombining these terms, the ODE for $p(t)$ is:\n$$\n\\frac{dp}{dt} = \\text{production} - \\text{loss} = k_{\\text{tl}}m(t) - (\\gamma_p + \\mu)p(t)\n$$\n\nThe problem requires the calculation of the unique steady-state concentrations, denoted as $m^{\\ast}$ and $p^{\\ast}$. At steady state, the concentrations no longer change with time, which implies that their time derivatives are equal to zero.\n$$\n\\frac{dm}{dt} = 0 \\quad \\text{and} \\quad \\frac{dp}{dt} = 0\n$$\n\nSetting the first ODE to zero allows us to solve for the steady-state mRNA concentration, $m^{\\ast}$:\n$$\n0 = k_{\\text{tx}} - (\\gamma_m + \\mu)m^{\\ast}\n$$\n$$\n(\\gamma_m + \\mu)m^{\\ast} = k_{\\text{tx}}\n$$\n$$\nm^{\\ast} = \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu}\n$$\n\nSimilarly, setting the second ODE to zero and substituting $m^{\\ast}$ for $m(t)$ allows us to solve for the steady-state protein concentration, $p^{\\ast}$:\n$$\n0 = k_{\\text{tl}}m^{\\ast} - (\\gamma_p + \\mu)p^{\\ast}\n$$\n$$\n(\\gamma_p + \\mu)p^{\\ast} = k_{\\text{tl}}m^{\\ast}\n$$\n$$\np^{\\ast} = \\frac{k_{\\text{tl}}m^{\\ast}}{\\gamma_p + \\mu}\n$$\nBy substituting the expression for $m^{\\ast}$ into the equation for $p^{\\ast}$, we obtain a complete symbolic solution:\n$$\np^{\\ast} = \\frac{k_{\\text{tl}}}{\\gamma_p + \\mu} \\left( \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu} \\right) = \\frac{k_{\\text{tx}} k_{\\text{tl}}}{(\\gamma_m + \\mu)(\\gamma_p + \\mu)}\n$$\n\nNow, we substitute the specified numerical parameter values:\n$k_{\\text{tx}} = 1 \\text{ nM min}^{-1}$\n$k_{\\text{tl}} = 0.1 \\text{ min}^{-1}$\n$\\gamma_m = 0.2 \\text{ min}^{-1}$\n$\\gamma_p = 0.01 \\text{ min}^{-1}$\n$\\mu = 0.02 \\text{ min}^{-1}$\n\nFirst, we calculate the effective first-order loss rate constants:\nThe effective loss rate for mRNA is $\\gamma_m + \\mu = 0.2 \\text{ min}^{-1} + 0.02 \\text{ min}^{-1} = 0.22 \\text{ min}^{-1}$.\nThe effective loss rate for protein is $\\gamma_p + \\mu = 0.01 \\text{ min}^{-1} + 0.02 \\text{ min}^{-1} = 0.03 \\text{ min}^{-1}$.\n\nWe can now compute the numerical value for $m^{\\ast}$:\n$$\nm^{\\ast} = \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu} = \\frac{1 \\text{ nM min}^{-1}}{0.22 \\text{ min}^{-1}} \\approx 4.54545... \\text{ nM}\n$$\nRounding to four significant figures, we get $m^{\\ast} = 4.545 \\text{ nM}$.\n\nNext, we compute the numerical value for $p^{\\ast}$:\n$$\np^{\\ast} = \\frac{k_{\\text{tx}} k_{\\text{tl}}}{(\\gamma_m + \\mu)(\\gamma_p + \\mu)} = \\frac{(1 \\text{ nM min}^{-1})(0.1 \\text{ min}^{-1})}{(0.22 \\text{ min}^{-1})(0.03 \\text{ min}^{-1})} = \\frac{0.1}{0.0066} \\text{ nM} \\approx 15.151515... \\text{ nM}\n$$\nRounding to four significant figures, we get $p^{\\ast} = 15.15 \\text{ nM}$.\n\nThe final result is to be reported as a single row vector $[m^{\\ast} \\;\\; p^{\\ast}]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.545 & 15.15\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the single-gene model, we now explore how simple interactions can create complex, useful behaviors. The genetic toggle switch is a classic synthetic biology motif that exhibits bistability, forming the basis for cellular memory and decision-making circuits. In this exercise , you will use the powerful techniques of nullcline analysis and linearization to determine the conditions under which this switch operates. Identifying the critical parameter value for the bifurcation from one to three steady states is a key skill for engineering robust nonlinear dynamics.",
            "id": "3888581",
            "problem": "A synthetic toggle switch consists of two genes that mutually repress each other with matched parameters and Hill-type repression. Consider the nondimensionalized symmetric model\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x,\\qquad \\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y,\n$$\nwhere $x$ and $y$ denote the nondimensional protein concentrations, $n$ is the Hill coefficient, and $\\alpha>0$ is the nondimensional maximal synthesis rate. Assume $n=2$. Starting only from the definitions of equilibrium ($dx/dt=0$, $dy/dt=0$), nullclines (the sets where $dx/dt=0$ or $dy/dt=0$), and linear stability via the Jacobian matrix evaluated at equilibria, use nullcline geometry and linearization to determine how the number and stability of equilibria depend on $\\alpha$, and compute the exact critical value of $\\alpha$ at which the number of equilibria changes due to a nullcline tangency. Your derivation must proceed from these foundations without invoking any shortcut formulas.\n\nReport your final answer as a row matrix with the following entries in order:\n- $N_{<}$, the number of equilibria for $\\alpha$ just below the critical value;\n- $N_{>}$, the number of equilibria for $\\alpha$ just above the critical value;\n- $S_{>}$, the number of linearly stable equilibria for $\\alpha$ just above the critical value;\n- $U_{>}$, the number of saddle-type equilibria for $\\alpha$ just above the critical value;\n- $\\alpha_{\\text{crit}}$, the exact critical parameter value at which the nullclines are tangent.\n\nProvide exact values and do not round. No units are required in the final answer. Express the final answer as a single row matrix using the LaTeX $\\texttt{pmatrix}$ environment as specified.",
            "solution": "The problem asks for an analysis of the number and stability of equilibria for a synthetic genetic toggle switch model. The analysis must be based on nullcline geometry and linear stability theory.\n\nThe system of nondimensionalized ordinary differential equations is given by:\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y\n$$\nwith the Hill coefficient specified as $n=2$. The system becomes:\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{2}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{2}} - y\n$$\nwhere $x$ and $y$ are nondimensional protein concentrations and must be non-negative, and $\\alpha > 0$.\n\nEquilibria, or steady states, are points $(x^*, y^*)$ where the concentrations do not change over time. This occurs when both time derivatives are zero:\n$$\n\\frac{dx}{dt} = 0 \\implies x^* = \\frac{\\alpha}{1 + (y^*)^{2}}\n$$\n$$\n\\frac{dy}{dt} = 0 \\implies y^* = \\frac{\\alpha}{1 + (x^*)^{2}}\n$$\nThese equations define the nullclines of the system. The $x$-nullcline is the set of points where $\\frac{dx}{dt}=0$, given by the curve $x = \\frac{\\alpha}{1+y^2}$. The $y$-nullcline is the set of points where $\\frac{dy}{dt}=0$, given by the curve $y = \\frac{\\alpha}{1+x^2}$. The equilibria are the intersection points of these two nullclines.\n\nThe system is symmetric with respect to the exchange of variables $x$ and $y$. This implies that if $(x^*, y^*)$ is an equilibrium, then so is $(y^*, x^*)$. This symmetry guarantees at least one equilibrium must lie on the line of symmetry, $y=x$.\nTo find such a symmetric equilibrium, we set $y=x$ in one of the nullcline equations:\n$$\nx = \\frac{\\alpha}{1 + x^2}\n$$\nRearranging this gives a cubic equation for the symmetric equilibrium concentration $x$:\n$$\nx(1 + x^2) = \\alpha \\implies x^3 + x - \\alpha = 0\n$$\nLet $f(x) = x^3 + x - \\alpha$. The derivative is $f'(x) = 3x^2 + 1$. Since $x$ represents a concentration, $x$ is real, and thus $x^2 \\ge 0$. Therefore, $f'(x) > 0$ for all real $x$. This means $f(x)$ is a strictly monotonically increasing function. A strictly monotonic function can cross the horizontal axis at most once. Furthermore, since $f(0) = -\\alpha < 0$ and $\\lim_{x\\to\\infty} f(x) = \\infty$, there must be exactly one positive real root, which we denote as $x_s$. Thus, for any $\\alpha > 0$, there exists a unique symmetric equilibrium $(x_s, x_s)$.\n\nThe number of equilibria changes when the nullclines undergo a qualitative change in their intersection pattern. For this symmetric system, this occurs when the two nullclines become tangent to each other. Due to symmetry, this tangency must occur on the line $y=x$, at the symmetric equilibrium point. At a point of tangency $(x_c, y_c)$ where $x_c=y_c$, the slopes of the two nullcline curves must be equal.\n\nThe slope of the $y$-nullcline, $y(x) = \\frac{\\alpha}{1+x^2}$, is given by its derivative:\n$$\n\\frac{dy}{dx} = -\\frac{2\\alpha x}{(1+x^2)^2}\n$$\nThe $x$-nullcline, $x(y) = \\frac{\\alpha}{1+y^2}$, is a reflection of the $y$-nullcline across the line $y=x$. Its slope in the $(x,y)$-plane is $(\\frac{dx}{dy})^{-1}$. At a point on the line $y=x$, the slope of the $y$-nullcline is some value $m$. The slope of the $x$-nullcline will be $1/m$. For tangency, we might expect $m = 1/m \\implies m = \\pm 1$. However, this is not the condition. The condition for the creation or destruction of fixed points off the symmetry line $y=x$ (a pitchfork bifurcation) is that the slope of the nullcline $y(x)$ at the symmetric fixed point must be equal to the slope of the line of symmetry's perpendicular, which is $-1$.\n\nSo, the critical condition for tangency is $\\frac{dy}{dx} = -1$ at the symmetric equilibrium point $(x_c, x_c)$.\n$$\n-\\frac{2\\alpha x_c}{(1+x_c^2)^2} = -1 \\implies 2\\alpha x_c = (1+x_c^2)^2\n$$\nThis gives one equation relating the critical parameter $\\alpha_{\\text{crit}}$ and the corresponding critical equilibrium concentration $x_c$. The second equation is the equilibrium condition itself, evaluated at the critical point:\n$$\n\\alpha_{\\text{crit}} = x_c(1+x_c^2)\n$$\nSubstituting this expression for $\\alpha_{\\text{crit}}$ into the tangency condition:\n$$\n2 [x_c(1+x_c^2)] x_c = (1+x_c^2)^2\n$$\n$$\n2x_c^2(1+x_c^2) = (1+x_c^2)^2\n$$\nSince $x_c > 0$, the term $(1+x_c^2)$ is non-zero, so we can divide by it:\n$$\n2x_c^2 = 1+x_c^2 \\implies x_c^2 = 1\n$$\nAs concentrations are non-negative, we take the positive root, $x_c=1$.\nSubstituting $x_c=1$ back into the equation for $\\alpha_{\\text{crit}}$:\n$$\n\\alpha_{\\text{crit}} = 1 \\cdot (1+1^2) = 2\n$$\nSo, the critical value of $\\alpha$ is $\\alpha_{\\text{crit}} = 2$.\n\nFor $\\alpha < \\alpha_{\\text{crit}} = 2$, the magnitude of the slope of the $y$-nullcline at the symmetric equilibrium is less than $1$. The nullclines intersect only once. Thus, there is $1$ equilibrium. We denote this number as $N_{<}=1$.\nFor $\\alpha > \\alpha_{\\text{crit}} = 2$, the magnitude of the slope is greater than $1$. This causes the nullclines to intersect at two additional points, one on either side of the line $y=x$. Thus, there are $3$ equilibria. We denote this number as $N_{>}=3$.\n\nNext, we analyze the linear stability of these equilibria using the Jacobian matrix of the system, evaluated at each equilibrium. The Jacobian matrix $J$ is:\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1+y^2}-x) & \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1+y^2}-x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1+x^2}-y) & \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1+x^2}-y) \\end{pmatrix} = \\begin{pmatrix} -1 & -\\frac{2\\alpha y}{(1+y^2)^2} \\\\ -\\frac{2\\alpha x}{(1+x^2)^2} & -1 \\end{pmatrix}\n$$\nAn equilibrium is linearly stable if all eigenvalues of the Jacobian evaluated at that point have negative real parts. This is guaranteed if the trace $\\text{tr}(J) < 0$ and the determinant $\\det(J) > 0$.\n\nLet's analyze the stability for $\\alpha > \\alpha_{\\text{crit}} = 2$.\nFirst, consider the symmetric equilibrium $(x_s, x_s)$. Here, $x_s^3 + x_s - \\alpha = 0$. Since $\\alpha > 2$ and the function $f(x)=x^3+x$ is increasing, $x_s > 1$.\nAt $(x_s, x_s)$, the Jacobian is:\n$$\nJ(x_s, x_s) = \\begin{pmatrix} -1 & -\\frac{2\\alpha x_s}{(1+x_s^2)^2} \\\\ -\\frac{2\\alpha x_s}{(1+x_s^2)^2} & -1 \\end{pmatrix}\n$$\nThe trace is $\\text{tr}(J) = -2 < 0$.\nThe determinant is $\\det(J) = 1 - \\left(\\frac{2\\alpha x_s}{(1+x_s^2)^2}\\right)^2$.\nUsing the equilibrium condition $\\alpha = x_s(1+x_s^2)$, we can rewrite the off-diagonal term's magnitude:\n$$\n\\left|\\frac{2\\alpha x_s}{(1+x_s^2)^2}\\right| = \\frac{2x_s(1+x_s^2)x_s}{(1+x_s^2)^2} = \\frac{2x_s^2}{1+x_s^2}\n$$\nSince $x_s > 1$, we have $x_s^2 > 1$. Let $u=x_s^2 > 1$. Then $\\frac{2u}{1+u} > 1$ because $2u > 1+u \\iff u>1$.\nTherefore, the magnitude of the off-diagonal terms is greater than $1$.\nThis means $\\det(J) = 1 - (\\frac{2x_s^2}{1+x_s^2})^2 < 0$.\nAn equilibrium with a negative determinant has one positive and one negative eigenvalue, which corresponds to a saddle point. Saddle points are unstable. Thus, for $\\alpha > 2$, there is $1$ saddle-type equilibrium, $U_{>} = 1$.\n\nNow, consider the two asymmetric equilibria, $(x_a, y_a)$ and $(y_a, x_a)$, which exist for $\\alpha > 2$.\nAt an asymmetric point $(x_a, y_a)$, the trace of the Jacobian is again $\\text{tr}(J) = -2 < 0$.\nThe determinant is:\n$$\n\\det(J) = 1 - \\left(-\\frac{2\\alpha y_a}{(1+y_a^2)^2}\\right)\\left(-\\frac{2\\alpha x_a}{(1+x_a^2)^2}\\right) = 1 - \\frac{4\\alpha^2 x_a y_a}{(1+x_a^2)^2(1+y_a^2)^2}\n$$\nUsing the equilibrium conditions $y_a = \\frac{\\alpha}{1+x_a^2}$ and $x_a = \\frac{\\alpha}{1+y_a^2}$:\n$$\n\\det(J) = 1 - \\frac{4 (y_a(1+x_a^2)) (x_a(1+y_a^2)) x_a y_a}{(1+x_a^2)^2(1+y_a^2)^2} = 1 - \\frac{4x_a^2 y_a^2}{(1+x_a^2)(1+y_a^2)}\n$$\nThe asymmetric equilibria are created via a supercritical pitchfork bifurcation, where the symmetric equilibrium loses stability. The two new equilibria that branch off are stable. This implies that for these points, $\\det(J) > 0$.\nTo confirm, the bifurcation occurs when the slope of the composite map $\\phi(x) = \\frac{\\alpha}{1+(\\alpha/(1+x^2))^2}$ is $1$ at the symmetric fixed point. For the new stable fixed points that emerge, the slope must be less than $1$. The slope is $\\phi'(x) = g'(g(x))g'(x)$, where $g(x) = \\frac{\\alpha}{1+x^2}$. At the asymmetric fixed point $(x_a, y_a)$, $y_a=g(x_a)$, so $\\phi'(x_a) = g'(y_a)g'(x_a)$.\nThe determinant of the Jacobian at $(x_a,y_a)$ can be shown to be $1-\\phi'(x_a)$. Since $\\phi'(x_a) < 1$ for the emergent stable branches, we have $\\det(J) > 0$.\nWith $\\text{tr}(J) = -2 < 0$ and $\\det(J) > 0$, the eigenvalues have negative real parts. Therefore, the two asymmetric equilibria are linearly stable. The number of stable equilibria is $S_{>} = 2$.\n\nSummarizing the results:\n- For $\\alpha < \\alpha_{\\text{crit}}$, number of equilibria $N_{<} = 1$.\n- For $\\alpha > \\alpha_{\\text{crit}}$, number of equilibria $N_{>} = 3$.\n- For $\\alpha > \\alpha_{\\text{crit}}$, number of stable equilibria $S_{>} = 2$.\n- For $\\alpha > \\alpha_{\\text{crit}}$, number of saddle equilibria $U_{>} = 1$.\n- The critical value is $\\alpha_{\\text{crit}} = 2$.\n\nThe final answer is composed of these five values in the specified order.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 3 & 2 & 1 & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Synthetic circuits do not operate in a vacuum; they function within the complex and resource-limited environment of a host cell. This practice  moves from the analysis of isolated motifs to the practical challenge of system-level design under constraint. You will formulate and solve an optimization problem to maximize a circuit's output, explicitly accounting for the metabolic 'burden' it imposes by sequestering ribosomes. Mastering this trade-off between expression and burden is crucial for engineering circuits that perform reliably without harming their cellular chassis.",
            "id": "3888577",
            "problem": "You are asked to formulate and solve an optimization problem for a synthetic multi-gene circuit where promoter strengths and ribosome binding site strengths are allocated to maximize protein output while ensuring that cellular burden remains below a specified threshold on free ribosomes. The scenario is modeled as follows.\n\nFoundational modeling assumptions grounded in Central Dogma of molecular biology and standard resource allocation in cells:\n- Transcription produces messenger ribonucleic acid (mRNA) at a rate proportional to promoter strength. For gene index $i \\in \\{1,\\dots,N\\}$, the mRNA production rate is $m_i = \\alpha \\, p_i$, where $p_i$ is the promoter strength and $\\alpha$ is a proportionality constant per gene.\n- Translation initiation depends on the Ribosome Binding Site (RBS) strength and the pool of free ribosomes. For gene $i$, the ribosome loading is modeled by a Michaelisâ€“Menten-like term with respect to free ribosomes: the ribosome load contributed by gene $i$ is $L_i = m_i \\, r_i \\, \\dfrac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$, where $r_i$ is the RBS strength, $R_{\\mathrm{free}}$ is the concentration of free ribosomes available for initiation, and $K_R$ is the effective Michaelis constant for ribosome binding.\n- Total ribosomes obey a conservation constraint: $R_{\\mathrm{free}} = R_{\\mathrm{tot}} - \\sum_{i=1}^{N} L_i$, where $R_{\\mathrm{tot}}$ is the total ribosome concentration.\n- The instantaneous output rate of the circuit (total protein production rate) is $Y = \\gamma \\sum_{i=1}^{N} L_i$, where $\\gamma$ is an average elongation-to-production proportionality constant.\n\nDesign variables and constraints:\n- The design variables are the promoter strengths $\\{p_i\\}_{i=1}^{N}$ and the Ribosome Binding Site strengths $\\{r_i\\}_{i=1}^{N}$.\n- Lower and upper bounds are imposed: $p_{\\min} \\le p_i \\le p_{\\max}$ and $r_{\\min} \\le r_i \\le r_{\\max}$ for each gene $i$.\n- The burden constraint is imposed as a minimum free ribosome threshold: $R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$, where $R_{\\mathrm{thr}}$ is specified.\n- All quantities are dimensionless rates or concentrations and do not require physical units.\n\nGoal:\n- Maximize $Y$ over all feasible allocations of $\\{p_i\\}$ and $\\{r_i\\}$ subject to the constraints.\n\nYour program must compute the optimal value of $Y$ for each of the following test cases. If no feasible allocation exists that satisfies $R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$ under the lower bounds $p_{\\min}$ and $r_{\\min}$, your program must output the value $-1.0$ for that test case. Otherwise, output the optimal $Y$ as a decimal number. The final output must be a single line containing a comma-separated list of these results enclosed in square brackets.\n\nTest Suite (each test case is a tuple $(N,\\alpha,\\gamma,R_{\\mathrm{tot}},K_R,p_{\\min},p_{\\max},r_{\\min},r_{\\max},R_{\\mathrm{thr}})$):\n- Case $1$: $(\\;10,\\;1.0,\\;2.0,\\;100.0,\\;10.0,\\;0.0,\\;5.0,\\;0.0,\\;5.0,\\;20.0\\;)$\n- Case $2$: $(\\;5,\\;1.0,\\;1.0,\\;30.0,\\;5.0,\\;1.0,\\;3.0,\\;2.0,\\;4.0,\\;28.0\\;)$\n- Case $3$: $(\\;3,\\;1.0,\\;1.5,\\;100.0,\\;10.0,\\;0.0,\\;1.0,\\;0.0,\\;1.0,\\;20.0\\;)$\n- Case $4$: $(\\;1,\\;0.5,\\;3.0,\\;10.0,\\;2.0,\\;0.0,\\;3.0,\\;0.0,\\;3.0,\\;5.0\\;)$\n- Case $5$: $(\\;4,\\;0.7,\\;2.5,\\;50.0,\\;5.0,\\;0.0,\\;2.0,\\;0.0,\\;3.0,\\;50.0\\;)$\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\;y_1,y_2,y_3,y_4,y_5\\;]$ where each $y_k$ is either a decimal number or $-1.0$).\n- Angles are not used; percentages are not used; numerical answers are reported as decimals.",
            "solution": "The user has provided a constrained optimization problem related to synthetic gene circuit design. The first step is to validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following model, variables, constraints, and objectives:\n- **Model Equations:**\n    - mRNA production rate: $m_i = \\alpha \\, p_i$ for each gene $i \\in \\{1,\\dots,N\\}$.\n    - Ribosome load per gene: $L_i = m_i \\, r_i \\, \\dfrac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$.\n    - Ribosome conservation: $R_{\\mathrm{free}} = R_{\\mathrm{tot}} - \\sum_{i=1}^{N} L_i$.\n    - Total protein output rate: $Y = \\gamma \\sum_{i=1}^{N} L_i$.\n- **Design Variables:**\n    - Promoter strengths $\\{p_i\\}_{i=1}^{N}$.\n    - Ribosome Binding Site (RBS) strengths $\\{r_i\\}_{i=1}^{N}$.\n- **Constraints:**\n    - Variable bounds: $p_{\\min} \\le p_i \\le p_{\\max}$ and $r_{\\min} \\le r_i \\le r_{\\max}$ for all $i$.\n    - Burden constraint: $R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$.\n- **Goal:** Maximize the total output $Y$.\n- **Test Data:** A suite of five test cases with specific values for the parameters $(N, \\alpha, \\gamma, R_{\\mathrm{tot}}, K_R, p_{\\min}, p_{\\max}, r_{\\min}, r_{\\max}, R_{\\mathrm{thr}})$.\n- **Special Condition:** If no feasible allocation exists, the output for that case should be $-1.0$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The model uses simplified but standard formalisms for gene expression and resource competition (cellular burden) found in systems and synthetic biology literature. The conservation of ribosomes and Michaelis-Menten-like saturation kinetics are established principles in this context. The problem is a realistic, albeit simplified, representation of a resource-aware circuit design problem.\n- **Well-Posed:** The problem is a well-defined nonlinear constrained optimization problem. The objective function ($Y$) is clearly stated, and all constraints are mathematically precise. The existence and uniqueness of the maximum value of $Y$ can be determined.\n- **Objective:** The language is formal and quantitative, free of any subjective or opinion-based statements.\n- **Completeness and Consistency:** The problem is self-contained. All necessary parameters for solving the problem are provided for each test case. There are no contradictions between the given equations and constraints.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-posed, scientifically relevant optimization problem. I will now proceed to formulate and implement the solution.\n\n### Principle-Based Design and Solution\n\nThe objective is to maximize the total protein production rate, $Y$. Let $L_{\\mathrm{tot}} = \\sum_{i=1}^{N} L_i$ be the total ribosome load. The objective function can then be written as $Y = \\gamma L_{\\mathrm{tot}}$. Since $\\gamma$ is a positive constant, maximizing $Y$ is equivalent to maximizing $L_{\\mathrm{tot}}$.\n\nWe can express $L_{\\mathrm{tot}}$ in terms of the design variables.\n$L_{\\mathrm{tot}} = \\sum_{i=1}^{N} m_i r_i \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}} = \\sum_{i=1}^{N} (\\alpha p_i) r_i \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}} = \\alpha \\left(\\sum_{i=1}^{N} p_i r_i\\right) \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$.\n\nLet's define a composite variable $S = \\sum_{i=1}^{N} p_i r_i$, which represents the total \"strength\" of the circuit. The expression for $L_{\\mathrm{tot}}$ becomes:\n$L_{\\mathrm{tot}} = \\alpha S \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$.\n\nUsing the ribosome conservation law, $R_{\\mathrm{free}} = R_{\\mathrm{tot}} - L_{\\mathrm{tot}}$, we can substitute $R_{\\mathrm{free}}$ to obtain an equation solely in terms of $L_{\\mathrm{tot}}$ and $S$:\n$L_{\\mathrm{tot}} = \\alpha S \\frac{R_{\\mathrm{tot}} - L_{\\mathrm{tot}}}{K_R + R_{\\mathrm{tot}} - L_{\\mathrm{tot}}}$.\n\nRearranging this gives a quadratic equation for $L_{\\mathrm{tot}}$:\n$L_{\\mathrm{tot}}(K_R + R_{\\mathrm{tot}} - L_{\\mathrm{tot}}) = \\alpha S (R_{\\mathrm{tot}} - L_{\\mathrm{tot}})$\n$L_{\\mathrm{tot}}^2 - (K_R + R_{\\mathrm{tot}} + \\alpha S)L_{\\mathrm{tot}} + \\alpha S R_{\\mathrm{tot}} = 0$.\n\nSolving for $L_{\\mathrm{tot}}$ using the quadratic formula yields two roots. The physically meaningful solution is the one that approaches $0$ as $S \\to 0$:\n$L_{\\mathrm{tot}}(S) = \\frac{(K_R + R_{\\mathrm{tot}} + \\alpha S) - \\sqrt{(K_R + R_{\\mathrm{tot}} + \\alpha S)^2 - 4 \\alpha S R_{\\mathrm{tot}}}}{2}$.\n\nBy differentiating $L_{\\mathrm{tot}}$ with respect to $S$, it can be shown that $L_{\\mathrm{tot}}(S)$ is a monotonically increasing function of $S$. Therefore, maximizing $L_{\\mathrm{tot}}$ is equivalent to maximizing $S$.\n\nThe optimization problem is now reframed as: Maximize $S = \\sum_{i=1}^{N} p_i r_i$ subject to the given constraints.\nTo maximize the sum of products $\\sum p_i r_i$, we should choose the largest possible values for each $p_i$ and $r_i$, i.e., $p_i = p_{\\max}$ and $r_i = r_{\\max}$ for all $i$. Let this maximum possible strength be $S_{\\max} = N \\cdot p_{\\max} \\cdot r_{\\max}$.\n\nHowever, this is constrained by the burden requirement: $R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$, which translates to $R_{\\mathrm{tot}} - L_{\\mathrm{tot}} \\ge R_{\\mathrm{thr}}$, or $L_{\\mathrm{tot}} \\le R_{\\mathrm{tot}} - R_{\\mathrm{thr}}$. Let $L_{\\mathrm{max\\_allowed}} = R_{\\mathrm{tot}} - R_{\\mathrm{thr}}$.\n\nThe solution strategy is as follows:\n1.  First, check for feasibility. The minimum possible circuit strength is $S_{\\min} = N \\cdot p_{\\min} \\cdot r_{\\min}$. Calculate the ribosome load at this minimum strength, $L_{\\mathrm{tot}}(S_{\\min})$. If this minimum load already violates the burden constraint, i.e., $L_{\\mathrm{tot}}(S_{\\min}) > L_{\\mathrm{max\\_allowed}}$, then no feasible solution exists. In this case, the output is $-1.0$.\n\n2.  If the minimal expression is feasible, we determine the maximum achievable output. Calculate the load at maximum possible circuit strength, $L_{\\mathrm{tot}}(S_{\\max})$.\n    -   If $L_{\\mathrm{tot}}(S_{\\max}) \\le L_{\\mathrm{max\\_allowed}}$, the system is not burden-limited. The optimal strategy is to use the maximum possible strength for all genes ($p_i=p_{\\max}, r_i=r_{\\max}$). The optimal load is $L_{\\mathrm{opt}} = L_{\\mathrm{tot}}(S_{\\max})$, and the maximum output is $Y_{\\mathrm{opt}} = \\gamma L_{\\mathrm{opt}}$.\n    -   If $L_{\\mathrm{tot}}(S_{\\max}) > L_{\\mathrm{max\\_allowed}}$, the system is burden-limited. The maximum output is achieved when the circuit operates exactly at the burden threshold, meaning the ribosome load is clamped at its maximum allowed value, $L_{\\mathrm{opt}} = L_{\\mathrm{max\\_allowed}}$. A circuit strength $S$ between $S_{\\min}$ and $S_{\\max}$ can be found to achieve this load. The maximum output is then $Y_{\\mathrm{opt}} = \\gamma L_{\\mathrm{opt}} = \\gamma(R_{\\mathrm{tot}} - R_{\\mathrm{thr}})$.\n\nThis logic provides a complete algorithm to solve the problem for any given set of parameters.",
            "answer": "[160.0,-1.0,4.5,6.0,0.0]"
        }
    ]
}