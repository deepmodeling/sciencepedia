{
    "hands_on_practices": [
        {
            "introduction": "The steady-state assumption is a cornerstone of Flux Balance Analysis, stating that the concentration of internal metabolites remains constant over time. But what does this powerful assumption imply for a completely isolated, or \"closed,\" metabolic network? This foundational exercise  invites you to demonstrate mathematically why such a system cannot support any sustained metabolic activity ($v \\neq 0$). By constructing a simple acyclic network and applying the steady-state condition $S v = 0$, you will rigorously prove why exchange reactions that connect the system to its environment are an absolute necessity for achieving a viable, non-zero steady-state flux.",
            "id": "3879143",
            "problem": "Consider steady-state constraint-based modeling of a closed intracellular network with no exchange, uptake, secretion, or demand reactions. Under Flux Balance Analysis (FBA), the mass balance constraints are written as $S v = 0$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix of $m$ internal metabolites and $n$ reactions, and $v \\in \\mathbb{R}^{n}$ is the reaction flux vector subject to standard feasibility bounds and directionality constraints.\n\nConstruct a minimal, scientifically plausible closed network with $m = 3$ internal metabolites $\\{X, Y, Z\\}$ and $n = 2$ internal reactions given by isomerizations:\n- $R_{1}$: $X \\rightarrow Y$,\n- $R_{2}$: $Y \\rightarrow Z$.\n\nWrite down the stoichiometric matrix $S$ for this network in the metabolite order $(X, Y, Z)$ and reaction order $(R_{1}, R_{2})$. Using only the FBA steady-state definition $S v = 0$ and linear algebraic reasoning, determine the unique flux vector $v$ satisfying the steady-state equations under the feasibility bounds $0 \\le v_{i} < \\infty$ for $i \\in \\{1, 2\\}$, and explain rigorously why this network admits only the zero flux vector (i.e., why there is no nontrivial internal flux) in the absence of exchange or demand reactions. In your explanation, justify the necessity of adding exchange or demand reactions to obtain nonzero steady-state flux in such an acyclic closed network. Express your final flux vector answer as a row vector using the LaTeX `\\begin{pmatrix}` environment. No units are required, and no rounding is needed.",
            "solution": "The problem requires the analysis of a minimal, closed metabolic network under the steady-state assumption of Flux Balance Analysis (FBA). The core principle of FBA is that for a system at steady state, the concentration of each internal metabolite remains constant. This is expressed by the mass balance equation $S v = 0$, where $S$ is the stoichiometric matrix and $v$ is the vector of reaction fluxes.\n\nFirst, we construct the stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 2}$ for the given network. The rows of $S$ correspond to the metabolites in the order $(X, Y, Z)$, and the columns correspond to the reactions in the order $(R_{1}, R_{2})$.\n\nThe reactions are:\n1.  $R_{1}$: $1X \\rightarrow 1Y$\n2.  $R_{2}$: $1Y \\rightarrow 1Z$\n\nThe entries $S_{ij}$ of the matrix represent the stoichiometric coefficient of metabolite $i$ in reaction $j$. By convention, reactants have negative coefficients and products have positive coefficients.\n\nFor reaction $R_{1}$, one mole of metabolite $X$ is consumed ($-1$), and one mole of metabolite $Y$ is produced ($+1$). Metabolite $Z$ is not involved ($0$). This gives the first column of $S$:\n$$\nv_{R_1} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n\nFor reaction $R_{2}$, one mole of metabolite $Y$ is consumed ($-1$), and one mole of metabolite $Z$ is produced ($+1$). Metabolite $X$ is not involved ($0$). This gives the second column of $S$:\n$$\nv_{R_2} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n\nCombining these columns, the stoichiometric matrix $S$ is:\n$$\nS = \\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\nNext, we apply the steady-state constraint $S v = 0$, where $v = \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix}$ is the flux vector for reactions $R_{1}$ and $R_{2}$ respectively. This matrix equation corresponds to a system of linear equations:\n$$\n\\begin{pmatrix} -1 & 0 \\\\ 1 & -1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n\nWriting out the system of equations, one for each metabolite's mass balance:\n1.  For metabolite $X$: $-1 \\cdot v_{1} + 0 \\cdot v_{2} = 0 \\implies -v_{1} = 0 \\implies v_{1} = 0$.\n2.  For metabolite $Y$: $1 \\cdot v_{1} - 1 \\cdot v_{2} = 0 \\implies v_{1} - v_{2} = 0$.\n3.  For metabolite $Z$: $0 \\cdot v_{1} + 1 \\cdot v_{2} = 0 \\implies v_{2} = 0$.\n\nFrom the first equation, we find $v_{1} = 0$. From the third equation, we find $v_{2} = 0$. Substituting these values into the second equation gives $0 - 0 = 0$, which is consistent. Thus, the only solution to the system of linear equations is $v_{1} = 0$ and $v_{2} = 0$. This solution satisfies the given feasibility bounds $0 \\le v_{i} < \\infty$. The unique steady-state flux vector is therefore the zero vector, $v = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n\nTo explain this result rigorously using linear algebra, we analyze the null space (or kernel) of the matrix $S$. The set of all valid steady-state flux vectors is, by definition, the null space of $S$. The dimension of the null space, or nullity, determines the number of independent flux distributions the network can support.\n\nThe columns of $S$ are the vectors $c_1 = \\begin{pmatrix} -1 & 1 & 0 \\end{pmatrix}^T$ and $c_2 = \\begin{pmatrix} 0 & -1 & 1 \\end{pmatrix}^T$. To determine if they are linearly independent, we seek non-trivial solutions to the equation $k_{1}c_{1} + k_{2}c_{2} = 0$. This gives the system:\n$$\n-k_{1} = 0 \\\\\nk_{1} - k_{2} = 0 \\\\\nk_{2} = 0\n$$\nThe only solution is $k_{1} = 0$ and $k_{2} = 0$. Since the only linear combination of the columns that equals the zero vector is the trivial one, the columns are linearly independent. The rank of a matrix is the dimension of its column space, which is equal to the number of linearly independent columns. Therefore, the rank of $S$ is $\\text{rank}(S) = 2$.\n\nAccording to the rank-nullity theorem, for a matrix $S \\in \\mathbb{R}^{m \\times n}$, we have $\\text{rank}(S) + \\text{nullity}(S) = n$, where $n$ is the number of columns (reactions). In our case, $n=2$. Substituting the rank we found:\n$$\n2 + \\text{nullity}(S) = 2\n$$\nThis implies that $\\text{nullity}(S) = 0$. A null space of dimension $0$ contains only one element: the zero vector. Therefore, the only flux vector $v$ that satisfies $S v = 0$ is $v = 0$.\n\nThe physical interpretation of this result is that in a closed and acyclic network, there can be no sustained, non-zero flux at steady state. Metabolite $X$ is consumed by $R_{1}$, but since the system is closed, there is no reaction or external source producing $X$. For the concentration of $X$ to be constant (steady state), the net rate of its production must be zero. This requires the flux $v_{1}$ through the reaction consuming it to be zero. Similarly, metabolite $Z$ is produced by $R_{2}$, but no reaction or external sink consumes it. For the concentration of $Z$ to be constant, it cannot accumulate, meaning the flux $v_{2}$ through the reaction producing it must also be zero.\n\nTo obtain a non-zero steady-state flux, the mass balance must be satisfied for every metabolite. This is possible only if the system is \"opened\" by adding exchange reactions. For instance, a source reaction for $X$ (e.g., $R_{in}: \\emptyset \\rightarrow X$) and a sink or demand reaction for $Z$ (e.g., $R_{out}: Z \\rightarrow \\emptyset$) would modify the mass balance equations for $X$ and $Z$ to $v_{in} - v_{1} = 0$ and $v_{2} - v_{out} = 0$, respectively. The balance for the internal metabolite $Y$ remains $v_{1} - v_{2} = 0$. This new system allows for a non-trivial solution $v_{1} = v_{2} = v_{in} = v_{out}$. A non-zero influx ($v_{in} > 0$) can propagate through the pathway and exit ($v_{out} > 0$) while maintaining a perfect balance for all internal metabolites, thereby satisfying the steady-state condition with non-zero internal fluxes. Thus, in an acyclic network, exchange reactions are a necessity for sustaining non-zero steady-state flux.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having established that metabolic networks must be open systems, we now explore how the limits on their inputs and outputs constrain the network's internal state. This practice  provides a hands-on tour of the \"feasible flux space\" by tasking you with calculating the precise allowable range for an internal reaction's activity. By manually working through the stoichiometric relationships and propagating the given flux bounds, you will develop a concrete intuition for how the cell's external environment shapes its internal metabolic capabilities and defines the boundaries of what is biochemically possible.",
            "id": "3879111",
            "problem": "Consider a minimal constraint-based model of a single-cell metabolic network under steady-state assumptions, as used in Flux Balance Analysis (FBA). The internal metabolites are labeled $a$, $b$, and $c$. The network has five reactions: an uptake of an external substrate $A_{\\mathrm{ext}}$ into $a$ (reaction $R_{1}$), two internal conversions $a \\rightarrow b$ (reaction $R_{2}$) and $a \\rightarrow c$ (reaction $R_{3}$), and two secretions $b \\rightarrow B_{\\mathrm{ext}}$ (reaction $R_{4}$) and $c \\rightarrow C_{\\mathrm{ext}}$ (reaction $R_{5}$). The stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 5}$ for the internal mass balances is\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1 & -1 & -1 & 0 & 0 \\\\\n0 & 1 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & 0 & -1\n\\end{pmatrix},\n$$\nwith rows ordered as $\\{a,b,c\\}$ and columns ordered as $\\{R_{1},R_{2},R_{3},R_{4},R_{5}\\}$. Let the flux vector be $v = (v_{1}, v_{2}, v_{3}, v_{4}, v_{5})^{\\top}$. The steady-state mass balance is $S v = 0$. All reactions are irreversible in the written forward direction, and the following bounds reflect measured uptake capacity and secretion requirements:\n$$\n0 \\leq v_{1} \\leq 12, \\quad 0 \\leq v_{2} \\leq 100, \\quad 0 \\leq v_{3} \\leq 100, \\quad 3 \\leq v_{4} \\leq 10, \\quad 5 \\leq v_{5} \\leq 9.\n$$\nThese inequalities and $S v = 0$ define the feasible flux set. Determine the feasible interval $[v_{2}^{\\min},\\, v_{2}^{\\max}]$ for the target reaction flux $v_{2}$ that is consistent with $S v = 0$ and all bounds. Express both endpoints in millimoles per gram dry weight per hour (mmol gDW⁻¹ h⁻¹). No rounding is required; report exact values.",
            "solution": "The steady-state mass balance condition is given by the matrix equation $S v = 0$. Writing this out for the given stoichiometric matrix $S$ and flux vector $v$, we obtain a system of three linear equations:\n$$\n\\begin{pmatrix}\n1 & -1 & -1 & 0 & 0 \\\\\n0 & 1 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & 0 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\nv_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\\\ v_5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nThis system corresponds to the following individual mass balances for metabolites $a$, $b$, and $c$:\n1.  Metabolite $a$: $v_{1} - v_{2} - v_{3} = 0$\n2.  Metabolite $b$: $v_{2} - v_{4} = 0$\n3.  Metabolite $c$: $v_{3} - v_{5} = 0$\n\nFrom equations (2) and (3), we can express fluxes $v_{2}$ and $v_{3}$ in terms of $v_{4}$ and $v_{5}$, respectively:\n$v_{2} = v_{4}$\n$v_{3} = v_{5}$\n\nSubstituting these relations into equation (1) gives an expression for $v_{1}$:\n$v_{1} = v_{2} + v_{3} = v_{4} + v_{5}$\n\nNow, we must find the range of $v_2$ that is consistent with both these stoichiometric constraints and the given flux bounds. We will systematically combine the bounds.\n\nThe relation $v_{2} = v_{4}$ implies that any feasible value for $v_{2}$ must also be a feasible value for $v_{4}$, and vice-versa. The given bounds are $0 \\leq v_{2} \\leq 100$ and $3 \\leq v_{4} \\leq 10$. For $v_{2} = v_{4}$ to hold, the value must lie in the intersection of these two intervals.\n$$ v_{2}, v_{4} \\in [0, 100] \\cap [3, 10] = [3, 10] $$\nThus, we have a new, tighter constraint on both $v_{2}$ and $v_{4}$:\n$3 \\leq v_{2} \\leq 10$ and $3 \\leq v_{4} \\leq 10$.\n\nSimilarly, for the relation $v_{3} = v_{5}$, the given bounds are $0 \\leq v_{3} \\leq 100$ and $5 \\leq v_{5} \\leq 9$. The value must lie in the intersection of these two intervals.\n$$ v_{3}, v_{5} \\in [0, 100] \\cap [5, 9] = [5, 9] $$\nThis yields the tighter constraints:\n$5 \\leq v_{3} \\leq 9$ and $5 \\leq v_{5} \\leq 9$.\n\nFinally, we consider the constraint on $v_{1}$, which is $0 \\leq v_{1} \\leq 12$. Using the relation $v_{1} = v_{2} + v_{3}$, we have:\n$0 \\leq v_{2} + v_{3} \\leq 12$.\nSince the established ranges for $v_2$ and $v_3$ are $v_{2} \\geq 3$ and $v_{3} \\geq 5$, the sum $v_{2} + v_{3}$ will always be greater than or equal to $3+5=8$. Thus, the lower bound $v_{2} + v_{3} \\geq 0$ is automatically satisfied. The effective constraint becomes:\n$v_{2} + v_{3} \\leq 12$.\n\nOur task is to find the feasible interval for $v_{2}$, which is equivalent to finding the minimum and maximum values of $v_{2}$ subject to the following set of constraints:\n1.  $3 \\leq v_{2} \\leq 10$\n2.  $5 \\leq v_{3} \\leq 9$\n3.  $v_{2} + v_{3} \\leq 12$\n\nTo find the maximum possible value for $v_{2}$, denoted $v_{2}^{\\max}$, we rearrange the third constraint as $v_{2} \\leq 12 - v_{3}$. To maximize $v_{2}$, the value of $v_{3}$ must be minimized. From the second constraint, the minimum possible value for $v_{3}$ is $5$.\nSubstituting $v_{3} = 5$ into the inequality:\n$v_{2} \\leq 12 - 5 \\implies v_{2} \\leq 7$.\nThis condition must be satisfied along with $3 \\leq v_2 \\leq 10$. The intersection of $v_{2} \\leq 7$ and $v_{2} \\in [3, 10]$ is $v_{2} \\in [3, 7]$. The maximum value in this range is $7$.\nThus, $v_{2}^{\\max} = 7$. We confirm that a flux state with $v_2=7$ exists: set $v_2=7$ and $v_3=5$. This gives $v_1=12$, $v_4=7$, $v_5=5$. All these values are within their respective allowed bounds.\n\nTo find the minimum possible value for $v_{2}$, denoted $v_{2}^{\\min}$, we look at the constraint $3 \\leq v_2 \\leq 10$. The lowest possible value is $3$. We must check if $v_{2}=3$ is compatible with the existence of a valid $v_{3}$.\nIf $v_{2} = 3$, the constraints on $v_{3}$ become:\n1.  $5 \\leq v_{3} \\leq 9$\n2.  $3 + v_{3} \\leq 12 \\implies v_{3} \\leq 9$\nCombining these, we require a $v_{3}$ such that $v_{3} \\in [5, 9] \\cap (-\\infty, 9] = [5, 9]$. Since this interval is non-empty (e.g., $v_{3}=5$ is a valid choice), a feasible flux distribution with $v_{2}=3$ exists.\nThus, $v_{2}^{\\min} = 3$.\n\nThe feasible interval for the flux $v_{2}$ is $[v_{2}^{\\min}, v_{2}^{\\max}] = [3, 7]$. The units for these flux values are millimoles per gram dry weight per hour (mmol gDW⁻¹ h⁻¹). The endpoints of the feasible interval for $v_2$ are $v_{2}^{\\min} = 3$ mmol gDW⁻¹ h⁻¹ and $v_{2}^{\\max} = 7$ mmol gDW⁻¹ h⁻¹.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 7\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Flux Balance Analysis is not merely a descriptive tool; it is a powerful predictive framework for interrogating system-level properties, such as robustness and vulnerability. This computational practice  simulates one of the most common applications of FBA: performing in silico gene or reaction \"knockout\" experiments. By systematically setting reaction fluxes to zero and re-optimizing for a cellular objective, you will learn to identify reactions essential for growth and uncover \"synthetic lethal\" pairs—redundant pathways that become critical for survival only when their counterpart is disabled, offering deep insights into network design and potential therapeutic targets.",
            "id": "3879160",
            "problem": "You are given a small, scientifically plausible metabolic network and asked to implement a constraint-based analysis using Flux Balance Analysis (FBA) to determine reaction essentiality and identify synthetic lethal pairs. The fundamental base you must use is the steady-state mass balance of a biochemical network along with linear constraints and linear optimization.\n\nThe network consists of $4$ metabolites and $6$ irreversible reactions. The metabolites are $A$, $B$, $C$, and $D$. The reactions are:\n- $R_1$: $\\rightarrow A$ (uptake/source),\n- $R_2$: $A \\rightarrow B$,\n- $R_3$: $B \\rightarrow C$,\n- $R_4$: $A \\rightarrow D$,\n- $R_5$: $D \\rightarrow C$,\n- $R_6$: $C \\rightarrow$ biomass (the “biomass” is a pseudo-consumption sink for $C$ and is not explicitly included as a metabolite).\n\nLet the stoichiometric matrix be\n$$\nS = \\begin{bmatrix}\n+1 & -1 & 0 & -1 & 0 & 0 \\\\\n0 & +1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & +1 & 0 & +1 & -1 \\\\\n0 & 0 & 0 & +1 & -1 & 0\n\\end{bmatrix},\n$$\nwhere rows correspond to metabolites $\\{A,B,C,D\\}$ and columns correspond to reactions $\\{R_1,R_2,R_3,R_4,R_5,R_6\\}$.\n\nFlux Balance Analysis (FBA) assumes steady state,\n$$\nS \\, v = 0,\n$$\nwhere $v \\in \\mathbb{R}^6$ is the flux vector. All reactions are irreversible with lower bounds $0$, and upper bounds as specified per test case. The objective is to maximize growth, defined as the flux through the biomass drain reaction,\n$$\n\\max_{v} \\; v_6\n$$\nsubject to $S v = 0$ and the flux bounds.\n\nFluxes must be treated as having units of millimoles per gram dry weight per hour and reported as “mmol gDW⁻¹ h⁻¹”. When you report a flux value in the final output, it must be in “mmol gDW⁻¹ h⁻¹” and rounded to three decimal places.\n\nReaction indexing must be zero-based: $R_1 \\mapsto 0$, $R_2 \\mapsto 1$, $R_3 \\mapsto 2$, $R_4 \\mapsto 3$, $R_5 \\mapsto 4$, $R_6 \\mapsto 5$.\n\nDefinitions to implement:\n- A reaction $i$ is “essential” if knocking it out (enforcing $v_i = 0$) reduces the optimal objective to less than a small threshold $\\varepsilon$, i.e., $\\max v_6 \\lt \\varepsilon$ after knockout. Use $\\varepsilon = 10^{-9}$.\n- A pair of reactions $(i,j)$ is “synthetic lethal” if neither $i$ nor $j$ is individually essential, but knocking out both simultaneously (enforcing $v_i = 0$ and $v_j = 0$) reduces the optimal objective to less than $\\varepsilon$, i.e., $\\max v_6 \\lt \\varepsilon$.\n- To focus on internal pathway redundancy, compute synthetic lethal pairs only among the candidate set $\\{1,2,3,4\\}$ (that is, reactions $R_2$ through $R_5$) and only if the baseline optimal growth is greater than or equal to $\\varepsilon$. If the baseline optimal growth is less than $\\varepsilon$, return an empty list for essential reactions and an empty list for synthetic lethal pairs.\n\nPhysical and numerical details:\n- All flux bounds are in “mmol gDW⁻¹ h⁻¹”.\n- Unless modified by the test case, lower bounds are $0$ and upper bounds are $1000$ for internal reactions ($R_2$ through $R_6$).\n- The uptake reaction $R_1$ has lower bound $0$ and an upper bound provided per test case.\n\nYour program must solve a sequence of linear programs using a correct Linear Programming (LP) method to compute the baseline growth, the effect of single-reaction knockouts, and the effect of double-reaction knockouts among the specified candidate set. Use repeated LP solves as needed.\n\nTest suite:\n- Case $1$ (happy path): $R_1$ upper bound $10$, $R_3$ upper bound $1000$, $R_5$ upper bound $1000$.\n- Case $2$ (capacity-limited branches): $R_1$ upper bound $10$, $R_3$ upper bound $2$, $R_5$ upper bound $2$.\n- Case $3$ (no substrate): $R_1$ upper bound $0$, $R_3$ upper bound $1000$, $R_5$ upper bound $1000$.\n\nOutput specification:\n- For each test case, compute:\n  1. The list of essential reactions as zero-based indices.\n  2. The list of synthetic lethal pairs as lists of two zero-based indices, unordered.\n  3. The baseline optimal growth flux $v_6$ in “mmol gDW⁻¹ h⁻¹”, rounded to three decimal places.\n- Your program should produce a single line of output containing the results for all cases as a JSON-like list without spaces. Each case’s result must be a list of the form `[E,P,G]`, where `E` is the list of integers (essential reaction indices), `P` is the list of two-integer lists (synthetic lethal pairs), and `G` is the rounded float baseline growth. For example, the output format is\n`[[E_1,P_1,G_1],[E_2,P_2,G_2],[E_3,P_3,G_3]]`,\nwith no spaces anywhere in the string.",
            "solution": "This problem requires solving a series of Linear Programming (LP) problems to analyze a metabolic network. The core of the solution involves establishing the network's mass balance equations from the stoichiometric matrix $S$ and then optimizing for the biomass flux ($v_5$) under various constraints that simulate wild-type and knockout conditions.\n\n**Mass Balance Equations**\nFrom the steady-state condition $S v = 0$, we can derive the following relationships between the reaction fluxes (using 0-based indexing for fluxes $v_0$ to $v_5$):\n1.  Metabolite A: $v_0 - v_1 - v_3 = 0 \\implies v_0 = v_1 + v_3$\n2.  Metabolite B: $v_1 - v_2 = 0 \\implies v_1 = v_2$\n3.  Metabolite C: $v_2 + v_4 - v_5 = 0 \\implies v_5 = v_2 + v_4$\n4.  Metabolite D: $v_3 - v_4 = 0 \\implies v_3 = v_4$\n\nBy combining these equations, we can express the biomass production flux ($v_5$) in terms of the initial substrate uptake flux ($v_0$):\n$v_5 = v_2 + v_4 = v_1 + v_3 = v_0$\nThis key relationship shows that the maximum possible biomass production is directly equal to the rate of substrate uptake, distributed across two parallel internal pathways ($A \\to B \\to C$ and $A \\to D \\to C$).\n\n**Analysis Workflow**\nFor each test case, the following procedure is applied algorithmically:\n1.  **Baseline Growth Calculation**: An LP problem is solved to maximize $v_5$ subject to the flux bounds specified in the test case. This determines the maximum growth rate for the wild-type network. If this growth is below the lethality threshold $\\varepsilon$, the analysis for the case stops, and the result is an empty set of essential reactions and synthetic lethal pairs.\n\n2.  **Essentiality Screening**: To determine if a reaction is essential, we simulate a knockout by setting its flux to zero (i.e., setting its upper bound to 0). This is done for each reaction one by one. After each knockout, the LP is re-solved to find the new maximum growth rate. If the growth rate drops below $\\varepsilon$, the knocked-out reaction is classified as essential. In this network, the uptake reaction ($R_1$, index 0) and the biomass reaction ($R_6$, index 5) are essential, as they are the sole source and sink, respectively.\n\n3.  **Synthetic Lethality Screening**: To find synthetic lethal pairs, we consider pairs of reactions from the candidate set $\\{1, 2, 3, 4\\}$. A pair $(i, j)$ is tested only if neither reaction $i$ nor $j$ is individually essential. A double knockout is simulated by setting both $v_i$ and $v_j$ to zero. The LP is solved again. If the resulting growth is below $\\varepsilon$, the pair is classified as synthetic lethal. In this network, the two parallel pathways are redundant. Knocking out one component from each pathway simultaneously will block all flux to biomass. For instance, knocking out $R_2$ (index 1) from the first pathway and $R_4$ (index 3) from the second pathway is lethal. Similarly, knocking out $R_3$ (index 2) and $R_5$ (index 4) is also lethal.\n\nThis systematic application of LP optimization under different constraints allows for the identification of the network's vulnerabilities as requested by the problem. The provided Python code in the answer block implements this exact workflow.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Performs Flux Balance Analysis (FBA) to determine reaction essentiality and\n    synthetic lethality for a given metabolic network model.\n    \"\"\"\n\n    # Stoichiometric matrix S (4 metabolites x 6 reactions)\n    S = np.array([\n        [1., -1., 0., -1., 0., 0.],  # Metabolite A\n        [0., 1., -1., 0., 0., 0.],   # Metabolite B\n        [0., 0., 1., 0., 1., -1.],  # Metabolite C\n        [0., 0., 0., 1., -1., 0.]    # Metabolite D\n    ])\n\n    # Objective: maximize v_5 (flux of R6), so we minimize -v_5.\n    c = np.array([0., 0., 0., 0., 0., -1.])\n    \n    # Equality constraints Sv = 0\n    b_eq = np.zeros(S.shape[0])\n    \n    # Epsilon threshold for lethality\n    EPSILON = 1e-9\n\n    # Test cases with specific upper bounds\n    # Format: (v0_ub, v2_ub, v4_ub)\n    test_cases_params = [\n        (10.0, 1000.0, 1000.0),  # Case 1\n        (10.0, 2.0, 2.0),       # Case 2\n        (0.0, 1000.0, 1000.0)   # Case 3\n    ]\n\n    all_results = []\n\n    def run_fba(bounds):\n        \"\"\"Helper function to run the linear programming simulation.\"\"\"\n        res = linprog(c=c, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        if res.success:\n            # linprog minimizes, so we negate the result to get the max value\n            return -res.fun\n        return 0.0\n\n    for v0_ub, v2_ub, v4_ub in test_cases_params:\n        # --- Baseline Analysis ---\n        base_bounds = [\n            (0., v0_ub),     # v0 (R1)\n            (0., 1000.0),    # v1 (R2)\n            (0., v2_ub),     # v2 (R3)\n            (0., 1000.0),    # v3 (R4)\n            (0., v4_ub),     # v4 (R5)\n            (0., 1000.0)     # v5 (R6)\n        ]\n        \n        baseline_growth = run_fba(base_bounds)\n        \n        # Handle low-growth condition\n        if baseline_growth < EPSILON:\n            all_results.append(([], [], round(baseline_growth, 3)))\n            continue\n\n        # --- Essentiality Analysis ---\n        essential_reactions = []\n        num_reactions = S.shape[1]\n        for i in range(num_reactions):\n            knockout_bounds = list(base_bounds)\n            knockout_bounds[i] = (0., 0.)\n            growth = run_fba(knockout_bounds)\n            if growth < EPSILON:\n                essential_reactions.append(i)\n\n        # --- Synthetic Lethality Analysis ---\n        synthetic_lethal_pairs = []\n        candidate_indices = [1, 2, 3, 4]\n        \n        for i, j in combinations(candidate_indices, 2):\n            # A pair is synthetic lethal only if neither reaction is essential\n            if i in essential_reactions or j in essential_reactions:\n                continue\n\n            double_knockout_bounds = list(base_bounds)\n            double_knockout_bounds[i] = (0., 0.)\n            double_knockout_bounds[j] = (0., 0.)\n            \n            growth = run_fba(double_knockout_bounds)\n            if growth < EPSILON:\n                # Store as a sorted list for canonical representation\n                synthetic_lethal_pairs.append(sorted([i, j]))\n\n        all_results.append((essential_reactions, synthetic_lethal_pairs, round(baseline_growth, 3)))\n\n    # --- Format final output string ---\n    # This manual construction is required to avoid forbidden libraries\n    # and to match the \"no spaces\" format.\n    case_strings = []\n    for essential, lethal, growth in all_results:\n        essential_str = f\"[{','.join(map(str, essential))}]\"\n        \n        lethal_pairs_str_list = [f\"[{p[0]},{p[1]}]\" for p in lethal]\n        lethal_str = f\"[{','.join(lethal_pairs_str_list)}]\"\n        \n        growth_str = f\"{growth:.3f}\"\n        \n        case_strings.append(f\"[{essential_str},{lethal_str},{growth_str}]\")\n        \n    final_output_string = f\"[{','.join(case_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}