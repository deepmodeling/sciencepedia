{
    "hands_on_practices": [
        {
            "introduction": "To computationally analyze biological networks, we must first translate them into a mathematical format. This exercise  guides you through the foundational step of constructing an adjacency matrix, $A$, from a list of protein-protein interactions. You will then use this matrix to calculate the degree of each node, which is the most fundamental measure of a protein's connectivity within the network.",
            "id": "3910063",
            "problem": "Consider a synthetic proteinâ€“protein interaction (PPI) network representing a small subset of interacting proteins in a signaling module. The network is modeled as an undirected, unweighted, simple graph with $6$ proteins labeled $p_1, p_2, p_3, p_4, p_5, p_6$. An undirected edge between $p_i$ and $p_j$ indicates the presence of a physical interaction detected by an assay such as yeast two-hybrid; multiple edges and self-loops are disallowed. The observed interactions are given by the following unordered pairs:\n$$\\{(p_1,p_2),\\ (p_1,p_3),\\ (p_2,p_3),\\ (p_2,p_4),\\ (p_3,p_5),\\ (p_4,p_5),\\ (p_5,p_6)\\}.$$\nUsing the canonical ordering $(p_1,p_2,p_3,p_4,p_5,p_6)$ for vertices, construct the adjacency matrix $A$ of this undirected, unweighted network. Then, using only core definitions from graph theory, compute the degree $d_i$ of each node $p_i$ directly from $A$, and report the degree vector $(d_1,d_2,d_3,d_4,d_5,d_6)$ in the specified vertex order. The final answer must be given as a single row vector.",
            "solution": "The problem requires the construction of the adjacency matrix for a given protein-protein interaction (PPI) network and the subsequent calculation of the degree vector for its nodes. The network is modeled as an undirected, unweighted, simple graph.\n\nFirst, let us define the graph $G=(V, E)$, where $V$ is the set of vertices (proteins) and $E$ is the set of edges (interactions).\nThe set of vertices is given as $V = \\{p_1, p_2, p_3, p_4, p_5, p_6\\}$. The number of vertices is $|V| = 6$.\nThe set of edges, representing undirected interactions, is given by the following $7$ unordered pairs:\n$E = \\{\\{p_1,p_2\\},\\ \\{p_1,p_3\\},\\ \\{p_2,p_3\\},\\ \\{p_2,p_4\\},\\ \\{p_3,p_5\\},\\ \\{p_4,p_5\\},\\ \\{p_5,p_6\\}\\}$.\n\nThe adjacency matrix $A$ of an undirected, unweighted, simple graph with $N$ vertices is an $N \\times N$ matrix where the entry $A_{ij}$ is defined as:\n$$\nA_{ij} = \\begin{cases} 1  \\text{if an edge exists between vertex } i \\text{ and vertex } j \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nSince the graph is simple, there are no self-loops, meaning the diagonal elements $A_{ii}$ are all $0$. As the graph is undirected, the adjacency matrix is symmetric, i.e., $A_{ij} = A_{ji}$ for all $i,j$.\n\nWe will construct the $6 \\times 6$ adjacency matrix $A$ using the specified canonical ordering of vertices $(p_1,p_2,p_3,p_4,p_5,p_6)$. The rows and columns of $A$ correspond to these vertices in order.\n\nBased on the edge set $E$, we populate the non-zero off-diagonal entries of $A$:\n- An edge $\\{p_1, p_2\\}$ implies $A_{12} = A_{21} = 1$.\n- An edge $\\{p_1, p_3\\}$ implies $A_{13} = A_{31} = 1$.\n- An edge $\\{p_2, p_3\\}$ implies $A_{23} = A_{32} = 1$.\n- An edge $\\{p_2, p_4\\}$ implies $A_{24} = A_{42} = 1$.\n- An edge $\\{p_3, p_5\\}$ implies $A_{35} = A_{53} = 1$.\n- An edge $\\{p_4, p_5\\}$ implies $A_{45} = A_{54} = 1$.\n- An edge $\\{p_5, p_6\\}$ implies $A_{56} = A_{65} = 1$.\n\nAll other off-diagonal entries are $0$, and all diagonal entries are $0$. The complete adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  0  1  0 \\\\\n0  1  0  0  1  0 \\\\\n0  0  1  1  0  1 \\\\\n0  0  0  0  1  0\n\\end{pmatrix}\n$$\n\nNext, we compute the degree $d_i$ for each vertex $p_i$. The degree of a vertex in an unweighted graph is the number of edges connected to it. For a graph represented by an adjacency matrix $A$, the degree $d_i$ of vertex $p_i$ is the sum of the elements in the $i$-th row (or, due to symmetry, the $i$-th column) of $A$. The formula is:\n$$\nd_i = \\sum_{j=1}^{N} A_{ij}\n$$\nwhere $N=6$ in this case.\n\nWe apply this formula to each row of the matrix $A$:\n- For $p_1$: $d_1 = \\sum_{j=1}^{6} A_{1j} = A_{11} + A_{12} + A_{13} + A_{14} + A_{15} + A_{16} = 0 + 1 + 1 + 0 + 0 + 0 = 2$.\n- For $p_2$: $d_2 = \\sum_{j=1}^{6} A_{2j} = A_{21} + A_{22} + A_{23} + A_{24} + A_{25} + A_{26} = 1 + 0 + 1 + 1 + 0 + 0 = 3$.\n- For $p_3$: $d_3 = \\sum_{j=1}^{6} A_{3j} = A_{31} + A_{32} + A_{33} + A_{34} + A_{35} + A_{36} = 1 + 1 + 0 + 0 + 1 + 0 = 3$.\n- For $p_4$: $d_4 = \\sum_{j=1}^{6} A_{4j} = A_{41} + A_{42} + A_{43} + A_{44} + A_{45} + A_{46} = 0 + 1 + 0 + 0 + 1 + 0 = 2$.\n- For $p_5$: $d_5 = \\sum_{j=1}^{6} A_{5j} = A_{51} + A_{52} + A_{53} + A_{54} + A_{55} + A_{56} = 0 + 0 + 1 + 1 + 0 + 1 = 3$.\n- For $p_6$: $d_6 = \\sum_{j=1}^{6} A_{6j} = A_{61} + A_{62} + A_{63} + A_{64} + A_{65} + A_{66} = 0 + 0 + 0 + 0 + 1 + 0 = 1$.\n\nThe calculated degrees are $d_1 = 2$, $d_2 = 3$, $d_3 = 3$, $d_4 = 2$, $d_5 = 3$, and $d_6 = 1$.\nThe degree vector, in the specified vertex order $(p_1, p_2, p_3, p_4, p_5, p_6)$, is therefore $(d_1, d_2, d_3, d_4, d_5, d_6)$.\nThis corresponds to the vector $(2, 3, 3, 2, 3, 1)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2  3  3  2  3  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the adjacency matrix captures connectivity, other representations reveal deeper insights into network dynamics. This practice  introduces the graph Laplacian, $L$, a matrix that models diffusion-like processes such as intercellular signaling. By calculating its eigenvalues, you will identify the algebraic connectivity, $\\lambda_2$, a powerful metric that quantifies the network's resilience and the rate at which it can synchronize.",
            "id": "3909886",
            "problem": "Consider a simplified intercellular communication network among five cells, modeled as an undirected weighted graph where each edge represents normalized gap junctional conductance between cells. The network motif is a star: cell $1$ acts as a central hub connected to cells $2$, $3$, $4$, and $5$, and there are no other connections. All four hub-to-leaf connections have identical normalized weight $w = \\frac{3}{4}$. Let $A$ denote the weighted adjacency matrix, $D$ the diagonal weighted degree matrix with entries $d_{i} = \\sum_{j} A_{ij}$, and $L = D - A$ the combinatorial graph Laplacian. The algebraic connectivity is defined as the second-smallest eigenvalue $\\lambda_{2}$ of $L$. In the context of diffusion-like intercellular signaling modeled by a linear Ordinary Differential Equation (ODE) of the form $\\frac{d\\mathbf{x}}{dt} = -L \\mathbf{x}$, $\\lambda_{2}$ is a spectral quantity that influences the slowest nontrivial relaxation mode.\n\nStarting from the definitions of $A$, $D$, and $L$, and without invoking any specialized formulas that are not derived from these definitions, construct $L$ for this network, compute all eigenvalues of $L$, identify the algebraic connectivity $\\lambda_{2}$, and justify briefly how $\\lambda_{2}$ is related to the resilience of intercellular communication in this star motif. Express the final value of $\\lambda_{2}$ in exact fractional form. No rounding is required.",
            "solution": "The problem asks for the construction of the graph Laplacian matrix $L$ for a given 5-cell star network, the calculation of all its eigenvalues, the identification of the algebraic connectivity $\\lambda_2$, and a justification of its role in communication resilience.\n\nThe network consists of $n=5$ cells. Cell $1$ is the central hub, and cells $2, 3, 4, 5$ are the leaf nodes. The graph is undirected. The connections are between cell $1$ and each of the other four cells. The weight of each of these edges is given as $w = \\frac{3}{4}$. There are no other connections.\n\nFirst, we construct the weighted adjacency matrix $A$, a $5 \\times 5$ symmetric matrix where $A_{ij}$ is the weight of the edge between cell $i$ and cell $j$.\nThe non-zero off-diagonal elements are $A_{12} = A_{21} = w$, $A_{13} = A_{31} = w$, $A_{14} = A_{41} = w$, and $A_{15} = A_{51} = w$. All other off-diagonal elements are $0$. The diagonal elements $A_{ii}$ are all $0$.\nSubstituting $w = \\frac{3}{4}$, the adjacency matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0  \\frac{3}{4}  \\frac{3}{4}  \\frac{3}{4}  \\frac{3}{4} \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0\n\\end{pmatrix}\n$$\n\nNext, we construct the diagonal weighted degree matrix $D$. The diagonal entries are given by $d_{i} = \\sum_{j} A_{ij}$.\nFor the hub (cell $1$): $d_1 = A_{12} + A_{13} + A_{14} + A_{15} = w + w + w + w = 4w$.\nFor the leaves (cells $2, 3, 4, 5$): $d_2 = A_{21} = w$, $d_3 = A_{31} = w$, $d_4 = A_{41} = w$, $d_5 = A_{51} = w$.\nWith $w = \\frac{3}{4}$, we have $d_1 = 4(\\frac{3}{4}) = 3$ and $d_2=d_3=d_4=d_5 = \\frac{3}{4}$.\nThe degree matrix $D$ is:\n$$\nD = \\begin{pmatrix}\n3  0  0  0  0 \\\\\n0  \\frac{3}{4}  0  0  0 \\\\\n0  0  \\frac{3}{4}  0  0 \\\\\n0  0  0  \\frac{3}{4}  0 \\\\\n0  0  0  0  \\frac{3}{4}\n\\end{pmatrix}\n$$\n\nThe combinatorial graph Laplacian $L$ is defined as $L = D - A$.\n$$\nL = \\begin{pmatrix}\n3  -\\frac{3}{4}  -\\frac{3}{4}  -\\frac{3}{4}  -\\frac{3}{4} \\\\\n-\\frac{3}{4}  \\frac{3}{4}  0  0  0 \\\\\n-\\frac{3}{4}  0  \\frac{3}{4}  0  0 \\\\\n-\\frac{3}{4}  0  0  \\frac{3}{4}  0 \\\\\n-\\frac{3}{4}  0  0  0  \\frac{3}{4}\n\\end{pmatrix}\n$$\nIn terms of the symbolic weight $w$, this is:\n$$\nL = \\begin{pmatrix}\n4w  -w  -w  -w  -w \\\\\n-w  w  0  0  0 \\\\\n-w  0  w  0  0 \\\\\n-w  0  0  w  0 \\\\\n-w  0  0  0  w\n\\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$ of $L$, we solve the characteristic equation $L\\mathbf{v} = \\lambda\\mathbf{v}$ for non-zero eigenvectors $\\mathbf{v}$.\nFor any combinatorial Laplacian of a connected graph, the sum of each row is zero. This implies that the vector $\\mathbf{v}_1 = (1, 1, 1, 1, 1)^T$ is an eigenvector with eigenvalue $\\lambda_1 = 0$, since $L\\mathbf{v}_1 = \\mathbf{0} = 0 \\cdot \\mathbf{v}_1$. This is the smallest eigenvalue.\n\nDue to the symmetry of the leaf nodes, we can find other eigenvalues. Consider an eigenvector $\\mathbf{v}$ where the hub component is zero, $v_1=0$, and the leaf components sum to zero, $\\sum_{i=2}^5 v_i = 0$. Let's compute $L\\mathbf{v}$:\nThe first component of the resulting vector is $(L\\mathbf{v})_1 = 4wv_1 - w(v_2+v_3+v_4+v_5) = 4w(0) - w(0) = 0$. Since $v_1=0$, this matches $\\lambda v_1$.\nFor any leaf node $k \\in \\{2, 3, 4, 5\\}$, the $k$-th component is $(L\\mathbf{v})_k = -wv_1 + wv_k = -w(0) + wv_k = wv_k$. This matches $\\lambda v_k$ with $\\lambda=w$.\nThus, any vector $\\mathbf{v}$ with $v_1=0$ and $\\sum_{i=2}^5 v_i=0$ is an eigenvector with eigenvalue $\\lambda=w$. The subspace of such vectors has dimension $5 - 2 = 3$. For example, the vectors $(0, 1, -1, 0, 0)^T$, $(0, 1, 0, -1, 0)^T$, and $(0, 1, 0, 0, -1)^T$ are linearly independent vectors in this eigenspace. Therefore, the eigenvalue $\\lambda = w$ has a multiplicity of $3$.\n\nWe have found four eigenvalues: $\\lambda_1 = 0$ and $\\lambda_2=\\lambda_3=\\lambda_4=w$. The fifth eigenvalue, $\\lambda_5$, can be found using the property that the sum of the eigenvalues equals the trace of the matrix, $\\sum \\lambda_i = \\text{Tr}(L)$.\n$\\text{Tr}(L) = d_1 + d_2 + d_3 + d_4 + d_5 = 4w + w + w + w + w = 8w$.\nThe sum of the eigenvalues is $\\lambda_1 + \\lambda_2 + \\lambda_3 + \\lambda_4 + \\lambda_5 = 0 + w + w + w + \\lambda_5 = 3w + \\lambda_5$.\nEquating the two, $3w + \\lambda_5 = 8w$, which gives $\\lambda_5 = 5w$.\n\nThe eigenvalues of $L$, sorted in non-decreasing order, are:\n$\\lambda_1=0$\n$\\lambda_2=w$\n$\\lambda_3=w$\n$\\lambda_4=w$\n$\\lambda_5=5w$\n\nSubstituting the value $w=\\frac{3}{4}$:\n$\\lambda_1 = 0$\n$\\lambda_2 = \\lambda_3 = \\lambda_4 = \\frac{3}{4}$\n$\\lambda_5 = 5 \\times \\frac{3}{4} = \\frac{15}{4}$\n\nThe algebraic connectivity is defined as the second-smallest eigenvalue, $\\lambda_2$.\nTherefore, $\\lambda_2 = w = \\frac{3}{4}$.\n\nThe relationship of $\\lambda_2$ to resilience stems from the dynamical system $\\frac{d\\mathbf{x}}{dt} = -L\\mathbf{x}$. The general solution is a linear combination of modes that decay exponentially: $\\mathbf{x}(t) = \\sum_{i=1}^5 c_i e^{-\\lambda_i t} \\mathbf{v}_i$, where $\\mathbf{v}_i$ are the eigenvectors of $L$. The term associated with $\\lambda_1=0$ does not decay and represents the final consensus state where all cell concentrations are equal. All other modes decay to zero. The rate of convergence to this consensus state is governed by the slowest decaying mode, which corresponds to the smallest non-zero eigenvalue, $\\lambda_2$. The time constant for this slowest mode is $\\tau = 1/\\lambda_2$. A larger value of $\\lambda_2$ implies a smaller time constant and thus a faster convergence to the synchronized state after a perturbation. In the context of intercellular communication, this rapid synchronization is a measure of the network's resilience, as it reflects the ability of the system to efficiently distribute signals and recover a stable, uniform state. Hence, a higher algebraic connectivity $\\lambda_2$ indicates a more resilient communication network.",
            "answer": "$$\n\\boxed{\\frac{3}{4}}\n$$"
        },
        {
            "introduction": "Complex networks are often built from small, recurring patterns of interaction known as motifs, which are thought to be the functional building blocks of the system. This advanced exercise  focuses on the Feed-Forward Loop (FFL), a crucial regulatory motif, and introduces the concept of signed interactions (activation and inhibition). Your task is to not only identify these motifs but also to assess their statistical significance against a null model, a critical step in distinguishing meaningful biological design from random wiring.",
            "id": "3910102",
            "problem": "Consider a signed regulatory network modeled as a directed simple graph $G = (V, E)$ with a sign function $\\sigma : E \\to \\{-1, +1\\}$. A triad is an ordered triple of distinct nodes $(x, y, z) \\in V^3$ with $x \\neq y \\neq z \\neq x$. A Feed-Forward Loop (FFL) motif is present on a triad $(x, y, z)$ if and only if all three directed edges $(x, y)$, $(x, z)$, and $(y, z)$ are present in $E$. In a signed FFL, coherence is defined by comparing the direct path and indirect path from $x$ to $z$: the motif is coherent if $\\sigma(x, z) = \\sigma(x, y)\\cdot\\sigma(y, z)$ and incoherent otherwise. The goal is to identify all FFLs within specified triads, classify them as coherent or incoherent, and compute their expected enrichment relative to a sign-preserving null model.\n\nUse the following foundational definitions and assumptions:\n- The network is a directed simple graph with no self-loops and at most one edge per ordered pair $(u, v)$ with $u \\neq v$, endowed with a sign $\\sigma(u, v) \\in \\{-1, +1\\}$ if $(u, v) \\in E$.\n- Under the sign-preserving null model, each ordered pair $(u, v)$ with $u \\neq v$ independently has a positive edge with probability $p_+ = E_+ / M$, a negative edge with probability $p_- = E_- / M$, and no edge with probability $1 - p_+ - p_-$, where $E_+$ and $E_-$ are the counts of positive and negative edges in the observed network, and $M = |V|\\cdot(|V| - 1)$ is the number of possible ordered pairs.\n- Independence across ordered pairs is assumed for the null model when computing expectations; linearity of expectation ensures the expected count over a set of triads is the sum of expected counts per triad.\n\nYour program must:\n1. For each test case, construct the network from a provided edge list and triad list, identify all FFLs among those triads, and classify each FFL as coherent or incoherent using the rule $\\sigma(x, z) = \\sigma(x, y)\\cdot\\sigma(y, z)$.\n2. Compute the expected number of coherent and incoherent FFLs under the sign-preserving null model defined above. Let $a = p_+ = E_+ / M$ and $b = p_- = E_- / M$. For one triad, the probability that an FFL exists with coherence is\n$$\nP_{\\mathrm{coh}} = a^3 + 3\\,a\\,b^2,\n$$\nand the probability that an FFL exists with incoherence is\n$$\nP_{\\mathrm{incoh}} = 3\\,a^2\\,b + b^3.\n$$\nTherefore, for $T$ triads, the expected counts are $T\\cdot P_{\\mathrm{coh}}$ and $T\\cdot P_{\\mathrm{incoh}}$.\n3. Compute enrichment as the ratio of observed to expected counts for coherent and incoherent motifs, respectively. If an expected count is zero, define the enrichment to be $0.0$ when the observed count is zero, and $+\\infty$ when the observed count is strictly positive.\n\nTest Suite:\n- Test Case $1$ (general mixed-sign case):\n  - Nodes: $V = \\{0, 1, 2, 3, 4\\}$.\n  - Edges (each tuple is $(u, v, s)$ with $s \\in \\{-1, +1\\}$):\n    - $(0, 1, +1)$, $(0, 2, -1)$, $(1, 2, +1)$, $(1, 3, -1)$, $(0, 3, +1)$, $(3, 2, -1)$, $(2, 4, +1)$, $(0, 4, -1)$.\n  - Triads: $(0, 1, 2)$, $(0, 1, 3)$, $(0, 3, 2)$, $(1, 2, 4)$, $(0, 2, 4)$.\n- Test Case $2$ (all-positive boundary case):\n  - Nodes: $V = \\{0, 1, 2, 3\\}$.\n  - Edges: $(0, 1, +1)$, $(0, 2, +1)$, $(1, 2, +1)$, $(1, 3, +1)$, $(0, 3, +1)$, $(2, 3, +1)$.\n  - Triads: $(0, 1, 2)$, $(0, 1, 3)$, $(1, 2, 3)$.\n- Test Case $3$ (no-FFL edge case with mixed signs):\n  - Nodes: $V = \\{0, 1, 2, 3\\}$.\n  - Edges: $(0, 1, +1)$, $(3, 1, +1)$, $(0, 3, -1)$, $(2, 3, -1)$.\n  - Triads: $(0, 2, 3)$, $(1, 2, 3)$.\n\nProgram output specification:\n- For each test case, output the list $[O_{\\mathrm{coh}}, O_{\\mathrm{incoh}}, E_{\\mathrm{coh}}, E_{\\mathrm{incoh}}, R_{\\mathrm{coh}}, R_{\\mathrm{incoh}}]$, where $O_{\\mathrm{coh}}$ and $O_{\\mathrm{incoh}}$ are integers (observed counts), $E_{\\mathrm{coh}}$ and $E_{\\mathrm{incoh}}$ are floats rounded to $6$ decimal places (expected counts), and $R_{\\mathrm{coh}}$ and $R_{\\mathrm{incoh}}$ are enrichment ratios rounded to $6$ decimal places when finite and set to $+\\infty$ when the expected count is zero and the observed count is positive.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and ordered by test case. For example, a valid output has the form $[[\\dots],[\\dots],[\\dots]]$ where each inner list corresponds to one test case in the order given above.\n\nAll computations are strictly mathematical and unitless; angles are not applicable. The algorithm must be logically derived from the stated definitions and assumptions without using any shortcuts beyond those foundations.",
            "solution": "The problem is to identify and classify signed Feed-Forward Loop ($\\mathrm{FFL}$) motifs in a directed graph, and to compute their statistical enrichment against a sign-preserving null model. The problem is well-posed, scientifically grounded, and provides all necessary definitions and data for a unique solution.\n\nThe solution proceeds in four primary stages:\n1.  Representation of the network and input data.\n2.  Identification and classification of observed $\\mathrm{FFL}$s.\n3.  Calculation of expected $\\mathrm{FFL}$ counts under the specified null model.\n4.  Computation of enrichment scores.\n\n**1. Network Representation**\n\nThe signed directed graph $G = (V, E)$ with sign function $\\sigma : E \\to \\{-1, +1\\}$ can be efficiently represented using an adjacency matrix or an adjacency dictionary. Given the small size and potentially sparse nature of the networks in the test cases, an adjacency dictionary is a practical choice. This structure maps an ordered pair of nodes $(u, v)$ to the sign of the edge, $\\sigma(u, v)$, if an edge exists. For any pair $(u, v)$ not in $E$, we can consider its sign to be $0$. Let this representation be denoted by a function $\\text{adj}(u, v)$, such that $\\text{adj}(u, v) = \\sigma(u, v)$ if $(u, v) \\in E$, and $\\text{adj}(u, v) = 0$ otherwise.\n\n**2. Observed Motif Identification and Counting**\n\nAn $\\mathrm{FFL}$ motif is defined on an ordered, distinct triad of nodes $(x, y, z)$. The structural requirement for an $\\mathrm{FFL}$ is the simultaneous presence of three directed edges: $(x, y)$, $(x, z)$, and $(y, z)$.\n\nFor each triad $(x, y, z)$ supplied in the problem, we check for the existence of these three edges. This is equivalent to checking if $\\text{adj}(x, y) \\neq 0$, $\\text{adj}(x, z) \\neq 0$, and $\\text{adj}(y, z) \\neq 0$.\n\nIf an $\\mathrm{FFL}$ is present, it is classified as either coherent or incoherent. The coherence condition is defined by comparing the sign of the direct path from $x$ to $z$ with the sign of the indirect path through $y$.\n-   An $\\mathrm{FFL}$ is **coherent** if the product of the signs of the indirect path equals the sign of the direct path: $\\sigma(x, y) \\cdot \\sigma(y, z) = \\sigma(x, z)$.\n-   An $\\mathrm{FFL}$ is **incoherent** otherwise: $\\sigma(x, y) \\cdot \\sigma(y, z) = -\\sigma(x, z)$.\n\nBy iterating through the provided list of triads for each test case, we count the number of observed coherent $\\mathrm{FFL}$s, denoted $O_{\\mathrm{coh}}$, and observed incoherent $\\mathrm{FFL}$s, denoted $O_{\\mathrm{incoh}}$.\n\n**3. Null Model and Expected Counts**\n\nThe problem defines a sign-preserving null model to assess the statistical significance of the observed counts. In this model, the formation of each edge is an independent random event.\n\nFirst, we establish the parameters of the model based on the observed graph:\n-   $|V|$: the number of nodes in the graph.\n-   $M = |V|(|V| - 1)$: the total number of possible directed edges between distinct nodes.\n-   $E_+$: the total count of positive ($+1$) edges in the observed graph.\n-   $E_-$: the total count of negative ($-1$) edges in the observed graph.\n\nFrom these, we define the probabilities for any given ordered pair of distinct nodes $(u, v)$:\n-   The probability of a positive edge is $a = p_+ = E_+ / M$.\n-   The probability of a negative edge is $b = p_- = E_- / M$.\n-   The probability of no edge is $1 - a - b$.\n\nThe problem is to find the probability that an arbitrary triad $(x, y, z)$ forms a coherent or incoherent $\\mathrm{FFL}$. An $\\mathrm{FFL}$ requires the existence of edges $(x, y), (x, z), (y, z)$. Let their signs be $s_{xy}, s_{xz}, s_{yz} \\in \\{-1, +1\\}$.\n\nFor a **coherent** $\\mathrm{FFL}$, the signs must satisfy $s_{xz} = s_{xy} \\cdot s_{yz}$. The possible sign combinations $(s_{xy}, s_{yz}, s_{xz})$ and their probabilities are:\n-   $(+1, +1, +1)$: Probability is $a \\cdot a \\cdot a = a^3$.\n-   $(+1, -1, -1)$: Probability is $a \\cdot b \\cdot b = ab^2$.\n-   $(-1, +1, -1)$: Probability is $b \\cdot a \\cdot b = ab^2$.\n-   $(-1, -1, +1)$: Probability is $b \\cdot b \\cdot a = ab^2$.\nSumming these probabilities, the total probability of a coherent $\\mathrm{FFL}$ on a given triad is $P_{\\mathrm{coh}} = a^3 + 3ab^2$.\n\nFor an **incoherent** $\\mathrm{FFL}$, the signs must satisfy $s_{xz} = -s_{xy} \\cdot s_{yz}$. The possible sign combinations are:\n-   $(+1, +1, -1)$: Probability is $a \\cdot a \\cdot b = a^2b$.\n-   $(+1, -1, +1)$: Probability is $a \\cdot b \\cdot a = a^2b$.\n-   $(-1, +1, +1)$: Probability is $b \\cdot a \\cdot a = a^2b$.\n-   $(-1, -1, -1)$: Probability is $b \\cdot b \\cdot b = b^3$.\nSumming these probabilities, the total probability of an incoherent $\\mathrm{FFL}$ on a given triad is $P_{\\mathrm{incoh}} = 3a^2b + b^3$.\n\nGiven a list of $T$ triads to investigate, the expected counts are derived from the linearity of expectation. The expected number of coherent and incoherent $\\mathrm{FFL}$s are:\n$$E_{\\mathrm{coh}} = T \\cdot P_{\\mathrm{coh}}$$\n$$E_{\\mathrm{incoh}} = T \\cdot P_{\\mathrm{incoh}}$$\n\n**4. Enrichment Calculation**\n\nThe enrichment ratio, $R$, quantifies how much more (or less) frequently a motif is observed compared to its expectation in the null model. It is defined as the ratio of the observed count to the expected count:\n$$R_{\\mathrm{coh}} = \\frac{O_{\\mathrm{coh}}}{E_{\\mathrm{coh}}}$$\n$$R_{\\mathrm{incoh}} = \\frac{O_{\\mathrm{incoh}}}{E_{\\mathrm{incoh}}}$$\n\nA special case arises when an expected count is zero. The problem specifies the following handling:\n-   If $E = 0$ and $O = 0$, the enrichment $R$ is defined as $0.0$.\n-   If $E = 0$ and $O > 0$, the enrichment $R$ is defined as $+\\infty$.\n\nBy implementing these steps for each provided test case, we can compute the required list of values: $[O_{\\mathrm{coh}}, O_{\\mathrm{incoh}}, E_{\\mathrm{coh}}, E_{\\mathrm{incoh}}, R_{\\mathrm{coh}}, R_{\\mathrm{incoh}}]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the FFL analysis problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"num_nodes\": 5,\n            \"edges\": [\n                (0, 1, 1), (0, 2, -1), (1, 2, 1), (1, 3, -1), (0, 3, 1),\n                (3, 2, -1), (2, 4, 1), (0, 4, -1)\n            ],\n            \"triads\": [\n                (0, 1, 2), (0, 1, 3), (0, 3, 2), (1, 2, 4), (0, 2, 4)\n            ]\n        },\n        {\n            \"num_nodes\": 4,\n            \"edges\": [\n                (0, 1, 1), (0, 2, 1), (1, 2, 1), (1, 3, 1), (0, 3, 1), (2, 3, 1)\n            ],\n            \"triads\": [\n                (0, 1, 2), (0, 1, 3), (1, 2, 3)\n            ]\n        },\n        {\n            \"num_nodes\": 4,\n            \"edges\": [\n                (0, 1, 1), (3, 1, 1), (0, 3, -1), (2, 3, -1)\n            ],\n            \"triads\": [\n                (0, 2, 3), (1, 2, 3)\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case[\"num_nodes\"], case[\"edges\"], case[\"triads\"])\n        results.append(result)\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res_list in results:\n        inner_list_str = []\n        for item in res_list:\n            if isinstance(item, int):\n                inner_list_str.append(str(item))\n            elif item == float('inf'):\n                inner_list_str.append('inf')\n            elif isinstance(item, float):\n                inner_list_str.append(f\"{item:.6f}\")\n        formatted_results.append(f\"[{','.join(inner_list_str)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef process_case(num_nodes, edges, triads):\n    \"\"\"\n    Processes a single test case to find FFLs and calculate enrichment.\n    \"\"\"\n    # 1. Construct graph representation and count edge signs\n    graph = {}\n    e_plus = 0\n    e_minus = 0\n    for u, v, s in edges:\n        graph[(u, v)] = s\n        if s == 1:\n            e_plus += 1\n        elif s == -1:\n            e_minus += 1\n\n    # 2. Identify and classify observed FFLs\n    o_coh = 0\n    o_incoh = 0\n    for x, y, z in triads:\n        s_xy = graph.get((x, y), 0)\n        s_xz = graph.get((x, z), 0)\n        s_yz = graph.get((y, z), 0)\n\n        # Check if it's an FFL\n        if s_xy != 0 and s_xz != 0 and s_yz != 0:\n            if s_xz == s_xy * s_yz:\n                o_coh += 1\n            else:\n                o_incoh += 1\n    \n    # 3. Compute expected counts from the null model\n    m = num_nodes * (num_nodes - 1)\n    a = e_plus / m if m > 0 else 0\n    b = e_minus / m if m > 0 else 0\n    \n    num_triads = len(triads)\n    \n    p_coh = a**3 + 3 * a * b**2\n    p_incoh = 3 * a**2 * b + b**3\n    \n    e_coh = num_triads * p_coh\n    e_incoh = num_triads * p_incoh\n\n    # 4. Compute enrichment ratios\n    # Coherent enrichment\n    if e_coh == 0:\n        r_coh = 0.0 if o_coh == 0 else float('inf')\n    else:\n        r_coh = o_coh / e_coh\n    \n    # Incoherent enrichment\n    if e_incoh == 0:\n        r_incoh = 0.0 if o_incoh == 0 else float('inf')\n    else:\n        r_incoh = o_incoh / e_incoh\n\n    return [o_coh, o_incoh, e_coh, e_incoh, r_coh, r_incoh]\n\nsolve()\n```"
        }
    ]
}