{
    "hands_on_practices": [
        {
            "introduction": "分析生物网络的第一步是将其连接关系转化为一种数学形式。练习  将引导您完成这一基本过程，从一个蛋白质相互作用列表构建邻接矩阵。然后，您将使用这个矩阵来计算每个蛋白质的度，这是衡量其在网络中连通性的最基本指标。",
            "id": "3910063",
            "problem": "考虑一个合成的蛋白质-蛋白质相互作用（PPI）网络，它代表了信号模块中相互作用蛋白质的一个小子集。该网络被建模为一个无向、无权、简单的图，包含 $6$ 个标记为 $p_1, p_2, p_3, p_4, p_5, p_6$ 的蛋白质。$p_i$ 和 $p_j$ 之間的一条无向边表示存在通过酵母双杂交等实验检测到的物理相互作用；不允许存在多重边和自环。观测到的相互作用由以下无序对给出：\n$$\\{(p_1,p_2),\\ (p_1,p_3),\\ (p_2,p_3),\\ (p_2,p_4),\\ (p_3,p_5),\\ (p_4,p_5),\\ (p_5,p_6)\\}.$$\n使用顶点的规范排序 $(p_1,p_2,p_3,p_4,p_5,p_6)$，构建这个无向、无权网络的邻接矩阵 $A$。然后，仅使用图论的核心定义，直接从 $A$ 计算每个节点 $p_i$ 的度 $d_i$，并按指定的顶点顺序报告度向量 $(d_1,d_2,d_3,d_4,d_5,d_6)$。最终答案必须以单个行向量的形式给出。",
            "solution": "该问题要求为一个给定的蛋白质-蛋白质相互作用（PPI）网络构建邻接矩阵，并随后计算其节点的度向量。该网络被建模为一个无向、无权、简单的图。\n\n首先，我们定义图 $G=(V, E)$，其中 $V$ 是顶点（蛋白质）的集合，$E$ 是边（相互作用）的集合。\n顶点集合为 $V = \\{p_1, p_2, p_3, p_4, p_5, p_6\\}$。顶点的数量为 $|V| = 6$。\n代表无向相互作用的边集合由以下 $7$ 个无序对给出：\n$E = \\{\\{p_1,p_2\\},\\ \\{p_1,p_3\\},\\ \\{p_2,p_3\\},\\ \\{p_2,p_4\\},\\ \\{p_3,p_5\\},\\ \\{p_4,p_5\\},\\ \\{p_5,p_6\\}\\}$。\n\n一个包含 $N$ 个顶点的无向、无权、简单图的邻接矩阵 $A$ 是一个 $N \\times N$ 矩阵，其中元素 $A_{ij}$ 定义为：\n$$\nA_{ij} = \\begin{cases} 1  \\text{如果顶点 } i \\text{ 和顶点 } j \\text{ 之间存在边} \\\\ 0  \\text{否则} \\end{cases}\n$$\n由于该图是简单图，不存在自环，这意味着对角线元素 $A_{ii}$ 均为 $0$。由于该图是无向的，邻接矩阵是对称的，即对所有的 $i,j$ 都有 $A_{ij} = A_{ji}$。\n\n我们将使用指定的顶点规范排序 $(p_1,p_2,p_3,p_4,p_5,p_6)$ 来构建 $6 \\times 6$ 的邻接矩阵 $A$。$A$ 的行和列按顺序对应于这些顶点。\n\n根据边集合 $E$，我们填充 $A$ 的非零非对角线元素：\n- 一条边 $\\{p_1, p_2\\}$ 意味着 $A_{12} = A_{21} = 1$。\n- 一条边 $\\{p_1, p_3\\}$ 意味着 $A_{13} = A_{31} = 1$。\n- 一条边 $\\{p_2, p_3\\}$ 意味着 $A_{23} = A_{32} = 1$。\n- 一条边 $\\{p_2, p_4\\}$ 意味着 $A_{24} = A_{42} = 1$。\n- 一条边 $\\{p_3, p_5\\}$ 意味着 $A_{35} = A_{53} = 1$。\n- 一条边 $\\{p_4, p_5\\}$ 意味着 $A_{45} = A_{54} = 1$。\n- 一条边 $\\{p_5, p_6\\}$ 意味着 $A_{56} = A_{65} = 1$。\n\n所有其他非对角线元素均为 $0$，所有对角线元素也均为 $0$。完整的邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  0  1  0 \\\\\n0  1  0  0  1  0 \\\\\n0  0  1  1  0  1 \\\\\n0  0  0  0  1  0\n\\end{pmatrix}\n$$\n\n接下来，我们计算每个顶点 $p_i$ 的度 $d_i$。在无权图中，一个顶点的度是连接到它的边的数量。对于由邻接矩阵 $A$ 表示的图，顶点 $p_i$ 的度 $d_i$ 是 $A$ 的第 $i$ 行（或者由于对称性，第 $i$ 列）元素的总和。公式为：\n$$\nd_i = \\sum_{j=1}^{N} A_{ij}\n$$\n在此情况下，$N=6$。\n\n我们将此公式应用于矩阵 $A$ 的每一行：\n- 对于 $p_1$：$d_1 = \\sum_{j=1}^{6} A_{1j} = A_{11} + A_{12} + A_{13} + A_{14} + A_{15} + A_{16} = 0 + 1 + 1 + 0 + 0 + 0 = 2$。\n- 对于 $p_2$：$d_2 = \\sum_{j=1}^{6} A_{2j} = A_{21} + A_{22} + A_{23} + A_{24} + A_{25} + A_{26} = 1 + 0 + 1 + 1 + 0 + 0 = 3$。\n- 对于 $p_3$：$d_3 = \\sum_{j=1}^{6} A_{3j} = A_{31} + A_{32} + A_{33} + A_{34} + A_{35} + A_{36} = 1 + 1 + 0 + 0 + 1 + 0 = 3$。\n- 对于 $p_4$：$d_4 = \\sum_{j=1}^{6} A_{4j} = A_{41} + A_{42} + A_{43} + A_{44} + A_{45} + A_{46} = 0 + 1 + 0 + 0 + 1 + 0 = 2$。\n- 对于 $p_5$：$d_5 = \\sum_{j=1}^{6} A_{5j} = A_{51} + A_{52} + A_{53} + A_{54} + A_{55} + A_{56} = 0 + 0 + 1 + 1 + 0 + 1 = 3$。\n- 对于 $p_6$：$d_6 = \\sum_{j=1}^{6} A_{6j} = A_{61} + A_{62} + A_{63} + A_{64} + A_{65} + A_{66} = 0 + 0 + 0 + 0 + 1 + 0 = 1$。\n\n计算出的度为 $d_1 = 2$、$d_2 = 3$、$d_3 = 3$、$d_4 = 2$、$d_5 = 3$ 和 $d_6 = 1$。\n因此，按指定的顶点顺序 $(p_1, p_2, p_3, p_4, p_5, p_6)$，度向量为 $(d_1, d_2, d_3, d_4, d_5, d_6)$。\n这对应于向量 $(2, 3, 3, 2, 3, 1)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2  3  3  2  3  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然邻接矩阵描述了连通性，但图拉普拉斯矩阵能够更深入地揭示网络的动态特性。在实践  中，您将为一个模型细胞网络构建拉普拉斯矩阵并计算其特征值。这将使您能够确定代数连通度（$ \\lambda_2 $），这是一个关键的光谱度量，它量化了网络的弹性和信号传播的速度。",
            "id": "3909886",
            "problem": "考虑一个由五个细胞组成的简化胞间通讯网络，该网络被建模为一个无向加权图，其中每条边代表细胞间归一化的间隙连接电导。该网络基序为星形结构：细胞 $1$ 作为中心枢纽，连接到细胞 $2$、$3$、$4$ 和 $5$，此外无其他连接。所有四个从中心到叶子的连接具有相同的归一化权重 $w = \\frac{3}{4}$。令 $A$ 表示加权邻接矩阵，$D$ 表示加权度对角矩阵（其元素为 $d_{i} = \\sum_{j} A_{ij}$），$L = D - A$ 表示组合图拉普拉斯矩阵。代数连通度定义为 $L$ 的第二小特征值 $\\lambda_{2}$。在由线性常微分方程（ODE）$\\frac{d\\mathbf{x}}{dt} = -L \\mathbf{x}$ 建模的类扩散胞间信号传导背景下，$\\lambda_{2}$ 是一个影响最慢非平凡松弛模式的谱量。\n\n从 $A$、$D$ 和 $L$ 的定义出发，并且不使用任何非由这些定义推导出的专门公式，为该网络构建 $L$，计算 $L$ 的所有特征值，确定代数连通度 $\\lambda_{2}$，并简要论证 $\\lambda_{2}$ 如何与该星形基序中胞间通讯的弹性相关。请用精确分数形式表示 $\\lambda_{2}$ 的最终值。无需四舍五入。",
            "solution": "问题要求为给定的5细胞星形网络构建图拉普拉斯矩阵 $L$，计算其所有特征值，确定代数连通度 $\\lambda_2$，并论证其在通讯弹性中的作用。\n\n该网络由 $n=5$ 个细胞组成。细胞 $1$ 是中心枢纽，细胞 $2, 3, 4, 5$ 是叶节点。该图是无向的。连接存在于细胞 $1$ 与其他四个细胞之间。每条边的权重给定为 $w = \\frac{3}{4}$。无其他连接。\n\n首先，我们构建加权邻接矩阵 $A$，这是一个 $5 \\times 5$ 的对称矩阵，其中 $A_{ij}$ 是细胞 $i$ 和细胞 $j$ 之间边的权重。\n非零的非对角线元素为 $A_{12} = A_{21} = w$，$A_{13} = A_{31} = w$，$A_{14} = A_{41} = w$ 和 $A_{15} = A_{51} = w$。所有其他非对角线元素为 $0$。对角线元素 $A_{ii}$ 均为 $0$。\n代入 $w = \\frac{3}{4}$，邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  \\frac{3}{4}  \\frac{3}{4}  \\frac{3}{4}  \\frac{3}{4} \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0 \\\\\n\\frac{3}{4}  0  0  0  0\n\\end{pmatrix}\n$$\n\n接下来，我们构建加权度对角矩阵 $D$。对角线元素由 $d_{i} = \\sum_{j} A_{ij}$ 给出。\n对于中心枢纽（细胞 $1$）：$d_1 = A_{12} + A_{13} + A_{14} + A_{15} = w + w + w + w = 4w$。\n对于叶节点（细胞 $2, 3, 4, 5$）：$d_2 = A_{21} = w$，$d_3 = A_{31} = w$，$d_4 = A_{41} = w$，$d_5 = A_{51} = w$。\n当 $w = \\frac{3}{4}$ 时，我们有 $d_1 = 4(\\frac{3}{4}) = 3$ 且 $d_2=d_3=d_4=d_5 = \\frac{3}{4}$。\n度矩阵 $D$ 为：\n$$\nD = \\begin{pmatrix}\n3  0  0  0  0 \\\\\n0  \\frac{3}{4}  0  0  0 \\\\\n0  0  \\frac{3}{4}  0  0 \\\\\n0  0  0  \\frac{3}{4}  0 \\\\\n0  0  0  0  \\frac{3}{4}\n\\end{pmatrix}\n$$\n\n组合图拉普拉斯矩阵 $L$ 定义为 $L = D - A$。\n$$\nL = \\begin{pmatrix}\n3  -\\frac{3}{4}  -\\frac{3}{4}  -\\frac{3}{4}  -\\frac{3}{4} \\\\\n-\\frac{3}{4}  \\frac{3}{4}  0  0  0 \\\\\n-\\frac{3}{4}  0  \\frac{3}{4}  0  0 \\\\\n-\\frac{3}{4}  0  0  \\frac{3}{4}  0 \\\\\n-\\frac{3}{4}  0  0  0  \\frac{3}{4}\n\\end{pmatrix}\n$$\n用符号权重 $w$ 表示，此矩阵为：\n$$\nL = \\begin{pmatrix}\n4w  -w  -w  -w  -w \\\\\n-w  w  0  0  0 \\\\\n-w  0  w  0  0 \\\\\n-w  0  0  w  0 \\\\\n-w  0  0  0  w\n\\end{pmatrix}\n$$\n为了找到 $L$ 的特征值 $\\lambda$，我们求解特征方程 $L\\mathbf{v} = \\lambda\\mathbf{v}$，其中 $\\mathbf{v}$ 为非零特征向量。\n对于任何连通图的组合拉普拉斯矩阵，其每行之和为零。这意味着向量 $\\mathbf{v}_1 = (1, 1, 1, 1, 1)^T$ 是一个特征值为 $\\lambda_1 = 0$ 的特征向量，因为 $L\\mathbf{v}_1 = \\mathbf{0} = 0 \\cdot \\mathbf{v}_1$。这是最小的特征值。\n\n由于叶节点的对称性，我们可以找到其他特征值。考虑一个特征向量 $\\mathbf{v}$，其中枢纽分量为零，$v_1=0$，且叶分量之和为零，$\\sum_{i=2}^5 v_i = 0$。让我们计算 $L\\mathbf{v}$：\n结果向量的第一个分量是 $(L\\mathbf{v})_1 = 4wv_1 - w(v_2+v_3+v_4+v_5) = 4w(0) - w(0) = 0$。因为 $v_1=0$，这与 $\\lambda v_1$ 相匹配。\n对于任何叶节点 $k \\in \\{2, 3, 4, 5\\}$，第 $k$ 个分量是 $(L\\mathbf{v})_k = -wv_1 + wv_k = -w(0) + wv_k = wv_k$。这与 $\\lambda v_k$ 相匹配，其中 $\\lambda=w$。\n因此，任何满足 $v_1=0$ 和 $\\sum_{i=2}^5 v_i=0$ 的向量 $\\mathbf{v}$ 都是特征值为 $\\lambda=w$ 的特征向量。这类向量构成的子空间维度为 $5 - 2 = 3$。例如，向量 $(0, 1, -1, 0, 0)^T$、$(0, 1, 0, -1, 0)^T$ 和 $(0, 1, 0, 0, -1)^T$ 是该特征空间中的线性无关向量。因此，特征值 $\\lambda = w$ 的重数为 $3$。\n\n我们已经找到了四个特征值：$\\lambda_1 = 0$ 和 $\\lambda_2=\\lambda_3=\\lambda_4=w$。第五个特征值 $\\lambda_5$ 可以利用“特征值之和等于矩阵的迹”这一性质来找到，即 $\\sum \\lambda_i = \\text{Tr}(L)$。\n$\\text{Tr}(L) = d_1 + d_2 + d_3 + d_4 + d_5 = 4w + w + w + w + w = 8w$。\n特征值之和为 $\\lambda_1 + \\lambda_2 + \\lambda_3 + \\lambda_4 + \\lambda_5 = 0 + w + w + w + \\lambda_5 = 3w + \\lambda_5$。\n令二者相等，$3w + \\lambda_5 = 8w$，解得 $\\lambda_5 = 5w$。\n\n$L$ 的特征值按非递减顺序排序为：\n$\\lambda_1=0$\n$\\lambda_2=w$\n$\\lambda_3=w$\n$\\lambda_4=w$\n$\\lambda_5=5w$\n\n代入值 $w=\\frac{3}{4}$：\n$\\lambda_1 = 0$\n$\\lambda_2 = \\lambda_3 = \\lambda_4 = \\frac{3}{4}$\n$\\lambda_5 = 5 \\times \\frac{3}{4} = \\frac{15}{4}$\n\n代数连通度定义为第二小特征值 $\\lambda_2$。\n因此，$\\lambda_2 = w = \\frac{3}{4}$。\n\n$\\lambda_2$ 与弹性的关系源于动力系统 $\\frac{d\\mathbf{x}}{dt} = -L\\mathbf{x}$。通解是指数衰减模式的线性组合：$\\mathbf{x}(t) = \\sum_{i=1}^5 c_i e^{-\\lambda_i t} \\mathbf{v}_i$，其中 $\\mathbf{v}_i$ 是 $L$ 的特征向量。与 $\\lambda_1=0$ 相关的项不衰减，代表最终所有细胞浓度相等的共识状态。所有其他模式都衰减至零。收敛到该共识状态的速率由最慢的衰减模式决定，该模式对应于最小的非零特征值 $\\lambda_2$。这个最慢模式的时间常数是 $\\tau = 1/\\lambda_2$。一个较大的 $\\lambda_2$ 值意味着一个较小的时间常数，从而在受到扰动后能更快地收敛到同步状态。在胞间通讯的背景下，这种快速同步是网络弹性的衡量标准，因为它反映了系统有效分配信号并恢复到一个稳定、均匀状态的能力。因此，更高的代数连通度 $\\lambda_2$ 表示一个更具弹性的通讯网络。",
            "answer": "$$\n\\boxed{\\frac{3}{4}}\n$$"
        },
        {
            "introduction": "复杂的网络通常由小的、重复出现的相互作用模式（称为网络基序）构成，这些基序执行特定的功能。这个计算练习  聚焦于著名的前馈环（FFL）基序。您不仅将学会在一个有符号的调控网络中识别和分类这些基序，还将通过将其频率与随机零模型中的频率进行比较来评估其统计显著性，这是发现生物系统中非随机设计原则的核心技术。",
            "id": "3910102",
            "problem": "考虑一个有符号调控网络，其模型为一个有向简单图 $G = (V, E)$，并带有一个符号函数 $\\sigma : E \\to \\{-1, +1\\}$。一个三元组是指一个由三个不同节点组成的有序三元组 $(x, y, z) \\in V^3$，满足 $x \\neq y \\neq z \\neq x$。当且仅当三条有向边 $(x, y)$、$(x, z)$ 和 $(y, z)$ 都存在于 $E$ 中时，一个前馈环 (FFL) 模体就存在于三元组 $(x, y, z)$ 上。在一个有符号 FFL 中，相干性通过比较从 $x$到 $z$ 的直接路径和间接路径来定义：如果 $\\sigma(x, z) = \\sigma(x, y)\\cdot\\sigma(y, z)$，则该模体是相干的，否则是非相干的。目标是识别指定三元组中的所有 FFL，将其分类为相干或非相干，并计算它们相对于一个符号保持零模型的期望富集度。\n\n使用以下基本定义和假设：\n- 网络是一个有向简单图，没有自环，且对于任意 $u \\neq v$，每个有序对 $(u, v)$ 最多只有一条边。如果边 $(u, v) \\in E$，则其带有一个符号 $\\sigma(u, v) \\in \\{-1, +1\\}$。\n- 在符号保持零模型下，每个有序对 $(u, v)$（其中 $u \\neq v$）独立地以概率 $p_+ = E_+ / M$ 成为一条正边，以概率 $p_- = E_- / M$ 成为一条负边，以概率 $1 - p_+ - p_-$ 没有边。其中 $E_+$ 和 $E_-$ 是观测网络中正边和负边的数量，而 $M = |V|\\cdot(|V| - 1)$ 是所有可能的有序对数量。\n- 在计算期望时，零模型假设不同有序对之间是相互独立的；期望的线性性确保了一组三元组的总期望计数是每个三元组期望计数的总和。\n\n你的程序必须：\n1. 对于每个测试用例，根据提供的边列表和三元组列表构建网络，识别这些三元组中的所有 FFL，并使用规则 $\\sigma(x, z) = \\sigma(x, y)\\cdot\\sigma(y, z)$ 将每个 FFL 分类为相干或非相干。\n2. 在上述定义的符号保持零模型下，计算相干和非相干 FFL 的期望数量。设 $a = p_+ = E_+ / M$ 和 $b = p_- = E_- / M$。对于一个三元组，存在一个相干 FFL 的概率是\n$$\nP_{\\mathrm{coh}} = a^3 + 3\\,a\\,b^2,\n$$\n存在一个非相干 FFL 的概率是\n$$\nP_{\\mathrm{incoh}} = 3\\,a^2\\,b + b^3.\n$$\n因此，对于 $T$ 个三元组，期望计数分别为 $T\\cdot P_{\\mathrm{coh}}$ 和 $T\\cdot P_{\\mathrm{incoh}}$。\n3. 分别计算相干和非相干模体的富集度，即观测计数与期望计数的比值。如果期望计数为零，当观测计数也为零时，定义富集度为 $0.0$；当观测计数为严格正数时，定义富集度为 $+\\infty$。\n\n测试套件：\n- 测试用例 1（一般混合符号情况）：\n  - 节点：$V = \\{0, 1, 2, 3, 4\\}$。\n  - 边（每个元组为 $(u, v, s)$，其中 $s \\in \\{-1, +1\\}$）：\n    - $(0, 1, +1)$, $(0, 2, -1)$, $(1, 2, +1)$, $(1, 3, -1)$, $(0, 3, +1)$, $(3, 2, -1)$, $(2, 4, +1)$, $(0, 4, -1)$。\n  - 三元组：$(0, 1, 2)$, $(0, 1, 3)$, $(0, 3, 2)$, $(1, 2, 4)$, $(0, 2, 4)$。\n- 测试用例 2（全正边界情况）：\n  - 节点：$V = \\{0, 1, 2, 3\\}$。\n  - 边：$(0, 1, +1)$, $(0, 2, +1)$, $(1, 2, +1)$, $(1, 3, +1)$, $(0, 3, +1)$, $(2, 3, +1)$。\n  - 三元组：$(0, 1, 2)$, $(0, 1, 3)$, $(1, 2, 3)$。\n- 测试用例 3（无 FFL 边情况，混合符号）：\n  - 节点：$V = \\{0, 1, 2, 3\\}$。\n  - 边：$(0, 1, +1)$, $(3, 1, +1)$, $(0, 3, -1)$, $(2, 3, -1)$。\n  - 三元组：$(0, 2, 3)$, $(1, 2, 3)$。\n\n程序输出规范：\n- 对于每个测试用例，输出列表 $[O_{\\mathrm{coh}}, O_{\\mathrm{incoh}}, E_{\\mathrm{coh}}, E_{\\mathrm{incoh}}, R_{\\mathrm{coh}}, R_{\\mathrm{incoh}}]$，其中 $O_{\\mathrm{coh}}$ 和 $O_{\\mathrm{incoh}}$ 是整数（观测计数），$E_{\\mathrm{coh}}$ 和 $E_{\\mathrm{incoh}}$ 是四舍五入到 $6$ 位小数的浮点数（期望计数），$R_{\\mathrm{coh}}$ 和 $R_{\\mathrm{incoh}}$ 是富集比，当其为有限值时四舍五入到 $6$ 位小数，当期望计数为零且观测计数为正时设为 $+\\infty$。\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，并按测试用例的顺序排列。例如，一个有效的输出形式为 $[[\\dots],[\\dots],[\\dots]]$，其中每个内部列表对应于上面给出的一个测试用例。\n\n所有计算都严格是数学上的且无单位；角度不适用。算法必须从给定的定义和假设中逻辑推导得出，不得使用超出这些基础的任何捷径。",
            "solution": "问题是在一个有向图中识别和分类有符号的前馈环 ($\\mathrm{FFL}$) 模体，并计算它们相对于一个符号保持零模型的统计富集度。该问题定义明确，具有科学依据，并为获得唯一解提供了所有必要的定义和数据。\n\n解决方案主要分四个阶段进行：\n1.  网络和输入数据的表示。\n2.  观测到的 $\\mathrm{FFL}$ 的识别和分类。\n3.  在指定的零模型下计算期望的 $\\mathrm{FFL}$ 数量。\n4.  富集分数的计算。\n\n**1. 网络表示**\n\n带有符号函数 $\\sigma : E \\to \\{-1, +1\\}$ 的有符号有向图 $G = (V, E)$ 可以通过邻接矩阵或邻接字典高效地表示。考虑到测试用例中网络的规模较小且可能稀疏，邻接字典是一个实用的选择。该结构将一个节点有序对 $(u, v)$ 映射到边的符号 $\\sigma(u, v)$（如果边存在）。对于任何不在 $E$ 中的对 $(u, v)$，我们可以认为其符号为 $0$。我们将此表示法记作一个函数 `adj(u, v)`，使得如果 $(u, v) \\in E$，则 `adj`$(u, v) = \\sigma(u, v)$，否则 `adj`$(u, v) = 0$。\n\n**2. 观测模体的识别和计数**\n\n$\\mathrm{FFL}$ 模体定义在一个由有序、不同节点组成的三元组 $(x, y, z)$ 上。$\\mathrm{FFL}$ 的结构要求是同时存在三条有向边：$(x, y)$、$(x, z)$ 和 $(y, z)$。\n\n对于问题中提供的每个三元组 $(x, y, z)$，我们检查这三条边的存在性。这等同于检查 $\\text{adj}(x, y) \\neq 0$、$\\text{adj}(x, z) \\neq 0$ 和 $\\text{adj}(y, z) \\neq 0$。\n\n如果存在 $\\mathrm{FFL}$，则将其分类为相干或非相干。相干性条件通过比较从 $x$ 到 $z$ 的直接路径的符号与通过 $y$ 的间接路径的符号来定义。\n-   如果间接路径的符号之积等于直接路径的符号，即 $\\sigma(x, y) \\cdot \\sigma(y, z) = \\sigma(x, z)$，则该 $\\mathrm{FFL}$ 是 **相干的**。\n-   否则，如果 $\\sigma(x, y) \\cdot \\sigma(y, z) = -\\sigma(x, z)$，则该 $\\mathrm{FFL}$ 是 **非相干的**。\n\n通过遍历每个测试用例提供的三元组列表，我们计数观测到的相干 $\\mathrm{FFL}$ 的数量（记为 $O_{\\mathrm{coh}}$）和观测到的非相干 $\\mathrm{FFL}$ 的数量（记为 $O_{\\mathrm{incoh}}$）。\n\n**3. 零模型和期望计数**\n\n问题定义了一个符号保持零模型，用以评估观测计数的统计显著性。在此模型中，每条边的形成都是一个独立的随机事件。\n\n首先，我们根据观测到的图建立模型参数：\n-   $|V|$：图中节点的数量。\n-   $M = |V|(|V| - 1)$：不同节点之间所有可能的有向边的总数。\n-   $E_+$：观测图中正（$+1$）边的总数。\n-   $E_-$：观测图中负（$-1$）边的总数。\n\n由此，我们为任意给定的不同节点有序对 $(u, v)$ 定义概率：\n-   存在一条正边的概率是 $a = p_+ = E_+ / M$。\n-   存在一条负边的概率是 $b = p_- = E_- / M$。\n-   没有边的概率是 $1 - a - b$。\n\n问题是找到一个任意三元组 $(x, y, z)$ 形成相干或非相干 $\\mathrm{FFL}$ 的概率。一个 $\\mathrm{FFL}$ 需要存在边 $(x, y)、(x, z)、(y, z)$。设它们的符号为 $s_{xy}, s_{xz}, s_{yz} \\in \\{-1, +1\\}$。\n\n对于一个 **相干的** $\\mathrm{FFL}$，符号必须满足 $s_{xz} = s_{xy} \\cdot s_{yz}$。可能的符号组合 $(s_{xy}, s_{yz}, s_{xz})$ 及其概率如下：\n-   $(+1, +1, +1)$: 概率为 $a \\cdot a \\cdot a = a^3$。\n-   $(+1, -1, -1)$: 概率为 $a \\cdot b \\cdot b = ab^2$。\n-   $(-1, +1, -1)$: 概率为 $b \\cdot a \\cdot b = ab^2$。\n-   $(-1, -1, +1)$: 概率为 $b \\cdot b \\cdot a = ab^2$。\n将这些概率相加，一个给定三元组上出现相干 $\\mathrm{FFL}$ 的总概率为 $P_{\\mathrm{coh}} = a^3 + 3ab^2$。\n\n对于一个 **非相干的** $\\mathrm{FFL}$，符号必须满足 $s_{xz} = -s_{xy} \\cdot s_{yz}$。可能的符号组合如下：\n-   $(+1, +1, -1)$: 概率为 $a \\cdot a \\cdot b = a^2b$。\n-   $(+1, -1, +1)$: 概率为 $a \\cdot b \\cdot a = a^2b$。\n-   $(-1, +1, +1)$: 概率为 $b \\cdot a \\cdot a = a^2b$。\n-   $(-1, -1, -1)$: 概率为 $b \\cdot b \\cdot b = b^3$。\n将这些概率相加，一个给定三元组上出现非相干 $\\mathrm{FFL}$ 的总概率为 $P_{\\mathrm{incoh}} = 3a^2b + b^3$。\n\n给定一个包含 $T$ 个三元组的列表进行研究，期望计数可以通过期望的线性性推导出来。相干和非相干 $\\mathrm{FFL}$ 的期望数量为：\n$$E_{\\mathrm{coh}} = T \\cdot P_{\\mathrm{coh}}$$\n$$E_{\\mathrm{incoh}} = T \\cdot P_{\\mathrm{incoh}}$$\n\n**4. 富集度计算**\n\n富集比 $R$ 量化了一个模体的观测频率相对于其在零模型中的期望频率高出（或低于）多少。它被定义为观测计数与期望计数的比值：\n$$R_{\\mathrm{coh}} = \\frac{O_{\\mathrm{coh}}}{E_{\\mathrm{coh}}}$$\n$$R_{\\mathrm{incoh}} = \\frac{O_{\\mathrm{incoh}}}{E_{\\mathrm{incoh}}}$$\n\n当期望计数为零时，会出现一个特殊情况。问题指定了以下处理方式：\n-   如果 $E = 0$ 且 $O = 0$，富集度 $R$ 定义为 $0.0$。\n-   如果 $E = 0$ 且 $O  0$，富集度 $R$ 定义为 $+\\infty$。\n\n通过为每个提供的测试用例执行这些步骤，我们可以计算出所需的数值列表：$[O_{\\mathrm{coh}}, O_{\\mathrm{incoh}}, E_{\\mathrm{coh}}, E_{\\mathrm{incoh}}, R_{\\mathrm{coh}}, R_{\\mathrm{incoh}}]$。",
            "answer": "[[2, 2, 0.160000, 0.160000, 12.500000, 12.500000], [3, 0, 0.375000, 0.000000, 8.000000, 0.000000], [0, 0, 0.037037, 0.037037, 0.000000, 0.000000]]"
        }
    ]
}