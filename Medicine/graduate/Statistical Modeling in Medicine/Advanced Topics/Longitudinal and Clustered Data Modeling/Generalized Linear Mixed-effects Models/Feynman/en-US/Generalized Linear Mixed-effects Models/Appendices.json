{
    "hands_on_practices": [
        {
            "introduction": "A primary goal of mixed-effects models is to quantify the correlation among observations within the same cluster. This practice guides you through deriving the intraclass correlation coefficient (ICC) for a logistic GLMM, translating the abstract random-effects variance, $\\sigma_b^2$, into an interpretable measure of within-cluster similarity. Mastering this connection is crucial for interpreting the magnitude and importance of clustering in your data. ",
            "id": "4965259",
            "problem": "A nationwide observational study evaluates binary remission outcomes for patients with chronic autoimmune disease treated in $J$ hospital wards. Patients are indexed by $i=1,\\dots,n_{j}$ within ward $j=1,\\dots,J$. Investigators fit a Generalized Linear Mixed-Effects Model (GLMM) with a logit link and a ward-specific random intercept to account for clustering. Specifically, patient outcomes $Y_{ij} \\in \\{0,1\\}$ satisfy $Y_{ij} \\sim \\text{Bernoulli}(p_{ij})$, and the linear predictor on the logit scale is $\\log\\!\\left(\\frac{p_{ij}}{1-p_{ij}}\\right)=\\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta}+b_{j}$, where $b_{j}$ is a ward-level random intercept satisfying $b_{j} \\sim \\mathcal{N}(0,\\sigma_{b}^{2})$, independent across wards.\n\nUnder the latent-variable approach consistent with the logit link, one posits an underlying continuous propensity $Y^{\\ast}_{ij}=\\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta}+b_{j}+\\varepsilon_{ij}$, where $\\varepsilon_{ij}$ has a standard logistic distribution with variance $\\pi^{2}/3$, independent of $b_{j}$. The intraclass correlation coefficient (ICC) is defined as the correlation, on the latent propensity scale, between two exchangeable patients from the same ward.\n\nStarting from variance decomposition principles and the latent-variable representation above, derive a closed-form analytical expression for the intraclass correlation coefficient (ICC) as a a function of the between-ward variance parameter $\\sigma_{b}^{2}$, treating the latent residual variance as $\\pi^{2}/3$. Express your final answer as a single simplified expression in terms of $\\sigma_{b}^{2}$ and $\\pi$. No numerical approximation is required.",
            "solution": "The problem asks for the derivation of the intraclass correlation coefficient (ICC) on the scale of the latent propensity variable, $Y^{\\ast}$. The ICC is defined as the correlation between the latent propensities of two distinct, exchangeable patients, indexed by $i$ and $k$ (where $i \\neq k$), from the same ward $j$.\nMathematically, this is expressed as:\n$$ \\text{ICC} = \\text{Corr}(Y^{\\ast}_{ij}, Y^{\\ast}_{kj}) $$\nThe general formula for correlation is $\\text{Corr}(A, B) = \\frac{\\text{Cov}(A, B)}{\\sqrt{\\text{Var}(A)\\text{Var}(B)}}$.\nThe latent variable model for the two patients is:\n$$ Y^{\\ast}_{ij} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_{j} + \\varepsilon_{ij} $$\n$$ Y^{\\ast}_{kj} = \\mathbf{x}_{kj}^{\\top}\\boldsymbol{\\beta} + b_{j} + \\varepsilon_{kj} $$\nBoth patients share the same ward-level random intercept $b_{j}$.\n\nFirst, we determine the total variance of a single latent propensity, $\\text{Var}(Y^{\\ast}_{ij})$. The fixed term $\\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta}$ does not contribute to variance. The random components are the ward-level random intercept $b_{j}$ and the patient-level residual error $\\varepsilon_{ij}$. Since $b_{j}$ and $\\varepsilon_{ij}$ are independent, the total variance is the sum of their variances:\n$$ \\text{Var}(Y^{\\ast}_{ij}) = \\text{Var}(b_{j}) + \\text{Var}(\\varepsilon_{ij}) $$\nWe are given the variances of these components:\n- The between-ward variance: $\\text{Var}(b_{j}) = \\sigma_{b}^{2}$\n- The within-ward (residual) variance: $\\text{Var}(\\varepsilon_{ij}) = \\frac{\\pi^{2}}{3}$ (from the standard logistic distribution)\nThus, the total variance is:\n$$ \\text{Var}(Y^{\\ast}_{ij}) = \\sigma_{b}^{2} + \\frac{\\pi^{2}}{3} $$\nSince the patients are exchangeable, $\\text{Var}(Y^{\\ast}_{kj}) = \\text{Var}(Y^{\\ast}_{ij})$.\n\nNext, we determine the covariance, $\\text{Cov}(Y^{\\ast}_{ij}, Y^{\\ast}_{kj})$.\n$$ \\text{Cov}(Y^{\\ast}_{ij}, Y^{\\ast}_{kj}) = \\text{Cov}(b_{j} + \\varepsilon_{ij}, b_{j} + \\varepsilon_{kj}) $$\nUsing the bilinearity of covariance:\n$$ = \\text{Cov}(b_{j}, b_{j}) + \\text{Cov}(b_{j}, \\varepsilon_{kj}) + \\text{Cov}(\\varepsilon_{ij}, b_{j}) + \\text{Cov}(\\varepsilon_{ij}, \\varepsilon_{kj}) $$\nBased on the model's independence assumptions:\n- $\\text{Cov}(b_{j}, b_{j}) = \\text{Var}(b_{j}) = \\sigma_{b}^{2}$.\n- $b_{j}$ is independent of residual terms, so $\\text{Cov}(b_{j}, \\varepsilon_{kj}) = 0$ and $\\text{Cov}(\\varepsilon_{ij}, b_{j}) = 0$.\n- Residual terms for different patients ($i \\neq k$) are independent, so $\\text{Cov}(\\varepsilon_{ij}, \\varepsilon_{kj}) = 0$.\nTherefore, the covariance is:\n$$ \\text{Cov}(Y^{\\ast}_{ij}, Y^{\\ast}_{kj}) = \\sigma_{b}^{2} $$\nThe shared random intercept $b_{j}$ is the sole source of covariance.\n\nFinally, we assemble the ICC:\n$$ \\text{ICC} = \\frac{\\text{Cov}(Y^{\\ast}_{ij}, Y^{\\ast}_{kj})}{\\sqrt{\\text{Var}(Y^{\\ast}_{ij})\\text{Var}(Y^{\\ast}_{kj})}} = \\frac{\\sigma_{b}^{2}}{\\text{Var}(Y^{\\ast}_{ij})} = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\frac{\\pi^{2}}{3}} $$\nThis expression represents the proportion of the total variance in the latent propensity that is attributable to the variation between wards.",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\frac{\\pi^{2}}{3}}}\n$$"
        },
        {
            "introduction": "When modeling event counts like infections or disease cases, the observation time or exposure is a critical piece of information. This problem explores the correct way to incorporate exposure into a Poisson GLMM by using an offset, ensuring the model targets the event rate rather than the raw count. You will analyze the theoretical justification for offsets and the significant inferential errors that arise from the common mistake of treating exposure as a standard covariate. ",
            "id": "4965309",
            "problem": "A multicenter study follows patients for differing amounts of person-time to monitor incident hospital-acquired infections. For patient $i$ in center $j$, let $Y_{ij}$ be the total number of infections observed during follow-up time $T_{ij} > 0$. Suppose that, conditional on covariates $x_{ij}$ and a center-specific latent effect $b_j$, infections arise from a Poisson process whose conditional intensity is constant over the observed interval and given by $\\lambda_{ij} = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)$. Here $(\\beta_0,\\beta_1)$ are unknown fixed effects and $b_j$ is a mean-zero random intercept. Assume $b_j \\sim \\mathcal{N}(0,\\sigma_b^2)$ and that, conditional on $b_j$ and $x_{ij}$, the counts $Y_{ij}$ are independent across patients and centers.\n\nStarting only from the defining properties of a Poisson process (that the number of events in an interval of length $t$ is Poisson with mean equal to the integrated intensity over that interval, and that disjoint intervals are independent), and the definition of a generalized linear mixed-effects model (GLMM) with log link for counts, reason carefully about how person-time exposure enters the model. Then consider the consequences of mistakenly treating exposure as a covariate whose coefficient is estimated rather than as an offset.\n\nSelect all statements that are correct.\n\nA. In a Poisson log-link generalized linear mixed-effects model (GLMM) for counts constructed from the above Poisson process, including person-time exposure correctly corresponds to adding $\\log T_{ij}$ as an offset to the linear predictor, i.e., the conditional mean satisfies $\\mathbb{E}[Y_{ij}\\mid b_j,x_{ij}] = T_{ij}\\,\\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)$, which is equivalent to writing the linear predictor as $(\\beta_0 + \\beta_1 x_{ij} + b_j) + \\log T_{ij}$.\n\nB. If $\\log T_{ij}$ is mistakenly entered as a covariate with a free coefficient $\\gamma$ so that the conditional mean is modeled as $\\mathbb{E}[Y_{ij}\\mid b_j,x_{ij}] = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j + \\gamma \\log T_{ij}) = T_{ij}^{\\gamma}\\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)$, and the true data-generating mechanism is proportional to $T_{ij}$ as in the stem, then under correct model specification and standard regularity conditions the maximum likelihood estimator (MLE) of $\\gamma$ converges in probability to $1$ as sample size grows; however, in finite samples or under misspecification (e.g., unmodeled overdispersion), $\\gamma$ can deviate from $1$ and partially absorb variation that should be attributed to the intercept or random effects, distorting inference and the interpretation of $\\beta_1$ as a log rate ratio.\n\nC. Including $\\log T_{ij}$ with an estimated coefficient is numerically identical to using it as an offset in any log-link GLMM, yielding the same parameter estimates and predictions, because the estimation automatically constrains the coefficient to $0$.\n\nD. If $\\log T_{ij}$ is treated as a covariate with an estimated coefficient $\\gamma$ and the fit yields $\\gamma \\neq 1$, then the fitted rate per unit time is $\\mathbb{E}[Y_{ij}\\mid b_j,x_{ij}]/T_{ij} = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)\\,T_{ij}^{\\gamma - 1}$, implying a spurious dependence of the estimated rate on the amount of follow-up time.\n\nE. Offsets such as $\\log T_{ij}$ are only valid in marginal Poisson generalized linear models (GLMs) without random effects; in GLMMs with random effects $b_j$, offsets cannot be included in the linear predictor.",
            "solution": "The problem statement asks for an analysis of how person-time exposure should be incorporated into a generalized linear mixed-effects model (GLMM) for count data arising from a Poisson process, and to evaluate the consequences of misspecification.\n\n### Derivation of the Correct Model\n1.  The fundamental property of a Poisson process with a constant intensity (rate) $\\lambda$ over an interval of length $T$ is that the number of events $Y$ in that interval follows a Poisson distribution with mean $\\mu = \\lambda \\times T$.\n2.  In this problem, the conditional intensity is $\\lambda_{ij} = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)$ and the time is $T_{ij}$.\n3.  The expected number of events, $Y_{ij}$, conditional on $b_j$ and $x_{ij}$, is therefore:\n    $$ \\mathbb{E}[Y_{ij} \\mid b_j, x_{ij}] = \\lambda_{ij} \\times T_{ij} = T_{ij} \\, \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j) $$\n4.  For a GLMM with a log link, we model the logarithm of the conditional mean:\n    $$ \\log(\\mathbb{E}[Y_{ij} \\mid b_j, x_{ij}]) = \\log(T_{ij} \\, \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)) $$\n5.  Using logarithm properties, this becomes:\n    $$ \\log(\\mathbb{E}[Y_{ij} \\mid b_j, x_{ij}]) = (\\beta_0 + \\beta_1 x_{ij} + b_j) + \\log(T_{ij}) $$\n6.  The term $\\log(T_{ij})$ is an **offset**: a known predictor with its coefficient fixed to 1. This correctly models the log of the rate: $\\log(\\mathbb{E}[Y_{ij}] / T_{ij}) = \\beta_0 + \\beta_1 x_{ij} + b_j$.\n\n### Option-by-Option Analysis\n\n**A. In a Poisson log-link generalized linear mixed-effects model (GLMM) for counts constructed from the above Poisson process, including person-time exposure correctly corresponds to adding $\\log T_{ij}$ as an offset to the linear predictor, i.e., the conditional mean satisfies $\\mathbb{E}[Y_{ij}\\mid b_j,x_{ij}] = T_{ij}\\,\\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)$, which is equivalent to writing the linear predictor as $(\\beta_0 + \\beta_1 x_{ij} + b_j) + \\log T_{ij}$.**\nThis statement perfectly matches the derivation. It is the correct specification for a Poisson GLMM for rates.\n**Verdict: Correct**\n\n**B. If $\\log T_{ij}$ is mistakenly entered as a covariate with a free coefficient $\\gamma$...**\nThe true data-generating mechanism corresponds to $\\gamma=1$. A consistent estimator, like the MLE, will converge to this true value as sample size increases. However, in finite samples or under model misspecification (like unmodeled overdispersion), the estimated $\\hat{\\gamma}$ can differ from 1 as it absorbs some of the model misfit. This biases other parameters, including $\\beta_1$, and corrupts its interpretation as a log rate ratio. This statement is a sophisticated and accurate summary of statistical theory.\n**Verdict: Correct**\n\n**C. Including $\\log T_{ij}$ with an estimated coefficient is numerically identical to using it as an offset in any log-link GLMM, yielding the same parameter estimates and predictions, because the estimation automatically constrains the coefficient to $0$.**\nThis is incorrect. An offset constrains the coefficient to 1, not 0. Fitting a free coefficient is a different estimation problem and will generally yield different results unless the estimated coefficient happens to be exactly 1.\n**Verdict: Incorrect**\n\n**D. If $\\log T_{ij}$ is treated as a covariate with an estimated coefficient $\\gamma$ and the fit yields $\\gamma \\neq 1$, then the fitted rate per unit time is $\\mathbb{E}[Y_{ij}\\mid b_j,x_{ij}]/T_{ij} = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j)\\,T_{ij}^{\\gamma - 1}$, implying a spurious dependence of the estimated rate on the amount of follow-up time.**\nThe derivation is correct. The rate is the expected count divided by time:\n$$ \\text{Rate} = \\frac{\\exp(\\beta_0 + \\beta_1 x_{ij} + b_j + \\gamma \\log T_{ij})}{T_{ij}} = \\frac{\\exp(\\beta_0 + \\beta_1 x_{ij} + b_j) T_{ij}^{\\gamma}}{T_{ij}} = \\exp(\\beta_0 + \\beta_1 x_{ij} + b_j) T_{ij}^{\\gamma - 1} $$\nIf $\\gamma \\neq 1$, the estimated rate spuriously depends on the follow-up time $T_{ij}$, which is an artifact of model misspecification.\n**Verdict: Correct**\n\n**E. Offsets such as $\\log T_{ij}$ are only valid in marginal Poisson generalized linear models (GLMs) without random effects; in GLMMs with random effects $b_j$, offsets cannot be included in the linear predictor.**\nThis is false. Offsets are a fundamental part of the GLM/GLMM framework and are used precisely as derived above, regardless of the presence of random effects. Standard software for GLMMs fully supports offsets.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "While GLMMs are powerful, their parameters are not always easily estimated, a challenge known as weak identifiability. This exercise confronts a common scenario in medical research where sparse data—many small clusters and rare events—undermine the estimation of the random-effects variance. You will reason about why this occurs and evaluate valid statistical strategies for stabilizing the model or choosing an alternative approach. ",
            "id": "4965279",
            "problem": "A health system registry studies postoperative infection in patients treated across $M$ hospitals. Let $Y_{ij} \\in \\{0,1\\}$ denote the infection indicator for patient $j$ in hospital $i$, and let $\\mathbf{x}_{ij}$ be a vector of patient-level covariates including an intercept. Consider a Generalized Linear Mixed-Effects Model (GLMM) with a logistic link and a hospital-specific random intercept,\n$$\nY_{ij} \\mid b_i \\sim \\text{Bernoulli}(p_{ij}), \\quad \\text{logit}(p_{ij}) = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i,\\quad b_i \\sim \\mathcal{N}(0, \\sigma_b^2),\n$$\nwhere $\\boldsymbol{\\beta}$ is the vector of fixed-effect coefficients and $\\sigma_b^2$ is the random intercept variance. The hospital cluster sizes $\\{n_i\\}_{i=1}^M$ are sparse: a proportion $0.6$ of hospitals are singletons with $n_i = 1$, a proportion $0.3$ have $n_i = 2$, and a proportion $0.1$ have $n_i = 20$. The marginal infection rate is low, approximately $0.03$.\n\nStarting from the core definition of identifiability (a parameter is identifiable if distinct parameter values induce distinct distributions of the observable data) and the GLMM marginal likelihood obtained by integrating out the random effects,\n$$\nL(\\boldsymbol{\\beta}, \\sigma_b^2) = \\prod_{i=1}^M \\int \\left\\{ \\prod_{j=1}^{n_i} \\left[ \\text{logit}^{-1}\\!\\left( \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i \\right) \\right]^{Y_{ij}} \\left[ 1 - \\text{logit}^{-1}\\!\\left( \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i \\right) \\right]^{1-Y_{ij}} \\right\\} \\,\\phi(b_i; 0, \\sigma_b^2)\\, \\mathrm{d}b_i,\n$$\nwhere $\\phi(\\cdot;0,\\sigma_b^2)$ denotes the normal density with mean $0$ and variance $\\sigma_b^2$, reason about how the sparse cluster size distribution and singletons challenge the identifiability of $\\sigma_b^2$. In particular, argue using the structure of the marginal likelihood and the Fisher information that the curvature of the log-likelihood in $\\sigma_b^2$ contributed by clusters with $n_i=1$ is small when events are rare, and explain why within-cluster replication increases the sensitivity of the likelihood to $\\sigma_b^2$.\n\nWhich of the following statements correctly describe valid consequences and remedies in this setting?\n\nA. With many singleton hospitals and rare events, the likelihood’s curvature in $\\sigma_b^2$ is shallow because there is no within-hospital replication to distinguish $\\sigma_b^2$ from the fixed intercept; imposing an informative or penalized-complexity prior on $\\sigma_b$ can stabilize estimation and improve identifiability.\n\nB. Increasing the number of Gauss–Hermite quadrature points in the numerical integration fully eliminates the identifiability issue, because the weak identification arises primarily from approximation error rather than data structure.\n\nC. Replacing the random intercepts $b_i$ by hospital fixed effects yields a consistent estimator of $\\sigma_b^2$ under sparse cluster sizes, restoring identifiability of the variance parameter without changing the estimand.\n\nD. If the scientific target is the marginal effect $\\boldsymbol{\\beta}$ on a population-average scale, a Generalized Estimating Equations (GEE) approach with an independence working correlation can be adopted, thereby avoiding estimation of $\\sigma_b^2$ and sidestepping the identifiability problem via model simplification.\n\nE. Pooling singleton hospitals into artificial clusters constructed by grouping similar $\\mathbf{x}_{ij}$ values restores identifiability of $\\sigma_b^2$ without bias, because synthetic replication is equivalent to real within-cluster replication under the GLMM assumptions.\n\nF. Centering predictors within hospitals, i.e., replacing $\\mathbf{x}_{ij}$ by $\\mathbf{x}_{ij} - \\bar{\\mathbf{x}}_i$, recovers identifiability of $\\sigma_b^2$ for singleton hospitals since centering increases within-hospital variation even when $n_i = 1$.\n\nSelect all that apply.",
            "solution": "The problem concerns the weak identifiability of the random-effects variance, $\\sigma_b^2$, in a logistic GLMM with sparse data (many small clusters) and rare events.\n\n**Core Rationale:**\nThe parameter $\\sigma_b^2$ quantifies between-cluster heterogeneity. To estimate it, the data must provide information to distinguish this from within-cluster similarity.\n- **Within-cluster replication ($n_i > 1$)** is the primary source of information. Observing multiple outcomes within a hospital allows the model to infer that hospital's specific random effect, $b_i$. Aggregating these inferences across hospitals allows estimation of their variance, $\\sigma_b^2$.\n- **Singleton clusters ($n_i = 1$)** provide minimal information. For a single patient, the random effect $b_i$ is confounded with the fixed intercept term. The only information separating them is the prior assumption $b_i \\sim \\mathcal{N}(0, \\sigma_b^2)$.\n- **Rare events** worsen the issue. For a singleton non-event ($Y_{i1}=0$), the likelihood contribution is an integral of a nearly flat function over the normal density. Changing the variance $\\sigma_b^2$ (the width of the density) has little effect on the integral's value, resulting in a flat log-likelihood surface and weak identifiability.\n\n**Option-by-option Analysis:**\n\n**A. With many singleton hospitals and rare events, the likelihood’s curvature in $\\sigma_b^2$ is shallow because there is no within-hospital replication to distinguish $\\sigma_b^2$ from the fixed intercept; imposing an informative or penalized-complexity prior on $\\sigma_b$ can stabilize estimation and improve identifiability.**\nThis is correct. It accurately describes the cause (lack of replication) and the consequence (shallow likelihood), and proposes a standard, valid statistical solution (priors/penalties) to regularize the estimate.\n**Verdict: Correct.**\n\n**B. Increasing the number of Gauss–Hermite quadrature points in the numerical integration fully eliminates the identifiability issue, because the weak identification arises primarily from approximation error rather than data structure.**\nThis is incorrect. The problem is statistical (lack of information in the data), not numerical. More quadrature points compute the flat likelihood more accurately, but it remains flat.\n**Verdict: Incorrect.**\n\n**C. Replacing the random intercepts $b_i$ by hospital fixed effects yields a consistent estimator of $\\sigma_b^2$ under sparse cluster sizes, restoring identifiability of the variance parameter without changing the estimand.**\nThis is incorrect. A fixed-effects model does not contain or estimate $\\sigma_b^2$. It also changes the estimand and suffers from the incidental parameters problem in this context.\n**Verdict: Incorrect.**\n\n**D. If the scientific target is the marginal effect $\\boldsymbol{\\beta}$ on a population-average scale, a Generalized Estimating Equations (GEE) approach with an independence working correlation can be adopted, thereby avoiding estimation of $\\sigma_b^2$ and sidestepping the identifiability problem via model simplification.**\nThis is correct. GEE is a valid alternative that estimates population-averaged effects and does not require estimating $\\sigma_b^2$. This sidesteps the identifiability problem entirely, which is a common and pragmatic solution.\n**Verdict: Correct.**\n\n**E. Pooling singleton hospitals into artificial clusters constructed by grouping similar $\\mathbf{x}_{ij}$ values restores identifiability of $\\sigma_b^2$ without bias, because synthetic replication is equivalent to real within-cluster replication under the GLMM assumptions.**\nThis is incorrect. This ad-hoc procedure violates the model's assumption that observations in a true cluster share a random effect. It introduces model misspecification and biased estimates.\n**Verdict: Incorrect.**\n\n**F. Centering predictors within hospitals, i.e., replacing $\\mathbf{x}_{ij}$ by $\\mathbf{x}_{ij} - \\bar{\\mathbf{x}}_i$, recovers identifiability of $\\sigma_b^2$ for singleton hospitals since centering increases within-hospital variation even when $n_i = 1$.**\nThis is incorrect. For a singleton ($n_i = 1$), the centered covariate is always zero, which removes information. The reasoning is flawed.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}