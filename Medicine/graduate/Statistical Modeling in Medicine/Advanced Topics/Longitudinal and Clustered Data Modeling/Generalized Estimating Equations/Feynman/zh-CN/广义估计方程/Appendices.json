{
    "hands_on_practices": [
        {
            "introduction": "在应用任何统计模型之前，理解它所要解决的根本问题至关重要。对于聚类数据，一个核心挑战是同一聚类中的观测值并非相互独立，而这是标准统计检验的一个基本假设。 这个练习通过推导“设计效应”来阐明这一点，它量化了组内相关性（intracluster correlation）如何扩大处理效应估计量的方差，从而突显了像广义估计方程（GEE）这样考虑了相关性的方法的必要性。",
            "id": "4964749",
            "problem": "考虑一项整群随机化医学研究，该研究使用广义估计方程（GEE; Generalized Estimating Equations）和针对连续性结局（例如，收缩压）的恒等连结进行分析，其中治疗在整群水平上分配。假设每组有 $K$ 个整群，每个整群恰好有 $n$ 个个体（平衡的整群规模）。令 $Y_{kj}$ 表示在整群 $k \\in \\{1,\\dots,K\\}$ 中个体 $j \\in \\{1,\\dots,n\\}$ 的结局。假设一个边际均值模型，其方差恒定为 $ \\operatorname{Var}(Y_{kj}) = \\sigma^{2}$，并具有可交换的组内相关结构，组内相关系数（ICC）为 $\\rho$，因此对于同一整群内的 $j \\neq \\ell$，\n$$\n\\operatorname{Cov}(Y_{kj}, Y_{k\\ell}) = \\rho \\sigma^{2},\n$$\n且来自不同整群的结局是独立的。\n\n将边际治疗效应估计量定义为组均值之差，\n$$\n\\hat{\\Delta} = \\bar{Y}_{\\text{T}} - \\bar{Y}_{\\text{C}},\n$$\n其中 $\\bar{Y}_{\\text{T}}$ 和 $\\bar{Y}_{\\text{C}}$ 分别是治疗组和对照组中所有个体的样本均值。使用方差和协方差的基本性质，推导 $\\hat{\\Delta}$ 的方差，记为 $\\operatorname{Var}(\\hat{\\Delta})$；然后，将此方差与所有结局都独立（即 $\\rho=0$）时得到的方差进行比较；最后，推导设计效应（即乘性方差膨胀因子），作为 $n$ 和 $\\rho$ 的函数。",
            "solution": "#### 治疗效应估计量方差的推导\n\n治疗效应的估计量由 $\\hat{\\Delta} = \\bar{Y}_{\\text{T}} - \\bar{Y}_{\\text{C}}$ 给出。由于治疗组中的个体与对照组中的个体不同，并且整群被分配到其中一个组，因此两个样本均值 $\\bar{Y}_{\\text{T}}$ 和 $\\bar{Y}_{\\text{C}}$ 是独立的。因此，它们差值的方差是它们各自方差的和：\n$$\n\\operatorname{Var}(\\hat{\\Delta}) = \\operatorname{Var}(\\bar{Y}_{\\text{T}} - \\bar{Y}_{\\text{C}}) = \\operatorname{Var}(\\bar{Y}_{\\text{T}}) + \\operatorname{Var}(\\bar{Y}_{\\text{C}})\n$$\n由于平衡设计（每组有 $K$ 个大小为 $n$ 的整群）和相同的方差-协方差结构，两组的均值方差将是相同的。因此，$\\operatorname{Var}(\\bar{Y}_{\\text{T}}) = \\operatorname{Var}(\\bar{Y}_{\\text{C}})$。我们可以集中推导一个组（比如治疗组）的方差，然后将结果乘以 2。\n\n治疗组的总个体数为 $nK$。治疗组的样本均值是该组所有结局的平均值：\n$$\n\\bar{Y}_{\\text{T}} = \\frac{1}{nK} \\sum_{k=1}^{K} \\sum_{j=1}^{n} Y_{kj}^{\\text{T}}\n$$\n其中 $Y_{kj}^{\\text{T}}$ 表示治疗组中整群 $k$ 内个体 $j$ 的结局。为简化符号，我们将省略上标 T。这个均值的方差是：\n$$\n\\operatorname{Var}(\\bar{Y}_{\\text{T}}) = \\operatorname{Var}\\left(\\frac{1}{nK} \\sum_{k=1}^{K} \\sum_{j=1}^{n} Y_{kj}\\right) = \\frac{1}{(nK)^2} \\operatorname{Var}\\left(\\sum_{k=1}^{K} \\sum_{j=1}^{n} Y_{kj}\\right)\n$$\n问题陈述指出，来自不同整群的结局是独立的。这意味着跨整群求和的方差是每个整群总和方差的和。\n$$\n\\operatorname{Var}\\left(\\sum_{k=1}^{K} \\sum_{j=1}^{n} Y_{kj}\\right) = \\sum_{k=1}^{K} \\operatorname{Var}\\left(\\sum_{j=1}^{n} Y_{kj}\\right)\n$$\n现在，我们必须求单个整群 $k$ 内结局总和的方差。使用随机变量和的方差的一般公式：\n$$\n\\operatorname{Var}\\left(\\sum_{j=1}^{n} Y_{kj}\\right) = \\sum_{j=1}^{n} \\operatorname{Var}(Y_{kj}) + \\sum_{j=1}^{n} \\sum_{\\ell \\neq j} \\operatorname{Cov}(Y_{kj}, Y_{k\\ell})\n$$\n根据问题陈述，我们有以下已知条件：\n1.  每个单独结局的方差是 $\\operatorname{Var}(Y_{kj}) = \\sigma^2$。\n2.  同一整群内任意一对不同个体的协方差是 $\\operatorname{Cov}(Y_{kj}, Y_{k\\ell}) = \\rho \\sigma^2$（对于 $j \\neq \\ell$）。\n\n在第一个求和中有 $n$ 个方差项。有 $n(n-1)$ 个不同的索引 $(j, \\ell)$ 的有序对，所以有 $n(n-1)$ 个协方差项。代入给定值：\n$$\n\\sum_{j=1}^{n} \\operatorname{Var}(Y_{kj}) = \\sum_{j=1}^{n} \\sigma^2 = n\\sigma^2\n$$\n$$\n\\sum_{j=1}^{n} \\sum_{\\ell \\neq j} \\operatorname{Cov}(Y_{kj}, Y_{k\\ell}) = n(n-1) \\rho \\sigma^2\n$$\n结合这些，单个整群内结局总和的方差是：\n$$\n\\operatorname{Var}\\left(\\sum_{j=1}^{n} Y_{kj}\\right) = n\\sigma^2 + n(n-1)\\rho\\sigma^2 = n\\sigma^2 \\left(1 + (n-1)\\rho\\right)\n$$\n因为这对任何整群 $k$ 都成立，并且组内有 $K$ 个独立的整群，所以该组总和的方差是：\n$$\n\\operatorname{Var}\\left(\\sum_{k=1}^{K} \\sum_{j=1}^{n} Y_{kj}\\right) = \\sum_{k=1}^{K} \\left[ n\\sigma^2(1 + (n-1)\\rho) \\right] = Kn\\sigma^2(1 + (n-1)\\rho)\n$$\n我们现在可以求出组均值的方差 $\\operatorname{Var}(\\bar{Y}_{\\text{T}})$：\n$$\n\\operatorname{Var}(\\bar{Y}_{\\text{T}}) = \\frac{1}{(nK)^2} \\left[ Kn\\sigma^2(1 + (n-1)\\rho) \\right] = \\frac{\\sigma^2(1 + (n-1)\\rho)}{nK}\n$$\n最后，我们计算估计量 $\\hat{\\Delta}$ 的方差：\n$$\n\\operatorname{Var}(\\hat{\\Delta}) = \\operatorname{Var}(\\bar{Y}_{\\text{T}}) + \\operatorname{Var}(\\bar{Y}_{\\text{C}}) = 2 \\operatorname{Var}(\\bar{Y}_{\\text{T}}) = \\frac{2\\sigma^2(1 + (n-1)\\rho)}{nK}\n$$\n这个表达式是在指定的组内相关结构下，治疗效应估计量的方差。\n\n#### 与独立结局的比较\n\n第二步是找到在所有结局都独立（即使在整群内部也独立）的反事实情景下的方差。这对应于将组内相关系数 $\\rho$ 设为0。我们将此方差表示为 $\\operatorname{Var}_{\\text{indep}}(\\hat{\\Delta})$。\n在我们推导的公式中令 $\\rho=0$：\n$$\n\\operatorname{Var}_{\\text{indep}}(\\hat{\\Delta}) = \\frac{2\\sigma^2(1 + (n-1)(0))}{nK} = \\frac{2\\sigma^2}{nK}\n$$\n这个结果与第一性原理一致。如果一个组中的所有 $nK$ 个个体都是方差为 $\\sigma^2$ 的独立观测值，那么它们均值的方差是 $\\frac{\\sigma^2}{nK}$。两个这样的独立均值之差的方差将是 $\\frac{\\sigma^2}{nK} + \\frac{\\sigma^2}{nK} = \\frac{2\\sigma^2}{nK}$。\n\n#### 设计效应的推导\n\n设计效应（DEFF）定义为在实际（整群）抽样设计下估计量的方差与从相同总样本量的简单随机样本中获得的方差之比。\n$$\n\\text{DEFF} = \\frac{\\operatorname{Var}(\\hat{\\Delta})}{\\operatorname{Var}_{\\text{indep}}(\\hat{\\Delta})}\n$$\n代入我们推导出的表达式：\n$$\n\\text{DEFF} = \\frac{\\frac{2\\sigma^2(1 + (n-1)\\rho)}{nK}}{\\frac{2\\sigma^2}{nK}}\n$$\n从分子和分母中消去公因子 $\\frac{2\\sigma^2}{nK}$，得到设计效应：\n$$\n\\text{DEFF} = 1 + (n-1)\\rho\n$$\n这就是所要求的乘性方差膨胀因子的闭式表达式，它以整群规模 $n$ 和组内相关系数 $\\rho$ 为函数。",
            "answer": "$$\\boxed{1 + (n-1)\\rho}$$"
        },
        {
            "introduction": "当我们拟合一个GEE模型后，下一个关键步骤是正确地解释其结果。对于像逻辑回归这样的非线性模型，这一点尤为重要，因为GEE系数具有特定的“群体平均”（population-averaged）含义，这与其它纵向数据模型（如混合效应模型）中的“特定个体”（subject-specific）效应不同。 本练习将指导您如何从一个GEE逻辑回归模型的输出中计算和解释边际优势比（marginal odds ratio），掌握这项技能对于准确传达分析相关二元结果研究的发现至关重要。",
            "id": "4964705",
            "problem": "一项关于某种抗炎疗法的多中心纵向研究跟踪了 $n$ 名患者在 $m$ 次临床访视中的情况，以评估每次访视时是否发生病情发作。令 $Y_{ij} \\in \\{0,1\\}$ 表示患者 $i$ 在第 $j$ 次访视时是否出现病情发作。治疗分配是一个在基线时测量并在整个研究期间保持不变的二分类指标 $T_i \\in \\{0,1\\}$。在给定协变量的情况下，$Y_{ij}$ 的边际均值使用广义估计方程（GEE；Generalized Estimating Equations）和可交换的工作相关性结构，通过 logistic 联结函数进行建模：\n$$\n\\ln\\!\\left(\\frac{\\mathbb{E}[Y_{ij} \\mid \\mathbf{X}_{ij}]}{1-\\mathbb{E}[Y_{ij} \\mid \\mathbf{X}_{ij}]}\\right)\n\\;=\\;\n\\beta_0 \\;+\\; \\beta_T T_i \\;+\\; \\beta_A \\,\\text{Age}_i \\;+\\; \\beta_S \\,\\text{Severity}_i \\;+\\; \\beta_{t2} I\\{j=2\\} \\;+\\; \\beta_{t3} I\\{j=3\\} \\;+\\; \\beta_{t4} I\\{j=4\\},\n$$\n模型中无交互作用项。此处 $\\text{Age}_i$ 是基线年龄（单位：年），$\\text{Severity}_i$ 是标准化的基线严重程度评分，$I\\{j=k\\}$ 是访视指标。GEE 模型使用稳健的三明治方差进行拟合，得到的系数估计值如下：\n$$\n\\hat{\\beta}_0 = -1.62,\\quad \\hat{\\beta}_T = -0.3147107,\\quad \\hat{\\beta}_A = 0.011,\\quad \\hat{\\beta}_S = 0.207,\\quad \\hat{\\beta}_{t2} = 0.10,\\quad \\hat{\\beta}_{t3} = 0.05,\\quad \\hat{\\beta}_{t4} = 0.02.\n$$\n在可交换结构下，工作相关性参数的估计值为 $\\hat{\\alpha} = 0.22$。\n\n仅从 logistic 联结函数和二元结局比值的定义出发，并将 GEE 均值模型视为 $\\mathbb{E}[Y_{ij}\\mid \\mathbf{X}_{ij}]$ 的群体平均设定，完成以下任务：\n\n1) 在保持其他协变量不变（不存在交互作用项）的情况下，推导一个用 $\\beta_T$ 表示的、用于比较 $T_i=1$ 与 $T_i=0$ 的群体平均比值比的表达式。\n\n2) 使用报告的估计值 $\\hat{\\beta}_T$，计算估计的边际比值比。将您的数值答案四舍五入至四位有效数字。\n\n3) 简要说明在群体平均的意义上，就重复测量和协变量调整而言，该比值比的解释。不必计算任何置信区间。\n\n您最终报告的答案必须仅为第 2 部分的数值，四舍五入到四位有效数字，且不带单位。",
            "solution": "我们从两个基本定义开始：\n\n- 对于概率为 $p$ 的二元结局，其比值为 $p/(1-p)$。\n\n- 在 logistic 联结函数下，边际均值的对数比值（logit）是协变量的线性函数：如果 $p = \\mathbb{E}[Y_{ij}\\mid \\mathbf{X}_{ij}]$，则 $\\ln\\!\\left(\\frac{p}{1-p}\\right) = \\mathbf{X}_{ij}^{\\top}\\boldsymbol{\\beta}$。\n\n第 1 部分。令 $\\mathbf{Z}_{ij}$ 代表除治疗指标 $T_i$ 之外的所有协变量。在所述的无交互作用的 GEE 均值模型下，对于任何固定的 $\\mathbf{Z}_{ij}$，定义\n$$\np_1 \\equiv \\Pr(Y_{ij}=1\\mid T_i=1,\\mathbf{Z}_{ij}),\\qquad\np_0 \\equiv \\Pr(Y_{ij}=1\\mid T_i=0,\\mathbf{Z}_{ij}).\n$$\n根据 logistic 均值设定，\n$$\n\\ln\\!\\left(\\frac{p_1}{1-p_1}\\right) = \\beta_0 + \\beta_T\\cdot 1 + \\mathbf{Z}_{ij}^{\\top}\\boldsymbol{\\beta}_Z\n\\quad\\text{和}\\quad\n\\ln\\!\\left(\\frac{p_0}{1-p_0}\\right) = \\beta_0 + \\beta_T\\cdot 0 + \\mathbf{Z}_{ij}^{\\top}\\boldsymbol{\\beta}_Z,\n$$\n其中 $\\boldsymbol{\\beta}_Z$ 是非治疗协变量的系数。将这两个等式相减得到\n$$\n\\ln\\!\\left(\\frac{p_1}{1-p_1}\\right) - \\ln\\!\\left(\\frac{p_0}{1-p_0}\\right) \\;=\\; \\beta_T.\n$$\n对两边取指数，得到\n$$\n\\frac{\\dfrac{p_1}{1-p_1}}{\\dfrac{p_0}{1-p_0}} \\;=\\; \\exp(\\beta_T).\n$$\n左侧正是在保持 $\\mathbf{Z}_{ij}$ 不变的情况下，比较 $T_i=1$ 与 $T_i=0$ 的比值比。因此，在这个边际（群体平均）的 logistic GEE 模型中，治疗的群体平均比值比为\n$$\n\\text{OR}_{\\text{PA}} \\;=\\; \\exp(\\beta_T).\n$$\n\n第 2 部分。使用估计值 $\\hat{\\beta}_T = -0.3147107$，估计的边际比值比为\n$$\n\\widehat{\\text{OR}}_{\\text{PA}} \\;=\\; \\exp(\\hat{\\beta}_T) \\;=\\; \\exp(-0.3147107).\n$$\n计算此值：\n$$\n\\exp(-0.3147107) \\approx 0.7300000\\ldots\n$$\n四舍五入到四位有效数字，得到 $0.7300$。\n\n第 3 部分。解释。在一个带有 logistic 联结函数的广义估计方程框架中，$\\boldsymbol{\\beta}$ 参数化的是群体的边际均值 $\\mathbb{E}[Y_{ij}\\mid \\mathbf{X}_{ij}]$，而不是在给定潜在随机效应下的特定于个体的条件均值。在没有治疗交互作用的情况下，$\\exp(\\beta_T)$ 是在比较治疗组人群（$T_i=1$）与未治疗组人群（$T_i=0$）时，保持协变量 $\\text{Age}_i$、$\\text{Severity}_i$ 和访视指标不变的条件下，任何一次访视中病情发作的群体平均比值变化的因子。因此 $\\widehat{\\text{OR}}_{\\text{PA}}\\approx 0.7300$ 表明，在相同的协变量值和任何一次访视中，接受治疗时病情发作的群体平均比值大约是不接受治疗时的 $0.73$ 倍。这是一个边际效应（在个体内相关性上进行群体平均的），它不同于来自随机效应 logistic 模型的特定于个体的比值比；由于比值比的不可坍缩性，它仍然是以模型中包含的协变量为条件的。工作相关性 $\\hat{\\alpha} = 0.22$ 影响效率，但不改变这种基于均值结构的解释。",
            "answer": "$$\\boxed{0.7300}$$"
        },
        {
            "introduction": "GEE的一个广为人知的优点是，即使工作相关矩阵（working correlation matrix）设定错误，它也能提供一致的回归系数估计和稳健的标准误。然而，这种稳健性有一个至关重要的前提：均值模型必须被正确设定。 这个高级练习揭示了GEE的一个基本理论属性，它将通过一个思想实验证明，当模型忽略一个重要的混杂因素时（即均值模型设定错误），即使相关结构被完美指定，GEE估计量也会产生偏差。这深刻地提醒我们，GEE的有效性最终取决于我们对结果与协变量之间均值关系的理解是否正确。",
            "id": "4964692",
            "problem": "考虑一项重复测量的临床研究，该研究包含 $n$ 名独立患者，索引为 $i \\in \\{1,\\dots,n\\}$，每名患者在 $m \\geq 2$ 次访视中被观察，访视索引为 $j \\in \\{1,\\dots,m\\}$。设结局为 $Y_{ij} \\in \\mathbb{R}$。分析师拟合了一个广义估计方程（GEE；Generalized Estimating Equations）模型，该模型使用恒等连接函数，并正确设定了工作相关矩阵，使其等于真实的患者内相关。具体来说，分析师使用了错误设定的均值模型 $E\\!\\left(Y_{ij} \\mid A_i\\right) = \\beta_0 + \\beta_1 A_i$，其中 $A_i \\in \\mathbb{R}$ 是一个患者水平的暴露，对于患者 $i$ 而言，在所有访视 $j$ 中保持不变。\n\n假设真实的数据生成机制是线性的，并存在一个被遗漏的患者水平混杂因子 $Z_i \\in \\mathbb{R}$：\n$$\nY_{ij} = \\beta_0^{\\star} + \\beta_1^{\\star} A_i + \\gamma Z_i + \\varepsilon_{ij},\n$$\n其中 $\\gamma \\neq 0$，$Z_i \\sim \\mathcal{N}(0,\\sigma_Z^2)$，并且暴露的生成方式如下：\n$$\nA_i = \\delta Z_i + \\eta_i,\n$$\n其中 $\\eta_i \\sim \\mathcal{N}(0,\\sigma_{\\eta}^2)$，且独立于 $Z_i$。噪声向量 $\\varepsilon_i = (\\varepsilon_{i1},\\dots,\\varepsilon_{im})^{\\top}$ 的均值为零，独立于 $(A_i,Z_i)$，其协方差为 $\\operatorname{Cov}(\\varepsilon_i) = \\sigma^2 R_m(\\rho)$，其中 $R_m(\\rho)$ 是一个 $m \\times m$ 的可交换相关矩阵，其公共相关参数为 $\\rho \\in (-1/(m-1),1)$。\n\n分析师通过求解具有正确设定的工作协方差 $V_i = \\sigma^2 R_m(\\rho)$ 的GEE来拟合错误设定的均值 $E\\!\\left(Y_{ij} \\mid A_i\\right) = \\beta_0 + \\beta_1 A_i$：\n$$\n\\sum_{i=1}^{n} D_i(\\beta)^{\\top} V_i^{-1} \\left\\{ Y_i - \\mu_i(\\beta) \\right\\} = 0,\n$$\n其中 $Y_i = (Y_{i1},\\dots,Y_{im})^{\\top}$，$\\mu_i(\\beta) = (\\beta_0 + \\beta_1 A_i)\\, \\mathbf{1}_m$，$D_i(\\beta)$ 是一个 $m \\times 2$ 的导数矩阵，其列分别为 $\\partial \\mu_i/\\partial \\beta_0 = \\mathbf{1}_m$ 和 $\\partial \\mu_i/\\partial \\beta_1 = A_i \\mathbf{1}_m$，$\\mathbf{1}_m$ 是元素全为1的 $m$ 维向量。\n\n从基础的总体GEE（样本估计方程的概率极限）出发，\n$$\nE\\!\\left[ D_i(\\beta)^{\\top} V_i^{-1} \\left\\{ Y_i - \\mu_i(\\beta) \\right\\} \\right] = 0,\n$$\n推导在上述错误设定的均值但正确设定的工作相关条件下，斜率估计量 $\\hat{\\beta}_1$ 的大样本（渐近）极限，并明确证明当 $\\gamma \\neq 0$ 时，该渐近极限不同于 $\\beta_1^{\\star}$。在此过程中，计算渐近偏差 $\\operatorname{Bias}(\\hat{\\beta}_1) = \\lim_{n \\to \\infty} E(\\hat{\\beta}_1) - \\beta_1^{\\star}$ 的一个闭式表达式（用 $\\gamma$、$\\delta$、$\\sigma_Z^2$ 和 $\\sigma_{\\eta}^2$ 表示），并说明它如何以及为何不依赖于 $\\rho$。\n\n你的最终答案必须是 $\\operatorname{Bias}(\\hat{\\beta}_1)$ 作为 $(\\gamma,\\delta,\\sigma_Z^2,\\sigma_{\\eta}^2)$ 函数的单一闭式解析表达式；无需进行数值评估或四舍五入。",
            "solution": "目标是找到估计量 $\\hat{\\beta}_1$ 的渐近极限，记为 $\\beta_1$，它是通过求解总体GEE得到的，然后计算渐近偏差 $\\beta_1 - \\beta_1^{\\star}$。总体GEE由下式给出：\n$$\nE\\left[ D_i(\\beta)^{\\top} V_i^{-1} \\left\\{ Y_i - \\mu_i(\\beta) \\right\\} \\right] = 0\n$$\n此方程的各组成部分定义如下：\n- $Y_i = (Y_{i1}, \\dots, Y_{im})^{\\top}$ 是患者 $i$ 的结局向量。\n- $Y_i$ 的真实数据生成过程是 $Y_{ij} = \\beta_0^{\\star} + \\beta_1^{\\star} A_i + \\gamma Z_i + \\varepsilon_{ij}$。向量形式为：\n  $$Y_i = (\\beta_0^{\\star} + \\beta_1^{\\star} A_i + \\gamma Z_i) \\mathbf{1}_m + \\varepsilon_i$$\n  其中 $\\mathbf{1}_m$ 是一个 $m \\times 1$ 的全1向量，$\\varepsilon_i = (\\varepsilon_{i1}, \\dots, \\varepsilon_{im})^{\\top}$。\n- 错误设定的均值模型是 $\\mu_i(\\beta) = E(Y_i \\mid A_i) = (\\beta_0 + \\beta_1 A_i) \\mathbf{1}_m$。\n- 导数矩阵是 $D_i(\\beta) = \\frac{\\partial \\mu_i(\\beta)}{\\partial \\beta^{\\top}} = \\begin{pmatrix} \\frac{\\partial \\mu_i}{\\partial \\beta_0}  \\frac{\\partial \\mu_i}{\\partial \\beta_1} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{1}_m  A_i \\mathbf{1}_m \\end{pmatrix}$。\n- 工作协方差矩阵是 $V_i = \\sigma^2 R_m(\\rho)$，其中 $R_m(\\rho)$ 是 $m \\times m$ 的可交换相关矩阵。\n\n将这些代入总体GEE：\n$$\nE\\left[ \\begin{pmatrix} \\mathbf{1}_m^{\\top} \\\\ A_i \\mathbf{1}_m^{\\top} \\end{pmatrix} V_i^{-1} \\left\\{ ((\\beta_0^{\\star} + \\beta_1^{\\star} A_i + \\gamma Z_i) \\mathbf{1}_m + \\varepsilon_i) - ((\\beta_0 + \\beta_1 A_i) \\mathbf{1}_m) \\right\\} \\right] = 0\n$$\n这可以重写为：\n$$\nE\\left[ \\begin{pmatrix} \\mathbf{1}_m^{\\top} \\\\ A_i \\mathbf{1}_m^{\\top} \\end{pmatrix} V_i^{-1} ((\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i) \\mathbf{1}_m \\right] + E\\left[ \\begin{pmatrix} \\mathbf{1}_m^{\\top} \\\\ A_i \\mathbf{1}_m^{\\top} \\end{pmatrix} V_i^{-1} \\varepsilon_i \\right] = 0\n$$\n我们来分析第二项。期望是针对 $A_i, Z_i, \\varepsilon_i$ 的联合分布计算的。由于 $\\varepsilon_i$ 独立于 $A_i$ 和 $Z_i$（因此也独立于 $D_i$）并且均值为零，我们可以使用全期望定律：\n$$\nE\\left[ D_i^{\\top} V_i^{-1} \\varepsilon_i \\right] = E\\left[ E\\left[ D_i^{\\top} V_i^{-1} \\varepsilon_i \\mid A_i, Z_i \\right] \\right] = E\\left[ D_i^{\\top} V_i^{-1} E\\left[ \\varepsilon_i \\mid A_i, Z_i \\right] \\right] = E\\left[ D_i^{\\top} V_i^{-1} \\cdot 0 \\right] = 0\n$$\n因此，总体GEE简化为：\n$$\nE\\left[ \\begin{pmatrix} \\mathbf{1}_m^{\\top} \\\\ A_i \\mathbf{1}_m^{\\top} \\end{pmatrix} V_i^{-1} \\mathbf{1}_m ((\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i) \\right] = 0\n$$\n项 $\\mathbf{1}_m^{\\top} V_i^{-1} \\mathbf{1}_m$ 是一个标量。我们来计算它。工作协方差为 $V_i = \\sigma^2 R_m(\\rho) = \\sigma^2((1-\\rho)I_m + \\rho \\mathbf{1}_m\\mathbf{1}_m^{\\top})$。其逆矩阵为 $V_i^{-1} = \\frac{1}{\\sigma^2(1-\\rho)}\\left(I_m - \\frac{\\rho}{1+(m-1)\\rho}\\mathbf{1}_m\\mathbf{1}_m^{\\top}\\right)$。\n那么，\n$$\n\\mathbf{1}_m^{\\top} V_i^{-1} \\mathbf{1}_m = \\frac{1}{\\sigma^2(1-\\rho)}\\left(\\mathbf{1}_m^{\\top}I_m\\mathbf{1}_m - \\frac{\\rho}{1+(m-1)\\rho}\\mathbf{1}_m^{\\top}\\mathbf{1}_m\\mathbf{1}_m^{\\top}\\mathbf{1}_m\\right)\n$$\n$$\n= \\frac{1}{\\sigma^2(1-\\rho)}\\left(m - \\frac{\\rho m^2}{1+(m-1)\\rho}\\right) = \\frac{m(1+(m-1)\\rho) - m^2\\rho}{\\sigma^2(1-\\rho)(1+(m-1)\\rho)}\n$$\n$$\n= \\frac{m+m^2\\rho-m\\rho - m^2\\rho}{\\sigma^2(1-\\rho)(1+(m-1)\\rho)} = \\frac{m(1-\\rho)}{\\sigma^2(1-\\rho)(1+(m-1)\\rho)} = \\frac{m}{\\sigma^2(1+(m-1)\\rho)}\n$$\n我们将这个标量常数记为 $W = \\frac{m}{\\sigma^2(1+(m-1)\\rho)}$。由于 $m \\geq 2$ 且 $\\rho \\in (-1/(m-1), 1)$，分母非零，因此 $W$ 是一个良定义的非零常数。\n总体GEE变为：\n$$\nE\\left[ \\begin{pmatrix} 1 \\\\ A_i \\end{pmatrix} W ((\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i) \\right] = 0\n$$\n由于 $W$ 是一个非零常数，我们可以将其约去。这是证明结果为何不依赖于工作相关参数 $\\rho$（或尺度参数 $\\sigma^2$）的关键步骤。\n$$\nE\\left[ \\begin{pmatrix} 1 \\\\ A_i \\end{pmatrix} ((\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i) \\right] = 0\n$$\n这产生了一个由两个方程组成的方程组：\n1. $E\\left[ (\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i \\right] = 0$\n2. $E\\left[ A_i ((\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) A_i + \\gamma Z_i) \\right] = 0$\n\n利用期望的线性性质，我们得到：\n1. $(\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1) E[A_i] + \\gamma E[Z_i] = 0$\n2. $(\\beta_0^{\\star} - \\beta_0) E[A_i] + (\\beta_1^{\\star} - \\beta_1) E[A_i^2] + \\gamma E[A_i Z_i] = 0$\n\n我们需要计算期望 $E[Z_i]$、$E[A_i]$、$E[A_i^2]$ 和 $E[A_i Z_i]$。\n给定 $Z_i \\sim \\mathcal{N}(0, \\sigma_Z^2)$，我们有 $E[Z_i] = 0$ 且 $\\operatorname{Var}(Z_i) = E[Z_i^2] = \\sigma_Z^2$。\n给定 $A_i = \\delta Z_i + \\eta_i$，其中 $\\eta_i \\sim \\mathcal{N}(0, \\sigma_{\\eta}^2)$ 且 $Z_i, \\eta_i$ 独立：\n- $E[A_i] = E[\\delta Z_i + \\eta_i] = \\delta E[Z_i] + E[\\eta_i] = \\delta(0) + 0 = 0$。\n- $E[A_i^2] = \\operatorname{Var}(A_i) + (E[A_i])^2 = \\operatorname{Var}(\\delta Z_i + \\eta_i) + 0^2 = \\delta^2 \\operatorname{Var}(Z_i) + \\operatorname{Var}(\\eta_i) = \\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2$。\n- $E[A_i Z_i] = E[(\\delta Z_i + \\eta_i) Z_i] = E[\\delta Z_i^2 + \\eta_i Z_i] = \\delta E[Z_i^2] + E[\\eta_i]E[Z_i] = \\delta \\sigma_Z^2 + (0)(0) = \\delta \\sigma_Z^2$。\n\n将这些期望值代入方程组：\n1. $(\\beta_0^{\\star} - \\beta_0) + (\\beta_1^{\\star} - \\beta_1)(0) + \\gamma(0) = 0 \\implies \\beta_0^{\\star} - \\beta_0 = 0 \\implies \\beta_0 = \\beta_0^{\\star}$。\n   截距估计量是渐近无偏的。\n\n2. $(\\beta_0^{\\star} - \\beta_0)(0) + (\\beta_1^{\\star} - \\beta_1)E[A_i^2] + \\gamma E[A_i Z_i] = 0$\n   $(\\beta_1^{\\star} - \\beta_1) (\\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2) + \\gamma (\\delta \\sigma_Z^2) = 0$。\n\n我们求解 $\\hat{\\beta}_1$ 的渐近极限 $\\beta_1$：\n$(\\beta_1 - \\beta_1^{\\star}) (\\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2) = \\gamma \\delta \\sigma_Z^2$。\n$\\beta_1 = \\beta_1^{\\star} + \\frac{\\gamma \\delta \\sigma_Z^2}{\\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2}$。\n\n由于遗漏了混杂因子 $Z_i$，渐近极限 $\\beta_1$ 不同于真实参数 $\\beta_1^{\\star}$。只要 $\\gamma \\neq 0$（混杂因子影响结局）、$\\delta \\neq 0$（混杂因子影响暴露）且 $\\sigma_Z^2 > 0$（混杂因子具有方差），这个差异就非零。\n\n$\\hat{\\beta}_1$ 的渐近偏差定义为 $\\operatorname{Bias}(\\hat{\\beta}_1) = \\lim_{n \\to \\infty} E(\\hat{\\beta}_1) - \\beta_1^{\\star} = \\beta_1 - \\beta_1^{\\star}$。\n从上一个方程，我们得到偏差的闭式表达式：\n$$\n\\operatorname{Bias}(\\hat{\\beta}_1) = \\frac{\\gamma \\delta \\sigma_Z^2}{\\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2}\n$$\n该表达式依赖于控制混杂结构的参数（$\\gamma, \\delta, \\sigma_Z^2$）和暴露模型（$\\sigma_{\\eta}^2$），但与患者内相关 $\\rho$ 和误差方差 $\\sigma^2$ 无关。这种无关性是由于GEE在恒等连接和患者水平协变量下的特定结构所致，这导致含有 $\\rho$ 和 $\\sigma^2$ 的项从总体估计方程中被消去。",
            "answer": "$$\n\\boxed{\\frac{\\gamma \\delta \\sigma_Z^2}{\\delta^2 \\sigma_Z^2 + \\sigma_{\\eta}^2}}\n$$"
        }
    ]
}