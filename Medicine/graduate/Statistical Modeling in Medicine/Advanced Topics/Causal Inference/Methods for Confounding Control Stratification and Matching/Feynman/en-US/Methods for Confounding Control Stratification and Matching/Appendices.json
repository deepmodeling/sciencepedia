{
    "hands_on_practices": [
        {
            "introduction": "A primary challenge in observational research is confounding, where a variable is associated with both the treatment and the outcome, distorting the estimated treatment effect. This exercise  provides a classic numerical illustration of Simpson's paradox, a phenomenon where a trend appears in several different groups of data but disappears or reverses when these groups are combined. By working through this hypothetical scenario, you will see firsthand how a crude, unadjusted analysis can be dangerously misleading and appreciate the fundamental role of stratification in revealing true underlying associations.",
            "id": "4973496",
            "problem": "Consider an observational cohort study of hospitalized adults with community-acquired pneumonia evaluating the effect of an early broad-spectrum antibiotic ($T=1$) versus delayed or narrow-spectrum management ($T=0$) on a binary outcome of clinical recovery by day $30$ ($Y=1$ for recovery, $Y=0$ otherwise). Disease severity at admission is classified into two strata based on a validated severity index: stratum $\\mathcal{S}_{0}$ (milder presentation) and stratum $\\mathcal{S}_{1}$ (severe presentation). Severity is a potential confounder of the treatment-outcome relationship because it influences both treatment choice and prognosis.\n\nYou are given the following counts:\n\n- In stratum $\\mathcal{S}_{0}$: among the treated ($T=1$), $42$ of $50$ recovered; among the untreated ($T=0$), $320$ of $400$ recovered.\n- In stratum $\\mathcal{S}_{1}$: among the treated ($T=1$), $150$ of $600$ recovered; among the untreated ($T=0$), $18$ of $80$ recovered.\n\nUsing only fundamental probability definitions and without introducing untested modeling assumptions, compute the overall marginal risk difference, defined as\n$$ RD_{\\text{marginal}} \\equiv \\Pr(Y=1 \\mid T=1) - \\Pr(Y=1 \\mid T=0), $$\nwhen severity strata are ignored (that is, collapsed across $\\mathcal{S}_{0}$ and $\\mathcal{S}_{1}$). Express your answer as a decimal and round your final result to four significant figures.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded, well-posed, and objective. It presents a standard epidemiological task based on provided count data, allowing for a unique and meaningful solution. All necessary information is provided, and there are no contradictions or ambiguities.\n\nThe objective is to compute the overall marginal risk difference, $RD_{\\text{marginal}}$, which quantifies the difference in the probability of recovery between the treated and untreated groups when the confounding variable, disease severity, is ignored. The definition is given as:\n$$\nRD_{\\text{marginal}} \\equiv \\Pr(Y=1 \\mid T=1) - \\Pr(Y=1 \\mid T=0)\n$$\nHere, $Y=1$ denotes recovery, $T=1$ denotes receiving the early broad-spectrum antibiotic treatment, and $T=0$ denotes the alternative management. The probabilities are estimated from the provided sample counts.\n\nThe problem requires us to collapse the data across the two severity strata, $\\mathcal{S}_{0}$ (milder) and $\\mathcal{S}_{1}$ (severe). We first aggregate the counts for the treated population ($T=1$) and the untreated population ($T=0$) across both strata.\n\nLet $N_{T=t, S=s}$ be the number of individuals and $C_{T=t, S=s}$ be the count of recovered individuals, for treatment status $t \\in \\{0, 1\\}$ and stratum $s \\in \\{0, 1\\}$.\n\nThe given data are:\nFor stratum $\\mathcal{S}_{0}$:\n- Treated ($T=1$): $C_{T=1, S=0} = 42$, $N_{T=1, S=0} = 50$.\n- Untreated ($T=0$): $C_{T=0, S=0} = 320$, $N_{T=0, S=0} = 400$.\n\nFor stratum $\\mathcal{S}_{1}$:\n- Treated ($T=1$): $C_{T=1, S=1} = 150$, $N_{T=1, S=1} = 600$.\n- Untreated ($T=0$): $C_{T=0, S=1} = 18$, $N_{T=0, S=1} = 80$.\n\nTo calculate the marginal probabilities, we first find the total counts for the entire study population, collapsed across strata.\n\nTotal number of recovered individuals in the treated group ($T=1$):\n$$\nC_{T=1} = C_{T=1, S=0} + C_{T=1, S=1} = 42 + 150 = 192\n$$\nTotal number of individuals in the treated group ($T=1$):\n$$\nN_{T=1} = N_{T=1, S=0} + N_{T=1, S=1} = 50 + 600 = 650\n$$\n\nTotal number of recovered individuals in the untreated group ($T=0$):\n$$\nC_{T=0} = C_{T=0, S=0} + C_{T=0, S=1} = 320 + 18 = 338\n$$\nTotal number of individuals in the untreated group ($T=0$):\n$$\nN_{T=0} = N_{T=0, S=0} + N_{T=0, S=1} = 400 + 80 = 480\n$$\n\nNow, we estimate the marginal probabilities (risks) of recovery for each treatment group using these aggregated counts.\n\nThe probability of recovery given treatment ($T=1$) is estimated as:\n$$\n\\Pr(Y=1 \\mid T=1) \\approx \\frac{C_{T=1}}{N_{T=1}} = \\frac{192}{650}\n$$\n\nThe probability of recovery given no treatment ($T=0$) is estimated as:\n$$\n\\Pr(Y=1 \\mid T=0) \\approx \\frac{C_{T=0}}{N_{T=0}} = \\frac{338}{480}\n$$\n\nFinally, we compute the marginal risk difference by subtracting the risk in the untreated group from the risk in the treated group:\n$$\nRD_{\\text{marginal}} \\approx \\frac{192}{650} - \\frac{338}{480}\n$$\nWe convert these fractions to their decimal representations for calculation:\n$$\n\\frac{192}{650} \\approx 0.2953846...\n$$\n$$\n\\frac{338}{480} = \\frac{169}{240} \\approx 0.7041666...\n$$\nThe risk difference is therefore:\n$$\nRD_{\\text{marginal}} \\approx 0.2953846 - 0.7041666 = -0.408782...\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $4$, $0$, $8$, and $7$. The fifth significant figure is $8$, which is $\\ge 5$, so we round up the fourth significant figure.\n$$\nRD_{\\text{marginal}} \\approx -0.4088\n$$\nThis negative value indicates that in this crude, unadjusted analysis, the early broad-spectrum antibiotic treatment is associated with a substantially lower probability of recovery compared to the alternative management. This counterintuitive result is a classic example of confounding by indication (a form of Simpson's paradox), where the sickest patients are preferentially given the treatment being studied, making the treatment appear harmful when in fact it may be beneficial or neutral.",
            "answer": "$$\n\\boxed{-0.4088}\n$$"
        },
        {
            "introduction": "Once the need for confounding control is established, we turn to practical methods like matching. Caliper matching, a widely used technique, aims to find control subjects who are similar to treated subjects on a key confounder, but this process can lead to a loss of sample size. This hands-on problem  asks you to quantify the efficiency of a matching procedure by deriving the expected number of successful pairs based on statistical first principles. Mastering this calculation provides insight into the practical trade-offs involved in designing a matched observational study.",
            "id": "4973494",
            "problem": "A clinical study evaluates the effect of a treatment on postoperative outcomes using risk-set matching based on a scalar prognostic score $L$ that summarizes baseline risk. In the treated group, the prognostic score for a randomly drawn treated subject is modeled as $L_{t} \\sim \\mathcal{N}(\\mu_{t}, \\sigma_{t}^{2})$, and in the control group, it is modeled as $L_{c} \\sim \\mathcal{N}(\\mu_{c}, \\sigma_{c}^{2})$, with $L_{t}$ and $L_{c}$ independent. There are $n_{t}$ treated subjects and $n_{c}$ controls, with $n_{c}$ sufficiently large that sampling controls with replacement is appropriate.\n\nA $1:1$ matching procedure with replacement is implemented as follows: for each of the $n_{t}$ treated subjects, one control is drawn independently at random from the control pool (with replacement), and the pair is retained if and only if the caliper rule $|L_{t} - L_{c}| \\leq \\delta$ holds for a fixed caliper width $\\delta > 0$. If the rule fails, the treated subject remains unmatched and is discarded from analysis. This procedure is repeated independently for each treated subject.\n\nStarting from first principles of probability (linearity of expectation, independence, and the distribution of differences of independent normal random variables), derive an analytic expression for the expected number of retained matched pairs as a function of $n_{t}$, $\\mu_{t}$, $\\mu_{c}$, $\\sigma_{t}^{2}$, $\\sigma_{c}^{2}$, and $\\delta$. Express your final answer using the cumulative distribution function of the standard normal distribution, denoted $\\Phi(\\cdot)$, and provide a single closed-form analytical expression. No numerical approximation is required, and no rounding is needed.",
            "solution": "We are asked to compute the expected number of retained matched pairs under a caliper matching rule when, for each treated subject, one control is drawn independently with replacement and the pair is retained if and only if $|L_{t} - L_{c}| \\leq \\delta$. The treated prognostic score is modeled as $L_{t} \\sim \\mathcal{N}(\\mu_{t}, \\sigma_{t}^{2})$, the control prognostic score as $L_{c} \\sim \\mathcal{N}(\\mu_{c}, \\sigma_{c}^{2})$, and $L_{t}$ and $L_{c}$ are independent.\n\nThe fundamental bases we will use are:\n- Linearity of expectation: for indicator random variables $I_{i}$, $\\mathbb{E}\\left[\\sum_{i=1}^{n_{t}} I_{i}\\right] = \\sum_{i=1}^{n_{t}} \\mathbb{E}[I_{i}]$.\n- Independence of $L_{t}$ and $L_{c}$, and the property that the difference of two independent normal random variables is normal with mean equal to the difference of means and variance equal to the sum of variances.\n- The definition of the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(x) = \\mathbb{P}(Z \\leq x)$ for $Z \\sim \\mathcal{N}(0,1)$.\n\nDefine indicator variables $I_{i}$ for $i = 1, \\dots, n_{t}$, where $I_{i} = 1$ if the $i$-th treated subject is retained (i.e., the randomly drawn control for that treated subject satisfies $|L_{t}^{(i)} - L_{c}^{(i)}| \\leq \\delta$), and $I_{i} = 0$ otherwise. The total number of retained matched pairs is\n$$\nM \\equiv \\sum_{i=1}^{n_{t}} I_{i}.\n$$\nBy linearity of expectation,\n$$\n\\mathbb{E}[M] = \\sum_{i=1}^{n_{t}} \\mathbb{E}[I_{i}] = n_{t} \\, \\mathbb{E}[I_{1}],\n$$\nsince each $I_{i}$ has the same distribution by the identical matching procedure applied to identically distributed draws $L_{t}^{(i)} \\sim \\mathcal{N}(\\mu_{t}, \\sigma_{t}^{2})$ and $L_{c}^{(i)} \\sim \\mathcal{N}(\\mu_{c}, \\sigma_{c}^{2})$, independent across $i$ and between $L_{t}^{(i)}$ and $L_{c}^{(i)}$.\n\nNext, note that\n$$\n\\mathbb{E}[I_{1}] = \\mathbb{P}\\left(|L_{t} - L_{c}| \\leq \\delta\\right).\n$$\nDefine the difference random variable\n$$\nD \\equiv L_{t} - L_{c}.\n$$\nBecause $L_{t} \\sim \\mathcal{N}(\\mu_{t}, \\sigma_{t}^{2})$ and $L_{c} \\sim \\mathcal{N}(\\mu_{c}, \\sigma_{c}^{2})$ are independent, the difference $D$ is normally distributed with\n$$\n\\mu_{\\Delta} \\equiv \\mathbb{E}[D] = \\mu_{t} - \\mu_{c}, \\quad \\sigma_{\\Delta}^{2} \\equiv \\operatorname{Var}(D) = \\sigma_{t}^{2} + \\sigma_{c}^{2},\n$$\nthat is,\n$$\nD \\sim \\mathcal{N}(\\mu_{\\Delta}, \\sigma_{\\Delta}^{2}).\n$$\nTherefore,\n$$\n\\mathbb{P}\\left(|L_{t} - L_{c}| \\leq \\delta\\right) = \\mathbb{P}\\left(|D| \\leq \\delta\\right) = \\mathbb{P}\\left(-\\delta \\leq D \\leq \\delta\\right).\n$$\nStandardizing $D$ using $Z = (D - \\mu_{\\Delta})/\\sigma_{\\Delta}$ with $Z \\sim \\mathcal{N}(0,1)$, we obtain\n$$\n\\mathbb{P}\\left(-\\delta \\leq D \\leq \\delta\\right) = \\mathbb{P}\\left(\\frac{-\\delta - \\mu_{\\Delta}}{\\sigma_{\\Delta}} \\leq Z \\leq \\frac{\\delta - \\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right) = \\Phi\\!\\left(\\frac{\\delta - \\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right) - \\Phi\\!\\left(\\frac{-\\delta - \\mu_{\\Delta}}{\\sigma_{\\Delta}}\\right),\n$$\nwhere $\\Phi(\\cdot)$ denotes the cumulative distribution function of the standard normal distribution.\n\nCombining these results, the expected number of retained matched pairs is\n$$\n\\mathbb{E}[M] = n_{t} \\left[ \\Phi\\!\\left(\\frac{\\delta - (\\mu_{t} - \\mu_{c})}{\\sqrt{\\sigma_{t}^{2} + \\sigma_{c}^{2}}}\\right) - \\Phi\\!\\left(\\frac{-\\delta - (\\mu_{t} - \\mu_{c})}{\\sqrt{\\sigma_{t}^{2} + \\sigma_{c}^{2}}}\\right) \\right].\n$$\nThis expression is fully analytic in terms of $n_{t}$, $\\mu_{t}$, $\\mu_{c}$, $\\sigma_{t}^{2}$, $\\sigma_{c}^{2}$, $\\delta$, and the standard normal cumulative distribution function $\\Phi(\\cdot)$, and it follows directly from linearity of expectation and the distribution of the difference of independent normal random variables.",
            "answer": "$$\\boxed{n_{t}\\left[\\Phi\\!\\left(\\frac{\\delta-(\\mu_{t}-\\mu_{c})}{\\sqrt{\\sigma_{t}^{2}+\\sigma_{c}^{2}}}\\right)-\\Phi\\!\\left(\\frac{-\\delta-(\\mu_{t}-\\mu_{c})}{\\sqrt{\\sigma_{t}^{2}+\\sigma_{c}^{2}}}\\right)\\right]}$$"
        },
        {
            "introduction": "While stratification and matching are essential tools, their misuse can be worse than not using them at all. A particularly insidious error is conditioning on a variable affected by the treatment itself, known as a collider. This exercise  uses a Directed Acyclic Graph (DAG) and a concrete numerical example to illustrate how stratifying on a post-treatment biomarker can induce a spurious association and reverse the apparent effect of a treatment. This practice is crucial for developing the critical thinking needed to distinguish between valid confounding control and the introduction of selection bias.",
            "id": "4973424",
            "problem": "A clinical trial investigates the effect of an antihypertensive treatment on subsequent risk of stroke. Let the binary exposure be $A \\in \\{0,1\\}$ (where $A=1$ denotes treatment), the binary outcome be $Y \\in \\{0,1\\}$ (where $Y=1$ denotes stroke within $1$ year), and a biomarker measured at $3$ months post-randomization be $M \\in \\{0,1\\}$ (where $M=1$ denotes normalized blood pressure at $3$ months). Suppose randomization ensures $A$ is independent of all pretreatment common causes of $Y$ so that, marginally, comparing $Y$ across $A$ identifies a causal effect. Consider an unmeasured patient factor $U$ (for example, genetic variation affecting vascular reactivity) such that $U$ affects both $M$ and $Y$, but $U$ does not affect $A$ due to randomization. The data-generating process is consistent with a Directed Acyclic Graph (DAG) having arrows $A \\to M \\to Y$ and $U \\to M$, $U \\to Y$, and no arrow from $U$ to $A$. A collaborator proposes to stratify on the biomarker $M$ to address “residual confounding.”\n\nTo make concrete the phenomenon under discussion, suppose the following conditional probabilities are approximately observed in a very large trial:\n- $P(M=1 \\mid A=1) \\approx 0.85$, $P(M=1 \\mid A=0) \\approx 0.15$,\n- $P(Y=1 \\mid A=1, M=1) \\approx 0.18$, $P(Y=1 \\mid A=0, M=1) \\approx 0.10$,\n- $P(Y=1 \\mid A=1, M=0) \\approx 0.40$, $P(Y=1 \\mid A=0, M=0) \\approx 0.30$.\n\nFrom these, the marginal risks satisfy $P(Y=1 \\mid A=1) \\approx 0.85 \\cdot 0.18 + 0.15 \\cdot 0.40 = 0.213$ and $P(Y=1 \\mid A=0) \\approx 0.15 \\cdot 0.10 + 0.85 \\cdot 0.30 = 0.270$, so the marginal association suggests benefit of treatment ($0.213 < 0.270$), while within each stratum of $M$ the association appears harmful ($0.18 > 0.10$ and $0.40 > 0.30$). You are to evaluate, from first principles, the impact of stratifying on a post-treatment variable on the occurrence of Simpson’s paradox and to justify whether such stratification addresses confounding or introduces bias.\n\nWhich statement best explains these findings and correctly characterizes the impact of stratifying on $M$?\n\nA. Stratifying on the post-treatment $M$ can induce a reversal of the exposure–outcome association (an instance of Simpson’s paradox) by opening the noncausal path $A \\to M \\leftarrow U \\to Y$; this is selection bias due to conditioning on a collider and biases the total effect even under randomization, so it does not resolve confounding.\n\nB. Because $A$ is randomized, stratifying on any variable including $M$ cannot change the direction of the association between $A$ and $Y$; any reversal must reflect model misspecification rather than bias.\n\nC. Since $U$ affects both $M$ and $Y$, stratifying on $M$ blocks the backdoor path through $U$ and therefore removes confounding, ensuring the within-stratum comparisons identify the causal effect.\n\nD. Matching treated and untreated patients on $M$ (instead of stratifying) avoids selection bias induced by conditioning on post-treatment variables and thus resolves the reversal.\n\nE. The reversal within $M$ strata indicates that stratification on $M$ consistently identifies the controlled direct effect of $A$ on $Y$ not mediated by $M$, regardless of the presence of $U$.",
            "solution": "This problem illustrates the critical concept of collider-stratification bias, a type of selection bias that can arise even in a randomized trial. The correct explanation is given by option A.\n\n**Analysis of the Causal Structure:**\nThe provided Directed Acyclic Graph (DAG) has the following key paths:\n1.  **Causal Path:** $A \\to M \\to Y$. This is the indirect causal effect of the treatment ($A$) on the outcome ($Y$), mediated by the biomarker ($M$).\n2.  **Non-Causal Path:** $A \\to M \\leftarrow U \\to Y$. Here, the biomarker $M$ is a **collider** because it is a common effect of the treatment $A$ and the unmeasured factor $U$.\n\nDue to randomization, there is no confounding of the total causal effect of $A$ on $Y$. The marginal (unstratified) risk ratio correctly identifies this total effect, which the data show to be beneficial ($0.213 < 0.270$).\n\n**Why Stratifying on $M$ Induces Bias:**\nThe collaborator's proposal to stratify on the post-treatment biomarker $M$ is a serious error. According to the rules of d-separation in DAGs, conditioning on a collider (or any of its descendants) opens the non-causal path that was previously blocked at that collider.\n\nBy stratifying on $M$, we are conditioning on it. This opens the path $A \\to M \\leftarrow U \\to Y$, creating a spurious, non-causal association between $A$ and $Y$. This induced association is a form of selection bias. The observed association within each stratum of $M$ is a mixture of the true direct effect of $A$ on $Y$ and this spurious association. In this numerical example, the bias is strong enough to reverse the direction of the association, making the treatment appear harmful within each stratum (Simpson's Paradox).\n\n**Evaluation of the Options:**\n*   **A. Correct.** This option accurately identifies that stratifying on the collider $M$ opens the non-causal path $A \\to M \\leftarrow U \\to Y$, inducing selection bias that explains the paradox.\n*   **B. Incorrect.** Randomization protects the marginal estimate, not conditional estimates. Conditioning on a post-treatment variable can and does induce bias.\n*   **C. Incorrect.** The path involving $U$ is not a backdoor path, and conditioning on the collider $M$ *opens* this path, rather than blocking it.\n*   **D. Incorrect.** Matching is a form of conditioning. Matching on $M$ would induce the same collider bias as stratification.\n*   **E. Incorrect.** The stratum-specific associations do not identify the controlled direct effect (CDE) because the relationship between the mediator $M$ and outcome $Y$ is confounded by the unmeasured variable $U$. To identify the CDE, one would need to control for $U$, which is unmeasured.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}