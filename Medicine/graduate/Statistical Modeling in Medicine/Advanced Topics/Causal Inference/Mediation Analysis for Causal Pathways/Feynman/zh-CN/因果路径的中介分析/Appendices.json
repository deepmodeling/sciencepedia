{
    "hands_on_practices": [
        {
            "introduction": "掌握中介分析的第一步是深刻理解其核心识别公式。本练习将引导你从基本原理出发，推导离散变量情景下自然间接效应（Natural Indirect Effect, NIE）的识别公式。通过在一个具体的临床试验假设场景中手动计算NIE，你将巩固对潜在结果、识别假设以及如何连接理论与观测数据的理解，这是应用中介分析的基础。",
            "id": "4972558",
            "problem": "一项基于医院的随机对照试验 (RCT) 评估了一种新的抗炎疗法，其中二元暴露 $X \\in \\{0,1\\}$ 表示分配至新疗法 ($X=1$) 或标准护理 ($X=0$) 。中介变量是一个二元早期生物学反应 $M \\in \\{0,1\\}$，定义为C反应蛋白 (CRP) 的快速降低，结局 $Y \\in \\{0,1\\}$ 是12周时的临床缓解。设 $C$ 表示一个分类的基线风险评分，取三个值 $c \\in \\{0,1,2\\}$，其分布已知。使用潜在结局框架，其中 $Y(x,m)$ 表示当暴露设定为 $x$ 且中介变量设定为 $m$ 时将被观察到的结局， $M(x)$ 表示当暴露设定为 $x$ 时将被观察到的中介变量。假设以下可识别性条件成立：一致性、正值性及序贯可忽略性，即在给定观察到的基线协变量 $C$ 的条件下，暴露-中介变量和中介变量-结局的关联没有未测量的混杂，并且在给定暴露和协变量的条件下，中介变量-结局的可忽略性成立。\n\n从这些定义和假设出发，推导当暴露从 $x'=0$ 变为 $x=1$ 时的自然间接效应 (NIE) 的离散求和可识别性公式，其定义为 $\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1)) - Y(0, M(0))]$。使用可观察的条件概率，将已识别的NIE表示为对 $C$ 的支撑集和二元中介变量 $M \\in \\{0,1\\}$ 的求和形式。然后，使用从RCT中得到的以下观测数据，计算NIE，并将您的最终答案四舍五入至四位有效数字。\n\n基线协变量分布为：$\\mathbb{P}(C=0) = 0.40$，$\\mathbb{P}(C=1) = 0.35$，$\\mathbb{P}(C=2) = 0.25$。\n\n在暴露和协变量条件下的中介变量模型：\n$\\mathbb{P}(M=1 \\mid X=1, C=0) = 0.60$，$\\mathbb{P}(M=1 \\mid X=0, C=0) = 0.30$，\n$\\mathbb{P}(M=1 \\mid X=1, C=1) = 0.55$，$\\mathbb{P}(M=1 \\mid X=0, C=1) = 0.25$，\n$\\mathbb{P}(M=1 \\mid X=1, C=2) = 0.50$，$\\mathbb{P}(M=1 \\mid X=0, C=2) = 0.20$。\n\n在 $X=0$ 条件下的结局模型：\n$\\mathbb{E}[Y \\mid X=0, M=1, C=0] = 0.70$，$\\mathbb{E}[Y \\mid X=0, M=0, C=0] = 0.40$，\n$\\mathbb{E}[Y \\mid X=0, M=1, C=1] = 0.65$，$\\mathbb{E}[Y \\mid X=0, M=0, C=1] = 0.35$，\n$\\mathbb{E}[Y \\mid X=0, M=1, C=2] = 0.60$，$\\mathbb{E}[Y \\mid X=0, M=0, C=2] = 0.30$。\n\n您必须首先将在所述假设下识别出的NIE表示为一个离散求和公式，然后计算其数值。按照指示提供最终的数值答案，以小数形式表示，不带百分号。",
            "solution": "题目陈述经验证是科学合理的、定义明确且客观的。它提供了一个因果中介分析的标准练习，包含了完整且一致的定义、假设和数据。因此，将提供一个解答。\n\n目标是推导自然间接效应 (NIE) 的可识别性公式，然后计算其值。NIE被定义为处理通过中介变量对结局产生的影响。对于暴露从 $x'=0$ 变为 $x=1$ 的情况，NIE由下式给出（在本题的特定定义下，这通常被称为纯粹自然间接效应，Pure Natural Indirect Effect, PNIE）：\n$$\n\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1)) - Y(0, M(0))]\n$$\n利用期望的线性性质，我们可以将其写为：\n$$\n\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1))] - \\mathbb{E}[Y(0, M(0))]\n$$\n我们利用给定的假设和数据来识别右侧的每一项。这些假设是：一致性、正值性以及在给定协变量 $C$ 下的序贯可忽略性。序贯可忽略性意味着：\n$1.$ 在以 $C$ 为条件的暴露-结局、暴露-中介变量和中介变量-结局关系中，不存在未测量的混杂。具体来说，对于所有的 $x, m, x'$：\n   - $\\{Y(x,m), M(x')\\} \\perp X \\mid C$ (暴露可忽略性，通过 $X$ 的随机化得到满足)\n   - $Y(x,m) \\perp M \\mid X=x, C$ (中介变量可忽略性)\n$2.$ 识别NIE时通常需要的另一个额外假设是，对于 $x \\neq x'$，有 $Y(x,m) \\perp M(x') \\mid C$。这是一个跨世界反事实独立性假设。\n\n让我们首先识别项 $\\mathbb{E}[Y(0, M(1))]$。我们使用全期望定律，以协变量 $C$ 为条件：\n$$\n\\mathbb{E}[Y(0, M(1))] = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{E}[Y(0, M(1)) \\mid C=c] \\mathbb{P}(C=c)\n$$\n现在我们关注条件期望 $\\mathbb{E}[Y(0, M(1)) \\mid C=c]$。我们对潜在中介变量 $M(1)$ 的可能值进行展开：\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, M(1)) \\mid M(1)=m, C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\n根据定义，如果 $M(1)=m$，则 $Y(0, M(1))$ 变为 $Y(0, m)$。该表达式简化为：\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, m) \\mid M(1)=m, C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\n使用跨世界独立性假设 $Y(0,m) \\perp M(1) \\mid C=c$，我们有 $\\mathbb{E}[Y(0, m) \\mid M(1)=m, C=c] = \\mathbb{E}[Y(0, m) \\mid C=c]$。\n所以，\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, m) \\mid C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\n现在我们必须用可观测的量来识别求和式中的两个因子：\n- 对于 $\\mathbb{P}(M(1)=m \\mid C=c)$：使用暴露可忽略性 ($M(1) \\perp X \\mid C$)，我们有 $\\mathbb{P}(M(1)=m \\mid C=c) = \\mathbb{P}(M(1)=m \\mid X=1, C=c)$。根据一致性（当 $X=1$ 时，$M=M(1)$），这等于 $\\mathbb{P}(M=m \\mid X=1, C=c)$。\n- 对于 $\\mathbb{E}[Y(0, m) \\mid C=c]$：使用暴露可忽略性 ($Y(0,m) \\perp X \\mid C$)，我们有 $\\mathbb{E}[Y(0, m) \\mid C=c] = \\mathbb{E}[Y(0, m) \\mid X=0, C=c]$。然后，使用中介变量可忽略性 ($Y(0,m) \\perp M \\mid X=0, C=c$) 和一致性（当 $X=0, M=m$ 时，$Y=Y(0,m)$），我们得到 $\\mathbb{E}[Y(0, m) \\mid X=0, C=c] = \\mathbb{E}[Y \\mid X=0, M=m, C=c]$。\n\n将这些代回，我们得到第一项的已识别表达式：\n$$\n\\mathbb{E}[Y(0, M(1))] = \\sum_{c \\in \\{0,1,2\\}} \\left( \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=1, C=c) \\right) \\mathbb{P}(C=c)\n$$\n\n接下来，我们识别第二项 $\\mathbb{E}[Y(0, M(0))]$。这个量代表在暴露和中介路径均为对照条件 ($X=0$) 下的期望结局。它可以直接从对照组的数据中识别。\n$$\n\\mathbb{E}[Y(0, M(0))] = \\mathbb{E}[Y \\mid X=0]\n$$\n根据对 $C$ 和 $M$ 的全期望定律：\n$$\n\\mathbb{E}[Y \\mid X=0] = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{E}[Y \\mid X=0, C=c] \\mathbb{P}(C=c \\mid X=0)\n$$\n由于 $X$ 是随机化的，所以 $C \\perp X$，因此 $\\mathbb{P}(C=c \\mid X=0) = \\mathbb{P}(C=c)$。\n$$\n\\mathbb{E}[Y \\mid X=0, C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=0, C=c)\n$$\n因此，第二项的已识别表达式为：\n$$\n\\mathbb{E}[Y(0, M(0))] = \\sum_{c \\in \\{0,1,2\\}} \\left( \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=0, C=c) \\right) \\mathbb{P}(C=c)\n$$\n从第一项已识别表达式中减去第二项，得到NIE的离散求和公式：\n$$\n\\text{NIE}(1,0) = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{P}(C=c) \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\left( \\mathbb{P}(M=m \\mid X=1, C=c) - \\mathbb{P}(M=m \\mid X=0, C=c) \\right)\n$$\n这就是所要求的可识别性公式。对于二元中介变量 $M \\in \\{0,1\\}$，我们可以简化此表达式。令 $\\Delta\\mathbb{P}_M(c) = \\mathbb{P}(M=1 \\mid X=1, C=c) - \\mathbb{P}(M=1 \\mid X=0, C=c)$。那么 $\\mathbb{P}(M=0 \\mid X=1, C=c) - \\mathbb{P}(M=0 \\mid X=0, C=c) = -\\Delta\\mathbb{P}_M(c)$。内层求和变为：\n$$\n\\left( \\mathbb{E}[Y \\mid X=0, M=1, C=c] - \\mathbb{E}[Y \\mid X=0, M=0, C=c] \\right) \\times \\left( \\mathbb{P}(M=1 \\mid X=1, C=c) - \\mathbb{P}(M=1 \\mid X=0, C=c) \\right)\n$$\n所以，用于计算的完整表达式是：\n$$\n\\text{NIE}(1,0) = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{P}(C=c) \\Big[ (\\mathbb{E}[Y|X=0, M=1, C=c] - \\mathbb{E}[Y|X=0, M=0, C=c]) \\times (\\mathbb{P}(M=1|X=1, C=c) - \\mathbb{P}(M=1|X=0, C=c)) \\Big]\n$$\n现在我们使用提供的数据计算数值。让我们计算每个 $c$ 值的各分层贡献。\n\n对于 $C=0$：\n- 结局期望的差异：$ \\mathbb{E}[Y \\mid X=0, M=1, C=0] - \\mathbb{E}[Y \\mid X=0, M=0, C=0] = 0.70 - 0.40 = 0.30 $\n- 中介变量概率的差异：$ \\mathbb{P}(M=1 \\mid X=1, C=0) - \\mathbb{P}(M=1 \\mid X=0, C=0) = 0.60 - 0.30 = 0.30 $\n- 来自 $C=0$ 的贡献：$ 0.30 \\times 0.30 = 0.09 $\n\n对于 $C=1$：\n- 结局期望的差异：$ \\mathbb{E}[Y \\mid X=0, M=1, C=1] - \\mathbb{E}[Y \\mid X=0, M=0, C=1] = 0.65 - 0.35 = 0.30 $\n- 中介变量概率的差异：$ \\mathbb{P}(M=1 \\mid X=1, C=1) - \\mathbb{P}(M=1 \\mid X=0, C=1) = 0.55 - 0.25 = 0.30 $\n- 来自 $C=1$ 的贡献：$ 0.30 \\times 0.30 = 0.09 $\n\n对于 $C=2$：\n- 结局期望的差异：$ \\mathbb{E}[Y \\mid X=0, M=1, C=2] - \\mathbb{E}[Y \\mid X=0, M=0, C=2] = 0.60 - 0.30 = 0.30 $\n- 中介变量概率的差异：$ \\mathbb{P}(M=1 \\mid X=1, C=2) - \\mathbb{P}(M=1 \\mid X=0, C=2) = 0.50 - 0.20 = 0.30 $\n- 来自 $C=2$ 的贡献：$ 0.30 \\times 0.30 = 0.09 $\n\n总的NIE是这些贡献的加权平均值，权重为 $C$ 的分布：\n$$\n\\text{NIE} = \\mathbb{P}(C=0) \\times (0.09) + \\mathbb{P}(C=1) \\times (0.09) + \\mathbb{P}(C=2) \\times (0.09)\n$$\n$$\n\\text{NIE} = (0.40 \\times 0.09) + (0.35 \\times 0.09) + (0.25 \\times 0.09)\n$$\n$$\n\\text{NIE} = (0.40 + 0.35 + 0.25) \\times 0.09 = 1.00 \\times 0.09 = 0.09\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\text{NIE} = 0.0900\n$$",
            "answer": "$$\\boxed{0.0900}$$"
        },
        {
            "introduction": "现实世界中的因果路径很少是简单相加的，暴露与中介变量之间的交互作用普遍存在，这会使效应的分解变得复杂。本练习挑战你分析当结果模型中存在交互作用项时，纯粹自然直接效应（Pure Natural Direct Effect, PNDE）和纯粹自然间接效应（Pure Natural Indirect Effect, PNIE）的表达式会如何变化。通过这个练习，你将明白为何简单的“系数乘积”法则在这种更复杂但更现实的情况下不再适用，并学会如何正确地分解效应。",
            "id": "4972604",
            "problem": "一项临床试验研究二元处理 $A \\in \\{0,1\\}$ 对连续性肺部结局 $Y$ 的效应是否由连续性炎症生物标志物 $M$ 所中介。该试验对 $A$ 进行了随机化，研究人员调整了分析以确保在给定 $A$ 的条件下，中介-结局关系不存在未测量的混杂（序贯可忽略性），同时满足一致性和正值性。中介变量和结局的建模如下，其中结局使用恒等连接函数：\n$$\nM \\;=\\; \\alpha_0 \\;+\\; \\alpha_1 A \\;+\\; \\eta, \\qquad\nY \\;=\\; \\beta_0 \\;+\\; \\beta_1 A \\;+\\; \\beta_2 M \\;+\\; \\beta_3 (A \\times M) \\;+\\; \\varepsilon,\n$$\n其中 $\\eta$ 和 $\\varepsilon$ 的均值为 $0$。来自大样本回归的拟合值和不确定性总结如下：\n$$\n\\hat{\\alpha}_0 \\;=\\; 2.0, \\quad \\hat{\\alpha}_1 \\;=\\; -0.5; \\qquad \\hat{\\beta}_0 \\;=\\; 10.0, \\quad \\hat{\\beta}_1 \\;=\\; 1.2, \\quad \\hat{\\beta}_2 \\;=\\; 3.0, \\quad \\hat{\\beta}_3 \\;=\\; -0.8, \\quad \\mathrm{SE}(\\hat{\\beta}_3) \\;=\\; 0.35.\n$$\n仅使用这些模型、线性期望的基本性质以及纯自然直接效应 (PNDE) 和纯自然间接效应 (PNIE) 的潜在结局定义，\n$$\n\\text{PNDE} \\;=\\; \\mathbb{E}\\big[Y_{1,M_0} - Y_{0,M_0}\\big], \\qquad\n\\text{PNIE} \\;=\\; \\mathbb{E}\\big[Y_{0,M_1} - Y_{0,M_0}\\big],\n$$\n选择唯一一个正确执行以下操作的选项：\n(i) 为 $A \\times M$ 交互作用指定一个适当的基于回归的检验，并利用给定的摘要信息执行该检验，以及\n(ii) 陈述在恒等连接结局模型下，交互作用的存在对 PNDE 和 PNIE 估计的正确影响，并给出拟合模型所隐含的数值。\n\nA. 使用基于 $\\hat{\\beta}_3/\\mathrm{SE}(\\hat{\\beta}_3)$ 的 Wald 检验来检验 $H_0\\!:\\, \\beta_3 = 0$；此处，$z \\approx -0.8/0.35 \\approx -2.29$，双侧 $p \\approx 0.022$，表明存在交互作用的证据。在恒等连接结局模型下存在交互作用时，PNDE 取决于 $A=0$ 时 $M$ 的分布，且等于 $\\beta_1 + \\beta_3 \\,\\mathbb{E}[M_0]$，而 PNIE 不涉及 $\\beta_3$，等于 $\\beta_2\\{\\mathbb{E}[M_1]-\\mathbb{E}[M_0]\\}$。数值上，$\\mathbb{E}[M_0]=\\alpha_0=2.0$ 且 $\\mathbb{E}[M_1]-\\mathbb{E}[M_0]=\\alpha_1=-0.5$，因此 PNDE $=\\;1.2+(-0.8)\\times 2.0=\\,-0.4$，PNIE $=\\;3.0\\times(-0.5)=\\,-1.5$。\n\nB. 使用一个双自由度的 Wald 检验联合检验 $H_0\\!:\\, \\beta_2=\\beta_3=0$；因为 $\\hat{\\beta}_3$ 相对于其标准误不大，结论为无交互作用。存在交互作用时，PNDE 近似为 $\\beta_1$，PNIE 近似为 $\\alpha_1(\\beta_2+\\beta_3)$；数值上，PNDE $=\\;1.2$，PNIE $=\\;-0.5\\times(3.0-0.8)=\\,-1.1$。\n\nC. 使用似然比检验比较包含和不包含 $A \\times M$ 的结局模型；在 $1$ 个自由度和与 $\\hat{\\beta}_3=-0.8$ 一致的典型改进下，结论为双侧 $p \\approx 0.02$ 且存在交互作用的证据。由于存在交互作用，PNDE 和 PNIE 是不可识别的，没有有意义的解释，因此不应进行估计。\n\nD. 使用 Wald 检验检验 $H_0\\!:\\, \\beta_3 = 0$，得到 $z \\approx -0.8/0.35 \\approx -2.29$，但因为 $|z|  2.58$，所以在 $5\\%$ 的显著性水平上结论为无交互作用。存在交互作用时，PNDE 等于 $\\beta_1 + \\beta_3 \\,\\mathbb{E}[M_1]$，PNIE 等于 $\\beta_2\\,\\alpha_1 + \\beta_3\\,\\alpha_1\\,\\mathbb{E}[M_0]$。数值上，PNDE $=\\;1.2+(-0.8)\\times 1.5=\\;0.0$，PNIE $=\\;3.0\\times(-0.5)+(-0.8)\\times(-0.5)\\times 2.0=\\;-0.7$。",
            "solution": "### 第1步：提取已知条件\n\n该问题为一项中介分析提供了以下信息：\n-   二元处理：$A \\in \\{0,1\\}$\n-   连续性中介变量：$M$\n-   连续性结局：$Y$\n-   假设：$A$ 是随机化的；序贯可忽略性 ($Y_{a,m} \\perp M_a' | A=a'$ 和 $M_a \\perp \\!\\!\\! \\perp A$)；一致性；正值性。\n-   中介变量模型：$M \\;=\\; \\alpha_0 \\;+\\; \\alpha_1 A \\;+\\; \\eta$，其中 $\\mathbb{E}[\\eta]=0$。\n-   结局模型（恒等连接）：$Y \\;=\\; \\beta_0 \\;+\\; \\beta_1 A \\;+\\; \\beta_2 M \\;+\\; \\beta_3 (A \\times M) \\;+\\; \\varepsilon$，其中 $\\mathbb{E}[\\varepsilon]=0$。\n-   拟合模型参数：$\\hat{\\alpha}_0 = 2.0$, $\\hat{\\alpha}_1 = -0.5$, $\\hat{\\beta}_0 = 10.0$, $\\hat{\\beta}_1 = 1.2$, $\\hat{\\beta}_2 = 3.0$, $\\hat{\\beta}_3 = -0.8$。\n-   不确定性总结：$\\mathrm{SE}(\\hat{\\beta}_3) = 0.35$。\n-   潜在结局定义：\n    -   纯自然直接效应 (PNDE)：$\\text{PNDE} \\;=\\; \\mathbb{E}[Y_{1,M_0} - Y_{0,M_0}]$\n    -   纯自然间接效应 (PNIE)：$\\text{PNIE} \\;=\\; \\mathbb{E}[Y_{0,M_1} - Y_{0,M_0}]$\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学上成立**：该问题设置在使用潜在结局和回归模型的因果中介分析的成熟框架内。PNDE、PNIE 和序贯可忽略性的概念是该领域的标准。模型是线性的，这是一种常见且有效的简化。\n-   **提法恰当**：该问题提供了执行所需任务（检验交互作用和计算因果效应）所有必要的定义、模型和估计系数。问题是具体的，并根据所提供的信息导向唯一的解决方案。\n-   **客观性**：该问题以精确、客观的数学和统计语言陈述。没有主观或模棱两可的术语。\n-   **未检测到缺陷**：该问题没有违反任何无效性标准。它是应用统计学和因果推断中的一个标准的、可解决的问题。\n\n### 第3步：判断与行动\n\n问题陈述是有效的。将继续进行求解过程。\n\n### 因果效应和交互作用检验的推导\n\n任务分为两部分：(i) 检验 A x M 交互作用，以及 (ii) 确定 PNDE 和 PNIE 的表达式和值。\n\n#### (i) 交互作用检验\n\n结局模型是 $Y = \\beta_0 + \\beta_1 A + \\beta_2 M + \\beta_3 (A \\times M) + \\varepsilon$。项 $(A \\times M)$ 代表了处理 $A$ 和中介变量 $M$ 之间的交互作用。系数 $\\beta_3$ 量化了这种交互作用的大小。通过检验原假设 $H_0: \\beta_3 = 0$ 对备择假设 $H_1: \\beta_3 \\neq 0$，来评估是否存在统计上显著的交互作用。\n\n在给定的大样本回归背景下，对单个参数的适当检验是 Wald 检验。Wald 检验统计量 $z$ 计算为估计系数与其标准误的比值：\n$$\nz = \\frac{\\hat{\\beta}_3}{\\mathrm{SE}(\\hat{\\beta}_3)}\n$$\n使用给定的值：\n$$\nz = \\frac{-0.8}{0.35} \\approx -2.2857\n$$\n四舍五入到两位小数得到 $z \\approx -2.29$。此 $z$-统计量的双侧 $p$-值由 $P(|Z| \\ge |-2.29|)$ 给出，其中 $Z$ 是一个标准正态随机变量。即 $2 \\times \\Phi(-2.29)$，其中 $\\Phi$ 是标准正态累积分布函数。\n$$\np\\text{-值} \\approx 2 \\times 0.0110 = 0.022\n$$\n由于 $p$-值 $0.022$ 小于常规的显著性水平 $\\alpha=0.05$，我们拒绝原假设 $H_0: \\beta_3 = 0$，并得出结论，存在处理 $A$ 和中介变量 $M$ 之间交互作用的统计显著证据。\n\n#### (ii) 影响及 PNDE 和 PNIE 的计算\n\n在给定的建模假设和一致性假设（即 $Y=Y_A$ 和 $M=M_A$）下，潜在结局 $Y_{a,m}$ 的总体水平期望由回归方程给出，对误差分布取平均：\n$$\n\\mathbb{E}[Y_{a,m}] = \\beta_0 + \\beta_1 a + \\beta_2 m + \\beta_3 (a \\times m)\n$$\n类似地，处理水平为 $a$ 下的潜在中介变量 $M_a$ 的期望值可从中介变量模型推导得出：\n$$\n\\mathbb{E}[M_a] = \\mathbb{E}[\\alpha_0 + \\alpha_1 a + \\eta] = \\alpha_0 + \\alpha_1 a\n$$\n具体来说，对于 $a=0$ 和 $a=1$：\n$$\n\\mathbb{E}[M_0] = \\alpha_0\n$$\n$$\n\\mathbb{E}[M_1] = \\alpha_0 + \\alpha_1\n$$\n\n现在，我们使用它们的定义来推导 PNDE 和 PNIE 的表达式。\n\n**纯自然直接效应 (PNDE):**\n$$\n\\text{PNDE} = \\mathbb{E}[Y_{1,M_0} - Y_{0,M_0}]\n$$\n使用全期望定律，我们有 $\\mathbb{E}[Y_{a,M_b}] = \\mathbb{E}[\\mathbb{E}[Y_{a,M_b}|M_b]] = \\mathbb{E}[\\beta_0 + \\beta_1 a + \\beta_2 M_b + \\beta_3 (a \\times M_b)]$。\n$$\n\\text{PNDE} = \\mathbb{E}[\\beta_0 + \\beta_1(1) + \\beta_2 M_0 + \\beta_3(1 \\times M_0)] - \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_0 + \\beta_3(0 \\times M_0)]\n$$\n$$\n\\text{PNDE} = \\mathbb{E}[\\beta_0 + \\beta_1 + \\beta_2 M_0 + \\beta_3 M_0] - \\mathbb{E}[\\beta_0 + \\beta_2 M_0]\n$$\n根据期望的线性性质：\n$$\n\\text{PNDE} = (\\beta_0 + \\beta_1 + \\beta_2 \\mathbb{E}[M_0] + \\beta_3 \\mathbb{E}[M_0]) - (\\beta_0 + \\beta_2 \\mathbb{E}[M_0])\n$$\n$$\n\\text{PNDE} = \\beta_1 + \\beta_3 \\mathbb{E}[M_0]\n$$\n代入 $\\mathbb{E}[M_0] = \\alpha_0$:\n$$\n\\text{PNDE} = \\beta_1 + \\beta_3 \\alpha_0\n$$\n存在交互作用时（$\\beta_3 \\neq 0$），PNDE 取决于控制条件下中介变量的水平 $\\mathbb{E}[M_0]$。\n\n**纯自然间接效应 (PNIE):**\n$$\n\\text{PNIE} = \\mathbb{E}[Y_{0,M_1} - Y_{0,M_0}]\n$$\n$$\n\\text{PNIE} = \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_1 + \\beta_3(0 \\times M_1)] - \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_0 + \\beta_3(0 \\times M_0)]\n$$\n$$\n\\text{PNIE} = \\mathbb{E}[\\beta_0 + \\beta_2 M_1] - \\mathbb{E}[\\beta_0 + \\beta_2 M_0]\n$$\n根据期望的线性性质：\n$$\n\\text{PNIE} = (\\beta_0 + \\beta_2 \\mathbb{E}[M_1]) - (\\beta_0 + \\beta_2 \\mathbb{E}[M_0])\n$$\n$$\n\\text{PNIE} = \\beta_2 (\\mathbb{E}[M_1] - \\mathbb{E}[M_0])\n$$\n代入 $\\mathbb{E}[M_1] - \\mathbb{E}[M_0] = (\\alpha_0 + \\alpha_1) - \\alpha_0 = \\alpha_1$:\n$$\n\\text{PNIE} = \\beta_2 \\alpha_1\n$$\nPNIE 的表达式不涉及交互作用系数 $\\beta_3$。\n\n**数值计算：**\n使用给定的拟合值：$\\hat{\\alpha}_0 = 2.0$, $\\hat{\\alpha}_1 = -0.5$, $\\hat{\\beta}_1 = 1.2$, $\\hat{\\beta}_2 = 3.0$, $\\hat{\\beta}_3 = -0.8$。\n$$\n\\widehat{\\text{PNDE}} = \\hat{\\beta}_1 + \\hat{\\beta}_3 \\hat{\\alpha}_0 = 1.2 + (-0.8)(2.0) = 1.2 - 1.6 = -0.4\n$$\n$$\n\\widehat{\\text{PNIE}} = \\hat{\\beta}_2 \\hat{\\alpha}_1 = (3.0)(-0.5) = -1.5\n$$\n\n### 逐项分析选项\n\n**选项 A:**\n- **(i) 交互作用检验**：陈述使用 Wald 检验检验 $H_0: \\beta_3=0$，计算出 $z \\approx -2.29$ 且 $p \\approx 0.022$，并正确地得出存在交互作用的证据。这与我们的推导相符。\n- **(ii) 影响和数值**：陈述 PNDE 等于 $\\beta_1 + \\beta_3 \\mathbb{E}[M_0]$，PNIE 等于 $\\beta_2\\{\\mathbb{E}[M_1]-\\mathbb{E}[M_0]\\}$。这些表达式是正确的。然后正确地代入 $\\mathbb{E}[M_0]=\\alpha_0$ 和 $\\mathbb{E}[M_1]-\\mathbb{E}[M_0]=\\alpha_1$。它计算出的估计值为 PNDE $= -0.4$ 和 PNIE $= -1.5$。这些计算也是正确的。\n- **判断**：**正确**。\n\n**选项 B:**\n- **(i) 交互作用检验**：提议对 $H_0: \\beta_2=\\beta_3=0$ 进行联合检验。这并非单独检验交互作用的正确方法；它检验的是涉及中介路径的任何效应。它还基于对检验统计量的主观评估错误地得出无交互作用的结论。\n- **(ii) 影响和数值**：PNIE 的表达式 $\\alpha_1(\\beta_2+\\beta_3)$ 是不正确的；这是总自然间接效应 (TNIE) 的表达式。PNDE 的近似值 $\\beta_1$ 仅在 $\\beta_3 = 0$ 时有效，这与证据相悖。\n- **判断**：**不正确**。\n\n**选项 C:**\n- **(i) 交互作用检验**：提议使用似然比检验，这是一个有效的替代方法，并得出了与 Wald 检验一致的结论。这部分是合理的。\n- **(ii) 影响和数值**：声称在存在交互作用时 PNDE 和 PNIE 是不可识别的。这在根本上是错误的。如我们通过推导其模型参数表达式所示，这些效应在陈述的假设和模型结构下是明确定义且可识别的。\n- **判断**：**不正确**。\n\n**选项 D:**\n- **(i) 交互作用检验**：正确地识别了 Wald 检验并计算了 $z$-统计量。然而，它得出了错误的结论，因为 $|z|  2.58$ 而声称“在 $5\\%$ 的显著性水平上没有交互作用”。双侧 $5\\%$ 检验的临界值是 $z_{\\alpha/2} = 1.96$。由于 $|-2.29|  1.96$，原假设应该被拒绝。值 $2.58$ 对应于 $1\\%$ 的显著性水平。\n- **(ii) 影响和数值**：PNDE 的公式 $\\beta_1 + \\beta_3 \\mathbb{E}[M_1]$ 是错误的；它应该使用 $\\mathbb{E}[M_0]$。PNIE 的公式 $\\beta_2\\alpha_1 + \\beta_3\\alpha_1\\mathbb{E}[M_0]$ 也是错误的；它应该只是 $\\beta_2\\alpha_1$。\n- **判断**：**不正确**。\n\n基于全面的分析，只有选项 A 正确地执行了统计检验，解释了其含义，推导了存在交互作用时因果效应的正确表达式，并正确地计算了它们的值。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在估计了因果效应之后，下一个关键任务是量化其不确定性。本练习将探讨为何在小样本中，用于计算中介效应置信区间的标准正态近似方法可能不可靠，尤其是在效应的抽样分布存在偏态时。它将引导你思考并设计一个有效的自助法（bootstrap）程序来生成更准确的置信区间，从而完成从点估计到区间推断的完整分析流程。",
            "id": "4972590",
            "problem": "一项随机临床试验评估了一种新的抗炎疗法，治疗指标 $A \\in \\{0,1\\}$ 在基线时被分配。中介变量 $M$ 是在2周时测量的治疗后血清生物标志物，主要结局 $Y \\in \\{0,1\\}$ 是6个月时的缓解情况。基线协变量 $X$ 也被记录。分析师旨在标准因果识别条件下估计 $A$ 通过 $M$ 对 $Y$ 的自然直接效应（NDE）和自然间接效应（NIE）：一致性、正值性、以及序贯可忽略性（在给定 $X$ 的情况下，$A \\rightarrow M$ 和 $M \\rightarrow Y$ 没有未测量的混杂，且 $M \\rightarrow Y$ 路径没有暴露引起的混杂）。分析师为中介变量拟合了参数模型 $p(M \\mid A, X)$，为结局拟合了参数模型 $p(Y \\mid A, M, X)$，并使用基于模型预测、对 $X$ 的经验分布和中介模型进行积分的插件程序来估计NDE和NIE。样本量为 $n=120$，估计的效应存在中度偏态。\n\n根据自助法（bootstrap）的第一性原理以及估计的滋扰模型的非线性泛函的性质，选择所有正确概述了获取NDE和NIE置信区间的自助法程序，并正确论证了在小样本中优先使用它而非正态近似的选项。\n\nA. 个体水平的非参数自助法：通过从 $(Y, M, A, X)$ 的经验分布中有放回地重抽样 $n$ 名患者，来抽取 $B$ 个重复数据集；在每个重复样本 $b$ 中，使用自助样本重新拟合 $p(M \\mid A, X)$ 和 $p(Y \\mid A, M, X)$，使用应用于原始数据的相同程序重新计算插件估计值 $\\widehat{\\mathrm{NDE}}^{(b)}$ 和 $\\widehat{\\mathrm{NIE}}^{(b)}$，并基于 $\\{\\widehat{\\mathrm{NDE}}^{(b)}\\}_{b=1}^B$ 和 $\\{\\widehat{\\mathrm{NIE}}^{(b)}\\}_{b=1}^B$ 使用百分位数法或偏差校正和加速（BCa）法构建 $1-\\alpha$ 置信区间。理由：因为NDE和NIE是所估计的滋扰模型的非线性泛函，它们在小样本 $n$ 中的抽样分布可能存在偏态，自助法比正态近似能更好地捕捉到这一点。\n\nB. 仅对中介变量进行参数自助法：从拟合的 $p(M \\mid A, X)$ 中模拟 $B$ 个新的中介变量数据集 $\\{M^{(b)}\\}$，同时将结局模型 $p(Y \\mid A, M, X)$ 固定在其原始参数估计值上而不重新拟合；为每个 $b$ 重新计算 $\\widehat{\\mathrm{NDE}}^{(b)}$ 和 $\\widehat{\\mathrm{NIE}}^{(b)}$；然后使用围绕原始估计值的delta方法近似来构建正态置信区间。理由：固定结局模型能稳定自助法，并且正态近似是足够的。\n\nC. 对结局模型进行残差自助法：对于二元结局，从拟合的 $p(Y \\mid A, M, X)$ 的逻辑斯蒂回归中计算残差，重抽样这些残差并将其加到拟合的线性预测值上，以形成 $B$ 个 $Y$ 的伪数据集，同时保持 $M$、$A$ 和 $X$ 不变；在不重新拟合中介模型的情况下重新计算插件NDE和NIE；使用自助估计值的经验方差构建正态置信区间。理由：即使是二元结局，残差重抽样也能模拟抽样变异。\n\nD. 按治疗组进行分层非参数自助法：在 $A$ 的每个水平内，有放回地抽取 $n_0$ 和 $n_1$ 名患者以匹配原始计数，形成 $B$ 个保持随机化比例的重复数据集；在每个自助样本中，重新拟合 $p(M \\mid A, X)$ 和 $p(Y \\mid A, M, X)$，重新计算 $\\widehat{\\mathrm{NDE}}^{(b)}$ 和 $\\widehat{\\mathrm{NIE}}^{(b)}$，并使用水平为 $1-\\alpha$ 的BCa区间。理由：分层尊重了随机化设计，减少了治疗分配的蒙特卡洛变异性，并且BCa区间能够适应小样本中非线性效应泛函的偏差和偏态。\n\nE. 仅使用渐近正态置信区间：计算一次 $\\widehat{\\mathrm{NDE}}$ 和 $\\widehat{\\mathrm{NIE}}$，通过夹心估计量或用于系数乘积的Sobel delta方法推导它们的渐近方差，并假设正态性构建对称的 $1-\\alpha$ 区间。理由：中心极限定理确保了即使在 $n=120$ 时非线性映射也具有正态性，因此自助法是不必要的。\n\n选择所有适用选项。",
            "solution": "用户希望对问题陈述进行严格验证，然后提供详细的解决方案和对关于因果中介效应的自助置信区间的选项评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **研究设计：** 一项随机临床试验。\n- **治疗：** $A \\in \\{0,1\\}$，在基线时分配。\n- **中介变量：** $M$，在2周时测量的治疗后血清生物标志物。\n- **结局：** $Y \\in \\{0,1\\}$，在6个月时的缓解情况。\n- **协变量：** $X$，基线协变量。\n- **目标：** 估计 $A$ 通过 $M$ 对 $Y$ 的自然直接效应（NDE）和自然间接效应（NIE）。\n- **因果假设：** 一致性、正值性，以及序贯可忽略性（在给定 $X$ 的情况下，$A \\rightarrow M$ 和 $M \\rightarrow Y$ 没有未测量的混杂，且 $M \\rightarrow Y$ 路径没有暴露引起的混杂）。\n- **估计程序：**\n    1. 为中介变量拟合参数模型 $p(M \\mid A, X)$，为结局拟合参数模型 $p(Y \\mid A, M, X)$。\n    2. 使用插件程序，结合基于模型的预测以及对 $X$ 的经验分布和中介模型进行积分，以获得NDE和NIE的点估计。\n- **样本特征：** 样本量 $n=120$；估计的效应存在中度偏态。\n- **问题：** 选择所有正确概述了获取NDE和NIE置信区间的自助法程序，并论证了在小样本中优先使用它而非正态近似的选项。\n\n**步骤2：使用已知条件进行验证**\n- **科学基础：** 该问题描述了一个标准的因果中介分析，这是统计学及其在医学中应用的一个成熟领域。NDE和NIE的定义、识别假设（序贯可忽略性），以及使用基于参数模型的插件估计量都是该框架的标准且正确的组成部分。\n- **问题定义明确：** 问题定义明确。它要求评估用于为明确定义的统计量（NDE, NIE）构建置信区间的不同自助法程序。所提供的上下文足以确定每种提议方法的适当性。\n- **客观性：** 问题以统计学和生物统计学中常见的精确、客观和技术的语言陈述。提及“估计的效应存在中度偏态”是一个关键、客观的信息，它指导了推断程序的选择。\n\n**步骤3：结论与行动**\n问题陈述科学上合理、定义明确、客观且信息自足。没有矛盾、模糊或事实错误。因此，该问题是**有效的**。我们可以继续进行解答。\n\n### 推导与选项分析\n\n问题的核心在于为自然直接效应（NDE）和自然间接效应（NIE）获得有效的置信区间。在所述假设下，这些效应通过“中介公式”进行识别：\n$$E[Y(a, M(a'))] = \\int_x \\left( \\int_m E[Y \\mid A=a, M=m, X=x] \\, dP(M=m \\mid A=a', X=x) \\right) \\, dP(X=x)$$\n然后，NDE和NIE被定义为这些潜在结局均值的对比：\n$$\\mathrm{NDE} = E[Y(1, M(0))] - E[Y(0, M(0))]$$\n$$\\mathrm{NIE} = E[Y(1, M(1))] - E[Y(1, M(0))]$$\n问题陈述中提到使用了插件估计量。这意味着我们首先通过拟合模型来估计条件期望和概率：$\\hat{p}(Y \\mid A, M, X)$ 和 $\\hat{p}(M \\mid A, X)$。然后，我们用这些估计值和 $X$ 的经验分布分别替换真实的函数和分布，来计算 $\\widehat{\\mathrm{NDE}}$ 和 $\\widehat{\\mathrm{NIE}}$。对于大小为 $n$ 的样本，这看起来像：\n$$\\widehat{E}[Y(a, M(a'))] = \\frac{1}{n} \\sum_{i=1}^n \\left( \\int_m \\hat{p}(Y=1 \\mid A=a, M=m, X=X_i) \\, \\hat{p}(M=m \\mid A=a', X=X_i) \\, dm \\right)$$\n\n这些估计量 $\\widehat{\\mathrm{NDE}}$ 和 $\\widehat{\\mathrm{NIE}}$ 是两个拟合模型参数的复杂非线性函数。尽管在正则性条件下它们是渐近正态的（由于中心极限定理和Delta方法），但在有限样本中这种近似可能很差。问题指定样本量为 $n=120$，这是一个中小型样本，并明确指出“估计的效应存在中度偏态”。这表明 $\\widehat{\\mathrm{NDE}}$ 和 $\\widehat{\\mathrm{NIE}}$ 的抽样分布可能不是对称的，使得基于正态近似的置信区间（例如 $\\hat{\\theta} \\pm z_{1-\\alpha/2} \\times \\widehat{\\mathrm{SE}}$）在覆盖概率方面可能不准确。\n\n在这种情况下，自助法是获得置信区间的一个极好的替代方法。一个有效的自助法程序必须模拟完整的数据生成和估计过程，以捕获所有抽样不确定性的来源。在这种情况下，不确定性既来自于中介模型 $p(M \\mid A, X)$ 的估计，也来自于结局模型 $p(Y \\mid A, M, X)$ 的估计。\n\n**选项分析：**\n\n**A. 个体水平的非参数自助法...**\n- **程序：** 此选项描述了标准的非参数自助法。它涉及有放回地重抽样整个观测向量 $(Y_i, M_i, A_i, X_i)$。在每个自助法重复样本中，中介模型 $p(M \\mid A, X)$ 和结局模型 $p(Y \\mid A, M, X)$ 都从头开始重新估计。然后重新计算NDE和NIE。这个过程正确地模拟了原始的抽样和估计过程，从而捕获了全部的抽样变异性，包括来自拟合两个滋扰模型的那部分。\n- **置信区间构建：** 它建议使用百分位数法或BCa（偏差校正和加速）区间。两者都是标准的自助法置信区间方法。BCa方法特别擅长处理问题中提到的偏差和偏态，提供比简单百分位数法或基于正态近似的区间更好的性能。\n- **理由：** 理由正确地指出NDE和NIE是非线性泛函，它们的抽样分布在小样本（$n=120$）中可能存在偏态，而自助法在捕捉这种偏态方面优于正态近似。\n- **结论：** **正确**。这是一个针对复杂估计量的非参数自助法的教科书式应用。\n\n**B. 仅对中介变量进行参数自助法...**\n- **程序：** 这个程序是有缺陷的。它只从其拟合模型中重抽样中介变量 $M$，但关键的是，它将结局模型 $p(Y \\mid A, M, X)$ 固定。这未能考虑与估计结局模型参数相关的抽样不确定性。通过忽略一个变异来源，得到的置信区间会过窄，且覆盖率不足。\n- **置信区间构建：** 它建议使用正态置信区间，这否定了自助法的一个主要优点：无需假设正态性即可形成区间的能力。这与问题中观察到偏态的说法不一致。\n- **理由：** 理由薄弱且不正确。声称固定一个模型能“稳定”自助法并不能成为忽略不确定性来源的理由。声称正态近似是足够的，这与问题的前提相矛盾。\n- **结论：** **不正确**。\n\n**C. 对结局模型进行残差自助法...**\n- **程序：** 这个程序有两个主要缺陷。首先，将简单的残差自助法应用于来自逻辑斯蒂模型的二元结局 $Y \\in \\{0,1\\}$ 并不直接或有效。残差 $Y_i - \\hat{p}_i$ 并非来自一个共同的分布，简单地重抽样和相加并不能保证得到一个有效的二元结局。其次，与选项B一样，它未能重新拟合中介模型，从而忽略了其估计带来的不确定性。\n- **置信区间构建：** 它建议使用正态置信区间，这对于有偏态的分布来说是次优的。\n- **理由：** 声称“即使是二元结局，残差重抽样也能模拟抽样变异”对于所描述的简单程序是错误的。\n- **结论：** **不正确**。\n\n**D. 按治疗组进行分层非参数自助法...**\n- **程序：** 此选项提出了一个分层非参数自助法。由于治疗 $A$ 是在随机试验中分配的，每个组的个体数量（$n_0$ 和 $n_1$）是由研究设计固定的。简单的非参数重抽样（如A中）允许这些数字在自助样本之间变化。通过按治疗组分层重抽样（即，从对照组中有放回地抽样 $n_0$ 个，从治疗组中有放回地抽样 $n_1$ 个）尊重了治疗分配的固定设计特性。这是一个有效的改进，可以提高精度并更好地反映原始研究设计。程序的其余部分——重新拟合两个模型并重新计算效应——与选项A中的理由相同，是正确的。\n- **置信区间构建：** 它主张使用BCa区间，鉴于可能存在的偏差和偏态，这是最合适的选择。\n- **理由：** 理由非常好。它正确地指出，分层尊重了随机化设计，并且BCa区间能够适应小样本中非线性估计量已知的偏差和偏态问题。\n- **结论：** **正确**。对于随机试验的背景，这描述了一个比选项A更优越但本质上仍然正确的自助法程序。\n\n**E. 仅使用渐近正态置信区间...**\n- **程序：** 这描述了经典的“大样本”方法，使用Delta方法（或其稳健的夹心变体）。\n- **理由：** 理由是其关键的失败点。它声称中心极限定理“确保了”在 $n=120$ 时的正态性。这是一种误解。中心极限定理确保的是*当 $n \\to \\infty$* 时收敛到正态分布。对于 $n=120$ 的有限样本和复杂的非线性估计量，近似可能很差。问题陈述通过指出“估计的效应存在中度偏态”为反对这一假设提供了直接证据，使得基于正态分布的对称区间不适用。因此，宣称自助法“不必要”是错误的。\n- **结论：** **不正确**。\n\n综上所述，选项A和D都描述了有效且适当的自助法程序。对于随机试验的特定背景，选项D是A在方法论上更完善的改进。两者都是正确的选择。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}