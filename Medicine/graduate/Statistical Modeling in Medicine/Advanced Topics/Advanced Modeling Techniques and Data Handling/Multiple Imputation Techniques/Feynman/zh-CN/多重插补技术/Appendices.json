{
    "hands_on_practices": [
        {
            "introduction": "在处理缺失数据时，一个看似简单的方法是单次插补，即用一个“最佳”猜测值填补缺失。然而，这种方法存在一个根本性缺陷。本练习将通过一个具体案例，量化不当单次插补策略与其对应的“正确”多重插补策略在估计量方差上的差异，从而揭示为何必须考虑插补不确定性（即插补间方差）。",
            "id": "4976456",
            "problem": "一项针对高血压患者的临床试验测量了从基线到3个月时收缩压（SBP）的变化，记为 $Y_{i}$，其中 $i=1,\\dots,n$。假设结果模型为 $Y_{i} \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，基于先前的外部验证，已知残差方差为 $\\sigma^{2} = 100$ $\\mathrm{mmHg}^{2}$，并且一部分结果完全随机缺失（MCAR），且缺失与 $Y_{i}$ 独立。总样本量为 $n = 200$，其中有 $n_{\\mathrm{obs}} = 120$ 个观测结果和 $n_{\\mathrm{miss}} = 80$ 个缺失结果。\n\n考虑两种用于估计总体均值 $\\mu$ 的填补与分析策略：\n1. 不当单次填补：通过从 $\\mathcal{N}(\\bar{Y}_{\\mathrm{obs}}, \\sigma^{2})$ 中独立抽取每个缺失的 $Y_{i}$ 来执行单次填补，其中 $\\bar{Y}_{\\mathrm{obs}}$ 是观测结果的样本均值。将填补后的完整数据集视为完全观测数据进行分析，使用样本均值的完整数据方差公式，在已知残差方差的假设下，该公式为 $\\sigma^{2}/n$。\n2. 适当多重填补（MI）：执行 $m = 20$ 次填补。对于每次填补 $j$，从给定观测数据的后验分布中抽取 $\\mu^{(j)}$，然后从 $\\mathcal{N}(\\mu^{(j)}, \\sigma^{2})$ 中独立抽取每个缺失的 $Y_{i}$。以正确汇总填补内不确定性和填补间不确定性的方式，合并 $m$ 个完整数据集的点估计和方差。多重填补（MI）指的是通过重复填补并适当组合估计值以反映所有不确定性来源。\n\n使用基本概率定律和MCAR假设，推导在适当MI策略下 $\\mu$ 估计量的期望总方差，以及在不当单次填补策略下的期望方差。将不当策略相对于适当MI策略的偏差定义为 $\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]$。对于给定的 $n$、$n_{\\mathrm{obs}}$、$n_{\\mathrm{miss}}$、$\\sigma^{2}$ 和 $m$，数值计算该偏差。\n\n以 $\\mathrm{mmHg}^{2}$ 为单位表示最终偏差，并将答案四舍五入至四位有效数字。",
            "solution": "问题要求推导和计算不当单次填补方差估计量相对于适当多重填补（MI）方差估计量在估计总体均值 $\\mu$ 时的偏差。偏差定义为 $\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]$。\n\n首先，我们分析不当单次填补策略（策略1）。\n问题陈述，在单次填补后，将完整数据集视为完全观测数据进行分析，并且样本均值的方差采用已知残差方差下的完整数据方差公式，即 $\\sigma^{2}/n$。因此，该策略下的方差估计量是由给定参数决定的一个常数值：\n$$\n\\widehat{V}_{\\mathrm{improper}} = \\frac{\\sigma^{2}}{n}\n$$\n常数的期望就是其本身。因此，不当策略下的期望方差是：\n$$\n\\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] = \\frac{\\sigma^{2}}{n}\n$$\n\n接下来，我们分析适当多重填补策略（策略2）。\n$\\mu$ 的MI估计量的总方差使用鲁宾法则（Rubin's rules）进行估计。总方差 $\\widehat{V}_{\\mathrm{proper}}$ 的公式是填补内方差 $W$ 与填补间方差 $B$ 的和，并根据有限的填补次数 $m$ 进行调整：\n$$\n\\widehat{V}_{\\mathrm{proper}} = W + \\left(1 + \\frac{1}{m}\\right)B\n$$\n我们需要求出这个估计量的期望，$\\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}] = \\mathbb{E}[W] + \\left(1 + \\frac{1}{m}\\right)\\mathbb{E}[B]$。\n\n填补内方差 $W$ 是来自 $m$ 个完整数据集的方差估计值的平均值。对于每个完整数据集 $j$，均值 $\\hat{\\mu}^{(j)}$ 的方差估计值为 $\\widehat{V}^{(j)}$。由于数据被视为完整的，且残差方差 $\\sigma^2$ 已知，该方差为 $\\widehat{V}^{(j)} = \\sigma^2/n$。对于所有的 $j=1, \\dots, m$，这个值是相同的。\n$$\nW = \\frac{1}{m}\\sum_{j=1}^{m} \\widehat{V}^{(j)} = \\frac{1}{m}\\sum_{j=1}^{m} \\frac{\\sigma^{2}}{n} = \\frac{\\sigma^{2}}{n}\n$$\n由于 $W$ 是一个常数，其期望为 $\\mathbb{E}[W] = \\sigma^2/n$。\n\n填补间方差 $B$ 是 $m$ 次填补中 $\\mu$ 的点估计值的样本方差：\n$$\nB = \\frac{1}{m-1}\\sum_{j=1}^{m} (\\hat{\\mu}^{(j)} - \\bar{\\mu}_{\\mathrm{MI}})^{2}\n$$\n其中 $\\hat{\\mu}^{(j)}$ 是第 $j$ 个填补数据集的样本均值，而 $\\bar{\\mu}_{\\mathrm{MI}} = \\frac{1}{m}\\sum_{j=1}^{m} \\hat{\\mu}^{(j)}$。\n$B$ 是真实填补间方差的无偏估计量，该方差的产生是因为缺失数据是从一个反映真实参数不确定性的分布中填补的。令这个真实方差为 $B_{\\mathrm{true}}$。因此，$\\mathbb{E}[B] = B_{\\mathrm{true}}$。\n在MI底层的贝叶斯框架中，给定观测数据 $Y_{\\mathrm{obs}}$，参数 $\\mu$ 的总方差为 $T = \\text{Var}(\\mu|Y_{\\mathrm{obs}})$。这个总方差可以分解为完整数据方差 $U = \\text{Var}(\\mu|Y_{\\mathrm{obs}}, Y_{\\mathrm{miss}})$ 和由缺失数据引起的方差 $B_{\\mathrm{true}}$。即 $T = U + B_{\\mathrm{true}}$。在对 $\\mu$ 使用无信息先验且 $\\sigma^2$ 已知的假设下：\n完整数据的后验方差（即我们拥有大小为 $n$ 的完整数据集时会得到的方差）是 $U = \\sigma^2/n$。\n仅基于观测数据（大小为 $n_{\\mathrm{obs}}$）的后验方差是 $T = \\sigma^2/n_{\\mathrm{obs}}$。\n因此，真实的填补间方差是：\n$$\nB_{\\mathrm{true}} = T - U = \\frac{\\sigma^{2}}{n_{\\mathrm{obs}}} - \\frac{\\sigma^{2}}{n} = \\sigma^{2}\\left(\\frac{1}{n_{\\mathrm{obs}}} - \\frac{1}{n}\\right) = \\sigma^{2}\\frac{n - n_{\\mathrm{obs}}}{n \\cdot n_{\\mathrm{obs}}} = \\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n由于 $\\mathbb{E}[B] = B_{\\mathrm{true}}$，我们有：\n$$\n\\mathbb{E}[B] = \\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n现在我们可以计算适当MI策略的期望总方差：\n$$\n\\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}] = \\mathbb{E}[W] + \\left(1 + \\frac{1}{m}\\right)\\mathbb{E}[B] = \\frac{\\sigma^{2}}{n} + \\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n\n有了两种策略的期望方差，我们就可以计算偏差：\n$$\n\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]\n$$\n$$\n\\mathrm{Bias} = \\frac{\\sigma^{2}}{n} - \\left[\\frac{\\sigma^{2}}{n} + \\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\\right]\n$$\n$$\n\\mathrm{Bias} = -\\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n负号表示不当单次填补策略系统性地低估了方差。\n\n现在，我们代入给定的数值：\n$n = 200$，$n_{\\mathrm{obs}} = 120$，$n_{\\mathrm{miss}} = 80$，$\\sigma^{2} = 100$，以及 $m=20$。\n$$\n\\mathrm{Bias} = -\\left(1 + \\frac{1}{20}\\right) \\times 100 \\times \\frac{80}{200 \\times 120}\n$$\n$$\n\\mathrm{Bias} = -\\left(\\frac{21}{20}\\right) \\times 100 \\times \\frac{80}{24000}\n$$\n$$\n\\mathrm{Bias} = -1.05 \\times 100 \\times \\frac{1}{300}\n$$\n$$\n\\mathrm{Bias} = -1.05 \\times \\frac{100}{300} = -1.05 \\times \\frac{1}{3}\n$$\n$$\n\\mathrm{Bias} = -0.35\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\mathrm{Bias} = -0.3500 \\, \\mathrm{mmHg}^{2}\n$$",
            "answer": "$$\\boxed{-0.3500}$$"
        },
        {
            "introduction": "我们已经知道，正确地量化不确定性是多重插补的核心。接下来自然而然的问题是：我们应该如何构建插补模型本身？本练习通过一个假设的随机对照试验场景，揭示了一个核心原则：“插补模型必须与分析模型相容”。我们将精确计算当这一原则被违背时（例如，在插补模型中忽略了关键的治疗变量），对处理效应估计所造成的偏差。",
            "id": "4976459",
            "problem": "一项心血管医学领域的随机对照试验研究了一种抗高血压治疗对收缩压的影响。令 $T \\in \\{0,1\\}$ 表示治疗分配，其中 $\\Pr(T=1)=1/2$；令 $X \\in \\mathbb{R}$ 表示一个基线协变量（例如，基线风险评分），其中 $X \\sim \\mathcal{N}(0,\\sigma_{X}^{2})$，且与 $T$ 独立。连续结果由一个线性高斯数据生成过程建模\n$$\nY \\;=\\; \\alpha \\;+\\; \\tau\\, T \\;+\\; \\beta\\, X \\;+\\; \\varepsilon,\\qquad \\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2}),\\quad \\varepsilon \\perp (X,T).\n$$\n结果存在缺失情况，由 $R \\in \\{0,1\\}$ 指示，其中 $R=1$ 表示 $Y$ 被观测到。缺失机制是随机缺失（MAR），其形式为\n$$\n\\Pr(R=1 \\mid X,T,Y) \\;=\\; s(X),\n$$\n其中 $s$ 是某个可测函数，满足 $0  s(X)  1$，并且在给定 $X$ 的条件下，$s(X)$ 不依赖于 $T$ 或 $Y$。由于随机化以及MAR机制仅依赖于 $X$，两组的边际缺失率是相同的；令\n$$\nr \\;=\\; \\Pr(R=0 \\mid T=1) \\;=\\; \\Pr(R=0 \\mid T=0) \\;=\\; 1 - \\mathbb{E}\\big[s(X)\\big].\n$$\n一位分析师执行了多重插补（MI），但使用了一个设定错误的插补模型，该模型忽略了治疗指示变量。具体来说，对于每次插补，分析师仅使用观测案例（$R=1$），合并两个治疗组，拟合一个 $Y$ 对 $X$ 的线性回归，并从一个均值为 $a + b X$、方差由观测数据估计（用于插补的确切方差是任意但有限且为正的）的正态分布中抽样来插补缺失的 $Y$ 值。在创建了多次插补并补全数据后，分析师通过补全数据后各组均值的未经调整的差异来估计治疗效应，并在多次插补中对该点估计值取平均。\n\n仅使用随机缺失（Missing At Random）的基本定义、全期望定律以及多重插补点估计量为补全数据估计量之平均的定义，推导该 MI 治疗效应点估计的大样本极限，并计算其相对于真实值 $\\tau$ 的渐近偏差。将最终答案表示为关于 $\\tau$ 和 $r$ 的单个闭式解析表达式。不要提供方差分量的推导。不要代入数字。最终答案必须是单个无单位的表达式。",
            "solution": "用户希望在插补模型设定错误时，找到治疗效应的多重插补（MI）估计量的渐近偏差。\n\n### 1. 准备工作与定义\n\n真实的数据生成过程由以下线性模型给出：\n$$\nY \\;=\\; \\alpha \\;+\\; \\tau\\, T \\;+\\; \\beta\\, X \\;+\\; \\varepsilon\n$$\n其中 $T \\in \\{0,1\\}$ 且 $\\Pr(T=1) = 1/2$， $X \\sim \\mathcal{N}(0, \\sigma_X^2)$，以及 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。我们已知 $X \\perp T$ 且 $\\varepsilon \\perp (X,T)$。\n\n真实的平均治疗效应 $\\tau$ 是治疗组和对照组下期望结果的差异：\n$$\n\\text{ATE} \\;=\\; \\mathbb{E}[Y \\mid T=1] - \\mathbb{E}[Y \\mid T=0]\n$$\n利用期望的线性性质以及 $\\mathbb{E}[X \\mid T=t] = \\mathbb{E}[X] = 0$（由于 $X \\perp T$）这一事实：\n$$\n\\mathbb{E}[Y \\mid T=t] \\;=\\; \\mathbb{E}[\\alpha + \\tau t + \\beta X + \\varepsilon \\mid T=t] \\;=\\; \\alpha + \\tau t + \\beta \\mathbb{E}[X] \\;=\\; \\alpha + \\tau t\n$$\n因此，真实的治疗效应为：\n$$\n\\tau \\;=\\; (\\alpha + \\tau) - \\alpha \\;=\\; \\tau\n$$\n\n治疗效应的 MI 点估计量 $\\hat{\\tau}_{MI}$ 是补全数据估计量的平均值。在大样本极限下（当受试者数量和插补次数趋于无穷大时），该估计量收敛于：\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=1] - \\mathbb{E}[Y_{\\text{comp}} \\mid T=0]\n$$\n其中 $Y_{\\text{comp}}$ 是一个随机变量，代表补全后数据集中的一个值。\n\n根据定义，如果结果被观测到（$R=1$），则 $Y_{\\text{comp}} = Y$；如果结果缺失（$R=0$），则 $Y_{\\text{comp}} = Y_{\\text{imp}}$，其中 $Y_{\\text{imp}}$ 是插补值。\n\n### 2. 补全数据的大样本期望\n\n我们可以利用全期望定律，以缺失指示变量 $R$ 为条件，来表示每个治疗组中补全数据的期望值：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=t, R=1]\\Pr(R=1 \\mid T=t) \\;+\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=t, R=0]\\Pr(R=0 \\mid T=t)\n$$\n我们已知边际缺失概率为 $r = \\Pr(R=0 \\mid T=t)$，所以 $\\Pr(R=1 \\mid T=t) = 1-r$。\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)\\mathbb{E}[Y \\mid T=t, R=1] \\;+\\; r\\mathbb{E}[Y_{\\text{imp}} \\mid T=t, R=0]\n$$\n\n### 3. 刻画插补模型\n\n分析师通过仅使用两个治疗组合并后的观测案例（$R=1$），将 $Y$ 对 $X$ 进行回归，从而使用了一个设定错误的插补模型。插补值是从一个分布中抽取的，其均值由该回归模型给出。在大样本极限下，此回归的系数收敛到条件期望 $\\mathbb{E}[Y \\mid X, R=1]$ 的总体参数。\n\n缺失机制是形式为 $\\Pr(R=1 \\mid X,T,Y) = s(X)$ 的随机缺失（MAR），这意味着在给定 $X$ 的条件下，缺失与 $Y$ 和 $T$ 独立。这蕴含着：\n$$\n\\mathbb{E}[Y \\mid X, R=1] \\;=\\; \\mathbb{E}[Y \\mid X]\n$$\n我们通过对治疗分配 $T$ 取平均来计算 $\\mathbb{E}[Y \\mid X]$：\n$$\n\\mathbb{E}[Y \\mid X] \\;=\\; \\mathbb{E}[\\alpha + \\tau T + \\beta X + \\varepsilon \\mid X] \\;=\\; \\alpha + \\tau \\mathbb{E}[T \\mid X] + \\beta X + \\mathbb{E}[\\varepsilon \\mid X]\n$$\n由于 $T \\perp X$ 和 $\\varepsilon \\perp X$，且 $\\mathbb{E}[T] = 1/2$，上式简化为：\n$$\n\\mathbb{E}[Y \\mid X] \\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta X\n$$\n这就是分析师的插补模型的大样本极限。因此，一个插补结果在给定 $X$ 条件下的期望值为：\n$$\n\\mathbb{E}[Y_{\\text{imp}} \\mid X] \\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta X\n$$\n这个期望值不依赖于治疗分配 $T$，因为 $T$ 在插补模型中被忽略了。\n\n### 4. 计算补全数据后各组的均值\n\n现在我们可以计算表达式 $\\mathbb{E}[Y_{\\text{comp}} \\mid T=t]$ 中的各项。\n\n对于观测部分：\n$$\n\\mathbb{E}[Y \\mid T=t, R=1] \\;=\\; \\mathbb{E}[\\alpha + \\tau T + \\beta X + \\varepsilon \\mid T=t, R=1] \\;=\\; \\alpha + \\tau t + \\beta \\mathbb{E}[X \\mid T=t, R=1]\n$$\n对于插补部分：\n$$\n\\mathbb{E}[Y_{\\text{imp}} \\mid T=t, R=0] \\;=\\; \\mathbb{E}[\\mathbb{E}[Y_{\\text{imp}} \\mid X] \\mid T=t, R=0] \\;=\\; \\mathbb{E}\\left[\\alpha + \\frac{\\tau}{2} + \\beta X \\mid T=t, R=0\\right]\n$$\n$$\n\\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta \\mathbb{E}[X \\mid T=t, R=0]\n$$\n将这些代回到 $\\mathbb{E}[Y_{\\text{comp}} \\mid T=t]$ 的表达式中：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)(\\alpha + \\tau t + \\beta \\mathbb{E}[X \\mid T=t, R=1]) \\;+\\; r\\left(\\alpha + \\frac{\\tau}{2} + \\beta \\mathbb{E}[X \\mid T=t, R=0]\\right)\n$$\n合并同类项：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)\\alpha + r\\alpha \\;+\\; (1-r)\\tau t + r\\frac{\\tau}{2} \\;+\\; \\beta \\left( (1-r)\\mathbb{E}[X \\mid T=t, R=1] + r\\mathbb{E}[X \\mid T=t, R=0] \\right)\n$$\n乘以 $\\beta$ 的括号中的项是全期望定律在 $\\mathbb{E}[X \\mid T=t]$ 上的应用：\n$$\n(1-r)\\mathbb{E}[X \\mid T=t, R=1] + r\\mathbb{E}[X \\mid T=t, R=0] \\;=\\; \\mathbb{E}[X \\mid T=t]\n$$\n由于 $X \\perp T$，我们有 $\\mathbb{E}[X \\mid T=t]=\\mathbb{E}[X]=0$。因此，包含 $\\beta$ 的整个项为零。\n补全数据均值的表达式简化为：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; \\alpha + (1-r)\\tau t + \\frac{r\\tau}{2}\n$$\n\n现在，我们为治疗组（$t=1$）和对照组（$t=0$）计算该值：\n对于 $T=1$：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=1] \\;=\\; \\alpha + (1-r)\\tau + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\tau - r\\tau + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\tau\\left(1-\\frac{r}{2}\\right)\n$$\n对于 $T=0$：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=0] \\;=\\; \\alpha + (1-r)\\tau(0) + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\frac{r\\tau}{2}\n$$\n\n### 5. 计算偏差\n\nMI 估计量的大样本极限是这两个期望值之差：\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=1] - \\mathbb{E}[Y_{\\text{comp}} \\mid T=0]\n$$\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\left[ \\alpha + \\tau\\left(1-\\frac{r}{2}\\right) \\right] - \\left[ \\alpha + \\frac{r\\tau}{2} \\right] \\;=\\; \\tau - \\frac{r\\tau}{2} - \\frac{r\\tau}{2} \\;=\\; \\tau - r\\tau \\;=\\; \\tau(1-r)\n$$\n渐近偏差是估计量的大样本极限与真实参数 $\\tau$ 之间的差值：\n$$\n\\text{Bias} \\;=\\; \\hat{\\tau}_{MI}^{\\infty} - \\tau \\;=\\; \\tau(1-r) - \\tau \\;=\\; -\\tau r\n$$\n这个结果表明，从插补模型中忽略一个既是结果的预测变量又与治疗相关的变量（在本例中是治疗指示变量 $T$ 本身），会导致一个与真实效应量 $\\tau$ 和缺失数据比例 $r$ 成正比的偏差。该偏差是趋向于零的，因为插补过程将两组的均值拉向了总均值。",
            "answer": "$$\\boxed{-r\\tau}$$"
        },
        {
            "introduction": "在遵循了多重插补的原则并构建了相容的插补模型后，我们如何确信插补结果的质量？最后这个练习将介绍“过度插补”（over-imputation），一种强大的模型诊断技术。我们将探讨如何利用已观测数据来检验我们的插补模型是否经过良好校准，这是在信任并使用那些为真正缺失值生成的插补值之前，一个至关重要的验证步骤。",
            "id": "4976530",
            "problem": "在一个纵向高血压登记研究中，令 $Y$ 表示在基线时测量的收缩压（单位：$\\mathrm{mmHg}$），令 $X$ 表示患者协变量（年龄、性别、身体质量指数、抗高血压药物类别指示变量）的向量。部分 $Y$ 值缺失。您在 $Y \\mid X$ 的贝叶斯正态线性回归模型下，采用多重插补 (MI) 和模糊先验，通过马尔可夫链蒙特卡洛 (MCMC) 方法抽取插补值。为了评估插补模型是否为 $Y$ 提供了良好校准的预测，您考虑一种过度插补诊断方法，该方法将观测到的 $Y$ 值暂时视为缺失，并将其与后验预测分布进行比较。\n\n从以下第一性原理出发：\n\n- 对于一个未观测到的 $Y_i$，给定 $(Y_{-i}, X)$ 的后验预测分布 (PPD) 为\n$$\np(y_i \\mid Y_{-i}, X) \\;=\\; \\int p(y_i \\mid X_i, \\theta)\\, p(\\theta \\mid Y_{-i}, X)\\, d\\theta,\n$$\n其中 $\\theta$ 表示模型参数，$Y_{-i}$ 表示除 $Y_i$ 外所有观测到的 $Y$ 值。\n\n- 在模型设定正确以及缺失条件适当（例如，为保证插补模型的有效性，数据为随机缺失 (MAR)）的情况下，后验预测校准意味着当将真实观测值与其 PPD 进行比较时，经过适当标准化的差异具有由 PPD 决定的参考行为（例如，标准化残差近似于标准正态分布，或者概率积分变换近似于均匀分布）。\n\n您希望构建一个具体、可实施的过度插补诊断方法，并在模型设定正确的条件下指定其参考行为。下列哪个程序正确地实施了这种诊断方法并陈述了正确的参考行为？选择所有适用项。\n\nA. 对于每个观测到的 $i$，将 $Y_i$ 暂时设为缺失，并在以 $(Y_{-i}, X)$ 为条件的插补步骤中重新拟合或更新模型，然后使用插补引擎从 PPD 中抽取 $M$ 个过度插补值 $\\{Y_i^{(m)}\\}_{m=1}^M$。计算预测均值 $\\hat{\\mu}_i = M^{-1}\\sum_{m=1}^M Y_i^{(m)}$、预测方差 $\\hat{V}_i = (M-1)^{-1}\\sum_{m=1}^M \\left(Y_i^{(m)} - \\hat{\\mu}_i\\right)^2$ 和标准化残差 $r_i = \\left(Y_i^{\\mathrm{obs}} - \\hat{\\mu}_i\\right)/\\sqrt{\\hat{V}_i}$。在模型设定正确且 $M$ 足够大的情况下，集合 $\\{r_i\\}$ 近似服从 $\\mathcal{N}(0,1)$ 分布，并且对于观测到的 $i$，名义 $95\\%$ PPD 区间 $\\left[\\hat{\\mu}_i \\pm z_{0.975}\\sqrt{\\hat{V}_i}\\right]$ 的经验覆盖率近似为 $95\\%$。\n\nB. 对于每个观测到的 $i$，使用包含 $Y_i$ 的完整数据拟合一次插补模型，从该拟合中获取条件均值 $\\hat{\\mu}_i = \\mathbb{E}(Y_i \\mid X_i, \\hat{\\theta})$ 和条件方差 $\\hat{\\sigma}^2$，并计算 $r_i = \\left(Y_i^{\\mathrm{obs}} - \\hat{\\mu}_i\\right)/\\hat{\\sigma}$。在模型设定正确的条件下，无论 $M$ 取何值，$\\{r_i\\}$ 都精确服从 $\\mathcal{N}(0,1)$ 分布。\n\nC. 对于每个观测到的 $i$，将 $Y_i$ 暂时设为缺失，从给定 $(Y_{-i}, X)$ 的 PPD 中抽取 $M$ 个过度插补值 $\\{Y_i^{(m)}\\}_{m=1}^M$，并计算蒙特卡洛概率积分变换 $\\hat{p}_i = M^{-1}\\sum_{m=1}^M \\mathbb{I}\\!\\left\\{ Y_i^{(m)} \\le Y_i^{\\mathrm{obs}}\\right\\}$。在模型设定正确且 $M$ 足够大的情况下，$\\{\\hat{p}_i\\}$ 近似服从 $\\mathrm{Unif}(0,1)$ 分布；偏离均匀分布的情况表明存在校准不良（例如，U 形表示离散不足，驼峰形表示离散过度）。\n\nD. 将观测数据分为 $K$ 折，在 $K$ 折交叉验证中，使用完整案例对 $Y$ 关于 $X$ 进行频率派线性回归拟合，计算交叉验证残差 $r_i^{\\mathrm{cv}}$，并评估 $\\{r_i^{\\mathrm{cv}}\\}$ 是否近似服从 $\\mathcal{N}(0,1)$ 分布。如果是，则 MI 插补模型是良好校准的。\n\nE. 因为它只使用观测到的结果，即使数据是非随机缺失 (MNAR)，过度插补仍然是插补偏差和校准的有效诊断方法；因此，如果过度插补诊断通过，那么在 MNAR 条件下，对未观测值的插补必然是无偏的。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于标准统计理论，问题提出得当，客观，并包含足够的信息来推导出解决方案。\n\n核心任务是使用过度插补诊断来评估用于缺失收缩压 ($Y$) 的贝叶斯插补模型的校准情况。这种诊断是后验预测检验的一种形式。对于每个观测值 $Y_i^{\\mathrm{obs}}$，我们暂时将其视为缺失，并生成其后验预测分布 (PPD)，即 $p(y_i \\mid Y_{-i}, X)$。然后我们检查观测值 $Y_i^{\\mathrm{obs}}$ 是否是该分布的一个合理抽样。\n\nPPD 定义为 $p(y_i \\mid Y_{-i}, X) = \\int p(y_i \\mid X_i, \\theta)\\, p(\\theta \\mid Y_{-i}, X)\\, d\\theta$，它正确地包含了两个不确定性来源：\n1. 在给定参数 $\\theta$ 的情况下 $Y_i$ 的抽样不确定性，由 $p(y_i \\mid X_i, \\theta)$ 描述。\n2. 参数 $\\theta$ 的不确定性，由后验分布 $p(\\theta \\mid Y_{-i}, X)$ 描述，该后验分布以所有其他观测数据为条件。\n\n为了实施此检验，对于每个观测到的 $Y_i^{\\mathrm{obs}}$，我们从 PPD 中抽取一个大小为 $M$ 的大样本 $\\{Y_i^{(m)}\\}_{m=1}^M$。这是通过首先从后验分布 $p(\\theta \\mid Y_{-i}, X)$ 中抽取一个参数向量 $\\theta^{(m)}$，然后从数据分布 $p(y_i \\mid X_i, \\theta^{(m)})$ 中抽取 $Y_i^{(m)}$ 来实现的。这个过程重复 $M$ 次。\n\n如果插补模型校准良好，观测值集合 $\\{Y_i^{\\mathrm{obs}}\\}$ 的行为应如同从它们各自的 PPD 中抽取的随机样本。有几种方法可以检验此属性。\n\n现在，我们评估每个选项：\n\n**A. 对于每个观测到的 $i$，将 $Y_i$ 暂时设为缺失，并在以 $(Y_{-i}, X)$ 为条件的插补步骤中重新拟合或更新模型，然后使用插补引擎从 PPD 中抽取 $M$ 个过度插补值 $\\{Y_i^{(m)}\\}_{m=1}^M$。计算预测均值 $\\hat{\\mu}_i = M^{-1}\\sum_{m=1}^M Y_i^{(m)}$、预测方差 $\\hat{V}_i = (M-1)^{-1}\\sum_{m=1}^M \\left(Y_i^{(m)} - \\hat{\\mu}_i\\right)^2$ 和标准化残差 $r_i = \\left(Y_i^{\\mathrm{obs}} - \\hat{\\mu}_i\\right)/\\sqrt{\\hat{V}_i}$。在模型设定正确且 $M$ 足够大的情况下，集合 $\\{r_i\\}$ 近似服从 $\\mathcal{N}(0,1)$ 分布，并且对于观测到的 $i$，名义 $95\\%$ PPD 区间 $\\left[\\hat{\\mu}_i \\pm z_{0.975}\\sqrt{\\hat{V}_i}\\right]$ 的经验覆盖率近似为 $95\\%$。**\n\n此程序正确地描述了后验预测检验。\n- 以 $(Y_{-i}, X)$ 为条件并抽取 $\\{Y_i^{(m)}\\}$ 的过程正确地从留一法 PPD 中生成了样本。\n- 蒙特卡洛估计 $\\hat{\\mu}_i$ 和 $\\hat{V}_i$ 分别是 PPD 均值 $\\mathbb{E}(Y_i \\mid Y_{-i}, X)$ 和方差 $\\mathbb{Var}(Y_i \\mid Y_{-i}, X)$ 的正确估计量。方差 $\\hat{V}_i$ 正确地捕捉了总预测不确定性。\n- 标准化残差 $r_i$ 的构造是正确的。如果模型正确，这些残差的均值应约为 0，方差应约为 1。对于使用模糊先验的正态线性模型，PPD 的分布是学生 t 分布，当用于后验的样本量很大时，该分布可以很好地用标准正态分布 $\\mathcal{N}(0,1)$ 近似。\n- 检查预测区间的覆盖率是校准的基本定义。如果模型校准良好，其 $95\\%$ 的预测区间应该在 $95\\%$ 的时间内包含真实值。使用正态近似来构造区间是一种常见做法。\n因此，此选项描述了一种有效且标准的诊断程序。\n**结论：正确。**\n\n**B. 对于每个观测到的 $i$，使用包含 $Y_i$ 的完整数据拟合一次插补模型，从该拟合中获取条件均值 $\\hat{\\mu}_i = \\mathbb{E}(Y_i \\mid X_i, \\hat{\\theta})$ 和条件方差 $\\hat{\\sigma}^2$，并计算 $r_i = \\left(Y_i^{\\mathrm{obs}} - \\hat{\\mu}_i\\right)/\\hat{\\sigma}$。在模型设定正确的条件下，无论 $M$ 取何值，$\\{r_i\\}$ 都精确服从 $\\mathcal{N}(0,1)$ 分布。**\n\n此程序因几个原因存在缺陷。\n- 这是样本内检验，而不是预测性检验。它使用观测值 $Y_i$ 来拟合模型（即获取 $\\hat{\\theta}$），然后计算其自身的残差。这引入了一种“自我实现的预言”，导致残差比应有的要小，从而对模型拟合度给出了过于乐观的评估。\n- 它未能考虑参数不确定性。所使用的方差只是 $\\hat{\\sigma}^2$，即残差方差的估计值。真实的预测方差还必须包括回归系数 $\\beta$ 的不确定性。完整的 PPD 方差是 $\\mathbb{Var}(Y_i \\mid Y_{-i}, X) = \\mathbb{E}[\\sigma^2 \\mid Y_{-i}, X] + \\mathbb{Var}(X_i^T\\beta \\mid Y_{-i}, X)$。此选项忽略了第二项。\n- 声称残差*精确*服从 $\\mathcal{N}(0,1)$ 分布是错误的。即使在理想条件下，线性模型中的标准化残差也不具备此属性，这是由于参数估计引起的相互关系以及观测值的不同杠杆率所致。\n**结论：不正确。**\n\n**C. 对于每个观测到的 $i$，将 $Y_i$ 暂时设为缺失，从给定 $(Y_{-i}, X)$ 的 PPD 中抽取 $M$ 个过度插补值 $\\{Y_i^{(m)}\\}_{m=1}^M$，并计算蒙特卡洛概率积分变换 $\\hat{p}_i = M^{-1}\\sum_{m=1}^M \\mathbb{I}\\!\\left\\{ Y_i^{(m)} \\le Y_i^{\\mathrm{obs}}\\right\\}$。在模型设定正确且 $M$ 足够大的情况下，$\\{\\hat{p}_i\\}$ 近似服从 $\\mathrm{Unif}(0,1)$ 分布；偏离均匀分布的情况表明存在校准不良（例如，U 形表示离散不足，驼峰形表示离散过度）。**\n\n此程序正确地描述了使用概率积分变换 (PIT) 的后验预测检验。\n- 其设置是有效的留一法 PPD 生成，与选项 A 相同。\n- 量 $\\hat{p}_i$ 是在观测点 $Y_i^{\\mathrm{obs}}$ 处评估的 PPD 累积分布函数 (CDF) 的经验（蒙特卡洛）估计，即 $\\hat{p}_i \\approx P(Y_i \\le Y_i^{\\mathrm{obs}} \\mid Y_{-i}, X)$。\n- 概率论的一个基本定理指出，如果随机变量 $Z$ 是从具有 CDF $F$ 的连续分布中抽取的，则 $F(Z)$ 服从 $[0,1]$ 上的均匀分布。因此，如果模型校准良好（即 $Y_i^{\\mathrm{obs}}$ 是从 PPD 中抽取的），则 PIT 值集合 $\\{\\hat{p}_i\\}$ 应近似均匀分布。\n- 对偏离均匀分布的解释（U 形表示离散不足/过度自信，驼峰形表示离散过度/信心不足）是标准且正确的。\n这是一种功能强大且广泛使用的校准诊断方法。\n**结论：正确。**\n\n**D. 将观测数据分为 $K$ 折，在 $K$ 折交叉验证中，使用完整案例对 $Y$ 关于 $X$ 进行频率派线性回归拟合，计算交叉验证残差 $r_i^{\\mathrm{cv}}$，并评估 $\\{r_i^{\\mathrm{cv}}\\}$ 是否近似服从 $\\mathcal{N}(0,1)$ 分布。如果是，则 MI 插补模型是良好校准的。**\n\n此程序并非对指定的插补模型的直接诊断。\n- 它建议使用*频率派*模型，而插补模型是*贝叶斯*模型。这是不同的推断范式。贝叶斯模型通过后验分布来解释参数不确定性，而频率派模型使用点估计。\n- 它只使用*完整案例*。MI 模型是使用所有可用数据拟合的，这是插补的一个主要优点。仅基于没有缺失值的数据子集的诊断可能不具代表性，并且未能在其预期的环境中测试模型。\n- 虽然交叉验证是一种有效的技术，但将其应用于数据子集上的不同模型，并不能直接评估原始贝叶斯插补模型的校准情况。\n**结论：不正确。**\n\n**E. 因为它只使用观测到的结果，即使数据是非随机缺失 (MNAR)，过度插补仍然是插补偏差和校准的有效诊断方法；因此，如果过度插补诊断通过，那么在 MNAR 条件下，对未观测值的插补必然是无偏的。**\n\n这一陈述存在严重缺陷。\n- 指定的插补模型 $p(Y \\mid X)$ 依赖于随机缺失 (MAR) 假设。该假设指出，在给定观测协变量 $X$ 的条件下，$Y$ 缺失的概率与 $Y$ 的值无关。\n- 过度插补诊断通过将其预测与*观测*数据进行比较来检查模型的校准情况。它从根本上无法获取关于真正缺失值的缺失数据机制的信息。\n- 如果数据是非随机缺失 (MNAR)，这意味着即使在以 $X$ 为条件后，缺失值的分布也与观测值的分布不同。例如，血压 ($Y$) 非常高的患者可能更有可能出现数据缺失。\n- 仅使用观测数据的过度插补检验可能会完美通过，表明该模型能很好地拟合观测数据。然而，这个相同的模型会对缺失值产生有偏的插补，因为它将从一个没有考虑 MNAR 机制的分布中进行抽样。\n- 因此，通过过度插补诊断并*不能*验证该模型在 MNAR 条件下的使用，也不能保证插补是无偏的。\n**结论：不正确。**\n\n总之，选项 A 和 C 描述了执行过度插补诊断以评估贝叶斯插补模型校准情况的正确和标准程序。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}