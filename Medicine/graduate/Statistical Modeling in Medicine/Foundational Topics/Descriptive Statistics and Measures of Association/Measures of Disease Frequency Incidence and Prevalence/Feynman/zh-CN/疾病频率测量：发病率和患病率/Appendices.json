{
    "hands_on_practices": [
        {
            "introduction": "计算发病率是流行病学研究的基石，它量化了在特定人群中新发疾病的速率。这项练习将带你亲手实践一个核心技能：从队列研究的原始随访数据中计算发病密度（或称人时发病率）。你将学习如何汇总人时单位，并基于泊松分布模型来估计点估计值及其精确置信区间，从而科学地评估我们估计值的不确定性。",
            "id": "4547023",
            "problem": "一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时来量化疾病发生率（以发病率表示）。每位参与者从进入队列开始被随访，直到他们发生首次事件或被删失为止，得到的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 例首次事件。假设首次事件的发生遵循与罕见事件的泊松模型相容的计数过程，且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为“事件/人年”。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率，单位为“事件/人年”），该区间通过对观察到的人时内总事件数的泊松计数模型进行反演得到。\n\n以“事件/人年”为单位报告您的最终数值结果，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不应使用百分号；所有量均以小数表示。",
            "solution": "用户希望我解决以下问题：\n一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时来量化疾病发生率（以发病率表示）。每位参与者从进入队列开始被随访，直到他们发生首次事件或被删失为止，得到的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 例首次事件。假设首次事件的发生遵循与罕见事件的泊松模型相容的计数过程，且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为“事件/人年”。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率，单位为“事件/人年”），该区间通过对观察到的人时内总事件数的泊松计数模型进行反演得到。\n\n以“事件/人年”为单位报告您的最终数值结果，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不应使用百分号；所有量均以小数表示。\n\n### 步骤 1：提取已知信息\n- 参与者数量：$4$\n- 个体随访时间：$1.2$ 年、$0.8$ 年、$2.0$ 年、$0.5$ 年。\n- 观察到的首次事件总数 $d$：$3$。\n- 统计模型：泊松过程。\n- 置信区间置信水平：$95\\%$。\n- 要求四舍五入：四位有效数字。\n- 要求输出格式：（点估计值、下限、上限）的行向量。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确且客观。它描述了从队列研究数据中计算发病率及其置信区间的标准流行病学方法。在这种情况下，使用人时和泊松模型是标准做法。所有必要的数据都已提供，且没有矛盾之处。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n该问题要求计算发病率的点估计值和 $95\\%$ 的精确置信区间。\n\n#### 第 1 部分：发病率的点估计\n\n发病率（用 $\\lambda$ 表示）定义为每单位风险人时内的新事件数。点估计值 $\\hat{\\lambda}$ 的计算方法是观察到的事件总数 $d$ 除以总风险人时 $PT$。\n\n首先，我们通过将所有参与者的随访时间相加来计算总风险人时：\n$$\nPT = 1.2 \\text{ 年} + 0.8 \\text{ 年} + 2.0 \\text{ 年} + 0.5 \\text{ 年}\n$$\n$$\nPT = 4.5 \\text{ 人年}\n$$\n\n观察到的事件数给定为 $d = 3$。\n\n那么，发病率的点估计值为：\n$$\n\\hat{\\lambda} = \\frac{d}{PT} = \\frac{3}{4.5} = \\frac{2}{3} \\text{ 事件/人年}\n$$\n将其转换为小数，我们得到：\n$$\n\\hat{\\lambda} \\approx 0.666666... \\text{ 事件/人年}\n$$\n\n#### 第 2 部分：发病率的 95% 精确置信区间\n\n问题指明事件数遵循泊松分布。事件总数 $d=3$ 是来自均值为 $\\mu$ 的泊松分布的单个观测值。均值 $\\mu$ 通过方程 $\\mu = \\lambda \\times PT$ 与发病率 $\\lambda$ 和总人时 $PT$ 相关联。\n\n为了找到率 $\\lambda$ 的置信区间，我们首先计算均值计数 $\\mu$ 的置信区间，然后将其限值除以 $PT$。\n\n对于给定的观测计数 $d$，泊松均值 $\\mu$ 的精确置信区间基于泊松分布和卡方（$\\chi^2$）分布之间的关系。对于 $(1-\\alpha) \\times 100\\%$ 的置信区间，均值 $\\mu$ 的下限 $\\mu_L$ 和上限 $\\mu_U$ 由以下公式给出：\n$$\n\\mu_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2d}\n$$\n$$\n\\mu_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(d+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是自由度为 $\\nu$ 的卡方分布的 p-分位数，其累积概率为 $p$。\n\n对于 $95\\%$ 的置信区间，$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n观察到的事件数为 $d=3$。\n\n下限的自由度为 $2d = 2 \\times 3 = 6$。\n上限的自由度为 $2(d+1) = 2 \\times (3+1) = 8$。\n\n我们需要以下卡方分位数：\n- 对于下限：$\\chi^2_{\\alpha/2, 2d} = \\chi^2_{0.025, 6}$\n- 对于上限：$\\chi^2_{1-\\alpha/2, 2(d+1)} = \\chi^2_{0.975, 8}$\n\n使用统计表或软件，我们找到这些值：\n$$\n\\chi^2_{0.025, 6} \\approx 1.237344\n$$\n$$\n\\chi^2_{0.975, 8} \\approx 17.534546\n$$\n\n现在，我们可以计算均值计数 $\\mu$ 的置信限：\n$$\n\\mu_L = \\frac{1}{2} \\times 1.237344 = 0.618672\n$$\n$$\n\\mu_U = \\frac{1}{2} \\times 17.534546 = 8.767273\n$$\n这些是在 $4.5$ 人年内预期事件数的下限和上限。\n\n为了求出发病率 $\\lambda$ 的置信区间，我们将这些限值除以总人时 $PT = 4.5$ 人年。\n$$\n\\lambda_L = \\frac{\\mu_L}{PT} = \\frac{0.618672}{4.5} \\approx 0.1374827 \\text{ 事件/人年}\n$$\n$$\n\\lambda_U = \\frac{\\mu_U}{PT} = \\frac{8.767273}{4.5} \\approx 1.9482829 \\text{ 事件/人年}\n$$\n\n#### 第 3 部分：最终结果与四舍五入\n\n问题要求将点估计值、下限和上限四舍五入至四位有效数字。\n\n- 点估计值：$\\hat{\\lambda} \\approx 0.666666... \\to 0.6667$\n- 置信下限：$\\lambda_L \\approx 0.1374827... \\to 0.1375$\n- 置信上限：$\\lambda_U \\approx 1.9482829... \\to 1.948$\n\n最终结果是有序三元组 $(\\hat{\\lambda}, \\lambda_L, \\lambda_U)$。\n这三个值为 $(0.6667, 0.1375, 1.948)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667 & 0.1375 & 1.948\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "发病率和患病率是衡量疾病频率的两个核心指标，但它们并非相互独立。在许多慢性病的动态模型中，二者通过疾病的平均病程联系在一起，尤其是在“稳态”条件下。这项练习将指导你从第一性原理出发，推导出发病率、患病率和病程之间的经典关系公式 $P = \\frac{\\lambda D}{1 + \\lambda D}$，这对于理解疾病在人群中的长期负担和动态平衡至关重要。",
            "id": "4546920",
            "problem": "一个规模为 $N$ 的封闭、稳定人群经历一种疾病，该疾病使个体在两种互斥的状态（非病例和病例）之间转换。新发病例在非病例人群中以恒定的发病率（发病密度）$\\lambda = 0.02$ /人年发生，而退出病例状态的速率也是恒定的，使得在病例状态的平均逗留时间为 $D = 5$ 年。假设处于稳态条件下，即人群规模和所有转换率随时间保持不变，且流入和流出病例状态的量平均达到平衡。仅使用发病率、患病率和平均病程的核心定义，结合两种状态之间的稳态流量平衡，从第一性原理出发，在这些假设下推导出期望点患病率 $P$ 的表达式，然后进行数值计算。将最终的数值患病率表示为无单位的小数，并将答案四舍五入到四位有效数字。此外，无需计算，简要解释在此框架下，将退出过程解释为缓解与死亡，如何改变了平均病程参数的含义，即使 $D$ 的数值相同。最终答案只提供计算出的患病率数值。",
            "solution": "该问题被评估为有效，因为它在科学上基于既定的流行病学原理，提法恰当、客观且内部一致。它代表了一个经典的稳态房室模型，该模型存在唯一且有意义的解。\n\n设 $N$ 为封闭、稳定人群的总规模。人群被分为两个互斥的状态：病例，其人群规模为 $C$；非病例，其人群规模为 $S$。因此，在任何时候，我们都有以下关系：\n$$S + C = N$$\n点患病率，记为 $P$，定义为在特定时间点人群中为病例的比例。在稳态条件下，患病率是恒定的，由下式给出：\n$$P = \\frac{C}{N}$$\n问题提供了发病率（也称为发病密度）$\\lambda$，即非病例成为新病例的速率。其值为 $\\lambda = 0.02$ /人年。流入病例状态的总速率是这个人均速率与风险人群（非病例，$S$）数量的乘积：\n$$ \\text{Inflow rate} = \\lambda S $$\n问题还提供了在病例状态的平均逗留时间，即疾病的平均病程，$D = 5$ 年。退出病例状态的速率，我们记为 $\\gamma$，是平均病程的倒数：\n$$ \\gamma = \\frac{1}{D} $$\n流出病例状态的总速率是这个人均退出速率与病例数量 $C$ 的乘积：\n$$ \\text{Outflow rate} = \\gamma C = \\frac{1}{D} C $$\n问题的核心假设是系统处于稳态，这意味着流入病例状态的量与流出病例状态的量完全平衡：\n$$ \\text{Inflow rate} = \\text{Outflow rate} $$\n$$ \\lambda S = \\frac{C}{D} $$\n为了推导患病率 $P$ 的表达式，我们必须将此方程中的变量与 $N$ 联系起来。我们可以将非病例数 $S$ 表示为 $S = N - C$。将其代入稳态方程可得：\n$$ \\lambda (N - C) = \\frac{C}{D} $$\n目标是求出 $P = C/N$。我们可以重新整理方程来求解这个比率。首先，我们将 $\\lambda$ 分配到等式左侧：\n$$ \\lambda N - \\lambda C = \\frac{C}{D} $$\n接下来，我们将所有含 $C$ 的项移到等式的一边：\n$$ \\lambda N = \\lambda C + \\frac{C}{D} $$\n从等式右侧提取公因子 $C$：\n$$ \\lambda N = C \\left( \\lambda + \\frac{1}{D} \\right) $$\n为了得到患病率 $P = C/N$，我们将等式两边同时除以 $N$：\n$$ \\lambda = \\frac{C}{N} \\left( \\lambda + \\frac{1}{D} \\right) $$\n$$ \\lambda = P \\left( \\lambda + \\frac{1}{D} \\right) $$\n求解 $P$ 可得：\n$$ P = \\frac{\\lambda}{\\lambda + \\frac{1}{D}} $$\n为了简化此表达式，我们可以将分子和分母同时乘以 $D$：\n$$ P = \\frac{\\lambda D}{D \\left( \\lambda + \\frac{1}{D} \\right)} = \\frac{\\lambda D}{\\lambda D + 1} $$\n这就是从第一性原理出发，在稳态条件下推导出的点患病率的表达式。\n\n现在，我们将给定的数值 $\\lambda = 0.02 \\, \\text{year}^{-1}$ 和 $D = 5 \\, \\text{years}$ 代入此表达式。首先，我们计算无量纲乘积 $\\lambda D$：\n$$ \\lambda D = 0.02 \\times 5 = 0.1 $$\n使用这个值，我们计算患病率 $P$：\n$$ P = \\frac{0.1}{1 + 0.1} = \\frac{0.1}{1.1} = \\frac{1}{11} $$\n题目要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$ P = \\frac{1}{11} \\approx 0.09090909... $$\n四舍五入到四位有效数字，我们得到 $P \\approx 0.09091$。\n\n关于平均病程参数 $D$ 的解释，其含义取决于退出病例状态的性质。\n如果退出过程是缓解，离开病例状态的个体将返回到非病例（易感）状态。在这种情况下，$D$ 代表康复前单次疾病发作的平均持续时间。\n如果退出过程是因该疾病死亡，离开病例状态的个体会从人群中被永久移除。在这种情况下，$D$ 代表成为病例后的平均生存时间。它是衡量该疾病致死性的一个指标。虽然基于流量平衡的患病率数值计算保持不变，但将 $D$ 解释为“病程”与“生存时间”在临床上是根本不同的。",
            "answer": "$$\\boxed{0.09091}$$"
        },
        {
            "introduction": "在比较不同人群的疾病发生率时，年龄等混杂因素常常会使原始的粗率（crude rate）产生误导。为了进行公平的比较，流行病学家开发了标化方法。这项练习将向你展示如何运用直接标化法，通过将研究人群的年龄别发病率应用于一个标准人口结构，来计算一个消除了年龄结构差异影响的“标化率”，从而更准确地评估真实的疾病风险差异。",
            "id": "4546940",
            "problem": "一个市卫生部门正在评估一个针对某种慢性病的新筛查项目，方法是将其在港口市 (Harbor City) 单个监测年内的发病率，与假设港口市具有参考人群年龄分布时的预期发病率进行比较。在为期 $1$ 年的监测期内，港口市在四个互斥的年龄分层中记录了新发病例和累积的风险人年数，具体如下：\n- 年龄组 $0$–$19$ 岁：$120{,}000$ 人年内出现 $60$ 例新发病例。\n- 年龄组 $20$–$49$ 岁：$180{,}000$ 人年内出现 $450$ 例新发病例。\n- 年龄组 $50$–$79$ 岁：$90{,}000$ 人年内出现 $600$ 例新发病例。\n- 年龄组 $\\geq 80$ 岁：$15{,}000$ 人年内出现 $150$ 例新发病例。\n\n用于直接标准化的一个假设标准人群，在同一 $1$ 年期间，包含以下各年龄组特定的人年数：\n- 年龄组 $0$–$19$ 岁：$30{,}000$ 人年。\n- 年龄组 $20$–$49$ 岁：$40{,}000$ 人年。\n- 年龄组 $50$–$79$ 岁：$25{,}000$ 人年。\n- 年龄组 $\\geq 80$ 岁：$5{,}000$ 人年。\n\n请仅使用发病率和直接标准化的基本定义，计算港口市该慢性病相对于给定标准人群的直接标化发病率，并从概念上解释其为何不同于在港口市观察到的粗发病率（总发病率）。将最终的标化发病率以每 $1{,}000$ 人年表示，并将您的答案四舍五入至四位有效数字。除了为标化率指定的单位外，不提供其他单位。",
            "solution": "问题陈述已经过评估并被认为是有效的。它在科学上基于流行病学原理，内容完整、提问清晰且客观。计算直接标化发病率所需的所有数据均已提供。\n\n主要目标是计算港口市的直接标化发病率。此过程消除了年龄结构的混杂效应，从而可以对具有不同年龄分布的人群的发病率进行更公平的比较。该方法涉及将研究人群（港口市）的年龄别发病率应用于参考或标准人群的年龄结构。\n\n设年龄分层由 $i \\in \\{1, 2, 3, 4\\}$ 索引，分别对应年龄组 $0$–$19$ 岁、$20$–$49$ 岁、$50$–$79$ 岁和 $\\geq 80$ 岁。\n\n首先，我们计算港口市的年龄别发病率 ($ASIR_i$)。发病率定义为每个分层中的新发病例数 ($C_i$) 除以总风险人年数 ($PT_i$)。\n\n港口市的给定数据如下：\n- 分层 $1$：$C_1=60$ 例，$PT_1=120,000$ 人年\n- 分层 $2$：$C_2=450$ 例，$PT_2=180,000$ 人年\n- 分层 $3$：$C_3=600$ 例，$PT_3=90,000$ 人年\n- 分层 $4$：$C_4=150$ 例，$PT_4=15,000$ 人年\n\n年龄别发病率如下：\n$$ ASIR_1 = \\frac{C_1}{PT_1} = \\frac{60}{120,000} = 0.0005 $$\n$$ ASIR_2 = \\frac{C_2}{PT_2} = \\frac{450}{180,000} = 0.0025 $$\n$$ ASIR_3 = \\frac{C_3}{PT_3} = \\frac{600}{90,000} = \\frac{1}{150} \\approx 0.006667 $$\n$$ ASIR_4 = \\frac{C_4}{PT_4} = \\frac{150}{15,000} = 0.01 $$\n\n接下来，我们使用标准人群的人年数据。设 $PT_{S,i}$ 表示标准人群中分层 $i$ 的人年数。\n- $PT_{S,1} = 30,000$ 人年\n- $PT_{S,2} = 40,000$ 人年\n- $PT_{S,3} = 25,000$ 人年\n- $PT_{S,4} = 5,000$ 人年\n\n标准人群的总人年数是：\n$$ PT_S = \\sum_{i=1}^{4} PT_{S,i} = 30,000 + 40,000 + 25,000 + 5,000 = 100,000 \\text{ person-years} $$\n\n为了求出直接标化率，我们首先计算，如果标准人群经历港口市的年龄别发病率，其每个分层中预期会出现的病例数。设 $E_i$ 为分层 $i$ 中的预期病例数。\n$$ E_i = ASIR_i \\times PT_{S,i} $$\n- 分层 1 的预期病例数：$E_1 = 0.0005 \\times 30,000 = 15$\n- 分层 2 的预期病例数：$E_2 = 0.0025 \\times 40,000 = 100$\n- 分层 3 的预期病例数：$E_3 = \\frac{1}{150} \\times 25,000 = \\frac{2500}{15} = \\frac{500}{3}$\n- 分层 4 的预期病例数：$E_4 = 0.01 \\times 5,000 = 50$\n\n预期总病例数 $E_{total}$ 是所有分层预期病例数的总和：\n$$ E_{total} = \\sum_{i=1}^{4} E_i = 15 + 100 + \\frac{500}{3} + 50 = 165 + \\frac{500}{3} = \\frac{495 + 500}{3} = \\frac{995}{3} $$\n\n直接标化发病率 ($DSIR$) 是预期总病例数除以标准人群的总人年数。\n$$ DSIR = \\frac{E_{total}}{PT_S} = \\frac{995/3}{100,000} = \\frac{995}{300,000} $$\n\n问题要求将该率以每 $1,000$ 人年表示。因此，我们将 $DSIR$ 乘以 $1,000$：\n$$ \\text{Rate per } 1,000 \\text{ person-years} = DSIR \\times 1,000 = \\frac{995}{300,000} \\times 1,000 = \\frac{995}{300} = \\frac{199}{60} \\approx 3.31666... $$\n四舍五入至四位有效数字，标化率为每 $1,000$ 人年 $3.317$。\n\n从概念上讲，这个标化率与港口市的粗（总）发病率不同，因为这两个率是相同年龄别发病率的加权平均值，但它们使用了不同的权重集。\n\n港口市的粗发病率计算如下：\n$$ \\text{Crude Rate}_{HC} = \\frac{\\text{Total Cases}_{HC}}{\\text{Total Person-Time}_{HC}} = \\frac{60+450+600+150}{120,000+180,000+90,000+15,000} = \\frac{1,260}{405,000} $$\n以每 $1,000$ 人年计，粗发病率为 $\\frac{1,260}{405,000} \\times 1,000 = \\frac{1,260}{405} \\approx 3.111$ 每 $1,000$ 人年。\n\n粗发病率是年龄别发病率的加权平均值，其中权重是港口市内每个年龄组的人年数所占的比例：\n$ \\text{Crude Rate}_{HC} = \\sum_{i=1}^{4} ASIR_i \\times \\frac{PT_i}{PT_{HC, total}} $.\n\n标化率也是相同 $ASIR_i$ 的加权平均值，但权重是来自标准人群的人年数所占的比例：\n$ DSIR = \\sum_{i=1}^{4} ASIR_i \\times \\frac{PT_{S,i}}{PT_S} $.\n\n粗发病率 ($3.111$) 和标化率 ($3.317$) 之间的差异之所以产生，是因为港口市和标准人群的年龄结构不同，并且该病症的发病率与年龄密切相关（这种现象称为年龄混杂）。在年龄较大的组中，发病率要高得多（$ASIR_3$ 和 $ASIR_4$ 远大于 $ASIR_1$ 和 $ASIR_2$）。标准人群的年龄结构比港口市略微偏老（例如，在标准人群中，$50$ 岁以上年龄组的人年数比例为 ($25,000+5,000)/100,000 = 30\\%$，而在港口市则为 ($90,000+15,000)/405,000 \\approx 25.9\\%$）。通过将港口市较高的年龄别发病率应用于标准人群较老的年龄结构，我们得到了一个更高的总发病率。这个标化率代表了如果港口市具有与标准人群相同的年龄结构时将会观察到的发病率，从而为摆脱了年龄混杂效应的比较提供了一个基础。",
            "answer": "$$ \\boxed{3.317} $$"
        }
    ]
}