{
    "hands_on_practices": [
        {
            "introduction": "这个练习将带你从最基本的伯努利试验出发，推导负二项分布的期望和方差。通过将一个复杂的随机变量分解为一系列独立同分布的几何随机变量之和，本练习旨在训练你利用期望的线性和独立变量方差的可加性等基本性质来解决问题的核心能力。这个从第一性原理出发的推导过程是掌握概率理论基本功的关键一步。",
            "id": "4962576",
            "problem": "一家临床微生物学实验室监测病人的血培养抽样是否被污染。每次抽样要么导致污染事件（失败），概率为 $p \\in (0,1)$；要么得到洁净结果（成功），概率为 $1-p$。假设在稳定条件下，抽样是顺序且独立进行的。该方案持续进行，直到观察到 $r \\in \\mathbb{N}$ 次洁净结果（成功）为止，届时抽样停止。定义随机变量 $X$ 为在观察到第 $r$ 次洁净结果之前发生的污染事件（失败）的总次数。\n\n从此失败-直到-$r$次成功停止规则出发，从独立伯努利试验的定义以及随机变量的期望和方差的定义开始，推导期望 $E[X]$ 和方差 $\\mathrm{Var}(X)$ 关于 $r$ 和 $p$ 的闭式解析表达式，推导过程中不得使用任何关于负二项分布的现成公式。请将最终答案表示为精确的符号表达式；无需进行数值四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 进行一系列独立的伯努利试验。\n- 每次试验的结果为“污染事件”（失败），概率为 $p$；或“洁净结果”（成功），概率为 $1-p$。\n- 失败概率指定为 $p \\in (0,1)$。\n- 过程在观察到第 $r$ 次成功时终止，其中 $r \\in \\mathbb{N}$。\n- 随机变量 $X$ 定义为在第 $r$ 次成功之前发生的失败总次数。\n- 目标是推导期望 $E[X]$ 和方差 $\\mathrm{Var}(X)$ 关于 $r$ 和 $p$ 的表达式。\n- 推导过程不得依赖于负二项分布的现成公式，必须从独立伯努利试验的定义以及期望和方差的性质开始。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。它描述了概率论中一个经典的场景，可用负二项分布建模。顺序、独立的伯努利试验是统计学中的一个基本概念。参数 $p$ 和 $r$ 有明确的定义和适当的定义域，确保了问题的自洽性和数学上的一致性。任务是从第一性原理出发进行推导，这是概率论中一个标准且非平凡的练习。该问题不违反任何科学原理，没有歧义，并且包含了唯一解所需的所有信息。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解法。\n\n### 推导过程\n该问题描述了一系列独立的伯努利试验，其中成功的概率是 $1-p$，失败的概率是 $p$。随机变量 $X$ 记录了在累积到 $r$ 次成功之前的总失败次数。\n\n为了从第一性原理推导 $X$ 的期望和方差，我们可以将 $X$ 分解为一系列更简单的随机变量之和。令 $Y_i$ 为第 $(i-1)$ 次成功与第 $i$ 次成功之间的失败次数，其中 $i=1, 2, \\dots, r$。我们将第 $0$ 次成功定义为试验的开始。\n\n总失败次数 $X$ 是这些中间失败次数的总和：\n$$X = Y_1 + Y_2 + \\dots + Y_r$$\n因为试验是独立的，并且过程条件稳定，所以一次成功后的失败次数不影响下一次成功前的失败次数。因此，随机变量 $Y_1, Y_2, \\dots, Y_r$ 是独立同分布 (i.i.d.) 的。\n\n我们来确定其中任意一个变量（例如 $Y_i$）的概率分布。事件 $Y_i=k$（其中 $k \\in \\{0, 1, 2, \\dots\\}$）表示在第 $(i-1)$ 次成功之后，恰好有 $k$ 次失败，然后是一次成功。这个由 $k+1$ 次试验组成的特定序列的概率是 $p^k(1-p)$。因此，$Y_i$ 的概率质量函数 (PMF) 是：\n$$P(Y_i=k) = p^k(1-p) \\quad \\text{for } k = 0, 1, 2, \\dots$$\n这定义了一个在非负整数上的几何分布。\n\n**期望 $E[X]$ 的推导**\n\n根据期望的线性性，随机变量之和的期望等于它们各自期望之和：\n$$E[X] = E\\left[\\sum_{i=1}^{r} Y_i\\right] = \\sum_{i=1}^{r} E[Y_i]$$\n由于 $Y_i$ 是同分布的，因此对所有 $i$ 都有 $E[Y_i] = E[Y_1]$。所以：\n$$E[X] = r E[Y_1]$$\n我们直接根据定义计算 $E[Y_1]$：\n$$E[Y_1] = \\sum_{k=0}^{\\infty} k \\cdot P(Y_1=k) = \\sum_{k=0}^{\\infty} k p^k (1-p) = (1-p) \\sum_{k=0}^{\\infty} k p^k$$\n为了计算这个求和，我们使用几何级数及其导数的公式。对于 $|z|1$，我们有：\n$$\\sum_{k=0}^{\\infty} z^k = \\frac{1}{1-z}$$\n两边对 $z$ 求导，得到：\n$$\\frac{d}{dz} \\sum_{k=0}^{\\infty} z^k = \\sum_{k=1}^{\\infty} k z^{k-1} = \\frac{d}{dz} \\left(\\frac{1}{1-z}\\right) = \\frac{1}{(1-z)^2}$$\n两边乘以 $z$：\n$$\\sum_{k=1}^{\\infty} k z^k = \\frac{z}{(1-z)^2}$$\n由于 $\\sum k z^k$ 中 $k=0$ 的项为零，所以这也等于 $\\sum_{k=0}^{\\infty} k z^k$。代入 $z=p$（因为 $p \\in (0,1)$，所以我们有 $|p|1$）：\n$$\\sum_{k=0}^{\\infty} k p^k = \\frac{p}{(1-p)^2}$$\n现在，我们将此结果代回 $E[Y_1]$ 的表达式中：\n$$E[Y_1] = (1-p) \\left( \\frac{p}{(1-p)^2} \\right) = \\frac{p}{1-p}$$\n最后，$X$ 的期望是：\n$$E[X] = r E[Y_1] = \\frac{rp}{1-p}$$\n\n**方差 $\\mathrm{Var}(X)$ 的推导**\n\n由于随机变量 $Y_1, Y_2, \\dots, Y_r$ 是独立的，它们之和的方差等于它们各自方差之和：\n$$\\mathrm{Var}(X) = \\mathrm{Var}\\left(\\sum_{i=1}^{r} Y_i\\right) = \\sum_{i=1}^{r} \\mathrm{Var}(Y_i)$$\n由于 $Y_i$ 是同分布的，因此对所有 $i$ 都有 $\\mathrm{Var}(Y_i) = \\mathrm{Var}(Y_1)$。所以：\n$$\\mathrm{Var}(X) = r \\mathrm{Var}(Y_1)$$\n$Y_1$ 的方差由 $\\mathrm{Var}(Y_1) = E[Y_1^2] - (E[Y_1])^2$ 给出。我们已经求出了 $E[Y_1]$。现在我们需要计算 $E[Y_1^2]$：\n$$E[Y_1^2] = \\sum_{k=0}^{\\infty} k^2 \\cdot P(Y_1=k) = \\sum_{k=0}^{\\infty} k^2 p^k (1-p) = (1-p) \\sum_{k=0}^{\\infty} k^2 p^k$$\n为了计算 $\\sum k^2 p^k$，我们将级数 $\\sum k z^k = \\frac{z}{(1-z)^2}$ 对 $z$ 求导：\n$$\\frac{d}{dz} \\sum_{k=1}^{\\infty} k z^k = \\sum_{k=1}^{\\infty} k^2 z^{k-1} = \\frac{d}{dz} \\left( \\frac{z}{(1-z)^2} \\right)$$\n使用商法则：\n$$\\frac{d}{dz} \\left( \\frac{z}{(1-z)^2} \\right) = \\frac{(1)(1-z)^2 - z(2(1-z)(-1))}{((1-z)^2)^2} = \\frac{(1-z)^2 + 2z(1-z)}{(1-z)^4} = \\frac{1-z+2z}{(1-z)^3} = \\frac{1+z}{(1-z)^3}$$\n两边乘以 $z$：\n$$\\sum_{k=1}^{\\infty} k^2 z^k = \\frac{z(1+z)}{(1-z)^3}$$\n这等价于 $\\sum_{k=0}^{\\infty} k^2 z^k$。我们代入 $z=p$：\n$$\\sum_{k=0}^{\\infty} k^2 p^k = \\frac{p(1+p)}{(1-p)^3}$$\n现在我们计算 $E[Y_1^2]$：\n$$E[Y_1^2] = (1-p) \\left( \\frac{p(1+p)}{(1-p)^3} \\right) = \\frac{p(1+p)}{(1-p)^2}$$\n现在我们可以计算 $Y_1$ 的方差：\n$$\\mathrm{Var}(Y_1) = E[Y_1^2] - (E[Y_1])^2 = \\frac{p(1+p)}{(1-p)^2} - \\left(\\frac{p}{1-p}\\right)^2$$\n$$\\mathrm{Var}(Y_1) = \\frac{p+p^2}{(1-p)^2} - \\frac{p^2}{(1-p)^2} = \\frac{p+p^2-p^2}{(1-p)^2} = \\frac{p}{(1-p)^2}$$\n最后，$X$ 的方差是：\n$$\\mathrm{Var}(X) = r \\mathrm{Var}(Y_1) = \\frac{rp}{(1-p)^2}$$\n\n推导出的期望和方差表达式为 $E[X] = \\frac{rp}{1-p}$ 和 $\\mathrm{Var}(X) = \\frac{rp}{(1-p)^2}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{rp}{1-p}  \\frac{rp}{(1-p)^2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在医学研究中，对数变换是一种常见的数据处理方法，但非线性变换会给统计推断带来微妙的挑战。本练习探讨了对数正态分布的均值，并揭示了直接对均值的估计值进行指数变换会导致系统性偏倚。通过这个过程，你将深入理解琴生不等式（Jensen's inequality）在实践中的影响，并学会如何构建一个经偏倚校正的估计量。",
            "id": "4962594",
            "problem": "在一项抗炎疗法的纵向临床研究中，由于乘性生物变异性，患者体内的生物标志物血浆浓度被建模为对数正态分布。具体来说，对于给定的时间点，假设 $Y$ 表示生物标志物的浓度（在原始尺度上测量），并令 $X = \\ln(Y)$。假设一个参数模型，其中 $X$ 在患者之间是独立同分布的正态随机变量，其均值为 $\\mu$，方差为 $\\sigma^{2}$，即 $X \\sim N(\\mu,\\sigma^{2})$。从观测样本 $\\{Y_{1},\\dots,Y_{n}\\}$ 中，定义 $X_{i} = \\ln(Y_{i})$，并将正态参数的最大似然估计量 (MLE) 表示为 $\\hat{\\mu} = \\frac{1}{n}\\sum_{i=1}^{n} X_{i}$ 和 $\\hat{\\sigma}^{2} = \\frac{1}{n}\\sum_{i=1}^{n}(X_{i} - \\hat{\\mu})^{2}$。期望浓度 $E[Y]$ 的一个广泛使用的“朴素”估计量是 $\\exp(\\hat{\\mu})$。\n\n请仅使用期望的定义和正态分布的已确立性质，提供 $E[Y]$ 关于 $\\mu$ 和 $\\sigma^{2}$ 的第一性原理推导，然后证明在指定模型下，朴素估计量 $\\exp(\\hat{\\mu})$ 对于 $E[Y]$ 是有偏的。基于这些推导，提出并简化一个闭式、基于模型的置入估计量，该估计量在从观测样本估计 $E[Y]$ 时能够纠正由变换引起的偏差，且仅用 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^{2}$ 表示。您的最终答案必须是单个闭式解析表达式。无需四舍五入，最终表达式中不应包含任何单位。",
            "solution": "问题要求推导对数正态分布随机变量的期望值，分析此期望值的朴素估计量的偏差，并构建一个修正的置入估计量。问题陈述的验证证实了其科学性、适定性和客观性。我们可以着手求解。\n\n问题定义了一个随机变量 $Y$ 来表示生物标志物的浓度，使得 $X = \\ln(Y)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。我们记为 $X \\sim N(\\mu, \\sigma^2)$。因此，随机变量 $Y$ 服从对数正态分布。\n\n首先，我们从第一性原理推导 $Y$ 的期望值，记为 $E[Y]$。由于 $Y = \\exp(X)$，其期望由 $\\exp(x)$ 乘以 $X$ 的概率密度函数 (PDF) 的积分给出。$X \\sim N(\\mu, \\sigma^2)$ 的 PDF 为：\n$$f_X(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$$\n$Y$ 的期望则为：\n$$E[Y] = E[\\exp(X)] = \\int_{-\\infty}^{\\infty} \\exp(x) f_X(x) dx = \\int_{-\\infty}^{\\infty} \\exp(x) \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) dx$$\n我们可以合并指数函数的参数：\n$$E[Y] = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\int_{-\\infty}^{\\infty} \\exp\\left(x - \\frac{(x-\\mu)^2}{2\\sigma^2}\\right) dx$$\n为求解此积分，我们对指数项进行配方：\n$$x - \\frac{(x-\\mu)^2}{2\\sigma^2} = x - \\frac{x^2 - 2\\mu x + \\mu^2}{2\\sigma^2} = \\frac{2\\sigma^2 x - (x^2 - 2\\mu x + \\mu^2)}{2\\sigma^2}$$\n$$= -\\frac{1}{2\\sigma^2} [x^2 - 2\\mu x - 2\\sigma^2 x + \\mu^2] = -\\frac{1}{2\\sigma^2} [x^2 - 2(\\mu+\\sigma^2)x + \\mu^2]$$\n我们对 $x$ 的多项式进行配方： $x^2 - 2(\\mu+\\sigma^2)x + \\mu^2 = [x - (\\mu+\\sigma^2)]^2 - (\\mu+\\sigma^2)^2 + \\mu^2 = [x - (\\mu+\\sigma^2)]^2 - (\\mu^2 + 2\\mu\\sigma^2 + \\sigma^4) + \\mu^2 = [x - (\\mu+\\sigma^2)]^2 - 2\\mu\\sigma^2 - \\sigma^4$。\n将其代回指数中：\n$$-\\frac{1}{2\\sigma^2} \\left( [x - (\\mu+\\sigma^2)]^2 - 2\\mu\\sigma^2 - \\sigma^4 \\right) = -\\frac{[x - (\\mu+\\sigma^2)]^2}{2\\sigma^2} + \\frac{2\\mu\\sigma^2 + \\sigma^4}{2\\sigma^2} = -\\frac{[x - (\\mu+\\sigma^2)]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2}$$\n现在我们可以重写 $E[Y]$ 的积分：\n$$E[Y] = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{[x - (\\mu+\\sigma^2)]^2}{2\\sigma^2} + \\mu + \\frac{\\sigma^2}{2}\\right) dx$$\n项 $\\exp(\\mu + \\frac{\\sigma^2}{2})$ 是一个关于 $x$ 的常数，可以被提取出来：\n$$E[Y] = \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{[x - (\\mu+\\sigma^2)]^2}{2\\sigma^2}\\right) dx$$\n该积分是均值为 $\\mu' = \\mu+\\sigma^2$、方差为 $\\sigma^2$ 的正态分布的 PDF 下的总面积。此积分等于 $1$。\n因此，$Y$ 的期望值为：\n$$E[Y] = \\exp\\left(\\mu + \\frac{1}{2}\\sigma^2\\right)$$\n这个结果也可以通过认识到 $E[\\exp(X)]$ 是 $X$ 的矩生成函数 (MGF) $M_X(t) = E[\\exp(tX)]$ 在 $t=1$ 时的取值来获得。对于 $X \\sim N(\\mu, \\sigma^2)$，其 MGF 为 $M_X(t) = \\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$。在 $t=1$ 时求值会得到相同的结果。\n\n接下来，我们讨论朴素估计量 $\\exp(\\hat{\\mu})$ 的偏差。$\\mu$ 的估计量是对数转换后数据的样本均值，$\\hat{\\mu} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。由于每个 $X_i$ 都是来自 $N(\\mu, \\sigma^2)$ 的独立随机变量，$\\hat{\\mu}$ 也服从正态分布。其均值为 $E[\\hat{\\mu}] = E[\\frac{1}{n}\\sum X_i] = \\frac{1}{n}\\sum E[X_i] = \\frac{1}{n}(n\\mu) = \\mu$。其方差为 $Var(\\hat{\\mu}) = Var(\\frac{1}{n}\\sum X_i) = \\frac{1}{n^2}\\sum Var(X_i) = \\frac{1}{n^2}(n\\sigma^2) = \\frac{\\sigma^2}{n}$。\n因此，$\\hat{\\mu} \\sim N(\\mu, \\frac{\\sigma^2}{n})$。\n\n为了评估估计量 $\\exp(\\hat{\\mu})$ 的偏差，我们计算其期望 $E[\\exp(\\hat{\\mu})]$。这是 $\\hat{\\mu}$ 的 MGF 在 $t=1$ 时的值。使用均值为 $\\mu$、方差为 $\\sigma^2/n$ 的正态变量的 MGF 公式：\n$$E[\\exp(\\hat{\\mu})] = \\exp\\left(\\mu \\cdot 1 + \\frac{1}{2}\\left(\\frac{\\sigma^2}{n}\\right) \\cdot 1^2\\right) = \\exp\\left(\\mu + \\frac{\\sigma^2}{2n}\\right)$$\n估计量的偏差是其期望与被估计量的真值之差：\n$$B(\\exp(\\hat{\\mu})) = E[\\exp(\\hat{\\mu})] - E[Y] = \\exp\\left(\\mu + \\frac{\\sigma^2}{2n}\\right) - \\exp\\left(\\mu + \\frac{\\sigma^2}{2}\\right)$$\n对于任何有限样本量 $n > 1$ 和非零的生物变异性 $\\sigma^2 > 0$，我们有 $\\frac{\\sigma^2}{2n}  \\frac{\\sigma^2}{2}$。由于指数函数是严格递增的，因此 $\\exp(\\mu + \\frac{\\sigma^2}{2n})  \\exp(\\mu + \\frac{\\sigma^2}{2})$。所以，偏差不为零（具体来说，是负的），估计量 $\\exp(\\hat{\\mu})$ 对于 $E[Y]$ 是有偏的。它系统性地低估了真实的平均浓度。这种偏差是由于将非线性指数变换应用于对数尺度上的均值估计量，而忽略了方差的贡献（这是詹森不等式的一个推论）。“朴素”估计量实际上是以 $\\exp(\\mu)$ 为目标，而不是正确的目标量 $\\exp(\\mu + \\frac{1}{2}\\sigma^2)$。\n\n最后，我们提出了一个基于模型的置入估计量来纠正这种由变换引起的偏差。$E[Y]$ 的推导表明，对均值的正确估计需要同时考虑 $\\mu$ 和 $\\sigma^2$。对朴素估计量偏差的“纠正”涉及到将方差项 $\\frac{1}{2}\\sigma^2$ 纳入表达式中。修正后的目标表达式是 $\\exp(\\mu + \\frac{1}{2}\\sigma^2)$。\n“置入”估计量是通过将参数估计量代入到目标量的表达式中来形成的。问题给出了 $\\mu$ 和 $\\sigma^2$ 的最大似然估计量 (MLE)：\n$$\\hat{\\mu} = \\frac{1}{n}\\sum_{i=1}^{n} X_{i}$$\n$$\\hat{\\sigma}^{2} = \\frac{1}{n}\\sum_{i=1}^{n}(X_{i} - \\hat{\\mu})^{2}$$\n将这些估计量代入 $E[Y]$ 的表达式中，得到基于模型的置入估计量，我们记为 $\\hat{E}[Y]$：\n$$\\hat{E}[Y] = \\exp\\left(\\hat{\\mu} + \\frac{1}{2}\\hat{\\sigma}^2\\right)$$\n该估计量明确使用了模型结构（$Y$ 是对数正态的），并通过包含方差项的估计来纠正朴素估计量的主要缺陷。该表达式已经是以指定的估计量 $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$ 表示的最简闭式形式。",
            "answer": "$$\\boxed{\\exp\\left(\\hat{\\mu} + \\frac{1}{2}\\hat{\\sigma}^{2}\\right)}$$"
        },
        {
            "introduction": "实际的测量过程往往受到仪器检测范围的限制，从而产生截断或删失数据，这在生物统计学中是一个普遍存在的问题。本练习模拟了生物标志物检测的场景，要求你推导截断正态分布的条件期望和条件方差。完成这个练习将使你掌握处理受限数据所需的关键技能，并加深对条件概率和矩的理解。",
            "id": "4962616",
            "problem": "在一项临床药理学研究中，实验室使用一种具有有限动态范围的检测方法来量化一种循环生物标志物。目标人群中的真实生物标志物浓度可以很好地用高斯模型描述：$X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，其未知参数为 $\\mu \\in \\mathbb{R}$ 和 $\\sigma  0$。然而，只有当真实浓度严格位于定量下限 $a$ 和定量上限 $b$（其中 $a  b$）之间时，该检测方法才会报告一个数值。在此区间之外，测量值将被删失，不报告任何数值。在一个使用条件矩（例如，作为期望最大化过程的一部分）的估计流程中，您需要计算当 $X$ 位于可量化区间内时的条件均值和条件方差。\n\n仅从连续随机变量的条件期望的核心定义以及一般正态分布与标准正态分布之间的标准变量替换映射出发，推导 $E[X \\mid a  X  b]$ 和 $\\mathrm{Var}(X \\mid a  X  b)$ 的闭式表达式，该表达式须用标准正态概率密度函数 (pdf) 和累积分布函数 (cdf) 来表示。将标准正态 pdf 记为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-z^{2}/2)$，标准正态 cdf 记为 $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t)\\,\\mathrm{d}t$。\n\n您的最终表达式必须仅依赖于 $\\mu$, $\\sigma$, $a$, $b$, $\\phi(\\cdot)$ 和 $\\Phi(\\cdot)$。将最终答案表示为闭式解析表达式。无需进行数值计算或四舍五入。最终答案必须只包含所要求的两个表达式，并按条件期望、条件方差的顺序列出。",
            "solution": "如上所述，该问题构成了数理统计学领域中一个有效且适定的问题。它要求推导一个正态分布随机变量在给定其落入一个特定区间内的条件下的条件均值和方差。这是一个关于截断正态分布的标准问题，它在计量经济学、生物统计学和工程学等领域有直接应用，包括题目中提供的临床药理学背景。该问题有科学依据、客观，并包含得出唯一解所需的所有信息。\n\n设随机变量 $X$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，记为 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。$X$ 的概率密度函数 (pdf) 由下式给出：\n$$f_X(x) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$$\n我们感兴趣的是在事件 $C = \\{x \\in \\mathbb{R} \\mid a  x  b\\}$ 条件下 $X$ 的矩。该事件的概率 $P(C)$ 是 pdf 在区间 $(a, b)$ 上的积分。为计算此概率，我们对变量进行标准化。令 $Z = \\frac{X-\\mu}{\\sigma}$。$Z$ 是一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，其 pdf 为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-z^2/2)$，累积分布函数 (cdf) 为 $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t)\\,\\mathrm{d}t$。\n\n事件 $a  X  b$ 等价于 $\\frac{a-\\mu}{\\sigma}  Z  \\frac{b-\\mu}{\\sigma}$。为简化符号，令 $\\alpha = \\frac{a-\\mu}{\\sigma}$ 和 $\\beta = \\frac{b-\\mu}{\\sigma}$。因为 $a  b$ 且 $\\sigma > 0$，所以 $\\alpha  \\beta$。条件事件的概率是：\n$$P(C) = P(a  X  b) = P(\\alpha  Z  \\beta) = \\int_{\\alpha}^{\\beta} \\phi(z) \\, \\mathrm{d}z = \\Phi(\\beta) - \\Phi(\\alpha)$$\n给定 $C$ 的情况下 $X$ 的条件 pdf 为 $f_{X|C}(x) = \\frac{f_X(x)}{P(C)}$（当 $x \\in (a, b)$ 时），其他情况下为 0。\n\n首先，我们推导条件期望 $E[X \\mid a  X  b]$。\n根据定义，条件期望是：\n$$E[X \\mid a  X  b] = \\int_a^b x \\cdot f_{X|C}(x) \\, \\mathrm{d}x = \\frac{1}{P(C)} \\int_a^b x f_X(x) \\, \\mathrm{d}x$$\n我们通过变量替换 $z = \\frac{x-\\mu}{\\sigma}$ 来计算该积分，这意味着 $x = \\mu + \\sigma z$ 且 $\\mathrm{d}x = \\sigma \\, \\mathrm{d}z$。表达式 $f_X(x) \\, \\mathrm{d}x$ 变换为 $\\phi(z) \\, \\mathrm{d}z$。积分限从 $(a, b)$ 变为 $(\\alpha, \\beta)$。\n$$\\int_a^b x f_X(x) \\, \\mathrm{d}x = \\int_{\\alpha}^{\\beta} (\\mu + \\sigma z) \\phi(z) \\, \\mathrm{d}z = \\mu \\int_{\\alpha}^{\\beta} \\phi(z) \\, \\mathrm{d}z + \\sigma \\int_{\\alpha}^{\\beta} z \\phi(z) \\, \\mathrm{d}z$$\n第一个积分是 $\\mu P(C)$。对于第二个积分，我们利用 $\\frac{\\mathrm{d}}{\\mathrm{d}z}\\phi(z) = -z\\phi(z)$ 这个性质。\n$$\\int_{\\alpha}^{\\beta} z \\phi(z) \\, \\mathrm{d}z = \\int_{\\alpha}^{\\beta} \\left(-\\frac{\\mathrm{d}}{\\mathrm{d}z}\\phi(z)\\right) \\, \\mathrm{d}z = [-\\phi(z)]_{\\alpha}^{\\beta} = -\\phi(\\beta) + \\phi(\\alpha) = \\phi(\\alpha) - \\phi(\\beta)$$\n代入回去，我们得到：\n$$\\int_a^b x f_X(x) \\, \\mathrm{d}x = \\mu P(C) + \\sigma(\\phi(\\alpha) - \\phi(\\beta))$$\n因此，条件期望为：\n$$E[X \\mid a  X  b] = \\frac{\\mu P(C) + \\sigma(\\phi(\\alpha) - \\phi(\\beta))}{P(C)} = \\mu + \\sigma \\frac{\\phi(\\alpha) - \\phi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)}$$\n\n接下来，我们推导条件方差 $\\mathrm{Var}(X \\mid a  X  b) = E[X^2 \\mid a  X  b] - (E[X \\mid a  X  b])^2$。我们首先计算二阶条件矩 $E[X^2 \\mid a  X  b]$。\n$$E[X^2 \\mid a  X  b] = \\frac{1}{P(C)} \\int_a^b x^2 f_X(x) \\, \\mathrm{d}x$$\n使用相同的变量替换：\n$$\\int_a^b x^2 f_X(x) \\, \\mathrm{d}x = \\int_{\\alpha}^{\\beta} (\\mu + \\sigma z)^2 \\phi(z) \\, \\mathrm{d}z = \\int_{\\alpha}^{\\beta} (\\mu^2 + 2\\mu\\sigma z + \\sigma^2 z^2) \\phi(z) \\, \\mathrm{d}z$$\n$$= \\mu^2 \\int_{\\alpha}^{\\beta} \\phi(z) \\, \\mathrm{d}z + 2\\mu\\sigma \\int_{\\alpha}^{\\beta} z \\phi(z) \\, \\mathrm{d}z + \\sigma^2 \\int_{\\alpha}^{\\beta} z^2 \\phi(z) \\, \\mathrm{d}z$$\n前两项是 $\\mu^2 P(C)$ 和 $2\\mu\\sigma(\\phi(\\alpha) - \\phi(\\beta))$。对于第三个积分 $\\int z^2 \\phi(z) \\, \\mathrm{d}z$，我们使用分部积分法，设 $u=z$ 和 $\\mathrm{d}v = z\\phi(z)\\,\\mathrm{d}z$，于是 $\\mathrm{d}u = \\mathrm{d}z$ 和 $v = -\\phi(z)$。\n$$\\int_{\\alpha}^{\\beta} z^2 \\phi(z) \\, \\mathrm{d}z = [-z\\phi(z)]_{\\alpha}^{\\beta} - \\int_{\\alpha}^{\\beta} (-\\phi(z)) \\, \\mathrm{d}z = [-\\beta\\phi(\\beta) - (-\\alpha\\phi(\\alpha))] + [\\Phi(z)]_{\\alpha}^{\\beta}$$\n$$= \\alpha\\phi(\\alpha) - \\beta\\phi(\\beta) + \\Phi(\\beta) - \\Phi(\\alpha) = \\alpha\\phi(\\alpha) - \\beta\\phi(\\beta) + P(C)$$\n二阶矩的积分是：\n$$\\int_a^b x^2 f_X(x) \\, \\mathrm{d}x = \\mu^2 P(C) + 2\\mu\\sigma(\\phi(\\alpha) - \\phi(\\beta)) + \\sigma^2(\\alpha\\phi(\\alpha) - \\beta\\phi(\\beta) + P(C))$$\n除以 $P(C)$ 就得到 $E[X^2 \\mid a  X  b]$：\n$$E[X^2 \\mid a  X  b] = \\mu^2 + 2\\mu\\sigma\\frac{\\phi(\\alpha) - \\phi(\\beta)}{P(C)} + \\sigma^2\\left(1 + \\frac{\\alpha\\phi(\\alpha) - \\beta\\phi(\\beta)}{P(C)}\\right)$$\n现在我们计算方差。令 $K = \\frac{\\phi(\\alpha) - \\phi(\\beta)}{P(C)}$。则 $E[X \\mid a  X  b] = \\mu + \\sigma K$ 且 $(E[X \\mid a  X  b])^2 = \\mu^2 + 2\\mu\\sigma K + \\sigma^2 K^2$。\n$$\\mathrm{Var}(X \\mid a  X  b) = E[X^2 \\mid a  X  b] - (E[X \\mid a  X  b])^2$$\n$$= \\left(\\mu^2 + 2\\mu\\sigma K + \\sigma^2\\left(1 + \\frac{\\alpha\\phi(\\alpha) - \\beta\\phi(\\beta)}{P(C)}\\right)\\right) - (\\mu^2 + 2\\mu\\sigma K + \\sigma^2 K^2)$$\n$$= \\sigma^2\\left(1 + \\frac{\\alpha\\phi(\\alpha) - \\beta\\phi(\\beta)}{P(C)} - K^2\\right)$$\n代入 $P(C)$ 和 $K$：\n$$\\mathrm{Var}(X \\mid a  X  b) = \\sigma^2 \\left[ 1 + \\frac{\\alpha\\phi(\\alpha) - \\beta\\phi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)} - \\left(\\frac{\\phi(\\alpha) - \\phi(\\beta)}{\\Phi(\\beta) - \\Phi(\\alpha)}\\right)^2 \\right]$$\n最后，将 $\\alpha$ 和 $\\beta$ 替换为它们以 $a$、$b$、$\\mu$ 和 $\\sigma$ 表示的定义，便可得到完整的表达式。\n\n条件期望是：\n$$E[X \\mid a  X  b] = \\mu + \\sigma \\frac{\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)}$$\n条件方差是：\n$$\\mathrm{Var}(X \\mid a  X  b) = \\sigma^2 \\left[ 1 + \\frac{\\frac{a-\\mu}{\\sigma}\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\frac{b-\\mu}{\\sigma}\\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)} - \\left( \\frac{\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)} \\right)^2 \\right]$$\n这些就是最终的闭式表达式。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n\\mu + \\sigma \\frac{\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)}  \\sigma^2 \\left[ 1 + \\frac{\\frac{a-\\mu}{\\sigma}\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\frac{b-\\mu}{\\sigma}\\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)} - \\left( \\frac{\\phi\\left(\\frac{a-\\mu}{\\sigma}\\right) - \\phi\\left(\\frac{b-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)} \\right)^2 \\right]\n\\end{pmatrix}\n} $$"
        }
    ]
}