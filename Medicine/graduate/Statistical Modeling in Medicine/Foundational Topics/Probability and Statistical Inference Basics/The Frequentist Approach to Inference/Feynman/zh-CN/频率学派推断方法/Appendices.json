{
    "hands_on_practices": [
        {
            "introduction": "频率派推断的探索之旅通常从点估计开始——即为未知参数寻找一个最佳的单一估计值。本练习将介绍最大似然法这一基石性技术，它通过寻找使观测数据出现概率最大的参数值来推导估计量。通过处理医学研究中用于分析二元结果的经典模型——二项分布模型，您不仅将推导出比例参数的估计量，还将通过计算费雪信息来量化其精度。",
            "id": "4988042",
            "problem": "一项单臂药物警戒研究监测了接受新疗法的 $n$ 名独立患者中某一特定不良事件的发生情况。令 $X$ 表示经历该事件的患者数量，并将 $X$ 建模为二项随机变量 $X \\sim \\mathrm{Bin}(n,p)$，其中 $p$ 是每位患者的事件概率。您观察到计数为 $x \\in \\{0,1,\\dots,n\\}$。在频率派推断方法下，从二项概率质量函数和最大似然估计量（MLE）的定义出发，执行以下操作：\n\n1. 推导 $p$ 的最大似然估计量（MLE）$\\hat{p}$。\n2. 从基于观测计数 $x$ 的 $p$ 的对数似然函数出发，计算 $p$ 的观测Fisher信息。利用它来获得在 $\\hat{p}$ 处评估的 $\\hat{p}$ 的渐近方差的闭式表达式，该表达式仅用 $x$ 和 $n$ 表示。\n\n请以仅包含 $x$ 和 $n$ 的单个解析表达式的形式提供您的最终答案。无需四舍五入。最终表达式中不应包含任何单位。",
            "solution": "所述问题是有效的。这是一个在频率派统计推断中定义明确的问题，其基础是二项模型的最大似然估计和Fisher信息的基本原理，这是医学统计学中的一个标准应用。所有必要的信息都已提供，问题是自洽的且科学上是合理的。\n\n在 $n$ 名患者中，不良事件数 $X$ 的模型是二项分布，$X \\sim \\mathrm{Bin}(n, p)$，其中 $p$ 是未知的每位患者的事件概率。我们得到一个观测计数 $x$。\n\n对于 $X=x$ 的概率质量函数 (PMF) 是：\n$$\nP(X=x | n, p) = \\binom{n}{x} p^x (1-p)^{n-x}\n$$\n当将此函数视为固定观测值 $x$ 下参数 $p$ 的函数时，它就是似然函数 $L(p|x)$。\n\n**第1部分：$p$ 的最大似然估计量（MLE）的推导**\n\n为了找到MLE，我们首先定义对数似然函数 $\\ell(p|x)$，它是似然函数的自然对数。最大化对数似然等同于最大化似然。\n$$\n\\ell(p|x) = \\ln[L(p|x)] = \\ln\\left[\\binom{n}{x} p^x (1-p)^{n-x}\\right]\n$$\n利用对数的性质，我们可以写出：\n$$\n\\ell(p|x) = \\ln\\binom{n}{x} + x\\ln(p) + (n-x)\\ln(1-p)\n$$\n为了找到使该函数最大化的 $p$ 值，我们对 $p$ 求一阶导数（得分函数）并将其设为零。\n$$\n\\frac{d\\ell}{dp} = \\frac{d}{dp}\\left[ \\ln\\binom{n}{x} + x\\ln(p) + (n-x)\\ln(1-p) \\right] = \\frac{x}{p} - \\frac{n-x}{1-p}\n$$\n将导数设为零得到方程：\n$$\n\\frac{x}{p} = \\frac{n-x}{1-p}\n$$\n求解 $p$：\n$$\nx(1-p) = p(n-x)\n$$\n$$\nx - xp = np - xp\n$$\n$$\nx = np\n$$\n$p$ 的解就是最大似然估计量，记为 $\\hat{p}$：\n$$\n\\hat{p} = \\frac{x}{n}\n$$\n为了确认该点是最大值点，我们可以检查对数似然的二阶导数：\n$$\n\\frac{d^2\\ell}{dp^2} = -\\frac{x}{p^2} - \\frac{n-x}{(1-p)^2}\n$$\n对于 $p \\in (0, 1)$ 和观测到的 $x \\in \\{1, \\dots, n-1\\}$，该二阶导数恒为负，从而确认 $\\hat{p}$ 确实是一个最大值点。该公式对于边界情况 $x=0$ 和 $x=n$ 也成立。\n\n**第2部分：$\\hat{p}$ 的渐近方差**\n\n问题要求计算观测Fisher信息，它被定义为对数似然函数二阶导数的负值：\n$$\nI_O(p) = -\\frac{d^2\\ell}{dp^2} = -\\left(-\\frac{x}{p^2} - \\frac{n-x}{(1-p)^2}\\right) = \\frac{x}{p^2} + \\frac{n-x}{(1-p)^2}\n$$\nMLE的渐近方差可以通过在MLE $\\hat{p}$ 处评估的观测Fisher信息的倒数来估计。因此，我们将 $p = \\hat{p} = \\frac{x}{n}$ 代入 $I_O(p)$ 的表达式中。此步骤仅在 $x \\in \\{1, \\dots, n-1\\}$ 时严格有效，以避免除以零。\n$$\nI_O(\\hat{p}) = \\frac{x}{(\\frac{x}{n})^2} + \\frac{n-x}{(1-\\frac{x}{n})^2}\n$$\n简化表达式：\n$$\nI_O(\\hat{p}) = \\frac{x}{x^2/n^2} + \\frac{n-x}{((n-x)/n)^2} = \\frac{xn^2}{x^2} + \\frac{(n-x)n^2}{(n-x)^2}\n$$\n$$\nI_O(\\hat{p}) = \\frac{n^2}{x} + \\frac{n^2}{n-x}\n$$\n为了合并这些项，我们找到一个公分母：\n$$\nI_O(\\hat{p}) = n^2 \\left( \\frac{1}{x} + \\frac{1}{n-x} \\right) = n^2 \\left( \\frac{n-x+x}{x(n-x)} \\right) = \\frac{n^3}{x(n-x)}\n$$\n$\\hat{p}$ 的估计渐近方差，记为 $\\widehat{\\mathrm{Var}(\\hat{p})}$，是在 $\\hat{p}$ 处评估的观测Fisher信息的倒数：\n$$\n\\widehat{\\mathrm{Var}(\\hat{p})} = [I_O(\\hat{p})]^{-1} = \\left( \\frac{n^3}{x(n-x)} \\right)^{-1}\n$$\n$$\n\\widehat{\\mathrm{Var}(\\hat{p})} = \\frac{x(n-x)}{n^3}\n$$\n这就是所要求的在 $\\hat{p}$ 处评估的 $\\hat{p}$ 的渐近方差的闭式表达式，用 $x$ 和 $n$ 表示。尽管推导的中间步骤要求 $x$ 严格在 $0$ 和 $n$ 之间，但这个最终表达式对于 $x=0$ 和 $x=n$ 也是良定义的，此时它正确地评估为 $0$。",
            "answer": "$$\n\\boxed{\\frac{x(n-x)}{n^3}}\n$$"
        },
        {
            "introduction": "点估计给出了一个最佳猜测，但并未传达估计本身固有的不确定性，而这正是区间估计的作用。本练习将超越点估计，在一个常见的真实世界场景中构建置信区间：当方差未知时估计总体均值。您将通过识别一个关键的枢轴量（t统计量）从头推导置信区间，从而巩固您对频率派推断如何严谨地表达不确定性的理解。",
            "id": "4988052",
            "problem": "一个临床药理学团队正在评估一组开始接受高强度他汀类药物治疗的患者中，低密度脂蛋白胆固醇的平均变化。为了建立一个简单而科学上现实的模型，假设患者层面的变化（治疗后减去治疗前）——记为$X_{i}$——是服从未知均值为$\\mu$、未知方差为$\\sigma^{2}$的正态分布的独立同分布随机变量。样本量为$n$，样本均值为$\\bar{X}$，无偏样本方差为$S^{2} = \\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}$。使用频率学派范式，将$\\mu$和$\\sigma^{2}$视为固定但未知的参数，并构建一个在所述模型下具有精确覆盖率的区间估计量。\n\n仅从基本定义和正态模型的经过充分检验的分布事实（例如，已知方差下标准化均值的标准正态分布、缩放后的无偏样本方差的卡方分布，以及正态性下样本均值和样本方差的独立性）出发，完成以下任务：\n\n1. 当$\\sigma^{2}$未知时，定义一个关于$\\mu$的枢轴量，并论证其分布不依赖于任何未知参数。\n2. 使用该枢轴量推导$\\mu$的一个双侧$(1-\\alpha)$置信区间 (CI)，该区间需用$\\bar{X}$、$S$、$n$以及一个完全指定参考分布的适当分位数明确表示。\n3. 在一项包含$n=23$名患者的前瞻性研究中，观测到的汇总统计量为$\\bar{X}=-32.5$和$S=12.0$，其中低密度脂蛋白胆固醇的变化以$\\mathrm{mg/dL}$为单位。使用第2部分得出的精确置信区间，并设$\\alpha=0.05$，计算数值端点。将您的两个端点四舍五入到四位有效数字。两个端点都以$\\mathrm{mg/dL}$表示。",
            "solution": "该问题要求推导一个频率学派置信区间，用于在总体方差$\\sigma^{2}$未知的情况下估计正态分布的总体均值$\\mu$，并应用该区间。解决方案将通过以下步骤构建：首先确定一个合适的枢轴量，然后推导置信区间的一般形式，最后为给定数据计算数值区间。\n\n1.  枢轴量的定义与论证\n\n构建此置信区间的基础是一个枢轴量，它是样本数据和未知参数的函数，其概率分布不依赖于任何未知参数。\n\n我们已知患者层面的变化$X_{i}$是独立同分布的正态随机变量，即$X_i \\sim \\mathcal{N}(\\mu, \\sigma^2)$。基于此，我们使用以下基本分布事实：\n- 样本均值$\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_{i}$服从均值为$\\mu$、方差为$\\frac{\\sigma^{2}}{n}$的正态分布。将$\\bar{X}$标准化可得到一个标准正态随机变量，$Z = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}} \\sim \\mathcal{N}(0, 1)$。\n- 缩放后的无偏样本方差，其中$S^{2} = \\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}$，服从卡方分布：$\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi_{n-1}^{2}$。\n- 对于从正态分布中抽取的样本，样本均值$\\bar{X}$和样本方差$S^{2}$是统计独立的。\n\n标准化均值$Z$不是一个枢轴量，因为其公式包含未知参数$\\sigma$。为了创建一个枢轴量，我们必须用一个估计量替换$\\sigma$。$\\sigma$的自然估计量是样本标准差$S$。\n\n我们将学生t分布随机变量（Student's t-distributed random variable）定义为一个标准正态随机变量与一个独立的卡方随机变量除以其自由度的平方根之比。设$Z \\sim \\mathcal{N}(0, 1)$，$V \\sim \\chi_{k}^{2}$，且$Z$和$V$相互独立。则随机变量$T = \\frac{Z}{\\sqrt{V/k}}$服从自由度为$k$的学生t分布（Student's t-distribution），记为$t_{k}$。\n\n在我们的情况下，我们设置：\n- $Z = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}$\n- $V = \\frac{(n-1)S^{2}}{\\sigma^{2}}$\n- $k = n-1$\n\n由于$\\bar{X}$和$S^{2}$的独立性，$Z$和$V$是独立的。我们现在可以构建枢轴量$T$：\n$$T = \\frac{Z}{\\sqrt{V/k}} = \\frac{\\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}}{\\sqrt{\\frac{(n-1)S^{2}/\\sigma^{2}}{n-1}}}$$\n简化分母可得：\n$$\\sqrt{\\frac{S^{2}}{\\sigma^{2}}} = \\frac{S}{\\sigma} \\quad (\\text{因为 } S > 0)$$\n将此代回$T$的表达式中：\n$$T = \\frac{\\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}}{\\frac{S}{\\sigma}} = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}} \\cdot \\frac{\\sigma}{S} = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}}$$\n这个量$T$服从自由度为$n-1$的学生t分布，即$T \\sim t_{n-1}$。其分布仅依赖于已知的样本量$n$，而不依赖于未知参数$\\mu$或$\\sigma^{2}$。因此，$T = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}}$是关于$\\mu$的一个枢轴量。\n\n2.  推导$\\mu$的$(1-\\alpha)$置信区间\n\n利用枢轴量$T \\sim t_{n-1}$，我们可以构建一个概率陈述，作为置信区间的基础。对于一个双侧置信水平为$1-\\alpha$，我们寻找界定$t_{n-1}$分布中心$1-\\alpha$区域的值。令$t_{n-1, \\alpha/2}$表示$t_{n-1}$分布的临界值，使得上尾面积为$\\alpha/2$；即$P(T > t_{n-1, \\alpha/2}) = \\alpha/2$。由于t分布关于$0$的对称性，我们也有$P(T  -t_{n-1, \\alpha/2}) = \\alpha/2$。\n\n因此，中心概率为：\n$$P(-t_{n-1, \\alpha/2} \\le T \\le t_{n-1, \\alpha/2}) = 1 - \\alpha$$\n代入枢轴量$T$的表达式：\n$$P\\left(-t_{n-1, \\alpha/2} \\le \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} \\le t_{n-1, \\alpha/2}\\right) = 1 - \\alpha$$\n为了推导$\\mu$的置信区间，我们在不等式中心通过代数运算分离出$\\mu$：\n$$-t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\le \\bar{X} - \\mu \\le t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n从所有部分减去$\\bar{X}$：\n$$-\\bar{X} -t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\le - \\mu \\le -\\bar{X} + t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n将所有部分乘以$-1$并反转不等号方向：\n$$\\bar{X} + t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\ge \\mu \\ge \\bar{X} - t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n这就给出了$\\mu$的双侧$(1-\\alpha)$置信区间：\n$$\\left[ \\bar{X} - t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}}, \\quad \\bar{X} + t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}} \\right]$$\n\n3.  数值计算\n\n问题提供了以下汇总统计量和参数：\n- 样本量：$n=23$\n- 样本均值：$\\bar{X}=-32.5$\n- 样本标准差：$S=12.0$\n- 显著性水平：$\\alpha=0.05$\n\nt分布的自由度为$df = n-1 = 23-1 = 22$。\n所要求的置信水平为$1-\\alpha = 1-0.05 = 0.95$。\n我们需要临界值$t_{df, \\alpha/2} = t_{22, 0.025}$。从标准统计表或计算软件中，该值约为$2.0739$。\n\n均值的标准误 (SE) 为：\n$$SE = \\frac{S}{\\sqrt{n}} = \\frac{12.0}{\\sqrt{23}}$$\n误差范围 (ME) 是临界值与标准误的乘积：\n$$ME = t_{22, 0.025} \\cdot SE = 2.0739 \\cdot \\frac{12.0}{\\sqrt{23}} \\approx 2.0739 \\cdot \\frac{12.0}{4.79583} \\approx 2.0739 \\cdot 2.50216 \\approx 5.1893$$\n置信区间计算为$\\bar{X} \\pm ME$：\n- 下端点：$L = \\bar{X} - ME = -32.5 - 5.1893 = -37.6893$\n- 上端点：$U = \\bar{X} + ME = -32.5 + 5.1893 = -27.3107$\n\n问题要求将端点四舍五入到四位有效数字。\n- 四舍五入后的下端点：$-37.69$\n- 四舍五入后的上端点：$-27.31$\n\n低密度脂蛋白胆固醇平均变化的$95\\%$置信区间约为$(-37.69, -27.31) \\ \\mathrm{mg/dL}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} -37.69  -27.31 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "经典的统计推断方法通常依赖于较强的分布假设，例如正态性。当这些假设存疑时我们该怎么办？最后的这个练习将介绍非参数自助法（bootstrap），这是一种强大的计算方法，通过直接从观测数据中重抽样来进行稳健的推断。通过亲手实现百分位自助法区间，您将获得处理现代统计学中不可或缺的灵活技术的实践经验，这在理论分布未知或不可靠时尤为重要。",
            "id": "4988031",
            "problem": "考虑一项医学研究，其中测量了以纳克/毫升 (ng/mL) 为单位的连续生物标志物浓度。在频率学派框架中，参数被定义为真实数据生成分布的一个泛函。令 $X$ 表示生物标志物的测量值，令 $F$ 表示 $X$ 在目标临床人群中的未知分布，并令待估量为总体均值 $\\theta = \\mathbb{E}_F[X]$。您从 $F$ 中观测到 $n$ 个独立同分布 (IID) 的实现值 $\\{x_1,\\dots,x_n\\}$，并使用样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n x_i$ 作为 $\\theta$ 的估计量。由于 $F$ 未知，$\\bar{X}$ 的抽样分布也是未知的。\n\n定义非参数自助法：用经验分布 $\\hat{F}_n$ 替代 $F$，该经验分布在每个观测值 $x_i$ 处赋予 $1/n$ 的概率质量；并通过从 $\\{x_1,\\dots,x_n\\}$ 中进行有放回的重复抽样，并在每个重抽样样本上重新计算估计量，来近似估计量的抽样分布。请描述如何利用 $\\bar{X}$ 的自助抽样分布的经验分位数，来获得 $\\theta$ 的百分位数置信区间。\n\n您的任务是实现一个程序，该程序在给定观测的生物标志物数据、自助复制次数 $B$ 以及置信水平 $(1-\\alpha)$（其中 $\\alpha$ 以小数形式指定）的情况下，通过对观测数据进行有放回的重抽样，计算平均生物标志物水平 $\\theta$ 的非参数自助法百分位数置信区间。对于下方的每个测试用例，通过从观测值中有放回地抽样来生成 $B$ 个大小为 $n$ 的自助样本，为每个重抽样样本计算自助样本均值，并返回分别由 $\\alpha/2$ 和 $1 - \\alpha/2$ 水平上的经验分位数给出的下限和上限。所有生物标志物浓度和置信区间端点均以 ng/mL 表示，并四舍五入到三位小数。使用提供的随机种子以确保可复现性。\n\n测试套件（每个测试用例都是一个 $(\\text{data}, B, \\alpha, \\text{seed})$ 的元组）：\n- 案例 1：数据 $[2.1, 3.4, 3.0, 2.7, 4.2, 5.1, 3.8, 2.9, 3.2, 4.0]$，$B = 5000$，$\\alpha = 0.05$，种子 $= 11$。\n- 案例 2：数据 $[2.4, 2.5, 2.6, 2.7, 2.8]$，$B = 10000$，$\\alpha = 0.10$，种子 $= 123$。\n- 案例 3：数据 $[3.0, 3.0, 3.0, 3.0, 3.0]$，$B = 3000$，$\\alpha = 0.05$，种子 $= 7$。\n- 案例 4：数据 $[2.0, 2.1, 2.2, 2.3, 10.0, 2.4, 2.5]$，$B = 15000$，$\\alpha = 0.05$，种子 $= 2023$。\n\n覆盖范围设计理据：\n- 案例 1 使用一个具有中等变异性的典型中等样本。\n- 案例 2 改变了 $\\alpha$ 来测试不同的置信水平，并使用小样本量。\n- 案例 3 是一个退化情况，其中所有观测值都相同，用于测试自助分布为点质量时的边界情况。\n- 案例 4 包含一个显著的离群值，以评估百分位数区间在偏度和重尾分布下的稳健性。\n\n最终输出格式规范：\n您的程序应生成单行输出，其中包含所有测试用例的置信区间列表，格式为一个由逗号分隔的双元素列表（每个区间为 $[\\text{lower}, \\text{upper}]$）组成的列表，并用方括号括起来。例如，输出应类似于 $[[l_1,u_1],[l_2,u_2],[l_3,u_3],[l_4,u_4]]$，所有数值条目均四舍五入到三位小数。不要在输出中打印单位；将所有数值解释为 ng/mL。",
            "solution": "问题陈述被评估为有效。它在科学上植根于非参数自助法这一既定理论，这是频率学派统计学中的一项基本技术。该问题是良定的，提供了所有必要的输入——数据、参数和随机种子——以确保得到唯一且可复现的结果。问题是客观的，使用了精确且无歧义的统计术语。\n\n目标是为一个连续生物标志物的总体均值 $\\theta = \\mathbb{E}_F[X]$ 计算一个 $(1-\\alpha)$ 非参数自助法百分位数置信区间。我们给定一组来自未知真实分布 $F$ 的 $n$ 个独立同分布 (IID) 观测值 $\\{x_1, \\dots, x_n\\}$。\n\n自助法的核心原理是通过从观测数据中重抽样来近似估计量的抽样分布。真实分布 $F$ 是未知的，因此我们使用其最佳可用估计，即经验分布函数 $\\hat{F}_n$。分布 $\\hat{F}_n$ 是一个离散分布，它为每个观测数据点 $x_i, i = 1, \\dots, n$ 分配 $1/n$ 的概率质量。\n\n构建自助法百分位数置信区间的步骤如下：\n\n1.  **自助重抽样**：我们生成大量的（$B$ 个）“自助样本”。每个自助样本，记为 $\\{x_1^*, \\dots, x_n^*\\}$，是通过从原始数据集 $\\{x_1, \\dots, x_n\\}$ 中有放回地抽取 $n$ 个观测值来创建的。这个过程等价于从经验分布 $\\hat{F}_n$ 中抽取一个大小为 $n$ 的独立同分布样本。\n\n2.  **估计量的自助复制**：对于 $B$ 个自助样本中的每一个，我们计算感兴趣的统计量。在本例中，该统计量是样本均值。令第 $b$ 个自助样本为 $\\{x_{b,1}^*, \\dots, x_{b,n}^*\\}$，其中 $b=1, \\dots, B$。对应的样本均值的自助复制值为：\n    $$\n    \\bar{X}_b^* = \\frac{1}{n} \\sum_{i=1}^n x_{b,i}^*\n    $$\n    此过程产生一个包含 $B$ 个自助均值的集合，即 $\\{\\bar{X}_1^*, \\bar{X}_2^*, \\dots, \\bar{X}_B^*\\}$。这个集合可作为样本均值估计量 $\\bar{X}$ 的抽样分布的经验近似。\n\n3.  **百分位数置信区间构建**：百分位数法直接从自助复制值的经验分布的分位数构建置信区间。对于 $(1-\\alpha)$ 的置信水平，置信区间由排序后的自助均值的 $\\alpha/2$ 和 $1 - \\alpha/2$ 分位数定义。令 $\\bar{X}_{(j)}^*$ 表示自助均值集合中的第 $j$ 个有序值。$\\theta$ 的 $(1-\\alpha)$ 百分位数置信区间由下式给出：\n    $$\n    \\left[ \\text{Quantile}_{\\bar{X}^*}\\left(\\frac{\\alpha}{2}\\right), \\text{Quantile}_{\\bar{X}^*}\\left(1 - \\frac{\\alpha}{2}\\right) \\right]\n    $$\n    在实践中，为了从 $B$ 个排序后的复制值中找到这些分位数，我们找到与期望概率相对应的秩处的值。例如，下界是秩近似为 $(\\alpha/2) \\times B$ 处的值，上界是秩近似为 $(1 - \\alpha/2) \\times B$ 处的值。标准的统计软件使用插值方法来为有限的 $B$ 提供更准确的分位数估计。\n\n实现将对每个测试用例遵循此算法。对于每个用例，将使用指定的种子初始化一个独立的随机数生成器，以确保可复现性。计算将进行向量化以提高效率。对于每个用例，我们将从数据中生成 $B \\times n$ 个随机选择，以形成 $B$ 个大小为 $n$ 的样本。然后我们计算这 $B$ 个样本中每个样本的均值。最后，我们确定这些均值分布的下分位数和上分位数来构成置信区间，并按要求将端点四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nonparametric bootstrap percentile confidence intervals for the mean\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (data, B, alpha, seed).\n    test_cases = [\n        ([2.1, 3.4, 3.0, 2.7, 4.2, 5.1, 3.8, 2.9, 3.2, 4.0], 5000, 0.05, 11),\n        ([2.4, 2.5, 2.6, 2.7, 2.8], 10000, 0.10, 123),\n        ([3.0, 3.0, 3.0, 3.0, 3.0], 3000, 0.05, 7),\n        ([2.0, 2.1, 2.2, 2.3, 10.0, 2.4, 2.5], 15000, 0.05, 2023)\n    ]\n\n    results = []\n    for data, B, alpha, seed in test_cases:\n        # Convert data to a numpy array for efficient computation.\n        data_array = np.array(data)\n        n = len(data_array)\n\n        # Initialize a random number generator with the specified seed for reproducibility.\n        rng = np.random.default_rng(seed)\n\n        # Generate B bootstrap samples of size n.\n        # This creates a (B, n) array where each row is a bootstrap sample.\n        bootstrap_samples = rng.choice(data_array, size=(B, n), replace=True)\n\n        # Compute the mean for each of the B bootstrap samples along the appropriate axis.\n        bootstrap_means = np.mean(bootstrap_samples, axis=1)\n\n        # Determine the quantile levels for the confidence interval.\n        q_lower = alpha / 2\n        q_upper = 1 - alpha / 2\n\n        # Calculate the lower and upper bounds of the confidence interval\n        # using the empirical quantiles of the bootstrap means.\n        ci_lower = np.quantile(bootstrap_means, q_lower)\n        ci_upper = np.quantile(bootstrap_means, q_upper)\n\n        # Round the endpoints to three decimal places as required.\n        interval = [round(ci_lower, 3), round(ci_upper, 3)]\n        results.append(interval)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is converted to a string\n    # and spaces are removed to match the specified output format '[[l1,u1],[l2,u2],...]'.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}