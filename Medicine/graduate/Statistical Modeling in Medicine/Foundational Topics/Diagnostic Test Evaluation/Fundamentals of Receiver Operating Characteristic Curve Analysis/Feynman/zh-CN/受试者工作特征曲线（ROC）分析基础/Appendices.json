{
    "hands_on_practices": [
        {
            "introduction": "ROC曲线本身展示了灵敏度与特异性之间的权衡，但并未指明哪一个权衡点是“最佳”的。在临床决策中，我们必须结合疾病的流行率以及错误诊断所带来的代价。本练习将引导您推导出一个能最小化预期成本的最优诊断阈值，从而展示如何将经济和流行病学因素整合到统计决策过程中。",
            "id": "4963859",
            "problem": "一项医学筛查测试输出一个连续的诊断分数 $S \\in \\mathbb{R}$。在目标临床人群中，疾病指标 $D \\in \\{0,1\\}$ 的患病率为 $P(D=1)=\\pi$，其中 $\\pi \\in (0,1)$。你采用一个阈值规则：当且仅当 $S \\ge \\tau$ 时，判定 $D=1$（存在疾病），其中 $\\tau \\in \\mathbb{R}$ 是一个待选的阈值。通过改变 $\\tau$ 可以得到受试者工作特征（ROC）曲线。\n\n假设分数的类别条件分布如下：\n- 在患病条件下，$S \\mid D=1 \\sim \\mathcal{N}(\\mu_{1},\\sigma^{2})$。\n- 在无病条件下，$S \\mid D=0 \\sim \\mathcal{N}(\\mu_{0},\\sigma^{2})$。\n\n此处 $\\mu_{1},\\mu_{0} \\in \\mathbb{R}$，$\\sigma > 0$，且 $\\mu_{1} > \\mu_{0}$。\n\n设定与单步筛查决策一致的决策成本：假阴性（漏诊）产生成本 $c_{\\mathrm{FN}}>0$，假阳性（不必要的随访）产生成本 $c_{\\mathrm{FP}}>0$，而正确决策的成本为零。利用构成受试者工作特征（ROC）曲线基础的灵敏度和特异度的标准定义，通过 $(S,D)$ 的联合分布，将每个被筛查个体的期望成本定义为阈值 $\\tau$ 的函数。\n\n仅从错误分类下的期望成本的基本定义和上述分布假设出发，推导使期望成本最小化的阈值 $\\tau^{\\star}$ 的闭式表达式，该表达式是关于 $\\mu_{0}$、$\\mu_{1}$、$\\sigma$、$c_{\\mathrm{FN}}$、$c_{\\mathrm{FP}}$ 和 $\\pi$ 的函数。将你的最终答案表示为包含这些符号的单一简化代数表达式。不需要进行数值评估，也不允许进行四舍五入。最终答案必须是单一的符号数学表达式。",
            "solution": "我们从连接二元分类性能与受试者工作特征（ROC）曲线和期望成本的定义开始。对于一个阈值 $\\tau \\in \\mathbb{R}$，该规则当且仅当 $S \\ge \\tau$ 时将类别判定为 $D=1$。假阴性概率为 $P(S  \\tau \\mid D=1)$，假阳性概率为 $P(S \\ge \\tau \\mid D=0)$。在患病率为 $P(D=1)=\\pi$ 和 $P(D=0)=1-\\pi$，且假阴性和假阳性决策的成本分别为 $c_{\\mathrm{FN}}0$ 和 $c_{\\mathrm{FP}}0$ 的情况下，每个个体的期望成本作为 $\\tau$ 的函数为\n$$\nR(\\tau) \\;=\\; c_{\\mathrm{FN}} \\,\\pi \\,P(S  \\tau \\mid D=1) \\;+\\; c_{\\mathrm{FP}} \\,(1-\\pi)\\,P(S\\ge \\tau \\mid D=0).\n$$\n在假设的高斯模型下，将类别条件累积分布函数（CDF）表示为\n$$\nF_{1}(\\tau) \\;=\\; P(S \\le \\tau \\mid D=1) \\;=\\; \\Phi\\!\\left(\\frac{\\tau-\\mu_{1}}{\\sigma}\\right), \\qquad\nF_{0}(\\tau) \\;=\\; P(S \\le \\tau \\mid D=0) \\;=\\; \\Phi\\!\\left(\\frac{\\tau-\\mu_{0}}{\\sigma}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。那么 $P(S  \\tau \\mid D=1)=F_{1}(\\tau)$（对于连续分布），且 $P(S\\ge\\tau \\mid D=0)=1-F_{0}(\\tau)$。期望成本变为\n$$\nR(\\tau) \\;=\\; c_{\\mathrm{FN}}\\,\\pi\\,F_{1}(\\tau) \\;+\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,\\bigl(1-F_{0}(\\tau)\\bigr).\n$$\n为了最小化关于 $\\tau$ 的 $R(\\tau)$，我们对 $\\tau$求导并令其导数等于零。累积分布函数的导数是其密度函数，因此对于类别条件密度函数\n$$\nf_{1}(\\tau) \\;=\\; \\frac{1}{\\sigma}\\,\\varphi\\!\\left(\\frac{\\tau-\\mu_{1}}{\\sigma}\\right), \\qquad\nf_{0}(\\tau) \\;=\\; \\frac{1}{\\sigma}\\,\\varphi\\!\\left(\\frac{\\tau-\\mu_{0}}{\\sigma}\\right),\n$$\n其中 $\\varphi$ 是标准正态密度函数，我们有\n$$\n\\frac{d}{d\\tau}R(\\tau) \\;=\\; c_{\\mathrm{FN}}\\,\\pi\\,f_{1}(\\tau) \\;-\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,f_{0}(\\tau).\n$$\n一个驻点 $\\tau^{\\star}$ 满足\n$$\nc_{\\mathrm{FN}}\\,\\pi\\,f_{1}(\\tau^{\\star}) \\;=\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,f_{0}(\\tau^{\\star}).\n$$\n重新整理得到似然比条件\n$$\n\\frac{f_{1}(\\tau^{\\star})}{f_{0}(\\tau^{\\star})} \\;=\\; \\frac{c_{\\mathrm{FP}}\\,(1-\\pi)}{c_{\\mathrm{FN}}\\,\\pi}.\n$$\n因为 $f_{1}$ 和 $f_{0}$ 是等方差的高斯密度函数，左侧是关于 $\\tau$ 的严格递增函数（因为 $\\mu_{1}\\mu_{0}$），这确保了存在唯一解来最小化 $R(\\tau)$。\n\n我们现在显式计算 $f_{1}(\\tau)/f_{0}(\\tau)$。类别条件密度函数为\n$$\nf_{1}(s) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(s-\\mu_{1})^{2}}{2\\sigma^{2}}\\right), \\qquad\nf_{0}(s) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(s-\\mu_{0})^{2}}{2\\sigma^{2}}\\right).\n$$\n因此，\n$$\n\\ln\\!\\left(\\frac{f_{1}(s)}{f_{0}(s)}\\right) \\;=\\; -\\frac{(s-\\mu_{1})^{2}}{2\\sigma^{2}} + \\frac{(s-\\mu_{0})^{2}}{2\\sigma^{2}}\n\\;=\\; \\frac{(\\mu_{1}-\\mu_{0})}{\\sigma^{2}}\\,s \\;-\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2\\sigma^{2}}.\n$$\n令 $s=\\tau^{\\star}$ 并使其等于 $\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right)$，得到\n$$\n\\frac{(\\mu_{1}-\\mu_{0})}{\\sigma^{2}}\\,\\tau^{\\star} \\;-\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2\\sigma^{2}} \\;=\\; \\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right).\n$$\n求解 $\\tau^{\\star}$ 得到\n$$\n\\tau^{\\star} \\;=\\; \\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\,\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right) \\;+\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2(\\mu_{1}-\\mu_{0})}.\n$$\n注意到 $\\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2(\\mu_{1}-\\mu_{0})}=\\frac{\\mu_{1}+\\mu_{0}}{2}$，我们得到简化的闭式形式\n$$\n\\tau^{\\star} \\;=\\; \\frac{\\mu_{1}+\\mu_{0}}{2} \\;+\\; \\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\,\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right).\n$$\n在给定的高斯分数模型、患病率 $\\pi$ 和错误分类成本下，这个 $\\tau^{\\star}$ 唯一地最小化了期望成本 $R(\\tau)$，并且在几何上对应于受试者工作特征（ROC）曲线上切线斜率等于 $\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}$ 的点。",
            "answer": "$$\\boxed{\\frac{\\mu_{1}+\\mu_{0}}{2}+\\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right)}$$"
        },
        {
            "introduction": "当错误分类的显性成本未知时，一种常见的统计方法是选择能最大化约登指数（Youden's index）的阈值，该指数衡量了ROC曲线上某点与机会线之间的垂直距离。本练习要求您在方差不等的通用双正态模型下推导此最优阈值。解决这个问题将揭示一个基本原理：最优阈值恰好位于两个类别条件概率密度函数的交点处。",
            "id": "4963858",
            "problem": "一个连续的诊断生物标志物 $X$ 被用于在一个队列中检测一种疾病。决策规则为：对于某个阈值 $t \\in \\mathbb{R}$，如果 $X \\ge t$，则将个体分类为检测阳性。在这个队列中，给定非患病条件下 $X$ 的条件分布是均值为 $\\mu_{0}$、方差为 $\\sigma_{0}^{2}$ 的正态分布，而给定患病条件下 $X$ 的条件分布是均值为 $\\mu_{1}$、方差为 $\\sigma_{1}^{2}$ 的正态分布。具体来说，假设 $X \\mid (D=0) \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$，其中 $\\mu_{0}=5$ 且 $\\sigma_{0}=1.5$；以及 $X \\mid (D=1) \\sim \\mathcal{N}(\\mu_{1},\\sigma_{1}^{2})$，其中 $\\mu_{1}=8$ 且 $\\sigma_{1}=2$。对于任意阈值 $t$，定义真阳性率 $\\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1)$、假阳性率 $\\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0)$，以及作为受试者工作特征（ROC）曲线的一个泛函的 Youden 指数 $J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$。\n\n仅从这些核心定义和给定的分布假设出发，推导出使 Youden 指数 $J(t)$ 最大化的阈值 $t^{\\star}$，并计算其在给定参数下的数值。不要假设方差相等，也不要使用任何未经证明的捷径。将你的最终数值答案四舍五入到四位有效数字。将你的答案表示为最优阈值 $t^{\\star}$（无单位）。",
            "solution": "问题是对于一个基于连续生物标志物 $X$ 的诊断测试，找到使 Youden 指数 $J(t)$ 最大化的阈值 $t^{\\star}$。\n\n首先，我们验证问题陈述。\n**步骤 1：提取已知条件**\n- 生物标志物：$X$\n- 决策规则：若 $X \\ge t$，则检测为阳性。\n- 非患病个体（$D=0$）的分布：$X \\mid (D=0) \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$，其中 $\\mu_{0}=5$ 且 $\\sigma_{0}=1.5$。\n- 患病个体（$D=1$）的分布：$X \\mid (D=1) \\sim \\mathcal{N}(\\mu_{1},\\sigma_{1}^{2})$，其中 $\\mu_{1}=8$ 且 $\\sigma_{1}=2$。\n- 真阳性率：$\\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1)$。\n- 假阳性率：$\\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0)$。\n- Youden 指数：$J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了统计决策理论和生物统计学中的标准定义和模型（正态分布、ROC 分析、Youden 指数）。这是一个适定问题，因为它要求最大化一个定义良好、连续且可微的函数。该问题是客观、自洽和一致的，提供了所有必要的参数和定义。参数值是现实的。这项任务并非微不足道，需要进行推导和计算，特别是因为方差不相等。该问题在数学上是可验证的。\n\n**步骤 3：结论与行动**\n问题被认为是有效的。我们可以继续进行求解。\n\n目标是找到 $t^{\\star} = \\arg\\max_{t} J(t)$。我们首先将 $J(t)$ 表示为解析形式。\n令 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0,1)$ 的累积分布函数（CDF）。一个正态随机变量 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 大于或等于值 $t$ 的概率由下式给出：\n$$ \\mathbb{P}(Y \\ge t) = 1 - \\mathbb{P}(Y  t) = 1 - \\Phi\\left(\\frac{t-\\mu}{\\sigma}\\right) $$\n利用这一点，我们可以为给定的分布定义 $\\mathrm{TPR}(t)$ 和 $\\mathrm{FPR}(t)$。\n\n对于患病人群，$X_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$:\n$$ \\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1) = 1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) $$\n对于非患病人群，$X_0 \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$:\n$$ \\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0) = 1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) $$\n现在，我们可以写出 Youden 指数 $J(t)$ 的表达式：\n$$ J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t) = \\left(1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right)\\right) - \\left(1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right)\\right) $$\n$$ J(t) = \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) $$\n为了找到使 $J(t)$ 最大化的阈值 $t$，我们计算其关于 $t$ 的导数，并令其为零。令 $\\phi(z)$ 为标准正态分布的概率密度函数（PDF），它是其 CDF 的导数，即 $\\frac{d\\Phi(z)}{dz} = \\phi(z)$。使用链式法则：\n$$ \\frac{dJ}{dt} = \\frac{d}{dt}\\left[\\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right)\\right] - \\frac{d}{dt}\\left[\\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right)\\right] $$\n$$ \\frac{dJ}{dt} = \\phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) \\cdot \\frac{1}{\\sigma_0} - \\phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) \\cdot \\frac{1}{\\sigma_1} $$\n项 $\\frac{1}{\\sigma} \\phi\\left(\\frac{t-\\mu}{\\sigma}\\right)$ 是一般正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的 PDF，我们将其记为 $f(t; \\mu, \\sigma^2)$。因此，我们可以将导数写为：\n$$ \\frac{dJ}{dt} = f(t; \\mu_0, \\sigma_0^2) - f(t; \\mu_1, \\sigma_1^2) $$\n将导数设为零以找到临界点 $t^{\\star}$：\n$$ f(t^{\\star}; \\mu_0, \\sigma_0^2) = f(t^{\\star}; \\mu_1, \\sigma_1^2) $$\n这个结果表明，Youden 指数的最优阈值是两个类别的概率密度函数相交处的 $t$ 值。现在我们求解这个方程以得到 $t^{\\star}$。\n$$ \\frac{1}{\\sigma_0\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2}\\right) = \\frac{1}{\\sigma_1\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2}\\right) $$\n对两边取自然对数：\n$$ \\ln\\left(\\frac{1}{\\sigma_0}\\right) - \\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2} = \\ln\\left(\\frac{1}{\\sigma_1}\\right) - \\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2} $$\n重新整理各项可得：\n$$ \\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2} - \\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2} = \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\n乘以 $2\\sigma_0^2\\sigma_1^2$ 以消去分母：\n$$ \\sigma_0^2(t^{\\star}-\\mu_1)^2 - \\sigma_1^2(t^{\\star}-\\mu_0)^2 = 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\n展开平方项：\n$$ \\sigma_0^2(t^{\\star 2} - 2\\mu_1 t^{\\star} + \\mu_1^2) - \\sigma_1^2(t^{\\star 2} - 2\\mu_0 t^{\\star} + \\mu_0^2) = 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\n按 $t^{\\star}$ 的幂次对各项进行分组，我们得到一个二次方程 $At^{\\star 2} + Bt^{\\star} + C = 0$：\n$$ (\\sigma_0^2 - \\sigma_1^2)t^{\\star 2} + 2(\\mu_0\\sigma_1^2 - \\mu_1\\sigma_0^2)t^{\\star} + (\\mu_1^2\\sigma_0^2 - \\mu_0^2\\sigma_1^2 - 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right)) = 0 $$\n系数为：\n$A = \\sigma_0^2 - \\sigma_1^2$\n$B = 2(\\mu_0\\sigma_1^2 - \\mu_1\\sigma_0^2)$\n$C = \\mu_1^2\\sigma_0^2 - \\mu_0^2\\sigma_1^2 - 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right)$\n\n现在，我们代入给定的数值：$\\mu_{0}=5$，$\\sigma_{0}=1.5$，$\\mu_{1}=8$，$\\sigma_{1}=2$。\n$\\sigma_0^2 = (1.5)^2 = 2.25$\n$\\sigma_1^2 = (2)^2 = 4$\n\n$A = 2.25 - 4 = -1.75$\n$B = 2(5 \\cdot 4 - 8 \\cdot 2.25) = 2(20 - 18) = 4$\n$C = 8^2 \\cdot 2.25 - 5^2 \\cdot 4 - 2(2.25)(4) \\ln\\left(\\frac{1.5}{2}\\right) = 64 \\cdot 2.25 - 25 \\cdot 4 - 18 \\ln(0.75)$\n$C = 144 - 100 - 18 \\ln(0.75) = 44 - 18 \\ln(0.75)$\n\n使用 $\\ln(0.75) \\approx -0.28768$:\n$C \\approx 44 - 18(-0.28768) \\approx 44 + 5.17824 = 49.17824$\n\n$t^{\\star}$ 的二次方程为：\n$$ -1.75t^{\\star 2} + 4t^{\\star} + 49.17824 = 0 $$\n我们使用二次公式 $t^{\\star} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $t^{\\star}$：\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{4^2 - 4(-1.75)(49.17824)}}{2(-1.75)}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{16 + 7(49.17824)}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{16 + 344.24768}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{360.24768}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm 18.98019}{-3.5}$\n\n这给出了两个解：\n$t_1^{\\star} = \\frac{-4 + 18.98019}{-3.5} = \\frac{14.98019}{-3.5} \\approx -4.28005$\n$t_2^{\\star} = \\frac{-4 - 18.98019}{-3.5} = \\frac{-22.98019}{-3.5} \\approx 6.56577$\n\n由于非患病人群和患病人群的均值分别为 $\\mu_0 = 5$ 和 $\\mu_1 = 8$，且患病人群的生物标志物均值较高，因此最优阈值 $t^{\\star}$ 预期会落在这两个值之间。解 $t_1^{\\star} \\approx -4.28$ 在此情境下没有医学或统计学意义。解 $t_2^{\\star} \\approx 6.566$ 位于 5 和 8 之间。对 $J(t)$ 的二阶导数进行正式分析可以证实，$t_2^{\\star}$ 对应于 Youden 指数的最大值，而 $t_1^{\\star}$ 对应于最小值。因此，最优阈值为 $t^{\\star} = t_2^{\\star}$。\n\n将结果四舍五入到四位有效数字：\n$t^{\\star} \\approx 6.566$",
            "answer": "$$\\boxed{6.566}$$"
        },
        {
            "introduction": "评估诊断测试性能并非总是为了寻找单一的最优阈值；有时，我们更需要评估其在特定临床关注范围内的表现，例如在极低假阳性率的区间。本练习将引入部分曲线下面积（pAUC）的概念，特别是其加权形式，以便将评估重点放在ROC曲线的关键部分。通过处理一个指数分布模型，您将练习为非正态数据推导ROC曲线，并计算这一高级汇总指标。",
            "id": "4963883",
            "problem": "在一项旨在评估一种用于疾病早期检测的连续正值血清生物标志物的病例对照研究中，假设生物标志物水平 $S$ 在患病人群（$D=1$）和非患病人群（$D=0$）中均服从指数分布：$S \\mid D=1 \\sim \\text{Exp}(\\lambda_{1})$ 和 $S \\mid D=0 \\sim \\text{Exp}(\\lambda_{0})$，其中 $\\text{Exp}(\\lambda)$ 表示率参数为 $\\lambda$ 且支撑集为 $[0,\\infty)$ 的指数分布。如果一个人的生物标志物水平 $S \\geq c$（其中 $c \\geq 0$ 为阈值），则该测试将其分类为阳性。受试者工作特征（ROC）曲线定义为当 $c$ 在 $[0,\\infty)$ 上变化时，点对 $\\big(\\text{FPR}(c), \\text{TPR}(c)\\big)$ 的轨迹，其中假阳性率（FPR）为 $\\text{FPR}(c) = \\mathbb{P}(S \\geq c \\mid D=0)$，真阳性率（TPR）为 $\\text{TPR}(c) = \\mathbb{P}(S \\geq c \\mid D=1)$。\n\n一份临床指南强调低假阳性率范围，特别是 $\\text{FPR} \\in [0,\\alpha]$ 且 $\\alpha = 0.1$ 的情况，并对假阳性率 $u$ 采用权重函数 $w(u) = u^{r}(1-u)^{s}$（其中 $r = \\tfrac{1}{2}$，$s = 2$），以反映在 $u=0$ 附近的重要性更高，而在 $u=\\alpha$ 附近重要性逐渐减弱。将 $[0,\\alpha]$ 上ROC曲线下的归一化加权部分面积定义为\n$$\n\\text{W-pAUC}(\\alpha; w) \\equiv \\frac{\\displaystyle \\int_{0}^{\\alpha} \\text{ROC}(u)\\, w(u)\\, \\mathrm{d}u}{\\displaystyle \\int_{0}^{\\alpha} w(u)\\, \\mathrm{d}u},\n$$\n其中 $\\text{ROC}(u)$ 是表示为假阳性率 $u$ 的函数的真阳性率。\n\n取 $\\lambda_{1} = 0.7$ 和 $\\lambda_{0} = 1.4$。仅从指数模型的 $\\text{FPR}(c)$ 和 $\\text{TPR}(c)$ 的定义以及ROC曲线是 $\\text{TPR}$ 随不同阈值下的 $\\text{FPR}$ 变化的定义出发，推导该模型中 $\\text{ROC}(u)$ 的函数形式，并使用给定的 $w(u)$ 计算归一化加权部分面积 $\\text{W-pAUC}(0.1; w)$，给出最终数值。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它科学地基于统计建模和受试者工作特征（ROC）分析的原理，定义良好，提供了所有必要的定义和参数，并且表达客观、没有歧义。任务是为一个使用指数分布建模的生物标志物计算ROC曲线下的归一化加权部分面积（W-pAUC）。\n\n解题过程分为五个步骤：(1) 推导作为诊断阈值 $c$ 的函数的真阳性率（TPR）和假阳性率（FPR）；(2) 通过将TPR表示为FPR的函数来推导ROC曲线；(3) 计算W-pAUC表达式的分子，即加权部分面积；(4) 计算分母，即权重函数的积分；以及 (5) 计算最终的比率。\n\n**步骤1：推导 $\\text{TPR}(c)$ 和 $\\text{FPR}(c)$**\n\n生物标志物水平 $S$ 由指数分布 $\\text{Exp}(\\lambda)$ 建模，其概率密度函数（PDF）为 $f(s; \\lambda) = \\lambda \\exp(-\\lambda s)$（对于 $s \\geq 0$），累积分布函数（CDF）为 $F(s; \\lambda) = \\mathbb{P}(S \\leq s) = 1 - \\exp(-\\lambda s)$。生物标志物水平超过阈值 $c$ 的概率由生存函数给出：\n$$ \\mathbb{P}(S \\geq c) = 1 - F(c; \\lambda) = 1 - (1 - \\exp(-\\lambda c)) = \\exp(-\\lambda c) $$\n假阳性率 $\\text{FPR}(c)$ 是在非患病人群（$D=0$）中出现阳性测试结果（$S \\geq c$）的概率，该人群由 $S \\mid D=0 \\sim \\text{Exp}(\\lambda_{0})$ 建模。\n$$ \\text{FPR}(c) = \\mathbb{P}(S \\geq c \\mid D=0) = \\exp(-\\lambda_{0} c) $$\n真阳性率 $\\text{TPR}(c)$ 是在患病人群（$D=1$）中出现阳性测试结果（$S \\geq c$）的概率，该人群由 $S \\mid D=1 \\sim \\text{Exp}(\\lambda_{1})$ 建模。\n$$ \\text{TPR}(c) = \\mathbb{P}(S \\geq c \\mid D=1) = \\exp(-\\lambda_{1} c) $$\n\n**步骤2：推导ROC曲线 $\\text{ROC}(u)$**\n\nROC曲线是 $\\text{TPR}$ 对 $\\text{FPR}$ 的图。我们将 $\\text{TPR}$ 表示为 $\\text{FPR}$ 的函数。令 $u = \\text{FPR}(c)$。\n$$ u = \\exp(-\\lambda_{0} c) $$\n为了用 $u$ 表示 $\\text{TPR}$，我们首先解出阈值 $c$：\n$$ \\ln(u) = -\\lambda_{0} c \\implies c = -\\frac{\\ln(u)}{\\lambda_{0}} $$\n注意，当阈值 $c$ 从 $\\infty$ 变化到 $0$ 时，$u$ 从 $0$ 变化到 $1$。\n现在，将 $c$ 的这个表达式代入 $\\text{TPR}$ 的方程中：\n$$ \\text{TPR} = \\exp(-\\lambda_{1} c) = \\exp\\left(-\\lambda_{1} \\left(-\\frac{\\ln(u)}{\\lambda_{0}}\\right)\\right) = \\exp\\left(\\frac{\\lambda_{1}}{\\lambda_{0}} \\ln(u)\\right) $$\n利用属性 $\\exp(a \\ln b) = b^a$，我们得到ROC曲线的函数形式：\n$$ \\text{ROC}(u) = u^{\\lambda_{1}/\\lambda_{0}} $$\n给定参数值 $\\lambda_{1} = 0.7$ 和 $\\lambda_{0} = 1.4$，比率为 $\\frac{\\lambda_{1}}{\\lambda_{0}} = \\frac{0.7}{1.4} = \\frac{1}{2}$。\n因此，该模型的特定ROC曲线为：\n$$ \\text{ROC}(u) = u^{1/2} $$\n\n**步骤3：计算分子积分**\n\n$\\text{W-pAUC}$ 表达式的分子是 $N = \\int_{0}^{\\alpha} \\text{ROC}(u)\\, w(u)\\, \\mathrm{d}u$。\n给定的权重函数为 $w(u) = u^{r}(1-u)^{s}$，其中 $r = \\frac{1}{2}$，$s=2$，所以 $w(u) = u^{1/2}(1-u)^2$。积分上限为 $\\alpha = 0.1$。\n代入 $\\text{ROC}(u)$ 和 $w(u)$ 的表达式：\n$$ N = \\int_{0}^{0.1} \\left(u^{1/2}\\right) \\left(u^{1/2}(1-u)^2\\right) \\mathrm{d}u = \\int_{0}^{0.1} u(1-u)^2 \\mathrm{d}u $$\n展开被积函数：\n$$ N = \\int_{0}^{0.1} u(1 - 2u + u^2) \\mathrm{d}u = \\int_{0}^{0.1} (u - 2u^2 + u^3) \\mathrm{d}u $$\n进行积分：\n$$ N = \\left[ \\frac{1}{2}u^2 - \\frac{2}{3}u^3 + \\frac{1}{4}u^4 \\right]_{0}^{0.1} $$\n计算定积分：\n$$ N = \\left(\\frac{1}{2}(0.1)^2 - \\frac{2}{3}(0.1)^3 + \\frac{1}{4}(0.1)^4\\right) - 0 $$\n$$ N = \\frac{1}{2}(0.01) - \\frac{2}{3}(0.001) + \\frac{1}{4}(0.0001) = 0.005 - \\frac{0.002}{3} + 0.000025 $$\n$$ N = \\frac{5}{1000} - \\frac{2}{3000} + \\frac{25}{1000000} = \\frac{1}{200} - \\frac{1}{1500} + \\frac{1}{40000} $$\n使用公分母 $120000$：\n$$ N = \\frac{600}{120000} - \\frac{80}{120000} + \\frac{3}{120000} = \\frac{523}{120000} $$\n\n**步骤4：计算分母积分**\n\n$\\text{W-pAUC}$ 表达式的分母是 $D = \\int_{0}^{\\alpha} w(u)\\, \\mathrm{d}u$。\n$$ D = \\int_{0}^{0.1} u^{1/2}(1-u)^2 \\mathrm{d}u $$\n展开被积函数：\n$$ D = \\int_{0}^{0.1} u^{1/2}(1 - 2u + u^2) \\mathrm{d}u = \\int_{0}^{0.1} (u^{1/2} - 2u^{3/2} + u^{5/2}) \\mathrm{d}u $$\n进行积分：\n$$ D = \\left[ \\frac{u^{3/2}}{3/2} - 2\\frac{u^{5/2}}{5/2} + \\frac{u^{7/2}}{7/2} \\right]_{0}^{0.1} = \\left[ \\frac{2}{3}u^{3/2} - \\frac{4}{5}u^{5/2} + \\frac{2}{7}u^{7/2} \\right]_{0}^{0.1} $$\n计算定积分：\n$$ D = \\frac{2}{3}(0.1)^{3/2} - \\frac{4}{5}(0.1)^{5/2} + \\frac{2}{7}(0.1)^{7/2} - 0 $$\n$$ D = \\frac{2}{3}(0.1)^{1.5} - \\frac{4}{5}(0.1)^{2.5} + \\frac{2}{7}(0.1)^{3.5} $$\n\n**步骤5：计算最终比率并四舍五入**\n\n归一化加权部分AUC是比率 $N/D$：\n$$ \\text{W-pAUC}(0.1; w) = \\frac{N}{D} = \\frac{\\frac{523}{120000}}{\\frac{2}{3}(0.1)^{1.5} - \\frac{4}{5}(0.1)^{2.5} + \\frac{2}{7}(0.1)^{3.5}} $$\n现在，我们计算数值。\n分子是 $N = \\frac{523}{120000} \\approx 0.004358333$。\n分母是：\n$D \\approx \\frac{2}{3}(0.03162278) - \\frac{4}{5}(0.00316228) + \\frac{2}{7}(0.00031623)$\n$D \\approx 0.02108185 - 0.00252982 + 0.00009035 \\approx 0.01864238$\n最终比率是：\n$$ \\text{W-pAUC}(0.1; w) \\approx \\frac{0.004358333}{0.01864238} \\approx 0.23378531 $$\n将结果四舍五入到四位有效数字得到 $0.2338$。",
            "answer": "$$\\boxed{0.2338}$$"
        }
    ]
}