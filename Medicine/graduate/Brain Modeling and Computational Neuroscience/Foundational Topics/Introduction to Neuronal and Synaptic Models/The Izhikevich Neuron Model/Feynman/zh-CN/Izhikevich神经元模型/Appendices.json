{
    "hands_on_practices": [
        {
            "introduction": "理论分析是理解任何神经元模型行为的基石。在我们将模型付诸计算机模拟之前，通过解析其方程，我们可以揭示其内在的动力学特性，例如兴奋性的阈值。本练习将指导你通过分析模型的子阈值动力学来精确计算Izhikevich模型的“基电流”（rheobase current），即引发神经元发放第一个脉冲所需的最小恒定输入电流。这个计算直接关联到鞍结分岔（saddle-node bifurcation）这一重要的动力学概念，它标志着神经元静息态的消失和向脉冲发放的转变。",
            "id": "4029523",
            "problem": "考虑 Izhikevich 神经元模型，该模型通过以下常微分方程组描述膜电位动力学和恢复变量：\n$$\\frac{dv}{dt} = 0.04\\,v^{2} + 5\\,v + 140 - u + I,$$\n$$\\frac{du}{dt} = a\\,(b\\,v - u),$$\n其峰电位发放和重置由峰后条件定义：当 $v$ 达到一个阈值时，膜电位和恢复变量将重置为 $v \\leftarrow c$ 和 $u \\leftarrow u + d$。假设注入电流 $I$ 为常数，并关注在任何峰电位重置之前，连续动力学不动点的存在与消失。\n\n一组表现出 I 型兴奋性（通过不变圆上的鞍节点 (SNIC) 分岔产生）的参数集由下式给出：\n$$a = 0.02,\\quad b = 0.2,\\quad c = -65,\\quad d = 8.$$\n利用自治动力学系统中不动点的定义，以及鞍节点分岔的必要条件（即平衡点合并，同时简化后的平衡条件的判别式为零），计算基强度电流 $I_{\\text{rh}}$，此处定义为使亚阈值动力学的静息不动点消失的最小恒定电流 $I$。以模型的归一化电流单位报告 $I_{\\text{rh}}$ 的精确值（无需单位换算）。无需四舍五入，请提供精确结果。",
            "solution": "本题要求计算在特定参数集下 Izhikevich 神经元模型的基强度电流 $I_{\\text{rh}}$。基强度电流被定义为使亚阈值动力学的不动点消失的最小恒定输入电流 $I$。这种消失是通过鞍节点分岔发生的。\n\nIzhikevich 模型的动力学由以下常微分方程组描述：\n$$\n\\frac{dv}{dt} = 0.04\\,(v^*)^{2} + 5\\,v^* + 140 - u^* + I\n$$\n$$\n\\frac{du}{dt} = a\\,(b\\,v^* - u^*)\n$$\n与亚阈值动力学相关的参数为 $a = 0.02$ 和 $b = 0.2$。重置参数 $c = -65$ 和 $d = 8$ 不参与不动点的分析。\n\n系统的一个不动点，或称平衡点，$(v^*, u^*)$ 是时间导数为零的点。因此，我们必须求解以下代数方程组：\n$$\n\\frac{dv}{dt} = 0 \\implies 0.04\\,(v^*)^{2} + 5\\,v^* + 140 - u^* + I = 0\n$$\n$$\n\\frac{du}{dt} = 0 \\implies a\\,(b\\,v^* - u^*) = 0\n$$\n\n由第二个方程，因为参数 $a = 0.02 \\neq 0$，我们必有：\n$$\nb\\,v^* - u^* = 0\n$$\n这意味着在任何不动点处，恢复变量 $u^*$ 都是膜电位 $v^*$ 的线性函数：\n$$\nu^* = b\\,v^*\n$$\n该方程定义了系统的 $u$-零斜线。\n\n为了求出不动点处的 $v^*$ 值，我们将 $u^*$ 的表达式代入第一个方程（$v$-零斜线）：\n$$\n0.04\\,(v^*)^{2} + 5\\,v^* + 140 - (b\\,v^*) + I = 0\n$$\n合并包含 $v^*$ 的项，我们得到一个关于 $v^*$ 的一元二次方程：\n$$\n0.04\\,(v^*)^{2} + (5 - b)\\,v^* + (140 + I) = 0\n$$\n这个二次方程的根对应于系统不动点的膜电位值。实根的数量，即不动点的数量，由这个二次方程的判别式决定。一个标准形式为 $Ax^2+Bx+C=0$ 的二次方程，其判别式为 $\\Delta = B^2-4AC$。在我们的例子中，系数为：\n$$\nA = 0.04\n$$\n$$\nB = 5 - b\n$$\n$$\nC = 140 + I\n$$\n当 $\\Delta > 0$ 时，系统有两个不同的不动点；当 $\\Delta = 0$ 时，有一个不动点；当 $\\Delta  0$ 时，没有实数不动点。不动点的消失对应于从 $\\Delta > 0$ 到 $\\Delta  0$ 的转变。定义鞍节点分岔的边界情况，恰好发生在判别式为零时。\n$$\n\\Delta = (5 - b)^2 - 4(0.04)(140 + I) = 0\n$$\n我们被要求找出基强度电流 $I_{\\text{rh}}$，它是满足此湮灭条件的 $I$ 值。现在我们可以代入给定的参数值 $b = 0.2$：\n$$\n(5 - 0.2)^2 - 4(0.04)(140 + I_{\\text{rh}}) = 0\n$$\n$$\n(4.8)^2 - 0.16(140 + I_{\\text{rh}}) = 0\n$$\n现在，我们计算平方并进行化简：\n$$\n23.04 - 0.16(140 + I_{\\text{rh}}) = 0\n$$\n重新整理方程以求解 $I_{\\text{rh}}$：\n$$\n23.04 = 0.16(140 + I_{\\text{rh}})\n$$\n两边同除以 $0.16$：\n$$\n\\frac{23.04}{0.16} = 140 + I_{\\text{rh}}\n$$\n除法运算得出：\n$$\n144 = 140 + I_{\\text{rh}}\n$$\n最后，求解 $I_{\\text{rh}}$：\n$$\nI_{\\text{rh}} = 144 - 140 = 4\n$$\n因此，在模型的归一化电流单位下，静息不动点通过鞍节点分岔消失时的基强度电流为 $4$。当 $I  4$ 时，系统有两个不动点（一个代表静息态的稳定节点和一个鞍点）。当 $I > 4$ 时，系统没有不动点，膜电位将（在亚阈值动力学的背景下）无界增长，从而导致峰电位的发放。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "在掌握了模型的解析基础后，下一步是将其转化为动态的计算机模拟。通过数值积分，我们可以观察模型在时间上演化出的丰富发放模式，这对于验证模型能否复现真实神经元的行为至关重要。此练习要求你编写程序，使用简单的欧拉法模拟一个“常规发放”（regular spiking）神经元，并计算其脉冲间期（ISI），进而量化一个关键的生理现象——脉冲频率适应（spike-frequency adaptation）。",
            "id": "4064812",
            "problem": "设计并实现一个程序，用于模拟常规脉冲 (RS) 模式下的 Izhikevich 脉冲神经元，并计算脉冲间期 (ISI) 和适应性比率。请使用以下定义，这些是 Izhikevich 模型的基础。膜电位由 $v$ 表示（单位为 $\\mathrm{mV}$），恢复变量由 $u$ 表示（无量纲），外部施加的电流由 $I$ 表示（单位为与模型一致的电流单位，能使 $v$ 的单位为 $\\mathrm{mV}$，时间的单位为 $\\mathrm{ms}$）。Izhikevich 模型由以下常微分方程 (ODE) 组控制：\n$$\n\\frac{dv}{dt} = 0.04v^2 + 5v + 140 - u + I, \\quad \\frac{du}{dt} = a(bv - u),\n$$\n当膜电位达到脉冲阈值时，应用脉冲后重置条件：\n$$\n\\text{如果 } v \\ge 30 \\text{ (单位 } \\mathrm{mV}\\text{)}, \\text{ 则设置 } v \\leftarrow c \\text{ 且 } u \\leftarrow u + d.\n$$\n假设初始条件为 $v(0)=c$ 和 $u(0)=bv(0)$。使用固定步长显式欧拉法进行模拟，时间步长为 $\\Delta t$（单位为 $\\mathrm{ms}$），并在每个时间步内通过线性插值实现脉冲事件检测：如果 $v$ 在一个步长内从下方穿过脉冲阈值，则通过对步长前后的 $v$ 值进行线性插值来估计脉冲时间 $t_{\\text{spike}}$（单位为 $\\mathrm{ms}$）。每个步长内仅使用第一次穿越，并立即在该步长应用重置规则。\n\n将脉冲间期 (ISI) 定义为连续脉冲时间之差，单位为毫秒。适应性比率定义为比值 $\\text{ISI}_1/\\text{ISI}_5$，其中 $\\text{ISI}_k$ 表示第 $k$ 个 ISI（按出现顺序）。如果在模拟窗口内发生的脉冲少于 $6$ 次，则将适应性比率定义为 $\\mathrm{nan}$ (非数字)。\n\n所有时间必须以 $\\mathrm{ms}$ 表示，电压以 $\\mathrm{mV}$ 表示，适应性比率为无量纲。您的程序必须计算以下测试套件的结果，并生成单行输出，其中包含每个测试用例的适应性比率，格式为方括号内以逗号分隔的列表，例如：\n$[\\text{ratio}_1,\\text{ratio}_2,\\text{ratio}_3]$。将每个比率四舍五入到小数点后 $6$ 位。如果比率未定义，则在其位置输出 $\\mathrm{nan}$。\n\n测试套件（所有用例均使用 RS 参数）：\n- 常规脉冲 (RS) 参数：$(a,b,c,d) = (0.02,0.2,-65,8)$。\n- 脉冲阈值：$30 \\,\\mathrm{mV}$。\n\n用例：\n- 用例 A (正常路径)：恒定电流 $I=14$，总模拟时间 $T=1000 \\,\\mathrm{ms}$，时间步长 $\\Delta t = 0.1 \\,\\mathrm{ms}$。\n- 用例 B (低电流边界)：恒定电流 $I=5$，总模拟时间 $T=1000 \\,\\mathrm{ms}$，时间步长 $\\Delta t = 0.1 \\,\\mathrm{ms}$。\n- 用例 C (高电流与更小步长)：恒定电流 $I=30$，总模拟时间 $T=500 \\,\\mathrm{ms}$，时间步长 $\\Delta t = 0.05 \\,\\mathrm{ms}$。\n\n对于每个用例，计算前五个脉冲间期（单位为 $\\mathrm{ms}$），然后计算适应性比率 $\\text{ISI}_1/\\text{ISI}_5$。要求的最终输出格式为单行：\n$[\\text{ratio}_A,\\text{ratio}_B,\\text{ratio}_C]$\n其中每个数值四舍五入到小数点后 $6$ 位，当窗口内脉冲少于 $6$ 次时使用 $\\mathrm{nan}$。不应打印其他任何文本。",
            "solution": "用户希望模拟 Izhikevich 神经元模型，特别是常规脉冲 (RS) 模式，并根据产生的脉冲序列计算脉冲适应性比率。\n\n### 步骤 1：问题验证\n\n首先，我将根据指定的标准验证问题陈述。\n\n#### 已知条件提取\n\n-   **模型方程**:\n    $$\n    \\frac{dv}{dt} = 0.04v^2 + 5v + 140 - u + I\n    $$\n    $$\n    \\frac{du}{dt} = a(bv - u)\n    $$\n-   **状态变量**: $v$ (膜电位, $\\mathrm{mV}$)，$u$ (恢复变量, 无量纲)。\n-   **输入电流**: $I$。\n-   **脉冲重置条件**: 如果 $v \\ge 30 \\, \\mathrm{mV}$，则 $v \\leftarrow c$ 且 $u \\leftarrow u + d$。\n-   **初始条件**: $v(0)=c$, $u(0)=bv(0)$。\n-   **模拟方法**: 固定步长显式欧拉法，时间步长为 $\\Delta t$。\n-   **脉冲检测**: 当 $v$ 在一个时间步内从下方穿过阈值 $30 \\, \\mathrm{mV}$ 时，使用线性插值计算脉冲时间 $t_{\\text{spike}}$。重置应“在该步长”应用。\n-   **定义**:\n    -   脉冲间期 (ISI): 连续脉冲之间的时间差。\n    -   适应性比率: $\\text{ISI}_1/\\text{ISI}_5$。如果脉冲少于 $6$ 次，值为 $\\mathrm{nan}$。\n-   **参数**:\n    -   常规脉冲 (RS): $(a,b,c,d) = (0.02, 0.2, -65, 8)$。\n    -   脉冲阈值: $30 \\, \\mathrm{mV}$。\n-   **测试用例**:\n    -   用例 A: $I=14$, $T=1000 \\, \\mathrm{ms}$, $\\Delta t = 0.1 \\, \\mathrm{ms}$。\n    -   用例 B: $I=5$, $T=1000 \\, \\mathrm{ms}$, $\\Delta t = 0.1 \\, \\mathrm{ms}$。\n    -   用例 C: $I=30$, $T=500 \\, \\mathrm{ms}$, $\\Delta t = 0.05 \\, \\mathrm{ms}$。\n-   **输出格式**: 单行 `[ratio_A,ratio_B,ratio_C]`，比率四舍五入到小数点后 $6$ 位，并在适当位置包含 `nan`。\n\n#### 验证分析\n\n1.  **科学严谨性**: 该问题基于 Izhikevich 神经元模型，这是计算神经科学领域的一块基石，发表于一篇被高度引用的 2003 年论文。其参数和行为（常规脉冲）是标准且有据可查的。该问题在科学上是合理的。\n2.  **适定性**: 问题提供了一整套微分方程、初始条件、参数和指定的数值方法（显式欧拉法）。这确保了可以计算出唯一的数值解。所需的输出基于模拟结果有明确的定义。\n3.  **客观性**: 问题使用精确的数学和计算语言进行陈述。所有参数和条件都以客观的数值给出。\n4.  **完整性和一致性**: 提供了所有必要信息。变量、参数和单位（$\\mathrm{mV}$、$\\mathrm{ms}$）在整个问题描述中保持一致。\n5.  **无其他缺陷**: 问题不琐碎、不含比喻，也不超出科学可验证的范围。它是科学领域中一个标准的数值模拟任务。\n\n#### 结论\n\n该问题是**有效的**。它是一个在计算神经科学领域中定义明确的任务，需要实现一种标准的数值方法来模拟一个著名的模型。\n\n### 步骤 2：解决方案设计与实现\n\n解决方案涉及使用显式欧拉法对给定的两个常微分方程 (ODE) 组进行数值积分，同时处理指定的脉冲和重置条件。\n\n#### 数值方法：显式欧拉法\n\n显式欧拉法基于系统在时间 $t$ 的状态及其变化率来近似计算时间 $t + \\Delta t$ 的状态。对于我们的系统 $(v, u)$，单个时间步 $\\Delta t$ 的更新规则是：\n$$\nv_{n+1} = v_n + \\Delta t \\cdot \\left( \\frac{dv}{dt} \\right)\\bigg|_{t_n} = v_n + \\Delta t \\cdot (0.04v_n^2 + 5v_n + 140 - u_n + I)\n$$\n$$\nu_{n+1} = u_n + \\Delta t \\cdot \\left( \\frac{du}{dt} \\right)\\bigg|_{t_n} = u_n + \\Delta t \\cdot a(bv_n - u_n)\n$$\n这里，$(v_n, u_n)$ 表示步长开始时（时间 $t_n$）的状态，而 $(v_{n+1}, u_{n+1})$ 是步长结束时（时间 $t_{n+1} = t_n + \\Delta t$）的暂定状态。\n\n#### 模拟算法\n\n对于每个测试用例，模拟过程如下：\n1.  **初始化**:\n    -   为特定用例设置参数 $(a,b,c,d,I,T,\\Delta t)$。\n    -   在时间 $t=0$ 初始化状态变量：$v \\leftarrow c$ 和 $u \\leftarrow b \\cdot c$。\n    -   初始化一个空列表 `spike_times`，用于存储脉冲发生的时间。\n\n2.  **时间步长循环**: 模拟以固定的时间步长 $\\Delta t$ 迭代总时间 $T$。在每一步中，从当前时间 $t$ 和状态 $(v, u)$ 开始：\n    -   将当前电压存储为 $v_{\\text{old}} \\leftarrow v$。\n    -   使用上述显式欧拉公式计算时间 $t+\\Delta t$ 的暂定下一状态 $(v_{\\text{next}}, u_{\\text{next}})$。\n    -   **脉冲检测**: 检查膜电位是否从下方穿过了脉冲阈值 $v_{\\text{thresh}} = 30 \\, \\mathrm{mV}$。该条件是 $v_{\\text{old}}  v_{\\text{thresh}}$ 且 $v_{\\text{next}} \\ge v_{\\text{thresh}}$。\n    -   **状态更新**:\n        -   **如果检测到脉冲**:\n            1.  精确的脉冲时间 $t_{\\text{spike}}$ 通过在点 $(t, v_{\\text{old}})$ 和 $(t+\\Delta t, v_{\\text{next}})$ 之间进行线性插值来估计：\n                $$\n                t_{\\text{spike}} = t + \\Delta t \\frac{v_{\\text{thresh}} - v_{\\text{old}}}{v_{\\text{next}} - v_{\\text{old}}}\n                $$\n            2.  将此 $t_{\\text{spike}}$ 附加到 `spike_times` 列表中。\n            3.  应用脉冲后重置规则来确定下一个时间步的状态。问题指定了固定步长方法和“在该步长”立即重置。这被解释为时间 $t+\\Delta t$ 的状态成为重置状态。电压被重置为 $c$，恢复变量 $u$ 增加 $d$。要增加的 $u$ 值是为该步结束计算出的 $u_{\\text{next}}$，因为它反映了在动作电位上升期间恢复过程的累积。因此，对于下一步，我们设置：\n                $$\n                v \\leftarrow c\n                $$\n                $$\n                u \\leftarrow u_{\\text{next}} + d\n                $$\n        -   **如果未检测到脉冲**: 下一步的状态就是通过欧拉法近似的状态：\n            $$\n            v \\leftarrow v_{\\text{next}}\n            $$\n            $$\n            u \\leftarrow u_{\\text{next}}\n            $$\n\n3.  **模拟后分析**:\n    -   模拟循环完成后，检查记录的脉冲数量。\n    -   如果记录的脉冲少于 $6$ 次，则无法计算五个 ISI。在这种情况下，适应性比率定义为非数字 ($\\mathrm{nan}$)。\n    -   如果记录了 $6$ 次或更多脉冲，则脉冲间期 (ISI) 计算为连续脉冲时间之差：$\\text{ISI}_k = t_{\\text{spike}, k+1} - t_{\\text{spike}, k}$。\n    -   然后，适应性比率计算为第一个 ISI 与第五个 ISI 之比：\n        $$\n        \\text{Ratio} = \\frac{\\text{ISI}_1}{\\text{ISI}_5}\n        $$\n\n4.  **最终输出**: 计算出的比率四舍五入到小数点后 $6$ 位。收集所有测试用例的结果，并格式化为所需的字符串 `[ratio_A,ratio_B,ratio_C]`。\n\n整个过程封装在一个 Python 脚本中。一个函数 `simulate_neuron` 实现单个测试用例的模拟和分析，而 `solve` 函数则遍历给定的测试套件，调用模拟函数并打印最终格式化的结果。",
            "answer": "[1.334057,nan,1.134045]"
        },
        {
            "introduction": "计算神经科学的一个核心挑战是区分模型的真实行为与数值模拟引入的“伪影”（artifact）。由于我们使用离散的时间步长来近似连续的动力学过程，选择不当的步长可能会导致结果失真。本练习将引导你设计并实施一个收敛性测试，通过系统性地改变模拟的时间步长并分析结果的变化，来验证你的模拟结果的可靠性和准确性，这是确保计算模型研究科学严谨性的关键一步。",
            "id": "4029521",
            "problem": "考虑 Izhikevich 神经元模型，该模型通过常微分方程 (ODE) 描述膜电位和恢复变量的动力学。该模型由以下方程组定义\n$$\n\\frac{dv}{dt} = 0.04 v^2 + 5 v + 140 - u + I,\\quad \\frac{du}{dt} = a\\,(b\\,v - u),\n$$\n以及当膜电位越过脉冲阈值时应用的脉冲后重置规则，\n$$\n\\text{if } v \\ge 30 \\text{ then } v \\leftarrow c,\\quad u \\leftarrow u + d.\n$$\n使用标准的“常规脉冲发放”(regular spiking) 参数 $a=0.02$、$b=0.2$、$c=-65$、$d=8$，并将状态初始化为 $v(0)=c$、$u(0)=b\\,c$。假设动力学采用固定的毫秒级时间步长 $ \\Delta t $，使用显式一阶前向欧拉方法进行积分，并且在每次欧拉更新后检查脉冲阈值。膜电位 $v$ 和恢复变量 $u$ 采用模型单位（无量纲）。输入电流 $I$ 是一个常数（无量纲模型单位）。\n\n作为输入电流函数的发放频率（$f$–$I$ 曲线）通过在有限的仿真时长 $T$ 内对脉冲进行计数，然后除以以秒为单位的时长来估计。具体来说，如果在 $T$ 毫秒内发生 $N_{\\text{spike}}$ 次脉冲，则发放频率 $f$ 必须以赫兹 (Hz) 为单位报告，计算公式为\n$$\nf = \\frac{N_{\\text{spike}}}{T/1000}.\n$$\n\n您的任务是计算数值离散化对 $f$–$I$ 曲线估计的影响，并设计一个能够区分数值伪影和真实模型行为的收敛性诊断方法。请基于数值积分和 ODE 误差分析的基本原理进行，除了 Izhikevich 模型本身和显式欧拉方法的基本性质外，不使用任何专门的简化公式。\n\n实现一个程序，该程序：\n- 使用显式欧拉方法，以时间步长 $\\Delta t \\in \\{1.0, 0.5, 0.25, 0.125\\}$ 毫秒来仿真 Izhikevich 模型。\n- 对于每个指定的测试用例，在仿真时长 $T$ 毫秒内，针对一组恒定电流 $I$，在所有指定 $\\Delta t$ 值下计算发放频率，然后对每个 $I$ 评估收敛性诊断：\n  1. 定义发放频率序列 $f_{\\Delta t}$、$f_{\\Delta t/2}$、$f_{\\Delta t/4}$、$f_{\\Delta t/8}$。\n  2. 定义连续绝对差值 $D_1 = |f_{\\Delta t} - f_{\\Delta t/2}|$、$D_2 = |f_{\\Delta t/2} - f_{\\Delta t/4}|$、$D_3 = |f_{\\Delta t/4} - f_{\\Delta t/8}|$。\n  3. 定义收敛比\n     $$\n     R = \\frac{D_1}{D_2},\n     $$\n     对于一阶方法，当解在相关意义上是光滑的时，该比值预期接近 $2$。\n  4. 如果以下所有条件均得到满足，则判定电流 $I$ 的诊断通过：\n     - 差分的单调细化：$D_1 \\ge D_2 \\ge D_3$。\n     - 渐进行为比率一致性：当 $D_2 > 0$ 时，$R$ 位于区间 $[1.25, 3.0]$ 内；如果 $D_2 = 0$ 且 $D_1 = 0$，则视为满足此条件。\n     - 细尺度稳定性：$D_3 \\le \\epsilon$，其中 $\\epsilon = 1.0$ Hz。\n     此外，如果对于给定的 $I$，所有四个发放频率都恰好为零（在所有离散化方案下均未发放脉冲），则视为该 $I$ 的诊断平凡满足。\n  5. 测试用例的结果是一个布尔值，表示在该用例中，诊断是否对所有电流都通过。\n\n科学真实性要求：\n- 所有仿真均使用 $T = 2000$ 毫秒，并发放频率以赫兹 (Hz) 为单位报告。\n- 必须使用显式欧拉方法来近似 ODE，并且必须在每次欧拉更新后通过将 $v$ 与 $30$ 进行阈值比较来检测脉冲，在检测到脉冲时立即应用重置。此事件处理应在所有 $\\Delta t$ 值上保持一致。\n\n测试套件：\n- 用例 $1$（常规“理想路径”）：$I \\in \\{10, 14, 20, 30\\}$，$T = 2000$ 毫秒，基础步长 $\\Delta t_0 = 1.0$ 毫秒。\n- 用例 $2$（接近基电流边界）：$I \\in \\{6, 8, 10\\}$，$T = 2000$ 毫秒，基础步长 $\\Delta t_0 = 1.0$ 毫秒。\n- 用例 $3$（高输入区域）：$I \\in \\{40, 60\\}$，$T = 2000$ 毫秒，基础步长 $\\Delta t_0 = 1.0$ 毫秒。\n- 用例 $4$（阈下边缘）：$I \\in \\{0, 2\\}$，$T = 2000$ 毫秒，基础步长 $\\Delta t_0 = 1.0$ 毫秒。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的布尔值列表（每个测试用例一个），例如 $[{\\tt True},{\\tt False},{\\tt True},{\\tt True}]$。每个布尔值表示在相应的测试用例中，收敛性诊断是否对所有电流都通过。此行必须是程序产生的唯一输出。",
            "solution": "该问题要求实现和分析 Izhikevich 神经元模型，这是一个带有不连续重置条件的常微分方程 (ODE) 系统，用以评估数值离散化对计算出的发放频率的影响。该分析使用一个自定义的收敛性诊断方法，该方法基于显式一阶前向欧拉方法的数值误差分析基本原理。\n\nIzhikevich 模型由以下关于膜电位 $v(t)$ 和恢复变量 $u(t)$ 的方程组定义：\n$$\n\\frac{dv}{dt} = 0.04 v^2 + 5 v + 140 - u + I\n$$\n$$\n\\frac{du}{dt} = a(b v - u)\n$$\n其中 $I$ 是一个恒定的输入电流。当 $v$ 达到 $30$ 的阈值时，记录一次脉冲并发放，状态变量被重置：\n$$\n\\text{if } v \\ge 30, \\text{ then } v \\leftarrow c \\text{ and } u \\leftarrow u + d.\n$$\n问题指定了使用“常规脉冲发放”神经元的参数：$a = 0.02$、$b = 0.2$、$c = -65$ 和 $d = 8$。初始条件设置为静息状态，$v(0) = c = -65$ 和 $u(0) = b \\cdot c = 0.2 \\cdot (-65) = -13$。\n\n该 ODE 系统的解采用显式一阶前向欧拉方法进行近似。给定时间 $t_n$ 的状态 $(v_n, u_n)$，时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $(v_{n+1}, u_{n+1})$ 计算如下：\n$$\nv_{n+1} = v_n + \\Delta t \\left( 0.04 v_n^2 + 5 v_n + 140 - u_n + I \\right)\n$$\n$$\nu_{n+1} = u_n + \\Delta t \\left( a(b v_n - u_n) \\right)\n$$\n关键在于，$v$ 和 $u$ 的导数都应在同一时间点 $t_n$ 使用值 $v_n$ 和 $u_n$ 进行评估。在每个欧拉步之后，将新的电位 $v_{n+1}$ 与脉冲阈值进行比较。如果 $v_{n+1} \\ge 30$，则计为一个脉冲，并立即对刚计算出的状态应用重置条件：$v_{n+1}$ 被设置为 $c$，$u_{n+1}$ 增加 $d$。\n\n问题的核心是评估发放频率 $f$ 的收敛性诊断，该频率是解轨迹的一个泛函。发放频率计算公式为 $f = N_{\\text{spike}} / (T/1000)$，其中 $N_{\\text{spike}}$ 是在 $T = 2000$ 毫秒的仿真时长内脉冲的总数。此计算将频率转换为赫兹 (Hz)。该诊断评估了计算出的频率 $f$ 如何随着时间步长 $\\Delta t$ 的细化而变化。仿真针对一系列时间步长 $\\Delta t \\in \\{1.0, 0.5, 0.25, 0.125\\}$ 毫秒运行。设相应的发放频率为 $f_1, f_2, f_3, f_4$。\n\n该诊断由三个基于数值积分理论的条件组成：\n\n1.  **差分的单调细化**：$D_1 \\ge D_2 \\ge D_3$，其中 $D_1 = |f_1 - f_2|$，$D_2 = |f_2 - f_3|$，以及 $D_3 = |f_3 - f_4|$。此条件检查 $\\Delta t$ 的连续细化是否导致计算出的发放频率变化越来越小。这表明收敛行为良好。违反此条件，例如 $D_1  D_2$，可能表明收敛是振荡的，或者较粗的时间步长处于数值不稳定的区域。\n\n2.  **渐进行为比率一致性**：连续差的比率 $R = D_1 / D_2$，对于一个 $p$ 阶方法，预期会趋近于 $2^p$。对于一阶欧拉方法 ($p=1$)，该比率应约为 $2$。当 $D_2 > 0$ 时，诊断要求 $R \\in [1.25, 3.0]$。这个区间为偏离理想渐进行为提供了合理的容差，这种偏离在具有脉冲重置等不连续性的系统中是预料之中的。如果 $D_2=0$ 且 $D_1=0$，则说明频率已经收敛，因此该条件被视为满足。\n\n3.  **细尺度稳定性**：最细尺度下的绝对差 $D_3$ 必须低于容差 $\\epsilon = 1.0$ Hz。这确保了计算出的频率足够接近其收敛值，并且进一步细化 $\\Delta t$ 很可能只会产生微小的变化。\n\n处理了一种特殊情况，即在所有四个时间步长下都未检测到脉冲。在这种阈下区域，所有四个发放频率均为 $0$，诊断被视为平凡通过。对于一个给定的测试用例，只有当该诊断对该用例中的每个输入电流 $I$ 都通过时，最终结果才为 `True`。\n\n实现包括三个主要部分。首先是一个 `simulate_izhikevich` 函数，它为给定的参数集（$I$、$\\Delta t$ 等）执行仿真并返回脉冲计数。其次是一个 `evaluate_diagnostic` 函数，它对给定的电流 $I$，运行所有四个 $\\Delta t$ 值的仿真，计算发放频率，并评估诊断的三个条件。最后，一个主 `solve` 函数遍历预定义的测试用例，对每个用例中的每个电流调用诊断评估，并按规定汇总布尔结果。",
            "answer": "[True,False,True,True]"
        }
    ]
}