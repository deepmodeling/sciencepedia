{
    "hands_on_practices": [
        {
            "introduction": "The concept of a firing \"threshold\" is fundamental to neuroscience, but it is often oversimplified as a single voltage value. This practice explores a more sophisticated and accurate view of the threshold as a dynamic boundary, or separatrix, in the neuron's state space. Using the classic FitzHugh–Nagumo model, you will employ phase-plane analysis to locate a key saddle-point equilibrium and use its stable manifold to construct a linear approximation of this critical boundary, providing a powerful geometric intuition for what it means for a neuron to be \"on the verge\" of firing. ",
            "id": "4006486",
            "problem": "Consider the dimensionless FitzHugh–Nagumo model, a two-dimensional reduction of the Hodgkin–Huxley equations used in brain modeling and computational neuroscience to study excitability and action potential initiation. The system of ordinary differential equations (ODE) is\n$$\n\\frac{d u}{d t} = u - \\frac{u^{3}}{3} - v + I_{\\text{ext}}, \\qquad \\frac{d v}{d t} = \\epsilon \\left(u + \\alpha - \\beta v\\right),\n$$\nwhere $u$ is the fast voltage-like variable, $v$ is the slow recovery variable, $\\epsilon > 0$ is the time-scale separation parameter, $\\beta > 0$ is a recovery strength parameter, and $I_{\\text{ext}}$ is a constant external input.\n\nYou will analyze the phase plane near a saddle equilibrium to approximate the threshold separatrix that divides small perturbations that relax back to rest from those that escape toward the excitation cycle. Impose the parameter relation $\\alpha = \\beta I_{\\text{ext}}$ and assume $\\beta > 1$ and $I_{\\text{ext}} > 0$.\n\nUsing only first principles for dynamical systems in the plane (nullclines, equilibria, Jacobian linearization, and classification by trace and determinant), do the following:\n\n1. Verify the existence and location of the equilibrium implied by the given parameter relation, and determine its type for $\\beta > 1$.\n2. Linearize the vector field at this equilibrium and compute the slope of the local stable manifold in the $(u,v)$ phase plane by extracting it from the eigenstructure of the Jacobian.\n3. Use this local stable manifold as a linear approximation of the threshold separatrix near the saddle. Consider initial conditions constrained to the line $v(0) = 0$. Compute, in closed form, the corresponding approximate threshold value $u_{\\text{th}}$ such that the initial condition $(u(0), v(0)) = (u_{\\text{th}}, 0)$ lies on this separatrix line through the saddle.\n\nExpress your final answer for $u_{\\text{th}}$ as a single analytic expression in terms of $\\epsilon$, $\\beta$, and $I_{\\text{ext}}$. Do not round or approximate; no numerical values are required.",
            "solution": "The problem asks for an approximation of the threshold voltage $u_{\\text{th}}$ in the FitzHugh–Nagumo model under specific parameter constraints. The approach is to linearize the system at its saddle equilibrium point and use the local stable manifold as a linear approximation of the true nonlinear separatrix.\n\nThe system of ordinary differential equations (ODEs) is given by:\n$$\n\\frac{d u}{d t} = f(u,v) = u - \\frac{u^{3}}{3} - v + I_{\\text{ext}}\n$$\n$$\n\\frac{d v}{d t} = g(u,v) = \\epsilon \\left(u + \\alpha - \\beta v\\right)\n$$\nThe analysis is subject to the parameter relation $\\alpha = \\beta I_{\\text{ext}}$ and the constraints $\\epsilon > 0$, $\\beta > 1$, and $I_{\\text{ext}} > 0$.\n\nFirst, we locate the equilibrium points $(u^*, v^*)$ by setting both time derivatives to zero, i.e., $\\frac{du}{dt} = 0$ and $\\frac{dv}{dt} = 0$.\nThe condition $\\frac{dv}{dt} = 0$ gives the $v$-nullcline. Since $\\epsilon \\neq 0$:\n$$\nu^* + \\alpha - \\beta v^* = 0 \\implies v^* = \\frac{u^* + \\alpha}{\\beta}\n$$\nThe condition $\\frac{du}{dt} = 0$ gives the $u$-nullcline:\n$$\nu^* - \\frac{(u^*)^{3}}{3} - v^* + I_{\\text{ext}} = 0 \\implies v^* = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\nTo find the equilibria, we equate the expressions for $v^*$:\n$$\n\\frac{u^* + \\alpha}{\\beta} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\nNow, we apply the given parameter relation $\\alpha = \\beta I_{\\text{ext}}$:\n$$\n\\frac{u^* + \\beta I_{\\text{ext}}}{\\beta} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n$$\n\\frac{u^*}{\\beta} + I_{\\text{ext}} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n$$\n\\frac{u^*}{\\beta} = u^* - \\frac{(u^*)^{3}}{3}\n$$\nRearranging the terms yields:\n$$\nu^* \\left(1 - \\frac{1}{\\beta} - \\frac{(u^*)^2}{3}\\right) = 0\n$$\nThis reveals three possible equilibrium values for $u^*$: $u^*=0$ and $u^*=\\pm\\sqrt{3(1-1/\\beta)}$. The problem refers to \"the equilibrium implied by the given parameter relation,\" which simplifies the analysis. The specific equilibrium of interest is derived from the simplest solution, $u^*=0$.\nFor $u^* = 0$, the corresponding $v^*$ coordinate is:\n$$\nv^* = \\frac{0 + \\alpha}{\\beta} = \\frac{\\beta I_{\\text{ext}}}{\\beta} = I_{\\text{ext}}\n$$\nThus, the equilibrium point is $(u_{eq}, v_{eq}) = (0, I_{\\text{ext}})$.\n\nNext, we classify this equilibrium point by linearizing the system. The Jacobian matrix $J(u,v)$ is:\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 1 - u^2  -1 \\\\ \\epsilon  -\\epsilon \\beta \\end{pmatrix}\n$$\nEvaluating the Jacobian at the equilibrium point $(0, I_{\\text{ext}})$:\n$$\nJ_{\\text{eq}} = J(0, I_{\\text{ext}}) = \\begin{pmatrix} 1  -1 \\\\ \\epsilon  -\\epsilon \\beta \\end{pmatrix}\n$$\nThe stability of the equilibrium is determined by the trace, $\\text{Tr}(J_{\\text{eq}})$, and the determinant, $\\text{Det}(J_{\\text{eq}})$, of this matrix.\n$$\n\\text{Tr}(J_{\\text{eq}}) = 1 - \\epsilon \\beta\n$$\n$$\n\\text{Det}(J_{\\text{eq}}) = (1)(-\\epsilon \\beta) - (-1)(\\epsilon) = \\epsilon(1 - \\beta)\n$$\nGiven $\\epsilon > 0$ and $\\beta > 1$, we have $1-\\beta  0$, which implies $\\text{Det}(J_{\\text{eq}})  0$. A negative determinant indicates that the two eigenvalues are real and have opposite signs. This is the defining characteristic of a saddle point. This confirms the problem's a priori identification of this equilibrium as a saddle.\n\nThe separatrix dividing the phase space is given by the stable manifold of this saddle point. Near the equilibrium, the stable manifold can be approximated by a straight line tangent to it, whose direction is given by the eigenvector corresponding to the stable (negative) eigenvalue, $\\lambda_s$. The eigenvalues $\\lambda$ are roots of the characteristic equation $\\det(J_{\\text{eq}} - \\lambda I) = 0$:\n$$\n\\lambda^2 - \\text{Tr}(J_{\\text{eq}})\\lambda + \\text{Det}(J_{\\text{eq}}) = 0\n$$\n$$\n\\lambda^2 - (1 - \\epsilon \\beta)\\lambda + \\epsilon(1 - \\beta) = 0\n$$\nThe stable eigenvalue $\\lambda_s$ is the smaller root:\n$$\n\\lambda_s = \\frac{(1 - \\epsilon \\beta) - \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon(1 - \\beta)}}{2}\n$$\nThe eigenvector $\\mathbf{e}_s = \\begin{pmatrix} e_u \\\\ e_v \\end{pmatrix}$ corresponding to $\\lambda_s$ satisfies $(J_{\\text{eq}} - \\lambda_s I) \\mathbf{e}_s = \\mathbf{0}$. From the first row of this matrix equation:\n$$\n(1 - \\lambda_s) e_u - e_v = 0 \\implies e_v = (1 - \\lambda_s) e_u\n$$\nThe slope of the local stable manifold, $m_s$, is the ratio $\\frac{e_v}{e_u}$:\n$$\nm_s = 1 - \\lambda_s = 1 - \\frac{(1 - \\epsilon \\beta) - \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon(1 - \\beta)}}{2}\n$$\n$$\nm_s = \\frac{2 - (1 - \\epsilon \\beta) + \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon + 4\\epsilon \\beta}}{2}\n$$\n$$\nm_s = \\frac{1 + \\epsilon \\beta + \\sqrt{1 - 2\\epsilon \\beta + \\epsilon^2 \\beta^2 - 4\\epsilon + 4\\epsilon \\beta}}{2}\n$$\n$$\nm_s = \\frac{1 + \\epsilon \\beta + \\sqrt{1 + 2\\epsilon \\beta + \\epsilon^2 \\beta^2 - 4\\epsilon}}{2} = \\frac{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}{2}\n$$\nThe equation of the line representing the local stable manifold passes through the saddle point $(0, I_{\\text{ext}})$ with slope $m_s$:\n$$\nv - v_{eq} = m_s (u - u_{eq}) \\implies v - I_{\\text{ext}} = m_s u\n$$\nThe problem asks for the threshold value $u_{\\text{th}}$ for an initial condition $(u(0), v(0)) = (u_{\\text{th}}, 0)$ that lies on this separatrix line. We substitute these coordinates into the line's equation:\n$$\n0 - I_{\\text{ext}} = m_s (u_{\\text{th}})\n$$\nSolving for $u_{\\text{th}}$:\n$$\nu_{\\text{th}} = -\\frac{I_{\\text{ext}}}{m_s}\n$$\nSubstituting the expression for $m_s$:\n$$\nu_{\\text{th}} = -\\frac{I_{\\text{ext}}}{\\frac{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}{2}}\n$$\n$$\nu_{\\text{th}} = -\\frac{2 I_{\\text{ext}}}{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}\n$$\nThis is the final analytical expression for the approximate threshold value $u_{\\text{th}}$.",
            "answer": "$$\\boxed{-\\frac{2 I_{\\text{ext}}}{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^{2} - 4\\epsilon}}}$$"
        },
        {
            "introduction": "Once a neuron is driven past its threshold to fire repetitively, its response to increasing input can follow strikingly different patterns. This exercise delves into the two major classes of neuronal excitability, Type I and Type II, by analyzing their respective canonical models. You will derive the frequency-current ($f-I$) relationships from first principles, revealing how the underlying bifurcation structure—a saddle-node on invariant circle (SNIC) versus a supercritical Hopf—dictates whether the firing rate emerges smoothly from zero or jumps abruptly to a finite frequency. ",
            "id": "4006496",
            "problem": "You are given two canonical ordinary differential equation models of neuronal excitability that capture the onset of repetitive spiking under constant input. One is a Type I model exhibiting a saddle-node on invariant circle (SNIC) bifurcation at threshold, and the other is a Type II model exhibiting a supercritical Hopf bifurcation at threshold. Your task is to compute the frequency-current ($f$–$I$) curve near threshold for both models from first principles and compare their onset behavior using scaling laws. All answers involving frequency must be expressed in Hertz (Hz, equivalent to $\\mathrm{s}^{-1}$), and any angle, if it appears, should be considered in radians.\n\nModel specifications:\n\n- Type I (SNIC) canonical form: the Quadratic Integrate-and-Fire (QIF) model\n  $$\\frac{dV}{dt} = a\\left(V^2 + I\\right),$$\n  where $V$ is the membrane voltage, $I \\ge 0$ is a constant input current, and $a  0$ is a time-scale parameter with units $\\mathrm{s}^{-1}$. In this idealized model, a spike is produced when the trajectory evolves from $V=-\\infty$ to $V=+\\infty$, and the interspike interval (period) $T(I)$ is the time to traverse from $V=-\\infty$ to $V=+\\infty$. The frequency is $f(I) = 1/T(I)$.\n\n- Type II (Hopf) canonical form: the normal form of a supercritical Hopf oscillator\n  $$\\frac{dz}{dt} = \\left(\\mu + i\\omega_0\\right)z - |z|^2 z,$$\n  where $z \\in \\mathbb{C}$ represents a two-dimensional state, $\\mu$ is a real bifurcation parameter controlling the onset of oscillations, and $\\omega_0  0$ is the angular frequency (in $\\mathrm{rad/s}$) of the linearized oscillator at the onset. For sustained oscillations, $\\mu  0$ yields a stable limit cycle. The frequency $f(\\mu)$ is defined as the temporal frequency of the limit cycle oscillation in $\\mathrm{Hz}$.\n\nFoundational bases to use in your derivations:\n- The definition of frequency as the inverse of the period, $f = 1/T$.\n- For one-dimensional flows of the form $\\frac{dx}{dt} = F(x)$, the transit time between two positions $x_1$ and $x_2$ is $T = \\int_{x_1}^{x_2} \\frac{dx}{F(x)}$.\n- For the Hopf normal form expressed in polar coordinates $z = r e^{i\\theta}$, the evolution equations are $\\frac{dr}{dt} = \\mu r - r^3$ and $\\frac{d\\theta}{dt} = \\omega_0$.\n\nTasks:\n1. Derive the $f$–$I$ relation near threshold for the Type I QIF model using the integral definition of the period over the voltage excursion from $V=-\\infty$ to $V=+\\infty$. Provide the frequency in $\\mathrm{Hz}$.\n2. Derive the $f$–$\\mu$ relation near threshold for the Type II Hopf model using the polar decomposition and properties of the limit cycle for $\\mu  0$. Provide the frequency in $\\mathrm{Hz}$.\n3. Using the derived expressions, compute the frequency values for the specified test suite parameters below. Then, estimate the onset scaling exponent $\\alpha$ for the Type I model by fitting a power law $f(I) \\propto (I - I_c)^\\alpha$ on a log–log scale using least squares over the provided current values, with the threshold set at $I_c = 0$. Finally, estimate the onset frequency $f_{\\mathrm{onset}}$ for the Type II model as the limit of $f(\\mu)$ as $\\mu \\to 0^+$, and compute the ratio $R$ of the smallest Type I frequency to this onset frequency.\n\nTest suite (units are critical and must be followed):\n- Type I (QIF) parameters: $a = 200$ (in $\\mathrm{s}^{-1}$), $I$ values $I \\in \\{1\\times 10^{-6},\\ 1\\times 10^{-3},\\ 1\\times 10^{-1}\\}$ (dimensionless).\n- Type II (Hopf) parameters: $\\omega_0 = 2\\pi \\cdot 10$ (in $\\mathrm{rad/s}$), $\\mu$ values $\\mu \\in \\{1\\times 10^{-9},\\ 1\\times 10^{-6},\\ 1\\times 10^{-3}\\}$ (dimensionless).\n\nOutput specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order and units:\n- The three Type I frequencies $f(I)$ in $\\mathrm{Hz}$, evaluated at the given $I$ values, in the order listed above.\n- The fitted Type I onset scaling exponent $\\alpha$ (dimensionless).\n- The three Type II frequencies $f(\\mu)$ in $\\mathrm{Hz}$, evaluated at the given $\\mu$ values, in the order listed above.\n- The Type II onset frequency $f_{\\mathrm{onset}}$ in $\\mathrm{Hz}$.\n- The ratio $R$ (dimensionless) of the smallest Type I frequency to $f_{\\mathrm{onset}}$.\n\nTherefore, the output should have the form\n$[f_{I_1}, f_{I_2}, f_{I_3}, \\alpha, f_{\\mu_1}, f_{\\mu_2}, f_{\\mu_3}, f_{\\mathrm{onset}}, R]$,\nwhere all entries are floats.",
            "solution": "The problem requires the derivation and comparison of the frequency-current ($f-I$) relationships for two canonical neuron models, a Type I Quadratic Integrate-and-Fire (QIF) model and a Type II model represented by the normal form of a supercritical Hopf bifurcation. The analysis will be conducted from first principles, followed by numerical evaluation and scaling analysis for a given set of parameters.\n\n### Part 1: Type I (Quadratic Integrate-and-Fire) Model Analysis\n\nThe QIF model is described by the ordinary differential equation:\n$$\n\\frac{dV}{dt} = a\\left(V^2 + I\\right)\n$$\nwhere $V$ is the membrane voltage, $I \\ge 0$ is the input current, and $a  0$ is a time-scale parameter with units of $\\mathrm{s}^{-1}$. The threshold for spiking is at $I_c = 0$. For $I  0$, the right-hand side of the equation is always positive, meaning there are no fixed points and the voltage $V$ increases monotonically. The model defines a spike as the trajectory traversing from $V = -\\infty$ to $V = +\\infty$. The interspike interval, or period $T(I)$, is the time taken for this transit.\n\nUsing the provided formula for transit time in a one-dimensional flow, we can write the period as an integral:\n$$\nT(I) = \\int_{V_1}^{V_2} \\frac{dV}{F(V)} = \\int_{-\\infty}^{+\\infty} \\frac{dV}{a(V^2 + I)}\n$$\nWe can solve this integral. Since $I > 0$, we can let $I = (\\sqrt{I})^2$. The integral is a standard form:\n$$\nT(I) = \\frac{1}{a} \\int_{-\\infty}^{+\\infty} \\frac{dV}{V^2 + (\\sqrt{I})^2}\n$$\nThe antiderivative of $\\frac{1}{x^2+k^2}$ is $\\frac{1}{k}\\arctan(\\frac{x}{k})$. Applying this, we get:\n$$\nT(I) = \\frac{1}{a} \\left[ \\frac{1}{\\sqrt{I}} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) \\right]_{V=-\\infty}^{V=+\\infty}\n$$\nEvaluating this expression at the limits:\n$$\nT(I) = \\frac{1}{a\\sqrt{I}} \\left( \\lim_{V\\to+\\infty} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) - \\lim_{V\\to-\\infty} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) \\right)\n$$\nAs the argument of the arctangent function approaches $\\pm\\infty$, the function itself approaches $\\pm\\frac{\\pi}{2}$.\n$$\nT(I) = \\frac{1}{a\\sqrt{I}} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{a\\sqrt{I}} (\\pi) = \\frac{\\pi}{a\\sqrt{I}}\n$$\nThe frequency $f(I)$ is the reciprocal of the period $T(I)$:\n$$\nf(I) = \\frac{1}{T(I)} = \\frac{a\\sqrt{I}}{\\pi}\n$$\nThis is the $f-I$ relation for the QIF model. This relation shows that the firing frequency starts at $f=0$ for $I=0$ and increases with a square-root dependence on the suprathreshold current $I$. This is the characteristic behavior of a Type I neuron.\n\n### Part 2: Type II (Hopf Normal Form) Model Analysis\n\nThe Type II model is given by the normal form for a supercritical Hopf bifurcation:\n$$\n\\frac{dz}{dt} = \\left(\\mu + i\\omega_0\\right)z - |z|^2 z\n$$\nwhere $z$ is a complex variable, $\\mu$ is the bifurcation parameter, and $\\omega_0  0$ is the intrinsic angular frequency. The threshold for oscillations is at $\\mu_c=0$. For sustained oscillations, we require $\\mu  0$.\n\nTo analyze the frequency, we convert the system to polar coordinates by setting $z = r e^{i\\theta}$, where $r = |z|$ is the amplitude and $\\theta = \\arg(z)$ is the phase. The time derivative is $\\frac{dz}{dt} = (\\frac{dr}{dt} + i r \\frac{d\\theta}{dt})e^{i\\theta}$. Substituting this into the equation:\n$$\n(\\frac{dr}{dt} + ir\\frac{d\\theta}{dt})e^{i\\theta} = (\\mu + i\\omega_0)r e^{i\\theta} - |r e^{i\\theta}|^2 r e^{i\\theta}\n$$\nDividing by $e^{i\\theta}$ (since it is non-zero) and noting that $|r e^{i\\theta}|^2 = r^2$:\n$$\n\\frac{dr}{dt} + ir\\frac{d\\theta}{dt} = (\\mu + i\\omega_0)r - r^3 = (\\mu r - r^3) + i(\\omega_0 r)\n$$\nEquating the real and imaginary parts gives the dynamics for amplitude and phase:\n$$\n\\frac{dr}{dt} = \\mu r - r^3 = r(\\mu - r^2)\n$$\n$$\nr\\frac{d\\theta}{dt} = \\omega_0 r \\implies \\frac{d\\theta}{dt} = \\omega_0 \\quad (\\text{for } r \\neq 0)\n$$\nFor $\\mu  0$, the radial equation has a stable fixed point at $r_{LC} = \\sqrt{\\mu}$, which corresponds to a stable limit cycle. The fixed point at $r=0$ is unstable. On this limit cycle, the amplitude is constant, $r = \\sqrt{\\mu}$, and the phase evolves with a constant angular velocity:\n$$\n\\frac{d\\theta}{dt} = \\omega_0\n$$\nThe angular frequency of oscillation on the limit cycle is thus $\\omega = \\omega_0$. The temporal frequency in Hertz ($f$) is related to the angular frequency in $\\mathrm{rad/s}$ by $f = \\omega / (2\\pi)$. Therefore, the frequency of a stable oscillation for any $\\mu  0$ is:\n$$\nf(\\mu) = \\frac{\\omega_0}{2\\pi}\n$$\nRemarkably, for this canonical normal form, the frequency of oscillation is constant and independent of the distance from the bifurcation point, $\\mu$. This means the oscillations emerge at a finite, non-zero frequency as $\\mu$ crosses $0$. This is the characteristic behavior of a Type II neuron.\n\n### Part 3: Numerical Computations and Scaling Analysis\n\nWe now apply the derived formulas to the specified test suite.\n\n**Type I Model Frequencies:**\nUsing $f(I) = \\frac{a\\sqrt{I}}{\\pi}$ with $a = 200 \\ \\mathrm{s}^{-1}$ and $I \\in \\{1\\times 10^{-6}, 1\\times 10^{-3}, 1\\times 10^{-1}\\}$:\n$f(10^{-6}) = \\frac{200 \\sqrt{10^{-6}}}{\\pi} = \\frac{200 \\times 10^{-3}}{\\pi} = \\frac{0.2}{\\pi} \\ \\mathrm{Hz}$.\n$f(10^{-3}) = \\frac{200 \\sqrt{10^{-3}}}{\\pi} = \\frac{200 \\times 10^{-1.5}}{\\pi} \\ \\mathrm{Hz}$.\n$f(10^{-1}) = \\frac{200 \\sqrt{10^{-1}}}{\\pi} = \\frac{200 \\times 10^{-0.5}}{\\pi} \\ \\mathrm{Hz}$.\n\n**Type I Scaling Exponent $\\alpha$:**\nThe problem asks to estimate the exponent $\\alpha$ in the scaling law $f(I) \\propto (I-I_c)^\\alpha$ with $I_c=0$. From our derivation, $f(I) = (\\frac{a}{\\pi})I^{1/2}$, so the relationship is an exact power law with exponent $\\alpha = 1/2$. To confirm this via the requested fitting procedure, we can perform a linear regression on the logarithmic data. Taking the natural logarithm of the relation gives:\n$\\ln(f(I)) = \\ln(\\frac{a}{\\pi}) + \\frac{1}{2}\\ln(I)$.\nThis is a linear relationship of the form $y = m x + c$, where $y=\\ln(f(I))$, $x=\\ln(I)$, and the slope is $m=\\alpha=1/2$. A least-squares fit to the data points $(\\ln(I_k), \\ln(f(I_k)))$ will yield a slope of exactly $0.5$.\n\n**Type II Model Frequencies:**\nUsing $f(\\mu) = \\frac{\\omega_0}{2\\pi}$ with $\\omega_0 = 2\\pi \\cdot 10 \\ \\mathrm{rad/s}$ and $\\mu \\in \\{1\\times 10^{-9}, 1\\times 10^{-6}, 1\\times 10^{-3}\\}$:\n$f(\\mu) = \\frac{2\\pi \\cdot 10}{2\\pi} = 10 \\ \\mathrm{Hz}$ for all $\\mu  0$.\nThus, $f(10^{-9}) = 10 \\ \\mathrm{Hz}$, $f(10^{-6}) = 10 \\ \\mathrm{Hz}$, and $f(10^{-3}) = 10 \\ \\mathrm{Hz}$.\n\n**Type II Onset Frequency $f_{\\mathrm{onset}}$:**\nThe onset frequency is the limit of $f(\\mu)$ as the bifurcation parameter approaches the threshold from above:\n$f_{\\mathrm{onset}} = \\lim_{\\mu\\to 0^+} f(\\mu) = \\lim_{\\mu\\to 0^+} 10 = 10 \\ \\mathrm{Hz}$.\n\n**Ratio $R$:**\nThe ratio $R$ is defined as the smallest Type I frequency divided by the Type II onset frequency. The smallest given current is $I=10^{-6}$.\n$R = \\frac{f(I=10^{-6})}{f_{\\mathrm{onset}}} = \\frac{0.2/\\pi \\ \\mathrm{Hz}}{10 \\ \\mathrm{Hz}} = \\frac{0.02}{\\pi}$.\n\nThe following program will compute these values numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares firing frequencies for Type I and Type II neuron models.\n    \"\"\"\n\n    # --- Test Suite Parameters ---\n    # Type I (QIF) model parameters\n    a_qif = 200.0  # s^-1\n    I_vals = np.array([1e-6, 1e-3, 1e-1])  # dimensionless\n\n    # Type II (Hopf) model parameters\n    omega_0_hopf = 2 * np.pi * 10.0  # rad/s\n    mu_vals = np.array([1e-9, 1e-6, 1e-3])  # dimensionless\n\n    # --- Task 1: Type I Frequencies ---\n    # Derived formula: f(I) = a * sqrt(I) / pi\n    f_I = (a_qif * np.sqrt(I_vals)) / np.pi\n    \n    f_I1, f_I2, f_I3 = f_I[0], f_I[1], f_I[2]\n\n    # --- Task 3: Type I Onset Scaling Exponent ---\n    # The problem asks to estimate alpha by fitting f(I) proportional to (I-Ic)^alpha\n    # with Ic=0. This is a power law f = C * I^alpha.\n    # On a log-log scale, this is a linear relationship: log(f) = log(C) + alpha * log(I).\n    # We perform a linear least-squares fit to find the slope, alpha.\n    log_I = np.log(I_vals)\n    log_f_I = np.log(f_I)\n    \n    # np.polyfit(x, y, 1) returns [slope, intercept] of the best-fit line.\n    # The slope is a direct estimate of the exponent alpha.\n    # Analytically, we know alpha is exactly 0.5, and the fit should confirm this.\n    alpha = np.polyfit(log_I, log_f_I, 1)[0]\n    \n    # --- Task 2: Type II Frequencies ---\n    # Derived formula: f(mu) = omega_0 / (2 * pi)\n    f_mu_val = omega_0_hopf / (2 * np.pi)\n    \n    # The frequency is constant for all mu  0.\n    f_mu1 = f_mu_val\n    f_mu2 = f_mu_val\n    f_mu3 = f_mu_val\n\n    # --- Task 3: Type II Onset Frequency ---\n    # f_onset is the limit of f(mu) as mu - 0+\n    f_onset = f_mu_val\n\n    # --- Task 3: Ratio R ---\n    # R = smallest Type I frequency / Type II onset frequency\n    R = f_I1 / f_onset\n\n    # --- Assemble and Print Results ---\n    results = [f_I1, f_I2, f_I3, alpha, f_mu1, f_mu2, f_mu3, f_onset, R]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Moving from single neurons to networks, the collective dynamics can be far richer than the sum of their parts. Neural populations can exhibit slow, persistent activity crucial for functions like working memory, which arises from the network's recurrent connectivity. This practice uses linear systems analysis on a rate model to reveal how these slow dynamics emerge. By examining the eigenstructure of the network's Jacobian matrix, you will see how an eigenmode associated with an eigenvalue close to zero can create a \"slow manifold\" that governs the long-term recovery of the entire network. ",
            "id": "4006558",
            "problem": "Consider a linearized two-population neural rate model near a stable fixed point, with perturbation dynamics governed by the ordinary differential equation (ODE) $\\frac{d \\delta \\mathbf{r}}{dt} = J \\, \\delta \\mathbf{r}$, where $\\delta \\mathbf{r}(t) \\in \\mathbb{R}^{2}$ denotes small deviations of population firing rates from the fixed point and $J \\in \\mathbb{R}^{2 \\times 2}$ is the Jacobian of the dynamics evaluated at that fixed point. Assume no external input for $t \\geq 0$. \n\n1. Starting from the definition of the matrix exponential solution $\\delta \\mathbf{r}(t) = \\exp(J t) \\, \\delta \\mathbf{r}(0)$ and the eigenvalue–eigenvector relations for $J$, argue why a negative real eigenvalue $\\lambda_{\\mathrm{s}}$ with $\\lambda_{\\mathrm{s}}$ close to zero produces slow recovery dynamics along its associated eigenmode. Your argument must rely only on the expansion of $\\exp(J t)$ in the eigenbasis (including the use of left eigenvectors when $J$ is non-normal) and the fundamental property that each eigenmode evolves proportionally to $\\exp(\\lambda t)$.\n\n2. For the specific coupling matrix\n$$\nJ \\;=\\; \\begin{pmatrix} -0.02  3.00 \\\\ 0  -1.50 \\end{pmatrix},\n$$\nand the initial perturbation\n$$\n\\delta \\mathbf{r}(0) \\;=\\; \\begin{pmatrix} 0.50 \\\\ -1.00 \\end{pmatrix},\n$$\nconstruct the slow mode as follows. Compute the right eigenvector $\\mathbf{v}_{\\mathrm{s}}$ and the left eigenvector $\\mathbf{w}_{\\mathrm{s}}$ corresponding to the slow eigenvalue $\\lambda_{\\mathrm{s}}$ of $J$, and impose the biorthogonal normalization $\\mathbf{w}_{\\mathrm{s}}^{\\top} \\mathbf{v}_{\\mathrm{s}} = 1$. Then compute the scalar projection coefficient $c_{\\mathrm{s}}$ of the initial condition onto the slow eigenmode defined by $c_{\\mathrm{s}} = \\mathbf{w}_{\\mathrm{s}}^{\\top} \\delta \\mathbf{r}(0)$. \n\nProvide only the value of $c_{\\mathrm{s}}$ as your final answer. Do not round; an exact analytic expression is preferred if available. The final answer must be a single scalar value with no units.",
            "solution": "We start from the linear time-invariant ODE $\\frac{d \\delta \\mathbf{r}}{dt} = J \\, \\delta \\mathbf{r}$. The fundamental solution is given by the matrix exponential, $\\delta \\mathbf{r}(t) = \\exp(J t) \\, \\delta \\mathbf{r}(0)$. If $J$ is diagonalizable over $\\mathbb{C}$ with right eigenvectors $\\{\\mathbf{v}_{i}\\}$ and left eigenvectors $\\{\\mathbf{w}_{i}\\}$ satisfying $J \\mathbf{v}_{i} = \\lambda_{i} \\mathbf{v}_{i}$ and $J^{\\top} \\mathbf{w}_{i} = \\lambda_{i} \\mathbf{w}_{i}$, and normalized so that $\\mathbf{w}_{i}^{\\top} \\mathbf{v}_{j} = \\delta_{ij}$, then any initial condition can be expanded as $\\delta \\mathbf{r}(0) = \\sum_{i} c_{i} \\mathbf{v}_{i}$ with $c_{i} = \\mathbf{w}_{i}^{\\top} \\delta \\mathbf{r}(0)$. The time evolution follows\n$$\n\\delta \\mathbf{r}(t) \\;=\\; \\sum_{i} c_{i} \\, \\exp(\\lambda_{i} t) \\, \\mathbf{v}_{i}.\n$$\nThus, each eigenmode evolves as $\\exp(\\lambda_{i} t)$. If $\\lambda_{\\mathrm{s}}$ is real, negative, and close to zero, then along the slow mode $\\mathbf{v}_{\\mathrm{s}}$ the factor $\\exp(\\lambda_{\\mathrm{s}} t)$ decays slowly because $\\lambda_{\\mathrm{s}}$ has small magnitude. The characteristic recovery time scale is given by the inverse magnitude of the decay rate, namely $\\tau_{\\mathrm{s}} = -\\frac{1}{\\lambda_{\\mathrm{s}}}$ when $\\lambda_{\\mathrm{s}}  0$, so that the response along $\\mathbf{v}_{\\mathrm{s}}$ exhibits slow exponential decay with time constant $\\tau_{\\mathrm{s}}$.\n\nWe now compute the slow eigenmode projection for the given $J$ and $\\delta \\mathbf{r}(0)$. The matrix\n$$\nJ \\;=\\; \\begin{pmatrix} -0.02  3.00 \\\\ 0  -1.50 \\end{pmatrix}\n$$\nhas eigenvalues on the diagonal due to its upper triangular form: $\\lambda_{1} = -0.02$ and $\\lambda_{2} = -1.50$. The slow eigenvalue is $\\lambda_{\\mathrm{s}} = -0.02$.\n\nWe compute the right eigenvector $\\mathbf{v}_{\\mathrm{s}}$ for $\\lambda_{\\mathrm{s}}$ by solving $(J - \\lambda_{\\mathrm{s}} I)\\mathbf{v}_{\\mathrm{s}} = \\mathbf{0}$. For $\\lambda_{\\mathrm{s}} = -0.02$, we have $J - \\lambda_{\\mathrm{s}} I = J + 0.02 I = \\begin{pmatrix} 0  3 \\\\ 0  -1.48 \\end{pmatrix}$. The equations are $0 \\cdot v_{1} + 3 v_{2} = 0$ and $0 \\cdot v_{1} - 1.48 v_{2} = 0$, which imply $v_{2} = 0$, with $v_{1}$ free. We choose $\\mathbf{v}_{\\mathrm{s}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\nWe compute the left eigenvector $\\mathbf{w}_{\\mathrm{s}}$ for $\\lambda_{\\mathrm{s}}$ by solving $J^{\\top} \\mathbf{w}_{\\mathrm{s}} = \\lambda_{\\mathrm{s}} \\mathbf{w}_{\\mathrm{s}}$. The transpose is $J^{\\top} = \\begin{pmatrix} -0.02  0 \\\\ 3.00  -1.50 \\end{pmatrix}$. Then $J^{\\top} - \\lambda_{\\mathrm{s}} I = J^{\\top} + 0.02 I = \\begin{pmatrix} 0  0 \\\\ 3.00  -1.48 \\end{pmatrix}$. The system $(J^{\\top} - \\lambda_{\\mathrm{s}} I)\\mathbf{w}_{\\mathrm{s}} = \\mathbf{0}$ gives $3.00 \\, w_{1} - 1.48 \\, w_{2} = 0$, hence $w_{2} = \\frac{3.00}{1.48} \\, w_{1}$. Choosing $w_{1} = 1$ yields\n$$\n\\mathbf{w}_{\\mathrm{s}} \\;=\\; \\begin{pmatrix} 1 \\\\ \\dfrac{3.00}{1.48} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1 \\\\ \\dfrac{75}{37} \\end{pmatrix}.\n$$\nWe verify the biorthogonal normalization $\\mathbf{w}_{\\mathrm{s}}^{\\top} \\mathbf{v}_{\\mathrm{s}} = 1 \\cdot 1 + \\frac{75}{37} \\cdot 0 = 1$, so the chosen vectors satisfy $\\mathbf{w}_{\\mathrms}^{\\top} \\mathbf{v}_{\\mathrms} = 1$.\n\nThe slow-mode projection coefficient is defined as $c_{\\mathrm{s}} = \\mathbf{w}_{\\mathrm{s}}^{\\top} \\delta \\mathbf{r}(0)$. With $\\delta \\mathbf{r}(0) = \\begin{pmatrix} 0.50 \\\\ -1.00 \\end{pmatrix}$ we compute\n$$\nc_{\\mathrm{s}} \\;=\\; \\begin{pmatrix} 1  \\dfrac{75}{37} \\end{pmatrix} \\begin{pmatrix} 0.50 \\\\ -1.00 \\end{pmatrix}\n\\;=\\; 1 \\cdot 0.50 + \\dfrac{75}{37} \\cdot (-1.00)\n\\;=\\; \\dfrac{1}{2} - \\dfrac{75}{37}\n\\;=\\; \\dfrac{37}{74} - \\dfrac{150}{74}\n\\;=\\; -\\dfrac{113}{74}.\n$$\nTherefore, the requested scalar projection coefficient onto the slow eigenmode is the exact value $-\\dfrac{113}{74}$.",
            "answer": "$$\\boxed{-\\dfrac{113}{74}}$$"
        }
    ]
}