{
    "hands_on_practices": [
        {
            "introduction": "Hodgkin-Huxley模型以其生物物理细节的精确性而著称，但其在特定条件下的行为可以揭示出简洁的原理。本练习将探讨神经元对阶跃电流输入的瞬时响应。通过分析状态变量的连续性，我们将证明，尽管离子通道动力学很复杂，但膜电位的初始变化率完全由其电容特性决定，这凸显了在不同时间尺度上分离主导动力学的重要性。",
            "id": "4006566",
            "problem": "考虑一个空间上等电位的乌贼轴突膜片的霍奇金-赫胥黎（Hodgkin–Huxley, HH）常微分方程（ODE）模型。该膜遵循电容性电荷平衡\n$$\nC_{m}\\,\\frac{dV}{dt} \\;=\\; - I_{\\text{ion}}(V,m,h,n) \\;+\\; I_{\\text{app}}(t),\n$$\n其中 $V$ 是膜电压，$C_{m}$ 是单位面积的膜电容，$I_{\\text{app}}(t)$ 是外部施加的电流密度，$I_{\\text{ion}}$ 是总离子电流，其模型为\n$$\nI_{\\text{ion}}(V,m,h,n) \\;=\\; g_{\\text{Na}}\\,m^{3}h\\,(V - E_{\\text{Na}}) \\;+\\; g_{\\text{K}}\\,n^{4}\\,(V - E_{\\text{K}}) \\;+\\; g_{L}\\,(V - E_{L}).\n$$\n门控变量 $m$、$h$ 和 $n$ 由以下形式的一阶常微分方程控制\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha_{x}(V)\\,\\big(1-x\\big) \\;-\\; \\beta_{x}(V)\\,x, \\quad x \\in \\{m,h,n\\},\n$$\n其中 $\\alpha_{x}(V)$ 和 $\\beta_{x}(V)$ 是电压依赖性速率函数。\n\n假设在 $t  0$ 时，膜被钳制在一个稳态静息状态，其中 $I_{\\text{app}}(t) = 0$，因此有 $V(t) = V_{0}$、$m(t) = m_{0}$、$h(t) = h_{0}$、$n(t) = n_{0}$，并且不动点条件\n$$\n\\frac{dV}{dt} = 0, \\quad \\frac{dm}{dt} = 0, \\quad \\frac{dh}{dt} = 0, \\quad \\frac{dn}{dt} = 0\n$$\n成立，这意味着 $I_{\\text{ion}}(V_{0},m_{0},h_{0},n_{0}) = 0$。\n\n在时间 $t = 0$ 时，施加一个阶跃电流，\n$$\nI_{\\text{app}}(t) \\;=\\; \\Delta I\\,u(t),\n$$\n其中 $u(t)$ 是亥维赛阶跃函数，$\\Delta I$ 是一个恒定的振幅。使用关于静息不动点的小信号近似，解析地确定在阶跃开始后瞬间的初始时间导数 $\\dot{V}(0^{+})$。膜和电流的参数如下：\n- $C_{m} = 1.3\\,\\mu\\text{F}/\\text{cm}^{2}$,\n- $\\Delta I = 9.1\\,\\mu\\text{A}/\\text{cm}^{2}$,\n- $g_{\\text{Na}} = 120\\,\\text{mS}/\\text{cm}^{2}$, $E_{\\text{Na}} = 50\\,\\text{mV}$,\n- $g_{\\text{K}} = 36\\,\\text{mS}/\\text{cm}^{2}$, $E_{\\text{K}} = -77\\,\\text{mV}$,\n- $g_{L} = 0.3\\,\\text{mS}/\\text{cm}^{2}$, $E_{L} = -54.4\\,\\text{mV}$。\n\n假设门控变量是连续的，在阶跃开始时不能瞬时改变。请将 $\\dot{V}(0^{+})$ 的最终答案以 $\\text{mV}/\\text{ms}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "问题要求计算在对一个由霍奇金-赫胥黎方程建模的神经元施加阶跃电流后，膜电压的初始时间导数 $\\dot{V}(0^{+})$。\n\n控制膜电压 $V$ 的常微分方程（ODE）如下所示：\n$$\nC_{m}\\,\\frac{dV}{dt} \\;=\\; - I_{\\text{ion}}(V,m,h,n) \\;+\\; I_{\\text{app}}(t)\n$$\n其中 $C_m$ 是膜电容，$I_{\\text{ion}}$ 是通过膜通道的总离子电流，$I_{\\text{app}}(t)$ 是外部施加的电流。我们被要求在时间 $t$ 从正方向趋近于 $0$（记作 $t \\to 0^{+}$）的极限下计算这个方程。\n$$\nC_{m}\\,\\frac{dV}{dt}\\bigg|_{t=0^{+}} \\;=\\; - I_{\\text{ion}}\\big(V(0^{+}), m(0^{+}), h(0^{+}), n(0^{+})\\big) \\;+\\; I_{\\text{app}}(0^{+})\n$$\n符号 $\\dot{V}(0^{+})$ 用于表示 $\\frac{dV}{dt}\\big|_{t=0^{+}}$。\n\n系统的状态变量是膜电压 $V$ 和门控变量 $m$、$h$ 和 $n$。它们的动力学由一阶常微分方程描述。由带有非脉冲强迫函数的一阶常微分方程描述的系统的一个基本性质是，其状态变量必须是时间的连续函数。电压 $V$ 是与电容器相关的状态变量，其变化率 $\\frac{dV}{dt}$ 是有限的，这意味着 $V(t)$ 不能瞬时改变。问题陈述明确假设门控变量 $m$、$h$ 和 $n$ 也是连续的。\n\n因此，在 $t=0^{+}$ 时电流阶跃发生后瞬间的状态变量值与在 $t=0^{-}$ 时阶跃发生前瞬间的值相同：\n$$\nV(0^{+}) = V(0^{-}) = V_{0}\n$$\n$$\nm(0^{+}) = m(0^{-}) = m_{0}\n$$\n$$\nh(0^{+}) = h(0^{-}) = h_{0}\n$$\n$$\nn(0^{+}) = n(0^{-}) = n_{0}\n$$\n这里，$V_0$、$m_0$、$h_0$ 和 $n_0$ 是在 $t  0$ 时变量的稳态（静息）值。\n\n将这些连续性关系代入 $t=0^{+}$ 时的电压方程，得到：\n$$\nC_{m}\\,\\dot{V}(0^{+}) \\;=\\; - I_{\\text{ion}}(V_{0}, m_{0}, h_{0}, n_{0}) \\;+\\; I_{\\text{app}}(0^{+})\n$$\n问题指出，在 $t  0$ 时，膜处于稳态静息状态，此时 $I_{\\text{app}}(t) = 0$。在这种状态下，所有的时间导数都为零。根据电压的常微分方程，当 $\\frac{dV}{dt}=0$ 且 $I_{\\text{app}}=0$ 时，我们有：\n$$\n0 = -I_{\\text{ion}}(V_{0}, m_{0}, h_{0}, n_{0}) + 0 \\implies I_{\\text{ion}}(V_{0}, m_{0}, h_{0}, n_{0}) = 0\n$$\n这意味着在静息状态下，净离子电流为零。这极大地简化了我们计算 $\\dot{V}(0^{+})$ 的方程，因为我们不需要计算 $V_0, m_0, h_0, n_0$ 的具体值，也不需要使用 $I_{\\text{ion}}$ 的详细表达式。\n\n施加的电流由 $I_{\\text{app}}(t) = \\Delta I\\,u(t)$ 给出，其中 $u(t)$ 是亥维赛阶跃函数。对于 $t  0$，$u(t) = 1$。因此，在阶跃发生后瞬间施加的电流值为：\n$$\nI_{\\text{app}}(0^{+}) = \\lim_{t\\to 0^+} \\Delta I\\,u(t) = \\Delta I \\cdot 1 = \\Delta I\n$$\n将静息离子电流和在 $t=0^{+}$ 时施加的电流值代入电压方程，我们得到：\n$$\nC_{m}\\,\\dot{V}(0^{+}) \\;=\\; - (0) \\;+\\; \\Delta I\n$$\n$$\nC_{m}\\,\\dot{V}(0^{+}) \\;=\\; \\Delta I\n$$\n求解 $\\dot{V}(0^{+})$ 得到解析结果：\n$$\n\\dot{V}(0^{+}) \\;=\\; \\frac{\\Delta I}{C_{m}}\n$$\n这个结果表明，膜的初始响应是纯电容性的。由门控变量和各种电导描述的离子通道的复杂动力学不影响电压的瞬时变化率，因为门控变量不能瞬时改变。用于离子电流的众多参数（$g_{\\text{Na}}$、$E_{\\text{Na}}$ 等）对于这个特定计算是不需要的。\n\n现在我们代入给定的数值：\n-   $C_{m} = 1.3\\,\\mu\\text{F}/\\text{cm}^{2} = 1.3 \\times 10^{-6}\\,\\text{F}/\\text{cm}^{2}$\n-   $\\Delta I = 9.1\\,\\mu\\text{A}/\\text{cm}^{2} = 9.1 \\times 10^{-6}\\,\\text{A}/\\text{cm}^{2}$\n\n$$\n\\dot{V}(0^{+}) = \\frac{9.1 \\times 10^{-6}\\,\\text{A}/\\text{cm}^{2}}{1.3 \\times 10^{-6}\\,\\text{F}/\\text{cm}^{2}} = \\frac{9.1}{1.3} \\, \\frac{\\text{A}}{\\text{F}}\n$$\n计算得出：\n$$\n\\frac{9.1}{1.3} = 7\n$$\n单位是伏特每秒（Volts per second），因为 $1\\,\\text{A} = 1\\,\\text{C}/\\text{s}$ 且 $1\\,\\text{F} = 1\\,\\text{C}/\\text{V}$，所以 $\\frac{\\text{A}}{\\text{F}} = \\frac{\\text{C}/\\text{s}}{\\text{C}/\\text{V}} = \\frac{\\text{V}}{\\text{s}}$。\n$$\n\\dot{V}(0^{+}) = 7 \\, \\text{V}/\\text{s}\n$$\n问题要求答案以毫伏每毫秒（$\\text{mV}/\\text{ms}$）为单位。我们进行单位转换：\n$$\n1\\,\\frac{\\text{V}}{\\text{s}} = 1\\,\\frac{1000\\,\\text{mV}}{1000\\,\\text{ms}} = 1\\,\\frac{\\text{mV}}{\\text{ms}}\n$$\n因此，经过这个特定的单位转换后，数值保持不变。\n$$\n\\dot{V}(0^{+}) = 7 \\, \\text{mV}/\\text{ms}\n$$\n最后，我们必须按要求将答案四舍五入到四位有效数字。\n$$\n\\dot{V}(0^{+}) = 7.000 \\, \\text{mV}/\\text{ms}\n$$",
            "answer": "$$\\boxed{7.000}$$"
        },
        {
            "introduction": "神经元的放电阈值通常不只是一个固定的电压值，而是一个由系统状态决定的动态边界。本练习使用简化的FitzHugh-Nagumo模型，在相平面中将这一概念可视化。我们将通过线性化系统在鞍点平衡点附近的动力学，并利用其稳定流形来近似决定兴奋与否的分界线（separatrix），从而将相平面分析的抽象工具与兴奋性的核心神经科学概念联系起来。",
            "id": "4006486",
            "problem": "考虑无量纲的 FitzHugh–Nagumo 模型，它是 Hodgkin–Huxley 方程的一个二维简化版本，用于大脑建模和计算神经科学中研究可兴奋性和动作电位的激发。该常微分方程 (ODE) 系统为\n$$\n\\frac{d u}{d t} = u - \\frac{u^{3}}{3} - v + I_{\\text{ext}}, \\qquad \\frac{d v}{d t} = \\epsilon \\left(u + \\alpha - \\beta v\\right),\n$$\n其中 $u$ 是快电压类变量，$v$ 是慢恢复变量，$\\epsilon  0$ 是时间尺度分离参数，$\\beta  0$ 是恢复强度参数，而 $I_{\\text{ext}}$ 是恒定的外部输入。\n\n您将分析鞍点平衡附近的相平面，以近似阈值分界线，该分界线将松弛回到静息状态的小扰动与逃逸向兴奋周期的小扰动分开。施加参数关系 $\\alpha = \\beta I_{\\text{ext}}$ 并假设 $\\beta  1$ 和 $I_{\\text{ext}}  0$。\n\n仅使用平面动力系统的基本原理（零斜线、平衡点、雅可比线性化以及通过迹和行列式进行分类），完成以下操作：\n\n1. 验证给定参数关系所隐含的平衡点的存在性和位置，并确定当 $\\beta  1$ 时其类型。\n2. 在该平衡点处对矢量场进行线性化，并通过从雅可比矩阵的特征结构中提取信息，计算 $(u,v)$ 相平面中局部稳定流形的斜率。\n3. 使用此局部稳定流形作为鞍点附近阈值分界线的线性近似。考虑初始条件限制在直线 $v(0) = 0$ 上。计算相应的近似阈值 $u_{\\text{th}}$ 的闭式解，使得初始条件 $(u(0), v(0)) = (u_{\\text{th}}, 0)$ 位于穿过鞍点的这条分界线上。\n\n将您的最终答案 $u_{\\text{th}}$ 表示为关于 $\\epsilon$、$\\beta$ 和 $I_{\\text{ext}}$ 的单一解析表达式。不要四舍五入或近似；不需要数值。",
            "solution": "该问题要求在特定参数约束下，近似 FitzHugh–Nagumo 模型中的阈值电压 $u_{\\text{th}}$。方法是在其鞍点平衡点处对系统进行线性化，并使用局部稳定流形作为真实非线性分界线的线性近似。\n\n该常微分方程 (ODE) 系统由下式给出：\n$$\n\\frac{d u}{d t} = f(u,v) = u - \\frac{u^{3}}{3} - v + I_{\\text{ext}}\n$$\n$$\n\\frac{d v}{d t} = g(u,v) = \\epsilon \\left(u + \\alpha - \\beta v\\right)\n$$\n分析受制于参数关系 $\\alpha = \\beta I_{\\text{ext}}$ 和约束条件 $\\epsilon  0$，$\\beta  1$ 以及 $I_{\\text{ext}}  0$。\n\n首先，我们通过将两个时间导数都设为零来找到平衡点 $(u^*, v^*)$，即 $\\frac{du}{dt} = 0$ 和 $\\frac{dv}{dt} = 0$。\n条件 $\\frac{dv}{dt} = 0$ 给出 $v$-零斜线。因为 $\\epsilon \\neq 0$：\n$$\nu^* + \\alpha - \\beta v^* = 0 \\implies v^* = \\frac{u^* + \\alpha}{\\beta}\n$$\n条件 $\\frac{du}{dt} = 0$ 给出 $u$-零斜线：\n$$\nu^* - \\frac{(u^*)^{3}}{3} - v^* + I_{\\text{ext}} = 0 \\implies v^* = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n为了找到平衡点，我们将 $v^*$ 的表达式相等：\n$$\n\\frac{u^* + \\alpha}{\\beta} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n现在，我们应用给定的参数关系 $\\alpha = \\beta I_{\\text{ext}}$：\n$$\n\\frac{u^* + \\beta I_{\\text{ext}}}{\\beta} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n$$\n\\frac{u^*}{\\beta} + I_{\\text{ext}} = u^* - \\frac{(u^*)^{3}}{3} + I_{\\text{ext}}\n$$\n$$\n\\frac{u^*}{\\beta} = u^* - \\frac{(u^*)^{3}}{3}\n$$\n重新整理各项可得：\n$$\nu^* \\left(1 - \\frac{1}{\\beta} - \\frac{(u^*)^2}{3}\\right) = 0\n$$\n这揭示了 $u^*$ 的三个可能的平衡值：$u^*=0$ 和 $u^*=\\pm\\sqrt{3(1-1/\\beta)}$。问题提到“给定参数关系所隐含的平衡点”，这简化了分析。我们感兴趣的特定平衡点来自于最简单的解，$u^*=0$。\n对于 $u^* = 0$，相应的 $v^*$ 坐标是：\n$$\nv^* = \\frac{0 + \\alpha}{\\beta} = \\frac{\\beta I_{\\text{ext}}}{\\beta} = I_{\\text{ext}}\n$$\n因此，平衡点是 $(u_{eq}, v_{eq}) = (0, I_{\\text{ext}})$。\n\n接下来，我们通过对系统进行线性化来对此平衡点进行分类。雅可比矩阵 $J(u,v)$ 是：\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 1 - u^2  -1 \\\\ \\epsilon  -\\epsilon \\beta \\end{pmatrix}\n$$\n在平衡点 $(0, I_{\\text{ext}})$ 处计算雅可比矩阵：\n$$\nJ_{\\text{eq}} = J(0, I_{\\text{ext}}) = \\begin{pmatrix} 1  -1 \\\\ \\epsilon  -\\epsilon \\beta \\end{pmatrix}\n$$\n平衡点的稳定性由该矩阵的迹 $\\text{Tr}(J_{\\text{eq}})$ 和行列式 $\\text{Det}(J_{\\text{eq}})$ 决定。\n$$\n\\text{Tr}(J_{\\text{eq}}) = 1 - \\epsilon \\beta\n$$\n$$\n\\text{Det}(J_{\\text{eq}}) = (1)(-\\epsilon \\beta) - (-1)(\\epsilon) = \\epsilon(1 - \\beta)\n$$\n给定 $\\epsilon  0$ 和 $\\beta  1$，我们有 $1-\\beta  0$，这意味着 $\\text{Det}(J_{\\text{eq}})  0$。负行列式表明两个特征值都是实数且符号相反。这是鞍点的定义特征。这证实了问题将此平衡点先验地识别为鞍点的说法。\n\n划分相空间的分界线由该鞍点的稳定流形给出。在平衡点附近，稳定流形可以近似为与其相切的一条直线，其方向由对应于稳定（负）特征值 $\\lambda_s$ 的特征向量给出。特征值 $\\lambda$ 是特征方程 $\\det(J_{\\text{eq}} - \\lambda I) = 0$ 的根：\n$$\n\\lambda^2 - \\text{Tr}(J_{\\text{eq}})\\lambda + \\text{Det}(J_{\\text{eq}}) = 0\n$$\n$$\n\\lambda^2 - (1 - \\epsilon \\beta)\\lambda + \\epsilon(1 - \\beta) = 0\n$$\n稳定特征值 $\\lambda_s$ 是较小的根：\n$$\n\\lambda_s = \\frac{(1 - \\epsilon \\beta) - \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon(1 - \\beta)}}{2}\n$$\n对应于 $\\lambda_s$ 的特征向量 $\\mathbf{e}_s = \\begin{pmatrix} e_u \\\\ e_v \\end{pmatrix}$ 满足 $(J_{\\text{eq}} - \\lambda_s I) \\mathbf{e}_s = \\mathbf{0}$。从此矩阵方程的第一行：\n$$\n(1 - \\lambda_s) e_u - e_v = 0 \\implies e_v = (1 - \\lambda_s) e_u\n$$\n局部稳定流形的斜率 $m_s$ 是比率 $\\frac{e_v}{e_u}$：\n$$\nm_s = 1 - \\lambda_s = 1 - \\frac{(1 - \\epsilon \\beta) - \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon(1 - \\beta)}}{2}\n$$\n$$\nm_s = \\frac{2 - (1 - \\epsilon \\beta) + \\sqrt{(1 - \\epsilon \\beta)^2 - 4\\epsilon + 4\\epsilon \\beta}}{2}\n$$\n$$\nm_s = \\frac{1 + \\epsilon \\beta + \\sqrt{1 - 2\\epsilon \\beta + \\epsilon^2 \\beta^2 - 4\\epsilon + 4\\epsilon \\beta}}{2}\n$$\n$$\nm_s = \\frac{1 + \\epsilon \\beta + \\sqrt{1 + 2\\epsilon \\beta + \\epsilon^2 \\beta^2 - 4\\epsilon}}{2} = \\frac{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}{2}\n$$\n代表局部稳定流形的直线方程穿过鞍点 $(0, I_{\\text{ext}})$，斜率为 $m_s$：\n$$\nv - v_{eq} = m_s (u - u_{eq}) \\implies v - I_{\\text{ext}} = m_s u\n$$\n问题要求对于位于此分界线上的初始条件 $(u(0), v(0)) = (u_{\\text{th}}, 0)$，求其阈值 $u_{\\text{th}}$。我们将这些坐标代入直线方程：\n$$\n0 - I_{\\text{ext}} = m_s (u_{\\text{th}})\n$$\n求解 $u_{\\text{th}}$：\n$$\nu_{\\text{th}} = -\\frac{I_{\\text{ext}}}{m_s}\n$$\n代入 $m_s$ 的表达式：\n$$\nu_{\\text{th}} = -\\frac{I_{\\text{ext}}}{\\frac{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}{2}}\n$$\n$$\nu_{\\text{th}} = -\\frac{2 I_{\\text{ext}}}{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}\n$$\n这就是近似阈值 $u_{\\text{th}}$ 的最终解析表达式。",
            "answer": "$$\\boxed{-\\frac{2 I_{\\text{ext}}}{1 + \\epsilon \\beta + \\sqrt{(1 + \\epsilon \\beta)^2 - 4\\epsilon}}}$$"
        },
        {
            "introduction": "神经元如何开始重复放电？根据其动力学特性，神经元可分为两大类：I型和II型兴奋性，它们在放电起始时表现出截然不同的行为。本练习通过分析两种典型的规范形式模型，推导它们的频率-电流（$f-I$）关系，揭示定义这两类神经元的普适标度律。这个实践将展示分岔理论如何解释神经元从静息到放电这一基本转变的特征。",
            "id": "4006496",
            "problem": "给定两个典型的神经元兴奋性常微分方程模型，它们能够捕捉在恒定输入下重复发放的起始过程。一个是 I 型模型，在阈值处表现为不变圆上的鞍结（SNIC）分岔；另一个是 II 型模型，在阈值处表现为超临界 Hopf 分岔。您的任务是根据第一性原理计算两种模型在阈值附近的频率-电流（$f$–$I$）曲线，并使用标度律比较它们的起始行为。所有涉及频率的答案都必须以赫兹（Hz，等同于 $\\mathrm{s}^{-1}$）表示，如果出现任何角度，应以弧度为单位。\n\n模型规格：\n\n- I 型（SNIC）典范式：二次积分放电（QIF）模型\n  $$\\frac{dV}{dt} = a\\left(V^2 + I\\right),$$\n  其中 $V$ 是膜电压，$I \\ge 0$ 是恒定输入电流，$a  0$ 是一个时间尺度参数，单位为 $\\mathrm{s}^{-1}$。在这个理想化模型中，当轨迹从 $V=-\\infty$ 演化到 $V=+\\infty$ 时，会产生一个锋电位，锋电位间期（周期）$T(I)$ 是从 $V=-\\infty$ 穿越到 $V=+\\infty$ 所需的时间。频率为 $f(I) = 1/T(I)$。\n\n- II 型（Hopf）典范式：超临界 Hopf 振子的范式\n  $$\\frac{dz}{dt} = \\left(\\mu + i\\omega_0\\right)z - |z|^2 z,$$\n  其中 $z \\in \\mathbb{C}$ 代表一个二维状态，$\\mu$ 是一个控制振荡起始的实分岔参数，$\\omega_0  0$ 是起始时线性化振子的角频率（单位为 $\\mathrm{rad/s}$）。对于持续振荡，$\\mu  0$ 会产生一个稳定的极限环。频率 $f(\\mu)$ 定义为极限环振荡的时间频率，单位为 $\\mathrm{Hz}$。\n\n在您的推导中使用的基本依据：\n- 频率定义为周期的倒数，$f = 1/T$。\n- 对于形式为 $\\frac{dx}{dt} = F(x)$ 的一维流，两个位置 $x_1$ 和 $x_2$ 之间的渡越时间为 $T = \\int_{x_1}^{x_2} \\frac{dx}{F(x)}$。\n- 对于用极坐标 $z = r e^{i\\theta}$ 表示的 Hopf 范式，演化方程为 $\\frac{dr}{dt} = \\mu r - r^3$ 和 $\\frac{d\\theta}{dt} = \\omega_0$。\n\n任务：\n1. 使用周期在电压从 $V=-\\infty$ 到 $V=+\\infty$ 的偏移范围上的积分定义，推导 I 型 QIF 模型在阈值附近的 $f$–$I$ 关系。以 $\\mathrm{Hz}$ 为单位提供频率。\n2. 使用极坐标分解和 $\\mu  0$ 时极限环的性质，推导 II 型 Hopf 模型在阈值附近的 $f$–$\\mu$ 关系。以 $\\mathrm{Hz}$ 为单位提供频率。\n3. 使用推导出的表达式，为下面指定的测试套件参数计算频率值。然后，通过在对数-对数尺度上，使用最小二乘法对给定电流值拟合幂律 $f(I) \\propto (I - I_c)^\\alpha$（阈值设为 $I_c = 0$），来估计 I 型模型的起始标度指数 $\\alpha$。最后，将 II 型模型的起始频率 $f_{\\mathrm{onset}}$ 估计为 $f(\\mu)$ 在 $\\mu \\to 0^+$ 时的极限，并计算最小的 I 型频率与此起始频率之比 $R$。\n\n测试套件（单位至关重要，必须遵守）：\n- I 型（QIF）参数：$a = 200$（单位 $\\mathrm{s}^{-1}$），$I$ 值 $I \\in \\{1\\times 10^{-6},\\ 1\\times 10^{-3},\\ 1\\times 10^{-1}\\}$（无量纲）。\n- II 型（Hopf）参数：$\\omega_0 = 2\\pi \\cdot 10$（单位 $\\mathrm{rad/s}$），$\\mu$ 值 $\\mu \\in \\{1\\times 10^{-9},\\ 1\\times 10^{-6},\\ 1\\times 10^{-3}\\}$（无量纲）。\n\n输出规格：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序和单位排列：\n- 三个 I 型频率 $f(I)$，单位为 $\\mathrm{Hz}$，按上述顺序列出，在给定的 $I$ 值下计算。\n- 拟合的 I 型起始标度指数 $\\alpha$（无量纲）。\n- 三个 II 型频率 $f(\\mu)$，单位为 $\\mathrm{Hz}$，按上述顺序列出，在给定的 $\\mu$ 值下计算。\n- II 型起始频率 $f_{\\mathrm{onset}}$，单位为 $\\mathrm{Hz}$。\n- 最小的 I 型频率与 $f_{\\mathrm{onset}}$ 之比 $R$（无量纲）。\n\n因此，输出应具有以下形式 $[f_{I_1}, f_{I_2}, f_{I_3}, \\alpha, f_{\\mu_1}, f_{\\mu_2}, f_{\\mu_3}, f_{\\mathrm{onset}}, R]$，其中所有条目均为浮点数。",
            "solution": "该问题要求推导和比较两种典型神经元模型的频率-电流（$f-I$）关系，一个 I 型二次积分放电（QIF）模型和一个由超临界 Hopf 分岔范式表示的 II 型模型。分析将从第一性原理出发，然后对一组给定参数进行数值评估和标度分析。\n\n### 第 1 部分：I 型（二次积分放电）模型分析\n\nQIF 模型由以下常微分方程描述：\n$$\n\\frac{dV}{dt} = a\\left(V^2 + I\\right)\n$$\n其中 $V$ 是膜电压，$I \\ge 0$ 是输入电流，$a  0$ 是一个时间尺度参数，单位为 $\\mathrm{s}^{-1}$。发放阈值为 $I_c = 0$。对于 $I  0$，方程的右侧始终为正，这意味着没有不动点，电压 $V$ 单调增加。该模型将锋电位定义为轨迹从 $V = -\\infty$ 穿越到 $V = +\\infty$。锋电位间期，或周期 $T(I)$，是完成此过程所需的时间。\n\n使用所提供的一维流中渡越时间的公式，我们可以将周期写成一个积分：\n$$\nT(I) = \\int_{V_1}^{V_2} \\frac{dV}{F(V)} = \\int_{-\\infty}^{+\\infty} \\frac{dV}{a(V^2 + I)}\n$$\n我们可以求解这个积分。由于 $I  0$，我们可以令 $I = (\\sqrt{I})^2$。该积分是一个标准形式：\n$$\nT(I) = \\frac{1}{a} \\int_{-\\infty}^{+\\infty} \\frac{dV}{V^2 + (\\sqrt{I})^2}\n$$\n$\\frac{1}{x^2+k^2}$ 的反导数是 $\\frac{1}{k}\\arctan(\\frac{x}{k})$。应用此公式，我们得到：\n$$\nT(I) = \\frac{1}{a} \\left[ \\frac{1}{\\sqrt{I}} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) \\right]_{V=-\\infty}^{V=+\\infty}\n$$\n在极限处计算此表达式：\n$$\nT(I) = \\frac{1}{a\\sqrt{I}} \\left( \\lim_{V\\to+\\infty} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) - \\lim_{V\\to-\\infty} \\arctan\\left(\\frac{V}{\\sqrt{I}}\\right) \\right)\n$$\n当反正切函数的参数趋近于 $\\pm\\infty$ 时，函数本身趋近于 $\\pm\\frac{\\pi}{2}$。\n$$\nT(I) = \\frac{1}{a\\sqrt{I}} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{a\\sqrt{I}} (\\pi) = \\frac{\\pi}{a\\sqrt{I}}\n$$\n频率 $f(I)$ 是周期 $T(I)$ 的倒数：\n$$\nf(I) = \\frac{1}{T(I)} = \\frac{a\\sqrt{I}}{\\pi}\n$$\n这就是 QIF 模型的 $f-I$ 关系。该关系表明，发放频率在 $I=0$ 时从 $f=0$ 开始，并随着超阈值电流 $I$ 的平方根而增加。这是 I 型神经元的典型行为。\n\n### 第 2 部分：II 型（Hopf 范式）模型分析\n\nII 型模型由超临界 Hopf 分岔的范式给出：\n$$\n\\frac{dz}{dt} = \\left(\\mu + i\\omega_0\\right)z - |z|^2 z\n$$\n其中 $z$ 是一个复变量，$\\mu$ 是分岔参数，$\\omega_0  0$ 是固有角频率。振荡阈值为 $\\mu_c=0$。对于持续振荡，我们需要 $\\mu  0$。\n\n为了分析频率，我们通过设置 $z = r e^{i\\theta}$ 将系统转换为极坐标，其中 $r = |z|$ 是振幅，$\\theta = \\arg(z)$ 是相位。时间导数为 $\\frac{dz}{dt} = (\\frac{dr}{dt} + i r \\frac{d\\theta}{dt})e^{i\\theta}$。将其代入方程：\n$$\n(\\frac{dr}{dt} + ir\\frac{d\\theta}{dt})e^{i\\theta} = (\\mu + i\\omega_0)r e^{i\\theta} - |r e^{i\\theta}|^2 r e^{i\\theta}\n$$\n两边同除以 $e^{i\\theta}$（因为它非零）并注意到 $|r e^{i\\theta}|^2 = r^2$：\n$$\n\\frac{dr}{dt} + ir\\frac{d\\theta}{dt} = (\\mu + i\\omega_0)r - r^3 = (\\mu r - r^3) + i(\\omega_0 r)\n$$\n令实部和虚部相等，得到振幅和相位的动力学方程：\n$$\n\\frac{dr}{dt} = \\mu r - r^3 = r(\\mu - r^2)\n$$\n$$\nr\\frac{d\\theta}{dt} = \\omega_0 r \\implies \\frac{d\\theta}{dt} = \\omega_0 \\quad (\\text{for } r \\neq 0)\n$$\n对于 $\\mu  0$，径向方程在 $r_{LC} = \\sqrt{\\mu}$ 处有一个稳定不动点，对应于一个稳定的极限环。在 $r=0$ 处的不动点是不稳定的。在这个极限环上，振幅是恒定的，$r = \\sqrt{\\mu}$，相位以恒定的角速度演化：\n$$\n\\frac{d\\theta}{dt} = \\omega_0\n$$\n因此，极限环上的振荡角频率为 $\\omega = \\omega_0$。以赫兹（$f$）为单位的时间频率与以 $\\mathrm{rad/s}$ 为单位的角频率的关系是 $f = \\omega / (2\\pi)$。因此，对于任何 $\\mu  0$ 的稳定振荡频率是：\n$$\nf(\\mu) = \\frac{\\omega_0}{2\\pi}\n$$\n值得注意的是，对于这种典范式，振荡频率是恒定的，且与距分岔点 $\\mu$ 的距离无关。这意味着当 $\\mu$ 穿过 0 时，振荡以一个有限的、非零的频率出现。这是 II 型神经元的典型行为。\n\n### 第 3 部分：数值计算与标度分析\n\n我们现在将推导出的公式应用于指定的测试套件。\n\n**I 型模型频率：**\n使用 $f(I) = \\frac{a\\sqrt{I}}{\\pi}$，其中 $a = 200 \\ \\mathrm{s}^{-1}$ 且 $I \\in \\{1\\times 10^{-6}, 1\\times 10^{-3}, 1\\times 10^{-1}\\}$：\n$f(10^{-6}) = \\frac{200 \\sqrt{10^{-6}}}{\\pi} = \\frac{200 \\times 10^{-3}}{\\pi} = \\frac{0.2}{\\pi} \\ \\mathrm{Hz}$。\n$f(10^{-3}) = \\frac{200 \\sqrt{10^{-3}}}{\\pi} = \\frac{200 \\times 10^{-1.5}}{\\pi} \\ \\mathrm{Hz}$。\n$f(10^{-1}) = \\frac{200 \\sqrt{10^{-1}}}{\\pi} = \\frac{200 \\times 10^{-0.5}}{\\pi} \\ \\mathrm{Hz}$。\n\n**I 型标度指数 $\\alpha$：**\n问题要求在标度律 $f(I) \\propto (I-I_c)^\\alpha$ 中估计指数 $\\alpha$，其中 $I_c=0$。根据我们的推导，$f(I) = (\\frac{a}{\\pi})I^{1/2}$，所以该关系是一个指数为 $\\alpha = 1/2$ 的精确幂律。为了通过要求的拟合程序来证实这一点，我们可以对对数数据进行线性回归。对关系式取自然对数得到：$\\ln(f(I)) = \\ln(\\frac{a}{\\pi}) + \\frac{1}{2}\\ln(I)$。这是一个 $y = m x + c$ 形式的线性关系，其中 $y=\\ln(f(I))$，$x=\\ln(I)$，斜率为 $m=\\alpha=1/2$。对数据点 $(\\ln(I_k), \\ln(f(I_k)))$ 进行最小二乘拟合将得到精确为 0.5 的斜率。\n\n**II 型模型频率：**\n使用 $f(\\mu) = \\frac{\\omega_0}{2\\pi}$，其中 $\\omega_0 = 2\\pi \\cdot 10 \\ \\mathrm{rad/s}$ 且 $\\mu \\in \\{1\\times 10^{-9}, 1\\times 10^{-6}, 1\\times 10^{-3}\\}$：\n$f(\\mu) = \\frac{2\\pi \\cdot 10}{2\\pi} = 10 \\ \\mathrm{Hz}$ 对于所有 $\\mu  0$。因此，$f(10^{-9}) = 10 \\ \\mathrm{Hz}$，$f(10^{-6}) = 10 \\ \\mathrm{Hz}$，以及 $f(10^{-3}) = 10 \\ \\mathrm{Hz}$。\n\n**II 型起始频率 $f_{\\mathrm{onset}}$：**\n起始频率是当分岔参数从上方接近阈值时 $f(\\mu)$ 的极限：\n$f_{\\mathrm{onset}} = \\lim_{\\mu\\to 0^+} f(\\mu) = \\lim_{\\mu\\to 0^+} 10 = 10 \\ \\mathrm{Hz}$。\n\n**比率 $R$：**\n比率 $R$ 定义为最小的 I 型频率除以 II 型的起始频率。给定的最小电流是 $I=10^{-6}$。\n$R = \\frac{f(I=10^{-6})}{f_{\\mathrm{onset}}} = \\frac{0.2/\\pi \\ \\mathrm{Hz}}{10 \\ \\mathrm{Hz}} = \\frac{0.02}{\\pi}$。\n\n以下程序将对这些值进行数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares firing frequencies for Type I and Type II neuron models.\n    \"\"\"\n\n    # --- Test Suite Parameters ---\n    # Type I (QIF) model parameters\n    a_qif = 200.0  # s^-1\n    I_vals = np.array([1e-6, 1e-3, 1e-1])  # dimensionless\n\n    # Type II (Hopf) model parameters\n    omega_0_hopf = 2 * np.pi * 10.0  # rad/s\n    mu_vals = np.array([1e-9, 1e-6, 1e-3])  # dimensionless\n\n    # --- Task 1: Type I Frequencies ---\n    # Derived formula: f(I) = a * sqrt(I) / pi\n    f_I = (a_qif * np.sqrt(I_vals)) / np.pi\n    \n    f_I1, f_I2, f_I3 = f_I[0], f_I[1], f_I[2]\n\n    # --- Task 3: Type I Onset Scaling Exponent ---\n    # The problem asks to estimate alpha by fitting f(I) proportional to (I-Ic)^alpha\n    # with Ic=0. This is a power law f = C * I^alpha.\n    # On a log-log scale, this is a linear relationship: log(f) = log(C) + alpha * log(I).\n    # We perform a linear least-squares fit to find the slope, alpha.\n    log_I = np.log(I_vals)\n    log_f_I = np.log(f_I)\n    \n    # np.polyfit(x, y, 1) returns [slope, intercept] of the best-fit line.\n    # The slope is a direct estimate of the exponent alpha.\n    # Analytically, we know alpha is exactly 0.5, and the fit should confirm this.\n    alpha = np.polyfit(log_I, log_f_I, 1)[0]\n    \n    # --- Task 2: Type II Frequencies ---\n    # Derived formula: f(mu) = omega_0 / (2 * pi)\n    f_mu_val = omega_0_hopf / (2 * np.pi)\n    \n    # The frequency is constant for all mu  0.\n    f_mu1 = f_mu_val\n    f_mu2 = f_mu_val\n    f_mu3 = f_mu_val\n\n    # --- Task 3: Type II Onset Frequency ---\n    # f_onset is the limit of f(mu) as mu - 0+\n    f_onset = f_mu_val\n\n    # --- Task 3: Ratio R ---\n    # R = smallest Type I frequency / Type II onset frequency\n    R = f_I1 / f_onset\n\n    # --- Assemble and Print Results ---\n    results = [f_I1, f_I2, f_I3, alpha, f_mu1, f_mu2, f_mu3, f_onset, R]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}