{
    "hands_on_practices": [
        {
            "introduction": "离散傅里叶变换（DFT）提供了信号的频域视图，但其输出是按抽象的“箱号”（bin numbers）索引的，而不是以赫兹（Hz）为单位的物理频率。这项基础练习将指导你完成将 DFT 索引转换为相应频率的关键过程，这是任何频谱分析都必需的第一步。通过将此方法应用于一个假设的局部场电位（LFP）记录，你将练习如何确定频谱的哪些部分对应于特定的神经振荡频带，例如 theta 频带 。",
            "id": "3982793",
            "problem": "在一次记忆任务中，从海马体记录了一段持续时间为 $T$ 的局部场电位 (LFP) 片段，并以采样频率 $f_{s}$ 对其进行离散采样。该采样序列的长度为 $N$，并使用常规的 $N$ 点定义对连续样本计算离散傅里叶变换 (DFT)，不进行补零。假设 LFP 是实值的，并且在 $T$ 秒的时间窗内具有平稳性是一个合理的近似。定义：LFP 代表局部场电位 (local field potential, LFP)，DFT 代表离散傅里叶变换 (discrete Fourier transform, DFT)。\n\n从标准采样定义 $f_{s}=\\frac{1}{\\Delta t}$（其中 $\\Delta t$ 是采样间隔）和 $T=N\\Delta t$ 出发，推导与实值信号的 DFT 频点索引 $k$ 相关联的正傅里叶频率集合的表达式，并证明频率间隔取决于有限的观测时间 $T$。应用这些原理，将其具体化到 $f_{s}=1000$ $\\mathrm{Hz}$ 和 $N=2000$ 个样本（对应 $T=2$ $\\mathrm{s}$）的情况。标准的 theta 波段定义为 $[4,8]$ $\\mathrm{Hz}$，包含端点。确定单边谱中（即 $k\\in\\{0,1,\\dots,\\frac{N}{2}\\}$）所有其关联的正频率 DFT 频点位于 theta 波段内的整数频点索引 $k$。\n\n你的最终答案必须以单行矩阵的形式给出，按升序列出这些整数索引。不需要四舍五入，最终答案中不应包含任何单位。",
            "solution": "该问题是有效的，因为它在科学上基于数字信号处理和计算神经科学的原理，问题陈述清晰，给定的条件完整且一致，并以客观、明确的语言表达。我们将开始解题。\n\n该问题要求我们首先推导与离散采样的实值信号的离散傅里叶变换 (DFT) 相关联的频率的一般表达式，然后将此结果具体化，以找到对应于 theta 频带的特定 DFT 频点索引。\n\n设局部场电位 (LFP) 信号由一个包含 $N$ 个实值样本的序列 $x[n]$ 表示，其中 $n \\in \\{0, 1, \\dots, N-1\\}$。信号以频率 $f_s$ 进行采样，对应的采样间隔为 $\\Delta t = \\frac{1}{f_s}$。记录的总持续时间为 $T = N \\Delta t$。\n\n序列 $x[n]$ 的 $N$ 点 DFT 定义为：\n$$X[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi kn}{N}\\right)$$\n其中频点索引 $k \\in \\{0, 1, \\dots, N-1\\}$，$j$ 是虚数单位。\n\n每个 DFT 系数 $X[k]$ 测量的是信号中对应于特定复指数基函数 $\\exp\\left(j \\frac{2\\pi kn}{N}\\right)$ 的内容。为了找到与频点索引 $k$ 相关联的物理频率，我们将离散时间索引 $n$ 与连续时间 $t$ 联系起来。第 $n$ 个样本的时间是 $t_n = n \\Delta t$。我们寻求一个复正弦波 $\\exp(j 2\\pi f t)$ 的连续频率 $f$，当它在时间点 $t_n$ 被采样时，能够与 DFT 基函数匹配。\n$$ \\exp(j 2\\pi f t_n) = \\exp(j 2\\pi f (n \\Delta t)) $$\n将其与第 $k$ 个基函数等同：\n$$ \\exp(j 2\\pi f n \\Delta t) = \\exp\\left(j \\frac{2\\pi kn}{N}\\right) $$\n为了使此等式对所有 $n$ 都成立，指数必须相等（模 $2\\pi$）：\n$$ 2\\pi f n \\Delta t = \\frac{2\\pi kn}{N} $$\n$$ f \\Delta t = \\frac{k}{N} $$\n求解频率 $f$，我们用 $f_k$ 表示索引为 $k$ 时的频率：\n$$ f_k = \\frac{k}{N \\Delta t} $$\n使用给定的定义 $T = N \\Delta t$，傅里叶频率集合的表达式为：\n$$ f_k = \\frac{k}{T}, \\quad \\text{对于 } k \\in \\{0, 1, \\dots, N-1\\} $$\n或者，代入 $\\Delta t = \\frac{1}{f_s}$，我们可以写成 $f_k = \\frac{k f_s}{N}$。\n\n问题接着要求证明频率间隔取决于有限的观测时间 $T$。频率间隔，或称频率分辨率，是相邻频点频率之间的差值，即 $\\Delta f$。\n$$ \\Delta f = f_{k+1} - f_k = \\frac{k+1}{T} - \\frac{k}{T} = \\frac{1}{T} $$\n这个结果明确地表明，频率间隔是总观测时间 $T$ 的倒数。更长的记录窗口 $T$ 会产生更精细的频率分辨率（即更小的 $\\Delta f$）。\n\n对于实值信号 $x[n]$，其 DFT 表现出厄米共轭对称性：$X[k] = X[N-k]^*$，其中 $*$ 表示复共轭。这意味着幅度谱是对称的，即 $|X[k]| = |X[N-k]|$。所有独特的信息都包含在频谱的前半部分。对于偶数 $N$，这对应于索引 $k \\in \\{0, 1, \\dots, \\frac{N}{2}\\}$。频点 $k=0$ 对应于直流分量，$f_0 = 0$ $\\mathrm{Hz}$。频点 $k=\\frac{N}{2}$ 对应于奈奎斯特频率，$f_{N/2} = \\frac{N/2}{T} = \\frac{N/2}{N \\Delta t} = \\frac{1}{2 \\Delta t} = \\frac{f_s}{2}$。问题要求的是对应于正频率的索引，即 $k \\in \\{1, 2, \\dots, \\frac{N}{2}\\}$。\n\n现在，我们具体分析给定的情况：$f_s = 1000$ $\\mathrm{Hz}$ 和 $N = 2000$ 个样本。\n首先，我们计算观测持续时间 $T$：\n$$ T = \\frac{N}{f_s} = \\frac{2000}{1000 \\text{ s}^{-1}} = 2 \\text{ s} $$\n频率分辨率为 $\\Delta f = \\frac{1}{T} = \\frac{1}{2 \\text{ s}} = 0.5$ $\\mathrm{Hz}$。\n与频点索引 $k$ 相关联的频率为：\n$$ f_k = k \\cdot \\Delta f = k \\times 0.5 \\text{ Hz}, \\quad \\text{或等价地，} f_k = \\frac{k}{2} \\text{ Hz} $$\n单边谱考虑的索引范围是 $k \\in \\{0, 1, \\dots, \\frac{2000}{2}\\}$，即 $k \\in \\{0, 1, \\dots, 1000\\}$。\n我们需要找到此范围内所有使得对应频率 $f_k$ 位于标准 theta 波段（定义为 $[4, 8]$ $\\mathrm{Hz}$，包含端点）内的整数索引 $k$。这需要解以下不等式：\n$$ 4 \\le f_k \\le 8 $$\n代入 $f_k$ 的表达式：\n$$ 4 \\le \\frac{k}{2} \\le 8 $$\n为了解出 $k$，我们将整个不等式乘以 $2$：\n$$ 4 \\times 2 \\le k \\le 8 \\times 2 $$\n$$ 8 \\le k \\le 16 $$\n由于 $k$ 必须是整数，其频率落在 theta 波段内的频点索引集合为 $\\{8, 9, 10, 11, 12, 13, 14, 15, 16\\}$。这些索引都在单边谱的有效范围 $k \\in \\{0, 1, \\dots, 1000\\}$ 内。问题规定答案应以单行矩阵的形式给出，按升序列出这些整数。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 8  9  10  11  12  13  14  15  16 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在将连续的模拟信号转换为离散的数字信号时，我们可能会引入原始信号中不存在的伪影。本练习探讨了“混叠”（aliasing）这一关键现象，即如果采样率过低，高频分量会在采样数据中不当地表现为低频分量。理解和计算混叠效应，如此处假设的脑电图（EEG）场景所示，对于设计可靠的数据采集系统和避免对神经活动得出错误结论至关重要 。",
            "id": "3982823",
            "problem": "一个由 $x(t)$ 表示的连续时间脑电图 (EEG) 信号，包含一个加性正弦污染物 $s(t)=A\\cos\\!\\left(2\\pi f_{0} t+\\phi\\right)$，其频率 $f_{0}$ 未知且高于奈奎斯特极限。该信号在没有抗混叠滤波器的情况下，以采样频率 $f_{s}$ 进行均匀采样，产生离散时间样本 $x[n]=x(nT_{s})$，其中 $T_{s}=1/f_{s}$。您可以假设为理想点采样，并且 $x(t)$ 在任何有限时间间隔内的能量是有限的。\n\n从均匀采样的定义（即与一个 Dirac 梳状函数的乘积）以及由 Dirac 梳状函数的傅里叶变换所隐含的频域复制出发，推导出频率映射原理。该原理用于确定 $s(t)$ 中的哪些谱线在采样后会出现在离散时间基带 $[0,f_{s}/2]$ 内。然后，将您的推导应用于 $f_{s}=500$ Hz 且污染物频率为 $f_{0}=340$ Hz 的情况，以确定在采样数据的基带频谱中将观察到的单个混叠频率。请以赫兹 (Hz) 为单位表示您的最终答案。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于数字信号处理的原理，问题提法恰当且提供了所有必要信息，并以客观、正式的方式陈述。我们可以开始求解。\n\n以采样频率 $f_s = 1/T_s$ 对连续时间信号 $x(t)$ 进行均匀采样的过程，可以数学地建模为 $x(t)$ 与一个无限的 Dirac δ 函数序列（一个 Dirac 梳状函数）$\\delta_{T_s}(t)$ 的乘积。因此，连续时间内的采样信号 $x_s(t)$ 为：\n$$x_s(t) = x(t) \\cdot \\delta_{T_s}(t) = x(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\n其中 $\\delta(t)$ 是 Dirac δ 函数，$n$ 是一个整数。\n\n为了理解采样在频域中的效果，我们应用傅里叶变换，记为 $\\mathcal{F}\\{\\cdot\\}$。时域中的乘法在频域中变为卷积：\n$$X_s(f) = \\mathcal{F}\\{x_s(t)\\} = \\mathcal{F}\\{x(t)\\} * \\mathcal{F}\\{\\delta_{T_s}(t)\\} = X(f) * \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)\\right\\}$$\n其中 $X(f)$ 是原始信号 $x(t)$ 的傅里叶变换，* 表示卷积运算符。\n\n必须确定 Dirac 梳状函数的傅里叶变换。Dirac 梳状函数是一个周期为 $T_s$ 的周期函数，因此可以由傅里叶级数表示：\n$$\\delta_{T_s}(t) = \\sum_{k=-\\infty}^{\\infty} c_k e^{j2\\pi k (1/T_s) t}$$\n其中傅里叶级数系数 $c_k$ 由下式给出：\n$$c_k = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} \\delta_{T_s}(t) e^{-j2\\pi k (1/T_s) t} dt = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} \\delta(t) e^{-j2\\pi k f_s t} dt$$\n根据 Dirac δ 函数的筛选特性，上式简化为：\n$$c_k = \\frac{1}{T_s} e^0 = \\frac{1}{T_s} = f_s$$\n将系数代回 Dirac 梳状函数的级数表示，得到：\n$$\\delta_{T_s}(t) = f_s \\sum_{k=-\\infty}^{\\infty} e^{j2\\pi k f_s t}$$\n现在，对这个和进行傅里叶变换，并使用恒等式 $\\mathcal{F}\\{e^{j2\\pi f_c t}\\} = \\delta(f - f_c)$，我们得到：\n$$\\mathcal{F}\\{\\delta_{T_s}(t)\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\mathcal{F}\\{e^{j2\\pi k f_s t}\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s)$$\n这个结果表明，时域中的 Dirac 梳状函数的傅里叶变换是频域中的另一个 Dirac 梳状函数，其脉冲位于采样频率 $f_s$ 的整数倍处。\n\n现在我们可以完成 $X_s(f)$ 的卷积：\n$$X_s(f) = X(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right)$$\n使用与 δ 函数卷积的恒等式 $G(f) * \\delta(f - f_c) = G(f - f_c)$，我们得到：\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} X(f - kf_s)$$\n该方程是采样理论的数学基础。它指出，采样信号的频谱 $X_s(f)$ 由原始信号频谱 $X(f)$ 的无限多个副本组成，这些副本按 $f_s$ 进行了缩放，并被平移以采样频率的每个整数倍 $k f_s$ 为中心。\n\n现在，让我们考虑特定的污染物信号 $s(t) = A\\cos(2\\pi f_0 t + \\phi)$。使用 Euler 公式，我们可以将其傅里叶变换 $S(f)$ 写为：\n$$s(t) = \\frac{A}{2} \\left( e^{j(2\\pi f_0 t + \\phi)} + e^{-j(2\\pi f_0 t + \\phi)} \\right)$$\n$$S(f) = \\mathcal{F}\\{s(t)\\} = \\frac{A}{2} e^{j\\phi} \\delta(f - f_0) + \\frac{A}{2} e^{-j\\phi} \\delta(f + f_0)$$\n污染物的频谱由位于频率 $f_0$ 和 $-f_0$ 处的两条谱线组成。\n\n当此信号被采样时，其频谱 $S_s(f)$ 成为 $S(f)$ 的一个复制版本：\n$$S_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} S(f - kf_s) = f_s \\sum_{k=-\\infty}^{\\infty} \\left[ \\frac{A}{2} e^{j\\phi} \\delta(f - kf_s - f_0) + \\frac{A}{2} e^{-j\\phi} \\delta(f - kf_s + f_0) \\right]$$\n对于每个整数 $k$，得到的频谱在所有频率 $f = f_0 + kf_s$ 和 $f = -f_0 + kf_s$ 处都有谱线。\n\n离散时间基带频谱在频率区间 $[0, f_s/2]$ 内观察。当原始信号中位于范围 $[-f_s/2, f_s/2]$ 之外的频率分量，由于频谱复制而被映射到这个基带中时，就会发生混叠。如果对于某个整数 $k$ 存在以下情况，原始频率 $f_0$ 将作为混叠频率 $f_a$ 出现在基带中：\n$$f_a = |f_0 - kf_s| \\quad \\text{such that} \\quad 0 \\le f_a \\le \\frac{f_s}{2}$$\n这就是频率映射原理。选择整数 $k$ 以将频率 $f_0$ “折叠”到基带中。这等同于找到使绝对差 $|f_0 - kf_s|$ 最小化的整数 $k$。这个 $k$ 值是与比率 $f_0/f_s$ 最接近的整数，即 $k = \\text{round}(f_0/f_s)$。\n\n我们现在将此推导应用于所提供的具体案例：\n采样频率，$f_s = 500$ Hz。\n污染物频率，$f_0 = 340$ Hz。\n\n奈奎斯特频率为 $f_s/2 = 500/2 = 250$ Hz。由于 $f_0 = 340$ Hz $> 250$ Hz，污染物频率高于奈奎斯特极限，预计会发生混叠。我们关注的基带是 $[0, 250]$ Hz。\n\n为了找到混叠频率 $f_a$，我们使用映射原理 $f_a = |f_0 - kf_s|$，其中 $k = \\text{round}(f_0/f_s)$。\n首先，我们计算比率：\n$$\\frac{f_0}{f_s} = \\frac{340}{500} = 0.68$$\n与 $0.68$ 最接近的整数是 $k=1$。\n\n现在，我们计算混叠频率 $f_a$：\n$$f_a = |f_0 - 1 \\cdot f_s| = |340 - 500| = |-160|$$\n$$f_a = 160 \\text{ Hz}$$\n我们也来检查在 $-f_0 = -340$ Hz 的负频率分量的混叠情况。对于整数 $m$，其副本位于 $-340 + m \\cdot 500$。对于 $m=1$，频率是 $-340 + 500 = 160$ Hz。对于 $m=0$，频率是 $-340$ Hz，对于 $m=2$，频率是 $660$ Hz。\n原始信号的正频率和负频率分量都混叠到基带中的相同绝对频率上。结果 $f_a = 160$ Hz 位于指定的基带 $[0, f_s/2] = [0, 250]$ Hz 内。\n\n因此，在采样数据的基带频谱中将观察到的单个混叠频率是 $160$ Hz。",
            "answer": "$$\n\\boxed{160}\n$$"
        },
        {
            "introduction": "在实践中，我们总是分析有限长度的数据段，这会引入一种称为“频谱泄漏”（spectral leakage）的失真，它可能会掩盖邻近的频率成分。这项高级练习探讨了如何使用窗函数来控制这种效应，从而提高我们分辨紧密相邻的神经振荡的能力。通过推导和比较不同窗函数的特性，你将学会如何管理频率分辨率和抑制频谱泄漏伪影之间的基本权衡 。",
            "id": "3982801",
            "problem": "以采样率 $f_s = 1000\\,\\mathrm{Hz}$ 采集一段持续时间为 $T = 1.024\\,\\mathrm{s}$ 的皮层局部场电位 (LFP)，得到一个长度为 $N = 1024$ 的离散序列。考虑一个包含两个等幅正弦分量的片段，其频率 $f_1$ 和 $f_2$ 接近 gamma 频段。使用加窗离散时间傅里叶变换 (DTFT) 对该片段进行分析，并采用三种候选窗函数：矩形窗、汉宁窗和汉明窗。\n\n- 根据有限长度加窗信号的 DTFT 以及加窗的频域效应，定义频谱泄漏。\n- 从正弦信号的加窗 DTFT 定义以及矩形窗、汉宁窗和汉明窗的 DTFT 出发，推导每种窗函数的频域幅度结构，以足以确定：\n  1) 主瓣宽度，定义为窗函数变换中心峰值两侧第一个零点之间的距离（以 $\\mathrm{Hz}$ 为单位），表示为 $N$ 和 $f_s$ 的函数。\n  2) 相对于主瓣峰值的峰值旁瓣电平，以分贝表示。\n- 然后，利用您的推导，为分辨频率相近的神经振荡 $f_1$ 和 $f_2$ 施加两个实际标准：\n  1) 一个瑞利型分离标准，将每个正弦波的频谱峰值置于另一个窗函数变换的第一个零点上。\n  2) 一个最坏情况泄漏标准，要求最大旁瓣幅度（相对于主瓣峰值）在线性尺度上严格小于 $0.01$，且与 $f_1$ 和 $f_2$ 在频率仓内的确切位置无关。\n\n在这三种窗函数中，选择满足最坏情况泄漏标准的那个，并计算同时满足瑞利型标准的 $f_1$ 和 $f_2$ 之间的最小频率间隔 $\\Delta f_{\\min}$（以 $\\mathrm{Hz}$ 为单位）。将最终数值答案四舍五入至四位有效数字，并以 $\\mathrm{Hz}$ 表示。",
            "solution": "该问题要求在解析神经信号中频率相近的正弦分量的背景下，对窗函数进行分析。解答过程分为四个阶段：首先，定义频谱泄漏；其次，推导矩形窗、汉宁窗和汉明窗的性质；第三，应用给定的分辨率标准来选择合适的窗函数；最后，为所选窗函数计算最小可分辨频率间隔。\n\n**1. 频谱泄漏**\n\n无限长离散时间信号 $x[n]$ 的离散时间傅里叶变换 (DTFT) 定义为 $X(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n}$，其中 $\\omega$ 是归一化角频率，单位为弧度/样本。在实践中，我们分析信号的有限长度片段，这等效于将信号 $x[n]$ 与长度为 $N$ 的窗函数 $w[n]$ 相乘。窗函数在区间 $n \\in \\{0, 1, \\dots, N-1\\}$ 之外为零。得到的加窗信号为 $x_w[n] = x[n] \\cdot w[n]$。\n\n根据 DTFT 的卷积定理，时域中的乘法对应于频域中的周期性卷积：\n$$X_w(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} X(e^{j\\theta}) W(e^{j(\\omega-\\theta)}) d\\theta$$\n其中 $W(e^{j\\omega})$ 是窗函数 $w[n]$ 的 DTFT。\n\n对于纯正弦分量，例如 $x[n] = A\\cos(\\omega_0 n)$，其 DTFT 由两个狄拉克 δ 函数组成：$X(e^{j\\omega}) = \\pi A (\\delta(\\omega - \\omega_0) + \\delta(\\omega + \\omega_0))$，对于 $\\omega \\in [-\\pi, \\pi]$。当与窗谱 $W(e^{j\\omega})$ 卷积时，每个 δ 函数被一个移位和缩放版本的 $W(e^{j\\omega})$ 所取代。得到的频谱是：\n$$X_w(e^{j\\omega}) = \\frac{A}{2} \\left[ W(e^{j(\\omega-\\omega_0)}) + W(e^{j(\\omega+\\omega_0)}) \\right]$$\n任何有限长度窗函数的 DTFT, $W(e^{j\\omega})$，都不是一个 δ 函数，而是一个具有中心峰（主瓣）和一系列较小峰（旁瓣）的连续函数。因此，理想情况下集中在单一频率 $\\omega_0$ 上的正弦波能量会扩散或“泄漏”到相邻频率。这种现象被称为**频谱泄漏**。泄漏的程度由窗函数旁瓣的特性决定。\n\n**2. 窗函数性质**\n\n我们分析长度为 $N = 1024$ 的三种候选窗函数。以赫兹（Hz）为单位的频率 $f$ 与归一化角频率 $\\omega$ 的关系为 $\\omega = 2\\pi f / f_s$。\n\n**a) 矩形窗**\n矩形窗定义为 $w_R[n] = 1$（对于 $n \\in \\{0, 1, \\dots, N-1\\}$）。\n其 DTFT 是狄利克雷核：\n$$W_R(e^{j\\omega}) = e^{-j\\omega(N-1)/2} \\frac{\\sin(\\omega N/2)}{\\sin(\\omega/2)}$$\n幅度为 $|W_R(e^{j\\omega})| = \\left| \\frac{\\sin(\\omega N/2)}{\\sin(\\omega/2)} \\right|$。\n- **主瓣宽度**：主瓣中心在 $\\omega=0$。当分子 $\\sin(\\omega N/2) = 0$ 而分母非零时，出现第一个零点。这发生在 $\\omega N/2 = \\pm k\\pi$ 处，其中整数 $k \\neq 0$。第一个零点在 $k=\\pm 1$ 处，得到 $\\omega = \\pm 2\\pi/N$。以赫兹（Hz）为单位的频率表示，第一个零点在 $f = \\frac{\\omega f_s}{2\\pi} = \\frac{(2\\pi/N) f_s}{2\\pi} = \\frac{f_s}{N}$。主瓣宽度定义为第一个零点之间的距离，即 $2 \\times \\frac{f_s}{N} = \\frac{2f_s}{N}$。\n- **峰值旁瓣电平 (PSL)**：第一个旁瓣的峰值与主瓣峰值的比率约为 $2/(3\\pi)$。以分贝表示，即 $20\\log_{10}(2/(3\\pi)) \\approx -13.3\\,\\mathrm{dB}$。\n\n**b) 汉宁窗**\n汉宁窗定义为 $w_{Hn}[n] = 0.5 - 0.5\\cos\\left(\\frac{2\\pi n}{N-1}\\right)$（对于 $n \\in \\{0, 1, \\dots, N-1\\}$）。\n其 DTFT 可以表示为三个移位的狄利克雷核的叠加：\n$W_{Hn}(e^{j\\omega}) = 0.5 W_R(e^{j\\omega}) - 0.25 \\left[ W_R(e^{j(\\omega - \\frac{2\\pi}{N-1})}) + W_R(e^{j(\\omega + \\frac{2\\pi}{N-1})}) \\right]$。\n这种叠加导致矩形窗变换的第一个旁瓣被抵消，从而以更宽的主瓣为代价，换取了低得多的整体旁瓣电平。\n- **主瓣宽度**：在 $\\omega \\approx \\pm 2\\pi/N$ 处放置负核会抵消中心核在其第一个零点附近的主瓣，从而有效地将组合变换的第一个零点向外推。对于大的 $N$，第一个零点大约在 $\\omega = \\pm 4\\pi/N$。对应的频率为 $f = \\frac{(4\\pi/N) f_s}{2\\pi} = \\frac{2f_s}{N}$。主瓣宽度为 $2 \\times \\frac{2f_s}{N} = \\frac{4f_s}{N}$。\n- **峰值旁瓣电平 (PSL)**：峰值旁瓣被显著衰减，其标准值约为 $-31.5\\,\\mathrm{dB}$。\n\n**c) 汉明窗**\n汉明窗定义为 $w_{Ha}[n] = 0.54 - 0.46\\cos\\left(\\frac{2\\pi n}{N-1}\\right)$（对于 $n \\in \\{0, 1, \\dots, N-1\\}$）。\n与汉宁窗类似，其 DTFT 是三个移位的狄利克雷核的加权和：\n$W_{Ha}(e^{j\\omega}) = 0.54 W_R(e^{j\\omega}) - 0.23 \\left[ W_R(e^{j(\\omega - \\frac{2\\pi}{N-1})}) + W_R(e^{j(\\omega + \\frac{2\\pi}{N-1})}) \\right]$。\n选择系数 $0.54$ 和 $0.46$ 是为了几乎完全抵消矩形窗变换的第一个旁瓣，从而使这类窗函数获得最低的可能峰值旁瓣电平。\n- **主瓣宽度**：其结构与汉宁窗类似。主瓣宽度也是 $\\frac{4f_s}{N}$。\n- **峰值旁瓣电平 (PSL)**：优化的抵消作用导致了非常低的峰值旁瓣电平，约为 $-42.8\\,\\mathrm{dB}$。\n\n**3. 标准的应用**\n\n**标准 1：瑞利型分离**\n最小频率间隔 $\\Delta f_{\\min}$ 定义为一个分量的峰值落在另一个分量（窗函数变换）的第一个零点上。这个距离是主瓣宽度的一半。\n- 对于矩形窗: $\\Delta f_{\\min} = \\frac{1}{2} \\left(\\frac{2f_s}{N}\\right) = \\frac{f_s}{N}$。\n- 对于汉宁窗: $\\Delta f_{\\min} = \\frac{1}{2} \\left(\\frac{4f_s}{N}\\right) = \\frac{2f_s}{N}$。\n- 对于汉明窗: $\\Delta f_{\\min} = \\frac{1}{2} \\left(\\frac{4f_s}{N}\\right) = \\frac{2f_s}{N}$。\n\n**标准 2：最坏情况泄漏**\n相对于主瓣峰值的最大旁瓣幅度必须小于 $0.01$。我们将这个线性比率转换为分贝 (dB)：\n$$ \\text{阈值 (dB)} = 20 \\log_{10}(0.01) = 20 \\times (-2) = -40\\,\\mathrm{dB} $$\n如果一个窗函数的峰值旁瓣电平 (PSL) 小于 $-40\\,\\mathrm{dB}$，则该窗函数是可接受的。\n- 矩形窗：$PSL \\approx -13.3\\,\\mathrm{dB}$。这大于 $-40\\,\\mathrm{dB}$，因此不满足该标准。\n- 汉宁窗：$PSL \\approx -31.5\\,\\mathrm{dB}$。这大于 $-40\\,\\mathrm{dB}$，因此不满足该标准。\n- 汉明窗：$PSL \\approx -42.8\\,\\mathrm{dB}$。这小于 $-40\\,\\mathrm{dB}$，因此**满足**该标准。\n\n唯一满足严格泄漏要求的窗函数是汉明窗。\n\n**4. 最终计算**\n\n我们必须使用汉明窗来计算最小频率间隔。对汉明窗使用瑞利型标准：\n$$ \\Delta f_{\\min} = \\frac{2f_s}{N} $$\n代入给定值 $f_s = 1000\\,\\mathrm{Hz}$ 和 $N = 1024$：\n$$ \\Delta f_{\\min} = \\frac{2 \\times 1000}{1024} = \\frac{2000}{1024} = 1.953125\\,\\mathrm{Hz} $$\n问题要求将最终答案四舍五入到四位有效数字。将 $1.953125$ 四舍五入到四位有效数字得到 $1.953$。\n因此，最小频率间隔为 $1.953\\,\\mathrm{Hz}$。",
            "answer": "$$\\boxed{1.953}$$"
        }
    ]
}