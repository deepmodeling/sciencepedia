{
    "hands_on_practices": [
        {
            "introduction": "The Nernst potential represents the foundational concept of electrochemical equilibrium for a single ion. This exercise  will guide you through its derivation from first principles of thermodynamics, solidifying your understanding of how electrical and chemical gradients balance. By applying the derived formula to calcium ($\\text{Ca}^{2+}$), you will see firsthand why its steep concentration gradient results in a powerful depolarizing influence, a key feature in neuronal signaling.",
            "id": "3978026",
            "problem": "A neuron is bathed in an extracellular solution with calcium ion concentration $[\\mathrm{Ca}^{2+}]_o = 2\\,\\mathrm{mM}$ and maintains an intracellular free calcium ion concentration $[\\mathrm{Ca}^{2+}]_i = 100\\,\\mathrm{nM}$. Assume the membrane is selectively permeable to $\\mathrm{Ca}^{2+}$ and that solutions are ideal and dilute so that activities equal concentrations. Starting from the equality of electrochemical potentials across the membrane at equilibrium, and using the chemical potential of a solute in an ideal solution together with the electrostatic energy of a charged species in an electric field, derive the equilibrium membrane potential for calcium (the Nernst potential for calcium, denoted $E_{\\mathrm{Ca}}$) with the sign convention $E_{\\mathrm{Ca}} = \\phi_i - \\phi_o$, where $\\phi_i$ and $\\phi_o$ are the intracellular and extracellular electric potentials, respectively. Take the valence of calcium to be $z_{\\mathrm{Ca}} = +2$, the universal gas constant to be $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, the Faraday constant (the magnitude of charge per mole of elementary charges) to be $F = 96485\\,\\mathrm{C\\,mol^{-1}}$, and the absolute temperature to be $T = 310\\,\\mathrm{K}$. \n\nCompute the numerical value of $E_{\\mathrm{Ca}}$ for the given concentrations and constants. Express your final numerical answer in millivolts and round your result to four significant figures. \n\nFinally, based on your derived expression, discuss qualitatively why the large extracellular-to-intracellular calcium gradient makes $E_{\\mathrm{Ca}}$ highly depolarized in neuronal modeling.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a complete derivation and calculation. It represents a standard and fundamental problem in electrophysiology.\n\nThe electrochemical potential, $\\tilde{\\mu}_j$, of an ionic species $j$ is the sum of its chemical potential, $\\mu_j$, and the potential energy associated with its charge in an electric field. This is expressed as:\n$$\n\\tilde{\\mu}_j = \\mu_j + z_j F \\phi\n$$\nwhere $z_j$ is the valence of the ion, $F$ is the Faraday constant (the charge per mole of elementary charges), and $\\phi$ is the local electric potential. For a solute in an ideal, dilute solution, the chemical potential is given by:\n$$\n\\mu_j = \\mu_j^0 + RT \\ln([j])\n$$\nHere, $\\mu_j^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $[j]$ is the molar concentration of the species. Combining these two expressions, the electrochemical potential for an ion $j$ is:\n$$\n\\tilde{\\mu}_j = \\mu_j^0 + RT \\ln([j]) + z_j F \\phi\n$$\nAt equilibrium, there is no net flux of the ion across the membrane. This condition is met when the electrochemical potential for the ion is the same in the intracellular and extracellular compartments. For calcium ions, $\\mathrm{Ca}^{2+}$, we set the intracellular electrochemical potential, $\\tilde{\\mu}_{\\mathrm{Ca}, i}$, equal to the extracellular electrochemical potential, $\\tilde{\\mu}_{\\mathrm{Ca}, o}$:\n$$\n\\tilde{\\mu}_{\\mathrm{Ca}, i} = \\tilde{\\mu}_{\\mathrm{Ca}, o}\n$$\nSubstituting the full expression for the electrochemical potential on both sides gives:\n$$\n\\mu_{\\mathrm{Ca}}^0 + RT \\ln([\\mathrm{Ca}^{2+}]_i) + z_{\\mathrm{Ca}} F \\phi_i = \\mu_{\\mathrm{Ca}}^0 + RT \\ln([\\mathrm{Ca}^{2+}]_o) + z_{\\mathrm{Ca}} F \\phi_o\n$$\nThe standard chemical potential, $\\mu_{\\mathrm{Ca}}^0$, is an intrinsic property of the ion and the solvent, and is identical on both sides of the equation, thus it can be cancelled. Rearranging the remaining terms to group potential terms and concentration terms yields:\n$$\nz_{\\mathrm{Ca}} F \\phi_i - z_{\\mathrm{Ca}} F \\phi_o = RT \\ln([\\mathrm{Ca}^{2+}]_o) - RT \\ln([\\mathrm{Ca}^{2+}]_i)\n$$\nFactoring out common terms:\n$$\nz_{\\mathrm{Ca}} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i}\\right)\n$$\nThe equilibrium membrane potential for calcium, $E_{\\mathrm{Ca}}$, is defined as the potential difference across the membrane, $E_{\\mathrm{Ca}} = \\phi_i - \\phi_o$. Solving for this quantity gives the Nernst potential for calcium:\n$$\nE_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i}\\right)\n$$\nThis completes the derivation as requested.\n\nNext, we compute the numerical value of $E_{\\mathrm{Ca}}$ using the provided constants and concentrations.\nThe given values are:\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\,\\mathrm{K}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n$z_{\\mathrm{Ca}} = +2$\n$[\\mathrm{Ca}^{2+}]_o = 2\\,\\mathrm{mM} = 2 \\times 10^{-3}\\,\\mathrm{M}$\n$[\\mathrm{Ca}^{2+}]_i = 100\\,\\mathrm{nM} = 100 \\times 10^{-9}\\,\\mathrm{M} = 1 \\times 10^{-7}\\,\\mathrm{M}$\n\nFirst, we calculate the ratio of the extracellular to intracellular concentrations:\n$$\n\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i} = \\frac{2 \\times 10^{-3}\\,\\mathrm{M}}{1 \\times 10^{-7}\\,\\mathrm{M}} = 2 \\times 10^4\n$$\nNow, substitute the values into the derived Nernst equation:\n$$\nE_{\\mathrm{Ca}} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(2) \\times (96485\\,\\mathrm{C\\,mol^{-1}})} \\ln(2 \\times 10^4)\n$$\nPerforming the calculation:\n$$\nE_{\\mathrm{Ca}} \\approx \\frac{2577.34\\,\\mathrm{J\\,mol^{-1}}}{192970\\,\\mathrm{C\\,mol^{-1}}} \\times \\ln(20000)\n$$\n$$\nE_{\\mathrm{Ca}} \\approx (0.0133563\\,\\mathrm{J\\,C^{-1}}) \\times (9.903488)\n$$\nSince $1\\,\\mathrm{J\\,C^{-1}} = 1\\,\\mathrm{V}$:\n$$\nE_{\\mathrm{Ca}} \\approx 0.132274\\,\\mathrm{V}\n$$\nThe problem requires the answer in millivolts and rounded to four significant figures.\n$$\nE_{\\mathrm{Ca}} \\approx 132.274\\,\\mathrm{mV} \\approx 132.3\\,\\mathrm{mV}\n$$\n\nFinally, we discuss qualitatively why the large extracellular-to-intracellular calcium gradient makes $E_{\\mathrm{Ca}}$ highly depolarized. The derived Nernst equation, $E_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i}\\right)$, provides the basis for this discussion. \"Depolarized\" in a neuronal context refers to a membrane potential that is positive, or at least significantly more positive than the typical resting potential (around $-70\\,\\mathrm{mV}$).\nThe term $\\frac{RT}{z_{\\mathrm{Ca}}F}$ is a product of positive constants ($R$, $T$, $F$) and the positive valence $z_{\\mathrm{Ca}}=+2$, so this pre-factor is positive. The sign and magnitude of $E_{\\mathrm{Ca}}$ are therefore determined by the logarithmic term, $\\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i}\\right)$.\nA \"large extracellular-to-intracellular calcium gradient\" means that the concentration ratio $\\frac{[\\mathrm{Ca}^{2+}]_o}{[\\mathrm{Ca}^{2+}]_i}$ is a number significantly greater than $1$. In this problem, the ratio is $20000$. The natural logarithm of any number greater than $1$ is positive. For a very large ratio, the logarithm yields a correspondingly significant positive value. Multiplying the positive pre-factor by this positive logarithmic term results in a positive equilibrium potential $E_{\\mathrm{Ca}}$. The sheer magnitude of the concentration ratio for calcium ensures that this positive potential is large (e.g., $+132.3\\,\\mathrm{mV}$). This value is far more positive than the negative resting potential of a neuron, hence it is described as \"highly depolarized.\" This high equilibrium potential establishes a powerful electrochemical driving force for $\\mathrm{Ca}^{2+}$ to enter the cell whenever calcium channels open, leading to rapid and substantial membrane depolarization.",
            "answer": "$$\\boxed{132.3}$$"
        },
        {
            "introduction": "An equilibrium potential defines the point of zero net current, but neurons rarely operate at this point for any single ion. This practice  introduces the critical concept of the electrochemical driving force, which is the difference between the membrane potential $V_m$ and an ion's Nernst potential, such as $E_K$. You will learn how this driving force, combined with membrane conductance, determines the magnitude and direction of ionic current, providing a direct link between thermodynamics and electrical signaling.",
            "id": "3977994",
            "problem": "In a whole-cell voltage-clamp experiment on a cortical pyramidal neuron, the membrane is held at a constant potential $V_{m}$ while a population of potassium-selective channels remains open with an approximately constant conductance $g_{K}$ over a narrow voltage range around rest. The potassium reversal potential $E_{K}$ has been measured independently from the intracellular and extracellular concentrations of potassium via the Nernst relation. Assume the conventional electrophysiological sign convention in which positive current corresponds to the net outward movement of positive charge across the membrane.\n\nStarting from the following principles:\n- The reversal potential $E_{K}$ is the membrane potential at which the net electrochemical force on potassium ions is zero.\n- Near an operating point, the open-channel current-voltage relation for a passive ion species can be approximated as linear (Ohmic), with a slope equal to the conductance of that species.\n\n(a) Using these principles, derive the expression for the potassium current $I_{K}$ in terms of the conductance $g_{K}$ and an appropriate voltage difference that captures the electrochemical driving force.\n\n(b) For the specific values $g_{K}=10\\,\\mathrm{nS}$, $V_{m}=-60\\,\\mathrm{mV}$, and $E_{K}=-88\\,\\mathrm{mV}$, compute the value of $I_{K}$ and indicate, in your reasoning, whether the current is inward or outward under the stated sign convention. Express the final current in picoamperes (pA). The final numerical answer must be a single number with no units in the answer box.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and internally consistent. It is based on fundamental principles of electrophysiology and provides all necessary information for a complete solution.\n\n**(a) Derivation of the Potassium Current Expression**\n\nThe problem asks to derive the expression for the potassium current, $I_K$, based on two provided principles.\n\nThe second principle states that the open-channel current-voltage relation can be approximated as linear (Ohmic) near an operating point. This is an application of Ohm's law, which in its general form is written as:\n$$I = g \\cdot \\Delta V$$\nwhere $I$ is the current, $g$ is the conductance, and $\\Delta V$ is the potential difference or driving force. For the specific case of potassium ions, this relation becomes:\n$$I_K = g_K \\cdot \\Delta V_K$$\nHere, $g_K$ is the potassium conductance, and $\\Delta V_K$ is the electrochemical driving force on potassium ions.\n\nThe first principle states that the reversal potential, $E_K$, is the membrane potential ($V_m$) at which the net electrochemical force on potassium ions is zero. This implies that when $V_m = E_K$, the net current $I_K$ must be zero. We must define the driving force $\\Delta V_K$ such that this condition is met.\n\nThe driving force is the difference between the actual membrane potential, $V_m$, and the potential at which there would be no net ion movement, which is the reversal potential $E_K$. Let us define the driving force as:\n$$\\Delta V_K = V_m - E_K$$\n\nWe can verify that this definition is consistent with the first principle. If we substitute $V_m = E_K$ into this expression, we get:\n$$\\Delta V_K = E_K - E_K = 0$$\nThis leads to a current $I_K = g_K \\cdot 0 = 0$, which correctly reflects the condition of zero net current at the reversal potential.\n\nTherefore, the expression for the potassium current $I_K$ in terms of the conductance $g_K$ and the driving force is:\n$$I_K = g_K (V_m - E_K)$$\n\nThis equation is a cornerstone of membrane biophysics. The term $(V_m - E_K)$ represents the net electrochemical driving force acting on the potassium ions.\n\n**(b) Calculation of the Potassium Current**\n\nWe are given the following specific values:\n- Conductance $g_K = 10\\,\\mathrm{nS} = 10 \\times 10^{-9}\\,\\mathrm{S}$\n- Membrane potential $V_m = -60\\,\\mathrm{mV} = -60 \\times 10^{-3}\\,\\mathrm{V}$\n- Potassium reversal potential $E_K = -88\\,\\mathrm{mV} = -88 \\times 10^{-3}\\,\\mathrm{V}$\n\nWe substitute these values into the derived expression for $I_K$:\n$$I_K = g_K (V_m - E_K)$$\n$$I_K = (10 \\times 10^{-9}\\,\\mathrm{S}) \\left( (-60 \\times 10^{-3}\\,\\mathrm{V}) - (-88 \\times 10^{-3}\\,\\mathrm{V}) \\right)$$\nFirst, we calculate the driving force in volts:\n$$V_m - E_K = (-60 - (-88)) \\times 10^{-3}\\,\\mathrm{V} = (-60 + 88) \\times 10^{-3}\\,\\mathrm{V} = 28 \\times 10^{-3}\\,\\mathrm{V}$$\nNow, we multiply the conductance by the driving force to find the current in amperes (A), since $1\\,\\mathrm{S} \\times 1\\,\\mathrm{V} = 1\\,\\mathrm{A}$:\n$$I_K = (10 \\times 10^{-9}\\,\\mathrm{S}) \\times (28 \\times 10^{-3}\\,\\mathrm{V})$$\n$$I_K = 280 \\times 10^{-12}\\,\\mathrm{A}$$\nThe problem asks for the result to be expressed in picoamperes (pA). The prefix \"pico\" corresponds to a factor of $10^{-12}$. Therefore:\n$$I_K = 280\\,\\mathrm{pA}$$\n\nThe problem also requires indicating the direction of the current. The calculated value for $I_K$ is positive ($+280\\,\\mathrm{pA}$). The problem statement defines the sign convention that positive current corresponds to the net outward movement of positive charge. Since potassium ions ($\\mathrm{K}^+$) are positively charged, a positive current indicates a net efflux (outward movement) of $\\mathrm{K}^+$ ions from a neuron. This is physically consistent, as the membrane potential ($V_m = -60\\,\\mathrm{mV}$) is more positive (depolarized) than the potassium equilibrium potential ($E_K = -88\\,\\mathrm{mV}$), creating an electrochemical gradient that drives positive $\\mathrm{K}^+$ ions out of the cell.",
            "answer": "$$\\boxed{280}$$"
        },
        {
            "introduction": "Real neuronal function is dynamic, with intense activity altering the very ionic gradients that establish membrane potentials. This computational exercise  challenges you to model such a scenario, exploring how the accumulation of extracellular potassium ($K^{+}$) during firing shifts its Nernst potential, $E_K$. By quantifying the impact on potassium currents and overall excitability, you will bridge the gap between static biophysical equations and the dynamic behavior of a neuron.",
            "id": "3977992",
            "problem": "You are asked to design and implement a program that models how the potassium reversal potential for potassium ions ($E_K$) evolves as the extracellular potassium concentration ($[K]_o$) rises from $3\\,\\mathrm{mM}$ to $10\\,\\mathrm{mM}$ under intense neuronal firing, and to quantify the resulting changes in the potassium current density ($I_K$) and a simple excitability metric based on the threshold current density needed to reach a specified voltage threshold in a passive membrane.\n\nThe derivation and computation must start from first principles appropriate to brain modeling and computational neuroscience. Use the following foundations and definitions without invoking any shortcut formulas in the problem statement:\n- The electrochemical equilibrium condition for ionic species, where the net electrochemical potential difference is zero at equilibrium.\n- The ideal solution approximation for ions.\n- The relationship between conductance, driving force, and current in equivalent electrical circuits of membranes.\n- The definition of resting membrane potential as the conductance-weighted average of reversal potentials in a passive multi-conductance membrane.\n\nConstants and parameters to be used in your derivation and computation:\n- Absolute temperature $T = 310\\,\\mathrm{K}$.\n- Universal gas constant $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n- Faraday constant $F = 96485.33212\\,\\mathrm{C/mol}$.\n- Valence of potassium $z_K = +1$.\n- Intracellular potassium concentration $[K]_i = 140\\,\\mathrm{mM}$.\n- Maximal potassium conductance $g_{K,\\mathrm{max}} = 36\\,\\mathrm{mS/cm^2}$.\n- Leak conductance $g_L = 0.1\\,\\mathrm{mS/cm^2}$.\n- Leak reversal potential $E_L = -65\\,\\mathrm{mV}$.\n- Representative membrane voltage during interspike intervals $V_m = -55\\,\\mathrm{mV}$.\n- Voltage threshold for spike initiation in the simplified model $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$.\n- Average open probability of the potassium channel during activity $p_{\\mathrm{open}}$ is case dependent and specified in the test suite below.\n- The effective potassium conductance is $g_K = p_{\\mathrm{open}} \\cdot g_{K,\\mathrm{max}}$.\n\nComputational tasks for each test case:\n1. Derive the potassium reversal potential $E_K$ (in $\\mathrm{mV}$) from the electrochemical equilibrium condition at the given $[K]_o$ and $[K]_i$, using the constants $R$, $T$, $F$, and $z_K$.\n2. Compute the potassium current density $I_K$ (in $\\mathrm{\\mu A/cm^2}$) at the specified $V_m$ using the conductance $g_K$ and the driving force determined by the difference between $V_m$ and $E_K$.\n3. Compute the resting membrane potential $V_{\\mathrm{rest}}$ (in $\\mathrm{mV}$) as the conductance-weighted average of the leak and potassium reversal potentials, and then compute the threshold current density $I_{\\mathrm{th}}$ (in $\\mathrm{\\mu A/cm^2}$) required to hold the membrane at $V_{\\mathrm{th}}$ under steady-state conditions in the passive membrane.\n\nExplicit formulas for the above quantities must be derived from the stated foundational principles as part of your solution. Natural logarithms must be used where applicable.\n\nUnits and output requirements:\n- Express $E_K$ in $\\mathrm{mV}$, $I_K$ in $\\mathrm{\\mu A/cm^2}$, and $I_{\\mathrm{th}}$ in $\\mathrm{\\mu A/cm^2}$.\n- Round all outputs to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a list with the three floats $[E_K, I_K, I_{\\mathrm{th}}]$, and the final output must be a list of these lists.\n\nTest suite:\n- Case A (baseline): $[K]_o = 3\\,\\mathrm{mM}$, $p_{\\mathrm{open}} = 0.05$.\n- Case B (intense firing): $[K]_o = 10\\,\\mathrm{mM}$, $p_{\\mathrm{open}} = 0.40$.\n- Case C (boundary condition): $[K]_o = 140\\,\\mathrm{mM}$, $p_{\\mathrm{open}} = 0.40$.\n- Case D (intermediate): $[K]_o = 6\\,\\mathrm{mM}$, $p_{\\mathrm{open}} = 0.20$.\n\nFinal output format specification:\n- Your program must print exactly one line: a single list in the form $[[E_K^{(A)}, I_K^{(A)}, I_{\\mathrm{th}}^{(A)}],[E_K^{(B)}, I_K^{(B)}, I_{\\mathrm{th}}^{(B)}],[E_K^{(C)}, I_K^{(C)}, I_{\\mathrm{th}}^{(C)}],[E_K^{(D)}, I_K^{(D)}, I_{\\mathrm{th}}^{(D)}]]$, where superscripts indicate the test case labels. All numerical entries must be floats rounded to three decimal places.",
            "solution": "The problem has been validated and is determined to be sound, well-posed, and scientifically grounded in the principles of computational neuroscience. The parameters provided are consistent and within physiologically plausible ranges. The requested derivations and computations are standard procedures in biophysical modeling of neurons.\n\nThe solution will be presented by first deriving the required formulas from the foundational principles specified, followed by the computational implementation for the given test cases.\n\n**1. Derivation of the Potassium Reversal Potential ($E_K$)**\n\nThe reversal potential, or Nernst potential, for an ion is the membrane potential at which there is no net flow of that ion across the membrane. This equilibrium occurs when the electrochemical potential difference across the membrane is zero. The electrochemical potential difference, $\\Delta\\mu_X$, for an ionic species $X$ with valence $z_X$ is the sum of the chemical potential difference (due to concentration gradient) and the electrical potential difference (due to the electric field across the membrane).\n\nThe chemical potential difference for an ideal solution is given by:\n$$ \\Delta \\mu_{\\mathrm{chem}} = RT \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) $$\nwhere $R$ is the universal gas constant, $T$ is the absolute temperature, and $[X]_i$ and $[X]_o$ are the intracellular and extracellular concentrations of the ion, respectively.\n\nThe electrical potential difference experienced by one mole of ions is:\n$$ \\Delta \\mu_{\\mathrm{elec}} = z_X F V_m $$\nwhere $F$ is the Faraday constant and $V_m$ is the membrane potential.\n\nAt equilibrium, the total electrochemical potential difference is zero ($\\Delta\\mu_X = 0$), and the membrane potential is equal to the reversal potential, $E_X$.\n$$ \\Delta \\mu_X = RT \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) + z_X F E_X = 0 $$\nSolving for $E_X$ yields the Nernst equation:\n$$ E_X = -\\frac{RT}{z_X F} \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) = \\frac{RT}{z_X F} \\ln\\left(\\frac{[X]_o}{[X]_i}\\right) $$\nFor potassium ions ($K^+$), the valence $z_K = +1$. Therefore, the potassium reversal potential, $E_K$, is:\n$$ E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o}{[K]_i}\\right) $$\nThe result from this formula will be in Volts. To convert to millivolts ($\\mathrm{mV}$), as required, the result must be multiplied by $1000$. The concentrations $[K]_o$ and $[K]_i$ are given in $\\mathrm{mM}$, but since their ratio is used, the units cancel.\n\n**2. Computation of the Potassium Current Density ($I_K$)**\n\nThe relationship between ionic current, conductance, and driving force is described by a form of Ohm's law tailored for membranes. The current density for a specific ion, $I_X$, is the product of its membrane conductance, $g_X$, and the electrochemical driving force, $(V_m - E_X)$.\n$$ I_X = g_X (V_m - E_X) $$\nFor potassium, the current density $I_K$ is:\n$$ I_K = g_K (V_m - E_K) $$\nThe problem specifies that the effective potassium conductance $g_K$ is a product of the maximal conductance $g_{K,\\mathrm{max}}$ and the average open probability of the channels, $p_{\\mathrm{open}}$.\n$$ g_K = p_{\\mathrm{open}} \\cdot g_{K,\\mathrm{max}} $$\nThe computation is performed at a given representative membrane voltage, $V_m = -55\\,\\mathrm{mV}$. The units are consistent: if $g_K$ is in $\\mathrm{mS/cm^2}$ and voltages ($V_m$, $E_K$) are in $\\mathrm{mV}$, the resulting current density $I_K$ will be in $\\mathrm{\\mu A/cm^2}$ ($1\\,\\mathrm{mS} \\times 1\\,\\mathrm{mV} = 10^{-3}\\,\\mathrm{S} \\times 10^{-3}\\,\\mathrm{V} = 10^{-6}\\,\\mathrm{A} = 1\\,\\mathrm{\\mu A}$).\n\n**3. Computation of Resting Potential ($V_{\\mathrm{rest}}$) and Threshold Current ($I_{\\mathrm{th}}$)**\n\nThe resting membrane potential, $V_{\\mathrm{rest}}$, in a passive model is the potential at which the sum of all ionic currents across the membrane is zero, assuming no external current is applied. For the given two-conductance model (potassium and leak), this condition is:\n$$ I_{\\mathrm{total}} = I_K + I_L = 0 $$\nSubstituting the expressions for each current:\n$$ g_K(V_{\\mathrm{rest}} - E_K) + g_L(V_{\\mathrm{rest}} - E_L) = 0 $$\nwhere $g_L$ and $E_L$ are the leak conductance and leak reversal potential, respectively. Solving for $V_{\\mathrm{rest}}$:\n$$ V_{\\mathrm{rest}} (g_K+g_L) = g_K E_K + g_L E_L $$\n$$ V_{\\mathrm{rest}} = \\frac{g_K E_K + g_L E_L}{g_K + g_L} $$\nThis shows that the resting potential is the conductance-weighted average of the individual reversal potentials.\n\nThe threshold current, $I_{\\mathrm{th}}$, is defined as the external current density that must be injected to hold the membrane potential at the threshold for spike initiation, $V_{\\mathrm{th}}$. The dynamics of the membrane potential under an external current $I_{\\mathrm{ext}}$ can be described as $C_m \\frac{dV_m}{dt} = I_{\\mathrm{ext}} - I_{\\mathrm{ion}}(V_m)$, where $I_{\\mathrm{ion}}(V_m) = I_K + I_L$. To hold the potential constant at $V_{\\mathrm{th}}$, we must have $\\frac{dV_m}{dt} = 0$, which implies that the injected current must exactly balance the total ionic current at that voltage. Thus, $I_{\\mathrm{th}} = I_{\\mathrm{ext}} = I_{\\mathrm{ion}}(V_{\\mathrm{th}})$.\n$$ I_{\\mathrm{th}} = g_K(V_{\\mathrm{th}} - E_K) + g_L(V_{\\mathrm{th}} - E_L) $$\nBy convention, a positive current depolarizes the cell, and a negative current hyperpolarizes it. A positive $I_{\\mathrm{th}}$ indicates that a depolarizing current is needed to reach the threshold from the resting state, while a negative $I_{\\mathrm{th}}$ indicates a hyperpolarizing current is needed.\nThe calculation of $I_{\\mathrm{th}}$ proceeds by substituting the values for $g_K$, $E_K$, $g_L$, $E_L$, and $V_{\\mathrm{th}}$. The units will be $\\mathrm{\\mu A/cm^2}$ for the same reasons as for $I_K$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes potassium reversal potential, potassium current density, and threshold\n    current density based on fundamental biophysical principles for a set of test cases.\n    \"\"\"\n    \n    # Define constants and parameters from the problem statement.\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n    T = 310.0        # Absolute temperature in K\n    F = 96485.33212  # Faraday constant in C/mol\n    z_K = 1.0        # Valence of potassium\n    K_i = 140.0      # Intracellular potassium concentration in mM\n    g_K_max = 36.0   # Maximal potassium conductance in mS/cm^2\n    g_L = 0.1        # Leak conductance in mS/cm^2\n    E_L = -65.0      # Leak reversal potential in mV\n    V_m = -55.0      # Representative membrane voltage in mV\n    V_th = -50.0     # Voltage threshold for spike initiation in mV\n\n    # Pre-calculate the RT/F term in mV for the Nernst equation.\n    RT_over_F_mV = (R * T / (z_K * F)) * 1000.0\n\n    # Define the test cases. Each case is a tuple of ([K]_o, p_open).\n    test_cases = [\n        (3.0, 0.05),    # Case A: baseline\n        (10.0, 0.40),   # Case B: intense firing\n        (140.0, 0.40),  # Case C: boundary condition\n        (6.0, 0.20),    # Case D: intermediate\n    ]\n\n    all_results = []\n    for case in test_cases:\n        K_o, p_open = case\n\n        # Task 1: Compute potassium reversal potential E_K (in mV)\n        # using the Nernst equation derived in the solution.\n        # np.log is the natural logarithm.\n        E_K = RT_over_F_mV * np.log(K_o / K_i)\n\n        # Task 2: Compute potassium current density I_K (in µA/cm^2)\n        # Effective potassium conductance g_K\n        g_K = p_open * g_K_max\n        # Potassium current I_K using Ohm's law for the membrane\n        I_K = g_K * (V_m - E_K)\n        \n        # Task 3: Compute threshold current density I_th (in µA/cm^2)\n        # I_th is the injected current needed to hold V_m at V_th.\n        # This current must balance the ionic currents at V_th.\n        I_th = g_K * (V_th - E_K) + g_L * (V_th - E_L)\n        \n        # Round all results to three decimal places as required.\n        case_results = [\n            round(E_K, 3),\n            round(I_K, 3),\n            round(I_th, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output as a single-line string representation\n    # of the list of lists, with no spaces.\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}