{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在从第一性原理出发，巩固对高盛-霍奇金-卡茨（GHK）方程的理解。通过从能斯特-普朗克方程出发，并应用恒定场假设，你将推导出决定静息膜电位的核心方程。这项实践不仅能加深你对离子电扩散物理基础的认识，还能让你亲手计算一个生理学上真实的神经元膜电位值 。",
            "id": "3985073",
            "problem": "一层厚度为 $d$ 的平面脂质膜将细胞内溶液（下标 $i$）与细胞外溶液（下标 $o$）隔开。该膜对三种单价离子具有通透性：钾离子（$\\mathrm{K}^{+}$）、钠离子（$\\mathrm{Na}^{+}$）和氯离子（$\\mathrm{Cl}^{-}$）。定义跨膜电位为 $V_{m} = \\phi_{i} - \\phi_{o}$，其中 $\\phi$ 是电势。假设以下具有物理依据的条件成立：\n- 每种离子的稳态一维电扩散由 Nernst–Planck 方程决定，扩散系数为常数且无化学反应。\n- 跨膜电场在空间上是均匀的（恒定电场近似）。\n- 稳态时跨膜净离子电流为零。\n\n设相对渗透率之比为 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.05 : 0.45$。在温度 $T = 310\\,\\text{K}$ 时，离子活度可视为等于其浓度（单位为毫摩尔/升），细胞内和细胞外的体浓度由下式给出\n$\\left[\\mathrm{K}^{+}\\right]_{i} = 140\\,\\text{mM}$，$\\left[\\mathrm{K}^{+}\\right]_{o} = 5\\,\\text{mM}$，$\\left[\\mathrm{Na}^{+}\\right]_{i} = 12\\,\\text{mM}$，$\\left[\\mathrm{Na}^{+}\\right]_{o} = 145\\,\\text{mM}$，$\\left[\\mathrm{Cl}^{-}\\right]_{i} = 10\\,\\text{mM}$，以及 $\\left[\\mathrm{Cl}^{-}\\right]_{o} = 110\\,\\text{mM}$。\n\n从每种离子的 Nernst–Planck 通量和上述假设出发，推导稳态跨膜电位 $V_{m}$ 的一个闭合形式表达式，用气体常数 $R$、法拉第常数 $F$、温度 $T$、渗透率 $P_{s}$ 以及细胞内/外浓度表示，并注意正确处理氯离子的阴离子价态。然后根据给定数据对 $V_{m}$ 进行数值计算。以毫伏为单位表示最终数值答案，并四舍五入到 $3$ 位有效数字。",
            "solution": "该问题是电生理学基本原理的有效应用，且提法恰当。推导和计算 Goldman-Hodgkin-Katz (GHK) 电压所需的所有数据和条件均已提供。我将开始进行解答。\n\n该问题要求从离子通量的 Nernst-Planck 方程和恒定电场近似出发，推导稳态跨膜电位 $V_m$。\n\n离子种类 $s$ 的一维 Nernst-Planck 通量密度方程 $J_s$ 由下式给出：\n$$ J_s(x) = -D_s \\left( \\frac{d[s](x)}{dx} + \\frac{z_s F}{RT} [s](x) \\frac{d\\phi(x)}{dx} \\right) $$\n其中 $D_s$ 是扩散系数，$[s](x)$ 是跨膜位置 $x$ 处的浓度，$z_s$ 是离子价态，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度，$\\phi(x)$ 是电势。坐标 $x$ 从细胞外侧（$x=0$）延伸到细胞内侧（$x=d$）。\n\n问题陈述了恒定电场近似，即假设电场 $E = -d\\phi/dx$ 在整个膜上是均匀的。将其从 $x=0$ 积分到 $x=d$：\n$$ \\int_{\\phi_o}^{\\phi_i} d\\phi = \\int_{0}^{d} -\\frac{d\\phi}{dx} dx = \\int_{0}^{d} E dx = E d $$\n跨膜电位定义为 $V_m = \\phi_i - \\phi_o$。因此，$V_m = E d$，这意味着 $E = V_m/d$。\n将 $d\\phi/dx = -E = -V_m/d$ 代入 Nernst-Planck 方程，得到：\n$$ J_s = -D_s \\left( \\frac{d[s]}{dx} - \\frac{z_s F V_m}{RTd} [s] \\right) $$\n在稳态下，每种离子的通量 $J_s$ 对于所有 $x \\in [0, d]$ 都必须是恒定的。我们可以将其重新整理为关于 $[s](x)$ 的一阶线性常微分方程：\n$$ \\frac{d[s]}{dx} - \\left(\\frac{z_s F V_m}{RTd}\\right) [s] = -\\frac{J_s}{D_s} $$\n为了解这个方程，我们使用积分因子 $I(x) = \\exp\\left(-\\int \\frac{z_s F V_m}{RTd} dx\\right) = \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right)$。\n将该常微分方程乘以 $I(x)$：\n$$ \\frac{d}{dx}\\left( [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right) = -\\frac{J_s}{D_s} \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) $$\n我们使用边界条件 $[s](0) = [s]_o$（细胞外浓度）和 $[s](d) = [s]_i$（细胞内浓度），将此表达式从 $x=0$ 到 $x=d$ 对整个膜进行积分：\n$$ \\int_0^d \\frac{d}{dx}\\left( [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right) dx = -\\frac{J_s}{D_s} \\int_0^d \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) dx $$\n$$ \\left[ [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right]_0^d = -\\frac{J_s}{D_s} \\left[ \\frac{-RTd}{z_s F V_m} \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right]_0^d $$\n$$ [s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o = \\frac{J_s RTd}{D_s z_s F V_m} \\left( \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1 \\right) $$\n求解通量 $J_s$：\n$$ J_s = \\frac{D_s z_s F V_m}{RTd} \\frac{[s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1} $$\n离子电流密度为 $I_s = z_s F J_s$。膜渗透率定义为 $P_s = D_s/d$。代入这些量，得到种类 $s$ 的 Goldman-Hodgkin-Katz 电流方程：\n$$ I_s = P_s z_s^2 \\frac{F^2 V_m}{RT} \\frac{[s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1} $$\n将分子和分母同乘以 $-\\exp\\left(\\frac{z_s F V_m}{RT}\\right)$，得到更常见的形式：\n$$ I_s = P_s z_s^2 \\frac{F^2 V_m}{RT} \\frac{[s]_o - [s]_i \\exp\\left(\\frac{z_s F V_m}{RT}\\right)}{1 - \\exp\\left(\\frac{z_s F V_m}{RT}\\right)} $$\n问题陈述，稳态时跨膜的净离子电流为零：\n$$ I_{net} = \\sum_s I_s = I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0 $$\n对于阳离子 $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$，价态 $z_s = +1$。对于阴离子 $\\mathrm{Cl}^{-}$，$z_s = -1$。\n我们定义一个无量纲电压 $u = \\frac{F V_m}{RT}$。\n对于阳离子（$z_s = +1$）：\n$$ I_{cat} = P_{cat} \\frac{F^2 V_m}{RT} \\frac{[cat]_o - [cat]_i \\exp(u)}{1 - \\exp(u)} $$\n对于阴离子 $\\mathrm{Cl}^{-}$（$z_s = -1$）：\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} (-1)^2 \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{Cl}^{-}]_o - [\\mathrm{Cl}^{-}]_i \\exp(-u)}{1 - \\exp(-u)} $$\n为了对电流求和，我们必须通分。我们通过将其分子和分母同乘以 $-\\exp(u)$ 来处理阴离子电流项：\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{\\left([\\mathrm{Cl}^{-}]_o - [\\mathrm{Cl}^{-}]_i \\exp(-u)\\right) \\times (-\\exp(u))}{\\left(1 - \\exp(-u)\\right) \\times (-\\exp(u))} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{-[\\mathrm{Cl}^{-}]_o \\exp(u) + [\\mathrm{Cl}^{-}]_i}{-\\exp(u) + 1} $$\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{Cl}^{-}]_i - [\\mathrm{Cl}^{-}]_o \\exp(u)}{1 - \\exp(u)} $$\n现在我们将电流相加并令其为零。假设 $V_m \\neq 0$，公共因子 $ \\frac{F^2 V_m}{RT} \\frac{1}{1 - \\exp(u)} $ 可以被消去：\n$$ P_{\\mathrm{K}}([\\mathrm{K}^{+}]_o - [\\mathrm{K}^{+}]_i \\exp(u)) + P_{\\mathrm{Na}}([\\mathrm{Na}^{+}]_o - [\\mathrm{Na}^{+}]_i \\exp(u)) + P_{\\mathrm{Cl}}([\\mathrm{Cl}^{-}]_i - [\\mathrm{Cl}^{-}]_o \\exp(u)) = 0 $$\n合并含有 $\\exp(u)$ 的项：\n$$ \\left( P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i \\right) = \\exp(u) \\left( P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o \\right) $$\n求解 $\\exp(u)$：\n$$ \\exp(u) = \\frac{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i }{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o } $$\n代回 $u = F V_m / RT$ 并求解 $V_m$，我们得到 GHK 电压方程：\n$$ V_m = \\frac{RT}{F} \\ln \\left( \\frac{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i }{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o } \\right) $$\n这就是所要求的闭合形式表达式。请注意，由于氯离子的负价态，其浓度项是“翻转”的（细胞内浓度在分子上，细胞外浓度在分母上）。\n\n现在，我们对 $V_m$ 进行数值计算。物理常数为 $R \\approx 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和 $F \\approx 96485\\,\\text{C}\\,\\text{mol}^{-1}$。\n首先，计算在 $T = 310\\,\\text{K}$ 时的热电压项 $\\frac{RT}{F}$：\n$$ \\frac{RT}{F} = \\frac{(8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(310\\,\\text{K})}{96485\\,\\text{C}\\,\\text{mol}^{-1}} \\approx 0.026712\\,\\text{V} $$\n问题给出了相对渗透率 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.05 : 0.45$。我们可以直接使用这些值，因为只有它们的比率有影响。\n浓度为（单位 $\\text{mM}$）：\n$[\\mathrm{K}^{+}]_{i} = 140$, $[\\mathrm{K}^{+}]_{o} = 5$\n$[\\mathrm{Na}^{+}]_{i} = 12$, $[\\mathrm{Na}^{+}]_{o} = 145$\n$[\\mathrm{Cl}^{-}]_{i} = 10$, $[\\mathrm{Cl}^{-}]_{o} = 110$\n\n计算对数参数的分子：\n$$ \\text{Numerator} = P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i $$\n$$ \\text{Numerator} = (1)(5) + (0.05)(145) + (0.45)(10) = 5 + 7.25 + 4.5 = 16.75 $$\n计算对数参数的分母：\n$$ \\text{Denominator} = P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o $$\n$$ \\text{Denominator} = (1)(140) + (0.05)(12) + (0.45)(110) = 140 + 0.6 + 49.5 = 190.1 $$\n现在，计算 $V_m$：\n$$ V_m = (0.026712\\,\\text{V}) \\ln\\left(\\frac{16.75}{190.1}\\right) \\approx (0.026712\\,\\text{V}) \\ln(0.0881115) $$\n$$ V_m \\approx (0.026712\\,\\text{V})(-2.4291) \\approx -0.064917\\,\\text{V} $$\n转换为毫伏：$V_m \\approx -64.917\\,\\text{mV}$。\n四舍五入到 $3$ 位有效数字，我们得到 $V_m = -64.9\\,\\text{mV}$。",
            "answer": "$$\\boxed{-64.9}$$"
        },
        {
            "introduction": "在掌握了 GHK 方程的基本计算后，本练习将引导你探究膜电位动态变化的核心机制——离子通透性的改变。神经元的兴奋性很大程度上取决于钠离子（$Na^+$）等通道通透性的快速变化。通过模拟钠离子通透性（$P_{Na}$）的增加，你将定量地分析膜电位如何去极化，从而为理解动作电位的产生等神经信号过程建立直观的物理认识 。",
            "id": "3985069",
            "problem": "一个单室神经元模型，其细胞膜可通透三种单价离子：钾离子 $\\mathrm{K}^+$、钠离子 $\\mathrm{Na}^+$ 和氯离子 $\\mathrm{Cl}^-$。细胞内和细胞外浓度（单位为毫摩尔）指定为 $[\\mathrm{K}^+]_{\\mathrm{i}} = 140$, $[\\mathrm{K}^+]_{\\mathrm{o}} = 4$, $[\\mathrm{Na}^+]_{\\mathrm{i}} = 15$, $[\\mathrm{Na}^+]_{\\mathrm{o}} = 145$, $[\\mathrm{Cl}^-]_{\\mathrm{i}} = 10$, 以及 $[\\mathrm{Cl}^-]_{\\mathrm{o}} = 120$。绝对温度为 $T = 310\\,\\mathrm{K}$。膜通透性不随时间变化且空间均匀，其基准值为 $P_{\\mathrm{K}} = 1$（任意单位），$P_{\\mathrm{Na}} = r_0 = 0.05$ 和 $P_{\\mathrm{Cl}} = 0.2$。令 $R$ 表示理想气体常数，$F$ 表示法拉第常数。\n\n从空间恒定电场（恒定场近似）下离子流的稳态电荷平衡原理以及单价离子的电化学势定义出发，推导静息膜电位 $V_{\\mathrm{m}}$ 作为浓度和通透性的函数。然后，在基准通透性和钠离子通透性增加十倍（即 $P_{\\mathrm{Na}} = 10 r_0$）的条件下计算 $V_{\\mathrm{m}}$ 的值，同时保持所有其他参数不变。最后，对于指定的离子环境且 $P_{\\mathrm{Cl}}$ 保持固定的情况，确定当静息膜电位等于 $-50\\,\\mathrm{mV}$ 时的唯一比率 $r^{\\ast} = P_{\\mathrm{Na}} / P_{\\mathrm{K}}$；将 $r^{\\ast}$ 作为最终数值答案，四舍五入到三位有效数字。当你计算中间膜电位时，通过因子 $RT/F$ 和自然对数，以毫伏为单位表示。",
            "solution": "### 第一步：提取已知条件\n问题陈述中明确给出的数据、变量和条件如下：\n- 离子种类：单价离子钾 ($\\mathrm{K}^+$)、钠 ($\\mathrm{Na}^+$) 和氯 ($\\mathrm{Cl}^-$)。\n- 细胞内浓度：$[\\mathrm{K}^+]_{\\mathrm{i}} = 140\\,\\mathrm{mM}$, $[\\mathrm{Na}^+]_{\\mathrm{i}} = 15\\,\\mathrm{mM}$, $[\\mathrm{Cl}^-]_{\\mathrm{i}} = 10\\,\\mathrm{mM}$。\n- 细胞外浓度：$[\\mathrm{K}^+]_{\\mathrm{o}} = 4\\,\\mathrm{mM}$, $[\\mathrm{Na}^+]_{\\mathrm{o}} = 145\\,\\mathrm{mM}$, $[\\mathrm{Cl}^-]_{\\mathrm{o}} = 120\\,\\mathrm{mM}$。\n- 绝对温度：$T = 310\\,\\mathrm{K}$。\n- 基准膜通透性：$P_{\\mathrm{K}} = 1$（任意单位），$P_{\\mathrm{Na}} = r_0 = 0.05$, $P_{\\mathrm{Cl}} = 0.2$。\n- 常数：理想气体常数 ($R$)，法拉第常数 ($F$)。\n- 第二次计算的条件：钠离子通透性增加十倍，$P_{\\mathrm{Na}} = 10 r_0 = 0.5$。\n- 第三次计算的条件：找出当静息膜电位 $V_{\\mathrm{m}}$ 等于 $-50\\,\\mathrm{mV}$ 时的唯一比率 $r^{\\ast} = P_{\\mathrm{Na}} / P_{\\mathrm{K}}$，此时 $P_{\\mathrm{Cl}}$ 保持固定。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准评估该问题：\n- **科学依据**：该问题基于 Goldman-Hodgkin-Katz (GHK) 模型，这是生物物理学和计算神经科学中用于描述静息膜电位的一个基础且成熟的原理。所提供的离子浓度对于典型的哺乳动物神经元在生理上是现实的，温度也是生理温度。膜通透性、离子流和电化学势等概念都是标准的科学概念。\n- **适定性**：问题结构清晰。它要求进行一次推导、两次具体计算，并确定满足给定条件的参数值。所有必要的数据（浓度、通透性、温度）都已提供，可以为每个部分找到唯一解。\n- **客观性**：问题使用精确的、定量的语言陈述，没有主观或模糊的术语。\n- **完整性和一致性**：问题是自洽的。给定的值是一致且充分的，足以执行所需的推导和计算。不存在矛盾。任务不涉及任何科学上不成立的前提、无法形式化的类比或不切实际的条件。\n\n### 第三步：结论与行动\n该问题在科学上有效、适定且内部一致。我将继续进行完整解答。\n\n静息膜电位 $V_{\\mathrm{m}}$ 的推导始于一个原理：在稳态下，穿过膜的总净电荷流为零。由离子种类 $S$ 携带的电流 $I_S$ 是其化合价 $z_S$、法拉第常数 $F$ 和其通量 $J_S$ 的乘积，即 $I_S = z_S F J_S$。总电流是各个离子电流之和：\n$$\nI_{\\text{total}} = \\sum_S I_S = I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0\n$$\n在恒定场近似下，每种离子的通量 $J_S$ 由 Goldman-Hodgkin-Katz 通量方程给出。对于化合价为 $z_S$ 的离子种类 $S$，其电流为：\n$$\nI_S = P_S z_S^2 \\frac{F^2 V_{\\mathrm{m}}}{RT} \\frac{[S]_{\\mathrm{i}} - [S]_{\\mathrm{o}}\\exp(-z_S F V_{\\mathrm{m}} / RT)}{1 - \\exp(-z_S F V_{\\mathrm{m}} / RT)}\n$$\n其中 $P_S$ 是膜通透性，$[S]_{\\mathrm{i}}$ 和 $[S]_{\\mathrm{o}}$ 是细胞内和细胞外浓度，$R$ 是理想气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。\n\n对于给定的单价离子，化合价分别为 $z_{\\mathrm{K}}=+1$, $z_{\\mathrm{Na}}=+1$ 和 $z_{\\mathrm{Cl}}=-1$。注意，对于所有这些离子，$z_S^2 = 1$。零电流条件变为：\n$$\nI_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0\n$$\n代入每种离子的 GHK 电流表达式：\n$$\nP_{\\mathrm{K}} \\frac{F^2 V_{\\mathrm{m}}}{RT} \\frac{[\\mathrm{K}^+]_{\\mathrm{i}} - [\\mathrm{K}^+]_{\\mathrm{o}}\\exp(- F V_{\\mathrm{m}} / RT)}{1 - \\exp(- F V_{\\mathrm{m}} / RT)} + P_{\\mathrm{Na}} \\frac{F^2 V_{\\mathrm{m}}}{RT} \\frac{[\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}\\exp(- F V_{\\mathrm{m}} / RT)}{1 - \\exp(- F V_{\\mathrm{m}} / RT)} + P_{\\mathrm{Cl}} \\frac{F^2 V_{\\mathrm{m}}}{RT} \\frac{[\\mathrm{Cl}^-]_{\\mathrm{i}} - [\\mathrm{Cl}^-]_{\\mathrm{o}}\\exp(F V_{\\mathrm{m}} / RT)}{1 - \\exp(F V_{\\mathrm{m}} / RT)} = 0\n$$\n假设 $V_{\\mathrm{m}} \\neq 0$，我们可以消去公因子 $\\frac{F^2 V_{\\mathrm{m}}}{RT}$：\n$$\n\\frac{P_{\\mathrm{K}}([\\mathrm{K}^+]_{\\mathrm{i}} - [\\mathrm{K}^+]_{\\mathrm{o}}e^{-u}) + P_{\\mathrm{Na}}([\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}e^{-u})}{1 - e^{-u}} + \\frac{P_{\\mathrm{Cl}}([\\mathrm{Cl}^-]_{\\mathrm{i}} - [\\mathrm{Cl}^-]_{\\mathrm{o}}e^{u})}{1 - e^{u}} = 0\n$$\n其中我们定义了无量纲电位 $u = F V_{\\mathrm{m}} / RT$。氯离子项的分母可以重写为 $1 - e^u = -e^u(1 - e^{-u})$。代入后得到：\n$$\n\\frac{P_{\\mathrm{K}}([\\mathrm{K}^+]_{\\mathrm{i}} - [\\mathrm{K}^+]_{\\mathrm{o}}e^{-u}) + P_{\\mathrm{Na}}([\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}e^{-u})}{1 - e^{-u}} - \\frac{P_{\\mathrm{Cl}}([\\mathrm{Cl}^-]_{\\mathrm{i}} - [\\mathrm{Cl}^-]_{\\mathrm{o}}e^{u})}{e^u(1 - e^{-u})} = 0\n$$\n乘以 $1 - e^{-u}$（假设 $V_{\\mathrm{m}} \\neq 0$）并简化氯离子项：\n$$\nP_{\\mathrm{K}}([\\mathrm{K}^+]_{\\mathrm{i}} - [\\mathrm{K}^+]_{\\mathrm{o}}e^{-u}) + P_{\\mathrm{Na}}([\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}e^{-u}) - P_{\\mathrm{Cl}}([\\mathrm{Cl}^-]_{\\mathrm{i}}e^{-u} - [\\mathrm{Cl}^-]_{\\mathrm{o}}) = 0\n$$\n整理各项：\n$$\nP_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{o}} = e^{-u} (P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{i}})\n$$\n求解 $e^{-u}$：\n$$\ne^{-u} = \\exp(-F V_{\\mathrm{m}} / RT) = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{o}}}{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{i}}}\n$$\n取自然对数并求解 $V_{\\mathrm{m}}$：\n$$\n- \\frac{F V_{\\mathrm{m}}}{RT} = \\ln\\left(\\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{o}}}{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{i}}}\\right)\n$$\n这就得到了 Goldman-Hodgkin-Katz (GHK) 电压方程：\n$$\nV_{\\mathrm{m}} = \\frac{RT}{F} \\ln\\left(\\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{o}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{o}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{i}}}{P_{\\mathrm{K}}[\\mathrm{K}^+]_{\\mathrm{i}} + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_{\\mathrm{i}} + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_{\\mathrm{o}}}\\right)\n$$\n现在，我们针对指定条件计算 $V_{\\mathrm{m}}$。首先，我们计算热电压因子 $\\frac{RT}{F}$：\n$$\n\\frac{RT}{F} = \\frac{(8.314\\,\\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1})(310\\,\\mathrm{K})}{96485\\,\\mathrm{C} \\cdot \\mathrm{mol}^{-1}} \\approx 0.026705\\,\\mathrm{V} = 26.705\\,\\mathrm{mV}\n$$\n**计算 1：基准静息电位**\n在基准通透性 $P_{\\mathrm{K}} = 1$，$P_{\\mathrm{Na}} = 0.05$ 和 $P_{\\mathrm{Cl}} = 0.2$ 下：\nln 参数的分子：$N = (1)(4) + (0.05)(145) + (0.2)(10) = 4 + 7.25 + 2 = 13.25$\nln 参数的分母：$D = (1)(140) + (0.05)(15) + (0.2)(120) = 140 + 0.75 + 24 = 164.75$\n$$\nV_{\\mathrm{m}} = (26.705\\,\\mathrm{mV}) \\ln\\left(\\frac{13.25}{164.75}\\right) \\approx (26.705\\,\\mathrm{mV}) \\ln(0.08042) \\approx (26.705\\,\\mathrm{mV})(-2.520) \\approx -67.29\\,\\mathrm{mV}\n$$\n**计算 2：钠离子通透性增加**\n当 $P_{\\mathrm{Na}}$ 增加十倍至 $10 r_0 = 0.5$，而 $P_{\\mathrm{K}} = 1$ 和 $P_{\\mathrm{Cl}} = 0.2$ 保持不变时：\n分子：$N = (1)(4) + (0.5)(145) + (0.2)(10) = 4 + 72.5 + 2 = 78.5$\n分母：$D = (1)(140) + (0.5)(15) + (0.2)(120) = 140 + 7.5 + 24 = 171.5$\n$$\nV_{\\mathrm{m}} = (26.705\\,\\mathrm{mV}) \\ln\\left(\\frac{78.5}{171.5}\\right) \\approx (26.705\\,\\mathrm{mV}) \\ln(0.4577) \\approx (26.705\\,\\mathrm{mV})(-0.7814) \\approx -20.87\\,\\mathrm{mV}\n$$\n**计算 3：确定比率 $r^{\\ast}$**\n我们需要找到使 $V_{\\mathrm{m}} = -50\\,\\mathrm{mV}$ 的比率 $r^{\\ast} = P_{\\mathrm{Na}} / P_{\\mathrm{K}}$。我们可以用 $P_{\\mathrm{K}}$ 对 GHK 方程进行归一化：\n$$\nV_{\\mathrm{m}} = \\frac{RT}{F} \\ln\\left(\\frac{[\\mathrm{K}^+]_{\\mathrm{o}} + (P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}^+]_{\\mathrm{o}} + (P_{\\mathrm{Cl}}/P_{\\mathrm{K}})[\\mathrm{Cl}^-]_{\\mathrm{i}}}{[\\mathrm{K}^+]_{\\mathrm{i}} + (P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}^+]_{\\mathrm{i}} + (P_{\\mathrm{Cl}}/P_{\\mathrm{K}})[\\mathrm{Cl}^-]_{\\mathrm{o}}}\\right)\n$$\n令 $r^{\\ast} = P_{\\mathrm{Na}}/P_{\\mathrm{K}}$ 且 $c = P_{\\mathrm{Cl}}/P_{\\mathrm{K}} = 0.2/1 = 0.2$：\n$$\nV_{\\mathrm{m}} = \\frac{RT}{F} \\ln\\left(\\frac{[\\mathrm{K}^+]_{\\mathrm{o}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{o}} + c[\\mathrm{Cl}^-]_{\\mathrm{i}}}{[\\mathrm{K}^+]_{\\mathrm{i}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{i}} + c[\\mathrm{Cl}^-]_{\\mathrm{o}}}\\right)\n$$\n我们求解 $r^{\\ast}$。令 $E = \\exp\\left(\\frac{V_{\\mathrm{m}} F}{RT}\\right)$。\n$$\nE = \\frac{[\\mathrm{K}^+]_{\\mathrm{o}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{o}} + c[\\mathrm{Cl}^-]_{\\mathrm{i}}}{[\\mathrm{K}^+]_{\\mathrm{i}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{i}} + c[\\mathrm{Cl}^-]_{\\mathrm{o}}}\n$$\n$E([\\mathrm{K}^+]_{\\mathrm{i}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{i}} + c[\\mathrm{Cl}^-]_{\\mathrm{o}}) = [\\mathrm{K}^+]_{\\mathrm{o}} + r^{\\ast}[\\mathrm{Na}^+]_{\\mathrm{o}} + c[\\mathrm{Cl}^-]_{\\mathrm{i}}$\n$r^{\\ast}(E[\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}) = [\\mathrm{K}^+]_{\\mathrm{o}} + c[\\mathrm{Cl}^-]_{\\mathrm{i}} - E([\\mathrm{K}^+]_{\\mathrm{i}} + c[\\mathrm{Cl}^-]_{\\mathrm{o}})$\n$$\nr^{\\ast} = \\frac{[\\mathrm{K}^+]_{\\mathrm{o}} + c[\\mathrm{Cl}^-]_{\\mathrm{i}} - E([\\mathrm{K}^+]_{\\mathrm{i}} + c[\\mathrm{Cl}^-]_{\\mathrm{o}})}{E[\\mathrm{Na}^+]_{\\mathrm{i}} - [\\mathrm{Na}^+]_{\\mathrm{o}}}\n$$\n我们计算当 $V_{\\mathrm{m}} = -50\\,\\mathrm{mV} = -0.050\\,\\mathrm{V}$ 时 $E$ 的值：\n$$\n\\frac{V_{\\mathrm{m}}F}{RT} = \\frac{-0.050\\,\\mathrm{V}}{0.026705\\,\\mathrm{V}} \\approx -1.8723\n$$\n$$\nE = \\exp(-1.8723) \\approx 0.15378\n$$\n现在代入数值：\n$r^{\\ast}$ 的分子：\n$N_{r} = (4) + (0.2)(10) - (0.15378)((140) + (0.2)(120))$\n$N_{r} = 6 - (0.15378)(140 + 24) = 6 - (0.15378)(164) = 6 - 25.220 = -19.220$\n$r^{\\ast}$ 的分母：\n$D_{r} = (0.15378)(15) - 145 = 2.3067 - 145 = -142.6933$\n$$\nr^{\\ast} = \\frac{-19.220}{-142.6933} \\approx 0.13469\n$$\n四舍五入到三位有效数字，我们得到 $r^{\\ast} = 0.135$。",
            "answer": "$$\\boxed{0.135}$$"
        },
        {
            "introduction": "GHK 方程虽然是描述静息电位的基础，但它假设了离子浓度梯度是恒定的。在真实的细胞中，这些梯度是由消耗能量的主动转运（如钠钾泵）来维持的，而这些泵本身也具有电生性，会产生电流。本练习将挑战你构建一个更完整的细胞膜模型，将电生泵产生的电流（$I_{\\text{pump}}$）与被动泄露电流相结合，并通过数值方法求解在真实生理条件下，这两种电流达到平衡时的静息膜电位 。",
            "id": "3985075",
            "problem": "考虑一个单室神经元膜，其具有针对钾离子 ($K^+$)、钠离子 ($Na^+$) 和氯离子 ($Cl^-$) 的三种被动泄漏通道，以及一个产生净外向电流密度的生电性钠钾泵。假设膜两端的电场采用恒定场（与位置无关）近似，并且系统处于稳态，其中细胞内和细胞外的离子浓度由与膜充电时间相比足够慢的动力学过程维持恒定。设化合价为 $z_{K} = +1$，$z_{Na} = +1$ 和 $z_{Cl} = -1$。净稳态膜电流密度 $J_{\\text{tot}}(V_m)$（符号约定为正值对应正电荷的净外向移动，等效于正电流流出细胞）在稳态下必须满足电荷守恒：在静息电位 $V_m^\\ast$ 下，离子泄漏电流密度与泵电流密度之和为零。\n\n从第一性原理出发——包括粒子守恒、由均匀电场引起的漂移所增强的 Fick 扩散定律，以及电化学势的 Boltzmann 关系——推导每种离子物种的膜电流密度作为膜电位 $V_m$ 的函数表达式，并对下面的每个参数集，确定满足 $J_{\\text{tot}}(V_m^\\ast) = 0$ 的静息电位 $V_m^\\ast$。你必须以伏特为单位表示最终答案，并四舍五入到六位小数。使用以下常量：法拉第常数 $F = 96485\\,\\text{C}/\\text{mol}$，普适气体常数 $R = 8.314\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，以及绝对温度 $T = 310\\,\\text{K}$。\n\n使用以下离子浓度，在所有测试用例中保持固定：\n- 细胞内浓度：$[K^+]_{\\text{in}} = 140\\,\\text{mM}$，$[Na^+]_{\\text{in}} = 15\\,\\text{mM}$，$[Cl^-]_{\\text{in}} = 10\\,\\text{mM}$。\n- 细胞外浓度：$[K^+]_{\\text{out}} = 5\\,\\text{mM}$，$[Na^+]_{\\text{out}} = 145\\,\\text{mM}$，$[Cl^-]_{\\text{out}} = 110\\,\\text{mM}$。\n\n计算时将 $1\\,\\text{mM}$ 视为 $1\\,\\text{mol}/\\text{m}^3$。膜泵产生净外向电流密度 $I_{\\text{pump}}$（单位为 $\\mu\\text{A}/\\text{cm}^2$）。使用 $1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$ 将 $I_{\\text{pump}}$ 转换为安培/平方米。泄漏渗透率 $P_{\\mathrm{K}}$、$P_{\\mathrm{Na}}$、$P_{\\mathrm{Cl}}$ 的单位为米/秒。\n\n你的任务是：\n- 在恒定场假设下，从第一性原理构建 $J_{\\text{tot}}(V_m)$，使得 $J_{\\text{tot}}(V_m) = J_K(V_m) + J_{Na}(V_m) + J_{Cl}(V_m) + I_{\\text{pump}}$，并对下面的每个测试用例求解 $J_{\\text{tot}}(V_m^\\ast) = 0$ 时的 $V_m^\\ast$。\n- 通过使用从你的公式推导出的适当极限表达式，确保在 $V_m = 0$ 伏特附近的计算具有数值稳定性。\n- 以伏特为单位生成结果，保留六位小数。\n\n测试套件（每个元组为 $(I_{\\text{pump}}, P_{\\mathrm{K}}, P_{\\mathrm{Na}}, P_{\\mathrm{Cl}})$）：\n1. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$.\n2. $(0\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$.\n3. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 0\\,\\text{m/s})$.\n4. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-8}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$.\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[v_1,v_2,v_3,v_4]$），其中每个 $v_i$ 是相应测试用例计算出的 $V_m^\\ast$（单位为伏特），并四舍五入到六位小数。",
            "solution": "### 步骤 1：提取已知条件\n问题提供了以下信息：\n- **离子种类**：钾离子 ($K^+$)、钠离子 ($Na^+$)、氯离子 ($Cl^-$)。\n- **化合价**：$z_K = +1$，$z_{Na} = +1$，$z_{Cl} = -1$。\n- **常量**：\n    - 法拉第常数：$F = 96485\\,\\text{C}/\\text{mol}$。\n    - 普适气体常数：$R = 8.314\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$。\n    - 绝对温度：$T = 310\\,\\text{K}$。\n- **细胞内浓度**：\n    - $[K^+]_{\\text{in}} = 140\\,\\text{mM}$\n    - $[Na^+]_{\\text{in}} = 15\\,\\text{mM}$\n    - $[Cl^-]_{\\text{in}} = 10\\,\\text{mM}$\n- **细胞外浓度**：\n    - $[K^+]_{\\text{out}} = 5\\,\\text{mM}$\n    - $[Na^+]_{\\text{out}} = 145\\,\\text{mM}$\n    - $[Cl^-]_{\\text{out}} = 110\\,\\text{mM}$\n- **浓度单位约定**：$1\\,\\text{mM}$ 被视为 $1\\,\\text{mol}/\\text{m}^3$。\n- **泵电流密度**：$I_{\\text{pump}}$ 以 $\\mu\\text{A}/\\text{cm}^2$ 为单位给出。\n- **电流密度单位约定**：$1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$。\n- **渗透率**：$P_{\\mathrm{K}}$、$P_{\\mathrm{Na}}$、$P_{\\mathrm{Cl}}$ 以 $\\text{m/s}$ 为单位给出。\n- **稳态控制方程**：总膜电流密度 $J_{\\text{tot}}(V_m)$ 是各离子电流密度和泵电流密度之和。在静息电位 $V_m^\\ast$ 下，此和必须为零：\n$$J_{\\text{tot}}(V_m^\\ast) = J_K(V_m^\\ast) + J_{Na}(V_m^\\ast) + J_{Cl}(V_m^\\ast) + I_{\\text{pump}} = 0$$\n- **假设**：稳态，恒定场近似。\n- **测试套件**：提供了四个 $(I_{\\text{pump}}, P_{\\mathrm{K}}, P_{\\mathrm{Na}}, P_{\\mathrm{Cl}})$ 元组，需要为它们计算 $V_m^\\ast$。\n    1. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n    2. $(0\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n    3. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 0\\,\\text{m/s})$。\n    4. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-8}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n此问题要求推导并应用 Goldman-Hodgkin-Katz (GHK) 电流方程，并增加一个生电泵电流，以求出神经元静息电位。\n- **科学依据**：该问题基于电扩散的基本原理，如 Nernst-Planck 方程所描述，以及恒定场假设，这两者共同导出了 GHK 方程。这些是生物物理学和计算神经科学中规范且成熟的模型。没有伪科学或事实错误。\n- **适定性**：问题给出了定义总电流函数 $J_{\\text{tot}}(V_m)$ 所需的完整参数集（浓度、渗透率、常数、泵电流）。函数 $J_{\\text{tot}}(V_m)$ 是单调的，确保在生理学上合理的范围内存在唯一的根 $V_m^\\ast$。\n- **客观性**：问题使用精确、定量的语言和公认的科学术语进行陈述。没有主观或模糊的陈述。\n- **无其他缺陷**：问题不是隐喻性的，与指定主题直接相关，不是不完整或矛盾的，没有提出不切实际的条件，结构良好，并非微不足道，并且是科学可验证的。\n\n### 步骤 3：结论与行动\n此问题有效。将提供严谨的解决方案。\n\n### 解题推导与方法\n解决方案要求找到静息膜电位 $V_m^\\ast$，该电位满足稳态下跨膜净电流为零的条件。这包括推导每种离子的电流-电压关系，然后数值求解总电流为零时的电位。\n\n**1. Goldman-Hodgkin-Katz (GHK) 电流方程的推导**\n离子物种 $s$ 穿过膜的运动受浓度梯度引起的扩散和电场引起的漂移共同控制。在膜上位置 $x$ 处的一维通量密度 $j_s(x)$ 由 Nernst-Planck 方程描述：\n$$j_s(x) = -D_s \\left( \\frac{d[s](x)}{dx} + \\frac{z_s F}{RT} [s](x) \\frac{d\\phi(x)}{dx} \\right)$$\n其中 $D_s$ 是扩散系数，$[s](x)$ 是浓度，$z_s$ 是化合价，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是温度，$\\phi(x)$ 是电势。\n\nGHK 模型依赖于**恒定场假设**，该假设假定电场 $E = -d\\phi/dx$ 在厚度为 $L$ 的膜上是均匀的。因此，$E = V_m/L$。\n在该假设下，并处于稳态（$j_s(x)$ 为常数），Nernst-Planck 方程可以跨膜从 $x=0$（外部）到 $x=L$（内部）进行积分。通量 $j_s$ 的解为：\n$$j_s = P_s \\frac{z_s F V_m}{RT} \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT})}{\\exp(-\\frac{z_sFV_m}{RT}) - 1}$$\n其中 $P_s=D_s/L$ 是离子的膜渗透率。\n\n该离子物种携带的电流密度 $J_s$ 为 $J_s = z_s F j_s$。代入 $j_s$ 的表达式并重新整理，得到 GHK 电流方程：\n$$J_s(V_m) = P_s \\frac{(z_sF)^2 V_m}{RT} \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT})}{1 - \\exp(-\\frac{z_sFV_m}{RT})}$$\n符号约定是正电流对应正电荷的净外向流动。该方程通过代入适当的化合价 $z_s$ 对所有离子（$K^+$、$Na^+$、$Cl^-$）均有效。\n\n**2. $V_m \\to 0$ 时的数值稳定性**\nGHK 方程在 $V_m = 0$ 时具有 $0/0$ 的形式，需要一个极限表达式来保证数值稳定性。我们可以使用洛必达法则找到这个极限。让我们分析依赖于 $V_m$ 的项：\n$$ \\lim_{V_m \\to 0} \\frac{V_m \\left( [s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT}) \\right)}{1 - \\exp(-\\frac{z_sFV_m}{RT})} $$\n设分子为 $N(V_m)$，分母为 $D(V_m)$。\n关于 $V_m$ 的导数是：\n$$ N'(V_m) = \\left( [s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT}) \\right) + V_m \\left( [s]_{\\text{out}} \\frac{z_sF}{RT} \\exp(-\\frac{z_sFV_m}{RT}) \\right) $$\n$$ D'(V_m) = \\frac{z_sF}{RT} \\exp(-\\frac{z_sFV_m}{RT}) $$\n计算 $V_m \\to 0$ 时的极限：\n$$ \\lim_{V_m \\to 0} N'(V_m) = [s]_{\\text{in}} - [s]_{\\text{out}} $$\n$$ \\lim_{V_m \\to 0} D'(V_m) = \\frac{z_sF}{RT} $$\n将这些代入 $J_s(V_m)$ 的极限表达式中：\n$$ \\lim_{V_m \\to 0} J_s(V_m) = P_s \\frac{(z_sF)^2}{RT} \\left( \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}}{z_sF/RT} \\right) = P_s z_s F ([s]_{\\text{in}} - [s]_{\\text{out}}) $$\n当 $|V_m|$ 接近零时，将使用此线性近似进行计算。\n\n**3. 总电流和数值解**\n跨膜的总电流密度是各离子泄漏电流与生电泵电流之和：\n$$J_{\\text{tot}}(V_m) = J_K(V_m) + J_{Na}(V_m) + J_{Cl}(V_m) + I_{\\text{pump}}$$\n静息电位 $V_m^\\ast$ 是净电流为零时的膜电位：$J_{\\text{tot}}(V_m^\\ast) = 0$。这是一个超越方程，对于 $V_m^\\ast$ 没有闭式解析解。因此，必须使用数值求根算法来求解。Brent 方法是一个极好的选择，因为它鲁棒且在找到函数值变号的区间后保证收敛。$V_m^\\ast$ 的搜索区间可以合理地限制在所涉及离子的最极端 Nernst 电位之间，例如从 $-0.2\\,\\text{V}$ 到 $+0.2\\,\\text{V}$。\n\n**4. 参数和单位管理**\n所有计算都将在一致的国际单位制（SI）单位下进行：\n- 电位 ($V_m$)：伏特 (V)\n- 渗透率 ($P_s$)：米/秒 (m/s)\n- 浓度 ($[s]$)：摩尔/立方米 (mol/m³)\n- 电流密度 ($J_s, I_{\\text{pump}}$)：安培/平方米 (A/m²)\n- 常量 $F$、$R$、$T$ 使用其标准 SI 单位。\n\n给定的泵电流 $I_{\\text{pump}}$（单位为 $\\mu\\text{A}/\\text{cm}^2$）使用转换因子 $1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$ 转换为 A/m²。根据指示，mM 单位的浓度被视为 mol/m³。\n\n基于这些原理，将实现一个 Python 脚本来计算每个测试用例的 $V_m^\\ast$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the resting membrane potential Vm* for a single-compartment neuron model\n    by solving the Goldman-Hodgkin-Katz (GHK) current balance equation.\n    \"\"\"\n\n    # --- Define Constants and Fixed Parameters ---\n    F = 96485.0  # Faraday's constant (C/mol)\n    R = 8.314    # Universal gas constant (J/(mol*K))\n    T = 310.0    # Absolute temperature (K)\n\n    # Unit conversion factor for pump current from uA/cm^2 to A/m^2\n    PUMP_UNIT_CONVERSION = 1e-2\n\n    # Ion concentrations (mM, treated as mol/m^3 as per problem statement)\n    k_in, na_in, cl_in = 140.0, 15.0, 10.0\n    k_out, na_out, cl_out = 5.0, 145.0, 110.0\n\n    # Ion valences\n    z_k, z_na, z_cl = 1.0, 1.0, -1.0\n\n    # Test suite from the problem statement\n    # Each tuple is (I_pump [uA/cm^2], P_k [m/s], P_na [m/s], P_cl [m/s])\n    test_cases = [\n        (50.0, 1e-7, 5e-9, 4.5e-8),\n        (0.0, 1e-7, 5e-9, 4.5e-8),\n        (50.0, 1e-7, 5e-9, 0.0),\n        (50.0, 1e-8, 5e-9, 4.5e-8),\n    ]\n\n    # Small voltage tolerance to switch to the linear approximation of GHK equation\n    VM_TOLERANCE = 1e-12\n\n    # Pre-calculate a common term\n    RT = R * T\n\n    def ghk_current(Vm, P, z, c_in, c_out):\n        \"\"\"\n        Calculates the current density for a single ion species using the GHK equation.\n        Handles the singularity at Vm = 0 by using a linear approximation.\n\n        Args:\n            Vm (float): Membrane potential (V).\n            P (float): Permeability (m/s).\n            z (float): Ion valence.\n            c_in (float): Intracellular concentration (mol/m^3).\n            c_out (float): Extracellular concentration (mol/m^3).\n\n        Returns:\n            float: Current density (A/m^2).\n        \"\"\"\n        if abs(Vm)  VM_TOLERANCE:\n            # Linear approximation for Vm - 0 to avoid singularity\n            return P * z * F * (c_in - c_out)\n        else:\n            # Full GHK equation\n            # u is a dimensionless argument for the exponential function\n            u = z * F * Vm / RT\n            \n            # np.expm1(x) calculates exp(x) - 1 with high precision for small x.\n            # Our denominator is 1 - exp(-u), which is - (exp(-u) - 1) = -expm1(-u).\n            # This avoids catastrophic cancellation when u is near zero.\n            ghk_factor = P * (z * F)**2 * Vm / RT\n            concentration_term = (c_in - c_out * np.exp(-u))\n            denominator = -np.expm1(-u)\n            \n            return ghk_factor * concentration_term / denominator\n\n    results = []\n    for case in test_cases:\n        I_pump_val, P_k, P_na, P_cl = case\n        \n        # Convert pump current to A/m^2\n        I_pump = I_pump_val * PUMP_UNIT_CONVERSION\n\n        def total_current(Vm):\n            \"\"\"\n            Calculates the total membrane current density at a given potential Vm.\n            The root of this function is the resting potential Vm*.\n            \"\"\"\n            J_k = ghk_current(Vm, P_k, z_k, k_in, k_out)\n            J_na = ghk_current(Vm, P_na, z_na, na_in, na_out)\n            J_cl = ghk_current(Vm, P_cl, z_cl, cl_in, cl_out)\n            \n            return J_k + J_na + J_cl + I_pump\n\n        # Numerically solve for the root Vm* where total_current(Vm*) = 0.\n        # The search interval [-0.2, 0.2] V is physiologically plausible and\n        # safely brackets the expected resting potential.\n        try:\n            vm_star = brentq(total_current, -0.2, 0.2)\n            results.append(round(vm_star, 6))\n        except ValueError:\n            # This would happen if total_current(-0.2) and total_current(0.2)\n            # have the same sign, meaning no root was found in the interval.\n            results.append(np.nan)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}