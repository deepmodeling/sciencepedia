{
    "hands_on_practices": [
        {
            "introduction": "虽然能斯特方程（Nernst equation）为单个离子提供了其反转电位，但现实中许多离子通道对多种离子都具有通透性。本练习将引导你使用高盛-霍奇金-卡茨（Goldman-Hodgkin-Katz, GHK）方程，这是计算非选择性通道反转电位的关键工具。掌握这一计算方法，对于理解不同离子的集体运动如何共同决定一个通道的平衡点至关重要。",
            "id": "3996860",
            "problem": "在一个计算神经元模型中，一块膜片包含单一群体的非选择性阳离子通道，这些通道可以传导钠离子（$\\text{Na}^{+}$）和钾离子（$\\text{K}^{+}$）。这些通道遵循离子运动的独立性原则以及作为 Goldman-Hodgkin-Katz (GHK) 框架基础的恒定场近似。假设为理想溶液，因此活度等于浓度。没有其他可渗透的离子。膜电位定义为细胞内电势减去细胞外电势，$V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。细胞内和细胞外的浓度为：\n- $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$，$[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$，\n- $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$，$[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$。\n绝对温度为 $T = 308\\,\\mathrm{K}$，通用气体常数为 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，法拉第常数为 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。该通道对钠和钾的渗透性相等：$P_{\\text{Na}} = P_{\\text{K}}$。\n\n从恒定场近似下导出 Goldman-Hodgkin-Katz 离子通量描述的电扩散描述出发，推导非选择性阳离子通道的反转电位 $V_{\\text{rev}}$，该电位是$\\text{Na}^{+}$和$\\text{K}^{+}$携带的净电流为零时的膜电位。然后根据给定的浓度和参数，计算 $V_{\\text{rev}}$ 的数值。\n\n将最终数值答案四舍五入到四位有效数字，并以毫伏（mV）表示。为 $V_{\\text{rev}}$ 提供一个单一的数值。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **任务：** 推导非选择性阳离子通道的反转电位 $V_{\\text{rev}}$ 并计算其数值。\n- **物理系统：** 一块包含单一群体的非选择性阳离子通道的膜片，该通道对$\\text{Na}^{+}$和$\\text{K}^{+}$具有渗透性。\n- **假设：** 离子运动的独立性原则，恒定场近似（GHK框架），理想溶液（活度=浓度）。\n- **定义：** 膜电位 $V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。\n- **离子浓度：**\n    - $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n    - $[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n    - $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n    - $[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- **物理常数：**\n    - 绝对温度 $T = 308\\,\\mathrm{K}$\n    - 通用气体常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n    - 法拉第常数 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- **通道属性：** 对钠离子和钾离子的渗透性相等，$P_{\\text{Na}} = P_{\\text{K}}$。\n- **输出要求：**\n    - 将最终数值答案四舍五入到四位有效数字。\n    - 以毫伏（$\\mathrm{mV}$）为单位表示答案。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于已确立的生物物理学原理，特别是 Nernst-Planck 电扩散理论及其在恒定场假设下的简化，这导出了 Goldman-Hodgkin-Katz (GHK) 方程。这是计算神经科学和细胞生理学中一个标准和基础的模型。所提供的离子浓度对于神经元来说在生理上是合理的。\n- **适定性：** 问题陈述清晰，并提供了所有必需的参数（$T$, $R$, $F$）、边界条件（浓度）以及系统属性（$P_{\\text{Na}} = P_{\\text{K}}$），以推导和计算反转电位 $V_{\\text{rev}}$ 的唯一值。\n- **客观性：** 该问题以精确、定量和无偏见的语言表述，不含任何主观性。\n- **完整性和一致性：** 数据和约束条件是自洽且一致的。没有缺少必要的参数或矛盾的陈述。\n\n### 步骤 3：结论与行动\n该问题具有科学合理性、适定性、客观性和完整性。因此，它被判定为**有效**。现在将进行求解过程。\n\n反转电位 $V_{\\text{rev}}$ 是指跨膜总净离子电流为零时的膜电位 $V_m$。该通道仅对钠离子（$\\text{Na}^{+}$）和钾离子（$\\text{K}^{+}$）具有渗透性。因此，总电流 $I_{\\text{total}}$ 是钠电流 $I_{\\text{Na}}$ 和钾电流 $I_{\\text{K}}$ 的总和。反转电位的条件是：\n$$I_{\\text{total}} = I_{\\text{Na}} + I_{\\text{K}} = 0$$\n\n问题要求从GHK离子通量描述出发。对于价为 $z_S$ 的一般离子种类 $S$，GHK 电流方程由下式给出：\n$$I_S = P_S z_S^2 \\frac{F^2 V_m}{RT} \\frac{[S]_{\\text{in}} - [S]_{\\text{out}}\\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}$$\n其中 $P_S$ 是膜对离子 $S$ 的渗透性，$[S]_{\\text{in}}$ 和 $[S]_{\\text{out}}$ 分别是细胞内和细胞外浓度，$V_m$ 是膜电位，$F$ 是法拉第常数，$R$ 是通用气体常数，$T$ 是绝对温度。\n\n对于钠离子（$\\text{Na}^{+}$）和钾离子（$\\text{K}^{+}$），它们都是一价阳离子，其化合价为 $z_{\\text{Na}} = +1$ 和 $z_{\\text{K}} = +1$。相应的电流为：\n$$I_{\\text{Na}} = P_{\\text{Na}} \\frac{F^2 V_m}{RT} \\frac{[\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n$$I_{\\text{K}} = P_{\\text{K}} \\frac{F^2 V_m}{RT} \\frac{[\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n\n在反转电位（$V_m = V_{\\text{rev}}$）时，这些电流的总和为零：\n$$I_{\\text{Na}} + I_{\\text{K}} = 0$$\n$$P_{\\text{Na}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} + P_{\\text{K}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} = 0$$\n\n假设 $V_{\\text{rev}} \\neq 0$，公共前因子 $\\frac{F^2 V_{\\text{rev}}}{RT} \\frac{1}{1 - \\exp(-F V_{\\text{rev}}/RT)}$ 非零，可以约去。剩下：\n$$P_{\\text{Na}}\\left([\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) + P_{\\text{K}}\\left([\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) = 0$$\n\n我们现在求解 $V_{\\text{rev}}$。首先，将包含和不包含指数因子的项分组：\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}} = P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\n在右侧提出指数项：\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}} = \\left(P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}\\right) \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\n分离指数项：\n$$\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) = \\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}$$\n对两边取自然对数：\n$$-\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}\\right)$$\n使用属性 $\\ln(1/x) = -\\ln(x)$，我们可以反转对数的参数并去掉负号：\n$$\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}\\right)$$\n最后，求解 $V_{\\text{rev}}$ 得到这两种离子的 Goldman-Hodgkin-Katz 电压方程：\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}\\right)$$\n\n问题陈述该通道对钠和钾具有相等的渗透性：$P_{\\text{Na}} = P_{\\text{K}}$。我们用 $P$ 表示这个共同的渗透性。$V_{\\text{rev}}$ 的表达式简化为：\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P[\\text{Na}^{+}]_{\\text{out}} + P[\\text{K}^{+}]_{\\text{out}}}{P[\\text{Na}^{+}]_{\\text{in}} + P[\\text{K}^{+}]_{\\text{in}}}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[\\text{Na}^{+}]_{\\text{out}} + [\\text{K}^{+}]_{\\text{out}}}{[\\text{Na}^{+}]_{\\text{in}} + [\\text{K}^{+}]_{\\text{in}}}\\right)$$\n\n现在，我们代入给定的数值：\n- $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n- $[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n- $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n- $[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- $T = 308\\,\\mathrm{K}$\n- $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n\n细胞外浓度之和为 $[\\text{Na}^{+}]_{\\text{out}} + [\\text{K}^{+}]_{\\text{out}} = 160 + 3 = 163\\,\\mathrm{mM}$。\n细胞内浓度之和为 $[\\text{Na}^{+}]_{\\text{in}} + [\\text{K}^{+}]_{\\text{in}} = 8 + 100 = 108\\,\\mathrm{mM}$。\n\n$$V_{\\text{rev}} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(308\\,\\mathrm{K})}{96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\ln\\left(\\frac{163}{108}\\right)$$\n项 $\\frac{RT}{F}$ 的单位是 $\\mathrm{J}/\\mathrm{C}$，即伏特（$\\mathrm{V}$）。\n$$\\frac{RT}{F} \\approx \\frac{2560.712}{96485} \\approx 0.026540\\,\\mathrm{V}$$\n对数的参数是：\n$$\\frac{163}{108} \\approx 1.509259$$\n因此，\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) \\ln(1.509259)$$\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) (0.411600)$$\n$$V_{\\text{rev}} \\approx 0.01092518\\,\\mathrm{V}$$\n问题要求答案以毫伏（$\\mathrm{mV}$）为单位：\n$$V_{\\text{rev}} \\approx 10.92518\\,\\mathrm{mV}$$\n四舍五入到四位有效数字，我们得到：\n$$V_{\\text{rev}} = 10.93\\,\\mathrm{mV}$$",
            "answer": "$$\n\\boxed{10.93}\n$$"
        },
        {
            "introduction": "现在，让我们从确定性的电流视角转向其随机性的本质。宏观的膜电流实际上是大量微观、概率性事件的总和：即单个离子通道的开放与关闭。本练习将演示如何从单个通道的属性推导出总电流的方差，从而在微观通道行为与宏观电噪声之间建立起一个基础性的联系。",
            "id": "3996923",
            "problem": "一个神经元的胞体膜片被电压钳制在固定电位，从而使得离子驱动力保持恒定。该膜片包含$N$个相同且独立的离子通道，每个通道被建模为一个具有“关闭”和“开放”两种状态的双态马尔可夫过程。在稳态下，任何给定通道处于开放状态的概率为$p$，并且状态转换相对于采集带宽而言足够快，因此每个采样瞬间的状态可以被视为一次伯努利试验。当一个通道开放时，它通过一个大小为$i$的单通道电流；当关闭时，它通过的电流为零。假设离子充足，因此单通道电流$i$是确定性的，不会因散粒噪声而波动，并假设除了所指定的独立性之外，通道之间没有其他相互作用或相关性。\n\n将总膜电流定义为 $I = i \\sum_{k=1}^{N} X_k$，其中 $X_k \\in \\{0,1\\}$ 是指示通道 $k$ 在采样瞬间处于开放状态的指示变量。仅使用独立伯努利随机变量的概率第一性原理和方差的性质，推导稳态下总电流 $I$ 的方差。将您的最终答案表示为关于$N$、$p$和$i$的单一闭式解析表达式。无需进行数值计算。仅提供最终表达式，不附带单位。",
            "solution": "该问题要求在特定的稳态条件下推导总膜电流$I$的方差。总电流由以下表达式给出：\n$$I = i \\sum_{k=1}^{N} X_k$$\n在此式中，$i$是确定性的单通道电流大小，$N$是相同通道的总数，$X_k$是一个随机变量，代表第$k$个通道在给定采样瞬间的状态。\n\n问题陈述每个通道的状态都可以被建模为一次伯努利试验。变量$X_k$是一个指示变量，当通道开放时$X_k=1$，当通道关闭时$X_k=0$。任何给定通道处于开放状态的概率为$p$。因此，对于每个通道$k$，$X_k$的概率分布为：\n$$P(X_k = 1) = p$$\n$$P(X_k = 0) = 1 - p$$\n这$N$个随机变量$X_1, X_2, \\dots, X_N$被规定为独立的，并且由于通道是相同的，它们也是同分布的。因此，它们是独立同分布(i.i.d.)的伯努利随机变量。\n\n我们旨在求出总电流的方差$\\text{Var}(I)$。我们首先将方差的性质应用于给定的$I$表达式。方差的一个基本性质指出，对于任意常数$c$和随机变量$Y$，有$\\text{Var}(cY) = c^2 \\text{Var}(Y)$。在我们的例子中，单通道电流$i$是一个常数。因此，我们可以写出：\n$$\\text{Var}(I) = \\text{Var}\\left(i \\sum_{k=1}^{N} X_k\\right) = i^2 \\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right)$$\n\n问题指明了通道是独立的。对于独立随机变量的和，其和的方差等于它们各自方差的和。这使我们可以写出：\n$$\\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right) = \\sum_{k=1}^{N} \\text{Var}(X_k)$$\n\n此外，由于所有通道都是相同的，随机变量$X_k$是同分布的。这意味着它们的方差都相等。我们将单个通道状态变量的方差记为$\\text{Var}(X)$。\n$$\\text{Var}(X_1) = \\text{Var}(X_2) = \\dots = \\text{Var}(X_N) = \\text{Var}(X)$$\n因此，方差的和简化为：\n$$\\sum_{k=1}^{N} \\text{Var}(X_k) = N \\cdot \\text{Var}(X)$$\n\n将这些结果代回到我们关于$\\text{Var}(I)$的表达式中，我们得到：\n$$\\text{Var}(I) = i^2 N \\text{Var}(X)$$\n\n剩下的任务是计算成功概率为$p$的单个伯努利随机变量$X$的方差。方差由公式$\\text{Var}(X) = E[X^2] - (E[X])^2$定义。我们必须首先计算$X$的期望值（均值）。\n$$E[X] = (1) \\cdot P(X=1) + (0) \\cdot P(X=0) = (1)(p) + (0)(1-p) = p$$\n\n接下来，我们计算$X^2$的期望值。由于$X$只能取值0或1，变量$X^2$与$X$是相同的（因为$0^2=0$且$1^2=1$）。因此，它们的期望值也相同。\n$$E[X^2] = E[X] = p$$\n\n现在我们可以计算$X$的方差：\n$$\\text{Var}(X) = E[X^2] - (E[X])^2 = p - p^2 = p(1-p)$$\n\n这是伯努利随机变量方差的公认公式。\n\n最后，我们将这个$\\text{Var}(X)$的表达式代入我们关于总电流方差$\\text{Var}(I)$的方程中：\n$$\\text{Var}(I) = i^2 N p(1-p)$$\n这就是用给定参数$N$、$p$和$i$表示的总电流方差的闭式解析表达式。",
            "answer": "$$\\boxed{N i^2 p (1-p)}$$"
        },
        {
            "introduction": "在前述概念的基础上，我们将构建一个动态模型。在神经元中，离子浓度并非一成不变；它们会随着电流的流动而发生变化，这反过来又会改变反转电位和驱动力。这项综合性练习要求你编写一个仿真程序来模拟这一动态反馈循环，整合被动通道通量和主动泵转运，从而深入理解神经元离子稳态的基本原理。",
            "id": "3996817",
            "problem": "设计并实现一个完整的程序，模拟在一个单一的等电位神经元隔室中，恒定的膜离子电流如何驱动细胞内离子浓度的变化，并因此在持续的去极化过程中动态地改变反转电位。请从以下基本原理出发：每种离子种类的质量守恒、关联离子电流与摩尔通量的法拉第定律，以及关联浓度梯度与反转电位的能斯特方程。考虑三种离子：钠离子（$\\mathrm{Na}^+$）、钾离子（$\\mathrm{K}^+$）和氯离子（$\\mathrm{Cl}^-$）。使用一个半径为 $r$ 的球形隔室，其膜面积为 $A = 4\\pi r^2$，细胞内体积为 $V = \\frac{4}{3}\\pi r^3$。假设细胞外浓度恒定，且膜电位被钳制（电压钳），从而在固定时长内产生持续的去极化。\n\n将使用的基本定义和假设如下：\n- 法拉第定律：对于化合价为 $z_X$ 的离子种类 $X$，其外向电流密度 $i_X$（单位 $\\mathrm{A/m^2}$）与单位面积外向摩尔通量 $J_X$（单位 $\\mathrm{mol/(m^2\\,s)}$）的关系为 $i_X = z_X F J_X$，其中 $F$ 是法拉第常数（单位 $\\mathrm{C/mol}$）。细胞内浓度 $[\\mathrm{X}]_i$（单位 $\\mathrm{mol/m^3}$）根据 $\\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X = -\\frac{A}{V z_X F} i_X$ 变化。\n- 每种离子的欧姆电流：$i_X = g_X (V_m - E_X)$，其中 $g_X$ 是电导密度（单位 $\\mathrm{S/m^2}$），$V_m$ 是膜电位（单位 $\\mathrm{V}$），$E_X$ 是反转电位（单位 $\\mathrm{V}$）。\n- 能斯特方程：$E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right)$，其中 $R$ 是气体常数（单位 $\\mathrm{J/(mol\\,K)}$），$T$ 是绝对温度（单位 $\\mathrm{K}$），$[\\mathrm{X}]_o$ 是细胞外浓度（单位 $\\mathrm{mol/m^3}$）。\n- 钠钾三磷酸腺苷（ATPase）泵的电流密度 $i_{\\mathrm{pump}}$（单位 $\\mathrm{A/m^2}$）是外向的，并对细胞内钠离子和细胞外钾离子浓度呈S型依赖。其化学计量为每个循环泵出 $3$ 个 $\\mathrm{Na}^+$ 离子并泵入 $2$ 个 $\\mathrm{K}^+$ 离子，产生一个等效于每个循环 $+1$ 元电荷的净外向正电流。将其建模为 $i_{\\mathrm{pump}} = I_{\\max} s_{\\mathrm{Na}} s_{\\mathrm{K}}$，其中 $s_{\\mathrm{Na}} = \\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}$ 且 $s_{\\mathrm{K}} = \\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}$，此处 $I_{\\max}$ 是最大泵电流密度，$K_{\\mathrm{Na}}$ 和 $K_{\\mathrm{K}}$ 是半饱和常数（单位 $\\mathrm{mol/m^3}$），$n,m$ 是Hill系数（无量纲）。该泵对钠离子外向电流密度的贡献为 $+3 i_{\\mathrm{pump}}$，对钾离子外向电流密度的贡献为 $-2 i_{\\mathrm{pump}}$。\n\n程序必须在指定的恒定去极化膜电位 $V_m$ 下，在一个时间区间内对 $[\\mathrm{Na}]_i(t)$、$[\\mathrm{K}]_i(t)$ 和 $[\\mathrm{Cl}]_i(t)$ 的耦合常微分方程（Ordinary Differential Equation, ODE）进行积分，并计算反转电位 $E_{\\mathrm{Na}}(t)$、$E_{\\mathrm{K}}(t)$ 和 $E_{\\mathrm{Cl}}(t)$ 相对于其初始值的变化。使用绝对温度 $T = 310\\,\\mathrm{K}$。使用细胞外浓度 $[\\mathrm{Na}]_o = 145\\,\\mathrm{mM}$、$[\\mathrm{K}]_o = 4\\,\\mathrm{mM}$ 和 $[\\mathrm{Cl}]_o = 110\\,\\mathrm{mM}$，以及初始细胞内浓度 $[\\mathrm{Na}]_i(0) = 15\\,\\mathrm{mM}$、$[\\mathrm{K}]_i(0) = 140\\,\\mathrm{mM}$、$[\\mathrm{Cl}]_i(0) = 5\\,\\mathrm{mM}$。内部将 $1\\,\\mathrm{mM}$ 视为 $1\\,\\mathrm{mol/m^3}$。使用电导密度 $g_{\\mathrm{Na}} = 0.001\\,\\mathrm{S/m^2}$、$g_{\\mathrm{K}} = 0.002\\,\\mathrm{S/m^2}$、$g_{\\mathrm{Cl}} = 0.001\\,\\mathrm{S/m^2}$。使用泵参数 $I_{\\max} = 0.001\\,\\mathrm{A/m^2}$、$K_{\\mathrm{Na}} = 10\\,\\mathrm{mol/m^3}$、$K_{\\mathrm{K}} = 1.5\\,\\mathrm{mol/m^3}$、$n = 1.5$ 和 $m = 1.5$。设置化合价 $z_{\\mathrm{Na}} = +1$、$z_{\\mathrm{K}} = +1$ 和 $z_{\\mathrm{Cl}} = -1$。\n\n使用任何适用于平滑动态的稳定方法对常微分方程进行数值积分。在计算 $E_X$ 时，通过设置一个最小值下限（例如，将对数内的 $[\\mathrm{X}]_i$ 替换为 $\\max([\\mathrm{X}]_i, \\varepsilon)$，其中 $\\varepsilon$ 为某个小的正数）来确保浓度的正性，同时在常微分方程中保持正确的质量平衡符号。\n\n测试套件包含五个参数集，涵盖了典型、边缘和边界条件。对于每个测试用例，进行模拟以计算最终的反转电位，并输出所有离子的电位变化量（最终值减去初始值），以毫伏（$\\mathrm{mV}$）为单位的浮点数表示。每个案例的持续膜电位和其他参数如下：\n\n- 案例 1：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -20\\times 10^{-3}\\,\\mathrm{V}$，时长 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n- 案例 2：$r = 5\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -10\\times 10^{-3}\\,\\mathrm{V}$，时长 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵关闭。\n- 案例 3：$r = 25\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -20\\times 10^{-3}\\,\\mathrm{V}$，时长 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n- 案例 4：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = 0\\,\\mathrm{V}$，时长 $T_{\\mathrm{end}} = 60\\,\\mathrm{s}$，泵开启。\n- 案例 5：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -65\\times 10^{-3}\\,\\mathrm{V}$，时长 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n\n你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3}]$）。输出必须按顺序为每个测试用例依次列出反转电位变化量 $\\Delta E_{\\mathrm{K}}$（单位 $\\mathrm{mV}$）、$\\Delta E_{\\mathrm{Na}}$（单位 $\\mathrm{mV}$）和 $\\Delta E_{\\mathrm{Cl}}$（单位 $\\mathrm{mV}$），并将所有测试用例的结果平铺到一个列表中。所有值都必须以 $\\mathrm{mV}$ 为单位的浮点数表示。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题阐述清晰，并为标准的计算神经科学模拟提供了完整且一致的参数和方程组。该模型基于基本的生物物理原理，即离子种类的守恒、用于平衡电位的能斯特方程，以及离子通道和泵电流的既定公式。\n\n解决方案要求构建并数值积分一个耦合常微分方程（ODE）系统，该系统描述细胞内离子浓度随时间的演变。根据这些浓度，可以计算出相应的能斯特反转电位。\n\n模型的核心是每种离子 $X$ 的质量守恒原理。在体积为 $V$、表面积为 $A$ 的隔室中，细胞内浓度 $[\\mathrm{X}]_i$ 的变化率由穿过膜的单位面积净摩尔通量 $J_X$ 决定：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X $$\n摩尔通量 $J_X$ 通过法拉第定律与总离子电流密度 $i_{X, \\text{total}}$（单位 $\\mathrm{A/m^2}$）相关，即 $i_{X, \\text{total}} = z_X F J_X$，其中 $z_X$ 是离子的化合价，$F$ 是法拉第常数。代入 $J_X$ 可得浓度动态的基本方程：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V z_X F} i_{X, \\text{total}} $$\n对于指定的半径为 $r$ 的球形隔室，表面积为 $A=4\\pi r^2$，体积为 $V = \\frac{4}{3}\\pi r^3$。表面积与体积之比简化为 $\\frac{A}{V} = \\frac{3}{r}$。因此，常微分方程变为：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{3}{r z_X F} i_{X, \\text{total}} $$\n每种离子的总电流密度 $i_{X, \\text{total}}$ 是其被动（欧姆）漏电流和任何主动转运电流（即来自泵的电流）之和。被动电流由 $i_{X, \\text{leak}} = g_X (V_m - E_X)$ 给出，其中 $g_X$ 是膜电导密度，$V_m$ 是恒定（钳制）的膜电位，$E_X$ 是能斯特反转电位。能斯特电位本身依赖于细胞内和细胞外浓度 $[\\mathrm{X}]_i$ 和 $[\\mathrm{X}]_o$：\n$$ E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right) $$\n其中 $R$ 是气体常数，$T$ 是绝对温度。$E_X$ 对 $[\\mathrm{X}]_i$ 的这种依赖性使得常微分方程系统成为非线性的耦合系统。\n\n钠钾ATP酶泵提供了一种主动转运机制。它被建模为产生一个净外向电流密度 $i_{\\mathrm{pump}}$，该电流密度依赖于 $[\\mathrm{Na}]_i$ 和 $[\\mathrm{K}]_o$：\n$$ i_{\\mathrm{pump}} = I_{\\max} \\left(\\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}\\right) \\left(\\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}\\right) $$\n由于其 $3:2$ 的化学计量（$3$ 个 $\\mathrm{Na}^+$ 泵出，$2$ 个 $\\mathrm{K}^+$ 泵入），该泵对总钠电流贡献 $3 i_{\\mathrm{pump}}$，对总钾电流贡献 $-2 i_{\\mathrm{pump}}$（其中正号表示外向电流）。\n\n有了这些组成部分，我们可以写出状态向量 $y(t) = \\left( [\\mathrm{Na}]_i(t), [\\mathrm{K}]_i(t), [\\mathrm{Cl}]_i(t) \\right)$ 的显式常微分方程系统：\n\n1.  **钠离子 ($\\mathrm{Na}^+$):** $z_{\\mathrm{Na}} = +1$。总外向电流密度为 $i_{\\mathrm{Na, total}} = g_{\\mathrm{Na}}(V_m - E_{\\mathrm{Na}}) + 3 i_{\\mathrm{pump}}$。\n    $$ \\frac{d[\\mathrm{Na}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{Na}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i}\\right) + 3 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n2.  **钾离子 ($\\mathrm{K}^+$):** $z_{\\mathrm{K}} = +1$。总外向电流密度为 $i_{\\mathrm{K, total}} = g_{\\mathrm{K}}(V_m - E_{\\mathrm{K}}) - 2 i_{\\mathrm{pump}}$。\n    $$ \\frac{d[\\mathrm{K}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{K}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{K}]_o}{[\\mathrm{K}]_i}\\right) - 2 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n3.  **氯离子 ($\\mathrm{Cl}^-$):** $z_{\\mathrm{Cl}} = -1$。没有泵的成分，所以 $i_{\\mathrm{Cl, total}} = g_{\\mathrm{Cl}}(V_m - E_{\\mathrm{Cl}})$。\n    $$ \\frac{d[\\mathrm{Cl}]_i}{dt} = -\\frac{3}{r (-1) F} \\left( g_{\\mathrm{Cl}}\\left(V_m - \\frac{RT}{-F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i}\\right) \\right) = \\frac{3 g_{\\mathrm{Cl}}}{r F} \\left( V_m + \\frac{RT}{F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i} \\right) $$\n当泵激活时，$\\text{flag}_{\\text{pump}}$ 为 $1$，否则为 $0$。\n\n为了实现该解决方案，设计了一个Python程序。该程序定义了一个封装常微分方程系统的函数，然后将其传递给 `scipy.integrate` 库中的数值求解器，特别是 `solve_ivp`。该函数以当前时间 $t$ 和状态向量 $y$ 作为输入，并返回导数向量 $dy/dt$。为了数值稳定性，任何对数项内的浓度 $[\\mathrm{X}]_i$ 都被设置为一个小的正值下限 $\\varepsilon$，例如 $\\ln([\\mathrm{X}]_o / \\max([\\mathrm{X}]_i, \\varepsilon))$。\n\n总体的计算流程如下：\n1.  定义所有物理常数（$F$、$R$、$T$）、模型参数（$g_X$、$[\\mathrm{X}]_o$、泵参数）和初始条件（$[\\mathrm{X}]_i(0)$）。\n2.  使用初始浓度计算所有离子的初始反转电位 $E_{X, \\text{initial}}$。\n3.  遍历问题陈述中提供的每个测试用例。\n4.  对于每个用例，设置特定参数（$r$、$V_m$、$T_{\\mathrm{end}}$、泵状态）。\n5.  调用 `scipy.integrate.solve_ivp`，从初始浓度向量 $y(0) = ([\\mathrm{Na}]_i(0), [\\mathrm{K}]_i(0), [\\mathrm{Cl}]_i(0))$ 开始，对常微分方程系统从 $t=0$ 积分到 $t=T_{\\mathrm{end}}$。\n6.  从求解器的输出中提取最终浓度向量 $y(T_{\\mathrm{end}})$。\n7.  根据最终浓度计算最终反转电位 $E_{X, \\text{final}}$。\n8.  计算每种离子的反转电位变化量 $\\Delta E_X = E_{X, \\text{final}} - E_{X, \\text{initial}}$。\n9.  将变化量 $\\Delta E_X$ 从伏特转换为毫伏（乘以 $1000$）。\n10. 将所有测试用例的结果，按照指定的顺序（$\\Delta E_{\\mathrm{K}}$、$\\Delta E_{\\mathrm{Na}}$、$\\Delta E_{\\mathrm{Cl}}$），汇总到一个列表中，并格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates ionic concentration and reversal potential dynamics in a single\n    neuronal compartment under voltage clamp.\n    \"\"\"\n    # --- Constants and Global Parameters ---\n    F = 96485.33212  # Faraday's constant in C/mol\n    R = 8.314462618  # Gas constant in J/(mol·K)\n    T_abs = 310.0      # Absolute temperature in K\n    RT_over_F = (R * T_abs) / F  # Thermal voltage in Volts\n\n    # Ion valences\n    z_Na, z_K, z_Cl = 1.0, 1.0, -1.0\n\n    # Membrane conductance densities (S/m^2)\n    g_Na, g_K, g_Cl = 0.001, 0.002, 0.001\n\n    # Extracellular concentrations (mol/m^3, treating mM as mol/m^3)\n    Na_o, K_o, Cl_o = 145.0, 4.0, 110.0\n\n    # Initial intracellular concentrations (mol/m^3)\n    Na_i0, K_i0, Cl_i0 = 15.0, 140.0, 5.0\n    y0 = np.array([Na_i0, K_i0, Cl_i0])\n\n    # Pump parameters\n    I_max = 0.001  # A/m^2\n    K_Na = 10.0    # mol/m^3\n    K_K = 1.5      # mol/m^3\n    n, m = 1.5, 1.5\n    s_K_term = (K_o**m) / (K_K**m + K_o**m) # Constant K-dependent pump term\n\n    # Small epsilon for numerical stability in logarithms\n    epsilon = 1e-9\n\n    # --- Test Cases ---\n    test_cases = [\n        {'r': 10e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 5e-6,  'Vm': -10e-3, 'T_end': 10.0, 'pump_on': False},\n        {'r': 25e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': 0.0,    'T_end': 60.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': -65e-3, 'T_end': 10.0, 'pump_on': True},\n    ]\n\n    all_results = []\n\n    def odes(t, y, r, Vm, pump_on):\n        \"\"\"\n        Defines the system of ordinary differential equations for ion concentrations.\n        y: state vector [Na_i, K_i, Cl_i]\n        \"\"\"\n        Na_i, K_i, Cl_i = y\n\n        # Apply floor to concentrations to prevent log(0) or division by zero\n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n\n        # Nernst potentials\n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n\n        # Pump current density\n        i_pump = 0.0\n        if pump_on:\n            s_Na_term = (Na_i_safe**n) / (K_Na**n + Na_i_safe**n)\n            i_pump = I_max * s_Na_term * s_K_term\n        \n        # Total outward current densities (A/m^2)\n        i_Na_total = g_Na * (Vm - E_Na) + 3.0 * i_pump\n        i_K_total = g_K * (Vm - E_K) - 2.0 * i_pump\n        i_Cl_total = g_Cl * (Vm - E_Cl)\n        \n        # Concentration derivatives (d[X]_i/dt = -(3 / (r * z_X * F)) * i_X_total)\n        dNa_i_dt = -(3.0 / (r * z_Na * F)) * i_Na_total\n        dK_i_dt = -(3.0 / (r * z_K * F)) * i_K_total\n        dCl_i_dt = -(3.0 / (r * z_Cl * F)) * i_Cl_total\n        \n        return [dNa_i_dt, dK_i_dt, dCl_i_dt]\n\n    def calculate_reversals(concentrations):\n        \"\"\"Calculates reversal potentials from a concentration vector.\"\"\"\n        Na_i, K_i, Cl_i = concentrations\n        \n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n        \n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n        return E_Na, E_K, E_Cl\n\n    # Calculate initial reversal potentials\n    E_Na_initial, E_K_initial, E_Cl_initial = calculate_reversals(y0)\n\n    for case in test_cases:\n        r, Vm, T_end, pump_on = case['r'], case['Vm'], case['T_end'], case['pump_on']\n        \n        # Solve the ODE system for the current case\n        sol = solve_ivp(\n            fun=odes,\n            t_span=[0, T_end],\n            y0=y0,\n            args=(r, Vm, pump_on),\n            method='RK45'\n        )\n        \n        # Get final concentrations\n        y_final = sol.y[:, -1]\n        \n        # Calculate final reversal potentials\n        E_Na_final, E_K_final, E_Cl_final = calculate_reversals(y_final)\n        \n        # Calculate change in reversal potentials and convert to mV\n        delta_E_Na_mV = (E_Na_final - E_Na_initial) * 1000.0\n        delta_E_K_mV = (E_K_final - E_K_initial) * 1000.0\n        delta_E_Cl_mV = (E_Cl_final - E_Cl_initial) * 1000.0\n        \n        # Append results in specified order: K, Na, Cl\n        all_results.extend([delta_E_K_mV, delta_E_Na_mV, delta_E_Cl_mV])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}