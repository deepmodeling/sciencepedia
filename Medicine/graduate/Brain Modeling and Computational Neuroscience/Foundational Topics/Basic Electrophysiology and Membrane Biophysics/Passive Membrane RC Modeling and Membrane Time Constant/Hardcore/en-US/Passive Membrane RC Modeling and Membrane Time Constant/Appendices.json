{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is about building the concept of the membrane time constant, $\\tau_{m}$, from the ground up. By starting with fundamental physical laws and the specific properties of the membrane material, you will derive this crucial parameter and uncover an essential insight: $\\tau_{m}$ is an intrinsic property of the membrane itself, independent of the neuron's size .",
            "id": "4008648",
            "problem": "A neuron’s isopotential membrane patch is modeled as a passive parallel resistor–capacitor network. Let the total membrane capacitance be $C_{m}$ and the total membrane resistance be $R_{m}$. The specific membrane capacitance (capacitance per unit area) is $c_{m}$ and the specific membrane resistance (resistance times area) is $r_{m}$. A brief current pulse is applied and then turned off at time $t=0$, after which the membrane potential $V(t)$ relaxes passively toward the leak reversal potential $E_{L}$.\n\nStarting only from charge conservation (Kirchhoff current balance), the constitutive relation of a capacitor, and Ohm’s law, derive the homogeneous relaxation dynamics for $V(t)$ and identify the membrane time constant $\\tau_{m}$ in terms of $c_{m}$, $r_{m}$, and the membrane area $A$. Use the definitions $C_{m}=c_{m}A$ and $R_{m}=r_{m}/A$ to simplify your expression, and show explicitly whether $\\tau_{m}$ depends on $A$.\n\nNumerically evaluate $\\tau_{m}$ for $c_{m} \\approx 1\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$ and $r_{m} \\approx 10\\,\\mathrm{k}\\Omega \\cdot \\mathrm{cm}^2$. Express your final answer in milliseconds, and round your answer to three significant figures. Briefly comment on the physiological plausibility of your computed value in the context of central neurons, but note that only the requested numerical value will be graded.",
            "solution": "The problem asks for the derivation of the membrane potential relaxation dynamics and the membrane time constant $\\tau_{m}$ for a passive isopotential neuron membrane patch, modeled as a parallel resistor-capacitor ($RC$) circuit. The derivation must start from fundamental principles. Subsequently, $\\tau_{m}$ must be evaluated numerically.\n\n**Step 1: Problem Validation**\n\nThe problem is subjected to a rigorous validation procedure before a solution is attempted.\n\n**1.1. Extracted Givens**\n-   **Model**: A passive parallel resistor-capacitor network representing an isopotential membrane patch.\n-   **Definitions and Variables**:\n    -   Total membrane capacitance: $C_{m}$\n    -   Total membrane resistance: $R_{m}$\n    -   Specific membrane capacitance (per unit area): $c_{m}$\n    -   Specific membrane resistance (resistance times area): $r_{m}$\n    -   Membrane area: $A$\n    -   Membrane potential as a function of time: $V(t)$\n    -   Leak reversal potential: $E_{L}$\n    -   Time: $t$\n-   **Relationships**: $C_{m} = c_{m}A$ and $R_{m} = r_{m}/A$.\n-   **Condition**: For time $t \\ge 0$, the system relaxes passively, meaning no external current is applied.\n-   **Numerical Values**: $c_{m} \\approx 1\\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$ and $r_{m} \\approx 10\\,\\mathrm{k}\\Omega \\cdot \\mathrm{cm}^{2}$.\n\n**1.2. Validation against Criteria**\n-   **Scientific Grounding**: The problem is fundamentally sound. The passive $RC$ circuit is the standard, first-order model for a neuron's membrane below the action potential threshold (the Hodgkin-Huxley model simplifies to this form in the subthreshold, steady-state limit). The principles to be used—Kirchhoff's current law, the capacitor's constitutive relation, and Ohm's law—are cornerstones of physics. The provided numerical values for $c_{m}$ and $r_{m}$ are canonical values used in computational neuroscience literature.\n-   **Well-Posedness**: The problem is well-posed. It requests the derivation of the governing homogeneous ordinary differential equation and its characteristic time constant. This leads to a unique and stable solution. All necessary parameters and relationships are provided.\n-   **Objectivity**: The problem is stated in precise, objective, and standard scientific terms. It is free of ambiguity, subjectivity, or opinion.\n\n**1.3. Verdict**\nThe problem is valid as it is scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or other flaws. We may proceed with the solution.\n\n**Step 2: Derivation of the Membrane Equation**\n\nWe begin by applying the principle of charge conservation, also known as Kirchhoff's Current Law (KCL), to the membrane patch. For $t \\ge 0$, no external current $I_{ext}$ is injected ($I_{ext} = 0$). The total current flowing across the membrane is the sum of the current through the resistive leak channels, $I_{R}$, and the current that charges the membrane capacitance, $I_{C}$. KCL dictates that the sum of currents flowing out of the node (the interior of the cell) is zero.\n$$\nI_{R}(t) + I_{C}(t) = 0\n$$\nWe now define each current component based on fundamental laws.\n\nThe resistive current, $I_{R}$, represents the flow of ions through leak channels. It is described by Ohm's Law. The current is proportional to the potential difference across the resistor, which is the difference between the membrane potential $V(t)$ and the leak reversal potential $E_{L}$. It is inversely proportional to the total membrane resistance $R_{m}$.\n$$\nI_{R}(t) = \\frac{V(t) - E_{L}}{R_{m}}\n$$\nThe capacitive current, $I_{C}$, represents the rate of change of charge stored on the membrane. The constitutive relation for a capacitor is $Q = C_{m}V$, where $Q$ is the charge. The current is the time derivative of the charge, $I_{C}(t) = \\frac{dQ}{dt}$. Thus, for the membrane potential $V(t)$, the capacitive current is:\n$$\nI_{C}(t) = C_{m} \\frac{dV(t)}{dt}\n$$\nSubstituting the expressions for $I_{R}(t)$ and $I_{C}(t)$ into the KCL equation yields the differential equation for the membrane potential:\n$$\n\\frac{V(t) - E_{L}}{R_{m}} + C_{m} \\frac{dV(t)}{dt} = 0\n$$\nThis equation describes the passive relaxation of the membrane potential.\n\n**Step 3: Identification of the Membrane Time Constant $\\tau_{m}$**\n\nTo identify the time constant, we rearrange the differential equation into a standard form.\n$$\nC_{m} \\frac{dV(t)}{dt} = - \\frac{V(t) - E_{L}}{R_{m}}\n$$\n$$\n\\frac{dV(t)}{dt} = - \\frac{V(t) - E_{L}}{R_{m} C_{m}}\n$$\nThis is a first-order linear ordinary differential equation. The solution for $V(t)$ is an exponential decay towards the steady-state value $E_{L}$. To see this clearly, let's define a new variable $v(t) = V(t) - E_{L}$. Then $\\frac{dv}{dt} = \\frac{dV}{dt}$. The equation becomes:\n$$\n\\frac{dv(t)}{dt} = - \\frac{v(t)}{R_{m} C_{m}}\n$$\nThis is the standard form of an exponential decay equation, $\\frac{dy}{dt} = -\\frac{y}{\\tau}$, where $\\tau$ is the time constant. By direct comparison, we identify the membrane time constant, $\\tau_{m}$, as the product of the total membrane resistance and capacitance.\n$$\n\\tau_{m} = R_{m} C_{m}\n$$\nThe solution for $V(t)$ is $V(t) = E_{L} + (V(0) - E_{L}) \\exp(-t/\\tau_{m})$, where $V(0)$ is the membrane potential at $t=0$. The problem asks for the homogeneous relaxation dynamics, which are characterized by this exponential decay with time constant $\\tau_{m}$.\n\n**Step 4: Dependence of $\\tau_{m}$ on Membrane Area $A$**\n\nThe problem provides the definitions of total resistance and capacitance in terms of the specific (area-independent) properties $r_{m}$ and $c_{m}$, and the membrane area $A$:\n$$\nR_{m} = \\frac{r_{m}}{A}\n$$\n$$\nC_{m} = c_{m} A\n$$\nWe substitute these definitions into our expression for $\\tau_{m}$:\n$$\n\\tau_{m} = \\left(\\frac{r_{m}}{A}\\right) (c_{m} A)\n$$\nThe area term $A$ in the numerator and denominator cancels out:\n$$\n\\tau_{m} = r_{m} c_{m}\n$$\nThis is a crucial result: the membrane time constant $\\tau_{m}$ is an intrinsic property of the membrane material itself, determined by the specific resistance and specific capacitance, and is independent of the size or area $A$ of the membrane patch.\n\n**Step 5: Numerical Evaluation of $\\tau_{m}$**\n\nWe are given the following values:\n-   $c_{m} = 1\\,\\mu\\mathrm{F}/\\mathrm{cm}^{2} = 1 \\times 10^{-6}\\,\\mathrm{F} \\cdot \\mathrm{cm}^{-2}$\n-   $r_{m} = 10\\,\\mathrm{k}\\Omega \\cdot \\mathrm{cm}^{2} = 10 \\times 10^{3}\\,\\Omega \\cdot \\mathrm{cm}^{2} = 1 \\times 10^{4}\\,\\Omega \\cdot \\mathrm{cm}^{2}$\n\nWe compute $\\tau_{m}$ using the derived formula:\n$$\n\\tau_{m} = r_{m} c_{m} = (1 \\times 10^{4}\\,\\Omega \\cdot \\mathrm{cm}^{2}) \\times (1 \\times 10^{-6}\\,\\mathrm{F} \\cdot \\mathrm{cm}^{-2})\n$$\n$$\n\\tau_{m} = 1 \\times 10^{-2}\\,\\Omega \\cdot \\mathrm{F}\n$$\nThe unit of the product of resistance (Ohm, $\\Omega$) and capacitance (Farad, F) is seconds (s). This is because $1\\,\\Omega = 1\\,\\mathrm{V}/\\mathrm{A}$ and $1\\,\\mathrm{F} = 1\\,\\mathrm{C}/\\mathrm{V}$, so $1\\,\\Omega \\cdot \\mathrm{F} = (1\\,\\mathrm{V}/\\mathrm{A}) \\cdot (1\\,\\mathrm{C}/\\mathrm{V}) = 1\\,\\mathrm{C}/\\mathrm{A}$. Since current is charge per time ($A = C/s$), we have $1\\,\\mathrm{C}/\\mathrm{A} = 1\\,\\mathrm{C}/(\\mathrm{C}/\\mathrm{s}) = 1\\,\\mathrm{s}$.\nTherefore:\n$$\n\\tau_{m} = 1 \\times 10^{-2}\\,\\text{s}\n$$\nThe problem requires the answer in milliseconds (ms). Since $1\\,\\text{s} = 1000\\,\\text{ms}$:\n$$\n\\tau_{m} = (1 \\times 10^{-2}) \\times 1000\\,\\text{ms} = 10\\,\\text{ms}\n$$\nRounding to three significant figures, the value is $10.0\\,\\text{ms}$.\n\n**Comment on Physiological Plausibility**\nThe computed value of $\\tau_{m} = 10.0\\,\\text{ms}$ is highly plausible. Experimental measurements in central nervous system neurons, such as cortical pyramidal cells or interneurons, typically yield membrane time constants in the range of $5\\,\\text{ms}$ to $30\\,\\text{ms}$. A value of $10.0\\,\\text{ms}$ falls squarely within this biologically realistic range and is characteristic of a neuron with relatively \"fast\" membrane dynamics, allowing it to integrate synaptic inputs over a shorter time window.",
            "answer": "$$\n\\boxed{10.0}\n$$"
        },
        {
            "introduction": "Having established the definition of the time constant, we now explore its role in shaping the dynamic response of a neuron to input. This practice challenges you to derive the full voltage trajectory in response to a finite current pulse, illustrating how $\\tau_{m}$ governs both the charging and discharging phases of the membrane potential . This exercise is key to understanding how neurons integrate signals over time.",
            "id": "4008657",
            "problem": "Consider a single-compartment passive neuron modeled as a resistor-capacitor (RC) membrane with membrane capacitance $C_{m}$ and leak conductance $g_{L}$ to a reversal potential $E_{L}$. Let the membrane potential be $V(t)$ and define the deviation from rest as $v(t) = V(t) - E_{L}$. Assume that for $t  0$ the system is at rest, so $v(0^{-}) = 0$. The membrane dynamics follow Kirchhoff’s current law and the constitutive relations for a capacitor and an ohmic leak: the capacitor current is $I_{C} = C_{m} \\,\\frac{dv}{dt}$ and the leak current is $I_{L} = g_{L} \\, v(t)$, with sign convention that outward leak current is positive when $v(t)0$. The input current is a finite-duration rectangular pulse of amplitude $I_{0}$ and duration $T$, namely $I(t) = I_{0}\\,[u(t) - u(t - T)]$, where $u(t)$ is the Heaviside unit step function. Starting from these principles and definitions only, derive the voltage response $v(t)$ for all $t \\ge 0$, ensuring continuity at $t=T$ and identifying the time and value of the peak response. Define the membrane resistance $R_{m} = 1/g_{L}$ and the membrane time constant $\\tau_{m} = R_{m} C_{m}$ as part of your derivation.\n\nProvide your final answer as a single closed-form expression for $v(t)$ written compactly in terms of the unit step function $u(t)$, valid for all real $t$. Do not present a piecewise answer; use a single expression. Report only this final expression. No units are required in the final answer.",
            "solution": "The problem statement is valid as it describes a standard, well-posed problem in computational neuroscience based on fundamental principles of circuit theory.\n\nThe dynamics of the single-compartment passive neuron membrane potential are governed by Kirchhoff's current law, which states that the injected current, $I(t)$, must equal the sum of the currents flowing out of the compartment. The outward currents are the capacitive current, $I_{C}$, and the leak current, $I_{L}$.\n$$I(t) = I_{C}(t) + I_{L}(t)$$\nUsing the provided constitutive relations, $I_{C} = C_{m} \\frac{dv}{dt}$ and $I_{L} = g_{L} v(t)$, where $v(t) = V(t) - E_{L}$ is the membrane potential relative to the leak reversal potential, we obtain the governing first-order linear ordinary differential equation (ODE):\n$$C_{m} \\frac{dv}{dt} + g_{L} v(t) = I(t)$$\nThe problem requires the introduction of the membrane resistance, $R_{m}$, and the membrane time constant, $\\tau_{m}$. We define these as $R_{m} = 1/g_{L}$ and $\\tau_{m} = R_{m} C_{m}$. To express the ODE in terms of these parameters, we multiply the entire equation by $R_{m}$:\n$$R_{m} C_{m} \\frac{dv}{dt} + R_{m} g_{L} v(t) = R_{m} I(t)$$\nSubstituting the definitions for $\\tau_{m}$ and $R_{m}$, we arrive at the standard form of the membrane equation:\n$$\\tau_{m} \\frac{dv}{dt} + v(t) = R_{m} I(t)$$\nThe system is at rest for $t  0$, which implies the initial condition $v(0^{-}) = 0$. Since the membrane potential cannot change instantaneously for a finite current input, we have $v(0) = v(0^{-}) = 0$.\n\nThe input current is a rectangular pulse of amplitude $I_{0}$ and duration $T$, given by $I(t) = I_{0}\\,[u(t) - u(t - T)]$, where $u(t)$ is the Heaviside unit step function. Since the governing ODE is linear, we can use the principle of superposition to find the solution. The total response $v(t)$ is the sum of the responses to the two components of the input current: an upward step of magnitude $I_{0}$ at $t=0$, and a downward step of magnitude $I_{0}$ at $t=T$.\n\nFirst, we find the general response to a step current input $I_{s}(t) = I_{A} u(t - t_{0})$, where $I_A$ is the amplitude and $t_0$ is the time of the step. For $t \\ge t_{0}$, the ODE is $\\tau_{m} \\frac{dv}{dt} + v(t) = R_{m} I_{A}$, with the initial condition $v(t_{0}) = 0$ (assuming the system was at rest before the step). The solution to this non-homogeneous ODE is the sum of a homogeneous solution, $v_{h}(t)$, and a particular solution, $v_{p}(t)$.\nThe homogeneous equation is $\\tau_{m} \\frac{dv_{h}}{dt} + v_{h}(t) = 0$, which has the solution $v_{h}(t) = K \\exp(-(t-t_{0})/\\tau_{m})$ for some constant $K$.\nFor a constant input, the particular solution is the steady-state response, where $\\frac{dv_{p}}{dt} = 0$, giving $v_{p}(t) = R_{m} I_{A}$.\nThe general solution for $t \\ge t_0$ is $v(t) = K \\exp(-(t-t_{0})/\\tau_{m}) + R_{m} I_{A}$.\nApplying the initial condition $v(t_{0}) = 0$:\n$$0 = K \\exp(0) + R_{m} I_{A} \\implies K = -R_{m} I_{A}$$\nThus, the response to a step current $I_{A} u(t-t_{0})$ is:\n$$v_{step}(t) = R_{m} I_{A} \\left(1 - \\exp(-(t-t_{0})/\\tau_{m})\\right) u(t-t_{0})$$\n\nNow we apply this to the two components of our input current $I(t)$:\n1.  Response to the first component, $I_{0} u(t)$: Here, $I_{A} = I_{0}$ and $t_{0} = 0$. The response is\n    $$v_{1}(t) = R_{m} I_{0} \\left(1 - \\exp(-t/\\tau_{m})\\right) u(t)$$\n2.  Response to the second component, $-I_{0} u(t - T)$: Here, $I_{A} = -I_{0}$ and $t_{0} = T$. The response is\n    $$v_{2}(t) = R_{m} (-I_{0}) \\left(1 - \\exp(-(t-T)/\\tau_{m})\\right) u(t - T)$$\n    $$v_{2}(t) = -R_{m} I_{0} \\left(1 - \\exp(-(t-T)/\\tau_{m})\\right) u(t - T)$$\n\nThe total voltage response $v(t)$ is the sum $v(t) = v_{1}(t) + v_{2}(t)$. This gives the single closed-form expression for the voltage for all $t$:\n$$v(t) = R_{m} I_{0} \\left(1 - \\exp(-t/\\tau_{m})\\right) u(t) - R_{m} I_{0} \\left(1 - \\exp(-(t-T)/\\tau_{m})\\right) u(t - T)$$\n\nTo identify the peak response, we analyze the rate of change of the voltage, $\\frac{dv}{dt}$. From the ODE, $\\frac{dv}{dt} = \\frac{1}{\\tau_{m}}(R_{m} I(t) - v(t))$.\n- For $0 \\le t  T$, $I(t) = I_{0}$ and $v(t) = R_{m} I_{0}(1 - \\exp(-t/\\tau_{m}))$. The voltage $v(t)$ starts at $0$ and increases towards the steady-state value $R_{m} I_{0}$. Since $v(t)  R_{m} I_{0}$ for any finite $t$, we have $\\frac{dv}{dt} = \\frac{1}{\\tau_{m}}(R_{m} I_{0} - v(t))  0$. Thus, $v(t)$ is monotonically increasing throughout this interval.\n- For $t \\ge T$, $I(t) = 0$. The equation becomes $\\frac{dv}{dt} = -\\frac{v(t)}{\\tau_{m}}$. At $t=T$, the voltage is $v(T) = R_{m} I_{0}(1 - \\exp(-T/\\tau_{m}))$, which is positive. Since $v(t)$ will decay towards $0$ but remain positive, $\\frac{dv}{dt}$ is negative for all $t  T$. Thus, $v(t)$ is monotonically decreasing in this interval.\n\nBecause the voltage increases up to $t=T$ and decreases thereafter, the maximum (peak) voltage occurs precisely at $t=T$.\nThe time of the peak response is $t_{peak} = T$.\nThe value of the peak response is $v_{peak} = v(T)$. We evaluate the expression for $v(t)$ at $t=T$. At this point, $u(t-T)$ is on the cusp of becoming $1$, but we evaluate using the form for $t  T$ approaching $T$:\n$$v_{peak} = v(T) = R_{m} I_{0} (1 - \\exp(-T/\\tau_{m}))$$\nThe problem asks for a single expression for $v(t)$ as the final answer.",
            "answer": "$$\\boxed{R_{m} I_{0} \\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right) u(t) - R_{m} I_{0} \\left(1 - \\exp\\left(-\\frac{t-T}{\\tau_{m}}\\right)\\right) u(t-T)}$$"
        },
        {
            "introduction": "This final practice bridges the gap between theoretical models and experimental neuroscience. You will learn how to estimate the passive membrane parameters, the leak conductance $g_L$ and capacitance $C_m$, directly from frequency-domain measurements. By transforming the impedance formula into a linear regression problem, this exercise  provides a powerful and practical method for characterizing real neurons from electrophysiological data.",
            "id": "4008546",
            "problem": "You are modeling a single-compartment neuron membrane as a linear Resistive–Capacitive (RC) element consisting of a leak conductance $g_L$ in parallel with a membrane capacitance $C_m$. Under sinusoidal current stimulation at angular frequency $\\omega$ (in radians per second), the complex impedance $Z(j\\omega)$ of this passive membrane is defined by the linear time-invariant response of the parallel RC network. Starting from the constitutive relations for a resistor and a capacitor and Kirchhoff’s Current Law (KCL), derive an expression linking the squared inverse of the impedance magnitude to a linear function of $\\omega^2$. Use that expression to design a linear regression procedure that estimates $g_L$ (in siemens) and $C_m$ (in farads) from measurements of the impedance magnitude $\\lvert Z(j\\omega)\\rvert$ at multiple values of $\\omega$.\n\nYour program must:\n- Derive the regression model from first principles and identify the regression target and regressors.\n- Given a set of measured pairs $(\\omega_i, \\lvert Z(j\\omega_i)\\rvert)$, construct the linear system in the regressor $\\omega_i^2$ and solve for the intercept and slope using least squares.\n- Map the estimated intercept and slope to estimates of $g_L$ and $C_m$, ensuring non-negativity of the physical parameters by projecting negative intermediate estimates to zero if necessary.\n- Also compute the membrane time constant $\\tau = C_m / g_L$ (in seconds), with the convention $\\tau = +\\infty$ if $g_L = 0$.\n\nAll answers must be expressed in the specified units: $g_L$ in siemens (S), $C_m$ in farads (F), and $\\tau$ in seconds (s). No rounding requirement is imposed.\n\nTest Suite:\nProvide estimates for three test cases using the measured data below. In all cases, $\\omega$ is in radians per second and $\\lvert Z(j\\omega)\\rvert$ is in ohms.\n\n- Case A (general case across low to high frequencies):\n  - Frequencies: $\\omega = [\\,1.0,\\,10.0,\\,100.0,\\,500.0,\\,1000.0\\,]$\n  - Measured magnitudes: $\\lvert Z \\rvert = [\\,9.999500024999\\,\\times\\,10^{7},\\,9.950371902099\\,\\times\\,10^{7},\\,7.071067811865\\,\\times\\,10^{7},\\,1.961161351966\\,\\times\\,10^{7},\\,9.950371902099\\,\\times\\,10^{6}\\,]$\n- Case B (boundary case with only two points widely separated in frequency):\n  - Frequencies: $\\omega = [\\,1.0,\\,1000.0\\,]$\n  - Measured magnitudes: $\\lvert Z \\rvert = [\\,4.998437656000\\,\\times\\,10^{8},\\,1.998003197000\\,\\times\\,10^{7}\\,]$\n- Case C (edge case with extremely weak leak and small capacitance, spanning a broad impedance range):\n  - Frequencies: $\\omega = [\\,1.0,\\,5.0,\\,20.0,\\,50.0,\\,200.0\\,]$\n  - Measured magnitudes: $\\lvert Z \\rvert = [\\,9.950371902099\\,\\times\\,10^{9},\\,8.944271909999\\,\\times\\,10^{9},\\,4.472135954999\\,\\times\\,10^{9},\\,1.961161351966\\,\\times\\,10^{9},\\,4.993755000000\\,\\times\\,10^{8}\\,]$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of three floats in the order $[\\,g_L,\\,C_m,\\,\\tau\\,]$ using the units specified above. For example:\n$[\\,[g_{L,A},C_{m,A},\\tau_A],\\,[g_{L,B},C_{m,B},\\tau_B],\\,[g_{L,C},C_{m,C},\\tau_C]\\,]$",
            "solution": "The problem requires the derivation of a linear regression model to estimate the parameters of a passive single-compartment neuron membrane, modeled as a parallel Resistive-Capacitive (RC) circuit. The parameters to be estimated are the leak conductance $g_L$ and the membrane capacitance $C_m$.\n\nThe derivation proceeds from first principles, namely Kirchhoff’s Current Law (KCL) and the constitutive relations for a resistor and a capacitor. The circuit consists of a conductance $g_L$ in parallel with a capacitance $C_m$. When an input current $I(t)$ is applied, it splits into a resistive component $I_R(t)$ and a capacitive component $I_C(t)$.\n\nAccording to KCL, the total current is the sum of the currents through the parallel components:\n$$I(t) = I_R(t) + I_C(t)$$\nThe voltage $V(t)$ is common across both parallel elements. The constitutive relations for the current through the conductance and the capacitor are:\n$$I_R(t) = g_L V(t)$$\n$$I_C(t) = C_m \\frac{dV(t)}{dt}$$\nSubstituting these into the KCL equation yields the governing differential equation for the membrane voltage:\n$$I(t) = g_L V(t) + C_m \\frac{dV(t)}{dt}$$\nTo analyze the circuit's response to sinusoidal stimulation at an angular frequency $\\omega$, we move to the frequency domain using phasor analysis. We assume signals of the form $V(t) = \\mathbf{V} e^{j\\omega t}$ and $I(t) = \\mathbf{I} e^{j\\omega t}$, where $\\mathbf{V}$ and $\\mathbf{I}$ are the complex amplitudes (phasors) of voltage and current, and $j = \\sqrt{-1}$. The time derivative becomes a multiplication by $j\\omega$: $\\frac{d}{dt} \\rightarrow j\\omega$.\n\nThe differential equation transforms into an algebraic equation in the frequency domain:\n$$\\mathbf{I} = g_L \\mathbf{V} + C_m (j\\omega \\mathbf{V}) = (g_L + j\\omega C_m) \\mathbf{V}$$\nThe complex impedance $Z(j\\omega)$ is defined as the ratio of the voltage phasor to the current phasor:\n$$Z(j\\omega) = \\frac{\\mathbf{V}}{\\mathbf{I}} = \\frac{1}{g_L + j\\omega C_m}$$\nThe problem requires a relationship involving the magnitude of the impedance, $\\lvert Z(j\\omega)\\rvert$. We calculate the magnitude as:\n$$\\lvert Z(j\\omega)\\rvert = \\left\\lvert \\frac{1}{g_L + j\\omega C_m} \\right\\rvert = \\frac{1}{\\lvert g_L + j\\omega C_m \\rvert} = \\frac{1}{\\sqrt{g_L^2 + (\\omega C_m)^2}}$$\nTo obtain the desired linear form, we take the inverse square of the magnitude:\n$$\\frac{1}{\\lvert Z(j\\omega)\\rvert^2} = g_L^2 + (\\omega C_m)^2$$\nThis equation reveals a linear relationship between $\\frac{1}{\\lvert Z(j\\omega)\\rvert^2}$ and $\\omega^2$. We can formulate a linear regression model by defining:\n-   The dependent variable (target): $y = \\frac{1}{\\lvert Z(j\\omega)\\rvert^2}$\n-   The independent variable (regressor): $x = \\omega^2$\nThe model can be written in the standard linear form $y = a + bx$, where:\n-   The intercept $a = g_L^2$\n-   The slope $b = C_m^2$\n\nGiven a set of $N$ experimental measurements $(\\omega_i, \\lvert Z(j\\omega_i)\\rvert)$ for $i=1, \\dots, N$, we can transform this data into a set of points $(x_i, y_i) = (\\omega_i^2, \\frac{1}{\\lvert Z(j\\omega_i)\\rvert^2})$. The task is to find the parameters $a$ and $b$ that best fit the linear model $y_i = a + b x_i$. This is achieved using ordinary least squares (OLS) regression, which minimizes the sum of squared residuals. The OLS solution provides estimates for the intercept, $\\hat{a}$, and the slope, $\\hat{b}$.\n\nFrom the estimated regression coefficients, we can derive the physical parameters $g_L$ and $C_m$:\n$$\\hat{g}_L = \\sqrt{\\hat{a}}$$\n$$\\hat{C}_m = \\sqrt{\\hat{b}}$$\nSince both $g_L$ and $C_m$ must be non-negative physical quantities, their squares ($a$ and $b$) must also be non-negative. If the regression yields negative estimates for $\\hat{a}$ or $\\hat{b}$ (which can occur with noisy data), they must be projected to zero as per the problem specification. Thus, the estimators are:\n$$\\hat{g}_L = \\sqrt{\\max(0, \\hat{a})}$$\n$$\\hat{C}_m = \\sqrt{\\max(0, \\hat{b})}$$\nFinally, the membrane time constant, $\\tau$, is calculated as the ratio of capacitance to leak conductance:\n$$\\hat{\\tau} = \\frac{\\hat{C}_m}{\\hat{g}_L}$$\nAs specified, if the estimated leak conductance $\\hat{g}_L$ is zero, the time constant $\\hat{\\tau}$ is taken to be positive infinity, representing a perfect integrator with no passive decay. The units for the final parameters, derived from the input SI units of $\\omega$ (rad/s) and $\\lvert Z \\rvert$ ($\\Omega$), will be siemens (S) for $g_L$, farads (F) for $C_m$, and seconds (s) for $\\tau$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for membrane parameters g_L, C_m, and tau for three test cases\n    using linear regression on impedance data.\n    \"\"\"\n\n    def compute_rc_params(omegas, Z_magnitudes):\n        \"\"\"\n        Estimates RC parameters from frequency-impedance magnitude data.\n\n        Args:\n            omegas (list): A list of angular frequencies (rad/s).\n            Z_magnitudes (list): A list of corresponding impedance magnitudes (Ohms).\n\n        Returns:\n            list: A list containing estimated [g_L (S), C_m (F), tau (s)].\n        \"\"\"\n        # Convert inputs to numpy arrays for vectorized calculations.\n        omega_arr = np.array(omegas, dtype=float)\n        Z_mag_arr = np.array(Z_magnitudes, dtype=float)\n\n        # 1. Transform data for linear regression.\n        # The model is y = a + b*x, where:\n        # y = 1 / |Z|^2\n        # x = omega^2\n        # and the regression coefficients map to physical parameters as:\n        # a = g_L^2 (intercept)\n        # b = C_m^2 (slope)\n        x = omega_arr**2\n        y = 1.0 / Z_mag_arr**2\n\n        # 2. Set up and solve the linear least squares problem.\n        # We solve for p in A*p = y, where p = [intercept, slope].\n        # The design matrix A has a column of ones for the intercept and a\n        # column for the independent variable x.\n        A = np.vstack([np.ones_like(x), x]).T\n        \n        # np.linalg.lstsq returns the solution vector p.\n        coeffs = np.linalg.lstsq(A, y, rcond=None)[0]\n        intercept, slope = coeffs[0], coeffs[1]\n\n        # 3. Map regression coefficients to physical parameters.\n        # Apply the non-negativity constraint by projecting negative\n        # estimates of the squared parameters to zero.\n        gL_squared = max(0.0, intercept)\n        Cm_squared = max(0.0, slope)\n\n        gL = np.sqrt(gL_squared)\n        Cm = np.sqrt(Cm_squared)\n\n        # 4. Compute the membrane time constant tau.\n        # Handle the case where g_L is zero, for which tau is infinite.\n        if gL == 0.0:\n            tau = np.inf\n        else:\n            tau = Cm / gL\n        \n        return [gL, Cm, tau]\n\n    # Define the test cases from the problem statement.\n    case_A_omega = [1.0, 10.0, 100.0, 500.0, 1000.0]\n    case_A_Z = [9.999500024999e7, 9.950371902099e7, 7.071067811865e7, 1.961161351966e7, 9.950371902099e6]\n\n    case_B_omega = [1.0, 1000.0]\n    case_B_Z = [4.998437656e8, 1.998003197e7]\n\n    case_C_omega = [1.0, 5.0, 20.0, 50.0, 200.0]\n    case_C_Z = [9.950371902099e9, 8.944271909999e9, 4.472135954999e9, 1.961161351966e9, 4.993755000000e8]\n\n    test_cases = [\n        (case_A_omega, case_A_Z),\n        (case_B_omega, case_B_Z),\n        (case_C_omega, case_C_Z)\n    ]\n\n    results = []\n    for omega_data, Z_data in test_cases:\n        result = compute_rc_params(omega_data, Z_data)\n        results.append(result)\n\n    # Format the final output string to exactly match the required format.\n    # The format is a list of lists, with no spaces after commas.\n    outer_list_parts = []\n    for res_list in results:\n        # np.inf is converted to 'inf' by str()\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        outer_list_parts.append(inner_list_str)\n    \n    final_output_string = f\"[{','.join(outer_list_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}