{
    "hands_on_practices": [
        {
            "introduction": "我们首先探究使NMDA受体成为分子符合检测器的核心机制：其对镁离子 $\\mathrm{Mg}^{2+}$ 的电压依赖性阻断。本练习将引导您从第一性原理出发，推导膜电位与受体去阻断之间的关系。通过计算达到特定激活水平所需的去极化程度，您将对脉冲时序依赖可塑性的生物物理基础建立一个具体的理解 。",
            "id": "4005615",
            "problem": "考虑一个在尖峰时间依赖性巧合检测过程中，由N-甲基-D-天冬氨酸（NMDA）受体介导的钙信号传导的单突触模型。其核心机制是细胞外镁离子 $\\left[\\mathrm{Mg}^{2+}\\right]$ 在膜电场内一个结合位点上的电压依赖性阻断。假设以下基本生物物理事实：\n\n- 一个位于距细胞外侧分数电距离为 $\\delta$ 的单一阻断位点被化合价为 $z$ 的二价离子占据的平衡占据率，由一个玻尔兹曼因子决定。该因子根据公式 $K_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)$ 来修正表观解离常数，其中 $K_{d}^{0}$ 是 $V=0$ 时的解离常数，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度。\n- 在巧合发生的瞬间，谷氨酸快速结合且通道开放的情况下，未被镁离子阻断的NMDA通道的瞬时分数，由在电压 $V$ 时未被占据的结合位点的分数给出。\n\n将未阻断分数 $b(V)$ 定义为在膜电位 $V$ 时未被 $\\mathrm{Mg}^{2+}$ 阻断的通道分数，该分数源于阻断剂浓度和结合位点占据率之间的平衡。当 $b(V)$ 超过一个阈值 $b^{\\ast}$ 时，实现有效的巧合检测，该阈值由激活下游信号传导所需的钙微域决定。对于本问题，取 $b^{\\ast} = 0.20$。\n\n使用上述物理基础和定义，推导膜电位 $V^{\\ast}$（在该电位下 $b(V^{\\ast}) = b^{\\ast}$）作为 $\\left[\\mathrm{Mg}^{2+}\\right]$, $K_{d}^{0}$, $z$, $\\delta$, $F$, $R$ 和 $T$ 的函数表达式。然后，对于一个静息电位为 $V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$ 的神经元，计算在两种细胞外镁离子浓度下（$\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$ 和 $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$）所需的去极化 $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$。\n\n使用 $z = 2$, $\\delta = 0.70$, $F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$, $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$, $T = 310 \\ \\mathrm{K}$, 以及 $K_{d}^{0} = 1.0 \\ \\mathrm{mM}$。以 $\\mathrm{mV}$ 为单位表示最终的去极化值。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题陈述被认为是有效的，因为其科学基础扎实、问题提出得当、客观且内部一致。它描述了NMDA受体功能的标准生物物理模型（Woodhull模型），并提出了一个可解的定量问题。\n\n第一步是推导出NMDA通道未阻断分数 $b(V)$ 的显式表达式。镁离子 $\\mathrm{Mg}^{2+}$ 与通道孔内的阻断位点的结合可以描述为一个可逆反应：\n$$\n\\text{未阻断通道} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\text{已阻断通道}\n$$\n在平衡状态下，反应物和产物浓度之间的关系由解离常数 $K_{d}$ 定义。在此背景下，实体是状态的分数，因此我们考虑未阻断位点的分数 $b$ 和已阻断位点的分数 $1-b$。阻断剂是细胞外镁浓度 $\\left[\\mathrm{Mg}^{2+}\\right]$。电压依赖性解离常数 $K_{d}(V)$ 给出为：\n$$\nK_{d}(V) = \\frac{b \\cdot \\left[\\mathrm{Mg}^{2+}\\right]}{1-b}\n$$\n这个方程可以重新整理以求解未阻断分数 $b$，我们将其记为 $b(V)$ 以明确其对电压的依赖性：\n$$\nK_{d}(V) (1-b(V)) = b(V) \\left[\\mathrm{Mg}^{2+}\\right]\n$$\n$$\nK_{d}(V) = b(V) K_{d}(V) + b(V) \\left[\\mathrm{Mg}^{2+}\\right] = b(V) \\left( K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right] \\right)\n$$\n$$\nb(V) = \\frac{K_{d}(V)}{K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right]} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}(V)}}\n$$\n问题给出了电压依赖性解离常数的表达式：\n$$\nK_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)\n$$\n其中 $K_{d}^{0}$ 是 $V=0$ 时的解离常数，$z$ 是离子化合价，$\\delta$ 是结合位点的分数电距离，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度。\n\n将此代入 $b(V)$ 的表达式中，得到：\n$$\nb(V) = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}\n$$\n问题要求推导在未阻断分数达到阈值 $b^{\\ast}$ 时的膜电位 $V^{\\ast}$ 的表达式。我们设 $b(V^{\\ast}) = b^{\\ast}$：\n$$\nb^{\\ast} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)}\n$$\n我们现在求解 $V^{\\ast}$：\n$$\n\\frac{1}{b^{\\ast}} = 1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{1}{b^{\\ast}} - 1 = \\frac{1-b^{\\ast}}{b^{\\ast}} = \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}} = \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right) = -\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\n$$\n最后，分离出 $V^{\\ast}$：\n$$\nV^{\\ast} = -\\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right)\n$$\n利用属性 $\\ln(1/x) = -\\ln(x)$，我们可以将其写成更方便的形式：\n$$\nV^{\\ast} = \\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\frac{b^{\\ast}}{1-b^{\\ast}}\\right)\n$$\n这是阈值电位 $V^{\\ast}$ 的通用表达式。\n\n接下来，我们计算在两种指定情况下 $V^{\\ast}$ 的数值和所需的去极化 $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$。给定的参数是：\n$z = 2$\n$\\delta = 0.70$\n$F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$\n$R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$\n$T = 310 \\ \\mathrm{K}$\n$K_{d}^{0} = 1.0 \\ \\mathrm{mM}$\n$b^{\\ast} = 0.20$\n$V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$\n\n首先，我们计算常数前置因子 $\\frac{R\\,T}{z\\,\\delta\\,F}$：\n$$\n\\frac{R\\,T}{z\\,\\delta\\,F} = \\frac{(8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(310 \\ \\mathrm{K})}{(2)(0.70)(96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1})} = \\frac{2577.34}{135079} \\ \\mathrm{V} \\approx 0.0190801 \\ \\mathrm{V} = 19.0801 \\ \\mathrm{mV}\n$$\n以及包含 $b^{\\ast}$ 的项：\n$$\n\\frac{b^{\\ast}}{1-b^{\\ast}} = \\frac{0.20}{1-0.20} = \\frac{0.20}{0.80} = 0.25\n$$\n因此 $V^{\\ast}$ 的表达式变为：\n$$\nV^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{1.0 \\ \\mathrm{mM}} \\times 0.25\\right)\n$$\n\n情况1: $\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$\n$$\nV_{1}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{1.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.25) \\approx (19.0801 \\ \\mathrm{mV})(-1.38629) \\approx -26.4565 \\ \\mathrm{mV}\n$$\n所需的去极化为：\n$$\n\\Delta V_{1} = V_{1}^{\\ast} - V_{\\mathrm{rest}} \\approx -26.4565 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 38.5435 \\ \\mathrm{mV}\n$$\n四舍五入到四位有效数字，$\\Delta V_{1} = 38.54 \\ \\mathrm{mV}$。\n\n情况2: $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$\n$$\nV_{2}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{2.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.5) \\approx (19.0801 \\ \\mathrm{mV})(-0.693147) \\approx -13.2282 \\ \\mathrm{mV}\n$$\n所需的去极化为：\n$$\n\\Delta V_{2} = V_{2}^{\\ast} - V_{\\mathrm{rest}} \\approx -13.2282 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 51.7718 \\ \\mathrm{mV}\n$$\n四舍五入到四位有效数字，$\\Delta V_{2} = 51.77 \\ \\mathrm{mV}$。\n\n结果表明，当细胞外镁浓度较高时，需要更大的去极化来解除镁阻断，这与生物物理学原理一致。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n38.54  51.77\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在我们理解了NMDA受体的电压敏感性之后，我们现在来模拟一个真实的突触事件。本练习将对突触前谷氨酸释放和突触后反向传播动作电位对通过NMDA受体和电压门控钙通道（VGCCs）的钙内流的综合效应进行建模。通过对产生的钙电流进行数值积分，您将直接观察到突触前和突触后脉冲之间的精确时序如何决定钙信号的强度，而钙信号正是突触可塑性的触发器 。",
            "id": "4005633",
            "problem": "您需要计算一个树突隔室中每个脉冲对的总钙离子内流。该隔室接收单个谷氨酸能输入和一次反向传播动作电位。为此，您需要使用一个基于电导的模型，该模型包含N-甲基-D-天冬氨酸（NMDA）受体和电压门控钙离子通道（VGCC）的经典生物物理组件。该模型包含了NMDA受体的电压依赖性镁离子阻断、NMDA电流的钙离子组分以及VGCC的电压依赖性激活。您的解决方案必须实现指定的膜电位和谷氨酸门控波形，推导钙离子电流，并对其随时间积分以获得电荷。\n\n使用的基本原理和定义：\n\n- 使用线性电流关系 $I = g \\cdot a(V,t) \\cdot (V - E)$，其中 $I$ 是电流，$g$ 是最大电导，$a(V,t)$ 是一个可能依赖于电压 $V$ 和时间 $t$ 的门控或调制因子，$E$ 是反转电位。当应用于NMDA时，$a(V,t)$ 是谷氨酸门控波形和镁离子阻断因子的乘积。当应用于VGCC时，$a(V,t)$ 是稳态激活函数。\n\n- 使用电荷是电流的时间积分的定义，$Q = \\int I(t) \\, dt$。定义钙离子内流为正值，对应内向钙离子电流。如果 $I_{\\mathrm{Ca}}(t)$ 为负（内向），则内流为 $Q_{\\mathrm{influx}} = -\\int I_{\\mathrm{Ca}}(t) \\, dt$。\n\n- 使用广泛接受的NMDA经验性镁离子阻断公式：\n$$B(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V)}$$\n其中 $[\\mathrm{Mg}]$ 是细胞外镁离子浓度，单位为 $\\mathrm{mM}$，$V$ 的单位为 $\\mathrm{mV}$。\n\n- 使用VGCC的稳态电压依赖性激活函数：\n$$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{1/2}}{k}\\right)}$$\n\n波形：\n\n- 膜电位模型为基线电位加上一个由双指数函数差模拟的反向传播脉冲：\n$$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\n其中 $H(\\cdot)$ 是Heaviside阶跃函数，$V_{\\mathrm{rest}}$ 是静息电位，$A_{\\mathrm{AP}}$ 是脉冲振幅，$\\tau_{\\mathrm{r}}$ 是上升时间常数，$\\tau_{\\mathrm{f}}$ 是衰减时间常数。\n\n- 谷氨酸门控波形是一个alpha函数：\n$$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\n其中 $A_{\\mathrm{G}}$ 是谷氨酸振幅，$t_{\\mathrm{pre}}$ 是突触前时间，$\\tau_{\\mathrm{g}}$ 是谷氨酸时间尺度。当 $A_{\\mathrm{G}} = 1$ 时，alpha函数在 $t = t_{\\mathrm{pre}} + \\tau_{\\mathrm{g}}$ 处达到峰值，且峰值为单位振幅。\n\n需要计算的电流：\n\n- NMDA电流：\n$$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n\n- NMDA电流的钙离子组分：\n$$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\n其中 $P_{\\mathrm{Ca}}$ 是NMDA电流中由钙离子承载的部分。\n\n- VGCC钙离子电流：\n$$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n\n总钙离子电流：\n$$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\n每个脉冲对的总钙离子内流：\n$$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt$$\n\n单位：\n\n- 使用 $\\mathrm{nS}$ 作为 $g_{\\mathrm{NMDA}}$ 和 $g_{\\mathrm{VGCC}}$ 的单位。\n- 使用 $\\mathrm{mV}$ 作为 $V(t)$、$E_{\\mathrm{NMDA}}$、$E_{\\mathrm{Ca}}$ 和 $V_{1/2}$ 的单位。\n- 使用 $\\mathrm{ms}$ 作为时间单位。\n- 电流按 $I = g \\cdot (V - E)$ 计算，其中 $g$ 的单位为 $\\mathrm{nS}$，$V - E$ 的单位为 $\\mathrm{mV}$，得到的电流 $I$ 的单位为 $\\mathrm{pA}$。将单位为 $\\mathrm{pA}$ 的电流 $I$ 对单位为 $\\mathrm{ms}$ 的时间进行积分，得到单位为 $\\mathrm{fC}$ 的电荷；通过除以 $1000$ 转换为 $\\mathrm{pC}$。\n- 将最终的钙离子内流以 $\\mathrm{pC}$ 为单位表示，并四舍五入到小数点后六位。\n\n所有测试用例的固定常数：\n\n- $V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$。\n- $A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$。\n- $\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$，$\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$。\n- $\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$。\n- $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$。\n- $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$。\n- $V_{1/2} = -20.0 \\, \\mathrm{mV}$，$k = 6.0 \\, \\mathrm{mV}$。\n- 时间网格：$T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$，时间步长 $\\Delta t = 0.01 \\, \\mathrm{ms}$。\n\n测试套件：\n\n提供四组参数集 $(g_{\\mathrm{NMDA}}, P_{\\mathrm{Ca}}, g_{\\mathrm{VGCC}}, t_{\\mathrm{pre}}, t_{\\mathrm{post}}, A_{\\mathrm{G}}, [\\mathrm{Mg}])$:\n\n1. 情况1（突触前-后近重合，中等电导）：$(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$。\n\n2. 情况2（反因果时序，较弱重合）：$(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 60.0 \\, \\mathrm{ms}, 50.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$。\n\n3. 情况3（无谷氨酸释放，仅VGCC内流）：$(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 0.0, 1.0 \\, \\mathrm{mM})$。\n\n4. 情况4（近重合时序，高镁离子阻断）：$(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 3.0 \\, \\mathrm{mM})$。\n\n要求的最终输出格式：\n\n您的程序应产生单行输出，其中包含一个方括号内的逗号分隔列表。列表中的每个条目是对应测试用例的总钙离子内流 $Q_{\\mathrm{Ca}}$（单位为 $\\mathrm{pC}$），并四舍五入到小数点后六位（例如，$[0.012345,0.001234,0.000987,0.009999]$）。",
            "solution": "该问题要求计算在一个树突隔室模型中，突触前谷氨酸释放和突触后反向传播动作电位（bAP）发生后，总的钙离子内流 $Q_{\\mathrm{Ca}}$。解决方案涉及在指定的时间区间内对总钙离子电流进行数值积分。该模型将N-甲基-D-天冬氨酸（NMDA）受体和电压门控钙离子通道（VGCC）作为钙离子的来源。解决方法是对时间进行离散化，在每个时间步长上计算系统的状态，然后累加各部分贡献以获得总电荷。\n\n基本步骤如下：\n1.  **时间离散化**：建立一个从 $t=0$ 到 $t=T_{\\mathrm{max}}$ 的离散时间网格，步长为 $\\Delta t$。所有随时间变化的函数都将在此网格上进行评估。\n    $T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$ 且 $\\Delta t = 0.01 \\, \\mathrm{ms}$。\n\n2.  **波形生成**：为所有时间点计算膜电位 $V(t)$ 和谷氨酸门控 $G(t)$ 的波形。\n    -   膜电位 $V(t)$ 是静息电位 $V_{\\mathrm{rest}}$ 与一个代表bAP的时间依赖性分量的总和，该分量仅在 $t \\geq t_{\\mathrm{post}}$ 时激活。\n        $$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\n        这里，$H(\\cdot)$ 是Heaviside阶跃函数，$V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$，$A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$，$\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$，以及 $\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$。\n    -   谷氨酸门控变量 $G(t)$ 由一个alpha函数描述，在 $t \\geq t_{\\mathrm{pre}}$ 时激活。\n        $$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\n        这里，$\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$，$A_{\\mathrm{G}}$ 和 $t_{\\mathrm{pre}}$ 由每个测试用例给出。当 $A_{\\mathrm{G}}=0$ 时，对所有 $t$ 都有 $G(t)=0$。\n\n3.  **电压依赖性门控和调制**：使用计算出的 $V(t)$ 数组，在每个时间步长上计算两种通道类型的电压依赖项。\n    -   NMDA受体的镁离子阻断 $B(V)$ 由以下公式给出：\n        $$B(V(t)) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V(t))}$$\n        其中 $[\\mathrm{Mg}]$ 是每个测试用例中的一个参数。\n    -   VGCC的稳态激活 $m_{\\infty}(V)$ 由一个S型函数给出：\n        $$m_{\\infty}(V(t)) = \\frac{1}{1 + \\exp\\left(-\\frac{V(t) - V_{1/2}}{k}\\right)}$$\n        固定参数为 $V_{1/2} = -20.0 \\, \\mathrm{mV}$ 和 $k = 6.0 \\, \\mathrm{mV}$。\n\n4.  **钙离子电流计算**：然后在每个时间步长上计算来自每个来源的钙离子电流。\n    -   首先计算总NMDA电流：\n        $$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n        该电流的钙离子组分是总电流的一个分数 $P_{\\mathrm{Ca}}$：\n        $$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\n        反转电位为 $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$。\n    -   VGCC钙离子电流是：\n        $$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n        钙离子反转电位为 $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$。\n    -   总钙离子电流是这两个组分的总和：\n        $$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\n5.  **数值积分和单位转换**：总钙离子内流 $Q_{\\mathrm{Ca}}$ 是总钙离子电流的负时间积分。该积分通过对离散时间步长的求和来近似：\n    $$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt \\approx -\\sum_{i} I_{\\mathrm{Ca,tot}}(t_i) \\cdot \\Delta t$$\n    符号为负是因为按照惯例，内向电流为负，而内流是一个正量。单位处理如下：电导（$g_{\\mathrm{NMDA}}, g_{\\mathrm{VGCC}}$）单位为 $\\mathrm{nS}$，电位单位为 $\\mathrm{mV}$，得到的电流 $I$ 单位为 $\\mathrm{pA}$（$10^{-12} \\, \\mathrm{A}$）。将单位为 $\\mathrm{pA}$ 的电流对单位为 $\\mathrm{ms}$（$10^{-3} \\, \\mathrm{s}$）的时间进行积分，得到电荷单位为 $\\mathrm{fC}$（$10^{-15} \\, \\mathrm{C}$）。通过将 $\\mathrm{fC}$ 的结果除以 $1000$，最终转换为皮库伦（$\\mathrm{pC}$）。然后将结果四舍五入到小数点后六位。\n\n对测试套件中提供的四个参数集中的每一个都重复此完整过程。为了提高效率，该实现使用了`numpy`库提供的向量化操作。",
            "answer": "[0.101140,0.030588,0.021003,0.061266]"
        },
        {
            "introduction": "钙内流仅仅是第一步；由此产生的细胞内钙瞬变受到内源性缓冲蛋白的动态塑造。在最后的这个练习中，我们将通过对一个突触事件后移动钙缓冲蛋白结合与释放钙离子的过程进行建模，来探究这一关键过程。通过在不同缓冲蛋白浓度下进行仿真，您将量化这些分子如何减弱峰值并改变自由钙信号的时程，从而揭示它们在调节下游可塑性机制输入信号中的重要作用 。",
            "id": "4005614",
            "problem": "考虑一个混合均匀的单一树突棘隔室，在突触前和突触后重合的情况下，接收由N-甲基-D-天冬氨酸（NMDA）受体介导的钙离子内流。游离钙浓度表示为 $[\\mathrm{Ca}^{2+}](t)$，浓度为 $B(t)$ 的可动缓冲剂通过可逆反应 $B + \\mathrm{Ca}^{2+} \\rightleftharpoons BC$ 与钙离子结合形成 $BC(t)$，其正向（结合）速率为 $k_{\\mathrm{on}}$，逆向（解离）速率为 $k_{\\mathrm{off}}$。总缓冲剂浓度是守恒的，因此对于给定的 $B_{\\mathrm{T}}$，有 $B(t) + BC(t) = B_{\\mathrm{T}}$。依赖于NMDA的钙离子内流 $J_{\\mathrm{in}}(t)$ 是由突触前谷氨酸释放（其形状由一个α函数描述）和突触后去极化（以解除镁离子阻断）共同作用的结果。镁离子阻断因子由一个经过充分检验的函数形式 $f_{\\mathrm{Mg}}(V)$ 建模，该函数在超极化电位下会降低NMDA通道的有效开放概率。钙离子通过泵被清除，该过程被建模为一个速率常数为 $\\kappa$ 的一级过程，使 $[\\mathrm{Ca}^{2+}](t)$ 回归到静息浓度 $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$。\n\n从质量作用动力学和守恒定律出发，该钙离子-缓冲剂系统的控制常微分方程组为\n$$\n\\frac{d[\\mathrm{Ca}^{2+}]}{dt} = -k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) + k_{\\mathrm{off}}\\,BC(t) + J_{\\mathrm{in}}(t) - \\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right),\n$$\n$$\n\\frac{dBC}{dt} = k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) - k_{\\mathrm{off}}\\,BC(t),\n$$\n其中 $B(t) = B_{\\mathrm{T}} - BC(t)$。由NMDA驱动的内流模型为\n$$\nJ_{\\mathrm{in}}(t) = J_0\\,s(t)\\,f_{\\mathrm{Mg}}(V_{\\mathrm{dep}}),\n$$\n其中 $J_0$ 是一个源强度（单位为 $\\mu\\mathrm{M/s}$），$s(t)$ 是一个α函数，定义为\n$$\ns(t) = \\begin{cases}\n\\left(\\frac{t}{\\tau_{\\alpha}}\\right)\\exp\\left(1 - \\frac{t}{\\tau_{\\alpha}}\\right),  t \\ge 0,\\\\\n0,  t  0,\n\\end{cases}\n$$\n而 $f_{\\mathrm{Mg}}(V)$ 是一个电压依赖的镁离子阻断因子，由下式给出\n$$\nf_{\\mathrm{Mg}}(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\right)\\exp(-0.062\\,V)},\n$$\n其中 $V$ 的单位为毫伏，$[\\mathrm{Mg}^{2+}]$ 的单位为毫摩尔。通过在瞬态期间将 $V_{\\mathrm{dep}}$ 设置为去极化水平来表示重合。缓冲剂的平衡解离常数为 $K_D = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}}$。系统在 $t=0$ 时刻开始，初始条件为 $[\\mathrm{Ca}^{2+}](0) = [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$，且 $BC(0)$ 与 $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$ 处于准平衡状态，即：\n$$\nBC(0) = \\frac{B_{\\mathrm{T}}\\, [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}{K_D + [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}.\n$$\n\n任务：\n- 实现一个数值求解器，用于在给定以下科学一致性参数的情况下，模拟 $t \\in [0,T]$ 区间内的 $[\\mathrm{Ca}^{2+}](t)$。\n- 对于测试套件中每个指定的总缓冲剂浓度 $B_{\\mathrm{T}}$，计算游离钙峰值的衰减，其比率定义为\n$$\n\\mathrm{Attenuation}(B_{\\mathrm{T}}) = \\frac{\\max_{t \\in [0,T]} [\\mathrm{Ca}^{2+}](t; B_{\\mathrm{T}})}{\\max_{t \\in [0,T]} [\\mathrm{Ca}^{2+}](t; B_{\\mathrm{T}}=0)}.\n$$\n- 将衰减值报告为无单位的小数，四舍五入到三位小数。\n\n参数与单位：\n- 使用 $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}} = 0.05\\,\\mu\\mathrm{M}$，$k_{\\mathrm{on}} = 100\\,\\mu\\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{\\mathrm{off}} = 50\\,\\mathrm{s}^{-1}$，$\\kappa = 5\\,\\mathrm{s}^{-1}$，$J_0 = 150\\,\\mu\\mathrm{M/s}$，$\\tau_{\\alpha} = 0.01\\,\\mathrm{s}$，$T = 0.5\\,\\mathrm{s}$，$[\\mathrm{Mg}^{2+}] = 1.0\\,\\mathrm{mM}$，$V_{\\mathrm{dep}} = 0\\,\\mathrm{mV}$。\n- 除 $[\\mathrm{Mg}^{2+}]$ 单位为 $\\mathrm{mM}$ 外，所有浓度单位均为 $\\mu\\mathrm{M}$；时间单位为 $\\mathrm{s}$；电压单位为 $\\mathrm{mV}$。\n\n测试套件：\n- 为以下 $B_{\\mathrm{T}}$ 值（单位为 $\\mu\\mathrm{M}$）评估 $\\mathrm{Attenuation}(B_{\\mathrm{T}})$：$0$、 $1$、 $10$、 $50$、 $200$、 $1000$。\n\n算法与输出要求：\n- 对每个测试用例，在 $[0,T]$ 区间上对常微分方程组进行数值积分，需使用一种适用于刚性问题的方法以确保在不同缓冲剂体系下的稳定性。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：\"[0.997,0.865,0.742]\"），结果的顺序与上述测试套件一致。",
            "solution": "用户提供的问题已经过严格验证，并被确定为是合理的。该问题在科学上基于化学动力学和计算神经科学的原理，作为一个初值问题被良好地提出，并且其参数设定在物理上合理的范围内。该问题是完整的、客观的，并需要一个非平凡的数值解。\n\n该问题要求模拟树突棘内的钙浓度动态，该动态由一个常微分方程（ODE）系统控制。该模型捕捉了三个核心过程：通过NMDA受体的钙离子内流、与可动缓冲剂的可逆结合以及通过钙离子泵的外排。\n\n系统的状态由两个变量描述：游离钙离子的浓度 $[\\mathrm{Ca}^{2+}](t)$ 和缓冲剂的钙结合形式的浓度 $BC(t)$。它们随时间的演化由以下基于质量作用定律的耦合一阶常微分方程组描述：\n$$\n\\frac{d[\\mathrm{Ca}^{2+}]}{dt} = -k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) + k_{\\mathrm{off}}\\,BC(t) + J_{\\mathrm{in}}(t) - \\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right)\n$$\n$$\n\\frac{dBC}{dt} = k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) - k_{\\mathrm{off}}\\,BC(t)\n$$\n此处，$k_{\\mathrm{on}}$ 是缓冲剂结合速率常数，$k_{\\mathrm{off}}$ 是解离速率常数。游离（未结合）缓冲剂的浓度 $B(t)$ 通过守恒定律 $B(t) = B_{\\mathrm{T}} - BC(t)$ 与总缓冲剂浓度 $B_{\\mathrm{T}}$ 相关。项 $-\\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right)$ 模拟了钙离子泵的作用，这些泵排出钙离子并将其浓度恢复到静息水平 $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$。\n\n钙离子内流 $J_{\\mathrm{in}}(t)$ 由NMDA受体介导，其模型如下：\n$$\nJ_{\\mathrm{in}}(t) = J_0\\,s(t)\\,f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})\n$$\n该项包含三个部分：最大内流速率 $J_0$、随时间变化的突触激活曲线 $s(t)$ 以及电压依赖的调制因子 $f_{\\mathrm{Mg}}(V)$。函数 $s(t)$ 是一个α函数，代表了一种典型的突触电流形状：\n$$\ns(t) = \\left(\\frac{t}{\\tau_{\\alpha}}\\right)\\exp\\left(1 - \\frac{t}{\\tau_{\\alpha}}\\right) \\quad \\text{for } t \\ge 0\n$$\n因子 $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$ 模拟了镁离子对NMDA受体的电压依赖性阻断，由下式给出：\n$$\nf_{\\mathrm{Mg}}(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\right)\\exp(-0.062\\,V)}\n$$\n对于此问题，突触后膜被保持在恒定的去极化电位 $V_{\\mathrm{dep}} = 0\\,\\mathrm{mV}$，这使得 $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$ 成为一个缩放内流的常数因子。\n\n该系统被定义为一个初值问题（IVP）。在时间 $t=0$ 时，系统处于刺激前的稳态。游离钙的初始浓度为其静息值，$[\\mathrm{Ca}^{2+}](0) = [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$。结合缓冲剂的初始浓度 $BC(0)$ 由与静息钙水平的准平衡条件确定：\n$$\nBC(0) = \\frac{B_{\\mathrm{T}}\\, [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}{K_D + [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}, \\quad \\text{where } K_D = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}}\n$$\n\n求解策略包括为每个指定的总缓冲剂浓度 $B_{\\mathrm{T}}$ 对该常微分方程组进行数值积分。系统中时间尺度的范围——从快速的缓冲剂结合（微秒到毫秒）到较慢的外排和突触电流衰减（数十到数百毫秒）——可能使系统变得“刚性”（stiff）。因此，为了获得稳定和准确的解，需要一个专为刚性常微分方程设计的数值求解器，例如 `scipy.integrate.solve_ivp` 中可用的 `Radau` 或 `BDF` 方法。\n\n计算步骤如下：\n1. 定义所有提供的模型参数。\n2. 计算派生常数，例如缓冲剂解离常数 $K_D$ 和恒定的镁离子阻断因子 $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$。\n3. 实现一个函数，用于计算在给定时间 $t$ 和状态 $([\\mathrm{Ca}^{2+}], BC)$ 下的导数 $d[\\mathrm{Ca}^{2+}]/dt$ 和 $dBC/dt$。\n4. 首先，在时间区间 $[0, T]$ 上求解参考情况 $B_{\\mathrm{T}}=0$ 下的系统。此次模拟得到的 $[\\mathrm{Ca}^{2+}](t)$ 的最大值将作为基线峰值浓度。\n5. 依次为其他给定的 $B_{\\mathrm{T}}$ 值求解系统。对每种情况，计算初始条件，积分常微分方程组，并找出游离钙的峰值浓度。\n6. 对于每个 $B_{\\mathrm{T}}$，通过将其峰值钙浓度除以 $B_{\\mathrm{T}}=0$ 情况下的参考峰值钙浓度，来计算衰减比率。\n7. 收集最终结果，并将其格式化为一个四舍五入到三位小数的小数列表。\n\n该过程将按照规定使用 Python 的 `numpy` 和 `scipy` 库来实现。",
            "answer": "[1.000,0.965,0.762,0.418,0.158,0.035]"
        }
    ]
}