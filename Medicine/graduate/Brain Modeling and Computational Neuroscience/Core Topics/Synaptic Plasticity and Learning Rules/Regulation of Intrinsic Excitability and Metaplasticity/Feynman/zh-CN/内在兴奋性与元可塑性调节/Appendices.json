{
    "hands_on_practices": [
        {
            "introduction": "在深入研究可塑性机制的计算模型之前，我们首先必须理解如何在生物实验中辨别和分离不同类型的可塑性。这项实践是一项思想实验，旨在挑战我们设计出一个能够明确区分突触尺度可塑性（synaptic scaling）和内在可塑性（intrinsic plasticity）的实验方案。通过思考如何利用药理学工具和特定的电生理学测量方法，我们为后续更具体的建模练习奠定了坚实的概念基础。",
            "id": "4014259",
            "problem": "一个单室神经元模型被用于分析一项在啮齿动物皮层脑片中进行的分离实验，该实验旨在通过药理学方法和靶向刺激来区分突触缩放和内源性可塑性。在电流钳模式下，膜动力学由以下基于电导的方程描述：\n$$\nC \\frac{dV}{dt} = -g_{\\mathrm{L}}(V - E_{\\mathrm{L}}) - \\sum_{x \\in \\{\\mathrm{Na},\\mathrm{K},\\mathrm{HCN},\\ldots\\}} g_x \\, \\phi_x(V) (V - E_x) + I_{\\mathrm{syn}}(t) + I_{\\mathrm{ext}}(t),\n$$\n其中，$C$ 是膜电容，$g_{\\mathrm{L}}$ 是漏电导，其反转电位为 $E_{\\mathrm{L}}$，$g_x$ 和 $\\phi_x(V)$ 描述了内源性电导（例如钠、钾和超极化激活的环核苷酸门控通道）的电压和时间依赖性激活，$I_{\\mathrm{syn}}(t)$ 是突触电流，$I_{\\mathrm{ext}}(t)$ 是注入的胞体电流。在固定钳制电位 $V_{\\mathrm{hold}}$ 的全细胞电压钳条件下，单个兴奋性事件测得的突触电流为\n$$\nI_{\\mathrm{mEPSC}} = g_{\\mathrm{AMPA}} s(t) (V_{\\mathrm{hold}} - E_{\\mathrm{AMPA}}),\n$$\n其中，$g_{\\mathrm{AMPA}}$ 是α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体电导，$s(t)$ 是突触门控变量，$E_{\\mathrm{AMPA}}$ 是其反转电位。在这种钳制配置下，当 $V$ 保持固定时，内源性电导 $g_x$ 的变化不会改变 $I_{\\mathrm{mEPSC}}$。\n\n突触缩放被定义为兴奋性突触权重的稳态乘法性重缩放，它能稳定突触后放电速率，通常在活动剥夺后（例如使用河豚毒素（TTX））观察到，并且通常需要肿瘤坏死因子α（TNFα）信号和新的蛋白质合成。内源性可塑性被定义为内源性膜电导的活动依赖性变化（例如由L型钙离子通道介导），这些变化会改变输入电阻、放电阈值和放电速率-电流曲线。元可塑性指的是可塑性阈值的缓慢调节，这种调节控制着后续的突触或内源性变化。\n\n你需要选择能够将突触缩放与内源性可塑性分离开来的实验设计，通过选择性地激活一个过程，同时用药理学方法阻断另一个过程，并使用能够隔离所激活过程的靶向刺激和测量方法。一个有效的分离必须在原则上满足以下所有条件：（i）一个优先驱动突触或内源性机制的刺激方案，（ii）一个能阻止非目标过程的药理学阻断剂组，以及（iii）一个由于测量配置（例如电压钳对内源性电导不敏感，或胞体电流注入对突触权重不敏感）而对被阻断过程不敏感的测量读数。\n\n考虑以下候选设计。选择所有能成功分离这两个过程的设计。\n\nA. 诱导突触缩放：将脑片在浓度为 $1\\,\\mu\\mathrm{M}$ 的河豚毒素（TTX）中孵育 $24\\,\\mathrm{h}$，以沉默放电并触发稳态缩放，同时持续施加浓度为 $10\\,\\mu\\mathrm{M}$ 的L型钙离子通道阻断剂尼莫地平，以抑制活动依赖性的内源性可塑性。洗脱TTX和尼莫地平后，在 $V_{\\mathrm{hold}} = -70\\,\\mathrm{mV}$ 的电压钳条件下评估兴奋性微型突触后电流（mEPSCs），并在电流钳条件下使用胞体阶跃电流评估放电速率-电流曲线 $r(I_{\\mathrm{ext}})$。预测：mEPSC振幅乘法性增加一个因子 $k > 1$，而基流和 $r(I_{\\mathrm{ext}})$ 斜率相对于基线保持不变。\n\nB. 诱导内源性可塑性：在没有突触刺激的情况下，向第2/3层锥体神经元施加胞体去极化脉冲（$300$个脉冲，持续时间 $1\\,\\mathrm{s}$，频率 $0.1\\,\\mathrm{Hz}$），以驱动持续的突触后放电 $30\\,\\mathrm{min}$，同时通过施加肿瘤坏死因子α（TNFα）清除剂（依那西普，浓度 $100\\,\\mu\\mathrm{g}/\\mathrm{mL}$）和GluA2 C-末端肽来阻止α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体插入，从而阻断突触缩放。在电流钳条件下评估放电速率-电流曲线 $r(I_{\\mathrm{ext}})$，并在 $V_{\\mathrm{hold}} = -70\\,\\mathrm{mV}$ 的电压钳条件下评估mEPSC振幅。预测：基流降低，$r(I_{\\mathrm{ext}})$ 斜率增加，而mEPSC振幅分布保持不变。\n\nC. 尝试在阻断放电期间进行分离测量：在记录期间急性施加 $1\\,\\mu\\mathrm{M}$ 的TTX以阻断钠通道，同时通过光遗传学输入刺激传递突触爆发 $10\\,\\mathrm{min}$；在TTX阻断期间测量 $r(I_{\\mathrm{ext}})$ 和mEPSCs。预测：$r(I_{\\mathrm{ext}})$ 无放电，并且由于网络活动受到抑制，mEPSC检测减少；如果任一读数发生变化，则得出分离结论。\n\nD. 在阻断α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体的同时激活赫布可塑性：向突触输入施加脉冲时间依赖性配对方案（$60$次配对，$\\Delta t = +10\\,\\mathrm{ms}$），同时施加浓度为 $10\\,\\mu\\mathrm{M}$ 的α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体拮抗剂CNQX和浓度为 $50\\,\\mu\\mathrm{M}$ 的N-甲基-D-天冬氨酸受体拮抗剂APV；在配对后评估mEPSCs和 $r(I_{\\mathrm{ext}})$。预测：诱导期间兴奋性突触传递被阻断；任何变化都反映了内源性可塑性。\n\nE. 同时阻断两个过程：施加浓度为 $10\\,\\mu\\mathrm{M}$ 的尼莫地平和一种GluA2 C-末端肽，同时向兴奋性输入传递突触爆发（$5$个串，每串 $100\\,\\mathrm{Hz}$，持续 $1\\,\\mathrm{s}$）；之后测量mEPSCs和 $r(I_{\\mathrm{ext}})$。预测：两个读数均无变化；由于两者均未改变，因此得出分离结论。\n\n根据上述膜方程和测量原理，哪个（或哪些）选项实施了有效的分离？",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **神经元模型方程（电流钳）：** $C \\frac{dV}{dt} = -g_{\\mathrm{L}}(V - E_{\\mathrm{L}}) - \\sum_{x \\in \\{\\mathrm{Na},\\mathrm{K},\\mathrm{HCN},\\ldots\\}} g_x \\, \\phi_x(V) (V - E_x) + I_{\\mathrm{syn}}(t) + I_{\\mathrm{ext}}(t)$，其中 $C$ 是电容，$g_{\\mathrm{L}}$ 是漏电导，$E_{\\mathrm{L}}$ 是漏电反转电位，$g_x$ 是内源性电导，$\\phi_x(V)$ 是它们的电压/时间依赖性，$E_x$ 是它们的反转电位，$I_{\\mathrm{syn}}(t)$ 是突触电流，$I_{\\mathrm{ext}}(t)$ 是外部电流。\n- **突触电流测量（电压钳）：** $I_{\\mathrm{mEPSC}} = g_{\\mathrm{AMPA}} s(t) (V_{\\mathrm{hold}} - E_{\\mathrm{AMPA}})$，其中 $g_{\\mathrm{AMPA}}$ 是AMPA受体电导，$s(t)$ 是门控变量，$V_{\\mathrm{hold}}$ 是钳制电位，$E_{\\mathrm{AMPA}}$ 是AMPA反转电位。\n- **测量原理：** 在电压钳下，内源性电导 $g_x$ 的变化不改变 $I_{\\mathrm{mEPSC}}$。\n- **突触缩放定义：** 兴奋性突触权重（$g_{\\mathrm{AMPA}}$）的稳态乘法性重缩放。由活动剥夺（例如，河豚毒素（TTX））触发。需要肿瘤坏死因子α（TNFα）和蛋白质合成。\n- **内源性可塑性（IP）定义：** 内源性电导（$g_x$）的活动依赖性变化。改变输入电阻、放电阈值和放电速率-电流（$r(I_{\\mathrm{ext}})$）曲线。通常由L型钙离子通道介导。\n- **元可塑性定义：** 可塑性阈值的缓慢调节。\n- **分离标准：** 一个有效的分离必须满足：\n    (i) 一个优先驱动突触或内源性机制的刺激方案。\n    (ii) 一个能阻止非目标过程的药理学阻断剂组。\n    (iii) 一个由于测量配置而对被阻断过程不敏感的测量读数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础：** 该问题基于计算和细胞神经科学中标准、成熟的模型和概念。神经元模型是一个通用的基于电导的模型。突触缩放和内源性可塑性的定义、特定药理学试剂（TTX、尼莫地平、依那西普等）的作用以及电生理学测量技术（电压钳、电流钳）都是事实正确且属于神经科学主流知识。\n- **问题明确：** 该问题为成功的分离实验提供了清晰、明确的标准。任务是根据这些标准评估一组提议的实验。这种结构允许基于所提供原理的逻辑应用得出唯一且稳定的解。\n- **客观性：** 问题以精确、技术性的语言表述，没有主观或含糊的陈述。定义和标准是客观且可形式化的。\n- **完整性和一致性：** 问题是自洽的。它提供了回答问题所需的理论背景（模型方程）、定义（可塑性类型）和实验原理（测量分离）。内部没有矛盾。\n- **现实性：** 提议的实验设计，包括刺激方案和药理学浓度，在科学上是合理的，并反映了在该领域进行的真实实验。\n\n### 步骤3：判断与行动\n问题陈述是**有效的**。它在科学上是合理的，问题明确，是应用神经科学实验设计基本原则的一个极好的练习。我将通过根据所述标准评估每个选项来解决问题。\n\n### 求解推导\n问题的核心是识别能够成功分离突触缩放与内源性可塑性的实验设计。根据问题陈述，一个有效的分离必须满足三个标准：（i）选择性刺激，（ii）选择性药理学阻断，和（iii）选择性测量。\n\n测量原理是关键：\n- 突触强度（$g_{\\mathrm{AMPA}}$）的变化通过电压钳下的mEPSC振幅来测量。在固定的 $V_{\\mathrm{hold}}$下，$I_{\\mathrm{mEPSC}} \\propto g_{\\mathrm{AMPA}}$。该测量被明确说明对电压门控内源性电导 $g_x$ 的变化不敏感。\n- 内源性兴奋性（由于 $g_x$ 的变化）的变化通过电流钳下的放电速率-注入电流（$r(I_{\\mathrm{ext}})$）曲线来测量。该曲线的特性，如基流（引起放电的最小电流）和斜率，由内源性电导 $g_x$ 集合决定。该测量不依赖于突触输入，因为它依赖于胞体电流注入 $I_{\\mathrm{ext}}$。\n\n我们现在根据三个分离标准评估每个选项。\n\n**A. 诱导突触缩放：将脑片在浓度为 $1\\,\\mu\\mathrm{M}$ 的河豚毒素（TTX）中孵育 $24\\,\\mathrm{h}$，以沉默放电并触发稳态缩放，同时持续施加浓度为 $10\\,\\mu\\mathrm{M}$ 的L型钙离子通道阻断剂尼莫地平，以抑制活动依赖性的内源性可塑性。洗脱TTX和尼莫地平后，在 $V_{\\mathrm{hold}} = -70\\,\\mathrm{mV}$ 的电压钳条件下评估兴奋性微型突触后电流（mEPSCs），并在电流钳条件下使用胞体阶跃电流评估放电速率-电流曲线 $r(I_{\\mathrm{ext}})$。预测：mEPSC振幅乘法性增加一个因子 $k > 1$，而基流和 $r(I_{\\mathrm{ext}})$ 斜率相对于基线保持不变。**\n\n- **(i) 选择性刺激：** 该方案使用TTX进行长时间（$24\\,\\mathrm{h}$）的活动剥夺。这是诱导稳态突触缩放的经典方法。此标准得到满足。\n- **(ii) 选择性阻断：** 该方案包括尼莫地平，一种L型钙离子通道的阻断剂，而L型钙离子通道据称介导IP。这在药理学上阻断了内源性可塑性的诱导。此标准得到满足。\n- **(iii) 选择性测量：** 评估使用电压钳测量mEPSCs（对 $g_{\\mathrm{AMPA}}$ 敏感，对 $g_x$ 不敏感）和使用胞体注入的电流钳测量 $r(I_{\\mathrm{ext}})$ 曲线（对 $g_x$ 敏感，对 $g_{\\mathrm{AMPA}}$ 不敏感）。这种测量策略正确地分离了两个读数。此标准得到满足。\n预测与预期结果完全一致：突触缩放发生（mEPSC振幅增加），而内源性可塑性被阻止（$r(I_{\\mathrm{ext}})$ 曲线不变）。该设计成功地分离了这两个过程。\n**结论：正确。**\n\n**B. 诱导内源性可塑性：在没有突触刺激的情况下，向第2/3层锥体神经元施加胞体去极化脉冲（$300$个脉冲，持续时间 $1\\,\\mathrm{s}$，频率 $0.1\\,\\mathrm{Hz}$），以驱动持续的突触后放电 $30\\,\\mathrm{min}$，同时通过施加肿瘤坏死因子α（TNFα）清除剂（依那西普，浓度 $100\\,\\mu\\mathrm{g}/\\mathrm{mL}$）和GluA2 C-末端肽来阻止α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体插入，从而阻断突触缩放。在电流钳条件下评估放电速率-电流曲线 $r(I_{\\mathrm{ext}})$，并在 $V_{\\mathrm{hold}} = -70\\,\\mathrm{mV}$ 的电压钳条件下评估mEPSC振幅。预测：基流降低，$r(I_{\\mathrm{ext}})$ 斜率增加，而mEPSC振幅分布保持不变。**\n\n- **(i) 选择性刺激：** 该方案使用直接的胞体去极化来驱动突触后放电，这是IP的一个已知驱动因素，而没有直接激活突触。这优先激活了内源性机制。此标准得到满足。\n- **(ii) 选择性阻断：** 该方案包括TNFα清除剂和一种阻断AMPA受体运输的肽，靶向问题中定义的突触缩放的分子机制。这在药理学上阻断了突触缩放的诱导。此标准得到满足。\n- **(iii) 选择性测量：** 评估使用与选项A中相同的有效测量策略，正确地分离了内源性和突触属性的读数。此标准得到满足。\n预测与预期结果完全一致：内源性可塑性发生（$r(I_{\\mathrm{ext}})$ 曲线改变），而突触缩放被阻止（mEPSC振幅不变）。这个设计是A的逻辑补充，也成功地分离了这两个过程。\n**结论：正确。**\n\n**C. 尝试在阻断放电期间进行分离测量：在记录期间急性施加 $1\\,\\mu\\mathrm{M}$ 的TTX以阻断钠通道，同时通过光遗传学输入刺激传递突触爆发 $10\\,\\mathrm{min}$；在TTX阻断期间测量 $r(I_{\\mathrm{ext}})$ 和mEPSCs。预测：$r(I_{\\mathrm{ext}})$ 无放电，并且由于网络活动受到抑制，mEPSC检测减少；如果任一读数发生变化，则得出分离结论。**\n\n- **(i) 选择性刺激：** 该方案传递突触爆发，通常会同时驱动突触和内源性活动。\n- **(ii) 选择性阻断：** 施加了TTX，它阻断了所有依赖钠通道的动作电位。这不是对*一种可塑性形式*的选择性阻断剂；它是对通常驱动两种可塑性的神经活动（放电）的阻断剂。这未能满足标准(ii)。\n- **(iii) 选择性测量：** 关键在于，在TTX存在的情况下无法测量 $r(I_{\\mathrm{ext}})$ 曲线，因为TTX阻止了放电。一个对于所有 $I_{\\mathrm{ext}}$ 都有 $r=0$ 的 $r(I_{\\mathrm{ext}})$ 曲线无法提供关于底层内源性电导 $g_x$ 是否发生变化的任何信息。这种测量因药理学作用而无效，未能满足标准(iii)。\n因为一个关键的测量变得不可能，这个设计无法分离这两个过程。\n**结论：不正确。**\n\n**D. 在阻断α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体的同时激活赫布可塑性：向突触输入施加脉冲时间依赖性配对方案（$60$次配对，$\\Delta t = +10\\,\\mathrm{ms}$），同时施加浓度为 $10\\,\\mu\\mathrm{M}$ 的α-氨基-3-羟基-5-甲基-4-异恶唑丙酸受体拮抗剂CNQX和浓度为 $50\\,\\mu\\mathrm{M}$ 的N-甲基-D-天冬氨酸受体拮抗剂APV；在配对后评估mEPSCs和 $r(I_{\\mathrm{ext}})$。预测：诱导期间兴奋性突触传递被阻断；任何变化都反映了内源性可塑性。**\n\n- 这个选项引入了一种不同形式的突触可塑性，即赫布脉冲时间依赖性可塑性（STDP），这与问题中定义的稳态突触缩放不同。目标是分离*突触缩放*与IP。这个设计针对了错误的突触过程，因此未能解决问题。此外，施加CNQX和APV会阻断这些突触上大多数形式的赫布可塑性的诱导。该方案旨在阻断其声称正在研究的突触变化，使得实验逻辑变得复杂。它不符合问题中分离稳态缩放和IP的框架。\n**结论：不正确。**\n\n**E. 同时阻断两个过程：施加浓度为 $10\\,\\mu\\mathrm{M}$ 的尼莫地平和一种GluA2 C-末端肽，同时向兴奋性输入传递突触爆发（$5$个串，每串 $100\\,\\mathrm{Hz}$，持续 $1\\,\\mathrm{s}$）；之后测量mEPSCs和 $r(I_{\\mathrm{ext}})$。预测：两个读数均无变化；由于两者均未改变，因此得出分离结论。**\n\n- **(i) 选择性刺激：** 这个方案没有“优先驱动”一个过程。它驱动的活动可能潜在地诱导两者。更重要的是，分离实验的明确目标是激活一个过程*同时阻断另一个*。这个设计试图同时阻断两者。\n- 这个实验是一个阴性对照。阴性对照在科学中至关重要，但它不是问题标准所定义的分离实验。当两个过程都被阻断时观察到没有变化，并不能证明它们可以被分离。要证明分离，必须显示过程A可以在过程B不发生的情况下被诱导，和/或反之亦然。这个设计未能满足分离实验的基本逻辑。结论“由于两者均未改变，因此得出分离结论”是错误的。\n**结论：不正确。**\n\n综上所述，只有选项A和B描述了满足分离突触缩放和内源性可塑性所有规定标准的有效实验设计。它们代表了完全分离所需的两个互补实验。",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "在建立了区分不同可塑性形式的实验框架后，我们现在将注意力集中在一个具体的内在电导上：超极化激活电流 $I_h$。本练习将通过分析推导，揭示如何将特定离子通道（由其最大电导 $g_h$ 参数化）的生物物理特性与神经元的基本电生理指征（如输入电阻和电压“下垂”现象）联系起来。这项实践旨在磨练我们使用数学工具从微观机制预测宏观功能的技能。",
            "id": "4014274",
            "problem": "一个单室神经元通过被动泄漏和超极化激活的环核苷酸门控 (HCN) 电流（记为 $I_h$）进行建模。细胞膜遵循电流守恒和门控的 Hodgkin–Huxley 形式，表示为\n$$C \\frac{dV}{dt} = -I_L - I_h + I_{\\mathrm{app}}(t),$$\n其中 $I_L = g_L\\,(V - E_L)$ 是泄漏电流，$I_h = g_h\\,m\\,(V - E_h)$ 是 HCN 电流，$g_L$ 和 $g_h$ 分别是泄漏和 HCN 的最大电导，$E_L$ 和 $E_h$ 是泄漏和 HCN 的反转电位，$m$ 是遵循一级动力学的 HCN 激活变量。在静息电压 $V_0$ 附近，假设扰动很小，使得稳态激活可以线性化为 $m_{\\infty}(V) \\approx m_0 + s\\,(V - V_0)$，其中 $m_0 = m_{\\infty}(V_0)$ 且 $s = \\left.\\frac{dm_{\\infty}}{dV}\\right|_{V_0}$。\n\n在 $t=0$ 时施加一个短暂的超极化电流阶跃 $I_{\\mathrm{app}}(t) = I_0\\,H(t)$，其中 $I_0  0$，$H(t)$ 是亥维赛德阶跃函数。此处，下垂幅度 (sag amplitude) 定义为初始峰值电压偏转（在 $t=0^{+}$ 时，$m$ 尚未从 $m_0$ 改变）与稳态电压偏转（在 $m$ 平衡后）之差的绝对值，除以初始峰值电压偏转的绝对值。输入电阻定义为在 $|I_0|$ 很小时，稳态电压偏转除以施加的电流幅值。\n\n仅使用上述定义和线性化假设，推导以 $g_L$、$g_h$、$m_0$、$s$ 和 $(V_0 - E_h)$ 表示的稳态输入电阻和归一化下垂幅度的表达式。然后，对于基线参数值\n- $g_L = 10\\,\\mathrm{nS}$，\n- $g_h = 5\\,\\mathrm{nS}$，\n- $m_0 = 0.2$，\n- $s = -0.03\\,\\mathrm{mV}^{-1}$，\n- $V_0 = -65\\,\\mathrm{mV}$，\n- $E_h = -45\\,\\mathrm{mV}$，\n计算当 $g_h$ 增加 $0.40$（百分之四十）而所有其他参数保持不变时，稳态输入电阻的倍数变化和归一化下垂幅度的倍数变化。\n\n按顺序报告你的最终答案，为两个无量纲数：首先是输入电阻变化因子（新值除以基线值），其次是下垂幅度变化因子（新值除以基线值）。将你的两个数字四舍五入到四位有效数字。最终答案中不需要单位。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n\n提供的数学模型和定义如下：\n- 膜电位动力学：$C \\frac{dV}{dt} = -I_L - I_h + I_{\\mathrm{app}}(t)$\n- 泄漏电流：$I_L = g_L\\,(V - E_L)$\n- HCN 电流：$I_h = g_h\\,m\\,(V - E_h)$\n- HCN 激活变量动力学：一级动力学，其稳态激活在静息电压 $V_0$ 附近线性化为 $m_{\\infty}(V) \\approx m_0 + s\\,(V - V_0)$，其中 $m_0 = m_{\\infty}(V_0)$ 且 $s = \\left.\\frac{dm_{\\infty}}{dV}\\right|_{V_0}$。\n- 施加电流：$I_{\\mathrm{app}}(t) = I_0\\,H(t)$，其中 $I_0  0$，$H(t)$ 是亥维赛德阶跃函数。\n- 下垂幅度定义：“初始峰值电压偏转（在 $t=0^{+}$ 时，$m$ 尚未从 $m_0$ 改变）与稳态电压偏转（在 $m$ 平衡后）之差的绝对值，除以初始峰值电压偏转的绝对值。”\n- 输入电阻定义：“在 $|I_0|$ 很小时，稳态电压偏转除以施加的电流幅值。”\n\n基线参数值：\n- $g_L = 10\\,\\mathrm{nS}$\n- $g_h = 5\\,\\mathrm{nS}$\n- $m_0 = 0.2$\n- $s = -0.03\\,\\mathrm{mV}^{-1}$\n- $V_0 = -65\\,\\mathrm{mV}$\n- $E_h = -45\\,\\mathrm{mV}$\n\n任务要求：\n1.  推导以 $g_L$、$g_h$、$m_0$、$s$ 和 $(V_0 - E_h)$ 表示的稳态输入电阻和归一化下垂幅度的表达式。\n2.  计算当 $g_h$ 增加 $40\\%$ ($0.40$) 时，这两个量的倍数变化。\n3.  报告两个无量纲数，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题具有科学依据，描述了一个标准的单室 Hodgkin-Huxley 风格神经元模型，这是计算神经科学中的一个基本模型。使用超极化激活电流 ($I_h$) 和电压下垂分析是标准概念。围绕稳态对小扰动进行线性化的方法是一种有效且常用的分析技术。输入电阻和下垂幅度的定义清晰且具有物理意义。所有术语都已定义，且提供的参数在神经元的实际范围内。该问题是自洽的、客观的且适定的。未检测到科学、逻辑或事实上的缺陷。\n\n### 步骤 3：结论和行动\n\n问题有效。将提供完整解答。\n\n### 表达式推导\n\n首先，我们推导稳态输入电阻 $R_{in}$ 的表达式。输入电阻是为小电流注入定义的，这意味着我们可以在静息电位 $V_0$ 附近线性化系统的电流-电压 ($I-V$) 关系。在稳态下，恒定的施加电流 $I_0$ 导致恒定的膜电位 $V_{ss}$，此时 $\\frac{dV}{dt} = 0$，门控变量 $m$ 已达到其稳态值 $m_{\\infty}(V_{ss})$。控制方程为：\n$$I_0 = I_L + I_h = g_L(V_{ss} - E_L) + g_h m_{\\infty}(V_{ss})(V_{ss} - E_h)$$\n流出细胞的总稳态电流是 $I_{ion}(V) = g_L(V - E_L) + g_h m_{\\infty}(V)(V - E_h)$。在静息状态 ($t0$)，$I_{\\mathrm{app}}=0$ 且 $V=V_0$，所以 $I_{ion}(V_0) = 0$。\n对于一个小的施加电流 $I_0$，产生的电压 $V_{ss}$ 接近 $V_0$。我们可以使用 $I_{ion}(V)$ 在 $V_0$ 附近的泰勒展开：\n$$I_0 = I_{ion}(V_{ss}) \\approx I_{ion}(V_0) + \\left.\\frac{dI_{ion}}{dV}\\right|_{V=V_0} (V_{ss} - V_0)$$\n由于 $I_{ion}(V_0) = 0$，我们有 $I_0 \\approx G_{ss}(V_{ss} - V_0)$，其中 $G_{ss}$ 是稳态电导。\n输入电阻是 $R_{in} = \\frac{V_{ss} - V_0}{I_0} = \\frac{1}{G_{ss}}$。我们通过对 $I_{ion}(V)$ 求导来计算 $G_{ss}$：\n$$G_{ss} = \\left.\\frac{dI_{ion}}{dV}\\right|_{V_0} = \\left.\\frac{d}{dV}\\left[ g_L(V - E_L) + g_h m_{\\infty}(V)(V - E_h) \\right]\\right|_{V_0}$$\n$$G_{ss} = g_L + g_h \\left[ \\left.\\frac{dm_{\\infty}}{dV}\\right|_{V_0}(V_0 - E_h) + m_{\\infty}(V_0) \\cdot 1 \\right]$$\n使用所给的符号 $m_{\\infty}(V_0) = m_0$ 和 $\\left.\\frac{dm_{\\infty}}{dV}\\right|_{V_0} = s$，我们得到：\n$$G_{ss} = g_L + g_h(m_0 + s(V_0 - E_h))$$\n因此，稳态输入电阻为：\n$$R_{in} = \\frac{1}{g_L + g_h(m_0 + s(V_0 - E_h))}$$\n\n接下来，我们推导归一化下垂幅度 $S_A$。这需要找到初始峰值电压偏转 $\\Delta V_{peak}$ 和稳态电压偏转 $\\Delta V_{ss}$。\n稳态偏转为 $\\Delta V_{ss} = V_{ss} - V_0 = I_0 \\cdot R_{in} = I_0 / G_{ss}$。\n初始峰值偏转 $\\Delta V_{peak}$ 发生在 $t=0^+$，即电流阶跃施加后立即发生。在这一瞬间，电压可以改变，但门控变量 $m$ 还没有时间反应，因此它保持在刺激前的值 $m=m_0$。此时细胞膜的有效电导是“瞬时”电导 $G_{inst}$：\n$$G_{inst} = g_L + g_h m_0$$\n初始电压偏转由欧姆定律和这个瞬时电导给出：\n$$\\Delta V_{peak} = V(0^+) - V_0 = I_0 / G_{inst}$$\n下垂幅度 $S_A$ 定义为 $\\frac{|\\Delta V_{peak} - \\Delta V_{ss}|}{|\\Delta V_{peak}|}$。由于 $I_0  0$，两个偏转都是负的。下垂现象意味着初始超极化的幅度大于稳态超极化的幅度，即 $|\\Delta V_{peak}| > |\\Delta V_{ss}|$。\n$$S_A = \\frac{|\\Delta V_{peak}| - |\\Delta V_{ss}|}{|\\Delta V_{peak}|} = 1 - \\frac{|\\Delta V_{ss}|}{|\\Delta V_{peak}|}$$\n代入偏转的表达式：\n$$S_A = 1 - \\frac{|I_0 / G_{ss}|}{|I_0 / G_{inst}|} = 1 - \\frac{G_{inst}}{G_{ss}}$$\n代入电导的表达式：\n$$S_A = 1 - \\frac{g_L + g_h m_0}{g_L + g_h(m_0 + s(V_0 - E_h))} = \\frac{g_L + g_h m_0 + g_h s(V_0 - E_h) - (g_L + g_h m_0)}{g_L + g_h(m_0 + s(V_0 - E_h))}$$\n$$S_A = \\frac{g_h s(V_0 - E_h)}{g_L + g_h(m_0 + s(V_0 - E_h))}$$\n\n### 数值计算\n\n我们现在计算 $R_{in}$ 和 $S_A$ 的基线值和新值。\n下垂的驱动项是 $s(V_0 - E_h) = (-0.03\\,\\mathrm{mV}^{-1}) \\times ((-65\\,\\mathrm{mV}) - (-45\\,\\mathrm{mV})) = (-0.03) \\times (-20) = 0.6$。这是一个无量纲量。\n\n**基线计算 ($g_h = 5\\,\\mathrm{nS}$):**\n稳态电导为：\n$$G_{ss,base} = g_L + g_h(m_0 + s(V_0 - E_h))$$\n$$G_{ss,base} = 10\\,\\mathrm{nS} + 5\\,\\mathrm{nS} \\times (0.2 + 0.6) = 10\\,\\mathrm{nS} + 5\\,\\mathrm{nS} \\times 0.8 = 10\\,\\mathrm{nS} + 4\\,\\mathrm{nS} = 14\\,\\mathrm{nS}$$\n所以，$R_{in,base} = \\frac{1}{14\\,\\mathrm{nS}}$。\n基线下垂幅度为：\n$$S_{A,base} = \\frac{g_h s(V_0 - E_h)}{G_{ss,base}} = \\frac{5\\,\\mathrm{nS} \\times 0.6}{14\\,\\mathrm{nS}} = \\frac{3}{14}$$\n\n**新计算（$g_h$ 增加 $40\\%$）：**\n新的 HCN 电导是 $g_{h,new} = g_h \\times (1+0.40) = 5\\,\\mathrm{nS} \\times 1.4 = 7\\,\\mathrm{nS}$。\n新的稳态电导为：\n$$G_{ss,new} = g_L + g_{h,new}(m_0 + s(V_0 - E_h))$$\n$$G_{ss,new} = 10\\,\\mathrm{nS} + 7\\,\\mathrm{nS} \\times (0.2 + 0.6) = 10\\,\\mathrm{nS} + 7\\,\\mathrm{nS} \\times 0.8 = 10\\,\\mathrm{nS} + 5.6\\,\\mathrm{nS} = 15.6\\,\\mathrm{nS}$$\n所以，$R_{in,new} = \\frac{1}{15.6\\,\\mathrm{nS}}$。\n新的下垂幅度为：\n$$S_{A,new} = \\frac{g_{h,new} s(V_0 - E_h)}{G_{ss,new}} = \\frac{7\\,\\mathrm{nS} \\times 0.6}{15.6\\,\\mathrm{nS}} = \\frac{4.2}{15.6} = \\frac{42}{156} = \\frac{7}{26}$$\n\n**倍数变化因子：**\n\n1.  **输入电阻变化因子：**\n    $$\\frac{R_{in,new}}{R_{in,base}} = \\frac{1/G_{ss,new}}{1/G_{ss,base}} = \\frac{G_{ss,base}}{G_{ss,new}} = \\frac{14\\,\\mathrm{nS}}{15.6\\,\\mathrm{nS}} = \\frac{14}{15.6} = \\frac{140}{156} = \\frac{35}{39}$$\n    数值上，这是 $\\frac{35}{39} \\approx 0.89743589...$。四舍五入到四位有效数字，得到 $0.8974$。\n\n2.  **下垂幅度变化因子：**\n    $$\\frac{S_{A,new}}{S_{A,base}} = \\frac{7/26}{3/14} = \\frac{7}{26} \\times \\frac{14}{3} = \\frac{7 \\times (2 \\times 7)}{ (2 \\times 13) \\times 3} = \\frac{49}{39}$$\n    数值上，这是 $\\frac{49}{39} \\approx 1.25641025...$。四舍五入到四位有效数字，得到 $1.256$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8974  1.256\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后，我们将通过一项综合性模拟任务，将前面学到的概念融会贯通。这项实践要求我们构建一个完整的电导模型，以探究神经调控如何改变神经元的计算特性。具体来说，我们将模拟胆碱能系统对M电流（$I_M$）的抑制作用，并量化这种内在可塑性如何影响神经元的频率-电流（f-I）增益和发放模式，从而架起从离子通道动力学到神经元信息处理功能的桥梁。",
            "id": "4014311",
            "problem": "本题要求您实现并分析一个单室电导神经元模型，以量化胆碱能对毒蕈碱M型钾电流 ($I_M$) 的抑制如何改变频率-电流 (f-I) 增益和簇放电的可能性。该模型必须是 Hodgkin–Huxley 形式体系的一个具有物理意义的实例，使用 Morris–Lecar 电压门控钙和钾电流，并额外增加一个缓慢的 $I_M$ 电流。核心的膜动力学由标准的电流平衡定律和一阶门控动力学定义。\n\n模型规格：\n- 膜电位 $V$ 遵循电流平衡方程\n$$\nC \\frac{dV}{dt} = -\\left(I_L + I_{\\mathrm{Ca}} + I_{\\mathrm{K}} + I_M\\right) + I_{\\mathrm{app}}(t) + I_{\\mathrm{noise}}(t),\n$$\n其中 $C$ 是电容，$I_L$ 是漏电流，$I_{\\mathrm{Ca}}$ 是电压门控钙电流，$I_{\\mathrm{K}}$ 是延迟整流钾电流，$I_M$ 是毒蕈碱M型钾电流，$I_{\\mathrm{app}}(t)$ 是外部施加的电流，$I_{\\mathrm{noise}}(t)$ 是一个加性噪声电流。\n- 电流由带有电压依赖性激活的欧姆定律给出：\n$$\nI_L = g_L \\left(V - E_L\\right), \\quad I_{\\mathrm{Ca}} = g_{\\mathrm{Ca}} m_{\\infty}(V)\\left(V - E_{\\mathrm{Ca}}\\right), \\quad I_{\\mathrm{K}} = g_{\\mathrm{K}} w \\left(V - E_{\\mathrm{K}}\\right), \\quad I_M = g_M q \\left(V - E_{\\mathrm{K}}\\right),\n$$\n其中 $g_L$、$g_{\\mathrm{Ca}}$、$g_{\\mathrm{K}}$ 和 $g_M$ 是电导，$E_L$、$E_{\\mathrm{Ca}}$ 和 $E_{\\mathrm{K}}$ 是反转电位，$w$ 是延迟整流激活变量，$q$ 是M电流激活变量。\n- 稳态激活和动力学为\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right],\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right], \\quad \\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)},\n$$\n$$\n\\frac{dw}{dt} = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)},\n$$\n对于M电流激活\n$$\nq_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_{M,\\mathrm{half}}}{k_M}\\right)\\right], \\quad \\frac{dq}{dt} = \\frac{q_{\\infty}(V) - q}{\\tau_M}.\n$$\n\n物理单位与参数：\n- 使用 $V$（毫伏，$\\mathrm{mV}$），时间 $t$（毫秒，$\\mathrm{ms}$），电导 $g$（微西门子，$\\mathrm{\\mu S}$），电容 $C$（纳法拉，$\\mathrm{nF}$），电流 $I$（纳安，$\\mathrm{nA}$）。这些单位选择确保当 $g$ 以微西门子、$V - E$ 以毫伏为单位时，$I = g \\cdot (V - E)$ 产生纳安培；当 $C$ 以纳法拉、$\\frac{dV}{dt}$ 以 $\\mathrm{mV}/\\mathrm{ms}$ 为单位时，$C \\frac{dV}{dt}$ 产生纳安培。\n- 使用以下固定参数：\n  - $C = 0.2$,\n  - $g_L = 2.0$, $E_L = -60.0$,\n  - $g_{\\mathrm{Ca}} = 4.0$, $E_{\\mathrm{Ca}} = 120.0$,\n  - $g_{\\mathrm{K}} = 8.0$, $E_{\\mathrm{K}} = -84.0$,\n  - $V_1 = -1.2$, $V_2 = 18.0$, $V_3 = 2.0$, $V_4 = 30.0$,\n  - $\\phi = 0.04$,\n  - $V_{M,\\mathrm{half}} = -35.0$, $k_M = 10.0$, $\\tau_M = 50.0$。\n- 模拟必须使用固定时间步长 $\\Delta t = 0.1$ 和欧拉方法进行数值积分。初始化 $V(0) = E_L$，$w(0) = w_{\\infty}(E_L)$ 和 $q(0) = q_{\\infty}(E_L)$。\n\n计算输出的定义：\n- 将尖峰检测定义为在 $V_{\\mathrm{th}} = 0.0$ 处向上穿越阈值。从低于 $V_{\\mathrm{th}}$ 穿越到高于 $V_{\\mathrm{th}}$ 计为一个尖峰。\n- 将放电频率（单位赫兹）定义为尖峰数量除以测量窗口持续时间（单位秒）。对于f-I测量，舍弃前 $500.0$ 毫秒作为瞬态，并在剩余的模拟时间内进行测量。\n- 将簇放电检测定义为存在至少一对尖峰，其尖峰间隔小于 $100.0$ 毫秒。如果在模拟窗口期间存在这样的一对，则该试验被分类为簇放电。\n\n胆碱能抑制操作：\n- 胆碱能抑制被建模为最大M电流电导从基线 $g_M$ 减少到 $g_M' = \\max(0, g_M - \\Delta g_M)$，其中 $\\Delta g_M \\ge 0$ 由每个测试用例指定。\n\n各测试用例所需计算：\n1. 计算基线 $g_M$ 和受抑制 $g_M'$ 下的f-I增益 $G$，作为放电频率 $f$ 对五个恒定施加电流 $I_{\\mathrm{app}} \\in \\{0.10, 0.15, 0.20, 0.25, 0.30\\}$ 纳安培的最佳拟合线的斜率，每个电流在零噪声下模拟 $1500.0$ 毫秒。使用最小二乘线性回归估计斜率。报告增益漂移 $\\Delta G = G(g_M') - G(g_M)$，单位为 $\\mathrm{Hz}/\\mathrm{nA}$。\n2. 在固定电流 $I_{\\mathrm{app}} = 0.22$ 纳安培下，对基线 $g_M$ 和受抑制 $g_M'$ 估计簇放电概率。通过 $N_{\\mathrm{trials}}$ 个独立试验进行，每个试验持续 $1000.0$ 毫秒，并加入标准差为 $\\sigma_{\\mathrm{noise}}$ 纳安培的加性高斯噪声 $I_{\\mathrm{noise}}(t)$。使用固定的随机种子以保证可复现性。计算簇放电概率的增加 $\\Delta P = P(g_M') - P(g_M)$，以小数形式表示。\n\n测试套件：\n- 使用以下三个测试用例，每个都是一个元组 $(g_M, \\Delta g_M, \\sigma_{\\mathrm{noise}}, N_{\\mathrm{trials}})$：\n  1. $(2.0, 0.5, 0.02, 10)$,\n  2. $(2.0, 2.0, 0.01, 10)$,\n  3. $(2.0, 0.0, 0.03, 10)$。\n所有电导单位为 $\\mathrm{\\mu S}$，噪声单位为 $\\mathrm{nA}$，$N_{\\mathrm{trials}}$ 是一个整数。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出两个浮点数：增益漂移 $\\Delta G$（单位 $\\mathrm{Hz}/\\mathrm{nA}$）和簇放电概率增加 $\\Delta P$（以小数形式表示）。将所有测试用例的结果依次聚合，形成一个包含六个数字的扁平列表。例如，输出应具有以下形式：\n$[x_1,y_1,x_2,y_2,x_3,y_3]$\n其中每个 $x_i$ 和 $y_i$ 都是浮点数。以 $\\mathrm{Hz}/\\mathrm{nA}$ 表示 $\\Delta G$，以小数表示 $\\Delta P$。",
            "solution": "该问题要求实现和分析一个单室电导神经元模型，以研究胆碱能调制对神经元兴奋性的影响。胆碱能调制被建模为对一种缓慢的、非失活的钾电流——M型电流（$I_M$）的抑制。分析集中在两个关键的兴奋性指标上：频率-电流（f-I）曲线的增益和簇放电的概率。\n\n该模型是 Morris-Lecar 模型的一个变体，增加了一个M电流，其动力学由一组耦合的常微分方程（ODEs）控制，遵循 Hodgkin-Huxley 形式体系。\n\n首先，我们重申模型的完整数学公式。\n\n膜电位 $V(t)$ 由电流平衡方程描述：\n$$\nC \\frac{dV}{dt} = -I_{\\mathrm{ion}} + I_{\\mathrm{ext}}\n$$\n其中 $C$ 是膜电容，$I_{\\mathrm{ext}} = I_{\\mathrm{app}}(t) + I_{\\mathrm{noise}}(t)$ 是总外部电流，$I_{\\mathrm{ion}}$ 是所有离子电流的总和：\n$$\nI_{\\mathrm{ion}} = I_L + I_{\\mathrm{Ca}} + I_{\\mathrm{K}} + I_M\n$$\n各个电流定义如下：\n- 漏电流：$I_L = g_L (V - E_L)$\n- 电压门控钙电流：$I_{\\mathrm{Ca}} = g_{\\mathrm{Ca}} m_{\\infty}(V) (V - E_{\\mathrm{Ca}})$\n- 延迟整流钾电流：$I_K = g_K w (V - E_K)$\n- M型钾电流：$I_M = g_M q (V - E_K)$\n\n门控变量的动力学由一阶动力学描述。钙电流激活 $m$ 假定是瞬时的，$m(t) = m_{\\infty}(V(t))$，其稳态值由一个S型函数给出：\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right]\n$$\n延迟整流钾电流激活 $w$ 遵循：\n$$\n\\frac{dw}{dt} = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\n其稳态值和电压依赖性时间常数为：\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right]\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\nM电流激活 $q$ 具有较慢的动力学，由一个恒定的时间常数 $\\tau_M$ 控制：\n$$\n\\frac{dq}{dt} = \\frac{q_{\\infty}(V) - q}{\\tau_M}\n$$\n其稳态激活为：\n$$\nq_{\\infty}(V) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{V - V_{M,\\mathrm{half}}}{k_M}\\right)\\right]\n$$\n问题指定了所有参数值：$C=0.2\\,\\mathrm{nF}$, $g_L=2.0\\,\\mathrm{\\mu S}$, $E_L=-60.0\\,\\mathrm{mV}$, $g_{\\mathrm{Ca}}=4.0\\,\\mathrm{\\mu S}$, $E_{\\mathrm{Ca}}=120.0\\,\\mathrm{mV}$, $g_{\\mathrm{K}}=8.0\\,\\mathrm{\\mu S}$, $E_{\\mathrm{K}}=-84.0\\,\\mathrm{mV}$, $V_1=-1.2\\,\\mathrm{mV}$, $V_2=18.0\\,\\mathrm{mV}$, $V_3=2.0\\,\\mathrm{mV}$, $V_4=30.0\\,\\mathrm{mV}$, $\\phi=0.04$, $V_{M,\\mathrm{half}}=-35.0\\,\\mathrm{mV}$, $k_M=10.0\\,\\mathrm{mV}$, and $\\tau_M=50.0\\,\\mathrm{ms}$。\n\n该常微分方程组将使用前向欧拉方法进行数值求解，时间步长为 $\\Delta t = 0.1\\,\\mathrm{ms}$。状态变量 $(V, w, q)$ 从时间 $t$ 到 $t + \\Delta t$ 的离散更新规则是：\n$$\nV(t+\\Delta t) = V(t) + \\frac{\\Delta t}{C} \\left[ -I_L(t) - I_{\\mathrm{Ca}}(t) - I_{\\mathrm{K}}(t) - I_M(t) + I_{\\mathrm{app}}(t) + I_{\\mathrm{noise}}(t) \\right]\n$$\n$$\nw(t+\\Delta t) = w(t) + \\Delta t \\cdot \\phi \\frac{w_{\\infty}(V(t)) - w(t)}{\\tau_w(V(t))}\n$$\n$$\nq(t+\\Delta t) = q(t) + \\Delta t \\cdot \\frac{q_{\\infty}(V(t)) - q(t)}{\\tau_M}\n$$\n初始条件设置为静息状态：$V(0) = E_L$，$w(0) = w_{\\infty}(E_L)$ 和 $q(0) = q_{\\infty}(E_L)$。\n\n分析涉及对每个测试用例 $(g_M, \\Delta g_M, \\sigma_{\\mathrm{noise}}, N_{\\mathrm{trials}})$ 的两个主要计算：\n\n1.  **f-I增益漂移（$\\Delta G$）计算：**\n    f-I增益 $G$ 代表神经元放电频率对输入电流变化的敏感度。它通过对放电频率 $f$ 与一组恒定施加电流 $I_{\\mathrm{app}} \\in \\{0.10, 0.15, 0.20, 0.25, 0.30\\}\\,\\mathrm{nA}$ 进行线性回归，计算得到的斜率。对于这些模拟，不存在噪声（$I_{\\mathrm{noise}}(t) = 0$）。每次模拟运行 $1500.0\\,\\mathrm{ms}$。尖峰被检测为膜电位向上穿越阈值 $V_{\\mathrm{th}} = 0.0\\,\\mathrm{mV}$ 的事件。放电频率（单位赫兹）基于在 $t=500.0\\,\\mathrm{ms}$ 到 $t=1500.0\\,\\mathrm{ms}$ 的测量窗口内发生的尖峰计算，以排除初始瞬态。整个过程分别对基线M电流电导 $g_M$ 和受抑制电导 $g_M' = \\max(0, g_M - \\Delta g_M)$ 执行。最终报告的值是增益漂移 $\\Delta G = G(g_M') - G(g_M)$。一个正的 $\\Delta G$ 表示兴奋性增加。\n\n2.  **簇放电概率增加（$\\Delta P$）计算：**\n    簇放电是一种以高频尖峰簇（由静息期分隔）为特征的放电模式。在这里，如果任何尖峰间隔（ISI）小于 $100.0\\,\\mathrm{ms}$，则该试验被归类为包含簇放电。通过运行 $N_{\\mathrm{trials}}$ 次独立的模拟来估计簇放电概率 $P$，每次模拟持续 $1000.0\\,\\mathrm{ms}$，在固定的输入电流 $I_{\\mathrm{app}} = 0.22\\,\\mathrm{nA}$ 下进行。这些模拟包含一个加性高斯白噪声项 $I_{\\mathrm{noise}}(t)$，其标准差为 $\\sigma_{\\mathrm{noise}}\\cdot\\sqrt{1/\\Delta t}$，以确保注入电流的总方差与时间步长无关。概率 $P$ 是表现出簇放电的试验所占的比例。此估计针对 $g_M$ 和 $g_M'$ 进行，感兴趣的指标是簇放电概率的增加 $\\Delta P = P(g_M') - P(g_M)$。为保证可复现性，噪声生成过程使用固定的随机种子。\n\n实现将包括一个主模拟函数，该函数根据欧拉更新规则演化状态变量。这个函数将被两个更高级别的分析函数调用，一个用于计算 $\\Delta G$，另一个用于计算 $\\Delta P$。主脚本将遍历所提供的测试用例，执行这些分析，并按指定格式化结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the neuron model simulations and analyses for all test cases.\n    \"\"\"\n    # Fixed model parameters\n    C = 0.2  # nF\n    G_L = 2.0  # µS\n    E_L = -60.0  # mV\n    G_CA = 4.0  # µS\n    E_CA = 120.0  # mV\n    G_K = 8.0  # µS\n    E_K = -84.0  # mV\n    V1 = -1.2  # mV\n    V2 = 18.0  # mV\n    V3 = 2.0  # mV\n    V4 = 30.0  # mV\n    PHI = 0.04\n    V_M_HALF = -35.0  # mV\n    K_M = 10.0  # mV\n    TAU_M = 50.0  # ms\n    V_TH = 0.0  # mV\n    DT = 0.1  # ms\n\n    # Pre-define activation functions for efficiency\n    def m_inf(v):\n        return 0.5 * (1.0 + np.tanh((v - V1) / V2))\n\n    def w_inf(v):\n        return 0.5 * (1.0 + np.tanh((v - V3) / V4))\n\n    def tau_w(v):\n        return 1.0 / np.cosh((v - V3) / (2.0 * V4))\n\n    def q_inf(v):\n        return 0.5 * (1.0 + np.tanh((v - V_M_HALF) / K_M))\n\n    def run_simulation(g_m, i_app, t_sim, sigma_noise=0.0):\n        \"\"\"\n        Runs a single trial of the neuron model simulation.\n        \"\"\"\n        num_steps = int(t_sim / DT)\n        t = np.linspace(0, t_sim, num_steps + 1)\n        v = np.zeros(num_steps + 1)\n        w = np.zeros(num_steps + 1)\n        q = np.zeros(num_steps + 1)\n\n        # Initial conditions\n        v[0] = E_L\n        w[0] = w_inf(v[0])\n        q[0] = q_inf(v[0])\n\n        # Noise term scaling:\n        # The noise I_noise(t) is additive white Gaussian noise. In a discrete simulation,\n        # we generate random numbers from N(0, sigma_noise). To make the variance\n        # of the integrated noise independent of dt, the noise term should be\n        # scaled by 1/sqrt(dt). So the current noise is N(0, sigma_noise^2 * (1/dt)).\n        noise_std_scaled = sigma_noise * np.sqrt(1.0 / DT)\n        noise = np.random.normal(0, noise_std_scaled, num_steps) if sigma_noise > 0 else np.zeros(num_steps)\n\n        for i in range(num_steps):\n            i_l = G_L * (v[i] - E_L)\n            i_ca = G_CA * m_inf(v[i]) * (v[i] - E_CA)\n            i_k = G_K * w[i] * (v[i] - E_K)\n            i_m = g_m * q[i] * (v[i] - E_K)\n            \n            i_total = -i_l - i_ca - i_k - i_m + i_app + noise[i]\n\n            v[i + 1] = v[i] + (DT / C) * i_total\n            w[i + 1] = w[i] + DT * PHI * (w_inf(v[i]) - w[i]) / tau_w(v[i])\n            q[i + 1] = q[i] + DT * (q_inf(v[i]) - q[i]) / TAU_M\n\n        spikes = (v[:-1]  V_TH)  (v[1:] >= V_TH)\n        spike_times = t[1:][spikes]\n        \n        return spike_times\n\n    def calculate_fi_gain(g_m):\n        \"\"\"\n        Calculates the f-I gain for a given M-current conductance.\n        \"\"\"\n        i_app_values = np.array([0.10, 0.15, 0.20, 0.25, 0.30])\n        rates = []\n        t_sim = 1500.0\n        t_transient = 500.0\n        \n        for i_app in i_app_values:\n            spike_times = run_simulation(g_m, i_app, t_sim, sigma_noise=0.0)\n            spikes_in_window = np.sum(spike_times > t_transient)\n            duration_s = (t_sim - t_transient) / 1000.0\n            rates.append(spikes_in_window / duration_s)\n        \n        rates = np.array(rates)\n        \n        # Linear regression using numpy.linalg.lstsq\n        A = np.vstack([i_app_values, np.ones(len(i_app_values))]).T\n        slope, _ = np.linalg.lstsq(A, rates, rcond=None)[0]\n        \n        return slope\n\n    def estimate_burst_prob(g_m, sigma_noise, n_trials):\n        \"\"\"\n        Estimates the burst probability for a given M-current conductance and noise level.\n        \"\"\"\n        i_app_fixed = 0.22\n        t_sim = 1000.0\n        burst_count = 0\n        min_isi_for_burst = 100.0\n        \n        for _ in range(n_trials):\n            spike_times = run_simulation(g_m, i_app_fixed, t_sim, sigma_noise=sigma_noise)\n            if len(spike_times) >= 2:\n                isis = np.diff(spike_times)\n                if np.any(isis  min_isi_for_burst):\n                    burst_count += 1\n        \n        return burst_count / n_trials\n\n    # Test suite from problem statement\n    test_cases = [\n        (2.0, 0.5, 0.02, 10),\n        (2.0, 2.0, 0.01, 10),\n        (2.0, 0.0, 0.03, 10),\n    ]\n\n    all_results = []\n    \n    # Set a global seed for reproducibility of the entire script\n    np.random.seed(42)\n\n    for g_m_base, delta_g_m, sigma_noise, n_trials in test_cases:\n        g_m_suppressed = max(0, g_m_base - delta_g_m)\n\n        # --- 1. Calculate f-I Gain Shift (Delta G) ---\n        gain_base = calculate_fi_gain(g_m_base)\n        gain_suppressed = calculate_fi_gain(g_m_suppressed)\n        delta_g = gain_suppressed - gain_base\n        all_results.append(delta_g)\n\n        # --- 2. Estimate Burst Probability Increase (Delta P) ---\n        prob_base = estimate_burst_prob(g_m_base, sigma_noise, n_trials)\n        prob_suppressed = estimate_burst_prob(g_m_suppressed, sigma_noise, n_trials)\n        delta_p = prob_suppressed - prob_base\n        all_results.append(delta_p)\n\n    # Print output in the required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}