{
    "hands_on_practices": [
        {
            "introduction": "This practice explores the foundational \"energy model,\" a cornerstone for understanding how complex cells in the visual cortex can become selective for orientation. By analytically deriving the response of a model neuron with a symmetric receptive field, you will uncover a deep principle: how kernel structure dictates function. This exercise demonstrates why a neuron can be sharply tuned for orientation while remaining completely insensitive to the direction of motion .",
            "id": "3999525",
            "problem": "Consider a linear–quadratic neural model for motion processing in primary visual cortex in which the stimulus is a scalar spatiotemporal luminance pattern $s(\\mathbf{x}, t)$ and the neuron’s linear stage is characterized by a spatiotemporal kernel $k(\\mathbf{x}, t)$. The instantaneous linear drive is defined as $z(t) = \\int_{\\mathbb{R}^{2}} \\int_{\\mathbb{R}} k(\\mathbf{x}, \\tau)\\, s(\\mathbf{x}, t - \\tau)\\, d\\tau\\, d^{2}\\mathbf{x}$, and the observable response is the time average of the squared drive $R[s] = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} z(t)^{2}\\, dt$. This $R[s]$ defines the response functional $R[\\mathbf{s}(x,t)]$ precisely for this model. All angles are in radians.\n\nYou are given a separable, even-symmetric kernel\n$$\nk(\\mathbf{x}, t) = k_{x}(x)\\, k_{y}(y)\\, k_{t}(t), \\quad k_{x}(x) = \\cos(k_{0} x)\\, \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_{x}^{2}}\\right), \\quad k_{y}(y) = \\exp\\!\\left(-\\frac{y^{2}}{2\\sigma_{y}^{2}}\\right), \\quad k_{t}(t) = \\exp\\!\\left(-\\frac{t^{2}}{2\\Delta^{2}}\\right),\n$$\nwith $k_{0} > 0$, $\\sigma_{x} > 0$, $\\sigma_{y} > 0$, and $\\Delta > 0$. Consider two drifting sinusoidal gratings of identical spatial frequency $k_{0}$ and temporal frequency $\\omega > 0$:\n$$\ns_{\\mathrm{pref}}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x - \\omega t), \\qquad s_{\\mathrm{null}}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x + \\omega t),\n$$\nwhere $A > 0$ is the contrast amplitude. Let $R_{\\mathrm{pref}} = R[s_{\\mathrm{pref}}]$ and $R_{\\mathrm{null}} = R[s_{\\mathrm{null}}]$, and define the Direction Selectivity Index (DSI) by\n$$\n\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}.\n$$\n\nTasks:\n- Starting from the above model definitions, derive closed-form expressions for $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$ for the given kernel and stimuli. Your derivation must begin from the stated response functional and use only standard properties of convolution, even symmetry, and time averaging of sinusoids. Do not assume any special “shortcut” motion formulas.\n- Compute the resulting Direction Selectivity Index. Express your final DSI value as an exact number; no rounding is required. The DSI is dimensionless.\n- In addition, provide a principled derivation, based on the same model, explaining how orientation selectivity can be high while direction selectivity is zero. Concretely, analyze the responses $R_{\\parallel}$ and $R_{\\perp}$ to two gratings of identical $k_{0}$ and $\\omega$: one whose orientation is aligned with the kernel’s $x$-axis, $s_{\\parallel}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x - \\omega t)$, and one orthogonal to it, $s_{\\perp}(\\mathbf{x}, t) = A\\, \\cos(k_{0} y - \\omega t)$. Show algebraically how the Orientation Selectivity Index (OSI), defined by $\\mathrm{OSI} = \\frac{R_{\\parallel} - R_{\\perp}}{R_{\\parallel} + R_{\\perp}}$, can approach $1$ (i.e., high orientation selectivity) for appropriate parameter regimes even when $\\mathrm{DSI} = 0$.\n\nGive the DSI as your final answer. No units are required for the final answer.",
            "solution": "The problem will be validated and, if valid, solved in three parts as requested: first, the derivation of the responses $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$ to compute the Direction Selectivity Index (DSI); second, the final calculation of the DSI; third, a principled derivation explaining how high orientation selectivity (OSI $\\approx 1$) can coexist with zero direction selectivity (DSI $= 0$) within this model framework.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Model:** Linear-quadratic neural model.\n- **Stimulus:** $s(\\mathbf{x}, t)$, a scalar spatiotemporal luminance pattern.\n- **Kernel:** $k(\\mathbf{x}, t)$, a spatiotemporal kernel.\n- **Linear Drive:** $z(t) = \\int_{\\mathbb{R}^{2}} \\int_{\\mathbb{R}} k(\\mathbf{x}, \\tau)\\, s(\\mathbf{x}, t - \\tau)\\, d\\tau\\, d^{2}\\mathbf{x}$.\n- **Response Functional:** $R[s] = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} z(t)^{2}\\, dt$.\n- **Specific Kernel:** A separable, even-symmetric kernel $k(\\mathbf{x}, t) = k_{x}(x)\\, k_{y}(y)\\, k_{t}(t)$, where:\n  - $k_{x}(x) = \\cos(k_{0} x)\\, \\exp(-\\frac{x^{2}}{2\\sigma_{x}^{2}})$\n  - $k_{y}(y) = \\exp(-\\frac{y^{2}}{2\\sigma_{y}^{2}})$\n  - $k_{t}(t) = \\exp(-\\frac{t^{2}}{2\\Delta^{2}})$\n- **Kernel Parameters:** $k_{0} > 0$, $\\sigma_{x} > 0$, $\\sigma_{y} > 0$, $\\Delta > 0$.\n- **Stimuli for DSI:** Drifting sinusoidal gratings with spatial frequency $k_{0}$ and temporal frequency $\\omega > 0$.\n  - $s_{\\mathrm{pref}}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x - \\omega t)$, with amplitude $A > 0$.\n  - $s_{\\mathrm{null}}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x + \\omega t)$.\n- **Responses for DSI:** $R_{\\mathrm{pref}} = R[s_{\\mathrm{pref}}]$ and $R_{\\mathrm{null}} = R[s_{\\mathrm{null}}]$.\n- **DSI Definition:** $\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}$.\n- **Stimuli for OSI:**\n  - $s_{\\parallel}(\\mathbf{x}, t) = A\\, \\cos(k_{0} x - \\omega t)$ (aligned).\n  - $s_{\\perp}(\\mathbf{x}, t) = A\\, \\cos(k_{0} y - \\omega t)$ (orthogonal).\n- **Responses for OSI:** $R_{\\parallel} = R[s_{\\parallel}]$ and $R_{\\perp} = R[s_{\\perp}]$.\n- **OSI Definition:** $\\mathrm{OSI} = \\frac{R_{\\parallel} - R_{\\perp}}{R_{\\parallel} + R_{\\perp}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a simplified energy model (a linear-quadratic model), which is a canonical model in computational neuroscience for explaining response properties of V1 complex cells, such as direction and orientation selectivity. The use of Gabor-like filters and sinusoidal grating stimuli is standard methodology in the field. The model is scientifically sound.\n- **Well-Posed:** The problem is mathematically well-defined. All required functions, parameters, and definitions are provided. The calculations are standard applications of linear systems theory and Fourier analysis, which will lead to a unique and meaningful result.\n- **Objective:** The language is formal, mathematical, and free of any subjective or ambiguous statements.\n- **Flaw Checklist:** The problem does not violate any of the specified criteria for invalidity. It is scientifically sound, formal, complete, realistic within the modeling context, and well-posed.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n### Derivation of Responses and DSI\n\nThe linear drive $z(t)$ is the result of a spatiotemporal convolution of the kernel $k(\\mathbf{x}, t)$ and the stimulus $s(\\mathbf{x}, t)$, with the spatial dimensions subsequently integrated out. We will analyze the response to a general complex exponential stimulus and then use superposition.\n\nLet the stimulus be of the form $s(\\mathbf{x}, t) = \\exp(i(k_x x + k_y y - \\Omega t))$. The corresponding complex linear drive $\\tilde{z}(t)$ is:\n$$\n\\tilde{z}(t) = \\int_{\\mathbb{R}^2}\\int_{\\mathbb{R}} k(\\mathbf{x}', \\tau) \\exp(i(k_x x' + k_y y' - \\Omega (t-\\tau))) \\, d\\tau \\, d^2\\mathbf{x}'\n$$\n$$\n\\tilde{z}(t) = \\exp(-i\\Omega t) \\int_{\\mathbb{R}^2}\\int_{\\mathbb{R}} k(\\mathbf{x}', \\tau) \\exp(i(k_x x' + k_y y' + \\Omega \\tau)) \\, d\\tau \\, d^2\\mathbf{x}'\n$$\nThe integral term is the spatiotemporal Fourier transform of the kernel, $\\hat{k}(k_x, k_y, \\Omega) = \\int k(\\mathbf{x},t) \\exp(-i(k_x x + k_y y + \\Omega t)) d^2\\mathbf{x} dt$. The integral in the expression for $\\tilde{z}(t)$ is thus $\\hat{k}(-k_x, -k_y, -\\Omega)$.\n$$\n\\tilde{z}(t) = \\hat{k}(-k_x, -k_y, -\\Omega) \\exp(-i\\Omega t)\n$$\nSince the kernel $k(\\mathbf{x}, t) = k_x(x)k_y(y)k_t(t)$ is a product of real, even functions, its Fourier transform $\\hat{k}(k_x, k_y, \\Omega) = \\hat{k}_x(k_x)\\hat{k}_y(k_y)\\hat{k}_t(\\Omega)$ is also real and even. Therefore, $\\hat{k}(-k_x, -k_y, -\\Omega) = \\hat{k}(k_x, k_y, \\Omega)$. The response to a complex exponential is $\\tilde{z}(t) = \\hat{k}(k_x, k_y, \\Omega) \\exp(-i\\Omega t)$.\n\n**1. Response to Preferred Direction Stimulus, $s_{\\mathrm{pref}}$**\nThe stimulus is $s_{\\mathrm{pref}}(\\mathbf{x}, t) = A \\cos(k_{0} x - \\omega t) = \\frac{A}{2} \\left( e^{i(k_0 x - \\omega t)} + e^{-i(k_0 x - \\omega t)} \\right)$.\nUsing linearity, the drive $z_{\\mathrm{pref}}(t)$ is the sum of responses to the two complex exponential components.\n- For the component $e^{i(k_0 x - \\omega t)}$, we have $k_x = k_0$, $k_y = 0$, $\\Omega = \\omega$. The complex drive is $\\hat{k}(k_0, 0, \\omega) e^{-i\\omega t}$.\n- For the component $e^{-i(k_0 x - \\omega t)} = e^{i(-k_0 x + \\omega t)}$, we have $k_x = -k_0$, $k_y = 0$, $\\Omega = -\\omega$. The complex drive is $\\hat{k}(-k_0, 0, -\\omega) e^{i\\omega t}$.\n\nThe total drive is:\n$$\nz_{\\mathrm{pref}}(t) = \\frac{A}{2} \\left( \\hat{k}(k_0, 0, \\omega) e^{-i\\omega t} + \\hat{k}(-k_0, 0, -\\omega) e^{i\\omega t} \\right)\n$$\nAs established, since $k(\\mathbf{x},t)$ is real and even, its Fourier transform $\\hat{k}(k_x,k_y,\\Omega)$ is also real and even. Thus, $\\hat{k}(-k_0, 0, -\\omega) = \\hat{k}(k_0, 0, \\omega)$. Let this real-valued transfer function magnitude be denoted by $H_{\\mathrm{pref}} = \\hat{k}(k_0, 0, \\omega) = \\hat{k}_x(k_0)\\hat{k}_y(0)\\hat{k}_t(\\omega)$.\n$$\nz_{\\mathrm{pref}}(t) = \\frac{A}{2} H_{\\mathrm{pref}} (e^{-i\\omega t} + e^{i\\omega t}) = A H_{\\mathrm{pref}} \\cos(\\omega t)\n$$\nThe response $R_{\\mathrm{pref}}$ is the time-average of $z_{\\mathrm{pref}}(t)^2$:\n$$\nR_{\\mathrm{pref}} = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} (A H_{\\mathrm{pref}} \\cos(\\omega t))^2 dt = A^2 H_{\\mathrm{pref}}^2 \\langle \\cos^2(\\omega t) \\rangle\n$$\nThe time-average of $\\cos^2(\\omega t)$ over an infinite interval is $\\frac{1}{2}$.\n$$\nR_{\\mathrm{pref}} = \\frac{1}{2} A^2 H_{\\mathrm{pref}}^2 = \\frac{1}{2} A^2 (\\hat{k}_x(k_0) \\hat{k}_y(0) \\hat{k}_t(\\omega))^2\n$$\n\n**2. Response to Null Direction Stimulus, $s_{\\mathrm{null}}$**\nThe stimulus is $s_{\\mathrm{null}}(\\mathbf{x}, t) = A \\cos(k_0 x + \\omega t) = \\frac{A}{2} \\left( e^{i(k_0 x + \\omega t)} + e^{-i(k_0 x + \\omega t)} \\right)$.\n- For the component $e^{i(k_0 x + \\omega t)}$, we have $k_x = k_0$, $k_y = 0$, $\\Omega = -\\omega$. The complex drive is $\\hat{k}(k_0, 0, -\\omega) e^{i\\omega t}$.\n- For the component $e^{-i(k_0 x + \\omega t)}$, we have $k_x = -k_0$, $k_y = 0$, $\\Omega = \\omega$. The complex drive is $\\hat{k}(-k_0, 0, \\omega) e^{-i\\omega t}$.\n\nThe total drive is:\n$$\nz_{\\mathrm{null}}(t) = \\frac{A}{2} \\left( \\hat{k}(k_0, 0, -\\omega) e^{i\\omega t} + \\hat{k}(-k_0, 0, \\omega) e^{-i\\omega t} \\right)\n$$\nAgain, using the even symmetry of the real kernel, $\\hat{k}(k_0, 0, -\\omega) = \\hat{k}(k_0, 0, \\omega)$ and $\\hat{k}(-k_0, 0, \\omega) = \\hat{k}(k_0, 0, \\omega)$. Both equal $H_{\\mathrm{pref}}$.\n$$\nz_{\\mathrm{null}}(t) = \\frac{A}{2} H_{\\mathrm{pref}} (e^{i\\omega t} + e^{-i\\omega t}) = A H_{\\mathrm{pref}} \\cos(\\omega t)\n$$\nThis is identical to $z_{\\mathrm{pref}}(t)$. Therefore, the response $R_{\\mathrm{null}}$ is also identical:\n$$\nR_{\\mathrm{null}} = \\frac{1}{2} A^2 H_{\\mathrm{pref}}^2 = \\frac{1}{2} A^2 (\\hat{k}_x(k_0) \\hat{k}_y(0) \\hat{k}_t(\\omega))^2\n$$\n\n**3. Calculation of DSI**\nSince $R_{\\mathrm{pref}} = R_{\\mathrm{null}}$, their difference is zero.\n$$\n\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}} = \\frac{0}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}\n$$\nThe response $R_{\\mathrm{pref}}$ is non-zero as long as $A > 0$ and the kernel is not identically zero. Therefore, the denominator is non-zero.\n$$\n\\mathrm{DSI} = 0\n$$\nThe inability of the model to exhibit direction selectivity is a direct and necessary consequence of the spatiotemporal kernel $k(\\mathbf{x},t)$ being separable into a product of purely even functions, particularly the temporal kernel $k_t(t)$. A system with a time-symmetric impulse response cannot distinguish between a signal and its time-reversal, which is the relationship between the preferred and null stimuli.\n\n### Derivation of OSI and relation to DSI\n\nWe now analyze the responses to gratings with parallel and orthogonal orientations relative to the kernel's $x$-axis.\n\n**1. Response to Parallel Stimulus, $R_{\\parallel}$**\nThe parallel stimulus is $s_{\\parallel}(\\mathbf{x}, t) = A \\cos(k_0 x - \\omega t)$, which is identical to $s_{\\mathrm{pref}}$. Thus, its response is:\n$$\nR_{\\parallel} = R_{\\mathrm{pref}} = \\frac{1}{2} A^2 (\\hat{k}_x(k_0) \\hat{k}_y(0) \\hat{k}_t(\\omega))^2\n$$\n\n**2. Response to Orthogonal Stimulus, $R_{\\perp}$**\nThe orthogonal stimulus is $s_{\\perp}(\\mathbf{x}, t) = A \\cos(k_0 y - \\omega t)$. The same analysis method applies. The drive now depends on the kernel's Fourier transform at spatial frequency $(0, k_0)$ and temporal frequency $\\omega$.\n$$\nz_{\\perp}(t) = A H_{\\perp} \\cos(\\omega t)\n$$\nwhere $H_{\\perp} = \\hat{k}(0, k_0, \\omega) = \\hat{k}_x(0)\\hat{k}_y(k_0)\\hat{k}_t(\\omega)$.\nThe response is:\n$$\nR_{\\perp} = \\frac{1}{2} A^2 H_{\\perp}^2 = \\frac{1}{2} A^2 (\\hat{k}_x(0) \\hat{k}_y(k_0) \\hat{k}_t(\\omega))^2\n$$\n\n**3. Calculation of OSI**\nThe Orientation Selectivity Index is:\n$$\n\\mathrm{OSI} = \\frac{R_{\\parallel} - R_{\\perp}}{R_{\\parallel} + R_{\\perp}} = \\frac{(\\hat{k}_x(k_0) \\hat{k}_y(0) \\hat{k}_t(\\omega))^2 - (\\hat{k}_x(0) \\hat{k}_y(k_0) \\hat{k}_t(\\omega))^2}{(\\hat{k}_x(k_0) \\hat{k}_y(0) \\hat{k}_t(\\omega))^2 + (\\hat{k}_x(0) \\hat{k}_y(k_0) \\hat{k}_t(\\omega))^2}\n$$\nThe common factor $(\\frac{1}{2}A^2)^2 (\\hat{k}_t(\\omega))^4$ cancels. Let's define a ratio $\\rho = \\frac{R_{\\perp}}{R_{\\parallel}} = \\frac{(\\hat{k}_x(0) \\hat{k}_y(k_0))^2}{(\\hat{k}_x(k_0) \\hat{k}_y(0))^2}$. Then $\\mathrm{OSI} = \\frac{1-\\rho}{1+\\rho}$. High orientation selectivity (OSI $\\to 1$) occurs when $\\rho \\to 0$, which means $R_{\\perp} \\ll R_{\\parallel}$.\n\nTo show this is possible, we examine the ratio $\\rho$. This requires evaluating the specific Fourier transforms. The Fourier transform of a Gaussian $g(x) = \\exp(-x^2/(2\\sigma^2))$ is $\\hat{g}(k) = \\sigma\\sqrt{2\\pi}\\exp(-k^2\\sigma^2/2)$.\n- $\\hat{k}_y(k_0) = \\sigma_y\\sqrt{2\\pi}\\exp(-k_0^2\\sigma_y^2/2)$.\n- $\\hat{k}_y(0) = \\sigma_y\\sqrt{2\\pi}$.\n\nSo, $\\frac{\\hat{k}_y(k_0)}{\\hat{k}_y(0)} = \\exp(-k_0^2\\sigma_y^2/2)$.\n\n- $\\hat{k}_x(0) = \\mathcal{F}[\\cos(k_0 x)\\exp(-\\frac{x^2}{2\\sigma_x^2})]|_{k=0} = \\int \\cos(k_0 x)\\exp(-\\frac{x^2}{2\\sigma_x^2}) dx$. This evaluates to $\\sigma_x\\sqrt{2\\pi}\\exp(-k_0^2\\sigma_x^2/2)$.\n- $\\hat{k}_x(k_0)$. A more involved calculation gives $\\hat{k}_x(k_0) = \\frac{\\sigma_x\\sqrt{2\\pi}}{2}(1+\\exp(-2k_0^2\\sigma_x^2))$.\n\nThe ratio of responses is:\n$$\n\\rho = \\frac{R_{\\perp}}{R_{\\parallel}} = \\left( \\frac{\\hat{k}_x(0)}{\\hat{k}_x(k_0)} \\frac{\\hat{k}_y(k_0)}{\\hat{k}_y(0)} \\right)^2 = \\left( \\frac{\\sigma_x\\sqrt{2\\pi}\\exp(-k_0^2\\sigma_x^2/2)}{\\frac{\\sigma_x\\sqrt{2\\pi}}{2}(1+\\exp(-2k_0^2\\sigma_x^2))} \\cdot \\exp(-k_0^2\\sigma_y^2/2) \\right)^2\n$$\n$$\n\\rho = \\left( \\frac{2\\exp(-k_0^2\\sigma_x^2/2)}{1+\\exp(-2k_0^2\\sigma_x^2)} \\cdot \\exp(-k_0^2\\sigma_y^2/2) \\right)^2\n$$\nHigh orientation selectivity (OSI $\\to 1$) can be achieved if $\\rho \\to 0$. We can achieve this by choosing parameters such that the ratio of responses becomes very small. For instance, consider the limit as $\\sigma_y \\to \\infty$. In this limit, the term $\\exp(-k_0^2\\sigma_y^2/2) \\to 0$. Consequently, $\\rho \\to 0$ and OSI $\\to 1$.\n\nPhysically, $\\sigma_y \\to \\infty$ means the kernel becomes infinitely elongated along the $y$-axis, i.e., $k_y(y) = \\exp(-y^2/(2\\sigma_y^2)) \\to 1$. Such a neuron is selective for stimuli with variations along the $x$-axis (e.g., vertical contours) but is completely insensitive to variations along the $y$-axis (e.g., horizontal contours). Thus, it responds strongly to $s_{\\parallel}$ but gives virtually no response to $s_{\\perp}$. This leads to OSI approaching $1$.\n\nCrucially, this condition for high orientation selectivity (large $\\sigma_y$) is independent of the temporal properties of the kernel. Therefore, it can coexist with the condition $\\mathrm{DSI}=0$ which arose from the temporal even symmetry of $k_t(t)$. This demonstrates how a neuron model can be highly orientation-selective while being completely non-direction-selective.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Once we can model a neuron's responses, we need robust methods to quantify its selectivity from experimental data. This practice delves into the definitions of the Orientation and Direction Selectivity Indices (OSI and DSI), revealing how they can be skewed by factors like baseline spontaneous firing rates. You will analyze these limitations and then derive improved, baseline-corrected metrics, a critical skill for performing rigorous analysis on neural recordings .",
            "id": "5049886",
            "problem": "A neuron in primary visual cortex is probed with drifting gratings to characterize its tuning for orientation and direction. Its orientation tuning across orientations is well-approximated by a second-harmonic cosine on the orientation circle: the response at orientation angle $\\theta \\in [0,\\pi)$ (radians) is $R(\\theta) = b + m \\cos\\!\\big(2(\\theta - \\theta_{0})\\big)$, where $b$ is the spontaneous (baseline) firing rate, $m$ is the modulation amplitude, and $\\theta_{0}$ is the preferred orientation. In a separate experiment focusing on direction (which is $2\\pi$-periodic), the neuron’s average responses to the preferred direction and the opposite (null) direction are measured as $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$, respectively. Assume the spontaneous rate $b$ reflects the mean activity in the absence of visual stimulation.\n\nUse foundational definitions from systems neuroscience, starting from the interpretation of orientation selectivity as the normalized second-harmonic “vector” of the orientation response distribution and direction selectivity as the normalized difference of responses to the preferred versus null directions. Without appealing to any pre-given shortcut formulas, reason from these definitions to:\n\n1. Derive how the spontaneous rate $b$ enters estimates of the Orientation Selectivity Index (OSI; Orientation Selectivity Index) computed from $R(\\theta)$ and the Direction Selectivity Index (DSI; Direction Selectivity Index) computed from $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$.\n2. Analyze the effect of subtracting the spontaneous rate from responses on the normalization in OSI and DSI, identifying any pathologies that arise if one naïvely subtracts $b$ from $R(\\theta)$.\n3. Propose a baseline-corrected orientation selectivity metric that is robust to varying spontaneous activity by weighting only the above-baseline responses and normalizing by the total above-baseline drive. Formulate it explicitly as a functional of $R(\\theta)$.\n4. Propose a baseline-corrected direction selectivity metric that subtracts $b$ from $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$ before normalization.\n5. For a neuron with $b = 10$ spikes$\\cdot$s$^{-1}$, $m = 8$ spikes$\\cdot$s$^{-1}$, and measured direction responses $R_{\\mathrm{pref}} = 28$ spikes$\\cdot$s$^{-1}$ and $R_{\\mathrm{null}} = 12$ spikes$\\cdot$s$^{-1}$, compute:\n   - the raw OSI from $R(\\theta)$,\n   - the raw DSI from $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$,\n   - the baseline-corrected OSI you propose in item 3 evaluated on $R(\\theta)$,\n   - the baseline-corrected DSI you propose in item 4.\n\nExplain why your proposed baseline-corrected orientation metric is independent of $b$ under the given model $R(\\theta)$ and why your proposed baseline-corrected direction metric is independent of $b$ for any pair $(R_{\\mathrm{pref}}, R_{\\mathrm{null}})$.\n\nRound all numerical values to four significant figures. Express any angles in radians. Report the final dimensionless quantities in the order: raw OSI, raw DSI, baseline-corrected OSI, baseline-corrected DSI.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. All provided information is self-contained and consistent for the tasks required. The problem is a standard exercise in computational neuroscience, based on established models and metrics.\n\nThe problem asks for a multi-part derivation and analysis concerning orientation and direction selectivity indices (OSI and DSI) in a visual neuron.\n\n**1. Derivation of how the spontaneous rate $b$ enters estimates of OSI and DSI**\n\nThe Orientation Selectivity Index (OSI) is defined as the normalized second-harmonic \"vector\" of the orientation response distribution, $R(\\theta)$. This is mathematically expressed as the modulus of the first complex Fourier coefficient of $R(\\theta)$ on the $2\\theta$ circle (since orientation is $\\pi$-periodic), normalized by the mean response.\n$$\n\\text{OSI} = \\frac{\\left| \\int_{0}^{\\pi} R(\\theta) \\exp(i 2\\theta) \\, d\\theta \\right|}{\\int_{0}^{\\pi} R(\\theta) \\, d\\theta}\n$$\nGiven the response function $R(\\theta) = b + m \\cos(2(\\theta - \\theta_{0}))$, we calculate the numerator and denominator.\n\nThe denominator is the integral of the total response over all orientations:\n$$\n\\int_{0}^{\\pi} R(\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\left( b + m \\cos(2(\\theta - \\theta_{0})) \\right) \\, d\\theta = b\\pi + m \\left[ \\frac{\\sin(2(\\theta - \\theta_{0}))}{2} \\right]_{0}^{\\pi} = b\\pi + 0 = b\\pi\n$$\nThe numerator is the modulus of the complex integral:\n$$\n\\int_{0}^{\\pi} R(\\theta) \\exp(i 2\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\left( b + m \\cos(2(\\theta - \\theta_{0})) \\right) \\exp(i 2\\theta) \\, d\\theta\n$$\n$$\n= b \\int_{0}^{\\pi} \\exp(i 2\\theta) \\, d\\theta + m \\int_{0}^{\\pi} \\cos(2(\\theta - \\theta_{0})) \\exp(i 2\\theta) \\, d\\theta\n$$\nThe first integral is $b \\left[ \\frac{\\exp(i 2\\theta)}{i2} \\right]_{0}^{\\pi} = \\frac{b}{i2}(\\exp(i2\\pi) - \\exp(0)) = 0$.\nThe second integral is evaluated using Euler's formula for the cosine:\n$$\nm \\int_{0}^{\\pi} \\frac{\\exp(i2(\\theta - \\theta_{0})) + \\exp(-i2(\\theta - \\theta_{0}))}{2} \\exp(i 2\\theta) \\, d\\theta\n$$\n$$\n= \\frac{m}{2} \\int_{0}^{\\pi} \\left( \\exp(i(4\\theta - 2\\theta_{0})) + \\exp(i2\\theta_{0}) \\right) \\, d\\theta\n$$\n$$\n= \\frac{m}{2} \\left[ \\frac{\\exp(i(4\\theta - 2\\theta_{0}))}{i4} \\right]_{0}^{\\pi} + \\frac{m}{2} \\exp(i2\\theta_{0}) \\int_{0}^{\\pi} d\\theta = 0 + \\frac{m\\pi}{2} \\exp(i2\\theta_{0})\n$$\nThe modulus of the numerator is therefore $|\\frac{m\\pi}{2} \\exp(i2\\theta_{0})| = \\frac{m\\pi}{2}$.\nSubstituting the numerator and denominator into the OSI formula:\n$$\n\\text{OSI} = \\frac{m\\pi/2}{b\\pi} = \\frac{m}{2b}\n$$\nThis derivation explicitly shows that OSI is inversely proportional to the spontaneous rate $b$.\n\nThe Direction Selectivity Index (DSI) is defined as the normalized difference of responses to the preferred ($R_{\\mathrm{pref}}$) and null ($R_{\\mathrm{null}}$) directions. The standard normalization is by the sum of these responses.\n$$\n\\text{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}\n$$\nThe responses $R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}}$ include the spontaneous firing rate $b$. We can write them as $R_{\\mathrm{pref}} = b + \\Delta R_{\\mathrm{pref}}$ and $R_{\\mathrm{null}} = b + \\Delta R_{\\mathrm{null}}$, where $\\Delta R$ represents the stimulus-driven component of the response. Substituting these gives:\n$$\n\\text{DSI} = \\frac{(b + \\Delta R_{\\mathrm{pref}}) - (b + \\Delta R_{\\mathrm{null}})}{(b + \\Delta R_{\\mathrm{pref}}) + (b + \\Delta R_{\\mathrm{null}})} = \\frac{\\Delta R_{\\mathrm{pref}} - \\Delta R_{\\mathrm{null}}}{2b + \\Delta R_{\\mathrm{pref}} + \\Delta R_{\\mathrm{null}}}\n$$\nThis explicitly shows that $b$ appears in the denominator, such that a larger spontaneous rate $b$ (for fixed stimulus-driven components) decreases the DSI.\n\n**2. Analysis of the pathology of subtracting $b$ from $R(\\theta)$**\n\nIf one naively subtracts the spontaneous rate $b$ from the response function $R(\\theta)$ before computing the OSI, we get a new function $R'(\\theta) = R(\\theta) - b = m \\cos(2(\\theta - \\theta_{0}))$.\nComputing the OSI with $R'(\\theta)$:\nThe numerator integral remains unchanged, as the integral of $b \\exp(i2\\theta)$ was zero. Thus, the modulus is still $\\frac{m\\pi}{2}$.\nThe denominator, however, becomes:\n$$\n\\int_{0}^{\\pi} R'(\\theta) \\, d\\theta = \\int_{0}^{\\pi} m \\cos(2(\\theta - \\theta_{0})) \\, d\\theta = 0\n$$\nThe OSI would be calculated as $(\\frac{m\\pi}{2}) / 0$, which is undefined. This division by zero is a critical pathology. It arises because the normalization factor, representing the total integrated response, becomes zero for a response function that is symmetric around zero. For real, noisy data, this integral would be close to zero, making the OSI estimate highly unstable and sensitive to noise. Firing rates are non-negative, so responses $R'(\\theta)$ can be negative, which is unphysiological. A proper correction must respect this constraint.\n\n**3. Proposed baseline-corrected orientation selectivity metric ($\\text{OSI}_{\\text{corr}}$)**\n\nA robust metric should consider only the response component that is above the baseline. We define the stimulus-driven response as $R_{\\text{driven}}(\\theta) = \\max(0, R(\\theta) - b)$. The metric is then formulated by applying the OSI definition to this rectified response:\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{\\left| \\int_{0}^{\\pi} \\max(0, R(\\theta) - b) \\exp(i 2\\theta) \\, d\\theta \\right|}{\\int_{0}^{\\pi} \\max(0, R(\\theta) - b) \\, d\\theta}\n$$\nFor the given model $R(\\theta) = b + m \\cos(2(\\theta - \\theta_{0}))$, we have $R_{\\text{driven}}(\\theta) = \\max(0, m \\cos(2(\\theta - \\theta_{0})))$. Assuming $m>0$, this is non-zero only when $\\cos(2(\\theta - \\theta_{0})) > 0$, i.e., for $\\theta \\in [\\theta_{0} - \\frac{\\pi}{4}, \\theta_{0} + \\frac{\\pi}{4}]$.\n\nThe denominator is:\n$$\n\\int_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} m \\cos(2(\\theta - \\theta_{0})) \\, d\\theta = m \\left[ \\frac{\\sin(2(\\theta - \\theta_{0}))}{2} \\right]_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} = \\frac{m}{2}(\\sin(\\pi/2) - \\sin(-\\pi/2)) = \\frac{m}{2}(1 - (-1)) = m\n$$\nThe numerator integral is:\n$$\nm \\int_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} \\cos(2(\\theta - \\theta_{0})) \\exp(i 2\\theta) \\, d\\theta = m \\exp(i2\\theta_{0}) \\int_{-\\pi/4}^{\\pi/4} \\cos(2\\alpha) \\exp(i2\\alpha) \\, d\\alpha\n$$\nwhere $\\alpha = \\theta - \\theta_{0}$. The integral becomes $\\int_{-\\pi/4}^{\\pi/4} (\\cos^2(2\\alpha) + i \\cos(2\\alpha)\\sin(2\\alpha)) \\, d\\alpha$. The imaginary part is an integral of an odd function over a symmetric interval and is zero. The real part is $\\int_{-\\pi/4}^{\\pi/4} \\cos^2(2\\alpha) \\, d\\alpha = \\int_{-\\pi/4}^{\\pi/4} \\frac{1+\\cos(4\\alpha)}{2} \\, d\\alpha = \\frac{1}{2}[\\alpha + \\frac{\\sin(4\\alpha)}{4}]_{-\\pi/4}^{\\pi/4} = \\frac{\\pi}{4}$.\nThe numerator's modulus is $|m \\exp(i2\\theta_{0}) \\frac{\\pi}{4}| = \\frac{m\\pi}{4}$.\nSo, the corrected OSI is:\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{m\\pi/4}{m} = \\frac{\\pi}{4}\n$$\n\n**4. Proposed baseline-corrected direction selectivity metric ($\\text{DSI}_{\\text{corr}}$)**\n\nFollowing the instruction to subtract $b$ before normalization, we define the stimulus-driven responses as $R'_{\\mathrm{pref}} = R_{\\mathrm{pref}}-b$ and $R'_{\\mathrm{null}} = R_{\\mathrm{null}}-b$. The normalization should be by the sum of these stimulus-driven responses.\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R'_{\\mathrm{pref}} - R'_{\\mathrm{null}}}{R'_{\\mathrm{pref}} + R'_{\\mathrm{null}}} = \\frac{(R_{\\mathrm{pref}}-b) - (R_{\\mathrm{null}}-b)}{(R_{\\mathrm{pref}}-b) + (R_{\\mathrm{null}}-b)} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}} - 2b}\n$$\nThis metric compares the differential stimulus-driven response to the total stimulus-driven response.\n\n**5. Numerical Calculations**\n\nGiven values are $b = 10$, $m = 8$, $R_{\\mathrm{pref}} = 28$, and $R_{\\mathrm{null}} = 12$. All units are spikes$\\cdot$s$^{-1}$.\n\n- Raw OSI:\n$$\n\\text{OSI} = \\frac{m}{2b} = \\frac{8}{2 \\times 10} = 0.4\n$$\n- Raw DSI:\n$$\n\\text{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}} = \\frac{28 - 12}{28 + 12} = \\frac{16}{40} = 0.4\n$$\n- Baseline-corrected OSI:\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{\\pi}{4} \\approx 0.785398...\n$$\n- Baseline-corrected DSI:\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}} - 2b} = \\frac{28-12}{28+12-2(10)} = \\frac{16}{40-20} = \\frac{16}{20} = 0.8\n$$\nRounding to four significant figures, we get:\nRaw OSI = $0.4000$\nRaw DSI = $0.4000$\nCorrected OSI = $0.7854$\nCorrected DSI = $0.8000$\n\n**6. Explanation of Independence from $b$**\n\nFor the proposed baseline-corrected orientation metric, $\\text{OSI}_{\\text{corr}}$, the derivation under the model $R(\\theta) = b + m\\cos(2(\\theta-\\theta_0))$ yields the constant value $\\pi/4$. The operation $\\max(0, R(\\theta) - b)$ effectively removes the baseline $b$, leaving only the stimulus modulation term $m \\cos(2(\\theta-\\theta_0))$ where it is positive. In the final ratio, the modulation amplitude $m$ is a common factor in both the numerator and the denominator, and thus cancels out. The resulting value depends only on the *shape* of the rectified cosine function, not on its amplitude ($m$) or its baseline offset ($b$).\n\nFor the proposed baseline-corrected direction metric, $\\text{DSI}_{\\text{corr}}$, its independence from $b$ is understood by considering the stimulus-driven responses as the fundamental properties of the neuron, with $b$ being an additive offset. Let $R'_{\\mathrm{pref}} = R_{\\mathrm{pref}} - b$ and $R'_{\\mathrm{null}} = R_{\\mathrm{null}} - b$ be these fixed, underlying stimulus-driven responses. The measured responses are then functions of $b$: $R_{\\mathrm{pref}}(b) = R'_{\\mathrm{pref}} + b$ and $R_{\\mathrm{null}}(b) = R'_{\\mathrm{null}} + b$. Substituting these into the formula for $\\text{DSI}_{\\text{corr}}$:\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R_{\\mathrm{pref}}(b) - R_{\\mathrm{null}}(b)}{R_{\\mathrm{pref}}(b) + R_{\\mathrm{null}}(b) - 2b} = \\frac{(R'_{\\mathrm{pref}} + b) - (R'_{\\mathrm{null}} + b)}{(R'_{\\mathrm{pref}} + b) + (R'_{\\mathrm{null}} + b) - 2b} = \\frac{R'_{\\mathrm{pref}} - R'_{\\mathrm{null}}}{R'_{\\mathrm{pref}} + R'_{\\mathrm{null}}}\n$$\nThe term $b$ algebraically cancels from both the numerator and the denominator. The resulting expression depends only on the stimulus-driven responses $R'_{\\mathrm{pref}}$ and $R'_{\\mathrm{null}}$, not on the spontaneous rate $b$. Therefore, for a neuron with a given stimulus-evoked response characteristic, this corrected metric is robust to changes in its baseline firing rate.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000 & 0.4000 & 0.7854 & 0.8000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The sharp tuning observed in cortical neurons is not merely a feedforward property but is actively sculpted by local network interactions. This advanced computational exercise guides you through building a circuit model to investigate how lateral inhibition sharpens orientation selectivity in a V1 hypercolumn. By implementing a recurrent network of Gabor-tuned cells, you will quantify this sharpening effect and analyze the network's dynamic stability, gaining hands-on experience with the simulation techniques at the heart of modern computational neuroscience .",
            "id": "3983190",
            "problem": "You are to implement a simulation-based analysis of orientation selectivity in a simplified network model of primary visual cortex (V1) simple cells with lateral inhibition. The core modeling components must be built from first principles of linear filtering with Gabor functions, half-wave rectification, and threshold-linear inhibitory interactions, in order to quantify the sharpening of orientation selectivity and analyze local map stability.\n\nFundamental base and definitions to be used:\n- A two-dimensional Gabor filter is defined as a Gaussian envelope modulating a sinusoidal carrier. Let the spatial coordinates be $(x,y)$ and the preferred orientation be $\\theta_i$. Define rotated coordinates $(x',y')$ by a rotation matrix of angle $\\theta_i$ applied to $(x,y)$. The Gabor filter is given by\n$$\ng_i(x,y) \\;=\\; \\exp\\!\\left(-\\frac{{x'}^2}{2\\sigma_x^2} - \\frac{{y'}^2}{2\\sigma_y^2}\\right)\\,\\cos\\!\\big(2\\pi f_0\\,x'\\big),\n$$\nwhere $\\sigma_x$, $\\sigma_y$ are the standard deviations of the Gaussian envelope along the filter’s axes and $f_0$ is the carrier spatial frequency in cycles per unit length.\n- A sinusoidal grating stimulus with orientation $\\theta$ is given by\n$$\ns_\\theta(x,y) \\;=\\; \\cos\\!\\left(2\\pi f_s\\,(x\\cos\\theta + y\\sin\\theta)\\right).\n$$\nTo ensure finite-energy inner products on a finite grid, window the stimulus with a Gaussian $w(x,y) = \\exp\\!\\left(-\\frac{x^2+y^2}{2\\sigma_w^2}\\right)$ before computing integrals.\n- A simple cell’s linear drive to stimulus $s_\\theta$ is the spatial inner product\n$$\nb_i(\\theta) \\;=\\; \\iint g_i(x,y)\\,\\big(s_\\theta(x,y)\\,w(x,y)\\big)\\,dx\\,dy,\n$$\napproximated numerically by a Riemann sum over a finite grid.\n- The half-wave rectified output (a standard linear–nonlinear cascade) is $r_i^{\\mathrm{ff}}(\\theta) = \\max\\big(0,\\,b_i(\\theta)\\big)$.\n- Lateral inhibition is modeled by a threshold-linear recurrent network. For a fixed stimulus orientation $\\theta$, let $\\mathbf{b}(\\theta) \\in \\mathbb{R}^K$ be the vector of drives across $K$ cells, and let $W \\in \\mathbb{R}^{K\\times K}$ be a symmetric nonnegative lateral interaction matrix parameterized by angular proximity in orientation space. The steady-state responses $\\mathbf{r}(\\theta)\\in\\mathbb{R}^K_{\\ge 0}$ satisfy the fixed-point condition\n$$\n\\mathbf{r}(\\theta) \\;=\\; \\big[\\mathbf{b}(\\theta) \\;-\\; \\gamma\\,W\\,\\mathbf{r}(\\theta)\\big]_+,\n$$\nwhere $[\\cdot]_+$ denotes elementwise rectification and $\\gamma \\ge 0$ is the inhibitory gain.\n- Orientation Selectivity Index (OSI) for cell $i$ over a set of stimulus orientations $\\{\\theta_m\\}_{m=1}^M$ is computed using the circular-moment definition with $\\pi$-periodicity:\n$$\n\\mathrm{OSI}_i \\;=\\; \\frac{\\left|\\sum_{m=1}^M r_i(\\theta_m)\\,e^{\\mathrm{i}\\,2\\theta_m}\\right|}{\\sum_{m=1}^M r_i(\\theta_m)},\n$$\nwith the convention $\\mathrm{OSI}_i = 0$ when the denominator is zero. Angles $\\theta$ must be in radians.\n- Map stability is analyzed by the spectral radius of the Jacobian of the threshold-linear map at a fixed point. For the discrete-time map $\\mathbf{F}(\\mathbf{r}) = [\\mathbf{b} - \\gamma W \\mathbf{r}]_+$, a fixed point $\\mathbf{r}^\\star$ has a local Jacobian\n$$\nJ(\\mathbf{r}^\\star) \\;=\\; -\\gamma\\,D(\\mathbf{r}^\\star)\\,W,\n$$\nwhere $D(\\mathbf{r}^\\star)$ is a diagonal indicator matrix with entries $D_{ii}=1$ if $r_i^\\star>0$ and $D_{ii}=0$ otherwise. Local contraction, and hence local stability of the discrete iteration $\\mathbf{r}_{t+1}=\\mathbf{F}(\\mathbf{r}_t)$, is ensured if the spectral radius $\\rho\\!\\left(J(\\mathbf{r}^\\star)\\right) < 1$.\n\nTask requirements:\n1) Implement a program that constructs $K$ oriented Gabor filters $g_i$ with preferred orientations $\\theta_i$ evenly spaced in $[0,\\pi)$, and computes their linear drives $b_i(\\theta_m)$ to a set of $M$ sinusoidal gratings $s_{\\theta_m}$ with orientations $\\theta_m$ evenly spaced in $[0,\\pi)$, using a finite grid discretization and the Gaussian window $w$ for the stimuli. Use half-wave rectification to obtain $r_i^{\\mathrm{ff}}(\\theta_m)=\\max(0,b_i(\\theta_m))$.\n2) Construct a lateral interaction matrix $W$ using a circular-Gaussian kernel of width $\\sigma_\\theta$ on orientation space with wrap-around distance on $[0,\\pi)$:\n$$\nW_{ij} \\;=\\; \\exp\\!\\left(-\\frac{d_\\pi(\\theta_i,\\theta_j)^2}{2\\sigma_\\theta^2}\\right), \\quad W_{ii}=0,\n$$\nwhere $d_\\pi(\\alpha,\\beta)=\\min\\big(|\\alpha-\\beta|,\\,\\pi-|\\alpha-\\beta|\\big)$. Normalize $W$ so that its spectral radius is exactly $1$ by dividing by its largest eigenvalue magnitude.\n3) For each test case and for each stimulus orientation $\\theta_m$, compute the recurrent steady state $\\mathbf{r}^\\star(\\theta_m)$ by iterating the threshold-linear dynamics $\\mathbf{r}_{t+1} = [\\mathbf{b}(\\theta_m) - \\gamma W \\mathbf{r}_t]_+$ until convergence to a fixed point within a small tolerance. You may use under-relaxation (constant convex combination with the previous iterate) to aid convergence; fixed points are invariant under such damping. Then compute the local Jacobian $J(\\mathbf{r}^\\star(\\theta_m))$ and its spectral radius $\\rho_m$ at the fixed point for each $\\theta_m$.\n4) For each test case, compute:\n   - The mean OSI gain across cells, defined as the average over $i$ of $\\mathrm{OSI}_i^{\\mathrm{post}} - \\mathrm{OSI}_i^{\\mathrm{pre}}$, where “pre” uses $r_i^{\\mathrm{ff}}(\\theta_m)$ and “post” uses $r_i^\\star(\\theta_m)$.\n   - The maximum Jacobian spectral radius across stimuli, $\\max_m \\rho_m$.\n   - A stability boolean that is true if and only if $\\rho_m < 1$ for all $m$.\n\nNumerical specification to ensure reproducibility:\n- Use a square grid of size $N\\times N$ with $N = 64$ spanning $[-L,L]\\times[-L,L]$ with $L=1.0$. Use Riemann sum weights $\\Delta x=\\Delta y=2L/N$.\n- Use $K=16$ cells with preferred orientations $\\theta_i = i\\pi/K$ for $i\\in\\{0,1,\\dots,K-1\\}$.\n- Use $M=18$ stimulus orientations $\\theta_m = m\\pi/M$ for $m\\in\\{0,1,\\dots,M-1\\}$.\n- Use Gabor parameters $\\sigma_x=0.40$, $\\sigma_y=0.20$, $f_0=2.0$, carrier phase $0$, and stimulus parameters $f_s=2.0$, $\\sigma_w=0.80$.\n- Use $\\sigma_\\theta=0.35$ for the lateral kernel. Construct $W$ with $W_{ii}=0$ and then normalize it to have spectral radius exactly $1$.\n- For the fixed-point iteration, initialize $\\mathbf{r}_0=\\max(0,\\mathbf{b}(\\theta_m))$, use an under-relaxation factor $\\alpha=0.5$, a convergence tolerance of $10^{-8}$ in Euclidean norm difference between successive iterates, and a maximum of $1000$ iterations.\n\nTest suite:\nProvide results for the following four parameter sets, differing only in the inhibitory gain $\\gamma$:\n- Case A: $\\gamma = 0.00$.\n- Case B: $\\gamma = 0.40$.\n- Case C: $\\gamma = 0.90$.\n- Case D: $\\gamma = 1.10$.\n\nAngle unit requirement:\n- All angles, including $\\theta$, $\\theta_i$, and $\\theta_m$, must be treated in radians.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, one per test case, in the order [Case A, Case B, Case C, Case D]. Each inner list must be of the form [mean_osi_gain, max_spectral_radius, is_stable], where mean_osi_gain and max_spectral_radius are floating-point numbers and is_stable is a boolean. For example, the printed line must look like\n\"[[x1,y1,True],[x2,y2,False],[x3,y3,True],[x4,y4,True]]\"\nwith no spaces and no additional text. No physical units are required other than the specification that angles are in radians.",
            "solution": "The user's request is a valid and well-posed problem in computational neuroscience. I will proceed with a full solution.\n\n### Principle-Based Design\n\nThe problem requires the implementation and analysis of a simplified model of orientation processing in the primary visual cortex (V1). The model consists of several canonical components: Gabor filters as receptive fields of simple cells, half-wave rectification for firing rate conversion, and a recurrent network with lateral inhibition to sharpen tuning curves. The analysis involves quantifying this sharpening via the Orientation Selectivity Index (OSI) and assessing network stability through the spectral radius of the local Jacobian.\n\nThe solution is structured in a series of logical steps, from defining the model's components to simulating its dynamics and performing the required analyses.\n\n**1. Model Environment and Stimuli Definition**\n\nFirst, we establish the spatial domain and the set of stimuli. The model operates on a discrete grid representing a patch of the visual field.\n\n- **Spatial Grid**: A square grid of size $N \\times N$ represents the spatial coordinates $(x,y)$. The problem specifies $N=64$ points spanning the domain $[-L, L] \\times [-L, L]$ with $L=1.0$. The discretization step is uniform, $\\Delta x = \\Delta y = 2L/N$.\n- **Orientations**: We define two sets of orientations. One set for the preferred orientations of the $K=16$ model neurons, $\\theta_i = i\\pi/K$ for $i \\in \\{0, \\dots, K-1\\}$. The other for the $M=18$ orientations of the input stimuli, $\\theta_m = m\\pi/M$ for $m \\in \\{0, \\dots, M-1\\}$. All angles are in radians.\n- **Stimulus Creation**: The stimuli are sinusoidal gratings, a standard choice for probing orientation-selective cells. Each grating $s_{\\theta_m}(x,y)$ must be windowed by a Gaussian function $w(x,y)$ to ensure it is spatially localized and has finite energy. For each of the $M$ orientations, we generate a stimulus image on the $N \\times N$ grid:\n$$\nS_m(x,y) = s_{\\theta_m}(x,y)\\,w(x,y) = \\cos\\!\\left(2\\pi f_s\\,(x\\cos\\theta_m + y\\sin\\theta_m)\\right) \\exp\\!\\left(-\\frac{x^2+y^2}{2\\sigma_w^2}\\right)\n$$\nThe parameters are given as $f_s=2.0$ and $\\sigma_w=0.80$.\n\n**2. Simple Cell Receptive Fields and Feedforward Drive**\n\nThe receptive fields of V1 simple cells are modeled by Gabor filters. The response of a neuron to a stimulus is first calculated as a linear filtering operation.\n\n- **Gabor Filters**: For each of the $K$ neurons, a 2D Gabor filter $g_i(x,y)$ is generated. This function is a product of a Gaussian envelope and a sinusoidal carrier. Its orientation is determined by the cell's preferred orientation $\\theta_i$. The formula is:\n$$\ng_i(x,y) \\;=\\; \\exp\\!\\left(-\\frac{{x'}^2}{2\\sigma_x^2} - \\frac{{y'}^2}{2\\sigma_y^2}\\right)\\,\\cos\\!\\big(2\\pi f_0\\,x'\\big)\n$$\nwhere $(x', y')$ are rotated coordinates: $x' = x\\cos\\theta_i + y\\sin\\theta_i$ and $y' = -x\\sin\\theta_i + y\\cos\\theta_i$. The parameters are specified as $\\sigma_x=0.40$, $\\sigma_y=0.20$, and $f_0=2.0$.\n- **Linear Drive**: The linear drive $b_i(\\theta_m)$ of cell $i$ to stimulus $m$ is the inner product of the cell's Gabor filter and the windowed stimulus. On our discrete grid, this integral is approximated by a Riemann sum:\n$$\nb_i(\\theta_m) = \\iint g_i(x,y) S_m(x,y) \\,dx\\,dy \\approx \\sum_{j,k} g_i(x_j, y_k) S_m(x_j, y_k) (\\Delta x \\Delta y)\n$$\nThis computation is performed for all $K$ cells and all $M$ stimuli, resulting in a $K \\times M$ matrix of linear drives, $B = [b_{im}]$.\n- **Feedforward Response (Half-Wave Rectification)**: Neurons cannot have negative firing rates. This is modeled by a half-wave rectification nonlinearity. The feedforward response $r_i^{\\mathrm{ff}}(\\theta_m)$ is:\n$$\nr_i^{\\mathrm{ff}}(\\theta_m) = \\max\\big(0,\\,b_i(\\theta_m)\\big) = [b_i(\\theta_m)]_+\n$$\n\n**3. Lateral Interaction Network**\n\nThe model includes lateral connections between neurons, mediating inhibition. This is a key mechanism for sharpening orientation tuning.\n\n- **Weight Matrix Construction**: The connection strength $W_{ij}$ between cell $i$ and cell $j$ depends on the difference between their preferred orientations, $\\theta_i$ and $\\theta_j$. The problem specifies a circular-Gaussian kernel on the orientation space $[0, \\pi)$:\n$$\nW_{ij} \\;=\\; \\exp\\!\\left(-\\frac{d_\\pi(\\theta_i,\\theta_j)^2}{2\\sigma_\\theta^2}\\right) \\quad \\text{with} \\quad W_{ii}=0\n$$\nwhere $d_\\pi(\\alpha,\\beta)=\\min\\big(|\\alpha-\\beta|,\\,\\pi-|\\alpha-\\beta|\\big)$ is the wrap-around distance on the circle of orientations. The parameter $\\sigma_\\theta=0.35$ controls the width of inhibition in orientation space.\n- **Normalization**: To control the overall strength of interactions and ensure comparability, the weight matrix $W$ is normalized such that its spectral radius, $\\rho(W) = \\max_k |\\lambda_k(W)|$, is exactly $1$. This is achieved by calculating the matrix's eigenvalues, finding the one with the largest magnitude, and dividing all elements of $W$ by this value.\n\n**4. Recurrent Network Dynamics and Steady-State**\n\nThe final responses of neurons are not just the feedforward drive but are shaped by the recurrent inhibitory signals. The steady-state responses are the fixed point of the network dynamics.\n\n- **Fixed-Point Equation**: For a given stimulus orientation $\\theta$, the vector of steady-state responses $\\mathbf{r}(\\theta)$ must satisfy:\n$$\n\\mathbf{r}(\\theta) \\;=\\; \\big[\\mathbf{b}(\\theta) \\;-\\; \\gamma\\,W\\,\\mathbf{r}(\\theta)\\big]_+\n$$\nwhere $\\mathbf{b}(\\theta)$ is the vector of linear drives, $\\gamma$ is the inhibitory gain, and $[\\cdot]_+$ is element-wise rectification.\n- **Iterative Solution**: This fixed-point equation is solved numerically for each stimulus orientation $\\theta_m$. We use an iterative scheme with under-relaxation to enhance stability and convergence:\n$$\n\\mathbf{r}_{t+1} = (1 - \\alpha) \\mathbf{r}_t + \\alpha \\left[\\mathbf{b}(\\theta_m) - \\gamma W \\mathbf{r}_t\\right]_+\n$$\nThe iteration starts with the feedforward response, $\\mathbf{r}_0 = \\mathbf{r}^{\\mathrm{ff}}(\\theta_m) = [\\mathbf{b}(\\theta_m)]_+$, and continues until the change between successive iterates, $\\|\\mathbf{r}_{t+1} - \\mathbf{r}_t\\|_2$, falls below a tolerance of $10^{-8}$. The specified under-relaxation factor is $\\alpha=0.5$. The final converged vector is the steady-state response $\\mathbf{r}^\\star(\\theta_m)$.\n\n**5. Analysis of Tuning and Stability**\n\nThe final step is to analyze the results of the simulation for each value of the inhibitory gain $\\gamma$.\n\n- **Orientation Selectivity Index (OSI)**: The OSI quantifies how sharply tuned a neuron is to orientation. We use the circular-moment definition, which is robust and widely used:\n$$\n\\mathrm{OSI}_i \\;=\\; \\frac{\\left|\\sum_{m=1}^M r_i(\\theta_m)\\,e^{\\mathrm{i}\\,2\\theta_m}\\right|}{\\sum_{m=1}^M r_i(\\theta_m)}\n$$\nThe numerator represents the length of a resultant vector in the complex plane, where each response $r_i(\\theta_m)$ contributes a vector of that magnitude at an angle of $2\\theta_m$. The factor of $2$ accounts for the $\\pi$-periodicity of orientation. We compute this for each cell $i$ using both the pre-inhibition (feedforward) responses $r_i^{\\mathrm{ff}}$ and the post-inhibition (steady-state) responses $r_i^\\star$. The mean OSI gain is the average difference: $\\langle \\mathrm{OSI}^{\\mathrm{post}} - \\mathrm{OSI}^{\\mathrm{pre}} \\rangle_i$.\n- **Local Stability Analysis**: The stability of the network's steady-state responses is critical. An unstable network would exhibit oscillations or chaotic activity. Local stability of a fixed point $\\mathbf{r}^\\star$ is determined by the spectral radius of the Jacobian of the iteration map evaluated at $\\mathbf{r}^\\star$. The Jacobian is given by:\n$$\nJ(\\mathbf{r}^\\star) \\;=\\; -\\gamma\\,D(\\mathbf{r}^\\star)\\,W\n$$\nwhere $D(\\mathbf{r}^\\star)$ is a diagonal matrix with $D_{ii}=1$ if the corresponding neuron is active ($r_i^\\star > 0$) and $D_{ii}=0$ otherwise. The fixed point is locally stable if the spectral radius $\\rho(J) < 1$. We compute this spectral radius $\\rho_m = \\rho(J(\\mathbf{r}^\\star(\\theta_m)))$ for each stimulus orientation $\\theta_m$. The overall stability metric for a given $\\gamma$ is the maximum spectral radius found across all stimuli, $\\max_m \\rho_m$. The system is deemed stable if and only if this maximum value is less than $1$.\n\nThese steps will be implemented for each of the four specified values of $\\gamma$, and the resulting metrics (mean OSI gain, max spectral radius, stability) will be collected and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a simulation-based analysis of orientation selectivity\n    in a simplified V1 simple cell network model.\n    \"\"\"\n\n    # 1. Numerical Specifications and Setup\n    N = 64  # Grid size\n    L = 1.0  # Spatial extent [-L, L]\n    K = 16  # Number of cells\n    M = 18  # Number of stimulus orientations\n    \n    # Gabor parameters\n    SIGMA_X = 0.40\n    SIGMA_Y = 0.20\n    F0 = 2.0\n    \n    # Stimulus parameters\n    F_S = 2.0\n    SIGMA_W = 0.80\n    \n    # Network parameters\n    SIGMA_THETA = 0.35\n    ALPHA = 0.5  # Under-relaxation factor\n    TOLERANCE = 1e-8\n    MAX_ITER = 1000\n\n    # Test suite for inhibitory gain gamma\n    gammas = [0.00, 0.40, 0.90, 1.10]\n\n    # Create spatial grid\n    grid_pts = np.linspace(-L, L, N)\n    x, y = np.meshgrid(grid_pts, grid_pts)\n    dx = dy = 2.0 * L / N\n\n    # Create orientation sets\n    thetas_i = np.arange(K) * np.pi / K  # Cell preferred orientations\n    thetas_m = np.arange(M) * np.pi / M  # Stimulus orientations\n\n    # 2. Pre-compute Stimuli and Gabor Filters\n    \n    # Window function\n    window = np.exp(-(x**2 + y**2) / (2 * SIGMA_W**2))\n\n    # Stimuli (M of them, each N x N)\n    stimuli = np.zeros((M, N, N))\n    for m, theta_m in enumerate(thetas_m):\n        stimulus_grating = np.cos(2 * np.pi * F_S * (x * np.cos(theta_m) + y * np.sin(theta_m)))\n        stimuli[m, :, :] = stimulus_grating * window\n\n    # Gabor filters (K of them, each N x N)\n    gabor_filters = np.zeros((K, N, N))\n    for i, theta_i in enumerate(thetas_i):\n        x_prime = x * np.cos(theta_i) + y * np.sin(theta_i)\n        y_prime = -x * np.sin(theta_i) + y * np.cos(theta_i)\n        envelope = np.exp(-(x_prime**2 / (2 * SIGMA_X**2) + y_prime**2 / (2 * SIGMA_Y**2)))\n        carrier = np.cos(2 * np.pi * F0 * x_prime)\n        gabor_filters[i, :, :] = envelope * carrier\n\n    # 3. Compute Linear Drives and Feedforward Responses\n    B = np.zeros((K, M))  # Linear drives matrix\n    for i in range(K):\n        for m in range(M):\n            # Riemann sum for inner product\n            B[i, m] = np.sum(gabor_filters[i] * stimuli[m]) * dx * dy\n    \n    R_ff = np.maximum(0, B) # Feedforward responses\n\n    # 4. Construct and Normalize Lateral Interaction Matrix W\n    def circular_dist(a, b, period=np.pi):\n        diff = np.abs(a - b)\n        return np.minimum(diff, period - diff)\n\n    W = np.zeros((K, K))\n    for i in range(K):\n        for j in range(K):\n            if i == j:\n                W[i, j] = 0\n            else:\n                dist_sq = circular_dist(thetas_i[i], thetas_i[j])**2\n                W[i, j] = np.exp(-dist_sq / (2 * SIGMA_THETA**2))\n\n    # Normalize W to have spectral radius of 1\n    eigenvalues_w = np.linalg.eigvals(W)\n    spectral_radius_w = np.max(np.abs(eigenvalues_w))\n    W /= spectral_radius_w\n\n    # 5. Define analysis functions\n    def compute_osi(responses, thetas):\n        \"\"\"Computes OSI for all cells.\"\"\"\n        # responses is K x M, thetas is M\n        numerator = np.abs(np.dot(responses, np.exp(2j * thetas)))\n        denominator = np.sum(responses, axis=1)\n        \n        # Handle case where a cell is silent\n        # np.divide handles division by zero, resulting in zero\n        osi = np.divide(numerator, denominator, out=np.zeros_like(numerator, dtype=float), where=denominator!=0)\n        return osi\n\n    # Compute pre-inhibition OSIs\n    osi_pre = compute_osi(R_ff, thetas_m)\n\n    # 6. Main loop over test cases\n    final_results = []\n    for gamma in gammas:\n        R_star = np.zeros((K, M))  # Steady-state responses\n        rhos = []  # Spectral radii for each stimulus\n\n        for m in range(M):\n            b_m = B[:, m]\n            \n            # Find fixed point by iteration\n            r_t = np.maximum(0, b_m)\n            for _ in range(MAX_ITER):\n                r_prime_t1 = np.maximum(0, b_m - gamma * np.dot(W, r_t))\n                r_t1 = (1 - ALPHA) * r_t + ALPHA * r_prime_t1\n                if np.linalg.norm(r_t1 - r_t)  TOLERANCE:\n                    break\n                r_t = r_t1\n            r_star_m = r_t\n            R_star[:, m] = r_star_m\n\n            # Compute Jacobian and its spectral radius\n            if gamma == 0:\n                rho_m = 0.0\n            else:\n                D = np.diag(r_star_m > 0)\n                J = -gamma * np.dot(D, W)\n                eigenvalues_j = np.linalg.eigvals(J)\n                rho_m = np.max(np.abs(eigenvalues_j))\n            rhos.append(rho_m)\n\n        # Compute post-inhibition OSIs\n        osi_post = compute_osi(R_star, thetas_m)\n        \n        # Calculate final metrics for this case\n        mean_osi_gain = np.mean(osi_post - osi_pre)\n        max_spectral_radius = np.max(rhos)\n        is_stable = max_spectral_radius  1.0\n\n        final_results.append([mean_osi_gain, max_spectral_radius, is_stable])\n\n    # 7. Format and print the final output\n    # Use repr and string replacement for exact, space-free formatting\n    output_str = repr(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}