{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的模型之前，我们必须首先理解如何量化方向选择性。本练习将引导您超越教科书中关于方向选择性指数（OSI）和朝向选择性指数（DSI）的公式，深入探究神经元的基线放电率如何影响这些指标，并促使您构建更具鲁棒性的度量标准。通过从基本原理出发进行推导，您将更好地理解实验数据分析中可能遇到的陷阱以及如何设计出能够反映真实神经元调谐特性的指标。",
            "id": "5049886",
            "problem": "为了表征一个初级视皮层神经元对方位和运动方向的调谐特性，我们使用漂移光栅对其进行探测。该神经元在不同方位上的方位调谐可以很好地用方位圆上的一个二次谐波余弦函数来近似：在方位角 $\\theta \\in [0,\\pi)$（弧度）下的响应为 $R(\\theta) = b + m \\cos\\!\\big(2(\\theta - \\theta_{0})\\big)$，其中 $b$ 是自发（基线）放电率，$m$ 是调制幅度，$\\theta_{0}$ 是偏好方位。在另一个专注于运动方向（$2\\pi$ 周期）的独立实验中，测量了神经元对偏好运动方向和相反（零）运动方向的平均响应，分别为 $R_{\\mathrm{pref}}$ 和 $R_{\\mathrm{null}}$。假设自发放电率 $b$ 反映了在没有视觉刺激情况下的平均活动水平。\n\n请使用系统神经科学中的基本定义，从将方位选择性解释为方位响应分布的归一化二次谐波“向量”，以及将运动方向选择性解释为对偏好与零运动方向响应的归一化差异出发。在不借助任何预先给定的简化公式的情况下，基于这些定义进行推理，以完成以下任务：\n\n1. 推导自发放电率 $b$ 如何影响从 $R(\\theta)$ 计算的方位选择性指数（OSI）和从 $R_{\\mathrm{pref}}$ 与 $R_{\\mathrm{null}}$ 计算的运动方向选择性指数（DSI）的估计值。\n2. 分析从响应中减去自发放电率对 OSI 和 DSI 中归一化步骤的影响，并指出如果简单地从 $R(\\theta)$ 中减去 $b$ 会出现的任何病态问题。\n3. 提出一种经基线校正的方位选择性度量，该度量通过仅对高于基线的响应进行加权，并按总的超基线驱动进行归一化，从而对变化的自发活动具有鲁棒性。请将其明确地表述为 $R(\\theta)$ 的一个泛函。\n4. 提出一种经基线校正的运动方向选择性度量，该度量在归一化之前从 $R_{\\mathrm{pref}}$ 和 $R_{\\mathrm{null}}$ 中减去 $b$。\n5. 对于一个神经元，其$b=10$脉冲$\\cdot$s$^{-1}$，$m=8$脉冲$\\cdot$s$^{-1}$，测得的运动方向响应为$R_{\\mathrm{pref}}=28$脉冲$\\cdot$s$^{-1}$和$R_{\\mathrm{null}}=12$脉冲$\\cdot$s$^{-1}$，请计算：\n   - 从 $R(\\theta)$ 计算的原始 OSI，\n   - 从 $R_{\\mathrm{pref}}$ 和 $R_{\\mathrm{null}}$ 计算的原始 DSI，\n   - 你在第3项中提出并应用于 $R(\\theta)$ 的基线校正 OSI，\n   - 你在第4项中提出的基线校正 DSI。\n\n解释为什么在给定的 $R(\\theta)$ 模型下，你提出的基线校正方位度量与 $b$ 无关，以及为什么对于任意一对 $(R_{\\mathrm{pref}}, R_{\\mathrm{null}})$，你提出的基线校正运动方向度量也与 $b$ 无关。\n\n将所有数值四舍五入至四位有效数字。所有角度均以弧度表示。按以下顺序报告最终的无量纲量：原始 OSI、原始 DSI、基线校正 OSI、基线校正 DSI。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、良定且客观的。所有提供的信息都是自洽的，并且对于完成所需任务是一致的。该问题是计算神经科学中的一个标准练习，基于已建立的模型和度量。\n\n该问题要求对视觉神经元中的方位和运动方向选择性指数（OSI 和 DSI）进行多部分的推导和分析。\n\n**1. 推导自发放电率 $b$ 如何进入 OSI 和 DSI 的估计**\n\n方位选择性指数（OSI）定义为方位响应分布 $R(\\theta)$ 的归一化二次谐波“向量”。在数学上，这表示为 $R(\\theta)$ 在 $2\\theta$ 圆上（因为方位是 $\\pi$ 周期的）的第一个复傅里叶系数的模，并除以平均响应进行归一化。\n$$\n\\text{OSI} = \\frac{\\left| \\int_{0}^{\\pi} R(\\theta) \\exp(i 2\\theta) \\, d\\theta \\right|}{\\int_{0}^{\\pi} R(\\theta) \\, d\\theta}\n$$\n给定响应函数 $R(\\theta) = b + m \\cos(2(\\theta - \\theta_{0}))$，我们计算分子和分母。\n\n分母是总响应在所有方位上的积分：\n$$\n\\int_{0}^{\\pi} R(\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\left( b + m \\cos(2(\\theta - \\theta_{0})) \\right) \\, d\\theta = b\\pi + m \\left[ \\frac{\\sin(2(\\theta - \\theta_{0}))}{2} \\right]_{0}^{\\pi} = b\\pi + 0 = b\\pi\n$$\n分子是复积分的模：\n$$\n\\int_{0}^{\\pi} R(\\theta) \\exp(i 2\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\left( b + m \\cos(2(\\theta - \\theta_{0})) \\right) \\exp(i 2\\theta) \\, d\\theta\n$$\n$$\n= b \\int_{0}^{\\pi} \\exp(i 2\\theta) \\, d\\theta + m \\int_{0}^{\\pi} \\cos(2(\\theta - \\theta_{0})) \\exp(i 2\\theta) \\, d\\theta\n$$\n第一个积分为 $b \\left[ \\frac{\\exp(i 2\\theta)}{i2} \\right]_{0}^{\\pi} = \\frac{b}{i2}(\\exp(i2\\pi) - \\exp(0)) = 0$。\n第二个积分使用余弦的欧拉公式进行计算：\n$$\nm \\int_{0}^{\\pi} \\frac{\\exp(i2(\\theta - \\theta_{0})) + \\exp(-i2(\\theta - \\theta_{0}))}{2} \\exp(i 2\\theta) \\, d\\theta\n$$\n$$\n= \\frac{m}{2} \\int_{0}^{\\pi} \\left( \\exp(i(4\\theta - 2\\theta_{0})) + \\exp(i2\\theta_{0}) \\right) \\, d\\theta\n$$\n$$\n= \\frac{m}{2} \\left[ \\frac{\\exp(i(4\\theta - 2\\theta_{0}))}{i4} \\right]_{0}^{\\pi} + \\frac{m}{2} \\exp(i2\\theta_{0}) \\int_{0}^{\\pi} d\\theta = 0 + \\frac{m\\pi}{2} \\exp(i2\\theta_{0})\n$$\n因此，分子的模为 $|\\frac{m\\pi}{2} \\exp(i2\\theta_{0})| = \\frac{m\\pi}{2}$。\n将分子和分母代入 OSI 公式：\n$$\n\\text{OSI} = \\frac{m\\pi/2}{b\\pi} = \\frac{m}{2b}\n$$\n这个推导明确表明，OSI 与自发放电率 $b$ 成反比。\n\n运动方向选择性指数（DSI）定义为对偏好（$R_{\\mathrm{pref}}$）和零（$R_{\\mathrm{null}}$）运动方向响应的归一化差异。标准的归一化方法是用这些响应的总和来除。\n$$\n\\text{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}\n$$\n响应 $R_{\\mathrm{pref}}$ 和 $R_{\\mathrm{null}}$ 包含了自发放电率 $b$。我们可以将它们写为 $R_{\\mathrm{pref}} = b + \\Delta R_{\\mathrm{pref}}$ 和 $R_{\\mathrm{null}} = b + \\Delta R_{\\mathrm{null}}$，其中 $\\Delta R$ 代表响应中由刺激驱动的分量。代入后得到：\n$$\n\\text{DSI} = \\frac{(b + \\Delta R_{\\mathrm{pref}}) - (b + \\Delta R_{\\mathrm{null}})}{(b + \\Delta R_{\\mathrm{pref}}) + (b + \\Delta R_{\\mathrm{null}})} = \\frac{\\Delta R_{\\mathrm{pref}} - \\Delta R_{\\mathrm{null}}}{2b + \\Delta R_{\\mathrm{pref}} + \\Delta R_{\\mathrm{null}}}\n$$\n这明确地表明 $b$ 出现在分母中，因此（在刺激驱动分量固定的情况下）较大的自发放电率 $b$ 会导致 DSI 减小。\n\n**2. 分析从 $R(\\theta)$ 中减去 $b$ 带来的病态问题**\n\n如果在计算 OSI 之前，简单地从响应函数 $R(\\theta)$ 中减去自发放电率 $b$，我们会得到一个新函数 $R'(\\theta) = R(\\theta) - b = m \\cos(2(\\theta - \\theta_{0}))$。\n使用 $R'(\\theta)$ 计算 OSI：\n分子积分保持不变，因为 $b \\exp(i2\\theta)$ 的积分为零。因此，其模仍然是 $\\frac{m\\pi}{2}$。\n然而，分母变为：\n$$\n\\int_{0}^{\\pi} R'(\\theta) \\, d\\theta = \\int_{0}^{\\pi} m \\cos(2(\\theta - \\theta_{0})) \\, d\\theta = 0\n$$\nOSI 的计算结果将是 $(\\frac{m\\pi}{2}) / 0$，这是未定义的。这种除以零的情况是一个严重的病态问题。其产生的原因是，对于一个围绕零对称的响应函数，代表总积分响应的归一化因子变为零。对于真实的含噪声数据，这个积分会接近于零，使得 OSI 的估计值高度不稳定且对噪声敏感。放电率是非负的，所以响应 $R'(\\theta)$ 可能会是负值，这不符合生理学。一个恰当的校正必须遵守这个约束。\n\n**3. 提出的经基线校正的方位选择性度量 ($\\text{OSI}_{\\text{corr}}$)**\n\n一个鲁棒的度量应该只考虑高于基线的响应分量。我们将刺激驱动的响应定义为 $R_{\\text{driven}}(\\theta) = \\max(0, R(\\theta) - b)$。然后，通过将 OSI 的定义应用于这个整流后的响应来构建该度量：\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{\\left| \\int_{0}^{\\pi} \\max(0, R(\\theta) - b) \\exp(i 2\\theta) \\, d\\theta \\right|}{\\int_{0}^{\\pi} \\max(0, R(\\theta) - b) \\, d\\theta}\n$$\n对于给定的模型 $R(\\theta) = b + m \\cos(2(\\theta - \\theta_{0}))$，我们有 $R_{\\text{driven}}(\\theta) = \\max(0, m \\cos(2(\\theta - \\theta_{0})))$。假设 $m>0$，只有当 $\\cos(2(\\theta - \\theta_{0})) > 0$ 时，该式才非零，即对于 $\\theta \\in [\\theta_{0} - \\frac{\\pi}{4}, \\theta_{0} + \\frac{\\pi}{4}]$。\n\n分母为：\n$$\n\\int_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} m \\cos(2(\\theta - \\theta_{0})) \\, d\\theta = m \\left[ \\frac{\\sin(2(\\theta - \\theta_{0}))}{2} \\right]_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} = \\frac{m}{2}(\\sin(\\pi/2) - \\sin(-\\pi/2)) = \\frac{m}{2}(1 - (-1)) = m\n$$\n分子积分为：\n$$\nm \\int_{\\theta_{0}-\\pi/4}^{\\theta_{0}+\\pi/4} \\cos(2(\\theta - \\theta_{0})) \\exp(i 2\\theta) \\, d\\theta = m \\exp(i2\\theta_{0}) \\int_{-\\pi/4}^{\\pi/4} \\cos(2\\alpha) \\exp(i2\\alpha) \\, d\\alpha\n$$\n其中 $\\alpha = \\theta - \\theta_{0}$。该积分变为 $\\int_{-\\pi/4}^{\\pi/4} (\\cos^2(2\\alpha) + i \\cos(2\\alpha)\\sin(2\\alpha)) \\, d\\alpha$。虚部是一个奇函数在对称区间上的积分，结果为零。实部为 $\\int_{-\\pi/4}^{\\pi/4} \\cos^2(2\\alpha) \\, d\\alpha = \\int_{-\\pi/4}^{\\pi/4} \\frac{1+\\cos(4\\alpha)}{2} \\, d\\alpha = \\frac{1}{2}[\\alpha + \\frac{\\sin(4\\alpha)}{4}]_{-\\pi/4}^{\\pi/4} = \\frac{\\pi}{4}$。\n分子的模为 $|m \\exp(i2\\theta_{0}) \\frac{\\pi}{4}| = \\frac{m\\pi}{4}$。\n所以，校正后的 OSI 为：\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{m\\pi/4}{m} = \\frac{\\pi}{4}\n$$\n\n**4. 提出的经基线校正的运动方向选择性度量 ($\\text{DSI}_{\\text{corr}}$)**\n\n遵照在归一化前减去 $b$ 的指令，我们将刺激驱动的响应定义为 $R'_{\\mathrm{pref}} = R_{\\mathrm{pref}}-b$ 和 $R'_{\\mathrm{null}} = R_{\\mathrm{null}}-b$。归一化应该用这些刺激驱动响应的总和来进行。\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R'_{\\mathrm{pref}} - R'_{\\mathrm{null}}}{R'_{\\mathrm{pref}} + R'_{\\mathrm{null}}} = \\frac{(R_{\\mathrm{pref}}-b) - (R_{\\mathrm{null}}-b)}{(R_{\\mathrm{pref}}-b) + (R_{\\mathrm{null}}-b)} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}} - 2b}\n$$\n该度量比较的是差异刺激驱动响应与总刺激驱动响应。\n\n**5. 数值计算**\n\n给定值为 $b = 10$，$m = 8$，$R_{\\mathrm{pref}} = 28$ 和 $R_{\\mathrm{null}} = 12$。所有单位都是脉冲$\\cdot$s$^{-1}$。\n\n- 原始 OSI:\n$$\n\\text{OSI} = \\frac{m}{2b} = \\frac{8}{2 \\times 10} = 0.4\n$$\n- 原始 DSI:\n$$\n\\text{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}} = \\frac{28 - 12}{28 + 12} = \\frac{16}{40} = 0.4\n$$\n- 基线校正的 OSI:\n$$\n\\text{OSI}_{\\text{corr}} = \\frac{\\pi}{4} \\approx 0.785398...\n$$\n- 基线校正的 DSI:\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}} - 2b} = \\frac{28-12}{28+12-2(10)} = \\frac{16}{40-20} = \\frac{16}{20} = 0.8\n$$\n四舍五入到四位有效数字，我们得到：\n原始 OSI = $0.4000$\n原始 DSI = $0.4000$\n校正后的 OSI = $0.7854$\n校正后的 DSI = $0.8000$\n\n**6. 关于与 $b$ 无关的解释**\n\n对于所提出的基线校正方位度量 $\\text{OSI}_{\\text{corr}}$，在模型 $R(\\theta) = b + m\\cos(2(\\theta-\\theta_0))$ 下的推导得出了常数值 $\\pi/4$。操作 $\\max(0, R(\\theta) - b)$ 有效地移除了基线 $b$，只在刺激调制项 $m \\cos(2(\\theta-\\theta_0))$ 为正值时保留了它。在最终的比率中，调制幅度 $m$ 是分子和分母的公共因子，因此被约掉了。所得结果仅取决于整流后余弦函数的*形状*，而不取决于其幅度（$m$）或基线偏移（$b$）。\n\n对于所提出的基线校正运动方向度量 $\\text{DSI}_{\\text{corr}}$，其与 $b$ 的无关性可以通过将刺激驱动的响应视为神经元的基本属性，而将 $b$ 视为一个加性偏移来理解。令 $R'_{\\mathrm{pref}} = R_{\\mathrm{pref}} - b$ 和 $R'_{\\mathrm{null}} = R_{\\mathrm{null}} - b$ 为这些固定的、潜在的刺激驱动响应。那么测量的响应就是 $b$ 的函数：$R_{\\mathrm{pref}}(b) = R'_{\\mathrm{pref}} + b$ 和 $R_{\\mathrm{null}}(b) = R'_{\\mathrm{null}} + b$。将这些代入 $\\text{DSI}_{\\text{corr}}$ 的公式中：\n$$\n\\text{DSI}_{\\text{corr}} = \\frac{R_{\\mathrm{pref}}(b) - R_{\\mathrm{null}}(b)}{R_{\\mathrm{pref}}(b) + R_{\\mathrm{null}}(b) - 2b} = \\frac{(R'_{\\mathrm{pref}} + b) - (R'_{\\mathrm{null}} + b)}{(R'_{\\mathrm{pref}} + b) + (R'_{\\mathrm{null}} + b) - 2b} = \\frac{R'_{\\mathrm{pref}} - R'_{\\mathrm{null}}}{R'_{\\mathrm{pref}} + R'_{\\mathrm{null}}}\n$$\n项 $b$ 在分子和分母中通过代数运算被消去。最终的表达式仅取决于刺激驱动的响应 $R'_{\\mathrm{pref}}$ 和 $R'_{\\mathrm{null}}$，而与自发放电率 $b$ 无关。因此，对于具有给定刺激诱发响应特性的神经元，这种校正后的度量对其基线放电率的变化具有鲁棒性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000  0.4000  0.7854  0.8000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "尽管前馈模型为方向调谐提供了基本蓝图，但皮层中观测到的敏锐选择性通常被认为是网络相互作用的结果。本实践提供了一个动手编程的机会，您将构建一个包含V1简单细胞的循环网络，并亲眼见证侧向抑制如何锐化其调谐曲线，同时还将接触到网络稳定性这一关键概念。这项练习将理论与实践相结合，使您能够通过模拟来探索一个关于大脑皮层计算的核心假设。",
            "id": "3983190",
            "problem": "您需要实现一个基于仿真的分析，研究一个带有侧向抑制的初级视皮层（V1）简单细胞简化网络模型中的方向选择性。核心建模组件必须根据 Gabor 函数线性滤波、半波整流和阈值线性抑制相互作用等基本原理来构建，以便量化方向选择性的锐化程度并分析局部映射的稳定性。\n\n将使用的基本依据和定义：\n- 二维 Gabor 滤波器定义为一个高斯包络调制一个正弦载波。设空间坐标为 $(x,y)$，偏好方向为 $\\theta_i$。通过将角度为 $\\theta_i$ 的旋转矩阵应用于 $(x,y)$ 来定义旋转坐标 $(x',y')$。Gabor 滤波器由下式给出：\n$$\ng_i(x,y) \\;=\\; \\exp\\!\\left(-\\frac{{x'}^2}{2\\sigma_x^2} - \\frac{{y'}^2}{2\\sigma_y^2}\\right)\\,\\cos\\!\\big(2\\pi f_0\\,x'\\big),\n$$\n其中 $\\sigma_x$、$\\sigma_y$ 是高斯包络沿滤波器主轴的标准差， $f_0$ 是载波空间频率，单位为周期/单位长度。\n- 方向为 $\\theta$ 的正弦光栅刺激由下式给出：\n$$\ns_\\theta(x,y) \\;=\\; \\cos\\!\\left(2\\pi f_s\\,(x\\cos\\theta + y\\sin\\theta)\\right).\n$$\n为确保在有限网格上内积的能量有限，在计算积分之前，使用高斯窗函数 $w(x,y) = \\exp\\!\\left(-\\frac{x^2+y^2}{2\\sigma_w^2}\\right)$ 对刺激进行加窗。\n- 一个简单细胞对刺激 $s_\\theta$ 的线性驱动是空间内积：\n$$\nb_i(\\theta) \\;=\\; \\iint g_i(x,y)\\,\\big(s_\\theta(x,y)\\,w(x,y)\\big)\\,dx\\,dy,\n$$\n该积分通过在有限网格上进行黎曼和来数值近似。\n- 半波整流输出（一个标准的线性-非线性级联模型）为 $r_i^{\\mathrm{ff}}(\\theta) = \\max\\big(0,\\,b_i(\\theta)\\big)$。\n- 侧向抑制由一个阈值线性循环网络建模。对于一个固定的刺激方向 $\\theta$，设 $\\mathbf{b}(\\theta) \\in \\mathbb{R}^K$ 是 $K$ 个细胞的驱动向量，并设 $W \\in \\mathbb{R}^{K\\times K}$ 是一个对称的非负侧向相互作用矩阵，该矩阵由方向空间中的角度邻近度参数化。稳态响应 $\\mathbf{r}(\\theta)\\in\\mathbb{R}^K_{\\ge 0}$ 满足不动点条件：\n$$\n\\mathbf{r}(\\theta) \\;=\\; \\big[\\mathbf{b}(\\theta) \\;-\\; \\gamma\\,W\\,\\mathbf{r}(\\theta)\\big]_+,\n$$\n其中 $[\\cdot]_+$ 表示逐元素整流，$\\gamma \\ge 0$ 是抑制增益。\n- 细胞 $i$ 在一组刺激方向 $\\{\\theta_m\\}_{m=1}^M$ 上的方向选择性指数 (OSI) 使用具有 $\\pi$-周期性的循环矩定义计算：\n$$\n\\mathrm{OSI}_i \\;=\\; \\frac{\\left|\\sum_{m=1}^M r_i(\\theta_m)\\,e^{\\mathrm{i}\\,2\\theta_m}\\right|}{\\sum_{m=1}^M r_i(\\theta_m)},\n$$\n约定当分母为零时 $\\mathrm{OSI}_i = 0$。角度 $\\theta$ 必须以弧度为单位。\n- 映射稳定性通过阈值线性映射在不动点处的雅可比矩阵的谱半径来分析。对于离散时间映射 $\\mathbf{F}(\\mathbf{r}) = [\\mathbf{b} - \\gamma W \\mathbf{r}]_+$，一个不动点 $\\mathbf{r}^\\star$ 的局部雅可比矩阵为：\n$$\nJ(\\mathbf{r}^\\star) \\;=\\; -\\gamma\\,D(\\mathbf{r}^\\star)\\,W,\n$$\n其中 $D(\\mathbf{r}^\\star)$ 是一个对角指示矩阵，如果 $r_i^\\star>0$，则其元素 $D_{ii}=1$，否则为 $0$。如果谱半径 $\\rho(J(\\mathbf{r}^\\star))  1$，则可以保证离散迭代 $\\mathbf{r}_{t+1}=\\mathbf{F}(\\mathbf{r}_t)$ 的局部收缩性，从而保证其局部稳定性。\n\n任务要求：\n1) 实现一个程序，构建 $K$ 个有向 Gabor 滤波器 $g_i$，其偏好方向 $\\theta_i$ 在 $[0,\\pi)$ 范围内均匀间隔分布。该程序还需计算这些滤波器对一组 $M$ 个正弦光栅 $s_{\\theta_m}$ 的线性驱动 $b_i(\\theta_m)$，这些光栅的方向 $\\theta_m$ 也在 $[0,\\pi)$ 范围内均匀间隔分布。计算中使用有限网格离散化，并对刺激使用高斯窗函数 $w$。使用半波整流得到 $r_i^{\\mathrm{ff}}(\\theta_m)=\\max(0,b_i(\\theta_m))$。\n2) 使用宽度为 $\\sigma_\\theta$ 的环形高斯核，在具有 $[0,\\pi)$ 环绕距离的方向空间上构建侧向相互作用矩阵 $W$：\n$$\nW_{ij} \\;=\\; \\exp\\!\\left(-\\frac{d_\\pi(\\theta_i,\\theta_j)^2}{2\\sigma_\\theta^2}\\right), \\quad W_{ii}=0,\n$$\n其中 $d_\\pi(\\alpha,\\beta)=\\min\\big(|\\alpha-\\beta|,\\,\\pi-|\\alpha-\\beta|\\big)$。通过将 $W$ 除以其最大特征值的绝对值来归一化，使其谱半径恰好为 $1$。\n3) 对于每个测试用例和每个刺激方向 $\\theta_m$，通过迭代阈值线性动力学 $\\mathbf{r}_{t+1} = [\\mathbf{b}(\\theta_m) - \\gamma W \\mathbf{r}_t]_+$ 来计算循环稳态 $\\mathbf{r}^\\star(\\theta_m)$，直到在小容差范围内收敛到不动点。您可以使用欠松弛（与前一次迭代进行常数凸组合）来辅助收敛；不动点在这种阻尼下是不变的。然后，为每个 $\\theta_m$ 计算不动点处的局部雅可比矩阵 $J(\\mathbf{r}^\\star(\\theta_m))$ 及其谱半径 $\\rho_m$。\n4) 对于每个测试用例，计算：\n   - 所有细胞的平均 OSI 增益，定义为 $\\mathrm{OSI}_i^{\\mathrm{post}} - \\mathrm{OSI}_i^{\\mathrm{pre}}$ 对 $i$ 的平均值，其中“pre”使用 $r_i^{\\mathrm{ff}}(\\theta_m)$，“post”使用 $r_i^\\star(\\theta_m)$。\n   - 所有刺激中的最大雅可比谱半径，即 $\\max_m \\rho_m$。\n   - 一个稳定性布尔值，当且仅当对于所有 $m$ 都有 $\\rho_m  1$ 时为真。\n\n为确保可复现性的数值规格：\n- 使用大小为 $N\\times N$ 的方形网格，其中 $N=64$，范围为 $[-L,L]\\times[-L,L]$，$L=1.0$。使用黎曼和权重 $\\Delta x=\\Delta y=2L/N$。\n- 使用 $K=16$ 个细胞，其偏好方向为 $\\theta_i = i\\pi/K$，其中 $i\\in\\{0,1,\\dots,K-1\\}$。\n- 使用 $M=18$ 个刺激方向，$\\theta_m = m\\pi/M$，其中 $m\\in\\{0,1,\\dots,M-1\\}$。\n- 使用 Gabor 参数 $\\sigma_x=0.40$，$\\sigma_y=0.20$，$f_0=2.0$，载波相位为 $0$；以及刺激参数 $f_s=2.0$，$\\sigma_w=0.80$。\n- 对于侧向核，使用 $\\sigma_\\theta=0.35$。构建 $W$ 时令 $W_{ii}=0$，然后将其归一化，使其谱半径恰好为 $1$。\n- 对于不动点迭代，初始化 $\\mathbf{r}_0=\\max(0,\\mathbf{b}(\\theta_m))$，使用欠松弛因子 $\\alpha=0.5$，连续迭代值之间的欧几里得范数差的收敛容差为 $10^{-8}$，最大迭代次数为 $1000$ 次。\n\n测试套件：\n提供以下四个参数集的结果，它们仅在抑制增益 $\\gamma$ 上有所不同：\n- Case A: $\\gamma = 0.00$。\n- Case B: $\\gamma = 0.40$。\n- Case C: $\\gamma = 0.90$。\n- Case D: $\\gamma = 1.10$。\n\n角度单位要求：\n- 所有角度，包括 $\\theta$、$\\theta_i$ 和 $\\theta_m$，都必须以弧度为单位处理。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的 Python 风格的列表的列表，每个测试用例一个，顺序为 [Case A, Case B, Case C, Case D]。每个内部列表的形式必须是 [mean_osi_gain, max_spectral_radius, is_stable]，其中 mean_osi_gain 和 max_spectral_radius 是浮点数，is_stable 是布尔值。例如，打印的行必须如下所示：\n\"[[x1,y1,True],[x2,y2,False],[x3,y3,True],[x4,y4,True]]\"\n没有空格，也没有额外的文本。除了指定角度以弧度为单位外，不需要其他物理单位。",
            "solution": "用户的请求是计算神经科学领域一个有效且适定的问题。我将提供一个完整的解决方案。\n\n### 基于原理的设计\n\n该问题要求实现并分析一个简化的初级视皮层（V1）方向处理模型。该模型由几个经典组件组成：作为简单细胞感受野的 Gabor 滤波器，用于发放率转换的半波整流，以及用于锐化调谐曲线的带侧向抑制的循环网络。分析内容包括通过方向选择性指数（OSI）量化这种锐化，并通过局部雅可比矩阵的谱半径评估网络稳定性。\n\n解决方案被构建为一系列逻辑步骤，从定义模型组件到仿真其动力学并执行所需的分析。\n\n**1. 模型环境与刺激定义**\n\n首先，我们建立空间域和刺激集。该模型在一个代表一小块视野的离散网格上运行。\n\n- **空间网格**：一个大小为 $N \\times N$ 的方形网格代表空间坐标 $(x,y)$。问题指定 $N=64$ 个点，覆盖域 $[-L, L] \\times [-L, L]$，其中 $L=1.0$。离散化步长是均匀的，$\\Delta x = \\Delta y = 2L/N$。\n- **方向**：我们定义两组方向。一组是 $K=16$ 个模型神经元的偏好方向，$\\theta_i = i\\pi/K$，$i \\in \\{0, \\dots, K-1\\}$。另一组是 $M=18$ 个输入刺激的方向，$\\theta_m = m\\pi/M$，$m \\in \\{0, \\dots, M-1\\}$。所有角度都以弧度为单位。\n- **刺激创建**：刺激是正弦光栅，这是探测方向选择性细胞的标准选择。每个光栅 $s_{\\theta_m}(x,y)$ 必须用高斯函数 $w(x,y)$ 加窗，以确保其空间局部化并具有有限能量。对于 $M$ 个方向中的每一个，我们在 $N \\times N$ 网格上生成一个刺激图像：\n$$\nS_m(x,y) = s_{\\theta_m}(x,y)\\,w(x,y) = \\cos\\!\\left(2\\pi f_s\\,(x\\cos\\theta_m + y\\sin\\theta_m)\\right) \\exp\\!\\left(-\\frac{x^2+y^2}{2\\sigma_w^2}\\right)\n$$\n参数给定为 $f_s=2.0$ 和 $\\sigma_w=0.80$。\n\n**2. 简单细胞感受野与前馈驱动**\n\nV1 简单细胞的感受野由 Gabor 滤波器建模。神经元对刺激的响应首先通过线性滤波操作计算。\n\n- **Gabor 滤波器**：对于 $K$ 个神经元中的每一个，生成一个二维 Gabor 滤波器 $g_i(x,y)$。该函数是高斯包络和正弦载波的乘积。其方向由细胞的偏好方向 $\\theta_i$ 决定。公式为：\n$$\ng_i(x,y) \\;=\\; \\exp\\!\\left(-\\frac{{x'}^2}{2\\sigma_x^2} - \\frac{{y'}^2}{2\\sigma_y^2}\\right)\\,\\cos\\!\\big(2\\pi f_0\\,x'\\big)\n$$\n其中 $(x', y')$ 是旋转后的坐标：$x' = x\\cos\\theta_i + y\\sin\\theta_i$ 和 $y' = -x\\sin\\theta_i + y\\cos\\theta_i$。指定的参数为 $\\sigma_x=0.40$，$\\sigma_y=0.20$ 和 $f_0=2.0$。\n- **线性驱动**：细胞 $i$ 对刺激 $m$ 的线性驱动 $b_i(\\theta_m)$ 是该细胞的 Gabor 滤波器和加窗后刺激的内积。在我们的离散网格上，这个积分通过黎曼和来近似：\n$$\nb_i(\\theta_m) = \\iint g_i(x,y) S_m(x,y) \\,dx\\,dy \\approx \\sum_{j,k} g_i(x_j, y_k) S_m(x_j, y_k) (\\Delta x \\Delta y)\n$$\n对所有 $K$ 个细胞和所有 $M$ 个刺激执行此计算，得到一个 $K \\times M$ 的线性驱动矩阵 $B = [b_{im}]$。\n- **前馈响应（半波整流）**：神经元的发放率不能为负。这通过半波整流非线性来建模。前馈响应 $r_i^{\\mathrm{ff}}(\\theta_m)$ 为：\n$$\nr_i^{\\mathrm{ff}}(\\theta_m) = \\max\\big(0,\\,b_i(\\theta_m)\\big) = [b_i(\\theta_m)]_+\n$$\n\n**3. 侧向相互作用网络**\n\n该模型包括神经元之间的侧向连接，用于介导抑制。这是锐化方向调谐的关键机制。\n\n- **权重矩阵构建**：细胞 $i$ 和细胞 $j$ 之间的连接强度 $W_{ij}$ 取决于它们偏好方向 $\\theta_i$ 和 $\\theta_j$ 之间的差异。问题指定了在方向空间 $[0, \\pi)$ 上的一个环形高斯核：\n$$\nW_{ij} \\;=\\; \\exp\\!\\left(-\\frac{d_\\pi(\\theta_i,\\theta_j)^2}{2\\sigma_\\theta^2}\\right) \\quad \\text{with} \\quad W_{ii}=0\n$$\n其中 $d_\\pi(\\alpha,\\beta)=\\min\\big(|\\alpha-\\beta|,\\,\\pi-|\\alpha-\\beta|\\big)$ 是方向圆环上的环绕距离。参数 $\\sigma_\\theta=0.35$ 控制方向空间中抑制的宽度。\n- **归一化**：为了控制相互作用的总体强度并确保可比性，权重矩阵 $W$ 被归一化，使其谱半径 $\\rho(W) = \\max_k |\\lambda_k(W)|$ 恰好为 $1$。这是通过计算矩阵的特征值，找到模最大的那个，然后将 $W$ 的所有元素除以这个值来实现的。\n\n**4. 循环网络动力学与稳态**\n\n神经元的最终响应不仅仅是前馈驱动，而是由循环抑制信号塑造的。稳态响应是网络动力学的不动点。\n\n- **不动点方程**：对于给定的刺激方向 $\\theta$，稳态响应向量 $\\mathbf{r}(\\theta)$ 必须满足：\n$$\n\\mathbf{r}(\\theta) \\;=\\; \\big[\\mathbf{b}(\\theta) \\;-\\; \\gamma\\,W\\,\\mathbf{r}(\\theta)\\big]_+\n$$\n其中 $\\mathbf{b}(\\theta)$ 是线性驱动向量，$\\gamma$ 是抑制增益，$[\\cdot]_+$ 是逐元素整流。\n- **迭代解**：对于每个刺激方向 $\\theta_m$，这个不动点方程通过数值方法求解。我们使用带有欠松弛的迭代方案来增强稳定性和收敛性：\n$$\n\\mathbf{r}_{t+1} = (1 - \\alpha) \\mathbf{r}_t + \\alpha \\left[\\mathbf{b}(\\theta_m) - \\gamma W \\mathbf{r}_t\\right]_+\n$$\n迭代从前馈响应开始，$\\mathbf{r}_0 = \\mathbf{r}^{\\mathrm{ff}}(\\theta_m) = [\\mathbf{b}(\\theta_m)]_+$，并持续进行，直到连续迭代值之间的变化 $\\|\\mathbf{r}_{t+1} - \\mathbf{r}_t\\|_2$ 低于 $10^{-8}$ 的容差。指定的欠松弛因子为 $\\alpha=0.5$。最终收敛的向量即为稳态响应 $\\mathbf{r}^\\star(\\theta_m)$。\n\n**5. 调谐与稳定性分析**\n\n最后一步是分析对于每个抑制增益 $\\gamma$ 值的仿真结果。\n\n- **方向选择性指数 (OSI)**：OSI 量化了神经元对方向的调谐有多锐利。我们使用循环矩定义，该定义鲁棒且被广泛使用：\n$$\n\\mathrm{OSI}_i \\;=\\; \\frac{\\left|\\sum_{m=1}^M r_i(\\theta_m)\\,e^{\\mathrm{i}\\,2\\theta_m}\\right|}{\\sum_{m=1}^M r_i(\\theta_m)}\n$$\n分子代表复平面中一个合成向量的长度，其中每个响应 $r_i(\\theta_m)$ 贡献一个大小相等、角度为 $2\\theta_m$ 的向量。因子 $2$ 是为了说明方向的 $\\pi$-周期性。我们对每个细胞 $i$ 分别使用抑制前（前馈）响应 $r_i^{\\mathrm{ff}}$ 和抑制后（稳态）响应 $r_i^\\star$ 来计算此值。平均 OSI 增益是平均差异：$\\langle \\mathrm{OSI}^{\\mathrm{post}} - \\mathrm{OSI}^{\\mathrm{pre}} \\rangle_i$。\n- **局部稳定性分析**：网络稳态响应的稳定性至关重要。一个不稳定的网络会表现出振荡或混沌活动。不动点 $\\mathbf{r}^\\star$ 的局部稳定性由在 $\\mathbf{r}^\\star$ 处评估的迭代映射的雅可比矩阵的谱半径决定。雅可比矩阵由下式给出：\n$$\nJ(\\mathbf{r}^\\star) \\;=\\; -\\gamma\\,D(\\mathbf{r}^\\star)\\,W\n$$\n其中 $D(\\mathbf{r}^\\star)$ 是一个对角矩阵，如果相应神经元是活跃的 ($r_i^\\star > 0$)，则 $D_{ii}=1$，否则 $D_{ii}=0$。如果不动点的谱半径 $\\rho(J)  1$，则该不动点是局部稳定的。我们为每个刺激方向 $\\theta_m$ 计算这个谱半径 $\\rho_m = \\rho(J(\\mathbf{r}^\\star(\\theta_m)))$。对于给定的 $\\gamma$，总体稳定性度量是在所有刺激中找到的最大谱半径，即 $\\max_m \\rho_m$。当且仅当该最大值小于 $1$ 时，系统被认为是稳定的。\n\n这些步骤将针对四个指定的 $\\gamma$ 值中的每一个进行实现，并且所得的度量（平均 OSI 增益、最大谱半径、稳定性）将被收集并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a simulation-based analysis of orientation selectivity\n    in a simplified V1 simple cell network model.\n    \"\"\"\n\n    # 1. Numerical Specifications and Setup\n    N = 64  # Grid size\n    L = 1.0  # Spatial extent [-L, L]\n    K = 16  # Number of cells\n    M = 18  # Number of stimulus orientations\n    \n    # Gabor parameters\n    SIGMA_X = 0.40\n    SIGMA_Y = 0.20\n    F0 = 2.0\n    \n    # Stimulus parameters\n    F_S = 2.0\n    SIGMA_W = 0.80\n    \n    # Network parameters\n    SIGMA_THETA = 0.35\n    ALPHA = 0.5  # Under-relaxation factor\n    TOLERANCE = 1e-8\n    MAX_ITER = 1000\n\n    # Test suite for inhibitory gain gamma\n    gammas = [0.00, 0.40, 0.90, 1.10]\n\n    # Create spatial grid\n    grid_pts = np.linspace(-L, L, N)\n    x, y = np.meshgrid(grid_pts, grid_pts)\n    dx = dy = 2.0 * L / N\n\n    # Create orientation sets\n    thetas_i = np.arange(K) * np.pi / K  # Cell preferred orientations\n    thetas_m = np.arange(M) * np.pi / M  # Stimulus orientations\n\n    # 2. Pre-compute Stimuli and Gabor Filters\n    \n    # Window function\n    window = np.exp(-(x**2 + y**2) / (2 * SIGMA_W**2))\n\n    # Stimuli (M of them, each N x N)\n    stimuli = np.zeros((M, N, N))\n    for m, theta_m in enumerate(thetas_m):\n        stimulus_grating = np.cos(2 * np.pi * F_S * (x * np.cos(theta_m) + y * np.sin(theta_m)))\n        stimuli[m, :, :] = stimulus_grating * window\n\n    # Gabor filters (K of them, each N x N)\n    gabor_filters = np.zeros((K, N, N))\n    for i, theta_i in enumerate(thetas_i):\n        x_prime = x * np.cos(theta_i) + y * np.sin(theta_i)\n        y_prime = -x * np.sin(theta_i) + y * np.cos(theta_i)\n        envelope = np.exp(-(x_prime**2 / (2 * SIGMA_X**2) + y_prime**2 / (2 * SIGMA_Y**2)))\n        carrier = np.cos(2 * np.pi * F0 * x_prime)\n        gabor_filters[i, :, :] = envelope * carrier\n\n    # 3. Compute Linear Drives and Feedforward Responses\n    B = np.zeros((K, M))  # Linear drives matrix\n    for i in range(K):\n        for m in range(M):\n            # Riemann sum for inner product\n            B[i, m] = np.sum(gabor_filters[i] * stimuli[m]) * dx * dy\n    \n    R_ff = np.maximum(0, B) # Feedforward responses\n\n    # 4. Construct and Normalize Lateral Interaction Matrix W\n    def circular_dist(a, b, period=np.pi):\n        diff = np.abs(a - b)\n        return np.minimum(diff, period - diff)\n\n    W = np.zeros((K, K))\n    for i in range(K):\n        for j in range(K):\n            if i == j:\n                W[i, j] = 0\n            else:\n                dist_sq = circular_dist(thetas_i[i], thetas_i[j])**2\n                W[i, j] = np.exp(-dist_sq / (2 * SIGMA_THETA**2))\n\n    # Normalize W to have spectral radius of 1\n    eigenvalues_w = np.linalg.eigvals(W)\n    spectral_radius_w = np.max(np.abs(eigenvalues_w))\n    W /= spectral_radius_w\n\n    # 5. Define analysis functions\n    def compute_osi(responses, thetas):\n        \"\"\"Computes OSI for all cells.\"\"\"\n        # responses is K x M, thetas is M\n        numerator = np.abs(np.dot(responses, np.exp(2j * thetas)))\n        denominator = np.sum(responses, axis=1)\n        \n        # Handle case where a cell is silent\n        # np.divide handles division by zero, resulting in zero\n        osi = np.divide(numerator, denominator, out=np.zeros_like(numerator, dtype=float), where=denominator!=0)\n        return osi\n\n    # Compute pre-inhibition OSIs\n    osi_pre = compute_osi(R_ff, thetas_m)\n\n    # 6. Main loop over test cases\n    final_results = []\n    for gamma in gammas:\n        R_star = np.zeros((K, M))  # Steady-state responses\n        rhos = []  # Spectral radii for each stimulus\n\n        for m in range(M):\n            b_m = B[:, m]\n            \n            # Find fixed point by iteration\n            r_t = np.maximum(0, b_m)\n            for _ in range(MAX_ITER):\n                r_prime_t1 = np.maximum(0, b_m - gamma * np.dot(W, r_t))\n                r_t1 = (1 - ALPHA) * r_t + ALPHA * r_prime_t1\n                if np.linalg.norm(r_t1 - r_t)  TOLERANCE:\n                    break\n                r_t = r_t1\n            r_star_m = r_t\n            R_star[:, m] = r_star_m\n\n            # Compute Jacobian and its spectral radius\n            if gamma == 0:\n                rho_m = 0.0\n            else:\n                D = np.diag(r_star_m > 0)\n                J = -gamma * np.dot(D, W)\n                eigenvalues_j = np.linalg.eigvals(J)\n                rho_m = np.max(np.abs(eigenvalues_j))\n            rhos.append(rho_m)\n\n        # Compute post-inhibition OSIs\n        osi_post = compute_osi(R_star, thetas_m)\n        \n        # Calculate final metrics for this case\n        mean_osi_gain = np.mean(osi_post - osi_pre)\n        max_spectral_radius = np.max(rhos)\n        is_stable = max_spectral_radius  1.0\n\n        final_results.append([mean_osi_gain, max_spectral_radius, is_stable])\n\n    # 7. Format and print the final output\n    # Use repr and string replacement for exact, space-free formatting\n    output_str = repr(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个优秀的计算模型不仅要能复现基本的调谐曲线，还应能捕捉到真实神经元中观察到的其他关键生理特性。在最后的这个练习中，您将扮演一位模型验证者的角色，用您的模型来检验它是否能符合诸如对比度不变性和交叉方向抑制等皮层处理的关键实验基准。这项任务强调了计算神经科学中模型验证的迭代过程，即模型需要不断地与实验数据进行对比和修正。",
            "id": "4000032",
            "problem": "给定一个简化的神经元模型家族，用于描述初级视皮层中的方位调谐，该模型由一个前馈驱动和一个除法归一化阶段构成。刺激是一个漂移正弦光栅，其特征由以度为单位的方位和以任意单位计的对比度来描述。目标是评估方位选择性的实验特征，并根据从广泛观察到的现象中得出的标准来验证模型。\n\n基本基础。使用以下事实作为建模和推导的起点：\n- 响应正弦光栅的方位调谐滤波器的前馈驱动与对比度成正比，并且是方位的一个周期函数，周期为 $180^{\\circ}$，这反映了方位是一个没有符号的方向。对于偶对称能量模型，方位依赖性可以表示为方位差两倍的余弦。\n- 神经元的输入-输出转换可以由半波整流和捕获脉冲生成非线性的幂律指数来近似。\n- 除法归一化捕捉了在视皮层中广泛报道的网络级抑制性稳定和增益控制效应，其建模方式是通过一个随总对比度增长的因子来缩放输出。\n\n模型定义。设偏好方位为 $\\theta_0$ 度。对于以度为单位的刺激方位 $\\theta$ 和对比度 $c \\ge 0$，将前馈驱动定义为\n$$\nD(\\theta;c) = k c [b + m \\cos(2(\\theta - \\theta_0))]\n$$\n其中 $k > 0$ 是增益，$b \\ge 0$ 是基线驱动，$m \\ge 0$ 控制方位调制幅度。神经非线性应用半波整流，后跟一个指数为 $p \\ge 1$ 的幂律：\n$N(D) = \\max(D,0)^p.$\n除法归一化通过一个依赖于对比度的因子来缩放此值，其强度为 $\\gamma \\ge 0$：\n$$\nR(\\theta;c) = \\frac{N(D(\\theta;c))}{1 + \\gamma c}.\n$$\n对于交叉方位抑制，考虑添加一个对比度为 $c_m \\ge 0$ 的正交掩模光栅。组合驱动假设对掩模进行效率为 $\\alpha \\ge 0$ 的线性求和，而归一化则取决于总对比度：\n$$\nD_{\\text{mask}}(\\theta;c,c_m) = D(\\theta;c) + \\alpha k c_m [m \\cos(2(\\theta - \\theta_0 - 90^{\\circ}))]\n$$\n$$\nR_{\\text{mask}}(\\theta;c,c_m) = \\frac{\\max(D_{\\text{mask}}(\\theta;c,c_m),0)^p}{1 + \\gamma (c + c_m)}.\n$$\n\n实验特征与验证度量。对于所有计算，角度必须以度为单位。\n1. 偏好方位稳定性：令 $\\theta_{\\text{pref}}(c)$ 为在 $[0,180)$ 范围内使 $R(\\theta;c)$ 最大化的方位。定义偏好方位稳定性度量\n$$\n\\Delta\\theta_{\\text{pref}} = \\min\\left(\\left|\\theta_{\\text{pref}}(c_h) - \\theta_{\\text{pref}}(c_\\ell)\\right|, 180^{\\circ} - \\left|\\theta_{\\text{pref}}(c_h) - \\theta_{\\text{pref}}(c_\\ell)\\right|\\right),\n$$\n其中 $c_\\ell$ 和 $c_h$ 分别为低对比度和高对比度。\n2. 半峰全宽 (FWHM) 带宽：对于给定的对比度 $c$，定义 $W(c)$ 为在 $[0,180)$ 范围内，围绕 $\\theta_{\\text{pref}}(c)$ 的连续区域的宽度（以度为单位），在该区域内 $R(\\theta;c)$ 至少是其在该对比度 $c$ 下峰值的一半。如果对于所有 $\\theta$，$R(\\theta;c)$ 恒为零，则设 $W(c)=180$。\n3. 对比度不变性度量 (CIM)：\n$$\n\\mathrm{CIM} = \\frac{\\left|W(c_h) - W(c_\\ell)\\right|}{W(c_h)}.\n$$\n4. 交叉方位抑制指数 (XSI)：在高对比度 $c_h$ 下，比较峰值响应与相同方位下的掩模响应：\n$$\n\\mathrm{XSI} = \\begin{cases} \\frac{R(\\theta_{\\text{pref}}(c_h);c_h) - R_{\\text{mask}}(\\theta_{\\text{pref}}(c_h);c_h,c_m)}{R(\\theta_{\\text{pref}}(c_h);c_h)},  R(\\theta_{\\text{pref}}(c_h);c_h) > 0, \\\\[6pt] 0,  \\text{否则。} \\end{cases}\n$$\n5. 高对比度下的方位选择性指数 (OSI)：\n$$\n\\mathrm{OSI} = \\begin{cases} 1 - \\frac{R(\\theta_{\\text{pref}}(c_h)+90^{\\circ} \\;\\text{mod}\\;180^{\\circ};c_h)}{R(\\theta_{\\text{pref}}(c_h);c_h)},  R(\\theta_{\\text{pref}}(c_h);c_h) > 0, \\\\[6pt] 0,  \\text{否则。} \\end{cases}\n$$\n\n验证标准。如果以下所有条件均成立，则宣布模型实例通过验证：\n- $\\Delta\\theta_{\\text{pref}} \\le 5^{\\circ}$，\n- $\\mathrm{CIM} \\le 0.1$，\n- $\\mathrm{XSI} \\ge 0.2$，\n- $\\mathrm{OSI} \\ge 0.5$。\n\n计算要求。你的程序必须：\n- 实现上述模型和度量，以足够的分辨率在 $[0,180)$ 范围内对 $\\theta$ 进行采样，以准确估计 $\\theta_{\\text{pref}}(c)$ 和 $W(c)$。所有角度计算均使用度。\n- 对于 FWHM，确定峰值周围 $R(\\theta;c)$ 至少为半峰值的连续片段，并应用 $[0,180)$ 上的周期性边界条件，报告其宽度（以度为单位）。\n\n测试套件。评估以下模型参数集，其中每个测试用例是一个元组：\n$(k, b, m, p, \\gamma, \\alpha, \\theta_0, c_\\ell, c_h, c_m)$。\n使用以下四个案例：\n- 案例1（理想路径）：$(1.0, 0.3, 0.7, 2.0, 0.8, 1.0, 40.0, 0.1, 1.0, 1.0)$。\n- 案例2（无归一化）：$(1.0, 0.3, 0.7, 1.0, 0.0, 0.5, 40.0, 0.1, 1.0, 1.0)$。\n- 案例3（边界高非线性）：$(1.0, 0.05, 1.0, 3.0, 1.5, 0.5, 10.0, 0.05, 0.8, 0.8)$。\n- 案例4（边缘情况无调制）：$(1.0, 0.3, 0.0, 2.0, 0.5, 1.0, 75.0, 0.1, 1.0, 1.0)$。\n\n最终输出格式。你的程序应生成单行输出，其中包含四个测试用例的布尔验证结果，形式为方括号内以逗号分隔的列表（例如，“[True,False,True,False]”）。",
            "solution": "该问题要求实现并验证一个简化的初级视皮层神经元方位选择性计算模型。模型对定向正弦光栅的响应由前馈驱动、非线性变换和除法归一化定义。我们的任务是为四组不同的模型参数计算几种已建立的方位调谐实验特征。这些特征是：偏好方位稳定性($\\Delta\\theta_{\\text{pref}}$)、调谐带宽的对比度不变性度量 (CIM)、交叉方位抑制指数 (XSI) 和方位选择性指数 (OSI)。最后，每个参数集（或模型实例）将根据这些度量的一组标准进行验证。\n\n首先，我们将构建代表神经元响应的核心函数，然后实现计算每个指定度量的函数。接着，我们会将这些组件组合成一个完整的验证流程，以评估每个测试用例。所有角度计算都将按规定以度为单位进行。\n\n模型由一系列变换定义。对于方位为 $\\theta$、对比度为 $c$ 的刺激，其前馈驱动 $D$ 由以下公式给出：\n$$\nD(\\theta;c) = k\\,c\\,[\\,b + m\\,\\cos(2(\\theta - \\theta_0))\\,]\n$$\n其中 $k$、$b$、$m$ 和 $\\theta_0$ 是模型参数。输入角度 $\\theta$ 和 $\\theta_0$ 以度为单位，因此余弦函数的参数必须转换为弧度进行计算。此驱动 $D$ 随后通过一个半波整流和幂律非线性变换 $N(D) = \\max(D,0)^p$。最终响应 $R$ 通过除法归一化获得：\n$$\nR(\\theta;c) = \\frac{N(D(\\theta;c))}{1 + \\gamma\\,c}\n$$\n\n对于交叉方位抑制实验，引入了一个掩模光栅。组合驱动 $D_{\\text{mask}}$ 定义为：\n$$\nD_{\\text{mask}}(\\theta;c,c_m) = D(\\theta;c) + \\alpha\\,k\\,c_m\\,[\\,m\\,\\cos(2(\\theta - \\theta_0 - 90^{\\circ}))\\,]\n$$\n利用三角恒等式 $\\cos(x - 180^{\\circ}) = -\\cos(x)$，掩模项可以简化为：$\\cos(2(\\theta - \\theta_0) - 180^{\\circ}) = -\\cos(2(\\theta - \\theta_0))$。这可将组合驱动简化为：\n$$\nD_{\\text{mask}}(\\theta;c,c_m) = k\\,c\\,b + k\\,m\\,(c - \\alpha\\,c_m)\\,\\cos(2(\\theta - \\theta_0))\n$$\n对掩模刺激的响应 $R_{\\text{mask}}$ 应用相同的非线性变换，但其归一化项取决于对比度之和 $c$ 和 $c_m$：\n$$\nR_{\\text{mask}}(\\theta;c,c_m) = \\frac{\\max(D_{\\text{mask}}(\\theta;c,c_m),0)^p}{1 + \\gamma\\,(c + c_m)}\n$$\n\n为了数值计算这些度量，我们必须在其范围 $[0, 180)$ 内对方向 $\\theta$ 进行采样。需要足够高的分辨率来准确估计峰值方位和调谐宽度。我们将使用一组从 $0^{\\circ}$ 到 $180^{\\circ}$ 的离散角度，并采用一个精细的步长，例如 $0.1^{\\circ}$。\n\n各项度量的计算方法如下：\n\n1.  **偏好方位 $\\theta_{\\text{pref}}(c)$**：对于给定的对比度 $c$，我们为所有采样的方位 $\\theta$ 计算 $R(\\theta;c)$，并找出产生最大响应的方位。在数值上，这通过在响应数组中找到最大值的索引并检索相应的角度来实现。\n    然后，使用低对比度 ($c_\\ell$) 和高对比度 ($c_h$) 下的偏好方位计算稳定性度量 $\\Delta\\theta_{\\text{pref}}$，同时考虑到方位空间周期为 $180^{\\circ}$ 的循环特性。\n\n2.  **半峰全宽 (FWHM) $W(c)$**：对于给定的对比度 $c$，我们首先找到峰值响应 $R_{\\text{peak}} = R(\\theta_{\\text{pref}}(c);c)$。半峰值为 $0.5 \\times R_{\\text{peak}}$。FWHM 是峰值周围响应等于或高于此半峰值的连续区域的总宽度（以度为单位）。鉴于该模型产生的调谐曲线具有单峰性（由于单个余弦项），该区域保证是连续的。因此，我们可以找到所有满足 $R(\\theta;c) \\ge 0.5 \\times R_{\\text{peak}}$ 的方位，并将其总宽度相加。根据定义，在 $R(\\theta;c)$ 对所有 $\\theta$ 恒为零的特殊情况下，$W(c) = 180^{\\circ}$。\n\n3.  **对比度不变性度量 (CIM)**：该度量量化了调谐宽度随对比度的变化。它由低对比度 ($c_\\ell$) 和高对比度 ($c_h$) 下的 FWHM 值计算得出：$\\mathrm{CIM} = |W(c_h) - W(c_\\ell)| / W(c_h)$。如果 $W(c_h)=0$，这可能导致除以零，但根据 FWHM 的定义，如果峰值响应为正，则 $W(c_h)$ 将为正。\n\n4.  **交叉方位抑制指数 (XSI)**：该指数测量因叠加正交掩模而在偏好方位上响应的降低程度。它在高对比度 $c_h$ 和掩模对比度 $c_m$ 下计算：\n    $$\n    \\mathrm{XSI} = \\frac{R(\\theta_{\\text{pref}}(c_h);c_h) - R_{\\text{mask}}(\\theta_{\\text{pref}}(c_h);c_h,c_m)}{R(\\theta_{\\text{pref}}(c_h);c_h)}\n    $$\n    如果峰值响应不为正，则 XSI 定义为 $0$。\n\n5.  **方位选择性指数 (OSI)**：该指数比较偏好方位上的响应与正交方位（相差 $90^{\\circ}$）上的响应。它在高对比度 $c_h$ 下计算：\n    $$\n    \\mathrm{OSI} = 1 - \\frac{R(\\theta_{\\text{pref}}(c_h)+90^{\\circ};c_h)}{R(\\theta_{\\text{pref}}(c_h);c_h)}\n    $$\n    正交方位取模 $180^{\\circ}$。同样，如果峰值响应不为正，则 OSI 定义为 $0$。\n\n最后，对于每个参数集，如果所有四个条件都满足，则该模型被宣布“通过”验证：\n-   $\\Delta\\theta_{\\text{pref}} \\le 5^{\\circ}$\n-   $\\mathrm{CIM} \\le 0.1$\n-   $\\mathrm{XSI} \\ge 0.2$\n-   $\\mathrm{OSI} \\ge 0.5$\n\n实现过程将处理四个测试用例中的每一个，计算四个度量，对照验证标准进行检查，并生成一个布尔结果。",
            "answer": "```python\nimport numpy as np\n\nclass OrientationModelValidator:\n    \"\"\"\n    Implements and validates a model of neuronal orientation selectivity.\n    \"\"\"\n    def __init__(self, k, b, m, p, gamma, alpha, theta_0):\n        self.k = k\n        self.b = b\n        self.m = m\n        self.p = p\n        self.gamma = gamma\n        self.alpha = alpha\n        self.theta_0 = theta_0\n        \n        # High-resolution sampling of orientation space in degrees\n        self.num_thetas = 3600\n        self.theta_range = np.linspace(0.0, 180.0, self.num_thetas, endpoint=False)\n        self.theta_step = 180.0 / self.num_thetas\n\n    def _drive(self, theta, c):\n        \"\"\"Calculates the feedforward drive D(theta; c).\"\"\"\n        cos_term = np.cos(np.deg2rad(2 * (theta - self.theta_0)))\n        return self.k * c * (self.b + self.m * cos_term)\n\n    def _drive_mask(self, theta, c, c_m):\n        \"\"\"Calculates the feedforward drive with an orthogonal mask.\"\"\"\n        # Using the simplified form D_mask = k*c*b + k*m*(c - alpha*c_m)*cos(...)\n        cos_term = np.cos(np.deg2rad(2 * (theta - self.theta_0)))\n        return self.k * c * self.b + self.k * self.m * (c - self.alpha * c_m) * cos_term\n\n    def _nonlinearity(self, drive):\n        \"\"\"Applies half-wave rectification and power-law nonlinearity.\"\"\"\n        return np.maximum(drive, 0)**self.p\n\n    def get_response(self, theta, c):\n        \"\"\"Calculates the final response R(theta; c).\"\"\"\n        drive = self._drive(theta, c)\n        n_drive = self._nonlinearity(drive)\n        if self.gamma * c == -1.0: # Avoid division by zero\n            return np.inf if n_drive > 0 else 0.0\n        return n_drive / (1.0 + self.gamma * c)\n\n    def get_masked_response(self, theta, c, c_m):\n        \"\"\"Calculates the response R_mask with an orthogonal mask.\"\"\"\n        drive_mask = self._drive_mask(theta, c, c_m)\n        n_drive_mask = self._nonlinearity(drive_mask)\n        denominator = 1.0 + self.gamma * (c + c_m)\n        if denominator == 0: # Avoid division by zero\n            return np.inf if n_drive_mask > 0 else 0.0\n        return n_drive_mask / denominator\n\n    def _get_theta_pref(self, c):\n        \"\"\"Finds the preferred orientation for a given contrast.\"\"\"\n        if c == 0:\n            return 0.0 # Response is zero, convention to return 0\n        responses = self.get_response(self.theta_range, c)\n        if np.all(responses == 0):\n            return self.theta_0 # Default to theta_0 if no response\n        peak_idx = np.argmax(responses)\n        return self.theta_range[peak_idx]\n\n    def _get_fwhm(self, c):\n        \"\"\"Calculates the Full Width at Half Maximum (FWHM).\"\"\"\n        responses = self.get_response(self.theta_range, c)\n        \n        if np.all(responses == 0):\n            return 180.0\n\n        peak_response = np.max(responses)\n        \n        if peak_response = 0:\n            return 180.0 # Changed from 0.0 to 180.0 as per problem spec for zero response\n            \n        half_max = 0.5 * peak_response\n        above_half_max = responses >= half_max\n        \n        # For this model class, the suprathreshold region is contiguous.\n        # So we can just count the number of points above half-max.\n        width_in_points = np.sum(above_half_max)\n        return width_in_points * self.theta_step\n\n    def run_validation(self, c_l, c_h, c_m):\n        \"\"\"Runs all validation checks and returns a boolean result.\"\"\"\n        \n        # 1. Preferred orientation stability\n        theta_pref_low = self._get_theta_pref(c_l)\n        theta_pref_high = self._get_theta_pref(c_h)\n        diff = np.abs(theta_pref_high - theta_pref_low)\n        delta_theta_pref = np.min([diff, 180.0 - diff])\n        \n        # 2. Contrast invariance metric (CIM)\n        w_low = self._get_fwhm(c_l)\n        w_high = self._get_fwhm(c_h)\n        if w_high == 0.0:\n            cim = np.inf if w_low > 0 else 0.0\n        else:\n            cim = np.abs(w_high - w_low) / w_high\n\n        # Response at high contrast for XSI and OSI\n        unmasked_response_at_pref = self.get_response(theta_pref_high, c_h)\n\n        # 3. Cross-orientation suppression index (XSI)\n        if unmasked_response_at_pref = 0:\n            xsi = 0.0\n        else:\n            masked_response_at_pref = self.get_masked_response(theta_pref_high, c_h, c_m)\n            xsi = (unmasked_response_at_pref - masked_response_at_pref) / unmasked_response_at_pref\n        \n        # 4. Orientation selectivity index (OSI)\n        if unmasked_response_at_pref = 0:\n            osi = 0.0\n        else:\n            theta_ortho = (theta_pref_high + 90.0) % 180.0\n            ortho_response = self.get_response(theta_ortho, c_h)\n            osi = 1.0 - (ortho_response / unmasked_response_at_pref)\n\n        # Final validation\n        valid_delta_theta = delta_theta_pref = 5.0\n        valid_cim = cim = 0.1\n        valid_xsi = xsi >= 0.2\n        valid_osi = osi >= 0.5\n        \n        is_valid = all([valid_delta_theta, valid_cim, valid_xsi, valid_osi])\n        return is_valid\n\ndef solve():\n    \"\"\"\n    Evaluates the validation criteria for the four specified test cases.\n    \"\"\"\n    test_cases = [\n        # (k,    b,   m,   p, gamma, alpha, theta_0, c_l,  c_h,  c_m)\n        (1.0, 0.3, 0.7, 2.0,   0.8,   1.0,    40.0, 0.1,  1.0,  1.0),\n        (1.0, 0.3, 0.7, 1.0,   0.0,   0.5,    40.0, 0.1,  1.0,  1.0),\n        (1.0, 0.05, 1.0, 3.0,  1.5,   0.5,    10.0, 0.05, 0.8,  0.8),\n        (1.0, 0.3, 0.0, 2.0,   0.5,   1.0,    75.0, 0.1,  1.0,  1.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        k, b, m, p, gamma, alpha, theta_0, c_l, c_h, c_m = params\n        model = OrientationModelValidator(k, b, m, p, gamma, alpha, theta_0)\n        is_valid = model.run_validation(c_l, c_h, c_m)\n        results.append(str(is_valid))\n\n    print(f\"[{','.join(results).replace('True', 'true').replace('False', 'false')}]\")\n\nsolve()\n```"
        }
    ]
}