{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the linear receptive field model is the ability to predict a neuron's response to any given stimulus. This exercise provides fundamental practice in this area by asking you to compute the response of a V1 simple cell model to an idealized stimulus—a sinusoidal grating perfectly matched in orientation and frequency. By working through this calculation , you will derive how the response of an odd-symmetric Gabor filter depends on the relative phase of the stimulus, a key property defining V1 simple cells.",
            "id": "3983166",
            "problem": "In computational models of primary visual cortex (V1), simple cells are often approximated as linear filters with two-dimensional Gabor kernels. Consider a V1 simple cell with preferred orientation $\\theta_{0}$ (in radians) and preferred spatial frequency $f_{0}$ (in cycles per unit length). Let the linear receptive field be modeled by a two-dimensional Gabor function with a Gaussian envelope of standard deviation $\\sigma$ along the preferred axis and an aspect ratio $\\gamma$ controlling the spread orthogonal to that axis. Use the rotated coordinates\n$$\nx' = x \\cos(\\theta_{0}) + y \\sin(\\theta_{0}), \\qquad y' = -x \\sin(\\theta_{0}) + y \\cos(\\theta_{0}),\n$$\nand define the receptive field kernel\n$$\ng(x,y) = C \\,\\exp\\!\\left(-\\frac{x'^{2} + \\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right)\\,\\cos\\!\\left(2\\pi f_{0} x' + \\phi\\right),\n$$\nwhere $C$ is a real amplitude constant and the phase is set to $\\phi = \\pi/2$ (radians), corresponding to the odd-symmetric quadrature component.\n\nA drifting sinusoidal grating aligned with the cell’s preferred orientation is given by\n$$\nI(x,y) = \\cos\\!\\left(2\\pi f_{0} x' + \\phi_{I}\\right),\n$$\nwhere $\\phi_{I}$ is a stimulus phase (in radians), and the grating is of unit Michelson contrast and infinite spatial extent. Assume a linear response equal to the spatial inner product of stimulus and kernel over the entire plane,\n$$\nR = \\iint_{\\mathbb{R}^{2}} g(x,y)\\, I(x,y)\\, dx\\, dy.\n$$\n\nStarting from the foundational assumptions that V1 simple cells can be approximated as linear filters and that the receptive field and stimulus are as defined above, derive an exact closed-form analytic expression for $R$ as a function of $C$, $\\sigma$, $\\gamma$, $f_{0}$, and $\\phi_{I}$. Your final expression must be simplified and expressed using standard mathematical functions. Angles must be treated in radians. No rounding is required. Express the final answer as a single analytic expression.",
            "solution": "The problem requires the derivation of a closed-form expression for the response $R$ of a V1 simple cell model. The response is defined as the spatial inner product of the receptive field kernel $g(x,y)$ and the stimulus grating $I(x,y)$.\n\nThe response $R$ is given by the integral:\n$$\nR = \\iint_{\\mathbb{R}^{2}} g(x,y)\\, I(x,y)\\, dx\\, dy\n$$\nThe receptive field kernel $g(x,y)$ and the stimulus $I(x,y)$ are provided. Substituting their definitions into the integral yields:\n$$\nR = \\iint_{\\mathbb{R}^{2}} \\left[ C \\,\\exp\\!\\left(-\\frac{x'^{2} + \\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right)\\,\\cos\\!\\left(2\\pi f_{0} x' + \\phi\\right) \\right] \\left[ \\cos\\!\\left(2\\pi f_{0} x' + \\phi_{I}\\right) \\right] \\, dx\\, dy\n$$\nThe problem specifies that the phase of the kernel is $\\phi = \\pi/2$. Using the trigonometric identity $\\cos(A + \\pi/2) = -\\sin(A)$, the kernel's trigonometric term simplifies to:\n$$\n\\cos\\!\\left(2\\pi f_{0} x' + \\frac{\\pi}{2}\\right) = -\\sin\\!\\left(2\\pi f_{0} x'\\right)\n$$\nThe expression for $R$ becomes:\n$$\nR = -C \\iint_{\\mathbb{R}^{2}} \\exp\\!\\left(-\\frac{x'^{2} + \\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right)\\,\\sin\\!\\left(2\\pi f_{0} x'\\right)\\,\\cos\\!\\left(2\\pi f_{0} x' + \\phi_{I}\\right) \\, dx\\, dy\n$$\nThe integrand is expressed in the rotated coordinates $(x', y')$. We perform a change of variables from $(x,y)$ to $(x',y')$. The transformation is a rotation, given by $x' = x \\cos(\\theta_{0}) + y \\sin(\\theta_{0})$ and $y' = -x \\sin(\\theta_{0}) + y \\cos(\\theta_{0})$. The Jacobian determinant of this transformation is:\n$$\n|J| = \\left| \\det \\begin{pmatrix} \\frac{\\partial x'}{\\partial x} & \\frac{\\partial x'}{\\partial y} \\\\ \\frac{\\partial y'}{\\partial x} & \\frac{\\partial y'}{\\partial y} \\end{pmatrix} \\right| = \\left| \\det \\begin{pmatrix} \\cos(\\theta_{0}) & \\sin(\\theta_{0}) \\\\ -\\sin(\\theta_{0}) & \\cos(\\theta_{0}) \\end{pmatrix} \\right| = \\cos^{2}(\\theta_{0}) + \\sin^{2}(\\theta_{0}) = 1\n$$\nThus, the differential area element $dx\\,dy$ is equal to $dx'\\,dy'$. The integral in the new coordinate system is:\n$$\nR = -C \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2} + \\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right)\\,\\sin\\!\\left(2\\pi f_{0} x'\\right)\\,\\cos\\!\\left(2\\pi f_{0} x' + \\phi_{I}\\right) \\, dx'\\, dy'\n$$\nWe use the product-to-sum trigonometric identity $\\sin(A)\\cos(B) = \\frac{1}{2}[\\sin(A+B) + \\sin(A-B)]$. Let $A = 2\\pi f_{0} x'$ and $B = 2\\pi f_{0} x' + \\phi_{I}$. Then:\n$$\n\\sin\\!\\left(2\\pi f_{0} x'\\right)\\cos\\!\\left(2\\pi f_{0} x' + \\phi_{I}\\right) = \\frac{1}{2}\\left[\\sin(4\\pi f_{0} x' + \\phi_{I}) + \\sin(-\\phi_{I})\\right] = \\frac{1}{2}\\left[\\sin(4\\pi f_{0} x' + \\phi_{I}) - \\sin(\\phi_{I})\\right]\n$$\nSubstituting this into the integral for $R$:\n$$\nR = -\\frac{C}{2} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2 \\sigma^{2}}\\right) \\exp\\!\\left(-\\frac{\\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right) \\left[ \\sin(4\\pi f_{0} x' + \\phi_{I}) - \\sin(\\phi_{I}) \\right] \\, dx'\\, dy'\n$$\nThe integral is separable. We can evaluate the integral over $y'$ first:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{\\gamma^{2} y'^{2}}{2 \\sigma^{2}}\\right) dy'\n$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-a z^2) dz = \\sqrt{\\pi/a}$. Here, $a = \\frac{\\gamma^2}{2\\sigma^2}$. The integral evaluates to:\n$$\n\\sqrt{\\frac{\\pi}{\\gamma^2/(2\\sigma^2)}} = \\sqrt{\\frac{2\\pi\\sigma^2}{\\gamma^2}} = \\frac{\\sigma\\sqrt{2\\pi}}{\\gamma}\n$$\n(assuming $\\gamma > 0$ as it is an aspect ratio). Substituting this back into the expression for $R$:\n$$\nR = -\\frac{C}{2} \\left(\\frac{\\sigma\\sqrt{2\\pi}}{\\gamma}\\right) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2 \\sigma^{2}}\\right) \\left[ \\sin(4\\pi f_{0} x' + \\phi_{I}) - \\sin(\\phi_{I}) \\right] \\, dx'\n$$\nThe remaining integral over $x'$ can be split into two parts:\n$$\nI_{x'} = \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2 \\sigma^{2}}\\right) \\sin(4\\pi f_{0} x' + \\phi_{I}) \\,dx' - \\sin(\\phi_{I}) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2 \\sigma^{2}}\\right) \\,dx'\n$$\nFor the first term, we use the angle addition formula $\\sin(u+v) = \\sin(u)\\cos(v) + \\cos(u)\\sin(v)$:\n$$\n\\int \\exp\\!\\left(-\\frac{x'^{2}}{2\\sigma^2}\\right) \\left[\\sin(4\\pi f_{0} x')\\cos(\\phi_I) + \\cos(4\\pi f_{0} x')\\sin(\\phi_I)\\right] dx'\n$$\nThe term containing $\\sin(4\\pi f_{0} x')$ results in an integral of an odd function over a symmetric domain $(-\\infty, \\infty)$, which is $0$. The term containing $\\cos(4\\pi f_{0} x')$ is non-zero. We use the standard integral (cosine Fourier transform of a Gaussian) $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\cos(bx)dx = \\sqrt{\\pi/a} \\exp(-b^2/4a)$. Here $a = \\frac{1}{2\\sigma^2}$ and $b = 4\\pi f_{0}$. The integral becomes:\n$$\n\\sin(\\phi_{I}) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2\\sigma^2}\\right) \\cos(4\\pi f_{0} x') \\,dx' = \\sin(\\phi_{I}) \\sqrt{2\\pi\\sigma^2} \\exp\\!\\left(-\\frac{(4\\pi f_{0})^2}{4/(2\\sigma^2)}\\right)\n$$\n$$\n= \\sin(\\phi_{I}) \\sigma\\sqrt{2\\pi} \\exp(-8\\pi^2 f_{0}^2 \\sigma^2)\n$$\nThe second part of $I_{x'}$ is another standard Gaussian integral:\n$$\n-\\sin(\\phi_{I}) \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{x'^{2}}{2 \\sigma^{2}}\\right) \\,dx' = -\\sin(\\phi_{I}) \\sigma\\sqrt{2\\pi}\n$$\nCombining the two parts of $I_{x'}$:\n$$\nI_{x'} = \\sin(\\phi_{I}) \\sigma\\sqrt{2\\pi} \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) - \\sin(\\phi_{I}) \\sigma\\sqrt{2\\pi} = \\sigma\\sqrt{2\\pi} \\sin(\\phi_{I}) \\left[ \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) - 1 \\right]\n$$\nFinally, we assemble the complete expression for $R$:\n$$\nR = -\\frac{C}{2} \\left(\\frac{\\sigma\\sqrt{2\\pi}}{\\gamma}\\right) I_{x'} = -\\frac{C \\sigma\\sqrt{2\\pi}}{2\\gamma} \\left( \\sigma\\sqrt{2\\pi} \\sin(\\phi_{I}) \\left[ \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) - 1 \\right] \\right)\n$$\n$$\nR = -\\frac{C (2\\pi\\sigma^2)}{2\\gamma} \\sin(\\phi_{I}) \\left[ \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) - 1 \\right]\n$$\n$$\nR = -\\frac{C \\pi\\sigma^2}{\\gamma} \\sin(\\phi_{I}) \\left[ \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) - 1 \\right]\n$$\nDistributing the negative sign into the brackets gives the final simplified expression:\n$$\nR = \\frac{C \\pi \\sigma^2}{\\gamma} \\sin(\\phi_{I}) \\left[ 1 - \\exp(-8\\pi^2 f_{0}^2 \\sigma^2) \\right]\n$$\nThis expression is a function of the given parameters $C$, $\\sigma$, $\\gamma$, $f_{0}$, and $\\phi_{I}$, as required.",
            "answer": "$$\n\\boxed{\\frac{C \\pi \\sigma^{2}}{\\gamma} \\sin(\\phi_{I}) \\left(1 - \\exp(-8\\pi^{2} f_{0}^{2} \\sigma^{2})\\right)}\n$$"
        },
        {
            "introduction": "A successful computational model must do more than just qualitatively resemble a biological process; its quantitative properties should align with experimental measurements. This practice connects the Gabor model directly to electrophysiological data by focusing on spatial frequency tuning, a critical feature of V1 neurons. You will derive the frequency bandwidth of the filter and compare it to established empirical findings , offering a chance to critically evaluate the model's parameters and its realism.",
            "id": "3983192",
            "problem": "Consider a two-dimensional Gabor filter used to model a primary visual cortex (V1) simple cell, defined by the function\n$$\ng(x,y) \\;=\\; \\exp\\!\\left(-\\frac{x'^{2}}{2\\sigma_{x}^{2}} \\;-\\; \\frac{y'^{2}}{2\\sigma_{y}^{2}}\\right)\\,\\cos\\!\\left(2\\pi f\\,x'\\right),\n$$\nwhere $x' \\;=\\; x\\cos\\theta \\;+\\; y\\sin\\theta$ and $y' \\;=\\; -x\\sin\\theta \\;+\\; y\\cos\\theta$, with $f$ the preferred spatial frequency (in cycles per degree), and $\\sigma_{x}$, $\\sigma_{y}$ the Gaussian envelope standard deviations (in degrees of visual angle) along the filter’s principal axes. The amplitude of the Fourier transform of a Gaussian is a Gaussian in frequency, and modulation by a cosine produces two symmetric frequency components around $\\pm f$. Empirical measurements of V1 simple cell spatial frequency tuning curves (measured along the preferred orientation axis) are often summarized by their full width at half maximum (FWHM) in the amplitude domain and reported as bandwidths in octaves, defined as the base-$2$ logarithm of the ratio of the upper to lower half-maximum frequencies.\n\nStarting from these fundamental facts, derive the amplitude profile of the Fourier transform of $g(x,y)$ along the frequency axis parallel to the carrier orientation (the $x'$-axis), determine the half-maximum points $f_{1}$ and $f_{2}$ around the positive-frequency peak near $+f$, and then compute the spatial frequency bandwidth in octaves,\n$$\nB_{\\text{oct}} \\;=\\; \\log_{2}\\!\\left(\\frac{f_{2}}{f_{1}}\\right).\n$$\nUse the numerical parameters $\\sigma_{x} \\;=\\; 0.18$ degrees, $\\sigma_{y} \\;=\\; 0.36$ degrees, and $f \\;=\\; 5.5$ cycles/degree. Assume $f$ is sufficiently large that $f_{1} \\;>\\; 0$. Report the final bandwidth in octaves. Round your answer to four significant figures. After computing the bandwidth, briefly assess whether the result is consistent with well-established empirical ranges for V1 simple cell spatial frequency tuning.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All necessary parameters and definitions are provided to derive a unique, meaningful solution. We may therefore proceed with the derivation.\n\nThe two-dimensional Gabor filter is given by\n$$g(x,y) = \\exp\\left(-\\frac{x'^{2}}{2\\sigma_{x}^{2}} - \\frac{y'^{2}}{2\\sigma_{y}^{2}}\\right)\\,\\cos\\left(2\\pi f\\,x'\\right)$$\nwhere $(x', y')$ are coordinates rotated by an angle $\\theta$. The bandwidth of the filter's frequency response is independent of its orientation $\\theta$. We can simplify the derivation by aligning the filter's principal axis with the coordinate system, i.e., setting $\\theta = 0$. This gives $x' = x$ and $y' = y$, so the filter becomes\n$$g(x,y) = \\exp\\left(-\\frac{x^{2}}{2\\sigma_{x}^{2}} - \\frac{y^{2}}{2\\sigma_{y}^{2}}\\right)\\,\\cos\\left(2\\pi f\\,x\\right)$$\nThis function is a product of a two-dimensional Gaussian envelope and a cosine wave. We can express the cosine function using Euler's formula, $\\cos(u) = \\frac{1}{2}(\\exp(iu) + \\exp(-iu))$:\n$$g(x,y) = \\frac{1}{2}\\exp\\left(-\\frac{x^{2}}{2\\sigma_{x}^{2}} - \\frac{y^{2}}{2\\sigma_{y}^{2}}\\right)\\left[\\exp\\left(i2\\pi f\\,x\\right) + \\exp\\left(-i2\\pi f\\,x\\right)\\right]$$\nTo find the amplitude profile in the frequency domain, we compute the two-dimensional Fourier transform of $g(x,y)$, denoted $\\hat{g}(k_x, k_y)$. The Fourier transform of a 2D Gaussian $G(x,y) = \\exp(-\\frac{x^2}{2\\sigma_x^2} - \\frac{y^2}{2\\sigma_y^2})$ is\n$$\\hat{G}(k_x, k_y) = 2\\pi\\sigma_x\\sigma_y \\exp\\left(-2\\pi^2(\\sigma_x^2 k_x^2 + \\sigma_y^2 k_y^2)\\right)$$\nUsing the frequency-shifting property of the Fourier transform, which states that the transform of $h(x,y)\\exp(i2\\pi(f_x x + f_y y))$ is $\\hat{h}(k_x - f_x, k_y - f_y)$, we can find the transform of $g(x,y)$:\n$$\\hat{g}(k_x, k_y) = \\frac{1}{2}\\left[\\hat{G}(k_x - f, k_y) + \\hat{G}(k_x + f, k_y)\\right]$$\nSubstituting the expression for $\\hat{G}$, we get\n$$\\hat{g}(k_x, k_y) = \\pi\\sigma_x\\sigma_y \\left[ \\exp\\left(-2\\pi^2(\\sigma_x^2(k_x-f)^2 + \\sigma_y^2 k_y^2)\\right) + \\exp\\left(-2\\pi^2(\\sigma_x^2(k_x+f)^2 + \\sigma_y^2 k_y^2)\\right) \\right]$$\nThe problem asks for the amplitude profile along the frequency axis parallel to the carrier orientation, which is the $k_x$-axis in our simplified coordinate system. We obtain this by setting $k_y = 0$. Let us denote this amplitude profile by $A(k_x) = |\\hat{g}(k_x, 0)|$. Since all terms are positive, we have:\n$$A(k_x) = \\pi\\sigma_x\\sigma_y \\left[ \\exp\\left(-2\\pi^2\\sigma_x^2(k_x-f)^2\\right) + \\exp\\left(-2\\pi^2\\sigma_x^2(k_x+f)^2\\right) \\right]$$\nThis profile consists of two Gaussian functions in the frequency domain, centered at $k_x = +f$ and $k_x = -f$. The problem states that $f$ is sufficiently large, which implies that these two Gaussians are well-separated. We can verify this with the given parameters: $f=5.5$ cycles/degree and $\\sigma_x=0.18$ degrees. The peak of the first term is at $k_x=f$. At this point, the value of the second term's exponent is $-2\\pi^2\\sigma_x^2(2f)^2 = -8\\pi^2\\sigma_x^2 f^2 \\approx -8\\pi^2(0.18)^2(5.5)^2 \\approx -77.5$, so $\\exp(-77.5)$ is negligible.\nTherefore, the peak amplitude near $+f$ is accurately approximated by the peak of the first Gaussian alone:\n$$A_{\\text{max}} \\approx A(f) = \\pi\\sigma_x\\sigma_y \\left[ \\exp(0) + \\exp(-8\\pi^2\\sigma_x^2 f^2) \\right] \\approx \\pi\\sigma_x\\sigma_y$$\nWe need to find the frequencies $f_1$ and $f_2$ for which the amplitude is half of its maximum, i.e., $A(k_x) = \\frac{1}{2}A_{\\text{max}}$. Using the same approximation (neglecting the term centered at $-f$ when we are near $+f$), we solve:\n$$\\pi\\sigma_x\\sigma_y \\exp\\left(-2\\pi^2\\sigma_x^2(k_x-f)^2\\right) = \\frac{1}{2}\\pi\\sigma_x\\sigma_y$$\n$$\\exp\\left(-2\\pi^2\\sigma_x^2(k_x-f)^2\\right) = \\frac{1}{2}$$\nTaking the natural logarithm of both sides:\n$$-2\\pi^2\\sigma_x^2(k_x-f)^2 = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)$$\n$$(k_x-f)^2 = \\frac{\\ln(2)}{2\\pi^2\\sigma_x^2}$$\n$$k_x - f = \\pm \\sqrt{\\frac{\\ln(2)}{2\\pi^2\\sigma_x^2}} = \\pm \\frac{\\sqrt{\\ln(2)}}{\\pi\\sigma_x\\sqrt{2}}$$\nLet $\\Delta f = \\frac{\\sqrt{\\ln(2)}}{\\pi\\sigma_x\\sqrt{2}}$. The half-maximum frequencies are $f_1 = f - \\Delta f$ and $f_2 = f + \\Delta f$.\nNow, we substitute the given numerical values: $f = 5.5$, $\\sigma_x = 0.18$, and $\\ln(2) \\approx 0.693147$.\n$$\\Delta f = \\frac{\\sqrt{0.693147}}{\\pi(0.18)\\sqrt{2}} = \\frac{0.83255}{0.56548 \\times 1.41421} = \\frac{0.83255}{0.79972} \\approx 1.04105 \\text{ cycles/degree}$$\nThe half-maximum frequencies are:\n$$f_1 = 5.5 - 1.04105 = 4.45895 \\text{ cycles/degree}$$\n$$f_2 = 5.5 + 1.04105 = 6.54105 \\text{ cycles/degree}$$\nThe assumption $f_1 > 0$ is valid. The spatial frequency bandwidth in octaves is defined as:\n$$B_{\\text{oct}} = \\log_{2}\\left(\\frac{f_2}{f_1}\\right) = \\log_{2}\\left(\\frac{6.54105}{4.45895}\\right) = \\log_{2}(1.46695)$$\nTo compute the base-$2$ logarithm, we use the change of base formula: $\\log_2(x) = \\frac{\\ln(x)}{\\ln(2)}$.\n$$B_{\\text{oct}} = \\frac{\\ln(1.46695)}{\\ln(2)} = \\frac{0.38324}{0.693147} \\approx 0.55294$$\nRounding to four significant figures, the bandwidth is $0.5529$ octaves.\n\nAssessment of the result:\nThe calculated bandwidth of approximately $0.55$ octaves is substantially narrower than the median bandwidths for V1 simple cells reported in seminal electrophysiological studies (e.g., De Valois et al., 1982), which typically lie in the range of $1.2$ to $1.6$ octaves. The bandwidth of a Gabor filter is inversely related to the number of carrier cycles visible within its Gaussian envelope. This \"number of cycles\" can be quantified by the dimensionless product of the preferred spatial frequency $f$ and the envelope's standard deviation $\\sigma_x$. For the given parameters, $f \\sigma_x = 5.5 \\times 0.18 = 0.99$. Empirical measurements from macaque V1 (e.g., Ringach, 2002) indicate that the mean value for this product is closer to $0.4$. A larger value of $f \\sigma_x$, as used here, corresponds to a Gabor function with more oscillations, which, by the uncertainty principle, necessarily has a narrower bandwidth in the frequency domain. Thus, while our calculation is mathematically sound, the provided parameters model a simple cell that is more sharply tuned to spatial frequency than is typical for the V1 population.",
            "answer": "$$\\boxed{0.5529}$$"
        },
        {
            "introduction": "Linear models provide a powerful foundation, but real neurons exhibit crucial non-linearities, such as the fact that firing rates cannot be negative. This exercise explores the consequences of adding a simple rectification non-linearity, $f(z) = \\max(0, z)$, to the Gabor filter's output. By analyzing how this changes the response to stimuli of varying phases , you will explore a foundational mechanism for building phase-invariant responses, a hallmark of V1 complex cells, from phase-sensitive simple cell-like inputs.",
            "id": "3983149",
            "problem": "Consider a simple cell in the primary visual cortex (V1) modeled as a linear Gabor filter responding to a sinusoidal grating whose orientation and spatial frequency match the filter. Let the stimulus phase be $\\phi \\in [0, 2\\pi]$ (in radians), and let the linear projection of the grating onto the filter be $r_{\\mathrm{lin}}(\\phi) = b + A \\cos(\\phi)$, where $A > 0$ denotes the gain of the phase-sensitive linear response and $b \\ge 0$ is a static bias capturing baseline depolarization or tonic activity. The spiking output is modeled by applying a static nonlinearity $f(z) = \\max(0, z)$ to the linear response, yielding $r(\\phi) = f(r_{\\mathrm{lin}}(\\phi)) = \\max(0, b + A \\cos(\\phi))$.\n\nUsing the standard real Fourier series on $[0, 2\\pi]$, define the mean component $F_0$ and the first harmonic amplitude $F_1$ of $r(\\phi)$ through the coefficients\n$$a_0 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} r(\\phi) \\, d\\phi, \\quad a_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} r(\\phi) \\cos(\\phi) \\, d\\phi,$$\nso that $F_0 = \\frac{a_0}{2}$ and $F_1 = |a_1|$.\n\nStarting from these definitions and the specified model, derive a closed-form expression for the ratio\n$$R(\\beta) = \\frac{F_1}{F_0}, \\quad \\beta = \\frac{b}{A},$$\nfor $\\beta \\ge 0$, carefully accounting for how the rectification changes the support of $r(\\phi)$ across different regimes of $\\beta$. Then, using the derived expression, determine the condition on $\\beta$ under which $R(\\beta) < 1$, corresponding to a reduction in phase sensitivity that is often interpreted as partial emergence of phase invariance.\n\nExpress the final answer as the analytic expression $R(\\beta)$ in terms of $\\beta$ only. No rounding is required.",
            "solution": "The problem requires the derivation of the ratio $R(\\beta) = \\frac{F_1}{F_0}$ for the rectified response of a model simple cell, where $F_0$ is the mean response and $F_1$ is the first harmonic amplitude. The response function is given by $r(\\phi) = \\max(0, b + A \\cos(\\phi))$, with $A > 0$, $b \\ge 0$, and $\\phi \\in [0, 2\\pi]$. The ratio is to be expressed in terms of $\\beta = \\frac{b}{A}$.\n\nThe core of the calculation involves the Fourier coefficients $a_0$ and $a_1$:\n$$F_0 = \\frac{a_0}{2} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} r(\\phi) \\, d\\phi$$\n$$F_1 = |a_1| = \\left| \\frac{1}{\\pi} \\int_{0}^{2\\pi} r(\\phi) \\cos(\\phi) \\, d\\phi \\right|$$\n\nThe rectification by the $\\max(0, \\cdot)$ function means that the integrand is non-zero only when $b + A \\cos(\\phi) > 0$, which is equivalent to $\\cos(\\phi) > -\\frac{b}{A} = -\\beta$. The nature of this condition depends on the value of $\\beta$. We must analyze two distinct cases.\n\n**Case 1: $\\beta \\ge 1$**\n\nIn this case, $b \\ge A$. The condition for a non-zero response is $\\cos(\\phi) > -\\beta$. Since the minimum value of $\\cos(\\phi)$ is $-1$ and $-\\beta \\le -1$, the inequality $\\cos(\\phi) > -\\beta$ holds for all $\\phi$ (except possibly at a single point $\\phi=\\pi$ if $\\beta=1$, which does not affect the integral). Therefore, the rectification is inactive, and the response function is simply the linear response:\n$$r(\\phi) = b + A \\cos(\\phi) \\quad \\text{for } \\beta \\ge 1$$\n\nWe can now compute the Fourier components. The mean response $F_0$ is the average value of $r(\\phi)$ over one period:\n$$F_0 = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (b + A \\cos(\\phi)) \\, d\\phi = \\frac{1}{2\\pi} \\left[ b\\phi + A \\sin(\\phi) \\right]_{0}^{2\\pi} = \\frac{1}{2\\pi} (2\\pi b) = b$$\n\nThe coefficient $a_1$ is:\n$$a_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} (b + A \\cos(\\phi)) \\cos(\\phi) \\, d\\phi = \\frac{1}{\\pi} \\int_{0}^{2\\pi} (b\\cos(\\phi) + A\\cos^2(\\phi)) \\, d\\phi$$\nThe integral of $\\cos(\\phi)$ over $[0, 2\\pi]$ is $0$. The integral of $\\cos^2(\\phi)$ over $[0, 2\\pi]$ is $\\pi$.\n$$a_1 = \\frac{b}{\\pi} \\int_{0}^{2\\pi} \\cos(\\phi) \\, d\\phi + \\frac{A}{\\pi} \\int_{0}^{2\\pi} \\cos^2(\\phi) \\, d\\phi = 0 + \\frac{A}{\\pi}(\\pi) = A$$\nSince $A > 0$, the first harmonic amplitude is $F_1 = |a_1| = A$.\n\nThe ratio $R(\\beta)$ for this case is:\n$$R(\\beta) = \\frac{F_1}{F_0} = \\frac{A}{b} = \\frac{1}{b/A} = \\frac{1}{\\beta}$$\n\n**Case 2: $0 \\le \\beta < 1$**\n\nIn this case, $0 \\le b < A$. The condition for non-zero response, $\\cos(\\phi) > -\\beta$, restricts the integration domain. Let $\\phi_c = \\arccos(-\\beta)$. Since $0 \\le \\beta < 1$, we have $-1 < -\\beta \\le 0$, and thus $\\phi_c \\in [\\frac{\\pi}{2}, \\pi)$. The response $r(\\phi)$ is non-zero for $\\phi$ in the union of intervals $[0, \\phi_c) \\cup (2\\pi - \\phi_c, 2\\pi]$.\n\nThe integrands for both $a_0$ and $a_1$ are even functions of $\\phi$ because $r(\\phi)$ is even. We can simplify the integrals:\n$$a_0 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} r(\\phi) \\, d\\phi = \\frac{2}{\\pi} \\int_{0}^{\\pi} r(\\phi) \\, d\\phi = \\frac{2}{\\pi} \\int_{0}^{\\phi_c} (b + A \\cos(\\phi)) \\, d\\phi$$\n$$a_0 = \\frac{2}{\\pi} [b\\phi + A \\sin(\\phi)]_{0}^{\\phi_c} = \\frac{2}{\\pi} (b\\phi_c + A \\sin(\\phi_c))$$\nWe substitute $\\phi_c = \\arccos(-\\beta)$ and $\\sin(\\phi_c) = \\sqrt{1 - \\cos^2(\\phi_c)} = \\sqrt{1 - (-\\beta)^2} = \\sqrt{1 - \\beta^2}$.\n$$a_0 = \\frac{2}{\\pi} (b \\arccos(-\\beta) + A \\sqrt{1 - \\beta^2})$$\nThe mean response is $F_0 = \\frac{a_0}{2} = \\frac{1}{\\pi} (b \\arccos(-\\beta) + A \\sqrt{1 - \\beta^2})$.\nFactoring out $A$:\n$$F_0 = \\frac{A}{\\pi} (\\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2})$$\n\nSimilarly for $a_1$:\n$$a_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} r(\\phi) \\cos(\\phi) \\, d\\phi = \\frac{2}{\\pi} \\int_{0}^{\\phi_c} (b + A \\cos(\\phi)) \\cos(\\phi) \\, d\\phi$$\n$$a_1 = \\frac{2}{\\pi} \\int_{0}^{\\phi_c} (b\\cos(\\phi) + A\\cos^2(\\phi)) \\, d\\phi = \\frac{2}{\\pi} \\left[ b\\sin(\\phi) + A\\left(\\frac{\\phi}{2} + \\frac{\\sin(2\\phi)}{4}\\right) \\right]_{0}^{\\phi_c}$$\n$$a_1 = \\frac{2}{\\pi} \\left( b\\sin(\\phi_c) + \\frac{A\\phi_c}{2} + \\frac{A}{2}\\sin(\\phi_c)\\cos(\\phi_c) \\right)$$\nSubstitute $b=A\\beta$, $\\sin(\\phi_c)=\\sqrt{1-\\beta^2}$, and $\\cos(\\phi_c) = -\\beta$:\n$$a_1 = \\frac{2}{\\pi} \\left( A\\beta\\sqrt{1-\\beta^2} + \\frac{A\\arccos(-\\beta)}{2} - \\frac{A}{2}\\beta\\sqrt{1-\\beta^2} \\right)$$\n$$a_1 = \\frac{2}{\\pi} \\left( \\frac{A\\beta\\sqrt{1-\\beta^2}}{2} + \\frac{A\\arccos(-\\beta)}{2} \\right) = \\frac{A}{\\pi} (\\arccos(-\\beta) + \\beta\\sqrt{1-\\beta^2})$$\nFor $0 \\le \\beta < 1$, $\\arccos(-\\beta) \\in [\\frac{\\pi}{2}, \\pi)$ and $\\beta\\sqrt{1-\\beta^2} \\ge 0$, so $a_1 > 0$. Thus, $F_1 = a_1$.\n\nThe ratio $R(\\beta)$ for this case is:\n$$R(\\beta) = \\frac{F_1}{F_0} = \\frac{\\frac{A}{\\pi} (\\arccos(-\\beta) + \\beta\\sqrt{1-\\beta^2})}{\\frac{A}{\\pi} (\\beta \\arccos(-\\beta) + \\sqrt{1-\\beta^2})} = \\frac{\\arccos(-\\beta) + \\beta\\sqrt{1 - \\beta^2}}{\\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2}}$$\n\nCombining both cases, we obtain the full expression for $R(\\beta)$:\n$$R(\\beta) = \\begin{cases} \\frac{\\arccos(-\\beta) + \\beta \\sqrt{1 - \\beta^2}}{\\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2}} & \\text{for } 0 \\le \\beta < 1 \\\\ \\frac{1}{\\beta} & \\text{for } \\beta \\ge 1 \\end{cases}$$\nThe function is continuous at $\\beta=1$, since $\\lim_{\\beta\\to 1^-} R(\\beta) = \\frac{\\arccos(-1) + 0}{1 \\cdot \\arccos(-1) + 0} = \\frac{\\pi}{\\pi} = 1$, and $R(1) = 1/1=1$.\n\nFinally, we determine the condition for $R(\\beta) < 1$.\nFor $\\beta \\ge 1$, $R(\\beta) = 1/\\beta$. The condition $1/\\beta < 1$ is true if and only if $\\beta > 1$.\nFor $0 \\le \\beta < 1$, we test if $R(\\beta) < 1$.\n$$\\frac{\\arccos(-\\beta) + \\beta \\sqrt{1 - \\beta^2}}{\\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2}} < 1$$\nThe denominator is positive for $\\beta \\in [0, 1)$. Multiplying gives:\n$$\\arccos(-\\beta) + \\beta \\sqrt{1 - \\beta^2} < \\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2}$$\n$$(1-\\beta)\\arccos(-\\beta) < (1-\\beta)\\sqrt{1 - \\beta^2}$$\nSince $0 \\le \\beta < 1$, $(1-\\beta) > 0$. We can divide by it without changing the inequality:\n$$\\arccos(-\\beta) < \\sqrt{1 - \\beta^2}$$\nLet $g(\\beta) = \\sqrt{1 - \\beta^2} - \\arccos(-\\beta)$. At $\\beta=0$, $g(0) = 1 - \\frac{\\pi}{2} < 0$. The derivative is $g'(\\beta) = \\frac{-\\beta}{\\sqrt{1-\\beta^2}} - \\frac{1}{\\sqrt{1-\\beta^2}} = -\\frac{1+\\beta}{\\sqrt{1-\\beta^2}}$, which is negative for $\\beta \\in [0, 1)$. Thus, $g(\\beta)$ is a strictly decreasing function on $[0, 1)$ starting from a negative value. It is therefore always negative.\nThis means $\\arccos(-\\beta) > \\sqrt{1 - \\beta^2}$ for all $\\beta \\in [0, 1)$, and consequently $R(\\beta) > 1$ for $\\beta \\in [0, 1)$.\nCombining the analysis of both cases, the condition $R(\\beta) < 1$ is met solely when $\\beta > 1$.",
            "answer": "$$\n\\boxed{\nR(\\beta) = \\begin{cases} \\frac{\\arccos(-\\beta) + \\beta \\sqrt{1 - \\beta^2}}{\\beta \\arccos(-\\beta) + \\sqrt{1 - \\beta^2}} & \\text{if } 0 \\le \\beta < 1 \\\\ \\frac{1}{\\beta} & \\text{if } \\beta \\ge 1 \\end{cases}\n}\n$$"
        }
    ]
}