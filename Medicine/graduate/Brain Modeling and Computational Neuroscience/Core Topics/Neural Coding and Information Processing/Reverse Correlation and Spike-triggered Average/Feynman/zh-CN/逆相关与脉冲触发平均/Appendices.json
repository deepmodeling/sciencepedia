{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习将引导你为一个受相关噪声刺激的神经元模型推导脉冲触发平均（STA）。这项实践将揭示一个关键原则：STA 并不总是与神经元的真实滤波器相同，刺激相关性会系统地扭曲这个估计。通过这个计算，你将亲手验证为什么在解释 STA 结果时，对刺激的统计特性进行“白化”或校正是至关重要的一步。",
            "id": "4016503",
            "problem": "一个神经元采用线性-非线性-泊松 (LNP) 级联模型进行建模，该模型接收一个双通道刺激。在时间 $t$ 的刺激是一个向量 $x(t) \\in \\mathbb{R}^{2}$，它被建模为一个平稳的、零均值的高斯过程，其协方差矩阵为\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n1.5  -0.8 \\\\\n-0.8  2.5\n\\end{pmatrix}.\n$$\n神经元的瞬时发放率为\n$$\n\\lambda(t) \\;=\\; \\lambda_{0}\\,\\exp\\!\\big(\\beta\\,k^{\\top} x(t)\\big),\n$$\n其中 $\\lambda_{0} > 0$ 是一个恒定的基线发放率，$\\beta > 0$ 是一个标量增益，而 $k \\in \\mathbb{R}^{2}$ 是真实的线性滤波器。在本题中，真实的滤波器为\n$$\nk_{\\text{true}} \\;=\\; \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix},\n$$\n增益为 $\\,\\beta = 0.3\\,$。\n\n脉冲触发平均 (STA) 被定义为在给定脉冲发生的条件下刺激的条件均值，即：\n$$\n\\text{STA} \\;=\\; \\mathbb{E}\\big[x(t) \\,\\big|\\, \\text{在时间 }t\\text{ 发生一个脉冲}\\big].\n$$\n\n仅从上述定义、高斯随机向量的性质以及标准积分恒等式出发，推导出以 $\\Sigma$、$\\beta$ 和 $k_{\\text{true}}$ 表示的脉冲触发平均 $\\text{STA}$ 的闭式表达式。然后，使用所提供的数值，计算 STA 在真实滤波器的单位范数方向上的标量投影，\n$$\ns \\;=\\; \\left(\\frac{k_{\\text{true}}}{\\|k_{\\text{true}}\\|}\\right)^{\\top} \\text{STA},\n$$\n并报告 $s$ 的值。\n\n将最终数值答案四舍五入至四位有效数字。最终答案不带单位。",
            "solution": "本题要求推导一个由零均值高斯过程刺激的线性-非线性-泊松 (LNP) 模型神经元的脉冲触发平均 (STA)，并随后计算一个特定的标量。\n\n首先，我们建立 STA 的正式表达式。STA 被定义为在脉冲发生时刻刺激 $x(t)$ 的条件期望。对于一个瞬时率 $\\lambda(t)$ 依赖于刺激 $x(t)$ 的点过程，STA 可以使用全期望定律来计算，该定律有时被称为坎贝尔定理或一种关于率的贝叶斯法则。在一个微小时间间隔 $dt$ 内发生脉冲的概率是 $\\lambda(t)dt$。按脉冲发生概率加权的平均刺激，除以平均脉冲发生概率，便得到 STA。\n$$\n\\text{STA} \\;=\\; \\frac{\\mathbb{E}[x(t) \\lambda(t)]}{\\mathbb{E}[\\lambda(t)]}\n$$\n此处，期望 $\\mathbb{E}[\\cdot]$ 是对刺激 $x(t)$ 的分布求得的。刺激 $x(t)$ 是一个二维高斯随机向量，记为 $x$，其均值为 $\\mathbb{E}[x] = 0$，协方差矩阵为 $\\Sigma$。其概率密度函数为 $p(x) = \\frac{1}{2\\pi |\\Sigma|^{1/2}} \\exp(-\\frac{1}{2} x^{\\top} \\Sigma^{-1} x)$。\n\n我们现在将分别计算分母和分子。\n\n分母是平均发放率 $\\mathbb{E}[\\lambda(t)]$。\n$$\n\\mathbb{E}[\\lambda(t)] \\;=\\; \\mathbb{E}\\left[\\lambda_{0}\\exp(\\beta k^{\\top} x)\\right] \\;=\\; \\lambda_{0} \\mathbb{E}\\left[\\exp(\\beta k^{\\top} x)\\right]\n$$\n设标量随机变量 $y = \\beta k^{\\top} x$。由于 $x$ 是一个零均值高斯向量，所以 $y$ 是一个零均值高斯标量。其方差为：\n$$\n\\sigma_y^2 \\;=\\; \\text{Var}(y) \\;=\\; \\mathbb{E}[y^2] - (\\mathbb{E}[y])^2 \\;=\\; \\mathbb{E}[(\\beta k^{\\top} x)(\\beta k^{\\top} x)] \\;=\\; \\beta^2 \\mathbb{E}[k^{\\top} x x^{\\top} k] \\;=\\; \\beta^2 k^{\\top} \\mathbb{E}[x x^{\\top}] k \\;=\\; \\beta^2 k^{\\top} \\Sigma k\n$$\n期望 $\\mathbb{E}[\\exp(y)]$ 是高斯变量 $y \\sim \\mathcal{N}(0, \\sigma_y^2)$ 的矩生成函数在 $1$ 处的值。对于一个一般的高斯变量 $z \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其矩生成函数 (MGF) 为 $M_z(s) = \\exp(\\mu s + \\frac{1}{2}\\sigma^2 s^2)$。对于 $y$，我们有 $\\mu=0$，因此：\n$$\n\\mathbb{E}[\\exp(y)] \\;=\\; M_y(1) \\;=\\; \\exp\\left(\\frac{1}{2}\\sigma_y^2\\right) \\;=\\; \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right)\n$$\n因此，分母为：\n$$\n\\mathbb{E}[\\lambda(t)] \\;=\\; \\lambda_{0} \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right)\n$$\n\n接下来，我们计算分子 $\\mathbb{E}[x(t) \\lambda(t)]$。\n$$\n\\mathbb{E}[x \\lambda(x)] \\;=\\; \\mathbb{E}\\left[x \\lambda_{0}\\exp(\\beta k^{\\top} x)\\right] \\;=\\; \\lambda_{0} \\int_{\\mathbb{R}^2} x \\exp(\\beta k^{\\top} x) p(x) dx\n$$\n代入 $p(x)$ 的表达式：\n$$\n\\mathbb{E}[x \\lambda(x)] \\;=\\; \\frac{\\lambda_{0}}{(2\\pi) |\\Sigma|^{1/2}} \\int_{\\mathbb{R}^2} x \\exp\\left( \\beta k^{\\top} x - \\frac{1}{2} x^{\\top} \\Sigma^{-1} x \\right) dx\n$$\n指数中的项是关于 $x$ 的二次型。我们可以进行配方。\n$$\n-\\frac{1}{2} x^{\\top} \\Sigma^{-1} x + \\beta k^{\\top} x = -\\frac{1}{2} \\left( x^{\\top} \\Sigma^{-1} x - 2\\beta k^{\\top} x \\right)\n$$\n我们试图将其写成 $-\\frac{1}{2}(x - \\mu_*)^\\top \\Sigma^{-1} (x - \\mu_*)$ 加上一个常数的形式。展开此形式可得：\n$$\n-\\frac{1}{2}(x^\\top \\Sigma^{-1} x - 2x^\\top\\Sigma^{-1}\\mu_* + \\mu_*^\\top \\Sigma^{-1} \\mu_*)\n$$\n比较 $x$ 的线性项，我们必须有 $x^\\top\\Sigma^{-1}\\mu_* = \\beta k^\\top x$，这意味着 $\\Sigma^{-1}\\mu_* = \\beta k$。解出 $\\mu_*$ 得到 $\\mu_* = \\beta \\Sigma k$。\n那么配方后为：\n$$\n-\\frac{1}{2} x^{\\top} \\Sigma^{-1} x + \\beta k^{\\top} x = -\\frac{1}{2}(x - \\beta\\Sigma k)^{\\top} \\Sigma^{-1} (x - \\beta\\Sigma k) + \\frac{1}{2}(\\beta\\Sigma k)^{\\top} \\Sigma^{-1} (\\beta\\Sigma k)\n$$\n与 $x$ 无关的项可化简为 $\\frac{1}{2} \\beta^2 k^{\\top}\\Sigma^{\\top}\\Sigma^{-1}\\Sigma k = \\frac{1}{2} \\beta^2 k^{\\top}\\Sigma k$。\n将此代回分子的积分中：\n$$\n\\mathbb{E}[x \\lambda(x)] \\;=\\; \\lambda_{0} \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right) \\int_{\\mathbb{R}^2} x \\frac{1}{2\\pi |\\Sigma|^{1/2}} \\exp\\left(-\\frac{1}{2}(x - \\beta\\Sigma k)^{\\top} \\Sigma^{-1} (x - \\beta\\Sigma k) \\right) dx\n$$\n该积分是在一个修正的高斯分布下 $x$ 的期望值，该分布具有相同的协方差 $\\Sigma$ 但有一个非零均值 $\\mu_* = \\beta \\Sigma k$。因此，该积分的值就是这个分布的均值，即 $\\beta \\Sigma k$。\n所以，分子为：\n$$\n\\mathbb{E}[x \\lambda(x)] \\;=\\; \\lambda_{0} \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right) (\\beta \\Sigma k)\n$$\n\n现在，我们可以通过计算分子与分母的比值来求得 STA：\n$$\n\\text{STA} \\;=\\; \\frac{\\lambda_{0} \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right) (\\beta \\Sigma k)}{\\lambda_{0} \\exp\\left(\\frac{1}{2}\\beta^2 k^{\\top} \\Sigma k\\right)} \\;=\\; \\beta \\Sigma k\n$$\n这就是以 $\\beta$、$\\Sigma$ 和真实滤波器 $k$ 表示的 STA 的闭式表达式。在我们的问题中，$k = k_{\\text{true}}$。\n\n我们现在代入所提供的数值：\n$\\beta = 0.3$，$k_{\\text{true}} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$，以及 $\\Sigma = \\begin{pmatrix} 1.5  -0.8 \\\\ -0.8  2.5 \\end{pmatrix}$。\n首先，我们计算乘积 $\\Sigma k_{\\text{true}}$：\n$$\n\\Sigma k_{\\text{true}} \\;=\\; \\begin{pmatrix} 1.5  -0.8 \\\\ -0.8  2.5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} (1.5)(2) + (-0.8)(1) \\\\ (-0.8)(2) + (2.5)(1) \\end{pmatrix} \\;=\\; \\begin{pmatrix} 3.0 - 0.8 \\\\ -1.6 + 2.5 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 2.2 \\\\ 0.9 \\end{pmatrix}\n$$\n接下来，我们乘以 $\\beta$：\n$$\n\\text{STA} \\;=\\; 0.3 \\begin{pmatrix} 2.2 \\\\ 0.9 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0.66 \\\\ 0.27 \\end{pmatrix}\n$$\n\n最后一步是计算 STA 在真实滤波器的单位范数方向上的标量投影 $s$。\n$$\ns \\;=\\; \\left(\\frac{k_{\\text{true}}}{\\|k_{\\text{true}}\\|}\\right)^{\\top} \\text{STA} \\;=\\; \\frac{k_{\\text{true}}^{\\top} \\text{STA}}{\\|k_{\\text{true}}\\|}\n$$\n首先，计算 $k_{\\text{true}}$ 的范数：\n$$\n\\|k_{\\text{true}}\\| \\;=\\; \\sqrt{2^2 + 1^2} \\;=\\; \\sqrt{4 + 1} \\;=\\; \\sqrt{5}\n$$\n接下来，计算点积 $k_{\\text{true}}^{\\top} \\text{STA}$：\n$$\nk_{\\text{true}}^{\\top} \\text{STA} \\;=\\; \\begin{pmatrix} 2  1 \\end{pmatrix} \\begin{pmatrix} 0.66 \\\\ 0.27 \\end{pmatrix} \\;=\\; (2)(0.66) + (1)(0.27) \\;=\\; 1.32 + 0.27 \\;=\\; 1.59\n$$\n最后，计算标量投影 $s$：\n$$\ns \\;=\\; \\frac{1.59}{\\sqrt{5}} \\;\\approx\\; \\frac{1.59}{2.2360679...} \\;\\approx\\; 0.7110702...\n$$\n将此值四舍五入至四位有效数字，得到 $0.7111$。",
            "answer": "$$\\boxed{0.7111}$$"
        },
        {
            "introduction": "在前一个练习的基础上，本问题探讨了另一个潜在的偏差来源：神经元的非线性发放函数。通过考虑没有相关性（即白噪声）的刺激这一特殊情况，你将发现即使是强烈的饱和非线性也不一定会扭曲 STA 的*方向*。这个练习清晰地表明，刺激统计特性（而非非线性本身）往往是扭曲逆相关估计的主要因素。",
            "id": "4016502",
            "problem": "考虑一个由线性-非线性 (LN) 泊松尖峰模型建模的神经元。在单个时间窗内的刺激是一个$d$维随机向量 $\\mathbf{s} \\in \\mathbb{R}^{d}$，它随时间从一个零均值、协方差为 $c^{2} \\mathbf{I}_{d}$ 的多元正态分布中独立抽取，其中 $c > 0$ 是刺激对比度，$\\mathbf{I}_{d}$ 是 $d \\times d$ 单位矩阵。神经元的线性滤波器是一个非零向量 $\\mathbf{k} \\in \\mathbb{R}^{d}$，以刺激为条件的瞬时尖峰强度由一个饱和S型非线性函数给出\n$$\n\\lambda(\\mathbf{s}) \\;=\\; \\frac{\\lambda_{\\max}}{1 + \\exp\\!\\left(-\\frac{\\mathbf{k}^{\\top}\\mathbf{s} - \\theta}{\\beta}\\right)},\n$$\n其中 $\\lambda_{\\max} > 0$ 是最大发放率，$\\theta \\in \\mathbb{R}$ 是一个偏移量，$\\beta > 0$ 设定S型函数的斜率。\n\n将在一个长时程实验中的尖峰触发平均 (STA) 向量定义为\n$$\n\\mathrm{STA} \\;=\\; \\mathbb{E}\\!\\left[\\,\\mathbf{s} \\,\\middle|\\, \\text{spike}\\,\\right] \\;=\\; \\frac{\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,\\lambda(\\mathbf{s})\\,\\right]}{\\mathbb{E}\\!\\left[\\,\\lambda(\\mathbf{s})\\,\\right]}.\n$$\n设STA方向相对于真实滤波器方向的偏差由角度\n$$\n\\Delta \\;=\\; \\arccos\\!\\left(\\frac{\\mathrm{STA}^{\\top}\\mathbf{k}}{\\|\\mathrm{STA}\\|\\,\\|\\mathbf{k}\\|}\\right),\n$$\n量化，单位为弧度。\n\n从LN泊松模型和零均值多元高斯刺激的性质出发，推导STA，并计算偏差角 $\\Delta$ 作为参数 $\\lambda_{\\max}$、$\\theta$、$\\beta$、$c$、$\\mathbf{k}$ 和 $d$ 的函数。将$\\Delta$的最终答案以弧度表示。无需四舍五入。",
            "solution": "该问题要求推导一个由零均值高斯白噪声刺激的线性-非线性 (LN) 泊松模型神经元的尖峰触发平均 (STA)，并随后计算STA与神经元真实线性滤波器 $\\mathbf{k}$ 之间的偏差角 $\\Delta$。\n\n刺激 $\\mathbf{s}$ 是从多元正态分布 $\\mathcal{N}(\\mathbf{0}, c^2 \\mathbf{I}_d)$ 中抽取的 $d$ 维随机向量，其中 $\\mathbf{I}_d$ 是 $d \\times d$ 单位矩阵。线性滤波器是一个向量 $\\mathbf{k} \\in \\mathbb{R}^d$，且 $\\mathbf{k} \\neq \\mathbf{0}$。神经元的瞬时发放率由应用于滤波后刺激 $\\mathbf{k}^\\top\\mathbf{s}$ 的非线性函数 $\\lambda(\\mathbf{s})$ 给出。我们定义一个标量函数 $f(x)$ 来代表这个非线性部分，其中 $x = \\mathbf{k}^\\top\\mathbf{s}$ 是投影后的刺激：\n$$\nf(x) \\;=\\; \\frac{\\lambda_{\\max}}{1 + \\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right)}\n$$\n因此，发放率可以写成 $\\lambda(\\mathbf{s}) = f(\\mathbf{k}^\\top\\mathbf{s})$。\n\n尖峰触发平均 (STA) 定义为：\n$$\n\\mathrm{STA} \\;=\\; \\frac{\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,\\lambda(\\mathbf{s})\\,\\right]}{\\mathbb{E}\\!\\left[\\,\\lambda(\\mathbf{s})\\,\\right]} \\;=\\; \\frac{\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]}{\\mathbb{E}\\!\\left[\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]}\n$$\n我们首先分析分子，即向量 $\\mathbb{E}[\\mathbf{s}\\,f(\\mathbf{k}^\\top\\mathbf{s})]$。多元高斯分布的一个关键性质由Stein引理（也称为Price定理）给出。对于一个随机向量 $\\mathbf{s} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$ 和一个可微标量函数 $g(\\mathbf{s})$，以下恒等式成立：\n$$\n\\mathbb{E}\\!\\left[\\,(\\mathbf{s}-\\boldsymbol{\\mu})\\,g(\\mathbf{s})\\,\\right] \\;=\\; \\mathbf{\\Sigma} \\, \\mathbb{E}\\!\\left[\\,\\nabla_{\\mathbf{s}} g(\\mathbf{s})\\,\\right]\n$$\n在本问题中，刺激分布具有零均值 ($\\boldsymbol{\\mu} = \\mathbf{0}$) 和球形协方差矩阵 ($\\mathbf{\\Sigma} = c^2 \\mathbf{I}_d$)。因此，该恒等式简化为：\n$$\n\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,g(\\mathbf{s})\\,\\right] \\;=\\; c^2 \\mathbf{I}_d \\, \\mathbb{E}\\!\\left[\\,\\nabla_{\\mathbf{s}} g(\\mathbf{s})\\,\\right] \\;=\\; c^2 \\mathbb{E}\\!\\left[\\,\\nabla_{\\mathbf{s}} g(\\mathbf{s})\\,\\right]\n$$\n我们的函数是 $g(\\mathbf{s}) = f(\\mathbf{k}^\\top\\mathbf{s})$。我们使用链式法则计算它关于 $\\mathbf{s}$ 的梯度。令 $x = \\mathbf{k}^\\top\\mathbf{s}$。\n$$\n\\nabla_{\\mathbf{s}} g(\\mathbf{s}) \\;=\\; \\nabla_{\\mathbf{s}} f(\\mathbf{k}^\\top\\mathbf{s}) \\;=\\; \\frac{df}{dx} \\frac{\\partial x}{\\partial \\mathbf{s}} \\;=\\; f'(\\mathbf{k}^\\top\\mathbf{s}) \\nabla_{\\mathbf{s}} (\\mathbf{k}^\\top \\mathbf{s})\n$$\n线性投影 $\\mathbf{k}^\\top\\mathbf{s}$ 关于 $\\mathbf{s}$ 的梯度就是向量 $\\mathbf{k}$。因此，\n$$\n\\nabla_{\\mathbf{s}} g(\\mathbf{s}) \\;=\\; f'(\\mathbf{k}^\\top\\mathbf{s}) \\, \\mathbf{k}\n$$\n现在，将此梯度代回Stein引理中的期望：\n$$\n\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right] \\;=\\; c^2 \\mathbb{E}\\!\\left[\\,f'(\\mathbf{k}^\\top\\mathbf{s}) \\, \\mathbf{k}\\,\\right]\n$$\n由于 $\\mathbf{k}$ 是一个常向量，可以将其从期望中提出：\n$$\n\\mathbb{E}\\!\\left[\\,\\mathbf{s}\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right] \\;=\\; c^2 \\mathbf{k} \\, \\mathbb{E}\\!\\left[\\,f'(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]\n$$\n项 $\\mathbb{E}[f'(\\mathbf{k}^\\top\\mathbf{s})]$ 是一个标量期望。我们将其记为 $E_{f'} = \\mathbb{E}[f'(\\mathbf{k}^\\top\\mathbf{s})]$。那么STA的分子是 $c^2 E_{f'} \\mathbf{k}$。\n\nSTA的分母是平均发放率，即标量 $E_f = \\mathbb{E}[f(\\mathbf{k}^\\top\\mathbf{s})]$。\n结合分子和分母，我们得到STA的表达式：\n$$\n\\mathrm{STA} \\;=\\; \\frac{c^2 \\, \\mathbb{E}\\!\\left[\\,f'(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]}{\\mathbb{E}\\!\\left[\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]} \\, \\mathbf{k}\n$$\n这个结果表明STA是真实滤波器 $\\mathbf{k}$ 的一个标量倍。设这个标量为 $C$：\n$$\nC = \\frac{c^2 \\, \\mathbb{E}\\!\\left[\\,f'(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]}{\\mathbb{E}\\!\\left[\\,f(\\mathbf{k}^\\top\\mathbf{s})\\,\\right]} \\quad \\implies \\quad \\mathrm{STA} = C \\mathbf{k}\n$$\n为了计算偏差角 $\\Delta$，我们必须确定标量 $C$ 的符号。\n项 $c^2$ 是正的，因为 $c > 0$。\n分母是平均发放率 $\\mathbb{E}[f(\\mathbf{k}^\\top\\mathbf{s})]$。由于 $\\lambda_{\\max} > 0$，发放率函数 $f(x) = \\frac{\\lambda_{\\max}}{1 + \\exp(- (x-\\theta)/\\beta)}$ 对所有输入 $x$ 都严格为正。一个严格为正的随机变量的期望也严格为正。因此，$\\mathbb{E}[f(\\mathbf{k}^\\top\\mathbf{s})] > 0$。\n分子包含非线性函数导数的期望 $f'(x)$。让我们计算这个导数：\n$$\nf'(x) \\;=\\; \\frac{d}{dx} \\left[ \\frac{\\lambda_{\\max}}{1 + \\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right)} \\right] \\;=\\; \\lambda_{\\max} \\left[ -1 \\left(1 + \\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right)\\right)^{-2} \\cdot \\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right) \\cdot \\left(-\\frac{1}{\\beta}\\right) \\right]\n$$\n$$\nf'(x) \\;=\\; \\frac{\\lambda_{\\max}}{\\beta} \\frac{\\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right)}{\\left(1 + \\exp\\!\\left(-\\frac{x - \\theta}{\\beta}\\right)\\right)^2}\n$$\n鉴于 $\\lambda_{\\max} > 0$ 和 $\\beta > 0$，并注意到指数项总是正的，且分母是一个平方项（因此是正的），我们可以得出结论，$f'(x) > 0$ 对所有 $x \\in \\mathbb{R}$ 成立。因此，期望 $\\mathbb{E}[f'(\\mathbf{k}^\\top\\mathbf{s})]$ 必定为正。\n由于标量 $C$ 的所有三个组成部分（$c^2$、$\\mathbb{E}[f'(\\mathbf{k}^\\top\\mathbf{s})]$ 以及 $\\mathbb{E}[f(\\mathbf{k}^\\top\\mathbf{s})]$ 的倒数）都是正的，标量 $C$ 必须是正的，即 $C > 0$。\n\n现在我们计算偏差角 $\\Delta$：\n$$\n\\Delta \\;=\\; \\arccos\\!\\left(\\frac{\\mathrm{STA}^{\\top}\\mathbf{k}}{\\|\\mathrm{STA}\\|\\,\\|\\mathbf{k}\\|}\\right)\n$$\n代入 $\\mathrm{STA} = C \\mathbf{k}$：\n$$\n\\Delta \\;=\\; \\arccos\\!\\left(\\frac{(C\\mathbf{k})^{\\top}\\mathbf{k}}{\\|C\\mathbf{k}\\|\\,\\|\\mathbf{k}\\|}\\right)\n$$\n自变量的分子是 $(C\\mathbf{k})^{\\top}\\mathbf{k} = C(\\mathbf{k}^\\top\\mathbf{k}) = C\\|\\mathbf{k}\\|^2$。\n自变量的分母是 $\\|C\\mathbf{k}\\|\\|\\mathbf{k}\\| = |C|\\|\\mathbf{k}\\|\\|\\mathbf{k}\\| = |C|\\|\\mathbf{k}\\|^2$。\narccos内的表达式变为：\n$$\n\\frac{C\\|\\mathbf{k}\\|^2}{|C|\\|\\mathbf{k}\\|^2} \\;=\\; \\frac{C}{|C|}\n$$\n因为我们已经确定 $C > 0$，所以有 $|C| = C$。因此，自变量是：\n$$\n\\frac{C}{C} \\;=\\; 1\n$$\n最后，我们计算角度 $\\Delta$：\n$$\n\\Delta \\;=\\; \\arccos(1) \\;=\\; 0\n$$\n偏差角为0弧度。这表明，对于一个由球对称高斯噪声驱动的LN模型，STA是滤波器方向的无偏估计量，无论(单调)非线性的具体形式或其他模型参数如何。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "虽然 STA 可以揭示神经元调谐的单个主要特征，但许多神经元对多个特征做出响应。本实践介绍了脉冲触发协方差（STC），这是一种通过分析脉冲触发刺激集合的方差来识别这些附加特征的方法。你将应用一种来自随机矩阵理论的强大技术，在有限数据集中区分真实的神经特征和统计噪声，这是从一维分析走向多维特征空间的关键一步。",
            "id": "4016504",
            "problem": "给定一组脉冲触发协方差 (spike-triggered covariance, STC) 特征值列表，以及刺激维度和脉冲触发样本的数量。刺激被建模为维度为 $d$ 的独立高斯向量，每个坐标的方差为 $\\sigma^2$，均值为零。STC 是通过从 $n$ 个脉冲触发的刺激样本中减去样本均值并形成样本协方差矩阵来计算的。在神经元对刺激特征没有选择性的零假设下，神经元的脉冲触发系综的总体协方差等于 $\\sigma^2 \\mathbf{I}_d$，并且 STC 特征值的有限样本波动由随机矩阵理论所支配。脉冲触发协方差 (STC) 是以脉冲为条件的刺激的协方差，而逆相关 (Reverse Correlation) 指的是通过将刺激与脉冲相关联来表征神经响应特性。\n\n您的任务是为每个提供的测试用例计算显著维度的数量，该数量定义为超出有限采样下预期的随机矩阵零假设支撑集的 STC 特征值的计数。请使用以下具有科学依据的基础：\n\n- 在 $d$ 维空间中，$n$ 个独立的、零均值高斯观测值的样本协方差矩阵可以建模为一个适当缩放的威沙特 (Wishart) 矩阵，其特征值分布在零假设下（在 $d,n$ 趋于大且比率 $q = d/n$ 固定的极限下）收敛于马尔琴科-帕斯图尔 (Marchenko–Pastur) 分布。\n- 在零假设下，STC 特征值超出随机矩阵模型所隐含的理论支撑区间的偏差，表明这些维度具有显著改变的方差（候选的刺激特征或抑制方向）。\n\n在您的计算中实施以下规则：\n\n- 令 $q = d/n$。零假设下的理论非零支撑区间由 $q$ 和 $\\sigma^2$ 决定。如果一个 STC 特征值严格位于上支撑边界之上或严格位于下支撑边界之下，则该特征值是显著的；在边界上的等值情况不被视为显著。\n- 当 $q > 1$ 时，零模型意味着在零点有一个点质量：由于秩亏，一部分特征值恰好为零。这类零特征值与零假设一致，不得计为低于下支撑边界的显著离群值。当 $q > 1$ 时，使用一个小的非负容差来识别数值上的零。\n\n每个测试用例的输入规范：\n- $d$：刺激维度，为整数（例如，$d = 30$）。\n- $n$：脉冲触发样本的数量，为整数（例如，$n = 300$）。\n- $\\sigma^2$：每个坐标的刺激方差，为正实数（例如，$\\sigma^2 = 1.0$）。\n- 一个包含 $d$ 个实数的列表，代表 STC 特征值（例如，$[1.0, 1.0, \\dots, 1.9]$，恰好有 $d$ 个条目）。\n\n测试套件：\n- 案例 1：$d = 30$，$n = 300$，$\\sigma^2 = 1.0$，特征值为 $[1.9, 0.4, 1.8, \\underbrace{1.0, \\dots, 1.0}_{27 \\text{ entries}}]$。\n- 案例 2：$d = 100$，$n = 40$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{0.0, \\dots, 0.0}_{60 \\text{ entries}}, \\underbrace{1.0, \\dots, 1.0}_{39 \\text{ entries}}, 7.0]$。\n- 案例 3：$d = 50$，$n = 50$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{1.0, \\dots, 1.0}_{48 \\text{ entries}}, 4.0, 4.001]$。\n- 案例 4：$d = 10$，$n = 1000$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{1.0, \\dots, 1.0}_{8 \\text{ entries}}, 0.80, 1.22]$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于上述测试套件，程序必须返回一个整数列表，每个整数等于相应案例的显著维度数，并按案例顺序排列。例如，输出格式必须与 $[r_1,r_2,r_3,r_4]$ 完全一样，其中每个 $r_i$ 是一个整数。\n\n此问题不涉及任何物理单位、角度或百分比。输出仅包含整数。您的程序必须是自包含的，并且不得读取任何输入；它应能按原样运行并产生指定的输出格式。",
            "solution": "该问题要求从脉冲触发协方差 (Spike-Triggered Covariance, STC) 分析中识别显著的特征值。显著性的确定基于一个源自随机矩阵理论（特别是马尔琴科-帕斯图尔定律）的零假设模型。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **刺激模型**：维度为 $d$ 的独立高斯向量，每个坐标的方差为 $\\sigma^2$，均值为零。总体协方差为 $\\sigma^2 \\mathbf{I}_d$。\n- **STC 计算**：从 $n$ 个脉冲触发的刺激样本中减去样本均值计算得到。\n- **零假设**：神经元对刺激特征没有选择性。脉冲触发系综的总体协方差为 $\\sigma^2 \\mathbf{I}_d$。\n- **理论基础**：在 $d, n$ 趋于大且比率 $q = d/n$ 固定的极限下，样本协方差矩阵的特征值分布由马尔琴科-帕斯图尔分布建模。\n- **显著性规则**：如果一个 STC 特征值严格位于理论零分布的上支撑边界之上或下支撑边界之下，则该特征值是显著的。在边界上的等值情况不被视为显著。\n- **$q>1$ 的规则**：由于秩亏，一部分特征值预期为零。这些不被计为显著。应使用一个小的非负容差来识别数值上的零。\n- **测试用例**：\n    - 案例 1：$d = 30$，$n = 300$，$\\sigma^2 = 1.0$，特征值为 $[1.9, 0.4, 1.8, \\underbrace{1.0, \\dots, 1.0}_{27 \\text{ entries}}]$。\n    - 案例 2：$d = 100$，$n = 40$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{0.0, \\dots, 0.0}_{60 \\text{ entries}}, \\underbrace{1.0, \\dots, 1.0}_{39 \\text{ entries}}, 7.0]$。\n    - 案例 3：$d = 50$，$n = 50$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{1.0, \\dots, 1.0}_{48 \\text{ entries}}, 4.0, 4.001]$。\n    - 案例 4：$d = 10$，$n = 1000$，$\\sigma^2 = 1.0$，特征值为 $[\\underbrace{1.0, \\dots, 1.0}_{8 \\text{ entries}}, 0.80, 1.22]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在计算神经科学和统计物理学（随机矩阵理论）方面具有科学依据。使用马尔琴科-帕斯图尔定律来定义 STC 特征值的零分布是神经编码分析中一种标准且成熟的技术。该问题是适定 (well-posed) 的：所有必要的参数（$d$、$n$、$\\sigma^2$ 和特征值）都已提供，确定显著性的规则清晰明确。问题设置是自包含且内部一致的。对 $q \\le 1$ 和 $q > 1$ 两种情况的区别处理是正确的，反映了随机矩阵的已知性质。语言客观而精确。\n\n**步骤 3：结论与行动**\n问题有效。将制定并实施一个合理的解决方案。\n\n### 基于原理的解决方案\n该解决方案基于随机矩阵理论的基石——马尔琴科-帕斯图尔定律的应用。该定律描述了大型样本协方差矩阵特征值的渐近密度。\n\n**1. 理论框架**\n在零假设下，即神经元发放脉冲与刺激无关，脉冲触发的刺激集合是来自先验刺激分布的随机抽样。刺激被建模为从协方差为 $\\sigma^2 \\mathbf{I}_d$ 的各向同性高斯分布中抽取的 $d$ 维随机向量。由 $n$ 个此类向量构成的样本协方差矩阵，其特征值在 $n$ 和 $d$ 很大且比率 $q = d/n$ 固定的极限下，被限制在一个特定的区间内。\n\n样本协方差矩阵特征值谱的连续部分支撑在区间 $[\\lambda_-, \\lambda_+]$ 上，其边界由以下公式给出：\n$$ \\lambda_\\pm = \\sigma^2 (1 \\pm \\sqrt{q})^2 $$\n实验测得的 STC 矩阵的任何特征值如果严格落在此区间之外，则被认为是统计上显著的，这表明它反映了神经元刺激选择性的真实特征，而非有限采样噪声。\n\n**2. 秩亏情况的处理 ($q > 1$)**\n当刺激空间的维度 $d$ 大于样本数 $n$ 时（即 $q > 1$），样本协方差矩阵是秩亏的。其秩最多为 $n$。这导致至少有 $d-n$ 个零特征值。这些结构性零是高维几何的直接结果，并由马尔琴科-帕斯图尔定律预测，该定律在特征值 $0$ 处包含一个权重为 $1 - 1/q$ 的狄拉克δ函数。因此，对于 $q > 1$ 的情况，为零（或数值上接近零）的特征值是零分布的一部分，不得计为显著的离群值。\n\n**3. 显著性检验算法**\n对于每个测试用例，显著维度的数量按以下步骤确定：\n1.  计算比率 $q = d/n$。\n2.  计算零假设支撑区间的上界和下界：$\\lambda_+ = \\sigma^2 (1 + \\sqrt{q})^2$ 和 $\\lambda_- = \\sigma^2 (1 - \\sqrt{q})^2$。注意，对于 $q>1$，这变为 $\\lambda_- = \\sigma^2 (\\sqrt{q} - 1)^2$。\n3.  初始化显著特征值计数器为 $0$。\n4.  遍历每个给定的特征值 $\\lambda_{obs}$。\n5.  应用显著性检验：\n    - 如果 $\\lambda_{obs} > \\lambda_+$ 或 $\\lambda_{obs}  \\lambda_-$，该特征值为显著性候选。\n    - 如果 $q > 1$ 且特征值因低于 $\\lambda_-$ 而成为候选，则需要进一步检查。如果 $\\lambda_{obs}$ 在数值上与零无法区分（例如，对于一个小的容差 $\\epsilon$，有 $|\\lambda_{obs}|  \\epsilon$），则将其归类为结构性零，不计为显著。\n    - 如果特征值通过这些检查，则将计数器加一。\n6.  计数器的最终值即为显著维度的数量。\n\n### 在测试用例上的应用\n\n**案例 1：** $d = 30$，$n = 300$，$\\sigma^2 = 1.0$。\n- $q = 30/300 = 0.1$。\n- $\\lambda_+ = 1.0 \\times (1 + \\sqrt{0.1})^2 \\approx 1.7324$。\n- $\\lambda_- = 1.0 \\times (1 - \\sqrt{0.1})^2 \\approx 0.4675$。\n- 零假设支撑集约为 $[0.4675, 1.7324]$。\n- 待检查的特征值：$1.9$, $0.4$, $1.8$。\n  - $\\lambda = 1.9 > \\lambda_+$ (显著)。\n  - $\\lambda = 0.4  \\lambda_-$ (显著)。\n  - $\\lambda = 1.8 > \\lambda_+$ (显著)。\n- 总显著维度：$3$。\n\n**案例 2：** $d = 100$，$n = 40$，$\\sigma^2 = 1.0$。\n- $q = 100/40 = 2.5 > 1$。\n- $\\lambda_+ = 1.0 \\times (1 + \\sqrt{2.5})^2 \\approx 6.6623$。\n- $\\lambda_- = 1.0 \\times (1 - \\sqrt{2.5})^2 = 1.0 \\times (\\sqrt{2.5} - 1)^2 \\approx 0.3377$。\n- 非零特征值的零假设支撑集约为 $[0.3377, 6.6623]$。\n- 有 $d-n = 60$ 个值为 $0.0$ 的特征值。这些是结构性零，不显著。\n- 待检查的特征值：$1.0$ (重复)，$7.0$。\n  - $\\lambda = 1.0$：落在支撑区间内 (不显著)。\n  - $\\lambda = 7.0 > \\lambda_+$ (显著)。\n- 总显著维度：$1$。\n\n**案例 3：** $d = 50$，$n = 50$，$\\sigma^2 = 1.0$。\n- $q = 50/50 = 1.0$。\n- $\\lambda_+ = 1.0 \\times (1 + \\sqrt{1.0})^2 = 4.0$。\n- $\\lambda_- = 1.0 \\times (1 - \\sqrt{1.0})^2 = 0.0$。\n- 零假设支撑集为 $[0.0, 4.0]$。显著性准则要求严格不等。\n- 待检查的特征值：$4.0$, $4.001$。\n  - $\\lambda = 4.0 = \\lambda_+$ (不显著)。\n  - $\\lambda = 4.001 > \\lambda_+$ (显著)。\n- 总显著维度：$1$。\n\n**案例 4：** $d = 10$，$n = 1000$，$\\sigma^2 = 1.0$。\n- $q = 10/1000 = 0.01$。\n- $\\lambda_+ = 1.0 \\times (1 + \\sqrt{0.01})^2 = (1.1)^2 = 1.21$。\n- $\\lambda_- = 1.0 \\times (1 - \\sqrt{0.01})^2 = (0.9)^2 = 0.81$。\n- 零假设支撑集为 $[0.81, 1.21]$。\n- 待检查的特征值：$0.80$, $1.22$。\n  - $\\lambda = 0.80  \\lambda_-$ (显著)。\n  - $\\lambda = 1.22 > \\lambda_+$ (显著)。\n- 总显著维度：$2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of significant STC eigenvalues for several test cases\n    based on the Marchenko-Pastur distribution.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d, n, sigma_squared, eigenvalues)\n    test_cases = [\n        (30, 300, 1.0, [1.9, 0.4, 1.8] + [1.0] * 27),\n        (100, 40, 1.0, [0.0] * 60 + [1.0] * 39 + [7.0]),\n        (50, 50, 1.0, [1.0] * 48 + [4.0, 4.001]),\n        (10, 1000, 1.0, [1.0] * 8 + [0.80, 1.22])\n    ]\n\n    results = []\n    # Tolerance for identifying numerical zeros when q > 1.\n    zero_tolerance = 1e-9\n\n    for d, n, sigma_sq, eigenvalues in test_cases:\n        # Calculate the ratio q = d/n.\n        q = d / n\n\n        # Calculate the bounds of the Marchenko-Pastur support interval.\n        sqrt_q = np.sqrt(q)\n        lambda_plus = sigma_sq * (1 + sqrt_q)**2\n        lambda_minus = sigma_sq * (1 - sqrt_q)**2\n\n        significant_count = 0\n        for eig in eigenvalues:\n            # An eigenvalue is significant if it is strictly outside the support interval.\n            is_outlier = eig > lambda_plus or eig  lambda_minus\n            \n            if is_outlier:\n                # If q > 1, structural zeros are expected and not considered significant.\n                # These zeros can manifest as very small numbers due to numerics.\n                if q > 1 and abs(eig)  zero_tolerance:\n                    # This is a structural zero, not a significant deviation.\n                    continue\n                significant_count += 1\n\n        results.append(significant_count)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}