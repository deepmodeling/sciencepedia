{
    "hands_on_practices": [
        {
            "introduction": "Before a neuron can generate an action potential, it must maintain a stable resting potential. This fundamental exercise guides you through calculating this baseline voltage by treating it as the equilibrium point where all inward and outward ionic currents balance . By linearizing the system around this fixed point, you will also determine the membrane time constant, $\\tau_{\\text{m}}$, which quantifies the neuron's passive response to small perturbations and sets the stage for understanding more complex, active dynamics.",
            "id": "4033019",
            "problem": "Consider a single-compartment neuron model obeying Kirchhoff’s current law and Ohm’s law. The total ionic current is modeled as the sum of a leak current, an effective subthreshold fast sodium current, and an effective subthreshold delayed-rectifier potassium current, each represented as a conductance times its driving force. The membrane equation is\n$$C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}},$$\nwhere the ionic currents satisfy\n$$I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}}, \\quad I_{x} = g_{x}\\left(V - E_{x}\\right),$$\nwith $x \\in \\{\\text{L}, \\text{Na}, \\text{K}\\}$. Assume a zero applied current $I_{\\text{app}} = 0$. Treat the subthreshold voltage-gated channel contributions as constant effective conductances in a narrow neighborhood around the resting potential to capture their feedback without explicitly modeling gating dynamics. The parameters are:\n- Membrane capacitance $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$,\n- Leak conductance $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^{2}$ and reversal potential $E_{\\text{L}} = -70~\\text{mV}$,\n- Effective subthreshold sodium conductance $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^{2}$ and reversal potential $E_{\\text{Na}} = 60~\\text{mV}$,\n- Effective subthreshold potassium conductance $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^{2}$ and reversal potential $E_{\\text{K}} = -90~\\text{mV}$.\n\nStarting from the definitions above, and without invoking any pre-derived formulas for the fixed point or linearization, do the following:\n1. Determine the resting potential $V_{\\text{rest}}$ by solving $\\frac{dV}{dt} = 0$.\n2. Linearize the membrane equation around $V_{\\text{rest}}$ to obtain the linear membrane time constant $\\tau_{\\text{m}}$, defined as the characteristic time scale governing the exponential relaxation of small perturbations back to $V_{\\text{rest}}$.\n\nExpress $V_{\\text{rest}}$ in millivolts and $\\tau_{\\text{m}}$ in milliseconds. Round both to four significant figures. Provide your final answer as a two-entry row matrix in the order $V_{\\text{rest}}$, $\\tau_{\\text{m}}$.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\nThe given information is:\n-   Membrane equation: $C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}}$\n-   Ionic current: $I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}}$, where $I_{x} = g_{x}\\left(V - E_{x}\\right)$ for $x \\in \\{\\text{L}, \\text{Na}, \\text{K}\\}$.\n-   Applied current: $I_{\\text{app}} = 0$.\n-   Assumption: The conductances $g_{\\text{L}}$, $g_{\\text{Na}}$, and $g_{\\text{K}}$ are treated as constant effective conductances.\n-   Parameters:\n    -   $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$\n    -   $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{L}} = -70~\\text{mV}$\n    -   $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{Na}} = 60~\\text{mV}$\n    -   $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{K}} = -90~\\text{mV}$\n-   Requirements:\n    1.  Determine the resting potential $V_{\\text{rest}}$ by solving $\\frac{dV}{dt} = 0$.\n    2.  Linearize the equation around $V_{\\text{rest}}$ to find the membrane time constant $\\tau_{\\text{m}}$.\n    3.  The derivation must not invoke pre-derived formulas.\n    4.  Final answers for $V_{\\text{rest}}$ (in mV) and $\\tau_{\\text{m}}$ (in ms) must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes a single-compartment RC-circuit model of a neuron, a foundational and scientifically valid simplification in computational neuroscience. The governing equations are based on Kirchhoff's current law and Ohm's law, which are fundamental principles of physics. The parameter values are biophysically plausible.\n-   **Well-Posed**: The problem is well-posed. It asks for the fixed point of a first-order linear ordinary differential equation and its characteristic time constant, both of which are uniquely defined and solvable algebraic tasks.\n-   **Objective**: The problem is stated using precise, objective, and standard scientific terminology.\n-   **Completeness and Consistency**: All necessary parameters are provided with consistent units. $(\\mu\\text{F}/\\text{cm}^2) / (\\text{mS}/\\text{cm}^2) = (10^{-6}~\\text{F}) / (10^{-3}~\\text{S}) = 10^{-3}~\\text{s} = 1~\\text{ms}$, confirming dimensional consistency for the time constant.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and self-contained. It is therefore deemed **valid**. A solution will be derived from first principles as requested.\n\n---\n\n### Solution Derivation\n\nThe analysis proceeds in two parts as required.\n\n#### 1. Determination of the Resting Potential ($V_{\\text{rest}}$)\n\nThe resting potential, $V_{\\text{rest}}$, is the membrane potential $V$ at which the system is in a steady state, meaning the net current flow across the membrane is zero and the voltage does not change over time. This corresponds to the condition $\\frac{dV}{dt} = 0$.\nThe membrane equation is:\n$$C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}}$$\nWith $I_{\\text{app}} = 0$ and $\\frac{dV}{dt} = 0$, the equation simplifies to:\n$$I_{\\text{ion}} = 0$$\nThe total ionic current $I_{\\text{ion}}$ is the sum of the individual leak, sodium, and potassium currents:\n$$I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}} = 0$$\nSubstituting the expression for each current, $I_{x} = g_{x}(V - E_{x})$, into the equation gives:\n$$g_{\\text{L}}(V - E_{\\text{L}}) + g_{\\text{Na}}(V - E_{\\text{Na}}) + g_{\\text{K}}(V - E_{\\text{K}}) = 0$$\nAt the resting potential, $V = V_{\\text{rest}}$. We solve the above equation for $V_{\\text{rest}}$:\n$$g_{\\text{L}}(V_{\\text{rest}} - E_{\\text{L}}) + g_{\\text{Na}}(V_{\\text{rest}} - E_{\\text{Na}}) + g_{\\text{K}}(V_{\\text{rest}} - E_{\\text{K}}) = 0$$\nWe rearrange the terms to isolate $V_{\\text{rest}}$:\n$$g_{\\text{L}}V_{\\text{rest}} - g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}V_{\\text{rest}} - g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}V_{\\text{rest}} - g_{\\text{K}}E_{\\text{K}} = 0$$\n$$(g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}})V_{\\text{rest}} = g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}}$$\n$$V_{\\text{rest}} = \\frac{g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}}}{g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}}}$$\nNow, we substitute the given numerical values:\n-   $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^2$, $E_{\\text{L}} = -70~\\text{mV}$\n-   $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^2$, $E_{\\text{Na}} = 60~\\text{mV}$\n-   $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^2$, $E_{\\text{K}} = -90~\\text{mV}$\n\nThe denominator is the total conductance, $g_{\\text{total}}$:\n$$g_{\\text{total}} = g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}} = 0.10 + 0.02 + 0.08 = 0.20~\\text{mS}/\\text{cm}^2$$\nThe numerator is:\n$$(0.10)(-70) + (0.02)(60) + (0.08)(-90) = -7.0 + 1.2 - 7.2 = -13.0~\\text{mS} \\cdot \\text{mV} / \\text{cm}^2$$\nThus, the resting potential is:\n$$V_{\\text{rest}} = \\frac{-13.0~\\text{mS} \\cdot \\text{mV} / \\text{cm}^2}{0.20~\\text{mS}/\\text{cm}^2} = -65~\\text{mV}$$\nRounding to four significant figures, we get $V_{\\text{rest}} = -65.00~\\text{mV}$.\n\n#### 2. Determination of the Membrane Time Constant ($\\tau_{\\text{m}}$)\n\nThe problem asks to linearize the membrane equation around $V_{\\text{rest}}$. The equation is $C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}}$.\nLet's express $I_{\\text{ion}}$ as a function of $V$:\n$$I_{\\text{ion}}(V) = g_{\\text{L}}(V - E_{\\text{L}}) + g_{\\text{Na}}(V - E_{\\text{Na}}) + g_{\\text{K}}(V - E_{\\text{K}})$$\n$$I_{\\text{ion}}(V) = (g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}}) V - (g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}})$$\nUsing the definition of total conductance $g_{\\text{total}}$ and the expression for $V_{\\text{rest}}$ derived previously:\n$$g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}} = g_{\\text{total}}V_{\\text{rest}}$$\nSubstituting these into the expression for $I_{\\text{ion}}(V)$:\n$$I_{\\text{ion}}(V) = g_{\\text{total}}V - g_{\\text{total}}V_{\\text{rest}} = g_{\\text{total}}(V - V_{\\text{rest}})$$\nThe membrane equation becomes:\n$$C_{\\text{m}} \\frac{dV}{dt} = -g_{\\text{total}}(V - V_{\\text{rest}})$$\nThis equation is already in a linear form. The formal process of linearization involves a Taylor series expansion of the right-hand side, $f(V) = -I_{\\text{ion}}(V)$, around $V = V_{\\text{rest}}$:\n$$f(V) \\approx f(V_{\\text{rest}}) + f'(V_{\\text{rest}})(V - V_{\\text{rest}})$$\nWe know $f(V_{\\text{rest}}) = -I_{\\text{ion}}(V_{\\text{rest}}) = 0$. The derivative is:\n$$f'(V) = \\frac{d}{dV}[-I_{\\text{ion}}(V)] = \\frac{d}{dV}[-g_{\\text{total}}(V - V_{\\text{rest}})] = -g_{\\text{total}}$$\nSince the derivative is a constant, $f'(V_{\\text{rest}}) = -g_{\\text{total}}$. The linearized equation is:\n$$C_{\\text{m}} \\frac{dV}{dt} = -g_{\\text{total}}(V - V_{\\text{rest}})$$\nThis confirms the original equation's linearity. To find the time constant, we consider small perturbations $v(t) = V(t) - V_{\\text{rest}}$ around the resting potential. The derivative is $\\frac{dv}{dt} = \\frac{dV}{dt}$. Substituting these into the equation yields:\n$$C_{\\text{m}} \\frac{dv}{dt} = -g_{\\text{total}}v$$\nThis is the equation for exponential decay. We rearrange it to the canonical form $\\tau \\frac{dy}{dt} = -y$:\n$$\\frac{C_{\\text{m}}}{g_{\\text{total}}} \\frac{dv}{dt} = -v$$\nBy comparing with the standard form, we identify the membrane time constant $\\tau_{\\text{m}}$ as:\n$$\\tau_{\\text{m}} = \\frac{C_{\\text{m}}}{g_{\\text{total}}}$$\nWe substitute the numerical values for $C_{\\text{m}}$ and $g_{\\text{total}}$:\n-   $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$\n-   $g_{\\text{total}} = 0.20~\\text{mS}/\\text{cm}^{2}$\n\n$$\\tau_{\\text{m}} = \\frac{1.0~\\mu\\text{F}/\\text{cm}^{2}}{0.20~\\text{mS}/\\text{cm}^{2}} = 5.0~\\frac{\\mu\\text{F}}{\\text{mS}}$$\nTo express this in standard time units, we analyze the units:\n$$\\frac{\\mu\\text{F}}{\\text{mS}} = \\frac{10^{-6}~\\text{F}}{10^{-3}~\\text{S}} = 10^{-3}~\\frac{\\text{F}}{\\text{S}}$$\nSince a Farad is a Coulomb per Volt ($C/V$) and a Siemens is an Ampere per Volt ($(C/s)/V$), the ratio $F/S$ is equivalent to seconds ($s$):\n$$10^{-3}~\\text{s} = 1~\\text{ms}$$\nTherefore, $\\tau_{\\text{m}} = 5.0~\\text{ms}$.\nRounding to four significant figures, we get $\\tau_{\\text{m}} = 5.000~\\text{ms}$.\n\nThe final results are $V_{\\text{rest}} = -65.00~\\text{mV}$ and $\\tau_{\\text{m}} = 5.000~\\text{ms}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-65.00 & 5.000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The active, nonlinear behavior of neurons arises from the voltage-dependent properties of their ion channels. This practice delves into the core kinetics of a single channel's activation gate, governed by voltage-sensitive opening and closing rates, $\\alpha_m(V)$ and $\\beta_m(V)$ . You will derive and numerically compute the two essential functions that characterize these dynamics—the steady-state activation curve, $m_{\\infty}(V)$, and the voltage-dependent time constant, $\\tau_m(V)$—providing a foundational skill for building and interpreting any conductance-based model.",
            "id": "4032992",
            "problem": "Consider the activation gating variable of a voltage-gated channel, denoted by $m(t;V)$, which evolves according to first-order two-state kinetics driven by a membrane voltage $V$. The dynamics are given by the ordinary differential equation\n$$\n\\frac{dm}{dt} = \\alpha_m(V)\\,\\bigl(1 - m\\bigr) - \\beta_m(V)\\,m,\n$$\nwhere $t$ is time in milliseconds (ms), $V$ is voltage in millivolts (mV), and $\\alpha_m(V)$ and $\\beta_m(V)$ are voltage-dependent transition rates in $\\mathrm{ms}^{-1}$ governing transitions into and out of the activated state. Assume the gating process is memoryless (Markovian) and that, for a fixed voltage $V$, the system approaches a unique steady state exponentially. Your task is to determine, from first principles, for each test case specified below: (i) the steady-state activation $m_{\\infty}(V)$ and (ii) the activation time constant $\\tau_m(V)$, both as functions of voltage, and then identify the voltage within the provided voltage range at which $\\tau_m(V)$ is minimal (i.e., the fastest activation kinetics occurs). Express all voltages in millivolts (mV) and times in milliseconds (ms). The angle unit is not applicable. The final numerical outputs must be rounded to three decimal places.\n\nFor the purposes of computation, treat $m_{\\infty}(V)$ and $\\tau_m(V)$ as functions determined solely by the rate functions $\\alpha_m(V)$ and $\\beta_m(V)$ and the governing equation above, without assuming any pre-specified shortcut formulas. Compute $m_{\\infty}(V)$ and $\\tau_m(V)$ numerically at discrete voltages over the provided ranges using steps of $\\Delta V = 0.1\\,\\mathrm{mV}$.\n\nTest Suite:\n- Case A (Hodgkin–Huxley-type sodium activation rates; Hodgkin–Huxley (HH) is a classic conductance-based neuron model):\n  - Voltage range: $V \\in [-100, 50]\\,\\mathrm{mV}$.\n  - $\\alpha_m(V) = 0.1 \\cdot \\dfrac{V + 40}{1 - \\exp\\!\\bigl(-\\dfrac{V + 40}{10}\\bigr)}$ in $\\mathrm{ms}^{-1}$.\n  - $\\beta_m(V) = 4 \\cdot \\exp\\!\\bigl(-\\dfrac{V + 65}{18}\\bigr)$ in $\\mathrm{ms}^{-1}$.\n  - For numerical stability, near points where the denominator in $\\alpha_m(V)$ approaches zero, use a well-defined limiting value based on series expansion at that point to avoid division by zero.\n- Case B (Exponential rate asymmetry with interior extremum):\n  - Voltage range: $V \\in [-100, 40]\\,\\mathrm{mV}$.\n  - Parameters: $A_1 = 0.05\\,\\mathrm{ms}^{-1}$, $B_1 = 0.5\\,\\mathrm{ms}^{-1}$, $V_1 = -20\\,\\mathrm{mV}$, $k_1 = 25\\,\\mathrm{mV}$, $k_2 = 20\\,\\mathrm{mV}$.\n  - $\\alpha_m(V) = A_1 \\cdot \\exp\\!\\Bigl(\\dfrac{V - V_1}{k_1}\\Bigr)$ in $\\mathrm{ms}^{-1}$.\n  - $\\beta_m(V) = B_1 \\cdot \\exp\\!\\Bigl(-\\dfrac{V - V_1}{k_2}\\Bigr)$ in $\\mathrm{ms}^{-1}$.\n- Case C (Saturating sigmoidal rates with boundary extremum):\n  - Voltage range: $V \\in [-80, 60]\\,\\mathrm{mV}$.\n  - Parameters: $A_2 = 2.0\\,\\mathrm{ms}^{-1}$, $B_2 = 1.0\\,\\mathrm{ms}^{-1}$, $V_{\\mathrm{half}} = -30\\,\\mathrm{mV}$, $k = 7\\,\\mathrm{mV}$.\n  - $\\alpha_m(V) = \\dfrac{A_2}{1 + \\exp\\!\\Bigl(-\\dfrac{V - V_{\\mathrm{half}}}{k}\\Bigr)}$ in $\\mathrm{ms}^{-1}$.\n  - $\\beta_m(V) = \\dfrac{B_2}{1 + \\exp\\!\\Bigl(\\dfrac{V - V_{\\mathrm{half}}}{k}\\Bigr)}$ in $\\mathrm{ms}^{-1}$.\n\nAlgorithmic requirements:\n- For each test case, evaluate $\\alpha_m(V)$ and $\\beta_m(V)$ on the specified voltage grid.\n- From the governing differential equation, determine $m_{\\infty}(V)$ and $\\tau_m(V)$ for each grid voltage.\n- Identify the voltage within the grid at which $\\tau_m(V)$ is minimal. If multiple grid points share the same minimal value within numerical precision, return the smallest voltage among them.\n- Round the reported voltages to three decimal places.\n\nFinal Output Format:\nYour program should produce a single line of output containing the minimal-$\\tau_m(V)$ voltages for the three test cases, as a comma-separated list enclosed in square brackets, for example, $[v_A,v_B,v_C]$, where each entry is in $\\mathrm{mV}$ rounded to three decimal places.",
            "solution": "The problem requires the determination of the steady-state activation $m_{\\infty}(V)$ and the activation time constant $\\tau_m(V)$ for a voltage-gated ion channel whose gating variable $m$ follows first-order kinetics. We are also tasked with finding the voltage at which $\\tau_m(V)$ is minimal for three distinct sets of voltage-dependent rate functions.\n\nThe governing ordinary differential equation (ODE) for the activation variable $m(t)$ at a constant membrane voltage $V$ is given as:\n$$\n\\frac{dm}{dt} = \\alpha_m(V) \\bigl(1 - m\\bigr) - \\beta_m(V) m\n$$\nwhere $\\alpha_m(V)$ and $\\beta_m(V)$ are the forward and backward transition rates in $\\mathrm{ms}^{-1}$, respectively.\n\n_Derivation of Steady-State Activation $m_{\\infty}(V)$_\n\nThe steady state of the system is defined by the condition where the gating variable no longer changes with time, i.e., $\\frac{dm}{dt} = 0$. Let $m_{\\infty}$ denote the value of $m$ at steady state. Substituting this condition into the governing ODE, we obtain:\n$$\n0 = \\alpha_m(V) \\bigl(1 - m_{\\infty}\\bigr) - \\beta_m(V) m_{\\infty}\n$$\nTo solve for $m_{\\infty}(V)$, we rearrange the terms:\n$$\n\\alpha_m(V) - \\alpha_m(V) m_{\\infty} = \\beta_m(V) m_{\\infty}\n$$\n$$\n\\alpha_m(V) = m_{\\infty} \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)\n$$\nIsolating $m_{\\infty}(V)$ yields the expression for the steady-state activation as a function of voltage:\n$$\nm_{\\infty}(V) = \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)}\n$$\n\n_Derivation of Activation Time Constant $\\tau_m(V)$_\n\nThe time constant $\\tau_m(V)$ characterizes the rate at which $m(t)$ approaches its steady-state value $m_{\\infty}(V)$. To derive $\\tau_m(V)$, we rearrange the original ODE into the standard form for exponential relaxation, $\\frac{dy}{dt} = \\frac{y_{\\infty} - y}{\\tau}$.\n\nStarting from the ODE:\n$$\n\\frac{dm}{dt} = \\alpha_m(V) - \\alpha_m(V) m - \\beta_m(V) m\n$$\nGroup the terms containing $m$:\n$$\n\\frac{dm}{dt} = \\alpha_m(V) - m \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)\n$$\nFactor out the term $\\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)$ from the right-hand side to reveal the structure related to $m_{\\infty}(V)$:\n$$\n\\frac{dm}{dt} = \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr) \\left( \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)} - m \\right)\n$$\nRecognizing the term in the parentheses as $m_{\\infty}(V)$, we have:\n$$\n\\frac{dm}{dt} = \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr) \\bigl(m_{\\infty}(V) - m\\bigr)\n$$\nThis equation can be rewritten as:\n$$\n\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\frac{1}{\\alpha_m(V) + \\beta_m(V)}}\n$$\nBy comparing this to the standard form $\\frac{dm}{dt} = \\frac{m_{\\infty} - m}{\\tau_m}$, we identify the activation time constant as:\n$$\n\\tau_m(V) = \\frac{1}{\\alpha_m(V) + \\beta_m(V)}\n$$\n\n_Numerical Procedure_\n\nWith the analytical expressions for $m_{\\infty}(V)$ and $\\tau_m(V)$ established, the subsequent task is to find the voltage at which $\\tau_m(V)$ is minimal for each test case. The procedure is as follows:\n1.  For each test case, define a discrete voltage grid $V$ over the specified range with a step size of $\\Delta V = 0.1\\,\\mathrm{mV}$.\n2.  For each voltage $V_i$ in the grid, compute the values of the rate functions $\\alpha_m(V_i)$ and $\\beta_m(V_i)$.\n3.  For Case A, the function $\\alpha_m(V) = 0.1 \\cdot \\frac{V + 40}{1 - \\exp(-\\frac{V + 40}{10})}$ has a removable singularity at $V = -40\\,\\mathrm{mV}$. The limit at this point is found using L'Hôpital's rule. Let $x = V + 40$ and consider the limit of the fraction as $x \\to 0$:\n    $$\n    \\lim_{x \\to 0} \\frac{x}{1 - \\exp(-x/10)} = \\lim_{x \\to 0} \\frac{\\frac{d}{dx}(x)}{\\frac{d}{dx}\\bigl(1 - \\exp(-x/10)\\bigr)} = \\lim_{x \\to 0} \\frac{1}{\\frac{1}{10}\\exp(-x/10)} = 10\n    $$\n    Therefore, $\\alpha_m(-40) = 0.1 \\times 10 = 1.0\\,\\mathrm{ms}^{-1}$. This limiting value must be used for numerical stability.\n4.  Calculate the time constant $\\tau_m(V_i)$ for each grid point using the derived formula $\\tau_m(V_i) = \\bigl(\\alpha_m(V_i) + \\beta_m(V_i)\\bigr)^{-1}$.\n5.  Search the resulting array of $\\tau_m$ values to find the minimum value.\n6.  The voltage $V_i$ corresponding to the first occurrence of this minimum is the desired result. This is guaranteed by the search algorithm, which returns the index of the first minimum encountered. The final voltage value is rounded to three decimal places.\n\nThis procedure is implemented for each of the three test cases (A, B, and C) to obtain the final set of voltages.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the voltage at which the activation time constant tau_m is minimal\n    for three different models of voltage-gated ion channels.\n    \"\"\"\n\n    # Define the rate functions for each test case.\n    # These functions are designed to operate on NumPy arrays (vectorized).\n\n    # Case A: Hodgkin-Huxley-type sodium activation\n    def alpha_m_A(V):\n        \"\"\"\n        Transition rate alpha_m for Case A. Handles the singularity at V = -40 mV.\n        \"\"\"\n        arg = V + 40.0\n        # The expression has a 0/0 form at V = -40 mV (arg = 0).\n        # The limit of arg / (1 - exp(-arg/10)) as arg -> 0 is 10, by L'Hopital's rule.\n        # So, the limit of alpha_m is 0.1 * 10 = 1.0.\n        return np.where(np.isclose(arg, 0.0),\n                        1.0,\n                        0.1 * arg / (1.0 - np.exp(-arg / 10.0)))\n\n    def beta_m_A(V):\n        \"\"\"Transition rate beta_m for Case A.\"\"\"\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    # Case B: Exponential rate asymmetry\n    params_B = {'A1': 0.05, 'B1': 0.5, 'V1': -20.0, 'k1': 25.0, 'k2': 20.0}\n    def alpha_m_B(V):\n        \"\"\"Transition rate alpha_m for Case B.\"\"\"\n        p = params_B\n        return p['A1'] * np.exp((V - p['V1']) / p['k1'])\n\n    def beta_m_B(V):\n        \"\"\"Transition rate beta_m for Case B.\"\"\"\n        p = params_B\n        return p['B1'] * np.exp(-(V - p['V1']) / p['k2'])\n\n    # Case C: Saturating sigmoidal rates\n    params_C = {'A2': 2.0, 'B2': 1.0, 'V_half': -30.0, 'k': 7.0}\n    def alpha_m_C(V):\n        \"\"\"Transition rate alpha_m for Case C.\"\"\"\n        p = params_C\n        return p['A2'] / (1.0 + np.exp(-(V - p['V_half']) / p['k']))\n\n    def beta_m_C(V):\n        \"\"\"Transition rate beta_m for Case C.\"\"\"\n        p = params_C\n        return p['B2'] / (1.0 + np.exp((V - p['V_half']) / p['k']))\n\n    # Collate the test cases into a list of dictionaries.\n    test_cases = [\n        {'V_range': [-100.0, 50.0], 'alpha': alpha_m_A, 'beta': beta_m_A},\n        {'V_range': [-100.0, 40.0], 'alpha': alpha_m_B, 'beta': beta_m_B},\n        {'V_range': [-80.0, 60.0], 'alpha': alpha_m_C, 'beta': beta_m_C},\n    ]\n\n    results = []\n    # Define the voltage step as per the problem statement.\n    dV = 0.1\n\n    # Loop through each test case to perform the calculation.\n    for case in test_cases:\n        V_min, V_max = case['V_range']\n\n        # Create a numerically stable voltage grid using np.linspace.\n        num_points = int(round((V_max - V_min) / dV)) + 1\n        V_grid = np.linspace(V_min, V_max, num_points)\n\n        # Retrieve the appropriate rate functions for the current case.\n        alpha_func = case['alpha']\n        beta_func = case['beta']\n\n        # Calculate the rate functions over the voltage grid.\n        alpha_V = alpha_func(V_grid)\n        beta_V = beta_func(V_grid)\n\n        # Calculate the activation time constant tau_m(V).\n        tau_m_V = 1.0 / (alpha_V + beta_V)\n\n        # Find the index of the minimum value of tau_m.\n        # np.argmin returns the index of the first occurrence of the minimum value.\n        min_tau_idx = np.argmin(tau_m_V)\n\n        # Find the voltage corresponding to the minimum tau_m.\n        V_at_min_tau = V_grid[min_tau_idx]\n\n        results.append(V_at_min_tau)\n\n    # Format the final output string as specified.\n    # Each voltage must be formatted to three decimal places.\n    output_str = f\"[{','.join(f'{r:.3f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "In modeling spike initiation, a frequent simplification is the quasi-steady-state (QSS) assumption, where activation gates are presumed to track the membrane voltage instantaneously. This advanced practice challenges you to test the validity of this assumption by simulating a fast action potential upstroke . By quantifying the error between the true gating variable, $m(t)$, and its idealized steady-state value, $m_{\\infty}(V(t))$, you will gain critical insight into the role of timescale separation and the conditions under which this powerful simplification fails.",
            "id": "4033030",
            "problem": "You are tasked with evaluating the validity of the quasi-steady-state assumption for the activation gate of a voltage-gated sodium channel during a fast membrane potential upstroke caused by an injected current in a single-compartment neuron model. The goal is to determine whether the activation variable $m(t)$ tracks its steady-state value $m_{\\infty}(V(t))$ closely enough during the upstroke, or whether the assumption fails. The evaluation must be conducted by computing the maximum relative error between $m(t)$ and $m_{\\infty}(V(t))$ over the fast upstroke interval for several parameter sets.\n\nFundamental base:\n- Current balance (single-compartment membrane): $$C \\frac{dV}{dt} = -g_L (V - E_L) - \\overline{g}_{\\mathrm{Na}}\\, m\\, (V - E_{\\mathrm{Na}}) + I_{\\mathrm{ext}}(t),$$ where $V$ is the membrane potential, $m$ is the activation gate variable, $C$ is the capacitance, $g_L$ is the leak conductance, $E_L$ is the leak reversal potential, $\\overline{g}_{\\mathrm{Na}}$ is the maximal sodium conductance, and $E_{\\mathrm{Na}}$ is the sodium reversal potential.\n- Activation gate dynamics: $$\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\tau_m(V)\\, s},$$ where $m_{\\infty}(V)$ is the steady-state activation and $\\tau_m(V)$ is the activation time constant; $s$ is a dimensionless scale factor applied to $\\tau_m(V)$ to vary kinetics across test cases.\n- Steady-state activation is given by a Boltzmann function: $$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k_m}\\right)},$$ where $V_{1/2}$ is the half-activation voltage and $k_m$ is the slope factor (in millivolts).\n- Time constant is voltage dependent: $$\\tau_m(V) = \\tau_0 + \\frac{\\tau_1}{1 + \\exp\\!\\left(\\frac{V - V_t}{k_t}\\right)},$$ with constants $\\tau_0$, $\\tau_1$, $V_t$, and $k_t$ defined below.\n\nDefinitions and acronyms:\n- Ordinary Differential Equation (ODE): a differential equation involving functions and their derivatives with respect to one variable (here, time).\n- Quasi-Steady-State (QSS) assumption: replacing $m(t)$ by $m_{\\infty}(V(t))$ under the assumption that $m$ equilibrates much faster than $V$ changes.\n\nYour algorithm must:\n1. Integrate the coupled ODEs for $V(t)$ and $m(t)$ from $t = 0$ to $t = T_{\\mathrm{end}}$ using an explicit solver with fixed time step.\n2. Use the input current $$I_{\\mathrm{ext}}(t) = \\begin{cases} I_{\\mathrm{amp}}, & t_{\\mathrm{on}} \\le t \\le t_{\\mathrm{off}}, \\\\ 0, & \\text{otherwise}, \\end{cases}$$ with $I_{\\mathrm{amp}}$ specified per test case.\n3. Initialize $V(0) = E_L$ and $m(0) = m_{\\infty}(E_L)$.\n4. Identify the fast upstroke interval as the set of time points where $\\frac{dV}{dt} > D_{\\mathrm{thr}}$, with $D_{\\mathrm{thr}}$ specified below.\n5. Compute the relative error $$r(t) = \\frac{\\left|m(t) - m_{\\infty}(V(t))\\right|}{\\max\\left(m_{\\infty}(V(t)), \\varepsilon\\right)},$$ with $\\varepsilon = 10^{-9}$ (dimensionless) to avoid division by zero when $m_{\\infty}(V(t))$ is close to zero.\n6. Report, for each test case, whether the QSS assumption fails during the fast upstroke, defined by $$\\max_{\\text{upstroke}} r(t) \\ge r_{\\mathrm{crit}},$$ where $r_{\\mathrm{crit}}$ is specified below.\n\nPhysical units and constants (use exactly these values):\n- Capacitance: $C = 1.0$ microfarads per square centimeter ($\\mu\\mathrm{F}/\\mathrm{cm}^2$).\n- Leak conductance: $g_L = 0.1$ millisiemens per square centimeter ($\\mathrm{mS}/\\mathrm{cm}^2$).\n- Leak reversal potential: $E_L = -65$ millivolts ($\\mathrm{mV}$).\n- Sodium maximal conductance: $\\overline{g}_{\\mathrm{Na}} = 30.0$ millisiemens per square centimeter ($\\mathrm{mS}/\\mathrm{cm}^2$).\n- Sodium reversal potential: $E_{\\mathrm{Na}} = 55$ millivolts ($\\mathrm{mV}$).\n- Time-constant parameters: $\\tau_0 = 0.15$ milliseconds ($\\mathrm{ms}$), $\\tau_1 = 0.60$ milliseconds ($\\mathrm{ms}$), $V_t = -25$ millivolts ($\\mathrm{mV}$), $k_t = 15$ millivolts ($\\mathrm{mV}$).\n- Simulation time: $T_{\\mathrm{end}} = 4.0$ milliseconds ($\\mathrm{ms}$), time step $\\Delta t = 0.005$ milliseconds ($\\mathrm{ms}$).\n- Current pulse times: $t_{\\mathrm{on}} = 0.3$ milliseconds ($\\mathrm{ms}$), $t_{\\mathrm{off}} = 1.5$ milliseconds ($\\mathrm{ms}$).\n- Upstroke detection threshold: $D_{\\mathrm{thr}} = 10.0$ millivolts per millisecond ($\\mathrm{mV}/\\mathrm{ms}$).\n- Failure threshold: $r_{\\mathrm{crit}} = 0.2$ (dimensionless).\n\nTest suite:\nEach test case is a tuple $(I_{\\mathrm{amp}}, s, k_m, V_{1/2})$ with units $I_{\\mathrm{amp}}$ in microamperes per square centimeter ($\\mu\\mathrm{A}/\\mathrm{cm}^2$), $s$ dimensionless, $k_m$ and $V_{1/2}$ in millivolts ($\\mathrm{mV}$):\n- Case $1$: $\\left(40.0,\\, 1.0,\\, 6.0,\\, -40.0\\right)$.\n- Case $2$: $\\left(80.0,\\, 3.0,\\, 6.0,\\, -40.0\\right)$.\n- Case $3$: $\\left(20.0,\\, 1.0,\\, 6.0,\\, -40.0\\right)$.\n- Case $4$: $\\left(40.0,\\, 2.0,\\, 3.0,\\, -35.0\\right)$.\n- Case $5$: $\\left(60.0,\\, 0.5,\\, 6.0,\\, -40.0\\right)$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, consisting of Boolean values for each test case in order, where each value is $\\texttt{True}$ if the quasi-steady-state assumption fails and $\\texttt{False}$ otherwise (e.g., $\\left[\\texttt{True},\\texttt{False},\\texttt{False}\\right]$). Express no other text.\n\nConstraints and design for coverage:\n- The test suite includes a typical \"happy path\" (Case $1$), a high-amplitude and slow-gating edge case (Case $2$), a near-threshold current (Case $3$), a steep $m_{\\infty}$ scenario (Case $4$), and a fast-gating scenario (Case $5$).\n- All calculations must be in the units specified above; outputs are dimensionless Boolean values.",
            "solution": "We begin from the single-compartment current balance, which is a standard formulation in the Hodgkin–Huxley (HH) lineage of conductance-based models. The membrane potential $V(t)$ evolves according to $$C \\frac{dV}{dt} = -g_L (V - E_L) - \\overline{g}_{\\mathrm{Na}}\\, m\\, (V - E_{\\mathrm{Na}}) + I_{\\mathrm{ext}}(t),$$ with capacitance $C$ setting the voltage response to net current, and conductances $g_L$ and $\\overline{g}_{\\mathrm{Na}}$ governing passive and sodium currents, respectively. The sodium activation gate $m(t)$ follows first-order kinetics $$\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\tau_m(V)\\, s},$$ where $m_{\\infty}(V)$ is the steady-state value and $\\tau_m(V)$ is the time constant, both derived from empirical voltage-dependent channel behavior.\n\nThe steady-state activation is specified as a Boltzmann function $$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k_m}\\right)},$$ reflecting increased channel opening probability at depolarized voltages. The time constant is $$\\tau_m(V) = \\tau_0 + \\frac{\\tau_1}{1 + \\exp\\!\\left(\\frac{V - V_t}{k_t}\\right)},$$ which yields a physiologically plausible mild voltage dependence. The dimensionless factor $s$ scales $\\tau_m$ to make gating slower ($s > 1$) or faster ($s < 1$), thereby controlling timescale separation relative to voltage changes.\n\nQuasi-steady-state (QSS) and its failure are governed by timescale separation. If $m$ relaxes much faster than $V$ changes, $m(t) \\approx m_{\\infty}(V(t))$ and the QSS assumption holds. To assess failure, consider the error $e(t) = m(t) - m_{\\infty}(V(t))$. Differentiating $e(t)$ and using the chain rule gives\n$$\\frac{de}{dt} = \\frac{dm}{dt} - \\frac{d m_{\\infty}}{dt} = -\\frac{e}{\\tau_m(V)\\, s} - \\frac{d m_{\\infty}}{dV}\\frac{dV}{dt}.$$\nIn a steady regime for $e$, ignoring higher-order transients, the error approximately satisfies\n$$e \\approx -\\tau_m(V)\\, s\\, \\frac{d m_{\\infty}}{dV}\\frac{dV}{dt}.$$\nThus a necessary condition for QSS validity is small $|e|$ relative to $m_{\\infty}$, i.e.,\n$$\\frac{|e|}{m_{\\infty}} \\approx \\frac{\\tau_m(V)\\, s}{m_{\\infty}(V)} \\left|\\frac{d m_{\\infty}}{dV}\\right| \\left|\\frac{dV}{dt}\\right| \\ll 1.$$\nWhen the voltage upstroke is fast (large $\\left|\\frac{dV}{dt}\\right|$) or when gating is slow (large $\\tau_m(V)\\, s$), the relative error grows and QSS fails.\n\nAlgorithmic design to quantify failure:\n1. Numerically integrate the coupled ODEs for $V(t)$ and $m(t)$ from $t = 0$ to $t = T_{\\mathrm{end}}$ using a fixed time step $\\Delta t$. We employ an explicit fourth-order Runge–Kutta method for accuracy and stability while respecting the required libraries.\n2. Use the square-pulse current $$I_{\\mathrm{ext}}(t) = \\begin{cases} I_{\\mathrm{amp}}, & t_{\\mathrm{on}} \\le t \\le t_{\\mathrm{off}}, \\\\ 0, & \\text{otherwise}, \\end{cases}$$ with specified $I_{\\mathrm{amp}}$ per test case. The pulse elicits depolarization; with sufficient amplitude, a rapid upstroke emerges due to positive feedback: depolarization increases $m$, which increases sodium current, further depolarizing $V$.\n3. Initialize $V(0) = E_L$ and $m(0) = m_{\\infty}(E_L)$ to ensure the system starts at leak rest in steady state for the gate variable.\n4. Identify the fast upstroke interval by computing the discrete time derivative $\\frac{dV}{dt} \\approx \\frac{V(t+\\Delta t) - V(t)}{\\Delta t}$ and selecting times where $\\frac{dV}{dt} > D_{\\mathrm{thr}}$, with $D_{\\mathrm{thr}} = 10.0$ $\\mathrm{mV}/\\mathrm{ms}$. If no points exceed $D_{\\mathrm{thr}}$, we relax to $\\frac{dV}{dt} > 0$ to still assess mismatch during rising phases.\n5. Compute the relative error $$r(t) = \\frac{|m(t) - m_{\\infty}(V(t))|}{\\max(m_{\\infty}(V(t)), \\varepsilon)},$$ with $\\varepsilon = 10^{-9}$ to avoid division by zero when $m_{\\infty}$ is near zero at hyperpolarized voltages. Extract the maximum over the upstroke interval: $$r_{\\max} = \\max_{\\text{upstroke}} r(t).$$\n6. Declare QSS failure for the test case if $$r_{\\max} \\ge r_{\\mathrm{crit}},$$ with $r_{\\mathrm{crit}} = 0.2$.\n\nTest suite rationale:\n- Case $1$ with $(I_{\\mathrm{amp}}, s, k_m, V_{1/2}) = (40.0, 1.0, 6.0, -40.0)$ is a typical scenario where gating kinetics are moderately fast and the slope is standard; QSS may hold or marginally fail depending on the upstroke intensity.\n- Case $2$ with $(80.0, 3.0, 6.0, -40.0)$ uses very strong current and slow gating (increased $\\tau_m$ by factor $s = 3.0$), maximizing $\\left|\\frac{dV}{dt}\\right|$ and reducing the tracking ability of $m$, likely failing QSS.\n- Case $3$ with $(20.0, 1.0, 6.0, -40.0)$ produces a near-threshold upstroke with small $\\left|\\frac{dV}{dt}\\right|$, favoring QSS validity.\n- Case $4$ with $(40.0, 2.0, 3.0, -35.0)$ increases steepness of $m_{\\infty}$ via small $k_m$, making $\\left|\\frac{d m_{\\infty}}{dV}\\right|$ large and slowing gating ($s = 2.0$), thereby increasing mismatch and risking QSS failure even with moderate current.\n- Case $5$ with $(60.0, 0.5, 6.0, -40.0)$ uses faster gating ($s = 0.5$) with strong depolarization, designed to reduce mismatch and maintain QSS despite a fast upstroke.\n\nNumerical considerations:\n- The fourth-order Runge–Kutta method provides improved accuracy for both $V(t)$ and $m(t)$ compared to a first-order method, which is important for assessing $r(t)$ under rapid transients.\n- The choice $\\varepsilon = 10^{-9}$ ensures numerical robustness when $m_{\\infty}$ is extremely small without affecting the assessment meaningfully when $m_{\\infty}$ is not near zero.\n- The upstroke threshold $D_{\\mathrm{thr}}$ focuses the error assessment on the most rapid depolarization phase, which is where QSS is most challenged.\n\nThe program outputs a single line of Boolean values for the five cases in order, each indicating whether the quasi-steady-state assumption fails ($\\texttt{True}$) or holds ($\\texttt{False}$), with no additional text. All computations conform to the units specified; the output is dimensionless.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No SciPy is necessary; we implement RK4 manually for clarity and control.\n\ndef m_inf(V, V_half, k_m):\n    # Steady-state activation (Boltzmann)\n    return 1.0 / (1.0 + np.exp(-(V - V_half) / k_m))\n\ndef tau_m(V, tau0, tau1, Vt, kt):\n    # Voltage-dependent time constant\n    return tau0 + tau1 / (1.0 + np.exp((V - Vt) / kt))\n\ndef I_ext(t, amp, t_on, t_off):\n    return amp if (t >= t_on and t <= t_off) else 0.0\n\ndef derivatives(V, m, t, params):\n    # Unpack parameters\n    C = params['C']\n    gL = params['gL']\n    EL = params['EL']\n    gNa = params['gNa']\n    ENa = params['ENa']\n    tau0 = params['tau0']\n    tau1 = params['tau1']\n    Vt = params['Vt']\n    kt = params['kt']\n    V_half = params['V_half']\n    km = params['km']\n    s = params['s']\n    amp = params['I_amp']\n    t_on = params['t_on']\n    t_off = params['t_off']\n    # Compute steady-state variables\n    minf = m_inf(V, V_half, km)\n    taum = tau_m(V, tau0, tau1, Vt, kt) * s\n    # Currents\n    Iinj = I_ext(t, amp, t_on, t_off)\n    # Membrane equation\n    dVdt = (-gL * (V - EL) - gNa * m * (V - ENa) + Iinj) / C\n    # Gate equation\n    dmdt = (minf - m) / taum\n    return dVdt, dmdt\n\ndef rk4_step(V, m, t, dt, params):\n    # 4th order Runge-Kutta step for the coupled system\n    k1_V, k1_m = derivatives(V, m, t, params)\n    k2_V, k2_m = derivatives(V + 0.5*dt*k1_V, m + 0.5*dt*k1_m, t + 0.5*dt, params)\n    k3_V, k3_m = derivatives(V + 0.5*dt*k2_V, m + 0.5*dt*k2_m, t + 0.5*dt, params)\n    k4_V, k4_m = derivatives(V + dt*k3_V, m + dt*k3_m, t + dt, params)\n    V_next = V + (dt/6.0) * (k1_V + 2.0*k2_V + 2.0*k3_V + k4_V)\n    m_next = m + (dt/6.0) * (k1_m + 2.0*k2_m + 2.0*k3_m + k4_m)\n    return V_next, m_next\n\ndef simulate_case(case, constants):\n    # case: (I_amp, s, k_m, V_half)\n    I_amp, s, km, V_half = case\n    # Build parameter dictionary\n    params = {\n        'C': constants['C'],\n        'gL': constants['gL'],\n        'EL': constants['EL'],\n        'gNa': constants['gNa'],\n        'ENa': constants['ENa'],\n        'tau0': constants['tau0'],\n        'tau1': constants['tau1'],\n        'Vt': constants['Vt'],\n        'kt': constants['kt'],\n        't_on': constants['t_on'],\n        't_off': constants['t_off'],\n        'I_amp': I_amp,\n        's': s,\n        'km': km,\n        'V_half': V_half\n    }\n    T_end = constants['T_end']\n    dt = constants['dt']\n    n_steps = int(np.round(T_end / dt))\n    # Initialize arrays\n    V = np.empty(n_steps + 1, dtype=float)\n    m = np.empty(n_steps + 1, dtype=float)\n    t = np.linspace(0.0, T_end, n_steps + 1)\n    # Initial conditions\n    V[0] = constants['EL']\n    m[0] = m_inf(V[0], V_half, km)\n    # Integrate\n    for i in range(n_steps):\n        V[i+1], m[i+1] = rk4_step(V[i], m[i], t[i], dt, params)\n    # Compute upstroke derivative\n    dVdt = np.diff(V) / dt\n    # Upstroke detection: fast upstroke first, else any rising phase\n    D_thr = constants['D_thr']\n    up_idx = np.where(dVdt > D_thr)[0]\n    if up_idx.size == 0:\n        up_idx = np.where(dVdt > 0.0)[0]\n    # Compute relative error over selected indices\n    eps = 1e-9\n    # For each index i in up_idx, consider time i (not i+1)\n    minf_vals = m_inf(V[:-1], V_half, km)\n    rel_err = np.abs(m[:-1] - minf_vals) / np.maximum(minf_vals, eps)\n    if up_idx.size == 0:\n        rmax = float(np.max(rel_err))\n    else:\n        rmax = float(np.max(rel_err[up_idx]))\n    # Determine failure\n    fail = rmax >= constants['r_crit']\n    return fail\n\ndef solve():\n    # Constants per problem statement (units given in problem text)\n    constants = {\n        'C': 1.0,          # uF/cm^2\n        'gL': 0.1,         # mS/cm^2\n        'EL': -65.0,       # mV\n        'gNa': 30.0,       # mS/cm^2\n        'ENa': 55.0,       # mV\n        'tau0': 0.15,      # ms\n        'tau1': 0.60,      # ms\n        'Vt': -25.0,       # mV\n        'kt': 15.0,        # mV\n        'T_end': 4.0,      # ms\n        'dt': 0.005,       # ms\n        't_on': 0.3,       # ms\n        't_off': 1.5,      # ms\n        'D_thr': 10.0,     # mV/ms\n        'r_crit': 0.2      # dimensionless\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (40.0, 1.0, 6.0, -40.0),  # Case 1\n        (80.0, 3.0, 6.0, -40.0),  # Case 2\n        (20.0, 1.0, 6.0, -40.0),  # Case 3\n        (40.0, 2.0, 3.0, -35.0),  # Case 4\n        (60.0, 0.5, 6.0, -40.0)   # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        result = simulate_case(case, constants)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}