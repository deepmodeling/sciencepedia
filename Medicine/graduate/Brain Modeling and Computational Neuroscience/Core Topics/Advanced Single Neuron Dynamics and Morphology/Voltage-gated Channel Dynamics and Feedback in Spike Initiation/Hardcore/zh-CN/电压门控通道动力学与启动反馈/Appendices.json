{
    "hands_on_practices": [
        {
            "introduction": "在深入研究动作电位（即“锋电位”）的复杂动力学之前，我们必须首先理解神经元在静息状态下的基本电学特性。本练习将引导您通过一个简化的单室模型来计算两个核心参数：静息电位 $V_{\\text{rest}}$ 和膜时间常数 $\\tau_{\\text{m}}$。通过求解净离子电流为零时的平衡点，您将掌握决定神经元稳定基线的核心原理，并通过线性化方法理解神经元对微小扰动的响应速度，为后续更复杂的锋电位发放模型打下坚实的理论基础 。",
            "id": "4033019",
            "problem": "考虑一个遵循基尔霍夫电流定律和欧姆定律的单室神经元模型。总离子电流被建模为漏电流、有效阈下快速钠电流和有效阈下延迟整流钾电流之和，每种电流都表示为其电导乘以其驱动力。膜方程为\n$$C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}},$$\n其中离子电流满足\n$$I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}}, \\quad I_{x} = g_{x}\\left(V - E_{x}\\right),$$\n其中 $x \\in \\{\\text{L}, \\text{Na}, \\text{K}\\}$。假设外加电流为零 $I_{\\text{app}} = 0$。将阈下电压门控通道的贡献视为静息电位附近一个窄邻域内的恒定有效电导，以捕捉它们的反馈，而无需显式地对门控动力学进行建模。参数如下：\n- 膜电容 $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$，\n- 漏电导 $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^{2}$ 和反转电位 $E_{\\text{L}} = -70~\\text{mV}$，\n- 有效阈下钠电导 $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^{2}$ 和反转电位 $E_{\\text{Na}} = 60~\\text{mV}$，\n- 有效阈下钾电导 $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^{2}$ 和反转电位 $E_{\\text{K}} = -90~\\text{mV}$。\n\n从以上定义出发，且不使用任何关于不动点或线性化的预先推导的公式，完成以下任务：\n1. 通过求解 $\\frac{dV}{dt} = 0$ 来确定静息电位 $V_{\\text{rest}}$。\n2. 在 $V_{\\text{rest}}$ 附近将膜方程线性化，以获得线性膜时间常数 $\\tau_{\\text{m}}$，其定义为控制小扰动指数弛豫回 $V_{\\text{rest}}$ 的特征时间尺度。\n\n将 $V_{\\text{rest}}$ 以毫伏（mV）表示，$\\tau_{\\text{m}}$ 以毫秒（ms）表示。将两者都四舍五入到四位有效数字。以 $V_{\\text{rest}}$、$\\tau_{\\text{m}}$ 的顺序，将最终答案表示为一个二元行矩阵。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n给定的信息如下：\n-   膜方程：$C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}}$\n-   离子电流：$I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}}$，其中对于 $x \\in \\{\\text{L}, \\text{Na}, \\text{K}\\}$，$I_{x} = g_{x}\\left(V - E_{x}\\right)$。\n-   外加电流：$I_{\\text{app}} = 0$。\n-   假设：电导 $g_{\\text{L}}$、$g_{\\text{Na}}$ 和 $g_{\\text{K}}$ 被视为恒定的有效电导。\n-   参数：\n    -   $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$\n    -   $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{L}} = -70~\\text{mV}$\n    -   $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{Na}} = 60~\\text{mV}$\n    -   $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^{2}$\n    -   $E_{\\text{K}} = -90~\\text{mV}$\n-   要求：\n    1.  通过求解 $\\frac{dV}{dt} = 0$ 来确定静息电位 $V_{\\text{rest}}$。\n    2.  在 $V_{\\text{rest}}$ 附近将方程线性化，以求得膜时间常数 $\\tau_{\\text{m}}$。\n    3.  推导过程不能使用预先推导的公式。\n    4.  $V_{\\text{rest}}$（单位 mV）和 $\\tau_{\\text{m}}$（单位 ms）的最终答案必须四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了一个单室 RC 电路神经元模型，这是计算神经科学中一个基础且科学有效的简化。控制方程基于基尔霍夫电流定律和欧姆定律，这些是物理学的基本原理。参数值具有生物物理学的合理性。\n-   **适定性**：该问题是适定的。它要求解一个一阶线性常微分方程的不动点及其特征时间常数，这两者都是唯一定义且可通过代数求解的任务。\n-   **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。\n-   **完备性与一致性**：所有必要的参数都已提供，且单位一致。$(\\mu\\text{F}/\\text{cm}^2) / (\\text{mS}/\\text{cm}^2) = (10^{-6}~\\text{F}) / (10^{-3}~\\text{S}) = 10^{-3}~\\text{s} = 1~\\text{ms}$，这证实了时间常数的量纲一致性。\n\n### 步骤 3：结论与行动\n该问题具有科学合理性、适定性、客观性和自洽性。因此，它被判定为**有效**。将按要求从第一性原理推导求解。\n\n---\n\n### 解题推导\n\n按要求，分析分两部分进行。\n\n#### 1. 静息电位（$V_{\\text{rest}}$）的确定\n\n静息电位 $V_{\\text{rest}}$ 是指系统处于稳态时的膜电位 $V$，此时跨膜净电流为零，电压不随时间变化。这对应于条件 $\\frac{dV}{dt} = 0$。\n膜方程为：\n$$C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}}$$\n当 $I_{\\text{app}} = 0$ 且 $\\frac{dV}{dt} = 0$ 时，方程简化为：\n$$I_{\\text{ion}} = 0$$\n总离子电流 $I_{\\text{ion}}$ 是单个漏电流、钠电流和钾电流的总和：\n$$I_{\\text{ion}} = I_{\\text{L}} + I_{\\text{Na}} + I_{\\text{K}} = 0$$\n将每个电流的表达式 $I_{x} = g_{x}(V - E_{x})$ 代入方程，得到：\n$$g_{\\text{L}}(V - E_{\\text{L}}) + g_{\\text{Na}}(V - E_{\\text{Na}}) + g_{\\text{K}}(V - E_{\\text{K}}) = 0$$\n在静息电位下，$V = V_{\\text{rest}}$。我们求解上述方程以得到 $V_{\\text{rest}}$：\n$$g_{\\text{L}}(V_{\\text{rest}} - E_{\\text{L}}) + g_{\\text{Na}}(V_{\\text{rest}} - E_{\\text{Na}}) + g_{\\text{K}}(V_{\\text{rest}} - E_{\\text{K}}) = 0$$\n我们重排各项以分离出 $V_{\\text{rest}}$：\n$$g_{\\text{L}}V_{\\text{rest}} - g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}V_{\\text{rest}} - g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}V_{\\text{rest}} - g_{\\text{K}}E_{\\text{K}} = 0$$\n$$(g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}})V_{\\text{rest}} = g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}}$$\n$$V_{\\text{rest}} = \\frac{g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}}}{g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}}}$$\n现在，我们代入给定的数值：\n-   $g_{\\text{L}} = 0.10~\\text{mS}/\\text{cm}^2$, $E_{\\text{L}} = -70~\\text{mV}$\n-   $g_{\\text{Na}} = 0.02~\\text{mS}/\\text{cm}^2$, $E_{\\text{Na}} = 60~\\text{mV}$\n-   $g_{\\text{K}} = 0.08~\\text{mS}/\\text{cm}^2$, $E_{\\text{K}} = -90~\\text{mV}$\n\n分母是总电导 $g_{\\text{total}}$：\n$$g_{\\text{total}} = g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}} = 0.10 + 0.02 + 0.08 = 0.20~\\text{mS}/\\text{cm}^2$$\n分子是：\n$$(0.10)(-70) + (0.02)(60) + (0.08)(-90) = -7.0 + 1.2 - 7.2 = -13.0~\\text{mS} \\cdot \\text{mV} / \\text{cm}^2$$\n因此，静息电位是：\n$$V_{\\text{rest}} = \\frac{-13.0~\\text{mS} \\cdot \\text{mV} / \\text{cm}^2}{0.20~\\text{mS}/\\text{cm}^2} = -65~\\text{mV}$$\n四舍五入到四位有效数字，我们得到 $V_{\\text{rest}} = -65.00~\\text{mV}$。\n\n#### 2. 膜时间常数（$\\tau_{\\text{m}}$）的确定\n\n问题要求在 $V_{\\text{rest}}$ 附近对膜方程进行线性化。该方程为 $C_{\\text{m}} \\frac{dV}{dt} = -I_{\\text{ion}}$。\n我们将 $I_{\\text{ion}}$ 表示为 $V$ 的函数：\n$$I_{\\text{ion}}(V) = g_{\\text{L}}(V - E_{\\text{L}}) + g_{\\text{Na}}(V - E_{\\text{Na}}) + g_{\\text{K}}(V - E_{\\text{K}})$$\n$$I_{\\text{ion}}(V) = (g_{\\text{L}} + g_{\\text{Na}} + g_{\\text{K}}) V - (g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}})$$\n使用总电导 $g_{\\text{total}}$ 的定义和先前推导的 $V_{\\text{rest}}$ 表达式：\n$$g_{\\text{L}}E_{\\text{L}} + g_{\\text{Na}}E_{\\text{Na}} + g_{\\text{K}}E_{\\text{K}} = g_{\\text{total}}V_{\\text{rest}}$$\n将这些代入 $I_{\\text{ion}}(V)$ 的表达式中：\n$$I_{\\text{ion}}(V) = g_{\\text{total}}V - g_{\\text{total}}V_{\\text{rest}} = g_{\\text{total}}(V - V_{\\text{rest}})$$\n膜方程变为：\n$$C_{\\text{m}} \\frac{dV}{dt} = -g_{\\text{total}}(V - V_{\\text{rest}})$$\n该方程已经是线性形式。形式化的线性化过程涉及对右侧项 $f(V) = -I_{\\text{ion}}(V)$ 在 $V = V_{\\text{rest}}$ 附近进行泰勒级数展开：\n$$f(V) \\approx f(V_{\\text{rest}}) + f'(V_{\\text{rest}})(V - V_{\\text{rest}})$$\n我们知道 $f(V_{\\text{rest}}) = -I_{\\text{ion}}(V_{\\text{rest}}) = 0$。其导数为：\n$$f'(V) = \\frac{d}{dV}[-I_{\\text{ion}}(V)] = \\frac{d}{dV}[-g_{\\text{total}}(V - V_{\\text{rest}})] = -g_{\\text{total}}$$\n由于导数是常数，因此 $f'(V_{\\text{rest}}) = -g_{\\text{total}}$。线性化后的方程为：\n$$C_{\\text{m}} \\frac{dV}{dt} = -g_{\\text{total}}(V - V_{\\text{rest}})$$\n这证实了原方程的线性。为了求出时间常数，我们考虑静息电位附近的小扰动 $v(t) = V(t) - V_{\\text{rest}}$。其导数为 $\\frac{dv}{dt} = \\frac{dV}{dt}$。将这些代入方程，得到：\n$$C_{\\text{m}} \\frac{dv}{dt} = -g_{\\text{total}}v$$\n这是指数衰减的方程。我们将其重排为标准形式 $\\tau \\frac{dy}{dt} = -y$：\n$$\\frac{C_{\\text{m}}}{g_{\\text{total}}} \\frac{dv}{dt} = -v$$\n通过与标准形式比较，我们确定膜时间常数 $\\tau_{\\text{m}}$ 为：\n$$\\tau_{\\text{m}} = \\frac{C_{\\text{m}}}{g_{\\text{total}}}$$\n我们代入 $C_{\\text{m}}$ 和 $g_{\\text{total}}$ 的数值：\n-   $C_{\\text{m}} = 1.0~\\mu\\text{F}/\\text{cm}^{2}$\n-   $g_{\\text{total}} = 0.20~\\text{mS}/\\text{cm}^{2}$\n\n$$\\tau_{\\text{m}} = \\frac{1.0~\\mu\\text{F}/\\text{cm}^{2}}{0.20~\\text{mS}/\\text{cm}^{2}} = 5.0~\\frac{\\mu\\text{F}}{\\text{mS}}$$\n为了用标准时间单位表示，我们分析单位：\n$$\\frac{\\mu\\text{F}}{\\text{mS}} = \\frac{10^{-6}~\\text{F}}{10^{-3}~\\text{S}} = 10^{-3}~\\frac{\\text{F}}{\\text{S}}$$\n因为法拉是库仑每伏特（F = C/V），西门子是安培每伏特（S = A/V = (C/s)/V），所以比率 F/S 等效于秒（s）：$\\frac{\\text{F}}{\\text{S}} = \\frac{\\text{C/V}}{(\\text{C/s})/V} = \\text{s}$。\n因此，$\\frac{\\mu\\text{F}}{\\text{mS}}$ 单位是 $10^{-3}$ 秒，即 1 毫秒。\n因此，$\\tau_{\\text{m}} = 5.0~\\text{ms}$。\n四舍五入到四位有效数字，我们得到 $\\tau_{\\text{m}} = 5.000~\\text{ms}$。\n\n最终结果是 $V_{\\text{rest}} = -65.00~\\text{mV}$ 和 $\\tau_{\\text{m}} = 5.000~\\text{ms}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-65.00  5.000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "神经元的兴奋性源于其膜上电压门控离子通道的精妙动力学。这些通道的开放与关闭速率随膜电位变化，从而驱动了锋电位的产生。本练习将带您深入通道门控动力学的核心，通过第一性原理推导并数值计算两个关键函数：稳态激活曲线 $m_{\\infty}(V)$ 和激活时间常数 $\\tau_m(V)$。通过分析不同生理模型下的这些函数，您将学会如何量化通道的行为，并理解通道动力学如何塑造神经元的响应特性 。",
            "id": "4032992",
            "problem": "考虑一个电压门控通道的激活门控变量，记为 $m(t;V)$，其演化遵循由膜电压 $V$ 驱动的一阶双态动力学。其动力学由以下常微分方程给出\n$$\n\\frac{dm}{dt} = \\alpha_m(V)\\,\\bigl(1 - m\\bigr) - \\beta_m(V)\\,m,\n$$\n其中，$t$ 是时间，单位为毫秒 (ms)；$V$ 是电压，单位为毫伏 (mV)；$\\alpha_m(V)$ 和 $\\beta_m(V)$ 是电压依赖的转换速率，单位为 $\\mathrm{ms}^{-1}$，分别控制着进入和离开激活态的转换。假设门控过程是无记忆的 (马尔可夫过程)，并且对于固定的电压 $V$，系统会以指数方式趋近于一个唯一的稳态。你的任务是，对于下面指定的每个测试用例，从第一性原理出发确定：(i) 稳态激活 $m_{\\infty}(V)$ 和 (ii) 激活时间常数 $\\tau_m(V)$（两者都作为电压的函数），然后，在所提供的电压范围内，找出使 $\\tau_m(V)$ 最小的电压（即激活动力学最快时的电压）。所有电压均以毫伏 (mV) 为单位，时间以毫秒 (ms) 为单位。角度单位不适用。最终的数值输出必须四舍五入到三位小数。\n\n在计算时，应将 $m_{\\infty}(V)$ 和 $\\tau_m(V)$ 视为仅由速率函数 $\\alpha_m(V)$ 和 $\\beta_m(V)$ 以及上述控制方程确定的函数，不得假定任何预先指定的简化公式。在提供的电压范围内，以 $\\Delta V = 0.1\\,\\mathrm{mV}$ 的步长，在离散的电压点上数值计算 $m_{\\infty}(V)$ 和 $\\tau_m(V)$。\n\n测试套件：\n- 用例 A (Hodgkin–Huxley 型钠离子激活速率；Hodgkin–Huxley (HH) 是一种经典的基于电导的神经元模型)：\n  - 电压范围：$V \\in [-100, 50]\\,\\mathrm{mV}$。\n  - $\\alpha_m(V) = 0.1 \\cdot \\dfrac{V + 40}{1 - \\exp\\!\\bigl(-\\dfrac{V + 40}{10}\\bigr)}$，单位为 $\\mathrm{ms}^{-1}$。\n  - $\\beta_m(V) = 4 \\cdot \\exp\\!\\bigl(-\\dfrac{V + 65}{18}\\bigr)$，单位为 $\\mathrm{ms}^{-1}$。\n  - 为了数值稳定性，在 $\\alpha_m(V)$ 的分母趋近于零的点附近，应使用基于该点级数展开的良态极限值，以避免除零错误。\n- 用例 B (具有内部极值的指数速率不对称)：\n  - 电压范围：$V \\in [-100, 40]\\,\\mathrm{mV}$。\n  - 参数：$A_1 = 0.05\\,\\mathrm{ms}^{-1}$，$B_1 = 0.5\\,\\mathrm{ms}^{-1}$，$V_1 = -20\\,\\mathrm{mV}$，$k_1 = 25\\,\\mathrm{mV}$，$k_2 = 20\\,\\mathrm{mV}$。\n  - $\\alpha_m(V) = A_1 \\cdot \\exp\\!\\Bigl(\\dfrac{V - V_1}{k_1}\\Bigr)$，单位为 $\\mathrm{ms}^{-1}$。\n  - $\\beta_m(V) = B_1 \\cdot \\exp\\!\\Bigl(-\\dfrac{V - V_1}{k_2}\\Bigr)$，单位为 $\\mathrm{ms}^{-1}$。\n- 用例 C (具有边界极值的饱和S型速率)：\n  - 电压范围：$V \\in [-80, 60]\\,\\mathrm{mV}$。\n  - 参数：$A_2 = 2.0\\,\\mathrm{ms}^{-1}$，$B_2 = 1.0\\,\\mathrm{ms}^{-1}$，$V_{\\mathrm{half}} = -30\\,\\mathrm{mV}$，$k = 7\\,\\mathrm{mV}$。\n  - $\\alpha_m(V) = \\dfrac{A_2}{1 + \\exp\\!\\Bigl(-\\dfrac{V - V_{\\mathrm{half}}}{k}\\Bigr)}$，单位为 $\\mathrm{ms}^{-1}$。\n  - $\\beta_m(V) = \\dfrac{B_2}{1 + \\exp\\!\\Bigl(\\dfrac{V - V_{\\mathrm{half}}}{k}\\Bigr)}$，单位为 $\\mathrm{ms}^{-1}$。\n\n算法要求：\n- 对于每个测试用例，在指定的电压网格上评估 $\\alpha_m(V)$ 和 $\\beta_m(V)$。\n- 根据控制微分方程，确定每个网格电压下的 $m_{\\infty}(V)$ 和 $\\tau_m(V)$。\n- 在网格内找出使 $\\tau_m(V)$ 最小的电压。如果在数值精度范围内多个网格点共享此最小值，则返回其中最小的电压。\n- 将报告的电压四舍五入到三位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含三个测试用例中使 $\\tau_m(V)$ 最小的电压值，格式为方括号内以逗号分隔的列表，例如 $[v_A,v_B,v_C]$，其中每个条目均以 $\\mathrm{mV}$ 为单位，并四舍五入到三位小数。",
            "solution": "该问题要求确定一个电压门控离子通道的稳态激活 $m_{\\infty}(V)$ 和激活时间常数 $\\tau_m(V)$，该通道的门控变量 $m$ 遵循一阶动力学。我们还被要求针对三组不同的电压依赖速率函数，找出使 $\\tau_m(V)$ 最小的电压。\n\n在恒定膜电压 $V$ 下，激活变量 $m(t)$ 的控制常微分方程 (ODE) 如下：\n$$\n\\frac{dm}{dt} = \\alpha_m(V) \\bigl(1 - m\\bigr) - \\beta_m(V) m\n$$\n其中 $\\alpha_m(V)$ 和 $\\beta_m(V)$ 分别是正向和反向转换速率，单位为 $\\mathrm{ms}^{-1}$。\n\n_稳态激活 $m_{\\infty}(V)$ 的推导_\n\n系统的稳态定义为门控变量不再随时间变化时的状态，即 $\\frac{dm}{dt} = 0$。设 $m_{\\infty}$ 表示稳态时的 $m$ 值。将此条件代入控制ODE，我们得到：\n$$\n0 = \\alpha_m(V) \\bigl(1 - m_{\\infty}\\bigr) - \\beta_m(V) m_{\\infty}\n$$\n为了求解 $m_{\\infty}(V)$，我们重排各项：\n$$\n\\alpha_m(V) - \\alpha_m(V) m_{\\infty} = \\beta_m(V) m_{\\infty}\n$$\n$$\n\\alpha_m(V) = m_{\\infty} \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)\n$$\n分离出 $m_{\\infty}(V)$，得到稳态激活作为电压函数的表达式：\n$$\nm_{\\infty}(V) = \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)}\n$$\n\n_激活时间常数 $\\tau_m(V)$ 的推导_\n\n时间常数 $\\tau_m(V)$ 表征了 $m(t)$ 趋近其稳态值 $m_{\\infty}(V)$ 的速率。为了推导 $\\tau_m(V)$，我们将原始ODE重排为指数松弛的标准形式 $\\frac{dy}{dt} = \\frac{y_{\\infty} - y}{\\tau}$。\n\n从ODE出发：\n$$\n\\frac{dm}{dt} = \\alpha_m(V) - \\alpha_m(V) m - \\beta_m(V) m\n$$\n将包含 $m$ 的项组合在一起：\n$$\n\\frac{dm}{dt} = \\alpha_m(V) - m \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)\n$$\n从右侧提出公因子 $\\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr)$，以揭示与 $m_{\\infty}(V)$ 相关的结构：\n$$\n\\frac{dm}{dt} = \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr) \\left( \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)} - m \\right)\n$$\n识别出括号中的项即为 $m_{\\infty}(V)$，我们有：\n$$\n\\frac{dm}{dt} = \\bigl(\\alpha_m(V) + \\beta_m(V)\\bigr) \\bigl(m_{\\infty}(V) - m\\bigr)\n$$\n此方程可以改写为：\n$$\n\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\frac{1}{\\alpha_m(V) + \\beta_m(V)}}\n$$\n通过将其与标准形式 $\\frac{dm}{dt} = \\frac{m_{\\infty} - m}{\\tau_m}$ 进行比较，我们确定激活时间常数为：\n$$\n\\tau_m(V) = \\frac{1}{\\alpha_m(V) + \\beta_m(V)}\n$$\n\n_数值计算步骤_\n\n在建立了 $m_{\\infty}(V)$ 和 $\\tau_m(V)$ 的解析表达式之后，接下来的任务是为每个测试用例找到使 $\\tau_m(V)$ 最小的电压。步骤如下：\n1.  对每个测试用例，在指定范围内定义一个步长为 $\\Delta V = 0.1\\,\\mathrm{mV}$ 的离散电压网格 $V$。\n2.  对于网格中的每个电压 $V_i$，计算速率函数 $\\alpha_m(V_i)$ 和 $\\beta_m(V_i)$ 的值。\n3.  对于用例 A，函数 $\\alpha_m(V) = 0.1 \\cdot \\frac{V + 40}{1 - \\exp(-\\frac{V + 40}{10})}$ 在 $V = -40\\,\\mathrm{mV}$ 处有一个可去奇点。该点的极限可通过洛必达法则求得。令 $x = V + 40$，并考虑当 $x \\to 0$ 时分数的极限：\n    $$\n    \\lim_{x \\to 0} \\frac{x}{1 - \\exp(-x/10)} = \\lim_{x \\to 0} \\frac{\\frac{d}{dx}(x)}{\\frac{d}{dx}\\bigl(1 - \\exp(-x/10)\\bigr)} = \\lim_{x \\to 0} \\frac{1}{\\frac{1}{10}\\exp(-x/10)} = 10\n    $$\n    因此，$\\alpha_m(-40) = 0.1 \\times 10 = 1.0\\,\\mathrm{ms}^{-1}$。为了数值稳定性，必须使用此极限值。\n4.  使用推导出的公式 $\\tau_m(V_i) = \\bigl(\\alpha_m(V_i) + \\beta_m(V_i)\\bigr)^{-1}$ 计算每个网格点的时间常数 $\\tau_m(V_i)$。\n5.  在生成的 $\\tau_m$ 值数组中搜索最小值。\n6.  对应于该最小值首次出现的电压 $V_i$ 即为所求结果。搜索算法会返回遇到的第一个最小值的索引，从而保证了这一点。最终的电压值将被四舍五入到三位小数。\n\n对三个测试用例（A、B 和 C）中的每一个都执行此程序，以获得最终的电压集合。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the voltage at which the activation time constant tau_m is minimal\n    for three different models of voltage-gated ion channels.\n    \"\"\"\n\n    # Define the rate functions for each test case.\n    # These functions are designed to operate on NumPy arrays (vectorized).\n\n    # Case A: Hodgkin-Huxley-type sodium activation\n    def alpha_m_A(V):\n        \"\"\"\n        Transition rate alpha_m for Case A. Handles the singularity at V = -40 mV.\n        \"\"\"\n        arg = V + 40.0\n        # The expression has a 0/0 form at V = -40 mV (arg = 0).\n        # The limit of arg / (1 - exp(-arg/10)) as arg -> 0 is 10, by L'Hopital's rule.\n        # So, the limit of alpha_m is 0.1 * 10 = 1.0.\n        return np.where(np.isclose(arg, 0.0),\n                        1.0,\n                        0.1 * arg / (1.0 - np.exp(-arg / 10.0)))\n\n    def beta_m_A(V):\n        \"\"\"Transition rate beta_m for Case A.\"\"\"\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    # Case B: Exponential rate asymmetry\n    params_B = {'A1': 0.05, 'B1': 0.5, 'V1': -20.0, 'k1': 25.0, 'k2': 20.0}\n    def alpha_m_B(V):\n        \"\"\"Transition rate alpha_m for Case B.\"\"\"\n        p = params_B\n        return p['A1'] * np.exp((V - p['V1']) / p['k1'])\n\n    def beta_m_B(V):\n        \"\"\"Transition rate beta_m for Case B.\"\"\"\n        p = params_B\n        return p['B1'] * np.exp(-(V - p['V1']) / p['k2'])\n\n    # Case C: Saturating sigmoidal rates\n    params_C = {'A2': 2.0, 'B2': 1.0, 'V_half': -30.0, 'k': 7.0}\n    def alpha_m_C(V):\n        \"\"\"Transition rate alpha_m for Case C.\"\"\"\n        p = params_C\n        return p['A2'] / (1.0 + np.exp(-(V - p['V_half']) / p['k']))\n\n    def beta_m_C(V):\n        \"\"\"Transition rate beta_m for Case C.\"\"\"\n        p = params_C\n        return p['B2'] / (1.0 + np.exp((V - p['V_half']) / p['k']))\n\n    # Collate the test cases into a list of dictionaries.\n    test_cases = [\n        {'V_range': [-100.0, 50.0], 'alpha': alpha_m_A, 'beta': beta_m_A},\n        {'V_range': [-100.0, 40.0], 'alpha': alpha_m_B, 'beta': beta_m_B},\n        {'V_range': [-80.0, 60.0], 'alpha': alpha_m_C, 'beta': beta_m_C},\n    ]\n\n    results = []\n    # Define the voltage step as per the problem statement.\n    dV = 0.1\n\n    # Loop through each test case to perform the calculation.\n    for case in test_cases:\n        V_min, V_max = case['V_range']\n\n        # Create a numerically stable voltage grid using np.linspace.\n        num_points = int(round((V_max - V_min) / dV)) + 1\n        V_grid = np.linspace(V_min, V_max, num_points)\n\n        # Retrieve the appropriate rate functions for the current case.\n        alpha_func = case['alpha']\n        beta_func = case['beta']\n\n        # Calculate the rate functions over the voltage grid.\n        alpha_V = alpha_func(V_grid)\n        beta_V = beta_func(V_grid)\n\n        # Calculate the activation time constant tau_m(V).\n        tau_m_V = 1.0 / (alpha_V + beta_V)\n\n        # Find the index of the minimum value of tau_m.\n        # np.argmin returns the index of the first occurrence of the minimum value.\n        min_tau_idx = np.argmin(tau_m_V)\n\n        # Find the voltage corresponding to the minimum tau_m.\n        V_at_min_tau = V_grid[min_tau_idx]\n\n        results.append(V_at_min_tau)\n\n    # Format the final output string as specified.\n    # Each voltage must be formatted to three decimal places.\n    output_str = f\"[{','.join(f'{r:.3f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在构建神经元模型时，为了简化复杂的动力学系统，研究者常常采用“准稳态（Quasi-Steady-State, QSS）”假设，即认为门控变量的变化速度远快于膜电位，因此可以用其稳态值 $m_{\\infty}(V(t))$ 近似瞬时值 $m(t)$。然而，这一假设在快速的锋电位产生过程中是否成立？本练习将指导您通过数值模拟，量化在锋电位快速上升期间门控变量的实际轨迹与其稳态目标之间的误差，从而亲手检验QSS假设的有效边界。掌握这一技能对于评估和选择不同复杂度的神经元模型至关重要 。",
            "id": "4033030",
            "problem": "您的任务是评估在一个单室神经元模型中，由注入电流引起的快速膜电位上升期间，电压门控钠通道激活门的准稳态假设的有效性。目标是确定在上升过程中，激活变量 $m(t)$ 是否能足够紧密地跟踪其稳态值 $m_{\\infty}(V(t))$，或者该假设是否失效。评估必须通过计算在快速上升区间内，$m(t)$ 和 $m_{\\infty}(V(t))$ 之间的最大相对误差来进行，并针对几组参数集进行。\n\n基本原理：\n- 电流平衡（单室膜）：$$C \\frac{dV}{dt} = -g_L (V - E_L) - \\overline{g}_{\\mathrm{Na}}\\, m\\, (V - E_{\\mathrm{Na}}) + I_{\\mathrm{ext}}(t),$$ 其中 $V$ 是膜电位，$m$ 是激活门变量，$C$ 是电容，$g_L$ 是漏电导，$E_L$ 是漏反转电位，$\\overline{g}_{\\mathrm{Na}}$ 是最大钠电导，$E_{\\mathrm{Na}}$ 是钠反转电位。\n- 激活门动力学：$$\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\tau_m(V)\\, s},$$ 其中 $m_{\\infty}(V)$ 是稳态激活，$\\tau_m(V)$ 是激活时间常数；$s$ 是一个无量纲比例因子，应用于 $\\tau_m(V)$ 以在不同测试用例中改变动力学。\n- 稳态激活由玻尔兹曼函数给出：$$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k_m}\\right)},$$ 其中 $V_{1/2}$ 是半激活电压，$k_m$ 是斜率因子（单位为毫伏）。\n- 时间常数是电压依赖的：$$\\tau_m(V) = \\tau_0 + \\frac{\\tau_1}{1 + \\exp\\!\\left(\\frac{V - V_t}{k_t}\\right)},$$ 其中的常数 $\\tau_0$、$\\tau_1$、$V_t$ 和 $k_t$ 在下面定义。\n\n定义和缩写：\n- 常微分方程 (ODE)：一种涉及函数及其关于单个变量（此处为时间）的导数的微分方程。\n- 准稳态 (QSS) 假设：在 $m$ 的平衡速度远快于 $V$ 的变化速度的假设下，用 $m_{\\infty}(V(t))$ 替代 $m(t)$。\n\n您的算法必须：\n1. 使用具有固定时间步长的显式求解器，对 $V(t)$ 和 $m(t)$ 的耦合常微分方程进行从 $t = 0$ 到 $t = T_{\\mathrm{end}}$ 的积分。\n2. 使用输入电流 $$I_{\\mathrm{ext}}(t) = \\begin{cases} I_{\\mathrm{amp}},  t_{\\mathrm{on}} \\le t \\le t_{\\mathrm{off}}, \\\\ 0,  \\text{otherwise}, \\end{cases}$$ 其中 $I_{\\mathrm{amp}}$ 按每个测试用例指定。\n3. 初始化 $V(0) = E_L$ 和 $m(0) = m_{\\infty}(E_L)$。\n4. 将快速上升区间定义为 $\\frac{dV}{dt}  D_{\\mathrm{thr}}$ 的时间点集合，其中 $D_{\\mathrm{thr}}$ 在下面指定。\n5. 计算相对误差 $$r(t) = \\frac{\\left|m(t) - m_{\\infty}(V(t))\\right|}{\\max\\left(m_{\\infty}(V(t)), \\varepsilon\\right)},$$ 其中 $\\varepsilon = 10^{-9}$（无量纲）以避免在 $m_{\\infty}(V(t))$ 接近于零时出现除以零的情况。\n6. 对于每个测试用例，报告 QSS 假设在快速上升期间是否失效，失效定义为 $$\\max_{\\text{upstroke}} r(t) \\ge r_{\\mathrm{crit}},$$ 其中 $r_{\\mathrm{crit}}$ 在下面指定。\n\n物理单位和常数（请精确使用以下值）：\n- 电容：$C = 1.0$ 微法拉每平方厘米 ($\\mu\\mathrm{F}/\\mathrm{cm}^2$)。\n- 漏电导：$g_L = 0.1$ 毫西门子每平方厘米 ($\\mathrm{mS}/\\mathrm{cm}^2$)。\n- 漏反转电位：$E_L = -65$ 毫伏 ($\\mathrm{mV}$)。\n- 最大钠电导：$\\overline{g}_{\\mathrm{Na}} = 30.0$ 毫西门子每平方厘米 ($\\mathrm{mS}/\\mathrm{cm}^2$)。\n- 钠反转电位：$E_{\\mathrm{Na}} = 55$ 毫伏 ($\\mathrm{mV}$)。\n- 时间常数参数：$\\tau_0 = 0.15$ 毫秒 ($\\mathrm{ms}$)，$\\tau_1 = 0.60$ 毫秒 ($\\mathrm{ms}$)，$V_t = -25$ 毫伏 ($\\mathrm{mV}$)，$k_t = 15$ 毫伏 ($\\mathrm{mV}$)。\n- 仿真时间：$T_{\\mathrm{end}} = 4.0$ 毫秒 ($\\mathrm{ms}$)，时间步长 $\\Delta t = 0.005$ 毫秒 ($\\mathrm{ms}$)。\n- 电流脉冲时间：$t_{\\mathrm{on}} = 0.3$ 毫秒 ($\\mathrm{ms}$)，$t_{\\mathrm{off}} = 1.5$ 毫秒 ($\\mathrm{ms}$)。\n- 上升检测阈值：$D_{\\mathrm{thr}} = 10.0$ 毫伏每毫秒 ($\\mathrm{mV}/\\mathrm{ms}$)。\n- 失效阈值：$r_{\\mathrm{crit}} = 0.2$ (无量纲)。\n\n测试套件：\n每个测试用例是一个元组 $(I_{\\mathrm{amp}}, s, k_m, V_{1/2})$，其中 $I_{\\mathrm{amp}}$ 的单位是微安每平方厘米 ($\\mu\\mathrm{A}/\\mathrm{cm}^2$)，$s$ 无量纲，$k_m$ 和 $V_{1/2}$ 的单位是毫伏 ($\\mathrm{mV}$)：\n- 案例 $1$：$\\left(40.0,\\, 1.0,\\, 6.0,\\, -40.0\\right)$。\n- 案例 $2$：$\\left(80.0,\\, 3.0,\\, 6.0,\\, -40.0\\right)$。\n- 案例 $3$：$\\left(20.0,\\, 1.0,\\, 6.0,\\, -40.0\\right)$。\n- 案例 $4$：$\\left(40.0,\\, 2.0,\\, 3.0,\\, -35.0\\right)$。\n- 案例 $5$：$\\left(60.0,\\, 0.5,\\, 6.0,\\, -40.0\\right)$。\n\n要求的最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表由每个测试用例的布尔值按顺序组成，如果准稳态假设失效，则值为 $\\texttt{True}$，否则为 $\\texttt{False}$（例如，$\\left[\\texttt{True},\\texttt{False},\\texttt{False}\\right]$）。不要输出任何其他文本。\n\n约束和覆盖设计：\n- 测试套件包括一个典型的“理想路径”（案例1），一个高振幅和慢门控的边缘案例（案例2），一个近阈值电流（案例3），一个陡峭的 $m_{\\infty}$ 场景（案例4），以及一个快门控场景（案例5）。\n- 所有计算都必须使用上述指定的单位；输出为无量纲的布尔值。",
            "solution": "我们从单室电流平衡方程开始，这是 Hodgkin–Huxley (HH) 系列电导模型中的一个标准公式。膜电位 $V(t)$ 根据以下公式演化：$$C \\frac{dV}{dt} = -g_L (V - E_L) - \\overline{g}_{\\mathrm{Na}}\\, m\\, (V - E_{\\mathrm{Na}}) + I_{\\mathrm{ext}}(t),$$ 其中电容 $C$ 设定了对净电流的电压响应，而电导 $g_L$ 和 $\\overline{g}_{\\mathrm{Na}}$ 分别控制漏电流和钠电流。钠激活门 $m(t)$ 遵循一级动力学：$$\\frac{dm}{dt} = \\frac{m_{\\infty}(V) - m}{\\tau_m(V)\\, s},$$ 其中 $m_{\\infty}(V)$ 是稳态值，$\\tau_m(V)$ 是时间常数，两者都源自经验性的电压依赖性通道行为。\n\n稳态激活被指定为玻尔兹曼函数：$$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\!\\left(-\\frac{V - V_{1/2}}{k_m}\\right)},$$ 这反映了在去极化电压下通道开放概率的增加。时间常数是：$$\\tau_m(V) = \\tau_0 + \\frac{\\tau_1}{1 + \\exp\\!\\left(\\frac{V - V_t}{k_t}\\right)},$$ 这产生了一个生理学上合理的温和电压依赖性。无量纲因子 $s$ 缩放 $\\tau_m$ 以使门控变慢（$s  1$）或变快（$s  1$），从而控制相对于电压变化的时间尺度分离。\n\n准稳态 (QSS) 及其失效是由时间尺度分离所决定的。如果 $m$ 的弛豫速度远快于 $V$ 的变化速度，则 $m(t) \\approx m_{\\infty}(V(t))$，QSS 假设成立。为了评估失效，我们考虑误差 $e(t) = m(t) - m_{\\infty}(V(t))$。对 $e(t)$ 求导并使用链式法则可得\n$$\\frac{de}{dt} = \\frac{dm}{dt} - \\frac{d m_{\\infty}}{dt} = -\\frac{e}{\\tau_m(V)\\, s} - \\frac{d m_{\\infty}}{dV}\\frac{dV}{dt}.$$\n在 $e$ 的稳态下，忽略高阶瞬变，误差近似满足\n$$e \\approx -\\tau_m(V)\\, s\\, \\frac{d m_{\\infty}}{dV}\\frac{dV}{dt}.$$\n因此，QSS 有效性的一个必要条件是 $|e|$ 相对于 $m_{\\infty}$ 很小，即，\n$$\\frac{|e|}{m_{\\infty}} \\approx \\frac{\\tau_m(V)\\, s}{m_{\\infty}(V)} \\left|\\frac{d m_{\\infty}}{dV}\\right| \\left|\\frac{dV}{dt}\\right| \\ll 1.$$\n当电压上升很快（大的 $\\left|\\frac{dV}{dt}\\right|$）或门控很慢（大的 $\\tau_m(V)\\, s$）时，相对误差会增大，QSS 假设失效。\n\n量化失效的算法设计：\n1. 使用固定的时间步长 $\\Delta t$，对 $V(t)$ 和 $m(t)$ 的耦合常微分方程进行从 $t = 0$ 到 $t = T_{\\mathrm{end}}$ 的数值积分。我们采用显式四阶龙格-库塔方法以保证精度和稳定性，同时遵守所需的库要求。\n2. 使用方波脉冲电流 $$I_{\\mathrm{ext}}(t) = \\begin{cases} I_{\\mathrm{amp}},  t_{\\mathrm{on}} \\le t \\le t_{\\mathrm{off}}, \\\\ 0,  \\text{otherwise}, \\end{cases}$$ 其中 $I_{\\mathrm{amp}}$ 按每个测试用例指定。该脉冲引起去极化；在足够大的振幅下，由于正反馈，会出现快速上升：去极化增加了 $m$，这又增加了钠电流，进一步使 $V$ 去极化。\n3. 初始化 $V(0) = E_L$ 和 $m(0) = m_{\\infty}(E_L)$，以确保系统在漏静息电位下启动，且门变量处于稳态。\n4. 通过计算离散时间导数 $\\frac{dV}{dt} \\approx \\frac{V(t+\\Delta t) - V(t)}{\\Delta t}$ 并选择 $\\frac{dV}{dt}  D_{\\mathrm{thr}}$ 的时间点来识别快速上升区间，其中 $D_{\\mathrm{thr}} = 10.0$ $\\mathrm{mV}/\\mathrm{ms}$。如果没有点超过 $D_{\\mathrm{thr}}$，我们放宽到 $\\frac{dV}{dt}  0$ 来评估上升阶段的失配情况。\n5. 计算相对误差 $$r(t) = \\frac{|m(t) - m_{\\infty}(V(t))|}{\\max(m_{\\infty}(V(t)), \\varepsilon)},$$ 其中 $\\varepsilon = 10^{-9}$ 以避免在超极化电压下当 $m_{\\infty}$ 接近于零时出现除以零的情况。提取上升区间的最大值：$$r_{\\max} = \\max_{\\text{upstroke}} r(t).$$\n6. 如果测试用例满足 $$r_{\\max} \\ge r_{\\mathrm{crit}},$$ 则声明 QSS 失效，其中 $r_{\\mathrm{crit}} = 0.2$。\n\n测试套件基本原理：\n- 案例1，参数为 $(I_{\\mathrm{amp}}, s, k_m, V_{1/2}) = (40.0, 1.0, 6.0, -40.0)$，是一个典型场景，其中门控动力学速度适中，斜率是标准的；QSS 可能成立或根据上升强度勉强失效。\n- 案例2，参数为 $(80.0, 3.0, 6.0, -40.0)$，使用非常强的电流和慢门控（通过因子 $s=3.0$ 增加 $\\tau_m$），这会最大化 $\\left|\\frac{dV}{dt}\\right|$ 并降低 $m$ 的跟踪能力，很可能导致 QSS 失效。\n- 案例3，参数为 $(20.0, 1.0, 6.0, -40.0)$，产生一个近阈值的上升，其 $\\left|\\frac{dV}{dt}\\right|$ 很小，有利于 QSS 的有效性。\n- 案例4，参数为 $(40.0, 2.0, 3.0, -35.0)$，通过小的 $k_m$ 增加了 $m_{\\infty}$ 的陡峭度，使得 $\\left|\\frac{d m_{\\infty}}{dV}\\right|$ 变大，并减慢了门控（$s=2.0$），从而增加了失配，即使在中等电流下也有 QSS 失效的风险。\n- 案例5，参数为 $(60.0, 0.5, 6.0, -40.0)$，使用更快的门控（$s=0.5$）和强去极化，旨在减少失配并在快速上升的情况下维持 QSS。\n\n数值考量：\n- 与一阶方法相比，四阶龙格-库塔方法为 $V(t)$ 和 $m(t)$ 提供了更高的精度，这对于在快速瞬变下评估 $r(t)$ 非常重要。\n- 选择 $\\varepsilon = 10^{-9}$ 可以在 $m_{\\infty}$ 极小时确保数值鲁棒性，而当 $m_{\\infty}$ 不接近零时，不会对评估产生有意义的影响。\n- 上升阈值 $D_{\\mathrm{thr}}$ 将误差评估集中在最快速的去极化阶段，这是 QSS 受到最大挑战的地方。\n\n程序为五个案例按顺序输出一行布尔值，每个值指示准稳态假设是失效（$\\texttt{True}$）还是成立（$\\texttt{False}$），不包含任何附加文本。所有计算均符合指定的单位；输出是无量纲的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No SciPy is necessary; we implement RK4 manually for clarity and control.\n\ndef m_inf(V, V_half, k_m):\n    # Steady-state activation (Boltzmann)\n    return 1.0 / (1.0 + np.exp(-(V - V_half) / k_m))\n\ndef tau_m(V, tau0, tau1, Vt, kt):\n    # Voltage-dependent time constant\n    return tau0 + tau1 / (1.0 + np.exp((V - Vt) / kt))\n\ndef I_ext(t, amp, t_on, t_off):\n    return amp if t_on = t = t_off else 0.0\n\ndef derivatives(V, m, t, params):\n    # Unpack parameters\n    C = params['C']\n    gL = params['gL']\n    EL = params['EL']\n    gNa = params['gNa']\n    ENa = params['ENa']\n    tau0 = params['tau0']\n    tau1 = params['tau1']\n    Vt = params['Vt']\n    kt = params['kt']\n    V_half = params['V_half']\n    km = params['km']\n    s = params['s']\n    amp = params['I_amp']\n    t_on = params['t_on']\n    t_off = params['t_off']\n    # Compute steady-state variables\n    minf = m_inf(V, V_half, km)\n    taum = tau_m(V, tau0, tau1, Vt, kt) * s\n    # Currents\n    Iinj = I_ext(t, amp, t_on, t_off)\n    # Membrane equation\n    dVdt = (-gL * (V - EL) - gNa * m * (V - ENa) + Iinj) / C\n    # Gate equation\n    dmdt = (minf - m) / taum\n    return dVdt, dmdt\n\ndef rk4_step(V, m, t, dt, params):\n    # 4th order Runge-Kutta step for the coupled system\n    k1_V, k1_m = derivatives(V, m, t, params)\n    k2_V, k2_m = derivatives(V + 0.5*dt*k1_V, m + 0.5*dt*k1_m, t + 0.5*dt, params)\n    k3_V, k3_m = derivatives(V + 0.5*dt*k2_V, m + 0.5*dt*k2_m, t + 0.5*dt, params)\n    k4_V, k4_m = derivatives(V + dt*k3_V, m + dt*k3_m, t + dt, params)\n    V_next = V + (dt/6.0) * (k1_V + 2.0*k2_V + 2.0*k3_V + k4_V)\n    m_next = m + (dt/6.0) * (k1_m + 2.0*k2_m + 2.0*k3_m + k4_m)\n    return V_next, m_next\n\ndef simulate_case(case, constants):\n    # case: (I_amp, s, k_m, V_half)\n    I_amp, s, km, V_half = case\n    # Build parameter dictionary\n    params = {\n        'C': constants['C'],\n        'gL': constants['gL'],\n        'EL': constants['EL'],\n        'gNa': constants['gNa'],\n        'ENa': constants['ENa'],\n        'tau0': constants['tau0'],\n        'tau1': constants['tau1'],\n        'Vt': constants['Vt'],\n        'kt': constants['kt'],\n        't_on': constants['t_on'],\n        't_off': constants['t_off'],\n        'I_amp': I_amp,\n        's': s,\n        'km': km,\n        'V_half': V_half\n    }\n    T_end = constants['T_end']\n    dt = constants['dt']\n    n_steps = int(np.round(T_end / dt))\n    # Initialize arrays\n    V = np.empty(n_steps + 1, dtype=float)\n    m = np.empty(n_steps + 1, dtype=float)\n    t = np.linspace(0.0, T_end, n_steps + 1)\n    # Initial conditions\n    V[0] = constants['EL']\n    m[0] = m_inf(V[0], V_half, km)\n    # Integrate\n    for i in range(n_steps):\n        V[i+1], m[i+1] = rk4_step(V[i], m[i], t[i], dt, params)\n    # Compute upstroke derivative\n    dVdt = np.diff(V) / dt\n    # Upstroke detection: fast upstroke first, else any rising phase\n    D_thr = constants['D_thr']\n    up_idx = np.where(dVdt > D_thr)[0]\n    if up_idx.size == 0:\n        up_idx = np.where(dVdt > 0.0)[0]\n    # Compute relative error\n    eps = 1e-9\n    minf_vals = m_inf(V[:-1], V_half, km)\n    rel_err = np.abs(m[:-1] - minf_vals) / np.maximum(minf_vals, eps)\n    \n    if up_idx.size > 0:\n        rmax = float(np.max(rel_err[up_idx]))\n    else:\n        # No upstroke found, so max error during upstroke is 0.\n        rmax = 0.0\n\n    # Determine failure\n    fail = rmax >= constants['r_crit']\n    return fail\n\ndef solve():\n    # Constants per problem statement (units given in problem text)\n    constants = {\n        'C': 1.0,          # uF/cm^2\n        'gL': 0.1,         # mS/cm^2\n        'EL': -65.0,       # mV\n        'gNa': 30.0,       # mS/cm^2\n        'ENa': 55.0,       # mV\n        'tau0': 0.15,      # ms\n        'tau1': 0.60,      # ms\n        'Vt': -25.0,       # mV\n        'kt': 15.0,        # mV\n        'T_end': 4.0,      # ms\n        'dt': 0.005,       # ms\n        't_on': 0.3,       # ms\n        't_off': 1.5,      # ms\n        'D_thr': 10.0,     # mV/ms\n        'r_crit': 0.2      # dimensionless\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (40.0, 1.0, 6.0, -40.0),  # Case 1\n        (80.0, 3.0, 6.0, -40.0),  # Case 2\n        (20.0, 1.0, 6.0, -40.0),  # Case 3\n        (40.0, 2.0, 3.0, -35.0),  # Case 4\n        (60.0, 0.5, 6.0, -40.0)   # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        result = simulate_case(case, constants)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}