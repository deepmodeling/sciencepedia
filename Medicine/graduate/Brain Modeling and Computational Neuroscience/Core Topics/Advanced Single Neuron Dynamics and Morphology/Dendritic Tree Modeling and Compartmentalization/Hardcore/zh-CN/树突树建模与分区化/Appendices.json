{
    "hands_on_practices": [
        {
            "introduction": "在构建任何树突模型之前，我们必须首先理解其基本的电气属性。本练习聚焦于轴向电阻，这是一个决定电流如何沿树突流动的关键参数 。通过推导和计算该值，您将具体理解树突的几何形状，特别是其半径，如何强有力地影响信号的传播。",
            "id": "3974745",
            "problem": "一个直的树突节段被建模为一个半径为 $a$、长度为 $L$ 的均匀直立圆柱体，其内部均匀的细胞内介质的电阻率 $R_i$（单位为 $\\Omega\\cdot\\text{cm}$）。在多房室电缆模型中，单位长度的轴向电阻 $r_a$（单位为 $\\Omega/\\text{cm}$）量化了沿树突轴向电流流动的阻力，并决定了相邻房室之间的纵向耦合强度。\n\n从连续介质形式的欧姆定律和均匀导体（长度为 $L$，横截面积为 $A$）的电阻定义出发，推导出一个均匀圆柱形树突的单位长度轴向电阻 $r_a$ 关于 $R_i$ 和 $a$ 的表达式。然后，对于一个 $R_i = 130\\ \\Omega\\cdot\\text{cm}$ 和 $a = 0.65\\ \\mu\\mathrm{m}$ 的树突，数值计算 $r_a$ 的值。将 $r_a$ 的数值以 $\\Omega/\\text{cm}$ 为单位表示，并四舍五入到3位有效数字。\n\n最后，假设树突直径减半，而 $R_i$ 保持不变。确定在这种直径减半的情况下，$r_a$ 变化的乘法因子。仅报告这个因子作为你的最终答案，它是一个没有单位的纯数。",
            "solution": "该问题要求三个不同的结果：首先，推导圆柱形树突的单位长度轴向电阻 $r_a$；其次，对给定参数的 $r_a$ 进行数值计算；第三，当树突直径减半时，$r_a$ 变化的乘法因子。最终答案应该只有这个乘法因子。\n\n首先，我们验证问题陈述。\n已知条件如下：\n- 树突节段被建模为一个半径为 $a$、长度为 $L$ 的均匀直立圆柱体。\n- 细胞内介质是均匀的，电阻率为 $R_i$。\n- 单位长度的轴向电阻用 $r_a$ 表示，单位为 $\\Omega/\\text{cm}$。\n- 出发点是连续介质形式的欧姆定律和均匀导体的电阻定义。\n- 用于数值计算的参数：$R_i = 130\\ \\Omega\\cdot\\text{cm}$ 和 $a = 0.65\\ \\mu\\mathrm{m}$。\n- 最后一个场景涉及将树突直径减半。\n\n该问题具有科学依据，因为它是将基本电学原理（欧姆定律）应用于计算神经科学中的一个经典模型（电缆理论）的标准应用。所提供的参数在生理学上是现实的范围内。问题是适定的、无歧义且自洽的。它包含了推导所要求的所有量的必要信息。因此，该问题是有效的，我们可以继续进行求解。\n\n**第1部分：$r_a$ 表达式的推导**\n\n均匀导体的电阻 $R$ 由关联电阻率、长度和横截面积的公式给出：\n$$\nR = \\rho \\frac{\\ell}{A}\n$$\n其中 $\\rho$ 是材料的电阻率，$\\ell$ 是导体的长度，$A$ 是其横截面积。\n\n在树突节段的背景下，细胞内介质的电阻率给定为 $R_i$。我们考虑一个长度为 $L$ 的节段。电流沿此长度轴向流动，因此电阻计算中的相关长度为 $\\ell = L$。树突被建模为一个半径为 $a$ 的直立圆柱体，因此其横截面积 $A$ 是一个半径为此值的圆的面积：\n$$\nA = \\pi a^2\n$$\n将这些量代入通用电阻公式，我们得到长度为 $L$ 的树突节段的总轴向电阻 $R_{axial}$：\n$$\nR_{axial} = R_i \\frac{L}{\\pi a^2}\n$$\n问题定义了单位长度的轴向电阻 $r_a$，其单位是电阻每长度（例如 $\\Omega/\\text{cm}$）。它通过将总轴向电阻 $R_{axial}$ 除以节段的长度 $L$ 得到：\n$$\nr_a = \\frac{R_{axial}}{L}\n$$\n代入 $R_{axial}$ 的表达式：\n$$\nr_a = \\frac{1}{L} \\left( R_i \\frac{L}{\\pi a^2} \\right)\n$$\n长度 $L$ 被消去，得到单位长度轴向电阻 $r_a$ 关于电阻率 $R_i$ 和半径 $a$ 的所需表达式：\n$$\nr_a = \\frac{R_i}{\\pi a^2}\n$$\n\n**第2部分：$r_a$ 的数值计算**\n\n我们被给予以下数值：\n- 电阻率, $R_i = 130\\ \\Omega\\cdot\\text{cm}$.\n- 半径, $a = 0.65\\ \\mu\\text{m}$.\n\n为了计算 $r_a$，单位必须一致。由于 $R_i$ 的单位是 $\\Omega\\cdot\\text{cm}$，我们必须将半径 $a$ 从微米 ($\\mu\\text{m}$) 转换为厘米 ($\\text{cm}$)。\n我们知道 $1\\ \\mu\\text{m} = 10^{-4}\\ \\text{cm}$。因此：\n$$\na = 0.65\\ \\mu\\text{m} = 0.65 \\times 10^{-4}\\ \\text{cm}\n$$\n现在，我们将 $R_i$ 和 $a$ 的数值代入推导出的 $r_a$ 公式中：\n$$\nr_a = \\frac{130\\ \\Omega\\cdot\\text{cm}}{\\pi (0.65 \\times 10^{-4}\\ \\text{cm})^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.65)^2 (10^{-4})^2} \\frac{\\Omega\\cdot\\text{cm}}{\\text{cm}^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.4225) (10^{-8})} \\frac{\\Omega}{\\text{cm}}\n$$\n$$\nr_a = \\frac{130}{\\pi \\times 0.4225} \\times 10^8 \\frac{\\Omega}{\\text{cm}}\n$$\n计算分母项 $\\pi \\times 0.4225 \\approx 1.32732...$\n$$\nr_a \\approx \\frac{130}{1.32732} \\times 10^8 \\frac{\\Omega}{\\text{cm}} \\approx 97.9416 \\times 10^6 \\frac{\\Omega}{\\text{cm}}\n$$\n在标准科学记数法中，这是 $9.79416 \\times 10^7\\ \\Omega/\\text{cm}$。问题要求四舍五入到3位有效数字。\n$$\nr_a \\approx 9.79 \\times 10^7\\ \\frac{\\Omega}{\\text{cm}}\n$$\n\n**第3部分：乘法因子的确定**\n\n设树突的初始状态半径为 $a_1$，单位长度轴向电阻为 $r_{a,1}$。在直径减半后的最终状态，半径为 $a_2$，单位长度轴向电阻为 $r_{a,2}$。电阻率 $R_i$ 是恒定的。\n半径和直径 $d$ 之间的关系是 $d = 2a$。如果初始直径是 $d_1$，则新直径是 $d_2 = \\frac{d_1}{2}$。\n新半径 $a_2$ 与新直径 $d_2$ 的关系是 $a_2 = \\frac{d_2}{2}$。代入 $d_2$ 的表达式：\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{d_1}{4}\n$$\n因为初始半径是 $a_1 = \\frac{d_1}{2}$，我们可以用旧半径表示新半径：\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{1}{2} a_1\n$$\n所以，直径减半等效于半径减半。\n\n初始的单位长度轴向电阻是：\n$$\nr_{a,1} = \\frac{R_i}{\\pi a_1^2}\n$$\n最终的单位长度轴向电阻是：\n$$\nr_{a,2} = \\frac{R_i}{\\pi a_2^2}\n$$\n代入 $a_2 = \\frac{a_1}{2}$:\n$$\nr_{a,2} = \\frac{R_i}{\\pi \\left(\\frac{a_1}{2}\\right)^2} = \\frac{R_i}{\\pi \\frac{a_1^2}{4}} = 4 \\left( \\frac{R_i}{\\pi a_1^2} \\right)\n$$\n认识到括号中的项是 $r_{a,1}$，我们有：\n$$\nr_{a,2} = 4 \\cdot r_{a,1}\n$$\n$r_a$ 变化的乘法因子是最终值与初始值的比率：\n$$\n\\text{因子} = \\frac{r_{a,2}}{r_{a,1}} = \\frac{4 \\cdot r_{a,1}}{r_{a,1}} = 4\n$$\n因此，将树突的直径减半会使其单位长度的轴向电阻增加为原来的4倍。这是因为电阻与横截面积成反比，而横截面积本身与半径（或直径）的平方成正比。将半径减半会使面积减小为原来的1/4，从而使电阻增加为原来的4倍。\n问题规定只应报告这个因子作为最终答案。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "基于轴向电阻的概念，我们现在考虑一个有限长度的树突段。真实的树突并非无限延伸；它的末端会连接到神经元的其他部分。本练习探讨了树突电缆远端的“边界条件”——无论是开路（封口端）还是接地（灭活端）——如何显著改变其输入电阻，揭示了局部电气特性如何被全局背景所塑造 。",
            "id": "3974785",
            "problem": "考虑一根长度为 $L$、半径为 $a$ 的无源、均匀、圆柱形树突电缆，其比膜电阻为 $R_{m}$，胞内（轴向）电阻率为 $R_{i}$。假设膜具有线性阈下特性，并处于稳态直流 (DC) 条件下，因此一维稳态电缆方程适用。令 $x=0$ 表示注入电流的远端尖端，$x=L$ 表示近端。膜电位 $V(x)$ 满足稳态电缆方程 $d^{2}V/dx^{2} = V/\\lambda^{2}$，其中长度常数 $\\lambda$ 与单位长度膜电阻 $r_{m}$ 和单位长度轴向电阻 $r_{a}$ 的关系为 $\\lambda = \\sqrt{r_{m}/r_{a}}$。对于圆柱体，$r_{m} = R_{m}/(2\\pi a)$ 且 $r_{a} = R_{i}/(\\pi a^{2})$。\n\n在远端尖端 $x=0$ 处注入一个微小稳态电流 $I$。轴向电流为 $I_{a}(x) = -(1/r_{a})\\, dV/dx$。在注入点，进入电缆的轴向电流必须等于注入电流，因此 $I_{a}(0^{+}) = I$。\n\n在近端 $x=L$ 处，考虑两种不同的边界条件：\n- 接地端：$V(L) = 0$。\n- 封闭端：$I_{a}(L) = 0$。\n\n从稳态电缆方程和上述定义出发，推导在每种边界条件下远端输入电阻 $R_{\\text{in}} = V(0)/I$ 的表达式。然后，对于具体参数值 $L = 1.0\\,\\text{mm}$，$a = 1\\,\\mu\\text{m}$，$R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$ 和 $R_{i} = 150\\,\\Omega\\cdot\\text{cm}$，计算封闭端和接地端两种情况下远端输入电阻的比率，即\n$$\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}}.$$\n将答案四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位。在推导过程中，从每种边界条件如何约束轴向电流和电压的角度，简要论证为什么这两种边界条件会产生不同的远端输入电阻。",
            "solution": "该问题要求推导和计算在近端具有两种不同边界条件的无源树突电缆的远端输入电阻之比。分析从一维稳态电缆方程开始。\n\n稳态条件下膜电位 $V(x)$ 的控制方程如下所示：\n$$\n\\frac{d^2V}{dx^2} = \\frac{V}{\\lambda^2}\n$$\n这是一个二阶线性齐次常微分方程。其通解可以用双曲函数表示为：\n$$\nV(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。\n\n轴向电流 $I_a(x)$ 定义为：\n$$\nI_a(x) = -\\frac{1}{r_a} \\frac{dV}{dx}\n$$\n对 $V(x)$ 的通解求导，得到：\n$$\n\\frac{dV}{dx} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right)\n$$\n在远端尖端 ($x=0$)，注入一个稳态电流 $I$。这为两种情况设定了第一个边界条件：\n$$\nI_a(0^+) = I \\implies -\\frac{1}{r_a} \\frac{dV}{dx}\\Big|_{x=0} = I\n$$\n代入 $x=0$ 处的导数表达式：\n$$\n-\\frac{1}{r_a} \\left[ \\frac{A}{\\lambda} \\sinh(0) + \\frac{B}{\\lambda} \\cosh(0) \\right] = I\n$$\n$$\n-\\frac{1}{r_a} \\left( \\frac{B}{\\lambda} \\right) = I \\implies B = -I r_a \\lambda\n$$\n这就确定了两种情况下常数 $B$ 的值。常数 $A$ 将取决于近端 $x=L$ 处的边界条件。\n\n**情况 1：接地端 ($V(L)=0$)**\n\n近端的边界条件是 $V(L) = 0$。将其应用于通解：\n$$\nV(L) = A \\cosh\\left(\\frac{L}{\\lambda}\\right) + B \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n代入 $B$ 的值：\n$$\nA \\cosh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n求解 $A$：\n$$\nA = I r_a \\lambda \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} = I r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n远端的输入电阻 $R_{\\text{in}}$ 定义为 $V(0)/I$。注入点 $x=0$ 处的电压为：\n$$\nV(0) = A \\cosh(0) + B \\sinh(0) = A\n$$\n因此，接地端情况下的输入电阻为：\n$$\nR_{\\text{in}}^{\\text{killed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\tanh(L/\\lambda)}{I} = r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**情况 2：封闭端 ($I_a(L)=0$)**\n\n近端的边界条件是 $I_a(L) = 0$，这意味着 $\\frac{dV}{dx}\\Big|_{x=L} = 0$。将此条件应用于电压的导数：\n$$\n\\frac{dV}{dx}\\Big|_{x=L} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{L}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n这可以简化为：\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) + B \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n代入 $B$ 的值：\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n求解 $A$：\n$$\nA = I r_a \\lambda \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} = I r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n输入电阻同样为 $R_{\\text{in}} = V(0)/I = A/I$。因此，对于封闭端情况：\n$$\nR_{\\text{in}}^{\\text{sealed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\coth(L/\\lambda)}{I} = r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**电阻差异的合理解释**\n\n推导出的表达式为 $R_{\\text{in}}^{\\text{killed}} = r_a \\lambda \\tanh(L/\\lambda)$ 和 $R_{\\text{in}}^{\\text{sealed}} = r_a \\lambda \\coth(L/\\lambda)$。对于任何正的无量纲长度 $L/\\lambda > 0$，根据数学性质有 $\\coth(L/\\lambda) > \\tanh(L/\\lambda)$。因此，$R_{\\text{in}}^{\\text{sealed}} > R_{\\text{in}}^{\\text{killed}}$。\n\n这种差异的物理原因在于注入电流 $I$ 可流动的路径。总输入电阻是衡量从注入点到地的电流流动阻力的度量。电流可以沿着电缆长度通过分布式膜电阻漏出，也可以轴向流向近端 $x=L$。\n- 在**接地端**情况下 ($V(L) = 0$)，近端保持在接地电位，形成一个低电阻路径或电流汇。因此，注入的电流有两条主要的到地路径：通过膜漏出，以及从 $x=L$ 的末端流出。这个额外的出口路径的存在降低了在注入点观察到的总电阻。\n- 在**封闭端**情况下 ($I_a(L) = 0$)，没有轴向电流可以从近端流出。这个末端相当于一个开路。因此，所有注入的电流都必须沿着电缆长度通过膜电阻漏出。通过移除一条流向地的并联路径，对电流流动的总阻碍增加，从而导致更高的输入电阻。\n\n**比率的计算**\n\n远端输入电阻的比率为：\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\frac{r_a \\lambda \\coth(L/\\lambda)}{r_a \\lambda \\tanh(L/\\lambda)} = \\frac{\\coth(L/\\lambda)}{\\tanh(L/\\lambda)} = \\coth^2\\left(\\frac{L}{\\lambda}\\right)\n$$\n为了计算该值，我们必须首先根据给定参数计算无量纲长度 $L/\\lambda$。单位必须一致；我们将使用厘米 (cm)。\n\n给定参数为：\n$L = 1.0\\,\\text{mm} = 0.1\\,\\text{cm}$\n$a = 1\\,\\mu\\text{m} = 10^{-4}\\,\\text{cm}$\n$R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$\n$R_{i} = 150\\,\\Omega\\cdot\\text{cm}$\n\n首先，我们计算单位长度电阻 $r_m$ 和 $r_a$：\n$$\nr_m = \\frac{R_m}{2\\pi a} = \\frac{1.0 \\times 10^4\\,\\Omega\\cdot\\text{cm}^2}{2\\pi (10^{-4}\\,\\text{cm})} = \\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}\n$$\n$$\nr_a = \\frac{R_i}{\\pi a^2} = \\frac{150\\,\\Omega\\cdot\\text{cm}}{\\pi (10^{-4}\\,\\text{cm})^2} = \\frac{150}{\\pi \\times 10^{-8}}\\,\\Omega/\\text{cm} = \\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}\n$$\n接下来，我们计算长度常数的平方 $\\lambda^2$：\n$$\n\\lambda^2 = \\frac{r_m}{r_a} = \\frac{\\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}}{\\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}} = \\frac{10^8}{2\\pi} \\cdot \\frac{\\pi}{1.5 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{10^8}{3 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{1}{300}\\,\\text{cm}^2\n$$\n长度常数 $\\lambda$ 为：\n$$\n\\lambda = \\sqrt{\\frac{1}{300}}\\,\\text{cm} = \\frac{1}{10\\sqrt{3}}\\,\\text{cm}\n$$\n现在，我们可以计算电缆的无量纲长度 $L/\\lambda$：\n$$\n\\frac{L}{\\lambda} = \\frac{0.1\\,\\text{cm}}{\\frac{1}{10\\sqrt{3}}\\,\\text{cm}} = 0.1 \\times 10\\sqrt{3} = \\sqrt{3}\n$$\n最后，我们计算电阻的比率：\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\coth^2(\\sqrt{3})\n$$\n使用数值 $\\sqrt{3} \\approx 1.7320508...$：\n$$\n\\coth(\\sqrt{3}) = \\frac{\\exp(\\sqrt{3}) + \\exp(-\\sqrt{3})}{\\exp(\\sqrt{3}) - \\exp(-\\sqrt{3})} \\approx 1.064593\n$$\n将此值平方：\n$$\n\\coth^2(\\sqrt{3}) \\approx (1.064593)^2 \\approx 1.133368\n$$\n四舍五入到四位有效数字，该比率为 $1.133$。",
            "answer": "$$\\boxed{1.133}$$"
        },
        {
            "introduction": "树突并非简单的电缆，而是复杂的、不断分叉的结构。本练习将介绍 Rall 经典的 $d^{3/2}$ 次方定律，这是理解如何对这些分叉点进行建模的关键理论原则 。通过将此规则应用于形态学数据，您将学习如何评估一个树突树的结构是否能有效地传递信号，从而在抽象的电缆理论与神经元真实的解剖复杂性之间架起一座桥梁。",
            "id": "3974766",
            "problem": "给定一组有根树，代表树突状结构的形态重建。每个节点对应一个短的圆柱形隔室，其直径以微米为单位进行测量。这些树表示为元组 $(\\text{node\\_id}, \\text{parent\\_id}, d)$ 的列表，其中 $d$ 是隔室的直径（单位为 $\\mu\\text{m}$），$\\text{parent\\_id}=-1$ 表示根节点，且每个非根节点有且仅有一个父节点。分支点（分叉）是任何具有两个或更多子节点的节点。\n\n目标是通过计算每个分支点的父隔室 $d^{3/2}$ 与子隔室 $d^{3/2}$ 之和之间的偏差，来检验 Rall 法则在每棵树上的适用性。具体来说，对于一个父节点直径为 $d_p$，子节点直径为 $\\{d_k\\}_{k=1}^m$ 的分支点，定义其和为 $S_{\\text{parent}} = d_p^{3/2}$ 和 $S_{\\text{kids}} = \\sum_{k=1}^m d_k^{3/2}$，以及相对偏差\n$$\n\\delta = \\frac{S_{\\text{kids}} - S_{\\text{parent}}}{S_{\\text{parent}}}.\n$$\n对于给定树中的所有分支点，计算三个指标：平均绝对相对偏差 $\\overline{|\\delta|}$，最大绝对相对偏差 $\\max|\\delta|$，以及绝对相对偏差不超过容差 $\\tau$ 的分支点比例 $f_\\tau$。容差为 $\\tau=0.05$（一个小数），且所有偏差指标均为无量纲。如果一棵树没有分支点，则定义 $\\overline{|\\delta|}=0$, $\\max|\\delta|=0$ 及 $f_\\tau=1$。\n\n此问题的理论基础是准静态条件下神经元树突的线性电缆理论，以及一个经过充分检验的观察结果：半无限长圆柱形电缆的输入电导与 $d^{3/2}$ 成比例，这导致了节点处的分支电导匹配条件。解答中要求给出此比例关系的推导及其应用。\n\n你的任务是实现一个程序，为提供的包含五棵树的测试套件中的每棵树计算上述三个指标，并以单一聚合格式输出它们。直径以 $\\mu\\text{m}$ 为单位提供；偏差是无量纲的。不涉及角度，也不得使用百分号。\n\n测试套件（每棵树是一个 $(\\text{node\\_id}, \\text{parent\\_id}, d)$ 元组的列表；直径 $d$ 的单位是 $\\mu\\text{m}$）：\n\n- 树 A（平衡二叉树，两个分支点均近似符合 Rall 法则）：\n    - $(0,-1,2.0736)$\n    - $(1,0,1.2)$\n    - $(2,0,1.4)$\n    - $(3,1,0.7)$\n    - $(4,1,0.81)$\n\n- 树 B（拓扑结构与树 A 相同，其中一个分支有故意设置的偏差）：\n    - $(0,-1,2.0736)$\n    - $(1,0,1.2)$\n    - $(2,0,1.4)$\n    - $(3,1,0.7)$\n    - $(4,1,0.9)$\n\n- 树 C（根节点三分支，近似符合 Rall 法则，更深层的分叉有偏差）：\n    - $(0,-1,2.0850)$\n    - $(1,0,1.1)$\n    - $(2,0,1.0)$\n    - $(3,0,0.9)$\n    - $(4,1,0.7)$\n    - $(5,1,0.5)$\n\n- 树 D（单链，无分支点）：\n    - $(0,-1,1.2)$\n    - $(1,0,1.1)$\n    - $(2,1,1.0)$\n    - $(3,2,0.9)$\n\n- 树 E（根节点为二分支，其中一个子节点非常小以测试数值稳定性，更深层的分叉有偏差）：\n    - $(0,-1,1.0)$\n    - $(1,0,0.2)$\n    - $(2,0,0.945)$\n    - $(3,2,0.4)$\n    - $(4,2,0.5)$\n\n你的程序应生成单行输出，包含五棵树的结果，格式为逗号分隔的列表的列表，其中每个内部列表按顺序包含三个指标 $[\\overline{|\\delta|}, \\max|\\delta|, f_\\tau]$。例如，输出应类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4],[x_5,y_5,z_5]]$，其中每个 $x_i$、$y_i$ 和 $z_i$ 都是浮点数。不允许有任何其他输出文本。",
            "solution": "该问题要求基于 Rall 分支法则对树突树的形态进行分析，该法则是从线性电缆理论中推导出来的原理。在提出计算方法之前，必须按要求先建立理论基础。\n\n**理论基础：Rall 的 $3/2$ 次幂法则的推导**\n\nRall 法则的基础是在稳态（直流）条件下，电流在被动树突电缆中的行为。我们将一段树突建模为一个均匀的圆柱体。该电缆上沿长度 $x$ 的电压 $V(x)$ 由稳态电缆方程描述：\n$$\n\\lambda^2 \\frac{d^2V}{dx^2} - V = 0\n$$\n此处，$\\lambda$ 是电缆的空间常数，定义为 $\\lambda = \\sqrt{r_m/r_a}$，其中 $r_m$ 是单位长度圆柱体的膜电阻，$r_a$ 是单位长度的轴向电阻。\n\n这些电阻取决于圆柱体的几何形状和神经元的内在特性。设 $d$ 为圆柱形隔室的直径，$R_m$ 为比膜电阻（单位 $\\Omega \\cdot \\text{m}^2$），$R_i$ 为比胞内（轴向）电阻率（单位 $\\Omega \\cdot \\text{m}$）。\n\n单位长度的膜电阻 $r_m$ 与单位长度的膜表面積（周长 $\\pi d$）成反比：\n$$\nr_m = \\frac{R_m}{\\pi d}\n$$\n单位长度的轴向电阻 $r_a$ 与圆柱体的横截面积（$A = \\pi(d/2)^2$）成反比：\n$$\nr_a = \\frac{R_i}{A} = \\frac{R_i}{\\pi (d/2)^2} = \\frac{4 R_i}{\\pi d^2}\n$$\n将这些代入空间常数 $\\lambda$ 的定义中：\n$$\n\\lambda = \\sqrt{\\frac{r_m}{r_a}} = \\sqrt{\\frac{R_m / (\\pi d)}{4 R_i / (\\pi d^2)}} = \\sqrt{\\frac{R_m d}{4 R_i}}\n$$\n假设材料特性均匀（$R_m$ 和 $R_i$ 为常数），空间常数与直径的平方根成正比：$\\lambda \\propto \\sqrt{d}$。\n\n接下来，我们考虑树突分支的输入电导 $G_{in}$。对于半无限长电缆（对于电学上较长的分支是一个有效的近似），输入电阻为 $R_{in} = \\sqrt{r_m r_a}$。输入电导是其倒数：\n$$\nG_{in} = \\frac{1}{R_{in}} = \\frac{1}{\\sqrt{r_m r_a}}\n$$\n我们也可以使用 $\\lambda$ 和 $r_a$ 将 $R_{in}$ 表示为 $R_{in} = \\lambda r_a$。因此：\n$$\nG_{in} = \\frac{1}{\\lambda r_a}\n$$\n现在，我们研究 $G_{in}$ 如何随直径 $d$ 变化。我们已经确定 $\\lambda \\propto \\sqrt{d}$ 且 $r_a \\propto 1/d^2$。因此：\n$$\nG_{in} \\propto \\frac{1}{(\\sqrt{d}) (1/d^2)} = \\frac{d^2}{\\sqrt{d}} = d^{3/2}\n$$\n这个推导证明了半无限长电缆的输入电导与其直径的 $3/2$ 次幂成正比。\n\nWilfrid Rall 的洞见是，为了在没有阻抗失配的情况下实现高效的信号传播，从父分支看进去的电导应等于其所有子分支的电導之和。在一个父节点直径为 $d_p$、拥有 $m$ 个子分支且其直径为 $\\{d_k\\}_{k=1}^m$ 的分支点，此条件为：\n$$\nG_{in, \\text{parent}} = \\sum_{k=1}^m G_{in, \\text{child}_k}\n$$\n使用推导出的比例关系，并设 $C$ 为比例常数，我们得到：\n$$\nC \\cdot d_p^{3/2} = \\sum_{k=1}^m C \\cdot d_k^{3/2}\n$$\n常数 $C$ 被消去，得到 Rall 著名的分支法则：\n$$\nd_p^{3/2} = \\sum_{k=1}^m d_k^{3/2}\n$$\n**计算策略**\n\n问题要求我们为一组给定的树突树量化与此理想法则的偏差。对每棵树实现此目标的算法如下：\n\n1.  **数据结构化**：输入格式是一个 $(\\text{node\\_id}, \\text{parent\\_id}, d)$ 元组的列表，即边列表。需要将其解析为更便于计算的结构。使用两个字典是最佳选择：\n    *   一个字典将每个 `node_id` 映射到其直径 $d$。\n    *   另一个字典将每个父 `node_id` 映射到其子 `node_id` 的列表。这直接表示了树的层次结构。\n\n2.  **识别分支点**：分支点定义为具有两个或更多子节点的节点。通过遍历上一步中创建的父-子字典，所有作为键且对应列表长度 $\\ge 2$ 的节点都被识别为分支点。\n\n3.  **偏差计算**：对于每个识别出的分支点 $p$：\n    *   获取父节点直径 $d_p$ 和子节点直径集合 $\\{d_k\\}$。\n    *   计算父节点和 $S_{\\text{parent}} = d_p^{3/2}$。\n    *   计算子节点和 $S_{\\text{kids}} = \\sum_{k} d_k^{3/2}$。\n    *   计算相对偏差 $\\delta = (S_{\\text{kids}} - S_{\\text{parent}}) / S_{\\text{parent}}$。请注意，对于任何 $d_p > 0$，$S_{\\text{parent}}$ 也大于 0，从而避免了除以零的情况。测试套件中的所有直径均为正数。\n    *   将该树计算出的所有 $\\delta$ 值收集到一个列表中。\n\n4.  **指标计算**：\n    *   如果树不包含分支点，则偏差列表将为空。根据问题定义，指标定义为 $\\overline{|\\delta|} = 0$, $\\max|\\delta| = 0$ 和 $f_\\tau = 1$。\n    *   如果存在分支点，则根据 $\\delta$ 值列表计算以下指标：\n        *   **平均绝对相对偏差, $\\overline{|\\delta|}$**：所有计算出的偏差的绝对值的算术平均值。\n        *   **最大绝对相对偏差, $\\max|\\delta|$**：所有计算出的偏差的绝对值中的最大值。\n        *   **符合条件的分支比例, $f_\\tau$**：$|\\delta| \\le \\tau$ 的分支点所占的比例，其中容差 $\\tau$ 给定为 $0.05$。计算方法为（$|\\delta| \\le \\tau$ 的分支数）/（总分支数）。\n\n此过程独立应用于五个提供的测试树中的每一个，以生成最终结果。实现将使用 `numpy` 库以进行高效的数值运算。",
            "answer": "[[0.00265839212260655,0.005006095696144825,1.0],[0.05013524622247444,0.09526440539121966,0.5],[0.09323604753522292,0.18567487829285098,0.5],[0.0,0.0,1.0],[0.17437717462002324,0.3400892224403328,0.5]]"
        }
    ]
}