{
    "hands_on_practices": [
        {
            "introduction": "我们首先从一个基础练习开始，它将引导你推导理想化无源电缆中的稳态电压分布。通过应用欧姆定律和电荷守恒，你将推导出著名的电压随距离指数衰减的规律。这个练习旨在巩固你对长度常数$\\lambda$的理解，并揭示它如何直接决定一个电信号能够被动传播的距离 。",
            "id": "3994040",
            "problem": "考虑一个半径为 $a$ 的均匀、无源圆柱形树突电缆，它从 $x=0$ 延伸至 $x=\\infty$，并浸润在均匀介质中。该细胞膜的特性由单位面积膜电阻 $R_{m}$ 和单位面积膜电容 $C_{m}$ 描述。胞内介质具有轴向电阻率 $R_{i}$。在 $x=0$ 处施加恒定电压钳的稳态条件下，电容电流为零，唯一的跨膜电流是电阻性漏电流。假设电压钳强制 $V(0)=V_{0}$，并且电缆在其他地方没有受到驱动。\n\n从应用于分布式电缆的电流守恒和欧姆定律出发，推导 $x\\geq 0$ 时的稳态电压分布 $V(x)$，并用生物物理参数表示长度常数 $\\lambda$。然后，将半程距离 $x_{1/2}$ 定义为稳态下比率 $V(x)/V(0)$ 等于 $0.5$ 的位置，并推导用 $\\lambda$ 表示 $x_{1/2}$ 的精确表达式。最后，将无量纲比率 $x_{1/2}/\\lambda$ 表示为一个数值，并提供其四舍五入到四位有效数字的值。这个最终比率不需要物理单位，也不涉及角度。",
            "solution": "该问题要求推导无限长无源电缆中的稳态电压分布，并计算电压衰减一半时所经过的距离。\n\n**1. 推导稳态电缆方程**\n\n我们从两个基本物理定律出发：\n*   **电流守恒（基尔霍夫电流定律）**：对于一小段长度为 $dx$ 的电缆，流入和流出该段的轴向电流 $I_a$ 之差，必须等于通过膜泄漏出去的电流 $i_m dx$。在稳态下，这可以表示为：\n    $$ \\frac{dI_a}{dx} = -i_m $$\n*   **欧姆定律**：\n    *   轴向电流由电压梯度驱动：$I_a = -\\frac{1}{r_a} \\frac{dV}{dx}$，其中 $r_a$ 是单位长度的轴向电阻。\n    *   膜漏电流与局部电压成正比：$i_m = \\frac{V}{r_m}$，其中 $r_m$ 是单位长度的膜电阻。\n\n将欧姆定律的两个表达式代入电流守恒方程中：\n首先对轴向电流的表达式求导：$\\frac{dI_a}{dx} = -\\frac{1}{r_a} \\frac{d^2V}{dx^2}$。\n然后代入守恒定律：$-\\frac{1}{r_a} \\frac{d^2V}{dx^2} = -\\frac{V}{r_m}$。\n整理后得到**稳态电缆方程**：\n$$ \\frac{d^2V}{dx^2} = \\frac{r_a}{r_m} V $$\n\n**2. 定义并表示长度常数 $\\lambda$**\n\n为了简化方程，我们定义**长度常数 $\\lambda$**：\n$$ \\lambda = \\sqrt{\\frac{r_m}{r_a}} $$\n方程可以重写为标准形式：\n$$ \\lambda^2 \\frac{d^2V}{dx^2} - V = 0 $$\n接下来，我们将 $\\lambda$ 用生物物理参数表示。对于一个半径为 $a$ 的圆柱体：\n*   单位长度轴向电阻 $r_a$ 取决于胞内电阻率 $R_i$ 和横截面积 $\\pi a^2$：$r_a = \\frac{R_i}{\\pi a^2}$。\n*   单位长度膜电阻 $r_m$ 取决于单位面积膜电阻 $R_m$ 和周长 $2\\pi a$：$r_m = \\frac{R_m}{2\\pi a}$。\n\n将它们代入 $\\lambda$ 的定义中：\n$$ \\lambda = \\sqrt{\\frac{R_m/(2\\pi a)}{R_i/(\\pi a^2)}} = \\sqrt{\\frac{R_m \\pi a^2}{2\\pi a R_i}} = \\sqrt{\\frac{R_m a}{2 R_i}} $$\n\n**3. 求解方程并应用边界条件**\n\n稳态电缆方程的通解为 $V(x) = C_1 e^{x/\\lambda} + C_2 e^{-x/\\lambda}$。\n我们应用问题中给出的边界条件：\n1.  电缆延伸至 $x=\\infty$，且电压在无穷远处不能无界。这意味着当 $x \\to \\infty$ 时，$V(x)$ 必须有界。由于 $e^{x/\\lambda}$ 项在 $x \\to \\infty$ 时会发散，其系数必须为零，即 $C_1 = 0$。\n2.  在 $x=0$ 处，电压被钳制在 $V_0$：$V(0) = V_0$。\n\n将这些条件应用于简化后的解 $V(x) = C_2 e^{-x/\\lambda}$：\n$$ V(0) = C_2 e^0 = C_2 = V_0 $$\n因此，稳态电压分布的最终解为：\n$$ V(x) = V_0 e^{-x/\\lambda} $$\n\n**4. 计算半程距离 $x_{1/2}$**\n\n半程距离 $x_{1/2}$ 是电压衰减为其初始值一半时的位置，即 $V(x_{1/2}) / V(0) = 0.5$。\n$$ \\frac{V_0 e^{-x_{1/2}/\\lambda}}{V_0} = 0.5 \\implies e^{-x_{1/2}/\\lambda} = 0.5 $$\n两边取自然对数：\n$$ -\\frac{x_{1/2}}{\\lambda} = \\ln(0.5) = -\\ln(2) $$\n因此，半程距离的表达式为：\n$$ x_{1/2} = \\lambda \\ln(2) $$\n\n**5. 计算比率 $x_{1/2}/\\lambda$**\n\n最后，我们计算无量纲比率 $x_{1/2}/\\lambda$：\n$$ \\frac{x_{1/2}}{\\lambda} = \\ln(2) \\approx 0.693147... $$\n根据要求，将结果四舍五入到四位有效数字，我们得到 $0.6931$。",
            "answer": "$$\\boxed{0.6931}$$"
        },
        {
            "introduction": "在理想无限长电缆模型的基础上，这个练习将探讨更接近现实的有限长度树突情境。你将研究树突末端的不同“边界条件”——即“封闭端”与“接地端”——如何显著地改变电压分布。这项练习突出了树突终端在突触整合中所扮演的关键角色，表明信号衰减并非一个固定不变的属性，而是依赖于电缆的整体结构 。",
            "id": "3994117",
            "problem": "考虑一根连接到位置 $x=0$ 处胞体的单一、笔直、均匀的被动树突电缆。该电缆的物理长度为 $L$，被动长度常数为 $\\lambda$，且 $L=3\\lambda$。假设膜动力学为线性，并处于稳态（时不变）条件。胞体相对于静息电位维持在固定的去极化电压 $V(0)=V_{s}$。电缆远端 $x=L$ 处考虑两种在电缆理论中标准的边界条件：(i) 封闭端，意味着没有轴向电流流出末端；(ii) 接地端，意味着末端的电压被限制在静息电位。\n\n从导出稳态线性电缆方程的膜电流和轴向电流的定义关系出发，推导每种边界条件下电缆上的稳态电压分布 $V(x)$，并计算从胞体到远端的衰减，定义为无量纲比率 $A = \\frac{V(L)}{V(0)}$，分别计算封闭端和接地端两种情况下的衰减值。使用 $L=3\\lambda$。将您的数值答案四舍五入到四位有效数字。提供 $A$ 的值，不带单位。",
            "solution": "该问题要求在两种不同的边界条件下，推导被动树突电缆的稳态电压分布 $V(x)$，并计算从胞体到远端的电压衰减。\n\n起点是稳态被动电缆方程。在被动电缆中，轴向电流 $I_a$ 沿无穷小长度 $dx$ 的变化必须与单位长度上流过膜的电流 $i_m$ 相平衡。按照惯例，向外的膜电流为正。\n$$\n\\frac{dI_a}{dx} = -i_m\n$$\n在稳态下，膜电流仅包含泄漏电流，因为电容电流 ($c_m \\frac{dV}{dt}$) 为零。泄漏电流由欧姆定律给出，$i_m = \\frac{V}{r_m}$，其中 $V$ 是相对于静息电位的电压，$r_m$ 是单位长度的膜电阻。轴向电流由电压梯度根据欧姆定律驱动，$I_a = -\\frac{1}{r_a} \\frac{dV}{dx}$，其中 $r_a$ 是单位长度的轴向电阻。\n\n将这些表达式代入电流守恒方程，得到：\n$$\n\\frac{d}{dx} \\left(-\\frac{1}{r_a} \\frac{dV}{dx}\\right) = -\\frac{V}{r_m}\n$$\n对于均匀电缆，$r_a$ 和 $r_m$ 是常数，从而得到二阶线性常微分方程：\n$$\n\\frac{d^2V}{dx^2} = \\frac{r_a}{r_m} V\n$$\n我们定义被动长度常数 $\\lambda = \\sqrt{\\frac{r_m}{r_a}}$。方程变为：\n$$\n\\lambda^2 \\frac{d^2V}{dx^2} - V = 0\n$$\n这就是稳态线性电缆方程。该方程的通解可以用指数函数或双曲函数表示。双曲函数形式通常在应用边界条件时更为方便：\n$$\nV(x) = C_1 \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n\n胞体处 ($x=0$) 的边界条件为 $V(0) = V_s$。将此应用于通解：\n$$\nV(0) = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1 \\cdot 1 + C_2 \\cdot 0 = C_1\n$$\n因此，$C_1 = V_s$，解的形式变为：\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n我们现在求解 $C_2$ 并找出两种远端边界条件下具体的电压分布。\n\n### 情况 (i)：封闭端边界条件\n\n$x=L$ 处的封闭端条件意味着没有轴向电流从电缆末端流出。\n$$\nI_a(L) = -\\frac{1}{r_a}\\left.\\frac{dV}{dx}\\right|_{x=L} = 0 \\implies \\left.\\frac{dV}{dx}\\right|_{x=L} = 0\n$$\n首先，我们求 $V(x)$ 的导数：\n$$\n\\frac{dV}{dx} = \\frac{V_s}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{C_2}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right)\n$$\n在 $x=L$ 处应用封闭端条件：\n$$\n\\frac{V_s}{\\lambda} \\sinh\\left(\\frac{L}{\\lambda}\\right) + \\frac{C_2}{\\lambda} \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n$$\nC_2 = -V_s \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} = -V_s \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n将 $C_1$ 和 $C_2$ 代回 $V(x)$ 的解中：\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) - V_s \\tanh\\left(\\frac{L}{\\lambda}\\right) \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n这可以使用 $\\tanh$ 的定义和一个双曲恒等式来简化：\n$$\nV(x) = V_s \\left[ \\cosh\\left(\\frac{x}{\\lambda}\\right) - \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} \\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n$$\nV(x) = \\frac{V_s}{\\cosh(L/\\lambda)} \\left[ \\cosh\\left(\\frac{L}{\\lambda}\\right)\\cosh\\left(\\frac{x}{\\lambda}\\right) - \\sinh\\left(\\frac{L}{\\lambda}\\right)\\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n使用恒等式 $\\cosh(A-B) = \\cosh(A)\\cosh(B) - \\sinh(A)\\sinh(B)$，我们得到封闭端情况下的最终电压分布：\n$$\nV_{\\text{sealed}}(x) = V_s \\frac{\\cosh\\left(\\frac{L-x}{\\lambda}\\right)}{\\cosh\\left(\\frac{L}{\\lambda}\\right)}\n$$\n衰减为 $A = \\frac{V(L)}{V(0)}$。这里，$V(0) = V_s$。\n$$\nV(L) = V_s \\frac{\\cosh\\left(\\frac{L-L}{\\lambda}\\right)}{\\cosh\\left(\\frac{L}{\\lambda}\\right)} = V_s \\frac{\\cosh(0)}{\\cosh(L/\\lambda)} = \\frac{V_s}{\\cosh(L/\\lambda)}\n$$\n因此，封闭端情况下的衰减为：\n$$\nA_{\\text{sealed}} = \\frac{V(L)}{V(0)} = \\frac{1}{\\cosh(L/\\lambda)}\n$$\n给定 $L = 3\\lambda$，我们有 $L/\\lambda = 3$。\n$$\nA_{\\text{sealed}} = \\frac{1}{\\cosh(3)} = \\frac{1}{(\\exp(3) + \\exp(-3))/2} \\approx \\frac{1}{10.06766} \\approx 0.0993279\n$$\n四舍五入到四位有效数字，$A_{\\text{sealed}} \\approx 0.09933$。\n\n### 情况 (ii)：接地端边界条件\n\n$x=L$ 处的接地端条件意味着电压被固定在静息电位，因此 $V(L) = 0$。\n再次从 $V(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)$ 出发，我们应用这个条件：\n$$\nV(L) = V_s \\cosh\\left(\\frac{L}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n求解 $C_2$：\n$$\nC_2 = -V_s \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} = -V_s \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n将 $C_1$ 和 $C_2$ 代回 $V(x)$ 的解中：\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) - V_s \\coth\\left(\\frac{L}{\\lambda}\\right) \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n类似地，我们简化这个表达式：\n$$\nV(x) = V_s \\left[ \\cosh\\left(\\fracx}{\\lambda}\\right) - \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} \\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n$$\nV(x) = \\frac{V_s}{\\sinh(L/\\lambda)} \\left[ \\sinh\\left(\\frac{L}{\\lambda}\\right)\\cosh\\left(\\frac{x}{\\lambda}\\right) - \\cosh\\left(\\frac{L}{\\lambda}\\right)\\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n使用恒等式 $\\sinh(A-B) = \\sinh(A)\\cosh(B) - \\cosh(A)\\sinh(B)$，我们得到接地端情况下的最终电压分布：\n$$\nV_{\\text{killed}}(x) = V_s \\frac{\\sinh\\left(\\frac{L-x}{\\lambda}\\right)}{\\sinh\\left(\\frac{L}{\\lambda}\\right)}\n$$\n衰减为 $A = \\frac{V(L)}{V(0)}$。这里，$V(0) = V_s$。根据边界条件的定义，远端的电压 $V(L)$ 为零。我们也可以从推导出的分布中验证这一点：\n$$\nV(L) = V_s \\frac{\\sinh\\left(\\frac{L-L}{\\lambda}\\right)}{\\sinh\\left(\\frac{L}{\\lambda}\\right)} = V_s \\frac{\\sinh(0)}{\\sinh(L/\\lambda)} = 0\n$$\n因此，接地端情况下的衰减为：\n$$\nA_{\\text{killed}} = \\frac{0}{V_s} = 0\n$$\n\n### 衰减差异的解释\n\n从胞体到远端的衰减在这两种情况下有根本的不同，因为远端 ($x=L$) 的边界条件决定了到达那里的轴向电流的去向。\n1.  **封闭端**：条件 $\\frac{dV}{dx}|_{x=L}=0$ 意味着轴向电流没有路径可以流出电缆。这类似于一个开路。电流携带的电荷在远端积累，导致电压 $V(L)$ 升高到一个非零值 $V_s/\\cosh(L/\\lambda)$。这种电压的建立减小了末端附近的电压梯度，最终在终端处停止了电流的流动。因此，衰减是有限的且不那么严重。\n2.  **接地端**：条件 $V(L)=0$ 强制远端保持在静息电位。这相当于一个到地的短路，为电流提供了一个无限的汇。任何到达电缆末端的轴向电流都会流出，从而阻止任何电荷积累并将电压固定为零。与封闭端情况相比，这种持续的电荷流失导致整个电缆上的电压梯度更陡峭，并且根据定义，末端的电压为零。这导致信号在远端完全衰减，即 $A_{\\text{killed}}=0$。\n\n总而言之，解 $V(x)$ 的数学形式直接由边界上施加的物理约束所决定。封闭端允许电压建立，而接地端则将其分流至零，从而导致了观察到的衰减差异。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.09933 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项练习将连接解析理论与计算实践，这是现代神经科学研究中的关键一步。你将通过编程实现一个数值模拟，使用有限差分法来求解稳态电缆方程。通过构建计算模型并对照已知的解析解进行验证，你将获得模拟复杂神经元和网络的实战经验 。",
            "id": "3994042",
            "problem": "考虑一个一维、圆柱形、无源的神经元电缆，其轴向属性均匀。该电缆具有单位面积的比膜电阻 $R_m$（单位为 $\\Omega\\cdot\\mathrm{m}^2$）、比轴向电阻率 $R_i$（单位为 $\\Omega\\cdot\\mathrm{m}$）和直径 $d$（单位为 $\\mathrm{m}$）。令 $x$ 表示轴向位置（单位为 $\\mathrm{m}$），$V(x)$ 表示相对于远处参考点的稳态跨膜电位（单位为 $\\mathrm{V}$）。在位置 $x=0$ 处，通过一个振幅为 $I_0$（单位为 $\\mathrm{A}$）的直流（DC）点电流注入来刺激该电缆。假设电缆有效无限长，因此在 $|x|$ 很大时电位趋于零。\n\n从应用于无限小圆柱形电缆段的基尔霍夫电流定律和欧姆定律出发，单位长度的轴向电流和单位长度的漏电流必须与任何源相平衡。使用圆柱体的几何关系，单位长度的膜电阻 $r_m$（单位为 $\\Omega\\cdot\\mathrm{m}$）和单位长度的轴向电阻 $r_a$（单位为 $\\Omega/\\mathrm{m}$）可以通过标准的生物物理关系用 $R_m$、$R_i$ 和 $d$ 来表示。您的任务是：\n- 在 $x=0$ 处存在点电流源的情况下，推导控制 $V(x)$ 的稳态微分方程。\n- 展示长度常数 $\\lambda$（单位为 $\\mathrm{m}$）如何从这些参数中产生。\n- 在有限域近似 $x\\in[-L,L]$ 上，使用齐次狄利克雷边界条件 $V(-L)=0$ 和 $V(L)=0$ 数值求解稳态方程，其中 $L$ 被选为长度常数的固定倍数。\n- 在间距为 $\\Delta x$ 的均匀网格上，使用中心差分对空间二阶导数进行一致的离散化。\n- 将网格上 $x=0$ 处的点源近似为最近网格节点上的集中源，并进行缩放，使其空间积分等于 $I_0$。\n\n根据数值解，计算距注入点一组指定距离处的衰减比 $A(x)=V(x)/V(0)$，并将其与从推导出的稳态微分方程和您计算的长度常数 $\\lambda$ 得出的闭式解进行比较。对于每组参数，报告在指定距离上数值衰减比与解析衰减比之间的最大绝对相对误差。位置 $x$ 处的绝对相对误差定义为 $\\left|A_{\\mathrm{num}}(x)-A_{\\mathrm{ana}}(x)\\right|/\\left|A_{\\mathrm{ana}}(x)\\right|$。\n\n实现要求：\n- 对所有测试用例，使用均匀网格，其中 $L=10\\,\\lambda$ 且 $\\Delta x=\\lambda/50$。\n- 评估衰减比的距离为 $\\{0,\\;0.5\\,\\lambda,\\;1\\,\\lambda,\\;2\\,\\lambda,\\;3\\,\\lambda,\\;5\\,\\lambda\\}$。\n- 所有长度以 $\\mathrm{m}$ 表示，电阻以 $\\Omega\\cdot\\mathrm{m}^2$ 和 $\\Omega\\cdot\\mathrm{m}$ 表示，电流以 $\\mathrm{A}$ 表示，电压以 $\\mathrm{V}$ 表示。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3]$），其中每个 $r_k$ 是测试用例 $k$ 的最大绝对相对误差（一个浮点数）。\n\n测试套件：\n- 用例 1（正常路径）：$d=2\\times 10^{-6}\\,\\mathrm{m}$，$R_m=1.0\\,\\Omega\\cdot\\mathrm{m}^2$，$R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$，$I_0=1\\times 10^{-9}\\,\\mathrm{A}$。\n- 用例 2（细电缆边界情况）：$d=0.2\\times 10^{-6}\\,\\mathrm{m}$，$R_m=1.0\\,\\Omega\\cdot\\mathrm{m}^2$，$R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$，$I_0=1\\times 10^{-9}\\,\\mathrm{A}$。\n- 用例 3（高膜电阻）：$d=2\\times 10^{-6}\\,\\mathrm{m}$，$R_m=2.0\\,\\Omega\\cdot\\mathrm{m}^2$，$R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$，$I_0=1\\times 10^{-9}\\,\\mathrm{A}$。\n\n对于每个用例，您的程序应在规定的网格上计算数值衰减比，计算由您推导的方程和计算出的 $\\lambda$ 所隐含的解析衰减比，并报告在距离集合 $\\{0,\\;0.5\\,\\lambda,\\;1\\,\\lambda,\\;2\\,\\lambda,\\;3\\,\\lambda,\\;5\\,\\lambda\\}$ 上的最大绝对相对误差。最终输出必须是单行，格式为 $[r_1,r_2,r_3]$，包含三个浮点数值。",
            "solution": "该问题要求推导并数值求解一维无源神经元树突的稳态电缆方程，然后与解析解进行比较。在尝试任何解决方案之前，需要对问题陈述进行验证。\n\n### 问题验证\n\n首先，我们从问题陈述中提取已知条件。\n*   **物理参数**：单位面积的比膜电阻 $R_m$（$\\Omega\\cdot\\mathrm{m}^2$）、比轴向电阻率 $R_i$（$\\Omega\\cdot\\mathrm{m}$）和电缆直径 $d$（$\\mathrm{m}$）。\n*   **变量**：轴向位置 $x$（$\\mathrm{m}$）、稳态跨膜电位 $V(x)$（$\\mathrm{V}$）。\n*   **源**：在 $x=0$ 处注入振幅为 $I_0$（$\\mathrm{A}$）的直流（DC）点电流。\n*   **边界条件（解析）**：无限长电缆，$|x| \\to \\infty$ 时 $V(x) \\to 0$。\n*   **中间参数**：单位长度的膜电阻 $r_m$（$\\Omega\\cdot\\mathrm{m}$）和单位长度的轴向电阻 $r_a$（$\\Omega/\\mathrm{m}$）。长度常数 $\\lambda$（$\\mathrm{m}$）。\n*   **数值设置**：\n    *   域：有限近似 $x \\in [-L, L]$，其中 $L = 10\\lambda$。\n    *   网格：均匀网格，间距 $\\Delta x = \\lambda/50$。\n    *   边界条件（数值）：齐次狄利克雷（Dirichlet）条件，$V(-L)=0$ 和 $V(L)=0$。\n    *   离散化：空间二阶导数采用中心差分。\n    *   源近似：在最接近 $x=0$ 的网格节点上设置一个集中源，并进行缩放，使其空间积分等于 $I_0$。\n*   **分析**：\n    *   主要关注的量是衰减比 $A(x) = V(x)/V(0)$。\n    *   用于误差分析的评估点为 $\\{0, 0.5\\lambda, 1\\lambda, 2\\lambda, 3\\lambda, 5\\lambda\\}$。\n    *   性能指标是数值衰减比和解析衰减比之间的最大绝对相对误差：$\\max_x |\\frac{A_{\\mathrm{num}}(x) - A_{\\mathrm{ana}}(x)}{A_{\\mathrm{ana}}(x)}|$。\n*   **测试用例**：提供了三组参数 $(d, R_m, R_i, I_0)$。\n\n该问题具有科学依据，是生物物理学和计算神经科学中的一个典型例子。它适定、客观且自洽，为唯一解及其数值近似和验证提供了所有必要的参数和规范。参数在物理上是合理的。任务既不简单也非不明确。因此，该问题被认为是**有效的**。\n\n### 理论推导与求解策略\n\n我们首先从第一性原理推导控制微分方程。考虑电缆的一个长度为 $\\Delta x$ 的无限小段。\n\n1.  **参数推导**：单位长度电阻 $r_a$ 和 $r_m$ 是从比电阻和圆柱几何形状推导出来的。单位长度的轴向电阻 $r_a$ 是比轴向电阻率 $R_i$ 除以横截面积 $A = \\pi (d/2)^2$。\n    $$r_a = \\frac{R_i}{A} = \\frac{4 R_i}{\\pi d^2} \\quad [\\Omega/\\mathrm{m}]$$\n    单位长度的膜电阻 $r_m$ 是比膜电阻 $R_m$ 除以周长 $\\pi d$。\n    $$r_m = \\frac{R_m}{\\pi d} \\quad [\\Omega\\cdot\\mathrm{m}]$$\n\n2.  **控制方程**：根据基尔霍夫（Kirchhoff）电流定律，沿段的轴向电流 $I_a(x)$ 的变化必须与每单位长度泄漏穿过膜的电流 $i_m(x)$ 相平衡。在稳态下，$-\\frac{dI_a}{dx} = i_m$。欧姆（Ohm）定律将电压梯度与轴向电流联系起来：$-\\frac{dV}{dx} = I_a r_a$。对此式关于 $x$ 求导得到 $\\frac{d^2V}{dx^2} = -r_a \\frac{dI_a}{dx}$。代入基尔霍夫关系式得到 $\\frac{d^2V}{dx^2} = r_a i_m$。根据欧姆定律，单位长度的膜漏电流为 $i_m = V/r_m$。因此，我们得到齐次稳态电缆方程：\n    $$\\frac{d^2V}{dx^2} = \\frac{r_a}{r_m} V$$\n    我们将长度常数 $\\lambda$ 定义为：\n    $$\\lambda = \\sqrt{\\frac{r_m}{r_a}} = \\sqrt{\\frac{R_m/(\\pi d)}{4 R_i/(\\pi d^2)}} = \\sqrt{\\frac{R_m d}{4 R_i}} \\quad [\\mathrm{m}]$$\n    方程变为 $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$。当一个点电流 $I_0$ 在 $x=0$ 处注入时，它充当一个源项，由狄拉克（Dirac）δ函数 $I_0 \\delta(x)$ 表示。完整的非齐次方程是：\n    $$\\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V = -r_a I_0 \\delta(x)$$\n\n3.  **解析解**：对于无限长电缆，当 $|x| \\to \\infty$ 时 $V(x) \\to 0$，对于 $x \\neq 0$ 的齐次方程的解是 $V(x) = C e^{-|x|/\\lambda}$。常数 $C$ 通过在 $x=0$ 两侧对完整方程进行积分得到，这产生了一个关于导数的跳跃条件：$\\frac{dV}{dx}|_{0^+} - \\frac{dV}{dx}|_{0^-} = -r_a I_0$。将此应用于解的形式，得到 $C = \\frac{r_a \\lambda I_0}{2}$。解析解是：\n    $$V_{\\mathrm{ana}}(x) = \\frac{r_a \\lambda I_0}{2} e^{-|x|/\\lambda}$$\n    因此，解析衰减比 $A_{\\mathrm{ana}}(x) = V_{\\mathrm{ana}}(x) / V_{\\mathrm{ana}}(0)$ 是：\n    $$A_{\\mathrm{ana}}(x) = e^{-|x|/\\lambda}$$\n\n4.  **数值方法**：我们在有限域 $[-L, L]$ 上求解方程，其中 $L=10\\lambda$，边界条件为 $V(\\pm L) = 0$。定义一个均匀网格 $x_j = -L + j\\Delta x$，其中 $\\Delta x = \\lambda/50$。区间数为 $N = 2L/\\Delta x = 1000$，从而产生 $N+1=1001$ 个网格点，索引为 $j=0, \\dots, N$。对应于 $x=0$ 的中心节点位于索引 $j_0 = N/2 = 500$ 处。\n\n    二阶导数使用三点中心差分格式进行近似：$\\frac{d^2V}{dx^2}|_{x_j} \\approx \\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2}$。狄拉克（Dirac）δ函数 $\\delta(x)$ 被近似为在节点 $j_0$ 处的一个集中源，其值为 $1/\\Delta x$ 以保持其积分。对于内部节点 $j \\in \\{1, \\dots, N-1\\}$，离散化方程为：\n    $$\\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2} - \\frac{1}{\\lambda^2}V_j = -r_a I_0 \\frac{\\delta_{j, j_0}}{\\Delta x}$$\n    其中 $\\delta_{j, j_0}$ 是克罗内克（Kronecker）δ。这可以重新排列成一个线性方程组，形式为 $M\\mathbf{V} = \\mathbf{b}$，用于求解未知电位 $\\mathbf{V} = [V_1, \\dots, V_{N-1}]^T$。矩阵 $M$ 是一个大小为 $(N-1) \\times (N-1)$ 的对称三对角矩阵：\n    $$M_{i,i} = -\\left(\\frac{2}{(\\Delta x)^2} + \\frac{1}{\\lambda^2}\\right)$$\n    $$M_{i,i-1} = M_{i,i+1} = \\frac{1}{(\\Delta x)^2}$$\n    右侧向量 $\\mathbf{b}$ 除了对应于源位置 $x_{j_0}=0$ 的条目外，其他地方都为零。在未知向量 $\\mathbf{V}$ 中的索引是 $j_0-1=499$。\n    $$b_{j_0-1} = -\\frac{r_a I_0}{\\Delta x}$$\n    这个三对角系统可以被高效求解。然后，数值衰减比 $A_{\\mathrm{num}}(x_j)$ 计算为 $V_j/V_{j_0}$。\n\n5.  **误差计算**：对于每个测试用例，我们计算参数 $\\lambda$ 和 $r_a$，建立并求解线性系统以找到数值解向量 $\\mathbf{V}$。然后，我们在指定的距离 $x_k \\in \\{0, 0.5\\lambda, \\dots, 5\\lambda\\}$ 处评估 $A_{\\mathrm{num}}$ 和 $A_{\\mathrm{ana}}$。与这些距离相对应的索引是 $j_k=j_0+k\\lambda/\\Delta x = 500+50k$。在每个点计算绝对相对误差，并报告该集合中的最大值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the passive cable equation numerically for given biophysical parameters\n    and computes the maximum relative error compared to the analytical solution.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path\n        {'d': 2e-6, 'R_m': 1.0, 'R_i': 1.0, 'I_0': 1e-9},\n        # Case 2: thin cable edge case\n        {'d': 0.2e-6, 'R_m': 1.0, 'R_i': 1.0, 'I_0': 1e-9},\n        # Case 3: high membrane resistance\n        {'d': 2e-6, 'R_m': 2.0, 'R_i': 1.0, 'I_0': 1e-9},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        d = case['d']\n        R_m = case['R_m']\n        R_i = case['R_i']\n        I_0 = case['I_0']\n\n        # Step 1: Calculate physical parameters\n        # Axial resistance per unit length (Ohm/m)\n        r_a = (4 * R_i) / (np.pi * d**2)\n        # Membrane resistance per unit length (Ohm*m)\n        r_m = R_m / (np.pi * d)\n        # Length constant (m)\n        lambda_const = np.sqrt(r_m / r_a)\n\n        # Step 2: Set up numerical grid\n        L = 10 * lambda_const\n        dx = lambda_const / 50\n        N_intervals = int(round(2 * L / dx)) # Should be 1000\n        N_points = N_intervals + 1 # Should be 1001\n        \n        # Grid points for the unknowns (internal points)\n        num_unknowns = N_points - 2\n\n        # Index of the injection site (x=0)\n        j0 = N_intervals // 2\n\n        # Step 3: Construct the linear system M*V = b\n        # M is a tridiagonal matrix.\n        # Diagonal elements: -(2/dx^2 + 1/lambda^2)\n        # Off-diagonal elements: 1/dx^2\n        \n        c1 = 1 / dx**2\n        c2 = -(2 / dx**2 + 1 / lambda_const**2)\n        \n        # Using scipy.linalg.solve_banded which takes a matrix of diagonals.\n        # The matrix 'ab' has 3 rows:\n        # row 0: upper diagonal (shifted)\n        # row 1: main diagonal\n        # row 2: lower diagonal\n        ab = np.zeros((3, num_unknowns))\n        ab[0, 1:] = c1   # Upper diagonal\n        ab[1, :] = c2    # Main diagonal\n        ab[2, :-1] = c1  # Lower diagonal\n\n        # Construct the RHS vector b\n        b = np.zeros(num_unknowns)\n        # The source term is at index j0-1 in the unknowns vector\n        source_idx = j0 - 1\n        b[source_idx] = -r_a * I_0 / dx\n\n        # Step 4: Solve the system\n        V_internal = solve_banded((1, 1), ab, b)\n        \n        # Construct the full solution vector including boundaries\n        V_num_full = np.zeros(N_points)\n        V_num_full[1:-1] = V_internal\n        \n        # Step 5: Calculate attenuation and error\n        V_center = V_num_full[j0]\n        \n        if V_center == 0:\n            results.append(float('inf'))\n            continue\n\n        A_num_at_center = V_num_full / V_center\n        \n        # Evaluation distances in units of lambda\n        eval_distances_lambda = np.array([0, 0.5, 1, 2, 3, 5])\n        \n        # Corresponding grid indices\n        eval_indices = (j0 + np.round(eval_distances_lambda * lambda_const / dx)).astype(int)\n        \n        # Analytical attenuation\n        A_ana = np.exp(-eval_distances_lambda)\n        \n        # Numerical attenuation at evaluation points\n        A_num = A_num_at_center[eval_indices]\n        \n        relative_errors = np.abs(A_num - A_ana) / np.abs(A_ana)\n        \n        max_relative_error = np.max(relative_errors)\n        results.append(max_relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}