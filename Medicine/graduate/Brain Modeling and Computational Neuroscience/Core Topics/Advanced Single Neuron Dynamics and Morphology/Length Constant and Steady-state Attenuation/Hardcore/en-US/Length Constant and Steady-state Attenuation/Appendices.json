{
    "hands_on_practices": [
        {
            "introduction": "The foundation for understanding signal propagation in neurons is the passive cable model. This first exercise walks you through the derivation of the steady-state voltage profile in an idealized, infinitely long dendrite. By solving the cable equation and calculating the distance at which the voltage drops by half , you will develop a concrete, intuitive grasp of the length constant, $\\lambda$, and its central role in dictating spatial decay.",
            "id": "3994040",
            "problem": "Consider a uniform, passive, cylindrical dendritic cable of radius $a$ that extends from $x=0$ to $x=\\infty$ and is bathed in a homogeneous medium. The membrane is characterized by a membrane resistance per unit area $R_{m}$ and a membrane capacitance per unit area $C_{m}$. The intracellular medium has axial resistivity $R_{i}$. At steady state under a constant voltage clamp applied at $x=0$, the capacitive current is zero, and the only transmembrane current is the resistive leak. Assume the clamp enforces $V(0)=V_{0}$ and the cable is otherwise unforced.\n\nStarting from conservation of current and Ohmâ€™s law applied to the distributed cable, derive the steady-state voltage profile $V(x)$ for $x\\geq 0$ and identify the length constant $\\lambda$ in terms of the biophysical parameters. Then, define the half-distance $x_{1/2}$ as the position at which the ratio $V(x)/V(0)$ equals $0.5$ at steady state, and derive an exact expression for $x_{1/2}$ in terms of $\\lambda$. Finally, express the dimensionless ratio $x_{1/2}/\\lambda$ as a single number, and provide its value rounded to four significant figures. No physical unit is required for this final ratio, and angles are not involved.",
            "solution": "The user has requested a solution to a problem concerning steady-state voltage attenuation in a passive dendritic cable.\n\nFirst, we perform a validation of the problem statement.\n\n### Step 1: Extract Givens\n-   **System**: A uniform, passive, cylindrical dendritic cable.\n-   **Geometry**: Radius $a$.\n-   **Domain**: Extends from $x=0$ to $x=\\infty$.\n-   **Environment**: Bathed in a homogeneous medium.\n-   **Membrane Biophysics**: Membrane resistance per unit area $R_{m}$, membrane capacitance per unit area $C_{m}$.\n-   **Intracellular Biophysics**: Axial resistivity $R_{i}$.\n-   **State**: Steady state under a constant voltage clamp.\n-   **Condition 1**: The capacitive current is zero.\n-   **Condition 2**: The only transmembrane current is the resistive leak.\n-   **Boundary Condition at $x=0$**: $V(0)=V_{0}$.\n-   **Boundary Condition at $x=\\infty$**: The cable is \"otherwise unforced,\" implying the voltage must decay to the resting potential. Without loss of generality, we set the resting potential to $0$, so $V(x) \\to 0$ as $x \\to \\infty$.\n-   **Definition**: The half-distance $x_{1/2}$ is the position where the ratio $V(x_{1/2})/V(0)$ equals $0.5$.\n-   **Tasks**:\n    1.  Derive the steady-state voltage profile $V(x)$ for $x \\geq 0$.\n    2.  Identify the length constant $\\lambda$ in terms of the biophysical parameters.\n    3.  Derive an exact expression for $x_{1/2}$ in terms of $\\lambda$.\n    4.  Express the dimensionless ratio $x_{1/2}/\\lambda$ as a single number, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the classical cable theory developed by Rall, Hodgkin, and Huxley, which is a fundamental part of computational neuroscience. The problem is well-posed, providing a second-order linear ordinary differential equation with two well-defined boundary conditions, guaranteeing a unique and stable solution. The language is objective and precise. The premises are not contradictory; the mention of $C_m$ is contextual for the general cable equation, and its irrelevance at steady state is a key part of the problem's setup, not a flaw. The problem is not trivial, requiring a standard but substantive derivation.\n\n### Step 3: Verdict and Action\nThe problem is valid. We will proceed to the solution.\n\nThe derivation begins with the general cable equation, which relates the spatial distribution of voltage $V(x, t)$ along the cable to the flow of current. We consider a small cylindrical segment of the cable of length $\\Delta x$.\n\nThe intracellular (axial) resistance per unit length, $r_i$, is given by the bulk resistivity $R_i$ divided by the cross-sectional area of the cylinder, $A = \\pi a^2$.\n$$r_i = \\frac{R_i}{\\pi a^{2}}$$\nThe units are $\\Omega/m$.\n\nThe membrane resistance for a unit length of the cable, $r_m$, is given by the specific membrane resistance $R_m$ divided by the circumference of the cylinder, $2\\pi a$.\n$$r_m = \\frac{R_m}{2\\pi a}$$\nThe units are $\\Omega \\cdot m$.\n\nAccording to Ohm's law applied to the axial current $I_i$, the spatial change in voltage is related to the axial current by:\n$$-\\frac{\\partial V}{\\partial x} = I_i r_i$$\n\nConservation of current dictates that the change in axial current along the segment must be equal to the current leaving through the membrane, $i_m$, per unit length.\n$$-\\frac{\\partial I_i}{\\partial x} = i_m$$\n\nCombining these two equations by differentiating the first with respect to $x$ and substituting the second gives:\n$$\\frac{\\partial^2 V}{\\partial x^2} = r_i \\frac{\\partial I_i}{\\partial x} = -r_i (-i_m) = r_i i_m$$\n\nThe membrane current per unit length, $i_m$, has two components: a resistive (leak) component $i_r$ and a capacitive component $i_c$.\n$$i_m = i_r + i_c = \\frac{V}{r_m} + c_m \\frac{\\partial V}{\\partial t}$$\nwhere $c_m = C_m (2\\pi a)$ is the capacitance per unit length. The problem states we are at steady state with a constant voltage clamp. At steady state, the voltage does not change with time, so $\\frac{\\partial V}{\\partial t} = 0$. This implies the capacitive current $i_c$ is zero, which is explicitly stated in the problem. Therefore, the membrane current is purely resistive: $i_m = V/r_m$.\n\nThe steady-state cable equation becomes:\n$$\\frac{d^2 V}{dx^2} = r_i \\left(\\frac{V}{r_m}\\right) = \\frac{r_i}{r_m} V$$\nThis is a second-order, linear, homogeneous ordinary differential equation. We define the space or length constant, $\\lambda$, as:\n$$\\lambda^2 = \\frac{r_m}{r_i}$$\nSubstituting the expressions for $r_m$ and $r_i$ in terms of the biophysical parameters $R_m$, $R_i$, and $a$:\n$$\\lambda^2 = \\frac{R_m / (2\\pi a)}{R_i / (\\pi a^2)} = \\frac{R_m}{2\\pi a} \\frac{\\pi a^2}{R_i} = \\frac{a R_m}{2 R_i}$$\nThus, the length constant is:\n$$\\lambda = \\sqrt{\\frac{a R_m}{2 R_i}}$$\n\nWith this definition, the steady-state cable equation simplifies to:\n$$\\frac{d^2 V}{dx^2} - \\frac{1}{\\lambda^2} V = 0$$\nThe general solution to this equation is:\n$$V(x) = A \\exp(x/\\lambda) + B \\exp(-x/\\lambda)$$\nwhere $A$ and $B$ are constants determined by the boundary conditions.\n\nWe apply the given boundary conditions:\n1.  At $x=0$, the voltage is clamped to $V_0$: $V(0) = V_0$.\n2.  For a passive cable extending to $x=\\infty$, the voltage must remain physically bounded. As $x \\to \\infty$, the term $\\exp(x/\\lambda)$ grows without bound. For $V(x)$ to be finite, its coefficient $A$ must be zero. So, $A = 0$.\n\nWith $A=0$, the solution simplifies to $V(x) = B \\exp(-x/\\lambda)$. Applying the first boundary condition:\n$$V(0) = B \\exp(0) = B = V_0$$\nTherefore, the steady-state voltage profile for the semi-infinite cable is:\n$$V(x) = V_0 \\exp(-x/\\lambda)$$\n\nNext, we address the half-distance, $x_{1/2}$. It is defined as the position where the voltage attenuates to half of its value at $x=0$.\n$$\\frac{V(x_{1/2})}{V(0)} = 0.5$$\nSubstituting our solution for $V(x)$:\n$$\\frac{V_0 \\exp(-x_{1/2}/\\lambda)}{V_0} = 0.5$$\n$$\\exp(-x_{1/2}/\\lambda) = 0.5$$\nTo solve for $x_{1/2}$, we take the natural logarithm of both sides:\n$$\\ln(\\exp(-x_{1/2}/\\lambda)) = \\ln(0.5)$$\n$$- \\frac{x_{1/2}}{\\lambda} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)$$\nMultiplying by $-\\lambda$, we find the exact expression for $x_{1/2}$ in terms of $\\lambda$:\n$$x_{1/2} = \\lambda \\ln(2)$$\n\nFinally, we are asked for the dimensionless ratio $x_{1/2}/\\lambda$. From the equation above, this is simply:\n$$\\frac{x_{1/2}}{\\lambda} = \\ln(2)$$\nThe value of this ratio, rounded to four significant figures, is:\n$$\\ln(2) \\approx 0.69314718... \\approx 0.6931$$",
            "answer": "$$\\boxed{0.6931}$$"
        },
        {
            "introduction": "Real-world neurons have finite dendritic trees, and what happens at the end of a branch can profoundly affect signal integration. This practice moves beyond the infinite cable approximation to explore the impact of two different, physically relevant boundary conditions: the \"sealed end\" and the \"killed end\". By deriving and comparing the voltage attenuation in a finite cable for both scenarios , you will see how dendritic termination dictates the efficacy of synaptic transmission.",
            "id": "3994117",
            "problem": "Consider a single, straight, passive dendritic cable of uniform properties attached to a soma at position $x=0$. The cable has physical length $L$ and passive length constant $\\lambda$, with $L=3\\lambda$. Assume linear membrane dynamics and steady state (time-invariant) conditions. The soma is maintained at a fixed depolarization $V(0)=V_{s}$ relative to rest. The distal end at $x=L$ is considered under two alternative boundary conditions that are standard in cable theory: (i) a sealed end, meaning no axial current flows out of the end, and (ii) a killed end, meaning the voltage at the end is constrained to the resting potential.\n\nStarting from the defining relations of membrane current and axial current that lead to the steady-state linear cable description, derive the steady-state voltage profile $V(x)$ along the cable for each boundary condition and compute the attenuation from soma to distal end, defined as the dimensionless ratio $A = \\frac{V(L)}{V(0)}$, for both the sealed-end and killed-end cases. Use $L=3\\lambda$. Round your numerical answers to four significant figures. Provide the values of $A$ without units.\n\nFinally, briefly explain, based on your derivation, why the two boundary conditions produce different attenuations from soma to the distal end under steady-state conditions.",
            "solution": "The problem requires the derivation of the steady-state voltage profile $V(x)$ for a passive dendritic cable under two different boundary conditions and the calculation of the voltage attenuation from the soma to the distal end.\n\nThe starting point is the steady-state passive cable equation. In a passive cable, the change in axial current $I_a$ along an infinitesimal length $dx$ must be balanced by the current flowing across the membrane per unit length, $i_m$. By convention, outward membrane current is positive.\n$$\n\\frac{dI_a}{dx} = -i_m\n$$\nIn the steady-state, the membrane current consists only of the leak current, as the capacitive current ($c_m \\frac{dV}{dt}$) is zero. The leak current is given by Ohm's law, $i_m = \\frac{V}{r_m}$, where $V$ is the voltage relative to the resting potential and $r_m$ is the membrane resistance per unit length. The axial current is driven by the voltage gradient according to Ohm's law, $I_a = -\\frac{1}{r_a} \\frac{dV}{dx}$, where $r_a$ is the axial resistance per unit length.\n\nSubstituting these expressions into the conservation of current equation gives:\n$$\n\\frac{d}{dx} \\left(-\\frac{1}{r_a} \\frac{dV}{dx}\\right) = -\\frac{V}{r_m}\n$$\nFor a uniform cable, $r_a$ and $r_m$ are constant, leading to the second-order linear ordinary differential equation:\n$$\n\\frac{d^2V}{dx^2} = \\frac{r_a}{r_m} V\n$$\nWe define the passive length constant $\\lambda = \\sqrt{\\frac{r_m}{r_a}}$. The equation becomes:\n$$\n\\lambda^2 \\frac{d^2V}{dx^2} - V = 0\n$$\nThis is the steady-state linear cable equation. The general solution to this equation can be expressed in terms of exponential or hyperbolic functions. The hyperbolic form is often more convenient for applying boundary conditions:\n$$\nV(x) = C_1 \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\nwhere $C_1$ and $C_2$ are constants determined by the boundary conditions.\n\nThe boundary condition at the soma ($x=0$) is given as $V(0) = V_s$. Applying this to the general solution:\n$$\nV(0) = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1 \\cdot 1 + C_2 \\cdot 0 = C_1\n$$\nThus, $C_1 = V_s$, and the solution takes the form:\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\nWe now solve for $C_2$ and find the specific voltage profile for each of the two distal boundary conditions.\n\n### Case (i): Sealed-End Boundary Condition\n\nThe sealed-end condition at $x=L$ implies that no axial current flows out of the end of the cable.\n$$\nI_a(L) = -\\frac{1}{r_a}\\left.\\frac{dV}{dx}\\right|_{x=L} = 0 \\implies \\left.\\frac{dV}{dx}\\right|_{x=L} = 0\n$$\nFirst, we find the derivative of $V(x)$:\n$$\n\\frac{dV}{dx} = \\frac{V_s}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{C_2}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right)\n$$\nApplying the sealed-end condition at $x=L$:\n$$\n\\frac{V_s}{\\lambda} \\sinh\\left(\\frac{L}{\\lambda}\\right) + \\frac{C_2}{\\lambda} \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n$$\nC_2 = -V_s \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} = -V_s \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\nSubstituting $C_1$ and $C_2$ back into the solution for $V(x)$:\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) - V_s \\tanh\\left(\\frac{L}{\\lambda}\\right) \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\nThis can be simplified using the definition of $\\tanh$ and a hyperbolic identity:\n$$\nV(x) = V_s \\left[ \\cosh\\left(\\frac{x}{\\lambda}\\right) - \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} \\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n$$\nV(x) = \\frac{V_s}{\\cosh(L/\\lambda)} \\left[ \\cosh\\left(\\frac{L}{\\lambda}\\right)\\cosh\\left(\\frac{x}{\\lambda}\\right) - \\sinh\\left(\\frac{L}{\\lambda}\\right)\\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\nUsing the identity $\\cosh(A-B) = \\cosh(A)\\cosh(B) - \\sinh(A)\\sinh(B)$, we get the final voltage profile for the sealed-end case:\n$$\nV_{\\text{sealed}}(x) = V_s \\frac{\\cosh\\left(\\frac{L-x}{\\lambda}\\right)}{\\cosh\\left(\\frac{L}{\\lambda}\\right)}\n$$\nThe attenuation is $A = \\frac{V(L)}{V(0)}$. Here, $V(0) = V_s$.\n$$\nV(L) = V_s \\frac{\\cosh\\left(\\frac{L-L}{\\lambda}\\right)}{\\cosh\\left(\\frac{L}{\\lambda}\\right)} = V_s \\frac{\\cosh(0)}{\\cosh(L/\\lambda)} = \\frac{V_s}{\\cosh(L/\\lambda)}\n$$\nSo the attenuation for the sealed-end case is:\n$$\nA_{\\text{sealed}} = \\frac{V(L)}{V(0)} = \\frac{1}{\\cosh(L/\\lambda)}\n$$\nGiven $L = 3\\lambda$, we have $L/\\lambda = 3$.\n$$\nA_{\\text{sealed}} = \\frac{1}{\\cosh(3)} = \\frac{1}{(\\exp(3) + \\exp(-3))/2} \\approx \\frac{1}{10.06766} \\approx 0.0993279\n$$\nRounding to four significant figures, $A_{\\text{sealed}} \\approx 0.09933$.\n\n### Case (ii): Killed-End Boundary Condition\n\nThe killed-end condition at $x=L$ means the voltage is fixed at the resting potential, so $V(L) = 0$.\nStarting again from $V(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{x}{\\lambda}\\right)$, we apply this condition:\n$$\nV(L) = V_s \\cosh\\left(\\frac{L}{\\lambda}\\right) + C_2 \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nSolving for $C_2$:\n$$\nC_2 = -V_s \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} = -V_s \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\nSubstituting $C_1$ and $C_2$ back into the solution for $V(x)$:\n$$\nV(x) = V_s \\cosh\\left(\\frac{x}{\\lambda}\\right) - V_s \\coth\\left(\\frac{L}{\\lambda}\\right) \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\nSimilarly, we simplify this expression:\n$$\nV(x) = V_s \\left[ \\cosh\\left(\\frac{x}{\\lambda}\\right) - \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} \\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\n$$\nV(x) = \\frac{V_s}{\\sinh(L/\\lambda)} \\left[ \\sinh\\left(\\frac{L}{\\lambda}\\right)\\cosh\\left(\\frac{x}{\\lambda}\\right) - \\cosh\\left(\\frac{L}{\\lambda}\\right)\\sinh\\left(\\frac{x}{\\lambda}\\right) \\right]\n$$\nUsing the identity $\\sinh(A-B) = \\sinh(A)\\cosh(B) - \\cosh(A)\\sinh(B)$, we get the final voltage profile for the killed-end case:\n$$\nV_{\\text{killed}}(x) = V_s \\frac{\\sinh\\left(\\frac{L-x}{\\lambda}\\right)}{\\sinh\\left(\\frac{L}{\\lambda}\\right)}\n$$\nThe attenuation is $A = \\frac{V(L)}{V(0)}$. Here, $V(0) = V_s$. The voltage at the distal end, $V(L)$, is zero by the definition of the boundary condition. We can also verify this from the derived profile:\n$$\nV(L) = V_s \\frac{\\sinh\\left(\\frac{L-L}{\\lambda}\\right)}{\\sinh\\left(\\frac{L}{\\lambda}\\right)} = V_s \\frac{\\sinh(0)}{\\sinh(L/\\lambda)} = 0\n$$\nTherefore, the attenuation for the killed-end case is:\n$$\nA_{\\text{killed}} = \\frac{0}{V_s} = 0\n$$\n\n### Explanation of the Difference in Attenuation\n\nThe attenuation from soma to distal end is fundamentally different between the two cases because the boundary condition at the distal end ($x=L$) dictates the fate of the axial current arriving there.\n1.  **Sealed End**: The condition $\\frac{dV}{dx}|_{x=L}=0$ means that there is no path for the axial current to flow out of the cable. This is analogous to an open circuit. The charge carried by the current accumulates at the distal end, causing the voltage $V(L)$ to build up to a non-zero value, $V_s/\\cosh(L/\\lambda)$. This build-up reduces the voltage gradient near the end, eventually halting the flow of current at the terminus. Consequently, the attenuation is finite and less severe.\n2.  **Killed End**: The condition $V(L)=0$ enforces that the distal end is held at the resting potential. This acts as a short circuit to ground, providing an infinite sink for current. Any axial current that reaches the end of the cable flows out, preventing any charge accumulation and pinning the voltage at zero. This continuous drain of charge results in a steeper voltage gradient along the entire cable compared to the sealed case, and by definition, the voltage at the end is zero. This leads to a total attenuation of the signal at the distal end, meaning $A_{\\text{killed}}=0$.\n\nIn summary, the mathematical form of the solution $V(x)$ is directly shaped by the physical constraints imposed at the boundaries. A sealed end allows voltage to build up, whereas a killed end shunts it to zero, leading to the observed differences in attenuation.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.09933 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While analytical derivations are powerful, much of modern computational neuroscience relies on numerical simulations to explore biologically realistic scenarios. This final practice bridges theory and computation by tasking you with building a simulation of a passive cable using the finite difference method . By comparing your numerical results against the exact analytical solution, you will not only reinforce your understanding of voltage attenuation but also gain practical skills in the methods used to model neural behavior.",
            "id": "3994042",
            "problem": "Consider a one-dimensional, cylindrical, passive neuronal cable with uniform properties along its axis. The cable has specific membrane resistance per unit area $R_m$ (in $\\Omega\\cdot\\mathrm{m}^2$), specific axial resistivity $R_i$ (in $\\Omega\\cdot\\mathrm{m}$), and diameter $d$ (in $\\mathrm{m}$). Let $x$ denote the axial position (in $\\mathrm{m}$), and let $V(x)$ denote the steady-state transmembrane potential (in $\\mathrm{V}$) relative to a far-away reference. The cable is stimulated by a Direct Current (DC) point injection of amplitude $I_0$ (in $\\mathrm{A}$) at position $x=0$. Assume an effectively infinite cable, so that the potential vanishes at large $|x|$.\n\nStarting from Kirchhoff's current law and Ohm's law applied to an infinitesimal cylindrical cable segment, the axial current per unit length and the leak current per unit length must balance, together with any sources. Using the geometric relationships for a cylinder, the membrane resistance per unit length $r_m$ (in $\\Omega\\cdot\\mathrm{m}$) and axial resistance per unit length $r_a$ (in $\\Omega/\\mathrm{m}$) can be expressed in terms of $R_m$, $R_i$, and $d$ by standard biophysical relationships. Your task is to:\n- Derive the steady-state differential equation governing $V(x)$ given a point current source at $x=0$.\n- Show how the length constant $\\lambda$ (in $\\mathrm{m}$) arises from these parameters.\n- Numerically solve the steady-state equation on a finite domain approximation $x\\in[-L,L]$ with homogeneous Dirichlet boundary conditions $V(-L)=0$ and $V(L)=0$, where $L$ is chosen as a fixed multiple of the length constant.\n- Use a consistent discretization of the spatial second derivative by central differences on a uniform grid with spacing $\\Delta x$.\n- Approximate the point source at $x=0$ on the grid as a concentrated source at the nearest grid node, scaled so that its integral over space equals $I_0$.\n\nFrom the numerical solution, compute the attenuation ratio $A(x)=V(x)/V(0)$ at a set of specified distances from the injection site and compare it to the closed-form solution that follows from the derived steady-state differential equation and your computed length constant $\\lambda$. Report, for each parameter set, the maximum absolute relative error between the numerical attenuation ratio and the analytic attenuation ratio over the specified distances. The absolute relative error at position $x$ is defined as $\\left|A_{\\mathrm{num}}(x)-A_{\\mathrm{ana}}(x)\\right|/\\left|A_{\\mathrm{ana}}(x)\\right|$.\n\nImplementation requirements:\n- Use a uniform grid with $L=10\\,\\lambda$ and $\\Delta x=\\lambda/50$ for all test cases.\n- The distances at which to evaluate the attenuation ratio are $\\{0,\\;0.5\\,\\lambda,\\;1\\,\\lambda,\\;2\\,\\lambda,\\;3\\,\\lambda,\\;5\\,\\lambda\\}$.\n- Express all lengths in $\\mathrm{m}$, resistances in $\\Omega\\cdot\\mathrm{m}^2$ and $\\Omega\\cdot\\mathrm{m}$, current in $\\mathrm{A}$, and voltage in $\\mathrm{V}$.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_k$ is the maximum absolute relative error (a floating-point number) for test case $k$.\n\nTest suite:\n- Case 1 (happy path): $d=2\\times 10^{-6}\\,\\mathrm{m}$, $R_m=1.0\\,\\Omega\\cdot\\mathrm{m}^2$, $R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$, $I_0=1\\times 10^{-9}\\,\\mathrm{A}$.\n- Case 2 (thin cable edge case): $d=0.2\\times 10^{-6}\\,\\mathrm{m}$, $R_m=1.0\\,\\Omega\\cdot\\mathrm{m}^2$, $R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$, $I_0=1\\times 10^{-9}\\,\\mathrm{A}$.\n- Case 3 (high membrane resistance): $d=2\\times 10^{-6}\\,\\mathrm{m}$, $R_m=2.0\\,\\Omega\\cdot\\mathrm{m}^2$, $R_i=1.0\\,\\Omega\\cdot\\mathrm{m}$, $I_0=1\\times 10^{-9}\\,\\mathrm{A}$.\n\nYour program should compute, for each case, the numerical attenuation ratio on the prescribed grid, compute the analytic attenuation ratio implied by your derived equation and computed $\\lambda$, and report the maximum absolute relative error over the set of distances $\\{0,\\;0.5\\,\\lambda,\\;1\\,\\lambda,\\;2\\,\\lambda,\\;3\\,\\lambda,\\;5\\,\\lambda\\}$. The final output must be a single line in the format $[r_1,r_2,r_3]$ with the three floating-point values.",
            "solution": "The problem requires the derivation and numerical solution of the steady-state cable equation for a passive, one-dimensional neuronal dendrite, followed by a comparison with the analytical solution. The validation of the problem statement precedes any attempt at a solution.\n\n### Problem Validation\n\nFirst, we extract the givens from the problem statement.\n*   **Physical Parameters**: Specific membrane resistance per unit area $R_m$ ($\\Omega\\cdot\\mathrm{m}^2$), specific axial resistivity $R_i$ ($\\Omega\\cdot\\mathrm{m}$), and cable diameter $d$ ($\\mathrm{m}$).\n*   **Variables**: Axial position $x$ ($\\mathrm{m}$), steady-state transmembrane potential $V(x)$ ($\\mathrm{V}$).\n*   **Source**: A direct current (DC) point injection of amplitude $I_0$ ($\\mathrm{A}$) at $x=0$.\n*   **Boundary Condition (Analytical)**: Infinite cable, $V(x) \\to 0$ as $|x| \\to \\infty$.\n*   **Intermediate Parameters**: Membrane resistance per unit length $r_m$ ($\\Omega\\cdot\\mathrm{m}$) and axial resistance per unit length $r_a$ ($\\Omega/\\mathrm{m}$). Length constant $\\lambda$ ($\\mathrm{m}$).\n*   **Numerical Setup**:\n    *   Domain: A finite approximation $x \\in [-L, L]$ with $L = 10\\lambda$.\n    *   Grid: Uniform with spacing $\\Delta x = \\lambda/50$.\n    *   Boundary Conditions (Numerical): Homogeneous Dirichlet, $V(-L)=0$ and $V(L)=0$.\n    *   Discretization: Central differences for the second spatial derivative.\n    *   Source Approximation: A concentrated source at the grid node nearest $x=0$, scaled such that its spatial integral equals $I_0$.\n*   **Analysis**:\n    *   The primary quantity of interest is the attenuation ratio $A(x) = V(x)/V(0)$.\n    *   Evaluation points for error analysis are $\\{0, 0.5\\lambda, 1\\lambda, 2\\lambda, 3\\lambda, 5\\lambda\\}$.\n    *   The performance metric is the maximum absolute relative error between the numerical and analytical attenuation ratios: $\\max_x |\\frac{A_{\\mathrm{num}}(x) - A_{\\mathrm{ana}}(x)}{A_{\\mathrm{ana}}(x)}|$.\n*   **Test Cases**: Three sets of parameters for $(d, R_m, R_i, I_0)$ are provided.\n\nThe problem is scientifically grounded, being a canonical example from biophysics and computational neuroscience. It is well-posed, objective, and self-contained, providing all necessary parameters and specifications for a unique solution and a clear path for its numerical approximation and validation. The parameters are physically plausible. The task is neither trivial nor ill-defined. Therefore, the problem is deemed **valid**.\n\n### Theoretical Derivation and Solution Strategy\n\nWe begin by deriving the governing differential equation from first principles. Consider an infinitesimal segment of the cable of length $\\Delta x$.\n\n1.  **Parameter Derivation**: The resistances per unit length, $r_a$ and $r_m$, are derived from the specific resistances and cylindrical geometry. The axial resistance per unit length, $r_a$, is the specific axial resistivity $R_i$ divided by the cross-sectional area $A = \\pi (d/2)^2$.\n    $$r_a = \\frac{R_i}{A} = \\frac{4 R_i}{\\pi d^2} \\quad [\\Omega/\\mathrm{m}]$$\n    The membrane resistance per unit length, $r_m$, is the specific membrane resistance $R_m$ divided by the circumference $\\pi d$. This gives the resistance-length product.\n    $$r_m = \\frac{R_m}{\\pi d} \\quad [\\Omega\\cdot\\mathrm{m}]$$\n\n2.  **Governing Equation**: According to Kirchhoff's current law, the change in axial current, $I_a(x)$, along the segment must balance the current leaking across the membrane, $i_m(x)$, per unit length. In steady-state, $-\\frac{dI_a}{dx} = i_m$. Ohm's law relates the voltage gradient to the axial current: $-\\frac{dV}{dx} = I_a r_a$. Differentiating this with respect to $x$ gives $\\frac{d^2V}{dx^2} = -r_a \\frac{dI_a}{dx}$. Substituting the Kirchhoff relation yields $\\frac{d^2V}{dx^2} = r_a i_m$. The membrane leak current per unit length is given by Ohm's law as $i_m = V/r_m$. Thus, we obtain the homogeneous steady-state cable equation:\n    $$\\frac{d^2V}{dx^2} = \\frac{r_a}{r_m} V$$\n    We define the length constant $\\lambda$ as:\n    $$\\lambda = \\sqrt{\\frac{r_m}{r_a}} = \\sqrt{\\frac{R_m/(\\pi d)}{4 R_i/(\\pi d^2)}} = \\sqrt{\\frac{R_m d}{4 R_i}} \\quad [\\mathrm{m}]$$\n    The equation becomes $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$. When a point current $I_0$ is injected at $x=0$, it acts as a source term, represented by a Dirac delta function, $I_0 \\delta(x)$. The full inhomogeneous equation is:\n    $$\\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V = -r_a I_0 \\delta(x)$$\n\n3.  **Analytical Solution**: For an infinitely long cable where $V(x) \\to 0$ as $|x| \\to \\infty$, the solution to the homogeneous equation for $x \\neq 0$ is $V(x) = C e^{-|x|/\\lambda}$. The constant $C$ is found by integrating the full equation across $x=0$, which yields a jump condition on the derivative: $\\frac{dV}{dx}|_{0^+} - \\frac{dV}{dx}|_{0^-} = -r_a I_0$. Applying this to the solution form gives $C = \\frac{r_a \\lambda I_0}{2}$. The analytical solution is:\n    $$V_{\\mathrm{ana}}(x) = \\frac{r_a \\lambda I_0}{2} e^{-|x|/\\lambda}$$\n    The analytical attenuation ratio $A_{\\mathrm{ana}}(x) = V_{\\mathrm{ana}}(x) / V_{\\mathrm{ana}}(0)$ is therefore:\n    $$A_{\\mathrm{ana}}(x) = e^{-|x|/\\lambda}$$\n\n4.  **Numerical Method**: We solve the equation on a finite domain $[-L, L]$ with $L=10\\lambda$ and boundary conditions $V(\\pm L) = 0$. A uniform grid $x_j = -L + j\\Delta x$ is defined with $\\Delta x = \\lambda/50$. The number of intervals is $N = 2L/\\Delta x = 1000$, resulting in $N+1=1001$ grid points indexed $j=0, \\dots, N$. The central node corresponding to $x=0$ is at index $j_0 = N/2 = 500$.\n\n    The second derivative is approximated using a three-point central difference stencil: $\\frac{d^2V}{dx^2}|_{x_j} \\approx \\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2}$. The Dirac delta function $\\delta(x)$ is approximated as a concentrated source at node $j_0$, with value $1/\\Delta x$ to preserve its integral. The discretized equation for an interior node $j \\in \\{1, \\dots, N-1\\}$ is:\n    $$\\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2} - \\frac{1}{\\lambda^2}V_j = -r_a I_0 \\frac{\\delta_{j, j_0}}{\\Delta x}$$\n    where $\\delta_{j, j_0}$ is the Kronecker delta. This can be rearranged into a system of linear equations of the form $M\\mathbf{V} = \\mathbf{b}$ for the unknown potentials $\\mathbf{V} = [V_1, \\dots, V_{N-1}]^T$. The matrix $M$ is a symmetric tridiagonal matrix of size $(N-1) \\times (N-1)$:\n    $$M_{i,i} = -\\left(\\frac{2}{(\\Delta x)^2} + \\frac{1}{\\lambda^2}\\right)$$\n    $$M_{i,i-1} = M_{i,i+1} = \\frac{1}{(\\Delta x)^2}$$\n    The right-hand side vector $\\mathbf{b}$ is zero everywhere except for the entry corresponding to the source location $x_{j_0}=0$. The index in the unknown vector $\\mathbf{V}$ is $j_0-1=499$.\n    $$b_{j_0-1} = -\\frac{r_a I_0}{\\Delta x}$$\n    This tridiagonal system is efficiently solved. The numerical attenuation ratio $A_{\\mathrm{num}}(x_j)$ is then computed as $V_j/V_{j_0}$.\n\n5.  **Error Calculation**: For each test case, we compute the parameters $\\lambda$ and $r_a$, set up and solve the linear system to find the numerical solution vector $\\mathbf{V}$. We then evaluate both $A_{\\mathrm{num}}$ and $A_{\\mathrm{ana}}$ at the specified distances $x_k \\in \\{0, 0.5\\lambda, \\dots, 5\\lambda\\}$. The indices corresponding to these distances are $j_k=j_0+k\\lambda/\\Delta x = 500+50k$. The absolute relative error is calculated at each point, and the maximum value over the set is reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the passive cable equation numerically for given biophysical parameters\n    and computes the maximum relative error compared to the analytical solution.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path\n        {'d': 2e-6, 'R_m': 1.0, 'R_i': 1.0, 'I_0': 1e-9},\n        # Case 2: thin cable edge case\n        {'d': 0.2e-6, 'R_m': 1.0, 'R_i': 1.0, 'I_0': 1e-9},\n        # Case 3: high membrane resistance\n        {'d': 2e-6, 'R_m': 2.0, 'R_i': 1.0, 'I_0': 1e-9},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        d = case['d']\n        R_m = case['R_m']\n        R_i = case['R_i']\n        I_0 = case['I_0']\n\n        # Step 1: Calculate physical parameters\n        # Axial resistance per unit length (Ohm/m)\n        r_a = (4 * R_i) / (np.pi * d**2)\n        # Membrane resistance per unit length (Ohm*m)\n        r_m = R_m / (np.pi * d)\n        # Length constant (m)\n        lambda_const = np.sqrt(r_m / r_a)\n\n        # Step 2: Set up numerical grid\n        L = 10 * lambda_const\n        dx = lambda_const / 50\n        N_intervals = int(round(2 * L / dx)) # Should be 1000\n        N_points = N_intervals + 1 # Should be 1001\n        \n        # Grid points for the unknowns (internal points)\n        num_unknowns = N_points - 2\n\n        # Index of the injection site (x=0)\n        j0 = N_intervals // 2\n\n        # Step 3: Construct the linear system M*V = b\n        # M is a tridiagonal matrix.\n        # Diagonal elements: -(2/dx^2 + 1/lambda^2)\n        # Off-diagonal elements: 1/dx^2\n        \n        c1 = 1 / dx**2\n        c2 = -(2 / dx**2 + 1 / lambda_const**2)\n        \n        # Using scipy.linalg.solve_banded which takes a matrix of diagonals.\n        # The matrix 'ab' has 3 rows:\n        # row 0: upper diagonal (shifted)\n        # row 1: main diagonal\n        # row 2: lower diagonal\n        ab = np.zeros((3, num_unknowns))\n        ab[0, 1:] = c1   # Upper diagonal\n        ab[1, :] = c2    # Main diagonal\n        ab[2, :-1] = c1  # Lower diagonal\n\n        # Construct the RHS vector b\n        b = np.zeros(num_unknowns)\n        # The source term is at index j0-1 in the unknowns vector\n        source_idx = j0 - 1\n        b[source_idx] = -r_a * I_0 / dx\n\n        # Step 4: Solve the system\n        V_internal = solve_banded((1, 1), ab, b)\n        \n        # Construct the full solution vector including boundaries\n        V_num_full = np.zeros(N_points)\n        V_num_full[1:-1] = V_internal\n        \n        # Step 5: Calculate attenuation and error\n        V_center = V_num_full[j0]\n        \n        if V_center == 0:\n            # This should not happen with a valid setup.\n            # If it does, there's a problem with the simulation.\n            # For this problem, we can assume V_center will be non-zero.\n            results.append(float('inf'))\n            continue\n\n        A_num_at_center = V_num_full / V_center\n        \n        # Evaluation distances in units of lambda\n        eval_distances_lambda = np.array([0, 0.5, 1, 2, 3, 5])\n        \n        # Corresponding grid indices\n        eval_indices = (j0 + np.round(eval_distances_lambda * lambda_const / dx)).astype(int)\n        \n        # Analytical attenuation\n        A_ana = np.exp(-eval_distances_lambda)\n        \n        # Numerical attenuation at evaluation points\n        A_num = A_num_at_center[eval_indices]\n        \n        # Relative error calculation. Where A_ana is 0, the error is handled.\n        # Here A_ana = exp(-k) is never zero, so no division by zero issues.\n        # The point at k=0 (x=0) gives A_num=1, A_ana=1, so error is 0.\n        relative_errors = np.abs(A_num - A_ana) / np.abs(A_ana)\n        \n        max_relative_error = np.max(relative_errors)\n        results.append(max_relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}