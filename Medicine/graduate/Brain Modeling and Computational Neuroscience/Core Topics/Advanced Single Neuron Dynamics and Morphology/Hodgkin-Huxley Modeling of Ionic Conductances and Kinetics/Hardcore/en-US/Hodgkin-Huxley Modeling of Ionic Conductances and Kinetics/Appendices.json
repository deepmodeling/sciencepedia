{
    "hands_on_practices": [
        {
            "introduction": "Before modeling the full dynamics of an action potential, it is essential to master the core equations that determine ionic flow at any given moment. This first practice provides a \"snapshot\" of the neuron, with the membrane potential and gating variables frozen at a specific instant . By calculating the individual sodium and potassium currents, you will develop a concrete understanding of how maximal conductance, gating probabilities, and the electrochemical driving force combine to produce the currents that shape neuronal behavior.",
            "id": "3989427",
            "problem": "In the classical Hodgkin-Huxley (HH) framework for excitable membranes, ionic currents arise from ion-specific conductances modulated by activation and inactivation gating variables and driven by the electrochemical potential difference between the membrane potential and the ionâ€™s reversal potential. Consider a membrane patch at voltage $V=-20\\,\\text{mV}$ with sodium and potassium pathways characterized by maximal conductance densities $g_{\\text{Na}}=120\\,\\text{mS}/\\text{cm}^2$ and $g_{\\text{K}}=36\\,\\text{mS}/\\text{cm}^2$, and reversal potentials $E_{\\text{Na}}=50\\,\\text{mV}$ and $E_{\\text{K}}=-77\\,\\text{mV}$. The instantaneous gating variables are $m=0.9$ and $h=0.2$ for sodium, and $n=0.6$ for potassium. Assume the canonical HH gating architecture for sodium and potassium. Use the outward-positive current convention. Derive and compute the sodium current $I_{\\text{Na}}$ and the potassium current $I_{\\text{K}}$ at $V=-20\\,\\text{mV}$, interpret which current dominates in magnitude at this voltage, and then compute the net transmembrane ionic current density $I_{\\text{net}}=I_{\\text{Na}}+I_{\\text{K}}$. Express your final numeric answer for $I_{\\text{net}}$ in $\\mu\\text{A}/\\text{cm}^2$ and round to four significant figures.",
            "solution": "The core of the Hodgkin-Huxley model describes the ionic current density for a specific ion species $i$, denoted $I_i$, as the product of its conductance density $g_i$ and the electrochemical driving force $(V - E_i)$.\n$$I_i = g_i (V - E_i)$$\nThe conductance density $g_i$ is itself a product of the maximal conductance density $\\bar{g}_i$ and the probabilities of the channel gates being in a permissive state. Following the problem's notation and canonical gating architecture, the current densities for sodium ($I_{\\text{Na}}$) and potassium ($I_{\\text{K}}$) are given by:\n$$I_{\\text{Na}} = \\bar{g}_{\\text{Na}} m^3 h (V - E_{\\text{Na}})$$\n$$I_{\\text{K}} = \\bar{g}_{\\text{K}} n^4 (V - E_{\\text{K}})$$\nThe outward-positive convention specified means that a net outflow of positive charge from the cell is a positive current.\n\nFirst, we calculate the sodium current density, $I_{\\text{Na}}$. We substitute the provided values:\n-   Maximal sodium conductance density: $\\bar{g}_{\\text{Na}} = 120\\,\\text{mS}/\\text{cm}^2$\n-   Sodium activation gating variable: $m = 0.9$\n-   Sodium inactivation gating variable: $h = 0.2$\n-   Membrane potential: $V = -20\\,\\text{mV}$\n-   Sodium reversal potential: $E_{\\text{Na}} = 50\\,\\text{mV}$\n\nThe driving force for sodium is $(V - E_{\\text{Na}}) = (-20\\,\\text{mV} - 50\\,\\text{mV}) = -70\\,\\text{mV}$.\nThe gating term is $m^3h = (0.9)^3 \\times 0.2 = 0.729 \\times 0.2 = 0.1458$.\nThus, the sodium current density is:\n$$I_{\\text{Na}} = (120\\,\\text{mS}/\\text{cm}^2) \\times 0.1458 \\times (-70\\,\\text{mV})$$\nA product of millisiemens ($\\text{mS}$) and millivolts ($\\text{mV}$) results in microamperes ($\\mu\\text{A}$), so the current density will be in $\\mu\\text{A}/\\text{cm}^2$.\n$$I_{\\text{Na}} = 120 \\times 0.1458 \\times (-70) \\,\\mu\\text{A}/\\text{cm}^2 = -1224.72\\,\\mu\\text{A}/\\text{cm}^2$$\nThe negative sign indicates an inward current of positive sodium ions.\n\nNext, we calculate the potassium current density, $I_{\\text{K}}$. We substitute the provided values:\n-   Maximal potassium conductance density: $\\bar{g}_{\\text{K}} = 36\\,\\text{mS}/\\text{cm}^2$\n-   Potassium activation gating variable: $n = 0.6$\n-   Membrane potential: $V = -20\\,\\text{mV}$\n-   Potassium reversal potential: $E_{\\text{K}} = -77\\,\\text{mV}$\n\nThe driving force for potassium is $(V - E_{\\text{K}}) = (-20\\,\\text{mV} - (-77\\,\\text{mV})) = 57\\,\\text{mV}$.\nThe gating term is $n^4 = (0.6)^4 = 0.1296$.\nThus, the potassium current density is:\n$$I_{\\text{K}} = (36\\,\\text{mS}/\\text{cm}^2) \\times 0.1296 \\times (57\\,\\text{mV})$$\n$$I_{\\text{K}} = 36 \\times 0.1296 \\times 57 \\,\\mu\\text{A}/\\text{cm}^2 = 265.9472\\,\\mu\\text{A}/\\text{cm}^2$$\nThe positive sign indicates an outward current of positive potassium ions.\n\nTo interpret which current dominates, we compare their magnitudes:\n$$|I_{\\text{Na}}| = |-1224.72\\,\\mu\\text{A}/\\text{cm}^2| = 1224.72\\,\\mu\\text{A}/\\text{cm}^2$$\n$$|I_{\\text{K}}| = |265.9472\\,\\mu\\text{A}/\\text{cm}^2| = 265.9472\\,\\mu\\text{A}/\\text{cm}^2$$\nSince $1224.72 > 265.9472$, the sodium current dominates in magnitude at this specific membrane potential and gating state.\n\nFinally, we compute the net transmembrane ionic current density, $I_{\\text{net}}$, by summing the individual currents:\n$$I_{\\text{net}} = I_{\\text{Na}} + I_{\\text{K}}$$\n$$I_{\\text{net}} = (-1224.72 + 265.9472)\\,\\mu\\text{A}/\\text{cm}^2$$\n$$I_{\\text{net}} = -958.7728\\,\\mu\\text{A}/\\text{cm}^2$$\nThe problem requires the answer to be rounded to four significant figures.\n$$I_{\\text{net}} \\approx -958.8\\,\\mu\\text{A}/\\text{cm}^2$$\nThe net current is a strong inward current, which is characteristic of the depolarizing phase of an action potential, driven by the influx of sodium ions.",
            "answer": "$$\\boxed{-958.8}$$"
        },
        {
            "introduction": "The Hodgkin-Huxley model's predictive power comes from its description of how channel gates open and close over time. This exercise moves from the static calculation of the previous practice to the dynamics of a single gating variable, the fundamental unit of the model's time-dependent behavior . By analytically solving the first-order differential equation for a gating particle, you will derive its exponential relaxation to a new steady state and gain an intuition for the voltage-dependent time constant, a key concept for interpreting experimental voltage-clamp data.",
            "id": "3989403",
            "problem": "Consider a single activation gating variable $x$ for a voltage-gated ion channel subunit in the classical Hodgkin-Huxley model. The dynamics of $x$ follow first-order voltage-dependent kinetics. The rate of change $dx/dt$ is the difference between an opening flux, proportional to the fraction of closed gates $(1-x)$ with rate $\\alpha(V)$, and a closing flux, proportional to the fraction of open gates $x$ with rate $\\beta(V)$. Assume both $\\alpha(V)$ and $\\beta(V)$ are strictly positive for all physiological voltages. Assume the membrane is held at voltage $V_0$ for a sufficiently long time so that $x$ reaches its steady state at $V_0$, denoted $x_{\\infty}(V_0)$, prior to $t=0$. At $t=0$ the membrane voltage is instantaneously stepped to a new constant level $V_1$, and held there thereafter.\n\nStarting from the first-principles rate description for a two-state gate under constant voltage, solve the initial value problem for $x(t)$ analytically with initial condition $x(0) = x_{\\infty}(V_0)$ and constant rates set by $V_1$. Then, under the physiologically typical condition $x_{\\infty}(V_1) > x_{\\infty}(V_0)$ (monotone activation increase to the new steady state), compute the unique time $T$ at which $x(T) = 0.95\\,x_{\\infty}(V_1)$.\n\nExpress your final time $T$ in seconds as a single closed-form analytic expression in terms of $\\alpha(V_1)$, $\\beta(V_1)$, $x_{\\infty}(V_1)$, and $x_{\\infty}(V_0)$. No numerical rounding is required. You may use the definition that $x_{\\infty}(V)$ denotes the steady-state value of $x$ at voltage $V$.",
            "solution": "The time evolution of the gating variable $x$ is described by the first-order kinetic scheme which translates to the following ordinary differential equation (ODE):\n$$\n\\frac{dx}{dt} = \\alpha(V)(1-x) - \\beta(V)x\n$$\nThis equation accounts for the transition from the closed state (fraction $1-x$) to the open state (fraction $x$) with rate $\\alpha(V)$, and the transition from the open state to the closed state with rate $\\beta(V)$.\n\nWe can rearrange this ODE into a standard linear form.\n$$\n\\frac{dx}{dt} = \\alpha(V) - (\\alpha(V) + \\beta(V))x\n$$\nThe steady-state value of the gating variable, $x_{\\infty}(V)$, is found by setting the time derivative to zero, $\\frac{dx}{dt} = 0$:\n$$\n0 = \\alpha(V)(1-x_{\\infty}(V)) - \\beta(V)x_{\\infty}(V)\n$$\nSolving for $x_{\\infty}(V)$ yields:\n$$\n\\alpha(V) = x_{\\infty}(V)(\\alpha(V) + \\beta(V))\n$$\n$$\nx_{\\infty}(V) = \\frac{\\alpha(V)}{\\alpha(V) + \\beta(V)}\n$$\nWe can also define a voltage-dependent time constant, $\\tau_x(V)$, for the gating process. By factoring out $(\\alpha(V) + \\beta(V))$ from the ODE:\n$$\n\\frac{dx}{dt} = (\\alpha(V) + \\beta(V)) \\left( \\frac{\\alpha(V)}{\\alpha(V) + \\beta(V)} - x \\right)\n$$\nSubstituting the expression for $x_{\\infty}(V)$:\n$$\n\\frac{dx}{dt} = \\frac{x_{\\infty}(V) - x}{\\tau_x(V)}\n$$\nwhere the time constant is defined as:\n$$\n\\tau_x(V) = \\frac{1}{\\alpha(V) + \\beta(V)}\n$$\nFor the time period $t \\ge 0$, the membrane voltage is held constant at $V_1$. Therefore, the governing ODE becomes:\n$$\n\\frac{dx}{dt} = \\frac{x_{\\infty}(V_1) - x}{\\tau_x(V_1)}\n$$\nThe initial condition is given as $x(0) = x_{\\infty}(V_0)$, resulting from the system being at steady state at voltage $V_0$ for $t < 0$.\n\nThis is a first-order linear ODE with a constant coefficient and a constant non-homogeneous term. The general solution is of the form:\n$$\nx(t) = x_{\\infty}(V_1) + C \\exp\\left(-\\frac{t}{\\tau_x(V_1)}\\right)\n$$\nwhere $C$ is a constant of integration determined by the initial condition. At $t=0$:\n$$\nx(0) = x_{\\infty}(V_0) = x_{\\infty}(V_1) + C \\exp(0)\n$$\n$$\nC = x_{\\infty}(V_0) - x_{\\infty}(V_1)\n$$\nSubstituting $C$ back into the general solution gives the particular solution for $x(t)$:\n$$\nx(t) = x_{\\infty}(V_1) + (x_{\\infty}(V_0) - x_{\\infty}(V_1)) \\exp\\left(-\\frac{t}{\\tau_x(V_1)}\\right)\n$$\nThis can be rewritten as:\n$$\nx(t) = x_{\\infty}(V_1) - (x_{\\infty}(V_1) - x_{\\infty}(V_0)) \\exp\\left(-\\frac{t}{\\tau_x(V_1)}\\right)\n$$\nSubstituting the expression for $\\tau_x(V_1)$:\n$$\nx(t) = x_{\\infty}(V_1) - (x_{\\infty}(V_1) - x_{\\infty}(V_0)) \\exp(-(\\alpha(V_1) + \\beta(V_1))t)\n$$\nThis is the analytical solution for $x(t)$ for $t \\ge 0$.\n\nThe next step is to find the time $T$ at which the activation variable reaches $95\\%$ of its new steady-state value, i.e., $x(T) = 0.95 \\, x_{\\infty}(V_1)$. We set the solution for $x(t)$ equal to this target value:\n$$\n0.95 \\, x_{\\infty}(V_1) = x_{\\infty}(V_1) - (x_{\\infty}(V_1) - x_{\\infty}(V_0)) \\exp(-(\\alpha(V_1) + \\beta(V_1))T)\n$$\nWe now solve for $T$. Rearranging the terms to isolate the exponential:\n$$\n(x_{\\infty}(V_1) - x_{\\infty}(V_0)) \\exp(-(\\alpha(V_1) + \\beta(V_1))T) = x_{\\infty}(V_1) - 0.95 \\, x_{\\infty}(V_1)\n$$\n$$\n(x_{\\infty}(V_1) - x_{\\infty}(V_0)) \\exp(-(\\alpha(V_1) + \\beta(V_1))T) = 0.05 \\, x_{\\infty}(V_1)\n$$\n$$\n\\exp(-(\\alpha(V_1) + \\beta(V_1))T) = \\frac{0.05 \\, x_{\\infty}(V_1)}{x_{\\infty}(V_1) - x_{\\infty}(V_0)}\n$$\nTaking the natural logarithm of both sides:\n$$\n-(\\alpha(V_1) + \\beta(V_1))T = \\ln\\left(\\frac{0.05 \\, x_{\\infty}(V_1)}{x_{\\infty}(V_1) - x_{\\infty}(V_0)}\\right)\n$$\nFinally, solving for $T$:\n$$\nT = -\\frac{1}{\\alpha(V_1) + \\beta(V_1)} \\ln\\left(\\frac{0.05 \\, x_{\\infty}(V_1)}{x_{\\infty}(V_1) - x_{\\infty}(V_0)}\\right)\n$$\nUsing the logarithmic property $-\\ln(a/b) = \\ln(b/a)$, we can write the expression for $T$ in a more direct form:\n$$\nT = \\frac{1}{\\alpha(V_1) + \\beta(V_1)} \\ln\\left(\\frac{x_{\\infty}(V_1) - x_{\\infty}(V_0)}{0.05 \\, x_{\\infty}(V_1)}\\right)\n$$\nThis is the closed-form analytic expression for the time $T$ in terms of the requested quantities. The condition $x_{\\infty}(V_1) > x_{\\infty}(V_0)$ ensures the numerator $x_{\\infty}(V_1) - x_{\\infty}(V_0)$ is positive. Moreover, for $T$ to be real and positive, the argument of the logarithm must be greater than $1$. This requires $x_{\\infty}(V_1) - x_{\\infty}(V_0) > 0.05 \\, x_{\\infty}(V_1)$, which simplifies to $x_{\\infty}(V_0) < 0.95 \\, x_{\\infty}(V_1)$. This is a physically necessary condition for the state $x(t)$ to pass through the value $0.95 \\, x_{\\infty}(V_1)$ as it evolves from $x_{\\infty}(V_0)$ to $x_{\\infty}(V_1)$, and is implicitly assumed by the structure of the problem.",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha(V_1) + \\beta(V_1)} \\ln\\left(\\frac{x_{\\infty}(V_1) - x_{\\infty}(V_0)}{0.05 x_{\\infty}(V_1)}\\right)}\n$$"
        },
        {
            "introduction": "We now synthesize the concepts from the previous practices to model a crucial physiological property: the neuronal refractory period. This computational exercise demonstrates how the slow recovery kinetics of the sodium inactivation gate ($h$), whose dynamics you analyzed in the previous practice, set a hard limit on how quickly a neuron can fire a second action potential . By formalizing and computing this minimal interspike interval, you will connect the biophysical behavior of a single channel population to an emergent, systems-level computational feature of the neuron.",
            "id": "3989462",
            "problem": "You are asked to formalize and compute how sodium channel inactivation, captured by the gating variable $h$, sets an absolute refractory period by determining the minimal interspike interval needed for $h$ to recover enough to re-enable a sodium current $I_{\\text{Na}}$ sufficient to initiate a second spike. Build your derivation and implementation from first principles of Hodgkin-Huxley modeling and use the canonical Hodgkin-Huxley rate functions.\n\nThe foundational basis to use is as follows:\n\n- Hodgkin-Huxley gating dynamics assume first-order kinetics for gating variables. For the sodium inactivation gate $h$, at a fixed membrane voltage $V$, the dynamics are governed by\n$$\n\\frac{dh}{dt} = \\alpha_h(V) \\left(1 - h\\right) - \\beta_h(V) h,\n$$\nwhere $\\alpha_h(V)$ and $\\beta_h(V)$ are voltage-dependent rate constants with units of $\\text{ms}^{-1}$.\n- The sodium current is expressed as\n$$\nI_{\\text{Na}} = \\bar{g}_{\\text{Na}}\\, m^3 h \\left(V - E_{\\text{Na}}\\right),\n$$\nwhere $\\bar{g}_{\\text{Na}}$ is the maximal sodium conductance (units $\\text{mS}/\\text{cm}^2$), $m$ is the sodium activation gate, $h$ is the inactivation gate, and $E_{\\text{Na}}$ is the sodium reversal potential (units $\\text{mV}$). The absolute magnitude of the inward sodium current during a depolarizing step from a voltage $V$ is\n$$\n|I_{\\text{Na}}| = \\bar{g}_{\\text{Na}}\\, m^3 h \\left(E_{\\text{Na}} - V\\right),\n$$\nprovided $E_{\\text{Na}} > V$.\n\nUse the canonical Hodgkin-Huxley rate functions (with voltage $V$ in $\\text{mV}$ and time in $\\text{ms}$):\n- Sodium activation gate $m$:\n$$\n\\alpha_m(V) = 0.1\\frac{V + 40}{1 - \\exp\\left(-\\frac{V + 40}{10}\\right)}, \\quad\n\\beta_m(V) = 4 \\exp\\left(-\\frac{V + 65}{18}\\right).\n$$\nWhen $V = -40$, interpret $\\alpha_m(-40)$ by taking the limit $V \\to -40$, which yields $\\alpha_m(-40) = 1$.\n- Sodium inactivation gate $h$:\n$$\n\\alpha_h(V) = 0.07 \\exp\\left(-\\frac{V + 65}{20}\\right), \\quad\n\\beta_h(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V + 35}{10}\\right)}.\n$$\n\nDefinitions needed for the derivation:\n- The steady-state value and time constant for $h$ at a fixed $V$ are\n$$\nh_{\\infty}(V) = \\frac{\\alpha_h(V)}{\\alpha_h(V) + \\beta_h(V)}, \\quad\n\\tau_h(V) = \\frac{1}{\\alpha_h(V) + \\beta_h(V)}.\n$$\n- Similarly, the steady-state value for the activation gate $m$ at voltage $V$ is\n$$\nm_{\\infty}(V) = \\frac{\\alpha_m(V)}{\\alpha_m(V) + \\beta_m(V)}.\n$$\n\nAssumptions to use in the model scenario:\n- Immediately after a spike, the membrane potential returns to a resting value $V_{\\text{rest}}$ and stays there until the next stimulus is applied.\n- The preceding spike is approximated as a voltage clamp at $V_{\\text{spike}}$ for duration $T_{\\text{spike}}$, beginning from the pre-spike resting steady state $h_{\\infty}(V_{\\text{rest}})$ and ending at a post-spike value $h_0$.\n- The next stimulus is a brief depolarizing step to $V_{\\text{step}}$ with duration sufficiently short that $h$ does not change during the step, while the fast activation gate $m$ instantaneously takes the value $m_{\\infty}(V_{\\text{step}})$.\n- A second spike is deemed possible if the peak inward sodium current during the step equals or exceeds a required inward current magnitude $I_{\\text{req}}$ (units $\\mu\\text{A}/\\text{cm}^2$).\n\nTasks:\n1. Starting from the first-order kinetics of $h$ at constant voltage, derive the expression for $h(t)$ during the recovery at $V_{\\text{rest}}$ following the spike, including how to compute $h_0$ at the end of the spike from $h_{\\infty}(V_{\\text{rest}})$, $V_{\\text{spike}}$, and $T_{\\text{spike}}$.\n2. Formulate mathematically the criterion for the minimal interspike interval $t_{\\min}$ such that the recovered $h(t_{\\min})$ re-enables sodium current $|I_{\\text{Na}}|$ during a step to $V_{\\text{step}}$ to meet $I_{\\text{req}}$. Express the minimal interspike interval in milliseconds.\n3. Implement a complete, runnable program that computes $t_{\\min}$ for each parameter set in the test suite below. If $E_{\\text{Na}} \\le V_{\\text{step}}$ (no inward sodium driving force) or if the required $h$ exceeds the asymptotic recovery $h_{\\infty}(V_{\\text{rest}})$ (i.e., the requirement cannot be met even after full recovery), output a sentinel value of $-1.0$. If the requirement is met immediately (the required $h$ is less than or equal to $h_0$), output $0.0$. Otherwise, compute the finite $t_{\\min}$ in milliseconds. Round all outputs to six decimal places.\n\nUse the following scientifically plausible test suite, with all quantities expressed in the stated units:\n- Case $1$: $V_{\\text{rest}} = -65$ $\\text{mV}$, $V_{\\text{spike}} = 30$ $\\text{mV}$, $T_{\\text{spike}} = 2$ $\\text{ms}$, $V_{\\text{step}} = -40$ $\\text{mV}$, $E_{\\text{Na}} = 50$ $\\text{mV}$, $\\bar{g}_{\\text{Na}} = 120$ $\\text{mS}/\\text{cm}^2$, $I_{\\text{req}} = 30$ $\\mu\\text{A}/\\text{cm}^2$.\n- Case $2$: $V_{\\text{rest}} = -65$ $\\text{mV}$, $V_{\\text{spike}} = 30$ $\\text{mV}$, $T_{\\text{spike}} = 2$ $\\text{ms}$, $V_{\\text{step}} = -40$ $\\text{mV}$, $E_{\\text{Na}} = 50$ $\\text{mV}$, $\\bar{g}_{\\text{Na}} = 120$ $\\text{mS}/\\text{cm}^2$, $I_{\\text{req}} = 1$ $\\mu\\text{A}/\\text{cm}^2$.\n- Case $3$: $V_{\\text{rest}} = -65$ $\\text{mV}$, $V_{\\text{spike}} = 30$ $\\text{mV}$, $T_{\\text{spike}} = 2$ $\\text{ms}$, $V_{\\text{step}} = -40$ $\\text{mV}$, $E_{\\text{Na}} = 50$ $\\text{mV}$, $\\bar{g}_{\\text{Na}} = 120$ $\\text{mS}/\\text{cm}^2$, $I_{\\text{req}} = 900$ $\\mu\\text{A}/\\text{cm}^2$.\n- Case $4$: $V_{\\text{rest}} = -65$ $\\text{mV}$, $V_{\\text{spike}} = 30$ $\\text{mV}$, $T_{\\text{spike}} = 2$ $\\text{ms}$, $V_{\\text{step}} = 55$ $\\text{mV}$, $E_{\\text{Na}} = 50$ $\\text{mV}$, $\\bar{g}_{\\text{Na}} = 120$ $\\text{mS}/\\text{cm}^2$, $I_{\\text{req}} = 30$ $\\mu\\text{A}/\\text{cm}^2$.\n- Case $5$: $V_{\\text{rest}} = -50$ $\\text{mV}$, $V_{\\text{spike}} = 30$ $\\text{mV}$, $T_{\\text{spike}} = 2$ $\\text{ms}$, $V_{\\text{step}} = -30$ $\\text{mV}$, $E_{\\text{Na}} = 50$ $\\text{mV}$, $\\bar{g}_{\\text{Na}} = 120$ $\\text{mS}/\\text{cm}^2$, $I_{\\text{req}} = 100$ $\\mu\\text{A}/\\text{cm}^2$.\n\nYour program should produce a single line of output containing the results for the five cases as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4,x_5]$, with each $x_i$ being the minimal interspike interval in $\\text{ms}$ rounded to six decimal places.",
            "solution": "### **Derivation and Solution**\n\nThe solution is structured according to the three tasks outlined in the problem statement.\n\n**Task 1: Derivation of $h(t)$ during recovery**\n\nThe dynamics of the inactivation gating variable $h$ at a fixed voltage $V$ are given by the linear first-order ordinary differential equation:\n$$ \\frac{dh}{dt} = \\alpha_h(V) (1 - h) - \\beta_h(V) h $$\nUsing the definitions of the steady-state value $h_{\\infty}(V) = \\frac{\\alpha_h(V)}{\\alpha_h(V) + \\beta_h(V)}$ and the time constant $\\tau_h(V) = \\frac{1}{\\alpha_h(V) + \\beta_h(V)}$, we can rewrite the equation as:\n$$ \\frac{dh}{dt} = \\frac{h_{\\infty}(V) - h}{\\tau_h(V)} $$\nThis is a standard separable differential equation. Its solution, for an initial condition $h(t=0) = h_{initial}$, is:\n$$ h(t) = h_{\\infty}(V) + (h_{initial} - h_{\\infty}(V)) \\exp\\left(-\\frac{t}{\\tau_h(V)}\\right) $$\nThis equation describes the exponential relaxation of $h$ towards its steady-state value $h_{\\infty}(V)$ with a time constant $\\tau_h(V)$.\n\nOur scenario involves two phases: the spike and the subsequent recovery period.\n\n1.  **During the spike:** The membrane is clamped at $V_{\\text{spike}}$ for a duration $T_{\\text{spike}}$. Before the spike, the neuron is at rest ($V_{\\text{rest}}$), so the initial value of $h$ is $h_{initial, spike} = h_{\\infty}(V_{\\text{rest}})$. Using the general solution, the value of $h$ at the end of the spike, which we denote $h_0$, is:\n    $$ h_0 = h_{\\infty}(V_{\\text{spike}}) + (h_{\\infty}(V_{\\text{rest}}) - h_{\\infty}(V_{\\text{spike}})) \\exp\\left(-\\frac{T_{\\text{spike}}}{\\tau_h(V_{\\text{spike}})}\\right) $$\n\n2.  **During recovery:** After the spike, the membrane potential returns to $V_{\\text{rest}}$. The recovery of $h$ begins from the initial value $h_0$ and proceeds towards the resting steady-state value $h_{\\infty}(V_{\\text{rest}})$. Let $t$ be the time elapsed since the end of the spike. The evolution of $h$ during this recovery period is given by:\n    $$ h(t) = h_{\\infty}(V_{\\text{rest}}) + (h_0 - h_{\\infty}(V_{\\text{rest}})) \\exp\\left(-\\frac{t}{\\tau_h(V_{\\text{rest}})}\\right) $$\nThis expression for $h(t)$ is the required result for the first task.\n\n**Task 2: Formulation of the minimal interspike interval $t_{\\min}$**\n\nA second spike is possible if a brief depolarizing stimulus to $V_{\\text{step}}$ can elicit a peak inward sodium current $|I_{\\text{Na}}|$ that meets or exceeds a threshold $I_{\\text{req}}$.\n$$ |I_{\\text{Na}}| \\ge I_{\\text{req}} $$\nThe magnitude of the sodium current is $|I_{\\text{Na}}| = \\bar{g}_{\\text{Na}}\\, m^3 h \\left(E_{\\text{Na}} - V\\right)$.\nUnder the assumption that the stimulus is brief, the activation gate $m$ equilibrates instantaneously to $m_{\\infty}(V_{\\text{step}})$ while the inactivation gate $h$ remains at its value at the time of stimulus, $h(t)$. The voltage is $V_{\\text{step}}$. The condition becomes:\n$$ \\bar{g}_{\\text{Na}} \\left(m_{\\infty}(V_{\\text{step}})\\right)^3 h(t) \\left(E_{\\text{Na}} - V_{\\text{step}}\\right) \\ge I_{\\text{req}} $$\nFirst, we must check the sodium driving force, $(E_{\\text{Na}} - V_{\\text{step}})$. If $E_{\\text{Na}} \\le V_{\\text{step}}$, the driving force is not inward, so no inward current is possible, and a spike cannot be initiated. In this case, $t_{\\min}$ is effectively infinite, for which we use the sentinel value $-1.0$.\n\nAssuming $E_{\\text{Na}} > V_{\\text{step}}$, we can solve for the minimum required value of $h$, which we call $h_{\\text{req}}$:\n$$ h_{\\text{req}} = \\frac{I_{\\text{req}}}{\\bar{g}_{\\text{Na}} \\left(m_{\\infty}(V_{\\text{step}})\\right)^3 \\left(E_{\\text{Na}} - V_{\\text{step}}\\right)} $$\nTo find the minimal interspike interval $t_{\\min}$, we need to find the shortest time $t \\ge 0$ such that $h(t) \\ge h_{\\text{req}}$. Since $h(t)$ is a monotonic function during recovery (typically increasing, as $h_0$ is low and $h_{\\infty}(V_{\\text{rest}})$ is high), we can find $t_{\\min}$ by setting $h(t_{\\min}) = h_{\\text{req}}$:\n$$ h_{\\text{req}} = h_{\\infty}(V_{\\text{rest}}) + (h_0 - h_{\\infty}(V_{\\text{rest}})) \\exp\\left(-\\frac{t_{\\min}}{\\tau_h(V_{\\text{rest}})}\\right) $$\nSolving for $t_{\\min}$:\n$$ \\exp\\left(-\\frac{t_{\\min}}{\\tau_h(V_{\\text{rest}})}\\right) = \\frac{h_{\\text{req}} - h_{\\infty}(V_{\\text{rest}})}{h_0 - h_{\\infty}(V_{\\text{rest}})} $$\n$$ -\\frac{t_{\\min}}{\\tau_h(V_{\\text{rest}})} = \\ln\\left(\\frac{h_{\\text{req}} - h_{\\infty}(V_{\\text{rest}})}{h_0 - h_{\\infty}(V_{\\text{rest}})}\\right) $$\n$$ t_{\\min} = -\\tau_h(V_{\\text{rest}}) \\ln\\left(\\frac{h_{\\text{req}} - h_{\\infty}(V_{\\text{rest}})}{h_0 - h_{\\infty}(V_{\\text{rest}})}\\right) = \\tau_h(V_{\\text{rest}}) \\ln\\left(\\frac{h_0 - h_{\\infty}(V_{\\text{rest}})}{h_{\\text{req}} - h_{\\infty}(V_{\\text{rest}})}\\right) $$\nThis formula is valid under specific conditions related to the state of recovery. We must consider three cases:\n1.  **Recovery impossible:** During recovery at $V_{\\text{rest}}$, $h(t)$ asymptotically approaches $h_{\\infty}(V_{\\text{rest}})$. If the required value $h_{\\text{req}}$ is greater than the maximum possible recovery level, i.e., $h_{\\text{req}} > h_{\\infty}(V_{\\text{rest}})$, then the condition can never be met. The argument of the logarithm would be negative, as $h_0 - h_{\\infty}(V_{\\text{rest}})$ is negative while $h_{\\text{req}} - h_{\\infty}(V_{\\text{rest}})$ is positive. In this case, we must return $-1.0$.\n2.  **Recovery not needed:** If the value of $h$ immediately after the spike, $h_0$, is already sufficient to meet the criterion, i.e., $h_0 \\ge h_{\\text{req}}$, then no recovery time is needed. The minimal interval is $t_{\\min} = 0$. Note that if $h_0=h_{\\text{req}}$, our formula yields $t_{\\min} = \\tau_h \\ln(1) = 0$. If $h_0 > h_{\\text{req}}$, the argument of the logarithm is between $0$ and $1$, yielding a negative $t_{\\min}$, which is non-physical. The problem specifies to return $0.0$ if the requirement is met immediately.\n3.  **Finite recovery time needed:** If $h_0 < h_{\\text{req}} < h_{\\infty}(V_{\\text{rest}})$, then a finite, positive time $t_{\\min}$ is required for recovery. Our derived formula applies directly. Both numerator and denominator of the logarithm's argument are negative, making the ratio positive and greater than $1$, which results in a positive $t_{\\min}$.\n\n**Task 3: Implementation Strategy**\n\nThe computation for each test case proceeds as follows:\n1.  Implement the voltage-dependent rate functions $\\alpha_m(V)$, $\\beta_m(V)$, $\\alpha_h(V)$, and $\\beta_h(V)$. The special case for $\\alpha_m(-40)$ must be handled.\n2.  Implement functions for the steady-state values $m_{\\infty}(V)$, $h_{\\infty}(V)$ and the time constant $\\tau_h(V)$.\n3.  For a given set of parameters, first check the driving force condition: if $E_{\\text{Na}} \\le V_{\\text{step}}$, return $-1.0$.\n4.  Calculate intermediate constants: $h_{\\infty}(V_{\\text{rest}})$, $\\tau_h(V_{\\text{rest}})$, $h_{\\infty}(V_{\\text{spike}})$, $\\tau_h(V_{\\text{spike}})$, and $m_{\\infty}(V_{\\text{step}})$.\n5.  Calculate $h_0$, the inactivation level at the end of the spike, using the formula from Task 1.\n6.  Calculate $h_{\\text{req}}$, a constant for each case, from the formula in Task 2.\n7.  Apply the logic for the three cases identified above:\n    - If $h_{\\text{req}} > h_{\\infty}(V_{\\text{rest}})$, return $-1.0$.\n    - If $h_{\\text{req}} \\le h_0$, return $0.0$.\n    - Otherwise, compute $t_{\\min}$ using the final derived formula.\n8.  Round the final result to six decimal places.\n\nThis structured approach ensures correctness and handles all specified edge cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import exp, log\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It computes the minimal interspike interval based on Hodgkin-Huxley kinetics.\n    \"\"\"\n\n    # Hodgkin-Huxley rate functions and derived quantities\n    # Units: V in mV, time in ms\n    \n    def alpha_m(V):\n        # Special case for V = -40 mV to avoid division by zero\n        if abs(V + 40.0) < 1e-5:\n            return 1.0\n        return 0.1 * (V + 40.0) / (1.0 - exp(-(V + 40.0) / 10.0))\n\n    def beta_m(V):\n        return 4.0 * exp(-(V + 65.0) / 18.0)\n\n    def alpha_h(V):\n        return 0.07 * exp(-(V + 65.0) / 20.0)\n\n    def beta_h(V):\n        return 1.0 / (1.0 + exp(-(V + 35.0) / 10.0))\n\n    def m_inf(V):\n        am = alpha_m(V)\n        bm = beta_m(V)\n        return am / (am + bm)\n    \n    def h_inf(V):\n        ah = alpha_h(V)\n        bh = beta_h(V)\n        return ah / (ah + bh)\n\n    def tau_h(V):\n        ah = alpha_h(V)\n        bh = beta_h(V)\n        return 1.0 / (ah + bh)\n\n    def calculate_t_min(params):\n        \"\"\"\n        Calculates the minimal interspike interval for a given set of parameters.\n        \"\"\"\n        V_rest, V_spike, T_spike, V_step, E_Na, g_Na_bar, I_req = params\n\n        # 1. Check for inward driving force\n        if E_Na <= V_step:\n            return -1.0\n\n        # 2. Calculate key HH values at different voltages\n        h_inf_rest = h_inf(V_rest)\n        tau_h_rest = tau_h(V_rest)\n        \n        h_inf_spike = h_inf(V_spike)\n        tau_h_spike = tau_h(V_spike)\n        \n        m_inf_step = m_inf(V_step)\n        \n        # 3. Calculate h_0: the value of h right after the spike\n        h_0 = h_inf_spike + (h_inf_rest - h_inf_spike) * exp(-T_spike / tau_h_spike)\n\n        # 4. Calculate h_req: the required value of h for the second spike\n        # Denominator represents the maximum possible current at V_step if h=1\n        denom = g_Na_bar * (m_inf_step**3) * (E_Na - V_step)\n        \n        # If the denominator is zero or negative, it's impossible to generate inward current.\n        # This is already covered by the E_Na <= V_step check, but good practice.\n        if denom <= 0:\n            return -1.0\n            \n        h_req = I_req / denom\n\n        # 5. Apply conditions to determine t_min\n        \n        # Case A: Required h exceeds the maximum possible recovery value\n        if h_req > h_inf_rest:\n            return -1.0\n\n        # Case B: h is already sufficiently recovered immediately after the spike\n        if h_req <= h_0:\n            return 0.0\n\n        # Case C: Finite recovery time is needed.\n        # Note: In this case, h_0 < h_req < h_inf_rest.\n        # h_0 - h_inf_rest is negative.\n        # h_req - h_inf_rest is also negative.\n        # The ratio is positive, and since |h_0 - h_inf_rest| > |h_req - h_inf_rest|,\n        # the argument to the logarithm is > 1, so t_min will be positive.\n        t_min = tau_h_rest * log((h_0 - h_inf_rest) / (h_req - h_inf_rest))\n        \n        return t_min\n\n    # Test suite from the problem statement\n    # (V_rest, V_spike, T_spike, V_step, E_Na, g_Na_bar, I_req)\n    test_cases = [\n        (-65.0, 30.0, 2.0, -40.0, 50.0, 120.0, 30.0),\n        (-65.0, 30.0, 2.0, -40.0, 50.0, 120.0, 1.0),\n        (-65.0, 30.0, 2.0, -40.0, 50.0, 120.0, 900.0),\n        (-65.0, 30.0, 2.0, 55.0, 50.0, 120.0, 30.0),\n        (-50.0, 30.0, 2.0, -30.0, 50.0, 120.0, 100.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        t_min = calculate_t_min(case)\n        # Round the result to six decimal places as required.\n        results.append(f\"{t_min:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}