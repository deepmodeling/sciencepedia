{
    "hands_on_practices": [
        {
            "introduction": "Before we can understand the complex dynamics of a system like the FitzHugh-Nagumo model, we must first identify its points of rest. These equilibrium points, or fixed points, represent the states where the system's dynamics cease, and they form the fundamental backbone of the phase-plane portrait. This first practice  provides a direct, hands-on exercise in the essential algebraic skill of calculating these equilibria by finding the intersection of the system's nullclines.",
            "id": "3981384",
            "problem": "Consider the canonical nondimensional FitzHugh–Nagumo (FHN) model for a single isopotential neuron compartment, where the fast variable $v$ represents membrane potential and the slow variable $w$ represents a recovery process:\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\n\\qquad\n\\frac{dw}{dt} \\;=\\; \\epsilon\\,\\big(v \\;+\\; a \\;-\\; b\\,w\\big),\n$$\nwith parameters $a$, $b$, $\\epsilon$, and $I$. The equilibrium $(v^{\\ast}, w^{\\ast})$ is defined as the state where both time derivatives are zero. In phase-plane analysis, the set of points where $\\frac{dv}{dt} = 0$ is the $v$-nullcline, and the set where $\\frac{dw}{dt} = 0$ is the $w$-nullcline.\n\nStarting from the definitions of equilibrium and nullclines, and without assuming any particular shortcut formulas, determine the equilibrium $(v^{\\ast}, w^{\\ast})$ explicitly for the parameter values $a = \\frac{2}{3}$, $b = 1$, and $I = 1$, with $\\epsilon  0$ an arbitrary positive constant. Then verify the consistency of your computed equilibrium by directly substituting back into both nullcline relations arising from $\\frac{dv}{dt} = 0$ and $\\frac{dw}{dt} = 0$.\n\nExpress your final answer as exact analytic values with no rounding. State the final ordered pair $(v^{\\ast}, w^{\\ast})$.",
            "solution": "The problem statement is valid as it is scientifically grounded in the established FitzHugh-Nagumo model, is mathematically well-posed, and uses objective, unambiguous language. All necessary parameters and definitions are provided, and there are no contradictions. We may therefore proceed with the solution.\n\nThe FitzHugh-Nagumo (FHN) model is given by the system of ordinary differential equations:\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I\n$$\n$$\n\\frac{dw}{dt} \\;=\\; \\epsilon\\,\\big(v \\;+\\; a \\;-\\; b\\,w\\big)\n$$\nAn equilibrium point, denoted as $(v^{\\ast}, w^{\\ast})$, is a state of the system where the time derivatives of all state variables are zero. Therefore, at equilibrium, we must satisfy the following two conditions simultaneously:\n$$\n\\frac{dv}{dt} \\bigg|_{(v^{\\ast}, w^{\\ast})} = 0 \\quad \\text{and} \\quad \\frac{dw}{dt} \\bigg|_{(v^{\\ast}, w^{\\ast})} = 0\n$$\nThese conditions define the nullclines of the system. The $v$-nullcline is the set of points $(v, w)$ where $\\frac{dv}{dt} = 0$, and the $w$-nullcline is the set of points $(v, w)$ where $\\frac{dw}{dt} = 0$. The equilibrium point $(v^{\\ast}, w^{\\ast})$ is the intersection of these nullclines.\n\nFrom the first equation, the $v$-nullcline is defined by:\n$$\nv^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;-\\; w^{\\ast} \\;+\\; I \\;=\\; 0\n$$\nThis can be rearranged to express $w^{\\ast}$ as a function of $v^{\\ast}$:\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; I \\quad \\text{(Equation 1)}\n$$\n\nFrom the second equation, the $w$-nullcline is defined by:\n$$\n\\epsilon\\,\\big(v^{\\ast} \\;+\\; a \\;-\\; b\\,w^{\\ast}\\big) \\;=\\; 0\n$$\nGiven that the parameter $\\epsilon  0$, this condition simplifies to:\n$$\nv^{\\ast} \\;+\\; a \\;-\\; b\\,w^{\\ast} \\;=\\; 0\n$$\nThis can also be rearranged to express $w^{\\ast}$ in terms of $v^{\\ast}$:\n$$\nw^{\\ast} \\;=\\; \\frac{v^{\\ast} + a}{b} \\quad \\text{(Equation 2)}\n$$\n\nThe problem specifies the parameter values $a = \\frac{2}{3}$, $b = 1$, and $I = 1$. Substituting these values into our nullcline equations yields:\n\nFor the $v$-nullcline (Equation 1, with $I=1$):\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\quad \\text{(Equation 1')}\n$$\nFor the $w$-nullcline (Equation 2, with $a=\\frac{2}{3}, b=1$):\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3} \\quad \\text{(Equation 2')}\n$$\n\nTo find the equilibrium point $(v^{\\ast}, w^{\\ast})$, we must find the values that satisfy both Equation 1' and Equation 2' simultaneously. We can do this by setting the expressions for $w^{\\ast}$ equal to each other:\n$$\nv^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3}\n$$\nWe can now solve this equation for $v^{\\ast}$. The terms $v^{\\ast}$ on both sides cancel out:\n$$\n-\\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\;=\\; \\frac{2}{3}\n$$\nIsolating the term with $v^{\\ast}$:\n$$\n-\\frac{(v^{\\ast})^{3}}{3} \\;=\\; \\frac{2}{3} \\;-\\; 1 \\;=\\; \\frac{2}{3} \\;-\\; \\frac{3}{3} \\;=\\; -\\frac{1}{3}\n$$\nMultiplying both sides by $-3$ gives:\n$$\n(v^{\\ast})^{3} \\;=\\; 1\n$$\nThe only real solution to this cubic equation is:\n$$\nv^{\\ast} \\;=\\; 1\n$$\nNow, we substitute this value of $v^{\\ast}$ back into either nullcline equation to find the corresponding value of $w^{\\ast}$. Using the simpler linear relation from the $w$-nullcline (Equation 2'):\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3} \\;=\\; 1 \\;+\\; \\frac{2}{3} \\;=\\; \\frac{3}{3} \\;+\\; \\frac{2}{3} \\;=\\; \\frac{5}{3}\n$$\nThus, the equilibrium point is $(v^{\\ast}, w^{\\ast}) = (1, \\frac{5}{3})$.\n\nAs required by the problem statement, we must now verify this result by substituting the computed equilibrium point back into both nullcline relations.\n\nVerification with the $v$-nullcline relation, $v - \\frac{v^{3}}{3} - w + I = 0$:\nSubstituting $(v, w, I) = (1, \\frac{5}{3}, 1)$:\n$$\n1 \\;-\\; \\frac{1^{3}}{3} \\;-\\; \\frac{5}{3} \\;+\\; 1 \\;=\\; 2 \\;-\\; \\frac{1}{3} \\;-\\; \\frac{5}{3} \\;=\\; 2 \\;-\\; \\frac{1+5}{3} \\;=\\; 2 \\;-\\; \\frac{6}{3} \\;=\\; 2 \\;-\\; 2 \\;=\\; 0\n$$\nThe condition for the $v$-nullcline is satisfied.\n\nVerification with the $w$-nullcline relation, $v + a - b w = 0$:\nSubstituting $(v, w, a, b) = (1, \\frac{5}{3}, \\frac{2}{3}, 1)$:\n$$\n1 \\;+\\; \\frac{2}{3} \\;-\\; (1)\\left(\\frac{5}{3}\\right) \\;=\\; \\frac{3}{3} \\;+\\; \\frac{2}{3} \\;-\\; \\frac{5}{3} \\;=\\; \\frac{3+2-5}{3} \\;=\\; \\frac{0}{3} \\;=\\; 0\n$$\nThe condition for the $w$-nullcline is also satisfied.\n\nBoth checks confirm that our calculated equilibrium point $(v^{\\ast}, w^{\\ast}) = (1, \\frac{5}{3})$ is correct.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{5}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Knowing a system's resting state is only the beginning; the true power of phase-plane analysis lies in understanding how the system responds to perturbations. This exercise  elevates our analysis from static points to dynamic properties by exploring the concept of excitability and threshold. Through a careful examination of the nullcline geometry, you will learn how the system's sensitivity to an input current $I$ is determined, providing deep insight into what makes a neuron \"decide\" to fire an action potential.",
            "id": "3981319",
            "problem": "Consider the canonical FitzHugh–Nagumo model for a single isopotential membrane element,\n$$\n\\frac{d v}{d t} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\\qquad\n\\frac{d w}{d t} \\;=\\; \\varepsilon\\,(v \\;+\\; a \\;-\\; b\\,w),\n$$\nwhere $v$ is a fast membrane voltage variable, $w$ is a slow recovery variable, $I$ is an applied current, $a$ and $b$ are positive parameters, and $0  \\varepsilon \\ll 1$ encodes fast–slow time-scale separation. The $v$-nullcline is given by $w \\;=\\; v \\;-\\; v^{3}/3 \\;+\\; I$ (a cubic curve), and the $w$-nullcline is given by $w \\;=\\; (v \\;+\\; a)/b$ (a straight line of slope $1/b$). The resting equilibrium $(v^{*},w^{*})$ for a given $I$ is the intersection of these nullclines that lies on the left stable branch of the cubic. Define the “knees” of the cubic as the points where the slope $d w/d v$ of the cubic nullcline in the $(v,w)$-plane attains a local extremum, which for the canonical cubic $w(v)$ occur where $d w/d v \\;=\\; 1 \\;-\\; v^{2} \\;=\\; 0$.\n\nUsing phase-plane reasoning based on the geometry of nullclines and the fast–slow structure (with $0  \\varepsilon \\ll 1$), evaluate how both the slope of the $w$-nullcline and the position of $(v^{*},w^{*})$ relative to the left knee of the cubic control the sensitivity of the effective spike threshold to small changes in input $I$ around a baseline $I_{0}$. Which of the following statements are correct?\n\nA. For fixed $a$ and small $\\varepsilon$, if $(v^{*},w^{*})$ lies near the left knee of the cubic, the threshold is highly sensitive to $I$ because the intersection of nullclines shifts strongly with $I$, with the sensitivity of $v^{*}$ to $I$ increasing as the slopes of the nullclines approach equality at the intersection (i.e., $d w/d v$ on the cubic approaching $1/b$).\n\nB. Making the $w$-nullcline steeper (increasing $1/b$) always increases the sensitivity of the threshold to changes in $I$, because the steeper line causes small vertical translations of the cubic to produce larger changes in $v^{*}$.\n\nC. The sensitivity of the threshold to $I$ is primarily controlled by $\\varepsilon$; for sufficiently small $\\varepsilon$, the geometric arrangement of the nullclines no longer meaningfully influences threshold sensitivity.\n\nD. When $(v^{*},w^{*})$ lies far from either knee of the cubic, the threshold depends weakly on $I$ over small ranges of $I$, because the intersection remains on the same stable branch and moves approximately linearly with $I$ without approaching any canard-like jump.\n\nE. Threshold sensitivity is minimized when the nullclines meet transversely and their slopes are equal at the intersection; equality of slopes reduces the response of $(v^{*},w^{*})$ to changes in $I$.",
            "solution": "The problem statement is scientifically sound, well-posed, and provides a sufficient basis for a rigorous analysis using the principles of nonlinear dynamics and phase-plane analysis as applied to the FitzHugh-Nagumo model. The model is a canonical one in computational neuroscience, and the concepts of nullclines, fast-slow dynamics, and excitability thresholds are standard. The question, while slightly informally phrased regarding \"sensitivity of the threshold,\" has a clear and analyzable meaning within this context: it queries how the sensitivity of the system's resting state to changes in input current $I$ is governed by the geometric properties of the nullclines. The problem is valid and can be solved as stated.\n\nThe FitzHugh-Nagumo system is given by:\n$$\n\\frac{d v}{d t} \\;=\\; f(v,w) = v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I\n$$\n$$\n\\frac{d w}{d t} \\;=\\; g(v,w) = \\varepsilon\\,(v \\;+\\; a \\;-\\; b\\,w)\n$$\nwith parameters $a  0$, $b  0$, and $0  \\varepsilon \\ll 1$.\n\nThe equilibrium points $(v^{*}, w^{*})$ of the system are the intersections of the $v$-nullcline and the $w$-nullcline.\nThe $v$-nullcline is defined by $\\frac{dv}{dt} = 0$, which gives the cubic curve:\n$$\nw = v - \\frac{v^3}{3} + I\n$$\nThe $w$-nullcline is defined by $\\frac{dw}{dt} = 0$, which gives the straight line:\n$$\nw = \\frac{v+a}{b}\n$$\nThe resting equilibrium $(v^{*}, w^{*})$ is a stable fixed point. The problem states this point lies on the left stable branch of the cubic, which corresponds to $v^{*}  -1$.\n\nTo analyze the sensitivity of the resting state to changes in the input current $I$, we investigate how the equilibrium voltage $v^{*}$ changes with $I$. At equilibrium, the intersection of the nullclines satisfies:\n$$\n\\frac{v^{*} + a}{b} = v^{*} - \\frac{(v^{*})^{3}}{3} + I\n$$\nWe can find the sensitivity of $v^{*}$ to $I$ by implicitly differentiating this equation with respect to $I$:\n$$\n\\frac{1}{b} \\frac{dv^{*}}{dI} = \\left(1 - (v^{*})^2\\right) \\frac{dv^{*}}{dI} + 1\n$$\nRearranging to solve for $\\frac{dv^{*}}{dI}$:\n$$\n\\frac{dv^{*}}{dI} \\left(\\frac{1}{b} - (1 - (v^{*})^2)\\right) = 1\n$$\n$$\n\\frac{dv^{*}}{dI} = \\frac{1}{\\frac{1}{b} - (1 - (v^{*})^{2})}\n$$\nThe term $\\frac{dv^{*}}{dI}$ quantifies the \"sensitivity\" of the equilibrium voltage to a change in current. A large value of $|\\frac{dv^{*}}{dI}|$ implies high sensitivity, meaning a small change in $I$ causes a large shift in the resting potential $v^{*}$. The denominator of this expression is the difference between the slope of the $w$-nullcline, which is $\\frac{1}{b}$, and the slope of the $v$-nullcline at the intersection, which is $1 - (v^{*})^{2}$.\n\nHigh sensitivity occurs when the denominator approaches zero, which happens when the slopes of the two nullclines become equal at the intersection point:\n$$\n\\frac{1}{b} \\approx 1 - (v^{*})^{2}\n$$\nThis condition corresponds to a saddle-node bifurcation, where the stable fixed point (the resting state) coalesces with a saddle point and disappears, leading to the generation of an action potential (a spike). This bifurcation occurs near the \"left knee\" of the cubic nullcline (the local minimum at $v = -1$). When the system is poised near this bifurcation, it is highly sensitive to perturbations in $I$.\n\nNow we evaluate each option.\n\n**A. For fixed $a$ and small $\\varepsilon$, if $(v^{*},w^{*})$ lies near the left knee of the cubic, the threshold is highly sensitive to $I$ because the intersection of nullclines shifts strongly with $I$, with the sensitivity of $v^{*}$ to $I$ increasing as the slopes of the nullclines approach equality at the intersection (i.e., $d w/d v$ on the cubic approaching $1/b$).**\n\nThis statement is correct. If the resting equilibrium $(v^{*}, w^{*})$ is \"near the left knee,\" it implies that the system is close to the saddle-node bifurcation point. As shown by the derived expression for $\\frac{dv^{*}}{dI}$, the sensitivity diverges as the denominator, representing the difference in slopes of the nullclines, approaches $0$. This means the intersection does indeed shift strongly with $I$. The condition for high sensitivity is precisely that the slopes approach equality. The condition $0  \\varepsilon \\ll 1$ ensures the fast-slow dynamics that make this phase-plane analysis relevant to the system's spiking behavior.\n\n**Verdict: Correct.**\n\n**B. Making the $w$-nullcline steeper (increasing $1/b$) always increases the sensitivity of the threshold to changes in $I$, because the steeper line causes small vertical translations of the cubic to produce larger changes in $v^{*}$.**\n\nThis statement is incorrect. The sensitivity is given by $\\frac{dv^{*}}{dI} = \\frac{1}{1/b - (1 - (v^{*})^{2})}$. The resting state is on the left branch, so $v^{*}  -1$ and thus the slope of the cubic, $1 - (v^{*})^{2}$, is negative. The slope of the $w$-nullcline, $1/b$, is positive. The denominator is $\\frac{1}{b} - (1-(v^*)^2) = \\frac{1}{b} + ((v^*)^2-1)$, which is a sum of two positive terms. If we make the $w$-nullcline steeper, we increase $1/b$. This increases the value of the denominator, which in turn *decreases* the sensitivity $\\frac{dv^{*}}{dI}$. The geometric justification provided is also flawed; a steeper line intersecting a curve leads to a *smaller* horizontal displacement ($\\Delta v$) for a given vertical shift ($\\Delta I$) of the curve.\n\n**Verdict: Incorrect.**\n\n**C. The sensitivity of the threshold to $I$ is primarily controlled by $\\varepsilon$; for sufficiently small $\\varepsilon$, the geometric arrangement of the nullclines no longer meaningfully influences threshold sensitivity.**\n\nThis statement is incorrect. The sensitivity of the fixed point's location to the parameter $I$, as captured by $\\frac{dv^{*}}{dI}$, is determined entirely by the geometry of the nullclines at the intersection point. The formula $\\frac{dv^{*}}{dI} = \\frac{1}{1/b - (1-(v^{*})^2)}$ does not contain $\\varepsilon$. The parameter $\\varepsilon$ governs the *dynamics* of the system, particularly the time-scale separation between $v$ and $w$. A small $\\varepsilon$ is precisely what makes the geometric analysis of nullclines so powerful and predictive of the system's temporal behavior (e.g., the shape of the spike, the existence of canard orbits). It does not, however, eliminate the influence of the nullcline geometry on threshold; it establishes it.\n\n**Verdict: Incorrect.**\n\n**D. When $(v^{*},w^{*})$ lies far from either knee of the cubic, the threshold depends weakly on $I$ over small ranges of $I$, because the intersection remains on the same stable branch and moves approximately linearly with $I$ without approaching any canard-like jump.**\n\nThis statement is correct. If the equilibrium point $(v^{*}, w^{*})$ is far from the knees, specifically far to the left of the left knee ($v \\ll -1$), then $(v^{*})^{2}$ is a large positive number. The slope of the cubic nullcline, $1 - (v^{*})^{2}$, becomes a large negative number. Consequently, the denominator of the sensitivity term, $\\frac{1}{b} - (1 - (v^{*})^{2})$, becomes a large positive number. This makes the sensitivity $\\frac{dv^{*}}{dI}$ small. This means that $v^{*}$ depends weakly on $I$, and the system is not close to the bifurcation (jump) threshold. The term \"canard-like jump\" is relevant as canard phenomena occur in a narrow parameter window around the saddle-node bifurcation, so being far from the knee means being far from this regime.\n\n**Verdict: Correct.**\n\n**E. Threshold sensitivity is minimized when the nullclines meet transversely and their slopes are equal at the intersection; equality of slopes reduces the response of $(v^{*},w^{*})$ to changes in $I$.**\n\nThis statement is unequivocally incorrect. It makes a claim that is the exact opposite of the truth. As established, the condition of equal slopes at the intersection, $\\frac{1}{b} = 1 - (v^{*})^{2}$, causes the denominator of the sensitivity expression $\\frac{dv^{*}}{dI}$ to be zero. This corresponds to an infinite sensitivity, not a minimum. This point of tangency is the bifurcation point that defines the threshold, where an infinitesimal change in $I$ can cause a finite, large-amplitude jump in the system state (a spike).\n\n**Verdict: Incorrect.**\n\nIn summary, statements A and D are correct descriptions of the system's sensitivity to input current based on the geometry of the nullclines.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "Theory and analysis come to life through simulation. This final practice bridges the gap between abstract phase-plane geometry and the tangible, time-dependent behavior of a model neuron. In this computational exercise , you will simulate a classic neurophysiological experiment: injecting a current pulse into the FitzHugh-Nagumo model. By observing whether this pulse is sufficient to trigger a spike, you will gain a practical understanding of threshold phenomena and the role of the separatrix in governing excitability.",
            "id": "3981341",
            "problem": "Consider the dimensionless FitzHugh–Nagumo model with a pulsed input, where the fast variable $v(t)$ models membrane voltage and the slow recovery variable $w(t)$ models an adaptation current. The ordinary differential equations (ODEs) are\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I(t), \\quad \\frac{dw}{dt} = \\varepsilon \\left( v + a - b w \\right),\n$$\nwith parameters $\\varepsilon  0$, $a  0$, and $b  0$. The input current is a rectangular pulse\n$$\nI(t) = I_0 \\, \\chi_{[0, T]}(t),\n$$\nwhere $\\chi_{[0, T]}(t)$ is the indicator function of the interval $[0, T]$, $I_0$ is the constant pulse amplitude, and $T$ is the pulse duration, all in dimensionless units.\n\nThe system exhibits fast–slow dynamics for small $\\varepsilon$, and the cubic $v$-nullcline\n$$\n\\mathcal{C}(I) = \\{(v,w): w = v - \\frac{v^3}{3} + I\\}\n$$\nis the critical manifold of the fast subsystem. After the pulse ends, the input is $I(t) = 0$, and the cubic $v$-nullcline is\n$$\n\\mathcal{C}(0) = \\{(v,w): w = v - \\frac{v^3}{3}\\}.\n$$\nIn the singular fast–slow limit, the fold points of $\\mathcal{C}(0)$ occur at $v = \\pm 1$ (since $\\frac{d}{dv}\\left(v - \\frac{v^3}{3}\\right) = 1 - v^2$ vanishes at those values), and the interval $v \\in (-1, 1)$ corresponds to the unstable middle branch that acts as a separatrix in the fast subsystem. For a fixed $w$ after the pulse, the criterion for spike initiation can be reduced to whether the trajectory crosses the separatrix associated with the right fold near $v = 1$. In this problem, define the separatrix crossing criterion as the crossing of the vertical line $v = 1$ from below to above at some time $t \\ge T$ when $I(t) = 0$.\n\nStarting from the unique resting equilibrium of the system at $I(t) = 0$, compute the phase-plane trajectory $(v(t), w(t))$ during the pulse ($0 \\le t \\le T$) and after the pulse ($t \\ge T$), and determine whether a spike occurs based on crossing the separatrix $v = 1$ after the pulse ends. Use the following fixed parameter values:\n- $\\varepsilon = 0.08$,\n- $a = 0.7$,\n- $b = 0.8$.\n\nDefine the resting equilibrium $(v^\\ast, w^\\ast)$ for $I(t) = 0$ as the intersection of the nullclines:\n$$\nw^\\ast = v^\\ast - \\frac{(v^\\ast)^3}{3}, \\quad w^\\ast = \\frac{v^\\ast + a}{b},\n$$\nwhich reduces to the scalar equation for $v^\\ast$:\n$$\nv^\\ast - \\frac{(v^\\ast)^3}{3} = \\frac{v^\\ast + a}{b}.\n$$\nCompute $(v^\\ast, w^\\ast)$ numerically to machine precision.\n\nFor each test case described below, simulate the system from the initial condition $(v(0), w(0)) = (v^\\ast, w^\\ast)$. Integrate the ODEs over time, first on $[0, T]$ with $I(t) = I_0$, then on $[T, T + 100]$ with $I(t) = 0$, and detect whether the trajectory crosses $v = 1$ from below to above for some $t \\in [T, T + 100]$. A spike is deemed to occur if and only if such a crossing happens.\n\nProvide the results for the following test suite, which spans a typical case, a stronger pulse, a borderline short pulse, a very strong but very short pulse, and a no-pulse control:\n- Test case $1$: $I_0 = 0.3$, $T = 5.0$.\n- Test case $2$: $I_0 = 0.8$, $T = 5.0$.\n- Test case $3$: $I_0 = 0.6$, $T = 1.0$.\n- Test case $4$: $I_0 = 1.2$, $T = 0.2$.\n- Test case $5$: $I_0 = 0.0$, $T = 0.0$.\n\nAll quantities are dimensionless; there are no physical units. The program must output a single line containing a comma-separated list of boolean values enclosed in square brackets, where each boolean indicates whether a spike occurs for the corresponding test case in the order listed above. For instance, the output must have the format $[b_1,b_2,b_3,b_4,b_5]$, where each $b_i$ is either $\\text{True}$ or $\\text{False}$.",
            "solution": "The problem requires the numerical simulation of the FitzHugh-Nagumo model to determine whether a rectangular input current pulse of amplitude $I_0$ and duration $T$ can elicit a spike. A spike is defined by a specific criterion related to the system's phase-plane trajectory after the pulse has ended.\n\nThe system of ordinary differential equations (ODEs) is:\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I(t)\n$$\n$$\n\\frac{dw}{dt} = \\varepsilon \\left( v + a - b w \\right)\n$$\nThe provided parameters are $\\varepsilon = 0.08$, $a = 0.7$, and $b = 0.8$. The input current $I(t)$ is a pulse: $I(t) = I_0$ for $t \\in [0, T]$ and $I(t) = 0$ for $t  T$.\n\nThe solution procedure involves three main steps:\n1.  **Determine the initial conditions**: The system starts at the unique resting equilibrium $(v^*, w^*)$ corresponding to $I(t) = 0$.\n2.  **Simulate the trajectory**: The ODEs are integrated numerically in two phases: first with the pulse on ($I(t) = I_0$) from $t=0$ to $t=T$, and second with the pulse off ($I(t) = 0$) for a subsequent duration, from $t=T$ to $t=T+100$.\n3.  **Detect spikes**: During the second phase, we monitor the trajectory to see if it meets the spike criterion: crossing the line $v=1$ from left to right (i.e., $v$ increasing past $1$).\n\n**Step 1: Calculating the Resting Equilibrium**\nThe resting equilibrium $(v^*, w^*)$ is the fixed point of the system when $I(t)=0$. It is found by setting the time derivatives to zero:\n$$\n\\frac{dv}{dt} = 0 \\implies v^* - \\frac{(v^*)^3}{3} - w^* = 0\n$$\n$$\n\\frac{dw}{dt} = 0 \\implies \\varepsilon \\left( v^* + a - b w^* \\right) = 0\n$$\nFrom the second equation, we have $w^* = (v^* + a)/b$. Substituting this into the first equation yields a single cubic equation for $v^*$:\n$$\nv^* - \\frac{(v^*)^3}{3} - \\frac{v^* + a}{b} = 0\n$$\nRearranging gives a standard polynomial form:\n$$\n\\frac{b}{3}(v^*)^3 + (1-b)v^* + a = 0\n$$\nSubstituting the given parameter values $a = 0.7$ and $b = 0.8$:\n$$\n\\frac{0.8}{3}(v^*)^3 + (1-0.8)v^* + 0.7 = 0 \\implies \\frac{0.8}{3}(v^*)^3 + 0.2v^* + 0.7 = 0\n$$\nThis cubic equation has one real root and two complex conjugate roots. The unique real root corresponds to the resting equilibrium. We can solve this numerically. The real root is found to be $v^* \\approx -1.1994$. The corresponding value for $w^*$ is then calculated as $w^* = (v^* + a) / b \\approx (-1.1994 + 0.7) / 0.8 \\approx -0.6243$. The initial condition for all simulations is $(v(0), w(0)) = (v^*, w^*)$.\n\n**Step 2: Numerical Simulation of Trajectories**\nWe will use a numerical ODE solver, specifically `scipy.integrate.solve_ivp`, to compute the trajectories $(v(t), w(t))$ for each test case. The simulation for each case is split into two parts.\n\n*   **Phase 1 (Pulse ON, $t \\in [0, T]$)**:\n    Starting from $(v^*, w^*)$, the system is integrated over the time interval $[0, T]$ with the current $I(t) = I_0$. The state of the system at the end of this phase, $(v(T), w(T))$, serves as the initial condition for the next phase. For the special case where $T=0$, this phase is skipped, and the initial state for Phase 2 is simply $(v^*, w^*)$.\n\n*   **Phase 2 (Pulse OFF, $t \\in [T, T+100]$)**:\n    Starting from $(v(T), w(T))$, the system is integrated over the time interval $[T, T+100]$ with the current $I(t) = 0$.\n\n**Step 3: Spike Detection**\nThe problem defines a spike as the occurrence of the fast variable $v(t)$ crossing the threshold $v=1$ from a lower value to a higher value at any time $t \\ge T$. This condition corresponds to the trajectory escaping the basin of attraction of the resting state and firing an action potential.\n\nThis detection is implemented using the event-finding capability of the `solve_ivp` function. We define an event function $f_{event}(t, y) = v(t) - 1$, where $y(t) = [v(t), w(t)]$. The solver can detect when this function crosses zero. By specifying the direction of the crossing to be positive (from negative to positive), we precisely capture the criterion $v(t)$ increasing past $1$. We also set the event to be \"terminal,\" meaning the integration will stop as soon as a spike is detected, which is computationally efficient. A spike is registered for a given test case if and only if the solver reports that this event occurred during the second integration phase.\n\nThis complete procedure is applied to each of the five test cases, and the boolean result (spike or no spike) is recorded. The final output is a list of these boolean values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the FitzHugh-Nagumo problem for a suite of test cases.\n    \n    This function first computes the resting equilibrium of the model. Then, for\n    each test case (defined by pulse amplitude I0 and duration T), it simulates\n    the ODE system in two phases:\n    1. With the current pulse I0 on, from t=0 to t=T.\n    2. With the current off, from t=T to t=T+100.\n    \n    During the second phase, it detects whether a spike occurs, defined as the\n    membrane voltage v(t) crossing 1 from below. The results are collected\n    and printed in the specified format.\n    \"\"\"\n\n    # Define fixed model parameters\n    eps = 0.08\n    a = 0.7\n    b = 0.8\n\n    # 1. Calculate the resting equilibrium (v*, w*) for I=0\n    # The equilibrium v* is the real root of the cubic equation:\n    # (b/3)v^3 + (1-b)v + a = 0\n    coeffs = [b/3, 0.0, 1-b, a]\n    roots = np.roots(coeffs)\n    # The unique real root is v*\n    v_star = np.real(roots[np.isreal(roots)][0])\n    # The corresponding w* is found from the w-nullcline\n    w_star = (v_star + a) / b\n    \n    initial_conditions = np.array([v_star, w_star])\n    \n    # 2. Define the ODE system (right-hand side)\n    def fhn_rhs(t, y, I_val, eps_val, a_val, b_val):\n        v, w = y\n        dv_dt = v - (v**3 / 3.0) - w + I_val\n        dw_dt = eps_val * (v + a_val - b_val * w)\n        return [dv_dt, dw_dt]\n\n    # 3. Define the spike detection event function\n    # Event occurs when v(t) - 1 = 0\n    def spike_event(t, y, *args):\n        return y[0] - 1.0\n    \n    # an event is only triggered when crossing from negative to positive\n    spike_event.direction = 1\n    # stop integration once a spike is detected\n    spike_event.terminal = True\n\n    # 4. Define test cases from the problem statement\n    test_cases = [\n        (0.3, 5.0),  # Case 1\n        (0.8, 5.0),  # Case 2\n        (0.6, 1.0),  # Case 3\n        (1.2, 0.2),  # Case 4\n        (0.0, 0.0),  # Case 5\n    ]\n\n    results = []\n    \n    # Iterate through each test case\n    for I0, T in test_cases:\n        # Phase 1: Integrate with the pulse ON (I=I0)\n        y_at_T = initial_conditions\n        if T > 0:\n            sol1 = solve_ivp(\n                fhn_rhs,\n                [0, T],\n                initial_conditions,\n                args=(I0, eps, a, b),\n                # Using a stiff solver can be more robust for FHN models\n                method='LSODA' \n            )\n            # State at the end of the pulse\n            y_at_T = sol1.y[:, -1]\n        \n        # Phase 2: Integrate with the pulse OFF (I=0) and detect spike\n        t_start_phase2 = T\n        t_end_phase2 = T + 100.0\n        \n        sol2 = solve_ivp(\n            fhn_rhs,\n            [t_start_phase2, t_end_phase2],\n            y_at_T,\n            args=(0.0, eps, a, b), # I_val is 0.0\n            events=spike_event,\n            method='LSODA'\n        )\n        \n        # Check if the spike event was triggered\n        # sol2.t_events[0] will contain the time(s) of the event\n        has_spiked = len(sol2.t_events[0]) > 0\n        results.append(has_spiked)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}