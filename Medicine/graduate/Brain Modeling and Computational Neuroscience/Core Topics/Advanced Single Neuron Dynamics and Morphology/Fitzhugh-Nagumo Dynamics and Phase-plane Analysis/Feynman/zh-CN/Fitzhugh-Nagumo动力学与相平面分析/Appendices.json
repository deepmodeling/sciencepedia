{
    "hands_on_practices": [
        {
            "introduction": "分析任何动力系统的第一步是确定其平衡点——即系统保持静止的状态。该练习将引导您完成 FitzHugh-Nagumo 模型平衡点的代数计算，从而巩固这一基本概念。通过求解 $v$-零斜线和 $w$-零斜线的交点，您将为一组给定的参数确定系统的稳态。",
            "id": "3981384",
            "problem": "考虑一个单个等电位神经元隔室的规范无量纲FitzHugh–Nagumo (FHN) 模型，其中快变量 $v$ 代表膜电位，慢变量 $w$ 代表一个恢复过程：\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\n\\qquad\n\\frac{dw}{dt} \\;=\\; \\epsilon\\,\\big(v \\;+\\; a \\;-\\; b\\,w\\big),\n$$\n其中包含参数 $a$、$b$、$\\epsilon$ 和 $I$。平衡点 $(v^{\\ast}, w^{\\ast})$ 定义为两个时间导数均为零的状态。在相平面分析中，满足 $\\frac{dv}{dt} = 0$ 的点集是 $v$-零斜线，而满足 $\\frac{dw}{dt} = 0$ 的点集是 $w$-零斜线。\n\n从平衡点和零斜线的定义出发，不假设任何特定的快捷公式，对于参数值 $a = \\frac{2}{3}$，$b = 1$ 和 $I = 1$（其中 $\\epsilon > 0$ 为任意正常数），明确地确定平衡点 $(v^{\\ast}, w^{\\ast})$。然后，通过将计算出的平衡点直接代回由 $\\frac{dv}{dt} = 0$ 和 $\\frac{dw}{dt} = 0$ 产生的两个零斜线关系式中，来验证其一致性。\n\n以无舍入的精确解析值形式给出你的最终答案。写出最终的有序对 $(v^{\\ast}, w^{\\ast})$。",
            "solution": "该问题陈述是有效的，因为它在科学上基于已建立的 FitzHugh-Nagumo 模型，在数学上是适定的，并使用了客观、无歧义的语言。所有必要的参数和定义都已提供，且没有矛盾之处。因此我们可以进行求解。\n\nFitzHugh-Nagumo (FHN) 模型由以下常微分方程组给出：\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I\n$$\n$$\n\\frac{dw}{dt} \\;=\\; \\epsilon\\,\\big(v \\;+\\; a \\;-\\; b\\,w\\big)\n$$\n一个平衡点，记为 $(v^{\\ast}, w^{\\ast})$，是系统的一种状态，在该状态下所有状态变量的时间导数均为零。因此，在平衡点处，必须同时满足以下两个条件：\n$$\n\\frac{dv}{dt} \\bigg|_{(v^{\\ast}, w^{\\ast})} = 0 \\quad \\text{和} \\quad \\frac{dw}{dt} \\bigg|_{(v^{\\ast}, w^{\\ast})} = 0\n$$\n这些条件定义了系统的零斜线。$v$-零斜线是满足 $\\frac{dv}{dt} = 0$ 的点 $(v, w)$ 的集合，$w$-零斜线是满足 $\\frac{dw}{dt} = 0$ 的点 $(v, w)$ 的集合。平衡点 $(v^{\\ast}, w^{\\ast})$ 是这些零斜线的交点。\n\n根据第一个方程，$v$-零斜线由以下方程定义：\n$$\nv^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;-\\; w^{\\ast} \\;+\\; I \\;=\\; 0\n$$\n这可以被重新整理以将 $w^{\\ast}$ 表示为 $v^{\\ast}$ 的函数：\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; I \\quad \\text{(方程 1)}\n$$\n\n根据第二个方程，$w$-零斜线由以下方程定义：\n$$\n\\epsilon\\,\\big(v^{\\ast} \\;+\\; a \\;-\\; b\\,w^{\\ast}\\big) \\;=\\; 0\n$$\n鉴于参数 $\\epsilon > 0$，此条件简化为：\n$$\nv^{\\ast} \\;+\\; a \\;-\\; b\\,w^{\\ast} \\;=\\; 0\n$$\n这也可以被重新整理以将 $w^{\\ast}$ 表示为 $v^{\\ast}$ 的函数：\n$$\nw^{\\ast} \\;=\\; \\frac{v^{\\ast} + a}{b} \\quad \\text{(方程 2)}\n$$\n\n问题指定了参数值 $a = \\frac{2}{3}$、$b = 1$ 和 $I = 1$。将这些值代入我们的零斜线方程中得到：\n\n对于 $v$-零斜线（方程1，其中 $I=1$）：\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\quad \\text{(方程 1')}\n$$\n对于 $w$-零斜线（方程2，其中 $a=\\frac{2}{3}, b=1$）：\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3} \\quad \\text{(方程 2')}\n$$\n\n为了找到平衡点 $(v^{\\ast}, w^{\\ast})$，我们必须找到同时满足方程1'和方程2'的值。我们可以通过令 $w^{\\ast}$ 的两个表达式相等来做到这一点：\n$$\nv^{\\ast} \\;-\\; \\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3}\n$$\n现在我们可以求解这个关于 $v^{\\ast}$ 的方程。方程两边的 $v^{\\ast}$ 项相互抵消：\n$$\n-\\frac{(v^{\\ast})^{3}}{3} \\;+\\; 1 \\;=\\; \\frac{2}{3}\n$$\n分离含有 $v^{\\ast}$ 的项：\n$$\n-\\frac{(v^{\\ast})^{3}}{3} \\;=\\; \\frac{2}{3} \\;-\\; 1 \\;=\\; \\frac{2}{3} \\;-\\; \\frac{3}{3} \\;=\\; -\\frac{1}{3}\n$$\n两边同乘以 $-3$ 得：\n$$\n(v^{\\ast})^{3} \\;=\\; 1\n$$\n这个三次方程唯一的实数解是：\n$$\nv^{\\ast} \\;=\\; 1\n$$\n现在，我们将这个 $v^{\\ast}$ 的值代回任一个零斜线方程中，以求得对应的 $w^{\\ast}$ 值。使用来自 $w$-零斜线的更简单的线性关系（方程2'）：\n$$\nw^{\\ast} \\;=\\; v^{\\ast} \\;+\\; \\frac{2}{3} \\;=\\; 1 \\;+\\; \\frac{2}{3} \\;=\\; \\frac{3}{3} \\;+\\; \\frac{2}{3} \\;=\\; \\frac{5}{3}\n$$\n因此，平衡点为 $(v^{\\ast}, w^{\\ast}) = (1, \\frac{5}{3})$。\n\n按照问题陈述的要求，我们现在必须通过将计算出的平衡点代回两个零斜线关系式中来验证此结果。\n\n验证 $v$-零斜线关系式 $v - \\frac{v^{3}}{3} - w + I = 0$：\n代入 $(v, w, I) = (1, \\frac{5}{3}, 1)$：\n$$\n1 \\;-\\; \\frac{1^{3}}{3} \\;-\\; \\frac{5}{3} \\;+\\; 1 \\;=\\; 2 \\;-\\; \\frac{1}{3} \\;-\\; \\frac{5}{3} \\;=\\; 2 \\;-\\; \\frac{1+5}{3} \\;=\\; 2 \\;-\\; \\frac{6}{3} \\;=\\; 2 \\;-\\; 2 \\;=\\; 0\n$$\n$v$-零斜线的条件得到满足。\n\n验证 $w$-零斜线关系式 $v + a - b w = 0$：\n代入 $(v, w, a, b) = (1, \\frac{5}{3}, \\frac{2}{3}, 1)$：\n$$\n1 \\;+\\; \\frac{2}{3} \\;-\\; (1)\\left(\\frac{5}{3}\\right) \\;=\\; \\frac{3}{3} \\;+\\; \\frac{2}{3} \\;-\\; \\frac{5}{3} \\;=\\; \\frac{3+2-5}{3} \\;=\\; \\frac{0}{3} \\;=\\; 0\n$$\n$w$-零斜线的条件也得到满足。\n\n两次检验都确认了我们计算出的平衡点 $(v^{\\ast}, w^{\\ast}) = (1, \\frac{5}{3})$ 是正确的。",
            "answer": "$$\\boxed{(v^{\\ast}, w^{\\ast}) = (1, \\frac{5}{3})}$$"
        },
        {
            "introduction": "像神经元这样的可兴奋系统，其静息态不仅仅是静态的，更是随时准备响应的。本练习将超越简单地寻找平衡点，深入探讨可兴奋性本身的几何基础。通过分析零斜线在三次曲线“拐点”附近的斜率关系，您将对控制神经元放电阈值及其对输入电流敏感性的因素获得更深刻的直觉。",
            "id": "3981319",
            "problem": "考虑单个等电位膜元的经典菲茨休-南云模型 (FitzHugh–Nagumo model)，\n$$\n\\frac{d v}{d t} \\;=\\; v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\\qquad\n\\frac{d w}{d t} \\;=\\; \\varepsilon\\,(v \\;+\\; a \\;-\\; b\\,w),\n$$\n其中$v$是快膜电压变量，$w$是慢恢复变量，$I$是外加电流，$a$和$b$是正常数，且$0  \\varepsilon\\ll 1$表示快慢时间尺度分离。$v$-零斜线由$w \\;=\\; v \\;-\\; v^{3}/3 \\;+\\; I$（一条三次曲线）给出，$w$-零斜线由$w \\;=\\; (v \\;+\\; a)/b$（一条斜率为$1/b$的直线）给出。对于给定的$I$，静息平衡点$(v^{*},w^{*})$是这些零斜线位于三次曲线左侧稳定分支上的交点。将三次曲线的“膝点”定义为在$(v,w)$平面上三次零斜线的斜率$d w/d v$达到局部极值的点，对于经典的三次曲线$w(v)$，这发生在$d w/d v \\;=\\; 1 \\;-\\; v^{2} \\;=\\; 0$处。\n\n利用基于零斜线几何形状和快慢结构（其中$0  \\varepsilon\\ll 1$）的相平面分析，评估$w$-零斜线的斜率以及$(v^{*},w^{*})$相对于三次曲线左膝点的位置如何控制有效尖峰阈值对基线$I_{0}$附近输入$I$的微小变化的灵敏度。下列哪个陈述是正确的？\n\nA. 对于固定的$a$和较小的$\\varepsilon$，如果$(v^{*},w^{*})$位于三次曲线的左膝点附近，则阈值对$I$高度敏感，因为零斜线的交点会随着$I$发生剧烈移动，并且随着交点处零斜线的斜率趋于相等（即三次曲线上的$d w/d v$趋近于$1/b$），$v^{*}$对$I$的灵敏度会增加。\n\nB. 使$w$-零斜线更陡峭（即增加$1/b$）总是会增加阈值对$I$变化的灵敏度，因为更陡峭的直线会导致三次曲线的微小垂直平移产生更大的$v^{*}$变化。\n\nC. 阈值对$I$的灵敏度主要由$\\varepsilon$控制；对于足够小的$\\varepsilon$，零斜线的几何排列不再对阈值灵敏度产生有意义的影响。\n\nD. 当$(v^{*},w^{*})$远离三次曲线的任一膝点时，在$I$的小范围内，阈值对$I$的依赖性很弱，因为交点保持在同一稳定分支上，并随$I$近似线性移动，而不会接近任何鸭式跳跃。\n\nE. 当零斜线横截相交且在交点处的斜率相等时，阈值灵敏度最小化；斜率相等会减小$(v^{*},w^{*})$对$I$变化的响应。",
            "solution": "问题陈述在科学上是合理的、适定的，并为使用应用于菲茨休-南云模型的非线性动力学和相平面分析原理进行严格分析提供了充分的基础。该模型是计算神经科学中的一个经典模型，零斜线、快慢动力学和兴奋性阈值的概念都是标准概念。这个问题虽然在“阈值的灵敏度”方面表述略显非正式，但在该背景下具有清晰且可分析的含义：它询问系统的静息态对输入电流$I$变化的灵敏度是如何由零斜线的几何特性决定的。该问题是有效的，可以按所述方式解决。\n\n菲茨休-南云系统由以下方程组给出：\n$$\n\\frac{d v}{d t} \\;=\\; f(v,w) = v \\;-\\; \\frac{v^{3}}{3} \\;-\\; w \\;+\\; I\n$$\n$$\n\\frac{d w}{d t} \\;=\\; g(v,w) = \\varepsilon\\,(v \\;+\\; a \\;-\\; b\\,w)\n$$\n其中参数$a > 0$，$b > 0$，且$0  \\varepsilon \\ll 1$。\n\n系统的平衡点$(v^{*}, w^{*})$是$v$-零斜线和$w$-零斜线的交点。\n$v$-零斜线由$\\frac{dv}{dt} = 0$定义，即三次曲线：\n$$\nw = v - \\frac{v^3}{3} + I\n$$\n$w$-零斜线由$\\frac{dw}{dt} = 0$定义，即直线：\n$$\nw = \\frac{v+a}{b}\n$$\n静息平衡点$(v^{*}, w^{*})$是一个稳定不动点。问题陈述该点位于三次曲线的左侧稳定分支上，这对应于$v^{*}  -1$。\n\n为分析静息态对输入电流$I$变化的灵敏度，我们研究平衡电压$v^{*}$如何随$I$变化。在平衡点处，零斜线的交点满足：\n$$\n\\frac{v^{*} + a}{b} = v^{*} - \\frac{(v^{*})^{3}}{3} + I\n$$\n我们可以通过对该方程关于$I$进行隐式微分来求得$v^{*}$对$I$的灵敏度：\n$$\n\\frac{1}{b} \\frac{dv^{*}}{dI} = \\left(1 - (v^{*})^2\\right) \\frac{dv^{*}}{dI} + 1\n$$\n整理以求解$\\frac{dv^{*}}{dI}$：\n$$\n\\frac{dv^{*}}{dI} \\left(\\frac{1}{b} - (1 - (v^{*})^2)\\right) = 1\n$$\n$$\n\\frac{dv^{*}}{dI} = \\frac{1}{\\frac{1}{b} - (1 - (v^{*})^{2})}\n$$\n项$\\frac{dv^{*}}{dI}$量化了平衡电压对电流变化的“灵敏度”。$|\\frac{dv^{*}}{dI}|$的大值意味着高灵敏度，即$I$的微小变化会导致静息电位$v^{*}$的较大偏移。该表达式的分母是$w$-零斜线的斜率$\\frac{1}{b}$与交点处$v$-零斜线的斜率$1 - (v^{*})^{2}$之差。\n\n当分母趋近于零时，出现高灵敏度，这发生在两条零斜线的斜率在交点处变得相等时：\n$$\n\\frac{1}{b} \\approx 1 - (v^{*})^{2}\n$$\n这个条件对应于一个鞍结分岔，此时稳定不动点（静息态）与一个鞍点合并并消失，从而产生一个动作电位（尖峰）。这个分岔发生在三次零斜线的“左膝点”（即$v = -1$处的局部最小值）附近。当系统处于该分岔点附近时，它对$I$的扰动高度敏感。\n\n现在我们来评估每个选项。\n\n**A. 对于固定的$a$和较小的$\\varepsilon$，如果$(v^{*},w^{*})$位于三次曲线的左膝点附近，则阈值对$I$高度敏感，因为零斜线的交点会随着$I$发生剧烈移动，并且随着交点处零斜线的斜率趋于相等（即三次曲线上的$d w/d v$趋近于$1/b$），$v^{*}$对$I$的灵敏度会增加。**\n\n这个陈述是正确的。如果静息平衡点$(v^{*}, w^{*})$“位于左膝点附近”，意味着系统接近鞍结分岔点。正如推导出的$\\frac{dv^{*}}{dI}$表达式所示，当分母（代表零斜线斜率之差）趋近于$0$时，灵敏度发散。这确实意味着交点随$I$发生剧烈移动。高灵敏度的条件恰好是斜率趋于相等。条件$0  \\varepsilon \\ll 1$确保了快慢动力学，使得这种相平面分析与系统的尖峰发放行为相关。\n\n**结论：正确。**\n\n**B. 使$w$-零斜线更陡峭（即增加$1/b$）总是会增加阈值对$I$变化的灵敏度，因为更陡峭的直线会导致三次曲线的微小垂直平移产生更大的$v^{*}$变化。**\n\n这个陈述是错误的。灵敏度由$\\frac{dv^{*}}{dI} = \\frac{1}{1/b - (1 - (v^{*})^{2})}$给出。静息态位于左侧分支，所以$v^{*}  -1$，因此三次曲线的斜率$1 - (v^{*})^{2}$是负的。$w$-零斜线的斜率$1/b$是正的。分母为$\\frac{1}{b} - (1-(v^*)^2) = \\frac{1}{b} + ((v^*)^2-1)$，是两个正项之和。如果我们使$w$-零斜线更陡峭，我们增加了$1/b$。这会增大分母的值，从而*减小*灵敏度$\\frac{dv^{*}}{dI}$。所提供的几何解释也是有缺陷的；对于曲线给定的垂直位移（$\\Delta I$），一条更陡峭的相交直线会导致一个*更小*的水平位移（$\\Delta v$）。\n\n**结论：错误。**\n\n**C. 阈值对$I$的灵敏度主要由$\\varepsilon$控制；对于足够小的$\\varepsilon$，零斜线的几何排列不再对阈值灵敏度产生有意义的影响。**\n\n这个陈述是错误的。不动点位置对参数$I$的灵敏度，由$\\frac{dv^{*}}{dI}$表示，完全由交点处零斜线的几何形状决定。公式$\\frac{dv^{*}}{dI} = \\frac{1}{1/b - (1-(v^{*})^2)}$不包含$\\varepsilon$。参数$\\varepsilon$控制系统的*动力学*，特别是$v$和$w$之间的时间尺度分离。一个小的$\\varepsilon$正是使零斜线的几何分析如此强大并能预测系统时间行为（例如，尖峰的形状、鸭式轨道的存在）的原因。然而，它并没有消除零斜线几何对阈值的影响；相反，它确立了这种影响。\n\n**结论：错误。**\n\n**D. 当$(v^{*},w^{*})$远离三次曲线的任一膝点时，在$I$的小范围内，阈值对$I$的依赖性很弱，因为交点保持在同一稳定分支上，并随$I$近似线性移动，而不会接近任何鸭式跳跃。**\n\n这个陈述是正确的。如果平衡点$(v^{*}, w^{*})$远离膝点，特别是远在左膝点的左侧（$v \\ll -1$），那么$(v^{*})^{2}$是一个大的正数。三次零斜线的斜率$1 - (v^{*})^{2}$将是一个大的负数。因此，灵敏度项的分母$\\frac{1}{b} - (1 - (v^{*})^{2})$将是一个大的正数。这使得灵敏度$\\frac{dv^{*}}{dI}$很小。这意味着$v^{*}$对$I$的依赖性很弱，系统离分岔（跳跃）阈值不近。“鸭式跳跃”这个术语是相关的，因为鸭式现象发生在鞍结分岔周围一个狭窄的参数窗口内，所以远离膝点意味着远离这个区域。\n\n**结论：正确。**\n\n**E. 当零斜线横截相交且在交点处的斜率相等时，阈值灵敏度最小化；斜率相等会减小$(v^{*},w^{*})$对$I$变化的响应。**\n\n这个陈述是明确错误的。它提出的主张与事实完全相反。如前所述，交点处斜率相等的条件$\\frac{1}{b} = 1 - (v^{*})^{2}$，导致灵敏度表达式$\\frac{dv^{*}}{dI}$的分母为零。这对应于无穷大的灵敏度，而不是最小值。这个相切点是定义阈值的分岔点，在该点，$I$的无穷小变化可以引起系统状态的有限大振幅跳跃（一个尖峰）。\n\n**结论：错误。**\n\n综上所述，陈述A和D是基于零斜线几何形状对系统输入电流灵敏度的正确描述。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "一个模型效用的最终检验在于其预测系统动态行为的能力。这个计算练习将挑战您模拟 FitzHugh-Nagumo 模型在一个真实场景下的响应：一个瞬态的输入电流脉冲。您将通过编写程序来追踪系统的轨迹，并应用相平面判据来明确判断刺激是否足以触发一次“锋电位”，从而将理论分析与可观察到的神经元放电联系起来。",
            "id": "3981341",
            "problem": "考虑一个带有脉冲输入的无量纲 FitzHugh–Nagumo 模型，其中快变量 $v(t)$ 模拟膜电压，慢恢复变量 $w(t)$ 模拟适应电流。其常微分方程 (ODEs) 如下：\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I(t), \\quad \\frac{dw}{dt} = \\varepsilon \\left( v + a - b w \\right),\n$$\n其中参数 $\\varepsilon > 0$，$a > 0$ 和 $b > 0$。输入电流为一个矩形脉冲\n$$\nI(t) = I_0 \\, \\chi_{[0, T]}(t),\n$$\n其中 $\\chi_{[0, T]}(t)$ 是区间 $[0, T]$ 的指示函数，$I_0$ 是恒定脉冲幅度，$T$ 是脉冲持续时间，所有这些都是无量纲单位。\n\n当 $\\varepsilon$ 很小时，系统表现出快慢动力学特性，三次 $v$-零斜线\n$$\n\\mathcal{C}(I) = \\{(v,w): w = v - \\frac{v^3}{3} + I\\}\n$$\n是快子系统的临界流形。脉冲结束后，输入为 $I(t) = 0$，三次 $v$-零斜线为\n$$\n\\mathcal{C}(0) = \\{(v,w): w = v - \\frac{v^3}{3}\\}.\n$$\n在奇异快慢极限下，$\\mathcal{C}(0)$ 的折叠点出现在 $v = \\pm 1$ 处（因为 $\\frac{d}{dv}\\left(v - \\frac{v^3}{3}\\right) = 1 - v^2$ 在这些值上为零），并且区间 $v \\in (-1, 1)$ 对应于不稳定的中间分支，该分支在快子系统中充当分界线。对于脉冲后的固定 $w$，峰电位起始的判据可以简化为轨迹是否穿过与 $v=1$ 附近的右侧折叠点相关的分界线。在本问题中，我们将分界线穿越判据定义为：在某个时间 $t \\ge T$ 且 $I(t) = 0$ 时，轨迹从下向上穿越垂直线 $v = 1$。\n\n从系统在 $I(t) = 0$ 时的唯一静息平衡点开始，计算脉冲期间（$0 \\le t \\le T$）和脉冲后（$t \\ge T$）的相平面轨迹 $(v(t), w(t))$，并根据脉冲结束后是否穿越分界线 $v=1$ 来判断是否产生峰电位。使用以下固定的参数值：\n- $\\varepsilon = 0.08$，\n- $a = 0.7$，\n- $b = 0.8$。\n\n将 $I(t) = 0$ 时的静息平衡点 $(v^\\ast, w^\\ast)$ 定义为零斜线的交点：\n$$\nw^\\ast = v^\\ast - \\frac{(v^\\ast)^3}{3}, \\quad w^\\ast = \\frac{v^\\ast + a}{b},\n$$\n这可以简化为关于 $v^\\ast$ 的标量方程：\n$$\nv^\\ast - \\frac{(v^\\ast)^3}{3} = \\frac{v^\\ast + a}{b}.\n$$\n以机器精度数值计算 $(v^\\ast, w^\\ast)$。\n\n对于下述每个测试用例，从初始条件 $(v(0), w(0)) = (v^\\ast, w^\\ast)$ 开始模拟系统。首先在 $[0, T]$ 上对 $I(t) = I_0$ 的常微分方程进行时间积分，然后在 $[T, T + 100]$ 上对 $I(t) = 0$ 的常微分方程进行时间积分，并检测轨迹是否在某个 $t \\in [T, T + 100]$ 从下向上穿越 $v = 1$。当且仅当发生此类穿越时，我们判定为产生了一个峰电位。\n\n请为以下测试套件提供结果，该套件涵盖了一个典型情况、一个更强的脉冲、一个临界短脉冲、一个极强但极短的脉冲，以及一个无脉冲的对照组：\n- 测试用例 $1$：$I_0 = 0.3$, $T = 5.0$。\n- 测试用例 $2$：$I_0 = 0.8$, $T = 5.0$。\n- 测试用例 $3$：$I_0 = 0.6$, $T = 1.0$。\n- 测试用例 $4$：$I_0 = 1.2$, $T = 0.2$。\n- 测试用例 $5$：$I_0 = 0.0$, $T = 0.0$。\n\n所有量均为无量纲；没有物理单位。程序必须输出单行内容，其中包含一个用方括号括起来的逗号分隔的布尔值列表，每个布尔值表示相应测试用例是否按上述顺序列出而产生峰电位。例如，输出格式必须为 $[b_1,b_2,b_3,b_4,b_5]$，其中每个 $b_i$ 为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "该问题要求对 FitzHugh-Nagumo 模型进行数值模拟，以确定幅度为 $I_0$、持续时间为 $T$ 的矩形输入电流脉冲是否能誘发一个峰电位。峰电位由一个特定判据定义，该判据与脉冲结束后系统的相平面轨迹有关。\n\n该常微分方程 (ODEs) 系统为：\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I(t)\n$$\n$$\n\\frac{dw}{dt} = \\varepsilon \\left( v + a - b w \\right)\n$$\n给定的参数为 $\\varepsilon = 0.08$，$a = 0.7$ 和 $b = 0.8$。输入电流 $I(t)$ 是一个脉冲：当 $t \\in [0, T]$ 时，$I(t) = I_0$；当 $t > T$ 时，$I(t) = 0$。\n\n求解过程包括三个主要步骤：\n1.  **确定初始条件**：系统从对应于 $I(t) = 0$ 的唯一静息平衡点 $(v^*, w^*)$ 开始。\n2.  **模拟轨迹**：常微分方程分两个阶段进行数值积分：首先在 $t=0$到 $t=T$ 期间脉冲开启 ($I(t) = I_0$)，然后在接下来的 $t=T$ 到 $t=T+100$ 期间脉冲关闭 ($I(t) = 0$)。\n3.  **检测峰电位**：在第二阶段，我们监视轨迹是否满足峰电位判据：从左到右穿越直线 $v=1$（即 $v$ 增大的值超过 $1$）。\n\n**步骤 1：计算静息平衡点**\n静息平衡点 $(v^*, w^*)$ 是当 $I(t)=0$ 时系统的定点。通过将时间导数设为零来找到它：\n$$\n\\frac{dv}{dt} = 0 \\implies v^* - \\frac{(v^*)^3}{3} - w^* = 0\n$$\n$$\n\\frac{dw}{dt} = 0 \\implies \\varepsilon \\left( v^* + a - b w^* \\right) = 0\n$$\n从第二个方程，我们得到 $w^* = (v^* + a)/b$。将其代入第一个方程，得到一个关于 $v^*$ 的三次方程：\n$$\nv^* - \\frac{(v^*)^3}{3} - \\frac{v^* + a}{b} = 0\n$$\n整理后得到一个标准多项式形式：\n$$\n\\frac{b}{3}(v^*)^3 + (1-b)v^* + a = 0\n$$\n代入给定的参数值 $a = 0.7$ 和 $b = 0.8$：\n$$\n\\frac{0.8}{3}(v^*)^3 + 0.2v^* + 0.7 = 0 \\implies \\frac{0.8}{3}(v^*)^3 + 0.2v^* + 0.7 = 0\n$$\n这个三次方程有一个实根和两个共轭复根。唯一的实根对应于静息平衡点。我们可以数值求解此方程。其实根被发现约为 $v^* \\approx -1.1994$。对应的 $w^*$ 值则计算为 $w^* = (v^* + a) / b \\approx (-1.1994 + 0.7) / 0.8 \\approx -0.6243$。所有模拟的初始条件为 $(v(0), w(0)) = (v^*, w^*)$。\n\n**步骤 2：轨迹的数值模拟**\n我们将使用一个数值 ODE 求解器，具体来说是 `scipy.integrate.solve_ivp`，来为每个测试用例计算轨迹 $(v(t), w(t))$。每个用例的模拟分为两部分。\n\n*   **阶段 1 (脉冲开启, $t \\in [0, T]$)**：\n    从 $(v^*, w^*)$ 开始，系统在时间区间 $[0, T]$ 内对电流 $I(t) = I_0$ 进行积分。此阶段结束时系统的状态 $(v(T), w(T))$ 作为下一阶段的初始条件。对于 $T=0$ 的特殊情况，此阶段被跳过，阶段 2 的初始状态即为 $(v^*, w^*)$。\n\n*   **阶段 2 (脉冲关闭, $t \\in [T, T+100]$)**：\n    从 $(v(T), w(T))$ 开始，系统在时间区间 $[T, T+100]$ 内对电流 $I(t) = 0$ 进行积分。\n\n**步骤 3：峰电位检测**\n问题将峰电位定义为快变量 $v(t)$ 在任何时间 $t \\ge T$ 从一个较低的值穿越到一个较高的值，越过阈值 $v=1$。这个条件对应于轨迹逃离静息态的吸引盆并发放一个动作电位。\n\n此检测通过使用 `solve_ivp` 函数的事件查找功能实现。我们定义一个事件函数 $f_{event}(t, y) = v(t) - 1$，其中 $y(t) = [v(t), w(t)]$。求解器可以检测该函数何时穿越零。通过指定穿越方向为正（从负到正），我们可以精确地捕捉 $v(t)$ 增大并超过 $1$ 的判据。我们还将该事件设置为“终止”事件，这意味着一旦检测到峰电位，积分就会停止，这在计算上是高效的。对于一个给定的测试用例，当且仅当求解器报告在第二积分阶段发生了此事件时，才记录为一个峰电位。\n\n将此完整过程应用于五个测试用例中的每一个，并记录布尔结果（有峰电位或无峰电位）。最终输出是这些布尔值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the FitzHugh-Nagumo problem for a suite of test cases.\n    \n    This function first computes the resting equilibrium of the model. Then, for\n    each test case (defined by pulse amplitude I0 and duration T), it simulates\n    the ODE system in two phases:\n    1. With the current pulse I0 on, from t=0 to t=T.\n    2. With the current off, from t=T to t=T+100.\n    \n    During the second phase, it detects whether a spike occurs, defined as the\n    membrane voltage v(t) crossing 1 from below. The results are collected\n    and printed in the specified format.\n    \"\"\"\n\n    # Define fixed model parameters\n    eps = 0.08\n    a = 0.7\n    b = 0.8\n\n    # 1. Calculate the resting equilibrium (v*, w*) for I=0\n    # The equilibrium v* is the real root of the cubic equation:\n    # (b/3)v^3 + (1-b)v + a = 0\n    coeffs = [b/3, 0.0, 1-b, a]\n    roots = np.roots(coeffs)\n    # The unique real root is v*\n    v_star = np.real(roots[np.isreal(roots)][0])\n    # The corresponding w* is found from the w-nullcline\n    w_star = (v_star + a) / b\n    \n    initial_conditions = np.array([v_star, w_star])\n    \n    # 2. Define the ODE system (right-hand side)\n    def fhn_rhs(t, y, I_val, eps_val, a_val, b_val):\n        v, w = y\n        dv_dt = v - (v**3 / 3.0) - w + I_val\n        dw_dt = eps_val * (v + a_val - b_val * w)\n        return [dv_dt, dw_dt]\n\n    # 3. Define the spike detection event function\n    # Event occurs when v(t) - 1 = 0\n    def spike_event(t, y, *args):\n        return y[0] - 1.0\n    \n    # an event is only triggered when crossing from negative to positive\n    spike_event.direction = 1\n    # stop integration once a spike is detected\n    spike_event.terminal = True\n\n    # 4. Define test cases from the problem statement\n    test_cases = [\n        (0.3, 5.0),  # Case 1\n        (0.8, 5.0),  # Case 2\n        (0.6, 1.0),  # Case 3\n        (1.2, 0.2),  # Case 4\n        (0.0, 0.0),  # Case 5\n    ]\n\n    results = []\n    \n    # Iterate through each test case\n    for I0, T in test_cases:\n        # Phase 1: Integrate with the pulse ON (I=I0)\n        y_at_T = initial_conditions\n        if T  0:\n            sol1 = solve_ivp(\n                fhn_rhs,\n                [0, T],\n                initial_conditions,\n                args=(I0, eps, a, b),\n                # Using a stiff solver can be more robust for FHN models\n                method='LSODA' \n            )\n            # State at the end of the pulse\n            y_at_T = sol1.y[:, -1]\n        \n        # Phase 2: Integrate with the pulse OFF (I=0) and detect spike\n        t_start_phase2 = T\n        t_end_phase2 = T + 100.0\n        \n        sol2 = solve_ivp(\n            fhn_rhs,\n            [t_start_phase2, t_end_phase2],\n            y_at_T,\n            args=(0.0, eps, a, b), # I_val is 0.0\n            events=spike_event,\n            method='LSODA'\n        )\n        \n        # Check if the spike event was triggered\n        # sol2.t_events[0] will contain the time(s) of the event\n        has_spiked = len(sol2.t_events[0])  0\n        results.append(has_spiked)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}