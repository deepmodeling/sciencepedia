{
    "hands_on_practices": [
        {
            "introduction": "Understanding how a neuron transitions from rest to repetitive firing is central to computational neuroscience. This transition, or bifurcation, determines the neuron's \"excitability class.\" This first practice will guide you through the fundamental distinction between Class I and Class II excitability by connecting the abstract mathematics of linear stability to the concrete, measurable property of a neuron's minimum firing rate. You will calculate the onset firing frequency for a Class II neuron, revealing how the Hopf bifurcation inherently sets a non-zero firing rhythm from the very start .",
            "id": "4994560",
            "problem": "A neuron near its action potential initiation threshold can be described, after appropriate reduction, by a two-dimensional dynamical system for a fast membrane voltage variable and a slower recovery variable. Near a fixed point, small perturbations obey a linear system of the form $\\dot{\\mathbf{x}} = J \\mathbf{x}$, where $J$ is the Jacobian matrix evaluated at the fixed point and $\\mathbf{x}$ collects the deviations of the variables from equilibrium. In this framework, excitability class is determined by the dynamical mechanism at threshold that transforms a stable fixed point into repetitive spiking.\n\nExplain, using linear stability analysis and bifurcation concepts, how excitability class-I differs from excitability class-II in terms of onset frequency at the firing threshold. Then, consider a neuron whose threshold corresponds to a Hopf bifurcation (class-II). At the threshold current $I_{\\mathrm{thr}}$, the linearization yields the Jacobian\n$$\nJ_{\\mathrm{thr}} = \\begin{pmatrix}\n0  -1000 \\\\\n25  0\n\\end{pmatrix} \\quad \\text{with entries in } \\mathrm{s}^{-1}.\n$$\nFrom first principles, determine the minimal firing frequency $f_{\\min}$ (in $\\mathrm{Hz}$) for this class-II neuron in the immediate vicinity of threshold, as predicted by the linear dynamics at the bifurcation point. Express the final frequency in $\\mathrm{Hz}$ and round your answer to three significant figures.",
            "solution": "The problem asks for an explanation of the difference between class-I and class-II neuronal excitability in terms of onset firing frequency, followed by a calculation of the minimal firing frequency for a specific class-II neuron.\n\nThe dynamics of a neuron near its resting state can often be reduced to a two-dimensional system of differential equations:\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}, I)\n$$\nwhere $\\mathbf{x}$ is a state vector, typically containing the membrane potential $V$ and a slower recovery variable $w$, and $I$ is a parameter representing the injected stimulus current. The threshold for action potential generation corresponds to a bifurcation where the stable fixed point (resting state) of the system loses its stability as $I$ is increased. The type of bifurcation determines the neuron's excitability class.\n\nLinear stability analysis involves examining the behavior of the system for small perturbations $\\mathbf{x}$ from a fixed point $\\mathbf{x}_0$. This behavior is governed by the linearized system $\\dot{\\mathbf{x}} = J \\mathbf{x}$, where $J$ is the Jacobian matrix of $\\mathbf{F}$ evaluated at the fixed point, $J = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} |_{\\mathbf{x}_0}$. The stability of the fixed point is determined by the eigenvalues of $J$.\n\n**Class-I Excitability**\nClass-I excitability is characterized by a saddle-node on an invariant circle (SNIC) bifurcation. For stimulus currents $I$ below the threshold $I_{\\mathrm{thr}}$, the system has two fixed points: a stable node (the resting state) and a saddle point. As $I$ approaches $I_{\\mathrm{thr}}$, these two fixed points move towards each other, and the eigenvalues of the Jacobian at the stable node, which are real and negative, change. One eigenvalue approaches zero, while the other remains negative.\nAt the threshold $I = I_{\\mathrm{thr}}$, the stable node and the saddle point coalesce and annihilate. At this bifurcation point, the Jacobian has one eigenvalue exactly equal to zero ($\\lambda_1 = 0$). For $I > I_{\\mathrm{thr}}$, there are no fixed points in that region of the phase space, and the system's trajectory evolves along a limit cycle, which corresponds to repetitive firing of action potentials.\nThe presence of a zero eigenvalue at the bifurcation point creates a \"ghost\" of the annihilated fixed points, a region where the dynamics are very slow. The period $T$ of the newly formed limit cycle is therefore very long for currents just above threshold. The theory of SNIC bifurcations shows that the period scales as $T \\propto (I - I_{\\mathrm{thr}})^{-1/2}$. Consequently, the firing frequency, $f = 1/T$, scales as $f \\propto \\sqrt{I - I_{\\mathrm{thr}}}$. As the current approaches the threshold from above ($I \\to I_{\\mathrm{thr}}^+$), the period diverges ($T \\to \\infty$) and the firing frequency approaches zero ($f \\to 0$).\nThus, a class-I neuron can fire at an arbitrarily low frequency, and its frequency-current (f-I) curve is continuous, starting from $f=0$ at $I=I_{\\mathrm{thr}}$.\n\n**Class-II Excitability**\nClass-II excitability is associated with an Andronov-Hopf bifurcation. For $I  I_{\\mathrm{thr}}$, the system has a single stable fixed point, which is a stable focus (or spiral sink). The eigenvalues of the Jacobian at this fixed point are a complex conjugate pair with negative real parts, $\\lambda = \\alpha(I) \\pm i\\omega(I)$, where $\\alpha(I)  0$. The imaginary part $\\omega(I)$ causes trajectories to spiral into the fixed point.\nAs $I$ increases towards $I_{\\mathrm{thr}}$, the real part of the eigenvalues approaches zero, i.e., $\\alpha(I) \\to 0^-$. At the threshold $I = I_{\\mathrm{thr}}$, the real part becomes zero, $\\alpha(I_{\\mathrm{thr}}) = 0$. The eigenvalues become a purely imaginary complex conjugate pair: $\\lambda = \\pm i\\omega_0$, where $\\omega_0 = \\omega(I_{\\mathrm{thr}}) \\neq 0$.\nAt this bifurcation point, the fixed point loses its stability, and a limit cycle is born. The imaginary part of the eigenvalues, $\\omega_0$, dictates the angular frequency of the oscillations at the onset of firing. This means that as soon as the neuron starts firing (for $I$ just above $I_{\\mathrm{thr}}$), it does so at a specific, non-zero frequency.\nThe minimal firing frequency $f_{\\min}$ is directly determined by this intrinsic angular frequency $\\omega_0$ through the relation $f_{\\min} = \\omega_0 / (2\\pi)$. Unlike class-I, the firing does not start from zero frequency. Instead, the f-I curve exhibits a jump from $f=0$ for $I  I_{\\mathrm{thr}}$ to $f \\approx f_{\\min}$ at $I = I_{\\mathrm{thr}}$.\nThus, a class-II neuron begins firing at a characteristic, non-zero frequency.\n\n**Calculation of Minimal Firing Frequency**\nWe are given the Jacobian matrix at the threshold current $I_{\\mathrm{thr}}$ for a class-II neuron:\n$$\nJ_{\\mathrm{thr}} = \\begin{pmatrix}\n0  -1000 \\\\\n25  0\n\\end{pmatrix} \\quad \\text{with entries in } \\mathrm{s}^{-1}.\n$$\nThe problem states this corresponds to a Hopf bifurcation. The minimal firing frequency is determined by the imaginary part of the eigenvalues of this matrix at the bifurcation point. The eigenvalues $\\lambda$ are found by solving the characteristic equation $\\det(J_{\\mathrm{thr}} - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\n\\det \\begin{pmatrix}\n0 - \\lambda  -1000 \\\\\n25  0 - \\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-\\lambda) - (-1000)(25) = 0\n$$\n$$\n\\lambda^2 + 25000 = 0\n$$\nSolving for $\\lambda$:\n$$\n\\lambda^2 = -25000\n$$\n$$\n\\lambda = \\pm \\sqrt{-25000} = \\pm i \\sqrt{25000}\n$$\nThe eigenvalues are purely imaginary, $\\lambda = \\pm i\\omega_0$, which is the signature of a Hopf bifurcation. The angular frequency of oscillation at the onset of firing is $\\omega_0$. The units of the Jacobian entries are $\\mathrm{s}^{-1}$, so the units of $\\omega_0$ are $\\mathrm{rad}\\cdot\\mathrm{s}^{-1}$.\n$$\n\\omega_0 = \\sqrt{25000} \\ \\mathrm{rad}\\cdot\\mathrm{s}^{-1}\n$$\nThe minimal firing frequency $f_{\\min}$ in Hertz ($\\mathrm{Hz}$) is related to the angular frequency $\\omega_0$ by the formula $f_{\\min} = \\omega_0 / (2\\pi)$.\n$$\nf_{\\min} = \\frac{\\sqrt{25000}}{2\\pi} = \\frac{\\sqrt{2500 \\times 10}}{2\\pi} = \\frac{50\\sqrt{10}}{2\\pi} = \\frac{25\\sqrt{10}}{\\pi}\n$$\nNow, we compute the numerical value and round to three significant figures.\nUsing the values $\\sqrt{10} \\approx 3.162277...$ and $\\pi \\approx 3.141592...$:\n$$\nf_{\\min} \\approx \\frac{25 \\times 3.162277}{3.141592} \\approx \\frac{79.056925}{3.141592} \\approx 25.1632 \\ \\mathrm{Hz}\n$$\nRounding to three significant figures, we get:\n$$\nf_{\\min} \\approx 25.2 \\ \\mathrm{Hz}\n$$",
            "answer": "$$\\boxed{25.2}$$"
        },
        {
            "introduction": "Having established the concept of onset frequency, we now delve into the analytical mechanics of a Class I firing threshold. This type of excitability is often underpinned by a saddle-node on an invariant circle (SNIC) bifurcation, where a neuron can begin firing at an arbitrarily low frequency. In this exercise, you will use phase-plane analysis and the principles of bifurcation theory to derive the exact value of the critical current $I_{\\mathrm{SN}}$ that triggers this transition in a classic FitzHugh-Nagumo-type model. This practice reinforces the geometric intuition behind bifurcations by linking the tangency of nullclines to the birth of oscillatory behavior .",
            "id": "3965535",
            "problem": "A planar conductance-based reduction of a fast membrane potential-like variable and a slow recovery variable is given by the system\n$$\n\\frac{dv}{dt} = v \\left( \\alpha - v^{2} \\right) - w + I, \\qquad \\frac{dw}{dt} = \\varepsilon \\left( v - \\beta w \\right),\n$$\nwhere $\\alpha  0$, $\\beta  0$, $0  \\varepsilon \\ll 1$, and $I \\in \\mathbb{R}$ is a constant applied current. Fixed points are defined by simultaneous zeros of the right-hand sides. Nullclines are defined as the sets where either $\\frac{dv}{dt} = 0$ or $\\frac{dw}{dt} = 0$. A saddle-node bifurcation in the plane occurs when two fixed points coalesce and the Jacobian matrix at the coalescence has a zero eigenvalue. For sufficiently small $\\varepsilon$, the onset of repetitive spiking in such planar reductions can be organized by a Saddle-Node on Invariant Circle (SNIC), which occurs when the saddle-node lies on a periodic orbit.\n\nUsing only the core definitions of fixed points, nullclines, and the local characterization of a saddle-node bifurcation in the plane (tangency of nullclines at the coalescence point together with a zero eigenvalue of the Jacobian), determine the exact value of the critical input current $I_{\\mathrm{SN}}(\\alpha,\\beta)$ at which the right-knee (positive-$v$) saddle-node occurs, expressed purely in terms of $\\alpha$ and $\\beta$. Your final answer must be a single closed-form analytic expression with no units.",
            "solution": "The system of ordinary differential equations is given by:\n$$ \\frac{dv}{dt} = f(v, w) = \\alpha v - v^{3} - w + I $$\n$$ \\frac{dw}{dt} = g(v, w) = \\varepsilon (v - \\beta w) $$\nFixed points $(v, w)$ of the system are defined by the conditions $\\frac{dv}{dt} = 0$ and $\\frac{dw}{dt} = 0$. These conditions define the nullclines of the system.\n\nThe $v$-nullcline is the set of points where $\\frac{dv}{dt} = 0$:\n$$ w = \\alpha v - v^{3} + I $$\nThis is a cubic curve in the $(v, w)$-plane.\n\nThe $w$-nullcline is the set of points where $\\frac{dw}{dt} = 0$. Since $\\varepsilon  0$, this simplifies to:\n$$ v - \\beta w = 0 \\implies w = \\frac{v}{\\beta} $$\nThis is a straight line passing through the origin with a positive slope $\\frac{1}{\\beta}$.\n\nThe fixed points are the intersections of these two nullclines. Substituting the expression for $w$ from the $w$-nullcline into the $v$-nullcline equation gives an equation for the $v$-coordinates of the fixed points:\n$$ \\frac{v}{\\beta} = \\alpha v - v^{3} + I $$\nRearranging this equation yields a cubic polynomial in $v$:\n$$ v^{3} + \\left(\\frac{1}{\\beta} - \\alpha\\right)v - I = 0 $$\nA saddle-node bifurcation occurs when two fixed points coalesce and disappear. Geometrically, this corresponds to the point where the $v$-nullcline and the $w$-nullcline are tangent to each other. At a point of tangency, their slopes with respect to $v$ must be equal.\n\nThe slope of the $v$-nullcline is found by differentiating $w$ with respect to $v$:\n$$ \\frac{dw}{dv} = \\frac{d}{dv} \\left(\\alpha v - v^{3} + I\\right) = \\alpha - 3v^{2} $$\nThe slope of the $w$-nullcline is:\n$$ \\frac{dw}{dv} = \\frac{d}{dv} \\left(\\frac{v}{\\beta}\\right) = \\frac{1}{\\beta} $$\nEquating the slopes gives the $v$-coordinate, which we denote as $v_{\\mathrm{SN}}$, of the saddle-node bifurcation point:\n$$ \\alpha - 3v_{\\mathrm{SN}}^{2} = \\frac{1}{\\beta} \\implies 3v_{\\mathrm{SN}}^{2} = \\alpha - \\frac{1}{\\beta} = \\frac{\\alpha \\beta - 1}{\\beta} $$\n$$ v_{\\mathrm{SN}}^{2} = \\frac{\\alpha \\beta - 1}{3\\beta} $$\nThe problem asks for the \"right-knee\" saddle-node bifurcation, which by convention corresponds to the local extremum of the cubic nullcline at a positive $v$ value. We thus take the positive root:\n$$ v_{\\mathrm{SN}} = \\sqrt{\\frac{\\alpha \\beta - 1}{3\\beta}} $$\nFor a real-valued $v_{\\mathrm{SN}}$ to exist, we require $\\alpha \\beta \\ge 1$.\n\nThis result can be confirmed by analyzing the Jacobian matrix of the system. The Jacobian $J$ at a fixed point $(v, w)$ is:\n$$ J(v, w) = \\begin{pmatrix} \\frac{\\partial f}{\\partial v}  \\frac{\\partial f}{\\partial w} \\\\ \\frac{\\partial g}{\\partial v}  \\frac{\\partial g}{\\partial w} \\end{pmatrix} = \\begin{pmatrix} \\alpha - 3v^{2}  -1 \\\\ \\varepsilon  -\\varepsilon\\beta \\end{pmatrix} $$\nA saddle-node bifurcation is characterized by one of the eigenvalues of the Jacobian being zero. This occurs if and only if the determinant of the Jacobian is zero.\n$$ \\det(J) = (\\alpha - 3v^{2})(-\\varepsilon\\beta) - (-1)(\\varepsilon) = -\\varepsilon\\beta(\\alpha - 3v^{2}) + \\varepsilon = \\varepsilon(1 - \\beta(\\alpha - 3v^{2})) $$\nSetting $\\det(J) = 0$, and since $\\varepsilon \\ne 0$:\n$$ 1 - \\beta(\\alpha - 3v^{2}) = 0 \\implies \\alpha - 3v^{2} = \\frac{1}{\\beta} $$\nThis is the same condition derived from the tangency of nullclines, confirming the value of $v_{\\mathrm{SN}}$.\n\nNow, we determine the critical current $I_{\\mathrm{SN}}$ at which this bifurcation occurs. The bifurcation point $(v_{\\mathrm{SN}}, w_{\\mathrm{SN}})$ is a fixed point, and so it must lie on both nullclines. We use the fixed point equation:\n$$ I = \\frac{v}{\\beta} - \\alpha v + v^{3} $$\nSubstituting $v = v_{\\mathrm{SN}}$ gives the critical current $I_{\\mathrm{SN}}$:\n$$ I_{\\mathrm{SN}} = v_{\\mathrm{SN}} \\left( \\frac{1}{\\beta} - \\alpha + v_{\\mathrm{SN}}^{2} \\right) $$\nWe have already found $v_{\\mathrm{SN}}^{2} = \\frac{\\alpha \\beta - 1}{3\\beta}$. Substituting this into the expression for $I_{\\mathrm{SN}}$:\n$$ I_{\\mathrm{SN}} = v_{\\mathrm{SN}} \\left( \\frac{1}{\\beta} - \\alpha + \\frac{\\alpha \\beta - 1}{3\\beta} \\right) $$\nLet's simplify the term in the parentheses:\n$$ \\frac{1}{\\beta} - \\alpha + \\frac{\\alpha \\beta - 1}{3\\beta} = \\frac{3 - 3\\alpha\\beta + \\alpha\\beta - 1}{3\\beta} = \\frac{2 - 2\\alpha\\beta}{3\\beta} = -\\frac{2(\\alpha\\beta - 1)}{3\\beta} $$\nNow, substitute this back into the equation for $I_{\\mathrm{SN}}$, along with the expression for $v_{\\mathrm{SN}}$:\n$$ I_{\\mathrm{SN}} = \\left( \\sqrt{\\frac{\\alpha \\beta - 1}{3\\beta}} \\right) \\left( -\\frac{2(\\alpha\\beta - 1)}{3\\beta} \\right) $$\nThis expression can be simplified by combining terms:\n$$ I_{\\mathrm{SN}} = -2 \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{\\frac{1}{2}} \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{1} $$\n$$ I_{\\mathrm{SN}} = -2 \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{\\frac{3}{2}} $$\nThis is the final analytical expression for the critical current $I_{\\mathrm{SN}}$ at the right-knee saddle-node bifurcation point, expressed purely in terms of the parameters $\\alpha$ and $\\beta$.",
            "answer": "$$ \\boxed{-2 \\left( \\frac{\\alpha \\beta - 1}{3 \\beta} \\right)^{\\frac{3}{2}}} $$"
        },
        {
            "introduction": "Our final practice bridges the gap between simplified analytical models and the complex dynamics of biophysically realistic neurons. Here, you will work with the Morris-Lecar model, a cornerstone of conductance-based modeling, to numerically investigate how cellular parameters and synaptic inputs shape neuronal excitability. By implementing a simulation to find the firing threshold and measure the onset frequency, you will classify the neuron's behavior as Type I or Type II, gaining hands-on experience with the computational methods used to analyze and predict the rich dynamics of real nervous systems .",
            "id": "3965524",
            "problem": "You are asked to implement a complete, runnable program that analyzes how tonic synaptic input and intrinsic adaptation modulate the bifurcation structure of neuronal excitability in a conductance-based neuron model. The analysis must distinguish between Type I excitability, typically associated with saddle-node on invariant circle (SNIC) or homoclinic bifurcations, and Type II excitability, typically associated with supercritical Hopf bifurcations. All quantities involving time must be expressed in milliseconds (ms), all voltages in millivolts (mV), all capacitive densities in microfarads per square centimeter ($\\mu\\mathrm{F}/\\mathrm{cm}^2$), and all conductance densities in millisiemens per square centimeter ($\\mathrm{mS}/\\mathrm{cm}^2$). Currents must be in microamperes per square centimeter ($\\mu\\mathrm{A}/\\mathrm{cm}^2$). Angles do not appear in this problem.\n\nThe fundamental base to use is the conductance-based formulation of membrane dynamics and gating kinetics. The membrane equation is derived from charge conservation and Ohm’s law, and gating kinetics are parameterized via sigmoidal steady-state activation and voltage-dependent time scales. Specifically, the neuron is modeled by the two-dimensional Morris–Lecar system with an added tonic synaptic conductance, where the membrane potential $V$ and the recovery variable $w$ satisfy\n$$\nC \\frac{dV}{dt} = - g_{\\mathrm{Ca}} m_{\\infty}(V)\\,(V - V_{\\mathrm{Ca}}) - g_{\\mathrm{K}}\\, w\\, (V - V_{\\mathrm{K}}) - g_{\\mathrm{L}} (V - V_{\\mathrm{L}}) - g_{\\mathrm{syn}}\\, s\\, (V - E_{\\mathrm{syn}}) + I_{\\mathrm{app}},\n$$\n$$\n\\frac{dw}{dt} = \\phi\\, \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}.\n$$\nThe voltage-dependent steady-state activation functions and time scale are given by\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_1}{V_2}\\right)\\right), \\quad\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_3}{V_4}\\right)\\right), \\quad\n\\tau_w(V) = \\frac{1}{\\cosh\\!\\left(\\frac{V - V_3}{2 V_4}\\right)}.\n$$\nThe parameter $\\phi$ modulates the time scale of the recovery variable $w$ and thus represents intrinsic adaptation speed. The tonic synaptic input is modeled as a constant gating variable $s = 1$ with conductance $g_{\\mathrm{syn}}$ and reversal potential $E_{\\mathrm{syn}}$.\n\nYour program must implement the following tasks and produce the specified outputs:\n\n1. For a given parameter set, determine the minimal applied current $I_{\\mathrm{th}}$ at which the system exhibits sustained oscillations (tonic spiking) using numerical simulation. Use a bracketing and bisection approach on $I_{\\mathrm{app}}$ within the provided interval until you find $I_{\\mathrm{th}}$ up to a tolerance of $\\Delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$, defined as the smallest $I_{\\mathrm{app}}$ such that the firing rate exceeds $0.5$ hertz (Hz), where hertz means spikes per second and one second equals $1000$ milliseconds.\n\n2. For $I_{\\mathrm{app}} = I_{\\mathrm{th}} + \\delta I$, with $\\delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$, estimate the firing frequency $f_{\\mathrm{onset}}$ in hertz by counting threshold crossings of $V$ with a voltage threshold of $0\\,\\mathrm{mV}$ and positive slope over a post-transient window. Use spike counts divided by the duration (in seconds) of the measurement window.\n\n3. Classify excitability type as follows:\n   - If $f_{\\mathrm{onset}}  10.0$ hertz, classify the case as Type I and record the integer $1$.\n   - Otherwise, classify the case as Type II and record the integer $2$.\n   This classification is justified by the principle that Type I excitability arises at zero frequency at onset (as in saddle-node on invariant circle or homoclinic bifurcations), while Type II excitability arises with a nonzero frequency at onset (as in supercritical Hopf bifurcations).\n\n4. Apply this procedure to the following test suite of parameter sets. Unless otherwise specified, use $C = 20\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$, $g_{\\mathrm{Ca}} = 4.4\\,\\mathrm{mS}/\\mathrm{cm}^2$, $g_{\\mathrm{K}} = 8.0\\,\\mathrm{mS}/\\mathrm{cm}^2$, $g_{\\mathrm{L}} = 2.0\\,\\mathrm{mS}/\\mathrm{cm}^2$, $V_{\\mathrm{Ca}} = 120\\,\\mathrm{mV}$, $V_{\\mathrm{K}} = -84\\,\\mathrm{mV}$, $V_{\\mathrm{L}} = -60\\,\\mathrm{mV}$, $V_1 = -1.2\\,\\mathrm{mV}$, $V_2 = 18\\,\\mathrm{mV}$, and initial condition $V(0) = -60\\,\\mathrm{mV}$, $w(0) = w_{\\infty}(V(0))$. Use $s = 1$.\n   - Case A (baseline Type I-like nullclines): $V_3 = 12\\,\\mathrm{mV}$, $V_4 = 17.4\\,\\mathrm{mV}$, $\\phi = 0.04\\,\\mathrm{ms}^{-1}$, $g_{\\mathrm{syn}} = 0\\,\\mathrm{mS}/\\mathrm{cm}^2$, $E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$; bracket search over $I_{\\mathrm{app}} \\in [0, 60]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$.\n   - Case B (baseline Type II-like nullclines): $V_3 = 2\\,\\mathrm{mV}$, $V_4 = 30\\,\\mathrm{mV}$, $\\phi = 0.2\\,\\mathrm{ms}^{-1}$, $g_{\\mathrm{syn}} = 0\\,\\mathrm{mS}/\\mathrm{cm}^2$, $E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$; bracket search over $I_{\\mathrm{app}} \\in [60, 140]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$.\n   - Case C (adaptation-modulated onset with tonic synaptic shunt): $V_3 = 12\\,\\mathrm{mV}$, $V_4 = 17.4\\,\\mathrm{mV}$, $\\phi = 0.2\\,\\mathrm{ms}^{-1}$, $g_{\\mathrm{syn}} = 1.0\\,\\mathrm{mS}/\\mathrm{cm}^2$, $E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$; bracket search over $I_{\\mathrm{app}} \\in [30, 100]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$.\n\nYour program must implement numerical integration with a fixed evaluation grid to measure $V(t)$, discard transients, and compute spike counts. Use a total simulation time of several seconds expressed in milliseconds to ensure that low-frequency oscillations are detectable. Your program must produce a single line of output containing the classification results for the three cases as a comma-separated list enclosed in square brackets; for example, the output must be of the form $[r_1,r_2,r_3]$ where each $r_i$ is the integer $1$ or $2$ for the corresponding case.\n\nThe answer for each test case is a single integer and must be reported in the specified aggregated single-line format. No additional text beyond this single line is permitted in the program’s output.",
            "solution": "The solution classifies the excitability type of a neuron model under different parameter regimes by analyzing the firing frequency at the onset of spiking. The model is a two-dimensional Morris-Lecar system of ordinary differential equations for the membrane potential $V$ and a recovery variable $w$. The governing equations are:\n$$\nC \\frac{dV}{dt} = - g_{\\mathrm{Ca}} m_{\\infty}(V)\\,(V - V_{\\mathrm{Ca}}) - g_{\\mathrm{K}}\\, w\\, (V - V_{\\mathrm{K}}) - g_{\\mathrm{L}} (V - V_{\\mathrm{L}}) - g_{\\mathrm{syn}}\\, s\\, (V - E_{\\mathrm{syn}}) + I_{\\mathrm{app}}\n$$\n$$\n\\frac{dw}{dt} = \\phi\\, \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\nwhere the steady-state activation and time scale functions are given by:\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_1}{V_2}\\right)\\right)\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\!\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\nThe analysis proceeds according to a precise numerical protocol, which is implemented in the provided Python code:\n\n1.  **Numerical Integration**: The system of ordinary differential equations is solved numerically to obtain the time evolution of $V(t)$ and $w(t)$. The code employs a robust integration method (`solve_ivp` from SciPy), suitable for such systems. The simulation runs for $5000\\,\\mathrm{ms}$ to allow for the detection of low-frequency oscillations.\n\n2.  **Firing Rate Calculation**: To determine if the neuron is exhibiting sustained spiking, its firing rate is calculated. After discarding an initial transient period of $1000\\,\\mathrm{ms}$, the number of spikes is counted in the subsequent measurement window. A spike is defined as an event where the membrane potential $V(t)$ crosses a threshold of $0\\,\\mathrm{mV}$ with a positive slope. The firing rate in hertz (Hz) is then computed as the number of spikes divided by the duration of the measurement window in seconds.\n\n3.  **Threshold Current Search**: A bisection search algorithm finds the minimal applied current $I_{\\mathrm{th}}$ that elicits a firing rate exceeding $0.5\\,\\mathrm{Hz}$. The algorithm iteratively narrows the current interval for each case until its width is no more than the specified tolerance, $\\Delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$. The upper bound of the final interval is designated as the threshold current $I_{\\mathrm{th}}$.\n\n4.  **Excitability Classification**: The type of excitability is determined by the firing frequency at the onset of spiking. The neuron is simulated with an applied current of $I_{\\mathrm{app}} = I_{\\mathrm{th}} + 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$. The resulting firing rate is the onset frequency, $f_{\\mathrm{onset}}$. The classification is then made according to the rule: if $f_{\\mathrm{onset}}  10.0\\,\\mathrm{Hz}$, the excitability is classified as Type I (integer 1); otherwise, it is classified as Type II (integer 2).\n\nThis complete numerical procedure is applied to each of the three test cases, yielding a classification integer for each, which is then printed in the required format.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Analyzes the bifurcation structure and excitability type of a modified\n    Morris-Lecar neuron model for three different parameter sets.\n    \"\"\"\n\n    # --- Model Definition ---\n    def m_inf(V, V1, V2):\n        return 0.5 * (1 + np.tanh((V - V1) / V2))\n\n    def w_inf(V, V3, V4):\n        return 0.5 * (1 + np.tanh((V - V3) / V4))\n\n    def tau_w(V, V3, V4):\n        return 1.0 / np.cosh((V - V3) / (2 * V4))\n\n    def derivatives(t, y, params):\n        V, w = y\n        p = params\n        \n        # Unpack parameters\n        C, g_Ca, g_K, g_L, g_syn, V_Ca, V_K, V_L, E_syn, V1, V2, V3, V4, phi, I_app = (\n            p['C'], p['g_Ca'], p['g_K'], p['g_L'], p['g_syn'], p['V_Ca'], p['V_K'], p['V_L'],\n            p['E_syn'], p['V1'], p['V2'], p['V3'], p['V4'], p['phi'], p['I_app']\n        )\n        s = 1.0  # Tonic synaptic gating\n\n        minf = m_inf(V, V1, V2)\n        winf = w_inf(V, V3, V4)\n        tauw = tau_w(V, V3, V4)\n\n        dV_dt = (-g_Ca * minf * (V - V_Ca) -\n                 g_K * w * (V - V_K) -\n                 g_L * (V - V_L) -\n                 g_syn * s * (V - E_syn) +\n                 I_app) / C\n        \n        dw_dt = phi * (winf - w) / tauw\n\n        return [dV_dt, dw_dt]\n\n    # --- Simulation and Analysis ---\n    def run_simulation_and_get_freq(params, I_app):\n        \"\"\"\n        Runs a simulation for a given I_app and calculates the firing frequency.\n        \"\"\"\n        sim_params = params.copy()\n        sim_params['I_app'] = I_app\n\n        # Simulation settings\n        T_total = 5000.0  # ms\n        dt = 0.1  # ms\n        T_transient = 1000.0  # ms\n        V_thresh = 0.0  # mV\n\n        # Initial conditions\n        V0 = -60.0\n        w0 = w_inf(V0, sim_params['V3'], sim_params['V4'])\n        y0 = [V0, w0]\n\n        # Time vector for evaluation\n        t_eval = np.arange(0, T_total, dt)\n\n        # Solve ODE\n        sol = solve_ivp(derivatives, [0, T_total], y0, args=(sim_params,),\n                        dense_output=True, t_eval=t_eval, method='RK45')\n        \n        V = sol.y[0]\n        \n        # Spike counting post-transient\n        transient_idx = int(T_transient / dt)\n        V_measure = V[transient_idx:]\n        \n        spike_count = 0\n        for i in range(1, len(V_measure)):\n            if V_measure[i - 1]  V_thresh and V_measure[i] = V_thresh:\n                spike_count += 1\n        \n        measure_duration_s = (T_total - T_transient) / 1000.0\n        \n        if measure_duration_s  0:\n            return spike_count / measure_duration_s\n        else:\n            return 0.0\n\n    def find_I_th(params, I_range):\n        \"\"\"\n        Performs a bisection search to find the threshold current I_th.\n        \"\"\"\n        low, high = I_range\n        tol = 0.5  # uA/cm^2\n        freq_crit = 0.5  # Hz\n\n        # Check boundaries to ensure search is valid\n        if run_simulation_and_get_freq(params, low)  freq_crit:\n            # The lower bound already produces spiking, threshold is lower\n            return low\n        if run_simulation_and_get_freq(params, high) = freq_crit:\n            # The upper bound doesn't produce spiking, threshold is higher\n            return high \n            \n        while (high - low)  tol:\n            mid = (low + high) / 2.0\n            freq = run_simulation_and_get_freq(params, mid)\n            if freq  freq_crit:\n                high = mid\n            else:\n                low = mid\n        return high\n\n    # --- Main Execution Logic ---\n    # Default parameters\n    BASE_PARAMS = {\n        'C': 20.0, 'g_Ca': 4.4, 'g_K': 8.0, 'g_L': 2.0,\n        'V_Ca': 120.0, 'V_K': -84.0, 'V_L': -60.0,\n        'V1': -1.2, 'V2': 18.0, 's': 1.0\n    }\n\n    # Test cases\n    test_cases = [\n        # Case A: Baseline Type I-like\n        {'V3': 12.0, 'V4': 17.4, 'phi': 0.04, 'g_syn': 0.0, 'E_syn': 0.0, 'I_range': [0, 60]},\n        # Case B: Baseline Type II-like\n        {'V3': 2.0, 'V4': 30.0, 'phi': 0.2, 'g_syn': 0.0, 'E_syn': 0.0, 'I_range': [60, 140]},\n        # Case C: Adaptation-modulated with shunt\n        {'V3': 12.0, 'V4': 17.4, 'phi': 0.2, 'g_syn': 1.0, 'E_syn': 0.0, 'I_range': [30, 100]}\n    ]\n    \n    results = []\n    delta_I = 0.5  # uA/cm^2\n    f_classify_thresh = 10.0 # Hz\n\n    for case_spec in test_cases:\n        params = BASE_PARAMS.copy()\n        params.update(case_spec)\n        \n        # 1. Find threshold current I_th\n        I_th = find_I_th(params, params['I_range'])\n        \n        # 2. Get onset frequency\n        I_onset = I_th + delta_I\n        f_onset = run_simulation_and_get_freq(params, I_onset)\n        \n        # 3. Classify excitability\n        if f_onset  f_classify_thresh:\n            classification = 1  # Type I\n        else:\n            classification = 2  # Type II\n        \n        results.append(classification)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}