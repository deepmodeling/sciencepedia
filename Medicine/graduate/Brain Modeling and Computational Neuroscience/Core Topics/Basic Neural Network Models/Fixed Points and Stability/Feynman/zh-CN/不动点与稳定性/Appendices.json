{
    "hands_on_practices": [
        {
            "introduction": "线性稳定性分析是在平衡点附近理解动力学系统行为的首要工具。这项练习提供了一个标准流程的实践：首先定位系统的固定点，然后计算在该点的雅可比矩阵，最后通过分析其特征值的实部来判断稳定性。通过这个例子，你将掌握分析二维系统稳定性的基本方法，这是后续更复杂分析的基础。",
            "id": "440703",
            "problem": "考虑由以下微分方程定义的动力系统：\n\n$$\n\\frac{dx}{dt} = -x + y, \\quad \\frac{dy}{dt} = -x - y^3.\n$$\n\n当两个时间导数同时为零时，出现一个不动点。求该系统的不动点。然后，对每个不动点，计算在该点求值的雅可比矩阵的特征值的实部。特征值的实部决定了线性稳定性：如果为负，则不动点是线性稳定的；如果为正，则是不稳定的。报告每个不动点的特征值的实部。由于特征值可能是复数，其实部是一个实数。最终答案是该不动点（们）的特征值的实部，如果只有一个不动点，则表示为单个实数。",
            "solution": "我们通过令 $\\dot x=-x+y=0$ 和 $\\dot y=-x-y^3=0$ 来寻找不动点。\n1. 从 $-x+y=0$ 我们得到 $y=x$。\n2. 代入 $-x-y^3=0$ 得到 $-y-y^3=0\\implies y(1+y^2)=0$，因此唯一的实数解是 $y=0$，从而 $x=0$。\n因此，唯一的不动点是 $(0,0)$。\n\n雅可比矩阵是\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(-x+y)  \\frac{\\partial}{\\partial y}(-x+y) \\\\ \\frac{\\partial}{\\partial x}(-x-y^3)  \\frac{\\partial}{\\partial y}(-x-y^3) \\end{pmatrix} = \\begin{pmatrix} -1  1 \\\\ -1  -3y^2 \\end{pmatrix}.\n$$\n在 $(0,0)$ 处，该矩阵变为\n$$\nJ(0,0) = \\begin{pmatrix} -1  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n特征方程是\n$$\n\\det(J-\\lambda I) = \\det\\begin{pmatrix}-1-\\lambda  1 \\\\ -1  -\\lambda\\end{pmatrix} = (-1-\\lambda)(-\\lambda) - (1)(-1) = \\lambda^2+\\lambda+1=0,\n$$\n所以特征值是\n$$\n\\lambda=\\frac{-1\\pm i\\sqrt{3}}{2}.\n$$\n因此，每个特征值的实部是\n$$\n\\Re(\\lambda)=-\\frac12.\n$$",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "当线性化分析不足以判断稳定性，或者我们需要证明更大范围内的稳定性时，就需要更强大的工具。李雅普诺夫第二方法提供了一种优雅的替代方案，它通过构造一个类似于“能量”的函数（李雅普诺夫函数）来直接证明稳定性，而无需求解微分方程。这项练习将指导你应用此方法，通过检验李雅普诺夫函数沿系统轨线的时间导数的符号，来判断一个非线性系统在原点的稳定性。",
            "id": "440581",
            "problem": "考虑由以下微分方程定义的动力系统：\n\n$$\n\\dot{x} = -x^3 + y^4, \\quad \\dot{y} = -2x^2 y - y^3.\n$$\n\n原点 $(0,0)$ 是一个不动点。使用正定的李雅普诺夫函数 $V(x,y) = x^2 + \\frac{1}{2} y^2$，计算沿轨迹的时间导数 $\\dot{V}(x,y)$。证明 $\\dot{V}$ 在原点的一个邻域内是负定的，并由此得出原点是渐近稳定的结论。\n\n$\\dot{V}(x,y)$ 的表达式是什么？",
            "solution": "步骤1：定义李雅普诺夫函数\n$$\nV(x,y)=x^2+\\frac12y^2.\n$$\n步骤2：计算其偏导数\n$$\n\\frac{\\partial V}{\\partial x}=2x,\\quad \\frac{\\partial V}{\\partial y}=y.\n$$\n步骤3：使用系统方程 $\\dot x=-x^3+y^4$、$\\dot y=-2x^2y-y^3$ 来得到\n$$\n\\dot V=\\frac{\\partial V}{\\partial x}\\dot x+\\frac{\\partial V}{\\partial y}\\dot y\n=2x(-x^3+y^4)+y(-2x^2y-y^3).\n$$\n步骤4：展开并合并项\n$$\n\\dot V=-2x^4+2x y^4-2x^2y^2-y^4\n=-2x^4-2x^2y^2-y^4+2x y^4.\n$$",
            "answer": "$$\\boxed{-2x^4-2x^2y^2-y^4+2x y^4}$$"
        },
        {
            "introduction": "现在，让我们将稳定性理论应用于计算神经科学的核心模型之一：循环神经网络（RNN）。这个实践练习超越了简单的稳定性检查，通过编程来探索神经网络动态中一个微妙而重要的现象——非正规网络中的瞬态放大。你将分析一个线性RNN模型的固定点不仅是否稳定，还将量化其在达到稳定之前可能出现的瞬态响应大小，并评估其对扰动的鲁棒性，这对于理解记忆和决策等神经计算至关重要。",
            "id": "3981751",
            "problem": "考虑一个连续时间线性循环神经网络 (RNN)，其状态向量 $\\mathbf{x}(t) \\in \\mathbb{R}^{n}$ 由以下线性时不变 (LTI) 动力学方程控制\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\mathbf{x}(t) + W \\mathbf{x}(t) + \\mathbf{u}(t),\n$$\n其中 $W \\in \\mathbb{R}^{n \\times n}$ 是循环连接矩阵，$\\mathbf{u}(t)$ 是外部输入。在零输入 $\\mathbf{u}(t) \\equiv \\mathbf{0}$ 的情况下，其唯一不动点是 $\\mathbf{x}^{\\star} = \\mathbf{0}$。定义系统矩阵 $A := W - I$，其中 $I$ 是单位矩阵。对于齐次动力学 $\\frac{d\\mathbf{x}}{dt} = A \\mathbf{x}(t)$，其解为 $\\mathbf{x}(t) = e^{A t} \\mathbf{x}(0)$。\n\n一个不动点是渐近稳定的，当且仅当对于任意 $\\mathbf{x}(0)$，其解满足 $\\lim_{t \\to \\infty} \\mathbf{x}(t) = \\mathbf{0}$。在线性情况下，这种情况发生的充要条件是谱横坐标 $\\alpha(A) := \\max \\{ \\mathrm{Re}(\\lambda) : \\lambda \\in \\sigma(A) \\}$ 严格为负。尽管系统是渐近稳定的，但对于一个非正规的 $W$（即 $W W^{\\top} \\neq W^{\\top} W$），由于 $\\lVert e^{A t} \\rVert_{2}$ 的行为，状态的范数可能会表现出瞬态增长，其中 $\\lVert \\cdot \\rVert_{2}$ 表示由欧几里得向量范数诱导的算子范数。这种瞬态增长对不动点的鲁棒性有影响，因为它关系到在渐近衰减起主导作用之前，能将系统推离不动点的扰动的大小。对于非结构化复扰动，一个定量的鲁棒性度量是复稳定性半径 $r_{c}(A)$。当 $A$ 渐近稳定时，它可以通过频率响应界近似为 $r_{c}(A) \\approx \\left( \\sup_{\\omega \\in \\mathbb{R}} \\lVert (i \\omega I - A)^{-1} \\rVert_{2} \\right)^{-1}$。\n\n你的任务是编写一个程序，对于一组给定的小矩阵 $W$，确定以下内容：\n- 通过检查 $\\alpha(A)  0$ 来确定在 $\\mathbf{u}(t) \\equiv \\mathbf{0}$ 条件下不动点 $\\mathbf{x}^{\\star} = \\mathbf{0}$ 的渐近稳定性。\n- 在均匀时间网格 $t_{k} = k \\Delta t$（其中 $k = 0, 1, \\dots, \\lfloor T_{\\max} / \\Delta t \\rfloor$）上估计的峰值瞬态放大 $G := \\sup_{t \\in [0, T_{\\max}]} \\lVert e^{A t} \\rVert_{2}$。\n- 采样放大达到其最大值的时间 $t_{\\mathrm{peak}} \\in [0, T_{\\max}]$。\n- 在均匀频率网格 $\\omega_{j} = -\\Omega_{\\max} + j \\Delta \\omega$（其中 $j = 0, 1, \\dots, \\left\\lfloor \\frac{2 \\Omega_{\\max}}{\\Delta \\omega} \\right\\rfloor$）上估计的近似复稳定性半径 $r_{c}(A) \\approx \\left( \\sup_{\\omega \\in [-\\Omega_{\\max}, \\Omega_{\\max}]} \\lVert (i \\omega I - A)^{-1} \\rVert_{2} \\right)^{-1}$。如果系统不是渐近稳定的（即 $\\alpha(A) \\ge 0$），则定义 $r_{c}(A) := 0$，而不执行频域计算。\n\n数值要求：\n- 对所有矩阵范数使用算子 $2$-范数。\n- 时间网格使用 $T_{\\max} = 20.0$ 秒和 $\\Delta t = 0.005$ 秒。\n- 频率网格使用 $\\Omega_{\\max} = 5.0$ 弧度/秒和 $\\Delta \\omega = 0.005$ 弧度/秒。\n- 报告的时间 $t_{\\mathrm{peak}}$ 以秒为单位。增益 $G$ 和半径 $r_{c}(A)$ 是无单位的。\n- 为保证数值稳定性，在检查渐近稳定性时，将 $\\alpha(A)  -10^{-9}$ 视为稳定，否则视为不稳定。\n\n测试套件：\n- 情况 1 (正规，渐近稳定): $W_{1} = \\begin{bmatrix} 0.8  0.0 \\\\ 0.0  0.6 \\end{bmatrix}$。\n- 情况 2 (非正规，渐近稳定但有瞬态增长): $W_{2} = \\begin{bmatrix} 0.9  5.0 \\\\ 0.0  0.9 \\end{bmatrix}$。\n- 情况 3 (非正规，临界稳定边界): $W_{3} = \\begin{bmatrix} 1.0  1.0 \\\\ 0.0  1.0 \\end{bmatrix}$。\n- 情况 4 (正规，不稳定): $W_{4} = \\begin{bmatrix} 1.05  0.0 \\\\ 0.0  0.8 \\end{bmatrix}$。\n\n最终输出格式：\n- 对于每种情况 $i \\in \\{1,2,3,4\\}$，你的程序必须生成一个列表 $[s_{i}, G_{i}, t_{\\mathrm{peak}, i}, r_{c,i}]$，其中 $s_{i}$ 是一个布尔值，表示渐近稳定性；$G_{i}$ 是峰值瞬态放大（浮点数）；$t_{\\mathrm{peak}, i}$ 是峰值时间（浮点数，以秒为单位）；$r_{c,i}$ 是近似复稳定性半径（浮点数）。\n- 将四个情况的结果按上述顺序汇总到一个单一列表中。\n- 将所有浮点输出 $G_{i}$、$t_{\\mathrm{peak}, i}$ 和 $r_{c,i}$ 四舍五入到恰好六位小数。\n- 你的程序应生成单行输出，其中包含一个以逗号分隔的 Python 风格的列表之列表，并用方括号括起来（例如，$\\big[ [\\text{True}, 1.000000, 0.000000, 0.200000], \\dots \\big]$）。不应打印任何其他文本。",
            "solution": "该问题要求分析由以下状态空间方程描述的连续时间线性循环神经网络 (RNN)：\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\mathbf{x}(t) + W \\mathbf{x}(t) + \\mathbf{u}(t)\n$$\n其中 $\\mathbf{x}(t) \\in \\mathbb{R}^{n}$ 是状态向量，$W \\in \\mathbb{R}^{n \\times n}$ 是循环连接矩阵，$\\mathbf{u}(t)$ 是外部输入。我们在零输入 $\\mathbf{u}(t) \\equiv \\mathbf{0}$ 的条件下分析该系统，此时其唯一不动点为 $\\mathbf{x}^{\\star} = \\mathbf{0}$。通过定义系统矩阵 $A := W - I$（其中 $I$ 是 $n \\times n$ 的单位矩阵），可以将动力学方程重写为标准线性时不变 (LTI) 形式 $\\frac{d\\mathbf{x}}{dt} = A \\mathbf{x}(t)$。\n\n对每个给定的矩阵 $W$，分析涉及四个主要的计算任务：\n1.  确定不动点的渐近稳定性。\n2.  估计峰值瞬态放大 $G$ 及其发生的时间 $t_{\\mathrm{peak}}$。\n3.  近似计算复稳定性半径 $r_c(A)$。\n\n解决方案通过对每个给定的 $W$ 矩阵执行一个分步过程来进行。\n\n**步骤 1：构建系统矩阵 $A$**\n对于每个提供的权重矩阵 $W$，计算相应的系统矩阵 $A$ 为 $A = W - I$。\n\n**步骤 2：确定渐近稳定性**\nLTI 系统 $\\frac{d\\mathbf{x}}{dt} = A \\mathbf{x}(t)$ 的不动点 $\\mathbf{x}^{\\star} = \\mathbf{0}$ 的渐近稳定性由矩阵 $A$ 的特征值决定。系统是渐近稳定的，当且仅当 $A$ 的所有特征值都具有严格为负的实部。该条件等价于要求 $A$ 的谱横坐标（定义为 $\\alpha(A) := \\max \\{ \\mathrm{Re}(\\lambda) : \\lambda \\in \\sigma(A) \\}$）严格为负。这里，$\\sigma(A)$ 表示 $A$ 的特征值集合。\n步骤如下：\n- 计算矩阵 $A$ 的特征值。\n- 找出这些特征值实部的最大值，得到 $\\alpha(A)$。\n- 根据问题的数值要求，如果 $\\alpha(A)  -10^{-9}$，则认为系统是渐近稳定的。我们将分配一个布尔值 $s$，稳定时为 `True`，否则为 `False`。\n\n**步骤 3：估计峰值瞬态放大 ($G$) 和时间 ($t_{\\mathrm{peak}}$)**\n即使对于一个渐近稳定的系统，状态范数 $\\lVert \\mathbf{x}(t) \\rVert_{2}$ 在衰减到零之前也可能表现出瞬态增长。这种现象在具有非正规矩阵 $A$（即 $A A^{\\top} \\neq A^{\\top} A$）的系统中尤其显著。初始条件的放大由矩阵指数的算子 $2$-范数 $\\lVert e^{At} \\rVert_{2}$ 描述。峰值瞬态放大 $G$ 是该范数在给定时间区间内的最大值。\n估计 $G$ 及其发生时间 $t_{\\mathrm{peak}}$ 的步骤如下：\n- 定义一个均匀时间网格 $t_k = k \\Delta t$，其中 $k = 0, 1, \\dots, \\lfloor T_{\\max} / \\Delta t \\rfloor$，参数为给定的 $T_{\\max} = 20.0$ 和 $\\Delta t = 0.005$。\n- 对于网格中的每个时间点 $t_k$：\n    - 计算矩阵指数 $E_k = e^{A t_k}$。\n    - 计算该矩阵的算子 $2$-范数 $g_k = \\lVert E_k \\rVert_{2}$。\n- 峰值放大 $G$ 是找到的最大值：$G = \\max_{k} \\{g_k\\}$。\n- 峰值时间 $t_{\\mathrm{peak}}$ 是对应于最大增益 $G$ 的时间 $t_k$。\n\n**步骤 4：近似计算复稳定性半径 ($r_c(A)$)**\n复稳定性半径 $r_c(A)$ 是衡量系统对非结构化复扰动鲁棒性的一个度量。对于一个渐近稳定的矩阵 $A$，它可以通过系统预解式 $(i\\omega I - A)^{-1}$ 的频率响应峰值幅度的倒数来近似。表达式为：\n$$\nr_{c}(A) \\approx \\left( \\sup_{\\omega \\in \\mathbb{R}} \\lVert (i \\omega I - A)^{-1} \\rVert_{2} \\right)^{-1}\n$$\n问题规定，如果系统不是渐近稳定的（如步骤 2 中所确定），则定义 $r_c(A)$ 为 $0$。\n估计 $r_c(A)$ 的步骤如下：\n- 如果系统不是渐近稳定的（$s$ 为 `False`），则设置 $r_c(A) = 0.0$。\n- 如果系统是稳定的，则进行数值估计：\n    - 定义一个均匀频率网格 $\\omega_j = -\\Omega_{\\max} + j \\Delta \\omega$，其中 $j = 0, 1, \\dots, \\lfloor (2 \\Omega_{\\max}) / \\Delta \\omega \\rfloor$，参数为 $\\Omega_{\\max} = 5.0$ 和 $\\Delta \\omega = 0.005$。\n    - 对于网格中的每个频率 $\\omega_j$：\n        - 构建预解式矩阵形式 $M_j = (i \\omega_j I - A)$。\n        - 计算其逆矩阵 $M_j^{-1}$。\n        - 计算逆矩阵的算子 $2$-范数 $h_j = \\lVert M_j^{-1} \\rVert_2$。\n    - 找到这些范数在网格上的上确界（最大值）：$H_{\\max} = \\max_{j} \\{ h_j \\}$。\n    - 然后，近似复稳定性半径计算为 $r_c(A) \\approx 1 / H_{\\max}$。\n\n这个完整的步骤将应用于所提供的四个测试用例中的每一个，并且 $G$、$t_{\\mathrm{peak}}$ 和 $r_c(A)$ 的最终浮点数值将按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Analyzes the stability and transient behavior of four linear RNN models.\n\n    For each model defined by a matrix W, the function calculates:\n    1. Asymptotic stability based on the spectral abscissa of A = W - I.\n    2. Peak transient amplification G and the time t_peak at which it occurs.\n    3. The approximate complex stability radius r_c.\n    The results are formatted and printed as a single line.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        np.array([[0.8, 0.0], [0.0, 0.6]]),  # Case 1\n        np.array([[0.9, 5.0], [0.0, 0.9]]),  # Case 2\n        np.array([[1.0, 1.0], [0.0, 1.0]]),  # Case 3\n        np.array([[1.05, 0.0], [0.0, 0.8]])  # Case 4\n    ]\n\n    # Numerical parameters\n    stability_threshold = -1e-9\n    T_max = 20.0\n    dt = 0.005\n    Omega_max = 5.0\n    d_omega = 0.005\n    \n    results = []\n    \n    for W in test_cases:\n        # Step 1: Construct the system matrix A\n        I = np.identity(W.shape[0])\n        A = W - I\n\n        # Step 2: Determine Asymptotic Stability\n        eigenvalues = np.linalg.eigvals(A)\n        spectral_abscissa = np.max(np.real(eigenvalues))\n        is_stable = spectral_abscissa  stability_threshold\n\n        # Step 3: Estimate Peak Transient Amplification (G) and Time (t_peak)\n        time_grid = np.arange(0, T_max + dt, dt)\n        gains = []\n        for t in time_grid:\n            exp_At = expm(A * t)\n            norm = np.linalg.norm(exp_At, ord=2)\n            gains.append(norm)\n        \n        gains_arr = np.array(gains)\n        peak_gain = np.max(gains_arr)\n        peak_time_index = np.argmax(gains_arr)\n        peak_time = time_grid[peak_time_index]\n\n        # Step 4: Approximate the Complex Stability Radius (r_c)\n        r_c = 0.0\n        if is_stable:\n            omega_grid = np.arange(-Omega_max, Omega_max + d_omega, d_omega)\n            resolvent_norms = []\n            for omega in omega_grid:\n                # Use complex numbers for the identity matrix\n                resolvent_matrix = (1j * omega * I - A)\n                try:\n                    # The resolvent matrix is guaranteed to be invertible if A is stable and omega is real\n                    inv_resolvent = np.linalg.inv(resolvent_matrix)\n                    norm = np.linalg.norm(inv_resolvent, ord=2)\n                    resolvent_norms.append(norm)\n                except np.linalg.LinAlgError:\n                    # Should not happen for stable A, but as a safeguard\n                    resolvent_norms.append(np.inf)\n\n            if resolvent_norms:\n                H_max = np.max(resolvent_norms)\n                if H_max  0 and np.isfinite(H_max):\n                    r_c = 1.0 / H_max\n                else: # To handle cases of H_max being 0 or infinity\n                    r_c = 0.0\n        \n        # Store results for the current case\n        results.append([is_stable, peak_gain, peak_time, r_c])\n\n    # Final print statement in the exact required format.\n    output_parts = []\n    for res in results:\n        s_i, G_i, t_peak_i, r_c_i = res\n        # Format floating-point numbers to 6 decimal places\n        part_str = f\"[{s_i}, {G_i:.6f}, {t_peak_i:.6f}, {r_c_i:.6f}]\"\n        output_parts.append(part_str)\n        \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}