{
    "hands_on_practices": [
        {
            "introduction": "脉冲神经网络通过在脉冲的精确时间中编码信息来进行计算。为了理解这些编码，我们需要一种方法来衡量两个脉冲模式的差异程度。Victor-Purpura距离提供了一个强大的度量标准，它弥合了简单计算脉冲数量和匹配其精确时间的鸿沟。这个练习  提供了计算该距离的动手实践，让学生具体理解它如何通过平衡脉冲计数与时间精度来量化时间编码。",
            "id": "4021728",
            "problem": "考虑在一次计算实验中从两个神经元观测到的两个脉冲序列 $S^{(1)}$ 和 $S^{(2)}$。脉冲时间（相对于一个共同的参考点测量）是严格递增的，分别为 $S^{(1)} = \\{5, 15, 30, 55\\}\\ \\mathrm{ms}$ 和 $S^{(2)} = \\{4, 20, 31, 54, 90\\}\\ \\mathrm{ms}$。Victor–Purpura 距离 $D_{q}(S^{(1)}, S^{(2)})$ 定义为仅使用三种编辑操作将 $S^{(1)}$ 转换为 $S^{(2)}$ 的最小总成本：删除一个脉冲（成本为 $1$）、插入一个脉冲（成本为 $1$），或将一个脉冲在时间上移动一个量 $\\Delta t$（成本为 $q\\,|\\Delta t|$）。成本参数 $q$ 的单位是 $\\mathrm{ms}^{-1}$，因此 $q\\,|\\Delta t|$ 是无量纲的，距离 $D_{q}$ 也是无量纲的。\n\n使用这些定义和 $q = 0.2\\ \\mathrm{ms}^{-1}$，计算 Victor–Purpura 距离 $D_{q}(S^{(1)}, S^{(2)})$。请提供精确的最终数值答案（不要四舍五入）。然后，根据您的计算和编辑操作的结构，解释参数 $q$ 如何调节对脉冲时间差异与脉冲数量差异的敏感度。请将您的最终答案表示为一个不带单位的数字。",
            "solution": "该问题要求计算两个脉冲序列 $S^{(1)} = \\{5, 15, 30, 55\\}$ ms 和 $S^{(2)} = \\{4, 20, 31, 54, 90\\}$ ms 之间的 Victor–Purpura 距离 $D_{q}(S^{(1)}, S^{(2)})$，成本参数为 $q = 0.2\\ \\mathrm{ms}^{-1}$。它还要求解释参数 $q$ 的作用。\n\nVictor–Purpura 距离是使用三种基本操作将一个脉冲序列转换为另一个脉冲序列的最小成本：删除脉冲（成本为 $1$）、插入脉冲（成本为 $1$）和将脉冲移动一个量 $\\Delta t$（成本为 $q|\\Delta t|$）。这个最小成本可以使用动态规划算法高效地计算，该算法类似于计算字符串之间 Levenshtein 距离的算法。\n\n设 $S^{(1)}$ 中的脉冲时间表示为 $t_i$（$i=1, \\dots, m$），$S^{(2)}$ 中的脉冲时间表示为 $t'_j$（$j=1, \\dots, n$）。这里，$m=4$ 且 $n=5$。我们定义一个大小为 $(m+1) \\times (n+1)$ 的矩阵 $D$，其中 $D(i,j)$ 是将 $S^{(1)}$ 的前 $i$ 个脉冲转换为 $S^{(2)}$ 的前 $j$ 个脉冲的最小成本。\n\n矩阵的条目计算如下：\n\n1.  **初始化**：\n    将一个空脉冲序列转换为一个有 $j$ 个脉冲的序列的成本是插入所有 $j$ 个脉冲，因此 $D(0,j) = j$。\n    将一个有 $i$ 个脉冲的脉冲序列转换为空序列的成本是删除所有 $i$ 个脉冲，因此 $D(i,0) = i$。\n    将一个空脉冲序列转换为另一个空脉冲序列的成本是 $D(0,0)=0$。\n\n2.  **递推关系**：\n    对于 $i > 0$ 和 $j > 0$，$D(i,j)$ 的值由三种可能操作中的最小成本决定：\n    a. 删除 $S^{(1)}$ 的第 $i$ 个脉冲：成本为 $D(i-1, j) + 1$。\n    b. 插入 $S^{(2)}$ 的第 $j$ 个脉冲：成本为 $D(i, j-1) + 1$。\n    c. 移动 $S^{(1)}$ 的第 $i$ 个脉冲以匹配 $S^{(2)}$ 的第 $j$ 个脉冲：成本为 $D(i-1, j-1) + q|t_i - t'_j|$。\n\n    因此，递推关系为：\n    $$D(i,j) = \\min\\left( D(i-1, j) + 1, \\quad D(i, j-1) + 1, \\quad D(i-1, j-1) + q|t_i - t'_j| \\right)$$\n\n我们将此算法应用于给定的脉冲序列和 $q=0.2$。\n$S^{(1)} = \\{t_1, t_2, t_3, t_4\\} = \\{5, 15, 30, 55\\}$\n$S^{(2)} = \\{t'_1, t'_2, t'_3, t'_4, t'_5\\} = \\{4, 20, 31, 54, 90\\}$\n\n$5 \\times 6$ 矩阵 $D$ 的初始化为：\n$D(i, 0) = i$ for $i \\in \\{0, 1, 2, 3, 4\\}$\n$D(0, j) = j$ for $j \\in \\{0, 1, 2, 3, 4, 5\\}$\n\n我们来计算一个示例条目 $D(1,1)$：\n$D(1,1) = \\min(D(0,1)+1, D(1,0)+1, D(0,0)+q|t_1-t'_1|)$\n$D(1,1) = \\min(1+1, 1+1, 0 + 0.2 |5 - 4|) = \\min(2, 2, 0.2) = 0.2$。\n\n对所有条目进行此计算，得到以下成本矩阵：\n$$\nD = \\begin{pmatrix}\n0   1   2   3   4   5 \\\\\n1   0.2   1.2   2.2   3.2   4.2 \\\\\n2   1.2   1.2   2.2   3.2   4.2 \\\\\n3   2.2   2.2   1.4   2.4   3.4 \\\\\n4   3.2   3.2   2.4   1.6   2.6\n\\end{pmatrix}\n$$\nVictor–Purpura 距离是矩阵右下角的值，$D(m,n) = D(4,5)$。\n因此，$D_{0.2}(S^{(1)}, S^{(2)}) = 2.6$。\n\n问题的第二部分要求解释参数 $q$。参数 $q$ 控制了脉冲时间差异成本和脉冲数量差异成本之间的权衡。\n\n处理每个序列中一个脉冲不匹配的成本可以通过两种基本方式解决：\n1.  将它们视为不相关：从 $S^{(1)}$ 中删除脉冲，并插入来自 $S^{(2)}$ 的脉冲。这对操作的总成本为 $1 + 1 = 2$。\n2.  将它们视为对应的脉冲：将 $S^{(1)}$ 中的脉冲移动到 $S^{(2)}$ 中脉冲的时间。成本为 $q|\\Delta t|$，其中 $\\Delta t$ 是时间差。\n\n算法会选择更便宜的选项。如果 $q|\\Delta t|  2$，即等价于 $|\\Delta t|  2/q$，则移动操作会优先于删除-插入操作。这个不等式揭示了 $q$ 的作用：\n-   量 $1/q$ 设定了一个特征时间尺度。对于给定的问题，$1/q = 1/0.2 = 5$ ms。移动成本与删除和插入成本相等的临界时间差是 $2/q = 10$ ms。\n-   当 $q$ 很小（$q \\to 0$）时，移动成本 $q|\\Delta t|$ 变得可以忽略不计。该度量对脉冲时间不敏感，距离主要由两个序列之间的脉冲数量差异 $|m-n|$ 决定。即使脉冲在时间上相距很远，它们也会被匹配。该度量实际上变成了一个脉冲计数度量。\n-   当 $q$ 很大（$q \\to \\infty$）时，对于任何非零的 $\\Delta t$，移动成本 $q|\\Delta t|$ 都会变得非常高。删除和插入脉冲几乎总是比移动它们更便宜，除非它们几乎是重合的（$|\\Delta t|  2/q \\to 0$）。该度量对脉冲的精确时间变得高度敏感。距离实际上计算的是非重合脉冲的数量。\n\n总而言之，$q$ 是一个时间精度参数。低 $q$ 值使距离度量脉冲发放率的差异，而高 $q$ 值使距离度量脉冲精确时间的差异。",
            "answer": "$$\\boxed{2.6}$$"
        },
        {
            "introduction": "脉冲神经网络的计算能力不仅源于神经元，也源于其连接的动态特性。突触并非一成不变，它们表现出短期可塑性，在快速的时间尺度上改变其强度。Tsodyks-Markram模型是描述突触效能如何因近期活动而改变的经典框架，它展示了如抑制和易化等现象。通过推导突触对周期性输入的稳态响应 ，您将深入了解短期可塑性如何将突触转变为动态滤波器，使其能够以频率依赖的方式处理信息。",
            "id": "4021760",
            "problem": "考虑一个表现出短期可塑性的兴奋性化学突触，其易化和抑制过程由 Tsodyks–Markram 动力学模型描述。设突触前神经元在严格周期性的时间点 $t_{k} = k \\Delta$ 发放脉冲，其中 $\\Delta = 1/f$，$f$ 为恒定的突触前频率。突触状态由两个变量描述：利用率（或释放概率）$u(t)$ 和可用突触资源的比例 $R(t)$。在时间点 $t_{k}$ 发生脉冲时，兴奋性突触后电流 (EPSC) 的幅值由 $A_{k} = A_{0} \\, u(t_{k}^{+}) \\, R(t_{k}^{-})$ 给出，其中 $A_{0} > 0$ 是一个恒定的比例因子，$u(t_{k}^{+})$ 表示在 $t_{k}$ 时刻脉冲引起的跳变之后 $u$ 的瞬时值，$R(t_{k}^{-})$ 表示在 $t_{k}$ 时刻脉冲之前 $R$ 的瞬时值。$u(t)$ 和 $R(t)$ 的演化遵循以下广泛使用且有实验依据的动力学法则：\n- 在脉冲之间，易化呈指数衰减，资源呈指数恢复：\n$$\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}, \\qquad \\frac{d R}{d t} = \\frac{1 - R}{\\tau_{d}},$$\n其中 $\\tau_{f} > 0$ 是易化时间常数，$\\tau_{d} > 0$ 是抑制 (资源恢复) 时间常数。\n- 在每个脉冲 $t_{k}$ 处，利用率瞬时增加，其增加量与未使用的易化成正比；资源瞬时耗尽，其耗尽量为已释放的比例：\n$$u(t_{k}^{+}) = u(t_{k}^{-}) + U \\big( 1 - u(t_{k}^{-}) \\big), \\qquad R(t_{k}^{+}) = R(t_{k}^{-}) \\big( 1 - u(t_{k}^{+}) \\big),$$\n其中 $0  U  1$ 是一个表征易化增量的恒定参数。\n\n假设系统在周期性刺激下达到稳态，这意味着脉冲前值 $u(t_{k}^{-})$ 和 $R(t_{k}^{-})$ 以及脉冲后值 $u(t_{k}^{+})$ 和 $R(t_{k}^{+})$ 变得与 $k$ 无关（即为常数）。\n\n从这些动力学法则出发，推导稳态利用率 $u_{\\infty}(f)$ 和稳态可用资源 $R_{\\infty}(f)$ 作为频率 $f$ 的函数，然后计算稳态 EPSC 幅值 $A_{\\infty}(f) = A_{0} \\, u_{\\infty}(f) \\, R_{\\infty}(f)$ 作为 $f$ 的函数。将你的最终结果表示为由 $f$、$U$、$\\tau_{f}$、$\\tau_{d}$ 和 $A_{0}$ 构成的闭式解析表达式。无需进行数值近似或四舍五入。你的最终答案必须是一个单一的解析表达式或一个包含 $u_{\\infty}(f)$、$R_{\\infty}(f)$ 和 $A_{\\infty}(f)$ 的单行矩阵。",
            "solution": "用户要求推导在周期性突触前刺激下，由 Tsodyks-Markram 模型描述的突触的稳态行为。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n- **系统变量**：\n  - $u(t)$: 利用率 (释放概率)。\n  - $R(t)$: 可用突触资源的比例。\n- **模型参数**：\n  - $\\tau_{f} > 0$: 易化时间常数。\n  - $\\tau_{d} > 0$: 抑制 (资源恢复) 时间常数。\n  - $U$: 易化增量参数, $0  U  1$。\n  - $A_{0} > 0$: EPSC 幅值的恒定比例因子。\n- **突触前输入**：\n  - 在时间点 $t_{k} = k \\Delta$ 的周期性脉冲，其中 $\\Delta = 1/f$，$f$ 是恒定频率。\n- **脉冲间动力学** (对于 $t \\in (t_k, t_{k+1})$):\n  $$ \\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}, \\qquad \\frac{d R}{d t} = \\frac{1 - R}{\\tau_{d}} $$\n- **脉冲处动力学** (在每个 $t_k$ 时):\n  $$ u(t_{k}^{+}) = u(t_{k}^{-}) + U \\big( 1 - u(t_{k}^{-}) \\big) $$\n  $$ R(t_{k}^{+}) = R(t_{k}^{-}) \\big( 1 - u(t_{k}^{+}) \\big) $$\n  其中 $v(t_{k}^{-}) = \\lim_{\\epsilon \\to 0^{+}} v(t_k - \\epsilon)$ 且 $v(t_{k}^{+}) = \\lim_{\\epsilon \\to 0^{+}} v(t_k + \\epsilon)$。\n- **EPSC 幅值**：\n  $$ A_{k} = A_{0} \\, u(t_{k}^{+}) \\, R(t_{k}^{-}) $$\n- **目标**：\n  - 推导稳态利用率 $u_{\\infty}(f)$、稳态可用资源 $R_{\\infty}(f)$ 和稳态 EPSC 幅值 $A_{\\infty}(f)$，作为 $f, U, \\tau_f, \\tau_d, A_0$ 的闭式解析函数。稳态意味着脉冲前和脉冲后的值不依赖于脉冲索引 $k$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n问题是 **有效的**。\n- **科学依据**：Tsodyks-Markram 模型是计算神经科学中一个典型的、有实验依据的模型，用于描述短期突触可塑性。所有方程和参数都是标准的。\n- **适定性**：问题定义清晰，包含了所有必要的方程和约束。已知在该系统周期性刺激下存在唯一的稳态解，并且是稳定的。\n- **目标**：问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 步骤 2：求解推导\n\n我们将分析系统的动力学，以找到在周期性脉冲序列下的不动点。脉冲之间的时间间隔为 $\\Delta = 1/f$。\n\n**2.1. 稳态利用率 $u_{\\infty}(f)$**\n\n首先，我们求解脉冲之间 $u(t)$ 的微分方程。从 $t = t_{k}^{+}$ 到 $t = t_{k+1}^{-}$，方程为 $\\frac{du}{dt} = -u/\\tau_f$。这是一个简单的指数衰减。\n$$ u(t_{k+1}^{-}) = u(t_{k}^{+}) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) = u(t_{k}^{+}) \\exp\\left(-\\frac{1}{f\\tau_f}\\right) $$\n在脉冲处，$u(t)$ 按如下方式跳变：\n$$ u(t_{k}^{+}) = u(t_{k}^{-}) + U(1 - u(t_{k}^{-})) = U + (1-U)u(t_{k}^{-}) $$\n在稳态下，各个脉冲时刻的值是恒定的。设对所有 $k$ 都有 $u_{\\infty}^{-} \\equiv u(t_{k}^{-})$ 和 $u_{\\infty}^{+} \\equiv u(t_{k}^{+})$。方程组变为：\n$$ u_{\\infty}^{-} = u_{\\infty}^{+} \\exp\\left(-\\frac{1}{f\\tau_f}\\right) $$\n$$ u_{\\infty}^{+} = U + (1-U)u_{\\infty}^{-} $$\n将第一个方程代入第二个方程：\n$$ u_{\\infty}^{+} = U + (1-U) u_{\\infty}^{+} \\exp\\left(-\\frac{1}{f\\tau_f}\\right) $$\n现在，我们求解 $u_{\\infty}^{+}$：\n$$ u_{\\infty}^{+} \\left(1 - (1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)\\right) = U $$\n$$ u_{\\infty}^{+} = \\frac{U}{1 - (1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)} $$\n问题使用 $u(t_k^+)$ 定义 EPSC 幅值。因此，将稳态利用率 $u_{\\infty}(f)$ 定义为脉冲后值 $u_{\\infty}^{+}$ 是标准做法。\n$$ u_{\\infty}(f) = u_{\\infty}^{+} = \\frac{U}{1 - (1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)} $$\n\n**2.2. 稳态可用资源 $R_{\\infty}(f)$**\n\n接下来，我们求解脉冲之间 $R(t)$ 的微分方程：$\\frac{dR}{dt} = (1-R)/\\tau_d$。其解为 $R(t) = 1 - (1-R(t_0))\\exp(-(t-t_0)/\\tau_d)$。\n在 $t=t_k^{+}$ 和 $t=t_{k+1}^{-}$ 之间，初始条件为 $R(t_k^{+})$：\n$$ R(t_{k+1}^{-}) = 1 - \\left(1 - R(t_k^{+})\\right) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) = 1 - \\left(1 - R(t_k^{+})\\right) \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n在脉冲处，资源被耗尽：\n$$ R(t_{k}^{+}) = R(t_{k}^{-}) (1 - u(t_{k}^{+})) $$\n在稳态下，设 $R_{\\infty}^{-} \\equiv R(t_{k}^{-})$ 和 $R_{\\infty}^{+} \\equiv R(t_{k}^{+})$，并使用 $u_{\\infty}^{+}$ 作为稳态利用率。\n$$ R_{\\infty}^{-} = 1 - (1 - R_{\\infty}^{+}) \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n$$ R_{\\infty}^{+} = R_{\\infty}^{-} (1 - u_{\\infty}^{+}) $$\n将第二个方程代入第一个方程：\n$$ R_{\\infty}^{-} = 1 - \\left(1 - R_{\\infty}^{-}(1 - u_{\\infty}^{+})\\right) \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n求解 $R_{\\infty}^{-}$：\n$$ R_{\\infty}^{-} = 1 - \\exp\\left(-\\frac{1}{f\\tau_d}\\right) + R_{\\infty}^{-} (1 - u_{\\infty}^{+}) \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n$$ R_{\\infty}^{-} \\left(1 - (1 - u_{\\infty}^{+}) \\exp\\left(-\\frac{1}{f\\tau_d}\\right)\\right) = 1 - \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n$$ R_{\\infty}^{-} = \\frac{1 - \\exp\\left(-\\frac{1}{f\\tau_d}\\right)}{1 - (1 - u_{\\infty}^{+}) \\exp\\left(-\\frac{1}{f\\tau_d}\\right)} $$\nEPSC 幅值是使用 $R(t_k^-)$ 定义的，因此我们定义 $R_{\\infty}(f) = R_{\\infty}^{-}$。为了得到一个仅用基本参数表示的表达式，我们代入 $u_{\\infty}(f) = u_{\\infty}^{+}$ 的表达式。\n首先，求 $1 - u_{\\infty}(f)$：\n$$ 1 - u_{\\infty}(f) = 1 - \\frac{U}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f})} = \\frac{1-(1-U)\\exp(-\\frac{1}{f\\tau_f}) - U}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f})} = \\frac{(1-U)(1 - \\exp(-\\frac{1}{f\\tau_f}))}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f})} $$\n将此式代入 $R_{\\infty}(f)$ 的分母：\n$$ \\text{分母} = 1 - \\frac{(1-U)(1 - \\exp(-\\frac{1}{f\\tau_f}))}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f})} \\exp\\left(-\\frac{1}{f\\tau_d}\\right) $$\n$$ = \\frac{1-(1-U)\\exp(-\\frac{1}{f\\tau_f}) - (1-U)(1 - \\exp(-\\frac{1}{f\\tau_f}))\\exp(-\\frac{1}{f\\tau_d})}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f})} $$\n因此，$R_{\\infty}(f)$ 为：\n$$ R_{\\infty}(f) = \\frac{(1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f}))}{1-(1-U)\\exp(-\\frac{1}{f\\tau_f}) - (1-U)(1 - \\exp(-\\frac{1}{f\\tau_f}))\\exp(-\\frac{1}{f\\tau_d})} $$\n分母可以重写为：\n$$ D(f) = (1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f})) + U\\exp(-\\frac{1}{f\\tau_d}) $$\n所以 $R_{\\infty}(f)$ 的表达式为：\n$$ R_{\\infty}(f) = \\frac{(1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f}))}{(1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f})) + U\\exp(-\\frac{1}{f\\tau_d})} $$\n\n**2.3. 稳态 EPSC 幅值 $A_{\\infty}(f)$**\n\n稳态幅值为 $A_{\\infty}(f) = A_{0} u_{\\infty}(f) R_{\\infty}(f)$。我们代入 $u_{\\infty}(f)$ 和 $R_{\\infty}(f)$ 的表达式。\n$$ A_{\\infty}(f) = A_0 \\left( \\frac{U}{1 - (1-U)\\exp(-\\frac{1}{f\\tau_f})} \\right) \\left( \\frac{(1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f}))}{D(f)} \\right) $$\n项 $(1 - (1-U)\\exp(-\\frac{1}{f\\tau_f}))$ 被约去，从而得到一个更简洁的幅值表达式：\n$$ A_{\\infty}(f) = \\frac{A_0 U (1 - \\exp(-\\frac{1}{f\\tau_d}))}{(1 - \\exp(-\\frac{1}{f\\tau_d}))(1-(1-U)\\exp(-\\frac{1}{f\\tau_f})) + U\\exp(-\\frac{1}{f\\tau_d})} $$\n\n我们现在整理出三个最终表达式。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{U}{1-(1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)}  \\frac{\\left(1-\\exp\\left(-\\frac{1}{f\\tau_d}\\right)\\right)\\left(1-(1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)\\right)}{\\left(1-\\exp\\left(-\\frac{1}{f\\tau_d}\\right)\\right)\\left(1-(1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)\\right) + U \\exp\\left(-\\frac{1}{f\\tau_d}\\right)}  \\frac{A_0 U \\left(1-\\exp\\left(-\\frac{1}{f\\tau_d}\\right)\\right)}{\\left(1-\\exp\\left(-\\frac{1}{f\\tau_d}\\right)\\right)\\left(1-(1-U)\\exp\\left(-\\frac{1}{f\\tau_f}\\right)\\right) + U \\exp\\left(-\\frac{1}{f\\tau_d}\\right)} \\end{pmatrix}} $$"
        },
        {
            "introduction": "为了使网络能够学习，其突触权重必须根据神经活动进行调整。脉冲时间依赖可塑性（STDP）是实现这种学习的关键生物学机制，其中突触前和突触后脉冲的相对时间决定了权重的变化。虽然简单的配对STDP模型提供了基本的理解，但涉及脉冲三联体的更复杂模式对于捕捉真实神经回路中学习的稳定性和计算功能至关重要。本练习  要求您将一个三联体STDP规则应用于特定的脉冲序列，从而揭示高阶脉冲相互作用如何决定突触可塑性的结果，并加深对神经学习规则计算复杂性的理解。",
            "id": "4021715",
            "problem": "考虑一个脉冲神经网络中的单个突触，该突触由三重态脉冲时间依赖可塑性（STDP）规则控制，这在脑建模和计算神经科学的计算建模中很常用。突触可塑性由四个资格迹描述：一个快速突触前迹 $x(t)$，一个慢速突触前迹 $x_{s}(t)$，一个快速突触后迹 $y(t)$，以及一个慢速突触后迹 $y_{s}(t)$。在脉冲之间，这些迹遵循一阶线性衰减动力学。具体来说，对于在时间 $t_{\\text{pre}}$ 发生的突触前脉冲，更新规则为 $x(t_{\\text{pre}}^{+}) = x(t_{\\text{pre}}^{-}) + 1$ 和 $x_{s}(t_{\\text{pre}}^{+}) = x_{s}(t_{\\text{pre}}^{-}) + 1$；对于在时间 $t_{\\text{post}}$ 发生的突触后脉冲，更新规则为 $y(t_{\\text{post}}^{+}) = y(t_{\\text{post}}^{-}) + 1$ 和 $y_{s}(t_{\\text{post}}^{+}) = y_{s}(t_{\\text{post}}^{-}) + 1$。在脉冲之间，这些迹根据以下公式指数衰减：\n$$\n\\frac{d x}{d t} = -\\frac{x}{\\tau_{x}},\\quad \\frac{d x_{s}}{d t} = -\\frac{x_{s}}{\\tau_{x,s}},\\quad \\frac{d y}{d t} = -\\frac{y}{\\tau_{y}},\\quad \\frac{d y_{s}}{d t} = -\\frac{y_{s}}{\\tau_{y,s}}.\n$$\n突触权重 $w$ 在脉冲发生时瞬时更新。在突触后脉冲发生的时间 $t_{\\text{post}}$，其变化为\n$$\n\\Delta w\\big|_{t_{\\text{post}}} = A_{2}^{+}\\,x(t_{\\text{post}}^{-}) + A_{3}^{+}\\,x(t_{\\text{post}}^{-})\\,y_{s}(t_{\\text{post}}^{-}),\n$$\n而在突触前脉冲发生的时间 $t_{\\text{pre}}$，其变化为\n$$\n\\Delta w\\big|_{t_{\\text{pre}}} = -A_{2}^{-}\\,y(t_{\\text{pre}}^{-}) - A_{3}^{-}\\,y(t_{\\text{pre}}^{-})\\,x_{s}(t_{\\text{pre}}^{-}).\n$$\n此处，$A_{2}^{+}$ 和 $A_{3}^{+}$ 是正的增强幅度，而 $A_{2}^{-}$ 和 $A_{3}^{-}$ 是正的抑制幅度。资格迹的初始值为 $x(0^{-})=x_{s}(0^{-})=y(0^{-})=y_{s}(0^{-})=0$。\n\n设参数为\n$$\nA_{2}^{+} = 0.008,\\quad A_{3}^{+} = 0.002,\\quad A_{2}^{-} = 0.009,\\quad A_{3}^{-} = 0.003,\n$$\n时间常数为\n$$\n\\tau_{x} = 20~\\text{ms},\\quad \\tau_{x,s} = 80~\\text{ms},\\quad \\tau_{y} = 30~\\text{ms},\\quad \\tau_{y,s} = 120~\\text{ms}.\n$$\n考虑两个三脉冲序列，它们具有相同的脉冲间隔，但中间脉冲的身份被置换：\n- 序列 $\\mathcal{S}_{A}$：一个在 $t=0~\\text{ms}$ 的突触前脉冲，一个在 $t=10~\\text{ms}$ 的突触后脉冲，以及一个在 $t=40~\\text{ms}$ 的突触前脉冲。\n- 序列 $\\mathcal{S}_{B}$：一个在 $t=0~\\text{ms}$ 的突触前脉冲，一个在 $t=10~\\text{ms}$ 的突触前脉冲，以及一个在 $t=40~\\text{ms}$ 的突触后脉冲。\n\n使用上述三重态 STDP 规则和迹动力学，计算净突触变化 $\\Delta w(\\mathcal{S}_{A})$ 和 $\\Delta w(\\mathcal{S}_{B})$，然后将对间隔置换的敏感度定义为\n$$\nS \\equiv \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B}).\n$$\n将 $S$ 的值以无量纲数的形式给出，四舍五入到五位有效数字，并用科学记数法表示。最终答案不需要单位。",
            "solution": "该问题要求在三重态脉冲时间依赖可塑性（STDP）规则下，计算两个不同的三脉冲序列 $\\mathcal{S}_{A}$ 和 $\\mathcal{S}_{B}$ 的净突触权重变化 $\\Delta w$。然后我们将计算敏感度 $S = \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B})$。\n\n四个资格迹（$x(t)$, $x_{s}(t)$, $y(t)$, $y_{s}(t)$）在脉冲之间的动力学由一阶线性衰减微分方程控制。对于一个时间常数为 $\\tau_{z}$、在时间 $t_0$ 的初始值为 $z(t_0)$ 的通用迹 $z(t)$，其解由下式给出：\n$$ z(t) = z(t_0) \\exp\\left(-\\frac{t-t_0}{\\tau_{z}}\\right) \\quad \\text{for } t > t_0. $$\n资格迹在 $t=0^{-}$ 时初始化为 $0$。在每个脉冲发生时，权重 $w$ 根据脉冲前瞬间（$t^{-}$）的迹值进行更新，然后迹本身也瞬时更新（$t^{+}$）。\n\n给定的参数如下：\n幅度：$A_{2}^{+} = 0.008$, $A_{3}^{+} = 0.002$, $A_{2}^{-} = 0.009$, $A_{3}^{-} = 0.003$。\n时间常数：$\\tau_{x} = 20$ ms, $\\tau_{x,s} = 80$ ms, $\\tau_{y} = 30$ ms, $\\tau_{y,s} = 120$ ms。\n\n首先，我们分析序列 $\\mathcal{S}_{A}$：在 $t=0$ ms 发生突触前脉冲，在 $t=10$ ms 发生突触后脉冲，在 $t=40$ ms 发生突触前脉冲。\n\n1.  **$t=0$ ms 时的突触前脉冲：**\n    - $t=0^{-}$ 时的迹：$x(0^{-})=0$, $x_{s}(0^{-})=0$, $y(0^{-})=0$, $y_{s}(0^{-})=0$。\n    - 权重更新 $\\Delta w_1(\\mathcal{S}_{A})$：突触前脉冲的更新依赖于 $y(0^{-})$ 和 $x_s(0^{-})$。\n      $$ \\Delta w_1(\\mathcal{S}_{A}) = -A_{2}^{-}\\,y(0^{-}) - A_{3}^{-}\\,y(0^{-})\\,x_{s}(0^{-}) = -A_{2}^{-}(0) - A_{3}^{-}(0)(0) = 0. $$\n    - $t=0^{+}$ 时的迹更新：$x(0^{+}) = x(0^{-})+1=1$, $x_{s}(0^{+}) = x_{s}(0^{-})+1=1$。$y$ 迹保持为 $0$。\n\n2.  **从 $t=0$ ms 到 $t=10$ ms 的衰减：** 我们计算 $t=10^{-}$ 时的迹值。\n    - $x(10^{-}) = x(0^{+}) \\exp(-\\frac{10}{\\tau_{x}}) = 1 \\cdot \\exp(-\\frac{10}{20}) = \\exp(-0.5)$。\n    - $x_{s}(10^{-}) = x_{s}(0^{+}) \\exp(-\\frac{10}{\\tau_{x,s}}) = 1 \\cdot \\exp(-\\frac{10}{80}) = \\exp(-0.125)$。\n    - $y(10^{-}) = y(0^{+}) \\exp(-\\frac{10}{\\tau_{y}}) = 0$。\n    - $y_{s}(10^{-}) = y_{s}(0^{+}) \\exp(-\\frac{10}{\\tau_{y,s}}) = 0$。\n\n3.  **$t=10$ ms 时的突触后脉冲：**\n    - 权重更新 $\\Delta w_2(\\mathcal{S}_{A})$：突触后脉冲的更新依赖于 $x(10^{-})$ 和 $y_{s}(10^{-})$。\n      $$ \\Delta w_2(\\mathcal{S}_{A}) = A_{2}^{+}\\,x(10^{-}) + A_{3}^{+}\\,x(10^{-})\\,y_{s}(10^{-}) = A_{2}^{+}\\,\\exp(-0.5) + A_{3}^{+}\\,\\exp(-0.5)(0) = A_{2}^{+}\\,\\exp(-0.5). $$\n    - $t=10^{+}$ 时的迹更新：$y(10^{+})=y(10^{-})+1=1$, $y_{s}(10^{+})=y_{s}(10^{-})+1=1$。$x$ 迹不变：$x(10^{+}) = \\exp(-0.5)$ 和 $x_{s}(10^{+}) = \\exp(-0.125)$。\n\n4.  **从 $t=10$ ms 到 $t=40$ ms 的衰减：** 时间间隔为 $\\Delta t = 30$ ms。我们计算 $t=40^{-}$ 时的迹值。\n    - $x(40^{-}) = x(10^{+}) \\exp(-\\frac{30}{\\tau_{x}}) = \\exp(-0.5) \\exp(-\\frac{30}{20}) = \\exp(-0.5 - 1.5) = \\exp(-2.0)$。\n    - $x_{s}(40^{-}) = x_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{x,s}}) = \\exp(-0.125) \\exp(-\\frac{30}{80}) = \\exp(-0.125 - 0.375) = \\exp(-0.5)$。\n    - $y(40^{-}) = y(10^{+}) \\exp(-\\frac{30}{\\tau_{y}}) = 1 \\cdot \\exp(-\\frac{30}{30}) = \\exp(-1.0)$。\n    - $y_{s}(40^{-}) = y_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{y,s}}) = 1 \\cdot \\exp(-\\frac{30}{120}) = \\exp(-0.25)$。\n\n5.  **$t=40$ ms 时的突触前脉冲：**\n    - 权重更新 $\\Delta w_3(\\mathcal{S}_{A})$：\n      $$ \\Delta w_3(\\mathcal{S}_{A}) = -A_{2}^{-}\\,y(40^{-}) - A_{3}^{-}\\,y(40^{-})\\,x_{s}(40^{-}) = -A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.0)\\,\\exp(-0.5) = -A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5). $$\n\n$\\mathcal{S}_{A}$ 的总权重变化是各项变化之和：\n$$ \\Delta w(\\mathcal{S}_{A}) = \\Delta w_1 + \\Delta w_2 + \\Delta w_3 = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5). $$\n\n接下来，我们分析序列 $\\mathcal{S}_{B}$：在 $t=0$ ms 发生突触前脉冲，在 $t=10$ ms 发生突触前脉冲，在 $t=40$ ms 发生突触后脉冲。\n\n1.  **$t=0$ ms 时的突触前脉冲：** 这与 $\\mathcal{S}_{A}$ 中的情况相同。$\\Delta w_1(\\mathcal{S}_{B}) = 0$。$t=0^{+}$ 时的迹为 $x(0^{+})=1$, $x_{s}(0^{+})=1$, $y(0^{+})=0$, $y_{s}(0^{+})=0$。\n\n2.  **从 $t=0$ ms 到 $t=10$ ms 的衰减：** 与 $\\mathcal{S}_{A}$ 中的情况相同。在 $t=10^{-}$ 时，$x(10^{-})=\\exp(-0.5)$, $x_{s}(10^{-})=\\exp(-0.125)$，且 $y, y_s$ 均为 $0$。\n\n3.  **$t=10$ ms 时的突触前脉冲：**\n    - 权重更新 $\\Delta w_2(\\mathcal{S}_{B})$：\n      $$ \\Delta w_2(\\mathcal{S}_{B}) = -A_{2}^{-}\\,y(10^{-}) - A_{3}^{-}\\,y(10^{-})\\,x_{s}(10^{-}) = -A_{2}^{-}(0) - A_{3}^{-}(0)\\exp(-0.125) = 0. $$\n    - $t=10^{+}$ 时的迹更新：$x(10^{+})=x(10^{-})+1 = \\exp(-0.5)+1$, $x_{s}(10^{+})=x_{s}(10^{-})+1 = \\exp(-0.125)+1$。$y$ 迹保持为 $0$。\n\n4.  **从 $t=10$ ms 到 $t=40$ ms 的衰减：** $\\Delta t=30$ ms。$t=40^{-}$ 时的迹。\n    - $x(40^{-}) = x(10^{+}) \\exp(-\\frac{30}{\\tau_{x}}) = (\\exp(-0.5)+1) \\exp(-1.5) = \\exp(-2.0) + \\exp(-1.5)$。\n    - $x_{s}(40^{-}) = x_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{x,s}}) = (\\exp(-0.125)+1) \\exp(-0.375) = \\exp(-0.5) + \\exp(-0.375)$。\n    - $y(40^{-})=0$, $y_{s}(40^{-})=0$。\n\n5.  **$t=40$ ms 时的突触后脉冲：**\n    - 权重更新 $\\Delta w_3(\\mathcal{S}_{B})$：\n      $$ \\Delta w_3(\\mathcal{S}_{B}) = A_{2}^{+}\\,x(40^{-}) + A_{3}^{+}\\,x(40^{-})\\,y_{s}(40^{-}) = A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)) + 0. $$\n\n$\\mathcal{S}_{B}$ 的总权重变化为：\n$$ \\Delta w(\\mathcal{S}_{B}) = \\Delta w_1 + \\Delta w_2 + \\Delta w_3 = A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)). $$\n\n最后，我们计算敏感度 $S = \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B})$。\n$$ S = \\left( A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5) \\right) - \\left( A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)) \\right). $$\n$$ S = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5) - A_{2}^{+}\\,\\exp(-2.0) - A_{2}^{+}\\,\\exp(-1.5). $$\n合并同类项：\n$$ S = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - (A_{2}^{+} + A_{3}^{-})\\,\\exp(-1.5) - A_{2}^{+}\\,\\exp(-2.0). $$\n现在我们代入参数的数值：\n$$ S = 0.008\\,\\exp(-0.5) - 0.009\\,\\exp(-1.0) - (0.008 + 0.003)\\,\\exp(-1.5) - 0.008\\,\\exp(-2.0). $$\n$$ S = 0.008\\,\\exp(-0.5) - 0.009\\,\\exp(-1.0) - 0.011\\,\\exp(-1.5) - 0.008\\,\\exp(-2.0). $$\n使用指数函数的数值：\n$\\exp(-0.5) \\approx 0.606531$\n$\\exp(-1.0) \\approx 0.367879$\n$\\exp(-1.5) \\approx 0.223130$\n$\\exp(-2.0) \\approx 0.135335$\n$$ S \\approx 0.008(0.606531) - 0.009(0.367879) - 0.011(0.223130) - 0.008(0.135335). $$\n$$ S \\approx 0.00485225 - 0.00331091 - 0.00245443 - 0.00108268. $$\n$$ S \\approx -0.00199577. $$\n四舍五入到五位有效数字，并用科学记数法表示：\n$$ S \\approx -1.9958 \\times 10^{-3}. $$",
            "answer": "$$\\boxed{-1.9958 \\times 10^{-3}}$$"
        }
    ]
}