{
    "hands_on_practices": [
        {
            "introduction": "理解Hopfield网络的第一步是掌握其基本运作机制。这个练习将带你亲手实践，应用Hebbian学习规则来构建网络的突触权重矩阵，并使用更新规则观察单个神经元状态的演变。通过这个具体的计算，你将为后续更深入的分析打下坚实的基础。",
            "id": "3962571",
            "problem": "考虑一个由 Hopfield 网络建模的二元联想记忆，其中每个神经元的状态为 $s_i \\in \\{-1,+1\\}$，并根据其局部场的符号进行异步更新。设有 $N=4$ 个神经元，两个存储的记忆模式 $\\xi^{1}=(1,1,-1,-1)$ 和 $\\xi^{2}=(1,-1,1,-1)$，并且所有 $i$ 的阈值均为 $\\theta_i=0$。突触权重采用标准的 Hebb 学习规则，且无自耦合，即当 $i\\neq j$ 时，$w_{ij}=\\frac{1}{N}\\sum_{\\mu=1}^{2}\\xi_i^{\\mu}\\xi_j^{\\mu}$，且 $w_{ii}=0$。异步确定性更新规则为：计算局部场 $h_i(s)=\\sum_{j=1}^{N}w_{ij}s_j-\\theta_i$，然后设置 $s_i \\leftarrow \\operatorname{sign}(h_i(s))$，并约定如果 $h_i(s)=0$，则 $s_i$ 保持不变。\n\n从网络状态 $s=(1,-1,-1,-1)$ 开始，执行以下任务：\n- 计算完整的 $4\\times 4$ 权重矩阵 $W=(w_{ij})$。\n- 使用上述规则对神经元 3 进行一次异步更新。\n\n将神经元 3 的更新值（表示为 $-1$ 或 $+1$）作为您的最终数值答案。无需四舍五入，也无物理单位。",
            "solution": "问题提供了一个标准 Hopfield 网络的完整且有效的描述。所有参数和规则都定义明确。我们可以开始求解。\n\n问题要求完成两个任务：首先，计算权重矩阵 $W$；其次，从给定的初始状态开始，对神经元 3 进行一次异步更新。\n\n网络有 $N=4$ 个神经元，其状态为 $s_i \\in \\{-1, +1\\}$。\n两个存储的记忆模式是：\n$$\n\\xi^{1} = (1, 1, -1, -1)\n$$\n$$\n\\xi^{2} = (1, -1, 1, -1)\n$$\n突触权重由无自耦合（$w_{ii}=0$）的 Hebb 学习规则确定：\n$$\nw_{ij} = \\frac{1}{N} \\sum_{\\mu=1}^{2} \\xi_i^{\\mu} \\xi_j^{\\mu} \\quad \\text{for } i \\neq j\n$$\n\n**第 1 部分：计算权重矩阵 $W$**\n\n当 $N=4$ 时，对于 $i \\neq j$，权重的公式为 $w_{ij} = \\frac{1}{4} (\\xi_i^1 \\xi_j^1 + \\xi_i^2 \\xi_j^2)$。对角线元素 $w_{ii}$ 均为 $0$。我们计算非对角线元素：\n\n$w_{12} = \\frac{1}{4} [(\\xi_1^1 \\xi_2^1) + (\\xi_1^2 \\xi_2^2)] = \\frac{1}{4} [(1)(1) + (1)(-1)] = \\frac{1}{4} [1-1] = 0$。\n$w_{13} = \\frac{1}{4} [(\\xi_1^1 \\xi_3^1) + (\\xi_1^2 \\xi_3^2)] = \\frac{1}{4} [(1)(-1) + (1)(1)] = \\frac{1}{4} [-1+1] = 0$。\n$w_{14} = \\frac{1}{4} [(\\xi_1^1 \\xi_4^1) + (\\xi_1^2 \\xi_4^2)] = \\frac{1}{4} [(1)(-1) + (1)(-1)] = \\frac{1}{4} [-1-1] = -\\frac{2}{4} = -\\frac{1}{2}$。\n$w_{23} = \\frac{1}{4} [(\\xi_2^1 \\xi_3^1) + (\\xi_2^2 \\xi_3^2)] = \\frac{1}{4} [(1)(-1) + (-1)(1)] = \\frac{1}{4} [-1-1] = -\\frac{2}{4} = -\\frac{1}{2}$。\n$w_{24} = \\frac{1}{4} [(\\xi_2^1 \\xi_4^1) + (\\xi_2^2 \\xi_4^2)] = \\frac{1}{4} [(1)(-1) + (-1)(-1)] = \\frac{1}{4} [-1+1] = 0$。\n$w_{34} = \\frac{1}{4} [(\\xi_3^1 \\xi_4^1) + (\\xi_3^2 \\xi_4^2)] = \\frac{1}{4} [(-1)(-1) + (1)(-1)] = \\frac{1}{4} [1-1] = 0$。\n\n由于权重矩阵必须是对称的（$w_{ij} = w_{ji}$），我们便得到了所有分量。完整的 $4 \\times 4$ 权重矩阵 $W$ 为：\n$$\nW =\n\\begin{pmatrix}\nw_{11}  w_{12}  w_{13}  w_{14} \\\\\nw_{21}  w_{22}  w_{23}  w_{24} \\\\\nw_{31}  w_{32}  w_{33}  w_{34} \\\\\nw_{41}  w_{42}  w_{43}  w_{44}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  0  0  -\\frac{1}{2} \\\\\n0  0  -\\frac{1}{2}  0 \\\\\n0  -\\frac{1}{2}  0  0 \\\\\n-\\frac{1}{2}  0  0  0\n\\end{pmatrix}\n$$\n\n**第 2 部分：神经元 3 的异步更新**\n\n网络的初始状态给定为 $s = (s_1, s_2, s_3, s_4) = (1, -1, -1, -1)$。\n我们需要更新神经元 $i=3$。更新规则为 $s_3 \\leftarrow \\operatorname{sign}(h_3(s))$，其中 $h_3(s)$ 是神经元 3 的局部场。\n阈值给定为所有 $i$ 均为 $\\theta_i = 0$。局部场计算如下：\n$$\nh_i(s) = \\sum_{j=1}^{N} w_{ij}s_j - \\theta_i\n$$\n对于神经元 3，这变为：\n$$\nh_3(s) = \\sum_{j=1}^{4} w_{3j}s_j - \\theta_3 = w_{31}s_1 + w_{32}s_2 + w_{33}s_3 + w_{34}s_4 - 0\n$$\n代入矩阵 $W$ 第三行的权重值和初始状态向量 $s$ 的分量：\n$w_{31} = 0$, $w_{32} = -\\frac{1}{2}$, $w_{33} = 0$, $w_{34} = 0$。\n$s_1 = 1$, $s_2 = -1$, $s_3 = -1$, $s_4 = -1$。\n\n局部场为：\n$$\nh_3(s) = (0)(1) + \\left(-\\frac{1}{2}\\right)(-1) + (0)(-1) + (0)(-1) = 0 + \\frac{1}{2} + 0 + 0 = \\frac{1}{2}\n$$\n神经元 3 的更新后状态，我们称之为 $s_3'$，由局部场的符号给出：\n$$\ns_3' = \\operatorname{sign}(h_3(s)) = \\operatorname{sign}\\left(\\frac{1}{2}\\right)\n$$\n由于 $\\frac{1}{2}$ 是一个正数，其符号为 $+1$。\n$$\ns_3' = 1\n$$\n问题规定，如果 $h_i(s)=0$，则神经元状态保持不变。此处情况并非如此，因为 $h_3(s) = \\frac{1}{2} \\neq 0$。\n因此，神经元 3 的更新值为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在了解了单个神经元如何更新之后 ，下一个关键问题是，整个网络为什么会收敛到一个稳定的记忆状态。这个练习引入了Hopfield能量函数的概念，它为网络动态提供了一个全局视角。通过亲手计算，你将验证异步更新规则如何引导网络走向能量更低的状态，这巩固了将网络动态类比为在能量地貌上“下山”以寻找稳定“山谷”（即记忆）的核心思想。",
            "id": "3962539",
            "problem": "考虑一个全连接 Hopfield 网络，它有三个二元神经元，其状态为 $s_{i} \\in \\{-1,+1\\}$，且具有对称的突触权重 $w_{ij} = w_{ji}$ 和零自耦合 $w_{ii}=0$。网络能量由标准 Hopfield 能量函数定义\n$$\nE(\\mathbf{s}) \\;=\\; -\\frac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3} w_{ij}\\, s_i s_j \\;+\\; \\sum_{i=1}^{3} \\theta_i\\, s_i,\n$$\n其中 $\\theta_i$ 是固定阈值。异步更新规则是确定性符号规则\n$$\ns_i \\leftarrow \\operatorname{sgn}\\!\\Big(\\sum_{j=1}^{3} w_{ij}\\, s_j \\;-\\; \\theta_i\\Big),\n$$\n其中，如果 $x>0$，则 $\\operatorname{sgn}(x)=+1$；如果 $x<0$，则 $\\operatorname{sgn}(x)=-1$。\n\n设对所有 $i$ 都有 $\\theta_i=0$，且非零权重为 $w_{12}=w_{21}=1$，$w_{13}=w_{31}=-1$，$w_{23}=w_{32}=1$。从状态 $\\mathbf{s}=(s_1,s_2,s_3)=(1,-1,1)$ 开始。根据确定性符号规则，仅对神经元 1 执行一次异步更新，在此更新期间保持神经元 2 和 3 固定不变。\n\n仅使用上述定义，明确证明此异步更新降低了网络能量，并计算得到的新状态 $\\mathbf{s}'$ 及其能量 $E(\\mathbf{s}')$。将最终答案以四元行矩阵 $\\begin{pmatrix} s_1'  s_2'  s_3'  E(\\mathbf{s}') \\end{pmatrix}$ 的形式给出。无需四舍五入。",
            "solution": "该问题要求我们分析一个 3-神经元 Hopfield 网络中的单次异步更新。验证过程确认了该问题是良定的，有科学依据，并提供了所有必要的信息。我们可以开始求解。\n\n该网络由三个状态为 $s_i \\in \\{-1, +1\\}$ 的神经元组成。能量函数由下式给出：\n$$\nE(\\mathbf{s}) = -\\frac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3} w_{ij}\\, s_i s_j \\;+\\; \\sum_{i=1}^{3} \\theta_i\\, s_i\n$$\n问题指定阈值为零，即对所有 $i$ 都有 $\\theta_i = 0$。能量函数简化为：\n$$\nE(\\mathbf{s}) = -\\frac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3} w_{ij}\\, s_i s_j\n$$\n在对称权重（$w_{ij} = w_{ji}$）和零自耦合（$w_{ii}=0$）的条件下，我们可以将 3-神经元情况的双重求和展开为：\n$$\nE(\\mathbf{s}) = -\\frac{1}{2} (w_{12}s_1s_2 + w_{13}s_1s_3 + w_{21}s_2s_1 + w_{23}s_2s_3 + w_{31}s_3s_1 + w_{32}s_3s_2)\n$$\n$$\nE(\\mathbf{s}) = -\\frac{1}{2} (2 w_{12}s_1s_2 + 2 w_{13}s_1s_3 + 2 w_{23}s_2s_3)\n$$\n$$\nE(\\mathbf{s}) = -(w_{12}s_1s_2 + w_{13}s_1s_3 + w_{23}s_2s_3)\n$$\n给定的非零权重为 $w_{12}=1$，$w_{13}=-1$ 和 $w_{23}=1$。网络的初始状态为 $\\mathbf{s} = (s_1, s_2, s_3) = (1, -1, 1)$。\n\n首先，我们计算初始状态的能量 $E(\\mathbf{s})$：\n$$\nE(\\mathbf{s}) = -((1)(1)(-1) + (-1)(1)(1) + (1)(-1)(1))\n$$\n$$\nE(\\mathbf{s}) = -(-1 - 1 - 1) = -(-3) = 3\n$$\n所以，初始能量为 $E(\\mathbf{s}) = 3$。\n\n接下来，我们对神经元 1 执行一次异步更新。更新规则由下式给出：\n$$\ns_i \\leftarrow \\operatorname{sgn}\\!\\Big(\\sum_{j=1}^{3} w_{ij}\\, s_j \\;-\\; \\theta_i\\Big)\n$$\n对于神经元 1 且 $\\theta_1=0$，该规则变为：\n$$\ns_1' = \\operatorname{sgn}\\!\\Big(\\sum_{j=1}^{3} w_{1j}\\, s_j\\Big) = \\operatorname{sgn}(w_{11}s_1 + w_{12}s_2 + w_{13}s_3)\n$$\n由于 $w_{11}=0$，我们计算作用于神经元 1 的局部场 $h_1$：\n$$\nh_1 = w_{12}s_2 + w_{13}s_3\n$$\n使用当前状态值 $s_2 = -1$ 和 $s_3 = 1$，以及权重 $w_{12}=1$，$w_{13}=-1$：\n$$\nh_1 = (1)(-1) + (-1)(1) = -1 - 1 = -2\n$$\n那么神经元 1 的新状态 $s_1'$ 为：\n$$\ns_1' = \\operatorname{sgn}(-2) = -1\n$$\n在此异步更新步骤中，其他神经元保持不变，因此 $s_2' = s_2 = -1$ 且 $s_3' = s_3 = 1$。网络的新状态为 $\\mathbf{s}' = (s_1', s_2', s_3') = (-1, -1, 1)$。\n\n现在，我们计算这个新状态的能量 $E(\\mathbf{s}')$：\n$$\nE(\\mathbf{s}') = -(w_{12}s_1's_2' + w_{13}s_1's_3' + w_{23}s_2's_3')\n$$\n代入新状态 $\\mathbf{s}' = (-1, -1, 1)$ 的值：\n$$\nE(\\mathbf{s}') = -((1)(-1)(-1) + (-1)(-1)(1) + (1)(-1)(1))\n$$\n$$\nE(\\mathbf{s}') = - (1 + 1 - 1) = -1\n$$\n新状态的能量为 $E(\\mathbf{s}') = -1$。\n\n为了明确证明更新降低了网络能量，我们比较初始能量和最终能量：\n初始能量：$E(\\mathbf{s}) = 3$。\n最终能量：$E(\\mathbf{s}') = -1$。\n由于 $-1 < 3$，我们有 $E(\\mathbf{s}') < E(\\mathbf{s})$，这证实了确定性异步更新降低了网络能量，正如对 Hopfield 网络的预期。能量的变化为 $\\Delta E = E(\\mathbf{s}') - E(\\mathbf{s}) = -1 - 3 = -4$。\n\n问题要求提供四元行矩阵 $\\begin{pmatrix} s_1'  s_2'  s_3'  E(\\mathbf{s}') \\end{pmatrix}$。\n各个分量为：\n$s_1' = -1$\n$s_2' = -1$\n$s_3' = 1$\n$E(\\mathbf{s}') = -1$\n将这些组合成最终的矩阵形式即可得出答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  -1  1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "网络收敛到稳定状态的保证并非普遍适用，它关键地取决于更新模式。这个最终的练习将探讨当我们从异步更新切换到同步更新（即所有神经元同时更新）时会发生什么。通过计算这种情景下的能量变化，你将亲自验证能量函数是否仍然扮演着李雅普诺夫函数（Lyapunov function）的角色 ，从而更深刻地理解动力学规则对网络稳定性的微妙而深远的影响。",
            "id": "3962562",
            "problem": "考虑一个具有 $N=5$ 个二元神经元的全连接 Hopfield 联想记忆网络，其状态为 $s \\in \\{-1,+1\\}^{5}$，权重为对称零对角线矩阵，并采用同步更新。能量函数由标准 Hopfield 形式 $E(s) = -\\frac{1}{2}s^{\\top}Ws$ 定义，其中 $W$ 是 $5 \\times 5$ 的权重矩阵。设权重矩阵为\n$$\nW=\\begin{bmatrix}\n0  -3  -3  1  1 \\\\\n-3  0  -3  1  1 \\\\\n-3  -3  0  1  1 \\\\\n1  1  1  0  3 \\\\\n1  1  1  3  0\n\\end{bmatrix},\n$$\n且初始状态为\n$$\ns(0)=\\begin{pmatrix}1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\n使用确定性规则 $s(1)=\\operatorname{sgn}(Ws(0))$ 执行一次同步更新，其中如果 $x>0$ 则 $\\operatorname{sgn}(x)=+1$，如果 $x<0$ 则 $\\operatorname{sgn}(x)=-1$（对于给定数据，不会出现相等的情况）。从基本定义出发，计算能量变化\n$$\n\\Delta E \\equiv E\\big(s(1)\\big)-E\\big(s(0)\\big).\n$$\n将最终答案表示为单个实数。无需四舍五入。",
            "solution": "该问题陈述经评估具有科学依据、适定、客观且自洽。所有必要信息，包括神经元数量 $N$、神经元状态空间、权重矩阵 $W$、初始状态 $s(0)$、能量函数 $E(s)$ 和同步更新规则，均已提供。这些前提与标准 Hopfield 网络模型一致。因此，该问题被认为是有效的，有必要给出完整解答。\n\n主要任务是计算网络状态经过一次同步更新后的能量变化 $\\Delta E = E(s(1)) - E(s(0))$。\n\nHopfield 网络的能量由下式给出：\n$$\nE(s) = -\\frac{1}{2}s^{\\top}Ws = -\\frac{1}{2}\\sum_{i=1}^{N}\\sum_{j=1}^{N}W_{ij}s_i s_j\n$$\n同步更新规则定义为：\n$$\ns(t+1) = \\operatorname{sgn}\\big(Ws(t)\\big)\n$$\n其中 $\\operatorname{sgn}$ 函数按分量作用。\n\n给定参数如下：\n神经元数量 $N=5$。\n权重矩阵 $W$：\n$$\nW=\\begin{bmatrix}\n0  -3  -3  1  1 \\\\\n-3  0  -3  1  1 \\\\\n-3  -3  0  1  1 \\\\\n1  1  1  0  3 \\\\\n1  1  1  3  0\n\\end{bmatrix}\n$$\n初始状态向量 $s(0)$：\n$$\ns(0)=\\begin{pmatrix}1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1\\end{pmatrix}\n$$\n\n解题过程分为三个步骤：\n1. 计算更新后的状态 $s(1)$。\n2. 计算初始能量 $E(s(0))$ 和最终能量 $E(s(1))$。\n3. 计算能量差 $\\Delta E$。\n\n步骤 1：计算更新后的状态 $s(1)$。\n首先，我们通过将权重矩阵 $W$ 与初始状态向量 $s(0)$ 相乘来计算激活向量，记为 $h(0)$。\n$$\nh(0) = Ws(0) = \\begin{bmatrix}\n0  -3  -3  1  1 \\\\\n-3  0  -3  1  1 \\\\\n-3  -3  0  1  1 \\\\\n1  1  1  0  3 \\\\\n1  1  1  3  0\n\\end{bmatrix}\n\\begin{pmatrix}1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1\\end{pmatrix} =\n\\begin{pmatrix}\n0(1) - 3(1) - 3(1) + 1(1) + 1(1) \\\\\n-3(1) + 0(1) - 3(1) + 1(1) + 1(1) \\\\\n-3(1) - 3(1) + 0(1) + 1(1) + 1(1) \\\\\n1(1) + 1(1) + 1(1) + 0(1) + 3(1) \\\\\n1(1) + 1(1) + 1(1) + 3(1) + 0(1)\n\\end{pmatrix} =\n\\begin{pmatrix}\n-4 \\\\ -4 \\\\ -4 \\\\ 6 \\\\ 6\n\\end{pmatrix}\n$$\n接下来，我们将符号函数应用于 $h(0)$ 的每个分量，以获得新状态 $s(1)$。问题陈述指明，如果 $x>0$ 则 $\\operatorname{sgn}(x)=+1$，如果 $x<0$ 则 $\\operatorname{sgn}(x)=-1$，并指出在此步骤中不会出现相等的情况（即 $x=0$），这一点由 $h(0)$ 的非零分量所证实。\n$$\ns(1) = \\operatorname{sgn}(h(0)) = \\operatorname{sgn}\\begin{pmatrix}-4 \\\\ -4 \\\\ -4 \\\\ 6 \\\\ 6\\end{pmatrix} = \\begin{pmatrix}-1 \\\\ -1 \\\\ -1 \\\\ 1 \\\\ 1\\end{pmatrix}\n$$\n\n步骤 2：计算初始能量和最终能量。\n初始能量 $E(s(0))$ 使用公式 $E(s) = -\\frac{1}{2}s^{\\top}Ws$ 计算。我们可以重用中间结果 $h(0) = Ws(0)$。\n$$\nE(s(0)) = -\\frac{1}{2} s(0)^{\\top} W s(0) = -\\frac{1}{2} s(0)^{\\top} h(0)\n$$\n$$\nE(s(0)) = -\\frac{1}{2} \\begin{pmatrix}1  1  1  1  1\\end{pmatrix} \\begin{pmatrix}-4 \\\\ -4 \\\\ -4 \\\\ 6 \\\\ 6\\end{pmatrix} = -\\frac{1}{2} \\big(1(-4) + 1(-4) + 1(-4) + 1(6) + 1(6)\\big) = -\\frac{1}{2} (-4-4-4+6+6) = -\\frac{1}{2}(0) = 0\n$$\n初始状态的能量为 $E(s(0)) = 0$。\n\n现在，我们计算最终能量 $E(s(1))$。首先，我们为新状态 $s(1)$ 计算激活向量 $h(1) = Ws(1)$。\n$$\nh(1) = Ws(1) = \\begin{bmatrix}\n0  -3  -3  1  1 \\\\\n-3  0  -3  1  1 \\\\\n-3  -3  0  1  1 \\\\\n1  1  1  0  3 \\\\\n1  1  1  3  0\n\\end{bmatrix}\n\\begin{pmatrix}-1 \\\\ -1 \\\\ -1 \\\\ 1 \\\\ 1\\end{pmatrix} =\n\\begin{pmatrix}\n0(-1) - 3(-1) - 3(-1) + 1(1) + 1(1) \\\\\n-3(-1) + 0(-1) - 3(-1) + 1(1) + 1(1) \\\\\n-3(-1) - 3(-1) + 0(-1) + 1(1) + 1(1) \\\\\n1(-1) + 1(-1) + 1(-1) + 0(1) + 3(1) \\\\\n1(-1) + 1(-1) + 1(-1) + 3(1) + 0(1)\n\\end{pmatrix} =\n\\begin{pmatrix}\n3+3+1+1 \\\\ 3+3+1+1 \\\\ 3+3+1+1 \\\\ -1-1-1+3 \\\\ -1-1-1+3\n\\end{pmatrix} =\n\\begin{pmatrix}8 \\\\ 8 \\\\ 8 \\\\ 0 \\\\ 0\\end{pmatrix}\n$$\n现在我们可以计算能量 $E(s(1))$：\n$$\nE(s(1)) = -\\frac{1}{2} s(1)^{\\top} W s(1) = -\\frac{1}{2} s(1)^{\\top} h(1)\n$$\n$$\nE(s(1)) = -\\frac{1}{2} \\begin{pmatrix}-1  -1  -1  1  1\\end{pmatrix} \\begin{pmatrix}8 \\\\ 8 \\\\ 8 \\\\ 0 \\\\ 0\\end{pmatrix} = -\\frac{1}{2} \\big((-1)(8) + (-1)(8) + (-1)(8) + 1(0) + 1(0)\\big) = -\\frac{1}{2} (-8-8-8) = -\\frac{1}{2}(-24) = 12\n$$\n最终状态的能量为 $E(s(1)) = 12$。\n\n步骤 3：计算能量差 $\\Delta E$。\n能量变化是最终能量减去初始能量。\n$$\n\\Delta E = E(s(1)) - E(s(0)) = 12 - 0 = 12\n$$\n网络的能量增加了 $12$。这是 Hopfield 网络中同步更新的一个已知特性，与异步更新不同，它不保证能量函数单调递减。",
            "answer": "$$\n\\boxed{12}\n$$"
        }
    ]
}