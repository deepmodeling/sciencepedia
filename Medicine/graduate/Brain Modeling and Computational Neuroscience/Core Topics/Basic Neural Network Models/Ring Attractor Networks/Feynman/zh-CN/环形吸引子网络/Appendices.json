{
    "hands_on_practices": [
        {
            "introduction": "要理解环形吸引子网络，一个基本问题是网络参数如何决定其活动“鼓包”（bump）的形状。这个练习通过一个简化的模型，其中神经元具有阈值非线性响应，来精确推导活动鼓包的宽度。通过这个实践，你将获得一个清晰的解析解，直观地揭示了突触连接强度和抑制性偏置如何共同塑造神经表征的空间尺度，为理解更复杂的模型奠定了坚实的基础。",
            "id": "4016930",
            "problem": "考虑一个一维圆环上的环形吸引子的连续神经场表示，该圆环周长为 $2\\pi$，由角坐标 $\\theta \\in (-\\pi,\\pi]$ 参数化。设稳态突触输入场 $u(\\theta)$ 由平移不变的循环相互作用和均匀的抑制性偏置确定，如下式所示：\n$$\nu(\\theta) = \\int_{-\\pi}^{\\pi} w(\\theta - \\theta')\\,\\phi\\big(u(\\theta')\\big)\\,d\\theta' - h,\n$$\n其中 $w(\\Delta)$ 是突触权重核，$h>0$ 是一个恒定的偏置电流。假设突触核纯粹是第一傅里叶模式，\n$$\nw(\\Delta) = w\\,\\cos(\\Delta),\n$$\n其中 $w>0$，并且神经元响应非线性是一个阈值函数，\n$$\n\\phi(u) = H(u),\n$$\n其中 $H(\\cdot)$ 是 Heaviside 阶跃函数，因此如果 $u>0$，则 $\\phi(u)=1$；如果 $u\\le 0$，则 $\\phi(u)=0$。假设该网络支持一个以某个 $\\theta_0$ 为中心的局域化稳态“凸起”解，使得当 $|\\theta - \\theta_0| < \\alpha$ 时 $u(\\theta)>0$，当 $|\\theta - \\theta_0|\\ge \\alpha$ 时 $u(\\theta)\\le 0$，并且 $u(\\theta)$ 在边界 $\\theta=\\theta_0\\pm\\alpha$ 处连续地穿过 0。使用该模型，推导凸起半宽 $\\alpha$ 关于参数 $w$ 和 $h$ 的精确表达式。答案以弧度表示。无需数值舍入；请提供一个闭式解析表达式。",
            "solution": "该问题要求在一个特定的环形吸引子模型中，求出凸起半宽 $\\alpha$ 的表达式。该模型由一个在角坐标 $\\theta \\in (-\\pi, \\pi]$ 参数化的一维圆环上的稳态突触输入场 $u(\\theta)$ 定义。\n\n突触输入的控制方程为：\n$$\nu(\\theta) = \\int_{-\\pi}^{\\pi} w(\\theta - \\theta')\\,\\phi\\big(u(\\theta')\\big)\\,d\\theta' - h\n$$\n问题给出了突触权重核 $w(\\Delta)$ 和神经元响应非线性 $\\phi(u)$ 的具体形式。\n权重核由下式给出：\n$$\nw(\\Delta) = w\\,\\cos(\\Delta)\n$$\n其中 $w>0$。\n\n非线性是 Heaviside 阶跃函数：\n$$\n\\phi(u) = H(u)\n$$\n这意味着当 $u>0$ 时 $\\phi(u)=1$，当 $u \\le 0$ 时 $\\phi(u)=0$。\n\n假设网络支持一个局域化的稳态“凸起”解。该解的特征是一个以某个角度 $\\theta_0$ 为中心、半宽为 $\\alpha$ 的活动区域。根据问题陈述，这意味着：\n$$\nu(\\theta) > 0 \\quad \\text{for } |\\theta - \\theta_0| < \\alpha\n$$\n$$\nu(\\theta) \\le 0 \\quad \\text{for } |\\theta - \\theta_0| \\ge \\alpha\n$$\n由此，发放率函数 $\\phi(u(\\theta'))$ 的值可以确定为：\n$$\n\\phi(u(\\theta')) =\n\\begin{cases}\n1  \\text{if } |\\theta' - \\theta_0| < \\alpha \\\\\n0  \\text{if } |\\theta' - \\theta_0| \\ge \\alpha\n\\end{cases}\n$$\n由于核 $w(\\theta-\\theta')$ 的平移不变性，我们可以不失一般性地将凸起中心设在 $\\theta_0 = 0$。于是，活动区域就是区间 $(-\\alpha, \\alpha)$。\n\n将 $w(\\Delta)$ 和 $\\phi(u)$ 的表达式代入控制积分方程，并将积分限调整为活动区域，我们得到：\n$$\nu(\\theta) = \\int_{-\\alpha}^{\\alpha} w\\,\\cos(\\theta - \\theta') \\cdot 1 \\,d\\theta' - h\n$$\n我们继续计算这个积分：\n$$\nu(\\theta) = w \\int_{-\\alpha}^{\\alpha} \\cos(\\theta - \\theta') \\,d\\theta' - h\n$$\n$\\cos(\\theta - \\theta')$ 关于 $\\theta'$ 的原函数是 $-\\sin(\\theta - \\theta')$。计算该定积分：\n$$\nu(\\theta) = w \\left[ -\\sin(\\theta - \\theta') \\right]_{\\theta'=-\\alpha}^{\\theta'=\\alpha} - h\n$$\n$$\nu(\\theta) = w \\left( (-\\sin(\\theta - \\alpha)) - (-\\sin(\\theta - (-\\alpha))) \\right) - h\n$$\n$$\nu(\\theta) = w \\left( -\\sin(\\theta - \\alpha) + \\sin(\\theta + \\alpha) \\right) - h\n$$\n使用三角和差化积公式 $\\sin(A+B) - \\sin(A-B) = 2\\cos(A)\\sin(B)$，其中 $A=\\theta$ 且 $B=\\alpha$：\n$$\nu(\\theta) = w \\left( 2\\cos(\\theta)\\sin(\\alpha) \\right) - h\n$$\n所以，突触输入场的显式形式为：\n$$\nu(\\theta) = 2w\\sin(\\alpha)\\cos(\\theta) - h\n$$\n问题陈述 $u(\\theta)$ 在凸起的边界处穿过 0，即在 $\\theta = \\pm\\alpha$ 处。我们应用这个边界条件，例如在 $\\theta = \\alpha$ 处：\n$$\nu(\\alpha) = 0\n$$\n$$\n2w\\sin(\\alpha)\\cos(\\alpha) - h = 0\n$$\n使用正弦的二倍角公式 $2\\sin(\\alpha)\\cos(\\alpha) = \\sin(2\\alpha)$，我们有：\n$$\nw\\sin(2\\alpha) - h = 0\n$$\n这个方程将凸起半宽 $\\alpha$ 与模型参数 $w$ 和 $h$ 联系起来。我们现在可以解出 $\\alpha$。\n$$\nw\\sin(2\\alpha) = h\n$$\n$$\n\\sin(2\\alpha) = \\frac{h}{w}\n$$\n由于 $\\alpha$ 代表一个物理上的半宽，我们必须有 $\\alpha > 0$。解的存在性要求 $0 < h/w \\le 1$。根据问题陈述，假设解存在，我们可以对等式两边取反正弦。\n$$\n2\\alpha = \\arcsin\\left(\\frac{h}{w}\\right)\n$$\n分离出 $\\alpha$ 得到最终表达式：\n$$\n\\alpha = \\frac{1}{2}\\arcsin\\left(\\frac{h}{w}\\right)\n$$\n结果以弧度为单位，因为 arcsin 函数返回的值是弧度，这与角度参数化是一致的。此表达式是凸起半宽的精确闭式解。",
            "answer": "$$\n\\boxed{\\frac{1}{2}\\arcsin\\left(\\frac{h}{w}\\right)}\n$$"
        },
        {
            "introduction": "在理解了活动鼓包的静态形状之后，一个自然而然的问题是：是什么让它保持稳定？这个练习深入探讨了鼓包的稳定性，通过在鼓包解附近对网络动力学进行线性化，并分析其特征值来实现。通过引入神经元激活函数斜率产生的“有效增益”这一关键概念，你将学会一种强大的分析技术，并揭示神经元的局部特性如何影响整个网络模式的全局稳定性。",
            "id": "4016965",
            "problem": "考虑一个表示环形变量 $\\theta \\in [0,2\\pi)$ 的连续环形吸引子网络，其发放率动力学为\n$$\n\\tau \\,\\frac{\\partial u(\\theta,t)}{\\partial t} \\;=\\; -\\,u(\\theta,t) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi\\!\\big(u(\\theta',t)\\big)\\,\\frac{d\\theta'}{2\\pi},\n$$\n其中 $\\tau>0$ 是膜时间常数（单位为秒 (s)），$W(\\theta-\\theta')$ 是环上的一个平移不变的突触核，$\\phi(u)$ 是一个光滑的静态非线性函数。假设存在一个稳态的、空间局域的峰形解 $u^{\\ast}(\\theta)$，该解对平移呈中性稳定。将峰形解峰值处的有效增益定义为 $g_{\\text{eff}} \\equiv \\phi'(u^{\\ast})$，其中 $u^{\\ast}$ 是 $u^{\\ast}(\\theta)$ 的峰值振幅。使用围绕 $u^{\\ast}(\\theta)$ 的动力学线性化以及 $W$ 的平移不变性，假设在峰形解的支撑集内，其斜率可以近似为空间上恒定的 $g_{\\text{eff}}$。\n\n从这些假设以及关于环上卷积算子的线性化和傅里叶分析的基本原理出发，推导作用于由 $k \\in \\mathbb{Z}$ 索引的傅里叶模式的线性化算子的特征值 $\\lambda_{k}$ 的解析表达式，该表达式应使用 $\\tau$、$g_{\\text{eff}}$ 和核函数的傅里叶系数 $\\hat{W}_{k}$ 来表示。然后定义敏感度 $S_{k} \\equiv \\frac{\\partial \\lambda_{k}}{\\partial g_{\\text{eff}}}$，并对于给定的特定核函数\n$$\nW(\\Delta\\theta) \\;=\\; J_{0} \\;+\\; J_{1}\\,\\cos(\\Delta\\theta),\n$$\n在参数 $\\tau = 0.02$ s 和 $J_{1} = 1.5$ 的条件下，计算 $k=1$ 时的敏感度值。最终的敏感度以 $\\text{s}^{-1}$ 为单位表示。如果进行任何数值计算，除非有明确指示，否则不要四舍五入；此处不需要四舍五入。最终答案必须是一个实数。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 步骤 1：提取已知条件\n- **动力学方程：** $\\tau \\,\\frac{\\partial u(\\theta,t)}{\\partial t} \\;=\\; -\\,u(\\theta,t) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi\\!\\big(u(\\theta',t)\\big)\\,\\frac{d\\theta'}{2\\pi}$\n- **定义域：** $\\theta \\in [0,2\\pi)$\n- **时间常数：** $\\tau = 0.02$ s，其中 $\\tau > 0$\n- **突触核：** $W(\\theta-\\theta')$ 是一个平移不变的核函数。为最终计算给出了一个具体形式：$W(\\Delta\\theta) \\;=\\; J_{0} \\;+\\; J_{1}\\,\\cos(\\Delta\\theta)$，其中 $J_{1} = 1.5$。\n- **非线性：** $\\phi(u)$ 是一个光滑的静态非线性函数。\n- **假设：**\n    1.  存在一个稳态的、空间局域的峰形解 $u^{\\ast}(\\theta)$。\n    2.  解 $u^{\\ast}(\\theta)$ 对平移呈中性稳定。\n    3.  有效增益定义为 $g_{\\text{eff}} \\equiv \\phi'(u^{\\ast})$，其中 $u^{\\ast}$ 是 $u^{\\ast}(\\theta)$ 的峰值振幅。\n    4.  为了线性化的目的，在峰形解的支撑集内，非线性函数 $\\phi'(u)$ 的斜率可以近似为一个常数 $g_{\\text{eff}}$。\n- **任务定义：**\n    1.  用 $\\tau$、$g_{\\text{eff}}$ 和傅里叶系数 $\\hat{W}_{k}$ 推导线性化算子的特征值 $\\lambda_{k}$。\n    2.  将敏感度定义为 $S_{k} \\equiv \\frac{\\partial \\lambda_{k}}{\\partial g_{\\text{eff}}}$。\n    3.  针对给定的特定核函数和参数，计算 $S_{1}$ 的值。\n- **输出要求：** $S_1$ 的最终答案必须是一个单位为 $\\text{s}^{-1}$ 的实数。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了一个标准的连续吸引子网络模型（环形模型），这是理论和计算神经科学的基石，用于建模工作记忆、头朝向细胞以及其他涉及连续变量的神经计算。该动力学方程是一个成熟的发放率模型。所有概念都是该领域的标准概念。该问题具有科学依据。\n2.  **适定性：** 该问题提供了一套清晰的假设和一个明确定义的数学任务（线性化、傅里叶分析、微分和求值）。所提供的信息足以推导出唯一答案。该问题是适定的。\n3.  **客观性：** 该问题使用精确的数学语言和定义进行陈述。它没有任何主观或模棱两可的术语。该问题是客观的。\n4.  **完备性与一致性：** 提供了所有必要的参数（$\\tau$，$J_1$）和函数形式（$W(\\Delta\\theta)$）。诸如恒定有效增益之类的假设被明确陈述以简化分析，这是一种常见且有效的教学方法。这些假设在内部是一致的。\n5.  **未检测到其他缺陷：** 该问题是神经网络稳定性分析中的一个标准的、有一定难度的练习。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 解题推导\n发放率 $u(\\theta,t)$ 的动力学由以下积分-微分方程给出：\n$$\n\\tau \\,\\frac{\\partial u(\\theta,t)}{\\partial t} \\;=\\; -\\,u(\\theta,t) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi\\!\\big(u(\\theta',t)\\big)\\,\\frac{d\\theta'}{2\\pi}\n$$\n我们在稳态峰形解 $u^*(\\theta)$ 附近对动力学进行线性化。稳态解满足 $\\frac{\\partial u^*}{\\partial t} = 0$，因此：\n$$\n0 \\;=\\; -\\,u^*(\\theta) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi\\!\\big(u^*(\\theta')\\big)\\,\\frac{d\\theta'}{2\\pi}\n$$\n我们考虑在稳态解附近的一个小扰动 $\\delta u(\\theta,t)$，使得 $u(\\theta,t) = u^*(\\theta) + \\delta u(\\theta,t)$。将此代入动力学方程，并在 $u^*(\\theta')$ 附近对非线性函数 $\\phi(u)$ 进行线性化，我们得到：\n$$\n\\phi\\big(u(\\theta',t)\\big) \\;=\\; \\phi\\big(u^*(\\theta') + \\delta u(\\theta',t)\\big) \\;\\approx\\; \\phi\\big(u^*(\\theta')\\big) \\;+\\; \\phi'\\big(u^*(\\theta')\\big)\\,\\delta u(\\theta',t)\n$$\n将此代回完整的方程：\n$$\n\\tau \\,\\frac{\\partial}{\\partial t}\\big(u^*(\\theta) + \\delta u(\\theta,t)\\big) \\;=\\; -\\big(u^*(\\theta) + \\delta u(\\theta,t)\\big) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\left[\\phi\\big(u^*(\\theta')\\big) + \\phi'\\big(u^*(\\theta')\\big)\\,\\delta u(\\theta',t)\\right]\\,\\frac{d\\theta'}{2\\pi}\n$$\n由于 $\\frac{\\partial u^*}{\\partial t}=0$，方程左边变为 $\\tau \\frac{\\partial \\delta u}{\\partial t}$。展开右边：\n$$\n\\tau \\,\\frac{\\partial \\delta u}{\\partial t} \\;=\\; -u^*(\\theta) - \\delta u(\\theta,t) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi\\big(u^*(\\theta')\\big)\\,\\frac{d\\theta'}{2\\pi} \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi'\\big(u^*(\\theta')\\big)\\,\\delta u(\\theta',t)\\,\\frac{d\\theta'}{2\\pi}\n$$\n使用稳态方程，涉及 $u^*$ 和 $\\phi(u^*)$ 的项相互抵消，剩下关于扰动 $\\delta u$ 的线性化方程：\n$$\n\\tau \\,\\frac{\\partial \\delta u}{\\partial t} \\;=\\; - \\delta u(\\theta,t) \\;+\\; \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\phi'\\big(u^*(\\theta')\\big)\\,\\delta u(\\theta',t)\\,\\frac{d\\theta'}{2\\pi}\n$$\n问题陈述假设 $\\phi'(u^*(\\theta'))$ 可以用一个恒定的有效增益 $g_{\\text{eff}}$ 来近似。这将线性化方程简化为：\n$$\n\\tau \\,\\frac{\\partial \\delta u}{\\partial t} \\;=\\; - \\delta u(\\theta,t) \\;+\\; g_{\\text{eff}} \\int_{0}^{2\\pi} W(\\theta-\\theta')\\,\\delta u(\\theta',t)\\,\\frac{d\\theta'}{2\\pi}\n$$\n积分项是 $W$ 和 $\\delta u$ 的卷积，并由 $2\\pi$ 归一化。我们将其表示为 $(W * \\delta u)(\\theta,t)$。我们在傅里叶空间中分析这个方程。设函数 $f(\\theta)$ 的傅里叶级数为 $f(\\theta) = \\sum_{k \\in \\mathbb{Z}} \\hat{f}_k e^{ik\\theta}$，其中傅里叶系数为 $\\hat{f}_k = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} f(\\theta)e^{-ik\\theta}d\\theta$。卷积定理指出，卷积的傅里叶变换是傅里叶变换的乘积：$\\widehat{(f*g)}_k = \\hat{f}_k \\hat{g}_k$。\n\n对我们的线性化方程应用傅里叶变换，我们变换每一项：\n- $\\mathcal{F}\\left\\{ \\tau \\frac{\\partial \\delta u}{\\partial t} \\right\\}_k = \\tau \\frac{d \\widehat{\\delta u}_k(t)}{dt}$\n- $\\mathcal{F}\\left\\{ - \\delta u \\right\\}_k = - \\widehat{\\delta u}_k(t)$\n- $\\mathcal{F}\\left\\{ g_{\\text{eff}} (W * \\delta u) \\right\\}_k = g_{\\text{eff}} \\hat{W}_k \\widehat{\\delta u}_k(t)$\n\n这就得到了一组关于每个傅里叶模式 $k$ 的解耦常微分方程：\n$$\n\\tau \\,\\frac{d \\widehat{\\delta u}_k(t)}{dt} \\;=\\; - \\widehat{\\delta u}_k(t) \\;+\\; g_{\\text{eff}} \\hat{W}_k \\widehat{\\delta u}_k(t) \\;=\\; \\left(-1 + g_{\\text{eff}} \\hat{W}_k\\right) \\widehat{\\delta u}_k(t)\n$$\n这是 $\\frac{dy}{dt} = \\lambda y$ 的形式。因此，线性化算子的特征值 $\\lambda_k$ 为：\n$$\n\\lambda_k \\;=\\; \\frac{-1 + g_{\\text{eff}} \\hat{W}_k}{\\tau}\n$$\n这就是所要求的特征值表达式。\n\n接下来，我们计算敏感度 $S_k \\equiv \\frac{\\partial \\lambda_k}{\\partial g_{\\text{eff}}}$。\n$$\nS_k \\;=\\; \\frac{\\partial}{\\partial g_{\\text{eff}}} \\left( \\frac{-1 + g_{\\text{eff}} \\hat{W}_k}{\\tau} \\right) \\;=\\; \\frac{\\hat{W}_k}{\\tau}\n$$\n我们需要计算 $k=1$ 时的值，所以我们需要 $S_1 = \\frac{\\hat{W}_1}{\\tau}$。为此，我们必须求出给定核函数 $W(\\Delta\\theta) = J_0 + J_1\\cos(\\Delta\\theta)$ 的第一个傅里叶系数 $\\hat{W}_1$。\n傅里叶系数 $\\hat{W}_k$ 由以下公式给出：\n$$\n\\hat{W}_k = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} W(\\theta) e^{-ik\\theta} d\\theta\n$$\n对于 $k=1$：\n$$\n\\hat{W}_1 = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\big(J_0 + J_1\\cos(\\theta)\\big) e^{-i\\theta} d\\theta\n$$\n我们使用欧拉公式表示余弦，$\\cos(\\theta) = \\frac{e^{i\\theta} + e^{-i\\theta}}{2}$：\n$$\n\\hat{W}_1 = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} J_0 e^{-i\\theta} d\\theta \\;+\\; \\frac{1}{2\\pi} \\int_{0}^{2\\pi} J_1 \\left(\\frac{e^{i\\theta} + e^{-i\\theta}}{2}\\right) e^{-i\\theta} d\\theta\n$$\n由于复指数函数在 $[0, 2\\pi)$ 区间上对于整数频率的正交性，第一个积分为零。\n$$\n\\int_{0}^{2\\pi} e^{-i\\theta} d\\theta = \\left[ \\frac{e^{-i\\theta}}{-i} \\right]_0^{2\\pi} = \\frac{e^{-i2\\pi}-e^0}{-i} = \\frac{1-1}{-i} = 0\n$$\n第二个积分变为：\n$$\n\\frac{J_1}{4\\pi} \\int_{0}^{2\\pi} (e^{i\\theta}e^{-i\\theta} + e^{-i\\theta}e^{-i\\theta}) d\\theta \\;=\\; \\frac{J_1}{4\\pi} \\int_{0}^{2\\pi} (1 + e^{-i2\\theta}) d\\theta\n$$\n$$\n= \\frac{J_1}{4\\pi} \\left[ \\theta + \\frac{e^{-i2\\theta}}{-2i} \\right]_0^{2\\pi} \\;=\\; \\frac{J_1}{4\\pi} \\left( (2\\pi + \\frac{1}{-2i}) - (0 + \\frac{1}{-2i}) \\right) = \\frac{J_1}{4\\pi} (2\\pi) = \\frac{J_1}{2}\n$$\n所以，我们得到 $\\hat{W}_1 = \\frac{J_1}{2}$。\n现在我们可以计算敏感度 $S_1$：\n$$\nS_1 = \\frac{\\hat{W}_1}{\\tau} = \\frac{J_1/2}{\\tau} = \\frac{J_1}{2\\tau}\n$$\n最后，我们代入给定的数值：$\\tau=0.02$ s 和 $J_1=1.5$。\n$$\nS_1 = \\frac{1.5}{2 \\times 0.02} = \\frac{1.5}{0.04}\n$$\n简化分数：\n$$\nS_1 = \\frac{150}{4} = \\frac{75}{2} = 37.5\n$$\n$J_1$ 的单位是无量纲的（因为它是一个权重），$\\tau$ 的单位是秒，所以 $S_1$ 的单位是 $\\text{s}^{-1}$，符合要求。",
            "answer": "$$\\boxed{37.5}$$"
        },
        {
            "introduction": "解析解虽然深刻，但通常依赖于简化的模型。现在，我们将转向数值模拟，在一个具有更真实、非饱和非线性（ReLU）的网络中探索鼓包的形成过程。这项实践要求你编写一个迭代算法来模拟网络动力学，从一个微小的初始扰动开始，观察系统如何自组织地形成一个稳定的活动鼓包。这项动手编程练习将理论分析与计算建模联系起来，为你提供了构建和模拟神经场模型的宝贵经验。",
            "id": "4016951",
            "problem": "考虑一个一维环形吸引子神经场模型，该模型定义在角坐标 $\\theta \\in [0,2\\pi)$ 上，具有空间均匀的外部偏置电流和一个余弦调制、相移的突触核。稳态发放率分布 $r(\\theta)$ 由不动点条件建模：\n$$\nr(\\theta) \\;=\\; f\\!\\left( b \\;+\\; \\int_{0}^{2\\pi} W(\\theta - \\theta')\\, r(\\theta')\\, d\\theta' \\right),\n$$\n其中，$f(x)$ 是增益为 $g$ 的整流线性单元（ReLU）非线性，由 $f(x) = \\max(0, g\\,x)$ 给出；刺激偏置 $b$ 是一个常数；突触核为：\n$$\nW(\\Delta) \\;=\\; w_0 \\;+\\; w_1 \\cos(\\Delta - \\phi).\n$$\n所有角度必须以弧度处理。\n\n从神经场定义和环上的循环卷积性质出发，可以通过在 $[0,2\\pi)$ 的 $N$ 点均匀离散上进行迭代替换来逼近不动点，其中积分由步长为 $\\Delta\\theta = 2\\pi/N$ 的黎曼和来近似。迭代方案如下：\n$$\nr^{(n+1)}(\\theta_i) \\;=\\; \\max\\!\\Big(0,\\, g\\Big[ b \\;+\\; \\Delta\\theta \\Big( w_0 \\sum_{j=0}^{N-1} r^{(n)}(\\theta_j) \\;+\\; w_1 \\,\\Re\\!\\Big( e^{\\mathrm{i}(\\theta_i - \\phi)} \\sum_{j=0}^{N-1} r^{(n)}(\\theta_j) e^{-\\mathrm{i}\\theta_j} \\Big)\\Big) \\Big]\\Big),\n$$\n对于 $i=0,1,\\dots,N-1$，并使用一个打破旋转对称性的初始条件。凸起振幅定义为发放率分布的一阶傅里叶模式的模：\n$$\nA \\;=\\; 2\\left|\\frac{1}{N}\\sum_{j=0}^{N-1} r(\\theta_j) e^{-\\mathrm{i}\\theta_j}\\right|.\n$$\n收敛性必须通过监测相对变化来进行数值评估：\n$$\n\\frac{\\| r^{(n+1)} - r^{(n)} \\|_2}{\\| r^{(n)} \\|_2 + \\varepsilon}  \\text{tol},\n$$\n其中 $\\varepsilon$ 是一个小的正常数以避免除以零，$\\text{tol}$ 是一个预设的容差。为防止发散，如果 $\\| r^{(n)} \\|_2$ 超过一个固定的阈值，迭代应终止。\n\n根据环上傅里叶分析的基本原理和算子的线性部分，与积分算子 $\\int W(\\theta-\\theta')(\\cdot)\\,d\\theta'$ 的零阶和一阶傅里叶模式相关的特征值分别为 $2\\pi w_0$ 和 $\\pi w_1$。在线性区域内，全局收敛的一个充分收缩条件是 $g\\,\\rho  1$，其中 $\\rho = \\max(|2\\pi w_0|, |\\pi w_1|)$。在存在整流线性单元（ReLU）的情况下，即使线性区域不是收缩的，非线性也可能引入分段线性行为和凸起解；因此需要进行数值评估。\n\n实现一个程序，该程序：\n- 用 $N$ 个等距点离散化环。\n- 使用上述更新规则迭代计算 $r^{(n)}(\\theta)$，直到收敛或发散。\n- 收敛时，计算如上定义的凸起振幅 $A$。\n- 对每个测试用例，输出一个数对 $[c,a]$，其中如果迭代收敛，则 $c$ 为 $1$，否则为 $0$；$a$ 是四舍五入到六位小数的凸起振幅（无量纲）。如果 $c=0$，则 $a$ 必须为 $0.0$。\n\n使用以下参数值的测试套件（所有角度均为弧度）：\n- 案例1：$w_0=0.05$, $w_1=0.4$, $\\phi=0.0$, $b=0.02$, $g=0.6$。\n- 案例2：$w_0=0.05$, $w_1=0.35$, $\\phi=0.7$, $b=0.01$, $g=0.9$。\n- 案例3：$w_0=0.05$, $w_1=0.35$, $\\phi=0.3$, $b=0.01$, $g=1.1$。\n- 案例4：$w_0=0.0$, $w_1=0.4$, $\\phi=1.5$, $b=0.02$, $g=0.6$。\n- 案例5：$w_0=0.1$, $w_1=0.0$, $\\phi=2.0$, $b=0.02$, $g=0.6$。\n\n算法要求：\n- 使用 $N=512$ 和 $\\Delta\\theta = 2\\pi/N$。\n- 使用初始条件 $r^{(0)}(\\theta_i) = \\delta \\big(1 + \\cos(\\theta_i)\\big)$，其中 $\\delta = 10^{-6}$。\n- 使用 $\\text{tol} = 10^{-10}$，$\\varepsilon = 10^{-12}$，最大迭代次数为 $2000$ 次，发散阈值为 $\\| r^{(n)} \\|_2 > 10^{3}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个结果是如上所述的测试用例的有序对（例如，`[[1,0.123456],[0,0.0],…]`）。角度必须以弧度处理，振幅必须是四舍五入到六位小数的无量纲浮点数。",
            "solution": "该问题陈述在科学上和数学上是适定的，为模拟环形吸引子神经场模型提供了一套完整且一致的定义、方程和参数。该模型是计算神经科学中的一个标准框架，用于研究空间工作记忆和头朝向细胞等现象。所提供的迭代方案是控制积分-微分方程的正确数值离散化。实现所需的所有必要条件，包括离散化大小、初始条件和收敛/发散标准，都得到了明确的规定。因此，该问题是有效的。\n\n通过实现指定的迭代数值模拟来获得解决方案。我们首先将离散系统形式化。\n\n连续角域 $\\theta \\in [0, 2\\pi)$ 被离散化为 $N$ 个等距点 $\\theta_i = i \\cdot \\Delta\\theta$，其中 $i = 0, 1, \\dots, N-1$，角步长为 $\\Delta\\theta = 2\\pi/N$。连续发放率函数 $r(\\theta)$ 由一个向量 $\\mathbf{r} \\in \\mathbb{R}^N$ 表示，其中第 $i$ 个分量是 $r_i = r(\\theta_i)$。\n\n问题的核心是不动点方程：\n$$\nr(\\theta) \\;=\\; f\\!\\left( b \\;+\\; \\int_{0}^{2\\pi} W(\\theta - \\theta')\\, r(\\theta')\\, d\\theta' \\right)\n$$\n其中 $f(x) = \\max(0, g\\,x)$ 且 $W(\\Delta) = w_0 + w_1 \\cos(\\Delta - \\phi)$。\n\n积分项表示核函数 $W$ 与发放率分布 $r$ 的循环卷积。问题提供了该积分的正确离散近似，从而得出了在第 $n$ 次迭代时向量 $\\mathbf{r}^{(n)}$ 的迭代更新规则。让我们分析更新规则中的各项以进行高效计算。\n$$\nr_{i}^{(n+1)} \\;=\\; \\max\\!\\Big(0,\\, g\\Big[ b \\;+\\; \\Delta\\theta \\Big( w_0 \\sum_{j=0}^{N-1} r_{j}^{(n)} \\;+\\; w_1 \\,\\Re\\!\\Big( e^{\\mathrm{i}(\\theta_i - \\phi)} \\sum_{j=0}^{N-1} r_{j}^{(n)} e^{-\\mathrm{i}\\theta_j} \\Big)\\Big) \\Big]\\Big)\n$$\n这两个和可以在每个迭代步骤中预先计算：\n1. 总活动度，$S_0 = \\sum_{j=0}^{N-1} r_{j}^{(n)}$。这是一个标量值。\n2. 未归一化的一阶复傅里叶模式，$S_1 = \\sum_{j=0}^{N-1} r_{j}^{(n)} e^{-\\mathrm{i}\\theta_j}$。这是一个复标量值。\n\n将这些代入更新规则，我们得到第 $i$ 个神经元输入的表达式：\n$$\nx_i^{(n)} = b \\;+\\; \\Delta\\theta \\left( w_0 S_0 \\;+\\; w_1 \\Re\\left( S_1 e^{\\mathrm{i}(\\theta_i - \\phi)} \\right) \\right)\n$$\n整个发放率向量 $\\mathbf{r}$ 的更新可以写成：\n$$\n\\mathbf{r}^{(n+1)} = \\max(0, g \\, \\mathbf{x}^{(n)})\n$$\n其中 $\\mathbf{x}^{(n)}$ 是分量为 $x_i^{(n)}$ 的向量，$\\max$ 操作是逐元素执行的。这种向量化形式非常适合使用像 NumPy 这样的数值库来实现。\n\n模拟过程如下：\n1. **初始化**：创建具有 $N=512$ 个点的角网格 $\\mathbf{\\theta}$。根据 $r^{(0)}(\\theta_i) = \\delta (1 + \\cos(\\theta_i))$（其中 $\\delta = 10^{-6}$）初始化发放率向量 $\\mathbf{r}^{(0)}$。这个微小、非均匀的初始活动对于打破系统的旋转对称性、并允许形成局部化的活动凸起是必要的。\n2. **迭代**：模拟迭代更新规则最多 $2000$ 步。在每一步 $n$ 中：\n    a. 存储当前的发放率向量 $\\mathbf{r}^{(n)}$。\n    b. 从 $\\mathbf{r}^{(n)}$ 计算标量 $S_0$ 和 $S_1$。\n    c. 计算输入向量 $\\mathbf{x}^{(n)}$。\n    d. 通过应用 ReLU 激活函数计算新的发放率向量 $\\mathbf{r}^{(n+1)}$。\n    e. **发散检查**：计算 L2 范数 $\\|\\mathbf{r}^{(n+1)}\\|_2$。如果它超过阈值 $10^3$，则终止模拟，并将结果标记为不收敛 ($c=0$)。\n    f. **收敛检查**：计算 L2 范数的相对变化 $\\frac{\\| \\mathbf{r}^{(n+1)} - \\mathbf{r}^{(n)} \\|_2}{\\| \\mathbf{r}^{(n)} \\|_2 + \\varepsilon}$。如果它低于容差 $\\text{tol} = 10^{-10}$（其中 $\\varepsilon = 10^{-12}$ 用于数值稳定性），则模拟已收敛 ($c=1$)。\n3. **终止**：如果循环完成最大迭代次数仍未满足收敛标准，则模拟也被视为不收敛 ($c=0$)。\n4. **振幅计算**：如果模拟收敛 ($c=1$)，则使用稳态发放率分布 $\\mathbf{r}_{\\text{final}}$ 计算凸起振幅 $A$：\n$$\nA \\;=\\; 2\\left|\\frac{1}{N}\\sum_{j=0}^{N-1} r_{\\text{final}}(\\theta_j) e^{-\\mathrm{i}\\theta_j}\\right| \\;=\\; \\frac{2}{N} \\left| S_{1, \\text{final}} \\right|\n$$\n结果四舍五入到六位小数。如果模拟未收敛，振幅设置为 $a=0.0$。\n\n将这整个过程应用于所提供的五个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ring attractor model problem for a given set of test cases.\n    \"\"\"\n\n    def simulate_ring_attractor(params):\n        \"\"\"\n        Simulates a single instance of the ring attractor model.\n\n        Args:\n            params (dict): A dictionary containing model parameters w0, w1, phi, b, g.\n\n        Returns:\n            list: A list [c, a] where c is the convergence flag (1 or 0) and a is\n                  the rounded bump amplitude or 0.0 for non-convergence.\n        \"\"\"\n        # Algorithmic requirements\n        N = 512\n        delta = 1e-6\n        tol = 1e-10\n        epsilon = 1e-12\n        max_iter = 2000\n        divergence_thresh = 1e3\n\n        # Unpack parameters\n        w0, w1, phi, b, g = params['w0'], params['w1'], params['phi'], params['b'], params['g']\n\n        # Discretize the ring\n        delta_theta = 2 * np.pi / N\n        theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n        \n        # Initial condition to break rotational symmetry\n        r_n = delta * (1 + np.cos(theta))\n\n        # Complex exponential factor for Fourier mode calculation\n        exp_neg_i_theta = np.exp(-1j * theta)\n        \n        # Complex exponential factor for the kernel evaluation\n        exp_i_theta_minus_phi = np.exp(1j * (theta - phi))\n\n        for _ in range(max_iter):\n            r_prev = r_n\n\n            # Calculate the zeroth and first order Fourier components\n            s0 = np.sum(r_n)\n            s1 = np.sum(r_n * exp_neg_i_theta)\n\n            # Calculate the input to the nonlinearity\n            kernel_input = delta_theta * (w0 * s0 + w1 * np.real(exp_i_theta_minus_phi * s1))\n            x = b + kernel_input\n\n            # Apply the ReLU nonlinearity\n            r_n = np.maximum(0, g * x)\n\n            # Check for divergence\n            norm_r_n = np.linalg.norm(r_n)\n            if norm_r_n > divergence_thresh:\n                return [0, 0.0]\n\n            # Check for convergence\n            norm_r_prev = np.linalg.norm(r_prev)\n            diff_norm = np.linalg.norm(r_n - r_prev)\n            \n            if diff_norm / (norm_r_prev + epsilon)  tol:\n                # Converged: calculate bump amplitude\n                s1_final = np.sum(r_n * exp_neg_i_theta)\n                A = 2 * np.abs(s1_final) / N\n                return [1, round(A, 6)]\n\n        # Did not converge within max_iter\n        return [0, 0.0]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'w0': 0.05, 'w1': 0.4, 'phi': 0.0, 'b': 0.02, 'g': 0.6},   # Case 1\n        {'w0': 0.05, 'w1': 0.35, 'phi': 0.7, 'b': 0.01, 'g': 0.9},  # Case 2\n        {'w0': 0.05, 'w1': 0.35, 'phi': 0.3, 'b': 0.01, 'g': 1.1},  # Case 3\n        {'w0': 0.0, 'w1': 0.4, 'phi': 1.5, 'b': 0.02, 'g': 0.6},   # Case 4\n        {'w0': 0.1, 'w1': 0.0, 'phi': 2.0, 'b': 0.02, 'g': 0.6},   # Case 5\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = simulate_ring_attractor(case_params)\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    # Each result is a [c, a] pair, which needs to be formatted to '[c,a.######]'\n    formatted_results = [f\"[{c},{a:.6f}]\" for c, a in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}