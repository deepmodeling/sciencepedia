## 引言
在计算神经科学的核心，我们致力于理解大脑如何通过电脉冲的复杂序列来处理和传递信息。量化比较这些被称为“[脉冲序列](@entry_id:1132157)”的神经响应，是解码[神经编码](@entry_id:263658)、评估[计算模型](@entry_id:637456)和构建[脑机接口](@entry_id:185810)的基石。然而，这些离散且充满时间精度的[信号序列](@entry_id:143660)，无法简单地用传统方法进行比较，这构成了一个根本性的挑战。

本文旨在系统性地解决这一问题，全面介绍用于比较[脉冲序列](@entry_id:1132157)的各种[距离度量](@entry_id:636073)。在第一章“原理与机制”中，我们将深入探讨这些度量的数学基础，从形式化表示到公理化定义，并详细分析基于[分箱](@entry_id:264748)、基于[脉冲时间](@entry_id:1132155)和基于脉冲间隔等关键方法的内部工作原理。接下来的第二章“应用与交叉学科联系”将展示这些理论工具如何在真实世界的研究中发挥作用，从识别[神经编码](@entry_id:263658)策略到验证复杂的神经模型，再到与机器学习等前沿领域的融合。最后，在“动手实践”部分，您将有机会通过具体的编程练习，亲手实现并感受这些度量的强大功能。

通过这三章的学习，您将建立起一个关于[脉冲序列分析](@entry_id:908606)的坚实理论框架，并掌握将其应用于您自己研究中的实用技能。让我们首先从理解这些度量的基本原理开始。

## 原理与机制

在理解[神经编码](@entry_id:263658)和评估[神经计算模型](@entry_id:1128632)的过程中，核心任务之一是量化比较神经元的响应。这些响应通常表现为离散的[脉冲序列](@entry_id:1132157)，即“[脉冲序列](@entry_id:1132157)”。本章将深入探讨用于比较这些[脉冲序列](@entry_id:1132157)的各种距离度量方法背后的基本原理和核心机制。我们将从[脉冲序列](@entry_id:1132157)的数学表示法开始，建立一个严格的框架，然后引入[距离度量](@entry_id:636073)的公理化定义。在此基础上，我们将系统地介绍和分析几类主要的[脉冲序列度量](@entry_id:1132162)，包括基于分箱的方法、基于精确脉冲时间的方法以及基于脉冲间隔的方法，并探讨它们的计算机制、敏感性和理论基础。

### [脉冲序列](@entry_id:1132157)的形式化表示

要对[脉冲序列](@entry_id:1132157)进行定量比较，我们首先需要一个精确的数学描述。一个在有限时间区间 $[0,T]$ 内的[脉冲序列](@entry_id:1132157)，可以被视为一个[点过程](@entry_id:1129862)。在计算神经科学中，通常使用两种等效的表示方法 。

第一种表示法，也是最直观的一种，是将[脉冲序列](@entry_id:1132157)视为一个按时间排序的事件列表。如果一个[脉冲序列](@entry_id:1132157)包含 $N$ 个脉冲，其发生时间分别为 $t_1, t_2, \dots, t_N$，其中满足 $0 \le t_1  t_2  \dots  t_N \le T$，那么该[脉冲序列](@entry_id:1132157)就可以由这个有序集合 $\{t_i\}_{i=1}^N$ 唯一确定。这种表示法直接对应于实验中记录到的原始数据。

第二种更为抽象但功能强大的表示法，是将[脉冲序列](@entry_id:1132157)视为一个测度。具体来说，每个在时间 $t_i$ 发生的脉冲被表示为一个集中在 $t_i$ 的**[狄拉克测度](@entry_id:197577)**（Dirac measure），记为 $\delta_{t_i}$。因此，整个[脉冲序列](@entry_id:1132157)可以表示为一个[计数测度](@entry_id:188748) $x$，即所有单个脉冲测度的总和：
$$
x = \sum_{i=1}^N \delta_{t_i}
$$
这个测度是一个正的、有限的**[拉东测度](@entry_id:188027)**（Radon measure）。对于任何一个时间区间，该测度的值就是该区间内的脉冲数量。例如，通过对一个连续函数 $f(t)$ 进行积分，我们可以“探测”该[脉冲序列](@entry_id:1132157)：$\int f(t) \,dx(t) = \sum_{i=1}^N f(t_i)$。

在“简单[点过程](@entry_id:1129862)”（即任意时刻最多只有一个脉冲）的假设下，这两种表示法是[双射](@entry_id:138092)的：给定的有序时间集合唯一确定一个[计数测度](@entry_id:188748)，反之，一个简单计数[测度的支撑集](@entry_id:191178)（support）也唯一确定了脉冲时间的集合，通过排序即可恢复有序列表 。更深层次上，这两种表示之间的等价性是拓扑性的。当[脉冲时间](@entry_id:1132155)集合的空间被赋予由**[豪斯多夫度量](@entry_id:141976)**（Hausdorff metric）诱导的拓扑（即**维托里斯拓扑**，Vietoris topology），而[测度空间](@entry_id:191702)被赋予**模糊拓扑**（vague topology，或称[弱*拓扑](@entry_id:197256)）时，这两种表示之间的映射是一个[同胚](@entry_id:146933)（homeomorphism）。这意味着，当两个[脉冲序列](@entry_id:1132157)在一种表示下“接近”时，它们在另一种表示下也必然“接近”，从而确保了分析的连续性和一致性。

### 距离度量的公理化定义

在比较两个[脉冲序列](@entry_id:1132157) $X$ 和 $Y$ 时，我们希望得到一个非负的数值 $d(X,Y)$ 来量化它们的“不相似性”。为了使这个数值成为一个严格意义上的**距离**（distance）或**度量**（metric），它必须满足四个基本公理 。对于任意[脉冲序列](@entry_id:1132157) $X, Y, Z$，一个函数 $d(X,Y)$ 必须满足：

1.  **非负性 (Non-negativity)**: $d(X,Y) \ge 0$。距离永远不能是负数。

2.  **不可分者同一性 (Identity of indiscernibles)**: $d(X,Y) = 0$ 当且仅当 $X=Y$。只有当两个[脉冲序列](@entry_id:1132157)完全相同时，它们之间的距离才为零。

3.  **对称性 (Symmetry)**: $d(X,Y) = d(Y,X)$。从 $X$ 到 $Y$ 的距离和从 $Y$ 到 $X$ 的距离是相同的。

4.  **[三角不等式](@entry_id:143750) (Triangle inequality)**: $d(X,Z) \le d(X,Y) + d(Y,Z)$。从 $X$ 直接到 $Z$ 的“路径”不能比经过任何中间点 $Y$ 的路径更长。这个公理确保了度量的一致性，防止出现“捷径悖论”。

在后续章节中，我们将遇到多种度量。证明一个给定的函数确实满足这些公理是确保其有效性的关键一步。通常有两种通用策略来完成这一证明 ：
- 对于**[编辑距离](@entry_id:152711)**（edit-based distances），如 Victor-Purpura 度量，可以通过分析其基本操作（如插入、删除、移动）的成本来逐一验证这些公理。
- 对于**[核方法](@entry_id:276706)距离**（kernel-based distances），如 van Rossum 度量，可以通过将[脉冲序列](@entry_id:1132157)映射（嵌入）到一个[赋范线性空间](@entry_id:264073)（如[巴拿赫空间](@entry_id:143833)），并证明该距离是由该空间的范数导出的。如果映射是[单射](@entry_id:183792)的，那么范数的所有优良性质（包括[三角不等式](@entry_id:143750)）都会自动传递给所定义的距离。

### [脉冲序列度量](@entry_id:1132162)的分类

[脉冲序列度量](@entry_id:1132162)方法多种多样，每种方法都对[脉冲序列](@entry_id:1132157)的不同特征敏感。我们可以将它们大致分为三类：

- **基于分箱的度量 (Binned Metrics)**: 这些方法首先将时间轴划分为离散的“箱子”，然后统计每个箱子里的脉冲数，将[脉冲序列](@entry_id:1132157)转化为一个向量。距离的计算便基于这些向量。

- **基于脉冲时间的度量 (Spike-Timing Metrics)**: 这类方法直接处理精确的脉冲时间，对脉冲的微小时间偏移非常敏感。

- **基于脉冲间隔的度量 (Interspike-Interval Metrics)**: 这类方法关注的是脉冲之间的相对时间间隔（ISI），而不是它们的[绝对时间](@entry_id:265046)。它们对 firing rate 或 firing rhythm 的变化敏感。

### 基于[分箱](@entry_id:264748)的表示与相关度量

最简单直接的[比较方法](@entry_id:177797)是将时间轴 $[0,T]$ 分割成 $N$ 个宽度为 $\Delta = T/N$ 的时间窗或“箱子”。对于每个[脉冲序列](@entry_id:1132157)，我们都可以通过计算每个箱子内的脉冲数来创建一个 $N$ 维的向量 $b$。向量 $b$ 的第 $k$ 个分量 $b_k$ 就是落在时间区间 $[k\Delta, (k+1)\Delta)$ 内的脉冲数量 。

一旦我们将两个[脉冲序列](@entry_id:1132157) $x^{(1)}$ 和 $x^{(2)}$ 转换成向量 $b^{(1)}$ 和 $b^{(2)}$，就可以使用标准的向量度量来比较它们：

- **$L^1$ 距离 ([曼哈顿距离](@entry_id:141126))**: $d_1(b^{(1)}, b^{(2)}) = \sum_{k=0}^{N-1} |b^{(1)}_k - b^{(2)}_k|$。它计算了两个向量在各个维度上差异的绝对值之和。

- **$L^2$ 距离 ([欧几里得距离](@entry_id:143990))**: $d_2(b^{(1)}, b^{(2)}) = \sqrt{\sum_{k=0}^{N-1} (b^{(1)}_k - b^{(2)}_k)^2}$。它计算了两个向量在 $N$ 维空间中的直线距离。

- **余弦相似度 (Cosine Similarity)**: $S_c(b^{(1)}, b^{(2)}) = \frac{b^{(1)} \cdot b^{(2)}}{\|b^{(1)}\|_2 \|b^{(2)}\|_2}$。它测量了两个向量方向上的一致性，取值范围在 $[-1, 1]$ 之间，值越接近 $1$ 表示越相似。（注意：余弦相似度本身不是[距离度量](@entry_id:636073)，但可以轻易转换为距离，例如 $d_c = 1 - S_c$）。

这些度量的性质与箱宽 $\Delta$ 密切相关 。
- **对发放率缩放的敏感性**：如果一个[脉冲序列](@entry_id:1132157)的[向量表示](@entry_id:166424)是另一个的常数倍（例如，$b^{(2)} = c b^{(1)}$，意味着在每个时间箱内，第二个序列的脉冲数都是第一个的 $c$ 倍），余弦相似度将为 $1$，表明它们的发放模式形状完全相同。然而，$L^1$ 和 $L^2$ 距离则会随着 $|c-1|$ 的增加而增加，因为它们对总脉冲数（即发放率的绝对大小）敏感。

- **箱宽 $\Delta$ 的影响**：箱宽的选择至关重要。如果 $\Delta$ 非常大，例如 $\Delta = T$，那么整个[脉冲序列](@entry_id:1132157)就被简化为一个单一的数值——总脉冲数。此时，所有时间信息都丢失了。相反，如果 $\Delta$ 非常小，小于[脉冲时间](@entry_id:1132155)的典型[抖动](@entry_id:200248)尺度 $\sigma$，那么即使是很小的[脉冲时间](@entry_id:1132155)偏移也可能导致脉冲落入相邻的箱子，从而产生很大的 $L^1$ 或 $L^2$ 距离。这使得基于小[分箱](@entry_id:264748)的度量对时间精度非常敏感。因此，[分箱](@entry_id:264748)法在简单性和时间精度之间存在一个固有的权衡。

### 基于[脉冲时间](@entry_id:1132155)的度量

与分箱法不同，许多先进的度量方法直接处理纳秒或毫秒级的精确脉冲时间，以捕捉[神经编码](@entry_id:263658)中的时间信息。

#### 基于编辑的距离：Victor-Purpura 度量

Victor-Purpura (VP) 度量家族是基于**[编辑距离](@entry_id:152711)**（edit distance）思想的典范。它将两个[脉冲序列](@entry_id:1132157)之间的距离定义为将一个序列变换为另一个所需付出的最小“成本” 。这个变换过程可以通过三种基本操作的组合来完成：
1.  **插入 (Insertion)** 一个脉冲：成本为 $1$。
2.  **删除 (Deletion)** 一个脉冲：成本为 $1$。
3.  **移动 (Shift)** 一个脉冲的时间，从 $t_i$ 移动到 $s_j$：成本为 $q|t_i - s_j|$。

这里的参数 $q$ 是一个正数，单位是时间的倒数（例如 $\text{s}^{-1}$），它控制了时间移动成本的权重。

VP 距离 $d_q(T,S)$ 是所有可能的变换路径中成本最低的一个。这个最小成本可以通过**动态规划**（dynamic programming）高效计算。令 $D(i,j)$ 为将序列 $T$ 的前 $i$ 个脉冲 $\{t_1, \dots, t_i\}$ 变换为序列 $S$ 的前 $j$ 个脉冲 $\{s_1, \dots, s_j\}$ 的最小成本。$D(i,j)$ 可以通过考虑三种可能的最后一步操作来递归地计算：
- 删除 $t_i$：成本为 $D(i-1, j) + 1$。
- 插入 $s_j$：成本为 $D(i, j-1) + 1$。
- 将 $t_i$ 移动到 $s_j$：成本为 $D(i-1, j-1) + q|t_i - s_j|$。

因此，我们得到递归关系式 ：
$$
D(i,j) = \min \left( D(i-1,j) + 1, \quad D(i,j-1) + 1, \quad D(i-1,j-1) + q|t_i - s_j| \right)
$$
边界条件为 $D(i,0) = i$，$D(0,j) = j$ 和 $D(0,0)=0$。最终的 VP 距离就是 $D(n_T, n_S)$。

参数 $q$ 的值深刻地影响了 VP 度量的性质，它扮演着一个**时间精度**调节器的角色 。
- 当 $q \to 0^{+}$ 时，移动脉冲的成本趋近于零。此时，度量变得对时间不敏感，只关心脉冲的数量。最优策略是匹配尽可能多的脉冲（即 $\min(n_S, n_T)$ 个），剩下的脉冲则通过插入或删除来处理。因此，距离收敛于两个[脉冲序列](@entry_id:1132157)总数之差的绝对值：$\lim_{q\to 0^{+}} d_q(S,T) = |n_S - n_T|$。
- 当 $q \to \infty$ 时，任何非零时间的移动成本都变得无穷大。因此，只有在两个[脉冲时间](@entry_id:1132155)完全重合（$t_i = s_j$）时，匹配（移动）才是可行的（成本为 $0$）。任何不重合的脉冲都必须被删除并重新插入。若 $M$ 是两个序列中重合脉冲的数量，则距离收敛于非重合脉冲的总数：$\lim_{q\to \infty} d_q(S,T) = (n_S - M) + (n_T - M) = n_S + n_T - 2M$。

#### 基于核的距离：van Rossum 度量

van Rossum 度量提供了一种截然不同的思路。它不直接比较离散的脉冲时间，而是先将每个[脉冲序列](@entry_id:1132157)转换成一个连续的模拟信号，然后比较这些信号 。

这个转换过程是通过**卷积**（convolution）实现的。每个脉冲 $\delta(t-t_i)$ 被一个**[核函数](@entry_id:145324)**（kernel function）$h_\tau(t)$ “[模糊化](@entry_id:260771)”。一个常用的选择是因果指数核：
$$
h_{\tau}(t) = \frac{1}{\tau}\exp\left(-\frac{t}{\tau}\right)u(t)
$$
其中 $u(t)$ 是亥维赛德[阶跃函数](@entry_id:159192)，$\tau$ 是时间常数，决定了模糊的程度。一个[脉冲序列](@entry_id:1132157) $x = \sum_i \delta(t-t_i)$ 经过滤波后得到的信号是 $f_x(t) = \sum_i h_\tau(t-t_i)$。

van Rossum 距离被定义为两个滤波后信号 $f_x(t)$ 和 $f_y(t)$ 之间的 $L^2$ 距离：
$$
d_{\mathrm{vR}}(x,y) = \sqrt{\int_{-\infty}^{\infty} (f_x(t) - f_y(t))^2 dt}
$$
展开被积函数，可以揭示其更深层的结构 ：
$$
d_{\mathrm{vR}}(x,y)^2 = \int f_x(t)^2 dt + \int f_y(t)^2 dt - 2 \int f_x(t) f_y(t) dt
$$
这可以被写成一个[内积](@entry_id:750660)的形式。定义两个[脉冲序列](@entry_id:1132157)之间的核诱导[内积](@entry_id:750660)为 $K(x,y) = \int f_x(t) f_y(t) dt$，则距离的平方为 $d_{\mathrm{vR}}(x,y)^2 = K(x,x) + K(y,y) - 2K(x,y)$。对于指数核，这个[内积](@entry_id:750660)可以被解析地计算出来：
$$
K(x,y) = \sum_i \sum_j \frac{1}{2\tau} \exp\left(-\frac{|t_i - t_j|}{\tau}\right)
$$
这种形式表明，van Rossum 距离本质上是对所有脉冲对之间加权距离的总和，权重由指数衰减函数给出。

#### 最优传输：Wasserstein 距离

第三种基于精确脉冲时间的方法来自**最优传输理论**（optimal transport theory），即**[瓦瑟斯坦距离](@entry_id:147338)**（Wasserstein distance），也称为**[推土机距离](@entry_id:147338)**（Earth Mover's Distance）。这种方法将[脉冲序列](@entry_id:1132157)视为一种[质量分布](@entry_id:158451)，并计算将一个分布“搬运”成另一个分布所需的最小“功”。

为了应用这个框架，我们首先将每个[脉冲序列](@entry_id:1132157)（假设包含 $n$ 个脉冲）归一化为一个经验[概率测度](@entry_id:190821)，即在每个脉冲时间点上放置一个质量为 $1/n$ 的质点：$\mu = \frac{1}{n}\sum_{i=1}^n \delta_{t_i}$ 。

$1$-[瓦瑟斯坦距离](@entry_id:147338) $W_1(\mu, \nu)$ 定义为将[质量分布](@entry_id:158451) $\mu$ 变换为分布 $\nu$ 的最小总成本，其中移动单位质量从 $x$ 到 $y$ 的成本是 $|x-y|$。在一维情况下（即时间轴上），当两个[脉冲序列](@entry_id:1132157)的脉冲数相等时（$n=m$），这个问题有一个非常优雅和直观的解：最优的“搬运”方案是将第一个序列中第 $k$ 小的脉冲移动到第二个序列中第 $k$ 小的脉冲。

因此，如果 $t_{(1)}  t_{(2)}  \dots  t_{(n)}$ 和 $s_{(1)}  s_{(2)}  \dots  s_{(n)}$ 分别是两个已排序的[脉冲时间](@entry_id:1132155)序列，则 $1$-[瓦瑟斯坦距离](@entry_id:147338)为 ：
$$
W_1(\mu, \nu) = \frac{1}{n} \sum_{i=1}^{n} |t_{(i)} - s_{(i)}|
$$
这个公式简单地计算了排序后对应的脉冲时间差异的平均值。

### 基于脉冲间隔的度量

与关注[绝对时间](@entry_id:265046)的度量相反，有些度量专门用于捕捉[脉冲序列](@entry_id:1132157)的节律或模式，而这些信息蕴含在**脉冲间隔**（Interspike Intervals, ISIs）中。

**ISI 距离** 就是这类度量的一个例子 。其核心思想是，对于任意时刻 $t$，我们可以定义一个“瞬时 ISI”值 $\nu_S(t)$，它等于包含时刻 $t$ 的那个脉冲区间的大小。然后，我们定义一个瞬时不相似度 $I(t)$，它是两个[脉冲序列](@entry_id:1132157)在时刻 $t$ 的瞬时 ISI 的相对差异：
$$
I(t) = \frac{|\nu_{S_1}(t) - \nu_{S_2}(t)|}{\max(\nu_{S_1}(t), \nu_{S_2}(t))}
$$
总的 ISI 距离 $D_{\mathrm{ISI}}$ 是这个不相似度在整个观测窗口 $[0,T]$ 上的时间平均值：
$$
D_{\mathrm{ISI}}(T) = \frac{1}{T} \int_{0}^{T} I(t) \,dt
$$
由于函数 $I(t)$ 是分段常数，这个积分可以被精确计算，或者通过在多个采样点上对 $I(t)$求平均来近似。

### 对比度量的敏感性：[发放率编码](@entry_id:148880) vs. 时间编码

不同的度量对[神经编码](@entry_id:263658)的不同方面敏感，这是一个至关重要的概念。我们可以通过一个精心设计的例子来阐明这一点 。

考虑两个[脉冲序列](@entry_id:1132157)，$\mathcal{A} = \{0, 10, 20, 30, 40\}$ ms 和 $\mathcal{B} = \{5, 15, 25, 35, 45\}$ ms。序列 $\mathcal{B}$ 只是序列 $\mathcal{A}$ 的一个整体时间平移。
- 对于 **ISI 距离**，这两个序列是完全相同的。$\mathcal{A}$ 的所有 ISI 都是 $10$ ms，$\mathcal{B}$ 的所有 ISI 也都是 $10$ ms。因此，它们的瞬时 ISI 处处相等，$I(t)=0$，最终的 ISI 距离为 $0$。这表明 ISI 距离对编码的节律或**[发放率编码](@entry_id:148880)**（rate code）敏感，而对整体的时间相位不敏感。
- 对于 **van Rossum 距离**（假设时间常数 $\tau$ 小于平移量，例如 $\tau=3$ ms），情况则完全不同。由于两个序列的脉冲在时间上是错开的，它们滤波后的信号 $f_{\mathcal{A}}(t)$ 和 $f_{\mathcal{B}}(t)$ 的峰值位置也都是错开的。这种持续的失配导致它们差的平方积分（即 $d_{\mathrm{vR}}^2$）会是一个很大的正数。这表明 van Rossum 距离对精确的[脉冲时间](@entry_id:1132155)非常敏感，适用于研究**时间编码**（temporal code）。

这个例子清晰地展示了，没有一个“最好”的度量，选择哪种度量取决于研究者假设神经元使用哪种编码策略来传递信息。

### 扩展与高级主题

#### 群体水平的距离

在许多情况下，我们需要比较的是整个神经元群体（population）的响应，而不仅仅是单个神经元。如何将单神经元度量扩展到群体层面是一个重要问题。

一种直接的方法是**拼接**（concatenation）。例如，对于 van Rossum 距离，我们可以为群体中的每个[神经元计算](@entry_id:174774)其滤波后的信号，然后将这些信号拼接成一个高维向量。群体距离就是这些高维向量之间的 $L^2$ 距离 。这等价于将每个神经元的独立距离的平方相加，然后取平方根：
$$
D_{\mathrm{pop}}^2 = \sum_{i=1}^{K} D_i^2 = \sum_{i=1}^{K} \int_{0}^{\infty} \left( x_i^{A}(t) - x_i^{B}(t) \right)^{2} \, dt
$$
其中 $K$ 是神经元的数量。这种简单的拼接方法有一个重要的局限性：它完全忽略了神经元之间的**相关性**（correlations），例如同步发放。因为计算中没有神经元之间的交叉项，所以它无法捕捉到群体响应的协同模式。更高级的群体度量方法会通过引入交叉项来解决这个问题。

#### 处理重合脉冲

标准度量通常假设[脉冲序列](@entry_id:1132157)是“简单”的，即一个时刻只有一个脉冲。然而，由于记录分辨率或生理原因，可能会出现**重合脉冲**（coincident spikes），即一个[脉冲序列](@entry_id:1132157)在同一时刻有多个脉冲。如何将度量扩展到这种非简单的点过程是一个具有挑战性的高级主题。

一个成功的扩展应满足几个原则：它必须是一个严格的度量，对同一时刻的脉冲的任意排序不敏感（[置换不变性](@entry_id:753356)），在简单[脉冲序列](@entry_id:1132157)情况下能退化为原始度量，并且不依赖于添加[随机抖动](@entry_id:1130551)等随意的“决胜局”方法 。

对于不同的度量家族，存在不同的有效扩展策略：
- 对于 **van Rossum 距离**，最自然的扩展是将其数学基础从简单的脉冲集合推广到[计数测度](@entry_id:188748) $N = \sum_k m_k \delta_{t_k}$，其中 $m_k$ 是在时间 $t_k$ 的脉冲数量（或“权重”）。滤波过程变为对这个[计数测度](@entry_id:188748)进行[线性卷积](@entry_id:190500) $f_N = h_\tau * N$，然后照常计算 $L^2$ 距离。这个方法满足所有理想原则，因为[卷积和](@entry_id:263238) $L^2$ 范数都是线性的，可以自然地处理权重。
- 对于 **Victor-Purpura 距离**，一个强大的扩展是利用前文提到的最优传输框架。我们可以将问题重新表述为一个**[非平衡最优传输](@entry_id:756288)**（unbalanced optimal transport）问题。在这个框架中，我们不再是移动单个脉冲，而是移动“质量”（即脉冲数）。从一个有 $m_j$ 个脉冲的时刻 $t_j$ 移动 $a_{jk}$ 单位质量到有 $n_k$ 个脉冲的时刻 $s_k$ 的成本是 $q|t_j - s_k| a_{jk}$。任何未被匹配的“质量”则被视为被“摧毁”（删除）或“创造”（插入），成本为每单位质量 $1$。这个框架同样满足所有原则，为处理非简单[脉冲序列](@entry_id:1132157)提供了一个坚实的理论基础。

相比之下，一些看似简单的方法，如在计算前随意丢弃重合脉冲，或者对重合脉冲进行任意排序，通常会违反度量的基本公理（如不可分者同一性），因此不是有效的扩展方法 。