{
    "hands_on_practices": [
        {
            "introduction": "在独立成分分析（ICA）中，白化是一个至关重要的预处理步骤，它通过去除数据中的二阶相关性（即解相关）并归一化其方差，从而简化了后续寻找独立成分的任务。这个练习将引导你从第一性原理出发，推导白化变换矩阵，并将其应用于一个具体的例子。通过这个实践，你将掌握任何ICA应用都不可或缺的一项基础技能。",
            "id": "3990037",
            "problem": "假设一位神经数据分析师正在准备用于独立成分分析 (ICA) 的双通道脑电图 (EEG) 观测数据。令零均值观测向量为 $x \\in \\mathbb{R}^{2}$，其协方差为 $\\Sigma_{x} = \\mathbb{E}[x x^{\\top}]$，其中 $\\Sigma_{x}$ 是对称正定的。如果变换后的信号 $z = V x$ 具有单位协方差，即 $\\mathbb{E}[z z^{\\top}] = I$，则称线性变换 $V \\in \\mathbb{R}^{2 \\times 2}$ 为白化变换。\n\n仅从协方差的定义和实对称矩阵的谱定理出发，首先根据 $\\Sigma_{x}$ 的特征分解，推导出一个白化变换 $V$ 的显式表达式。然后，将您的推导应用于特定的协方差矩阵\n$$\n\\Sigma_{x} = \\begin{pmatrix}\n5  4 \\\\\n4  5\n\\end{pmatrix}.\n$$\n构建 $V$ 时，选择标准正交特征基，使得特征值按非增序排列，并且对于每个特征向量，其第一个非零元素为正。请以一个精确的 $2 \\times 2$ 矩阵形式给出最终的 $V$，不进行四舍五入，也不加单位。",
            "solution": "我们从协方差的定义开始。对于一个零均值随机向量 $x \\in \\mathbb{R}^{n}$，其协方差为 $\\Sigma_{x} = \\mathbb{E}[x x^{\\top}]$，以及一个线性变换 $V \\in \\mathbb{R}^{n \\times n}$，变换后的变量 $z = V x$ 的协方差为\n$$\n\\Sigma_{z} = \\mathbb{E}[z z^{\\top}] = \\mathbb{E}[(V x)(V x)^{\\top}] = V \\,\\mathbb{E}[x x^{\\top}]\\, V^{\\top} = V \\Sigma_{x} V^{\\top}.\n$$\n白化变换是任何满足 $\\Sigma_{z} = I$ 的 $V$，这要求\n$$\nV \\Sigma_{x} V^{\\top} = I.\n$$\n\n为了推导 $V$ 的一个显式构造，我们引用实对称矩阵的谱定理。由于 $\\Sigma_{x}$ 是对称正定的，因此存在一个标准正交矩阵 $E$ 和一个对角元素严格为正（即特征值）的对角矩阵 $D$，使得\n$$\n\\Sigma_{x} = E D E^{\\top},\n$$\n其中 $E^{\\top} E = I$ 且 $D = \\operatorname{diag}(\\lambda_{1}, \\ldots, \\lambda_{n})$，并且对于所有 $i \\in \\{1,\\ldots,n\\}$ 都有 $\\lambda_{i} > 0$。\n\n定义对角矩阵 $D^{-1/2} = \\operatorname{diag}(\\lambda_{1}^{-1/2}, \\ldots, \\lambda_{n}^{-1/2})$。考虑变换\n$$\nV = D^{-1/2} E^{\\top}.\n$$\n我们验证这个选择可以白化 $x$：\n$$\nV \\Sigma_{x} V^{\\top} = \\left(D^{-1/2} E^{\\top}\\right) \\left(E D E^{\\top}\\right) \\left(E D^{-1/2}\\right) = D^{-1/2} \\underbrace{E^{\\top} E}_{I} D \\underbrace{E^{\\top} E}_{I} D^{-1/2} = D^{-1/2} D D^{-1/2} = I.\n$$\n因此，$V = D^{-1/2} E^{\\top}$ 是一个有效的白化变换。这有时被称为主成分白化变换。\n\n我们现在将此构造应用于 $n=2$ 且协方差矩阵为以下特定情况：\n$$\n\\Sigma_{x} = \\begin{pmatrix}\n5  4 \\\\\n4  5\n\\end{pmatrix}.\n$$\n首先，通过求解特征方程 $\\det(\\Sigma_{x} - \\lambda I) = 0$ 来计算特征值：\n\n$$\n\\det\\!\\begin{pmatrix}\n5 - \\lambda  4 \\\\\n4  5 - \\lambda\n\\end{pmatrix}\n= (5 - \\lambda)^{2} - 16\n= \\lambda^{2} - 10 \\lambda + 9\n= 0.\n$$\n\n$\\lambda^{2} - 10 \\lambda + 9 = 0$ 的根是\n\n$$\n\\lambda = \\frac{10 \\pm \\sqrt{100 - 36}}{2} = \\frac{10 \\pm 8}{2} \\in \\{9, 1\\}.\n$$\n\n将特征值按非增序排列为 $\\lambda_{1} = 9$ 和 $\\lambda_{2} = 1$。\n\n接下来，计算相应的标准正交特征向量。对于 $\\lambda_{1} = 9$，求解 $(\\Sigma_{x} - 9 I) v = 0$：\n\n$$\n\\begin{pmatrix}\n-4  4 \\\\\n4  -4\n\\end{pmatrix}\n\\begin{pmatrix}\nv_{1} \\\\\nv_{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n\\quad \\Rightarrow \\quad v_{2} = v_{1}.\n$$\n\n一个特征向量与 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 成正比；将其归一化为单位长度并要求第一个非零元素为正，得到\n\n$$\ne_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n\n对于 $\\lambda_{2} = 1$，求解 $(\\Sigma_{x} - I) v = 0$：\n\n$$\n\\begin{pmatrix}\n4  4 \\\\\n4  4\n\\end{pmatrix}\n\\begin{pmatrix}\nv_{1} \\\\\nv_{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n\\quad \\Rightarrow \\quad v_{2} = - v_{1}.\n$$\n\n一个特征向量与 \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} 成正比；将其归一化并要求第一个非零元素为正，得到\n\n$$\ne_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n\n构成标准正交特征向量矩阵\n\n$$\nE = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}\n\\end{pmatrix},\n$$\n\n其列为 $e_{1}$ 和 $e_{2}$。构建\n\n$$\nD = \\begin{pmatrix}\n9  0 \\\\\n0  1\n\\end{pmatrix}\n\\quad \\text{和} \\quad\nD^{-1/2} = \\begin{pmatrix}\n\\frac{1}{3}  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n\n因此，白化变换为\n\n$$\nV = D^{-1/2} E^{\\top} = D^{-1/2} E\n= \\begin{pmatrix}\n\\frac{1}{3}  0 \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{1}{3\\sqrt{2}}  \\frac{1}{3\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}\n\\end{pmatrix}.\n$$\n\n根据上面的通用验证，这个 $V$ 满足 $V \\Sigma_{x} V^{\\top} = I$，从而完成了构造和具体计算。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{3\\sqrt{2}}  \\frac{1}{3\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "FastICA 是通过最大化非高斯性来寻找独立成分的一种高效的定点迭代算法。本练习将理论付诸实践，要求你对一个合成数据集执行一步完整的 FastICA 更新迭代。通过这个练习，你将清晰地理解抽象的更新法则如何转化为对数据的具体数值操作，从而加深对算法核心机制的认识。",
            "id": "3990008",
            "problem": "您将获得一个用于独立分量分析 (ICA) 的合成多通道脑电图 (EEG) 数据集。设观测数据矩阵表示为 $X \\in \\mathbb{R}^{m \\times n}$，其中有 $m=3$ 个通道和 $n$ 个样本。生成模型是标准的瞬时线性混合模型 $x(t) = A s(t)$，其中 $x(t) \\in \\mathbb{R}^{m}$ 是观测到的混合信号，$s(t) \\in \\mathbb{R}^{m}$ 是统计上独立的潜在源信号，而 $A \\in \\mathbb{R}^{m \\times m}$ 是一个可逆的混合矩阵。在独立分量分析 (ICA) 中，我们寻求一个解混矩阵 $W \\in \\mathbb{R}^{m \\times m}$，使得 $y(t) = W z(t)$ 能从白化数据 $z(t)$ 中恢复源信号，恢复结果允许存在尺度和排列上的不确定性。快速独立分量分析 (FastICA) 是一种定点算法，它通过迭代更新 $W$ 来最大化一个与非高斯性相关的对比函数，同时约束 $W$ 的行在白化空间中是标准正交的。\n\n您的任务是在给定数据集和初始 $W$ 的情况下，在对数据进行预白化后，使用指定的非线性函数 $g(u)$ 及其导数 $g'(u)$，实现对称快速独立分量分析 (FastICA) 更新的单次迭代。预白化步骤通过减去经验均值来中心化 $X$，并应用一个线性变换，使 $Z$ 的协方差等于单位矩阵。请使用一种数值稳定的白化方法，即在求协方差矩阵平方根的逆之前，向经验协方差中添加一个对角正则化项 $\\epsilon I$。在计算单次 FastICA 更新后，通过对更新后的 $W$ 进行对称去相关，来强制执行对称标准正交性约束。您必须从基于近似负熵及其得分函数的 ICA 对比函数出发，根据第一性原理推导迭代规则，而不能依赖问题陈述中预先给出的算法公式。\n\n定义和约定：\n- 脑电图 (EEG) 在此定义为一个多通道时间序列矩阵 $X$，具有 $m$ 个通道和 $n$ 个样本。\n- 快速独立分量分析 (FastICA) 指的是一种定点 ICA 算法，它在白化空间中通过满足标准正交性约束，来最大化一个基于非高斯性的对比函数。\n- 白化：给定中心化的 $X$，计算 $S = \\frac{1}{n} X X^{\\top}$ 并构成 $Z = P X$，其中 $P = U \\operatorname{diag}(\\lambda)^{-1/2} U^{\\top}$，$S \\approx U \\operatorname{diag}(\\lambda) U^{\\top}$ 是一个特征值分解，其数值稳定变体使用 $S + \\epsilon I$。\n- 对称去相关：给定一个更新后的 $W$，将其替换为 $W \\leftarrow (W W^{\\top})^{-1/2} W$，从而使得 $W W^{\\top} = I$。\n\n对比函数的非线性选择：\n- 情况 $\\mathrm{tanh}$：$g(u) = \\tanh(\\alpha u)$ 且 $g'(u) = \\alpha \\left(1 - \\tanh(\\alpha u)^{2}\\right)$，斜率参数 $\\alpha > 0$。\n- 情况 $\\mathrm{cubic}$：$g(u) = u^{3}$ 且 $g'(u) = 3 u^{2}$。\n\n为以下每个测试用例精确计算一次 FastICA 迭代（更新后进行对称去相关）。所有情况下均使用 $m=3$。\n\n数据矩阵 $X$：\n- 测试用例 1 和测试用例 2 使用相同的 $X \\in \\mathbb{R}^{3 \\times 10}$：\n  $$\n  X = \\begin{bmatrix}\n  0.5  1.2  -0.7  0.3  -1.1  0.0  0.8  -0.6  1.0  -0.9 \\\\\n  1.0  -0.4  0.6  -1.3  0.2  1.1  -0.5  0.7  -0.8  0.3 \\\\\n  -0.3  0.9  1.4  -0.2  0.5  -1.2  0.6  0.4  -1.0  1.3\n  \\end{bmatrix}.\n  $$\n- 测试用例 3 使用 $X \\in \\mathbb{R}^{3 \\times 4}$：\n  $$\n  X = \\begin{bmatrix}\n  0.2  0.2  0.2  -0.2 \\\\\n  0.1  0.1  0.1  -0.1 \\\\\n  -0.3  -0.3  -0.3  0.3\n  \\end{bmatrix}.\n  $$\n\n初始解混矩阵 $W_{0}$：\n- 测试用例 1：\n  $$\n  W_{0} = \\begin{bmatrix}\n  0.9  -0.2  0.1 \\\\\n  -0.1  0.8  0.3 \\\\\n  0.05  -0.4  0.7\n  \\end{bmatrix}.\n  $$\n- 测试用例 2：\n  $$\n  W_{0} = \\begin{bmatrix}\n  1.0  0.0  0.0 \\\\\n  0.0  1.0  0.0 \\\\\n  0.0  0.0  1.0\n  \\end{bmatrix}.\n  $$\n- 测试用例 3：\n  $$\n  W_{0} = \\begin{bmatrix}\n  0.99  0.01  0.00 \\\\\n  0.98  0.02  0.00 \\\\\n  0.00  0.00  1.00\n  \\end{bmatrix}.\n  $$\n\n非线性函数和白化正则化参数：\n- 测试用例 1：使用 $\\mathrm{tanh}$，其中 $\\alpha = 1.2$，白化正则化参数 $\\epsilon = 10^{-6}$。\n- 测试用例 2：使用 $\\mathrm{cubic}$，无斜率参数，白化正则化参数 $\\epsilon = 10^{-6}$。\n- 测试用例 3：使用 $\\mathrm{tanh}$，其中 $\\alpha = 2.0$，白化正则化参数 $\\epsilon = 10^{-3}$。\n\n算法要求：\n- 通过减去其按列的经验均值来中心化 $X$。\n- 使用正则化协方差 $S + \\epsilon I$ 和特征分解对 $X$ 进行白化，以获得经验协方差接近单位矩阵的 $Z$。\n- 使用选定的 $g(u)$ 和 $g'(u)$ 同时对 $W$ 的所有行执行一次对称 FastICA 更新，然后对更新后的 $W$ 应用对称去相关。\n- 除此次单次更新外，不需要进行其他迭代。\n\n对于每个测试用例，您的程序必须输出更新后的解混矩阵 $W_{\\text{new}}$，形式为一个包含 9 个条目的扁平列表，按行主序排列，并四舍五入到 6 位小数。将所有测试用例的结果聚合到单行中。具体来说，您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素本身就是一个包含 9 个浮点数的扁平列表。例如，外部格式必须为 $[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$。\n\n不涉及任何物理单位、角度或百分比。所有输出都是无单位的浮点数。\n\n测试套件覆盖范围：\n- 测试用例 1 是使用具有中等斜率的光滑 $\\mathrm{tanh}$ 非线性函数的一般情况。\n- 测试用例 2 探究在多项式非线性函数 $\\mathrm{cubic}$ 下的行为。\n- 测试用例 3 探索具有高度共线样本和更强白化正则化的边界条件。\n\n您的程序应生成一行输出，其中包含如上所述的三个扁平列表，格式必须完全符合 $[[\\text{case1\\_list}],[\\text{case2\\_list}],[\\text{case3\\_list}]]$。",
            "solution": "已对用户提供的问题进行了分析和验证。\n\n### 第 1 步：提取已知信息\n- **观测数据模型**：$x(t) = A s(t)$，其中 $X \\in \\mathbb{R}^{m \\times n}$ 是数据矩阵，有 $m=3$ 个通道。\n- **ICA 模型**：$y(t) = W z(t)$，其中 $W \\in \\mathbb{R}^{m \\times m}$ 是解混矩阵，$z(t)$ 是白化数据。\n- **白化定义**：首先对数据 $X$ 进行中心化。协方差为 $S = \\frac{1}{n} X X^{\\top}$。白化变换为 $P = U \\operatorname{diag}(\\lambda)^{-1/2} U^{\\top}$，它源于正则化协方差 $S + \\epsilon I \\approx U \\operatorname{diag}(\\lambda) U^{\\top}$ 的特征值分解。白化后的数据为 $Z = P X$。\n- **对称去相关**：更新后，通过 $W \\leftarrow (W W^{\\top})^{-1/2} W$ 对 $W$ 进行标准正交化。\n- **非线性函数**：\n    - $\\mathrm{tanh}$：$g(u) = \\tanh(\\alpha u)$，$g'(u) = \\alpha (1 - \\tanh(\\alpha u)^{2})$。\n    - $\\mathrm{cubic}$：$g(u) = u^{3}$，$g'(u) = 3 u^{2}$。\n- **测试用例 1**：\n    - $X = \\begin{bmatrix} 0.5  1.2  -0.7  0.3  -1.1  0.0  0.8  -0.6  1.0  -0.9 \\\\ 1.0  -0.4  0.6  -1.3  0.2  1.1  -0.5  0.7  -0.8  0.3 \\\\ -0.3  0.9  1.4  -0.2  0.5  -1.2  0.6  0.4  -1.0  1.3 \\end{bmatrix} \\in \\mathbb{R}^{3 \\times 10}$。\n    - $W_{0} = \\begin{bmatrix} 0.9  -0.2  0.1 \\\\ -0.1  0.8  0.3 \\\\ 0.05  -0.4  0.7 \\end{bmatrix}$。\n    - 非线性函数：$\\mathrm{tanh}$，其中 $\\alpha = 1.2$。\n    - 白化正则化：$\\epsilon = 10^{-6}$。\n- **测试用例 2**：\n    - $X$：与测试用例 1 相同。\n    - $W_{0} = I = \\begin{bmatrix} 1.0  0.0  0.0 \\\\ 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}$。\n    - 非线性函数：$\\mathrm{cubic}$。\n    - 白化正则化：$\\epsilon = 10^{-6}$。\n- **测试用例 3**：\n    - $X = \\begin{bmatrix} 0.2  0.2  0.2  -0.2 \\\\ 0.1  0.1  0.1  -0.1 \\\\ -0.3  -0.3  -0.3  0.3 \\end{bmatrix} \\in \\mathbb{R}^{3 \\times 4}$。\n    - $W_{0} = \\begin{bmatrix} 0.99  0.01  0.00 \\\\ 0.98  0.02  0.00 \\\\ 0.00  0.00  1.00 \\end{bmatrix}$。\n    - 非线性函数：$\\mathrm{tanh}$，其中 $\\alpha = 2.0$。\n    - 白化正则化：$\\epsilon = 10^{-3}$。\n- **任务**：为每种情况计算一次对称 FastICA 迭代（更新 + 去相关）。\n- **输出**：包含最终矩阵 $W_{\\text{new}}$ 的 9 个条目的三个扁平列表（按行主序），四舍五入到 6 位小数，格式为 $[[\\dots],[\\dots],[\\dots]]$ 的单行。\n\n### 第 2 步：使用提取的已知信息进行验证\n- **科学依据**：该问题基于独立分量分析 (ICA)，这是一种在信号处理和计算神经科学中广泛使用的标准方法。FastICA 算法、白化、负熵和对称去相关的概念都是已确立且数学上合理的原则。所选的非线性函数是该算法的典型示例。该问题是这些原则的直接应用。\n- **适定性**：每个测试用例都明确提供了所有必要的输入——数据矩阵、初始解混矩阵、算法参数（$\\alpha$、$\\epsilon$）和非线性函数的选择。算法的步骤定义清晰。这种结构确保了单次迭代存在唯一且确定性的数值解。\n- **客观性**：该问题以精确的数学术语和算法步骤陈述，没有任何主观性或模糊性。\n- **完整性和一致性**：问题是自洽的。所有维度、数据和参数都是一致且足以执行所需计算的。设计的测试用例旨在涵盖算法行为的不同方面（例如，不同的非线性函数，近奇异数据）。\n\n### 第 3 步：结论与行动\n该问题是**有效的**，因为它科学合理、适定、客观且完整。将提供解决方案。\n\n### 基于原理的解决方案设计\n\n独立分量分析 (ICA) 的目标是从观测到的线性混合信号 $x(t) = A s(t)$ 中恢复一组统计独立的源信号 $s(t)$。这是通过寻找一个解混矩阵 $W$ 来实现的，使得 $y(t) = W x(t)$ 的分量尽可能独立。FastICA 算法通过优化一个非高斯性度量来完成此任务，因为中心极限定理表明，独立源的混合信号比源信号本身更趋向于高斯分布。\n\n**1. 对比函数及其优化**\n\nFastICA 的核心是最大化一个近似负熵的对比函数。负熵 $J(y)$ 衡量随机变量 $y$ 与具有相同方差的高斯变量之间的熵差。负熵的一个常见近似形式为 $J(y) \\propto [\\mathbb{E}\\{G(y)\\} - \\mathbb{E}\\{G(\\nu)\\}]^2$，其中假设 $y$ 的均值为零，方差为单位一，$\\nu$ 是一个标准正态变量，$G$ 是一个合适的非二次函数。最大化此对比函数等价于寻找 $\\mathbb{E}\\{G(y)\\}$ 的极值。\n\nFastICA 算法对白化数据 $z(t)$ 进行操作，其协方差矩阵 $\\mathbb{E}\\{z z^{\\top}\\}$ 是单位矩阵 $I$。一个估计的源信号由投影 $y = w^{\\top}z$ 给出。由于数据是白化的，$\\mathbb{E}\\{y^2\\} = w^{\\top}\\mathbb{E}\\{zz^{\\top}\\}w = w^{\\top}Iw = \\|w\\|^2$。我们将 $w$ 约束为单位向量，因此 $\\|w\\|^2 = 1$，这使得投影的方差为 1。\n\n优化问题是在约束 $\\|w\\|^2=1$ 下最大化 $\\mathbb{E}\\{G(w^{\\top}z)\\}$。使用拉格朗日乘子 $\\lambda$，我们优化：\n$$\n\\mathcal{L}(w) = \\mathbb{E}\\{G(w^{\\top}z)\\} - \\frac{\\lambda}{2} (w^{\\top}w - 1)\n$$\n对 $w$ 求梯度并令其为零，得到最优性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w} = \\mathbb{E}\\{z \\cdot g(w^{\\top}z)\\} - \\lambda w = 0\n$$\n其中 $g(u) = G'(u)$ 是非线性函数。这个方程构成了定点迭代的基础。使用近似牛顿法进行原理推导，可以得到单个分量（解混矩阵的一行）的以下更新规则：\n$$\nw^{+} \\leftarrow \\mathbb{E}\\{z g(w^{\\top}z)\\} - \\mathbb{E}\\{g'(w^{\\top}z)\\}w\n$$\n然后进行归一化，$w^{+} \\leftarrow w^{+} / \\|w^{+}\\| $。\n\n**2. 对称 FastICA 和去相关**\n\n对称方法不是逐个估计分量（递减法），而是并行更新整个解混矩阵 $W$。$W$ 的更新规则是单单元规则的直接矩阵推广：\n$$\nW^{+} \\leftarrow \\mathbb{E}\\{g(WZ)Z^{\\top}\\} - \\mathrm{diag}(\\mathbb{E}_{\\text{rows}}\\{g'(WZ)\\})W\n$$\n在这里，$Z$ 是白化数据的 $m \\times n$ 矩阵，$g$ 和 $g'$ 逐元素应用于投影的 $m \\times n$ 矩阵 $WZ$。期望 $\\mathbb{E}\\{\\cdot\\}$ 通过对 $n$ 个样本求平均来实现。第一项 $\\mathbb{E}\\{g(WZ)Z^{\\top}\\}$ 计算为 $\\frac{1}{n} g(WZ)Z^{\\top}$。第二项涉及一个对角矩阵，其对角线元素是 $g'(WZ)$ 的行均值，对应于 $W$ 的每一行 $w_i$ 的 $\\mathbb{E}\\{g'(w_i^{\\top}z)\\}$。\n\n此更新后，不能保证 $W^{+}$ 的行是正交的。为了强制执行在白化空间中所需的标准正交性约束（即 $WW^{\\top}=I$），应用对称去相关步骤：\n$$\nW_{\\text{new}} \\leftarrow (W^{+} (W^{+})^{\\top})^{-1/2} W^{+}\n$$\n矩阵 $C = W^{+} (W^{+})^{\\top}$ 的平方根倒数可以通过其特征值分解来稳健地计算。如果 $C = E D E^{\\top}$，其中 $E$ 是特征向量矩阵，$D$ 是特征值的对角矩阵，则 $C^{-1/2} = E D^{-1/2} E^{\\top}$。\n\n**3. 数据预处理：中心化和白化**\n\n在应用 FastICA 更新之前，必须对数据进行预处理。\n- **中心化**：从数据中减去每个通道的均值，以确保其均值为零。给定数据矩阵 $X \\in \\mathbb{R}^{m \\times n}$，中心化后的数据是 $X_c = X - \\mathbb{E}\\{X\\}$，其中期望是跨样本（$X^{\\top}$ 的行）的经验均值。\n- **白化**：此步骤转换数据，使其分量不相关且具有单位方差，即其协方差矩阵是单位矩阵。中心化数据的经验协方差矩阵是 $S = \\frac{1}{n} X_c X_c^{\\top}$。为保证数值稳定性，添加一个小的正则化项 $\\epsilon I$：$S_{\\text{reg}} = S + \\epsilon I$。此对称矩阵的特征值分解为 $S_{\\text{reg}} = U \\Lambda U^{\\top}$。白化矩阵是 $P = U \\Lambda^{-1/2} U^{\\top}$。最终的白化数据是 $Z = P X_c$。\n\n**4. 单次迭代算法**\n\n单次迭代的完整算法如下：\n1.  **中心化数据**：给定 $X$，计算 $X_c = X - \\frac{1}{n}\\sum_{t=1}^n x(t)$。\n2.  **白化数据**：\n    a. 计算正则化协方差矩阵 $S_{\\text{reg}} = \\frac{1}{n} X_c X_c^{\\top} + \\epsilon I$。\n    b. 求其特征值分解 $S_{\\text{reg}} = U \\Lambda U^{\\top}$。\n    c. 构造白化矩阵 $P = U \\Lambda^{-1/2} U^{\\top}$。\n    d. 获得白化数据 $Z = P X_c$。\n3.  **FastICA 更新**：给定初始解混矩阵 $W_0$，计算更新后的（但尚未标准正交的）矩阵 $W^{+}$：\n    $$\n    W^{+} = \\frac{1}{n} g(W_0 Z) Z^{\\top} - \\mathrm{diag}\\left(\\text{mean}_{\\text{cols}}[g'(W_0 Z)^{\\top}]\\right) W_0\n    $$\n    其中使用提供的非线性函数 $g$ 和 $g'$。\n4.  **对称去相关**：对 $W^{+}$ 的行进行标准正交化，以获得本次迭代的最终矩阵 $W_{\\text{new}}$：\n    a. 计算 $C = W^{+} (W^{+})^{\\top}$。\n    b. 求其特征值分解 $C = E D E^{\\top}$。\n    c. 应用变换 $W_{\\text{new}} = (E D^{-1/2} E^{\\top}) W^{+}$。\n此过程将应用于每个测试用例及其特定的数据和参数。",
            "answer": "[[0.692383,-0.165261,0.702220,-0.347079,0.923899,-0.148154,0.630045,0.348421,-0.697486]],[[-0.609121,-0.509749,0.606786],[0.026720,0.748367,0.662758],[0.792576,-0.422770,0.439600]],[[0.710777,0.703248,-0.015291],[0.703417,-0.710738,-0.007621],[-0.003975,-0.017589,-0.999838]]]"
        },
        {
            "introduction": "成功应用ICA不仅仅依赖于核心算法，更取决于分析流程中一系列明智的方法学选择。本练习聚焦于其中最关键的决策之一：选择要估计的独立成分数量。通过分析对成分数量的欠估计和过估计所带来的不同后果，你将培养设计稳健ICA分析方案和正确解读结果所必需的批判性思维。",
            "id": "3990038",
            "problem": "考虑一个神经记录场景，其中有 $m$ 个传感器，潜在的神经源由线性瞬时混合模型 $x(t) = A s(t) + \\epsilon(t)$ 建模，其中 $x(t) \\in \\mathbb{R}^{m}$ 是在时间 $t$ 观测到的传感器向量，$A \\in \\mathbb{R}^{m \\times k}$ 是混合矩阵，$s(t) \\in \\mathbb{R}^{k}$ 是潜在源向量，其分量在统计上是独立的非高斯信号，$\\epsilon(t)$ 是近似高斯的传感器噪声。您应用主成分分析 (PCA) 进行降维，保留 $n$ 个主成分，然后对白化的 $n$ 维数据执行独立成分分析 (ICA) 以估计 $n$ 个独立成分。这个工作流程在脑电图 (EEG)、脑磁图 (MEG) 和功能性磁共振成像 (fMRI) 分析中很常见。\n\n假设以下基本事实成立：独立成分分析 (ICA) 的可识别性要求源信号是非高斯、统计独立的；通过主成分分析 (PCA) 进行白化会在保留的子空间中产生各向同性的噪声；可恢复的独立成分数量不能超过保留的维度 $n$。请考虑选择的 $n$ 小于真实神经源数量 $k$（低估 $n$）与选择的 $n$ 大于 $k$ 但不超过 $m$（高估 $n$）的后果，特别是在所得成分的可解释性（将成分分配给不同生理过程的能力）方面。\n\n下列哪些陈述是正确的？\n\nA. 低估 $n$ 会导致多个真实源被合并到单个估计成分中，降低了估计成分时间序列之间的统计独立性，并产生反映不同生理过程混合的空间图谱和时间序列，从而降低了可解释性。\n\nB. 在存在加性高斯噪声的情况下，高估 $n$ 倾向于将噪声分散到多个估计成分中。真实的非高斯源在很大程度上仍然是可恢复的，但多余的成分在多次运行中不稳定且可复现性低，从而通过增加虚假成分的数量来降低可解释性。\n\nC. 低估 $n$ 可以提高可解释性，因为需要考虑的成分更少，并且优化独立性可确保合并后的源比原始源更独立。\n\nD. 高估 $n$ 会产生同一真实源的多个副本，由于 ICA 的模糊性，这些副本仅在符号上有所不同。因为副本携带相同的信息，所以可解释性基本上不受影响。\n\nE. 低估 $n$ 会使估计的混合矩阵列偏向于主成分分析 (PCA) 保留的主导方差源，抑制较弱的源，并增加保留子空间的解释方差，同时降低将成分归因于不同生物过程的能力。\n\nF. 高估 $n$ 会增加过拟合噪声子空间的风险，产生超额峰度接近零且与行为或任务回归量的互信息较低的成分。如果这些成分被纳入分析，它们会增加错误发现并降低可解释性；如果它们被客观标准拒绝，可解释性可以被部分保留。\n\n选择所有适用项。",
            "solution": "该问题陈述是有效的。它描述了独立成分分析 (ICA) 应用于多通道时间序列数据（尤其是在神经影像学中）的一个标准且易于理解的场景。其模型、假设以及关于维度选择后果的核心问题在科学上是合理的、适定的和客观的。\n\n分析的关键在于顺序应用主成分分析 (PCA) 进行降维和白化，然后应用 ICA 进行源分离。相对于潜在源的真实数量 $k$，选择要保留的成分数量 $n$ 是至关重要的。\n\n线性混合模型由下式给出：\n$$x(t) = A s(t) + \\epsilon(t)$$\n其中 $x(t) \\in \\mathbb{R}^{m}$ 是传感器信号，$s(t) \\in \\mathbb{R}^{k}$ 是潜在的独立非高斯源，$A \\in \\mathbb{R}^{m \\times k}$ 是混合矩阵，$\\epsilon(t)$ 是高斯噪声。\n\n该过程包括两个步骤：\n1.  **PCA 和白化**：数据 $x(t)$ 被投影到由前 $n$ 个主成分张成的 $n$ 维空间上。设白化后的数据为 $y(t) \\in \\mathbb{R}^{n}$。此步骤会丢弃其余 $m-n$ 个维度中包含的信息。\n2.  **ICA**：找到一个解混矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 来估计 $n$ 个源信号 $\\hat{s}(t) = W y(t)$，使得 $\\hat{s}(t)$ 的分量在统计上最大程度地独立。\n\n我们分析两种指定的情况。\n\n**情况 1：低估 ($n  k$)**\n\n当选择的维度 $n$ 小于真实的源数量 $k$ 时，PCA 步骤构成了一个瓶颈。$k$ 个独立源 $s(t)$ 张成一个 $k$ 维子空间（$A$ 的列空间），它们被投影到一个维度为 $n$ 的更低维子空间上。这种投影本质上是有损的。从原始源 $s(t)$ 到白化数据 $y(t)$ 的转换可以用一个有效混合矩阵 $A' \\in \\mathbb{R}^{n \\times k}$ 来描述。然后，ICA 算法试图为 $n$ 个源求解问题 $y(t) = A' s(t) + \\text{noise}'$，而实际上数据中存在 $k$ 个源。\n\n因为 $n  k$，所以从数学上不可能恢复原始的 $k$ 个独立源。ICA 算法在试图从由 $k$ 个源生成的数据中找到 $n$ 个最大程度独立的成分时，将产生原始源的线性混合成分。这违背了源分离的目标。根据中心极限定理，独立随机变量的混合趋向于高斯分布。因此，PCA 阶段的预混合使得后续的 ICA 任务更加困难，其解的意义也更小。\n\n此外，PCA 基于方差选择维度。如果 $k$ 个真实源中的一些源具有低方差（“较弱”的源），它们在信号空间中对应的方向很可能在降维到 $n$ 维的过程中被丢弃。因此，保留的子空间偏向于表示主导的高方差源。\n\n**后果**：估计的成分不是生理上不同的源，而是多个真实源的复合体。它们的时间动态和空间图谱是混合的，这使得将它们解释为代表单个、定义明确的神经生理过程变得困难或不可能。\n\n**情况 2：高估 ($k  n \\le m$)**\n\n当选择的维度 $n$ 大于真实的非高斯源数量 $k$ 时，PCA 步骤保留了整个 $k$ 维信号子空间，以及额外的 $n-k$ 个维度。在有噪声的情况下，这些额外的维度主要由高斯噪声 $\\epsilon(t)$ 的结构决定。\n\n经过 PCA 和白化后，$n$ 维数据 $y(t)$ 包含大约 $k$ 个携带非高斯源信息的维度和 $n-k$ 个主要包含各向同性（球化）高斯噪声的维度。\n\n然后，ICA 算法的任务是找到 $n$ 个独立成分。\n-   它通常会成功识别出对应于真实源 $s(t)$ 的 $k$ 个强的非高斯成分。这些成分将是稳定且可解释的。\n-   对于剩余的 $n-k$ 个成分，ICA 被迫在一个球化高斯噪声的子空间内寻找“最大独立”或“最大非高斯”的投影。球化高斯数据的任何旋转都会产生独立且高斯的分量。没有唯一的非高斯基可以被找到。因此，算法很可能会抓住一些虚假的、样本特定的对完美高斯性的偏离。\n\n**后果**：算法输出 $k$ 个真实源加上 $n-k$ 个虚假的、由噪声驱动的成分。这些噪声成分不稳定（即，在算法的不同运行中或数据稍有变化时，它们会显著变化）并且缺乏明确的生理意义。这增加了研究人员区分真实源和噪声的负担，增加了错误发现（将噪声成分解释为真实信号）的风险，并降低了整体的可解释性。\n\n现在我们根据这个分析来评估每个选项。\n\n**A. 低估 $n$ 会导致多个真实源被合并到单个估计成分中，降低了估计成分时间序列之间的统计独立性，并产生反映不同生理过程混合的空间图谱和时间序列，从而降低了可解释性。**\n这个陈述是我们对 $n  k$ 情况分析的直接后果。降维步骤强制将 $k$ 个真实源混合到一个 $n$ 维表示中。ICA 随后无法分离这些预混合的源，导致估计的成分是原始源的混合体。这从根本上损害了可解释性。关于“降低了估计成分时间序列之间的统计独立性”的说法有点模糊；ICA *最大化*的是*估计*成分的独立性。然而，这些估计的成分本身就是混合物，因此不能代表原始的、真正独立的源。其核心论断是正确的。\n结论：**正确**。\n\n**B. 在存在加性高斯噪声的情况下，高估 $n$ 倾向于将噪声分散到多个估计成分中。真实的非高斯源在很大程度上仍然是可恢复的，但多余的成分在多次运行中不稳定且可复现性低，从而通过增加虚假成分的数量来降低可解释性。**\n这个陈述准确地描述了 $k  n$ 的情况。$k$ 个真实源通常能被找到，但算法被迫对剩余的 $n-k$ 个噪声维度进行建模。这导致了 $n-k$ 个虚假的、不稳定的、不可复现的成分。这些额外的“噪声”成分的存在使分析复杂化并降低了可解释性。\n结论：**正确**。\n\n**C. 低估 $n$ 可以提高可解释性，因为需要考虑的成分更少，并且优化独立性可确保合并后的源比原始源更独立。**\n这个陈述是有缺陷的。虽然成分数量较少，但它们的质量严重下降，因为它们是真实源的混合物。“合并后的源比原始源更独立”的说法在数学上是不正确的。原始源被假定是独立的；你无法在此基础上改进。在 $n  k$ 的情况下将它们混合，会降低它们的可分离性。\n结论：**不正确**。\n\n**D. 高估 $n$ 会产生同一真实源的多个副本，由于 ICA 的模糊性，这些副本仅在符号上有所不同。因为副本携带相同的信息，所以可解释性基本上不受影响。**\n这是对高估结果的不正确描述。典型结果不是真实源的简单复制，而是从噪声子空间生成虚假成分，如对 B 的分析中所解释。虽然一个非常强的源偶尔可能会被某些算法分裂成两个高度相关的成分，但主要问题是产生了新的、无法解释的噪声成分。“可解释性基本上不受影响”的说法是错误的。\n结论：**不正确**。\n\n**E. 低估 $n$ 会使估计的混合矩阵列偏向于主成分分析 (PCA) 保留的主导方差源，抑制较弱的源，并增加保留子空间的解释方差，同时降低将成分归因于不同生物过程的能力。**\n这个陈述正确地指出了低估场景中的一个关键机制。PCA 是一种基于方差的方法。通过只保留前 $n$ 个成分，它必然会丢弃方差最小的维度。如果一些真实的生理源对传感器信号的方差贡献较小，它们最有可能被滤除。这使得分析偏向于仅考虑最强的源，并导致关于较弱但可能重要的生物过程的信息丢失。将成分归因于不同过程的能力下降是一个直接结果。\n结论：**正确**。\n\n**F. 高估 $n$ 会增加过拟合噪声子空间的风险，产生超额峰度接近零且与行为或任务回归量的互信息较低的成分。如果这些成分被纳入分析，它们会增加错误发现并降低可解释性；如果它们被客观标准拒绝，可解释性可以被部分保留。**\n这个陈述对高估的后果提供了详细而准确的技术描述。“过拟合噪声子空间”是一个极好的描述。由于多余的成分源于近似高斯的噪声，它们将具有接近高斯分布的特性，例如接近于零的超额峰度。作为噪声，它们不应与有意义的外部变量相关。接受它们会导致错误发现。最后一点——使用客观标准（如峰度、空间图谱的合理性或解释方差）来识别和拒绝这些噪声成分是缓解该问题的有效策略——也是正确的，并反映了最佳实践。\n结论：**正确**。",
            "answer": "$$\\boxed{ABEF}$$"
        }
    ]
}