{
    "hands_on_practices": [
        {
            "introduction": "要理解小脑的计算作用，我们必须首先描绘其基本回路。本练习要求您将经典的小脑微电路表示为一个线性系统，从而使您能够追踪从输入到输出通过其主要通路的信号流 。通过将复杂的生物学结构抽象为一个简单的矩阵模型，您将计算该回路的净计算效应，这是构建更复杂的运动控制模型的一项基本技能。",
            "id": "4027513",
            "problem": "考虑一个典型的由以下四种节点类型组成的微小脑回路：苔藓纤维（$M$）、颗粒细胞（$G$）、浦肯野细胞（$P$）和深部小脑核（$D$）。在生物学术语中，苔藓纤维到颗粒细胞的突触是谷氨酸能的，因此是兴奋性的；平行纤维（颗粒细胞轴突）到浦肯野细胞的突触是兴奋性的；浦肯野细胞到深部小脑核的突触是$\\gamma$-氨基丁酸（GABA）介导的，因此是抑制性的。在一个群体水平的线性速率模型中，设状态向量为 $x \\in \\mathbb{R}^{4}$，按 $(M, G, P, D)$ 排序，突触图由一个邻接矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 表示，其中 $A_{j i}$ 是单位时间内从节点 $i$ 到节点 $j$ 的带符号增益。\n\n非零的突触增益如下：从苔藓纤维到颗粒细胞为 $w_{G M} = 0.8$，从颗粒细胞到浦肯野细胞为 $w_{P G} = 0.9$，从浦肯野细胞到深部小脑核为 $w_{D P} = 1.2$。由于浦肯野细胞到深部小脑核的突触是抑制性的，它贡献一个负号。在此构造中，这四个节点之间的所有其他直接连接均设置为零。\n\n1. 使用这些规则和节点顺序 $(M, G, P, D)$，构造有向邻接矩阵 $A$。\n2. 从线性时不变的群体动力学 $x_{t+1} = A x_{t}$ 和突触作用线性组合的第一性原理出发，推导仅沿浦肯野细胞分支 $M \\to G \\to P \\to D$ 传播的净带符号增益。将最终结果表示为一个无量纲的实数。\n\n你的最终答案必须是一个实数。无需四舍五入。将最终答案表示为一个无量纲量。",
            "solution": "问题陈述经评估有效。它在科学上基于一个简化但标准的小脑回路模型，问题设定良好，信息充分且一致，陈述客观。任务是为一个线性速率模型构造一个邻接矩阵，然后计算沿特定多突触通路的净增益。\n\n首先，我们解决有向邻接矩阵 $A$ 的构造问题。状态向量 $x$ 按 $(M, G, P, D)$ 排序，分别对应索引 $1, 2, 3, 4$。邻接矩阵的元素 $A_{ji}$ 表示从节点 $i$（源）到节点 $j$（目标）的带符号增益。\n\n给定的连接及其对应的非零矩阵元素如下：\n1.  从苔藓纤维（$M$，索引 $1$）到颗粒细胞（$G$，索引 $2$）的连接是兴奋性的，增益为 $w_{GM} = 0.8$。因此，矩阵元素 $A_{21}$ 为正：\n    $$A_{21} = +w_{GM} = 0.8$$\n2.  从颗粒细胞（$G$，索引 $2$）到浦肯野细胞（$P$，索引 $3$）的连接是兴奋性的，增益为 $w_{PG} = 0.9$。因此，矩阵元素 $A_{32}$ 为正：\n    $$A_{32} = +w_{PG} = 0.9$$\n3.  从浦肯野细胞（$P$，索引 $3$）到深部小脑核（$D$，索引 $4$）的连接是抑制性的，增益为 $w_{DP} = 1.2$。因此，矩阵元素 $A_{43}$ 为负：\n    $$A_{43} = -w_{DP} = -1.2$$\n\n问题陈述指出，这四个节点之间的所有其他直接连接都设置为零。这意味着矩阵 $A$ 的所有其他元素都为 $0$。按照 $(M, G, P, D)$ 的顺序，得到的 $4 \\times 4$ 邻接矩阵 $A$ 为：\n$$\nA = \n\\begin{pmatrix}\nA_{11}  A_{12}  A_{13}  A_{14} \\\\\nA_{21}  A_{22}  A_{23}  A_{24} \\\\\nA_{31}  A_{32}  A_{33}  A_{34} \\\\\nA_{41}  A_{42}  A_{43}  A_{44}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  0  0  0 \\\\\n0.8  0  0  0 \\\\\n0  0.9  0  0 \\\\\n0  0  -1.2  0\n\\end{pmatrix}\n$$\n\n接下来，我们推导仅沿浦肯野细胞分支 $M \\to G \\to P \\to D$ 传播的净带符号增益。系统动力学由线性时不变方程 $x_{t+1} = A x_{t}$ 给出。信号沿多步路径传播的效果可以通过组合邻接矩阵的作用来找到。\n\n一个在时间 $t=0$ 从苔藓纤维（$M$）开始的信号通过网络传播。\n- 在时间 $t=1$，来自 $M$ 的活动影响 $G$。增益由 $A_{21}$ 给出。\n- 在时间 $t=2$，来自 $G$（其源于 $M$）的活动影响 $P$。这一步的增益是 $A_{32}$。这两步从 $M$ 到 $P$ 的累积增益是 $A_{32} \\times A_{21}$ 的乘积。\n- 在时间 $t=3$，来自 $P$（其源于 $G$，而 $G$ 又源于 $M$）的活动影响 $D$。这最后一步的增益是 $A_{43}$。\n\n沿整个三突触路径 $M \\to G \\to P \\to D$ 的净带符号增益是序列中每一步突触的单个带符号增益的乘积。这对应于在三个时间步后，沿此特定路径，节点 $M$ 处的初始脉冲对节点 $D$ 的影响。在数学上，这是相应矩阵元素的乘积：\n$$ \\text{净增益} = A_{43} \\times A_{32} \\times A_{21} $$\n\n这也可以通过计算矩阵的幂 $A^3$ 来看到。元素 $(A^3)_{ji}$ 给出了从节点 $i$ 到节点 $j$ 经过所有长度为 $3$ 的路径的总增益。在这个特定回路中，从 $M$（节点 $1$）到 $D$（节点 $4$）的唯一长度为 $3$ 的路径是 $M \\to G \\to P \\to D$。因此，净增益恰好是元素 $(A^3)_{41}$。\n\n我们计算增益的乘积：\n$$ \\text{净增益} = (-w_{DP}) \\times (+w_{PG}) \\times (+w_{GM}) $$\n代入给定的数值：\n$$ \\text{净增益} = (-1.2) \\times (0.9) \\times (0.8) $$\n首先，我们计算前两项的乘积：\n$$ (-1.2) \\times (0.9) = -1.08 $$\n然后，我们将此结果乘以第三项：\n$$ -1.08 \\times 0.8 = -0.864 $$\n\n沿路径 $M \\to G \\to P \\to D$ 的净带符号增益是一个无量纲量，表示信号的整体放大或衰减以及反转。负号表示该通路的总体效应是抑制性的，这是由于来自浦肯野细胞的最终抑制性突触所预期的。",
            "answer": "$$\n\\boxed{-0.864}\n$$"
        },
        {
            "introduction": "小脑卓越的运动学习能力被认为源于其突触的可塑性。本练习聚焦于其核心计算理论：一个三因子学习法则，其中由爬行纤维传递的误差信号驱动突触强度的变化 。通过推导突触权重的平均长期变化，您将更深入地理解小脑如何根据表现误差来适应和精细化运动。",
            "id": "4027517",
            "problem": "小脑运动学习的一个经典计算模型使用一个由平行纤维输入驱动的线性 Purkinje 细胞读出机制，以及一个受攀爬纤维复杂锋电位调控的三因子突触可塑性规则。考虑一个由平行纤维输入 $x_{i,t}$ 驱动、具有线性输出 $\\hat{y}_t = \\sum_{i=1}^{N} w_i x_{i,t}$ 的 Purkinje 细胞。攀爬纤维发出一个二元复杂锋电位 $c_t \\in \\{0,1\\}$，它标志着在时间步 $t$ 上存在运动误差。假设如下：\n\n- 权重更新遵循三因子规则 $\\Delta w_i(t) = - \\eta\\, c_t\\, e_{i,t}$，其中 $\\eta  0$ 是学习率，$e_{i,t}$ 是效价迹。\n- 效价迹是突触前活动的线性泄露累积器，$e_{i,t} = \\gamma\\, e_{i,t-1} + x_{i,t}$，其中 $0 \\leq \\gamma  1$。\n- 突触前输入 $x_{i,t}$ 是弱平稳的，具有有限一阶矩和时不变均值 $\\mathbb{E}[x_{i,t}] = \\mu_i$（一阶矩分析无需其他分布假设）。\n- 复杂锋电位 $c_t$ 是一个参数为 $p \\in (0,1)$ 的伯努利随机变量，在时间上独立，且独立于 $x_{i,t}$ 和 $e_{i,t}$。\n- 由于 $|\\gamma|  1$，效价迹的一阶矩存在稳态。\n\n仅使用这些假设以及期望和平稳性的标准定义，推导出每个时间步的稳态期望权重变化 $\\mathbb{E}[\\Delta w_i(t)]$，并将其表示为关于 $\\eta$、$p$、$\\gamma$ 和 $\\mu_i$ 的闭式解析表达式。最终答案必须是单个闭式解析表达式。无需四舍五入，且不涉及物理单位。",
            "solution": "该问题已经过验证，被认为是科学上合理的、适定的、客观且内部一致的。这是理论神经科学中的一个标准推导。因此，我将开始进行解答。\n\n目标是推导每个时间步的稳态期望权重变化，我们将其表示为 $\\mathbb{E}[\\Delta w_i]_{\\text{ss}}$。分析从给定的突触权重更新规则开始。\n\n在时间步 $t$ 时，突触权重 $w_i$ 的变化由三因子规则给出：\n$$\n\\Delta w_i(t) = - \\eta\\, c_t\\, e_{i,t}\n$$\n其中 $\\eta  0$ 是学习率，$c_t \\in \\{0, 1\\}$ 是攀爬纤维信号，$e_{i,t}$ 是第 $i$ 个输入的效价迹。\n\n为求期望权重变化，我们对该方程两边取期望：\n$$\n\\mathbb{E}[\\Delta w_i(t)] = \\mathbb{E}[- \\eta\\, c_t\\, e_{i,t}]\n$$\n根据期望算子的线性性质，常数 $-\\eta$ 可以被提取出来：\n$$\n\\mathbb{E}[\\Delta w_i(t)] = - \\eta\\, \\mathbb{E}[c_t\\, e_{i,t}]\n$$\n问题指出，攀爬纤维信号 $c_t$ 独立于效价迹 $e_{i,t}$。这种独立性使我们能够将乘积的期望分解为期望的乘积：\n$$\n\\mathbb{E}[c_t\\, e_{i,t}] = \\mathbb{E}[c_t]\\, \\mathbb{E}[e_{i,t}]\n$$\n攀爬纤维信号 $c_t$ 是一个参数为 $p \\in (0,1)$ 的伯努利随机变量。伯努利变量的期望等于其参数，因此：\n$$\n\\mathbb{E}[c_t] = p\n$$\n将此结果代回期望权重变化的表达式中，我们得到：\n$$\n\\mathbb{E}[\\Delta w_i(t)] = - \\eta\\, p\\, \\mathbb{E}[e_{i,t}]\n$$\n此表达式给出了在任意时间步 $t$ 的期望权重变化。为求得*稳态*期望权重变化，我们必须首先确定效价迹的稳态期望 $\\mathbb{E}[e_{i,t}]$。\n\n效价迹的动态由线性泄露累积器模型给出：\n$$\ne_{i,t} = \\gamma\\, e_{i,t-1} + x_{i,t}\n$$\n其中 $0 \\le \\gamma  1$ 是衰减因子，$x_{i,t}$ 是突触前输入。\n\n对该方程取期望可得：\n$$\n\\mathbb{E}[e_{i,t}] = \\mathbb{E}[\\gamma\\, e_{i,t-1} + x_{i,t}]\n$$\n再次利用期望的线性性质：\n$$\n\\mathbb{E}[e_{i,t}] = \\gamma\\, \\mathbb{E}[e_{i,t-1}] + \\mathbb{E}[x_{i,t}]\n$$\n我们已知突触前输入 $x_{i,t}$ 是弱平稳的，具有时不变均值 $\\mathbb{E}[x_{i,t}] = \\mu_i$。将此代入方程，可得到效价迹均值的递推关系：\n$$\n\\mathbb{E}[e_{i,t}] = \\gamma\\, \\mathbb{E}[e_{i,t-1}] + \\mu_i\n$$\n问题指出，效价迹的一阶矩存在稳态。在稳态下，过程的统计特性是时不变的。因此，效价迹的期望必须随时间保持恒定。我们可以将稳态期望定义为 $\\mathbb{E}[e_i]_{\\text{ss}}$，使得：\n$$\n\\mathbb{E}[e_i]_{\\text{ss}} = \\mathbb{E}[e_{i,t}] = \\mathbb{E}[e_{i,t-1}]\n$$\n将此代入递推关系中可得：\n$$\n\\mathbb{E}[e_i]_{\\text{ss}} = \\gamma\\, \\mathbb{E}[e_i]_{\\text{ss}} + \\mu_i\n$$\n我们现在求解这个关于 $\\mathbb{E}[e_i]_{\\text{ss}}$ 的代数方程：\n$$\n\\mathbb{E}[e_i]_{\\text{ss}} - \\gamma\\, \\mathbb{E}[e_i]_{\\text{ss}} = \\mu_i\n$$\n$$\n(1 - \\gamma)\\, \\mathbb{E}[e_i]_{\\text{ss}} = \\mu_i\n$$\n由于给定 $0 \\le \\gamma  1$，项 $(1 - \\gamma)$ 严格为正且非零。因此，我们可以用它相除，求得唯一解：\n$$\n\\mathbb{E}[e_i]_{\\text{ss}} = \\frac{\\mu_i}{1 - \\gamma}\n$$\n此表达式代表效价迹的稳态均值。它是时间平均的突触前输入 $\\mu_i$ 乘以因子 $1/(1-\\gamma)$，该因子对应于泄露积分器的直流增益。\n\n最后，我们将此稳态值代回到期望权重变化的表达式中。因此，稳态期望权重变化 $\\mathbb{E}[\\Delta w_i]_{\\text{ss}}$ 为：\n$$\n\\mathbb{E}[\\Delta w_i]_{\\text{ss}} = - \\eta\\, p\\, \\mathbb{E}[e_i]_{\\text{ss}} = - \\eta\\, p\\, \\left(\\frac{\\mu_i}{1 - \\gamma}\\right)\n$$\n这就得出了以给定参数 $\\eta$、$p$、$\\gamma$ 和 $\\mu_i$ 表示的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{-\\frac{\\eta p \\mu_i}{1 - \\gamma}}\n$$"
        },
        {
            "introduction": "这最后一个练习将细胞层面的学习规则与小脑在控制运动中的系统级功能联系起来。您将把小脑建模为一个自适应滤波器，它通过组合各种与运动相关的信号（基函数）来学习产生期望的力矩曲线 。本练习要求您在有和没有生物学约束的条件下计算最优突触权重，揭示神经计算原理如何被诸如突触权重非负性等生理现实所塑造。",
            "id": "4027515",
            "problem": "您正在将小脑在运动学习期间执行的转换建模为一个监督函数逼近问题，该问题从运动学基函数映射到一个期望的力矩轨迹。假设在一个持续时间为1秒的区间内，有 $m$ 个基函数 $\\{ \\phi_i(t) \\}_{i=1}^m$ 在 $n$ 个时间点 $\\{ t_k \\}_{k=1}^n$ 上进行采样。定义设计矩阵 $X \\in \\mathbb{R}^{n \\times m}$ 为 $X_{k,i} = \\phi_i(t_k)$，目标力矩向量 $y \\in \\mathbb{R}^n$ 为 $y_k = y(t_k)$，其中 $y(t)$ 是期望的力矩剖面。力矩的物理单位是牛顿米 (N·m)，三角函数中使用的所有角度都以弧度为单位。建模的小脑输出为 $\\hat{y}(t) = \\sum_{i=1}^m w_i \\phi_i(t)$，其中 $w \\in \\mathbb{R}^m$ 代表突触权重。\n\n从最小二乘估计的第一性原理出发，无约束最优权重 $w^{*}$ 最小化经验均方误差\n$$\nJ(w) = \\frac{1}{n} \\sum_{k=1}^n \\left( \\sum_{i=1}^m w_i \\phi_i(t_k) - y(t_k) \\right)^2,\n$$\n且 $w$ 不受任何约束。生物学上的突触约束，如非负性，要求对所有 $i \\in \\{1,\\dots,m\\}$ 都有 $w_i \\ge 0$，这将优化问题变为一个非负最小二乘问题。\n\n您的任务是：\n- 通过最小化 $J(w)$ 计算无约束最优权重 $w^{*}$。\n- 在 $w_i \\ge 0$（对所有 $i$）的约束下计算有约束最优权重 $\\tilde{w}$。\n- 量化非负性约束对拟合质量和权重的影响。\n\n使用以下测试套件。在所有测试中，使用 $n = 100$ 个样本，时间点为 $t_k = \\frac{k-1}{n-1}$ 秒（$k \\in \\{1,\\dots,n\\}$），并使用高斯基函数\n$$\n\\phi_i(t) = \\exp\\left( - \\frac{(t - c_i)^2}{2\\sigma^2} \\right),\n$$\n这些函数是无量纲的。对于每个案例，$X_{k,i} = \\phi_i(t_k)$ 且 $y_k = y(t_k)$，其中 $y(t)$ 根据每个案例指定。\n\n- 测试案例 1（理想路径，良态，正值目标）：\n  - $m = 3$\n  - 中心 $c = [0.2, 0.5, 0.8]$ (秒)\n  - $\\sigma = 0.08$ (秒)\n  - 期望力矩 $y(t) = 1.5 \\sin^2(2\\pi t)$，单位 N·m。\n- 测试案例 2（边界情况，近乎共线的基函数，窄目标）：\n  - $m = 3$\n  - 中心 $c = [0.45, 0.5, 0.55]$ (秒)\n  - $\\sigma = 0.03$ (秒)\n  - 期望力矩 $y(t) = \\exp\\left( - \\frac{(t - 0.5)^2}{2 \\cdot 0.02^2} \\right)$，单位 N·m。\n- 测试案例 3（边缘情况，符号变化的目标与正值基函数）：\n  - $m = 3$\n  - 中心 $c = [0.25, 0.5, 0.75]$ (秒)\n  - $\\sigma = 0.06$ (秒)\n  - 期望力矩 $y(t) = 0.8 \\sin(2\\pi t)$，单位 N·m。\n\n对每个测试案例，计算并返回：\n- 无约束解的均方根误差 $RMSE_{\\text{uncon}} = \\sqrt{ \\frac{1}{n} \\sum_{k=1}^n ( (Xw^{*})_k - y_k )^2 }$，单位为 N·m。\n- 非负解的均方根误差 $RMSE_{\\text{nn}} = \\sqrt{ \\frac{1}{n} \\sum_{k=1}^n ( (X\\tilde{w})_k - y_k )^2 }$，单位为 N·m。\n- 一个布尔值，指示无约束解是否含有任何负权重，即是否存在 $i$ 使得 $w^{*}_i  0$。\n- 欧几里得范数差 $\\| w^{*} - \\tilde{w} \\|_2$（无量纲）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的各案例结果列表。每个案例的结果本身也是一个列表，顺序为 $[RMSE_{\\text{uncon}}, RMSE_{\\text{nn}}, \\text{has\\_neg}, \\| w^{*} - \\tilde{w} \\|_2]$。例如，输出格式为 $[[r_1,s_1,b_1,d_1],[r_2,s_2,b_2,d_2],[r_3,s_3,b_3,d_3]]$，其中 $r_i$、$s_i$ 和 $d_i$ 是浮点数，单位分别为 N·m（对于 $r_i$ 和 $s_i$）和无量纲（对于 $d_i$），而 $b_i$ 是一个布尔值。无需四舍五入；报告标准浮点计算产生的原始数值。",
            "solution": "该问题要求我们将小脑运动学习任务建模为一个函数逼近问题。我们需要为基函数的线性组合 $\\hat{y}(t) = \\sum_{i=1}^m w_i \\phi_i(t)$ 找到最优权重 $w$，以逼近目标力矩轨迹 $y(t)$。我们将在两种条件下解决此问题：第一，对权重 $w_i$ 没有约束；第二，施加 $w_i \\ge 0$ 的生物学非负性约束。\n\n首先，我们将问题形式化。该模型在 $n$ 个离散时间点 $t_k$ 进行评估。权重 $w$、基函数 $\\phi_i$ 和预测力矩 $\\hat{y}$ 之间的关系可以用矩阵形式表示为 $\\hat{y} = Xw$。其中，$\\hat{y} \\in \\mathbb{R}^n$ 是预测力矩向量，$w \\in \\mathbb{R}^m$ 是突触权重向量，$X \\in \\mathbb{R}^{n \\times m}$ 是设计矩阵，其元素为 $X_{k,i} = \\phi_i(t_k)$。基函数为高斯函数：\n$$\n\\phi_i(t) = \\exp\\left( - \\frac{(t - c_i)^2}{2\\sigma^2} \\right)\n$$\n其中 $c_i$ 是中心，$\\sigma$ 是宽度。时间点在区间 $[0, 1]$ 上均匀采样，即 $t_k = \\frac{k-1}{n-1}$，$k \\in \\{1,\\dots,n\\}$，$n=100$。\n\n目标是找到权重 $w$，以最小化预测力矩 $\\hat{y}$ 与目标力矩向量 $y \\in \\mathbb{R}^n$ 之间的差异。该误差通过均方误差 (MSE) 进行量化，$J(w) = \\frac{1}{n} \\|Xw - y\\|_2^2$。\n\n**1. 无约束最优权重 ($w^{*}$)**\n\n第一个任务是找到最小化 $J(w)$ 的无约束权重 $w^*$。这是一个标准的普通最小二乘 (OLS) 问题。为找到最小值，我们将代价函数关于 $w$ 的梯度设为零：\n$$\n\\nabla_w J(w) = \\nabla_w \\left( \\frac{1}{n} (Xw - y)^T(Xw - y) \\right) = \\frac{2}{n} X^T(Xw - y) = 0\n$$\n这导出了正规方程：\n$$\nX^T X w = X^T y\n$$\n假设 $X^T X$ 是可逆的（对于给定的测试案例成立，因为基函数是线性无关的），则唯一解 $w^*$ 为：\n$$\nw^* = (X^T X)^{-1} X^T y\n$$\n矩阵 $(X^T X)^{-1} X^T$ 是 $X$ 的 Moore-Penrose 伪逆，记为 $X^+$。在数值计算上，使用基于奇异值分解 (SVD) 或 QR 分解的方法来求解这个方程组，比直接对 $X^T X$ 求逆更稳定。我们将为此使用一个标准的数值线性代数库函数，例如 `numpy.linalg.lstsq`。\n\n**2. 有约束最优权重 ($\\tilde{w}$)**\n\n第二个任务引入了突触权重不能为负的生物学约束，即对所有 $i \\in \\{1, \\dots, m\\}$ 都有 $w_i \\ge 0$。问题变为一个非负最小二乘 (NNLS) 优化问题：\n$$\n\\text{minimize} \\quad \\|Xw - y\\|_2^2 \\\\\n\\text{subject to} \\quad w \\ge 0\n$$\n这是一个凸优化问题，保证了存在唯一的全局最小值。它不能通过简单的闭式正规方程求解。相反，需要采用迭代算法，如激活集方法。我们将使用实现了这类算法的 `scipy.optimize.nnls`。\n\n**3. 约束效果的量化**\n\n为评估非负性约束的影响，我们将为每个测试案例计算四个指标：\n\n- **无约束均方根误差 ($RMSE_{\\text{uncon}}$)**：这衡量了无约束解的拟合优度。\n  $$\n  RMSE_{\\text{uncon}} = \\sqrt{J(w^*)} = \\sqrt{\\frac{1}{n} \\|Xw^* - y\\|_2^2}\n  $$\n- **非负均方根误差 ($RMSE_{\\text{nn}}$)**：这衡量了有约束解的拟合优度。\n  $$\n  RMSE_{\\text{nn}} = \\sqrt{J(\\tilde{w})} = \\sqrt{\\frac{1}{n} \\|X\\tilde{w} - y\\|_2^2}\n  $$\n  根据定义，由于无约束解是在一个更大的集合（整个 $\\mathbb{R}^m$）上最小化误差，我们必然有 $RMSE_{\\text{uncon}} \\le RMSE_{\\text{nn}}$。\n\n- **负权重的存在**：一个布尔标志，$\\exists i : w_i^*  0$，指示无约束解 $w^*$ 是否会违反非负性约束。如果为假，那么 $w^*$ 本身就是 NNLS 问题的一个有效解，这意味着 $w^* = \\tilde{w}$ 且 $RMSE_{\\text{uncon}} = RMSE_{\\text{nn}}$。\n\n- **权重向量差异**：两个权重向量之差的欧几里得范数 $\\| w^{*} - \\tilde{w} \\|_2$。它量化了为了满足约束条件，权重向量必须改变多少。该值为无量纲，因为基函数 $\\phi_i(t)$ 是无量纲的，而目标 $y(t)$ 的单位是 N·m，因此权重 $w_i$ 的单位必须是 N·m。等等，让我们重新检查一下单位。$y = \\sum w_i \\phi_i$。如果 $y$ 的单位是 N·m 且 $\\phi_i$ 是无量纲的，那么 $w_i$ 的单位必须是 N·m。一个由单位为 N·m 的量组成的向量的范数，其单位也应为 N·m。问题中关于该范数是无量纲的断言是一个缺陷。然而，由于要求是*计算*该值，并且数值本身与单位无关，我们将继续进行计算。为了本次练习的目的，我们将遵循提示，报告一个无量纲的数字，同时承认这种物理上的不一致性。\n\n**计算策略**\n\n对于每个测试案例，我们将执行以下步骤：\n1.  定义参数 $m$、$c_i$、$\\sigma$ 和目标函数 $y(t)$。\n2.  生成一个从0到1包含 $n=100$ 个点的时间向量 $t$。\n3.  构建 $n \\times m$ 的设计矩阵 $X$，其中 $X_{k,i} = \\phi_i(t_k)$。\n4.  构建 $n \\times 1$ 的目标向量 $y$，其中 $y_k = y(t_k)$。\n5.  使用 `numpy.linalg.lstsq(X, y)` 求解无约束权重 $w^*$。\n6.  使用 `scipy.optimize.nnls(X, y)` 求解非负权重 $\\tilde{w}$。\n7.  使用计算出的权重 $w^*$ 和 $\\tilde{w}$ 以及数据 $X$ 和 $y$ 来计算所需的四个指标。\n8.  存储结果以供最终格式化输出。\n\n此过程将应用于所有三个测试案例，以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Main function to solve the cerebellar learning problem for all test cases.\n    \"\"\"\n\n    def compute_for_case(m, c_centers, sigma, y_func_str):\n        \"\"\"\n        Computes the required metrics for a single test case.\n\n        Args:\n            m (int): Number of basis functions.\n            c_centers (list): List of centers for the Gaussian basis functions.\n            sigma (float): Width of the Gaussian basis functions.\n            y_func_str (str): A string lambda expression for the target torque y(t).\n\n        Returns:\n            list: A list containing [RMSE_uncon, RMSE_nn, has_neg, norm_diff].\n        \"\"\"\n        n = 100\n        t = np.linspace(0, 1, n)\n\n        # Create design matrix X\n        # X_{k,i} = phi_i(t_k)\n        # Use broadcasting to efficiently compute the matrix\n        # t is (n, 1), c_centers is (1, m)\n        # The result of (t[:, np.newaxis] - c_centers) is an (n, m) matrix\n        c_centers_np = np.array(c_centers)\n        X = np.exp(-(t[:, np.newaxis] - c_centers_np[np.newaxis, :])**2 / (2 * sigma**2))\n\n        # Create target vector y\n        # The lambda function is created using eval for dynamic function definition.\n        # This is safe in this context as the strings are defined internally.\n        y_func = eval(y_func_str)\n        y = y_func(t)\n\n        # 1. Unconstrained solution (Ordinary Least Squares)\n        w_star, residuals_star, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # 2. Constrained solution (Non-Negative Least Squares)\n        w_tilde, _ = nnls(X, y)\n\n        # 3. Compute metrics\n        # RMSE for unconstrained solution\n        y_hat_star = X @ w_star\n        rmse_uncon = np.sqrt(np.mean((y_hat_star - y)**2))\n\n        # RMSE for non-negative solution\n        y_hat_tilde = X @ w_tilde\n        rmse_nn = np.sqrt(np.mean((y_hat_tilde - y)**2))\n\n        # Check if unconstrained solution has negative weights\n        has_neg = np.any(w_star  0)\n\n        # Euclidean norm difference between weight vectors\n        norm_diff = np.linalg.norm(w_star - w_tilde)\n\n        return [rmse_uncon, rmse_nn, bool(has_neg), norm_diff]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: m, centers, sigma, y(t)\n        (3, [0.2, 0.5, 0.8], 0.08, 'lambda t: 1.5 * np.sin(2 * np.pi * t)**2'),\n        # Case 2: m, centers, sigma, y(t)\n        (3, [0.45, 0.5, 0.55], 0.03, 'lambda t: np.exp(-(t - 0.5)**2 / (2 * 0.02**2))'),\n        # Case 3: m, centers, sigma, y(t)\n        (3, [0.25, 0.5, 0.75], 0.06, 'lambda t: 0.8 * np.sin(2 * np.pi * t)')\n    ]\n\n    results = []\n    for case in test_cases:\n        m_val, c_val, sigma_val, y_str = case\n        result = compute_for_case(m_val, c_val, sigma_val, y_str)\n        results.append(result)\n\n    # Format the final output as a string representation of a list of lists.\n    # The str() on each inner list will create a bracketed representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}