{
    "hands_on_practices": [
        {
            "introduction": "将广义线性模型（GLM）应用于神经脉冲序列分析时，一个关键步骤是将理论上的连续时间模型转化为可计算的离散时间形式。本练习将指导您完成这一核心过程，展示如何通过离散化卷积积分来构建设计矩阵。掌握这一技能对于理解模型如何从数学概念转变为实际的数据分析工具至关重要。",
            "id": "3983850",
            "problem": "考虑一个用于连续时间上神经元发放序列的单神经元点过程广义线性模型（GLM；Generalized Linear Model），其中时间 $t$ 的条件强度（conditional intensity）依赖于一个经过滤波的外源性刺激 $s(t)$，其形式为一个因果时间核 $g(\\tau)$ 的线性泛函，因此线性预测器（linear predictor）包含项 $\\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$，其中对于 $\\tau \\notin [0, T_b]$ 有 $g(\\tau) = 0$。假设核 $g(\\tau)$ 通过基展开进行参数化：$g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$，其中 $\\{b_j(\\tau)\\}_{j=1}^{p}$ 是支撑集在 $[0, T_b]$ 上的固定因果基函数，而 $\\{\\theta_j\\}_{j=1}^{p}$ 是待估计的未知系数。因此，与刺激相关的对线性预测器的贡献可以写成 $\\sum_{j=1}^{p} \\theta_j\\, (b_j * s)(t)$，其中 $(b_j * s)(t) \\equiv \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau$。\n\n你使用均匀的时间窗宽度 $\\Delta t  0$ 对时间进行离散化，并在网格 $t_n = n\\, \\Delta t$（$n = 1,2,\\dots,N$）上对所有信号进行采样。为整数延迟 $\\ell \\in \\{0,1,\\dots,L-1\\}$ 定义离散序列 $s[n] \\equiv s(n\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$，其中 $L \\equiv \\lfloor T_b / \\Delta t \\rfloor + 1$，并且当 $s[n]$ 的参数超出观测窗口时，取 $s[n] = 0$。使用黎曼和（Riemann-sum）进行离散化，并显式地保留 $\\Delta t$，不要将 $\\Delta t$ 吸收到基函数或参数中。\n\n你的任务是：\n1. 从连续时间卷积的定义和 $g(\\tau)$ 的基展开出发，展示离散时间近似如何得到一个与刺激相关的预测器的矩阵-向量乘积表示 $(X \\boldsymbol{\\theta})[n]$，其中设计矩阵 $X \\in \\mathbb{R}^{N \\times p}$，其第 $(n,j)$ 个元素 $X_{n,j}$ 依赖于离散时间刺激历史 $\\{s[n-\\ell]\\}_{\\ell=0}^{L-1}$ 和基函数样本 $\\{b_j[\\ell]\\}_{\\ell=0}^{L-1}$。\n2. 在上述因果支撑集和零填充假设下，用 $\\Delta t$、$\\{b_j[\\ell]\\}$ 和 $\\{s[n-\\ell]\\}$ 提供设计矩阵元素 $X_{n,j}$ 的闭式解析表达式。\n\n答案格式要求：提供 $X_{n,j}$ 的单个闭式解析表达式作为最终答案。不需要进行数值舍入。最终表达式中不需要物理单位。",
            "solution": "问题陈述的解析和验证如下。\n\n### 步骤1：提取已知条件\n- **模型：** 连续时间上的单神经元点过程广义线性模型（GLM）。\n- **刺激滤波项：** 与刺激相关的对线性预测器的贡献由卷积积分 $u(t) = \\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$ 给出。\n- **核的性质：** 时间核 $g(\\tau)$ 是因果的，其支撑集在区间 $[0, T_b]$ 上，即对于 $\\tau \\notin [0, T_b]$ 有 $g(\\tau) = 0$。\n- **核的参数化：** 核在一组包含 $p$ 个固定函数 $\\{b_j(\\tau)\\}_{j=1}^{p}$ 的基上展开：$g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$。基函数 $b_j(\\tau)$ 也是因果的，且支撑集在 $[0, T_b]$ 上。系数 $\\{\\theta_j\\}_{j=1}^{p}$ 是待估计的参数。\n- **预测器形式：** 刺激的贡献可以重写为基分量的和：$\\sum_{j=1}^{p} \\theta_j\\, (b_j * s)(t)$，其中 $(b_j * s)(t) \\equiv \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau$。\n- **时间离散化：** 使用均匀的时间窗宽度 $\\Delta t  0$ 对时间进行离散化，得到时间网格 $t_n = n\\, \\Delta t$，其中 $n = 1, 2, \\dots, N$。\n- **信号离散化：** 在此网格上对连续信号进行采样：$s[n] \\equiv s(n\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$，其中整数延迟指数 $\\ell \\in \\{0, 1, \\dots, L-1\\}$。\n- **延迟定义：** 最大延迟步数由核的支撑时长 $T_b$ 和时间步长 $\\Delta t$ 导出：$L \\equiv \\lfloor T_b / \\Delta t \\rfloor + 1$。\n- **边界条件：** 假设刺激信号是零填充的：如果其时间指数落在观测窗口之外，则 $s[n] = 0$。\n- **近似方法：** 连续时间积分将通过黎曼和进行近似，并显式地保留因子 $\\Delta t$。\n- **任务：** 在离散时间线性预测器表示 $(X \\boldsymbol{\\theta})[n]$ 中，推导设计矩阵 $X$ 的第 $(n,j)$ 个元素 $X_{n,j}$ 的表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题坚实地植根于计算神经科学和统计信号处理领域。使用带有基函数展开的GLM来模拟神经元发放是一种标准且成熟的技术（例如，Pillow et al., 2008）。该公式在科学上是合理的。\n- **适定性：** 该问题是适定的。它要求在指定的离散化方案下，从一个连续积分公式推导出一个离散代数表示。指令清晰，并且预期有一个唯一的答案。\n- **客观性：** 问题陈述使用精确的数学语言表达，没有任何主观或模棱两可的术语。\n- **缺陷分析：**\n    1.  **科学/事实不健全：** 无。该模型是现代神经数据分析的基石。\n    2.  **不可形式化/不相关：** 无。该问题是形式化的，并且与脉冲序列的GLM实现直接相关。\n    3.  **不完整/矛盾的设置：** 无。所有必要的组成部分——积分形式、基展开、离散化规则（黎曼和）以及离散信号的定义——都已提供。\n    4.  **不切实际/不可行：** 无。这是将此类模型拟合到数据的标准程序。\n    5.  **不适定/结构不良：** 无。该任务是一个直接的数学推导。\n    6.  **伪深刻/琐碎：** 无。该推导是理解和实现这些模型的基础步骤。\n    7.  **超出科学可验证性：** 无。该推导遵循标准的数学验证。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供完整的解决方案。\n\n***\n\n### 求解推导\n\n目标是找到GLM线性预测器中依赖于刺激部分在离散时间公式下的设计矩阵 $X$ 的元素 $X_{n,j}$ 的表达式。\n\n我们从线性预测器在时间 $t$ 的刺激滤波分量的连续时间表达式开始：\n$$u(t) = \\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$$\n滤波器核 $g(\\tau)$ 通过基函数 $b_j(\\tau)$ 的线性组合进行参数化：\n$$g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$$\n将此展开式代入积分中得到：\n$$u(t) = \\int_{0}^{T_b} \\left( \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau) \\right) s(t-\\tau)\\, d\\tau$$\n由于求和是有限的且积分收敛，我们可以交换求和与积分的顺序：\n$$u(t) = \\sum_{j=1}^{p} \\theta_j \\left( \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau \\right)$$\n这个表达式给出了连续时间预测器。为了获得离散时间版本，我们在离散时间点 $t_n = n\\, \\Delta t$ 处计算 $u(t)$：\n$$u(t_n) \\equiv u[n] = \\sum_{j=1}^{p} \\theta_j \\left( \\int_{0}^{T_b} b_j(\\tau)\\, s(t_n - \\tau)\\, d\\tau \\right)$$\n下一步是离散化积分项。问题指定了使用黎曼和近似。我们将第 $j$ 个基函数的积分表示为 $I_j[n]$：\n$$I_j[n] = \\int_{0}^{T_b} b_j(\\tau)\\, s(t_n - \\tau)\\, d\\tau$$\n我们使用一个和来近似这个积分。我们将积分区间 $[0, T_b]$ 划分为宽度为 $\\Delta t$ 的子区间。积分变量 $\\tau$ 被离散化为 $\\tau_\\ell = \\ell\\, \\Delta t$，微分元 $d\\tau$ 近似为 $\\Delta t$。求和将针对离散延迟指数 $\\ell$ 进行。问题为 $\\ell \\in \\{0, 1, \\dots, L-1\\}$ 定义了离散基函数 $b_j[\\ell]$，其中 $L = \\lfloor T_b / \\Delta t \\rfloor + 1$。这个 $\\ell$ 的范围覆盖了核的支撑集。在这里，左黎曼和是合适的，它在每个区间的起点计算被积函数的值：\n$$I_j[n] \\approx \\sum_{\\ell=0}^{L-1} \\left[ b_j(\\ell\\, \\Delta t)\\, s(t_n - \\ell\\, \\Delta t) \\right] \\Delta t$$\n请注意，求和上限 $L-1 = \\lfloor T_b / \\Delta t \\rfloor$ 确保了参数 $\\ell \\Delta t$ 保持在支撑集 $[0, T_b]$ 内部或其边界上。\n\n现在，我们代入离散时间信号的定义 $s[k] \\equiv s(k\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$：\n- $b_j(\\ell\\, \\Delta t) = b_j[\\ell]$\n- $s(t_n - \\ell\\, \\Delta t) = s((n-\\ell)\\Delta t) = s[n-\\ell]$\n\n将这些代入和中，得到第 $j$ 个基分量的卷积的离散近似：\n$$I_j[n] \\approx \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]$$\n这个表达式表示在离散时间 $n$ 处，通过第 $j$ 个基函数滤波后的刺激。\n\n我们现在可以将其代回到离散预测器 $u[n]$ 的表达式中：\n$$u[n] \\approx \\sum_{j=1}^{p} \\theta_j \\left( \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell] \\right)$$\n问题要求将其表示为矩阵-向量乘积的形式，$(X \\boldsymbol{\\theta})[n]$，其中 $\\boldsymbol{\\theta} = [\\theta_1, \\theta_2, \\dots, \\theta_p]^T$ 是参数的列向量。该乘积的第 $n$ 个元素由设计矩阵 $X$ 的第 $n$ 行与向量 $\\boldsymbol{\\theta}$ 的点积给出：\n$$(X \\boldsymbol{\\theta})[n] = \\sum_{j=1}^{p} X_{n,j}\\, \\theta_j$$\n通过将此目标形式与我们推导出的 $u[n]$ 表达式进行比较，我们可以识别出乘以每个 $\\theta_j$ 的项。\n$$u[n] = \\sum_{j=1}^{p} \\underbrace{\\left( \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell] \\right)}_{X_{n,j}} \\theta_j$$\n通过直接检视，设计矩阵 $X$ 的第 $(n,j)$ 个元素因此是：\n$$X_{n,j} = \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]$$\n这是设计矩阵元素的闭式表达式。矩阵 $X$ 的每一列 $j$ 对应于刺激 $s$ 与第 $j$ 个基函数 $b_j$ 的卷积，而每一行 $n$ 对应于一个离散时间点。",
            "answer": "$$\\boxed{\\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]}$$"
        },
        {
            "introduction": "建立模型后，一个核心的科学问题是：模型的各个组成部分是否都是必要的？本练习将演示如何使用似然比检验来比较包含脉冲历史滤波器的完整模型与不包含该滤波器的简化模型。这种方法是建立简约且可解释模型、并就驱动神经元发放的因素得出有原则的科学推断的基础。",
            "id": "3983854",
            "problem": "考虑在区间 $\\left[0, T\\right]$ 上观测到的单个神经元，其产生的脉冲序列由计数过程 $\\{N(t): t \\in \\left[0, T\\right]\\}$ 表示，跳跃时间为 $\\{t_i\\}_{i=1}^{n}$，其中 $n = N(T)$。令 $\\mathcal{H}_t$ 表示截至时间 $t$ 的过程历史。假设点过程服从一个广义线性模型 (GLM)，其条件强度函数 $\\lambda(t \\mid \\mathcal{H}_t)$ 的对数连接形式为\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp\\!\\Big( \\alpha + x(t)^{\\top} \\beta + \\int_{0}^{\\infty} h(\\tau)\\, \\mathrm{d}N(t-\\tau) \\Big),\n$$\n其中 $x(t) \\in \\mathbb{R}^{p}$ 是一个已知的协变量过程，$\\beta \\in \\mathbb{R}^{p}$ 和 $\\alpha \\in \\mathbb{R}$ 是未知的滋扰参数，$h(\\tau)$ 是一个用于模拟脉冲历史效应的未知历史滤波器。假设历史滤波器通过一个已知的基 $\\{b_k(\\tau)\\}_{k=1}^{K}$ 进行参数化，形式为 $h(\\tau) = \\sum_{k=1}^{K} w_k\\, b_k(\\tau)$，其中 $w \\in \\mathbb{R}^{K}$。定义相应的滤波后的历史协变量 $s_k(t) \\equiv \\int_{0}^{\\infty} b_k(\\tau)\\, \\mathrm{d}N(t-\\tau)$，并令自然参数为 $\\eta(t) \\equiv \\alpha + x(t)^{\\top} \\beta + \\sum_{k=1}^{K} w_k\\, s_k(t)$，因此 $\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\eta(t))$。\n\n你需要构建一个似然比检验，以检验历史滤波器的存在性。从基本原理出发，首先从条件强度的定义和简单点过程的一般似然函数开始。不要假设参数有任何闭式估计量。清晰地定义零假设 $H_0$ 和备择假设 $H_1$，并用脉冲时间 $\\{t_i\\}_{i=1}^{n}$ 和条件强度的积分来表示似然函数。然后，在适用于威尔克斯定理的标准正则性条件下，推导似然比检验统计量，并用完整模型和简化模型下拟合的自然参数明确地写出其表达式。\n\n你的最终答案必须是似然比检验统计量的一个单一闭式解析表达式，用在其各自最大似然估计处求值的 $\\{\\eta_{\\text{full}}(t), \\eta_{\\text{red}}(t)\\}$ 来表示；最终答案中不要包含其抽样分布。不需要进行数值计算。如果引入任何额外的符号，请明确定义。答案没有单位，也无需四舍五入。",
            "solution": "本任务是为一个点过程的广义线性模型 (GLM) 推导用于检验历史滤波器存在性的似然比检验统计量。我们从简单点过程似然函数的基本定义开始。\n\n设在区间 $\\left[0, T\\right]$ 上观测到的脉冲序列由计数过程 $N(t)$ 表示，其脉冲时间为 $\\{t_i\\}_{i=1}^{n}$，总脉冲数为 $n = N(T)$。对于一个由条件强度函数 $\\lambda(t \\mid \\mathcal{H}_t)$ 控制的点过程，其中 $\\mathcal{H}_t$ 是截至时间 $t$ 的历史，观测到脉冲序列 $\\{t_i\\}_{i=1}^{n}$ 的似然函数由下式给出：\n$$\nL = \\left( \\prod_{i=1}^{n} \\lambda(t_i \\mid \\mathcal{H}_{t_i}) \\right) \\exp\\left( -\\int_{0}^{T} \\lambda(t \\mid \\mathcal{H}_t) \\, \\mathrm{d}t \\right)\n$$\n因此，对数似然函数（记为 $\\mathcal{L}L$）为：\n$$\n\\mathcal{L}L = \\sum_{i=1}^{n} \\ln \\lambda(t_i \\mid \\mathcal{H}_{t_i}) - \\int_{0}^{T} \\lambda(t \\mid \\mathcal{H}_t) \\, \\mathrm{d}t\n$$\n在指定的 GLM 背景下，条件强度通过对数连接函数与自然参数 $\\eta(t)$ 相关联：$\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\eta(t))$。将此代入对数似然表达式中，得到：\n$$\n\\mathcal{L}L = \\sum_{i=1}^{n} \\eta(t_i) - \\int_{0}^{T} \\exp(\\eta(t)) \\, \\mathrm{d}t\n$$\n问题要求对历史滤波器 $h(\\tau)$ 的存在性进行似然比检验。该滤波器被参数化为 $h(\\tau) = \\sum_{k=1}^{K} w_k\\, b_k(\\tau)$。滤波器的存在与否由权重向量 $w = (w_1, \\dots, w_K)^{\\top}$ 决定。我们可以根据这些权重来构建零假设和备择假设。\n\n零假设 $H_0$ 对应于历史滤波器不存在的情况。这等价于所有权重均为零。\n$$\nH_0: w = 0\n$$\n备择假设 $H_1$ 对应于历史滤波器存在的情况，即至少有一个权重不为零。\n$$\nH_1: w \\neq 0\n$$\n这些假设定义了两个嵌套模型：$H_0$ 下的简化模型和 $H_1$ 下的完整模型。\n\n对应于 $H_1$ 的完整模型包括所有参数：一个截距项 $\\alpha$，一个协变量参数向量 $\\beta \\in \\mathbb{R}^{p}$，以及历史滤波器权重 $w \\in \\mathbb{R}^{K}$。总参数集为 $\\theta_{\\text{full}} = (\\alpha, \\beta^{\\top}, w^{\\top})^{\\top}$。完整模型的自然参数为：\n$$\n\\eta_{\\text{full}}(t; \\theta_{\\text{full}}) = \\alpha + x(t)^{\\top} \\beta + \\sum_{k=1}^{K} w_k s_k(t)\n$$\n其中 $s_k(t) = \\int_{0}^{\\infty} b_k(\\tau)\\, \\mathrm{d}N(t-\\tau)$。完整模型的对数似然函数为：\n$$\n\\mathcal{L}L_{\\text{full}}(\\theta_{\\text{full}}) = \\sum_{i=1}^{n} \\eta_{\\text{full}}(t_i; \\theta_{\\text{full}}) - \\int_0^T \\exp(\\eta_{\\text{full}}(t; \\theta_{\\text{full}})) \\, \\mathrm{d}t\n$$\n\n对应于 $H_0$ 的简化模型是完整模型在约束 $w=0$ 下的一个特例。其参数集为 $\\theta_{\\text{red}} = (\\alpha, \\beta^{\\top})^{\\top}$。简化模型的自然参数为：\n$$\n\\eta_{\\text{red}}(t; \\theta_{\\text{red}}) = \\alpha + x(t)^{\\top} \\beta\n$$\n简化模型的对数似然函数为：\n$$\n\\mathcal{L}L_{\\text{red}}(\\theta_{\\text{red}}) = \\sum_{i=1}^{n} \\eta_{\\text{red}}(t_i; \\theta_{\\text{red}}) - \\int_0^T \\exp(\\eta_{\\text{red}}(t; \\theta_{\\text{red}})) \\, \\mathrm{d}t\n$$\n似然比检验统计量 $D$ 定义为在 $H_0$ 和 $H_1$ 下最大化的似然函数之比的对数的 $-2$ 倍。\n$$\nD = -2 \\ln \\frac{\\sup_{\\theta \\in H_0} L(\\theta)}{\\sup_{\\theta \\in H_1} L(\\theta)} = -2 \\ln \\frac{L(\\hat{\\theta}_{\\text{red}})}{L(\\hat{\\theta}_{\\text{full}})}\n$$\n其中 $\\hat{\\theta}_{\\text{red}}$ 和 $\\hat{\\theta}_{\\text{full}}$ 分别是简化模型和完整模型下参数的最大似然估计 (MLE)。用对数似然函数表示，这可以写成：\n$$\nD = 2 \\left( \\mathcal{L}L(\\hat{\\theta}_{\\text{full}}) - \\mathcal{L}L(\\hat{\\theta}_{\\text{red}}) \\right)\n$$\n我们来定义拟合的自然参数。令 $\\hat{\\eta}_{\\text{full}}(t) = \\eta_{\\text{full}}(t; \\hat{\\theta}_{\\text{full}})$ 为完整模型在其最大似然估计处求值的自然参数。类似地，令 $\\hat{\\eta}_{\\text{red}}(t) = \\eta_{\\text{red}}(t; \\hat{\\theta}_{\\text{red}})$ 为简化模型在其最大似然估计处求值的自然参数。最大化的对数似然函数可以写作：\n$$\n\\mathcal{L}L_{\\text{full}}(\\hat{\\theta}_{\\text{full}}) = \\sum_{i=1}^{n} \\hat{\\eta}_{\\text{full}}(t_i) - \\int_0^T \\exp(\\hat{\\eta}_{\\text{full}}(t)) \\, \\mathrm{d}t\n$$\n$$\n\\mathcal{L}L_{\\text{red}}(\\hat{\\theta}_{\\text{red}}) = \\sum_{i=1}^{n} \\hat{\\eta}_{\\text{red}}(t_i) - \\int_0^T \\exp(\\hat{\\eta}_{\\text{red}}(t)) \\, \\mathrm{d}t\n$$\n将这些表达式代入 $D$ 的公式中，我们得到：\n$$\nD = 2 \\left( \\left[ \\sum_{i=1}^{n} \\hat{\\eta}_{\\text{full}}(t_i) - \\int_0^T \\exp(\\hat{\\eta}_{\\text{full}}(t)) \\, \\mathrm{d}t \\right] - \\left[ \\sum_{i=1}^{n} \\hat{\\eta}_{\\text{red}}(t_i) - \\int_0^T \\exp(\\hat{\\eta}_{\\text{red}}(t)) \\, \\mathrm{d}t \\right] \\right)\n$$\n通过对求和项和积分项进行分组，重新整理各项，得到似然比检验统计量的最终表达式：\n$$\nD = 2 \\left( \\sum_{i=1}^{n} \\left( \\hat{\\eta}_{\\text{full}}(t_i) - \\hat{\\eta}_{\\text{red}}(t_i) \\right) - \\int_0^T \\left( \\exp(\\hat{\\eta}_{\\text{full}}(t)) - \\exp(\\hat{\\eta}_{\\text{red}}(t)) \\right) \\, \\mathrm{d}t \\right)\n$$\n在威尔克斯定理的正则性条件下，该统计量 $D$ 在 $H_0$ 下渐近服从自由度为 $K$ 的卡方分布，其中 $K$ 是受约束参数的数量（即 $w$ 的维度）。",
            "answer": "$$\n\\boxed{2 \\left( \\sum_{i=1}^{n} \\left( \\hat{\\eta}_{\\text{full}}(t_i) - \\hat{\\eta}_{\\text{red}}(t_i) \\right) - \\int_0^T \\left( \\exp(\\hat{\\eta}_{\\text{full}}(t)) - \\exp(\\hat{\\eta}_{\\text{red}}(t)) \\right) \\, \\mathrm{d}t \\right)}\n$$"
        },
        {
            "introduction": "一个模型可能包含了显著的预测变量，但它是否真正捕捉了脉冲序列的整体统计结构？本练习介绍了时间重整化定理，这是一种评估任何点过程模型拟合优度的优雅而强大的方法。通过对脉冲间隔进行特定变换，我们可以检验其是否服从均匀分布，从而为模型的有效性提供直观和定量的检验。",
            "id": "3983810",
            "problem": "考虑一个用于神经元脉冲序列的简单平稳点过程模型，该脉冲序列由有限观测窗口内的脉冲时间 $\\{t_i\\}_{i=1}^{N}$ 索引，其条件强度函数为 $\\lambda(t \\mid \\mathcal{H}_t)$，其中 $\\mathcal{H}_t$ 表示截至时间 $t$ 的脉冲历史。条件强度函数由基本极限 $\\lambda(t \\mid \\mathcal{H}_t) = \\lim_{\\Delta t \\to 0^{+}} \\frac{\\mathbb{P}\\{\\text{在 }[t, t+\\Delta t) \\text{内有一次脉冲} \\mid \\mathcal{H}_t\\}}{\\Delta t}$ 定义，而脉冲间隔生存函数由标准风险-生存关系 $S(s) = \\exp\\!\\left(-\\int_{0}^{s} \\lambda(t_{i-1}+u \\mid \\mathcal{H}_{t_{i-1}+u}) \\, du\\right)$ 给出，其中 $s$ 是自上一次脉冲 $t_{i-1}$ 以来经过的时间。\n\n仅从这些定义以及一个经过充分检验的事实出发：一个速率为 $\\lambda(t)$ 的非齐次泊松过程可以通过确定性时间变换 $\\tau(t) = \\int_{0}^{t} \\lambda(u) \\, du$ 映射到一个速率为1的齐次泊松过程。请完成以下任务：\n\n1. 陈述对于条件强度为 $\\lambda(t \\mid \\mathcal{H}_t)$ 的简单点过程的时间重标度定理，并推导出一个对脉冲间隔的单调变换，该变换在正确设定的模型下能够产生服从 Uniform$(0,1)$ 分布的独立同分布随机变量。\n\n2. 考虑一个广义线性模型(GLM)点过程强度，它在区间 $[0, 0.6]$ 秒上具有指数（对数连接）参数化。在时间 $t_1 = 0.2$ 秒和 $t_2 = 0.6$ 秒观测到两次脉冲。除了一个脉冲历史项外，没有其他协变量。条件强度为\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp\\!\\left(\\beta_0 + \\beta_h \\, \\kappa(t - t_1) \\mathbf{1}\\{t  t_1\\}\\right),\n$$\n其中 $\\beta_0 \\in \\mathbb{R}$ 和 $\\beta_h \\in \\mathbb{R}$ 是参数，脉冲历史核为\n$$\n\\kappa(s) = \\begin{cases} 1,  0 \\leq s  0.5, \\\\ 0,  s \\geq 0.5. \\end{cases}\n$$\n假设在 $t_1$ 之前脉冲序列历史为空（即在 $t_1$ 之前没有脉冲）。使用你在第1部分推导出的变换，计算与脉冲间隔 $(t_0, t_1)$ 和 $(t_1, t_2)$ 相关联的两个变换后的变量，其中 $t_0 = 0$。将你得到的变换后值对的最终答案表示为一个关于 $\\beta_0$ 和 $\\beta_h$ 的单一闭式解析表达式，并以行向量的形式呈现。时间单位为秒；变换后的变量是无量纲的。不需要进行数值近似或四舍五入；请给出精确表达式。",
            "solution": "这个问题是有效的，因为它在科学上基于点过程理论和计算神经科学，问题是良定的，具有唯一且有意義的解，并且其表述是客观的。所有必要信息都已提供，不存在矛盾之处。\n\n该问题分为两部分。第一部分要求陈述并推导将一般点过程的脉冲间隔(ISIs)转换为独立同分布(i.i.d.)的Uniform$(0,1)$随机变量的变换。第二部分要求将此变换应用于一个特定的广义线性模型(GLM)脉冲序列。\n\n**第1部分：时间重标度变换**\n\n对于给定条件强度函数 $\\lambda(t \\mid \\mathcal{H}_t)$ 的简单点过程，时间重标度定理提供了一种模型评估的方法。如果条件强度的模型是正确的，那么对观测到的脉冲时间进行特定变换将得到一组服从已知分布的独立同分布随机变量。\n\n设 $\\{t_i\\}$ 为脉冲时间序列，其中 $t_0$ 为观测周期的开始时间。第 $i$ 个脉冲间隔为 $\\Delta t_i = t_i - t_{i-1}$。设 $\\Delta T_i$ 为对应于此间隔的随机变量。条件强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 在时间 $t$ 充当该过程的风险率。给定截至前一次脉冲 $t_{i-1}$ 的历史，下一个小时间区间内出现脉冲的概率取决于此函数。\n\n生存函数 $S(s \\mid \\mathcal{H}_{t_{i-1}})$，即第 $i$ 个脉冲间隔(ISI)大于时长 $s$ 的概率，是由风险函数的乘积积分给出的。问题中提供了这个关系式：\n$$\nS(s \\mid \\mathcal{H}_{t_{i-1}}) = \\mathbb{P}(\\Delta T_i  s \\mid \\mathcal{H}_{t_{i-1}}) = \\exp\\left(-\\int_{0}^{s} \\lambda(t_{i-1}+u \\mid \\mathcal{H}_{t_{i-1}+u}) \\, du\\right)\n$$\n通过进行变量替换 $v = t_{i-1}+u$，该积分可以重写在绝对时间轴上：\n$$\nS(s \\mid \\mathcal{H}_{t_{i-1}}) = \\exp\\left(-\\int_{t_{i-1}}^{t_{i-1}+s} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n脉冲间隔的累积分布函数(CDF) $F(s \\mid \\mathcal{H}_{t_{i-1}}) = \\mathbb{P}(\\Delta T_i \\leq s \\mid \\mathcal{H}_{t_{i-1}})$ 就是 $1 - S(s \\mid \\mathcal{H}_{t_{i-1}})$。因此，\n$$\nF(s \\mid \\mathcal{H}_{t_{i-1}}) = 1 - \\exp\\left(-\\int_{t_{i-1}}^{t_{i-1}+s} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n根据概率积分变换(PIT)定理，如果 $X$ 是一个具有累积分布函数 $F_X(x)$ 的连续随机变量，那么随机变量 $Y = F_X(X)$ 在区间 $(0,1)$ 上均匀分布。\n\n将概率积分变换定理应用于我们的情况，我们可以通过在观测到的脉冲间隔时长 $\\Delta t_i = t_{i} - t_{i-1}$ 处计算每个脉冲间隔的条件累积分布函数来定义一组变换后的变量 $z_i$。\n$$\nz_i = F(\\Delta t_i \\mid \\mathcal{H}_{t_{i-1}}) = 1 - \\exp\\left(-\\int_{t_{i-1}}^{t_i} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n如果模型 $\\lambda(t \\mid \\mathcal{H}_t)$ 是对真实数据生成过程的正确设定，那么得到的变量序列 $\\{z_i\\}$ 将服从 Uniform$(0,1)$ 分布且独立同分布。这个变换就是问题所要求的。\n\n这个结果与非齐次泊松过程的时间重标度有关。积分 $\\tau_i = \\int_{t_{i-1}}^{t_i} \\lambda(v \\mid \\mathcal{H}_v) \\, dv$ 可以解释为“重标度时间”。该定理指出，这些重标度时间 $\\{\\tau_i\\}$ 是来自速率为1的标准指数分布的独立同分布随机变量。一个 Exponential$(1)$ 分布的累积分布函数是 $F(x) = 1 - \\exp(-x)$。将概率积分变换应用于变量 $\\tau_i$ 可以得到 $z_i = F(\\tau_i) = 1-\\exp(-\\tau_i)$，从而产生相同的 Uniform$(0,1)$ 变量。\n\n**第2部分：应用于GLM脉冲序列**\n\n给定一个在区间 $[0, 0.6]$ 秒上的特定GLM条件强度：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp\\left(\\beta_0 + \\beta_h \\, \\kappa(t - t_1) \\mathbf{1}\\{t  t_1\\}\\right)\n$$\n其脉冲历史核为\n$$\n\\kappa(s) = \\begin{cases} 1,  0 \\leq s  0.5 \\\\ 0,  s \\geq 0.5 \\end{cases}\n$$\n观测到的脉冲发生在 $t_1 = 0.2$ 和 $t_2 = 0.6$。观测从 $t_0 = 0$ 开始。我们需要为两个脉冲间隔 $(t_0, t_1)$ 和 $(t_1, t_2)$ 计算变换后的变量 $z_1$ 和 $z_2$。\n\n**第一个区间：$(t_0, t_1) = (0, 0.2)$**\n\n第一个变换后的变量是 $z_1 = 1 - \\exp\\left(-\\int_{0}^{0.2} \\lambda(t \\mid \\mathcal{H}_t) \\, dt\\right)$。\n对于 $t \\in [0, 0.2]$，历史 $\\mathcal{H}_t$ 为空，并且条件 $t  t_1$（即 $t  0.2$）为假。指示函数 $\\mathbf{1}\\{t  0.2\\}$ 为 $0$。\n因此，条件强度简化为基线速率：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\beta_0 + \\beta_h \\cdot 0) = \\exp(\\beta_0) \\quad \\text{对于 } t \\in [0, 0.2]\n$$\n在此区间上强度的积分为：\n$$\n\\int_{0}^{0.2} \\exp(\\beta_0) \\, dt = \\exp(\\beta_0) \\int_{0}^{0.2} dt = 0.2 \\exp(\\beta_0)\n$$\n因此，第一个变换后的变量是：\n$$\nz_1 = 1 - \\exp(-0.2 \\exp(\\beta_0))\n$$\n\n**第二个区间：$(t_1, t_2) = (0.2, 0.6)$**\n\n第二个变换后的变量是 $z_2 = 1 - \\exp\\left(-\\int_{0.2}^{0.6} \\lambda(t \\mid \\mathcal{H}_t) \\, dt\\right)$。\n对于 $t \\in (0.2, 0.6]$，历史 $\\mathcal{H}_t$ 包含在 $t_1 = 0.2$ 处的脉冲。条件 $t  t_1$ 为真，所以指示函数 $\\mathbf{1}\\{t  0.2\\}$ 为 $1$。\n核函数的自变量是 $s = t - t_1 = t - 0.2$。当 $t$ 从 $0.2$ 变化到 $0.6$ 时，$s$ 从 $0$ 变化到 $0.4$。\n根据 $\\kappa(s)$ 的定义，对于 $s \\in [0, 0.4]$，这是 $[0, 0.5)$ 的一个子集，我们有 $\\kappa(s) = 1$。\n因此，对于 $t \\in (0.2, 0.6]$，条件强度为常数：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\beta_0 + \\beta_h \\cdot 1) = \\exp(\\beta_0 + \\beta_h) \\quad \\text{对于 } t \\in (0.2, 0.6]\n$$\n在此区间上强度的积分为：\n$$\n\\int_{0.2}^{0.6} \\exp(\\beta_0 + \\beta_h) \\, dt = \\exp(\\beta_0 + \\beta_h) \\int_{0.2}^{0.6} dt = (0.6 - 0.2) \\exp(\\beta_0 + \\beta_h) = 0.4 \\exp(\\beta_0 + \\beta_h)\n$$\n因此，第二个变换后的变量是：\n$$\nz_2 = 1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h))\n$$\n变换后的值对 $(z_1, z_2)$ 应表示为行向量。\n$$\n\\begin{pmatrix} z_1  z_2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\exp(-0.2 \\exp(\\beta_0))  1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h)) \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 - \\exp(-0.2 \\exp(\\beta_0))  1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h)) \\end{pmatrix}}\n$$"
        }
    ]
}