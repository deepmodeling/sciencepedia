{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring the physical basis of spike generation in the presence of noise. This exercise applies Kramers' rate theory, a powerful concept from statistical physics, to model spiking as the escape of the membrane potential, $V$, over an effective energy barrier . By analyzing the process in the small-noise regime, you will derive the characteristic exponential form of the state-dependent hazard, $h(V)$, revealing how this fundamental nonlinearity arises from the interplay between deterministic forces and stochastic fluctuations.",
            "id": "3975121",
            "problem": "Consider a one-dimensional, overdamped stochastic description of the membrane potential dynamics under synaptic bombardment, modeled as the Itō stochastic differential equation\n$$\n\\mathrm{d}V(t) \\;=\\; -\\partial_{V}U(V)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\nwhere $V$ is the membrane potential, $U(V)$ is an effective potential encoding deterministic transmembrane currents, $D>0$ is the effective diffusion intensity due to synaptic noise, and $W_t$ is a standard Wiener process. Assume that spike initiation can be treated as an escape over a potential barrier at a voltage $V_{\\mathrm{th}}$ from a metastable well at a subthreshold voltage, and define the state-dependent hazard $h(V)$ as the instantaneous escape rate from the basin of attraction of the well, conditioned on the membrane potential being $V$.\n\nIn the small-noise regime, the barrier crossing rate is governed by Kramers’ rate theory for one-dimensional overdamped dynamics, in which the leading exponential dependence of the rate is controlled by the barrier height. In a narrow neighborhood of voltages just below $V_{\\mathrm{th}}$, assume the barrier height measured from the current state $V$ admits the linear approximation\n$$\n\\Delta U(V) \\;\\equiv\\; U(V_{\\mathrm{b}}) - U(V) \\;\\approx\\; \\alpha\\bigl(V_{\\mathrm{th}} - V\\bigr),\n$$\nwith $\\alpha>0$ a constant determined by the local slope of the effective potential, and $V_{\\mathrm{b}}$ the barrier-top voltage. Furthermore, assume the Kramers pre-exponential factor varies slowly with $V$ over this neighborhood and can be treated as a constant $h_0>0$.\n\nUsing these assumptions, derive the leading-order voltage dependence of the hazard $h(V)$ and identify the characteristic exponential scale that controls this dependence. Provide your final answer as a single closed-form expression for the characteristic scale in terms of $D$ and $\\alpha$. Express the final answer in the same voltage units as $V$. No numerical evaluation is required.",
            "solution": "The starting point is the overdamped Langevin equation\n$$\n\\mathrm{d}V(t) \\;=\\; -\\partial_{V}U(V)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\nwhich, in the small-noise regime, admits a Kramers-type description of escape events from a metastable well to a threshold barrier. The hazard $h(V)$ is defined as the instantaneous rate at which an escape occurs, conditional on the current state being at voltage $V$ within the well’s basin of attraction. In the classic Kramers framework for one-dimensional overdamped dynamics, the escape rate from a well over a barrier is, to leading order in the small-noise limit, given by an expression of the form\n$$\nh(V) \\;\\approx\\; A(V)\\,\\exp\\!\\left(-\\frac{\\Delta U(V)}{D}\\right),\n$$\nwhere $\\Delta U(V)$ is the barrier height measured from the current state $V$, and $A(V)$ is a pre-exponential factor that depends on local curvatures of the potential near the well and barrier and on the friction coefficient. Under the present assumptions, the friction has been absorbed into the units so that $D$ plays the role of an effective temperature, and $A(V)$ varies slowly with $V$.\n\nWe focus on the exponential dependence, which dominates in the small-noise limit $D \\ll 1$ in appropriate units. The barrier height is approximated near threshold by\n$$\n\\Delta U(V) \\;\\approx\\; \\alpha\\bigl(V_{\\mathrm{th}} - V\\bigr),\n$$\nwith $\\alpha>0$ characterizing the local slope of the effective potential difference between the barrier top and the current state. Substituting this linear approximation into the Kramers rate gives\n$$\nh(V) \\;\\approx\\; A(V)\\,\\exp\\!\\left(-\\frac{\\alpha(V_{\\mathrm{th}} - V)}{D}\\right).\n$$\nIf $A(V)$ varies slowly with $V$ in the narrow subthreshold neighborhood under consideration, we can replace it by a constant $h_0$ evaluated at $V=V_{\\mathrm{th}}$, where the barrier vanishes, i.e.,\n$$\nh(V) \\;\\approx\\; h_0\\,\\exp\\!\\left(-\\frac{\\alpha(V_{\\mathrm{th}} - V)}{D}\\right).\n$$\nRewriting the exponent, we obtain the exponential hazard form\n$$\nh(V) \\;\\approx\\; h_0\\,\\exp\\!\\left(\\frac{V - V_{\\mathrm{th}}}{\\Delta}\\right),\n$$\nwhere the characteristic exponential scale $\\Delta$ is defined so that\n$$\n\\frac{1}{\\Delta} \\;=\\; \\frac{\\alpha}{D}.\n$$\nTherefore,\n$$\n\\Delta \\;=\\; \\frac{D}{\\alpha}.\n$$\n\nMore generally, if the barrier height is expressed as $\\Delta U(V)$ without committing to the linear approximation constant $\\alpha$, the same reasoning yields\n$$\n\\Delta \\;=\\; \\left.\\frac{D}{\\partial_{V}\\Delta U(V)}\\right|_{V=V_{\\mathrm{th}}},\n$$\nprovided $\\partial_{V}\\Delta U(V)$ is evaluated at the threshold voltage and is positive. In the special case where $\\Delta U(V) \\approx \\alpha(V_{\\mathrm{th}} - V)$, we have $\\partial_{V}\\Delta U(V) = -\\alpha$, and the magnitude of the slope enters as $\\alpha>0$, giving the same $\\Delta = D/\\alpha$ that sets the voltage scale governing how rapidly the hazard grows with $V$ near threshold.\n\nThus, the characteristic scale $\\Delta$ controlling the exponential sensitivity of the state-dependent hazard to membrane voltage in the small-noise Kramers regime is the ratio of the diffusion intensity to the local barrier-height slope with respect to voltage.",
            "answer": "$$\\boxed{\\frac{D}{\\alpha}}$$"
        },
        {
            "introduction": "Having established a physical picture for the firing rate, we now turn to a precise mathematical description of the spike *timing*. This practice challenges you to derive the first-passage time density for a drifted Brownian motion, a canonical process for threshold crossing, using the elegant method of images . You will then discover how this simple model accurately describes the near-threshold dynamics of the more realistic Ornstein-Uhlenbeck process, demonstrating the power and validity of local diffusion approximations in analyzing spike statistics.",
            "id": "3975060",
            "problem": "A neuron’s membrane potential near an absorbing spike threshold can be modeled by a one-dimensional diffusion. Consider first the drifted Brownian motion approximation with constant drift and diffusion coefficients, given by the stochastic differential equation $dV_{t} = \\mu\\,dt + \\sigma\\,dW_{t}$, started at $V_{0} = v$ with $v < \\theta$ and an absorbing boundary at $V = \\theta$. Let $p(x,t\\,|\\,v)$ denote the transition density on the half-line $(-\\infty,\\theta)$ with the absorbing boundary condition $p(\\theta,t\\,|\\,v) = 0$ and the initial condition $p(x,0\\,|\\,v) = \\delta(x - v)$. Using the method of images applied to the corresponding Fokker–Planck equation, derive the first-passage time density $f_{\\mathrm{BM}}(t;\\mu,\\sigma,\\theta,v)$ for hitting $V = \\theta$. Your derivation must start from the Fokker–Planck equation and enforce the absorbing boundary by constructing an image solution that exactly cancels the boundary value.\n\nNow consider the Ornstein–Uhlenbeck (OU) process, which provides a canonical near-threshold model for a leaky integrate-and-fire neuron:\n$$\ndV_{t} = -\\lambda\\left(V_{t} - \\bar{V}\\right)\\,dt + \\sigma\\,dW_{t},\n$$\nwith $V_{0} = \\theta - \\delta$ where $0 < \\delta \\ll 1$, the same absorbing threshold $V = \\theta$, and the same diffusion coefficient $\\sigma$. Define the local drift at threshold $b_{\\theta} \\equiv -\\lambda\\left(\\theta - \\bar{V}\\right)$. Using a near-threshold diffusion approximation that replaces the OU drift locally by the constant value $b_{\\theta}$ over short times and small displacements, compare the OU hitting-time density $f_{\\mathrm{OU}}(t;\\delta)$ to the drifted Brownian motion hitting-time density $f_{\\mathrm{BM}}(t;b_{\\theta},\\sigma,\\theta,\\theta-\\delta)$ under the asymptotic scaling $t = s\\,\\delta/|b_{\\theta}|$ with fixed $s \\in (0,\\infty)$ while $\\delta \\to 0$.\n\nCompute the limit\n$$\n\\lim_{\\delta \\to 0}\\,\\frac{f_{\\mathrm{OU}}\\!\\left(t;\\delta\\right)}{f_{\\mathrm{BM}}\\!\\left(t;b_{\\theta},\\sigma,\\theta,\\theta-\\delta\\right)}\\quad\\text{with}\\quad t = s\\,\\delta/|b_{\\theta}|,\n$$\nand express your final answer as a single constant equal to this limiting ratio. No numerical rounding is required and no physical units are to be reported in the final answer.",
            "solution": "### Part 1: Derivation of the First-Passage Time Density for Brownian Motion\n\nThe evolution of the transition probability density $p(x, t | v)$ for the process $dV_t = \\mu dt + \\sigma dW_t$ is governed by the Fokker-Planck equation:\n$$\n\\frac{\\partial p}{\\partial t} = -\\mu \\frac{\\partial p}{\\partial x} + \\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial x^2}.\n$$\nThe problem is defined on the half-line $x \\in (-\\infty, \\theta)$, with an initial condition $p(x, 0 | v) = \\delta(x-v)$ and an absorbing boundary condition $p(\\theta, t | v) = 0$ for all $t > 0$.\n\nWe use the method of images. The solution for an unrestricted process (free diffusion) is a Gaussian:\n$$\np_{\\text{free}}(x, t | v) = \\frac{1}{\\sqrt{2\\pi\\sigma^2 t}} \\exp\\left(-\\frac{(x - v - \\mu t)^2}{2\\sigma^2 t}\\right).\n$$\nTo enforce the absorbing boundary, we introduce a negative image source starting at $v' = 2\\theta - v$ with a specific weight $C = \\exp\\left(\\frac{2\\mu(\\theta - v)}{\\sigma^2}\\right)$, such that the superposition $p(x, t | v) = p_{\\text{free}}(x, t | v) - C \\cdot p_{\\text{free}}(x, t | v')$ satisfies $p(\\theta, t | v) = 0$.\n\nThe first-passage time (FPT) density $f_{\\mathrm{BM}}(t)$ is the probability flux $J(x, t)$ evaluated at the boundary $x=\\theta$. The flux is given by $J(x, t) = \\mu p(x,t|v) - \\frac{\\sigma^2}{2} \\frac{\\partial p(x,t|v)}{\\partial x}$. Since $p(\\theta, t|v) = 0$, the FPT density simplifies to $f_{\\mathrm{BM}}(t) = J(\\theta,t) = -\\frac{\\sigma^2}{2} \\frac{\\partial p}{\\partial x}\\big|_{x=\\theta}$.\nCalculating the spatial derivative of the full solution and evaluating at $x=\\theta$ yields:\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{x=\\theta} = -\\frac{2(\\theta-v)}{\\sigma^2 t} \\cdot p_{\\text{free}}(\\theta, t|v) = -\\frac{2(\\theta-v)}{\\sigma^2 t \\sqrt{2\\pi\\sigma^2 t}} \\exp\\left(-\\frac{(\\theta - v - \\mu t)^2}{2\\sigma^2 t}\\right).\n$$\nThe FPT density is therefore:\n$$\nf_{\\mathrm{BM}}(t;\\mu,\\sigma,\\theta,v) = -\\frac{\\sigma^2}{2} \\left(\\frac{\\partial p}{\\partial x}\\bigg|_{x=\\theta}\\right) = \\frac{\\theta-v}{\\sqrt{2\\pi\\sigma^2 t^3}} \\exp\\left(-\\frac{(\\theta - v - \\mu t)^2}{2\\sigma^2 t}\\right).\n$$\n\n### Part 2: Asymptotic Limit of the Ratio of FPT Densities\n\nFor a process starting very close to a boundary (i.e., $\\delta \\to 0$ and consequently $t \\to 0$), the first-passage time density of the Ornstein-Uhlenbeck (OU) process, $f_{\\mathrm{OU}}(t;\\delta)$, can be accurately approximated by the FPT density of a Brownian motion with a constant effective drift. A highly accurate choice for this drift is the average of the OU drift over the small interval between the start and the boundary. The OU drift is $m(V) = -\\lambda(V-\\bar{V})$. The average drift over $[\\theta-\\delta, \\theta]$ is:\n$$\n\\mu_{\\text{avg}} = \\frac{1}{\\delta} \\int_{\\theta-\\delta}^{\\theta} [-\\lambda(V-\\bar{V})] dV = -\\lambda\\left(\\theta - \\bar{V} - \\frac{\\delta}{2}\\right) = b_{\\theta} + \\frac{\\lambda\\delta}{2}.\n$$\nThus, for $\\delta \\to 0$, $f_{\\mathrm{OU}}(t;\\delta)$ is asymptotically equivalent to the FPT density of a BM with drift $\\mu_{\\text{avg}}$:\n$$\nf_{\\mathrm{OU}}(t;\\delta) \\sim f_{\\mathrm{BM}}(t; b_{\\theta} + \\lambda\\delta/2, \\sigma, \\theta, \\theta-\\delta) = \\frac{\\delta}{\\sqrt{2\\pi\\sigma^2 t^3}} \\exp\\left(-\\frac{(\\delta - (b_{\\theta} + \\lambda\\delta/2) t)^2}{2\\sigma^2 t}\\right).\n$$\nThe denominator in the limit is the BM FPT density with drift $b_{\\theta}$:\n$$\nf_{\\mathrm{BM}}(t; b_{\\theta}, \\sigma, \\theta, \\theta-\\delta) = \\frac{\\delta}{\\sqrt{2\\pi\\sigma^2 t^3}} \\exp\\left(-\\frac{(\\delta - b_\\theta t)^2}{2\\sigma^2 t}\\right).\n$$\nThe ratio of the densities is the ratio of their exponential terms:\n$$\n\\frac{f_{\\mathrm{OU}}}{f_{\\mathrm{BM}}} \\sim \\exp\\left( \\frac{(\\delta - b_\\theta t)^2 - (\\delta - (b_{\\theta} + \\lambda\\delta/2) t)^2}{2\\sigma^2 t} \\right).\n$$\nThe term in the exponent is:\n$$\n\\frac{(\\lambda\\delta t/2)(2(\\delta-b_{\\theta}t) - \\lambda\\delta t/2)}{2\\sigma^2 t} = \\frac{\\lambda\\delta(\\delta-b_{\\theta}t)}{2\\sigma^2} - \\frac{\\lambda^2\\delta^2 t}{8\\sigma^2}.\n$$\nNow, we apply the scaling $t = s\\delta/|b_\\theta|$. The exponent becomes:\n$$\n\\frac{\\lambda\\delta^2}{2\\sigma^2} - \\frac{\\lambda b_\\theta \\delta}{2\\sigma^2} \\frac{s\\delta}{|b_\\theta|} - O(\\delta^3) = \\frac{\\lambda\\delta^2}{2\\sigma^2} - \\frac{\\lambda s \\delta^2}{2\\sigma^2} \\mathrm{sgn}(b_\\theta) - O(\\delta^3).\n$$\nAs $\\delta \\to 0$, the entire exponent is of order $O(\\delta^2)$ and thus goes to zero.\nTherefore, the limit of the ratio is $\\exp(0) = 1$. This result shows that in this scaling limit, the OU process is indistinguishable from a Brownian motion with a drift equal to the OU drift at the threshold.",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "Analytical solutions provide deep insight, but we often rely on numerical simulations to explore more complex or nonlinear neural models. This hands-on coding exercise addresses a critical challenge in simulating threshold-crossing events: the artificial \"overshoot\" of the voltage threshold caused by discrete time steps, $\\Delta t$ . You will first quantify this numerical bias and then implement a sophisticated correction using Brownian bridge theory, a powerful tool for inferring the path of a stochastic process between two observed points.",
            "id": "3975080",
            "problem": "Consider a stochastic model of a neuron's membrane potential under constant input and leak, represented by an Ornstein–Uhlenbeck (OU) process. Let the membrane potential be denoted by $V(t)$, the leak reversal potential by $V_{\\mathrm{L}}$, the membrane time constant by $\\tau_{\\mathrm{m}}$, the constant mean input by $\\mu$, and the noise amplitude by $\\sigma$. The continuous-time dynamics are defined by the stochastic differential equation\n$$\n\\mathrm{d}V(t) = -\\frac{V(t) - V_{\\mathrm{L}}}{\\tau_{\\mathrm{m}}}\\,\\mathrm{d}t + \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\nwhere $\\mathrm{d}W(t)$ denotes the increment of a Wiener process (standard Brownian motion). A spike is registered when $V(t)$ first reaches the threshold $V_{\\mathrm{th}}$, after which $V(t)$ is reset to $V_{\\mathrm{reset}}$.\n\nIn discrete time with uniform time step $\\Delta t$, approximate the dynamics using the Euler–Maruyama method. Define discrete states $V_n \\approx V(n\\,\\Delta t)$ and Gaussian increments $\\xi_n \\sim \\mathcal{N}(0,1)$, such that\n$$\nV_{n+1} = V_n + \\Delta t\\left(-\\frac{V_n - V_{\\mathrm{L}}}{\\tau_{\\mathrm{m}}} + \\mu\\right) + \\sigma \\sqrt{\\Delta t}\\,\\xi_n.\n$$\nUnder standard discrete-time detection, a spike is declared at step $n+1$ if $V_n < V_{\\mathrm{th}}$ and $V_{n+1} \\ge V_{\\mathrm{th}}$. The discrete-time overshoot of the threshold at a declared spike is defined as\n$$\nO_i = V_{n+1} - V_{\\mathrm{th}},\n$$\nfor the $i$-th spike event, which quantifies how far above threshold the potential is at the end of the step when crossing occurs. The mean overshoot over all spikes is\n$$\n\\overline{O} = \\frac{1}{N_{\\mathrm{spk}}}\\sum_{i=1}^{N_{\\mathrm{spk}}} O_i,\n$$\nwhere $N_{\\mathrm{spk}}$ is the total number of spikes detected.\n\nTasks:\n1. Starting from the continuous-time OU dynamics as given, derive the discrete-time update and implement a simulation that iterates the update equation, detects spikes using the end-of-step criterion $V_{n+1} \\ge V_{\\mathrm{th}}$ with $V_n < V_{\\mathrm{th}}$, resets $V$ to $V_{\\mathrm{reset}}$ after each spike, and computes the mean overshoot $\\overline{O}$ in millivolts (mV). Report $\\overline{O}$ as a floating-point number in mV.\n\n2. Using Brownian bridge theory over a single time step, derive an approximation for the probability that the continuous path crosses $V_{\\mathrm{th}}$ within a step even when the discrete endpoints satisfy $V_n < V_{\\mathrm{th}}$ and $V_{n+1} < V_{\\mathrm{th}}$. Also derive an estimator for the first passage time within the step when the endpoints straddle the threshold, i.e., $V_n < V_{\\mathrm{th}} < V_{n+1}$. Based on these, propose and implement a correction that reduces the overshoot bias by declaring crossings inside a step using the derived crossing probability and, when a crossing is declared, setting the overshoot to zero by placing the spike exactly at the threshold within the step. Compute the corrected mean overshoot $\\overline{O}_{\\mathrm{bb}}$ in millivolts (mV) and report it as a floating-point number in mV.\n\nPhysical and numerical units:\n- Report mean overshoots in millivolts (mV).\n- Time is in milliseconds (ms); angles do not appear in this problem.\n\nTest suite:\nFor each of the following parameter sets, run a simulation and compute both the naive mean overshoot $\\overline{O}$ and the Brownian-bridge-corrected mean overshoot $\\overline{O}_{\\mathrm{bb}}$.\n\n- Case $1$ (happy path, small $\\Delta t$):\n  - $V_{\\mathrm{L}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV\n  - $\\tau_{\\mathrm{m}} = 20$ ms, $\\mu = 1$ mV/ms, $\\sigma = 2$ mV/\\sqrt{\\mathrm{ms}}\n  - $\\Delta t = 0.1$ ms, total simulated time $T = 5000$ ms\n  - random seed $42$\n\n- Case $2$ (coarse time step, larger overshoot expected):\n  - $V_{\\mathrm{L}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV\n  - $\\tau_{\\mathrm{m}} = 20$ ms, $\\mu = 1$ mV/ms, $\\sigma = 2$ mV/\\sqrt{\\mathrm{ms}}\n  - $\\Delta t = 1.0$ ms, $T = 5000$ ms\n  - random seed $7$\n\n- Case $3$ (stronger noise):\n  - $V_{\\mathrm{L}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV\n  - $\\tau_{\\mathrm{m}} = 20$ ms, $\\mu = 1$ mV/ms, $\\sigma = 5$ mV/\\sqrt{\\mathrm{ms}}\n  - $\\Delta t = 0.2$ ms, $T = 5000$ ms\n  - random seed $123$\n\n- Case $4$ (weaker drift, moderate noise):\n  - $V_{\\mathrm{L}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV\n  - $\\tau_{\\mathrm{m}} = 20$ ms, $\\mu = 0.5$ mV/ms, $\\sigma = 3$ mV/\\sqrt{\\mathrm{ms}}\n  - $\\Delta t = 0.1$ ms, $T = 5000$ ms\n  - random seed $2024$\n\nFinal output format:\nYour program should produce a single line of output containing the results for all four cases as a comma-separated list enclosed in square brackets. For each case, append the naive mean overshoot $\\overline{O}$ followed by the corrected mean overshoot $\\overline{O}_{\\mathrm{bb}}$, both expressed in mV and rounded to $6$ decimal places. The final output therefore contains $8$ numbers in the order\n$$\n[\\overline{O}_1,\\overline{O}_{\\mathrm{bb},1},\\overline{O}_2,\\overline{O}_{\\mathrm{bb},2},\\overline{O}_3,\\overline{O}_{\\mathrm{bb},3},\\overline{O}_4,\\overline{O}_{\\mathrm{bb},4}],\n$$\nwith no other text.",
            "solution": "The Ornstein–Uhlenbeck (OU) process is a linear stochastic differential equation that models a leaky membrane with constant input and noise. Starting from the base dynamics\n$$\n\\mathrm{d}V(t) = -\\frac{V(t) - V_{\\mathrm{L}}}{\\tau_{\\mathrm{m}}}\\,\\mathrm{d}t + \\mu\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\nwe can construct a discrete-time approximation via the Euler–Maruyama method. Over a small time step $\\Delta t$, the increment $\\mathrm{d}W(t)$ is approximated by $\\sqrt{\\Delta t}\\,\\xi_n$ with $\\xi_n \\sim \\mathcal{N}(0,1)$, yielding\n$$\nV_{n+1} = V_n + \\Delta t\\left(-\\frac{V_n - V_{\\mathrm{L}}}{\\tau_{\\mathrm{m}}} + \\mu\\right) + \\sigma \\sqrt{\\Delta t}\\,\\xi_n.\n$$\nThis is the well-tested scheme for linear stochastic differential equations with additive noise and forms the computational foundation of our simulation.\n\nDiscrete-time spike detection is performed at the end of each step: when $V_n < V_{\\mathrm{th}}$ and $V_{n+1} \\ge V_{\\mathrm{th}}$, a spike is declared and the voltage is reset to $V_{\\mathrm{reset}}$. The overshoot at that event is\n$$\nO_i = V_{n+1} - V_{\\mathrm{th}}.\n$$\nBecause the true threshold crossing occurs at some time between $t_n$ and $t_{n+1}$, the end-of-step measurement $V_{n+1}$ introduces a positive bias in $O_i$ for finite $\\Delta t$. The mean overshoot is\n$$\n\\overline{O} = \\frac{1}{N_{\\mathrm{spk}}} \\sum_{i=1}^{N_{\\mathrm{spk}}} O_i,\n$$\nwhich we report in millivolts (mV).\n\nTo reduce this bias, we invoke Brownian bridge theory over a single step. Over the interval $[t_n, t_{n+1}]$, conditioned on the endpoints, the stochastic path can be represented as\n$$\nV(t_n + s) = V_n + \\frac{s}{\\Delta t}(V_{n+1} - V_n) + \\sigma\\,B(s),\n$$\nfor $s \\in [0,\\Delta t]$, where $B(s)$ is a Brownian bridge with $B(0) = 0$ and $B(\\Delta t) = 0$. This decomposition expresses the path as a deterministic linear interpolation plus a mean-zero fluctuation that vanishes at the endpoints. Two key consequences follow:\n\n1. Crossing probability inside a step when the endpoints are both below. If $V_n < V_{\\mathrm{th}}$ and $V_{n+1} < V_{\\mathrm{th}}$, the conditional probability that the Brownian bridge crosses $V_{\\mathrm{th}}$ at some $s \\in (0,\\Delta t)$ admits a well-known closed form derived via the reflection principle for Gaussian bridges. Denote $d_n = V_{\\mathrm{th}} - V_n > 0$, $d_{n+1} = V_{\\mathrm{th}} - V_{n+1} > 0$, and the step variance $s^2 = \\sigma^2 \\Delta t$. The crossing probability is\n$$\np_{\\mathrm{hit}} = \\exp\\left(-\\frac{2\\,d_n\\,d_{n+1}}{s^2}\\right) = \\exp\\left(-\\frac{2\\,(V_{\\mathrm{th}} - V_n)(V_{\\mathrm{th}} - V_{n+1})}{\\sigma^2 \\Delta t}\\right).\n$$\nThis formula results from the distribution of the maximum of a Brownian bridge over the interval and provides an $\\mathcal{O}(\\Delta t)$-accurate correction when drift within the step is small relative to noise or when $\\Delta t$ is sufficiently small.\n\n2. First passage time estimator when the endpoints straddle the threshold. If $V_n < V_{\\mathrm{th}} < V_{n+1}$, the crossing within the step is certain. The Brownian bridge representation suggests decomposing the path into a deterministic linear part and a centered bridge; a tractable and unbiased estimator for the crossing time $s^\\ast$ is obtained by equating the deterministic component to the threshold:\n$$\ns^\\ast \\approx \\Delta t \\cdot \\frac{V_{\\mathrm{th}} - V_n}{V_{n+1} - V_n}.\n$$\nThis estimator is the conditional expectation of the hitting time under the bridge when the threshold lies between the endpoints and is widely used in first-passage corrections. In a simulation that records spikes discretely, the overshoot bias can be reduced by declaring the spike at $t_n + s^\\ast$ and placing the state exactly at $V_{\\mathrm{th}}$ within the step, thereby setting the overshoot to zero.\n\nAlgorithmic correction to reduce overshoot bias:\n- For each step, compute $V_{n+1}$ via the Euler–Maruyama update.\n- If $V_n < V_{\\mathrm{th}}$ and $V_{n+1} \\ge V_{\\mathrm{th}}$, declare a spike using the Brownian bridge time estimator $s^\\ast$ to locate the event inside the step and set the overshoot to zero by placing the spike at $V_{\\mathrm{th}}$.\n- If $V_n < V_{\\mathrm{th}}$ and $V_{n+1} < V_{\\mathrm{th}}$, sample a uniform random variable $u \\in (0,1)$ and declare a spike within the step if $u < p_{\\mathrm{hit}}$; when such a spike is declared, place it at $V_{\\mathrm{th}}$ and set the overshoot to zero.\n- After any declared spike, reset $V$ to $V_{\\mathrm{reset}}$ and continue.\n\nThis Brownian-bridge-informed correction reduces the mean overshoot by avoiding the end-of-step measurement bias and by recovering crossings that occur within a step even when $V_{n+1}$ remains below $V_{\\mathrm{th}}$. In the limit $\\Delta t \\to 0$, both the naive and corrected overshoot means approach zero, but for finite $\\Delta t$ and realistic $\\sigma$, the naive mean overshoot $\\overline{O}$ is strictly positive whereas the corrected mean overshoot $\\overline{O}_{\\mathrm{bb}}$ is driven to near zero by construction.\n\nImplementation details:\n- We simulate each test case for a total time $T$ using $\\Delta t$, starting from $V_0 = V_{\\mathrm{reset}}$, and use independent Gaussian increments $\\xi_n \\sim \\mathcal{N}(0,1)$ with specified random seeds for reproducibility.\n- The naive overshoot computation uses the end-of-step criterion only.\n- The corrected method uses Brownian bridge crossing probability when both endpoints are below, and the Brownian bridge crossing time estimator when the endpoints straddle the threshold, setting the overshoot to zero for declared spikes.\n\nOutputs:\n- For each case, we compute and report two numbers: the naive mean overshoot $\\overline{O}$ and the corrected mean overshoot $\\overline{O}_{\\mathrm{bb}}$, both in millivolts (mV) and rounded to $6$ decimal places, aggregated into a single bracketed list as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_mean_overshoot_naive(V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed):\n    \"\"\"\n    Simulate OU process with naive end-of-step spike detection and compute mean overshoot.\n    Units:\n      - Voltages in mV\n      - Time in ms\n      - mu in mV/ms\n      - sigma in mV/sqrt(ms)\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    n_steps = int(T / dt)\n    V = V_reset\n    overshoots = []\n    sqrt_dt = np.sqrt(dt)\n    for _ in range(n_steps):\n        # Euler–Maruyama update\n        drift = dt * (-(V - V_L) / tau_m + mu)\n        noise = sigma * sqrt_dt * rng.standard_normal()\n        V_next = V + drift + noise\n\n        # Naive detection: end-of-step threshold crossing\n        if V  V_th and V_next >= V_th:\n            overshoots.append(V_next - V_th)\n            V = V_reset\n        else:\n            V = V_next\n    if len(overshoots) == 0:\n        return 0.0\n    return float(np.mean(overshoots))\n\ndef simulate_mean_overshoot_bb_corrected(V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed):\n    \"\"\"\n    Simulate OU process with Brownian bridge correction:\n      - Declare crossings within a step using bridge crossing probability when both endpoints are below.\n      - When a crossing is declared (either straddling or via probability), set overshoot to zero.\n    Returns mean overshoot (which will be ~0.0 by construction).\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    n_steps = int(T / dt)\n    V = V_reset\n    overshoots = []\n    sqrt_dt = np.sqrt(dt)\n    sigma2_dt = (sigma ** 2) * dt\n\n    for _ in range(n_steps):\n        # Euler–Maruyama update\n        drift = dt * (-(V - V_L) / tau_m + mu)\n        noise = sigma * sqrt_dt * rng.standard_normal()\n        V_next = V + drift + noise\n\n        crossed = False\n        if V  V_th and V_next >= V_th:\n            # Straddling, crossing is certain; set overshoot to zero by placing spike at threshold\n            crossed = True\n        elif V  V_th and V_next  V_th:\n            # Both below; Brownian bridge crossing probability within the step\n            d_n = V_th - V\n            d_np1 = V_th - V_next\n            # p_hit formula for Brownian bridge maximum crossing\n            if sigma2_dt > 0:\n                p_hit = np.exp(-2.0 * d_n * d_np1 / sigma2_dt)\n                if rng.random()  p_hit:\n                    crossed = True\n\n        if crossed:\n            overshoots.append(0.0)  # By correction, overshoot is set to zero\n            V = V_reset\n        else:\n            V = V_next\n\n    if len(overshoots) == 0:\n        return 0.0\n    return float(np.mean(overshoots))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed)\n    test_cases = [\n        (-65.0, -50.0, -65.0, 20.0, 1.0, 2.0, 0.1, 5000.0, 42),    # Case 1\n        (-65.0, -50.0, -65.0, 20.0, 1.0, 2.0, 1.0, 5000.0, 7),      # Case 2\n        (-65.0, -50.0, -65.0, 20.0, 1.0, 5.0, 0.2, 5000.0, 123),    # Case 3\n        (-65.0, -50.0, -65.0, 20.0, 0.5, 3.0, 0.1, 5000.0, 2024),   # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed = case\n        naive_mean = simulate_mean_overshoot_naive(\n            V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed\n        )\n        bb_mean = simulate_mean_overshoot_bb_corrected(\n            V_L, V_th, V_reset, tau_m, mu, sigma, dt, T, seed\n        )\n        # Round to 6 decimal places as specified\n        results.append(f\"{naive_mean:.6f}\")\n        results.append(f\"{bb_mean:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}