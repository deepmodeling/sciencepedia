{
    "hands_on_practices": [
        {
            "introduction": "在计算神经科学中，对随机微分方程（SDE）进行数值模拟是一项核心技能。本练习将指导您从最基本的原理出发，为Ornstein-Uhlenbeck（OU）过程推导其最直接的数值离散化方案——欧拉-丸山法（Euler–Maruyama method）。这项实践的价值不仅在于掌握模拟更新规则，更在于深入理解数值误差的来源与量级，特别是时间步长 $Δt$ 的选择如何影响模拟结果的统计准确性，为所有后续的数值工作打下坚实的基础。",
            "id": "4006881",
            "problem": "一个单室神经元接收突触输入，其净波动被建模为Ornstein–Uhlenbeck (OU) 过程。令 $X_{t}$ 表示突触变量，假设其遵循随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; -\\frac{1}{\\tau}\\,\\big(X_{t}-\\mu\\big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $\\tau>0$ 是相关时间，$\\mu$ 是平均水平，$\\sigma>0$ 是噪声强度，$W_{t}$ 是标准布朗运动（维纳过程）。仅从随机微分方程 (SDE) 的定义、布朗运动的伊藤增量性质以及一般的欧拉-丸山 (EM) 构造原理出发，推导一个时间步进格式。该格式使用每步的正态随机变量，将 $X_{t}$ 在一个固定的步长 $\\,\\Delta t>0\\,$ 上推进。\n\n然后，将得到的离散时间格式视为一个一阶自回归过程，并且在不使用连续OU过程的任何闭式精确解的情况下，推导出该离散时间格式的平稳方差，使其成为 $\\Delta t$、$\\tau$ 和 $\\sigma$ 的函数。接着，直接从其矩方程推导出连续时间OU过程的平稳方差。定义无量纲步长 $h \\equiv \\Delta t/\\tau$ 和相对平稳方差误差\n$$\n\\varepsilon_{\\mathrm{rel}}(h) \\;\\equiv\\; \\frac{\\operatorname{Var}_{\\mathrm{disc}}(h)-\\operatorname{Var}_{\\mathrm{cont}}}{\\operatorname{Var}_{\\mathrm{cont}}}.\n$$\n对给定的容差 $\\,\\epsilon \\in (0,1)\\,$, 施加精度要求 $\\varepsilon_{\\mathrm{rel}}(h) \\le \\epsilon$，并确定最大允许无量纲步长 $h_{\\max}$，将其表示为 $\\epsilon$ 的闭式表达式。以 $h_{\\max}$ 的解析表达式形式提供您的最终答案。不需要进行数值计算，并且最终表达式不应报告任何单位。",
            "solution": "问题是首先使用欧拉-丸山方法推导Ornstein-Uhlenbeck (OU) 过程的离散时间近似，然后分析该离散格式及其连续时间对应物的平稳方差，最后确定对时间步长的精度约束。该问题是适定的且科学上合理的，允许进行完整的推导。\n\nOrnstein-Uhlenbeck过程由以下随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_{t} = -\\frac{1}{\\tau}(X_{t}-\\mu)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\n其中 $\\tau > 0$、$\\mu$ 和 $\\sigma > 0$ 是常数，$W_t$ 是一个标准维纳过程。\n\n首先，我们推导时间步进格式。欧拉-丸山方法在一个小的有限时间步长 $\\Delta t > 0$ 上近似SDE。我们将时间离散化为 $t_n = n \\Delta t$ 并令 $X_n \\equiv X_{t_n}$。该微分方程近似为以下差分方程：\n$$\nX_{n+1} - X_n \\approx -\\frac{1}{\\tau}(X_n - \\mu)\\Delta t + \\sigma (W_{t_{n+1}} - W_{t_n})\n$$\n维纳过程的增量 $\\Delta W_n \\equiv W_{t_{n+1}} - W_{t_n}$ 是一个均值为 $0$、方差为 $\\Delta t$ 的正态分布随机变量。因此，我们可以写成 $\\Delta W_n = \\sqrt{\\Delta t} Z_n$，其中 $Z_n$ 是一个标准正态随机变量，$Z_n \\sim \\mathcal{N}(0,1)$。将此代入差分方程，得到时间步进格式：\n$$\nX_{n+1} = X_n - \\frac{\\Delta t}{\\tau}(X_n - \\mu) + \\sigma \\sqrt{\\Delta t} Z_n\n$$\n整理各项，我们得到：\n$$\nX_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)X_n + \\frac{\\Delta t}{\\tau}\\mu + \\sigma \\sqrt{\\Delta t} Z_n\n$$\n这就是所需的一阶自回归 AR($1$) 过程。\n\n接下来，我们推导这个离散时间格式的平稳方差，记为 $\\operatorname{Var}_{\\mathrm{disc}}$。平稳过程具有与时间无关的均值和方差。令 $\\mathbb{E}[X_n] = \\mu_{\\mathrm{disc}}$ 且 $\\operatorname{Var}(X_n) = \\sigma^2_{\\mathrm{disc}}$ 对于平稳状态下的所有 $n$ 都成立。对该格式取期望，并利用 $\\mathbb{E}[Z_n]=0$：\n$$\n\\mathbb{E}[X_{n+1}] = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\mathbb{E}[X_n] + \\frac{\\Delta t}{\\tau}\\mu\n$$\n$$\n\\mu_{\\mathrm{disc}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\mu_{\\mathrm{disc}} + \\frac{\\Delta t}{\\tau}\\mu\n$$\n求解 $\\mu_{\\mathrm{disc}}$ 得出 $\\mu_{\\mathrm{disc}} = \\mu$。离散过程的平稳均值与连续过程的均值相匹配。\n\n为了求平稳方差，我们计算该格式的方差。由于 $X_n$ 和随后的噪声项 $Z_n$ 是独立的，它们的和的方差等于它们方差的和：\n$$\n\\operatorname{Var}(X_{n+1}) = \\operatorname{Var}\\left(\\left(1 - \\frac{\\Delta t}{\\tau}\\right)X_n + \\sigma \\sqrt{\\Delta t} Z_n\\right)\n$$\n$$\n\\operatorname{Var}(X_{n+1}) = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\operatorname{Var}(X_n) + (\\sigma \\sqrt{\\Delta t})^2 \\operatorname{Var}(Z_n)\n$$\n在平稳状态下，$\\operatorname{Var}(X_{n+1}) = \\operatorname{Var}(X_n) = \\sigma^2_{\\mathrm{disc}}$，并且由于 $\\operatorname{Var}(Z_n)=1$：\n$$\n\\sigma^2_{\\mathrm{disc}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\sigma^2_{\\mathrm{disc}} + \\sigma^2 \\Delta t\n$$\n求解 $\\sigma^2_{\\mathrm{disc}}$：\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[1 - \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2\\right] = \\sigma^2 \\Delta t\n$$\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[1 - \\left(1 - 2\\frac{\\Delta t}{\\tau} + \\frac{(\\Delta t)^2}{\\tau^2}\\right)\\right] = \\sigma^2 \\Delta t\n$$\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[2\\frac{\\Delta t}{\\tau} - \\frac{(\\Delta t)^2}{\\tau^2}\\right] = \\sigma^2 \\Delta t\n$$\n假设 $\\Delta t \\neq 0$ 且过程是稳定的（这要求 $2\\frac{\\Delta t}{\\tau} - \\frac{(\\Delta t)^2}{\\tau^2} > 0$，或 $\\Delta t  2\\tau$），我们可以相除得到：\n$$\n\\sigma^2_{\\mathrm{disc}} = \\frac{\\sigma^2 \\Delta t}{\\frac{\\Delta t}{\\tau}\\left(2 - \\frac{\\Delta t}{\\tau}\\right)} = \\frac{\\sigma^2 \\tau}{2 - \\frac{\\Delta t}{\\tau}}\n$$\n因此，离散格式的平稳方差为 $\\operatorname{Var}_{\\mathrm{disc}} = \\frac{\\sigma^2 \\tau}{2 - \\Delta t/\\tau}$。\n\n现在，我们推导连续时间OU过程的平稳方差 $\\operatorname{Var}_{\\mathrm{cont}}$。令 $Y_t = X_t - \\mu$。$Y_t$ 的SDE为 $\\mathrm{d}Y_t = -\\frac{1}{\\tau}Y_t \\mathrm{d}t + \\sigma \\mathrm{d}W_t$。$X_t$ 的方差等于 $Y_t$ 的方差。我们推导二阶矩 $m_2(t) = \\mathbb{E}[Y_t^2]$ 的微分方程。对 $f(Y) = Y^2$ 使用伊藤引理，我们有 $\\mathrm{d}f(Y_t) = f'(Y_t)\\mathrm{d}Y_t + \\frac{1}{2}f''(Y_t)(\\mathrm{d}Y_t)^2$。这里，$f'(Y) = 2Y$ 且 $f''(Y) = 2$。二次变分为 $(\\mathrm{d}Y_t)^2 = \\sigma^2 \\mathrm{d}t$。\n$$\n\\mathrm{d}(Y_t^2) = 2Y_t \\left(-\\frac{1}{\\tau}Y_t \\mathrm{d}t + \\sigma \\mathrm{d}W_t\\right) + \\frac{1}{2}(2)(\\sigma^2 \\mathrm{d}t) = \\left(-\\frac{2}{\\tau}Y_t^2 + \\sigma^2\\right)\\mathrm{d}t + 2\\sigma Y_t \\mathrm{d}W_t\n$$\n取期望，并注意到伊藤积分项的期望为零（$\\mathbb{E}[2\\sigma \\int Y_s \\mathrm{d}W_s] = 0$）：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\mathbb{E}[Y_t^2] = -\\frac{2}{\\tau}\\mathbb{E}[Y_t^2] + \\sigma^2\n$$\n在平稳状态下，时间导数为零，因此 $\\frac{\\mathrm{d}m_2}{\\mathrm{d}t} = 0$。令 $m_{2,\\mathrm{ss}}$ 为平稳二阶矩。\n$$\n0 = -\\frac{2}{\\tau}m_{2,\\mathrm{ss}} + \\sigma^2 \\quad \\implies \\quad m_{2,\\mathrm{ss}} = \\frac{\\sigma^2 \\tau}{2}\n$$\n由于 $Y_t$ 的平稳均值为 $0$，其平稳方差为 $\\operatorname{Var}_{\\mathrm{cont}} = m_{2,\\mathrm{ss}} = \\frac{\\sigma^2 \\tau}{2}$。\n\n我们现在定义无量纲步长 $h \\equiv \\Delta t / \\tau$ 和相对平稳方差误差 $\\varepsilon_{\\mathrm{rel}}(h)$。\n$$\n\\operatorname{Var}_{\\mathrm{disc}}(h) = \\frac{\\sigma^2 \\tau}{2 - h}\n$$\n$$\n\\varepsilon_{\\mathrm{rel}}(h) = \\frac{\\operatorname{Var}_{\\mathrm{disc}}(h)-\\operatorname{Var}_{\\mathrm{cont}}}{\\operatorname{Var}_{\\mathrm{cont}}} = \\frac{\\frac{\\sigma^2 \\tau}{2-h} - \\frac{\\sigma^2 \\tau}{2}}{\\frac{\\sigma^2 \\tau}{2}}\n$$\n消去项 $\\frac{\\sigma^2 \\tau}{2}$：\n$$\n\\varepsilon_{\\mathrm{rel}}(h) = \\frac{\\frac{2}{2-h} - 1}{1} = \\frac{2 - (2-h)}{2-h} = \\frac{h}{2-h}\n$$\n最后，我们对给定的容差 $\\epsilon \\in (0,1)$ 施加精度要求 $\\varepsilon_{\\mathrm{rel}}(h) \\le \\epsilon$，并找到最大允许步长 $h_{\\max}$。\n$$\n\\frac{h}{2-h} \\le \\epsilon\n$$\n为使离散过程稳定，我们必须有 $h  2$，所以分母 $2-h$ 是正的。我们可以在不等式两边同乘以 $2-h$ 而不改变不等号的方向。\n$$\nh \\le \\epsilon(2-h) = 2\\epsilon - \\epsilon h\n$$\n$$\nh + \\epsilon h \\le 2\\epsilon\n$$\n$$\nh(1+\\epsilon) \\le 2\\epsilon\n$$\n由于 $1+\\epsilon > 0$，我们可以相除得到：\n$$\nh \\le \\frac{2\\epsilon}{1+\\epsilon}\n$$\n函数 $\\varepsilon_{\\mathrm{rel}}(h)$ 在 $h \\in [0, 2)$ 上是单调递增的。因此，对于所有 $h$ 直到达到等号成立的最大值，该不等式都成立。最大允许无量纲步长是：\n$$\nh_{\\max} = \\frac{2\\epsilon}{1+\\epsilon}\n$$",
            "answer": "$$\n\\boxed{\\frac{2\\epsilon}{1+\\epsilon}}\n$$"
        },
        {
            "introduction": "虽然欧拉-丸山法简单直观，但它会引入离散化偏差。对于像OU过程这样的线性随机微分方程，我们可以做得更好。本练习旨在推导OU过程单步转移的精确解析解，从而构建一个在任何时间步长下都无离散偏差的精确模拟方案。通过将此精确方法与近似的欧拉-丸山法进行对比，您将更深刻地理解OU过程的特性，并掌握一个功能强大且高度精确的模拟工具。",
            "id": "4006922",
            "problem": "在基于电导的突触噪声建模中，对于一个波动的突触变量的随机动力学，一个常见的选择是Ornstein–Uhlenbeck (OU) 过程。考虑线性随机微分方程 (SDE)\n$$\ndX_t \\;=\\; \\frac{\\mu - X_t}{\\tau}\\,dt \\;+\\; \\sigma\\, dW_t,\n$$\n其中 $X_t$ 是突触变量，$\\mu$ 是一个恒定均值，$\\tau$ 是一个正时间常数，$\\sigma$ 是一个正噪声幅度，而 $W_t$ 是一个标准Wiener过程（布朗运动）。令 $X_n \\equiv X_{t_n}$ 为在步长 $\\Delta t = t_{n+1} - t_n  0$ 的均匀网格上采样的值。定义 $\\xi_n \\sim \\mathcal{N}(0,1)$ 为独立的标准正态随机变量。\n\n根据线性SDE和Itô积分的基本性质，在时间间隔 $\\Delta t$ 内的单步转移 $X_{n} \\to X_{n+1}$ 是高斯分布的，其均值向 $\\mu$ 弛豫，方差由滤波后的白噪声驱动决定。Euler–Maruyama (EM) 方法是求解SDE的标准一阶显式时间步进格式。\n\n哪个选项正确地给出了上述OU过程的精确离散时间更新映射 $X_n \\mapsto X_{n+1}$（即分布上的精确单步转移），并根据稳态方差，正确地将其在网格时间上的离散化偏差与Euler–Maruyama格式的偏差进行了比较？\n\nA. \n$$\nX_{n+1} \\;=\\; \\mu \\;+\\; (X_n - \\mu)\\, e^{-\\Delta t/\\tau} \\;+\\; \\sigma \\sqrt{\\frac{\\tau}{2}\\Big(1 - e^{-2\\Delta t/\\tau}\\Big)}\\, \\xi_n.\n$$\n相对于精确格式，Euler–Maruyama格式的稳态方差存在量级为 $O(\\Delta t)$ 的向上偏差（大于精确值 $\\sigma^2 \\tau/2$），而精确更新对于任何 $\\Delta t  0$ 都能精确地重现稳态方差。\n\nB.\n$$\nX_{n+1} \\;=\\; \\mu \\;+\\; (X_n - \\mu)\\, e^{-\\Delta t/\\tau} \\;+\\; \\sigma \\sqrt{\\frac{1 - e^{-\\Delta t/\\tau}}{\\tau}}\\, \\xi_n.\n$$\nEuler–Maruyama格式在任何有限 $\\Delta t  0$ 下，其稳态均值或方差均不产生偏差。\n\nC.\n$$\nX_{n+1} \\;=\\; \\mu \\;+\\; (X_n - \\mu)\\, e^{-\\Delta t/\\tau} \\;+\\; \\sigma \\sqrt{\\Delta t}\\, \\xi_n.\n$$\n相对于精确值 $\\sigma^2 \\tau/2$，Euler–Maruyama格式的稳态方差存在量级为 $O(\\Delta t^2)$ 的向下偏差。\n\nD.\n$$\nX_{n+1} \\;=\\; \\mu \\;+\\; (X_n - \\mu)\\, e^{-\\Delta t/\\tau} \\;+\\; \\sigma \\sqrt{\\tau\\Big(1 - e^{-2\\Delta t/\\tau}\\Big)}\\, \\xi_n.\n$$\nEuler–Maruyama格式的稳态方差存在量级为 $O(\\Delta t)$ 的向下偏差，而精确更新的稳态均值存在量级为 $O(\\Delta t)$ 的偏差，但方差是精确的。",
            "solution": "本题要求我们求出Ornstein-Uhlenbeck (OU) 过程的精确离散时间更新法则，并分析Euler–Maruyama (EM) 格式稳态方差的离散化偏差。\n\nOrnstein-Uhlenbeck过程由以下线性随机微分方程 (SDE) 描述：\n$$\ndX_t = \\frac{\\mu - X_t}{\\tau}\\,dt + \\sigma\\,dW_t\n$$\n这个方程可以改写为：\n$$\ndX_t + \\frac{1}{\\tau} X_t \\,dt = \\frac{\\mu}{\\tau}\\,dt + \\sigma\\,dW_t\n$$\n这是一个一阶线性非齐次SDE。我们可以使用积分因子来求解，对于项 $\\frac{1}{\\tau}X_t$，积分因子是 $I(t) = e^{\\int (1/\\tau) dt} = e^{t/\\tau}$。\n将SDE乘以积分因子 $e^{t/\\tau}$，我们可以使用Itô乘积法则将左边写成一个全微分：$d(f(t)X_t) = f'(t)X_t dt + f(t)dX_t$。\n$$\ne^{t/\\tau} dX_t + \\frac{1}{\\tau} e^{t/\\tau} X_t \\,dt = d(X_t e^{t/\\tau})\n$$\n因此，SDE变为：\n$$\nd(X_t e^{t/\\tau}) = \\frac{\\mu}{\\tau} e^{t/\\tau}\\,dt + \\sigma e^{t/\\tau}\\,dW_t\n$$\n我们将此方程从时间 $t_n$ 积分到 $t_{n+1} = t_n + \\Delta t$：\n$$\n\\int_{t_n}^{t_{n+1}} d(X_s e^{s/\\tau}) = \\int_{t_n}^{t_{n+1}} \\frac{\\mu}{\\tau} e^{s/\\tau}\\,ds + \\int_{t_n}^{t_{n+1}} \\sigma e^{s/\\tau}\\,dW_s\n$$\n$$\nX_{t_{n+1}}e^{t_{n+1}/\\tau} - X_{t_n}e^{t_n/\\tau} = \\frac{\\mu}{\\tau} \\left[ \\tau e^{s/\\tau} \\right]_{t_n}^{t_{n+1}} + \\sigma \\int_{t_n}^{t_{n+1}} e^{s/\\tau}\\,dW_s\n$$\n$$\nX_{t_{n+1}}e^{t_{n+1}/\\tau} - X_{t_n}e^{t_n/\\tau} = \\mu (e^{t_{n+1}/\\tau} - e^{t_n/\\tau}) + \\sigma \\int_{t_n}^{t_{n+1}} e^{s/\\tau}\\,dW_s\n$$\n为了解出 $X_{t_{n+1}}$，我们将整个方程乘以 $e^{-t_{n+1}/\\tau}$：\n$$\nX_{t_{n+1}} - X_{t_n}e^{(t_n-t_{n+1})/\\tau} = \\mu(1 - e^{(t_n-t_{n+1})/\\tau}) + \\sigma \\int_{t_n}^{t_{n+1}} e^{(s-t_{n+1})/\\tau}\\,dW_s\n$$\n代入 $t_{n+1} - t_n = \\Delta t$ 并使用记号 $X_n = X_{t_n}$：\n$$\nX_{n+1} = X_n e^{-\\Delta t/\\tau} + \\mu(1 - e^{-\\Delta t/\\tau}) + \\sigma \\int_{t_n}^{t_{n+1}} e^{(s-t_{n+1})/\\tau}\\,dW_s\n$$\n重新整理各项：\n$$\nX_{n+1} = \\mu + (X_n - \\mu)e^{-\\Delta t/\\tau} + \\sigma \\int_{t_n}^{t_{n+1}} e^{(s-t_{n+1})/\\tau}\\,dW_s\n$$\n最后一项是一个确定性函数关于Wiener过程的Itô积分。这个积分代表一个均值为$0$的高斯随机变量，其方差等于该确定性函数平方的积分。\n随机项的方差是：\n$$\nV = \\text{Var}\\left( \\sigma \\int_{t_n}^{t_{n+1}} e^{(s-t_{n+1})/\\tau}\\,dW_s \\right) = \\sigma^2 \\int_{t_n}^{t_{n+1}} \\left( e^{(s-t_{n+1})/\\tau} \\right)^2 ds = \\sigma^2 \\int_{t_n}^{t_{n+1}} e^{2(s-t_{n+1})/\\tau}\\,ds\n$$\n我们进行积分：\n$$\nV = \\sigma^2 \\left[ \\frac{\\tau}{2} e^{2(s-t_{n+1})/\\tau} \\right]_{t_n}^{t_{n+1}} = \\frac{\\sigma^2 \\tau}{2} \\left( e^0 - e^{2(t_n-t_{n+1})/\\tau} \\right) = \\frac{\\sigma^2 \\tau}{2} \\left( 1 - e^{-2\\Delta t/\\tau} \\right)\n$$\n因此，随机项是一个均值为$0$、方差为$V$的高斯随机变量。我们可以将其写为 $\\sqrt{V}\\xi_n$，其中 $\\xi_n \\sim \\mathcal{N}(0,1)$。\n因此，精确的离散时间更新法则是：\n$$\nX_{n+1} = \\mu + (X_n - \\mu) e^{-\\Delta t/\\tau} + \\sigma \\sqrt{\\frac{\\tau}{2}\\left(1 - e^{-2\\Delta t/\\tau}\\right)}\\, \\xi_n\n$$\n这是一个1阶自回归过程 (AR(1))。其稳态均值 $E[X_\\infty]$ 和稳态方差 $\\text{Var}(X_\\infty)$ 可以计算得出。由 $E[X_{n+1}] = E[X_n] = E[X_\\infty]$，我们得到 $E[X_\\infty] = \\mu$。由 $\\text{Var}(X_{n+1}) = \\text{Var}(X_n) = \\text{Var}(X_\\infty)$，我们得到：\n$$\n\\text{Var}(X_\\infty) = (e^{-\\Delta t/\\tau})^2 \\text{Var}(X_\\infty) + \\frac{\\sigma^2 \\tau}{2} \\left( 1 - e^{-2\\Delta t/\\tau} \\right)\n$$\n$$\n\\text{Var}(X_\\infty) (1 - e^{-2\\Delta t/\\tau}) = \\frac{\\sigma^2 \\tau}{2} \\left( 1 - e^{-2\\Delta t/\\tau} \\right) \\implies \\text{Var}(X_\\infty) = \\frac{\\sigma^2 \\tau}{2}\n$$\n对于任何时间步长 $\\Delta t > 0$，该精确更新格式都能精确地重现连续OU过程的稳态均值 $\\mu$ 和稳态方差 $\\sigma^2 \\tau/2$。\n\n接下来，我们分析Euler-Maruyama (EM) 格式。SDE的EM离散化是：\n$$\nX_{n+1} = X_n + \\frac{\\mu - X_n}{\\tau}\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n\n$$\n重新整理得到另一个AR(1)过程：\n$$\nX_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)X_n + \\frac{\\mu \\Delta t}{\\tau} + \\sigma \\sqrt{\\Delta t}\\,\\xi_n\n$$\n为使此格式稳定，我们需要 $|1 - \\Delta t/\\tau|  1$，这意味着 $0  \\Delta t  2\\tau$。\n稳态均值 $E[X_\\infty]_{EM}$ 是：\n$$\nE[X_\\infty]_{EM} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)E[X_\\infty]_{EM} + \\frac{\\mu \\Delta t}{\\tau} \\implies E[X_\\infty]_{EM}\\left(\\frac{\\Delta t}{\\tau}\\right) = \\frac{\\mu \\Delta t}{\\tau} \\implies E[X_\\infty]_{EM} = \\mu\n$$\nEM格式能够精确地重现稳态均值（如果稳定）。\n稳态方差 $\\text{Var}(X_\\infty)_{EM}$ 是：\n$$\n\\text{Var}(X_\\infty)_{EM} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\text{Var}(X_\\infty)_{EM} + \\text{Var}(\\sigma \\sqrt{\\Delta t}\\,\\xi_n)\n$$\n$$\n\\text{Var}(X_\\infty)_{EM}\\left(1 - \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2\\right) = \\sigma^2 \\Delta t\n$$\n$$\n\\text{Var}(X_\\infty)_{EM}\\left(1 - \\left(1 - \\frac{2\\Delta t}{\\tau} + \\frac{\\Delta t^2}{\\tau^2}\\right)\\right) = \\sigma^2 \\Delta t\n$$\n$$\n\\text{Var}(X_\\infty)_{EM}\\left(\\frac{2\\Delta t}{\\tau} - \\frac{\\Delta t^2}{\\tau^2}\\right) = \\sigma^2 \\Delta t\n$$\n$$\n\\text{Var}(X_\\infty)_{EM} = \\frac{\\sigma^2 \\Delta t}{\\frac{\\Delta t}{\\tau}\\left(2 - \\frac{\\Delta t}{\\tau}\\right)} = \\frac{\\sigma^2 \\tau}{2 - \\frac{\\Delta t}{\\tau}}\n$$\n将EM的稳态方差与精确方差 $V_{exact} = \\sigma^2\\tau/2$ 进行比较：\n由于 $\\Delta t/\\tau > 0$，分母 $2 - \\Delta t/\\tau  2$，所以 $\\text{Var}(X_\\infty)_{EM} > \\sigma^2\\tau/2$。EM格式高估了方差，产生了一个向上的偏差。\n为了找到小 $\\Delta t$ 时偏差的阶数，我们进行泰勒展开：\n$$\n\\text{Var}(X_\\infty)_{EM} = \\frac{\\sigma^2 \\tau}{2} \\left( \\frac{1}{1 - \\frac{\\Delta t}{2\\tau}} \\right) \\approx \\frac{\\sigma^2 \\tau}{2} \\left( 1 + \\frac{\\Delta t}{2\\tau} + O(\\Delta t^2) \\right) = \\frac{\\sigma^2 \\tau}{2} + \\frac{\\sigma^2 \\Delta t}{4} + O(\\Delta t^2)\n$$\n偏差为 $\\text{Var}(X_\\infty)_{EM} - V_{exact} = \\frac{\\sigma^2 \\Delta t}{4} + O(\\Delta t^2)$，这是一个量级为 $O(\\Delta t)$ 的向上偏差。\n\n现在我们评估给出的选项：\n\n**A.** 更新公式为 $X_{n+1} = \\mu + (X_n - \\mu)\\, e^{-\\Delta t/\\tau} + \\sigma \\sqrt{\\frac{\\tau}{2}(1 - e^{-2\\Delta t/\\tau})}\\, \\xi_n$。这与我们推导出的精确更新法则相符。该陈述声称EM的稳态方差存在量级为 $O(\\Delta t)$ 的向上偏差，且大于精确方差 $\\sigma^2 \\tau/2$，而精确格式能精确地重现方差。这与我们的分析完全一致。\n**结论：正确**\n\n**B.** 更新公式为 $X_{n+1} = \\mu + (X_n - \\mu)\\, e^{-\\Delta t/\\tau} + \\sigma \\sqrt{\\frac{1 - e^{-\\Delta t/\\tau}}{\\tau}}\\, \\xi_n$。噪声项不正确。此噪声项的方差 $\\sigma^2 (1 - e^{-\\Delta t/\\tau})/\\tau$ 在量纲上不一致（单位是 $[X]^2/\\text{time}^2$ 而不是 $[X]^2$）。该陈述声称EM在方差上没有偏差，这是错误的。\n**结论：不正确**\n\n**C.** 更新公式为 $X_{n+1} = \\mu + (X_n - \\mu)\\, e^{-\\Delta t/\\tau} + \\sigma \\sqrt{\\Delta t}\\, \\xi_n$。这个公式错误地将精确解的漂移项与EM格式的扩散项结合在一起。它不是精确更新。该陈述声称EM方差存在量级为 $O(\\Delta t^2)$ 的向下偏差，这是错误的；偏差是向上的，且量级为 $O(\\Delta t)$。\n**结论：不正确**\n\n**D.** 更新公式为 $X_{n+1} = \\mu + (X_n - \\mu)\\, e^{-\\Delta t/\\tau} + \\sigma \\sqrt{\\tau(1 - e^{-2\\Delta t/\\tau})}\\, \\xi_n$。这是不正确的，因为噪声方差是正确值的两倍（平方根内缺少一个因子 $1/2$）。该陈述声称EM方差存在向下偏差（错误），并且精确更新的均值存在偏差（错误）。\n**结论：不正确**\n\n基于详细的推导和分析，只有选项A在所有方面都是正确的。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论模型的最终价值在于其与实验数据的联系。本练习将引导您从模拟世界走向实际应用，解决一个从实验数据中估计模型参数的典型问题。您将面对一个现实场景：从混杂着随机释放和记录噪声的微小兴奋性突触后电流（mEPSCs）观测数据中，估计潜在OU过程的参数。这项实践的核心是运用概率论（如全期望和全方差公式）将可观测的统计量与底层模型参数联系起来，这是连接抽象理论与复杂实验现实的关键一步，也是计算神经科学家必备的建模技能。",
            "id": "4006846",
            "problem": "在大脑建模和计算神经科学的背景下，您将面临一项与突触噪声相关的建模任务，该噪声由一个奥恩斯坦-乌伦贝克过程表示。微型兴奋性突触后电流 (mEPSCs) 被建模为源于一个伴随记录噪声的潜在突触电导过程。请使用第一性原理，基于可观测的分布统计量和释放概率，推导出奥恩斯坦-乌伦贝克过程参数的估计量。\n\n请从以下基础和假设出发：\n\n- 潜在突触电导 $g(t)$ 服从奥恩斯坦-乌伦贝克随机微分方程\n$$\n\\mathrm{d}g(t) = -\\frac{1}{\\tau}\\left(g(t)-\\mu\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\n其中 $W(t)$ 是一个标准维纳过程（布朗运动），$\\mu$、$\\sigma$、$\\tau$ 是常数参数。$g(t)$ 的稳态分布是均值为 $\\mu$、方差依赖于 $\\sigma$ 和 $\\tau$ 的高斯分布。\n- 在每次试验中，释放事件以概率 $p$ 发生，且各次试验间独立。令 $I\\in\\{0,1\\}$ 为伯努利指示变量，其中 $\\mathbb{P}(I=1)=p$。在 $I=1$ 的条件下，观测到的 mEPSC 振幅被建模为 $X=G+\\varepsilon$；在 $I=0$ 的条件下，建模为 $X=\\varepsilon$，其中 $G$ 是从奥恩斯坦-乌伦贝克过程的稳态中抽取的一个样本，而 $\\varepsilon$ 是独立的加性记录噪声。\n- 记录噪声 $\\varepsilon$ 被建模为均值为零、已知方差为 $v_n$ 的高斯分布，它在各次试验间独立，并且独立于 $G$。\n- 在 $I=1$ 的试验中，由试验间期 $\\Delta t$ 分隔的连续试验的振幅，由于潜在的奥恩斯坦-乌伦贝克过程的自相关性和加性噪声而表现出相关性。\n\n对于每个测试用例，您将获得以下信息：\n- 释放概率 $p$（无单位，以小数形式表示）。\n- 记录噪声方差 $v_n$，单位为皮安的平方 (pA$^2$)。\n- 试验间期 $\\Delta t$，单位为毫秒 (ms)。\n- 所有试验的观测振幅均值 $m_{\\mathrm{obs}}$，单位为皮安 (pA)。\n- 所有试验的观测振幅方差 $s^2_{\\mathrm{obs}}$，单位为皮安的平方 (pA$^2$)。\n- 观测到的条件皮尔逊相关系数 $r_{\\mathrm{obs}}$（无单位），该系数在两次连续试验的振幅之间计算的，且仅限于两次试验都发生释放事件（即两次试验中均为 $I=1$）的试验对。\n\n您的任务：\n1. 根据所述假设、奥恩斯坦-乌伦贝克过程的稳态性质和独立性结构，推导将可观测统计量 $m_{\\mathrm{obs}}$、$s^2_{\\mathrm{obs}}$、$r_{\\mathrm{obs}}$ 与参数 $\\mu$、$\\sigma$ 和 $\\tau$ 联系起来的表达式，并明确地考虑由随机释放引起的混合模型以及加性记录噪声。\n2. 使用这些推导出的关系式，从 $(p,v_n,\\Delta t,m_{\\mathrm{obs}},s^2_{\\mathrm{obs}},r_{\\mathrm{obs}})$ 计算参数估计值 $(\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau})$。\n\n单位与输出：\n- 报告 $\\widehat{\\mu}$，单位为皮安 (pA)。\n- 报告 $\\widehat{\\sigma}$，单位为皮安每平方根毫秒 (pA$/\\sqrt{\\mathrm{ms}})$。\n- 报告 $\\widehat{\\tau}$，单位为毫秒 (ms)。\n- 对于数值输出，不应包含单位字符串；数值必须是四舍五入到六位小数的浮点数。\n\n测试套件：\n为以下每个参数集计算 $(\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau})$。所有量均以上述指定的相应单位给出，数值以小数形式书写。\n\n- 情况 1: $p=0.35$, $v_n=9$, $\\Delta t=2$, $m_{\\mathrm{obs}}=4.2$, $s^2_{\\mathrm{obs}}=58.56$, $r_{\\mathrm{obs}}=0.603108$。\n- 情况 2: $p=0.05$, $v_n=4$, $\\Delta t=5$, $m_{\\mathrm{obs}}=0.4$, $s^2_{\\mathrm{obs}}=9.29$, $r_{\\mathrm{obs}}=0.557019$。\n- 情况 3: $p=0.95$, $v_n=1$, $\\Delta t=1$, $m_{\\mathrm{obs}}=4.75$, $s^2_{\\mathrm{obs}}=7.8875$, $r_{\\mathrm{obs}}=0.614169$。\n- 情况 4: $p=0.4$, $v_n=100$, $\\Delta t=4$, $m_{\\mathrm{obs}}=6.0$, $s^2_{\\mathrm{obs}}=211.6$, $r_{\\mathrm{obs}}=0.358000$。\n- 情况 5: $p=0.5$, $v_n=10$, $\\Delta t=20$, $m_{\\mathrm{obs}}=3.5$, $s^2_{\\mathrm{obs}}=27.25$, $r_{\\mathrm{obs}}=0.183940$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身是包含三个浮点数 $[\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau}]$ 的列表，按指定顺序对应上述五个情况。例如，最终输出格式必须类似于\n$[[\\widehat{\\mu}_1,\\widehat{\\sigma}_1,\\widehat{\\tau}_1],[\\widehat{\\mu}_2,\\widehat{\\sigma}_2,\\widehat{\\tau}_2],\\dots]$\n所有数值都四舍五入到六位小数，且不包含单位字符串。",
            "solution": "任务是从一组可观测统计量中推导出奥恩斯坦-乌伦贝克 (OU) 过程参数 $(\\mu, \\sigma, \\tau)$ 的估计量。推导过程基于所提供的模型假设，从第一性原理出发。\n\n潜在突触电导 $g(t)$ 由奥恩斯坦-乌伦贝克随机微分方程描述：\n$$\n\\mathrm{d}g(t) = -\\frac{1}{\\tau}\\left(g(t)-\\mu\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)\n$$\n这个过程是基础性的。其在稳态下的关键统计特性如下：\n1.  $g(t)$ 的平稳分布（我们用随机变量 $G$ 表示）是一个高斯分布，$G \\sim \\mathcal{N}(\\mu, v_g)$。\n2.  该分布的均值为 $\\mathbb{E}[G] = \\mu$。\n3.  方差 $v_g = \\mathrm{Var}(G)$ 是过程参数的函数：$v_g = \\frac{\\sigma^2 \\tau}{2}$。\n4.  时间延迟为 $\\Delta t$ 时的自相关函数为 $\\mathrm{Corr}(g(t), g(t+\\Delta t)) = e^{-\\Delta t/\\tau}$，由此可得自协方差为 $\\mathrm{Cov}(g(t), g(t+\\Delta t)) = \\mathrm{Var}(G) e^{-\\Delta t/\\tau} = v_g e^{-\\Delta t/\\tau}$。\n\n观测到的 mEPSC 振幅 $X$ 被建模为一个反映随机突触释放的混合模型。释放事件以概率 $p$ 发生，由伯努利变量 $I \\sim \\mathrm{Bernoulli}(p)$ 指示。如果发生释放 ($I=1$)，观测振幅为 $X = G + \\varepsilon$；如果释放失败 ($I=0$)，则为 $X = \\varepsilon$。记录噪声 $\\varepsilon$ 独立于信号 $G$，并服从高斯分布 $\\varepsilon \\sim \\mathcal{N}(0, v_n)$。这可以简洁地写成 $X = I \\cdot G + \\varepsilon$。\n\n我们通过将 $X$ 的理论矩与观测统计量（$m_{\\mathrm{obs}}$、$s^2_{\\mathrm{obs}}$、$r_{\\mathrm{obs}}$）联系起来，来推导这些估计量。\n\n**第 1 步：平均电导 $\\mu$ 的估计量推导**\n\n我们将观测到的平均振幅 $m_{\\mathrm{obs}}$ 与 $\\mu$ 联系起来。对 $X = I \\cdot G + \\varepsilon$ 使用全期望定律：\n$$\nm_{\\mathrm{obs}} = \\mathbb{E}[X] = \\mathbb{E}[I \\cdot G + \\varepsilon]\n$$\n由于 $I$、$G$ 和 $\\varepsilon$ 的独立性，以及 $\\mathbb{E}[\\varepsilon]=0$：\n$$\nm_{\\mathrm{obs}} = \\mathbb{E}[I] \\mathbb{E}[G] + \\mathbb{E}[\\varepsilon] = p \\cdot \\mu + 0 = p\\mu\n$$\n这提供了一个直接的关系。求解 $\\mu$，我们得到其估计量：\n$$\n\\widehat{\\mu} = \\frac{m_{\\mathrm{obs}}}{p}\n$$\n\n**第 2 步：潜在方差 $v_g$ 的推导**\n\n我们将观测方差 $s^2_{\\mathrm{obs}}$ 与潜在方差 $v_g$ 联系起来。对 $X$ 使用全方差定律：\n$$\ns^2_{\\mathrm{obs}} = \\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X|I)] + \\mathrm{Var}(\\mathbb{E}[X|I])\n$$\n我们分别计算每一项。\n对于第一项 $\\mathbb{E}[\\mathrm{Var}(X|I)]$：\n-   在 $I=1$ 条件下：$X = G+\\varepsilon$。由于 $G$ 和 $\\varepsilon$ 独立，$\\mathrm{Var}(X|I=1) = \\mathrm{Var}(G) + \\mathrm{Var}(\\varepsilon) = v_g + v_n$。\n-   在 $I=0$ 条件下：$X = \\varepsilon$。因此，$\\mathrm{Var}(X|I=0) = \\mathrm{Var}(\\varepsilon) = v_n$。\n因此，该期望为：\n$$\n\\mathbb{E}[\\mathrm{Var}(X|I)] = \\mathrm{Var}(X|I=1)\\cdot p + \\mathrm{Var}(X|I=0)\\cdot(1-p) = (v_g + v_n)p + v_n(1-p) = p v_g + v_n\n$$\n对于第二项 $\\mathrm{Var}(\\mathbb{E}[X|I])$：\n-   在 $I=1$ 条件下：$\\mathbb{E}[X|I=1] = \\mathbb{E}[G+\\varepsilon] = \\mu+0 = \\mu$。\n-   在 $I=0$ 条件下：$\\mathbb{E}[X|I=0] = \\mathbb{E}[\\varepsilon] = 0$。\n随机变量 $\\mathbb{E}[X|I]$ 以概率 $p$ 取值 $\\mu$，以概率 $1-p$ 取值 $0$。这个类伯努利变量的方差为：\n$$\n\\mathrm{Var}(\\mathbb{E}[X|I]) = \\mathbb{E}[(\\mathbb{E}[X|I])^2] - (\\mathbb{E}[\\mathbb{E}[X|I]])^2 = (\\mu^2 p + 0^2(1-p)) - (p\\mu)^2 = p\\mu^2 - p^2\\mu^2 = p(1-p)\\mu^2\n$$\n合并这两项，总方差为：\n$$\ns^2_{\\mathrm{obs}} = (p v_g + v_n) + p(1-p)\\mu^2\n$$\n求解 $v_g$，我们通过代入 $\\widehat{\\mu}$ 得到估计量 $\\widehat{v_g}$：\n$$\n\\widehat{v_g} = \\frac{s^2_{\\mathrm{obs}} - v_n - p(1-p)\\widehat{\\mu}^2}{p} = \\frac{1}{p}\\left(s^2_{\\mathrm{obs}} - v_n - p(1-p)\\left(\\frac{m_{\\mathrm{obs}}}{p}\\right)^2\\right) = \\frac{1}{p}\\left(s^2_{\\mathrm{obs}} - v_n - \\frac{1-p}{p}m_{\\mathrm{obs}}^2\\right)\n$$\n\n**第 3 步：时间常数 $\\tau$ 的估计量推导**\n\n观测相关系数 $r_{\\mathrm{obs}}$ 与 $\\tau$ 相关。该相关系数是在两次连续试验（比如 $X_1$ 和 $X_2$，时间间隔为 $\\Delta t$）的振幅之间计算的，条件是两次试验都发生了释放事件（$I_1=1, I_2=1$）。\n令 $X'_1 = X_1|_{I_1=1} = G_1+\\varepsilon_1$ 且 $X'_2 = X_2|_{I_2=1} = G_2+\\varepsilon_2$。\n$$\nr_{\\mathrm{obs}} = \\mathrm{Corr}(X'_1, X'_2) = \\frac{\\mathrm{Cov}(X'_1, X'_2)}{\\sqrt{\\mathrm{Var}(X'_1)\\mathrm{Var}(X'_2)}}\n$$\n分母中的方差为 $\\mathrm{Var}(X'_1) = \\mathrm{Var}(G_1+\\varepsilon_1) = \\mathrm{Var}(G_1)+\\mathrm{Var}(\\varepsilon_1) = v_g + v_n$。\n分子中的协方差为 $\\mathrm{Cov}(G_1+\\varepsilon_1, G_2+\\varepsilon_2)$。鉴于 $\\varepsilon_1, \\varepsilon_2$ 相互独立且独立于潜在过程 $G$，该式可简化为：\n$$\n\\mathrm{Cov}(G_1, G_2) + \\mathrm{Cov}(G_1, \\varepsilon_2) + \\mathrm{Cov}(\\varepsilon_1, G_2) + \\mathrm{Cov}(\\varepsilon_1, \\varepsilon_2) = \\mathrm{Cov}(G_1, G_2) = v_g e^{-\\Delta t/\\tau}\n$$\n将这些代入相关系数公式：\n$$\nr_{\\mathrm{obs}} = \\frac{v_g e^{-\\Delta t/\\tau}}{v_g + v_n}\n$$\n我们首先分离指数项来求解 $\\tau$：\n$$\ne^{-\\Delta t/\\tau} = r_{\\mathrm{obs}} \\frac{v_g + v_n}{v_g} = r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{v_g}\\right)\n$$\n对两边取自然对数：\n$$\n-\\frac{\\Delta t}{\\tau} = \\ln\\left(r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{v_g}\\right)\\right)\n$$\n这就得到了 $\\tau$ 的估计量：\n$$\n\\widehat{\\tau} = -\\frac{\\Delta t}{\\ln\\left(r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{\\widehat{v_g}}\\right)\\right)}\n$$\n\n**第 4 步：噪声振幅 $\\sigma$ 的估计量推导**\n\n最后，我们使用定义关系式 $v_g = \\frac{\\sigma^2 \\tau}{2}$ 来求解 $\\sigma$。重排公式得到 $\\sigma^2 = \\frac{2v_g}{\\tau}$。取平方根得到 $\\sigma$ 的估计量：\n$$\n\\widehat{\\sigma} = \\sqrt{\\frac{2\\widehat{v_g}}{\\widehat{\\tau}}}\n$$\n参数 $\\sigma$ 必须为非负值，因此我们取正根。至此，所有三个未知参数的推导全部完成。\n\n计算过程是，对每个测试用例，使用所提供的可观测统计量，依次应用这四个推导出的公式。\n下面是一个Python代码示例，用于计算这些值：\n```python\nimport numpy as np\nimport math\n\ndef solve_ou_params(p, v_n, delta_t, m_obs, s2_obs, r_obs):\n    \"\"\"\n    Computes Ornstein-Uhlenbeck process parameters from observable statistics.\n    \"\"\"\n    # Step 1: Estimate mu\n    if p == 0: return [float('nan'), float('nan'), float('nan')]\n    mu_hat = m_obs / p\n\n    # Step 2: Estimate latent variance v_g\n    term_mu_sq = ((1 - p) / p) * (m_obs ** 2)\n    v_g_hat = (s2_obs - v_n - term_mu_sq) / p\n    if v_g_hat = 0: return [round(mu_hat, 6), float('nan'), float('nan')]\n\n    # Step 3: Estimate time constant tau\n    log_arg = r_obs * (1 + v_n / v_g_hat)\n    if log_arg = 0 or log_arg >= 1:\n        tau_hat = float('nan')\n    else:\n        tau_hat = -delta_t / np.log(log_arg)\n    \n    if math.isnan(tau_hat) or tau_hat = 0:\n        sigma_hat = float('nan')\n    else:\n        # Step 4: Estimate noise amplitude sigma\n        sigma_hat = math.sqrt(2 * v_g_hat / tau_hat)\n\n    return [round(mu_hat, 6), round(sigma_hat, 6), round(tau_hat, 6)]\n\n# Example usage for one case:\n# p, v_n, delta_t, m_obs, s2_obs, r_obs = (0.35, 9.0, 2.0, 4.2, 58.56, 0.603108)\n# print(solve_ou_params(p, v_n, delta_t, m_obs, s2_obs, r_obs))\n```",
            "answer": "[[12.000000,4.003553,5.989394],[8.000000,3.000000,10.000000],[5.000000,2.000000,2.000000],[15.000000,5.000000,8.000000],[7.000000,1.000000,10.000000]]"
        }
    ]
}