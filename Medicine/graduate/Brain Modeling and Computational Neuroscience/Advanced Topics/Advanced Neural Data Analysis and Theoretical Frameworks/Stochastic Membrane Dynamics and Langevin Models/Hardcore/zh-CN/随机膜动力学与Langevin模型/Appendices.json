{
    "hands_on_practices": [
        {
            "introduction": "在随机神经动力学建模中，一个关键的初始步骤是将物理概念（如具有特定统计特性的噪声电流）准确地转化为随机微分方程（SDE）的数学语言。本练习旨在帮助您掌握这一核心技能，通过推导物理噪声强度 $D$ 与伊藤随机微分方程中噪声项幅度 $\\sigma$ 之间的关系，从而在物理直觉和数学形式之间建立一座桥梁 ()。",
            "id": "4022817",
            "problem": "考虑一个单室无源神经元膜，其电容为 $C$，漏电导为 $g_{L}$，漏电逆转电位为 $E_{L}$。膜电位 $V(t)$ 遵循电容定律 $C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$，其中总电流 $I_{\\mathrm{tot}}(t)$ 由一个确定性分量和一个附加的零均值高斯白电流噪声 $\\xi(t)$ 组成。设确定性分量由 $I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L})$ 给出，并假设噪声的自相关为 $\\langle \\xi(t)\\,\\xi(t') \\rangle = 2D\\,\\delta(t - t')$，其中 $D$ 是电流噪声强度，$\\delta(\\cdot)$ 是Dirac δ函数。假设相应的随机膜方程被写成Itō形式的随机微分方程(SDE)如下：\n$$\ndV = a(V,t)\\,dt + \\sigma\\,dW_{t},\n$$\n其中 $a(V,t)$ 是确定性漂移，$\\sigma$ 是噪声振幅，$W_{t}$ 是标准Wiener过程（布朗运动）。仅使用将高斯白噪声与标准Wiener过程的增量联系起来的基本原理，以及电容定律 $C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$，推导出振幅 $\\sigma$ 关于 $D$ 和 $C$ 的封闭形式解析表达式，假设噪声以 $\\xi(t)/C$ 的形式进入电压方程。将您的最终答案表示为单个解析表达式。无需进行数值计算。",
            "solution": "该问题要求基于无源神经元膜的底层物理描述，推导其随机微分方程(SDE)表示中的噪声振幅 $\\sigma$。\n\n首先，我们对问题陈述进行形式化验证。\n\n### 步骤1：提取已知条件\n- 一个单室无源神经元膜，具有电容 $C$、漏电导 $g_L$ 和漏电逆转电位 $E_L$。\n- 膜电位 $V(t)$ 的控制方程是电容定律：$C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$。\n- 总电流为 $I_{\\mathrm{tot}}(t) = I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) + \\xi(t)$。\n- 噪声 $\\xi(t)$ 是一个零均值高斯白电流噪声。\n- 噪声的自相关由 $\\langle \\xi(t)\\,\\xi(t') \\rangle = 2D\\,\\delta(t - t')$ 给出，其中 $D$ 是电流噪声强度，$\\delta(\\cdot)$ 是Dirac δ函数。\n- 对应的电压随机过程表示为一个Itō SDE：$dV = a(V,t)\\,dt + \\sigma\\,dW_{t}$，其中 $a(V,t)$ 是漂移，$\\sigma$ 是噪声振幅，$W_t$ 是一个标准Wiener过程。\n- 明确假设噪声项以 $\\xi(t)/C$ 的形式进入电压方程。\n- 目标是找到用 $D$ 和 $C$ 表示 $\\sigma$ 的封闭形式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是计算神经科学中的一个标准练习，代表了膜电位的Ornstein-Uhlenbeck过程。该模型基于电路理论（电容定律，漏电流的欧姆定律）和随机微积分的基本原理。所有组成部分在该领域都是公认的。\n- **适定性：** 该问题提供了一套完整的定义和关系，可以从参数 $D$ 和 $C$ 唯一确定参数 $\\sigma$。\n- **客观性：** 该问题使用精确的数学和物理术语陈述，没有歧义或主观论断。\n- **结论：** 该问题是有效的，因为它是科学合理的、自洽的并且是适定的。验证清单中列出的缺陷均不存在。\n\n### 步骤3：裁定与行动\n该问题有效。我们继续进行求解。\n\n### 推导\n我们从给定的膜电位 $V(t)$ 的电容定律开始：\n$$\nC\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)\n$$\n代入总电流 $I_{\\mathrm{tot}}(t)$ 的表达式：\n$$\nC\\,\\frac{dV}{dt} = I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) + \\xi(t)\n$$\n为了得到电压变化率 $\\frac{dV}{dt}$ 的方程，我们两边除以电容 $C$：\n$$\n\\frac{dV}{dt} = \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right) + \\frac{\\xi(t)}{C}\n$$\n这是一个Langevin方程。等式右边的第一项是确定性部分，第二项 $\\frac{\\xi(t)}{C}$ 是随机部分。\n\n为了将其形式化为Itō随机微分方程(SDE)，我们乘以一个无穷小的时间增量 $dt$。这得到了非正式的表达式：\n$$\ndV = \\left[ \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right) \\right] dt + \\frac{\\xi(t)}{C} dt\n$$\n我们已知该方程对应于Itō SDE形式：\n$$\ndV = a(V,t)\\,dt + \\sigma\\,dW_{t}\n$$\n通过比较这两种形式，我们可以确定漂移项 $a(V,t)$ 以及噪声项之间的关系。漂移项是：\n$$\na(V,t) = \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right)\n$$\n随机分量必须等价：\n$$\n\\sigma\\,dW_{t} = \\frac{\\xi(t)}{C} dt\n$$\n最后一个表达式是一个形式上的认定，它将Wiener过程的无穷小增量 $dW_t$ 与白噪声过程和 $dt$ 的未严格定义乘积联系起来。为了使这个关系严谨并求出 $\\sigma$，我们必须比较两边的统计特性，特别是它们在一个小时间间隔 $\\Delta t$ 内的方差。\n\n我们首先分析Itō形式。在一个时间间隔 $\\Delta t$ 内的随机增量是 $\\Delta V_{\\text{stoch}} = \\sigma \\Delta W_t$，其中 $\\Delta W_t = W_{t+\\Delta t} - W_t$。一个标准Wiener过程 $W_t$ 的增量 $\\Delta W_t$ 服从均值为0，方差为 $\\Delta t$ 的正态分布。\n$$\n\\langle \\Delta W_t \\rangle = 0\n$$\n$$\n\\text{Var}(\\Delta W_t) = \\langle (\\Delta W_t)^2 \\rangle - (\\langle \\Delta W_t \\rangle)^2 = \\langle (\\Delta W_t)^2 \\rangle = \\Delta t\n$$\n因此，来自SDE的随机电压增量的方差是：\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\langle (\\sigma \\Delta W_t)^2 \\rangle = \\sigma^2 \\langle (\\Delta W_t)^2 \\rangle = \\sigma^2 \\Delta t\n$$\n\n接下来，我们分析Langevin形式。在一个时间间隔 $\\Delta t$ 内的随机电压增量是通过对噪声项积分得到的：\n$$\n\\Delta V_{\\text{stoch}} = \\int_t^{t+\\Delta t} \\frac{\\xi(s)}{C} ds = \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s) ds\n$$\n这个增量的方差是：\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\left\\langle \\left( \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s) ds \\right) \\left( \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s') ds' \\right) \\right\\rangle\n$$\n$$\n= \\frac{1}{C^2} \\left\\langle \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, \\xi(s) \\xi(s') \\right\\rangle\n$$\n我们可以将期望算子移到积分内部：\n$$\n= \\frac{1}{C^2} \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, \\langle \\xi(s) \\xi(s') \\rangle\n$$\n我们已知白噪声的自相关为：$\\langle \\xi(s) \\xi(s') \\rangle = 2D\\,\\delta(s - s')$。将其代入表达式中得到：\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{1}{C^2} \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, (2D\\,\\delta(s - s'))\n$$\n我们首先对 $s'$ 计算内层积分。Dirac delta函数 $\\delta(s-s')$ 的筛选性质意味着积分仅在 $s'=s$ 处非零。\n$$\n\\int_t^{t+\\Delta t} 2D\\,\\delta(s - s') ds' = 2D\n$$\n这是成立的，因为 $s$ 在区间 $[t, t+\\Delta t]$ 内，所以点 $s'=s$ 总是在积分域内。\n将此结果代回外层积分得到：\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{1}{C^2} \\int_t^{t+\\Delta t} 2D \\, ds = \\frac{2D}{C^2} \\int_t^{t+\\Delta t} ds\n$$\n计算最后的简单积分：\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{2D}{C^2} [s]_t^{t+\\Delta t} = \\frac{2D}{C^2} ( (t+\\Delta t) - t ) = \\frac{2D}{C^2} \\Delta t\n$$\n现在，我们将随机电压增量在 $\\Delta t$ 内的方差的两个表达式相等：\n$$\n\\sigma^2 \\Delta t = \\frac{2D}{C^2} \\Delta t\n$$\n两边同时除以 $\\Delta t$ (对于 $\\Delta t > 0$)：\n$$\n\\sigma^2 = \\frac{2D}{C^2}\n$$\n最后，求解噪声振幅 $\\sigma$，它必须是一个非负实数：\n$$\n\\sigma = \\sqrt{\\frac{2D}{C^2}} = \\frac{\\sqrt{2D}}{\\sqrt{C^2}} = \\frac{\\sqrt{2D}}{|C|}\n$$\n由于电容 $C$ 是一个严格为正的物理量，所以 $|C| = C$。因此，$\\sigma$ 的最终表达式是：\n$$\n\\sigma = \\frac{\\sqrt{2D}}{C}\n$$\n这个表达式将Itō SDE中噪声项的振幅与电流噪声强度 $D$ 和膜电容 $C$ 这两个物理参数联系起来。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{2D}}{C}}\n$$"
        },
        {
            "introduction": "建立了随机微分方程模型后，下一步便是分析其行为以作出可检验的预测。本练习将通过一个经典的被动整合器神经元模型（即Ornstein-Uhlenbeck过程）来演示一项基本分析技术。您将运用伊藤微积分推导模型统计矩（均值与方差）的动力学方程，并求解其稳态值，从而深入理解神经元参数和输入如何共同决定其阈下膜电位的随机波动 ()。",
            "id": "4022871",
            "problem": "由恒定输入和加性电流噪声驱动的单室无源神经元膜可以通过膜电位 $V_{t}$ 的随机微分方程 (SDE) 来建模：\n$$\n\\mathrm{d}V_{t}=\\left[-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C}\\right]\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准维纳过程，$E_{L}$ 是漏泄反转电位，$\\tau_{m}>0$ 是膜时间常数，$C>0$ 是膜电容，$I_{0}$ 是恒定输入电流，$\\sigma\\ge 0$ 设定了加性高斯白噪声的强度。定义 $a=\\frac{E_{L}}{\\tau_{m}}+\\frac{I_{0}}{C}$ 和 $b=\\frac{1}{\\tau_{m}}$，使得漂移是线性的 $\\left(a-bV_{t}\\right)$，噪声是加性的 $\\sigma$。\n\n仅从此 SDE 以及维纳过程的基本性质和 Itô 微积分或 Fokker–Planck 方程 (FPE) 出发，完成以下任务：\n\n- 推导一阶矩 $m(t)=\\langle V_{t}\\rangle$ 和方差 $s^{2}(t)=\\mathrm{Var}(V_{t})$ 的时间演化的闭合常微分方程。\n- 求解这些方程的稳态值 $m_{\\infty}$ 和 $s^{2}_{\\infty}$，并说明这些稳态存在的参数条件。\n\n仅用 $a$、$b$ 和 $\\sigma$ 表示最终的稳态结果，并将其呈现为单行矩阵 $\\big[m_{\\infty}\\ \\ s^{2}_{\\infty}\\big]$。不需要进行数值评估。",
            "solution": "该问题要求推导由随机微分方程 (SDE) 控制的膜电位 $V_{t}$ 的均值和方差的常微分方程 (ODE)，并随后计算这些矩的稳态值。\n\n首先，我们验证该问题。\n\n### 步骤 1：提取已知条件\n- 膜电位 $V_{t}$ 的 SDE 为：\n$$\n\\mathrm{d}V_{t}=\\left[-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C}\\right]\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\n$$\n- $W_{t}$ 是标准维纳过程。\n- $E_{L}$ 是漏泄反转电位。\n- $\\tau_{m}>0$ 是膜时间常数。\n- $C>0$ 是膜电容。\n- $I_{0}$ 是恒定输入电流。\n- $\\sigma\\ge 0$ 是噪声强度。\n- $a=\\frac{E_{L}}{\\tau_{m}}+\\frac{I_{0}}{C}$\n- $b=\\frac{1}{\\tau_{m}}$\n- 一阶矩：$m(t)=\\langle V_{t}\\rangle$\n- 方差：$s^{2}(t)=\\mathrm{Var}(V_{t})$\n- 任务：推导 $m(t)$ 和 $s^{2}(t)$ 的 ODE，求解它们的稳态值 ($m_{\\infty}$, $s^{2}_{\\infty}$)，并说明这些稳态存在的条件。\n- 最终结果应用 $a$、$b$ 和 $\\sigma$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了 Ornstein-Uhlenbeck 过程，这是一个带噪声输入的漏积分神经元的典型模型。所有术语都有定义，参数具有物理意义的约束（$\\tau_{m}>0$，$C>0$，$\\sigma\\ge 0$）。任务是适定的，涉及使用标准分析技术（Itô 微积分或 Fokker-Planck 方程）来表征过程的矩。该问题是自洽的、客观的，并且没有违反任何无效标准。\n\n### 步骤 3：结论和行动\n问题有效。我们继续进行求解。\n\n首先，我们使用提供的 $a$ 和 $b$ 的定义重写 SDE：\n$$\n-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C} = -\\frac{V_{t}}{\\tau_{m}} + \\frac{E_{L}}{\\tau_{m}} + \\frac{I_{0}}{C} = -b V_{t} + a\n$$\nSDE 变为：\n$$\n\\mathrm{d}V_{t} = (a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t}\n$$\n这是 Ornstein-Uhlenbeck 过程的方程。\n\n**均值 $m(t)$ 的 ODE 推导**\n均值定义为 $m(t) = \\langle V_{t} \\rangle$。为了找到其时间演化，我们对 SDE 取期望。\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = \\langle \\mathrm{d}V_{t} \\rangle = \\langle (a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t} \\rangle\n$$\n利用期望算子的线性性质：\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = \\langle (a - bV_{t})\\mathrm{d}t \\rangle + \\langle \\sigma\\mathrm{d}W_{t} \\rangle = (a - b\\langle V_{t} \\rangle)\\mathrm{d}t + \\sigma\\langle \\mathrm{d}W_{t} \\rangle\n$$\n标准维纳过程的一个基本性质是其增量的期望为零，即 $\\langle \\mathrm{d}W_{t} \\rangle = 0$。因此，方程简化为：\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = (a - b\\langle V_{t} \\rangle)\\mathrm{d}t\n$$\n代入 $m(t) = \\langle V_{t} \\rangle$ 并除以 $\\mathrm{d}t$，我们得到均值的 ODE：\n$$\n\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = a - b m(t)\n$$\n\n**方差 $s^{2}(t)$ 的 ODE 推导**\n方差为 $s^{2}(t) = \\mathrm{Var}(V_{t}) = \\langle V_{t}^{2} \\rangle - \\langle V_{t} \\rangle^{2} = \\langle V_{t}^{2} \\rangle - m(t)^{2}$。我们首先需要找到二阶矩 $\\langle V_{t}^{2} \\rangle$ 的 ODE。我们将 Itô 引理应用于函数 $f(V_{t}) = V_{t}^{2}$。\nItô 引理指出，对于一个 Itô 过程 $X_{t}$ 的函数 $f(X_{t})$，\n$$\n\\mathrm{d}f(X_{t}) = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + \\frac{\\partial f}{\\partial x}\\mathrm{d}X_{t} + \\frac{1}{2}\\frac{\\partial^{2} f}{\\partial x^{2}}(\\mathrm{d}X_{t})^{2}\n$$\n在我们的例子中，$X_{t} = V_{t}$ 且 $f$ 不是时间的显函数，所以 $\\frac{\\partial f}{\\partial t}=0$。我们有 $\\frac{\\partial f}{\\partial V_{t}} = 2V_{t}$ 和 $\\frac{\\partial^{2} f}{\\partial V_{t}^{2}} = 2$。二次变分项 $(\\mathrm{d}V_{t})^{2}$ 使用 Itô 法则（$\\mathrm{d}t \\cdot \\mathrm{d}t = 0$，$\\mathrm{d}t \\cdot \\mathrm{d}W_{t} = 0$，$\\mathrm{d}W_{t} \\cdot \\mathrm{d}W_{t} = \\mathrm{d}t$）计算：\n$$\n(\\mathrm{d}V_{t})^{2} = ((a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t})^{2} = \\sigma^{2}(\\mathrm{d}W_{t})^{2} = \\sigma^{2}\\mathrm{d}t\n$$\n将 Itô 引理应用于 $f(V_{t}) = V_{t}^{2}$：\n$$\n\\mathrm{d}(V_{t}^{2}) = (2V_{t})\\mathrm{d}V_{t} + \\frac{1}{2}(2)(\\mathrm{d}V_{t})^{2}\n$$\n$$\n\\mathrm{d}(V_{t}^{2}) = 2V_{t}((a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t}) + \\sigma^{2}\\mathrm{d}t\n$$\n$$\n\\mathrm{d}(V_{t}^{2}) = (2aV_{t} - 2bV_{t}^{2} + \\sigma^{2})\\mathrm{d}t + 2\\sigma V_{t}\\mathrm{d}W_{t}\n$$\n现在，我们对此方程取期望。Itô 积分项 $\\langle 2\\sigma V_{t}\\mathrm{d}W_{t} \\rangle$ 的期望为零。\n$$\n\\mathrm{d}\\langle V_{t}^{2} \\rangle = \\langle (2aV_{t} - 2bV_{t}^{2} + \\sigma^{2})\\mathrm{d}t \\rangle = (2a\\langle V_{t} \\rangle - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2})\\mathrm{d}t\n$$\n这给出了二阶矩的 ODE：\n$$\n\\frac{\\mathrm{d}\\langle V_{t}^{2} \\rangle}{\\mathrm{d}t} = 2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2}\n$$\n现在我们求方差 $s^{2}(t)$ 的时间导数：\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}(\\langle V_{t}^{2} \\rangle - m(t)^{2}) = \\frac{\\mathrm{d}\\langle V_{t}^{2} \\rangle}{\\mathrm{d}t} - 2m(t)\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t}\n$$\n代入我们推导出的 ODE：\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = (2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2}) - 2m(t)(a - b m(t))\n$$\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = 2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2} - 2a m(t) + 2b m(t)^{2}\n$$\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\sigma^{2} - 2b(\\langle V_{t}^{2} \\rangle - m(t)^{2})\n$$\n代入 $s^{2}(t) = \\langle V_{t}^{2} \\rangle - m(t)^{2}$，我们得到方差的 ODE：\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\sigma^{2} - 2b s^{2}(t)\n$$\n\n**稳态解与存在条件**\n当 $t \\to \\infty$ 时达到稳态，此时矩的时间导数为零。设 $m_{\\infty}$ 和 $s^{2}_{\\infty}$ 分别表示稳态均值和方差。\n对于均值，我们设 $\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = 0$：\n$$\n0 = a - b m_{\\infty} \\implies b m_{\\infty} = a \\implies m_{\\infty} = \\frac{a}{b}\n$$\n对于方差，我们设 $\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = 0$：\n$$\n0 = \\sigma^{2} - 2b s^{2}_{\\infty} \\implies 2b s^{2}_{\\infty} = \\sigma^{2} \\implies s^{2}_{\\infty} = \\frac{\\sigma^{2}}{2b}\n$$\n如果系统随时间收敛到这些稳态解，那么这些解是存在且稳定的。如果线性项的系数 $-b$ 和 $-2b$ 为负，则 $m(t)$ 和 $s^{2}(t)$ 的线性 ODE 的解会收敛到它们各自的不动点 $m_{\\infty}$ 和 $s^{2}_{\\infty}$。这要求 $b > 0$。根据问题陈述，$b = 1/\\tau_{m}$ 且 $\\tau_{m} > 0$，所以条件 $b > 0$ 总是满足的。因此，在给定条件下，稳定的稳态总是存在的。\n\n用 $a$、$b$ 和 $\\sigma$ 表示的最终稳态结果是：\n$m_{\\infty} = \\frac{a}{b}$\n$s^{2}_{\\infty} = \\frac{\\sigma^{2}}{2b}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{a}{b} & \\frac{\\sigma^{2}}{2b} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本练习是一项综合性应用，旨在将本章所学的理论知识应用于一个实际的实验设计情境中。动态钳是一种强大的神经科学实验技术，它允许研究人员向神经元中注入计算生成的电导。成功设计这样一个实验不仅需要对神经元动力学有深刻理解，还需要掌握用于实时模拟注入电流的数值方法的稳定性。此练习将挑战您运用所学知识，为一个基于电导的随机噪声协议设计更新规则，并计算确保其实验稳定性和准确性的最小更新频率 ()。",
            "id": "4022784",
            "problem": "一个单室神经元膜由动态钳驱动，该动态钳向膜内注入一个噪声电导过程。膜动力学被建模为一个线性被动膜，其具有漏电导和一个乘以相对于反转电位的膜电压的注入电导。目标是为电导过程设计一个离散时间方案，以达到指定的稳态均值和方差，并计算在前向欧拉离散化的膜方程下保证数值稳定性的最小更新速率。\n\n基本原理和定义：\n- 设膜电容为 $C$（单位：法拉），漏电导为 $g_L$（单位：西门子）。膜电压 $V(t)$ 遵循带有动态钳注入电导 $g(t)$ 的被动膜方程：\n$$\nC \\frac{dV}{dt} = - g_L \\left(V - E_L\\right) - g(t) \\left(V - E_{\\mathrm{rev}}\\right) .\n$$\n对于前向欧拉离散化的稳定性，乘以 $V$ 的线性系数由总电导 $G_{\\mathrm{tot}}(t) = g_L + g(t)$ 决定；反转电位 $E_L$ 和 $E_{\\mathrm{rev}}$ 不影响线性更新的稳定性条件。\n- 考虑两种电导噪声方案：\n  1. 高斯白电导噪声：一个独立同分布的样本序列 $\\{g_n\\}_{n \\in \\mathbb{Z}_{\\ge 0}}$，其中 $g_n \\sim \\mathcal{N}(\\mu, \\sigma^2)$，$\\mu$ 是期望的均值，$\\sigma^2$ 是期望的方差，单位分别为西门子和平方西门子。\n  2. Ornstein–Uhlenbeck (OU) 电导噪声：一个满足下式的连续时间 Langevin 过程 $g(t)$\n$$\ndg(t) = - \\frac{g(t) - \\mu}{\\tau} \\, dt + \\sqrt{\\frac{2 \\sigma^2}{\\tau}} \\, dW_t ,\n$$\n其中 $W_t$ 是一个标准维纳过程，$\\mu$ 是期望的稳态均值（单位：西门子），$\\sigma^2$ 是期望的稳态方差（单位：平方西门子），$\\tau$ 是相关时间（单位：秒）。该随机微分方程具有稳态均值 $\\mu$ 和稳态方差 $\\sigma^2$。\n- 在采样周期为 $\\Delta t$ 的前向欧拉法下，膜电压的离散时间更新为：\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{C} \\left[ - g_L \\left(V_n - E_L\\right) - g_n \\left(V_n - E_{\\mathrm{rev}}\\right) \\right] ,\n$$\n其中 $g_n$ 是在时间步 $n$ 的注入电导值。当且仅当作用于 $V_n$ 上的乘法因子满足 $\\left|1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)\\right|  1$ 时，此线性更新是数值稳定的。\n- 为了在 $g_n$ 是随机的情况下设计概率稳定性，定义一个可靠性水平 $p \\in (0,1)$ 和相应的正态分位数 $z_p = \\Phi^{-1}(p)$，其中 $\\Phi$ 是标准正态分布的累积分布函数。那么，电导的一个高概率界是 $g_{\\max} = \\mu + z_p \\sigma$。在确定性稳定性准则中使用这个界，可以得到：\n$$\n0  \\Delta t  \\frac{2 C}{g_L + g_{\\max}} .\n$$\n- 对于通过 Euler–Maruyama 方法离散化的 OU 过程，其递归的确定性部分为 $g_{n+1} = g_n + \\Delta t \\left(-\\frac{g_n - \\mu}{\\tau}\\right) + \\text{noise}$，其自回归系数为 $1 - \\frac{\\Delta t}{\\tau}$。该系数的 Euler–Maruyama 稳定性要求 $0  \\Delta t  2 \\tau$。另外，一个对于任意 $\\Delta t > 0$ 都能保持连续时间稳态均值和方差的精确离散时间 OU 更新定义为\n$$\ng_{n+1} = \\mu + \\phi \\left(g_n - \\mu\\right) + \\sigma_d \\, \\xi_n ,\n$$\n其中 $\\phi = e^{-\\Delta t / \\tau}$，$\\sigma_d = \\sqrt{ \\sigma^2 \\left(1 - e^{-2 \\Delta t / \\tau}\\right) }$，且 $\\xi_n \\sim \\mathcal{N}(0,1)$。对于任何 $\\Delta t > 0$，此精确更新在均方意义上是无条件稳定的。\n\n任务：\n1. 对于每个参数集，设计离散时间电导更新规则，以实现指定的稳态均值和方差：\n   - 对于高斯噪声，在每个时间步独立使用 $g_n = \\mu + \\sigma \\xi_n$，其中 $\\xi_n \\sim \\mathcal{N}(0,1)$。\n   - 对于 OU 噪声，使用精确的离散时间更新 $g_{n+1} = \\mu + \\phi \\left(g_n - \\mu\\right) + \\sigma_d \\xi_n$，其中 $\\phi$ 和 $\\sigma_d$ 如上文定义。\n2. 计算最小更新速率 $f_s$（单位：赫兹），使得前向欧拉膜更新在可靠性水平 $p$ 下是数值稳定的，使用 $g_{\\max} = \\mu + z_p \\sigma$ 的界限。对于 OU 噪声，当使用 Euler–Maruyama 离散化时，还需强制执行约束 $0  \\Delta t  2 \\tau$；当使用精确的离散时间 OU 更新时，则不需要此附加约束。在本问题中，强制执行这两个约束并选择最严格的界限。为确保实现中的严格不等式，使用安全边际因子 $\\alpha = 0.999$ 并设置\n$$\n\\Delta t = \\alpha \\cdot \\min\\left( \\frac{2 C}{g_L + g_{\\max}}, \\, 2 \\tau \\right)\n$$\n用于 OU，以及\n$$\n\\Delta t = \\alpha \\cdot \\frac{2 C}{g_L + g_{\\max}}\n$$\n用于高斯噪声。然后计算 $f_s = \\frac{1}{\\Delta t}$，以赫兹表示。\n3. 对于 OU 噪声，计算在选定的 $\\Delta t$ 下的离散时间参数 $\\phi$ 和 $\\sigma_d$；对于高斯噪声，设置 $\\phi = 0$ 且每步噪声幅度为 $a = \\sigma$。\n\n测试套件：\n提供以下参数集，每个参数均以国际单位制（法拉、西门子、秒）表示，概率以小数表示。对每个参数集，计算结果并以列表 $[f_s, a, \\phi]$ 的形式返回，其中 $f_s$ 的单位是赫兹， $a$ 是每步噪声幅度（单位：西门子，高斯噪声下等于 $\\sigma$，OU 噪声下等于 $\\sigma_d$），$\\phi$ 是 OU 自回归系数（高斯噪声下设为 $0$）。将报告的每个浮点数四舍五入到 $6$ 位小数。\n\n- 案例 $1$（OU，中等变异性，膜限制）：\n  - 类型：OU\n  - $C = 2 \\times 10^{-10}$，$g_L = 1 \\times 10^{-8}$，$\\mu = 3 \\times 10^{-7}$，$\\sigma = 1 \\times 10^{-7}$，$\\tau = 5 \\times 10^{-3}$，$p = 0.9973$。\n- 案例 $2$（OU，快速相关，OU限制）：\n  - 类型：OU\n  - $C = 2 \\times 10^{-10}$，$g_L = 1 \\times 10^{-8}$，$\\mu = 5 \\times 10^{-8}$，$\\sigma = 2 \\times 10^{-8}$，$\\tau = 2 \\times 10^{-4}$，$p = 0.99$。\n- 案例 $3$（高斯，高方差）：\n  - 类型：高斯\n  - $C = 2 \\times 10^{-10}$，$g_L = 1 \\times 10^{-8}$，$\\mu = 8 \\times 10^{-7}$，$\\sigma = 3 \\times 10^{-7}$，$p = 0.999$。\n- 案例 $4$（OU，大均值和漏电）：\n  - 类型：OU\n  - $C = 1 \\times 10^{-10}$，$g_L = 3 \\times 10^{-8}$，$\\mu = 1.2 \\times 10^{-6}$，$\\sigma = 4 \\times 10^{-7}$，$\\tau = 2 \\times 10^{-3}$，$p = 0.95$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个案例的结果本身也是一个用方括号括起来的逗号分隔列表。例如，输出必须类似于 $[\\,[f_{s,1},a_1,\\phi_1],[f_{s,2},a_2,\\phi_2],\\ldots\\,]$，不含空格。所有报告的 $f_s$ 必须以赫兹为单位，并四舍五入到 $6$ 位小数。所有报告的幅度 $a$ 和系数 $\\phi$ 必须四舍五入到 $6$ 位小数。",
            "solution": "该问题要求设计一个离散时间的噪声电导方案，并计算相关的参数以确保数值稳定性和统计正确性。解决方案包括对每个指定的参数集进行多步计算，其基础是常微分方程的数值稳定性原理和随机过程的性质。\n\n首先，我们处理膜电压方程前向欧拉离散化的数值稳定性问题。该方程由下式给出：\n$$\nC \\frac{dV}{dt} = - g_L \\left(V - E_L\\right) - g(t) \\left(V - E_{\\mathrm{rev}}\\right)\n$$\n重新整理 $V(t)$ 的线性项，得到：\n$$\nC \\frac{dV}{dt} = - \\left(g_L + g(t)\\right) V(t) + \\left(g_L E_L + g(t) E_{\\mathrm{rev}}\\right)\n$$\n时间步长为 $\\Delta t$ 的前向欧拉更新为：\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{C} \\left[ - \\left(g_L + g_n\\right) V_n + \\left(g_L E_L + g_n E_{\\mathrm{rev}}\\right) \\right]\n$$\n其中 $g_n$ 是第 $n$ 个时间步的电导值。这可以写成关于 $V_n$ 的线性递推关系：\n$$\nV_{n+1} = \\left[ 1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right) \\right] V_n + \\frac{\\Delta t}{C} \\left(g_L E_L + g_n E_{\\mathrm{rev}}\\right)\n$$\n为使此更新数值稳定，$V_n$ 上的乘法因子的大小必须小于 $1$：\n$$\n\\left| 1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right) \\right|  1\n$$\n该不等式可解为：\n$$\n-1  1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  1\n$$\n$$\n-2  - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  0\n$$\n$$\n0  \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  2\n$$\n由于 $\\Delta t$、$C$、$g_L$ 和 $g_n$（作为物理电导）都是非负的，下界 0 总是满足的。因此，稳定性由上界决定：\n$$\n\\Delta t  \\frac{2C}{g_L + g_n}\n$$\n由于 $g_n$ 是一个随机变量，我们必须确保此条件以高概率成立。我们建立一个最大电导值 $g_{\\max}$，该值被超过的概率很小，为 $1-p$。对于均值为 $\\mu$、标准差为 $\\sigma$ 的正态分布电导过程，这个高概率最大值定义为 $g_{\\max} = \\mu + z_p \\sigma$，其中 $z_p = \\Phi^{-1}(p)$ 是对应于可靠性水平 $p$ 的标准正态分布的分位数。将 $g_{\\max}$ 代入稳定性条件，得到时间步长的确定性界 $\\Delta t_{mem}$：\n$$\n\\Delta t_{mem} = \\frac{2C}{g_L + g_{\\max}}\n$$\n对于 Ornstein-Uhlenbeck (OU) 过程，如果使用 Euler-Maruyama 方法进行离散化，过程本身的离散化会带来一个额外的稳定性约束，即要求 $0  \\Delta t  2\\tau$。问题指定必须将此约束与膜稳定性约束一并考虑。因此，对于 OU 情况，$\\Delta t$ 的上界是这两个约束的最小值：\n$$\n\\Delta t_{bound} = \\min\\left( \\frac{2C}{g_L + g_{\\max}}, 2\\tau \\right)\n$$\n对于高斯白噪声情况，不存在时间相关性，因此噪声过程本身没有对 $\\Delta t$ 的这种约束。界限仅由膜稳定性决定：\n$$\n\\Delta t_{bound} = \\frac{2C}{g_L + g_{\\max}}\n$$\n为确保严格不等式，应用了一个安全因子 $\\alpha=0.999$。因此，最终的时间步长为 $\\Delta t = \\alpha \\cdot \\Delta t_{bound}$。最小更新速率则为 $f_s = 1/\\Delta t$。\n\n最后一步是在计算出的 $\\Delta t$ 下，计算离散时间电导更新的参数。\n- 对于高斯白噪声，该过程是无记忆的。每个样本 $g_n$ 均从 $\\mathcal{N}(\\mu, \\sigma^2)$ 中抽取。这实现为 $g_n = \\mu + \\sigma \\xi_n$，其中 $\\xi_n \\sim \\mathcal{N}(0,1)$。问题要求每步噪声幅度 $a$，即 $a = \\sigma$，以及自回归系数 $\\phi$，对于无记忆过程，其值为 0。\n- 对于 OU 过程，使用了一个精确的离散时间更新规则，该规则对任何 $\\Delta t$ 都保留了稳态统计量。更新公式为 $g_{n+1} = \\mu + \\phi(g_n - \\mu) + \\sigma_d \\xi_n$。参数 $\\phi$ 和 $\\sigma_d$ 依赖于 $\\Delta t$：\n$$\n\\phi = e^{-\\Delta t / \\tau}\n$$\n每步噪声幅度 $a = \\sigma_d$ 由下式给出：\n$$\n\\sigma_d = \\sqrt{\\sigma^2 \\left(1 - e^{-2\\Delta t / \\tau}\\right)}\n$$\n这也可以用 $\\phi$ 表示为 $\\sigma_d = \\sigma \\sqrt{1 - \\phi^2}$。\n\n每个测试案例的步骤如下：\n1. 确定噪声类型（高斯或 OU）。\n2. 计算标准正态分位数 $z_p = \\Phi^{-1}(p)$。\n3. 计算高概率最大电导 $g_{\\max} = \\mu + z_p \\sigma$。\n4. 计算稳定性界限。对于 OU，$\\Delta t_{bound} = \\min(\\frac{2C}{g_L + g_{\\max}}, 2\\tau)$；对于高斯噪声，$\\Delta t_{bound} = \\frac{2C}{g_L + g_{\\max}}$。\n5. 应用安全因子找到时间步长：$\\Delta t = \\alpha \\cdot \\Delta t_{bound}$。\n6. 计算最小更新速率 $f_s = 1/\\Delta t$。\n7. 对于 OU 噪声，计算 $\\phi = e^{-\\Delta t / \\tau}$ 和 $a = \\sigma\\sqrt{1-e^{-2\\Delta t/\\tau}}$。对于高斯噪声，设置 $\\phi = 0$ 和 $a = \\sigma$。\n8. 组合结果为 $[f_s, a, \\phi]$ 并将每个值四舍五入到 $6$ 位小数。\n\n该过程将系统地应用于所提供的四个测试案例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the minimal update rate and discrete-time parameters for a noisy\n    conductance process based on numerical stability criteria.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'OU', 'C': 2e-10, 'g_L': 1e-8, 'mu': 3e-7, 'sigma': 1e-7, 'tau': 5e-3, 'p': 0.9973},\n        {'type': 'OU', 'C': 2e-10, 'g_L': 1e-8, 'mu': 5e-8, 'sigma': 2e-8, 'tau': 2e-4, 'p': 0.99},\n        {'type': 'Gaussian', 'C': 2e-10, 'g_L': 1e-8, 'mu': 8e-7, 'sigma': 3e-7, 'tau': None, 'p': 0.999},\n        {'type': 'OU', 'C': 1e-10, 'g_L': 3e-8, 'mu': 1.2e-6, 'sigma': 4e-7, 'tau': 2e-3, 'p': 0.95},\n    ]\n\n    results = []\n    alpha = 0.999 # Safety margin factor\n\n    for case in test_cases:\n        # Unpack parameters\n        case_type = case['type']\n        C = case['C']\n        g_L = case['g_L']\n        mu = case['mu']\n        sigma = case['sigma']\n        tau = case['tau']\n        p = case['p']\n\n        # Step 1: Calculate the normal quantile z_p\n        z_p = norm.ppf(p)\n\n        # Step 2: Calculate the high-probability maximum conductance g_max\n        g_max = mu + z_p * sigma\n        \n        # Step 3: Calculate the stability bound from the membrane equation\n        dt_mem = (2 * C) / (g_L + g_max)\n\n        # Step 4: Determine the overall time step bound\n        if case_type == 'OU':\n            # For OU, also consider the Euler-Maruyama stability constraint\n            dt_ou = 2 * tau\n            dt_bound = min(dt_mem, dt_ou)\n        else: # Gaussian case\n            dt_bound = dt_mem\n\n        # Step 5: Apply the safety factor to get the final time step\n        dt = alpha * dt_bound\n        \n        # Step 6: Compute the minimal update rate\n        fs = 1 / dt\n\n        # Step 7: Compute the discrete-time parameters a and phi\n        if case_type == 'OU':\n            phi = np.exp(-dt / tau)\n            # The definition is a = sigma_d\n            sigma_d = np.sqrt(sigma**2 * (1 - np.exp(-2 * dt / tau)))\n            a = sigma_d\n        else: # Gaussian case\n            phi = 0.0\n            a = sigma\n\n        # Round results to 6 decimal places\n        fs_rounded = round(fs, 6)\n        a_rounded = round(a, 6)\n        phi_rounded = round(phi, 6)\n        \n        results.append([fs_rounded, a_rounded, phi_rounded])\n\n    # Final print statement in the exact required format.\n    # e.g., [[f1,a1,p1],[f2,a2,p2],...] with no spaces.\n    case_strings = []\n    for res in results:\n        # Format each sublist without spaces\n        case_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        }
    ]
}