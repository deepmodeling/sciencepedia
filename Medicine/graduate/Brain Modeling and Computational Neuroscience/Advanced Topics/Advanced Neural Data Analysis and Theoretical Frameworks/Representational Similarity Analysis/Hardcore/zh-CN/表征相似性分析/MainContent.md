## 引言
在探究大脑如何表征和处理信息的过程中，我们面临一个核心挑战：如何在一个共同的框架下比较不同系统——例如人脑、动物大脑或人工智能模型——的信息表征方式？这些系统的物理实现（神经元数量、活动尺度）千差万别，使得直接比较变得异常困难。表征相似性分析（Representational Similarity Analysis, RSA）的出现，正是为了解决这一根本性问题，它提供了一种强大的方法论，通过关注信息的“表征几何”而非其具体实现细节，来架设连接大脑、行为与[计算模型](@entry_id:637456)之间的桥梁。

本文将系统性地介绍RSA。在第一章“原理与机制”中，我们将深入其核心，学习如何从原始神经数据构建[表征非相似性矩阵](@entry_id:1130874)（RDM），并探讨比较这些矩阵背后的统计学原理。接着，在第二章“应用与交叉学科联系”中，我们将展示RSA在[认知神经科学](@entry_id:914308)（如fMRI和M/EEG研究）、[人工智能模型验证](@entry_id:897755)及进化生物学等领域的广泛应用，领略其作为“通用语言”的魅力。最后，通过第三章“动手实践”，您将有机会将理论付诸实践，掌握构建和分析RDM的关键技能。

## 原理与机制

本章旨在深入剖析表征相似性分析（Representational Similarity Analysis, RSA）的核心原理与底层机制。我们将从其基本构建单元——[表征非相似性矩阵](@entry_id:1130874)（RDM）——出发，系统地阐述如何构建、比较和解释这些矩阵，从而揭示不同系统（例如，大脑区域、[计算模型](@entry_id:637456)或行为）中信息的表征方式。我们将探讨 RSA 如何通过对表征几何的抽象，提供一种超越传统单变量或多变量解码方法的独特视角。

### 从神经活动模式到表征几何

在典型的神经科学实验中，不同的实验条件或刺激（例如，呈现不同的图像）会引发大脑特定区域内多个测量通道（如体素或神经元）的复杂活动模式。对于 $n$ 个实验条件，我们可以为每个条件 $i$ 获得一个 $p$ 维的响应向量 $\mathbf{r}_i \in \mathbb{R}^p$，其中 $p$ 是测量通道的数量。这些高维的活动模式构成了我们分析的原始起点。

表征相似性分析的核心思想，是**从这些具体、高维的活动模式中抽象出一种更稳定、更具可比性的信息结构**。它不直接分析 $\mathbf{r}_i$ 向量本身，而是关注这些向量之间的关系。这种关系通过一个核心工具来量化，即**[表征非相似性矩阵](@entry_id:1130874)（Representational Dissimilarity Matrix, RDM）**。

一个 RDM，记为 $D$，是一个 $n \times n$ 的方阵，其每一个元素 $D_{ij}$ 都量化了条件 $i$ 和条件 $j$ 所引发的神经活动模式 $\mathbf{r}_i$ 和 $\mathbf{r}_j$ 之间的“非相似性”或“距离”。该值由一个非相似性函数 $d(\cdot, \cdot)$ 计算得出，即 $D_{ij} = d(\mathbf{r}_i, \mathbf{r}_j)$。根据非[相似性度量](@entry_id:896637)的基本定义，一个 RDM 具有两个基本属性 ：

1.  **对称性（Symmetry）**: 任意两个模式之间的非相似性不应取决于比较的顺序，因此 $d(\mathbf{r}_i, \mathbf{r}_j) = d(\mathbf{r}_j, \mathbf{r}_i)$，这导致 RDM 是一个对称矩阵，即 $D_{ij} = D_{ji}$。
2.  **零对角线（Zero Diagonal）**: 任何一个模式与其自身的非相似性应为零，即 $d(\mathbf{r}_i, \mathbf{r}_i) = 0$，因此 RDM 的主对角[线元](@entry_id:196833)素 $D_{ii}$ 均为零。

由于对称性和零对角线，RDM 中的所有独特信息都包含在其上三角（或下三角）部分。这 $n(n-1)/2$ 个数值共同定义了这 $n$ 个活动模式的**表征几何（representational geometry）** 。所谓[表征几何](@entry_id:1130876)，可以直观地理解为这 $n$ 个活动模式向量在 $p$ 维空间中构成的点云的几何结构。这个几何结构由所有点之间的成对距离唯一确定，而不依赖于点云在空间中的绝对位置、方向或所使用的坐标系（即具体的测量通道）。通过将分析提升到表征几何的层面，RSA 实现了一种关键的抽象：它忽略了测量通道的具体身份和单个活动模式的绝对值，专注于不同条件下的神经表征之间更稳定的关系结构。

### 构建 RDM：非[相似性度量](@entry_id:896637)的选择

构建 RDM 的第一步是选择一个合适的非[相似性度量](@entry_id:896637) $d(\cdot, \cdot)$。这个选择并非无足轻重，因为它隐含了我们对于[神经编码](@entry_id:263658)中哪些特征是重要、哪些是无关紧要的假设。不同的度量具有不同的**[不变性](@entry_id:140168)（invariance properties）**，这些不变性决定了 RDM 对原始活动模式的哪些变换不敏感。下面我们探讨几种常用的非[相似性度量](@entry_id:896637)及其特性 。

#### 欧几里得距离 (Euclidean Distance)

欧几里得距离 $d_{\mathrm{E}}(\mathbf{r}_i, \mathbf{r}_j) = \lVert \mathbf{r}_i - \mathbf{r}_j \rVert_2$ 是最直观的距离度量。它的关键[不变性](@entry_id:140168)在于对**[刚体运动](@entry_id:144691)（rigid motion）** 的不敏感性，即平移和旋转。

-   **[平移不变性](@entry_id:195885)**: 对所有活动模式加上一个共同的向量 $c$（$\mathbf{r}_i \to \mathbf{r}_i + c$），它们之间的欧几里得距离保持不变。这意味着 RDM 忽略了所有模式在活动空间中的整体偏移。
-   **[旋转不变性](@entry_id:137644)**: 将所有活动模式绕原点进行一次旋转（$\mathbf{r}_i \to Q\mathbf{r}_i$，其中 $Q$ 为[正交矩阵](@entry_id:169220)），距离同样保持不变。这意味着 RDM 忽略了活动模式点云的整体朝向，从而摆脱了对特定体素坐标轴的依赖 。

然而，[欧几里得距离](@entry_id:143990)对**缩放（scaling）** 是敏感的。如果所有活动模式都被乘以一个常数 $a > 0$，距离也会被缩放 $a$ 倍。这使得欧几里得距离构建的 RDM 对测量单位或响应的整体增益很敏感 。

#### [相关距离](@entry_id:634939) (Correlation Distance)

[相关距离](@entry_id:634939)定义为 $d_{\mathrm{COR}}(\mathbf{r}_i, \mathbf{r}_j) = 1 - \rho(\mathbf{r}_i, \mathbf{r}_j)$，其中 $\rho$ 是[皮尔逊相关系数](@entry_id:918491)。[皮尔逊相关](@entry_id:260880)计算的是均值中心化后的向量之间的余弦相似度。这赋予了它独特的和强大的不变性 ：

-   **对每个模式独立的[仿射变换](@entry_id:144885)不变**: $\rho(\mathbf{r}_i, \mathbf{r}_j)$ 对 $\mathbf{r}_i \to a_i\mathbf{r}_i + b_i\mathbf{1}$ 和 $\mathbf{r}_j \to a_j\mathbf{r}_j + b_j\mathbf{1}$ （其中 $a_i, a_j > 0$）这类变换是不变的。这意味着[相关距离](@entry_id:634939)忽略了每个活动模式自身的平均激活水平（由 $b_i$ 决定）和响应幅度/对比度（由 $a_i$ 决定）。

因此，[相关距离](@entry_id:634939)关注的是活动模式的“形状”或“轮廓”，而非其绝对激活水平或幅度。这在功能磁共振成像（fMRI）等应用中尤其有用，因为信号的绝对大小可能受到多种生理或物理因素的干扰。需要注意的是，[相关距离](@entry_id:634939)对任意旋转并不具有不变性。

#### [马氏距离](@entry_id:269828) (Mahalanobis Distance)

当测量通道的噪声不均匀或相关时，[马氏距离](@entry_id:269828) $d_{\mathrm{M}}(\mathbf{r}_i, \mathbf{r}_j) = \sqrt{(\mathbf{r}_i - \mathbf{r}_j)^\top \Sigma^{-1} (\mathbf{r}_i - \mathbf{r}_j)}$ 提供了一个更为精良的选择。这里的 $\Sigma$ 是测量噪声的[协方差矩阵](@entry_id:139155)。

马氏距离通过 $\Sigma^{-1}$ 对空间进行“白化”（whitening），它将原始空间变换为一个噪声呈球形分布的新空间。在这个新空间中，欧几里得距离等同于原始空间中的马氏距离。其核心优势在于对任意**[可逆线性变换](@entry_id:149915)**的[不变性](@entry_id:140168)。如果活动模式被变换为 $\mathbf{r}'_i = A\mathbf{r}_i$（其中 $A$ 是[可逆矩阵](@entry_id:171829)），并且[噪声协方差](@entry_id:1128754)相应地变换为 $\Sigma' = A\Sigma A^\top$，那么[马氏距离](@entry_id:269828)将保持不变  。这使得马氏距离构建的 RDM 能够捕捉到一种与测量基底完全无关的表征几何，因为它对所有通道的任意线性重组都不敏感。在实践中，为了得到 $\Sigma$ 的可靠估计并避免偏差，通常采用[交叉验证](@entry_id:164650)的方法来计算[马氏距离](@entry_id:269828)（例如，crossnobis 估计器）。

### RSA 的核心抽象：比较表征几何

构建 RDM 只是第一步。RSA 的真正威力在于**比较**这些 RDM。我们可以比较来自不同大脑区域、不同个体、不同物种、不同时间点，或者——最常见的——比较大脑与[计算模型](@entry_id:637456)之间的 RDM。如果两个 RDM 相似，我们便可以推断它们所来源的系统以相似的方式组织了关于实验条件的信息。

然而，这里存在一个深刻的认知论挑战。我们测得的非相似性 $D_X(i,j)$ 只是对潜在的、“真实的”非相似性 $d_X(i,j)$ 的一种观测。两者之间的关系可能受到一个未知的、单调[非线性](@entry_id:637147)的测量函数 $h_X$ 的影响，即 $D_X(i,j) \approx h_X(d_X(i,j))$ 。例如，fMRI BOLD 信号与底层神经活动之间的关系就是高度[非线性](@entry_id:637147)的。如果我们要比较大脑的 RDM（受 $h_{\text{brain}}$ 影响）和模型的 RDM（可能受不同的 $h_{\text{model}}$ 影响），我们如何能声称它们共享“抽象的”表征内容呢？

答案在于放弃对非相似性绝对值的依赖，转而关注它们的**[序数](@entry_id:150084)结构（ordinal structure）**。一个严格递增的函数（如 $h_X$）会改变数值的大小，但会保持它们的排列顺序。如果 $d_X(i,j)  d_X(k,l)$，那么 $h_X(d_X(i,j))  h_X(d_X(k,l))$。因此，非相似性值的**秩次（rank）** 被保留了下来。

这引出了 RSA 中比较 RDM 的标准方法：使用**[秩相关](@entry_id:175511)（rank correlation）**，如**[斯皮尔曼等级相关](@entry_id:755150)系数（Spearman's rank correlation, $\rho_S$）** 或[肯德尔等级相关系数](@entry_id:750989)（[Kendall's tau](@entry_id:750989), $\tau$）。[斯皮尔曼相关](@entry_id:896527)被定义为对两个变量的秩次向量计算[皮尔逊相关](@entry_id:260880)。通过比较 RDM 中非相似性值的秩次，我们的分析变得对任何未知的单调[非线性变换](@entry_id:636115)都不敏感 。

这种方法与使用[皮尔逊相关](@entry_id:260880)（Pearson correlation）直接比较非相似性值形成对比。[皮尔逊相关](@entry_id:260880)只对线性（或仿射）关系不敏感。假设真实的非相似性为 $d^\ast$，一个模型的预测为 $m_1 = d^\ast$，另一个模型的预测为 $m_3 = \phi(d^\ast)$，其中 $\phi$ 是一个[非线性](@entry_id:637147)[单调函数](@entry_id:145115)。[斯皮尔曼相关](@entry_id:896527)会认为这两个模型同样好，因为它们的秩次与真实秩次相同。然而，[皮尔逊相关](@entry_id:260880)会惩罚模型 $m_3$，因为它与真实值之间不是线性关系 。因此，采用[秩相关](@entry_id:175511)使我们能够检验关于抽象表征几何的假设，而无需对测量的具体尺度做出严格假设。

### 统计推断：从相关性到显著性

计算出两个 RDM 之间的相关性（例如，[斯皮尔曼相关](@entry_id:896527)系数）后，我们需要评估这个相关性是否具有[统计显著性](@entry_id:147554)。我们不能简单地使用依赖于[独立同分布假设](@entry_id:634392)的标准参数检验。原因在于，一个 RDM 的 $n(n-1)/2$ 个非相似性值并不是[相互独立](@entry_id:273670)的 。

#### 依赖性问题

RDM 条目之间的依赖性主要源于共享的实验条件。例如，非相似性 $D_{12}$ 和 $D_{13}$ 都依赖于对条件1的测量。因此，与条件1相关的测量噪声会同时影响这两个条目，导致它们之间产生相关性。这种内在的依赖结构使得[有效自由度](@entry_id:161063)远小于 $n(n-1)/2 - 2$，从而让标准 $t$ 检验等方法失效。

#### [置换检验](@entry_id:175392)：一个有效的解决方案

为了在存在依赖性的情况下进行有效的[统计推断](@entry_id:172747)，RSA 普遍采用**[置换检验](@entry_id:175392)（permutation test）**。具体而言，最常用的方法是**条件标签[置换检验](@entry_id:175392)（condition-label permutation test）**。其步骤如下：

1.  计算观测到的两个 RDM（例如，大脑 RDM $D_A$ 和模型 RDM $D_B$）之间的真实相关性 $\rho_{\text{obs}}$。
2.  构建一个[零分布](@entry_id:195412)（null distribution）：
    a.  随机打乱 RDM $D_B$ 的条件标签。这等同于同时对其行和列应用相同的[随机置换](@entry_id:268827)。
    b.  计算置换后的 RDM $D_B'$ 与原始 RDM $D_A$ 之间的相关性 $\rho_{\text{perm}}$。
    c.  重复此过程数千次，得到一个 $\rho_{\text{perm}}$ 的分布。
3.  p 值即为零分布中大于或等于 $\rho_{\text{obs}}$ 的比例。

这个过程之所以有效，是因为它在破坏两个 RDM 之间特定条件对应关系的同时，**完整地保留了每个 RDM 内部的依赖结构**。因此，它为“两个 RDM 之间没有系统性关系”这一[零假设](@entry_id:265441)提供了一个有效的检验。

#### 噪声天花板：评估模型性能的上限

在[解释模型](@entry_id:925527) RDM 与大脑 RDM 的相关性时，一个重要的问题是：“这个相关性算高还是低？” 数据的内在噪声限制了任何模型可能达到的最高性能。这个理论上的上限被称为**噪声[天花](@entry_id:920451)板（noise ceiling）** 。噪声[天花](@entry_id:920451)板估计了“真实”的群体平均 RDM 与单个被试 RDM 之间的预期相关性。它通常由一个下界和一个[上界](@entry_id:274738)构成：

-   **下界**：通过[留一法交叉验证](@entry_id:637718)计算。对于每个被试，我们计算其 RDM 与所有**其他**被试平均 RDM 之间的相关性。由于被试自身的数据被排除在外，其噪声与平均 RDM 的噪声不相关，这通常会低估真实的相关性。
-   **[上界](@entry_id:274738)**：对于每个被试，计算其 RDM 与**所有**被试（包括其自身）平均 RDM 之间的相关性。由于被试自身的噪声被包含在平均 RDM 中，这会人为地提高相关性，从而提供一个高估的上限。

噪声天花板为模型性能提供了一个关键的参照系。如果一个模型的性能接近或进入噪声天花板区间，我们可以说该模型已经解释了数据中几乎所有可靠的变异。

### RSA 在[多变量分析](@entry_id:168581)方法中的位置

最后，理解 RSA 在神经科学[多变量分析](@entry_id:168581)工具箱中的独特地位至关重要。这可以通过将其与两种主要方法——体素级编码模型和多变量解码——进行比较来阐明 。

#### RSA vs. 编码模型 (Encoding Models)

体素级编码模型的目标是为每个测量通道（体素）建立一个独立的预测模型，通常是从刺激的特征来预测该体素的响应。因此，[编码模型](@entry_id:1124422)关注的是**表征的实现细节**：哪些体素对哪些特征有反应。这类分析对测量空间的坐标轴（即体素）是敏感的。相反，RSA 通过计算非相似性，从一开始就抽象掉了单个体素的身份，专注于**表征的关系结构**。它测试的是表征等价性，直至点云的[刚性运动](@entry_id:170523)（对于欧几里得距离）和单调变换（对于[秩相关](@entry_id:175511)）。

#### RSA vs. 解码模型 (Decoding Models)

多变量解码（或“读出”）旨在从神经活动模式中预测出被试正在经历哪个实验条件或刺激类别。解码的成功表明关于该变量的**信息是存在的并且是线性（或[非线性](@entry_id:637147)）可读的**。解码的性能对任何保持类别[可分性](@entry_id:143854)的[可逆线性变换](@entry_id:149915)都是不变的。

然而，解码能力只是[表征几何](@entry_id:1130876)的一个侧面投影。一个关键的洞见是，**两个大脑区域可能对某个变量具有完全相同的解码精度，但其底层的表征几何却截然不同** 。设想一个场景：区域A和区域B都能以90%的准确率区分“猫”和“狗”的图像。然而，区域A可能只是简单地将所有猫的模式聚集在一处，所有狗的模式聚集在另一处。而区域B可能在区分猫和狗的同时，还以一种系统性的方式组织了每个动物的“视角”或“大小”等次级信息。在这种情况下，区域B的 RDM 会显示出丰富的内部结构（例如，不同视角的猫之间的距离比相同视角的猫要大），而区域A的 RDM 则不会。线性解码器可能对这种额外的结构不敏感，只关注将猫/狗分开的维度，因此在两个区域表现相同。

这个例子凸显了 RSA 的独特价值：它不仅仅问“信息是否存在？”，而是问“**信息是如何被组织的？**”。它提供了一个关于表征内容的更丰富、更全面的描述，揭示了超越简单[分类任务](@entry_id:635433)的几何关系。通过比较这些几何结构，RSA 使我们能够在不同系统之间进行有意义的、高度抽象的比较，从而推动我们对神经计算原理的理解。