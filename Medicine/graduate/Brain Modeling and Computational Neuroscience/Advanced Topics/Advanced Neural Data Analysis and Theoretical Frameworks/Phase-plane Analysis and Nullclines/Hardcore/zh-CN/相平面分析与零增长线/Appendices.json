{
    "hands_on_practices": [
        {
            "introduction": "相平面分析的基础在于零斜线如何将平面划分为具有可预测流向的区域。第一个实践提供了一个关键的“健全性检查”：您将编写一个程序，对神经元模型的轨迹进行数值积分，并验证沿路径观察到的流向与零斜线几何结构所做的预测始终匹配。这项练习将为您信任和应用定性分析方法打下坚实、直观的基础。",
            "id": "4009589",
            "problem": "考虑由 FitzHugh–Nagumo 系统给出的二维平面神经元模型，该系统是 Hodgkin–Huxley 模型的一个简化版本，常用于大脑建模和计算神经科学。该系统由以下常微分方程 (ODE) 初值问题定义：\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I, \\quad \\frac{dw}{dt} = \\epsilon \\left( v + a - b w \\right),\n$$\n初始条件为\n$$\nv(0) = v_0, \\quad w(0) = w_0,\n$$\n其中 $v$ 表示膜电压，$w$ 表示恢复变量，$I$ 表示恒定的外部输入电流，$a$、$b$、$\\epsilon$ 是参数。两个零斜线是时间导数为零的点集：\n$$\n\\frac{dv}{dt} = 0 \\implies w = v - \\frac{v^3}{3} + I, \\quad \\frac{dw}{dt} = 0 \\implies w = \\frac{v + a}{b}.\n$$\n相平面分析使用这些零斜线将平面划分为流向在性质上有所不同的区域。具体来说，点 $(v,w)$ 处 $\\frac{dv}{dt}$ 的符号由不等式 $w \\lessgtr v - \\frac{v^3}{3} + I$ 决定，而 $\\frac{dw}{dt}$ 的符号由 $w \\lessgtr \\frac{v + a}{b}$ 决定。\n\n您的任务是编写一个独立完整的程序，该程序能够：\n1. 对于给定的参数集和初始条件，在有限时间区间 $[0, T]$ 上对系统进行积分，并在均匀的时间点 $t_i$ 上生成采样轨迹 $\\{(v(t_i), w(t_i))\\}$。\n2. 通过在采样点上比较由零斜线不等式预测的 $(\\frac{dv}{dt}, \\frac{dw}{dt})$ 符号与沿轨迹通过有限差分估计的观测符号，来验证定性相平面图。其中 $|\\frac{dv}{dt}|$ 或 $|\\frac{dw}{dt}|$ 小于一个很小容差的近零斜线点应被排除在计数之外。如果两个符号都匹配的非排除点的比例至少达到指定的阈值，则报告一个布尔值 true。\n3. 通过求解零斜线的交点来计算平衡点，通过每个平衡点处矢量场的雅可比矩阵对其线性稳定性进行分类，并通过将最终状态与欧几里得距离最近的稳定平衡点进行比较，来测试积分轨迹是否收敛到一个稳定平衡点。如果此距离低于指定的容差，则报告一个布尔值 true。\n\n推导的基础：\n- 零斜线的定义：集合 $\\{(v,w): \\frac{dv}{dt} = 0\\}$ 和 $\\{(v,w): \\frac{dw}{dt} = 0\\}$，它们将平面划分为时间导数符号保持不变的区域。\n- 矢量场评估：在任意点 $(v,w)$，流向由 $(\\frac{dv}{dt}, \\frac{dw}{dt})$ 给出，其值由系统方程的右侧项决定。\n- 通过雅可比矩阵判断线性稳定性：在平衡点 $(v^\\ast, w^\\ast)$ 处矢量场的雅可比矩阵为\n$$\nJ(v^\\ast, w^\\ast) = \n\\begin{pmatrix}\n1 - (v^\\ast)^2  -1 \\\\\n\\epsilon  -\\epsilon b\n\\end{pmatrix},\n$$\n其稳定性由 $J$ 的特征值的实部符号决定。\n\n实现细节和要求：\n- 预测符号根据不等式计算：\n$$\n\\operatorname{sign}\\left(\\frac{dv}{dt}\\right) = \\operatorname{sign}\\left( v - \\frac{v^3}{3} + I - w \\right), \\quad\n\\operatorname{sign}\\left(\\frac{dw}{dt}\\right) = \\operatorname{sign}\\left( \\epsilon (v + a - b w) \\right).\n$$\n- 观测符号通过轨迹上的有限差分计算：\n$$\n\\operatorname{sign}\\left(\\frac{dv}{dt}\\bigg|_{\\text{obs}}\\right) = \\operatorname{sign}\\left(\\frac{v(t_{i+1}) - v(t_i)}{t_{i+1} - t_i}\\right), \\quad\n\\operatorname{sign}\\left(\\frac{dw}{dt}\\bigg|_{\\text{obs}}\\right) = \\operatorname{sign}\\left(\\frac{w(t_{i+1}) - w(t_i)}{t_{i+1} - t_i}\\right).\n$$\n- 在验证中排除索引 $i$，条件为 $|\\frac{dv}{dt}|  \\delta_d$ 或 $|\\frac{dw}{dt}|  \\delta_d$，其中 $\\delta_d$ 是一个很小的容差，因为在零斜线附近符号是不可靠的。\n- 符号一致性验证的比例阈值为 $\\theta = 0.9$。\n- 收敛到稳定平衡点的容差（欧几里得范数）为 $\\delta_c = 0.1$。\n\n测试套件：\n对于每个测试用例，都给定了参数 $(a, b, \\epsilon, I)$、时间范围 $T$、初始条件 $(v_0,w_0)$ 和采样步长 $\\Delta t$。您的程序应为每个用例计算一个包含两个布尔值的列表：\n- 第一个布尔值表示符号一致性比例是否超过 $\\theta$。\n- 第二个布尔值表示最终状态与最近的线性稳定平衡点之间的距离是否在 $\\delta_c$ 之内。\n\n使用以下测试用例（所有量均为无量纲）：\n- 用例 1：$a = 0.7$, $b = 0.8$, $\\epsilon = 0.08$, $I = 0.5$, $T = 200.0$, $(v_0,w_0) = (-1.0,-0.5)$, $\\Delta t = 0.1$。\n- 用例 2：$a = 0.7$, $b = 0.8$, $\\epsilon = 0.10$, $I = 0.3$, $T = 200.0$, $(v_0,w_0) = (1.2,-0.6)$, $\\Delta t = 0.1$。\n- 用例 3：$a = 0.7$, $b = 0.8$, $\\epsilon = 0.08$, $I = 1.0$, $T = 200.0$, $(v_0,w_0) = (0.5,0.0)$, $\\Delta t = 0.1$。\n- 用例 4：$a = 0.7$, $b = 0.8$, $\\epsilon = 0.08$, $I = 0.5$, $T = 100.0$, $(v_0,w_0) = (0.0, I)$, $\\Delta t = 0.1$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且本身必须是按上述顺序排列的包含两个布尔值的列表。例如，输出必须如下所示\n$$\n[\\,[\\text{true},\\text{false}],\\,[\\text{true},\\text{true}],\\,[\\text{false},\\text{false}],\\,[\\text{true},\\text{false}]\\,]\n$$\n只是其中的布尔值应为针对所提供测试套件实际计算出的值。角度单位不适用于此问题。没有物理单位；所有量都是无量纲的。运行程序时无需任何修改或外部输入，输出必须是可复现的。",
            "solution": "该问题被评估为有效。它在科学上基于成熟的 FitzHugh–Nagumo 模型和动力系统理论的原理。其目标明确、数学上精确且计算上可行。问题陈述中存在一个轻微的模糊之处，即近零斜线容差 $\\delta_d$ 的值未指定，通过选择一个标准的、很小的数值来解决此问题，这在此类计算问题中是常见的做法。\n\n解决方案是通过实现一个程序来为每个测试用例执行三个指定的任务：1) ODE 系统的数值积分，2) 相平面符号一致性验证，以及 3) 向稳定平衡点的收敛性分析。\n\n解决方案的核心是一个处理每个测试用例的函数。假设给定用例的参数为 $(a, b, \\epsilon, I)$，初始条件为 $(v_0, w_0)$，时间范围为 $T$，采样时间步长为 $\\Delta t$。\n\n首先，在时间区间 $[0, T]$上对常微分方程 (ODE) 系统进行数值积分。\n$$\n\\frac{dv}{dt} = v - \\frac{v^3}{3} - w + I, \\quad \\frac{dw}{dt} = \\epsilon \\left( v + a - b w \\right)\n$$\n初始条件为 $v(0) = v_0$ 和 $w(0) = w_0$。我们使用标准的数值求解器（例如龙格-库塔方法）在等间隔的时间点 $t_i = i \\Delta t$（其中 $i = 0, 1, \\dots, N$，$N=T/\\Delta t$）上生成离散时间轨迹 $\\{(v(t_i), w(t_i))\\}$。\n\n其次，我们找出系统的平衡点 $(v^*, w^*)$ 并对其稳定性进行分类。平衡点是时间导数为零的点，即 $\\frac{dv}{dt} = 0$ 且 $\\frac{dw}{dt} = 0$。这需要找到两个零斜线的交点：\n$$\nw = v - \\frac{v^3}{3} + I \\quad \\text{(v-零斜线)}\n$$\n$$\nw = \\frac{v + a}{b} \\quad \\text{(w-零斜线)}\n$$\n令 $w$ 的表达式相等，得到一个关于平衡点 v 坐标 $v^*$ 的三次多项式方程：\n$$\nv - \\frac{v^3}{3} + I = \\frac{v + a}{b} \\implies \\frac{b}{3}v^3 + (1-b)v + (a - bI) = 0\n$$\n$$\nv^3 + \\frac{3(1-b)}{b}v + \\frac{3(a-bI)}{b} = 0\n$$\n这个三次方程的实根通过数值方法找到。对于每个实根 $v^*$，使用线性的 w-零斜线方程 $w^* = (v^*+a)/b$ 计算出相应的 $w^*$。\n每个平衡点 $(v^*, w^*)$ 的线性稳定性由在该点求值的雅可比矩阵 $J$ 的特征值决定：\n$$\nJ(v^*, w^*) = \\begin{pmatrix} 1 - (v^*)^2  -1 \\\\ \\epsilon  -\\epsilon b \\end{pmatrix}\n$$\n一个平衡点是线性稳定的，当且仅当其雅可比矩阵的迹为负且行列式为正。\n$$\n\\operatorname{tr}(J) = 1 - (v^*)^2 - \\epsilon b  0\n$$\n$$\n\\det(J) = -\\epsilon b(1 - (v^*)^2) - (-1)(\\epsilon) = \\epsilon(1 - b + b(v^*)^2) > 0\n$$\n我们识别并存储所有稳定平衡点的坐标。\n\n第三，我们执行问题要求的两项验证。\n\n第一个布尔结果关系到矢量场符号的一致性。对于计算出的轨迹上的每个点 $(v_i, w_i) = (v(t_i), w(t_i))$（其中 $i=0, \\dots, N-1$），我们比较导数的预测符号与观测符号。\n**预测导数**直接根据在点 $(v_i, w_i)$ 的 ODE 方程计算：\n$$\n\\left(\\frac{dv}{dt}\\right)_{\\text{pred}} = v_i - \\frac{v_i^3}{3} - w_i + I\n$$\n$$\n\\left(\\frac{dw}{dt}\\right)_{\\text{pred}} = \\epsilon(v_i + a - b w_i)\n$$\n**观测导数**使用轨迹数据的向前有限差分进行估计：\n$$\n\\left(\\frac{dv}{dt}\\right)_{\\text{obs}} = \\frac{v_{i+1} - v_i}{\\Delta t}\n$$\n$$\n\\left(\\frac{dw}{dt}\\right)_{\\text{obs}} = \\frac{w_{i+1} - w_i}{\\Delta t}\n$$\n根据问题要求，如果某个点 $i$ 过于靠近零斜线（在此处符号定义不清），则将其从分析中排除。该条件使用预测导数进行检查：如果 $|\\left(\\frac{dv}{dt}\\right)_{\\text{pred}}|  \\delta_d$ 或 $|\\left(\\frac{dw}{dt}\\right)_{\\text{pred}}|  \\delta_d$，我们排除点 $i$。由于容差 $\\delta_d$ 的值未指定，我们选择了一个合理的较小值 $\\delta_d = 10^{-3}$。我们统计非排除点的总数，以及其中满足 $\\operatorname{sign}(\\left(\\frac{dv}{dt}\\right)_{\\text{pred}}) = \\operatorname{sign}(\\left(\\frac{dv}{dt}\\right)_{\\text{obs}})$ 和 $\\operatorname{sign}(\\left(\\frac{dw}{dt}\\right)_{\\text{pred}}) = \\operatorname{sign}(\\left(\\frac{dw}{dt}\\right)_{\\text{obs}})$ 的点的数量。如果符号匹配的点的比例至少达到阈值 $\\theta = 0.9$，则第一个布尔结果为 true。\n\n第二个布尔结果测试是否收敛到稳定平衡点。我们取轨迹的最终状态 $(v(T), w(T))$，并计算它到每个先前确定的稳定平衡点的欧几里得距离。如果没有稳定平衡点，则不可能收敛，结果为 false。否则，我们找到这些距离中的最小值。如果这个最小距离小于收敛容差 $\\delta_c = 0.1$，则第二个布尔值为 true。\n\n对提供的四个测试用例中的每一个都重复此完整过程，并将得到的布尔值对列表格式化为指定的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the FitzHugh-Nagumo model analysis.\n    \"\"\"\n    test_cases = [\n        {'a': 0.7, 'b': 0.8, 'epsilon': 0.08, 'I': 0.5, 'T': 200.0, 'v0': -1.0, 'w0': -0.5, 'dt': 0.1},\n        {'a': 0.7, 'b': 0.8, 'epsilon': 0.10, 'I': 0.3, 'T': 200.0, 'v0': 1.2, 'w0': -0.6, 'dt': 0.1},\n        {'a': 0.7, 'b': 0.8, 'epsilon': 0.08, 'I': 1.0, 'T': 200.0, 'v0': 0.5, 'w0': 0.0, 'dt': 0.1},\n        {'a': 0.7, 'b': 0.8, 'epsilon': 0.08, 'I': 0.5, 'T': 100.0, 'v0': 0.0, 'w0': 0.5, 'dt': 0.1}\n    ]\n    \n    # Tolerances and thresholds from the problem statement or chosen reasonably.\n    delta_d = 1e-3  # Near-nullcline exclusion tolerance.\n    theta = 0.9     # Sign-consistency threshold.\n    delta_c = 0.1   # Convergence tolerance to stable equilibrium.\n\n    all_results = [run_single_case(params, delta_d, theta, delta_c) for params in test_cases]\n    \n    # Format the final output as specified.\n    # str([True, False]) -> '[True, False]' -> .lower() -> '[true, false]'\n    print(f\"[{','.join(str(r).lower() for r in all_results)}]\")\n\ndef fitzhugh_nagumo_rhs(t, y, a, b, epsilon, I):\n    \"\"\"\n    Right-hand side of the FitzHugh-Nagumo ODE system.\n    \"\"\"\n    v, w = y\n    dv_dt = v - v**3 / 3 - w + I\n    dw_dt = epsilon * (v + a - b * w)\n    return [dv_dt, dw_dt]\n\ndef run_single_case(params, delta_d, theta, delta_c):\n    \"\"\"\n    Executes the full analysis for a single test case.\n    \n    Returns:\n        A list of two booleans: [sign_consistency_ok, converged_to_stable_eq].\n    \"\"\"\n    # Unpack parameters for convenience\n    a, b, epsilon, I = params['a'], params['b'], params['epsilon'], params['I']\n    T, v0, w0, dt = params['T'], params['v0'], params['w0'], params['dt']\n\n    # 1. Integrate the system to get the trajectory\n    t_span = [0, T]\n    t_eval = np.arange(0, T + dt, dt)\n    y0 = [v0, w0]\n    \n    sol = solve_ivp(\n        fun=fitzhugh_nagumo_rhs,\n        t_span=t_span,\n        y0=y0,\n        t_eval=t_eval,\n        args=(a, b, epsilon, I),\n        method='RK45'\n    )\n    v_traj, w_traj = sol.y\n    times = sol.t\n\n    # 2. Validate sign-consistency\n    match_count = 0\n    valid_points_count = 0\n    \n    for i in range(len(times) - 1):\n        v, w = v_traj[i], w_traj[i]\n        \n        # Predicted derivatives from the ODE equations\n        dvdt_pred = v - v**3 / 3 - w + I\n        dwdt_pred = epsilon * (v + a - b * w)\n        \n        # Exclude points near nullclines\n        if abs(dvdt_pred)  delta_d or abs(dwdt_pred)  delta_d:\n            continue\n        valid_points_count += 1\n        \n        # Observed derivatives from finite differences\n        dvdt_obs = (v_traj[i+1] - v) / dt\n        dwdt_obs = (w_traj[i+1] - w) / dt\n        \n        # Compare signs\n        if np.sign(dvdt_pred) == np.sign(dvdt_obs) and np.sign(dwdt_pred) == np.sign(dwdt_obs):\n            match_count += 1\n            \n    sign_consistency_ok = (match_count / valid_points_count >= theta) if valid_points_count > 0 else False\n    \n    # 3. Find equilibria and classify their stability\n    # Solve the cubic equation v^3 + p*v + q = 0 for v-coordinates of equilibria\n    p_cubic = 3 * (1 - b) / b\n    q_cubic = 3 * (a - b * I) / b\n    \n    roots = np.roots([1, 0, p_cubic, q_cubic])\n    real_roots_v = [r.real for r in roots if abs(r.imag)  1e-9]\n    \n    stable_equilibria = []\n    for v_star in real_roots_v:\n        w_star = (v_star + a) / b\n        \n        # Stability check using trace and determinant of the Jacobian\n        trace_J = 1 - v_star**2 - epsilon * b\n        det_J = epsilon * (1 - b + b * v_star**2)\n        \n        if trace_J  0 and det_J > 0:\n            stable_equilibria.append(np.array([v_star, w_star]))\n\n    # 4. Test for convergence to a stable equilibrium\n    final_state = np.array([v_traj[-1], w_traj[-1]])\n    converged_to_stable_eq = False\n    if stable_equilibria:\n        distances = [np.linalg.norm(final_state - eq) for eq in stable_equilibria]\n        min_dist = np.min(distances)\n        if min_dist  delta_c:\n            converged_to_stable_eq = True\n            \n    return [sign_consistency_ok, converged_to_stable_eq]\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "在牢固掌握相平面结构之后，我们现在可以利用它来揭示神经元关键的功能特性，例如触发动作电位的阈值。在许多可兴奋系统中，鞍点不动点的不稳定流形扮演着“分界线”的角色，将相空间划分为亚阈值和超阈值区域。这项练习将引导您通过计算来定位这个鞍点并追踪其流形，从而描绘出神经元发放脉冲的精确边界。",
            "id": "4009653",
            "problem": "给定一个二维确定性动力系统，该系统在相平面中模拟一个简化的可兴奋神经元，其灵感来自于Hodgkin–Huxley模型的FitzHugh–Nagumo简化。状态变量为膜电位$v$和一个慢恢复变量$w$，其动力学由以下方程定义\n$$\n\\frac{dv}{dt} = f(v,w) = v - \\frac{v^3}{3} - w + I, \\quad \\frac{dw}{dt} = g(v,w) = \\varepsilon\\,(v + a - b\\,w),\n$$\n其中$I$是外部电流，$\\varepsilon$是一个小的正常数，用于设定$w$的慢时间尺度，$a$是一个偏置参数，$b$是一个耦合参数。该系统的相平面分析涉及$v$-零斜线$f(v,w) = 0$和$w$-零斜线$g(v,w) = 0$。$v$-零斜线是$(v,w)$中的一条三次曲线，中心的“中间分支”对应于$|v|  1$的部分。\n\n从以下基础定义和事实出发：\n- 根据定义，不动点$(v^\\ast, w^\\ast)$满足$f(v^\\ast,w^\\ast) = 0$和$g(v^\\ast,w^\\ast) = 0$。\n- 系统在不动点处计算的雅可比矩阵为\n$$\nJ(v^\\ast,w^\\ast) = \n\\begin{bmatrix}\n\\frac{\\partial f}{\\partial v}(v^\\ast,w^\\ast)  \\frac{\\partial f}{\\partial w}(v^\\ast,w^\\ast) \\\\\n\\frac{\\partial g}{\\partial v}(v^\\ast,w^\\ast)  \\frac{\\partial g}{\\partial w}(v^\\ast,w^\\ast)\n\\end{bmatrix},\n$$\n其元素由给定的$f$和$g$计算得出。\n- 在二维空间中，一个不动点是鞍点的充分必要条件是$\\det(J(v^\\ast,w^\\ast))  0$，这意味着一个特征值的实部为正，另一个特征值的实部为负。\n- 鞍点的不稳定流形在$(v^\\ast,w^\\ast)$处与$J(v^\\ast,w^\\ast)$的那个实部为正的特征值所对应的特征向量相切。从沿该特征向量方向轻微偏移的初始条件开始，随时间向前积分系统的流，即可生成不稳定流形的分支。\n\n您的任务是：\n1. 对于下文测试套件中的每一组参数，找出位于三次$v$-零斜线中间分支上的不動點$(v^\\ast, w^\\ast)$（选择$|v^\\ast|$最小的实数解；如果有多个实数解满足$|v^\\ast|  1$，则选择$|v^\\ast|$最小的那个）。\n2. 计算雅可比矩阵$J(v^\\ast,w^\\ast)$，并通过评估$\\det(J(v^\\ast,w^\\ast))$的符号来判断该不动点是否为鞍点。\n3. 如果该不动点是鞍点，计算不稳定特征向量（与$J$的实部最大的特征值相关联）及其角度$\\theta$（以弧度为单位），该角度从正$v$轴开始测量，通过$\\theta = \\operatorname{atan2}(e_w,e_v)$计算，其中$(e_v,e_w)$是不稳定特征向量的分量。如果最大实部不为正，报告该特征向量的$\\theta$，但要注明对于尖峰测试不存在不稳定流形。\n4. 将不稳定流形分支上的两个邻近点初始化为$(v^\\ast, w^\\ast) \\pm \\delta\\,\\mathbf{e}$，其中$\\mathbf{e}$是归一化为单位长度的不稳定特征向量，$\\delta = 10^{-3}$。使用数值常微分方程求解器，将系统在无量纲时间内向前积分到$T = 200$。通过阈值穿越$v(t) \\geq v_{\\mathrm{spike}}$（$v_{\\mathrm{spike}} = 1.2$）定义一个尖峰检测标准。对于每个分支，记录事件$v(t)$是否在$v(t)$递增的情况下首次穿越$v_{\\mathrm{spike}}$。\n5. 为每组参数报告元组$[v^\\ast, w^\\ast, \\theta, \\text{spike\\_plus}, \\text{spike\\_minus}, \\text{is\\_middle\\_branch}, \\text{is\\_saddle}]$，其中：\n   - $v^\\ast$和$w^\\ast$是浮点数，\n   - $\\theta$是浮点数（以弧度为单位的角度），\n   - $\\text{spike\\_plus}$和$\\text{spike\\_minus}$是分别针对$+\\delta$和$-\\delta$不稳定分支的布尔值，\n   - $\\text{is\\_middle\\_branch}$是一个布尔值，表示$|v^\\ast|  1$是否成立，\n   - $\\text{is\\_saddle}$是一个布尔值，表示$\\det(J(v^\\ast,w^\\ast))  0$是否成立。\n\n仅使用无量纲量；不需要物理单位。角度必须以弧度报告。\n\n测试套件（每个条目为$(\\varepsilon, a, b, I)$）：\n- 情况1（中间分支上存在鞍点的典型可兴奋/尖峰放电）：$(0.08, 0.7, 3.0, 0.5)$。\n- 情况2（边界情况，非双曲不动点）：$(0.08, 0.0, 1.0, 0.0)$。\n- 情况3（无鞍点，行列式为正）：$(0.08, 0.7, 0.2, 0.1)$。\n\n您的程序应生成单行输出，其中包含三个情况的结果，格式为一个由方括号括起来的逗号分隔列表。格式必须为\n$$\n[\\,[v^\\ast_1,w^\\ast_1,\\theta_1,\\text{spike\\_plus}_1,\\text{spike\\_minus}_1,\\text{is\\_middle\\_branch}_1,\\text{is\\_saddle}_1],\\,[v^\\ast_2,w^\\ast_2,\\theta_2,\\text{spike\\_plus}_2,\\text{spike\\_minus}_2,\\text{is\\_middle\\_branch}_2,\\text{is\\_saddle}_2],\\,[v^\\ast_3,w^\\ast_3,\\theta_3,\\text{spike\\_plus}_3,\\text{spike\\_minus}_3,\\text{is\\_middle\\_branch}_3,\\text{is\\_saddle}_3]\\,],\n$$\n布尔值呈现为Python字面量，数字采用标准十进制形式。",
            "solution": "用户提供了一个来自计算神经科学领域的问题，要求对一个类似于FitzHugh-Nagumo系统的简化可兴奋神经元模型进行相平面分析。该问题定义明确，科学上合理，且所有必要的参数和步骤都已指明。这些任务涉及寻找不动点，分析其稳定性，确定其不稳定流形（如果存在）的方向，以及模拟系统轨迹以检查尖峰放电行为。\n\n动力系统由以下常微分方程（ODEs）给出：\n$$\n\\frac{dv}{dt} = f(v,w) = v - \\frac{v^3}{3} - w + I\n$$\n$$\n\\frac{dw}{dt} = g(v,w) = \\varepsilon (v + a - bw)\n$$\n\n将对测试套件中提供的每组参数$(\\varepsilon, a, b, I)$执行求解过程。\n\n**第一步：定位不动点**\n\n系统的不动点$(v^\\ast, w^\\ast)$是一个动力学停止的状态，即$\\frac{dv}{dt} = 0$和$\\frac{dw}{dt} = 0$。这提供了一个由两个代数方程组成的系统：\n1. 从$v$-零斜线，$f(v^\\ast, w^\\ast) = 0$：$v^\\ast - \\frac{(v^\\ast)^3}{3} - w^\\ast + I = 0 \\implies w^\\ast = v^\\ast - \\frac{(v^\\ast)^3}{3} + I$。\n2. 从$w$-零斜线，$g(v^\\ast, w^\\ast) = 0$：由于$\\varepsilon > 0$，这简化为$v^\\ast + a - bw^\\ast = 0$。\n\n将$v$-零斜线中的$w^\\ast$表达式代入$w$-零斜线方程，我们得到一个关于$v^\\ast$的单一方程：\n$$\nv^\\ast + a - b\\left(v^\\ast - \\frac{(v^\\ast)^3}{3} + I\\right) = 0\n$$\n整理后得到一个关于$v^\\ast$的三次多项式方程：\n$$\n\\frac{b}{3}(v^\\ast)^3 + (1-b)v^\\ast + (a-bI) = 0\n$$\n这个三次多项式方程的根决定了不动点的$v$坐标。我们将数值求解此方程以找到其所有根（实数和复数）。然后，我们通过选择虚部绝对值小于一个小的容差（例如，$10^{-9}$）的根来筛选出实数根。根据问题陈述，从实数根集合中，我们必须选择其中绝对值最小的一个，记为$v^\\ast$。\n\n一旦找到$v^\\ast$，相应的$w$坐标$w^\\ast$就从线性的$w$-零斜线方程计算得出：$w^\\ast = \\frac{v^\\ast + a}{b}$（假设$b \\neq 0$，这对所有测试用例都成立）。然后，布尔标志`is_middle_branch`由条件$|v^\\ast|  1$确定。\n\n**第二步：通过雅可比矩阵进行稳定性分析**\n\n不动点$(v^\\ast, w^\\ast)$的稳定性由在该点计算的雅可比矩阵$J$的特征值决定。偏导数是：\n$$\n\\frac{\\partial f}{\\partial v} = 1 - v^2, \\quad \\frac{\\partial f}{\\partial w} = -1\n$$\n$$\n\\frac{\\partial g}{\\partial v} = \\varepsilon, \\quad \\frac{\\partial g}{\\partial w} = -\\varepsilon b\n$$\n因此，在$(v^\\ast, w^\\ast)$处的雅可比矩阵是：\n$$\nJ(v^\\ast,w^\\ast) =\n\\begin{bmatrix}\n1 - (v^\\ast)^2  -1 \\\\\n\\varepsilon  -\\varepsilon b\n\\end{bmatrix}\n$$\n如果一个不动点的雅可比矩阵行列式小于零，即$\\det(J)  0$，则它是一个鞍点。这意味着特征值为实数且符号相反，一个为正（不稳定方向），一个为负（稳定方向）。我们将计算$\\det(J) = (1-(v^\\ast)^2)(-\\varepsilon b) - (-1)(\\varepsilon) = \\varepsilon [1 - b(1-(v^\\ast)^2)]$并相应地设置布尔标志`is_saddle`。\n\n**第三步：不稳定特征向量和角度**\n\n鞍点的不稳定流形与正特征值对应的特征向量相切。更一般地，题目要求的是与实部最大的特征值相关联的特征向量。我们将数值计算$J(v^\\ast, w^\\ast)$的特征值和特征向量。\n\n设$(\\lambda_1, \\lambda_2)$为特征值，$(\\mathbf{e}_1, \\mathbf{e}_2)$为对应的特征向量。我们识别出实部最大的特征值，比如说$\\lambda_k$，以及其对应的特征向量$\\mathbf{e}_k = (e_v, e_w)$。\n该特征向量相对于正$v$轴的角度$\\theta$计算为$\\theta = \\operatorname{atan2}(e_w, e_v)$。\n\n对于特征值为复共轭对的情况（例如，不稳定的螺旋/焦点），需要进行一点澄清。在这种情况下，特征向量也是复数。题目要求一个角度$\\theta$，这意味着一个实值向量。这里将采用一个合理的解释，即使用复特征向量的实部来定义分析方向。如果$\\mathbf{e}_k = \\mathbf{e}_{\\text{real}} + i \\mathbf{e}_{\\text{imag}}$，我们将使用$\\mathbf{e}_{\\text{real}}$的分量来计算$\\theta$。\n\n**第四步：数值积分和尖峰检测**\n\n为了确定从不动点附近开始的轨迹是否产生尖峰，我们对ODE系统进行数值积分。我们定义两个从不动点沿“不稳定”特征向量$\\mathbf{e}$方向扰动的初始条件：\n$$\n\\mathbf{y}_{0, \\text{plus}} = (v^\\ast, w^\\ast) + \\delta \\hat{\\mathbf{e}}\n$$\n$$\n\\mathbf{y}_{0, \\text{minus}} = (v^\\ast, w^\\ast) - \\delta \\hat{\\mathbf{e}}\n$$\n其中$\\hat{\\mathbf{e}}$是归一化的（单位长度）特征向量方向向量（如上所述，其实部），$\\delta = 10^{-3}$是扰动大小。\n\n我们将使用`scipy.integrate`库中的`solve_ivp`函数对两个初始条件从$t=0$到$T=200$积分系统。尖峰检测是使用`solve_ivp`的事件处理功能实现的。尖峰被定义为轨迹以正速度（$dv/dt > 0$）穿过阈值$v(t) = v_{\\text{spike}} = 1.2$的事件。事件函数是$v(t) - 1.2$，我们寻找一个递增方向上的穿越。如果为`plus`分支检测到该事件，则`spike_plus`为`True`；否则为`False`。相同的逻辑适用于`minus`分支的`spike_minus`。\n\n**第五步：汇编最终报告**\n\n对于每组参数，计算出的值——$v^\\ast$、$w^\\ast$、$\\theta$、`spike_plus`、`spike_minus`、`is_middle_branch`和`is_saddle`——被收集到一个列表中。最终输出是包含所有测试用例的这些结果列表的列表，并按指定格式进行格式化。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It iterates through parameter sets, analyzes the system for each,\n    and prints the formatted results.\n    \"\"\"\n    # Test suite: each entry is a tuple (epsilon, a, b, I)\n    test_cases = [\n        (0.08, 0.7, 3.0, 0.5),  # Case 1: Saddle on middle branch\n        (0.08, 0.0, 1.0, 0.0),  # Case 2: Non-hyperbolic fixed point\n        (0.08, 0.7, 0.2, 0.1)   # Case 3: Unstable focus\n    ]\n\n    results = []\n    for params in test_cases:\n        epsilon, a, b, I = params\n        result = analyze_system(epsilon, a, b, I)\n        results.append(result)\n\n    # Format the final output string as a list of lists.\n    # The conversion to string handles boolean literals correctly.\n    formatted_results = f\"[{','.join(map(str, results))}]\"\n    print(formatted_results)\n\ndef analyze_system(epsilon, a, b, I):\n    \"\"\"\n    Analyzes the FitzHugh-Nagumo-like system for a given set of parameters.\n    \n    Returns:\n        A list containing [v_star, w_star, theta, spike_plus, spike_minus,\n        is_middle_branch, is_saddle].\n    \"\"\"\n    # 1. Find the fixed point (v*, w*)\n    # The v-coordinate of the fixed point is a root of a cubic polynomial:\n    # (b/3)*v^3 + (1-b)*v + (a-b*I) = 0\n    poly_coeffs = [b / 3.0, 0, 1 - b, a - b * I]\n    roots = np.roots(poly_coeffs)\n\n    # Filter for real roots (imaginary part is negligible)\n    real_roots = roots[np.abs(np.imag(roots))  1e-9]\n    real_roots = np.real(real_roots)\n\n    # Select the real root with the minimum absolute value\n    if len(real_roots) == 0:\n        # This should not happen for the given test cases\n        raise ValueError(\"No real roots found for the fixed point equation.\")\n    v_star = real_roots[np.argmin(np.abs(real_roots))]\n    \n    # Calculate w_star from the w-nullcline\n    if abs(b)  1e-9: # Handle b=0 case, though not in test suite\n        w_star = np.nan # Undefined, but here v_star must be -a\n    else:\n        w_star = (v_star + a) / b\n\n    is_middle_branch = abs(v_star)  1.0\n\n    # 2. Compute Jacobian matrix and stability\n    J = np.array([\n        [1 - v_star**2, -1],\n        [epsilon, -epsilon * b]\n    ])\n    det_J = np.linalg.det(J)\n    is_saddle = det_J  0\n\n    # 3. Compute eigenvalues and the \"unstable\" eigenvector\n    eigvals, eigvecs = np.linalg.eig(J)\n    \n    # Find eigenvector corresponding to eigenvalue with largest real part\n    idx_unstable = np.argmax(np.real(eigvals))\n    unstable_eigvec = eigvecs[:, idx_unstable]\n    \n    # Eigenvector can be complex. We use its real part to define a direction.\n    # This is a necessary interpretation for cases with spiral dynamics.\n    e_v, e_w = np.real(unstable_eigvec)\n    \n    # Calculate angle theta\n    theta = np.arctan2(e_w, e_v)\n\n    # 4. Numerical integration to check for spikes\n    delta = 1e-3\n    t_span = (0, 200)\n    v_spike_threshold = 1.2\n    \n    # Normalize the direction vector\n    eigvec_real_part = np.real(unstable_eigvec)\n    norm = np.linalg.norm(eigvec_real_part)\n    if norm > 1e-9:\n        unit_eigvec = eigvec_real_part / norm\n    else: # Should not happen in these cases, but for robustness\n        unit_eigvec = np.array([1.0, 0.0])\n\n    # ODE system definition\n    def fhn_ode(t, y, epsilon, a, b, I):\n        v, w = y\n        dvdt = v - v**3 / 3 - w + I\n        dwdt = epsilon * (v + a - b * w)\n        return [dvdt, dwdt]\n\n    # Spike detection event function for solve_ivp\n    def spike_event(t, y, *args):\n        return y[0] - v_spike_threshold\n    spike_event.terminal = True  # Stop integration after first spike\n    spike_event.direction = 1    # Detect crossing from negative to positive\n\n    y_star = np.array([v_star, w_star])\n    \n    # Check +delta branch\n    y0_plus = y_star + delta * unit_eigvec\n    sol_plus = solve_ivp(fhn_ode, t_span, y0_plus, args=(epsilon, a, b, I),\n                         events=spike_event, dense_output=True)\n    spike_plus = len(sol_plus.t_events[0]) > 0\n\n    # Check -delta branch\n    y0_minus = y_star - delta * unit_eigvec\n    sol_minus = solve_ivp(fhn_ode, t_span, y0_minus, args=(epsilon, a, b, I),\n                          events=spike_event, dense_output=True)\n    spike_minus = len(sol_minus.t_events[0]) > 0\n    \n    # 5. Assemble results\n    return [\n        v_star,\n        w_star,\n        theta,\n        spike_plus,\n        spike_minus,\n        is_middle_branch,\n        is_saddle\n    ]\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "除了单个脉冲，相平面分析在理解节律性活动（例如慢快系统中的弛豫振荡）方面也十分强大。这些振荡由沿着零斜线吸引分支的缓慢移动和其间的快速跳转组成。在这个高级实践中，您将利用这种几何理解，通过推导和数值计算遍历极限环缓慢部分所需的时间来估算振荡周期。",
            "id": "4009602",
            "problem": "考虑平面快慢神经元模型，它是 FitzHugh–Nagumo 系统的一种无量纲形式，由膜电压变量 $V$ 和恢复变量 $w$ 的常微分方程 (ODE; ordinary differential equation) 定义：\n$$\n\\frac{dV}{dt} = f(V,w) = V - \\frac{V^3}{3} - w + I,\n$$\n$$\n\\frac{dw}{dt} = g(V,w) = \\epsilon \\left(V + a - b\\,w\\right),\n$$\n其中 $I$、$a$、$b$ 和 $\\epsilon$ 是参数，且 $0  \\epsilon \\ll 1$。$V$-零斜线是满足 $\\frac{dV}{dt} = 0$（即 $f(V,w) = 0$）的点集，由此得出代数关系：\n$$\nw = W(V; I) = V - \\frac{V^3}{3} + I.\n$$\n假设系统处于弛豫振荡状态，其轨迹在 $V$-零斜线的吸引分支上的慢演化与分支间的快跳跃之间交替。对于将 $w$ 视为参数的快子系统，$V$-零斜线的吸引分支出现在 $\\frac{\\partial f}{\\partial V} = 1 - V^2  0$ 的地方，即 $V  -1$（左吸引分支）和 $V > 1$（右吸引分支）。折叠点（膝点）位于 $V = -1$ 和 $V = 1$。\n\n在快跳跃过程 $w$ 守恒且在指定的微小持续时间内瞬时发生的近似下，对侧吸引分支上的落点通过求解由膝点处的 $w$ 值设定的 $W(V; I) = \\text{constant}$ 来确定。对于上述三次函数 $W(V; I)$，奇异快跳跃连接 $V = -1$ 到 $V = 2$ 以及 $V = 1$ 到 $V = -2$。因此，在一个振荡周期内，慢演化沿着以下路径发生：\n- 从 $V = -2$ 到 $V = -1$ 的左吸引分支，\n- 从 $V = 2$ 到 $V = 1$ 的右吸引分支。\n\n您的任务是通过将沿这两个吸引分支的慢通道时间与指定的快跳跃持续时间相加来估计振荡周期 $T$。您必须从基本定义和定律（链式法则、零斜线约束以及慢动力学在不变流形上的投影）出发，推导沿每个分支评估慢通道时间积分的数值计算过程。您不得假设或使用任何给定的快捷公式。使用数值积分方法来评估以 $V$ 和 $W(V; I)$ 表示的所需积分，并加上给定的快跳跃时间，以获得每个参数集的 $T$。\n\n实现一个程序，为每个参数集计算：\n- 从 $V = -2$ 到 $V = -1$ 在左分支上花费的时间，\n- 从 $V = 2$ 到 $V = 1$ 在右分支上花费的时间，\n- 两个指定的快跳跃持续时间的总和，\n并将总周期 $T$ 作为浮点数返回。\n\n您的程序必须产生单行输出，其中包含一个逗号分隔的浮点数列表形式的结果，每个浮点数四舍五入到六位小数，并用方括号括起来（例如：\"[$t_1$, $t_2$, $t_3$]）。\n\n使用以下测试套件，表示为元组 $(\\epsilon, a, b, I, \\tau_1, \\tau_2)$，其中 $\\tau_1$ 和 $\\tau_2$ 是两次快跳跃的持续时间（与 $t$ 的时间单位相同，均为无量纲）：\n\n- 测试用例 1（一般情况）：$(0.05, 0.7, 0.8, 0.5, 0.0, 0.0)$。\n- 测试用例 2（更小的 $\\epsilon$ 边界）：$(0.01, 0.7, 0.8, 0.5, 0.0, 0.0)$。\n- 测试用例 3（$w$-方程中无耦合，非零跳跃时间）：$(0.05, 0.7, 0.0, 0.5, 0.005, 0.005)$。\n- 测试用例 4（负 $a$，中等 $b$）：$(0.03, -0.2, 0.5, 0.3, 0.01, 0.02)$。\n- 测试用例 5（非常小的 $\\epsilon$，更强的 $b$）：$(0.005, 0.2, 1.0, 0.0, 0.0, 0.0)$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如：\"[$result_1$, $result_2$, $result_3$, $result_4$, $result_5$]\"），其中每个 $result_i$ 是相应测试用例的估计周期 $T$，四舍五入到六位小数。不允许有其他输出。",
            "solution": "该问题是有效的。这是一个基于已有的 FitzHugh–Nagumo 模型的计算神经科学和动力系统领域的适定问题。所提供的参数和条件是完整、一致且科学上合理的。\n\n目标是估计一个快慢平面系统中弛豫振荡的周期 $T$。总周期是沿 $V$-零斜线的两个慢分支演化所花费的时间与两次快跳跃持续时间之和。\n$$\nT = T_{\\text{left}} + T_{\\text{right}} + \\tau_{\\text{jumps}}\n$$\n其中 $T_{\\text{left}}$ 是在左吸引分支上的时间，$T_{\\text{right}}$ 是在右吸引分支上的时间，而 $\\tau_{\\text{jumps}} = \\tau_1 + \\tau_2$ 是指定的快跳跃总持续时间。\n\n问题的核心是从基本原理出发，推导出慢通道时间 $T_{\\text{left}}$ 和 $T_{\\text{right}}$ 的表达式。系统动力学由以下方程决定：\n$$\n\\frac{dV}{dt} = V - \\frac{V^3}{3} - w + I\n$$\n$$\n\\frac{dw}{dt} = \\epsilon \\left(V + a - b\\,w\\right)\n$$\n在 $\\epsilon$ 非常小（$0  \\epsilon \\ll 1$）的极限情况下，系统表现出快慢动力学特性。变量 $V$ 是快变量，$w$ 是慢变量。在振荡的慢速阶段，轨迹被约束在 $V$-零斜线的稳定分支上，该稳定分支通过设置 $\\frac{dV}{dt} = 0$ 来定义：\n$$\nw = W(V; I) = V - \\frac{V^3}{3} + I\n$$\n该方程表示慢演化过程中 $V$ 和 $w$ 之间的代数约束。为了找到 $V$ 沿着该零斜线的有效动力学，我们可以使用链式法则对该约束关于时间 $t$ 求导：\n$$\n\\frac{dw}{dt} = \\frac{d}{dt} \\left( V(t) - \\frac{V(t)^3}{3} + I \\right) = \\left( 1 - V^2 \\right) \\frac{dV}{dt}\n$$\n我们从原始系统方程中可以得到关于 $\\frac{dw}{dt}$ 的第二个表达式。通过令这两个表达式相等，我们可以描述投影到慢流形上的系统演化：\n$$\n\\left( 1 - V^2 \\right) \\frac{dV}{dt} = \\epsilon \\left(V + a - b\\,w\\right)\n$$\n现在，我们通过将 $w = W(V; I)$ 代入方程右侧来施加慢流形约束：\n$$\n\\left( 1 - V^2 \\right) \\frac{dV}{dt} = \\epsilon \\left(V + a - b\\left[V - \\frac{V^3}{3} + I\\right]\\right)\n$$\n这得出了一个在慢演化阶段有效的、关于 $V(t)$ 的单一常微分方程：\n$$\n\\frac{dV}{dt} = \\frac{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)}{1 - V^2}\n$$\n为了求出 $V$ 从起始值 $V_{\\text{start}}$ 移动到结束值 $V_{\\text{end}}$ 所需的时间，我们重排方程以分离变量并进行积分：\n$$\ndt = \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\n一个慢速段的总时间是 $dt$ 的积分：\n$$\nT_{\\text{slow}} = \\int_{V_{\\text{start}}}^{V_{\\text{end}}} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\n现在，这个通用公式可以应用于问题中描述的振荡周期的两个特定分段。\n\n$1$. 在左分支上花费的时间 $T_{\\text{left}}$，系统从 $V = -2$ 演化到 $V = -1$：\n$$\nT_{\\text{left}} = \\int_{-2}^{-1} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\n在这个区间内，$V$ 增大，所以 $\\frac{dV}{dt} > 0$。对于 $V \\in [-2, -1]$，项 $1-V^2$ 为负。因此，分母中的多项式也必须为负，以确保被积函数为正。\n\n$2$. 在右分支上花费的时间 $T_{\\text{right}}$，系统从 $V = 2$ 演化到 $V = 1$：\n$$\nT_{\\text{right}} = \\int_{2}^{1} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\n在这个区间内，$V$ 减小，所以 $\\frac{dV}{dt}  0$。对于 $V \\in [1, 2]$，项 $1-V^2$ 为负。因此，分母中的多项式必须为正。这使得被积函数为负。然而，从较大的积分上限 ($V=2$) 积分到较小的积分下限 ($V=1$) 能正确地得到一个正的时间持续。\n\n这些积分通常没有简单的闭式解析解，必须使用数值积分进行评估。然后，每个参数集 $(\\epsilon, a, b, I, \\tau_1, \\tau_2)$ 的最终周期 $T$ 计算如下：\n$$\nT = T_{\\text{left}} + T_{\\text{right}} + \\tau_1 + \\tau_2\n$$\n数值实现将为被积函数定义一个函数，并使用科学库函数（如 `scipy.integrate.quad`）来计算 $T_{\\text{left}}$ 和 $T_{\\text{right}}$ 的定积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the estimated period of a relaxation oscillation in a FitzHugh-Nagumo model\n    for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is of the form (epsilon, a, b, I, tau1, tau2)\n    test_cases = [\n        (0.05, 0.7, 0.8, 0.5, 0.0, 0.0),        # Test case 1\n        (0.01, 0.7, 0.8, 0.5, 0.0, 0.0),        # Test case 2\n        (0.05, 0.7, 0.0, 0.5, 0.005, 0.005),    # Test case 3\n        (0.03, -0.2, 0.5, 0.3, 0.01, 0.02),     # Test case 4\n        (0.005, 0.2, 1.0, 0.0, 0.0, 0.0),       # Test case 5\n    ]\n\n    # This function defines the integrand for the slow passage time calculation.\n    # It corresponds to dt/dV.\n    def time_integrand(V, epsilon, a, b, I):\n        \"\"\"\n        Integrand for calculating slow passage time, derived from the system dynamics.\n        \n        Args:\n            V (float): The voltage variable.\n            epsilon (float): The slow-fast time scale parameter.\n            a (float): Parameter in the recovery variable equation.\n            b (float): Parameter in the recovery variable equation.\n            I (float): External current parameter.\n            \n        Returns:\n            float: The value of dt/dV at a given V.\n        \"\"\"\n        numerator = 1.0 - V**2\n        # The denominator is epsilon * P(V), where P(V) is a polynomial in V.\n        denominator = epsilon * (b / 3.0 * V**3 + (1.0 - b) * V + (a - b * I))\n        \n        # Avoid division by zero, though for a well-posed relaxation oscillator,\n        # the denominator should not be zero in the integration ranges.\n        if denominator == 0:\n            return np.inf\n\n        return numerator / denominator\n\n    total_periods = []\n    for params in test_cases:\n        epsilon, a, b, I, tau1, tau2 = params\n\n        # Component 1: Time spent on the left branch (V from -2 to -1)\n        # quad returns a tuple (result, error_estimate)\n        t_left, _ = quad(time_integrand, -2.0, -1.0, args=(epsilon, a, b, I))\n\n        # Component 2: Time spent on the right branch (V from 2 to 1)\n        t_right, _ = quad(time_integrand, 2.0, 1.0, args=(epsilon, a, b, I))\n\n        # Component 3: Sum of fast jump durations\n        t_jumps = tau1 + tau2\n        \n        # Total period is the sum of all components\n        total_period = t_left + t_right + t_jumps\n        total_periods.append(total_period)\n\n    # Format the results as a list of strings, each rounded to six decimal places.\n    formatted_results = [f\"{period:.6f}\" for period in total_periods]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}