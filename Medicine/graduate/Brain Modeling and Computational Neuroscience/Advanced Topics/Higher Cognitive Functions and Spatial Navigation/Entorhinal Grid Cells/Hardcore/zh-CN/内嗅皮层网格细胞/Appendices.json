{
    "hands_on_practices": [
        {
            "introduction": "网格细胞的一个关键特征是其空间周期性的放电模式，这种模式形成了一个六边形晶格。为了定量地描述这种卓越的结构，我们可以使用傅里叶分析这一分析周期性信号的强大工具。本练习将引导你推导一个经典网格细胞放电率图的二维傅里叶变换，从而揭示出频域中独特的“布拉格峰”六边形模式，它构成了网格结构的独特指纹。",
            "id": "3978907",
            "problem": "内侧内嗅皮层中的一个神经元在平面上表现出六边形阵列的发放场。将空间发放率建模为一个位于三角布拉维晶格上的相同场的总和，外加一个恒定的基线。具体来说，设该三角晶格由基矢 $\\mathbf{a}_{1} = a(1,0)$ 和 $\\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$ 生成，其中 $a > 0$ 是最近邻晶格间距，$\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 之间的夹角为 $60^\\circ$。发放率为\n$$\nr(\\mathbf{x}) \\;=\\; r_{b} \\;+\\; \\sum_{\\mathbf{R}\\in\\Lambda} A \\,\\exp\\!\\left(-\\frac{|\\mathbf{x}-\\mathbf{R}|^{2}}{2\\sigma^{2}}\\right),\n$$\n其中 $\\Lambda = \\{n_{1}\\mathbf{a}_{1} + n_{2}\\mathbf{a}_{2} \\,:\\, n_{1},n_{2}\\in\\mathbb{Z}\\}$，$A>0$ 是每个高斯场中心处超出基线的峰值高度，$\\sigma>0$ 是场宽度，$r_{b}\\ge 0$ 是基线发放率。\n\n仅使用二维傅里叶变换的定义\n$$\n\\hat{r}(\\mathbf{k}) \\;=\\; \\int_{\\mathbb{R}^{2}} r(\\mathbf{x}) \\,\\exp\\!\\big(-i\\,\\mathbf{k}\\cdot\\mathbf{x}\\big)\\,d^{2}\\mathbf{x},\n$$\n以及关于布拉维晶格的泊松求和公式的成熟结果，推导 $\\hat{r}(\\mathbf{k})$ 的谱表示，并确定其布拉格峰的位置。然后，关注第一个倒易晶格壳层（三角晶格的六个最短非零倒易矢量），将这六个波矢中任意一个处的狄拉克δ函数的振幅系数确定为一个仅含 $A$、$a$ 和 $\\sigma$ 的闭式解析表达式。您的最终答案必须是单个闭式表达式。请勿近似或四舍五入。无需单位。需要时，角度请以度为单位。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且自洽。该模型是内嗅皮层网格细胞发放场的典型表示，这是计算神经科学的基石。该任务是傅里叶分析在周期性结构上的标准应用，这是一项在物理学和工程学中广泛使用的技术。所有参数和条件都已明确定义，从而导出一个唯一且有意义的解。该问题是有效的。\n\n空间发放率 $r(\\mathbf{x})$ 由下式给出：\n$$\nr(\\mathbf{x}) = r_{b} + \\sum_{\\mathbf{R}\\in\\Lambda} A \\,\\exp\\left(-\\frac{|\\mathbf{x}-\\mathbf{R}|^{2}}{2\\sigma^{2}}\\right)\n$$\n其中 $r_b$ 是一个恒定的基线发放率，求和项代表发放场的周期性排列。我们可以将函数分成两部分：$r(\\mathbf{x}) = r_b + f(\\mathbf{x})$，其中\n$$\nf(\\mathbf{x}) = \\sum_{\\mathbf{R}\\in\\Lambda} A g(\\mathbf{x}-\\mathbf{R})\n$$\n其中 $g(\\mathbf{x}) = \\exp\\left(-\\frac{|\\mathbf{x}|^{2}}{2\\sigma^{2}}\\right)$。\n\n傅里叶变换是线性算子，所以 $r(\\mathbf{x})$ 的傅里叶变换，记作 $\\hat{r}(\\mathbf{k})$，是其各部分变换的和：\n$$\n\\hat{r}(\\mathbf{k}) = \\mathcal{F}\\{r_b\\} + \\mathcal{F}\\{f(\\mathbf{x})\\}\n$$\n恒定基线发放率 $r_b$ 的傅里叶变换是频域原点处的狄拉克δ函数：\n$$\n\\mathcal{F}\\{r_b\\} = \\int_{\\mathbb{R}^2} r_b e^{-i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{x} = r_b (2\\pi)^2 \\delta(\\mathbf{k})\n$$\n其中 $\\delta(\\mathbf{k})$ 是二维狄拉克δ函数。该项仅对频谱的直流分量（$\\mathbf{k}=\\mathbf{0}$）有贡献。\n\n第二项 $f(\\mathbf{x})$ 可以表示为单个场形状 $A g(\\mathbf{x})$ 与代表晶格点的狄拉克梳 $S(\\mathbf{x})$ 的卷积：\n$$\nf(\\mathbf{x}) = A \\cdot (g * S)(\\mathbf{x})\n$$\n其中 $S(\\mathbf{x}) = \\sum_{\\mathbf{R}\\in\\Lambda} \\delta(\\mathbf{x}-\\mathbf{R})$。\n\n根据卷积定理，卷积的傅里叶变换是各傅里叶变换的乘积：\n$$\n\\hat{f}(\\mathbf{k}) = A \\cdot \\hat{g}(\\mathbf{k}) \\cdot \\hat{S}(\\mathbf{k})\n$$\n首先，我们求高斯函数 $g(\\mathbf{x})$ 的傅里叶变换。这是一个标准结果：高斯函数的傅里叶变换也是一个高斯函数。对于一个二维高斯函数 $g(\\mathbf{x}) = \\exp(-\\alpha|\\mathbf{x}|^2)$，其傅里叶变换为 $\\hat{g}(\\mathbf{k}) = \\frac{\\pi}{\\alpha}\\exp(-|\\mathbf{k}|^2/(4\\alpha))$。在我们的情况下，$\\alpha = 1/(2\\sigma^2)$，因此：\n$$\n\\hat{g}(\\mathbf{k}) = \\frac{\\pi}{1/(2\\sigma^2)} \\exp\\left( -\\frac{|\\mathbf{k}|^2}{4/(2\\sigma^2)} \\right) = 2\\pi\\sigma^2 \\exp\\left( -\\frac{\\sigma^2|\\mathbf{k}|^2}{2} \\right)\n$$\n接下来，我们求狄拉克梳 $S(\\mathbf{x})$ 的傅里叶变换。布拉维晶格的泊松求和公式指出，实空间中δ函数晶格的傅里叶变换是倒易空间中的δ函数晶格。结果是：\n$$\n\\hat{S}(\\mathbf{k}) = \\frac{(2\\pi)^2}{V_{\\text{cell}}} \\sum_{\\mathbf{K}\\in\\Lambda^*} \\delta(\\mathbf{k}-\\mathbf{K})\n$$\n其中 $\\Lambda^*$ 是倒易晶格，$V_{\\text{cell}}$ 是实空间晶胞的面积。\n\n实空间晶胞是由基矢 $\\mathbf{a}_{1} = a(1,0)$ 和 $\\mathbf{a}_{2} = a(1/2, \\sqrt{3}/2)$ 张成的平行四边形。其面积由它们叉积的模给出，或者在二维情况下，由它们构成的矩阵的行列式给出：\n$$\nV_{\\text{cell}} = \\left| \\det \\begin{pmatrix} a  a/2 \\\\ 0  a\\sqrt{3}/2 \\end{pmatrix} \\right| = \\left| a \\cdot \\frac{a\\sqrt{3}}{2} - 0 \\cdot \\frac{a}{2} \\right| = \\frac{\\sqrt{3}}{2}a^2\n$$\n倒易晶格 $\\Lambda^*$ 由满足 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 的基矢 $\\mathbf{b}_1, \\mathbf{b}_2$ 张成。求解该方程组可得一组倒易基矢。对于三角晶格，其倒易晶格也是一个三角（六边形）晶格。倒易晶格的第一个壳层由六个最短的非零波矢 $\\mathbf{K}$ 组成。该壳层中的所有矢量都具有相同的模，我们记为 $K_1$。对于最近邻间距为 $a$ 的三角晶格，已知该模为：\n$$\nK_1 = |\\mathbf{K}| = \\frac{4\\pi}{a\\sqrt{3}}\n$$\n因此，模的平方为：\n$$\n|\\mathbf{K}|^2 = K_1^2 = \\frac{16\\pi^2}{3a^2}\n$$\n现在，我们结合 $\\hat{g}(\\mathbf{k})$ 和 $\\hat{S}(\\mathbf{k})$ 的表达式来求 $\\hat{f}(\\mathbf{k})$：\n$$\n\\hat{f}(\\mathbf{k}) = A \\left( 2\\pi\\sigma^2 \\exp\\left(-\\frac{\\sigma^2|\\mathbf{k}|^2}{2}\\right) \\right) \\left( \\frac{(2\\pi)^2}{V_{\\text{cell}}} \\sum_{\\mathbf{K}\\in\\Lambda^*} \\delta(\\mathbf{k}-\\mathbf{K}) \\right)\n$$\n使用δ函数的筛选性质，$h(\\mathbf{k})\\delta(\\mathbf{k}-\\mathbf{K}) = h(\\mathbf{K})\\delta(\\mathbf{k}-\\mathbf{K})$，我们得到：\n$$\n\\hat{f}(\\mathbf{k}) = \\frac{A(2\\pi)^3\\sigma^2}{V_{\\text{cell}}} \\sum_{\\mathbf{K}\\in\\Lambda^*} \\exp\\left(-\\frac{\\sigma^2|\\mathbf{K}|^2}{2}\\right) \\delta(\\mathbf{k}-\\mathbf{K})\n$$\n完整的谱 $\\hat{r}(\\mathbf{k})$ 是：\n$$\n\\hat{r}(\\mathbf{k}) = (2\\pi)^2 r_b \\delta(\\mathbf{k}) + \\frac{A(2\\pi)^3\\sigma^2}{V_{\\text{cell}}} \\sum_{\\mathbf{K}\\in\\Lambda^*} \\exp\\left(-\\frac{\\sigma^2|\\mathbf{K}|^2}{2}\\right) \\delta(\\mathbf{k}-\\mathbf{K})\n$$\n该表达式表明，谱由位于倒易晶格矢量 $\\mathbf{K}$ 位置的离散布拉格峰组成。\n\n问题要求的是第一个倒易晶格壳层中六个波矢任意一个处的狄拉克δ函数的振幅系数。这些对应于具有最小模 $|\\mathbf{K}| = K_1$ 的六个非零矢量 $\\mathbf{K}$。设 $C_{K_1}$ 为该系数。根据 $\\hat{f}(\\mathbf{k})$ 的表达式，该系数为：\n$$\nC_{K_1} = \\frac{A(2\\pi)^3\\sigma^2}{V_{\\text{cell}}} \\exp\\left(-\\frac{\\sigma^2 K_1^2}{2}\\right)\n$$\n代入 $V_{\\text{cell}} = \\frac{\\sqrt{3}}{2}a^2$ 和 $K_1^2 = \\frac{16\\pi^2}{3a^2}$：\n$$\nC_{K_1} = \\frac{A(8\\pi^3)\\sigma^2}{\\frac{\\sqrt{3}}{2}a^2} \\exp\\left(-\\frac{\\sigma^2}{2} \\cdot \\frac{16\\pi^2}{3a^2}\\right)\n$$\n化简前置因子和指数，得到最终表达式：\n$$\nC_{K_1} = \\frac{16\\pi^3 A \\sigma^2}{\\sqrt{3} a^2} \\exp\\left(-\\frac{8\\pi^2\\sigma^2}{3a^2}\\right)\n$$\n这就是空间频率域中任意一个主布拉格峰的振幅系数的闭式解析表达式，用给定的参数 $A$、$a$ 和 $\\sigma$ 表示。",
            "answer": "$$\n\\boxed{\\frac{16 \\pi^3 A \\sigma^2}{\\sqrt{3} a^2} \\exp\\left(-\\frac{8\\pi^2\\sigma^2}{3a^2}\\right)}\n$$"
        },
        {
            "introduction": "在理解了网格细胞的静态结构后，我们转向其动态功能：路径整合，即通过整合运动信息来追踪自身位置。本练习探讨了这一过程中的一个关键问题：速度信号中的噪声如何导致内部位置估计的误差累积。通过推导这种误差随时间的增长方式，你将理解这种神经计算的一个基本限制。",
            "id": "3978900",
            "problem": "考虑一个由连续吸引子网络 (CAN) 实现的内嗅皮层网格细胞的最小路径整合模型。该CAN通过根据运动学恒等式 $\\frac{d\\hat{\\mathbf{r}}}{dt}=\\mathbf{v}_{\\text{obs}}(t)$ 整合速度编码的输入，来编码一个二维位置估计 $\\hat{\\mathbf{r}}(t) \\in \\mathbb{R}^{2}$，其中 $\\mathbf{v}_{\\text{obs}}(t)$ 是由上游神经元传递的观测速度信号。假设真实速度是恒定的，$\\mathbf{v}_{0} \\in \\mathbb{R}^{2}$，且观测噪声是加性高斯白噪声，因此 $\\mathbf{v}_{\\text{obs}}(t)=\\mathbf{v}_{0}+\\boldsymbol{\\eta}(t)$，其中 $\\mathbb{E}[\\boldsymbol{\\eta}(t)]=\\mathbf{0}$，分量协方差为 $\\mathbb{E}[\\eta_{i}(t)\\eta_{j}(t^{\\prime})]=2D\\,\\delta_{ij}\\,\\delta(t-t^{\\prime})$。这里，$D>0$ 是一个扩散常数，$\\delta_{ij}$ 是克罗内克δ（Kronecker delta），$\\delta(\\cdot)$ 是狄拉克δ（Dirac delta）。真实位置遵循 $\\frac{d\\mathbf{r}}{dt}=\\mathbf{v}_{0}$。\n\n定义位置误差为 $\\mathbf{e}(t)=\\hat{\\mathbf{r}}(t)-\\mathbf{r}(t)$。从上述定义和高斯白噪声的性质出发，推导在二维情况（$d=2$）下均方根误差大小 $\\sqrt{\\mathbb{E}[|\\mathbf{e}(t)|^{2}]}$ 的闭式表达式，并用 $D$ 和 $t$ 表示。您的答案必须是单个解析表达式。将最终的大小以米为单位表示。不提供中间或目标公式；请基于随机积分的第一性原理和给定的噪声统计特性进行推导。",
            "solution": "连续吸引子网络 (CAN) 通过运动学关系 $\\frac{d\\hat{\\mathbf{r}}}{dt}=\\mathbf{v}_{\\text{obs}}(t)$ 实现路径整合。在 $\\mathbf{v}_{\\text{obs}}(t)=\\mathbf{v}_{0}+\\boldsymbol{\\eta}(t)$ 且真实位置遵循 $\\frac{d\\mathbf{r}}{dt}=\\mathbf{v}_{0}$ 的条件下，我们对两者进行积分以获得位置估计和真实位置：\n$$\n\\hat{\\mathbf{r}}(t)=\\hat{\\mathbf{r}}(0)+\\int_{0}^{t}\\mathbf{v}_{\\text{obs}}(s)\\,ds=\\hat{\\mathbf{r}}(0)+\\int_{0}^{t}\\mathbf{v}_{0}\\,ds+\\int_{0}^{t}\\boldsymbol{\\eta}(s)\\,ds,\n$$\n$$\n\\mathbf{r}(t)=\\mathbf{r}(0)+\\int_{0}^{t}\\mathbf{v}_{0}\\,ds.\n$$\n两式相减，误差为\n$$\n\\mathbf{e}(t)=\\hat{\\mathbf{r}}(t)-\\mathbf{r}(t)=\\left[\\hat{\\mathbf{r}}(0)-\\mathbf{r}(0)\\right]+\\int_{0}^{t}\\boldsymbol{\\eta}(s)\\,ds.\n$$\n如果初始对齐是精确的，即 $\\hat{\\mathbf{r}}(0)=\\mathbf{r}(0)$，那么\n$$\n\\mathbf{e}(t)=\\int_{0}^{t}\\boldsymbol{\\eta}(s)\\,ds.\n$$\n我们寻求均方根误差大小 $\\sqrt{\\mathbb{E}[|\\mathbf{e}(t)|^{2}]}$。由于 $\\boldsymbol{\\eta}(t)$ 是零均值高斯白噪声，其协方差为 $\\mathbb{E}[\\eta_{i}(t)\\eta_{j}(t^{\\prime})]=2D\\,\\delta_{ij}\\,\\delta(t-t^{\\prime})$，因此白噪声的积分会产生一个维纳过程（Wiener process），其方差随时间线性增长。我们按分量计算 $\\mathbf{e}(t)$ 的二阶矩。令 $e_{i}(t)=\\int_{0}^{t}\\eta_{i}(s)\\,ds$。则\n$$\n\\mathbb{E}\\left[e_{i}(t)e_{j}(t)\\right]=\\mathbb{E}\\left[\\int_{0}^{t}\\int_{0}^{t}\\eta_{i}(s)\\eta_{j}(s^{\\prime})\\,ds\\,ds^{\\prime}\\right].\n$$\n使用给定的协方差，\n$$\n\\mathbb{E}\\left[\\eta_{i}(s)\\eta_{j}(s^{\\prime})\\right]=2D\\,\\delta_{ij}\\,\\delta(s-s^{\\prime}),\n$$\n我们将其代入：\n$$\n\\mathbb{E}\\left[e_{i}(t)e_{j}(t)\\right]=\\int_{0}^{t}\\int_{0}^{t}2D\\,\\delta_{ij}\\,\\delta(s-s^{\\prime})\\,ds\\,ds^{\\prime}.\n$$\n使用狄拉克δ函数的筛选特性计算内层积分。对于固定的 $s$，当 $s\\in[0,t]$ 时，$\\int_{0}^{t}\\delta(s-s^{\\prime})\\,ds^{\\prime}=1$，因此\n$$\n\\mathbb{E}\\left[e_{i}(t)e_{j}(t)\\right]=\\delta_{ij}\\int_{0}^{t}2D\\,ds=2D\\,t\\,\\delta_{ij}.\n$$\n因此，每个分量的方差为 $\\mathbb{E}[e_{i}(t)^{2}]=2D\\,t$，且不同分量之间不相关。在二维情况下，误差的平方大小为 $|\\mathbf{e}(t)|^{2}=e_{1}(t)^{2}+e_{2}(t)^{2}$。其期望值是各分量方差之和：\n$$\n\\mathbb{E}\\left[|\\mathbf{e}(t)|^{2}\\right]=\\mathbb{E}\\left[e_{1}(t)^{2}\\right]+\\mathbb{E}\\left[e_{2}(t)^{2}\\right]=2D\\,t+2D\\,t=4D\\,t.\n$$\n均方根 (RMS) 误差大小为\n$$\n\\sqrt{\\mathbb{E}\\left[|\\mathbf{e}(t)|^{2}\\right]}=\\sqrt{4D\\,t}=2\\sqrt{D\\,t}.\n$$\n该表达式的单位是米，因为 $D$ 的单位是 $\\text{m}^{2}\\,\\text{s}^{-1}$，$t$ 的单位是 $\\text{s}$，这使得平方根内的单位为 $\\text{m}^{2}$，因此开方后单位为米。时间依赖性通过平方根因子与 $\\sqrt{t}$ 成正比，这是由整合白噪声引起的扩散增长的特征。",
            "answer": "$$\\boxed{2\\sqrt{D\\,t}}$$"
        },
        {
            "introduction": "本章的最后一个练习旨在连接理论与实验数据分析。在实际记录中，我们如何从有限且充满噪声的脉冲信号中估计出网格细胞的核心参数，例如网格间距 $\\lambda$？本练习将指导你应用最大似然估计（MLE）和克拉默-拉奥界（Cramér-Rao Bound）的强大框架，不仅能找到最佳估计值，还能量化其理论精度。",
            "id": "3978983",
            "problem": "记录单个内侧内嗅皮层网格细胞的活动，此时一只啮齿动物在一个边长为$L$的方形场地中进行均匀探索，该场地具有周期性边界识别，因此位置域为$\\Omega = [-L/2,L/2] \\times [-L/2,L/2]$，面积为$A = L^{2}$。设$N$表示观察到的放电总数。假设放电序列由一个非齐次空间泊松点过程生成，其强度是对一个恒定基线的六边形对称调制，具体表达式为\n$$\nr(\\mathbf{x};\\lambda) \\;=\\; \\rho_{0}\\left[\\,1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right],\n$$\n其中$\\rho_{0} > 0$是基线率，$0 < \\alpha < \\frac{1}{3}$是一个小的调制幅度，$\\lambda>0$是网格间距，$\\mathbf{u}_{m}$是相对于任意参考轴的$0^{\\circ}$、$60^{\\circ}$和$120^{\\circ}$方向的单位向量。假设动物在$\\Omega$上的占据是均匀的，且探索覆盖了许多网格周期，因此在$\\Omega$上三角函数的空间平均表现为其周期平均。\n\n从非齐次泊松点过程的基本定义以及以$N$为条件的独立同分布放电位置的似然函数出发，完成以下任务：\n\n1. 基于观察到的放电位置$\\{\\mathbf{x}_{i}\\}_{i=1}^{N}$，推导$\\lambda$的对数似然函数形式，并设计一个$\\lambda$的最大似然估计量（Maximum Likelihood Estimator, MLE）。该估计量通过选择空间波数大小$k$来最大化与三个网格轴对齐的放电位置傅里叶分量的环状功率，然后通过$k = 2\\pi/\\lambda$将$k$映射到$\\lambda$。以$k>0$上的一个优化问题的形式，给出该估计量的闭式解。\n\n2. 在小调制幅度$0<\\alpha\\ll 1$和多周期覆盖的情况下，推导基于$N$个放电估计$\\lambda$的克拉默-拉奥下界（Cramér-Rao Bound, CRB），并通过在正则性和有效性条件下将其等同于CRB，得到MLE的渐近方差。用$N$、$\\alpha$、$\\lambda$和$A=L^{2}$以闭式形式表达你最终的渐近方差公式。不需要进行数值计算。\n\n你的最终答案必须是单一的闭式解析表达式。",
            "solution": "该问题经评估具有科学依据、良定、客观且内部一致。这是计算神经科学和统计推断领域的一个有效问题。我们现在开始求解。\n\n问题分为两部分。首先，我们为网格间距$\\lambda$设计一个最大似然估计量（MLE）。其次，我们推导$\\lambda$的克拉默-拉奥下界（CRB）并确定MLE的渐近方差。\n\n**第一部分：最大似然估计量的推导**\n\n放电位置$\\{\\mathbf{x}_{i}\\}_{i=1}^{N}$在总放电数$N$的条件下被描述为独立同分布（i.i.d.）。对于一个速率函数为$r(\\mathbf{x};\\lambda)$的非齐次空间泊松过程，域$\\Omega$内单个放电位置$\\mathbf{x}$的概率密度函数由下式给出：\n$$\np(\\mathbf{x}|\\lambda) = \\frac{r(\\mathbf{x};\\lambda)}{\\int_{\\Omega} r(\\mathbf{x}';\\lambda) d\\mathbf{x}'}\n$$\n速率函数给出为：\n$$\nr(\\mathbf{x};\\lambda) = \\rho_{0}\\left[\\,1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right]\n$$\n其中$\\rho_{0} > 0$是基线率，$0 < \\alpha < 1/3$是调制幅度，$\\lambda > 0$是网格间距，$\\mathbf{u}_{m}$是相隔$60^\\circ$的单位向量。\n\n首先，我们计算速率函数在域$\\Omega = [-L/2, L/2] \\times [-L/2, L/2]$（面积为$A = L^2$）上的积分。\n$$\n\\int_{\\Omega} r(\\mathbf{x};\\lambda) d\\mathbf{x} = \\int_{\\Omega} \\rho_{0}\\left[\\,1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right] d\\mathbf{x}\n$$\n$$\n= \\rho_{0} \\int_{\\Omega} d\\mathbf{x} \\;+\\; \\rho_{0}\\alpha \\sum_{m=1}^{3} \\int_{\\Omega} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right) d\\mathbf{x}\n$$\n问题陈述探索覆盖了许多网格周期。这意味着每个余弦项在大域$\\Omega$上的空间平均近似为零，因为函数振荡了许多次。\n$$\n\\int_{\\Omega} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right) d\\mathbf{x} \\approx 0\n$$\n因此，速率函数的积分简化为：\n$$\n\\int_{\\Omega} r(\\mathbf{x};\\lambda) d\\mathbf{x} \\approx \\rho_{0} A\n$$\n这个量与参数$\\lambda$无关。因此，单个放电的概率密度为：\n$$\np(\\mathbf{x}|\\lambda) \\approx \\frac{r(\\mathbf{x};\\lambda)}{\\rho_{0}A} = \\frac{1}{A} \\left[\\,1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right]\n$$\n$N$个观察到的独立同分布放电位置$\\{\\mathbf{x}_{i}\\}_{i=1}^{N}$的对数似然是各个对数概率之和：\n$$\n\\mathcal{L}(\\lambda) = \\sum_{i=1}^{N} \\ln p(\\mathbf{x}_{i}|\\lambda) = \\sum_{i=1}^{N} \\ln \\left( \\frac{r(\\mathbf{x}_{i};\\lambda)}{\\rho_{0}A} \\right) = \\sum_{i=1}^{N} \\ln r(\\mathbf{x}_{i};\\lambda) - N\\ln(\\rho_{0}A)\n$$\n为了找到$\\lambda$的MLE，我们最大化$\\mathcal{L}(\\lambda)$。由于项$N\\ln(\\rho_{0}A)$相对于$\\lambda$是常数，这等价于最大化第一项：\n$$\n\\hat{\\lambda}_{\\text{MLE}} = \\arg\\max_{\\lambda>0} \\sum_{i=1}^{N} \\ln r(\\mathbf{x}_{i};\\lambda) = \\arg\\max_{\\lambda>0} \\sum_{i=1}^{N} \\ln \\left( \\rho_{0}\\left[\\,1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}_i\\right)\\right] \\right)\n$$\n这等价于最大化：\n$$\n\\mathcal{L}_{\\text{eff}}(\\lambda) = \\sum_{i=1}^{N} \\ln \\left( 1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}_i\\right) \\right)\n$$\n问题要求设计一个通过最大化“环状功率”来运作的MLE。这表明可以基于给定的调制幅度$\\alpha$很小（$0 < \\alpha \\ll 1$）这一条件进行简化。对于小的$z$，使用泰勒展开$\\ln(1+z) \\approx z$，其中$z = \\alpha \\sum_{m} \\cos(\\dots)$，目标函数近似为：\n$$\n\\mathcal{L}_{\\text{eff}}(\\lambda) \\approx \\alpha \\sum_{i=1}^{N} \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}_i\\right)\n$$\n这个近似在$\\alpha$的一阶上是有效的。网格细胞分析的标准方法通常使用基于放电图傅里叶功率谱的估计量。问题引导我们使用这样的估计量。令空间波数为$k = 2\\pi/\\lambda$。$k$的估计量被设计为最大化“与三个网格轴对齐的放电位置傅里叶分量的环状功率”。在波矢$\\mathbf{k}$处的傅里叶分量是$\\mathcal{F}(\\mathbf{k}) = \\sum_{i=1}^{N} \\exp(-i \\mathbf{k} \\cdot \\mathbf{x}_i)$。功率是$|\\mathcal{F}(\\mathbf{k})|^2$。三个网格轴对应于波矢$\\mathbf{k}_m = k \\mathbf{u}_m$。该估计量是通过最大化给定波数大小$k$下这三个对齐分量的功率之和来构建的。\n\n因此，波数$k$的MLE由以下优化问题给出：\n$$\n\\hat{k} = \\arg\\max_{k>0} \\sum_{m=1}^{3} \\left| \\sum_{i=1}^{N} \\exp(-i k \\mathbf{u}_m \\cdot \\mathbf{x}_i) \\right|^2\n$$\n对应的网格间距$\\lambda$的估计量则为$\\hat{\\lambda} = 2\\pi/\\hat{k}$。这种形式对应于在傅里叶空间中找到包含最多功率的“环”的半径，该功率集中在网格的三个主方向上。\n\n**第二部分：克拉默-拉奥下界与渐近方差**\n\n克拉默-拉奥下界（CRB）为任何无偏估计量的方差提供了一个下界。对于一个有效估计量（MLE在渐近意义上是有效的），其方差等于CRB。CRB是费雪信息$I(\\lambda)$的倒数。\n$$\n\\text{Var}(\\hat{\\lambda}) \\ge \\frac{1}{I(\\lambda)}\n$$\n对于$N$个独立同分布的观测，费雪信息是单个观测的费雪信息的$N$倍，即$I(\\lambda) = N I_1(\\lambda)$。对于单个观测，\n$$\nI_1(\\lambda) = E\\left[ \\left(\\frac{\\partial}{\\partial \\lambda} \\ln p(\\mathbf{x}|\\lambda)\\right)^2 \\right] = \\int_{\\Omega} \\left(\\frac{\\partial}{\\partial \\lambda} \\ln p(\\mathbf{x}|\\lambda)\\right)^2 p(\\mathbf{x}|\\lambda) d\\mathbf{x}\n$$\n对数概率为$\\ln p(\\mathbf{x}|\\lambda) = \\ln r(\\mathbf{x};\\lambda) - \\ln(\\rho_0 A)$。其关于$\\lambda$的导数为：\n$$\n\\frac{\\partial}{\\partial \\lambda} \\ln p(\\mathbf{x}|\\lambda) = \\frac{\\partial}{\\partial \\lambda} \\ln \\left( 1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right) \\right)\n$$\n使用链式法则和余弦的导数：\n$$\n\\frac{\\partial}{\\partial \\lambda} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right) = -\\sin\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right) \\left( -\\frac{2\\pi}{\\lambda^2}(\\mathbf{u}_{m}\\cdot\\mathbf{x}) \\right) = \\frac{2\\pi}{\\lambda^2}(\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\n$$\n所以，\n$$\n\\frac{\\partial}{\\partial \\lambda} \\ln p(\\mathbf{x}|\\lambda) = \\frac{\\alpha \\sum_{m=1}^{3} \\frac{2\\pi}{\\lambda^2}(\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)}{1 \\;+\\; \\alpha \\sum_{m=1}^{3} \\cos\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)}\n$$\n对于小的$\\alpha \\ll 1$，我们可以用$1$来近似分母，用$1/A$来近似概率密度$p(\\mathbf{x}|\\lambda)$。费雪信息的计算需要到$\\alpha^2$阶的项。\n$$\n\\left(\\frac{\\partial}{\\partial \\lambda} \\ln p(\\mathbf{x}|\\lambda)\\right)^2 \\approx \\alpha^2 \\left(\\sum_{m=1}^{3} \\frac{2\\pi}{\\lambda^2}(\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin\\!\\left(\\frac{2\\pi}{\\lambda}\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right)^2\n$$\n对于主导项，期望是关于$p(\\mathbf{x}|\\lambda) \\approx 1/A$来计算的：\n$$\nI_1(\\lambda) \\approx \\int_{\\Omega} \\alpha^2 \\left( \\frac{2\\pi}{\\lambda^2} \\sum_{m=1}^{3} (\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin\\!\\left(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right)^2 \\frac{d\\mathbf{x}}{A}\n$$\n$$\n= \\frac{4\\pi^2 \\alpha^2}{A\\lambda^4} \\int_{\\Omega} \\left( \\sum_{m=1}^{3} (\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin\\!\\left(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}\\right)\\right)^2 d\\mathbf{x}\n$$\n其中$k=2\\pi/\\lambda$。展开平方会得到对角项和交叉项。由于“多周期”假设，振荡的交叉项积分为零：\n$$\n\\int_{\\Omega} (\\mathbf{u}_{m}\\cdot\\mathbf{x})(\\mathbf{u}_{n}\\cdot\\mathbf{x})\\sin(k\\mathbf{u}_{m}\\cdot\\mathbf{x})\\sin(k\\mathbf{u}_{n}\\cdot\\mathbf{x}) d\\mathbf{x} \\approx 0 \\quad \\text{for } m \\neq n\n$$\n我们只剩下对角项的和：\n$$\nI_1(\\lambda) \\approx \\frac{4\\pi^2 \\alpha^2}{A\\lambda^4} \\sum_{m=1}^{3} \\int_{\\Omega} (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\sin^2(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}) d\\mathbf{x}\n$$\n为了计算该积分，我们再次使用“多周期”假设，将空间平均近似为平均值的乘积：\n$$\n\\int_{\\Omega} (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\sin^2(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}) d\\mathbf{x} \\approx A \\cdot \\left\\langle (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\right\\rangle \\cdot \\left\\langle \\sin^2(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}) \\right\\rangle\n$$\n在许多周期上$\\sin^2(\\cdot)$的平均值是$1/2$。为了在方形域$\\Omega$上求得$\\langle (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\rangle$，我们首先求坐标$x$和$y$的矩。\n$$\n\\langle x^2 \\rangle = \\frac{1}{A} \\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2} x^2 dx dy = \\frac{L}{L^2} \\left[\\frac{x^3}{3}\\right]_{-L/2}^{L/2} = \\frac{1}{L} \\frac{L^3}{12} = \\frac{L^2}{12} = \\frac{A}{12}\n$$\n根据对称性，$\\langle y^2 \\rangle = A/12$且$\\langle xy \\rangle = 0$。设$\\mathbf{u}_m = (\\cos \\theta_m, \\sin \\theta_m)^T$。\n$$\n\\langle (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\rangle = \\langle (x\\cos\\theta_m + y\\sin\\theta_m)^2 \\rangle = \\langle x^2 \\rangle \\cos^2\\theta_m + \\langle y^2 \\rangle \\sin^2\\theta_m = \\frac{A}{12} (\\cos^2\\theta_m + \\sin^2\\theta_m) = \\frac{A}{12}\n$$\n这个平均值与方向$\\mathbf{u}_m$无关。代回到积分中：\n$$\n\\int_{\\Omega} (\\mathbf{u}_{m}\\cdot\\mathbf{x})^2 \\sin^2(k\\,\\mathbf{u}_{m}\\cdot\\mathbf{x}) d\\mathbf{x} \\approx A \\cdot \\frac{A}{12} \\cdot \\frac{1}{2} = \\frac{A^2}{24}\n$$\n现在我们可以计算$I_1(\\lambda)$:\n$$\nI_1(\\lambda) \\approx \\frac{4\\pi^2 \\alpha^2}{A\\lambda^4} \\sum_{m=1}^{3} \\frac{A^2}{24} = \\frac{4\\pi^2 \\alpha^2}{A\\lambda^4} \\cdot 3 \\cdot \\frac{A^2}{24} = \\frac{12\\pi^2 \\alpha^2 A}{24\\lambda^4} = \\frac{\\pi^2 \\alpha^2 A}{2\\lambda^4}\n$$\n$N$个放电的总费雪信息是：\n$$\nI(\\lambda) = N I_1(\\lambda) = \\frac{N \\pi^2 \\alpha^2 A}{2\\lambda^4}\n$$\n一个有效估计量（如MLE）的渐近方差由CRB给出，即费雪信息的倒数。\n$$\n\\text{Var}(\\hat{\\lambda}) \\approx \\frac{1}{I(\\lambda)} = \\frac{2\\lambda^4}{N \\pi^2 \\alpha^2 A}\n$$\n这是在小调制幅度$\\alpha$和大量放电$N$的情况下，$\\lambda$的MLE的渐近方差。",
            "answer": "$$\n\\boxed{\\frac{2\\lambda^4}{N \\pi^2 \\alpha^2 A}}\n$$"
        }
    ]
}