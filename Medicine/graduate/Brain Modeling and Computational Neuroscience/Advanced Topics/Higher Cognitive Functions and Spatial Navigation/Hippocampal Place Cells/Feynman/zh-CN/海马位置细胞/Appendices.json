{
    "hands_on_practices": [
        {
            "introduction": "位置细胞的一个决定性特征是其空间局域性的发放场。但是，这种选择性是如何从基本的生物物理特性中产生的呢？本练习将指导您构建一个基础模型，其中一个简单的整合-发放神经元通过整合空间调谐的兴奋性和抑制性突触电导，从而形成一个位置场。这个过程将细胞机制与系统层面的功能联系起来。",
            "id": "3989050",
            "problem": "考虑一个用于模拟海马体位置细胞的单室电导型漏积分-发放神经元。该神经元接收一组依赖于动物空间位置 $\\mathbf{x}$ 的突触电导。我们关注一个位置为 $x \\in [0,L]$ 的一维轨道，并假设动物移动得足够慢，以至于膜电位可以相对于位置在准稳态机制下处理。该神经元有一个被动泄漏，其特征是漏电导 $g_{\\mathrm{L}}$ 和漏电逆转电位 $E_{\\mathrm{L}}$。它接收一个兴奋性电导 $g_{\\mathrm{E}}(x)$（其兴奋性逆转电位为 $E_{\\mathrm{E}}$）和一个抑制性电导 $g_{\\mathrm{I}}(x)$（其抑制性逆转电位为 $E_{\\mathrm{I}}$）。假设抑制性电导在空间上是均匀的，$g_{\\mathrm{I}}(x) \\equiv g_{\\mathrm{I0}}$，而兴奋性电导是经过空间调谐的高斯函数\n$$\ng_{\\mathrm{E}}(x) = g_{\\mathrm{E0}} \\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right),\n$$\n其中 $g_{\\mathrm{E0}}$ 是峰值电导，$x_0$ 是场的中心，$\\sigma$ 是调谐的空间尺度（标准差）。当膜电位 $V(t)$ 超过一个固定的阈值 $V_{\\mathrm{th}}$ 时，神经元会发放脉冲。\n\n从基于电导的漏积分-发放常微分方程出发\n$$\nC_{\\mathrm{m}} \\frac{dV}{dt} = -g_{\\mathrm{L}} \\left(V - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}\\!\\left(x(t)\\right)\\left(V - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V - E_{\\mathrm{I}}\\right),\n$$\n其中 $C_{\\mathrm{m}}$ 是膜电容，请在 $x(t)$ 的准稳态假设下，从第一性原理出发，推导稳态膜电位 $V_{\\mathrm{ss}}(x)$ 的表达式，并获得一个关于 $x$ 的条件，使得 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$。说明此阈值化如何定义了 $x_0$ 周围的一个连续空间区间，并由此推导出位置场宽度 $w$（单位为米）的公式。您的推导必须处理所有边界情况，包括不发放脉冲（$w=0$）以及阈值过低以至于在整个轨道上都发放脉冲的情况（$w=L$）。仅使用所述的物理假设和给定的定义。\n\n您的程序必须实现推导出的表达式，为下面列出的每个测试用例计算位置场宽度 $w$，并以米为单位打印宽度。如果推导出的宽度超过轨道长度 $L$，则将其裁剪为 $L$。如果推导出的条件意味着没有超过阈值，则将宽度设置为 $0$。所有量都必须在国际单位制（SI）中处理：电导单位为西门子，电压单位为伏特，位置和宽度单位为米。输出必须是单行，其中包含用方括号括起来的逗号分隔的数值结果列表，每个宽度都格式化为十进制数。\n\n使用以下参数集测试套件来评估您的实现。每个用例提供 $(L, g_{\\mathrm{L}}, g_{\\mathrm{I0}}, g_{\\mathrm{E0}}, E_{\\mathrm{L}}, E_{\\mathrm{I}}, E_{\\mathrm{E}}, V_{\\mathrm{th}}, \\sigma, x_0)$:\n\n- 用例 1（具有中等位置场的一般情况）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.1,\\ 1.0)$\n- 用例 2（更强的抑制，更窄的场）：$(2.0,\\ 2\\times 10^{-8},\\ 3\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.1,\\ 1.0)$\n- 用例 3（高阈值导致不发放脉冲）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.010,\\ 0.1,\\ 1.0)$\n- 用例 4（低阈值，整个轨道激活）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.070,\\ 0.1,\\ 1.0)$\n- 用例 5（更宽的兴奋性调谐，更宽的场）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.2,\\ 1.0)$\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如，“[w1,w2,w3,w4,w5]”，其中每个 $w$ 是相应情况下计算出的位置场宽度（单位为米）。",
            "solution": "从基于电导的漏积分-发放动力学开始\n$$\nC_{\\mathrm{m}} \\frac{dV}{dt} = -g_{\\mathrm{L}} \\left(V - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}(x(t))\\left(V - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V - E_{\\mathrm{I}}\\right).\n$$\n该方程结合了漏电流和突触电流，每一项都表示为电导乘以驱动力。当膜电位 $V(t)$ 达到阈值 $V_{\\mathrm{th}}$ 时，神经元发放脉冲，之后电压被重置（稳态分析不需要重置动力学）。\n\n在准稳态假设下，我们将位置 $x$ 视为参数，并对每个位置 $x$ 的电压动力学设置 $dV/dt \\approx 0$。求解稳态膜电位 $V_{\\mathrm{ss}}(x)$ 可得\n$$\n0 = -g_{\\mathrm{L}} \\left(V_{\\mathrm{ss}} - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}(x)\\left(V_{\\mathrm{ss}} - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V_{\\mathrm{ss}} - E_{\\mathrm{I}}\\right),\n$$\n可以重新整理为\n$$\n\\left(g_{\\mathrm{L}} + g_{\\mathrm{E}}(x) + g_{\\mathrm{I0}}\\right) V_{\\mathrm{ss}}(x) = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{E}}(x) E_{\\mathrm{E}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}.\n$$\n因此，\n$$\nV_{\\mathrm{ss}}(x) = \\frac{g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{E}}(x) E_{\\mathrm{E}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}}{g_{\\mathrm{L}} + g_{\\mathrm{E}}(x) + g_{\\mathrm{I0}}}.\n$$\n\n当 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 时会发生脉冲发放。定义常数\n$$\nA = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}, \\quad B = E_{\\mathrm{E}}, \\quad C = g_{\\mathrm{L}} + g_{\\mathrm{I0}},\n$$\n使得\n$$\nV_{\\mathrm{ss}}(x) = \\frac{A + B\\, g_{\\mathrm{E}}(x)}{C + g_{\\mathrm{E}}(x)}.\n$$\n阈值条件 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 变为\n$$\n\\frac{A + B\\, g_{\\mathrm{E}}(x)}{C + g_{\\mathrm{E}}(x)} \\ge V_{\\mathrm{th}}.\n$$\n两边同乘以 $C + g_{\\mathrm{E}}(x)$（对于非负电导，该项为正）得到\n$$\nA + B\\, g_{\\mathrm{E}}(x) \\ge V_{\\mathrm{th}} C + V_{\\mathrm{th}} g_{\\mathrm{E}}(x).\n$$\n重新整理关于 $g_{\\mathrm{E}}(x)$ 的项：\n$$\n\\left(B - V_{\\mathrm{th}}\\right) g_{\\mathrm{E}}(x) \\ge V_{\\mathrm{th}} C - A.\n$$\n当 $\\left(B - V_{\\mathrm{th}}\\right) > 0$（这在物理上是合理的，因为兴奋性逆转电位通常高于阈值），不等式简化为\n$$\ng_{\\mathrm{E}}(x) \\ge g_{\\mathrm{req}} \\equiv \\frac{V_{\\mathrm{th}} C - A}{B - V_{\\mathrm{th}}}.\n$$\n否则，如果 $\\left(B - V_{\\mathrm{th}}\\right) \\le 0$，兴奋性输入无法将膜电位提高到阈值以上，因为兴奋的驱动力不足。在这种情况下，条件简化为检查基线稳态（$g_{\\mathrm{E}}(x) \\approx 0$），即是否\n$$\nV_{\\mathrm{base}} \\equiv \\frac{A}{C} \\ge V_{\\mathrm{th}}.\n$$\n如果 $V_{\\mathrm{base}} \\ge V_{\\mathrm{th}}$，神经元在所有位置都会高于阈值；如果 $V_{\\mathrm{base}} < V_{\\mathrm{th}}$，神经元将永远不会达到阈值。\n\n对于高斯兴奋性电导，\n$$\ng_{\\mathrm{E}}(x) = g_{\\mathrm{E0}} \\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right),\n$$\n不等式 $g_{\\mathrm{E}}(x) \\ge g_{\\mathrm{req}}$ 变为\n$$\n\\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right) \\ge \\frac{g_{\\mathrm{req}}}{g_{\\mathrm{E0}}}.\n$$\n对两边取自然对数（注意指数是正的，且右边必须为正才能有解），我们得到\n$$\n-\\frac{(x - x_0)^2}{2 \\sigma^2} \\ge \\ln\\!\\left(\\frac{g_{\\mathrm{req}}}{g_{\\mathrm{E0}}}\\right),\n$$\n这得出\n$$\n(x - x_0)^2 \\le 2 \\sigma^2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right).\n$$\n因此，只要 $0 < g_{\\mathrm{req}} < g_{\\mathrm{E0}}$，满足 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 的位置集合就是区间\n$$\nx \\in \\left[x_0 - \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)},\\ x_0 + \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}\\right].\n$$\n那么位置场宽度 $w$ 就是\n$$\nw = 2 \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}.\n$$\n\n边界和边缘情况：\n- 如果 $g_{\\mathrm{req}} \\ge g_{\\mathrm{E0}}$，则没有位置满足不等式，且 $w = 0$。\n- 如果 $g_{\\mathrm{req}} \\le 0$，则任何非负的兴奋性电导都足以达到阈值。在这种情况下，即使远离中心，神经元也处于或高于阈值，位置场会跨越整个轨道，得出 $w = L$。\n- 如果 $\\left(B - V_{\\mathrm{th}}\\right) \\le 0$，则计算 $V_{\\mathrm{base}} = A/C$。如果 $V_{\\mathrm{base}} \\ge V_{\\mathrm{th}}$，则设 $w = L$；否则设 $w = 0$。\n- 如果计算出的宽度 $w$ 超过物理轨道长度 $L$，则裁剪为 $w = L$。\n\n每个测试用例的算法步骤：\n1. 读取 $(L, g_{\\mathrm{L}}, g_{\\mathrm{I0}}, g_{\\mathrm{E0}}, E_{\\mathrm{L}}, E_{\\mathrm{I}}, E_{\\mathrm{E}}, V_{\\mathrm{th}}, \\sigma, x_0)$。\n2. 计算 $A = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}$，$B = E_{\\mathrm{E}}$，$C = g_{\\mathrm{L}} + g_{\\mathrm{I0}}$。\n3. 如果 $(B - V_{\\mathrm{th}}) \\le 0$，则在 $A/C \\ge V_{\\mathrm{th}}$ 时设 $w = L$，否则设 $w = 0$。\n4. 否则计算\n   $$\n   g_{\\mathrm{req}} = \\frac{V_{\\mathrm{th}} C - A}{B - V_{\\mathrm{th}}}.\n   $$\n   如果 $g_{\\mathrm{req}} \\le 0$，设 $w = L$；如果 $g_{\\mathrm{req}} \\ge g_{\\mathrm{E0}}$，设 $w = 0$；否则设\n   $$\n   w = 2 \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}.\n   $$\n5. 如果 $w > L$，将 $w$ 裁剪为 $L$。\n6. 将所有 $w$ 值作为单个逗号分隔的列表输出，并用方括号括起来。\n\n对所提供用例的数值评估证实了定性预期：\n- 用例 1：由于兴奋和抑制的平衡，宽度适中。\n- 用例 2：更强的抑制增加了所需的兴奋性电导，并使宽度变窄。\n- 用例 3：高阈值使得 $g_{\\mathrm{req}}$ 超过 $g_{\\mathrm{E0}}$，得出 $w = 0$。\n- 用例 4：低阈值得出 $g_{\\mathrm{req}} \\le 0$，激活整个轨道，因此 $w = L$。\n- 用例 5：增加 $\\sigma$ 会通过对 $\\sigma$ 的平方根依赖关系按比例地加宽场。\n\n该程序实现了这个过程，并以指定格式打印了五个用例的宽度（单位为米）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_width(L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0):\n    # Constants derived from the conductance-based steady-state model\n    A = gL * EL + gI0 * EI\n    B = EE\n    C = gL + gI0\n\n    # Handle case where excitatory driving force is insufficient\n    if (B - Vth) <= 0:\n        V_base = A / C\n        w = L if V_base >= Vth else 0.0\n        return min(max(w, 0.0), L)\n\n    # Required excitatory conductance to reach threshold\n    g_req = (Vth * C - A) / (B - Vth)\n\n    # Edge cases based on g_req\n    if g_req <= 0:\n        # Threshold is low enough that baseline suffices; whole track is active\n        w = L\n    elif g_req >= gE0:\n        # Even peak excitatory conductance is insufficient; no place field\n        w = 0.0\n    else:\n        # Compute width from Gaussian inequality\n        # w = 2 * sigma * sqrt(2 * ln(gE0 / g_req))\n        ratio = gE0 / g_req\n        # Numerical safety: ensure ratio > 1\n        if ratio <= 1.0:\n            w = 0.0\n        else:\n            w = 2.0 * sigma * np.sqrt(2.0 * np.log(ratio))\n    # Clip to track length\n    if w > L:\n        w = L\n    if w < 0.0:\n        w = 0.0\n    return float(w)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0)\n    test_cases = [\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.1, 1.0),\n        (2.0, 2e-8, 3e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.010, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.070, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.2, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0 = case\n        w = compute_width(L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0)\n        results.append(f\"{w:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "大脑利用位置细胞建立空间地图后，如何使用这张地图来确定动物的当前位置？本练习探讨了神经解码的基本问题。您将应用贝叶斯定理，根据一组位置细胞的发放计数来计算最可能的位置，从而阐释最大后验 (MAP) 估计的原理。",
            "id": "3989039",
            "problem": "考虑一个一维线性轨道，其上有离散的候选位置 $x \\in \\{x_1, x_2, x_3\\}$，其中 $x_1 = 0\\,\\text{m}$，$x_2 = 0.5\\,\\text{m}$，$x_3 = 1.0\\,\\text{m}$。一只大鼠在轨道上奔跑，同时在持续时间为 $T = 0.1\\,\\text{s}$ 的固定时间窗口内记录了三个海马体位置细胞的脉冲计数。假设以位置 $x$ 为条件，各个细胞的脉冲计数 $\\mathbf{n} = (n_1, n_2, n_3)$ 是相互独立的，并且每个脉冲计数都服从泊松分布，其平均计数 $r_i(x)$ 等于瞬时发放率 $f_i(x)$（单位：赫兹）与时间窗口持续时间 $T$ 的乘积，即 $r_i(x) = f_i(x) T$。这三个细胞在三个候选位置的瞬时发放率如下：\n- 在 $x_1 = 0\\,\\text{m}$ 处：$f_1(x_1) = 35$, $f_2(x_1) = 2$, $f_3(x_1) = 1$。\n- 在 $x_2 = 0.5\\,\\text{m}$ 处：$f_1(x_2) = 8$, $f_2(x_2) = 28$, $f_3(x_2) = 6$。\n- 在 $x_3 = 1.0\\,\\text{m}$ 处：$f_1(x_3) = 5$, $f_2(x_3) = 10$, $f_3(x_3) = 40$。\n假设在该时间窗口内观察到的脉冲计数为 $\\mathbf{n} = (3, 2, 0)$。设位置的先验分布为均匀分布：$p(x_1) = p(x_2) = p(x_3)$。从贝叶斯定理和上述泊松生成假设出发，推导贝叶斯解码器 $p(x \\mid \\mathbf{n})$（可忽略比例常数），并计算位置的最大后验（MAP）估计。以米为单位表示MAP估计值。无需四舍五入。",
            "solution": "该问题要求推导大鼠位置的贝叶斯解码器，并计算该位置的最大后验（MAP）估计。位置 $x$ 是一个离散变量，取自集合 $\\{x_1, x_2, x_3\\}$，其中 $x_1 = 0\\,\\text{m}$，$x_2 = 0.5\\,\\text{m}$，$x_3 = 1.0\\,\\text{m}$。观测数据是来自三个位置细胞在时间窗口 $T = 0.1\\,\\text{s}$ 内的脉冲计数的向量 $\\mathbf{n} = (n_1, n_2, n_3) = (3, 2, 0)$。\n\n位置的 MAP 估计 $\\hat{x}_{\\text{MAP}}$ 是使后验概率 $p(x | \\mathbf{n})$ 最大化的位置 $x$。根据贝叶斯定理，后验概率由下式给出：\n$$p(x | \\mathbf{n}) = \\frac{p(\\mathbf{n} | x) p(x)}{p(\\mathbf{n})}$$\n其中 $p(\\mathbf{n} | x)$ 是似然，$p(x)$ 是位置的先验概率，$p(\\mathbf{n})$ 是证据，它作为一个归一化常数。为了找到 MAP 估计，我们寻求最大化后验概率：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(x | \\mathbf{n})$$\n由于 $p(\\mathbf{n})$ 相对于 $x$ 是一个常数，这等价于最大化分子：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(\\mathbf{n} | x) p(x)$$\n问题指出，位置的先验分布是均匀的，即 $p(x_1) = p(x_2) = p(x_3) = c$，其中 $c$ 是一个常数（具体来说，$c=1/3$）。由于先验概率 $p(x)$ 是一个常数，它不影响最大值的位置。因此，最大化后验概率等价于最大化似然：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(\\mathbf{n} | x)$$\n问题指出，以位置 $x$ 为条件，三个细胞的脉冲计数是独立的。因此，似然可以表示为每个细胞概率的乘积：\n$$p(\\mathbf{n} | x) = p(n_1 | x) p(n_2 | x) p(n_3 | x) = \\prod_{i=1}^{3} p(n_i | x)$$\n假设每个单独的脉冲计数 $n_i$ 服从泊松分布，其均值为 $r_i(x) = f_i(x)T$，其中 $f_i(x)$ 是发放率，$T$ 是时间窗口。泊松分布的概率质量函数为：\n$$p(n_i | x) = \\frac{(r_i(x))^{n_i} \\exp(-r_i(x))}{n_i!}$$\n将此代入似然函数可得：\n$$p(\\mathbf{n} | x) = \\prod_{i=1}^{3} \\frac{(f_i(x)T)^{n_i} \\exp(-f_i(x)T)}{n_i!}$$\n由于先验是均匀的，贝叶斯解码器 $p(x | \\mathbf{n})$ 与此似然函数成正比。项 $\\prod_{i=1}^{3} (1/n_i!)$ 相对于 $x$ 是一个常数。因此，忽略比例常数的解码器是：\n$$p(x | \\mathbf{n}) \\propto \\prod_{i=1}^{3} (f_i(x)T)^{n_i} \\exp(-f_i(x)T)$$\n为了找到 MAP 估计，我们可以最大化似然的对数（对数似然），这将乘积转化为和，从而简化了计算。最大化 $\\ln(p(\\mathbf{n} | x))$ 等价于最大化 $p(\\mathbf{n} | x)$。\n$$L(x) = \\ln(p(\\mathbf{n} | x)) = \\ln\\left(\\prod_{i=1}^{3} \\frac{(r_i(x))^{n_i} \\exp(-r_i(x))}{n_i!}\\right) = \\sum_{i=1}^{3} [n_i \\ln(r_i(x)) - r_i(x) - \\ln(n_i!)]$$\n项 $\\sum \\ln(n_i!)$ 与 $x$ 无关，在最大化过程中可以舍去。我们寻求最大化函数 $L'(x)$：\n$$L'(x) = \\sum_{i=1}^{3} [n_i \\ln(r_i(x)) - r_i(x)]$$\n我们首先计算每个细胞 $i$ 在每个位置 $x_j$ 的平均脉冲计数 $r_i(x_j) = f_i(x_j)T$，其中 $T=0.1\\,\\text{s}$。给定的发放率如下：\n在 $x_1 = 0\\,\\text{m}$ 处：$f_1(x_1)=35$, $f_2(x_1)=2$, $f_3(x_1)=1$。\n$r_1(x_1) = 35 \\times 0.1 = 3.5$, $r_2(x_1) = 2 \\times 0.1 = 0.2$, $r_3(x_1) = 1 \\times 0.1 = 0.1$。\n\n在 $x_2 = 0.5\\,\\text{m}$ 处：$f_1(x_2)=8$, $f_2(x_2)=28$, $f_3(x_2)=6$。\n$r_1(x_2) = 8 \\times 0.1 = 0.8$, $r_2(x_2) = 28 \\times 0.1 = 2.8$, $r_3(x_2) = 6 \\times 0.1 = 0.6$。\n\n在 $x_3 = 1.0\\,\\text{m}$ 处：$f_1(x_3)=5$, $f_2(x_3)=10$, $f_3(x_3)=40$。\n$r_1(x_3) = 5 \\times 0.1 = 0.5$, $r_2(x_3) = 10 \\times 0.1 = 1.0$, $r_3(x_3) = 40 \\times 0.1 = 4.0$。\n\n现在我们使用观察到的脉冲计数 $\\mathbf{n} = (3, 2, 0)$ 来计算每个位置的 $L'(x)$：\n对于 $x_1 = 0\\,\\text{m}$：\n$$L'(x_1) = [3 \\ln(3.5) - 3.5] + [2 \\ln(0.2) - 0.2] + [0 \\ln(0.1) - 0.1]$$\n$$L'(x_1) = 3 \\ln(3.5) + 2 \\ln(0.2) - 3.8 \\approx 3(1.2528) + 2(-1.6094) - 3.8 = 3.7584 - 3.2188 - 3.8 = -3.2604$$\n\n对于 $x_2 = 0.5\\,\\text{m}$：\n$$L'(x_2) = [3 \\ln(0.8) - 0.8] + [2 \\ln(2.8) - 2.8] + [0 \\ln(0.6) - 0.6]$$\n$$L'(x_2) = 3 \\ln(0.8) + 2 \\ln(2.8) - 4.2 \\approx 3(-0.2231) + 2(1.0296) - 4.2 = -0.6693 + 2.0592 - 4.2 = -2.8101$$\n\n对于 $x_3 = 1.0\\,\\text{m}$：\n$$L'(x_3) = [3 \\ln(0.5) - 0.5] + [2 \\ln(1.0) - 1.0] + [0 \\ln(4.0) - 4.0]$$\n由于 $\\ln(1.0) = 0$：\n$$L'(x_3) = 3 \\ln(0.5) - 0.5 - 1.0 - 4.0 = 3 \\ln(0.5) - 5.5 \\approx 3(-0.6931) - 5.5 = -2.0793 - 5.5 = -7.5793$$\n\n比较三个候选位置的对数似然函数值：\n$L'(x_1) \\approx -3.2604$\n$L'(x_2) \\approx -2.8101$\n$L'(x_3) \\approx -7.5793$\n最大值是 $L'(x_2)$。因此，后验概率 $p(x | \\mathbf{n})$ 在 $x=x_2$ 处最大化。\n\n位置的 MAP 估计是 $\\hat{x}_{\\text{MAP}} = x_2 = 0.5\\,\\text{m}$。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "位置细胞的表征不是静止的，它们会根据经验和感觉线索动态地进行塑造。本练习通过一个模拟线索冲突的计算实验来探索位置场的可塑性。通过实现一个简单的联想学习规则，您将模拟一个位置细胞如何解决不同地标之间相互矛盾的模糊信息，这一过程对于维持连贯的空间地图至关重要。",
            "id": "3989045",
            "problem": "请考虑以下受海马体位置细胞和线索冲突启发的计算实验。一个一维环形轨道上，有一个位于位置 $x_{\\mathrm{v}}$ 的稳定视觉标志物，以及一个位于位置 $x_{\\mathrm{o}}$ 的稳定气味源，两者之间存在一个固定的空间错配 $|\\Delta| = |x_{\\mathrm{v}} - x_{\\mathrm{o}}|$，该错配在多次试验中保持不变。单个位置细胞被建模为具有两个锚定于这些线索的候选子场。其在时间（试验）$t$ 时，于位置 $x$ 上的预测发放率场由下式给出：\n$$\nr(x;t) = w_{\\mathrm{v}}(t)\\,\\exp\\!\\left(-\\frac{d(x,x_{\\mathrm{v}})^2}{2\\sigma^2}\\right) \\;+\\; w_{\\mathrm{o}}(t)\\,\\exp\\!\\left(-\\frac{d(x,x_{\\mathrm{o}})^2}{2\\sigma^2}\\right),\n$$\n其中 $d(\\cdot,\\cdot)$ 是环上的测地距离，$\\sigma > 0$ 是一个固定的空间尺度，$w_{\\mathrm{v}}(t), w_{\\mathrm{o}}(t) \\ge 0$ 是线索特异性的关联强度，分别作为锚定在 $x_{\\mathrm{v}}$ 和 $x_{\\mathrm{o}}$ 的子场振幅。关联强度根据源于经典关联学习的误差驱动规则，在每次试验后更新：对于每个线索 $c \\in \\{\\mathrm{v},\\mathrm{o}\\}$，\n$$\nw_{c}(t{+}1) \\;\\leftarrow\\; \\mathrm{clip}_{[0,1]}\\!\\Big(w_{c}(t) \\;+\\; \\eta\\,S_{c}\\,\\big(\\lambda_{c} \\;-\\; \\hat{r}_{c}(t)\\big)\\Big),\n$$\n其中 $\\eta \\in [0,1]$ 是学习率，$S_{c} \\in [0,1]$ 是线索特异性显著性，$\\lambda_{c} \\in [0,1]$ 是在线索锚点处的教师信号（$\\lambda_{c} = 1$ 表示与线索 $c$ 对齐的单一场解在行为上被强化，而 $\\lambda_{c} = 0$ 表示在该锚点处没有强化），$\\hat{r}_{c}(t)$ 是模型当前在线索锚点处的预测振幅（具体来说，$\\hat{r}_{\\mathrm{v}}(t) = w_{\\mathrm{v}}(t)$ 且 $\\hat{r}_{\\mathrm{o}}(t) = w_{\\mathrm{o}}(t)$），而 $\\mathrm{clip}_{[0,1]}(\\cdot)$ 将数值投影到区间 $[0,1]$。如果 $w_{c}(t) \\ge \\theta$，则称位置场在试验 $t$ 时对于线索 $c$ 是“活动的”，其中 $\\theta \\in (0,1)$ 是一个固定的活动阈值，表示为最大可能振幅 $1$ 的一个分数。如果两个线索都处于活动状态，则该状态称为“双场”；如果恰好只有一个线索处于活动状态，则称为“单场”。歧义被认为在首次出现单场的试验索引 $t$ 上得到解决。\n\n从上述核心定义出发，除了这些定义之外不使用任何快捷公式，实现一个程序，该程序对下述测试集中的每一组参数，模拟最多 $T$ 次试验的学习动态，并返回：\n- 模型根据活动标准 $w_{c}(t) \\ge \\theta$ 解析为单一场的首次试验索引 $t_{\\star} \\in \\{1,2,\\dots,T\\}$；若没有这样的试验发生，则返回 $-1$，以及\n- 一个获胜者代码 $u \\in \\{1,0,-1\\}$，其中如果视觉线索是 $t_{\\star}$ 时唯一的活动场，则 $u = 1$；如果气味线索是 $t_{\\star}$ 时唯一的活动场，则 $u = 0$；如果在 $T$ 次试验内没有出现单一场，则 $u = -1$。\n\n假设每次试验权重更新后都会进行解析检查。按指定初始化 $w_{\\mathrm{v}}(0)$ 和 $w_{\\mathrm{o}}(0)$。空间尺度 $\\sigma$ 和位置 $x_{\\mathrm{v}}, x_{\\mathrm{o}}$ 不影响锚点处的更新，但它们为将 $w_{\\mathrm{v}}$ 和 $w_{\\mathrm{o}}$ 解释为子场振幅提供了动机。\n\n你的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是针对一个测试用例的二元列表 $[t_{\\star},u]$，顺序与测试集相同。例如，要求的字符串格式类似于 $[[t_{\\star}^{(1)},u^{(1)}],[t_{\\star}^{(2)},u^{(2)}],\\dots]$。\n\n测试集：\n- 情况 $1$（理想情况；强化有利于视觉线索）：\n  - $w_{\\mathrm{v}}(0) = 0.5$, $w_{\\mathrm{o}}(0) = 0.5$, $\\eta = 0.2$, $S_{\\mathrm{v}} = 1.0$, $S_{\\mathrm{o}} = 1.0$, $\\lambda_{\\mathrm{v}} = 1.0$, $\\lambda_{\\mathrm{o}} = 0.0$, $\\theta = 0.2$, $T = 30$。\n- 情况 $2$（边界情况；无学习）：\n  - $w_{\\mathrm{v}}(0) = 0.5$, $w_{\\mathrm{o}}(0) = 0.5$, $\\eta = 0.0$, $S_{\\mathrm{v}} = 1.0$, $S_{\\mathrm{o}} = 1.0$, $\\lambda_{\\mathrm{v}} = 1.0$, $\\lambda_{\\mathrm{o}} = 0.0$, $\\theta = 0.2$, $T = 30$。\n- 情况 $3$（获胜者反转；强化有利于气味线索）：\n  - $w_{\\mathrm{v}}(0) = 0.2$, $w_{\\mathrm{o}}(0) = 0.8$, $\\eta = 0.1$, $S_{\\mathrm{v}} = 1.0$, $S_{\\mathrm{o}} = 1.0$, $\\lambda_{\\mathrm{v}} = 0.0$, $\\lambda_{\\mathrm{o}} = 1.0$, $\\theta = 0.2$, $T = 40$。\n- 情况 $4$（边缘情况；极低的气味显著性减缓了消退，在规定试验次数内未解析）：\n  - $w_{\\mathrm{v}}(0) = 0.5$, $w_{\\mathrm{o}}(0) = 0.5$, $\\eta = 0.1$, $S_{\\mathrm{v}} = 1.0$, $S_{\\mathrm{o}} = 0.01$, $\\lambda_{\\mathrm{v}} = 1.0$, $\\lambda_{\\mathrm{o}} = 0.0$, $\\theta = 0.2$, $T = 20$。",
            "solution": "在尝试任何解决方案之前，问题陈述都经过验证。\n\n### 步骤 1：提取给定信息\n\n提供的信息如下：\n- **发放率模型：** 位置细胞在位置 $x$ 和试验 $t$ 的发放率 $r(x;t)$ 由两个类高斯子场的和给出：\n$$\nr(x;t) = w_{\\mathrm{v}}(t)\\,\\exp\\!\\left(-\\frac{d(x,x_{\\mathrm{v}})^2}{2\\sigma^2}\\right) \\;+\\; w_{\\mathrm{o}}(t)\\,\\exp\\!\\left(-\\frac{d(x,x_{\\mathrm{o}})^2}{2\\sigma^2}\\right)\n$$\n- **变量：** $w_{\\mathrm{v}}(t)$ 和 $w_{\\mathrm{o}}(t)$ 分别是视觉（v）和气味（o）线索的关联强度。$x_{\\mathrm{v}}$ 和 $x_{\\mathrm{o}}$ 是线索的锚定位置。$\\sigma > 0$ 是一个空间尺度参数。$d(\\cdot, \\cdot)$ 是环形轨道上的测地距离。\n- **权重更新规则：** 对于每个线索 $c \\in \\{\\mathrm{v},\\mathrm{o}\\}$，权重根据以下规则进行更新：\n$$\nw_{c}(t{+}1) \\;\\leftarrow\\; \\mathrm{clip}_{[0,1]}\\!\\Big(w_{c}(t) \\;+\\; \\eta\\,S_{c}\\,\\big(\\lambda_{c} \\;-\\; \\hat{r}_{c}(t)\\big)\\Big)\n$$\n- **规则参数：**\n    - $\\eta \\in [0,1]$：学习率。\n    - $S_{c} \\in [0,1]$：线索特异性显著性。\n    - $\\lambda_{c} \\in [0,1]$：线索 $c$ 的教师信号。\n    - $\\hat{r}_{c}(t)$：模型在线索锚点处的预测振幅。\n- **关键规定：** 预测振幅被明确定义为：\n$$\n\\hat{r}_{\\mathrm{v}}(t) = w_{\\mathrm{v}}(t) \\quad \\text{和} \\quad \\hat{r}_{\\mathrm{o}}(t) = w_{\\mathrm{o}}(t)\n$$\n- **状态定义：**\n    - **活动阈值：** $\\theta \\in (0,1)$。如果 $w_c(t) \\ge \\theta$，则场是“活动的”。\n    - **单一场：** 恰好一个场是活动的。\n    - **解析：** 首次出现单一场状态的试验 $t$。\n- **任务：** 对于给定的参数集 $\\{w_{\\mathrm{v}}(0), w_{\\mathrm{o}}(0), \\eta, S_{\\mathrm{v}}, S_{\\mathrm{o}}, \\lambda_{\\mathrm{v}}, \\lambda_{\\mathrm{o}}, \\theta, T\\}$，确定解析试验 $t_{\\star} \\in \\{1, 2, \\dots, T\\}$ 和获胜者代码 $u$。\n    - 如果视觉线索场是在 $t_{\\star}$ 时唯一的活动场，则 $u=1$。\n    - 如果气味线索场是在 $t_{\\star}$ 时唯一的活动场，则 $u=0$。\n    - 如果在试验 $T$ 之前没有发生解析，则 $t_{\\star} = -1$ 且 $u = -1$。\n- **测试集：** 提供了四个不同的参数集用于模拟。\n\n### 步骤 2：验证\n\n根据既定标准对问题进行评估：\n1.  **科学依据：** 该模型是一个误差驱动学习规则的离散时间公式，其概念与关联学习理论的基石 Rescorla-Wagner 模型相同。其在在线索冲突场景中应用于海马体位置细胞是计算神经科学中的一个标准范式。该问题具有科学合理性。\n2.  **良态问题：** 问题提供了明确的初始条件、确定性的更新规则和清晰的终止标准。系统的演化由参数唯一确定。对预测振幅 $\\hat{r}_c(t) = w_c(t)$ 的定义是一个关键的消歧说明，确保了问题的自包含性，避免了在学习规则本身中可能出现的关于线索交互的混淆。每个测试用例都存在明确的唯一解。\n3.  **客观性：** 问题使用精确的数学定义和客观语言陈述，没有主观或含糊的术语。\n\n所有其他无效性标准（设置不完整、条件不切实际等）均不满足。该问题严谨且可形式化。关于空间发放场 $r(x;t)$ 的描述性上下文是恰当的科学动机，而问题正确地指明了核心动态仅由权重 $w_c(t)$ 控制。\n\n### 步骤 3：结论\n\n该问题是 **有效的**。\n\n### 解法推导\n\n分析始于将指定的定义 $\\hat{r}_{\\mathrm{v}}(t) = w_{\\mathrm{v}}(t)$ 和 $\\hat{r}_{\\mathrm{o}}(t) = w_{\\mathrm{o}}(t)$ 代入通用更新规则。这使得两个权重的动态解耦，从而得到两个独立的一阶差分方程。\n\n对于视觉线索权重 $w_{\\mathrm{v}}(t)$:\n$$\nw_{\\mathrm{v}}(t{+}1) \\;\\leftarrow\\; \\mathrm{clip}_{[0,1]}\\!\\Big(w_{\\mathrm{v}}(t) \\;+\\; \\eta\\,S_{\\mathrm{v}}\\,\\big(\\lambda_{\\mathrm{v}} \\;-\\; w_{\\mathrm{v}}(t)\\big)\\Big)\n$$\n整理裁剪函数内部的项得到：\n$$\nw_{\\mathrm{v}}(t{+}1) \\;\\leftarrow\\; \\mathrm{clip}_{[0,1]}\\!\\Big( (1 - \\eta S_{\\mathrm{v}})w_{\\mathrm{v}}(t) + \\eta S_{\\mathrm{v}} \\lambda_{\\mathrm{v}} \\Big)\n$$\n类似地，对于气味线索权重 $w_{\\mathrm{o}}(t)$:\n$$\nw_{\\mathrm{o}}(t{+}1) \\;\\leftarrow\\; \\mathrm{clip}_{[0,1]}\\!\\Big( (1 - \\eta S_{\\mathrm{o}})w_{\\mathrm{o}}(t) + \\eta S_{\\mathrm{o}} \\lambda_{\\mathrm{o}} \\Big)\n$$\n这些方程表明，该系统由两个解耦的线性变换后跟一个裁剪操作组成。正如问题陈述中正确指出的，空间变量 $x_{\\mathrm{v}}$、$x_{\\mathrm{o}}$ 和 $\\sigma$ 与计算无关。\n\n计算任务是为每个测试用例迭代模拟这两个方程。算法如下：\n\n1.  将试验计数器 $t$ 初始化为 $0$，将权重 $w_{\\mathrm{v}}$ 和 $w_{\\mathrm{o}}$ 初始化为它们的起始值 $w_{\\mathrm{v}}(0)$ 和 $w_{\\mathrm{o}}(0)$。\n2.  开始一个从试验 $t=1$ 到最大试验次数 $T$ 的循环。\n3.  在每次迭代中，使用推导出的更新方程，将 $w_{\\mathrm{v}}$ 和 $w_{\\mathrm{o}}$ 从上一次试验（$t-1$）的值更新为试验 $t$ 的新值。$\\mathrm{clip}_{[0,1]}(\\cdot)$ 函数确保权重保持在有效范围 $[0,1]$ 内。\n4.  更新后，评估试验 $t$ 时两个线索的活动状态。令 $A_{\\mathrm{v}} = (w_{\\mathrm{v}}(t) \\ge \\theta)$ 和 $A_{\\mathrm{o}} = (w_{\\mathrm{o}}(t) \\ge \\theta)$ 为活动的布尔指示符。\n5.  检查是否解析为“单一场”。如果 $A_{\\mathrm{v}}$ 和 $A_{\\mathrm{o}}$ 中恰好有一个为真，则发生解析。\n    - 如果 $A_{\\mathrm{v}}$ 为真且 $A_{\\mathrm{o}}$ 为假，则已发生解析。结果是 $[t, 1]$。此用例的模拟终止。\n    - 如果 $A_{\\mathrm{v}}$ 为假且 $A_{\\mathrm{o}}$ 为真，则已发生解析。结果是 $[t, 0]$。此用例的模拟终止。\n6.  如果循环完成至试验 $T$ 仍未满足单一场条件，则歧义在规定时间内未被解决。结果是 $[-1, -1]$。\n\n此过程被系统地应用于测试集中提供的每个参数集，以生成最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cue conflict resolution problem by simulating the learning dynamics\n    for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: happy path; reinforcement favors the visual cue\n        {'w_v_0': 0.5, 'w_o_0': 0.5, 'eta': 0.2, 'S_v': 1.0, 'S_o': 1.0, 'lambda_v': 1.0, 'lambda_o': 0.0, 'theta': 0.2, 'T': 30},\n        # Case 2: boundary; no learning\n        {'w_v_0': 0.5, 'w_o_0': 0.5, 'eta': 0.0, 'S_v': 1.0, 'S_o': 1.0, 'lambda_v': 1.0, 'lambda_o': 0.0, 'theta': 0.2, 'T': 30},\n        # Case 3: winner flips; reinforcement favors the odor cue\n        {'w_v_0': 0.2, 'w_o_0': 0.8, 'eta': 0.1, 'S_v': 1.0, 'S_o': 1.0, 'lambda_v': 0.0, 'lambda_o': 1.0, 'theta': 0.2, 'T': 40},\n        # Case 4: edge; extremely low odor salience slows extinction\n        {'w_v_0': 0.5, 'w_o_0': 0.5, 'eta': 0.1, 'S_v': 1.0, 'S_o': 0.01, 'lambda_v': 1.0, 'lambda_o': 0.0, 'theta': 0.2, 'T': 20},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        w_v = case['w_v_0']\n        w_o = case['w_o_0']\n        eta = case['eta']\n        S_v = case['S_v']\n        S_o = case['S_o']\n        lambda_v = case['lambda_v']\n        lambda_o = case['lambda_o']\n        theta = case['theta']\n        T = case['T']\n\n        # Initialize result for this case as unresolved\n        case_result = [-1, -1]\n\n        # Loop through trials from t=1 to T\n        for t in range(1, T + 1):\n            # The updates are based on the weights from the previous trial (t-1).\n            # These are simultaneous updates, so we calculate the new values before assigning them.\n            w_v_new = w_v + eta * S_v * (lambda_v - w_v)\n            w_o_new = w_o + eta * S_o * (lambda_o - w_o)\n\n            # Apply the clip function to project to the interval [0, 1]\n            w_v = np.clip(w_v_new, 0.0, 1.0)\n            w_o = np.clip(w_o_new, 0.0, 1.0)\n            \n            # Check for activity based on the threshold theta\n            is_v_active = (w_v >= theta)\n            is_o_active = (w_o >= theta)\n\n            # Check for single field resolution\n            if is_v_active and not is_o_active:\n                # Visual cue wins\n                case_result = [t, 1]\n                break\n            elif not is_v_active and is_o_active:\n                # Odor cue wins\n                case_result = [t, 0]\n                break\n        \n        results.append(case_result)\n\n    # Format the output string exactly as required, without extra spaces.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}