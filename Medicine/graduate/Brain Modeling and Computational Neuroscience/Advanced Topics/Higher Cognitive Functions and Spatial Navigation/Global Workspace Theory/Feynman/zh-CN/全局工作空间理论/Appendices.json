{
    "hands_on_practices": [
        {
            "introduction": "我们将从全局工作空间理论最基本的特征之一——其有限的容量——开始。通过使用经典的计算神经科学模型，即威尔逊-科恩（Wilson-Cowan）方程，我们可以探索资源竞争（由一个共享的抑制性神经元池介导）如何自然地导致可被主动维持的项目数量的上限。这个练习将“容量”这一抽象概念变得具体，并将其与特定的神经回路机制联系起来 ()。",
            "id": "3984696",
            "problem": "考虑一个全局工作空间理论（Global Workspace Theory, GWT）的简化平均场实例化，其中$K$个项目特异性皮层集合同时竞争以维持在全局广播中。每个集合被建模为一个发放率为$r_{e}$的同质兴奋性群体，并且所有集合都通过一个速率为$r_{i}$的单个共享抑制池进行耦合。假设对称性，因此所有$K$个被主动维持的集合具有相同的稳态发放率$r_{e}^{*}$，并且抑制池对它们的总活动做出响应。该群体动力学由Wilson–Cowan速率方程描述，这是计算神经科学中一个经过充分检验的模型，用于兴奋性和抑制性群体：\n$$\n\\tau_{e} \\frac{d r_{e}}{dt} = - r_{e} + \\phi_{e}\\!\\left(w_{ee} r_{e} - w_{ei} r_{i} + I_{d}\\right), \\quad\n\\tau_{i} \\frac{d r_{i}}{dt} = - r_{i} + \\phi_{i}\\!\\left(w_{ie} K r_{e}\\right),\n$$\n其中 $w_{ee} > 0$ 是集合内的循环兴奋，$w_{ei} > 0$ 是来自共享池对兴奋性集合的抑制，$w_{ie} > 0$ 是来自集合对抑制池的兴奋，而 $I_{d} > 0$ 是由任务相关输入提供给每个活动集合的持续性驱动。在感兴趣的工作区间内，输入-输出（增益）函数是线性阈值（分段线性）且非饱和的：\n$$\n\\phi_{e}(x) = g_{e} \\max\\{x - \\theta_{e},\\, 0\\}, \\quad \\phi_{i}(x) = g_{i} \\max\\{x - \\theta_{i},\\, 0\\}.\n$$\n全局广播要求一个集合的兴奋性发放率超过广播阈值 $r_{b}$，即 $r_{e}^{*} \\ge r_{b}$。在我们的场景中，抑制池的容量限制了在它们的相互抑制将活动驱动到$r_{b}$以下之前，可以维持的集合数量。\n\n在稳态区间（$d r_{e}/dt = 0$, $d r_{i}/dt = 0$）进行研究，并假设不动点严格位于增益函数的线性区间内，因此阈值化后的自变量为正，且未达到饱和。使用以下科学上合理的参数：\n- 时间常数：$\\tau_{e} = 1$, $\\tau_{i} = 1$（任意单位；它们在稳态下会抵消）。\n- 增益和阈值：$g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$。\n- 耦合权重：$w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$。\n- 驱动：$I_{d} = 12$。\n- 广播阈值：$r_{b} = 5$。\n- 饱和值足够高，不会构成约束：$r_{e}^{\\max} = 100$, $r_{i}^{\\max} = 50$。\n\n从上述定义和Wilson–Cowan方程出发，推导出稳态兴奋率$r_{e}^{*}$作为$K$的函数的自洽表达式，验证不动点的线性和线性稳定性条件，并计算使得$r_{e}^{*} \\ge r_{b}$成立且不动点保持线性稳定的最大整数$K$。将最终答案表示为单个不带单位的整数$K$。无需四舍五入。",
            "solution": "首先将根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n\n-   **系统**：$K$个项目特异性皮层集合通过一个共享抑制池耦合。\n-   **状态变量**：兴奋性发放率 $r_{e}$，抑制性发放率 $r_{i}$。\n-   **动力学方程 (Wilson-Cowan)**:\n    $$\n    \\tau_{e} \\frac{d r_{e}}{dt} = - r_{e} + \\phi_{e}\\!\\left(w_{ee} r_{e} - w_{ei} r_{i} + I_{d}\\right)\n    $$\n    $$\n    \\tau_{i} \\frac{d r_{i}}{dt} = - r_{i} + \\phi_{i}\\!\\left(w_{ie} K r_{e}\\right)\n    $$\n-   **增益函数 (线性阈值)**:\n    $$\n    \\phi_{e}(x) = g_{e} \\max\\{x - \\theta_{e},\\, 0\\}\n    $$\n    $$\n    \\phi_{i}(x) = g_{i} \\max\\{x - \\theta_{i},\\, 0\\}\n    $$\n-   **参数值**:\n    -   时间常数: $\\tau_{e} = 1$, $\\tau_{i} = 1$。\n    -   增益和阈值: $g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$。\n    -   耦合权重: $w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$。\n    -   驱动: $I_{d} = 12$。\n    -   广播阈值: $r_{b} = 5$。\n    -   饱和值: $r_{e}^{\\max} = 100$, $r_{i}^{\\max} = 50$。\n-   **假设和条件**:\n    1.  在稳态区间（$d r_{e}/dt = 0$, $d r_{i}/dt = 0$）进行研究。设稳态速率为$r_{e}^{*}$和$r_{i}^{*}$。\n    2.  不动点严格位于增益函数的线性区间内。\n    3.  所有$K$个集合具有相同的稳态发放率$r_{e}^{*}$。\n    4.  广播条件是 $r_{e}^{*} \\ge r_{b}$。\n-   **目标**：计算满足$r_{e}^{*} \\ge r_{b}$且不动点线性稳定的最大整数$K$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题使用了Wilson-Cowan速率模型，这是计算神经科学中的一个典范模型。它被应用于全局工作空间理论的一个简化版本，这是一个著名的意识理论。该设置是一个标准的平均场竞争模型。参数被说明是科学上合理的。该问题有科学依据。\n-   **良定性**：该问题提供了一套完整的方程、参数和约束，并要求一个具体的、可计算的量（最大整数$K$）。预期有唯一解。该问题是良定的。\n-   **客观性**：该问题以精确的数学和科学语言陈述，没有主观或模棱两可的术语。该问题是客观的。\n-   **其他缺陷**：该问题不是非形式化、不完整、矛盾、不切实际、不良定或微不足道的。它需要一个多步推导，包括求解一个方程组和进行一次稳定性分析。\n\n### 步骤 3：结论与行动\n\n问题有效。将提供完整解答。\n\n### 解题推导\n\n目标是找到能够在一个广播阈值$r_{b}$之上同时活跃，并保持稳定状态的集合的最大整数数量$K$。\n\n首先，我们求解稳态不动点 $(r_{e}^{*}, r_{i}^{*})$。在稳态下，时间导数为零（$dr_{e}/dt = 0$ 且 $dr_{i}/dt = 0$）。Wilson-Cowan方程变为：\n$$\nr_{e}^{*} = \\phi_{e}\\!\\left(w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d}\\right)\n$$\n$$\nr_{i}^{*} = \\phi_{i}\\!\\left(w_{ie} K r_{e}^{*}\\right)\n$$\n问题陈述不动点位于增益函数的线性区间内。这意味着$\\phi_{e}$和$\\phi_{i}$的自变量大于它们各自的阈值。因此，我们可以用增益函数的线性部分来替换它们：\n$$\nr_{e}^{*} = g_{e} (w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d} - \\theta_{e})\n$$\n$$\nr_{i}^{*} = g_{i} (w_{ie} K r_{e}^{*} - \\theta_{i})\n$$\n现在，我们代入给定的参数值：$g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$, $w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$, and $I_{d} = 12$。\n\n$r_{i}^{*}$的方程变为：\n$$\nr_{i}^{*} = 1 (0.2 \\cdot K \\cdot r_{e}^{*} - 0) = 0.2 K r_{e}^{*}\n$$\n$r_{e}^{*}$的方程变为：\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - 1 \\cdot r_{i}^{*} + 12 - 1)\n$$\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - r_{i}^{*} + 11)\n$$\n为了找到 $r_{e}^{*}$ 作为 $K$ 的函数的表达式，我们将 $r_{i}^{*}$ 的表达式代入 $r_{e}^{*}$ 的方程中：\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - (0.2 K r_{e}^{*}) + 11)\n$$\n我们现在求解这个关于 $r_{e}^{*}$ 的方程：\n$$\n2 r_{e}^{*} = 0.4 r_{e}^{*} - 0.2 K r_{e}^{*} + 11\n$$\n$$\n2 r_{e}^{*} - 0.4 r_{e}^{*} + 0.2 K r_{e}^{*} = 11\n$$\n$$\nr_{e}^{*} (1.6 + 0.2 K) = 11\n$$\n$$\nr_{e}^{*}(K) = \\frac{11}{1.6 + 0.2 K}\n$$\n这就是稳态兴奋率作为$K$的函数的自洽表达式。\n\n接下来，我们必须验证这些假设。\n1.  **线性区间假设**：我们必须检查增益函数的自变量是否为正。\n    -   $\\phi_{i}$的自变量：$w_{ie} K r_{e}^{*} - \\theta_{i} = 0.2 K r_{e}^{*} - 0$。由于$K \\ge 1$且$r_{e}^{*}$（一个发放率）必须为正，因此该项总是正的。\n    -   $\\phi_{e}$的自变量：$w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d} - \\theta_{e} = 0.4 r_{e}^{*} - r_{i}^{*} + 11$。根据我们的推导步骤$r_{e}^{*} = 0.5 (0.4 r_{e}^{*} - r_{i}^{*} + 11)$，该自变量等于$2 r_{e}^{*}$。由于对于$K \\ge 1$，$r_{e}^{*} = \\frac{11}{1.6 + 0.2 K}$总是正的，所以这个条件也总是满足的。\n\n2.  **线性稳定性**：我们通过检验系统雅可比矩阵的特征值来分析不动点的稳定性。线性区间内的完整系统动力学是：\n    $$\n    \\frac{d r_{e}}{dt} = \\frac{1}{\\tau_{e}} \\left[- r_{e} + g_{e} (w_{ee} r_{e} - w_{ei} r_{i} + I_{d} - \\theta_{e})\\right]\n    $$\n    $$\n    \\frac{d r_{i}}{dt} = \\frac{1}{\\tau_{i}} \\left[- r_{i} + g_{i} (w_{ie} K r_{e} - \\theta_{i})\\right]\n    $$\n    雅可比矩阵$J$由下式给出：\n    $$\n    J = \\begin{pmatrix} \\frac{\\partial}{\\partial r_e}(\\frac{dr_e}{dt})  \\frac{\\partial}{\\partial r_i}(\\frac{dr_e}{dt}) \\\\ \\frac{\\partial}{\\partial r_e}(\\frac{dr_i}{dt})  \\frac{\\partial}{\\partial r_i}(\\frac{dr_i}{dt}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\tau_{e}}(-1 + g_{e}w_{ee})  \\frac{1}{\\tau_{e}}(-g_{e}w_{ei}) \\\\ \\frac{1}{\\tau_{i}}(g_{i}w_{ie}K)  \\frac{1}{\\tau_{i}}(-1) \\end{pmatrix}\n    $$\n    代入参数值（$\\tau_e = 1$, $\\tau_i = 1$）:\n    $$\n    J = \\begin{pmatrix} -1 + 0.5 \\cdot 0.4  -0.5 \\cdot 1 \\\\ 1 \\cdot 0.2 \\cdot K  -1 \\end{pmatrix} = \\begin{pmatrix} -0.8  -0.5 \\\\ 0.2 K  -1 \\end{pmatrix}\n    $$\n    对于一个 $2 \\times 2$ 系统，不动点稳定的充分必要条件是雅可比矩阵的迹为负（$\\text{Tr}(J)  0$）且其行列式为正（$\\text{Det}(J) > 0$）。\n    -   迹：$\\text{Tr}(J) = -0.8 + (-1) = -1.8$。由于 $\\text{Tr}(J)  0$，该条件对所有$K$都满足。\n    -   行列式：$\\text{Det}(J) = (-0.8)(-1) - (-0.5)(0.2 K) = 0.8 + 0.1 K$。对于任何物理上有意义的集合数量$K \\ge 1$，$\\text{Det}(J)$总是正的。\n    两个稳定性条件对于所有$K \\ge 1$都满足。因此，该不动点总是线性稳定的。\n\n最后，我们确定满足广播条件$r_{e}^{*} \\ge r_{b}$的最大整数$K$。给定$r_{b} = 5$：\n$$\n\\frac{11}{1.6 + 0.2 K} \\ge 5\n$$\n由于分母$(1.6 + 0.2 K)$对于$K \\ge 1$是正的，我们可以用它乘以不等式两边：\n$$\n11 \\ge 5 (1.6 + 0.2 K)\n$$\n$$\n11 \\ge 8 + K\n$$\n$$\n11 - 8 \\ge K\n$$\n$$\n3 \\ge K\n$$\n条件是$K \\le 3$。因为我们在寻找$K$的最大整数值，所以答案是$3$。当$K=3$时，$r_e^* = 11 / (1.6 + 0.2 \\cdot 3) = 11 / (1.6 + 0.6) = 11 / 2.2 = 5$，正好达到阈值$r_b=5$。对于任何大于3的整数$K$，发放率$r_e^*$将低于阈值。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在建立了一个容量有限的工作空间之后，我们现在来研究一个刺激进入该空间的过程——全局工作空间理论称之为“点燃”（ignition）。本练习使用一个神经群体模型将点燃过程形式化为一个动态分岔，在此过程中系统会突然转变为一个高活动状态。你还将研究自上而下的注意如何促进这一过程，从而为我们的目标和专注点如何影响意识内容提供一个机制性的解释 ()。",
            "id": "3984719",
            "problem": "考虑一个与全局工作空间理论 (GWT) 相关的皮层集合的极简神经元簇模型，其中“点燃”对应于向一个高活动度、自维持的广播状态的分岔。令群体平均活动度为 $x \\in (0,1)$，其演化方程为\n$\\tau \\frac{dx}{dt} = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right),$\n其中 $\\tau$ 是时间常数，$w \\gt 0$ 是回归耦合强度，$I$ 是外部驱动，$\\theta$ 是有效阈值，$g \\gt 0$ 是增益参数，$\\phi(z)$ 是一个S型传递函数。假设使用逻辑斯谛传递函数 $\\phi(z) = \\frac{1}{1 + \\exp(-z)}$，因此 $\\phi'(z) = \\phi(z)\\left(1 - \\phi(z)\\right)$ 且对于 $x \\in (0,1)$ 有 $\\phi^{-1}(x) = \\ln\\!\\left(\\frac{x}{1-x}\\right)$。\n\n一个振幅为 $A \\ge 0$ 的持续性注意信号被建模为在进入非线性部分之前，对传入突触电流进行因子为 $(1 + \\alpha A)$ 的乘性调制，其中敏感度 $\\alpha \\gt 0$。因此，在注意条件下，$\\phi$ 的输入 $u$ 被缩放为 $u \\mapsto (1 + \\alpha A) u$。\n\n仅使用这些模型假设：\n- 推导持续性注意如何调制传递非线性中的有效增益参数 $g$。\n- 将点燃阈值 $I_{\\mathrm{th}}$ 定义为使得低活动度不动点通过鞍结分岔消失的最小 $I$ 值。将点燃阈值视为能同时满足不动点方程和相切条件（即方程右侧关于 $x$ 的斜率为零）的 $I$ 值。\n- 计算在注意条件和非注意条件下点燃阈值的变化量 $\\Delta I_{\\mathrm{th}}$ 的闭合形式表达式，该表达式完全由 $g$、$w$、$\\alpha$ 和 $A$ 表示。假设参数满足 $g w \\gt 4$ 和 $g w (1 + \\alpha A) \\gt 4$，并取鞍结条件的低活动度分支。\n\n请提供 $\\Delta I_{\\mathrm{th}}$ 的单个闭合形式解析表达式作为最终答案。不需要进行数值计算或四舍五入。",
            "solution": "我们从动力学方程开始\n$\\tau \\frac{dx}{dt} = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right)$\n其中 $\\phi(z) = \\frac{1}{1 + \\exp(-z)}$。一个振幅为 $A$ 的持续性注意信号在进入非线性部分前将所有传入电流乘以 $(1 + \\alpha A)$。由于非线性函数的自变量是 $u = g \\left( w x + I - \\theta \\right)$，经注意调制的自变量变为\n$u_{\\mathrm{att}} = (1 + \\alpha A) \\, g \\left( w x + I - \\theta \\right) = g_{\\mathrm{eff}} \\left( w x + I - \\theta \\right),$\n其中我们将有效增益确定为\n$g_{\\mathrm{eff}} = g (1 + \\alpha A).$\n因此，持续性注意对 $g$ 进行乘性调制。\n\n接下来，我们确定点燃阈值 $I_{\\mathrm{th}}$，它是一个不动点不复存在的鞍结点。令 $F(x; I, g) = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right)$。不动点满足 $F(x; I, g) = 0$。在鞍结点处，我们还需满足 $\\frac{\\partial F}{\\partial x} = 0$。用 $s = g \\left( w x + I - \\theta \\right)$ 表示 $\\phi$ 的输入。使用 $\\phi^{-1}(x) = \\ln\\!\\left( \\frac{x}{1-x} \\right)$，不动点条件 $x = \\phi(s)$ 意味着\n$s = \\ln\\!\\left( \\frac{x}{1-x} \\right).$\n相切条件为\n$\\frac{\\partial F}{\\partial x} = -1 + \\phi'(s) \\cdot g w = 0.$\n因为 $\\phi'(s) = \\phi(s) \\left( 1 - \\phi(s) \\right) = x (1 - x)$，相切条件变为\n$-1 + g w \\, x (1 - x) = 0 \\quad \\Rightarrow \\quad g w \\, x (1 - x) = 1.$\n这是一个关于 $x$ 的二次方程：\n$x - x^{2} = \\frac{1}{g w} \\;\\;\\Rightarrow\\;\\; x^{2} - x + \\frac{1}{g w} = 0.$\n求解可得\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 \\pm \\sqrt{1 - \\frac{4}{g w}} \\right).$\n对于低活动度分支，我们取\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w}} \\right).$\n在鞍结点处，$s^{\\ast}(g) = \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right)$，并且从 $s = g \\left( w x + I - \\theta \\right)$ 我们可以解出阈值输入：\n$I_{\\mathrm{th}}(g) = \\theta + \\frac{s^{\\ast}(g)}{g} - w \\, x^{\\ast}(g) = \\theta + \\frac{1}{g} \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right) - w \\, x^{\\ast}(g).$\n\n在持续性注意下，有效增益为 $g_{\\mathrm{eff}} = g (1 + \\alpha A)$，因此注意条件下的阈值为\n$I_{\\mathrm{th}}(g_{\\mathrm{eff}}) = \\theta + \\frac{1}{g_{\\mathrm{eff}}} \\ln\\!\\left( \\frac{x^{\\ast}(g_{\\mathrm{eff}})}{1 - x^{\\ast}(g_{\\mathrm{eff}})} \\right) - w \\, x^{\\ast}(g_{\\mathrm{eff}}),$\n其中\n$x^{\\ast}(g_{\\mathrm{eff}}) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g_{\\mathrm{eff}} w}} \\right) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w (1 + \\alpha A)}} \\right).$\n\n点燃阈值的变化量为\n$\\Delta I_{\\mathrm{th}} = I_{\\mathrm{th}}(g_{\\mathrm{eff}}) - I_{\\mathrm{th}}(g).$\n代入上述表达式，并注意到 $\\theta$ 项相互抵消，我们得到\n$\\Delta I_{\\mathrm{th}} = \\frac{1}{g (1 + \\alpha A)} \\ln\\!\\left( \\frac{x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right)}{1 - x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right)} \\right) - \\frac{1}{g} \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right) - w \\left( x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) - x^{\\ast}(g) \\right),$\n其中\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w}} \\right), \\quad x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w (1 + \\alpha A)}} \\right).$\n\n这就是所要求的、用 $g$、$w$、$\\alpha$ 和 $A$ 表示的闭合形式表达式。在给定条件 $g w \\gt 4$ 和 $g w (1 + \\alpha A) \\gt 4$ 下，平方根是实数，并且因为 $g (1 + \\alpha A) \\gt g$，可以发现 $x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) \\lt x^{\\ast}(g)$ 且 $\\Delta I_{\\mathrm{th}} \\lt 0$，这与注意力降低点燃阈值的结论是一致的。",
            "answer": "$$\\boxed{\\frac{1}{g(1+\\alpha A)}\\,\\ln\\!\\left(\\frac{\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)}{1-\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)}\\right)\\;-\\;\\frac{1}{g}\\,\\ln\\!\\left(\\frac{\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)}{1-\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)}\\right)\\;-\\;w\\left[\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)\\;-\\;\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)\\right]}$$"
        },
        {
            "introduction": "我们实践的最后一部分是理解当多个显著刺激竞争进入工作空间时，系统如何选择一个“胜利者”。这个练习将从具体的回路动力学转向一个更抽象、更具原则性的层面。你将从最大熵原理出发，推导出在机器学习和决策论中无处不在的 softmax 选择规则，展示它如何根据刺激的显著性为概率性广播提供了一个既合理又在数学上优美的解决方案 ()。",
            "id": "3984744",
            "problem": "在全局工作空间理论（GWT）中，一个容量有限的全局广播从多个相互竞争的联盟中选择一个进行接入。考虑 $N$ 个候选联盟，索引为 $i \\in \\{1,\\dots,N\\}$，每个联盟都有一个实值显著性 $s_i \\in \\mathbb{R}$，该显著性概括了自下而上和自上而下的证据。设 $p_i$ 表示候选者 $i$ 在一个给定周期内获得接入的概率。假设在稳态下，选择规则是与固定预期选择成本相一致的最低偏向分布，其中每个候选者的成本定义为 $E_i = -s_i$。这引出一个最大熵公式：最大化香农熵 $H(p) = -\\sum_{i=1}^{N} p_i \\ln p_i$，其约束条件为归一化 $\\sum_{i=1}^{N} p_i = 1$ 和预期成本约束 $\\sum_{i=1}^{N} p_i E_i = \\bar{E}$，其中 $\\bar{E}$ 是有限的。用 $\\beta$ 表示与成本约束相关的拉格朗日乘子，并定义温度参数 $\\tau$ 为 $\\beta = 1/\\tau$，其中 $\\tau  0$。\n\n任务：\n1) 根据最大熵原理和所述约束，推导出唯一的稳态选择规则 $p_i(\\tau)$，作为 $\\{s_i\\}_{i=1}^{N}$ 和 $\\tau$ 的显式函数。\n2) 对于一个固定的候选者 $k \\in \\{1,\\dots,N\\}$，计算偏导数 $\\partial p_k / \\partial \\tau$ 的闭合形式，并用 $\\tau$、$p_k(\\tau)$、显著性集合 $\\{s_i\\}$ 以及显著性期望 $\\mu(\\tau) = \\sum_{j=1}^{N} p_j(\\tau) s_j$ 来简化表示。\n\n最终答案仅报告 $\\partial p_k / \\partial \\tau$ 的表达式。无需四舍五入。无需单位。",
            "solution": "问题要求基于最大熵原理，在特定约束条件下，推导稳态选择概率分布 $p_i$，然后计算该概率相对于温度参数 $\\tau$ 的偏导数。\n\n问题是最大化香non熵 $H(p) = -\\sum_{i=1}^{N} p_i \\ln p_i$，并满足两个约束条件：\n$1$. 归一化：$ \\sum_{i=1}^{N} p_i = 1 $。\n$2$. 固定预期成本：$ \\sum_{i=1}^{N} p_i E_i = \\bar{E} $，其中成本由 $E_i = -s_i$ 给出。此约束可以用显著性 $s_i$ 重写为 $\\sum_{i=1}^{N} p_i (-s_i) = \\bar{E}$，或 $\\sum_{i=1}^{N} p_i s_i = -\\bar{E}$。\n\n我们使用拉格朗日乘子法来解决这个约束优化问题。我们定义拉格朗日函数 $\\mathcal{L}$ 为：\n$$ \\mathcal{L}(p_1, \\dots, p_N, \\lambda, \\beta) = H(p) - \\lambda \\left(\\sum_{i=1}^{N} p_i - 1\\right) - \\beta \\left(\\sum_{i=1}^{N} p_i E_i - \\bar{E}\\right) $$\n其中 $\\lambda$ 和 $\\beta$ 是拉格朗日乘子。问题陈述给出 $\\beta = 1/\\tau$。代入 $H(p)$ 和 $E_i$ 的表达式：\n$$ \\mathcal{L} = -\\sum_{i=1}^{N} p_i \\ln p_i - \\lambda \\left(\\sum_{i=1}^{N} p_i - 1\\right) - \\beta \\left(\\sum_{i=1}^{N} p_i (-s_i) - \\bar{E}\\right) $$\n$$ \\mathcal{L} = -\\sum_{i=1}^{N} p_i \\ln p_i - \\lambda \\sum_{i=1}^{N} p_i + \\lambda + \\beta \\sum_{i=1}^{N} p_i s_i + \\beta \\bar{E} $$\n为了找到使 $\\mathcal{L}$ 最大化的分布 $\\{p_i\\}$，我们对 $\\mathcal{L}$ 关于每个 $p_k$ 求偏导数，并令其为零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_k} = \\frac{\\partial}{\\partial p_k} \\left(-p_k \\ln p_k - \\lambda p_k + \\beta s_k p_k\\right) = 0 $$\n$$ -(\\ln p_k + 1) - \\lambda + \\beta s_k = 0 $$\n$$ \\ln p_k = \\beta s_k - \\lambda - 1 $$\n对两边取指数，得到 $p_k$ 的形式：\n$$ p_k = \\exp(\\beta s_k - \\lambda - 1) = \\exp(-\\lambda - 1) \\exp(\\beta s_k) $$\n我们可以使用归一化约束 $\\sum_{k=1}^{N} p_k = 1$ 来确定项 $\\exp(-\\lambda - 1)$：\n$$ \\sum_{k=1}^{N} \\exp(-\\lambda - 1) \\exp(\\beta s_k) = 1 $$\n$$ \\exp(-\\lambda - 1) \\sum_{k=1}^{N} \\exp(\\beta s_k) = 1 $$\n$$ \\exp(-\\lambda - 1) = \\frac{1}{\\sum_{j=1}^{N} \\exp(\\beta s_j)} $$\n将此代回 $p_k$ 的表达式中，得到：\n$$ p_k = \\frac{\\exp(\\beta s_k)}{\\sum_{j=1}^{N} \\exp(\\beta s_j)} $$\n这是吉布斯-玻尔兹曼分布。问题定义了温度参数 $\\tau$ 使得 $\\beta = 1/\\tau$。代入这个就完成了第一个任务。\n$$ p_i(\\tau) = \\frac{\\exp(s_i / \\tau)}{\\sum_{j=1}^{N} \\exp(s_j / \\tau)} $$\n在机器学习的背景下，这种分布通常被称为softmax函数。\n\n对于第二个任务，我们必须计算固定候选者 $k$ 的偏导数 $\\frac{\\partial p_k}{\\partial \\tau}$。为方便起见，我们定义分母，即配分函数 $Z(\\tau)$：\n$$ Z(\\tau) = \\sum_{j=1}^{N} \\exp(s_j / \\tau) $$\n所以，$p_k(\\tau)$ 的表达式是：\n$$ p_k(\\tau) = \\frac{\\exp(s_k / \\tau)}{Z(\\tau)} $$\n我们使用除法求导法则 $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$，其中 $u(\\tau) = \\exp(s_k/\\tau)$ 且 $v(\\tau) = Z(\\tau)$。首先，我们计算 $u$ 和 $v$ 关于 $\\tau$ 的导数：\n$$ \\frac{du}{d\\tau} = \\frac{d}{d\\tau} \\exp(s_k / \\tau) = \\exp(s_k / \\tau) \\cdot \\frac{d}{d\\tau}(s_k \\tau^{-1}) = \\exp(s_k / \\tau) \\cdot (-s_k \\tau^{-2}) = -\\frac{s_k}{\\tau^2} \\exp(s_k / \\tau) $$\n$$ \\frac{dv}{d\\tau} = \\frac{dZ}{d\\tau} = \\frac{d}{d\\tau}\\left(\\sum_{j=1}^{N} \\exp(s_j / \\tau)\\right) = \\sum_{j=1}^{N} \\left[ \\exp(s_j / \\tau) \\cdot (-s_j \\tau^{-2}) \\right] = -\\frac{1}{\\tau^2} \\sum_{j=1}^{N} s_j \\exp(s_j / \\tau) $$\n现在，应用除法法则：\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{1}{Z(\\tau)^2} \\left[ \\left(-\\frac{s_k}{\\tau^2} \\exp(s_k / \\tau)\\right) Z(\\tau) - \\exp(s_k / \\tau) \\left(-\\frac{1}{\\tau^2} \\sum_{j=1}^{N} s_j \\exp(s_j / \\tau)\\right) \\right] $$\n我们可以从方括号内的表达式中提出公因式：\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{\\exp(s_k / \\tau)}{\\tau^2 Z(\\tau)^2} \\left[ -s_k Z(\\tau) + \\sum_{j=1}^{N} s_j \\exp(s_j / \\tau) \\right] $$\n问题给出了显著性期望的定义 $\\mu(\\tau) = \\sum_{j=1}^{N} p_j(\\tau) s_j$。我们可以用 $Z(\\tau)$ 来表示它：\n$$ \\mu(\\tau) = \\sum_{j=1}^{N} \\frac{\\exp(s_j / \\tau)}{Z(\\tau)} s_j = \\frac{1}{Z(\\tau)} \\sum_{j=1}^{N} s_j \\exp(s_j / \\tau) $$\n这意味着 $\\sum_{j=1}^{N} s_j \\exp(s_j / \\tau) = Z(\\tau)\\mu(\\tau)$。将此代入我们的导数表达式中：\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{\\exp(s_k / \\tau)}{\\tau^2 Z(\\tau)^2} \\left[ -s_k Z(\\tau) + Z(\\tau)\\mu(\\tau) \\right] $$\n从方括号中提出 $Z(\\tau)$：\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{\\exp(s_k / \\tau) Z(\\tau)}{\\tau^2 Z(\\tau)^2} \\left[ \\mu(\\tau) - s_k \\right] $$\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{\\exp(s_k / \\tau)}{\\tau^2 Z(\\tau)} \\left( \\mu(\\tau) - s_k \\right) $$\n通过识别出 $p_k(\\tau) = \\frac{\\exp(s_k / \\tau)}{Z(\\tau)}$，我们得到最终的简化表达式：\n$$ \\frac{\\partial p_k}{\\partial \\tau} = \\frac{p_k(\\tau)}{\\tau^2} \\left( \\mu(\\tau) - s_k \\right) $$\n该表达式给出了选择候选者 $k$ 的概率随温度参数 $\\tau$ 变化的改变量，用其当前概率 $p_k(\\tau)$、其显著性 $s_k$ 和所有候选者的预期显著性 $\\mu(\\tau)$ 来表示。",
            "answer": "$$\\boxed{\\frac{p_k(\\tau)}{\\tau^{2}} \\left(\\mu(\\tau) - s_k\\right)}$$"
        }
    ]
}