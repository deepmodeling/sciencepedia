{
    "hands_on_practices": [
        {
            "introduction": "全局工作空间理论的一个核心概念是“点火”（ignition）——一种神经活动从低激活状态向自我维持的高激活状态的快速、非线性跃迁，这被认为是意识通达（conscious access）的标志。本练习将通过一个简化的神经质量模型，让您亲手探索这一现象。您将通过分析模型的动态特性，计算出一个刺激进入全局广播所需的“点火阈值”，并推导自上而下的注意（attention）如何通过调节神经元增益来降低这一阈值，从而使我们能够有选择地将意识资源聚焦于特定信息。",
            "id": "3984719",
            "problem": "考虑一个涉及全局工作空间理论 (GWT) 的皮层集合的极简神经团块模型，其中“点燃”对应于向一个高活动度、自维持的广播状态的分岔。设群体平均活动度为 $x \\in (0,1)$，其演化遵循以下方程\n$\\tau \\frac{dx}{dt} = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right),$\n其中 $\\tau$ 是时间常数，$w \\gt 0$ 是循环耦合强度，$I$ 是外部驱动，$\\theta$ 是有效阈值，$g \\gt 0$ 是增益参数，而 $\\phi(z)$ 是一个S型传递函数。假设传递函数为逻辑斯谛函数 $\\phi(z) = \\frac{1}{1 + \\exp(-z)}$，因此 $\\phi'(z) = \\phi(z)\\left(1 - \\phi(z)\\right)$ 且对于 $x \\in (0,1)$ 有 $\\phi^{-1}(x) = \\ln\\!\\left(\\frac{x}{1-x}\\right)$。\n\n一个幅度为 $A \\ge 0$ 的持续性注意信号被建模为在非线性作用之前，对传入突触电流进行因子为 $(1 + \\alpha A)$ 的乘法调制，其中敏感度 $\\alpha \\gt 0$。因此，在注意条件下，$\\phi$ 的输入 $u$ 被缩放为 $u \\mapsto (1 + \\alpha A) u$。\n\n仅使用这些建模假设：\n- 推导持续性注意如何调制传递非线性项中的有效增益参数 $g$。\n- 将点燃阈值 $I_{\\mathrm{th}}$ 定义为使得低活动度不动点通过鞍结分岔消失的最小 $I$ 值。将点燃阈值视为同时满足不动点方程和相切条件（即方程右侧关于 $x$ 的斜率为零）的 $I$ 值。\n- 以闭合形式计算注意条件和非注意条件之间的点燃阈值偏移 $\\Delta I_{\\mathrm{th}}$，并完全用 $g$、$w$、$\\alpha$ 和 $A$ 表示。假设参数满足 $g w \\gt 4$ 和 $g w (1 + \\alpha A) \\gt 4$，并取鞍结条件的低活动度分支。\n\n请将您的最终答案表示为 $\\Delta I_{\\mathrm{th}}$ 的单个闭合形式解析表达式。无需进行数值计算或四舍五入。",
            "solution": "我们从动力学方程开始\n$\\tau \\frac{dx}{dt} = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right)$\n其中 $\\phi(z) = \\frac{1}{1 + \\exp(-z)}$。一个幅度为 $A$ 的持续性注意信号在非线性作用之前，将所有传入电流乘以 $(1 + \\alpha A)$。由于非线性项的自变量是 $u = g \\left( w x + I - \\theta \\right)$，经注意调制的自变量变为\n$u_{\\mathrm{att}} = (1 + \\alpha A) \\, g \\left( w x + I - \\theta \\right) = g_{\\mathrm{eff}} \\left( w x + I - \\theta \\right),$\n其中我们将有效增益定义为\n$g_{\\mathrm{eff}} = g (1 + \\alpha A).$\n因此，持续性注意对 $g$ 进行乘法调制。\n\n接下来，我们确定点燃阈值 $I_{\\mathrm{th}}$，它是一个不动点不再存在的鞍结点。令 $F(x; I, g) = -x + \\phi\\!\\left( g \\left( w x + I - \\theta \\right) \\right)$。不动点满足 $F(x; I, g) = 0$。在鞍结点，我们还额外有 $\\frac{\\partial F}{\\partial x} = 0$。用 $s = g \\left( w x + I - \\theta \\right)$ 表示 $\\phi$ 的输入。使用 $\\phi^{-1}(x) = \\ln\\!\\left( \\frac{x}{1-x} \\right)$，不动点条件 $x = \\phi(s)$ 意味着\n$s = \\ln\\!\\left( \\frac{x}{1-x} \\right).$\n相切条件是\n$\\frac{\\partial F}{\\partial x} = -1 + \\phi'(s) \\cdot g w = 0.$\n因为 $\\phi'(s) = \\phi(s) \\left( 1 - \\phi(s) \\right) = x (1 - x)$，所以相切条件变为\n$-1 + g w \\, x (1 - x) = 0 \\quad \\Rightarrow \\quad g w \\, x (1 - x) = 1.$\n这是一个关于 $x$ 的二次方程：\n$x - x^{2} = \\frac{1}{g w} \\;\\;\\Rightarrow\\;\\; x^{2} - x + \\frac{1}{g w} = 0.$\n求解得到\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 \\pm \\sqrt{1 - \\frac{4}{g w}} \\right).$\n对于低活动度分支，我们取\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w}} \\right).$\n在鞍结点处，$s^{\\ast}(g) = \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right)$，并且从 $s = g \\left( w x + I - \\theta \\right)$ 我们解出阈值输入：\n$I_{\\mathrm{th}}(g) = \\theta + \\frac{s^{\\ast}(g)}{g} - w \\, x^{\\ast}(g) = \\theta + \\frac{1}{g} \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right) - w \\, x^{\\ast}(g).$\n\n在持续性注意下，有效增益为 $g_{\\mathrm{eff}} = g (1 + \\alpha A)$，因此注意条件下的阈值为\n$I_{\\mathrm{th}}(g_{\\mathrm{eff}}) = \\theta + \\frac{1}{g_{\\mathrm{eff}}} \\ln\\!\\left( \\frac{x^{\\ast}(g_{\\mathrm{eff}})}{1 - x^{\\ast}(g_{\\mathrm{eff}})} \\right) - w \\, x^{\\ast}(g_{\\mathrm{eff}}),$\n其中\n$x^{\\ast}(g_{\\mathrm{eff}}) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g_{\\mathrm{eff}} w}} \\right) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w (1 + \\alpha A)}} \\right).$\n\n点燃阈值的偏移为\n$\\Delta I_{\\mathrm{th}} = I_{\\mathrm{th}}(g_{\\mathrm{eff}}) - I_{\\mathrm{th}}(g).$\n代入上述表达式，并注意到 $\\theta$ 项相互抵消，我们得到\n$\\Delta I_{\\mathrm{th}} = \\frac{1}{g (1 + \\alpha A)} \\ln\\!\\left( \\frac{x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right)}{1 - x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right)} \\right) - \\frac{1}{g} \\ln\\!\\left( \\frac{x^{\\ast}(g)}{1 - x^{\\ast}(g)} \\right) - w \\left( x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) - x^{\\ast}(g) \\right),$\n其中\n$x^{\\ast}(g) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w}} \\right), \\quad x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) = \\frac{1}{2} \\left( 1 - \\sqrt{1 - \\frac{4}{g w (1 + \\alpha A)}} \\right).$\n\n这就是所要求的用 $g$、$w$、$\\alpha$ 和 $A$ 表示的闭合形式表达式。在所述条件 $g w \\gt 4$ 和 $g w (1 + \\alpha A) \\gt 4$ 下，平方根为实数。又因为 $g (1 + \\alpha A) \\gt g$，可以发现 $x^{\\ast}\\!\\left(g (1 + \\alpha A)\\right) \\lt x^{\\ast}(g)$ 且 $\\Delta I_{\\mathrm{th}} \\lt 0$，这与注意会降低点燃阈值的结论是一致的。",
            "answer": "$$\\boxed{\\frac{1}{g(1+\\alpha A)}\\,\\ln\\!\\left(\\frac{\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)}{1-\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)}\\right)\\;-\\;\\frac{1}{g}\\,\\ln\\!\\left(\\frac{\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)}{1-\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)}\\right)\\;-\\;w\\left[\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w (1+\\alpha A)}}\\right)\\;-\\;\\tfrac{1}{2}\\left(1-\\sqrt{1-\\tfrac{4}{g w}}\\right)\\right]}$$"
        },
        {
            "introduction": "在理解了单个信息如何“点火”进入意识之后，下一个关键问题是：为什么我们不能同时意识到很多件事？全局工作空间的“容量限制”是其最显著的特征之一。本练习将使用经典的 Wilson-Cowan 速率模型来模拟多个神经集群如何通过一个共享的抑制性神经元池相互竞争有限的神经资源。通过求解这个系统的稳态，您将计算出该工作空间能够同时维持并广播的最大信息数量 $K$，从而具体地理解共享抑制机制是如何自然地导致意识容量的瓶颈。",
            "id": "3984696",
            "problem": "考虑一个简化的全局工作空间理论 (GWT) 的平均场实例化，其中 $K$ 个项目特异性皮层集合同时竞争以维持在全局广播中。每个集合被建模为一个发放率为 $r_{e}$ 的同质兴奋性群体，所有集合通过一个发放率为 $r_{i}$ 的共享抑制池耦合在一起。假设存在对称性，因此所有 $K$ 个主动维持的集合具有相同的稳态发放率 $r_{e}^{*}$，并且抑制池对其总活动作出响应。该群体动力学由 Wilson–Cowan 率方程描述，这是计算神经科学中一个经过充分检验的模型，用于兴奋性和抑制性群体：\n$$\n\\tau_{e} \\frac{d r_{e}}{dt} = - r_{e} + \\phi_{e}\\!\\left(w_{ee} r_{e} - w_{ei} r_{i} + I_{d}\\right), \\quad\n\\tau_{i} \\frac{d r_{i}}{dt} = - r_{i} + \\phi_{i}\\!\\left(w_{ie} K r_{e}\\right),\n$$\n其中 $w_{ee} > 0$ 是集合内部的循环兴奋，$w_{ei} > 0$ 是共享池对兴奋性集合的抑制，$w_{ie} > 0$ 是集合对抑制池的兴奋，而 $I_{d} > 0$ 是由任务相关输入提供给每个活动集合的持续性驱动。输入-输出（增益）函数在感兴趣的工作区域内是线性阈值（分段线性）且非饱和的：\n$$\n\\phi_{e}(x) = g_{e} \\max\\{x - \\theta_{e},\\, 0\\}, \\quad \\phi_{i}(x) = g_{i} \\max\\{x - \\theta_{i},\\, 0\\}.\n$$\n全局广播要求一个集合的兴奋性发放率超过广播阈值 $r_{b}$，即 $r_{e}^{*} \\ge r_{b}$。在我们的场景中，抑制池的能力限制了在相互抑制将其驱动到 $r_{b}$ 以下之前可以维持多少个集合。\n\n在稳态区域（$d r_{e}/dt = 0$, $d r_{i}/dt = 0$）下进行分析，并假设不动点严格位于增益函数的线性区域内，因此阈值化后的参数为正，且未达到饱和值。使用以下科学上合理的参数：\n- 时间常数：$\\tau_{e} = 1$，$\\tau_{i} = 1$（任意单位；它们在稳态时会抵消）。\n- 增益和阈值：$g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$。\n- 耦合权重：$w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$。\n- 驱动：$I_{d} = 12$。\n- 广播阈值：$r_{b} = 5$。\n- 饱和值足够高以至于不起作用：$r_{e}^{\\max} = 100$, $r_{i}^{\\max} = 50$。\n\n从上述定义和 Wilson–Cowan 方程出发，推导稳态兴奋率 $r_{e}^{*}$ 作为 $K$ 的函数的自洽表达式，验证不动点的线性区域和线性稳定性条件，并计算使 $r_{e}^{*} \\ge r_{b}$ 成立且不动点保持线性稳定的最大整数 $K$。将您的最终答案表示为单个整数 $K$，不带单位。无需四舍五入。",
            "solution": "首先将根据指定标准验证该问题。\n\n### 步骤 1：提取已知条件\n\n-   **系统**：$K$ 个项目特异性皮层集合通过一个共享抑制池耦合在一起。\n-   **状态变量**：兴奋性发放率 $r_{e}$，抑制性发放率 $r_{i}$。\n-   **动力学方程 (Wilson-Cowan)**：\n    $$\n    \\tau_{e} \\frac{d r_{e}}{dt} = - r_{e} + \\phi_{e}\\!\\left(w_{ee} r_{e} - w_{ei} r_{i} + I_{d}\\right)\n    $$\n    $$\n    \\tau_{i} \\frac{d r_{i}}{dt} = - r_{i} + \\phi_{i}\\!\\left(w_{ie} K r_{e}\\right)\n    $$\n-   **增益函数 (线性阈值)**：\n    $$\n    \\phi_{e}(x) = g_{e} \\max\\{x - \\theta_{e},\\, 0\\}\n    $$\n    $$\n    \\phi_{i}(x) = g_{i} \\max\\{x - \\theta_{i},\\, 0\\}\n    $$\n-   **参数值**：\n    -   时间常数：$\\tau_{e} = 1$, $\\tau_{i} = 1$。\n    -   增益和阈值：$g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$。\n    -   耦合权重：$w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$。\n    -   驱动：$I_{d} = 12$。\n    -   广播阈值：$r_{b} = 5$。\n    -   饱和值：$r_{e}^{\\max} = 100$, $r_{i}^{\\max} = 50$。\n-   **假设和条件**：\n    1.  在稳态区域（$d r_{e}/dt = 0$, $d r_{i}/dt = 0$）下进行分析。设稳态发放率为 $r_{e}^{*}$ 和 $r_{i}^{*}$。\n    2.  不动点严格位于增益函数的线性区域内。\n    3.  所有 $K$ 个集合具有相同的稳态发放率 $r_{e}^{*}$。\n    4.  广播条件为 $r_{e}^{*} \\ge r_{b}$。\n-   **目标**：计算满足 $r_{e}^{*} \\ge r_{b}$ 和不动点线性稳定性的最大整数 $K$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题使用了 Wilson-Cowan 率模型，这是计算神经科学中的一个经典模型。它被应用于全局工作空间理论（一种著名的意识理论）的简化版本。该设置是一个标准的平均场竞争模型。参数被说明是科学上合理的。该问题具有科学依据。\n-   **良态的**：该问题提供了一整套方程、参数和约束，并要求计算一个具体、可计算的量（最大整数 $K$）。预期会有一个唯一的解。该问题是良态的。\n-   **客观的**：该问题以精确的数学和科学语言陈述，没有主观或含糊的术语。该问题是客观的。\n-   **其他缺陷**：该问题不是不可形式化的、不完整的、矛盾的、不切实际的、病态的或微不足道的。它需要一个多步骤的推导，包括求解方程组和进行稳定性分析。\n\n### 步骤 3：结论和行动\n\n该问题是有效的。将提供完整的解答。\n\n### 解答推导\n\n目标是找到能够同时在广播阈值 $r_{b}$ 以上保持活跃，并维持一个稳定状态的最大整数集合数量 $K$。\n\n首先，我们找到稳态不动点 $(r_{e}^{*}, r_{i}^{*})$。在稳态下，时间导数为零（$dr_{e}/dt = 0$ 和 $dr_{i}/dt = 0$）。Wilson-Cowan 方程变为：\n$$\nr_{e}^{*} = \\phi_{e}\\!\\left(w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d}\\right)\n$$\n$$\nr_{i}^{*} = \\phi_{i}\\!\\left(w_{ie} K r_{e}^{*}\\right)\n$$\n问题陈述不动点位于增益函数的线性区域内。这意味着 $\\phi_{e}$ 和 $\\phi_{i}$ 的自变量大于它们各自的阈值。因此，我们可以用增益函数的线性部分来替换它们：\n$$\nr_{e}^{*} = g_{e} (w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d} - \\theta_{e})\n$$\n$$\nr_{i}^{*} = g_{i} (w_{ie} K r_{e}^{*} - \\theta_{i})\n$$\n现在，我们代入给定的参数值：$g_{e} = 0.5$, $g_{i} = 1$, $\\theta_{e} = 1$, $\\theta_{i} = 0$, $w_{ee} = 0.4$, $w_{ei} = 1$, $w_{ie} = 0.2$, 和 $I_{d} = 12$。\n\n$r_{i}^{*}$ 的方程变为：\n$$\nr_{i}^{*} = 1 (0.2 \\cdot K \\cdot r_{e}^{*} - 0) = 0.2 K r_{e}^{*}\n$$\n$r_{e}^{*}$ 的方程变为：\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - 1 \\cdot r_{i}^{*} + 12 - 1)\n$$\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - r_{i}^{*} + 11)\n$$\n为了找到 $r_{e}^{*}$ 作为 $K$ 的函数的表达式，我们将 $r_{i}^{*}$ 的表达式代入 $r_{e}^{*}$ 的方程中：\n$$\nr_{e}^{*} = 0.5 (0.4 r_{e}^{*} - (0.2 K r_{e}^{*}) + 11)\n$$\n我们现在求解这个关于 $r_{e}^{*}$ 的方程：\n$$\n2 r_{e}^{*} = 0.4 r_{e}^{*} - 0.2 K r_{e}^{*} + 11\n$$\n$$\n2 r_{e}^{*} - 0.4 r_{e}^{*} + 0.2 K r_{e}^{*} = 11\n$$\n$$\nr_{e}^{*} (1.6 + 0.2 K) = 11\n$$\n$$\nr_{e}^{*}(K) = \\frac{11}{1.6 + 0.2 K}\n$$\n这就是稳态兴奋率作为 $K$ 的函数的自洽表达式。\n\n接下来，我们必须验证这些假设。\n1.  **线性区域假设**：我们必须检查增益函数的自变量是否为正。\n    -   $\\phi_{i}$ 的自变量：$w_{ie} K r_{e}^{*} - \\theta_{i} = 0.2 K r_{e}^{*} - 0$。由于 $K \\ge 1$ 且 $r_{e}^{*}$（一个发放率）必须为正，所以这个值总是正的。\n    -   $\\phi_{e}$ 的自变量：$w_{ee} r_{e}^{*} - w_{ei} r_{i}^{*} + I_{d} - \\theta_{e} = 0.4 r_{e}^{*} - r_{i}^{*} + 11$。根据我们的推导步骤 $r_{e}^{*} = 0.5 (0.4 r_{e}^{*} - r_{i}^{*} + 11)$，这个自变量等于 $2 r_{e}^{*}$。由于对于 $K \\ge 1$，$r_{e}^{*} = \\frac{11}{1.6 + 0.2 K}$ 总是正的，所以这个条件也总是满足的。\n\n2.  **线性稳定性**：我们通过检查系统雅可比矩阵的特征值来分析不动点的稳定性。线性区域内的完整系统动力学为：\n    $$\n    \\frac{d r_{e}}{dt} = \\frac{1}{\\tau_{e}} \\left[- r_{e} + g_{e} (w_{ee} r_{e} - w_{ei} r_{i} + I_{d} - \\theta_{e})\\right]\n    $$\n    $$\n    \\frac{d r_{i}}{dt} = \\frac{1}{\\tau_{i}} \\left[- r_{i} + g_{i} (w_{ie} K r_{e} - \\theta_{i})\\right]\n    $$\n    雅可比矩阵 $J$ 由下式给出：\n    $$\n    J = \\begin{pmatrix} \\frac{\\partial}{\\partial r_e}(\\frac{dr_e}{dt})  \\frac{\\partial}{\\partial r_i}(\\frac{dr_e}{dt}) \\\\ \\frac{\\partial}{\\partial r_e}(\\frac{dr_i}{dt})  \\frac{\\partial}{\\partial r_i}(\\frac{dr_i}{dt}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\tau_{e}}(-1 + g_{e}w_{ee})  \\frac{1}{\\tau_{e}}(-g_{e}w_{ei}) \\\\ \\frac{1}{\\tau_{i}}(g_{i}w_{ie}K)  \\frac{1}{\\tau_{i}}(-1) \\end{pmatrix}\n    $$\n    代入参数值（$\\tau_e = 1$, $\\tau_i = 1$）：\n    $$\n    J = \\begin{pmatrix} -1 + 0.5 \\cdot 0.4  -0.5 \\cdot 1 \\\\ 1 \\cdot 0.2 \\cdot K  -1 \\end{pmatrix} = \\begin{pmatrix} -0.8  -0.5 \\\\ 0.2 K  -1 \\end{pmatrix}\n    $$\n    对于一个 $2 \\times 2$ 系统，不动点是稳定的当且仅当雅可比矩阵的迹为负（$\\text{Tr}(J) < 0$）且行列式为正（$\\text{Det}(J) > 0$）。\n    -   迹：$\\text{Tr}(J) = -0.8 + (-1) = -1.8$。由于 $\\text{Tr}(J) < 0$，此条件对所有 $K$ 都满足。\n    -   行列式：$\\text{Det}(J) = (-0.8)(-1) - (-0.5)(0.2 K) = 0.8 + 0.1 K$。对于任何物理上有意义的集合数量 $K \\ge 1$，$\\text{Det}(J)$ 总是正的。\n    两个稳定性条件对于所有 $K \\ge 1$ 都满足。因此，该不动点总是线性稳定的。\n\n最后，我们确定使广播条件 $r_{e}^{*} \\ge r_{b}$ 满足的最大整数 $K$。给定 $r_{b} = 5$：\n$$\n\\frac{11}{1.6 + 0.2 K} \\ge 5\n$$\n由于对于 $K \\ge 1$，分母 $(1.6 + 0.2 K)$ 是正的，我们可以用它乘以两边：\n$$\n11 \\ge 5 (1.6 + 0.2 K)\n$$\n$$\n11 \\ge 8 + K\n$$\n$$\n11 - 8 \\ge K\n$$\n$$\n3 \\ge K\n$$\n条件是 $K \\le 3$。因为我们正在寻找 $K$ 的最大整数值，所以答案是 $3$。对于 $K = 3$，$r_e^* = 11 / (1.6 + 0.2 \\cdot 3) = 11 / (1.6 + 0.6) = 11 / 2.2 = 5$，正好达到阈值 $r_b=5$。对于任何大于 3 的整数 $K$，发放率 $r_e^*$ 将低于该阈值。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "点火和竞争发生在局部神经回路中，但“全局广播”则意味着信息需要在大尺度脑网络中传播。这种广播能力依赖于大脑连接组（connectome）的底层结构。本练习将视角从神经元动力学转向网络科学，要求您将全局广播的涌现形式化为网络上的“渗流”（percolation）问题。您将应用渗流理论，通过一种先进的谱方法（基于非回溯矩阵）来计算一个网络需要达到何种临界连接密度，才能涌现出一个“巨型连通分量”（giant component），为信息的全局传播提供结构基础。",
            "id": "3984683",
            "problem": "您的任务是根据全局工作空间理论（GWT）的启发，在一个皮质连接组的网络模型中，形式化并计算全局广播基底出现的临界键合概率。在 GWT 中，一旦连接组支持一个连通的宏观结构，一个高影响力节点的子集（一个“工作空间”）就能够全局广播信息。您需要将其构建为一个在近似连接组的有限图上的键渗流问题，并通过巨型连通分量的出现来定义广播阈值。\n\n用作基础的基本定义：\n- 网络由一个简单无向图表示，其邻接矩阵为 $A \\in \\{0,1\\}^{N \\times N}$，当且仅当节点 $i$ 和 $j$ 共享一条无向边时，$A_{ij} = 1$，且对所有 $i$，$A_{ii} = 0$。\n- 在键合概率为 $p \\in [0,1]$ 的键渗流中，原始图的每条边以概率 $p$ 被独立保留，以概率 $1-p$ 被移除。\n- 连通分量是一个节点的最大子集，其中所有节点对都通过保留边的路径相互连接。\n- 巨型连通分量是指在 $N$ 趋于无穷大的极限下，其大小与 $N$ 成比例的连通分量。在有限图上，它在局部树状近似下被算法化地近似为，当某个单一分量的期望大小达到 $N$ 的量级时的起始点。\n- 工作空间集 $W \\subseteq \\{0,1,\\dots,N-1\\}$ 是一组被认为能够发起全局广播的节点。\n- 此处为 GWT 定义的充分广播条件为：渗流图中出现一个巨型连通分量，并且该巨型连通分量中至少包含一个来自 $W$ 的节点。\n- 在正则图上，由于所有节点在结构上是等价的，该条件简化为识别巨型连通分量出现的渗流阈值。\n\n任务：\n- 从上述基本定义和网络渗流理论中经过充分检验的事实出发，使用非回溯路径的谱诊断方法，推导出一个可计算的准则，用于确定有限、局部树状图上巨型连通分量出现的临界键合概率 $p_c$。\n- 实现一个程序，在给定小型邻接矩阵 $A$ 和工作空间节点集 $W$ 的情况下，使用基于局部树状近似的、有理论依据的谱方法计算 $p_c$。程序应返回一个浮点数 $p_c \\in [0,1]$。\n\n精确计算要求：\n- 通过由 $A$ 构建的非回溯（Hashimoto）算子的谱半径来表示键渗流阈值。使用不依赖蒙特卡洛采样的确定性算法。确保对所提供的小型图的数值稳定性。\n- 确保返回的 $p_c$ 位于 $[0,1]$ 区间内。\n\n测试套件：\n为以下每种情况计算 $p_c$。对于每种情况，$N$ 是节点数，$A$ 是 $N \\times N$ 的邻接矩阵，$W$ 是工作空间集。\n\n- 情况 1（3-正则“立方体”图）：$N = 8$。无向边为\n  $\\{(0,1),(1,3),(3,2),(2,0),(4,5),(5,7),(7,6),(6,4),(0,4),(1,5),(2,6),(3,7)\\}$。设 $W = \\{0,7\\}$。\n- 情况 2（完全图 $K_5$）：$N=5$。对所有 $i \\neq j$，$A_{ij} = 1$，且 $A_{ii} = 0$。设 $W = \\{0\\}$。\n- 情况 3（循环图 $C_8$）：$N=8$。无向边为 $\\{(i,(i+1) \\bmod 8): i \\in \\{0,1,\\dots,7\\}\\}$。设 $W = \\{0,4\\}$。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个数字四舍五入到小数点后六位，并按测试套件案例的顺序排列。例如，输出格式为 $\\texttt{[x\\_1,x\\_2,x\\_3]}$，其中每个 $x_k$ 是为案例 $k$ 计算并四舍五入到六位小数的 $p_c$。\n\n注意：\n- 避免使用任何随机抽样；使用从第一性原理推导出的谱非回溯方法来确定 $p_c$。\n- 不涉及物理单位。不涉及角度。",
            "solution": "用户提供了一个问题，要求在一个网络模型中，对全局广播基底出现的临界键合概率 $p_c$ 进行形式化和计算。该问题以全局工作空间理论（GWT）为背景，并在数学上建模为图上的键渗流。\n\n### 问题验证\n\n首先，根据所需标准对提供的问题陈述进行验证。\n\n**1. 已知条件提取：**\n-   **图：** 一个由 $N$ 个节点组成的简单无向图，用邻接矩阵 $A \\in \\{0,1\\}^{N \\times N}$ 表示。\n-   **键渗流：** 图的每条边以概率 $p \\in [0,1]$ 被独立保留。\n-   **巨型连通分量：** 一个大小与 $N$ 成比例的连通分量。对于有限图，在局部树状近似下，其出现被确定为某个单一分量的期望大小达到 $N$ 量级的阈值。\n-   **工作空间集 $W$：** 节点的一个子集 $W \\subseteq \\{0,1,\\dots,N-1\\}$。\n-   **GWT 广播条件：** 定义为在渗流图中出现一个巨型连通分量，且该分量至少包含一个来自集合 $W$ 的节点。\n-   **简化：** 对于正则图，由于所有节点在结构上是等价的，该条件简化为巨型连通分量的出现。\n-   **计算任务：** 为有限的、局部树状的图，推导并实现一种基于非回溯（Hashimoto）算子的确定性谱方法来计算 $p_c$。\n-   **测试案例：** 提供了三个具体图形：一个 8 节点立方体图、完全图 $K_5$ 和循环图 $C_8$。\n-   **输出：** 测试案例的 $p_c$ 值列表，四舍五入到六位小数。\n\n**2. 验证结论：**\n该问题被评估为 **有效**。它在科学上基于成熟的渗流理论和网络科学。所提出的与 GWT 的联系是一种有效的建模方法。任务阐述清晰，目标明确，并指定了一种有充分根据的计算方法（非回溯矩阵谱分析）。问题提供了所有必要信息，内部一致，并且需要进行一项不平凡但可行的计算。工作空间集 $W$ 的作用在问题本身中得到了澄清：对于测试套件中的正则图，临界概率 $p_c$ 仅取决于图的结构，而不取决于 $W$ 的具体选择。$p_c$ 的计算由巨型连通分量本身的出现来决定。\n\n### 推导与求解\n\n求解过程首先推导渗流阈值的谱准则，然后通过算法实现它。\n\n**理论框架：作为分支过程的渗流**\n在键渗流作用下，图中巨型连通分量的出现是一种相变。这种转变可以通过与分支过程的类比来理解。想象一下从一条初始的“活动”边开始探索图。连通性会传播到相邻的边。如果平均而言，每条活动边能产生多于一条新的活动边，那么就会形成一个巨型连通分量。为了避免在探索中出现无意义的即时折返（例如，遍历 $u \\to v$ 后立即返回到 $v \\to u$），我们在*非回溯行走*的空间上分析该过程。这种方法在无限树上是精确的，并且对于局部树状的图（即稀疏且短循环少的图）来说，是一个高度准确的近似。\n\n**非回溯矩阵**\n非回溯行走是一系列相连的边，其中没有一条边紧跟着其前驱边的反向边。所有可能的长度为一的非回溯行走的结构被编码在**非回溯矩阵** $B$ 中，该矩阵也被称为 Hashimoto 矩阵。\n\n假设图有 $M$ 条无向边，对应于 $2M$ 条有向边。矩阵 $B$ 是一个由这些有向边索引的 $2M \\times 2M$ 矩阵。如果从 $i \\to j$ 的行走可以无回溯地延伸到 $k \\to l$，则矩阵项 $B_{i\\to j, k\\to l}$ 为 $1$，否则为 $0$。这需要满足两个条件：\n1.  第一条边的头部必须是第二条边的尾部：$j=k$。\n2.  第二条边不能是第一条边的反向边：$l \\neq i$。\n\n形式上，其元素定义为：\n$$B_{(u,v), (v',w)} = \\delta_{v,v'}(1 - \\delta_{u,w})$$\n其中 $(u,v)$ 和 $(v',w)$ 代表有向边，$\\delta$ 是克罗内克 δ 函数。\n\n**$p_c$ 的临界概率推导**\n在键渗流模型中，每条边以概率 $p$ 存在。考虑沿非回溯路径的连通性传播。矩阵 $B$ 计算了每条有向边的潜在单步扩展数量。在渗流图中，这些潜在扩展中的每一个都以概率 $p$ 实现。因此，成功的非回溯扩展的期望数量由矩阵乘积 $pB$ 决定。\n\n如果活动边的数量最终消失，则分支过程是亚临界的；如果呈指数增长，则是超临界的。转变恰好发生在期望算子 $pB$ 的最大特征值（谱半径）等于 $1$ 时。设 $\\lambda_{\\max}(B)$ 为 $B$ 的最大模特征值。由于 $B$ 是非负矩阵， $pB$ 的谱半径为 $\\rho(pB) = p \\cdot \\rho(B) = p \\cdot \\lambda_{\\max}(B)$。因此，临界条件是：\n$$p_c \\cdot \\lambda_{\\max}(B) = 1$$\n这给出了临界键合概率的直接公式：\n$$p_c = \\frac{1}{\\lambda_{\\max}(B)}$$\n对于一个连通的 $k$-正则图，一个已知结果是 $\\lambda_{\\max}(B) = k-1$。这个公式将通过直接计算得到验证。\n\n**计算 $p_c$ 的算法**\n该推导过程得出了一个确定性算法：\n1.  **表示图：** 从给定的邻接矩阵 $A$ 或边列表，构建包含所有 $2M$ 条有向边的列表。创建一个从每个有向边元组（例如 $(u,v)$）到从 $0$ 到 $2M-1$ 的唯一整数索引的映射。\n2.  **构建矩阵 $B$：** 初始化一个 $2M \\times 2M$ 的零矩阵。对于每个索引为 $i$ 的有向边 $e_1 = (u,v)$，找到 $v$ 的所有邻居节点 $w$。对于每个满足 $w \\neq u$ 的 $w$，找到后继边 $e_2 = (v,w)$ 的索引 $j$，并设置矩阵项 $B_{ij} = 1$。\n3.  **寻找谱半径：** 计算矩阵 $B$ 的特征值。由于 $B$ 可能不是对称的，特征值可以是复数。谱半径 $\\lambda_{\\max}(B)$ 是这些特征值绝对值的最大值。\n4.  **计算 $p_c$：** 使用推导出的公式 $p_c = 1 / \\lambda_{\\max}(B)$ 计算临界概率。如果 $\\lambda_{\\max}(B) < 1$，模型表明即使在 $p=1$ 时也无法形成巨型连通分量；在这种情况下，$p_c$ 实际上是 $1$。根据要求，将最终结果裁剪到 $[0,1]$ 范围内。\n\n对提供的每个测试案例实施此程序。\n-   情况 1（立方体）：一个 3-正则图。我们预期 $\\lambda_{\\max}(B)=3-1=2$，所以 $p_c=0.5$。\n-   情况 2 ($K_5$)：一个 4-正则图。我们预期 $\\lambda_{\\max}(B)=4-1=3$，所以 $p_c=1/3$。\n-   情况 3 ($C_8$)：一个 2-正则图。我们预期 $\\lambda_{\\max}(B)=2-1=1$，所以 $p_c=1$。\n\n程序将为每种情况构建特定的非回溯矩阵，并数值计算其谱半径以找到 $p_c$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the critical bond probability p_c for the emergence of a giant\n    component in several graph structures, based on the spectral properties of\n    the non-backtracking matrix.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    # Case 1: 3-regular \"cube\" graph\n    n1 = 8\n    edges1 = [\n        (0, 1), (1, 3), (3, 2), (2, 0), (4, 5), (5, 7), (7, 6), (6, 4),\n        (0, 4), (1, 5), (2, 6), (3, 7)\n    ]\n\n    # Case 2: Complete graph K_5\n    n2 = 5\n    edges2 = [(i, j) for i in range(n2) for j in range(i + 1, n2)]\n\n    # Case 3: Cycle graph C_8\n    n3 = 8\n    edges3 = [(i, (i + 1) % n3) for i in range(n3)]\n\n    test_cases = [\n        (n1, edges1),\n        (n2, edges2),\n        (n3, edges3),\n    ]\n\n    results = []\n    for N, edges in test_cases:\n        pc = compute_pc(N, edges)\n        results.append(f\"{pc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef compute_pc(N, edges):\n    \"\"\"\n    Computes the critical bond probability p_c for a given graph.\n\n    The method is based on the spectral radius (lambda_max) of the \n    non-backtracking matrix B of the graph, where p_c = 1 / lambda_max.\n\n    Args:\n        N (int): The number of nodes in the graph.\n        edges (list of tuples): A list of undirected edges.\n\n    Returns:\n        float: The critical bond probability p_c.\n    \"\"\"\n    if not edges:\n        return 1.0  # Convention for graphs with no edges\n\n    # Step 1: Enumerate all directed edges and create an adjacency list\n    adj = {i: [] for i in range(N)}\n    directed_edges = []\n    for u, v in edges:\n        adj[u].append(v)\n        adj[v].append(u)\n        directed_edges.append((u, v))\n        directed_edges.append((v, u))\n    \n    num_directed_edges = len(directed_edges)\n    edge_to_idx = {edge: i for i, edge in enumerate(directed_edges)}\n\n    # Step 2: Construct the non-backtracking matrix B\n    B = np.zeros((num_directed_edges, num_directed_edges), dtype=float)\n    for i, e1 in enumerate(directed_edges):\n        u, v = e1\n        # A non-backtracking walk from u->v continues to v->w where w != u\n        for w in adj[v]:\n            if w != u:\n                e2 = (v, w)\n                if e2 in edge_to_idx:\n                    j = edge_to_idx[e2]\n                    B[i, j] = 1.0\n    \n    # Step 3: Compute the spectral radius of B\n    if num_directed_edges == 0:\n        lambda_max = 0.0\n    else:\n        try:\n            eigenvalues = np.linalg.eigvals(B)\n            # The spectral radius is the largest absolute value of the eigenvalues\n            lambda_max = np.max(np.abs(eigenvalues))\n        except np.linalg.LinAlgError:\n            # Fallback for numerical instability, though not expected here.\n            return 1.0\n\n    # Step 4: Calculate p_c from lambda_max\n    # If lambda_max is zero or very small, p_c is effectively infinite.\n    # This means a giant component cannot form. In the context of a probability\n    # p_c in [0,1], this implies the threshold is effectively at p=1,\n    # and even then a giant component might not exist.\n    if lambda_max  1e-9:\n        pc = 1.0\n    else:\n        pc = 1.0 / lambda_max\n    \n    # Enforce that p_c is in [0, 1] as per the problem requirements.\n    # For a graph with max degree > 2, lambda_max > 1, so pc  1.\n    # For a 2-regular graph (a cycle), lambda_max = 1, so pc = 1.\n    return np.clip(pc, 0.0, 1.0)\n\n\nsolve()\n```"
        }
    ]
}