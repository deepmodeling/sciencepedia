{
    "hands_on_practices": [
        {
            "introduction": "The foundational step in studying any neural representation is to identify neurons that encode a specific variable. This exercise provides a hands-on guide to the essential data analysis techniques used to classify head-direction (HD) cells from experimental recordings. By working with a hypothetical dataset of spike times and head angles, you will practice constructing an occupancy-normalized tuning curve and applying the Rayleigh test for circular non-uniformity, two cornerstone methods in the analysis of spatially tuned neurons .",
            "id": "3987266",
            "problem": "A single neuron is recorded while a freely moving animal rotates its head in a two-dimensional arena. The head direction angle is recorded as a function of time, denoted by $\\theta(t) \\in [0, 2\\pi)$, and spike times are denoted by $\\{t_i\\}_{i=1}^N$. The task is to determine whether this neuron is a Head Direction (HD) cell by constructing a circular tuning curve and applying a statistical test for directional non-uniformity. Use the following scenario.\n\nThe recording duration is $T = 240$ seconds. The head angle $\\theta(t)$ is well-sampled and the animal explores uniformly so that occupancy is approximately equal across angles. Construct an occupancy histogram with $8$ equal-width bins centered at angles $0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ$, with bin half-width $22.5^\\circ$. The measured occupancy time per bin is $30$ seconds.\n\nSimultaneously recorded spikes occur at times $\\{t_i\\}_{i=1}^{12}$ and the head angle at each spike time is given by:\n$$\n\\theta(t_i) \\in \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}.\n$$\n\nStarting only from the definitions of firing rate as spikes per unit time and the circular mean resultant vector for angles on the unit circle, do the following:\n\n1. Define a principled procedure to compute a circular tuning curve $r(\\theta)$ using the occupancy histogram. Derive the bin-wise rate estimate by appropriate normalization and determine the bin(s) containing spikes given the bin centers and half-widths stated above. Report the nonzero bin rates.\n\n2. Define and compute the circular mean resultant vector based on the spike-associated angles $\\theta(t_i)$, derive the mean resultant length $R$, and the preferred direction angle $\\phi$.\n\n3. Using the Rayleigh test for circular non-uniformity, derive the test statistic $Z$ from first principles and compute its value. Use the large-sample approximation for the $p$-value $p \\approx e^{-Z}$, and state whether the neuron qualifies as an HD cell at significance level $\\alpha = 0.01$.\n\nWhich option correctly specifies both the method and the numerical outcomes for this dataset?\n\nA. Compute the tuning curve by dividing spike counts per angle bin by the corresponding occupancy time per bin, yielding $r(90^\\circ) = \\frac{10}{30} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\,\\mathrm{s}^{-1}$ with all other bins equal to $0$. Compute the circular mean resultant length using the spike-associated angles: $R \\approx 0.666$, preferred direction $\\phi \\approx 90^\\circ$, Rayleigh test statistic $Z = N R^2 \\approx 5.33$, and $p \\approx e^{-Z} \\approx 0.0048 < 0.01$, concluding the neuron is an HD cell.\n\nB. Compute the tuning curve by dividing spike counts per bin by the total duration $T$, yielding $r(90^\\circ) = \\frac{10}{240} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{240} \\,\\mathrm{s}^{-1}$. For the Rayleigh test, use the entire $\\theta(t)$ time series to compute $R$ and $Z$, which are near $0$ if occupancy is uniform; conclude the neuron is not an HD cell.\n\nC. Compute the tuning curve with occupancy normalization as in A, but for the Rayleigh test, replace the spike angles with bin centers weighted by the bin rates to estimate $R$ and $\\phi$, obtaining $R \\approx 1$ and $p \\approx 0$ because the rates are concentrated in a single bin; conclude the neuron is an HD cell.\n\nD. Compute the tuning curve without occupancy normalization but smooth counts with a von Mises kernel; for statistics, apply a linear normality test on the spike angles (e.g., a Shapiro–Wilk test) and accept the HD hypothesis if the angles deviate from normality on the real line; conclude the neuron is an HD cell if the test rejects normality at $\\alpha = 0.01$.",
            "solution": "The problem statement is evaluated as scientifically sound, well-posed, and objective. All necessary data are provided, and the requested tasks are standard procedures in computational neuroscience for analyzing head-direction (HD) cell activity. The data are internally consistent, as the sum of occupancy times across all bins ($8 \\text{ bins} \\times 30 \\text{ s/bin} = 240 \\text{ s}$) equals the total recording duration $T = 240 \\text{ s}$. Therefore, I will proceed with the full derivation and evaluation.\n\nThe goal is to determine if a neuron is an HD cell by constructing its tuning curve and performing a statistical test for directional preference. This involves three main steps as outlined in the problem.\n\n### 1. Tuning Curve Construction\n\nA firing rate tuning curve, $r(\\theta)$, quantifies a neuron's average firing rate as a function of a stimulus variable, here the head direction angle $\\theta$. The principled procedure for computing a binned tuning curve is to divide the number of spikes observed in each bin by the total time the animal spent in the angular range of that bin (the occupancy time).\n\nThe occupancy histogram consists of $8$ equal-width bins. The bin centers are given as $\\{0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ\\}$, and the bin half-width is $22.5^\\circ$. This means, for example, the bin centered at $90^\\circ$ spans the angular range $[90^\\circ - 22.5^\\circ, 90^\\circ + 22.5^\\circ) = [67.5^\\circ, 112.5^\\circ)$. The occupancy time for each bin is given as $30 \\text{ s}$.\n\nThe spike-associated angles are given as $\\theta(t_i) \\in \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}$. We must first count how many spikes fall into each angular bin.\n\n-   **Bin centered at $90^\\circ$ (range $[67.5^\\circ, 112.5^\\circ)$):**\n    The angles $\\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ\\}$ all fall within this range. The total count is $10$ spikes.\n\n-   **Bin centered at $270^\\circ$ (range $[247.5^\\circ, 292.5^\\circ)$):**\n    The angles $\\{270^\\circ, 270^\\circ\\}$ fall within this range. The total count is $2$ spikes.\n\n-   **All other bins:**\n    No spikes fall into the other $6$ bins. The total number of spikes is $10 + 2 = 12$, which matches the given data.\n\nThe firing rate for each bin, $r_j$, is the spike count in that bin, $n_j$, divided by the occupancy time for that bin, $\\tau_j$.\n$$\nr_j = \\frac{n_j}{\\tau_j}\n$$\nThe non-zero bin rates are:\n-   For the bin centered at $90^\\circ$:\n    $$\n    r(90^\\circ) = \\frac{10 \\text{ spikes}}{30 \\text{ s}} = \\frac{1}{3} \\text{ s}^{-1} \\approx 0.333 \\text{ s}^{-1}\n    $$\n-   For the bin centered at $270^\\circ$:\n    $$\n    r(270^\\circ) = \\frac{2 \\text{ spikes}}{30 \\text{ s}} = \\frac{1}{15} \\text{ s}^{-1} \\approx 0.067 \\text{ s}^{-1}\n    $$\nAll other bins have a firing rate of $0 \\text{ s}^{-1}$.\n\n### 2. Circular Mean Resultant Vector\n\nTo quantify the directional preference from the raw spike angles, we use circular statistics. Each of the $N=12$ spike angles, $\\theta_i$, is treated as a vector of unit length on a circle. The mean resultant vector is the vector average of these individual vectors. The components of this mean vector are:\n$$\n\\bar{C} = \\frac{1}{N} \\sum_{i=1}^N \\cos(\\theta_i) \\quad \\text{and} \\quad \\bar{S} = \\frac{1}{N} \\sum_{i=1}^N \\sin(\\theta_i)\n$$\nThe mean resultant length, $R$, is the magnitude of this mean vector:\n$$\nR = \\sqrt{\\bar{C}^2 + \\bar{S}^2}\n$$\nThe preferred direction, $\\phi$, is the angle of the mean vector:\n$$\n\\phi = \\text{atan2}(\\bar{S}, \\bar{C})\n$$\nUsing the given $N=12$ spike angles (converted to radians for computation, or using a calculator in degree mode):\n$\\{\\theta_i\\} = \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}$.\n\nFirst, we compute the sums $C = \\sum_{i=1}^{12} \\cos(\\theta_i)$ and $S = \\sum_{i=1}^{12} \\sin(\\theta_i)$.\n$$\nC = \\cos(87^\\circ) + \\cos(88^\\circ) + \\cos(89^\\circ) + 3\\cos(90^\\circ) + \\cos(91^\\circ) + \\cos(92^\\circ) + \\cos(93^\\circ) + \\cos(94^\\circ) + 2\\cos(270^\\circ)\n$$\n$$\nC \\approx 0.0523 + 0.0349 + 0.0175 + 3(0) - 0.0175 - 0.0349 - 0.0523 - 0.0698 + 2(0) = -0.0698\n$$\n$$\nS = \\sin(87^\\circ) + \\sin(88^\\circ) + \\sin(89^\\circ) + 3\\sin(90^\\circ) + \\sin(91^\\circ) + \\sin(92^\\circ) + \\sin(93^\\circ) + \\sin(94^\\circ) + 2\\sin(270^\\circ)\n$$\n$$\nS \\approx 0.9986 + 0.9994 + 0.9998 + 3(1) + 0.9998 + 0.9994 + 0.9986 + 0.9976 + 2(-1)\n$$\n$$\nS \\approx 2(0.9986 + 0.9994 + 0.9998) + 3 + 0.9976 - 2 \\approx 5.9956 + 1 + 0.9976 = 7.9932\n$$\nNow we find the average components:\n$$\n\\bar{C} = \\frac{-0.0698}{12} \\approx -0.0058 \\quad \\text{and} \\quad \\bar{S} = \\frac{7.9932}{12} \\approx 0.6661\n$$\nThe mean resultant length $R$ is:\n$$\nR = \\sqrt{(-0.0058)^2 + (0.6661)^2} \\approx \\sqrt{0.000034 + 0.443689} = \\sqrt{0.443723} \\approx 0.666\n$$\nThe preferred direction $\\phi$ is:\n$$\n\\phi = \\text{atan2}(0.6661, -0.0058)\n$$\nSince $\\bar{S} > 0$ and $\\bar{C} < 0$, the angle is in the second quadrant. In degrees, this is $\\approx 90.5^\\circ$. Thus, the preferred direction is approximately $90^\\circ$.\n\n### 3. Rayleigh Test for Circular Non-uniformity\n\nThe Rayleigh test determines if a set of circular data points are uniformly distributed. The null hypothesis, $H_0$, is that the angles are drawn from a uniform distribution. A strong directional preference (i.e., clustering of angles) will lead to the rejection of $H_0$.\n\nThe test statistic, $Z$, is derived from the number of samples, $N$, and the mean resultant length, $R$.\n$$\nZ = N R^2\n$$\nA large value of $Z$ indicates strong clustering. For large $N$, the p-value, which is the probability of observing a test statistic at least as extreme as $Z$ under the null hypothesis, is approximated by:\n$$\np \\approx e^{-Z}\n$$\nUsing our computed values:\n-   $N=12$\n-   $R \\approx 0.666$\nThe test statistic is:\n$$\nZ = 12 \\times (0.666)^2 \\approx 12 \\times 0.443556 \\approx 5.32\n$$\nUsing the value $R \\approx 0.66613$ from the more precise calculation above, $Z \\approx 5.3248$, which we can round to $5.33$.\n\nThe approximate p-value is:\n$$\np \\approx e^{-5.33} \\approx 0.00484\n$$\nWith a significance level of $\\alpha = 0.01$, we compare the p-value to $\\alpha$.\nSince $p \\approx 0.0048 < 0.01$, we reject the null hypothesis of uniformity. The firing of the neuron is significantly non-uniform with respect to head direction. This is the defining characteristic of a head-direction cell.\n\n### Evaluation of Options\n\n**A. Compute the tuning curve by dividing spike counts per angle bin by the corresponding occupancy time per bin, yielding $r(90^\\circ) = \\frac{10}{30} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\,\\mathrm{s}^{-1}$ with all other bins equal to $0$. Compute the circular mean resultant length using the spike-associated angles: $R \\approx 0.666$, preferred direction $\\phi \\approx 90^\\circ$, Rayleigh test statistic $Z = N R^2 \\approx 5.33$, and $p \\approx e^{-Z} \\approx 0.0048 < 0.01$, concluding the neuron is an HD cell.**\n\n-   **Analysis**: This option correctly describes the principled method for computing the tuning curve, and the reported rates $r(90^\\circ) = \\frac{10}{30} \\text{ s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\text{ s}^{-1}$ match our derivation. It correctly states that the Rayleigh test should be performed on the spike-associated angles. The calculated values for $R \\approx 0.666$, $\\phi \\approx 90^\\circ$, $Z \\approx 5.33$, and $p \\approx 0.0048$ are all consistent with our derivation. The conclusion that the neuron is an HD cell because $p < 0.01$ is also correct.\n-   **Verdict**: **Correct**.\n\n**B. Compute the tuning curve by dividing spike counts per bin by the total duration $T$, yielding $r(90^\\circ) = \\frac{10}{240} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{240} \\,\\mathrm{s}^{-1}$. For the Rayleigh test, use the entire $\\theta(t)$ time series to compute $R$ and $Z$, which are near $0$ if occupancy is uniform; conclude the neuron is not an HD cell.**\n\n-   **Analysis**: This option employs an incorrect method for computing the firing rate; it fails to normalize by the occupancy time per bin, using the total recording time $T$ instead. Furthermore, it proposes applying the Rayleigh test to the set of all sampled head angles $\\theta(t)$, not the angles at which spikes occurred. This is a fundamental misunderstanding of the test's purpose, which is to assess clustering of spikes.\n-   **Verdict**: **Incorrect**.\n\n**C. Compute the tuning curve with occupancy normalization as in A, but for the Rayleigh test, replace the spike angles with bin centers weighted by the bin rates to estimate $R$ and $\\phi$, obtaining $R \\approx 1$ and $p \\approx 0$ because the rates are concentrated in a single bin; conclude the neuron is an HD cell.**\n\n-   **Analysis**: While the initial tuning curve method is correct, the proposed method for the Rayleigh test is non-standard and leads to incorrect results. Applying the test to binned data (e.g., $10$ points at $90^\\circ$ and $2$ points at $270^\\circ$) would give $R = \\frac{8}{12} = \\frac{2}{3} \\approx 0.667$, which is not approximately $1$. The claim $R \\approx 1$ is false, as is the premise that \"rates are concentrated in a single bin\" (they are in two bins).\n-   **Verdict**: **Incorrect**.\n\n**D. Compute the tuning curve without occupancy normalization but smooth counts with a von Mises kernel; for statistics, apply a linear normality test on the spike angles (e.g., a Shapiro–Wilk test) and accept the HD hypothesis if the angles deviate from normality on the real line; conclude the neuron is an HD cell if the test rejects normality at $\\alpha = 0.01$.**\n\n-   **Analysis**: This option proposes several incorrect procedures. It omits the critical step of occupancy normalization. More significantly, it suggests using a linear statistical test (Shapiro-Wilk for normality) on a circular variable, which is mathematically invalid. Directional data requires circular statistics.\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A robust head-direction system must maintain an accurate internal estimate of heading by integrating self-motion cues (path integration) with stable external landmarks. This practice explores the dynamics of this crucial integration process through a concise mathematical model. You will analyze how the internal HD signal settles into a stable state under the competing influences of a persistent internal drift and a corrective signal from a visual landmark, revealing the conditions under which the brain's internal compass can remain anchored to the real world .",
            "id": "3987268",
            "problem": "Consider a canonical one-dimensional continuous-attractor model of head-direction (HD) cells in which the internal orientation phase $\\theta(t)$ on the circle. The internal phase integrates angular velocity from the vestibular system and is subject to a constant vestibular bias $\\delta \\in \\mathbb{R}$ that causes drift. A static visual landmark (VL) at absolute angle $\\theta_{\\mathrm{VL}}$ exerts an aligning input on the HD network that is odd in the phase difference, smooth, and $2\\pi$-periodic, with a stable minimum when the internal phase matches the landmark. In ring-attractor realizations, this alignment can be modeled by the lowest-order sinusoidal term consistent with rotational symmetry, yielding a restoring torque proportional to $-k\\sin(\\theta-\\theta_{\\mathrm{VL}})$, where $k>0$ quantifies the strength of landmark anchoring.\n\nAssume the VL is fixed in the world, so $\\theta_{\\mathrm{VL}}$ is constant, and the vestibular angular velocity is zero-mean over long times so that only the constant bias $\\delta$ persists. Define the phase offset $\\Delta(t)=\\theta(t)-\\theta_{\\mathrm{VL}}$. Starting from first principles of phase dynamics on the circle and the symmetry-constrained sinusoidal anchoring term described above, derive the scalar dynamical equation for $\\Delta(t)$ and obtain the steady-state phase offset(s) $\\Delta^{\\ast}$ that satisfy the equilibrium condition. Analyze the local stability of the equilibria using linearization and determine which equilibrium is locally asymptotically stable when equilibria exist. Discuss the existence condition for equilibria in terms of $\\delta$ and $k$.\n\nProvide your final expression for the stable steady-state phase offset as a single closed-form analytic expression in radians. Do not approximate or round; report the principal value that corresponds to the locally asymptotically stable equilibrium near $\\Delta=0$ when it exists.",
            "solution": "The problem asks for an analysis of the dynamics of a head-direction (HD) cell system's internal orientation phase, $\\theta(t)$. The dynamics are governed by two competing influences: an intrinsic drift due to a constant vestibular bias, $\\delta$, and a restoring influence from a static visual landmark (VL) at a fixed angle $\\theta_{\\mathrm{VL}}$.\n\nFirst, we formulate the dynamical equation for the internal phase $\\theta(t)$. The rate of change of the phase, $\\frac{d\\theta}{dt}$, is the net angular velocity. This net velocity is the sum of the velocity from the vestibular bias and the velocity induced by the landmark's restoring torque.\nThe vestibular system contributes a constant angular velocity, $\\delta$.\nThe visual landmark exerts a restoring torque specified as being proportional to $-k\\sin(\\theta - \\theta_{\\mathrm{VL}})$, where $k > 0$ is the strength of the landmark's influence. In this model of phase dynamics, this torque corresponds directly to an angular velocity term. Therefore, the landmark contributes an angular velocity of $-k\\sin(\\theta(t) - \\theta_{\\mathrm{VL}})$.\n\nCombining these two contributions, the dynamics of the internal phase $\\theta(t)$ are described by the first-order ordinary differential equation:\n$$\n\\frac{d\\theta}{dt} = \\delta - k\\sin(\\theta(t) - \\theta_{\\mathrm{VL}})\n$$\n\nThe problem requires an analysis of the phase offset, defined as $\\Delta(t) = \\theta(t) - \\theta_{\\mathrm{VL}}$. We derive the dynamical equation for $\\Delta(t)$ by differentiating this definition with respect to time $t$:\n$$\n\\frac{d\\Delta}{dt} = \\frac{d}{dt}\\left(\\theta(t) - \\theta_{\\mathrm{VL}}\\right) = \\frac{d\\theta}{dt} - \\frac{d\\theta_{\\mathrm{VL}}}{dt}\n$$\nSince the visual landmark is static, its angle $\\theta_{\\mathrm{VL}}$ is constant, which means $\\frac{d\\theta_{\\mathrm{VL}}}{dt} = 0$. Therefore, $\\frac{d\\Delta}{dt} = \\frac{d\\theta}{dt}$.\nSubstituting $\\theta(t) - \\theta_{\\mathrm{VL}} = \\Delta(t)$ into the equation for $\\frac{d\\theta}{dt}$, we obtain the scalar dynamical equation for the phase offset $\\Delta(t)$:\n$$\n\\frac{d\\Delta}{dt} = \\delta - k\\sin(\\Delta(t))\n$$\nThis equation is a form of the Adler equation, which describes phase locking.\n\nNext, we identify the steady-state phase offsets, denoted $\\Delta^{\\ast}$, by finding the equilibria of the system. The equilibrium condition is $\\frac{d\\Delta}{dt} = 0$.\n$$\n\\delta - k\\sin(\\Delta^{\\ast}) = 0\n$$\nRearranging for $\\sin(\\Delta^{\\ast})$, we get:\n$$\n\\sin(\\Delta^{\\ast}) = \\frac{\\delta}{k}\n$$\n\nFor a real-valued solution $\\Delta^{\\ast}$ to exist, the value of $\\sin(\\Delta^{\\ast})$ must be within the range $[-1, 1]$. This imposes a condition on the parameters $\\delta$ and $k$:\n$$\n-1 \\le \\frac{\\delta}{k} \\le 1\n$$\nSince $k > 0$ is given, this is equivalent to $|\\delta| \\le k$.\nIf $|\\delta| > k$, $\\left|\\frac{\\delta}{k}\\right| > 1$, and there are no real solutions for $\\Delta^{\\ast}$. In this regime, the system does not settle into an equilibrium; instead, it undergoes phase slipping, where $\\Delta(t)$ continuously increases or decreases. If $\\delta > k$, then $\\frac{d\\Delta}{dt} > 0$ for all $\\Delta$, and if $\\delta  -k$, then $\\frac{d\\Delta}{dt}  0$ for all $\\Delta$.\n\nAssuming the existence condition $|\\delta| \\le k$ is met, there are two families of equilibrium points within each $2\\pi$ interval. The principal solutions are:\n$$\n\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)\n$$\n$$\n\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right)\n$$\n\nTo determine the local stability of these equilibria, we perform a linear stability analysis. Let the right-hand side of the dynamical equation be $f(\\Delta) = \\delta - k\\sin(\\Delta)$. An equilibrium $\\Delta^{\\ast}$ is locally asymptotically stable if the derivative $f'(\\Delta^{\\ast})  0$ and unstable if $f'(\\Delta^{\\ast}) > 0$.\nThe derivative of $f(\\Delta)$ is:\n$$\nf'(\\Delta) = \\frac{d}{d\\Delta}\\left(\\delta - k\\sin(\\Delta)\\right) = -k\\cos(\\Delta)\n$$\nWe evaluate this derivative at each of the two principal equilibria for the case where $|\\delta|  k$, which ensures the equilibria are distinct.\n\nFor the first equilibrium, $\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)$:\nBy definition of the principal value of the $\\arcsin$ function, $-\\frac{\\pi}{2} \\le \\Delta^{\\ast}_1 \\le \\frac{\\pi}{2}$. In this interval, $\\cos(\\Delta^{\\ast}_1) \\ge 0$. For $|\\frac{\\delta}{k}|  1$, we have $-\\frac{\\pi}{2}  \\Delta^{\\ast}_1  \\frac{\\pi}{2}$, which implies $\\cos(\\Delta^{\\ast}_1) > 0$.\nThe stability is determined by the sign of $f'(\\Delta^{\\ast}_1)$:\n$$\nf'(\\Delta^{\\ast}_1) = -k\\cos(\\Delta^{\\ast}_1)\n$$\nSince $k > 0$ and $\\cos(\\Delta^{\\ast}_1) > 0$, we have $f'(\\Delta^{\\ast}_1)  0$. Therefore, the equilibrium $\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)$ is locally asymptotically stable. This equilibrium is near $\\Delta = 0$ for small $|\\delta|$.\n\nFor the second equilibrium, $\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right) = \\pi - \\Delta^{\\ast}_1$:\nWe evaluate the cosine of this angle:\n$$\n\\cos(\\Delta^{\\ast}_2) = \\cos(\\pi - \\Delta^{\\ast}_1) = -\\cos(\\Delta^{\\ast}_1)\n$$\nSince $\\cos(\\Delta^{\\ast}_1) > 0$ for $|\\frac{\\delta}{k}|  1$, we have $\\cos(\\Delta^{\\ast}_2)  0$.\nThe stability is determined by the sign of $f'(\\Delta^{\\ast}_2)$:\n$$\nf'(\\Delta^{\\ast}_2) = -k\\cos(\\Delta^{\\ast}_2) = -k(-\\cos(\\Delta^{\\ast}_1)) = k\\cos(\\Delta^{\\ast}_1)\n$$\nSince $k > 0$ and $\\cos(\\Delta^{\\ast}_1) > 0$, we have $f'(\\Delta^{\\ast}_2) > 0$. Therefore, the equilibrium $\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right)$ is unstable.\n\nThe problem asks for the stable steady-state phase offset, which corresponds to $\\Delta^{\\ast}_1$. This solution represents a stable balance between the vestibular drift $\\delta$ and the landmark's anchoring pull $k$. The system settles at a non-zero offset from the landmark's true direction, with the magnitude of the offset depending on the ratio of the drift to the anchoring strength.\n\nThe final expression for the locally asymptotically stable steady-state phase offset is the principal value given by $\\arcsin\\left(\\frac{\\delta}{k}\\right)$.",
            "answer": "$$\\boxed{\\arcsin\\left(\\frac{\\delta}{k}\\right)}$$"
        },
        {
            "introduction": "Beyond simply representing direction, the HD system must be able to learn and adapt, ensuring its internal compass is correctly calibrated with the external environment. This advanced practice delves into the principles of neural learning by tasking you with designing and simulating a calibration mechanism. You will derive a learning rule based on gradient optimization to align the internal HD estimate with a visual landmark, analyze its stability, and implement a simulation to see how a subtle but critical change in the learning objective determines whether the system converges to perfect alignment or maximal error .",
            "id": "3987197",
            "problem": "Consider a ring-attractor model of Head-Direction (HD) cells in which the internal HD estimate $\\theta_{\\text{HD}}$ must be calibrated against a stable Visual Landmark (VL) orientation $\\theta_{\\text{VL}}$. Let there be a single scalar offset parameter $\\phi$ that linearly transforms the internal estimate into the visual frame, so that the instantaneous alignment error is defined on the circle as $\\Delta = \\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi$, with angles represented modulo $2\\pi$ radians. Suppose we are given a differentiable objective (called a loss here) $L(\\phi) = \\cos(\\Delta)$ and we update $\\phi$ by discrete-time gradient descent on $L$, with learning rate $\\eta  0$ and time step $t \\in \\{0,1,2,\\dots\\}$. The gradient descent update follows the rule $\\phi_{t+1} = \\phi_t - \\eta \\,\\partial L/\\partial \\phi\\vert_{\\phi_t}$. This setup is commonly used to design calibration rules between sensory frames in computational neuroscience. \n\nStarting from the fundamental base of circular variable arithmetic on the one-dimensional torus (the unit circle) and the definition of gradient descent as steepest descent on a differentiable objective, do the following:\n- Derive the gradient with respect to $\\phi$ for the objective $L(\\phi) = \\cos(\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi)$, carefully applying the chain rule. Then write down the explicit discrete-time update for $\\phi$. Define the angle wrap operator $W(x)$ that maps any $x \\in \\mathbb{R}$ into the principal value interval $[-\\pi,\\pi)$, and express the error $\\Delta_t$ in terms of $W$ at each step.\n- Perform a local stability analysis of the fixed points for the $\\Delta$-dynamics induced by the $\\phi$ update, focusing on the neighborhoods of $\\Delta = 0$ and $\\Delta = \\pi$. Use first-order linearization in $\\Delta$ and provide the condition on the learning rate $\\eta$ for stability in each neighborhood.\n- Based on your analysis, propose a corrected update rule for $\\phi$ that provably aligns the internal HD estimate to the VL reference (i.e., drives $\\Delta_t \\to 0$), while remaining within the same optimization framework. Your corrected rule must be expressible as a simple sign change relative to the naive gradient descent step derived from $L(\\phi) = \\cos(\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi)$, and it must preserve angle wrapping via $W(\\cdot)$ at every iteration.\n- Design an algorithm that simulates the online calibration of $\\phi$ under both the naive gradient descent update and your corrected update. The HD angle may be static or time-varying according to a constant angular velocity $\\omega$ in radians per second. At each time step, propagate $\\theta_{\\text{HD},t+1} = \\theta_{\\text{HD},t} + \\omega \\, \\Delta t$ and update $\\phi$ using the chosen rule. You must keep all angles wrapped via $W(\\cdot)$ when computing the error. The final metric to report for a given simulation is the absolute value of the wrapped error $|\\Delta_N|$ after $N$ steps.\n- Implement the algorithm as a complete runnable program that takes no input, runs four predefined test cases, and prints a single line containing the results for all test cases. Each test case must report a pair of floating-point values in radians: the final $|\\Delta_N|$ for the naive gradient descent on $L(\\phi) = \\cos(\\cdot)$, and the final $|\\Delta_N|$ for the corrected update. The pairs must be rounded to six decimal places and printed as a list of lists on one line, in the format $[[x_{11},x_{12}],[x_{21},x_{22}],[x_{31},x_{32}],[x_{41},x_{42}]]$.\n\nUse the following scientifically plausible test suite, expressed in radians and seconds:\n- Case $1$ (static, exact alignment boundary): $\\theta_{\\text{VL}} = 1.0$, $\\theta_{\\text{HD},0} = 1.0$, $\\phi_0 = 0.0$, $\\eta = 0.05$, $N = 200$, $\\omega = 0.0$, $\\Delta t = 0.01$.\n- Case $2$ (static, small mismatch): $\\theta_{\\text{VL}} = 1.20$, $\\theta_{\\text{HD},0} = 1.05$, $\\phi_0 = 0.0$, $\\eta = 0.05$, $N = 400$, $\\omega = 0.0$, $\\Delta t = 0.01$.\n- Case $3$ (static, near $\\pi$ boundary): $\\theta_{\\text{VL}} = 0.0$, $\\theta_{\\text{HD},0} = 0.0$, $\\phi_0 = -\\pi + 0.001$, $\\eta = 0.05$, $N = 800$, $\\omega = 0.0$, $\\Delta t = 0.01$.\n- Case $4$ (dynamic HD rotation): $\\theta_{\\text{VL}} = 0.0$, $\\theta_{\\text{HD},0} = 0.0$, $\\phi_0 = 0.5$, $\\eta = 0.05$, $N = 2000$, $\\omega = 0.2$, $\\Delta t = 0.01$.\n\nAngle units must be in radians. Time units must be in seconds. Your program should produce a single line of output containing the results as a comma-separated list of four pairs, each pair being the naive and corrected final errors in radians, rounded to six decimal places, enclosed in square brackets, for example $[[x_{11},x_{12}],[x_{21},x_{22}],[x_{31},x_{32}],[x_{41},x_{42}]]$.",
            "solution": "The problem requires an analysis, correction, and simulation of a learning rule for calibrating a neural head-direction (HD) system. The process involves deriving an update rule via gradient descent, analyzing its stability, proposing a corrected rule, and simulating both to compare their performance.\n\nFirst, we derive the gradient of the specified objective function, $L(\\phi) = \\cos(\\Delta)$, where the alignment error is $\\Delta = \\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi$. All angles are defined on the circle, i.e., modulo $2\\pi$. The gradient of $L$ with respect to the calibration parameter $\\phi$ is found using the chain rule:\n$$\n\\frac{\\partial L}{\\partial \\phi} = \\frac{\\partial L}{\\partial \\Delta} \\frac{\\partial \\Delta}{\\partial \\phi}\n$$\nThe derivative of the loss with respect to the error is:\n$$\n\\frac{\\partial L}{\\partial \\Delta} = \\frac{\\partial}{\\partial \\Delta} \\cos(\\Delta) = -\\sin(\\Delta)\n$$\nThe derivative of the error with respect to the parameter $\\phi$ is:\n$$\n\\frac{\\partial \\Delta}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} (\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi) = -1\n$$\nCombining these, the gradient is:\n$$\n\\frac{\\partial L}{\\partial \\phi} = (-\\sin(\\Delta)) \\cdot (-1) = \\sin(\\Delta)\n$$\nThe problem specifies a discrete-time gradient descent update rule, $\\phi_{t+1} = \\phi_t - \\eta \\, \\partial L/\\partial \\phi |_{\\phi_t}$, with learning rate $\\eta  0$. Substituting the derived gradient, we obtain the \"naive\" update rule:\n$$\n\\phi_{t+1} = \\phi_t - \\eta \\sin(\\Delta_t)\n$$\nFor all calculations, angles must be handled on the circle. We define a wrapping operator $W(x)$ that maps any real number $x$ to the principal value interval $[-\\pi, \\pi)$. A robust implementation is $W(x) = \\text{arctan2}(\\sin(x), \\cos(x))$. The instantaneous error at time step $t$ is thus properly computed as:\n$$\n\\Delta_t = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD},t} - \\phi_t)\n$$\n\nNext, we perform a local stability analysis of the fixed points of the error dynamics. Let's consider the static case where the HD angle is constant, i.e., $\\omega = 0$ and $\\theta_{\\text{HD},t} = \\theta_{\\text{HD}}$ for all $t$. The error dynamics are given by:\n$$\n\\Delta_{t+1} = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi_{t+1}) = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - (\\phi_t - \\eta \\sin(\\Delta_t)))\n$$\nRecognizing that $\\theta_{\\text{VL}} - \\theta_{\\text{HD}} - \\phi_t$ is equivalent to $\\Delta_t$ (before wrapping), we can write the mapping for $\\Delta$ as $f(\\Delta_t) = \\Delta_{t+1}$. For small $\\eta$, we can locally approximate this by ignoring the outer wrap:\n$$\n\\Delta_{t+1} \\approx \\Delta_t + \\eta \\sin(\\Delta_t)\n$$\nLet this mapping be $f(\\Delta) = \\Delta + \\eta \\sin(\\Delta)$. Fixed points $\\Delta^*$ satisfy $\\Delta^* = f(\\Delta^*)$, which implies $\\eta \\sin(\\Delta^*) = 0$. For $\\eta>0$, the fixed points occur at $\\Delta^* = k\\pi$ for any integer $k$. Within the interval $[-\\pi, \\pi)$, the distinct fixed points are $\\Delta^*=0$ (perfect alignment) and $\\Delta^*=\\pi$ (or $-\\pi$, perfect misalignment).\n\nStability is determined by the magnitude of the derivative of the map at the fixed point. If $|f'(\\Delta^*)|  1$, the fixed point is stable.\n$$\nf'(\\Delta) = \\frac{d}{d\\Delta} (\\Delta + \\eta \\sin(\\Delta)) = 1 + \\eta \\cos(\\Delta)\n$$\nAt $\\Delta^* = 0$:\n$f'(0) = 1 + \\eta \\cos(0) = 1 + \\eta$. Since $\\eta > 0$, $|f'(0)| > 1$, so the fixed point at $\\Delta = 0$ is **unstable**. This means that gradient descent on $L(\\phi) = \\cos(\\Delta)$ actively pushes the system away from the desired state of perfect alignment, as it seeks to minimize the objective function, and $L(\\phi)$ is maximal at $\\Delta=0$.\n\nAt $\\Delta^* = \\pi$:\n$f'(\\pi) = 1 + \\eta \\cos(\\pi) = 1 - \\eta$. For stability, we require $|1 - \\eta|  1$, which is equivalent to $-1  1 - \\eta  1$. This simplifies to $0  \\eta  2$. Under this condition on the learning rate, the fixed point at $\\Delta = \\pi$ is **stable**. The naive update rule therefore incorrectly causes the system to converge to a state of maximal misalignment.\n\nTo correct this, the objective should be to maximize $L(\\phi) = \\cos(\\Delta)$, not minimize it. This is achieved by performing gradient ascent, or equivalently, by performing gradient descent on the negative of the loss function, $L_{\\text{corr}}(\\phi) = -L(\\phi) = -\\cos(\\Delta)$. The gradient ascent update rule is:\n$$\n\\phi_{t+1} = \\phi_t + \\eta \\frac{\\partial L}{\\partial \\phi} = \\phi_t + \\eta \\sin(\\Delta_t)\n$$\nThis corrected rule differs from the naive rule by a \"simple sign change\" on the update step. Let's analyze its stability. The new error mapping is $g(\\Delta) = \\Delta - \\eta \\sin(\\Delta)$. The derivative is:\n$$\ng'(\\Delta) = 1 - \\eta \\cos(\\Delta)\n$$\nAt $\\Delta^* = 0$:\n$g'(0) = 1 - \\eta \\cos(0) = 1 - \\eta$. The fixed point is stable if $|1 - \\eta|  1$, which again yields the condition $0  \\eta  2$.\n\nAt $\\Delta^* = \\pi$:\n$g'(\\pi) = 1 - \\eta \\cos(\\pi) = 1 + \\eta$. Since $\\eta > 0$, $|g'(\\pi)| > 1$, and the fixed point at $\\Delta = \\pi$ is now **unstable**.\nThe corrected update rule thus successfully drives the alignment error $\\Delta_t$ towards $0$, achieving the desired calibration, provided the learning rate is chosen appropriately (e.g., $\\eta=0.05$ as given is well within the stable range).\n\nThe algorithm to simulate this process is as follows. We will simulate both the naive and corrected rules in parallel for each test case.\n1.  Define a wrapping function $W(x) = \\text{arctan2}(\\sin(x), \\cos(x))$ to constrain angles to $[-\\pi, \\pi)$.\n2.  For each test case, initialize the state variables: $\\theta_{\\text{HD},0}$, $\\phi_0^{\\text{naive}}$, and $\\phi_0^{\\text{corr}}$. The head direction angle $\\theta_{\\text{HD}}$ evolves identically for both scenarios.\n3.  Iterate for $N$ time-steps (from $t=0$ to $N-1$):\n    a. Update the head-direction angle: $\\theta_{\\text{HD},t+1} = W(\\theta_{\\text{HD},t} + \\omega \\Delta t)$.\n    b. For the naive rule:\n        i. Compute the error: $\\Delta_t^{\\text{naive}} = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD},t} - \\phi_t^{\\text{naive}})$.\n        ii. Update the offset: $\\phi_{t+1}^{\\text{naive}} = W(\\phi_t^{\\text{naive}} - \\eta \\sin(\\Delta_t^{\\text{naive}}))$.\n    c. For the corrected rule:\n        i. Compute the error: $\\Delta_t^{\\text{corr}} = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD},t} - \\phi_t^{\\text{corr}})$.\n        ii. Update the offset: $\\phi_{t+1}^{\\text{corr}} = W(\\phi_t^{\\text{corr}} + \\eta \\sin(\\Delta_t^{\\text{corr}}))$.\n4. After $N$ steps, compute the final errors for both rules using the final states $\\theta_{\\text{HD},N}$, $\\phi_N^{\\text{naive}}$, and $\\phi_N^{\\text{corr}}$:\n   $$\n   \\Delta_N^{\\text{naive}} = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD},N} - \\phi_N^{\\text{naive}})\n   $$\n   $$\n   \\Delta_N^{\\text{corr}} = W(\\theta_{\\text{VL}} - \\theta_{\\text{HD},N} - \\phi_N^{\\text{corr}})\n   $$\n5. The final reported metric for each rule is the absolute value of its final wrapped error, $|\\Delta_N|$.\nA Python program implementing this simulation for the four specified test cases will yield the final answer.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: static, exact alignment boundary\n        {'theta_VL': 1.0, 'theta_HD0': 1.0, 'phi0': 0.0, 'eta': 0.05, 'N': 200, 'omega': 0.0, 'dt': 0.01},\n        # Case 2: static, small mismatch\n        {'theta_VL': 1.20, 'theta_HD0': 1.05, 'phi0': 0.0, 'eta': 0.05, 'N': 400, 'omega': 0.0, 'dt': 0.01},\n        # Case 3: static, near pi boundary\n        {'theta_VL': 0.0, 'theta_HD0': 0.0, 'phi0': -np.pi + 0.001, 'eta': 0.05, 'N': 800, 'omega': 0.0, 'dt': 0.01},\n        # Case 4: dynamic HD rotation\n        {'theta_VL': 0.0, 'theta_HD0': 0.0, 'phi0': 0.5, 'eta': 0.05, 'N': 2000, 'omega': 0.2, 'dt': 0.01},\n    ]\n\n    results = []\n    for case in test_cases:\n        naive_error, corrected_error = run_simulation(case)\n        results.append(f\"[{naive_error:.6f},{corrected_error:.6f}]\")\n    \n    print(f\"[[{','.join(results)}]]\")\n\ndef wrap(angle):\n    \"\"\"\n    Wraps an angle in radians to the interval [-pi, pi).\n    \"\"\"\n    return np.arctan2(np.sin(angle), np.cos(angle))\n\ndef run_simulation(params):\n    \"\"\"\n    Runs the simulation for a single test case for both naive and corrected rules.\n\n    Args:\n        params (dict): A dictionary of simulation parameters.\n\n    Returns:\n        A tuple containing the final absolute wrapped error for the naive and\n        corrected update rules, respectively.\n    \"\"\"\n    theta_VL = params['theta_VL']\n    theta_HD = params['theta_HD0']\n    phi_naive = params['phi0']\n    phi_corr = params['phi0']\n    eta = params['eta']\n    N = params['N']\n    omega = params['omega']\n    dt = params['dt']\n\n    # Simulation loop\n    for _ in range(N):\n        # Naive update (gradient descent on cos(Delta))\n        delta_naive = wrap(theta_VL - theta_HD - phi_naive)\n        phi_naive = wrap(phi_naive - eta * np.sin(delta_naive))\n\n        # Corrected update (gradient ascent on cos(Delta))\n        delta_corr = wrap(theta_VL - theta_HD - phi_corr)\n        phi_corr = wrap(phi_corr + eta * np.sin(delta_corr))\n        \n        # Update HD angle (same for both scenarios)\n        theta_HD = wrap(theta_HD + omega * dt)\n\n    # Calculate final errors after N steps\n    final_delta_naive = wrap(theta_VL - theta_HD - phi_naive)\n    final_delta_corr = wrap(theta_VL - theta_HD - phi_corr)\n\n    return abs(final_delta_naive), abs(final_delta_corr)\n\nsolve()\n```"
        }
    ]
}