{
    "hands_on_practices": [
        {
            "introduction": "The defining feature of a head-direction (HD) cell is its selective firing for a specific head orientation. This first exercise guides you through the fundamental data analysis pipeline used in computational neuroscience to confirm this property from experimental data. By working with simulated spike times and head angles, you will learn how to construct an occupancy-normalized tuning curve and apply the Rayleigh test to statistically validate directional tuning .",
            "id": "3987266",
            "problem": "A single neuron is recorded while a freely moving animal rotates its head in a two-dimensional arena. The head direction angle is recorded as a function of time, denoted by $\\theta(t) \\in [0, 2\\pi)$, and spike times are denoted by $\\{t_i\\}_{i=1}^N$. The task is to determine whether this neuron is a Head Direction (HD) cell by constructing a circular tuning curve and applying a statistical test for directional non-uniformity. Use the following scenario.\n\nThe recording duration is $T = 240$ seconds. The head angle $\\theta(t)$ is well-sampled and the animal explores uniformly so that occupancy is approximately equal across angles. Construct an occupancy histogram with $8$ equal-width bins centered at angles $0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ$, with bin half-width $22.5^\\circ$. The measured occupancy time per bin is $30$ seconds.\n\nSimultaneously recorded spikes occur at times $\\{t_i\\}_{i=1}^{12}$ and the head angle at each spike time is given by:\n$$\n\\theta(t_i) \\in \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}.\n$$\n\nStarting only from the definitions of firing rate as spikes per unit time and the circular mean resultant vector for angles on the unit circle, do the following:\n\n1. Define a principled procedure to compute a circular tuning curve $r(\\theta)$ using the occupancy histogram. Derive the bin-wise rate estimate by appropriate normalization and determine the bin(s) containing spikes given the bin centers and half-widths stated above. Report the nonzero bin rates.\n\n2. Define and compute the circular mean resultant vector based on the spike-associated angles $\\theta(t_i)$, derive the mean resultant length $R$, and the preferred direction angle $\\phi$.\n\n3. Using the Rayleigh test for circular non-uniformity, derive the test statistic $Z$ from first principles and compute its value. Use the large-sample approximation for the $p$-value $p \\approx e^{-Z}$, and state whether the neuron qualifies as an HD cell at significance level $\\alpha = 0.01$.\n\nWhich option correctly specifies both the method and the numerical outcomes for this dataset?\n\nA. Compute the tuning curve by dividing spike counts per angle bin by the corresponding occupancy time per bin, yielding $r(90^\\circ) = \\frac{10}{30} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\,\\mathrm{s}^{-1}$ with all other bins equal to $0$. Compute the circular mean resultant length using the spike-associated angles: $R \\approx 0.666$, preferred direction $\\phi \\approx 90^\\circ$, Rayleigh test statistic $Z = N R^2 \\approx 5.33$, and $p \\approx e^{-Z} \\approx 0.0048  0.01$, concluding the neuron is an HD cell.\n\nB. Compute the tuning curve by dividing spike counts per bin by the total duration $T$, yielding $r(90^\\circ) = \\frac{10}{240} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{240} \\,\\mathrm{s}^{-1}$. For the Rayleigh test, use the entire $\\theta(t)$ time series to compute $R$ and $Z$, which are near $0$ if occupancy is uniform; conclude the neuron is not an HD cell.\n\nC. Compute the tuning curve with occupancy normalization as in A, but for the Rayleigh test, replace the spike angles with bin centers weighted by the bin rates to estimate $R$ and $\\phi$, obtaining $R \\approx 1$ and $p \\approx 0$ because the rates are concentrated in a single bin; conclude the neuron is an HD cell.\n\nD. Compute the tuning curve without occupancy normalization but smooth counts with a von Mises kernel; for statistics, apply a linear normality test on the spike angles (e.g., a Shapiro–Wilk test) and accept the HD hypothesis if the angles deviate from normality on the real line; conclude the neuron is an HD cell if the test rejects normality at $\\alpha = 0.01$.",
            "solution": "The problem statement is evaluated as scientifically sound, well-posed, and objective. All necessary data are provided, and the requested tasks are standard procedures in computational neuroscience for analyzing head-direction (HD) cell activity. The data are internally consistent, as the sum of occupancy times across all bins ($8 \\text{ bins} \\times 30 \\text{ s/bin} = 240 \\text{ s}$) equals the total recording duration $T = 240 \\text{ s}$. Therefore, I will proceed with the full derivation and evaluation.\n\nThe goal is to determine if a neuron is an HD cell by constructing its tuning curve and performing a statistical test for directional preference. This involves three main steps as outlined in the problem.\n\n### 1. Tuning Curve Construction\n\nA firing rate tuning curve, $r(\\theta)$, quantifies a neuron's average firing rate as a function of a stimulus variable, here the head direction angle $\\theta$. The principled procedure for computing a binned tuning curve is to divide the number of spikes observed in each bin by the total time the animal spent in the angular range of that bin (the occupancy time).\n\nThe occupancy histogram consists of $8$ equal-width bins. The bin centers are given as $\\{0^\\circ, 45^\\circ, 90^\\circ, 135^\\circ, 180^\\circ, 225^\\circ, 270^\\circ, 315^\\circ\\}$, and the bin half-width is $22.5^\\circ$. This means, for example, the bin centered at $90^\\circ$ spans the angular range $[90^\\circ - 22.5^\\circ, 90^\\circ + 22.5^\\circ) = [67.5^\\circ, 112.5^\\circ)$. The occupancy time for each bin is given as $30 \\text{ s}$.\n\nThe spike-associated angles are given as $\\theta(t_i) \\in \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}$. We must first count how many spikes fall into each angular bin.\n\n-   **Bin centered at $90^\\circ$ (range $[67.5^\\circ, 112.5^\\circ)$):**\n    The angles $\\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ\\}$ all fall within this range. The total count is $10$ spikes.\n\n-   **Bin centered at $270^\\circ$ (range $[247.5^\\circ, 292.5^\\circ)$):**\n    The angles $\\{270^\\circ, 270^\\circ\\}$ fall within this range. The total count is $2$ spikes.\n\n-   **All other bins:**\n    No spikes fall into the other $6$ bins. The total number of spikes is $10 + 2 = 12$, which matches the given data.\n\nThe firing rate for each bin, $r_j$, is the spike count in that bin, $n_j$, divided by the occupancy time for that bin, $\\tau_j$.\n$$\nr_j = \\frac{n_j}{\\tau_j}\n$$\nThe non-zero bin rates are:\n-   For the bin centered at $90^\\circ$:\n    $$\n    r(90^\\circ) = \\frac{10 \\text{ spikes}}{30 \\text{ s}} = \\frac{1}{3} \\text{ s}^{-1} \\approx 0.333 \\text{ s}^{-1}\n    $$\n-   For the bin centered at $270^\\circ$:\n    $$\n    r(270^\\circ) = \\frac{2 \\text{ spikes}}{30 \\text{ s}} = \\frac{1}{15} \\text{ s}^{-1} \\approx 0.067 \\text{ s}^{-1}\n    $$\nAll other bins have a firing rate of $0 \\text{ s}^{-1}$.\n\n### 2. Circular Mean Resultant Vector\n\nTo quantify the directional preference from the raw spike angles, we use circular statistics. Each of the $N=12$ spike angles, $\\theta_i$, is treated as a vector of unit length on a circle. The mean resultant vector is the vector average of these individual vectors. The components of this mean vector are:\n$$\n\\bar{C} = \\frac{1}{N} \\sum_{i=1}^N \\cos(\\theta_i) \\quad \\text{and} \\quad \\bar{S} = \\frac{1}{N} \\sum_{i=1}^N \\sin(\\theta_i)\n$$\nThe mean resultant length, $R$, is the magnitude of this mean vector:\n$$\nR = \\sqrt{\\bar{C}^2 + \\bar{S}^2}\n$$\nThe preferred direction, $\\phi$, is the angle of the mean vector:\n$$\n\\phi = \\text{atan2}(\\bar{S}, \\bar{C})\n$$\nUsing the given $N=12$ spike angles (converted to radians for computation, or using a calculator in degree mode):\n$\\{\\theta_i\\} = \\{90^\\circ, 92^\\circ, 88^\\circ, 91^\\circ, 89^\\circ, 90^\\circ, 90^\\circ, 87^\\circ, 93^\\circ, 94^\\circ, 270^\\circ, 270^\\circ\\}$.\n\nFirst, we compute the sums $C = \\sum_{i=1}^{12} \\cos(\\theta_i)$ and $S = \\sum_{i=1}^{12} \\sin(\\theta_i)$.\n$$\nC = \\cos(87^\\circ) + \\cos(88^\\circ) + \\cos(89^\\circ) + 3\\cos(90^\\circ) + \\cos(91^\\circ) + \\cos(92^\\circ) + \\cos(93^\\circ) + \\cos(94^\\circ) + 2\\cos(270^\\circ)\n$$\n$$\nC \\approx 0.0523 + 0.0349 + 0.0175 + 3(0) - 0.0175 - 0.0349 - 0.0523 - 0.0698 + 2(0) = -0.0698\n$$\n$$\nS = \\sin(87^\\circ) + \\sin(88^\\circ) + \\sin(89^\\circ) + 3\\sin(90^\\circ) + \\sin(91^\\circ) + \\sin(92^\\circ) + \\sin(93^\\circ) + \\sin(94^\\circ) + 2\\sin(270^\\circ)\n$$\n$$\nS \\approx 0.9986 + 0.9994 + 0.9998 + 3(1) + 0.9998 + 0.9994 + 0.9986 + 0.9976 + 2(-1)\n$$\n$$\nS \\approx 2(0.9986 + 0.9994 + 0.9998) + 3 + 0.9976 - 2 \\approx 5.9956 + 1 + 0.9976 = 7.9932\n$$\nNow we find the average components:\n$$\n\\bar{C} = \\frac{-0.0698}{12} \\approx -0.0058 \\quad \\text{and} \\quad \\bar{S} = \\frac{7.9932}{12} \\approx 0.6661\n$$\nThe mean resultant length $R$ is:\n$$\nR = \\sqrt{(-0.0058)^2 + (0.6661)^2} \\approx \\sqrt{0.000034 + 0.443689} = \\sqrt{0.443723} \\approx 0.666\n$$\nThe preferred direction $\\phi$ is:\n$$\n\\phi = \\text{atan2}(0.6661, -0.0058)\n$$\nSince $\\bar{S} > 0$ and $\\bar{C}  0$, the angle is in the second quadrant. In degrees, this is $\\approx 90.5^\\circ$. Thus, the preferred direction is approximately $90^\\circ$.\n\n### 3. Rayleigh Test for Circular Non-uniformity\n\nThe Rayleigh test determines if a set of circular data points are uniformly distributed. The null hypothesis, $H_0$, is that the angles are drawn from a uniform distribution. A strong directional preference (i.e., clustering of angles) will lead to the rejection of $H_0$.\n\nThe test statistic, $Z$, is derived from the number of samples, $N$, and the mean resultant length, $R$.\n$$\nZ = N R^2\n$$\nA large value of $Z$ indicates strong clustering. For large $N$, the p-value, which is the probability of observing a test statistic at least as extreme as $Z$ under the null hypothesis, is approximated by:\n$$\np \\approx e^{-Z}\n$$\nUsing our computed values:\n-   $N=12$\n-   $R \\approx 0.666$\nThe test statistic is:\n$$\nZ = 12 \\times (0.666)^2 \\approx 12 \\times 0.443556 \\approx 5.32\n$$\nUsing the value $R \\approx 0.66613$ from the more precise calculation above, $Z \\approx 5.3248$, which we can round to $5.33$.\n\nThe approximate p-value is:\n$$\np \\approx e^{-5.33} \\approx 0.00484\n$$\nWith a significance level of $\\alpha = 0.01$, we compare the p-value to $\\alpha$.\nSince $p \\approx 0.0048  0.01$, we reject the null hypothesis of uniformity. The firing of the neuron is significantly non-uniform with respect to head direction. This is the defining characteristic of a head-direction cell.\n\n### Evaluation of Options\n\n**A. Compute the tuning curve by dividing spike counts per angle bin by the corresponding occupancy time per bin, yielding $r(90^\\circ) = \\frac{10}{30} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\,\\mathrm{s}^{-1}$ with all other bins equal to $0$. Compute the circular mean resultant length using the spike-associated angles: $R \\approx 0.666$, preferred direction $\\phi \\approx 90^\\circ$, Rayleigh test statistic $Z = N R^2 \\approx 5.33$, and $p \\approx e^{-Z} \\approx 0.0048  0.01$, concluding the neuron is an HD cell.**\n\n-   **Analysis**: This option correctly describes the principled method for computing the tuning curve, and the reported rates $r(90^\\circ) = \\frac{10}{30} \\text{ s}^{-1}$ and $r(270^\\circ) = \\frac{2}{30} \\text{ s}^{-1}$ match our derivation. It correctly states that the Rayleigh test should be performed on the spike-associated angles. The calculated values for $R \\approx 0.666$, $\\phi \\approx 90^\\circ$, $Z \\approx 5.33$, and $p \\approx 0.0048$ are all consistent with our derivation. The conclusion that the neuron is an HD cell because $p  0.01$ is also correct.\n-   **Verdict**: **Correct**.\n\n**B. Compute the tuning curve by dividing spike counts per bin by the total duration $T$, yielding $r(90^\\circ) = \\frac{10}{240} \\,\\mathrm{s}^{-1}$ and $r(270^\\circ) = \\frac{2}{240} \\,\\mathrm{s}^{-1}$. For the Rayleigh test, use the entire $\\theta(t)$ time series to compute $R$ and $Z$, which are near $0$ if occupancy is uniform; conclude the neuron is not an HD cell.**\n\n-   **Analysis**: This option employs an incorrect method for computing the firing rate; it fails to normalize by the occupancy time per bin, using the total recording time $T$ instead. Furthermore, it proposes applying the Rayleigh test to the set of all sampled head angles $\\theta(t)$, not the angles at which spikes occurred. This is a fundamental misunderstanding of the test's purpose, which is to assess clustering of spikes.\n-   **Verdict**: **Incorrect**.\n\n**C. Compute the tuning curve with occupancy normalization as in A, but for the Rayleigh test, replace the spike angles with bin centers weighted by the bin rates to estimate $R$ and $\\phi$, obtaining $R \\approx 1$ and $p \\approx 0$ because the rates are concentrated in a single bin; conclude the neuron is an HD cell.**\n\n-   **Analysis**: While the initial tuning curve method is correct, the proposed method for the Rayleigh test is non-standard and leads to incorrect results. Applying the test to binned data (e.g., $10$ points at $90^\\circ$ and $2$ points at $270^\\circ$) would give $R = \\frac{8}{12} = \\frac{2}{3} \\approx 0.667$, which is not approximately $1$. The claim $R \\approx 1$ is false, as is the premise that \"rates are concentrated in a single bin\" (they are in two bins).\n-   **Verdict**: **Incorrect**.\n\n**D. Compute the tuning curve without occupancy normalization but smooth counts with a von Mises kernel; for statistics, apply a linear normality test on the spike angles (e.g., a Shapiro–Wilk test) and accept the HD hypothesis if the angles deviate from normality on the real line; conclude the neuron is an HD cell if the test rejects normality at $\\alpha = 0.01$.**\n\n-   **Analysis**: This option proposes several incorrect procedures. It omits the critical step of occupancy normalization. More significantly, it suggests using a linear statistical test (Shapiro-Wilk for normality) on a circular variable, which is mathematically invalid. Directional data requires circular statistics.\n-   **Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once an HD cell is identified, a natural question arises: what neural mechanism allows a population of neurons to maintain a stable representation of direction? This practice delves into the theory of continuous attractor neural networks, a leading model for the HD system. You will derive the conditions under which a 'bump' of activity—the neural correlate of the perceived direction—can be sustained by a recurrently connected ring of neurons, revealing the mathematical principles of self-sustained activity patterns .",
            "id": "3987176",
            "problem": "Consider a continuous-attractor neural field model on the ring representing head direction. Let $\\theta \\in [-\\pi,\\pi)$ denote head direction (in radians) and let $u(\\theta,t)$ denote the population activity at angle $\\theta$ and time $t$. The dynamics are given by the neural field equation\n$$\n\\tau \\frac{\\partial u(\\theta,t)}{\\partial t} \\;=\\; -u(\\theta,t) \\;+\\; \\int_{-\\pi}^{\\pi} w(\\theta-\\phi)\\, f\\!\\left(u(\\phi,t)\\right)\\, d\\phi \\;+\\; h,\n$$\nwhere $\\tau>0$ is a time constant, $h>0$ is a constant homogeneous drive, $f(u)=\\max(0,u)$ is a linear-threshold activation function, and the synaptic weight kernel is cosine-shaped,\n$$\nw(\\Delta\\theta) \\;=\\; A_0 \\;+\\; A_1 \\cos(\\Delta\\theta),\n$$\nwith $A_10$ and $A_00$. Angles must be treated in radians throughout.\n\nStarting only from these definitions and the ring-convolution structure, derive the steady-state self-consistency conditions for a symmetric, single-bump fixed point in which activity is strictly positive on a connected arc and zero elsewhere. Explain why such a bump solution can exist for appropriate $(A_0,A_1,h)$, and show that its half-width $\\psi \\in (0,\\pi)$ must satisfy a closed scalar condition of the form $G(\\psi;A_1)=1$, where $G$ depends only on the kernel’s first cosine mode and the bump half-width. Then, for the specific parameter choice $A_1 = \\frac{2}{\\pi}$ and arbitrary $A_00$, determine the exact steady-state peak activity at the bump center $u(0)$ in terms of $A_0$ and $h$.\n\nYour final reported answer must be the single closed-form analytic expression for $u(0)$ as a function of $A_0$ and $h$ (no units). Do not approximate or round the expression. Angles are in radians.",
            "solution": "The problem asks for the derivation of properties of a stationary, symmetric, single-bump solution to a neural field equation on a ring, and for the calculation of the peak activity for a specific parameter choice.\n\nThe dynamics of the population activity $u(\\theta,t)$ are given by:\n$$\n\\tau \\frac{\\partial u(\\theta,t)}{\\partial t} \\;=\\; -u(\\theta,t) \\;+\\; \\int_{-\\pi}^{\\pi} w(\\theta-\\phi)\\, f\\!\\left(u(\\phi,t)\\right)\\, d\\phi \\;+\\; h\n$$\nAt steady state, $\\frac{\\partial u}{\\partial t} = 0$, so the activity profile $u(\\theta)$ must satisfy the self-consistency condition:\n$$\nu(\\theta) \\;=\\; \\int_{-\\pi}^{\\pi} w(\\theta-\\phi)\\, f\\!\\left(u(\\phi)\\right)\\, d\\phi \\;+\\; h\n$$\nWe are looking for a symmetric, single-bump solution. Due to the rotational symmetry of the system, we can assume without loss of generality that the bump is centered at $\\theta=0$. The problem states that the activity is strictly positive on a connected arc and zero elsewhere. Let this arc be $[-\\psi, \\psi]$ for a half-width $\\psi \\in (0,\\pi)$. The properties of this bump solution are:\n$1.$ $u(\\theta)  0$ for $\\theta \\in [-\\psi, \\psi]$.\n$2.$ $u(\\theta) = 0$ for $\\theta \\notin [-\\psi, \\psi]$.\n$3.$ By continuity, $u(\\pm \\psi) = 0$.\n$4.$ Due to the non-negativity of $u(\\theta)$, the activation function $f(u) = \\max(0, u)$ implies $f(u(\\theta)) = u(\\theta)$ for $\\theta \\in [-\\psi, \\psi]$ and $f(u(\\theta)) = 0$ otherwise.\n\nSubstituting this form of the solution into the steady-state equation, the integral is restricted to the interval $[-\\psi, \\psi]$:\n$$\nu(\\theta) \\;=\\; \\int_{-\\psi}^{\\psi} w(\\theta-\\phi)\\, u(\\phi)\\, d\\phi \\;+\\; h\n$$\nNow, we substitute the given weight kernel $w(\\Delta\\theta) = A_0 + A_1 \\cos(\\Delta\\theta)$:\n$$\nu(\\theta) \\;=\\; \\int_{-\\psi}^{\\psi} \\left( A_0 + A_1 \\cos(\\theta-\\phi) \\right) u(\\phi)\\, d\\phi \\;+\\; h\n$$\nWe can separate the integral:\n$$\nu(\\theta) \\;=\\; A_0 \\int_{-\\psi}^{\\psi} u(\\phi)\\, d\\phi + A_1 \\int_{-\\psi}^{\\psi} \\cos(\\theta-\\phi) u(\\phi)\\, d\\phi + h\n$$\nUsing the trigonometric identity $\\cos(\\theta-\\phi) = \\cos(\\theta)\\cos(\\phi) + \\sin(\\theta)\\sin(\\phi)$, we get:\n$$\nu(\\theta) \\;=\\; A_0 \\int_{-\\psi}^{\\psi} u(\\phi)\\, d\\phi + A_1 \\cos(\\theta) \\int_{-\\psi}^{\\psi} u(\\phi)\\cos(\\phi)\\, d\\phi + A_1 \\sin(\\theta) \\int_{-\\psi}^{\\psi} u(\\phi)\\sin(\\phi)\\, d\\phi + h\n$$\nSince the bump is symmetric around $\\theta=0$, $u(\\phi)$ is an even function. The product $u(\\phi)\\sin(\\phi)$ is an odd function, and its integral over a symmetric interval $[-\\psi, \\psi]$ is zero. Therefore, the equation simplifies to:\n$$\nu(\\theta) \\;=\\; A_0 \\left(\\int_{-\\psi}^{\\psi} u(\\phi)\\,d\\phi\\right) + A_1 \\left(\\int_{-\\psi}^{\\psi} u(\\phi)\\cos(\\phi)\\,d\\phi\\right) \\cos(\\theta) + h\n$$\nThis equation shows that for any such bump solution, the profile $u(\\theta)$ within the active region $[-\\psi, \\psi]$ must be of the form $C_0 + C_1\\cos(\\theta)$. Let's define the two integral terms as constants:\n$U_0 = \\int_{-\\psi}^{\\psi} u(\\phi)\\,d\\phi$\n$U_1 = \\int_{-\\psi}^{\\psi} u(\\phi)\\cos(\\phi)\\,d\\phi$\nThen, the solution profile for $\\theta \\in [-\\psi, \\psi]$ is:\n$$\nu(\\theta) = A_0 U_0 + A_1 U_1 \\cos(\\theta) + h\n$$\nThis is a self-consistent form. For this to be a valid solution, two conditions must be met. First, the boundary condition $u(\\pm \\psi)=0$ must hold. Second, the integrals $U_0$ and $U_1$ calculated using this form of $u(\\theta)$ must be consistent.\n\nFrom the boundary condition $u(\\psi)=0$:\n$$\nA_0 U_0 + A_1 U_1 \\cos(\\psi) + h = 0\n$$\nThis implies $A_0 U_0 + h = -A_1 U_1 \\cos(\\psi)$. Substituting this back into the expression for $u(\\theta)$:\n$$\nu(\\theta) = -A_1 U_1 \\cos(\\psi) + A_1 U_1 \\cos(\\theta) = A_1 U_1 (\\cos(\\theta) - \\cos(\\psi))\n$$\nThis is the explicit shape of the activity profile within $[-\\psi, \\psi]$. Note that for this profile to be positive for $\\theta \\in (-\\psi, \\psi)$, we need $A_1 U_1  0$. Since $A_10$ is given, this requires $U_10$.\n\nNow we enforce self-consistency by recalculating $U_1$ using this form of $u(\\theta)$:\n$$\nU_1 = \\int_{-\\psi}^{\\psi} u(\\phi)\\cos(\\phi)\\, d\\phi = \\int_{-\\psi}^{\\psi} A_1 U_1 (\\cos(\\phi) - \\cos(\\psi))\\cos(\\phi)\\, d\\phi\n$$\nSince we established $U_1 \\neq 0$ (otherwise $u(\\theta)=0$ everywhere, implying $h=0$, a contradiction), we can divide by $A_1 U_1$:\n$$\n\\frac{1}{A_1} = \\int_{-\\psi}^{\\psi} (\\cos^2(\\phi) - \\cos(\\psi)\\cos(\\phi))\\, d\\phi\n$$\nWe evaluate the integrals:\n$$\n\\int_{-\\psi}^{\\psi} \\cos^2(\\phi)\\, d\\phi = \\int_{-\\psi}^{\\psi} \\frac{1+\\cos(2\\phi)}{2}\\, d\\phi = \\left[\\frac{\\phi}{2} + \\frac{\\sin(2\\phi)}{4}\\right]_{-\\psi}^{\\psi} = \\psi + \\frac{\\sin(2\\psi)}{2}\n$$\n$$\n\\int_{-\\psi}^{\\psi} \\cos(\\phi)\\, d\\phi = [\\sin(\\phi)]_{-\\psi}^{\\psi} = 2\\sin(\\psi)\n$$\nSubstituting these back, we get:\n$$\n\\frac{1}{A_1} = \\left(\\psi + \\frac{\\sin(2\\psi)}{2}\\right) - \\cos(\\psi)(2\\sin\\psi) = \\psi + \\frac{\\sin(2\\psi)}{2} - \\sin(2\\psi) = \\psi - \\frac{\\sin(2\\psi)}{2}\n$$\nThis gives the required condition on the half-width $\\psi$:\n$$\n1 = A_1 \\left(\\psi - \\frac{\\sin(2\\psi)}{2}\\right)\n$$\nThis is of the form $G(\\psi; A_1) = 1$ with $G(\\psi; A_1) = A_1 \\left(\\psi - \\frac{\\sin(2\\psi)}{2}\\right)$. The existence of such a bump solution depends on whether this equation has a solution for $\\psi \\in (0, \\pi)$. Let $g(\\psi) = \\psi - \\frac{1}{2}\\sin(2\\psi)$. We have $g(0)=0$ and $g(\\pi)=\\pi$. The derivative is $g'(\\psi) = 1 - \\cos(2\\psi) = 2\\sin^2(\\psi)$, which is non-negative and strictly positive for $\\psi \\in (0,\\pi)$. Thus, $g(\\psi)$ is strictly increasing on $(0, \\pi)$. A unique solution for $\\psi$ in this range exists if and only if the value $1/A_1$ is in the range of $g(\\psi)$, i.e., $0  1/A_1  \\pi$, which implies $A_1  1/\\pi$. This explains why a bump solution can exist for appropriate parameter values. The parameters $A_0  0$ and $h0$ ensure the amplitude is finite and positive, and that the state where $u=0$ everywhere is not stable.\n\nNow, we address the specific case where $A_1 = \\frac{2}{\\pi}$. We find the half-width $\\psi$ by solving the condition:\n$$\n1 = \\frac{2}{\\pi} \\left(\\psi - \\frac{\\sin(2\\psi)}{2}\\right) \\quad \\implies \\quad \\frac{\\pi}{2} = \\psi - \\frac{\\sin(2\\psi)}{2}\n$$\nBy inspection, we can see that $\\psi = \\frac{\\pi}{2}$ is a solution:\n$$\n\\frac{\\pi}{2} - \\frac{\\sin(2 \\cdot \\pi/2)}{2} = \\frac{\\pi}{2} - \\frac{\\sin(\\pi)}{2} = \\frac{\\pi}{2} - 0 = \\frac{\\pi}{2}\n$$\nSince $g(\\psi)$ is strictly increasing, this is the unique solution in $(0,\\pi)$. Thus, for $A_1=\\frac{2}{\\pi}$, the bump has a half-width of $\\psi=\\frac{\\pi}{2}$.\n\nThe final task is to find the peak activity $u(0)$. We have the expression for the activity profile:\n$$\nu(\\theta) = A_1 U_1 (\\cos(\\theta) - \\cos(\\psi))\n$$\nThe peak activity is at the center of the bump, $\\theta=0$:\n$$\nu(0) = A_1 U_1 (1 - \\cos(\\psi))\n$$\nTo find $A_1 U_1$, we use the boundary condition $A_0 U_0 + A_1 U_1 \\cos(\\psi) + h = 0$. We need to calculate $U_0$:\n$$\nU_0 = \\int_{-\\psi}^{\\psi} u(\\phi)\\,d\\phi = \\int_{-\\psi}^{\\psi} A_1 U_1 (\\cos(\\phi) - \\cos(\\psi))\\, d\\phi = A_1 U_1 \\left( \\int_{-\\psi}^{\\psi} \\cos(\\phi)\\,d\\phi - \\cos(\\psi) \\int_{-\\psi}^{\\psi} d\\phi\\right)\n$$\n$$\nU_0 = A_1 U_1 (2\\sin(\\psi) - 2\\psi\\cos(\\psi)) = 2A_1 U_1 (\\sin(\\psi) - \\psi\\cos(\\psi))\n$$\nSubstitute this into the boundary condition equation:\n$$\nA_0 [2A_1 U_1 (\\sin(\\psi) - \\psi\\cos(\\psi))] + A_1 U_1 \\cos(\\psi) + h = 0\n$$\nSolving for $A_1 U_1$:\n$$\nA_1 U_1 [2A_0 (\\sin(\\psi) - \\psi\\cos(\\psi)) + \\cos(\\psi)] = -h\n$$\n$$\nA_1 U_1 = \\frac{-h}{2A_0 (\\sin(\\psi) - \\psi\\cos(\\psi)) + \\cos(\\psi)}\n$$\nNow we can write the expression for the peak activity $u(0)$:\n$$\nu(0) = \\frac{-h(1-\\cos(\\psi))}{2A_0 (\\sin(\\psi) - \\psi\\cos(\\psi)) + \\cos(\\psi)}\n$$\nFinally, we substitute the specific value $\\psi = \\frac{\\pi}{2}$:\n$\\cos(\\frac{\\pi}{2}) = 0$\n$\\sin(\\frac{\\pi}{2}) = 1$\n$$\nu(0) = \\frac{-h(1-0)}{2A_0 (1 - \\frac{\\pi}{2} \\cdot 0) + 0} = \\frac{-h}{2A_0(1)} = -\\frac{h}{2A_0}\n$$\nSince it is given that $h0$ and $A_00$, the peak activity $u(0)$ is positive, as required.",
            "answer": "$$\n\\boxed{-\\frac{h}{2A_0}}\n$$"
        },
        {
            "introduction": "An internal sense of direction is only useful if it remains calibrated to the external world; however, integration processes like those using vestibular signals are prone to accumulating error, causing the HD representation to drift. This final exercise explores how a static visual landmark can provide a corrective, anchoring signal to the HD system. You will model the dynamic interplay between this internal drift and external sensory cues to understand how an accurate heading is maintained .",
            "id": "3987268",
            "problem": "Consider a canonical one-dimensional continuous-attractor model of head-direction (HD) cells in which the population activity peak defines an internal orientation phase $\\theta(t)$ on the circle. The internal phase integrates angular velocity from the vestibular system and is subject to a constant vestibular bias $\\delta \\in \\mathbb{R}$ that causes drift. A static visual landmark (VL) at absolute angle $\\theta_{\\mathrm{VL}}$ exerts an aligning input on the HD network that is odd in the phase difference, smooth, and $2\\pi$-periodic, with a stable minimum when the internal phase matches the landmark. In ring-attractor realizations, this alignment can be modeled by the lowest-order sinusoidal term consistent with rotational symmetry, yielding a restoring torque proportional to $-k\\sin(\\theta-\\theta_{\\mathrm{VL}})$, where $k0$ quantifies the strength of landmark anchoring.\n\nAssume the VL is fixed in the world, so $\\theta_{\\mathrm{VL}}$ is constant, and the vestibular angular velocity is zero-mean over long times so that only the constant bias $\\delta$ persists. Define the phase offset $\\Delta(t)=\\theta(t)-\\theta_{\\mathrm{VL}}$. Starting from first principles of phase dynamics on the circle and the symmetry-constrained sinusoidal anchoring term described above, derive the scalar dynamical equation for $\\Delta(t)$ and obtain the steady-state phase offset(s) $\\Delta^{\\ast}$ that satisfy the equilibrium condition. Analyze the local stability of the equilibria using linearization and determine which equilibrium is locally asymptotically stable when equilibria exist. Discuss the existence condition for equilibria in terms of $\\delta$ and $k$.\n\nProvide your final expression for the stable steady-state phase offset as a single closed-form analytic expression in radians. Do not approximate or round; report the principal value that corresponds to the locally asymptotically stable equilibrium near $\\Delta=0$ when it exists.",
            "solution": "The problem asks for an analysis of the dynamics of a head-direction (HD) cell system's internal orientation phase, $\\theta(t)$. The dynamics are governed by two competing influences: an intrinsic drift due to a constant vestibular bias, $\\delta$, and a restoring influence from a static visual landmark (VL) at a fixed angle $\\theta_{\\mathrm{VL}}$.\n\nFirst, we formulate the dynamical equation for the internal phase $\\theta(t)$. The rate of change of the phase, $\\frac{d\\theta}{dt}$, is the net angular velocity. This net velocity is the sum of the velocity from the vestibular bias and the velocity induced by the landmark's restoring torque.\nThe vestibular system contributes a constant angular velocity, $\\delta$.\nThe visual landmark exerts a restoring torque specified as being proportional to $-k\\sin(\\theta - \\theta_{\\mathrm{VL}})$, where $k > 0$ quantifies the strength of landmark anchoring. In this model of phase dynamics, this torque corresponds directly to an angular velocity term. Therefore, the landmark contributes an angular velocity of $-k\\sin(\\theta(t) - \\theta_{\\mathrm{VL}})$.\n\nCombining these two contributions, the dynamics of the internal phase $\\theta(t)$ are described by the first-order ordinary differential equation:\n$$\n\\frac{d\\theta}{dt} = \\delta - k\\sin(\\theta(t) - \\theta_{\\mathrm{VL}})\n$$\n\nThe problem requires an analysis of the phase offset, defined as $\\Delta(t) = \\theta(t) - \\theta_{\\mathrm{VL}}$. We derive the dynamical equation for $\\Delta(t)$ by differentiating this definition with respect to time $t$:\n$$\n\\frac{d\\Delta}{dt} = \\frac{d}{dt}\\left(\\theta(t) - \\theta_{\\mathrm{VL}}\\right) = \\frac{d\\theta}{dt} - \\frac{d\\theta_{\\mathrm{VL}}}{dt}\n$$\nSince the visual landmark is static, its angle $\\theta_{\\mathrm{VL}}$ is constant, which means $\\frac{d\\theta_{\\mathrm{VL}}}{dt} = 0$. Therefore, $\\frac{d\\Delta}{dt} = \\frac{d\\theta}{dt}$.\nSubstituting $\\theta(t) - \\theta_{\\mathrm{VL}} = \\Delta(t)$ into the equation for $\\frac{d\\theta}{dt}$, we obtain the scalar dynamical equation for the phase offset $\\Delta(t)$:\n$$\n\\frac{d\\Delta}{dt} = \\delta - k\\sin(\\Delta(t))\n$$\nThis equation is a form of the Adler equation, which describes phase locking.\n\nNext, we identify the steady-state phase offsets, denoted $\\Delta^{\\ast}$, by finding the equilibria of the system. The equilibrium condition is $\\frac{d\\Delta}{dt} = 0$.\n$$\n\\delta - k\\sin(\\Delta^{\\ast}) = 0\n$$\nRearranging for $\\sin(\\Delta^{\\ast})$, we get:\n$$\n\\sin(\\Delta^{\\ast}) = \\frac{\\delta}{k}\n$$\n\nFor a real-valued solution $\\Delta^{\\ast}$ to exist, the value of $\\sin(\\Delta^{\\ast})$ must be within the range $[-1, 1]$. This imposes a condition on the parameters $\\delta$ and $k$:\n$$\n-1 \\le \\frac{\\delta}{k} \\le 1\n$$\nSince $k > 0$ is given, this is equivalent to $|\\delta| \\le k$.\nIf $|\\delta| > k$, $|\\frac{\\delta}{k}| > 1$, and there are no real solutions for $\\Delta^{\\ast}$. In this regime, the system does not settle into an equilibrium; instead, it undergoes phase slipping, where $\\Delta(t)$ continuously increases or decreases. If $\\delta > k$, then $\\frac{d\\Delta}{dt} > 0$ for all $\\Delta$, and if $\\delta  -k$, then $\\frac{d\\Delta}{dt}  0$ for all $\\Delta$.\n\nAssuming the existence condition $|\\delta| \\le k$ is met, there are two families of equilibrium points within each $2\\pi$ interval. The principal solutions are:\n$$\n\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)\n$$\n$$\n\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right)\n$$\n\nTo determine the local stability of these equilibria, we perform a linear stability analysis. Let the right-hand side of the dynamical equation be $f(\\Delta) = \\delta - k\\sin(\\Delta)$. An equilibrium $\\Delta^{\\ast}$ is locally asymptotically stable if the derivative $f'(\\Delta^{\\ast})  0$ and unstable if $f'(\\Delta^{\\ast}) > 0$.\nThe derivative of $f(\\Delta)$ is:\n$$\nf'(\\Delta) = \\frac{d}{d\\Delta}\\left(\\delta - k\\sin(\\Delta)\\right) = -k\\cos(\\Delta)\n$$\nWe evaluate this derivative at each of the two principal equilibria for the case where $|\\delta|  k$, which ensures the equilibria are distinct.\n\nFor the first equilibrium, $\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)$:\nBy definition of the principal value of the $\\arcsin$ function, $-\\frac{\\pi}{2} \\le \\Delta^{\\ast}_1 \\le \\frac{\\pi}{2}$. In this interval, $\\cos(\\Delta^{\\ast}_1) \\ge 0$. For $|\\frac{\\delta}{k}|  1$, we have $-\\frac{\\pi}{2}  \\Delta^{\\ast}_1  \\frac{\\pi}{2}$, which implies $\\cos(\\Delta^{\\ast}_1) > 0$.\nThe stability is determined by the sign of $f'(\\Delta^{\\ast}_1)$:\n$$\nf'(\\Delta^{\\ast}_1) = -k\\cos(\\Delta^{\\ast}_1)\n$$\nSince $k > 0$ and $\\cos(\\Delta^{\\ast}_1) > 0$, we have $f'(\\Delta^{\\ast}_1)  0$. Therefore, the equilibrium $\\Delta^{\\ast}_1 = \\arcsin\\left(\\frac{\\delta}{k}\\right)$ is locally asymptotically stable. This equilibrium is near $\\Delta = 0$ for small $|\\delta|$.\n\nFor the second equilibrium, $\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right) = \\pi - \\Delta^{\\ast}_1$:\nWe evaluate the cosine of this angle:\n$$\n\\cos(\\Delta^{\\ast}_2) = \\cos(\\pi - \\Delta^{\\ast}_1) = -\\cos(\\Delta^{\\ast}_1)\n$$\nSince $\\cos(\\Delta^{\\ast}_1) > 0$ for $|\\frac{\\delta}{k}|  1$, we have $\\cos(\\Delta^{\\ast}_2)  0$.\nThe stability is determined by the sign of $f'(\\Delta^{\\ast}_2)$:\n$$\nf'(\\Delta^{\\ast}_2) = -k\\cos(\\Delta^{\\ast}_2) = -k(-\\cos(\\Delta^{\\ast}_1)) = k\\cos(\\Delta^{\\ast}_1)\n$$\nSince $k > 0$ and $\\cos(\\Delta^{\\ast}_1) > 0$, we have $f'(\\Delta^{\\ast}_2) > 0$. Therefore, the equilibrium $\\Delta^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\delta}{k}\\right)$ is unstable.\n\nThe problem asks for the stable steady-state phase offset, which corresponds to $\\Delta^{\\ast}_1$. This solution represents a stable balance between the vestibular drift $\\delta$ and the landmark's anchoring pull $k$. The system settles at a non-zero offset from the landmark's true direction, with the magnitude of the offset depending on the ratio of the drift to the anchoring strength.\n\nThe final expression for the locally asymptotically stable steady-state phase offset is the principal value given by $\\arcsin\\left(\\frac{\\delta}{k}\\right)$.",
            "answer": "$$\\boxed{\\arcsin\\left(\\frac{\\delta}{k}\\right)}$$"
        }
    ]
}