{
    "hands_on_practices": [
        {
            "introduction": "Path integration requires updating an internal representation of pose by sequentially combining rotations and translations. This exercise grounds this process in the formal mathematics of the Special Euclidean group, $SE(2)$. By calculating the final position resulting from two different sequences of the same movements, you will directly demonstrate the non-commutative nature of these operations, a fundamental principle that has significant consequences for how the brain must process self-motion cues. ",
            "id": "3971833",
            "problem": "Consider a simplified path-integration module for allocentric pose in the plane, modeled as elements of the Special Euclidean group in two dimensions (SE(2)). The animal’s pose is represented by a position $(x,y)$ in meters and a heading angle $\\theta$ in radians. Assume piecewise-constant controls: at each step, a rotation by angle $\\Delta \\theta$ updates the heading, and a subsequent translation occurs along the body-forward axis at constant speed $s$ for duration $T$, producing a displacement of magnitude $d = sT$. Use the kinematic base that the translational velocity in the world frame is the body-forward speed projected by the current heading, and that rotations update the heading additively.\n\nFormally:\n- The world-frame displacement from a translation along the body-forward axis of magnitude $d$ at heading $\\theta$ is $\\Delta x = d \\cos(\\theta)$ and $\\Delta y = d \\sin(\\theta)$.\n- The heading update by a rotation $\\Delta \\theta$ is $\\theta \\leftarrow \\theta + \\Delta \\theta$.\n\nThe agent starts at $(x_0,y_0)=(0,0)$ with initial heading $\\theta_0 = 0$. It executes the following sequence of piecewise-constant controls:\n\nSegment $1$: rotate by $\\Delta \\theta_1 = \\pi/6$, then translate with speed $s_1 = 0.5$ m/s for duration $T_1 = 4$ s.\n\nSegment $2$: there are two variants of ordering the rotation and translation:\n- Variant A: rotate by $\\Delta \\theta_2 = -\\pi/3$, then translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s.\n- Variant B: translate first with the same $s_2$ and $T_2$ at the current heading, then rotate by $\\Delta \\theta_2 = -\\pi/3$.\n\nSegment $3$: rotate by $\\Delta \\theta_3 = \\arctan(1/2)$, then translate with speed $s_3 = 0.8$ m/s for duration $T_3 = 5$ s.\n\nAssume all rotations are instantaneous heading updates occurring between translations, and all translations are along the instantaneous body-forward axis. Using only the above kinematic base, compute the exact final positions $(x_A,y_A)$ and $(x_B,y_B)$ produced by concatenating the operations in Variant A and Variant B, respectively. Then, compute the Euclidean distance between these two final positions to demonstrate the non-commutativity of rotations and translations in SE(2).\n\nUse radians for all angles. Express the final Euclidean distance in meters. Provide the exact value; do not round.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model**: Path integration for pose in the Special Euclidean group $SE(2)$.\n- **State**: Position $(x, y)$ in meters, heading angle $\\theta$ in radians.\n- **Initial State**: $(x_0, y_0) = (0, 0)$, $\\theta_0 = 0$.\n- **Kinematic Rules**:\n  - Rotation: $\\theta \\leftarrow \\theta + \\Delta \\theta$.\n  - Translation: Displacement magnitude $d = sT$. World-frame displacement is $\\Delta x = d \\cos(\\theta)$ and $\\Delta y = d \\sin(\\theta)$.\n- **Control Sequence**:\n  - **Segment 1**: Rotate $\\Delta \\theta_1 = \\pi/6$. Translate with speed $s_1 = 0.5$ m/s for duration $T_1 = 4$ s.\n  - **Segment 2, Variant A**: Rotate $\\Delta \\theta_2 = -\\pi/3$. Translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s.\n  - **Segment 2, Variant B**: Translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s. Rotate $\\Delta \\theta_2 = -\\pi/3$.\n  - **Segment 3**: Rotate $\\Delta \\theta_3 = \\arctan(1/2)$. Translate with speed $s_3 = 0.8$ m/s for duration $T_3 = 5$ s.\n- **Task**:\n  1. Compute the final position $(x_A, y_A)$ for the path with Variant A.\n  2. Compute the final position $(x_B, y_B)$ for the path with Variant B.\n  3. Compute the Euclidean distance between $(x_A, y_A)$ and $(x_B, y_B)$.\n  4. Provide the exact value.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific or Factual Soundness**: The problem is scientifically sound. It uses a standard kinematic model for a rigid body moving in a plane, which is a fundamental concept in robotics, physics, and computational neuroscience. The mathematical framework of $SE(2)$ is appropriate.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary initial conditions and control parameters. The sequence of operations is deterministic, leading to a unique solution.\n- **Objectivity**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained and free of contradictions. All required data is provided.\n- **Realism**: The physical parameters (speeds, durations) are realistic.\n- **Structure**: The problem is clearly structured and asks for a specific, computable result.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n***\n\nThe solution proceeds by computing the agent's state $(x, y, \\theta)$ sequentially for each path. First, we calculate the displacement magnitudes for each segment.\nDisplacement for Segment $1$: $d_1 = s_1 T_1 = (0.5 \\text{ m/s}) \\cdot (4 \\text{ s}) = 2$ m.\nDisplacement for Segment $2$: $d_2 = s_2 T_2 = (1.2 \\text{ m/s}) \\cdot (2 \\text{ s}) = 2.4$ m, which is $\\frac{12}{5}$ m.\nDisplacement for Segment $3$: $d_3 = s_3 T_3 = (0.8 \\text{ m/s}) \\cdot (5 \\text{ s}) = 4$ m.\n\nThe initial state is $(x_0, y_0, \\theta_0) = (0, 0, 0)$.\n\n**State Evolution for Path A**\n\n1.  **After Segment 1 (Rotate, then Translate):**\n    The heading is updated first: $\\theta'_1 = \\theta_0 + \\Delta \\theta_1 = 0 + \\frac{\\pi}{6} = \\frac{\\pi}{6}$.\n    The translation occurs at this new heading:\n    $\\Delta x_1 = d_1 \\cos(\\theta'_1) = 2 \\cos(\\frac{\\pi}{6}) = 2 \\cdot \\frac{\\sqrt{3}}{2} = \\sqrt{3}$.\n    $\\Delta y_1 = d_1 \\sin(\\theta'_1) = 2 \\sin(\\frac{\\pi}{6}) = 2 \\cdot \\frac{1}{2} = 1$.\n    The state after Segment $1$ is $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$.\n\n2.  **After Segment 2, Variant A (Rotate, then Translate):**\n    Starting from $(x_1, y_1, \\theta_1)$, the heading is updated: $\\theta'_{2A} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$.\n    The translation occurs at this new heading:\n    $\\Delta x_{2A} = d_2 \\cos(\\theta'_{2A}) = \\frac{12}{5} \\cos(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$.\n    $\\Delta y_{2A} = d_2 \\sin(\\theta'_{2A}) = \\frac{12}{5} \\sin(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot (-\\frac{1}{2}) = -\\frac{6}{5}$.\n    The position is updated:\n    $x_{2A} = x_1 + \\Delta x_{2A} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{5\\sqrt{3} + 6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$.\n    $y_{2A} = y_1 + \\Delta y_{2A} = 1 - \\frac{6}{5} = -\\frac{1}{5}$.\n    The state after Segment $2A$ is $(x_{2A}, y_{2A}, \\theta_{2A}) = (\\frac{11\\sqrt{3}}{5}, -\\frac{1}{5}, -\\frac{\\pi}{6})$.\n\n3.  **After Segment 3 (following Variant A):**\n    The heading is updated: $\\theta'_{3A} = \\theta_{2A} + \\Delta \\theta_3 = -\\frac{\\pi}{6} + \\arctan(\\frac{1}{2})$.\n    For the displacement, we need $\\cos(\\theta'_{3A})$ and $\\sin(\\theta'_{3A})$. Let $\\alpha = \\arctan(\\frac{1}{2})$. A right triangle with opposite side $1$ and adjacent side $2$ has hypotenuse $\\sqrt{1^2+2^2}=\\sqrt{5}$. Thus, $\\cos(\\alpha) = \\frac{2}{\\sqrt{5}}$ and $\\sin(\\alpha) = \\frac{1}{\\sqrt{5}}$.\n    Using sum/difference identities:\n    $\\cos(\\theta'_{3A}) = \\cos(\\alpha - \\frac{\\pi}{6}) = \\cos(\\alpha)\\cos(\\frac{\\pi}{6}) + \\sin(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{2}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} + \\frac{1}{\\sqrt{5}}\\frac{1}{2} = \\frac{2\\sqrt{3}+1}{2\\sqrt{5}}$.\n    $\\sin(\\theta'_{3A}) = \\sin(\\alpha - \\frac{\\pi}{6}) = \\sin(\\alpha)\\cos(\\frac{\\pi}{6}) - \\cos(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{1}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} - \\frac{2}{\\sqrt{5}}\\frac{1}{2} = \\frac{\\sqrt{3}-2}{2\\sqrt{5}}$.\n    The displacement for Segment $3$ is:\n    $\\Delta x_{3A} = d_3 \\cos(\\theta'_{3A}) = 4 \\cdot \\frac{2\\sqrt{3}+1}{2\\sqrt{5}} = \\frac{2(2\\sqrt{3}+1)}{\\sqrt{5}} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$.\n    $\\Delta y_{3A} = d_3 \\sin(\\theta'_{3A}) = 4 \\cdot \\frac{\\sqrt{3}-2}{2\\sqrt{5}} = \\frac{2(\\sqrt{3}-2)}{\\sqrt{5}} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$.\n    The final position for Path A is $(x_A, y_A)$:\n    $x_A = x_{2A} + \\Delta x_{3A} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$.\n    $y_A = y_{2A} + \\Delta y_{3A} = -\\frac{1}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$.\n\n**State Evolution for Path B**\n\n1.  **After Segment 1 (Rotate, then Translate):**\n    This segment is identical to Path A. The state is $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$.\n\n2.  **After Segment 2, Variant B (Translate, then Rotate):**\n    Starting from $(x_1, y_1, \\theta_1)$, the translation occurs first, using the current heading $\\theta_1$:\n    $\\Delta x_{2B} = d_2 \\cos(\\theta_1) = \\frac{12}{5} \\cos(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$.\n    $\\Delta y_{2B} = d_2 \\sin(\\theta_1) = \\frac{12}{5} \\sin(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{1}{2} = \\frac{6}{5}$.\n    The position is updated:\n    $x_{2B} = x_1 + \\Delta x_{2B} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$.\n    $y_{2B} = y_1 + \\Delta y_{2B} = 1 + \\frac{6}{5} = \\frac{11}{5}$.\n    Then, the heading is updated:\n    $\\theta_{2B} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$.\n    The state after Segment $2B$ is $(x_{2B}, y_{2B}, \\theta_{2B}) = (\\frac{11\\sqrt{3}}{5}, \\frac{11}{5}, -\\frac{\\pi}{6})$.\n\n3.  **After Segment 3 (following Variant B):**\n    The heading entering this segment is $\\theta_{2B} = -\\frac{\\pi}{6}$, which is identical to $\\theta_{2A}$. Since Segment $3$ involves the same operations (rotate by $\\Delta\\theta_3$, translate by $d_3$), the displacement vector $(\\Delta x_{3B}, \\Delta y_{3B})$ will be identical to $(\\Delta x_{3A}, \\Delta y_{3A})$.\n    $\\Delta x_{3B} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$.\n    $\\Delta y_{3B} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$.\n    The final position for Path B is $(x_B, y_B)$:\n    $x_B = x_{2B} + \\Delta x_{3B} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$.\n    $y_B = y_{2B} + \\Delta y_{3B} = \\frac{11}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$.\n\n**Euclidean Distance Calculation**\n\nThe final positions are:\n$P_A = (x_A, y_A) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n$P_B = (x_B, y_B) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n\nWe compute the difference between these positions to find the distance.\n$\\Delta x_{final} = x_B - x_A = 0$. This occurs due to the specific choice of angles $\\theta_1 = \\pi/6$ and $\\Delta\\theta_2 = -\\pi/3$, which results in $\\cos(\\theta_1) = \\cos(\\theta_1+\\Delta\\theta_2)$.\n$\\Delta y_{final} = y_B - y_A = \\left( \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) - \\left( \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) = \\frac{11 - (-1)}{5} = \\frac{12}{5}$.\n\nThe Euclidean distance $D$ is the magnitude of the difference vector $(\\Delta x_{final}, \\Delta y_{final})$:\n$D = \\sqrt{(\\Delta x_{final})^2 + (\\Delta y_{final})^2} = \\sqrt{0^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{12}{5}$.\n\nThis non-zero distance demonstrates the non-commutativity of rotation and translation operations in $SE(2)$. The final pose depends on the order in which these operations are applied.\nThe distance is $\\frac{12}{5}$ meters, or $2.4$ meters.",
            "answer": "$$\\boxed{\\frac{12}{5}}$$"
        },
        {
            "introduction": "While ideal path integration provides a perfect estimate of position, biological systems are subject to systematic errors. This practice explores the effect of a common error: a constant miscalibration of distance estimation, or odometric gain. You will derive the final homing error after a multi-leg journey, providing a quantitative understanding of how a simple sensory bias leads to a predictable and accumulating navigational error. ",
            "id": "3971882",
            "problem": "Consider a planar agent performing path integration to return to a nest located at the origin. The agent starts at the nest, moves along a first straight leg of length $L_{1}$ aligned with the positive $x$-axis, then instantaneously turns by an angle $\\theta$ (in radians, counterclockwise) and moves along a second straight leg of length $L_{2}$. After these two legs, the agent attempts to home directly to the nest by moving along a single third straight leg equal to its internally computed home vector.\n\nAssume the following fundamental base:\n- Displacements in the plane sum linearly as vectors in an allocentric frame, and rotations are represented by the rotation matrix $R(\\phi) = \\begin{pmatrix}\\cos \\phi & -\\sin \\phi \\\\ \\sin \\phi & \\cos \\phi\\end{pmatrix}$.\n- Path integration accumulates the vectorial sum of traversed displacements to form an internal home vector pointing from the current location to the origin.\n- The agent’s angular estimation is perfect (no heading bias), and rotations are instantaneous at vertices.\n- There is a systematic odometric gain in distance estimation: each traversed distance $d$ is internally encoded as $(1+\\gamma)d$, where $\\gamma$ is a small constant. There are no other sources of noise or leak.\n\nLet the agent, at the end of the second leg, use its internal home vector to generate the third leg, moving exactly by that vector in the plane. Derive, from first principles and the assumptions above, the agent’s final deviation vector from the nest (its final position relative to the origin) after completing the third leg, expressed in terms of $L_{1}$, $L_{2}$, $\\theta$, and $\\gamma$. Express your final answer as a single $1 \\times 2$ row vector containing the $x$- and $y$-components. No numerical evaluation is required, and no units are needed. Angles are in radians.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It provides a clear, formalizable scenario within the established framework of computational models of path integration. All necessary parameters and conditions are specified, and there are no internal contradictions or ambiguities. We may therefore proceed with a formal derivation.\n\nThe agent's movement can be described using vector algebra in a 2D Cartesian coordinate system where the nest is at the origin, $\\vec{p}_{\\text{nest}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. The problem requires deriving the agent's final position vector, which represents the deviation from the nest.\n\nFirst, we determine the agent's actual physical position after completing the first two legs of its journey. Let $\\vec{P}_{\\text{actual}}$ be this position vector.\n\nThe first leg of the journey is a displacement of length $L_1$ along the positive $x$-axis. The corresponding displacement vector, $\\vec{d}_1$, is:\n$$\n\\vec{d}_1 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix}\n$$\nThe agent starts at the origin, so its position after the first leg is $\\vec{p}_1 = \\vec{d}_1$.\n\nThe agent then turns by an angle $\\theta$ counterclockwise and moves a distance $L_2$. The direction of this second leg is given by the unit vector $\\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$. The displacement vector for the second leg, $\\vec{d}_2$, is therefore:\n$$\n\\vec{d}_2 = L_2 \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\nThe agent's actual position after the second leg, $\\vec{P}_{\\text{actual}}$, is the vector sum of the displacements of the first two legs:\n$$\n\\vec{P}_{\\text{actual}} = \\vec{d}_1 + \\vec{d}_2 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\n\nNext, we calculate the agent's internally computed home vector, $\\vec{H}$. According to the problem, path integration accumulates the vectorial sum of traversed displacements. However, there is a systematic odometric gain $\\gamma$, such that any traversed distance $d$ is internally encoded as $(1+\\gamma)d$. The agent's heading estimation is perfect, so the directions of the encoded displacements are correct.\n\nThe internally encoded displacement for the first leg, $\\vec{d}'_1$, has a magnitude of $(1+\\gamma)L_1$:\n$$\n\\vec{d}'_1 = (1+\\gamma) \\vec{d}_1 = \\begin{pmatrix} (1+\\gamma)L_1 \\\\ 0 \\end{pmatrix}\n$$\nThe internally encoded displacement for the second leg, $\\vec{d}'_2$, has a magnitude of $(1+\\gamma)L_2$:\n$$\n\\vec{d}'_2 = (1+\\gamma) \\vec{d}_2 = \\begin{pmatrix} (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\nThe agent's total integrated displacement vector, $\\vec{D}_{\\text{integrated}}$, is the sum of these encoded displacements:\n$$\n\\vec{D}_{\\text{integrated}} = \\vec{d}'_1 + \\vec{d}'_2 = \\begin{pmatrix} (1+\\gamma)L_1 + (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\nThis can be factored as:\n$$\n\\vec{D}_{\\text{integrated}} = (1+\\gamma) \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = (1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\nThe internal home vector, $\\vec{H}$, is defined as the vector pointing from the current location back to the origin. It is therefore the negative of the total integrated displacement vector:\n$$\n\\vec{H} = -\\vec{D}_{\\text{integrated}} = -(1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\n\nFinally, we determine the agent's final position. The problem states that the agent moves along a third leg exactly equal to its internally computed home vector. This means the displacement for the third leg, $\\vec{d}_3$, is equal to $\\vec{H}$.\n$$\n\\vec{d}_3 = \\vec{H}\n$$\nThe agent's final position, $\\vec{P}_{\\text{final}}$, is its position after the second leg, $\\vec{P}_{\\text{actual}}$, plus the displacement of the third leg, $\\vec{d}_3$.\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + \\vec{d}_3\n$$\nSubstituting the expressions for $\\vec{P}_{\\text{actual}}$ and $\\vec{d}_3 = \\vec{H}$:\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + (-(1+\\gamma)\\vec{P}_{\\text{actual}})\n$$\n$$\n\\vec{P}_{\\text{final}} = (1 - (1+\\gamma))\\vec{P}_{\\text{actual}}\n$$\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\vec{P}_{\\text{actual}}\n$$\nSubstituting the components of $\\vec{P}_{\\text{actual}}$:\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta) \\\\ -\\gamma L_2 \\sin\\theta \\end{pmatrix}\n$$\nThis vector $\\vec{P}_{\\text{final}}$ represents the final deviation of the agent from the nest. The problem asks for this as a $1 \\times 2$ row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta) & -\\gamma L_2 \\sin\\theta \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The Oscillatory Interference (OI) model offers a powerful hypothesis for how path integration could give rise to the hexagonal firing patterns of grid cells. This advanced practice delves into the model's robustness by examining the impact of neural noise. You will derive the relationship between phase diffusion in the underlying oscillators and the resulting spatial degradation of the grid representation, offering a concrete link between microscopic noise and the macroscopic stability of a neural code. ",
            "id": "3971844",
            "problem": "Consider an Oscillatory Interference (OI) model of a two-dimensional hexagonal grid cell. The ideal, instantaneous firing rate is modeled as the superposition of three plane-wave components,\n$$\nr(\\mathbf{x},t) \\propto \\sum_{i=1}^{3} \\cos\\!\\big(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)\\big),\n$$\nwhere $\\mathbf{x} \\in \\mathbb{R}^{2}$ is position, $\\mathbf{k}_i \\in \\mathbb{R}^{2}$ are wavevectors of equal magnitude $k$ and separated by $60^{\\circ}$, and $\\phi_i(t)$ are the phases of the three oscillators. The relationship between velocity and phase update in path integration is given by the kinematic identity\n$$\n\\frac{d}{dt}\\phi_i(t) = \\mathbf{k}_i \\cdot \\mathbf{v}(t),\n$$\nand the oscillator frequency noise is modeled as a zero-mean Gaussian process that produces phase diffusion\n$$\n\\mathrm{Var}\\!\\big(\\phi_i(t)\\big) = 2 D t,\n$$\nwith diffusion constant $D$ and time $t$. Assume that the three phase processes are independent, identically distributed, and that all angles are in degrees for the orientations of the $\\mathbf{k}_i$, while the phases $\\phi_i(t)$ are in radians. Assume small phase deviations and linearize the stationarity condition near an ideal grid field center.\n\nLet the grid spatial period be $\\lambda$, so that $k = \\frac{2\\pi}{\\lambda}$. Define the grid field center displacement $\\delta \\mathbf{x}(t)$ as the shift of the local maximum of $r(\\mathbf{x},t)$ induced by the random phases $\\phi_i(t)$. Using only the above base relations and first-order approximations valid for small $\\delta \\mathbf{x}(t)$ and small $\\phi_i(t)$, derive the isotropic spatial variance $\\sigma^{2}(t)$ of the field center displacement, that is, the common variance along each coordinate axis of $\\delta \\mathbf{x}(t)$, in terms of $D$, $t$, and $\\lambda$.\n\nExpress your final answer as a single closed-form analytic expression for $\\sigma^{2}(t)$ in square meters. No rounding is required. Angles for $\\phi_i(t)$ must be treated in radians; orientations of $\\mathbf{k}_i$ are in degrees but do not appear in the final expression except through the $60^{\\circ}$ symmetry.",
            "solution": "The problem asks for the isotropic spatial variance of the grid field center displacement, $\\sigma^{2}(t)$, for an Oscillatory Interference (OI) model of a grid cell. The derivation will proceed by linearizing the condition for a maximum of the firing rate function under small phase noise.\n\nThe firing rate is given by\n$$\nr(\\mathbf{x},t) \\propto f(\\mathbf{x},t) = \\sum_{i=1}^{3} \\cos\\!\\big(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)\\big)\n$$\nwhere $\\mathbf{x} \\in \\mathbb{R}^2$ is the position, $\\mathbf{k}_i$ are wavevectors, and $\\phi_i(t)$ are time-dependent random phases. An ideal grid field center, for which the rate is maximal, occurs when the arguments of the cosine functions are integer multiples of $2\\pi$. We can choose a coordinate system such that a field center is at $\\mathbf{x} = \\mathbf{0}$ when all phases are zero, $\\phi_i(t)=0$. At this point, $f(\\mathbf{0}, 0) = \\cos(0) + \\cos(0) + \\cos(0) = 3$, the global maximum.\n\nDue to phase noise, the phases $\\phi_i(t)$ are small, non-zero random variables. This shifts the location of the maximum firing rate from $\\mathbf{x}=\\mathbf{0}$ to a new position $\\delta\\mathbf{x}(t)$. The location of a maximum is found by setting the gradient of the firing rate function with respect to position to zero:\n$$\n\\nabla f(\\mathbf{x},t) = \\frac{\\partial}{\\partial\\mathbf{x}} \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)) = -\\sum_{i=1}^{3} \\mathbf{k}_i \\sin(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)) = \\mathbf{0}\n$$\nWe evaluate this condition at the displaced peak, $\\mathbf{x} = \\delta\\mathbf{x}(t)$:\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i \\sin(\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)) = \\mathbf{0}\n$$\nThe problem specifies that we should use a first-order approximation for small $\\delta\\mathbf{x}(t)$ and small $\\phi_i(t)$. The argument of the sine function, $\\theta_i = \\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)$, is therefore a small quantity. Using the small-angle approximation $\\sin(\\theta) \\approx \\theta$, the stationarity condition becomes:\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i \\big(\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)\\big) = \\mathbf{0}\n$$\nThis equation can be rearranged to solve for $\\delta\\mathbf{x}(t)$:\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i (\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t)) + \\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t) = \\mathbf{0}\n$$\nThe first term can be written using matrix notation. Let $\\delta\\mathbf{x}(t)$ be a column vector. The term $\\mathbf{k}_i (\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t))$ is equivalent to $(\\mathbf{k}_i \\mathbf{k}_i^T) \\delta\\mathbf{x}(t)$, where $\\mathbf{k}_i \\mathbf{k}_i^T$ is an outer product, resulting in a $2 \\times 2$ matrix. The equation becomes:\n$$\n\\left(\\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T\\right) \\delta\\mathbf{x}(t) = -\\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t)\n$$\nLet's define the matrix $M = \\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T$. To calculate $M$, we must define the wavevectors $\\mathbf{k}_i$. They have equal magnitude $k$ and are arranged to form a hexagonal lattice. A standard choice for the orientations that generates such a pattern and satisfies the symmetry requirements (such as producing an isotropic Hessian matrix) is to have the vectors separated by $120^\\circ$. Let us select orientations $0^{\\circ}$, $120^{\\circ}$, and $240^{\\circ}$. Let $k$ be the magnitude of each vector.\n$$\n\\mathbf{k}_1 = k \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{k}_2 = k \\begin{pmatrix} \\cos(120^{\\circ}) \\\\ \\sin(120^{\\circ}) \\end{pmatrix} = k \\begin{pmatrix} -1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}, \\quad \\mathbf{k}_3 = k \\begin{pmatrix} \\cos(240^{\\circ}) \\\\ \\sin(240^{\\circ}) \\end{pmatrix} = k \\begin{pmatrix} -1/2 \\\\ -\\sqrt{3}/2 \\end{pmatrix}\n$$\nNow we compute the matrix $M$:\n$$\nM = k^2 \\left[ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\end{pmatrix} + \\begin{pmatrix} -1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}\\begin{pmatrix} -1/2 & \\sqrt{3}/2 \\end{pmatrix} + \\begin{pmatrix} -1/2 \\\\ -\\sqrt{3}/2 \\end{pmatrix}\\begin{pmatrix} -1/2 & -\\sqrt{3}/2 \\end{pmatrix} \\right]\n$$\n$$\nM = k^2 \\left[ \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 1/4 & -\\sqrt{3}/4 \\\\ -\\sqrt{3}/4 & 3/4 \\end{pmatrix} + \\begin{pmatrix} 1/4 & \\sqrt{3}/4 \\\\ \\sqrt{3}/4 & 3/4 \\end{pmatrix} \\right] = k^2 \\begin{pmatrix} 1+1/4+1/4 & 0 \\\\ 0 & 0+3/4+3/4 \\end{pmatrix} = k^2 \\begin{pmatrix} 3/2 & 0 \\\\ 0 & 3/2 \\end{pmatrix} = \\frac{3}{2}k^2 I\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. The matrix $M$ is isotropic (a scalar multiple of the identity), which confirms the appropriateness of this vector configuration. The result for $M$ is robust to other standard choices of vectors generating a hexagonal pattern, despite the minor ambiguity in the \"separated by $60^{\\circ}$\" wording.\n\nThe matrix inverse is $M^{-1} = \\frac{2}{3k^2}I$. We can now solve for the displacement vector $\\delta\\mathbf{x}(t)$:\n$$\n\\delta\\mathbf{x}(t) = -M^{-1} \\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t) = -\\frac{2}{3k^2} \\sum_{i=1}^{3} \\phi_i(t) \\mathbf{k}_i\n$$\nThe problem asks for the variance of this displacement, $\\sigma^2(t)$. This is given by the diagonal elements of the covariance matrix $\\mathrm{Cov}(\\delta\\mathbf{x}) = \\mathrm{E}[\\delta\\mathbf{x} \\delta\\mathbf{x}^T]$. The problem states the noise is a zero-mean process, so we assume $\\mathrm{E}[\\phi_i(t)]=0$ for all $i$. This implies $\\mathrm{E}[\\delta\\mathbf{x}(t)] = \\mathbf{0}$.\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\mathrm{E}\\left[ \\left(-\\frac{2}{3k^2} \\sum_{i=1}^{3} \\phi_i \\mathbf{k}_i\\right) \\left(-\\frac{2}{3k^2} \\sum_{j=1}^{3} \\phi_j \\mathbf{k}_j\\right)^T \\right] = \\left(\\frac{2}{3k^2}\\right)^2 \\mathrm{E}\\left[ \\left(\\sum_{i=1}^{3} \\phi_i \\mathbf{k}_i\\right) \\left(\\sum_{j=1}^{3} \\phi_j \\mathbf{k}_j^T\\right) \\right]\n$$\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{4}{9k^4} \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\mathrm{E}[\\phi_i \\phi_j] \\mathbf{k}_i \\mathbf{k}_j^T\n$$\nThe phases $\\phi_i(t)$ are independent, so $\\mathrm{E}[\\phi_i \\phi_j] = 0$ for $i \\neq j$. For $i=j$, $\\mathrm{E}[\\phi_i^2] = \\mathrm{Var}(\\phi_i) + (\\mathrm{E}[\\phi_i])^2 = \\mathrm{Var}(\\phi_i)$. The problem states that the phase processes are identically distributed with $\\mathrm{Var}(\\phi_i(t)) = 2Dt$. Thus, $\\mathrm{E}[\\phi_i \\phi_j] = \\delta_{ij} (2Dt)$.\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{4}{9k^4} \\sum_{i=1}^{3} (2Dt) \\mathbf{k}_i \\mathbf{k}_i^T = \\frac{8Dt}{9k^4} \\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T = \\frac{8Dt}{9k^4} M\n$$\nSubstituting $M = \\frac{3}{2}k^2 I$:\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{8Dt}{9k^4} \\left(\\frac{3}{2}k^2 I\\right) = \\frac{12Dt k^2}{9k^4} I = \\frac{4Dt}{3k^2} I\n$$\nThe covariance matrix is $\\mathrm{Cov}(\\delta\\mathbf{x}) = \\begin{pmatrix} \\sigma_x^2 & 0 \\\\ 0 & \\sigma_y^2 \\end{pmatrix} = \\frac{4Dt}{3k^2} I$.\nThe isotropic spatial variance $\\sigma^2(t)$ is the common variance along each axis, so $\\sigma^2(t) = \\sigma_x^2 = \\sigma_y^2$.\n$$\n\\sigma^2(t) = \\frac{4Dt}{3k^2}\n$$\nFinally, we substitute the given relation for the wavenumber $k$ in terms of the grid spatial period $\\lambda$: $k = \\frac{2\\pi}{\\lambda}$.\n$$\n\\sigma^2(t) = \\frac{4Dt}{3 \\left(\\frac{2\\pi}{\\lambda}\\right)^2} = \\frac{4Dt}{3 \\frac{4\\pi^2}{\\lambda^2}} = \\frac{4Dt\\lambda^2}{12\\pi^2}\n$$\nSimplifying the expression gives the final result for the spatial variance:\n$$\n\\sigma^2(t) = \\frac{Dt\\lambda^2}{3\\pi^2}\n$$\nThe units are consistent: $D$ has units of $t^{-1}$ since $\\mathrm{Var}(\\phi)$ is dimensionless. Thus, $Dt$ is dimensionless, and $\\sigma^2(t)$ has units of $\\lambda^2$, which is area, as required for a spatial variance.",
            "answer": "$$ \\boxed{ \\frac{D t \\lambda^{2}}{3 \\pi^{2}} } $$"
        }
    ]
}