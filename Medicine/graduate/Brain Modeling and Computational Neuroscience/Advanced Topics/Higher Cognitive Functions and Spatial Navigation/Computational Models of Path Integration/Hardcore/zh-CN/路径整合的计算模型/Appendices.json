{
    "hands_on_practices": [
        {
            "introduction": "为了奠定坚实的基础，我们的第一个练习将探讨路径积分的基本几何学原理。虽然将位移矢量简单相加似乎很直观，但本练习揭示了一个关键的复杂性：在现实世界中，旋转和平移操作是不可交换的。通过计算同一组运动在两种不同顺序下的轨迹，您将具体地证明这种非交换性，并理解为何操作顺序对精确的位置追踪至关重要 。",
            "id": "3971833",
            "problem": "考虑一个简化的平面内异体中心姿态的路径整合模块，该模块被建模为二维特殊欧几里得群 (SE(2)) 的元素。动物的姿态由位置 $(x,y)$（单位为米）和朝向角 $\\theta$（单位为弧度）表示。假设采用分段恒定控制：在每一步中，首先通过旋转角度 $\\Delta \\theta$ 来更新朝向，然后沿着身体前向轴以恒定速度 $s$ 进行持续时间为 $T$ 的平移，产生大小为 $d = sT$ 的位移。使用以下运动学基础：世界坐标系中的平移速度是身体前向速度根据当前朝向的投影，且旋转以加法方式更新朝向。\n\n形式上：\n- 在朝向为 $\\theta$ 时，沿身体前向轴进行大小为 $d$ 的平移所产生的世界坐标系位移为 $\\Delta x = d \\cos(\\theta)$ 和 $\\Delta y = d \\sin(\\theta)$。\n- 通过旋转 $\\Delta \\theta$ 进行的朝向更新为 $\\theta \\leftarrow \\theta + \\Delta \\theta$。\n\n智能体从 $(x_0,y_0)=(0,0)$ 开始，初始朝向为 $\\theta_0 = 0$。它执行以下分段恒定控制序列：\n\n段落 $1$：旋转 $\\Delta \\theta_1 = \\pi/6$，然后以速度 $s_1 = 0.5$ m/s 平移，持续时间 $T_1 = 4$ s。\n\n段落 $2$：旋转和平移有两种顺序的变体：\n- 变体 A：旋转 $\\Delta \\theta_2 = -\\pi/3$，然后以速度 $s_2 = 1.2$ m/s 平移，持续时间 $T_2 = 2$ s。\n- 变体 B：首先以当前朝向、同样的速度 $s_2$ 和持续时间 $T_2$ 进行平移，然后旋转 $\\Delta \\theta_2 = -\\pi/3$。\n\n段落 $3$：旋转 $\\Delta \\theta_3 = \\arctan(1/2)$，然后以速度 $s_3 = 0.8$ m/s 平移，持续时间 $T_3 = 5$ s。\n\n假设所有旋转都是在平移之间发生的瞬时朝向更新，所有平移都沿着瞬时的身体前向轴进行。仅使用上述运动学基础，计算分别通过连接变体 A 和变体 B 中的操作所产生的精确最终位置 $(x_A,y_A)$ 和 $(x_B,y_B)$。然后，计算这两个最终位置之间的欧几里得距离，以证明 SE(2) 中旋转和平移的非交换性。\n\n所有角度均使用弧度。最终的欧几里得距离以米为单位表示。提供精确值，不要四舍五入。",
            "solution": "问题经过验证。\n\n### 第 1 步：提取已知条件\n- **模型**：特殊欧几里得群 $SE(2)$ 中的姿态路径整合。\n- **状态**：位置 $(x, y)$（单位：米），朝向角 $\\theta$（单位：弧度）。\n- **初始状态**：$(x_0, y_0) = (0, 0)$，$\\theta_0 = 0$。\n- **运动学规则**：\n  - 旋转：$\\theta \\leftarrow \\theta + \\Delta \\theta$。\n  - 平移：位移大小 $d = sT$。世界坐标系位移为 $\\Delta x = d \\cos(\\theta)$ 和 $\\Delta y = d \\sin(\\theta)$。\n- **控制序列**：\n  - **段落 1**：旋转 $\\Delta \\theta_1 = \\pi/6$。以速度 $s_1 = 0.5$ m/s 平移，持续时间 $T_1 = 4$ s。\n  - **段落 2，变体 A**：旋转 $\\Delta \\theta_2 = -\\pi/3$。以速度 $s_2 = 1.2$ m/s 平移，持续时间 $T_2 = 2$ s。\n  - **段落 2，变体 B**：以速度 $s_2 = 1.2$ m/s 平移，持续时间 $T_2 = 2$ s。然后旋转 $\\Delta \\theta_2 = -\\pi/3$。\n  - **段落 3**：旋转 $\\Delta \\theta_3 = \\arctan(1/2)$。以速度 $s_3 = 0.8$ m/s 平移，持续时间 $T_3 = 5$ s。\n- **任务**：\n  1. 计算使用变体 A 的路径的最终位置 $(x_A, y_A)$。\n  2. 计算使用变体 B 的路径的最终位置 $(x_B, y_B)$。\n  3. 计算 $(x_A, y_A)$ 和 $(x_B, y_B)$ 之间的欧几里得距离。\n  4. 提供精确值。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学性或事实性**：该问题在科学上是合理的。它使用了一个标准的平面内刚体运动的运动学模型，这是机器人学、物理学和计算神经科学中的一个基本概念。$SE(2)$ 的数学框架是合适的。\n- **适定性**：该问题是适定的。它提供了所有必要的初始条件和控制参数。操作序列是确定性的，会导向唯一的解。\n- **客观性**：该问题以精确、客观的数学语言陈述。\n- **完整性和一致性**：该问题是自洽的，没有矛盾。所有需要的数据都已提供。\n- **现实性**：物理参数（速度、持续时间）是符合现实的。\n- **结构性**：该问题结构清晰，要求一个具体的、可计算的结果。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n***\n\n解题过程是为每条路径依次计算智能体的状态 $(x, y, \\theta)$。首先，我们计算每个段落的位移大小。\n段落 1 的位移：$d_1 = s_1 T_1 = (0.5 \\text{ m/s}) \\cdot (4 \\text{ s}) = 2$ 米。\n段落 2 的位移：$d_2 = s_2 T_2 = (1.2 \\text{ m/s}) \\cdot (2 \\text{ s}) = 2.4$ 米，即 $\\frac{12}{5}$ 米。\n段落 3 的位移：$d_3 = s_3 T_3 = (0.8 \\text{ m/s}) \\cdot (5 \\text{ s}) = 4$ 米。\n\n初始状态为 $(x_0, y_0, \\theta_0) = (0, 0, 0)$。\n\n**路径 A 的状态演化**\n\n1.  **段落 1 之后（先旋转，后平移）：**\n    首先更新朝向：$\\theta'_1 = \\theta_0 + \\Delta \\theta_1 = 0 + \\frac{\\pi}{6} = \\frac{\\pi}{6}$。\n    在这个新朝向上进行平移：\n    $\\Delta x_1 = d_1 \\cos(\\theta'_1) = 2 \\cos(\\frac{\\pi}{6}) = 2 \\cdot \\frac{\\sqrt{3}}{2} = \\sqrt{3}$。\n    $\\Delta y_1 = d_1 \\sin(\\theta'_1) = 2 \\sin(\\frac{\\pi}{6}) = 2 \\cdot \\frac{1}{2} = 1$。\n    段落 1 之后的状态是 $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$。\n\n2.  **段落 2，变体 A 之后（先旋转，后平移）：**\n    从 $(x_1, y_1, \\theta_1)$ 开始，更新朝向：$\\theta'_{2A} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$。\n    在这个新朝向上进行平移：\n    $\\Delta x_{2A} = d_2 \\cos(\\theta'_{2A}) = \\frac{12}{5} \\cos(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$。\n    $\\Delta y_{2A} = d_2 \\sin(\\theta'_{2A}) = \\frac{12}{5} \\sin(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot (-\\frac{1}{2}) = -\\frac{6}{5}$。\n    位置更新为：\n    $x_{2A} = x_1 + \\Delta x_{2A} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{5\\sqrt{3} + 6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$。\n    $y_{2A} = y_1 + \\Delta y_{2A} = 1 - \\frac{6}{5} = -\\frac{1}{5}$。\n    段落 2A 之后的状态是 $(x_{2A}, y_{2A}, \\theta_{2A}) = (\\frac{11\\sqrt{3}}{5}, -\\frac{1}{5}, -\\frac{\\pi}{6})$。\n\n3.  **段落 3 之后（接续变体 A）：**\n    更新朝向：$\\theta'_{3A} = \\theta_{2A} + \\Delta \\theta_3 = -\\frac{\\pi}{6} + \\arctan(\\frac{1}{2})$。\n    为了计算位移，我们需要 $\\cos(\\theta'_{3A})$ 和 $\\sin(\\theta'_{3A})$。设 $\\alpha = \\arctan(\\frac{1}{2})$。一个对边为 1、邻边为 2 的直角三角形，其斜边为 $\\sqrt{1^2+2^2}=\\sqrt{5}$。因此，$\\cos(\\alpha) = \\frac{2}{\\sqrt{5}}$ 且 $\\sin(\\alpha) = \\frac{1}{\\sqrt{5}}$。\n    使用和差角公式：\n    $\\cos(\\theta'_{3A}) = \\cos(\\alpha - \\frac{\\pi}{6}) = \\cos(\\alpha)\\cos(\\frac{\\pi}{6}) + \\sin(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{2}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} + \\frac{1}{\\sqrt{5}}\\frac{1}{2} = \\frac{2\\sqrt{3}+1}{2\\sqrt{5}}$。\n    $\\sin(\\theta'_{3A}) = \\sin(\\alpha - \\frac{\\pi}{6}) = \\sin(\\alpha)\\cos(\\frac{\\pi}{6}) - \\cos(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{1}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} - \\frac{2}{\\sqrt{5}}\\frac{1}{2} = \\frac{\\sqrt{3}-2}{2\\sqrt{5}}$。\n    段落 3 的位移是：\n    $\\Delta x_{3A} = d_3 \\cos(\\theta'_{3A}) = 4 \\cdot \\frac{2\\sqrt{3}+1}{2\\sqrt{5}} = \\frac{2(2\\sqrt{3}+1)}{\\sqrt{5}} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$。\n    $\\Delta y_{3A} = d_3 \\sin(\\theta'_{3A}) = 4 \\cdot \\frac{\\sqrt{3}-2}{2\\sqrt{5}} = \\frac{2(\\sqrt{3}-2)}{\\sqrt{5}} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$。\n    路径 A 的最终位置为 $(x_A, y_A)$：\n    $x_A = x_{2A} + \\Delta x_{3A} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$。\n    $y_A = y_{2A} + \\Delta y_{3A} = -\\frac{1}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$。\n\n**路径 B 的状态演化**\n\n1.  **段落 1 之后（先旋转，后平移）：**\n    这一段与路径 A 相同。状态为 $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$。\n\n2.  **段落 2，变体 B 之后（先平移，后旋转）：**\n    从 $(x_1, y_1, \\theta_1)$ 开始，首先使用当前朝向 $\\theta_1$ 进行平移：\n    $\\Delta x_{2B} = d_2 \\cos(\\theta_1) = \\frac{12}{5} \\cos(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$。\n    $\\Delta y_{2B} = d_2 \\sin(\\theta_1) = \\frac{12}{5} \\sin(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{1}{2} = \\frac{6}{5}$。\n    位置更新为：\n    $x_{2B} = x_1 + \\Delta x_{2B} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$。\n    $y_{2B} = y_1 + \\Delta y_{2B} = 1 + \\frac{6}{5} = \\frac{11}{5}$。\n    然后，更新朝向：\n    $\\theta_{2B} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$。\n    段落 2B 之后的状态是 $(x_{2B}, y_{2B}, \\theta_{2B}) = (\\frac{11\\sqrt{3}}{5}, \\frac{11}{5}, -\\frac{\\pi}{6})$。\n\n3.  **段落 3 之后（接续变体 B）：**\n    进入此段落时的朝向为 $\\theta_{2B} = -\\frac{\\pi}{6}$，与 $\\theta_{2A}$ 相同。由于段落 3 涉及相同的操作（旋转 $\\Delta\\theta_3$，平移 $d_3$），位移向量 $(\\Delta x_{3B}, \\Delta y_{3B})$ 将与 $(\\Delta x_{3A}, \\Delta y_{3A})$ 相同。\n    $\\Delta x_{3B} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$。\n    $\\Delta y_{3B} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$。\n    路径 B 的最终位置为 $(x_B, y_B)$：\n    $x_B = x_{2B} + \\Delta x_{3B} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$。\n    $y_B = y_{2B} + \\Delta y_{3B} = \\frac{11}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$。\n\n**欧几里得距离计算**\n\n最终位置是：\n$P_A = (x_A, y_A) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n$P_B = (x_B, y_B) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n\n我们计算这些位置之间的差值来求得距离。\n$\\Delta x_{final} = x_B - x_A = 0$。这是由于角度 $\\theta_1 = \\pi/6$ 和 $\\Delta\\theta_2 = -\\pi/3$ 的特定选择导致的，这使得 $\\cos(\\theta_1) = \\cos(\\theta_1+\\Delta\\theta_2)$。\n$\\Delta y_{final} = y_B - y_A = \\left( \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) - \\left( \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) = \\frac{11 - (-1)}{5} = \\frac{12}{5}$。\n\n欧几里得距离 $D$ 是差向量 $(\\Delta x_{final}, \\Delta y_{final})$ 的模长：\n$D = \\sqrt{(\\Delta x_{final})^2 + (\\Delta y_{final})^2} = \\sqrt{0^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{12}{5}$。\n\n这个非零距离证明了 $SE(2)$ 中旋转和平移操作的非交换性。最终姿态取决于这些操作的应用顺序。\n距离为 $\\frac{12}{5}$ 米，即 $2.4$ 米。",
            "answer": "$$\\boxed{\\frac{12}{5}}$$"
        },
        {
            "introduction": "在建立了基本的运动学模型后，我们现在探讨一个更贴近现实的场景：积分过程并非完美无缺。本练习将研究里程计中的一种系统性误差——即对移动距离的持续高估——如何影响动物返回起点的能力。通过推导最终的归巢误差，您将深入理解内部计算的偏差如何表现为可预测的行为模式 。",
            "id": "3971882",
            "problem": "考虑一个平面智能体通过路径整合返回位于原点的巢穴。该智能体从巢穴出发，首先沿着与 $x$ 轴正方向对齐的第一段直线路径移动，长度为 $L_{1}$，然后瞬时逆时针转过一个角度 $\\theta$（以弧度为单位），并沿着第二段长度为 $L_{2}$ 的直线路径移动。完成这两段路程后，该智能体试图通过沿着一条等于其内部计算出的归巢向量的第三段直线路径直接返回巢穴。\n\n假设以下基本前提：\n- 平面内的位移在一个异心坐标系中作为向量线性相加，旋转由旋转矩阵 $R(\\phi) = \\begin{pmatrix}\\cos \\phi  -\\sin \\phi \\\\ \\sin \\phi  \\cos \\phi\\end{pmatrix}$ 表示。\n- 路径整合累加所经过位移的向量和，形成一个从当前位置指向原点的内部归巢向量。\n- 智能体的角度估计是完美的（没有航向偏差），且在顶点处的旋转是瞬时的。\n- 距离估计中存在一个系统性的里程计增益：每段行进的距离 $d$ 在内部被编码为 $(1+\\gamma)d$，其中 $\\gamma$ 是一个小的常数。不存在其他噪声或泄漏源。\n\n设智能体在第二段路程结束时，使用其内部归巢向量来生成第三段路程，即在平面上精确地按照该向量移动。请根据第一性原理及上述假设，推导智能体在完成第三段路程后相对于巢穴的最终偏离向量（其相对于原点的最终位置），并用 $L_{1}$、$L_{2}$、$\\theta$ 和 $\\gamma$ 表示。请将您的最终答案表示为包含 $x$ 和 $y$ 分量的单个 $1 \\times 2$ 行向量。无需进行数值计算，也无需单位。角度以弧度为单位。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它在路径整合计算模型的既定框架内提供了一个清晰、可形式化的场景。所有必要的参数和条件都已指明，没有内部矛盾或歧义。因此，我们可以进行形式化推导。\n\n智能体的运动可以使用二维笛卡尔坐标系中的向量代数来描述，其中巢穴位于原点，$\\vec{p}_{\\text{nest}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。问题要求推导智能体的最终位置向量，该向量代表了其与巢穴的偏离。\n\n首先，我们确定智能体在完成其旅程的前两段后所处的实际物理位置。设 $\\vec{P}_{\\text{actual}}$ 为该位置向量。\n\n旅程的第一段是沿 $x$ 轴正方向的位移，长度为 $L_1$。相应的位移向量 $\\vec{d}_1$ 为：\n$$\n\\vec{d}_1 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix}\n$$\n智能体从原点出发，因此在第一段路程后的位置为 $\\vec{p}_1 = \\vec{d}_1$。\n\n然后，智能体逆时针转过一个角度 $\\theta$，并移动距离 $L_2$。第二段路程的方向由单位向量 $\\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$ 给出。因此，第二段路程的位移向量 $\\vec{d}_2$ 为：\n$$\n\\vec{d}_2 = L_2 \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\n智能体在第二段路程后的实际位置 $\\vec{P}_{\\text{actual}}$ 是前两段路程位移的向量和：\n$$\n\\vec{P}_{\\text{actual}} = \\vec{d}_1 + \\vec{d}_2 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\n\n接下来，我们计算智能体内部计算出的归巢向量 $\\vec{H}$。根据问题描述，路径整合会累加所经过位移的向量和。然而，存在一个系统性的里程计增益 $\\gamma$，使得任何行进的距离 $d$ 在内部被编码为 $(1+\\gamma)d$。由于智能体的航向估计是完美的，所以编码位移的方向是正确的。\n\n第一段路程的内部编码位移 $\\vec{d}'_1$ 的大小为 $(1+\\gamma)L_1$：\n$$\n\\vec{d}'_1 = (1+\\gamma) \\vec{d}_1 = \\begin{pmatrix} (1+\\gamma)L_1 \\\\ 0 \\end{pmatrix}\n$$\n第二段路程的内部编码位移 $\\vec{d}'_2$ 的大小为 $(1+\\gamma)L_2$：\n$$\n\\vec{d}'_2 = (1+\\gamma) \\vec{d}_2 = \\begin{pmatrix} (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\n智能体的总积分位移向量 $\\vec{D}_{\\text{integrated}}$ 是这些编码位移的和：\n$$\n\\vec{D}_{\\text{integrated}} = \\vec{d}'_1 + \\vec{d}'_2 = \\begin{pmatrix} (1+\\gamma)L_1 + (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\n这可以被因式分解为：\n$$\n\\vec{D}_{\\text{integrated}} = (1+\\gamma) \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = (1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\n内部归巢向量 $\\vec{H}$ 定义为从当前位置指向原点的向量。因此，它是总积分位移向量的负值：\n$$\n\\vec{H} = -\\vec{D}_{\\text{integrated}} = -(1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\n\n最后，我们确定智能体的最终位置。问题陈述，智能体沿着第三段路程移动，该路程完全等于其内部计算的归巢向量。这意味着第三段路程的位移 $\\vec{d}_3$ 等于 $\\vec{H}$。\n$$\n\\vec{d}_3 = \\vec{H}\n$$\n智能体的最终位置 $\\vec{P}_{\\text{final}}$ 是其在第二段路程后的位置 $\\vec{P}_{\\text{actual}}$ 加上第三段路程的位移 $\\vec{d}_3$。\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + \\vec{d}_3\n$$\n代入 $\\vec{P}_{\\text{actual}}$ 和 $\\vec{d}_3 = \\vec{H}$ 的表达式：\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + (-(1+\\gamma)\\vec{P}_{\\text{actual}})\n$$\n$$\n\\vec{P}_{\\text{final}} = (1 - (1+\\gamma))\\vec{P}_{\\text{actual}}\n$$\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\vec{P}_{\\text{actual}}\n$$\n代入 $\\vec{P}_{\\text{actual}}$ 的分量：\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta) \\\\ -\\gamma L_2 \\sin\\theta \\end{pmatrix}\n$$\n这个向量 $\\vec{P}_{\\text{final}}$ 代表了智能体与巢穴的最终偏离。问题要求将其表示为 $1 \\times 2$ 的行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta)  -\\gamma L_2 \\sin\\theta \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "我们的最后一个练习将深入探讨一个具体且极具影响力的路径积分神经假说：网格细胞的振荡器干涉（OI）模型。这个高级练习旨在分析底层神经振荡器层面的噪声如何转化为空间表征本身的不确定性。通过推导相位扩散与网格场展宽之间的关系，您将把生物物理噪声源与神经编码的功能稳定性联系起来 。",
            "id": "3971844",
            "problem": "考虑一个二维六边形网格细胞的振荡干涉（OI）模型。理想的瞬时发放率被建模为三个平面波分量的叠加，\n$$\nr(\\mathbf{x},t) \\propto \\sum_{i=1}^{3} \\cos\\!\\big(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)\\big),\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 是位置，$\\mathbf{k}_i \\in \\mathbb{R}^{2}$ 是大小相等（为 $k$）且相隔 $60^{\\circ}$ 的波矢量，$\\phi_i(t)$ 是三个振荡器的相位。在路径积分中，速度和相位更新之间的关系由以下运动学恒等式给出\n$$\n\\frac{d}{dt}\\phi_i(t) = \\mathbf{k}_i \\cdot \\mathbf{v}(t),\n$$\n振荡器频率噪声被建模为一个产生相位扩散的零均值高斯过程\n$$\n\\mathrm{Var}\\!\\big(\\phi_i(t)\\big) = 2 D t,\n$$\n其中 $D$ 是扩散常数，$t$ 是时间。假设这三个相位过程是独立同分布的，并且 $\\mathbf{k}_i$ 的方向角度以度为单位，而相位 $\\phi_i(t)$ 以弧度为单位。假设相位偏差很小，并在理想网格场中心附近对平稳性条件进行线性化。\n\n设网格空间周期为 $\\lambda$，因此 $k = \\frac{2\\pi}{\\lambda}$。将网格场中心位移 $\\delta \\mathbf{x}(t)$ 定义为由随机相位 $\\phi_i(t)$ 引起的 $r(\\mathbf{x},t)$ 局部最大值的偏移。仅使用上述基本关系以及对小的 $\\delta \\mathbf{x}(t)$ 和小的 $\\phi_i(t)$ 有效的一阶近似，推导出场中心位移的各向同性空间方差 $\\sigma^{2}(t)$，即 $\\delta \\mathbf{x}(t)$ 沿每个坐标轴的共同方差，用 $D$、$t$ 和 $\\lambda$ 表示。\n\n将您的最终答案表示为 $\\sigma^{2}(t)$ 的单个闭式解析表达式，单位为平方米。无需四舍五入。$\\phi_i(t)$ 的角度必须以弧度处理；$\\mathbf{k}_i$ 的方向以度为单位，但除了通过 $60^{\\circ}$ 对称性外，它们不会出现在最终表达式中。",
            "solution": "问题要求计算网格细胞的振荡干涉（OI）模型中网格场中心位移的各向同性空间方差 $\\sigma^{2}(t)$。推导过程将通过在小相位噪声下对发放率函数最大值的条件进行线性化来进行。\n\n发放率由下式给出\n$$\nr(\\mathbf{x},t) \\propto f(\\mathbf{x},t) = \\sum_{i=1}^{3} \\cos\\!\\big(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)\\big)\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^2$ 是位置，$\\mathbf{k}_i$ 是波矢量，$\\phi_i(t)$ 是随时间变化的随机相位。一个理想的网格场中心，其发放率达到最大值，出现在余弦函数的参数是 $2\\pi$ 的整数倍时。我们可以选择一个坐标系，使得当所有相位都为零（$\\phi_i(t)=0$）时，场中心位于 $\\mathbf{x} = \\mathbf{0}$。在这一点，$f(\\mathbf{0}, 0) = \\cos(0) + \\cos(0) + \\cos(0) = 3$，为全局最大值。\n\n由于相位噪声，相位 $\\phi_i(t)$ 是小的、非零的随机变量。这将最大发放率的位置从 $\\mathbf{x}=\\mathbf{0}$ 移动到一个新位置 $\\delta\\mathbf{x}(t)$。最大值的位置可以通过将发放率函数对位置的梯度设为零来找到：\n$$\n\\nabla f(\\mathbf{x},t) = \\frac{\\partial}{\\partial\\mathbf{x}} \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)) = -\\sum_{i=1}^{3} \\mathbf{k}_i \\sin(\\mathbf{k}_i \\cdot \\mathbf{x} + \\phi_i(t)) = \\mathbf{0}\n$$\n我们在位移后的峰值处 $\\mathbf{x} = \\delta\\mathbf{x}(t)$ 评估此条件：\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i \\sin(\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)) = \\mathbf{0}\n$$\n问题指明我们应该对小的 $\\delta\\mathbf{x}(t)$ 和小的 $\\phi_i(t)$ 使用一阶近似。因此，正弦函数的参数 $\\theta_i = \\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)$ 是一个小量。使用小角度近似 $\\sin(\\theta) \\approx \\theta$，平稳性条件变为：\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i \\big(\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t) + \\phi_i(t)\\big) = \\mathbf{0}\n$$\n这个方程可以重新整理以求解 $\\delta\\mathbf{x}(t)$：\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i (\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t)) + \\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t) = \\mathbf{0}\n$$\n第一项可以用矩阵表示法写出。设 $\\delta\\mathbf{x}(t)$ 是一个列向量。项 $\\mathbf{k}_i (\\mathbf{k}_i \\cdot \\delta\\mathbf{x}(t))$ 等价于 $(\\mathbf{k}_i \\mathbf{k}_i^T) \\delta\\mathbf{x}(t)$，其中 $\\mathbf{k}_i \\mathbf{k}_i^T$ 是一个外积，结果是一个 $2 \\times 2$ 矩阵。方程变为：\n$$\n\\left(\\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T\\right) \\delta\\mathbf{x}(t) = -\\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t)\n$$\n我们定义矩阵 $M = \\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T$。为了计算 $M$，我们必须定义波矢量 $\\mathbf{k}_i$。它们具有相等的大小 $k$，并排列成六边形晶格。生成这种模式并满足对称性要求（例如产生各向同性的Hessian矩阵）的一个标准选择是使矢量相隔 $120^\\circ$。我们选择方向 $0^{\\circ}$、$120^{\\circ}$ 和 $240^{\\circ}$。设 $k$ 是每个矢量的大小。\n$$\n\\mathbf{k}_1 = k \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{k}_2 = k \\begin{pmatrix} \\cos(120^{\\circ}) \\\\ \\sin(120^{\\circ}) \\end{pmatrix} = k \\begin{pmatrix} -1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}, \\quad \\mathbf{k}_3 = k \\begin{pmatrix} \\cos(240^{\\circ}) \\\\ \\sin(240^{\\circ}) \\end{pmatrix} = k \\begin{pmatrix} -1/2 \\\\ -\\sqrt{3}/2 \\end{pmatrix}\n$$\n现在我们计算矩阵 $M$：\n$$\nM = k^2 \\left[ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} 1  0 \\end{pmatrix} + \\begin{pmatrix} -1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}\\begin{pmatrix} -1/2  \\sqrt{3}/2 \\end{pmatrix} + \\begin{pmatrix} -1/2 \\\\ -\\sqrt{3}/2 \\end{pmatrix}\\begin{pmatrix} -1/2  -\\sqrt{3}/2 \\end{pmatrix} \\right]\n$$\n$$\nM = k^2 \\left[ \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix} 1/4  -\\sqrt{3}/4 \\\\ -\\sqrt{3}/4  3/4 \\end{pmatrix} + \\begin{pmatrix} 1/4  \\sqrt{3}/4 \\\\ \\sqrt{3}/4  3/4 \\end{pmatrix} \\right] = k^2 \\begin{pmatrix} 1+1/4+1/4  0 \\\\ 0  0+3/4+3/4 \\end{pmatrix} = k^2 \\begin{pmatrix} 3/2  0 \\\\ 0  3/2 \\end{pmatrix} = \\frac{3}{2}k^2 I\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。矩阵 $M$ 是各向同性的（单位矩阵的标量倍数），这证实了该矢量配置的适当性。尽管“相隔 $60^{\\circ}$”的措辞存在轻微的模糊性，$M$ 的结果对于生成六边形模式的其他标准矢量选择是稳健的。\n\n矩阵的逆为 $M^{-1} = \\frac{2}{3k^2}I$。现在我们可以求解位移矢量 $\\delta\\mathbf{x}(t)$：\n$$\n\\delta\\mathbf{x}(t) = -M^{-1} \\sum_{i=1}^{3} \\mathbf{k}_i \\phi_i(t) = -\\frac{2}{3k^2} \\sum_{i=1}^{3} \\phi_i(t) \\mathbf{k}_i\n$$\n问题要求计算此位移的方差 $\\sigma^2(t)$。这由协方差矩阵 $\\mathrm{Cov}(\\delta\\mathbf{x}) = \\mathrm{E}[\\delta\\mathbf{x} \\delta\\mathbf{x}^T]$ 的对角线元素给出。问题指出噪声是一个零均值过程，因此我们假设对所有 $i$ 都有 $\\mathrm{E}[\\phi_i(t)]=0$。这意味着 $\\mathrm{E}[\\delta\\mathbf{x}(t)] = \\mathbf{0}$。\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\mathrm{E}\\left[ \\left(-\\frac{2}{3k^2} \\sum_{i=1}^{3} \\phi_i \\mathbf{k}_i\\right) \\left(-\\frac{2}{3k^2} \\sum_{j=1}^{3} \\phi_j \\mathbf{k}_j\\right)^T \\right] = \\left(\\frac{2}{3k^2}\\right)^2 \\mathrm{E}\\left[ \\left(\\sum_{i=1}^{3} \\phi_i \\mathbf{k}_i\\right) \\left(\\sum_{j=1}^{3} \\phi_j \\mathbf{k}_j^T\\right) \\right]\n$$\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{4}{9k^4} \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\mathrm{E}[\\phi_i \\phi_j] \\mathbf{k}_i \\mathbf{k}_j^T\n$$\n相位 $\\phi_i(t)$ 是独立的，因此当 $i \\neq j$ 时，$\\mathrm{E}[\\phi_i \\phi_j] = 0$。当 $i=j$ 时，$\\mathrm{E}[\\phi_i^2] = \\mathrm{Var}(\\phi_i) + (\\mathrm{E}[\\phi_i])^2 = \\mathrm{Var}(\\phi_i)$。问题指出相位过程是同分布的，其方差为 $\\mathrm{Var}(\\phi_i(t)) = 2Dt$。因此，$\\mathrm{E}[\\phi_i \\phi_j] = \\delta_{ij} (2Dt)$。\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{4}{9k^4} \\sum_{i=1}^{3} (2Dt) \\mathbf{k}_i \\mathbf{k}_i^T = \\frac{8Dt}{9k^4} \\sum_{i=1}^{3} \\mathbf{k}_i \\mathbf{k}_i^T = \\frac{8Dt}{9k^4} M\n$$\n代入 $M = \\frac{3}{2}k^2 I$：\n$$\n\\mathrm{Cov}(\\delta\\mathbf{x}) = \\frac{8Dt}{9k^4} \\left(\\frac{3}{2}k^2 I\\right) = \\frac{12Dt k^2}{9k^4} I = \\frac{4Dt}{3k^2} I\n$$\n协方差矩阵为 $\\mathrm{Cov}(\\delta\\mathbf{x}) = \\begin{pmatrix} \\sigma_x^2  0 \\\\ 0  \\sigma_y^2 \\end{pmatrix} = \\frac{4Dt}{3k^2} I$。\n各向同性空间方差 $\\sigma^2(t)$ 是沿每个轴的共同方差，因此 $\\sigma^2(t) = \\sigma_x^2 = \\sigma_y^2$。\n$$\n\\sigma^2(t) = \\frac{4Dt}{3k^2}\n$$\n最后，我们将给定的波数 $k$ 与网格空间周期 $\\lambda$ 的关系式 $k = \\frac{2\\pi}{\\lambda}$ 代入：\n$$\n\\sigma^2(t) = \\frac{4Dt}{3 \\left(\\frac{2\\pi}{\\lambda}\\right)^2} = \\frac{4Dt}{3 \\frac{4\\pi^2}{\\lambda^2}} = \\frac{4Dt\\lambda^2}{12\\pi^2}\n$$\n简化表达式得到空间方差的最终结果：\n$$\n\\sigma^2(t) = \\frac{Dt\\lambda^2}{3\\pi^2}\n$$\n单位是一致的：由于 $\\mathrm{Var}(\\phi)$ 是无量纲的，$D$ 的单位是 $t^{-1}$。因此，$Dt$ 是无量纲的，$\\sigma^2(t)$ 的单位是 $\\lambda^2$，即面积，这符合空间方差的要求。",
            "answer": "$$ \\boxed{ \\frac{D t \\lambda^{2}}{3 \\pi^{2}} } $$"
        }
    ]
}