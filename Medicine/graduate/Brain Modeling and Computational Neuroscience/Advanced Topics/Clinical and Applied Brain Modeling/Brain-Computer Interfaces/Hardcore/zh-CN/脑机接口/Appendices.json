{
    "hands_on_practices": [
        {
            "introduction": "在脑机接口（BCI）系统中，高质量的神经信号是解码性能的基石。信号采集的第一步，即从电极到放大器的传输，至关重要。本练习将探讨生物电测量中的一个核心概念——阻抗匹配，通过一个简化的电路模型，你将亲手计算信号在电极-放大器接口处的衰减，从而深刻理解为何高输入阻抗放大器对于捕捉微弱的脑电信号至关重要。",
            "id": "3966620",
            "problem": "在一个使用脑电图（EEG）记录皮层电位的脑机接口（BCI）系统中，电极-组织界面在准静态条件下可以被建模为一个戴维南电压源，其开路振幅为 $V_{\\mathrm{s}}$，并与一个电极接触阻抗 $Z_{\\mathrm{s}}$ 串联。前端放大器呈现一个输入阻抗 $Z_{\\mathrm{in}}$，测量信号即取自其两端。假设系统行为是线性时不变的，并且阻抗可以被视为集总元件。使用基尔霍夫定律和欧姆定律，推导振幅衰减因子的一般表达式，该因子定义为测量振幅与源振幅之比，并用 $Z_{\\mathrm{s}}$ 和 $Z_{\\mathrm{in}}$ 表示。然后，在接触阻抗为 $1\\,\\mathrm{k}\\Omega$ 的纯电阻、放大器输入阻抗为 $10\\,\\mathrm{M}\\Omega$ 的纯电阻的情况下，计算此衰减值。将最终的衰减因子表示为一个最简形式的精确有理数，作为一个无单位的纯粹无量纲比率。无需四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **系统：** 一个使用脑电图（EEG）记录皮层电位的脑机接口（BCI）系统。\n-   **模型：** 电极-组织界面被建模为戴维南等效电路。\n-   **源：** 一个戴维南电压源，其开路振幅为 $V_{\\mathrm{s}}$，与一个电极接触阻抗 $Z_{\\mathrm{s}}$ 串联。\n-   **负载：** 一个输入阻抗为 $Z_{\\mathrm{in}}$ 的前端放大器。\n-   **测量点：** 测量信号是 $Z_{\\mathrm{in}}$ 两端的电压。\n-   **假设：** 准静态条件，线性时不变（LTI）行为，以及阻抗的集总元件模型。\n-   **基本原理：** 基尔霍夫定律和欧姆定律。\n-   **定义：** 振幅衰减因子是测量振幅与源振幅之比。\n-   **任务1：** 用 $Z_{\\mathrm{s}}$ 和 $Z_{\\mathrm{in}}$ 推导振幅衰减因子的一般表达式。\n-   **任务2：** 当 $Z_{\\mathrm{s}} = 1\\,\\mathrm{k}\\Omega$（纯电阻）和 $Z_{\\mathrm{in}} = 10\\,\\mathrm{M}\\Omega$（纯电阻）时，计算衰减因子。\n-   **要求的输出格式：** 一个最简形式的精确有理数，无量纲。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题牢固地植根于基础电路理论。使用戴维南等效电路来建模电极-放大器界面是生物仪器和电生理学（包括EEG系统）中一种标准且被广泛接受的做法。指定的阻抗值在此类应用中是现实的，因为为了最小化信号损失，通常需要低电极接触阻抗和非常高的放大器输入阻抗。\n-   **适定性：** 问题定义清晰。它要求基于标准电路模型推导一个特定量（衰减因子），然后使用给定值进行数值计算。该设置保证了唯一且有意义的解。\n-   **客观性：** 语言技术性强且精确，没有主观或含糊不清的术语。\n\n### 第3步：结论和行动\n该问题科学上合理，适定且客观。这是一个应用于生物仪器的有效电路分析问题。可以继续进行求解过程。\n\n所描述的系统构成一个简单的电路。戴维南源（由电压 $V_{\\mathrm{s}}$ 和阻抗 $Z_{\\mathrm{s}}$ 串联组成）连接到负载，即放大器输入阻抗 $Z_{\\mathrm{in}}$。这形成一个串联电路，其中 $Z_{\\mathrm{s}}$ 和 $Z_{\\mathrm{in}}$ 充当分压器。\n\n设 $V_{\\mathrm{m}}$ 为放大器输入阻抗 $Z_{\\mathrm{in}}$ 两端的测量电压。根据基尔霍夫电压定律，闭合回路中的总电压降必须等于源电压 $V_{\\mathrm{s}}$。串联电路的总阻抗是各个阻抗之和：\n$$Z_{\\mathrm{total}} = Z_{\\mathrm{s}} + Z_{\\mathrm{in}}$$\n根据欧姆定律，流过电路的电流 $I$ 由源电压除以总阻抗给出：\n$$I = \\frac{V_{\\mathrm{s}}}{Z_{\\mathrm{total}}} = \\frac{V_{\\mathrm{s}}}{Z_{\\mathrm{s}} + Z_{\\mathrm{in}}}$$\n通过对负载应用欧姆定律，可以找到输入阻抗 $Z_{\\mathrm{in}}$ 两端的测量电压 $V_{\\mathrm{m}}$：\n$$V_{\\mathrm{m}} = I \\cdot Z_{\\mathrm{in}}$$\n将电流 $I$ 的表达式代入此方程可得：\n$$V_{\\mathrm{m}} = \\left(\\frac{V_{\\mathrm{s}}}{Z_{\\mathrm{s}} + Z_{\\mathrm{in}}}\\right) Z_{\\mathrm{in}} = V_{\\mathrm{s}} \\frac{Z_{\\mathrm{in}}}{Z_{\\mathrm{s}} + Z_{\\mathrm{in}}}$$\n问题将振幅衰减因子（我们用 $A$ 表示）定义为测量振幅与源振幅之比。在LTI系统和阻抗（一般情况下为复数量）的背景下，“振幅”指的是复电压（相量）的模。因此，衰减因子 $A$ 为：\n$$A = \\frac{|V_{\\mathrm{m}}|}{|V_{\\mathrm{s}}|}$$\n代入 $V_{\\mathrm{m}}$ 和 $V_{\\mathrm{s}}$ 之间的关系：\n$$A = \\frac{\\left|V_{\\mathrm{s}} \\frac{Z_{\\mathrm{in}}}{Z_{\\mathrm{s}} + Z_{\\mathrm{in}}}\\right|}{|V_{\\mathrm{s}}|} = \\left|\\frac{Z_{\\mathrm{in}}}{Z_{\\mathrm{s}} + Z_{\\mathrm{in}}}\\right|$$\n这就是振幅衰减因子的一般表达式。\n\n问题的第二部分要求针对特定值计算此因子。给定的阻抗是纯电阻性的。因此，我们可以将复阻抗 $Z_{\\mathrm{s}}$ 和 $Z_{\\mathrm{in}}$ 分别替换为实数值电阻 $R_{\\mathrm{s}}$ 和 $R_{\\mathrm{in}}$。\n已知：\n-   源电阻, $R_{\\mathrm{s}} = 1\\,\\mathrm{k}\\Omega = 1 \\times 10^{3}\\,\\Omega$。\n-   输入电阻, $R_{\\mathrm{in}} = 10\\,\\mathrm{M}\\Omega = 10 \\times 10^{6}\\,\\Omega = 1 \\times 10^{7}\\,\\Omega$。\n\n由于电阻是正实数，表达式 $A$ 中的绝对值是多余的。衰减因子变为：\n$$A = \\frac{R_{\\mathrm{in}}}{R_{\\mathrm{s}} + R_{\\mathrm{in}}}$$\n代入数值：\n$$A = \\frac{10 \\times 10^{6}\\,\\Omega}{1 \\times 10^{3}\\,\\Omega + 10 \\times 10^{6}\\,\\Omega} = \\frac{10,000,000}{1000 + 10,000,000} = \\frac{10,000,000}{10,001,000}$$\n问题要求将此比率表示为最简形式的精确有理数。我们可以通过将分子和分母同时除以它们的最大公约数来简化分数。一个公因数是 $1000$：\n$$A = \\frac{10,000,000 \\div 1000}{10,001,000 \\div 1000} = \\frac{10000}{10001}$$\n为了确认这是否是最简形式，我们必须检查分子 $10000 = 10^{4} = (2 \\cdot 5)^{4} = 2^{4} \\cdot 5^{4}$ 和分母 $10001$ 之间是否存在公因数。分子的质因数是 $2$ 和 $5$。数字 $10001$ 不能被 $2$（它是奇数）或 $5$（它不以 $0$ 或 $5$ 结尾）整除。因此，没有共同的质因数，分数 $\\frac{10000}{10001}$ 是最简形式。",
            "answer": "$$\\boxed{\\frac{10000}{10001}}$$"
        },
        {
            "introduction": "获取信号后，下一个挑战是如何从充满噪声的数据中解码出用户的意图。脑机接口系统必须能够在真实环境中稳健工作，有效应对各种伪迹（如肌电干扰）的污染。本练习将引导你分析一个基于卡尔曼滤波的线性高斯解码器，通过推导当测量噪声增加时系统如何自动调整其内部增益，你将理解解码器在响应速度和稳定性之间的基本权衡。",
            "id": "3966609",
            "problem": "考虑一个基于脑电图 (EEG) 的脑机接口 (BCI) 解码器，该解码器由一个针对单一潜控制变量的标量线性高斯状态空间过程建模。令潜状态为 $x_k \\in \\mathbb{R}$，观测值为 $y_k \\in \\mathbb{R}$。动态由线性模型 $x_{k+1} = a x_k + w_k$ 给出，其中 $w_k$ 是方差为 $q$ 的零均值高斯过程噪声；观测模型为 $y_k = h x_k + v_k$，其中 $v_k$ 是方差为 $r$ 的零均值高斯测量噪声。由于瞬态肌电伪影污染，观测值变为 $y_k = h x_k + v_k + a_k$，其中 $a_k$ 是方差为 $\\sigma_a^2$ 的零均值高斯伪影噪声，且独立于 $v_k$ 和 $w_k$。假设一个标准的递归贝叶斯估计器，该估计器在线性高斯假设下最小化均方误差，并假设在时间 $k$，以过去观测为条件的 $x_k$ 的先验分布的均值为 $\\hat{x}_{k|k-1}$，方差为 $p = \\operatorname{Var}(x_k \\mid y_{1:k-1})$。\n\n从线性高斯模型和贝叶斯规则的定义出发，推导测量噪声方差因 $\\sigma_a^2$ 而产生的膨胀如何改变测量更新，特别是加权新息 $y_k - h \\hat{x}_{k|k-1}$ 的增益因子。计算伪影膨胀的测量增益与基线测量增益之比的闭式解析表达式，该表达式仅用 $h$、$p$、$r$ 和 $\\sigma_a^2$ 表示。将最终答案表示为单个简化的解析表达式。不需要数值近似或四舍五入。\n\n此外，基于您的推导，定性讨论此方差膨胀对解码器响应性（估计值跟踪 $y_k$ 变化的速度）和估计器稳定性（对不规则波动的抵抗力）的影响，但不要在最终答案中包含任何定性讨论。",
            "solution": "问题陈述被评估为有效。它在科学上基于贝叶斯状态估计的原理，特别是卡尔曼滤波器，这是信号处理和计算神经科学中用于BCI解码等任务的标准方法。该问题是适定的，提供了所有必要的定义、变量（$a$、$h$、$p$、$r$、$\\sigma_a^2$）和一个明确的目标。它没有歧义、矛盾和主观内容。\n\n问题的核心在于对线性高斯系统的递归贝叶斯估计器应用测量更新步骤。对于此类系统，最小化均方误差的估计器是卡尔曼滤波器。该问题是标量问题，涉及单个潜状态 $x_k \\in \\mathbb{R}$ 和单个观测值 $y_k \\in \\mathbb{R}$。\n\n滤波器分两步操作：预测步骤和测量更新步骤。问题提供了在时间 $k$ 时，以截至时间 $k-1$ 的所有过去观测值（表示为 $y_{1:k-1}$）为条件的先验状态分布。该先验分布是一个高斯分布，其均值为 $\\hat{x}_{k|k-1}$，方差为 $p$：\n$$p(x_k | y_{1:k-1}) = \\mathcal{N}(x_k; \\hat{x}_{k|k-1}, p)$$\n\n测量更新步骤结合了新的观测值 $y_k$，将此先验分布细化为后验分布 $p(x_k | y_{1:k})$。根据贝叶斯规则，后验分布与似然和先验的乘积成正比：\n$$p(x_k | y_{1:k}) \\propto p(y_k | x_k) p(x_k | y_{1:k-1})$$\n\n对于给定的线性高斯模型，似然 $p(y_k | x_k)$ 也是高斯的。观测模型是 $y_k = h x_k + \\epsilon_k$，其中 $\\epsilon_k$ 是总测量噪声。给定 $x_k$，$y_k$ 的分布为 $\\mathcal{N}(y_k; h x_k, R_{\\text{total}})$，其中 $R_{\\text{total}}$ 是总测量噪声 $\\epsilon_k$ 的方差。由于两个高斯分布的乘积是另一个（未归一化的）高斯分布，因此后验分布 $p(x_k | y_{1:k})$ 也是高斯的。\n\n更新后的（后验）状态估计 $\\hat{x}_{k|k}$ 及其方差 $p_{k|k}$ 由标准的卡尔曼滤波器测量更新方程给出。对于标量情况，后验均值为：\n$$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k (y_k - h \\hat{x}_{k|k-1})$$\n项 $(y_k - h \\hat{x}_{k|k-1})$ 是新息或预测误差。因子 $K_k$ 是卡尔曼增益，它对这个新息进行最优加权。计算增益是为了最小化后验方差 $p_{k|k}$。标量卡尔曼增益的公式是：\n$$K_k = \\frac{p h}{h^2 p + R_{\\text{total}}}$$\n其中 $p$ 是先验方差 $\\operatorname{Var}(x_k \\mid y_{1:k-1})$，$R_{\\text{total}}$ 是测量噪声过程的方差。\n\n我们现在将按照问题规定，计算两种情况下的增益。\n\n情况1：基线（无伪影）\n在基线场景中，观测模型为 $y_k = h x_k + v_k$。测量噪声仅为 $v_k$，它是一个方差为 $r$ 的零均值高斯过程。因此，总测量噪声方差为：\n$$R_{\\text{base}} = \\operatorname{Var}(v_k) = r$$\n基线测量增益，我们记为 $K_{\\text{base}}$，通过将 $R_{\\text{base}}$ 代入增益方程得到：\n$$K_{\\text{base}} = \\frac{p h}{h^2 p + r}$$\n\n情况2：伪影膨胀\n在存在伪影污染的情况下，观测模型变为 $y_k = h x_k + v_k + a_k$。总测量噪声现在是固有测量噪声和伪影噪声之和：$\\epsilon_k = v_k + a_k$。\n问题陈述指出，$v_k$ 和 $a_k$ 分别是方差为 $r$ 和 $\\sigma_a^2$ 的独立、零均值高斯随机变量。两个独立随机变量之和的方差等于它们各自方差之和。因此，总测量噪声的方差是：\n$$R_{\\text{artifact}} = \\operatorname{Var}(v_k + a_k) = \\operatorname{Var}(v_k) + \\operatorname{Var}(a_k) = r + \\sigma_a^2$$\n伪影膨胀的测量增益，记为 $K_{\\text{artifact}}$，通过将这个新的总方差代入增益方程得到：\n$$K_{\\text{artifact}} = \\frac{p h}{h^2 p + (r + \\sigma_a^2)}$$\n\n最后，我们计算所要求的伪影膨胀增益与基线增益之比：\n$$\\frac{K_{\\text{artifact}}}{K_{\\text{base}}} = \\frac{\\frac{p h}{h^2 p + r + \\sigma_a^2}}{\\frac{p h}{h^2 p + r}}$$\n两个表达式分子中的项 $p h$ 相互抵消，得到：\n$$\\frac{K_{\\text{artifact}}}{K_{\\text{base}}} = \\frac{h^2 p + r}{h^2 p + r + \\sigma_a^2}$$\n这是该比率的最终闭式解析表达式，纯粹用给定的变量 $h$、$p$、$r$ 和 $\\sigma_a^2$ 表示。\n\n基于此推导，我们可以讨论其定性影响。由于伪影方差 $\\sigma_a^2$ 是一个非负量（方差必须 $\\ge 0$；对于不可忽略的伪影，$\\sigma_a^2 > 0$），比率的分母 $h^2 p + r + \\sigma_a^2$ 严格大于分子 $h^2 p + r$。因此，该比率总是小于1，即 $K_{\\text{artifact}}  K_{\\text{base}}$。伪影的存在正确地迫使最优估计器减小其增益。\n\n关于解码器的响应性，卡尔曼增益 $K_k$ 决定了状态估计根据新测量值调整的程度。较小的增益意味着估计器对传入的（现在可靠性较低的）观测值 $y_k$ 赋予较小的权重，而对其自身的预测 $\\hat{x}_{k|k-1}$ 赋予较大的权重。结果是，状态估计对测量的即时变化变得不那么敏感。这使得BCI解码器在跟踪信号 $y_k$ 中反映的用户意图时响应性较差，或更“迟钝”。\n\n关于估计器的稳定性，减少对噪声测量的依赖性的好处是使估计更平滑，对不规则波动的鲁棒性更强。伪影噪声 $a_k$ 在 $y_k$ 中引入了高方差的伪变化。通过降低增益，滤波器有效地滤除了更多的这种噪声，防止其破坏状态估计 $x_k$。这增加了估计器的稳定性。本质上，当面临增加的测量不确定性时，卡尔曼滤波器会自动且最优地在响应性和稳定性之间进行权衡。测量噪声方差因 $\\sigma_a^2$ 而产生的膨胀是滤波器被告知这种不确定性的机制。",
            "answer": "$$\\boxed{\\frac{h^2 p + r}{h^2 p + r + \\sigma_a^2}}$$"
        },
        {
            "introduction": "设计并实现了一个脑机接口系统后，我们如何科学地证明它确实有效？尤其是在分析多通道、多频段的脑电数据时，多重比较问题会显著增加假阳性的风险。本练习将介绍一种强大的非参数统计方法——最大统计量置换检验，用于校正多重比较。通过计算一个经过严格统计控制的p值，你将学会如何令人信服地评估BCI分类器的性能是否显著优于随机水平。",
            "id": "3966629",
            "problem": "一位研究人员正在使用多通道脑电图（EEG）记录来评估一个运动想象脑机接口（BCI）。对于每个脑电图的通道-频带对，分类流程先应用特征提取，然后使用线性分类器，并报告平衡准确率。设平衡准确率记为 $A_{\\text{bal}}$，对于给定的通道 $c$ 和频带 $b$，其检验统计量定义为 $T_{c,b} = A_{\\text{bal}} - 0.5$，其中 $0.5$ 对应于二元分类任务中的随机水平性能。零假设是标签是可交换的，这意味着当标签被置换时，$T_{c,b}$ 以 $0$ 为中心。\n\n为了控制跨通道和频带的多重比较，该研究人员使用一种基于所有检验中最大统计量的非参数置换检验：在每次置换 $p$ 中，随机置换标签同时保持类别计数不变，然后相同地重新运行分类流程，并计算所有通道-频带对中的最大检验统计量 $\\max_{c,b} T_{c,b}^{(p)}$。实验包括 $C = 32$ 个通道和 $B = 5$ 个频带，因此共有 $K = C \\times B$ 个同步比较。该研究人员执行了 $P = 10000$ 次独立的标签置换，并记录了最大统计量的经验分布。单侧备择假设是，某个特定的对 $(c^{\\ast}, b^{\\ast})$ 具有 $T_{c^{\\ast},b^{\\ast}}  0$。\n\n对于这个特定的对 $(c^{\\ast}, b^{\\ast})$，观测到的检验统计量是 $T_{c^{\\ast},b^{\\ast}}^{\\text{obs}} = 0.136$。在 $P = 10000$ 次置换中，满足 $\\max_{c,b} T_{c,b}^{(p)} \\geq T_{c^{\\ast},b^{\\ast}}^{\\text{obs}}$ 的置换最大值的数量为 $m = 214$。假设在零假设下标签是可交换的，并使用一种有限样本保守调整，以避免出现零 $p$ 值。\n\n使用最大统计量的经验置换分布，计算该单侧检验的族系误差率（FWER）控制的 $p$ 值。将您的答案四舍五入到四位有效数字。以小数形式表示最终值，不带百分号。",
            "solution": "对问题陈述的有效性进行了评估，认定其具有科学依据、问题明确且客观。它描述了一种用于神经影像数据分析中多重比较校正的标准且统计上稳健的程序，特别是使用最大统计量置换检验来控制族系误差率（FWER）。计算所需的所有数据均已提供。\n\n目标是使用从置换中导出的经验分布，为一个特定的观测检验统计量计算FWER控制的 $p$ 值。族系误差率是在全局零假设（即所有单个零假设都为真）为真的前提下，在一系列同步假设检验中犯至少一次I类错误（假阳性）的概率。如上所述，最大统计量置换检验程序旨在强力控制FWER。\n\n对于给定的通道-频带对 $(c, b)$，其检验统计量定义为 $T_{c,b} = A_{\\text{bal}} - 0.5$，其中 $A_{\\text{bal}}$ 是平衡准确率，而 $0.5$ 代表随机水平的性能。研究人员正在同时检验 $K = C \\times B = 32 \\times 5 = 160$ 个假设。对于感兴趣的对 $(c^{\\ast}, b^{\\ast})$，其特定的观测统计量是 $T_{c^{\\ast},b^{\\ast}}^{\\text{obs}} = 0.136$。\n\n该方法的核心是将这个观测统计量与在零假设下获得的*最大*统计量的分布进行比较。标签可交换性的零假设意味着，置换类别标签会创建与不存在真实效应相一致的数据集。对于 $P = 10000$ 次置换中的每一次，计算所有 $K$ 对中的最大检验统计量，从而得到一组值 $\\{\\max_{c,b} T_{c,b}^{(p)}\\}_{p=1}^{P}$。这组值构成了最大统计量的经验零分布。\n\n对于观测统计量 $T_{c^{\\ast},b^{\\ast}}^{\\text{obs}}$，其FWER控制的 $p$ 值是观测到至少与 $T_{c^{\\ast},b^{\\ast}}^{\\text{obs}}$ 一样大的最大置换统计量的概率。这可以表示为：\n$$\np_{\\text{FWER}} = \\text{Pr}(\\max_{c,b} T_{c,b}^{(p)} \\geq T_{c^{\\ast},b^{\\ast}}^{\\text{obs}} | H_0)\n$$\n其中 $H_0$ 是全局零假设。\n\n这个概率的经验估计值是满足此标准的置换最大值的比例。问题陈述指出，在 $P = 10000$ 次置换中，有 $m = 214$ 次的最大统计量大于或等于观测统计量，即 $\\max_{c,b} T_{c,b}^{(p)} \\geq T_{c^{\\ast},b^{\\ast}}^{\\text{obs}}$ 的情况。\n\n问题指定使用“有限样本保守调整，以避免出现零 $p$ 值”。这指的是将观测数据的结果也包含在置换分布中的标准做法。这种调整可以防止出现零 $p$ 值（这在有限的置换样本中是没有意义的），并提供对真实 $p$ 值更准确的估计。这个调整后 $p$ 值的公式是：\n$$\np_{\\text{FWER}} = \\frac{m + 1}{P + 1}\n$$\n在这里，$m$ 是最大统计量大于或等于观测统计量的置换次数，$P$ 是总置换次数。分子加1是为了计入观测统计量本身（在零假设下，它只是来自同一分布的另一次抽样），分母加1是为了反映所考虑的总样本数（$P$ 次置换加上原始数据）。\n\n代入给定值：\n$m = 214$\n$P = 10000$\n\n我们计算 $p$ 值：\n$$\np_{\\text{FWER}} = \\frac{214 + 1}{10000 + 1} = \\frac{215}{10001}\n$$\n\n现在，我们进行除法运算以获得小数值：\n$$\np_{\\text{FWER}} = \\frac{215}{10001} \\approx 0.02149785021...\n$$\n\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $2$、$1$、$4$ 和 $9$。第五位有效数字是 $7$。由于 $7 \\geq 5$，我们将第四位有效数字 $9$ 向上取整。这会导致进位，将末尾部分从 $49$ 变为 $50$。\n\n因此，四舍五入后的 $p$ 值为 $0.02150$。末尾的零是有效数字，必须包含。",
            "answer": "$$\\boxed{0.02150}$$"
        }
    ]
}