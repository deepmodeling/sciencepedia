## 引言
脑电图（EEG）为我们提供了一个观察大脑动态的无创窗口，但其记录的头皮电位与深层神经活动之间的关系并非直接了当。脑电正向建模正是为了解决这一核心问题而构建的理论与计算框架，它作为一座桥梁，精确地描述了大脑内部的神经[电流源](@entry_id:275668)如何在复杂的头部组织中传播，并最终在头皮表面形成可测量的电势分布。若缺乏对这一物理过程的深刻理解，我们便无法准确地从EEG信号中反推其神经起源，从而限制了我们对大脑功能和功能障碍的洞察力。

本文旨在为读者系统性地构建关于脑电正向建模的完整知识体系。我们将分三步深入探讨这一主题：首先，在“**原理与机制**”一章中，我们将从电磁学的基本定律出发，推导控制方程，并详细阐述头部和神经源的数学模型；接着，在“**应用与交叉学科联系**”一章中，我们将展示如何利用现代成像技术构建逼真的个体化模型，比较不同的数值求解方法，并探讨正向模型在[多模态融合](@entry_id:914764)、源定位和神经调控等前沿领域的关键作用；最后，“**动手实践**”部分将通过具体的计算练习，帮助您将理论知识转化为实践技能。通过这一结构化的学习路径，本文将带领您从物理基础走向实际应用，全面掌握脑电正向建模的核心概念与技术。

## 原理与机制

在介绍章节之后，我们现在深入探讨脑电图（EEG）正向建模的物理与数学核心。本章的目标是系统性地构建从[神经元活动](@entry_id:174309)到头皮电位测量这一过程的理论框架。我们将从基本物理定律出发，推导出控制方程，并探索用于模拟头部和神经源的实际模型。本章的探讨将为后续章节中关于数值计算方法和[逆问题](@entry_id:143129)求解的内容奠定坚实的基础。

### 物理基础：准静态近似

脑电信号的产生和传播本质上是一个电磁学问题。然而，由于神经电活动的时间尺度（通常低于1千赫兹）和头部的空间尺度（约0.2米），我们可以对完整的[麦克斯韦方程组](@entry_id:150940)进行显著简化。这一简化被称为**准静态近似（quasi-static approximation）**。

首先，我们考虑[法拉第感应定律](@entry_id:146175)，$\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}$，它将电场 $\mathbf{E}$ 的旋度与磁场 $\mathbf{B}$ 的时间变化率联系起来。对于频率为 $f$ 的[生物电](@entry_id:177639)信号，[感应电场](@entry_id:267314)与静电场的比值量级约为 $\omega \mu \sigma L^2$，其中 $\omega=2\pi f$ 是[角频率](@entry_id:261565)，$\mu$ 是[磁导率](@entry_id:154559)，$\sigma$ 是电导率，$L$ 是特征尺度。对于大脑组织，即使在 $1000 \,\mathrm{Hz}$ 的频率下，这个比值也远小于1 。这意味着由时变磁场感应出的电场分量可以忽略不计。因此，我们可以近似认为电场是无旋的：
$$ \nabla \times \mathbf{E} \approx \mathbf{0} $$
一个无旋的矢量场可以表示为一个[标量场的梯度](@entry_id:270765)。因此，我们可以引入一个**标量电势（scalar potential）** $\phi$，使得：
$$ \mathbf{E} = -\nabla \phi $$
这一关键步骤将矢量场的求解问题简化为[标量场](@entry_id:151443)的求解问题，极大地降低了模型的复杂性。

其次，我们考虑[安培-麦克斯韦定律](@entry_id:266368)，它将[传导电流](@entry_id:265343)密度 $\mathbf{J}_c$ 和位移电流密度 $\mathbf{J}_d = \frac{\partial \mathbf{D}}{\partial t}$ 联系起来。其中 $\mathbf{D}$ 是[电位移矢量](@entry_id:197092)。在简谐情况下，位移电流的幅度为 $|\mathbf{J}_d| = |\omega \varepsilon \mathbf{E}|$，而传导电流的幅度为 $|\mathbf{J}_c| = |\sigma \mathbf{E}|$，其中 $\varepsilon$ 是介[电常数](@entry_id:272823)。两者之比为 $\frac{\omega \varepsilon}{\sigma}$。对于大脑组织，即使在 EEG 的高频段（例如 $300 \,\mathrm{Hz}$），使用典型的电导率（$\sigma \sim 0.3 \,\mathrm{S/m}$）和介[电常数](@entry_id:272823)（$\varepsilon_r \sim 80$），这个比值也只有 $10^{-5}$ 的量级  。这意味着在生物组织中，由电荷运动构成的**[传导电流](@entry_id:265343)（conduction current）**远大于由电场变化引起的**位移电流（displacement current）**。因此，我们可以忽略[位移电流](@entry_id:190231)的贡献。

这一近似意味着电荷在体内的积聚可以忽略不计（$\frac{\partial \rho}{\partial t} \approx 0$），从而电荷守恒定律 $\nabla \cdot \mathbf{J} + \frac{\partial \rho}{\partial t} = 0$ 简化为：
$$ \nabla \cdot \mathbf{J}_{total} \approx 0 $$
其中 $\mathbf{J}_{total}$ 是总电流密度。这个关系表明，在准静态近似下，流入任何体积微元的总电流等于流出的总电流。

### 源与导体：控制方程的建立

在建立了准静态物理框架后，我们需要区分电流的两种类型，以建立描述电势分布的控制方程。总电流密度 $\mathbf{J}_{total}$ 由两部分组成 ：

1.  **初级电流密度（primary current density）** $\mathbf{J}^p$：这[部分电流](@entry_id:1129364)是由非电场力驱动的，代表了神经活动的直接电生理源。具体而言，它源于[神经元膜](@entry_id:182072)上由新陈代谢能量驱动的[离子泵](@entry_id:168855)和[离子通道](@entry_id:170762)所产生的主动跨膜离子流。$\mathbf{J}^p$ 是电场的“源”，它不遵循宏观的欧姆定律，其存在独立于周围介质的电导率。

2.  **次级电流密度（secondary current density）** $\mathbf{J}^c$：也称为**体积电流（volume current）**或[传导电流](@entry_id:265343)。这是头部组织（作为一种容积导体）对初级电流所产生的电场的被动响应。它描述了离子在电场力作用下在细胞外空间的流动，并遵循宏观[欧姆定律](@entry_id:276027)：
    $$ \mathbf{J}^c = \boldsymbol{\sigma}\mathbf{E} $$
    其中 $\boldsymbol{\sigma}$ 是介质的[电导率张量](@entry_id:155827)。

将总电流密度 $\mathbf{J}_{total} = \mathbf{J}^p + \mathbf{J}^c$ 代入电荷守恒方程 $\nabla \cdot \mathbf{J}_{total} = 0$，我们得到：
$$ \nabla \cdot (\mathbf{J}^p + \mathbf{J}^c) = 0 $$
再将欧姆定律和电势关系式 $\mathbf{J}^c = \boldsymbol{\sigma}\mathbf{E} = -\boldsymbol{\sigma}\nabla\phi$ 代入，便可得到 EEG 正向问题的基本[偏微分](@entry_id:194612)方程（PDE）：
$$ \nabla \cdot (-\boldsymbol{\sigma}\nabla\phi) = -\nabla \cdot \mathbf{J}^p $$
整理后即为：
$$ \nabla \cdot (\boldsymbol{\sigma}\nabla\phi) = \nabla \cdot \mathbf{J}^p $$
这是一个类泊松方程（Poisson-like equation）。方程的右边是源项，即初级[电流密度的散度](@entry_id:266331) $\nabla \cdot \mathbf{J}^p$，它物理上表示单位体积内从细胞内转移到细胞外的净电荷速率。这个方程将未知的头皮电势 $\phi$ 与已知的神经源 $\mathbf{J}^p$ 和头部电导率分布 $\boldsymbol{\sigma}$ 联系了起来。

### [头部建模](@entry_id:1125951)：电导率与边界条件

要解上述[偏微分](@entry_id:194612)方程，我们必须对头部几何结构和电学特性进行建模。这包括定义每个组织的电导率 $\boldsymbol{\sigma}$ 以及在组织界面和头部边界上的条件。

#### 电导率：各向同性与各向异性

介质的电导率描述了其引导电流的能力。根据电流是否在所有方向上都以相同方式传导，我们可以将其分为两类 ：

-   **各向同性（Isotropic）电导率**：在这种情况下，电导率是一个标量 $\sigma(\mathbf{x})$，电流密度 $\mathbf{J}^c$ 与电场 $\mathbf{E}$ 平行：$\mathbf{J}^c = -\sigma \nabla\phi$。控制方程简化为 $\nabla \cdot (\sigma \nabla\phi) = \nabla \cdot \mathbf{J}^p$。在电导率均匀的区域（例如，简化的脑组织模型），此方程进一步简化为标准的泊松方程 $\sigma \nabla^2\phi = \nabla \cdot \mathbf{J}^p$。

-   **各向异性（Anisotropic）电导率**：在某些组织中，如白质纤维束和颅骨，电流的传导能力因方向而异。例如，电流更容易沿着白质纤维束的方向流动。这种情况下，电导率必须用一个 $3 \times 3$ 的[对称正定](@entry_id:145886)张量 $\boldsymbol{\sigma}(\mathbf{x})$ 来描述。电流密度与电场的关系变为 $\mathbf{J}^c = -\boldsymbol{\sigma} \nabla\phi$，电流方向不一定与电场方向平行。控制方程的形式保持为 $\nabla \cdot (\boldsymbol{\sigma} \nabla\phi) = \nabla \cdot \mathbf{J}^p$。$\boldsymbol{\sigma}$ 的对称性和正定性保证了该方程的解是适定的（well-posed）。在电导率均匀的各向异性区域，若将坐标系与 $\boldsymbol{\sigma}$ 的[主轴](@entry_id:172691)对齐，方程可简化为 $\sum_{i=1}^{3}\sigma_{i}\partial_{ii}\phi=\nabla \cdot \mathbf{J}_{p}$，其中 $\sigma_i$ 是沿各[主轴](@entry_id:172691)的电导率（主电导率）。

#### 边界与[界面条件](@entry_id:750725)

在一个分层的[头部模型](@entry_id:1125950)中（例如，包含大脑、脑脊液、颅骨和头皮的模型），我们需要在每个组织交界面上施加条件，以确保解的物理合理性  ：

1.  **电势连续性**：在任意两个组织（例如，介质1和2）的交界面上，电势必须是连续的，否则将意味着存在无限大的电场。
    $$ \phi_1 = \phi_2 $$

2.  **法向电流连续性**：由于在界面上没有电荷的汇聚或消失，穿过界面的电流密度的法向分量必须连续。
    $$ \mathbf{n} \cdot \mathbf{J}^c_1 = \mathbf{n} \cdot \mathbf{J}^c_2 $$
    代入欧姆定律，此条件变为：
    $$ \mathbf{n} \cdot (\boldsymbol{\sigma}_1 \nabla\phi_1) = \mathbf{n} \cdot (\boldsymbol{\sigma}_2 \nabla\phi_2) $$

3.  **头皮-空气边界**：空气的电导率几乎为零，可以视为理想的绝缘体。因此，没有电流能从头皮流出到空气中。这意味着在头皮外表面，电流密度的法向分量为零。
    $$ \mathbf{n} \cdot \mathbf{J}^c = 0 \implies \mathbf{n} \cdot (\boldsymbol{\sigma}_{scalp} \nabla\phi) = 0 $$
    这是一种**[诺伊曼边界条件](@entry_id:142124)（Neumann boundary condition）**。

### 规范问题：电势与参考电极

一个微妙但至关重要的问题是电势 $\phi$ 的绝对值是不确定的。从数学上看，由于我们的问题具有纯[诺伊曼边界条件](@entry_id:142124)（头皮与空气绝缘），其解只在相差一个任意常数的意义下是唯一的 。

具体来说，如果 $\phi(\mathbf{r})$ 是控制方程和边界条件的一个解，那么对于任何常数 $c$，$\tilde{\phi}(\mathbf{r}) = \phi(\mathbf{r}) + c$ 也是一个解。这是因为电场 $\mathbf{E}$ 和次级电流 $\mathbf{J}^c$ 都只依赖于电势的**梯度**：
$$ \tilde{\mathbf{E}} = -\nabla\tilde{\phi} = -\nabla(\phi+c) = -\nabla\phi = \mathbf{E} $$
由于电场和电流等所有可测量的物理量都没有改变，这种不确定性被称为**[规范自由度](@entry_id:160491)（gauge freedom）**。

在实际的 EEG 测量中，这种模糊性通过**参考（referencing）**来解决。EEG 设备从不测量绝对电势，而是测量两个电极之间的**[电势差](@entry_id:275724)**。例如，电极 $i$ 的测量值 $V_i$ 是其相对于某个参考电极 $ref$ 的电势差：
$$ V_i = \phi(\mathbf{r}_i) - \phi(\mathbf{r}_{ref}) $$
如果我们将所有电势同时移动一个常数 $c$，这个[电势差](@entry_id:275724)保持不变：
$$ \tilde{V}_i = \tilde{\phi}(\mathbf{r}_i) - \tilde{\phi}(\mathbf{r}_{ref}) = (\phi(\mathbf{r}_i)+c) - (\phi(\mathbf{r}_{ref})+c) = V_i $$
因此，选择一个参考电极（或一个计算参考，如所有电极的平均值）就“固定”了规范，使得测量值明确且不受任意常数的影响。改变参考电极会改变所有电极的测量值，但不会改变任何两个非参考电极之间的电势差，更不会改变大脑内部的实际物理过程 。

### 神经源建模：[等效电流偶极子](@entry_id:1124623)

初级电流 $\mathbf{J}^p$ 分布于大脑皮层中活跃的神经元群体。为了在宏观尺度上进行建模，直接处理成千上万个神经元的复杂几何和电流分布是不切实际的。一个极其有效且广泛使用的简化方法是将一小块局部激活的皮层区域的净电效应表示为一个**[等效电流偶极子](@entry_id:1124623)（equivalent current dipole, ECD）** 。

这个概念源于电磁场的**[多极展开](@entry_id:144850)（multipole expansion）**。对于一个局域化的[电流源](@entry_id:275668)分布 $\mathbf{J}^p$，在远离源的“远场”区域，其产生的电势可以展开为一个级数，其中贡献最大的[主导项](@entry_id:167418)通常是偶极子项（[单极子](@entry_id:1128137)项由于[电荷守恒](@entry_id:264158)通常为零）。

[等效电流偶极子](@entry_id:1124623)由三个参数定义：位置 $\mathbf{r}_0$、矩 $\mathbf{p}$ 和方向。矩 $\mathbf{p}$ 是一个矢量，其大小和方向代表了源的总体强度和朝向。它被定义为初级电流密度在源区域 $V_s$ 上的体积积分：
$$ \mathbf{p} = \int_{V_s} \mathbf{J}^p(\mathbf{r}') dV' $$
其单位是安培·米（A·m）。偶极子的位置 $\mathbf{r}_0$ 通常选为源区域的几何中心。由于大脑皮层中主要的兴奋性神经元（[锥体细胞](@entry_id:1130331)）的排列方向大致垂直于皮层表面，其产生的初级电流也主要沿法线方向流动。因此，[等效电流偶极子](@entry_id:1124623)的方向通常被假定为垂直于该位置的皮层表面。

### 头部组织的角色：信号的失真与分布

头部不同组织的电导率差异巨大，这对从大脑深处产生的电信号到头皮的传播过程有显著影响。一个经典的多层球形[头部模型](@entry_id:1125950)（例如，包含大脑、脑脊液、颅骨和头皮的四层模型）能够很好地揭示这些影响  。

关键在于**脑脊液（CSF）**和**颅骨（skull）**的电导率特性：[脑脊液](@entry_id:898244)的电导率非常高（$\sigma_{\text{csf}} \approx 1.8 \,\mathrm{S/m}$），而颅骨的电导率非常低（$\sigma_{\text{skull}} \approx 0.015 \,\mathrm{S/m}$），两者相差约100倍。

当源于大脑的电流到达[脑脊液](@entry_id:898244)层时，它遇到了一个低电阻的通道。相比之下，紧随其后的颅骨层则是一个高电阻的屏障。根据电流趋向于沿最小电阻路径流动的原则，大[部分电流](@entry_id:1129364)不会直接穿过颅骨，而是在导电性良好的脑脊液层内沿切向（tangential）方向流动和扩散。这种现象被称为**分流效应（shunting effect）**。

这种分流效应导致两个主要后果：
1.  **空间涂抹（Spatial Smearing）**：电流在到达头皮之前被横向散开，使得头皮上的电势分布变得更加弥散和平滑。这相当于一个空间低通滤波器，削弱了电势分布的尖锐特征。
2.  **幅度衰减（Amplitude Attenuation）**：由于电流被分散到更大的区域，穿透颅骨并到达头皮的[峰值电流](@entry_id:264029)密度减小，导致在头皮上测得的电势幅度显著降低。

这种效应还因神经源的方向而异 ：
-   **径向偶极子（Radial Dipole）**：方向垂直于皮层表面的偶极子。其产生的电流主要沿径向向外传播，直接“冲击”颅骨屏障。因此，[脑脊液](@entry_id:898244)的分流效应对其影响非常显著，导致其头皮电势分布被严重涂抹和衰减。其在头皮上产生的电势图样通常是围绕源投影点的一个圆形对称的单[极值](@entry_id:145933)（一个正[极值](@entry_id:145933)或负[极值](@entry_id:145933)）。

-   **切向偶极子（Tangential Dipole）**：方向平行于皮层表面的偶主子。其产生的电流本身就主要在切向平面内循环。脑脊液层为这种循环提供了更优的通路。虽然信号同样被衰减，但其电流模式受分流效应的改变程度相对较小。其在头皮上产生的电势图样是典型的**[双极性](@entry_id:746396)（bipolar）**模式：一个正极值区和一个负[极值](@entry_id:145933)区，被一条零电势的[节线](@entry_id:169397)隔开。

理解这些由头部结构引起的失真，对于正确解释EEG地形图和进行准确的[源定位](@entry_id:755075)至关重要。

### [正向算子](@entry_id:1125261)：[导联场矩阵](@entry_id:1127135)与[互易原理](@entry_id:1130171)

对于一个给定的头部模型和一组离散的神经源（如[等效电流偶极子](@entry_id:1124623)），正向问题可以被形式化为一个[线性映射](@entry_id:185132)。假设我们有 $N$ 个电极和 $M$ 个偶极子源，每个源有三个笛卡尔分量。我们可以将所有源的矩分量组织成一个 $3M \times 1$ 的向量 $\mathbf{p}$，将所有电极的测量电势组织成一个 $N \times 1$ 的向量 $\mathbf{v}$。由于控制方程是线性的，它们之间的关系可以表示为一个简单的[矩阵乘法](@entry_id:156035)：
$$ \mathbf{v} = \mathbf{L}\mathbf{p} $$
这个 $N \times 3M$ 的矩阵 $\mathbf{L}$ 被称为**[导联场矩阵](@entry_id:1127135)（lead field matrix）**或增益矩阵（gain matrix）。

[导联场矩阵](@entry_id:1127135) $\mathbf{L}$ 完整地刻画了头部作为容积导体的所有几何和电学特性。它的每一个元素 $L_{ij}$ 代表了第 $j$ 个单位源分量（例如，位于某位置、沿x轴、强度为1的偶极子）在第 $i$ 个电极上产生的电势。因此，$\mathbf{L}$ 的每一列都是由一个单位偶极子源在所有电极上产生的电势[地形图](@entry_id:202940)。

#### 导联场的构建与[互易原理](@entry_id:1130171)

直接构建[导联场矩阵](@entry_id:1127135)的方法是：对 $3M$ 个单位源中的每一个，都独立求解一次正向问题（即解一次[偏微分](@entry_id:194612)方程），并记录下所有电极上的电势。由于源的数量 $M$ 通常很大（数千个），这种方法的计算成本非常高。

幸运的是，存在一种更高效的方法，它基于物理学中的一个深刻原理——**[互易原理](@entry_id:1130171)（principle of reciprocity）**。对于线性、无源的媒质，[亥姆霍兹互易原理](@entry_id:170195)指出，源和场可以互换角色。在EEG的背景下，这导致了一个强大的结果，即**导联场定理**  。

该定理指出：由位于 $\mathbf{r}_m$、方向为 $\mathbf{u}_m$ 的单位[电流偶极子](@entry_id:1123303)在电极 $j$ 处产生的电势 $L_{j,m}$，数值上等于在电极 $j$ 处注入单位电流（并在参考电极处撤出）时，在源点 $\mathbf{r}_m$ 处产生的电场 $\mathbf{E}^{(j)}$ 沿偶极子方向 $\mathbf{u}_m$ 的投影。其数学表达式为：
$$ L_{j,m} = \mathbf{u}_m \cdot \mathbf{E}^{(j)}(\mathbf{r}_m) $$
这个结果的实际意义是巨大的。我们不再需要为数千个源[求解PDE](@entry_id:138485)，而是只需为每一个电极求解一次PDE。由于电极数量 $N$（通常为几十到几百）远小于源的数量 $M$，使用[互易原理](@entry_id:1130171)可以极大地提高计算[导联场矩阵](@entry_id:1127135)的效率。这使得为高分辨率皮层源空间构建精确的头部模型在计算上成为可能。