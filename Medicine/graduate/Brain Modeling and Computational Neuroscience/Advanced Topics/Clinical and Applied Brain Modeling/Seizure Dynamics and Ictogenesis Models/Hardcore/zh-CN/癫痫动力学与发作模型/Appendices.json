{
    "hands_on_practices": [
        {
            "introduction": "癫痫发作通常涉及一些缓慢变化的变量，这些变量将大脑推向超兴奋状态。其中一个关键的慢变量是细胞外钾离子浓度 $[K^+]_o$。本练习旨在通过能斯特方程，探索 $[K^+]_o$ 与神经元膜电位之间的直接关系。通过亲手计算这种效应，学生将具体理解离子积聚（剧烈神经活动的后果）如何形成一个正反馈回路，从而驱动癫痫的发生 ()。",
            "id": "4017239",
            "problem": "在癫痫动力学的计算模型中，癫痫发生的一个核心机制是细胞外离子积累对离子反转电位的缓慢调节。考虑钾离子，并假设其行为符合理想溶液（活度系数等于$1$）。从平衡状态下电化学势相等以及理想溶液中化学势的热力学定义出发，推导钾离子的能斯特关系式，并用它来确定产生$+10$毫伏的钾离子能斯特电位去极化偏移所需的细胞外钾离子浓度的变化。假设温度 $T=310\\,\\mathrm{K}$，普适气体常数 $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，法拉第常数 $F=96485\\,\\mathrm{C\\,mol^{-1}}$，基线细胞内钾离子浓度 $[K^+]_i=140\\,\\mathrm{mM}$，以及基线细胞外钾离子浓度 $[K^+]_o^{(0)}=3.0\\,\\mathrm{mM}$。对于钾离子，取 $z=+1$。\n\n计算在钾离子能斯特电位中产生$+10\\,\\mathrm{mV}$去极化偏移所需的细胞外钾离子浓度变化 $\\Delta [K^+]_o=[K^+]_o^{(\\mathrm{new})}-[K^+]_o^{(0)}$。将您的答案四舍五入到三位有效数字，并以毫摩尔（mM）为单位表示最终数值。然后，运用膜生物物理学和基于电导的建模的核心原理，定性解释钾离子反转电位的这种偏移如何调节神经元兴奋性，并能促进癫痫动力学网络模型向癫痫发作状态的转变。",
            "solution": "该问题具有科学依据，提法得当，并为完整解答提供了所有必要信息。我们将首先推导能斯特关系式，然后计算所需的细胞外钾离子浓度的变化，最后对生物物理学意义进行定性解释。\n\n首先，我们推导具有电荷 $z_j$ 的通用离子物种 $j$ 的能斯特关系式。推导从电化学势 $\\tilde{\\mu}_j$ 的定义开始，它是化学势 $\\mu_j$ 和每摩尔电势能的总和。\n$$\n\\tilde{\\mu}_j = \\mu_j + z_j F \\phi\n$$\n其中 $F$ 是法拉第常数，$\\phi$ 是电势。对于理想溶液，化学势由以下公式给出：\n$$\n\\mu_j = \\mu_j^0 + RT \\ln[j]\n$$\n这里，$\\mu_j^0$ 是标准化学势，$R$ 是普适气体常数，$T$ 是绝对温度，$[j]$ 是离子的摩尔浓度。将这些结合起来，得到电化学势的完整表达式：\n$$\n\\tilde{\\mu}_j = \\mu_j^0 + RT \\ln[j] + z_j F \\phi\n$$\n在平衡状态下，没有离子跨膜的净通量。当细胞内的电化学势（细胞内，下标 $i$）等于细胞外的电化学势（细胞外，下标 $o$）时，此条件得到满足：\n$$\n\\tilde{\\mu}_{j,i} = \\tilde{\\mu}_{j,o}\n$$\n代入 $\\tilde{\\mu}_j$ 的表达式：\n$$\n\\mu_j^0 + RT \\ln[j]_i + z_j F \\phi_i = \\mu_j^0 + RT \\ln[j]_o + z_j F \\phi_o\n$$\n标准化学势 $\\mu_j^0$ 在两侧相同，可以消掉。重新排列各项以求解跨膜电位差，该电位差定义为能斯特电位 $E_j = \\phi_i - \\phi_o$：\n$$\nz_j F (\\phi_i - \\phi_o) = RT \\ln[j]_o - RT \\ln[j]_i\n$$\n$$\nz_j F E_j = RT \\left( \\ln[j]_o - \\ln[j]_i \\right)\n$$\n利用对数的性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到：\n$$\nz_j F E_j = RT \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\n最后，求解 $E_j$ 得到能斯特方程：\n$$\nE_j = \\frac{RT}{z_j F} \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\n对于钾离子（$K^+$），电荷为 $z_K = +1$。因此，钾离子的能斯特电位 $E_K$ 为：\n$$\nE_K = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o}{[K^+]_i}\\right)\n$$\n\n接下来，我们使用这个关系式来确定产生 $\\Delta E_K = +10\\,\\mathrm{mV}$ 去极化偏移所需的细胞外钾离子浓度变化 $\\Delta [K^+]_o$。让基线状态用上标 $(0)$ 表示，新状态用上标 $(\\mathrm{new})$ 表示。\n基线钾离子能斯特电位是：\n$$\nE_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(0)}}{[K^+]_i}\\right)\n$$\n细胞外浓度变化后的新电位是：\n$$\nE_K^{(\\mathrm{new})} = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(\\mathrm{new})}}{[K^+]_i}\\right)\n$$\n能斯特电位的变化 $\\Delta E_K$ 是新旧电位之差：\n$$\n\\Delta E_K = E_K^{(\\mathrm{new})} - E_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(\\mathrm{new})}}{[K^+]_i}\\right) - \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(0)}}{[K^+]_i}\\right)\n$$\n提出公因子 $\\frac{RT}{F}$ 并合并对数项：\n$$\n\\Delta E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(\\mathrm{new})}/[K^+]_i}{[K^+]_o^{(0)}/[K^+]_i}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[K^+]_o^{(\\mathrm{new})}}{[K^+]_o^{(0)}}\\right)\n$$\n我们现在可以求解新旧细胞外钾离子浓度之比。\n$$\n\\frac{\\Delta E_K F}{RT} = \\ln\\left(\\frac{[K^+]_o^{(\\mathrm{new})}}{[K^+]_o^{(0)}}\\right)\n$$\n对两边取指数：\n$$\n\\frac{[K^+]_o^{(\\mathrm{new})}}{[K^+]_o^{(0)}} = \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\n因此，新浓度是：\n$$\n[K^+]_o^{(\\mathrm{new})} = [K^+]_o^{(0)} \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\n我们已知以下数值：\n$\\Delta E_K = +10\\,\\mathrm{mV} = 0.010\\,\\mathrm{V}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\,\\mathrm{K}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n$[K^+]_o^{(0)} = 3.0\\,\\mathrm{mM}$\n细胞内浓度 $[K^+]_i = 140\\,\\mathrm{mM}$ 是恒定的，并且没有出现在这个最终表达式中，因为它被消去了。\n\n首先，我们使用一致的国际单位制单位计算无量纲指数。注意 $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$。\n$$\n\\frac{\\Delta E_K F}{RT} = \\frac{(0.010\\,\\mathrm{V})(96485\\,\\mathrm{C\\,mol^{-1}})}{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\,\\mathrm{K})} = \\frac{964.85\\,\\mathrm{J\\,mol^{-1}}}{2577.34\\,\\mathrm{J\\,mol^{-1}}} \\approx 0.37435\n$$\n现在，我们计算新的细胞外钾离子浓度：\n$$\n[K^+]_o^{(\\mathrm{new})} = (3.0\\,\\mathrm{mM}) \\exp(0.37435) \\approx (3.0\\,\\mathrm{mM})(1.45403) \\approx 4.36209\\,\\mathrm{mM}\n$$\n需要计算的量是变化量 $\\Delta [K^+]_o$：\n$$\n\\Delta [K^+]_o = [K^+]_o^{(\\mathrm{new})} - [K^+]_o^{(0)} = 4.36209\\,\\mathrm{mM} - 3.0\\,\\mathrm{mM} = 1.36209\\,\\mathrm{mM}\n$$\n将结果四舍五入到三位有效数字，我们得到 $\\Delta [K^+]_o \\approx 1.36\\,\\mathrm{mM}$。\n\n最后，我们定性解释这种钾离子反转电位的偏移如何调节神经元兴奋性并可能促进向癫痫发作状态的转变。\n1.  **钾离子在静息膜电位中的作用：** 在大多数静息状态下的神经元中，由于漏钾通道的高密度，细胞膜主要对钾离子（$K^+$）具有通透性。因此，神经元的静息膜电位（RMP）非常接近于钾离子的能斯特电位 $E_K$。通常，$E_K$ 是高度负值（例如，约 $-90\\,\\mathrm{mV}$），这建立了神经元的超极化静息状态。\n\n2.  **去极化 $E_K$ 的影响：** 细胞外钾离子浓度 $[K^+]_o$ 的增加，这种情况被称为高钾血症，使得比率 $[K^+]_o / [K^+]_i$ 变大。从能斯特方程可以看出，这使得对数 $\\ln([K^+]_o/[K^+]_i)$ 的负值更小（或更正），导致 $E_K$ 移动到一个更小的负值（即去极化）。在这个问题中，一个 $+10\\,\\mathrm{mV}$ 的偏移可能会将 $E_K$ 从，比如说，$-94\\,\\mathrm{mV}$ 移动到 $-84\\,\\mathrm{mV}$。由于 RMP 紧密跟随 $E_K$，RMP 也会去极化。\n\n3.  **神经元兴奋性的调节：** 去极化的神经元其膜电位更接近于发放动作电位的阈值。这意味着一个更小的兴奋性突触后电位（EPSP）或一个更弱的外部刺激现在足以触发一个峰电位。因此，神经元变得更易兴奋，并且在响应突触输入时发放动作电位的概率更高。\n\n4.  **向癫痫发作状态的转变：** 在一个神经元网络中，这种增加的兴奋性可以引发一个病理性正反馈回路，这是癫痫发生（癫痫产生）的一个关键机制。其顺序如下：\n    *   增加的神经元放电导致在动作电位的复极化阶段，$K^+$ 离子从神经元外流到有限的细胞外空间。\n    *   这种外流导致 $[K^+]_o$ 进一步增加。\n    *   升高的 $[K^+]_o$ 进一步去极化周围神经元的 $E_K$ 和 RMP，使它们更易兴奋且更容易放电。\n    *   这就形成了一个恶性循环：放电 $\\rightarrow$ 增加的 $[K^+]_o$ $\\rightarrow$ 更多的去极化 $\\rightarrow$ 更多的放电。这种失控的兴奋可导致高度同步、高频的簇状放电活动，这是脑电图上癫痫发作的特征。包含动态离子浓度的基于电导的模型明确地捕捉了这种由细胞外钾的缓慢动力学驱动的、从一个稳定的低活动状态到一个病理性的、类似癫痫发作的状态的转变。",
            "answer": "$$\n\\boxed{1.36}\n$$"
        },
        {
            "introduction": "癫痫发作的特征是病理性振荡，而 Wilson-Cowan 模型为我们提供了一个框架，用以理解兴奋性和抑制性神经元群体之间的相互作用如何产生这些节律。本练习将运用线性稳定性分析，精确定位一个稳定的网络在何种条件下会转变为振荡状态（即霍普夫分岔）。这项动手分析将揭示癫痫样振荡的起源，将抽象的数学概念与网络连接的具体变化（例如兴奋性群体内部的复发性连接强度 $w_{EE}$）联系起来 ()。",
            "id": "4017283",
            "problem": "考虑用于计算神经科学中研究癫痫动力学和发作起源的、包含单个兴奋性群体和单个抑制性群体的 Wilson–Cowan 率模型。兴奋性群体活动由 $E(t)$ 表示，抑制性群体活动由 $I(t)$ 表示。假设两个群体均采用阈值线性传递函数，其斜率（增益）分别为 $g_E$ 和 $g_I$，阈值分别为 $\\theta_E$ 和 $\\theta_I$，动力学行为如下：\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big), \\quad\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big),\n$$\n其中 $\\tau_E$ 和 $\\tau_I$ 是膜时间常数（单位：秒），$w_{EE}$ 是兴奋性到兴奋性的耦合，$w_{EI}$ 是抑制性到兴奋性的输入，$w_{IE}$ 是兴奋性到抑制性的输入，$w_{II}$ 是抑制性自耦合，$P_E$ 和 $P_I$ 是恒定的外部输入。阈值线性传递函数为\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}, \\quad S_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}.\n$$\n\n您将在不动点对两个群体都高于阈值的区域内工作，因此可以使用恒定斜率 $g_E$ 和 $g_I$ 进行有效的线性化。从这些模型定义和标准线性系统理论出发，根据第一性原理，推导当参数 $w_{EE}$ 变化时，振荡起始（Hopf 分岔）的解析条件，该条件应以围绕不动点的线性化系统的雅可比矩阵表示。使用二维线性系统的迹和行列式条件，获得临界 $w_{EE}$ 的显式表达式，在该值下，共轭特征值对的实部穿过零。不要假设任何预先存在的公式；从上述定义和一般线性化步骤开始。\n\n然后，设计并实现一个数值线性稳定性分析，通过计算在解析预测的 $w_{EE}$ 值略下方和略上方处的雅可比矩阵特征值，来验证解析临界值。具体来说：\n- 计算高于阈值区域内线性化系统的雅可比矩阵 $A$ 及其特征值。\n- 检查当 $w_{EE}$ 略小于临界值时，不动点是否为稳定焦点（负实部和非零虚部）。\n- 检查当 $w_{EE}$ 略大于临界值时，不动点是否为不稳定焦点（正实部和非零虚部），或者在边界情况下，特征值是否为实数（无振荡）且一个实部变为正数。\n\n对于下述每个测试用例，计算：\n- 解析预测的临界耦合 $w_{EE}^{\\star}$（无单位）。\n- 一个布尔值，指示在 $w_{EE}^{\\star}$ 处的雅可比矩阵行列式是否为正（这是 Hopf 分岔的必要条件）。\n- 一个布尔值，指示系统在略低于 $w_{EE}^{\\star}$ 时是否稳定（特征值的最大实部为负）。\n- 一个布尔值，指示系统在略高于 $w_{EE}^{\\star}$ 时是否不稳定（特征值的最大实部为正）。\n- 一个布尔值，指示在略低于 $w_{EE}^{\\star}$ 时的特征值是否形成复共轭对（非零虚部）。\n- 一个布尔值，指示在略高于 $w_{EE}^{\\star}$ 时的特征值是否形成复共轭对。\n\n使用以下参数集测试套件，这些参数集被选择用于探索与癫痫发作起始建模相关的典型、边界和边缘情况区域：\n\n- 测试用例 1（典型的“理想路径”）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.2$ s$^{-1}$\n  - $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- 测试用例 2（起始时行列式为零的边界条件）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.0$ s$^{-1}$\n  - $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- 测试用例 3（相等的时间常数，强交叉耦合）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.02$ s\n  - $g_E = 1.6$ s$^{-1}$, $g_I = 1.4$ s$^{-1}$\n  - $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$\n  - $\\theta_E = 0.4$, $\\theta_I = 0.4$\n  - $P_E = 0.9$, $P_I = 0.9$\n\n您的程序必须：\n- 实现 $w_{EE}^{\\star}$ 的解析推导，并为每个测试用例计算其值。\n- 构建雅可比矩阵，并在 $w_{EE}^{\\star} - \\varepsilon$ 和 $w_{EE}^{\\star} + \\varepsilon$ 处执行特征值分析，使用一个小的偏移量 $\\varepsilon = 10^{-3}$。\n- 将所有测试用例的输出聚合到单行中，格式化为 Python 风格的列表的列表：\n  $[[w_{EE}^{\\star}, d_+, s_-, u_+, c_-, c_+], \\ldots]$\n  其中 $w_{EE}^{\\star}$ 是一个四舍五入到 $6$ 位小数的浮点数，$d_+$ 是在 $w_{EE}^{\\star}$ 处行列式为正的布尔值，$s_-$ 是在临界值以下稳定的布尔值，$u_+$ 是在临界值以上不稳定的布尔值，$c_-$ 是在临界值以下为复数的布尔值，$c_+$ 是在临界值以上为复数的布尔值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[r_1,b_1,b_2,b_3,b_4,b_5],[r_2,\\ldots],[r_3,\\ldots]]$）。\n- 所有报告的量都是无单位的布尔值或浮点数；表示浮点数时不带单位。\n\n角度单位不适用。输出的任何地方均不使用百分比。模型和参数值在所述上下文中是科学上可信且自洽的。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知信息\n问题提供了以下信息：\n\n**模型方程：**\n双群体 Wilson-Cowan 模型的动力学由以下公式给出：\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big)\n$$\n$$\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big)\n$$\n\n**传递函数：**\n阈值线性传递函数为：\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}\n$$\n$$\nS_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}\n$$\n\n**参数：**\n- 时间常数：$\\tau_E$, $\\tau_I$（单位：秒）\n- 增益：$g_E$, $g_I$（单位：s$^{-1}$）\n- 耦合权重：$w_{EE}$, $w_{EI}$, $w_{IE}$, $w_{II}$（无单位）\n- 外部输入：$P_E$, $P_I$（无单位）\n- 阈值：$\\theta_E$, $\\theta_I$（无单位）\n\n**假设：**\n分析将在不动点对两个群体都高于阈值的区域内进行。这意味着对于不动点附近的任何输入 $x$，有 $S_E(x) = g_E(x - \\theta_E)$ 和 $S_I(x) = g_I(x - \\theta_I)$。\n\n**数值任务参数：**\n- 用于稳定性检查的扰动：$\\varepsilon = 10^{-3}$\n- 测试用例 1：$\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.2$, $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$。\n- 测试用例 2：$\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.0$, $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$。\n- 测试用例 3：$\\tau_E = 0.02$, $\\tau_I = 0.02$, $g_E = 1.6$, $g_I = 1.4$, $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$, $\\theta_E = 0.4$, $\\theta_I = 0.4$, $P_E = 0.9$, $P_I = 0.9$。\n\n\n### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题陈述进行严格评估。\n\n- **科学依据**：该问题基于 Wilson-Cowan 模型，这是理论和计算神经科学中的一个经典模型，用于描述相互作用的神经元群的大尺度动力学。在该模型中研究 Hopf 分岔是研究神经振荡起始机制的标准方法，包括与癫痫（发作起源）相关的现象。该模型和分析牢固地植根于已建立的科学原理。\n- **适定性**：该问题是适定的。它要求进行特定的解析推导（Hopf 分岔参数的临界值）和一组明确定义的数值检验。为每个测试用例提供了所有必要的参数。目标明确，且存在唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n该问题没有显示说明中列出的任何缺陷。它在科学上是合理的、自洽的，并且可以形式化。在模型背景下，提供的参数在物理上是合理的。参数 $P_E, \\theta_E, P_I, \\theta_I$ 定义了不动点，但由于在活动区域内假设了阈值线性增益函数，通过雅可比矩阵进行的稳定性分析不依赖于不动点的具体坐标，而只依赖于系统的参数。因此，它们的存在不会产生冲突，在稳定性计算中不使用它们是给定假设下模型结构的直接结果。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整解答。\n\n## 解答推导与实施计划\n\n问题的核心是执行 Wilson-Cowan 系统的线性稳定性分析，并找到当参数 $w_{EE}$ 变化时发生 Hopf 分岔的条件。\n\n**1. 系统线性化**\n在系统的 不动点 $(E^*, I^*)$ 处于“高于阈值”区域的假设下，发放率函数变为线性：\n$$ S_E(x) = g_E(x - \\theta_E) $$\n$$ S_I(x) = g_I(x - \\theta_I) $$\n将这些代入模型方程，得到一个线性常微分方程组：\n$$ \\tau_E \\frac{dE}{dt} = -E + g_E(w_{EE} E - w_{EI} I + P_E - \\theta_E) $$\n$$ \\tau_I \\frac{dI}{dt} = -I + g_I(w_{IE} E - w_{II} I + P_I - \\theta_I) $$\n我们可以将其重写为标准形式 $\\frac{d\\vec{x}}{dt} = A\\vec{x} + \\vec{b}$，其中 $\\vec{x} = [E, I]^T$：\n$$ \\frac{dE}{dt} = \\frac{1}{\\tau_E}[(g_E w_{EE} - 1)E - g_E w_{EI}I + g_E(P_E - \\theta_E)] $$\n$$ \\frac{dI}{dt} = \\frac{1}{\\tau_I}[g_I w_{IE}E - (g_I w_{II} + 1)I + g_I(P_I - \\theta_I)] $$\n不动点的稳定性由雅可比矩阵 $A$ 的特征值决定，对于这个线性系统，它就是 $E$ 和 $I$ 的系数矩阵：\n$$\nA =\n\\begin{pmatrix}\n\\frac{\\partial (dE/dt)}{\\partial E}  \\frac{\\partial (dE/dt)}{\\partial I} \\\\\n\\frac{\\partial (dI/dt)}{\\partial E}  \\frac{\\partial (dI/dt)}{\\partial I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{g_E w_{EE} - 1}{\\tau_E}  -\\frac{g_E w_{EI}}{\\tau_E} \\\\\n\\frac{g_I w_{IE}}{\\tau_I}  -\\frac{g_I w_{II} + 1}{\\tau_I}\n\\end{pmatrix}\n$$\n\n**2. Hopf 分岔条件**\n当雅可比矩阵的一对复共轭特征值穿过虚轴时，发生 Hopf 分岔。对于一个二维系统，这对应于分岔点的两个条件：\n1. 雅可比矩阵的迹为零：$\\text{Tr}(A) = 0$。这确保了特征值的实部为零（$\\lambda = \\pm i\\omega$）。\n2. 雅可比矩阵的行列式为正：$\\text{Det}(A) > 0$。这确保了特征值是纯虚数（且非零），对应于振荡。如果 $\\text{Det}(A) \\le 0$，则特征值为实数。\n\n雅可比矩阵的迹为：\n$$\n\\text{Tr}(A) = \\frac{g_E w_{EE} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n\n**3. 临界耦合 $w_{EE}^{\\star}$ 的推导**\n我们通过将迹设为零来找到分岔参数的临界值 $w_{EE}^{\\star}$：\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I} = 0\n$$\n求解 $w_{EE}^{\\star}$：\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} = \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n$$\ng_E w_{EE}^{\\star} - 1 = \\frac{\\tau_E}{\\tau_I}(g_I w_{II} + 1)\n$$\n$$\ng_E w_{EE}^{\\star} = 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II})\n$$\n$$\nw_{EE}^{\\star} = \\frac{1}{g_E} \\left( 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II}) \\right)\n$$\n这是临界兴奋性到兴奋性耦合的解析表达式，在该值下，不动点的稳定性发生变化，可能通过 Hopf 分岔。\n\n**4. 数值验证**\n数值任务是验证这个解析结果。对于每个测试用例，我们将：\n1.  使用推导出的公式计算 $w_{EE}^{\\star}$。\n2.  构建在 $w_{EE} = w_{EE}^{\\star}$ 处评估的雅可比矩阵 $A$，并计算其行列式 $\\text{Det}(A^\\star)$。如果 $\\text{Det}(A^\\star) > 0$，则布尔值 $d_+$ 为真。\n3.  为 $w_{EE} = w_{EE}^{\\star} - \\varepsilon$（其中 $\\varepsilon = 10^{-3}$）构建雅可比矩阵 $A_{below}$。我们计算其特征值。如果特征值的最大实部为负，则布尔值 $s_-$（临界值以下稳定）为真。如果特征值形成复共轭对，则布尔值 $c_-$（临界值以下为复数）为真。\n4.  为 $w_{EE} = w_{EE}^{\\star} + \\varepsilon$ 构建雅可比矩阵 $A_{above}$。我们计算其特征值。如果特征值的最大实部为正，则布尔值 $u_+$（临界值以上不稳定）为真。如果特征值形成复共轭对，则布尔值 $c_+$（临界值以上为复数）为真。\n结果（$w_{EE}^{\\star}$, $d_+$, $s_-$, $u_+$, $c_-$, $c_+$）将被计算并按要求格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Wilson-Cowan stability problem for the given test cases.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each tuple contains: (tau_E, tau_I, g_E, g_I, w_EI, w_IE, w_II)\n    # The parameters theta_E, theta_I, P_E, P_I are not needed for the\n    # linear stability analysis in the above-threshold regime.\n    test_cases = [\n        # Test Case 1\n        (0.02, 0.01, 1.0, 1.2, 2.5, 2.5, 0.5),\n        # Test Case 2\n        (0.02, 0.01, 1.0, 1.0, 1.5, 3.0, 0.5),\n        # Test Case 3\n        (0.02, 0.02, 1.6, 1.4, 1.3, 1.3, 0.3),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = analyze_case(params)\n        all_results.append(result)\n\n    # Format the final output as a Python-style list of lists.\n    # Example: [[r1,b1,b2,b3,b4,b5],[r2,...],[r3,...]]\n    formatted_results = []\n    for res in all_results:\n        # Format the float to 6 decimal places, and booleans to lowercase true/false\n        w_ee_str = f\"{res[0]:.6f}\"\n        bool_strs = [str(b).lower() for b in res[1:]]\n        formatted_results.append(f\"[{w_ee_str},{','.join(bool_strs)}]\")\n    \n    final_output_str = f\"[{','.join(formatted_results)}]\"\n    print(final_output_str)\n\ndef analyze_case(params):\n    \"\"\"\n    Performs the full analytical and numerical analysis for a single parameter set.\n    \n    Args:\n        params (tuple): A tuple of model parameters (tau_E, tau_I, g_E, g_I, \n                        w_EI, w_IE, w_II).\n    \n    Returns:\n        list: A list containing [w_ee_star, d_plus, s_minus, u_plus, c_minus, c_plus].\n    \"\"\"\n    tau_E, tau_I, g_E, g_I, w_EI, w_IE, w_II = params\n    epsilon = 1e-3\n    # A small tolerance for floating point comparisons to zero.\n    zero_tol = 1e-9\n\n    # 1. Analytically compute the critical coupling w_EE_star\n    # This is derived from the condition Tr(J) = 0.\n    w_ee_star = (1.0 / g_E) * (1.0 + (tau_E / tau_I) * (1.0 + g_I * w_II))\n\n    def get_jacobian_and_eigs(w_ee, p):\n        \"\"\"Helper to compute Jacobian and its eigenvalues for a given w_ee.\"\"\"\n        tE, tI, gE, gI, wEI, wIE, wII = p\n        \n        # Elements of the Jacobian matrix A\n        A11 = (gE * w_ee - 1.0) / tE\n        A12 = (-gE * wEI) / tE\n        A21 = (gI * wIE) / tI\n        A22 = (-gI * wII - 1.0) / tI\n        \n        jacobian = np.array([[A11, A12], [A21, A22]])\n        eigs = np.linalg.eigvals(jacobian)\n        return jacobian, eigs\n\n    # 2. Check determinant at w_EE = w_ee_star\n    # A Hopf bifurcation requires Det(J) > 0 at the critical point where Tr(J) = 0.\n    J_star, _ = get_jacobian_and_eigs(w_ee_star, params)\n    det_at_star = np.linalg.det(J_star)\n    d_plus = det_at_star > zero_tol\n\n    # 3. Analyze stability just below the critical value\n    _, eigs_below = get_jacobian_and_eigs(w_ee_star - epsilon, params)\n    # System is stable if the largest real part of eigenvalues is negative.\n    s_minus = np.max(eigs_below.real)  0.0\n    # Eigenvalues are complex if any eigenvalue has a non-zero imaginary part.\n    c_minus = np.any(np.abs(eigs_below.imag) > zero_tol)\n\n    # 4. Analyze stability just above the critical value\n    _, eigs_above = get_jacobian_and_eigs(w_ee_star + epsilon, params)\n    # System is unstable if the largest real part of eigenvalues is positive.\n    u_plus = np.max(eigs_above.real) > 0.0\n    # Check for complex conjugate eigenvalues.\n    c_plus = np.any(np.abs(eigs_above.imag) > zero_tol)\n\n    return [w_ee_star, d_plus, s_minus, u_plus, c_minus, c_plus]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "大脑并非一个静态网络；它拥有如稳态可塑性之类的适应性机制，能在更长的时间尺度上调节兴奋性，而这些机制在癫痫中的作用是一个活跃的研究领域。本模拟任务旨在探究一种旨在维持目标活动水平的抑制性可塑性规则，在面对强烈、反复的刺激时如何响应。通过这个练习，学生可以探索这种稳态规则是否能成功保护网络免于癫痫发作，或者在某些条件下它是否会失效，甚至反常地加剧不稳定性，从而深入了解癫痫的长期动态 ()。",
            "id": "4017271",
            "problem": "考虑一个基于速率的双群体 Wilson-Cowan (WC) 皮层网络动力学模型，该模型由一个兴奋性群体（其活动为 $E(t) \\in [0,1]$）和一个抑制性群体（其活动为 $I(t) \\in [0,1]$）组成。假设突触相互作用由有效耦合系数概括，并且从抑制到兴奋的抑制性突触效能根据一个稳态抑制性可塑性规则进行自适应，该规则试图维持一个目标兴奋性设定点。设神经元传递函数为 S 型激活函数 $S(u) = \\dfrac{1}{1 + \\exp\\left(-a\\left(u - \\theta\\right)\\right)}$，其中增益为 $a$，阈值为 $\\theta$。有量纲的时间尺度 $t$ 以秒为单位，兴奋性与抑制性群体的时间常数分别为 $\\tau_E$ 和 $\\tau_I$。\n\n具有抑制性可塑性的 WC 动力学由以下常微分方程组 (ODE) 指定：\n$$\n\\frac{dE}{dt} = \\frac{-E + S\\left(c_1 E - w_{EI}(t) I + P(t) + h_E\\right)}{\\tau_E}, \\quad\n\\frac{dI}{dt} = \\frac{-I + S\\left(c_3 E - w_{II} I + h_I\\right)}{\\tau_I},\n$$\n$$\n\\frac{dw_{EI}}{dt} = \\frac{\\eta \\left(E - E_{\\mathrm{set}}\\right) - \\beta \\left(w_{EI} - w_{0}\\right)}{\\tau_w},\n$$\n其中，$c_1$、$c_3$ 和 $w_{II}$ 是固定的耦合参数，$w_{EI}(t)$ 是从抑制性群体到兴奋性群体的自适应抑制性权重，$h_E$ 和 $h_I$ 是恒定的偏置项，$P(t)$ 是一个时变的外部兴奋性输入，$\\eta$ 是可塑性速率，$E_{\\mathrm{set}}$ 是兴奋性设定点，$\\beta$ 是一个将 $w_{EI}$ 拉向其基线值 $w_0$ 的泄漏项，$\\tau_w$ 是抑制性可塑性的时间尺度。抑制性权重 $w_{EI}(t)$ 是有界的，使得 $w_{\\min} \\le w_{EI}(t) \\le w_{\\max}$；当 $w_{EI}$ 达到 $w_{\\min}$（或 $w_{\\max}$）时，其时间导数被约束为非负（或非正），以确保其保持在界限内。\n\n定义外部输入 $P(t)$ 以一个基线加上一串矩形脉冲来模拟复发性扰动：\n$$\nP(t) = P_{\\mathrm{base}} + \\sum_{k=1}^{K} A_p \\, \\mathbf{1}_{[t_k, t_k + d_p]}(t),\n$$\n其中 $\\mathbf{1}_{[t_k, t_k + d_p]}(t)$ 是区间 $[t_k, t_k + d_p]$ 的指示函数。设参数为 $K = 5$，脉冲起始时间 $\\{t_k\\} = \\{5, 10, 15, 20, 25\\}$（秒），脉冲持续时间 $d_p = 0.5$（秒），脉冲振幅 $A_p = 3.0$，以及基线 $P_{\\mathrm{base}} = 1.8$。使用 $a = 4.0$，$\\theta = 2.5$，$\\tau_E = 0.02$（秒），$\\tau_I = 0.01$（秒），$c_1 = 12.0$，$c_3 = 13.0$，$w_{II} = 11.0$，$h_E = 0.0$，$h_I = 0.0$，基线抑制性权重 $w_0 = 9.0$，抑制性界限 $w_{\\min} = 0.5$，$w_{\\max} = 20.0$，泄漏 $\\beta = 0.1$，以及可塑性时间尺度 $\\tau_w = 5.0$（秒）。初始条件为 $E(0) = 0.05$，$I(0) = 0.05$ 和 $w_{EI}(0) = w_0$。\n\n癫痫发作事件在操作上定义为兴奋性活动 $E(t)$ 超过癫痫阈值 $E_{\\mathrm{sz}} = 0.6$ 至少持续 $T_{\\min} = 0.3$（秒）的任何连续时间区间。如果在整个仿真时域 $T_{\\mathrm{sim}} = 30.0$（秒）内，癫痫发作事件的数量为零，并且长期兴奋性活动在一定容差内与设定点匹配，则宣告系统被抑制性可塑性稳定；具体而言，如果 $E(t)$ 在最后 $T_{\\mathrm{tail}} = 5.0$（秒）的时间平均值，记作 $\\overline{E}_{\\mathrm{tail}}$，满足 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$ 且 $\\varepsilon = 0.05$。\n\n任务：\n- 实现一个数值积分器，在 $t \\in [0, T_{\\mathrm{sim}}]$ 上用给定的参数和分段常数输入 $P(t)$ 求解该 ODE 系统，确保 $w_{EI}(t)$ 的动力学中遵守抑制性权重的边界规则。\n- 根据上述阈值和最小持续时间的定义检测癫痫发作事件，并计算事件数量。\n- 计算 $\\overline{E}_{\\mathrm{tail}}$ 作为 $E(t)$ 在 $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$ 上的平均值。\n- 对于下方的每个测试套件中的参数集，根据上述标准判断系统是否被稳定（布尔值）。\n\n测试套件（每个案例指定 $(\\eta, E_{\\mathrm{set}})$）：\n1. 案例 1（一般情况）：$\\eta = 0.05$, $E_{\\mathrm{set}} = 0.20$。\n2. 案例 2（无塑性边界）：$\\eta = 0.00$, $E_{\\mathrm{set}} = 0.20$。\n3. 案例 3（快速塑性边缘）：$\\eta = 0.50$, $E_{\\mathrm{set}} = 0.20$。\n4. 案例 4（设定点接近癫痫阈值）：$\\eta = 0.05$, $E_{\\mathrm{set}} = 0.55$。\n5. 案例 5（慢速塑性边缘）：$\\eta = 0.005$, $E_{\\mathrm{set}} = 0.20$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来的结果（例如，“[result1,result2,result3,result4,result5]”），其中每个结果是一个布尔值，表示相应测试案例的稳定情况。时间必须以秒为单位处理，所有计算必须遵守指定的单位和定义。不需要用户输入；程序必须运行五个测试案例并打印最终列表。",
            "solution": "核心目标是评估抑制性可塑性（被建模为抑制性突触强度的稳态自适应）是否能稳定网络兴奋性，以抵抗可能引发癫痫样发作的复发性扰动。该推导始于经典的基于速率的神经元群体动力学和一个S型输入输出关系，以及一个有原则的稳态可塑性规则。\n\n基本基础：\n- Wilson–Cowan 速率方程捕捉了兴奋性和抑制性神经元群体之间的相互作用，将群体平均活动动力学表示为向一个非线性传递函数的弛豫过程：$\\dfrac{dE}{dt} = \\dfrac{-E + S(\\cdot)}{\\tau_E}$ 和 $\\dfrac{dI}{dt} = \\dfrac{-I + S(\\cdot)}{\\tau_I}$。这些在计算神经科学中被确立用于模拟皮层动力学和癫痫机制，其中升高的复发性兴奋和减少的抑制可能产生病理性振荡。\n- S型传递函数 $S(u) = \\dfrac{1}{1 + \\exp(-a(u - \\theta))}$ 表示对具有增益 $a$ 和阈值 $\\theta$ 的突触输入的饱和放电率响应。\n- 稳态抑制性可塑性假设抑制性突触会进行自适应以维持一个兴奋性设定点 $E_{\\mathrm{set}}$，通常由一个缓慢的动力学过程表示：$\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$；泄漏项 $\\beta (w_{EI} - w_0)$ 对自适应过程进行正则化，使其朝向基线值 $w_0$ 以防止漂移，并且为符合生理真实性，$w_{EI}$ 是有界的。\n\n模型规范和逻辑：\n1. 动力学：\n   - 兴奋性群体接收自身兴奋 $c_1 E$、通过 $-w_{EI}(t) I$ 的抑制、外部驱动 $P(t)$ 以及偏置 $h_E$。其净输入为 $u_E = c_1 E - w_{EI} I + P(t) + h_E$，因此 $\\dfrac{dE}{dt} = \\dfrac{-E + S(u_E)}{\\tau_E}$。\n   - 抑制性群体接收兴奋 $c_3 E$、自身抑制 $-w_{II} I$ 以及偏置 $h_I$。其净输入为 $u_I = c_3 E - w_{II} I + h_I$，因此 $\\dfrac{dI}{dt} = \\dfrac{-I + S(u_I)}{\\tau_I}$。\n   - 抑制性可塑性演化为 $\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$，并通过在 $w_{EI}$ 处于边界且导数会使其进一步越界时将向外的导数置零来强制执行边界 $w_{\\min} \\le w_{EI} \\le w_{\\max}$。\n\n2. 外部扰动：\n   - 输入 $P(t)$ 是一个基线加上在时刻 $t_k$ 出现的一串振幅为 $A_p$、持续时间为 $d_p$ 的矩形脉冲，产生能够激发癫痫样 $E(t)$ 增长的复发性扰动。这种构造允许对抵抗重复挑战的稳定性进行系统性评估。\n\n3. 癫痫检测和稳定标准：\n   - 癫痫发作事件通过阈值穿越定义：$E(t) > E_{\\mathrm{sz}}$ 持续至少 $T_{\\min}$。在算法上，检查 $E(t)$ 的时间序列；识别并测量高于阈值的连续片段。满足最小持续时间的片段被计数。\n   - 稳定由整个仿真时域 $T_{\\mathrm{sim}}$ 上的两个条件定义：零癫痫发作事件和兴奋性活动收敛到设定点。后者通过计算最后 $T_{\\mathrm{tail}}$ 期间的时间平均值 $\\overline{E}_{\\mathrm{tail}}$ 并检查 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$ 来评估。\n\n算法步骤：\n- 实现 $S(u) = \\dfrac{1}{1+\\exp(-a(u - \\theta))}$。\n- 通过在脉冲窗口上对指示函数求和再加上基线来实现 $P(t)$。由于 ODE 是数值求解的，使用一个给定 $t$ 返回 $P(t)$ 的函数。\n- 构造 ODE 右端函数 $f(t, x)$，其中 $x = [E, I, w_{EI}]$，通过在 $w_{EI}$ 达到边界且原始导数会将其推出该边界时将其导数钳位到零来强制执行其有界动力学。\n- 在 $t \\in [0, T_{\\mathrm{sim}}]$ 上使用数值积分器，并采用适合检测 $T_{\\min}$ 长度事件的采样网格。一个固定的评估网格（例如 $\\Delta t = 10^{-3}$ 秒）确保最小持续时间检测的可靠性：$N = T_{\\mathrm{sim}} / \\Delta t$ 个样本。\n- 求解后，计算：\n  - 布尔掩码 $M[i] = (E(t_i) > E_{\\mathrm{sz}})$。\n  - 识别 $M$ 中为 $1$ 的连续片段；对于每个片段，计算其持续时间 $n_{\\mathrm{seg}} \\times \\Delta t$，如果 $\\ge T_{\\min}$ 则计为一个癫痫发作。\n  - 在 $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$ 上计算 $\\overline{E}_{\\mathrm{tail}}$。\n- 对于每个测试案例，如果癫痫发作计数为零且 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$，则宣告稳定。\n\n测试套件原理：\n- 案例 1 考察了一个中等可塑性速率和低设定点的情况；预计抑制性自适应会充分增加 $w_{EI}$ 以对抗扰动，从而不产生发作事件并收敛到设定点。\n- 案例 2 移除了可塑性（$\\eta = 0$），作为一个边界情况；由于重复的脉冲，癫痫发作可能会复发，并且没有稳态校正可用。\n- 案例 3 设置了高可塑性速率；快速自适应可能会过冲并使动力学失稳，可能阻止收敛或诱发发作事件。\n- 案例 4 将设定点置于癫痫阈值附近；即使有可塑性，将活动维持在 $E_{\\mathrm{sz}}$ 附近也可能使系统对脉冲敏感，可能因发作事件或设定点不匹配而未能满足稳定标准。\n- 案例 5 使用了缓慢的可塑性；在 $T_{\\mathrm{sim}}$ 内，自适应可能过于迟缓，无法避免发作事件，或者未能达到设定点容差。\n\n最终程序为所有五个案例执行这些步骤，按顺序汇总稳定性的布尔值，并以列表表示形式打印单行结果。所有物理量都使用秒作为时间单位；活动是无量纲的分数。不涉及角度或百分比，从而消除了单位的模糊性。输出严格遵守指定格式，不含附加文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Model parameters (fixed across cases)\na = 4.0\ntheta = 2.5\ntau_E = 0.02  # seconds\ntau_I = 0.01  # seconds\nc1 = 12.0\nc3 = 13.0\nw_II = 11.0\nh_E = 0.0\nh_I = 0.0\nw0 = 9.0\nw_min = 0.5\nw_max = 20.0\nbeta = 0.1\ntau_w = 5.0  # seconds\n\n# External input parameters\nP_base = 1.8\nA_p = 3.0\npulse_times = np.array([5.0, 10.0, 15.0, 20.0, 25.0])\npulse_duration = 0.5\n\n# Simulation parameters\nT_sim = 30.0  # seconds\ndt = 1e-3     # seconds, for sampling\nt_eval = np.arange(0.0, T_sim + dt, dt)\n\n# Seizure detection parameters\nE_seizure = 0.6\nT_min = 0.3   # seconds\nT_tail = 5.0  # seconds\neps_tol = 0.05\n\ndef S(u):\n    \"\"\"Sigmoidal transfer function.\"\"\"\n    return 1.0 / (1.0 + np.exp(-a * (u - theta)))\n\ndef P_of_t(t):\n    \"\"\"External input P(t) = baseline + sum of rectangular pulses.\"\"\"\n    p = P_base\n    # Add rectangular pulses\n    for tk in pulse_times:\n        if tk = t and t = tk + pulse_duration:\n            p += A_p\n    return p\n\ndef rhs(t, x, eta, E_set):\n    \"\"\"Right-hand side of the ODE system: [E, I, w_EI].\"\"\"\n    E, I, wEI = x\n\n    # Net inputs\n    uE = c1 * E - wEI * I + P_of_t(t) + h_E\n    uI = c3 * E - w_II * I + h_I\n\n    # Population dynamics\n    dE = (-E + S(uE)) / tau_E\n    dI = (-I + S(uI)) / tau_I\n\n    # Plasticity raw derivative\n    dw_raw = (eta * (E - E_set) - beta * (wEI - w0)) / tau_w\n\n    # Enforce bounds on wEI by zeroing outward derivative at the bounds\n    if wEI = w_min and dw_raw  0.0:\n        dw = 0.0\n    elif wEI >= w_max and dw_raw > 0.0:\n        dw = 0.0\n    else:\n        dw = dw_raw\n\n    return np.array([dE, dI, dw])\n\ndef simulate_case(eta, E_set):\n    \"\"\"Simulate one parameter case and evaluate stabilization.\"\"\"\n    # Initial conditions\n    x0 = np.array([0.05, 0.05, w0])\n\n    # Integrate ODE\n    sol = solve_ivp(\n        fun=lambda t, x: rhs(t, x, eta=eta, E_set=E_set),\n        t_span=(0.0, T_sim),\n        y0=x0,\n        method=\"RK45\",\n        t_eval=t_eval,\n        rtol=1e-6,\n        atol=1e-9,\n    )\n\n    E_series = sol.y[0, :]\n    # Ensure bounds on wEI in state (in case of numerical drift)\n    # Note: rhs already enforces bounds in derivatives; clipping here is conservative.\n    w_series = np.clip(sol.y[2, :], w_min, w_max)\n\n    # Seizure detection: contiguous segments with E > E_seizure for >= T_min\n    above = E_series > E_seizure\n    # Find segment boundaries\n    # We consider transitions from False->True as starts and True->False as ends.\n    diff = np.diff(above.astype(np.int8))\n    starts = np.where(diff == 1)[0] + 1\n    ends = np.where(diff == -1)[0] + 1\n    # Handle case where series starts above threshold\n    if above[0]:\n        starts = np.r_[0, starts]\n    # Handle case where series ends above threshold\n    if above[-1]:\n        ends = np.r_[ends, above.size]\n\n    # Count segments meeting minimum duration\n    min_len = int(np.ceil(T_min / dt))\n    seizure_count = 0\n    for s, e in zip(starts, ends):\n        seg_len = e - s\n        if seg_len >= min_len:\n            seizure_count += 1\n\n    # Compute tail average over last T_tail seconds\n    tail_start_idx = int((T_sim - T_tail) / dt)\n    E_tail = E_series[tail_start_idx:]\n    E_tail_mean = float(np.mean(E_tail))\n\n    # Stabilization criterion\n    stabilized = (seizure_count == 0) and (abs(E_tail_mean - E_set) = eps_tol)\n    return stabilized\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (eta, E_set)\n        (0.05, 0.20),   # Case 1: moderate plasticity\n        (0.00, 0.20),   # Case 2: no plasticity\n        (0.50, 0.20),   # Case 3: fast plasticity\n        (0.05, 0.55),   # Case 4: set-point near seizure threshold\n        (0.005, 0.20),  # Case 5: slow plasticity\n    ]\n\n    results = []\n    for eta, E_set in test_cases:\n        result = simulate_case(eta, E_set)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}