{
    "hands_on_practices": [
        {
            "introduction": "The transition into a seizure is not instantaneous but often driven by slow-acting processes that gradually increase network excitability. One of the most fundamental of these is the activity-dependent accumulation of ions in the extracellular space. This practice takes you back to first principles to explore how an increase in extracellular potassium concentration, $[K^+]_o$, a common consequence of intense neuronal firing, alters the potassium reversal potential ($E_K$) and pushes neurons closer to their firing threshold. By deriving the Nernst relation and calculating the effect of a small change in $[K^+]_o$, you will gain a quantitative understanding of this core ictogenic mechanism .",
            "id": "4017239",
            "problem": "A central mechanism of ictogenesis in computational models of seizure dynamics is the slow modulation of ionic reversal potentials by extracellular ion accumulation. Consider potassium ions and assume ideal solution behavior (activity coefficients equal to $1$). Starting from the equality of electrochemical potentials at equilibrium and the thermodynamic definition of chemical potential in an ideal solution, derive the Nernst relation for potassium and use it to determine the change in extracellular potassium concentration required to produce a depolarizing shift of the potassium Nernst potential by $+10$ millivolts. Assume temperature $T=310\\,\\mathrm{K}$, the universal gas constant $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, Faraday’s constant $F=96485\\,\\mathrm{C\\,mol^{-1}}$, baseline intracellular potassium concentration $[K]_i=140\\,\\mathrm{mM}$, and baseline extracellular potassium concentration $[K]_o^{(0)}=3.0\\,\\mathrm{mM}$. Treat $z=+1$ for potassium. \n\nCompute the required change $\\Delta [K]_o=[K]_o^{(\\mathrm{new})}-[K]_o^{(0)}$ that yields a depolarizing shift $\\Delta E_K=+10\\,\\mathrm{mV}$ in the potassium Nernst potential. Round your answer to three significant figures and express the final numerical value in millimolar (mM). Then, explain qualitatively, using core principles of membrane biophysics and conductance-based modeling, how such a shift in the potassium reversal potential modulates neuronal excitability and can facilitate transitions toward ictal states in network models of seizure dynamics.",
            "solution": "The problem is scientifically grounded, well-posed, and provides all necessary information for a complete solution. We will proceed by first deriving the Nernst relation, then calculating the required change in extracellular potassium concentration, and finally providing a qualitative explanation of the biophysical implications.\n\nFirst, we derive the Nernst relation for a generic ion species $j$ with charge $z_j$. The derivation starts from the definition of the electrochemical potential, $\\tilde{\\mu}_j$, which is the sum of the chemical potential, $\\mu_j$, and the electrical potential energy per mole.\n$$\n\\tilde{\\mu}_j = \\mu_j + z_j F \\phi\n$$\nwhere $F$ is the Faraday constant and $\\phi$ is the electric potential. For an ideal solution, the chemical potential is given by:\n$$\n\\mu_j = \\mu_j^0 + RT \\ln[j]\n$$\nHere, $\\mu_j^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, and $[j]$ is the molar concentration of the ion. Combining these gives the full expression for the electrochemical potential:\n$$\n\\tilde{\\mu}_j = \\mu_j^0 + RT \\ln[j] + z_j F \\phi\n$$\nAt equilibrium, there is no net flux of the ion across the membrane. This condition is met when the electrochemical potential inside the cell (intracellular, subscript $i$) is equal to the electrochemical potential outside the cell (extracellular, subscript $o$):\n$$\n\\tilde{\\mu}_{j,i} = \\tilde{\\mu}_{j,o}\n$$\nSubstituting the expression for $\\tilde{\\mu}_j$:\n$$\n\\mu_j^0 + RT \\ln[j]_i + z_j F \\phi_i = \\mu_j^0 + RT \\ln[j]_o + z_j F \\phi_o\n$$\nThe standard chemical potential $\\mu_j^0$ is identical on both sides and cancels out. Rearranging the terms to solve for the electric potential difference across the membrane, which is defined as the Nernst potential $E_j = \\phi_i - \\phi_o$:\n$$\nz_j F (\\phi_i - \\phi_o) = RT \\ln[j]_o - RT \\ln[j]_i\n$$\n$$\nz_j F E_j = RT \\left( \\ln[j]_o - \\ln[j]_i \\right)\n$$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$, we get:\n$$\nz_j F E_j = RT \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\nFinally, solving for $E_j$ yields the Nernst equation:\n$$\nE_j = \\frac{RT}{z_j F} \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\nFor potassium ions ($K^+$), the charge is $z_K = +1$. The Nernst potential for potassium, $E_K$, is therefore:\n$$\nE_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o}{[K]_i}\\right)\n$$\n\nNext, we use this relation to determine the change in extracellular potassium concentration, $\\Delta [K]_o$, required to produce a depolarizing shift of $\\Delta E_K = +10\\,\\mathrm{mV}$. Let the baseline state be denoted by superscript $(0)$ and the new state by superscript $(\\mathrm{new})$.\nThe baseline potassium Nernst potential is:\n$$\nE_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(0)}}{[K]_i}\\right)\n$$\nThe new potential after the change in extracellular concentration is:\n$$\nE_K^{(\\mathrm{new})} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_i}\\right)\n$$\nThe change in the Nernst potential, $\\Delta E_K$, is the difference between the new and baseline potentials:\n$$\n\\Delta E_K = E_K^{(\\mathrm{new})} - E_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_i}\\right) - \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(0)}}{[K]_i}\\right)\n$$\nFactoring out the $\\frac{RT}{F}$ term and combining the logarithms:\n$$\n\\Delta E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}/[K]_i}{[K]_o^{(0)}/[K]_i}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}}\\right)\n$$\nWe can now solve for the ratio of the new to old extracellular potassium concentrations.\n$$\n\\frac{\\Delta E_K F}{RT} = \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}}\\right)\n$$\nExponentiating both sides gives:\n$$\n\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}} = \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\nThus, the new concentration is:\n$$\n[K]_o^{(\\mathrm{new})} = [K]_o^{(0)} \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\nWe are given the following values:\n$\\Delta E_K = +10\\,\\mathrm{mV} = 0.010\\,\\mathrm{V}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\,\\mathrm{K}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n$[K]_o^{(0)} = 3.0\\,\\mathrm{mM}$\nThe intracellular concentration $[K]_i = 140\\,\\mathrm{mM}$ is constant and does not appear in this final expression, as it cancelled out.\n\nFirst, we calculate the dimensionless exponent using consistent SI units. Note that $1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$.\n$$\n\\frac{\\Delta E_K F}{RT} = \\frac{(0.010\\,\\mathrm{V})(96485\\,\\mathrm{C\\,mol^{-1}})}{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\,\\mathrm{K})} = \\frac{964.85\\,\\mathrm{J\\,mol^{-1}}}{2577.34\\,\\mathrm{J\\,mol^{-1}}} \\approx 0.37435\n$$\nNow, we calculate the new extracellular potassium concentration:\n$$\n[K]_o^{(\\mathrm{new})} = (3.0\\,\\mathrm{mM}) \\exp(0.37435) \\approx (3.0\\,\\mathrm{mM})(1.45403) \\approx 4.36209\\,\\mathrm{mM}\n$$\nThe quantity to be computed is the change $\\Delta [K]_o$:\n$$\n\\Delta [K]_o = [K]_o^{(\\mathrm{new})} - [K]_o^{(0)} = 4.36209\\,\\mathrm{mM} - 3.0\\,\\mathrm{mM} = 1.36209\\,\\mathrm{mM}\n$$\nRounding the result to three significant figures, we obtain $\\Delta [K]_o \\approx 1.36\\,\\mathrm{mM}$.\n\nFinally, we explain qualitatively how this shift in the potassium reversal potential modulates neuronal excitability and can facilitate transitions toward ictal states.\n1.  **Role of Potassium in Resting Membrane Potential:** In most neurons at rest, the cell membrane is predominantly permeable to potassium ions ($K^+$) due to the high density of leak potassium channels. As a result, the resting membrane potential (RMP) of the neuron is very close to the Nernst potential for potassium, $E_K$. Typically, $E_K$ is highly negative (e.g., around $-90\\,\\mathrm{mV}$), which establishes the hyperpolarized resting state of the neuron.\n\n2.  **Effect of Depolarizing $E_K$:** An increase in the extracellular potassium concentration $[K]_o$, a condition known as hyperkalemia, makes the ratio $[K]_o / [K]_i$ larger. As seen from the Nernst equation, this makes the logarithm $\\ln([K]_o/[K]_i)$ less negative (or more positive), causing $E_K$ to shift to a less negative value (i.e., it depolarizes). In this problem, a $+10\\,\\mathrm{mV}$ shift might move $E_K$ from, for example, $-94\\,\\mathrm{mV}$ to $-84\\,\\mathrm{mV}$. Since the RMP closely follows $E_K$, the RMP also depolarizes.\n\n3.  **Modulation of Neuronal Excitability:** A depolarized neuron has its membrane potential closer to the threshold for firing an action potential. This means that a smaller excitatory postsynaptic potential (EPSP) or a weaker external stimulus is now sufficient to trigger a spike. Consequently, the neuron becomes more excitable and has a higher probability of firing action potentials in response to synaptic input.\n\n4.  **Transition to Ictal States:** In a neuronal network, this increased excitability can initiate a pathological positive feedback loop, which is a key mechanism for ictogenesis (seizure generation). The sequence is as follows:\n    *   Increased neuronal firing leads to the efflux of $K^+$ ions from neurons into the restricted extracellular space during the repolarization phase of action potentials.\n    *   This efflux causes a further increase in $[K]_o$.\n    *   The elevated $[K]_o$ further depolarizes $E_K$ and the RMP of surrounding neurons, making them even more excitable and prone to firing.\n    *   This creates a vicious cycle: firing $\\rightarrow$ increased $[K]_o$ $\\rightarrow$ more depolarization $\\rightarrow$ more firing. This runaway excitation can lead to the highly synchronized, high-frequency bursting activity that characterizes an electrographic seizure. Conductance-based models that incorporate dynamic ion concentrations explicitly capture this transition from a stable, low-activity state to a pathological, seizure-like state driven by the slow dynamics of extracellular potassium.",
            "answer": "$$\n\\boxed{1.36}\n$$"
        },
        {
            "introduction": "While changes in ionic gradients set the stage for hyperexcitability, the generation of rhythmic, seizure-like activity is an emergent property of neuronal networks. The balance between excitatory (E) and inhibitory (I) populations is critical for maintaining healthy brain dynamics. This exercise uses the classic Wilson-Cowan rate model to investigate how this E-I balance can break down. You will perform a linear stability analysis to analytically derive the critical point at which a stable network transitions into oscillation—a Hopf bifurcation—and then verify your analytical findings with a numerical simulation, providing a concrete example of how seizure onset can be understood as a fundamental instability in network dynamics .",
            "id": "4017283",
            "problem": "Consider the Wilson–Cowan rate model for a single excitatory population and a single inhibitory population used in computational neuroscience to study seizure dynamics and ictogenesis. The excitatory population activity is denoted by $E(t)$ and the inhibitory population activity is denoted by $I(t)$. Assume threshold-linear transfer functions for both populations, with slopes (gains) $g_E$ and $g_I$, thresholds $\\theta_E$ and $\\theta_I$, and the following dynamics:\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big), \\quad\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big),\n$$\nwhere $\\tau_E$ and $\\tau_I$ are the membrane time constants (in seconds), $w_{EE}$ is the excitatory-to-excitatory coupling, $w_{EI}$ is inhibitory input to excitatory, $w_{IE}$ is excitatory input to inhibitory, $w_{II}$ is inhibitory self-coupling, and $P_E$, $P_I$ are constant external inputs. The threshold-linear transfer functions are\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}, \\quad S_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}.\n$$\n\nYou will work in the regime where the fixed point is above threshold for both populations, so that linearization is valid with constant slopes $g_E$ and $g_I$. Starting from these model definitions and standard linear systems theory, derive from first principles an analytical condition for the onset of oscillations (a Hopf bifurcation) as the parameter $w_{EE}$ is varied, in terms of the Jacobian of the linearized system around the fixed point. Use the trace and determinant conditions for a two-dimensional linear system to obtain an explicit expression for the critical $w_{EE}$ at which the real part of the conjugate pair of eigenvalues crosses zero. Do not assume any pre-existing formula; start from the definitions above and general linearization steps.\n\nThen, design and implement a numerical linear stability analysis to verify the analytical critical value by computing the Jacobian eigenvalues just below and just above the analytically predicted $w_{EE}$ value. Specifically:\n- Compute the Jacobian matrix $A$ of the linearized system in the above-threshold regime and its eigenvalues.\n- Check whether for $w_{EE}$ slightly less than the critical value the fixed point is a stable focus (negative real parts and nonzero imaginary parts).\n- Check whether for $w_{EE}$ slightly greater than the critical value the fixed point is an unstable focus (positive real parts and nonzero imaginary parts), or, in boundary cases, whether the eigenvalues are real (no oscillations) and one real part becomes positive.\n\nFor each test case below, compute:\n- The analytically predicted critical coupling $w_{EE}^{\\star}$ (unitless).\n- A boolean indicating whether the determinant of the Jacobian at $w_{EE}^{\\star}$ is positive (this is required for a Hopf bifurcation).\n- A boolean indicating whether the system is stable just below $w_{EE}^{\\star}$ (maximum real part of eigenvalues is negative).\n- A boolean indicating whether the system is unstable just above $w_{EE}^{\\star}$ (maximum real part of eigenvalues is positive).\n- A boolean indicating whether the eigenvalues just below $w_{EE}^{\\star}$ form a complex conjugate pair (nonzero imaginary part).\n- A boolean indicating whether the eigenvalues just above $w_{EE}^{\\star}$ form a complex conjugate pair.\n\nUse the following test suite of parameter sets, chosen to explore typical, boundary, and edge-case regimes relevant to seizure onset modeling:\n\n- Test Case $1$ (typical \"happy path\"):\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.2$ s$^{-1}$\n  - $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- Test Case $2$ (boundary condition with zero determinant at onset):\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.0$ s$^{-1}$\n  - $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- Test Case $3$ (equal time constants, strong cross-coupling):\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.02$ s\n  - $g_E = 1.6$ s$^{-1}$, $g_I = 1.4$ s$^{-1}$\n  - $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$\n  - $\\theta_E = 0.4$, $\\theta_I = 0.4$\n  - $P_E = 0.9$, $P_I = 0.9$\n\nYour program must:\n- Implement the analytical derivation for $w_{EE}^{\\star}$ and compute it for each test case.\n- Construct the Jacobian and perform the eigenvalue analysis at $w_{EE}^{\\star} - \\varepsilon$ and $w_{EE}^{\\star} + \\varepsilon$, with a small offset $\\varepsilon = 10^{-3}$.\n- Aggregate the outputs for all test cases into a single line, formatted as a Python-style list of lists:\n  $[[w_{EE}^{\\star}, d_+, s_-, u_+, c_-, c_+], \\ldots]$\n  where $w_{EE}^{\\star}$ is a float rounded to $6$ decimal places, $d_+$ is the determinant-positive boolean at $w_{EE}^{\\star}$, $s_-$ is the stable-below boolean, $u_+$ is the unstable-above boolean, $c_-$ is the complex-below boolean, and $c_+$ is the complex-above boolean.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[[r_1,b_1,b_2,b_3,b_4,b_5],[r_2,\\ldots],[r_3,\\ldots]]$).\n- All reported quantities are unitless booleans or floats; express floats without units.\n\nAngle units are not applicable. No percentages are used anywhere in the output. The model and parameter values are scientifically plausible and self-consistent for the stated context.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n\n**Model Equations:**\nThe dynamics of the two-population Wilson-Cowan model are given by:\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big)\n$$\n$$\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big)\n$$\n\n**Transfer Functions:**\nThe threshold-linear transfer functions are:\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}\n$$\n$$\nS_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}\n$$\n\n**Parameters:**\n- Time constants: $\\tau_E$, $\\tau_I$ (in seconds)\n- Gains: $g_E$, $g_I$ (in s$^{-1}$)\n- Coupling weights: $w_{EE}$, $w_{EI}$, $w_{IE}$, $w_{II}$ (unitless)\n- External inputs: $P_E$, $P_I$ (unitless)\n- Thresholds: $\\theta_E$, $\\theta_I$ (unitless)\n\n**Assumption:**\nThe analysis is to be performed in the regime where the fixed point is above threshold for both populations. This implies that for any input $x$ near the fixed point, $S_E(x) = g_E(x - \\theta_E)$ and $S_I(x) = g_I(x - \\theta_I)$.\n\n**Numerical Task Parameters:**\n- Perturbation for stability check: $\\varepsilon = 10^{-3}$\n- Test Case $1$: $\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.2$, $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$.\n- Test Case $2$: $\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.0$, $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$.\n- Test Case $3$: $\\tau_E = 0.02$, $\\tau_I = 0.02$, $g_E = 1.6$, $g_I = 1.4$, $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$, $\\theta_E = 0.4$, $\\theta_I = 0.4$, $P_E = 0.9$, $P_I = 0.9$.\n\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is critically evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem is based on the Wilson-Cowan model, a canonical model in theoretical and computational neuroscience used to describe the large-scale dynamics of interacting neuronal populations. The study of Hopf bifurcations in this model is a standard method for investigating the mechanisms of neural oscillation onset, including phenomena relevant to epilepsy (ictogenesis). The model and the analysis are firmly rooted in established scientific principles.\n- **Well-Posed**: The problem is well-posed. It asks for a specific analytical derivation (the critical value of a parameter for a Hopf bifurcation) and a set of well-defined numerical checks. All necessary parameters are provided for each test case. The objective is clear and a unique solution exists.\n- **Objective**: The problem is stated in precise, objective mathematical language, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the instructions. It is scientifically sound, self-contained, and formalizable. The provided parameters are physically plausible within the context of the model. The parameters $P_E, \\theta_E, P_I, \\theta_I$ define the fixed point, but due to the assumption of a threshold-linear gain function in the active regime, the stability analysis via the Jacobian does not depend on the fixed point's specific coordinates, only on the system's parameters. Thus, their presence does not create a conflict, and their non-use in the stability calculation is a direct consequence of the model's structure under the given assumption.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n## Solution Derivation and Implementation Plan\n\nThe core of the problem is to perform a linear stability analysis of the Wilson-Cowan system and find the condition for a Hopf bifurcation as the parameter $w_{EE}$ is varied.\n\n**1. System Linearization**\nUnder the assumption that the system's fixed point $(E^*, I^*)$ is in the \"above-threshold\" regime, the firing rate functions become linear:\n$$ S_E(x) = g_E(x - \\theta_E) $$\n$$ S_I(x) = g_I(x - \\theta_I) $$\nSubstituting these into the model equations gives a system of linear ordinary differential equations:\n$$ \\tau_E \\frac{dE}{dt} = -E + g_E(w_{EE} E - w_{EI} I + P_E - \\theta_E) $$\n$$ \\tau_I \\frac{dI}{dt} = -I + g_I(w_{IE} E - w_{II} I + P_I - \\theta_I) $$\nWe can rewrite this in the standard form $\\frac{d\\vec{x}}{dt} = A\\vec{x} + \\vec{b}$ where $\\vec{x} = [E, I]^T$:\n$$ \\frac{dE}{dt} = \\frac{1}{\\tau_E}[(g_E w_{EE} - 1)E - g_E w_{EI}I + g_E(P_E - \\theta_E)] $$\n$$ \\frac{dI}{dt} = \\frac{1}{\\tau_I}[g_I w_{IE}E - (g_I w_{II} + 1)I + g_I(P_I - \\theta_I)] $$\nThe stability of the fixed point is determined by the eigenvalues of the Jacobian matrix $A$, which for this linear system is simply the matrix of coefficients of $E$ and $I$:\n$$\nA =\n\\begin{pmatrix}\n\\frac{\\partial (dE/dt)}{\\partial E} & \\frac{\\partial (dE/dt)}{\\partial I} \\\\\n\\frac{\\partial (dI/dt)}{\\partial E} & \\frac{\\partial (dI/dt)}{\\partial I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{g_E w_{EE} - 1}{\\tau_E} & -\\frac{g_E w_{EI}}{\\tau_E} \\\\\n\\frac{g_I w_{IE}}{\\tau_I} & -\\frac{g_I w_{II} + 1}{\\tau_I}\n\\end{pmatrix}\n$$\n\n**2. Hopf Bifurcation Condition**\nA Hopf bifurcation occurs when a pair of complex conjugate eigenvalues of the Jacobian crosses the imaginary axis. For a 2D system, this corresponds to two conditions at the bifurcation point:\n1. The trace of the Jacobian is zero: $\\text{Tr}(A) = 0$. This ensures the real part of the eigenvalues is zero ($\\lambda = \\pm i\\omega$).\n2. The determinant of the Jacobian is positive: $\\text{Det}(A) > 0$. This ensures the eigenvalues are purely imaginary (and non-zero), corresponding to oscillations. If $\\text{Det}(A) \\le 0$, the eigenvalues are real.\n\nThe trace of the Jacobian is:\n$$\n\\text{Tr}(A) = \\frac{g_E w_{EE} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n\n**3. Derivation of Critical Coupling $w_{EE}^{\\star}$**\nWe find the critical value of the bifurcation parameter, $w_{EE}^{\\star}$, by setting the trace to zero:\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I} = 0\n$$\nSolving for $w_{EE}^{\\star}$:\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} = \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n$$\ng_E w_{EE}^{\\star} - 1 = \\frac{\\tau_E}{\\tau_I}(g_I w_{II} + 1)\n$$\n$$\ng_E w_{EE}^{\\star} = 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II})\n$$\n$$\nw_{EE}^{\\star} = \\frac{1}{g_E} \\left( 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II}) \\right)\n$$\nThis is the analytical expression for the critical excitatory-to-excitatory coupling at which the fixed point's stability changes, potentially via a Hopf bifurcation.\n\n**4. Numerical Verification**\nThe numerical task is to verify this analytical result. For each test case, we will:\n1.  Calculate $w_{EE}^{\\star}$ using the derived formula.\n2.  Construct the Jacobian matrix $A$ evaluated at $w_{EE} = w_{EE}^{\\star}$ and compute its determinant, $\\text{Det}(A^\\star)$. The boolean $d_+$ will be true if $\\text{Det}(A^\\star) > 0$.\n3.  Construct the Jacobian $A_{below}$ for $w_{EE} = w_{EE}^{\\star} - \\varepsilon$ with $\\varepsilon = 10^{-3}$. We calculate its eigenvalues. The boolean $s_-$ (stable-below) is true if the maximum of the real parts of the eigenvalues is negative. The boolean $c_-$ (complex-below) is true if the eigenvalues form a complex conjugate pair.\n4.  Construct the Jacobian $A_{above}$ for $w_{EE} = w_{EE}^{\\star} + \\varepsilon$. We calculate its eigenvalues. The boolean $u_+$ (unstable-above) is true if the maximum of the real parts of the eigenvalues is positive. The boolean $c_+$ (complex-above) is true if the eigenvalues form a complex conjugate pair.\n\nThe results ($w_{EE}^{\\star}$, $d_+$, $s_-$, $u_+$, $c_-$, $c_+$) will be computed and formatted as requested.",
            "answer": "[[4.200000,true,true,true,true,true],[4.000000,false,true,true,true,true],[1.512500,true,true,true,true,true]]"
        },
        {
            "introduction": "Neural circuits are not static; they are endowed with adaptive mechanisms that regulate their own activity over longer timescales. Homeostatic plasticity is one such mechanism, thought to stabilize neuronal firing rates against perturbations. This practice extends the Wilson-Cowan framework to include a homeostatic rule that adjusts inhibitory synaptic strength to maintain a target level of network activity. By simulating this adaptive system in the face of seizure-provoking stimuli, you will explore the complex role of plasticity: can it successfully stabilize the network and prevent seizures, or can it fail or even paradoxically contribute to pathological dynamics under certain conditions? ",
            "id": "4017271",
            "problem": "Consider a rate-based, two-population Wilson–Cowan (WC) model for cortical network dynamics, consisting of an excitatory population with activity $E(t) \\in [0,1]$ and an inhibitory population with activity $I(t) \\in [0,1]$. Assume synaptic interactions are summarized by effective coupling coefficients, and that the inhibitory synaptic efficacy from inhibition onto excitation adapts according to a homeostatic inhibitory plasticity rule that attempts to maintain a target excitability set-point. Let the neuronal transfer function be a sigmoidal activation function $S(u) = \\dfrac{1}{1 + \\exp\\left(-a\\left(u - \\theta\\right)\\right)}$ with gain $a$ and threshold $\\theta$. The dimensional timescales are $t$ in seconds, with excitatory and inhibitory population time constants $\\tau_E$ and $\\tau_I$ respectively.\n\nThe WC dynamics with inhibitory plasticity are specified by the following system of ordinary differential equations (ODEs):\n$$\n\\frac{dE}{dt} = \\frac{-E + S\\left(c_1 E - w_{EI}(t) I + P(t) + h_E\\right)}{\\tau_E}, \\quad\n\\frac{dI}{dt} = \\frac{-I + S\\left(c_3 E - w_{II} I + h_I\\right)}{\\tau_I},\n$$\n$$\n\\frac{dw_{EI}}{dt} = \\frac{\\eta \\left(E - E_{\\mathrm{set}}\\right) - \\beta \\left(w_{EI} - w_{0}\\right)}{\\tau_w},\n$$\nwhere $c_1$, $c_3$, and $w_{II}$ are fixed coupling parameters, $w_{EI}(t)$ is the adapting inhibitory weight from the inhibitory population onto the excitatory population, $h_E$ and $h_I$ are constant bias terms, $P(t)$ is a time-varying external excitatory input, $\\eta$ is the plasticity rate, $E_{\\mathrm{set}}$ is the excitability set-point, $\\beta$ is a leak term that pulls $w_{EI}$ toward its baseline $w_0$, and $\\tau_w$ is the inhibitory plasticity timescale. The inhibitory weight $w_{EI}(t)$ is bounded so that $w_{\\min} \\le w_{EI}(t) \\le w_{\\max}$; when $w_{EI}$ reaches $w_{\\min}$ (respectively $w_{\\max}$), its time derivative is constrained to be nonnegative (respectively nonpositive) to ensure it remains within the bounds.\n\nDefine the external input $P(t)$ to model recurrent perturbations by a baseline plus a train of rectangular pulses:\n$$\nP(t) = P_{\\mathrm{base}} + \\sum_{k=1}^{K} A_p \\, \\mathbf{1}_{[t_k, t_k + d_p]}(t),\n$$\nwhere $\\mathbf{1}_{[t_k, t_k + d_p]}(t)$ is the indicator function of the interval $[t_k, t_k + d_p]$. Let the parameters be $K = 5$, pulse onset times $\\{t_k\\} = \\{5, 10, 15, 20, 25\\}$ (seconds), pulse duration $d_p = 0.5$ (seconds), pulse amplitude $A_p = 3.0$, and baseline $P_{\\mathrm{base}} = 1.8$. Use $a = 4.0$, $\\theta = 2.5$, $\\tau_E = 0.02$ (seconds), $\\tau_I = 0.01$ (seconds), $c_1 = 12.0$, $c_3 = 13.0$, $w_{II} = 11.0$, $h_E = 0.0$, $h_I = 0.0$, baseline inhibitory weight $w_0 = 9.0$, inhibitory bounds $w_{\\min} = 0.5$, $w_{\\max} = 20.0$, leak $\\beta = 0.1$, and plasticity timescale $\\tau_w = 5.0$ (seconds). The initial conditions are $E(0) = 0.05$, $I(0) = 0.05$, and $w_{EI}(0) = w_0$.\n\nA seizure episode is operationally defined as any contiguous time interval during which the excitatory activity $E(t)$ exceeds a seizure threshold $E_{\\mathrm{sz}} = 0.6$ for at least $T_{\\min} = 0.3$ (seconds). The system is declared stabilized by inhibitory plasticity if, over the entire simulation horizon $T_{\\mathrm{sim}} = 30.0$ (seconds), the number of seizure episodes is zero and the long-term excitatory activity matches the set-point within a tolerance; concretely, if the time-average of $E(t)$ over the last $T_{\\mathrm{tail}} = 5.0$ (seconds), denoted $\\overline{E}_{\\mathrm{tail}}$, satisfies $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$ with $\\varepsilon = 0.05$.\n\nTasks:\n- Implement a numerical integrator to solve the ODE system over $t \\in [0, T_{\\mathrm{sim}}]$ with the given parameters and piecewise-constant input $P(t)$, ensuring the inhibitory weight bounding rule is respected in the dynamics of $w_{EI}(t)$.\n- Detect seizure episodes according to the threshold and minimum-duration definition above, and compute the number of episodes.\n- Compute $\\overline{E}_{\\mathrm{tail}}$ as the average of $E(t)$ over $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$.\n- For each parameter set in the test suite below, decide whether the system is stabilized (boolean) according to the above criterion.\n\nTest suite (each case specifies $(\\eta, E_{\\mathrm{set}})$):\n1. Case $1$ (general case): $\\eta = 0.05$, $E_{\\mathrm{set}} = 0.20$.\n2. Case $2$ (no plasticity boundary): $\\eta = 0.00$, $E_{\\mathrm{set}} = 0.20$.\n3. Case $3$ (fast plasticity edge): $\\eta = 0.50$, $E_{\\mathrm{set}} = 0.20$.\n4. Case $4$ (set-point near seizure threshold): $\\eta = 0.05$, $E_{\\mathrm{set}} = 0.55$.\n5. Case $5$ (slow plasticity edge): $\\eta = 0.005$, $E_{\\mathrm{set}} = 0.20$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is a boolean value indicating stabilization for the corresponding test case. Time must be treated in seconds, and all calculations must adhere to the specified units and definitions. No user input is required; the program must run the five test cases and print the final list.",
            "solution": "The central objective is to assess whether inhibitory plasticity, modeled as a homeostatic adaptation of inhibitory synaptic strength, stabilizes network excitability against recurrent perturbations that could precipitate seizure-like episodes. The derivation starts from canonical rate-based neuronal population dynamics and a sigmoidal input-output relation, together with a principled homeostatic plasticity rule.\n\nFundamental base:\n- Wilson–Cowan rate equations capture interactions between excitatory and inhibitory neuronal populations, expressing population-averaged activity dynamics as relaxation toward a nonlinear transfer function: $\\dfrac{dE}{dt} = \\dfrac{-E + S(\\cdot)}{\\tau_E}$ and $\\dfrac{dI}{dt} = \\dfrac{-I + S(\\cdot)}{\\tau_I}$. These are established in computational neuroscience for modeling cortical dynamics and seizure mechanisms, where elevated recurrent excitation and reduced inhibition can yield pathological oscillations.\n- Sigmoidal transfer functions $S(u) = \\dfrac{1}{1 + \\exp(-a(u - \\theta))}$ represent saturating firing-rate responses to synaptic inputs with gain $a$ and threshold $\\theta$.\n- Homeostatic inhibitory plasticity posits that inhibitory synapses adapt to maintain an excitability set-point $E_{\\mathrm{set}}$, often represented by a slow dynamics $\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$; the leak term $\\beta (w_{EI} - w_0)$ regularizes the adaptation toward a baseline $w_0$ to prevent drift, and $w_{EI}$ is bounded for physiological realism.\n\nModel specification and logic:\n1. Dynamics:\n   - Excitatory population receives self-excitation $c_1 E$, inhibition via $-w_{EI}(t) I$, and external drive $P(t)$ plus bias $h_E$. Its net input is $u_E = c_1 E - w_{EI} I + P(t) + h_E$, so $\\dfrac{dE}{dt} = \\dfrac{-E + S(u_E)}{\\tau_E}$.\n   - Inhibitory population receives excitation $c_3 E$, self-inhibition $-w_{II} I$, and bias $h_I$. Its net input is $u_I = c_3 E - w_{II} I + h_I$, so $\\dfrac{dI}{dt} = \\dfrac{-I + S(u_I)}{\\tau_I}$.\n   - Inhibitory plasticity evolves as $\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$, with the bounds $w_{\\min} \\le w_{EI} \\le w_{\\max}$ enforced by zeroing the outward derivative when $w_{EI}$ is at the bound and the derivative would push it further out-of-bounds.\n\n2. External perturbations:\n   - The input $P(t)$ is a baseline plus a train of rectangular pulses with amplitude $A_p$ and duration $d_p$ at times $t_k$, producing recurrent perturbations that can provoke seizure-like increases in $E(t)$. This construction allows systematic evaluation of stability against repeated challenges.\n\n3. Seizure detection and stabilization criterion:\n   - A seizure episode is defined via threshold crossing: $E(t) > E_{\\mathrm{sz}}$ continuously for at least $T_{\\min}$. Algorithmically, the time series of $E(t)$ is examined; contiguous segments above threshold are identified and measured. Segments meeting the minimum duration are counted.\n   - Stabilization is defined by two conditions over the full simulation horizon $T_{\\mathrm{sim}}$: zero seizure episodes and convergence of the excitatory activity to the set-point. The latter is evaluated by computing the time-average $\\overline{E}_{\\mathrm{tail}}$ over the last $T_{\\mathrm{tail}}$ and checking $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$.\n\nAlgorithmic steps:\n- Implement $S(u) = \\dfrac{1}{1+\\exp(-a(u - \\theta))}$.\n- Implement $P(t)$ by summing indicator functions over pulse windows plus baseline. Since the ODE is solved numerically, a function that returns $P(t)$ given $t$ is used.\n- Construct the ODE right-hand side function $f(t, x)$ where $x = [E, I, w_{EI}]$, enforcing the bounded dynamics of $w_{EI}$ by clamping its derivative to zero when at a bound and the raw derivative would push it beyond that bound.\n- Use a numerical integrator over $t \\in [0, T_{\\mathrm{sim}}]$, with a sampling grid suitable for detecting $T_{\\min}$-length episodes. A fixed evaluation grid (e.g., $\\Delta t = 10^{-3}$ (seconds)) ensures that minimum-duration detection is reliable: $N = T_{\\mathrm{sim}} / \\Delta t$ samples.\n- After solving, compute:\n  - Boolean mask $M[i] = (E(t_i) > E_{\\mathrm{sz}})$.\n  - Identify contiguous segments in $M$ where it is $1$; for each segment, compute its duration $n_{\\mathrm{seg}} \\times \\Delta t$, count it as a seizure if $\\ge T_{\\min}$.\n  - Compute $\\overline{E}_{\\mathrm{tail}}$ over $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$.\n- For each test case, declare stabilization if the seizure count is zero and $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$.\n\nTest suite rationale:\n- Case $1$ examines a moderate plasticity rate with a low set-point; inhibitory adaptation is expected to increase $w_{EI}$ sufficiently to counteract perturbations, yielding no episodes and convergence to the set-point.\n- Case $2$ removes plasticity ($\\eta = 0$), serving as a boundary; seizures may recur due to repeated pulses, and no homeostatic correction is available.\n- Case $3$ sets a high plasticity rate; rapid adaptation can overshoot and destabilize dynamics, potentially preventing convergence or inducing episodes.\n- Case $4$ puts the set-point near the seizure threshold; even with plasticity, maintaining activity near $E_{\\mathrm{sz}}$ can make the system sensitive to pulses, potentially failing the stabilization criterion either due to episodes or set-point mismatch.\n- Case $5$ uses slow plasticity; adaptation may be too sluggish within $T_{\\mathrm{sim}}$ to avert episodes, or fail to reach the set-point tolerance.\n\nThe final program implements these steps for all five cases, aggregates the stabilization booleans in order, and prints a single line with the list representation. All physical quantities use seconds for time; activities are dimensionless fractions. No angles or percentages are involved, eliminating unit ambiguities. The output adheres strictly to the specified format without additional text.",
            "answer": "[true,false,true,false,false]"
        }
    ]
}