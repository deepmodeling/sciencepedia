{
    "hands_on_practices": [
        {
            "introduction": "在我们深入研究神经雪崩的理论和统计复杂性之前，首先必须掌握其基本量的计算。本练习将通过一个具体的、假设的场景来巩固您对核心概念的理解，例如如何从离散化的神经尖峰活动中定义和量化雪崩的大小和持续时间。这构成了后续所有分析的基础 。",
            "id": "4292846",
            "problem": "在一个 $200\\,\\mathrm{ms}$ 的时间窗口内观察到一个循环神经网络的尖峰栅格图，并将其离散化为宽度为 $2\\,\\mathrm{ms}$ 的时间窗。在标准的神经雪崩框架中，一次雪崩被定义为一段最长的、由非零活动（无静息时间窗）的连续时间窗构成的序列，其前后紧邻静息时间窗（活动为零的时间窗）。雪崩大小是指在一次雪崩中所有时间窗内累积的活跃神经元事件总数。雪崩持续时间是指雪崩中连续活跃时间窗所跨越的时间。平均雪崩速率是指在雪崩持续时间内，单位时间内的活跃神经元事件总数。\n\n假设在一段由 $8$ 个连续活跃时间窗组成的序列中，每个时间窗内恰好有 $50$ 个神经元活跃，且在该序列的第一个和最后一个活跃时间窗之间没有静息时间窗。又假设该序列前后紧邻静息时间窗，从而构成一次单独的雪崩。使用这些定义，计算雪崩的大小、持续时间和平均速率。将雪崩大小表示为无量纲的计数，雪崩持续时间以毫秒为单位，平均速率以赫兹（Hz）为单位。无需四舍五入；报告精确值。",
            "solution": "该问题要求计算与单次神经雪崩相关的三个量：其大小、持续时间和平均速率。我们已获得根据其定义计算这些值所需的参数。\n\n设 $N_{bins}$ 为雪崩中连续活跃时间窗的数量，设 $N_{events\\_per\\_bin}$ 为每个时间窗内的活跃神经元事件数。设 $\\Delta t$ 为单个时间窗的宽度。\n\n根据问题陈述，我们有：\n-   活跃时间窗数量，$N_{bins} = 8$。\n-   每个时间窗的事件数，$N_{events\\_per\\_bin} = 50$。\n-   时间窗宽度，$\\Delta t = 2\\,\\mathrm{ms}$。\n\n首先，我们计算**雪崩大小**，记为 $S$。大小定义为雪崩中所有时间窗内累积的活跃神经元事件总数。由于 $N_{bins}$ 个时间窗中的每一个都有 $N_{events\\_per\\_bin}$ 个事件，总大小是它们的乘积。\n$$S = N_{bins} \\times N_{events\\_per\\_bin}$$\n代入给定值：\n$$S = 8 \\times 50 = 400$$\n雪崩大小是事件的无量纲计数。因此，$S = 400$。\n\n其次，我们计算**雪崩持续时间**，记为 $D$。持续时间定义为雪崩的连续活跃时间窗所跨越的总时间。这是活跃时间窗数量与每个时间窗宽度的乘积。\n$$D = N_{bins} \\times \\Delta t$$\n代入给定值：\n$$D = 8 \\times 2\\,\\mathrm{ms} = 16\\,\\mathrm{ms}$$\n问题要求持续时间以毫秒为单位，所以 $D = 16\\,\\mathrm{ms}$。\n\n第三，我们计算**平均雪崩速率**，记为 $R$。这被定义为雪崩持续时间内单位时间的活跃神经元事件总数。这是雪崩大小 $S$ 与雪崩持续时间 $D$ 的比率。\n$$R = \\frac{S}{D}$$\n问题要求速率以赫兹（$\\mathrm{Hz}$）表示，这相当于事件/秒（$\\mathrm{s}^{-1}$）。我们必须首先将持续时间 $D$ 从毫秒转换为秒。\n$$D = 16\\,\\mathrm{ms} = 16 \\times 10^{-3}\\,\\mathrm{s}$$\n现在我们可以计算速率：\n$$R = \\frac{400 \\text{ events}}{16 \\times 10^{-3}\\,\\mathrm{s}} = \\frac{400}{16} \\times 10^3\\,\\mathrm{Hz}$$\n$$R = 25 \\times 10^3\\,\\mathrm{Hz} = 25000\\,\\mathrm{Hz}$$\n用标准科学记数法表示：\n$$R = 2.5 \\times 10^4\\,\\mathrm{Hz}$$\n\n计算出的三个量是：\n-   雪崩大小：$400$\n-   雪崩持续时间：$16\\,\\mathrm{ms}$\n-   平均雪崩速率：$25000\\,\\mathrm{Hz}$ 或 $2.5 \\times 10^4\\,\\mathrm{Hz}$\n\n最终答案应按指定顺序呈现这三个数值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 400  16  2.5 \\times 10^4 \\end{pmatrix}}$$"
        },
        {
            "introduction": "神经雪崩的关键特征是其遵循幂律分布的事件大小。本练习将引导您探索这一标志性特征的理论起源，您将从第一性原理出发，推导出在临界状态下的分支过程如何自然地产生经典的 $S^{-3/2}$ 幂律。掌握这一推导对于深刻理解临界性假说至关重要 。",
            "id": "4002313",
            "problem": "在一个简化的神经雪崩模型中，考虑一个离散时间的 Galton-Watson 分支过程。在该过程中，第 $t$ 代的每个活动神经元在第 $t+1$ 代产生随机数量 $K$ 的活动后代。假设该过程由第 $t=0$ 代的单个活动神经元引发，后代数量在不同神经元和不同代之间是独立同分布的，并且该过程是临界的，其平均后代数为 $\\mathbb{E}[K]=m=1$，方差为有限非零值 $\\mathrm{Var}(K)=\\sigma^{2}\\in(0,\\infty)$。将雪崩规模 $S$ 定义为直至灭绝的所有代中活动神经元的总数，包括初始神经元。\n\n设 $f(u)=\\sum_{k=0}^{\\infty} p_{k} u^{k}$ 表示 $K$ 的概率生成函数 (PGF)，并设 $T(z)=\\sum_{s=1}^{\\infty} \\mathbb{P}(S=s) z^{s}$ 表示雪崩规模 $S$ 的 PGF。从分支过程的第一性原理和概率生成函数 (PGF) 的性质出发，完成以下任务：\n\n- 根据分支特性和 $S$ 的定义，构建 $T(z)$ 和 $f(u)$ 之间的函数关系。\n- 在临界条件 $\\mathbb{E}[K]=1$ 和有限方差 $\\sigma^{2}$ 下，分析 $T(z)$ 在 $z=1$ 邻域内的行为。\n- 使用关于具有平方根奇点的生成函数的系数渐近性的标准转移定理，推导当 $s$ 很大时雪崩规模分布 $\\mathbb{P}(S=s)$ 的渐近形式。\n\n在渐近定律中，报告系数 $C$（一个仅用 $\\sigma$ 表示的闭式解析表达式）\n$$\n\\mathbb{P}(S=s)\\sim C\\, s^{-3/2}\\quad \\text{as } s\\to\\infty.\n$$\n你的最终答案必须仅为 $C$ 的表达式。不需要数值近似，也不涉及单位。",
            "solution": "该问题要求在临界 Galton-Watson 分支过程中，推导雪崩规模分布的渐近定律 $\\mathbb{P}(S=s)\\sim C s^{-3/2}$ 中的系数 $C$。该过程从单个个体开始，平均后代数为 $\\mathbb{E}[K]=m=1$（临界状态），后代方差为有限非零值 $\\mathrm{Var}(K)=\\sigma^2$。\n\n首先，我们建立雪崩规模的概率生成函数 (PGF) $T(z) = \\sum_{s=1}^{\\infty} \\mathbb{P}(S=s) z^{s}$ 与后代分布的 PGF $f(u) = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k) u^{k}$ 之间的函数关系。总雪崩规模 $S$ 是初始祖先（规模为1）与其 $K$ 个后代引发的子雪崩规模之和。设初始祖先的后代数量为 $K$。这 $K$ 个后代中的每一个都开始一个新的、独立的分支过程，每个子雪崩的规模（记为 $S_i$，对于 $i=1, \\ldots, K$）与 $S$ 具有相同的分布。因此，总规模为 $S=1+\\sum_{i=1}^{K} S_i$。\n\n我们可以使用全期望定律写出 $S$ 的 PGF：\n$$T(z) = \\mathbb{E}[z^S] = \\mathbb{E}\\left[z^{1+\\sum_{i=1}^{K} S_i}\\right] = z \\cdot \\mathbb{E}\\left[\\mathbb{E}\\left[z^{\\sum_{i=1}^{K} S_i} \\Big| K\\right]\\right]$$\n由于 $S_i$ 是独立同分布的，在给定 $K=k$ 的条件下，它们之和的 PGF 是它们各自 PGF 的乘积：$\\mathbb{E}\\left[z^{\\sum_{i=1}^{k} S_i}\\right] = \\left(\\mathbb{E}[z^S]\\right)^k = (T(z))^k$。\n对 $K$ 取期望，我们得到 $\\mathbb{E}[(T(z))^K] = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k) (T(z))^k$，根据定义，这正是 $K$ 的 PGF 在 $u=T(z)$ 处的值。因此，我们有：\n$$T(z) = z \\cdot f(T(z))$$\n这是总后代数的 PGF 的基本函数方程。\n\n接下来，我们分析该方程在 $z=1$ 邻域内的行为。对于临界过程，最终灭绝的概率为 1，即 $\\mathbb{P}(S  \\infty)=1$。因此，当 $z \\to 1^{-}$ 时，$T(z) = \\sum \\mathbb{P}(S=s)z^s \\to \\sum \\mathbb{P}(S=s) = 1$。设 $u=T(z)$。我们对 $f(u)$ 在 $u=1$ 附近进行泰勒展开。$f(u)$ 在 $u=1$ 处的导数与 $K$ 的矩相关：\n$f(1) = \\sum \\mathbb{P}(K=k) = 1$。\n$f'(1) = \\sum k \\mathbb{P}(K=k) = \\mathbb{E}[K] = m = 1$ （根据临界条件）。\n$f''(1) = \\sum k(k-1) \\mathbb{P}(K=k) = \\mathbb{E}[K(K-1)] = \\mathbb{E}[K^2] - \\mathbb{E}[K]$。\n我们知道 $\\mathrm{Var}(K) = \\sigma^2 = \\mathbb{E}[K^2] - (\\mathbb{E}[K])^2$。由于 $\\mathbb{E}[K]=1$，我们有 $\\mathbb{E}[K^2] = \\sigma^2 + 1$。\n所以，$f''(1) = (\\sigma^2+1) - 1 = \\sigma^2$。\n\n$f(u)$ 在 $u=1$ 附近的泰勒级数是：\n$$f(u) = f(1) + f'(1)(u-1) + \\frac{f''(1)}{2!}(u-1)^2 + O((u-1)^3)$$\n$$f(u) = 1 + 1 \\cdot (u-1) + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3) = u + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3)$$\n将此代入函数方程 $T(z) = z f(T(z))$，其中 $u=T(z)$：\n$$u = z \\left( u + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3) \\right)$$\n重新整理各项：\n$$u(1-z) = z \\frac{\\sigma^2}{2}(u-1)^2 + z O((u-1)^3)$$\n当 $z \\to 1^-$ 时，我们有 $u=T(z) \\to 1^-$。我们可以通过在方程中不那么敏感的部分设置 $z \\approx 1$ 和 $u \\approx 1$ 来分析主导阶行为：\n$$1 \\cdot (1-z) \\approx 1 \\cdot \\frac{\\sigma^2}{2}(u-1)^2$$\n$$(u-1)^2 \\approx \\frac{2(1-z)}{\\sigma^2}$$\n由于当 $z1$ 时 $u=T(z)1$，我们有 $u-10$，所以必须取负平方根：\n$$u-1 \\approx -\\sqrt{\\frac{2(1-z)}{\\sigma^2}} = -\\frac{\\sqrt{2}}{\\sigma}\\sqrt{1-z}$$\n因此，$T(z)$ 在其奇点 $z=1$ 附近的渐近行为是：\n$$T(z) \\approx 1 - \\frac{\\sqrt{2}}{\\sigma}\\sqrt{1-z} = 1 - \\frac{\\sqrt{2}}{\\sigma}(1-z)^{1/2}$$\n这个平方根奇点决定了系数 $\\mathbb{P}(S=s)$ 的渐近行为。\n\n为了找到 $\\mathbb{P}(S=s)$ 的渐近形式，我们使用解析组合学中的转移定理。将该定理应用于具有 $(1-z)^{-\\alpha}$（其中 $\\alpha > 0$）形式奇点的函数通常更方便。我们可以通过对 $T(z)$ 求导来实现这一点：\n$$T'(z) = \\sum_{s=1}^{\\infty} s \\, \\mathbb{P}(S=s) z^{s-1}$$\n对 $T(z)$ 的渐近表达式求导：\n$$T'(z) \\approx \\frac{d}{dz}\\left(1 - \\frac{\\sqrt{2}}{\\sigma}(1-z)^{1/2}\\right) = - \\frac{\\sqrt{2}}{\\sigma} \\cdot \\frac{1}{2}(1-z)^{-1/2} \\cdot (-1) = \\frac{\\sqrt{2}}{2\\sigma}(1-z)^{-1/2} = \\frac{1}{\\sigma\\sqrt{2}}(1-z)^{-1/2}$$\n标准转移定理指出，如果一个生成函数 $A(z) = \\sum a_n z^n$ 在 $z \\to 1$ 时表现为 $A(z) \\sim K(1-z)^{-\\alpha}$（其中 $\\alpha \\notin \\{0, -1, -2, \\ldots\\}$），那么其系数具有渐近形式 $a_n \\sim K \\frac{n^{\\alpha-1}}{\\Gamma(\\alpha)}$。\n\n让我们将此应用于 $T'(z)$。这里我们有 $K = \\frac{1}{\\sigma\\sqrt{2}}$ 和 $\\alpha = 1/2$。$T'(z)$ 的系数由 $[z^s]T'(z) = (s+1)\\mathbb{P}(S=s+1)$ 给出。应用该定理：\n$$[z^s]T'(z) \\sim \\frac{1}{\\sigma\\sqrt{2}} \\frac{s^{(1/2)-1}}{\\Gamma(1/2)} = \\frac{1}{\\sigma\\sqrt{2}} \\frac{s^{-1/2}}{\\sqrt{\\pi}} = \\frac{1}{\\sigma\\sqrt{2\\pi}} s^{-1/2}$$\n这里我们使用了已知值 $\\Gamma(1/2)=\\sqrt{\\pi}$。\n将 $T'(z)$ 系数的两个表达式相等：\n$$(s+1)\\mathbb{P}(S=s+1) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} s^{-1/2}$$\n设 $n=s+1$。对于大的 $n$：\n$$n \\mathbb{P}(S=n) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} (n-1)^{-1/2} \\approx \\frac{1}{\\sigma\\sqrt{2\\pi}} n^{-1/2}$$\n两边除以 $n$，我们得到雪崩规模 $S$ 的渐近分布：\n$$\\mathbb{P}(S=n) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} n^{-3/2}$$\n将此与所要求的形式 $\\mathbb{P}(S=s)\\sim C s^{-3/2}$ 进行比较，我们可以确定系数 $C$。\n\n因此，系数 $C$ 是：\n$$C = \\frac{1}{\\sigma\\sqrt{2\\pi}}$$\n这是临界分支过程规模分布的著名结果。",
            "answer": "$$\\boxed{\\frac{1}{\\sigma\\sqrt{2\\pi}}}$$"
        },
        {
            "introduction": "在理论上预测幂律是一回事，但在有限且充满噪声的真实数据中严格地证实它则是另一项挑战。本练习将带您进入数据分析的实践核心，重点介绍使用最大似然估计（MLE）来准确拟合幂律指数。掌握这项技能对于避免常见的统计陷阱、并为临界动力学的存在提供有力证据至关重要 。",
            "id": "4292887",
            "problem": "一个处于假定临界状态的皮层网络产生一系列神经雪崩，其大小 $S$ 定义为一次雪崩事件中神经元激活的总次数。复杂系统和网络科学中的经验性研究通常用幂律来为 $S \\ge S_{\\min}$ 的雪崩大小的尾部分布建模。给定一个雪崩大小的独立同分布 (i.i.d.) 样本 $\\{S_i\\}_{i=1}^n$，其中每个样本都满足 $S_i \\ge S_{\\min}$，这些数据是在稳态记录条件和固定测量分辨率下收集的。使用最大似然估计（MLE）的基本定义，从适当归一化的尾部模型出发，推导在 $S_{\\min}$ 处具有硬下截断的连续幂律假设下，尾部指数 $\\hat{\\tau}$ 的估计量。然后，指出该估计量有效性和一致性所需的假设，并解释如果数据本质上是离散计数或存在有限尺寸的上截断，情况会如何变化。\n\n哪个选项正确地概述了如何计算 $\\hat{\\tau}$ 并准确地陈述了该估计量背后的假设？\n\nA. 假设对于 $S \\ge S_{\\min}$ 存在一个连续的帕累托尾部，其概率密度为 $p(S \\mid \\tau)$，并在 $[S_{\\min}, \\infty)$ 上进行归一化；写出似然函数 $L(\\tau) = \\prod_{i=1}^n p(S_i \\mid \\tau)$；关于 $\\tau$ 最大化对数似然函数以获得 $\\hat{\\tau}$ 的闭式解；并要求 $S_i$ 是独立同分布的，尾部在 $S_{\\min}$ 之上遵循连续幂律，过程是稳态的，并且为了可归一化要求 $\\tau > 1$。承认如果雪崩大小是离散计数，MLE 会涉及 Hurwitz zeta 归一化，并且通常需要数值优化；如果存在一个接近 $S_{\\min}$ 的上截断 $S_{\\max}$，则仅使用下截断的连续公式是有偏的，必须使用截断模型。\n\nB. 通过对所有观测大小的双对数坐标下的直方图斜率进行线性回归来计算 $\\hat{\\tau}$，不设下截断，取负斜率作为指数。只假设样本量大；分箱不影响偏差，且大小是连续还是离散无关紧要。\n\nC. 假设一个离散幂律，其概率质量函数为 $p(S \\mid \\tau) = S^{-\\tau} / \\zeta(\\tau, S_{\\min})$，其中 $\\zeta$ 是 Hurwitz zeta 函数，并声稱其 MLE 可精确简化为与连续情况相同的闭式解。该估计量不依赖于 $S_{\\min}$ 的选择，并且上截断的存在没有影响。\n\nD. 使用样本均值 $\\bar{S}$ 以及 $\\bar{S}$ 和 $\\tau$ 之间的矩估计法关系来生成 $\\hat{\\tau}$，即使对于重尾分布，这也是一致的，并且不要求 $S_i$ 是独立同分布的或 $S_{\\min}$ 被正确选择。\n\nE. 如果存在有限的上截断 $S_{\\max}$，使用仅有下截断的连续公式得到的 MLE 仍然是无偏的；归一化常数会抵消掉，因此 $S_{\\max}$ 的存在从不影响估计。因此，无论 $S_{\\max}$如何，$\\hat{\\tau}$ 都可以用相同的闭式解计算，关于 $S_{\\min}$ 或离散性的假设是不必要的。",
            "solution": "### 推导与分析\n该问题要求推导连续幂律分布指数 $\\tau$ 的最大似然估计（MLE），并分析其假设。\n\n1.  **模型与似然函数**：假设对于 $S \\ge S_{\\min}$，雪崩大小遵循连续幂律分布（也称为帕累托分布）。其归一化的概率密度函数 (PDF) 为 $p(S \\mid \\tau, S_{\\min}) = (\\tau-1)S_{\\min}^{\\tau-1} S^{-\\tau}$，其中要求 $\\tau > 1$ 以保证可归一化。对于一个独立同分布 (i.i.d.) 的样本 $\\{S_i\\}_{i=1}^n$，对数似然函数为：\n    $$ \\mathcal{L}(\\tau) = \\ln \\left( \\prod_{i=1}^{n} p(S_i \\mid \\tau, S_{\\min}) \\right) = \\sum_{i=1}^{n} \\ln\\left((\\tau-1)S_{\\min}^{\\tau-1} S_i^{-\\tau}\\right) $$\n    $$ \\mathcal{L}(\\tau) = n \\ln(\\tau-1) + n(\\tau-1)\\ln(S_{\\min}) - \\tau \\sum_{i=1}^{n} \\ln(S_i) $$\n\n2.  **最大化**：对 $\\tau$ 求导并令其为零以找到最大值：\n    $$ \\frac{d\\mathcal{L}}{d\\tau} = \\frac{n}{\\tau-1} + n\\ln(S_{\\min}) - \\sum_{i=1}^{n} \\ln(S_i) = 0 $$\n    解出估计量 $\\hat{\\tau}$：\n    $$ \\frac{n}{\\hat{\\tau}-1} = \\sum_{i=1}^{n} (\\ln(S_i) - \\ln(S_{\\min})) = \\sum_{i=1}^{n} \\ln\\left(\\frac{S_i}{S_{\\min}}\\right) $$\n    $$ \\hat{\\tau} = 1 + n \\left[ \\sum_{i=1}^{n} \\ln\\left(\\frac{S_i}{S_{\\min}}\\right) \\right]^{-1} $$\n    这为连续情况下的指数提供了一个闭式解。\n\n3.  **假设与局限性**：\n    -   **基本假设**：该估计量的一致性和有效性依赖于：(i) 样本是独立同分布的；(ii) 数据生成过程是稳态的；(iii) 数据在 $S_{\\min}$ 之上确实遵循连续幂律分布；(iv) $S_{\\min}$ 已被正确确定。\n    -   **离散数据**：如果数据是离散整数（如雪崩大小），正确的模型是离散幂律，其概率质量函数 (PMF) 使用 Hurwitz zeta 函数 $\\zeta(\\tau, S_{\\min})$ 进行归一化。最大化其似然函数没有闭式解，必须进行数值优化。\n    -   **上截断**：如果由于系统有限尺寸而存在上截断 $S_{\\max}$，则必须使用在 $[S_{\\min}, S_{\\max}]$ 区间上归一化的截断幂律模型。忽略上截断会导致对 $\\tau$ 的估计产生偏差。\n\n### 选项评估\n\n**A.** 此选项准确地描述了连续帕累托模型的 MLE 推导过程，得出了正确的闭式解，并正确列出了其有效性的核心假设（i.i.d., 稳态, 模型正确, $\\tau > 1$）。最重要的是，它正确地指出了当数据是离散时（需要 Hurwitz zeta 和数值优化）和存在上截断时（仅用下截断公式会有偏）所需的修正。这是对该统计问题的全面而准确的总结。\n\n**B.** 此选项描述的是对数分箱和线性回归，这是一种众所周知会产生偏差且统计上不严谨的方法。它错误地声称分箱和离散性无关紧要。\n\n**C.** 此选项以正确的离散 PMF 开头，但错误地声称其 MLE 简化为与连续情况相同的闭式解。它还错误地声称估计量不依赖于 $S_{\\min}$ 并且不受上截断的影响。\n\n**D.** 此选项建议使用矩估计法。对于幂律分布，矩（如均值）可能发散（当 $\\tau \\le 2$ 时），这使得该方法不可靠或不适用。它还错误地放宽了对 i.i.d. 和 $S_{\\min}$ 选择的要求。\n\n**E.** 此选项错误地声称上截断 $S_{\\max}$ 不影响 MLE，并错误地断言归一化常数会抵消。实际上，截断分布的归一化常数依赖于 $\\tau$，在最大化过程中不会抵消，忽略它会导致偏差。\n\n**结论**：选项 A 是唯一一个对 MLE 方法、其假设以及重要实际考虑（离散性和截断）都进行了正确和严谨陈述的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}