{
    "hands_on_practices": [
        {
            "introduction": "神经元的计算特性不仅取决于其离子通道，还极大地受其物理形态（即形态学）的影响。本练习旨在通过量化突触输入在神经元树突或轴突上不同位置对其在胞体处产生的影响，来探索这一基本原理。学生将构建一个简化的多隔室模型，并运用线性电路分析来理解信号如何根据其输入位置而被衰减或整合，这是单细胞计算中的一个核心概念。",
            "id": "3991811",
            "problem": "您的任务是在一个简化的、但基于形态学构建的皮层中间神经元多房室模型中，评估位置依赖性的电紧张影响。这些房室包括胞体、一个近端树突、一个连接到近端树突的远端树突，以及轴突起始段（AIS）。目标是利用被动电缆理论和线性电路分析的基本原理，量化在这些房室之一打开一个相同的电导时，胞体膜电位的变化差异。\n\n基本原理和假设：从基尔霍夫电流定律（KCL）、线性被动膜理论和电阻网络的直流稳态分析开始。假设存在一个恒定的膜漏泄，由单位面积的特定漏泄电导 $g_L$ 和一个漏泄反转电位 $E_L$ 描述。细胞质的电阻率为 $R_a$。每个房室都有一个到地的膜漏泄电导（地被设定为 $E_L$，因此在方程中 $E_L$ 表示为 $0$），并通过由几何形状和 $R_a$ 推导出的轴向电导与其邻居耦合。一个相同的突触样电导 $g_{\\text{syn}}$ 一次在一个房室打开，并连接到一个反转电位 $E_{\\text{syn}}$（相对于 $E_L$ 测量）。由于需要的是稳态响应，电容性分量被忽略。\n\n模型结构：有 $4$ 个节点，索引为 $0,1,2,3$，分别代表胞体（$0$）、近端树突（$1$）、远端树突（$2$）和轴突起始段（AIS）（$3$）。节点 $i$ 的漏泄电导为 $G_{L,i} = g_L A_i$，其中 $A_i$ 是该房室的膜面积。胞体面积被建模为半径为 $r_{\\text{soma}}$ 的球体，其面积为 $A_{\\text{soma}} = 4\\pi r_{\\text{soma}}^2$。树突和AIS的面积被建模为圆柱体，其面积为 $A = 2\\pi r L$。相邻节点之间的轴向耦合电导计算为房室中心之间串联轴向电阻的倒数。具体来说，胞体和近端树突之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{soma-prox}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2},\n$$\n近端和远端树突之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{prox-dist}} = R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2} + R_a \\frac{L_{\\text{dist}}/2}{\\pi r_{\\text{dist}}^2},\n$$\n胞体和AIS之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{soma-AIS}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{AIS}}/2}{\\pi r_{\\text{AIS}}^2}.\n$$\n相应的轴向电导为 $G_{\\text{ax}} = 1 / R_{\\text{ax}}$（对每个连接）。\n\n稳态节点方程：设相对于 $E_L$ 的节点电压向量为 $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$，并通过在每个节点应用KCL来定义电导矩阵 $\\mathbf{A}$：\n$$\nA_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}, \\quad A_{ij} = -G_{\\text{ax},ij} \\text{ for } i \\neq j,\n$$\n其中 $\\mathcal{N}(i)$ 是与节点 $i$ 轴向连接的邻居节点集合，而 $k$ 是突触电导打开的节点的索引。源向量 $\\mathbf{b}$ 只有 $b_k = g_{\\text{syn}} E_{\\text{syn}}$，其余元素为零。稳态解通过求解以下方程获得：\n$$\n\\mathbf{A} \\mathbf{V} = \\mathbf{b}.\n$$\n\n您的任务：对于下面的每个测试用例，分别计算当 $g_{\\text{syn}}$ 在胞体、近端树突、远端树突和AIS处打开时，胞体电压变化 $V_0$（单位为毫伏）。使用几何形状计算面积和轴向电阻，将 $E_L$ 设为地（$0$），并使用提供的常数。将所有最终电压以毫伏表示，并四舍五入到六位小数。\n\n所有测试用例的通用常数（除非另有说明）：\n- $g_L = 0.1 \\text{ mS/cm}^2$ (即, $g_L = 1\\times 10^{-4} \\text{ S/cm}^2$).\n- $g_{\\text{syn}} = 1 \\text{ nS}$ (即, $g_{\\text{syn}} = 1\\times 10^{-9} \\text{ S}$).\n- $E_{\\text{syn}} = 65 \\text{ mV}$ (即, $E_{\\text{syn}} = 0.065 \\text{ V}$ 高于 $E_L$).\n- 在模型中，通过选择地参考点，将 $E_L$ 视为 $0 \\text{ V}$。\n- 细胞质电阻率 $R_a$ 在每个测试用例中指定。\n- 所有形态学尺寸均以微米（$\\mu\\text{m}$）为单位提供，计算时必须使用 $1 \\text{ cm} = 10{,}000 \\text{ }\\mu\\text{m}$ 转换为厘米。\n\n测试套件（每个用例是一个元组 $(r_{\\text{soma}}, r_{\\text{prox}}, L_{\\text{prox}}, r_{\\text{dist}}, L_{\\text{dist}}, r_{\\text{AIS}}, L_{\\text{AIS}}, R_a)$，所有半径 $r$ 和长度 $L$ 的单位为 $\\mu\\text{m}$，$R_a$ 的单位为 $\\Omega\\cdot\\text{cm}$）：\n1. 用例 $1$ (标准形态): $(10, 1.2, 120, 0.8, 300, 0.7, 50, 150)$.\n2. 用例 $2$ (极长远端树突): $(9, 1.0, 80, 0.6, 1000, 0.7, 40, 150)$.\n3. 用例 $3$ (高轴向电阻率): $(11, 1.1, 150, 0.9, 350, 0.6, 45, 200)$.\n4. 用例 $4$ (微小AIS): $(10, 1.0, 100, 0.7, 250, 0.2, 30, 150)$.\n\n输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身是一个包含四个浮点数的列表，单位为毫伏，顺序为 $[V_0^{\\text{soma}}, V_0^{\\text{prox}}, V_0^{\\text{dist}}, V_0^{\\text{AIS}}]$。例如，打印的输出必须看起来像\n`[ [v_{11}, v_{12}, v_{13}, v_{14}], [v_{21}, v_{22}, v_{23}, v_{24}], [v_{31}, v_{32}, v_{33}, v_{34}], [v_{41}, v_{42}, v_{43}, v_{44}] ]`\n其中每个 $v_{ij}$ 都四舍五入到六位小数，并以十进制数形式表示为 $\\text{mV}$。不应打印任何额外的文本。",
            "solution": "该问题要求在一个四房室神经元模型中，计算当突触电导在不同位置打开时，胞体膜电位的稳态变化。这是一个计算神经科学中的经典问题，可以通过线性电路分析来解决，具体来说，是在直流（DC）稳态条件下，对每个房室（节点）应用基尔霍夫电流定律（KCL）。\n\n该模型包含四个节点：胞体（索引0）、一个近端树突（索引1）、一个远端树突（索引2）和一个轴突起始段（AIS）（索引3）。连接性如下：胞体连接到近端树突和AIS。近端树突连接到胞体和远端树突。电路图可以看作是一个中心胞体节点（$0$），连接到两个分支，一个分支通向近端然后是远端树突（$0 \\leftrightarrow 1 \\leftrightarrow 2$），另一个分支通向AIS（$0 \\leftrightarrow 3$）。\n\n在稳态下，流出每个节点的电流总和必须为零。这些电流包括通过膜的漏泄电流、到相邻房室的轴向电流以及突触电流。通过将漏泄反转电位 $E_L$ 设置为地参考（$0 \\text{ V}$），KCL方程构成了一个线性方程组 $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$，其中 $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$ 是每个节点相对于静息电位的稳态电压偏离向量。\n\n为每个测试用例求解 $\\mathbf{V}$ 的步骤如下：\n\n1.  **单位转换**：所有以微米（$\\mu\\text{m}$）为单位提供的形态学尺寸都使用转换因子 $1 \\text{ cm} = 10^4 \\text{ }\\mu\\text{m}$ 转换为厘米（$\\text{cm}$）。所有电气参数均使用国际单位制基本单位（伏特、西门子、欧姆、库仑等），电导以西门子（$S$）计算，电阻以欧姆（$\\Omega$）计算。\n\n2.  **计算房室面积（$A_i$）：**\n    对于每个组件 $i$，其表面积 $A_i$ 根据其几何形状计算。设转换后的厘米单位的半径和长度用撇号表示（例如，$r'_{\\text{soma}}$）。\n    - 胞体（球体, $i=0$）: $A_0 = 4\\pi (r'_{\\text{soma}})^2$\n    - 近端树突（圆柱体, $i=1$）: $A_1 = 2\\pi r'_{\\text{prox}} L'_{\\text{prox}}$\n    - 远端树突（圆柱体, $i=2$）: $A_2 = 2\\pi r'_{\\text{dist}} L'_{\\text{dist}}$\n    - AIS（圆柱体, $i=3$）: $A_3 = 2\\pi r'_{\\text{AIS}} L'_{\\text{AIS}}$\n\n3.  **计算漏泄电导（$G_{L,i}$）：**\n    每个房室的被动漏泄电导是单位面积特定漏泄电导 $g_L = 1 \\times 10^{-4} \\text{ S/cm}^2$ 与房室表面积的乘积。\n    - $G_{L,i} = g_L A_i$，其中 $i \\in \\{0, 1, 2, 3\\}$。\n\n4.  **计算轴向电导（$G_{\\text{ax},ij}$）：**\n    两个相邻房室 $i$ 和 $j$ 之间的轴向电导是它们中心之间轴向电阻 $R_{\\text{ax},ij}$ 的倒数。电阻使用给定的公式和细胞质电阻率 $R_a$ 计算：\n    - 胞体（$0$）到近端树突（$1$）：\n      $$R_{\\text{ax},01} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{prox}}}{2\\pi (r'_{\\text{prox}})^2} \\right)$$\n    - 近端树突（$1$）到远端树突（$2$）：\n      $$R_{\\text{ax},12} = R_a \\left( \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} + \\frac{L'_{\\text{dist}}/2}{\\pi (r'_{\\text{dist}})^2} \\right)$$\n    - 胞体（$0$）到AIS（$3$）：\n      $$R_{\\text{ax},03} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{AIS}}/2}{\\pi (r'_{\\text{AIS}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{AIS}}}{2\\pi (r'_{\\text{AIS}})^2} \\right)$$\n    相应的轴向电导为 $G_{\\text{ax},01} = 1/R_{\\text{ax},01}$、$G_{\\text{ax},12} = 1/R_{\\text{ax},12}$ 和 $G_{\\text{ax},03} = 1/R_{\\text{ax},03}$。\n\n5.  **构建方程组：**\n    对于突触电导 $g_{\\text{syn}}$ 的每个位置 $k \\in \\{0, 1, 2, 3\\}$，我们组装 $4 \\times 4$ 的电导矩阵 $\\mathbf{A}$ 和 $4 \\times 1$ 的源向量 $\\mathbf{b}$。\n\n    电导矩阵 $\\mathbf{A}$ 的元素由以下公式给出：\n    - 对角元素: $A_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}$\n    - 非对角元素: $A_{ij} = -G_{\\text{ax},ij}$ 如果节点 $i$ 和 $j$ 相连，否则 $A_{ij}=0$。\n    这里，$\\delta_{i,k}$ 是克罗内克δ函数，如果 $i=k$ 则为 $1$，否则为 $0$。$\\mathcal{N}(i)$ 是节点 $i$ 的邻居节点集合。\n\n    具体来说，矩阵 $\\mathbf{A}$ 是：\n    $$\n    \\mathbf{A} =\n    \\begin{pmatrix}\n    G_{L,0} + G_{\\text{ax},01} + G_{\\text{ax},03}  -G_{\\text{ax},01}  0  -G_{\\text{ax},03} \\\\\n    -G_{\\text{ax},01}  G_{L,1} + G_{\\text{ax},01} + G_{\\text{ax},12}  -G_{\\text{ax},12}  0 \\\\\n    0  -G_{\\text{ax},12}  G_{L,2} + G_{\\text{ax},12}  0 \\\\\n    -G_{\\text{ax},03}  0  0  G_{L,3} + G_{\\text{ax},03}\n    \\end{pmatrix}\n    +\n    \\begin{pmatrix}\n    \\delta_{0,k}g_{\\text{syn}}  0  0  0 \\\\\n    0  \\delta_{1,k}g_{\\text{syn}}  0  0 \\\\\n    0  0  \\delta_{2,k}g_{\\text{syn}}  0 \\\\\n    0  0  0  \\delta_{3,k}g_{\\text{syn}}\n    \\end{pmatrix}\n    $$\n    源向量 $\\mathbf{b}$ 只有一个非零项，对应于节点 $k$ 处的突触电流源：\n    $$ b_i = \\delta_{i,k} g_{\\text{syn}} E_{\\text{syn}} $$\n    其中 $g_{\\text{syn}} = 1 \\times 10^{-9} \\text{ S}$ 且 $E_{\\text{syn}} = 0.065 \\text{ V}$。\n\n6.  **求解电压并提取结果：**\n    求解线性系统 $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$ 以获得电压向量 $\\mathbf{V}$。胞体电压变化是第一个元素，$V_0$。对每个突触位置 $k=0, 1, 2, 3$ 重复此计算。一个测试用例的最终结果是四个胞体电压的列表 $[V_{0,k=0}, V_{0,k=1}, V_{0,k=2}, V_{0,k=3}]$。这些值通过乘以 $1000$ 从伏特（V）转换为毫伏（$\\text{mV}$），然后按要求四舍五入到六位小数。对所有四个测试用例重复整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the result.\n    \"\"\"\n    \n    # Define constants\n    G_L_SPECIFIC = 1e-4  # S/cm^2 (0.1 mS/cm^2)\n    G_SYN = 1e-9         # S (1 nS)\n    E_SYN = 0.065        # V (65 mV)\n    \n    # Each case is a tuple of (r_soma, r_prox, L_prox, r_dist, L_dist, r_AIS, L_AIS, Ra)\n    # Dimensions in um, Ra in Ohm*cm\n    test_cases = [\n        # Case 1 (canonical morphology)\n        (10, 1.2, 120, 0.8, 300, 0.7, 50, 150),\n        # Case 2 (very long distal dendrite)\n        (9, 1.0, 80, 0.6, 1000, 0.7, 40, 150),\n        # Case 3 (high axial resistivity)\n        (11, 1.1, 150, 0.9, 350, 0.6, 45, 200),\n        # Case 4 (tiny AIS)\n        (10, 1.0, 100, 0.7, 250, 0.2, 30, 150),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        case_results = compute_somatic_voltages(params, G_L_SPECIFIC, G_SYN, E_SYN)\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists of floats\n    output_str = \"[\" + \", \".join([f\"[{', '.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\n\ndef compute_somatic_voltages(params, g_l, g_syn, e_syn):\n    \"\"\"\n    Computes the somatic voltage change for a single test case.\n    The synapse location is moved across the four compartments.\n    \"\"\"\n    r_soma, r_prox, l_prox, r_dist, l_dist, r_ais, l_ais, ra = params\n    \n    # Conversion factor from um to cm\n    um_to_cm = 1e-4\n\n    # Convert dimensions to cm\n    r_soma_cm = r_soma * um_to_cm\n    r_prox_cm = r_prox * um_to_cm\n    l_prox_cm = l_prox * um_to_cm\n    r_dist_cm = r_dist * um_to_cm\n    l_dist_cm = l_dist * um_to_cm\n    r_ais_cm = r_ais * um_to_cm\n    l_ais_cm = l_ais * um_to_cm\n\n    # 1. Calculate compartment areas (cm^2)\n    # Node 0: soma, 1: prox_dend, 2: dist_dend, 3: AIS\n    A_soma = 4 * np.pi * r_soma_cm**2\n    A_prox = 2 * np.pi * r_prox_cm * l_prox_cm\n    A_dist = 2 * np.pi * r_dist_cm * l_dist_cm\n    A_ais  = 2 * np.pi * r_ais_cm * l_ais_cm\n    \n    # 2. Calculate leak conductances (S)\n    G_L_soma = g_l * A_soma\n    G_L_prox = g_l * A_prox\n    G_L_dist = g_l * A_dist\n    G_L_ais  = g_l * A_ais\n\n    # 3. Calculate axial conductances (S)\n    pi = np.pi\n    R_ax_01 = ra * (1 / (pi * r_soma_cm) + (l_prox_cm / 2) / (pi * r_prox_cm**2))\n    R_ax_12 = ra * ((l_prox_cm / 2) / (pi * r_prox_cm**2) + (l_dist_cm / 2) / (pi * r_dist_cm**2))\n    R_ax_03 = ra * (1 / (pi * r_soma_cm) + (l_ais_cm / 2) / (pi * r_ais_cm**2))\n\n    G_ax_01 = 1 / R_ax_01\n    G_ax_12 = 1 / R_ax_12\n    G_ax_03 = 1 / R_ax_03\n\n    # 4. Construct the base conductance matrix (before adding g_syn)\n    A_base = np.zeros((4, 4))\n    \n    # Diagonal elements\n    A_base[0, 0] = G_L_soma + G_ax_01 + G_ax_03\n    A_base[1, 1] = G_L_prox + G_ax_01 + G_ax_12\n    A_base[2, 2] = G_L_dist + G_ax_12\n    A_base[3, 3] = G_L_ais  + G_ax_03\n\n    # Off-diagonal elements\n    A_base[0, 1] = A_base[1, 0] = -G_ax_01\n    A_base[1, 2] = A_base[2, 1] = -G_ax_12\n    A_base[0, 3] = A_base[3, 0] = -G_ax_03\n    \n    somatic_voltages = []\n\n    # 5. Solve for each synapse location k\n    for k in range(4): # k = 0 (soma), 1 (prox), 2 (dist), 3 (AIS)\n        # Construct A and b for current location k\n        A = A_base.copy()\n        A[k, k] += g_syn\n        \n        b = np.zeros(4)\n        b[k] = g_syn * e_syn\n        \n        # Solve the system AV = b\n        V = np.linalg.solve(A, b)\n        \n        # Extract somatic voltage, convert to mV, round, and append\n        v0_mv = V[0] * 1000\n        somatic_voltages.append(round(v0_mv, 6))\n\n    return somatic_voltages\n\nsolve()\n```"
        },
        {
            "introduction": "在单细胞层面之上，神经元通过协同工作形成复杂的神经环路，并产生特定模式的脑节律，例如伽马振荡。本练习将探讨两种关键的中间神经元亚型——小白蛋白（PV）和生长抑素（SST）神经元——如何利用其固有的不同突触动力学特性，来差异性地调节这些网络振荡。通过模拟一个包含这两种亚型的神经群模型并进行频谱分析，学生将能够量化模拟光遗传学实验中激活PV或SST神经元对伽马节律的频率和功率产生的影响。",
            "id": "3991795",
            "problem": "您的任务是构建并分析一个针对锥体-中间神经元网络伽马 (PING) 回路的小规模神经质量模型，该回路由两种抑制性中间神经元亚型增强：小清蛋白表达 ($\\mathrm{PV}$) 和生长抑素表达 ($\\mathrm{SST}$) 神经元。目的是定量预测针对 $\\mathrm{PV}$ 与 $\\mathrm{SST}$ 群体的细胞类型特异性光遗传驱动如何改变伽马振荡的频率和功率。\n\n从源于膜电流平衡和突触滤波的放电率公式出发，考虑一个三群体速率模型，其突触滤波器状态可近似有限的突触动力学。设兴奋性锥体细胞群体的放电率为 $E(t)$，$\\mathrm{PV}$ 抑制性群体的放电率为 $I(t)$，$\\mathrm{SST}$ 抑制性群体的放电率为 $S(t)$。设 $G_{\\mathrm{pv}}(t)$ 和 $G_{\\mathrm{sst}}(t)$ 为经过滤波的抑制性突触变量，它们以不同的动力学特性介导对兴奋性群体的抑制效应。动力学方程如下：\n$$\n\\tau_E \\frac{dE}{dt} = -E + \\sigma_E\\!\\left( w_{EE} E - w_{EI} G_{\\mathrm{pv}} - w_{ES} G_{\\mathrm{sst}} + P \\right),\n$$\n$$\n\\tau_{\\mathrm{pv}} \\frac{dI}{dt} = -I + \\sigma_I\\!\\left( w_{IE} E - w_{II} I + D_{\\mathrm{pv}} \\right),\n$$\n$$\n\\tau_{\\mathrm{sst}} \\frac{dS}{dt} = -S + \\sigma_S\\!\\left( w_{SE} E - w_{SI} S + D_{\\mathrm{sst}} \\right),\n$$\n$$\n\\tau_{G\\mathrm{pv}} \\frac{dG_{\\mathrm{pv}}}{dt} = -G_{\\mathrm{pv}} + I,\n\\qquad\n\\tau_{G\\mathrm{sst}} \\frac{dG_{\\mathrm{sst}}}{dt} = -G_{\\mathrm{sst}} + S,\n$$\n其中 $\\sigma_X(x)$ 是群体 $X \\in \\{E, I, S\\}$ 的S型输入-输出函数，定义为：\n$$\n\\sigma_X(x) = \\frac{1}{1 + \\exp\\!\\left( -a_X \\left( x - \\theta_X \\right) \\right)},\n$$\n其中 $a_X$ 是斜率参数，$\\theta_X$ 是阈值。符号 $w_{EE}, w_{EI}, w_{ES}, w_{IE}, w_{II}, w_{SE}, w_{SI}$ 表示耦合强度，$\\tau_E, \\tau_{\\mathrm{pv}}, \\tau_{\\mathrm{sst}}, \\tau_{G\\mathrm{pv}}, \\tau_{G\\mathrm{sst}}$ 表示时间常数（单位：秒），$P$ 是持续的外部兴奋性驱动，$D_{\\mathrm{pv}}$ 和 $D_{\\mathrm{sst}}$ 分别是施加于 $\\mathrm{PV}$ 和 $\\mathrm{SST}$ 抑制性群体的恒定光遗传驱动。所有放电率和 $\\sigma_X$ 的输出都是在区间 $[0,1]$ 内的无量纲量。光遗传驱动 $D_{\\mathrm{pv}}$ 和 $D_{\\mathrm{sst}}$ 是无量纲输入，分别改变 $\\mathrm{PV}$ 和 $\\mathrm{SST}$ 群体的放电率。\n\n使用的基本假设和定义如下：\n- 群体水平的膜方程产生了一阶低通动力学，其速率具有特征时间常数，这证明了每个群体方程形式 $\\tau \\frac{dr}{dt} = -r + \\sigma(\\cdot)$ 的合理性，其中 $\\sigma(\\cdot)$ 是一个静态非线性函数，代表源于尖峰产生生物物理学的S型放电率-电流关系。\n- 突触电流由一阶动力学滤波，这促使引入了辅助变量 $G_{\\mathrm{pv}}(t)$ 和 $G_{\\mathrm{sst}}(t)$，它们具有不同的抑制性动力学，引入了振荡所必需的相位延迟。\n- PING中的伽马振荡源于循环的兴奋-抑制环路动力学，其中 $\\mathrm{PV}$ 抑制作用较快，而 $\\mathrm{SST}$ 抑制作用较慢。振荡频率可以通过伽马频带内 $E(t)$ 的主导谱峰来量化。\n- 对以均匀间隔 $\\Delta t$ 采样的时间序列 $x(t)$ 进行离散傅里叶变换，得到频率分量 $f_k = \\frac{k}{N \\Delta t}$，其中 $k \\in \\{0,1,\\dots,\\lfloor N/2 \\rfloor\\}$，功率谱密度可以估计为 $|X_k|^2$，其中 $X_k$ 是傅里叶系数。\n\n您的程序必须实现上述系统，对其进行确定性模拟，并按如下方式计算伽马频率和功率：\n- 使用数值稳定方法（例如，四阶龙格-库塔法），以固定步长 $\\Delta t = 0.0005$ 秒，从初始条件 $E(0)=0.1$, $I(0)=0.1$, $S(0)=0.1$, $G_{\\mathrm{pv}}(0)=0.0$, $G_{\\mathrm{sst}}(0)=0.0$ 开始，模拟系统，总时长为 $T = 3.0$ 秒。\n- 在丢弃最初的 $1.0$ 秒瞬态后，对剩余时间窗口内的 $E(t)$ 进行离散傅里叶变换。将伽马频带（$30$ 至 $80$ 赫兹）内最大谱峰的位置估计为频率（单位：赫兹，$\\mathrm{Hz}$）。如果此频带内的最大峰值在数值上为零（例如，由于频谱平坦），则返回频率为 $0.0$ 赫兹。\n- 将伽马功率定义为该频率处的峰值功率值，并用伽马频带内的总功率进行归一化。这将得到一个在 $[0,1]$ 区间内的无量纲分数。如果伽马频带总功率在数值上为零，则返回伽马功率为 $0.0$。\n\n使用以下固定参数，这些参数对于皮层微电路具有生理学上的合理性：\n- 时间常数：$\\tau_E = 0.020$ 秒, $\\tau_{\\mathrm{pv}} = 0.010$ 秒, $\\tau_{\\mathrm{sst}} = 0.040$ 秒, $\\tau_{G\\mathrm{pv}} = 0.005$ 秒, $\\tau_{G\\mathrm{sst}} = 0.020$ 秒。\n- S型函数参数：$a_E = 4.0$, $a_I = 4.0$, $a_S = 4.0$, $\\theta_E = 0.5$, $\\theta_I = 0.3$, $\\theta_S = 0.3$。\n- 耦合强度：$w_{EE} = 12.0$, $w_{EI} = 15.0$, $w_{ES} = 6.0$, $w_{IE} = 15.0$, $w_{II} = 4.0$, $w_{SE} = 8.0$, $w_{SI} = 3.0$。\n- 持续兴奋性驱动：$P = 1.0$。\n\n构建一个测试套件，用于探究 $\\mathrm{PV}$ 与 $\\mathrm{SST}$ 光遗传激活如何改变伽马振荡。精确使用以下五个测试用例，指定为有序对 $(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$：\n- 用例1：$(0.0, 0.0)$ 无光遗传驱动的基线。\n- 用例2：$(0.3, 0.0)$ 中等强度 $\\mathrm{PV}$ 激活。\n- 用例3：$(0.0, 0.3)$ 中等强度 $\\mathrm{SST}$ 激活。\n- 用例4：$(0.8, 0.0)$ 强 $\\mathrm{PV}$ 激活。\n- 用例5：$(0.0, 0.8)$ 强 $\\mathrm{SST}$ 激活。\n\n您的程序必须为每个测试用例计算两个量：以赫兹为单位的伽马频率和作为无量纲分数的归一化伽马功率。最终输出必须是单行，包含一个列表的列表，其中每个内部列表按上述顺序对应一个测试用例，并包含两个浮点数 $[f, p]$，$f$ 的单位是赫兹，$p$ 是无量纲的。您的程序必须在输出中将每个浮点数四舍五入到 $3$ 位小数。例如，输出格式必须与此完全相同：\n`[[f_1,p_1],[f_2,p_2],[f_3,p_3],[f_4,p_4],[f_5,p_5]]`,\n打印在单行上。\n\n回答频率（单位：$\\mathrm{Hz}$）和功率（无量纲分数），每个值均按要求四舍五入到3位小数。不应打印其他任何文本。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知信息\n\n问题提供了以下数据和定义：\n- **方程组**：一个五变量常微分方程(ODEs)系统，描述放电率 $E(t)$, $I(t), S(t)$ 和突触滤波变量 $G_{\\mathrm{pv}}(t), G_{\\mathrm{sst}}(t)$：\n$$\n\\tau_E \\frac{dE}{dt} = -E + \\sigma_E\\!\\left( w_{EE} E - w_{EI} G_{\\mathrm{pv}} - w_{ES} G_{\\mathrm{sst}} + P \\right)\n$$\n$$\n\\tau_{\\mathrm{pv}} \\frac{dI}{dt} = -I + \\sigma_I\\!\\left( w_{IE} E - w_{II} I + D_{\\mathrm{pv}} \\right)\n$$\n$$\n\\tau_{\\mathrm{sst}} \\frac{dS}{dt} = -S + \\sigma_S\\!\\left( w_{SE} E - w_{SI} S + D_{\\mathrm{sst}} \\right)\n$$\n$$\n\\tau_{G\\mathrm{pv}} \\frac{dG_{\\mathrm{pv}}}{dt} = -G_{\\mathrm{pv}} + I\n$$\n$$\n\\tau_{G\\mathrm{sst}} \\frac{dG_{\\mathrm{sst}}}{dt} = -G_{\\mathrm{sst}} + S\n$$\n- **S型函数**：群体 $X \\in \\{E, I, S\\}$ 的输入-输出函数 $\\sigma_X(x)$ 由以下公式给出：\n$$\n\\sigma_X(x) = \\frac{1}{1 + \\exp\\!\\left( -a_X \\left( x - \\theta_X \\right) \\right)}\n$$\n- **参数**：\n  - 时间常数 (s)：$\\tau_E = 0.020$, $\\tau_{\\mathrm{pv}} = 0.010$, $\\tau_{\\mathrm{sst}} = 0.040$, $\\tau_{G\\mathrm{pv}} = 0.005$, $\\tau_{G\\mathrm{sst}} = 0.020$。\n  - S型函数参数：$a_E = 4.0$, $a_I = 4.0$, $a_S = 4.0$, $\\theta_E = 0.5$, $\\theta_I = 0.3$, $\\theta_S = 0.3$。\n  - 耦合强度 (无量纲)：$w_{EE} = 12.0$, $w_{EI} = 15.0$, $w_{ES} = 6.0$, $w_{IE} = 15.0$, $w_{II} = 4.0$, $w_{SE} = 8.0$, $w_{SI} = 3.0$。\n  - 持续兴奋性驱动 (无量纲)：$P = 1.0$。\n- **模拟协议**：\n  - 积分方法：四阶龙格-库塔法 (RK4)。\n  - 总时长：$T = 3.0$ s。\n  - 时间步长：$\\Delta t = 0.0005$ s。\n  - 初始条件：$E(0)=0.1$, $I(0)=0.1$, $S(0)=0.1$, $G_{\\mathrm{pv}}(0)=0.0$, $G_{\\mathrm{sst}}(0)=0.0$。\n- **分析协议**：\n  - 舍弃 $1.0$ s 的初始瞬态。\n  - 在剩余窗口上计算 $E(t)$ 的离散傅里叶变换 (DFT)。\n  - **伽马频率**：$30$ 至 $80$ Hz 频带内最大谱峰的位置。如果此频带内的峰值功率在数值上为零，则频率为 $0.0$ Hz。\n  - **伽马功率**：已识别频率处的峰值功率值，通过 $30-80$ Hz 伽马频带内的总功率进行归一化。如果伽马频带总功率为零，则归一化功率为 $0.0$。\n- **测试用例**：五对光遗传驱动 $(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$：\n  1. $(0.0, 0.0)$\n  2. $(0.3, 0.0)$\n  3. $(0.0, 0.3)$\n  4. $(0.8, 0.0)$\n  5. $(0.0, 0.8)$\n- **输出格式**：一个单行列表的列表 `[[f1,p1],[f2,p2],...]`，其中每个浮点数四舍五入到3位小数。\n\n### 步骤2：使用提取的已知信息进行验证\n\n- **科学依据**：该问题描述了一个 Wilson-Cowan 风格的神经质量模型，这是计算神经科学中用于研究群体水平大脑动力学的标准且经过充分验证的框架。PING（锥体-中间神经元网络伽马）机制是伽马振荡生成的经典理论。将其扩展到包含具有不同动力学的独特 PV 和 SST 中间神经元亚型，反映了当前对皮层微电路的理解。该模型是一个成熟的科学工具，而非伪科学。\n- **适定性**：该问题是适定的。它提供了一套完整的初值问题 (IVPs)，由一个常微分方程组、所有必要的参数和初始条件指定。关于数值模拟（RK4 方法、步长、时长）和后续数据分析（去除瞬态、FFT、峰值分析）的说明是明确无歧义的，可以得到一个唯一的、可计算的解。\n- **客观性**：该问题以精确、客观的数学和算法术语陈述。所有参数都以固定的数值给出。评估标准是定量的且定义清晰。没有主观或基于意见的成分。\n\n该问题没有任何无效性缺陷。它是自洽的、科学上合理的，并且在算法上是明确的。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。将开发一个解决方案。\n\n## 解决方案\n\n该解决方案需要模拟一个五维耦合非线性常微分方程系统，并随后对兴奋性群体活动 $E(t)$ 的时间序列进行谱分析。\n\n### 1. 模型与数值积分\n\n在任何时间 $t$，系统的状态由向量 $\\vec{y}(t) = [E(t), I(t), S(t), G_{\\mathrm{pv}}(t), G_{\\mathrm{sst}}(t)]^T$ 描述。动力学由矩阵方程 $\\frac{d\\vec{y}}{dt} = \\vec{f}(\\vec{y})$ 控制。函数 $\\vec{f}(\\vec{y})$ 由问题陈述中提供的常微分方程组定义。\n\n为了数值求解该系统，我们采用四阶龙格-库塔 (RK4) 方法。给定在时间 $t_n$ 的状态 $\\vec{y}_n$，在时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $\\vec{y}_{n+1}$ 计算如下：\n$$\n\\vec{k}_1 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_1)\n$$\n$$\n\\vec{k}_3 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_2)\n$$\n$$\n\\vec{k}_4 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\vec{k}_3)\n$$\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{1}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\n此积分从 $t=0$ 到 $t=3.0$ s，步长为 $\\Delta t=0.0005$ s，从指定的初始条件开始。存储 $E(t)$ 的整个时间序列以供分析。\n\n### 2. 谱分析\n\n分析是在丢弃初始 $1.0$ 秒的瞬态期后，对 $E(t)$ 时间序列的剩余部分进行的。这确保了分析反映的是网络的稳定、长期行为，而不是初始条件造成的人为现象。\n\n设被分析的兴奋性活动段为 $E_{analysis}(t)$，其采样时长为 $T_{analysis} = 2.0$ s，包含 $N_{fft} = T_{analysis} / \\Delta t = 4000$ 个点。\n\n1.  **离散傅里叶变换 (DFT)**：我们使用高效的快速傅里叶变换 (FFT) 算法计算 $E_{analysis}(t)$ 的 DFT。这将时域信号转换为其频域表示 $X(f)$。\n    $$\n    X_k = \\sum_{n=0}^{N_{fft}-1} E_{analysis}(t_n) e^{-i 2\\pi k n / N_{fft}}\n    $$\n    对应的频率为 $f_k = k / (N_{fft} \\Delta t)$，其中 $k = 0, 1, \\dots, N_{fft}-1$。\n\n2.  **功率谱**：功率谱密度 (PSD) 估计为 DFT 系数的幅值平方，$P(f_k) = |X_k|^2$。由于实值信号的 FFT 具有对称性，我们只考虑正频率分量。\n\n3.  **伽马频带分析**：我们分离出功率谱中对应于伽马频带的部分，从 $f_{min} = 30$ Hz 到 $f_{max} = 80$ Hz。这涉及到识别数组索引 $k$，使得 $30 \\le f_k \\le 80$。\n\n4.  **峰值频率识别**：在此伽马频带内，我们找到对应于最大功率值 $P_{peak}$ 的频率 $f_{peak}$。\n    $$\n    P_{peak} = \\max_{30 \\le f \\le 80} P(f)\n    $$\n    如果 $P_{peak}$ 在数值上为零（即，频带内的频谱平坦且为零），则根据问题规范，返回的伽马频率为 $0.0$ Hz。\n\n5.  **归一化功率计算**：归一化伽马功率 $p_{norm}$ 计算为峰值功率与整个伽马频带上积分的总功率之比。\n    $$\n    p_{norm} = \\frac{P_{peak}}{\\sum_{30 \\le f_k \\le 80} P(f_k)}\n    $$\n    如果伽马频带内的总功率在数值上为零，则归一化功率为 $0.0$。\n\n### 3. 执行测试用例\n\n对五个指定的测试用例中的每一个，都重复执行整个过程——模拟后进行谱分析。这些用例仅在光遗传驱动参数 $D_{\\mathrm{pv}}$ 和 $D_{\\mathrm{sst}}$ 的值上有所不同。收集每个用例得到的值对 $[f_{peak}, p_{norm}]$。最后，将结果格式化为单个字符串，形式为列表的列表，每个数值都四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PING model problem by simulating the ODEs and analyzing the output.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    params = {\n        'tau_E': 0.020, 'tau_pv': 0.010, 'tau_sst': 0.040,\n        'tau_Gpv': 0.005, 'tau_Gsst': 0.020,\n        'a_E': 4.0, 'a_I': 4.0, 'a_S': 4.0,\n        'theta_E': 0.5, 'theta_I': 0.3, 'theta_S': 0.3,\n        'w_EE': 12.0, 'w_EI': 15.0, 'w_ES': 6.0,\n        'w_IE': 15.0, 'w_II': 4.0, 'w_SE': 8.0, 'w_SI': 3.0,\n        'P': 1.0,\n    }\n\n    # --- Simulation setup ---\n    T = 3.0  # Total simulation time in seconds\n    dt = 0.0005  # Time step in seconds\n    num_steps = int(T / dt)\n    transient_time = 1.0  # Time to discard in seconds\n    analysis_start_index = int(transient_time / dt)\n\n    # --- Test Cases ---\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Baseline\n        (0.3, 0.0),  # Case 2: Moderate PV activation\n        (0.0, 0.3),  # Case 3: Moderate SST activation\n        (0.8, 0.0),  # Case 4: Strong PV activation\n        (0.0, 0.8),  # Case 5: Strong SST activation\n    ]\n\n    # --- Helper Functions ---\n    def sigmoid(x, a, theta):\n        return 1.0 / (1.0 + np.exp(-a * (x - theta)))\n\n    def derivatives(y, D_pv, D_sst, p):\n        E, I, S, G_pv, G_sst = y\n        \n        dE_dt = (-E + sigmoid(p['w_EE'] * E - p['w_EI'] * G_pv - p['w_ES'] * G_sst + p['P'], p['a_E'], p['theta_E'])) / p['tau_E']\n        dI_dt = (-I + sigmoid(p['w_IE'] * E - p['w_II'] * I + D_pv, p['a_I'], p['theta_I'])) / p['tau_pv']\n        dS_dt = (-S + sigmoid(p['w_SE'] * E - p['w_SI'] * S + D_sst, p['a_S'], p['theta_S'])) / p['tau_sst']\n        dG_pv_dt = (-G_pv + I) / p['tau_Gpv']\n        dG_sst_dt = (-G_sst + S) / p['tau_Gsst']\n        \n        return np.array([dE_dt, dI_dt, dS_dt, dG_pv_dt, dG_sst_dt])\n\n    def rk4_step(y, D_pv, D_sst, p, dt_val):\n        k1 = dt_val * derivatives(y, D_pv, D_sst, p)\n        k2 = dt_val * derivatives(y + 0.5 * k1, D_pv, D_sst, p)\n        k3 = dt_val * derivatives(y + 0.5 * k2, D_pv, D_sst, p)\n        k4 = dt_val * derivatives(y + k3, D_pv, D_sst, p)\n        return y + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n\n    results = []\n\n    for D_pv, D_sst in test_cases:\n        # --- Initialization ---\n        y = np.array([0.1, 0.1, 0.1, 0.0, 0.0])  # E, I, S, G_pv, G_sst\n        E_history = np.zeros(num_steps)\n\n        # --- Simulation Loop ---\n        for i in range(num_steps):\n            E_history[i] = y[0]\n            y = rk4_step(y, D_pv, D_sst, params, dt)\n\n        # --- Spectral Analysis ---\n        E_analysis = E_history[analysis_start_index:]\n        N_fft = len(E_analysis)\n\n        # Compute FFT and power spectrum\n        yf = np.fft.fft(E_analysis)\n        xf = np.fft.fftfreq(N_fft, dt)\n        power = np.abs(yf)**2\n\n        # Filter for gamma band (30-80 Hz) and positive frequencies\n        gamma_mask = (xf >= 30) & (xf <= 80)\n        \n        gamma_freqs = xf[gamma_mask]\n        gamma_power = power[gamma_mask]\n        \n        freq_result = 0.0\n        power_result = 0.0\n\n        if len(gamma_power) > 0:\n            peak_power_val = np.max(gamma_power)\n            total_gamma_power = np.sum(gamma_power)\n            \n            # Check for non-zero power to avoid division by zero and find peak\n            if peak_power_val > 1e-12: # Using a small tolerance for numerical zero\n                peak_index_local = np.argmax(gamma_power)\n                freq_result = gamma_freqs[peak_index_local]\n                \n                if total_gamma_power > 1e-12:\n                    power_result = peak_power_val / total_gamma_power\n                else:\n                    power_result = 0.0\n            else:\n                freq_result = 0.0\n                power_result = 0.0\n        \n        results.append([freq_result, power_result])\n\n    # --- Format Output ---\n    output_str = \"[\" + \",\".join([f\"[{f:.3f},{p:.3f}]\" for f, p in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "除了模拟复杂的动力学行为，我们还可以通过分析环路的基本连接逻辑来理解其功能。有时，神经环路内的相互作用会导致“反常”或反直觉的结果。本练习提供了一个关于这种现象的案例研究：一种抑制性神经元（VIP）的激活如何通过涉及SST神经元的去抑制通路，反而导致另一种抑制性神经元（PV）的活动下降。学生将运用线性系统分析这一强大工具来剖析环路的功能性连接，从而在不进行完整动力学模拟的情况下预测网络的稳态响应。",
            "id": "3991859",
            "problem": "考虑一个局部皮层微环路的四种群率模型，该模型包含锥体兴奋性神经元和三种中间神经元亚型：小白蛋白阳性 (PV)、生长抑素阳性 (SST) 和血管活性肠肽 (VIP)。首次出现时，请明确定义每个缩写和种群如下：锥体兴奋性神经元 ($E$)、小白蛋白阳性 ($\\mathrm{PV}$)、生长抑素阳性 ($\\mathrm{SST}$) 和血管活性肠肽 ($\\mathrm{VIP}$)。假设一个连续时间的 Wilson–Cowan 型率描述，其中种群放电率向量 $r(t) \\in \\mathbb{R}^4$ 的演化遵循一个在稳定工作点附近的具有线性耦合和线性增益的常微分方程 (ODE)。其基本基础是：种群率会弛豫到一个由连接矩阵和外部输入决定的线性相互作用所支配的稳态，并且对小输入扰动的线性响应可以通过线性化和稳态分析推导出来。\n\n您需要以纯数学术语量化在四种群模型中，激活 $\\mathrm{VIP}$（即增加对 $\\mathrm{VIP}$ 的外部输入）通过包含 $\\mathrm{SST}$–$\\mathrm{PV}$ 通路的相互作用，导致 $\\mathrm{PV}$ 放电率出现矛盾性下降的条件。连接矩阵 $W \\in \\mathbb{R}^{4 \\times 4}$ 编码了突触前种群 $j$ 对突触后种群 $i$ 的有效线性化影响，种群的排序固定为 $[E, \\mathrm{PV}, \\mathrm{SST}, \\mathrm{VIP}]$。为了科学上的真实性，假设兴奋性输出为非负，抑制性输出为非正：来自 $E$ 的输出连接为 $\\ge 0$，来自 $\\mathrm{PV}$、$\\mathrm{SST}$ 和 $\\mathrm{VIP}$ 的输出连接为 $\\le 0$。考虑对外部输入的小扰动 $\\delta I \\in \\mathbb{R}^4$，且仅限于 $\\mathrm{VIP}$，即 $\\delta I = [0, 0, 0, \\Delta]^\\top$，其中 $\\Delta > 0$（无量纲）。在稳定不动点附近的线性区域内进行分析，其中有效耦合的谱半径 $< 1$，因此预解式存在。\n\n您的任务是实现一个程序，对于每个提供的测试用例，计算对 $\\delta I$ 的稳态线性响应 $\\delta r$，并报告 $\\mathrm{PV}$ 分量是否减少。将矛盾性条件在数学上定义为在 $\\Delta > 0$ 的情况下 $(\\delta r)_{\\mathrm{PV}} < 0$。\n\n需要使用的基本基础和核心定义：\n- 种群动力学由稳定不动点附近的线性化 Wilson–Cowan 框架建模，其中对小输入的稳态响应通过求解从 ODE 稳态条件推导出的线性代数方程获得。\n- 在稳定性条件下，线性响应可以使用耦合矩阵的预解式或等效的收敛诺伊曼级数表示。\n\n您的程序必须使用以下固定的测试套件，其中包含连接矩阵和输入，所有条目均已明确给出。使用种群排序 $[E, \\mathrm{PV}, \\mathrm{SST}, \\mathrm{VIP}]$，并在所有情况下取 $\\Delta = 1.0$（无量纲）。\n\n测试用例 1（“矛盾性候选”）：\n$$\nW^{(1)} =\n\\begin{bmatrix}\n0.2  -0.6  -0.3  -0.1 \\\\\n0.7  -0.2  -0.3  -0.5 \\\\\n0.4  -0.4  -0.2  -0.6 \\\\\n0.2  -0.2  -0.1  -0.2\n\\end{bmatrix}, \\quad \\Delta^{(1)} = 1.0.\n$$\n\n测试用例 2（“去抑制主导”）：\n$$\nW^{(2)} =\n\\begin{bmatrix}\n0.2  -0.5  -0.3  -0.1 \\\\\n0.7  -0.2  -0.5  0.0 \\\\\n0.4  -0.4  -0.2  -0.7 \\\\\n0.2  -0.2  -0.1  -0.2\n\\end{bmatrix}, \\quad \\Delta^{(2)} = 1.0.\n$$\n\n测试用例 3（“边界情况，$\\mathrm{VIP}$ 到 $\\mathrm{PV}$ 和 $\\mathrm{SST}$ 的输出为零”）：\n$$\nW^{(3)} =\n\\begin{bmatrix}\n0.1  -0.4  -0.2  0.0 \\\\\n0.6  -0.2  -0.3  0.0 \\\\\n0.3  -0.3  -0.2  0.0 \\\\\n0.1  -0.1  -0.1  -0.2\n\\end{bmatrix}, \\quad \\Delta^{(3)} = 1.0.\n$$\n\n测试用例 4（“接近不稳定性”）：\n$$\nW^{(4)} =\n\\begin{bmatrix}\n0.4  -0.85  -0.5  -0.1 \\\\\n0.9  -0.3  -0.6  -0.2 \\\\\n0.5  -0.6  -0.3  -0.8 \\\\\n0.3  -0.25  -0.1  -0.4\n\\end{bmatrix}, \\quad \\Delta^{(4)} = 1.0.\n$$\n\n科学真实性和合理性由条目的符号和与皮层微环路有效耦合一致的量级来保证。对于这些测试用例，假设系统是稳定的，并且这应通过相应预解式的逆矩阵存在来从概念上验证。\n\n您的程序必须：\n- 对于每个 $W^{(k)}$ 和 $\\Delta^{(k)}$，计算对仅 $\\mathrm{VIP}$ 的输入扰动 $\\delta I^{(k)} = [0, 0, 0, \\Delta^{(k)}]^\\top$ 的稳态线性响应 $\\delta r^{(k)}$。\n- 判断 $(\\delta r^{(k)})_{\\mathrm{PV}} < 0$ 是否成立，为每个用例返回一个布尔值。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个方括号括起来的逗号分隔的结果列表（例如，`[result1,result2,result3,result4]`），其中每个条目是一个布尔值，指示相应测试用例的 $\\mathrm{PV}$ 分量是否减少。\n\n每个测试用例的答案类型是布尔值。不涉及物理单位或角度单位。直接将布尔值表示为编程语言的布尔值。",
            "solution": "该问题要求分析一个线性化的四种群神经元率模型，以确定在何种条件下激活一种特定的中间神经元亚型会导致另一种中间神经元活动出现矛盾性下降。该模型基于 Wilson-Cowan 框架，并在一个稳定不动点附近进行线性化。\n\n这四种种群是：锥体兴奋性神经元 ($E$)、小白蛋白阳性抑制性中间神经元 ($\\mathrm{PV}$)、生长抑素阳性抑制性中间神经元 ($\\mathrm{SST}$) 和血管活性肠肽阳性抑制性中间神经元 ($\\mathrm{VIP}$)。系统的状态由一个种群放电率向量 $r(t) \\in \\mathbb{R}^4$ 描述，种群的排序固定为 $[E, \\mathrm{PV}, \\mathrm{SST}, \\mathrm{VIP}]$。\n\n对稳态放电率的小扰动 $\\delta r$ 响应于一个小的、恒定的外部输入扰动 $\\delta I$ 的动力学由以下线性化方程控制：\n$$ \\frac{d(\\delta r)}{dt} = - (\\mathbb{I} - W) \\delta r + \\delta I $$\n这里，$W \\in \\mathbb{R}^{4 \\times 4}$ 是有效连接矩阵，其中 $W_{ij}$ 代表种群 $j$ 对种群 $i$ 的影响，而 $\\mathbb{I}$ 是 $4 \\times 4$ 的单位矩阵。在本问题中，时间常数已被吸收到 $W$ 的结构中。\n\n我们关心的是新的稳态响应，这发生在 $\\frac{d(\\delta r)}{dt} = 0$ 时。这将动力学系统简化为一个线性代数方程：\n$$ (\\mathbb{I} - W) \\delta r = \\delta I $$\n问题陈述系统是稳定的，这意味着 $W$ 的谱半径小于 1。这保证了矩阵 $M = \\mathbb{I} - W$ 是可逆的，并且存在一个唯一的稳态解 $\\delta r$：\n$$ \\delta r = (\\mathbb{I} - W)^{-1} \\delta I $$\n输入扰动是仅对 $\\mathrm{VIP}$ 种群的激活，由 $\\delta I = [0, 0, 0, \\Delta]^\\top$ 给出，其中 $\\Delta > 0$。对于所有测试用例，我们使用 $\\Delta = 1.0$。\n\n我们的目标是确定这种 $\\mathrm{VIP}$ 激活是否会导致 $\\mathrm{PV}$ 种群放电率出现“矛盾性”下降。种群向量的排序为 $\\delta r = [\\delta r_E, \\delta r_{\\mathrm{PV}}, \\delta r_{\\mathrm{SST}}, \\delta r_{\\mathrm{VIP}}]^\\top$。因此，矛盾性条件在数学上定义为解向量的第二个分量 $(\\delta r)_{\\mathrm{PV}}$ 为负：\n$$ (\\delta r)_{\\mathrm{PV}} < 0 $$\n由于 $\\delta I$ 的前三个分量为零，解向量 $\\delta r$ 是逆矩阵 $(\\mathbb{I} - W)^{-1}$ 的第四列，并按 $\\Delta$ 进行缩放。具体来说，对于任何种群 $i$，其响应为 $(\\delta r)_i = ((\\mathbb{I} - W)^{-1})_{i4} \\Delta$。因此，条件 $(\\delta r)_{\\mathrm{PV}} < 0$ 等价于检查矩阵 $(\\mathbb{I} - W)^{-1}$ 中第 2 行、第 4 列的元素是否为负。\n\n对于每个测试用例 $W^{(k)}$ 的计算步骤如下：\n1. 定义给定的 $4 \\times 4$ 连接矩阵 $W^{(k)}$。\n2. 构造相应的矩阵 $M^{(k)} = \\mathbb{I} - W^{(k)}$。\n3. 定义输入扰动向量 $\\delta I = [0.0, 0.0, 0.0, 1.0]^\\top$。\n4. 求解线性方程组 $M^{(k)} \\delta r^{(k)} = \\delta I$ 以找到响应向量 $\\delta r^{(k)}$。这在数值上比直接计算矩阵的逆更可取。\n5. 提取解的第二个分量 $(\\delta r^{(k)})_{\\mathrm{PV}}$。\n6. 评估布尔条件 $(\\delta r^{(k)})_{\\mathrm{PV}} < 0$。如果条件满足（发生矛盾性下降），则返回 `True`，否则返回 `False`。\n\n此过程将应用于四个提供的测试用例中的每一个，以生成最终的布尔结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the steady-state linear response of a 4-population neural model\n    to an input perturbation and checks for a paradoxical effect.\n\n    The model is described by the linear system (I - W) dr = dI, where:\n    - W is the connectivity matrix.\n    - I is the identity matrix.\n    - dI is the input perturbation vector.\n    - dr is the firing rate response vector.\n\n    The paradoxical effect is a decrease in the PV population's firing rate\n    (the second component of dr) in response to a positive input to the VIP\n    population (the fourth component of dI).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # The population ordering is [E, PV, SST, VIP].\n    # W_ij is the influence of population j on population i.\n    test_cases = [\n        # Test case 1 (“paradoxical candidate”)\n        np.array([\n            [0.2, -0.6, -0.3, -0.1],\n            [0.7, -0.2, -0.3, -0.5],\n            [0.4, -0.4, -0.2, -0.6],\n            [0.2, -0.2, -0.1, -0.2]\n        ]),\n        # Test case 2 (“disinhibition-dominant”)\n        np.array([\n            [0.2, -0.5, -0.3, -0.1],\n            [0.7, -0.2, -0.5, 0.0],\n            [0.4, -0.4, -0.2, -0.7],\n            [0.2, -0.2, -0.1, -0.2]\n        ]),\n        # Test case 3 (“boundary, zero VIP-outgoing to PV and SST”)\n        np.array([\n            [0.1, -0.4, -0.2, 0.0],\n            [0.6, -0.2, -0.3, 0.0],\n            [0.3, -0.3, -0.2, 0.0],\n            [0.1, -0.1, -0.1, -0.2]\n        ]),\n        # Test case 4 (“near-instability”)\n        np.array([\n            [0.4, -0.85, -0.5, -0.1],\n            [0.9, -0.3, -0.6, -0.2],\n            [0.5, -0.6, -0.3, -0.8],\n            [0.3, -0.25, -0.1, -0.4]\n        ])\n    ]\n\n    # Input perturbation: delta > 0 applied only to the VIP population.\n    # We use delta = 1.0, as its sign is what matters.\n    delta_I = np.array([0.0, 0.0, 0.0, 1.0])\n\n    # The 4x4 identity matrix\n    identity_matrix = np.identity(4)\n    \n    results = []\n    for W in test_cases:\n        # Construct the matrix M = I - W for the linear system M * dr = dI.\n        M = identity_matrix - W\n        \n        # Solve the linear system for the steady-state response 'delta_r'.\n        # np.linalg.solve is numerically stable and efficient.\n        delta_r = np.linalg.solve(M, delta_I)\n        \n        # The PV population is the second in the ordering [E, PV, SST, VIP].\n        # Its response is the second element of the delta_r vector (index 1).\n        pv_response = delta_r[1]\n        \n        # The paradoxical condition is a decrease in PV firing rate.\n        is_paradoxical = pv_response < 0\n        \n        results.append(is_paradoxical)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts boolean True/False to strings \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}