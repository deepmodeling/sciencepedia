{
    "hands_on_practices": [
        {
            "introduction": "为了开启我们的实践探索，我们将从网络控制中最基本的问题入手：一个给定的网络能否通过特定的节点集进行控制？这个练习  提供了一个具体的场景，让你能够应用作为线性可控性分析基石的卡尔曼秩条件。通过构建可控性矩阵并计算其秩，你将直接检验一个简单大脑网络模型的可控性，从而巩固对这一核心理论原理的理解。",
            "id": "4001595",
            "problem": "考虑一个由三个皮层区域组成的小型大脑网络的线性化神经质量模型，该模型被表述为一个连续时间线性时不变（LTI）系统，其状态方程为 $\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\,\\mathbf{x}(t) + \\mathbf{B}\\,u(t)$，其中 $\\mathbf{x}(t) \\in \\mathbb{R}^{3}$ 是区域活动向量，$u(t) \\in \\mathbb{R}$ 是一个标量控制输入，而 $\\mathbf{A} \\in \\mathbb{R}^{3 \\times 3}$ 是通过结合被动泄漏和解剖连接性得到的系统矩阵。解剖连接性矩阵 $\\mathbf{W}$ 如下所示：\n$$\n\\mathbf{W} = \\begin{pmatrix}\n0  0.9  0.1 \\\\\n0.4  0  0.7 \\\\\n0  0.5  0\n\\end{pmatrix},\n$$\n被动泄漏被建模为 $-\\gamma\\,\\mathbf{I}$，其中 $\\gamma = 0.8$，因此 $\\mathbf{A} = \\mathbf{W} - \\gamma\\,\\mathbf{I}$。控制输入仅注入到第二个节点，所以选择\n$$\n\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用 Kalman 框架中可达性的基本定义，构建此设置所蕴含的能控性矩阵并计算其秩。根据秩，判断仅在第二个节点注入控制是否能使该三维系统变得能控。将最终答案表示为能控性矩阵的秩，以单个整数形式给出。最终答案无需四舍五入，也无需单位。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 系统模型：连续时间线性时不变（LTI）系统。\n- 状态方程：$\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\,\\mathbf{x}(t) + \\mathbf{B}\\,u(t)$。\n- 状态向量：$\\mathbf{x}(t) \\in \\mathbb{R}^{3}$。\n- 控制输入：$u(t) \\in \\mathbb{R}$。\n- 系统矩阵定义：$\\mathbf{A} = \\mathbf{W} - \\gamma\\,\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n- 解剖连接性矩阵：$\\mathbf{W} = \\begin{pmatrix} 0  0.9  0.1 \\\\ 0.4  0  0.7 \\\\ 0  0.5  0 \\end{pmatrix}$。\n- 被动泄漏参数：$\\gamma = 0.8$。\n- 控制输入矩阵：$\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n- 任务：构建能控性矩阵并计算其秩，以评估系统的能控性。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题在网络控制理论及其在计算神经科学中的应用方面有坚实的基础。使用线性化神经质量模型、LTI系统表示、连接矩阵 $\\mathbf{W}$ 和泄漏项 $-\\gamma\\,\\mathbf{I}$ 都是大脑动力学建模中标准且已被广泛接受的组成部分。该问题在科学上是合理的。\n- **适定性**：该问题定义清晰。它要求构建能控性矩阵并计算其秩，这些都是控制理论中的标准程序。所有必要的数据（$\\mathbf{W}$、$\\gamma$、$\\mathbf{B}$）和定义都已提供，足以唯一确定系统矩阵 $\\mathbf{A}$ 以及随后的能控性矩阵 $\\mathcal{C}$。存在一个唯一的、有意义的解（秩）。\n- **客观性**：该问题使用精确的数学语言和客观定义进行陈述，没有歧义或主观性陈述。\n- **完整性与一致性**：该问题是自洽的。矩阵和向量的维度是一致的：$\\mathbf{A} \\in \\mathbb{R}^{3 \\times 3}$，$\\mathbf{x} \\in \\mathbb{R}^{3}$，$\\mathbf{B} \\in \\mathbb{R}^{3 \\times 1}$，且 $u(t)$ 是一个标量。不存在矛盾。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定、客观且内部一致。可以进行求解过程。\n\n问题的核心是评估给定LTI系统的能控性。对于一个维度为 $n$ 的系统，其能控性由能控性矩阵 $\\mathcal{C}$ 的秩决定。系统是能控的当且仅当 $\\text{rank}(\\mathcal{C}) = n$。\n\n首先，我们使用给定的定义 $\\mathbf{A} = \\mathbf{W} - \\gamma\\,\\mathbf{I}$ 来构建系统矩阵 $\\mathbf{A}$。\n给定 $\\gamma = 0.8$，矩阵 $\\gamma\\,\\mathbf{I}$ 为：\n$$\n\\gamma\\,\\mathbf{I} = 0.8 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0.8  0  0 \\\\ 0  0.8  0 \\\\ 0  0  0.8 \\end{pmatrix}\n$$\n现在，我们可以计算 $\\mathbf{A}$：\n$$\n\\mathbf{A} = \\mathbf{W} - \\gamma\\,\\mathbf{I} = \\begin{pmatrix} 0  0.9  0.1 \\\\ 0.4  0  0.7 \\\\ 0  0.5  0 \\end{pmatrix} - \\begin{pmatrix} 0.8  0  0 \\\\ 0  0.8  0 \\\\ 0  0  0.8 \\end{pmatrix} = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix}\n$$\n状态空间维度为 $n=3$。能控性矩阵，也称为 Kalman 矩阵，定义为：\n$$\n\\mathcal{C} = \\begin{pmatrix} \\mathbf{B}  \\mathbf{A}\\mathbf{B}  \\mathbf{A}^2\\mathbf{B}  \\dots  \\mathbf{A}^{n-1}\\mathbf{B} \\end{pmatrix}\n$$\n对于 $n=3$，它变为：\n$$\n\\mathcal{C} = \\begin{pmatrix} \\mathbf{B}  \\mathbf{A}\\mathbf{B}  \\mathbf{A}^2\\mathbf{B} \\end{pmatrix}\n$$\n我们依次计算 $\\mathcal{C}$ 的各列。\n第一列是控制矩阵 $\\mathbf{B}$：\n$$\n\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n第二列是 $\\mathbf{A}\\mathbf{B}$：\n$$\n\\mathbf{A}\\mathbf{B} = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-0.8)(0) + (0.9)(1) + (0.1)(0) \\\\ (0.4)(0) + (-0.8)(1) + (0.7)(0) \\\\ (0)(0) + (0.5)(1) + (-0.8)(0) \\end{pmatrix} = \\begin{pmatrix} 0.9 \\\\ -0.8 \\\\ 0.5 \\end{pmatrix}\n$$\n第三列是 $\\mathbf{A}^2\\mathbf{B}$，可以计算为 $\\mathbf{A}(\\mathbf{A}\\mathbf{B})$：\n$$\n\\mathbf{A}^2\\mathbf{B} = \\mathbf{A}(\\mathbf{A}\\mathbf{B}) = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ -0.8 \\\\ 0.5 \\end{pmatrix}\n$$\n$$\n\\mathbf{A}^2\\mathbf{B} = \\begin{pmatrix} (-0.8)(0.9) + (0.9)(-0.8) + (0.1)(0.5) \\\\ (0.4)(0.9) + (-0.8)(-0.8) + (0.7)(0.5) \\\\ (0)(0.9) + (0.5)(-0.8) + (-0.8)(0.5) \\end{pmatrix} = \\begin{pmatrix} -0.72 - 0.72 + 0.05 \\\\ 0.36 + 0.64 + 0.35 \\\\ 0 - 0.4 - 0.4 \\end{pmatrix} = \\begin{pmatrix} -1.39 \\\\ 1.35 \\\\ -0.8 \\end{pmatrix}\n$$\n现在，我们组装能控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0.9  -1.39 \\\\ 1  -0.8  1.35 \\\\ 0  0.5  -0.8 \\end{pmatrix}\n$$\n为了求出 $\\mathcal{C}$ 的秩，我们可以计算它的行列式。一个非零的行列式意味着各列线性无关，且矩阵是满秩的。对于一个 $3 \\times 3$ 矩阵，满秩即秩为 $3$。为简便起见，我们沿第一列进行代数余子式展开：\n$$\n\\det(\\mathcal{C}) = (0) \\cdot C_{11} - (1) \\cdot \\det\\begin{pmatrix} 0.9  -1.39 \\\\ 0.5  -0.8 \\end{pmatrix} + (0) \\cdot C_{31}\n$$\n其中 $C_{ij}$ 是代数余子式。\n$$\n\\det(\\mathcal{C}) = -1 \\left[ (0.9)(-0.8) - (-1.39)(0.5) \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.72 - (-0.695) \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.72 + 0.695 \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.025 \\right] = 0.025\n$$\n由于 $\\det(\\mathcal{C}) = 0.025 \\neq 0$，矩阵 $\\mathcal{C}$ 是可逆的并且是满秩。能控性矩阵的秩为 $3$。\n\n能控性的条件是能控性矩阵的秩必须等于状态空间的维度。此处，$\\text{rank}(\\mathcal{C}) = 3$ 且 $n=3$。由于 $\\text{rank}(\\mathcal{C}) = n$，该系统是能控的。这意味着仅在第二个节点注入控制输入就足以在有限时间内将所有三个节点的活动驱动到任何期望的状态。问题要求的是能控性矩阵的秩。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "虽然判断一个系统是否可控至关重要，但一个更实际的问题往往是：哪些节点能提供最有效的控制？这个练习  引入了“平均可控性”这一概念，它是一个源自可控性格拉姆矩阵的度量，用于量化节点影响网络状态的能力。通过计算并排序模型网络中每个节点的该项指标，你将探索节点的控制能力与其在网络拓扑中的重要性（例如作为网络“枢纽”）之间的深刻联系。",
            "id": "4001597",
            "problem": "考虑一个包含三个区域的离散时间线性时不变 (LTI) 大脑网络模型，其状态演化遵循 $x_{t+1} = A x_t + B u_t$。区域间的对称加权结构连接性由矩阵\n$$\n\\tilde{A} = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix},\n$$\n编码，并且通过设置 $A = \\alpha \\tilde{A}$（其中 $\\alpha = \\frac{1}{2}$）对动力学耦合进行归一化以确保稳定性。假设为单节点输入，即对于节点 $i$，使用 $B = e_i$，其中 $e_i$ 是 $\\mathbb{R}^3$ 中的第 $i$ 个标准基向量。使用离散时间LTI系统能控性的基本定义，计算每个节点的平均能控性，并根据平均能控性从高到低对节点进行排序。如果两个节点的排名并列，则按节点索引递增的顺序打破并列。将您的最终答案表示为一个单行矩阵，其前三个元素依次为节点 $1$、$2$ 和 $3$ 的平均能控性值，后三个元素为按降序排列的节点索引。无需四舍五入。根据给定大脑网络中的中心性（基于度的中心性）来解释该排名。",
            "solution": "该问题要求计算一个三节点线性时不变 (LTI) 大脑网络模型中每个节点的平均能控性，并进行后续的排序和解释。\n\n该系统由离散时间LTI方程 $x_{t+1} = A x_t + B u_t$ 描述，其中 $x_t \\in \\mathbb{R}^3$ 是三个大脑区域在时间 $t$ 的状态。系统矩阵 $A$ 由结构连接性 $\\tilde{A}$ 和一个缩放因子 $\\alpha$ 导出。\n\n首先，我们定义系统矩阵 $A$：\n$$\n\\tilde{A} = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}, \\quad \\alpha = \\frac{1}{2}\n$$\n$$\nA = \\alpha \\tilde{A} = \\frac{1}{2} \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1/2  0 \\\\ 1/2  0  1/2 \\\\ 0  1/2  0 \\end{pmatrix}\n$$\n$A$ 的特征值可以通过求解 $\\det(A - \\lambda I) = 0$ 得到，即 $-\\lambda(\\lambda^2 - 1/2) = 0$。特征值为 $\\lambda_1 = 0$, $\\lambda_2 = 1/\\sqrt{2}$ 和 $\\lambda_3 = -1/\\sqrt{2}$。由于谱半径 $\\rho(A) = \\max_i |\\lambda_i| = 1/\\sqrt{2}  1$，该系统是稳定的。\n\n离散时间LTI系统的能控性由能控性格拉姆矩阵 $W_c$ 来表征。对于一个稳定的系统，它由收敛级数 $W_c = \\sum_{k=0}^{\\infty} A^k B B^\\top (A^\\top)^k$ 给出。一个更实用的计算 $W_c$ 的方法是求解离散时间李雅普诺夫方程：\n$$\nA W_c A^\\top - W_c = -B B^\\top \\quad \\text{或等价地} \\quad W_c - A W_c A^\\top = B B^\\top\n$$\n平均能控性定义为能控性格拉姆矩阵的迹，即 $\\text{Trace}(W_c)$。$\\text{Trace}(W_c)$ 的值越大，表示系统状态平均而言越容易从指定的输入节点达到。\n\n我们将计算在三个节点中每个节点进行单节点控制时的平均能控性，其中输入矩阵 $B$ 由 $B_i = e_i$（第 $i$ 个标准基向量）给出。\n\n设 $W_c$ 为对称矩阵 $W_c = \\begin{pmatrix} w_{11}  w_{12}  w_{13} \\\\ w_{12}  w_{22}  w_{23} \\\\ w_{13}  w_{23}  w_{33} \\end{pmatrix}$。项 $A W_c A^\\top$ 计算如下：\n$$\nA W_c A^\\top = \\begin{pmatrix}\n\\frac{1}{4} w_{22}  \\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} w_{22} \\\\\n\\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} (w_{11} + 2w_{13} + w_{33})  \\frac{1}{4} (w_{12} + w_{23}) \\\\\n\\frac{1}{4} w_{22}  \\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} w_{22}\n\\end{pmatrix}\n$$\n\n**情况1：在节点1进行控制**\n此处，$B = B_1 = e_1 = (1, 0, 0)^\\top$，因此 $B_1 B_1^\\top = \\text{diag}(1, 0, 0)$。设 $W_{c,1}$ 为格拉姆矩阵。李雅普诺夫方程 $W_{c,1} - A W_{c,1} A^\\top = B_1 B_1^\\top$ 给出以下关于元素 $w_{ij}$ 的方程组：\n1. (1,1): $w_{11} - \\frac{1}{4} w_{22} = 1$\n2. (2,2): $w_{22} - \\frac{1}{4} (w_{11} + 2w_{13} + w_{33}) = 0$\n3. (3,3): $w_{33} - \\frac{1}{4} w_{22} = 0 \\implies w_{33} = \\frac{1}{4} w_{22}$\n4. (1,3): $w_{13} - \\frac{1}{4} w_{22} = 0 \\implies w_{13} = \\frac{1}{4} w_{22}$\n将 $w_{33}$ 和 $w_{13}$ 代入方程2：$w_{22} - \\frac{1}{4} (w_{11} + 2(\\frac{1}{4}w_{22}) + \\frac{1}{4}w_{22}) = 0 \\implies w_{22} - \\frac{1}{4} w_{11} - \\frac{1}{8} w_{22} - \\frac{1}{16} w_{22} = 0 \\implies \\frac{13}{16} w_{22} = \\frac{1}{4} w_{11} \\implies w_{11} = \\frac{13}{4} w_{22}$。\n将此代入方程1：$\\frac{13}{4} w_{22} - \\frac{1}{4} w_{22} = 1 \\implies \\frac{12}{4} w_{22} = 1 \\implies 3 w_{22} = 1 \\implies w_{22} = 1/3$。\n那么 $w_{11} = 1 + \\frac{1}{4}(\\frac{1}{3}) = 1 + \\frac{1}{12} = \\frac{13}{12}$。\n且 $w_{33} = \\frac{1}{4} w_{22} = \\frac{1}{4}(\\frac{1}{3}) = \\frac{1}{12}$。\n节点1的平均能控性为 $\\text{avg_c}_1 = \\text{Trace}(W_{c,1}) = w_{11} + w_{22} + w_{33} = \\frac{13}{12} + \\frac{1}{3} + \\frac{1}{12} = \\frac{13+4+1}{12} = \\frac{18}{12} = \\frac{3}{2}$。\n\n**情况3：在节点3进行控制**\n网络图在交换节点1和3时是对称的。因此，控制节点3与控制节点1是对称的。格拉姆矩阵 $W_{c,3}$ 的对角线元素 $w_{11,3}$ 和 $w_{33,3}$ 将相对于 $W_{c,1}$ 进行交换，而 $w_{22,3}$ 保持不变。\n$w_{11,3} = w_{33,1} = 1/12$。\n$w_{33,3} = w_{11,1} = 13/12$。\n$w_{22,3} = w_{22,1} = 1/3$。\n节点3的平均能控性为 $\\text{avg_c}_3 = \\text{Trace}(W_{c,3}) = \\frac{1}{12} + \\frac{1}{3} + \\frac{13}{12} = \\frac{1+4+13}{12} = \\frac{18}{12} = \\frac{3}{2}$。\n\n**情况2：在节点2进行控制**\n此处，$B = B_2 = e_2 = (0, 1, 0)^\\top$，因此 $B_2 B_2^\\top = \\text{diag}(0, 1, 0)$。设 $W_{c,2}$ 为格拉姆矩阵。李雅普诺夫方程给出：\n1. (1,1): $w_{11} - \\frac{1}{4} w_{22} = 0 \\implies w_{11} = \\frac{1}{4} w_{22}$\n2. (2,2): $w_{22} - \\frac{1}{4} (w_{11} + 2w_{13} + w_{33}) = 1$\n3. (3,3): $w_{33} - \\frac{1}{4} w_{22} = 0 \\implies w_{33} = \\frac{1}{4} w_{22}$\n4. (1,3): $w_{13} - \\frac{1}{4} w_{22} = 0 \\implies w_{13} = \\frac{1}{4} w_{22}$\n由于网络相对于节点1和3的对称性，我们预期 $w_{11} = w_{33}$，这一点得到了证实。\n将这些代入方程2：\n$w_{22} - \\frac{1}{4} (\\frac{1}{4}w_{22} + 2(\\frac{1}{4}w_{22}) + \\frac{1}{4}w_{22}) = 1$\n$w_{22} - \\frac{1}{4} (\\frac{4}{4}w_{22}) = 1 \\implies w_{22} - \\frac{1}{4} w_{22} = 1 \\implies \\frac{3}{4} w_{22} = 1 \\implies w_{22} = 4/3$。\n那么 $w_{11} = \\frac{1}{4}(\\frac{4}{3}) = 1/3$ 且 $w_{33} = \\frac{1}{4}(\\frac{4}{3}) = 1/3$。\n节点2的平均能控性为 $\\text{avg_c}_2 = \\text{Trace}(W_{c,2}) = w_{11} + w_{22} + w_{33} = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = \\frac{6}{3} = 2$。\n\n**总结与排名**\n平均能控性值为：\n- 节点 $1$：$\\text{avg_c}_1 = 3/2 = 1.5$\n- 节点 $2$：$\\text{avg_c}_2 = 2$\n- 节点 $3$：$\\text{avg_c}_3 = 3/2 = 1.5$\n\n按平均能控性从高到低排名：\n1. 节点 $2$ (值 $2$)\n2. 节点 $1$ (值 $1.5$)\n3. 节点 $3$ (值 $1.5$)\n\n节点1和3并列。问题规定按节点索引递增的顺序打破并列。因此排名是：节点2、节点1、节点3。从最高排名到最低排名的节点索引有序列表是 $(2, 1, 3)$。\n\n**解释**\n问题要求根据中心性（基于度的中心性）来解释排名。网络中节点的度是其拥有的连接数。对于无权结构连接矩阵 $\\tilde{A}$，度为：\n- 节点1的度 = $\\sum_j \\tilde{A}_{1j} = 1$\n- 节点2的度 = $\\sum_j \\tilde{A}_{2j} = 2$\n- 节点3的度 = $\\sum_j \\tilde{A}_{3j} = 1$\n\n节点2的度最高，是该网络的枢纽。节点1和3是度较低的外围节点。平均能控性的排名（节点2  节点1 = 节点3）与节点度的排名完全一致。\n其解释是，枢纽节点（节点2）表现出最高的平均能控性，而外围节点（节点1和3）的平均能控性较低。这表明具有较高中心度的节点在控制整个网络动力学方面更有效。它们中心的位置和更多的连接使它们能够更容易地影响整个网络的状态，这是网络控制理论中的一个常见发现。节点1和3具有相同的能控性值，反映了它们在网络中对称的拓扑位置。\n\n**最终答案的构建**\n最终答案必须是一个单行矩阵，其中包含节点1、2、3的平均能控性值，后跟按降序排列的节点索引。\n这些值为：$\\text{avg_c}_1 = 3/2$, $\\text{avg_c}_2 = 2$, $\\text{avg_c}_3 = 3/2$。\n排序后的节点索引为：$2, 1, 3$。\n得到的矩阵是 $(\\frac{3}{2} \\quad 2 \\quad \\frac{3}{2} \\quad 2 \\quad 1 \\quad 3)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2}  2  \\frac{3}{2}  2  1  3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实大脑网络的连接强度在个体间和时间上都存在差异。这引出了一个关键问题：我们能否仅根据网络的布线图（拓扑结构），而不依赖于具体的权重，来确定其控制特性？这项实践  深入探讨了结构可控性理论，你将通过编写一个算法来识别实现完全控制所需的最小“驱动节点”集。这种通过最大二分匹配将控制理论与图论联系起来的强大方法，对于为大规模生物网络设计控制策略至关重要。",
            "id": "4001604",
            "problem": "给定一个对称的大脑结构连接矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其各项非负，表示 $n$ 个大脑区域之间的无向解剖链接。您的任务是基于层次梯度引入合理的有向性来构建一个有向大脑图，然后使用结构可控性下的最大匹配计算最小驱动节点集。节点索引从 $0$ 到 $n-1$。\n\n使用的基本原理和定义：\n- 考虑一个线性时不变系统 $\\dot{x}(t) = A x(t) + B u(t)$，其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$A \\in \\mathbb{R}^{n \\times n}$ 是由大脑图决定的系统矩阵，$u(t) \\in \\mathbb{R}^m$ 是输入，$B \\in \\mathbb{R}^{n \\times m}$ 是输入矩阵。结构可控性将可控性与 $(A, B)$ 的稀疏模式以及由 $A$ 的非零项诱导的有向图联系起来。\n- 对于一个有 $n$ 个节点的有向图，构建一个二分图，其左部为 $L = \\{0, 1, \\dots, n-1\\}$ 表示源端点，右部为 $R = \\{0, 1, \\dots, n-1\\}$ 表示目标端点。对于有向图中的每条有向边 $i \\to j$，在二分图中添加一条从 $L$ 到 $R$ 的边 $(i, j)$。\n- 匹配（matching）是一组没有共享端点的边；最大匹配是基数最大的匹配。在结构可控性下，最小驱动节点集等于在有向网络诱导的二分图的最大匹配中，右部 $R$ 中未匹配的节点集合。\n- 您必须使用正确的算法（例如，Hopcroft–Karp 算法）实现最大二分匹配，并计算 $R$ 中的未匹配节点。\n\n从对称矩阵 $A$ 构建有向性的规则：\n- 给定一个节点的层次得分向量 $h \\in \\mathbb{R}^n$。对于每个无向链接，您必须分配一个与 $h$ 相符的合理方向，优先选择沿层次结构上升的边，但允许偶尔出现反馈。\n- 设 $\\tau \\ge 0$ 是一个小的容差。对于每一对满足 $i  j$ 和 $A_{ij}  0$ 的 $(i, j)$，定义如下：\n    1. 如果 $| h_i - h_j | \\le \\tau$，则同时包含有向边 $i \\to j$ 和 $j \\to i$。\n    2. 否则，让前向方向从层次较低的节点指向层次较高的节点。具体来说，如果 $h_i  h_j$，则包含 $i \\to j$；如果 $h_j  h_i$，则包含 $j \\to i$。\n    3. 此外，使用确定性伪随机代理 $u_{ij} = \\mathrm{frac}\\!\\left(\\sin^2(\\alpha i + \\beta j)\\right)$，以一个小的类概率水平 $\\epsilon \\in [0, 1]$ 在相反方向上包含一条反向边。其中 $\\mathrm{frac}(x) = x - \\lfloor x \\rfloor$，$\\alpha = 0.61803398875$，$\\beta = 1.41421356237$。如果 $u_{ij}  \\epsilon$，则也包含反向边。该代理在模拟偶然反馈的同时，确保了结果的可复现性。\n\n您的程序应：\n1. 对于每个测试用例，根据上述规则构建有向邻接关系。\n2. 构建二分图表示，其左部索引为 $L = \\{0, \\dots, n-1\\}$，右部索引为 $R = \\{0, \\dots, n-1\\}$，并为每条有向边 $i \\to j$ 添加一条边 $(i, j)$。\n3. 在此二分图中计算最大匹配。\n4. 为每个测试用例返回 $R$ 中未匹配节点的排序列表。此列表即为最小驱动节点集。\n5. 将所有测试用例的结果汇总到单行输出中，该输出为一个包含在方括号内的逗号分隔列表，其中每个测试用例的驱动节点集表示为一个整数列表（例如，$[[0,2],[1,3],[]]$）。\n\n角度单位不适用。本问题中没有物理单位。所有输出必须是整数索引。\n\n测试套件：\n- 测试用例 1（典型情况，带有跨模块链接和层次结构的模块化图）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  1  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    1  1  0  0.5  0  0 \\\\\n    0  0  0.5  0  1  1 \\\\\n    0  0  0  1  0  1 \\\\\n    0  0  0  1  1  0\n    \\end{bmatrix},\\quad h = [0.1, 0.2, 0.4, 0.5, 0.8, 1.0],\\quad \\epsilon = 0.15,\\quad \\tau = 0.$$\n- 测试用例 2（边界情况，无边）：\n    - $n = 5$,\n    - $$A = \\begin{bmatrix}\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0\n    \\end{bmatrix},\\quad h = [0, 0, 0, 0, 0],\\quad \\epsilon = 0.3,\\quad \\tau = 10^{-12}.$$\n- 测试用例 3（具有相同层次得分的完全图，双向边）：\n    - $n = 5$,\n    - $$A_{ij} = \\begin{cases}\n    1  \\text{if } i \\ne j,\\\\\n    0  \\text{if } i = j\n    \\end{cases},\\quad h = [0.5, 0.5, 0.5, 0.5, 0.5],\\quad \\epsilon = 0.0,\\quad \\tau = 10^{-6}.$$\n- 测试用例 4（边界情况，具有递增层次结构的路径图，无反馈）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  0  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    0  1  0  1  0  0 \\\\\n    0  0  1  0  1  0 \\\\\n    0  0  0  1  0  1 \\\\\n    0  0  0  0  1  0\n    \\end{bmatrix},\\quad h = [0, 1, 2, 3, 4, 5],\\quad \\epsilon = 0.0,\\quad \\tau = 0.0.$$\n- 测试用例 5（星形图，中心节点层次高，无反馈）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  1  1  1  1 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0\n    \\end{bmatrix},\\quad h = [2.0, 0.1, 0.1, 0.1, 0.1, 0.1],\\quad \\epsilon = 0.0,\\quad \\tau = 0.0.$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目是对应测试用例的排序后的未匹配右部节点列表。例如，输出必须类似于 $[[a_1],[a_2],\\dots]$，其中每个 $[a_k]$ 是一个整数列表。",
            "solution": "该问题要求我们确定一个大脑网络的最小驱动节点集，该网络源自给定的无向结构连接矩阵 $A$。解决方案涉及一个多步骤过程：首先，根据预定义的层次规则从 $A$ 构建一个有向图；其次，在该有向网络的二分图表示上计算最大匹配；第三，将驱动节点识别为最大匹配中的未匹配节点。此过程基于线性时不变（LTI）系统的结构可控性原理。\n\n问题的核心在于应用结构可控性定理，该定理指出，控制网络所需的最小驱动节点数为 $N_D = \\max(1, n - |M^{*}|)$，其中 $n$ 是节点数， $|M^{*}|$ 是有向图中最大匹配的基数。驱动节点集本身对应于未匹配节点的集合。本问题将其简化为 $N_D = n - |M^*|$ 并将驱动集定义为未匹配节点，这是网络控制文献中的常见约定。\n\n对于每个测试用例，总体算法流程如下：\n\n1.  **有向图构建**：\n    给定一个对称非负矩阵 $A \\in \\mathbb{R}^{n \\times n}$、一个层次得分向量 $h \\in \\mathbb{R}^n$、一个容差 $\\tau \\ge 0$ 以及一个反馈类概率水平 $\\epsilon \\in [0, 1]$。我们构建大脑图的有向邻接表示。我们遍历每一对节点 $(i, j)$（其中 $i  j$）。如果存在无向链接（即 $A_{ij}  0$），我们根据以下规则分配有向性：\n    -   **平局打破规则**：如果层次得分的绝对差在容差范围内，即 $|h_i - h_j| \\le \\tau$，则认为连接是相互的。我们同时添加有向边 $i \\to j$ 和 $j \\to i$。\n    -   **层次规则**：如果 $|h_i - h_j|  \\tau$，则建立一条从层次得分较低的节点到得分较高的节点的主要前馈边。也就是说，如果 $h_i  h_j$，我们添加边 $i \\to j$；如果 $h_j  h_i$，我们添加边 $j \\to i$。\n    -   **反馈规则**：除了主要方向外，还会概率性地添加一条“反馈”或反向边。这通过一个确定性伪随机代理 $u_{ij} = \\mathrm{frac}(\\sin^2(\\alpha i + \\beta j))$ 来建模，其中 $\\alpha = 0.61803398875$，$\\beta = 1.41421356237$，且 $\\mathrm{frac}(x) = x - \\lfloor x \\rfloor$ 是 $x$ 的小数部分。如果 $u_{ij}  \\epsilon$，则也包含反向边。该代理确保了结果的可复现性。\n\n2.  **最大二分匹配**：\n    有向图被转换为一个二分图 $G_B = (L \\cup R, E_B)$，其中左部 $L = \\{0, 1, \\dots, n-1\\}$ 和右部 $R = \\{0, 1, \\dots, n-1\\}$ 都代表大脑区域的集合。对于我们构建的图中的每条有向边 $i \\to j$，我们在二分图中添加一条从节点 $i \\in L$ 到节点 $j \\in R$ 的对应边 $(i, j)$。\n\n    为了在 $G_B$ 中找到最大匹配，我们采用一种基于深度优先搜索（DFS）的标准增广路径算法。匹配是一组没有公共顶点的边。增广路径是图中的一条路径，它从未在匹配中的边和在匹配中的边之间交替，始于 $L$ 中的一个未匹配节点，终于 $R$ 中的一个未匹配节点。通过找到一条增广路径并翻转其边的状态，我们可以将匹配的大小增加一。\n\n    算法流程如下：\n    - 初始化一个空匹配，所有节点均未匹配。我们使用一个大小为 $n$ 的数组 `match_R`，其中 `match_R[v]` 存储与节点 $v \\in R$ 匹配的 $L$ 中的节点，初始值为一个哨兵值（如 $-1$）。\n    - 遍历 $L$ 中的每个节点 $u$。\n    - 对于每个 $u$，执行 DFS 以寻找从 $u$ 开始的增广路径。使用一个 `visited` 数组来跟踪当前 DFS 遍历中已访问的 $R$ 中节点，以避免循环。\n    - DFS 函数 `dfs(u, visited, match_R)` 尝试为节点 $u$ 寻找匹配。它遍历 $u$ 在 $R$ 中的邻居 $v$。如果 $v$ 未被访问：\n        - 我们将 $v$ 标记为已访问。\n        - 如果 $v$ 当前未匹配，或者我们可以为当前与 $v$ 匹配的节点递归地找到一条增广路径，那么我们就找到了一条增广路径。我们通过设置 `match_R[v] = u` 来更新匹配，并返回 `True`。\n    - 如果循环完成而没有找到路径，`dfs` 返回 `False`。\n    - 对 $L$ 中的所有节点重复此过程。最终的匹配即为最大匹配。\n\n3.  **驱动节点识别**：\n    根据结构可控性理论，最小驱动节点集对应于二分图右部 $R$ 中的未匹配节点集合。在计算出最大匹配并填充 `match_R` 数组后，驱动节点就是 `match_R[v]` 仍然为 $-1$ 的索引 $v \\in R$ 的集合。\n    然后，按要求将得到的驱动节点索引列表按升序排序。\n\n以下是实现该算法的Python代码：\n```python\nimport numpy as np\n\ndef calculate_driver_nodes(n, A, h, epsilon, tau):\n    \"\"\"\n    Calculates the minimal driver node set for a single test case.\n    \"\"\"\n    alpha = 0.61803398875\n    beta = 1.41421356237\n    adj = [[] for _ in range(n)]\n\n    # 1. Construct the directed graph\n    for i in range(n):\n        for j in range(i + 1, n):\n            if A[i, j] > 0:\n                # Rule 1: Tie-breaking\n                if np.abs(h[i] - h[j]) = tau:\n                    adj[i].append(j)\n                    adj[j].append(i)\n                else:\n                    # Rule 2: Hierarchical direction\n                    if h[i]  h[j]:\n                        forward_edge = (i, j)\n                        backward_edge = (j, i)\n                    else:  # h_j  h_i\n                        forward_edge = (j, i)\n                        backward_edge = (i, j)\n                    \n                    adj[forward_edge[0]].append(forward_edge[1])\n\n                    # Rule 3: Probabilistic feedback\n                    u_ij = (np.sin(alpha * i + beta * j)**2) % 1.0\n                    if u_ij  epsilon:\n                        adj[backward_edge[0]].append(backward_edge[1])\n\n    # 2. Maximum Bipartite Matching\n    match_R = [-1] * n\n\n    def dfs(u, visited, adj, match_R_local):\n        for v in adj[u]:\n            if not visited[v]:\n                visited[v] = True\n                if match_R_local[v]  0 or dfs(match_R_local[v], visited, adj, match_R_local):\n                    match_R_local[v] = u\n                    return True\n        return False\n\n    for u in range(n):\n        visited_R = [False] * n\n        dfs(u, visited_R, adj, match_R)\n\n    # 3. Identify Driver Nodes (unmatched nodes in R)\n    driver_nodes = [v for v in range(n) if match_R[v] == -1]\n    driver_nodes.sort()\n    \n    return driver_nodes\n```\n对所有测试用例运行此算法会得到每个案例的驱动节点集。",
            "answer": "[[0,3],[0,1,2,3,4],[],[0],[1,2,3,4,5]]"
        }
    ]
}