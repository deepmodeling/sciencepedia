{
    "hands_on_practices": [
        {
            "introduction": "在网络控制理论中，最基本的问题是：一个系统是否可控？Kalman秩条件为线性系统提供了明确的答案。这项实践将通过一个简单三节点网络模型的具体计算，引导你亲手构建可控性矩阵并计算其秩，从而掌握判断系统可控性的核心方法。",
            "id": "4001595",
            "problem": "考虑一个由三个皮层区域组成的小型大脑网络的线性化神经元群体模型，该模型表示为一个连续时间线性时不变（LTI）系统，其状态方程为 $\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B}u(t)$，其中 $\\mathbf{x}(t) \\in \\mathbb{R}^{3}$ 是区域活动向量，$u(t) \\in \\mathbb{R}$ 是一个标量控制输入，$\\mathbf{A} \\in \\mathbb{R}^{3 \\times 3}$ 是通过结合被动泄漏和解剖连接得到的系统矩阵。解剖连接矩阵 $\\mathbf{W}$ 由下式给出\n$$\n\\mathbf{W} = \\begin{pmatrix}\n0  0.9  0.1 \\\\\n0.4  0  0.7 \\\\\n0  0.5  0\n\\end{pmatrix},\n$$\n并且被动泄漏被建模为 $-\\gamma\\mathbf{I}$，其中 $\\gamma = 0.8$，因此 $\\mathbf{A} = \\mathbf{W} - \\gamma\\mathbf{I}$。控制输入仅注入到第二个节点，因此选择\n$$\n\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用 Kalman 框架中可达性的基本定义，构建此设置所隐含的能控性矩阵并计算其秩。根据该秩，判断仅在第二个节点注入控制是否能使该三维系统可控。将最终答案表示为能控性矩阵的秩，形式为单个整数。最终答案无需四舍五入，也无需单位。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n-   系统模型：连续时间线性时不变（LTI）系统。\n-   状态方程：$\\dot{\\mathbf{x}}(t) = \\mathbf{A}\\mathbf{x}(t) + \\mathbf{B}u(t)$。\n-   状态向量：$\\mathbf{x}(t) \\in \\mathbb{R}^{3}$。\n-   控制输入：$u(t) \\in \\mathbb{R}$。\n-   系统矩阵定义：$\\mathbf{A} = \\mathbf{W} - \\gamma\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n-   解剖连接矩阵：$\\mathbf{W} = \\begin{pmatrix} 0  0.9  0.1 \\\\ 0.4  0  0.7 \\\\ 0  0.5  0 \\end{pmatrix}$。\n-   被动泄漏参数：$\\gamma = 0.8$。\n-   控制输入矩阵：$\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n-   任务：构建能控性矩阵并计算其秩，以评估系统的能控性。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **有科学依据**：该问题在网络控制理论及其在计算神经科学中的应用方面有充分的依据。使用线性化神经元群体模型、LTI 系统表示、连接矩阵 $\\mathbf{W}$ 和泄漏项 $-\\gamma\\mathbf{I}$ 都是建模大脑动力学中标准且成熟的组成部分。该问题在科学上是合理的。\n-   **适定性**：问题定义清晰。它要求构建能控性矩阵并计算其秩，这些都是控制理论中的标准程序。所有必要的数据（$\\mathbf{W}$、$\\gamma$、$\\mathbf{B}$）和定义都已提供，可以唯一确定系统矩阵 $\\mathbf{A}$ 以及随后的能控性矩阵 $\\mathcal{C}$。存在一个唯一的、有意义的解（秩）。\n-   **客观性**：问题使用精确的数学语言和客观定义进行陈述，没有歧义或主观论断。\n-   **完整性和一致性**：问题是自洽的。矩阵和向量的维度是一致的：$\\mathbf{A} \\in \\mathbb{R}^{3 \\times 3}$，$\\mathbf{x} \\in \\mathbb{R}^{3}$，$\\mathbf{B} \\in \\mathbb{R}^{3 \\times 1}$，且 $u(t)$ 是一个标量。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为它有科学依据、适定、客观且内部一致。可以继续进行求解过程。\n\n问题的核心是评估给定 LTI 系统的能控性。对于一个维度为 $n$ 的系统，其能控性由能控性矩阵 $\\mathcal{C}$ 的秩决定。系统是可控的，当且仅当 $\\text{rank}(\\mathcal{C}) = n$。\n\n首先，我们使用给定的定义 $\\mathbf{A} = \\mathbf{W} - \\gamma\\mathbf{I}$ 来构建系统矩阵 $\\mathbf{A}$。\n给定 $\\gamma = 0.8$，矩阵 $\\gamma\\mathbf{I}$ 是：\n$$\n\\gamma\\mathbf{I} = 0.8 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0.8  0  0 \\\\ 0  0.8  0 \\\\ 0  0  0.8 \\end{pmatrix}\n$$\n现在，我们可以计算 $\\mathbf{A}$：\n$$\n\\mathbf{A} = \\mathbf{W} - \\gamma\\mathbf{I} = \\begin{pmatrix} 0  0.9  0.1 \\\\ 0.4  0  0.7 \\\\ 0  0.5  0 \\end{pmatrix} - \\begin{pmatrix} 0.8  0  0 \\\\ 0  0.8  0 \\\\ 0  0  0.8 \\end{pmatrix} = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix}\n$$\n状态空间维度为 $n=3$。能控性矩阵，也称为 Kalman 矩阵，定义为：\n$$\n\\mathcal{C} = \\begin{pmatrix} \\mathbf{B}  \\mathbf{A}\\mathbf{B}  \\mathbf{A}^2\\mathbf{B}  \\dots  \\mathbf{A}^{n-1}\\mathbf{B} \\end{pmatrix}\n$$\n对于 $n=3$，它变为：\n$$\n\\mathcal{C} = \\begin{pmatrix} \\mathbf{B}  \\mathbf{A}\\mathbf{B}  \\mathbf{A}^2\\mathbf{B} \\end{pmatrix}\n$$\n我们依次计算 $\\mathcal{C}$ 的各列。\n第一列是控制矩阵 $\\mathbf{B}$：\n$$\n\\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n第二列是 $\\mathbf{A}\\mathbf{B}$：\n$$\n\\mathbf{A}\\mathbf{B} = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-0.8)(0) + (0.9)(1) + (0.1)(0) \\\\ (0.4)(0) + (-0.8)(1) + (0.7)(0) \\\\ (0)(0) + (0.5)(1) + (-0.8)(0) \\end{pmatrix} = \\begin{pmatrix} 0.9 \\\\ -0.8 \\\\ 0.5 \\end{pmatrix}\n$$\n第三列是 $\\mathbf{A}^2\\mathbf{B}$，可以计算为 $\\mathbf{A}(\\mathbf{A}\\mathbf{B})$：\n$$\n\\mathbf{A}^2\\mathbf{B} = \\mathbf{A}(\\mathbf{A}\\mathbf{B}) = \\begin{pmatrix} -0.8  0.9  0.1 \\\\ 0.4  -0.8  0.7 \\\\ 0  0.5  -0.8 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ -0.8 \\\\ 0.5 \\end{pmatrix}\n$$\n$$\n\\mathbf{A}^2\\mathbf{B} = \\begin{pmatrix} (-0.8)(0.9) + (0.9)(-0.8) + (0.1)(0.5) \\\\ (0.4)(0.9) + (-0.8)(-0.8) + (0.7)(0.5) \\\\ (0)(0.9) + (0.5)(-0.8) + (-0.8)(0.5) \\end{pmatrix} = \\begin{pmatrix} -0.72 - 0.72 + 0.05 \\\\ 0.36 + 0.64 + 0.35 \\\\ 0 - 0.4 - 0.4 \\end{pmatrix} = \\begin{pmatrix} -1.39 \\\\ 1.35 \\\\ -0.8 \\end{pmatrix}\n$$\n现在，我们组装能控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0.9  -1.39 \\\\ 1  -0.8  1.35 \\\\ 0  0.5  -0.8 \\end{pmatrix}\n$$\n为了求 $\\mathcal{C}$ 的秩，我们可以计算其行列式。非零行列式意味着各列线性无关，矩阵满秩。对于一个 $3 \\times 3$ 矩阵，满秩即秩为 3。为简单起见，我们沿第一列进行代数余子式展开：\n$$\n\\det(\\mathcal{C}) = (0) \\cdot C_{11} - (1) \\cdot \\det\\begin{pmatrix} 0.9  -1.39 \\\\ 0.5  -0.8 \\end{pmatrix} + (0) \\cdot C_{31}\n$$\n其中 $C_{ij}$ 是代数余子式。\n$$\n\\det(\\mathcal{C}) = -1 \\left[ (0.9)(-0.8) - (-1.39)(0.5) \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.72 - (-0.695) \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.72 + 0.695 \\right]\n$$\n$$\n\\det(\\mathcal{C}) = -1 \\left[ -0.025 \\right] = 0.025\n$$\n由于 $\\det(\\mathcal{C}) = 0.025 \\neq 0$，矩阵 $\\mathcal{C}$ 是可逆的并且是满秩的。能控性矩阵的秩是 3。\n\n能控性的条件是能控性矩阵的秩必须等于状态空间的维度。此处，$\\text{rank}(\\mathcal{C}) = 3$ 且 $n=3$。由于 $\\text{rank}(\\mathcal{C}) = n$，该系统是可控的。这意味着仅在第二个节点注入控制输入就足以在有限时间内将所有三个节点的活动引导到任何期望的状态。问题要求的是能控性矩阵的秩。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "仅仅知道系统是否可控是不够的，我们往往更关心控制的“难易程度”。平均可控性是一个衡量从特定节点驱动整个网络所需能量的指标，它通过求解Lyapunov方程来计算。这项实践不仅让你掌握计算可控性Gramian的方法，还将揭示网络拓扑结构（如“枢纽”节点）与控制效率之间的深刻联系。",
            "id": "4001597",
            "problem": "考虑一个具有三个区域的离散时间线性时不变 (LTI) 脑网络模型，其状态演化为 $x_{t+1} = A x_t + B u_t$。区域间的对称加权结构连接由矩阵编码\n$$\n\\tilde{A} = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix},\n$$\n并且动力学耦合通过设置 $A = \\alpha \\tilde{A}$（其中 $\\alpha = \\frac{1}{2}$）进行归一化以确保稳定性。假设采用单节点输入，即对于节点 $i$，使用 $B = e_i$，其中 $e_i$ 是 $\\mathbb{R}^3$ 中的第 $i$ 个标准基向量。使用离散时间 LTI 系统的可控性基本定义，计算每个节点的平均可控性，并按平均可控性从高到低对节点进行排序。如果两个节点并列，则按节点索引递增的顺序打破平局。将您的最终答案表示为一个单行矩阵，其前三个条目是节点 $1$、$2$ 和 $3$ 的平均可控性值（按此顺序），后三个条目是按降序排列的节点索引。无需四舍五入。根据给定脑网络中的中心性（基于度的中心性）来解释该排名。",
            "solution": "该问题要求计算一个三节点线性时不变 (LTI) 脑网络模型中每个节点的平均可控性，并随后进行排序和解释。\n\n该系统由离散时间 LTI 方程 $x_{t+1} = A x_t + B u_t$ 描述，其中 $x_t \\in \\mathbb{R}^3$ 是三个脑区域在时间 $t$ 的状态。系统矩阵 $A$ 由结构连接矩阵 $\\tilde{A}$ 和一个缩放因子 $\\alpha$ 导出。\n\n首先，我们定义系统矩阵 $A$：\n$$\n\\tilde{A} = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}, \\quad \\alpha = \\frac{1}{2}\n$$\n$$\nA = \\alpha \\tilde{A} = \\frac{1}{2} \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1/2  0 \\\\ 1/2  0  1/2 \\\\ 0  1/2  0 \\end{pmatrix}\n$$\n$A$ 的特征值可以通过求解 $\\det(A - \\lambda I) = 0$ 找到，得到 $-\\lambda(\\lambda^2 - 1/2) = 0$。特征值为 $\\lambda_1 = 0$、$\\lambda_2 = 1/\\sqrt{2}$ 和 $\\lambda_3 = -1/\\sqrt{2}$。由于谱半径 $\\rho(A) = \\max_i |\\lambda_i| = 1/\\sqrt{2}  1$，系统是稳定的。\n\n离散时间 LTI 系统的可控性由可控性格拉姆矩阵 $W_c$ 来表征。对于一个稳定系统，它由收敛级数 $W_c = \\sum_{k=0}^{\\infty} A^k B B^T (A^T)^k$ 给出。一种更实用的计算 $W_c$ 的方法是求解离散时间李雅普诺夫方程：\n$$\nA W_c A^T - W_c = -B B^T \\quad \\text{或等价地} \\quad W_c - A W_c A^T = B B^T\n$$\n平均可控性定义为可控性格拉姆矩阵的迹，$\\text{Trace}(W_c)$。一个较大的 $\\text{Trace}(W_c)$ 值表示系统状态平均而言更容易从指定的输入节点达到。\n\n我们将计算在三个节点中每一个节点进行单节点控制时的平均可控性，其中输入矩阵 $B$ 由 $B_i = e_i$（第 $i$ 个标准基向量）给出。\n\n设 $W_c$ 为一个对称矩阵 $W_c = \\begin{pmatrix} w_{11}  w_{12}  w_{13} \\\\ w_{12}  w_{22}  w_{23} \\\\ w_{13}  w_{23}  w_{33} \\end{pmatrix}$。$A W_c A^T$ 项计算如下：\n$$\nA W_c A^T = \\begin{pmatrix}\n\\frac{1}{4} w_{22}  \\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} w_{22} \\\\\n\\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} (w_{11} + 2w_{13} + w_{33})  \\frac{1}{4} (w_{12} + w_{23}) \\\\\n\\frac{1}{4} w_{22}  \\frac{1}{4} (w_{12} + w_{23})  \\frac{1}{4} w_{22}\n\\end{pmatrix}\n$$\n\n**情况 1：在节点 1 进行控制**\n此处，$B = B_1 = e_1 = (1, 0, 0)^T$，因此 $B_1 B_1^T = \\text{diag}(1, 0, 0)$。设 $W_{c,1}$ 为格拉姆矩阵。李雅普诺夫方程 $W_{c,1} - A W_{c,1} A^T = B_1 B_1^T$ 为元素 $w_{ij}$ 提供了以下方程组：\n1. $(1,1): w_{11} - \\frac{1}{4} w_{22} = 1$\n2. $(2,2): w_{22} - \\frac{1}{4} (w_{11} + 2w_{13} + w_{33}) = 0$\n3. $(3,3): w_{33} - \\frac{1}{4} w_{22} = 0 \\implies w_{33} = \\frac{1}{4} w_{22}$\n4. $(1,3): w_{13} - \\frac{1}{4} w_{22} = 0 \\implies w_{13} = \\frac{1}{4} w_{22}$\n由于对角元素就足以计算迹，我们解出它们：\n$w_{33} = \\frac{1}{4} w_{22}$ 且 $w_{13} = \\frac{1}{4} w_{22}$。\n代入方程 2：$w_{22} - \\frac{1}{4} (w_{11} + 2(\\frac{1}{4}w_{22}) + \\frac{1}{4}w_{22}) = 0 \\implies w_{22} - \\frac{1}{4} w_{11} - \\frac{1}{8} w_{22} - \\frac{1}{16} w_{22} = 0 \\implies \\frac{13}{16} w_{22} = \\frac{1}{4} w_{11} \\implies w_{11} = \\frac{13}{4} w_{22}$。\n将此代入方程 1：$\\frac{13}{4} w_{22} - \\frac{1}{4} w_{22} = 1 \\implies \\frac{12}{4} w_{22} = 1 \\implies 3 w_{22} = 1 \\implies w_{22} = 1/3$。\n那么 $w_{11} = 1 + \\frac{1}{4}(\\frac{1}{3}) = 1 + \\frac{1}{12} = \\frac{13}{12}$。\n并且 $w_{33} = \\frac{1}{4} w_{22} = \\frac{1}{4}(\\frac{1}{3}) = \\frac{1}{12}$。\n节点 1 的平均可控性是 $\\text{avg_c}_1 = \\text{Trace}(W_{c,1}) = w_{11} + w_{22} + w_{33} = \\frac{13}{12} + \\frac{1}{3} + \\frac{1}{12} = \\frac{13+4+1}{12} = \\frac{18}{12} = \\frac{3}{2}$。\n\n**情况 3：在节点 3 进行控制**\n网络图在交换节点 1 和 3 时是对称的。因此，控制节点 3 与控制节点 1 是对称的。相对于 $W_{c,1}$，格拉姆矩阵 $W_{c,3}$ 的对角元素 $w_{11,3}$ 和 $w_{33,3}$ 将会交换，而 $w_{22,3}$ 保持不变。\n$w_{11,3} = w_{33,1} = 1/12$。\n$w_{33,3} = w_{11,1} = 13/12$。\n$w_{22,3} = w_{22,1} = 1/3$。\n节点 3 的平均可控性是 $\\text{avg_c}_3 = \\text{Trace}(W_{c,3}) = \\frac{1}{12} + \\frac{1}{3} + \\frac{13}{12} = \\frac{1+4+13}{12} = \\frac{18}{12} = \\frac{3}{2}$。\n\n**情况 2：在节点 2 进行控制**\n此处，$B = B_2 = e_2 = (0, 1, 0)^T$，因此 $B_2 B_2^T = \\text{diag}(0, 1, 0)$。设 $W_{c,2}$ 为格拉姆矩阵。李雅普诺夫方程给出：\n1. $(1,1): w_{11} - \\frac{1}{4} w_{22} = 0 \\implies w_{11} = \\frac{1}{4} w_{22}$\n2. $(2,2): w_{22} - \\frac{1}{4} (w_{11} + 2w_{13} + w_{33}) = 1$\n3. $(3,3): w_{33} - \\frac{1}{4} w_{22} = 0 \\implies w_{33} = \\frac{1}{4} w_{22}$\n4. $(1,3): w_{13} - \\frac{1}{4} w_{22} = 0 \\implies w_{13} = \\frac{1}{4} w_{22}$\n由于网络相对于节点 1 和 3 的对称性，我们预期 $w_{11} = w_{33}$，这一点得到了证实。\n将这些代入方程 2：\n$w_{22} - \\frac{1}{4} (\\frac{1}{4}w_{22} + 2(\\frac{1}{4}w_{22}) + \\frac{1}{4}w_{22}) = 1$\n$w_{22} - \\frac{1}{4} (\\frac{4}{4}w_{22}) = 1 \\implies w_{22} - \\frac{1}{4} w_{22} = 1 \\implies \\frac{3}{4} w_{22} = 1 \\implies w_{22} = 4/3$。\n那么 $w_{11} = \\frac{1}{4}(\\frac{4}{3}) = 1/3$ 且 $w_{33} = \\frac{1}{4}(\\frac{4}{3}) = 1/3$。\n节点 2 的平均可控性是 $\\text{avg_c}_2 = \\text{Trace}(W_{c,2}) = w_{11} + w_{22} + w_{33} = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = \\frac{6}{3} = 2$。\n\n**总结与排名**\n平均可控性值如下：\n- 节点 $1$：$\\text{avg_c}_1 = 3/2 = 1.5$\n- 节点 $2$：$\\text{avg_c}_2 = 2$\n- 节点 $3$：$\\text{avg_c}_3 = 3/2 = 1.5$\n\n按平均可控性从高到低排名：\n1. 节点 $2$ (值 $2$)\n2. 节点 $1$ (值 $3/2$)\n3. 节点 $3$ (值 $3/2$)\n\n节点 1 和 3 并列。问题规定按节点索引递增的顺序打破平局。这意味着节点 1 的排名高于节点 3。所以最终排名是：节点 2 (排名第 1)，节点 1 (排名第 2)，节点 3 (排名第 3)。从最高排名到最低排名的节点索引有序列表是 $(2, 1, 3)$。\n\n**解释**\n问题要求根据中心性（基于度的中心性）来解释该排名。网络中一个节点的度是它所拥有的连接数。对于未加权的结构连接矩阵 $\\tilde{A}$，度为：\n- 节点 1 的度 = $\\sum_j \\tilde{A}_{1j} = 1$\n- 节点 2 的度 = $\\sum_j \\tilde{A}_{2j} = 2$\n- 节点 3 的度 = $\\sum_j \\tilde{A}_{3j} = 1$\n\n节点 2 的度最高，使其成为该网络的枢纽。节点 1 和 3 是度较低的外围节点。平均可控性的排名（节点 2 > 节点 1 = 节点 3）与节点度的排名完全一致。\n解释是：枢纽节点（节点 2）表现出最高的平均可控性，而外围节点（节点 1 和 3）具有较低的平均可控性。这表明具有较高 度中心性的节点在控制整个网络动态方面更有效。它们的中心位置和更多的连接数使它们能够更容易地影响整个网络的状态，这是网络控制理论中的一个常见发现。节点 1 和 3 相同的可控性值反映了它们在网络中对称的拓扑位置。\n\n**最终答案的构建**\n最终答案必须是一个单行矩阵，其中包含节点 $1, 2, 3$ 的平均可控性值，后面是按降序排列的节点索引。\n值为：$\\text{avg_c}_1 = 3/2$, $\\text{avg_c}_2 = 2$, $\\text{avg_c}_3 = 3/2$。\n排好序的节点索引为：$2, 1, 3$。\n得到的矩阵是 $(\\frac{3}{2} \\quad 2 \\quad \\frac{3}{2} \\quad 2 \\quad 1 \\quad 3)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2}  2  \\frac{3}{2}  2  1  3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在真实的脑网络中，连接权重往往是未知或可变的。结构可控性理论不依赖于具体的权重值，只关注网络的布线图，因此尤为重要。这项动手实践要求你编写代码，根据一个假设的层级规则构建有向脑网络，并应用最大匹配算法来识别控制整个网络所需的最少“驱动节点”集合。",
            "id": "4001604",
            "problem": "给定一个带有非负项的对称大脑结构连接矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它代表了 $n$ 个大脑区域之间的无向解剖链接。您的任务是基于层级梯度引入合理的有向性来构建一个有向大脑图，然后使用结构可控性下的最大匹配来计算最小驱动节点集。节点索引从 $0$ 到 $n-1$。\n\n使用的基本原理和定义：\n- 考虑一个线性时不变系统 $\\dot{x}(t) = A x(t) + B u(t)$，其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$A \\in \\mathbb{R}^{n \\times n}$ 是由大脑图决定的系统矩阵，$u(t) \\in \\mathbb{R}^m$ 是输入，而 $B \\in \\mathbb{R}^{n \\times m}$ 是输入矩阵。结构可控性将可控性与 $(A, B)$ 的稀疏模式以及由 $A$ 的非零项导出的有向图联系起来。\n- 对于一个有 $n$ 个节点的有向图，形成一个二分图，其左部 $L = \\{0, 1, \\dots, n-1\\}$ 代表源端点，右部 $R = \\{0, 1, \\dots, n-1\\}$ 代表目标端点。对于有向图中的每条有向边 $i \\to j$，在二分图中放置一条从 $L$ 到 $R$ 的边 $(i, j)$。\n- 匹配是一组没有共享端点的边；最大匹配是具有最大可能基数的匹配。在结构可控性下，最小驱动节点集等于有向网络导出的二分图的最大匹配中 $R$ 里的未匹配节点集合。\n- 您必须使用正确的算法（例如，Hopcroft–Karp 算法）实现最大二分匹配，并计算 $R$ 中的未匹配节点。\n\n从对称矩阵 $A$ 构建有向性的规则：\n- 给定一个节点的层级得分向量 $h \\in \\mathbb{R}^n$。对于每个无向链接，您必须赋予一个相对于 $h$ 合理的方向，优先选择沿层级上升的边，但允许偶尔出现反馈。\n- 设 $\\tau \\ge 0$ 是一个小的容差。对于每一对 $i, j$ 且 $A_{ij} > 0$ 的 $(i, j)$，定义如下：\n    1. 如果 $\\lvert h_i - h_j \\rvert \\le \\tau$，则同时包含有向边 $i \\to j$ 和 $j \\to i$。\n    2. 否则，让前向方向从层级较低的节点指向层级较高的节点。具体来说，如果 $h_i  h_j$，则包含 $i \\to j$；如果 $h_j  h_i$，则包含 $j \\to i$。\n    3. 此外，使用一个确定性伪随机代理 $u_{ij} = \\mathrm{frac}\\!\\left(\\sin(\\alpha i + \\beta j)^2\\right)$，以一个小的类概率水平 $\\epsilon \\in [0, 1]$ 包含一个反向边，其中 $\\mathrm{frac}(x) = x - \\lfloor x \\rfloor$，$\\alpha = 0.61803398875$，以及 $\\beta = 1.41421356237$。如果 $u_{ij}  \\epsilon$，则也包含反向边。该代理在模拟偶然反馈的同时确保了结果的可复现性。\n\n您的程序应该：\n1. 对于每个测试用例，根据上述规则构建有向邻接表。\n2. 构建二分图表示，其左部索引为 $L = \\{0, \\dots, n-1\\}$，右部索引为 $R = \\{0, \\dots, n-1\\}$，并且对于每条有向边 $i \\to j$，都有一条边 $(i, j)$。\n3. 在此二分图中计算最大匹配。\n4. 为每个测试用例返回 $R$ 中未匹配节点的排序列表。此列表即为最小驱动节点集。\n5. 将所有测试用例的结果汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，其中每个测试用例的驱动节点集表示为一个整数列表（例如，$[[0,2],[1,3],[]]$）。\n\n角度单位不适用。此问题中没有物理单位。所有输出必须是整数索引。\n\n测试套件：\n- 测试用例 1（正常路径，带跨模块链接和层级的模块化图）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  1  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    1  1  0  0.5  0  0 \\\\\n    0  0  0.5  0  1  1 \\\\\n    0  0  0  1  0  1 \\\\\n    0  0  0  1  1  0\n    \\end{bmatrix},\\quad h = [0.1, 0.2, 0.4, 0.5, 0.8, 1.0],\\quad \\epsilon = 0.15,\\quad \\tau = 0.$$\n- 测试用例 2（边界情况，无边）：\n    - $n = 5$,\n    - $$A = \\begin{bmatrix}\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0 \\\\\n    0  0  0  0  0\n    \\end{bmatrix},\\quad h = [0, 0, 0, 0, 0],\\quad \\epsilon = 0.3,\\quad \\tau = 10^{-12}.$$\n- 测试用例 3（完全图，层级平分，双向边）：\n    - $n = 5$,\n    - $$A_{ij} = \\begin{cases}\n    1  \\text{if } i \\ne j,\\\\\n    0  \\text{if } i = j\n    \\end{cases},\\quad h = [0.5, 0.5, 0.5, 0.5, 0.5],\\quad \\epsilon = 0.0,\\quad \\tau = 10^{-6}.$$\n- 测试用例 4（边界情况，层级递增的路径图，无反馈）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  0  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    0  1  0  1  0  0 \\\\\n    0  0  1  0  1  0 \\\\\n    0  0  0  1  0  1 \\\\\n    0  0  0  0  1  0\n    \\end{bmatrix},\\quad h = [0, 1, 2, 3, 4, 5],\\quad \\epsilon = 0.0,\\quad \\tau = 0.0.$$\n- 测试用例 5（星形图，中心节点层级高，无反馈）：\n    - $n = 6$,\n    - $$A = \\begin{bmatrix}\n    0  1  1  1  1  1 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0\n    \\end{bmatrix},\\quad h = [2.0, 0.1, 0.1, 0.1, 0.1, 0.1],\\quad \\epsilon = 0.0,\\quad \\tau = 0.0.$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目是对应测试用例的已排序的未匹配右部节点列表。例如，输出必须看起来像 $[[a_1],[a_2],\\dots]$，其中每个 $[a_k]$ 是一个整数列表。",
            "solution": "该问题要求我们为给定的大脑网络确定最小驱动节点集，该网络源自一个给定的无向结构连接矩阵 $A$。解决方案涉及一个多步骤的过程：首先，根据预定义的层级规则从 $A$ 构建一个有向图；其次，在该有向网络的二分图表示上计算最大匹配；第三，将驱动节点识别为最大匹配中的未匹配节点。该过程基于线性时不变 (LTI) 系统的结构可控性原理。\n\n问题的核心在于应用结构可控性定理，该定理指出，控制一个网络所需的最小驱动节点数为 $N_D = \\max(1, n - |M^{*}|)$，其中 $n$ 是节点数，而 $|M^{*}|$ 是有向图中最大匹配的基数。驱动节点集本身对应于未匹配节点的集合。问题将其简化为 $N_D = n - |M^*|$ 并将驱动集定义为未匹配的节点，这是网络控制文献中的常见约定。\n\n对于每个测试用例，总体算法流程如下：\n\n1.  **有向图的构建**：\n    给定一个对称的非负矩阵 $A \\in \\mathbb{R}^{n \\times n}$、一个层级得分向量 $h \\in \\mathbb{R}^n$、一个容差 $\\tau \\ge 0$ 以及一个反馈概率代理水平 $\\epsilon \\in [0, 1]$。我们构建大脑图的有向邻接表表示。我们遍历每一对节点 $(i, j)$，其中 $i  j$。如果存在无向链接（即 $A_{ij} > 0$），我们根据以下规则分配有向性：\n    -   **平局处理规则**：如果层级得分的绝对差在容差范围内，即 $|h_i - h_j| \\le \\tau$，则连接被视为相互的。我们同时添加有向边 $i \\to j$ 和 $j \\to i$。\n    -   **层级规则**：如果 $|h_i - h_j| > \\tau$，则建立一个从层级得分较低的节点到得分较高的节点的主前馈边。也就是说，如果 $h_i  h_j$，我们添加边 $i \\to j$；如果 $h_j  h_i$，我们添加边 $j \\to i$。\n    -   **反馈规则**：除了主方向外，还会概率性地添加一个“反馈”或反向边。这通过一个确定性伪随机代理 $u_{ij} = \\mathrm{frac}(\\sin^2(\\alpha i + \\beta j))$ 来建模，其中 $\\alpha = 0.61803398875$，$\\beta = 1.41421356237$，且 $\\mathrm{frac}(x) = x - \\lfloor x \\rfloor$ 是 $x$ 的小数部分。如果 $u_{ij}  \\epsilon$，则也包含反向边。该代理确保了结果的可复现性。\n\n2.  **最大二分匹配**：\n    该有向图被转换为一个二分图 $G_B = (L \\cup R, E_B)$，其中左部 $L = \\{0, 1, \\dots, n-1\\}$ 和右部 $R = \\{0, 1, \\dots, n-1\\}$ 都代表大脑区域的集合。对于我们构建的图中的每条有向边 $i \\to j$，我们在二分图中添加一条从节点 $i \\in L$ 到节点 $j \\in R$ 的对应边 $(i, j)$。\n\n    为了在 $G_B$ 中找到最大匹配，我们采用一个基于深度优先搜索 (DFS) 的标准增广路径算法。匹配是一组没有公共顶点的边。增广路径是图中的一条路径，它从未匹配的 $L$ 中节点开始，到未匹配的 $R$ 中节点结束，路径上的边在“不属于匹配”和“属于匹配”之间交替。通过找到一条增广路径并翻转其上各边的状态，我们可以将匹配的大小增加一。\n\n    算法流程如下：\n    - 初始化一个空匹配，其中所有节点都未匹配。我们使用一个大小为 $n$ 的数组 `match_R`，其中 `match_R[v]` 存储与 $R$ 中节点 $v$ 匹配的 $L$ 中节点，并初始化为哨兵值（如 $-1$）。\n    - 遍历 $L$ 中的每个节点 $u$。\n    - 对每个 $u$，执行一次 DFS 以寻找从 $u$ 开始的增广路径。使用一个 `visited` 数组来跟踪当前 DFS 遍历中访问过的 $R$ 中节点，以避免循环。\n    - DFS 函数 `dfs(u, visited, match_R)` 尝试为节点 $u$ 寻找匹配。它遍历 $u$ 在 $R$ 中的邻居 $v$。如果 $v$ 未被访问过：\n        - 我们将 $v$ 标记为已访问。\n        - 如果 $v$ 当前未匹配，或者我们可以为当前与 $v$ 匹配的节点递归地找到一条增广路径，那么我们就找到了一条增广路径。我们通过设置 `match_R[v] = u` 来更新匹配，并返回 `True`。\n    - 如果循环完成而没有找到路径，`dfs` 返回 `False`。\n    - 对 $L$ 中的所有节点重复此过程。最终的匹配即为最大匹配。\n\n3.  **驱动节点的识别**：\n    根据结构可控性理论，最小驱动节点集对应于二分图右部 $R$ 中的未匹配节点集合。在计算出最大匹配并填充 `match_R` 数组后，驱动节点就是 `match_R[v]` 仍然为 $-1$ 的索引 $v \\in R$ 的集合。\n    然后，按要求将得到的驱动节点索引列表按升序排序。\n\n这整个过程被封装在一个函数中，对每个测试用例调用该函数。最终输出是所有测试用例的已排序驱动节点列表的汇总，格式化为单个字符串。",
            "answer": "[[2,3],[0,1,2,3,4],[],[0],[1,2,3,4,5]]"
        }
    ]
}