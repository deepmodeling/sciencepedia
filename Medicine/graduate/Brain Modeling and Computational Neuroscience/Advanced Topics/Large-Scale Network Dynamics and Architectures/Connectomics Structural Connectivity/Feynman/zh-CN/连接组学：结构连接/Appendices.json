{
    "hands_on_practices": [
        {
            "introduction": "结构连接组不仅仅是一张连接图；这些连接的物理属性，如信号传输速度，对于理解大脑功能至关重要。本练习将指导您从轴突的微观结构生物物理特性（如髓鞘化和直径）出发，计算传导延迟。通过这项实践，您将把网络中抽象的“边”与具体的神经生理学基础联系起来，理解大脑中时间延迟的来源。",
            "id": "3972521",
            "problem": "考虑一个连接皮层区域$i$和$j$的单一白质通路，该通路包含两个具有不同微观结构特性的连续髓鞘化节段。第一个节段穿过深部白质，第二个节段穿过皮层附近的浅表$\\mathrm{U}$形纤维。对于每个节段，给定轴突内径$d$和髓鞘$\\mathrm{g}$比$g$，其中$g$定义为$g = r_{i}/r_{o}$，$r_{i}$是内（轴突）半径，$r_{o}$是包含髓鞘的外半径。因此，纤维外径为$D_{o} = 2 r_{o} = d/g$。假设为跳跃式传导，郎飞节（NoR）动力学具有以下经过充分检验的特征：节间长度与纤维外径大致成线性比例关系，$\\ell = \\eta D_{o}$，其中$\\eta$是一个无量纲比例常数；郎飞节去极化时间$\\tau_{n}$在整个通路中近似恒定。在这些假设下，节段传导速度由每次郎飞节去极化前进的距离除以郎飞节去极化时间决定。\n\n该通路具有以下属性：\n- 节段 $1$：长度 $L_{1} = 40 \\,\\mathrm{mm}$，内径 $d_{1} = 1.3 \\,\\mu \\mathrm{m}$，$\\mathrm{g}$比 $g_{1} = 0.62$。\n- 节段 $2$：长度 $L_{2} = 12 \\,\\mathrm{mm}$，内径 $d_{2} = 0.9 \\,\\mu \\mathrm{m}$，$\\mathrm{g}$比 $g_{2} = 0.68$。\n- 节间长度缩放因子 $\\eta = 110$（无量纲）。\n- 郎飞节去极化时间 $\\tau_{n} = 0.02 \\,\\mathrm{ms}$。\n\n将通路上的有效解剖距离$d_{ij}$定义为两个节段的弧长之和。从$\\mathrm{g}$比的定义以及节间长度与外径成线性比例（常数为$\\eta$）且郎飞节去极化时间$\\tau_{n}$恒定的假设出发，推导出用$d$和$g$表示的节段传导速度。使用此公式计算节段1和节段2的速度。然后，利用连续节段的传导延迟线性相加的物理原理，计算整个通路的总传导延迟$\\tau_{ij}$。最后，通过等式$\\tau_{ij} = d_{ij}/v_{ij}$定义一个有效通路级速度$v_{ij}$，并报告$\\tau_{ij}$的数值。\n\n以$\\mathrm{ms}$为单位表示最终的传导延迟。将答案四舍五入到四位有效数字。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**第1步：提取已知条件**\n- 连接皮层区域$i$和$j$的两个连续髓鞘化节段。\n- 节段 $1$（深部白质）：长度 $L_{1} = 40 \\,\\mathrm{mm}$，轴突内径 $d_{1} = 1.3 \\,\\mu \\mathrm{m}$，g比 $g_{1} = 0.62$。\n- 节段 $2$（浅表U形纤维）：长度 $L_{2} = 12 \\,\\mathrm{mm}$，轴突内径 $d_{2} = 0.9 \\,\\mu \\mathrm{m}$，g比 $g_{2} = 0.68$。\n- g比的定义：$g = r_{i}/r_{o}$，其中$r_{i}$是内半径，$r_{o}$是外半径。\n- 纤维外径的定义：$D_{o} = 2 r_{o} = d/g$。\n- 节间长度缩放定律：$\\ell = \\eta D_{o}$。\n- 节间长度缩放因子：$\\eta = 110$（无量纲）。\n- 郎飞节去极化时间：$\\tau_{n} = 0.02 \\,\\mathrm{ms}$（恒定）。\n- 节段传导速度的定义：每次郎飞节（NoR）去极化前进的距离除以郎飞节去极化时间。\n- 总延迟的原理：连续节段的传导延迟线性相加，$\\tau_{ij} = \\tau_{1} + \\tau_{2}$。\n- 有效解剖距离的定义：$d_{ij} = L_{1} + L_{2}$。\n- 有效通路级速度的定义：$\\tau_{ij} = d_{ij}/v_{ij}$。\n- 最终要求的值：总传导延迟$\\tau_{ij}$，以$\\mathrm{ms}$为单位，并四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据**：该问题基于已确立的神经传导生物物理学原理。跳跃式传导模型、g比的定义以及节间长度与轴突直径的线性缩放关系是计算神经科学和神经生理学中的标准概念。给定的轴突直径、g比和传导参数的数值在人类白质通路的合理生物学范围内。该问题在科学上是合理的。\n- **适定性**：计算总传导延迟所需的所有必要数据、定义和物理原理均已提供。该问题是自洽的，其结构可以导出一个唯一的数值解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述，没有主观论断。\n\n**第3步：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、适定性和客观性。将提供完整解答。\n\n**求解过程**\n主要目标是计算信号穿过两个节段的总传导延迟$\\tau_{ij}$。\n\n首先，我们推导髓鞘化节段传导速度$v$的一般表达式。根据题目陈述，速度是郎飞节一次去极化周期内前进的距离（即节间长度$\\ell$）除以该周期的时间（即郎飞节去极化时间$\\tau_{n}$）。\n$$\nv = \\frac{\\ell}{\\tau_{n}}\n$$\n题目提供了节间长度$\\ell$与纤维外径$D_{o}$的线性缩放定律：\n$$\n\\ell = \\eta D_{o}\n$$\n其中$\\eta$是一个无量纲比例常数。纤维外径$D_{o}$通过给定公式与轴突内径$d$和g比$g$相关联：\n$$\nD_{o} = \\frac{d}{g}\n$$\n将这些关系代入速度方程，得到用给定的微观结构属性$d$和$g$表示的节段传导速度：\n$$\nv = \\frac{\\eta D_{o}}{\\tau_{n}} = \\frac{\\eta}{\\tau_{n}} \\left( \\frac{d}{g} \\right) = \\frac{\\eta d}{g \\tau_{n}}\n$$\n接下来，我们计算总传导延迟$\\tau_{ij}$。题目指出，连续节段的延迟是线性相加的。总延迟是节段1的延迟（$\\tau_{1}$）和节段2的延迟（$\\tau_{2}$）之和：\n$$\n\\tau_{ij} = \\tau_{1} + \\tau_{2}\n$$\n每个节段$k$的延迟是其长度$L_{k}$除以其传导速度$v_{k}$：\n$$\n\\tau_{k} = \\frac{L_{k}}{v_{k}}\n$$\n将推导出的速度表达式$v_k = \\frac{\\eta d_k}{g_k \\tau_n}$代入延迟公式，得到：\n$$\n\\tau_{k} = \\frac{L_{k}}{\\frac{\\eta d_{k}}{g_{k} \\tau_{n}}} = \\frac{L_{k} g_{k} \\tau_{n}}{\\eta d_{k}}\n$$\n因此，总延迟$\\tau_{ij}$可以写为：\n$$\n\\tau_{ij} = \\frac{L_{1} g_{1} \\tau_{n}}{\\eta d_{1}} + \\frac{L_{2} g_{2} \\tau_{n}}{\\eta d_{2}}\n$$\n我们可以将常数项$\\frac{\\tau_{n}}{\\eta}$提取出来，以得到一个更简洁的计算表达式：\n$$\n\\tau_{ij} = \\frac{\\tau_{n}}{\\eta} \\left( \\frac{L_{1} g_{1}}{d_{1}} + \\frac{L_{2} g_{2}}{d_{2}} \\right)\n$$\n现在，我们代入所提供的数值。为确保量纲一致性，所有长度必须使用相同单位。我们将使用毫米（$\\mathrm{mm}$）。轴突内径以微米（$\\mu\\mathrm{m}$）为单位，因此我们使用关系式$1 \\,\\mu\\mathrm{m} = 10^{-3} \\,\\mathrm{mm}$将其转换为$\\mathrm{mm}$。\n\n给定的参数是：\n- $L_{1} = 40 \\,\\mathrm{mm}$\n- $d_{1} = 1.3 \\,\\mu \\mathrm{m} = 1.3 \\times 10^{-3} \\,\\mathrm{mm}$\n- $g_{1} = 0.62$\n- $L_{2} = 12 \\,\\mathrm{mm}$\n- $d_{2} = 0.9 \\,\\mu \\mathrm{m} = 0.9 \\times 10^{-3} \\,\\mathrm{mm}$\n- $g_{2} = 0.68$\n- $\\eta = 110$\n- $\\tau_{n} = 0.02 \\,\\mathrm{ms}$\n\n我们先计算括号内的项。注意每一项$\\frac{Lg}{d}$都是无量纲的（$\\mathrm{mm} / \\mathrm{mm}$）。\n$$\n\\frac{L_{1} g_{1}}{d_{1}} = \\frac{(40 \\,\\mathrm{mm}) \\times 0.62}{1.3 \\times 10^{-3} \\,\\mathrm{mm}} = \\frac{24.8}{1.3 \\times 10^{-3}} = \\frac{24800}{1.3} \\approx 19076.923\n$$\n$$\n\\frac{L_{2} g_{2}}{d_{2}} = \\frac{(12 \\,\\mathrm{mm}) \\times 0.68}{0.9 \\times 10^{-3} \\,\\mathrm{mm}} = \\frac{8.16}{0.9 \\times 10^{-3}} = \\frac{8160}{0.9} \\approx 9066.667\n$$\n现在，我们将这两个值相加：\n$$\n\\frac{L_{1} g_{1}}{d_{1}} + \\frac{L_{2} g_{2}}{d_{2}} = 19076.923... + 9066.667... = 28143.590...\n$$\n最后，我们乘以预因子$\\frac{\\tau_{n}}{\\eta}$：\n$$\n\\tau_{ij} = \\frac{0.02 \\,\\mathrm{ms}}{110} \\times (28143.590...)\n$$\n$$\n\\tau_{ij} \\approx (1.81818... \\times 10^{-4} \\,\\mathrm{ms}) \\times (28143.590...) \\approx 5.117016... \\,\\mathrm{ms}\n$$\n题目要求将最终答案四舍五入到四位有效数字。计算值为$5.117016... \\,\\mathrm{ms}$。第五位有效数字是$0$，所以我们向下舍入。\n\n总传导延迟为$\\tau_{ij} \\approx 5.117 \\,\\mathrm{ms}$。",
            "answer": "$$\n\\boxed{5.117}\n$$"
        },
        {
            "introduction": "从扩散磁共振成像（dMRI）和纤维束成像等技术中获得的原始数据，并不能直接作为连接权重的可靠估计。例如，原始的纤维束计数会受到追踪算法参数、纤维束长度和曲率等多种因素的系统性偏差影响。本练习旨在介绍如何校正这些偏差，将算法输出转化为更具生物学意义的网络权重，这对于构建精确的连接组模型至关重要。",
            "id": "3972555",
            "problem": "您将获得一个通过纤维束成像衍生的结构连接数据集，其中包含一组有限的感兴趣区域和一组有限的纤维束。在此类数据集-中，每条纤维束是轴突束的算法替代物，但已知原始纤维束计数会受到局部追踪参数、曲率和长度的影响而产生偏差。对于一对区域 $i,j$，一个具有物理可解释性的边权重是连接 $i$ 和 $j$ 的轴突总横截面积，记为 $A_{ij}$，单位为平方毫米 (mm$^2$)。每个体素包含测得的纤维体积（来自扩散建模），其定义为纤维体积分数 $f_v$ 乘以体素体积 $V_v$，记为 $b_v = f_v V_v$，单位为立方毫米 (mm$^3$)。每条纤维束 $k$ 穿过的路径在体素 $v$ 内部贡献了一段长度 $l_{vk}$，单位为毫米 (mm)。体素 $v$ 内的总纤维体积可以通过“体积等于横截面积乘以路径长度”这一原理，从纤维束近似得出，从而得到以下守恒定律\n$$\n\\sum_{k=1}^{K} w_k \\, l_{vk} \\approx b_v,\n$$\n其中 $w_k$ 是分配给纤维束 $k$ 的有效横截面积，单位为 mm$^2$，$K$ 是纤维束的总数，$v$ 是体素的索引。对于一条边 $(i,j)$，其基于物理原理的权重是\n$$\nA_{ij} \\equiv \\sum_{k \\in \\mathcal{E}_{ij}} w_k,\n$$\n其中 $\\mathcal{E}_{ij}$ 是连接区域 $i$ 和 $j$ 的纤维束集合。\n\n从以下基本依据出发：\n- 纤维体积的定义为横截面积乘以长度，即对每个分段，体积等于面积 $\\times$ 长度，且体素纤维体积 $b_v$ 是该体素内部所有贡献的总和。\n- 算法生成的纤维束计数 $S_{ij}$ 是一个代理变量，需要通过校准才能与物理面积相关联。\n- 最小二乘拟合原理，即选择模型参数以最小化建模量与测量量之间的平方差之和，并通过非负约束来保证面积的物理合理性。\n\n您的任务是：\n1. 使用每条纤维束的恒定横截面积 $a_0$ 来定义朴素边权重，得到 $A_{ij}^{\\text{naive}} = a_0 S_{ij}$。此方法仅使用纤维束计数 $S_{ij}$ 和一个校准常数 $a_0$，单位为 mm$^2$/纤维束。\n2. 通过寻找一个统一应用于所有纤维束的单一全局缩放因子 $\\alpha \\ge 0$ 来实现一个简化的 Spherical-deconvolution Informed Filtering of Tractograms (SIFT) 方法（首次正式定义为“Spherical-deconvolution Informed Filtering of Tractograms (SIFT)”），使得建模的体素纤维体积\n$$\n\\hat{b}_v(\\alpha) = \\sum_{k=1}^{K} (\\alpha a_0) l_{vk}\n$$\n最小化总平方误差 $\\sum_v \\left(\\hat{b}_v(\\alpha) - b_v\\right)^2$。使用最小二乘最优性条件推导 $\\alpha$ 的公式，并强制要求 $\\alpha \\ge 0$。然后，经 SIFT 校正的边权重为 $A_{ij}^{\\text{SIFT}} = \\alpha a_0 S_{ij}$。单位必须是 mm$^2$。\n3. 通过求解非负最小二乘问题来实现一个简化的 Convex Optimization Modeling for Microstructure Informed Tractography (COMMIT) 方法（首次正式定义为“Convex Optimization Modeling for Microstructure Informed Tractography (COMMIT)”）：\n$$\n\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{b} \\right\\|_2^2,\n$$\n其中 $\\mathbf{A} \\in \\mathbb{R}^{V \\times K}$ 的元素为 $A_{vk} = l_{vk}$，$\\mathbf{w} \\in \\mathbb{R}^K$ 包含纤维束面积 $w_k$（单位 mm$^2$），$\\mathbf{b} \\in \\mathbb{R}^{V}$ 包含测量的体素纤维体积 $b_v$（单位 mm$^3$）。对于边 $(i,j)$，经 COMMIT 校正的边权重为 $A_{ij}^{\\text{COMMIT}} = \\sum_{k \\in \\mathcal{E}_{ij}} w_k$。单位必须是 mm$^2$。\n\n本问题不涉及角度单位。所有长度必须以毫米 (mm) 为单位，体积以立方毫米 (mm$^3$) 为单位，面积以平方毫米 (mm$^2$) 为单位。您的程序必须为每个测试用例计算三元组 $\\left[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}\\right]$，并将其作为浮点数以 mm$^2$ 为单位打印出来，每个数值都四舍五入到恰好六位小数。\n\n测试套件：\n对于每个测试用例，您将获得设计矩阵 $\\mathbf{A}$（体素-纤维束长度段，单位 mm）、测量的体素纤维体积 $\\mathbf{b}$（单位 mm$^3$）、纤维束到边的分配关系、要报告的目标边 $(i,j)$ 以及常数 $a_0$（单位 mm$^2$/纤维束）。纤维束计数 $S_{ij}$ 是分配给目标边 $(i,j)$ 的纤维束数量。\n\n- 测试用例 1 (单一边，两个体素)：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.2  0.5  0.3 \\\\ 0.8  1.0  0.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.24 \\\\ 0.16 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束到边的映射：所有 3 条纤维束都属于边 (1,2)，\n  - 报告边 (1,2)，\n  - $a_0 = 0.05$ (mm$^2$/纤维束)。\n- 测试用例 2a (共享纤维束图，边 (1,2))：\n  - $\\mathbf{A} = \\begin{bmatrix} 0.9  0.7  0.0  0.1 \\\\ 0.4  0.2  0.6  0.5 \\\\ 0.0  0.1  0.8  1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.25 \\\\ 0.225 \\\\ 0.30 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束到边的映射：前 2 条纤维束属于边 (1,2)，后 2 条属于边 (2,3)，\n  - 报告边 (1,2)，\n  - $a_0 = 0.04$ (mm$^2$/纤维束)。\n- 测试用例 2b (共享纤维束图，边 (2,3))：\n  - 与测试用例 2a 相同的 $\\mathbf{A}$ 和 $\\mathbf{b}$，\n  - 纤维束到边的映射：前 2 条纤维束属于边 (1,2)，后 2 条属于边 (2,3)，\n  - 报告边 (2,3)，\n  - $a_0 = 0.04$ (mm$^2$/纤维束)。\n- 测试用例 3 (零纤维体积边界)：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.0  1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.0 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束到边的映射：所有 2 条纤维束都属于边 (3,4)，\n  - 报告边 (3,4)，\n  - $a_0 = 0.03$ (mm$^2$/纤维束)。\n- 测试用例 4 (超定的单纤维束拟合)：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.0 \\\\ 1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.3 \\\\ 0.1 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束到边的映射：单条纤维束属于边 (4,5)，\n  - 报告边 (4,5)，\n  - $a_0 = 0.02$ (mm$^2$/纤维束)。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献其三元组 $\\left[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}\\right]$（单位 mm$^2$），并四舍五入到六位小数。例如，程序必须打印一个包含五个内部列表（每个列表格式为 $[x_1,x_2,x_3]$）的列表的字符串表示，从而产生类似 $[[t_{1,1},t_{1,2},t_{1,3}],[t_{2,1},t_{2,2},t_{2,3}],\\ldots]$ 的输出。",
            "solution": "问题陈述具有科学依据、良构且客观。它提出了一个连接组学领域的有效计算问题，特别是关于如何校准源自扩散MRI纤维束成像的结构连接权重。所提供的数据和数学公式是自洽且一致的。\n\n任务是使用三种不同的方法计算大脑结构网络的边权重：一种基于朴素纤维束计数的方法，一种简化的全局滤波方法 (SIFT)，以及一种更复杂的、针对特定纤维束的优化方法 (COMMIT)。对于每种方法，我们将推导其公式，然后将其应用于提供的测试用例。所有数学实体，包括变量、数字和运算符，都按要求使用 LaTeX 格式。\n\n### 1. 朴素边权重 ($A_{ij}^{\\text{naive}}$)\n\n该模型是估计连接强度最直接但生物物理学上最简单的方法。它假设每条算法生成的纤维束对连接两个区域的总轴突横截面积的贡献是相同且恒定的。\n\n连接区域 $i$ 和区域 $j$ 之间的朴素边权重 $A_{ij}^{\\text{naive}}$ 定义为连接这些区域的纤维束数量 $S_{ij}$ 与一个预定义的、每条纤维束的恒定横截面积 $a_0$ 的乘积。$a_0$ 的单位是 mm$^2$/纤维束，$S_{ij}$ 是一个无量纲的计数，因此得到的权重 $A_{ij}^{\\text{naive}}$ 的单位正确地为 mm$^2$。\n\n公式如下：\n$$\nA_{ij}^{\\text{naive}} = a_0 S_{ij}\n$$\n其中 $S_{ij} = |\\mathcal{E}_{ij}|$ 是连接区域 $i$ 和 $j$ 的纤维束集合的基数。\n\n### 2. SIFT校正的边权重 ($A_{ij}^{\\text{SIFT}}$)\n\nSpherical-deconvolution Informed Filtering of Tractograms (SIFT) 方法旨在通过将纤维束与潜在的生物物理测量值相关联来改进朴素模型。其核心思想是强制要求穿过每个体素的纤维束总体积与该体素内测得的纤维体积保持一致。\n\n在这个简化版本中，我们寻找一个单一的全局缩放因子 $\\alpha \\ge 0$，该因子统一应用于所有纤维束的横截面积。体素 $v$ 中建模的纤维体积 $\\hat{b}_v(\\alpha)$ 是该体素内所有纤维束段的体积之和：\n$$\n\\hat{b}_v(\\alpha) = \\sum_{k=1}^{K} w_k l_{vk} = \\sum_{k=1}^{K} (\\alpha a_0) l_{vk} = \\alpha a_0 \\sum_{k=1}^{K} l_{vk}\n$$\n这里，$w_k = \\alpha a_0$ 是每条纤维束 $k$ 的统一缩放面积，$l_{vk}$ 是纤维束 $k$ 在体素 $v$ 中的长度。\n\n我们通过最小化所有 $V$ 个体素上建模的体素体积 $\\hat{b}_v(\\alpha)$ 与测量的体素纤维体积 $b_v$ 之间的总平方误差 $E(\\alpha)$ 来确定最优的 $\\alpha$：\n$$\nE(\\alpha) = \\sum_{v=1}^{V} \\left(\\hat{b}_v(\\alpha) - b_v\\right)^2 = \\sum_{v=1}^{V} \\left( \\alpha a_0 \\sum_{k=1}^{K} l_{vk} - b_v \\right)^2\n$$\n为了找到最小值，我们计算 $E(\\alpha)$ 关于 $\\alpha$ 的导数并将其设为零：\n$$\n\\frac{dE}{d\\alpha} = \\sum_{v=1}^{V} 2 \\left( \\alpha a_0 \\sum_{k=1}^{K} l_{vk} - b_v \\right) \\left( a_0 \\sum_{k=1}^{K} l_{vk} \\right) = 0\n$$\n假设 $a_0 \\neq 0$，我们可以简化为：\n$$\n\\sum_{v=1}^{V} \\left( \\alpha a_0 \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2 - b_v \\sum_{k=1}^{K} l_{vk} \\right) = 0\n$$\n求解 $\\alpha$：\n$$\n\\alpha a_0 \\sum_{v=1}^{V} \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2 = \\sum_{v=1}^{V} b_v \\left(\\sum_{k=1}^{K} l_{vk}\\right)\n$$\n$$\n\\alpha = \\frac{\\sum_{v=1}^{V} b_v \\left(\\sum_{k=1}^{K} l_{vk}\\right)}{a_0 \\sum_{v=1}^{V} \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2}\n$$\n在矩阵表示法中，其中 $\\mathbf{A}$ 是具有元素 $l_{vk}$ 的 $V \\times K$ 矩阵，$\\mathbf{b}$ 是测量体积的 $V \\times 1$ 向量，$\\mathbf{1}$ 是一个 $K \\times 1$ 的全1向量，令 $\\mathbf{c} = \\mathbf{A}\\mathbf{1}$。向量 $\\mathbf{c}$ 的元素为 $c_v = \\sum_{k=1}^{K} l_{vk}$。$\\alpha$ 的公式变为：\n$$\n\\alpha = \\frac{\\mathbf{b}^T \\mathbf{c}}{a_0 (\\mathbf{c}^T \\mathbf{c})} = \\frac{\\mathbf{b}^T (\\mathbf{A}\\mathbf{1})}{a_0 \\|\\mathbf{A}\\mathbf{1}\\|_2^2}\n$$\n为了强制执行 $\\alpha \\ge 0$ 的物理约束，我们取该值与零之间的最大值。\n$$\n\\alpha = \\max\\left(0, \\frac{\\mathbf{b}^T (\\mathbf{A}\\mathbf{1})}{a_0 \\|\\mathbf{A}\\mathbf{1}\\|_2^2}\\right)\n$$\n然后，使用这个全局因子 $\\alpha$ 计算 SIFT 校正的边权重：\n$$\nA_{ij}^{\\text{SIFT}} = \\alpha a_0 S_{ij}\n$$\n\n### 3. COMMIT校正的边权重 ($A_{ij}^{\\text{COMMIT}}$)\n\nConvex Optimization Modeling for Microstructure Informed Tractography (COMMIT) 框架提供了一个更强大、更灵活的模型。它不是应用单一的全局校正因子，而是为每条纤维束分配一个单独的横截面积 $w_k \\ge 0$。这使得模型能够考虑到不同的纤维束可能具有不同的密度和属性。\n\n该模型假设体素中测得的纤维体积 $b_v$ 是穿过该体素的每条纤维束贡献的线性总和：\n$$\n\\sum_{k=1}^{K} w_k l_{vk} \\approx b_v\n$$\n对于所有体素，这可以同时写成矩阵方程 $\\mathbf{A}\\mathbf{w} \\approx \\mathbf{b}$，其中 $\\mathbf{A}$ 是分段长度 $l_{vk}$ 的矩阵，$\\mathbf{w}$ 是未知的纤维束面积 $w_k$ 的向量，$\\mathbf{b}$ 是测量的体素体积 $b_v$ 的向量。\n\n未知的权重 $\\mathbf{w}$ 是通过求解非负最小二乘 (NNLS) 问题找到的，该问题在横截面积不能为负的物理约束下，最小化平方误差：\n$$\n\\min_{\\mathbf{w} \\ge 0} \\|\\mathbf{A}\\mathbf{w} - \\mathbf{b}\\|_2^2\n$$\n这是一个标准的凸优化问题，可以通过数值方法求解。一旦找到最优向量 $\\mathbf{w}^* = [w_1^*, w_2^*, \\dots, w_K^*]^T$，连接 $(i,j)$ 的 COMMIT 校正边权重就是构成该边的所有纤维束的面积之和：\n$$\nA_{ij}^{\\text{COMMIT}} = \\sum_{k \\in \\mathcal{E}_{ij}} w_k^*\n$$\n这种方法优于 SIFT，因为它可以通过赋予 $w_k^*=0$ 的权重来“修剪”伪迹纤维束，并且即使纤维束属于同一条边，也可以对其进行差异化加权，从而反映更复杂的潜在生物学特性。\n\n每个测试用例的流程如下：\n1.  确定纤维束数量 $S_{ij}$ 和对应于目标边 $(i, j)$ 的索引。\n2.  使用给定的 $a_0$ 和 $S_{ij}$ 计算 $A_{ij}^{\\text{naive}}$。\n3.  计算 SIFT 模型的全局标量 $\\alpha$，然后计算 $A_{ij}^{\\text{SIFT}}$。\n4.  求解 NNLS 问题得到向量 $\\mathbf{w}$，并对适当的元素求和以找到 $A_{ij}^{\\text{COMMIT}}$。\n5.  按要求格式化生成的三元组 $[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}]$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Computes and prints structural connectivity edge weights using Naive, SIFT, and COMMIT models.\n    \"\"\"\n    test_cases = [\n        # Test Case 1: single edge, two voxels\n        {\n            \"A\": np.array([[1.2, 0.5, 0.3], [0.8, 1.0, 0.0]]),\n            \"b\": np.array([0.24, 0.16]),\n            \"edge_indices\": [0, 1, 2],  # All 3 streamlines for edge (1,2)\n            \"a0\": 0.05\n        },\n        # Test Case 2a: shared tractogram, edge (1,2)\n        {\n            \"A\": np.array([[0.9, 0.7, 0.0, 0.1], \n                           [0.4, 0.2, 0.6, 0.5], \n                           [0.0, 0.1, 0.8, 1.0]]),\n            \"b\": np.array([0.25, 0.225, 0.30]),\n            \"edge_indices\": [0, 1],  # First 2 streamlines for edge (1,2)\n            \"a0\": 0.04\n        },\n        # Test Case 2b: shared tractogram, edge (2,3)\n        {\n            \"A\": np.array([[0.9, 0.7, 0.0, 0.1],\n                           [0.4, 0.2, 0.6, 0.5],\n                           [0.0, 0.1, 0.8, 1.0]]),\n            \"b\": np.array([0.25, 0.225, 0.30]),\n            \"edge_indices\": [2, 3],  # Last 2 streamlines for edge (2,3)\n            \"a0\": 0.04\n        },\n        # Test Case 3: zero fiber volume boundary\n        {\n            \"A\": np.array([[1.0, 1.0]]),\n            \"b\": np.array([0.0]),\n            \"edge_indices\": [0, 1],  # Both 2 streamlines for edge (3,4)\n            \"a0\": 0.03\n        },\n        # Test Case 4: overdetermined single-streamline fit\n        {\n            \"A\": np.array([[1.0], [1.0]]),\n            \"b\": np.array([0.3, 0.1]),\n            \"edge_indices\": [0],  # The single streamline for edge (4,5)\n            \"a0\": 0.02\n        }\n    ]\n\n    all_results_formatted = []\n\n    for case in test_cases:\n        A = case[\"A\"]\n        b = case[\"b\"]\n        edge_indices = case[\"edge_indices\"]\n        a0 = case[\"a0\"]\n\n        # Number of streamlines for the target edge\n        S_ij = len(edge_indices)\n\n        # 1. Naive model\n        A_naive = a0 * S_ij\n\n        # 2. SIFT model\n        # The vector c has elements c_v = sum_k l_vk\n        # This is equivalent to summing each row of A, or A @ 1_K\n        c = A.sum(axis=1)\n        \n        numerator = b.dot(c)\n        denominator_part = c.dot(c)\n        \n        alpha = 0.0\n        # Avoid division by zero if all streamline lengths are zero\n        if denominator_part > 1e-12:\n            alpha = numerator / (a0 * denominator_part)\n        \n        # Enforce non-negativity constraint\n        alpha = max(0.0, alpha)\n        \n        A_sift = alpha * a0 * S_ij\n\n        # 3. COMMIT model\n        # Solve the non-negative least squares problem: min ||Aw - b||^2 s.t. w >= 0\n        w, _ = nnls(A, b)\n        \n        # Sum the weights of the streamlines belonging to the target edge\n        A_commit = w[edge_indices].sum()\n\n        results_tuple = (A_naive, A_sift, A_commit)\n        all_results_formatted.append(f\"[{','.join(f'{x:.6f}' for x in results_tuple)}]\")\n    \n    # Print final output in the exact specified format\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "获得一个加权的结构连接组矩阵后，我们如何利用它来揭示大脑的动态特性？静态的网络结构如何约束信息在全脑范围内的流动？本练习将通过分析图拉普拉斯算子，引导您探索结构与功能之间的深刻联系。您将学习如何识别网络中的自然“扩散模式”及其特征时间尺度，从而将静态的解剖结构与大脑的动态行为联系起来。",
            "id": "3972576",
            "problem": "给定代表 $n$ 个大脑区域的结构连接网络，其表示为对称非负邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$。度矩阵定义为 $D \\in \\mathbb{R}^{n \\times n}$，其对角线元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$，组合图拉普拉斯矩阵为 $L = D - A$。网络上的线性扩散过程由常微分方程 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 建模，其中 $x(t) \\in \\mathbb{R}^{n}$ 是在时间 $t$ 各区域的活动状态，$\\kappa > 0$ 是一个扩散系数，单位为 $\\mathrm{s}^{-1}$。对于对称矩阵 $L$，存在一个标准正交特征基 $\\{v_i\\}_{i=1}^{n}$，其对应的非负特征值为 $\\{\\lambda_i\\}_{i=1}^{n}$，满足 $L v_i = \\lambda_i v_i$。沿特征向量的模态解以 $e^{-\\kappa \\lambda_i t}$ 的形式衰减，因此 $\\lambda_i$ 的大小决定了扩散时间尺度。\n\n基于这些定义，对于每个提供的测试用例：\n- 计算 $L = D - A$。\n- 计算所有特征值 $\\{\\lambda_i\\}_{i=1}^{n}$ 和相关的标准正交特征向量 $\\{v_i\\}_{i=1}^{n}$。\n- 设 $\\epsilon = 10^{-9}$ 为数值公差。将连通分量的数量 $C$ 定义为满足 $|\\lambda_i| \\le \\epsilon$ 的特征值 $\\lambda_i$ 的个数。\n- 将 $\\lambda_{+}$ 定义为最小的严格正特征值，即满足 $\\lambda_i > \\epsilon$ 的最小 $\\lambda_i$。如果不存在这样的特征值，则将 $\\lambda_{+}$ 视为 $0$。\n- 定义最慢的非平凡扩散时间常数 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$，并以秒为单位表示。\n- 给定初始条件 $x_0 \\in \\mathbb{R}^{n}$，计算最慢非平凡模式中的能量分数 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$，其中 $v_{+}$ 是与 $\\lambda_{+}$ 相关联的特征向量。如果 $\\lambda_{+} = 0$，则设 $f_{+} = 0$。\n\n您的程序必须将此过程应用于以下测试套件，并生成指定的输出。\n\n测试套件：\n- 案例 $1$（连接链）：\n  - $n = 4$，\n  - $$A_1 = \\begin{bmatrix}\n  0  0.8  0  0 \\\\\n  0.8  0  0.5  0 \\\\\n  0  0.5  0  0.6 \\\\\n  0  0  0.6  0\n  \\end{bmatrix},$$\n  - $\\kappa_1 = 0.2 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,1} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 案例 $２$（断开连接：一对节点加一个孤立节点）：\n  - $n = 3$，\n  - $$A_2 = \\begin{bmatrix}\n  0  1.0  0 \\\\\n  1.0  0  0 \\\\\n  0  0  0\n  \\end{bmatrix},$$\n  - $\\kappa_2 = 0.3 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,2} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n- 案例 $3$（两个弱耦合的社群）：\n  - $n = 6$，\n  - $$A_3 = \\begin{bmatrix}\n  0  1  1  0  0  0 \\\\\n  1  0  1  0  0  0 \\\\\n  1  1  0  0.1  0  0 \\\\\n  0  0  0.1  0  1  1 \\\\\n  0  0  0  1  0  1 \\\\\n  0  0  0  1  1  0\n  \\end{bmatrix},$$\n  - $\\kappa_3 = 0.1 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,3} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n\n所需输出：\n- 对于每个案例，计算并返回列表 $[C, \\lambda_{+}, \\tau_{+}, f_{+}]$。\n- 以秒为单位表示 $\\tau_{+}$。\n- 将所有浮点数表示为四舍五入到 $6$ 位小数的十进制值。\n- 您的程序应生成单行输出，其中包含所有案例的结果，格式为一个逗号分隔的列表，并用方括号括起来，每个案例的结果本身也是一个列表。例如，输出格式必须为 $[[r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}],[r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}],[r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}]]$ 的形式。",
            "solution": "用户提供了一个需要使用谱图论的概念和扩散过程建模来分析结构性脑网络的问题。我将首先验证问题陈述，然后提供一个全面的解决方案。\n\n### 问题验证\n\n**步骤 1：提取已知信息**\n\n问题提供了以下定义和数据：\n-   一个对称非负的邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$，代表 $n$ 个区域的结构连接。\n-   度矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 是对角矩阵，其对角线元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。\n-   组合图拉普拉斯矩阵为 $L = D - A$。\n-   线性扩散过程由 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 建模，其中 $\\kappa > 0$ 是扩散系数，单位为 $\\mathrm{s}^{-1}$。\n-   $L$ 是对称的，因此它有一个标准正交特征基 $\\{v_i\\}_{i=1}^{n}$，其对应的实数非负特征值为 $\\{\\lambda_i\\}_{i=1}^{n}$，满足 $L v_i = \\lambda_i v_i$。\n-   用于特征值比较的数值公差：$\\epsilon = 10^{-9}$。\n-   连通分量的数量 $C$：满足 $|\\lambda_i| \\le \\epsilon$ 的特征值 $\\lambda_i$ 的个数。\n-   最小的严格正特征值 $\\lambda_{+}$：满足 $\\lambda_i > \\epsilon$ 的最小 $\\lambda_i$。如果不存在，则 $\\lambda_{+} = 0$。\n-   最慢的非平凡扩散时间常数 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$。\n-   最慢非平凡模式中的能量分数 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$，其中 $v_{+}$ 是与 $\\lambda_{+}$ 相关联的特征向量。如果 $\\lambda_{+} = 0$，则 $f_{+} = 0$。\n\n测试套件：\n1.  **案例 1（连接链）：**\n    -   $n = 4$\n    -   $A_1 = \\begin{bmatrix} 0  0.8  0  0 \\\\ 0.8  0  0.5  0 \\\\ 0  0.5  0  0.6 \\\\ 0  0  0.6  0 \\end{bmatrix}$\n    -   $\\kappa_1 = 0.2 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,1} = \\begin{bmatrix} 1, 0, 0, 0 \\end{bmatrix}^T$\n2.  **案例 2（断开连接）：**\n    -   $n = 3$\n    -   $A_2 = \\begin{bmatrix} 0  1.0  0 \\\\ 1.0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n    -   $\\kappa_2 = 0.3 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,2} = \\begin{bmatrix} 0, 0, 1 \\end{bmatrix}^T$\n3.  **案例 3（弱耦合社群）：**\n    -   $n = 6$\n    -   $A_3 = \\begin{bmatrix} 0  1  1  0  0  0 \\\\ 1  0  1  0  0  0 \\\\ 1  1  0  0.1  0  0 \\\\ 0  0  0.1  0  1  1 \\\\ 0  0  0  1  0  1 \\\\ 0  0  0  1  1  0 \\end{bmatrix}$\n    -   $\\kappa_3 = 0.1 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,3} = \\begin{bmatrix} 0, 0, 1, 0, 0, 0 \\end{bmatrix}^T$\n\n所需输出：对于每个案例，一个列表 $[C, \\lambda_{+}, \\tau_{+}, f_{+}]$，其中浮点数四舍五入到 $6$ 位小数，格式化为单行输出。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n该问题经过了严格的验证。\n-   **科学基础**：该问题基于谱图论的基本原理及其在网络扩散中的应用，这是计算神经科学和物理学中一个标准且成熟的课题。所有定义（度矩阵、图拉普拉斯矩阵、特征值/特征向量）都是标准的。扩散方程 $\\frac{d x}{d t} = -\\kappa L x$ 是图上热/质量传递的典型模型。\n-   **适定性**：该问题在数学上是适定的。给定的邻接矩阵是对称的，这保证了所得的拉普拉斯矩阵 $L$ 也是对称和半正定的。这确保了所有特征值都是实数且非负，并且存在一个完备的标准正交特征向量基。计算 $L$、其特征系统及派生量的任务都是明确定义的数学运算。问题定义中明确处理了边缘情况，例如不存在严格正特征值的情况。\n-   **客观性**：问题以精确、客观的数学语言陈述。没有主观或含糊不清的术语。\n-   **完整性和一致性**：为每个案例提供了所有必要的数据（$A$, $\\kappa$, $x_0$）和定义（$\\epsilon$, $C$, $\\lambda_{+}$, 等）。矩阵和向量的维度是一致的。$\\kappa$ 的单位与时间常数 $\\tau_{+}$ 的计算相符。\n-   **现实性和可行性**：所提供的矩阵是真实世界连接性的合理简化表示。所需的计算是标准的，可以使用常见的数值库来执行。\n-   **无其他缺陷**：该问题并非微不足道、隐喻性或不可证伪。它是一个与连接组学相关的直接计算任务。\n\n**步骤 3：结论与行动**\n\n问题有效。我将继续提供完整的解决方案。\n\n### 解决方案\n\n该问题要求基于从给定结构连接矩阵派生的图拉普拉斯矩阵的谱特性进行一系列计算。所概述的程序是网络神经科学中的一种标准方法，用于理解静态网络结构的动态含义。\n\n**基于原理的设计**\n\n对于每个测试案例，我们将执行以下一系列步骤，这些步骤基于线性代数和谱图论。\n\n1.  **构建图拉普拉斯矩阵 ($L$)**:\n    给定一个对称邻接矩阵 $A$，该结构网络是一个无向加权图。一个节点（区域）的强度是其总连接权重。这由度矩阵 $D$ 捕获，它是一个对角矩阵，其中每个对角线元素 $D_{ii}$ 是连接到节点 $i$ 的所有边的权重之和，即 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。图拉普拉斯矩阵 $L = D - A$ 是图论中的一个基本矩阵。其结构编码了节点的度（在对角线上）和邻接关系（在非对角线上）。对于任何向量 $x$，二次型 $x^T L x = \\sum_{i,j} A_{ij}(x_i - x_j)^2$ 衡量了信号 $x$ 在网络各条边上的变化。\n\n2.  **拉普拉斯矩阵的特征分解**:\n    由于 $L$ 是实对称矩阵，它可以被其特征向量构成的正交矩阵对角化，并且其特征值 $\\{\\lambda_i\\}$ 都是实数。此外，$L$ 是半正定的，意味着对于所有的 $i$，都有 $\\lambda_i \\ge 0$。特征值的集合（图的谱）揭示了关于图结构的关键信息。特征向量 $\\{v_i\\}$ 构成了 $\\mathbb{R}^n$ 的一个标准正交基。我们将使用专为对称矩阵设计的标准数值算法来计算这些特征值和特征向量。特征值将按非递减顺序排序：$0 \\le \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$。\n\n3.  **确定连通分量的数量 ($C$)**:\n    谱图论的一个关键定理指出，特征值 $\\lambda=0$ 的重数等于图中连通分量的数量。在不连通的图上，扩散过程可以在每个分量内达到独立的平衡状态。在数值上，我们计算小于或等于一个小的公差 $\\epsilon$ 的特征值 $\\lambda_i$ 的数量，即 $C = |\\{i : |\\lambda_i| \\le \\epsilon\\}|$。\n\n4.  **识别最慢的非平凡模式 ($\\lambda_{+}$, $v_{+}$) 和时间尺度 ($\\tau_{+}$)**:\n    扩散方程 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 在初始条件 $x(0)=x_0$ 下的解可以表示为对各特征模式的求和：$x(t) = \\sum_{i=1}^n \\langle v_i, x_0 \\rangle e^{-\\kappa \\lambda_i t} v_i$。\n    -   对应于 $\\lambda_i = 0$ 的模式是静止的（$e^0=1$），代表了稳态解，其中每个连通分量内的活动是恒定的。\n    -   对应于 $\\lambda_i > 0$ 的模式是瞬态的，以由 $\\kappa \\lambda_i$ 决定的速率衰减。衰减最慢的*非平凡*模式是与最小的严格正特征值相关联的模式，我们将其表示为 $\\lambda_{+}$。这个特征值也被称为图的Fiedler值或代数连通度。较小的 $\\lambda_{+}$ 意味着向全网络平衡状态的收敛速度较慢，通常表明存在瓶颈或弱耦合的社群。\n    -   我们通过取集合 $\\{\\lambda_i | \\lambda_i > \\epsilon\\}$ 中的最小值来找到 $\\lambda_{+}$。对应的特征向量是 $v_{+}$。\n    -   这个最慢模式的特征时间常数是 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$。这个值以秒为单位表示，为网络中全局信息整合的时间尺度提供了一个定量度量。\n    -   如果不存在这样的 $\\lambda_i > \\epsilon$（即图中没有边），我们取 $\\lambda_{+} = 0$，并因此定义 $\\tau_{+} = 0$ 以处理奇点。\n\n5.  **计算初始状态的能量分数 ($f_{+}$) **:\n    初始条件 $x_0$ 可以投影到特征基上。$x_0$ 沿着给定特征向量 $v_i$ 的分量由内积 $\\langle v_i, x_0 \\rangle$ 给出。该投影的模平方 $|\\langle v_i, x_0 \\rangle|^2$ 代表了初始状态在该模式下的“能量”。总能量为 $\\|x_0\\|_2^2$。\n    -   因此，最慢非平凡模式中的能量分数为 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$。\n    -   这个值告诉我们特定的初始活动模式 $x_0$ 在多大程度上激发了网络的最慢动态模式。如果 $x_0$ 与 $v_{+}$ 正交，那么 $f_{+}=0$，并且该模式将不会出现在系统的时间演化中。如果 $\\lambda_{+} = 0$（意味着不存在非平凡模式），问题指定将 $f_{+}$ 设为 $0$。\n\n此程序将为三个测试案例中的每一个实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final results.\n    \"\"\"\n\n    # Numerical tolerance for eigenvalue zero-check\n    epsilon = 1e-9\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.array([\n                [0.0, 0.8, 0.0, 0.0],\n                [0.8, 0.0, 0.5, 0.0],\n                [0.0, 0.5, 0.0, 0.6],\n                [0.0, 0.0, 0.6, 0.0]\n            ]),\n            \"kappa\": 0.2,\n            \"x0\": np.array([1.0, 0.0, 0.0, 0.0])\n        },\n        {\n            \"A\": np.array([\n                [0.0, 1.0, 0.0],\n                [1.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ]),\n            \"kappa\": 0.3,\n            \"x0\": np.array([0.0, 0.0, 1.0])\n        },\n        {\n            \"A\": np.array([\n                [0.0, 1.0, 1.0, 0.0, 0.0, 0.0],\n                [1.0, 0.0, 1.0, 0.0, 0.0, 0.0],\n                [1.0, 1.0, 0.0, 0.1, 0.0, 0.0],\n                [0.0, 0.0, 0.1, 0.0, 1.0, 1.0],\n                [0.0, 0.0, 0.0, 1.0, 0.0, 1.0],\n                [0.0, 0.0, 0.0, 1.0, 1.0, 0.0]\n            ]),\n            \"kappa\": 0.1,\n            \"x0\": np.array([0.0, 0.0, 1.0, 0.0, 0.0, 0.0])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = compute_properties(case[\"A\"], case[\"kappa\"], case[\"x0\"], epsilon)\n        all_results.append(result)\n\n    # Format the final output string as per requirements.\n    output_parts = []\n    for res in all_results:\n        C, lambda_plus, tau_plus, f_plus = res\n        part = f\"[{C},{lambda_plus:.6f},{tau_plus:.6f},{f_plus:.6f}]\"\n        output_parts.append(part)\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    print(final_output_string)\n\ndef compute_properties(A, kappa, x0, epsilon):\n    \"\"\"\n    Computes the required network properties for a single case.\n    \n    Args:\n        A (np.ndarray): The adjacency matrix.\n        kappa (float): The diffusion coefficient.\n        x0 (np.ndarray): The initial condition vector.\n        epsilon (float): The numerical tolerance for zero.\n\n    Returns:\n        list: A list containing [C, lambda_plus, tau_plus, f_plus].\n    \"\"\"\n    # Step 1: Compute the graph Laplacian L = D - A.\n    D = np.diag(np.sum(A, axis=1))\n    L = D - A\n\n    # Step 2: Compute eigenvalues and eigenvectors.\n    # np.linalg.eigh is used for symmetric matrices. It returns sorted eigenvalues.\n    eigenvalues, eigenvectors = np.linalg.eigh(L)\n\n    # Step 3: Compute the number of connected components, C.\n    C = np.sum(np.abs(eigenvalues) = epsilon)\n\n    # Step 4: Find lambda_plus (smallest strictly positive eigenvalue) and v_plus.\n    lambda_plus = 0.0\n    v_plus = None\n    \n    # Find indices of all strictly positive eigenvalues\n    positive_eval_indices = np.where(eigenvalues > epsilon)[0]\n\n    if len(positive_eval_indices) > 0:\n        # The first one in the sorted list is the smallest positive one.\n        idx_plus = positive_eval_indices[0]\n        lambda_plus = eigenvalues[idx_plus]\n        v_plus = eigenvectors[:, idx_plus]\n\n    # Step 5: Compute the slowest nontrivial diffusion time constant tau_plus.\n    tau_plus = 0.0\n    if lambda_plus > 0:\n        tau_plus = 1.0 / (kappa * lambda_plus)\n\n    # Step 6: Compute the energy fraction in the slowest nontrivial mode, f_plus.\n    f_plus = 0.0\n    # The condition \"If lambda_plus = 0, set f_plus = 0\" is met if v_plus is None.\n    if v_plus is not None:\n        # Note: np.linalg.norm(x0)**2 is equivalent to np.dot(x0, x0)\n        norm_x0_sq = np.dot(x0, x0)\n        # Handle the case of a zero vector for x0, though not in test cases.\n        if norm_x0_sq > 0:\n            # Inner product\n            inner_product = np.dot(v_plus, x0)\n            f_plus = (inner_product**2) / norm_x0_sq\n            \n    return [C, lambda_plus, tau_plus, f_plus]\n\nsolve()\n```"
        }
    ]
}