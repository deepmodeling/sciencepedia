{
    "hands_on_practices": [
        {
            "introduction": "Many large-scale simulations aim for biophysical realism, which often involves modeling neurons as spatially extended structures governed by the cable equation. Solving this equation numerically introduces fundamental questions of stability and efficiency. This exercise  guides you through a stability analysis for an explicit numerical scheme, revealing the strict constraints on the simulation time step, a critical factor in the performance of time-driven simulators.",
            "id": "3992898",
            "problem": "Consider a large-scale neuron simulation that models dendritic segments as one-dimensional cylindrical cables of radius $a$ and length discretized into compartments of uniform size $h$. Each cable is characterized by a membrane resistance per unit area $R_{m}$, a membrane capacitance per unit area $C_{m}$, and an axial resistivity $R_{a}$. Assume the cable is passive, spatially homogeneous, and driven by no external current. Let $V(x,t)$ denote the transmembrane potential.\n\nStart from the standard electrical definitions for a cylindrical cable: the membrane capacitance per unit length $c_{m} = 2 \\pi a C_{m}$, the membrane conductance per unit length $g_{m} = \\frac{2 \\pi a}{R_{m}}$, and the axial resistance per unit length $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$. Using these, derive the partial differential equation governing $V(x,t)$ and identify the effective diffusion coefficient $D$ and linear decay rate $\\lambda$ in the form\n$$\n\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^{2} V}{\\partial x^{2}} - \\lambda V.\n$$\nThen, consider a spatial semi-discretization with second-order central differences on a uniform grid with spacing $h$ and an explicit forward Euler time integrator with time step $\\Delta t$. Perform a linear stability analysis of this semi-discrete system and derive the maximal time step $\\Delta t_{\\max}$ that guarantees stability of the explicit Euler scheme in terms of $D$, $\\lambda$, and $h$. Briefly explain the corresponding stability constraint for a backward (implicit) Euler scheme applied to the same semi-discrete system.\n\nFinally, evaluate $\\Delta t_{\\max}$ numerically for the following parameter set typical of biophysically realistic dendrites:\n- $R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$,\n- $C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$,\n- $R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$,\n- $a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$,\n- $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$.\n\nExpress the final $\\Delta t_{\\max}$ in seconds and round your numerical answer to four significant figures. The final answer must be a single real number.",
            "solution": "The problem asks for the derivation of the passive cable equation in a specific form, a linear stability analysis of its numerical solution, and a numerical evaluation of the stability limit.\n\nFirst, we derive the partial differential equation (PDE) for the transmembrane potential $V(x,t)$. Consider a small cylindrical segment of the cable of length $\\Delta x$. The axial current, $I_a(x,t)$, flows along the x-axis. By Ohm's law applied to the axial resistance, the voltage drop across the length $\\Delta x$ is related to the axial current and the axial resistance per unit length, $r_a$.\n$$\nV(x,t) - V(x+\\Delta x, t) = I_a(x,t) (r_a \\Delta x)\n$$\nDividing by $\\Delta x$ and taking the limit as $\\Delta x \\to 0$, we get:\n$$\n-\\frac{\\partial V}{\\partial x} = r_a I_a\n$$\nThe change in axial current along the segment must be balanced by the current flowing out through the membrane, which is the membrane current per unit length, $i_m$. By Kirchhoff's current law:\n$$\nI_a(x,t) - I_a(x+\\Delta x, t) = i_m \\Delta x\n$$\nDividing by $\\Delta x$ and taking the limit as $\\Delta x \\to 0$, we have:\n$$\n-\\frac{\\partial I_a}{\\partial x} = i_m\n$$\nThe membrane current $i_m$ has a capacitive component, $i_c = c_m \\frac{\\partial V}{\\partial t}$, and a resistive (or leak) component, $i_g = g_m V$, where $V$ is measured relative to the resting potential (assumed to be $0$). Thus, $i_m = c_m \\frac{\\partial V}{\\partial t} + g_m V$. Substituting this into the current conservation equation gives:\n$$\n-\\frac{\\partial I_a}{\\partial x} = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\nTo obtain a single equation for $V$, we differentiate the Ohm's law expression with respect to $x$:\n$$\n-\\frac{\\partial^2 V}{\\partial x^2} = r_a \\frac{\\partial I_a}{\\partial x}\n$$\nSubstituting the expression for $\\frac{\\partial I_a}{\\partial x}$ from the current conservation law:\n$$\n\\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} = -( -c_m \\frac{\\partial V}{\\partial t} - g_m V ) = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\nRearranging this equation to solve for $\\frac{\\partial V}{\\partial t}$:\n$$\nc_m \\frac{\\partial V}{\\partial t} = \\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} - g_m V\n$$\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{c_m r_a} \\frac{\\partial^2 V}{\\partial x^2} - \\frac{g_m}{c_m} V\n$$\nThis equation is in the requested form $\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^2 V}{\\partial x^2} - \\lambda V$. By comparison, we identify the diffusion coefficient $D$ and the linear decay rate $\\lambda$:\n$$\nD = \\frac{1}{c_m r_a} \\quad \\text{and} \\quad \\lambda = \\frac{g_m}{c_m}\n$$\nUsing the provided definitions $c_{m} = 2 \\pi a C_{m}$, $g_{m} = \\frac{2 \\pi a}{R_{m}}$, and $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$, we find:\n$$\nD = \\frac{1}{(2 \\pi a C_{m}) (\\frac{R_{a}}{\\pi a^{2}})} = \\frac{\\pi a^2}{2 \\pi a C_m R_a} = \\frac{a}{2 C_m R_a}\n$$\n$$\n\\lambda = \\frac{2 \\pi a / R_{m}}{2 \\pi a C_{m}} = \\frac{1}{R_m C_m}\n$$\n\nNext, we perform the linear stability analysis. The PDE is semi-discretized in space using a second-order central difference for the Laplacian, where $V_j(t) \\approx V(j h, t)$:\n$$\n\\frac{d V_j}{d t} = D \\left( \\frac{V_{j+1} - 2V_j + V_{j-1}}{h^2} \\right) - \\lambda V_j\n$$\nApplying the explicit forward Euler method with time step $\\Delta t$, where $V_j^n \\approx V_j(n \\Delta t)$:\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^n - 2V_j^n + V_{j-1}^n}{h^2} \\right) - \\lambda V_j^n\n$$\n$$\nV_j^{n+1} = V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n - 2V_j^n + V_{j-1}^n) - \\lambda \\Delta t V_j^n\n$$\n$$\nV_j^{n+1} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n + V_{j-1}^n)\n$$\nFor von Neumann stability analysis, we substitute the trial solution $V_j^n = G^n e^{i k j h}$, where $G$ is the amplification factor and $k$ is the wavenumber.\n$$\nG^{n+1} e^{i k j h} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)G^n e^{i k j h} + \\frac{D \\Delta t}{h^2}(G^n e^{i k (j+1) h} + G^n e^{i k (j-1) h})\n$$\nDividing by $G^n e^{i k j h}$:\n$$\nG = 1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t + \\frac{D \\Delta t}{h^2}(e^{i k h} + e^{-i k h})\n$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$:\n$$\nG = 1 - \\lambda \\Delta t - \\frac{2D \\Delta t}{h^2}(1 - \\cos(k h))\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG = 1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)\n$$\nFor stability, we require $|G| \\le 1$, which is equivalent to $-1 \\le G \\le 1$.\nThe term $\\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2(\\frac{k h}{2})$ is always non-negative, since all parameters are positive. Thus, $G \\le 1 - \\lambda \\Delta t < 1$, so the condition $G \\le 1$ is satisfied.\nThe critical condition is $G \\ge -1$:\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right) \\ge -1\n$$\nThis inequality must hold for all $k$. The most restrictive case (smallest $G$) occurs when $\\sin^2(\\frac{k h}{2})$ is maximal, i.e., $\\sin^2(\\frac{k h}{2}) = 1$.\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2} \\ge -1\n$$\n$$\n2 \\ge \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2} = \\Delta t \\left(\\lambda + \\frac{4D}{h^2}\\right)\n$$\nThis yields the stability condition on the time step:\n$$\n\\Delta t \\le \\frac{2}{\\lambda + \\frac{4D}{h^2}}\n$$\nThe maximal time step is therefore:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2h^2}{\\lambda h^2 + 4D}\n$$\n\nFor the implicit backward Euler scheme, the update rule is:\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^{n+1} - 2V_j^{n+1} + V_{j-1}^{n+1}}{h^2} \\right) - \\lambda V_j^{n+1}\n$$\nThe same von Neumann analysis yields an amplification factor of:\n$$\nG = \\frac{1}{1 + \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)}\n$$\nSince all parameters are positive, the denominator is always greater than or equal to $1$. Thus, $0 < G \\le 1$ for any $\\Delta t > 0$. The condition $|G| \\le 1$ is always satisfied, meaning the backward Euler scheme is unconditionally stable for this problem. The choice of $\\Delta t$ is constrained by accuracy considerations, not stability.\n\nFinally, we evaluate $\\Delta t_{\\max}$ for the explicit scheme using the given numerical values:\n$R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$, $C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$, $R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$, $a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$, and $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$.\n\nFirst, compute $\\lambda$ and $D$:\n$$\n\\lambda = \\frac{1}{R_m C_m} = \\frac{1}{(1.0) (1.0 \\times 10^{-2})} = 100 \\ \\mathrm{s}^{-1}\n$$\n$$\nD = \\frac{a}{2 C_m R_a} = \\frac{7.5 \\times 10^{-7}}{2 (1.0 \\times 10^{-2}) (1.5)} = \\frac{7.5 \\times 10^{-7}}{3.0 \\times 10^{-2}} = 2.5 \\times 10^{-5} \\ \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}\n$$\nNow, substitute these into the expression for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2}{100 + \\frac{4(2.5 \\times 10^{-5})}{(2.5 \\times 10^{-5})^2}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{100 + \\frac{1.0 \\times 10^{-4}}{6.25 \\times 10^{-10}}} = \\frac{2}{100 + 1.6 \\times 10^5} = \\frac{2}{160100}\n$$\n$$\n\\Delta t_{\\max} \\approx 1.249219 \\times 10^{-5} \\ \\mathrm{s}\n$$\nRounding to four significant figures, we get:\n$$\n\\Delta t_{\\max} = 1.249 \\times 10^{-5} \\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{1.249 \\times 10^{-5}}$$"
        },
        {
            "introduction": "An alternative to advancing time in fixed steps is the event-driven approach, where the simulation clock jumps between discrete spike events. This method can be highly efficient for networks with low and asynchronous firing rates. This practice problem  delves into the core logic of an event-driven simulation by tasking you with tracking the state of a single synapse, accounting for delays, refractoriness, and saturation, to compute the precise postsynaptic current.",
            "id": "3992942",
            "problem": "A conductance-based synapse model is used inside a large-scale, event-driven brain simulator to compute the postsynaptic current for a spike train. The postsynaptic membrane is voltage-clamped at a constant holding potential, so that the postsynaptic current is given by Ohmâ€™s law for conductance-based synapses, $I(t) = g(t)\\,(E_{\\text{syn}} - V_{\\text{hold}})$, where $g(t)$ is the synaptic conductance and $E_{\\text{syn}}$ is the synaptic reversal potential. The synaptic conductance obeys first-order relaxation dynamics between spike arrivals and undergoes instantaneous jumps at effective spike arrival times (spike time plus an axonal delay). Specifically, for $t$ not coinciding with an effective arrival time, $g(t)$ obeys the linear ordinary differential equation $\\tau \\,\\frac{dg}{dt} = -g$, with $\\tau$ the synaptic time constant. At an effective arrival time $t_k^{\\text{eff}}$, $g$ is updated as $g(t_k^{\\text{eff}+}) = \\min\\!\\big(g(t_k^{\\text{eff}-}) + \\Delta g,\\; g_{\\text{sat}}\\big)$, where $\\Delta g$ is the instantaneous conductance increment per effective spike and $g_{\\text{sat}}$ is a hard saturation limit. Absolute refractoriness is enforced at the synapse: any spike arrival that occurs within a window of duration $t_{\\text{abs}}$ after the most recent effective arrival is ignored (i.e., produces no jump). The axonal delay $d$ shifts each presynaptic spike time $t_k$ to its putative arrival time $t_k + d$.\n\nYou are given the following parameters and spike times for a single synapse onto a voltage-clamped neuron:\n- Synaptic time constant $\\tau = 5\\,\\mathrm{ms}$.\n- Conductance increment $\\Delta g = 1.2\\,\\mathrm{nS}$.\n- Saturation level $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$.\n- Absolute refractory window $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$.\n- Axonal delay $d = 1.5\\,\\mathrm{ms}$.\n- Presynaptic spike times $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$.\n- Reversal potential $E_{\\text{syn}} = 0\\,\\mathrm{mV}$.\n- Holding potential $V_{\\text{hold}} = -65\\,\\mathrm{mV}$.\n- Initial conductance $g(0)=0\\,\\mathrm{nS}$.\n\nCompute the postsynaptic current $I(t^\\ast)$ at time $t^\\ast = 10.0\\,\\mathrm{ms}$ produced by this spike train under the specified dynamics, including superposition with the axonal delay, absolute refractoriness, and conductance saturation. Express your final answer in nanoamperes and round your answer to four significant figures. Assume standard International System of Units (SI) conventions for unit conversions and report a positive value for inward current when $E_{\\text{syn}} - V_{\\text{hold}} > 0$.",
            "solution": "The problem requires the computation of the postsynaptic current $I(t^\\ast)$ at a specific time $t^\\ast = 10.0\\,\\mathrm{ms}$ for a conductance-based synapse model. The model incorporates several dynamic features: exponential decay of conductance between spikes, instantaneous conductance jumps at spike arrivals, an axonal delay, an absolute refractory period, and a saturation limit. First, the validity of the problem statement is confirmed. All parameters are provided, the model is physically and mathematically well-defined, and the units are consistent. The problem is scientifically grounded, well-posed, objective, and complete. Therefore, a solution can be derived.\n\nThe postsynaptic current $I(t)$ is given by $I(t) = g(t)(E_{\\text{syn}} - V_{\\text{hold}})$, where $g(t)$ is the time-varying synaptic conductance. We need to determine the value of $g(t)$ at $t^\\ast = 10.0\\,\\mathrm{ms}$.\n\nThe dynamics of $g(t)$ are governed by two rules:\n$1$. Between effective spike arrivals, the conductance decays according to the differential equation $\\tau \\frac{dg}{dt} = -g$. For an interval starting at $t_0$ with conductance $g(t_0)$, the solution is $g(t) = g(t_0) \\exp\\left(-\\frac{t - t_0}{\\tau}\\right)$.\n$2$. At an effective spike arrival time $t_k^{\\text{eff}}$, the conductance is updated as $g(t_k^{\\text{eff}+}) = \\min\\left(g(t_k^{\\text{eff}-}) + \\Delta g, g_{\\text{sat}}\\right)$.\n\nThe effective arrival time $t_k^{\\text{eff}}$ for a presynaptic spike at $t_k$ is $t_k^{\\text{eff}} = t_k + d$, provided the spike is not refractory. A spike is refractory and thus ignored if its putative arrival time $t_k + d$ falls within the absolute refractory window $t_{\\text{abs}}$ of the *preceding effective spike*. If the last effective spike was at $t_{\\text{prev}}^{\\text{eff}}$, the new spike is refractory if $t_k + d < t_{\\text{prev}}^{\\text{eff}} + t_{\\text{abs}}$.\n\nWe are given the following parameters:\n- Synaptic time constant $\\tau = 5\\,\\mathrm{ms}$.\n- Conductance increment $\\Delta g = 1.2\\,\\mathrm{nS}$.\n- Saturation level $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$.\n- Absolute refractory window $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$.\n- Axonal delay $d = 1.5\\,\\mathrm{ms}$.\n- Presynaptic spike times $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$.\n- Reversal potential $E_{\\text{syn}} = 0\\,\\mathrm{mV}$.\n- Holding potential $V_{\\text{hold}} = -65\\,\\mathrm{mV}$.\n- Initial conductance $g(0) = 0\\,\\mathrm{nS}$.\n\nFirst, we determine the sequence of effective spike arrival times. We will maintain a variable, $t_{\\text{last\\_eff}}$, for the time of the most recent effective arrival, initialized to $-\\infty$.\n\nSpike $1$: $t_1 = 0\\,\\mathrm{ms}$.\nPutative arrival time: $t_1^{\\text{putative}} = 0 + d = 1.5\\,\\mathrm{ms}$.\nThis is the first spike, so it cannot be refractory. It is an effective spike.\nEffective arrival time $t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$. Update $t_{\\text{last\\_eff}} = 1.5\\,\\mathrm{ms}$.\nThe refractory period for this spike ends at $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 1.5 + 3.0 = 4.5\\,\\mathrm{ms}$.\n\nSpike $2$: $t_2 = 2\\,\\mathrm{ms}$.\nPutative arrival time: $t_2^{\\text{putative}} = 2 + d = 3.5\\,\\mathrm{ms}$.\nCheck for refractoriness: Is $3.5\\,\\mathrm{ms} < 4.5\\,\\mathrm{ms}$? Yes.\nThis spike is within the refractory window of the first effective spike and is ignored. $t_{\\text{last\\_eff}}$ remains $1.5\\,\\mathrm{ms}$.\n\nSpike $3$: $t_3 = 3.5\\,\\mathrm{ms}$.\nPutative arrival time: $t_3^{\\text{putative}} = 3.5 + d = 5.0\\,\\mathrm{ms}$.\nCheck for refractoriness: Is $5.0\\,\\mathrm{ms} < 4.5\\,\\mathrm{ms}$? No.\nThis spike is effective.\nEffective arrival time $t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$. Update $t_{\\text{last\\_eff}} = 5.0\\,\\mathrm{ms}$.\nThe refractory period for this spike ends at $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 5.0 + 3.0 = 8.0\\,\\mathrm{ms}$.\n\nSpike $4$: $t_4 = 7\\,\\mathrm{ms}$.\nPutative arrival time: $t_4^{\\text{putative}} = 7 + d = 8.5\\,\\mathrm{ms}$.\nCheck for refractoriness: Is $8.5\\,\\mathrm{ms} < 8.0\\,\\mathrm{ms}$? No.\nThis spike is effective.\nEffective arrival time $t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$. Update $t_{\\text{last\\_eff}} = 8.5\\,\\mathrm{ms}$.\nThe refractory period for this spike ends at $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 8.5 + 3.0 = 11.5\\,\\mathrm{ms}$.\n\nSpike $5$: $t_5 = 9\\,\\mathrm{ms}$.\nPutative arrival time: $t_5^{\\text{putative}} = 9 + d = 10.5\\,\\mathrm{ms}$.\nThis arrival time is after our target time of $t^\\ast=10.0\\,\\mathrm{ms}$, so it does not influence the calculation of $g(10.0)$.\n\nThe effective spike arrival times influencing the state at $t^\\ast = 10.0\\,\\mathrm{ms}$ are $\\{1.5\\,\\mathrm{ms},\\; 5.0\\,\\mathrm{ms},\\; 8.5\\,\\mathrm{ms}\\}$. Now we simulate the conductance $g(t)$ through these events.\n\nInitial state: At $t=0$, $g(0) = 0\\,\\mathrm{nS}$. The conductance remains $0$ until the first effective spike.\n\nAt $t=t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$:\nThe conductance just before the spike is $g(1.5^{-}) = g(0) \\exp(-1.5/5) = 0\\,\\mathrm{nS}$.\nThe conductance is updated: $g(1.5^{+}) = \\min(g(1.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(0 + 1.2, 3.0) = 1.2\\,\\mathrm{nS}$.\n\nAt $t=t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$:\nThe time elapsed since the last effective spike is $\\Delta t_1 = 5.0 - 1.5 = 3.5\\,\\mathrm{ms}$.\nThe conductance decays to $g(5.0^{-}) = g(1.5^{+}) \\exp(-\\Delta t_1 / \\tau) = 1.2 \\exp(-3.5/5) = 1.2 \\exp(-0.7)\\,\\mathrm{nS}$.\nThe conductance is updated: $g(5.0^{+}) = \\min(g(5.0^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 \\exp(-0.7) + 1.2, 3.0)\\,\\mathrm{nS}$.\nNumerically, $1.2 \\exp(-0.7) + 1.2 \\approx 1.2 \\times 0.4966 + 1.2 \\approx 0.5959 + 1.2 = 1.7959\\,\\mathrm{nS}$, which is less than $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$. So no saturation occurs.\n$g(5.0^{+}) = 1.2 (\\exp(-0.7) + 1)\\,\\mathrm{nS}$.\n\nAt $t=t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$:\nThe time elapsed since the last effective spike is $\\Delta t_2 = 8.5 - 5.0 = 3.5\\,\\mathrm{ms}$.\nThe conductance decays to $g(8.5^{-}) = g(5.0^{+}) \\exp(-\\Delta t_2 / \\tau) = [1.2 (\\exp(-0.7) + 1)] \\exp(-3.5/5) = 1.2 (\\exp(-0.7) + 1) \\exp(-0.7)\\,\\mathrm{nS} = 1.2 (\\exp(-1.4) + \\exp(-0.7))\\,\\mathrm{nS}$.\nThe conductance is updated: $g(8.5^{+}) = \\min(g(8.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2, 3.0)\\,\\mathrm{nS}$.\nNumerically, $1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2 \\approx 1.2 \\times (0.2466 + 0.4966) + 1.2 \\approx 1.2 \\times 0.7432 + 1.2 = 0.8918 + 1.2 = 2.0918\\,\\mathrm{nS}$, which is less than $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$. No saturation occurs.\n$g(8.5^{+}) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\,\\mathrm{nS}$.\n\nFinally, we compute the conductance at the target time $t^\\ast = 10.0\\,\\mathrm{ms}$.\nThe time elapsed since the last effective spike is $\\Delta t_3 = 10.0 - 8.5 = 1.5\\,\\mathrm{ms}$.\nThe conductance decays from its value at $t=8.5\\,\\mathrm{ms}$:\n$g(10.0) = g(8.5^{+}) \\exp(-\\Delta t_3 / \\tau) = \\left[1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\right] \\exp(-1.5/5)\\,\\mathrm{nS}$.\n$g(10.0) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1) \\exp(-0.3)\\,\\mathrm{nS}$.\n$g(10.0) = 1.2 (\\exp(-1.7) + \\exp(-1.0) + \\exp(-0.3))\\,\\mathrm{nS}$.\n\nNow we substitute numerical values:\n$\\exp(-0.3) \\approx 0.740818$\n$\\exp(-1.0) \\approx 0.367879$\n$\\exp(-1.7) \\approx 0.182684$\n$g(10.0) \\approx 1.2 \\times (0.182684 + 0.367879 + 0.740818)\\,\\mathrm{nS}$\n$g(10.0) \\approx 1.2 \\times (1.291381)\\,\\mathrm{nS} \\approx 1.549657\\,\\mathrm{nS}$.\n\nThe postsynaptic current $I(t^\\ast)$ is then calculated:\n$I(10.0) = g(10.0) \\times (E_{\\text{syn}} - V_{\\text{hold}})$\n$E_{\\text{syn}} - V_{\\text{hold}} = 0\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = 65\\,\\mathrm{mV}$.\n$I(10.0) \\approx (1.549657\\,\\mathrm{nS}) \\times (65\\,\\mathrm{mV})$.\nThe product of units is $(\\mathrm{nS}) \\times (\\mathrm{mV}) = (10^{-9}\\,\\mathrm{S}) \\times (10^{-3}\\,\\mathrm{V}) = 10^{-12}\\,\\mathrm{A} = 1\\,\\mathrm{pA}$.\n$I(10.0) \\approx 1.549657 \\times 65\\,\\mathrm{pA} \\approx 100.7277\\,\\mathrm{pA}$.\n\nThe problem requires the answer in nanoamperes (nA). Since $1\\,\\mathrm{nA} = 1000\\,\\mathrm{pA}$:\n$I(10.0) \\approx \\frac{100.7277}{1000}\\,\\mathrm{nA} \\approx 0.1007277\\,\\mathrm{nA}$.\n\nRounding to four significant figures, we get $0.1007\\,\\mathrm{nA}$. The problem specifies to report a positive value for inward current when $E_{\\text{syn}} - V_{\\text{hold}} > 0$. Our driving force is positive, and our calculated current is positive, consistent with an inward current.",
            "answer": "$$\n\\boxed{0.1007}\n$$"
        },
        {
            "introduction": "Choosing between a time-driven and an event-driven simulation engine is a fundamental architectural decision with profound performance implications. The optimal choice depends on network properties like firing rates and connectivity, as well as the desired numerical precision. This exercise  provides a framework for quantitatively comparing these two strategies, allowing you to calculate the expected speedup of one over the other and understand the key parameters that govern their relative efficiency.",
            "id": "3992895",
            "problem": "A large-scale spiking network is simulated using two back-end strategies: an event-driven engine based on a priority queue and a fixed-step time-driven loop. The network has $N$ neurons, each connecting independently to other neurons with probability $p$, so that the expected out-degree is $K = p\\,(N-1) \\approx p\\,N$ and the expected total number of directed synapses is $M \\approx N\\,K$. Each neuron emits spikes according to a homogeneous Poisson process with rate $r$ (in $\\text{s}^{-1}$). Upon each presynaptic spike, each outgoing synapse releases with independent probability $q$; a realized release generates exactly one postsynaptic transmission event with a conduction delay that is scheduled for future delivery.\n\nThe event-driven engine uses a Calendar Queue (CQ) priority queue to manage delayed postsynaptic events. For each realized synaptic transmission, the engine performs one insertion into the CQ, one removal when the event is due, and one postsynaptic synaptic update. Assume constant per-operation costs: $c_{\\mathrm{ins}}$ for each CQ insertion, $c_{\\mathrm{pop}}$ for each CQ removal, and $c_{\\mathrm{evt}}$ for each postsynaptic synaptic update. Assume stationarity so that, in expectation, the number of insertions per unit simulated time equals the number of removals. Neglect all other costs (for example, presynaptic update overheads) relative to these dominant operations.\n\nThe time-driven engine advances in fixed time steps of size $\\Delta t$ (in $\\text{s}$). At each time step it iterates over all synapses, updating their state deterministically (for example, exponential decay) whether or not a presynaptic spike occurred, with a constant cost $c_{\\mathrm{step}}$ per synapse per step. Neglect any additional spike-handling overhead relative to this dominant per-step synapse loop.\n\nAssume a Central Processing Unit (CPU) that can execute a fixed number of basic operations per wall-clock second, identical across both engines, so that the simulated-time throughput is inversely proportional to the expected number of basic operations required per unit simulated time. Define the speedup factor $\\mathcal{S}$ of the event-driven engine over the time-driven engine as the ratio of expected operation counts per unit simulated time, $\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$, where $C_{\\mathrm{TD}}$ and $C_{\\mathrm{ED}}$ are the respective expected operation counts per unit simulated time.\n\nGiven the following parameters:\n- $N = 10^{6}$,\n- $p = 10^{-3}$,\n- $r = 5$,\n- $q = 0.2$,\n- $\\Delta t = 10^{-4}$,\n- $c_{\\mathrm{ins}} = 3$,\n- $c_{\\mathrm{pop}} = 2$,\n- $c_{\\mathrm{evt}} = 1$,\n- $c_{\\mathrm{step}} = 1$,\n\ncompute the numerical value of $\\mathcal{S}$. Round your answer to three significant figures. Express the final speedup as a dimensionless factor with no units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Number of neurons: $N = 10^{6}$\n- Connection probability: $p = 10^{-3}$\n- Expected out-degree: $K = p\\,(N-1) \\approx p\\,N$\n- Expected total synapses: $M \\approx N\\,K$\n- Spike rate per neuron: $r = 5 \\, \\text{s}^{-1}$\n- Synaptic release probability: $q = 0.2$\n- Time-driven simulation time step: $\\Delta t = 10^{-4} \\, \\text{s}$\n- Event-driven cost per insertion: $c_{\\mathrm{ins}} = 3$\n- Event-driven cost per removal: $c_{\\mathrm{pop}} = 2$\n- Event-driven cost per postsynaptic update: $c_{\\mathrm{evt}} = 1$\n- Time-driven cost per synapse per step: $c_{\\mathrm{step}} = 1$\n- Definition of speedup: $\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$, where $C_{\\mathrm{TD}}$ and $C_{\\mathrm{ED}}$ are the expected operation counts per unit simulated time for the time-driven and event-driven engines, respectively.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard performance comparison between two common simulation algorithms (event-driven vs. time-driven) for a large-scale spiking neural network. The model assumptions, such as Poisson spiking and probabilistic synapses, are standard in theoretical and computational neuroscience for creating tractable yet informative models. All parameters are defined, and the values are physically and computationally plausible for such a simulation. The cost functions are simplified but provide a clear, formalizable basis for comparison. The problem is self-contained, scientifically grounded in computational neuroscience, and well-posed. There are no contradictions, ambiguities, or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution proceeds.\n\nThe objective is to compute the speedup factor $\\mathcal{S}$, defined as the ratio of the expected total operation counts per unit simulated time for the time-driven ($C_{\\mathrm{TD}}$) and event-driven ($C_{\\mathrm{ED}}$) engines:\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}}\n$$\n\nFirst, we derive an expression for $C_{\\mathrm{ED}}$, the expected operation count per unit simulated time for the event-driven engine. The cost in this engine is proportional to the number of realized synaptic transmission events.\nThe total rate of spikes across the entire network is the number of neurons $N$ multiplied by the individual neuron firing rate $r$.\n$$\n\\text{Total Spike Rate} = N \\cdot r\n$$\nEach neuron has an expected out-degree of $K \\approx pN$. Upon each spike, a signal is sent to $K$ outgoing synapses. Each of these synapses then releases with probability $q$. Therefore, the expected number of realized transmission events per presynaptic spike is $K \\cdot q$.\nThe total rate of realized synaptic transmission events in the network, $R_{\\mathrm{event}}$, is the product of the total spike rate and the expected number of transmissions per spike.\n$$\nR_{\\mathrm{event}} = (N \\cdot r) \\cdot (K \\cdot q)\n$$\nUsing the approximation $K \\approx pN$, we have:\n$$\nR_{\\mathrm{event}} \\approx (N \\cdot r) \\cdot (p \\cdot N \\cdot q) = N^2 p r q\n$$\nFor each realized transmission event, the engine performs one insertion, one removal, and one postsynaptic update. The total cost per event is $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})$.\nThe total expected operation count per unit simulated time, $C_{\\mathrm{ED}}$, is the rate of events multiplied by the cost per event.\n$$\nC_{\\mathrm{ED}} = R_{\\mathrm{event}} \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) \\approx N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})\n$$\n\nNext, we derive an expression for $C_{\\mathrm{TD}}$, the expected operation count per unit simulated time for the time-driven engine. This engine advances in discrete time steps of size $\\Delta t$. The number of simulation steps per unit of simulated time is $1/\\Delta t$.\nAt each time step, the engine updates the state of every synapse in the network. The total number of synapses is $M \\approx N K \\approx N(pN) = N^2 p$.\nThe cost per synapse per time step is $c_{\\mathrm{step}}$. Thus, the total operation count per time step is $M \\cdot c_{\\mathrm{step}} \\approx N^2 p c_{\\mathrm{step}}$.\nThe total expected operation count per unit simulated time, $C_{\\mathrm{TD}}$, is the cost per time step multiplied by the number of time steps per unit time.\n$$\nC_{\\mathrm{TD}} = (M \\cdot c_{\\mathrm{step}}) \\cdot \\frac{1}{\\Delta t} \\approx \\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}\n$$\n\nNow we can compute the speedup factor $\\mathcal{S}$ by taking the ratio of $C_{\\mathrm{TD}}$ to $C_{\\mathrm{ED}}$.\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}} \\approx \\frac{\\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}}{N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\nThe term $N^2 p$ cancels from the numerator and the denominator. This indicates that for this model, the relative performance of the two engines is independent of network size and connection probability.\n$$\n\\mathcal{S} = \\frac{c_{\\mathrm{step}}}{\\Delta t \\cdot r \\cdot q \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\nWe now substitute the given numerical values into this expression:\n- $c_{\\mathrm{step}} = 1$\n- $\\Delta t = 10^{-4}$\n- $r = 5$\n- $q = 0.2$\n- $c_{\\mathrm{ins}} = 3$\n- $c_{\\mathrm{pop}} = 2$\n- $c_{\\mathrm{evt}} = 1$\n\nThe sum of event-driven costs is $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) = (3 + 2 + 1) = 6$.\nThe product in the denominator is $\\Delta t \\cdot r \\cdot q = 10^{-4} \\cdot 5 \\cdot 0.2 = 10^{-4} \\cdot 1 = 10^{-4}$.\nSubstituting these into the expression for $\\mathcal{S}$:\n$$\n\\mathcal{S} = \\frac{1}{10^{-4} \\cdot 6} = \\frac{1}{6 \\times 10^{-4}} = \\frac{10^4}{6} = \\frac{10000}{6} = 1666.666...\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\mathcal{S} \\approx 1670\n$$\nExpressing this in the requested scientific notation format:\n$$\n\\mathcal{S} \\approx 1.67 \\times 10^{3}\n$$\nThis result signifies that, under the given parameters and cost model, the event-driven engine is expected to be approximately $1670$ times faster than the time-driven engine.",
            "answer": "$$\n\\boxed{1.67 \\times 10^{3}}\n$$"
        }
    ]
}