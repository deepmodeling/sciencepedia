{
    "hands_on_practices": [
        {
            "introduction": "本次练习着重于PING回路中的基本时间关系。通过分析一个线性化模型，你将计算兴奋性神经元群体和抑制性神经元群体之间的相位延迟，这对于理解神经网络如何以特定频率维持振荡至关重要。该练习将抽象的线性系统理论与神经元和突触的具体生物物理特性联系起来。",
            "id": "4012041",
            "problem": "考虑一个简化的线性化椎体-中间神经元网络伽马（PING）机制模型，该模型由一个活动为 $E(t)$ 的兴奋性锥体神经元群体和一个活动为 $I(t)$ 的抑制性中间神经元群体组成。在稳定极限环附近，兴奋性活动可以近似为伽马频率的正弦波，$E(t) = E_{0} \\cos(\\omega t)$，其中 $\\omega = 2 \\pi f$，$f$ 为振荡频率。从 $E$ 到 $I$ 的抑制性通路被建模为一个级联系统，包括一个时间常数为 $\\tau_{sI}$ 的突触低通滤波器，其后是一个时间常数为 $\\tau_{mI}$ 的抑制性膜低通滤波器，以及兴奋性到抑制性通路上的一个传导延迟 $d_{I}$。相应的线性常微分方程为：\n$$\n\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I}),\n$$\n$$\n\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t),\n$$\n其中 $s_{I}(t)$ 是抑制性突触驱动，$g_{I} > 0$ 是一个常数增益。假设与上述抑制性通路相比，兴奋性群体自身的滤波和传导延迟可以忽略不计，并且系统在频率 $f$ 下处于稳态正弦振荡，因此抑制性活动的形式为 $I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$，其中相位滞后 $\\phi_{EI} > 0$。\n\n从这些方程和由正弦输入驱动的线性时不变系统的第一性原理出发，推导相位滞后 $\\phi_{EI}$ 与抑制性通路的相位响应之间的解析关系，然后对以下具有伽马节律特征的科学上合理的参数集计算 $\\phi_{EI}$ 的数值：\n- $f = 40\\,\\mathrm{Hz}$,\n- $\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$,\n- $\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$,\n- $d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$.\n\n将 $\\phi_{EI}$ 的最终答案以弧度表示，并四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取给定信息**\n- 兴奋性群体活动：$E(t) = E_{0} \\cos(\\omega t)$\n- 角频率：$\\omega = 2 \\pi f$\n- 抑制性突触驱动 $s_I(t)$ 的微分方程：$\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$\n- 抑制性群体活动 $I(t)$ 的微分方程：$\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$\n- 增益常数：$g_{I} > 0$\n- 抑制性群体活动形式：$I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$，相位滞后 $\\phi_{EI} > 0$\n- 数值参数：\n    - 频率：$f = 40\\,\\mathrm{Hz}$\n    - 突触时间常数：$\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$\n    - 膜时间常数：$\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$\n    - 传导延迟：$d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学依据：** 该问题提出了 PING 机制的线性化模型，这是计算神经科学中解释伽马波段振荡的基石。控制方程是一阶线性常微分方程，是突触和神经元膜的低通滤波效应的标准表示。参数值对于皮层回路是生理上真实的。该问题在科学上是合理的。\n- **适定性：** 该问题要求计算线性时不变 (LTI) 系统对正弦输入的稳态相位响应。这是系统分析中一个经典且明确定义的问题，保证了相位滞后存在唯一且稳定的解。\n- **客观性：** 该问题使用精确的数学和科学语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n该问题有效。它有科学依据，数学上适定，并且陈述客观。将提供完整的解答。\n\n所描述的系统由一系列级联的线性时不变 (LTI) 算子组成，将输入信号 $E(t)$ 转换为输出信号 $I(t)$。分析 LTI 系统对正弦输入的稳态响应最有效的方法是频域分析。我们将用其复传递函数 $H(j\\omega)$ 来表示抑制性通路的每个组成部分。\n\n从 $E(t)$ 到 $I(t)$ 的总体变换可以分解为三个相继的阶段：\n1. 一个纯时间延迟 $d_I$。\n2. 一个表示突触动力学的一阶低通滤波器，时间常数为 $\\tau_{sI}$。\n3. 一个带有增益 $g_I$ 的表示抑制性膜动力学的一阶低通滤波器，时间常数为 $\\tau_{mI}$。\n\n让我们找出每个阶段的传递函数。对于一个传递函数为 $H(j\\omega)$ 的 LTI 系统，形式为 $\\exp(j\\omega t)$ 的输入会产生输出 $H(j\\omega)\\exp(j\\omega t)$。复数 $H(j\\omega)$ 的相位，记为 $\\arg\\{H(j\\omega)\\}$，给出了输出相对于输入的相移。\n\n第一个方程 $\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$ 描述了突触滤波器对延迟输入的响应。我们可以将延迟和突触滤波器结合起来。从 $E(t)$ 到 $s_I(t)$ 的总变换由该方程控制。我们定义一个中间变量 $E_d(t) = E(t - d_I)$。\n在频域中（或使用相量分析），我们代入 $E(t) = E_0 \\exp(j\\omega t)$，这意味着 $E_d(t) = E_0 \\exp(j\\omega(t-d_I)) = (E_0 \\exp(-j\\omega d_I)) \\exp(j\\omega t)$。我们寻找形式为 $s_I(t) = S_I \\exp(j\\omega t)$ 的解 $s_I(t)$。代入第一个微分方程得到：\n$$\n\\tau_{sI} (j\\omega S_I \\exp(j\\omega t)) + S_I \\exp(j\\omega t) = E_0 \\exp(-j\\omega d_I) \\exp(j\\omega t)\n$$\n$$\nS_I (j\\omega \\tau_{sI} + 1) = E_0 \\exp(-j\\omega d_I)\n$$\n突触驱动的复振幅为 $S_I = \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}}$。\n\n现在，我们将此结果作为输入代入第二个方程 $\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$。我们寻求形式为 $I(t) = I_{\\mathrm{complex}} \\exp(j\\omega t)$ 的解 $I(t)$，其中 $I_{\\mathrm{complex}}$ 是抑制性活动的复振幅。\n$$\n\\tau_{mI} (j\\omega I_{\\mathrm{complex}} \\exp(j\\omega t)) + I_{\\mathrm{complex}} \\exp(j\\omega t) = g_I (S_I \\exp(j\\omega t))\n$$\n$$\nI_{\\mathrm{complex}} (j\\omega \\tau_{mI} + 1) = g_I S_I\n$$\n代入 $S_I$ 的表达式：\n$$\nI_{\\mathrm{complex}} = \\frac{g_I S_I}{1 + j\\omega \\tau_{mI}} = \\frac{g_I}{1 + j\\omega \\tau_{mI}} \\left( \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}} \\right)\n$$\n从 $E(t)$ 到 $I(t)$ 的总传递函数 $H_{EI}(j\\omega)$ 是它们复振幅的比值 $I_{\\mathrm{complex}}/E_0$：\n$$\nH_{EI}(j\\omega) = \\frac{I_{\\mathrm{complex}}}{E_0} = \\frac{g_I \\exp(-j\\omega d_I)}{(1 + j\\omega \\tau_{sI})(1 + j\\omega \\tau_{mI})}\n$$\n输出 $I(t)$ 相对于输入 $E(t)$ 的相移是该复传递函数的辐角，即 $\\arg\\{H_{EI}(j\\omega)\\}$。复数乘积/商的相位是它们各自相位的和/差：\n$$\n\\arg\\{H_{EI}(j\\omega)\\} = \\arg\\{g_I\\} + \\arg\\{\\exp(-j\\omega d_I)\\} - \\arg\\{1 + j\\omega \\tau_{sI}\\} - \\arg\\{1 + j\\omega \\tau_{mI}\\}\n$$\n因为 $g_I$ 是一个正实数，所以 $\\arg\\{g_I\\}=0$。$\\exp(-j\\omega d_I)$ 的相位是 $-\\omega d_I$。复数 $1+jx$ 的相位是 $\\arctan(x)$。因此：\n$$\n\\phi_{\\mathrm{shift}} = -\\omega d_I - \\arctan(\\omega \\tau_{sI}) - \\arctan(\\omega \\tau_{mI})\n$$\n问题将输出定义为 $I(t) = I_0 \\cos(\\omega t - \\phi_{EI})$。一个 $\\phi_{\\mathrm{shift}}$ 的相移对应于形式为 $\\cos(\\omega t + \\phi_{\\mathrm{shift}})$ 的输出。通过比较这两种形式，我们得到 $\\cos(\\omega t - \\phi_{EI}) = \\cos(\\omega t + \\phi_{\\mathrm{shift}})$。这意味着 $\\phi_{EI} = -\\phi_{\\mathrm{shift}}$。\n因此，相位滞后 $\\phi_{EI}$ 是：\n$$\n\\phi_{EI} = \\omega d_I + \\arctan(\\omega \\tau_{sI}) + \\arctan(\\omega \\tau_{mI})\n$$\n这就是相位滞后与抑制性通路参数之间的解析关系。\n\n现在，我们使用给定的参数计算数值。\n首先，计算角频率 $\\omega$：\n$$\n\\omega = 2 \\pi f = 2 \\pi (40\\,\\mathrm{Hz}) = 80 \\pi \\,\\mathrm{rad/s}\n$$\n接下来，计算 $\\phi_{EI}$ 表达式中每一项的值：\n1. 传导延迟 $d_I$ 的相位贡献：\n$$\n\\phi_{\\mathrm{delay}} = \\omega d_I = (80 \\pi \\,\\mathrm{s}^{-1}) \\times (1.5 \\times 10^{-3}\\,\\mathrm{s}) = 0.12 \\pi \\,\\mathrm{rad}\n$$\n2. 时间常数为 $\\tau_{sI}$ 的突触滤波器的相位贡献：\n$$\n\\phi_{\\mathrm{synapse}} = \\arctan(\\omega \\tau_{sI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (5 \\times 10^{-3}\\,\\mathrm{s})) = \\arctan(0.4 \\pi) \\,\\mathrm{rad}\n$$\n3. 时间常数为 $\\tau_{mI}$ 的膜滤波器的相位贡献：\n$$\n\\phi_{\\mathrm{membrane}} = \\arctan(\\omega \\tau_{mI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (10 \\times 10^{-3}\\,\\mathrm{s})) = \\arctan(0.8 \\pi) \\,\\mathrm{rad}\n$$\n总相位滞后 $\\phi_{EI}$ 是这三部分贡献的总和：\n$$\n\\phi_{EI} = 0.12 \\pi + \\arctan(0.4 \\pi) + \\arctan(0.8 \\pi)\n$$\n使用数值计算：\n$\\pi \\approx 3.14159265...$\n$$\n0.12 \\pi \\approx 0.376991\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.4 \\pi) \\approx \\arctan(1.256637)\\approx 0.898393\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.8 \\pi) \\approx \\arctan(2.513274)\\approx 1.192439\\,\\mathrm{rad}\n$$\n将这些值相加：\n$$\n\\phi_{EI} \\approx 0.376991 + 0.898393 + 1.192439 = 2.467823\\,\\mathrm{rad}\n$$\n四舍五入到四位有效数字，我们得到 $2.468$。",
            "answer": "$$\n\\boxed{2.468}\n$$"
        },
        {
            "introduction": "在理解了时间关系的基础上，本练习将探讨产生振荡的非线性动力学。你将使用经典的Wilson-Cowan模型进行霍普夫分岔分析，推导出网络从稳定、非振荡状态转变为节律性伽马振荡的精确条件。本次实践揭示了网络参数和神经调质影响如何充当节律生成的“开关”。",
            "id": "4012014",
            "problem": "考虑一个由兴奋性锥体神经元群和抑制性中间神经元群组成的锥体-中间神经元伽马（PING）回路的双群体 Wilson–Cowan 模型。Wilson–Cowan 方程将粗粒度群体速率描述为\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\left(w_{EE} E - w_{EI} I + P_{E}\\right), \\quad\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\left(w_{IE} E - w_{II} I + P_{I}\\right),\n$$\n其中 $E$ 和 $I$ 分别是兴奋性和抑制性群体活动，$\\tau_{E}$ 和 $\\tau_{I}$ 是群体时间常数，$w_{EE}$、$w_{EI}$、$w_{IE}$ 和 $w_{II}$ 是有效突触增益，而 $P_{E}$ 和 $P_{I}$ 是持续性输入。函数 $S_{E}(\\cdot)$ 和 $S_{I}(\\cdot)$ 是光滑、饱和的 S 型函数，代表群体输入-输出传递函数。假设在没有振荡的情况下存在一个稳定平衡点 $(E^{*}, I^{*})$。\n\n多巴胺通过改变工作点处 $S_{E}(\\cdot)$ 的斜率来调节兴奋性增益。将有效增益定义为平衡点输入处的斜率：$g_{E} = S_{E}'(h_{E}^{*})$ 和 $g_{I} = S_{I}'(h_{I}^{*})$，其中 $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$ 且 $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$。将多巴胺依赖性调制建模为兴奋性增益的线性缩放，$g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$，其中 $D$ 是一个小的无量纲多巴胺状态变量，$\\eta > 0$ 是敏感度，而 $g_{I}$ 不受影响。\n\n从 Wilson–Cowan 形式和基本的线性化原理出发，完成以下任务：\n- 推导在 $(E^{*}, I^{*})$ 处的雅可比矩阵，用 $\\tau_{E}$、$\\tau_{I}$、$w_{EE}$、$w_{EI}$、$w_{IE}$、$w_{II}$、$g_{E}$ 和 $g_{I}$ 表示。\n- 使用二维系统中振荡起始的标准霍普夫分岔条件，推导平衡点通过霍普夫分岔失去稳定性时的兴奋性增益阈值 $g_{E}^{\\mathrm{crit}}$ 的条件。以闭式解形式表示 $g_{E}^{\\mathrm{crit}}$。\n- 在超临界霍普夫分岔和工作点处具有负三阶导数（确保饱和）的光滑 S 型函数（$S'''  0$）的假设下，使用霍普夫范式表达极限环振幅如何通过与阈值的距离随多巴胺缩放，并给出振幅对 $g_{E}(D) - g_{E}^{\\mathrm{crit}}$ 的主阶依赖关系。\n\n您必须从第一性原理（Wilson–Cowan 模型的定义、线性化和霍普夫条件）出发，论证每一步。为雅可比矩阵的迹和行列式以及起始频率提供清晰的中间符号表达式。您最终报告的答案应该是增益阈值 $g_{E}^{\\mathrm{crit}}$ 的单个闭式解析表达式。不需要进行数值计算。如果您为范式系数引入任何附加符号，请明确定义它们。缩略词必须在首次使用时定义。最终答案必须是单个不带单位的解析表达式。",
            "solution": "首先应对问题进行严格的验证过程。\n\n### 步骤 1：提取给定条件\n逐字记录的给定条件如下：\n- **模型方程**：锥体-中间神经元伽马 (PING) 回路的 Wilson–Cowan 方程为：\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\\\\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\left(w_{IE} E - w_{II} I + P_{I}\\right)\n$$\n- **变量和参数**：\n  - $E, I$：兴奋性和抑制性群体活动。\n  - $\\tau_{E}, \\tau_{I}$：群体时间常数。\n  - $w_{EE}, w_{EI}, w_{IE}, w_{II}$：有效突触增益。\n  - $P_{E}, P_{I}$：持续性输入。\n  - $S_{E}(\\cdot), S_{I}(\\cdot)$：光滑、饱和的 S 型传递函数。\n- **平衡点**：存在一个稳定平衡点 $(E^{*}, I^{*})$。\n- **有效增益**：定义为 S 型函数在平衡点处的斜率：\n  - $g_{E} = S_{E}'(h_{E}^{*})$，其中 $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$。\n  - $g_{I} = S_{I}'(h_{I}^{*})$，其中 $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$。\n- **多巴胺调制**：建模为 $g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$，其中 $D$ 是一个小的无量纲多巴胺状态变量，$\\eta > 0$ 是敏感度。增益 $g_{I}$ 不受影响。\n- **假设**：该分岔是超临界霍普夫分岔，并且 S 型函数在工作点处具有负三阶导数 ($S'''  0$)。\n- **要求推导**：\n  1. 在 $(E^{*}, I^{*})$ 处的雅可比矩阵。\n  2. 发生霍普夫分岔的兴奋性增益阈值 $g_{E}^{\\mathrm{crit}}$ 的条件。\n  3. 极限环振幅随与阈值的距离 $g_{E}(D) - g_{E}^{\\mathrm{crit}}$ 的缩放关系。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于 Wilson–Cowan 模型，这是理论和计算神经科学中描述群体层面神经动力学的基础框架。所要求的分析——线性化和霍普夫分岔分析——是动力系统研究中标准的、成熟的方法。PING（锥体-中间神经元伽马）机制是关于大脑中伽马波段振荡生成的一个突出且有实验支持的假说。该问题在科学上是合理的。\n- **适定性**：该问题提供了一个清晰、完整的数学模型，并要求基于此进行具体的推导。所提供的假设（存在稳定不动点、分岔的超临界性质）确保可以推导出唯一且有意义的解。\n- **客观性**：语言技术性强、精确，不含任何主观性或观点。\n- **完整性与一致性**：问题陈述包含了进行推导所需的所有必要方程、定义和假设。没有内部矛盾。\n- **现实性**：虽然是对神经生物学的简化，但 Wilson-Cowan 模型和 PING 机制是科学上可信且广泛使用的工作模型。参数化是符号化的，因此不会出现物理不一致的问题。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。这是一个适定的、有科学依据的、关于分析标准计算神经科学模型的练习。可以开始求解过程。\n\n---\n\n该系统是一个二维动力系统，由以下常微分方程描述：\n$$\n\\frac{dE}{dt} = F_{E}(E, I) = \\frac{1}{\\tau_{E}} \\left[ -E + S_{E}\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\\\\n\\frac{dI}{dt} = F_{I}(E, I) = \\frac{1}{\\tau_{I}} \\left[ -I + S_{I}\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right]\n$$\n我们通过线性化系统来分析平衡点 $(E^{*}, I^{*})$ 的稳定性。小微扰 $\\delta E = E - E^{*}$ 和 $\\delta I = I - I^{*}$ 的动力学由在该平衡点处计算的雅可比矩阵 $J$ 控制。\n\n**1. 雅可比矩阵的推导**\n雅可比矩阵定义为 $J_{ij} = \\frac{\\partial F_{i}}{\\partial x_{j}}$，其中 $\\mathbf{x} = (E, I)$。我们计算四个分量：\n$J_{11} = \\frac{\\partial F_{E}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ -1 + \\frac{\\partial}{\\partial E} S_{E}\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{E}}{\\partial E} = S_{E}' \\cdot w_{EE}$。在平衡点处，$S_{E}'(h_{E}^{*}) = g_{E}$。\n因此，$J_{11} = \\frac{1}{\\tau_{E}} \\left( g_{E} w_{EE} - 1 \\right)$。\n\n$J_{12} = \\frac{\\partial F_{E}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ \\frac{\\partial}{\\partial I} S_{E}\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{E}}{\\partial I} = S_{E}' \\cdot (-w_{EI})$。\n因此，$J_{12} = \\frac{1}{\\tau_{E}} \\left( -g_{E} w_{EI} \\right) = - \\frac{g_{E} w_{EI}}{\\tau_{E}}$。\n\n$J_{21} = \\frac{\\partial F_{I}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ \\frac{\\partial}{\\partial E} S_{I}\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{I}}{\\partial E} = S_{I}' \\cdot w_{IE}$。在平衡点处，$S_{I}'(h_{I}^{*}) = g_{I}$。\n因此，$J_{21} = \\frac{g_{I} w_{IE}}{\\tau_{I}}$。\n\n$J_{22} = \\frac{\\partial F_{I}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ -1 + \\frac{\\partial}{\\partial I} S_{I}\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{I}}{\\partial I} = S_{I}' \\cdot (-w_{II})$。\n因此，$J_{22} = \\frac{1}{\\tau_{I}} \\left( -1 - g_{I} w_{II} \\right) = - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$。\n\n结合这些分量，平衡点 $(E^{*}, I^{*})$ 处的雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{g_{E} w_{EE} - 1}{\\tau_{E}}  -\\frac{g_{E} w_{EI}}{\\tau_{E}} \\\\ \\frac{g_{I} w_{IE}}{\\tau_{I}}  -\\frac{g_{I} w_{II} + 1}{\\tau_{I}} \\end{pmatrix}\n$$\n\n**2. 霍普夫分岔条件的推导**\n霍普夫分岔标志着从稳定不动点到极限环振荡的转变。这发生在雅可比矩阵的特征值（初始位于复平面的左半部分，即实部为负）穿过虚轴时。对于二维系统，这要求特征值为一对纯虚共轭复数，$\\lambda = \\pm i \\omega_{0}$，其中 $\\omega_{0} \\in \\mathbb{R}^{+}$。特征方程为 $\\lambda^2 - \\mathrm{Tr}(J) \\lambda + \\mathrm{Det}(J) = 0$。霍普夫分岔的条件是：\n1. $\\mathrm{Tr}(J) = 0$\n2. $\\mathrm{Det}(J) > 0$\n\n雅可比矩阵的迹是其对角元素之和：\n$$\n\\mathrm{Tr}(J) = J_{11} + J_{22} = \\frac{g_{E} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\n将迹设为零，得到临界兴奋性增益 $g_{E}^{\\mathrm{crit}}$ 的条件：\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}} = 0\n$$\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\n求解 $g_{E}^{\\mathrm{crit}}$：\n$$\n\\tau_{I} (g_{E}^{\\mathrm{crit}} w_{EE} - 1) = \\tau_{E} (g_{I} w_{II} + 1)\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} - \\tau_{I} = \\tau_{E} g_{I} w_{II} + \\tau_{E}\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} = \\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}\n$$\n这得出了临界增益的闭式表达式：\n$$\ng_{E}^{\\mathrm{crit}} = \\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}\n$$\n问题陈述初始平衡是稳定的，意味着 $\\mathrm{Tr}(J)  0$。由于 $w_{EE} > 0$（兴奋性自连接），$\\mathrm{Tr}(J)$ 是 $g_{E}$ 的增函数。当 $g_{E}$ 增加超过 $g_{E}^{\\mathrm{crit}}$ 时，$\\mathrm{Tr}(J)$ 变为正，导致不稳定性，这与问题设置一致。\n\n雅可比矩阵的行列式为：\n$$\n\\mathrm{Det}(J) = J_{11} J_{22} - J_{12} J_{21} = \\left(\\frac{g_{E} w_{EE} - 1}{\\tau_{E}}\\right) \\left(-\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right) - \\left(-\\frac{g_{E} w_{EI}}{\\tau_{E}}\\right) \\left(\\frac{g_{I} w_{IE}}{\\tau_{I}}\\right)\n$$\n$$\n\\mathrm{Det}(J) = \\frac{-(g_{E} w_{EE} - 1)(g_{I} w_{II} + 1) + g_{E} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\n在分岔点处，$\\lambda = \\pm i \\omega_{0}$，其中振荡的起始频率 $\\omega_{0}$ 由 $\\omega_{0}^{2} = \\mathrm{Det}(J)|_{g_{E}=g_{E}^{\\mathrm{crit}}}$ 给出。使用迹条件 $\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$，我们可以将行列式表示为：\n$$\n\\mathrm{Det}(J)|_{\\mathrm{crit}} = -\\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^2 + \\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\n条件 $\\mathrm{Det}(J) > 0$ 确保了非零频率。对于 PING 机制，这由电路结构（$w_{EI}, w_{IE} > 0$）满足。因此，起始频率为：\n$$\n\\omega_0 = \\sqrt{\\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}} - \\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^{2}}\n$$\n\n**3. 极限环振幅缩放**\n问题指定了超临界霍普夫分岔。根据此类分岔的范式理论，新生的极限环的振幅与距分岔点的距离的平方根成比例。设分岔参数为 $\\mu = g_{E}(D) - g_{E}^{\\mathrm{crit}}$。当 $\\mu  0$ 时系统是稳定的，当 $\\mu > 0$ 时表现出振荡。\n\n分岔点附近振荡振幅 $r$ 的范式方程为：\n$$\n\\frac{dr}{dt} = \\alpha \\mu r - \\beta r^3 + O(r^5)\n$$\n其中 $\\alpha > 0$，且对于超临界分岔，$\\beta > 0$。S 型函数的三阶导数为负 ($S'''  0$) 的假设是确保 $\\beta > 0$ 的充分条件。\n极限环的稳态振幅通过设置 $\\frac{dr}{dt} = 0$ 求得：\n$$\nr(\\alpha \\mu - \\beta r^2) = 0\n$$\n当 $\\mu>0$ 时，这给出了一个 $r>0$ 的非平凡稳定解：\n$$\nr = \\sqrt{\\frac{\\alpha}{\\beta}} \\sqrt{\\mu}\n$$\n状态变量 $E(t)$ 和 $I(t)$ 中振荡的振幅与这个范式振幅 $r$ 成正比。因此，在 $(E,I)$ 相平面中极限环的峰-谷振幅（我们称之为 $A$）具有以下主阶依赖关系：\n$$\nA \\propto \\sqrt{g_{E}(D) - g_{E}^{\\mathrm{crit}}}\n$$\n此关系表明，当多巴胺 $D$ 使增益 $g_{E}(D)$ 增加到略高于临界阈值 $g_{E}^{\\mathrm{crit}}$ 时，节律生成开始，其振荡振幅从零平滑增长。",
            "answer": "$$\n\\boxed{\\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}}\n$$"
        },
        {
            "introduction": "最后的这个实践将深入探讨突触的生物物理细节如何调节现有振荡的频率。你将实现一个模型，以确定兴奋性突触上快速AMPA受体和慢速NMDA受体的相对贡献如何改变网络的有效时间尺度，从而影响其振荡频率。这个练习阐明了一个关键原则：单个突触组件的动力学特性是宏观网络行为的关键决定因素。",
            "id": "4011970",
            "problem": "您的任务是分析增加 N-甲基-D-天冬氨酸受体 (NMDA) 的贡献（由电导 $g_{\\mathrm{NMDA}}$ 和衰减常数 $\\tau_{\\mathrm{NMDA}}$ 参数化）如何改变锥体-中间神经元伽马机制中的有效兴奋性时间尺度，以及这种变化何时使网络从伽马节律转变为更慢的节律。考虑一个简化的线性时不变模型来描述兴奋性神经元群体的突触脉冲响应，该响应是代表 α-氨基-3-羟基-5-甲基-4-异恶唑丙酸 (AMPA) 和 NMDA 受体介导电流的指数衰减的加权和：\n$$\nK_E(t) = g_{\\mathrm{AMPA}}\\,e^{-t/\\tau_{\\mathrm{AMPA}}} + g_{\\mathrm{NMDA}}\\,e^{-t/\\tau_{\\mathrm{NMDA}}}, \\quad t \\ge 0,\n$$\n其中 $g_{\\mathrm{AMPA}}$ 和 $g_{\\mathrm{NMDA}}$ 是正常数电导（单位任意），$\\tau_{\\mathrm{AMPA}}$ 和 $\\tau_{\\mathrm{NMDA}}$ 是正常数衰减时间常数（单位为毫秒）。定义一个有效的单指数近似\n$$\nK_{\\mathrm{eff}}(t) = G\\,e^{-t/\\tau_{\\mathrm{eff}}}, \\quad t \\ge 0,\n$$\n该近似保留了 $K_E(t)$ 的零延迟振幅和总面积，其中 $G$ 和 $\\tau_{\\mathrm{eff}}$ 是待从第一性原理确定的有效振幅和有效时间尺度。\n\n假设锥体-中间神经元伽马机制的周期可以通过抑制性恢复时间、兴奋性招募延迟以及一个固定的传导延迟之和来近似：\n$$\nT_{\\mathrm{ms}} = k_I\\,\\tau_I + k_E\\,\\tau_{\\mathrm{eff}} + D,\n$$\n其中 $\\tau_I$ 是抑制性衰减常数（单位为毫秒），$k_I$ 和 $k_E$ 是无量纲正常数系数，反映了抑制性和兴奋性时间尺度对周期的贡献，$D$ 是一个固定延迟（单位为毫秒）。振荡频率（单位为赫兹）为\n$$\nf = \\frac{1000}{T_{\\mathrm{ms}}}.\n$$\n此处定义伽马节律为 $f \\ge 30$ 赫兹，较慢节律为 $f  30$ 赫兹。\n\n您的任务是：\n- 根据上述定义，通过保持脉冲响应的零延迟振幅和总面积守恒，推导出 $G$ 和 $\\tau_{\\mathrm{eff}}$。\n- 使用推导出的 $\\tau_{\\mathrm{eff}}$，为每个测试用例计算 $T_{\\mathrm{ms}}$ 和 $f$。\n- 为每个测试用例确定其节律是否慢于伽马节律（即 $f  30$）。\n\n所有时间单位为毫秒，所有频率单位为赫兹。将每个计算出的频率四舍五入到两位小数。对于每个测试用例，输出频率，后跟一个布尔值，指示节律是否慢于伽马节律。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，交替显示每个测试用例的频率和布尔值（例如，$[f_1,\\mathrm{bool}_1,f_2,\\mathrm{bool}_2,\\dots]$），其中布尔值为 Python 字面量。\n\n使用以下测试套件：\n1. 基线类伽马方案：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 0.1$, $\\tau_{\\mathrm{NMDA}} = 60.0$, $\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n2. 增加 NMDA 电导（衰减相同）：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 0.8$, $\\tau_{\\mathrm{NMDA}} = 60.0$, $\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n3. 增加 NMDA 衰减（电导相同）：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 0.8$, $\\tau_{\\mathrm{NMDA}} = 100.0$, $\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n4. 纯 AMPA 边界情况：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 0.0$, $\\tau_{\\mathrm{NMDA}} = 60.0$（当 $g_{\\mathrm{NMDA}}=0$ 时忽略），$\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n5. 极端 NMDA 方案：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 3.0$, $\\tau_{\\mathrm{NMDA}} = 150.0$, $\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n6. 衰减常数相等的边缘情况：$g_{\\mathrm{AMPA}} = 1.0$, $\\tau_{\\mathrm{AMPA}} = 2.0$, $g_{\\mathrm{NMDA}} = 2.0$, $\\tau_{\\mathrm{NMDA}} = 2.0$, $\\tau_I = 8.0$, $k_I = 1.0$, $k_E = 0.7$, $D = 4.0$。\n\n您的程序必须实现推导和计算，并按指定格式生成最终输出。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于计算神经科学的原理，特别是关于突触整合和网络振荡的原理。问题设定良好，提供了所有必需的参数和定义，构成了一个自洽且一致的数学练习。其中没有矛盾、歧义或事实不准确之处。任务是分析一个简化的突触动力学模型及其对网络节律性的影响，这是该领域一个标准且可验证的问题。\n\n问题的核心是用一个有效的单指数响应 $K_{\\mathrm{eff}}(t)$ 来近似一个双指数突触脉冲响应 $K_E(t)$。这种简化对于分析易处理性很有用，并且通过保留原始响应函数的关键属性而得到证明。需要守恒的两个属性是零延迟振幅（$t=0$）和曲线下面积（从 $t=0$ 到 $t=\\infty$ 的积分）。\n\n给定的兴奋性神经元群体的突触脉冲响应为：\n$$\nK_E(t) = g_{\\mathrm{AMPA}}\\,e^{-t/\\tau_{\\mathrm{AMPA}}} + g_{\\mathrm{NMDA}}\\,e^{-t/\\tau_{\\mathrm{NMDA}}}\n$$\n其中 $g_{\\mathrm{AMPA}}$ 和 $g_{\\mathrm{NMDA}}$ 是电导，$\\tau_{\\mathrm{AMPA}}$ 和 $\\tau_{\\mathrm{NMDA}}$ 分别是 AMPA 和 NMDA 受体介导电流的衰减时间常数。\n\n有效的单指数近似为：\n$$\nK_{\\mathrm{eff}}(t) = G\\,e^{-t/\\tau_{\\mathrm{eff}}}\n$$\n其中 $G$ 和 $\\tau_{\\mathrm{eff}}$ 是有效振幅和有效时间尺度。\n\n**步骤 1：推导有效参数 $G$ 和 $\\tau_{\\mathrm{eff}}$**\n\n首先，我们强制零延迟振幅守恒，这要求 $K_E(0) = K_{\\mathrm{eff}}(0)$。\n在时间 $t=0$ 时，指数项 $e^{-t/\\tau}$ 的值为 $1$。\n$$\nK_E(0) = g_{\\mathrm{AMPA}}\\,e^{-0/\\tau_{\\mathrm{AMPA}}} + g_{\\mathrm{NMDA}}\\,e^{-0/\\tau_{\\mathrm{NMDA}}} = g_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\n$$\n$$\nK_{\\mathrm{eff}}(0) = G\\,e^{-0/\\tau_{\\mathrm{eff}}} = G\n$$\n将这两个表达式相等，得到有效振幅 $G$ 的公式：\n$$\nG = g_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\n$$\n\n其次，我们强制总面积守恒，这代表了突触事件所转移的总电荷。这要求 $\\int_0^\\infty K_E(t) dt = \\int_0^\\infty K_{\\mathrm{eff}}(t) dt$。\n指数衰减函数 $A e^{-t/\\tau}$ 从 $t=0$ 到 $t=\\infty$ 的积分为：\n$$\n\\int_0^\\infty A\\,e^{-t/\\tau} dt = A \\left[ -\\tau\\,e^{-t/\\tau} \\right]_0^\\infty = A(-\\tau(0) - (-\\tau(1))) = A\\tau\n$$\n将此应用于 $K_E(t)$：\n$$\n\\int_0^\\infty K_E(t) dt = \\int_0^\\infty \\left( g_{\\mathrm{AMPA}}\\,e^{-t/\\tau_{\\mathrm{AMPA}}} + g_{\\mathrm{NMDA}}\\,e^{-t/\\tau_{\\mathrm{NMDA}}} \\right) dt = g_{\\mathrm{AMPA}}\\,\\tau_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\\,\\tau_{\\mathrm{NMDA}}\n$$\n对 $K_{\\mathrm{eff}}(t)$ 应用相同的积分：\n$$\n\\int_0^\\infty K_{\\mathrm{eff}}(t) dt = \\int_0^\\infty G\\,e^{-t/\\tau_{\\mathrm{eff}}} dt = G\\,\\tau_{\\mathrm{eff}}\n$$\n使总面积相等，得到：\n$$\nG\\,\\tau_{\\mathrm{eff}} = g_{\\mathrm{AMPA}}\\,\\tau_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\\,\\tau_{\\mathrm{NMDA}}\n$$\n现在，我们将先前推导出的 $G$ 的表达式代入此方程：\n$$\n(g_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}})\\,\\tau_{\\mathrm{eff}} = g_{\\mathrm{AMPA}}\\,\\tau_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\\,\\tau_{\\mathrm{NMDA}}\n$$\n解出 $\\tau_{\\mathrm{eff}}$，得到有效时间尺度的公式：\n$$\n\\tau_{\\mathrm{eff}} = \\frac{g_{\\mathrm{AMPA}}\\,\\tau_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}\\,\\tau_{\\mathrm{NMDA}}}{g_{\\mathrm{AMPA}} + g_{\\mathrm{NMDA}}}\n$$\n这个结果表明，有效时间常数是单个 AMPA 和 NMDA 时间常数的加权平均值，其中权重是它们各自的电导。这是一个关键的物理洞见：更强的电导对整体有效衰减时间的贡献更大。\n\n**步骤 2：计算振荡周期和频率**\n\n利用推导出的 $\\tau_{\\mathrm{eff}}$ 公式，我们可以使用给定的线性模型计算振荡周期 $T_{\\mathrm{ms}}$：\n$$\nT_{\\mathrm{ms}} = k_I\\,\\tau_I + k_E\\,\\tau_{\\mathrm{eff}} + D\n$$\n这里，$k_I\\,\\tau_I$ 代表由抑制性神经元群体恢复所决定的时间，$k_E\\,\\tau_{\\mathrm{eff}}$ 代表兴奋性招募的延迟，$D$ 是一个固定的传导延迟。所有单位均为毫秒 ($ms$)。\n\n振荡频率 $f$（单位为赫兹 $Hz$）是周期（单位为秒）的倒数。由于 $T_{\\mathrm{ms}}$ 以毫秒为单位，转换因子为 $1000$：\n$$\nf = \\frac{1000}{T_{\\mathrm{ms}}}\n$$\n\n**步骤 3：节律分类**\n\n如果 $f \\ge 30$ Hz，则节律被分类为伽马节律；如果 $f  30$ Hz，则被分类为较慢节律。在计算出频率后，对每个测试用例执行此二元分类。\n\n程序逻辑将通过将这些推导出的公式应用于每个提供的测试用例来继续进行，计算 $\\tau_{\\mathrm{eff}}$，然后是 $T_{\\mathrm{ms}}$，最后是 $f$。频率将四舍五入到两位小数，并评估布尔条件 $f  30$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates oscillation frequency and rhythm type for a simplified PING model\n    based on varying synaptic parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (g_ampa, tau_ampa, g_nmda, tau_nmda, tau_i, k_i, k_e, d)\n    test_cases = [\n        (1.0, 2.0, 0.1, 60.0, 8.0, 1.0, 0.7, 4.0),  # 1. Baseline gamma\n        (1.0, 2.0, 0.8, 60.0, 8.0, 1.0, 0.7, 4.0),  # 2. Increased g_NMDA\n        (1.0, 2.0, 0.8, 100.0, 8.0, 1.0, 0.7, 4.0), # 3. Increased tau_NMDA\n        (1.0, 2.0, 0.0, 60.0, 8.0, 1.0, 0.7, 4.0),  # 4. Pure AMPA\n        (1.0, 2.0, 3.0, 150.0, 8.0, 1.0, 0.7, 4.0), # 5. Extreme NMDA\n        (1.0, 2.0, 2.0, 2.0, 8.0, 1.0, 0.7, 4.0),    # 6. Equal decay consts\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        g_ampa, tau_ampa, g_nmda, tau_nmda, tau_i, k_i, k_e, d = case\n\n        # Step 1: Calculate the effective excitatory timescale tau_eff.\n        # tau_eff = (g_ampa*tau_ampa + g_nmda*tau_nmda) / (g_ampa + g_nmda)\n        # The sum of conductances is guaranteed to be positive by problem constraints\n        # (g_ampa > 0, g_nmda >= 0), so no division by zero check is needed.\n        numerator_tau_eff = g_ampa * tau_ampa + g_nmda * tau_nmda\n        denominator_tau_eff = g_ampa + g_nmda\n        tau_eff = numerator_tau_eff / denominator_tau_eff\n\n        # Step 2: Calculate the oscillation period T_ms.\n        # T_ms = k_I*tau_I + k_E*tau_eff + D\n        T_ms = k_i * tau_i + k_e * tau_eff + d\n\n        # Step 3: Calculate the frequency f in Hertz.\n        # f = 1000 / T_ms\n        # Since all parameters contributing to T_ms are positive, T_ms > 0.\n        freq_hz = 1000.0 / T_ms\n\n        # Step 4: Determine if the rhythm is slower than gamma (f  30 Hz).\n        is_slower_than_gamma = freq_hz  30.0\n\n        # Step 5: Format the frequency and append results.\n        # The problem requires rounding the frequency to two decimal places.\n        # Using an f-string with a format specifier is a robust way to do this.\n        formatted_freq = f\"{freq_hz:.2f}\"\n        \n        results.append(formatted_freq)\n        results.append(is_slower_than_gamma)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) will correctly convert the float strings and booleans.\n    # The required boolean format is Python's literal 'True' or 'False'.\n    output_str = \",\".join([str(item) for item in results])\n    print(f\"[{output_str}]\")\n\n# Execute the primary function\nsolve()\n```"
        }
    ]
}