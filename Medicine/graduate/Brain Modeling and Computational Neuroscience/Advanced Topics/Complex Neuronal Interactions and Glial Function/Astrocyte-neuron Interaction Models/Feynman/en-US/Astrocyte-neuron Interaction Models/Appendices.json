{
    "hands_on_practices": [
        {
            "introduction": "Astrocytes communicate with neurons by releasing chemical messengers called gliotransmitters, a process triggered by elevations in intracellular calcium ($Ca^{2+}$) concentration. The relationship between calcium levels and the rate of release is typically highly nonlinear and switch-like, a hallmark of cooperative binding. This exercise  guides you through the derivation of the Hill equation, a fundamental model for such cooperative processes, from simplified first principles. By analyzing this model, you will develop a quantitative understanding of how cooperativity shapes the activation threshold and dynamic range of astrocytic signaling.",
            "id": "3962909",
            "problem": "An astrocyte is modeled to release a gliotransmitter onto a nearby neuron in response to intracellular Calcium ion ($\\mathrm{Ca}^{2+}$) elevation. Assume the release machinery is an all-or-none cooperative $\\mathrm{Ca}^{2+}$ sensor that requires $n$ $\\mathrm{Ca}^{2+}$ ions to bind before release can occur. Let $K$ denote the equilibrium dissociation constant for $\\mathrm{Ca}^{2+}$ binding (assumed identical for each of the $n$ sites), and assume fast binding equilibrium compared to the timescale of release. Under this limit, the binding polynomial reduces to two dominant states: an unliganded state with statistical weight $K^{n}$ and a fully $n$-liganded state with statistical weight $[\\mathrm{Ca}^{2+}]^{n}$. The fraction of sensors in the fully liganded state is therefore the ratio of its weight to the sum of the two weights. Assume the instantaneous release rate is proportional to the fraction of fully liganded sensors, with proportionality constant $J_{\\max}$ representing the saturating release rate.\n\nStarting from these assumptions and the law of mass action, derive the functional dependence of the release rate on $[\\mathrm{Ca}^{2+}]$, and then define the normalized release $f([\\mathrm{Ca}^{2+}])$ as the release rate divided by $J_{\\max}$. Define the $10$–$90$ dynamic range in $\\mathrm{Ca}^{2+}$, denoted $r(n)$, as the ratio of the $\\mathrm{Ca}^{2+}$ concentration that produces $f=0.9$ to the concentration that produces $f=0.1$. Express $r(n)$ exactly in closed form as a function of $n$ only. Briefly analyze how changing $n$ modifies thresholding and dynamic range by examining the steepness of $f$ around its half-activation.\n\nReport $r(n)$ as your final answer. Because $r(n)$ is a ratio, it is dimensionless; do not include any units. No numerical rounding is required.",
            "solution": "The problem describes a simplified model for gliotransmitter release from an astrocyte, triggered by intracellular calcium, $[\\mathrm{Ca}^{2+}]$. The core of the model is a cooperative sensor that requires $n$ calcium ions to bind for activation.\n\nLet us formalize the given assumptions. The model simplifies the system to two dominant states: an unliganded sensor and a fully $n$-liganded sensor. The statistical weight of the unliganded state is given as $K^n$, and the statistical weight of the fully liganded state is given as $([\\mathrm{Ca}^{2+}])^n$. Here, $K$ represents the equilibrium dissociation constant for each binding site.\n\nThe fraction of sensors in the fully liganded state, which we denote as $P_{active}$, is given by the ratio of the statistical weight of the active state to the sum of the statistical weights of the two dominant states:\n$$P_{active} = \\frac{([\\mathrm{Ca}^{2+}])^n}{K^n + ([\\mathrm{Ca}^{2+}])^n}$$\n\nThe instantaneous release rate, which we denote as $J$, is proportional to this fraction, with a maximum rate $J_{\\max}$.\n$$J([\\mathrm{Ca}^{2+}]) = J_{\\max} \\cdot P_{active} = J_{\\max} \\frac{([\\mathrm{Ca}^{2+}])^n}{K^n + ([\\mathrm{Ca}^{2+}])^n}$$\nThis is the functional dependence of the release rate on the calcium concentration. This equation is a specific form of the Hill equation, where $n$ is the Hill coefficient representing the degree of cooperativity.\n\nThe problem then defines the normalized release rate, $f([\\mathrm{Ca}^{2+}])$, as the release rate $J$ divided by its maximum value $J_{\\max}$:\n$$f([\\mathrm{Ca}^{2+}]) = \\frac{J([\\mathrm{Ca}^{2+}])}{J_{\\max}} = \\frac{([\\mathrm{Ca}^{2+}])^n}{K^n + ([\\mathrm{Ca}^{2+}])^n}$$\n\nWe are tasked with finding the $10$–$90$ dynamic range, $r(n)$, which is defined as the ratio of the calcium concentration that yields $f=0.9$ to the concentration that yields $f=0.1$. Let us denote these concentrations as $[\\mathrm{Ca}^{2+}]_{0.9}$ and $[\\mathrm{Ca}^{2+}]_{0.1}$, respectively.\n\nFirst, we solve for $[\\mathrm{Ca}^{2+}]_{0.9}$ by setting $f([\\mathrm{Ca}^{2+}]_{0.9}) = 0.9$:\n$$0.9 = \\frac{([\\mathrm{Ca}^{2+}]_{0.9})^n}{K^n + ([\\mathrm{Ca}^{2+}]_{0.9})^n}$$\nMultiplying both sides by the denominator gives:\n$$0.9 \\left( K^n + ([\\mathrm{Ca}^{2+}]_{0.9})^n \\right) = ([\\mathrm{Ca}^{2+}]_{0.9})^n$$\n$$0.9 K^n + 0.9 ([\\mathrm{Ca}^{2+}]_{0.9})^n = ([\\mathrm{Ca}^{2+}]_{0.9})^n$$\nRearranging the terms to solve for $([\\mathrm{Ca}^{2+}]_{0.9})^n$:\n$$0.9 K^n = (1 - 0.9) ([\\mathrm{Ca}^{2+}]_{0.9})^n = 0.1 ([\\mathrm{Ca}^{2+}]_{0.9})^n$$\n$$([\\mathrm{Ca}^{2+}]_{0.9})^n = \\frac{0.9}{0.1} K^n = 9 K^n$$\nTaking the $n$-th root of both sides, we find:\n$$[\\mathrm{Ca}^{2+}]_{0.9} = (9 K^n)^{\\frac{1}{n}} = 9^{\\frac{1}{n}} K$$\n\nNext, we solve for $[\\mathrm{Ca}^{2+}]_{0.1}$ by setting $f([\\mathrm{Ca}^{2+}]_{0.1}) = 0.1$:\n$$0.1 = \\frac{([\\mathrm{Ca}^{2+}]_{0.1})^n}{K^n + ([\\mathrm{Ca}^{2+}]_{0.1})^n}$$\nFollowing a similar algebraic procedure:\n$$0.1 \\left( K^n + ([\\mathrm{Ca}^{2+}]_{0.1})^n \\right) = ([\\mathrm{Ca}^{2+}]_{0.1})^n$$\n$$0.1 K^n = (1 - 0.1) ([\\mathrm{Ca}^{2+}]_{0.1})^n = 0.9 ([\\mathrm{Ca}^{2+}]_{0.1})^n$$\n$$([\\mathrm{Ca}^{2+}]_{0.1})^n = \\frac{0.1}{0.9} K^n = \\frac{1}{9} K^n$$\nTaking the $n$-th root gives:\n$$[\\mathrm{Ca}^{2+}]_{0.1} = \\left( \\frac{1}{9} K^n \\right)^{\\frac{1}{n}} = \\left(\\frac{1}{9}\\right)^{\\frac{1}{n}} K = 9^{-\\frac{1}{n}} K$$\n\nThe dynamic range $r(n)$ is the ratio of these two concentrations:\n$$r(n) = \\frac{[\\mathrm{Ca}^{2+}]_{0.9}}{[\\mathrm{Ca}^{2+}]_{0.1}} = \\frac{9^{\\frac{1}{n}} K}{9^{-\\frac{1}{n}} K}$$\nThe constant $K$ cancels out, leaving an expression that depends only on $n$:\n$$r(n) = \\frac{9^{\\frac{1}{n}}}{9^{-\\frac{1}{n}}} = 9^{\\left(\\frac{1}{n} - (-\\frac{1}{n})\\right)} = 9^{\\left(\\frac{2}{n}\\right)}$$\n\nFor the brief analysis, we consider the steepness of the function $f$ at its half-activation point, which occurs at $[\\mathrm{Ca}^{2+}] = K$. The steepness is given by the derivative $\\frac{d f}{d[\\mathrm{Ca}^{2+}]}$ evaluated at this point. Letting $C = [\\mathrm{Ca}^{2+}]$, the derivative is:\n$$\\frac{df}{dC} = \\frac{d}{dC} \\left( \\frac{C^n}{K^n + C^n} \\right) = \\frac{n C^{n-1} (K^n + C^n) - C^n (n C^{n-1})}{(K^n + C^n)^2} = \\frac{n K^n C^{n-1}}{(K^n + C^n)^2}$$\nEvaluating at $C=K$:\n$$\\left.\\frac{df}{dC}\\right|_{C=K} = \\frac{n K^n K^{n-1}}{(K^n + K^n)^2} = \\frac{n K^{2n-1}}{(2K^n)^2} = \\frac{n K^{2n-1}}{4 K^{2n}} = \\frac{n}{4K}$$\nThe steepness is proportional to $n$. A larger $n$ (higher cooperativity) leads to a steeper, more switch-like response. This corresponds to a narrower dynamic range, as shown by our expression for $r(n) = 9^{2/n}$, which decreases as $n$ increases. Thus, a high cooperativity $n$ creates a sharp threshold for activation over a small range of calcium concentrations.\n\nThe final answer requested is the closed-form expression for $r(n)$.",
            "answer": "$$\\boxed{9^{\\frac{2}{n}}}$$"
        },
        {
            "introduction": "Beyond active signaling, astrocytes perform a crucial homeostatic role by clearing excess neurotransmitters like glutamate from the extracellular space. This function is vital for terminating synaptic transmission and preventing neuronal damage, and its impairment is linked to various neurological disorders. This practice models the clearance of glutamate by astrocytic transporters (EAATs), which follow Michaelis-Menten kinetics, balancing synaptic release with active uptake and passive diffusion. In this multi-step problem , you will mathematically connect a change at the molecular level—a reduction in transporter expression—to a dangerous pathological state, excitotoxicity, providing a clear example of how quantitative models can bridge cellular dysfunction and disease.",
            "id": "3962904",
            "problem": "Consider a point-synapse model in which astrocytic excitatory amino acid transporter (EAAT) uptake regulates the extracellular glutamate concentration, denoted $G(t)$ in units of $\\mu\\mathrm{M}$. Assume rapid synaptic release events are time-averaged into a constant mean glutamate influx $J_{\\mathrm{rel}}$ into an effective extrasynaptic volume. Glutamate is cleared by two processes: (i) EAAT uptake following Michaelis–Menten kinetics and (ii) linear diffusive clearance to the bulk extracellular space. The mass balance for $G(t)$ is\n$$\n\\frac{dG}{dt} \\;=\\; J_{\\mathrm{rel}} \\;-\\; \\frac{V_{\\max} \\, G}{K_m + G} \\;-\\; k_d \\, G,\n$$\nwhere $V_{\\max}$ is the maximal EAAT uptake rate, $K_m$ is the Michaelis constant of the transporter, and $k_d$ is the effective first-order rate constant for diffusive clearance.\n\nUse the following scientifically plausible parameter values:\n- $J_{\\mathrm{rel}} = 0.50\\,\\mu\\mathrm{M/s}$,\n- $K_m = 30\\,\\mu\\mathrm{M}$,\n- $k_d = 0.10\\,\\mathrm{s}^{-1}$.\n\nSuppose baseline EAAT expression yields $V_{\\max}^{\\mathrm{base}} = 4.0\\,\\mu\\mathrm{M/s}$, while reduced EAAT expression halves transporter density so that $V_{\\max}^{\\mathrm{red}} = 2.0\\,\\mu\\mathrm{M/s}$. Starting from the mass balance equation above and principles of enzyme-mediated transport and conservation of mass, first derive an explicit steady-state expression $G_{\\mathrm{ss}}(V_{\\max})$ that solves $\\frac{dG}{dt}=0$ in terms of $J_{\\mathrm{rel}}$, $K_m$, $k_d$, and $V_{\\max}$, and then evaluate $G_{\\mathrm{ss}}$ at $V_{\\max}^{\\mathrm{red}}$ to obtain the reduced-uptake steady state $G_{\\mathrm{ss}}^{\\mathrm{red}}$.\n\nTo evaluate excitotoxic risk, assume tonic activation of extrasynaptic N-methyl-D-aspartate (NMDA) receptors by the ambient glutamate $G_{\\mathrm{ss}}$ with the following simplified steady-state current model based on receptor binding and Ohm’s law:\n- The steady-state open fraction is $P_{\\mathrm{open}} = \\dfrac{G_{\\mathrm{ss}}}{K_d^{\\mathrm{NMDA}} + G_{\\mathrm{ss}}}$ with $K_d^{\\mathrm{NMDA}} = 2.0\\,\\mu\\mathrm{M}$,\n- The total NMDA conductance is $g_{\\mathrm{NMDA}} = 2.0\\,\\mathrm{nS}$,\n- The magnesium block factor at the membrane potential is a constant $B = 0.23$,\n- The membrane potential is $V = -40\\,\\mathrm{mV}$ and the NMDA reversal potential is $E_{\\mathrm{NMDA}} = 0\\,\\mathrm{mV}$.\n\nThe tonic NMDA current is then\n$$\nI_{\\mathrm{tonic}} \\;=\\; g_{\\mathrm{NMDA}} \\, B \\, P_{\\mathrm{open}} \\, (V - E_{\\mathrm{NMDA}}).\n$$\nDefine the dimensionless excitotoxic risk index as $R = \\dfrac{I_{\\mathrm{tonic}}}{I_{\\mathrm{th}}}$, where the excitotoxic threshold current is $I_{\\mathrm{th}} = 10\\,\\mathrm{pA}$. Using $G_{\\mathrm{ss}}^{\\mathrm{red}}$ obtained above, compute $R$ under reduced EAAT expression and report only this value. Express the final result as a dimensionless number and round to $4$ significant figures.",
            "solution": "The first step is to derive the expression for the steady-state glutamate concentration, $G_{\\mathrm{ss}}$, by setting the time derivative in the mass balance equation to zero:\n$$\n\\frac{dG}{dt} = 0\n$$\nThis yields the algebraic equation:\n$$\n0 \\;=\\; J_{\\mathrm{rel}} \\;-\\; \\frac{V_{\\max} \\, G_{\\mathrm{ss}}}{K_m + G_{\\mathrm{ss}}} \\;-\\; k_d \\, G_{\\mathrm{ss}}\n$$\nTo solve for $G_{\\mathrm{ss}}$, we first eliminate the fraction by multiplying all terms by $(K_m + G_{\\mathrm{ss}})$:\n$$\n0 \\;=\\; J_{\\mathrm{rel}}(K_m + G_{\\mathrm{ss}}) \\;-\\; V_{\\max} \\, G_{\\mathrm{ss}} \\;-\\; k_d \\, G_{\\mathrm{ss}}(K_m + G_{\\mathrm{ss}})\n$$\nExpanding the terms, we get:\n$$\n0 \\;=\\; J_{\\mathrm{rel}}K_m + J_{\\mathrm{rel}}G_{\\mathrm{ss}} \\;-\\; V_{\\max} G_{\\mathrm{ss}} \\;-\\; k_d K_m G_{\\mathrm{ss}} \\;-\\; k_d G_{\\mathrm{ss}}^2\n$$\nWe can rearrange this into a standard quadratic equation of the form $a x^2 + b x + c = 0$, where $x = G_{\\mathrm{ss}}$:\n$$\nk_d G_{\\mathrm{ss}}^2 + (V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) G_{\\mathrm{ss}} - J_{\\mathrm{rel}}K_m = 0\n$$\nThe coefficients of this quadratic equation are:\n- $a = k_d$\n- $b = V_{\\max} + k_d K_m - J_{\\mathrm{rel}}$\n- $c = -J_{\\mathrm{rel}}K_m$\n\nUsing the quadratic formula, $G_{\\mathrm{ss}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, the solution is:\n$$\nG_{\\mathrm{ss}} = \\frac{-(V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) \\pm \\sqrt{(V_{\\max} + k_d K_m - J_{\\mathrm{rel}})^2 - 4(k_d)(-J_{\\mathrm{rel}}K_m)}}{2k_d}\n$$\nSimplifying the term under the square root:\n$$\nG_{\\mathrm{ss}}(V_{\\max}) = \\frac{-(V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) \\pm \\sqrt{(V_{\\max} + k_d K_m - J_{\\mathrm{rel}})^2 + 4k_d J_{\\mathrm{rel}}K_m}}{2k_d}\n$$\nSince glutamate concentration must be a non-negative physical quantity ($G_{\\mathrm{ss}} \\ge 0$), and all parameters ($k_d, J_{\\mathrm{rel}}, K_m$) are positive, we must choose the root that yields a positive result. The term $4k_d J_{\\mathrm{rel}}K_m$ is positive, so the square root term is real and greater in magnitude than $|V_{\\max} + k_d K_m - J_{\\mathrm{rel}}|$. Consequently, choosing the minus sign in the numerator would result in a negative value for $G_{\\mathrm{ss}}$. Therefore, we must take the plus sign for the physically valid solution. This provides the explicit steady-state expression $G_{\\mathrm{ss}}(V_{\\max})$.\n\nNext, we evaluate $G_{\\mathrm{ss}}$ for the reduced uptake case, $G_{\\mathrm{ss}}^{\\mathrm{red}}$, by substituting $V_{\\max} = V_{\\max}^{\\mathrm{red}} = 2.0\\,\\mu\\mathrm{M/s}$ and the other given parameter values:\n- $J_{\\mathrm{rel}} = 0.50\\,\\mu\\mathrm{M/s}$\n- $K_m = 30\\,\\mu\\mathrm{M}$\n- $k_d = 0.10\\,\\mathrm{s}^{-1}$\n\nThe coefficients of the quadratic equation become:\n- $a = 0.10$\n- $b = 2.0 + (0.10)(30) - 0.50 = 2.0 + 3.0 - 0.50 = 4.5$\n- $c = -(0.50)(30) = -15$\n\nSubstituting these into the quadratic formula:\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + \\sqrt{(4.5)^2 - 4(0.10)(-15)}}{2(0.10)}\n$$\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + \\sqrt{20.25 + 6}}{0.2} = \\frac{-4.5 + \\sqrt{26.25}}{0.2}\n$$\nNumerically, $\\sqrt{26.25} \\approx 5.123475$.\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + 5.123475}{0.2} = \\frac{0.623475}{0.2} = 3.117375\\,\\mu\\mathrm{M}\n$$\nNow, we compute the NMDA receptor open fraction, $P_{\\mathrm{open}}$, using this steady-state glutamate concentration and $K_d^{\\mathrm{NMDA}} = 2.0\\,\\mu\\mathrm{M}$:\n$$\nP_{\\mathrm{open}} = \\frac{G_{\\mathrm{ss}}^{\\mathrm{red}}}{K_d^{\\mathrm{NMDA}} + G_{\\mathrm{ss}}^{\\mathrm{red}}} = \\frac{3.117375}{2.0 + 3.117375} = \\frac{3.117375}{5.117375} \\approx 0.609190\n$$\nNext, we calculate the tonic NMDA current, $I_{\\mathrm{tonic}}$. The driving force is $(V - E_{\\mathrm{NMDA}}) = (-40\\,\\mathrm{mV} - 0\\,\\mathrm{mV}) = -40\\,\\mathrm{mV}$.\n$$\nI_{\\mathrm{tonic}} = g_{\\mathrm{NMDA}} \\, B \\, P_{\\mathrm{open}} \\, (V - E_{\\mathrm{NMDA}})\n$$\n$$\nI_{\\mathrm{tonic}} = (2.0\\,\\mathrm{nS})(0.23)(0.609190)(-40\\,\\mathrm{mV})\n$$\nNoting that $1\\,\\mathrm{nS} \\times 1\\,\\mathrm{mV} = 1\\,\\mathrm{pA}$:\n$$\nI_{\\mathrm{tonic}} = (2.0 \\times 0.23 \\times 0.609190 \\times -40)\\,\\mathrm{pA} \\approx -11.2091\\,\\mathrm{pA}\n$$\nThe negative sign indicates an inward current (net influx of positive charge), which is the biophysical basis for excitotoxicity. The excitotoxic risk index, $R$, is defined as the ratio of this current to a threshold current, $I_{\\mathrm{th}} = 10\\,\\mathrm{pA}$. As a risk index is a non-negative measure of potential harm, and the threshold $I_{\\mathrm{th}}$ is given as a positive value, the physically correct interpretation is to compare the magnitude of the inward current to the threshold.\n$$\nR = \\frac{|I_{\\mathrm{tonic}}|}{I_{\\mathrm{th}}} = \\frac{|-11.2091\\,\\mathrm{pA}|}{10\\,\\mathrm{pA}} = 1.12091\n$$\nFinally, the problem requires rounding the result to $4$ significant figures.\n$$\nR \\approx 1.121\n$$",
            "answer": "$$\n\\boxed{1.121}\n$$"
        },
        {
            "introduction": "Astrocytic functions, such as the buffering of extracellular potassium ($K^{+}$), do not merely influence individual synapses but can profoundly shape the collective behavior of entire neural networks. As neurons fire, they release $K^{+}$ ions, and an accumulation of extracellular $K^{+}$ can increase network excitability, affecting phenomena like information processing and seizure dynamics. This advanced practice involves a computational simulation of a spatially extended neural network where neuronal activity and extracellular potassium are dynamically coupled. By implementing and analyzing this model , you will gain hands-on experience exploring how the astrocyte's capacity for potassium buffering influences the propagation and stability of activity waves across a neural circuit.",
            "id": "3962880",
            "problem": "Consider a ring network of purely excitatory neurons interacting with astrocytes via extracellular potassium (K) buffering. The ring is modeled as a one-dimensional periodic lattice with $N$ sites and spacing $\\Delta x$, indexed by $i = 0,1,\\dots,N-1$. Each site $i$ contains a neuronal firing-rate variable $u_i(t)$ and an extracellular potassium concentration variable $k_i(t)$. The astrocytic buffering strength is represented by a rate parameter $\\gamma \\ge 0$. The neuronal interactions are spatially local and excitatory, and extracellular potassium diffuses along the ring and is taken up by astrocytes according to a linear sink term.\n\nThe neuronal dynamics are given by a Wilson–Cowan-type mean-field firing-rate equation with sigmoidal gain, modulated by extracellular potassium. Specifically, for $i \\in \\{0,\\dots,N-1\\}$,\n$$\n\\tau \\frac{d u_i}{d t} = - u_i + S\\!\\left( J \\sum_{j=0}^{N-1} W_{ij} u_j - \\theta + \\beta \\left(k_i - k_0\\right) \\right),\n$$\nwhere $S(x) = \\frac{1}{1 + e^{-a x}}$ is a sigmoidal input-output function with slope parameter $a > 0$, $J > 0$ is the excitatory coupling strength, $W_{ij}$ is a normalized periodic Gaussian kernel over the ring, $\\theta$ is an effective threshold, $\\beta$ is the gain of potassium modulation, and $k_0$ is the baseline extracellular potassium concentration. The dynamics of extracellular potassium obey a discrete reaction–diffusion equation with production proportional to neuronal activity and linear astrocyte buffering:\n$$\n\\frac{d k_i}{d t} = D_K \\frac{k_{i+1} - 2 k_i + k_{i-1}}{(\\Delta x)^2} - \\gamma \\left(k_i - k_0\\right) + \\eta u_i,\n$$\nwith periodic boundary conditions $k_{-1} \\equiv k_{N-1}$ and $k_{N} \\equiv k_{0}$. Here, $D_K$ is the effective diffusion coefficient, and $\\eta$ scales activity-dependent potassium release. The discrete Laplacian implements conservation of ions (diffusive flux proportional to concentration gradients), while the linear sink $-\\gamma(k_i - k_0)$ models net astrocyte uptake around the baseline concentration, and the source $\\eta u_i$ models neuronal release proportional to firing activity.\n\nFundamental bases and assumptions:\n- Charge and mass conservation lead to diffusion dynamics for ions in extracellular space, represented discretely by the second difference operator.\n- Astrocytic buffering is modeled as a first-order linear relaxation to baseline, a standard approximation for net uptake by inward-rectifying potassium channels and transporters.\n- Mean-field neuronal firing-rate dynamics follow Wilson–Cowan principles, where the rate relaxes to a sigmoidal function of total input combining synaptic excitation and modulatory potassium effects.\n\nThe ring kernel $W_{ij}$ is defined by a periodic Gaussian of width $\\sigma_W$:\n$$\nW_{ij} = \\frac{1}{Z} \\exp\\!\\left( - \\frac{d(i,j)^2}{2 \\sigma_W^2} \\right),\n$$\nwhere $d(i,j)$ is the minimal ring distance and $Z$ normalizes $\\sum_{j} W_{ij} = 1$ for each $i$.\n\nInitialization:\n- Neuronal activity is initially localized as a Gaussian bump centered at index $i=0$:\n$$\nu_i(0) = \\exp\\!\\left( -\\frac{d(i,0)^2}{2 \\sigma_0^2} \\right).\n$$\n- Extracellular potassium starts at baseline:\n$$\nk_i(0) = k_0.\n$$\n\nPropagation speed and stability assessment:\n- Propagation speed is defined via threshold-crossing times of neuronal activity. For a chosen activity threshold $u_{\\mathrm{th}}$, the first crossing time $t_i$ at site $i$ is the smallest $t$ such that $u_i(t)$ crosses $u_{\\mathrm{th}}$ from below. If fewer than half of the sites cross the threshold, the propagation speed is defined to be $0$. Otherwise, compute the average forward nearest-neighbor crossing time difference $\\Delta t$ along contiguous segments where $t_{i+1} - t_i > 0$, and define the speed as $v = \\frac{\\Delta x}{\\Delta t}$, expressed in sites per second (n/s).\n- Stability is defined as the boolean condition that the system returns near baseline after the burst and remains bounded. Specifically, stability is true if, at the final simulation time $T_{\\mathrm{end}}$, the spatial averages satisfy $\\frac{1}{N}\\sum_i u_i(T_{\\mathrm{end}}) \\le \\varepsilon_u$ and $\\frac{1}{N}\\sum_i |k_i(T_{\\mathrm{end}}) - k_0| \\le \\varepsilon_k$, and the maximum activity over space and time does not saturate, i.e., $\\max_{i,t} u_i(t) < u_{\\max}$. Otherwise, stability is false.\n\nImplementation requirements:\n- Discretize the ring with $N$ sites and implement the dynamics as an Ordinary Differential Equation (ODE) system of dimension $2N$ using a suitable ODE solver for a time interval $[0, T_{\\mathrm{end}}]$.\n- Use scientifically plausible parameter values and report speeds in sites per second (n/s). Angles are not used; all quantities are dimensionless except time in seconds, and speed in n/s.\n- Threshold-crossing times must be computed using monotonic from-below crossings and linear interpolation between sampled times if needed.\n\nParameters:\n- $N = 128$, $\\Delta x = 1$.\n- $\\tau = 0.02$ s, $a = 4.0$, $J = 1.1$, $\\theta = 1.5$, $\\beta = 1.0$, $k_0 = 3.5$, $\\sigma_W = 2.0$, $\\sigma_0 = 2.0$.\n- $D_K = 0.08$, $\\eta = 0.5$.\n- Threshold $u_{\\mathrm{th}} = 0.5$, stability tolerances $\\varepsilon_u = 0.05$, $\\varepsilon_k = 0.01$, saturation bound $u_{\\max} = 0.99$.\n- Final time $T_{\\mathrm{end}} = 1.5$ s.\n\nTest suite:\nEvaluate the system for the following astrocyte buffering rates (covering baseline, impaired, and extreme edge case):\n1. $\\gamma = 1.0$ (baseline intact buffering).\n2. $\\gamma = 0.2$ (impaired buffering).\n3. $\\gamma = 0.0$ (no buffering, edge case).\n\nProgram output specification:\nYour program should simulate the ODE for each value of $\\gamma$, compute the propagation speed $v$ (in n/s) and the stability boolean for that case, and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a two-element list of the form $[v,\\mathrm{stable}]$. For example, the output format must be exactly of the form:\n$$\n\\texttt{[[v\\_1,True],[v\\_2,False],[v\\_3,True]]}\n$$\nwith floats for $v_i$ and booleans for stability. There must be no additional text in the output line.",
            "solution": "The problem requires simulating a ring network of $N$ neurons interacting with astrocytes. The state of the system at each of the $N$ sites is described by a neuronal firing rate $u_i(t)$ and an extracellular potassium concentration $k_i(t)$. The entire system is thus described by a set of $2N$ coupled ordinary differential equations (ODEs). We will solve this system numerically and then analyze the solution to determine the propagation speed of activity waves and the stability of the network for different values of the astrocyte potassium buffering rate, $\\gamma$.\n\n**1. Model Implementation and Discretization**\n\nThe system is defined by two sets of equations for $i = 0, \\dots, N-1$:\n$$\n\\tau \\frac{d u_i}{d t} = - u_i + S\\!\\left( J \\sum_{j=0}^{N-1} W_{ij} u_j - \\theta + \\beta \\left(k_i - k_0\\right) \\right)\n$$\n$$\n\\frac{d k_i}{d t} = D_K \\frac{k_{i+1} - 2 k_i + k_{i-1}}{(\\Delta x)^2} - \\gamma \\left(k_i - k_0\\right) + \\eta u_i\n$$\nTo implement this numerically, we represent the state of the system as a single vector $\\mathbf{y}(t)$ of size $2N$, where the first $N$ elements are the firing rates $\\mathbf{u}(t) = [u_0, u_1, \\dots, u_{N-1}]^T$ and the next $N$ elements are the potassium concentrations $\\mathbf{k}(t) = [k_0, k_1, \\dots, k_{N-1}]^T$. The ODE system can be written as $\\frac{d\\mathbf{y}}{dt} = F(t, \\mathbf{y})$.\n\nThe synaptic coupling term $\\sum_{j=0}^{N-1} W_{ij} u_j$ is a matrix-vector product, $\\mathbf{W}\\mathbf{u}$. The weight matrix $\\mathbf{W}$ is constructed based on the periodic Gaussian kernel. The distance $d(i, j)$ on a ring of size $N$ is given by $d(i,j) = \\min(|i-j|, N - |i-j|)$. The matrix $\\mathbf{W}$ with elements $W_{ij}$ is pre-computed and normalized such that each row sums to $1$.\n\nThe discrete Laplacian for the potassium dynamics, $\\frac{k_{i+1} - 2k_i + k_{i-1}}{(\\Delta x)^2}$, is implemented efficiently using vectorized operations. With periodic boundary conditions, $k_{i+1}$ and $k_{i-1}$ can be accessed for the entire vector $\\mathbf{k}$ using circular shift operations, for which `numpy.roll` is well-suited.\n\n**2. Numerical Integration**\n\nThe system of ODEs is solved using the `solve_ivp` function from the `scipy.integrate` library. This function is a robust, general-purpose ODE solver. We use the 'RK45' method (an explicit Runge-Kutta method of order 5(4)), which is a good default choice for non-stiff problems like this one. We enable the `dense_output=True` option, which provides an interpolation function for the solution. This is crucial for accurately determining the threshold-crossing times required for the speed calculation, as it allows us to evaluate the solution at any point within the integration interval, not just at the discrete steps taken by the solver. For analysis, the solution is sampled on a fine, uniform time grid.\n\n**3. Analysis of Propagation Speed**\n\nThe propagation speed $v$ is calculated based on the times at which the neuronal activity $u_i(t)$ at each site $i$ first crosses a threshold $u_{\\mathrm{th}} = 0.5$ from below.\n\nThe algorithm is as follows:\n1.  For each site $i \\in \\{0, \\dots, N-1\\}$, find the first time $t_i$ where $u_i(t)$ crosses $u_{\\mathrm{th}}$. This is done by scanning the fine-grained time series `u_sol[i, :]`. When a crossing is detected between time steps $t_j$ and $t_{j+1}$, linear interpolation is used to find a more precise crossing time: $t_{\\text{cross}} = t_j + (t_{j+1} - t_j) \\frac{u_{\\mathrm{th}} - u_i(t_j)}{u_i(t_{j+1}) - u_i(t_j)}$. If no crossing occurs, $t_i$ is considered infinite.\n2.  If the number of sites that cross the threshold is less than half the network size ($N/2$), the activity bump is considered to have failed to propagate, and the speed $v$ is defined as $0$.\n3.  Due to the symmetric setup (initial condition at $i=0$ and symmetric kernel), we expect two waves propagating in opposite directions. We analyze the wave traveling in the positive direction (from $i=0$ towards $i=N/2$).\n4.  We compute the time differences $\\Delta t_i = t_{i+1} - t_i$ for $i=0, \\dots, N/2-1$.\n5.  Following the problem's definition, we only consider \"forward\" propagation steps, where $\\Delta t_i > 0$. The average of these positive time differences gives the mean inter-site propagation time, $\\Delta t = \\langle \\Delta t_i \\rangle_{\\Delta t_i > 0}$.\n6.  The final speed is $v = \\frac{\\Delta x}{\\Delta t}$. Since $\\Delta x = 1$, this simplifies to $v = 1/\\Delta t$.\n\n**4. Analysis of Stability**\n\nThe stability is a boolean property determined at the end of the simulation, $T_{\\mathrm{end}} = 1.5$ s. The system is deemed stable if and only if all three of the following conditions are met:\n1.  The spatially-averaged neuronal activity has returned to a low baseline: $\\frac{1}{N}\\sum_i u_i(T_{\\mathrm{end}}) \\le \\varepsilon_u$, with $\\varepsilon_u = 0.05$.\n2.  The spatially-averaged deviation of potassium from its baseline has settled: $\\frac{1}{N}\\sum_i |k_i(T_{\\mathrm{end}}) - k_0| \\le \\varepsilon_k$, with $\\varepsilon_k = 0.01$.\n3.  The neuronal activity did not saturate during the entire simulation: $\\max_{i,t} u_i(t) < u_{\\max}$, with $u_{\\max} = 0.99$.\n\n**5. Execution Flow**\n\nThe main program iterates through the specified values of the astrocyte buffering rate $\\gamma = \\{1.0, 0.2, 0.0\\}$. For each $\\gamma$:\n1.  The initial conditions are set: a Gaussian bump for $u_i(0)$ centered at $i=0$ and a uniform baseline for $k_i(0)$.\n2.  The ODE system is integrated from $t=0$ to $t=T_{\\mathrm{end}}$.\n3.  The resulting time series for $\\mathbf{u}(t)$ and $\\mathbf{k}(t)$ are passed to the analysis functions to calculate the propagation speed $v$ and the stability boolean.\n4.  The pair $[v, \\text{stability}]$ is stored.\n5.  Finally, the collected results for all $\\gamma$ values are formatted into the precise string specified in the problem statement and printed.\n\nThis structured approach ensures that the simulation and analysis are performed exactly as described, leading to a verifiable and reproducible result based on the principles of numerical analysis and computational modeling.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the neuron-astrocyte ring model ODE system and analyzes\n    the propagation speed and stability for different astrocyte\n    potassium buffering rates.\n    \"\"\"\n    \n    # Define the test cases and parameters from the problem statement.\n    test_cases = [1.0, 0.2, 0.0]  # Values for gamma\n\n    # System parameters\n    N = 128\n    dx = 1.0\n    tau = 0.02\n    a = 4.0\n    J = 1.1\n    theta = 1.5\n    beta = 1.0\n    k0 = 3.5\n    sigma_W = 2.0\n    sigma_0 = 2.0\n    D_K = 0.08\n    eta = 0.5\n    \n    # Analysis parameters\n    u_th = 0.5\n    eps_u = 0.05\n    eps_k = 0.01\n    u_max = 0.99\n    \n    # Simulation parameters\n    T_end = 1.5\n    \n    # --- Pre-computation ---\n\n    # 1. Connectivity Matrix W\n    indices = np.arange(N)\n    dist_matrix = np.abs(indices[:, None] - indices[None, :])\n    dist_matrix = np.minimum(dist_matrix, N - dist_matrix)\n    W_unnormalized = np.exp(-(dist_matrix**2) / (2.0 * sigma_W**2))\n    Z = np.sum(W_unnormalized, axis=1, keepdims=True)\n    W = W_unnormalized / Z\n\n    # 2. Initial Conditions\n    dist_from_0 = np.minimum(indices, N - indices)\n    u_init = np.exp(-(dist_from_0**2) / (2.0 * sigma_0**2))\n    k_init = np.full(N, k0)\n    y0 = np.concatenate([u_init, k_init])\n\n    # --- ODE System and Analysis Functions ---\n\n    def dydt(t, y, gamma_val):\n        \"\"\"The ODE system function for the ring model.\"\"\"\n        u, k = y[:N], y[N:]\n        \n        # Neuronal dynamics (Wilson-Cowan type)\n        synaptic_input = J * (W @ u)\n        total_input = synaptic_input - theta + beta * (k - k0)\n        S_val = 1.0 / (1.0 + np.exp(-a * total_input))\n        dudt = (-u + S_val) / tau\n\n        # Potassium dynamics (Reaction-Diffusion)\n        laplacian_k = (np.roll(k, -1) - 2.0 * k + np.roll(k, 1)) / (dx**2)\n        dkdt = D_K * laplacian_k - gamma_val * (k - k0) + eta * u\n        \n        return np.concatenate([dudt, dkdt])\n\n    def calculate_speed(t_sol, u_sol):\n        \"\"\"Calculates propagation speed from threshold-crossing times.\"\"\"\n        crossing_times = np.full(N, np.inf)\n        for i in range(N):\n            u_i = u_sol[i, :]\n            # Find all indices where u_i crosses u_th from below\n            cross_indices = np.where((u_i[:-1] < u_th) & (u_i[1:] >= u_th))[0]\n            \n            if cross_indices.size > 0:\n                # Take the first crossing\n                j = cross_indices[0] + 1\n                u1, u2 = u_i[j-1], u_i[j]\n                t1, t2 = t_sol[j-1], t_sol[j]\n                \n                # Perform linear interpolation for precise crossing time\n                if u2 > u1:\n                    t_cross = t1 + (t2 - t1) * (u_th - u1) / (u2 - u1)\n                    crossing_times[i] = t_cross\n        \n        num_crossings = np.sum(np.isfinite(crossing_times))\n        if num_crossings < N / 2:\n            return 0.0\n        \n        # Analyze right-propagating wave (i=0 to N/2) due to symmetry\n        time_diffs = []\n        for i in range(N // 2):\n            t_curr = crossing_times[i]\n            t_next = crossing_times[i+1]\n            # Collect positive time differences for forward propagation\n            if np.isfinite(t_curr) and np.isfinite(t_next) and (t_next > t_curr):\n                time_diffs.append(t_next - t_curr)\n        \n        if not time_diffs:\n            return 0.0\n        \n        avg_dt = np.mean(time_diffs)\n        speed = dx / avg_dt\n        return speed\n\n    def check_stability(u_sol, k_sol):\n        \"\"\"Checks if the system meets the stability criteria.\"\"\"\n        u_final_avg = np.mean(u_sol[:, -1])\n        k_final_dev_avg = np.mean(np.abs(k_sol[:, -1] - k0))\n        u_global_max = np.max(u_sol)\n        \n        stable = (u_final_avg <= eps_u) and \\\n                 (k_final_dev_avg <= eps_k) and \\\n                 (u_global_max < u_max)\n        return stable\n\n    # --- Main Simulation Loop ---\n    \n    results = []\n    for gamma in test_cases:\n        # Solve the ODE system for the current gamma\n        sol = solve_ivp(\n            fun=dydt,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',\n            args=(gamma,),\n            dense_output=True\n        )\n\n        # Evaluate the solution on a fine grid for analysis\n        t_eval = np.linspace(0, T_end, 2000)\n        y_eval = sol.sol(t_eval)\n        u_sol = y_eval[:N, :]\n        k_sol = y_eval[N:, :]\n\n        # Perform analyses\n        speed = calculate_speed(t_eval, u_sol)\n        stability = check_stability(u_sol, k_sol)\n        \n        results.append([speed, stability])\n\n    # Format and print the final output string exactly as specified.\n    inner_parts = [f\"[{v},{s}]\" for v, s in results]\n    final_string = f\"[{','.join(inner_parts)}]\"\n    print(final_string)\n\nsolve()\n```"
        }
    ]
}