{
    "hands_on_practices": [
        {
            "introduction": "神经胶质细胞最广为人知的功能之一是形成髓鞘，从而实现动作电位的跳跃式传导。然而，髓鞘并非越厚越好。本练习将引导您通过一个经典的生物物理模型，探索髓鞘厚度与轴突直径之间的权衡关系。通过最大化传导速度，您将推导出著名的g比率（g-ratio）的最优值，深入理解神经系统在进化压力下如何精密地优化其结构以实现高效信号传输。",
            "id": "3984427",
            "problem": "考虑一个有髓鞘轴突，其纤维外半径 $r_{\\mathrm{fiber}}$ 由胶质细胞包裹设定，其轴突（内）半径 $r_{\\mathrm{axon}}$ 由发育和可塑性控制。定义g-比率 $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$。假设跳跃式传导通过轴浆中的轴向电流对下游一个结间段的膜进行充电，并将每个结间段的总延迟模型化为主要由一个结间段上的轴浆电阻与髓鞘的有效结间段电容的电阻-电容乘积决定。使用电缆理论和膜生物物理学的以下基本要素：\n\n- 长度为 $\\ell$ 的轴浆电阻为 $R_{i}(\\ell) = \\rho_{i} \\ell / (\\pi r_{\\mathrm{axon}}^{2})$，其中 $\\rho_{i}$ 是轴浆电阻率。\n- 长度为 $\\ell$ 的有效结间段电容为 $C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell \\, c_{\\mathrm{eff}}$，其中 $c_{\\mathrm{eff}}$ 是多层髓鞘叠层的有效比电容。将髓鞘视为 $N$ 个串联的电容器，每个双分子层具有比电容 $c_{0}$ 和鞘层厚度 $\\delta$，因此 $N = (r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})/\\delta$ 且 $c_{\\mathrm{eff}} = c_{0}/N$。\n- 结间段长度与纤维半径成线性关系，$\\ell = k_{\\ell} r_{\\mathrm{fiber}}$，其中 $k_{\\ell}$ 是一个无量纲比例常数。\n- 传导速度与结间段长度除以电阻-电容延迟成正比，$v = \\alpha \\, \\ell / (R_{i}(\\ell) \\, C_{\\mathrm{int}}(\\ell))$，其中 $\\alpha$ 是一个捕捉郎飞氏结处阈值动力学的无量纲比例因子。\n\n中枢神经系统（CNS）环境施加了一个单位长度纤维体积固定的约束，该体积与 $r_{\\mathrm{fiber}}^{2}$ 成正比；因此，在优化 $g$ 时，$r_{\\mathrm{fiber}}$ 保持固定。\n\n从这些基础出发，推导 $v$ 作为 $g$ 和 $r_{\\mathrm{fiber}}$ 的函数，然后在 $r_{\\mathrm{fiber}}$ 固定的约束下，确定使 $v$ 最大化的 $g$ 值。最后，使用以下生物物理参数值，\n$\\rho_{i} = 0.7 \\ \\Omega \\cdot \\mathrm{m}$，$c_{0} = 0.01 \\ \\mathrm{F/m}^{2}$，$\\delta = 8 \\times 10^{-9} \\ \\mathrm{m}$，$k_{\\ell} = 200$，$\\alpha = 1$，以及 $r_{\\mathrm{fiber}} = 5 \\times 10^{-6} \\ \\mathrm{m}$，\n计算预测的最优 $g$。\n\n最终答案以小数形式表示，并四舍五入到四位有效数字。最终答案必须是一个不带单位的数字。",
            "solution": "用户要求我在尝试解决问题之前，对问题陈述进行严格验证。\n\n### 第一步：提取已知条件\n问题提供了以下定义、关系和常数：\n- **g-比率：** $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$，其中 $r_{\\mathrm{axon}}$ 是轴突半径，$r_{\\mathrm{fiber}}$ 是纤维外半径。\n- **轴浆电阻：** 长度为 $\\ell$ 的电阻是 $R_{i}(\\ell) = \\frac{\\rho_{i} \\ell}{\\pi r_{\\mathrm{axon}}^{2}}$，其中 $\\rho_{i}$ 是轴浆电阻率。\n- **结间段电容：** 长度为 $\\ell$ 的电容是 $C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell \\, c_{\\mathrm{eff}}$，其中 $c_{\\mathrm{eff}}$ 是有效比电容。\n- **有效比电容：** $c_{\\mathrm{eff}} = c_{0}/N$，其中 $c_{0}$ 是单个双分子层的比电容，$N$ 是髓鞘层数。\n- **髓鞘层数：** $N = \\frac{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}{\\delta}$，其中 $\\delta$ 是鞘层厚度。\n- **结间段长度：** $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$，其中 $k_{\\ell}$ 是一个无量纲比例常数。\n- **传导速度：** $v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)}$，其中 $\\alpha$ 是一个无量纲比例因子。\n- **约束：** 纤维半径 $r_{\\mathrm{fiber}}$ 保持固定。\n- **参数值：** $\\rho_{i} = 0.7 \\ \\Omega \\cdot \\mathrm{m}$，$c_{0} = 0.01 \\ \\mathrm{F/m}^{2}$，$\\delta = 8 \\times 10^{-9} \\ \\mathrm{m}$，$k_{\\ell} = 200$，$\\alpha = 1$，以及 $r_{\\mathrm{fiber}} = 5 \\times 10^{-6} \\ \\mathrm{m}$。\n- **目标：** 首先，推导 $v$ 作为 $g$ 和 $r_{\\mathrm{fiber}}$ 的函数。其次，找到使 $v$ 最大化的 $g$ 值。第三，使用给定的参数计算这个最优 $g$ 值，四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是计算神经科学中一个经典的生物物理建模练习。\n- **科学依据（关键）：** 该问题基于电缆理论和有髓鞘轴突生物物理学的简化但标准的模型（例如，Rushton模型）。所有原理在该领域都是公认的。\n- **良构的：** 问题提供了明确的目标（最大化速度 $v$）和一套明确的控制方程和约束。待最大化的函数定义明确，预期有唯一解。\n- **客观性（关键）：** 问题以精确、定量的术语陈述，没有主观或模糊的语言。\n- **完整性和一致性：** 问题提供了构建速度函数和执行优化所需的所有必要方程、变量和常数。“单位长度纤维体积固定”被正确地转化为 $r_{\\mathrm{fiber}}$ 固定的约束。\n- **真实性：** 设置和参数值在哺乳动物中枢神经系统神经元的生物物理学合理值范围内。\n\n该问题没有表现出验证标准中列出的任何缺陷。它是一个可形式化的、科学上合理的、良构的优化问题。\n\n### 第三步：结论与行动\n问题有效。我现在开始求解。\n\n### 传导速度的推导\n任务是求出传导速度 $v$ 作为g-比率 $g$ 和纤维半径 $r_{\\mathrm{fiber}}$ 的函数。我们从给定的速度表达式开始：\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)}$$\n我们将把提供的表达式代入各项。\n\n首先，让我们用基本参数来表示电容 $C_{\\mathrm{int}}(\\ell)$。\n髓鞘层数是 $N = \\frac{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}{\\delta}$。\n有效比电容是 $c_{\\mathrm{eff}} = \\frac{c_{0}}{N} = \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}$。\n将此代入结间段电容 $C_{\\mathrm{int}}(\\ell)$ 的表达式：\n$$C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell c_{\\mathrm{eff}} = 2 \\pi r_{\\mathrm{fiber}} \\ell \\left( \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\n现在，我们可以组合乘积 $R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)$，它代表结间段充电的时间常数：\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\left( \\frac{\\rho_{i} \\ell}{\\pi r_{\\mathrm{axon}}^{2}} \\right) \\left( 2 \\pi r_{\\mathrm{fiber}} \\ell \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\n简化此表达式：\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}$$\n现在，将此代回速度 $v$ 的方程中：\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)} = \\frac{\\alpha \\ell}{\\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta \\ell r_{\\mathrm{fiber}}}$$\n问题陈述结间段长度 $\\ell$ 与纤维半径成比例：$\\ell = k_{\\ell} r_{\\mathrm{fiber}}$。将此代入 $\\ell$：\n$$v = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta (k_{\\ell} r_{\\mathrm{fiber}}) r_{\\mathrm{fiber}}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\n这是用 $r_{\\mathrm{axon}}$ 和 $r_{\\mathrm{fiber}}$ 表示的速度。下一步是用g-比率 $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$ 来表示它，这意味着 $r_{\\mathrm{axon}} = g r_{\\mathrm{fiber}}$。\n$$v = \\frac{\\alpha (g r_{\\mathrm{fiber}})^{2}(r_{\\mathrm{fiber}} - g r_{\\mathrm{fiber}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{2} r_{\\mathrm{fiber}}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\n分子和分母中的 $r_{\\mathrm{fiber}}^{2}$ 项相消：\n$$v(g, r_{\\mathrm{fiber}}) = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{3}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}} g^{2}(1 - g)$$\n这是 $v$ 作为 $g$ 和 $r_{\\mathrm{fiber}}$ 的函数的最终表达式。\n\n### 传导速度的优化\n问题要求在 $r_{\\mathrm{fiber}}$ 固定的约束下，找到使 $v$ 最大化的 $g$ 值。我们可以将 $v$ 的表达式视为仅关于 $g$ 的函数，即 $v(g)$。\n我们定义一个常数 $K$ 来组合所有固定参数：\n$$K = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}}$$\n$K$ 中的所有项都是正常数，所以 $K > 0$。速度函数为：\n$$v(g) = K g^{2}(1 - g) = K(g^{2} - g^{3})$$\n对于一个有物理意义的有髓鞘轴突，g-比率必须在区间 $g \\in (0, 1)$ 内。在边界处，$v(0) = 0$ 和 $v(1) = 0$。为了找到此区间内的最大值，我们对 $v(g)$ 关于 $g$ 求导，并令其为零：\n$$\\frac{dv}{dg} = \\frac{d}{dg} [K(g^{2} - g^{3})] = K(2g - 3g^{2})$$\n令导数为零以找到临界点：\n$$K(2g - 3g^{2}) = 0$$\n因为 $K \\neq 0$，我们有：\n$$2g - 3g^{2} = 0 \\implies g(2 - 3g) = 0$$\n这产生两个解：$g = 0$ 和 $g = \\frac{2}{3}$。如前所述，$g=0$ 对应于最小速度 $0$。非平凡解是 $g = 2/3$。\n为了确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^{2}v}{dg^{2}} = \\frac{d}{dg} [K(2g - 3g^{2})] = K(2 - 6g)$$\n在 $g = 2/3$ 处计算二阶导数：\n$$\\left. \\frac{d^{2}v}{dg^{2}} \\right|_{g=2/3} = K\\left(2 - 6\\left(\\frac{2}{3}\\right)\\right) = K(2 - 4) = -2K$$\n因为 $K > 0$，二阶导数为负，确认 $g = 2/3$ 对应一个局部最大值。由于它是区间 $(0, 1)$ 内唯一的临界点，因此是全局最大值。\n\n### 最优g-比率的计算\n根据这个模型，使传导速度最大化的最优g-比率是 $g = 2/3$。这个结果与所有特定的生物物理参数值（$\\rho_{i}$、$c_{0}$、$\\delta$、$k_{\\ell}$、$\\alpha$ 和 $r_{\\mathrm{fiber}}$）无关。这些值是计算最大速度 $v_{\\mathrm{max}}$ 所需的，但计算最优比率 $g$ 则不需要。\n问题要求给出最优 $g$ 的数值，并四舍五入到四位有效数字。\n$$g = \\frac{2}{3} = 0.666666...$$\n四舍五入到四位有效数字，我们得到 $0.6667$。",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "髓鞘的有效性不仅取决于其厚度，还依赖于其与轴突连接的特殊结构的完整性，即旁结区（paranodal region）。这些连接起着“电学密封”的作用，防止电流泄漏。本练习将运用线性电缆理论，模拟旁结区粘连失效导致的电流分流现象。您将计算导致传导阻滞的临界漏电导，从而量化分析特定胶质-轴突连接的破坏如何导致神经信号传递失败。",
            "id": "3984506",
            "problem": "您的任务是设计一个基于原理的计算模型，该模型能够捕捉有髓轴突结旁区（隔状连接样连接）的胶质-轴突粘连被破坏时如何引入电流泄漏，从而可能导致传导阻滞。该建模框架必须从连接两个连续郎飞结的有髓节间的一维线性电缆描述开始。将轴浆视为具有细胞质电阻率的欧姆介质，并将被髓鞘包裹的节间膜视为一个有效的漏泄边界。将结旁粘连失效建模为两个相同的集总分路电导，分别位于节间的两端，并与节间膜通路并联。假设准静态传播足以分析从一个节点到下一个节点的振幅传递，而无需显式地对时间依赖性离子门控进行建模。允许并要求使用以下基本基础：\n- 控制被动电压沿均匀一维电缆扩展的线性电缆方程。\n- 根据细胞质电阻率和横截面积定义的单位长度轴向电阻 $r_{\\mathrm{a}}$。\n- 单位长度膜电导 $g_{\\mathrm{m}}$ 的定义及其通过 $r_{\\mathrm{m}} = 1/g_{\\mathrm{m}}$ 与单位长度膜电阻 $r_{\\mathrm{m}}$ 的关系。\n- 沿均匀被动电缆的准静态电压传递表现为指数衰减，其特征是一个取决于 $r_{\\mathrm{m}}$ 和 $r_{\\mathrm{a}}$ 的长度常数。\n您的程序必须为每个测试案例计算每端最小相同结旁分路电导，记为 $g_{\\mathrm{pn}}^\\star$（单位为西门子），其存在将下一节点的电压振幅精确降低到指定的锋电位起始阈值，从而标志着传导阻滞的边界。如果在给定参数下，传导在基线状态（$g_{\\mathrm{pn}} = 0$）时已经发生阻滞，您必须为该案例返回 $0.0$。使用一个数学上一致的近似方法，该方法将两端的分路电导对替换为对均匀泄漏的等效调整，该调整足以确定达到阈值所需的衰减；确保推导过程遵循电缆方程和电流守恒定律。\n\n定义与参数化：\n- 设节间长度为 $L$（单位：米）。\n- 设轴突半径为 $a$（单位：米）。\n- 设细胞质电阻率为 $\\rho_{\\mathrm{i}}$（单位：欧姆·米）。\n- 设单位长度的有效髓鞘相关膜电导为 $g_{\\mathrm{m}}$（单位：西门子/米）。\n- 设峰值结区去极化为 $V_{\\mathrm{peak}}$（单位：伏特）。\n- 设下一个节点产生锋电位所需的最小去极化为 $V_{\\mathrm{thr}}$（单位：伏特）。\n- 设单位长度的轴向电阻为 $r_{\\mathrm{a}}$，其中 $r_{\\mathrm{a}} = \\rho_{\\mathrm{i}}/(\\pi a^2)$（单位：欧姆/米）。\n- 结旁区破坏引入了两个相同的电导为 $g_{\\mathrm{pn}}$（单位：西门子）的分路，位于节间的两端。您必须计算阈值 $g_{\\mathrm{pn}}^\\star$。\n\n传导阻滞标准：\n- 当到达下一个节点的振幅等于 $V_{\\mathrm{thr}}$ 时，传导被视为阻滞；任何超过 $g_{\\mathrm{pn}}^\\star$ 的额外泄漏都会使传导保持阻滞状态，而任何低于 $g_{\\mathrm{pn}}^\\star$ 的泄漏则允许高于 $V_{\\mathrm{thr}}$ 的传输。\n\n要求输出与单位：\n- 对每个测试案例，以浮点数形式输出 $g_{\\mathrm{pn}}^\\star$，单位为西门子（S）。\n- 每个结果用科学记数法表示，保留六位有效数字。\n- 程序中使用的物理单位：米（m）、欧姆·米（$\\Omega\\cdot\\mathrm{m}$）、西门子（S）、伏特（V）。\n- 不涉及角度。\n\n测试套件（每个案例是一个元组 $(L,a,\\rho_{\\mathrm{i}},g_{\\mathrm{m}},V_{\\mathrm{peak}},V_{\\mathrm{thr}})$）：\n1. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 4\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-7}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n2. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 3\\times 10^{-7}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-4}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n3. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 2\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 4.6469\\times 10^{-5}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n4. $(5\\times 10^{-3}\\ \\mathrm{m},\\ 8\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-7}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是相应测试案例计算出的 $g_{\\mathrm{pn}}^\\star$，单位为西门子（S），并以科学记数法格式化，保留六位有效数字。程序必须是自包含的，并且不需要任何输入。",
            "solution": "用户提供的问题已经过验证，并被确定为 **有效**。该问题在科学上基于线性电缆理论的原理，问题设定良好（well-posed），具有明确的目标和充足的参数，并且陈述客观。因此，我们可以着手提供完整的解决方案。\n\n该问题要求我们计算在有髓轴突节间中引起传导阻滞的最小结旁分路电导 $g_{\\mathrm{pn}}^\\star$。模型是一个长度为 $L$ 的一维被动电缆，代表节间。传导阻滞被定义为这样的条件：在近端 $V(0)$ 电压为 $V_{\\mathrm{peak}}$ 的情况下，节间远端 $V(L)$ 的电压下降到锋电位起始阈值 $V_{\\mathrm{thr}}$。\n\n问题的核心在于将被动电缆的特性与从一个节点到下一个节点的电压衰减联系起来。沿均匀被动电缆的准静态电压 $V(x)$ 由线性电缆方程控制：\n$$ \\frac{d^2V}{dx^2} - \\frac{r_{\\mathrm{a}}}{r_{\\mathrm{m}}}V = 0 \\quad \\text{或} \\quad \\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V = 0 $$\n其中 $r_{\\mathrm{a}}$ 是单位长度的轴向电阻，$r_{\\mathrm{m}}$ 是单位长度的膜电阻，$\\lambda = \\sqrt{r_{\\mathrm{m}}/r_{\\mathrm{a}}}$ 是空间常数。问题以电导形式提供参数，因此我们使用 $g_{\\mathrm{m}} = 1/r_{\\mathrm{m}}$，即单位长度的膜电导。因此，空间常数可以写为 $\\lambda = 1/\\sqrt{r_{\\mathrm{a}}g_{\\mathrm{m}}}$。\n\n对于长度为 $L$ 的有限电缆，在 $x=0$ 处输入电压为 $V(0) = V_{\\mathrm{peak}}$，并假设位于 $x=L$ 的下一个节点作为高阻抗负载（近似于密封末端边界条件，$\\frac{dV}{dx}|_{x=L} = 0$），电缆方程的解为：\n$$ V(x) = V_{\\mathrm{peak}} \\frac{\\cosh((L-x)/\\lambda)}{\\cosh(L/\\lambda)} $$\n因此，到达下一个节点（位于 $x=L$）的电压为：\n$$ V(L) = \\frac{V_{\\mathrm{peak}}}{\\cosh(L/\\lambda)} $$\n这个方程描述了跨节间的电压衰减。\n\n问题引入了一个关键的简化：位于节间两端的两个集总分路电导 $g_{\\mathrm{pn}}$ 可以通过对均匀膜泄漏进行等效调整来建模。节间的总泄漏电导是分布的髓鞘泄漏与两个分路之和。\n原始的总髓鞘泄漏电导为 $G_{\\mathrm{m}} = g_{\\mathrm{m}} L$。\n总分路电导为 $G_{\\mathrm{pn}} = 2 g_{\\mathrm{pn}}$。\n病理状态下节间的有效总电导为 $G_{\\mathrm{eff}} = G_{\\mathrm{m}} + G_{\\mathrm{pn}} = g_{\\mathrm{m}} L + 2 g_{\\mathrm{pn}}$。\n\n为了创建一个等效的均匀电缆，我们将这个有效总电导“涂抹”在长度 $L$ 上，定义一个有效的单位长度膜电导 $g'_{\\mathrm{m}}$：\n$$ g'_{\\mathrm{m}} = \\frac{G_{\\mathrm{eff}}}{L} = \\frac{g_{\\mathrm{m}} L + 2 g_{\\mathrm{pn}}}{L} = g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}}{L} $$\n这个新的均匀电缆有一个新的、更短的有效空间常数 $\\lambda'$：\n$$ \\lambda' = \\frac{1}{\\sqrt{r_{\\mathrm{a}} g'_{\\mathrm{m}}}} = \\frac{1}{\\sqrt{r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}}{L}\\right)}} $$\n当下一个节点的电压等于阈值，即 $V(L) = V_{\\mathrm{thr}}$ 时，对于临界分路电导 $g_{\\mathrm{pn}} = g_{\\mathrm{pn}}^\\star$，传导阻滞标准得到满足。使用带有有效空间常数 $\\lambda'$ 的电压衰减公式：\n$$ V_{\\mathrm{thr}} = \\frac{V_{\\mathrm{peak}}}{\\cosh(L/\\lambda')} $$\n重新整理这个方程，我们可以求解电缆所需的属性：\n$$ \\cosh(L/\\lambda') = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}} $$\n对两边取反双曲余弦，得到：\n$$ \\frac{L}{\\lambda'} = \\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right) $$\n代入 $\\lambda'$ 的表达式：\n$$ L \\sqrt{r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L}\\right)} = \\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right) $$\n现在我们可以求解 $g_{\\mathrm{pn}}^\\star$。将两边平方并重新整理：\n$$ L^2 r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L}\\right) = \\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2 $$\n$$ g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L} = \\frac{1}{L^2 r_{\\mathrm{a}}} \\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2 $$\n$$ \\frac{2 g_{\\mathrm{pn}}^\\star}{L} = \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 r_{\\mathrm{a}}} - g_{\\mathrm{m}} $$\n$$ g_{\\mathrm{pn}}^\\star = \\frac{L}{2} \\left( \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 r_{\\mathrm{a}}} - g_{\\mathrm{m}} \\right) $$\n单位长度的轴向电阻 $r_{\\mathrm{a}}$ 由轴突的几何形状和细胞质电阻率给出：\n$$ r_{\\mathrm{a}} = \\frac{\\rho_{\\mathrm{i}}}{\\pi a^2} $$\n如果在基线状态（即 $g_{\\mathrm{pn}} = 0$ 时）传导已经受阻，则会出现一个特殊情况。这种情况发生在到达下一个节点的电压已经等于或低于阈值时，即 $V(L)_{\\text{baseline}} \\le V_{\\mathrm{thr}}$。在这种情况下，从公式计算出的 $g_{\\mathrm{pn}}^\\star$ 将小于或等于 $0$。由于被动电导不能为负，引起阻滞所需的最小*附加*电导为 $0$。因此，最终结果是：\n$$ g_{\\mathrm{pn}}^\\star = \\max\\left(0, \\frac{L}{2} \\left( \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 \\left(\\frac{\\rho_{\\mathrm{i}}}{\\pi a^2}\\right)} - g_{\\mathrm{m}} \\right)\\right) $$\n该公式将应用于每个测试案例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational neuroscience problem for a set of test cases.\n    \"\"\"\n\n    # Test suite: each case is a tuple (L, a, rho_i, g_m, V_peak, V_thr)\n    # Units: L (m), a (m), rho_i (ohm*m), g_m (S/m), V_peak (V), V_thr (V)\n    test_cases = [\n        (1e-3, 4e-6, 0.7, 1e-7, 0.1, 0.02),\n        (1e-3, 3e-7, 0.7, 1e-4, 0.1, 0.02),\n        (1e-3, 2e-6, 0.7, 4.6469e-5, 0.1, 0.02),\n        (5e-3, 8e-6, 0.7, 1e-7, 0.1, 0.02)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, a, rho_i, g_m, V_peak, V_thr = case\n\n        # The voltage ratio R must be >= 1 for arccosh to be real.\n        # This is guaranteed as V_peak >= V_thr for a meaningful problem.\n        if V_peak < V_thr:\n            # If peak voltage is less than threshold, propagation always fails.\n            # Minimal required shunt conductance is 0.\n            result = 0.0\n        else:\n            # Calculate axial resistance per unit length (r_a)\n            # r_a = rho_i / (pi * a^2)\n            r_a = rho_i / (np.pi * a**2)\n\n            # Voltage ratio\n            R = V_peak / V_thr\n\n            # The full formula for g_pn_star derived from the cable equation and\n            # the approximation of smearing the shunt conductance.\n            # g_pn_star = (L/2) * ( (arccosh(R)^2 / (L^2 * r_a)) - g_m )\n            \n            # The term in the parentheses represents the required additional\n            # conductance per unit length, delta_g_m.\n            # delta_g_m = g'_m - g_m\n            # where g'_m is the total effective conductance per unit length\n            # needed to cause block.\n            arccosh_R_sq = np.arccosh(R)**2\n            \n            term_in_parenthesis = (arccosh_R_sq / (L**2 * r_a)) - g_m\n\n            # If the term is negative, it means the baseline conductance g_m is\n            # already greater than the conductance required for block (g'_m).\n            # Thus, the internode is already blocking, and the minimum *additional*\n            # shunt conductance to cause block is 0.\n            if term_in_parenthesis < 0:\n                result = 0.0\n            else:\n                result = (L / 2.0) * term_in_parenthesis\n\n        results.append(result)\n\n    # Format the results into a comma-separated string,\n    # with each value in scientific notation with 6 significant digits.\n    # The format specifier \"{:.5e}\" gives 1 digit before the decimal and\n    # 5 after, for a total of 6 significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "神经胶质细胞的功能远不止形成髓鞘。本计算练习将我们的焦点转向星形胶质细胞及其在突触通讯中的核心作用——神经递质清除。通过建立一个包含扩散和膜转运蛋白吸收的数学模型，您将分析星形胶质细胞的几何形态和转运蛋白效率如何共同决定谷氨酸的清除速率。这对于理解突触信号的时间精度和防止神经元过度兴奋至关重要。",
            "id": "3984493",
            "problem": "考虑谷氨酸在邻近突触周星形胶质细胞突起的细胞外微域中的局部释放。假设该微域是径向对称的，呈球形或圆柱形，并且包裹该微域的星形胶质细胞膜上富含兴奋性氨基酸转运体（EAAT）蛋白，这些蛋白形成一个部分吸收边界。从扩散和质量守恒的基本定义出发，使用带有代表转运体介导摄取的 Robin（混合）边界条件的扩散方程来模拟谷氨酸浓度 $C(\\mathbf{x},t)$。\n\n基本原理和假设：\n- Fickian 扩散：$\\,\\dfrac{\\partial C}{\\partial t} = D \\nabla^2 C\\,$，其中 $D$ 是扩散系数。\n- 在星形胶质细胞膜上的部分吸收边界：$\\,D\\,\\dfrac{\\partial C}{\\partial n}\\big|_{\\partial \\Omega} + k_m\\, C\\big|_{\\partial \\Omega} = 0\\,$，其中 $\\dfrac{\\partial}{\\partial n}$ 是在边界 $\\partial \\Omega$ 上的外法向导数，而 $k_m$ 是一个有效的摄取系数（量纲为长度/时间），它综合了转运体密度和单个转运体动力学。\n- 释放中心的对称性：对于径向几何形状，在 $r=0$ 处为零通量。\n\n我们旨在求解主导清除时间常数 $\\,\\tau\\,$，它表征了细胞外总谷氨酸的渐近衰减。在这些假设下，该衰减由服从上述 Robin 边界条件的扩散算子的最慢衰减本征模所决定。在径向对称几何中，分离变量法将问题简化为找到满足边界方程的最小正空间本征值参数 $\\,x\\,$，然后计算\n$$\n\\tau \\;=\\; \\frac{1}{\\alpha_1} \\;=\\; \\frac{R^2}{D\\,x^2},\n$$\n其中 $R$ 是微域半径，$\\alpha_1$ 是主导衰减率。\n\n对于球形微域（半径为 $R$ 的三维球体），最慢的径向模式满足本征值条件\n$$\nx \\cos x \\;+\\; (\\beta - 1)\\, \\sin x \\;=\\; 0,\n$$\n其中 $\\,x = k R\\,$ 且 $\\,\\beta = \\dfrac{k_m R}{D}\\,$。对于圆柱形微域（具有轴向不变性的二维圆盘横截面），本征值条件是\n$$\n\\beta\\, J_0(x) \\;-\\; x\\, J_1(x) \\;=\\; 0,\n$$\n其中 $J_0$ 和 $J_1$ 是第一类贝塞尔函数，且 $\\,x = \\lambda R\\,$。在这两种情况下，衰减率均为 $\\,\\alpha_1 = D\\,x^2 / R^2\\,$，清除时间常数为 $\\,\\tau = R^2 / (D\\,x^2)\\,$。如果 $\\,k_m = 0\\,$（完全反射边界），则常数模式产生 $\\,\\alpha_1 = 0\\,$，清除时间为无穷大。\n\n你的程序必须：\n- 对每个测试用例，使用带区间限定的稳健一维求根方法，数值求解相应本征值方程的最小正根 $\\,x > 0\\,$。\n- 假设使用下面指定的微米和毫秒单位，计算相应的清除时间常数 $\\,\\tau\\,$（以毫秒为单位）。\n- 处理 $\\,k_m = 0\\,$ 的极限情况，此时返回 $\\,\\tau\\,$ 为 $+\\infty$。\n\n单位：\n- 长度使用微米（$\\mu\\text{m}$），时间使用毫秒（$\\text{ms}$）。\n- 扩散系数 $D$ 的单位必须是 $\\mu\\text{m}^2/\\text{ms}$。\n- 摄取系数 $k_m$ 的单位必须是 $\\mu\\text{m}/\\text{ms}$。\n- 半径 $R$ 的单位必须是 $\\mu\\text{m}$。\n- 将所有 $\\,\\tau\\,$ 的输出表示为浮点数，单位为 $\\text{ms}$。\n\n测试套件：\n为以下参数集提供结果，涵盖不同的几何形状、摄取强度和边界情况。\n- 情况 $1$ (理想情况，球形，中等摄取)：几何形状 = 球形, $D = 0.4$ $\\mu\\text{m}^2/\\text{ms}$, $R = 0.5$ $\\mu\\text{m}$, $k_m = 0.05$ $\\mu\\text{m}/\\text{ms}$。\n- 情况 $2$ (球形，强摄取，近狄利克雷条件)：几何形状 = 球形, $D = 0.4$, $R = 0.5$, $k_m = 10.0$。\n- 情况 $3$ (圆柱形，中等摄取)：几何形状 = 圆柱形, $D = 0.4$, $R = 0.5$, $k_m = 0.05$。\n- 情况 $4$ (圆柱形，强摄取，近狄利克雷条件)：几何形状 = 圆柱形, $D = 0.4$, $R = 0.5$, $k_m = 10.0$。\n- 情况 $5$ (球形，极弱摄取，近反射条件)：几何形状 = 球形, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$。\n- 情况 $6$ (圆柱形，极弱摄取，近反射条件)：几何形状 = 圆柱形, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$。\n- 情况 $7$ (球形，较小几何)：几何形状 = 球形, $D = 0.4$, $R = 0.2$, $k_m = 0.05$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是相应测试用例的清除时间常数 $\\,\\tau\\,$（单位为 $\\text{ms}$），顺序与上文相同。例如，输出必须具有以下形式\n$$\n[\\tau_1,\\tau_2,\\tau_3,\\tau_4,\\tau_5,\\tau_6,\\tau_7].\n$$",
            "solution": "我们从有界微域 $\\Omega$（边界为 $\\partial \\Omega$）中的 Fickian 扩散和质量平衡出发。浓度 $C(\\mathbf{x},t)$ 根据以下方程演化\n$$\n\\frac{\\partial C}{\\partial t} = D \\nabla^2 C,\n$$\n其中 $D$ 是扩散系数。突触周星形胶质细胞膜上的转运体被建模为 Robin 型的部分吸收边界条件，\n$$\nD\\,\\frac{\\partial C}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, C\\Big|_{\\partial \\Omega} = 0,\n$$\n其中 $\\dfrac{\\partial}{\\partial n}$ 是外法向导数，摄取系数 $k_m$ 将转运体密度和单个转运体动力学集总为一个与局部浓度成正比的有效通量。该边界条件是反应边界的标准条件，并确保了量纲一致性：$D$ 的单位是 $\\mu\\text{m}^2/\\text{ms}$，$\\dfrac{\\partial C}{\\partial n}$ 的单位是 $\\text{浓度}/\\mu\\text{m}$，$k_m$ 的单位是 $\\mu\\text{m}/\\text{ms}$，因此两项都具有通量单位 $\\text{浓度}\\cdot\\mu\\text{m}/\\text{ms}$。\n\n为了表征谷氨酸的清除，我们研究了总质量 $M(t) = \\int_{\\Omega} C(\\mathbf{x},t)\\, dV$ 的渐近衰减。在没有体积反应的情况下，衰减完全由边界摄取产生。分离变量法产生模态解\n$$\nC(\\mathbf{x},t) = f(\\mathbf{x})\\, e^{-\\alpha t},\n$$\n其中空间模式 $f$ 求解亥姆霍兹方程\n$$\n\\nabla^2 f + \\kappa^2 f = 0,\\quad \\text{with}\\quad \\kappa^2 = \\frac{\\alpha}{D},\n$$\n并服从 Robin 边界条件\n$$\nD\\,\\frac{\\partial f}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, f\\Big|_{\\partial \\Omega} = 0.\n$$\n在径向对称几何（球形或圆柱形）中，主导模式没有角度依赖性。其时间衰减率 $\\alpha_1$ 由最小的允许正值 $\\kappa^2$ 给出（因此也是无量纲边界条件中最小的正值 $x$），清除时间常数为\n$$\n\\tau = \\frac{1}{\\alpha_1} = \\frac{R^2}{D\\,x^2}.\n$$\n\n球形几何：\n对于半径为 $R$ 的球体，球对称解与球贝塞尔函数 $j_0(x) = \\dfrac{\\sin x}{x}$ 成正比，边界条件变为\n$$\nD\\,\\frac{\\partial}{\\partial r} j_0(k r)\\Big|_{r=R} + k_m\\, j_0(k R) = 0.\n$$\n使用 $j_0'(x) = \\frac{x\\cos x - \\sin x}{x^2}$ 和 $\\frac{\\partial}{\\partial r} j_0(k r) = k\\, j_0'(k r)$，我们得到\n$$\nD\\,k\\, j_0'(k R) + k_m\\, j_0(k R) = 0.\n$$\n定义无量纲参数 $\\beta = \\dfrac{k_m R}{D}$ 和 $x = k R$。两边乘以 $\\dfrac{R}{D}$ 并化简得到\n$$\nx \\cos x + (\\beta - 1)\\,\\sin x = 0.\n$$\n该方程的最小正根 $x_1$ 决定了主导衰减率 $\\alpha_1 = D\\,x_1^2 / R^2$，因此清除时间为 $\\tau = R^2 / (D\\,x_1^2)$。两个极限情况提供了物理直觉：\n- 弱摄取 ($\\beta \\ll 1$)：展开 $\\sin x \\approx x - \\frac{x^3}{6}$，$\\cos x \\approx 1 - \\frac{x^2}{2}$，得到\n$$\nx \\left(1 - \\frac{x^2}{2}\\right) + (\\beta - 1)\\left(x - \\frac{x^3}{6}\\right) \\approx \\beta x - x^3\\,\\frac{\\beta + 2}{6} = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{6\\beta}{\\beta + 2} \\approx 3\\beta,\n$$\n所以\n$$\n\\alpha_1 \\approx \\frac{D\\,(3\\beta)}{R^2} = \\frac{3\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{3\\,k_m}.\n$$\n- 强摄取 ($\\beta \\gg 1$)：方程趋向于 $\\sin x \\approx 0$，因此 $x_1 \\approx \\pi$，得到\n$$\n\\alpha_1 \\approx \\frac{D\\,\\pi^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,\\pi^2}.\n$$\n\n圆柱形几何：\n对于轴向不变的圆柱体（半径为 $R$ 的圆盘横截面），径向模式由贝塞尔函数 $J_0(\\lambda r)$ 给出。边界条件\n$$\nD\\,\\frac{\\partial}{\\partial r} J_0(\\lambda r)\\Big|_{r=R} + k_m\\, J_0(\\lambda R) = 0\n$$\n使用 $\\frac{\\partial}{\\partial r} J_0(\\lambda r) = -\\lambda J_1(\\lambda r)$，因此\n$$\n- D\\,\\lambda\\, J_1(\\lambda R) + k_m\\, J_0(\\lambda R) = 0.\n$$\n设 $x = \\lambda R$ 和 $\\beta = \\dfrac{k_m R}{D}$，\n$$\n\\beta\\, J_0(x) - x\\, J_1(x) = 0.\n$$\n和之前一样，$\\alpha_1 = D\\,x_1^2 / R^2$ 且 $\\tau = R^2 / (D\\,x_1^2)$，其极限情况为：\n- 弱摄取 ($\\beta \\ll 1$)：展开 $J_0(x) \\approx 1 - \\frac{x^2}{4}$ 和 $J_1(x) \\approx \\frac{x}{2} - \\frac{x^3}{16}$，得到\n$$\n\\beta\\left(1 - \\frac{x^2}{4}\\right) - x\\left(\\frac{x}{2} - \\frac{x^3}{16}\\right) \\approx \\beta - \\left(\\frac{\\beta}{4} + \\frac{1}{2}\\right) x^2 = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{2\\beta}{1 + \\beta/2} \\approx 2\\beta,\n$$\n所以\n$$\n\\alpha_1 \\approx \\frac{D\\,(2\\beta)}{R^2} = \\frac{2\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{2\\,k_m}.\n$$\n- 强摄取 ($\\beta \\gg 1$)：边界条件趋向于 $J_0(x) \\approx 0$，因此 $x_1 \\approx x_{0}$，即 $J_0$ 的第一个零点，$x_{0} \\approx 2.404825557$，得到\n$$\n\\alpha_1 \\approx \\frac{D\\,x_0^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,x_0^2}.\n$$\n\n算法设计：\n- 对每个测试用例，计算 $\\beta = \\dfrac{k_m R}{D}$。\n- 如果 $k_m = 0$，返回 $\\tau = +\\infty$。\n- 否则，定义特定于几何形状的标量函数 $x$：\n  - 球形：$f_{\\text{sphere}}(x;\\beta) = x \\cos x + (\\beta - 1)\\,\\sin x$。\n  - 圆柱形：$f_{\\text{cyl}}(x;\\beta) = \\beta\\, J_0(x) - x\\, J_1(x)$。\n- 通过在合适的密集网格 $x \\in (0,x_{\\max})$（在 $x=0$ 附近进行加密）上扫描符号变化来找到最小正根 $x_1$，然后使用诸如布伦特算法之类的稳健方法通过区间限定来精确求根。\n- 计算 $\\tau = \\dfrac{R^2}{D\\,x_1^2}$（单位为毫秒）。\n- 将所有测试用例的输出汇总成指定的单行格式。\n\n数值稳健性：\n- 这些函数是连续且振荡的，确保了在 $x=0$ 之外的根存在区间；仔细排除平凡根 $x=0$ 可以避免非衰减的常数模式。\n- 在 $x=0$ 附近的密集采样可以捕捉到当 $\\beta \\ll 1$ 时预期出现的小 $x$ 根。\n- 使用基于区间限定的求解器可以防止收敛到非物理根。\n\n此过程得出的清除时间常数具有科学现实性，反映了突触周星形胶质细胞的几何形状（$R$）和转运体功效（$k_m$）如何通过部分吸收边界的扩散来调节谷氨酸的清除。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\nfrom scipy.special import j0, j1\n\ndef smallest_positive_root(func, beta, x_min=1e-9, x_max=50.0):\n    \"\"\"\n    Find the smallest positive root of func(x, beta) = 0 using\n    a scan for sign changes followed by a bracketing root finder.\n    Excludes the trivial root at x=0 by starting at x_min > 0.\n    \"\"\"\n    # Build a nonuniform grid: dense near zero to capture small roots, coarser later.\n    x_grid1 = np.linspace(x_min, 1.0, 5000)\n    x_grid2 = np.linspace(1.0, x_max, 5000)\n    x_grid = np.concatenate((x_grid1, x_grid2))\n    f_vals = func(x_grid, beta)\n\n    # Identify sign changes (f_i * f_{i+1} = 0 and exclude near-zero trivial root)\n    for i in range(len(x_grid) - 1):\n        f1 = f_vals[i]\n        f2 = f_vals[i + 1]\n        # Skip intervals that include the trivial root ~0\n        if x_grid[i] < 1e-8 and x_grid[i + 1] < 1e-8:\n            continue\n        # Find the first sign change\n        if f1 == 0.0:\n            # Exact zero at grid point: ensure it's not x ~ 0 and return this as the smallest root\n            if x_grid[i] > 1e-8:\n                return x_grid[i]\n            else:\n                continue\n        if f1 * f2 < 0.0 or f2 == 0.0:\n            a = x_grid[i]\n            b = x_grid[i + 1]\n            # Use a robust bracketing solver (Brent's method)\n            sol = root_scalar(lambda x: func(x, beta), bracket=[a, b], method='brentq')\n            if sol.converged:\n                return sol.root\n            # If not converged, continue scanning\n\n    # If no root found within range, raise an error\n    raise RuntimeError(\"No positive root found in the specified range.\")\n\ndef sphere_equation(x, beta):\n    \"\"\"\n    f_sphere(x; beta) = x*cos(x) + (beta - 1)*sin(x)\n    \"\"\"\n    return x * np.cos(x) + (beta - 1.0) * np.sin(x)\n\ndef cylinder_equation(x, beta):\n    \"\"\"\n    f_cyl(x; beta) = beta*J0(x) - x*J1(x)\n    \"\"\"\n    return beta * j0(x) - x * j1(x)\n\ndef clearance_time_ms(geometry, D_um2_per_ms, R_um, k_m_um_per_ms):\n    \"\"\"\n    Compute clearance time constant tau (ms) for the given geometry and parameters.\n    - geometry: 'sphere' or 'cylinder'\n    - D_um2_per_ms: diffusion coefficient in um^2/ms\n    - R_um: radius in um\n    - k_m_um_per_ms: uptake coefficient in um/ms\n    Returns tau in ms (float), with np.inf for k_m == 0.\n    \"\"\"\n    if k_m_um_per_ms == 0.0:\n        return float('inf')\n\n    beta = (k_m_um_per_ms * R_um) / D_um2_per_ms\n\n    if geometry == 'sphere':\n        x1 = smallest_positive_root(sphere_equation, beta)\n    elif geometry == 'cylinder':\n        x1 = smallest_positive_root(cylinder_equation, beta)\n    else:\n        raise ValueError(\"Unsupported geometry. Use 'sphere' or 'cylinder'.\")\n\n    alpha1 = D_um2_per_ms * (x1 ** 2) / (R_um ** 2)  # ms^{-1}\n    tau_ms = 1.0 / alpha1\n    return tau_ms\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (geometry, D, R, k_m)\n    test_cases = [\n        (\"sphere\", 0.4, 0.5, 0.05),      # Case 1\n        (\"sphere\", 0.4, 0.5, 10.0),      # Case 2\n        (\"cylinder\", 0.4, 0.5, 0.05),    # Case 3\n        (\"cylinder\", 0.4, 0.5, 10.0),    # Case 4\n        (\"sphere\", 0.4, 0.5, 0.0001),    # Case 5\n        (\"cylinder\", 0.4, 0.5, 0.0001),  # Case 6\n        (\"sphere\", 0.4, 0.2, 0.05),      # Case 7\n    ]\n\n    results = []\n    for geometry, D, R, k_m in test_cases:\n        tau = clearance_time_ms(geometry, D, R, k_m)\n        # Round to 6 decimal places for consistent output; keep 'inf' as is\n        if np.isfinite(tau):\n            tau = round(tau, 6)\n        results.append(tau)\n\n    # Convert results to string, preserving 'inf' formatting\n    def format_val(v):\n        if np.isfinite(v):\n            return f\"{v}\"\n        else:\n            return \"inf\"\n\n    print(f\"[{','.join(map(format_val, results))}]\")\n\nsolve()\n```"
        }
    ]
}