{
    "hands_on_practices": [
        {
            "introduction": "One of the most fundamental functions of glial cells like oligodendrocytes is to myelinate axons, dramatically increasing neural conduction speed. This practice delves into the core biophysical trade-offs of myelination, challenging you to derive the theoretically optimal ratio of axon radius to fiber radius (the g-ratio) that maximizes conduction velocity . By working through this classic model, you will gain a first-principles understanding of why myelinated axons across the nervous system exhibit such a conserved geometric structure.",
            "id": "3984427",
            "problem": "Consider a myelinated axon whose outer fiber radius $r_{\\mathrm{fiber}}$ is set by glial investment, and whose axon (inner) radius $r_{\\mathrm{axon}}$ is controlled by development and plasticity. Define the g-ratio $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$. Assume saltatory conduction proceeds by charging the downstream membrane across an internode through axial current in the axoplasm, and model the total delay per internode as dominated by the resistance-capacitance product of the axoplasmic resistance over one internode and the effective internodal capacitance of the myelin. Use the following foundational elements from cable theory and membrane biophysics:\n\n- Axoplasmic resistance over length $\\ell$ is $R_{i}(\\ell) = \\rho_{i} \\ell / (\\pi r_{\\mathrm{axon}}^{2})$, where $\\rho_{i}$ is the axoplasmic resistivity.\n- The effective internodal capacitance over length $\\ell$ is $C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell \\, c_{\\mathrm{eff}}$, where $c_{\\mathrm{eff}}$ is the effective specific capacitance of the multilamellar myelin stack. Treat myelin as $N$ capacitors in series, with each bilayer having specific capacitance $c_{0}$ and lamellar thickness $\\delta$, so that $N = (r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})/\\delta$ and $c_{\\mathrm{eff}} = c_{0}/N$.\n- The internode length scales linearly with fiber radius, $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$, where $k_{\\ell}$ is a dimensionless scaling constant.\n- The conduction velocity is proportional to the internode length divided by the resistance-capacitance delay, $v = \\alpha \\, \\ell / (R_{i}(\\ell) \\, C_{\\mathrm{int}}(\\ell))$, where $\\alpha$ is a dimensionless proportionality factor capturing thresholding kinetics at the node.\n\nThe central nervous system (CNS) environment imposes a constraint of fixed fiber volume per unit length, which is proportional to $r_{\\mathrm{fiber}}^{2}$; thus, $r_{\\mathrm{fiber}}$ is held fixed while optimizing $g$.\n\nStarting from these bases, derive $v$ as a function of $g$ and $r_{\\mathrm{fiber}}$, and then determine the value of $g$ that maximizes $v$ under the fixed $r_{\\mathrm{fiber}}$ constraint. Finally, using the following biophysical parameter values,\n$\\rho_{i} = 0.7 \\ \\Omega \\cdot \\mathrm{m}$, $c_{0} = 0.01 \\ \\mathrm{F/m}^{2}$, $\\delta = 8 \\times 10^{-9} \\ \\mathrm{m}$, $k_{\\ell} = 200$, $\\alpha = 1$, and $r_{\\mathrm{fiber}} = 5 \\times 10^{-6} \\ \\mathrm{m}$,\ncompute the predicted optimal $g$.\n\nExpress the final answer as a decimal, rounded to four significant figures. The final answer must be a single number without units.",
            "solution": "### Derivation of Conduction Velocity\nThe task is to find the conduction velocity $v$ as a function of the g-ratio $g$ and the fiber radius $r_{\\mathrm{fiber}}$. We start with the given expression for velocity:\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)}$$\nWe will substitute the provided expressions for each term.\n\nFirst, let's express the capacitance $C_{\\mathrm{int}}(\\ell)$ in terms of the fundamental parameters.\nThe number of myelin lamellae is $N = \\frac{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}{\\delta}$.\nThe effective specific capacitance is $c_{\\mathrm{eff}} = \\frac{c_{0}}{N} = \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}$.\nSubstituting this into the expression for internodal capacitance $C_{\\mathrm{int}}(\\ell)$:\n$$C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell c_{\\mathrm{eff}} = 2 \\pi r_{\\mathrm{fiber}} \\ell \\left( \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\nNow, we can assemble the product $R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)$ which represents the time constant of internodal charging:\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\left( \\frac{\\rho_{i} \\ell}{\\pi r_{\\mathrm{axon}}^{2}} \\right) \\left( 2 \\pi r_{\\mathrm{fiber}} \\ell \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\nSimplifying this expression:\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}$$\nNow, substitute this back into the equation for velocity $v$:\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)} = \\frac{\\alpha \\ell}{\\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta \\ell r_{\\mathrm{fiber}}}$$\nThe problem states that internode length $\\ell$ scales with fiber radius: $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$. Substituting this for $\\ell$:\n$$v = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta (k_{\\ell} r_{\\mathrm{fiber}}) r_{\\mathrm{fiber}}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\nThis is the velocity in terms of $r_{\\mathrm{axon}}$ and $r_{\\mathrm{fiber}}$. The next step is to express this in terms of the g-ratio, $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$, which implies $r_{\\mathrm{axon}} = g r_{\\mathrm{fiber}}$.\n$$v = \\frac{\\alpha (g r_{\\mathrm{fiber}})^{2}(r_{\\mathrm{fiber}} - g r_{\\mathrm{fiber}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{2} r_{\\mathrm{fiber}}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\nThe $r_{\\mathrm{fiber}}^{2}$ terms in the numerator and denominator cancel:\n$$v(g, r_{\\mathrm{fiber}}) = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{3}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}} g^{2}(1 - g)$$\nThis is the final expression for $v$ as a function of $g$ and $r_{\\mathrm{fiber}}$.\n\n### Optimization of Conduction Velocity\nThe problem requires finding the value of $g$ that maximizes $v$ under the constraint that $r_{\\mathrm{fiber}}$ is fixed. We can treat the expression for $v$ as a function of $g$ only, $v(g)$.\nLet's define a constant $K$ that groups all the fixed parameters:\n$$K = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}}$$\nAll terms in $K$ are positive constants, so $K > 0$. The velocity function is:\n$$v(g) = K g^{2}(1 - g) = K(g^{2} - g^{3})$$\nThe g-ratio must be in the interval $g \\in (0, 1)$ for a myelinated axon to be physically meaningful. At the boundaries, $v(0) = 0$ and $v(1) = 0$. To find the maximum within this interval, we take the derivative of $v(g)$ with respect to $g$ and set it to zero:\n$$\\frac{dv}{dg} = \\frac{d}{dg} [K(g^{2} - g^{3})] = K(2g - 3g^{2})$$\nSetting the derivative to zero to find critical points:\n$$K(2g - 3g^{2}) = 0$$\nSince $K \\neq 0$, we have:\n$$2g - 3g^{2} = 0 \\implies g(2 - 3g) = 0$$\nThis yields two solutions: $g = 0$ and $g = \\frac{2}{3}$. As noted, $g=0$ corresponds to a minimum velocity of $0$. The non-trivial solution is $g = 2/3$.\nTo confirm this is a maximum, we examine the second derivative:\n$$\\frac{d^{2}v}{dg^{2}} = \\frac{d}{dg} [K(2g - 3g^{2})] = K(2 - 6g)$$\nEvaluate the second derivative at $g = 2/3$:\n$$\\left. \\frac{d^{2}v}{dg^{2}} \\right|_{g=2/3} = K\\left(2 - 6\\left(\\frac{2}{3}\\right)\\right) = K(2 - 4) = -2K$$\nSince $K > 0$, the second derivative is negative, confirming that $g = 2/3$ corresponds to a local maximum. As it's the only critical point in the interval $(0, 1)$, it is the global maximum.\n\n### Computation of the Optimal g-ratio\nThe optimal g-ratio that maximizes conduction velocity, according to this model, is $g = 2/3$. This result is independent of all the specific biophysical parameter values ($\\rho_{i}$, $c_{0}$, $\\delta$, $k_{\\ell}$, $\\alpha$, and $r_{\\mathrm{fiber}}$). These values would be needed to calculate the maximal velocity $v_{\\mathrm{max}}$, but not the optimal ratio $g$.\nThe problem asks for the numerical value of the optimal $g$ rounded to four significant figures.\n$$g = \\frac{2}{3} = 0.666666...$$\nRounding to four significant figures, we get $0.6667$.",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "Beyond myelination, glial cells like astrocytes play a vital role in regulating synaptic communication. This computational exercise models how perisynaptic astrocyte processes clear glutamate from the synapse, a crucial step for terminating signals and preventing excitotoxicity . You will solve for glutamate clearance times under different conditions, learning how glial geometry and transporter kinetics shape the temporal dynamics of neurotransmission.",
            "id": "3984493",
            "problem": "Consider a localized glutamate release into an extracellular microdomain adjacent to a perisynaptic astrocyte process. Assume that the microdomain is radially symmetric, either spherical or cylindrical, and that the enclosing astrocyte membrane is enriched with Excitatory Amino Acid Transporter (EAAT) proteins that act as a partially absorbing boundary. Model glutamate concentration $C(\\mathbf{x},t)$ by the diffusion equation with a Robin (mixed) boundary condition representing transporter-mediated uptake, starting from foundational definitions of diffusion and mass conservation.\n\nFundamental base and assumptions:\n- Fickian diffusion: $\\,\\dfrac{\\partial C}{\\partial t} = D \\nabla^2 C\\,$, with diffusion coefficient $D$.\n- Partially absorbing boundary at the astrocyte membrane: $\\,D\\,\\dfrac{\\partial C}{\\partial n}\\big|_{\\partial \\Omega} + k_m\\, C\\big|_{\\partial \\Omega} = 0\\,$, where $\\dfrac{\\partial}{\\partial n}$ is the outward normal derivative at the boundary $\\partial \\Omega$, and $k_m$ is an effective uptake coefficient (with dimensions of length per time) that aggregates transporter density and single-transporter kinetics.\n- Symmetry at the release center: no-flux at $r=0$ for radial geometries.\n\nWe seek the dominant clearance time constant $\\,\\tau\\,$ that characterizes the asymptotic decay of total extracellular glutamate, which, under these assumptions, is governed by the slowest decaying eigenmode of the diffusion operator subject to the above Robin boundary condition. In radially symmetric geometries, separation of variables reduces the problem to finding the smallest positive spatial eigenvalue parameter $\\,x\\,$ that satisfies a boundary equation, and then computing\n$$\n\\tau \\;=\\; \\frac{1}{\\alpha_1} \\;=\\; \\frac{R^2}{D\\,x^2},\n$$\nwhere $R$ is the microdomain radius and $\\alpha_1$ is the dominant decay rate.\n\nFor a spherical microdomain (three-dimensional ball of radius $R$), the slowest radial mode satisfies the eigenvalue condition\n$$\nx \\cos x \\;+\\; (\\beta - 1)\\, \\sin x \\;=\\; 0,\n$$\nwhere $\\,x = k R\\,$ and $\\,\\beta = \\dfrac{k_m R}{D}\\,$. For a cylindrical microdomain (two-dimensional disk cross-section with axial invariance) the eigenvalue condition is\n$$\n\\beta\\, J_0(x) \\;-\\; x\\, J_1(x) \\;=\\; 0,\n$$\nwhere $J_0$ and $J_1$ are Bessel functions of the first kind and $\\,x = \\lambda R\\,$. In both cases, the decay rate is $\\,\\alpha_1 = D\\,x^2 / R^2\\,$ and the clearance time constant is $\\,\\tau = R^2 / (D\\,x^2)\\,$. If $\\,k_m = 0\\,$ (perfectly reflecting boundary), the constant mode yields $\\,\\alpha_1 = 0\\,$ and the clearance time is infinite.\n\nYour program must:\n- Numerically find the smallest positive root $\\,x > 0\\,$ of the appropriate eigenvalue equation for each test case, using robust one-dimensional root finding with bracketing.\n- Compute the corresponding clearance time constant $\\,\\tau\\,$ in milliseconds, assuming micrometer and millisecond units as specified below.\n- Handle the limit case $\\,k_m = 0\\,$ by returning $+\\infty$ for $\\,\\tau\\,$.\n\nUnits:\n- Use micrometers ($\\mu\\text{m}$) for length, milliseconds ($\\text{ms}$) for time.\n- Diffusion coefficient $D$ must be in $\\mu\\text{m}^2/\\text{ms}$.\n- Uptake coefficient $k_m$ must be in $\\mu\\text{m}/\\text{ms}$.\n- Radius $R$ must be in $\\mu\\text{m}$.\n- Express all outputs for $\\,\\tau\\,$ in $\\text{ms}$ as floating-point numbers.\n\nTest suite:\nProvide results for the following parameter sets, covering different geometries, uptake strengths, and boundary cases.\n- Case $1$ (happy path, spherical, moderate uptake): geometry $=$ sphere, $D = 0.4$ $\\mu\\text{m}^2/\\text{ms}$, $R = 0.5$ $\\mu\\text{m}$, $k_m = 0.05$ $\\mu\\text{m}/\\text{ms}$.\n- Case $2$ (spherical, strong uptake, near-Dirichlet): geometry $=$ sphere, $D = 0.4$, $R = 0.5$, $k_m = 10.0$.\n- Case $3$ (cylindrical, moderate uptake): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 0.05$.\n- Case $4$ (cylindrical, strong uptake, near-Dirichlet): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 10.0$.\n- Case $5$ (spherical, extremely weak uptake, near-reflecting): geometry $=$ sphere, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$.\n- Case $6$ (cylindrical, extremely weak uptake, near-reflecting): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$.\n- Case $7$ (spherical, smaller geometry): geometry $=$ sphere, $D = 0.4$, $R = 0.2$, $k_m = 0.05$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the clearance time constant $\\,\\tau\\,$ in $\\text{ms}$ for the corresponding test case, in the same order as above. For example, the output must have the form\n$$\n[\\tau_1,\\tau_2,\\tau_3,\\tau_4,\\tau_5,\\tau_6,\\tau_7].\n$$",
            "solution": "We start from Fickian diffusion and mass balance in a bounded microdomain $\\Omega$ with boundary $\\partial \\Omega$. The concentration $C(\\mathbf{x},t)$ evolves according to\n$$\n\\frac{\\partial C}{\\partial t} = D \\nabla^2 C,\n$$\nwhere $D$ is the diffusion coefficient. Transporters at the perisynaptic astrocyte membrane are modeled as a partially absorbing boundary condition of Robin type,\n$$\nD\\,\\frac{\\partial C}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, C\\Big|_{\\partial \\Omega} = 0,\n$$\nwith outward normal derivative $\\dfrac{\\partial}{\\partial n}$, and an uptake coefficient $k_m$ that lumps transporter density and single-transporter kinetics into an effective flux proportional to the local concentration. This boundary condition is standard for reactive boundaries and ensures dimensional consistency: $D$ has units $\\mu\\text{m}^2/\\text{ms}$, $\\dfrac{\\partial C}{\\partial n}$ has units $\\text{concentration}/\\mu\\text{m}$, and $k_m$ has units $\\mu\\text{m}/\\text{ms}$, so both terms have flux units $\\text{concentration}\\cdot\\mu\\text{m}/\\text{ms}$.\n\nTo characterize glutamate clearance, we examine the asymptotic decay of the total mass $M(t) = \\int_{\\Omega} C(\\mathbf{x},t)\\, dV$. With no volumetric reaction, the decay is generated solely by boundary uptake. Separation of variables yields modal solutions\n$$\nC(\\mathbf{x},t) = f(\\mathbf{x})\\, e^{-\\alpha t},\n$$\nwith spatial modes $f$ that solve the Helmholtz equation\n$$\n\\nabla^2 f + \\kappa^2 f = 0,\\quad \\text{with}\\quad \\kappa^2 = \\frac{\\alpha}{D},\n$$\nsubject to the Robin boundary condition\n$$\nD\\,\\frac{\\partial f}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, f\\Big|_{\\partial \\Omega} = 0.\n$$\nIn radially symmetric geometries (spherical or cylindrical), the dominant mode has zero angular dependence. Its temporal decay rate $\\alpha_1$ is given by the smallest positive admissible $\\kappa^2$ (hence smallest positive $x$ in the dimensionless boundary condition), and the clearance time constant is\n$$\n\\tau = \\frac{1}{\\alpha_1} = \\frac{R^2}{D\\,x^2}.\n$$\n\nSpherical geometry:\nFor a ball of radius $R$, the spherically symmetric solution is proportional to the spherical Bessel function $j_0(x) = \\dfrac{\\sin x}{x}$, and the boundary condition becomes\n$$\nD\\,\\frac{\\partial}{\\partial r} j_0(k r)\\Big|_{r=R} + k_m\\, j_0(k R) = 0.\n$$\nUsing $j_0'(x) = \\frac{x\\cos x - \\sin x}{x^2}$ and $\\frac{\\partial}{\\partial r} j_0(k r) = k\\, j_0'(k r)$, we obtain\n$$\nD\\,k\\, j_0'(k R) + k_m\\, j_0(k R) = 0.\n$$\nDefine the dimensionless parameter $\\beta = \\dfrac{k_m R}{D}$ and $x = k R$. Multiplying by $\\dfrac{R}{D}$ and simplifying yields\n$$\nx \\cos x + (\\beta - 1)\\,\\sin x = 0.\n$$\nThe smallest positive root $x_1$ of this equation determines the dominant decay rate $\\alpha_1 = D\\,x_1^2 / R^2$, hence the clearance time $\\tau = R^2 / (D\\,x_1^2)$. Two limiting regimes provide physical intuition:\n- Weak uptake ($\\beta \\ll 1$): expand $\\sin x \\approx x - \\frac{x^3}{6}$, $\\cos x \\approx 1 - \\frac{x^2}{2}$, giving\n$$\nx \\left(1 - \\frac{x^2}{2}\\right) + (\\beta - 1)\\left(x - \\frac{x^3}{6}\\right) \\approx \\beta x - x^3\\,\\frac{\\beta + 2}{6} = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{6\\beta}{\\beta + 2} \\approx 3\\beta,\n$$\nso\n$$\n\\alpha_1 \\approx \\frac{D\\,(3\\beta)}{R^2} = \\frac{3\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{3\\,k_m}.\n$$\n- Strong uptake ($\\beta \\gg 1$): the equation tends to $\\sin x \\approx 0$, so $x_1 \\approx \\pi$, giving\n$$\n\\alpha_1 \\approx \\frac{D\\,\\pi^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,\\pi^2}.\n$$\n\nCylindrical geometry:\nFor an axially invariant cylinder (disk cross-section of radius $R$), radial modes are given by Bessel functions $J_0(\\lambda r)$. The boundary condition\n$$\nD\\,\\frac{\\partial}{\\partial r} J_0(\\lambda r)\\Big|_{r=R} + k_m\\, J_0(\\lambda R) = 0\n$$\nuses $\\frac{\\partial}{\\partial r} J_0(\\lambda r) = -\\lambda J_1(\\lambda r)$, hence\n$$\n- D\\,\\lambda\\, J_1(\\lambda R) + k_m\\, J_0(\\lambda R) = 0.\n$$\nWith $x = \\lambda R$ and $\\beta = \\dfrac{k_m R}{D}$,\n$$\n\\beta\\, J_0(x) - x\\, J_1(x) = 0.\n$$\nAs before, $\\alpha_1 = D\\,x_1^2 / R^2$ and $\\tau = R^2 / (D\\,x_1^2)$, with limits:\n- Weak uptake ($\\beta \\ll 1$): expand $J_0(x) \\approx 1 - \\frac{x^2}{4}$ and $J_1(x) \\approx \\frac{x}{2} - \\frac{x^3}{16}$, yielding\n$$\n\\beta\\left(1 - \\frac{x^2}{4}\\right) - x\\left(\\frac{x}{2} - \\frac{x^3}{16}\\right) \\approx \\beta - \\left(\\frac{\\beta}{4} + \\frac{1}{2}\\right) x^2 = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{2\\beta}{1 + \\beta/2} \\approx 2\\beta,\n$$\nso\n$$\n\\alpha_1 \\approx \\frac{D\\,(2\\beta)}{R^2} = \\frac{2\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{2\\,k_m}.\n$$\n- Strong uptake ($\\beta \\gg 1$): the boundary tends to $J_0(x) \\approx 0$, so $x_1 \\approx x_{0}$, the first zero of $J_0$, $x_{0} \\approx 2.404825557$, giving\n$$\n\\alpha_1 \\approx \\frac{D\\,x_0^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,x_0^2}.\n$$\n\nAlgorithmic design:\n- For each test case, compute $\\beta = \\dfrac{k_m R}{D}$.\n- If $k_m = 0$, return $\\tau = +\\infty$.\n- Otherwise, define the geometry-specific scalar function of $x$:\n  - Sphere: $f_{\\text{sphere}}(x;\\beta) = x \\cos x + (\\beta - 1)\\,\\sin x$.\n  - Cylinder: $f_{\\text{cyl}}(x;\\beta) = \\beta\\, J_0(x) - x\\, J_1(x)$.\n- Find the smallest positive root $x_1$ by scanning for a sign change over a suitably dense grid $x \\in (0,x_{\\max})$ with refinement near $x=0$, then refine the root with bracketing using a robust method such as Brent's algorithm.\n- Compute $\\tau = \\dfrac{R^2}{D\\,x_1^2}$ in milliseconds.\n- Aggregate outputs for all test cases into the specified single-line format.\n\nNumerical robustness:\n- The functions are continuous and oscillatory, ensuring the existence of brackets for roots beyond $x=0$; careful exclusion of the trivial root $x=0$ avoids the non-decaying constant mode.\n- Dense sampling near $x=0$ captures small-$x$ roots expected when $\\beta \\ll 1$.\n- Using bracketing-based solvers prevents convergence to non-physical roots.\n\nThis procedure yields scientifically realistic clearance time constants that reflect how perisynaptic astrocyte geometry ($R$) and transporter efficacy ($k_m$) regulate glutamate removal via diffusion with partially absorbing boundaries.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\nfrom scipy.special import j0, j1\n\ndef smallest_positive_root(func, beta, x_min=1e-9, x_max=50.0):\n    \"\"\"\n    Find the smallest positive root of func(x, beta) = 0 using\n    a scan for sign changes followed by a bracketing root finder.\n    Excludes the trivial root at x=0 by starting at x_min > 0.\n    \"\"\"\n    # Build a nonuniform grid: dense near zero to capture small roots, coarser later.\n    x_grid1 = np.linspace(x_min, 1.0, 5000)\n    x_grid2 = np.linspace(1.0, x_max, 5000)\n    x_grid = np.concatenate((x_grid1, x_grid2))\n    f_vals = func(x_grid, beta)\n\n    # Identify sign changes (f_i * f_{i+1} <= 0 and exclude near-zero trivial root)\n    for i in range(len(x_grid) - 1):\n        f1 = f_vals[i]\n        f2 = f_vals[i + 1]\n        # Skip intervals that include the trivial root ~0\n        if x_grid[i] < 1e-8 and x_grid[i + 1] < 1e-8:\n            continue\n        # Find the first sign change\n        if f1 == 0.0:\n            # Exact zero at grid point: ensure it's not x ~ 0 and return this as the smallest root\n            if x_grid[i] > 1e-8:\n                return x_grid[i]\n            else:\n                continue\n        if f1 * f2 < 0.0 or f2 == 0.0:\n            a = x_grid[i]\n            b = x_grid[i + 1]\n            # Use a robust bracketing solver (Brent's method)\n            sol = root_scalar(lambda x: func(x, beta), bracket=[a, b], method='brentq')\n            if sol.converged:\n                return sol.root\n            # If not converged, continue scanning\n\n    # If no root found within range, raise an error\n    raise RuntimeError(\"No positive root found in the specified range.\")\n\ndef sphere_equation(x, beta):\n    \"\"\"\n    f_sphere(x; beta) = x*cos(x) + (beta - 1)*sin(x)\n    \"\"\"\n    return x * np.cos(x) + (beta - 1.0) * np.sin(x)\n\ndef cylinder_equation(x, beta):\n    \"\"\"\n    f_cyl(x; beta) = beta*J0(x) - x*J1(x)\n    \"\"\"\n    return beta * j0(x) - x * j1(x)\n\ndef clearance_time_ms(geometry, D_um2_per_ms, R_um, k_m_um_per_ms):\n    \"\"\"\n    Compute clearance time constant tau (ms) for the given geometry and parameters.\n    - geometry: 'sphere' or 'cylinder'\n    - D_um2_per_ms: diffusion coefficient in um^2/ms\n    - R_um: radius in um\n    - k_m_um_per_ms: uptake coefficient in um/ms\n    Returns tau in ms (float), with np.inf for k_m == 0.\n    \"\"\"\n    if k_m_um_per_ms == 0.0:\n        return float('inf')\n\n    beta = (k_m_um_per_ms * R_um) / D_um2_per_ms\n\n    if geometry == 'sphere':\n        x1 = smallest_positive_root(sphere_equation, beta)\n    elif geometry == 'cylinder':\n        x1 = smallest_positive_root(cylinder_equation, beta)\n    else:\n        raise ValueError(\"Unsupported geometry. Use 'sphere' or 'cylinder'.\")\n\n    alpha1 = D_um2_per_ms * (x1 ** 2) / (R_um ** 2)  # ms^{-1}\n    tau_ms = 1.0 / alpha1\n    return tau_ms\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (geometry, D, R, k_m)\n    test_cases = [\n        (\"sphere\", 0.4, 0.5, 0.05),      # Case 1\n        (\"sphere\", 0.4, 0.5, 10.0),      # Case 2\n        (\"cylinder\", 0.4, 0.5, 0.05),    # Case 3\n        (\"cylinder\", 0.4, 0.5, 10.0),    # Case 4\n        (\"sphere\", 0.4, 0.5, 0.0001),    # Case 5\n        (\"cylinder\", 0.4, 0.5, 0.0001),  # Case 6\n        (\"sphere\", 0.4, 0.2, 0.05),      # Case 7\n    ]\n\n    results = []\n    for geometry, D, R, k_m in test_cases:\n        tau = clearance_time_ms(geometry, D, R, k_m)\n        # Round to 6 decimal places for consistent output; keep 'inf' as is\n        if np.isfinite(tau):\n            tau = round(tau, 6)\n        results.append(tau)\n\n    # Convert results to string, preserving 'inf' formatting\n    def format_val(v):\n        if np.isfinite(v):\n            return f\"{v}\"\n        else:\n            return \"inf\"\n\n    print(f\"[{','.join(map(format_val, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The integrity of the junction between myelin and the axon is critical for saltatory conduction. This practice models the pathological consequences of disrupted paranodal junctions, a hallmark of demyelinating diseases . By calculating the threshold of current leak that leads to conduction failure, you will apply cable theory to understand how structural deficits in glial support can result in a catastrophic loss of function.",
            "id": "3984506",
            "problem": "You are tasked with designing a principled computational model that captures how disrupted glialâ€“axon adhesion at the paranodal region of a myelinated axon (septate-like junctions) introduces current leak that can produce conduction block. The modeling framework must start from the one-dimensional linear cable description of a myelinated internode connecting two consecutive nodes of Ranvier. Treat the axoplasm as an ohmic medium with cytoplasmic resistivity and the myelin-wrapped internodal membrane as an effective leaky boundary. Model the paranodal adhesion failure as two identical, lumped shunt conductances, one at each end of the internode, both in parallel to the internodal membrane pathway. Assume quasi-static propagation sufficient to analyze amplitude transfer from one node to the next without explicitly modeling time-dependent ionic gating. The following fundamental base is permitted and required:\n- The linear cable equation governing passive voltage spread along a uniform one-dimensional cable.\n- The definition of axial resistance per unit length $r_{\\mathrm{a}}$ from cytoplasmic resistivity and cross-sectional area.\n- The definition of membrane conductance per unit length $g_{\\mathrm{m}}$ and its relation to membrane resistance per unit length $r_{\\mathrm{m}}$ via $r_{\\mathrm{m}} = 1/g_{\\mathrm{m}}$.\n- The notion that quasi-static voltage transfer along a uniform passive cable exhibits exponential attenuation characterized by a length constant that depends on $r_{\\mathrm{m}}$ and $r_{\\mathrm{a}}$.\nYour program must compute, for each test case, the minimal identical paranodal shunt conductance per end, denoted $g_{\\mathrm{pn}}^\\star$ (in siemens), whose presence reduces the voltage amplitude at the next node to exactly the specified threshold for spike initiation, thereby marking the boundary of conduction block. If conduction is already blocked at baseline ($g_{\\mathrm{pn}} = 0$) under the given parameters, you must return $0.0$ for that case. Use a mathematically consistent approximation that replaces the pair of end shunts by an equivalent adjustment to the uniform leak sufficient to determine the required attenuation needed to reach threshold; ensure that the derivation follows from the cable equation and conservation of current.\n\nDefinitions and parameterization:\n- Let the internode length be $L$ (in meters).\n- Let the axon radius be $a$ (in meters).\n- Let the cytoplasmic resistivity be $\\rho_{\\mathrm{i}}$ (in ohm-meter).\n- Let the effective myelin-associated membrane conductance per unit length be $g_{\\mathrm{m}}$ (in siemens per meter).\n- Let the peak nodal depolarization be $V_{\\mathrm{peak}}$ (in volts).\n- Let the minimum depolarization at the next node required for spike initiation be $V_{\\mathrm{thr}}$ (in volts).\n- Let the axial resistance per unit length be $r_{\\mathrm{a}}$ with $r_{\\mathrm{a}} = \\rho_{\\mathrm{i}}/(\\pi a^2)$ (in ohms per meter).\n- The paranodal disruption introduces two identical shunts of conductance $g_{\\mathrm{pn}}$ (in siemens), one at each end of the internode. You must compute the threshold value $g_{\\mathrm{pn}}^\\star$.\n\nConduction block criterion:\n- Conduction is considered blocked when the amplitude arriving at the next node equals $V_{\\mathrm{thr}}$; any additional leak beyond $g_{\\mathrm{pn}}^\\star$ keeps conduction blocked, while any leak below $g_{\\mathrm{pn}}^\\star$ permits transmission above $V_{\\mathrm{thr}}$.\n\nRequired outputs and units:\n- For each test case, output $g_{\\mathrm{pn}}^\\star$ as a floating-point number in siemens (S).\n- Express each result in scientific notation with six significant digits.\n- Physical units to use in the program: meters (m), ohm-meter ($\\Omega\\cdot\\mathrm{m}$), siemens (S), volts (V).\n- No angles are involved.\n\nTest suite (each case is a tuple $(L,a,\\rho_{\\mathrm{i}},g_{\\mathrm{m}},V_{\\mathrm{peak}},V_{\\mathrm{thr}})$):\n1. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 4\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-7}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n2. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 3\\times 10^{-7}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-4}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n3. $(1\\times 10^{-3}\\ \\mathrm{m},\\ 2\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 4.6469\\times 10^{-5}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n4. $(5\\times 10^{-3}\\ \\mathrm{m},\\ 8\\times 10^{-6}\\ \\mathrm{m},\\ 0.7\\ \\Omega\\cdot\\mathrm{m},\\ 1\\times 10^{-7}\\ \\mathrm{S/m},\\ 0.1\\ \\mathrm{V},\\ 0.02\\ \\mathrm{V})$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the computed $g_{\\mathrm{pn}}^\\star$ for the corresponding test case in siemens (S), formatted in scientific notation with six significant digits. The program must be self-contained and require no input.",
            "solution": "The problem requires us to compute the minimal paranodal shunt conductance, $g_{\\mathrm{pn}}^\\star$, that causes conduction block in a myelinated axon internode. The model is a one-dimensional passive cable of length $L$ representing the internode. Conduction block is defined as the condition where the voltage at the distal end of the internode, $V(L)$, drops to the spike initiation threshold, $V_{\\mathrm{thr}}$, given a voltage of $V_{\\mathrm{peak}}$ at the proximal end, $V(0)$.\n\nThe core of the problem lies in relating the passive cable properties to the voltage attenuation from one node to the next. The quasi-static voltage $V(x)$ along a uniform passive cable is governed by the linear cable equation:\n$$ \\frac{d^2V}{dx^2} - \\frac{r_{\\mathrm{a}}}{r_{\\mathrm{m}}}V = 0 \\quad \\text{or} \\quad \\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V = 0 $$\nwhere $r_{\\mathrm{a}}$ is the axial resistance per unit length, $r_{\\mathrm{m}}$ is the membrane resistance per unit length, and $\\lambda = \\sqrt{r_{\\mathrm{m}}/r_{\\mathrm{a}}}$ is the space constant. The problem provides parameters in terms of conductance, so we use $g_{\\mathrm{m}} = 1/r_{\\mathrm{m}}$, the membrane conductance per unit length. Thus, the space constant can be written as $\\lambda = 1/\\sqrt{r_{\\mathrm{a}}g_{\\mathrm{m}}}$.\n\nFor a finite cable of length $L$, with an input voltage $V(0) = V_{\\mathrm{peak}}$ at $x=0$ and assuming the next node at $x=L$ acts as a high-impedance load (approximating a sealed end boundary condition, $\\frac{dV}{dx}|_{x=L} = 0$), the solution to the cable equation is:\n$$ V(x) = V_{\\mathrm{peak}} \\frac{\\cosh((L-x)/\\lambda)}{\\cosh(L/\\lambda)} $$\nThe voltage arriving at the next node, at $x=L$, is therefore:\n$$ V(L) = \\frac{V_{\\mathrm{peak}}}{\\cosh(L/\\lambda)} $$\nThis equation describes the voltage attenuation across the internode.\n\nThe problem introduces a key simplification: the two lumped shunt conductances, $g_{\\mathrm{pn}}$, at each end of the internode can be modeled by an equivalent adjustment to the uniform membrane leak. The total leak conductance of the internode is the sum of the distributed myelin leak and the two shunts.\nThe original total myelin leak conductance is $G_{\\mathrm{m}} = g_{\\mathrm{m}} L$.\nThe total shunt conductance is $G_{\\mathrm{pn}} = 2 g_{\\mathrm{pn}}$.\nThe effective total conductance of the pathological internode is $G_{\\mathrm{eff}} = G_{\\mathrm{m}} + G_{\\mathrm{pn}} = g_{\\mathrm{m}} L + 2 g_{\\mathrm{pn}}$.\n\nTo create an equivalent uniform cable, we \"smear\" this total effective conductance over the length $L$, defining an effective membrane conductance per unit length, $g'_{\\mathrm{m}}$:\n$$ g'_{\\mathrm{m}} = \\frac{G_{\\mathrm{eff}}}{L} = \\frac{g_{\\mathrm{m}} L + 2 g_{\\mathrm{pn}}}{L} = g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}}{L} $$\nThis new uniform cable has a new, shorter effective space constant, $\\lambda'$:\n$$ \\lambda' = \\frac{1}{\\sqrt{r_{\\mathrm{a}} g'_{\\mathrm{m}}}} = \\frac{1}{\\sqrt{r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}}{L}\\right)}} $$\nThe conduction block criterion is met when the voltage at the next node equals the threshold, $V(L) = V_{\\mathrm{thr}}$, for the critical shunt conductance $g_{\\mathrm{pn}} = g_{\\mathrm{pn}}^\\star$. Using the voltage attenuation formula with the effective space constant $\\lambda'$:\n$$ V_{\\mathrm{thr}} = \\frac{V_{\\mathrm{peak}}}{\\cosh(L/\\lambda')} $$\nRearranging this equation allows us to solve for the required properties of the cable:\n$$ \\cosh(L/\\lambda') = \\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}} $$\nTaking the inverse hyperbolic cosine of both sides yields:\n$$ \\frac{L}{\\lambda'} = \\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right) $$\nSubstituting the expression for $\\lambda'$:\n$$ L \\sqrt{r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L}\\right)} = \\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right) $$\nWe can now solve for $g_{\\mathrm{pn}}^\\star$. Squaring both sides and rearranging:\n$$ L^2 r_{\\mathrm{a}} \\left(g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L}\\right) = \\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2 $$\n$$ g_{\\mathrm{m}} + \\frac{2 g_{\\mathrm{pn}}^\\star}{L} = \\frac{1}{L^2 r_{\\mathrm{a}}} \\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2 $$\n$$ \\frac{2 g_{\\mathrm{pn}}^\\star}{L} = \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 r_{\\mathrm{a}}} - g_{\\mathrm{m}} $$\n$$ g_{\\mathrm{pn}}^\\star = \\frac{L}{2} \\left( \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 r_{\\mathrm{a}}} - g_{\\mathrm{m}} \\right) $$\nThe axial resistance per unit length, $r_{\\mathrm{a}}$, is given by the axon's geometry and cytoplasmic resistivity:\n$$ r_{\\mathrm{a}} = \\frac{\\rho_{\\mathrm{i}}}{\\pi a^2} $$\nA special case occurs if conduction is already blocked at baseline (i.e., when $g_{\\mathrm{pn}} = 0$). This happens if the voltage arriving at the next node is already at or below the threshold, i.e., $V(L)_{\\text{baseline}} \\le V_{\\mathrm{thr}}$. In this situation, the calculated $g_{\\mathrm{pn}}^\\star$ from the formula will be less than or equal to $0$. Since a passive conductance cannot be negative, the minimal *additional* conductance required to cause block is $0$. Therefore, the final result is:\n$$ g_{\\mathrm{pn}}^\\star = \\max\\left(0, \\frac{L}{2} \\left( \\frac{\\left[\\mathrm{arccosh}\\left(\\frac{V_{\\mathrm{peak}}}{V_{\\mathrm{thr}}}\\right)\\right]^2}{L^2 \\left(\\frac{\\rho_{\\mathrm{i}}}{\\pi a^2}\\right)} - g_{\\mathrm{m}} \\right)\\right) $$\nThis formula will be implemented for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational neuroscience problem for a set of test cases.\n    \"\"\"\n\n    # Test suite: each case is a tuple (L, a, rho_i, g_m, V_peak, V_thr)\n    # Units: L (m), a (m), rho_i (ohm*m), g_m (S/m), V_peak (V), V_thr (V)\n    test_cases = [\n        (1e-3, 4e-6, 0.7, 1e-7, 0.1, 0.02),\n        (1e-3, 3e-7, 0.7, 1e-4, 0.1, 0.02),\n        (1e-3, 2e-6, 0.7, 4.6469e-5, 0.1, 0.02),\n        (5e-3, 8e-6, 0.7, 1e-7, 0.1, 0.02)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, a, rho_i, g_m, V_peak, V_thr = case\n\n        # The voltage ratio R must be >= 1 for arccosh to be real.\n        # This is guaranteed as V_peak >= V_thr for a meaningful problem.\n        if V_peak < V_thr:\n            # If peak voltage is less than threshold, propagation always fails.\n            # Minimal required shunt conductance is 0.\n            result = 0.0\n        else:\n            # Calculate axial resistance per unit length (r_a)\n            # r_a = rho_i / (pi * a^2)\n            r_a = rho_i / (np.pi * a**2)\n\n            # Voltage ratio\n            R = V_peak / V_thr\n\n            # The full formula for g_pn_star derived from the cable equation and\n            # the approximation of smearing the shunt conductance.\n            # g_pn_star = (L/2) * ( (arccosh(R)^2 / (L^2 * r_a)) - g_m )\n            \n            # The term in the parentheses represents the required additional\n            # conductance per unit length, delta_g_m.\n            # delta_g_m = g'_m - g_m\n            # where g'_m is the total effective conductance per unit length\n            # needed to cause block.\n            arccosh_R_sq = np.arccosh(R)**2\n            \n            term_in_parenthesis = (arccosh_R_sq / (L**2 * r_a)) - g_m\n\n            # If the term is negative, it means the baseline conductance g_m is\n            # already greater than the conductance required for block (g'_m).\n            # Thus, the internode is already blocking, and the minimum *additional*\n            # shunt conductance to cause block is 0.\n            if term_in_parenthesis < 0:\n                result = 0.0\n            else:\n                result = (L / 2.0) * term_in_parenthesis\n\n        results.append(result)\n\n    # Format the results into a comma-separated string,\n    # with each value in scientific notation with 6 significant digits.\n    # The format specifier \"{:.5e}\" gives 1 digit before the decimal and\n    # 5 after, for a total of 6 significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}