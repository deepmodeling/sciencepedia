{
    "hands_on_practices": [
        {
            "introduction": "The Quality-Adjusted Life Year (QALY) is a cornerstone metric in health economics, providing a common currency to measure the value of diverse health interventions by combining both the quantity and quality of life. This exercise takes you back to first principles, guiding you through the calculation of total QALYs from given utility values over time. You will practice applying the crucial economic concept of discounting, which accounts for the time preference of health benefits, allowing you to distinguish between raw and present-value health outcomes. ",
            "id": "5051454",
            "problem": "In a translational medicine cost-effectiveness analysis framed within Health Economics and Outcomes Research (HEOR), consider a hypothetical advanced therapy that yields a constant health-related quality-of-life utility of $u_1=0.8$ for the first $5$ years and $u_2=0.6$ for the subsequent $3$ years. Assume a one-year cycle length, end-of-year accrual, and a survival probability of $1$ throughout all $8$ years. Using the foundational definition of the Quality-Adjusted Life Year (QALY), which aggregates health utility over time under survival, and the economic principle of time preference with a constant annual discount rate, derive from first principles the discrete-time expressions needed to compute the total undiscounted QALYs and the total discounted QALYs at an annual discount rate of $r=0.03$. Then compute both quantities. Round both values to four significant figures. Express both values in Quality-Adjusted Life Years (QALYs).",
            "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   Health utility for the first period: $u_1 = 0.8$\n-   Duration of the first period: $T_1 = 5$ years\n-   Health utility for the second period: $u_2 = 0.6$\n-   Duration of the second period: $T_2 = 3$ years\n-   Total time horizon: $T = T_1 + T_2 = 8$ years\n-   Cycle length: $1$ year\n-   Accrual convention: End-of-year\n-   Survival probability, $S(t)$: $S(t) = 1$ for all years $t \\in [1, 8]$\n-   Annual discount rate: $r = 0.03$\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is grounded in the established principles of Health Economics and Outcomes Research (HEOR). The concepts of Quality-Adjusted Life Years (QALYs), health utility (with values between $0$ and $1$), and discounting of future health outcomes are foundational to cost-effectiveness analysis. The specified discount rate of $3\\%$ is a standard value used in many international guidelines for health technology assessment.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary parameters ($u_1, u_2, T_1, T_2, r$) and clear instructions (discrete-time, end-of-year accrual) to compute unique values for the undiscounted and discounted QALYs.\n-   **Objective**: The problem is stated in precise, objective language, free of subjective or ambiguous terminology.\n-   **Conclusion**: The problem does not violate any of the specified invalidity criteria. It is a scientifically sound, well-posed, and objective problem formulation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution is provided below.\n\n### Solution Derivation\nThe Quality-Adjusted Life Year (QALY) is a measure of health outcome that combines the quantity of life (survival) with its quality (utility). For a discrete time period $t$ with cycle length $L$, the QALYs accrued during that period are given by the product of the utility $u(t)$ and the duration of survival in that period. With a survival probability $S(t-1)$ of entering period $t$ and surviving through it, the expected QALYs for period $t$ are $u(t) \\times L \\times S(t)$. The problem states the survival probability is $1$ throughout, meaning the individual is certain to live all $8$ years. The cycle length is $L=1$ year. Thus, the QALYs accrued in any given year $t$ are simply equal to the utility value for that year, $u(t)$.\n\n**1. Total Undiscounted QALYs**\n\nThe total undiscounted QALYs, denoted $Q_{\\text{undiscounted}}$, are the simple arithmetic sum of the health utility experienced in each year over the entire time horizon. The expression is derived by summing the utility values for each time period.\n\nLet $u(t)$ be the utility in year $t$. The total undiscounted QALYs are:\n$$Q_{\\text{undiscounted}} = \\sum_{t=1}^{T} u(t)$$\nGiven the problem specifics, the utility is $u_1 = 0.8$ for $t=1, \\dots, 5$ and $u_2 = 0.6$ for $t=6, \\dots, 8$. The expression can be written as:\n$$Q_{\\text{undiscounted}} = \\sum_{t=1}^{5} u_1 + \\sum_{t=6}^{8} u_2$$\nThis simplifies to:\n$$Q_{\\text{undiscounted}} = (5 \\times u_1) + (3 \\times u_2)$$\nSubstituting the given values:\n$$Q_{\\text{undiscounted}} = (5 \\times 0.8) + (3 \\times 0.6) = 4.0 + 1.8 = 5.8$$\nRounding to four significant figures as requested, the result is $5.800$ QALYs.\n\n**2. Total Discounted QALYs**\n\nDiscounting is applied in economic evaluations to reflect time preference, the principle that benefits received in the future are valued less than the same benefits received today. With a constant annual discount rate $r$, the value of a benefit received at the end of year $t$ is reduced by a discount factor of $\\frac{1}{(1+r)^t}$. The problem specifies an \"end-of-year accrual\" convention, meaning the utility gained during year $t$ is valued as if it were received at the end of year $t$.\n\nThe total discounted QALYs, denoted $Q_{\\text{discounted}}$, are calculated by summing the discounted utility for each year. The expression is:\n$$Q_{\\text{discounted}} = \\sum_{t=1}^{T} \\frac{u(t)}{(1+r)^t}$$\nSplitting this sum based on the two utility periods:\n$$Q_{\\text{discounted}} = \\sum_{t=1}^{5} \\frac{u_1}{(1+r)^t} + \\sum_{t=6}^{8} \\frac{u_2}{(1+r)^t}$$\nWe can factor out the constant utility values:\n$$Q_{\\text{discounted}} = u_1 \\sum_{t=1}^{5} \\frac{1}{(1+r)^t} + u_2 \\sum_{t=6}^{8} \\frac{1}{(1+r)^t}$$\nThis is the required discrete-time expression. Now we compute the value with $r=0.03$, $u_1=0.8$, and $u_2=0.6$.\n\n$$Q_{\\text{discounted}} = 0.8 \\left( \\frac{1}{1.03^1} + \\frac{1}{1.03^2} + \\frac{1}{1.03^3} + \\frac{1}{1.03^4} + \\frac{1}{1.03^5} \\right) + 0.6 \\left( \\frac{1}{1.03^6} + \\frac{1}{1.03^7} + \\frac{1}{1.03^8} \\right)$$\nThe sums are finite geometric series. The sum $\\sum_{k=1}^{n} a^k$ can be calculated with the formula for the present value of an annuity, $\\frac{1-(1+r)^{-n}}{r}$.\nFor the first part:\n$$ \\sum_{t=1}^{5} \\frac{1}{(1.03)^t} = \\frac{1-(1.03)^{-5}}{0.03} \\approx \\frac{1-0.86260878}{0.03} \\approx \\frac{0.13739122}{0.03} \\approx 4.579707 $$\nFor the second part:\n$$ \\sum_{t=6}^{8} \\frac{1}{(1.03)^t} = \\sum_{t=1}^{8} \\frac{1}{(1.03)^t} - \\sum_{t=1}^{5} \\frac{1}{(1.03)^t} $$\n$$ \\sum_{t=1}^{8} \\frac{1}{(1.03)^t} = \\frac{1-(1.03)^{-8}}{0.03} \\approx \\frac{1-0.78940923}{0.03} \\approx \\frac{0.21059077}{0.03} \\approx 7.019692 $$\nSo,\n$$ \\sum_{t=6}^{8} \\frac{1}{(1.03)^t} \\approx 7.019692 - 4.579707 \\approx 2.439985 $$\nNow, substitute these sums back into the expression for $Q_{\\text{discounted}}$:\n$$Q_{\\text{discounted}} \\approx (0.8 \\times 4.579707) + (0.6 \\times 2.439985)$$\n$$Q_{\\text{discounted}} \\approx 3.6637656 + 1.463991$$\n$$Q_{\\text{discounted}} \\approx 5.1277566$$\nRounding to four significant figures gives $5.128$ QALYs.\n\n### Summary of Results\n-   The total undiscounted QALYs are calculated to be $5.800$.\n-   The total discounted QALYs at a $3\\%$ annual rate are calculated to be $5.128$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.800  5.128\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After quantifying the costs and benefits (in QALYs) of different health strategies, the next step is to compare them systematically to inform decision-making. This practice introduces the foundational method of incremental cost-effectiveness analysis, where interventions are compared sequentially. You will learn to identify and eliminate inefficient strategies through the concepts of strict and extended dominance, ultimately constructing a cost-effectiveness frontier and calculating the Incremental Cost-Effectiveness Ratios (ICERs) that guide policy choices. ",
            "id": "5051586",
            "problem": "A health system considering four alternative implementation strategies for a newly validated translational intervention requests a cost-effectiveness analysis consistent with the principles of Health Economics and Outcomes Research (HEOR). The effectiveness metric is quality-adjusted life years (QALYs), and the perspective is a single-payer healthcare system. For each strategy, you are given the expected present value of per-patient costs and the expected per-patient QALYs over a $5$-year horizon. All costs and QALYs are already risk-adjusted and discounted at a consistent rate across strategies. The strategies are:\n\n- Strategy $\\mathcal{A}$ (status quo): cost $C_{\\mathcal{A}} = 35{,}000$ and QALYs $E_{\\mathcal{A}} = 3.20$.\n- Strategy $\\mathcal{B}$ (clinic-based protocol): cost $C_{\\mathcal{B}} = 42{,}000$ and QALYs $E_{\\mathcal{B}} = 3.45$.\n- Strategy $\\mathcal{C}$ (digital adjunct): cost $C_{\\mathcal{C}} = 46{,}000$ and QALYs $E_{\\mathcal{C}} = 3.40$.\n- Strategy $\\mathcal{D}$ (combined protocol): cost $C_{\\mathcal{D}} = 54{,}000$ and QALYs $E_{\\mathcal{D}} = 3.60$.\n\nTasks:\n1. Order the strategies by effectiveness from least to most effective using $E$.\n2. Compute incremental cost and QALY differences between adjacent strategies in this order.\n3. Identify any strictly dominated or extendedly dominated strategies and remove them to form the cost-effectiveness frontier.\n4. Along the non-dominated frontier, compute the incremental cost-effectiveness ratios (ICERs) between adjacent strategies.\n\nReport only the ICERs along the frontier, in United States dollars per QALY, rounded to four significant figures, and provide them in increasing effectiveness order as a single row matrix. Do not include units in your final reported matrix; however, all ICERs must be computed and interpreted in dollars per QALY.",
            "solution": "The problem provides cost and effectiveness data for four alternative healthcare strategies and asks for the computation of incremental cost-effectiveness ratios (ICERs) along the efficient frontier. The analysis will proceed by first ordering the strategies by effectiveness, then identifying and eliminating any dominated strategies (both strictly and extendedly dominated), and finally calculating the ICERs for the remaining sequence of non-dominated strategies.\n\nThe provided data are:\n- Strategy $\\mathcal{A}$: Cost $C_{\\mathcal{A}} = \\$35{,}000$, Effectiveness $E_{\\mathcal{A}} = 3.20$ QALYs.\n- Strategy $\\mathcal{B}$: Cost $C_{\\mathcal{B}} = \\$42{,}000$, Effectiveness $E_{\\mathcal{B}} = 3.45$ QALYs.\n- Strategy $\\mathcal{C}$: Cost $C_{\\mathcal{C}} = \\$46{,}000$, Effectiveness $E_{\\mathcal{C}} = 3.40$ QALYs.\n- Strategy $\\mathcal{D}$: Cost $C_{\\mathcal{D}} = \\$54{,}000$, Effectiveness $E_{\\mathcal{D}} = 3.60$ QALYs.\n\n**Step 1: Order Strategies by Effectiveness**\nThe first step in a cost-effectiveness analysis is to order the alternative strategies from least to most effective based on the health outcome metric, which is Quality-Adjusted Life Years (QALYs) in this case.\n\nThe effectiveness values are:\n$E_{\\mathcal{A}} = 3.20$\n$E_{\\mathcal{C}} = 3.40$\n$E_{\\mathcal{B}} = 3.45$\n$E_{\\mathcal{D}} = 3.60$\n\nOrdering the strategies by increasing effectiveness ($E$) yields the sequence: $\\mathcal{A}$, $\\mathcal{C}$, $\\mathcal{B}$, $\\mathcal{D}$. Let's list their costs and effectiveness in this order:\n1. Strategy $\\mathcal{A}$: $C = \\$35{,}000$, $E = 3.20$\n2. Strategy $\\mathcal{C}$: $C = \\$46{,}000$, $E = 3.40$\n3. Strategy $\\mathcal{B}$: $C = \\$42{,}000$, $E = 3.45$\n4. Strategy $\\mathcal{D}$: $C = \\$54{,}000$, $E = 3.60$\n\n**Step 2: Identify and Remove Dominated Strategies**\nA strategy is dominated if there is an alternative strategy or a combination of strategies that provides better outcomes at a lower cost. We first check for strict dominance, then for extended dominance.\n\n**Strict Dominance:** A strategy is strictly dominated if another strategy is both more effective and less costly.\nLet us examine the ordered list. When moving from Strategy $\\mathcal{C}$ to Strategy $\\mathcal{B}$, we observe that Strategy $\\mathcal{B}$ is more effective than Strategy $\\mathcal{C}$ ($E_{\\mathcal{B}} = 3.45 > E_{\\mathcal{C}} = 3.40$) and is also less costly ($C_{\\mathcal{B}} = \\$42{,}000  C_{\\mathcal{C}} = \\$46{,}000$). Therefore, Strategy $\\mathcal{C}$ is strictly dominated by Strategy $\\mathcal{B}$. Any rational decision-maker would prefer $\\mathcal{B}$ over $\\mathcal{C}$, so $\\mathcal{C}$ is removed from further consideration.\n\nAfter removing the strictly dominated strategy $\\mathcal{C}$, the remaining strategies, ordered by effectiveness, are:\n1. Strategy $\\mathcal{A}$: $C = \\$35{,}000$, $E = 3.20$\n2. Strategy $\\mathcal{B}$: $C = \\$42{,}000$, $E = 3.45$\n3. Strategy $\\mathcal{D}$: $C = \\$54{,}000$, $E = 3.60$\nIn this reduced set, both cost and effectiveness increase monotonically.\n\n**Extended Dominance:** A strategy is subject to extended dominance (or is indirectly dominated) if the ICER associated with moving to it from the previous non-dominated strategy is greater than the ICER of moving from it to the next non-dominated strategy. This implies that the strategy lies above the line segment connecting its neighbors on the cost-effectiveness plane, making it an inefficient choice. The ICER between two strategies, $X$ and $Y$ (where $Y$ is more effective), is defined as:\n$$ \\text{ICER}_{X \\to Y} = \\frac{C_Y - C_X}{E_Y - E_X} $$\n\nWe calculate the ICER for each adjacent pair in the sequence $\\mathcal{A} \\to \\mathcal{B} \\to \\mathcal{D}$.\n\nFirst, the ICER for moving from $\\mathcal{A}$ to $\\mathcal{B}$:\n$$ \\text{ICER}_{\\mathcal{A} \\to \\mathcal{B}} = \\frac{C_{\\mathcal{B}} - C_{\\mathcal{A}}}{E_{\\mathcal{B}} - E_{\\mathcal{A}}} = \\frac{\\$42{,}000 - \\$35{,}000}{3.45 - 3.20} = \\frac{\\$7{,}000}{0.25} = \\$28{,}000 \\text{ per QALY} $$\n\nNext, the ICER for moving from $\\mathcal{B}$ to $\\mathcal{D}$:\n$$ \\text{ICER}_{\\mathcal{B} \\to \\mathcal{D}} = \\frac{C_{\\mathcal{D}} - C_{\\mathcal{B}}}{E_{\\mathcal{D}} - E_{\\mathcal{B}}} = \\frac{\\$54{,}000 - \\$42{,}000}{3.60 - 3.45} = \\frac{\\$12{,}000}{0.15} = \\$80{,}000 \\text{ per QALY} $$\n\nTo check for extended dominance of strategy $\\mathcal{B}$, we compare these two ICERs. A strategy is not extendedly dominated if the ICERs are increasing.\nWe have $\\text{ICER}_{\\mathcal{A} \\to \\mathcal{B}} = \\$28{,}000$ and $\\text{ICER}_{\\mathcal{B} \\to \\mathcal{D}} = \\$80{,}000$. Since $\\$28{,}000  \\$80{,}000$, the ICER is increasing. This indicates that Strategy $\\mathcal{B}$ is not extendedly dominated and lies on the convex cost-effectiveness frontier.\n\n**Step 3: Report the ICERs on the Cost-Effectiveness Frontier**\nThe cost-effectiveness frontier consists of the set of non-dominated strategies, which are $\\mathcal{A}$, $\\mathcal{B}$, and $\\mathcal{D}$. The path along this frontier progresses from the status quo ($\\mathcal{A}$) to $\\mathcal{B}$, and then to $\\mathcal{D}$. The ICERs on the frontier are the incremental ratios between these adjacent non-dominated strategies.\n\nThe ICERs are the values we have just calculated:\n1. The ICER for choosing Strategy $\\mathcal{B}$ over Strategy $\\mathcal{A}$ is $\\$28{,}000$ per QALY.\n2. The ICER for choosing Strategy $\\mathcal{D}$ over Strategy $\\mathcal{B}$ is $\\$80{,}000$ per QALY.\n\nThe problem requires the results to be rounded to four significant figures. Both $28{,}000$ and $80{,}000$ are exact integers calculated from the data. Written as $2.800 \\times 10^4$ and $8.000 \\times 10^4$, they have four significant figures. Thus, the numerical values are $28000$ and $80000$.\n\nThe final answer should be provided as a single row matrix containing these ICERs in increasing order of effectiveness.",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n28000  80000\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "Health economic models are built on parameters—costs, utilities, transition probabilities—that are rarely known with certainty, making decisions based on single point estimates potentially misleading. This hands-on programming exercise introduces Probabilistic Sensitivity Analysis (PSA), a powerful Monte Carlo simulation method for propagating parameter uncertainty through a model. By doing so, you will learn to quantify the impact of uncertainty on the final decision, culminating in the estimation of a point on the Cost-Effectiveness Acceptability Curve (CEAC), which expresses the probability of an intervention being cost-effective at a given willingness-to-pay threshold. ",
            "id": "5051490",
            "problem": "A translational medicine team must decide whether a new intervention is cost-effective under uncertainty, using the principles of Health Economics and Outcomes Research (HEOR). The uncertainty in incremental cost and incremental effectiveness is represented by random variables. The decision rule is based on Net Monetary Benefit (NMB) at a willingness-to-pay threshold per unit of effectiveness.\n\nFundamental base:\n- Decision theory under uncertainty: a decision is preferred if its expected utility exceeds the comparator. In cost-effectiveness analysis, a monetary transformation allows comparison via net benefit.\n- Definitions: Let $\\Delta C$ denote incremental cost (new intervention minus comparator, measured in dollars), and $\\Delta E$ denote incremental effectiveness (new intervention minus comparator, measured in quality-adjusted life years). The Net Monetary Benefit at threshold $\\lambda$ dollars per quality-adjusted life year is $NMB_{\\lambda} = \\lambda \\Delta E - \\Delta C$.\n- Cost-effectiveness decision: the intervention is cost-effective at $\\lambda$ if $NMB_{\\lambda} > 0$.\n- Probabilistic Sensitivity Analysis (PSA): Under parameter uncertainty represented by probability distributions for $\\Delta C$ and $\\Delta E$, the Cost-Effectiveness Acceptability Curve (CEAC) at $\\lambda$ is the probability $\\mathbb{P}(NMB_{\\lambda} > 0)$ computed across the joint distribution of $(\\Delta C, \\Delta E)$.\n\nTask:\n- You are given a set of parameter distributions for $(\\Delta C, \\Delta E)$ modeled as a bivariate normal distribution for each test case. For a fixed willingness-to-pay threshold $\\lambda = \\$100{,}000$ per quality-adjusted life year, use Monte Carlo simulation (Probabilistic Sensitivity Analysis) with $100{,}000$ independent draws to estimate $\\mathbb{P}(NMB_{\\lambda} > 0)$, which is a single point on the Cost-Effectiveness Acceptability Curve (CEAC).\n- Units and outputs: $\\Delta C$ is in dollars, $\\Delta E$ is in quality-adjusted life years, and $\\lambda$ is in dollars per quality-adjusted life year. Your program must output the estimated probabilities as decimals (not percentages). Round each probability to six decimal places.\n- Randomness: Use a fixed random seed of $12345$ to ensure reproducibility.\n\nMathematical specification:\n- For each test case $i$, $(\\Delta C_i, \\Delta E_i)$ follows a bivariate normal distribution with mean vector $\\boldsymbol{\\mu}_i = (\\mu_{C,i}, \\mu_{E,i})$ and covariance matrix\n$$\n\\boldsymbol{\\Sigma}_i =\n\\begin{pmatrix}\n\\sigma_{C,i}^2  \\rho_i \\, \\sigma_{C,i} \\sigma_{E,i} \\\\\n\\rho_i \\, \\sigma_{C,i} \\sigma_{E,i}  \\sigma_{E,i}^2\n\\end{pmatrix}.\n$$\n- For each draw, compute $NMB_{\\lambda} = \\lambda \\, \\Delta E - \\Delta C$ and record whether $NMB_{\\lambda} > 0$.\n- Estimate $\\mathbb{P}(NMB_{\\lambda} > 0)$ by the Monte Carlo proportion of draws with $NMB_{\\lambda} > 0$.\n\nTest suite:\nProvide the following five test cases, each specified by $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho)$:\n\n1. Happy-path scenario with positive mean incremental effectiveness and positive mean incremental cost, moderate correlation:\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (20000, 10000, 0.30, 0.15, 0.30)$.\n2. Cost-neutral on average with uncertain cost and effectiveness, no correlation:\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (0, 15000, 0.10, 0.12, 0.00)$.\n3. Cost-saving with small effectiveness gain, slight negative correlation:\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (-5000, 7000, 0.05, 0.05, -0.20)$.\n4. Dominated tendency with negative effectiveness and positive cost, weak positive correlation:\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (15000, 5000, -0.02, 0.05, 0.10)$.\n5. Near-zero effectiveness with moderate positive cost, zero correlation (boundary behavior dominated by cost):\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (5000, 3000, 0.00, 0.0001, 0.00)$.\n\nComputation requirements:\n- For each test case, run $100{,}000$ draws from the specified bivariate normal distribution, then compute the Monte Carlo estimate of $\\mathbb{P}(NMB_{\\lambda} > 0)$ at $\\lambda = \\$100{,}000$ per quality-adjusted life year.\n- Express the final output as a single line containing the results as a comma-separated list of floats enclosed in square brackets, ordered according to the test suite above. For example: \"[p1,p2,p3,p4,p5]\".\n- Each float must be rounded to six decimal places, and no additional text must be printed.\n\nInterpretation requirement:\n- Although your program outputs only the probabilities at $\\lambda = \\$100{,}000$ per quality-adjusted life year, the underlying computational procedure estimates points on the Cost-Effectiveness Acceptability Curve (CEAC). Interpret these probabilities as the likelihood (on a $[0,1]$ scale) that the new intervention is cost-effective at the specified threshold under the modeled uncertainty.",
            "solution": "The problem has been validated and is deemed valid. It is scientifically grounded in the principles of health economic evaluation, well-posed with a clear computational task, and objective in its formulation. All necessary parameters and conditions are provided, and there are no internal contradictions, factual errors, or ambiguities.\n\nThe core task is to estimate the probability that a new medical intervention is cost-effective, given a willingness-to-pay threshold $\\lambda$ and uncertainty in its incremental cost and effectiveness. This probability corresponds to a point on the Cost-Effectiveness Acceptability Curve (CEAC). The problem specifies a Monte Carlo simulation approach, also known as Probabilistic Sensitivity Analysis (PSA) in this context.\n\nThe decision criterion for cost-effectiveness is based on the Net Monetary Benefit ($NMB$), defined as:\n$$NMB_{\\lambda} = \\lambda \\Delta E - \\Delta C$$\nwhere $\\Delta C$ is the incremental cost, $\\Delta E$ is the incremental effectiveness, and $\\lambda$ is the willingness-to-pay threshold. An intervention is considered cost-effective if $NMB_{\\lambda} > 0$.\n\nThe problem states that the pair of random variables $(\\Delta C, \\Delta E)$ follows a bivariate normal distribution, characterized by a mean vector $\\boldsymbol{\\mu} = (\\mu_C, \\mu_E)$ and a covariance matrix $\\boldsymbol{\\Sigma}$. For each test case $i$, the specific parameters $(\\mu_{C,i}, \\sigma_{C,i}, \\mu_{E,i}, \\sigma_{E,i}, \\rho_i)$ are given, which fully define the distribution:\n$$\n\\boldsymbol{\\mu}_i = (\\mu_{C,i}, \\mu_{E,i})\n$$\n$$\n\\boldsymbol{\\Sigma}_i =\n\\begin{pmatrix}\n\\sigma_{C,i}^2  \\rho_i \\, \\sigma_{C,i} \\sigma_{E,i} \\\\\n\\rho_i \\, \\sigma_{C,i} \\sigma_{E,i}  \\sigma_{E,i}^2\n\\end{pmatrix}\n$$\nThe objective is to estimate $\\mathbb{P}(NMB_{\\lambda} > 0)$ for a fixed threshold $\\lambda = \\$100,000$.\n\nThe Monte Carlo simulation procedure is as follows:\n1.  **Initialization**: A random number generator is initialized with a fixed seed of $12345$ to ensure the reproducibility of the results. The number of draws for the simulation is set to $N = 100,000$.\n2.  **Sampling**: For each test case, $N = 100,000$ independent samples, denoted by $(\\Delta C_j, \\Delta E_j)$ for $j = 1, \\dots, N$, are drawn from the specified bivariate normal distribution $\\mathcal{N}(\\boldsymbol{\\mu}_i, \\boldsymbol{\\Sigma}_i)$.\n3.  **Calculation of NMB**: For each of the $N$ simulated pairs, the $NMB$ is calculated using the given threshold $\\lambda = \\$100,000$:\n    $$NMB_j = \\lambda \\Delta E_j - \\Delta C_j$$\n4.  **Estimation of Probability**: The probability $\\mathbb{P}(NMB_{\\lambda} > 0)$ is estimated by the proportion of simulated samples for which the $NMB$ is positive. This is calculated as:\n    $$\\hat{P} = \\frac{1}{N} \\sum_{j=1}^{N} \\mathbb{I}(NMB_j > 0)$$\n    where $\\mathbb{I}(\\cdot)$ is the indicator function, which equals $1$ if its argument is true and $0$ otherwise. This is computationally equivalent to counting the number of positive $NMB$ values and dividing by the total number of draws, $N$.\n5.  **Output Formatting**: The final estimated probability for each test case is rounded to six decimal places.\n\nThis procedure will be executed for each of the five test cases provided. The implementation will leverage vectorization for efficiency by generating all $100,000$ samples at once and performing array-wise computations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the probability of cost-effectiveness for a new intervention\n    using Monte Carlo simulation (Probabilistic Sensitivity Analysis).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu_C, sigma_C, mu_E, sigma_E, rho)\n    test_cases = [\n        (20000, 10000, 0.30, 0.15, 0.30),\n        (0, 15000, 0.10, 0.12, 0.00),\n        (-5000, 7000, 0.05, 0.05, -0.20),\n        (15000, 5000, -0.02, 0.05, 0.10),\n        (5000, 3000, 0.00, 0.0001, 0.00),\n    ]\n\n    # Constants from the problem statement\n    lambda_val = 100000  # Willingness-to-pay threshold\n    num_draws = 100000   # Number of Monte Carlo draws\n    seed = 12345         # Fixed random seed for reproducibility\n\n    # Initialize the random number generator\n    rng = np.random.default_rng(seed)\n\n    results = []\n    for case in test_cases:\n        mu_C, sigma_C, mu_E, sigma_E, rho = case\n\n        # Construct the mean vector and covariance matrix\n        mean_vector = np.array([mu_C, mu_E])\n        \n        # Covariance between C and E\n        cov_C_E = rho * sigma_C * sigma_E\n        \n        # Covariance matrix\n        cov_matrix = np.array([\n            [sigma_C**2, cov_C_E],\n            [cov_C_E, sigma_E**2]\n        ])\n\n        # Generate N draws from the bivariate normal distribution\n        samples = rng.multivariate_normal(mean_vector, cov_matrix, size=num_draws)\n        \n        # Extract incremental cost and effectiveness samples\n        delta_C_samples = samples[:, 0]\n        delta_E_samples = samples[:, 1]\n\n        # Calculate Net Monetary Benefit (NMB) for each draw\n        nmb_samples = lambda_val * delta_E_samples - delta_C_samples\n\n        # Calculate the proportion of draws where NMB  0\n        probability = np.mean(nmb_samples  0)\n\n        # Round the result to six decimal places\n        rounded_prob = round(probability, 6)\n        results.append(rounded_prob)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}