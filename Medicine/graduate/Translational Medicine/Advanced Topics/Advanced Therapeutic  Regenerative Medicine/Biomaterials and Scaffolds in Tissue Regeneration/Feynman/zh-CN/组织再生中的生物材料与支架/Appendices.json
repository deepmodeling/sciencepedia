{
    "hands_on_practices": [
        {
            "introduction": "可降解支架设计的核心在于其降解速率必须与新组织的再生速率相匹配。本练习将通过一个理想化的聚乳酸-乙醇酸共聚物（PLGA）支架模型，帮助你运用一阶动力学来量化材料的降解过程。通过这个实践，你将学会计算支架的降解半衰期和降解产物（如乳酸）的瞬时生成速率，这些都是评估生物相容性和组织反应的关键参数。",
            "id": "4995055",
            "problem": "一个由乳酸:乙醇酸摩尔比为 $75:25$ 的聚乳酸-乙醇酸共聚物 (PLGA) 制成的多孔支架被植入中性水环境中，其酯键发生均匀的水解断裂，无自催化或扩散限制。假设支架的干重 $m(t)$ 遵循一级水解动力学，即瞬时质量损失速率与剩余质量成正比。初始干重为 $m(0)=200\\,\\mathrm{mg}$，测得的一级速率常数为 $k=0.02\\,\\mathrm{day^{-1}}$。假设每单位损失的质量立即以可溶性单体的形式释放，其中乳酸的质量分数等于乳酸共聚单体的分数 $f_{\\mathrm{L}}=0.75$，乙醇酸的质量分数为 $f_{\\mathrm{G}}=0.25$。忽略任何副反应。\n\n从一级衰减的基本质量平衡出发，推导质量损失 $50\\%$ 所需的时间，并计算在 $t=10\\,\\mathrm{days}$ 时的瞬时乳酸生成速率。将质量损失 $50\\%$ 所需的时间以 $\\mathrm{days}$ 为单位表示，将乳酸生成速率以 $\\mathrm{mg/day}$ 为单位表示。将两个量都四舍五入到四位有效数字。按指定顺序提供您的最终答案，包含两个值。",
            "solution": "首先将对问题陈述的科学合理性、完整性和客观性进行验证。\n\n### 步骤1：提取已知条件\n问题陈述中提供的数据和条件如下：\n-   支架材料：聚乳酸-乙醇酸共聚物 (PLGA)，乳酸:乙醇酸摩尔比为 $75:25$。\n-   降解过程：在中性水环境中酯键的均匀水解断裂。\n-   动力学模型：一级动力学，其中质量损失速率与剩余质量成正比。忽略自催化和扩散限制。\n-   初始质量：$m(0) = 200\\,\\mathrm{mg}$。\n-   速率常数：$k = 0.02\\,\\mathrm{day^{-1}}$。\n-   产物组成假设：释放的乳酸的质量分数为 $f_{\\mathrm{L}} = 0.75$，释放的乙醇酸的质量分数为 $f_{\\mathrm{G}} = 0.25$。\n-   目标：推导质量损失 $50\\%$ 所需的时间，并计算在 $t = 10\\,\\mathrm{days}$ 时的瞬时乳酸生成速率。\n-   报告数值答案：将两个量都四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于化学动力学和生物材料科学的既定原理。一级衰减是在特定条件下（例如，中性pH值，无明显自催化）PLGA支架初始体侵蚀阶段的标准且被广泛接受的模型。组织工程支架的背景是恰当的。质量分数等于摩尔分数（$f_{\\mathrm{L}} = 0.75$）的简化是一个建模假设。尽管这与精确的化学现实有所偏差——实际质量分数应根据乳酸（$\\approx 90.08\\,\\mathrm{g/mol}$）和乙醇酸（$\\approx 76.05\\,\\mathrm{g/mol}$）的摩尔质量计算，得出 $f_L \\approx 0.78$——但题目明确将其作为条件。这种简化在理论建模中很常见，用以分离和检验对核心原理的理解，本例中即为一级动力学。它没有违反基本定律，而是定义了待求解特定模型的参数。\n2.  **适定性**：该问题是适定的。它提供了明确的目标和所有必要的数据（$m(0)$, $k$, $f_{\\mathrm{L}}$ 和目标时间 $t$），足以计算出唯一解。\n3.  **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。这是一个将一级反应动力学应用于转化医学相关问题的标准练习。关于质量分数的简化假设并未使问题无效，而是其定义的一部分。我现在将继续进行解答。\n\n支架质量 $m(t)$ 的降解由一级动力学描述。其控制常微分方程为：\n$$\n\\frac{dm(t)}{dt} = -k \\cdot m(t)\n$$\n其中 $k$ 是一级速率常数。这是一个可分离的微分方程。在初始条件 $m(t=0) = m_0$ 下，我们积分如下：\n$$\n\\int_{m_0}^{m(t)} \\frac{1}{m} \\, dm = \\int_{0}^{t} -k \\, dt'\n$$\n$$\n\\ln(m(t)) - \\ln(m_0) = -kt\n$$\n$$\n\\ln\\left(\\frac{m(t)}{m_0}\\right) = -kt\n$$\n求解 $m(t)$ 得到指数衰减函数：\n$$\nm(t) = m_0 \\exp(-kt)\n$$\n\n**第一部分：质量损失 $50\\%$ 所需的时间 ($t_{1/2}$)**\n质量损失 $50\\%$ 所需的时间是降解过程的半衰期，记为 $t_{1/2}$。这是质量减少到其初始值一半时的时间，即 $m(t_{1/2}) = \\frac{1}{2}m_0$。将此代入衰减方程：\n$$\n\\frac{1}{2} m_0 = m_0 \\exp(-k t_{1/2})\n$$\n两边除以 $m_0$ 得：\n$$\n\\frac{1}{2} = \\exp(-k t_{1/2})\n$$\n为求解 $t_{1/2}$，我们对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}\n$$\n使用对数性质 $\\ln(1/x) = -\\ln(x)$：\n$$\n-\\ln(2) = -k t_{1/2}\n$$\n$$\nt_{1/2} = \\frac{\\ln(2)}{k}\n$$\n现在，我们代入给定的速率常数值 $k = 0.02\\,\\mathrm{day^{-1}}$：\n$$\nt_{1/2} = \\frac{\\ln(2)}{0.02} \\,\\mathrm{days} \\approx \\frac{0.693147...}{0.02} \\,\\mathrm{days} \\approx 34.65735... \\,\\mathrm{days}\n$$\n四舍五入到四位有效数字，质量损失 $50\\%$ 所需的时间为 $34.66\\,\\mathrm{days}$。\n\n**第二部分：在 $t = 10\\,\\mathrm{days}$ 时的瞬时乳酸生成速率**\n在任意时间 $t$ 的总质量瞬时损失速率由导数 $\\frac{dm(t)}{dt}$ 的大小给出：\n$$\n\\text{质量损失速率} = \\left|\\frac{dm(t)}{dt}\\right| = |-k \\cdot m(t)| = k \\cdot m(t) = k \\cdot m_0 \\exp(-kt)\n$$\n题目说明支架降解为可溶性单体，并且乳酸的质量分数为 $f_{\\mathrm{L}} = 0.75$。因此，瞬时乳酸 (LA) 生成速率 $R_{\\mathrm{LA}}(t)$ 是总质量损失速率的 $f_{\\mathrm{L}}$ 倍。\n$$\nR_{\\mathrm{LA}}(t) = f_{\\mathrm{L}} \\cdot \\left(k \\cdot m_0 \\exp(-kt)\\right)\n$$\n我们需要计算在 $t = 10\\,\\mathrm{days}$ 时的这个速率。已知 $m_0 = 200\\,\\mathrm{mg}$，$k = 0.02\\,\\mathrm{day^{-1}}$，以及 $f_{\\mathrm{L}} = 0.75$。\n$$\nR_{\\mathrm{LA}}(10) = (0.75) \\cdot (0.02\\,\\mathrm{day^{-1}}) \\cdot (200\\,\\mathrm{mg}) \\cdot \\exp(-(0.02\\,\\mathrm{day^{-1}}) \\cdot (10\\,\\mathrm{days}))\n$$\n$$\nR_{\\mathrm{LA}}(10) = (0.75 \\cdot 0.02 \\cdot 200) \\cdot \\exp(-0.2) \\,\\mathrm{mg/day}\n$$\n$$\nR_{\\mathrm{LA}}(10) = 3 \\cdot \\exp(-0.2) \\,\\mathrm{mg/day}\n$$\n现在我们计算数值：\n$$\nR_{\\mathrm{LA}}(10) \\approx 3 \\cdot 0.81873075... \\,\\mathrm{mg/day} \\approx 2.4561922... \\,\\mathrm{mg/day}\n$$\n四舍五入到四位有效数字，在 $t=10\\,\\mathrm{days}$ 时的瞬时乳酸生成速率为 $2.456\\,\\mathrm{mg/day}$。\n\n所要求的两个值是质量损失 $50\\%$ 所需的时间 ($34.66\\,\\mathrm{days}$) 和在 $10\\,\\mathrm{days}$ 时的乳酸生成速率 ($2.456\\,\\mathrm{mg/day}$)。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n34.66  2.456\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "有效的组织再生离不开支架内部高效的营养物质输运和代谢废物清除。渗透率是描述流体流过多孔介质能力的关键宏观属性，对于设计灌注式生物反应器或评估支架内物质交换至关重要。本练习要求你从流体动量守恒的基本原理出发，推导并应用达西定律，根据实验测量的压降和流速数据计算支架的固有渗透率。",
            "id": "4995007",
            "problem": "一个灌流生物反应器被用来将不可压缩的牛顿培养基稳态地流过一个均质、各向同性且宏观均匀的组织工程支架。该培养基的动力粘度为 $\\mu = 1\\,\\mathrm{mPa\\cdot s}$。在稳态操作下，一股恒定的体积流量 $Q = 1\\,\\mathrm{mL/min}$ 流经一段长度为 $L = 5\\,\\mathrm{mm}$、均匀横截面积为 $A = 1\\,\\mathrm{cm^2}$ 的支架。测得该支架段上的压降为 $\\Delta P = 5\\,\\mathrm{kPa}$。假设为蠕动流（惯性可忽略）、不可压缩、孔壁处无滑移，并且与测量的压降相比，重力效应和入口/出口效应可以忽略不计。\n\n从粘性流动的线性动量守恒出发，并对多孔介质的代表性单元体积（REV）进行体积平均，推导出宏观压力梯度和表观速度（达西速度）之间的线性本构关系。使用此关系式，用测量量 $\\Delta P$、$L$、$Q$、$A$ 和 $\\mu$ 来表示支架的固有渗透率 $k$，并计算在给定条件下的 $k$ 值。\n\n将 $k$ 的最终数值答案以 $\\mathrm{m^2}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "本问题的分析始于对其陈述的验证。\n\n### 第一步：提取已知条件\n-   **流体性质**：不可压缩的牛顿培养基，动力粘度 $\\mu = 1\\,\\mathrm{mPa\\cdot s}$。\n-   **流动条件**：稳态流，体积流量 $Q = 1\\,\\mathrm{mL/min}$。\n-   **支架几何形状**：长度为 $L = 5\\,\\mathrm{mm}$、横截面积为 $A = 1\\,\\mathrm{cm^2}$ 的均质、各向同性且宏观均匀的支架段。\n-   **测量值**：支架段上的压降为 $\\Delta P = 5\\,\\mathrm{kPa}$。\n-   **假设**：蠕动流（惯性可忽略）、不可压缩、孔壁处无滑移、重力效应可忽略、入口/出口效应可忽略。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。这是一个多孔介质内输运现象的标准问题，特别是在生物力学和组织工程的背景下。微观层面（孔隙内）流体流动的控制方程是流体线性动量守恒，也称为 Navier-Stokes 方程。所提供的假设对于描述的场景在物理上是合理的。\n1.  **蠕动流**：对于支架中典型的低速和小孔径，雷诺数非常低（$Re \\ll 1$），这为忽略惯性项 $(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}$ 提供了依据。\n2.  **不可压缩性**：像培养基这样的液体在这些压力范围内实际上是不可压缩的。\n3.  **无滑移**：这是粘性流在固体表面的标准边界条件。\n4.  **可忽略的重力/入口效应**：对于粘性压降占主导地位的水平、实验室规模的装置，这些是合理的简化。\n\n该问题是自洽的，为推导和计算提供了所有必要的数据。这些数值在物理上是现实的。因此，该问题被认为是**有效的**。\n\n### 第三步：推导与求解\n\n推导的起点是不可压缩牛顿流体的线性动量守恒。对于稳态流（$\\frac{\\partial}{\\partial t} = 0$）并忽略重力体力，该方程为：\n$$ \\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} $$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是微观速度矢量，$p$ 是微观压力，$\\mu$ 是动力粘度。\n\n问题指明了“蠕动流”，这意味着与粘性效应相比，惯性效应可以忽略。因此，惯性项 $\\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u}$ 被设为零。孔隙内的微观动量平衡简化为 Stokes 方程：\n$$ \\nabla p = \\mu \\nabla^2 \\mathbf{u} $$\n\n为了获得流动的宏观描述，我们对一个代表性单元体积（REV，记为 $V_{REV}$）进行体积平均程序。REV 足够大，可以包含许多孔隙，从而使孔隙率等宏观性质得到良好定义，但与支架的整体尺寸相比又足够小。表观速度 $\\mathbf{v}_s$ 定义为微观速度场 $\\mathbf{u}$ 在 REV 总体积上的体积平均值：\n$$ \\mathbf{v}_s = \\frac{1}{V_{REV}} \\int_{V_f} \\mathbf{u} \\, dV $$\n其中 $V_f$ 是 REV 内流体相的体积。\n\n将 Stokes 方程在流体体积 $V_f$ 上进行平均，并应用空间平均定理，可以得到宏观压力梯度与固体基质提供的阻力之间的关系。粘性项 $\\mu \\nabla^2 \\mathbf{u}$ 代表剪切应力，其在流体体积上的平均值，考虑到流固界面上的无滑移条件（$\\mathbf{u} = 0$），代表了固体基质对流体施加的总拖曳力。对于蠕动流条件下的均质各向同性介质，可以证明该拖曳力与表观速度成线性比例。\n\n体积平均过程的结果是宏观动量平衡，即著名的达西定律（Darcy's Law）：\n$$ - \\nabla P = \\frac{\\mu}{k} \\mathbf{v}_s $$\n这里，$\\nabla P$ 是宏观压力梯度，$k$ 是多孔介质的固有渗透率，$\\mathbf{v}_s$ 是表观速度。这个方程就是所要求的压力梯度和表观速度之间的线性本构关系。它可以重新排列为：\n$$ \\mathbf{v}_s = -\\frac{k}{\\mu} \\nabla P $$\n\n对于问题中描述的特定一维流动，设流动方向沿 $x$ 轴。表观速度矢量为 $\\mathbf{v}_s = v_s \\hat{\\mathbf{i}}$，压力梯度矢量为 $\\nabla P = \\frac{dP}{dx} \\hat{\\mathbf{i}}$。表观速度的大小 $v_s$ 是总体积流量 $Q$ 除以总横截面积 $A$：\n$$ v_s = \\frac{Q}{A} $$\n沿支架长度 $L$ 的宏观压力梯度可以近似为：\n$$ \\frac{dP}{dx} \\approx \\frac{P_{out} - P_{in}}{L} = -\\frac{P_{in} - P_{out}}{L} = -\\frac{\\Delta P}{L} $$\n其中 $\\Delta P > 0$ 是沿流动方向的压降。\n\n将这些表达式代入一维形式的达西定律（$v_s = -\\frac{k}{\\mu} \\frac{dP}{dx}$）：\n$$ \\frac{Q}{A} = -\\frac{k}{\\mu} \\left( -\\frac{\\Delta P}{L} \\right) $$\n$$ \\frac{Q}{A} = \\frac{k \\Delta P}{\\mu L} $$\n我们现在可以用可测量量来求解固有渗透率 $k$：\n$$ k = \\frac{Q \\mu L}{A \\Delta P} $$\n\n接下来，我们计算 $k$ 的数值。首先，所有给定值必须转换为国际单位制（SI）基本单位（米、千克、秒、帕斯卡）：\n- $Q = 1\\,\\mathrm{\\frac{mL}{min}} = 1\\,\\mathrm{\\frac{cm^3}{min}} = \\frac{10^{-6}\\,\\mathrm{m^3}}{60\\,\\mathrm{s}} = \\frac{1}{60} \\times 10^{-6}\\,\\mathrm{m^3/s}$\n- $\\mu = 1\\,\\mathrm{mPa\\cdot s} = 1 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $L = 5\\,\\mathrm{mm} = 5 \\times 10^{-3}\\,\\mathrm{m}$\n- $A = 1\\,\\mathrm{cm^2} = (10^{-2}\\,\\mathrm{m})^2 = 10^{-4}\\,\\mathrm{m^2}$\n- $\\Delta P = 5\\,\\mathrm{kPa} = 5 \\times 10^3\\,\\mathrm{Pa}$\n\n将这些值代入 $k$ 的表达式中：\n$$ k = \\frac{\\left( \\frac{1}{60} \\times 10^{-6}\\,\\mathrm{m^3/s} \\right) (1 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}) (5 \\times 10^{-3}\\,\\mathrm{m})}{(10^{-4}\\,\\mathrm{m^2}) (5 \\times 10^3\\,\\mathrm{Pa})} $$\n$$ k = \\frac{\\frac{5}{60} \\times 10^{-6} \\times 10^{-3} \\times 10^{-3}}{5 \\times 10^{-4} \\times 10^{3}} \\,\\, \\frac{\\mathrm{m^3 \\cdot Pa \\cdot s \\cdot m}}{\\mathrm{s \\cdot m^2 \\cdot Pa}} $$\n$$ k = \\frac{\\frac{1}{12} \\times 10^{-12}}{5 \\times 10^{-1}} \\,\\, \\mathrm{m^2} $$\n$$ k = \\frac{1}{12 \\times 5} \\times \\frac{10^{-12}}{10^{-1}} \\,\\, \\mathrm{m^2} $$\n$$ k = \\frac{1}{60} \\times 10^{-11} \\,\\, \\mathrm{m^2} $$\n$$ k = 0.01666... \\times 10^{-11} \\,\\, \\mathrm{m^2} $$\n$$ k = 1.666... \\times 10^{-13} \\,\\, \\mathrm{m^2} $$\n\n将结果四舍五入到三位有效数字，我们得到：\n$$ k \\approx 1.67 \\times 10^{-13}\\,\\mathrm{m^2} $$\n这个值衡量了流体流过多孔支架的难易程度，与流体本身的性质无关。",
            "answer": "$$\\boxed{1.67 \\times 10^{-13}}$$"
        },
        {
            "introduction": "生物材料的优化往往是一个复杂的多变量问题，例如，水凝胶的刚度和配体密度会协同影响细胞的粘附与功能。本练习将指导你运用实验设计（DOE）和响应面方法（RSM）这一强大的统计学工具，系统性地探索设计空间，以找到最佳的材料配方。你将通过编程构建一个中心复合设计，拟合一个二次响应模型，并最终确定能最大化细胞粘附密度的优化参数组合。",
            "id": "4995068",
            "problem": "您必须编写一个完整、可运行的程序，为一项旨在优化水凝胶硬度和配体密度以促进细胞粘附的双因素研究构建一个面心中心复合设计 (FCCD)。该研究背景为组织再生领域的生物材料与支架。研究的因素是水凝胶硬度 $s$（单位：千帕，kPa）和配体密度 $L$（单位：皮摩尔/平方厘米，pmol/cm$^2$）。响应变量是贴壁细胞密度 $A$（单位：细胞/平方毫米，cells/mm$^2$）。\n\n本任务的基础出发点包括：实验设计 (DOE) 的定义、普通最小二乘法，以及一个基本原理，即二阶多项式响应面可以在一个有界域上近似因子与生物响应之间的平滑关系。目标是仅使用第一性原理逻辑和数学定义来编写以下步骤的代码：\n\n- 在编码坐标中为两个因子构建一个 FCCD，使用析因点 $(-1,-1)$、$(1,-1)$、$(-1,1)$、$(1,1)$，轴向点 $(-1,0)$、$(1,0)$、$(0,-1)$、$(0,1)$，以及一个中心点 $(0,0)$，共计 $9$ 个设计点。对于每个测试用例，使用因子边界通过线性缩放将编码坐标映射到物理单位。\n\n- 拟合一个关于粘附力 $A$ 作为 $s$ 和 $L$ 函数的二次回归模型，该模型包含直至二阶的项和交互作用项：\n$$\n\\hat{A}(s,L) = \\beta_0 + \\beta_1 s + \\beta_2 L + \\beta_{11} s^2 + \\beta_{22} L^2 + \\beta_{12} sL,\n$$\n其中 $\\beta_0,\\beta_1,\\beta_2,\\beta_{11},\\beta_{22},\\beta_{12}$ 是通过普通最小二乘法估计的实值系数。\n\n- 通过将 $\\hat{A}$ 的梯度设为零并求解得到的线性系统，计算驻点 $(s^\\star,L^\\star)$。通过检查海森矩阵的负定性以及点是否在边界内来评估该驻点是否为可行的最大值点。如果负定性不满足或驻点位于边界之外，则通过在矩形域的所有边（如果边是凹的，则包括边上的驻点）和角点上评估模型，在边界上搜索最大值。\n\n- 实现 $K$ 折交叉验证 (CV) 以估计泛化误差。将 $9$ 个点确定性地划分为 $K$ 个折（通过索引对 $K$ 取模），并计算所有验证预测的均方根误差 (RMSE)：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( \\hat{A}_{-f(i)}(s_i,L_i) - A_i \\right)^2 },\n$$\n其中 $N$ 是总点数，$f(i)$ 是包含点 $i$ 的折，$\\hat{A}_{-f(i)}$ 是在不使用第 $f(i)$ 折数据的情况下训练的模型。\n\n以 kPa 为单位表示最佳硬度，以 pmol/cm$^2$ 为单位表示最佳配体密度，两者均四舍五入至两位小数；并以 cells/mm$^2$ 为单位表示交叉验证的 RMSE，也四舍五入至两位小数。\n\n测试套件和数据生成：\n对于每个测试用例，您将：\n- 使用指定的物理边界将 $9$ 个编码的 FCCD 点映射到物理 $(s,L)$ 值。\n- 根据每个用例给定的公式，为每个设计点生成确定性的合成粘附数据 $A_i$。\n\n测试用例 $1$（内部最大值，凹二次型）：\n- 边界：$s \\in [5.0,25.0]$ kPa, $L \\in [80.0,220.0]$ pmol/cm$^2$。\n- 折数：$K=3$。\n- 数据生成模型：\n$$\nA(s,L) = 800 - 2.0\\,(s - 12.0)^2 - 1.5\\,(L - 150.0)^2 - 0.8\\,(s - 12.0)(L - 150.0).\n$$\n\n测试用例 $2$（由于非二次项和鞍点曲率导致的边界最优值）：\n- 边界：$s \\in [10.0,30.0]$ kPa, $L \\in [20.0,100.0]$ pmol/cm$^2$。\n- 折数：$K=9$（留一法交叉验证）。\n- 数据生成模型：\n$$\nA(s,L) = 600 - 1.2\\,(s - 18.0)^2 + 0.5\\,(L - 60.0)^2 - 0.2\\,(s - 18.0)(L - 60.0) + 0.001\\,s^3.\n$$\n\n测试用例 $3$（角点最大值）：\n- 边界：$s \\in [1.0,10.0]$ kPa, $L \\in [50.0,200.0]$ pmol/cm$^2$。\n- 折数：$K=4$。\n- 数据生成模型：\n$$\nA(s,L) = 300 + 0.05\\,s + 0.02\\,L - 0.01\\,s^2 - 0.005\\,L^2 - 0.004\\,s\\,L.\n$$\n\n程序输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，是一个包含三个浮点数的列表：$[s^\\star,L^\\star,\\mathrm{RMSE}]$，其中 $s^\\star$ 的单位是 kPa（四舍五入至两位小数），$L^\\star$ 的单位是 pmol/cm$^2$（四舍五入至两位小数），$\\mathrm{RMSE}$ 的单位是 cells/mm$^2$（四舍五入至两位小数）。例如：\n$[[12.00,150.00,5.43],[\\dots],[\\dots]]$。",
            "solution": "该问题要求开发一种计算方法，以优化一个生物响应——贴壁细胞密度 $A$（单位：cells/mm$^2$），该响应是两个实验因子（水凝胶硬度 $s$，单位：$\\mathrm{kPa}$；配体密度 $L$，单位：pmol/cm$^2$）的函数。这是响应面方法 (RSM) 在生物材料工程领域中的一个经典应用。解决方案涉及一系列明确定义的步骤：实验设计、模型拟合、优化和验证。\n\n首先，必须构建一个稳健的实验设计。问题指定了针对两个因子的面心中心复合设计 (FCCD)。在编码坐标中（因子被缩放到 $[-1, 1]$ 区间），该设计由 $N=9$ 个点组成：\n-   四个析因点，位于设计空间的角点：$(-1, -1)$、$(1, -1)$、$(-1, 1)$ 和 $(1, 1)$。\n-   四个轴向点，位于设计空间每个面的中心：$(-1, 0)$、$(1, 0)$、$(0, -1)$ 和 $(0, 1)$。\n-   一个中心点：$(0, 0)$。\n\n这些编码坐标（我们将其表示为 $(x_s, x_L)$）通过基于每个因子指定的下限和上限 $[s_{min}, s_{max}]$ 和 $[L_{min}, L_{max}]$ 的线性变换，映射到其物理单位 $(s, L)$。硬度 $s$ 的变换公式为 $s = s_{center} + x_s \\cdot s_{span}$，其中 $s_{center} = (s_{max} + s_{min})/2$ 且 $s_{span} = (s_{max} - s_{min})/2$。类似的变换也适用于配体密度 $L$。这种映射确保了实验点在感兴趣的区域内得到适当分布。对于这 $9$ 个物理点 $(s_i, L_i)$ 中的每一个，都使用所提供的特定于案例的函数生成一个合成响应值 $A_i$。\n\n其次，将一个数学模型拟合到实验数据上。问题指定了一个二阶多项式模型，这是 RSM 中的一个常用选择，因为它可以近似响应面中的曲率。该模型形式如下：\n$$\n\\hat{A}(s,L) = \\beta_0 + \\beta_1 s + \\beta_2 L + \\beta_{11} s^2 + \\beta_{22} L^2 + \\beta_{12} sL\n$$\n六个系数 $\\beta_0, \\beta_1, \\beta_2, \\beta_{11}, \\beta_{22}, \\beta_{12}$ 使用普通最小二乘法 (OLS) 进行估计。这包括建立一个设计矩阵 $\\mathbf{X}$ 和一个响应向量 $\\mathbf{y}$。$\\mathbf{X}$ 的每一行 $i$ 对应一个实验点 $(s_i, L_i)$ 并包含模型项 $[1, s_i, L_i, s_i^2, L_i^2, s_i L_i]$。响应向量 $\\mathbf{y}$ 包含观测到的粘附值 $[A_1, A_2, \\dots, A_9]^T$。然后通过求解正规方程 $\\mathbf{X}^T\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{X}^T\\mathbf{y}$ 来计算系数向量 $\\boldsymbol{\\beta} = [\\beta_0, \\dots, \\beta_{12}]^T$。通常使用一种稳健的数值方法，例如基于奇异值分解的方法，来计算解 $\\boldsymbol{\\beta} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$。\n\n第三，使用拟合模型 $\\hat{A}(s,L)$ 来寻找能最大化细胞粘附的最优因子设置 $(s^\\star, L^\\star)$。优化过程首先从搜索内部最大值开始。这通过找到响应面的驻点来完成，即梯度为零的点：$\\nabla \\hat{A}(s,L) = [0, 0]^T$。梯度分量为：\n$$\n\\frac{\\partial \\hat{A}}{\\partial s} = \\beta_1 + 2\\beta_{11}s + \\beta_{12}L = 0 \\\\\n\\frac{\\partial \\hat{A}}{\\partial L} = \\beta_2 + 2\\beta_{22}L + \\beta_{12}s = 0\n$$\n这构成了关于 $(s, L)$ 的一个 $2 \\times 2$ 线性系统，可以轻松求解。要使该驻点成为一个有效的内部最大值，必须满足两个条件：\n1.  **可行性**：点 $(s^\\star, L^\\star)$ 必须位于实验域内：$s_{min} \\le s^\\star \\le s_{max}$ 和 $L_{min} \\le L^\\star \\le L_{max}$。\n2.  **凹性**：该点处的曲面必须是向下弯曲的，这可以通过检查海森矩阵 $\\mathbf{H}$ 是否为负定来确认。\n    $$\n    \\mathbf{H} = \\begin{bmatrix} \\frac{\\partial^2 \\hat{A}}{\\partial s^2}  \\frac{\\partial^2 \\hat{A}}{\\partial s \\partial L} \\\\ \\frac{\\partial^2 \\hat{A}}{\\partial L \\partial s}  \\frac{\\partial^2 \\hat{A}}{\\partial L^2} \\end{bmatrix} = \\begin{bmatrix} 2\\beta_{11}  \\beta_{12} \\\\ \\beta_{12}  2\\beta_{22} \\end{bmatrix}\n    $$\n    负定性要求 $2\\beta_{11}  0$ 且行列式 $\\det(\\mathbf{H}) = 4\\beta_{11}\\beta_{22} - \\beta_{12}^2 > 0$。\n\n如果这些条件不满足（例如，驻点是鞍点或位于边界之外），则最优值必须位于矩形域的边界上。随后对边界进行系统性搜索。这包括在四个角点和四条边段上评估 $\\hat{A}$。在每条边上（例如，当 $s = s_{min}$ 且 $L \\in [L_{min}, L_{max}]$ 时），模型简化为关于另一个变量的一维二次函数。找到这个一维二次函数的最大值，如果它位于该线段上，则成为全局最优值的一个候选点。最终的最优值是所有候选点（角点和有效的边上最大值点）中能够产生最高预测响应 $\\hat{A}$ 的那个点。\n\n第四，使用 $K$ 折交叉验证评估模型的预测质量。这 $N=9$ 个数据点根据其索引被确定性地划分为 $K$ 个折（点 $i$ 进入第 $i \\pmod K$ 折）。对于每个折，使用来自其他 $K-1$ 个折的数据训练一个新的二次模型。然后用这个模型来预测留出折中各点的响应。这个过程对所有 $K$ 个折重复进行，从而为 $N=9$ 个原始数据点中的每一个都生成一个样本外预测。然后计算均方根误差 (RMSE) 来量化平均预测误差：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left( \\hat{A}_{-f(i)}(s_i,L_i) - A_i \\right)^2 }\n$$\n其中 $f(i)$ 是包含点 $i$ 的折，$\\hat{A}_{-f(i)}$ 是在不使用该折数据的情况下训练的模型。该指标提供了模型在新的、未见过的数据上表现如何的估计。\n\n每个测试用例的最终输出包括最优因子设置 $(s^\\star, L^\\star)$ 和计算出的 $\\mathrm{RMSE}$，所有数值均四舍五入至两位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases.\n    \"\"\"\n\n    def data_gen_case1(s, L):\n        \"\"\"Data generating function for Test Case 1.\"\"\"\n        return 800.0 - 2.0 * (s - 12.0)**2 - 1.5 * (L - 150.0)**2 - 0.8 * (s - 12.0) * (L - 150.0)\n\n    def data_gen_case2(s, L):\n        \"\"\"Data generating function for Test Case 2.\"\"\"\n        return 600.0 - 1.2 * (s - 18.0)**2 + 0.5 * (L - 60.0)**2 - 0.2 * (s - 18.0) * (L - 60.0) + 0.001 * s**3\n\n    def data_gen_case3(s, L):\n        \"\"\"Data generating function for Test Case 3.\"\"\"\n        return 300.0 + 0.05 * s + 0.02 * L - 0.01 * s**2 - 0.005 * L**2 - 0.004 * s * L\n\n    test_cases = [\n        {\n            \"bounds\": (5.0, 25.0, 80.0, 220.0), # s_min, s_max, L_min, L_max\n            \"k_folds\": 3,\n            \"data_gen_func\": data_gen_case1\n        },\n        {\n            \"bounds\": (10.0, 30.0, 20.0, 100.0),\n            \"k_folds\": 9,\n            \"data_gen_func\": data_gen_case2\n        },\n        {\n            \"bounds\": (1.0, 10.0, 50.0, 200.0),\n            \"k_folds\": 4,\n            \"data_gen_func\": data_gen_case3\n        }\n    ]\n\n    # Standard 2-factor FCCD in coded units\n    coded_points = np.array([\n        [-1., -1.], [ 1., -1.], [-1.,  1.], [ 1.,  1.], # Factorial\n        [-1.,  0.], [ 1.,  0.], [ 0., -1.], [ 0.,  1.], # Axial\n        [ 0.,  0.]                                    # Center\n    ])\n\n    results = []\n    for case in test_cases:\n        s_min, s_max, L_min, L_max = case[\"bounds\"]\n        \n        # 1. Map coded points to physical units\n        s_center, s_span = (s_max + s_min) / 2, (s_max - s_min) / 2\n        L_center, L_span = (L_max + L_min) / 2, (L_max - L_min) / 2\n        \n        s_physical = s_center + coded_points[:, 0] * s_span\n        L_physical = L_center + coded_points[:, 1] * L_span\n        physical_points = np.vstack([s_physical, L_physical]).T\n\n        # 2. Generate synthetic response data\n        responses = case[\"data_gen_func\"](physical_points[:, 0], physical_points[:, 1])\n\n        # 3. Fit full model and find optimum\n        beta = _fit_quadratic_model(physical_points, responses)\n        s_opt, L_opt = _find_optimum(beta, case[\"bounds\"])\n\n        # 4. Perform K-fold cross-validation\n        rmse = _calculate_cv_rmse(physical_points, responses, case[\"k_folds\"])\n        \n        results.append([round(s_opt, 2), round(L_opt, 2), round(rmse, 2)])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'[{s},{l},{r}]' for s, l, r in results)}]\")\n\ndef _get_design_matrix(physical_points):\n    \"\"\"Constructs the design matrix for a second-order model.\"\"\"\n    s = physical_points[:, 0]\n    L = physical_points[:, 1]\n    X = np.vstack([\n        np.ones(len(s)),\n        s,\n        L,\n        s**2,\n        L**2,\n        s * L\n    ]).T\n    return X\n\ndef _fit_quadratic_model(physical_points, responses):\n    \"\"\"Fits the quadratic model using OLS and returns coefficients.\"\"\"\n    X = _get_design_matrix(physical_points)\n    beta, _, _, _ = np.linalg.lstsq(X, responses, rcond=None)\n    return beta\n\ndef _find_optimum(beta, bounds):\n    \"\"\"\n    Finds the maximum of the fitted response surface within the given bounds.\n    \"\"\"\n    b0, b1, b2, b11, b22, b12 = beta\n    s_min, s_max, L_min, L_max = bounds\n\n    # Solve for stationary point: M * [s, L]' = v\n    M = np.array([[2 * b11, b12], [b12, 2 * b22]])\n    v = np.array([-b1, -b2])\n\n    s_stat, L_stat = np.nan, np.nan\n    is_max = False\n    \n    # Check if M is invertible\n    if abs(np.linalg.det(M)) > 1e-8:\n        try:\n            s_stat, L_stat = np.linalg.solve(M, v)\n        except np.linalg.LinAlgError:\n            # Singular matrix, no unique stationary point\n            pass\n\n        # Check for maximum (Hessian is negative definite)\n        # H = 2 * M\n        is_neg_def = (2 * b11  0) and (np.linalg.det(M) > 0)\n        is_in_bounds = (s_min = s_stat = s_max) and (L_min = L_stat = L_max)\n        if is_neg_def and is_in_bounds:\n            return s_stat, L_stat\n\n    # If stationary point is not an interior max, search the boundary\n    def eval_model(s, l, b):\n        return b[0] + b[1]*s + b[2]*l + b[3]*s**2 + b[4]*l**2 + b[5]*s*l\n\n    # Candidate points: start with corners\n    candidates = [\n        (s_min, L_min), (s_min, L_max),\n        (s_max, L_min), (s_max, L_max)\n    ]\n\n    # Edge s = s_min\n    if abs(b22) > 1e-8 and b22  0: # Concave in L\n        l_edge_stat = -(b2 + b12 * s_min) / (2 * b22)\n        if L_min  l_edge_stat  L_max:\n            candidates.append((s_min, l_edge_stat))\n\n    # Edge s = s_max\n    if abs(b22) > 1e-8 and b22  0: # Concave in L\n        l_edge_stat = -(b2 + b12 * s_max) / (2 * b22)\n        if L_min  l_edge_stat  L_max:\n            candidates.append((s_max, l_edge_stat))\n\n    # Edge L = L_min\n    if abs(b11) > 1e-8 and b11  0: # Concave in s\n        s_edge_stat = -(b1 + b12 * L_min) / (2 * b11)\n        if s_min  s_edge_stat  s_max:\n            candidates.append((s_edge_stat, L_min))\n            \n    # Edge L = L_max\n    if abs(b11) > 1e-8 and b11  0: # Concave in s\n        s_edge_stat = -(b1 + b12 * L_max) / (2 * b11)\n        if s_min  s_edge_stat  s_max:\n            candidates.append((s_edge_stat, L_max))\n    \n    best_point = candidates[0]\n    max_A = -np.inf\n    \n    for s_c, L_c in candidates:\n        A_c = eval_model(s_c, L_c, beta)\n        if A_c > max_A:\n            max_A = A_c\n            best_point = (s_c, L_c)\n    \n    return best_point\n\ndef _calculate_cv_rmse(physical_points, responses, k_folds):\n    \"\"\"\n    Calculates the K-fold cross-validated RMSE.\n    \"\"\"\n    n_points = len(responses)\n    predictions = np.zeros(n_points)\n    indices = np.arange(n_points)\n\n    for i in range(k_folds):\n        val_mask = (indices % k_folds) == i\n        train_mask = ~val_mask\n\n        # Handle case where a fold might be empty if K > n_points\n        if not np.any(val_mask):\n            continue\n        \n        # Some partitions can result in too few points to fit the model\n        if np.sum(train_mask)  6:\n             # Cannot fit model, skip fold. For this problem, not expected.\n             # Setting prediction to mean of training data is a fallback.\n             predictions[val_mask] = np.mean(responses[train_mask]) if np.any(train_mask) else 0\n             continue\n\n        train_points = physical_points[train_mask]\n        train_responses = responses[train_mask]\n        \n        val_points = physical_points[val_mask]\n\n        beta_cv = _fit_quadratic_model(train_points, train_responses)\n        \n        X_val = _get_design_matrix(val_points)\n        predictions[val_mask] = X_val @ beta_cv\n        \n    rmse = np.sqrt(np.mean((predictions - responses)**2))\n    return rmse\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}