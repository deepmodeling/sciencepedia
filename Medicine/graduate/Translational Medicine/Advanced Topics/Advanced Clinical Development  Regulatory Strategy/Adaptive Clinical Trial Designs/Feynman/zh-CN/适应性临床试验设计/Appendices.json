{
    "hands_on_practices": [
        {
            "introduction": "尽管根据期中数据调整试验设计极具吸引力，但天真地进行调整可能会导致严重的统计错误，特别是增加 I 类错误。本练习 () 旨在挑战您深入思考一种常见但有缺陷的方法（即非盲态样本量调整）所带来的统计后果。通过本练习，您将理解为何组合检验和条件错误率等有效方法对于维持试验的统计严谨性至关重要，从而为后续的实践应用奠定坚实的理论基础。",
            "id": "4987211",
            "problem": "一个转化医学团队正在计划一项两阶段适应性优效性试验，该试验在一个已知方差为 $\\sigma^2 = 1$ 的连续终点上，比较一种新疗法与对照组。设 $\\theta$ 表示均值差异（新疗法减去对照组），并考虑在单侧显著性水平 $\\alpha \\in (0,1)$ 下检验 $H_0: \\theta = 0$ 与 $H_1: \\theta > 0$。第一阶段每组招募 $n_1$ 名患者，并通过常规的 $Z$ 检验产生一个非盲期中统计量 $Z_1$。原计划的总样本量对应于第二阶段额外招募每组 $n_{2,0}$ 名患者，原计划的固定设计最终分析使用常规的合并 $Z$ 统计量和临界值 $\\Phi^{-1}(1-\\alpha)$，其中 $\\Phi$ 是标准正态累积分布函数。试验没有因有效性提前终止的规则，所有患者都将进入最终分析。\n\n在期中分析时，申办方实施了一项非盲的、数据驱动的样本量增加规则：如果 $Z_1$ 落在一个预先设定的正值“希望区域”（为具体起见，一个具有非零 Lebesgue 测度的 Borel 集 $S \\subset (0,\\infty)$）内，则第二阶段的样本量增加到 $n_{2,+} > n_{2,0}$；否则第二阶段的样本量保持为 $n_{2,0}$。没有预先设定多重性调整，在试验结束时，研究者使用所有第一阶段和第二阶段的观测数据计算常规的合并 $Z$ 统计量，并将其与标准正态临界值 $\\Phi^{-1}(1-\\alpha)$ 进行比较，实际上是“如同”该设计是固定的一样进行分析。\n\n请基于适用于适应性临床试验的基本原则进行分析，具体包括：(i) 在 $H_0$ 下，阶段性增量是独立的且服从中心极限定理行为，这意味着当样本量固定时，阶段性标准化的 $Z$ 统计量是独立且服从标准正态分布的；(ii) 全概率定律以及以期中统计量 $Z_1$ 为条件进行分析。基于这些原则，分析在第二阶段样本量如上所述依赖于 $Z_1$ 的情况下，最终合并 $Z$ 统计量在 $H_0$ 下的分布，并论证适应性组合检验或条件误差方法如何恢复已知的零分布并严格控制 I 型错误。\n\n选择所有正确的陈述。\n\nA. 在 $H_0$ 下，朴素的最终合并 $Z$ 统计量（使用常规固定设计公式和标准正态临界值计算）仍然精确服从 $N(0,1)$ 分布，因为即使 $n_2$ 是 $Z_1$ 的函数，阶段性独立性也确保了其有效性。\n\nB. 在 $H_0$ 下，当样本量增加规则对于 $Z_1 \\in S \\subset (0,\\infty)$ 减小了第一阶段的最终权重时，朴素的最终合并 $Z$ 统计量是一个正态混合分布，其条件均值为 $E\\!\\left[Z_{\\text{final}} \\mid Z_1 = z\\right] = \\sqrt{w(z)}\\, z$，条件方差为 $1 - w(z)$，其中 $w(z)$ 是调整后的第一阶段信息分数。对于 $S$ 中不极端的 $z$ 值，减小 $w(z)$ 会增加在固定临界值 $\\Phi^{-1}(1-\\alpha)$ 下的单侧拒绝概率，从而导致 I 型错误的膨胀。\n\nC. 一个预先设定的逆正态组合检验，该检验使用固定的、预先设定的权重来组合阶段性 p 值，在 $H_0$ 下会产生一个正态分布的组合统计量，无论 $n_2$ 如何被选为 $Z_1$ 的函数，该统计量都是有效的。\n\nD. 条件误差原则通过以下要求来严格控制无条件的 I 型错误：对于每个实现的期中值 $Z_1 = z$，由调整后的第二阶段分析所引致的在 $H_0$ 下的最终拒绝条件概率，不得超过给定 $Z_1=z$ 时原始设计的条件误差。\n\nE. 如果该团队在期中进行盲法样本量重新估计，且该估计仅基于一个与 $Z_1$ 独立且不使用任何 $\\theta$ 的非盲估计的方差估计值，那么在 $H_0$ 下，最终的合并 $Z$ 统计量将保持标准正态零分布和名义单侧 I 型错误，无需额外调整。",
            "solution": "用户希望我扮演一位严谨的 STEM 教授，解决一个关于适应性临床试验设计的问题。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n\n*   **试验设计**：一个两阶段适应性优效性试验。\n*   **假设**：$H_0: \\theta = 0$ 对 $H_1: \\theta > 0$，其中 $\\theta$ 是均值差异（新疗法减去对照组）。\n*   **终点**：连续型，已知方差 $\\sigma^2 = 1$。\n*   **显著性水平**：单侧 $\\alpha \\in (0,1)$。\n*   **第一阶段**：每组 $n_1$ 名患者，产生期中 $Z$ 统计量 $Z_1$。\n*   **原第二阶段计划**：每组 $n_{2,0}$ 名患者。\n*   **原最终分析计划**：使用临界值为 $\\Phi^{-1}(1-\\alpha)$ 的合并 $Z$ 统计量。\n*   **终止规则**：无因有效性提前终止。\n*   **适应性规则**：非盲样本量重新估计 (SSR)。\n    *   若 $Z_1 \\in S \\subset (0,\\infty)$ (一个预设的“希望区域”)，第二阶段样本量增加到 $n_{2,+}$，其中 $n_{2,+} > n_{2,0}$。\n    *   否则，第二阶段样本量保持为 $n_{2,0}$。\n*   **实际最终分析**：采用朴素方法。使用调整后的样本量计算常规合并 $Z$ 统计量，并与固定设计的临界值 $\\Phi^{-1}(1-\\alpha)$ 进行比较。\n*   **要求使用的原则**：(i) 在 $H_0$ 下，独立的、服从标准正态分布的阶段性 $Z$ 统计量（对于固定样本量）。(ii) 全概率定律和以 $Z_1$ 为条件。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学基础**：该问题基于适应性临床试验的既定统计理论。所描述的情景——基于期中效应大小的非盲样本量重新估计——是一个常见且经过充分研究的主题。I 型错误膨胀、组合检验和条件误差原则等概念是该领域的核心。该问题在科学上是合理的。\n*   **问题明确性**：该问题是明确的。它提出了一个清晰的情景，并要求分析其统计后果以及有效解决方案的原则。所提供的信息足以推断检验统计量的分布，并基于概率和统计学的基本原则评估给出的陈述。\n*   **客观性**：语言正式、精确且客观。它使用了生物统计学中的标准术语，没有歧义或主观框架。\n\n**步骤3：结论与行动**\n\n该问题陈述是**有效**的。这是一个关于临床试验统计方法的明确定义的问题。我现在将进行推导和逐项分析。\n\n**推导与分析**\n\n在零假设 $H_0: \\theta = 0$ 和已知方差 $\\sigma^2 = 1$ 的情况下，可以定义阶段性检验统计量。\n\n第一阶段的统计量为 $Z_1 = \\frac{\\hat{\\theta}_1}{\\sqrt{2/n_1}}$，其中 $\\hat{\\theta}_1$ 是第一阶段观察到的均值差异。在 $H_0$ 下，$Z_1 \\sim N(0,1)$。\n\n第二阶段的统计量，基于额外的每组 $n_2$ 名患者，为 $Z_2 = \\frac{\\hat{\\theta}_2}{\\sqrt{2/n_2}}$。在 $H_0$ 下，$Z_2 \\sim N(0,1)$。关键在于，由于第二阶段的患者是一个新的、独立的队列，所以 $Z_2$ 在统计上与 $Z_1$ 独立。无论 $n_2$ 的值如何，这一点都成立。\n\n“朴素”的最终合并 $Z$ 统计量是按照设计是固定的（样本量为 $n_1$ 和 $n_2$）来构建的。其公式为：\n$$ Z_{\\text{final}} = \\frac{\\text{总体加权均值差异}}{\\text{标准误}} = \\frac{n_1 \\hat{\\theta}_1 + n_2 \\hat{\\theta}_2}{n_1 + n_2} \\bigg/ \\sqrt{\\frac{2\\sigma^2}{n_1+n_2}} $$\n代入 $\\hat{\\theta}_1 = Z_1 \\sqrt{2/n_1}$，$\\hat{\\theta}_2 = Z_2 \\sqrt{2/n_2}$ 和 $\\sigma^2=1$：\n$$ Z_{\\text{final}} = \\frac{n_1 (Z_1 \\sqrt{2/n_1}) + n_2 (Z_2 \\sqrt{2/n_2})}{\\sqrt{2(n_1+n_2)}} = \\frac{\\sqrt{2n_1} Z_1 + \\sqrt{2n_2} Z_2}{\\sqrt{2(n_1+n_2)}} = \\sqrt{\\frac{n_1}{n_1+n_2}} Z_1 + \\sqrt{\\frac{n_2}{n_1+n_2}} Z_2 $$\n在这个适应性设计中，第二阶段的样本量 $n_2$ 是第一阶段结果 $Z_1$ 的函数，即 $n_2(Z_1)$。因此，权重也成为 $Z_1$ 的函数。设第一阶段的信息分数为 $w(Z_1) = \\frac{n_1}{n_1+n_2(Z_1)}$。朴素的统计量为：\n$$ Z_{\\text{naive}}(Z_1, Z_2) = \\sqrt{w(Z_1)} Z_1 + \\sqrt{1-w(Z_1)} Z_2 $$\n核心问题在于，随机权重 $\\sqrt{w(Z_1)}$ 与随机变量 $Z_1$ 相关。这违反了标准正态变量的简单加权和本身也是标准正态分布的条件。规则“对有希望的结果增加样本量”引入了一种选择偏倚，而朴素统计量并未对此进行校正，导致其零分布失真。通常，这种失真会导致 I 型错误率的膨胀。\n\n**逐项分析**\n\n**A. 在 $H_0$ 下，朴素的最终合并 $Z$ 统计量（使用常规固定设计公式和标准正态临界值计算）仍然精确服从 $N(0,1)$ 分布，因为即使 $n_2$ 是 $Z_1$ 的函数，阶段性独立性也确保了其有效性。**\n\n虽然阶段性统计量 $Z_1$ 和 $Z_2$ 确实是独立的，但这不足以保证朴素的合并统计量 $Z_{\\text{naive}}$ 服从标准正态分布。统计量 $Z_{\\text{naive}} = \\sqrt{w(Z_1)} Z_1 + \\sqrt{1-w(Z_1)} Z_2$ 涉及两个相关随机变量的乘积，即 $f(Z_1) = \\sqrt{w(Z_1)}$ 和 $Z_1$。这种组合的分布不是标准正态分布。规则“为有希望的结果增加样本量”引入了一种选择偏倚，朴素统计量并未对其进行调整，导致其零分布失真。总的来说，这种失真会导致 I 型错误率的膨胀。\n**结论：不正确。**\n\n**B. 在 $H_0$ 下，当样本量增加规则对于 $Z_1 \\in S \\subset (0,\\infty)$ 减小了第一阶段的最终权重时，朴素的最终合并 $Z$ 统计量是一个正态混合分布，其条件均值为 $E\\!\\left[Z_{\\text{final}} \\mid Z_1 = z\\right] = \\sqrt{w(z)}\\, z$，条件方差为 $1 - w(z)$，其中 $w(z)$ 是调整后的第一阶段信息分数。对于 $S$ 中不极端的 $z$ 值，减小 $w(z)$ 会增加在固定临界值 $\\Phi^{-1}(1-\\alpha)$ 下的单侧拒绝概率，从而导致 I 型错误的膨胀。**\n\n第一部分：条件分布。给定 $Z_1=z$，则 $n_2(z)$ 是固定的，因此权重 $w(z) = \\frac{n_1}{n_1+n_2(z)}$ 也是固定的。统计量变为 $Z_{\\text{naive}}|_{Z_1=z} = \\sqrt{w(z)} z + \\sqrt{1-w(z)} Z_2$。由于 $Z_2 \\sim N(0,1)$ 且与 $Z_1$ 独立，这个条件分布是正态的。其均值为 $E[\\sqrt{w(z)} z + \\sqrt{1-w(z)} Z_2] = \\sqrt{w(z)} z$。其方差为 $Var(\\sqrt{w(z)} z + \\sqrt{1-w(z)} Z_2) = (1-w(z))Var(Z_2) = 1-w(z)$。$Z_{\\text{naive}}$ 的无条件分布是这些条件正态分布在 $Z_1$ 的 $N(0,1)$ 分布上的混合。陈述的这一部分是正确的。\n\n第二部分：对拒绝概率的影响。条件拒绝概率为 $P(Z_{\\text{naive}} > c_\\alpha | Z_1=z) = P(Z_2 > \\frac{c_\\alpha - \\sqrt{w(z)} z}{\\sqrt{1-w(z)}}) = 1 - \\Phi\\left(\\frac{c_\\alpha - \\sqrt{w(z)} z}{\\sqrt{1-w(z)}}\\right)$，其中 $c_\\alpha = \\Phi^{-1}(1-\\alpha)$。对于 $z \\in S$，规则会增加 $n_2$，从而减小 $w(z)$。我们分析当 $w$ 减小时，$\\Phi(\\cdot)$ 的参数，记为 $u(w, z) = \\frac{c_\\alpha - \\sqrt{w} z}{\\sqrt{1-w}}$，如何变化。其导数为 $\\frac{\\partial u}{\\partial w} = \\frac{c_\\alpha\\sqrt{w} - z}{2w^{1/2}(1-w)^{3/2}}$。当 $z > c_\\alpha\\sqrt{w}$ 时，$\\frac{\\partial u}{\\partial w} < 0$，因此减小 $w$ 会减小 $u$，从而增加拒绝概率 $1-\\Phi(u)$。期中结果的“希望区域”$S$ 通常包括那些为正但不足以达到确定显著性（即“不极端”）的 $z$ 值。对于这些值，$z > c_\\alpha\\sqrt{w}$ 是合理的（例如，若 $\\alpha=0.025$, $c_\\alpha \\approx 1.96$，对于 $w=0.5$, $\\sqrt{w} \\approx 0.707$，则 $c_\\alpha\\sqrt{w} \\approx 1.39$）。在这个区域内，增加样本量（减小 $w$）会提高条件拒绝概率。这个提高量在 $Z_1$ 的分布上积分，就是整体 I 型错误膨胀的来源。该陈述准确地描述了这一机制。\n**结论：正确。**\n\n**C. 一个预先设定的逆正态组合检验，该检验使用固定的、预先设定的权重来组合阶段性 p 值，在 $H_0$ 下会产生一个正态分布的组合统计量，无论 $n_2$ 如何被选为 $Z_1$ 的函数，该统计量都是有效的。**\n\n逆正态组合方法使用形如 $Z_C = \\sqrt{w_1} \\Phi^{-1}(1-p_1) + \\sqrt{w_2} \\Phi^{-1}(1-p_2)$ 的检验统计量，其中 $p_1$ 和 $p_2$ 是阶段性 p 值，$w_1, w_2$ 是预先设定的固定权重，满足 $w_1+w_2=1$。对于单侧检验，$p_1 = 1-\\Phi(Z_1)$ 且 $p_2 = 1-\\Phi(Z_2)$。这使得统计量简化为 $Z_C = \\sqrt{w_1} Z_1 + \\sqrt{w_2} Z_2$。在 $H_0$ 下，$Z_1$ 和 $Z_2$ 是独立的 $N(0,1)$ 随机变量。因为 $w_1$ 和 $w_2$ 是固定的常数，$Z_C$ 是独立正态变量的线性组合，因此也服从均值为 $0$、方差为 $(\\sqrt{w_1})^2 + (\\sqrt{w_2})^2 = w_1+w_2=1$ 的正态分布。关键在于，这个零分布的有效性仅取决于 $Z_1, Z_2$ 是独立同分布的 $N(0,1)$ 变量以及权重是固定的。样本量 $n_2$ 可以根据 $Z_1$ 进行更改，这会影响第二阶段检验的功效，但它不改变在 $H_0$ 下，得到的统计量 $Z_2$ 是标准正态且独立于 $Z_1$ 的事实。因此，$Z_C$ 的零分布得以保持，I 型错误得到控制。\n**结论：正确。**\n\n**D. 条件误差原则通过以下要求来严格控制无条件的 I 型错误：对于每个实现的期中值 $Z_1 = z$，由调整后的第二阶段分析所引致的在 $H_0$ 下的最终拒绝条件概率，不得超过给定 $Z_1=z$ 时原始设计的条件误差。**\n\n这个陈述是对条件误差原则（由 Proschan 和 Hunsberger 提出）的精确定义。设 $A(z)$ 是在原计划的固定设计中，给定 $Z_1=z$ 时拒绝 $H_0$ 的条件概率。设 $A^*(z)$ 是调整后设计的条件拒绝概率。该原则要求任何调整都必须满足对所有可能的结果 $z$，都有 $A^*(z) \\le A(z)$。原始设计的无条件 I 型错误是 $\\alpha = \\int A(z)\\phi(z)dz$。调整后设计的无条件 I 型错误是 $\\alpha^* = \\int A^*(z)\\phi(z)dz$。通过要求对所有 $z$ 都有 $A^*(z) \\le A(z)$，可以直接得出 $\\alpha^* \\le \\alpha$。这保证了适应性试验的 I 型错误率不会超过名义水平 $\\alpha$。该陈述正确地描述了这一逻辑。\n**结论：正确。**\n\n**E. 如果该团队在期中进行盲法样本量重新估计，且该估计仅基于一个与 $Z_1$ 独立且不使用任何 $\\theta$ 的非盲估计的方差估计值，那么在 $H_0$ 下，最终的合并 $Z$ 统计量将保持标准正态零分布和名义单侧 I 型错误，无需额外调整。**\n\n这描述的是盲法样本量重新估计 (BSSR)。样本量 $n_2$ 是基于对治疗效应“盲化”的信息进行修改的。在正态数据试验的背景下，这通常意味着使用来自第一阶段数据的合并方差估计 $\\sigma^2$，而不参考治疗组的分配情况。数理统计学中的一个关键结果（对于正态分布数据）是样本均值和样本方差是独立的统计量。在 $H_0: \\theta=0$ 下，非盲期中统计量 $Z_1$ 是均值差异的函数，而盲法方差估计则不是。因此，用于调整的方差估计与 $Z_1$ 独立。如果规则 $n_2(\\cdot)$ 仅依赖于这个方差估计，那么得到的样本量 $n_2$ 和最终统计量中相应的权重 $w$ 是随机的，但它们独立于 $Z_1$。检验统计量为 $Z_{\\text{final}} = \\sqrt{w} Z_1 + \\sqrt{1-w} Z_2$。以实现的方差估计为条件（这会固定 $w$），该统计量服从 $N(0,1)$ 分布，因为 $Z_1, Z_2$ 是独立同分布的 $N(0,1)$ 变量，且权重是常数。由于对于方差估计的每一种可能结果，条件分布都是 $N(0,1)$，因此无条件分布也精确地是 $N(0,1)$。因此，朴素分析仍然有效。\n**结论：正确。**",
            "answer": "$$\\boxed{BCDE}$$"
        },
        {
            "introduction": "在理解了适应性设计的理论基础后，我们将转向一个具体的频率派应用：组序贯设计。这是一种成熟的适应性方法，允许试验因有效或无效而提前终止。本练习 () 提供了一个实践机会，让您亲手执行一次期中分析，计算必要的检验统计量，并应用预设的 O'Brien-Fleming 停止边界来做出决策，从而体验结构化、预先计划的适应性决策过程。",
            "id": "4519357",
            "problem": "一项临床药理学领域的平行双臂优效性试验，旨在评估一种新型抗高血压药物相对于匹配安慰剂，在第 $8$ 周时收缩压相较于基线的平均降低变化。假设各组的结局被建模为具有共同已知方差 $\\sigma^{2}$ 的独立同分布正态随机变量，治疗效应为总体均值之差 $\\delta = \\mu_{\\mathrm{T}} - \\mu_{\\mathrm{C}}$，其中较大的 $\\delta$ 正值表示抗高血压药物相对于安慰剂在收缩压方面有更大的平均降低效果。原假设为 $H_{0}: \\delta \\leq 0$，单侧备择假设为 $H_{1}: \\delta > 0$。\n\n该试验采用预先设定的组序贯设计，包括一次期中分析和一次期末分析，共两次检验。其有效性界值由单侧 I 型错误率 $\\alpha = 0.025$ 控制，该错误率通过 Lan-DeMets O’Brien-Fleming 消耗函数进行分配。计划的样本量为 $N_{\\mathrm{T}} = 400$ 和 $N_{\\mathrm{C}} = 400$。根据之前的 II 期临床试验数据，共同方差为 $\\sigma^{2} = 36$ $\\mathrm{mmHg}^{2}$。\n\n在期中分析时，样本量为 $n_{\\mathrm{T}} = 120$ 和 $n_{\\mathrm{C}} = 120$，观测到的样本均值降低量为 $\\bar{Y}_{\\mathrm{T}} = 11.8$ $\\mathrm{mmHg}$ 和 $\\bar{Y}_{\\mathrm{C}} = 9.4$ $\\mathrm{mmHg}$。预先设定的期中有效性界值（在标准化的 $Z$ 标度上）为 $c_{1} = 2.963$，该值对应于从设计中得出的信息分数 $t_{1}$。\n\n仅使用第一性原理和针对已知方差的均值差的标准大样本正态理论，推导用于在期中检验时检验 $H_{0}$ 的适当 $Z$ 统计量，根据给定数据计算其观测值 $Z_{1}$，并通过将 $Z_{1}$ 与 $c_{1}$ 进行比较来决定是因有效性而停止试验，还是继续进行下一次检验。将计算出的 $Z_{1}$ 值作为最终答案报告。将最终数值答案四舍五入至四位有效数字。将最终答案表示为无量纲数。最终数值答案中不需包含文字决策声明，但你的推理过程必须包括该决策。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **试验设计**：平行双臂优效性临床试验。\n- **终点**：在第 $8$ 周时，收缩压相较于基线的平均降低变化量。\n- **组别**：治疗组 (T) 和安慰剂/对照组 (C)。\n- **结局模型**：各组的特定结局是独立同分布的正态随机变量。\n- **总体方差**：共同的已知方差，$\\sigma^{2} = 36$ $\\mathrm{mmHg}^{2}$。\n- **治疗效应**：总体均值之差，$\\delta = \\mu_{\\mathrm{T}} - \\mu_{\\mathrm{C}}$。\n- **假设**：原假设 $H_{0}: \\delta \\leq 0$；备择假设 $H_{1}: \\delta > 0$。\n- **设计类型**：预先设定的两次检验的组序贯设计。\n- **误差控制**：单侧 I 型错误率 $\\alpha = 0.025$，由 Lan-DeMets O’Brien-Fleming 消耗函数控制。\n- **计划总样本量**：$N_{\\mathrm{T}} = 400$, $N_{\\mathrm{C}} = 400$。\n- **期中分析数据（第一次检验）**：\n  - 样本量：$n_{\\mathrm{T}} = 120$, $n_{\\mathrm{C}} = 120$。\n  - 观测到的样本均值降低量：$\\bar{Y}_{\\mathrm{T}} = 11.8$ $\\mathrm{mmHg}$, $\\bar{Y}_{\\mathrm{C}} = 9.4$ $\\mathrm{mmHg}$。\n- **有效性界值**：预先设定的期中有效性界值（在标准化的 $Z$ 标度上）为 $c_{1} = 2.963$。\n- **任务**：在期中检验时推导并计算 $Z$ 统计量 $Z_{1}$，并将其与 $c_{1}$ 进行比较以做出决策。报告四舍五入到四位有效数字的 $Z_{1}$ 数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题完全属于生物统计学这一成熟领域，特别是临床试验的设计与分析。对生理学终点使用正态分布、对已知方差的均值差使用 Z 检验，以及采用带有 O'Brien-Fleming 界值的组序贯设计，这些都是标准的、具有科学合理性的方法。\n- **适定性**：该问题是适定的。它要求进行一项具体的计算（$Z_{1}$），并且所有必需的数据（$\\bar{Y}_{\\mathrm{T}}$, $\\bar{Y}_{\\mathrm{C}}$, $n_{\\mathrm{T}}$, $n_{\\mathrm{C}}$, $\\sigma^{2}$）都已提供。存在一个唯一的、有意义的解。\n- **客观性**：问题以精确、客观和定量的语言陈述，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：该问题是自洽且内部一致的。所提供的信息足以计算所要求的统计量。像计划总样本量（$N_{\\mathrm{T}}$, $N_{\\mathrmC}}$）和消耗函数类型这样的背景信息，对于理解设计是相关的，但对于计算 $Z_{1}$ 并非必需，因为临界值 $c_1$ 是直接给出的。这不构成缺陷。\n- **现实性**：样本量、方差（$\\sigma = \\sqrt{36} = 6$ $\\mathrm{mmHg}$）和观测效应的数值对于抗高血压药物试验是符合现实的。\n\n### 步骤 3：结论与行动\n问题被判定为有效。所有构成一个合理科学问题的标准都已满足。将推导解答。\n\n任务是计算第一次期中分析时的标准化检验统计量 $Z_{1}$，并将其与临界值 $c_{1}$ 进行比较。待检验的假设为 $H_{0}: \\delta \\leq 0$ 对 $H_{1}: \\delta > 0$，其中 $\\delta = \\mu_{\\mathrm{T}} - \\mu_{\\mathrm{C}}$。检验在零假设空间的边界上进行，即假设 $\\delta = 0$。\n\n对于已知方差的双样本均值检验，$Z$ 统计量的一般形式为：\n$$ Z = \\frac{(\\text{Point Estimate of } \\delta) - (\\text{Hypothesized value of } \\delta)}{\\text{Standard Error of the Point Estimate}} $$\n\n在期中分析（第一次检验）时，治疗效应 $\\delta$ 的点估计是观测到的样本均值之差：\n$$ \\hat{\\delta}_{1} = \\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}} $$\n在原假设下，$\\delta$ 的假设值为 $\\delta_{0} = 0$。\n\n点估计的标准误 $\\mathrm{SE}(\\hat{\\delta}_{1})$ 基于样本均值的方差。来自已知方差为 $\\sigma^{2}$、样本量为 $n$ 的总体的样本均值 $\\bar{Y}$ 的方差为 $\\mathrm{Var}(\\bar{Y}) = \\frac{\\sigma^{2}}{n}$。由于两组独立，其样本均值之差的方差是各自方差之和：\n$$ \\mathrm{Var}(\\hat{\\delta}_{1}) = \\mathrm{Var}(\\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}}) = \\mathrm{Var}(\\bar{Y}_{\\mathrm{T}}) + \\mathrm{Var}(\\bar{Y}_{\\mathrm{C}}) $$\n在期中分析时，样本量为 $n_{\\mathrm{T}}$ 和 $n_{\\mathrm{C}}$，因此变为：\n$$ \\mathrm{Var}(\\hat{\\delta}_{1}) = \\frac{\\sigma^{2}}{n_{\\mathrm{T}}} + \\frac{\\sigma^{2}}{n_{\\mathrm{C}}} $$\n标准误是方差的平方根：\n$$ \\mathrm{SE}(\\hat{\\delta}_{1}) = \\sqrt{\\frac{\\sigma^{2}}{n_{\\mathrm{T}}} + \\frac{\\sigma^{2}}{n_{\\mathrm{C}}}} $$\n因此，期中检验的检验统计量 $Z_{1}$ 为：\n$$ Z_{1} = \\frac{(\\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}}) - 0}{\\sqrt{\\frac{\\sigma^{2}}{n_{\\mathrm{T}}} + \\frac{\\sigma^{2}}{n_{\\mathrm{C}}}}} = \\frac{\\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}}}{\\sigma \\sqrt{\\frac{1}{n_{\\mathrm{T}}} + \\frac{1}{n_{\\mathrm{C}}}}} $$\n现在，我们将所提供的数值代入此公式。\n已知：\n- $\\bar{Y}_{\\mathrm{T}} = 11.8$\n- $\\bar{Y}_{\\mathrm{C}} = 9.4$\n- $\\sigma^{2} = 36$，这意味着 $\\sigma = \\sqrt{36} = 6$。\n- $n_{\\mathrm{T}} = 120$\n- $n_{\\mathrm{C}} = 120$\n\n首先，计算分子（观测到的效应大小）：\n$$ \\hat{\\delta}_{1} = \\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}} = 11.8 - 9.4 = 2.4 $$\n接下来，计算估计的标准误：\n$$ \\mathrm{SE}(\\hat{\\delta}_{1}) = \\sqrt{\\frac{36}{120} + \\frac{36}{120}} = \\sqrt{\\frac{72}{120}} = \\sqrt{\\frac{6 \\times 12}{10 \\times 12}} = \\sqrt{\\frac{6}{10}} = \\sqrt{0.6} $$\n现在，计算 $Z_{1}$ 统计量：\n$$ Z_{1} = \\frac{2.4}{\\sqrt{0.6}} $$\n计算数值：\n$$ Z_{1} \\approx \\frac{2.4}{0.774596669...} \\approx 3.09838667... $$\n问题要求四舍五入到四位有效数字。第五位有效数字是 $3$，因此向下舍入。\n$$ Z_{1} \\approx 3.098 $$\n最后一步是应用决策规则。如果观测到的统计量 $Z_{1}$ 超过了预先设定的界值 $c_{1}$，则试验因有效性而停止。\n观测到的统计量为 $Z_{1} \\approx 3.098$。\n有效性界值为 $c_{1} = 2.963$。\n比较这两个值：\n$$ 3.098 > 2.963 $$\n由于 $Z_{1} > c_{1}$，在期中分析时拒绝原假设 $H_{0}$。结论是，由于已证明新的抗高血压治疗有效，故停止试验。问题要求给出 $Z_{1}$ 的计算值。",
            "answer": "$$\\boxed{3.098}$$"
        },
        {
            "introduction": "最后，我们将视角转向贝叶斯范式，该方法通过不断更新对参数的认知（后验分布）来自然地适应累积的数据。这项高级练习 () 要求您计算一个两阶段贝叶斯适应性设计的操作特性，如功效 (power)、I 类错误率和预期样本量。它不仅展示了如何在试验开始前评估和比较不同设计，还要求您将理论公式转化为计算算法，这是现代临床试验设计中的一项关键技能。",
            "id": "4519388",
            "problem": "考虑一个用于临床药理学的单臂、两阶段贝叶斯自适应设计。令未知响应概率表示为 $\\theta \\in [0,1]$。关于 $\\theta$ 的先验知识被建模为贝塔分布 $\\mathrm{Beta}(a,b)$，其中 $a>0$ 且 $b>0$。患者分两个阶段入组：在 $n_1$ 个观测之后进行期中分析，在最多 $N$ 个观测时进行期末分析，其中 $N \\ge n_1$。令 $x_1$ 表示在期中阶段观察到的响应数，$x$ 表示在试验结束时观察到的总响应数。假设在 $\\theta$ 的条件下，数据是独立同分布的伯努利试验，因此 $x_1 \\sim \\mathrm{Binomial}(n_1,\\theta)$ 且 $x \\sim \\mathrm{Binomial}(N,\\theta)$。\n\n在每次分析中，通过将后验尾部概率与具有临床意义的响应阈值 $\\theta_0 \\in (0,1)$ 进行比较来做出决策。具体来说，在样本量为 $n$、观察到 $x$ 个响应时，根据共轭性，后验分布为 $\\theta \\mid x \\sim \\mathrm{Beta}(a+x,b+n-x)$。定义后验尾部概率 $T(x,n) = \\mathbb{P}(\\theta \\ge \\theta_0 \\mid x,n) = 1 - I_{\\theta_0}(a+x,b+n-x)$，其中 $I_{z}(\\alpha,\\beta)$ 是正则化不完全贝塔函数。\n\n决策规则如下：\n- 期中分析时，若 $T(x_1,n_1) \\ge t_s$，则为早期成功，停止并宣布成功。\n- 期中分析时，若 $T(x_1,n_1) \\le t_f$，则为早期无效，停止并宣布无效。\n- 否则，继续进行至 $N$ 个观测的期末分析，若 $T(x,N) \\ge t_F$ 则宣布最终成功；否则宣布无效。\n\n对于一个固定的真实响应概率 $p \\in [0,1]$，定义操作特征如下：\n- 在概率为 $p$ 时的成功概率，记为 $\\pi_{\\mathrm{succ}}(p)$，等于（在 $p$ 下的抽样分布上）该设计在期中或期末分析时宣布成功的概率。\n- 在概率为 $p$ 时的期望样本量，记为 $E_{\\!N}(p)$，等于在真实响应概率为 $p$ 的抽样分布下，停止前招募的患者总数的期望值。\n- I类错误定义在零假设边界 $p=\\theta_0$ 处，为 $\\alpha = \\pi_{\\mathrm{succ}}(\\theta_0)$。\n\n仅使用以下基本依据：\n- 二项式抽样模型 $X \\sim \\mathrm{Binomial}(n,p)$，其概率质量函数为 $\\mathbb{P}(X=x) = \\binom{n}{x} p^x (1-p)^{n-x}$，适用于 $x \\in \\{0,1,\\dots,n\\}$ 和 $p \\in [0,1]$。\n- 贝塔先验与二项式似然的共轭性：当 $\\theta \\sim \\mathrm{Beta}(a,b)$ 且 $X \\sim \\mathrm{Binomial}(n,\\theta)$ 时，$\\theta \\mid x \\sim \\mathrm{Beta}(a+x,b+n-x)$。\n- 恒等式 $\\mathbb{P}(\\theta \\ge \\theta_0 \\mid x,n) = 1 - I_{\\theta_0}(a+x,b+n-x)$，其中 $I_z(\\alpha,\\beta)$ 是正则化不完全贝塔函数。\n\n从第一性原理推导 $\\pi_{\\mathrm{succ}}(p)$、$\\alpha$ 和 $E_{\\!N}(p)$ 的表达式，用 $a$、$b$、$n_1$、$N$、$\\theta_0$、$t_s$、$t_f$、$t_F$ 和 $p$ 表示。您的程序必须通过对期中和期末阶段的相关二项分布进行求和来精确实现这些表达式，无需进行模拟。\n\n您的程序应为以下每个测试用例计算这些操作特征。对于每个测试用例，为每个指定的真实响应概率值 $p$ 计算三元组 $[\\pi_{\\mathrm{succ}}(p), \\alpha, E_{\\!N}(p)]$，所有三个量都表示为保留小数点后六位的小数。\n\n测试套件：\n- 用例 $1$：$a=1$, $b=1$, $n_1=20$, $N=40$, $\\theta_0=0.2$, $t_s=0.99$, $t_f=0.05$, $t_F=0.95$，并在 $p \\in \\{0.2, 0.35\\}$ 处进行评估。\n- 用例 $2$（实际上只有一个阶段的边界情况）：$a=1$, $b=1$, $n_1=10$, $N=10$, $\\theta_0=0.3$, $t_s=0.9$, $t_f=0.1$, $t_F=0.9$，并在 $p \\in \\{0.3, 0.5\\}$ 处进行评估。这旨在探查 $N=n_1$ 的边界条件，此时只执行一次分析。\n- 用例 $3$（信息性先验）：$a=2$, $b=8$, $n_1=15$, $N=30$, $\\theta_0=0.2$, $t_s=0.975$, $t_f=0.05$, $t_F=0.95$，并在 $p \\in \\{0.1, 0.2, 0.4\\}$ 处进行评估。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来的结果，每个元素对应一个测试用例，并且其本身是针对给定顺序中指定 $p$ 值的 $[\\pi_{\\mathrm{succ}}(p), \\alpha, E_{\\!N}(p)]$ 三元组列表。例如，总体结构应为 $[[\\cdot,\\cdot,\\dots],[\\cdot,\\cdot,\\dots],[\\cdot,\\cdot,\\dots]]$ 的形式，其中每个 $\\cdot$ 是一个三元组。所有概率必须以小数形式表示，而不是百分比。不涉及物理单位。",
            "solution": "该问题被评估为有效。这是生物统计学中一个明确定义的任务，具体涉及自适应临床试验的设计。该问题在贝叶斯推断和概率论方面具有科学依据，并且是自洽的，提供了所有必要的参数，并使用客观、形式化的数学语言进行阐述。没有矛盾、歧义或违反科学原理的地方。因此，我们可以从第一性原理开始推导所需的操作特征。\n\n令真实响应概率为 $p \\in [0,1]$。第一阶段的响应数 $X_1$ 是一个服从二项分布的随机变量，$X_1 \\sim \\mathrm{Binomial}(n_1, p)$。$X_1$ 的样本空间是 $\\{0, 1, \\dots, n_1\\}$。\n\n在 $n_1$ 名患者后的期中分析中，对于每个可能的结果 $x_1 \\in \\{0, 1, \\dots, n_1\\}$，计算后验尾部概率 $T(x_1, n_1) = \\mathbb{P}(\\theta \\ge \\theta_0 \\mid x_1, n_1)$，其值为 $1 - I_{\\theta_0}(a+x_1, b+n_1-x_1)$，其中 $I_z(\\alpha, \\beta)$ 是正则化不完全贝塔函数。根据这个值，所有可能的期中结果的集合被划分为三个不相交的集合：\n- 导致早期成功的结果集：$S_1 = \\{x_1 \\in \\{0, \\dots, n_1\\} \\mid T(x_1, n_1) \\ge t_s \\}$。\n- 导致早期无效的结果集：$F_1 = \\{x_1 \\in \\{0, \\dots, n_1\\} \\mid T(x_1, n_1) \\le t_f \\}$。\n- 导致继续试验的结果集：$C_1 = \\{x_1 \\in \\{0, \\dots, n_1\\} \\mid t_f < T(x_1, n_1) < t_s \\}$。\n\n在给定真实概率 $p$ 的情况下，在第一阶段观察到 $x_1$ 个响应的概率由二项式概率质量函数 (PMF) 决定：\n$$ \\mathbb{P}(X_1 = x_1 \\mid p) = \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} $$\n\n**成功概率 $\\pi_{\\mathrm{succ}}(p)$ 的推导**\n试验通过两条互斥路径之一被宣布成功：在期中阶段成功，或在期中阶段继续试验后在期末阶段成功。总成功概率是这两条路径的概率之和。\n\n1.  **路径 1：早期成功。** 如果观察到的响应数 $X_1$ 是集合 $S_1$ 的一个成员，则发生此情况。该事件的概率是 $S_1$ 中所有结果的概率之和：\n    $$ \\mathbb{P}(\\text{早期成功}) = \\mathbb{P}(X_1 \\in S_1) = \\sum_{x_1 \\in S_1} \\mathbb{P}(X_1 = x_1 \\mid p) = \\sum_{x_1 \\in S_1} \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} $$\n\n2.  **路径 2：继续试验并最终成功。** 该路径要求期中结果 $X_1$ 属于继续集 $C_1$。如果 $x_1 \\in C_1$，则额外招募 $n_2 = N - n_1$ 名患者。令 $X_2$ 为这第二个队列中的响应数。在给定真实率 $p$ 的情况下，$X_2 \\sim \\mathrm{Binomial}(n_2, p)$ 且与 $X_1$ 独立。期末分析时的总响应数是 $X = x_1+X_2$。如果 $T(x_1+X_2, N) \\ge t_F$，则宣布最终成功。\n    对于一个固定的期中结果 $x_1 \\in C_1$，我们将 $S_2(x_1)$ 定义为导致最终成功的第二阶段结果集：\n    $$ S_2(x_1) = \\{x_2 \\in \\{0, \\dots, n_2\\} \\mid T(x_1+x_2, N) \\ge t_F \\} $$\n    在期中结果为 $x_1$ 的条件下，实现最终成功的概率是 $X_2$ 落入 $S_2(x_1)$ 的概率：\n    $$ \\mathbb{P}(\\text{最终成功} \\mid X_1 = x_1) = \\mathbb{P}(X_2 \\in S_2(x_1)) = \\sum_{x_2 \\in S_2(x_1)} \\mathbb{P}(X_2=x_2 \\mid p) = \\sum_{x_2 \\in S_2(x_1)} \\binom{n_2}{x_2} p^{x_2} (1-p)^{n_2-x_2} $$\n    路径 2 的总概率通过对所有可能的继续结果 $x_1 \\in C_1$ 进行求和得到，并按其各自的概率加权，根据全概率法则：\n    $$ \\mathbb{P}(\\text{继续并最终成功}) = \\sum_{x_1 \\in C_1} \\mathbb{P}(\\text{最终成功} \\mid X_1 = x_1) \\mathbb{P}(X_1=x_1 \\mid p) $$\n    $$ = \\sum_{x_1 \\in C_1} \\left[ \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} \\left( \\sum_{x_2 \\in S_2(x_1)} \\binom{N-n_1}{x_2} p^{x_2} (1-p)^{N-n_1-x_2} \\right) \\right] $$\n\n总成功概率 $\\pi_{\\mathrm{succ}}(p)$ 是这两条不相交路径的概率之和：\n$$ \\pi_{\\mathrm{succ}}(p) = \\mathbb{P}(\\text{早期成功}) + \\mathbb{P}(\\text{继续并最终成功}) $$\n$$ \\pi_{\\mathrm{succ}}(p) = \\sum_{x_1 \\in S_1} \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} + \\sum_{x_1 \\in C_1} \\left[ \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} \\left( \\sum_{x_2 \\in S_2(x_1)} \\binom{N-n_1}{x_2} p^{x_2} (1-p)^{N-n_1-x_2} \\right) \\right] $$\n\n**I类错误 $\\alpha$ 的推导**\nI类错误率 $\\alpha$ 定义为当真实响应率为 $p=\\theta_0$ 时宣布成功的概率。因此，它是通过在 $p=\\theta_0$ 处评估 $\\pi_{\\mathrm{succ}}(p)$ 的表达式来计算的：\n$$ \\alpha = \\pi_{\\mathrm{succ}}(\\theta_0) $$\n\n**期望样本量 $E_{\\!N}(p)$ 的推导**\n样本量是一个随机变量，如果试验在期中分析时停止（由于成功或无效），则取值为 $n_1$，如果继续，则取值为 $N$。当且仅当期中结果 $X_1$ 落入集合 $C_1$ 时，试验继续。\n继续试验的概率是 $X_1 \\in C_1$ 的概率：\n$$ \\mathbb{P}(\\text{继续}) = \\mathbb{P}(X_1 \\in C_1) = \\sum_{x_1 \\in C_1} \\mathbb{P}(X_1=x_1 \\mid p) = \\sum_{x_1 \\in C_1} \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} $$\n期望样本量 $E_{\\!N}(p)$ 是两种可能样本量的加权平均值：\n$$ E_{\\!N}(p) = n_1 \\cdot \\mathbb{P}(\\text{期中停止}) + N \\cdot \\mathbb{P}(\\text{继续}) $$\n由于 $\\mathbb{P}(\\text{期中停止}) = 1 - \\mathbb{P}(\\text{继续})$，我们可以写成：\n$$ E_{\\!N}(p) = n_1 \\cdot (1 - \\mathbb{P}(\\text{继续})) + N \\cdot \\mathbb{P}(\\text{继续}) = n_1 - n_1 \\cdot \\mathbb{P}(\\text{继续}) + N \\cdot \\mathbb{P}(\\text{继续}) $$\n这可以简化为：\n$$ E_{\\!N}(p) = n_1 + (N - n_1) \\cdot \\mathbb{P}(\\text{继续}) $$\n代入继续概率的表达式，得到最终公式：\n$$ E_{\\!N}(p) = n_1 + (N-n_1) \\left( \\sum_{x_1 \\in C_1} \\binom{n_1}{x_1} p^{x_1} (1-p)^{n_1-x_1} \\right) $$\n这些推导出的表达式在以下程序中实现，首先确定决策集 $S_1$、$C_1$ 和 $S_2(x_1)$，然后对相关的二项式 PMF 执行指定的求和。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import comb, betainc\n\ndef _calculate_op_chars_for_p(a, b, n1, N, theta0, ts, tf, tF, p):\n    \"\"\"\n    Calculates the probability of success and expected sample size for a given true response rate p.\n    \"\"\"\n    # 1. Determine decision boundaries for the interim analysis\n    x1_values = np.arange(n1 + 1)\n    \n    # Calculate posterior tail probability T(x1, n1) for all possible x1\n    post_a_interim = a + x1_values\n    post_b_interim = b + n1 - x1_values\n    T_interim = 1 - betainc(post_a_interim, post_b_interim, theta0)\n    \n    # Identify outcomes for early success, futility, and continuation\n    s1_mask = T_interim >= ts\n    c1_mask = (T_interim > tf) & (T_interim < ts)\n\n    # 2. Calculate probabilities of interim outcomes under the true rate p\n    pmf_x1 = comb(n1, x1_values) * (p**x1_values) * ((1-p)**(n1-x1_values))\n\n    # 3. Calculate Expected Sample Size E_N(p)\n    prob_continue = np.sum(pmf_x1[c1_mask])\n    expected_n = n1 + (N - n1) * prob_continue\n\n    # 4. Calculate Probability of Success pi_succ(p)\n    # Path 1: Early success\n    prob_early_succ = np.sum(pmf_x1[s1_mask])\n    \n    # Path 2: Continuation followed by final success\n    prob_cont_succ = 0.0\n    c1_outcomes = x1_values[c1_mask]\n    n2 = N - n1\n    \n    # If there is a second stage and continuation is possible\n    if n2 > 0 and len(c1_outcomes) > 0:\n        x2_values = np.arange(n2 + 1)\n        pmf_x2 = comb(n2, x2_values) * (p**x2_values) * ((1-p)**(n2-x2_values))\n        \n        for x1_c in c1_outcomes:\n            # For this specific interim outcome x1_c, find which stage 2 outcomes lead to success\n            post_a_final = a + x1_c + x2_values\n            post_b_final = b + N - (x1_c + x2_values)\n            T_final = 1 - betainc(post_a_final, post_b_final, theta0)\n            \n            s2_mask = T_final >= tF\n            \n            # Probability of final success, conditional on interim outcome x1_c\n            prob_final_succ_given_x1c = np.sum(pmf_x2[s2_mask])\n            \n            # Add this path's probability to the total\n            prob_cont_succ += pmf_x1[x1_c] * prob_final_succ_given_x1c\n            \n    # Handle the boundary case where N=n1 (single stage)\n    elif n2 == 0 and len(c1_outcomes) > 0:\n        for x1_c in c1_outcomes:\n            # \"Continue\" means re-evaluating against the final threshold tF\n            if T_interim[x1_c] >= tF:\n                prob_cont_succ += pmf_x1[x1_c]\n                \n    pi_succ = prob_early_succ + prob_cont_succ\n    \n    return pi_succ, expected_n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the formatted results.\n    \"\"\"\n    test_cases = [\n        {'params': (1, 1, 20, 40, 0.2, 0.99, 0.05, 0.95), 'p_values': [0.2, 0.35]},\n        {'params': (1, 1, 10, 10, 0.3, 0.9, 0.1, 0.9), 'p_values': [0.3, 0.5]},\n        {'params': (2, 8, 15, 30, 0.2, 0.975, 0.05, 0.95), 'p_values': [0.1, 0.2, 0.4]}\n    ]\n\n    all_results_list = []\n    for case in test_cases:\n        params = case['params']\n        p_values = case['p_values']\n        theta0 = params[4]\n\n        # Calculate Type I error (alpha) once per case\n        alpha, _ = _calculate_op_chars_for_p(*params, p=theta0)\n\n        case_results = []\n        for p in p_values:\n            pi_succ_p, en_p = _calculate_op_chars_for_p(*params, p=p)\n            case_results.append(f\"[{pi_succ_p:.6f},{alpha:.6f},{en_p:.6f}]\")\n        \n        all_results_list.append(f\"[{','.join(case_results)}]\")\n\n    # Print the final result in the exact required format.\n    print(f\"[[{','.join(all_results_list)}]]\")\n\nsolve()\n```"
        }
    ]
}