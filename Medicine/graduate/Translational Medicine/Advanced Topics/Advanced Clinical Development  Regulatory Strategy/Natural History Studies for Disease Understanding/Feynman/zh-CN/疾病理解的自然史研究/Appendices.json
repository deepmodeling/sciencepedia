{
    "hands_on_practices": [
        {
            "introduction": "在自然史研究中，患者通常在其疾病过程的不同阶段入组，这种现象被称为“延迟入组”或“左截断”。天真地假设所有患者从疾病开始时就处于风险中，会引入偏倚，因为存活时间足够长才得以入组的患者被过度代表，从而导致生存率被高估。本练习将通过具体计算，让您亲身体会这种偏倚的量级，并掌握正确的分析技术——左截断Kaplan-Meier估计法——来校正这种偏差，为准确的生存估计奠定基础。",
            "id": "5034704",
            "problem": "一项转化医学中的前瞻性自然病程队列研究旨在估计从疾病发作到临床相关失败事件的生存期。由于患者是从社区机构转诊而来，许多患者入组较晚；生存时间较长的患者往往被转诊得更晚。考虑连续入组的八名患者，他们的入组时间和结局以疾病发作后的月数记录。右删失是无信息性的。时间起点是疾病发作。将事件时间定义为 $T_i$，右删失时间定义为 $C_i$，研究入组（延迟入组）时间定义为 $L_i$，观察到的退出时间定义为 $R_i = \\min\\{T_i, C_i\\}$。数据如下：\n- 参与者 $1$：$L_1 = 0.5$，事件发生于 $T_1 = 6$。\n- 参与者 $2$：$L_2 = 1$，事件发生于 $T_2 = 9$。\n- 参与者 $3$：$L_3 = 3$，删失于 $C_3 = 15$。\n- 参与者 $4$：$L_4 = 5$，事件发生于 $T_4 = 11$。\n- 参与者 $5$：$L_5 = 12$，删失于 $C_5 = 18$。\n- 参与者 $6$：$L_6 = 10$，事件发生于 $T_6 = 14$。\n- 参与者 $7$：$L_7 = 8$，删失于 $C_7 = 12$。\n- 参与者 $8$：$L_8 = 9$，事件发生于 $T_8 = 13$。\n\n该疾病从发病开始的真实基础生存函数是指数分布，其月速率为 $\\lambda = \\ln(2)/12$，因此在 $t=12$ 个月时的真实生存率为 $S(12) = \\exp(-\\lambda \\cdot 12)$。假设采用以下估计约定：\n- Kaplan–Meier (KM) 估计量将每位入组的参与者都视为从 $t=0$ 开始就处于风险中，并使用由所有满足 $R_i \\ge t$ 的参与者（不论其 $L_i$ 为何）组成的观察风险集。\n- 左截断 Kaplan–Meier 估计量考虑了延迟入组，将时间 $t$ 的风险集定义为满足 $L_i \\le t \\le R_i$ 的那些个体。\n\n计算标准 Kaplan–Meier 估计量和左截断 Kaplan–Meier 估计量在发病后 $t^{\\star} = 12$ 个月时的生存概率。然后计算它们在 $t^{\\star}$ 时的绝对偏差之比，定义为\n$\\left|\\hat{S}_{\\mathrm{KM}}(12) - S(12)\\right| \\big/ \\left|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)\\right|$。\n将您的最终答案表示为一个没有单位的数字。",
            "solution": "用户希望通过验证问题陈述，然后计算和比较两种生存概率估计量来解决一个生存分析问题。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n- **参与者**：一项前瞻性队列研究中的 $8$ 名个体。\n- **时间起点**：疾病发作 ($t=0$)。\n- **变量**：\n    - $L_i$：参与者 $i$ 的延迟入组（左截断）时间。\n    - $T_i$：参与者 $i$ 的事件发生时间。\n    - $C_i$：参与者 $i$ 的右删失时间。\n    - $R_i = \\min\\{T_i, C_i\\}$：参与者 $i$ 的观察退出时间。\n    - $\\delta_i$：事件指示符（事件为 $1$，删失为 $0$）。\n- **数据（单位：月）**：\n    - 参与者 $1$：$L_1 = 0.5$, $T_1 = 6$ ($R_1=6, \\delta_1=1$)。\n    - 参与者 $2$：$L_2 = 1$, $T_2 = 9$ ($R_2=9, \\delta_2=1$)。\n    - 参与者 $3$：$L_3 = 3$, $C_3 = 15$ ($R_3=15, \\delta_3=0$)。\n    - 参与者 $4$：$L_4 = 5$, $T_4 = 11$ ($R_4=11, \\delta_4=1$)。\n    - 参与者 $5$：$L_5 = 12$, $C_5 = 18$ ($R_5=18, \\delta_5=0$)。\n    - 参与者 $6$：$L_6 = 10$, $T_6 = 14$ ($R_6=14, \\delta_6=1$)。\n    - 参与者 $7$：$L_7 = 8$, $C_7 = 12$ ($R_7=12, \\delta_7=0$)。\n    - 参与者 $8$：$L_8 = 9$, $T_8 = 13$ ($R_8=13, \\delta_8=1$)。\n- **真实生存模型**：指数分布，月速率为 $\\lambda = \\frac{\\ln(2)}{12}$。生存函数为 $S(t) = \\exp(-\\lambda t)$。\n- **目标时间**：$t^{\\star} = 12$ 个月。\n- **估计量定义**：\n    - 标准 Kaplan-Meier ($\\hat{S}_{\\mathrm{KM}}$)：时间 $t$ 的风险集是 $\\{i: R_i \\ge t\\}$。\n    - 左截断 Kaplan-Meier ($\\hat{S}_{\\mathrm{LT\\text{-}KM}}$)：时间 $t$ 的风险集是 $\\{i: L_i \\le t \\le R_i\\}$。\n- **目标**：计算绝对偏差之比：$\\frac{|\\hat{S}_{\\mathrm{KM}}(12) - S(12)|}{|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)|}$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于生存分析的基本概念，特别是处理左截断和右删失数据，这是生物统计学和转化医学中的一个标准课题。该情景在科学上是现实的。\n- **适定性**：该问题是适定的。所有数据（$L_i$, $R_i$, $\\delta_i$）、真实分布参数（$\\lambda$）以及估计量的定义都已提供。这使得唯一的数值解成为可能。\n- **目标**：问题以精确、定量和无偏见的语言陈述。\n- **完整性和一致性**：数据对于所需的计算是完整的。对于每位参与者，入组时间 $L_i$ 小于退出时间 $R_i$，这是一个必要条件。该问题是自洽且内部一致的。\n\n**1.3. 结论与行动**\n\n问题被视为**有效**。将继续求解过程。\n\n### 步骤2：求解\n\n问题要求计算三个量：真实生存概率 $S(12)$、标准 Kaplan-Meier 估计值 $\\hat{S}_{\\mathrm{KM}}(12)$ 和左截断 Kaplan-Meier 估计值 $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12)$。然后根据这些值计算绝对偏差之比。\n\n**2.1. 真实生存概率 $S(12)$**\n真实生存函数由 $S(t) = \\exp(-\\lambda t)$ 给出，速率参数为 $\\lambda = \\frac{\\ln(2)}{12}$。我们在目标时间 $t^{\\star} = 12$ 处评估该函数。\n$$S(12) = \\exp\\left(-\\frac{\\ln(2)}{12} \\times 12\\right) = \\exp(-\\ln(2)) = \\frac{1}{\\exp(\\ln(2))} = \\frac{1}{2}$$\n因此，12 个月时的真实生存概率为 $S(12) = 0.5$。\n\n**2.2. 标准 Kaplan-Meier 估计值 $\\hat{S}_{\\mathrm{KM}}(12)$**\n标准 Kaplan-Meier 估计量由乘积限公式 $\\hat{S}(t) = \\prod_{t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)$ 给出，其中 $t_j$ 是不同的事件时间，$d_j$ 是在 $t_j$ 发生的事件数，$n_j$ 是风险个体数。对于标准 KM 估计量，时间 $t$ 的风险集由所有观察退出时间 $R_i \\ge t$ 的个体组成。数据中观察到的不同事件时间是 $6, 9, 11, 13, 14$。我们只需要考虑截至 $t^{\\star} = 12$ 的事件时间。\n\n- **$t_1 = 6$ 时的事件**：\n    - 风险人数 $n_1$ 是满足 $R_i \\ge 6$ 的个体计数。所有 $8$ 名参与者都满足此条件。因此，$n_1 = 8$。\n    - 事件数为 $d_1 = 1$（参与者 $1$）。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{KM}}(6) = 1 - \\frac{1}{8} = \\frac{7}{8}$。\n\n- **$t_2 = 9$ 时的事件**：\n    - 风险人数 $n_2$ 是满足 $R_i \\ge 9$ 的个体计数。参与者 $1$ 已退出。其余 $7$ 名参与者满足此条件。因此，$n_2 = 7$。\n    - 事件数为 $d_2 = 1$（参与者 $2$）。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{KM}}(9) = \\hat{S}_{\\mathrm{KM}}(6) \\times \\left(1 - \\frac{1}{7}\\right) = \\frac{7}{8} \\times \\frac{6}{7} = \\frac{6}{8} = \\frac{3}{4}$。\n\n- **$t_3 = 11$ 时的事件**：\n    - 风险人数 $n_3$ 是满足 $R_i \\ge 11$ 的个体计数。参与者 $1$ 和 $2$ 已退出。其余 $6$ 名参与者满足此条件。因此，$n_3 = 6$。\n    - 事件数为 $d_3 = 1$（参与者 $4$）。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{KM}}(11) = \\hat{S}_{\\mathrm{KM}}(9) \\times \\left(1 - \\frac{1}{6}\\right) = \\frac{3}{4} \\times \\frac{5}{6} = \\frac{15}{24} = \\frac{5}{8}$。\n\n下一个事件发生在 $t = 13$。对于区间 $[11, 13)$ 中的任何时间 $t$，生存估计值保持不变。因此，在 $t^{\\star} = 12$ 时：\n$$\\hat{S}_{\\mathrm{KM}}(12) = \\hat{S}_{\\mathrm{KM}}(11) = \\frac{5}{8} = 0.625$$\n注意，参与者 7 在 $t=12$ 时的删失不改变 $t=12$ 时的估计值；它只影响后续事件时间的风险集大小。\n\n**2.3. 左截断 Kaplan-Meier 估计值 $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12)$**\n对于左截断 Kaplan-Meier 估计量，事件时间 $t_j$ 的风险集定义为在该时间正在接受观察的个体集合，即 $\\{i: L_i \\le t_j \\le R_i\\}$。\n\n- **$t_1 = 6$ 时的事件**：\n    - 风险集由满足 $L_i \\le 6 \\le R_i$ 的个体组成。这些是参与者 $1$ ($0.5 \\le 6 \\le 6$)、$2$ ($1 \\le 6 \\le 9$)、$3$ ($3 \\le 6 \\le 15$) 和 $4$ ($5 \\le 6 \\le 11$)。因此，$n_1 = 4$。\n    - 事件数为 $d_1 = 1$。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(6) = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n\n- **$t_2 = 9$ 时的事件**：\n    - 风险集由满足 $L_i \\le 9 \\le R_i$ 的个体组成。这些是参与者 $2$ ($1 \\le 9 \\le 9$)、$3$ ($3 \\le 9 \\le 15$)、$4$ ($5 \\le 9 \\le 11$)、$7$ ($8 \\le 9 \\le 12$) 和 $8$ ($9 \\le 9 \\le 13$)。因此，$n_2 = 5$。\n    - 事件数为 $d_2 = 1$。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(9) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(6) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{3}{4} \\times \\frac{4}{5} = \\frac{3}{5}$。\n\n- **$t_3 = 11$ 时的事件**：\n    - 风险集由满足 $L_i \\le 11 \\le R_i$ 的个体组成。这些是参与者 $3$ ($3 \\le 11 \\le 15$)、$4$ ($5 \\le 11 \\le 11$)、$6$ ($10 \\le 11 \\le 14$)、$7$ ($8 \\le 11 \\le 12$) 和 $8$ ($9 \\le 11 \\le 13$)。因此，$n_3 = 5$。\n    - 事件数为 $d_3 = 1$。\n    - 生存概率估计值为 $\\hat{S}_{\\mathrm{LT\\text{-}KM}}(11) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(9) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{3}{5} \\times \\frac{4}{5} = \\frac{12}{25}$。\n\n下一个事件发生在 $t = 13$。对于 $[11, 13)$ 中的任何时间 $t$，估计值是恒定的。在 $t^{\\star} = 12$ 时：\n$$\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) = \\hat{S}_{\\mathrm{LT\\text{-}KM}}(11) = \\frac{12}{25} = 0.48$$\n\n**2.4. 绝对偏差之比**\n估计量 $\\hat{S}(t)$ 的绝对偏差是 $|\\hat{S}(t) - S(t)|$。\n\n- **标准 KM 估计量的绝对偏差**：\n$$|\\hat{S}_{\\mathrm{KM}}(12) - S(12)| = \\left|\\frac{5}{8} - \\frac{1}{2}\\right| = \\left|\\frac{5}{8} - \\frac{4}{8}\\right| = \\frac{1}{8}$$\n\n- **左截断 KM 估计量的绝对偏差**：\n$$|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)| = \\left|\\frac{12}{25} - \\frac{1}{2}\\right| = \\left|\\frac{24}{50} - \\frac{25}{50}\\right| = \\left|-\\frac{1}{50}\\right| = \\frac{1}{50}$$\n\n- **绝对偏差之比**：\n$$\\frac{|\\hat{S}_{\\mathrm{KM}}(12) - S(12)|}{|\\hat{S}_{\\mathrm{LT\\text{-}KM}}(12) - S(12)|} = \\frac{1/8}{1/50} = \\frac{1}{8} \\times 50 = \\frac{50}{8} = \\frac{25}{4} = 6.25$$\n\n分析表明，忽略延迟入组时间的标准 Kaplan-Meier 估计量高估了生存概率，导致了显著的偏差。而正确考虑了延迟入组的左截断 Kaplan-Meier 估计量提供了一个准确得多的估计，这体现在其偏差要小得多。",
            "answer": "$$\\boxed{6.25}$$"
        },
        {
            "introduction": "除了生存率，我们还经常需要估计疾病或其并发症的发生率。然而，在大规模队列中用于识别病例的方法（如诊断算法或筛查测试）很少是完美的，这会导致病例的错误分类。本练习将引导您应用一项基本的流行病学技术：利用来自小型“金标准”验证研究的数据，来校正由于错误分类而产生的偏倚，从而获得更准确的发生率估计。",
            "id": "5034713",
            "problem": "一项针对某神经退行性疾病的纵向自然史研究招募了 $N_{\\text{total}}$ 名高危个体，并对他们进行了为期不等的随访，累计总人时为 $PT$ 人年。新发事件定义为在观察窗口内首次达到预设标准的诊断。应用于该队列的病例发现算法将 $N_{\\text{obs}}$ 名个体标记为新发病例。由于该算法并非完美，一项采用金标准裁定的独立验证研究得以进行。在该验证研究中，算法被应用于 $n_{\\text{cases}}$ 例经裁定的新发病例和 $n_{\\text{non}}$ 例经裁定的非病例，在病例中产生了 $TP$ 个真阳性，在非病例中产生了 $TN$ 个真阴性。该算法的敏感性和特异性分别定义为 $\\mathrm{Se} = \\Pr(\\text{flag} = 1 \\mid \\text{true case} = 1)$ 和 $\\mathrm{Sp} = \\Pr(\\text{flag} = 0 \\mid \\text{true case} = 0)$。\n\n假设如下：\n- 错分类相对于人时是无差异的，并且在个体间是独立的。\n- 在观察窗口内，每个个体最多只能贡献一次新发事件。\n- 分母 $PT$ 的测量没有误差。\n\n从敏感性、特异性和发病率的核心定义出发，推导朴素发病率估计量 $r_{\\text{obs}} = N_{\\text{obs}}/PT$ 相对于真实发病率 $r_{\\text{true}} = N_{\\text{true}}/PT$ 的期望偏差，其中 $N_{\\text{true}}$ 是真实新发事件的数量。然后，使用从验证研究中得到的敏感性和特异性估计值，计算经错分类校正的发病率。\n\n使用以下研究数据：\n- $N_{\\text{total}} = 1500$，$PT = 1400$ 人年，以及 $N_{\\text{obs}} = 180$。\n- 验证计数：$n_{\\text{cases}} = 80$ 例经裁定的真实新发病例，其中有 $TP = 68$ 例被算法标记为阳性；$n_{\\text{non}} = 320$ 例经裁定的真实非病例，其中有 $TN = 288$ 例被算法标记为阴性。\n\n说明：\n- 将校正后的发病率以每 $1000$ 人年的病例数表示。\n- 将校正后的发病率四舍五入至四位有效数字，并将其作为最终答案。",
            "solution": "该问题是有效的，因为它基于流行病学原理，问题陈述清晰，数据充分且一致，并且表述客观。我们可以开始求解。\n\n解答需要两部分：首先，对观测发病率的期望偏差进行符号推导；其次，利用所提供的数据计算校正后的发病率。\n\n设 $N_{\\text{total}}$ 为队列中的总人数。\n设 $N_{\\text{true}}$ 为真实新发病例数。\n设 $N_{\\text{obs}}$ 为算法标记的观测新发病例数。\n真实非病例数为 $N_{\\text{total}} - N_{\\text{true}}$。\n\n算法的性能由其敏感性（$\\mathrm{Se}$）和特异性（$\\mathrm{Sp}$）来表征：\n$\\mathrm{Se} = \\Pr(\\text{flagged positive} \\mid \\text{true case})$\n$\\mathrm{Sp} = \\Pr(\\text{flagged negative} \\mid \\text{true non-case})$\n由此，我们可以推导出假阳性概率，即 $1 - \\mathrm{Sp} = \\Pr(\\text{flagged positive} \\mid \\text{true non-case})$。\n\n观测病例数 $N_{\\text{obs}}$ 是真阳性（被正确标记的真实病例）和假阳性（被错误标记的真实非病例）的总和。在给定真实病例数 $N_{\\text{true}}$ 的条件下，$N_{\\text{obs}}$ 的期望值为：\n$$E[N_{\\text{obs}} \\mid N_{\\text{true}}] = N_{\\text{true}} \\cdot \\mathrm{Se} + (N_{\\text{total}} - N_{\\text{true}}) \\cdot (1 - \\mathrm{Sp})$$\n对 $N_{\\text{true}}$ 的分布取期望：\n$$E[N_{\\text{obs}}] = E[N_{\\text{true}}] \\cdot \\mathrm{Se} + (N_{\\text{total}} - E[N_{\\text{true}}]) \\cdot (1 - \\mathrm{Sp})$$\n真实发病率为 $r_{\\text{true}} = E[N_{\\text{true}}]/PT$，期望观测发病率为 $E[r_{\\text{obs}}] = E[N_{\\text{obs}}]/PT$，其中 $PT$ 是总人时，被视为常数。\n将 $E[N_{\\text{obs}}]$ 的方程两边除以 $PT$：\n$$E[r_{\\text{obs}}] = \\frac{E[N_{\\text{true}}]}{PT} \\cdot \\mathrm{Se} + \\frac{N_{\\text{total}} - E[N_{\\text{true}}]}{PT} \\cdot (1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\left(\\frac{N_{\\text{total}}}{PT} - \\frac{E[N_{\\text{true}}]}{PT}\\right) \\cdot (1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\left(\\frac{N_{\\text{total}}}{PT} - r_{\\text{true}}\\right) \\cdot (1 - \\mathrm{Sp})$$\n展开此表达式：\n$$E[r_{\\text{obs}}] = r_{\\text{true}} \\cdot \\mathrm{Se} + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp}) - r_{\\text{true}}(1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}}(\\mathrm{Se} - (1 - \\mathrm{Sp})) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n$$E[r_{\\text{obs}}] = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n期望偏差 $B$ 定义为 $E[r_{\\text{obs}}] - r_{\\text{true}}$。\n$$B = \\left( r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp}) \\right) - r_{\\text{true}}$$\n$$B = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 1 - 1) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n$$B = r_{\\text{true}}(\\mathrm{Se} + \\mathrm{Sp} - 2) + \\frac{N_{\\text{total}}}{PT}(1 - \\mathrm{Sp})$$\n这就是期望偏差的符号表达式。\n\n接下来，我们计算经错分类校正的发病率。首先，我们根据验证研究的数据估计 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$。\n给定：$n_{\\text{cases}} = 80$ 例真实病例，$TP = 68$ 个真阳性。\n给定：$n_{\\text{non}} = 320$ 例真实非病例，$TN = 288$ 个真阴性。\n敏感性和特异性的点估计值为：\n$$\\widehat{\\mathrm{Se}} = \\frac{TP}{n_{\\text{cases}}} = \\frac{68}{80} = 0.85$$\n$$\\widehat{\\mathrm{Sp}} = \\frac{TN}{n_{\\text{non}}} = \\frac{288}{320} = \\frac{9}{10} = 0.90$$\n为求得校正后的发病率，我们首先可以通过重排初始方程，并将观测计数 $N_{\\text{obs}}$ 代入其期望值，来求得校正后的真实病例数 $N_{\\text{true}}$：\n$$N_{\\text{obs}} \\approx N_{\\text{true}} \\cdot \\widehat{\\mathrm{Se}} + (N_{\\text{total}} - N_{\\text{true}}) \\cdot (1 - \\widehat{\\mathrm{Sp}})$$\n$$N_{\\text{obs}} \\approx N_{\\text{true}}(\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1) + N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}})$$\n解出 $N_{\\text{true}}$：\n$$N_{\\text{true}} \\approx \\frac{N_{\\text{obs}} - N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}})}{\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1}$$\n我们已知 $N_{\\text{obs}} = 180$，$N_{\\text{total}} = 1500$，$PT = 1400$ 人年。并且我们有估计值 $\\widehat{\\mathrm{Se}} = 0.85$ 和 $\\widehat{\\mathrm{Sp}} = 0.90$。\n分母项为 $\\widehat{\\mathrm{Se}} + \\widehat{\\mathrm{Sp}} - 1 = 0.85 + 0.90 - 1 = 0.75$。\n分子项为 $N_{\\text{obs}} - N_{\\text{total}}(1 - \\widehat{\\mathrm{Sp}}) = 180 - 1500(1 - 0.90) = 180 - 1500(0.10) = 180 - 150 = 30$。\n代入这些值：\n$$N_{\\text{true}} \\approx \\frac{30}{0.75} = \\frac{30}{3/4} = 40$$\n校正后的真实新发病例数估计为 $40$。\n校正后的发病率 $r_{\\text{true}}$ 为此计数除以总人时：\n$$r_{\\text{true}} = \\frac{N_{\\text{true}}}{PT} = \\frac{40}{1400} = \\frac{1}{35} \\text{ cases per person-year}$$\n问题要求以每 $1000$ 人年的病例数作为单位。\n$$r_{\\text{true, per 1000 PY}} = \\frac{1}{35} \\times 1000 = \\frac{1000}{35} = \\frac{200}{7} \\approx 28.571428...$$\n四舍五入至四位有效数字，校正后的发病率为 $28.57$ 病例/1000人年。",
            "answer": "$$\\boxed{28.57}$$"
        },
        {
            "introduction": "在描述了生存模式之后，理解疾病自然史的下一步是识别影响其进展的风险因素。Cox比例风险模型是实现这一目标的核心工具，它能够处理包含左截断和右删失的复杂数据结构。该模型的核心是部分似然法，它通过巧妙的条件概率论证，消除了估计未知的基线风险函数的需要。这项高级练习将带您推导适用于左截断数据的部分似然函数，并通过一个具体案例的计算，加深您对模型工作原理及其关键假设的理解。",
            "id": "5034739",
            "problem": "一项针对某种进展性神经肌肉疾病的自然病程注册研究从疾病的生物学发病开始追踪个体，但实际观察在诊断后才开始，这导致了左截断（延迟进入）。设个体 $i$ 在时间 $a_{i} \\geq 0$（从疾病发病开始计算）进入观察，如果事件发生，则在事件时间 $t_{i}$ 退出；否则，在删失时间 $c_{i}$ 退出。设 $\\delta_{i} \\in \\{0,1\\}$ 指示事件是否发生（$\\delta_{i}=1$）或受试者是否被右删失（$\\delta_{i}=0$）。假设事件时间互不相同且时间是连续的。假设采用可能包含时依协变量的 Cox 比例风险 (PH) 模型，\n$$\nh\\!\\left(t \\mid X_{i}(t)\\right) \\;=\\; h_{0}(t)\\,\\exp\\!\\big(\\beta^{\\top} X_{i}(t)\\big),\n$$\n其中 $h_{0}(t)$ 是未指明的基准风险函数，$X_{i}(t)$ 是个体 $i$ 在时间 $t$ 的协变量向量，$\\beta$ 是回归系数向量。将时间 $t$ 的左截断风险集定义为 $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$，其中如果 $\\delta_{j}=1$，则 $y_{j} = t_{j}$；如果 $\\delta_{j}=0$，则 $y_{j} = c_{j}$。\n\n任务：\n1. 从风险函数 $h(t \\mid X)$、生存函数 $S(t \\mid X)$ 的定义以及独立个体下联合似然的乘积积分构造出发，通过对观察到的事件时间的顺序和风险集 $R(t)$ 进行条件化，推导出存在左截断时 $\\beta$ 的偏似然。\n2. 考虑以下包含 $n=4$ 个个体的数据集，每个个体有一个时不变协变量 $x_{i}$：\n   - 个体 1：$a_{1} = 2$, $t_{1} = 6$, $\\delta_{1} = 1$, $x_{1} = 1.0$。\n   - 个体 2：$a_{2} = 0.5$, $t_{2} = 4$, $\\delta_{2} = 1$, $x_{2} = 0.5$。\n   - 个体 3：$a_{3} = 3$, $c_{3} = 7$, $\\delta_{3} = 0$, $x_{3} = 0.0$。\n   - 个体 4：$a_{4} = 5$, $t_{4} = 9$, $\\delta_{4} = 1$, $x_{4} = 2.0$。\n   使用您推导的表达式，在 $\\beta = \\ln(2)$ 处评估偏似然，并计算其数值。将您的答案四舍五入到四位有效数字。结果以无单位小数表示。\n3. 陈述在此设置下进行有效推断所需的假设，并解释在具有延迟诊断和右删失的自然病程研究背景下，为何这些假设是必要的。\n\n答案格式要求：按指定格式提供偏似然的单个数值，四舍五入到四位有效数字。似然值无需单位。",
            "solution": "用户提供了一个分为三部分的问题，涉及带有左截断和右删失数据的 Cox 比例风险模型。我将首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n-   **模型**：Cox 比例风险 (PH) 模型，$h(t \\mid X_{i}(t)) = h_{0}(t)\\,\\exp(\\beta^{\\top} X_{i}(t))$，其中 $h_{0}(t)$ 是基准风险函数，$X_{i}(t)$ 是协变量向量，$\\beta$ 是回归系数向量。\n-   **数据结构**：左截断、右删失生存数据。\n-   **个体 $i$ 的变量**：\n    -   $a_{i} \\geq 0$：进入时间（左截断时间）。\n    -   $t_{i}$：如果事件发生，则为事件时间。\n    -   $c_{i}$：如果右删失，则为删失时间。\n    -   $\\delta_{i} \\in \\{0,1\\}$：事件指示符，$\\delta_{i}=1$ 表示事件发生，$\\delta_{i}=0$ 表示删失。\n    -   $y_{j} = t_{j}$ 如果 $\\delta_{j}=1$；$y_{j} = c_{j}$ 如果 $\\delta_{j}=0$。\n-   **风险集定义**：时间 $t$ 的左截断风险集为 $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$。\n-   **假设**：事件时间互不相同且时间是连续的。\n-   **任务 1**：推导存在左截断时 $\\beta$ 的偏似然。\n-   **任务 2**：对于特定数据集，在 $\\beta = \\ln(2)$ 处评估偏似然。\n    -   $n=4$ 个个体的数据集，每个个体有一个时不变协变量 $x_{i}$：\n        -   个体 1：$a_{1} = 2$, $t_{1} = 6$, $\\delta_{1} = 1$, $x_{1} = 1.0$。\n        -   个体 2：$a_{2} = 0.5$, $t_{2} = 4$, $\\delta_{2} = 1$, $x_{2} = 0.5$。\n        -   个体 3：$a_{3} = 3$, $c_{3} = 7$, $\\delta_{3} = 0$, $x_{3} = 0.0$。\n        -   个体 4：$a_{4} = 5$, $t_{4} = 9$, $\\delta_{4} = 1$, $x_{4} = 2.0$。\n-   **任务 3**：陈述进行有效推断所需的假设并解释其相关性。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据、良定且客观。它描述了生物统计学和临床研究中的一个标准场景：分析来自自然病程研究的生存数据，其中受试者在疾病发作后被招募（左截断），并且可能在事件发生前失访或研究结束（右删失）。Cox 模型是此类分析的标准方法。所提供的数据是完整且一致的，任务定义明确，能够导出一个唯一的、有意义的解。该问题不违反任何无效标准。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 第 1 部分：偏似然的推导\n设 $T_i$ 为个体 $i$ 的真实事件时间，$X_i(t)$ 为其在时间 $t$ 的协变量向量。风险函数为 $h(t \\mid X_i(t)) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\le T_i  t+\\Delta t \\mid T_i \\ge t, X_i(t))}{\\Delta t}$。在 Cox 模型中，这由 $h(t \\mid X_i(t)) = h_0(t) \\exp(\\beta^\\top X_i(t))$ 给出。相应的生存函数为 $S(t \\mid X_i) = \\exp(-\\int_0^t h(u \\mid X_i(u)) du)$。\n\n对于一个有左截断和右删失的数据集，个体 $i$ 的观察值包括进入时间 $a_i$、观察到的退出时间 $y_i$（事件时间 $t_i$ 或删失时间 $c_i$）以及事件指示符 $\\delta_i$。关键点在于，只有当个体 $i$ 存活到其进入时间（即 $T_i \\ge a_i$）时，才会被纳入研究。因此，个体 $i$ 的似然贡献是基于此事实的条件概率。\n\n对于一个观察值为 $(y_i, \\delta_i)$ 的个体，其无条件似然贡献为 $L_i^{uc} = f(y_i|X_i)^{\\delta_i} S(y_i|X_i)^{1-\\delta_i} = [h(y_i|X_i)S(y_i|X_i)]^{\\delta_i} S(y_i|X_i)^{1-\\delta_i} = h(y_i|X_i)^{\\delta_i}S(y_i|X_i)$。\n给定存活到 $a_i$ 的条件似然为：\n$$L_i = P(\\text{data}_i \\mid T_i \\ge a_i) = \\frac{h(y_i|X_i)^{\\delta_i} S(y_i|X_i)}{P(T_i \\ge a_i)} = \\frac{h(y_i|X_i)^{\\delta_i} S(y_i|X_i)}{S(a_i|X_i)}$$\n生存函数的比值可以写为：\n$$\\frac{S(y_i|X_i)}{S(a_i|X_i)} = \\frac{\\exp(-\\int_0^{y_i} h_0(u)\\exp(\\beta^\\top X_i(u))du)}{\\exp(-\\int_0^{a_i} h_0(u)\\exp(\\beta^\\top X_i(u))du)} = \\exp\\left(-\\int_{a_i}^{y_i} h_0(u)\\exp(\\beta^\\top X_i(u))du\\right)$$\n假设个体之间相互独立，整个数据集的全似然为 $L_{full}(\\beta, h_0) = \\prod_{i=1}^n L_i$。这个全似然函数依赖于未知的非参数基准风险函数 $h_0(t)$。\n\nCox 的偏似然方法通过在每个事件时间点进行条件论证，避免了估计 $h_0(t)$ 的需要。设排序后的不同事件时间为 $t_{(1)}  t_{(2)}  \\dots  t_{(k)}$。在每个事件时间 $t_{(j)}$，我们考虑在该时刻有事件发生“风险”的个体集合。这就是风险集 $R(t_{(j)})$，在存在左截断的情况下，它由所有在时间 $t_{(j)}$ 前已进入研究（$a_l \\le t_{(j)}$）且尚未经历事件或被删失（$y_l \\ge t_{(j)}$）的个体 $l$ 组成。这与提供的定义 $R(t) = \\{j : a_{j} \\leq t \\leq y_{j}\\}$ 相符。\n\n给定在时间 $t_{(j)}$，风险集 $R(t_{(j)})$ 中的个体恰好发生一个事件，该事件发生在特定个体 $i$（即在 $t_{(j)}$ 观察到发生事件的那个个体）上的条件概率是：\n$$P(\\text{individual } i \\text{ fails at } t_{(j)} \\mid \\text{one failure from } R(t_{(j)}) \\text{ at } t_{(j)} ) = \\frac{h(t_{(j)} \\mid X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h(t_{(j)} \\mid X_l(t_{(j)}))}$$\n代入 Cox 模型公式：\n$$ \\frac{h_0(t_{(j)}) \\exp(\\beta^\\top X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h_0(t_{(j)}) \\exp(\\beta^\\top X_l(t_{(j)}))} = \\frac{\\exp(\\beta^\\top X_i(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} \\exp(\\beta^\\top X_l(t_{(j)}))} $$\n基准风险 $h_0(t_{(j)})$ 被消去。偏似然 $L_P(\\beta)$ 是这些条件概率在所有观察到的事件上的乘积。设经历事件的个体集合表示为 $\\mathcal{D} = \\{i : \\delta_i = 1\\}$。偏似然为：\n$$ L_P(\\beta) = \\prod_{i \\in \\mathcal{D}} \\frac{\\exp(\\beta^\\top X_i(t_i))}{\\sum_{j \\in R(t_i)} \\exp(\\beta^\\top X_j(t_i))} $$\n这就是所要求的表达式。通过对风险集 $R(t)$ 的正确定义，左截断被完全考虑在内。\n\n### 第 2 部分：偏似然的评估\n数据集在时间 $t=4$（个体 2）、$t=6$（个体 1）和 $t=9$（个体 4）有事件发生。协变量是单个时不变变量 $x_i$，且 $\\beta = \\ln(2)$。\n偏似然是三项的乘积，每个事件对应一项。\n$L_P(\\beta) = L_1 \\times L_2 \\times L_3$，对应于在 $t=4, 6, 9$ 发生的事件。\n\n1.  **在 $t_2=4$ 时的事件（个体 2）**\n    风险集 $R(4)$ 由满足 $a_j \\le 4 \\le y_j$ 的个体 $j$ 组成。\n    -   个体 1：$a_1=2, y_1=6$。条件 $2 \\le 4 \\le 6$ 为真。在 $R(4)$ 中。$x_1 = 1.0$。\n    -   个体 2：$a_2=0.5, y_2=4$。条件 $0.5 \\le 4 \\le 4$ 为真。在 $R(4)$ 中。$x_2 = 0.5$。\n    -   个体 3：$a_3=3, y_3=7$。条件 $3 \\le 4 \\le 7$ 为真。在 $R(4)$ 中。$x_3 = 0.0$。\n    -   个体 4：$a_4=5, y_4=9$。条件 $5 \\le 4$ 为假。不在 $R(4)$ 中。\n    所以，$R(4) = \\{1, 2, 3\\}$。该事件的项为：\n    $$L_1 = \\frac{\\exp(\\beta x_2)}{\\exp(\\beta x_1) + \\exp(\\beta x_2) + \\exp(\\beta x_3)}$$\n    当 $\\beta = \\ln(2)$ 时，$\\exp(\\beta x_i)$ 项变为 $\\exp(x_i \\ln(2)) = 2^{x_i}$。\n    $$L_1 = \\frac{2^{0.5}}{2^{1.0} + 2^{0.5} + 2^{0.0}} = \\frac{\\sqrt{2}}{2 + \\sqrt{2} + 1} = \\frac{\\sqrt{2}}{3 + \\sqrt{2}}$$\n\n2.  **在 $t_1=6$ 时的事件（个体 1）**\n    风险集 $R(6)$ 由满足 $a_j \\le 6 \\le y_j$ 的个体 $j$ 组成。\n    -   个体 1：$a_1=2, y_1=6$。条件 $2 \\le 6 \\le 6$ 为真。在 $R(6)$ 中。$x_1 = 1.0$。\n    -   个体 2：$a_2=0.5, y_2=4$。条件 $6 \\le 4$ 为假。不在 $R(6)$ 中。\n    -   个体 3：$a_3=3, y_3=7$。条件 $3 \\le 6 \\le 7$ 为真。在 $R(6)$ 中。$x_3 = 0.0$。\n    -   个体 4：$a_4=5, y_4=9$。条件 $5 \\le 6 \\le 9$ 为真。在 $R(6)$ 中。$x_4 = 2.0$。\n    所以，$R(6) = \\{1, 3, 4\\}$。该事件的项为：\n    $$L_2 = \\frac{\\exp(\\beta x_1)}{\\exp(\\beta x_1) + \\exp(\\beta x_3) + \\exp(\\beta x_4)} = \\frac{2^{1.0}}{2^{1.0} + 2^{0.0} + 2^{2.0}} = \\frac{2}{2 + 1 + 4} = \\frac{2}{7}$$\n\n3.  **在 $t_4=9$ 时的事件（个体 4）**\n    风险集 $R(9)$ 由满足 $a_j \\le 9 \\le y_j$ 的个体 $j$ 组成。\n    -   个体 1：$y_1=6$。条件 $9 \\le 6$ 为假。\n    -   个体 2：$y_2=4$。条件 $9 \\le 4$ 为假。\n    -   个体 3：$y_3=7$。条件 $9 \\le 7$ 为假。\n    -   个体 4：$a_4=5, y_4=9$。条件 $5 \\le 9 \\le 9$ 为真。在 $R(9)$ 中。$x_4 = 2.0$。\n    所以，$R(9) = \\{4\\}$。该事件的项为：\n    $$L_3 = \\frac{\\exp(\\beta x_4)}{\\exp(\\beta x_4)} = \\frac{2^{2.0}}{2^{2.0}} = \\frac{4}{4} = 1$$\n\n总偏似然是这三项的乘积：\n$$L_P(\\ln(2)) = L_1 \\times L_2 \\times L_3 = \\left( \\frac{\\sqrt{2}}{3 + \\sqrt{2}} \\right) \\times \\left( \\frac{2}{7} \\right) \\times 1 = \\frac{2\\sqrt{2}}{7(3 + \\sqrt{2})}$$\n为了计算数值，我们可以先将分母有理化：\n$$L_P(\\ln(2)) = \\frac{2\\sqrt{2}}{7(3 + \\sqrt{2})} \\times \\frac{3 - \\sqrt{2}}{3 - \\sqrt{2}} = \\frac{2\\sqrt{2}(3 - \\sqrt{2})}{7(3^2 - (\\sqrt{2})^2)} = \\frac{6\\sqrt{2} - 2(2)}{7(9-2)} = \\frac{6\\sqrt{2} - 4}{49}$$\n使用数值 $\\sqrt{2} \\approx 1.41421356$：\n$$L_P(\\ln(2)) \\approx \\frac{6(1.41421356) - 4}{49} = \\frac{8.48528136 - 4}{49} = \\frac{4.48528136}{49} \\approx 0.091536354$$\n四舍五入到四位有效数字，结果是 $0.09154$。\n\n### 第 3 部分：有效推断的假设\n对于使用带有左截断和右删失数据的 Cox 模型进行有效推断，需要几个关键假设。\n\n1.  **比例风险 (PH)**：任意两个体之间的风险比随时间保持不变，即 $h(t|X_i)/h(t|X_j)$ 与 $t$ 无关。\n    *   **必要性**：这是 Cox 模型的基本假设。它允许将协变量的影响（$\\beta$）与时间的影响（$h_0(t)$）分开，从而能够构建偏似然，其中 $h_0(t)$ 被消去。在自然病程研究中，这意味着协变量对风险的乘法效应（例如，疾病进展的风险）在疾病过程中不发生改变。违反此假设需要更复杂的模型，例如带有随时间变化的系数的模型。\n\n2.  **独立删失**：导致个体被右删失的机制必须与其潜在的事件风险无关。个体的删失时间除了协变量中已包含的信息外，不提供关于其事件时间的任何额外信息。\n    *   **必要性**：如果删失是信息性的（例如，病情较重的患者更有可能退出研究），那么剩余的样本就会产生偏倚。观察到的事件率将不代表真实率，导致 $\\beta$ 的估计有偏。在自然病程研究中，右删失可能由于研究终止（非信息性）或失访而发生。如果失访与疾病严重程度相关，则此假设被违反。\n\n3.  **独立（或非信息性）左截断**：进入研究的时间 $a_i$ 必须在给定协变量的条件下与事件时间 $T_i$ 独立。这是一个强假设。一个较弱的充分条件是，对于在时间 $t$ 处于风险集中的任何个体，他们的进入时间 $a_i  t$ 并不能预测他们未来的风险。\n    *   **必要性**：偏似然依赖于在每个事件时间点对风险集进行条件化。这隐含地假设了决定谁在风险集中的过程（即截断过程）对于当前观察到的个体的相对风险是非信息性的。在自然病程研究中，如果进入研究的时间点是诊断时间，那么当诊断时间与疾病的侵袭性相关时，此假设就会被违反。例如，如果病情更具侵袭性的患者被诊断得更早，那么在任何给定时间 $t$，风险集中将缺少那些早期患有侵袭性疾病的个体，导致样本有偏，并可能低估风险效应。\n\n4.  **个体独立性**：研究中不同个体的事件时间在统计上是独立的。\n    *   **必要性**：总似然函数是通过将各个体的似然贡献相乘来构建的。只有当观察值是独立的时，这一步才有效。在自然病程研究中，这通常是一个合理的假设，除非存在未测量的混杂因素在受试者群体中聚集（例如，家族内的遗传因素或共同的环境暴露）。",
            "answer": "$$\\boxed{0.09154}$$"
        }
    ]
}