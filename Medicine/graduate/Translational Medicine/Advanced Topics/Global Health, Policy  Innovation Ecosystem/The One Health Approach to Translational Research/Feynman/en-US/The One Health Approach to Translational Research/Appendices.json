{
    "hands_on_practices": [
        {
            "introduction": "Effective surveillance is the cornerstone of the One Health approach, but interpreting diagnostic tests across different species presents a significant challenge. This practice explores the crucial distinction between a test's inherent accuracy and its predictive value in a given population . By applying Bayes' theorem, you will see firsthand how prevalence dramatically influences the reliability of a positive result, a fundamental concept for anyone working with cross-species diagnostic data.",
            "id": "5069050",
            "problem": "A translational research team in a One Health framework is validating a single Reverse Transcription Polymerase Chain Reaction (RT-PCR) assay for a zoonotic respiratory pathogen across humans and cattle. Because of species-specific sample matrix effects, the assay demonstrates different operating characteristics in each species. In humans, the assay exhibits sensitivity $\\,\\mathrm{Se}_{H} = 0.95\\,$ and specificity $\\,\\mathrm{Sp}_{H} = 0.98\\,$; in cattle, the assay exhibits sensitivity $\\,\\mathrm{Se}_{C} = 0.90\\,$ and specificity $\\,\\mathrm{Sp}_{C} = 0.97\\,$. The pre-test probability (prevalence) is $\\,\\pi_{H} = 0.04\\,$ in humans and $\\,\\pi_{C}\\,$ is unknown in cattle. Positive Predictive Value (PPV) is defined as the posterior probability of true infection given a positive test result.\n\nStarting only from (i) the Kolmogorov axioms of probability, (ii) Bayes’ theorem $\\,P(A \\mid B) = \\frac{P(B \\mid A)\\,P(A)}{P(B)}\\,$, (iii) the law of total probability, and (iv) the core diagnostic definitions $\\,\\mathrm{Se} = P(T^{+} \\mid D)\\,$ and $\\,\\mathrm{Sp} = P(T^{-} \\mid \\neg D)\\,$ where $\\,D\\,$ denotes disease and $\\,T^{+}\\,$ denotes a positive test, derive the relationship between pre-test probability $\\,\\pi\\,$ and $\\,\\text{PPV}\\,$ across species. Then, using the human parameters, compute $\\,\\text{PPV}_{H}\\,$. Finally, determine the cattle prevalence $\\,\\pi_{C}\\,$ such that the cattle PPV equals the human PPV, i.e., $\\,\\text{PPV}_{C}(\\pi_{C}) = \\text{PPV}_{H}\\,$. Express your final answer for $\\,\\pi_{C}\\,$ as a decimal fraction rounded to four significant figures. No units are required. Do not use a percentage sign; express probabilities as decimals.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The solution process proceeds as follows.\n\nThe objective is to derive an expression for the Positive Predictive Value (PPV) in terms of pre-test probability ($\\pi$), sensitivity ($\\mathrm{Se}$), and specificity ($\\mathrm{Sp}$); calculate the PPV for the human population ($\\text{PPV}_{H}$); and then determine the pre-test probability in cattle ($\\pi_{C}$) that would yield an equivalent PPV.\n\nLet $D$ be the event that an individual has the disease, and $\\neg D$ be the event that an individual does not have the disease. Let $T^{+}$ be the event of a positive test result. The pre-test probability, or prevalence, is given as $\\pi = P(D)$. From the axioms of probability, the probability of not having the disease is $P(\\neg D) = 1 - P(D) = 1 - \\pi$.\n\nThe core diagnostic definitions provided are:\nSensitivity: $\\mathrm{Se} = P(T^{+} \\mid D)$\nSpecificity: $\\mathrm{Sp} = P(T^{-} \\mid \\neg D)$, where $T^{-}$ is a negative test result.\n\nFrom the definition of conditional probability and the complement rule, the probability of a positive test given no disease (the false positive rate) is $P(T^{+} \\mid \\neg D) = 1 - P(T^{-} \\mid \\neg D) = 1 - \\mathrm{Sp}$.\n\nPositive Predictive Value (PPV) is the posterior probability of disease given a positive test, $P(D \\mid T^{+})$. Using the provided statement of Bayes’ theorem, $P(A \\mid B) = \\frac{P(B \\mid A)P(A)}{P(B)}$, we can write:\n$$ \\text{PPV} = P(D \\mid T^{+}) = \\frac{P(T^{+} \\mid D) P(D)}{P(T^{+})} $$\nThe numerator can be expressed using the given definitions as $P(T^{+} \\mid D) P(D) = \\mathrm{Se} \\cdot \\pi$.\n\nThe denominator, $P(T^{+})$, is the overall probability of a positive test. Using the law of total probability, we can expand $P(T^{+})$ by conditioning on the disease status ($D$ or $\\neg D$):\n$$ P(T^{+}) = P(T^{+} \\mid D) P(D) + P(T^{+} \\mid \\neg D) P(\\neg D) $$\nSubstituting the expressions for each term:\n$$ P(T^{+}) = (\\mathrm{Se} \\cdot \\pi) + ((1 - \\mathrm{Sp}) \\cdot (1 - \\pi)) $$\nCombining the numerator and the expanded denominator gives the general relationship between PPV and pre-test probability $\\pi$:\n$$ \\text{PPV}(\\pi, \\mathrm{Se}, \\mathrm{Sp}) = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi)} $$\nThis completes the first part of the task.\n\nNext, we compute $\\text{PPV}_{H}$ using the parameters for the human population: sensitivity $\\mathrm{Se}_{H} = 0.95$, specificity $\\mathrm{Sp}_{H} = 0.98$, and pre-test probability $\\pi_{H} = 0.04$.\n$$ \\text{PPV}_{H} = \\frac{\\mathrm{Se}_{H} \\cdot \\pi_{H}}{\\mathrm{Se}_{H} \\cdot \\pi_{H} + (1 - \\mathrm{Sp}_{H})(1 - \\pi_{H})} $$\n$$ \\text{PPV}_{H} = \\frac{0.95 \\cdot 0.04}{0.95 \\cdot 0.04 + (1 - 0.98)(1 - 0.04)} $$\n$$ \\text{PPV}_{H} = \\frac{0.038}{0.038 + (0.02)(0.96)} $$\n$$ \\text{PPV}_{H} = \\frac{0.038}{0.038 + 0.0192} $$\n$$ \\text{PPV}_{H} = \\frac{0.038}{0.0572} = \\frac{380}{572} = \\frac{95}{143} $$\nThe exact value of the Positive Predictive Value in humans is $\\frac{95}{143}$.\n\nFinally, we must find the cattle prevalence $\\pi_{C}$ for which the cattle PPV, $\\text{PPV}_{C}(\\pi_{C})$, is equal to $\\text{PPV}_{H}$. The parameters for cattle are sensitivity $\\mathrm{Se}_{C} = 0.90$ and specificity $\\mathrm{Sp}_{C} = 0.97$.\nThe expression for $\\text{PPV}_{C}$ is:\n$$ \\text{PPV}_{C}(\\pi_{C}) = \\frac{\\mathrm{Se}_{C} \\cdot \\pi_{C}}{\\mathrm{Se}_{C} \\cdot \\pi_{C} + (1 - \\mathrm{Sp}_{C})(1 - \\pi_{C})} $$\n$$ \\text{PPV}_{C}(\\pi_{C}) = \\frac{0.90 \\cdot \\pi_{C}}{0.90 \\cdot \\pi_{C} + (1 - 0.97)(1 - \\pi_{C})} $$\n$$ \\text{PPV}_{C}(\\pi_{C}) = \\frac{0.90 \\pi_{C}}{0.90 \\pi_{C} + 0.03(1 - \\pi_{C})} $$\n$$ \\text{PPV}_{C}(\\pi_{C}) = \\frac{0.90 \\pi_{C}}{0.90 \\pi_{C} + 0.03 - 0.03 \\pi_{C}} $$\n$$ \\text{PPV}_{C}(\\pi_{C}) = \\frac{0.90 \\pi_{C}}{0.87 \\pi_{C} + 0.03} $$\nWe set this equal to the calculated $\\text{PPV}_{H}$:\n$$ \\frac{0.90 \\pi_{C}}{0.87 \\pi_{C} + 0.03} = \\frac{95}{143} $$\nNow we solve for $\\pi_{C}$. Cross-multiplication yields:\n$$ 143 \\cdot (0.90 \\pi_{C}) = 95 \\cdot (0.87 \\pi_{C} + 0.03) $$\n$$ 128.7 \\pi_{C} = 82.65 \\pi_{C} + 2.85 $$\n$$ (128.7 - 82.65) \\pi_{C} = 2.85 $$\n$$ 46.05 \\pi_{C} = 2.85 $$\n$$ \\pi_{C} = \\frac{2.85}{46.05} $$\n$$ \\pi_{C} \\approx 0.06188925... $$\nThe problem requires the answer as a decimal fraction rounded to four significant figures. The first four significant figures are $6$, $1$, $8$, $8$. The fifth digit is $9$, so we round the fourth digit up.\n$$ \\pi_{C} \\approx 0.06189 $$\nThus, a prevalence of approximately $0.06189$ in the cattle population would result in a Positive Predictive Value equal to that observed in the human population.",
            "answer": "$$\n\\boxed{0.06189}\n$$"
        },
        {
            "introduction": "The One Health framework is critical for understanding and combating antimicrobial resistance, which evolves within a complex web of interconnected host populations. This exercise guides you through modeling these evolutionary dynamics using a system of differential equations that accounts for selection, mutation, and inter-species mixing . You will use linear stability analysis, a powerful technique in population genetics, to quantify the rate of resistance emergence and assess the system-wide effectiveness of different intervention strategies.",
            "id": "5069047",
            "problem": "You are asked to formalize and implement a deterministic multi-host evolutionary dynamics model consistent with the One Health approach, in which resistant and susceptible genotypes compete and mix across hosts. The goal is to quantify how specified interventions alter the early-time rate of resistance emergence. Your solution must begin from widely accepted population genetics and mass-action mixing principles, derive the appropriate linearization to isolate an interpretable rate, and then implement a programmatic computation of this rate for several test scenarios. The final output must aggregate results for all test cases into a single line as specified below.\n\nFundamental base and definitions:\n- Consider $H$ host compartments indexed by $i \\in \\{1,\\dots,H\\}$, each with two genotypes: susceptible ($S$) and resistant ($R$). Let $x_i(t) \\in [0,1]$ denote the fraction of genotype $R$ in host $i$ at time $t$ (in days).\n- Let $w_{i,S}$ and $w_{i,R}$ denote within-host reproductive fitnesses (per day) of $S$ and $R$ in host $i$, respectively. Define the selection coefficient $s_i$ via $w_{i,R} - w_{i,S} = s_i$ (per day).\n- Let $\\mu_{S \\to R}$ and $\\mu_{R \\to S}$ denote per-day mutation rates from $S$ to $R$ and from $R$ to $S$, respectively.\n- Let $m_{j i} \\ge 0$ (per day) denote the mass-action mixing rate by which host $j$ contributes to host $i$ for genotype mixing. The mixing term is expressed as $\\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big)$, which drives $x_i$ toward a weighted average of other hosts, conserving total population across hosts in a coarse-grained sense.\n\nModel equations:\n- Under replicator-mutator dynamics with mass-action inter-host mixing, the fraction $x_i(t)$ follows\n$$\n\\frac{dx_i}{dt} = x_i(1 - x_i)\\, s_i + \\mu_{S \\to R} (1 - x_i) - \\mu_{R \\to S}\\, x_i + \\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big).\n$$\n- Early-time emergence is governed by the linearization near $x_i \\approx 0$. Linearizing the above around the resistance-rare state yields\n$$\n\\frac{dx_i}{dt} \\approx \\underbrace{s_i\\, x_i - (\\mu_{S \\to R} + \\mu_{R \\to S})\\, x_i - \\left(\\sum_{j \\ne i} m_{j i}\\right) x_i + \\sum_{j \\ne i} m_{j i} x_j}_{\\text{homogeneous linear part}} + \\underbrace{\\mu_{S \\to R}}_{\\text{constant source}},\n$$\nwhich can be written compactly as\n$$\n\\frac{d\\mathbf{x}}{dt} = A\\, \\mathbf{x} + \\mathbf{b}, \\quad \\text{with} \\quad \\mathbf{x} = (x_1, \\dots, x_H)^\\top,\n$$\nwhere\n$$\nA_{i i} = s_i - (\\mu_{S \\to R} + \\mu_{R \\to S}) - \\sum_{j \\ne i} m_{j i}, \\quad A_{i j} = m_{j i} \\ \\text{for} \\ i \\ne j, \\quad \\mathbf{b}_i = \\mu_{S \\to R}.\n$$\n- The constant source vector $\\mathbf{b}$ sets an injection scale but does not determine the asymptotic growth rate near zero. A principled and interpretable early-time rate of resistance emergence is the dominant eigenvalue (largest real part) of $A$, denoted $\\lambda_{\\max}(A)$, with units of per day. This quantity governs the exponential tendency of small resistance fractions under the homogeneous linear dynamics and is widely used in stability and invasion analysis.\n\nTask:\n1. For each test case, construct the matrix $A$ from the provided baseline parameters ($s_i$, $\\mu_{S \\to R}$, $\\mu_{R \\to S}$, $m_{j i}$), and compute the baseline emergence rate $r_{\\text{base}} = \\lambda_{\\max}(A_{\\text{base}})$ in per day.\n2. Apply the specified intervention strategy (modified $s_i$ and $m_{j i}$), construct $A_{\\text{int}}$, and compute $r_{\\text{int}} = \\lambda_{\\max}(A_{\\text{int}})$ in per day.\n3. Report the fractional change in the rate due to intervention as a dimensionless decimal\n$$\n\\Delta = \\frac{r_{\\text{base}} - r_{\\text{int}}}{\\lvert r_{\\text{base}} \\rvert}.\n$$\nIf $r_{\\text{base}} > 0$, a positive $\\Delta$ indicates reduction in early-time resistance emergence. All rates are per day and the fractional change $\\Delta$ is dimensionless; no percentage signs should be used.\n\nTest suite (use $H=3$ hosts; interpret host $1$ as human, host $2$ as livestock, host $3$ as wildlife):\n- Test case $1$ (happy path; moderate inter-host mixing; stewardship reduces selection and biosecurity reduces mixing):\n  - Baseline: $s = [0.08, -0.02, 0.00]$ per day, $\\mu_{S \\to R} = 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $$M_{\\text{base}} = \\begin{bmatrix} 0 & 0.02 & 0.005 \\\\ 0.02 & 0 & 0.003 \\\\ 0.005 & 0.003 & 0 \\end{bmatrix}$$ per day, where $M_{j i} = m_{j i}$.\n  - Intervention: $s' = [0.01, -0.02, 0.00]$ per day,\n    $$M_{\\text{int}} = \\begin{bmatrix} 0 & 0.005 & 0.002 \\\\ 0.005 & 0 & 0.003 \\\\ 0.002 & 0.003 & 0 \\end{bmatrix}$$ per day.\n- Test case $2$ (boundary; zero mixing; stewardship removes advantage in one host):\n  - Baseline: $s = [0.03, -0.01, -0.01]$ per day, $\\mu_{S \\to R} = 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $$M_{\\text{base}} = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$$ per day.\n  - Intervention: $s' = [0.00, -0.01, -0.01]$ per day,\n    $$M_{\\text{int}} = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$$ per day.\n- Test case $3$ (higher mixing and modest selection; combined vaccination and stewardship reduce both mixing and selection):\n  - Baseline: $s = [0.02, 0.01, 0.01]$ per day, $\\mu_{S \\to R} = 5 \\times 10^{-7}$ per day, $\\mu_{R \\to S} = 10^{-6}$ per day,\n    $$M_{\\text{base}} = \\begin{bmatrix} 0 & 0.015 & 0.01 \\\\ 0.015 & 0 & 0.012 \\\\ 0.01 & 0.012 & 0 \\end{bmatrix}$$ per day.\n  - Intervention: $s' = [0.005, 0.005, 0.005]$ per day,\n    $M_{\\text{int}} = 0.4 \\times M_{\\text{base}}$ per day (that is, a $60\\%$ reduction in mixing rates, expressed by multiplying entries by $0.4$).\n- Test case $4$ (edge; extremely low de novo mutation to confirm rate measure’s independence from constant injection):\n  - Baseline: same $s$ and $M_{\\text{base}}$ as in test case $1$, but $\\mu_{S \\to R} = 10^{-12}$ per day and $\\mu_{R \\to S} = 10^{-6}$ per day.\n  - Intervention: same $s'$ and $M_{\\text{int}}$ as in test case $1$.\n\nImplementation and output specification:\n- Your program must construct $A$ and compute $\\lambda_{\\max}(A)$ for each baseline and intervention pair, compute $\\Delta$ for each test case, and aggregate results across all test cases into a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[result1,result2,result3,result4]}$.\n- All rates must be handled in units of per day. The final reported values are the dimensionless fractional changes $\\Delta$ for each test case.",
            "solution": "The objective is to quantify the impact of several intervention strategies on the early-time emergence of a resistant genotype in a multi-host system. The problem is framed within the One Health paradigm, considering interactions between human, livestock, and wildlife populations. The core of the analysis lies in a system of ordinary differential equations that model the fraction of the resistant genotype, $x_i(t)$, in each host compartment $i$.\n\nThe provided model is:\n$$\n\\frac{dx_i}{dt} = x_i(1 - x_i)\\, s_i + \\mu_{S \\to R} (1 - x_i) - \\mu_{R \\to S}\\, x_i + \\sum_{j \\ne i} m_{j i}\\big(x_j - x_i\\big)\n$$\nwhere $s_i$ is the selection coefficient, $\\mu_{S \\to R}$ and $\\mu_{R \\to S}$ are mutation rates, and $m_{ji}$ are inter-host mixing rates.\n\nTo analyze the initial emergence of resistance, the dynamics are linearized around the resistance-rare state, where all $x_i \\approx 0$. This leads to the linear system:\n$$\n\\frac{d\\mathbf{x}}{dt} = A\\, \\mathbf{x} + \\mathbf{b}\n$$\nThe rate of emergence is determined by the properties of the matrix $A$, which captures the homogeneous part of the linearized dynamics. The constant vector $\\mathbf{b}$ represents a source term due to de novo mutations and does not influence the exponential growth rate. The principled measure for the early-time emergence rate is the dominant eigenvalue of $A$, denoted $r = \\lambda_{\\max}(A)$, which corresponds to the eigenvalue with the largest real part. A positive $r$ indicates that small fractions of resistance will tend to grow exponentially, while a negative $r$ indicates they will decay.\n\nThe main task is to compute the fractional change in this emergence rate, $\\Delta$, resulting from an intervention. This is calculated as:\n$$\n\\Delta = \\frac{r_{\\text{base}} - r_{\\text{int}}}{\\lvert r_{\\text{base}} \\rvert}\n$$\nwhere $r_{\\text{base}} = \\lambda_{\\max}(A_{\\text{base}})$ and $r_{\\text{int}} = \\lambda_{\\max}(A_{\\text{int}})$ are the emergence rates for the baseline and intervention scenarios, respectively. A positive $\\Delta$ signifies a successful intervention that reduces the rate of resistance emergence. The logic proceeds in three main steps for each test case.\n\n**Step 1: Construction of the System Matrix $A$**\n\nThe matrix $A$ of size $H \\times H$ (where $H=3$ for all test cases) is constructed based on the model parameters. Its elements are defined by:\n$$\nA_{ii} = s_i - (\\mu_{S \\to R} + \\mu_{R \\to S}) - \\sum_{j \\ne i} m_{j i}\n$$\n$$\nA_{ij} = m_{j i} \\quad \\text{for} \\quad i \\ne j\n$$\n\nHere, $i$ and $j$ are $1$-based indices from $1$ to $H$.\n- The diagonal element $A_{ii}$ aggregates influences on host $i$'s resistance fraction. It includes positive selection ($s_i$), decay due to net back-mutation (the term $-(\\mu_{S \\to R} + \\mu_{R \\to S})$ is a slight simplification, but as derived in the problem statement from linearization, it represents the net effect of mutation on the $x_i$ population), and dilution from mixing with other host populations (the term $-\\sum_{j \\ne i} m_{j i}$).\n- The off-diagonal element $A_{ij}$ represents the contribution from host $j$ to host $i$ via mixing, with rate $m_{ji}$. The problem specifies that the provided mixing matrices $M$ follow the convention $M_{ji} = m_{ji}$. Therefore, to construct $A$, the off-diagonal element $A_{ij}$ is taken from the entry in the $j$-th row and $i$-th column of the given matrix $M$. This corresponds to using the transpose of $M$ for the off-diagonal part of $A$. The diagonal term's summation, $\\sum_{j \\ne i} m_{j i}$, is the sum of the $i$-th column of $M$ (as the diagonal entries of $M$ are zero).\n\n**Step 2: Computation of the Emergence Rate $r = \\lambda_{\\max}(A)$**\n\nOnce the matrix $A$ is constructed for a given scenario (baseline or intervention), its eigenvalues are computed numerically. The emergence rate $r$ is the maximum value among the real parts of all computed eigenvalues. This value dictates the long-term behavior of the linearized system: if $r > 0$, the system is unstable at the resistance-free state, and resistance is expected to emerge and grow.\n\n**Step 3: Calculation of the Fractional Change $\\Delta$**\n\nFor each test case, we compute $r_{\\text{base}}$ using the baseline parameters and $r_{\\text{int}}$ using the intervention parameters. The fractional change $\\Delta$ is then calculated using the specified formula. This dimensionless quantity provides a standardized measure of the intervention's effectiveness.\n\nThe entire procedure is implemented programmatically. A function is designed to take the set of parameters for a scenario ($s$, $\\mu$s, $M$), construct the corresponding matrix $A$, and return its dominant eigenvalue. This function is called for both the baseline and intervention configurations of each test case. The resulting rates are then used to compute $\\Delta$. The final output aggregates the values of $\\Delta$ from all test cases into a single formatted string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the computation for all test cases.\n    \"\"\"\n\n    def get_emergence_rate(s, mu_sr, mu_rs, M, H=3):\n        \"\"\"\n        Constructs the matrix A and computes its dominant eigenvalue (emergence rate).\n\n        Args:\n            s (np.ndarray): Array of selection coefficients for each host.\n            mu_sr (float): Mutation rate from susceptible to resistant.\n            mu_rs (float): Mutation rate from resistant to susceptible.\n            M (np.ndarray): Mixing matrix where M[j, i] is the rate m_ji.\n            H (int): Number of hosts.\n\n        Returns:\n            float: The dominant eigenvalue of matrix A.\n        \"\"\"\n        # Initialize the H x H matrix A\n        A = np.zeros((H, H))\n        \n        # Total mutation effect on the resistant fraction\n        mu_tot = mu_sr + mu_rs\n        \n        # Calculate column sums of M for the diagonal part of A.\n        # Since M_diag is zero, sum(M[:, i]) is equivalent to sum_{j!=i} m_ji.\n        col_sums_M = np.sum(M, axis=0)\n\n        for i in range(H):\n            # Set the diagonal elements of A\n            A[i, i] = s[i] - mu_tot - col_sums_M[i]\n            for j in range(H):\n                if i != j:\n                    # Set the off-diagonal elements of A.\n                    # A_ij = m_ji which is given as M_ji.\n                    # In 0-based numpy, A[i, j] = M[j, i].\n                    A[i, j] = M[j, i]\n\n        # Compute eigenvalues of A\n        eigenvalues = np.linalg.eigvals(A)\n        \n        # The emergence rate is the largest real part of the eigenvalues\n        r = np.max(np.real(eigenvalues))\n        \n        return r\n\n    def calculate_delta(params_base, params_int):\n        \"\"\"\n        Calculates the fractional change in emergence rate for a test case.\n\n        Args:\n            params_base (dict): Dictionary of baseline parameters.\n            params_int (dict): Dictionary of intervention parameters.\n\n        Returns:\n            float: The fractional change delta.\n        \"\"\"\n        r_base = get_emergence_rate(**params_base)\n        r_int = get_emergence_rate(**params_int)\n        \n        if np.abs(r_base) == 0:\n            # Handle the undefined case, though not expected in these tests.\n            # A large number could signify an infinite relative change.\n            return np.inf if r_base != r_int else 0.0\n\n        delta = (r_base - r_int) / np.abs(r_base)\n        return delta\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"baseline\": {\n                \"s\": np.array([0.08, -0.02, 0.00]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.02, 0.005],\n                    [0.02, 0, 0.003],\n                    [0.005, 0.003, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.01, -0.02, 0.00]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.005, 0.002],\n                    [0.005, 0, 0.003],\n                    [0.002, 0.003, 0]\n                ])\n            }\n        },\n        # Test case 2\n        {\n            \"baseline\": {\n                \"s\": np.array([0.03, -0.01, -0.01]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.zeros((3, 3))\n            },\n            \"intervention\": {\n                \"s\": np.array([0.00, -0.01, -0.01]),\n                \"mu_sr\": 1e-7, \"mu_rs\": 1e-6,\n                \"M\": np.zeros((3, 3))\n            }\n        },\n        # Test case 3\n        {\n            \"baseline\": {\n                \"s\": np.array([0.02, 0.01, 0.01]),\n                \"mu_sr\": 5e-7, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.015, 0.01],\n                    [0.015, 0, 0.012],\n                    [0.01, 0.012, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.005, 0.005, 0.005]),\n                \"mu_sr\": 5e-7, \"mu_rs\": 1e-6,\n                \"M\": 0.4 * np.array([\n                    [0, 0.015, 0.01],\n                    [0.015, 0, 0.012],\n                    [0.01, 0.012, 0]\n                ])\n            }\n        },\n        # Test case 4\n        {\n            \"baseline\": {\n                \"s\": np.array([0.08, -0.02, 0.00]),\n                \"mu_sr\": 1e-12, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.02, 0.005],\n                    [0.02, 0, 0.003],\n                    [0.005, 0.003, 0]\n                ])\n            },\n            \"intervention\": {\n                \"s\": np.array([0.01, -0.02, 0.00]),\n                \"mu_sr\": 1e-12, \"mu_rs\": 1e-6,\n                \"M\": np.array([\n                    [0, 0.005, 0.002],\n                    [0.005, 0, 0.003],\n                    [0.002, 0.003, 0]\n                ])\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case[\"baseline\"], case[\"intervention\"])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A pivotal moment in translational research is the decision to advance an intervention from preclinical animal models to human trials, a choice fraught with uncertainty and high stakes. This advanced practice introduces a formal decision-theoretic framework to navigate this challenge, integrating evidence from diverse sources within a One Health context . By combining Bayesian evidence synthesis with expected utility theory, you will derive a quantitative threshold for making a rational 'go/no-go' decision, a core skill in managing a translational research portfolio.",
            "id": "5069058",
            "problem": "A translational medicine program adopts the One Health approach to translational research by integrating evidence across two non-human species that differ in ecological proximity to humans and pathogen exposure patterns. Let the program’s prior probability of eventual human efficacy given mechanistic plausibility and preliminary in vitro data be $p_{0}$, with $0<p_{0}<1$. Two independent animal studies, indexed by $i\\in\\{1,2\\}$, each evaluate the same intervention’s efficacy against a zoonotic pathogen. For each species, define the Bayes factor for the efficacy hypothesis versus the null hypothesis (no clinically meaningful efficacy) as $BF_{i}$, where $BF_{i}<1$ indicates evidence favoring the null, and $BF_{i}>1$ indicates evidence favoring efficacy. To reflect One Health external validity and ecological similarity, each study’s evidential contribution is discounted by a weight $w_{i}\\in(0,1]$, where larger $w_{i}$ indicates greater human relevance. Assume the studies are conditionally independent given the efficacy hypothesis.\n\nThe program faces a decision to initiate combined Phase I/II human trials. Let the net societal benefit of eventual efficacy (relative to not initiating trials) be $b>0$. Let the additional net harm of failure (relative to not initiating trials) be $h\\geq 0$, and let the sunk cost of conducting the human trial be $c>0$. Assume $b>c$ so that a trial can be worthwhile if success is sufficiently probable. The expected net utility of initiating the trial is modeled as $U_{\\text{proceed}}=p_{\\text{post}}\\,b-(1-p_{\\text{post}})\\,h-c$, where $p_{\\text{post}}$ is the posterior probability of efficacy after incorporating the animal evidence, and the expected net utility of not initiating the trial is $U_{\\text{halt}}=0$.\n\nStarting only from the core definitions of Bayes theorem in odds form, the Bayes factor, and expected utility, derive a closed-form expression for the threshold Bayes factor $B^{\\star}$ such that if the weighted combined Bayes factor $BF_{1}^{w_{1}}\\,BF_{2}^{w_{2}}$ is strictly less than $B^{\\star}$, the expected net utility of proceeding is non-positive and human trials should be constrained. Express $B^{\\star}$ purely in terms of $p_{0}$, $b$, $h$, and $c$. Provide the final expression without numerical substitution. No rounding is required.",
            "solution": "The One Health approach motivates combining cross-species evidence with explicit weights to account for ecological similarity and external validity. We proceed from three foundational elements: Bayes theorem in odds form, the Bayes factor definition, and expected utility.\n\nFirst, define the prior odds of efficacy as\n$$\nO_{\\text{prior}}=\\frac{p_{0}}{1-p_{0}}.\n$$\nFor each animal study $i\\in\\{1,2\\}$, the Bayes factor $BF_{i}$ is the ratio of the marginal likelihood of the observed data under the efficacy hypothesis to that under the null hypothesis. Under conditional independence of the studies given the hypothesis, Bayes factors multiply. To discount evidence for cross-species external validity, we use a power-discounting (power prior) approach that scales log-evidence by $w_{i}$, which corresponds to raising each Bayes factor to the power $w_{i}$. The weighted combined Bayes factor is therefore\n$$\nBF_{\\text{combined}}=BF_{1}^{w_{1}}\\,BF_{2}^{w_{2}}.\n$$\nBayes theorem in odds form implies that the posterior odds are\n$$\nO_{\\text{post}}=O_{\\text{prior}}\\times BF_{\\text{combined}}.\n$$\nConverting odds back to probability gives\n$$\np_{\\text{post}}=\\frac{O_{\\text{post}}}{1+O_{\\text{post}}}=\\frac{O_{\\text{prior}}\\,BF_{\\text{combined}}}{1+O_{\\text{prior}}\\,BF_{\\text{combined}}}.\n$$\n\nSecond, consider the expected net utility of initiating human trials,\n$$\nU_{\\text{proceed}}=p_{\\text{post}}\\,b-(1-p_{\\text{post}})\\,h-c,\n$$\nand the expected net utility of halting,\n$$\nU_{\\text{halt}}=0.\n$$\nThe decision threshold is determined by the indifference condition $U_{\\text{proceed}}=U_{\\text{halt}}$, which here is $U_{\\text{proceed}}=0$. Solving $U_{\\text{proceed}}=0$ for the required posterior probability yields\n\n$$\np_{\\text{post}}\\,b-(1-p_{\\text{post}})\\,h-c=0\n$$\n$$\np_{\\text{post}}\\,(b+h)=h+c\n$$\n$$\np_{\\text{post}}=\\frac{h+c}{b+h}.\n$$\n\nDefine this probability threshold as $p_{\\text{go}}=\\frac{h+c}{b+h}$. The corresponding odds threshold is\n\n$$\nO_{\\text{go}}=\\frac{p_{\\text{go}}}{1-p_{\\text{go}}}=\\frac{\\frac{h+c}{b+h}}{1-\\frac{h+c}{b+h}}=\\frac{h+c}{b-c},\n$$\n\nwhere $b>c$ ensures $O_{\\text{go}}$ is positive and finite.\n\nThird, impose the Bayes updating relation at the decision boundary. At indifference, the posterior odds equal the odds threshold:\n\n$$\nO_{\\text{post}}=O_{\\text{go}}.\n$$\n\nUsing $O_{\\text{post}}=O_{\\text{prior}}\\,BF_{\\text{combined}}$ gives\n\n$$\nO_{\\text{prior}}\\,BF_{\\text{combined}}=O_{\\text{go}}.\n$$\n\nSolving for the combined Bayes factor at the decision boundary yields the threshold\n\n$$\nB^{\\star}=\\frac{O_{\\text{go}}}{O_{\\text{prior}}}.\n$$\n\nSubstituting the expressions for $O_{\\text{go}}$ and $O_{\\text{prior}}$,\n\n$$\nB^{\\star}=\\frac{\\frac{h+c}{b-c}}{\\frac{p_{0}}{1-p_{0}}}=\\frac{h+c}{b-c}\\times\\frac{1-p_{0}}{p_{0}}.\n$$\n\n\nThis $B^{\\star}$ is the exact evidential threshold implied by the decision-theoretic model. If the weighted combined Bayes factor $BF_{1}^{w_{1}}\\,BF_{2}^{w_{2}}$ is strictly less than $B^{\\star}$, then $O_{\\text{post}}<O_{\\text{go}}$, equivalently $p_{\\text{post}}<p_{\\text{go}}$, and the expected net utility of proceeding is non-positive; in that case, negative translational findings in animals should constrain human trials. Conversely, if $BF_{1}^{w_{1}}\\,BF_{2}^{w_{2}}$ exceeds $B^{\\star}$, proceeding yields non-negative expected net utility under the specified parameters. Notably, while the weights $w_{i}$ govern how the individual $BF_{i}$ values aggregate into $BF_{\\text{combined}}$, the threshold itself depends only on $p_{0}$, $b$, $h$, and $c$, as derived from Bayes odds and expected utility.",
            "answer": "$$\\boxed{\\frac{h+c}{b-c}\\times\\frac{1-p_{0}}{p_{0}}}$$"
        }
    ]
}