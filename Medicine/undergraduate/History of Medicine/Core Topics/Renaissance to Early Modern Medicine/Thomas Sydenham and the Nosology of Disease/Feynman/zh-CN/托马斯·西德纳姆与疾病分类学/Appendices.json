{
    "hands_on_practices": [
        {
            "introduction": "托马斯·西登汉的经验主义方法深受弗朗西斯·培根等科学革命思想家的影响。这个练习将让你扮演一位17世纪研究者的角色，设计一个严谨的实验方案来区分不同类型的热病。通过系统地改变变量并使用对照，你可以体会到经验科学的基石——控制性观察——是如何应用于医学分类的。",
            "id": "4781014",
            "problem": "Thomas Sydenham在十七世纪提出的将疾病分类为“物种”的纲领，依赖于仔细的临床观察和症状模式的区分。Francis Bacon的归纳法强调通过“存在、缺失和程度表”进行排除式归纳，即一次只改变一个环境因素，同时保持其他因素不变，以排除偶然的联系。考虑一个排除式方案，通过改变符合培根实验理想的属性，来区分Sydenham所描述的各种热病（每日热、三日热、四日热）。\n\n定义可变属性，这些属性将一次只改变一个，而所有其他环境因素则保持在固定的基线水平：\n- 周期性 $P$，水平为 $\\{1,2,3\\}$ 天（每日热、三日热、四日热）。\n- 阵发开始时有无寒战 $H$，水平为 $\\{0,1\\}$。\n- 每日温差幅度 $D$，水平为 $\\{L,M,H\\}$，视为三个不同程度。\n- 有无皮疹 $S$，水平为 $\\{0,1\\}$。\n- 地理暴露史 $G$，水平为 $\\{0,1,2\\}$，分别解释为无、本地沼泽地、曾前往流行地区。\n\n通过在所有单变量变化的观察中保持以下控制条件不变来固定基线配置：年龄类别 $A$ 为成年人，季节 $T$ 为夏季，治疗 $X$ 为不使用退烧药。在固定的配置下进行一次基线观察，并实施一次阴性对照观察（重复基线配置以检查稳定性和测量可靠性）和一次阳性对照观察（在相同控制条件下观察一个先前确诊的三日周期热病例，以验证该方案记录三日热模式的能力）。\n\n为遵循Bacon的要求，即填充“存在、缺失和程度表”并消除偶然的巧合，要求对每个可变属性的每一个非基线水平进行 $r=2$ 次独立重复观察，而在每次单变量变化的观察中，所有其他属性均保持在其基线水平。\n\n在这些约束和理想条件下，推导出一个表达式，用于计算完成该方案排除式归纳第一遍所需的最少受控观察总数 $N$，并计算其值。将最终数字表示为整数。无需四舍五入。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 第1步：提取已知条件\n- **目标：** 使用基于培根归纳法的排除式方案来区分各种热病（每日热、三日热、四日热）。\n- **可变属性及其水平：**\n    - 周期性 $P$：$\\{1, 2, 3\\}$ 天。水平数 $L_P = 3$。\n    - 有无寒战 $H$：$\\{0, 1\\}$。水平数 $L_H = 2$。\n    - 每日温差幅度 $D$：$\\{L, M, H\\}$。水平数 $L_D = 3$。\n    - 有无皮疹 $S$：$\\{0, 1\\}$。水平数 $L_S = 2$。\n    - 地理暴露史 $G$：$\\{0, 1, 2\\}$。水平数 $L_G = 3$。\n- **固定控制条件：**\n    - 年龄类别 $A$：成年人。\n    - 季节 $T$：夏季。\n    - 治疗 $X$：不使用退烧药。\n- **基线和对照观察：**\n    - 在固定基线配置下进行一次基线观察。\n    - 一次阴性对照观察（重复基线）。\n    - 一次阳性对照观察（一个确诊的三日周期热病例）。\n- **重复规则：**\n    - 对每个可变属性的每一个非基线水平进行 $r=2$ 次独立重复观察。\n    - 在每次变化期间，所有其他属性均保持在其基线水平。\n- **任务：** 推导最少受控观察总数 $N$ 的表达式并计算其值。\n\n### 第2步：使用提取的已知条件进行验证\n该问题要求计算一个植根于历史科学方法的特定实验设计所需的观察总数。\n- **科学依据：** 该问题植根于医学史和科学方法（Sydenham, Bacon）。实验设计原则（对照、一次只改变一个因素、重复）是现代科学的基础。该问题是将这些原则形式化为一个组合计算，并未违反它们。在其背景下，它是科学合理的。\n- **适定性：** 该问题为构建实验计划提供了一套清晰的规则和数值。计算所需的所有参数都已明确（变量数量、每个变量的水平数、重复次数以及特定对照观察的次数）。尽管每个可变属性的具体基线水平未定义（例如，$H$ 的基线是 $0$ 还是 $1$），但这不影响总数。对于一个有 $k$ 个水平的属性，*非基线*水平的数量总是 $k-1$，无论哪个水平被指定为基线。因此，该问题没有规定不足，并能导出一个唯一的解。\n- **客观性：** 问题的表述客观、精确。所有约束条件都是定量的或明确分类的。\n- **结论：** 该问题是自洽、一致且适定的。它没有表现出验证标准中列出的任何缺陷。\n\n### 第3步：结论与行动\n问题有效。将推导解答。\n\n### 解答推导\n观察总数 $N$ 是固定对照观察和实验变化观察的总和。\n设 $N_{fixed}$ 为基线和对照观察的次数。\n设 $N_{exp}$ 为实验变化的观察次数。\n观察总数由以下表达式给出：\n$$N = N_{fixed} + N_{exp}$$\n\n首先，我们计算 $N_{fixed}$。问题明确要求：\n1.  一次基线观察：$N_{baseline} = 1$。\n2.  一次阴性对照观察：$N_{neg\\_control} = 1$。\n3.  一次阳性对照观察：$N_{pos\\_control} = 1$。\n\n将这些相加得到固定观察的总次数：\n$$N_{fixed} = N_{baseline} + N_{neg\\_control} + N_{pos\\_control} = 1 + 1 + 1 = 3$$\n\n接下来，我们计算 $N_{exp}$。实验设计要求每次只改变一个属性，使其偏离基线水平，而所有其他属性则保持在其基线配置。对于每个属性的每个非基线水平，需要进行 $r=2$ 次重复观察。\n\n设可变属性集合为 $\\mathcal{V} = \\{P, H, D, S, G\\}$。对于每个属性 $V_i \\in \\mathcal{V}$，设 $L_i$ 为其水平数。属性 $V_i$ 的非基线水平数为 $L_i - 1$。独特的实验条件（变化）总数是所有属性的非基线水平数之和。\n\n每个属性的非基线水平数为：\n- 周期性 $P$：$L_P - 1 = 3 - 1 = 2$。\n- 寒战 $H$：$L_H - 1 = 2 - 1 = 1$。\n- 温差幅度 $D$：$L_D - 1 = 3 - 1 = 2$。\n- 皮疹 $S$：$L_S - 1 = 2 - 1 = 1$。\n- 地理暴露史 $G$：$L_G - 1 = 3 - 1 = 2$。\n\n待测试的独特实验设置总数 $N_{settings}$ 是这些值的总和：\n$$N_{settings} = (L_P-1) + (L_H-1) + (L_D-1) + (L_S-1) + (L_G-1)$$\n$$N_{settings} = 2 + 1 + 2 + 1 + 2 = 8$$\n\n问题陈述要求对每个非基线设置进行 $r=2$ 次独立重复观察。因此，实验观察总次数 $N_{exp}$ 为：\n$$N_{exp} = r \\times N_{settings} = 2 \\times 8 = 16$$\n\n观察总数 $N$ 的通用表达式为：\n$$N = (N_{baseline} + N_{neg\\_control} + N_{pos\\_control}) + r \\sum_{i \\in \\mathcal{V}} (L_i - 1)$$\n\n最后，我们通过将 $N_{fixed}$ 和 $N_{exp}$ 相加来计算观察总数 $N$：\n$$N = N_{fixed} + N_{exp} = 3 + 16 = 19$$\n\n完成此排除式归纳方案第一遍所需的最少受控观察总数为 $19$。",
            "answer": "$$\\boxed{19}$$"
        },
        {
            "introduction": "收集数据后，下一步便是根据观察到的现象建立分类规则。本练习将西登汉关于“症状组合”的核心思想转化为一个具体的诊断决策规则。通过这个基于麻疹和猩红热历史记载体征的假设场景，你将学习如何结合多个线索来区分疾病，并使用现代流行病学中的“敏感性”$（\\mathrm{Se}）$和“特异性”$（\\mathrm{Sp}）$概念来评估该规则的有效性。",
            "id": "4781071",
            "problem": "Thomas Sydenham 的疾病分类学方法强调根据疾病的特征性体征组合进行分类，而非根据推测的病因。考虑两种在十七世纪临床描述中居于核心地位的发疹性疾病：麻疹和猩红热。定义四个反映历史上证实的体征模式的二元特征：\n- 特征 $F_{1}$：柯氏斑 (Koplik spots) 存在 ($1$) vs. 不存在 ($0$)。\n- 特征 $F_{2}$：沙纸样皮疹质地存在 ($1$) vs. 不存在 ($0$)。\n- 特征 $F_{3}$：草莓舌存在 ($1$) vs. 不存在 ($0$)。\n- 特征 $F_{4}$：卡他性鼻炎 (Coryza) 和畏光 (photophobia) 存在 ($1$) vs. 不存在 ($0$)。\n\n假设在给定基础疾病的情况下，特征 $F_{1}, F_{2}, F_{3}, F_{4}$ 条件独立，并使用以下经验上合理的条件概率：\n- 给定麻疹 ($M$)：$\\mathbb{P}(F_{1}=1 \\mid M)=\\frac{4}{5}$，$\\mathbb{P}(F_{2}=1 \\mid M)=\\frac{1}{5}$，$\\mathbb{P}(F_{3}=1 \\mid M)=\\frac{1}{10}$，$\\mathbb{P}(F_{4}=1 \\mid M)=\\frac{3}{4}$。\n- 给定猩红热 ($S$)：$\\mathbb{P}(F_{1}=1 \\mid S)=\\frac{1}{10}$，$\\mathbb{P}(F_{2}=1 \\mid S)=\\frac{4}{5}$，$\\mathbb{P}(F_{3}=1 \\mid S)=\\frac{2}{3}$，$\\mathbb{P}(F_{4}=1 \\mid S)=\\frac{1}{3}$。\n\n设计一个反映 Sydenham 对独特性体征强调的分类规则：如果柯氏斑存在，则预测为麻疹；或者，如果柯氏斑不存在，但卡他性鼻炎-畏光复合症状存在，同时沙纸样皮疹和草莓舌不存在，也预测为麻疹。具体来说，定义规则 $R$ 如下：\n- 如果 $F_{1}=1$，或者如果 $F_{1}=0$ 且 $F_{4}=1$ 且 $F_{2}=0$ 且 $F_{3}=0$，则预测为麻疹。\n- 否则，预测为猩红热。\n\n仅从二元分类器的灵敏度和特异度的形式化定义出发，\n- 麻疹的灵敏度：$\\mathrm{Se}=\\mathbb{P}(\\text{预测为麻疹} \\mid M)$。\n- 麻疹的特异度：$\\mathrm{Sp}=\\mathbb{P}(\\text{预测为非麻疹} \\mid S)$，\n在条件独立性假设和上述概率下，推导规则 $R$ 的 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$。\n\n为联系流行病学背景，考虑两种假设的流行病学情景，其麻疹患病率分别为 $\\pi_{1}=\\frac{3}{10}$ 和 $\\pi_{2}=\\frac{7}{10}$。计算每种情景下的 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$，并根据定义指出其与患病率的任何依赖性或独立性。\n\n将您的最终答案以精确分数的形式表示为一个单行矩阵，顺序为 $\\left(\\mathrm{Se}, \\mathrm{Sp}\\right)$。无需四舍五入，也无需单位。",
            "solution": "题目陈述经过严格审查，被认定是有效的。它在概率分类框架内具有科学依据，定义和数据齐全，问题提法得当，且表述客观。该问题是一个将概率论应用于简化医学诊断模型的形式化练习，未违反任何基本原则，也不含任何歧义。\n\n我们的任务是推导给定分类规则 $R$ 的灵敏度 ($\\mathrm{Se}$) 和特异度 ($\\mathrm{Sp}$)。该规则旨在根据四个二元特征 $F_{1}$、$F_{2}$、$F_{3}$ 和 $F_{4}$ 来区分麻疹 ($M$) 和猩红热 ($S$)。\n\n分类规则 $R$ 定义如下：\n如果 ($F_{1}=1$)，或者如果 ($F_{1}=0$ 且 $F_{4}=1$ 且 $F_{2}=0$ 且 $F_{3}=0$)，则预测为麻疹。否则，预测为猩红热。\n\n设预测为麻疹的事件表示为 $R_{M}$。该事件可以表示为两个互斥（不相交）事件的并集：\n$E_{1}$：事件 $F_{1}=1$。\n$E_{2}$：事件 $F_{1}=0 \\cap F_{2}=0 \\cap F_{3}=0 \\cap F_{4}=1$。\n由于 $E_{1}$ 和 $E_{2}$ 是不相交的（因为 $F_{1}$ 不能同时为 $1$ 和 $0$），它们的并集的概率是它们各自概率的和。\n$R_{M} = E_{1} \\cup E_{2}$。\n\n首先，我们推导麻疹的灵敏度 $\\mathrm{Se}$。根据定义，这是在患者患有麻疹的情况下正确预测为麻疹的概率：\n$$ \\mathrm{Se} = \\mathbb{P}(\\text{预测为麻疹} \\mid M) = \\mathbb{P}(R_{M} \\mid M) $$\n利用 $E_{1}$ 和 $E_{2}$ 的不相交性：\n$$ \\mathrm{Se} = \\mathbb{P}(E_{1} \\mid M) + \\mathbb{P}(E_{2} \\mid M) = \\mathbb{P}(F_{1}=1 \\mid M) + \\mathbb{P}(F_{1}=0, F_{2}=0, F_{3}=0, F_{4}=1 \\mid M) $$\n题目陈述在给定疾病的情况下，特征是条件独立的。因此，第二项可以展开为各个条件概率的乘积：\n$$ \\mathrm{Se} = \\mathbb{P}(F_{1}=1 \\mid M) + \\left[ \\mathbb{P}(F_{1}=0 \\mid M) \\cdot \\mathbb{P}(F_{2}=0 \\mid M) \\cdot \\mathbb{P}(F_{3}=0 \\mid M) \\cdot \\mathbb{P}(F_{4}=1 \\mid M) \\right] $$\n给定的是麻疹条件下各特征存在 ($F_{i}=1$) 的概率。我们推导出各特征不存在 ($F_{i}=0$) 的概率为 $1 - \\mathbb{P}(F_{i}=1 \\mid M)$：\n- $\\mathbb{P}(F_{1}=1 \\mid M) = \\frac{4}{5} \\implies \\mathbb{P}(F_{1}=0 \\mid M) = 1 - \\frac{4}{5} = \\frac{1}{5}$\n- $\\mathbb{P}(F_{2}=1 \\mid M) = \\frac{1}{5} \\implies \\mathbb{P}(F_{2}=0 \\mid M) = 1 - \\frac{1}{5} = \\frac{4}{5}$\n- $\\mathbb{P}(F_{3}=1 \\mid M) = \\frac{1}{10} \\implies \\mathbb{P}(F_{3}=0 \\mid M) = 1 - \\frac{1}{10} = \\frac{9}{10}$\n- $\\mathbb{P}(F_{4}=1 \\mid M) = \\frac{3}{4}$\n\n将这些值代入 $\\mathrm{Se}$ 的表达式中：\n$$ \\mathrm{Se} = \\frac{4}{5} + \\left[ \\left(\\frac{1}{5}\\right) \\cdot \\left(\\frac{4}{5}\\right) \\cdot \\left(\\frac{9}{10}\\right) \\cdot \\left(\\frac{3}{4}\\right) \\right] $$\n$$ \\mathrm{Se} = \\frac{4}{5} + \\frac{1 \\cdot 4 \\cdot 9 \\cdot 3}{5 \\cdot 5 \\cdot 10 \\cdot 4} = \\frac{4}{5} + \\frac{108}{1000} = \\frac{4}{5} + \\frac{27}{250} $$\n为了对分数求和，我们找到一个公分母，即 $250$：\n$$ \\mathrm{Se} = \\frac{4 \\cdot 50}{5 \\cdot 50} + \\frac{27}{250} = \\frac{200}{250} + \\frac{27}{250} = \\frac{227}{250} $$\n\n接下来，我们推导麻疹的特异度 $\\mathrm{Sp}$。根据定义，这是在患者患有猩红热的情况下正确预测为“非麻疹”（即预测为猩红热）的概率：\n$$ \\mathrm{Sp} = \\mathbb{P}(\\text{预测为非麻疹} \\mid S) $$\n这是在给定猩红热的情况下预测为麻疹的补事件：\n$$ \\mathrm{Sp} = 1 - \\mathbb{P}(\\text{预测为麻疹} \\mid S) = 1 - \\mathbb{P}(R_{M} \\mid S) $$\n与之前一样，我们使用不相交事件 $E_{1}$ 和 $E_{2}$ 来计算 $\\mathbb{P}(R_{M} \\mid S)$：\n$$ \\mathbb{P}(R_{M} \\mid S) = \\mathbb{P}(E_{1} \\mid S) + \\mathbb{P}(E_{2} \\mid S) = \\mathbb{P}(F_{1}=1 \\mid S) + \\mathbb{P}(F_{1}=0, F_{2}=0, F_{3}=0, F_{4}=1 \\mid S) $$\n利用给定猩红热的条件独立性：\n$$ \\mathbb{P}(R_{M} \\mid S) = \\mathbb{P}(F_{1}=1 \\mid S) + \\left[ \\mathbb{P}(F_{1}=0 \\mid S) \\cdot \\mathbb{P}(F_{2}=0 \\mid S) \\cdot \\mathbb{P}(F_{3}=0 \\mid S) \\cdot \\mathbb{P}(F_{4}=1 \\mid S) \\right] $$\n我们使用给定的猩红热概率并推导其补概率：\n- $\\mathbb{P}(F_{1}=1 \\mid S) = \\frac{1}{10} \\implies \\mathbb{P}(F_{1}=0 \\mid S) = 1 - \\frac{1}{10} = \\frac{9}{10}$\n- $\\mathbb{P}(F_{2}=1 \\mid S) = \\frac{4}{5} \\implies \\mathbb{P}(F_{2}=0 \\mid S) = 1 - \\frac{4}{5} = \\frac{1}{5}$\n- $\\mathbb{P}(F_{3}=1 \\mid S) = \\frac{2}{3} \\implies \\mathbb{P}(F_{3}=0 \\mid S) = 1 - \\frac{2}{3} = \\frac{1}{3}$\n- $\\mathbb{P}(F_{4}=1 \\mid S) = \\frac{1}{3}$\n\n代入这些值：\n$$ \\mathbb{P}(R_{M} \\mid S) = \\frac{1}{10} + \\left[ \\left(\\frac{9}{10}\\right) \\cdot \\left(\\frac{1}{5}\\right) \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) \\right] $$\n$$ \\mathbb{P}(R_{M} \\mid S) = \\frac{1}{10} + \\frac{9}{10 \\cdot 5 \\cdot 3 \\cdot 3} = \\frac{1}{10} + \\frac{9}{450} = \\frac{1}{10} + \\frac{1}{50} $$\n找到公分母 $50$：\n$$ \\mathbb{P}(R_{M} \\mid S) = \\frac{5}{50} + \\frac{1}{50} = \\frac{6}{50} = \\frac{3}{25} $$\n这代表了假阳性率（将 $S$ 分类为 $M$）。特异度为：\n$$ \\mathrm{Sp} = 1 - \\mathbb{P}(R_{M} \\mid S) = 1 - \\frac{3}{25} = \\frac{22}{25} $$\n\n最后，题目要求考虑两种麻疹患病率分别为 $\\pi_{1}=\\frac{3}{10}$ 和 $\\pi_{2}=\\frac{7}{10}$ 的流行病学情景。灵敏度和特异度的定义是：\n$$ \\mathrm{Se}=\\mathbb{P}(\\text{预测为麻疹} \\mid M) \\quad \\text{和} \\quad \\mathrm{Sp}=\\mathbb{P}(\\text{预测为非麻疹} \\mid S) $$\n这些是条件概率，以真实疾病状态为条件。它们是分类规则 $R$ 及其在已知疾病人群上表现的内在属性。它们不依赖于疾病在总人口中的患病率，即先验概率 $\\mathbb{P}(M) = \\pi$。因此，$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的值独立于患病率。计算出的值对两种情景都成立。\n在患病率为 $\\pi_{1}=\\frac{3}{10}$ 的情景下：\n$$ \\mathrm{Se} = \\frac{227}{250}, \\quad \\mathrm{Sp} = \\frac{22}{25} $$\n在患病率为 $\\pi_{2}=\\frac{7}{10}$ 的情景下：\n$$ \\mathrm{Se} = \\frac{227}{250}, \\quad \\mathrm{Sp} = \\frac{22}{25} $$\n结果完全相同，证实了它们与疾病患病率无关。\n\n最终答案是数对 $(\\mathrm{Se}, \\mathrm{Sp})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{227}{250}  \\frac{22}{25}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后一个练习将疾病分类的概念提升到了一个更高级的层面。它展示了如何将一个关键的诊断特征——热病的周期性——进行数学建模，从而创建一个最优的分类算法。通过计算错分率，我们可以量化诊断过程中固有的不确定性，这个概念不仅是现代循证医学的核心，其思想根源亦可追溯至西登汉等人的经验主义方法。",
            "id": "4781025",
            "problem": "Thomas Sydenham 的疾病分类学强调通过阵发性发作的周期性来区分不同“种类”的发热。假设我们将这一历史见解形式化为一个分类问题，在该问题中，观察者为一名疑似患有每日热、间日热或三日热这三种发热之一的患者，记录下单个发作间期 $t$（以小时为单位）。假设存在以下科学上合理且与历史实践相符的测量模型和先验背景：由于生物学变异和观测不确定性，这三种发热的发作间期被建模为来自以其特征周期性为中心的正态分布的独立抽样，即，特定种类的真实均值分别为 $24$ 小时（每日热）、$48$ 小时（间日热）和 $72$ 小时（三日热），并且任何种类的测量间期 $t$ 都受到标准差为 $8$ 小时的加性噪声的影响。假设在所研究的人群中，这些发热种类的先验概率是相等的。\n\n从贝叶斯定理和正态分布的概率密度函数的核心定义出发，推导一个决策算法，该算法在给定单个观测值 $t$ 的情况下，将病例归类到一种发热。然后，使用该算法，在上述模型下，计算预期的错分率（即所分配的种类不是真实种类的概率），该错分率是针对三种具有相等先验概率的发热进行平均的。\n\n将最终的错分率表示为保留四位有效数字的小数。最终答案不需要单位，因为它是一个概率值。",
            "solution": "本题要求推导一个决策算法，该算法根据单个发作间期测量值 $t$ 来对发热种类进行分类，并随后计算该算法的预期错分率。三种发热分别为每日热（$Q$）、间日热（$T$）和三日热（$R$）。\n\n给定信息如下：\n各发热种类的先验概率相等：$P(Q) = P(T) = P(R) = \\frac{1}{3}$。\n每种发热的发作间期 $t$ 均由正态分布 $p(t|S) \\sim N(\\mu_S, \\sigma^2)$ 建模，其中 $S \\in \\{Q, T, R\\}$。\n均值分别为 $\\mu_Q = 24$、$\\mu_T = 48$ 和 $\\mu_R = 72$ 小时。\n标准差对所有种类都相同：$\\sigma = 8$ 小时。\n\n**第1部分：决策算法的推导**\n\n使错分概率最小化的最优决策算法是最大后验 (MAP) 估计。该规则将观测值 $t$ 分配给在给定该观测值时具有最高后验概率的种类 $S^*$。根据贝叶斯定理，后验概率为：\n$$ P(S|t) = \\frac{p(t|S) P(S)}{p(t)} $$\n其中 $p(t|S)$ 是在给定种类 $S$ 的情况下观测到 $t$ 的似然，$P(S)$ 是种类 $S$ 的先验概率，而 $p(t) = \\sum_{S' \\in \\{Q,T,R\\}} p(t|S') P(S')$ 是证据，对于给定的 $t$ 来说，它是一个归一化常数。\n\n因此，决策规则为：\n$$ S^* = \\arg\\max_{S \\in \\{Q, T, R\\}} P(S|t) = \\arg\\max_{S \\in \\{Q, T, R\\}} \\frac{p(t|S) P(S)}{p(t)} $$\n由于 $p(t)$ 是正的且与种类 $S$ 无关，最大化后验概率等价于最大化分子 $p(t|S) P(S)$。\n$$ S^* = \\arg\\max_{S \\in \\{Q, T, R\\}} p(t|S) P(S) $$\n题目说明先验概率相等，$P(Q) = P(T) = P(R) = \\frac{1}{3}$。因此，最大化 $p(t|S) P(S)$ 等价于最大化似然函数 $p(t|S)$。这被称为最大似然 (ML) 决策规则。\n$$ S^* = \\arg\\max_{S \\in \\{Q, T, R\\}} p(t|S) $$\n给定种类 $S$ 的似然函数是正态分布的概率密度函数 (PDF)：\n$$ p(t|S) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t-\\mu_S)^2}{2\\sigma^2}\\right) $$\n为了最大化 $p(t|S)$，我们可以转而最大化其自然对数 $\\ln(p(t|S))$，因为对数函数是严格递增的。\n$$ \\ln(p(t|S)) = \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right) - \\frac{(t-\\mu_S)^2}{2\\sigma^2} $$\n项 $\\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right)$ 相对于种类 $S$ 是一个常数。因此，最大化 $\\ln(p(t|S))$ 等价于最大化 $-\\frac{(t-\\mu_S)^2}{2\\sigma^2}$。由于 $\\sigma^2$ 是一个正常数，这又等价于最小化项 $(t-\\mu_S)^2$。最后，最小化 $(t-\\mu_S)^2$ 等价于最小化绝对距离 $|t-\\mu_S|$。\n\n因此，决策算法是将观测值 $t$ 归类到其特征均值 $\\mu_S$ 最接近 $t$ 的那个种类。这是一个基于均值的最近邻分类规则。\n\n为实现此算法，我们需求解决策边界，即相邻均值之间的中点。\n每日热（$Q$）和间日热（$T$）之间的边界是：\n$$ t_{QT} = \\frac{\\mu_Q + \\mu_T}{2} = \\frac{24 + 48}{2} = 36 $$\n间日热（$T$）和三日热（$R$）之间的边界是：\n$$ t_{TR} = \\frac{\\mu_T + \\mu_R}{2} = \\frac{48 + 72}{2} = 60 $$\n\n决策算法如下：\n1. 如果 $t  36$，将种类判定为每日热（$Q$）。\n2. 如果 $36 \\le t  60$，将种类判定为间日热（$T$）。\n3. 如果 $t \\ge 60$，将种类判定为三日热（$R$）。\n\n**第2部分：预期错分率的计算**\n\n预期错分率 $P(\\text{error})$ 是作出错误分类的总概率，在所有可能的真实种类上取平均。它由全概率公式给出：\n$$ P(\\text{error}) = P(\\text{error}|Q)P(Q) + P(\\text{error}|T)P(T) + P(\\text{error}|R)P(R) $$\n鉴于先验概率相等，$P(Q) = P(T) = P(R) = \\frac{1}{3}$：\n$$ P(\\text{error}) = \\frac{1}{3} \\left( P(\\text{error}|Q) + P(\\text{error}|T) + P(\\text{error}|R) \\right) $$\n我们现在计算每个条件错误概率。令 $\\Phi(z)$ 为标准正态分布 $N(0, 1)$ 的累积分布函数 (CDF)。\n\n1.  **每日热的错分 ($P(\\text{error}|Q)$)**：\n    一个真实的每日热病例（服从 $N(\\mu_Q=24, \\sigma^2=8^2)$ 分布）在观测值 $t$ 被分类为 $T$ 或 $R$ 时被错分，这发生在 $t \\ge 36$ 时。\n    $$ P(\\text{error}|Q) = P(t \\ge 36 | S=Q) $$\n    我们通过定义 $Z = \\frac{t - \\mu_Q}{\\sigma}$ 来标准化变量 $t$。阈值 $t=36$ 对应于：\n    $$ z = \\frac{36 - 24}{8} = \\frac{12}{8} = 1.5 $$\n    因此，$P(\\text{error}|Q) = P(Z \\ge 1.5) = 1 - P(Z  1.5) = 1 - \\Phi(1.5)$。\n\n2.  **三日热的错分 ($P(\\text{error}|R)$)**：\n    一个真实的三日热病例（服从 $N(\\mu_R=72, \\sigma^2=8^2)$ 分布）在 $t$ 被分类为 $Q$ 或 $T$ 时被错分，这发生在 $t  60$ 时。\n    $$ P(\\text{error}|R) = P(t  60 | S=R) $$\n    我们用 $Z = \\frac{t - \\mu_R}{\\sigma}$ 标准化变量 $t$。阈值 $t=60$ 对应于：\n    $$ z = \\frac{60 - 72}{8} = \\frac{-12}{8} = -1.5 $$\n    因此，$P(\\text{error}|R) = P(Z  -1.5) = \\Phi(-1.5)$。由于正态分布的对称性，$\\Phi(-z) = 1 - \\Phi(z)$，所以 $P(\\text{error}|R) = 1 - \\Phi(1.5)$。\n\n3.  **间日热的错分 ($P(\\text{error}|T)$)**：\n    一个真实的间日热病例（服从 $N(\\mu_T=48, \\sigma^2=8^2)$ 分布）在 $t$ 被分类为 $Q$ 或 $R$ 时被错分，这发生在 $t  36$ 或 $t \\ge 60$ 时。\n    $$ P(\\text{error}|T) = P(t  36 | S=T) + P(t \\ge 60 | S=T) $$\n    我们用 $Z = \\frac{t - \\mu_T}{\\sigma}$ 标准化 $t$。阈值 $t=36$ 和 $t=60$ 对应于：\n    $$ z_1 = \\frac{36 - 48}{8} = \\frac{-12}{8} = -1.5 $$\n    $$ z_2 = \\frac{60 - 48}{8} = \\frac{12}{8} = 1.5 $$\n    因此，$P(\\text{error}|T) = P(Z  -1.5) + P(Z \\ge 1.5) = \\Phi(-1.5) + (1 - \\Phi(1.5))$。\n    利用对称性，$\\Phi(-1.5) = 1 - \\Phi(1.5)$，因此：\n    $$ P(\\text{error}|T) = (1 - \\Phi(1.5)) + (1 - \\Phi(1.5)) = 2(1 - \\Phi(1.5)) $$\n\n现在我们将这些结果结合起来，求出总的预期错分率：\n$$ P(\\text{error}) = \\frac{1}{3} \\left[ (1 - \\Phi(1.5)) + 2(1 - \\Phi(1.5)) + (1 - \\Phi(1.5)) \\right] $$\n$$ P(\\text{error}) = \\frac{1}{3} \\left[ 4(1 - \\Phi(1.5)) \\right] = \\frac{4}{3} (1 - \\Phi(1.5)) $$\n使用标准正态分布表或计算器，CDF 在 $z=1.5$ 处的值为 $\\Phi(1.5) \\approx 0.9331928$。\n$$ 1 - \\Phi(1.5) \\approx 1 - 0.9331928 = 0.0668072 $$\n将此值代入我们的错误率表达式中：\n$$ P(\\text{error}) \\approx \\frac{4}{3} \\times 0.0668072 \\approx 0.089076268 $$\n将结果四舍五入到四位有效数字，得到 $0.08908$。",
            "answer": "$$\\boxed{0.08908}$$"
        }
    ]
}