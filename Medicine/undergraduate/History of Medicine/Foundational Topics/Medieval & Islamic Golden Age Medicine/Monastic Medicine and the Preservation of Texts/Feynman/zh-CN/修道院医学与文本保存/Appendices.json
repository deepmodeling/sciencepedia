{
    "hands_on_practices": [
        {
            "introduction": "修道院的抄写室是中世纪知识生产的核心。为了具体理解其运作，我们可以将其视为一个“生产中心”，并用量化方法进行分析。本练习将引导你运用基本的速率计算和概率模型，来估算一个假设的抄写室在特定时期内的手稿产出量以及预期的抄写错误数量。通过这种方式，我们将抽象的文本保存概念，转化为具体、可量化的管理挑战。",
            "id": "4756737",
            "problem": "在十二世纪，一家本笃会修道院经营着一间缮写室，用以保存和传播医学论著，其中包括署名为Galen的作品以及修道院医务室使用的评注。该缮写室雇佣了$8$名抄写员和$2$名校对员。每名抄写员以每个工作日$2$对开页的稳定速率进行抄写。所考虑的月份有$30$个日历日，但团体有$4$个星期日和$2$个主要节日不进行抄写或校对工作，因此剩下$24$个工作日。历史文献的旁注表明，抄写错误是独立发生的，且为了规划目的，可以将其建模为强度$\\lambda = 0.5$ 错误/对开页的泊松过程；因此，每对开页的期望错误数为$0.5$。假设校对员发现的每一个错误都必须得到处理，并且校对能力在本月内不会限制抄写产出。\n\n以速率（单位时间的产出）的定义、独立工作者产出的可加性、泊松分布计数的期望值定义，以及独立同分布项的期望线性性质为基本原理，从第一性原理推导出月度对开页吞吐量和当月所需校对的期望次数。将您的最终答案表示为一个包含两个条目$\\big(\\text{folios per month} \\; \\text{corrections per month}\\big)$的行矩阵。无需四舍五入；请给出精确的整数值。在您的最终方框答案中不要包含单位；将条目解释为每月的计数值。",
            "solution": "我们从生产率的定义开始。如果每位抄写员每个工作日生产$r$对开页，并且有$n_{s}$位抄写员可以并行工作而不互相干扰，那么每日总产出为\n$$\nR_{\\text{day}} = n_{s} \\times r.\n$$\n此处，$n_{s} = 8$，$r = 2$ 对开页/天。因此，\n$$\nR_{\\text{day}} = 8 \\times 2 = 16 \\text{ folios per day.}\n$$\n一个时期的产量取决于工作天数。令$D$表示该月的工作天数。题目指明该月为$30$天，有$4$个星期日和$2$个节日不工作，所以\n$$\nD = 30 - 4 - 2 = 24 \\text{ days.}\n$$\n因此，以对开页计的月度吞吐量（记为$N$）由日生产率和工作天数的乘积给出：\n$$\nN = R_{\\text{day}} \\times D = 16 \\times 24 = 384 \\text{ folios per month.}\n$$\n\n接下来，我们计算期望的校对次数。题目指出，抄写错误独立发生，可以建模为强度$\\lambda = 0.5$ 错误/对开页的泊松过程。对于一个参数为$\\lambda$的泊松分布随机变量，其期望值为$\\lambda$。因此，单个对开页的期望错误数为\n$$\n\\mathbb{E}[\\text{errors per folio}] = \\lambda = 0.5.\n$$\n令$X_{i}$为第$i$个对开页上的随机错误数，其中$i = 1,2,\\dots,N$，且$N = 384$。根据该模型，$X_{i}$是独立同分布的，且$\\mathbb{E}[X_{i}] = 0.5$。该月的总错误数为\n$$\nT = \\sum_{i=1}^{N} X_{i}.\n$$\n根据期望的线性性质，\n$$\n\\mathbb{E}[T] = \\sum_{i=1}^{N} \\mathbb{E}[X_{i}] = \\sum_{i=1}^{N} 0.5 = 0.5 \\times N = 0.5 \\times 384 = 192.\n$$\n这个$\\mathbb{E}[T]$就是当月所需校对的期望次数，因为每个错误都必须得到处理。\n\n因此，月度对开页吞吐量为$384$，期望的校对次数为$192$。按照要求，最终答案应表示为一个行矩阵，其条目为$\\big(\\text{folios per month} \\; \\text{corrections per month}\\big)$。",
            "answer": "$$\\boxed{\\begin{pmatrix}384  192\\end{pmatrix}}$$"
        },
        {
            "introduction": "抄写错误不仅是文本上的瑕疵，在医学文献中，它们可能带来致命的后果。本练习建立在前一个练习的基础上，探讨了抄写错误在现实世界中的影响。我们将分析一个情景：一个剂量单位的缩写被误读，可能导致用药过量。通过应用一个标准的剂量-反应模型，我们将文本的模糊性与病人安全直接联系起来，从而突显在保存医学文本时，准确性是何等至关重要。",
            "id": "4756723",
            "problem": "在十二世纪的本笃会医务室，医生们依赖抄录的草药志，其剂量说明常使用药剂师缩写。一斯克鲁普的常用缩写是斯克鲁普符号，它以连字形式书写，在保存不善或匆忙展开时可能被误认为盎司符号。假设一个处方原意是开具一斯克鲁普的镇静草药，最初写为单个斯克鲁普符号。由于保存文本中缩写展开的模糊性，抄写员可能会误读预定剂量。\n\n使用以下有历史依据的药剂单位换算：一打兰等于三斯克鲁普，一盎司等于八打兰。因此，一盎司等于二十四斯克鲁普。假设预定剂量为一斯克鲁普，但在最坏的误读情况下，施用剂量变为一盎司。\n\n假设服用该草药导致严重不良后果的概率随剂量增加，其关系遵循一个基于泊松风险的标准剂量-反应模型，$$P(d) = 1 - \\exp(-\\lambda d),$$ 其中 $d$ 是以斯克鲁普为单位的剂量，$\\lambda$ 是每斯克鲁普的风险率。该医务室的指南为每次给药发生严重不良后果的期望概率设定了一个可接受的阈值 $T$。如果抄写员以概率 $p$ 误读，则严重不良后果的期望概率由应用于两种可能施用剂量的全期望定律给出。\n\n已知：\n- 预定剂量 $d_{0} = 1$ 斯克鲁普，\n- 最坏误读剂量 $d_{w} = 24$ 斯克鲁普，\n- 风险率 $\\lambda = 3.0 \\times 10^{-3}$ 每斯克鲁普，\n- 阈值 $T = 1.0 \\times 10^{-2}$，\n\n确定最大误读概率 $p_{\\max}$，使得严重不良后果的期望概率不超过阈值 $T$。请将您的答案表示为小数，并四舍五入到三位有效数字。",
            "solution": "该问题要求我们找到最大的误读概率 $p_{\\max}$，使得严重不良后果的期望概率不超过给定的阈值 $T$。\n\n令 $E$ 为发生严重不良后果的事件。对于施用的剂量，有两种可能的情景：\n1.  剂量被正确读取（无误读），其概率为 $1-p$。在这种情况下，施用的剂量是预定剂量 $d_{0} = 1$ 斯克鲁普。\n2.  剂量被误读，其概率为 $p$。在这种情况下，施用的剂量是最坏情况下的剂量 $d_{w} = 24$ 斯克鲁普。\n\n发生严重不良后果的概率由函数 $P(d) = 1 - \\exp(-\\lambda d)$ 给出。事件 $E$ 在给定剂量下的条件概率为：\n-   给定剂量 $d_{0}$ 时发生后果 $E$ 的概率：$P(E|d=d_{0}) = 1 - \\exp(-\\lambda d_{0})$。\n-   给定剂量 $d_{w}$ 时发生后果 $E$ 的概率：$P(E|d=d_{w}) = 1 - \\exp(-\\lambda d_{w})$。\n\n根据全概率定律，严重不良后果的期望概率（我们记为 $P_{exp}$）是每种情景下后果概率的加权平均，权重为这些情景发生的概率：\n$$P_{exp} = P(E|d=d_{0}) \\cdot P(\\text{正确读取}) + P(E|d=d_{w}) \\cdot P(\\text{误读})$$\n$$P_{exp} = (1 - \\exp(-\\lambda d_{0}))(1-p) + (1 - \\exp(-\\lambda d_{w}))p$$\n\n问题规定，此期望概率不得超过阈值 $T$：\n$$P_{exp} \\le T$$\n$$(1 - \\exp(-\\lambda d_{0}))(1-p) + (1 - \\exp(-\\lambda d_{w}))p \\le T$$\n\n为了求最大概率 $p_{\\max}$，我们对 $p$ 求解这个不等式。首先，展开表达式：\n$$1 - \\exp(-\\lambda d_{0}) - p + p\\exp(-\\lambda d_{0}) + p - p\\exp(-\\lambda d_{w}) \\le T$$\n$$1 - \\exp(-\\lambda d_{0}) + p(\\exp(-\\lambda d_{0}) - \\exp(-\\lambda d_{w})) \\le T$$\n\n现在，我们分离含有 $p$ 的项：\n$$p(\\exp(-\\lambda d_{0}) - \\exp(-\\lambda d_{w})) \\le T - 1 + \\exp(-\\lambda d_{0})$$\n\n项 $(\\exp(-\\lambda d_{0}) - \\exp(-\\lambda d_{w}))$ 是正的，因为 $\\lambda > 0$ 且 $d_{w} > d_{0}$，这意味着 $-\\lambda d_{w}  -\\lambda d_{0}$，并且由于指数函数是严格递增的，所以 $\\exp(-\\lambda d_{w})  \\exp(-\\lambda d_{0})$。因此，我们可以用此项除以不等式两边而不改变不等号的方向：\n$$p \\le \\frac{T - 1 + \\exp(-\\lambda d_{0})}{\\exp(-\\lambda d_{0}) - \\exp(-\\lambda d_{w})}$$\n\n$p$ 的最大值，记为 $p_{\\max}$，是此不等式的右侧：\n$$p_{\\max} = \\frac{T - 1 + \\exp(-\\lambda d_{0})}{\\exp(-\\lambda d_{0}) - \\exp(-\\lambda d_{w})}$$\n\n现在，我们代入给定的数值：\n$d_{0} = 1$\n$d_{w} = 24$\n$\\lambda = 3.0 \\times 10^{-3}$\n$T = 1.0 \\times 10^{-2}$\n\n首先，我们计算指数：\n$$-\\lambda d_{0} = -(3.0 \\times 10^{-3}) \\times 1 = -0.003$$\n$$-\\lambda d_{w} = -(3.0 \\times 10^{-3}) \\times 24 = -0.072$$\n\n将这些代入 $p_{\\max}$ 的表达式中：\n$$p_{\\max} = \\frac{(1.0 \\times 10^{-2}) - 1 + \\exp(-0.003)}{\\exp(-0.003) - \\exp(-0.072)}$$\n$$p_{\\max} = \\frac{0.01 - 1 + \\exp(-0.003)}{\\exp(-0.003) - \\exp(-0.072)}$$\n\n现在，我们计算指数函数的值：\n$$\\exp(-0.003) \\approx 0.9970044955$$\n$$\\exp(-0.072) \\approx 0.9305480030$$\n\n将这些值代入 $p_{\\max}$ 的表达式中：\n$$p_{\\max} \\approx \\frac{0.01 - 1 + 0.9970044955}{0.9970044955 - 0.9305480030}$$\n$$p_{\\max} \\approx \\frac{0.0070044955}{0.0664564925}$$\n$$p_{\\max} \\approx 0.1053998$$\n\n问题要求结果四舍五入到三位有效数字。\n$$p_{\\max} \\approx 0.105$$\n\n因此，使得严重不良后果的期望概率不超过阈值的最大误读概率约为 $0.105$。",
            "answer": "$$\n\\boxed{0.105}\n$$"
        },
        {
            "introduction": "医学知识并非孤立存在，而是在庞大的修道院网络中传播。本练习将我们的视角从单一的手稿扩展到整个知识传播系统。我们将运用现代计算建模技术，通过常微分方程来模拟一种新的医疗方案如何在修道院网络中随时间扩散。这个高级实践考虑了传播速度和审查制度等因素，揭示了计算模型如何帮助我们理解中世纪知识传播的宏观动态。",
            "id": "4756687",
            "problem": "您需要实现一个确定性模拟，模拟一个源自Salerno的医疗方案，在$50$年的时间跨度内，通过一个简化的本笃会修道院网络进行扩散的过程。该模拟必须基于将手稿复制与流传解释为一个受审查制度调节的、具有恒定风险率的无记忆过程。您需要将此扩散过程形式化为在一个有向图上的耦合常微分方程组（ODE）。\n\n基本原理和定义：\n- 由已采纳方案的修道院发起的手稿复制和传播行为，被建模为速率为 $\\lambda$（事件/年）的齐次泊松过程中的事件。对于每次传播尝试的平均复制延迟为 $L$ 年，基础速率为 $1/L$ 事件/年。如果每次传播尝试被审查制度阻止的独立概率为 $c$，那么有效传播速率为 $\\lambda = (1-c)/L$。\n- 修道院网络是一个有向图，包含 $n$ 个节点，标记为 $0,1,\\dots,n-1$。一条有向边 $(j \\to i)$ 表示修道院 $j$ 可以向修道院 $i$ 传播。\n- 设 $p_i(t)$ 表示节点 $i$ 在时间 $t$ 前已采纳该方案的概率（在平均场近似中解释为期望比例）。采纳是不可逆的。Salerno 是节点 $0$，满足 $p_0(0)=1$，所有其他节点 $i \\neq 0$ 满足 $p_i(0)=0$。\n- 假设在平均场水平上各节点是独立的，且来自不同邻居节点的传播效应可线性叠加，则每个节点 $i$ 的采纳动态遵循以下方程\n$$\n\\frac{dp_i}{dt} = \\left(1 - p_i(t)\\right)\\,\\lambda\\,\\sum_{j=0}^{n-1} A_{ji}\\,p_j(t),\n$$\n其中 $A$ 是邻接矩阵，当且仅当存在有向边 $j \\to i$ 时，$A_{ji}=1$，否则 $A_{ji}=0$。\n- 每个测试用例中我们关注的量是 $T=50$ 年时的平均采纳水平，\n$$\n\\bar{p}(T) = \\frac{1}{n}\\sum_{i=0}^{n-1} p_i(T),\n$$\n一个在 $[0,1]$ 区间内的无量纲数。\n\n网络规格：\n- 网络 $\\mathcal{A}$ 有 $n=8$ 个节点，其有向边为\n$$\n\\{(0,1),(0,2),(1,3),(2,3),(3,4),(4,5),(5,6),(1,4),(2,5)\\},\n$$\n且节点 $7$ 是孤立的（没有传入或传出边）。\n- 网络 $\\mathcal{B}$ 有 $n=8$ 个节点，包含除自环外的所有有向边，即对于所有 $i \\neq j$ 的有序对 $(i,j)$，都存在一条边 $i \\to j$。\n\n您的程序必须使用初始条件 $p_0(0)=1$ 和对所有 $i \\in \\{1,\\dots,n-1\\}$ 都有 $p_i(0)=0$，对该常微分方程组进行从 $t=0$ 到 $t=T$（$T=50$ 年）的数值积分。您必须为下面定义的每个测试参数集计算 $\\bar{p}(T)$。答案值必须以小数形式报告，并四舍五入到恰好 $3$ 位小数。时间以年为单位，在常微分方程积分内部使用；最终答案是无量纲的分数，并且必须以小数（而非百分比）形式报告。\n\n测试套件：\n为以下五个参数集 $(\\text{网络}, L, c)$ 计算 $\\bar{p}(T)$，每个集合的 $T=50$：\n- 案例 $1$：$(\\mathcal{A}, L=5, c=0.2)$。\n- 案例 $2$：$(\\mathcal{B}, L=3, c=0.0)$。\n- 案例 $3$：$(\\mathcal{A}, L=5, c=0.9)$。\n- 案例 $4$：$(\\mathcal{A}, L=50, c=0.0)$。\n- 案例 $5$：$(\\mathcal{A}, L=5, c=1.0)$。\n\n输出规格：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表项按上述案例的顺序列出结果，例如，\n\"[r1,r2,r3,r4,r5]\",\n其中每个 $r_k$ 是案例 $k$ 的 $\\bar{p}(T)$ 值，四舍五入到恰好 $3$ 位小数。",
            "solution": "该问题要求模拟网络上的一个采纳过程，该过程在数学上被形式化为一个耦合常微分方程组（ODE）。系统状态由向量 $\\mathbf{p}(t) = [p_0(t), p_1(t), \\dots, p_{n-1}(t)]^T$ 描述，其中 $p_i(t)$ 表示节点 $i$ 在时间 $t$ 前已采纳某医疗方案的概率。对每个节点 $i$ 而言，其动态由以下方程控制：\n$$\n\\frac{dp_i}{dt} = \\left(1 - p_i(t)\\right)\\,\\lambda\\,\\sum_{j=0}^{n-1} A_{ji}\\,p_j(t)\n$$\n在此，$1 - p_i(t)$ 是节点 $i$ 尚未采纳该方案的概率。采纳过程是不可逆的，因此该项确保了采纳概率 $p_i$ 只能增加。$\\lambda$ 项是有效传播速率，由 $\\lambda = (1-c)/L$ 给出，其中 $L$ 是单次传播尝试的平均延迟，$c$ 是审查概率。求和项表示来自邻居节点对节点 $i$ 的总“感染力”。\n\n问题将矩阵 $A$ 定义为：对于从 $j$ 到 $i$ 的有向边，$A_{ji}=1$。我们定义一个标准邻接矩阵 $M$，其中若存在从 $u$ 到 $v$ 的有向边，则 $M_{uv}=1$。条件 $j \\to i$ 意味着 $M_{ji}=1$。问题对一条边 $j \\to i$ 定义 $A_{ji}=1$，这意味着问题陈述中的矩阵 $A$ 实际上是标准邻接矩阵 $M$ 的转置，即 $A=M^T$。然而，求和本身 $\\sum_{j} A_{ji} p_j$ 是矩阵-向量乘积 $A^T \\mathbf{p}$ 的第 $i$ 个分量。这是一个常见的记法混淆点。\n\n为从第一性原理推导出正确的向量形式，$p_i$ 的增长率与所有存在到节点 $i$ 的有向边的节点 $j$ 的影响总和成正比。这个总和是 $\\sum_{j \\to i} p_j(t)$。使用标准邻接矩阵 $M$（其中对于边 $u \\to v$，$M_{uv}=1$），这个总和等价于 $\\sum_{j=0}^{n-1} M_{ji} p_j(t)$。这是向量 $M^T\\mathbf{p}$ 的第 $i$ 个分量。因此，该常微分方程组可以使用哈达玛积（逐元素乘积）$\\odot$ 写成紧凑的向量形式：\n$$\n\\frac{d\\mathbf{p}}{dt} = (\\mathbf{1} - \\mathbf{p}(t)) \\odot (\\lambda M^T \\mathbf{p}(t))\n$$\n其中 $\\mathbf{1}$ 是全一向量。我们将实现此公式。\n\n初始条件是节点 $0$ (Salerno) 已采纳该方案，而所有其他节点均未采纳：\n$$\n\\mathbf{p}(0) = [1, 0, 0, \\dots, 0]^T\n$$\n这构成了一个初值问题（IVP），我们将在时间区间 $[0, T]$（$T=50$ 年）上对其进行数值求解。\n\n解将通过数值ODE求解器获得。SciPy库中的 `scipy.integrate.solve_ivp` 函数是实现此目的的合适且强大的工具。它实现了多种积分方法，其默认的 `RK45`（5(4)阶显式龙格-库塔方法）适用于此非刚性系统。\n\n我们必须为两个指定的网络构建标准邻接矩阵 $M$：\n1.  **网络 $\\mathcal{A}$**：为 $n=8$ 个节点构建一个 $8 \\times 8$ 的矩阵 $M_A$。我们初始化一个 $8 \\times 8$ 的零矩阵，并为每个指定的边 $(u, v) \\in \\{(0,1),(0,2),(1,3),(2,3),(3,4),(4,5),(5,6),(1,4),(2,5)\\}$ 设置 $M_{A}[u, v] = 1$。注意，节点 $7$ 是孤立的，没有传入或传出边，这意味着 $M_A$ 的第 $7$ 行和第 $7$ 列将全为零。因此，由于 $p_7(0)=0$ 且 $dp_7/dt=0$，$p_7(t)$ 将始终为 $0$。\n2.  **网络 $\\mathcal{B}$**：为 $n=8$ 个节点构建一个 $8 \\times 8$ 的矩阵 $M_B$。该网络包含所有满足 $i \\neq j$ 的有向边 $(i, j)$。这对应于一个主对角线为零、其余元素全为一的矩阵。\n\n对于每个测试用例，我们首先计算有效速率 $\\lambda$。当 $\\lambda=0$ 时（案例 $5$，其中 $c=1.0$）会出现一种特殊情况。在这种情况下，$d\\mathbf{p}/dt = \\mathbf{0}$，意味着概率不会从其初始值改变。最终状态就是 $\\mathbf{p}(T) = \\mathbf{p}(0) = [1, 0, \\dots, 0]^T$，平均采纳水平为 $\\bar{p}(T) = 1/n = 1/8 = 0.125$。对于所有其他 $\\lambda  0$ 的情况，我们对常微分方程组进行数值积分。\n\n在求解初值问题（IVP）以找到 $T=50$ 时的状态向量 $\\mathbf{p}(T)$ 后，计算我们最终关注的量：\n$$\n\\bar{p}(T) = \\frac{1}{n}\\sum_{i=0}^{n-1} p_i(T) = \\text{mean}(\\mathbf{p}(T))\n$$\n然后，将每个案例的结果四舍五入到恰好 $3$ 位小数，作为最终输出。值得注意的是，案例 $3$（$L=5, c=0.9$）和案例 $4$（$L=50, c=0.0$）在同一网络 $\\mathcal{A}$ 上都产生相同的有效速率 $\\lambda=0.02$。因此，它们必须产生相同的结果，这可作为实现的一致性检查。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef ode_system(t, p, M_T, lambda_val):\n    \"\"\"\n    Defines the system of ordinary differential equations for the adoption dynamics.\n\n    Args:\n        t (float): Current time (not used in this autonomous system, but required by the solver).\n        p (np.ndarray): Vector of adoption probabilities [p_0, ..., p_{n-1}].\n        M_T (np.ndarray): The transpose of the standard adjacency matrix.\n        lambda_val (float): The effective transmission rate.\n\n    Returns:\n        np.ndarray: The vector of derivatives [dp_0/dt, ..., dp_{n-1}/dt].\n    \"\"\"\n    # Force of infection from neighbors\n    influence = M_T @ p\n    \n    # Rate of change for each node's adoption probability\n    # dp/dt = (1 - p) * lambda * (M^T * p)\n    return (1 - p) * lambda_val * influence\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    # Global parameters\n    T = 50.0  # Total simulation time in years\n    n = 8     # Number of nodes in the networks\n\n    # --- Network Definitions (Standard Adjacency Matrix M: M_uv=1 for edge u-v) ---\n    \n    # Network A\n    M_A = np.zeros((n, n), dtype=float)\n    edges_A = [\n        (0, 1), (0, 2), (1, 3), (2, 3), (3, 4), \n        (4, 5), (5, 6), (1, 4), (2, 5)\n    ]\n    for u, v in edges_A:\n        M_A[u, v] = 1.0\n\n    # Network B (complete graph except self-loops)\n    M_B = np.ones((n, n), dtype=float)\n    np.fill_diagonal(M_B, 0)\n    \n    networks = {'A': M_A, 'B': M_B}\n\n    # --- Test Suite ---\n    test_cases = [\n        # (network_id, L, c)\n        ('A', 5.0, 0.2),  # Case 1\n        ('B', 3.0, 0.0),  # Case 2\n        ('A', 5.0, 0.9),  # Case 3\n        ('A', 50.0, 0.0), # Case 4\n        ('A', 5.0, 1.0)   # Case 5\n    ]\n    \n    results = []\n    \n    # --- Initial Conditions ---\n    p0 = np.zeros(n, dtype=float)\n    p0[0] = 1.0\n    t_span = [0, T]\n\n    for net_id, L, c in test_cases:\n        # Select the appropriate network matrix\n        M = networks[net_id]\n        M_T = M.T  # Pre-transpose the matrix for efficiency in the ODE function\n        \n        # Calculate effective transmission rate\n        # L  0 is assumed from problem context.\n        lambda_val = (1.0 - c) / L\n\n        if lambda_val == 0:\n            # Analytical solution for lambda = 0: no diffusion\n            # p(T) = p(0), so avg_p(T) = mean(p(0))\n            avg_p_T = np.mean(p0)\n        else:\n            # Numerically integrate the system of ODEs\n            sol = solve_ivp(\n                fun=ode_system,\n                t_span=t_span,\n                y0=p0,\n                method='RK45',\n                args=(M_T, lambda_val),\n                dense_output=True # Allows for accurate evaluation at T\n            )\n            \n            # Evaluate the solution at the final time T\n            p_T = sol.sol(T)\n            \n            # Calculate the average adoption level\n            avg_p_T = np.mean(p_T)\n        \n        results.append(avg_p_T)\n\n    # Format the final output string according to specifications\n    # Use f-string formatting to ensure exactly 3 decimal places\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}