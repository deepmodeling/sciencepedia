{
    "hands_on_practices": [
        {
            "introduction": "在循证医学的兴起之前，临床决策在很大程度上依赖于非正式的观察和经验。然而，这些观察性数据可能隐藏着巨大的陷阱，其中最关键的一个问题便是混杂偏倚（confounding）。这个练习通过一个著名的统计现象——辛普森悖论（Simpson's Paradox），直观地展示了这一问题。通过亲手计算并分析这个看似矛盾的数据集，你将深刻理解为什么随机化等统计学方法对于得出可靠的因果结论至关重要。",
            "id": "4744898",
            "problem": "二十世纪中叶，循证医学（EBM）的兴起越来越依赖于形式化的统计推理来评判疗法在真实临床人群中的效果。考虑一项来自前随机化时代的观察性队列研究，该研究旨在调查一种治疗传染病的新疗法。患者根据基线严重程度分为$2$个层：“轻症”层和“重症”层。结果以30天时的存活情况来衡量。观察到的计数如下：\n\n- 轻症层：\n  - 治疗组：$20$名患者中有$19$名存活。\n  - 未治疗组：$200$名患者中有$180$名存活。\n- 重症层：\n  - 治疗组：$20$名患者中有$2$名存活。\n  - 未治疗组：$20$名患者中有$1$名存活。\n\n仅使用风险和对比度量的基本定义，按以下步骤进行：\n\n1. 将每个层内各组的风险（存活概率）定义为存活者与总患者的比率，并将风险差定义为 $RD = r_{\\text{treated}} - r_{\\text{untreated}}$。计算各层的特定风险和风险差，并判断在每个层内治疗是否有效。\n\n2. 通过汇总两个层的数据来计算治疗组和未治疗组的合并总体风险，然后计算忽略分层的合并总体风险差。\n\n3. 将此数据集的“Simpson逆转幅度”定义为合并总体风险差与两个层特定风险差的简单平均值之间的绝对差。计算此幅度。\n\n4. 在您的解答中，用简短的论述阐明在观察性数据中，能够导致层特定对比和合并对比之间符号发生逆转的因果条件，并将您的解释建立在EBM统计学转向的历史动机之上。您可以引用概率论和因果推理的核心定义（例如，适应症混杂），但不要假设随机分配。\n\n以小数形式表示Simpson逆转幅度的最终数值结果，并将您的答案四舍五入到四位有效数字。最终结果中不要包含单位。",
            "solution": "问题陈述是初等概率论、统计学和因果推理中的一个有效练习，呈现了Simpson悖论的一个经典案例。该问题具有科学依据、提法恰当且客观。解答所需的所有数据和定义均已提供。我们可以开始解题。\n\n该问题要求对一项假设性临床研究的观察性数据进行四部分分析。我们将使用提供的定义，按顺序处理每个部分。\n\n令$S=1$表示存活，$S=0$表示未存活。令$T=1$表示接受治疗的患者，$T=0$表示未接受治疗的患者。令$Z=\\text{mild}$表示轻症层，$Z=\\text{severe}$表示重症层。存活风险是在给定治疗状态$t$和分层$z$下的条件概率$P(S=1 | T=t, Z=z)$。\n\n**第1部分：层特定风险和风险差**\n\n首先，我们分析“轻症”层 ($Z=\\text{mild}$)。\n治疗组患者人数为 $n_{T, \\text{mild}} = 20$，其中有$19$名存活者。\n未治疗组患者人数为 $n_{UT, \\text{mild}} = 200$，其中有$180$名存活者。\n\n轻症层中治疗组的风险为：\n$$r_{T, \\text{mild}} = P(S=1 | T=1, Z=\\text{mild}) = \\frac{19}{20} = 0.95$$\n轻症层中未治疗组的风险为：\n$$r_{UT, \\text{mild}} = P(S=1 | T=0, Z=\\text{mild}) = \\frac{180}{200} = 0.90$$\n轻症层的层特定风险差$RD_{\\text{mild}}$为：\n$$RD_{\\text{mild}} = r_{T, \\text{mild}} - r_{UT, \\text{mild}} = 0.95 - 0.90 = 0.05$$\n由于 $RD_{\\text{mild}} > 0$，在轻症层内，该治疗看起来是有益的。\n\n接下来，我们分析“重症”层 ($Z=\\text{severe}$)。\n治疗组患者人数为 $n_{T, \\text{severe}} = 20$，其中有$2$名存活者。\n未治疗组患者人数为 $n_{UT, \\text{severe}} = 20$，其中有$1$名存活者。\n\n重症层中治疗组的风险为：\n$$r_{T, \\text{severe}} = P(S=1 | T=1, Z=\\text{severe}) = \\frac{2}{20} = 0.10$$\n重症层中未治疗组的风险为：\n$$r_{UT, \\text{severe}} = P(S=1 | T=0, Z=\\text{severe}) = \\frac{1}{20} = 0.05$$\n重症层的层特定风险差$RD_{\\text{severe}}$为：\n$$RD_{\\text{severe}} = r_{T, \\text{severe}} - r_{UT, \\text{severe}} = 0.10 - 0.05 = 0.05$$\n由于 $RD_{\\text{severe}} > 0$，在重症层内，该治疗也看起来是有益的。在两个层中，治疗都与存活概率增加5个百分点相关。\n\n**第2部分：合并总体风险和风险差**\n\n为了计算合并（总体）风险，我们汇总两个层的数据，忽略严重程度变量。\n\n治疗组总患者数：\n$$N_T = n_{T, \\text{mild}} + n_{T, \\text{severe}} = 20 + 20 = 40$$\n治疗组存活者总数：\n$$S_T = 19 + 2 = 21$$\n未治疗组总患者数：\n$$N_{UT} = n_{UT, \\text{mild}} + n_{UT, \\text{severe}} = 200 + 20 = 220$$\n未治疗组存活者总数：\n$$S_{UT} = 180 + 1 = 181$$\n\n治疗组的合并风险为：\n$$r_{T, \\text{pooled}} = \\frac{S_T}{N_T} = \\frac{21}{40} = 0.525$$\n未治疗组的合并风险为：\n$$r_{UT, \\text{pooled}} = \\frac{S_{UT}}{N_{UT}} = \\frac{181}{220}$$\n合并总体风险差$RD_{\\text{pooled}}$为：\n$$RD_{\\text{pooled}} = r_{T, \\text{pooled}} - r_{UT, \\text{pooled}} = \\frac{21}{40} - \\frac{181}{220}$$\n为了计算这些分数的差，我们找到一个公分母，即$440$。\n$$RD_{\\text{pooled}} = \\frac{21 \\times 11}{40 \\times 11} - \\frac{181 \\times 2}{220 \\times 2} = \\frac{231}{440} - \\frac{362}{440} = \\frac{231 - 362}{440} = -\\frac{131}{440}$$\n其小数值约为$-0.2977$。在这里，符号发生了逆转：合并分析表明治疗是有害的。这是Simpson悖论的一个经典展示。\n\n**第3部分：Simpson逆转幅度**\n\n问题将Simpson逆转幅度$M$定义为合并总体风险差与两个层特定风险差的简单平均值之间的绝对差。\n首先，我们计算层特定风险差的平均值：\n$$\\text{Average}(RD_{\\text{stratum}}) = \\frac{RD_{\\text{mild}} + RD_{\\text{severe}}}{2} = \\frac{0.05 + 0.05}{2} = 0.05$$\n现在，我们计算幅度$M$：\n$$M = |RD_{\\text{pooled}} - \\text{Average}(RD_{\\text{stratum}})| = \\left|-\\frac{131}{440} - 0.05\\right|$$\n将$0.05$转换为分数，$0.05 = \\frac{5}{100} = \\frac{1}{20}$。\n$$M = \\left|-\\frac{131}{440} - \\frac{1}{20}\\right| = \\left|-\\frac{131}{440} - \\frac{22}{440}\\right| = \\left|-\\frac{131 + 22}{440}\\right| = \\left|-\\frac{153}{440}\\right|$$\n$$M = \\frac{153}{440} \\approx 0.34772727...$$\n四舍五入到四位有效数字，Simpson逆转幅度为$0.3477$。\n\n**第4部分：发生逆转的因果条件（Simpson悖论）**\n\n层特定对比和合并对比之间的符号逆转，即所谓的Simpson悖论，是在观察性数据中由**混杂（confounding）**引起的。混杂因素是与暴露（治疗）和结局（存活）都相关，从而在二者之间产生虚假关联的第三个变量。在此数据集中，疾病的**基线严重程度**就是混杂因素。\n\n对于变量$Z$（严重程度）要成为变量$X$（治疗）对变量$Y$（存活）影响的混杂因素，数据中必须满足两个条件：\n1.  $Z$必须与暴露$X$相关。在本研究中，我们必须检查接受治疗的患者比例在不同严重程度的层之间是否存在差异。\n    -   轻症层中接受治疗的患者比例：$\\frac{20}{20+200} = \\frac{20}{220} \\approx 0.091$ 或 $9.1\\%$。\n    -   重症层中接受治疗的患者比例：$\\frac{20}{20+20} = \\frac{20}{40} = 0.50$ 或 $50\\%$。\n    这里存在强关联：重症患者接受治疗的可能性要大得多。这通常被称为“适应症混杂”（confounding by indication），即给予治疗的临床原因（病情严重）本身就是对结局的一个强有力的预测因素。\n2.  $Z$必须是结局$Y$的一个原因，且独立于暴露$X$。我们检查严重程度是否与存活相关，例如，在未治疗组中。\n    -   未治疗的轻症患者的存活风险：$r_{UT, \\text{mild}} = 0.90$。\n    -   未治疗的重症患者的存活风险：$r_{UT, \\text{severe}} = 0.05$。\n    这种关联性极强：重症患者的内在存活概率要低得多。\n\n悖论的产生是因为合并分析的“粗略”比较是不公平的。合并的“治疗”组由50%的重症患者（$20/40$）和50%的轻症患者（$20/40$）组成。而合并的“未治疗”组则绝大多数由轻症患者构成（$200/220 \\approx 91\\%$），只有少数重症患者（$20/220 \\approx 9\\%$）。因此，合并分析实际上是在比较一个高风险组（治疗组）和一个低风险组（未治疗组）。在合并数据中，治疗的表面上的有害效应并非由治疗本身引起，而是由于治疗被优先给予那些无论如何都注定结局不佳的病情更重的患者这一事实所造成的。\n\n循证医学（EBM）中“统计学转向”的历史动机正是为了解决这种朴素观察性分析的失败。人们认识到，适应症混杂可能导致完全错误的结论（例如，一种有益的药物表现为有害），这推动了**随机对照试验（RCT）**的发展和采用。在RCT中，治疗是随机分配的。这一程序，就其设计而言，打破了混杂因素（$Z$）与暴露（$X$）之间的关联，确保平均而言，治疗组和未治疗组具有相同的患者严重程度分布。这允许对治疗的因果效应进行无偏估计。本问题中的悖论阐明了为何对混杂因素进行分层，或更稳健地，随机化治疗，会成为现代临床证据的基石。",
            "answer": "$$\n\\boxed{0.3477}\n$$"
        },
        {
            "introduction": "认识到观察性研究的局限性后，医学界转向了一种更严谨的方法来评估治疗效果：随机对照试验（Randomized Controlled Trial, RCT）。RCT通过随机分配来最大程度地减少混杂偏倚，从而成为评估干预措施因果效应的“金标准”。这个练习将带你模拟一次简单RCT的结果分析，你将学会计算两种核心的效应量指标——风险差（risk difference）和风险比（risk ratio），并理解随机化是如何赋予我们做出因果推断的底气。",
            "id": "4745026",
            "problem": "二十世纪医学史上“统计学转向”的一个关键特征是随机实验的兴起，这些实验能够在最小假设下对疗法做出因果论断。考虑一项早期的随机对照试验（RCT, Randomized Controlled Trial），该试验研究一种针对严重传染病的新疗法。患者以 $1\\!:\\!1$ 的分配比例被随机分配接受该疗法或常规护理，且无失访。设 $Z$ 表示治疗分配，其中 $Z=1$ 表示接受疗法，$Z=0$ 表示接受常规护理。设 $Y$ 表示 $30$ 天死亡率的二元结局，其中 $Y=1$ 表示在 $30$ 天内死亡，$Y=0$ 表示存活。\n\n在治疗组中， $100$ 名患者中有 $20$ 名经历了 $Y=1$。在常规护理组中，$100$ 名患者中有 $35$ 名经历了 $Y=1$。仅使用基本定义——即一组中的风险是该组中结局的概率，可通过观察到的比例来估计——以及随机化使得潜在结局的分布在期望上独立于分配这一事实，完成以下任务：\n\n1. 计算治疗和常规护理之间的风险差，定义为风险之差。\n2. 计算治疗和常规护理之间的风险比，定义为风险之比。\n3. 提供一个与随机化逻辑和稳定单位治疗价值假设（SUTVA, Stable Unit Treatment Value Assumption）一致的简要因果解释，说明这些估计值在随机分配下对疗法于 $30$ 天死亡率的影响意味着什么。\n\n将风险差和风险比的数值答案表示为精确分数或小数。如果选择小数，则四舍五入到四位有效数字。不要使用百分号；将比例表示为小数或分数。",
            "solution": "该问题陈述是关于分析随机对照试验（RCT）数据的一个定义明确的练习，这是生物统计学和流行病学中的一个基础课题。它具有科学依据、自成体系且客观。所有必要的数据和定义都已提供，没有内部矛盾或歧义。因此，该问题被认为是有效的，可以构建一个正式的解决方案。\n\n该问题要求计算两种“效应量”——风险差和风险比——并对这些估计值进行因果解释。我们将首先定义相关量，然后从所提供的数据中计算估计值。\n\n设 $Z$ 为治疗分配的随机变量，其中 $Z=1$ 表示分配到治疗组，$Z=0$ 表示分配到常规护理组。设 $Y$ 为二元结局，其中 $Y=1$ 表示在 $30$ 天内死亡，$Y=0$ 表示存活。\n\n提供的数据如下：\n-   在治疗组（$Z=1$）中：$n_1 = 100$ 名患者，其中 $y_1 = 20$ 名经历了结局 $Y=1$。\n-   在常规护理组（$Z=0$）中：$n_0 = 100$ 名患者，其中 $y_0 = 35$ 名经历了结局 $Y=1$。\n\n问题将一个组中的风险定义为该组中结局的概率，这可以通过观察到的比例来估计。\n\n治疗组的风险 $R_1$，由 $\\hat{R}_1$ 估计：\n$$ \\hat{R}_1 = P(Y=1|Z=1) = \\frac{y_1}{n_1} = \\frac{20}{100} = 0.20 $$\n常规护理组的风险 $R_0$，由 $\\hat{R}_0$ 估计：\n$$ \\hat{R}_0 = P(Y=1|Z=0) = \\frac{y_0}{n_0} = \\frac{35}{100} = 0.35 $$\n\n有了这些估计的风险，我们就可以解决问题的三个部分。\n\n1.  **计算风险差 (RD)。**\n风险差定义为风险之差，$RD = R_1 - R_0$。其估计值 $\\widehat{RD}$ 计算如下：\n$$ \\widehat{RD} = \\hat{R}_1 - \\hat{R}_0 = 0.20 - 0.35 = -0.15 $$\n这个值是一个精确的小数。\n\n2.  **计算风险比 (RR)。**\n风险比定义为风险之比，$RR = R_1 / R_0$。其估计值 $\\widehat{RR}$ 计算如下：\n$$ \\widehat{RR} = \\frac{\\hat{R}_1}{\\hat{R}_0} = \\frac{0.20}{0.35} = \\frac{20}{35} = \\frac{4}{7} $$\n这个值是一个精确分数。作为四舍五入到四位有效数字的小数，它约等于 $0.5714$。为求精确，首选精确分数形式。\n\n3.  **提供简要的因果解释。**\nRCT 的威力在于它能够产生具有因果解释的估计值。这依赖于潜在结局框架，其中每个患者 $i$ 在接受治疗下有一个潜在结局 $Y_i(1)$，在接受常规护理下有一个潜在结局 $Y_i(0)$。患者 $i$ 的因果效应是差值 $Y_i(1) - Y_i(0)$，这在根本上是不可观察的。我们转而估计平均因果效应（ACE），$E[Y(1) - Y(0)]$。\n\n随机化确保了在期望上，两组在所有基线特征（无论是测量的还是未测量的）方面都是可比的。形式上，它使得治疗分配 $Z$ 独立于潜在结局 $\\{Y(1), Y(0)\\}$。这意味着 $E[Y(1)|Z=1] = E[Y(1)]$ 和 $E[Y(0)|Z=0] = E[Y(0)]$。\n\n稳定单位治疗价值假设（SUTVA）假定 (a) 患者之间没有干扰，以及 (b) 治疗和对照都只有一种版本。SUTVA 允许我们将每个组的观察结局等同于其潜在结局：对于 $Z=1$ 的患者，其观察结局为 $Y=Y(1)$；对于 $Z=0$ 的患者，其观察结局为 $Y=Y(0)$。\n\n由于随机化和 SUTVA，治疗组中结局的期望值是在治疗下的平均潜在结局，$E[Y|Z=1] = E[Y(1)|Z=1] = E[Y(1)]$。类似地，$E[Y|Z=0] = E[Y(0)|Z=0] = E[Y(0)]$。风险 $R_1$ 和 $R_0$ 就是这些期望值，$R_1=E[Y(1)]$ 和 $R_0=E[Y(0)]$。\n\n因此，我们的统计估计是因果参数的无偏估计：\n-   风险差估计值 $\\widehat{RD} = -0.15$，是平均因果效应的估计：$ACE = E[Y(1)] - E[Y(0)]$。\n-   风险比估计值 $\\widehat{RR} = 4/7$，是因果风险比的估计：$E[Y(1)] / E[Y(0)]$。\n\n**因果解释：**\n基于这项随机实验，我们可以推断该疗法的因果效应。\n-   风险差为 $-0.15$ 意味着，与接受常规护理相比，接受该疗法平均导致 $30$ 天死亡风险绝对降低了 $0.15$，即 $15$ 个百分点。\n-   风险比为 $4/7$（约 $0.5714$）意味着，该疗法使得 $30$ 天死亡风险降至常规护理下风险的一半多一点。这对应于相对风险降低了 $1 - 4/7 = 3/7$，约等于 $42.9\\%$。\n\n总之，从这项 RCT 中得出的估计表明，新疗法对 $30$ 天死亡率具有显著的保护性因果效应。",
            "answer": "$$\\boxed{\\begin{pmatrix} -0.15 & \\frac{4}{7} \\end{pmatrix}}$$"
        },
        {
            "introduction": "医学中的统计学转向不仅重塑了治疗评价，也彻底改变了诊断思维。医生不再仅仅依赖直觉，而是使用概率工具来量化诊断的不确定性。本练习的核心是贝叶斯定理（Bayes' theorem），它是在获得新证据（如化验结果）后更新信念的数学引擎。你将计算一个诊断测试如何改变我们对患者患病可能性的判断，即从“验前概率”更新为“验后概率”，这是现代循证诊断实践的基石。",
            "id": "4744954",
            "problem": "在循证医学（EBM）的历史发展中，统计学转向强调了关于诊断性测试的形式化概率推理。考虑一种用于某种疾病的测试，临床医生历史上以灵敏度和特异性报告其操作特性，并使用似然比来更新诊断信念。从灵敏度、特异性、验前概率和阳性似然比的核心定义出发，并使用以优势比形式表示的贝叶斯定理，计算阳性测试结果后的疾病后验概率。\n\n假设在临床人群中单次诊断测试应用中，经验观察到的量如下：验前概率为 $0.20$，灵敏度为 $0.90$，特异性为 $0.80$。对于阳性测试结果，阳性似然比定义为 $LR^{+} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}$。\n\n仅使用这些定义和贝叶斯定理来连接概率和优势比，确定单次阳性测试结果后的疾病后验概率。请用精确分数表示最终答案。不要使用百分号。",
            "solution": "该问题是有效的，因为它科学地基于生物统计学和循证医学的原理，问题设定良好，信息充分且一致，并以客观、正式的语言表述。因此，我们可以着手求解。\n\n令 $D$ 为患者患有该疾病的事件，令 $D^c$ 为患者未患该疾病的事件。令 $T^+$ 为测试结果为阳性的事件。问题要求我们计算在测试结果为阳性条件下患病的后验概率，记为 $P(D|T^+)$。\n\n给定的信息如下：\n1.  疾病的验前概率，$P(D) = 0.20$。\n2.  测试的灵敏度，即患者患病条件下测试结果为阳性的概率，$P(T^+|D) = 0.90$。\n3.  测试的特异性，即患者未患病条件下测试结果为阴性的概率，$P(T^-|D^c) = 0.80$。\n\n解法将使用优势比形式的贝叶斯定理推导。事件 $E$ 的优势比定义为该事件发生的概率与其补事件发生的概率之比，$O(E) = \\frac{P(E)}{1-P(E)}$。\n\n首先，我们定义疾病的验前优势比和验后优势比。\n验前优势比 $O_{\\text{pre}}$ 是指在知道测试结果之前患病的优势比：\n$$ O_{\\text{pre}} = \\frac{P(D)}{1-P(D)} = \\frac{P(D)}{P(D^c)} $$\n验后优势比 $O_{\\text{post}}$ 是指观察到阳性测试结果后患病的优势比：\n$$ O_{\\text{post}} = \\frac{P(D|T^+)}{1-P(D|T^+)} = \\frac{P(D|T^+)}{P(D^c|T^+)} $$\n\n优势比形式的贝叶斯定理通过似然比（LR）将验后优势比与验前优势比联系起来。对于阳性测试结果，其方程为：\n$$ O_{\\text{post}} = LR^+ \\times O_{\\text{pre}} $$\n其中 $LR^+$ 是阳性似然比。$LR^+$ 是患病患者中测试结果为阳性的概率与未患病患者中测试结果为阳性的概率之比：\n$$ LR^+ = \\frac{P(T^+|D)}{P(T^+|D^c)} $$\n分子 $P(T^+|D)$ 是灵敏度。分母 $P(T^+|D^c)$ 是假阳性率。由于未患病的患者（$D^c$）的测试结果只可能为阳性（$T^+$）或阴性（$T^-$），我们有 $P(T^+|D^c) + P(T^-|D^c) = 1$。因此，假阳性率为 $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\text{specificity}$。\n这验证了问题陈述中提供的定义：$LR^{+} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}$。\n\n现在，我们使用给定值计算必要的量。最好使用精确分数进行计算。\n验前概率为 $P(D) = 0.20 = \\frac{20}{100} = \\frac{1}{5}$。\n不患病的概率为 $P(D^c) = 1 - P(D) = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n验前优势比为：\n$$ O_{\\text{pre}} = \\frac{P(D)}{P(D^c)} = \\frac{1/5}{4/5} = \\frac{1}{4} $$\n灵敏度为 $P(T^+|D) = 0.90 = \\frac{9}{10}$。\n特异性为 $P(T^-|D^c) = 0.80 = \\frac{8}{10} = \\frac{4}{5}$。\n阳性似然比为：\n$$ LR^+ = \\frac{\\text{sensitivity}}{1 - \\text{specificity}} = \\frac{P(T^+|D)}{1 - P(T^-|D^c)} = \\frac{9/10}{1 - 4/5} = \\frac{9/10}{1/5} = \\frac{9}{10} \\times \\frac{5}{1} = \\frac{45}{10} = \\frac{9}{2} $$\n现在，我们可以使用优势比形式的贝叶斯定理计算验后优势比：\n$$ O_{\\text{post}} = LR^+ \\times O_{\\text{pre}} = \\frac{9}{2} \\times \\frac{1}{4} = \\frac{9}{8} $$\n最后一步是将验后优势比转换回概率。如果 $O = \\frac{p}{1-p}$，我们可以解出 $p$：\n$O(1-p) = p \\implies O - O p = p \\implies O = p(1+O) \\implies p = \\frac{O}{1+O}$。\n将此公式应用于验后优势比，得到后验概率 $P(D|T^+)$：\n$$ P(D|T^+) = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}} = \\frac{9/8}{1 + 9/8} = \\frac{9/8}{8/8 + 9/8} = \\frac{9/8}{17/8} = \\frac{9}{17} $$\n因此，单次阳性测试结果后的疾病后验概率为 $\\frac{9}{17}$。",
            "answer": "$$ \\boxed{\\frac{9}{17}} $$"
        }
    ]
}