{
    "hands_on_practices": [
        {
            "introduction": "The liver's ability to perform its metabolic functions depends critically on the perfusion of blood through its vast network of sinusoids. This blood flow is not static; it can be actively regulated by cells within the liver's microenvironment. This exercise explores how the contraction of hepatic stellate cells can constrict sinusoids and, as a consequence, dramatically alter blood flow, providing a powerful illustration of the link between cellular mechanics and organ-level physiology .",
            "id": "4911472",
            "problem": "A hepatic sinusoid in a classic lobule can be idealized as a cylindrical conduit running from the periportal region to the pericentral region, bordered by the space of Disse in which hepatic stellate cells (HSCs) reside. Consider steady, laminar flow of blood with constant dynamic viscosity $\\mu$ driven by a fixed pressure drop $\\Delta P$ along a sinusoid of total length $L$. In the baseline state, the sinusoid has a uniform radius $r_{0}$. Upon acute contraction of HSCs in the space of Disse, the downstream pericentral half of the sinusoid (length fraction $f = \\frac{1}{2}$) undergoes a radius reduction by a fraction $\\delta = \\frac{1}{4}$, while the upstream periportal half remains at $r_{0}$. Thus, the contracted segment has radius $r_{c} = (1 - \\delta) r_{0}$. Take $r_{0} = 5\\,\\mu\\mathrm{m}$ and $L = 600\\,\\mu\\mathrm{m}$.\n\nUse the following fundamental bases:\n- For laminar flow in a cylinder, volumetric flow $Q$ obeys Poiseuille’s law, $Q = \\dfrac{\\Delta P}{R}$ with hydraulic resistance $R = \\dfrac{8 \\mu L}{\\pi r^{4}}$.\n- Hydraulic resistances for segments in series add linearly.\n- Over short times, the oxygen content per unit blood volume at the sinusoid inlet, $C_{\\mathrm{in}}$, remains constant, and oxygen delivery rate to hepatocytes is flow-limited, so the delivery rate is proportional to $Q$.\n\nDerive from these bases the ratio of oxygen delivery after contraction relative to baseline, $\\dfrac{D\\!O_{2,\\mathrm{new}}}{D\\!O_{2,0}}$, by computing the ratio of flows $\\dfrac{Q_{\\mathrm{new}}}{Q_{0}}$ for the two-segment sinusoid. Express the final answer as a single dimensionless number and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the ratio of oxygen delivery after sinusoidal contraction to the baseline oxygen delivery. This is stated to be equivalent to the ratio of the volumetric flow rates, $\\dfrac{Q_{\\mathrm{new}}}{Q_{0}}$. The analysis will proceed by first defining the hydraulic resistance and flow rate for the baseline case, then for the contracted case, and finally computing their ratio.\n\n**Step 1: Validate the Problem Statement**\n\n**Givens:**\n- Fluid dynamic viscosity: $\\mu$ (constant)\n- Pressure drop: $\\Delta P$ (fixed)\n- Total sinusoid length: $L = 600\\,\\mu\\mathrm{m}$\n- Baseline sinusoid radius: $r_{0} = 5\\,\\mu\\mathrm{m}$\n- Length fraction of contracted segment: $f = \\frac{1}{2}$\n- Radius reduction fraction: $\\delta = \\frac{1}{4}$\n- Radius of contracted segment: $r_{c} = (1 - \\delta) r_{0}$\n- Poiseuille's law for volumetric flow: $Q = \\dfrac{\\Delta P}{R}$\n- Hydraulic resistance for a cylinder: $R = \\dfrac{8 \\mu L}{\\pi r^{4}}$\n- Resistances in series add linearly.\n- Oxygen delivery rate is proportional to flow rate $Q$. The ratio to be found is $\\dfrac{D\\!O_{2,\\mathrm{new}}}{D\\!O_{2,0}} = \\dfrac{Q_{\\mathrm{new}}}{Q_{0}}$.\n\n**Validation:**\nThe problem is scientifically grounded, using the well-established Poiseuille's law for laminar flow in a cylinder, a standard model for microcirculation. The scenario of sinusoidal constriction due to hepatic stellate cell contraction is a recognized physiological phenomenon. The parameters are clearly defined, and the given values for sinusoid dimensions are physiologically realistic. The problem is self-contained, well-posed, and objective. There are no contradictions, ambiguities, or invalid assumptions. Therefore, the problem is valid.\n\n**Step 2: Baseline State (State 0)**\nIn the baseline state, the sinusoid is a single uniform cylinder of length $L$ and radius $r_{0}$. The total hydraulic resistance, $R_{0}$, is given by the formula for resistance:\n$$R_{0} = \\frac{8 \\mu L}{\\pi r_{0}^{4}}$$\nThe volumetric flow rate, $Q_{0}$, is a function of the constant pressure drop $\\Delta P$ and the resistance $R_{0}$:\n$$Q_{0} = \\frac{\\Delta P}{R_{0}} = \\frac{\\Delta P \\pi r_{0}^{4}}{8 \\mu L}$$\n\n**Step 3: Contracted State (New State)**\nAfter contraction, the sinusoid consists of two segments in series. The total new resistance, $R_{\\mathrm{new}}$, is the sum of the resistances of the two segments, $R_{1}$ (upstream/periportal) and $R_{2}$ (downstream/pericentral).\n$$R_{\\mathrm{new}} = R_{1} + R_{2}$$\nThe upstream segment has length $L_{1} = (1-f)L$ and radius $r_{1} = r_{0}$. The problem states $f = \\frac{1}{2}$, so $L_{1} = (1 - \\frac{1}{2})L = \\frac{L}{2}$. The resistance of this segment is:\n$$R_{1} = \\frac{8 \\mu L_{1}}{\\pi r_{1}^{4}} = \\frac{8 \\mu (\\frac{L}{2})}{\\pi r_{0}^{4}} = \\frac{1}{2} \\left( \\frac{8 \\mu L}{\\pi r_{0}^{4}} \\right) = \\frac{1}{2} R_{0}$$\nThe downstream segment has length $L_{2} = fL = \\frac{L}{2}$ and a contracted radius $r_{2} = r_{c} = (1 - \\delta)r_{0}$. The resistance of this segment is:\n$$R_{2} = \\frac{8 \\mu L_{2}}{\\pi r_{2}^{4}} = \\frac{8 \\mu (\\frac{L}{2})}{\\pi ((1 - \\delta)r_{0})^{4}} = \\frac{8 \\mu L}{2 \\pi r_{0}^{4} (1 - \\delta)^{4}} = \\frac{1}{2(1 - \\delta)^{4}} \\left( \\frac{8 \\mu L}{\\pi r_{0}^{4}} \\right) = \\frac{R_{0}}{2(1 - \\delta)^{4}}$$\nThe total new resistance is the sum of $R_{1}$ and $R_{2}$:\n$$R_{\\mathrm{new}} = R_{1} + R_{2} = \\frac{R_{0}}{2} + \\frac{R_{0}}{2(1 - \\delta)^{4}} = \\frac{R_{0}}{2} \\left( 1 + \\frac{1}{(1 - \\delta)^{4}} \\right)$$\nThe new volumetric flow rate, $Q_{\\mathrm{new}}$, is given by:\n$$Q_{\\mathrm{new}} = \\frac{\\Delta P}{R_{\\mathrm{new}}}$$\n\n**Step 4: Ratio of Flow Rates**\nThe ratio of the new flow rate to the baseline flow rate is:\n$$\\frac{Q_{\\mathrm{new}}}{Q_{0}} = \\frac{\\Delta P / R_{\\mathrm{new}}}{\\Delta P / R_{0}} = \\frac{R_{0}}{R_{\\mathrm{new}}}$$\nSubstituting the expression for $R_{\\mathrm{new}}$ in terms of $R_{0}$:\n$$\\frac{Q_{\\mathrm{new}}}{Q_{0}} = \\frac{R_{0}}{\\frac{R_{0}}{2} \\left( 1 + \\frac{1}{(1 - \\delta)^{4}} \\right)} = \\frac{1}{\\frac{1}{2} \\left( 1 + \\frac{1}{(1 - \\delta)^{4}} \\right)} = \\frac{2}{1 + \\frac{1}{(1 - \\delta)^{4}}}$$\n\n**Step 5: Numerical Calculation**\nThe problem provides the value for the radius reduction fraction, $\\delta = \\frac{1}{4}$.\nSubstitute this value into the expression for the ratio:\n$$1 - \\delta = 1 - \\frac{1}{4} = \\frac{3}{4}$$\n$$(1 - \\delta)^{4} = \\left(\\frac{3}{4}\\right)^{4} = \\frac{3^{4}}{4^{4}} = \\frac{81}{256}$$\nNow, substitute this back into the ratio expression:\n$$\\frac{Q_{\\mathrm{new}}}{Q_{0}} = \\frac{2}{1 + \\frac{1}{81/256}} = \\frac{2}{1 + \\frac{256}{81}}$$\nTo simplify the denominator:\n$$1 + \\frac{256}{81} = \\frac{81}{81} + \\frac{256}{81} = \\frac{81 + 256}{81} = \\frac{337}{81}$$\nTherefore, the ratio is:\n$$\\frac{Q_{\\mathrm{new}}}{Q_{0}} = \\frac{2}{\\frac{337}{81}} = \\frac{2 \\times 81}{337} = \\frac{162}{337}$$\nTo get the final numerical answer, we perform the division and round to four significant figures:\n$$\\frac{162}{337} \\approx 0.480712166...$$\nRounding to four significant figures gives $0.4807$.\n\nThe ratio of oxygen delivery rates is equal to this flow ratio:\n$$\\frac{D\\!O_{2,\\mathrm{new}}}{D\\!O_{2,0}} = \\frac{Q_{\\mathrm{new}}}{Q_{0}} = \\frac{162}{337} \\approx 0.4807$$",
            "answer": "$$\n\\boxed{0.4807}\n$$"
        },
        {
            "introduction": "Efficient molecular exchange between the blood and hepatocytes is the cornerstone of liver function. In a healthy liver, the fenestrated endothelium and the Space of Disse present minimal opposition to this exchange, but this can change in disease. This problem models the process of mass transfer as a series of diffusive resistances, allowing you to quantify the functional impact of sinusoidal capillarization, a common pathological finding in chronic liver disease where new barriers impede this vital transport .",
            "id": "4911564",
            "problem": "In the hepatic lobule, solute exchange between sinusoidal blood and hepatocytes occurs across the fenestrated endothelium, the Space of Disse, and the hepatocyte plasma membrane. In pathological capillarization of hepatic sinusoids, a continuous basement membrane is deposited and endothelial fenestrations are reduced, introducing new diffusion barriers. Consider steady-state, one-dimensional diffusion of oxygen from the sinusoidal lumen to the hepatocyte cytosol. Use Fick’s first law of diffusion and the principle that independent diffusive barriers in series contribute additively to the overall mass transfer resistance. Assume no partitioning at interfaces and uniform diffusivity within each layer.\n\nPre-capillarization, treat the endothelial fenestrations as providing negligible resistance compared to the following layers:\n- Space of Disse with thickness $\\delta_{\\mathrm{Disse}} = 0.50 \\,\\mu \\mathrm{m}$ and effective diffusivity $D_{\\mathrm{Disse}} = 3.0 \\times 10^{-9} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n- Hepatocyte plasma membrane with thickness $\\delta_{\\mathrm{mem}} = 0.0050 \\,\\mu \\mathrm{m}$ and effective diffusivity $D_{\\mathrm{mem}} = 1.0 \\times 10^{-9} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\nPost-capillarization, two new barriers are interposed between the sinusoidal lumen and the Space of Disse:\n- Basement membrane with thickness $\\delta_{\\mathrm{BM}} = 0.20 \\,\\mu \\mathrm{m}$ and effective diffusivity $D_{\\mathrm{BM}} = 1.5 \\times 10^{-9} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n- Continuous endothelial layer with thickness $\\delta_{\\mathrm{endo}} = 0.20 \\,\\mu \\mathrm{m}$ and effective diffusivity $D_{\\mathrm{endo}} = 2.0 \\times 10^{-9} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\nDefine the total mass transfer resistance $R$ as the proportionality factor relating the net concentration drop from blood to cytosol to the steady flux, and quantify the multiplicative increase in resistance due to capillarization as $R_{\\mathrm{post}}/R_{\\mathrm{pre}}$. Compute this ratio from first principles and round your final answer to four significant figures. Express the final answer as a dimensionless number.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of mass transfer, specifically Fick's first law of diffusion. It is well-posed, with all necessary parameters and definitions provided to compute a unique, dimensionless ratio. The problem statement is objective and free of ambiguity.\n\nThe solution proceeds from first principles. The steady-state, one-dimensional flux $J$ of a solute through a homogeneous layer is described by Fick's first law of diffusion:\n$$\nJ = -D \\frac{dC}{dx}\n$$\nwhere $D$ is the diffusivity of the solute and $\\frac{dC}{dx}$ is the concentration gradient along the spatial coordinate $x$. For a layer of uniform thickness $\\delta$ and constant diffusivity $D$, we can integrate this equation across the layer, from $x=0$ to $x=\\delta$. Since the flux $J$ is constant at steady state, we have:\n$$\nJ \\int_0^{\\delta} dx = -D \\int_{C_{in}}^{C_{out}} dC\n$$\nThis yields:\n$$\nJ\\delta = -D (C_{out} - C_{in}) = D (C_{in} - C_{out})\n$$\nThe concentration drop across the layer, $\\Delta C = C_{in} - C_{out}$, is therefore related to the flux by:\n$$\n\\Delta C = J \\left(\\frac{\\delta}{D}\\right)\n$$\nThe problem defines the total mass transfer resistance, $R$, as the proportionality factor relating the net concentration drop, $\\Delta C_{total}$, to the steady flux, $J$, such that $\\Delta C_{total} = J \\cdot R$. By analogy, the resistance of a single layer $i$ is $R_i = \\frac{\\Delta C_i}{J}$. From the preceding derivation, we find that the resistance of a single layer is:\n$$\nR_i = \\frac{\\delta_i}{D_i}\n$$\nThe problem states that independent diffusive barriers in series contribute additively to the overall mass transfer resistance. Thus, the total resistance $R_{total}$ for a series of layers is the sum of the individual resistances:\n$$\nR_{total} = \\sum_{i} R_i = \\sum_{i} \\frac{\\delta_i}{D_i}\n$$\nWe are asked to compute the ratio of the total resistance post-capillarization, $R_{\\mathrm{post}}$, to the total resistance pre-capillarization, $R_{\\mathrm{pre}}$.\n\nFirst, we define the resistance for the pre-capillarization state, $R_{\\mathrm{pre}}$. The layers contributing to resistance are the Space of Disse and the hepatocyte plasma membrane.\n$$\nR_{\\mathrm{pre}} = R_{\\mathrm{Disse}} + R_{\\mathrm{mem}} = \\frac{\\delta_{\\mathrm{Disse}}}{D_{\\mathrm{Disse}}} + \\frac{\\delta_{\\mathrm{mem}}}{D_{\\mathrm{mem}}}\n$$\nNext, we define the resistance for the post-capillarization state, $R_{\\mathrm{post}}$. In this case, two new layers are added in series: the continuous endothelium and the basement membrane. The total resistance is the sum of the original resistances and the new resistances.\n$$\nR_{\\mathrm{post}} = R_{\\mathrm{endo}} + R_{\\mathrm{BM}} + R_{\\mathrm{Disse}} + R_{\\mathrm{mem}} = \\frac{\\delta_{\\mathrm{endo}}}{D_{\\mathrm{endo}}} + \\frac{\\delta_{\\mathrm{BM}}}{D_{\\mathrm{BM}}} + \\frac{\\delta_{\\mathrm{Disse}}}{D_{\\mathrm{Disse}}} + \\frac{\\delta_{\\mathrm{mem}}}{D_{\\mathrm{mem}}}\n$$\nThe ratio of post- to pre-capillarization resistance is therefore:\n$$\n\\frac{R_{\\mathrm{post}}}{R_{\\mathrm{pre}}} = \\frac{\\frac{\\delta_{\\mathrm{endo}}}{D_{\\mathrm{endo}}} + \\frac{\\delta_{\\mathrm{BM}}}{D_{\\mathrm{BM}}} + \\frac{\\delta_{\\mathrm{Disse}}}{D_{\\mathrm{Disse}}} + \\frac{\\delta_{\\mathrm{mem}}}{D_{\\mathrm{mem}}}}{\\frac{\\delta_{\\mathrm{Disse}}}{D_{\\mathrm{Disse}}} + \\frac{\\delta_{\\mathrm{mem}}}{D_{\\mathrm{mem}}}}\n$$\nThis can be rewritten as:\n$$\n\\frac{R_{\\mathrm{post}}}{R_{\\mathrm{pre}}} = 1 + \\frac{\\frac{\\delta_{\\mathrm{endo}}}{D_{\\mathrm{endo}}} + \\frac{\\delta_{\\mathrm{BM}}}{D_{\\mathrm{BM}}}}{\\frac{\\delta_{\\mathrm{Disse}}}{D_{\\mathrm{Disse}}} + \\frac{\\delta_{\\mathrm{mem}}}{D_{\\mathrm{mem}}}}\n$$\nNow, we substitute the given values into the expression. All thicknesses $\\delta_i$ are given in micrometers ($\\mu\\mathrm{m}$), which is $10^{-6}$ meters ($\\mathrm{m}$), and all diffusivities $D_i$ are given in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$. Since we are calculating a ratio of sums of resistances, and each resistance term has units of $\\mathrm{s}\\,\\mathrm{m}^{-1}$, the ratio will be dimensionless. The unit conversion factors will cancel out.\n\nLet's compute the individual resistance terms, factoring out common powers of $10$:\n$R_{\\mathrm{pre}} = \\frac{0.50 \\times 10^{-6} \\,\\mathrm{m}}{3.0 \\times 10^{-9} \\,\\mathrm{m}^2\\mathrm{s}^{-1}} + \\frac{0.0050 \\times 10^{-6} \\,\\mathrm{m}}{1.0 \\times 10^{-9} \\,\\mathrm{m}^2\\mathrm{s}^{-1}} = \\left( \\frac{0.50}{3.0} + \\frac{0.0050}{1.0} \\right) \\times 10^3 \\,\\mathrm{s}\\,\\mathrm{m}^{-1}$\n$R_{\\mathrm{pre}} = \\left( \\frac{1}{6} + 0.005 \\right) \\times 10^3 = \\left( \\frac{1}{6} + \\frac{5}{1000} \\right) \\times 10^3 = \\left( \\frac{1}{6} + \\frac{1}{200} \\right) \\times 10^3$\n$R_{\\mathrm{pre}} = \\left( \\frac{100 + 3}{600} \\right) \\times 10^3 = \\frac{103}{600} \\times 1000 = \\frac{1030}{6} = \\frac{515}{3} \\,\\mathrm{s}\\,\\mathrm{m}^{-1}$.\n\nThe additional resistance due to capillarization, $R_{add} = R_{\\mathrm{endo}} + R_{\\mathrm{BM}}$, is:\n$R_{add} = \\frac{0.20 \\times 10^{-6} \\,\\mathrm{m}}{2.0 \\times 10^{-9} \\,\\mathrm{m}^2\\mathrm{s}^{-1}} + \\frac{0.20 \\times 10^{-6} \\,\\mathrm{m}}{1.5 \\times 10^{-9} \\,\\mathrm{m}^2\\mathrm{s}^{-1}} = \\left( \\frac{0.20}{2.0} + \\frac{0.20}{1.5} \\right) \\times 10^3 \\,\\mathrm{s}\\,\\mathrm{m}^{-1}$\n$R_{add} = \\left( 0.1 + \\frac{2}{15} \\right) \\times 10^3 = \\left( \\frac{1}{10} + \\frac{2}{15} \\right) \\times 10^3 = \\left( \\frac{3+4}{30} \\right) \\times 10^3 = \\frac{7}{30} \\times 1000 = \\frac{700}{3} \\,\\mathrm{s}\\,\\mathrm{m}^{-1}$.\n\nThe post-capillarization resistance is $R_{\\mathrm{post}} = R_{\\mathrm{pre}} + R_{add}$:\n$R_{\\mathrm{post}} = \\frac{515}{3} + \\frac{700}{3} = \\frac{1215}{3} = 405 \\,\\mathrm{s}\\,\\mathrm{m}^{-1}$.\n\nFinally, the required ratio is:\n$$\n\\frac{R_{\\mathrm{post}}}{R_{\\mathrm{pre}}} = \\frac{405}{\\frac{515}{3}} = \\frac{405 \\times 3}{515} = \\frac{1215}{515}\n$$\nTo simplify the fraction, we can divide the numerator and the denominator by their greatest common divisor. Both are divisible by $5$:\n$$\n\\frac{1215 \\div 5}{515 \\div 5} = \\frac{243}{103}\n$$\nThe number $103$ is prime, so this fraction is in its simplest form. We now compute the numerical value and round to four significant figures as requested.\n$$\n\\frac{243}{103} \\approx 2.3592233...\n$$\nRounding to four significant figures gives $2.359$.",
            "answer": "$$\\boxed{2.359}$$"
        },
        {
            "introduction": "Beyond processing blood, the liver produces and transports bile through an intricate network of channels called canaliculi. Understanding how this network functions requires moving beyond single-pathway models to consider a system of interconnected channels with multiple sources and outlets. This advanced practice guides you in building a computational network model of the biliary system, applying principles analogous to electrical circuits to analyze fluid dynamics and identify potential bottlenecks in bile flow under both normal and pathological conditions .",
            "id": "4911525",
            "problem": "You are asked to formalize bile flow along the canalicular network of a hepatic lobule using a simplified graph model grounded in established microarchitectural principles of the liver. Hepatocytes secrete bile into canaliculi, which drain toward bile ductules located in portal triads, opposite the direction of blood flow through sinusoids and the Space of Disse. In this model, nodes represent canalicular junctions or hepatocyte canalicular loci, some nodes have fixed pressure (bile ductules), and edges represent canalicular segments with hydrodynamic resistance. Flow is assumed laminar and incompressible, and the network is at steady state.\n\nUse the following fundamental base:\n\n- Poiseuille’s law for laminar flow in a cylindrical tube: $$Q = \\frac{\\pi r^4}{8 \\mu L} \\Delta P,$$ equivalently $$Q = \\frac{\\Delta P}{R}, \\quad R = \\frac{8 \\mu L}{\\pi r^4},$$ where $Q$ is volumetric flow in $\\text{m}^3/\\text{s}$, $\\Delta P = P_i - P_j$ is pressure drop in $\\text{Pa}$, $r$ is radius in $\\text{m}$, $L$ is length in $\\text{m}$, $\\mu$ is dynamic viscosity in $\\text{Pa} \\cdot \\text{s}$, and $R$ is hydraulic resistance in $\\text{Pa} \\cdot \\text{s}/\\text{m}^3$.\n- Kirchhoff-type mass conservation for each interior node $i$: $$\\sum_{j \\in \\mathcal{N}(i)} \\frac{P_i - P_j}{R_{ij}} = s_i,$$ where $\\mathcal{N}(i)$ are neighbors of node $i$, $P_i$ is node pressure in $\\text{Pa}$, $R_{ij}$ is the resistance of edge $(i,j)$, and $s_i$ is the bile secretion rate injected at node $i$ in $\\text{m}^3/\\text{s}$.\n- Boundary nodes (bile ductules) have fixed pressure (Dirichlet condition) $P_b$ and no secretion. Interior nodes (hepatocyte canalicular nodes) have unknown pressures and specified secretion $s_i$.\n\nConstruct the linear system for unknown interior node pressures $\\mathbf{P}$ using the above conservation law, and compute edge flows $$Q_{ij} = \\frac{P_i - P_j}{R_{ij}}.$$ Identify bottlenecks under obstruction by finding the edge indices with the largest absolute pressure drop $$|\\Delta P_{ij}| = |P_i - P_j|.$$ In case of ties within a tolerance $\\tau$, include all tied edges. Use $\\tau = 10^{-9}\\,\\text{Pa}$.\n\nUse parameters that reflect liver microarchitecture:\n\n- Dynamic viscosity: $\\mu = 0.003\\,\\text{Pa}\\cdot\\text{s}$ (a plausible bile viscosity).\n- Graph topology (edge list with indices $e = 0,\\dots,5$):\n  - Edge $0$: $(0,1)$ interior canaliculus, $L = 20\\times 10^{-6}\\,\\text{m}$, base $r = 0.5\\times 10^{-6}\\,\\text{m}$.\n  - Edge $1$: $(1,2)$ interior canaliculus, $L = 20\\times 10^{-6}\\,\\text{m}$, base $r = 0.5\\times 10^{-6}\\,\\text{m}$.\n  - Edge $2$: $(2,3)$ interior canaliculus, $L = 20\\times 10^{-6}\\,\\text{m}$, base $r = 0.5\\times 10^{-6}\\,\\text{m}$.\n  - Edge $3$: $(3,0)$ interior canaliculus, $L = 20\\times 10^{-6}\\,\\text{m}$, base $r = 0.5\\times 10^{-6}\\,\\text{m}$.\n  - Edge $4$: $(0,4)$ canaliculus-to-duct connection, $L = 15\\times 10^{-6}\\,\\text{m}$, base $r = 0.6\\times 10^{-6}\\,\\text{m}$.\n  - Edge $5$: $(2,5)$ canaliculus-to-duct connection, $L = 15\\times 10^{-6}\\,\\text{m}$, base $r = 0.6\\times 10^{-6}\\,\\text{m}$.\n- Node types:\n  - Interior nodes with secretion: $0,1,2,3$.\n  - Boundary (duct) nodes with fixed pressure: $4,5$.\n\nDefine the total duct outflow as the sum of flows directed into the boundary nodes. Convert flows to nanoliters per second by multiplying by $10^{12}$ and report each case’s total duct outflow in $\\text{nL/s}$ rounded to six decimal places. Pressures are in $\\text{Pa}$.\n\nTest suite:\n\n- Case A (baseline classical lobule geometry, uniform canaliculi): Interior secretions $s_0 = 0.3 \\times 10^{-3} \\, \\text{nL/s}$, $s_1 = 0.2 \\times 10^{-3} \\, \\text{nL/s}$, $s_2 = 0.25 \\times 10^{-3} \\, \\text{nL/s}$, $s_3 = 0.25 \\times 10^{-3} \\, \\text{nL/s}$; duct pressure $P_b = 266\\,\\text{Pa}$; no obstructions.\n- Case B (single canalicular obstruction in mid-lobular segment): Same as Case A, but edge $1$ radius reduced to $r_1 = 0.2\\times 10^{-6}\\,\\text{m}$ to model focal cholestasis.\n- Case C (ductal outlet narrowing): Same as Case A, but edge $4$ and edge $5$ radii reduced to $r_4 = r_5 = 0.15\\times 10^{-6}\\,\\text{m}$ to model ductular obstruction.\n- Case D (acinus zone secretion heterogeneity with elevated duct pressure): Interior secretions $s_0 = 0.1 \\times 10^{-3} \\, \\text{nL/s}$, $s_1 = 0.35 \\times 10^{-3} \\, \\text{nL/s}$, $s_2 = 0.05 \\times 10^{-3} \\, \\text{nL/s}$, $s_3 = 0.1 \\times 10^{-3} \\, \\text{nL/s}$; duct pressure $P_b = 400\\,\\text{Pa}$; no obstructions.\n\nTask:\n\n- For each case, construct the resistance $R_e$ for each edge $e$ using the provided $L_e$, $r_e$, and $\\mu$.\n- Solve for $P_i$ at interior nodes by assembling the linear system from the mass conservation equation.\n- Compute $Q_{ij}$ for all edges and determine the total duct outflow (sum of flows into boundary nodes), expressed in $\\text{nL/s}$ rounded to six decimal places.\n- Identify bottleneck edges as those with maximal $|\\Delta P_{ij}|$ (include ties within $\\tau = 10^{-9}\\,\\text{Pa}$) and return their edge indices.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each case result must be the two-element list $[F, B]$ where $F$ is the total duct outflow in $\\text{nL/s}$ (a float rounded to six decimal places) and $B$ is a list of integers with the bottleneck edge indices. The overall output is a single list of these case results, for example, $[[F_1,[...]], [F_2,[...]], [F_3,[...]], [F_4,[...]]]$ without any spaces.",
            "solution": "The problem is valid. It presents a scientifically grounded, well-posed, and objective formulation of bile flow in a simplified hepatic lobule network. The model is based on established principles of fluid dynamics (Poiseuille's law) and mass conservation (Kirchhoff's laws), applied to a defined graph structure with plausible biophysical parameters. All necessary information is provided to construct and solve the resulting system of linear equations.\n\nThe problem requires the determination of pressures and flows in a hydraulic network representing bile canaliculi. The network consists of nodes, representing junctions, and edges, representing canalicular segments. The flow is driven by bile secretion from hepatocytes (source terms at interior nodes) and a pressure gradient towards bile ductules (fixed pressure boundary conditions).\n\nThe foundational principle is Poiseuille's law for laminar flow, which relates volumetric flow rate $Q$ through a cylindrical tube to the pressure drop $\\Delta P$ across it:\n$$Q = \\frac{\\Delta P}{R}$$\nwhere $R$ is the hydraulic resistance. For a canaliculus of length $L$ and radius $r$, with bile of dynamic viscosity $\\mu$, the resistance is given by:\n$$R = \\frac{8 \\mu L}{\\pi r^4}$$\n\nAt steady state, mass must be conserved at each interior node $i$ (a canalicular junction). The total flow out of the node must equal the rate of bile secretion $s_i$ into that node. This is expressed by a Kirchhoff-type law:\n$$\\sum_{j \\in \\mathcal{N}(i)} Q_{ij} = \\sum_{j \\in \\mathcal{N}(i)} \\frac{P_i - P_j}{R_{ij}} = s_i$$\nwhere $\\mathcal{N}(i)$ is the set of nodes neighboring node $i$, $P_i$ and $P_j$ are the pressures at nodes $i$ and $j$ respectively, and $R_{ij}$ is the resistance of the edge connecting them.\n\nThe network specified has $6$ nodes and $6$ edges.\nNodes $0, 1, 2, 3$ are interior nodes with unknown pressures $P_0, P_1, P_2, P_3$ and specified secretion rates $s_0, s_1, s_2, s_3$.\nNodes $4, 5$ are boundary nodes representing bile ductules, with a fixed pressure $P_4 = P_5 = P_b$.\n\nThe mass conservation equations for the four interior nodes form a system of linear equations. Let's arrange the unknown pressures into a vector $\\mathbf{P} = [P_0, P_1, P_2, P_3]^T$. The equation for each interior node $i$ can be expanded as:\n$$P_i \\left( \\sum_{j \\in \\mathcal{N}(i)} \\frac{1}{R_{ij}} \\right) - \\sum_{j \\in \\mathcal{N}(i), j \\text{ is interior}} \\frac{P_j}{R_{ij}} = s_i + \\sum_{k \\in \\mathcal{N}(i), k \\text{ is boundary}} \\frac{P_k}{R_{ik}}$$\n\nThe specific equations for nodes $0, 1, 2, 3$ are:\n- Node $0$: $\\mathcal{N}(0) = \\{1, 3, 4\\}$.\n$$ \\frac{P_0 - P_1}{R_{01}} + \\frac{P_0 - P_3}{R_{03}} + \\frac{P_0 - P_4}{R_{04}} = s_0 \\implies P_0\\left(\\frac{1}{R_{01}} + \\frac{1}{R_{03}} + \\frac{1}{R_{04}}\\right) - \\frac{P_1}{R_{01}} - \\frac{P_3}{R_{03}} = s_0 + \\frac{P_b}{R_{04}} $$\n- Node $1$: $\\mathcal{N}(1) = \\{0, 2\\}$.\n$$ \\frac{P_1 - P_0}{R_{10}} + \\frac{P_1 - P_2}{R_{12}} = s_1 \\implies -\\frac{P_0}{R_{10}} + P_1\\left(\\frac{1}{R_{10}} + \\frac{1}{R_{12}}\\right) - \\frac{P_2}{R_{12}} = s_1 $$\n- Node $2$: $\\mathcal{N}(2) = \\{1, 3, 5\\}$.\n$$ \\frac{P_2 - P_1}{R_{21}} + \\frac{P_2 - P_3}{R_{23}} + \\frac{P_2 - P_5}{R_{25}} = s_2 \\implies -\\frac{P_1}{R_{21}} + P_2\\left(\\frac{1}{R_{21}} + \\frac{1}{R_{23}} + \\frac{1}{R_{25}}\\right) - \\frac{P_3}{R_{23}} = s_2 + \\frac{P_b}{R_{25}} $$\n- Node $3$: $\\mathcal{N}(3) = \\{2, 0\\}$.\n$$ \\frac{P_3 - P_2}{R_{32}} + \\frac{P_3 - P_0}{R_{30}} = s_3 \\implies -\\frac{P_0}{R_{30}} - \\frac{P_2}{R_{32}} + P_3\\left(\\frac{1}{R_{32}} + \\frac{1}{R_{30}}\\right) = s_3 $$\n\nThese equations can be written in matrix form $\\mathbf{A}\\mathbf{P} = \\mathbf{b}$, where $\\mathbf{A}$ is a $4 \\times 4$ conductance matrix and $\\mathbf{b}$ is a $4 \\times 1$ vector of sources and boundary condition contributions.\n\nThe computational procedure for each test case is as follows:\n1.  **Calculate Resistances**: For each of the $6$ edges, calculate the hydraulic resistance $R_e = \\frac{8 \\mu L_e}{\\pi r_e^4}$. The problem provides base values for length $L_e$ and radius $r_e$, and specific cases modify certain radii to simulate obstructions. The dynamic viscosity is $\\mu = 0.003\\,\\text{Pa}\\cdot\\text{s}$.\n2.  **Assemble Linear System**: Construct the matrix $\\mathbf{A}$ and vector $\\mathbf{b}$ based on the equations derived above. The secretion rates $s_i$, given in $\\text{nL/s}$, must first be converted to SI units ($\\text{m}^3/\\text{s}$) by multiplying by $10^{-12}$.\n3.  **Solve for Pressures**: Solve the linear system $\\mathbf{A}\\mathbf{P} = \\mathbf{b}$ to obtain the pressures $P_0, P_1, P_2, P_3$ at the interior nodes.\n4.  **Compute Outflow**: The total outflow to the ducts is the sum of flows into the boundary nodes $4$ and $5$.\n    $$ Q_{total} = Q_{04} + Q_{25} = \\frac{P_0 - P_b}{R_{04}} + \\frac{P_2 - P_b}{R_{25}} $$\n    By conservation of mass for the entire network, this total outflow must equal the total secretion $\\sum s_i$. The result is converted to $\\text{nL/s}$ by multiplying by $10^{12}$ and rounding to six decimal places.\n5.  **Identify Bottlenecks**: Calculate the absolute pressure drop $|\\Delta P_{ij}| = |P_i - P_j|$ for all $6$ edges. The bottleneck edges are those with the maximum absolute pressure drop. Any edge whose $|\\Delta P|$ is within a tolerance $\\tau = 10^{-9}\\,\\text{Pa}$ of the maximum is included in the list of bottleneck indices.\nThe final result for each case is a list containing the total outflow and a list of bottleneck edge indices.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for bile flow and pressure in a simplified hepatic lobule model.\n\n    The function models the canalicular network as a graph. It uses Poiseuille's law\n    and mass conservation to set up a system of linear equations for pressures at\n    interior nodes. It then solves this system for four different test cases,\n    each with unique parameters for secretion, pressure, or canalicular radius.\n\n    For each case, it computes:\n    1. Total duct outflow, which is the sum of flows into the boundary nodes.\n    2. Bottleneck edges, identified as those with the maximal pressure drop.\n\n    The final output is a list of results, with each result containing the\n    outflow and a list of bottleneck edge indices for that case.\n    \"\"\"\n    # Define constants and physical parameters\n    MU = 0.003  # Dynamic viscosity of bile in Pa.s\n    TAU = 1e-9   # Tolerance for bottleneck tie-breaking in Pa\n    NL_PER_S_TO_M3_PER_S = 1e-12  # Conversion factor for nL/s to m^3/s\n\n    # Define the base graph topology and geometry\n    # Edge index: ((node1, node2), Length (m), base Radius (m))\n    base_edges = {\n        0: ((0, 1), 20e-6, 0.5e-6),\n        1: ((1, 2), 20e-6, 0.5e-6),\n        2: ((2, 3), 20e-6, 0.5e-6),\n        3: ((3, 0), 20e-6, 0.5e-6),\n        4: ((0, 4), 15e-6, 0.6e-6),\n        5: ((2, 5), 15e-6, 0.6e-6),\n    }\n\n    # Define node types and mapping for matrix construction\n    interior_nodes = [0, 1, 2, 3]\n    boundary_nodes = [4, 5]\n    node_to_matrix_idx = {node: i for i, node in enumerate(interior_nodes)}\n\n    # Define the test suite\n    test_cases = [\n        # Case A: Baseline\n        {\n            \"s\": {0: 0.3e-3, 1: 0.2e-3, 2: 0.25e-3, 3: 0.25e-3}, # nL/s\n            \"Pb\": 266.0,  # Pa\n            \"r_mods\": {},\n        },\n        # Case B: Single canalicular obstruction\n        {\n            \"s\": {0: 0.3e-3, 1: 0.2e-3, 2: 0.25e-3, 3: 0.25e-3},\n            \"Pb\": 266.0,\n            \"r_mods\": {1: 0.2e-6},\n        },\n        # Case C: Ductal outlet narrowing\n        {\n            \"s\": {0: 0.3e-3, 1: 0.2e-3, 2: 0.25e-3, 3: 0.25e-3},\n            \"Pb\": 266.0,\n            \"r_mods\": {4: 0.15e-6, 5: 0.15e-6},\n        },\n        # Case D: Acinus zone heterogeneity, elevated pressure\n        {\n            \"s\": {0: 0.1e-3, 1: 0.35e-3, 2: 0.05e-3, 3: 0.1e-3},\n            \"Pb\": 400.0,\n            \"r_mods\": {},\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # 1. Calculate hydraulic resistances for the current case\n        resistances = {}\n        \n        def R_calc(L, r):\n            return (8 * MU * L) / (np.pi * r**4)\n\n        for e_idx, (nodes, L, r_base) in base_edges.items():\n            r = case[\"r_mods\"].get(e_idx, r_base)\n            resistances[e_idx] = R_calc(L, r)\n\n        # 2. Assemble the linear system Ax = b for interior node pressures\n        num_interior = len(interior_nodes)\n        A = np.zeros((num_interior, num_interior))\n        b = np.zeros(num_interior)\n        Pb = case[\"Pb\"]\n\n        # Populate b vector with secretion rates (converted to m^3/s)\n        for node_idx, i in node_to_matrix_idx.items():\n            b[i] = case[\"s\"][node_idx] * NL_PER_S_TO_M3_PER_S\n\n        # Populate the conductance matrix A and update b for boundary conditions\n        for e_idx, ((n1, n2), _, _) in base_edges.items():\n            conductance = 1.0 / resistances[e_idx]\n            \n            is_n1_interior = n1 in interior_nodes\n            is_n2_interior = n2 in interior_nodes\n\n            if is_n1_interior and is_n2_interior:\n                i, j = node_to_matrix_idx[n1], node_to_matrix_idx[n2]\n                A[i, i] += conductance\n                A[j, j] += conductance\n                A[i, j] -= conductance\n                A[j, i] -= conductance\n            elif is_n1_interior:  # n2 is boundary\n                i = node_to_matrix_idx[n1]\n                A[i, i] += conductance\n                b[i] += conductance * Pb\n            elif is_n2_interior:  # n1 is boundary\n                j = node_to_matrix_idx[n2]\n                A[j, j] += conductance\n                b[j] += conductance * Pb\n        \n        # 3. Solve for interior pressures\n        P_interior_vec = np.linalg.solve(A, b)\n        \n        # Create a dictionary of all node pressures\n        P = {node: P_interior_vec[idx] for node, idx in node_to_matrix_idx.items()}\n        for node_idx in boundary_nodes:\n            P[node_idx] = Pb\n            \n        # 4. Calculate pressure drops and total outflow\n        delta_P = {}\n        total_outflow_m3_s = 0.0\n\n        for e_idx, ((n1, n2), _, _) in base_edges.items():\n            delta_P[e_idx] = abs(P[n1] - P[n2])\n            \n            # Sum flows into boundary nodes\n            if n1 in interior_nodes and n2 in boundary_nodes:\n                total_outflow_m3_s += (P[n1] - P[n2]) / resistances[e_idx]\n            elif n2 in interior_nodes and n1 in boundary_nodes:\n                total_outflow_m3_s += (P[n2] - P[n1]) / resistances[e_idx]\n        \n        # 5. Identify bottleneck edges\n        max_delta_P = 0.0\n        if delta_P:\n            max_delta_P = max(delta_P.values())\n        \n        bottlenecks = [e_idx for e_idx, dp in delta_P.items() if dp >= max_delta_P - TAU]\n        bottlenecks.sort()\n\n        # 6. Format results for this case\n        total_outflow_nl_s = total_outflow_m3_s / NL_PER_S_TO_M3_PER_S\n        \n        results.append([round(total_outflow_nl_s, 6), bottlenecks])\n\n    # Final print statement must be a single line with no spaces\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}