{
    "hands_on_practices": [
        {
            "introduction": "The long-term health of our tissues relies on the remarkable ability of adult stem cells to maintain a stable population over a lifetime. This principle, known as homeostasis, involves a delicate balance between self-renewal, differentiation, and cell loss. This exercise invites you to model this process for Hematopoietic Stem Cells (HSCs), the progenitors of our blood and immune systems, using a foundational branching process model to derive the precise mathematical condition required for this crucial equilibrium .",
            "id": "4931794",
            "problem": "A Hematopoietic Stem Cell (HSC) divides stochastically in discrete generations according to the following fate options: symmetric self-renewal producing two HSC with probability $p_{s}$, asymmetric division producing one HSC and one committed progenitor with probability $p_{a}$, and symmetric differentiation producing two committed progenitors (and thus zero HSC) with probability $p_{d}$. Assume $p_{s}+p_{a}+p_{d}=1$ and that each newly produced HSC daughter independently survives to the next generation with probability $1-\\alpha$, where $\\alpha \\in [0,1)$ represents niche-mediated attrition or apoptosis. Model the number of HSC as a Galton–Watson branching process with these offspring probabilities and survival.\n\nLet $\\Delta N$ denote the change in HSC number contributed by a single dividing HSC from one generation to the next, so that $\\Delta N = N_{t+1}-N_{t}$ with $N_{t}=1$ for the tracked parent. Using the fundamental definitions of expectation in probability theory and the offspring distribution described above, derive the expected net change $\\mathbb{E}[\\Delta N]$ in terms of $p_{s}$, $p_{a}$, $p_{d}$, and $\\alpha$. Then impose the homeostasis condition $\\mathbb{E}[\\Delta N]=0$ and solve for the self-renewal probability $p_{s}$ required to maintain a steady HSC population as a function of $p_{d}$ and $\\alpha$. Provide your final answer as the closed-form expression for the homeostatic self-renewal probability $p_{s}^{*}$ in terms of $p_{d}$ and $\\alpha$ only. No numerical approximation or rounding is required.",
            "solution": "### Step 1: Extract Givens\n-   A single Hematopoietic Stem Cell (HSC) divides stochastically.\n-   Fate options and their probabilities:\n    -   Symmetric self-renewal (produces $2$ HSCs): probability $p_{s}$.\n    -   Asymmetric division (produces $1$ HSC): probability $p_{a}$.\n    -   Symmetric differentiation (produces $0$ HSCs): probability $p_{d}$.\n-   Constraint on probabilities: $p_{s}+p_{a}+p_{d}=1$.\n-   Each newly produced HSC daughter survives to the next generation with probability $1-\\alpha$.\n-   $\\alpha \\in [0,1)$ is the probability of attrition or apoptosis.\n-   The number of HSCs is modeled as a Galton–Watson branching process.\n-   $\\Delta N$ is the change in HSC number from a single parent HSC, i.e., $\\Delta N = N_{t+1}-N_{t}$ with $N_{t}=1$.\n-   The goal is to derive the expected net change $\\mathbb{E}[\\Delta N]$ and then solve for the homeostatic self-renewal probability $p_{s}^{*}$ (where $\\mathbb{E}[\\Delta N]=0$) as a function of $p_{d}$ and $\\alpha$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem uses a standard Galton-Watson branching process to model stem cell population dynamics. The concepts of symmetric/asymmetric division, self-renewal, differentiation, and apoptosis are fundamental and well-established in stem cell biology and histology. The model is a simplification but is scientifically sound.\n-   **Well-Posed**: The problem is mathematically well-defined. The probabilities are properly constrained, and the variables are clearly described. The task is to derive an expression and solve an equation, which is a standard mathematical procedure. A unique, meaningful solution exists.\n-   **Objective**: The problem is stated in precise, objective language without ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Solution\nThe problem asks for the expected net change in the number of Hematopoietic Stem Cells (HSCs) from one generation to the next, starting with a single HSC. Let $N_t$ be the number of HSCs at generation $t$. We start with a single parent cell, so $N_t = 1$. Let $N_{t+1}$ be the number of surviving HSCs in the next generation that originate from this single parent.\n\nThe process can be broken down into two stages: division and survival.\n\nFirst, the parent HSC divides. Let $D$ be the random variable representing the number of daughter HSCs produced by this division. The probability distribution of $D$ is given by the problem statement:\n-   $P(D=2) = p_{s}$ (symmetric self-renewal)\n-   $P(D=1) = p_{a}$ (asymmetric division)\n-   $P(D=0) = p_{d}$ (symmetric differentiation)\n\nThe expected number of HSCs produced immediately after division, $\\mathbb{E}[D]$, is:\n$$\n\\mathbb{E}[D] = (2 \\times P(D=2)) + (1 \\times P(D=1)) + (0 \\times P(D=0))\n$$\n$$\n\\mathbb{E}[D] = 2p_{s} + p_{a}\n$$\n\nSecond, each of these $D$ daughter cells must survive to be counted in the next generation. Each daughter cell survives independently with a probability of $1-\\alpha$. Let $N_{t+1}$ be the number of surviving HSCs. The expected number of surviving cells, $\\mathbb{E}[N_{t+1}]$, can be found using the law of total expectation: $\\mathbb{E}[N_{t+1}] = \\mathbb{E}[\\mathbb{E}[N_{t+1}|D]]$.\n\nGiven that $D=k$ daughter cells are produced, the number of survivors follows a binomial distribution with $k$ trials and success probability $1-\\alpha$. The expectation of this binomial distribution is $k(1-\\alpha)$.\nSo, $\\mathbb{E}[N_{t+1}|D=k] = k(1-\\alpha)$.\nNow, we can compute the unconditional expectation $\\mathbb{E}[N_{t+1}]$:\n$$\n\\mathbb{E}[N_{t+1}] = \\sum_{k \\in \\{0, 1, 2\\}} \\mathbb{E}[N_{t+1}|D=k] P(D=k)\n$$\n$$\n\\mathbb{E}[N_{t+1}] = [2(1-\\alpha)]p_{s} + [1(1-\\alpha)]p_{a} + [0(1-\\alpha)]p_{d}\n$$\n$$\n\\mathbb{E}[N_{t+1}] = (1-\\alpha)(2p_{s} + p_{a})\n$$\nAlternatively, the expected number of survivors is the expected number of daughters produced multiplied by the individual survival probability: $\\mathbb{E}[N_{t+1}] = \\mathbb{E}[D] \\times (1-\\alpha) = (2p_{s} + p_{a})(1-\\alpha)$.\n\nThe net change in the number of HSCs from this single parent is $\\Delta N = N_{t+1} - N_{t}$. Since we started with one cell, $N_t=1$.\nThe expected net change is:\n$$\n\\mathbb{E}[\\Delta N] = \\mathbb{E}[N_{t+1} - 1] = \\mathbb{E}[N_{t+1}] - 1\n$$\n$$\n\\mathbb{E}[\\Delta N] = (1-\\alpha)(2p_{s} + p_{a}) - 1\n$$\nThis is the expression for the expected net change.\n\nNext, we impose the homeostasis condition, which requires the expected number of HSCs to remain constant. This means the expected net change must be zero: $\\mathbb{E}[\\Delta N] = 0$.\n$$\n(1-\\alpha)(2p_{s} + p_{a}) - 1 = 0\n$$\nThe problem requires the solution for the homeostatic self-renewal probability, denoted $p_{s}^{*}$, as a function of $p_{d}$ and $\\alpha$ only. To achieve this, we must eliminate $p_{a}$ from the equation. We use the given constraint $p_{s} + p_{a} + p_{d} = 1$, which implies $p_{a} = 1 - p_{s} - p_{d}$.\n\nSubstituting this expression for $p_{a}$ into the homeostasis equation:\n$$\n(1-\\alpha)(2p_{s} + (1 - p_{s} - p_{d})) - 1 = 0\n$$\nNow, we simplify the terms inside the parenthesis:\n$$\n(1-\\alpha)(p_{s} + 1 - p_{d}) - 1 = 0\n$$\nWe now solve for $p_{s}$, which under this condition is $p_{s}^{*}$:\n$$\n(1-\\alpha)(p_{s}^{*} + 1 - p_{d}) = 1\n$$\nSince $\\alpha \\in [0, 1)$, the term $1-\\alpha$ is non-zero, so we can divide by it:\n$$\np_{s}^{*} + 1 - p_{d} = \\frac{1}{1-\\alpha}\n$$\nIsolating $p_{s}^{*}$:\n$$\np_{s}^{*} = \\frac{1}{1-\\alpha} - 1 + p_{d}\n$$\nTo simplify the first part of the expression, we find a common denominator:\n$$\np_{s}^{*} = \\frac{1 - (1-\\alpha)}{1-\\alpha} + p_{d}\n$$\n$$\np_{s}^{*} = \\frac{1 - 1 + \\alpha}{1-\\alpha} + p_{d}\n$$\n$$\np_{s}^{*} = \\frac{\\alpha}{1-\\alpha} + p_{d}\n$$\nThis is the final closed-form expression for the homeostatic self-renewal probability $p_{s}^{*}$ in terms of the attrition probability $\\alpha$ and the symmetric differentiation probability $p_{d}$.",
            "answer": "$$\\boxed{\\frac{\\alpha}{1-\\alpha} + p_{d}}$$"
        },
        {
            "introduction": "While adult stem cells focus on maintenance, embryonic stem cells (ESCs) are masters of expansion, capable of rapid proliferation in culture. This practice shifts our focus from the steady state of homeostasis to the dynamics of population growth, a key process in both developmental biology and laboratory research. By deriving a growth equation from first principles, you will build a realistic model that accounts not only for cell division but also for the inevitable losses from apoptosis and differentiation that occur in any real-world stem cell culture .",
            "id": "4931811",
            "problem": "A culture of mouse embryonic stem cells (ESCs) is initiated at time $t=0$ with $N_0=12$ undifferentiated, viable stem cells. ESCs undergo symmetric division, meaning each stem cell completes a cell cycle and produces two daughter cells, with a mean cell cycle time $t_c=18$ hours. Assume the culture is synchronized and unconstrained by nutrients or contact inhibition over the time of observation so that all cells complete each cycle on time. After each division, each daughter cell independently may undergo apoptosis (programmed cell death) with probability $a$ per cycle and may independently differentiate (lose stem identity) with probability $d$ per cycle. A daughter cell contributes to the stem cell colony count only if it remains both viable and undifferentiated.\n\nStarting from core definitions in histology and embryology of symmetric division and the probabilistic concept of expected value, and without assuming any pre-given population growth formula, derive an expression for the expected number of undifferentiated, viable stem cells $N_{\\text{exp}}(T)$ as a function of $N_0$, $t_c$, $T$, $a$, and $d$, for a total observation time $T$ that is an integer multiple of $t_c$. Then, using the parameters $T=54$ hours, $a=0.07$, and $d=0.12$, compute the expected number of undifferentiated, viable stem cells at time $T$, and round your final numerical answer to four significant figures. Express the final result as a pure number (no units).\n\nBriefly explain, in your derivation, why the expected colony size deviates from the no-loss symmetric division baseline in the presence of apoptosis and differentiation, referencing the definitions above. You may assume independence across cells and independence between apoptosis and differentiation events for each daughter cell within a cycle.",
            "solution": "The problem asks for the derivation of an expression for the expected number of undifferentiated, viable stem cells, $N_{\\text{exp}}(T)$, in a culture over a time $T$, and then to compute this value for a given set of parameters. The derivation must start from fundamental principles without assuming a pre-existing population growth formula.\n\nLet us first define the parameters and the process.\nThe initial number of undifferentiated, viable stem cells at time $t=0$ is $N_0$.\nThe cell cycle time is $t_c$.\nThe total observation time is $T$, which is an integer multiple of $t_c$. Therefore, the number of completed cell cycles is $k = \\frac{T}{t_c}$.\nThe division is symmetric, meaning one parent stem cell produces two daughter cells.\nAfter division, each daughter cell faces two independent possibilities of being lost from the undifferentiated stem cell pool:\n1. Apoptosis (cell death) with probability $a$.\n2. Differentiation with probability $d$.\n\nA daughter cell remains a viable, undifferentiated stem cell only if it neither undergoes apoptosis nor differentiates. Let's determine the probability of this outcome for a single daughter cell.\nLet $A$ be the event of apoptosis and $D$ be the event of differentiation. We are given $P(A) = a$ and $P(D) = d$.\nThe event that a cell survives is the complement of $A$, denoted $A^c$, with probability $P(A^c) = 1 - P(A) = 1-a$.\nThe event that a cell remains undifferentiated is the complement of $D$, denoted $D^c$, with probability $P(D^c) = 1 - P(D) = 1-d$.\nSince the events of apoptosis and differentiation are stated to be independent for each daughter cell, the probability that a daughter cell both survives and remains undifferentiated is the product of their individual probabilities:\n$$P(A^c \\cap D^c) = P(A^c) P(D^c) = (1-a)(1-d)$$\nLet's denote this success probability for a single daughter cell as $p_s = (1-a)(1-d)$.\n\nNow, consider a single parent stem cell at the beginning of a cycle. It divides into two daughter cells. We want to find the expected number of viable, undifferentiated stem cells produced from this single parent cell in one cycle. Let $X$ be the random variable representing the number of successful daughter cells from one parent. $X$ can take values $0$, $1$, or $2$. We can find the expected value of $X$, $E[X]$, using the linearity of expectation.\nLet $X_1$ and $X_2$ be indicator variables for the two daughter cells. $X_i=1$ if daughter cell $i$ remains a viable, undifferentiated stem cell, and $X_i=0$ otherwise. The probability that $X_i=1$ is $p_s$.\nThe expected value of an indicator variable is the probability of the event it indicates, so $E[X_i] = p_s$.\nThe total number of successful daughter cells is $X = X_1 + X_2$. By linearity of expectation:\n$$E[X] = E[X_1 + X_2] = E[X_1] + E[X_2] = p_s + p_s = 2p_s$$\nSubstituting the expression for $p_s$:\n$$E[X] = 2(1-a)(1-d)$$\nThis is the expected number of viable, undifferentiated stem cells produced by a single stem cell in one cycle. Let us call this factor the expected net growth factor per cycle, $R_{\\text{exp}} = 2(1-a)(1-d)$.\n\nNext, we derive the recurrence relation for the expected number of cells in the entire population. Let $N_{\\text{exp}}(k)$ be the expected number of viable, undifferentiated stem cells after $k$ cycles. The initial condition is $N_{\\text{exp}}(0) = N_0$.\nAt the beginning of cycle $k+1$, we have an expected number of $N_{\\text{exp}}(k)$ cells. Since each cell's fate is independent of the others, we can use the law of total expectation. The expected number of cells after one more cycle, $N_{\\text{exp}}(k+1)$, is the expected number of cells at the start of the cycle, $N_{\\text{exp}}(k)$, multiplied by the expected number of successful progeny per cell, $R_{\\text{exp}}$.\n$$N_{\\text{exp}}(k+1) = N_{\\text{exp}}(k) \\cdot R_{\\text{exp}} = N_{\\text{exp}}(k) \\cdot [2(1-a)(1-d)]$$\nThis is a geometric progression for the expected cell number. We can solve it by unrolling the recurrence:\n$N_{\\text{exp}}(1) = N_{\\text{exp}}(0) \\cdot R_{\\text{exp}} = N_0 \\cdot R_{\\text{exp}}$\n$N_{\\text{exp}}(2) = N_{\\text{exp}}(1) \\cdot R_{\\text{exp}} = (N_0 \\cdot R_{\\text{exp}}) \\cdot R_{\\text{exp}} = N_0 \\cdot R_{\\text{exp}}^2$\nBy induction, the general solution for $k$ cycles is:\n$$N_{\\text{exp}}(k) = N_0 \\cdot R_{\\text{exp}}^k = N_0 \\cdot [2(1-a)(1-d)]^k$$\nTo express this as a function of total time $T$, we substitute $k = T/t_c$:\n$$N_{\\text{exp}}(T) = N_0 \\cdot [2(1-a)(1-d)]^{T/t_c}$$\nThis is the desired general expression for the expected number of undifferentiated, viable stem cells.\n\nThe problem also asks for an explanation of why the expected colony size deviates from the no-loss symmetric division baseline. In the baseline case, there is no loss, which means the probability of apoptosis $a=0$ and the probability of differentiation $d=0$. The growth factor per cycle would be $R_{\\text{ideal}} = 2(1-0)(1-0) = 2$. The population would grow as $N(k) = N_0 \\cdot 2^k$. This represents the maximum possible rate of expansion where every division doubles the stem cell number. In the presence of apoptosis and differentiation, where $a>0$ and $d>0$, the factors $(1-a)$ and $(1-d)$ are both less than $1$. Consequently, the actual expected growth factor $R_{\\text{exp}} = 2(1-a)(1-d)$ is strictly less than $2$. This is because apoptosis and differentiation act as \"leaks\" in the system, removing a fraction of the newly produced cells from the undifferentiated, viable stem cell pool in each cycle. The term $(1-a)(1-d)$ represents the fraction of daughter cells that successfully self-renew, and thus the overall growth rate is reduced.\n\nFinally, we compute the numerical value for the given parameters:\nInitial cell number: $N_0 = 12$\nCell cycle time: $t_c = 18$ hours\nTotal observation time: $T = 54$ hours\nApoptosis probability: $a = 0.07$\nDifferentiation probability: $d = 0.12$\n\nFirst, we calculate the number of cell cycles, $k$:\n$$k = \\frac{T}{t_c} = \\frac{54 \\text{ hours}}{18 \\text{ hours}} = 3$$\nNext, we calculate the expected net growth factor per cycle, $R_{\\text{exp}}$:\n$$R_{\\text{exp}} = 2(1-a)(1-d) = 2(1-0.07)(1-0.12) = 2(0.93)(0.88)$$\n$$R_{\\text{exp}} = 1.6368$$\nNow, we use the derived formula to find the expected number of cells after $3$ cycles:\n$$N_{\\text{exp}}(T) = N_0 \\cdot (R_{\\text{exp}})^k = 12 \\cdot (1.6368)^3$$\nCalculating the power:\n$$(1.6368)^3 \\approx 4.3850518$$\nMultiplying by the initial number of cells:\n$$N_{\\text{exp}}(T) = 12 \\cdot 4.3850518 \\approx 52.6206216$$\nThe problem requires rounding the final answer to four significant figures. The fifth significant figure is $0$, so we round down.\n$$N_{\\text{exp}}(T) \\approx 52.62$$",
            "answer": "$$\\boxed{52.62}$$"
        },
        {
            "introduction": "Modern biology increasingly relies on computational tools to formalize and test complex concepts. This exercise challenges you to translate the qualitative biological definition of pluripotency—the ability to form all three germ layers—into a precise, algorithmic test. Using the language of graph theory, you will model differentiation pathways and implement a search algorithm to determine if a given cell state meets the rigorous criteria for pluripotency, bridging the gap between descriptive biology and computational logic .",
            "id": "4931821",
            "problem": "You are given the task of formalizing pluripotency in a directed state-transition model of stem cell differentiation and implementing an algorithm to test pluripotency for specified starting states. The biological foundation is that pluripotency is the capacity to give rise to derivatives of all three embryonic germ layers: ectoderm, mesoderm, and endoderm. A node in a lineage graph represents a cellular state. A directed edge represents a permissible differentiation transition from one state to another. A node is pluripotent if it can reach all three germ layer terminal nodes under the permissible transitions.\n\nFundamental base:\n- Pluripotency definition in developmental biology: a pluripotent cell can differentiate into derivatives of all three germ layers (ectoderm, mesoderm, endoderm).\n- Directed graph reachability: In a directed graph $G=(V,E)$, node $t$ is reachable from node $s$ if there exists a directed path of length $\\ge 0$ from $s$ to $t$.\n\nFormally, let $G=(V,E)$ be a directed graph where $V$ is the set of lineage states and $E \\subseteq V \\times V$ encodes permissible transitions. Let $T=\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$ denote the set of terminal germ layer nodes. Define the reachability predicate $R_G(s,t)$ as true if and only if there exists a directed path of length $\\ge 0$ from $s$ to $t$ in $G$. Define the pluripotency predicate:\n$$\nP_G(s) = \\bigwedge_{t \\in T} R_G(s,t),\n$$\nthat is, $P_G(s)$ is true if and only if $s$ can reach all three germ layer terminals in $T$.\n\nYour program must implement a graph-search algorithm to evaluate $P_G(s)$ for given test cases. The program should be deterministic and must not require any external input. It must produce a single line of output formatted exactly as a comma-separated list of boolean results enclosed in square brackets (for example, `[True,False]`).\n\nTest suite:\nProvide results for the following $8$ directed graphs and query nodes, designed to probe a \"happy path\", restricted multipotency, terminal commitment, cycles, and missing targets. For each graph $G_i=(V_i,E_i)$, the set $T$ is assumed to be the same $\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$.\n\n- Test case $1$: $G_1$ models an Embryonic Stem Cell (ESC). \n  $V_1=\\{\\mathrm{ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_1=\\{(\\mathrm{ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$.\n  Query $s_1=\\mathrm{ESC}$. Expected biological behavior: pluripotent.\n\n- Test case $2$: $G_2$ models an Induced Pluripotent Stem Cell (iPSC) reprogrammed to an ESC-like state.\n  $V_2=\\{\\mathrm{iPSC},\\mathrm{ESC\\_like},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_2=\\{(\\mathrm{iPSC},\\mathrm{ESC\\_like}),(\\mathrm{ESC\\_like},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$.\n  Query $s_2=\\mathrm{iPSC}$. Expected biological behavior: pluripotent.\n\n- Test case $3$: $G_3$ models a Hematopoietic Stem Cell (HSC), an Adult Stem Cell (ASC) that is multipotent toward mesoderm derivatives.\n  $V_3=\\{\\mathrm{HSC},\\mathrm{Mesoderm},\\mathrm{Ectoderm},\\mathrm{Endoderm}\\}$,\n  $E_3=\\{(\\mathrm{HSC},\\mathrm{Mesoderm})\\}$.\n  Query $s_3=\\mathrm{HSC}$. Expected biological behavior: not pluripotent.\n\n- Test case $4$: $G_4$ models a Neural Stem Cell (NSC), an ectoderm-restricted progenitor.\n  $V_4=\\{\\mathrm{NSC},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_4=\\{(\\mathrm{NSC},\\mathrm{Ectoderm})\\}$.\n  Query $s_4=\\mathrm{NSC}$. Expected biological behavior: not pluripotent.\n\n- Test case $5$: $G_5$ models the Epiblast, which can generate all three germ layers.\n  $V_5=\\{\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_5=\\{(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$.\n  Query $s_5=\\mathrm{Epiblast}$. Expected biological behavior: pluripotent.\n\n- Test case $6$: $G_6$ models an ESC graph missing the endoderm transition.\n  $V_6=\\{\\mathrm{ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm}\\}$,\n  $E_6=\\{(\\mathrm{ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm})\\}$.\n  Query $s_6=\\mathrm{ESC}$. Expected biological behavior: not pluripotent because endoderm is unreachable.\n\n- Test case $7$: $G_7$ includes a cycle between a primed pluripotent state and the epiblast but retains access to all three germ layers.\n  $V_7=\\{\\mathrm{Primed\\_ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_7=\\{(\\mathrm{Primed\\_ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Primed\\_ESC}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$.\n  Query $s_7=\\mathrm{Primed\\_ESC}$. Expected biological behavior: pluripotent.\n\n- Test case $8$: $G_8$ queries a terminal node directly.\n  $V_8=\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$,\n  $E_8=\\varnothing$.\n  Query $s_8=\\mathrm{Ectoderm}$. Expected biological behavior: not pluripotent because it cannot reach the other two germ layers.\n\nOutput specification:\n- Your program should produce a single line of output containing the results for test cases $1$ through $8$ in order, as a comma-separated list enclosed in square brackets, for example `[True,False,...]`.\n- No physical units, angle units, or percentages are involved; outputs are booleans.",
            "solution": "The problem requires us to formalize and test the biological concept of pluripotency using a directed graph model. The provided definition of pluripotency is based on fundamental principles of developmental biology and graph theory, making the problem scientifically and mathematically sound.\n\nA cellular state is considered pluripotent if it can differentiate into cells of all three primary germ layers: ectoderm, mesoderm, and endoderm. In the given model, this is translated into a graph-theoretic problem of reachability. A directed graph $G=(V,E)$ is used, where $V$ represents the set of cell states (nodes) and $E$ represents the set of permissible differentiation transitions (directed edges). The three germ layers are represented by a fixed set of terminal nodes, $T=\\{\\mathrm{Ectoderm}, \\mathrm{Mesoderm}, \\mathrm{Endoderm}\\}$.\n\nThe pluripotency of a state $s \\in V$ is evaluated using the predicate $P_G(s)$, which is defined as:\n$$\nP_G(s) = \\bigwedge_{t \\in T} R_G(s,t)\n$$\nHere, $R_G(s,t)$ is a reachability predicate, which is true if and only if there exists a directed path of length greater than or equal to $0$ from state $s$ to state $t$. A path of length $0$ implies that any node is reachable from itself. The logical conjunction ($\\bigwedge$) signifies that for $s$ to be pluripotent, it must be able to reach *every* terminal node in the set $T$.\n\nTo implement a solution, we must devise an algorithm to check the predicate $P_G(s)$ for each of the $8$ given test cases. This involves verifying reachability from a given starting node $s_i$ to all three target nodes in $T$ within each graph $G_i$.\n\nThe core of the problem is resolving the reachability predicate $R_G(s,t)$. A standard and efficient algorithm for determining reachability in a directed graph is the Breadth-First Search (BFS). For a given start node $s$ and a target node $t$, BFS systematically explores the graph layer by layer, guaranteeing that it finds a path to $t$ if one exists. The algorithm maintains a queue of nodes to visit and a set of visited nodes to avoid redundant exploration and to correctly handle graphs with cycles (as in test case $7$).\n\nThe overall algorithm to evaluate $P_G(s)$ is as follows:\n$1$. For a given graph $G=(V,E)$ and a query node $s$, iterate through each target node $t$ in the set $T=\\{\\mathrm{Ectoderm}, \\mathrm{Mesoderm}, \\mathrm{Endoderm}\\}$.\n$2$. For each $t$, determine if it is reachable from $s$. This is done by performing a BFS traversal starting from $s$.\n   $a$. An important initial check is whether the target node $t$ exists in the graph's vertex set $V$. If $t \\notin V$, no path from any $s \\in V$ to $t$ can exist, so $R_G(s,t)$ is false. This is relevant for test case $6$, where the graph $G_6$ is missing the $\\mathrm{Endoderm}$ node.\n   $b$. The BFS traversal begins by placing $s$ into a queue. It then repeatedly extracts a node from the queue, and for each of its unvisited neighbors, marks them as visited and adds them to the queue. The search terminates with success if $t$ is encountered. If the queue becomes empty and $t$ has not been found, $t$ is not reachable from $s$.\n$3$. If any target $t \\in T$ is found to be unreachable from $s$, the conjunction $P_G(s)$ becomes false. The algorithm can terminate early for that test case and report the result as `False`.\n$4$. If the algorithm successfully verifies that all three nodes in $T$ are reachable from $s$, then $P_G(s)$ is true.\n\nThis procedure is applied to each of the $8$ test cases provided. The graph for each test case is constructed as an adjacency list, which is a mapping from each node to a list of its direct successors, as defined by the edge set $E_i$. This data structure is highly efficient for graph traversal algorithms like BFS. The final output is an ordered list of the boolean evaluation results for $P_{G_1}(s_1), P_{G_2}(s_2), \\dots, P_{G_8}(s_8)$.",
            "answer": "```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Solves the pluripotency evaluation problem for a series of test cases.\n    \"\"\"\n    \n    # The fixed set of terminal germ layer nodes.\n    T = {\"Ectoderm\", \"Mesoderm\", \"Endoderm\"}\n\n    # Define the 8 test cases as specified in the problem.\n    # Each case is a tuple: (Vertex set V, Edge set E, start node s).\n    test_cases = [\n        # Test case 1: ESC\n        (\n            {\"ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"ESC\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"ESC\"\n        ),\n        # Test case 2: iPSC\n        (\n            {\"iPSC\", \"ESC_like\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"iPSC\", \"ESC_like\"), (\"ESC_like\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"iPSC\"\n        ),\n        # Test case 3: HSC (multipotent, not pluripotent)\n        (\n            {\"HSC\", \"Mesoderm\", \"Ectoderm\", \"Endoderm\"},\n            {(\"HSC\", \"Mesoderm\")},\n            \"HSC\"\n        ),\n        # Test case 4: NSC (unipotent/multipotent, not pluripotent)\n        (\n            {\"NSC\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"NSC\", \"Ectoderm\")},\n            \"NSC\"\n        ),\n        # Test case 5: Epiblast\n        (\n            {\"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"Epiblast\"\n        ),\n        # Test case 6: Missing Endoderm target node\n        (\n            {\"ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\"},\n            {(\"ESC\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\")},\n            \"ESC\"\n        ),\n        # Test case 7: Graph with a cycle\n        (\n            {\"Primed_ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"Primed_ESC\", \"Epiblast\"), (\"Epiblast\", \"Primed_ESC\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"Primed_ESC\"\n        ),\n        # Test case 8: Querying a terminal node\n        (\n            {\"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            set(), # Empty edge set\n            \"Ectoderm\"\n        )\n    ]\n\n    def is_reachable(adj_list, vertex_set, start_node, target_node):\n        \"\"\"\n        Determines if a target_node is reachable from a start_node using BFS.\n        A path of length >= 0 is considered.\n        \"\"\"\n        # A node is not reachable if it's not part of the graph's vertex set.\n        if target_node not in vertex_set:\n            return False\n\n        # A node is always reachable from itself (path of length 0).\n        if start_node == target_node:\n            return True\n\n        q = deque([start_node])\n        visited = {start_node}\n\n        while q:\n            current_node = q.popleft()\n            \n            # Get neighbors from adjacency list\n            neighbors = adj_list.get(current_node, [])\n            \n            for neighbor in neighbors:\n                if neighbor == target_node:\n                    return True\n                if neighbor not in visited:\n                    visited.add(neighbor)\n                    q.append(neighbor)\n        \n        return False\n\n    def check_pluripotency(V, E, s, T_targets):\n        \"\"\"\n        Evaluates the pluripotency predicate P_G(s).\n        \"\"\"\n        # Build adjacency list from the edge set for efficient traversal.\n        adj_list = {}\n        for u, v in E:\n            if u not in adj_list:\n                adj_list[u] = []\n            adj_list[u].append(v)\n            \n        # Check reachability for every target in T.\n        for target in T_targets:\n            if not is_reachable(adj_list, V, s, target):\n                return False # If any target is not reachable, P_G(s) is false.\n        \n        # If all targets were reachable, P_G(s) is true.\n        return True\n\n    results = []\n    for V_i, E_i, s_i in test_cases:\n        result = check_pluripotency(V_i, E_i, s_i, T)\n        results.append(result)\n\n    # Format the output as a comma-separated list of booleans in brackets.\n    output_str = f\"[{','.join(str(r) for r in results)}]\"\n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}