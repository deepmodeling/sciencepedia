{
    "hands_on_practices": [
        {
            "introduction": "突触囊泡是神经传递的基本单位，每个囊泡都携带一个“量子”的神经递质。谷氨酸等神经递质的装载是一个主动过程，由质子梯度驱动，将细胞能量（V-型ATP酶）与化学物质的储存联系起来。这项练习  让我们能从化学和几何学的基本原理出发，估算单个囊泡的容量，从而具体理解一个神经递质“量子包”在分子层面上的实际含义。",
            "id": "4933332",
            "problem": "在化学突触的突触前末梢中，一个球形突触囊泡被V型腺苷三磷酸酶（V-ATPase）酸化，建立起囊泡内酸度，从而驱动囊泡谷氨酸转运体（VGLUT）摄取谷氨酸。考虑一个半径为 $r=25\\,\\mathrm{nm}$ 的囊泡，其内腔初始 $\\mathrm{pH}=5.5$。假设囊泡内腔表现为理想溶液：活度等于浓度，且缓冲容量在相关pH范围内恒定。设在此pH下，囊泡内腔的缓冲容量为 $\\beta=0.10\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 每pH单位，并假设VGLUT每转运一个谷氨酸分子消耗一个质子当量。装载过程持续到囊泡内腔的pH达到7.0，此时摄取停止。\n\n请仅使用pH和缓冲容量的定义，以及上述化学计量耦合关系，从第一性原理推导出每个囊泡装载的谷氨酸分子数的表达式，并计算其值。使用阿伏伽德罗常数 $N_{\\!A}=6.022\\times 10^{23}\\,\\mathrm{mol}^{-1}$ 和 $1\\,\\mathrm{m}^{3}=1000\\,\\mathrm{L}$。将您的最终结果四舍五入至三位有效数字，并以纯分子数（无单位）报告。",
            "solution": "问题要求计算当球形突触囊泡内部pH变化时，装载的谷氨酸分子总数，记为 $N_{glu}$。\n\n首先，我们建立谷氨酸转运和质子消耗之间的关系。问题指出，囊泡谷氨酸转运体（VGLUT）每转运一个谷氨酸分子消耗一个质子当量。这提供了一个直接的化学计量关系：装载的谷氨酸分子数等于消耗的质子数。\n$$N_{glu} = N_{H^+}$$\n其中 $N_{H^+}$ 是在装载过程中消耗的质子总数。\n\n质子数 $N_{H^+}$ 可以通过质子的摩尔量 $n_{H^+}$ 和阿伏伽德罗常数 $N_{\\!A}$ 计算得出：\n$$N_{H^+} = n_{H^+} N_{\\!A}$$\n\n问题的核心是确定 $n_{H^+}$，即当囊泡内部pH从初始值 $\\mathrm{pH}_{initial}$ 上升到最终值 $\\mathrm{pH}_{final}$ 时消耗的质子总摩尔量。这些质子从囊泡内腔中被移出，而它们的移除被内腔缓冲体系释放的质子以及自由质子浓度的变化所抵消。\n\n缓冲容量 $\\beta$ 定义为使pH增加一个单位所需强碱的量（单位为摩尔/升）。其形式上表示为 $\\beta = \\frac{dC_B}{d\\mathrm{pH}}$，其中 $C_B$ 是加入碱的摩尔浓度。在这个问题中，消耗质子在化学上等同于加入强碱。问题指出，在相关pH范围内 $\\beta$ 是恒定的。因此，我们可以通过对有限的pH变化进行积分，来求得消耗的质子总摩尔浓度，我们将其记为 $\\Delta C_{H^+}$：\n$$\\Delta C_{H^+} = \\int_{\\mathrm{pH}_{initial}}^{\\mathrm{pH}_{final}} \\beta \\, d\\mathrm{pH} = \\beta \\int_{\\mathrm{pH}_{initial}}^{\\mathrm{pH}_{final}} d\\mathrm{pH} = \\beta (\\mathrm{pH}_{final} - \\mathrm{pH}_{initial})$$\n这个量 $\\Delta C_{H^+}$ 代表了从溶液中移出的质子总浓度，它既包括了自由 $[H^+]$ 的变化，也包括了缓冲体系为抵抗pH变化而释放的质子。\n\n消耗的质子总摩尔量 $n_{H^+}$ 是这个浓度变化与囊泡体积 $V$ 的乘积：\n$$n_{H^+} = \\Delta C_{H^+} \\times V$$\n\n囊泡是半径为 $r$ 的球体，所以其体积由以下公式给出：\n$$V = \\frac{4}{3}\\pi r^3$$\n\n结合这些方程，我们可以推导出装载的谷氨酸分子数的表达式：\n$$N_{glu} = n_{H^+} N_{\\!A} = (\\Delta C_{H^+} \\times V) N_{\\!A} = \\left[ \\beta (\\mathrm{pH}_{final} - \\mathrm{pH}_{initial}) \\times \\left(\\frac{4}{3}\\pi r^3\\right) \\right] N_{\\!A}$$\n\n现在，我们代入给定的数值来计算结果。\n给定的数值如下：\n半径, $r = 25\\,\\mathrm{nm} = 25 \\times 10^{-9}\\,\\mathrm{m}$。\n初始pH, $\\mathrm{pH}_{initial} = 5.5$。\n最终pH, $\\mathrm{pH}_{final} = 7.0$。\n缓冲容量, $\\beta = 0.10\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 每pH单位。\n阿伏伽德罗常数, $N_{\\!A} = 6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n体积换算, $1\\,\\mathrm{m}^3 = 1000\\,\\mathrm{L}$，这意味着 $1\\,\\mathrm{L} = 10^{-3}\\,\\mathrm{m}^3$。\n\n首先，计算pH的变化量：\n$$\\Delta \\mathrm{pH} = \\mathrm{pH}_{final} - \\mathrm{pH}_{initial} = 7.0 - 5.5 = 1.5$$\n\n接下来，计算消耗的质子总浓度 $\\Delta C_{H^+}$：\n$$\\Delta C_{H^+} = \\beta \\times \\Delta \\mathrm{pH} = (0.10\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}) \\times 1.5 = 0.15\\,\\mathrm{mol}\\,\\mathrm{L}^{-1}$$\n\n为了保持单位一致性，我们将此浓度转换为国际单位制（SI）单位 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$：\n$$\\Delta C_{H^+} = 0.15\\,\\frac{\\mathrm{mol}}{\\mathrm{L}} \\times \\frac{1000\\,\\mathrm{L}}{1\\,\\mathrm{m}^3} = 150\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$$\n\n接下来，计算囊泡的体积 $V$（单位为 $\\mathrm{m}^3$）：\n$$V = \\frac{4}{3}\\pi r^3 = \\frac{4}{3}\\pi (25 \\times 10^{-9}\\,\\mathrm{m})^3 = \\frac{4}{3}\\pi (15625 \\times 10^{-27}\\,\\mathrm{m}^3) \\approx 6.54498 \\times 10^{-23}\\,\\mathrm{m}^3$$\n\n现在，计算消耗的质子总摩尔量 $n_{H^+}$：\n$$n_{H^+} = \\Delta C_{H^+} \\times V = (150\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}) \\times (6.54498 \\times 10^{-23}\\,\\mathrm{m}^3) \\approx 9.81747 \\times 10^{-21}\\,\\mathrm{mol}$$\n\n最后，计算谷氨酸分子的总数 $N_{glu}$：\n$$N_{glu} = n_{H^+} N_{\\!A} = (9.81747 \\times 10^{-21}\\,\\mathrm{mol}) \\times (6.022 \\times 10^{23}\\,\\mathrm{mol}^{-1})$$\n$$N_{glu} \\approx 5912.35$$\n\n问题要求将最终结果四舍五入到三位有效数字。\n$$N_{glu} \\approx 5910$$\n这可以写成科学记数法 $5.91 \\times 10^3$，以明确表示有效数字的位数。",
            "answer": "$$\\boxed{5.91 \\times 10^{3}}$$"
        },
        {
            "introduction": "虽然囊泡提供了离散的神经递质包，但它们在动作电位到达时是否释放却是一个概率性事件，而非必然发生。二项式模型为描述这一随机过程提供了一个强大的框架，其中每个释放位点都可被视为一次独立的“伯努利试验”。通过推导突触后反应的关键统计量 ，你将学习神经科学家如何将突触的微观参数（如释放位点数 $N$、释放概率 $p$ 和量子大小 $q$）与他们测量到的多变的电信号联系起来。",
            "id": "4933300",
            "problem": "一个中枢兴奋性突触从结构角度被建模为具有 $N$ 个独立的突触前释放位点（例如，活性区或准备释放的囊泡）。当单个突触前动作电位到达神经末梢时，每个位点最多可以释放1个突触囊泡。做出以下假设：\n\n- 每个位点以概率 $p$ 释放一个囊泡，且与其他位点和试验无关。\n- 如果一个位点释放了一个囊泡，它会产生一个固定幅值为 $q$ （量子大小）的量子化突触后电流。如果没有囊泡被释放，该位点对电流的贡献为 $0$。\n- 在所有位点和试验中，$q$ 是恒定的，并且突触后噪声可以忽略不计。\n\n设诱发的兴奋性突触后电流（EPSC）的幅值为随机变量 $A$，定义为在这些假设下所有 $N$ 个位点贡献的总和。\n\n从伯努利试验、期望的线性性以及独立随机变量的方差可加性的基本定义出发，推导出平均EPSC幅值 $\\mathbb{E}[A]$ 和 $A$ 的变异系数 $\\mathrm{CV}$ 的闭式表达式，其中 $\\mathrm{CV}$ 定义为 $\\mathrm{CV} = \\sqrt{\\operatorname{Var}(A)} \\big/ \\mathbb{E}[A]$。\n\n将最终答案表示为两个用 $N$、$p$ 和 $q$ 表示的符号表达式，并按顺序报告：首先是平均值 $\\mathbb{E}[A]$，然后是变异系数 $\\mathrm{CV}$。不要代入数值。仅提供最终表达式，不带单位。",
            "solution": "问题要求基于突触传递的二项模型，推导平均兴奋性突触后电流（EPSC）幅值 $\\mathbb{E}[A]$ 及其变异系数 $\\mathrm{CV}$。推导将按要求从基本原理出发。\n\n设 $A_i$ 为第 $i$ 个释放位点贡献的突触后电流的随机变量，其中 $i = 1, 2, \\ldots, N$。总EPSC幅值 $A$ 是所有 $N$ 个独立位点贡献的总和：\n$$A = \\sum_{i=1}^{N} A_i$$\n根据问题陈述，每个位点 $i$ 以概率 $p$ 释放一个囊泡，产生一个幅值为 $q$ 的电流。以概率 $1-p$ 不释放囊泡，电流贡献为 $0$。因此，随机变量 $A_i$ 以概率 $p$ 取值 $q$，以概率 $1-p$ 取值 $0$。\n\n为了将其形式化，我们可以为每个位点定义一个伯努利随机变量 $X_i$，其中，如果释放了一个囊泡（“成功”），则 $X_i=1$；如果没有释放囊泡（“失败”），则 $X_i=0$。成功的概率是 $P(X_i=1) = p$。那么来自位点 $i$ 的电流可以写成 $A_i = q X_i$。\n\n首先，我们推导平均EPSC幅值 $\\mathbb{E}[A]$。利用期望的线性性，和的期望等于期望的和：\n$$\\mathbb{E}[A] = \\mathbb{E}\\left[\\sum_{i=1}^{N} A_i\\right] = \\sum_{i=1}^{N} \\mathbb{E}[A_i]$$\n现在，我们求单个位点 $A_i$ 的电流期望：\n$$\\mathbb{E}[A_i] = \\mathbb{E}[q X_i] = q \\mathbb{E}[X_i]$$\n根据定义，伯努利随机变量 $X_i$ 的期望是：\n$$\\mathbb{E}[X_i] = (1) \\cdot P(X_i=1) + (0) \\cdot P(X_i=0) = 1 \\cdot p + 0 \\cdot (1-p) = p$$\n将此代回，单个位点的期望电流为：\n$$\\mathbb{E}[A_i] = qp$$\n由于所有 $N$ 个位点都是相同且独立的，它们都有相同的期望贡献。因此，总的平均EPSC幅值为：\n$$\\mathbb{E}[A] = \\sum_{i=1}^{N} (qp) = Nqp$$\n\n接下来，我们推导变异系数 $\\mathrm{CV} = \\sqrt{\\operatorname{Var}(A)} \\big/ \\mathbb{E}[A]$。这需要计算 $A$ 的方差 $\\operatorname{Var}(A)$。\n因为假设 $N$ 个位点的释放事件是独立的，所以随机变量 $A_i$ 是独立的。对于独立随机变量的和，和的方差等于方差的和（方差可加性）：\n$$\\operatorname{Var}(A) = \\operatorname{Var}\\left(\\sum_{i=1}^{N} A_i\\right) = \\sum_{i=1}^{N} \\operatorname{Var}(A_i)$$\n我们需要单个位点电流的方差 $\\operatorname{Var}(A_i)$。使用性质 $\\operatorname{Var}(cX) = c^2 \\operatorname{Var}(X)$，其中 $c$ 是一个常数：\n$$\\operatorname{Var}(A_i) = \\operatorname{Var}(q X_i) = q^2 \\operatorname{Var}(X_i)$$\n伯努利随机变量 $X_i$ 的方差由 $\\operatorname{Var}(X_i) = p(1-p)$ 给出。这可以表示为 $\\operatorname{Var}(X_i) = \\mathbb{E}[X_i^2] - (\\mathbb{E}[X_i])^2$。我们已经得到 $\\mathbb{E}[X_i] = p$。$X_i^2$ 的期望是：\n$$\\mathbb{E}[X_i^2] = (1)^2 \\cdot P(X_i=1) + (0)^2 \\cdot P(X_i=0) = 1 \\cdot p + 0 \\cdot (1-p) = p$$\n所以，方差为 $\\operatorname{Var}(X_i) = p - p^2 = p(1-p)$。\n因此，单个位点电流的方差是：\n$$\\operatorname{Var}(A_i) = q^2 p(1-p)$$\n由于所有 $N$ 个位点都是独立同分布的，EPSC幅值的总方差为：\n$$\\operatorname{Var}(A) = \\sum_{i=1}^{N} q^2 p(1-p) = Nq^2 p(1-p)$$\n现在我们可以计算变异系数了。标准差 $\\sigma_A$ 是方差的平方根：\n$$\\sigma_A = \\sqrt{\\operatorname{Var}(A)} = \\sqrt{Nq^2 p(1-p)} = q\\sqrt{Np(1-p)}$$\n变异系数定义为标准差与平均值的比值：\n$$\\mathrm{CV} = \\frac{\\sigma_A}{\\mathbb{E}[A]} = \\frac{q\\sqrt{Np(1-p)}}{Nqp}$$\n我们可以通过消去 $q$ 并化简涉及 $N$ 和 $p$ 的项来简化这个表达式：\n$$\\mathrm{CV} = \\frac{\\sqrt{Np(1-p)}}{Np} = \\sqrt{\\frac{Np(1-p)}{(Np)^2}} = \\sqrt{\\frac{Np(1-p)}{N^2 p^2}} = \\sqrt{\\frac{1-p}{Np}}$$\n\n因此，所求的闭式表达式为 $\\mathbb{E}[A] = Npq$ 和 $\\mathrm{CV} = \\sqrt{\\frac{1-p}{Np}}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} Npq \\\\ \\sqrt{\\frac{1-p}{Np}} \\end{pmatrix} } $$"
        },
        {
            "introduction": "一个突触的强度由其释放位点的数量 $N$ 和释放概率 $p$ 共同决定，但这些位点在整个突触前末梢中是如何组织的呢？生物结构通常遵循标度律，即一个属性随另一个属性（如尺寸）的幂函数而变化。这项练习  让你扮演定量生物学家的角色，使用真实的数据分析技术来检验关于突触设计的假说，判断活性区的数量是受末梢表面积还是其体积的限制，从而为我们揭示支配突触构建的物理和代谢原理。",
            "id": "4933221",
            "problem": "您将获得中枢神经系统中突触前末梢的测量数据。每个末梢近似为一个直径为 $d$ 微米的球体，其活性区 (AZ) 数量 $N$ 是观测到的突触前释放位点的数量。从球体的几何第一性原理出发，表面积 $S$ 与 $d^{2}$ 成正比 ($S \\propto d^{2}$)，体积 $V$ 与 $d^{3}$ 成正比 ($V \\propto d^{3}$)。在活性区数量 $N$ 与表面积或体积成标度关系的假设下，您需要使用对数线性回归来形式化并检验这些标度关系。\n\n基本和建模假设：\n- 末梢被建模为直径为 $d$、半径为 $r = d/2$ 的球体，其表面积为 $S = 4\\pi r^{2} = \\pi d^{2}$，体积为 $V = \\frac{4}{3}\\pi r^{3} = \\frac{\\pi}{6} d^{3}$；因此，表面积驱动的标度关系意味着 $N \\propto d^{2}$，而体积驱动的标度关系意味着 $N \\propto d^{3}$。\n- 更一般地，如果 $N$ 与直径呈幂律关系，则 $N = a d^{k}$，其中 $a > 0$ 为常数，$k$ 为指数。取自然对数后得到 $\\ln N = \\ln a + k \\ln d$，这可以作为关于变量 $x = \\ln d$ 和 $y = \\ln N$ 的线性模型，使用普通最小二乘法进行拟合。\n\n您的任务：\n1. 对每个测试用例，使用普通最小二乘法拟合模型 $\\ln N = \\beta_{0} + k \\, \\ln d$ 中的指数 $k$。基于具有 $n - 2$ 个自由度的 Student's t 分布，计算斜率的估计值 $\\hat{k}$ 及其双侧 95% 置信区间，其中 $n$ 是测试用例中的观测数量。使用以下定义：\n   - 令 $x_{i} = \\ln d_{i}$ 和 $y_{i} = \\ln N_{i}$，其中 $i = 1, \\dots, n$。\n   - 令 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_{i}$ 和 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_{i}$。\n   - 定义 $S_{xx} = \\sum_{i=1}^{n} (x_{i} - \\bar{x})^{2}$ 和 $S_{xy} = \\sum_{i=1}^{n} (x_{i} - \\bar{x})(y_{i} - \\bar{y})$。\n   - 斜率估计值为 $\\hat{k} = \\frac{S_{xy}}{S_{xx}}$，截距估计值为 $\\hat{\\beta}_{0} = \\bar{y} - \\hat{k}\\,\\bar{x}$。\n   - 残差为 $e_{i} = y_{i} - (\\hat{\\beta}_{0} + \\hat{k} x_{i})$，残差平方和为 $\\mathrm{SSE} = \\sum_{i=1}^{n} e_{i}^{2}$。\n   - 残差方差估计值为 $\\hat{\\sigma}^{2} = \\mathrm{SSE}/(n - 2)$。\n   - 斜率的标准误为 $\\mathrm{SE}_{\\hat{k}} = \\sqrt{\\hat{\\sigma}^{2}/S_{xx}}$。\n   - 设 $t^{\\ast}$ 为具有 $n - 2$ 个自由度的 Student's t 分布的 $0.975$ 分位数，则 $k$ 的 95% 置信区间为 $\\hat{k} \\pm t^{\\ast}\\,\\mathrm{SE}_{\\hat{k}}$。\n2. 通过检查假设的指数是否包含在置信区间内，来检验活性区数量的标度关系是否与表面积或体积一致：\n   - 表面积一致性：返回一个布尔值，指示 $k = 2$ 是否在 95% 置信区间内。\n   - 体积一致性：返回一个布尔值，指示 $k = 3$ 是否在 95% 置信区间内。\n3. 对每个测试用例，返回一个列表，其中包含：\n   - 拟合的指数 $\\hat{k}$，四舍五入到三位小数（无量纲）。\n   - 一个表示表面积一致性（即 $k=2$）的布尔值。\n   - 一个表示体积一致性（即 $k=3$）的布尔值。\n\n物理单位和数值细节：\n- 末梢直径 $d$ 必须以微米为单位处理，活性区数量 $N$ 是无单位的计数。所有对数均为自然对数。\n- 确保所有的 $N_i$ 均为严格正数，以便进行对数计算。\n- 报告的 $\\hat{k}$ 值需四舍五入到三位小数。\n\n测试套件：\n- 案例 1（正常路径，接近表面积标度）：直径 $d$（单位：微米）为 $0.4, 0.6, 0.8, 1.0, 1.2$，活性区数量 $N$ 为 $1, 1, 2, 3, 4$。\n- 案例 2（正常路径，接近体积标度）：直径 $d$（单位：微米）为 $0.4, 0.6, 0.8, 1.0, 1.2$，活性区数量 $N$ 为 $1, 2, 5, 10, 17$。\n- 案例 3（模糊情况，介于两者之间的标度）：直径 $d$（单位：微米）为 $0.4, 0.6, 0.8, 1.0, 1.2$，活性区数量 $N$ 为 $1, 1, 2, 4, 6$。\n- 案例 4（含噪声，中等样本量）：直径 $d$（单位：微米）为 $0.5, 0.7, 0.9, 1.1, 1.3, 1.5$，活性区数量 $N$ 为 $1, 2, 2, 3, 4, 5$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个用方括号括起来的、由逗号分隔的三元组，包含四舍五入到三位小数的拟合指数和两个布尔值。例如，包含两个测试用例的输出应如下所示：$[[1.999,\\mathrm{True},\\mathrm{False}],[3.001,\\mathrm{False},\\mathrm{True}]]$。",
            "solution": "该问题要求对突触前末梢（建模为直径为 $d$ 的球体）中活性区数量 ($N$) 的两种生物物理标度假设进行评估。这两种假设是：$N$ 与末梢的表面积 $S$ 成标度关系，或与末梢的体积 $V$ 成标度关系。根据球体的几何第一性原理，$S = \\pi d^2$ 且 $V = (\\pi/6) d^3$，这意味着表面积依赖性的标度关系为 $N \\propto d^2$，而体积依赖性的标度关系为 $N \\propto d^3$。\n\n一个更通用的模型是幂律关系 $N = a d^k$，其中 $a$ 是比例常数，$k$ 是标度指数。任务是从实验数据中估计 $k$，并确定该估计值在统计上是否与假设值 $k=2$ 或 $k=3$ 一致。\n\n通过对两边取自然对数，可以将幂律模型转换为一个线性方程：\n$$ \\ln N = \\ln a + k \\ln d $$\n该方程符合简单线性回归模型 $y_i = \\beta_0 + \\beta_1 x_i$ 的形式，其中 $y_i = \\ln N_i$，$x_i = \\ln d_i$，截距为 $\\beta_0 = \\ln a$，斜率即为标度指数 $\\beta_1 = k$。\n\n指数 $k$ 使用普通最小二乘法 (OLS) 进行估计。对于一个包含 $n$ 对观测值 $(d_i, N_i)$ 的数据集，我们首先计算经对数转换的变量 $x_i = \\ln d_i$ 和 $y_i = \\ln N_i$。斜率的 OLS 估计值（记为 $\\hat{k}$）使用样本均值 $\\bar{x}$ 和 $\\bar{y}$ 计算得出：\n$$ S_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2 $$\n$$ S_{xy} = \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y}) $$\n$$ \\hat{k} = \\frac{S_{xy}}{S_{xx}} $$\n\n为了检验这些假设，我们为 $k$ 的真实值构建一个 95% 置信区间。如果 $k$ 的理论值（例如 2 或 3）落在此区间内，则认为该假设与数据一致。置信区间的计算公式为 $\\hat{k} \\pm t^{\\ast}\\,\\mathrm{SE}_{\\hat{k}}$。\n\n该区间的各组成部分确定如下：\n1. 残差平方和 ($\\mathrm{SSE}$) 衡量数据点与拟合回归线的总偏差。其计算公式为：\n$$ \\mathrm{SSE} = S_{yy} - \\frac{S_{xy}^2}{S_{xx}} \\quad \\text{其中} \\quad S_{yy} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2 $$\n2. 残差方差的无偏估计值 $\\hat{\\sigma}^2$ 通过将 $\\mathrm{SSE}$ 除以自由度（对于简单线性回归，自由度为 $n-2$）计算得出：\n$$ \\hat{\\sigma}^2 = \\frac{\\mathrm{SSE}}{n - 2} $$\n3. 斜率估计值的标准误 $\\mathrm{SE}_{\\hat{k}}$ 量化了我们对估计值 $\\hat{k}$ 的不确定性，其计算公式为：\n$$ \\mathrm{SE}_{\\hat{k}} = \\sqrt{\\frac{\\hat{\\sigma}^2}{S_{xx}}} $$\n4. 值 $t^{\\ast}$ 是来自 Student's t 分布的临界值。对于双侧 95% 置信区间，我们需要对应于累积概率 0.975 的分位数。该分布的自由度为 $n-2$。\n$$ t^{\\ast} = t_{n-2, 0.975} $$\n因此，$k$ 的 95% 置信区间为 $[ \\hat{k} - t^{\\ast}\\,\\mathrm{SE}_{\\hat{k}}, \\hat{k} + t^{\\ast}\\,\\mathrm{SE}_{\\hat{k}} ]$。\n\n对于每个测试用例，我们执行这些计算。我们检查值 $k=2$ 是否在计算出的区间内以确定表面积一致性，并类似地检查 $k=3$ 以确定体积一致性。每个用例的最终输出包括估计的指数 $\\hat{k}$（四舍五入到三位小数）和两个指示这些一致性检查结果的布尔值。对于所提供的测试套件，整个过程将通过算法实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Fits a power-law exponent to bouton data and tests consistency\n    with surface-area or volume scaling.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, near surface-area scaling)\n        (np.array([0.4, 0.6, 0.8, 1.0, 1.2]), np.array([1, 1, 2, 3, 4])),\n        # Case 2 (happy path, near volume scaling)\n        (np.array([0.4, 0.6, 0.8, 1.0, 1.2]), np.array([1, 2, 5, 10, 17])),\n        # Case 3 (ambiguous, intermediate scaling)\n        (np.array([0.4, 0.6, 0.8, 1.0, 1.2]), np.array([1, 1, 2, 4, 6])),\n        # Case 4 (noisy, moderate sample size)\n        (np.array([0.5, 0.7, 0.9, 1.1, 1.3, 1.5]), np.array([1, 2, 2, 3, 4, 5])),\n    ]\n\n    results = []\n    for d, N in test_cases:\n        # Number of observations\n        n = len(d)\n        if n = 2:\n            # Not enough data points to compute confidence interval\n            # This case is not in the problem spec but is good practice.\n            # Using NaN for invalid results, though not strictly required.\n            results.append([np.nan, False, False])\n            continue\n            \n        # Step 1: Log-transform the data\n        x = np.log(d)\n        y = np.log(N)\n\n        # Step 2: Calculate means and sums of squares\n        x_bar = np.mean(x)\n        y_bar = np.mean(y)\n        \n        S_xx = np.sum((x - x_bar)**2)\n        S_xy = np.sum((x - x_bar) * (y - y_bar))\n        S_yy = np.sum((y - y_bar)**2)\n\n        # Step 3: Compute OLS estimate for the slope k\n        k_hat = S_xy / S_xx\n\n        # Step 4: Calculate components for the confidence interval\n        # Residual sum of squares\n        SSE = S_yy - (S_xy**2) / S_xx\n        \n        # Degrees of freedom\n        df = n - 2\n        \n        # Residual variance estimate\n        sigma2_hat = SSE / df\n        \n        # Standard error of the slope\n        SE_k = np.sqrt(sigma2_hat / S_xx)\n        \n        # Critical t-value for 95% confidence interval\n        t_star = t.ppf(0.975, df=df)\n        \n        # Margin of error\n        margin_of_error = t_star * SE_k\n        \n        # Confidence interval\n        ci_lower = k_hat - margin_of_error\n        ci_upper = k_hat + margin_of_error\n        \n        # Step 5: Test consistency with hypothesized exponents\n        # Surface-area consistency (k=2)\n        is_surface_consistent = ci_lower = 2 = ci_upper\n        \n        # Volume consistency (k=3)\n        is_volume_consistent = ci_lower = 3 = ci_upper\n        \n        # Step 6: Format and store the result\n        k_rounded = round(k_hat, 3)\n        results.append([k_rounded, is_surface_consistent, is_volume_consistent])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is converted to a string,\n    # and spaces are removed to match the desired compact format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}