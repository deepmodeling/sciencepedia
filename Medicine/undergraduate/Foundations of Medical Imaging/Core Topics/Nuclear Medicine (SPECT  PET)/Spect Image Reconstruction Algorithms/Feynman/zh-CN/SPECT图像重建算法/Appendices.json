{
    "hands_on_practices": [
        {
            "introduction": "在能对SPECT图像进行重建之前，我们首先需要一个数学模型来描述放射性示踪剂的分布如何产生我们测量到的投影数据。这个练习将带你动手计算一个简化的前向模型 $\\bar{y} = Ax + r$，帮助你理解系统矩阵、体素活度和背景噪声是如何共同构成最终测量信号的期望值的。掌握前向模型是理解所有后续重建算法的基础 。",
            "id": "4927199",
            "problem": "考虑单光子发射计算机断层扫描（SPECT），其中，测得的投影数据被建模为随机计数，其期望值由系统对潜在活动性分布的响应决定。在一个离散的双体素、双收集单元（bin）的设定中，设系统矩阵 $A$ 描述了每个体素对每个投影收集单元的贡献，活动性向量 $x$ 编码了体素的活动性，加性项 $r$ 代表平均背景计数（包括散射和电子噪声）。采用SPECT的标准正向期望模型，该模型在期望计数层面结合了线性系统响应和加性背景。已知\n$A=\\begin{bmatrix}0.5  0.2 \\\\ 0.3  0.4\\end{bmatrix}$，\n$x=\\begin{bmatrix}10 \\\\ 4\\end{bmatrix}$ （单位：贝克勒尔，Bq），以及\n$r=\\begin{bmatrix}1 \\\\ 2\\end{bmatrix}$ （单位：计数），计算平均投影向量 $\\bar{y}$（单位：计数）。然后，从体素贡献和背景的角度简要解释每一项对 $\\bar{y}$ 各个分量的贡献。以计数为单位给出最终数值答案，不要四舍五入。",
            "solution": "用户希望我按照说明解决问题。\n1. ### **问题验证**\n在尝试解决问题之前，必须先对问题进行验证。\n\n#### **步骤1：提取已知条件**\n- **主题**：单光子发射计算机断层扫描（SPECT）图像重建。\n- **模型**：一个离散的双体素、双收集单元设定。平均投影计数 $\\bar{y}$ 的正向期望模型被设定为线性系统响应和加性背景的组合。\n- **系统矩阵**：$A = \\begin{bmatrix} 0.5  0.2 \\\\ 0.3  0.4 \\end{bmatrix}$。元素 $A_{ij}$ 表示体素 $j$ 对投影收集单元 $i$ 的贡献。\n- **活动性向量**：$x = \\begin{bmatrix} 10 \\\\ 4 \\end{bmatrix}$ （单位：贝克勒尔，Bq）。\n- **平均背景向量**：$r = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}$ （单位：计数）。\n- **任务**：计算平均投影向量 $\\bar{y}$（单位：计数）并解释各项的贡献。\n\n#### **步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题具有科学依据。平均投影数据的模型 $\\bar{y} = Ax + r$ 是医学影像领域（特别是SPECT和PET重建）中使用的标准且基础的线性近似。它正确地表示了物理过程：来自活动性分布（$x$）的光子被一个系统（响应为$A$）探测到，并受到加性背景信号（如散射和随机符合事件，$r$）的干扰。\n- **适定性**：该问题是适定的。它提供了所有必要的数值数据（$A$、$x$、$r$）和要使用的模型的清晰定义。计算过程是直接的矩阵-向量乘法和加法，可以得出一个唯一且有意义的解。\n- **客观性**：该问题使用医学影像领域的标准术语进行客观陈述。所有量都得到了精确定义。\n- **完整性与一致性**：该问题是自洽的。虽然单位存在轻微的模糊性（活动性的单位Bq与投影和背景的单位“计数”），但在这种简化问题中，通常假设系统矩阵 $A$ 已包含了任何必要的转换因子（例如，采集时间、探测器效率、几何因子）以确保量纲一致。因此，模型按所给定的形式应用，结果单位为“计数”。\n- **其他缺陷**：该问题没有违反任何其他标准。它并非不切实际（作为一个教学示例）、不适定、微不足道或无法验证。\n\n#### **步骤3：结论与行动**\n该问题是**有效的**。将提供完整的解答。\n\n2. ### **解题过程**\n该问题描述了SPECT投影数据期望的标准线性正向模型。平均投影向量 $\\bar{y}$ 是源于患者体内示踪剂分布的期望计数与源于背景源的期望计数之和。这个关系表示为：\n$$ \\bar{y} = Ax + r $$\n其中 $A$ 是系统矩阵，$x$ 是活动性向量，$r$ 是平均背景向量。\n\n我们已知以下值：\n系统矩阵 $A$：\n$$ A = \\begin{bmatrix} 0.5  0.2 \\\\ 0.3  0.4 \\end{bmatrix} $$\n活动性向量 $x$：\n$$ x = \\begin{bmatrix} 10 \\\\ 4 \\end{bmatrix} $$\n平均背景向量 $r$：\n$$ r = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} $$\n\n首先，我们计算来自活动性分布的贡献，即乘积 $Ax$：\n$$ Ax = \\begin{bmatrix} 0.5  0.2 \\\\ 0.3  0.4 \\end{bmatrix} \\begin{bmatrix} 10 \\\\ 4 \\end{bmatrix} = \\begin{bmatrix} (0.5)(10) + (0.2)(4) \\\\ (0.3)(10) + (0.4)(4) \\end{bmatrix} $$\n$$ Ax = \\begin{bmatrix} 5 + 0.8 \\\\ 3 + 1.6 \\end{bmatrix} = \\begin{bmatrix} 5.8 \\\\ 4.6 \\end{bmatrix} $$\n该向量表示在考虑背景之前，每个收集单元中探测到的源于两个体素的平均计数。\n\n接下来，我们加上平均背景计数 $r$ 来求得总平均投影向量 $\\bar{y}$：\n$$ \\bar{y} = Ax + r = \\begin{bmatrix} 5.8 \\\\ 4.6 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = \\begin{bmatrix} 5.8 + 1 \\\\ 4.6 + 2 \\end{bmatrix} = \\begin{bmatrix} 6.8 \\\\ 6.6 \\end{bmatrix} $$\n因此，平均投影向量为 $\\bar{y} = \\begin{bmatrix} 6.8 \\\\ 6.6 \\end{bmatrix}$ 计数。\n\n对 $\\bar{y}$ 中每个分量的贡献解释如下：\n设平均投影向量的分量为 $\\bar{y} = \\begin{bmatrix} \\bar{y}_1 \\\\ \\bar{y}_2 \\end{bmatrix}$。\n\n对于第一个投影收集单元，$\\bar{y}_1 = 6.8$ 计数：\n总平均计数是三项之和：\n1.  第一个体素（活动性 $x_1 = 10$）对第一个收集单元的贡献：$A_{11}x_1 = 0.5 \\times 10 = 5.0$ 计数。\n2.  第二个体素（活动性 $x_2 = 4$）对第一个收集单元的贡献：$A_{12}x_2 = 0.2 \\times 4 = 0.8$ 计数。\n3.  背景对第一个收集单元的贡献：$r_1 = 1$ 计数。\n总和为 $\\bar{y}_1 = 5.0 + 0.8 + 1 = 6.8$ 计数。\n\n对于第二个投影收集单元，$\\bar{y}_2 = 6.6$ 计数：\n总平均计数是三项之和：\n1.  第一个体素（活动性 $x_1 = 10$）对第二个收集单元的贡献：$A_{21}x_1 = 0.3 \\times 10 = 3.0$ 计数。\n2.  第二个体素（活动性 $x_2 = 4$）对第二个收集单元的贡献：$A_{22}x_2 = 0.4 \\times 4 = 1.6$ 计数。\n3.  背景对第二个收集单元的贡献：$r_2 = 2$ 计数。\n总和为 $\\bar{y}_2 = 3.0 + 1.6 + 2 = 6.6$ 计数。\n系统矩阵 $A$ 显示，第一个体素对第一个收集单元的贡献更大，而第二个体素对第二个收集单元的贡献更大，这对于探测器几何结构中每个收集单元都更靠近其对应体素的情况是典型的。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 6.8 \\\\ 6.6 \\end{pmatrix} } $$"
        },
        {
            "introduction": "最大似然期望最大化（ML-EM）算法是发射断层成像领域中一种核心的迭代重建方法。本练习将引导你完成一次完整的ML-EM迭代计算，让你亲身体验该算法如何基于光子计数的泊松统计特性，从一个初始图像估计出发，通过迭代更新使其更符合测量数据 。通过这个实践，你将揭开迭代重建的神秘面纱，并理解前向投影和反向投影在其中扮演的关键角色。",
            "id": "4927224",
            "problem": "在单光子发射计算机断层成像 (SPECT) 中，一个标准的分箱投影模型假设每个探测器分箱计数 $y_i$ 是一个泊松随机变量的实现，其均值为 $\\lambda_i = \\sum_{j} A_{ij} x_j + r_i$，其中 $A_{ij}$ 是一个已知的系统矩阵，编码了从体素 $j$ 发出的辐射在分箱 $i$ 中被探测到的概率，$x_j \\ge 0$ 是体素 $j$ 中未知的活度，$r_i \\ge 0$ 是分箱 $i$ 中已知的平均背景计数。在此模型下，可以通过期望最大化框架寻求最大似然估计，从而产生一个保持非负性的乘法不动点迭代。\n\n从泊松数据模型、独立泊松测量的对数似然定义以及使用适当潜变量的期望最大化构造出发，推导在已知 $A$ 和 $r$ 的情况下，适用于最大似然期望最大化 (ML-EM) 的不动点乘法更新。然后，使用您推导出的更新，从给定的初始值开始执行恰好一次迭代，为以下数值指定的 SPECT 系统计算 $x^{1}$：\n$$\nA=\\begin{bmatrix}0.4  0.2\\\\ 0.1  0.5\\end{bmatrix},\\quad\ny=\\begin{bmatrix}20\\\\ 10\\end{bmatrix},\\quad\nr=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\\quad\nx^{0}=\\begin{bmatrix}5\\\\ 5\\end{bmatrix}.\n$$\n将 $x^{1}$ 的两个分量报告为精确的计数值（不进行四舍五入）。以计数为单位表示 $x^{1}$ 的最终数值结果。",
            "solution": "该问题是有效的。这是医学图像重建中的一个标准问题，它有科学依据，是适定的，并包含了获得唯一解所需的所有信息。\n\n问题分为两部分：首先，推导用于 SPECT 重建的最大似然期望最大化 (ML-EM) 更新规则；其次，将此规则应用于给定数值数据进行一次迭代。\n\n### 第1部分：ML-EM 更新规则的推导\n\n问题陈述了测量投影数据的统计模型。对于每个探测器分箱 $i$，计数 $y_i$ 是一个独立泊松随机变量的实现，其均值为 $\\lambda_i$。该均值由线性模型给出：\n$$\n\\lambda_i = \\sum_{j=1}^{N} A_{ij} x_j + r_i\n$$\n其中 $x_j$ 是体素 $j$ ($j=1, \\dots, N$) 中未知的活度，$A_{ij}$ 是系统矩阵元素，表示从体素 $j$ 发出的辐射在分箱 $i$ 中被探测到的概率，$r_i$ 是分箱 $i$ 中已知背景事件（例如散射）的平均值。目标是找到活度向量 $x = (x_1, \\dots, x_N)^T$，以最大化观测到测量向量 $y = (y_1, \\dots, y_M)^T$ 的可能性。\n\n独立泊松测量的对数似然函数 $L(x)$ 是：\n$$\nL(x) = \\ln P(y|x) = \\sum_{i=1}^{M} \\ln \\left( \\frac{\\exp(-\\lambda_i) \\lambda_i^{y_i}}{y_i!} \\right) = \\sum_{i=1}^{M} \\left( -\\lambda_i + y_i \\ln(\\lambda_i) - \\ln(y_i!) \\right)\n$$\n代入 $\\lambda_i$ 的表达式，并舍去相对于 $x$ 是常数的项 $\\ln(y_i!)$：\n$$\nL(x) \\propto \\sum_{i=1}^{M} \\left( - \\left(\\sum_{j=1}^{N} A_{ij} x_j + r_i\\right) + y_i \\ln\\left(\\sum_{j=1}^{N} A_{ij} x_j + r_i\\right) \\right)\n$$\n由于和的对数存在，直接最大化该函数是困难的。期望最大化 (EM) 算法通过引入构成“完整数据”的潜变量来解决这个问题。\n\n令完整数据为变量集合 $\\{z_{ij}\\}$，其中 $z_{ij}$ 是源于体素 $j$ 并被分箱 $i$ 探测到的光子数。对于背景，我们可以认为它源于一个独立的源，为分箱 $i$ 贡献了 $w_i$ 个计数。\n观测到的或“不完整”的数据 $y_i$ 是这些贡献的总和：\n$$\ny_i = \\sum_{j=1}^{N} z_{ij} + w_i\n$$\n根据泊松模型，$z_{ij}$ 和 $w_i$ 是独立的泊松随机变量，其均值分别为 $E[z_{ij}] = A_{ij} x_j$ 和 $E[w_i] = r_i$。独立泊松变量的和也是泊松分布的，因此 $y_i$ 是泊松分布的，其均值为 $\\sum_j E[z_{ij}] + E[w_i] = \\sum_j A_{ij} x_j + r_i$，这与问题陈述一致。\n\n给定 $x$，完整数据 $\\{z_{ij}, w_i\\}$ 的对数似然是：\n$$\nL_c(x) = \\ln P(\\{z_{ij}, w_i\\}|x) = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\ln P(z_{ij}|x) + \\sum_{i=1}^{M} \\ln P(w_i)\n$$\n由于 $w_i$ 的项不依赖于 $x$，在最大化过程中可以忽略。\n$$\nL_c(x) \\propto \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( -A_{ij}x_j + z_{ij}\\ln(A_{ij}x_j) - \\ln(z_{ij}!) \\right)\n$$\nEM 算法分两步进行：\n\n**E步（期望）：**\n我们计算完整数据对数似然的期望，该期望以观测数据 $y$ 和参数的当前估计值 $x^{(k)}$ 为条件。这就是函数 $Q(x | x^{(k)})$：\n$$\nQ(x | x^{(k)}) = E[L_c(x) | y, x^{(k)}] = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( -A_{ij}x_j + E[z_{ij}|y, x^{(k)}]\\ln(A_{ij}x_j) \\right) + \\text{const.}\n$$\n关键是计算条件期望 $E[z_{ij}|y, x^{(k)}]$。鉴于独立泊松变量 $\\{z_{i1}, \\dots, z_{iN}, w_i\\}$ 的和是 $y_i$，它们在给定和的条件下的联合分布是多项分布。任何一个分量（例如 $z_{ij}$）的期望是总计数 $y_i$ 乘以其均值与所有均值之和的比率：\n$$\nE[z_{ij}|y_i, x^{(k)}] = y_i \\frac{E[z_{ij}|x^{(k)}]}{\\sum_{l=1}^{N}E[z_{il}|x^{(k)}] + E[w_i]} = y_i \\frac{A_{ij} x_j^{(k)}}{\\sum_{l=1}^{N} A_{il} x_l^{(k)} + r_i}\n$$\n我们用 $\\hat{z}_{ij}^{(k)} = E[z_{ij}|y, x^{(k)}]$ 来表示。\n\n**M步（最大化）：**\n我们通过最大化 $Q(x | x^{(k)})$ 来找到下一个估计值 $x^{(k+1)}$。\n$$\nx^{(k+1)} = \\arg\\max_{x \\ge 0} Q(x | x^{(k)})\n$$\n我们对 $Q(x|x^{(k)})$ 关于每个 $x_j$ 求偏导数并令其为零。\n$$\n\\frac{\\partial Q(x|x^{(k)})}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\sum_{i=1}^{M} \\sum_{l=1}^{N} \\left( -A_{il}x_l + \\hat{z}_{il}^{(k)}\\ln(A_{il}x_l) \\right)\n$$\n仅当 $l=j$ 时，导数才不为零：\n$$\n\\frac{\\partial Q}{\\partial x_j} = \\sum_{i=1}^{M} \\left( -A_{ij} + \\frac{\\hat{z}_{ij}^{(k)}}{x_j} \\right)\n$$\n令其为 $0$：\n$$\n\\sum_{i=1}^{M} \\frac{\\hat{z}_{ij}^{(k)}}{x_j} = \\sum_{i=1}^{M} A_{ij} \\implies x_j = \\frac{\\sum_{i=1}^{M} \\hat{z}_{ij}^{(k)}}{\\sum_{i=1}^{M} A_{ij}}\n$$\n这给出了 $x_j^{(k+1)}$ 的更新规则：\n$$\nx_j^{(k+1)} = \\frac{1}{\\sum_{i=1}^{M} A_{ij}} \\sum_{i=1}^{M} \\left( y_i \\frac{A_{ij} x_j^{(k)}}{\\sum_{l=1}^{N} A_{il} x_l^{(k)} + r_i} \\right)\n$$\n这可以重排成标准的乘法形式：\n$$\nx_j^{(k+1)} = x_j^{(k)} \\frac{\\sum_{i=1}^{M} A_{ij} \\frac{y_i}{\\sum_{l=1}^{N} A_{il} x_l^{(k)} + r_i}}{\\sum_{i=1}^{M} A_{ij}}\n$$\n这就是 ML-EM 的不动点乘法更新规则。项 $\\sum_{i=1}^{M} A_{ij}$ 通常表示为体素 $j$ 的灵敏度 $s_j$。\n\n### 第2部分：一次迭代的数值计算\n\n我们得到以下数值：\n$$\nA=\\begin{bmatrix}0.4  0.2\\\\ 0.1  0.5\\end{bmatrix},\\quad\ny=\\begin{bmatrix}20\\\\ 10\\end{bmatrix},\\quad\nr=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\\quad\nx^{(0)}=\\begin{bmatrix}5\\\\ 5\\end{bmatrix}\n$$\n我们要计算 $x^{(1)} = \\begin{bmatrix} x_1^{(1)} \\\\ x_2^{(1)} \\end{bmatrix}$。\n\n体素数为 $N=2$，探测器分箱数为 $M=2$。对于 $j=1, 2$ 的更新规则是：\n$$\nx_j^{(1)} = x_j^{(0)} \\frac{\\sum_{i=1}^{2} A_{ij} \\frac{y_i}{\\sum_{l=1}^{2} A_{il} x_l^{(0)} + r_i}}{\\sum_{i=1}^{2} A_{ij}}\n$$\n当 $r=0$ 时，这简化为：\n$$\nx_j^{(1)} = x_j^{(0)} \\frac{\\sum_{i=1}^{2} A_{ij} \\frac{y_i}{(Ax^{(0)})_i}}{\\sum_{i=1}^{2} A_{ij}}\n$$\n\n**1. 计算前向投影 $\\lambda^{(0)} = Ax^{(0)}$：**\n$$\n\\lambda^{(0)} = \\begin{bmatrix}0.4  0.2\\\\ 0.1  0.5\\end{bmatrix} \\begin{bmatrix}5\\\\ 5\\end{bmatrix} = \\begin{bmatrix}0.4(5) + 0.2(5) \\\\ 0.1(5) + 0.5(5)\\end{bmatrix} = \\begin{bmatrix}2 + 1 \\\\ 0.5 + 2.5\\end{bmatrix} = \\begin{bmatrix}3\\\\ 3\\end{bmatrix}\n$$\n\n**2. 计算校正比率 $y_i / \\lambda_i^{(0)}$：**\n$$\n\\frac{y_1}{\\lambda_1^{(0)}} = \\frac{20}{3}\n$$\n$$\n\\frac{y_2}{\\lambda_2^{(0)}} = \\frac{10}{3}\n$$\n\n**3. 计算更新因子分子中的反向投影项：**\n该项为 $b_j = \\sum_{i=1}^{2} A_{ij} \\frac{y_i}{\\lambda_i^{(0)}}$。以矩阵形式表示，即为 $A^T (y./\\lambda^{(0)})$。\n对于 $j=1$：\n$$\nb_1 = A_{11}\\frac{y_1}{\\lambda_1^{(0)}} + A_{21}\\frac{y_2}{\\lambda_2^{(0)}} = (0.4)\\left(\\frac{20}{3}\\right) + (0.1)\\left(\\frac{10}{3}\\right) = \\frac{8}{3} + \\frac{1}{3} = \\frac{9}{3} = 3\n$$\n对于 $j=2$：\n$$\nb_2 = A_{12}\\frac{y_1}{\\lambda_1^{(0)}} + A_{22}\\frac{y_2}{\\lambda_2^{(0)}} = (0.2)\\left(\\frac{20}{3}\\right) + (0.5)\\left(\\frac{10}{3}\\right) = \\frac{4}{3} + \\frac{5}{3} = \\frac{9}{3} = 3\n$$\n\n**4. 计算灵敏度 $s_j = \\sum_{i=1}^{2} A_{ij}$：**\n对于 $j=1$：\n$$\ns_1 = A_{11} + A_{21} = 0.4 + 0.1 = 0.5\n$$\n对于 $j=2$：\n$$\ns_2 = A_{12} + A_{22} = 0.2 + 0.5 = 0.7\n$$\n\n**5. 应用乘法更新以找到 $x^{(1)}$：**\n$$\nx_j^{(1)} = x_j^{(0)} \\frac{b_j}{s_j}\n$$\n对于 $j=1$：\n$$\nx_1^{(1)} = x_1^{(0)} \\frac{b_1}{s_1} = 5 \\cdot \\frac{3}{0.5} = 5 \\cdot 6 = 30\n$$\n对于 $j=2$：\n$$\nx_2^{(1)} = x_2^{(0)} \\frac{b_2}{s_2} = 5 \\cdot \\frac{3}{0.7} = \\frac{15}{7/10} = \\frac{150}{7}\n$$\n\n因此，一次迭代后更新的活度向量为 $x^{(1)} = \\begin{bmatrix} 30 \\\\ 150/7 \\end{bmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 30 \\\\ \\frac{150}{7} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然ML-EM算法在理论上很稳健，但其收敛速度在实际应用中可能很慢。有序子集期望最大化（OSEM）算法是对ML-EM的一种重要加速改进，它在临床实践中被广泛使用 。在这个练习中，你将通过在每次子迭代中使用部分投影数据来应用OSEM算法，直观地感受它是如何以更高的效率逼近最终解的。",
            "id": "4927209",
            "problem": "考虑基于投影箱的泊松数据似然模型下的单光子发射计算机断层扫描 (SPECT) 重建。设投影箱 $j$ 中的测量计数是一个泊松随机变量，其均值为 $(A x)_j + r_j$，其中 $A$ 是将图像体素活度 $x$ 映射到投影的系统矩阵，$r_j$ 是一个已知的附加背景项（例如，由散射引起）。假设图像为一个体素 ($i=1$)，有两个投影箱 ($j=1,2$)。系统矩阵为\n$$\nA = \\begin{pmatrix}\na_{11} \\\\\na_{21}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.9 \\\\\n1.1\n\\end{pmatrix},\n$$\n测量计数为\n$$\ny = \\begin{pmatrix}\ny_1 \\\\\ny_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n200 \\\\\n180\n\\end{pmatrix},\n$$\n已知背景项为\n$$\nr = \\begin{pmatrix}\nr_1 \\\\\nr_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n10 \\\\\n20\n\\end{pmatrix},\n$$\n初始图像估计为 $x^{0} = 150$ （任意单位）。使用源于泊松似然模型和期望最大化原理的有序子集期望最大化 (OSEM) 方法，使用有序子集 $\\mathcal{S}_{1} = \\{1\\}$ 和 $\\mathcal{S}_{2} = \\{2\\}$ 执行两次连续的子迭代，以获得应用 $\\mathcal{S}_{1}$ 后的 $x^{0,1}$ 和随后应用 $\\mathcal{S}_{2}$ 后的 $x^{0,2}$。你的推导应从泊松模型和 OSEM 作为最大似然期望最大化更新的逐子集应用的定义开始。计算数值并将最终结果四舍五入到四位有效数字。以数对 $\\left(x^{0,1},\\, x^{0,2}\\right)$ 的形式提供你的最终答案。",
            "solution": "经过严格审查，我们发现该问题陈述是有效的。它在科学上基于医学成像的原理，特别是使用泊松统计模型的SPECT重建。该问题是适定的，提供了所有必要的数据和清晰的算法路径，从而导向一个唯一且有意义的解。其术语客观而精确。\n\n该问题要求在一个简化的SPECT成像场景中应用有序子集期望最大化（OSEM）算法。该算法的核心源于最大化测量数据的泊松似然。对于一组投影箱，每个投影箱 $j$ 中的测量计数 $y_j$ 被假定为独立的泊松随机变量，其均值为 $\\bar{y}_j$。该均值是来自未知活度分布 $x$ 和已知背景源 $r$ 的计数之和。其关系由下式给出：\n$$\n\\bar{y}_j = (Ax)_j + r_j = \\sum_{i} a_{ji} x_i + r_j\n$$\n其中 $x_i$ 是图像体素 $i$ 中的活度，$A$ 是系统矩阵，其元素 $a_{ji}$ 代表从体素 $i$ 发出的光子在投影箱 $j$ 中被探测到的概率。\n\n在给定图像 $x$ 的情况下，观测到测量数据 $y$ 的似然为：\n$$\nL(x) = \\prod_{j} \\frac{\\exp(-\\bar{y}_j) (\\bar{y}_j)^{y_j}}{y_j!}\n$$\n最大似然期望最大化 (MLEM) 算法提供了一个迭代过程，用以寻找最大化此似然的图像估计 $x$。对于第 $k$ 次迭代，每个体素 $i$ 的更新规则是：\n$$\nx_i^{k+1} = \\frac{x_i^k}{\\sum_{j} a_{ji}} \\sum_{j} a_{ji} \\frac{y_j}{\\sum_{l} a_{jl} x_l^k + r_j}\n$$\nOSEM 算法通过将所有投影索引的集合划分为 $M$ 个有序子集 $\\mathcal{S}_1, \\mathcal{S}_2, \\ldots, \\mathcal{S}_M$ 来加速 MLEM。对每个子集顺序执行一个完整的类 MLEM 更新。在一次主迭代中，第 $m$ 次子迭代（使用子集 $\\mathcal{S}_m$）的更新为：\n$$\nx_i^{(new)} = \\frac{x_i^{(old)}}{\\sum_{j \\in \\mathcal{S}_m} a_{ji}} \\sum_{j \\in \\mathcal{S}_m} a_{ji} \\frac{y_j}{\\sum_{l} a_{jl} x_l^{(old)} + r_j}\n$$\n在本问题中，我们只有一个图像体素（$i=1, l=1$），因此图像 $x$ 是一个标量 $x_1$。对 $x_1$ 的 OSEM 更新规则简化为：\n$$\nx_1^{(new)} = \\frac{x_1^{(old)}}{\\sum_{j \\in \\mathcal{S}_m} a_{j1}} \\sum_{j \\in \\mathcal{S}_m} a_{j1} \\frac{y_j}{a_{j1} x_1^{(old)} + r_j}\n$$\n该问题指定了两次子迭代，使用的子集为单元素子集 $\\mathcal{S}_1=\\{1\\}$ 和 $\\mathcal{S}_2=\\{2\\}$。\n\n第一次子迭代：\n我们使用子集 $\\mathcal{S}_1 = \\{1\\}$ 更新初始估计 $x_1^0 = 150$。得到的估计记为 $x_1^{0,1}$。OSEM 公式中的求和项仅包含 $j=1$ 的项。\n$$\nx_1^{0,1} = \\frac{x_1^0}{a_{11}} \\left( a_{11} \\frac{y_1}{a_{11} x_1^0 + r_1} \\right) = x_1^0 \\frac{y_1}{a_{11} x_1^0 + r_1}\n$$\n代入给定值：\n$x_1^0 = 150$\n$a_{11} = 0.9$\n$y_1 = 200$\n$r_1 = 10$\n\n计算过程如下：\n$$\nx_1^{0,1} = 150 \\times \\frac{200}{(0.9)(150) + 10} = 150 \\times \\frac{200}{135 + 10} = 150 \\times \\frac{200}{145}\n$$\n$$\nx_1^{0,1} = \\frac{30000}{145} = \\frac{6000}{29} \\approx 206.89655...\n$$\n四舍五入到四位有效数字，我们得到 $x_1^{0,1} \\approx 206.9$。\n\n第二次子迭代：\n接下来，我们使用子集 $\\mathcal{S}_2 = \\{2\\}$ 更新第一次子迭代得到的估计 $x_1^{0,1} = 6000/29$。结果记为 $x_1^{0,2}$。该公式使用 $j=2$。\n$$\nx_1^{0,2} = x_1^{0,1} \\frac{y_2}{a_{21} x_1^{0,1} + r_2}\n$$\n代入给定值：\n$x_1^{0,1} = 6000/29$\n$a_{21} = 1.1$\n$y_2 = 180$\n$r_2 = 20$\n\n计算过程如下，为了精确，使用 $x_1^{0,1}$ 的精确分数形式：\n$$\nx_1^{0,2} = \\frac{6000}{29} \\times \\frac{180}{(1.1)\\left(\\frac{6000}{29}\\right) + 20} = \\frac{6000}{29} \\times \\frac{180}{\\frac{6600}{29} + \\frac{20 \\times 29}{29}}\n$$\n$$\nx_1^{0,2} = \\frac{6000}{29} \\times \\frac{180}{\\frac{6600 + 580}{29}} = \\frac{6000}{29} \\times \\frac{180}{\\frac{7180}{29}} = \\frac{6000}{29} \\times \\frac{180 \\times 29}{7180}\n$$\n$$\nx_1^{0,2} = \\frac{6000 \\times 180}{7180} = \\frac{1080000}{7180} = \\frac{54000}{359} \\approx 150.41782...\n$$\n四舍五入到四位有效数字，我们得到 $x_1^{0,2} \\approx 150.4$。\n\n两次连续子迭代的最终结果是数对 $(x_1^{0,1}, x_1^{0,2})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n206.9  150.4\n\\end{pmatrix}\n}\n$$"
        }
    ]
}