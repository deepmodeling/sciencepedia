{
    "hands_on_practices": [
        {
            "introduction": "在尝试进行完整的图像重建之前，我们其实可以直接从投影数据（正弦图）中提取出关于物体的宝贵信息。这项练习将向你展示，通过对投影数据进行简单的矩计算，我们就能揭示出物体质心和空间朝向等宏观几何特征。这不仅为我们提供了一种强大的数据质量检查方法，也加深了我们对Radon变换如何编码几何信息的直观理解。",
            "id": "4913422",
            "problem": "一个具有空间分布 $f(x,y)$ 的二维物体代表了与计算机断层扫描 (CT) 相关的归一化横截面属性。该物体是紧支撑且可积的，所有坐标均使用归一化单位（无物理单位）。考虑其由Radon变换表征的投影。设在角度 $\\theta$（以弧度为单位）处的投影由Radon变换定义为\n$$\np(\\theta,s) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\!\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy,\n$$\n其中 $\\delta(\\cdot)$ 是狄拉克δ分布，$s$ 是沿投影线法线方向到原点的有符号距离。\n\n定义$n$阶投影矩为\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds.\n$$\n\n仅从这些定义以及物体质心和二阶矩的定义出发，\n$$\nM = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,dx\\,dy,\\quad\n\\boldsymbol{\\mu} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y)\\,dx\\,dy,\n$$\n$$\n\\mathbf{R} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\\begin{pmatrix} x  y \\end{pmatrix} f(x,y)\\,dx\\,dy,\\quad\n\\mathbf{C} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x  y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy,\n$$\n通过交换积分顺序并计算狄拉克δ积分，推导出前两个矩条件 $m_1(\\theta)$ 和 $m_2(\\theta)$。明确地将 $m_1(\\theta)$ 与质心 $\\boldsymbol{\\mu}$ 联系起来，并将 $m_2(\\theta)$ 与原始二阶矩矩阵 $\\mathbf{R}$（或等价地，与协方差矩阵 $\\mathbf{C}$ 和质心 $\\boldsymbol{\\mu}$）联系起来。\n\n然后，将你推导出的关系应用于总质量为 $M = 1$、质心为\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix},\n$$\n且协方差矩阵为\n$$\n\\mathbf{C} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}\n$$\n的特定归一化物体。将一阶和二阶投影矩 $m_1(\\theta)$ 和 $m_2(\\theta)$ 表示为关于 $\\theta$（以弧度为单位）的显式函数。无需四舍五入。以包含 $m_1(\\theta)$ 和 $m_2(\\theta)$（按此顺序）的单行矩阵形式提供你的最终答案。",
            "solution": "问题陈述已经过验证，被认为具有科学依据、是良定的、客观且自洽的。所提供的关于Radon变换、投影矩以及物体分布统计矩的定义，在计算机断层扫描和数学图像分析领域是标准的。特定物体的数值在物理上和数学上是一致的，因为给定的协方差矩阵是对称且正定的。因此，该问题是有效的，并且可以推导出完整的解。\n\n主要任务是推导一阶和二阶投影矩 $m_1(\\theta)$ 和 $m_2(\\theta)$ 的表达式，然后将这些表达式应用于一个具体案例。\n\n我们从$n$阶投影矩 $m_n(\\theta)$ 的定义开始：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds\n$$\n我们代入Radon变换 $p(\\theta,s)$ 的定义：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n} \\left( \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy \\right) ds\n$$\n正如题目建议，我们交换积分顺序。这是允许的，因为函数 $f(x,y)$ 是紧支撑且可积的。\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y) \\left( \\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds \\right) dx\\,dy\n$$\n关于 $s$ 的内部积分可以使用狄拉克δ分布的筛选性质 $\\int_{-\\infty}^{\\infty} g(t)\\delta(t-a)dt = g(a)$来计算。在本例中，积分变量是 $s$，函数是 $g(s) = s^n$，位移是 $a = x\\cos(\\theta) + y\\sin(\\theta)$。该积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds = \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n\n$$\n将此结果代回，得到$n$阶投影矩的一般表达式，这通常被称为矩的投影切片定理：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n f(x,y) \\,dx\\,dy\n$$\n\n现在，我们推导 $m_1(\\theta)$ 和 $m_2(\\theta)$ 的表达式。\n\n对于一阶矩 ($n=1$)：\n$$\nm_1(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\n根据积分的线性性质，我们可以分离各项：\n$$\nm_1(\\theta) = \\cos(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} x f(x,y) \\,dx\\,dy + \\sin(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} y f(x,y) \\,dx\\,dy\n$$\n根据质心 $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_x \\\\ \\mu_y \\end{pmatrix}$ 的定义，我们有一阶原始矩向量的分量 $\\int\\int \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y) \\,dx\\,dy = M\\boldsymbol{\\mu}$。具体来说：\n$$\n\\int\\int x f(x,y) \\,dx\\,dy = M\\mu_x \\quad \\text{和} \\quad \\int\\int y f(x,y) \\,dx\\,dy = M\\mu_y\n$$\n将这些代入 $m_1(\\theta)$ 的表达式中，得到：\n$$\nm_1(\\theta) = M(\\mu_x \\cos(\\theta) + \\mu_y \\sin(\\theta))\n$$\n这可以用向量表示法紧凑地表示。设 $\\mathbf{u}(\\theta) = \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}$。那么：\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta)\n$$\n这就是所要求的 $m_1(\\theta)$ 和质心 $\\boldsymbol{\\mu}$ 之间的关系。\n\n对于二阶矩 ($n=2$)：\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^2 f(x,y) \\,dx\\,dy\n$$\n展开平方项：\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x^2\\cos^2(\\theta) + 2xy\\cos(\\theta)\\sin(\\theta) + y^2\\sin^2(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\n根据线性性质分离各项：\n$$\nm_2(\\theta) = \\cos^2(\\theta)\\int\\int x^2 f(x,y) dxdy + 2\\cos(\\theta)\\sin(\\theta)\\int\\int xy f(x,y) dxdy + \\sin^2(\\theta)\\int\\int y^2 f(x,y) dxdy\n$$\n这些积分是原始二阶矩矩阵 $\\mathbf{R}$ 的分量：\n$$\n\\mathbf{R} = \\int\\int \\begin{pmatrix} x^2  xy \\\\ yx  y^2 \\end{pmatrix} f(x,y)\\,dx\\,dy = \\begin{pmatrix} R_{xx}  R_{xy} \\\\ R_{yx}  R_{yy} \\end{pmatrix}\n$$\n所以，我们可以将 $m_2(\\theta)$写作：\n$$\nm_2(\\theta) = R_{xx}\\cos^2(\\theta) + 2R_{xy}\\cos(\\theta)\\sin(\\theta) + R_{yy}\\sin^2(\\theta)\n$$\n这个二次型可以用向量 $\\mathbf{u}(\\theta)$ 紧凑地表示为：\n$$\nm_2(\\theta) = \\mathbf{u}(\\theta)^{\\top} \\mathbf{R} \\mathbf{u}(\\theta)\n$$\n这就是所要求的 $m_2(\\theta)$ 和矩阵 $\\mathbf{R}$ 之间的关系。\n\n为了将 $m_2(\\theta)$ 与协方差矩阵 $\\mathbf{C}$ 和质心 $\\boldsymbol{\\mu}$ 联系起来，我们使用连接 $\\mathbf{R}$、$\\mathbf{C}$ 和 $\\boldsymbol{\\mu}$ 的平行轴定理。从 $\\mathbf{C}$ 的定义开始：\n$$\n\\mathbf{C} = \\frac{1}{M}\\int\\int \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x  y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy\n$$\n展开积分内的乘积得到 $\\mathbf{R} = M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}$。将此代入我们关于 $m_2(\\theta)$ 的表达式中：\n$$\nm_2(\\theta) = \\mathbf{u}^{\\top} (M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}) \\mathbf{u} = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M(\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u})\n$$\n由于 $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}$ 是一个标量，我们有 $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = (\\mathbf{u}^{\\top}\\boldsymbol{\\mu})(\\boldsymbol{\\mu}^{\\top}\\mathbf{u}) = (\\boldsymbol{\\mu}^{\\top}\\mathbf{u})^2$。\n从 $m_1(\\theta)$ 的推导中，我们知道 $\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = m_1(\\theta)/M$。因此：\n$$\nm_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M\\left(\\frac{m_1(\\theta)}{M}\\right)^2 = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}\n$$\n这就是期望的用 $\\mathbf{C}$ 和 $\\boldsymbol{\\mu}$ (通过 $m_1(\\theta)$)表示 $m_2(\\theta)$ 的关系。\n\n现在我们将这些推导出的关系应用于具有 $M=1$、$\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$ 和 $\\mathbf{C} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$ 的特定物体。\n\n$m_1(\\theta)$ 的计算：\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta) = 1 \\times \\begin{pmatrix} 2  -1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix} = 2\\cos(\\theta) - \\sin(\\theta)\n$$\n\n$m_2(\\theta)$ 的计算：\n我们使用表达式 $m_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}$。当 $M=1$ 时，这简化为 $m_2(\\theta) = \\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} + m_1(\\theta)^2$。\n首先，我们计算二次型 $\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}$：\n$$\n\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} = \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta) \\end{pmatrix} \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}\n$$\n$$\n= 3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)\n$$\n接下来，我们计算 $m_1(\\theta)^2$：\n$$\nm_1(\\theta)^2 = (2\\cos(\\theta) - \\sin(\\theta))^2 = 4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta)\n$$\n将这两部分相加：\n$$\nm_2(\\theta) = (3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)) + (4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta))\n$$\n$$\nm_2(\\theta) = 7\\cos^2(\\theta) - 2\\cos(\\theta)\\sin(\\theta) + 3\\sin^2(\\theta)\n$$\n为了获得一个更紧凑的表达式，我们使用二倍角恒等式：$\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$，$\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$，以及 $2\\cos(\\theta)\\sin(\\theta) = \\sin(2\\theta)$。\n$$\nm_2(\\theta) = 7\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) - \\sin(2\\theta) + 3\\left(\\frac{1-\\cos(2\\theta)}{2}\\right)\n$$\n$$\nm_2(\\theta) = \\frac{7}{2} + \\frac{7}{2}\\cos(2\\theta) - \\sin(2\\theta) + \\frac{3}{2} - \\frac{3}{2}\\cos(2\\theta)\n$$\n$$\nm_2(\\theta) = \\frac{10}{2} + \\left(\\frac{7-3}{2}\\right)\\cos(2\\theta) - \\sin(2\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n$$\n因此，一阶和二阶投影矩的表达式为：\n$m_1(\\theta) = 2\\cos(\\theta) - \\sin(\\theta)$\n$m_2(\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\cos(\\theta) - \\sin(\\theta)  5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "“滤波反投影”（Filtered Backprojection）方法中的“滤波”环节不仅仅是数学上的必然，更是我们在实际应用中进行关键权衡的步骤。这项练习将探讨几种不同的“窗函数”（window functions）如何影响理想斜坡滤波器的性能，并最终决定重建图像中的噪声水平。通过这个实践，你将掌握在图像锐度（分辨率）和噪声抑制之间进行妥协的基本原理。",
            "id": "4913443",
            "problem": "一个二维平行束断层扫描系统采集一个空间分布为 $f(x,y)$ 的物体的投影，其模型为拉东变换 $R f(\\theta,s)$，其中 $\\theta$ 是投影角度，$s$ 是探测器位置。重建过程通过滤波反投影（FBP）算法完成，该算法首先用一个频率响应为 $H(\\omega)$ 的频域滤波器对每个投影进行线性滤波，然后进行反投影。在理想的无噪声极限下，标准的FBP滤波器包含幅度斜坡 $|\\omega|$，但实际应用中会将 $|\\omega|$ 乘以一个窗函数 $W(\\omega)$，以在分辨率和噪声之间进行权衡。\n\n考虑三个截止频率为 $\\omega_{c}$ 的窗函数：\n- Ram–Lak 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{RL}}(\\omega) = 1$；否则 $W_{\\mathrm{RL}}(\\omega) = 0$。\n- Shepp–Logan 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{SL}}(\\omega) = \\dfrac{\\sin\\!\\big(\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}\\big)}{\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$；否则 $W_{\\mathrm{SL}}(\\omega) = 0$。\n- Hamming 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{H}}(\\omega) = 0.54 + 0.46 \\cos\\!\\big(\\dfrac{\\pi\\,\\omega}{\\omega_{c}}\\big)$；否则 $W_{\\mathrm{H}}(\\omega) = 0$。\n\n假设对于每个角度 $\\theta$，投影测量值包含加性、零均值、白噪声，该噪声沿探测器位置 $s$ 是宽平稳的，具有恒定的双边功率谱密度 $S_{0}$，并且在不同角度间是独立的。从线性系统的观点出发（在频域中使用 $H(\\omega) = |\\omega|\\,W(\\omega)$ 进行滤波，然后进行反投影），并根据滤波后白噪声的方差定义，推导这三种窗函数对应的频率响应 $H_{\\mathrm{RL}}(\\omega)$、$H_{\\mathrm{SL}}(\\omega)$ 和 $H_{\\mathrm{H}}(\\omega)$，并求出在重建像素处图像域相对噪声方差放大因子的解析表达式。所谓“相对”，是指将所有三个因子相对于 Ram–Lak 情形进行归一化，使得 Ram–Lak 因子的值为 $1$。将最终答案表示为一个单行矩阵，顺序为 Ram–Lak、Shepp–Logan、Hamming。无需四舍五入。这些比值为无量纲量。",
            "solution": "用户希望求出在滤波反投影（FBP）中使用的三种不同窗函数的相对噪声方差放大因子。\n\n### 第 1 步：问题验证\n该问题描述了计算机断层扫描（CT）图像重建中的一个标准情景。\n- **已知条件**：\n    - 物体分布：$f(x,y)$\n    - 投影模型：拉东变换 $R f(\\theta,s)$\n    - 重建算法：滤波反投影 (FBP)\n    - 频域中的 FBP 滤波器：$H(\\omega) = |\\omega|\\,W(\\omega)$，其中 $\\omega$ 是空间频率。\n    - 截止频率为 $\\omega_c$ 的窗函数 $W(\\omega)$：\n        1. Ram–Lak 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{RL}}(\\omega) = 1$；否则为 $0$。\n        2. Shepp–Logan 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{SL}}(\\omega) = \\dfrac{\\sin(\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}})}{\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$；否则为 $0$。\n        3. Hamming 窗：当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{H}}(\\omega) = 0.54 + 0.46 \\cos(\\frac{\\pi\\,\\omega}{\\omega_{c}})$；否则为 $0$。\n    - 噪声模型：沿探测器位置 $s$ 的加性、零均值、白噪声、宽平稳（WSS），具有恒定的双边功率谱密度（PSD）$S_{0}$，且在各投影角度 $\\theta$ 间独立。\n- **验证**：\n    - **科学依据**：该问题坚实地植根于线性系统理论和断层成像的数学基础（拉东变换，FBP）。所有模型和定义都是该领域的标准。\n    - **定义明确**：问题陈述清晰，提供了所有必要的定义。任务是为定义明确的物理量（相对噪声方差）推导解析表达式，从而得到唯一解。\n    - **客观性**：语言精确，没有主观性。\n- **结论**：该问题有效。\n\n### 第 2 步：推导噪声方差放大\n\nFBP 过程包括两个线性操作：滤波和反投影。我们关心的是输入噪声如何传播到重建图像中。\n\n设角度 $\\theta$ 处投影中的噪声为 $n(\\theta, s)$。问题指出这是一个零均值、宽平稳（WSS）的随机过程，具有恒定的功率谱密度（PSD），$S_{n}(\\omega) = S_{0}$。这是白噪声的定义。\n\n**滤波阶段：**\n对于每个投影角度 $\\theta$，带噪投影由一个频率响应为 $H(\\omega) = |\\omega|W(\\omega)$ 的线性时不变（LTI）滤波器进行滤波。对于一个输入为 PSD 为 $S_{in}(\\omega)$ 的随机过程，经过频率响应为 $H(\\omega)$ 的线性系统后，其输出是一个 PSD 为 $S_{out}(\\omega) = S_{in}(\\omega) |H(\\omega)|^2$ 的随机过程。\n\n在我们的例子中，输入是噪声 $n(\\theta, s)$，其 PSD 为 $S_{n}(\\omega) = S_0$。滤波后的噪声，我们称之为 $n_f(\\theta, s)$，其 PSD $S_{n_f}(\\omega)$ 由下式给出：\n$$S_{n_f}(\\omega) = S_{0} |H(\\omega)|^2 = S_{0} \\big| |\\omega|W(\\omega) \\big|^2 = S_{0} \\omega^2 W(\\omega)^2$$\n窗函数 $W(\\omega)$ 是实值的，所以 $|W(\\omega)|^2 = W(\\omega)^2$。\n\n滤波后噪声的方差 $\\sigma_f^2$ 是其 PSD 在所有频率上的积分。根据信号处理中角频率 $\\omega$ 的标准定义，可得：\n$$\\sigma_f^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{n_f}(\\omega) \\,d\\omega = \\frac{S_{0}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n\n**反投影阶段：**\n反投影操作对所有角度 $\\theta$（从 $0$ 到 $\\pi$）的滤波后投影 $n_f(\\theta, s)$ 进行求和（积分）。最终重建图像中给定像素的噪声是此积分的结果。由于假设噪声在不同角度间是独立的，因此和的方差等于方差的和。更正式地说，反投影对滤波后的噪声过程进行积分。这个对 $\\theta$ 的积分导致最终的图像噪声方差 $\\sigma_{\\text{img}}^2$ 与滤波后投影的方差 $\\sigma_f^2$ 成正比。\n$$\\sigma_{\\text{img}}^2 \\propto \\sigma_f^2$$\n因此，最终图像中噪声方差的放大与以下积分成正比：\n$$I_W = \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n由于所有窗函数在 $|\\omega|  \\omega_c$ 时均为零，该积分是有界的：\n$$I_W = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n我们需要为这三个窗函数分别计算这个积分，然后找出它们相对于 Ram-Lak 情形的比率。对于这三个窗函数，被积函数 $\\omega^2 W(\\omega)^2$ 都是 $\\omega$ 的偶函数，所以我们可以写成 $I_W = 2 \\int_{0}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$。\n\n### 第 3 步：积分计算\n\n**1. Ram–Lak (RL) 窗**\n$W_{\\mathrm{RL}}(\\omega) = 1$，当 $|\\omega| \\le \\omega_{c}$ 时。\n$$I_{\\mathrm{RL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (1)^2 \\,d\\omega = 2 \\int_{0}^{\\omega_c} \\omega^2 \\,d\\omega = 2 \\left[ \\frac{\\omega^3}{3} \\right]_{0}^{\\omega_c} = \\frac{2}{3} \\omega_c^3$$\n这将作为我们的归一化常数。Ram-Lak 窗的相对放大因子是 $A_{\\mathrm{RL}} = I_{\\mathrm{RL}}/I_{\\mathrm{RL}} = 1$。\n\n**2. Shepp–Logan (SL) 窗**\n$W_{\\mathrm{SL}}(\\omega) = \\frac{\\sin(a\\omega)}{a\\omega}$，其中 $a = \\frac{\\pi}{2\\omega_c}$。\n$$I_{\\mathrm{SL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\left( \\frac{\\sin(a\\omega)}{a\\omega} \\right)^2 \\,d\\omega = \\frac{1}{a^2} \\int_{-\\omega_c}^{\\omega_c} \\sin^2(a\\omega) \\,d\\omega$$\n使用恒等式 $\\sin^2(x) = \\frac{1 - \\cos(2x)}{2}$：\n$$I_{\\mathrm{SL}} = \\frac{2}{a^2} \\int_{0}^{\\omega_c} \\frac{1 - \\cos(2a\\omega)}{2} \\,d\\omega = \\frac{1}{a^2} \\left[ \\omega - \\frac{\\sin(2a\\omega)}{2a} \\right]_{0}^{\\omega_c}$$\n在积分上限 $\\omega = \\omega_c$ 处，正弦函数的参数是 $2a\\omega_c = 2(\\frac{\\pi}{2\\omega_c})\\omega_c = \\pi$。由于 $\\sin(\\pi) = 0$ 且 $\\sin(0) = 0$，正弦项消失。\n$$I_{\\mathrm{SL}} = \\frac{1}{a^2} (\\omega_c - 0) = \\frac{\\omega_c}{a^2} = \\frac{\\omega_c}{(\\pi/(2\\omega_c))^2} = \\frac{\\omega_c}{\\pi^2/(4\\omega_c^2)} = \\frac{4\\omega_c^3}{\\pi^2}$$\n相对放大因子是：\n$$A_{\\mathrm{SL}} = \\frac{I_{\\mathrm{SL}}}{I_{\\mathrm{RL}}} = \\frac{4\\omega_c^3/\\pi^2}{2\\omega_c^3/3} = \\frac{4}{\\pi^2} \\cdot \\frac{3}{2} = \\frac{6}{\\pi^2}$$\n\n**3. Hamming (H) 窗**\n$W_{\\mathrm{H}}(\\omega) = P + Q\\cos(b\\omega)$，当 $|\\omega| \\le \\omega_{c}$ 时，其中 $P = 0.54$，$Q = 0.46$，$b = \\frac{\\pi}{\\omega_c}$。\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (P + Q\\cos(b\\omega))^2 \\,d\\omega$$\n展开平方：\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\left( P^2\\omega^2 + 2PQ\\omega^2\\cos(b\\omega) + Q^2\\omega^2\\cos^2(b\\omega) \\right) \\,d\\omega$$\n我们计算三个积分项：\n第 1 项：$\\int_{-\\omega_c}^{\\omega_c} P^2\\omega^2 \\,d\\omega = P^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega = P^2 \\left(\\frac{2}{3}\\omega_c^3\\right)$。\n第 2 项：$2PQ \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega$。通过两次分部积分，可以得到 $\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega = -\\frac{4\\omega_c^3}{\\pi^2}$。所以，该项为 $2PQ \\left(-\\frac{4\\omega_c^3}{\\pi^2}\\right) = -\\frac{8PQ\\omega_c^3}{\\pi^2}$。\n第 3 项：$Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos^2(b\\omega) \\,d\\omega = Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\frac{1+\\cos(2b\\omega)}{2} \\,d\\omega$。这可以分解为 $\\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega + \\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(2b\\omega) \\,d\\omega$。第一个积分是 $\\frac{2}{3}\\omega_c^3$。第二个积分同样通过分部积分，得到 $\\frac{\\omega_c^3}{\\pi^2}$。所以，第 3 项是 $\\frac{Q^2}{2}\\left(\\frac{2}{3}\\omega_c^3 + \\frac{\\omega_c^3}{\\pi^2}\\right) = Q^2\\omega_c^3\\left(\\frac{1}{3} + \\frac{1}{2\\pi^2}\\right)$。\n\n对 $I_{\\mathrm{H}}$ 的各项求和：\n$$I_{\\mathrm{H}} = \\omega_c^3 \\left[ \\frac{2}{3}P^2 - \\frac{8PQ}{\\pi^2} + \\frac{1}{3}Q^2 + \\frac{Q^2}{2\\pi^2} \\right]$$\n相对放大因子为 $A_{\\mathrm{H}} = I_{\\mathrm{H}}/I_{\\mathrm{RL}}$：\n$$A_{\\mathrm{H}} = \\frac{\\omega_c^3 \\left[ \\frac{2}{3}P^2 + \\frac{1}{3}Q^2 - \\frac{8PQ}{\\pi^2} + \\frac{Q^2}{2\\pi^2} \\right]}{\\frac{2}{3}\\omega_c^3} = \\frac{3}{2} \\left[ \\frac{1}{3}(2P^2+Q^2) + \\frac{1}{2\\pi^2}(Q^2 - 16PQ) \\right]$$\n$$A_{\\mathrm{H}} = \\frac{1}{2}(2P^2+Q^2) + \\frac{3}{4\\pi^2}(Q^2 - 16PQ)$$\n代入 $P = 0.54 = \\frac{27}{50}$ 和 $Q = 0.46 = \\frac{23}{50}$：\n$2P^2+Q^2 = 2\\left(\\frac{27}{50}\\right)^2 + \\left(\\frac{23}{50}\\right)^2 = \\frac{2 \\cdot 729 + 529}{2500} = \\frac{1458+529}{2500} = \\frac{1987}{2500}$。\n$Q^2-16PQ = \\left(\\frac{23}{50}\\right)^2 - 16\\left(\\frac{27}{50}\\right)\\left(\\frac{23}{50}\\right) = \\frac{529 - 16 \\cdot 621}{2500} = \\frac{529 - 9936}{2500} = -\\frac{9407}{2500}$。\n$$A_{\\mathrm{H}} = \\frac{1}{2}\\left(\\frac{1987}{2500}\\right) + \\frac{3}{4\\pi^2}\\left(-\\frac{9407}{2500}\\right) = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$$\n\n### 第 4 步：最终答案\nRam-Lak、Shepp-Logan 和 Hamming 窗的相对噪声方差放大因子分别为：\n1. $A_{\\mathrm{RL}} = 1$\n2. $A_{\\mathrm{SL}} = \\frac{6}{\\pi^2}$\n3. $A_{\\mathrm{H}} = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$\n\n我们按要求将它们表示为一个单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{6}{\\pi^2}  \\frac{1987}{5000} - \\frac{28221}{10000 \\pi^2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "任何重建算法都不是完美的，其过程中的选择（例如滤波器的设计）会在最终图像中引入特有的伪影。这项练习将深入研究“吉布斯现象”（Gibbs phenomenon），即在物体尖锐边缘附近出现的振铃状伪影。通过对成像系统响应进行建模，你将了解到这种伪影是如何作为重建滤波器频率域有限性的直接产物而产生的。",
            "id": "4913446",
            "problem": "一个强度为单位的均匀圆形圆盘模型，使用滤波反投影（FBP）方法，通过平行束计算机断层扫描（CT）进行重建。假设重建在图像平面上是线性和移不变的，因此重建图像等于真实物体与点扩散函数（PSF）的卷积。重建的有效调制传递函数（MTF）被建模为一个理想的、圆形对称的、带限通带：\n$$\nM(\\mathbf{k}) = \\begin{cases}\n1,  |\\mathbf{k}| \\leq k_c, \\\\\n0,  |\\mathbf{k}|  k_c,\n\\end{cases}\n$$\n其中 $\\mathbf{k} = (k_x, k_y)$ 是空间频率向量，$k_c  0$ 是截止空间频率。使用二维傅里葉变换的约定\n$$\n\\mathcal{F}\\{f\\}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) \\exp(-i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{x}, \\quad\n\\mathcal{F}^{-1}\\{F\\}(\\mathbf{x}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} F(\\mathbf{k}) \\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{k}.\n$$\n在圆盘边界上的任意一点，考虑一个局部正交坐标系，其中 $x$ 表示指向边缘的向内法线方向，理想内部为半平面 $x0$。将真实物体在局部建模为在 $x=0$ 处跨越边缘的单位阶跃函数 $u(x)$。\n\n从上述定义出发，推导边缘扩散函数 $s(x)$，该函数定义为跨越边缘的重建强度作为 $x$ 的函数，用 PSF 和单位阶跃输入来表示。然后，使用 $s(x)$ 通过确定第一个过冲超过渐近内部值的大小来量化吉布斯现象。将此过冲表示为阶跃高度的无量纲分数。你的最终答案必须是一个四舍五入到五位有效数字的实数。不需要物理单位。",
            "solution": "问题要求计算CT重建中吉布斯现象过冲的幅度，并将其表示为边缘阶跃高度的一部分。该系统被建模为线性和移不变（LSI）系统，在频域中具有一个理想的、圆形对称的低通滤波器。\n\n重建后的图像，我们记为 $f_{rec}(\\mathbf{x})$，是真实物体 $f_{true}(\\mathbf{x})$ 与系统点扩散函数（PSF） $h(\\mathbf{x})$ 的卷积：\n$$f_{rec}(\\mathbf{x}) = (f_{true} * h)(\\mathbf{x})$$\n问题指出，调制传递函数（MTF） $M(\\mathbf{k})$ 是指定的理想低通滤波器。在线性移不变（LSI）系统中，PSF是光学传递函数（OTF）的傅里叶逆变换。MTF是OTF的模。由于给定的 $M(\\mathbf{k})$ 是实数且非负，我们可以将OTF等同于MTF：\n$$OTF(\\mathbf{k}) = M(\\mathbf{k}) = \\begin{cases} 1,  |\\mathbf{k}| \\leq k_c \\\\ 0,  |\\mathbf{k}|  k_c \\end{cases}$$\n问题通过考虑圆形圆盘边缘的一个局部区域来简化分析。在该区域中，弯曲的边缘被近似为一条直线，真实物体被建模为沿 $x$ 轴方向的单位阶跃函数：\n$$f_{true}(\\mathbf{x}) = u(x) = \\begin{cases} 1,  x > 0 \\\\ 0,  x \\le 0 \\end{cases}$$\n重建的图像，称为边缘扩散函数（ESF） $s(x,y)$，由于输入物体的一维特性，仅依赖于垂直于边缘的坐标 $x$。\n$$s(x) = \\int\\limits_{-\\infty}^{\\infty}\\int\\limits_{-\\infty}^{\\infty} u(x') h(x-x', y-y') \\, dx' \\, dy'$$\n这可以表示为输入 $u(x)$ 与线扩散函数（LSF） $L(x)$ 的一维卷积：\n$$s(x) = (u * L)(x)$$\n其中LSF是二维PSF沿平行于边缘方向的积分：\n$$L(x) = \\int_{-\\infty}^{\\infty} h(x,y) \\, dy$$\n与傅里叶变换相关的一个基本性质（投影切片定理）指出，LSF的一维傅里叶变换 $\\mathcal{F}_1\\{L\\}(k_x)$ 等于二维OTF在 $k_y=0$ 处的中心切片：\n$$\\mathcal{F}_1\\{L\\}(k_x) = OTF(k_x, 0)$$\n根据 $OTF(\\mathbf{k})$ 的定义，我们有：\n$$\\mathcal{F}_1\\{L\\}(k_x) = \\begin{cases} 1,  |k_x| \\leq k_c \\\\ 0,  |k_x|  k_c \\end{cases}$$\n这是一个频域中的矩形函数。LSF通过进行一维傅里叶逆变换得到。根据指定的约定，一个 $d$ 维函数的逆变换有一个 $1/(2\\pi)^d$ 的前置因子，对于 $d=1$，我们使用 $1/(2\\pi)$：\n$$L(x) = \\mathcal{F}_1^{-1}\\{\\mathcal{F}_1\\{L\\}\\}(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathcal{F}_1\\{L\\}(k_x) \\exp(i k_x x) \\, dk_x$$\n$$L(x) = \\frac{1}{2\\pi} \\int_{-k_c}^{k_c} (1) \\cdot \\exp(i k_x x) \\, dk_x$$\n计算积分：\n$$L(x) = \\frac{1}{2\\pi} \\left[ \\frac{\\exp(i k_x x)}{ix} \\right]_{-k_c}^{k_c} = \\frac{1}{2\\pi ix} (\\exp(i k_c x) - \\exp(-i k_c x)) = \\frac{2i\\sin(k_c x)}{2\\pi ix} = \\frac{\\sin(k_c x)}{\\pi x}$$\nESF，$s(x)$，是 $u(x)$ 和 $L(x)$ 的卷积，这等同于LSF的积分：\n$$s(x) = (u * L)(x) = \\int_{-\\infty}^{x} L(\\tau) \\, d\\tau$$\n$$s(x) = \\int_{-\\infty}^{x} \\frac{\\sin(k_c \\tau)}{\\pi \\tau} \\, d\\tau$$\n为了计算这个积分，我们进行换元，$z = k_c \\tau$，因此 $d\\tau = dz/k_c$：\n$$s(x) = \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{\\pi (z/k_c)} \\frac{dz}{k_c} = \\frac{1}{\\pi} \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{z} \\, dz$$\n我们可以拆分积分：\n$$s(x) = \\frac{1}{\\pi} \\left( \\int_{-\\infty}^{0} \\frac{\\sin(z)}{z} \\, dz + \\int_{0}^{k_c x} \\frac{\\sin(z)}{z} \\, dz \\right)$$\n第一个积分是一个已知的定积分，$\\int_0^{\\infty} \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$。根据对称性，$\\int_{-\\infty}^0 \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$。第二个积分是正弦积分函数 $\\text{Si}(t) = \\int_0^t \\frac{\\sin(z)}{z} dz$ 的定义。\n因此，ESF为：\n$$s(x) = \\frac{1}{\\pi} \\left( \\frac{\\pi}{2} + \\text{Si}(k_c x) \\right) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c x)$$\n渐近内部值对应于 $x \\to \\infty$。当 $x \\to \\infty$ 时，$k_c x \\to \\infty$，且 $\\lim_{t\\to\\infty} \\text{Si}(t) = \\frac{\\pi}{2}$。\n$$s_{interior} = \\lim_{x\\to\\infty} s(x) = \\frac{1}{2} + \\frac{1}{\\pi} \\left(\\frac{\\pi}{2}\\right) = 1$$\n渐近外部值对应于 $x \\to -\\infty$，此时 $\\lim_{t\\to-\\infty} \\text{Si}(t) = -\\frac{\\pi}{2}$，得到 $s_{exterior} = 0$。阶跃高度为 $s_{interior} - s_{exterior} = 1 - 0 = 1$。\n\n吉布斯现象表现为不连续点周围的振铃。过冲可以通过找到 $s(x)$ 在 $x0$ 时的第一个最大值来确定。我们通过将 $s(x)$ 的导数设为零来找到极值点：\n$$\\frac{ds}{dx} = L(x) = \\frac{\\sin(k_c x)}{\\pi x} = 0$$\n这发生在 $\\sin(k_c x) = 0$ 时，这意味着对于任何非零整数 $n$，$k_c x = n\\pi$。极值点位于 $x_n = n\\pi/k_c$。在 $x0$ 区域的第一个极值点是当 $n=1$ 时，位于 $x_1 = \\pi/k_c$。这个位置对应于一个最大值（第一个过冲）。\n在该点ESF的值为：\n$$s_{peak} = s(\\pi/k_c) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c \\cdot \\frac{\\pi}{k_c}) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)$$\n第一个过冲超过渐近内部值的大小为：\n$$Overshoot = s_{peak} - s_{interior} = \\left(\\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)\\right) - 1 = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\n问题要求将此过冲表示为阶跃高度的无量纲分数。由于阶跃高度为 $1$，这个分数等于过冲的大小本身。\n$$Fractional \\ Overshoot = \\frac{Overshoot}{Step \\ Height} = \\frac{\\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}}{1} = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\n为了找到数值，我们使用正弦积分在 $\\pi$ 处的值，即 $\\text{Si}(\\pi) \\approx 1.85193705$。\n$$Fractional \\ Overshoot \\approx \\frac{1.85193705}{3.14159265} - 0.5 \\approx 0.58949446 - 0.5 = 0.08949446$$\n四舍五入到五位有效数字，我们得到 $0.08949$。",
            "answer": "$$\\boxed{0.08949}$$"
        }
    ]
}