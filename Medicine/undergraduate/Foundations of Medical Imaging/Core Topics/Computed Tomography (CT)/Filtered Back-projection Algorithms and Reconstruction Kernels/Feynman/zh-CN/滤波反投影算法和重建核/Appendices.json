{
    "hands_on_practices": [
        {
            "introduction": "滤波反投影（FBP）算法的核心是对投影数据进行滤波。本实践将理论付诸实践，指导您在频域中实现几个标准的重建核。通过使用简单的正弦信号测试您的滤波器，您将对这些核在实践中如何工作获得具体的理解。",
            "id": "4884813",
            "problem": "您的任务是，从第一性原理出发，为用于平行束计算机断层扫描的滤波反投影算法设计并实现一个频域滤波阶段。请从傅里叶切片定理和卷积定理开始，推导出应用于每个投影的一维滤波器的结构。然后，在频域中实现该滤波器，并使用正弦测试输入进行验证。\n\n需要使用的基础理论：\n- 函数 $f(x,y)$ 的拉东变换 $\\mathcal{R}f(s,\\theta)$ 定义为 $f$ 沿着由探测器坐标 $s$ 和角度 $\\theta$ 参数化的直线的积分，并满足傅里叶切片定理：$\\mathcal{R}f(s,\\theta)$ 在 $s$ 上的一维傅里叶变换，等于 $f(x,y)$ 的二维傅里叶变换在穿过原点、角度为 $\\theta$ 的直线上的限制。\n- 卷积定理指出，卷积的傅里叶变换是傅里叶变换的乘积，反之，频域中的乘法对应于空间域中的卷积。\n\n您的任务：\n1.  根据傅里叶切片定理和拉东逆变换所基于的变量变换，推导出应用于每个投影的频域滤波具有以下通用形式：\n    $$H(\\omega) = |\\omega|\\,W(\\omega),$$\n    其中 $W(\\omega)$ 是一个窗函数，用于强制实现带宽限制并稳定噪声放大。请确保您的推导解释了因子 $|\\omega|$ 出现的原因。\n2.  对于数值实现，考虑一个均匀采样的投影 $p_n = p(s_n)$，其中 $s_n = n\\,\\Delta s$，$n=0,1,\\dots,N-1$。对 $p_n$ 使用离散傅里叶变换（DFT），并应用一个在离散角频率网格上构建的 $H(\\omega)$ 的采样版本：\n    $$\\omega_k = 2\\pi f_k,\\quad f_k = \\mathrm{fftfreq}(N,\\Delta s)\\ \\text{(单位长度内的周期数)}。$$\n    截止角频率为\n    $$\\omega_c = \\frac{\\pi}{\\Delta s}。$$\n3.  实现 $W(\\omega)$ 的三种选择，这些选择被定义为经过充分测试的窗函数设计，其支撑集限于 $|\\omega|\\le \\omega_c$：\n    - 矩形窗 (Ram-Lak):\n      $$W_{\\mathrm{RL}}(\\omega) = \\begin{cases}1,|\\omega|\\le \\omega_c\\\\ 0,\\text{其他}\\end{cases}。$$\n    - 余弦窗:\n      $$W_{\\cos}(\\omega) = \\begin{cases}\\cos\\!\\left(\\dfrac{\\pi\\,\\omega}{2\\,\\omega_c}\\right),|\\omega|\\le \\omega_c\\\\ 0,\\text{其他}\\end{cases}。$$\n    - Shepp–Logan 窗（使用未归一化的 sinc 函数 $\\mathrm{sinc}(x)=\\dfrac{\\sin x}{x}$）：\n      $$W_{\\mathrm{SL}}(\\omega) = \\begin{cases}\\mathrm{sinc}\\!\\left(\\dfrac{\\omega}{2\\,\\omega_c}\\right),|\\omega|\\le \\omega_c\\\\ 0,\\text{其他}\\end{cases}。$$\n    在所有情况下，定义 $H(\\omega)=|\\omega|\\,W(\\omega)$。\n4.  使用以下形式的正弦测试投影来验证实现：\n    $$p(s) = \\cos\\!\\left(2\\pi f_0 s\\right),$$\n    采样为 $p_n = \\cos\\!\\left(2\\pi f_0 n \\Delta s\\right)$，其中 $f_0$ 的选择使其精确地与一个 DFT 频点对齐。设 $m$ 是对应于 $f_0$ 的非负整数频点索引，并定义 $f_0=\\dfrac{m}{N\\,\\Delta s}$，因此 $m\\in\\{0,1,\\dots,\\lfloor N/2\\rfloor\\}$。证明经过频域滤波和反变换后，输出的正弦波保持其频率，但其振幅理想上变为 $|H(\\omega_m)|$，其中 $\\omega_m=2\\pi f_0$。使用滤波后信号的 DFT 来测量其在频点 $m$ 处的振幅，特殊情况如下：\n    - 如果 $m=0$（直流分量），振幅为 $$A_{\\mathrm{out}} = \\frac{|\\mathrm{DFT}[m]|}{N}。$$\n    - 如果 $N$ 是偶数且 $m=\\dfrac{N}{2}$（奈奎斯特频率），振幅为 $$A_{\\mathrm{out}} = \\frac{|\\mathrm{DFT}[m]|}{N}。$$\n    - 否则，振幅为 $$A_{\\mathrm{out}} = \\frac{2\\,|\\mathrm{DFT}[m]|}{N}。$$\n5.  对于每个测试用例，计算绝对相对误差\n    $$\\varepsilon = \\begin{cases}\n   |A_{\\mathrm{out}}-A_{\\mathrm{theory}}|/|A_{\\mathrm{theory}}|,\\text{若 }|A_{\\mathrm{theory}}|>0,\\\\\n   |A_{\\mathrm{out}}|,\\text{若 }A_{\\mathrm{theory}}=0,\n   \\end{cases}$$\n    其中 $A_{\\mathrm{theory}}=|H(\\omega_m)|$。\n\n角度单位：三角函数和角频率中的所有角度均以弧度为单位。最终的数值答案不需要物理单位。\n\n测试套件：\n- 情况 1：核 $=$ Ram-Lak, $N=256$, $\\Delta s=1.0$, $m=8$.\n- 情况 2：核 $=$ Shepp–Logan, $N=512$, $\\Delta s=1.0$, $m=17$.\n- 情况 3：核 $=$ 余弦, $N=128$, $\\Delta s=1.0$, $m=64$.\n- 情况 4：核 $=$ Ram-Lak, $N=300$, $\\Delta s=0.8$, $m=0$.\n- 情况 5：核 $=$ Shepp–Logan, $N=1024$, $\\Delta s=0.5$, $m=120$.\n\n程序要求：\n- 按照描述实现频域滤波。\n- 对于每个测试用例，生成 $p_n$，为指定的核构建 $H(\\omega_k)$，在频域中进行滤波，计算频点 $m$ 处的振幅 $A_{\\mathrm{out}}$，计算 $A_{\\mathrm{theory}}=|H(\\omega_m)|$，并返回 $\\varepsilon$ 作为一个浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$$[r_1,r_2,r_3,r_4,r_5]$$），其中每个 $r_i$ 是对应测试用例的浮点数 $\\varepsilon$。",
            "solution": "该问题要求推导并实现用于平行束计算机断层扫描（CT）的滤波反投影（FBP）算法中的频域滤波阶段。该过程使用正弦测试数据进行验证。\n\n### 1. FBP 滤波核的推导\n\n从拉东变换（投影）$p_\\theta(s) = \\mathcal{R}f(s,\\theta)$ 重建二维函数 $f(x,y)$ 是通过滤波反投影算法实现的。推导始于傅里叶逆变换和傅里叶切片定理。\n\n图像频谱 $F(k_x, k_y)$ 的二维傅里叶逆变换为：\n$$f(x,y) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} F(k_x, k_y) e^{i(k_x x + k_y y)} \\,dk_x \\,dk_y$$\n其中 $(k_x, k_y)$ 是频域中的笛卡尔坐标。通常在极坐标 $(\\omega, \\theta)$ 中处理更为方便，其中 $k_x = \\omega \\cos\\theta$ 和 $k_y = \\omega \\sin\\theta$。微分面积元变为 $dk_x\\,dk_y = |\\omega|\\,d\\omega\\,d\\theta$。逆变换通过对每个角度 $\\theta$（从 $0$ 到 $\\pi$）和径向频率 $\\omega$（从 $-\\infty$ 到 $\\infty$）进行积分来重写：\n$$f(x,y) = \\int_{0}^{\\pi} \\left[ \\int_{-\\infty}^{\\infty} F(\\omega \\cos\\theta, \\omega \\sin\\theta) \\, e^{i\\omega(x\\cos\\theta + y\\sin\\theta)} \\,|\\omega|\\, d\\omega \\right] d\\theta$$\n因子 $|\\omega|$ 是从笛卡尔坐标到频域平面中极坐标的变量变换的雅可比行列式。这个因子至关重要，并且是 FBP 滤波器特有的斜坡状形状的来源。\n\n傅里叶切片定理将图像的二维傅里叶变换 $F$ 与其投影的一维傅里叶变换 $P_\\theta(\\omega) = \\mathcal{F}\\{p_\\theta(s)\\}$ 联系起来。具体来说，该定理指出 $P_\\theta(\\omega)$ 是 $F(k_x, k_y)$ 沿着穿过原点、角度为 $\\theta$ 的直线的一个切片：\n$$P_\\theta(\\omega) = F(\\omega \\cos\\theta, \\omega \\sin\\theta)$$\n\n将傅里叶切片定理代入重建公式中得到：\n$$f(x,y) = \\int_{0}^{\\pi} \\left[ \\int_{-\\infty}^{\\infty} P_\\theta(\\omega) \\, |\\omega| \\, e^{i\\omega s} \\, d\\omega \\right]_{s=x\\cos\\theta + y\\sin\\theta} d\\theta$$\n这个表达式可以解释为一个两步过程：\n\n1.  **滤波**：方括号内的内层积分表示一个傅里叶逆变换。它表明对于每个投影角度 $\\theta$，投影的频谱 $P_\\theta(\\omega)$ 乘以一个滤波器 $H(\\omega) \\propto |\\omega|$。\n    $$P_\\theta^{\\text{filtered}}(\\omega) = P_\\theta(\\omega) \\cdot H(\\omega)$$\n    然后将结果变换回空间域，得到滤波后的投影 $p_\\theta^*(s) = \\mathcal{F}^{-1}\\{P_\\theta^{\\text{filtered}}(\\omega)\\}$。\n2.  **反投影**：外层积分将这些滤波后投影 $p_\\theta^*(s)$ 的值在所有角度 $\\theta$ 上求和（积分），其中 $s$ 在 $s=x\\cos\\theta+y\\sin\\theta$ 处取值。这就是反投影操作。\n\n理想滤波器是 $H(\\omega)=|\\omega|$。然而，这个滤波器会放大高频噪声，使得重建不稳定。在实践中，理想滤波器会乘以一个窗函数 $W(\\omega)$，该函数平滑地将滤波器响应在高频处逐渐衰减至零，通常在由探测器采样间隔 $\\Delta s$ 决定的截止频率 $\\omega_c$ 或之前。因此，实用滤波器的通用形式为：\n$$H(\\omega) = |\\omega|\\,W(\\omega)$$\n\n### 2. 离散实现\n\n对于数值实现，投影在离散点 $p_n = p(n\\Delta s)$（$n=0, 1, \\dots, N-1$）上进行采样。连续傅里叶变换被离散傅里叶变换（DFT）所取代。滤波操作变成了在离散频域中的逐点相乘。\n\n1.  **投影的 DFT**：计算采样投影 $p_n$ 的 DFT，以获得其频谱 $P_k = \\mathrm{DFT}\\{p_n\\}$。\n2.  **滤波器构建**：在离散角频率网格 $\\omega_k = 2\\pi f_k$ 上构建滤波器 $H(\\omega)$ 的离散版本，其中 $f_k$ 是由 `numpy.fft.fftfreq(N, d=Δs)` 提供的频率。截止角频率为 $\\omega_c = \\pi/\\Delta s$。\n3.  **窗函数**：问题指定了三种窗函数 $W(\\omega)$，用于 $|\\omega| \\le \\omega_c$：\n    - **Ram-Lak**：$W_{\\mathrm{RL}}(\\omega) = 1$。滤波器为 $H_k = |\\omega_k|$。\n    - **余弦**：$W_{\\cos}(\\omega) = \\cos\\left(\\frac{\\pi\\omega}{2\\omega_c}\\right)$。滤波器为 $H_k = |\\omega_k| \\cos\\left(\\frac{\\pi\\omega_k}{2\\omega_c}\\right)$。\n    - **Shepp–Logan**：$W_{\\mathrm{SL}}(\\omega) = \\mathrm{sinc}\\left(\\frac{\\omega}{2\\omega_c}\\right)$，其中 $\\mathrm{sinc}(x) = \\frac{\\sin x}{x}$。滤波器为 $H_k = |\\omega_k| \\mathrm{sinc}\\left(\\frac{\\omega_k}{2\\omega_c}\\right)$。\n\n4.  **滤波**：将投影的 DFT 与离散滤波器相乘：$P_k^{\\text{filtered}} = P_k \\cdot H_k$。\n5.  **逆 DFT**：计算逆 DFT 以获得空间域中的滤波后投影：$p_n^* = \\mathrm{IDFT}\\{P_k^{\\text{filtered}}\\}$。\n\n### 3. 验证与误差分析\n\n通过对纯正弦输入 $p(s) = \\cos(2\\pi f_0 s)$ 进行滤波，并将输出信号的振幅与理论期望值进行比较，来验证该实现。当输入频率 $f_0$ 精确对应于 DFT 频点索引 $m$（$f_0 = m/(N\\Delta s)$）时，可以避免频谱泄漏，从而实现精确的振幅测量。\n\n理想的线性时不变滤波器在应用于正弦波时，会产生另一个相同频率的正弦波，但其振幅会按该频率处滤波器频率响应的幅值进行缩放。因此，滤波后的投影理想上应为 $p^*(s) = |H(\\omega_m)| \\cos(2\\pi f_0 s)$，其中 $\\omega_m = 2\\pi f_0$。\n\n分析过程如下：\n- 理论输出振幅为 $A_{\\mathrm{theory}}=|H(\\omega_m)|$。\n- 测量的输出振幅 $A_{\\mathrm{out}}$ 通过对数值滤波后的信号 $p_n^*$ 进行 DFT 并检查频点 $m$ 处分量的幅值来确定。归一化取决于频点索引：\n  $$A_{\\mathrm{out}} = \\begin{cases}\n  |\\mathrm{DFT}[m]|/N,  m=0 \\text{ 或 (N 为偶数且 } m=N/2) \\\\\n  2|\\mathrm{DFT}[m]|/N,  \\text{其他情况}\n  \\end{cases}$$\n- 绝对相对误差 $\\varepsilon$ 量化了理论与实现之间的一致性：\n  $$\\varepsilon = \\begin{cases}\n  |A_{\\mathrm{out}}-A_{\\mathrm{theory}}|/|A_{\\mathrm{theory}}|,\\text{若 }|A_{\\mathrm{theory}}|>0,\\\\\n  |A_{\\mathrm{out}}|,\\text{若 }A_{\\mathrm{theory}}=0.\n  \\end{cases}$$\n此过程应用于问题陈述中定义的每个测试用例，以验证所实现滤波器的正确性。",
            "answer": "```python\nimport numpy as np\n\ndef unnormalized_sinc(x):\n    \"\"\"\n    Computes the unnormalized sinc function, sin(x)/x.\n    The problem defines sinc(x) = sin(x)/x, so we implement it directly.\n    np.sinc is the normalized version sin(pi*x)/(pi*x).\n    \"\"\"\n    # Use np.where to handle the x=0 case, where the limit is 1.\n    x = np.asarray(x, dtype=float)\n    return np.where(x == 0, 1.0, np.sin(x) / x)\n\ndef compute_error(kernel_str, N, ds, m):\n    \"\"\"\n    Solves a single test case for the FBP filter validation.\n\n    Args:\n        kernel_str (str): The name of the kernel ('Ram-Lak', 'Cosine', 'Shepp-Logan').\n        N (int): The number of samples in the projection.\n        ds (float): The sampling interval.\n        m (int): The integer bin index for the test sinusoid frequency.\n\n    Returns:\n        float: The absolute relative error epsilon.\n    \"\"\"\n    # 1. Generate discrete frequency grid\n    freqs = np.fft.fftfreq(N, d=ds)\n    omega = 2 * np.pi * freqs\n    omega_c = np.pi / ds\n\n    # 2. Construct the frequency-domain filter H(omega_k)\n    abs_omega = np.abs(omega)\n    \n    if kernel_str == 'Ram-Lak':\n        # W(omega) = 1 for |omega| = omega_c. All frequencies in fftfreq satisfy this.\n        W = np.ones_like(omega)\n    elif kernel_str == 'Cosine':\n        # W(omega) = cos(pi*omega / (2*omega_c))\n        W = np.cos(np.pi * omega / (2 * omega_c))\n    elif kernel_str == 'Shepp-Logan':\n        # W(omega) = sinc(omega / (2*omega_c))\n        sinc_arg = omega / (2 * omega_c)\n        W = unnormalized_sinc(sinc_arg)\n    else:\n        raise ValueError(f\"Unknown kernel: {kernel_str}\")\n        \n    H = abs_omega * W\n\n    # 3. Generate the test projection p_n\n    f0 = m / (N * ds)\n    n = np.arange(N)\n    p_n = np.cos(2 * np.pi * f0 * n * ds)\n\n    # 4. Filter in the frequency domain\n    # The filtered signal is p_filt = ifft(fft(p) * H).\n    # To measure its amplitude, we take its DFT: fft(p_filt).\n    # Since fft(ifft(X)) = X, this is equivalent to analyzing fft(p) * H directly.\n    P_k = np.fft.fft(p_n)\n    P_k_filtered = P_k * H\n    \n    dft_val_m = P_k_filtered[m]\n\n    # 5. Measure the output amplitude A_out from the DFT of the filtered signal\n    if m == 0:\n        A_out = np.abs(dft_val_m) / N\n    elif N % 2 == 0 and m == N / 2:\n        A_out = np.abs(dft_val_m) / N\n    else:\n        A_out = 2 * np.abs(dft_val_m) / N\n        \n    # 6. Calculate the theoretical amplitude A_theory\n    omega_m = 2 * np.pi * m / (N * ds)\n    abs_omega_m = np.abs(omega_m)\n    A_theory = 0.0 # Default value\n    \n    # The filter is defined to have support up to omega_c.\n    # The test bin m always corresponds to a frequency |omega_m| = omega_c.\n    if kernel_str == 'Ram-Lak':\n        A_theory = abs_omega_m\n    elif kernel_str == 'Cosine':\n        A_theory = abs_omega_m * np.cos(np.pi * omega_m / (2 * omega_c))\n    elif kernel_str == 'Shepp-Logan':\n        sinc_arg_m = omega_m / (2 * omega_c)\n        A_theory = abs_omega_m * unnormalized_sinc(sinc_arg_m)\n    \n    # 7. Compute the absolute relative error epsilon\n    if np.abs(A_theory) > 1e-15: # Use a tolerance for floating point zero\n        epsilon = np.abs(A_out - A_theory) / np.abs(A_theory)\n    else:\n        epsilon = np.abs(A_out)\n        \n    return epsilon\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (kernel, N, ds, m)\n        ('Ram-Lak', 256, 1.0, 8),\n        ('Shepp-Logan', 512, 1.0, 17),\n        ('Cosine', 128, 1.0, 64),\n        ('Ram-Lak', 300, 0.8, 0),\n        ('Shepp-Logan', 1024, 0.5, 120),\n    ]\n\n    results = []\n    for case in test_cases:\n        kernel_str, N, ds, m = case\n        error = compute_error(kernel_str, N, ds, m)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "先进的CT系统（如螺旋CT）通常会产生冗余数据，这为优化提供了机会。本实践探讨了一种通过组合这些冗余测量来最小化噪声以提高图像质量的关键信号处理技术。您将推导并应用反方差加权原理，展示一种增强CT重建的实用方法。",
            "id": "4884808",
            "problem": "一个二维平行束计算机断层扫描 (CT) 系统使用滤波反投影 (FBP) 算法重建图像。在 FBP 流程中，每个投影都使用一个一维滤波器沿探测器坐标进行滤波，该滤波器的频率响应是一个斜坡函数和一个切趾窗的乘积。假设以下设置，使用标准的一维傅里叶变换对：函数 $h(t)$ 的傅里叶变换为 $H(\\omega) = \\int_{-\\infty}^{\\infty} h(t)\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t$，其逆变换为 $h(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega$。该滤波器的频率响应由下式给出\n$$\nH(\\omega) = |\\omega|\\,W(\\omega),\n$$\n其中 $W(\\omega)$ 是一个升余弦 (Hann) 切趾窗，定义为\n$$\nW(\\omega) =\n\\begin{cases}\n\\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right),  |\\omega| \\le \\omega_c, \\\\\n0,  |\\omega| > \\omega_c,\n\\end{cases}\n$$\n其中截止角频率 $\\omega_c > 0$。仅使用这些定义和傅里叶切片定理框架（即，频域中的滤波对应于投影域中与脉冲响应的卷积），推导空间域脉冲响应 $h(t)$ 在 $t=0$ 处的精确值，并纯粹用 $\\omega_c$ 表示。你的最终答案必须是单一的闭式解析表达式。不需要数值近似或四舍五入，最终答案中也无需报告物理单位。",
            "solution": "用户提供了一个问题陈述，要求推导脉冲响应函数在时间 $t = 0$ 处的值。该问题设置在计算机断层扫描的滤波反投影背景下。\n\n### **第1步：问题验证**\n\n首先，我将验证问题陈述。\n\n#### **第1.1步：提取已知条件**\n-   **方法**：二维平行束 CT 系统的滤波反投影 (FBP)。\n-   **傅里叶变换对**：\n    -   正变换：$H(\\omega) = \\int_{-\\infty}^{\\infty} h(t)\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t$\n    -   逆变换：$h(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega$\n-   **滤波器频率响应**：$H(\\omega) = |\\omega|\\,W(\\omega)$。\n-   **切趾窗 (Hann窗)**：\n    $$\n    W(\\omega) =\n    \\begin{cases}\n    \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right),  |\\omega| \\le \\omega_c \\\\\n    0,  |\\omega| > \\omega_c\n    \\end{cases}\n    $$\n-   **参数**：截止角频率 $\\omega_c > 0$。\n-   **目标**：求空间域脉冲响应 $h(t)$ 在 $t=0$ 处的值，即 $h(0)$，并用 $\\omega_c$ 表示。\n\n#### **第1.2步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在信号处理和医学成像原理，特别是在断层重建理论方面有充分的依据。FBP 算法、斜坡滤波器 ($|\\omega|$) 的使用及其通过 Hann 窗进行的切趾都是标准、正确且广泛使用的概念。\n-   **适定性**：该问题是适定的。它要求一个特定的值 $h(0)$，这个值可以通过对一个明确定义的函数 $H(\\omega)$ 进行定积分来确定。所有必需的函数和常数都已明确定义。存在一个唯一的、有意义的解。\n-   **客观性**：语言精确、数学化，没有任何主观性或模糊性。\n\n该问题没有问题验证清单中列出的任何缺陷。它在科学上是合理的，完全指定的，并且需要严格的数学推导。\n\n#### **第1.3步：结论与行动**\n问题有效。我将继续进行求解。\n\n### **第2步：求解推导**\n\n目标是求脉冲响应 $h(t)$ 在 $t=0$ 处的值。脉冲响应 $h(t)$ 是频率响应 $H(\\omega)$ 的傅里叶逆变换。使用所提供的傅里叶逆变换定义：\n$$\nh(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega\n$$\n为了求在 $t=0$ 处的值，我们在上面的表达式中令 $t=0$：\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega \\cdot 0)\\,\\mathrm{d}\\omega = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\mathrm{d}\\omega\n$$\n现在，代入给定的滤波器频率响应表达式 $H(\\omega) = |\\omega|\\,W(\\omega)$：\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |\\omega|\\,W(\\omega)\\,\\mathrm{d}\\omega\n$$\n根据定义，切趾窗 $W(\\omega)$ 在 $|\\omega| > \\omega_c$ 时为零。这将积分的上下限限制在区间 $[-\\omega_c, \\omega_c]$ 内。在此区间内，我们使用 $W(\\omega)$ 定义的非零部分：\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\omega_c}^{\\omega_c} |\\omega| \\left( \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\n被积函数是关于 $\\omega$ 的偶函数。项 $|\\omega|$ 是偶函数，$\\cos(\\frac{\\pi\\,\\omega}{\\omega_c})$ 也是偶函数。偶函数的乘积是偶函数。偶函数在对称区间 $[ -a, a ]$ 上的积分等于其在 $[ 0, a ]$ 上积分的两倍。\n$$\nh(0) = \\frac{1}{2\\pi} \\cdot 2 \\int_{0}^{\\omega_c} \\omega \\left( \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\n注意，对于 $\\omega \\ge 0$，我们有 $|\\omega| = \\omega$。简化表达式：\n$$\nh(0) = \\frac{1}{\\pi} \\int_{0}^{\\omega_c} \\left( \\frac{\\omega}{2} + \\frac{\\omega}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\n我们可以将其分解为两个独立的积分：\n$$\nh(0) = \\frac{1}{2\\pi} \\int_{0}^{\\omega_c} \\omega\\,\\mathrm{d}\\omega + \\frac{1}{2\\pi} \\int_{0}^{\\omega_c} \\omega\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega\n$$\n首先，我们计算第一个积分：\n$$\n\\int_{0}^{\\omega_c} \\omega\\,\\mathrm{d}\\omega = \\left[ \\frac{\\omega^2}{2} \\right]_{0}^{\\omega_c} = \\frac{\\omega_c^2}{2} - 0 = \\frac{\\omega_c^2}{2}\n$$\n因此，$h(0)$ 的第一项是 $\\frac{1}{2\\pi} \\left( \\frac{\\omega_c^2}{2} \\right) = \\frac{\\omega_c^2}{4\\pi}$。\n\n接下来，我们使用分部积分法 $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$ 计算第二个积分。\n令 $u = \\omega$ 且 $\\mathrm{d}v = \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega$。\n则 $\\mathrm{d}u = \\mathrm{d}\\omega$ 且 $v = \\int \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)$。\n$$\n\\int_{0}^{\\omega_c} \\omega\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = \\left[ \\omega \\cdot \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} - \\int_{0}^{\\omega_c} \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega\n$$\n计算第一部分（$uv$ 项）：\n$$\n\\left[ \\frac{\\omega_c \\omega}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} = \\frac{\\omega_c (\\omega_c)}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega_c}{\\omega_c}\\right) - 0 = \\frac{\\omega_c^2}{\\pi}\\sin(\\pi) = 0\n$$\n现在，计算剩余的积分部分：\n$$\n- \\int_{0}^{\\omega_c} \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = - \\frac{\\omega_c}{\\pi} \\left[ -\\frac{\\omega_c}{\\pi}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c}\n$$\n$$\n= \\frac{\\omega_c^2}{\\pi^2} \\left[ \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} = \\frac{\\omega_c^2}{\\pi^2} \\left( \\cos\\!\\left(\\frac{\\pi\\,\\omega_c}{\\omega_c}\\right) - \\cos(0) \\right)\n$$\n$$\n= \\frac{\\omega_c^2}{\\pi^2} (\\cos(\\pi) - 1) = \\frac{\\omega_c^2}{\\pi^2}(-1 - 1) = -\\frac{2\\omega_c^2}{\\pi^2}\n$$\n因此，$h(0)$ 的第二项是 $\\frac{1}{2\\pi} \\left( -\\frac{2\\omega_c^2}{\\pi^2} \\right) = -\\frac{\\omega_c^2}{\\pi^3}$。\n\n最后，我们将这两项合并求得 $h(0)$：\n$$\nh(0) = \\frac{\\omega_c^2}{4\\pi} - \\frac{\\omega_c^2}{\\pi^3}\n$$\n为了将其写成单个分数，我们找到公分母 $4\\pi^3$：\n$$\nh(0) = \\frac{\\omega_c^2 \\pi^2}{4\\pi^3} - \\frac{4\\omega_c^2}{4\\pi^3} = \\frac{\\omega_c^2\\pi^2 - 4\\omega_c^2}{4\\pi^3}\n$$\n从分子中提出公因子 $\\omega_c^2$ 得到最终的闭式表达式：\n$$\nh(0) = \\frac{\\omega_c^2 (\\pi^2 - 4)}{4\\pi^3}\n$$\n此表达式纯粹用截止角频率 $\\omega_c$ 表示，符合要求。",
            "answer": "$$\n\\boxed{\\frac{\\omega_c^{2}(\\pi^{2} - 4)}{4\\pi^{3}}}\n$$"
        },
        {
            "introduction": "先进的CT系统（如螺旋CT）通常会产生冗余数据，这为优化提供了机会。本实践探讨了一种通过组合这些冗余测量来最小化噪声以提高图像质量的关键信号处理技术。您将推导并应用反方差加权原理，展示一种增强CT重建的实用方法。",
            "id": "4884821",
            "problem": "考虑一个三维物体，其衰减系数为 $f(x,y,z)$，在固定轴向平面 $z=z^{\\star}$ 上的二维拉东变换由 $p(\\theta,s;z^{\\star})=\\int\\!\\!\\int f(x,y,z^{\\star})\\,\\delta(x\\cos\\theta+y\\sin\\theta-s)\\,\\mathrm{d}x\\,\\mathrm{d}y$ 给出。在平行束计算机断层扫描（CT）中，滤波反投影（FBP）通过对按角度索引、经频域滤波的投影 $g(\\theta,s;z^{\\star})$ 在 $\\theta$ 上进行积分来重建 $f(x,y,z^{\\star})$。在螺距小于1的螺旋CT中，连续的旋转会产生轴向重叠，因此对于对应于位置 $s=s^{\\star}$ 和体素平面 $z=z^{\\star}$ 的固定射线，两个不同的视角 $\\beta_{1}$ 和 $\\beta_{2}$ 会测量到冗余样本。这些样本在频域应用线性重建核 $K(\\omega)$ 后，会为同一底层线积分产生滤波后的值 $g_{1}$ 和 $g_{2}$。假设 $g_{1}$ 和 $g_{2}$ 中的滤波噪声贡献是相互独立、零均值的，其方差分别为 $\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$。一种冗余加权FBP方法将这两个滤波值合并成一个单一的贡献值 $g^{\\star}$，然后进行反投影。该方法使用权重 $w_{1}$ 和 $w_{2}$，使得 $g^{\\star}=w_{1}g_{1}+w_{2}g_{2}$。\n\n从以下要求出发：合并后的贡献值相对于真实的滤波线积分是无偏的，并且在独立性假设下方差最小化。请推导 $w_{1}$ 和 $w_{2}$ 关于 $\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$ 的解析表达式。然后，在特定情况下，$g_{1}=\\frac{23}{10}$，$g_{2}=\\frac{17}{10}$，$\\sigma_{1}^{2}=\\frac{1}{25}$，以及 $\\sigma_{2}^{2}=\\frac{9}{100}$，计算 $g^{\\star}$ 的精确值。请将您的最终答案表示为一个无四舍五入、无单位的最简分数。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**第1步：提取已知条件**\n- 衰减系数: $f(x,y,z)$\n- 固定平面 $z=z^{\\star}$ 上的二维拉东变换（正弦图）: $p(\\theta,s;z^{\\star})=\\int\\!\\!\\int f(x,y,z^{\\star})\\,\\delta(x\\cos\\theta+y\\sin\\theta-s)\\,\\mathrm{d}x\\,\\mathrm{d}y$\n- 对于固定射线，冗余测量来自两个不同的视角 $\\beta_1$ 和 $\\beta_2$。\n- 这些冗余测量的滤波值为 $g_1$ 和 $g_2$。\n- $g_1$ 和 $g_2$ 中的噪声贡献是独立且零均值的，方差分别为 $\\sigma_1^2$ 和 $\\sigma_2^2$。\n- 组合贡献 $g^{\\star}$ 由加权和形成: $g^{\\star} = w_1 g_1 + w_2 g_2$。\n- 约束1：组合贡献 $g^{\\star}$ 必须是真实滤波线积分的无偏估计量。\n- 约束2：$g^{\\star}$ 的方差必须最小化。\n- 用于计算的具体值：$g_1 = \\frac{23}{10}$，$g_2 = \\frac{17}{10}$，$\\sigma_1^2 = \\frac{1}{25}$，以及 $\\sigma_2^2 = \\frac{9}{100}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。它描述了一种标准的信号处理技术（寻找最佳线性无偏估计量，或BLUE），并将其应用于医学成像中的一个现实场景（螺旋CT中的数据冗余）。其表述基于估计理论和计算机断层扫描物理学的既定原则。问题是自洽的，没有缺失或矛盾的信息。所有术语都是标准的且定义精确。因此，该问题是有效的。\n\n**第3步：结论与行动**\n该问题被判定为有效。将提供完整的解答。\n\n**最优权重的推导**\n设 $\\mu$ 代表 $g_1$ 和 $g_2$ 所测量的滤波线积分的真实无噪声值。测量值可以建模为包含一个加性噪声项：\n$$g_1 = \\mu + \\epsilon_1$$\n$$g_2 = \\mu + \\epsilon_2$$\n其中 $\\epsilon_1$ 和 $\\epsilon_2$ 是随机噪声贡献。根据题目陈述，我们有以下关于噪声的性质：\n- 零均值：$E[\\epsilon_1] = 0$ 且 $E[\\epsilon_2] = 0$。\n- 方差：$\\text{Var}(\\epsilon_1) = E[\\epsilon_1^2] - (E[\\epsilon_1])^2 = E[\\epsilon_1^2] = \\sigma_1^2$ 且 $\\text{Var}(\\epsilon_2) = E[\\epsilon_2^2] = \\sigma_2^2$。\n- 独立性：噪声贡献是独立的，这意味着协方差为零：$\\text{Cov}(\\epsilon_1, \\epsilon_2) = E[\\epsilon_1\\epsilon_2] - E[\\epsilon_1]E[\\epsilon_2] = E[\\epsilon_1\\epsilon_2] = 0$。\n\n组合估计是测量值的线性组合：\n$$g^{\\star} = w_1 g_1 + w_2 g_2$$\n我们现在应用这两个约束来确定权重 $w_1$ 和 $w_2$。\n\n**约束1：无偏估计量**\n估计量 $g^{\\star}$ 必须是无偏的，这意味着其期望值必须等于真值 $\\mu$。\n$$E[g^{\\star}] = \\mu$$\n我们计算估计量的期望值：\n$$E[g^{\\star}] = E[w_1 g_1 + w_2 g_2] = w_1 E[g_1] + w_2 E[g_2]$$\n单个测量值的期望值是：\n$$E[g_1] = E[\\mu + \\epsilon_1] = E[\\mu] + E[\\epsilon_1] = \\mu + 0 = \\mu$$\n$$E[g_2] = E[\\mu + \\epsilon_2] = E[\\mu] + E[\\epsilon_2] = \\mu + 0 = \\mu$$\n将这些代回到 $E[g^{\\star}]$ 的表达式中：\n$$E[g^{\\star}] = w_1 \\mu + w_2 \\mu = (w_1 + w_2) \\mu$$\n为了使估计量是无偏的（即 $E[g^{\\star}] = \\mu$），必须满足：\n$$w_1 + w_2 = 1$$\n这是联系两个权重的第一个方程。我们可以用一个表示另一个，例如 $w_2 = 1 - w_1$。\n\n**约束2：最小方差**\n接下来，我们寻求最小化 $g^{\\star}$ 的方差，即 $\\text{Var}(g^{\\star})$。方差定义为 $\\text{Var}(g^{\\star}) = E[(g^{\\star} - E[g^{\\star}])^2]$。由于估计量是无偏的，所以 $E[g^{\\star}] = \\mu$。\n$$g^{\\star} - \\mu = (w_1 g_1 + w_2 g_2) - \\mu$$\n使用恒等式 $\\mu = (w_1 + w_2)\\mu = w_1\\mu + w_2\\mu$：\n$$g^{\\star} - \\mu = (w_1 g_1 + w_2 g_2) - (w_1\\mu + w_2\\mu) = w_1(g_1 - \\mu) + w_2(g_2 - \\mu)$$\n认识到 $g_1 - \\mu = \\epsilon_1$ 和 $g_2 - \\mu = \\epsilon_2$：\n$$g^{\\star} - \\mu = w_1 \\epsilon_1 + w_2 \\epsilon_2$$\n现在我们计算方差：\n$$\\text{Var}(g^{\\star}) = E[(w_1 \\epsilon_1 + w_2 \\epsilon_2)^2] = E[w_1^2 \\epsilon_1^2 + w_2^2 \\epsilon_2^2 + 2 w_1 w_2 \\epsilon_1 \\epsilon_2]$$\n根据期望的线性性质：\n$$\\text{Var}(g^{\\star}) = w_1^2 E[\\epsilon_1^2] + w_2^2 E[\\epsilon_2^2] + 2 w_1 w_2 E[\\epsilon_1 \\epsilon_2]$$\n使用给定的噪声性质（$E[\\epsilon_1^2] = \\sigma_1^2$，$E[\\epsilon_2^2] = \\sigma_2^2$，以及 $E[\\epsilon_1 \\epsilon_2] = 0$）：\n$$\\text{Var}(g^{\\star}) = w_1^2 \\sigma_1^2 + w_2^2 \\sigma_2^2$$\n我们必须在约束条件 $w_1 + w_2 = 1$ 下最小化这个方差表达式。将 $w_2 = 1 - w_1$ 代入方差公式，得到一个仅关于 $w_1$ 的函数：\n$$V(w_1) = w_1^2 \\sigma_1^2 + (1 - w_1)^2 \\sigma_2^2$$\n为了找到最小值，我们计算关于 $w_1$ 的导数并将其设为0：\n$$\\frac{\\mathrm{d}V}{\\mathrm{d}w_1} = 2w_1 \\sigma_1^2 + 2(1-w_1)(-1)\\sigma_2^2 = 2w_1 \\sigma_1^2 - 2(1-w_1)\\sigma_2^2$$\n将导数设为零：\n$$2w_1 \\sigma_1^2 - 2\\sigma_2^2 + 2w_1 \\sigma_2^2 = 0$$\n$$w_1 (\\sigma_1^2 + \\sigma_2^2) = \\sigma_2^2$$\n解出 $w_1$：\n$$w_1 = \\frac{\\sigma_2^2}{\\sigma_1^2 + \\sigma_2^2}$$\n现在，我们使用约束 $w_2 = 1 - w_1$ 来找到 $w_2$：\n$$w_2 = 1 - \\frac{\\sigma_2^2}{\\sigma_1^2 + \\sigma_2^2} = \\frac{(\\sigma_1^2 + \\sigma_2^2) - \\sigma_2^2}{\\sigma_1^2 + \\sigma_2^2} = \\frac{\\sigma_1^2}{\\sigma_1^2 + \\sigma_2^2}$$\n这些就是最优权重的解析表达式。这个结果被称为反方差加权，即每个测量值的权重与其方差的倒数成正比。\n\n**特定情况的计算**\n我们有以下给定值：\n$$g_1 = \\frac{23}{10}, \\quad g_2 = \\frac{17}{10}, \\quad \\sigma_1^2 = \\frac{1}{25}, \\quad \\sigma_2^2 = \\frac{9}{100}$$\n首先，计算方差之和：\n$$\\sigma_1^2 + \\sigma_2^2 = \\frac{1}{25} + \\frac{9}{100} = \\frac{4}{100} + \\frac{9}{100} = \\frac{13}{100}$$\n现在，计算权重 $w_1$ 和 $w_2$：\n$$w_1 = \\frac{\\sigma_2^2}{\\sigma_1^2 + \\sigma_2^2} = \\frac{9/100}{13/100} = \\frac{9}{13}$$\n$$w_2 = \\frac{\\sigma_1^2}{\\sigma_1^2 + \\sigma_2^2} = \\frac{1/25}{13/100} = \\frac{4/100}{13/100} = \\frac{4}{13}$$\n最后，计算组合贡献 $g^{\\star}$：\n$$g^{\\star} = w_1 g_1 + w_2 g_2 = \\left(\\frac{9}{13}\\right) \\left(\\frac{23}{10}\\right) + \\left(\\frac{4}{13}\\right) \\left(\\frac{17}{10}\\right)$$\n$$g^{\\star} = \\frac{9 \\times 23}{13 \\times 10} + \\frac{4 \\times 17}{13 \\times 10} = \\frac{207}{130} + \\frac{68}{130}$$\n$$g^{\\star} = \\frac{207 + 68}{130} = \\frac{275}{130}$$\n这个分数可以通过将分子和分母除以它们的最大公约数 $5$ 来化简：\n$$g^{\\star} = \\frac{275 \\div 5}{130 \\div 5} = \\frac{55}{26}$$\n分子 $55 = 5 \\times 11$ 和分母 $26 = 2 \\times 13$ 没有共同的因子，所以这个分数是其最简形式。",
            "answer": "$$\\boxed{\\frac{55}{26}}$$"
        }
    ]
}