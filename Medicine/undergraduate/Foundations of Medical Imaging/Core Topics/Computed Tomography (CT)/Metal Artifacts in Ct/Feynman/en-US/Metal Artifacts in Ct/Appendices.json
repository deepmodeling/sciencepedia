{
    "hands_on_practices": [
        {
            "introduction": "While introductory theory often assumes a monochromatic X-ray source, real CT systems are polychromatic, meaning they emit a spectrum of X-ray energies. This exercise delves into the physical consequences of this reality, asking you to mathematically derive how energy-dependent attenuation introduces a non-linear bias into the measured projection data . This derivation reveals the origin of \"beam hardening\" artifacts, providing a fundamental explanation for phenomena like the \"cupping\" effect in images of uniform objects and dark streaks between dense implants.",
            "id": "4900512",
            "problem": "A polychromatic X-ray beam with spectral distribution $S(E)$ is used in Computed Tomography (CT). Consider a single projection traversing a two-material object comprised of materials indexed by $k \\in \\{1,2\\}$, with path lengths $L_1$ and $L_2$ and energy-dependent linear attenuation coefficients $\\mu_1(E)$ and $\\mu_2(E)$. Assume an energy-integrating detector, no scatter, and no noise. The incident intensity is $I_0 = \\int S(E)\\, dE$, and the transmitted intensity is\n$$\nI = \\int S(E)\\,\\exp\\!\\big(-\\mu_1(E)\\,L_1 - \\mu_2(E)\\,L_2\\big)\\, dE.\n$$\nStarting from the Beer–Lambert law and well-tested Taylor-series expansions of elementary functions, expand $I$ consistently to second order in the path lengths $L_1$ and $L_2$, and then derive $-\\ln\\!\\big(I/I_0\\big)$ to second order in $L_1$ and $L_2$. Introduce the normalized spectral weight $w(E) = S(E)/I_0$ and the notation for spectral averages $\\langle f \\rangle = \\int w(E)\\, f(E)\\, dE$. Express your final result entirely in terms of $L_1$, $L_2$, $\\langle \\mu_1 \\rangle$, $\\langle \\mu_2 \\rangle$, $\\langle \\mu_1^2 \\rangle$, $\\langle \\mu_2^2 \\rangle$, and $\\langle \\mu_1 \\mu_2 \\rangle$. Provide a single closed-form analytic expression for $-\\ln\\!\\big(I/I_0\\big)$ up to and including all terms of order $2$ in $L_1$ and $L_2$. No numerical evaluation is required.",
            "solution": "The objective is to find a second-order Taylor series expansion for the quantity $-\\ln(I/I_0)$ in terms of the path lengths $L_1$ and $L_2$. The transmitted intensity $I$ is given by the integral over the energy spectrum $S(E)$:\n$$\nI = \\int S(E)\\,\\exp\\!\\big(-\\mu_1(E)\\,L_1 - \\mu_2(E)\\,L_2\\big)\\, dE\n$$\nWe start by expanding the exponential function inside the integral. The Taylor series for $\\exp(x)$ around $x=0$ is $\\exp(x) = 1 + x + \\frac{x^2}{2!} + O(x^3)$. Let $x = -(\\mu_1(E) L_1 + \\mu_2(E) L_2)$. We expand up to second order in the path lengths $L_1$ and $L_2$.\n$$\n\\exp(-(\\mu_1 L_1 + \\mu_2 L_2)) \\approx 1 - (\\mu_1 L_1 + \\mu_2 L_2) + \\frac{1}{2}(\\mu_1 L_1 + \\mu_2 L_2)^2\n$$\nExpanding the quadratic term gives:\n$$\n\\exp(-(\\mu_1 L_1 + \\mu_2 L_2)) \\approx 1 - \\mu_1 L_1 - \\mu_2 L_2 + \\frac{1}{2}(\\mu_1^2 L_1^2 + 2\\mu_1 \\mu_2 L_1 L_2 + \\mu_2^2 L_2^2)\n$$\nwhere the dependence on energy $E$ for $\\mu_1$ and $\\mu_2$ is implicit. Substituting this expansion into the integral for $I$:\n$$\nI \\approx \\int S(E) \\left[ 1 - \\mu_1(E) L_1 - \\mu_2(E) L_2 + \\frac{1}{2}\\mu_1(E)^2 L_1^2 + \\mu_1(E)\\mu_2(E) L_1 L_2 + \\frac{1}{2}\\mu_2(E)^2 L_2^2 \\right] dE\n$$\nBy the linearity of integration, we can integrate term by term:\n$$\nI \\approx \\int S(E)dE - L_1 \\int S(E)\\mu_1(E)dE - L_2 \\int S(E)\\mu_2(E)dE + \\frac{1}{2}L_1^2 \\int S(E)\\mu_1(E)^2 dE + L_1 L_2 \\int S(E)\\mu_1(E)\\mu_2(E)dE + \\frac{1}{2}L_2^2 \\int S(E)\\mu_2(E)^2 dE\n$$\nNow, we introduce the given definitions: the incident intensity $I_0 = \\int S(E) dE$, the normalized spectral weight $w(E) = S(E)/I_0$, and the spectral average $\\langle f \\rangle = \\int w(E) f(E) dE$. An arbitrary spectral integral can be expressed using this notation as $\\int S(E) f(E) dE = I_0 \\int w(E) f(E) dE = I_0 \\langle f \\rangle$. Applying this to our expression for $I$:\n$$\nI \\approx I_0 - L_1 I_0 \\langle \\mu_1 \\rangle - L_2 I_0 \\langle \\mu_2 \\rangle + \\frac{1}{2}L_1^2 I_0 \\langle \\mu_1^2 \\rangle + L_1 L_2 I_0 \\langle \\mu_1 \\mu_2 \\rangle + \\frac{1}{2}L_2^2 I_0 \\langle \\mu_2^2 \\rangle\n$$\nDividing by $I_0$ gives the normalized transmitted intensity:\n$$\n\\frac{I}{I_0} \\approx 1 - (L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle) + \\left( \\frac{1}{2}L_1^2 \\langle \\mu_1^2 \\rangle + L_1 L_2 \\langle \\mu_1 \\mu_2 \\rangle + \\frac{1}{2}L_2^2 \\langle \\mu_2^2 \\rangle \\right)\n$$\nThe next step is to compute $-\\ln(I/I_0)$. We use the Taylor series expansion for $\\ln(1-z)$ around $z=0$, which is $\\ln(1-z) = -z - \\frac{z^2}{2} - O(z^3)$.\nLet's define two terms for clarity:\n$$\nA = L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle\n$$\n$$\nB = \\frac{1}{2}L_1^2 \\langle \\mu_1^2 \\rangle + L_1 L_2 \\langle \\mu_1 \\mu_2 \\rangle + \\frac{1}{2}L_2^2 \\langle \\mu_2^2 \\rangle\n$$\nThe term $A$ contains all first-order terms in $L_1$ and $L_2$, while $B$ contains all second-order terms. Our expression for the normalized intensity is $\\frac{I}{I_0} \\approx 1 - A + B$. We set $z = A - B$.\n$$\n\\ln\\left(\\frac{I}{I_0}\\right) \\approx \\ln(1-(A-B)) \\approx -(A-B) - \\frac{1}{2}(A-B)^2\n$$\nWe need to expand this expression and keep all terms up to the second order in $L_1$ and $L_2$.\nThe term $-(A-B) = -A+B$.\nThe term $-\\frac{1}{2}(A-B)^2 = -\\frac{1}{2}(A^2 - 2AB + B^2)$.\nThe term $A$ is of first order, so $A^2$ is of second order.\nThe term $B$ is of second order.\nTerms like $AB$ (third order) and $B^2$ (fourth order) are higher than second order and must be discarded.\nThus, to second order, we have:\n$$\n\\ln\\left(\\frac{I}{I_0}\\right) \\approx -A + B - \\frac{1}{2}A^2\n$$\nNow we substitute back the expressions for $A$ and $B$:\n$$\nA^2 = (L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle)^2 = L_1^2 \\langle \\mu_1 \\rangle^2 + 2L_1 L_2 \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle + L_2^2 \\langle \\mu_2 \\rangle^2\n$$\nSo,\n$$\n\\ln\\left(\\frac{I}{I_0}\\right) \\approx -(L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle) + \\left(\\frac{1}{2}L_1^2 \\langle \\mu_1^2 \\rangle + L_1 L_2 \\langle \\mu_1 \\mu_2 \\rangle + \\frac{1}{2}L_2^2 \\langle \\mu_2^2 \\rangle \\right) - \\frac{1}{2}\\left(L_1^2 \\langle \\mu_1 \\rangle^2 + 2L_1 L_2 \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle + L_2^2 \\langle \\mu_2 \\rangle^2 \\right)\n$$\nWe want the final expression for $-\\ln(I/I_0)$, so we multiply by $-1$:\n$$\n-\\ln\\left(\\frac{I}{I_0}\\right) \\approx (L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle) - \\left(\\frac{1}{2}L_1^2 \\langle \\mu_1^2 \\rangle + L_1 L_2 \\langle \\mu_1 \\mu_2 \\rangle + \\frac{1}{2}L_2^2 \\langle \\mu_2^2 \\rangle \\right) + \\frac{1}{2}\\left(L_1^2 \\langle \\mu_1 \\rangle^2 + 2L_1 L_2 \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle + L_2^2 \\langle \\mu_2 \\rangle^2 \\right)\n$$\nFinally, we group the terms by the powers of $L_1$ and $L_2$:\nThe first-order term is the ideal projection: $L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle$.\nThe second-order correction terms are:\nFor $L_1^2$: $\\frac{1}{2}L_1^2 \\langle \\mu_1 \\rangle^2 - \\frac{1}{2}L_1^2 \\langle \\mu_1^2 \\rangle = -\\frac{1}{2}L_1^2 (\\langle \\mu_1^2 \\rangle - \\langle \\mu_1 \\rangle^2)$.\nFor $L_2^2$: $\\frac{1}{2}L_2^2 \\langle \\mu_2 \\rangle^2 - \\frac{1}{2}L_2^2 \\langle \\mu_2^2 \\rangle = -\\frac{1}{2}L_2^2 (\\langle \\mu_2^2 \\rangle - \\langle \\mu_2 \\rangle^2)$.\nFor $L_1 L_2$: $L_1 L_2 \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle - L_1 L_2 \\langle \\mu_1 \\mu_2 \\rangle = -L_1 L_2 (\\langle \\mu_1 \\mu_2 \\rangle - \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle)$.\n\nCombining these gives the final expression. The term $(\\langle f^2 \\rangle - \\langle f \\rangle^2)$ is the variance of $f$ over the spectrum, $\\sigma_f^2$. The term $(\\langle f g \\rangle - \\langle f \\rangle \\langle g \\rangle)$ is the covariance, $\\sigma_{fg}$. The result shows that the measured projection is the spectrally-averaged line integral minus a correction term proportional to the variance of the total attenuation $L_1 \\mu_1 + L_2 \\mu_2$. This quadratic correction is the mathematical origin of the \"cupping\" artifact in CT images of uniform objects, a manifestation of beam hardening.\n\nThe complete expression, structured as requested, is:\n$$\n-\\ln\\left(\\frac{I}{I_0}\\right) \\approx L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle - \\frac{1}{2} L_1^2 (\\langle \\mu_1^2 \\rangle - \\langle \\mu_1 \\rangle^2) - L_1 L_2 (\\langle \\mu_1 \\mu_2 \\rangle - \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle) - \\frac{1}{2} L_2^2 (\\langle \\mu_2^2 \\rangle - \\langle \\mu_2 \\rangle^2)\n$$\nThis can be written more compactly as:\n$$\n-\\ln\\left(\\frac{I}{I_0}\\right) \\approx (L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle) - \\frac{1}{2}\\left[ L_1^2(\\langle \\mu_1^2 \\rangle - \\langle \\mu_1 \\rangle^2) + 2L_1L_2(\\langle \\mu_1\\mu_2 \\rangle - \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle) + L_2^2(\\langle \\mu_2^2 \\rangle - \\langle \\mu_2 \\rangle^2) \\right]\n$$\nThis final form is a single, closed-form analytic expression containing only the allowed terms.",
            "answer": "$$\\boxed{L_1 \\langle \\mu_1 \\rangle + L_2 \\langle \\mu_2 \\rangle - \\frac{1}{2}\\left[ L_1^2(\\langle \\mu_1^2 \\rangle - \\langle \\mu_1 \\rangle^2) + 2L_1L_2(\\langle \\mu_1\\mu_2 \\rangle - \\langle \\mu_1 \\rangle \\langle \\mu_2 \\rangle) + L_2^2(\\langle \\mu_2^2 \\rangle - \\langle \\mu_2 \\rangle^2) \\right]}$$"
        },
        {
            "introduction": "Beyond the systematic errors from beam hardening, metal artifacts are also driven by random quantum noise. Because metals are so highly attenuating, very few photons may reach the detector, a phenomenon called \"photon starvation.\" This practice uses the principles of Poisson statistics to quantify the resulting uncertainty in the measurements . Deriving the expression for the variance of the log-transformed data, $\\mathrm{Var}[-\\ln(I/I_{0})]$, reveals a foundational principle of CT imaging: lower signal leads to higher noise, explaining the severe streaking and grainy appearance of regions affected by metal.",
            "id": "4900547",
            "problem": "Consider a single-ray transmission measurement in Computed Tomography (CT). Let the detected photon count along the ray be modeled as a Poisson-distributed random variable $I$ with expected value $\\lambda$, reflecting monoenergetic photons and an ideal detector under conditions where scatter and electronic noise are negligible compared to quantum noise. The incident count without the object is a known, deterministic reference $I_{0}$. In CT reconstruction, the line-integral data used for image formation are obtained by the logarithmic mapping $p=-\\ln(I/I_{0})$. In the presence of highly attenuating objects such as metal, the expected count $\\lambda$ can become small, but assume here that the exposure is configured so that $\\lambda$ is sufficiently large to justify a leading-order approximation based on smooth transformations of random variables.\n\nStarting from the defining properties of the Poisson process and basic variance propagation principles, derive an analytic leading-order expression for the variance $\\mathrm{Var}\\!\\left[-\\ln\\!\\left(\\frac{I}{I_{0}}\\right)\\right]$ in terms of $\\lambda$ only. Treat $I_{0}$ as a deterministic constant. Express your final answer as a closed-form analytic expression. No rounding is required, and the variance is dimensionless.",
            "solution": "The objective is to derive a leading-order expression for the variance of the line-integral data, $\\mathrm{Var}\\!\\left[-\\ln\\!\\left(\\frac{I}{I_{0}}\\right)\\right]$, where $I$ is a Poisson-distributed random variable with expected value $\\lambda$, and $I_{0}$ is a deterministic constant.\n\nLet the line-integral projection measurement be denoted by $p$. The definition given is:\n$$p = -\\ln\\left(\\frac{I}{I_{0}}\\right)$$\nThe quantity we need to compute is $\\mathrm{Var}[p]$. Using the properties of the logarithm, we can rewrite $p$ as:\n$$p = -(\\ln(I) - \\ln(I_{0})) = \\ln(I_{0}) - \\ln(I)$$\nWe are asked to find the variance of $p$, $\\mathrm{Var}[p]$. Using the fundamental properties of variance, for any random variable $X$ and constants $a$ and $b$, we have $\\mathrm{Var}[aX+b] = a^2 \\mathrm{Var}[X]$. In our case, the random variable is $\\ln(I)$, the constant $a$ is $-1$, and the constant $b$ is $\\ln(I_{0})$. Therefore:\n$$\\mathrm{Var}[p] = \\mathrm{Var}[\\ln(I_{0}) - \\ln(I)] = \\mathrm{Var}[-1 \\cdot \\ln(I) + \\ln(I_{0})] = (-1)^2 \\mathrm{Var}[\\ln(I)] = \\mathrm{Var}[\\ln(I)]$$\nThis simplifies the problem to finding the variance of the natural logarithm of the Poisson-distributed random variable $I$.\n\nThe problem specifies that $\\lambda$ is sufficiently large to justify a leading-order approximation. This suggests using the method of variance propagation, also known as the delta method, which is based on a first-order Taylor series expansion. For a function $g(X)$ of a random variable $X$ with mean $E[X] = \\mu$ and variance $\\mathrm{Var}[X] = \\sigma^2$, the variance of $g(X)$ can be approximated as:\n$$\\mathrm{Var}[g(X)] \\approx \\left( \\left. \\frac{dg}{dX} \\right|_{X=\\mu} \\right)^2 \\mathrm{Var}[X]$$\nThis approximation is valid when $g(X)$ is approximately linear over the range of typical fluctuations of $X$ around its mean $\\mu$.\n\nFor the problem at hand, we identify the corresponding components:\n1.  The random variable is $X = I$.\n2.  The function is $g(I) = \\ln(I)$.\n3.  The random variable $I$ follows a Poisson distribution, $I \\sim \\text{Poisson}(\\lambda)$.\n\nThe essential properties of the Poisson distribution are its mean and variance:\n$$E[I] = \\lambda$$\n$$\\mathrm{Var}[I] = \\lambda$$\nThe mean of our random variable is therefore $\\mu = \\lambda$.\n\nNext, we compute the derivative of the function $g(I)$ with respect to $I$:\n$$\\frac{dg}{dI} = \\frac{d}{dI}(\\ln(I)) = \\frac{1}{I}$$\nWe then evaluate this derivative at the mean of the random variable, $I = E[I] = \\lambda$:\n$$\\left. \\frac{dg}{dI} \\right|_{I=\\lambda} = \\frac{1}{\\lambda}$$\n\nNow, we substitute these components into the variance propagation formula:\n$$\\mathrm{Var}[\\ln(I)] \\approx \\left( \\frac{1}{\\lambda} \\right)^2 \\mathrm{Var}[I]$$\nSubstituting the variance of the Poisson distribution, $\\mathrm{Var}[I] = \\lambda$:\n$$\\mathrm{Var}[\\ln(I)] \\approx \\left( \\frac{1}{\\lambda} \\right)^2 (\\lambda) = \\frac{1}{\\lambda^2} \\cdot \\lambda = \\frac{1}{\\lambda}$$\nSince we established that $\\mathrm{Var}[p] = \\mathrm{Var}[\\ln(I)]$, the leading-order expression for the variance of the projection measurement is:\n$$\\mathrm{Var}\\!\\left[-\\ln\\!\\left(\\frac{I}{I_{0}}\\right)\\right] \\approx \\frac{1}{\\lambda}$$\nThis result shows that the variance of the log-transformed data is inversely proportional to the expected photon count $\\lambda$. This is a foundational result in CT imaging, explaining why measurements through highly attenuating regions (which result in low $\\lambda$) are significantly noisier, a phenomenon that leads to artifacts like streaking from metallic implants.",
            "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$"
        },
        {
            "introduction": "Having established the physical origins of data inconsistencies—both systematic bias and random noise—we now investigate how these errors manifest in the final image. The reconstruction algorithm itself plays a critical role in shaping the appearance of artifacts. This practice models a severe data corruption as a single impulse in the sinogram and traces its propagation through the Filtered Backprojection (FBP) algorithm . This analysis will reveal how the properties of the ramp filter cause a localized data error to be transformed into the characteristic long-range streaks that define severe metal artifacts.",
            "id": "4900554",
            "problem": "Consider a two-dimensional parallel-beam X-ray computed tomography (CT) system. Let the object be described by an attenuation function $f(x,y)$, and let its projections (the Radon transform) be denoted by $g(\\theta,s)$, where $\\theta \\in [0,\\pi)$ is the projection angle (measured in radians) and $s \\in \\mathbb{R}$ is the detector coordinate. The standard Filtered Backprojection (FBP) reconstruction uses the following processing chain: for each $\\theta$, filter $g(\\theta,\\cdot)$ by a one-dimensional linear shift-invariant filter with frequency response $H(\\omega)=|\\omega|$, where the one-dimensional Fourier transform pair is defined by\n$$\n\\mathcal{F}\\{h\\}(\\omega) = \\int_{-\\infty}^{\\infty} h(s)\\,\\exp(-i \\omega s)\\,ds,\\qquad\nh(s) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\mathcal{F}\\{h\\}(\\omega)\\,\\exp(i \\omega s)\\,d\\omega.\n$$\nLet $h(s)$ denote the impulse response whose Fourier transform is $\\mathcal{F}\\{h\\}(\\omega)=|\\omega|$. The filtered data are $(h * g(\\theta,\\cdot))(s)$, and the FBP reconstruction is given by\n$$\n\\hat{f}(x,y) = \\int_{0}^{\\pi} (h * g(\\theta,\\cdot))\\big(x\\cos\\theta + y\\sin\\theta\\big)\\,d\\theta.\n$$\nNow consider a highly localized corruption in the sinogram that models a metal-induced outlier along a single ray: \n$$\ng(\\theta,s) = A\\,\\delta(\\theta - \\theta_{0})\\,\\delta(s - s_{0}),\n$$\nwhere $A \\in \\mathbb{R}$ is the amplitude, $\\delta(\\cdot)$ is the Dirac delta distribution, $\\theta_{0}\\in[0,\\pi)$ is a fixed angle, and $s_{0}\\in\\mathbb{R}$ is a fixed detector position. Using only the definitions and formulas provided above, derive the exact closed-form expression for the artifact field $\\hat{f}(x,y)$ produced by this sinogram impulse after the ideal ramp filtering and backprojection. Your final answer must be a single analytic expression in terms of $A$, $\\theta_{0}$, $s_{0}$, $x$, and $y$. No rounding is required. Do not include any physical units in your answer.",
            "solution": "The process to find the reconstructed artifact field $\\hat{f}(x,y)$ involves three main steps:\n1.  Filtering the given sinogram data $g(\\theta,s)$.\n2.  Backprojecting the filtered sinogram.\n3.  Determining the explicit form of the filter's impulse response $h(s)$.\n\n**Step 1: Filtering the Sinogram**\n\nThe filtering step involves convolving the sinogram $g(\\theta,s)$ with the filter impulse response $h(s)$ for each projection angle $\\theta$. The convolution is performed with respect to the spatial variable $s$. Let the filtered sinogram be denoted by $g_f(\\theta,s)$.\n\n$$\ng_f(\\theta,s) = (h * g(\\theta,\\cdot))(s) = \\int_{-\\infty}^{\\infty} h(s-s') g(\\theta,s') \\,ds'\n$$\n\nSubstitute the given expression for $g(\\theta,s')$:\n$$\ng_f(\\theta,s) = \\int_{-\\infty}^{\\infty} h(s-s') \\left[ A\\,\\delta(\\theta - \\theta_{0})\\,\\delta(s' - s_{0}) \\right] ds'\n$$\n\nThe term $A\\,\\delta(\\theta - \\theta_{0})$ is constant with respect to the integration variable $s'$. We can factor it out of the integral.\n$$\ng_f(\\theta,s) = A\\,\\delta(\\theta - \\theta_{0}) \\int_{-\\infty}^{\\infty} h(s-s') \\delta(s' - s_{0}) \\,ds'\n$$\n\nUsing the sifting property of the Dirac delta distribution, which states that $\\int_{-\\infty}^{\\infty} \\phi(t) \\delta(t-t_0) dt = \\phi(t_0)$, the integral evaluates to $h(s-s_0)$.\n$$\ng_f(\\theta,s) = A\\,\\delta(\\theta - \\theta_{0})\\,h(s - s_{0})\n$$\n\nThis result shows that the filtered sinogram is also an impulse, but only in the $\\theta$ dimension. In the $s$ dimension, the original impulse $\\delta(s - s_0)$ has been replaced by the filter's impulse response $h(s)$, shifted to $s_0$.\n\n**Step 2: Backprojection**\n\nThe FBP reconstruction is obtained by integrating the filtered projections over all angles $\\theta$.\nThe formula is:\n$$\n\\hat{f}(x,y) = \\int_{0}^{\\pi} g_f(\\theta, x\\cos\\theta + y\\sin\\theta)\\,d\\theta\n$$\n\nSubstitute the expression for the filtered sinogram $g_f(\\theta,s)$ into this formula. The second argument to $g_f$ is $s = x\\cos\\theta + y\\sin\\theta$.\n$$\n\\hat{f}(x,y) = \\int_{0}^{\\pi} A\\,\\delta(\\theta - \\theta_{0})\\,h\\big( (x\\cos\\theta + y\\sin\\theta) - s_{0} \\big)\\,d\\theta\n$$\n\nThis integral is with respect to $\\theta$. We can again apply the sifting property of the Dirac delta $\\delta(\\theta - \\theta_0)$. Since it is given that $\\theta_0 \\in [0, \\pi)$, the impulse lies within the integration domain. The integral evaluates the rest of the integrand at $\\theta = \\theta_0$.\n\n$$\n\\hat{f}(x,y) = A\\,h(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)\n$$\n\nThis intermediate result shows that the artifact field is given by the amplitude $A$ times the filter's impulse response, evaluated along rays parallel to the original corrupted ray. The expression $x\\cos\\theta_0 + y\\sin\\theta_0 - s_0$ represents the perpendicular distance from a point $(x,y)$ to the line defined by the ray at angle $\\theta_0$ and position $s_0$.\n\n**Step 3: Determining the Filter Impulse Response $h(s)$**\n\nThe final step is to find the explicit form of $h(s)$. We are given that its Fourier transform is $\\mathcal{F}\\{h\\}(\\omega) = |\\omega|$. The impulse response is found by taking the inverse Fourier transform, using the provided definition:\n$$\nh(s) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |\\omega|\\,\\exp(i \\omega s)\\,d\\omega\n$$\nThis integral does not converge in the ordinary sense and must be interpreted in the theory of distributions. A standard method to evaluate it is through regularization. We introduce a convergence factor $\\exp(-\\epsilon|\\omega|)$ and take the limit as $\\epsilon \\to 0^+$.\n\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |\\omega|\\,\\exp(-\\epsilon|\\omega|)\\,\\exp(i \\omega s)\\,d\\omega\n$$\n\nWe split the integral into two parts: from $-\\infty$ to $0$ and from $0$ to $\\infty$. For $\\omega<0$, $|\\omega| = -\\omega$. For $\\omega>0$, $|\\omega| = \\omega$.\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\left[ \\int_{-\\infty}^{0} (-\\omega)\\exp(\\epsilon\\omega)\\exp(i\\omega s)\\,d\\omega + \\int_{0}^{\\infty} \\omega\\exp(-\\epsilon\\omega)\\exp(i\\omega s)\\,d\\omega \\right]\n$$\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\left[ -\\int_{-\\infty}^{0} \\omega\\exp(\\omega(\\epsilon+is))\\,d\\omega + \\int_{0}^{\\infty} \\omega\\exp(-\\omega(\\epsilon-is))\\,d\\omega \\right]\n$$\nUsing standard integral results, the two integrals evaluate to $\\frac{1}{(\\epsilon+is)^2}$ and $\\frac{1}{(\\epsilon-is)^2}$ respectively.\n\nSubstituting these results back:\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\left[ \\frac{1}{(\\epsilon+is)^2} + \\frac{1}{(\\epsilon-is)^2} \\right]\n$$\nBringing to a common denominator:\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\frac{(\\epsilon-is)^2 + (\\epsilon+is)^2}{((\\epsilon+is)(\\epsilon-is))^2} = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\frac{(\\epsilon^2-2i\\epsilon s-s^2) + (\\epsilon^2+2i\\epsilon s-s^2)}{(\\epsilon^2+s^2)^2}\n$$\n$$\nh(s) = \\lim_{\\epsilon \\to 0^+} \\frac{1}{2\\pi} \\frac{2\\epsilon^2 - 2s^2}{(\\epsilon^2+s^2)^2}\n$$\nFor any non-zero $s$, as $\\epsilon \\to 0^+$, the $\\epsilon^2$ terms vanish.\n$$\nh(s) = \\frac{-2s^2}{2\\pi(s^2)^2} = -\\frac{1}{\\pi s^2}, \\quad \\text{for } s \\neq 0\n$$\nThis is the desired impulse response of the ideal ramp filter.\n\n**Final Expression**\nNow, we substitute this expression for $h(s)$ back into our result from Step 2:\n$$\n\\hat{f}(x,y) = A\\,h(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)\n$$\nReplacing $s$ with the argument $(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)$:\n$$\n\\hat{f}(x,y) = A \\left(-\\frac{1}{\\pi(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)^2}\\right)\n$$\n$$\n\\hat{f}(x,y) = -\\frac{A}{\\pi(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)^2}\n$$\nThis is the closed-form expression for the artifact. It describes a \"streak\" artifact, where the reconstructed density is singular along the line $x\\cos\\theta_0 + y\\sin\\theta_0 = s_0$, which corresponds to the path of the X-ray that was corrupted in the sinogram.",
            "answer": "$$\\boxed{-\\frac{A}{\\pi(x\\cos\\theta_0 + y\\sin\\theta_0 - s_0)^2}}$$"
        }
    ]
}