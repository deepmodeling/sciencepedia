{
    "hands_on_practices": [
        {
            "introduction": "动态对比增强磁共振成像（DCE-MRI）分析的第一步是精确校准。将测得的MRI信号转化为有生理意义的浓度值，依赖于造影剂的一个关键物理特性：纵向弛豫率（longitudinal relaxivity），记为 $r_1$。本练习将引导你模拟一个基础的校准实验，通过测量一系列已知浓度仿体（phantom）的纵向弛豫时间，来验证弛豫速率 $R_1$ 与浓度 $C$ 之间的线性关系，并利用线性回归方法计算出 $r_1$ 的值 。这个过程不仅能加深你对基本原理的理解，还能锻炼你处理和分析实验数据的能力。",
            "id": "4905865",
            "problem": "您正在设计一个用于动态对比增强磁共振成像 (DCE-MRI) 的校准实验。目标是量化纵向弛豫率，其定义为每单位顺磁性造影剂浓度引起的纵向弛豫速率的增加量。您将实现一个算法，该算法使用线性回归从多室模体的测量数据中估计纵向弛豫率。\n\n从适用于医学影像学基础的基本原理出发。具体来说，请使用：\n- 纵向弛豫时间 $T_1$ 和纵向弛豫速率 $R_1$ 的定义，其中 $R_1 = 1/T_1$。\n- 在稀释体系中，顺磁性造影剂对弛豫的影响是线性响应，并且与背景弛豫速率呈线性叠加的这一概念。\n- 纵向弛豫率（记为 $r_1$）的定义，即每单位造影剂浓度下纵向弛豫速率的变化量。\n\n基于这些基础，推导出校准关系，该关系将测得的纵向弛豫速率与在没有造影剂时具有基线弛豫速率的模体的造影剂浓度联系起来。明确陈述推导过程中所作的任何假设，并证明在稀释体系中使用线性模型的合理性。不要使用或引用任何预先推导出的校准方程；从上述定义开始，一步步推导该关系。\n\n然后，实现一个程序，对每个提供的测试用例执行以下操作：\n- 使用 $R_1 = 1/T_1$ 将提供的测量的纵向弛豫时间转换为弛豫速率。\n- 通过带有截距项的普通最小二乘法，拟合一条关联 $R_1$ 与造影剂浓度的直线。\n- 输出这条线的估计斜率，该斜率对应于纵向弛豫率 $r_1$。\n\n物理单位和报告：\n- 浓度单位为 $\\mathrm{mM}$，纵向弛豫时间单位为 $\\mathrm{s}$，纵向弛豫速率单位为 $\\mathrm{s^{-1}}$，纵向弛豫率 $r_1$ 必须以 $\\mathrm{s^{-1}\\,mM^{-1}}$ 为单位进行报告。\n- 将每个估计的 $r_1$ 报告为一个浮点数，精确到 $4$ 位小数。\n\n测试套件：\n- 案例 $1$（涵盖中等浓度的一般稀释体系）：\n  - 浓度 (单位 $\\mathrm{mM}$): $[0.0, 0.5, 1.0, 2.0, 3.0]$。\n  - 测量的纵向弛豫时间 (单位 $\\mathrm{s}$): $[2.02, 0.3600, 0.2020, 0.1063, 0.0707]$。\n- 案例 $2$（较高的基线弛豫速率和较低的浓度范围）：\n  - 浓度 (单位 $\\mathrm{mM}$): $[0.0, 0.2, 0.4, 0.8, 1.6]$。\n  - 测量的纵向弛豫时间 (单位 $\\mathrm{s}$): $[1.212, 0.6367, 0.4442, 0.2719, 0.1501]$。\n- 案例 $3$（包含零浓度的双模体最小化设计）：\n  - 浓度 (单位 $\\mathrm{mM}$): $[0.0, 0.5]$。\n  - 测量的纵向弛豫时间 (单位 $\\mathrm{s}$): $[1.5, 0.375]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按测试用例的顺序排列结果，例如 $[r_{1,\\mathrm{case1}},r_{1,\\mathrm{case2}},r_{1,\\mathrm{case3}}]$，其中每个 $r_1$ 的单位为 $\\mathrm{s^{-1}\\,mM^{-1}}$ 并四舍五入到恰好 $4$ 位小数。",
            "solution": "我们从适用于磁共振成像 (MRI) 动态对比增强 (DCE) 方法的核心定义和线性响应理论出发。\n\n1. 纵向弛豫时间和速率的定义：\n   - 纵向弛豫时间是 $T_1$，通过描述纵向磁化强度指数恢复的布洛赫方程的纵向分量来定义，其时间常数为 $T_1$。\n   - 纵向弛豫速率定义为 $R_1 = 1/T_1$。\n\n2. 稀释体系中的可加性和线性响应：\n   - 顺磁性造影剂引入了波动的磁场，这增强了自旋态之间的跃迁速率，从而增加了纵向弛豫速率。\n   - 在稀释体系中，造影剂分子间的相互作用可以忽略不计，系统响应是线性的，总弛豫速率可以建模为背景速率（无造影剂时）与一个正比于造影剂浓度的贡献之和。\n   - 将背景纵向弛豫速率记为 $R_{1,0}$（等效地，$R_{1,0} = 1/T_{1,0}$，其中 $T_{1,0}$ 是零造影剂时的基线纵向弛豫时间）。\n   - 将纵向弛豫率 $r_1$ 定义为在低浓度下每单位浓度的纵向弛豫速率变化量，即 $r_1 = \\mathrm{d}R_1/\\mathrm{d}C$，在稀释的线性体系中求值。\n\n3. 校准关系的推导：\n   - 在线性响应假设下，$R_1$ 在浓度 $C=0$ 附近关于 $C$ 的一阶泰勒展开为\n     $$R_1(C) \\approx R_1(0) + \\left.\\frac{\\mathrm{d}R_1}{\\mathrm{d}C}\\right|_{C=0} \\, C.$$\n   - 通过识别 $R_1(0) = R_{1,0}$ 和 $\\left.\\frac{\\mathrm{d}R_1}{\\mathrm{d}C}\\right|_{C=0} = r_1$，我们得到线性校准模型\n     $$R_1(C) = R_{1,0} + r_1 \\, C,$$\n     其中在 $R_1$ 对 $C$ 的图中，$R_{1,0}$ 是截距，$r_1$ 是斜率。这直接源于 $R_1$ 的定义以及在线性响应和叠加假设下 $r_1$ 的定义。\n\n4. 从模体数据进行估计：\n   - 对于一组具有已知浓度 $\\{C_i\\}_{i=1}^N$ 和测量纵向弛豫时间 $\\{T_{1,i}\\}_{i=1}^N$ 的 $N$ 个模体，计算 $R_{1,i} = 1/T_{1,i}$。\n   - 拟合线性模型\n     $$R_{1,i} = \\beta_0 + \\beta_1 \\, C_i + \\varepsilon_i,$$\n     其中 $\\beta_0$ 估计 $R_{1,0}$，$\\beta_1$ 估计 $r_1$，而 $\\varepsilon_i$ 是残差。\n   - 普通最小二乘解的矩阵形式使用设计矩阵\n     $$\\mathbf{X} = \\begin{bmatrix} 1  C_1 \\\\ 1  C_2 \\\\ \\vdots  \\vdots \\\\ 1  C_N \\end{bmatrix}, \\quad \\mathbf{y} = \\begin{bmatrix} R_{1,1} \\\\ R_{1,2} \\\\ \\vdots \\\\ R_{1,N} \\end{bmatrix},$$\n     以及参数估计\n     $$\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} \\hat{\\beta}_0 \\\\ \\hat{\\beta}_1 \\end{bmatrix} = \\left(\\mathbf{X}^\\top \\mathbf{X}\\right)^{-1} \\mathbf{X}^\\top \\mathbf{y}.$$\n     纵向弛豫率的估计值为 $\\hat{r}_1 = \\hat{\\beta}_1$。\n\n5. 算法：\n   - 对每个测试用例：\n     - 通过 $R_{1,i} = 1/T_{1,i}$ 将每个 $T_{1,i}$ 转换为 $R_{1,i}$。\n     - 构建一个包含一列 1 和一列浓度的设计矩阵 $\\mathbf{X}$。\n     - 通过最小二乘法求解 $\\hat{\\boldsymbol{\\beta}}$。\n     - 提取 $\\hat{r}_1 = \\hat{\\beta}_1$。\n     - 以 $\\mathrm{s^{-1}\\,mM^{-1}}$ 为单位报告 $\\hat{r}_1$，四舍五入到 $4$ 位小数。\n\n6. 应用于提供的测试套件：\n   - 案例 1：\n     - 浓度 $[0.0, 0.5, 1.0, 2.0, 3.0]$，$T_1$ 测量值 $[2.02, 0.3600, 0.2020, 0.1063, 0.0707]$。\n     - 转换为 $R_1$ 得到约 $[0.4950, 2.7778, 4.9505, 9.4059, 14.1421]$，单位 $\\mathrm{s^{-1}}$。\n     - 普通最小二乘法得到 $\\hat{r}_1 \\approx 4.5293$，单位 $\\mathrm{s^{-1}\\,mM^{-1}}$。\n   - 案例 2：\n     - 浓度 $[0.0, 0.2, 0.4, 0.8, 1.6]$，$T_1$ 测量值 $[1.212, 0.6367, 0.4442, 0.2719, 0.1501]$。\n     - 转换为 $R_1$ 得到约 $[0.8251, 1.5693, 2.2518, 3.6778, 6.6636]$，单位 $\\mathrm{s^{-1}}$。\n     - 普通最小二乘法得到 $\\hat{r}_1 \\approx 3.6413$，单位 $\\mathrm{s^{-1}\\,mM^{-1}}$。\n   - 案例 3：\n     - 浓度 $[0.0, 0.5]$，$T_1$ 测量值 $[1.5, 0.375]$。\n     - 转换为 $R_1$ 得到精确值 $[0.6667, 2.6667]$，单位 $\\mathrm{s^{-1}}$（取决于舍入）。\n     - 两点线的斜率为 $\\hat{r}_1 = (2.6667 - 0.6667)/(0.5 - 0.0) = 4.0000$，单位 $\\mathrm{s^{-1}\\,mM^{-1}}$。\n\n因此，程序应输出一行，其中包含三个 $\\hat{r}_1$ 值，每个值都四舍五入到 $4$ 位小数，并用方括号括起来。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef ols_slope_with_intercept(x, y):\n    \"\"\"\n    Fit y = a + b*x by ordinary least squares and return b (the slope).\n    x: 1D array of concentrations\n    y: 1D array of relaxation rates (R1)\n    \"\"\"\n    x = np.asarray(x, dtype=float).ravel()\n    y = np.asarray(y, dtype=float).ravel()\n    # Design matrix with intercept\n    X = np.column_stack([np.ones_like(x), x])\n    # Solve least squares\n    beta, *_ = np.linalg.lstsq(X, y, rcond=None)\n    # beta[1] is the slope (relaxivity r1)\n    return float(beta[1])\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (concentrations_mM, measured_T1_seconds)\n    test_cases = [\n        # Case 1\n        ([0.0, 0.5, 1.0, 2.0, 3.0], [2.02, 0.3600, 0.2020, 0.1063, 0.0707]),\n        # Case 2\n        ([0.0, 0.2, 0.4, 0.8, 1.6], [1.212, 0.6367, 0.4442, 0.2719, 0.1501]),\n        # Case 3 (two-point minimal calibration)\n        ([0.0, 0.5], [1.5, 0.375]),\n    ]\n\n    results = []\n    for conc_mM, T1_s in test_cases:\n        conc = np.array(conc_mM, dtype=float)\n        T1 = np.array(T1_s, dtype=float)\n        # Convert T1 to R1 = 1/T1\n        R1 = 1.0 / T1\n        # Fit R1 = intercept + r1 * concentration\n        r1_est = ols_slope_with_intercept(conc, R1)\n        # Round to 4 decimal places for output\n        results.append(f\"{r1_est:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在通过实验校准确定了造影剂的弛豫率 $r_1$ 之后，我们就可以将这一参数应用于真实的DCE-MRI数据分析中。这个练习的核心是掌握如何将测量的纵向弛豫时间 $T_1$ 的变化，转化为组织内造影剂浓度 $c(t)$ 的变化。这是连接MRI物理测量与药代动力学模型之间至关重要的桥梁，是理解所有DCE-MRI研究的基础 。",
            "id": "4905902",
            "problem": "在一个单体素动态对比增强磁共振成像 (DCE-MRI) 实验中，对脑组织使用了一种基于钆的造影剂。该实验的条件是线性弛豫率模型有效，且室间水交换速度很快。设注射后时间 $t$ 的纵向弛豫时间为 $T_1(t)$，造影前基线为 $T_{10}$。定义纵向弛豫率 $R_1(t)$ 和基线弛豫率 $R_{10}$ 为 $R_1(t) = 1/T_1(t)$ 和 $R_{10} = 1/T_{10}$。线性弛豫率关系表明，弛豫率的变化量 $\\Delta R_1(t)$ 与造影剂浓度 $c(t)$ 成正比，即 $\\Delta R_1(t) = r_1 c(t)$，其中 $r_1$ 是纵向弛豫率。\n\n基于这些基础，推导出一个用 $T_1(t)$、$T_{10}$ 和 $r_1$ 表示 $c(t)$ 的表达式，然后计算当 $T_1(t) = 600\\,\\text{ms}$，$T_{10} = 1200\\,\\text{ms}$ 且 $r_1 = 4\\,\\text{s}^{-1}\\,\\text{mM}^{-1}$ 时的 $c(t)$ 值。将最终浓度以毫摩尔 (mM) 为单位表示，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "该问题要求根据动态对比增强磁共振成像 (DCE-MRI) 实验所提供的数据，推导造影剂浓度 $c(t)$ 的表达式，并进行数值计算。对问题陈述的验证证实了其科学上是合理的、提法得当，并且包含了所有必要信息。所提供的值对于脑组织和基于钆的造影剂来说，在物理上是符合实际的。\n\n推导从所提供的基本定义开始。纵向弛豫率 $R_1(t)$ 是纵向弛豫时间 $T_1(t)$ 的倒数。\n$$R_1(t) = \\frac{1}{T_1(t)}$$\n类似地，造影前基线弛豫率 $R_{10}$ 是基线弛豫时间 $T_{10}$ 的倒数。\n$$R_{10} = \\frac{1}{T_{10}}$$\n弛豫率的变化量 $\\Delta R_1(t)$ 定义为造影后弛豫率与基线弛豫率之差。\n$$\\Delta R_1(t) = R_1(t) - R_{10}$$\n将 $R_1(t)$ 和 $R_{10}$ 的定义代入此方程可得：\n$$\\Delta R_1(t) = \\frac{1}{T_1(t)} - \\frac{1}{T_{10}}$$\n问题陈述指出，在线性弛豫率体系中，弛豫率的变化量与造影剂浓度 $c(t)$ 成正比。比例常数是纵向弛豫率 $r_1$。\n$$\\Delta R_1(t) = r_1 c(t)$$\n为了推导 $c(t)$ 的表达式，我们令 $\\Delta R_1(t)$ 的两个表达式相等。\n$$r_1 c(t) = \\frac{1}{T_1(t)} - \\frac{1}{T_{10}}$$\n将两边同除以 $r_1$（假设 $r_1 \\neq 0$，这对于造影剂在物理上是成立的），求解 $c(t)$ 可得到造影剂浓度的一般表达式：\n$$c(t) = \\frac{1}{r_1} \\left( \\frac{1}{T_1(t)} - \\frac{1}{T_{10}} \\right)$$\n这就是所要求的用 $T_1(t)$、$T_{10}$ 和 $r_1$ 表示 $c(t)$ 的符号表达式。\n\n接下来，我们使用给定数据计算 $c(t)$ 的数值。给定的值为：\n$T_1(t) = 600\\,\\text{ms}$\n$T_{10} = 1200\\,\\text{ms}$\n$r_1 = 4\\,\\text{s}^{-1}\\,\\text{mM}^{-1}$\n\n弛豫率 $r_1$ 的单位以秒 ($\\text{s}$) 给出，而弛豫时间以毫秒 ($\\text{ms}$) 给出。为确保量纲一致，我们必须将弛豫时间转换为秒。\n$1\\,\\text{s} = 1000\\,\\text{ms}$，因此：\n$$T_1(t) = 600\\,\\text{ms} = 0.6\\,\\text{s}$$\n$$T_{10} = 1200\\,\\text{ms} = 1.2\\,\\text{s}$$\n现在我们将这些数值代入推导出的 $c(t)$ 表达式中。\n$$c(t) = \\frac{1}{4\\,\\text{s}^{-1}\\,\\text{mM}^{-1}} \\left( \\frac{1}{0.6\\,\\text{s}} - \\frac{1}{1.2\\,\\text{s}} \\right)$$\n首先，我们计算括号内的各项。\n$$\\frac{1}{0.6\\,\\text{s}} = \\frac{1}{6/10}\\,\\text{s}^{-1} = \\frac{10}{6}\\,\\text{s}^{-1} = \\frac{5}{3}\\,\\text{s}^{-1}$$\n$$\\frac{1}{1.2\\,\\text{s}} = \\frac{1}{12/10}\\,\\text{s}^{-1} = \\frac{10}{12}\\,\\text{s}^{-1} = \\frac{5}{6}\\,\\text{s}^{-1}$$\n差值为：\n$$\\frac{1}{T_1(t)} - \\frac{1}{T_{10}} = \\left( \\frac{5}{3} - \\frac{5}{6} \\right)\\,\\text{s}^{-1} = \\left( \\frac{10}{6} - \\frac{5}{6} \\right)\\,\\text{s}^{-1} = \\frac{5}{6}\\,\\text{s}^{-1}$$\n现在，我们可以计算 $c(t)$：\n$$c(t) = \\frac{1}{4\\,\\text{s}^{-1}\\,\\text{mM}^{-1}} \\left( \\frac{5}{6}\\,\\text{s}^{-1} \\right)$$\n单位 $\\text{s}^{-1}$ 相互抵消，剩下的浓度单位为 $\\text{mM}$，符合要求。\n$$c(t) = \\frac{5}{4 \\times 6}\\,\\text{mM} = \\frac{5}{24}\\,\\text{mM}$$\n最后，我们将此分数转换为小数值，并按要求四舍五入至四位有效数字。\n$$c(t) = \\frac{5}{24}\\,\\text{mM} \\approx 0.208333... \\,\\text{mM}$$\n四舍五入至四位有效数字得到：\n$$c(t) \\approx 0.2083\\,\\text{mM}$$",
            "answer": "$$\\boxed{0.2083}$$"
        },
        {
            "introduction": "当我们获得了组织浓度曲线 $c(t)$ 后，下一步就是利用药代动力学模型来提取描述组织特性的生理参数，例如灌注和血管通透性。本练习将深入探讨经典的双室模型，通过质量守恒原理，揭示模型中关键参数之间的关系，特别是前向容积转移常数 $K^{\\mathrm{trans}}$、流出速率常数 $k_{ep}$ 和血管外细胞外容积分数 $v_e$。你将推导出它们之间的核心关系式 $k_{ep} = K^{\\mathrm{trans}} / v_e$，从而从第一性原理层面深入理解这些参数如何描述示踪剂在血浆和组织间隙中的动态过程 。",
            "id": "4905866",
            "problem": "动态对比增强磁共振成像 (DCE-MRI) 中组织的双室模型描述了示踪剂在血浆和血管外细胞外间隙 (EES) 之间的交换。令 $C_p(t)$ 表示血浆中的示踪剂浓度，$C_e(t)$ 表示 EES 中的示踪剂浓度。血管外细胞外容积分数为 $v_e$（无量纲），因此 EES 中单位组织体积内包含的示踪剂量为 $v_e C_e(t)$。正向容积转移常数 $K^{trans}$ 定义为在一级动力学条件下，将示踪剂从血浆流入 EES 的通量与血浆浓度相关联的比例因子。假设跨毛细血管交换遵循具有单一屏障特性的线性唯象输运（即相同的微观渗透性-表面积乘积控制双向通量），并且质量守恒在 EES 房室中成立。\n\n从这些原理出发，推导从 EES 返回血浆的流出速率常数（表示为 $k_{ep}$）的表达式，用 $K^{trans}$ 和 $v_e$ 表示。然后，使用您推导的表达式，计算当 $K^{trans} = 0.2$ min$^{-1}$ 和 $v_e = 0.4$ 时的 $k_{ep}$ 值。通过解释在单次快速注射后 $C_p(t) = 0$ 且 EES 示踪剂动力学由洗出主导的特殊情况下 $k_{ep}$ 的含义来解释您的结果。\n\n以 min$^{-1}$ 为单位表示 $k_{ep}$ 的最终数值。无需四舍五入，给出精确值。",
            "solution": "*   陈述基本原理：EES 隔室中示踪剂的质量守恒。\n    *   将 EES 中单位组织体积内的示踪剂量定义为 $A_e(t) = v_e C_e(t)$。\n    *   根据变化率写出质量平衡方程：$\\frac{d A_e(t)}{dt} = \\text{流入速率} - \\text{流出速率}$。\n    *   从问题陈述中确定流入速率：$\\text{流入速率} = K^{trans} C_p(t)$。\n    *   推导流出速率。问题陈述中提到“具有单一屏障特性的线性唯象输运”。这意味着从 EES 到血浆的流出与从血浆到 EES 的流入是对称的，由相同的渗透性-表面积乘积控制。流出的驱动浓度是 $C_e(t)$。因此，单位组织体积的流出速率是 $K^{trans} C_e(t)$。\n    *   将这些速率代入质量平衡方程：$\\frac{d(v_e C_e(t))}{dt} = K^{trans} C_p(t) - K^{trans} C_e(t)$。\n    *   假设 $v_e$ 是一个常数，对左侧进行微分：$v_e \\frac{dC_e(t)}{dt} = K^{trans} C_p(t) - K^{trans} C_e(t)$。\n    *   重新整理方程以分离 EES 浓度的变化率 $\\frac{dC_e(t)}{dt}$：\n        $\\frac{dC_e(t)}{dt} = \\frac{K^{trans}}{v_e} C_p(t) - \\frac{K^{trans}}{v_e} C_e(t)$。\n    *   确定流出速率常数 $k_{ep}$。这是 $-C_e(t)$ 项的系数，该系数控制着示踪剂从 EES 清除的速率。\n    *   因此，$k_{ep} = \\frac{K^{trans}}{v_e}$。推导完成。\n    *   现在，进行数值计算。代入给定值：$K^{trans} = 0.2$ min$^{-1}$ 和 $v_e = 0.4$。\n    *   $k_{ep} = \\frac{0.2 \\text{ min}^{-1}}{0.4} = 0.5 \\text{ min}^{-1}$。\n    *   提供解释。考虑 $C_p(t) = 0$ 的情况。微分方程变为 $\\frac{dC_e(t)}{dt} = -k_{ep} C_e(t)$。\n    *   解释这是一级指数衰减方程，其解为 $C_e(t) = C_e(t_0) \\exp(-k_{ep}(t-t_0))$。\n    *   结论是，$k_{ep}$ 是示踪剂从 EES 指数洗出返回血浆的速率常数。它代表了从 EES 清除的分数率。其倒数 $1/k_{ep}$ 代表示踪剂在 EES 中的平均停留时间。",
            "answer": "$$\n\\boxed{0.5}\n$$"
        }
    ]
}