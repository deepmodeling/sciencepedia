{
    "hands_on_practices": [
        {
            "introduction": "Strain elastography and shear wave elastography (SWE) both aim to map tissue stiffness, but they rely on different physical principles which can lead to situations where their results appear to conflict. This exercise explores a classic ambiguity in strain imaging, where the measured strain depends not only on the tissue's intrinsic stiffness (Young's modulus) but also heavily on the mechanical boundary conditions. By working through a \"soft inclusion behind a hard shell\" scenario, you will gain a deep, quantitative understanding of why strain contrast can be misleading and how SWE, by measuring a boundary-condition-independent property, provides a more robust measure of tissue stiffness .",
            "id": "4940413",
            "problem": "You are given a synthetic, one-dimensional layered elastic medium intended to probe contrast ambiguities in Ultrasound Elastography (UE) when a soft inclusion is positioned beneath a hard superficial shell. Your goal is to construct a quantitative demonstration in which the apparent strain contrast reverses its sign under certain boundary conditions, and then design boundary conditions that recover the correct contrast sign. Work under the small deformation, linear, isotropic elasticity regime and use first principles.\n\nStart from the following foundational base:\n- Let $E$ denote the Young’s modulus, $\\nu$ the Poisson’s ratio, $\\mu$ the shear modulus, $\\rho$ the mass density, $\\boldsymbol{\\sigma}$ the Cauchy stress, and $\\boldsymbol{\\epsilon}$ the strain. For isotropic linear elasticity, use Hooke’s law in the form $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I}$ with Lamé parameters $\\lambda$ and $\\mu$, and the known relationships between $(E,\\nu)$ and $(\\lambda,\\mu)$.\n- For shear waves, use the shear wave speed formula $c_s = \\sqrt{\\mu / \\rho}$.\n\nConsider a two-layer stack in series along the axial direction $z$: a top hard shell with $(E_h,\\nu_h,\\rho_h)$ and a deeper soft inclusion with $(E_s,\\nu_s,\\rho_s)$. A uniform compressive pressure $p$ is applied at the top surface, inducing an axial stress $\\sigma_z = p$ everywhere (static equilibrium in series). Assume equal cross-sectional area for both layers and neglect body forces.\n\nTwo measurement boundary-condition modes are defined:\n1. Mode Free (plane stress, lateral stress-free): lateral stresses vanish, $\\sigma_x = \\sigma_y = 0$ everywhere.\n2. Mode Constrained (mixed mode): the superficial shell remains in plane stress ($\\sigma_x = \\sigma_y = 0$), while the soft inclusion is laterally constrained (plane strain), $\\epsilon_x = \\epsilon_y = 0$ in the inclusion.\n\nYour program must, for each test case, perform the following steps based only on the foundational base above:\n1. Derive the axial strain $\\epsilon_z$ in each layer for Mode Free and Mode Constrained from Hooke’s law and isotropy, starting from the definitions and relationships among $E$, $\\nu$, and $\\mu$.\n2. Define a naive apparent modulus under a plane-stress interpretation as $E_{\\text{app}} = p / \\epsilon_z$ for any measured axial strain $\\epsilon_z$ (this mimics interpreting strain images as inversely proportional to stiffness under the plane stress assumption).\n3. Under Mode Constrained, treat the hard shell measurement as plane stress (consistent with its boundary condition) and the soft inclusion measurement as plane strain (consistent with its boundary condition). Compute $E_{\\text{app},h}$ and $E_{\\text{app},s}$ accordingly and determine ambiguity as a boolean: ambiguous is true if the naive classification would label the inclusion as stiffer than the shell, i.e., if $E_{\\text{app},s} > E_{\\text{app},h}$ while the ground truth has $E_s < E_h$.\n4. Under Mode Free, both layers are in plane stress. Compute $E_{\\text{app},h}$ and $E_{\\text{app},s}$ and report whether this boundary condition resolves the contrast sign as a boolean: resolved is true if $E_{\\text{app},s} < E_{\\text{app},h}$ whenever $E_s < E_h$.\n5. Independently, compute the shear wave speeds in each layer, $c_{s,h} = \\sqrt{\\mu_h / \\rho_h}$ and $c_{s,s} = \\sqrt{\\mu_s / \\rho_s}$, with $\\mu = E/(2(1+\\nu))$, to demonstrate a boundary-condition-insensitive contrast modality (Shear Wave Elastography (SWE)). Report an integer shear_sign defined as $+1$ if $c_{s,h} > c_{s,s}$ and $-1$ otherwise.\n\nExpress all inputs in their specified physical units and compute outputs numerically:\n- Young’s moduli $E_h$, $E_s$ in kilopascals ($\\mathrm{kPa}$).\n- Pressure $p$ in kilopascals ($\\mathrm{kPa}$).\n- Densities $\\rho_h$, $\\rho_s$ in kilograms per cubic meter ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$).\n- Poisson’s ratios $\\nu_h$, $\\nu_s$ are dimensionless.\n- Axial strains $\\epsilon_z$ are dimensionless.\n- Shear wave speeds $c_s$ in meters per second ($\\mathrm{m}\\,\\mathrm{s}^{-1}$), but you only need the sign comparison as described.\n\nTest suite:\n- Case $1$ (happy path ambiguity): $E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$.\n- Case $2$ (boundary condition edge, more compressible): $E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.30$, $\\nu_s = 0.30$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$.\n- Case $3$ (near-modulus boundary, incompressible-like): $E_h = 12\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 1\\,\\mathrm{kPa}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three-element lists, one per test case, enclosed in square brackets. Each inner list must be of the form $[\\text{ambiguous}, \\text{resolved}, \\text{shear\\_sign}]$, where ambiguous and resolved are booleans and shear_sign is an integer. For example, the output should look like $[[\\text{True},\\text{False},1],[\\text{False},\\text{True},-1]]$ for two cases.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of linear elasticity, well-posed, objective, and internally consistent under the reasonable interpretation of a positive compression convention.\n\nThe analysis proceeds by deriving the axial strain under different boundary conditions from the first principles of continuum mechanics. We consider a two-layer medium, a hard superficial shell (h) and a soft deep inclusion (s), under a uniform axial compressive stress $\\sigma_z = p$. We adopt a convention where compressive stress and strain are positive. All material properties are assumed to be isotropic and linear elastic.\n\nThe fundamental constitutive relation is Hooke's law, given in terms of the Cauchy stress tensor $\\boldsymbol{\\sigma}$ and the infinitesimal strain tensor $\\boldsymbol{\\epsilon}$:\n$$ \\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I} $$\nwhere $\\mu$ is the shear modulus, $\\lambda$ is the first Lamé parameter, $\\operatorname{tr}(\\cdot)$ is the trace operator, and $\\mathbf{I}$ is the identity tensor. The elastic parameters $(\\lambda, \\mu)$ are related to Young's modulus $E$ and Poisson's ratio $\\nu$ by:\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\nAn inverted form of Hooke's law, expressing strain in terms of stress, is often more convenient:\n$$ \\epsilon_{ij} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\operatorname{tr}(\\boldsymbol{\\sigma}) \\delta_{ij} \\right] $$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\n**1. Derivation of Axial Strain $\\epsilon_z$**\n\nWe derive the axial strain $\\epsilon_z$ for the two specified boundary condition modes.\n\n**Mode Free (Plane Stress):**\nThis condition is defined by $\\sigma_x = \\sigma_y = 0$. It is applied to both layers in the \"Mode Free\" case, and to the hard shell in the \"Mode Constrained\" case. Using the inverted Hooke's law for the axial component $\\epsilon_z = \\epsilon_{zz}$:\n$$ \\epsilon_z = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_z - \\nu (\\sigma_x + \\sigma_y + \\sigma_z) \\right] $$\nSubstituting $\\sigma_x = 0$, $\\sigma_y = 0$, and the applied axial stress $\\sigma_z = p$:\n$$ \\epsilon_{z, \\text{stress}} = \\frac{1}{E} \\left[ (1+\\nu)p - \\nu (0 + 0 + p) \\right] = \\frac{1}{E} [p + \\nu p - \\nu p] = \\frac{p}{E} $$\nThus, for any layer under plane stress conditions, the axial strain is simply $\\epsilon_z = p/E$.\n\n**Mode Constrained (Plane Strain in Inclusion):**\nThis condition is defined by $\\epsilon_x = \\epsilon_y = 0$ and applies to the soft inclusion in the \"Mode Constrained\" case. We use the original form of Hooke's law. The axial stress component $\\sigma_z$ is:\n$$ \\sigma_z = \\lambda(\\epsilon_x + \\epsilon_y + \\epsilon_z) + 2\\mu\\epsilon_z $$\nSubstituting $\\epsilon_x = 0$ and $\\epsilon_y = 0$:\n$$ \\sigma_z = \\lambda \\epsilon_z + 2\\mu \\epsilon_z = (\\lambda + 2\\mu) \\epsilon_z $$\nGiven $\\sigma_z = p$, the axial strain is:\n$$ \\epsilon_{z, \\text{strain}} = \\frac{p}{\\lambda + 2\\mu} $$\nThe quantity $M = \\lambda + 2\\mu$ is the longitudinal or P-wave modulus. We express it in terms of $E$ and $\\nu$:\n$$ M = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + 2 \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} $$\n$$ M = \\frac{E}{1+\\nu} \\left( \\frac{\\nu}{1-2\\nu} + 1 \\right) = \\frac{E}{1+\\nu} \\left( \\frac{\\nu + 1 - 2\\nu}{1-2\\nu} \\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\nTherefore, for a layer under plane strain, the axial strain is:\n$$ \\epsilon_{z, \\text{strain}} = p \\frac{(1+\\nu)(1-2\\nu)}{E(1-\\nu)} $$\n\n**2. Apparent Modulus and Contrast Ambiguity (Mode Constrained)**\n\nThe problem defines a \"naive apparent modulus\" as $E_{\\text{app}} = p / \\epsilon_z$. This mimics an imaging scenario where all measured strain is interpreted via the simple plane stress relationship, $E = p/\\epsilon_z$.\n\nIn \"Mode Constrained\":\n- The hard shell is in plane stress, so $\\epsilon_{z,h} = p/E_h$. The apparent modulus is $E_{\\text{app},h} = p / \\epsilon_{z,h} = E_h$. The naive measurement is correct.\n- The soft inclusion is in plane strain, so $\\epsilon_{z,s} = p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}$. The naive apparent modulus is:\n  $$ E_{\\text{app},s} = \\frac{p}{\\epsilon_{z,s}} = \\frac{p}{p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}} = E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} $$\nAmbiguity, or contrast reversal, occurs when the soft inclusion is measured to be stiffer than the hard shell, i.e., $E_{\\text{app},s} > E_{\\text{app},h}$, despite the ground truth being $E_s < E_h$. The condition for ambiguity is:\n$$ E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} > E_h $$\nThis inequality shows that ambiguity is highly dependent on Poisson's ratio $\\nu_s$. As $\\nu_s$ approaches $0.5$ (the incompressible limit), the denominator $(1-2\\nu_s)$ approaches zero, causing $E_{\\text{app},s}$ to become very large, which can easily exceed $E_h$ even if $E_s$ is much smaller than $E_h$.\n\n**3. Contrast Resolution (Mode Free)**\n\nIn \"Mode Free\", both layers are in plane stress.\n- Hard shell: $\\epsilon_{z,h} = p/E_h$, so $E_{\\text{app},h} = p/\\epsilon_{z,h} = E_h$.\n- Soft inclusion: $\\epsilon_{z,s} = p/E_s$, so $E_{\\text{app},s} = p/\\epsilon_{z,s} = E_s$.\nIn this mode, the apparent moduli are equal to the true Young's moduli. The \"resolved\" condition is $E_{\\text{app},s} < E_{\\text{app},h}$ for a ground truth of $E_s < E_h$. This simplifies to $E_s < E_h$, which is true by construction. Therefore, the plane stress boundary condition correctly reflects the stiffness contrast.\n\n**4. Shear Wave Elastography (SWE)**\n\nSWE provides a measurement of stiffness that is independent of the compressive boundary conditions. It measures the shear wave speed, $c_s = \\sqrt{\\mu/\\rho}$. The shear modulus $\\mu$ is related to $E$ and $\\nu$ by $\\mu = E/(2(1+\\nu))$.\n- Hard shell: $c_{s,h} = \\sqrt{\\frac{\\mu_h}{\\rho_h}} = \\sqrt{\\frac{E_h}{2(1+\\nu_h)\\rho_h}}$.\n- Soft inclusion: $c_{s,s} = \\sqrt{\\frac{\\mu_s}{\\rho_s}} = \\sqrt{\\frac{E_s}{2(1+\\nu_s)\\rho_s}}$.\nThe sign of the stiffness contrast is determined by comparing $c_{s,h}$ and $c_{s,s}$. The `shear_sign` is $+1$ if $c_{s,h} > c_{s,s}$ and $-1$ otherwise. This comparison is equivalent to checking the sign of $(\\mu_h/\\rho_h) - (\\mu_s/\\rho_s)$. Since shear properties depend only on $\\mu$ and $\\rho$, they are not affected by the axial loading conditions ($\\sigma_z, \\epsilon_x, \\epsilon_y$).\n\nThis comprehensive theoretical framework is now applied to the specific test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ultrasound elastography contrast ambiguity problem\n    for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Eh, Es, nu_h, nu_s, rho_h, rho_s, p)\n    # Units: E in kPa, rho in kg/m^3, p in kPa, nu is dimensionless.\n    test_cases = [\n        (100.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 2.0),\n        (100.0, 10.0, 0.30, 0.30, 1000.0, 1000.0, 2.0),\n        (12.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Eh, Es, nu_h, nu_s, rho_h, rho_s, p = case\n        \n        # Ground truth: The soft inclusion is indeed softer than the hard shell.\n        ground_truth_softness = Es  Eh\n\n        # --- Task 3: Mode Constrained Analysis ---\n        \n        # The hard shell is in plane stress. Its naive apparent modulus measurement\n        # is correct and equals its true Young's modulus.\n        E_app_h_constrained = Eh\n        \n        # The soft inclusion is in plane strain, but its strain is naively interpreted\n        # using the plane stress formula E_app = p / epsilon_z.\n        # From first principles, the axial strain in plane strain is:\n        # epsilon_z_s = p * (1+nu_s)(1-2*nu_s) / (Es * (1-nu_s))\n        # The naive apparent modulus is therefore:\n        # E_app_s = p / epsilon_z_s = Es * (1-nu_s) / ((1+nu_s)*(1-2*nu_s))\n        \n        # Handle the near-incompressible case to avoid division by zero.\n        if nu_s >= 0.5:\n            # For a perfectly incompressible material (nu=0.5), a plane strain\n            # compression is impossible, and the apparent modulus is infinite.\n            E_app_s_constrained = float('inf')\n        else:\n            E_app_s_constrained = Es * (1.0 - nu_s) / ((1.0 + nu_s) * (1.0 - 2.0 * nu_s))\n        \n        # Ambiguity is true if the naive measurement makes the soft layer appear harder,\n        # reversing the true stiffness contrast.\n        ambiguous = (E_app_s_constrained > E_app_h_constrained) and ground_truth_softness\n\n        # --- Task 4: Mode Free Analysis ---\n        \n        # In this mode, both layers are in plane stress. The naive apparent modulus\n        # measurement is correct for both.\n        E_app_h_free = Eh\n        E_app_s_free = Es\n        \n        # Resolved is true if the measurement correctly shows the soft layer is softer.\n        resolved = (E_app_s_free  E_app_h_free) and ground_truth_softness\n        \n        # --- Task 5: Shear Wave Elastography Analysis ---\n        \n        # Shear modulus is defined as mu = E / (2*(1+nu)).\n        mu_h = Eh / (2.0 * (1.0 + nu_h))\n        mu_s = Es / (2.0 * (1.0 + nu_s))\n        \n        # Shear wave speed squared is proportional to mu/rho. We only need to compare\n        # this ratio. Unit conversions for E (kPa to Pa) cancel out.\n        cs_sq_h = mu_h / rho_h\n        cs_sq_s = mu_s / rho_s\n        \n        # The shear_sign indicates the stiffness contrast measured by SWE.\n        shear_sign = 1 if cs_sq_h > cs_sq_s else -1\n        \n        results.append([ambiguous, resolved, shear_sign])\n\n    # Final print statement must produce the single-line format specified.\n    # The str() of a Python list is '[item1, item2, ...]' which matches the required\n    # inner list format. The f-string constructs the final outer list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Generating shear waves using Acoustic Radiation Force Impulse (ARFI) is a delicate balancing act, as a powerful acoustic \"push\" is needed to create measurable tissue displacement, but this energy deposition is subject to strict safety regulations. This practice delves into the key engineering trade-offs in designing a shear wave acquisition sequence, where you will balance the need for high signal-to-noise ratio (SNR), which scales with push energy, against regulatory limits on tissue heating, quantified by the spatial-peak temporal-average intensity ($I_{\\mathrm{SPTA}}$). Solving this problem will give you practical insight into how system parameters like push duration and repetition frequency are optimized to achieve diagnostic-quality images while ensuring patient safety .",
            "id": "4940426",
            "problem": "A shear-wave elastography system generates shear waves by delivering a focused acoustic push beam with spatial-peak pulse-average intensity (SPPA), denoted by $I_{\\mathrm{SPPA}}$, for a push duration $ \\tau_{\\mathrm{push}}$, repeated at a push repetition frequency $ f_{\\mathrm{rep}}$. The imaging sequence also includes ongoing diagnostic imaging that contributes a constant baseline spatial-peak temporal-average intensity (SPTA), denoted by $I_{\\mathrm{SPTA,base}}$. The regulatory limit on the total SPTA is $I_{\\mathrm{SPTA,lim}}$.\n\nAssume the following foundational relationships:\n- The spatial-peak temporal-average intensity is the temporal average of the spatial-peak intensity over a cycle, so the push contribution to SPTA is $I_{\\mathrm{SPPA}} \\times (\\tau_{\\mathrm{push}} f_{\\mathrm{rep}})$, and the total SPTA is $I_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\tau_{\\mathrm{push}} f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}$.\n- From prior calibration on a homogeneous soft-tissue phantom, the shear wave signal-to-noise ratio (SNR), denoted by $\\mathrm{SNR}$, scales linearly with the push intensity-time product as $\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}$, where $k$ is a known proportionality constant determined by the system and the tissue class under test.\n\nGiven the following parameters:\n- $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n- $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$,\n- Target shear wave $\\mathrm{SNR}_{\\mathrm{target}} = 12$,\n- $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n- $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$,\n\nDesign the push parameters to minimize the push on-time while meeting the target shear wave $\\mathrm{SNR}_{\\mathrm{target}}$, and then compute the maximum permissible $ f_{\\mathrm{rep}} $ that still satisfies the SPTA regulatory limit. Specifically:\n1. Choose $ \\tau_{\\mathrm{push}} $ to be the minimum value that achieves $ \\mathrm{SNR}_{\\mathrm{target}} $.\n2. Using that choice of $ \\tau_{\\mathrm{push}} $, determine the maximum allowable push repetition frequency $ f_{\\mathrm{rep,max}} $ such that $ I_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}} $.\n\nExpress the final numerical answer for $ f_{\\mathrm{rep,max}} $ in $\\mathrm{Hz}$, and round your answer to four significant figures.",
            "solution": "The user wants me to solve the user's problem.\n\n### Step 1: Extract Givens\n- Spatial-peak pulse-average intensity: $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- Push duration: $\\tau_{\\mathrm{push}}$\n- Push repetition frequency: $f_{\\mathrm{rep}}$\n- Baseline spatial-peak temporal-average intensity: $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- Regulatory limit on total SPTA: $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- Proportionality constant: $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$\n- Target shear wave SNR: $\\mathrm{SNR}_{\\mathrm{target}} = 12$\n- Relationship for total SPTA: $I_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\tau_{\\mathrm{push}} f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}$\n- Relationship for SNR: $\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}$\n- Task 1: Choose $\\tau_{\\mathrm{push}}$ to be the minimum value that achieves $\\mathrm{SNR}_{\\mathrm{target}}$.\n- Task 2: Using that $\\tau_{\\mathrm{push}}$, determine the maximum allowable push repetition frequency $f_{\\mathrm{rep,max}}$ such that $I_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem is well-grounded in the physics of ultrasound bioeffects and acoustic radiation force impulse (ARFI) elastography. The concepts of $I_{\\mathrm{SPPA}}$ and $I_{\\mathrm{SPTA}}$ and their relationship via a duty factor ($\\tau_{\\mathrm{push}} f_{\\mathrm{rep}}$) are fundamental to ultrasound safety standards. The linear scaling of SNR with the intensity-time product is a valid and common first-order model for ARFI. The provided numerical values are physically plausible for a clinical elastography system.\n- **Well-Posed**: The problem is clearly stated with two distinct, sequential tasks. All necessary equations and parameters are provided to find a unique solution.\n- **Objective**: The problem is stated in precise, quantitative terms, free of subjective or ambiguous language.\n- **Complete and Consistent**: The problem is self-contained. The provided units are dimensionally consistent. For the SNR equation, the units are $(\\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}) \\times (\\mathrm{W} \\, \\mathrm{m}^{-2}) \\times (\\mathrm{s})$, which correctly results in a dimensionless quantity. For the SPTA equation, the term $I_{\\mathrm{SPPA}} \\tau_{\\mathrm{push}} f_{\\mathrm{rep}}$ has units of $(\\mathrm{W} \\, \\mathrm{m}^{-2}) \\times (\\mathrm{s}) \\times (\\mathrm{Hz})$, which correctly yields units of intensity $(\\mathrm{W} \\, \\mathrm{m}^{-2})$. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution proceeds in two parts as specified by the problem statement. First, we determine the minimum push duration, $\\tau_{\\mathrm{push}}$, required to meet the target signal-to-noise ratio. Second, using this calculated duration, we find the maximum push repetition frequency, $f_{\\mathrm{rep,max}}$, that complies with the regulatory intensity limit.\n\n**Part 1: Determine the minimum push duration $\\tau_{\\mathrm{push}}$**\n\nThe signal-to-noise ratio ($\\mathrm{SNR}$) is given by the linear relationship:\n$$\n\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}\n$$\nTo achieve the target $\\mathrm{SNR}$, denoted $\\mathrm{SNR}_{\\mathrm{target}}$, while minimizing the push duration $\\tau_{\\mathrm{push}}$, we set the equation to an equality:\n$$\n\\mathrm{SNR}_{\\mathrm{target}} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}\n$$\nSolving for $\\tau_{\\mathrm{push}}$ gives:\n$$\n\\tau_{\\mathrm{push}} = \\frac{\\mathrm{SNR}_{\\mathrm{target}}}{k \\, I_{\\mathrm{SPPA}}}\n$$\nNow, we substitute the given values: $\\mathrm{SNR}_{\\mathrm{target}} = 12$, $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$, and $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$.\n$$\n\\tau_{\\mathrm{push}} = \\frac{12}{(5.0 \\times 10^{-3}) \\times (4.0 \\times 10^{5})}\n$$\nFirst, calculate the product in the denominator:\n$$\nk \\, I_{\\mathrm{SPPA}} = (5.0 \\times 4.0) \\times (10^{-3} \\times 10^{5}) = 20.0 \\times 10^{2} = 2.0 \\times 10^{3} \\ \\mathrm{s}^{-1}\n$$\nNow, we compute $\\tau_{\\mathrm{push}}$:\n$$\n\\tau_{\\mathrm{push}} = \\frac{12}{2.0 \\times 10^{3}} = 6.0 \\times 10^{-3} \\ \\mathrm{s}\n$$\nThis is the minimum push duration required to achieve the target SNR.\n\n**Part 2: Determine the maximum push repetition frequency $f_{\\mathrm{rep,max}}$**\n\nThe total spatial-peak temporal-average intensity, $I_{\\mathrm{SPTA,tot}}$, is given as the sum of the push pulse contribution and the baseline imaging contribution:\n$$\nI_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}\n$$\nThe regulatory constraint is that this total intensity must not exceed a specified limit, $I_{\\mathrm{SPTA,lim}}$:\n$$\nI_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}}\n$$\nTo find the maximum permissible push repetition frequency, $f_{\\mathrm{rep,max}}$, we set the total intensity to its upper limit:\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep,max}} + I_{\\mathrm{SPTA,base}} = I_{\\mathrm{SPTA,lim}}\n$$\nWe solve this equation for $f_{\\mathrm{rep,max}}$:\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep,max}} = I_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}}\n$$\n$$\nf_{\\mathrm{rep,max}} = \\frac{I_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}}}{I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}}\n$$\nWe substitute the known and previously calculated values: $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$, and $\\tau_{\\mathrm{push}} = 6.0 \\times 10^{-3} \\ \\mathrm{s}$.\n\nFirst, calculate the numerator:\n$$\nI_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}} = (7.2 \\times 10^{3}) - (1.2 \\times 10^{3}) = (7.2 - 1.2) \\times 10^{3} = 6.0 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}\n$$\nNext, calculate the denominator (the intensity-time product of a single push):\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} = (4.0 \\times 10^{5}) \\times (6.0 \\times 10^{-3}) = 24.0 \\times 10^{2} = 2.4 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{s} \\, \\mathrm{m}^{-2}\n$$\nFinally, compute $f_{\\mathrm{rep,max}}$:\n$$\nf_{\\mathrm{rep,max}} = \\frac{6.0 \\times 10^{3}}{2.4 \\times 10^{3}} = \\frac{6.0}{2.4} = 2.5 \\ \\mathrm{Hz}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nf_{\\mathrm{rep,max}} = 2.500 \\ \\mathrm{Hz}\n$$",
            "answer": "$$\n\\boxed{2.500}\n$$"
        },
        {
            "introduction": "After measuring tissue displacements, an \"inversion\" algorithm is required to reconstruct a quantitative map of the shear modulus, and this reconstruction process itself influences the quality and interpretation of the final elastogram, particularly its spatial resolution. This exercise introduces the concept of a point-spread function (PSF) in the context of image reconstruction, using Fourier analysis to demonstrate how a common noise-suppression technique, Tikhonov regularization, acts as a spatial filter that inherently blurs the stiffness map. By deriving the relationship between the regularization parameter and the full width at half maximum (FWHM) of the PSF, you will understand that spatial resolution in elastography is not just a function of the ultrasound system, but also a direct consequence of the mathematical trade-off between noise and detail in the final image .",
            "id": "4940373",
            "problem": "In ultrasound shear-wave elastography, a preliminary estimate of the spatially varying shear modulus $\\mu(x)$ is often obtained from measured displacements but then refined by an inversion that imposes smoothness to suppress noise. Consider a one-dimensional stiffness reconstruction that takes a preliminary estimate $\\mu_{0}(x)$ and returns the final map $\\widehat{\\mu}(x)$ by minimizing a quadratic Tikhonov functional with a first-derivative (gradient) penalty. Assume uniformly spaced sampling with spatial pitch $\\Delta x$ so that the measurement is effectively band-limited by a cut-off spatial angular wavenumber $k_{c}$ set by the sampling theorem.\n\nStarting from first principles (definition of the point-spread function, the Fourier transform pair, and the Nyquist band-limit imposed by uniform sampling), define the effective point-spread function (PSF) of the reconstructed stiffness map as the spatial impulse response of the combined system consisting of the inversion operator and the sampling band-limit. Define the effective spatial resolution $R$ as the full width at half maximum (FWHM) of this PSF.\n\nWork under the following physically consistent assumptions:\n- The inversion is linearized around small perturbations, and the data fidelity term is identity (the operator matches $\\widehat{\\mu}(x)$ to $\\mu_{0}(x)$), while the smoothness is penalized by the squared $L^{2}$-norm of the spatial gradient of $\\widehat{\\mu}(x)$.\n- The reconstruction and sampling are space-invariant over the field of view.\n- Use the spatial angular wavenumber $k$ for Fourier-domain analysis, with the transform pair $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i}kx)\\,\\mathrm{d}x$ and $f(x) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\widehat{f}(k)\\,\\exp(\\mathrm{i}kx)\\,\\mathrm{d}k$.\n- The sampling band-limit is modeled as an ideal rectangular passband of width $2k_{c}$, with $k_{c} = \\pi/\\Delta x$.\n\nDerive the PSF and its FWHM expression $R$ in closed form for the Tikhonov inversion described above, and then compute the numerical value of $R$ for the parameter values\n$\\lambda = 1.0 \\times 10^{-6}\\ \\mathrm{m}^{2}$ and $\\Delta x = 1.0 \\times 10^{-4}\\ \\mathrm{m}$,\nin the well-sampled regime where the sampling cut-off exceeds the inversion filter’s roll-off so that the passband does not materially truncate the PSF (justify this regime quantitatively).\n\nExpress the final numerical value of $R$ in millimeters and round your answer to four significant figures.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of inverse problems and signal processing, is well-posed with a clear objective and sufficient information, and is free from contradictions or ambiguities.\n\nThe task is to determine the effective spatial resolution, defined as the Full Width at Half Maximum (FWHM) of the system's point-spread function (PSF), for a one-dimensional Tikhonov-regularized stiffness reconstruction.\n\nThe reconstruction $\\widehat{\\mu}(x)$ is found by minimizing the following functional, which consists of a data fidelity term and a first-derivative regularization term:\n$$ J[\\widehat{\\mu}] = \\int_{-\\infty}^{\\infty} (\\widehat{\\mu}(x) - \\mu_0(x))^2 \\, \\mathrm{d}x + \\lambda \\int_{-\\infty}^{\\infty} \\left(\\frac{\\mathrm{d}\\widehat{\\mu}(x)}{\\mathrm{d}x}\\right)^2 \\, \\mathrm{d}x $$\nHere, $\\mu_0(x)$ is the preliminary estimate of the shear modulus and $\\lambda$ is the regularization parameter with units of length squared.\n\nTo minimize this functional, it is most convenient to work in the Fourier domain. Let $\\mathcal{F}\\{f(x)\\}(k)$ denote the Fourier transform of a function $f(x)$ with respect to the spatial variable $x$ into the spatial angular wavenumber domain $k$. Using Parseval's theorem, which states $\\int_{-\\infty}^{\\infty} |f(x)|^2\\,\\mathrm{d}x = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |\\mathcal{F}\\{f\\}(k)|^2\\,\\mathrm{d}k$, and the property that the Fourier transform of a derivative is $\\mathcal{F}\\{\\frac{\\mathrm{d}f}{\\mathrm{d}x}\\}(k) = \\mathrm{i}k\\mathcal{F}\\{f\\}(k)$, the functional can be rewritten as:\n$$ J[\\widehat{\\mu}] = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left| \\mathcal{F}\\{\\widehat{\\mu}\\}(k) - \\mathcal{F}\\{\\mu_0\\}(k) \\right|^2 \\, \\mathrm{d}k + \\frac{\\lambda}{2\\pi} \\int_{-\\infty}^{\\infty} \\left| \\mathrm{i}k \\mathcal{F}\\{\\widehat{\\mu}\\}(k) \\right|^2 \\, \\mathrm{d}k $$\n$$ J[\\widehat{\\mu}] = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left( \\left| \\mathcal{F}\\{\\widehat{\\mu}\\}(k) - \\mathcal{F}\\{\\mu_0\\}(k) \\right|^2 + \\lambda k^2 \\left| \\mathcal{F}\\{\\widehat{\\mu}\\}(k) \\right|^2 \\right) \\, \\mathrm{d}k $$\nTo minimize the integral, we can minimize the integrand for each value of $k$ independently. Differentiating the integrand with respect to the complex variable $\\mathcal{F}\\{\\widehat{\\mu}\\}(k)^*$ (or by considering its real and imaginary parts) and setting the result to zero yields the solution:\n$$ \\left( \\mathcal{F}\\{\\widehat{\\mu}\\}(k) - \\mathcal{F}\\{\\mu_0\\}(k) \\right) + \\lambda k^2 \\mathcal{F}\\{\\widehat{\\mu}\\}(k) = 0 $$\n$$ \\mathcal{F}\\{\\widehat{\\mu}\\}(k) (1 + \\lambda k^2) = \\mathcal{F}\\{\\mu_0\\}(k) $$\nThus, the relationship between the reconstructed map and the initial estimate in the Fourier domain is:\n$$ \\mathcal{F}\\{\\widehat{\\mu}\\}(k) = \\frac{1}{1 + \\lambda k^2} \\mathcal{F}\\{\\mu_0\\}(k) $$\nThis defines the transfer function of the Tikhonov inversion operator, $H_{inv}(k)$:\n$$ H_{inv}(k) = \\frac{1}{1 + \\lambda k^2} $$\nThe problem states that the combined system includes the effect of sampling, which is modeled as an ideal rectangular passband filter, $H_{samp}(k)$, with a cut-off angular wavenumber $k_c = \\pi/\\Delta x$.\n$$ H_{samp}(k) = \\begin{cases} 1  |k| \\le k_c \\\\ 0  |k|  k_c \\end{cases} $$\nThe total system transfer function, $H_{total}(k)$, is the product of the inversion and sampling transfer functions:\n$$ H_{total}(k) = H_{inv}(k) \\cdot H_{samp}(k) = \\frac{1}{1 + \\lambda k^2} \\cdot H_{samp}(k) $$\nThe Point-Spread Function, $\\mathrm{PSF}(x)$, is the inverse Fourier transform of $H_{total}(k)$:\n$$ \\mathrm{PSF}(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H_{total}(k) \\exp(\\mathrm{i}kx) \\, \\mathrm{d}k = \\frac{1}{2\\pi} \\int_{-k_c}^{k_c} \\frac{1}{1 + \\lambda k^2} \\exp(\\mathrm{i}kx) \\, \\mathrm{d}k $$\nThe problem asks to work in the \"well-sampled regime\" where the sampling passband does not materially truncate the PSF. We must justify this. The characteristic roll-off wavenumber of the inversion filter $H_{inv}(k)$ is $k_{char} = 1/\\sqrt{\\lambda}$. The sampling cutoff is $k_c = \\pi/\\Delta x$.\nGiven $\\lambda = 1.0 \\times 10^{-6}\\ \\mathrm{m}^2$, we have $\\sqrt{\\lambda} = 1.0 \\times 10^{-3}\\ \\mathrm{m}$, so $k_{char} = 1/\\sqrt{\\lambda} = 1000\\ \\mathrm{m}^{-1}$.\nGiven $\\Delta x = 1.0 \\times 10^{-4}\\ \\mathrm{m}$, we have $k_c = \\pi / (1.0 \\times 10^{-4}) \\approx 31416\\ \\mathrm{m}^{-1}$.\nSince $k_c \\gg k_{char}$, the filter $H_{inv}(k)$ will have decayed to a very small value by $k=k_c$. The value of the filter at the cutoff is $H_{inv}(k_c) = (1 + \\lambda k_c^2)^{-1} = (1 + (10^{-3})^2 (\\pi \\times 10^4)^2)^{-1} = (1 + 10^{-6} \\pi^2 10^8)^{-1} = (1 + 100 \\pi^2)^{-1} \\approx (1+987)^{-1} \\approx 0.001$. This is a negligible value compared to the peak value of $1$, justifying the approximation of extending the integration limits from $[-k_c, k_c]$ to $(-\\infty, \\infty)$.\n$$ \\mathrm{PSF}(x) \\approx \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{1 + \\lambda k^2} \\exp(\\mathrm{i}kx) \\, \\mathrm{d}k $$\nThis is a standard Fourier transform pair. Let $a = 1/\\sqrt{\\lambda}$. The integral is the inverse Fourier transform of $\\frac{a^2}{a^2+k^2}$.\nThe transform pair is $\\mathcal{F}\\{\\frac{1}{2a}\\exp(-a|x|)\\}(k) = \\frac{1}{a^2+k^2}$. Therefore, the inverse transform is:\n$$ \\mathrm{PSF}(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{1 + (\\sqrt{\\lambda}k)^2} \\exp(\\mathrm{i}kx) \\, \\mathrm{d}k = \\frac{1}{2\\sqrt{\\lambda}} \\exp\\left(-\\frac{|x|}{\\sqrt{\\lambda}}\\right) $$\nThis is the closed-form expression for the PSF, which is a two-sided exponential function.\n\nThe spatial resolution $R$ is defined as the FWHM of this PSF. The maximum value occurs at $x=0$: $\\mathrm{PSF}_{max} = \\mathrm{PSF}(0) = \\frac{1}{2\\sqrt{\\lambda}}$. We seek the value $x_{1/2}$ such that $\\mathrm{PSF}(x_{1/2}) = \\frac{1}{2}\\mathrm{PSF}_{max}$.\n$$ \\frac{1}{2\\sqrt{\\lambda}} \\exp\\left(-\\frac{|x_{1/2}|}{\\sqrt{\\lambda}}\\right) = \\frac{1}{2} \\left(\\frac{1}{2\\sqrt{\\lambda}}\\right) $$\n$$ \\exp\\left(-\\frac{|x_{1/2}|}{\\sqrt{\\lambda}}\\right) = \\frac{1}{2} $$\nTaking the natural logarithm of both sides:\n$$ -\\frac{|x_{1/2}|}{\\sqrt{\\lambda}} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) $$\n$$ |x_{1/2}| = \\sqrt{\\lambda} \\ln(2) $$\nThe FWHM, $R$, is twice this value:\n$$ R = 2 |x_{1/2}| = 2\\sqrt{\\lambda} \\ln(2) $$\nNow, we substitute the given value $\\lambda = 1.0 \\times 10^{-6}\\ \\mathrm{m}^2$.\n$$ \\sqrt{\\lambda} = \\sqrt{1.0 \\times 10^{-6}\\ \\mathrm{m}^2} = 1.0 \\times 10^{-3}\\ \\mathrm{m} $$\n$$ R = 2 \\times (1.0 \\times 10^{-3}\\ \\mathrm{m}) \\times \\ln(2) $$\nUsing $\\ln(2) \\approx 0.693147...$,\n$$ R \\approx 2 \\times (1.0 \\times 10^{-3}\\ \\mathrm{m}) \\times 0.693147 \\approx 1.386294 \\times 10^{-3}\\ \\mathrm{m} $$\nThe problem requires the answer in millimeters, where $1\\ \\mathrm{mm} = 10^{-3}\\ \\mathrm{m}$.\n$$ R \\approx 1.386294\\ \\mathrm{mm} $$\nRounding to four significant figures, we get:\n$$ R = 1.386\\ \\mathrm{mm} $$",
            "answer": "$$\\boxed{1.386}$$"
        }
    ]
}