{
    "hands_on_practices": [
        {
            "introduction": "在超声成像中，我们不仅关心波的形态，更关心它携带的能量。声压是超声场的一个基本可测量物理量，而声强则直接描述了能量的传输速率。本练习将指导您从第一性原理出发，推导并计算由声压振幅决定的声强，这对于理解图像信号的来源以及评估超声波的生物安全性至关重要。",
            "id": "4568803",
            "problem": "一个在连续波模式下工作的超声(US)换能器产生一束单色平面纵波，该波在均匀、无损耗的软组织中传播。在声场中可将声束近似为平面的某一点，测得的峰值（振幅）声压为 $1.0 \\times 10^{6}$ Pa。该组织的质量密度为 $\\rho = 1000$ kg/m$^{3}$，声速为 $c = 1540$ m/s。仅使用以下基本原理：\n- 瞬时声强是瞬时功率流密度，定义为瞬时声压 $p(t)$ 与瞬时质点速度 $u(t)$ 的乘积。\n- 对于在均匀介质中传播的平面、无损耗纵波，声压和质点速度是同相的，且比声阻抗为 $Z = \\rho c$。\n\n根据这些原理，推导出一个用压力振幅、$\\rho$ 和 $c$ 表示的时间平均强度的表达式，然后根据给定参数进行数值计算。将最终强度以 W/cm$^{2}$ 为单位表示，并将答案四舍五入到四位有效数字。\n\n最后，在与超声成像和安全性相关的能量传输背景下，简要解释该强度的物理意义，但请注意，只有数值强度会被评分。",
            "solution": "我们从瞬时声强作为功率流密度的定义开始：\n$$\nI(t) = p(t)\\,u(t),\n$$\n其中 $p(t)$ 是瞬时声压，$u(t)$ 是瞬时质点速度。时间平均（在一个周期 $T$ 内）强度为\n$$\n\\langle I \\rangle = \\frac{1}{T}\\int_{0}^{T} p(t)\\,u(t)\\,dt.\n$$\n对于均匀介质中的平面、无损耗、纵向谐波，压力和质点速度同相，且比声阻抗为 $Z = \\rho c$。因此，压力和质点速度之间的线性本构关系成立：\n$$\np(t) = Z\\,u(t).\n$$\n设压力为谐波，其峰值（振幅）为 $p_{0}$：\n$$\np(t) = p_{0}\\cos(\\omega t - kx).\n$$\n那么质点速度为\n$$\nu(t) = \\frac{p(t)}{Z} = \\frac{p_{0}}{Z}\\cos(\\omega t - kx).\n$$\n瞬时强度为\n$$\nI(t) = p(t)\\,u(t) = \\frac{p_{0}^{2}}{Z}\\cos^{2}(\\omega t - kx).\n$$\n一个周期内的时间平均使用 $\\langle \\cos^{2}(\\cdot)\\rangle = \\frac{1}{2}$：\n$$\n\\langle I \\rangle = \\frac{p_{0}^{2}}{Z}\\,\\frac{1}{2} = \\frac{p_{0}^{2}}{2Z} = \\frac{p_{0}^{2}}{2\\rho c}.\n$$\n这就是所要求的用压力振幅、质量密度和声速表示的表达式。\n\n现在我们使用 $p_{0} = 1.0 \\times 10^{6}$ Pa，$\\rho = 1000$ kg/m$^{3}$ 和 $c = 1540$ m/s 进行数值计算。首先计算比声阻抗：\n$$\nZ = \\rho c = (1000)\\times(1540) = 1.54\\times 10^{6}\\ \\text{Pa}\\cdot\\text{s}/\\text{m}.\n$$\n然后计算以 W/m$^{2}$ 为单位的时间平均强度：\n$$\n\\langle I \\rangle = \\frac{(1.0\\times 10^{6})^{2}}{2\\times 1.54\\times 10^{6}}\n= \\frac{1.0\\times 10^{12}}{3.08\\times 10^{6}}\n= 3.2467532468\\times 10^{5}\\ \\text{W/m}^{2}.\n$$\n使用 $1\\ \\text{W/cm}^{2} = 10^{4}\\ \\text{W/m}^{2}$ 将其转换为 W/cm$^{2}$：\n$$\n\\langle I \\rangle = \\frac{3.2467532468\\times 10^{5}}{10^{4}} = 32.467532468\\ \\text{W/cm}^{2}.\n$$\n四舍五入到四位有效数字得到\n$$\n\\langle I \\rangle = 32.47\\ \\text{W/cm}^{2}.\n$$\n\n物理意义解释：时间平均强度 $\\langle I \\rangle$ 是对于连续平面波，声能穿过垂直于传播方向的单位面积的平均速率。在超声成像的背景下，较大的局部强度意味着来自组织微结构的潜在反向散射信号振幅更大，这可以通过改变散斑统计和信噪比来影响放射组学衍生的纹理特征。从安全性的角度来看，这个强度代表了连续的能量通量，当它在曝光时间和空间分布上积分时，会对热负荷产生贡献；然而，诊断系统通常使用低占空比的脉冲发射，使得在更长时间间隔上的时间平均值远小于此处计算的平面波连续值。",
            "answer": "$$\\boxed{32.47}$$"
        },
        {
            "introduction": "为何临床上通常无法使用超声波清晰地观察肺部内部的结构？答案在于声波在不同组织界面处的行为。本练习将探讨声波在两种声阻抗差异巨大的介质界面处的反射和透射现象，通过计算软组织与肺部交界处的反射强度，您将定量地理解声阻抗失配在超声成像中造成的“声影”效应，并认识到其对成像可行性的决定性影响。",
            "id": "4918606",
            "problem": "一束角频率为 $\\omega$ 的超声平面波，沿 $+x$ 方向从软组织（介质 $1$）传播进入肺的胸膜表面（介质 $2$）。将两种介质均建模为线性、无损耗、均匀、非色散的流体，软组织的声阻抗为 $Z_1 = 1.54\\ \\mathrm{MRayl}$，肺的声阻抗为 $Z_2 = 0.0004\\ \\mathrm{MRayl}$。假设波在 $x=0$ 处的平面界面上正入射，并处于时谐稳态。使用以下几点作为基本出发点：(i) 总声压和法向质点速度在界面上连续的边界条件，以及 (ii) 平面波的比声阻抗定义 $Z = p/u$（其中 $p$ 为声压，$u$ 为质点速度）和平面波的时间平均强度 $\\langle I \\rangle$ 与 $p_{\\mathrm{rms}}^{2}/Z$ 成正比。从这些基础出发，推导出反射回介质 $1$ 的时间平均入射强度的分数，并将其表示为一个无量纲数。然后，利用给定的 $Z_1$ 和 $Z_2$ 计算该分数值。最后，简要阐述你的结果对于超声成像位于胸膜更深处结构的可行性所具有的物理意义。\n\n将反射强度分数表示为小数，并四舍五入到四位有效数字。最终的数值答案中不要包含任何单位。",
            "solution": "该问题被评估为有效，具有科学依据、提法明确且客观。这是一个声学领域的标准问题，可以从所提供的第一性原理出发解决。\n\n我们需要推导在两种介质界面上反射的时间平均入射强度的分数，然后为软组织-肺界面计算这个分数值。\n\n设 $x<0$ 的区域为介质 $1$（软组织），其声阻抗为 $Z_1$；$x>0$ 的区域为介质 $2$（肺），其声阻抗为 $Z_2$。一束角频率为 $\\omega$ 的平面波正入射到位于 $x=0$ 的平面界面上。\n\n在介质 $1$ 中，总声压 $p_1(x,t)$ 是入射压力波 $p_i(x,t)$ 和反射压力波 $p_r(x,t)$ 之和。在介质 $2$ 中，总声压 $p_2(x,t)$ 就是透射压力波 $p_t(x,t)$。使用复指数表示法来表示时谐波，我们可以写出：\n$$p_i(x,t) = P_i e^{j(\\omega t - k_1 x)}$$\n$$p_r(x,t) = P_r e^{j(\\omega t + k_1 x)}$$\n$$p_t(x,t) = P_t e^{j(\\omega t - k_2 x)}$$\n其中 $P_i$、$P_r$ 和 $P_t$ 分别是入射波、反射波和透射波的复压幅。$k_1$ 和 $k_2$ 分别是介质 $1$ 和介质 $2$ 中的波数。\n\n问题给出了平面波的比声阻抗定义为 $Z = p/u$，其中 $u$ 是质点速度。质点速度方向与波的传播方向一致。对于沿 $+x$ 方向传播的波，$u = p/Z$。对于沿 $-x$ 方向传播的波，$u = -p/Z$。因此，与各压力波相关的质点速度为：\n$$u_i(x,t) = \\frac{p_i(x,t)}{Z_1} = \\frac{P_i}{Z_1} e^{j(\\omega t - k_1 x)}$$\n$$u_r(x,t) = -\\frac{p_r(x,t)}{Z_1} = -\\frac{P_r}{Z_1} e^{j(\\omega t + k_1 x)}$$\n$$u_t(x,t) = \\frac{p_t(x,t)}{Z_2} = \\frac{P_t}{Z_2} e^{j(\\omega t - k_2 x)}$$\n\n每种介质中的总压力和法向质点速度为：\n$$p_1(x,t) = p_i(x,t) + p_r(x,t)$$\n$$u_1(x,t) = u_i(x,t) + u_r(x,t) = \\frac{p_i(x,t)}{Z_1} - \\frac{p_r(x,t)}{Z_1}$$\n$$p_2(x,t) = p_t(x,t)$$\n$$u_2(x,t) = u_t(x,t) = \\frac{p_t(x,t)}{Z_2}$$\n\n我们在界面 $x=0$ 处应用边界条件：\n1.  总声压连续：$p_1(0,t) = p_2(0,t)$。\n    $$p_i(0,t) + p_r(0,t) = p_t(0,t)$$\n    $$P_i e^{j\\omega t} + P_r e^{j\\omega t} = P_t e^{j\\omega t}$$\n    $$P_i + P_r = P_t \\quad (1)$$\n2.  法向质点速度连续：$u_1(0,t) = u_2(0,t)$。\n    $$\\frac{p_i(0,t)}{Z_1} - \\frac{p_r(0,t)}{Z_1} = \\frac{p_t(0,t)}{Z_2}$$\n    $$\\frac{P_i}{Z_1} e^{j\\omega t} - \\frac{P_r}{Z_1} e^{j\\omega t} = \\frac{P_t}{Z_2} e^{j\\omega t}$$\n    $$\\frac{P_i - P_r}{Z_1} = \\frac{P_t}{Z_2} \\quad (2)$$\n\n现在我们求解这两个方程，以得到压力反射系数 $R_p = P_r/P_i$。将方程 $(1)$ 代入方程 $(2)$：\n$$\\frac{P_i - P_r}{Z_1} = \\frac{P_i + P_r}{Z_2}$$\n$$Z_2(P_i - P_r) = Z_1(P_i + P_r)$$\n$$Z_2 P_i - Z_2 P_r = Z_1 P_i + Z_1 P_r$$\n$$P_i(Z_2 - Z_1) = P_r(Z_1 + Z_2)$$\n$$R_p = \\frac{P_r}{P_i} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\n这就是压力反射系数的表达式。\n\n接下来，我们将其与强度联系起来。平面波的时间平均强度 $\\langle I \\rangle$ 由 $\\langle I \\rangle = \\frac{1}{2}\\Re\\{p u^*\\}$ 给出，其中 $u^*$ 是速度的复共轭。对于单个平面波 $p=Pu$，且 $u=p/Z$，该式变为 $\\langle I \\rangle = \\frac{1}{2}\\Re\\{p (p/Z)^*\\} = \\frac{1}{2}\\Re\\{p (p^*/Z^*)\\}$。对于无损耗介质，$Z$ 是实数，因此 $\\langle I \\rangle = \\frac{|p|^2}{2Z} = \\frac{|P|^2}{2Z}$。这等效于给定的比例关系 $\\langle I \\rangle \\propto p_{\\mathrm{rms}}^{2}/Z$，因为 $p_{\\mathrm{rms}} = |P|/\\sqrt{2}$。\n\n入射强度 $\\langle I_i \\rangle$ 和反射强度 $\\langle I_r \\rangle$ 都在介质 $1$ 中传播：\n$$\\langle I_i \\rangle = \\frac{|P_i|^2}{2Z_1}$$\n$$\\langle I_r \\rangle = \\frac{|P_r|^2}{2Z_1}$$\n反射的入射强度分数，即强度反射系数 $R_I$，为：\n$$R_I = \\frac{\\langle I_r \\rangle}{\\langle I_i \\rangle} = \\frac{|P_r|^2/(2Z_1)}{|P_i|^2/(2Z_1)} = \\left| \\frac{P_r}{P_i} \\right|^2 = |R_p|^2$$\n由于给定的阻抗是实数（这是“无损耗”假设的特征），$R_p$ 是实数，因此我们有：\n$$R_I = \\left(\\frac{Z_2 - Z_1}{Z_2 + Z_1}\\right)^2$$\n这就是所求的反射强度分数的通用表达式。\n\n现在，我们用给定的数值计算这个分数：$Z_1 = 1.54\\ \\mathrm{MRayl}$ 和 $Z_2 = 0.0004\\ \\mathrm{MRayl}$。单位将会约掉。\n$$R_I = \\left(\\frac{0.0004 - 1.54}{0.0004 + 1.54}\\right)^2 = \\left(\\frac{-1.5396}{1.5404}\\right)^2$$\n$$R_I \\approx (-0.99948065...)^2 \\approx 0.99896159...$$\n四舍五入到四位有效数字，我们得到：\n$$R_I \\approx 0.9990$$\n\n**物理意义：**\n计算出的强度反射系数 $R_I \\approx 0.9990$ 表明，在软组织-胸膜界面处，大约 $99.9\\%$ 的入射超声强度被反射。因此，透射强度的分数 $T_I = 1 - R_I$ 仅为约 $0.1\\%$。软组织与充满空气的肺之间的声阻抗存在巨大失配，这形成了一个近乎完美的声学反射镜。这种近乎全反射意味着只有微不足道的超声能量能够穿透肺部。因此，要获得肺内或肺深处任何解剖结构的清晰超声图像是不可行的，因为来自这些结构的回波会非常微弱，以至于无法探测。肺有效地投下了一个强烈的“声影”，遮蔽了其后方的一切，使超声换能器无法观察到。这是胸部超声检查的一个基本限制。",
            "answer": "$$\\boxed{0.9990}$$"
        },
        {
            "introduction": "我们已经学习了描述声波在软组织中传播的物理参数，如声速 $c$ 和衰减系数 $\\beta$。然而，在实际应用中，我们如何精确地测量这些参数呢？本练习将让您扮演一位医学物理师的角色，通过设计并实现一个参数估计算法，从模拟的实验数据中反演出组织的声学特性。这项实践将理论模型与数据分析相结合，揭示了如何从可测量的波形中提取有价值的诊断信息，这是定量超声成像技术的核心。",
            "id": "4911384",
            "problem": "您的任务是为软组织中的声波传播设计并实现一个参数估计与反演算法，该算法可用于医学成像的基础研究。该物理模型假设在一维、弱吸收、均匀的软组织介质中存在平面波。在此模型中，传播一段距离的时谐压力场会因吸收而发生幅度衰减，且声波的传播时间由有限的声速决定。\n\n使用以下基础理论：\n- 在弱吸收介质的线性声学中，一个频率为 $f$ 的平面波在传播距离 $x$ 后，其幅度衰减模型为 $\\exp(-\\alpha(f)\\,x)$，其中 $\\alpha(f)$ 是吸收系数。\n- 在软组织中，一个广泛使用的近似是，在诊断频带内吸收与频率近似成线性关系，即 $\\alpha(f) \\approx \\beta\\,f$。其中，$f$ 的单位是兆赫（MHz），$\\beta$ 是一个常数，单位是奈培/米/兆赫。\n- 声波以声速 $c$ 传播距离 $D$ 所需的传播时间 $t$ 为 $t = D/c$。\n- 在透射单程几何结构中，传播距离为 $D = L$，其中 $L$ 是已知路径长度。在垂直入射的脉冲回波几何结构中，由于是往返行程，传播距离为 $D = 2L$。\n\n您的任务：\n1. 仅从上述基础理论出发，推导一种计算上稳健的方法，用于根据已知的传播距离 $L$、测量的传播时间 $t$ 以及在一系列对应频率 $\\{f_i\\}$（$f_i$ 单位为兆赫）下测得的接收频谱幅度 $\\{S_i\\}$，来估计声速 $c$ 和吸收比例常数 $\\beta$。未知的发射-接收缩放因子 $K$ 未被测量，必须作为未知干扰参数处理。您的推导应产生一个能够用有限精度算法实现并且对合理数据是稳定的算法。\n2. 将此方法实现为一个程序。对于每个测试用例，该程序返回两个估计参数：以米/秒为单位的声速 $c$ 和以奈培/米/兆赫为单位的吸收常数 $\\beta$。$c$ 的单位表示为 $\\mathrm{m/s}$，$\\beta$ 的单位表示为 $\\mathrm{Np/(m\\,MHz)}$。将 $c$ 四舍五入到3位小数，$\\beta$ 四舍五入到6位小数。\n\n几何结构约定：\n- 对于透射单程场景，在您的传播时间关系和幅度模型的吸收路径长度中均使用 $D = L$。\n- 对于脉冲回波场景，在您的传播时间关系和幅度模型的吸收路径长度中均使用 $D = 2L$。\n\n数值输入和单位：\n- 距离 $L$ 的单位是米。\n- 时间 $t$ 的单位是秒。\n- 频率 $f_i$ 的单位是兆赫。\n- 频谱幅度 $S_i$ 是无量纲的。\n- 报告 $c$ 的单位为 $\\mathrm{m/s}$，$\\beta$ 的单位为 $\\mathrm{Np/(m\\,MHz)}$。\n\n测试套件：\n提供一个单行输出，将所有测试用例的结果汇总到一个列表中。对于每个测试用例，输出经过上述四舍五入处理的数对 $[c,\\beta]$。使用以下三个测试用例：\n\n- 测试用例 1 (透射单程，低衰减，近乎无噪声):\n  - 几何结构：透射单程\n  - $L = 0.03$ 米\n  - $t = 0.00001948051948$ 秒\n  - 频率 (兆赫): $[1.0, 2.0, 3.0]$\n  - 测量的频谱幅度: $[1.198201, 1.196405, 1.194612]$\n\n- 测试用例 2 (透射单程，较高衰减伴有轻度噪声):\n  - 几何结构：透射单程\n  - $L = 0.05$ 米\n  - $t = 0.00003333333333$ 秒\n  - 频率 (兆赫): $[0.5, 1.0, 2.0, 3.0]$\n  - 测量的频谱幅度: $[1.503482, 1.41944, 1.412575, 1.309963]$\n\n- 测试用例 3 (脉冲回波，往返传播，无噪声):\n  - 几何结构：脉冲回波\n  - $L = 0.04$ 米\n  - $t = 0.000050632911$ 秒\n  - 频率 (兆赫): $[1.0, 2.5]$\n  - 测量的频谱幅度: $[2.047, 1.8376]$\n\n您的程序应生成单行输出，其中包含一个包含3个项目的逗号分隔列表。每个项目都是对应测试用例的数对 $[c,\\beta]$，其四舍五入和单位已在问题陈述中隐含说明。确切的格式必须是单行：\n[[c1,beta1],[c2,beta2],[c3,beta3]]",
            "solution": "问题陈述经评估是有效的。它以线性声学原理为科学基础，对于参数估计是适定的，并以客观、明确的语言表述。唯一解所需的所有必要数据和条件均已提供。\n\n任务是从一组测量数据中估计软组织介质的两个物理参数——声速 $c$ 和吸收比例常数 $\\beta$。这两个参数的估计可以解耦，并作为独立的问题来处理。\n\n### 第一部分：声速（$c$）的估计\n\n声速 $c$ 由距离、速度和时间之间的基本关系确定。\n\n**原理：** 声波以恒定速度 $c$ 传播距离 $D$ 所需的传播时间 $t$ 由下式给出：\n$$t = \\frac{D}{c}$$\n此公式可重新整理以直接求解声速：\n$$c = \\frac{D}{t}$$\n**算法：**\n传播距离 $D$ 取决于已知的路径长度 $L$ 和测量几何结构。问题指定了两种几何结构：\n1.  对于`透射单程`几何结构，声波传播单程路径，长度为 $L$。因此，总传播距离为 $D = L$。\n2.  对于`脉冲回波`几何结构，声波从换能器传播到反射体再返回，两次覆盖路径长度 $L$。因此，总传播距离为 $D = 2L$。\n\n给定测量的传播时间 $t$、已知的路径长度 $L$ 和几何结构，首先确定 $D$，然后应用公式 $c = D/t$ 计算声速 $c$。单位必须保持一致；当 $D$ 的单位为米（$\\mathrm{m}$），$t$ 的单位为秒（$\\mathrm{s}$）时，$c$ 的单位将是米/秒（$\\mathrm{m/s}$）。\n\n### 第二部分：吸收常数（$\\beta$）的估计\n\n吸收常数 $\\beta$ 是通过分析声波幅度的频率相关衰减来确定的。\n\n**原理：** 在给定频率 $f_i$ 下，接收到的频谱幅度 $S_i$ 的模型是基于声波在传播距离 $D$ 上因吸收而发生的指数衰减。该模型如下：\n$$S_i = K \\exp(-\\alpha(f_i) D)$$\n此处，$K$ 是一个未知的、与频率无关的缩放因子，它涵盖了发射信号强度和系统灵敏度。$\\alpha(f_i)$ 是频率 $f_i$ 处的吸收系数。对于软组织，该系数近似为与频率成线性关系：\n$$\\alpha(f_i) \\approx \\beta f_i$$\n其中 $f_i$ 的单位是兆赫（$\\mathrm{MHz}$），$\\beta$ 是比例常数，单位是奈培/米/兆赫（$\\mathrm{Np/(m \\cdot MHz)}$）。\n\n**算法推导：**\n为了从频率 $\\{f_i\\}$ 下的测量值 $\\{S_i\\}$ 估计 $\\beta$，同时将 $K$ 视为未知干扰参数，我们必须将模型线性化。这可以通过对方程两边取自然对数来实现：\n$$\\ln(S_i) = \\ln(K \\exp(-\\beta f_i D))$$\n利用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(e^x) = x$，我们得到：\n$$\\ln(S_i) = \\ln(K) + (-\\beta f_i D)$$\n$$\\ln(S_i) = \\ln(K) - (\\beta D) f_i$$\n该方程是标准线性方程 $y = b + mx$ 的形式，其中：\n-   因变量为 $y_i = \\ln(S_i)$。\n-   自变量为 $x_i = f_i$。\n-   y轴截距为 $b = \\ln(K)$。\n-   斜率为 $m = -\\beta D$。\n\n我们得到了一组测量对 $(f_i, S_i)$。通过将它们转换为新坐标 $(x_i, y_i) = (f_i, \\ln(S_i))$，我们可以应用线性最小二乘回归来找到最拟合转换后数据的斜率 $m$。这种标准的统计方法可以找到一条直线，使观测到的 $y_i$ 值与线性模型预测值之间的平方差之和最小化。该方法的关键优势在于，未知常数 $K$ 被隔离在截距项 $b$ 中，而计算斜率 $m$ 并不需要计算截距项。\n\n一旦从回归中估计出斜率 $m$，我们就可以求解 $\\beta$：\n$$m = -\\beta D$$\n$$\\beta = -\\frac{m}{D}$$\n传播距离 $D$ 与用于计算声速的距离相同。该方法在计算上是稳健和稳定的，尤其是在使用标准数值库实现时。\n\n### 完整算法摘要\n\n对于每个测试用例：\n1.  识别几何结构（`透射单程`或`脉冲回波`）、路径长度 $L$、传播时间 $t$、以及频率集合 $\\{f_i\\}$ 和频谱幅度集合 $\\{S_i\\}$。\n2.  计算总传播距离 $D$：对于透射，$D=L$；对于脉冲回波，$D=2L$。\n3.  计算声速：$c = D / t$。\n4.  准备用于吸收估计的数据：创建一组点 $(x_i, y_i)$，其中 $x_i = f_i$ 和 $y_i = \\ln(S_i)$。\n5.  对 $(x_i, y_i)$ 数据执行简单线性回归以估计斜率 $m$。\n6.  计算吸收常数：$\\beta = -m/D$。\n7.  按照要求将计算出的 $c$ 四舍五入到3位小数，$\\beta$ 四舍五入到6位小数。\n8.  存储结果数对 $[c, \\beta]$。\n\n将此过程系统地应用于所有测试用例以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an algorithm to estimate the speed of sound (c)\n    and absorption constant (beta) for acoustic wave propagation in soft tissue.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test case 1\",\n            \"geometry\": \"transmission one-way\",\n            \"L\": 0.03,  # meters\n            \"t\": 0.00001948051948,  # seconds\n            \"frequencies\": np.array([1.0, 2.0, 3.0]),  # MHz\n            \"magnitudes\": np.array([1.198201, 1.196405, 1.194612])  # dimensionless\n        },\n        {\n            \"name\": \"Test case 2\",\n            \"geometry\": \"transmission one-way\",\n            \"L\": 0.05,  # meters\n            \"t\": 0.00003333333333,  # seconds\n            \"frequencies\": np.array([0.5, 1.0, 2.0, 3.0]),  # MHz\n            \"magnitudes\": np.array([1.503482, 1.41944, 1.412575, 1.309963])  # dimensionless\n        },\n        {\n            \"name\": \"Test case 3\",\n            \"geometry\": \"pulse-echo\",\n            \"L\": 0.04,  # meters\n            \"t\": 0.000050632911,  # seconds\n            \"frequencies\": np.array([1.0, 2.5]),  # MHz\n            \"magnitudes\": np.array([2.047, 1.8376])  # dimensionless\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract variables for clarity\n        L = case[\"L\"]\n        t = case[\"t\"]\n        geometry = case[\"geometry\"]\n        freqs = case[\"frequencies\"]\n        mags = case[\"magnitudes\"]\n\n        # Step 1: Determine the total propagation distance D\n        if geometry == \"transmission one-way\":\n            D = L\n        elif geometry == \"pulse-echo\":\n            D = 2 * L\n        else:\n            # This case should not occur with the given problem statement\n            raise ValueError(f\"Unknown geometry: {geometry}\")\n\n        # Step 2: Estimate speed of sound c\n        # c = D / t\n        c = D / t\n\n        # Step 3: Estimate absorption constant beta\n        # The model is S = K * exp(-beta * f * D).\n        # Linearize by taking the natural log: ln(S) = ln(K) - (beta * D) * f.\n        # This is a linear equation y = intercept + slope * x, where:\n        # y = ln(S)\n        # x = f\n        # slope = -beta * D\n        # intercept = ln(K)\n        \n        # Prepare data for linear regression\n        x_data = freqs\n        y_data = np.log(mags)\n        \n        # Perform linear regression to find the slope.\n        # np.polyfit(x, y, 1) returns [slope, intercept] for a 1st degree polynomial.\n        slope, intercept = np.polyfit(x_data, y_data, 1)\n        \n        # Calculate beta from the slope: beta = -slope / D\n        beta = -slope / D\n\n        # Step 4: Round the results to the specified precision\n        c_rounded = round(c, 3)\n        beta_rounded = round(beta, 6)\n        \n        results.append([c_rounded, beta_rounded])\n    \n    # Generate the final output string in the specified format without using any external JSON library.\n    # We construct the string manually to ensure exact format compliance.\n    output_parts = []\n    for c_val, beta_val in results:\n        # Use f-string formatting to handle potential trailing zeros correctly\n        c_str = f\"{c_val:.3f}\"\n        beta_str = f\"{beta_val:.6f}\"\n        output_parts.append(f\"[{c_str},{beta_str}]\")\n        \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\n# Since the environment executes the script directly, we call the function.\nsolve()\n```"
        }
    ]
}