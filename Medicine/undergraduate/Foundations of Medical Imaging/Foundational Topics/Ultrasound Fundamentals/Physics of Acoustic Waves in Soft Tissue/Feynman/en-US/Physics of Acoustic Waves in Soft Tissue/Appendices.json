{
    "hands_on_practices": [
        {
            "introduction": "An ultrasound transducer generates pressure waves, but the energy these waves transport is what ultimately creates an image and has the potential for biological effects. This first practice connects the fundamental concept of acoustic pressure to acoustic intensity, which is the measure of power flow. By deriving this relationship from first principles, you will gain a quantitative understanding of the energy carried by an ultrasound beam .",
            "id": "4568803",
            "problem": "An Ultrasound (US) transducer operating in the continuous-wave regime produces a monochromatic plane longitudinal wave that propagates through homogeneous, lossless soft tissue. At a point in the field where the beam can be approximated as planar, the measured peak (amplitude) acoustic pressure is $1.0 \\times 10^{6}$ Pa. The tissue has mass density $\\rho = 1000 \\text{ kg/m}^3$ and speed of sound $c = 1540$ m/s. Using only the following base principles:\n- The instantaneous acoustic intensity is the instantaneous power flux density, defined as the product of the instantaneous acoustic pressure $p(t)$ and the instantaneous particle velocity $u(t)$.\n- For a plane, lossless, longitudinal wave in a homogeneous medium, the acoustic pressure and particle velocity are in phase, and the specific acoustic impedance is $Z = \\rho c$.\n\nDerive, from these principles, an expression for the time-averaged intensity in terms of the pressure amplitude, $\\rho$, and $c$, and then evaluate it numerically for the given parameters. Express the final intensity in $\\text{W/cm}^2$ and round your answer to four significant figures.\n\nFinally, briefly interpret the physical meaning of this intensity in the context of energy transport relevant to ultrasound image formation and safety, but note that only the numerical intensity will be graded.",
            "solution": "We begin from the definition of instantaneous acoustic intensity as the power flux density:\n$$\nI(t) = p(t)\\,u(t),\n$$\nwhere $p(t)$ is the instantaneous acoustic pressure and $u(t)$ is the instantaneous particle velocity. The time-averaged (over one period $T$) intensity is\n$$\n\\langle I \\rangle = \\frac{1}{T}\\int_{0}^{T} p(t)\\,u(t)\\,dt.\n$$\nFor a plane, lossless, longitudinal harmonic wave in a homogeneous medium, pressure and particle velocity are in phase, and the specific acoustic impedance is $Z = \\rho c$. Therefore, the linear constitutive relation between pressure and particle velocity holds:\n$$\np(t) = Z\\,u(t).\n$$\nLet the pressure be harmonic with peak (amplitude) value $p_{0}$:\n$$\np(t) = p_{0}\\cos(\\omega t - kx).\n$$\nThen the particle velocity is\n$$\nu(t) = \\frac{p(t)}{Z} = \\frac{p_{0}}{Z}\\cos(\\omega t - kx).\n$$\nThe instantaneous intensity is\n$$\nI(t) = p(t)\\,u(t) = \\frac{p_{0}^{2}}{Z}\\cos^{2}(\\omega t - kx).\n$$\nThe time average over one period uses $\\langle \\cos^{2}(\\cdot)\\rangle = \\frac{1}{2}$:\n$$\n\\langle I \\rangle = \\frac{p_{0}^{2}}{Z}\\,\\frac{1}{2} = \\frac{p_{0}^{2}}{2Z} = \\frac{p_{0}^{2}}{2\\rho c}.\n$$\nThis is the required expression in terms of the pressure amplitude, mass density, and speed of sound.\n\nNow we evaluate numerically using $p_{0} = 1.0 \\times 10^{6}$ Pa, $\\rho = 1000$ kg/m$^{3}$, and $c = 1540$ m/s. First compute the specific acoustic impedance:\n$$\nZ = \\rho c = (1000)\\times(1540) = 1.54\\times 10^{6}\\ \\text{Pa}\\cdot\\text{s}/\\text{m}.\n$$\nThen compute the time-averaged intensity in W/m$^{2}$:\n$$\n\\langle I \\rangle = \\frac{(1.0\\times 10^{6})^{2}}{2\\times 1.54\\times 10^{6}}\n= \\frac{1.0\\times 10^{12}}{3.08\\times 10^{6}}\n= 3.2467532468\\times 10^{5}\\ \\text{W/m}^{2}.\n$$\nConvert to W/cm$^{2}$ using $1\\ \\text{W/cm}^{2} = 10^{4}\\ \\text{W/m}^{2}$:\n$$\n\\langle I \\rangle = \\frac{3.2467532468\\times 10^{5}}{10^{4}} = 32.467532468\\ \\text{W/cm}^{2}.\n$$\nRounding to four significant figures gives\n$$\n\\langle I \\rangle = 32.47\\ \\text{W/cm}^{2}.\n$$\n\nPhysical interpretation: The time-averaged intensity $\\langle I \\rangle$ is the average rate at which acoustic energy is transported across a unit area perpendicular to the propagation direction for the continuous plane wave. In the context of ultrasound image formation, larger local intensity implies greater potential backscattered signal amplitude from tissue microstructure, which can influence radiomics-derived texture features through changes in speckle statistics and signal-to-noise ratio. From a safety perspective, this intensity represents the continuous energy flux that, when integrated over exposure time and spatial distribution, contributes to thermal loading; however, diagnostic systems typically use pulsed emission with low duty cycle, making the temporal-average over longer intervals substantially smaller than the plane-wave continuous value computed here.",
            "answer": "$$\\boxed{32.47}$$"
        },
        {
            "introduction": "Ultrasound imaging relies on detecting echoes that are reflected from interfaces between different tissues. This exercise reveals the physical principle behind these reflections: the mismatch in acoustic impedance. You will derive the formula for the reflection coefficient and apply it to the clinically important interface between soft tissue and lung, providing a clear, quantitative reason why imaging through air-filled structures is so challenging .",
            "id": "4918606",
            "problem": "An ultrasound plane wave of angular frequency $\\omega$ propagates in the $+x$ direction from soft tissue (medium $1$) into the pleural surface of a lung (medium $2$). Model both media as linear, lossless, homogeneous, and non-dispersive fluids, with acoustic impedances $Z_1 = 1.54\\ \\mathrm{MRayl}$ for soft tissue and $Z_2 = 0.0004\\ \\mathrm{MRayl}$ for lung. Assume normal incidence, planar interface at $x=0$, and time-harmonic steady state. Use the following as the fundamental starting points: (i) the boundary conditions that the total acoustic pressure and the normal particle velocity are continuous across the interface, and (ii) the definition of specific acoustic impedance $Z = p/u$ for plane waves, where $p$ is acoustic pressure and $u$ is particle velocity, and the time-averaged intensity $\\langle I \\rangle$ for a plane wave is proportional to $p_{\\mathrm{rms}}^{2}/Z$. Derive from these bases the fraction of incident time-averaged intensity that is reflected back into medium $1$, expressed as a dimensionless number. Then evaluate this fraction for the given $Z_1$ and $Z_2$. Finally, briefly articulate the physical implication of your result for the feasibility of ultrasound imaging of structures lying deeper than the pleura.\n\nExpress the reflected intensity fraction as a decimal number rounded to four significant figures. Do not include any units in your final numerical answer.",
            "solution": "We are asked to derive the fraction of incident time-averaged intensity that is reflected at an interface between two media, and then to calculate this fraction for a soft tissue-lung interface.\n\nLet medium $1$ be soft tissue for $x<0$ with acoustic impedance $Z_1$, and medium $2$ be lung for $x>0$ with acoustic impedance $Z_2$. A plane wave with angular frequency $\\omega$ is incident normally on the planar interface at $x=0$.\n\nIn medium $1$, the total acoustic pressure $p_1(x,t)$ is the sum of the incident pressure wave $p_i(x,t)$ and the reflected pressure wave $p_r(x,t)$. The total acoustic pressure in medium $2$, $p_2(x,t)$, is just the transmitted pressure wave $p_t(x,t)$. Using complex exponential notation for time-harmonic waves, we can write:\n$$p_i(x,t) = P_i e^{j(\\omega t - k_1 x)}$$\n$$p_r(x,t) = P_r e^{j(\\omega t + k_1 x)}$$\n$$p_t(x,t) = P_t e^{j(\\omega t - k_2 x)}$$\nwhere $P_i$, $P_r$, and $P_t$ are the complex pressure amplitudes of the incident, reflected, and transmitted waves, respectively. $k_1$ and $k_2$ are the wavenumbers in medium $1$ and $2$.\n\nThe problem provides the definition of specific acoustic impedance for a plane wave as $Z = p/u$, where $u$ is the particle velocity. The particle velocity is in the direction of wave propagation. For a wave propagating in the $+x$ direction, $u = p/Z$. For a wave propagating in the $-x$ direction, $u = -p/Z$. Therefore, the particle velocities associated with each pressure wave are:\n$$u_i(x,t) = \\frac{p_i(x,t)}{Z_1} = \\frac{P_i}{Z_1} e^{j(\\omega t - k_1 x)}$$\n$$u_r(x,t) = -\\frac{p_r(x,t)}{Z_1} = -\\frac{P_r}{Z_1} e^{j(\\omega t + k_1 x)}$$\n$$u_t(x,t) = \\frac{p_t(x,t)}{Z_2} = \\frac{P_t}{Z_2} e^{j(\\omega t - k_2 x)}$$\n\nThe total pressure and normal particle velocity in each medium are:\n$$p_1(x,t) = p_i(x,t) + p_r(x,t)$$\n$$u_1(x,t) = u_i(x,t) + u_r(x,t) = \\frac{p_i(x,t)}{Z_1} - \\frac{p_r(x,t)}{Z_1}$$\n$$p_2(x,t) = p_t(x,t)$$\n$$u_2(x,t) = u_t(x,t) = \\frac{p_t(x,t)}{Z_2}$$\n\nWe apply the boundary conditions at the interface $x=0$:\n1.  Continuity of total acoustic pressure: $p_1(0,t) = p_2(0,t)$.\n    $$p_i(0,t) + p_r(0,t) = p_t(0,t)$$\n    $$P_i e^{j\\omega t} + P_r e^{j\\omega t} = P_t e^{j\\omega t}$$\n    $$P_i + P_r = P_t \\quad (1)$$\n2.  Continuity of normal particle velocity: $u_1(0,t) = u_2(0,t)$.\n    $$\\frac{p_i(0,t)}{Z_1} - \\frac{p_r(0,t)}{Z_1} = \\frac{p_t(0,t)}{Z_2}$$\n    $$\\frac{P_i}{Z_1} e^{j\\omega t} - \\frac{P_r}{Z_1} e^{j\\omega t} = \\frac{P_t}{Z_2} e^{j\\omega t}$$\n    $$\\frac{P_i - P_r}{Z_1} = \\frac{P_t}{Z_2} \\quad (2)$$\n\nWe now solve these two equations for the pressure reflection coefficient, $R_p = P_r/P_i$. Substitute equation $(1)$ into equation $(2)$:\n$$\\frac{P_i - P_r}{Z_1} = \\frac{P_i + P_r}{Z_2}$$\n$$Z_2(P_i - P_r) = Z_1(P_i + P_r)$$\n$$Z_2 P_i - Z_2 P_r = Z_1 P_i + Z_1 P_r$$\n$$P_i(Z_2 - Z_1) = P_r(Z_1 + Z_2)$$\n$$R_p = \\frac{P_r}{P_i} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\nThis is the expression for the pressure reflection coefficient.\n\nNext, we relate this to the intensity. The time-averaged intensity $\\langle I \\rangle$ of a plane wave is given by $\\langle I \\rangle = \\frac{1}{2}\\Re\\{p u^*\\}$, where $u^*$ is the complex conjugate of the velocity. For a single plane wave $p=Pu$, with $u=p/Z$, this becomes $\\langle I \\rangle = \\frac{1}{2}\\Re\\{p (p/Z)^*\\} = \\frac{1}{2}\\Re\\{p (p^*/Z^*)\\}$. For lossless media, $Z$ is real, so $\\langle I \\rangle = \\frac{|p|^2}{2Z} = \\frac{|P|^2}{2Z}$. This is equivalent to the given proportionality $\\langle I \\rangle \\propto p_{\\mathrm{rms}}^{2}/Z$, as $p_{\\mathrm{rms}} = |P|/\\sqrt{2}$.\n\nThe incident intensity $\\langle I_i \\rangle$ and reflected intensity $\\langle I_r \\rangle$ both propagate in medium $1$:\n$$\\langle I_i \\rangle = \\frac{|P_i|^2}{2Z_1}$$\n$$\\langle I_r \\rangle = \\frac{|P_r|^2}{2Z_1}$$\nThe fraction of incident intensity that is reflected, known as the intensity reflection coefficient $R_I$, is:\n$$R_I = \\frac{\\langle I_r \\rangle}{\\langle I_i \\rangle} = \\frac{|P_r|^2/(2Z_1)}{|P_i|^2/(2Z_1)} = \\left| \\frac{P_r}{P_i} \\right|^2 = |R_p|^2$$\nSince the given impedances are real numbers (characteristic of the \"lossless\" assumption), $R_p$ is real, and we have:\n$$R_I = \\left(\\frac{Z_2 - Z_1}{Z_2 + Z_1}\\right)^2$$\nThis is the desired general expression for the reflected intensity fraction.\n\nNow, we evaluate this fraction for the given values: $Z_1 = 1.54\\ \\mathrm{MRayl}$ and $Z_2 = 0.0004\\ \\mathrm{MRayl}$. The units will cancel.\n$$R_I = \\left(\\frac{0.0004 - 1.54}{0.0004 + 1.54}\\right)^2 = \\left(\\frac{-1.5396}{1.5404}\\right)^2$$\n$$R_I \\approx (-0.99948065...)^2 \\approx 0.99896159...$$\nRounding to four significant figures, we get:\n$$R_I \\approx 0.9990$$\n\n**Physical Implication:**\nThe calculated intensity reflection coefficient of $R_I \\approx 0.9990$ indicates that approximately $99.9\\%$ of the incident ultrasound intensity is reflected at the soft tissue-pleura interface. Consequently, the fraction of transmitted intensity, $T_I = 1 - R_I$, is only about $0.1\\%$. The drastic mismatch in acoustic impedance between soft tissue and the air-filled lung creates an almost perfect acoustic mirror. This near-total reflection means that an insignificant amount of ultrasound energy penetrates the lung. As a result, it is not feasible to obtain a clear ultrasound image of any anatomical structures lying within or deep to the lung, as the returning echoes from these structures would be far too weak to detect. The lung effectively casts a strong \"acoustic shadow,\" obscuring everything behind it from the view of the ultrasound transducer. This is a fundamental limitation of thoracic ultrasonography.",
            "answer": "$$\\boxed{0.9990}$$"
        },
        {
            "introduction": "Beyond creating qualitative images, a central goal of advanced ultrasound is to quantitatively characterize tissue. This final practice places you in the role of a medical physicist, tasked with solving an inverse problem. Using simulated experimental data on wave travel time and frequency-dependent amplitude decay, you will develop and implement an algorithm to estimate two of the most fundamental acoustic properties of tissue: its speed of sound $c$ and its attenuation proportionality constant $a$ .",
            "id": "4911384",
            "problem": "You are tasked with designing and implementing a parameter estimation and inversion algorithm for acoustic wave propagation in soft tissue, as used in the foundations of medical imaging. The physical model assumes a one-dimensional plane wave in a weakly absorbing, homogeneous soft tissue medium. Within this model, a time-harmonic pressure field that propagates a distance decays in amplitude due to absorption, and the wave experiences a finite travel time set by the finite speed of sound.\n\nUse the following foundational base:\n- In linear acoustics for a weakly absorbing medium, the amplitude of a plane wave propagating a distance $x$ at frequency $f$ is modeled to decay as $\\exp(-\\alpha(f)\\,x)$, where $\\alpha(f)$ is the absorption coefficient.\n- In soft tissue, a widely used approximation is that the absorption is approximately linear in frequency over diagnostic bands, so $\\alpha(f) \\approx a f$, where $f$ is in megahertz and $a$ is a constant with units of nepers per meter per megahertz.\n- The travel time $t$ for a wave to traverse a distance $D$ at speed of sound $c$ is $t = D/c$.\n- In a transmission one-way geometry, the propagation distance is $D = L$, where $L$ is the known path length. In a normal-incidence pulse-echo geometry, the propagation distance is $D = 2L$ due to the round trip.\n\nYour task:\n1. Starting only from the base above, derive a computationally robust method to estimate the speed of sound $c$ and the absorption proportionality constant $a$ from measurements of a known propagation distance $L$, a measured travel time $t$, and a set of measured received spectral magnitudes $\\{S_i\\}$ at corresponding frequencies $\\{f_i\\}$ (with $f_i$ in megahertz). The unknown transmit-receive scaling $K$ is not measured and must be treated as an unknown nuisance parameter. Your derivation should produce an algorithm that is implementable with finite-precision arithmetic and is stable for reasonable data.\n2. Implement this method as a program that, for each test case, returns two estimated parameters: the speed of sound $c$ in meters per second and the absorption constant $a$ in nepers per meter per megahertz. Express $c$ in $\\mathrm{m/s}$ and $a$ in $\\mathrm{Np/(m\\,MHz)}$. Round $c$ to $3$ decimal places and $a$ to $6$ decimal places.\n\nGeometry conventions:\n- For a transmission one-way scenario, use $D = L$ for both the travel-time relation and the absorption path length in your amplitude model.\n- For a pulse-echo scenario, use $D = 2L$ for both the travel-time relation and the absorption path length in your amplitude model.\n\nNumerical inputs and units:\n- Distances $L$ are in meters.\n- Times $t$ are in seconds.\n- Frequencies $f_i$ are in megahertz.\n- Spectral magnitudes $S_i$ are dimensionless.\n- Report $c$ in $\\mathrm{m/s}$ and $a$ in $\\mathrm{Np/(m\\,MHz)}$.\n\nTest suite:\nProvide a single-line output aggregating all test case results in a single list. For each test case, output the pair $[c,a]$ with the above rounding. Use the following three test cases:\n\n- Test case $1$ (transmission one-way, low attenuation, nearly noiseless):\n  - Geometry: transmission one-way\n  - $L = 0.03$ meters\n  - $t = 0.00001948051948$ seconds\n  - Frequencies (megahertz): $[1.0, 2.0, 3.0]$\n  - Measured spectral magnitudes: $[1.198201, 1.196405, 1.194612]$\n\n- Test case $2$ (transmission one-way, higher attenuation with mild noise):\n  - Geometry: transmission one-way\n  - $L = 0.05$ meters\n  - $t = 0.00003333333333$ seconds\n  - Frequencies (megahertz): $[0.5, 1.0, 2.0, 3.0]$\n  - Measured spectral magnitudes: $[1.503482, 1.41944, 1.412575, 1.309963]$\n\n- Test case $3$ (pulse-echo, round-trip propagation, noiseless):\n  - Geometry: pulse-echo\n  - $L = 0.04$ meters\n  - $t = 0.000050632911$ seconds\n  - Frequencies (megahertz): $[1.0, 2.5]$\n  - Measured spectral magnitudes: $[2.047, 1.8376]$\n\nYour program should produce a single line of output containing the results as a comma-separated list of $3$ items, where each item is the pair $[c,a]$ for the corresponding test case, with the specified rounding and units implicitly understood from the problem statement. The exact format must be a single line:\n[[c1,a1],[c2,a2],[c3,a3]]",
            "solution": "The task is to estimate two physical parameters of a soft tissue medium—the speed of sound $c$ and the absorption proportionality constant $a$—from a set of measurements. The estimation of these two parameters can be decoupled and treated as separate problems.\n\n### Part 1: Estimation of Speed of Sound ($c$)\n\nThe speed of sound $c$ is determined from the fundamental relationship between distance, speed, and time.\n\n**Principle:** The travel time $t$ for an acoustic wave to propagate a distance $D$ at a constant speed $c$ is given by:\n$$t = \\frac{D}{c}$$\nThis can be rearranged to solve directly for the speed of sound:\n$$c = \\frac{D}{t}$$\n**Algorithm:**\nThe propagation distance $D$ depends on the known path length $L$ and the measurement geometry. The problem specifies two geometries:\n1.  For a `transmission one-way` geometry, the wave travels a single path of length $L$. Thus, the total propagation distance is $D = L$.\n2.  For a `pulse-echo` geometry, the wave travels from the transducer to a reflector and back, covering the path length $L$ twice. Thus, the total propagation distance is $D = 2L$.\n\nGiven the measured travel time $t$ and the known path length $L$ and geometry, the speed of sound $c$ is calculated by first determining $D$ and then applying the formula $c = D/t$. The units must be consistent; with $D$ in meters ($\\mathrm{m}$) and $t$ in seconds ($\\mathrm{s}$), $c$ will be in meters per second ($\\mathrm{m/s}$).\n\n### Part 2: Estimation of Absorption Constant ($a$)\n\nThe absorption constant $a$ is determined by analyzing the frequency-dependent decay of the wave's amplitude.\n\n**Principle:** The model for the received spectral magnitude $S_i$ at a given frequency $f_i$ is based on exponential decay due to absorption over the propagation distance $D$. The model is given as:\n$$S_i = K \\exp(-\\alpha(f_i) D)$$\nHere, $K$ is an unknown, frequency-independent scaling factor that accounts for the transmitted signal strength and system sensitivity. $\\alpha(f_i)$ is the absorption coefficient at frequency $f_i$. For soft tissue, this coefficient is approximated as being linear in frequency:\n$$\\alpha(f_i) \\approx a f_i$$\nwhere $f_i$ is in megahertz ($\\mathrm{MHz}$) and $a$ is the proportionality constant in nepers per meter per megahertz ($\\mathrm{Np/(m \\cdot MHz)}$).\n\nSubstituting the approximation for $\\alpha(f_i)$ into the amplitude model yields:\n$$S_i = K \\exp(-a f_i D)$$\n**Algorithm Derivation:**\nTo estimate $a$ from measurements $\\{S_i\\}$ at frequencies $\\{f_i\\}$, while treating $K$ as an unknown nuisance parameter, we must linearize the model. This is achieved by taking the natural logarithm of both sides of the equation:\n$$\\ln(S_i) = \\ln(K \\exp(-a f_i D))$$\nUsing the properties of logarithms, $\\ln(xy) = \\ln(x) + \\ln(y)$ and $\\ln(e^z) = z$, we get:\n$$\\ln(S_i) = \\ln(K) + (-a f_i D)$$\n$$\\ln(S_i) = \\ln(K) - (a D) f_i$$\nThis equation is in the standard form of a linear equation, $y = b + mx$, where:\n-   The dependent variable is $y_i = \\ln(S_i)$.\n-   The independent variable is $x_i = f_i$.\n-   The y-intercept is $b = \\ln(K)$.\n-   The slope is $m = -a D$.\n\nWe are provided with a set of measurement pairs $(f_i, S_i)$. By transforming these to the new coordinates $(x_i, y_i) = (f_i, \\ln(S_i))$, we can apply linear least-squares regression to find the slope $m$ that best fits the transformed data. This standard statistical method finds the line that minimizes the sum of the squared differences between the observed $y_i$ values and the values predicted by the linear model. The key advantage of this method is that the unknown constant $K$ is isolated in the intercept term $b$, which does not need to be calculated to find the slope $m$.\n\nOnce the slope $m$ is estimated from the regression, we can solve for $a$:\n$$m = -a D$$\n$$a = -\\frac{m}{D}$$\nThe propagation distance $D$ is the same as that used for the speed of sound calculation. This method is computationally robust and stable, especially when implemented using standard numerical libraries.\n\n### Summary of the Complete Algorithm\n\nFor each test case:\n1.  Identify the geometry (`transmission one-way` or `pulse-echo`), path length $L$, travel time $t$, and the sets of frequencies $\\{f_i\\}$ and spectral magnitudes $\\{S_i\\}$.\n2.  Calculate the total propagation distance $D$: $D=L$ for transmission, $D=2L$ for pulse-echo.\n3.  Calculate the speed of sound: $c = D / t$.\n4.  Prepare the data for absorption estimation: create a set of points $(x_i, y_i)$ where $x_i = f_i$ and $y_i = \\ln(S_i)$.\n5.  Perform a simple linear regression on the $(x_i, y_i)$ data to estimate the slope $m$.\n6.  Calculate the absorption constant: $a = -m/D$.\n7.  Round the calculated $c$ to $3$ decimal places and $a$ to $6$ decimal places as required.\n8.  Store the resulting pair $[c, a]$.\n\nThis procedure is systematically applied to all test cases to generate the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an algorithm to estimate the speed of sound (c)\n    and absorption constant (a) for acoustic wave propagation in soft tissue.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Test case 1\",\n            \"geometry\": \"transmission one-way\",\n            \"L\": 0.03,  # meters\n            \"t\": 0.00001948051948,  # seconds\n            \"frequencies\": np.array([1.0, 2.0, 3.0]),  # MHz\n            \"magnitudes\": np.array([1.198201, 1.196405, 1.194612])  # dimensionless\n        },\n        {\n            \"name\": \"Test case 2\",\n            \"geometry\": \"transmission one-way\",\n            \"L\": 0.05,  # meters\n            \"t\": 0.00003333333333,  # seconds\n            \"frequencies\": np.array([0.5, 1.0, 2.0, 3.0]),  # MHz\n            \"magnitudes\": np.array([1.503482, 1.41944, 1.412575, 1.309963])  # dimensionless\n        },\n        {\n            \"name\": \"Test case 3\",\n            \"geometry\": \"pulse-echo\",\n            \"L\": 0.04,  # meters\n            \"t\": 0.000050632911,  # seconds\n            \"frequencies\": np.array([1.0, 2.5]),  # MHz\n            \"magnitudes\": np.array([2.047, 1.8376])  # dimensionless\n        }\n    ]\n\n    results_as_strings = []\n    \n    for case in test_cases:\n        # Extract variables for clarity\n        L = case[\"L\"]\n        t = case[\"t\"]\n        geometry = case[\"geometry\"]\n        freqs = case[\"frequencies\"]\n        mags = case[\"magnitudes\"]\n\n        # Step 1: Determine the total propagation distance D\n        if geometry == \"transmission one-way\":\n            D = L\n        elif geometry == \"pulse-echo\":\n            D = 2 * L\n        else:\n            # This case should not occur with the given problem statement\n            raise ValueError(f\"Unknown geometry: {geometry}\")\n\n        # Step 2: Estimate speed of sound c\n        # c = D / t\n        c = D / t\n\n        # Step 3: Estimate absorption constant a\n        # The model is S = K * exp(-a * f * D).\n        # Linearize by taking the natural log: ln(S) = ln(K) - (a * D) * f.\n        # This is a linear equation y = intercept + slope * x, where:\n        # y = ln(S)\n        # x = f\n        # slope = -a * D\n        # intercept = ln(K)\n        \n        # Prepare data for linear regression\n        x_data = freqs\n        y_data = np.log(mags)\n        \n        # Perform linear regression to find the slope.\n        # np.polyfit(x, y, 1) returns [slope, intercept] for a 1st degree polynomial.\n        slope, intercept = np.polyfit(x_data, y_data, 1)\n        \n        # Calculate a from the slope: a = -slope / D\n        a = -slope / D\n\n        # Step 4: Round the results to the specified precision\n        # and format them into the required string \"[c,a]\".\n        # Using f-string formatting to ensure the correct number of trailing zeros.\n        c_str = f\"{c:.3f}\"\n        a_str = f\"{a:.6f}\"\n        \n        results_as_strings.append(f\"[{c_str},{a_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(results_as_strings)}]]\")\n\nsolve()\n```"
        }
    ]
}