{
    "hands_on_practices": [
        {
            "introduction": "To compare image data from different scanners or patients, we must first establish a common scale. This practice explores z-score normalization, a fundamental technique that transforms an intensity distribution to have a mean of zero and a standard deviation of one. By working through the derivation , you will understand how this affine transformation, $Z = (X - \\mu)/\\sigma$, centers and scales the histogram while, crucially, preserving its intrinsic shape.",
            "id": "4891654",
            "problem": "In a radiological image, a Region of Interest (ROI) is selected to study its intensity distribution via an empirical histogram that approximates the underlying probability density of pixel intensities. Let pixel intensity within the ROI be modeled as a real-valued random variable $X$ with finite mean $ \\mu $ and positive standard deviation $ \\sigma $, where $ \\sigma > 0 $. Consider constructing a standardized intensity $Z$ by an affine transformation of $X$ so that the standardized histogram is centered and scaled in a way that facilitates cross-subject or cross-scan comparison without distorting the intrinsic shape characteristics of the distribution.\n\nStarting from the definitions of expectation $E[\\cdot]$ and variance $\\mathrm{Var}(\\cdot)$, and using only the properties of affine transformations of random variables and how they act on probability densities and histograms, derive the conditions on an affine map $Z = aX + b$ that produce a standardized intensity with zero mean and unit variance for the ROI. Then, reason about how this rescaling affects the histogram’s center, spread, and shape descriptors such as skewness and kurtosis, and whether the relative ordering of pixel intensities in the ROI is preserved. Assume that the histogram is a faithful empirical representation of the distribution and that the rescaling is applied uniformly to all ROI pixels. Finally, select the option that correctly states the derivation and the resulting effects on the histogram.\n\nWhich option is correct?\n\nA. Choose $a$ and $b$ in $Z = aX + b$ such that $E[Z] = 0$ and $\\mathrm{Var}(Z) = 1$, yielding $a = 1/\\sigma$ and $b = -\\mu/\\sigma$. The transformation is strictly increasing and thus preserves the relative ordering of ROI intensities. The standardized histogram is translated to center at $0$ and horizontally scaled by a factor $1/\\sigma$. Shape descriptors such as skewness and kurtosis are unchanged by this affine standardization.\n\nB. Choose $a$ and $b$ in $Z = aX + b$ such that $E[Z] = 0$ and $\\mathrm{Var}(Z) = 1$, yielding $a = \\sigma$ and $b = -\\mu$. The transformation compresses the intensity spread by a factor $\\sigma$ and makes the standardized histogram uniform on an interval when $X$ is Gaussian.\n\nC. The map $Z = (X - \\mu)/\\sigma$ ensures that the histogram’s bin edges and counts are identical to those of $X$, except for relabeling the $x$-axis. The mean and variance of the ROI are preserved under this normalization.\n\nD. The map $Z = (X - \\mu)/\\sigma$ centers the histogram at $0$ and sets its variance to $1$, but it alters shape by changing skewness and kurtosis unless $X$ is Gaussian.\n\nE. When applied to a Region of Interest (ROI) in a Computed Tomography (CT) image, the z-score normalization depends on the spatial arrangement of pixels and may break intensity ordering because the transformation is nonlinear in $X$.",
            "solution": "The user wants me to act as a STEM professor and solve a problem about histogram standardization. I will validate the problem, then derive the solution and evaluate the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- A Region of Interest (ROI) is selected in a radiological image.\n- Pixel intensity in the ROI is modeled as a real-valued random variable $X$.\n- $X$ has a finite mean $\\mu$.\n- $X$ has a positive standard deviation $\\sigma > 0$.\n- A standardized intensity $Z$ is constructed via an affine transformation: $Z = aX + b$.\n- The purpose is to create a standardized histogram for comparison, without distorting intrinsic shape characteristics.\n- The desired properties for $Z$ are zero mean ($E[Z] = 0$) and unit variance ($\\mathrm{Var}(Z) = 1$).\n- The derivation must start from the definitions of expectation $E[\\cdot]$ and variance $\\mathrm{Var}(\\cdot)$ and use properties of affine transformations.\n- The histogram is assumed to be a faithful empirical representation of the distribution.\n- The rescaling is applied uniformly to all ROI pixels.\n- The task is to derive the conditions on $a$ and $b$, and analyze the effects on the histogram's center, spread, shape (skewness, kurtosis), and the ordering of intensities.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in fundamental statistics and its application to medical image analysis. The concept of standardizing a random variable (creating a z-score) is a standard, valid, and widely used technique. All terms ($\\mu, \\sigma, E[\\cdot], \\mathrm{Var}(\\cdot)$, affine transformation, skewness, kurtosis) are well-defined in statistics.\n- **Well-Posed:** The problem provides a clear objective: find the parameters $a$ and $b$ of an affine map $Z=aX+b$ that yield a variable $Z$ with a specified mean and variance. This is a solvable problem with a unique solution for $a$ (up to sign) and $b$. The required assumptions (finite $\\mu$, positive $\\sigma$) are explicitly stated.\n- **Objective:** The problem is stated in precise, objective mathematical and scientific language. It is free of ambiguity or subjective claims.\n\n**Flaw Checklist:**\n1.  **Scientific or Factual Unsoundness:** None. The premises are sound.\n2.  **Non-Formalizable or Irrelevant:** None. The problem is directly formalizable and central to the topic of intensity normalization in imaging.\n3.  **Incomplete or Contradictory Setup:** None. All necessary information is provided. The condition $\\sigma > 0$ prevents division by zero.\n4.  **Unrealistic or Infeasible:** None. This is a common, practical procedure in image processing.\n5.  **Ill-Posed or Poorly Structured:** None. A unique and stable solution exists.\n6.  **Pseudo-Profound, Trivial, or Tautological:** None. While a standard derivation, it correctly tests the understanding of fundamental statistical properties and their implications.\n7.  **Outside Scientific Verifiability:** None. The derivation is mathematically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. I will now proceed with the derivation and evaluation of the options.\n\n### Derivation and Solution\n\nThe problem asks to find the parameters $a$ and $b$ for the affine transformation $Z = aX + b$ such that the resulting random variable $Z$ has a mean of $0$ and a variance of $1$. We are given that $X$ has mean $E[X] = \\mu$ and variance $\\mathrm{Var}(X) = \\sigma^2$, with $\\sigma > 0$.\n\n**1. Condition on the Mean:**\nWe require $E[Z] = 0$. Using the linearity of the expectation operator:\n$$E[Z] = E[aX + b] = aE[X] + b$$\nSubstituting $E[X] = \\mu$:\n$$E[Z] = a\\mu + b$$\nSetting this to $0$ gives our first equation:\n$$a\\mu + b = 0 \\implies b = -a\\mu$$\n\n**2. Condition on the Variance:**\nWe require $\\mathrm{Var}(Z) = 1$. Using the properties of variance under an affine transformation:\n$$\\mathrm{Var}(Z) = \\mathrm{Var}(aX + b) = a^2 \\mathrm{Var}(X)$$\nSubstituting $\\mathrm{Var}(X) = \\sigma^2$:\n$$\\mathrm{Var}(Z) = a^2 \\sigma^2$$\nSetting this to $1$ gives our second equation:\n$$a^2 \\sigma^2 = 1$$\nSolving for $a$, since we are given $\\sigma > 0$:\n$$a^2 = \\frac{1}{\\sigma^2} \\implies a = \\pm \\frac{1}{\\sigma}$$\nBy convention, for standardization, we choose the positive root $a = 1/\\sigma$ to preserve the orientation of the distribution (i.e., values that were larger than the mean remain positive after standardization).\n\n**3. Determining the Parameters:**\nWith $a = 1/\\sigma$, we can find $b$ from our first equation:\n$$b = -a\\mu = -\\left(\\frac{1}{\\sigma}\\right)\\mu = -\\frac{\\mu}{\\sigma}$$\nThus, the required affine transformation is:\n$$Z = \\left(\\frac{1}{\\sigma}\\right)X - \\frac{\\mu}{\\sigma} = \\frac{X - \\mu}{\\sigma}$$\nThis transformation is known as the standard score or z-score.\n\n**4. Analysis of the Effects:**\n- **Center and Spread:** By construction, the mean of $Z$ is $0$ and its variance is $1$. The standard deviation is $\\sqrt{1} = 1$. In terms of the histogram, this means the distribution is translated so that its center of mass is at $0$. The horizontal axis is scaled by a factor of $a = 1/\\sigma$. If $\\sigma > 1$, this is a compression; if $0 < \\sigma < 1$, this is a stretch.\n\n- **Relative Ordering of Intensities:** The transformation is an affine map $f(x) = (1/\\sigma)x - \\mu/\\sigma$. The derivative is $f'(x) = 1/\\sigma$. Since $\\sigma > 0$ is given, $f'(x) > 0$ for all $x$. This means the transformation is strictly increasing. Therefore, if two pixel intensities are $x_1$ and $x_2$ with $x_1 > x_2$, their transformed values $z_1$ and $z_2$ will satisfy $z_1 > z_2$. The relative ordering of all pixel intensities is preserved.\n\n- **Shape Descriptors (Skewness and Kurtosis):** These descriptors are defined based on standardized central moments.\n    - The $n$-th central moment of a random variable $Y$ with mean $\\mu_Y$ is $\\mu_n(Y) = E[(Y - \\mu_Y)^n]$.\n    - The $n$-th central moment of $Z$ is $\\mu_n(Z) = E[(Z - E[Z])^n] = E[(Z-0)^n] = E[Z^n]$.\n    - Let's express this in terms of $X$:\n    $$\\mu_n(Z) = E\\left[\\left(\\frac{X-\\mu}{\\sigma}\\right)^n\\right] = \\frac{1}{\\sigma^n} E[(X-\\mu)^n] = \\frac{\\mu_n(X)}{\\sigma^n}$$\n    - **Skewness** is the third standardized moment: $\\gamma_1(Y) = \\mu_3(Y) / (\\mathrm{std}(Y))^3$.\n    For $Z$, the standard deviation is $1$, so its skewness is:\n    $$\\gamma_1(Z) = \\frac{\\mu_3(Z)}{1^3} = \\mu_3(Z) = \\frac{\\mu_3(X)}{\\sigma^3}$$\n    This is precisely the definition of the skewness of $X$, $\\gamma_1(X)$. Therefore, $\\gamma_1(Z) = \\gamma_1(X)$. Skewness is invariant.\n    - **Kurtosis** is the fourth standardized moment: $\\beta_2(Y) = \\mu_4(Y) / (\\mathrm{std}(Y))^4$.\n    For $Z$, the standard deviation is $1$, so its kurtosis is:\n    $$\\beta_2(Z) = \\frac{\\mu_4(Z)}{1^4} = \\mu_4(Z) = \\frac{\\mu_4(X)}{\\sigma^4}$$\n    This is precisely the definition of the kurtosis of $X$, $\\beta_2(X)$. Therefore, $\\beta_2(Z) = \\beta_2(X)$. Kurtosis is invariant.\n    Since skewness and kurtosis are unchanged, the intrinsic shape of the distribution is preserved.\n\n### Option-by-Option Analysis\n\n**A. Choose $a$ and $b$ in $Z = a X + b$ such that $E[Z] = 0$ and $\\mathrm{Var}(Z) = 1$, yielding $a = 1/\\sigma$ and $b = -\\mu/\\sigma$. The transformation is strictly increasing and thus preserves the relative ordering of ROI intensities. The standardized histogram is translated to center at $0$ and horizontally scaled by a factor $1/\\sigma$. Shape descriptors such as skewness and kurtosis are unchanged by this affine standardization.**\n- The derivation of $a = 1/\\sigma$ and $b = -\\mu/\\sigma$ is correct.\n- The statement that the transformation is strictly increasing (since $a = 1/\\sigma > 0$) and preserves ordering is correct.\n- The description of the histogram being centered at $0$ and scaled by $1/\\sigma$ is correct.\n- The statement that skewness and kurtosis are unchanged is correct.\n- **Verdict:** **Correct**. Every part of this statement is accurate and follows from the derivation.\n\n**B. Choose $a$ and $b$ in $Z = a X + b$ such that $E[Z] = 0$ and $\\mathrm{Var}(Z) = 1$, yielding $a = \\sigma$ and $b = -\\mu$. The transformation compresses the intensity spread by a factor $\\sigma$ and makes the standardized histogram uniform on an interval when $X$ is Gaussian.**\n- The values for $a$ and $b$ are incorrect. As derived, $a = 1/\\sigma$ and $b = -\\mu/\\sigma$. With $a=\\sigma$ and $b=-\\mu$, $E[Z] = \\sigma \\mu - \\mu$ and $\\mathrm{Var}(Z) = \\sigma^4$, neither of which are the desired $0$ and $1$ in general.\n- The claim that a standardized Gaussian distribution becomes a uniform distribution is false. The affine transformation of a Gaussian variable results in another Gaussian variable. Specifically, $Z = (X-\\mu)/\\sigma$ for a Gaussian $X \\sim N(\\mu, \\sigma^2)$ results in $Z \\sim N(0, 1)$, the standard normal distribution, which is not uniform.\n- **Verdict:** **Incorrect**.\n\n**C. The map $Z = (X - \\mu)/\\sigma$ ensures that the histogram’s bin edges and counts are identical to those of $X$, except for relabeling the $x$-axis. The mean and variance of the ROI are preserved under this normalization.**\n- The claim that the mean and variance are preserved is false. The very purpose and result of the transformation is to change the mean from $\\mu$ to $0$ and the variance from $\\sigma^2$ to $1$.\n- The claim about bin edges being identical is false. A bin edge at value $x$ is mapped to a new value $(x-\\mu)/\\sigma$. The bin locations and widths are scaled and shifted.\n- **Verdict:** **Incorrect**.\n\n**D. The map $Z = (X - \\mu)/\\sigma$ centers the histogram at $0$ and sets its variance to $1$, but it alters shape by changing skewness and kurtosis unless $X$ is Gaussian.**\n- The first part is correct: the map centers the histogram at $0$ and sets its variance to $1$.\n- The second part is false. As derived above, skewness and kurtosis are invariant under this affine transformation for *any* distribution with finite moments, not just a Gaussian one. The shape is preserved by this transformation.\n- **Verdict:** **Incorrect**.\n\n**E. When applied to a Region of Interest (ROI) in a Computed Tomography (CT) image, the z-score normalization depends on the spatial arrangement of pixels and may break intensity ordering because the transformation is nonlinear in $X$.**\n- The transformation $Z = aX+b$ is the definition of an affine (and linear, if $b=0$) transformation. It is not nonlinear in $X$.\n- Because the transformation is a strictly increasing linear function (since $a = 1/\\sigma > 0$), it preserves the intensity ordering, it does not break it.\n- The calculation of the global statistics $\\mu$ and $\\sigma$ for the ROI involves summing over all pixels, irrespective of their spatial arrangement. The transformation $z_i = (x_i - \\mu)/\\sigma$ is then applied to each pixel's intensity value $x_i$ independently of its location. Thus, the transformation itself does not depend on the spatial arrangement of pixels.\n- **Verdict:** **Incorrect**. This statement contains multiple false claims.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Real-world imaging systems have physical limits, and detector saturation is a common artifact that can corrupt image statistics. This exercise models saturated pixels as a mixture distribution and asks you to quantify their impact on the empirical mean $\\mu$ and variance $\\sigma^2$ . This practice is vital for learning how to critically assess the reliability of image metrics and algorithms that depend on them, such as automated thresholding using $T = \\mu+k\\sigma$.",
            "id": "4891605",
            "problem": "A digital medical imaging system records pixel intensities on a normalized scale in the closed interval $\\left[0,1\\right]$, where the maximum code $1$ corresponds to saturation. Consider an acquisition in which a proportion $p$ of pixels are saturated at the maximum code due to detector clipping, while the remaining proportion $1-p$ of pixels would, in the absence of saturation, follow a baseline intensity distribution that is uniform on $\\left[0,1\\right]$. The image histogram is used to compute an empirical mean and variance over all pixels in the field of view. Many simple global thresholding heuristics choose a threshold $T$ of the form $T = \\mu + k\\sigma$, where $\\mu$ is the empirical mean, $\\sigma$ is the empirical standard deviation, and $k>0$ is a user-selected constant.\n\nUsing only the foundational definitions of expectation, variance, and mixture distributions:\n- Derive closed-form expressions for the empirical mean $\\mu(p)$ and empirical variance $\\sigma^{2}(p)$ as functions of the saturation proportion $p$ under the mixture model consisting of a point mass at $1$ with probability $p$ and a uniform distribution on $\\left[0,1\\right]$ with probability $1-p$.\n- Let $T_{\\text{true}}(k)$ denote the threshold computed in the ideal case where $p=0$, and let $T_{\\text{obs}}(p,k)$ denote the threshold computed under the saturated mixture model. Derive a closed-form expression for the threshold bias $\\Delta T(p,k)=T_{\\text{obs}}(p,k)-T_{\\text{true}}(k)$.\n\nFinally, quantify the threshold bias for a given saturation proportion by evaluating $\\Delta T(p,k)$ at $p=0.18$ and $k=1.2$. Round your final numerical answer to four significant figures. Express the answer as a unitless number.",
            "solution": "The problem is validated against the specified criteria before a solution is attempted.\n\n### Step 1: Extract Givens\n- Pixel intensities are in the closed interval $\\left[0,1\\right]$.\n- Maximum code is $1$, corresponding to saturation.\n- A proportion $p$ of pixels are saturated at the maximum code $1$.\n- The remaining proportion $1-p$ of pixels follow a baseline intensity distribution that is uniform on $\\left[0,1\\right]$.\n- The overall model is a mixture distribution: a point mass at $1$ with probability $p$ and a uniform distribution on $\\left[0,1\\right]$ with probability $1-p$.\n- The threshold $T$ is defined as $T=\\mu+k\\sigma$, where $\\mu$ is the empirical mean, $\\sigma$ is the empirical standard deviation, and $k>0$ is a constant.\n- First task: Derive closed-form expressions for the empirical mean $\\mu(p)$ and empirical variance $\\sigma^{2}(p)$ as functions of $p$.\n- Second task: Derive a closed-form expression for the threshold bias $\\Delta T(p,k)=T_{\\text{obs}}(p,k)-T_{\\text{true}}(k)$, where $T_{\\text{true}}(k)$ is the threshold for $p=0$ and $T_{\\text{obs}}(p,k)$ is the threshold for the saturated mixture model.\n- Third task: Evaluate $\\Delta T(p,k)$ at $p=0.18$ and $k=1.2$ and round the answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in probability theory and statistics (mixture distributions, expectation, variance) and applies these concepts to a common, realistic problem in digital image processing, specifically medical imaging (detector saturation and its effect on image statistics). The model is a valid simplification.\n- **Well-Posed**: The problem provides all necessary information and clear definitions to derive the requested expressions and compute the final numerical value. It is self-contained and structured to lead to a unique solution.\n- **Objective**: The problem is stated using precise, objective mathematical and scientific language, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any of the listed flaws (e.g., scientific unsoundness, incompleteness, contradiction, ambiguity). The mathematical model of a mixture between a uniform distribution and a point mass is well-defined and suitable for the analysis requested.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\nLet $I$ be the random variable representing pixel intensity. According to the problem statement, the distribution of $I$ is a mixture of two distributions:\n$1$. A uniform distribution on the interval $\\left[0,1\\right]$, let's call this component $I_U \\sim U(0,1)$. This component is selected with probability $1-p$.\n$2$. A constant value of $1$ (a point mass), let's call this component $I_S$. This component is selected with probability $p$.\n\nThe expected value (mean) $\\mu(p) = \\mathbb{E}[I]$ and the second moment $\\mathbb{E}[I^2]$ can be calculated using the law of total expectation, by conditioning on which component of the mixture the intensity value is drawn from.\n$\\mathbb{E}[I^m] = (1-p)\\mathbb{E}[I_U^m] + p\\mathbb{E}[I_S^m]$.\n\nFirst, we find the moments for each component.\nFor the uniform component $I_U \\sim U(0,1)$, the probability density function is $f_U(x)=1$ for $x \\in \\left[0,1\\right]$ and $0$ otherwise.\nThe first moment is $\\mathbb{E}[I_U] = \\int_0^1 x \\cdot 1 \\, dx = \\left[\\frac{x^2}{2}\\right]_0^1 = \\frac{1}{2}$.\nThe second moment is $\\mathbb{E}[I_U^2] = \\int_0^1 x^2 \\cdot 1 \\, dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3}$.\n\nFor the saturated component $I_S=1$, the moments are:\n$\\mathbb{E}[I_S] = \\mathbb{E}[1] = 1$.\n$\\mathbb{E}[I_S^2] = \\mathbb{E}[1^2] = 1$.\n\nNow, we can compute the mean $\\mu(p)$ and variance $\\sigma^2(p)$ for the mixture distribution.\nThe mean is $\\mu(p) = \\mathbb{E}[I] = (1-p)\\mathbb{E}[I_U] + p\\mathbb{E}[I_S]$.\n$\\mu(p) = (1-p) \\cdot \\frac{1}{2} + p \\cdot 1 = \\frac{1-p}{2} + p = \\frac{1-p+2p}{2} = \\frac{1+p}{2}$.\n\nThe variance is $\\sigma^2(p) = \\mathbb{E}[I^2] - (\\mathbb{E}[I])^2 = \\mathbb{E}[I^2] - (\\mu(p))^2$. We first need the second moment of the mixture, $\\mathbb{E}[I^2]$.\n$\\mathbb{E}[I^2] = (1-p)\\mathbb{E}[I_U^2] + p\\mathbb{E}[I_S^2]$.\n$\\mathbb{E}[I^2] = (1-p)\\cdot\\frac{1}{3} + p \\cdot 1 = \\frac{1-p}{3} + p = \\frac{1-p+3p}{3} = \\frac{1+2p}{3}$.\n\nNow we can find the variance $\\sigma^2(p)$:\n$\\sigma^2(p) = \\frac{1+2p}{3} - \\left(\\frac{1+p}{2}\\right)^2 = \\frac{1+2p}{3} - \\frac{1+2p+p^2}{4}$.\nTo combine these terms, we use a common denominator of $12$:\n$\\sigma^2(p) = \\frac{4(1+2p) - 3(1+2p+p^2)}{12} = \\frac{4+8p - 3-6p-3p^2}{12}$.\n$\\sigma^2(p) = \\frac{1+2p-3p^2}{12}$.\nThe expressions for the mean and variance are:\n$\\mu(p) = \\frac{1+p}{2}$\n$\\sigma^2(p) = \\frac{1+2p-3p^2}{12}$\n\nNext, we derive the threshold bias $\\Delta T(p,k) = T_{\\text{obs}}(p,k) - T_{\\text{true}}(k)$.\nThe threshold is defined as $T = \\mu + k\\sigma = \\mu + k\\sqrt{\\sigma^2}$.\n\nFirst, we find the \"true\" threshold $T_{\\text{true}}(k)$ for the ideal case where $p=0$.\n$\\mu(0) = \\frac{1+0}{2} = \\frac{1}{2}$.\n$\\sigma^2(0) = \\frac{1+2(0)-3(0)^2}{12} = \\frac{1}{12}$.\nThe standard deviation is $\\sigma(0) = \\sqrt{\\frac{1}{12}} = \\frac{1}{\\sqrt{12}} = \\frac{1}{2\\sqrt{3}}$.\nSo, $T_{\\text{true}}(k) = \\mu(0) + k\\sigma(0) = \\frac{1}{2} + \\frac{k}{2\\sqrt{3}}$.\n\nNext, we find the \"observed\" threshold $T_{\\text{obs}}(p,k)$ for the saturated mixture model.\n$\\mu(p) = \\frac{1+p}{2}$.\n$\\sigma(p) = \\sqrt{\\sigma^2(p)} = \\sqrt{\\frac{1+2p-3p^2}{12}} = \\frac{\\sqrt{1+2p-3p^2}}{2\\sqrt{3}}$.\nThe term inside the square root can be factored: $1+2p-3p^2 = (1-p)(1+3p)$.\nSo, $\\sigma(p) = \\frac{\\sqrt{(1-p)(1+3p)}}{2\\sqrt{3}}$.\nThus, $T_{\\text{obs}}(p,k) = \\mu(p) + k\\sigma(p) = \\frac{1+p}{2} + k\\frac{\\sqrt{(1-p)(1+3p)}}{2\\sqrt{3}}$.\n\nThe threshold bias $\\Delta T(p,k)$ is the difference:\n$\\Delta T(p,k) = T_{\\text{obs}}(p,k) - T_{\\text{true}}(k) = \\left(\\frac{1+p}{2} + k\\frac{\\sqrt{(1-p)(1+3p)}}{2\\sqrt{3}}\\right) - \\left(\\frac{1}{2} + \\frac{k}{2\\sqrt{3}}\\right)$.\n$\\Delta T(p,k) = \\left(\\frac{1+p}{2} - \\frac{1}{2}\\right) + \\left(k\\frac{\\sqrt{(1-p)(1+3p)}}{2\\sqrt{3}} - \\frac{k}{2\\sqrt{3}}\\right)$.\n$\\Delta T(p,k) = \\frac{p}{2} + \\frac{k}{2\\sqrt{3}}\\left(\\sqrt{(1-p)(1+3p)} - 1\\right)$.\n\nFinally, we evaluate this expression for $p=0.18$ and $k=1.2$.\n$\\Delta T(0.18, 1.2) = \\frac{0.18}{2} + \\frac{1.2}{2\\sqrt{3}}\\left(\\sqrt{(1-0.18)(1+3 \\cdot 0.18)} - 1\\right)$.\n$\\Delta T(0.18, 1.2) = 0.09 + \\frac{0.6}{\\sqrt{3}}\\left(\\sqrt{(0.82)(1+0.54)} - 1\\right)$.\n$\\Delta T(0.18, 1.2) = 0.09 + \\frac{0.6}{\\sqrt{3}}\\left(\\sqrt{0.82 \\times 1.54} - 1\\right)$.\n$\\Delta T(0.18, 1.2) = 0.09 + \\frac{0.6}{\\sqrt{3}}\\left(\\sqrt{1.2628} - 1\\right)$.\nNow we compute the numerical values:\n$\\sqrt{1.2628} \\approx 1.1237437$.\n$\\frac{0.6}{\\sqrt{3}} \\approx 0.3464102$.\n$\\Delta T(0.18, 1.2) \\approx 0.09 + 0.3464102 \\times (1.1237437 - 1)$.\n$\\Delta T(0.18, 1.2) \\approx 0.09 + 0.3464102 \\times 0.1237437$.\n$\\Delta T(0.18, 1.2) \\approx 0.09 + 0.0428610$.\n$\\Delta T(0.18, 1.2) \\approx 0.132861$.\n\nRounding to four significant figures, we get $0.1329$.",
            "answer": "$$\\boxed{0.1329}$$"
        },
        {
            "introduction": "Medical images often store raw data that must be converted into physically meaningful units, a process defined by parameters in the image's metadata. This hands-on problem challenges you to derive the mathematical transformation of a histogram when moving from stored pixel values to physical units like Hounsfield Units via a mapping such as $x' = sx + a$ . Understanding this \"pushforward\" operation is key to correctly interpreting and processing clinical image data, as it reveals how rescaling can cause histogram bins to split or merge.",
            "id": "4891647",
            "problem": "A computed tomography (CT) system stores pixel values as integers and encodes the transformation from stored pixel value $x$ to a physical intensity $x'$ (in Hounsfield units) through the Digital Imaging and Communications in Medicine (DICOM) rescale mapping $x' = s x + a$, where $s$ (the slope) and $a$ (the intercept) are modality-supplied constants. Consider an image with $K$ nonempty histogram bins in the stored-value domain. The stored-value histogram uses uniform bin width $\\Delta_{x} > 0$, with lower edges at $x = x_{0} + k \\Delta_{x}$ for bin index $k \\in \\{0, 1, \\dots, K-1\\}$, and counts $h_{k}$ in each bin. A new histogram is to be constructed in the physical-intensity domain $x'$ using uniform bin width $\\Delta' > 0$, with lower edges at $x' = y_{0} + j \\Delta'$ for bin index $j \\in \\mathbb{Z}$.\n\nStarting only from the fundamental definition of a histogram as a discretized integral (or count) of a distribution over specified bin intervals, the definition of a pushforward under a measurable mapping $T(x) = s x + a$, and conservation of counts under relabeling, derive an explicit closed-form expression for the physical-intensity histogram counts $h'_{j}$ in terms of $\\{h_{k}\\}$, $s$, $a$, $\\Delta_{x}$, $\\Delta'$, $x_{0}$, and $y_{0}$. Your derivation should be scientifically realistic in the sense that it accounts for the fact that each stored-value bin $k$ is mapped by $T$ to an interval of width $s \\Delta_{x}$ in the physical-intensity domain and that contributions to any physical-intensity bin $j$ are proportional to the length of overlap between the mapped interval and the bin $j$. In your reasoning, identify conditions under which bins merge (multiple stored-value bins contribute entirely to a single physical-intensity bin) or split (one stored-value bin contributes to multiple physical-intensity bins) due to the rescaling. \n\nExpress your final answer as a single analytic expression for $h'_{j}$ that uses only the operations $\\max(\\cdot,\\cdot)$, $\\min(\\cdot,\\cdot)$, finite summation over $k$, and the given parameters. No numerical evaluation is required. The final answer must be a single symbolic mathematical expression; do not include any explanatory text or units within the final expression.",
            "solution": "The problem requires the derivation of a closed-form expression for the counts $h'_{j}$ of a histogram in a physical-intensity domain, given a histogram in a stored-value domain and a linear transformation between the two domains. The derivation must be based on first principles.\n\nLet the stored-value domain be denoted by $x$ and the physical-intensity domain by $x'$. The transformation is given by the linear mapping $T(x) = s x + a$, where $s$ is the slope and $a$ is the intercept. We are given that $s$ and $a$ are constants, the stored-value bin width is $\\Delta_x > 0$, and the physical-intensity bin width is $\\Delta' > 0$. We will assume $s \\neq 0$, as $s=0$ represents a degenerate case where all intensity values collapse to $x'=a$, which is not a meaningful rescaling.\n\nThe fundamental principle is the conservation of counts. The total number of counts in the original histogram must equal the total number of counts in the new histogram: $\\sum_{k=0}^{K-1} h_k = \\sum_{j \\in \\mathbb{Z}} h'_j$.\n\nTo determine the distribution of counts from the original bins $\\{h_k\\}$ into the new bins $\\{h'_j\\}$, we must make an assumption about the distribution of counts *within* each original bin. The standard and most logical assumption, implied by the problem's reference to contributions being \"proportional to the length of overlap,\" is that the $h_k$ counts of bin $k$ are uniformly distributed over the corresponding interval.\n\nThe $k$-th bin in the stored-value domain, for $k \\in \\{0, 1, \\dots, K-1\\}$, corresponds to the half-open interval $I_k = [x_k, x_k + \\Delta_x)$, where the lower edge is $x_k = x_0 + k \\Delta_x$. The count density within this interval is constant and given by $\\rho_k = \\frac{h_k}{\\Delta_x}$.\n\nThe linear transformation $T(x)$ maps the interval $I_k$ to a new interval $I'_k$ in the physical-intensity domain. The endpoints of $I_k$ are $x_k$ and $x_k + \\Delta_x$. The corresponding transformed endpoints are $T(x_k) = s x_k + a$ and $T(x_k + \\Delta_x) = s(x_k + \\Delta_x) + a$. The width of the transformed interval $I'_k$ is $|T(x_k + \\Delta_x) - T(x_k)| = |(s(x_k + \\Delta_x) + a) - (s x_k + a)| = |s\\Delta_x|$. Since $\\Delta_x > 0$, this width is $|s|\\Delta_x$.\n\nThe orientation of the interval $I'_k$ depends on the sign of $s$. To handle both cases ($s > 0$ and $s < 0$) in a unified manner, we define the lower and upper bounds of $I'_k$ as $u_k$ and $v_k$ respectively:\n$$u_k = \\min(s x_k + a, s(x_k + \\Delta_x) + a)$$\n$$v_k = \\max(s x_k + a, s(x_k + \\Delta_x) + a)$$\nThe transformed interval is thus $I'_k = [u_k, v_k)$.\n\nUnder the transformation, the $h_k$ counts from bin $k$ are now spread uniformly over the interval $I'_k$. The new count density within this physical-intensity interval is $\\rho'_k = \\frac{h_k}{\\text{width}(I'_k)} = \\frac{h_k}{|s|\\Delta_x}$ for $x' \\in I'_k$.\n\nThe $j$-th bin of the new histogram, for $j \\in \\mathbb{Z}$, corresponds to the physical-intensity interval $J_j = [y_j, y_j + \\Delta')$, where the lower edge is $y_j = y_0 + j \\Delta'$.\n\nThe number of counts contributed by the original bin $k$ to the new bin $j$, which we denote as $c_{k \\to j}$, is the product of the count density $\\rho'_k$ and the length of the overlap between the intervals $I'_k$ and $J_j$.\n$$c_{k \\to j} = \\rho'_k \\times \\text{Length}(I'_k \\cap J_j) = \\frac{h_k}{|s|\\Delta_x} \\times \\text{Length}([u_k, v_k) \\cap [y_j, y_j + \\Delta'))$$\nThe length of the intersection of two half-open intervals $[A, B)$ and $[C, D)$ is given by the expression $\\max(0, \\min(B, D) - \\max(A, C))$. Applying this formula, the overlap length is:\n$$\\text{Length}(I'_k \\cap J_j) = \\max(0, \\min(v_k, y_j + \\Delta') - \\max(u_k, y_j))$$\nThe total count $h'_j$ in the new bin $j$ is the sum of contributions from all original bins $k \\in \\{0, 1, \\dots, K-1\\}$:\n$$h'_j = \\sum_{k=0}^{K-1} c_{k \\to j} = \\sum_{k=0}^{K-1} \\frac{h_k}{|s|\\Delta_x} \\max(0, \\min(v_k, y_j + \\Delta') - \\max(u_k, y_j))$$\nSubstituting the full expressions for $u_k$, $v_k$, $x_k$, and $y_j$, we arrive at the explicit closed-form expression for $h'_{j}$:\n$$h'_{j} = \\frac{1}{|s|\\Delta_x} \\sum_{k=0}^{K-1} h_k \\max\\left(0, \\min\\left(\\max(T_{k}, T_{k+1}), y_{j+1}\\right) - \\max\\left(\\min(T_{k}, T_{k+1}), y_{j}\\right)\\right)$$\nwhere $T_k = s(x_0 + k\\Delta_x) + a$ and $y_j = y_0 + j\\Delta'$.\n\nThe problem also asks to identify conditions for bin merging and splitting. These phenomena are determined by the relative widths of the transformed stored-value bins and the new physical-intensity bins. The width of a transformed bin is $|s|\\Delta_x$, and the width of a new bin is $\\Delta'$.\n\n1.  **Bin Splitting**: A single stored-value bin $k$ contributes its counts to multiple physical-intensity bins $j$. This occurs when the interval $I'_k$ is wider than a single destination bin $J_j$ and straddles a bin boundary. The general condition for splitting to occur is when the width of the transformed interval is greater than the width of the new bins: $|s|\\Delta_x > \\Delta'$.\n\n2.  **Bin Merging**: Multiple stored-value bins $\\{k_1, k_2, \\dots\\}$ contribute their counts entirely or primarily into a single physical-intensity bin $j$. This occurs when the destination bin $J_j$ is wide enough to contain multiple transformed intervals $\\{I'_{k_1}, I'_{k_2}, \\dots\\}$. The general condition for merging to occur is when the width of the transformed interval is less than the width of the new bins: $|s|\\Delta_x < \\Delta'$.\n\n3.  **One-to-One Mapping**: If $|s|\\Delta_x = \\Delta'$, each stored-value bin maps to an interval of the same width as a physical-intensity bin. In this case, each original bin $k$ will contribute its counts to at most two new bins, with the contribution split at the boundary. If the intervals are perfectly aligned (i.e., $s x_0 + a - y_0$ is an integer multiple of $\\Delta'$), a one-to-one mapping of counts occurs.\n\nThe derived expression correctly accounts for all three scenarios through the overlap calculation.",
            "answer": "$$\n\\boxed{\\frac{1}{|s|\\Delta_x} \\sum_{k=0}^{K-1} h_k \\max\\left(0, \\min\\left(\\max\\left(s(x_0+k\\Delta_x)+a, s(x_0+(k+1)\\Delta_x)+a\\right), y_0+(j+1)\\Delta'\\right) - \\max\\left(\\min\\left(s(x_0+k\\Delta_x)+a, s(x_0+(k+1)\\Delta_x)+a\\right), y_0+j\\Delta'\\right)\\right)}\n$$"
        }
    ]
}