{
    "hands_on_practices": [
        {
            "introduction": "我们如何从操作上量化急性和慢性疼痛患者在感觉处理上的差异？本练习将引导你应用心理物理学中的一个基本方法，即通过心理测量函数来评估疼痛阈值。通过将模型拟合到假设的疼痛报告数据中，你将学习如何客观地量化痛觉超敏（表现为阈值的“左移”），这是理解慢性疼痛中感觉放大机制的关键一步。",
            "id": "4708705",
            "problem": "你需要编写一个完整的、可运行的程序，该程序将运用心理计量学建模来比较慢性疼痛组和急性疼痛对照组在两种感觉模式（热感觉和机械感觉）下的疼痛阈值。此问题基于医学心理学和心理物理学的基本原理构建，必须纯粹以数学和逻辑术语来解决。目标是检验慢性疼痛是否相对于急性疼痛对照组表现出阈值左移，这表明其敏感性增加。使用以下基本原理：将心理计量函数定义为从刺激强度 $x$ 到疼痛报告概率 $P(\\text{pain report} \\mid x)$ 的单调S型映射，每个强度下的疼痛报告采用二项试验结构，使用最大似然估计进行参数拟合，并通过观测信息对参数不确定性进行渐近正态近似。\n\n定义与要求：\n\n- 使用一个双参数S型心理计量函数 $p(x;\\theta,s)$ 对每种感觉模式（热感觉和机械感觉）和每个组（急性、慢性）进行建模，其中 $\\theta$ 是阈值（即 $p(x)=0.5$ 时的刺激强度），$s$ 是一个控制陡峭程度的正斜率/尺度参数。假设使用一个严格递增的S型函数，形式为 $p(x) = \\sigma\\left(\\dfrac{x - \\theta}{s}\\right)$，其中 $\\sigma(z)$ 是一个对所有实数 $z$ 都满足 $0 < \\sigma(z) < 1$ 的递增函数。程序可使用逻辑斯谛函数 $\\sigma(z) = \\dfrac{1}{1+e^{-z}}$ 作为标准选择。\n- 对于每个组和感觉模式，给定刺激强度 $\\{x_i\\}$，每个强度下有 $n_i$ 次独立的二元试验和 $k_i$ 次观测到的“疼痛”响应，通过最大化二项对数似然函数 $\\ell(\\theta,s) = \\sum_i \\left[k_i \\ln p(x_i;\\theta,s) + (n_i - k_i) \\ln\\left(1 - p(x_i;\\theta,s)\\right)\\right]$ 来拟合 $(\\theta,s)$。对于这种检测型任务，将失误率和猜测率视为 $0$。\n- 使用在最大似然估计处的观测信息矩阵的逆来估计阈值估计量 $\\hat{\\theta}$ 的方差，该矩阵等于负对数似然函数的Hessian矩阵的逆。将每个拟合的组-感觉模式模型的方差记为 $\\mathrm{Var}(\\hat{\\theta})$。\n- 对于每个测试用例中的每种感觉模式，计算阈值差异 $\\Delta \\theta = \\hat{\\theta}_{\\text{chronic}} - \\hat{\\theta}_{\\text{acute}}$。左移对应于 $\\Delta \\theta < 0$。\n- 使用单侧Wald检验来检验是否存在左移，原假设为 $H_0: \\Delta \\theta \\ge 0$，备择假设为 $H_1: \\Delta \\theta < 0$，显著性水平为 $\\alpha = 0.05$。在组估计的渐近正态性和独立性假设下，使用检验统计量 $z = \\dfrac{\\Delta \\theta}{\\sqrt{\\mathrm{Var}(\\hat{\\theta}_{\\text{chronic}}) + \\mathrm{Var}(\\hat{\\theta}_{\\text{acute}})}}$ 和单侧 $p$ 值 $p = \\Phi(z)$，其中 $\\Phi$ 是标准正态分布的累积分布函数。如果 $p < \\alpha$ 且 $\\Delta \\theta < 0$，则得出“显著左移”的结论。\n- 物理单位：热感觉阈值差异必须以摄氏度（°C）报告，机械感觉阈值差异必须以毫牛顿（mN）报告。以这些单位表示数值结果，并将每个差异四舍五入到两位小数。\n- 最终输出格式：你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例（按顺序1, 2, 3），按此确切顺序输出四项：热感觉阈值差异 $\\Delta \\theta_{\\text{thermal}}$（单位为°C，四舍五入到两位小数），热感觉左移显著性的布尔值，机械感觉阈值差异 $\\Delta \\theta_{\\text{mechanical}}$（单位为mN，四舍五入到两位小数），机械感觉左移显著性的布尔值。将所有三个测试用例的结果汇总成一个扁平列表。例如，三个测试用例的有效输出格式为 $[\\Delta \\theta_{\\text{thermal},1},S_{\\text{thermal},1},\\Delta \\theta_{\\text{mechanical},1},S_{\\text{mechanical},1},\\Delta \\theta_{\\text{thermal},2},S_{\\text{thermal},2},\\Delta \\theta_{\\text{mechanical},2},S_{\\text{mechanical},2},\\Delta \\theta_{\\text{thermal},3},S_{\\text{thermal},3},\\Delta \\theta_{\\text{mechanical},3},S_{\\text{mechanical},3}]$。\n\n测试套件规范：\n\n提供三个测试用例，包含科学上合理的刺激强度和疼痛报告的二项计数。在所有情况下，每个强度使用 $n_i = 20$ 次试验。\n\n- 测试用例1（理想路径）：\n  - 热感觉模式（°C）：强度 $[38,40,42,44,46,48]$，急性组计数 $[1,3,6,10,15,18]$，慢性组计数 $[4,7,11,16,19,20]$。\n  - 机械感觉模式（mN）：强度 $[50,100,150,200,250,300]$，急性组计数 $[1,3,5,9,14,18]$，慢性组计数 $[3,7,10,15,18,20]$。\n- 测试用例2（边界情况：差异微小）：\n  - 热感觉模式（°C）：强度 $[38,40,42,44,46,48]$，急性组计数 $[2,4,7,11,15,19]$，慢性组计数 $[3,5,8,12,16,19]$。\n  - 机械感觉模式（mN）：强度 $[50,100,150,200,250,300]$，急性组计数 $[2,5,8,12,16,19]$，慢性组计数 $[2,5,8,12,16,19]$。\n- 测试用例3（边缘情况：斜率陡峭）：\n  - 热感觉模式（°C）：强度 $[41,42,43,44,45,46]$，急性组计数 $[0,1,2,10,18,20]$，慢性组计数 $[0,2,9,17,20,20]$。\n  - 机械感觉模式（mN）：强度 $[100,120,140,160,180,200]$，急性组计数 $[0,0,2,10,17,20]$，慢性组计数 $[0,0,1,9,16,20]$。\n\n答案规范：\n\n- 每个测试用例的结果必须以上述指定的单位报告，阈值差异需四舍五入到两位小数。显著性输出必须是通过在 $\\alpha = 0.05$ 下的单侧Wald检验计算出的布尔值。\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，其顺序与上文描述完全一致。",
            "solution": "用户希望有一个程序来分析一项疼痛研究的心理计量数据，比较慢性疼痛组和急性疼痛组。我的首要任务是验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n\n- **心理计量模型**：$p(x;\\theta,s) = \\sigma\\left(\\dfrac{x - \\theta}{s}\\right)$，其中 $p$ 是在刺激强度 $x$ 下报告疼痛的概率。\n- **参数**：$\\theta$ 是阈值（$p(x)=0.5$），$s > 0$ 是斜率/尺度参数。\n- **S型函数**：逻辑斯谛函数 $\\sigma(z) = \\dfrac{1}{1+e^{-z}}$ 被指定为标准选择。\n- **每组/每种模式的数据**：刺激强度 $\\{x_i\\}$，每个强度下的试验次数 $n_i$，以及“疼痛”响应次数 $k_i$。\n- **参数估计**：对 $(\\theta, s)$ 进行最大似然估计（MLE）。\n- **对数似然函数**：$\\ell(\\theta,s) = \\sum_i \\left[k_i \\ln p(x_i;\\theta,s) + (n_i - k_i) \\ln\\left(1 - p(x_i;\\theta,s)\\right)\\right]$。\n- **参数方差**：通过在最大似然估计处的观测信息矩阵的逆来估计，该矩阵等于负对数似然函数的Hessian矩阵的逆。记为 $H^{-1} = (-\\nabla^2 \\ell)^{-1}$。阈值估计量的方差为 $\\mathrm{Var}(\\hat{\\theta}) = (H^{-1})_{11}$。\n- **比较指标**：阈值差异 $\\Delta \\theta = \\hat{\\theta}_{\\text{chronic}} - \\hat{\\theta}_{\\text{acute}}$。阈值左移意味着 $\\Delta \\theta  0$。\n- **假设检验**：针对 $H_0: \\Delta \\theta \\ge 0$ vs. $H_1: \\Delta \\theta  0$ 的单侧Wald检验，显著性水平 $\\alpha = 0.05$。\n- **检验统计量**：$z = \\dfrac{\\Delta \\theta}{\\sqrt{\\mathrm{Var}(\\hat{\\theta}_{\\text{chronic}}) + \\mathrm{Var}(\\hat{\\theta}_{\\text{acute}})}}$。\n- **p值计算**：$p = \\Phi(z)$，其中 $\\Phi$ 是标准正态累积分布函数（CDF）。\n- **显著性标准**：如果 $p  0.05$ 且 $\\Delta \\theta  0$，则为“显著左移”。\n- **单位**：热感觉 $\\Delta\\theta$ 单位为摄氏度（°C）；机械感觉 $\\Delta\\theta$ 单位为毫牛顿（mN）。\n- **四舍五入**：将 $\\Delta\\theta$ 值四舍五入到两位小数。\n- **输出格式**：一个用方括号括起来的扁平、逗号分隔列表，每个测试用例贡献四个值，顺序为：$[\\Delta \\theta_{\\text{thermal}}, S_{\\text{thermal}}, \\Delta \\theta_{\\text{mechanical}}, S_{\\text{mechanical}}]$，其中 $S$ 是表示显著性的布尔值。\n- **测试数据**：指定了三个测试用例，包含刺激强度（$x$）、急性疼痛计数（$k_{\\text{acute}}$）和慢性疼痛计数（$k_{\\text{chronic}}$），所有试验次数均为 $n_i=20$。\n\n**步骤2：使用提取的信息进行验证**\n\n- **科学依据充分**：该问题牢固地植根于标准的心理物理学方法论。使用逻辑斯谛函数进行心理计量建模、二项似然、最大似然估计以及用于假设检验的Wald检验，代表了该领域的标准方法。其科学前提——检验慢性疼痛人群中感觉阈值的改变——是医学心理学和疼痛研究中一个有效且核心的课题。\n- **良态的**：问题被精心指定。它提供了一个明确的目标、一个精确定义的数学模型（$p(x;\\theta,s)$）、一个完整的统计程序（MLE、Wald检验），以及测试用例所需的所有数据。对于每个定义的子问题，预期会有一个唯一且稳定的解。\n- **客观的**：语言技术性强、精确，没有任何主观性或偏见。\n- **缺陷分析**：\n    1. 不存在科学或事实上的不健全之处。\n    2. 问题是可形式化的，并且与所述主题直接相关。\n    3. 问题是自洽的，没有矛盾。\n    4. 提供的刺激值和响应计数对于真实实验是合理的。\n    5. 结构清晰，问题是良态的。\n    6. 问题并非微不足道；它需要实现一个不简单的数值优化和统计分析流程。\n    7. 整个过程是计算性的，因此是可验证的。\n\n**步骤3：结论与行动**\n\n问题是**有效的**。我将继续提供完整解决方案。\n\n### 解决方案\n\n该解决方案要求为每个测试用例中的每种感觉模式实现一个统计分析流程。这包括两个主要阶段：拟合心理计量函数以获得参数估计及其方差，然后对两组参数之间的差异进行假设检验。\n\n**1. 通过最大似然估计（MLE）拟合心理计量函数**\n\n对于每个数据集（例如，热感觉模式，急性组），我们必须找到最大化二项对数似然函数的参数 $(\\theta, s)$。在数值上，最小化负对数似然函数 $L(\\theta, s) = -\\ell(\\theta, s)$ 更为稳定和常规。\n\n心理计量函数为 $p(x;\\theta,s) = \\sigma(z) = (1+e^{-z})^{-1}$，其中 $z = \\frac{x-\\theta}{s}$。\n在单个刺激水平 $x_i$ 下，$n_i$ 次试验中有 $k_i$ 次成功的对数似然为：\n$$ \\ell_i = k_i \\ln(p(x_i)) + (n_i - k_i) \\ln(1 - p(x_i)) $$\n总对数似然为 $\\ell = \\sum_i \\ell_i$。为提高数值稳定性，我们可以使用 $\\sigma(z)$ 的定义重写这些项：\n$$ \\ln(p(x_i)) = \\ln(\\sigma(z_i)) = -\\ln(1+e^{-z_i}) $$\n$$ \\ln(1 - p(x_i)) = \\ln(1-\\sigma(z_i)) = \\ln(\\sigma(-z_i)) = -\\ln(1+e^{z_i}) $$\n因此，要最小化的负对数似然函数是：\n$$ L(\\theta, s) = -\\ell(\\theta, s) = \\sum_i \\left[ k_i \\ln(1+e^{-z_i}) + (n_i-k_i) \\ln(1+e^{z_i}) \\right] $$\n其中 $z_i = (x_i - \\theta)/s$。这个表达式可以使用对数加法函数（如 `logaddexp`）来稳健地实现。\n\n我们将使用一个数值优化算法，特别是 `scipy.optimize.minimize` 中实现的 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 算法，来找到最小化 $L(\\theta, s)$ 的参数 $(\\hat{\\theta}, \\hat{s})$。我们必须通过在优化器中为 $s$ 设置一个小的正下界来强制执行约束 $s > 0$。\n\n**2. 渐近方差估计**\n\nMLE估计量 $(\\hat{\\theta}, \\hat{s})$ 的渐近协方差矩阵通过观测信息矩阵 $I(\\hat{\\theta}, \\hat{s})$ 的逆来估计。问题陈述指出，这是在MLE处评估的负对数似然函数的Hessian矩阵的逆：\n$$ \\mathrm{Cov}(\\hat{\\theta}, \\hat{s}) \\approx \\left[ \\nabla^2 L(\\theta, s) \\right]^{-1}_{\\theta=\\hat{\\theta}, s=\\hat{s}} $$\n许多拟牛顿优化程序，包括 `BFGS`，在其过程中会计算此逆Hessian矩阵的近似值。我们将提取这个矩阵。阈值估计量的方差 $\\mathrm{Var}(\\hat{\\theta})$ 是这个 $2 \\times 2$ 协方差矩阵的左上角元素。\n\n**3. 假设检验**\n\n对于每种感觉模式，我们独立地将模型拟合到急性和慢性疼痛数据，得到 $(\\hat{\\theta}_{\\text{acute}}, \\mathrm{Var}(\\hat{\\theta}_{\\text{acute}}))$ 和 $(\\hat{\\theta}_{\\text{chronic}}, \\mathrm{Var}(\\hat{\\theta}_{\\text{chronic}}))$。\n\n然后我们计算阈值差异：\n$$ \\Delta \\theta = \\hat{\\theta}_{\\text{chronic}} - \\hat{\\theta}_{\\text{acute}} $$\n假设两组的估计是独立的，差异的方差是它们方差的和：\n$$ \\mathrm{Var}(\\Delta\\theta) = \\mathrm{Var}(\\hat{\\theta}_{\\text{chronic}}) + \\mathrm{Var}(\\hat{\\theta}_{\\text{acute}}) $$\n差异的标准误是 $SE_{\\Delta\\theta} = \\sqrt{\\mathrm{Var}(\\Delta\\theta)}$。\n\n对于假设 $H_0: \\Delta \\theta \\ge 0$ 对 $H_1: \\Delta \\theta  0$ 的单侧Wald检验使用检验统计量：\n$$ z = \\frac{\\Delta \\theta}{SE_{\\Delta\\theta}} $$\n假设在原假设下，统计量 $z$ 渐近服从标准正态分布，单侧p值是观测到小于或等于 $z$ 的值的概率：\n$$ p = \\Phi(z) = \\int_{-\\infty}^{z} \\frac{1}{\\sqrt{2\\pi}} e^{-t^2/2} dt $$\n其中 $\\Phi$ 是标准正态分布的累积分布函数（CDF）。\n\n如果满足两个条件，即结果方向与假设一致（$\\Delta\\theta  0$）且p值低于显著性水平（$p  \\alpha = 0.05$），则断定存在统计上显著的左移。\n\n**4. 实现**\n\n将构建一个Python程序来为三个测试用例中的每一个执行这些步骤。一个核心函数将封装模型拟合过程，返回估计的阈值 $\\hat{\\theta}$ 及其方差 $\\mathrm{Var}(\\hat{\\theta})$。主程序将遍历测试用例，为每个组和感觉模式调用拟合函数，然后执行Wald检验，并将结果——四舍五入的阈值差异和表示显著性的布尔值——格式化为最终输出所需的单个扁平列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\nfrom scipy.stats import norm\n\ndef fit_psychometric_function(stimuli, counts, trials):\n    \"\"\"\n    Fits a psychometric function to binomial data using MLE.\n\n    Args:\n        stimuli (np.ndarray): Array of stimulus intensities.\n        counts (np.ndarray): Array of 'pain' report counts.\n        trials (int or np.ndarray): Number of trials at each intensity.\n\n    Returns:\n        tuple: (theta_mle, s_mle, var_theta_mle) containing the estimated\n               threshold, slope, and variance of the threshold.\n    \"\"\"\n    stimuli = np.asarray(stimuli, dtype=float)\n    counts = np.asarray(counts, dtype=float)\n    if isinstance(trials, int):\n        trials = np.full_like(stimuli, trials, dtype=float)\n    else:\n        trials = np.asarray(trials, dtype=float)\n\n    # Define the negative log-likelihood function to be minimized.\n    # Using np.logaddexp for numerical stability.\n    # L = sum(k_i * logaddexp(0, -(x_i - theta)/s) +\n    #         (n_i - k_i) * logaddexp(0, (x_i - theta)/s))\n    def neg_log_likelihood(params):\n        theta, s = params\n        s = max(s, 1e-9) # Prevent s from becoming zero or negative\n        \n        # Calculate z = (x - theta) / s\n        z = (stimuli - theta) / s\n        \n        # Use np.logaddexp for robust computation of log(1+exp(z))\n        term1 = counts * np.logaddexp(0, -z)\n        term2 = (trials - counts) * np.logaddexp(0, z)\n        \n        return np.sum(term1 + term2)\n\n    # Initial guess for parameters\n    # Heuristic: theta is the stimulus level where proportion is closest to 0.5\n    proportions = counts / trials\n    theta_initial_idx = np.argmin(np.abs(proportions - 0.5))\n    theta_initial = stimuli[theta_initial_idx]\n    s_initial = np.std(stimuli)\n    \n    initial_params = [theta_initial, s_initial]\n    \n    # Define bounds for parameters: s > 0\n    bounds = [(None, None), (1e-6, None)]\n\n    # Perform minimization using L-BFGS-B which handles bounds\n    # and provides an approximation of the inverse Hessian.\n    result = minimize(\n        neg_log_likelihood,\n        initial_params,\n        method='L-BFGS-B',\n        bounds=bounds\n    )\n    \n    theta_mle, s_mle = result.x\n    \n    # The result object's 'hess_inv' is an LbfgsInvHessProduct object.\n    # We convert it to a dense matrix to get the covariance matrix.\n    # This is an approximation of the inverse of the Hessian of the\n    # negative log-likelihood, which is the covariance matrix of parameters.\n    cov_matrix = result.hess_inv.todense()\n    var_theta_mle = cov_matrix[0, 0]\n\n    return theta_mle, s_mle, var_theta_mle\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and generate the final output.\n    \"\"\"\n    alpha = 0.05\n    \n    test_cases = [\n        # Test Case 1 (happy path)\n        {\n            \"thermal\": {\"intensities\": [38, 40, 42, 44, 46, 48], \"acute_counts\": [1, 3, 6, 10, 15, 18], \"chronic_counts\": [4, 7, 11, 16, 19, 20]},\n            \"mechanical\": {\"intensities\": [50, 100, 150, 200, 250, 300], \"acute_counts\": [1, 3, 5, 9, 14, 18], \"chronic_counts\": [3, 7, 10, 15, 18, 20]}\n        },\n        # Test Case 2 (boundary-case small differences)\n        {\n            \"thermal\": {\"intensities\": [38, 40, 42, 44, 46, 48], \"acute_counts\": [2, 4, 7, 11, 15, 19], \"chronic_counts\": [3, 5, 8, 12, 16, 19]},\n            \"mechanical\": {\"intensities\": [50, 100, 150, 200, 250, 300], \"acute_counts\": [2, 5, 8, 12, 16, 19], \"chronic_counts\": [2, 5, 8, 12, 16, 19]}\n        },\n        # Test Case 3 (edge-case steep slopes)\n        {\n            \"thermal\": {\"intensities\": [41, 42, 43, 44, 45, 46], \"acute_counts\": [0, 1, 2, 10, 18, 20], \"chronic_counts\": [0, 2, 9, 17, 20, 20]},\n            \"mechanical\": {\"intensities\": [100, 120, 140, 160, 180, 200], \"acute_counts\": [0, 0, 2, 10, 17, 20], \"chronic_counts\": [0, 0, 1, 9, 16, 20]}\n        }\n    ]\n    \n    trials_per_intensity = 20\n    final_results = []\n    \n    for case in test_cases:\n        for modality in [\"thermal\", \"mechanical\"]:\n            data = case[modality]\n            x = data[\"intensities\"]\n            \n            # Fit acute group data\n            k_acute = data[\"acute_counts\"]\n            theta_acute, _, var_theta_acute = fit_psychometric_function(x, k_acute, trials_per_intensity)\n            \n            # Fit chronic group data\n            k_chronic = data[\"chronic_counts\"]\n            theta_chronic, _, var_theta_chronic = fit_psychometric_function(x, k_chronic, trials_per_intensity)\n            \n            # Calculate threshold difference\n            delta_theta = theta_chronic - theta_acute\n            \n            # Perform one-sided Wald test\n            var_delta_theta = var_theta_acute + var_theta_chronic\n            se_delta_theta = np.sqrt(var_delta_theta)\n            \n            # Avoid division by zero if SE is zero (e.g., perfect fit)\n            if se_delta_theta > 0:\n                z_stat = delta_theta / se_delta_theta\n                p_value = norm.cdf(z_stat)\n            else:\n                # If SE is 0, difference is certain. p=0 if delta0, p=1 if delta>0.\n                p_value = 0.0 if delta_theta  0 else 1.0\n\n            # Judge significance: must be a leftward shift AND p  alpha\n            is_significant = (p_value  alpha) and (delta_theta  0)\n            \n            # Append results for the modality\n            final_results.append(round(delta_theta, 2))\n            final_results.append(is_significant)\n            \n    # Print the final aggregated list in the specified format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在观察到慢性疼痛中的感觉超敏现象后，一个自然的问题是：其背后的中枢神经系统机制是什么？本练习聚焦于“条件性疼痛调节”（Conditioned Pain Modulation, CPM），它反映了大脑下行抑制系统“以痛止痛”的能力。通过计算和比较急性和慢性疼痛组的CPM分数，你将具体地理解下行抑制通路功能障碍是如何在慢性疼痛中体现的，这为我们提供了超越单纯症状描述的生理学视角。",
            "id": "4708771",
            "problem": "一项心理物理学研究考察了两组人群的条件性疼痛调节（Conditioned Pain Modulation, CPM）：一组是经历实验性诱发急性疼痛的个体（健康志愿者；$\\text{A}$组），另一组是临床诊断为慢性下背痛的个体（$\\text{C}$组）。每位参与者在两个时间点，使用$0$到$100$的数字评定量表对标准化测试刺激的感知疼痛强度进行评分：一次在基线状态下（无条件性刺激），一次在同时经历一个独立的条件性疼痛刺激时。条件性疼痛调节（CPM）被定义为在条件性刺激下感知到的疼痛减轻，其操作化定义为$\\text{CPM}=\\text{基线}-\\text{条件性}$。$\\text{CPM}$的正值表示下行抑制性控制的参与。\n\n我们为您提供了每组$5$名参与者的基线和条件性评级。所有数值均为$0$到$100$量表上的评级分数。\n\n- $\\text{A}$组（急性）：\n  - $\\text{A1}$：基线 $62$，条件性 $43$\n  - $\\text{A2}$：基线 $58$，条件性 $46$\n  - $\\text{A3}$：基线 $65$，条件性 $50$\n  - $\\text{A4}$：基线 $60$，条件性 $47$\n  - $\\text{A5}$：基线 $64$，条件性 $48$\n\n- $\\text{C}$组（慢性）：\n  - $\\text{C1}$：基线 $63$，条件性 $58$\n  - $\\text{C2}$：基线 $61$，条件性 $57$\n  - $\\text{C3}$：基线 $59$，条件性 $56$\n  - $\\text{C4}$：基线 $66$，条件性 $62$\n  - $\\text{C5}$：基线 $60$，条件性 $58$\n\n仅使用$\\text{CPM}$的定义以及“较低的$\\text{CPM}$反映了下行抑制性回路受损”这一解释，计算组间CPM差异，定义为\n$$\n\\Delta_{\\text{CPM}}=\\overline{\\text{CPM}}_{\\text{A}}-\\overline{\\text{CPM}}_{\\text{C}},\n$$\n其中$\\overline{\\text{CPM}}_{\\text{A}}$和$\\overline{\\text{CPM}}_{\\text{C}}$分别表示$\\text{A}$组和$\\text{C}$组参与者的CPM算术平均值。请以评级分数报告$\\Delta_{\\text{CPM}}$的最终值，并四舍五入到四位有效数字。您的最终答案必须是一个实数。",
            "solution": "问题陈述已经过评估，被认为是有效的。它在科学上植根于心理物理学和疼痛研究的原理，特别是条件性疼痛调节（CPM）范式。问题提法得当，提供了所有必要的数据和对待计算量的清晰、明确的操作性定义。语言客观，数据完整且一致。\n\n目标是计算条件性疼痛调节的组间差异，定义为 $\\Delta_{\\text{CPM}}=\\overline{\\text{CPM}}_{\\text{A}}-\\overline{\\text{CPM}}_{\\text{C}}$。这需要三步计算：\n$1$. 计算两组中每位参与者的CPM分数。\n$2$. 计算每组CPM分数的算术平均值（$\\overline{\\text{CPM}}_{\\text{A}}$ 和 $\\overline{\\text{CPM}}_{\\text{C}}$）。\n$3$. 计算两个组均值之间的差异。\n\n单个参与者的CPM定义为 $\\text{CPM}=\\text{基线}-\\text{条件性}$。\n\n首先，我们计算$\\text{A}$组（急性疼痛）中$n_{\\text{A}}=5$位参与者中每一位的CPM分数。设$\\text{CPM}_{\\text{A},i}$表示$\\text{A}$组第$i$位参与者的CPM分数。\n- 对于参与者$\\text{A1}$：$\\text{CPM}_{\\text{A},1} = 62 - 43 = 19$。\n- 对于参与者$\\text{A2}$：$\\text{CPM}_{\\text{A},2} = 58 - 46 = 12$。\n- 对于参与者$\\text{A3}$：$\\text{CPM}_{\\text{A},3} = 65 - 50 = 15$。\n- 对于参与者$\\text{A4}$：$\\text{CPM}_{\\text{A},4} = 60 - 47 = 13$。\n- 对于参与者$\\text{A5}$：$\\text{CPM}_{\\text{A},5} = 64 - 48 = 16$。\n\n接着，我们计算$\\text{A}$组这些分数的算术平均值$\\overline{\\text{CPM}}_{\\text{A}}$。\n$$\n\\overline{\\text{CPM}}_{\\text{A}} = \\frac{1}{n_{\\text{A}}} \\sum_{i=1}^{n_{\\text{A}}} \\text{CPM}_{\\text{A},i} = \\frac{19 + 12 + 15 + 13 + 16}{5}\n$$\n分数之和为 $19 + 12 + 15 + 13 + 16 = 75$。\n$$\n\\overline{\\text{CPM}}_{\\text{A}} = \\frac{75}{5} = 15\n$$\n\n其次，我们对$\\text{C}$组（慢性疼痛）中的$n_{\\text{C}}=5$位参与者重复此过程。设$\\text{CPM}_{\\text{C},i}$表示$\\text{C}$组第$i$位参与者的CPM分数。\n- 对于参与者$\\text{C1}$：$\\text{CPM}_{\\text{C},1} = 63 - 58 = 5$。\n- 对于参与者$\\text{C2}$：$\\text{CPM}_{\\text{C},2} = 61 - 57 = 4$。\n- 对于参与者$\\text{C3}$：$\\text{CPM}_{\\text{C},3} = 59 - 56 = 3$。\n- 对于参与者$\\text{C4}$：$\\text{CPM}_{\\text{C},4} = 66 - 62 = 4$。\n- 对于参与者$\\text{C5}$：$\\text{CPM}_{\\text{C},5} = 60 - 58 = 2$。\n\n接着，我们计算$\\text{C}$组这些分数的算术平均值$\\overline{\\text{CPM}}_{\\text{C}}$。\n$$\n\\overline{\\text{CPM}}_{\\text{C}} = \\frac{1}{n_{\\text{C}}} \\sum_{i=1}^{n_{\\text{C}}} \\text{CPM}_{\\text{C},i} = \\frac{5 + 4 + 3 + 4 + 2}{5}\n$$\n分数之和为 $5 + 4 + 3 + 4 + 2 = 18$。\n$$\n\\overline{\\text{CPM}}_{\\text{C}} = \\frac{18}{5} = 3.6\n$$\n\n最后，我们通过从$\\text{A}$组的均值中减去$\\text{C}$组的均值来计算组间CPM差异$\\Delta_{\\text{CPM}}$。\n$$\n\\Delta_{\\text{CPM}} = \\overline{\\text{CPM}}_{\\text{A}} - \\overline{\\text{CPM}}_{\\text{C}} = 15 - 3.6 = 11.4\n$$\n问题要求最终值四舍五入到四位有效数字。计算出的值$11.4$有三位有效数字。为表示为四位有效数字，我们在末尾加一个零，得到$11.40$。与问题陈述一致的解释是，慢性疼痛组表现出显著较低的CPM效应，表明与健康的急性疼痛组相比，其下行抑制性控制受损。",
            "answer": "$$\\boxed{11.40}$$"
        },
        {
            "introduction": "急性疼痛向慢性疼痛的转变是一个复杂的过程，受到多种生物-心理-社会因素的影响。本练习将介绍一种强大的统计建模方法——生存分析，用于研究疼痛慢性化的风险。通过构建并比较具有不同心理风险因素（如疼痛灾难化和抑郁）的患者画像的风险函数（hazard function），你将学会如何量化这些因素对疼痛转变轨迹的动态影响，这对于临床风险评估和早期干预至关重要。",
            "id": "4708738",
            "problem": "在医学心理学中，从急性疼痛到慢性疼痛的转变可以表示为一个事件发生时间过程，其中事件定义为从急性状态跨越到慢性状态（例如，疼痛在临床上持续超过 $12$ 周）。令 $T$ 表示个体转变为慢性疼痛的随机时间，生存函数为 $S(t) = \\Pr(T > t)$，表示个体在时间 $t$ 仍然处于急性状态的概率。风险函数 $h(t)$ 是指在时间 $t$ 尚未转变的条件下，在时间 $t$ 发生转变的瞬时速率，其形式化定义为 $h(t) = -\\frac{d}{dt}\\ln S(t)$。\n\n假设支配早期炎症反应和后期恢复的生物心理社会过程产生了一个单峰基线风险，其形式为 $h_{0}(t) = \\alpha\\, t\\, \\exp(-\\gamma t)$，其中 $\\alpha > 0$ 且 $\\gamma > 0$。该函数捕捉了早期风险升高随后下降的特点。进一步假设，心理和行为风险因素通过对数线性映射（Cox比例风险模型，CPH）以乘法方式作用于瞬时风险，其中协变量为标准化的疼痛灾难化（$x_{C}$）、标准化的抑郁症状（$x_{D}$）和阿片类药物暴露指标（$x_{O} \\in \\{0,1\\}$），其系数分别为 $\\beta_{C}$、$\\beta_{D}$ 和 $\\beta_{O}$。\n\n设时间 $t$ 的单位为周，风险的单位为每周。使用以下参数值：$\\alpha = 0.18$，$\\gamma = 0.30$，$\\beta_{C} = 0.60$，$\\beta_{D} = 0.40$ 和 $\\beta_{O} = 0.80$。\n\n根据CPH假设，从 $h(t)$ 和生存函数的定义出发，依据第一性原理，为以下三种风险概况推导出明确的风险函数 $h_{A}(t)$、$h_{B}(t)$ 和 $h_{C}(t)$：\n- 概况 A（恢复力强者）：$x_{C} = 0$，$x_{D} = 0$，$x_{O} = 0$，\n- 概况 B（高度灾难化，中度抑郁，有阿片类药物暴露）：$x_{C} = 1.5$，$x_{D} = 1.0$，$x_{O} = 1$，\n- 概况 C（中度灾难化，高度抑郁，无阿片类药物暴露）：$x_{C} = 0.5$，$x_{D} = 2.0$，$x_{O} = 0$。\n\n将你的最终答案表示为一个单行矩阵，其中包含三个风险函数，每个函数都是关于 $t$ 的闭式解析表达式。无需四舍五入。以每周为单位说明风险，但不要在最终的方框表达式中包含单位。",
            "solution": "该问题要求在Cox比例风险（CPH）模型的框架内，为三种患者概况推导特定的风险函数。对问题陈述的验证证实了其科学性、适定性、客观性，并包含了推导唯一解所需的所有必要信息。\n\n问题陈述包含了风险函数的基本定义，$h(t) = - \\frac{d}{dt} \\ln S(t)$，其中 $S(t)$ 是生存函数。然而，解答过程直接从CPH模型的结构出发，该模型为 $h(t)$ 提供了一个具体形式。CPH模型假定，具有协变量向量 $\\mathbf{x}$ 的个体的风险函数与基线风险函数 $h_0(t)$ 成正比。其关系由下式给出：\n$$h(t; \\mathbf{x}) = h_0(t) \\exp(\\boldsymbol{\\beta}^T \\mathbf{x})$$\n其中 $\\boldsymbol{\\beta}$ 是与协变量对应的系数向量。\n\n在本问题中，协变量是疼痛灾难化（$x_{C}$）、抑郁症状（$x_{D}$）和阿片类药物暴露（$x_{O}$）。因此，风险函数为：\n$$h(t) = h_0(t) \\exp(\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O})$$\n项 $\\exp(\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O})$ 是风险比（HR），它是一个常数乘数，根据个体的风险因素概况来缩放基线风险。\n\n基线风险函数给定为：\n$$h_{0}(t) = \\alpha t \\exp(-\\gamma t)$$\n将这些结合起来，得到给定协变量集的完整风险模型：\n$$h(t) = \\left( \\alpha t \\exp(-\\gamma t) \\right) \\exp(\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O})$$\n这可以重排为一个更方便的形式：\n$$h(t) = \\alpha \\exp(\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O}) \\, t \\exp(-\\gamma t)$$\n\n问题提供了以下参数值，所有单位均兼容（时间单位为周，风险单位为每周）：\n$\\alpha = 0.18$\n$\\gamma = 0.30$\n$\\beta_{C} = 0.60$\n$\\beta_{D} = 0.40$\n$\\beta_{O} = 0.80$\n\n现在我们通过将各自的协变量值代入通用模型，来为三个指定的风险概况推导明确的风险函数。\n\n**概况 A（恢复力强者）：**\n此概况的协变量为 $x_{C} = 0$，$x_{D} = 0$ 和 $x_{O} = 0$。\n指数中的线性组合，代表对数风险比，为：\n$$\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O} = (0.60)(0) + (0.40)(0) + (0.80)(0) = 0$$\n风险比为 $\\exp(0) = 1$。\n因此，概况 A 的风险函数 $h_{A}(t)$ 与基线风险函数相同：\n$$h_{A}(t) = h_{0}(t) = \\alpha t \\exp(-\\gamma t)$$\n代入给定的 $\\alpha$ 和 $\\gamma$ 值：\n$$h_{A}(t) = 0.18 t \\exp(-0.30 t)$$\n\n**概况 B（高度灾难化，中度抑郁，有阿片类药物暴露）：**\n此概况的协变量为 $x_{C} = 1.5$，$x_{D} = 1.0$ 和 $x_{O} = 1$。\n指数中的线性组合为：\n$$\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O} = (0.60)(1.5) + (0.40)(1.0) + (0.80)(1)$$\n$$= 0.90 + 0.40 + 0.80 = 2.10$$\n风险比为 $\\exp(2.10)$。\n概况 B 的风险函数 $h_{B}(t)$ 是基线风险乘以该因子：\n$$h_{B}(t) = h_{0}(t) \\exp(2.10) = (\\alpha t \\exp(-\\gamma t)) \\exp(2.10)$$\n代入 $\\alpha$ 和 $\\gamma$ 的值并整理各项得：\n$$h_{B}(t) = 0.18 \\exp(2.10) t \\exp(-0.30 t)$$\n\n**概况 C（中度灾难化，高度抑郁，无阿片类药物暴露）：**\n此概况的协变量为 $x_{C} = 0.5$，$x_{D} = 2.0$ 和 $x_{O} = 0$。\n指数中的线性组合为：\n$$\\beta_{C} x_{C} + \\beta_{D} x_{D} + \\beta_{O} x_{O} = (0.60)(0.5) + (0.40)(2.0) + (0.80)(0)$$\n$$= 0.30 + 0.80 + 0 = 1.10$$\n风险比为 $\\exp(1.10)$。\n概况 C 的风险函数 $h_{C}(t)$ 是基线风险乘以该因子：\n$$h_{C}(t) = h_{0}(t) \\exp(1.10) = (\\alpha t \\exp(-\\gamma t)) \\exp(1.10)$$\n代入 $\\alpha$ 和 $\\gamma$ 的值并整理各项得：\n$$h_{C}(t) = 0.18 \\exp(1.10) t \\exp(-0.30 t)$$\n\n这三个表达式为指定风险概况对应的风险函数提供了闭式解析解。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.18 t \\exp(-0.30 t)  0.18 \\exp(2.10) t \\exp(-0.30 t)  0.18 \\exp(1.10) t \\exp(-0.30 t) \\end{pmatrix}}\n$$"
        }
    ]
}