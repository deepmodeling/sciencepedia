{
    "hands_on_practices": [
        {
            "introduction": "肌肉产生力量的能力从根本上取决于其所有肌纤维的总横截面积，即生理横截面积（$PCSA$）。本练习将指导你如何从肌肉质量和肌纤维长度等基本解剖学测量值来估算$PCSA$，并由此预测其最大的等长收缩力 。这个实践将宏观解剖结构与生物力学功能联系起来，是理解肌肉功能的基础。",
            "id": "5149885",
            "problem": "一个单羽状骨骼肌通过其远端肌腱连接到关节另一侧的骨骼上。肌束以相对于肌腱作用线的平均羽状角 $\\theta=15^\\circ$ 插入肌腱。切除的湿肌质量为 $m=120\\ \\mathrm{g}$，肌肉组织密度为 $\\rho=1060\\ \\mathrm{kg/m^3}$。在原位测量的平均肌束长度为 $l_f=9\\ \\mathrm{cm}$。假设该肌肉处于等长收缩的最佳长度。设肌肉的最大比张力（沿肌纤维方向的峰值等长应力）为 $\\sigma=30\\ \\mathrm{N/cm^2}$。\n\n使用基于系统解剖学和肌肉结构的基本原理和定义，确定：\n1. 生理横截面积（PCSA），定义为肌肉中所有肌纤维横截面积的总和。\n2. 沿肌肉作用线预测的最大等长肌腱力 $F_{iso}$。\n\n假设：\n- 肌肉密度是均匀的，测得的质量对应于活性肌肉组织。\n- 肌束的长度近似均匀，其体积可以通过肌纤维长度与PCSA相关联。\n- 肌腱与作用线对齐，并且从肌纤维到肌腱的力传递遵循基于羽状角的几何投影。\n\n将PCSA以平方厘米（$\\mathrm{cm^2}$）表示，将 $F_{iso}$ 以牛顿（$\\mathrm{N}$）表示。在任何三角计算中使用角度的度数单位。将两个最终量四舍五入到三位有效数字。",
            "solution": "目标是基于肌肉结构的基本定义和基本物理关系，计算生理横截面积（PCSA）和最大等长肌腱力 $F_{iso}$。\n\n基本依据：\n1. 质量-密度关系：肌肉体积 $V$ 满足 $V = \\frac{m}{\\rho}$，其中 $m$ 是质量，$\\rho$ 是密度。\n2. PCSA的定义：PCSA是所有肌纤维横截面积的总和。对于肌纤维长度 $l_f$ 近似均匀的肌肉，其体积 $V$ 可以表示为 $V = (\\text{肌纤维面积总和}) \\times l_f = PCSA \\times l_f$。因此，\n   $$PCSA = \\frac{V}{l_f} = \\frac{m}{\\rho\\,l_f}.$$\n3. 最大比张力：在最大等长收缩下，所有肌纤维的总力为 $F_{\\text{fibers}} = \\sigma \\times PCSA$，其中 $\\sigma$ 是沿肌纤维方向的峰值等长应力。\n4. 羽状几何：肌纤维力与肌腱轴不共线。沿肌腱方向的肌纤维力分量因乘以羽状角 $\\theta$ 的余弦而减小。因此，肌腱力为\n   $$F_{iso} = F_{\\text{fibers}} \\cos(\\theta) = \\sigma \\cdot PCSA \\cdot \\cos(\\theta).$$\n\n步骤1：根据质量和密度计算体积 $V$。\n将质量转换为千克以匹配密度单位：\n$$m = 120\\ \\mathrm{g} = 0.12\\ \\mathrm{kg}.$$\n已知 $\\rho = 1060\\ \\mathrm{kg/m^3}$，肌肉体积为\n$$V = \\frac{m}{\\rho} = \\frac{0.12}{1060}\\ \\mathrm{m^3} = 1.1320754717 \\times 10^{-4}\\ \\mathrm{m^3}.$$\n\n步骤2：根据体积和肌纤维长度计算 $PCSA$。\n将肌纤维长度转换为米：\n$$l_f = 9\\ \\mathrm{cm} = 0.09\\ \\mathrm{m}.$$\n然后，\n$$PCSA_{\\mathrm{m^2}} = \\frac{V}{l_f} = \\frac{1.1320754717 \\times 10^{-4}\\ \\mathrm{m^3}}{0.09\\ \\mathrm{m}} = 1.257861635 \\times 10^{-3}\\ \\mathrm{m^2}.$$\n使用 $1\\ \\mathrm{m^2} = 10^{4}\\ \\mathrm{cm^2}$ 转换为平方厘米：\n$$PCSA_{\\mathrm{cm^2}} = 1.257861635 \\times 10^{-3}\\ \\mathrm{m^2} \\times 10^{4}\\ \\frac{\\mathrm{cm^2}}{\\mathrm{m^2}} = 12.57861635\\ \\mathrm{cm^2}.$$\n\n步骤3：使用 $\\sigma$ 和羽状角计算 $F_{iso}$。\n我们使用单位为 $\\mathrm{N/cm^2}$ 的 $\\sigma$ 和单位为 $\\mathrm{cm^2}$ 的 $PCSA$ 直接得到牛顿，并使用角度（以度为单位）的余弦值：\n$$F_{iso} = \\sigma \\cdot PCSA_{\\mathrm{cm^2}} \\cdot \\cos(15^\\circ) = 30\\ \\frac{\\mathrm{N}}{\\mathrm{cm^2}} \\times 12.57861635\\ \\mathrm{cm^2} \\times \\cos(15^\\circ).$$\n计算中间乘积：\n$$30 \\times 12.57861635 = 377.3584905\\ \\mathrm{N}.$$\n使用 $\\cos(15^\\circ) \\approx 0.9659258263$，我们得到\n$$F_{iso} \\approx 377.3584905\\ \\mathrm{N} \\times 0.9659258263 = 364.5003\\ \\mathrm{N}.$$\n\n步骤4：应用四舍五入指令。\n- $PCSA$：$12.57861635\\ \\mathrm{cm^2}$ 四舍五入到三位有效数字是 $12.6\\ \\mathrm{cm^2}$。\n- $F_{iso}$：$364.5003\\ \\mathrm{N}$ 四舍五入到三位有效数字是 $365\\ \\mathrm{N}$。\n\n因此，最终结果是 $PCSA = 12.6\\ \\mathrm{cm^2}$ 和 $F_{iso} = 365\\ \\mathrm{N}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}12.6  365\\end{pmatrix}}$$"
        },
        {
            "introduction": "肌肉产生的力通过力矩来使关节发生旋转。力矩不仅取决于肌肉本身的力量，还取决于其附着点的几何结构，特别是力臂的大小 。本练习旨在通过一个简化的思想实验，让你清晰地看到即使在肌肉力量恒定的假设下，力臂随关节角度的变化如何决定了关节能够产生的峰值力矩以及发生峰值力矩的角度。",
            "id": "5149869",
            "problem": "使用肘屈肌-肌腱单元的单室模型来研究骨骼肌结构和附着几何如何决定关节力矩。肌肉的附着方式使其绕肘关节的垂直力臂随着作用线几何的变化和包裹效应而随肘角平滑变化。设肘屈曲角为 $\\theta$（单位为弧度），其生理范围为 $0 \\le \\theta \\le \\pi$。测得的力臂作为角度的函数由 $r(\\theta)=0.035+0.005\\sin\\theta$（单位为米）给出，这反映了一个基线骨杠杆距离以及由于解剖路径变化引起的正弦调制。假设在测试的关节姿势下，肌肉可以产生一个恒定的、与角度无关的最大等长力 $F_{\\mathrm{iso}}=1500\\ \\mathrm{N}$，因为通过实验调整，肌纤维被保持在其最佳长度附近。\n\n仅从关节力矩是力绕支点的力矩的定义以及等长条件（无关节角加速度）出发，推导该肌肉-关节系统的力矩-角度关系，并确定：\n- 在 $0 \\le \\theta \\le \\pi$ 范围内的峰值等长关节力矩，以及\n- 出现该峰值力矩时的关节角（单位为弧度）。\n\n最终力矩以 $\\mathrm{N\\cdot m}$ 为单位，角度以弧度为单位表示。无需四舍五入；请报告精确值。",
            "solution": "关节力矩 $\\tau$ 是力 $F$ 与其力臂 $r$ 的乘积：$\\tau = F \\times r$。在本题中，肌肉力是恒定的 $F_{\\mathrm{iso}} = 1500\\ \\mathrm{N}$，力臂是关节角度 $\\theta$ 的函数 $r(\\theta) = 0.035 + 0.005\\sin\\theta$。因此，力矩-角度关系为：\n$$ \\tau(\\theta) = F_{\\mathrm{iso}} \\cdot r(\\theta) = 1500 \\cdot (0.035 + 0.005\\sin\\theta) $$\n$$ \\tau(\\theta) = 52.5 + 7.5\\sin\\theta $$\n\n为了找到峰值力矩，我们需要在给定的生理范围 $0 \\le \\theta \\le \\pi$ 内找到函数 $\\tau(\\theta)$ 的最大值。因为 $\\tau(\\theta)$ 是 $\\sin\\theta$ 的一个正线性函数，所以其最大值将在 $\\sin\\theta$ 达到最大值时出现。\n\n在区间 $[0, \\pi]$ 上，$\\sin\\theta$ 的最大值为 $1$，这发生在 $\\theta = \\frac{\\pi}{2}$ 弧度时。\n\n我们也可以通过微积分来验证。首先，求导数并将其设为零以找到临界点：\n$$ \\frac{d\\tau}{d\\theta} = \\frac{d}{d\\theta}(52.5 + 7.5\\sin\\theta) = 7.5\\cos\\theta $$\n$$ 7.5\\cos\\theta = 0 \\implies \\cos\\theta = 0 $$\n在定义域 $0 \\le \\theta \\le \\pi$ 内，唯一的解是 $\\theta = \\frac{\\pi}{2}$。\n\n二阶导数 $\\frac{d^2\\tau}{d\\theta^2} = -7.5\\sin\\theta$。在 $\\theta = \\frac{\\pi}{2}$ 时，二阶导数为 $-7.5$，因为二阶导数为负，所以该点是一个局部最大值。\n\n通过在临界点和区间端点评估函数值来确定绝对最大值：\n- $\\tau(0) = 52.5 + 7.5\\sin(0) = 52.5\\ \\mathrm{N\\cdot m}$\n- $\\tau(\\frac{\\pi}{2}) = 52.5 + 7.5\\sin(\\frac{\\pi}{2}) = 52.5 + 7.5 = 60\\ \\mathrm{N\\cdot m}$\n- $\\tau(\\pi) = 52.5 + 7.5\\sin(\\pi) = 52.5 + 0 = 52.5\\ \\mathrm{N\\cdot m}$\n\n比较这些值，峰值力矩为 $60\\ \\mathrm{N\\cdot m}$，发生在关节角为 $\\frac{\\pi}{2}$ 弧度时。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  \\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的生物系统中，肌肉的力臂及其自身的力量输出都会随着关节角度的变化而变化。这个高阶练习将简单的计算提升到了综合计算建模的层面 。你将学习如何整合离散的解剖学测量数据和一个符合生理的力-角度关系模型，从而预测肌肉在整个运动范围内的完整力矩曲线，这反映了现代生物力学研究中的一种重要方法。",
            "id": "5149902",
            "problem": "您将获得作为关节角度函数的肌肉骨骼力臂的离散测量值，以及一个肌肉力随关节角度变化的模型。从系统解剖学和经典力学的基本定义出发，推导出一个在运动范围 (ROM) 内预测关节力矩的原则性方法，然后将其实现为一个完整的程序。运动范围 (ROM) 是指所研究关节在解剖学上允许的关节角度集合。力臂定义为从肌肉力的作用线到关节中心的垂直距离。由肌肉产生的关节力矩大小由位置向量和力向量的叉积定义，得出标量恒等式 $|\\tau(\\theta)| = |r(\\theta)|\\,|F(\\theta)|\\,\\sin(\\phi)$，其中 $\\phi$ 是力臂向量和力向量之间的夹角。在将力臂 $r(\\theta)$ 定义为垂直距离的标准解剖学定义中，$\\phi = \\pi/2$，因此 $\\sin(\\phi) = 1$，这使得在单一平面内的屈曲或伸展运动的力矩大小简化为 $\\tau(\\theta) = F(\\theta)\\,r(\\theta)$。您的任务是为作为角度函数的测量值 $r(\\theta)$ 拟合一个多项式模型，然后为给定的 $F(\\theta)$ 计算整个运动范围内的力矩曲线，并最终报告峰值力矩。\n\n使用以下基本依据：\n- 采用力臂垂直距离定义的力矩大小恒等式：$\\tau(\\theta) = F(\\theta)\\,r(\\theta)$。\n- 最小二乘多项式拟合原理：给定样本 $\\{(\\theta_i, r_i)\\}_{i=1}^{m}$ 和选定的阶数 $n$，找到系数 $\\{a_k\\}_{k=0}^{n}$ 以最小化 $\\sum_{i=1}^{m}\\left[r_i - \\sum_{k=0}^{n} a_k\\,\\theta_i^k\\right]^2$，从而构建模型 $r(\\theta) \\approx \\sum_{k=0}^{n} a_k\\,\\theta^k$。\n- 一个经过充分检验的、依赖于角度的肌肉力大小描述性模型，该模型基于以最佳长度-张力关系对应的角度为中心的高斯分布曲线：$F(\\theta) = F_{\\max}\\,\\exp\\!\\left(-\\dfrac{(\\theta - \\theta_{\\mathrm{opt}})^2}{2\\,\\sigma^2}\\right)$。\n\n实现以下算法要求：\n1. 为进行计算，将所有角度从度转换为弧度。在下面的描述或列表中报告角度时，单位是度；程序内部必须转换为弧度。使用 $\\pi$ 进行转换。\n2. 对提供的 $(\\theta_i, r_i)$ 数据对，通过最小二乘法拟合一个指定阶数 $n$ 的多项式。自变量是角度 $\\theta$（单位为弧度），因变量是力臂 $r(\\theta)$（单位为米）。\n3. 通过将预测的力臂在所有评估角度上限制为非负值来强制实现物理真实性，即使用 $r_{\\mathrm{pred}}(\\theta) \\leftarrow \\max\\{0, r_{\\mathrm{pred}}(\\theta)\\}$。\n4. 使用高斯分布曲线及参数 $F_{\\max}$（牛顿）、$\\theta_{\\mathrm{opt}}$（弧度）和 $\\sigma$（弧度）来评估 $F(\\theta)$。\n5. 使用步长为 $1^\\circ$ 的均匀角度网格（内部转换为弧度），计算整个运动范围内的力矩曲线 $\\tau(\\theta) = F(\\theta)\\,r_{\\mathrm{pred}}(\\theta)$。\n6. 对于每个测试用例，返回整个运动范围内的峰值力矩值。\n7. 最终的力矩答案以牛顿米 $(\\mathrm{N\\cdot m})$ 为单位表示，并四舍五入到 $3$ 位小数。\n\n测试套件和参数（每个用例都是独立的，应按顺序处理）：\n- 用例 $1$（肘屈肌）：角度（度）$\\{20, 40, 60, 80, 100, 120, 140\\}$；力臂（米）$\\{0.020, 0.035, 0.042, 0.045, 0.042, 0.035, 0.025\\}$；运动范围（度）$[20, 140]$；多项式阶数 $n=3$；高斯力模型参数 $F_{\\max} = 800$ 牛顿，$\\theta_{\\mathrm{opt}} = 90^\\circ$，$\\sigma = 25^\\circ$。\n- 用例 $2$（膝伸肌）：角度（度）$\\{0, 30, 60, 90, 120\\}$；力臂（米）$\\{0.045, 0.048, 0.050, 0.047, 0.040\\}$；运动范围（度）$[0, 120]$；多项式阶数 $n=3$；高斯力模型参数 $F_{\\max} = 3000$ 牛顿，$\\theta_{\\mathrm{opt}} = 45^\\circ$，$\\sigma = 30^\\circ$。\n- 用例 $3$（肩外展肌，在狭窄运动范围内的力臂近似恒定）：角度（度）$\\{10, 30, 50\\}$；力臂（米）$\\{0.030, 0.030, 0.030\\}$；运动范围（度）$[10, 50]$；多项式阶数 $n=1$；高斯力模型参数 $F_{\\max} = 1200$ 牛顿，$\\theta_{\\mathrm{opt}} = 30^\\circ$，$\\sigma = 10^\\circ$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3]$），其中每个 $result_i$ 是相应测试用例的峰值力矩，以 $\\mathrm{N\\cdot m}$ 为单位，并四舍五入到 $3$ 位小数。\n\n角度单位说明：测试套件中提供的所有角度都以度为单位；在内部计算时，需转换为弧度。角度网格步长为 $1^\\circ$。\n\n物理单位说明：以 $\\mathrm{N\\cdot m}$ 为单位报告力矩，并四舍五入到 $3$ 位小数。\n\n覆盖性设计：\n- 用例 $1$ 是一个通用场景，其力臂呈单峰形态，在运动范围中点附近达到峰值。\n- 用例 $2$ 具有更高的力输出能力，并且在更宽的运动范围内力臂有轻微变化。\n- 用例 $3$ 测试了对近似恒定力臂和狭窄力曲线的处理，采用了最小多项式阶数和稀疏数据，以确保边界条件行为和非负性限制的正确性。",
            "solution": "问题陈述经严格验证，是适定的、有科学依据且自洽的。它基于系统解剖学和经典力学的既有概念，为模拟肌肉骨骼力矩的产生提供了一个清晰、有原则的框架。\n\n该问题要求推导并实现一种计算方法，以预测作为关节角度 $\\theta$ 函数的关节力矩 $\\tau$。该方法综合了三个核心组成部分：\n$1$. 将力矩定义为力与力臂的乘积，即 $\\tau(\\theta) = F(\\theta)r(\\theta)$。\n$2$. 通过对离散实验数据进行多项式拟合得到的力臂模型 $r(\\theta)$。\n$3$. 将肌肉力 $F(\\theta)$ 描述为关节角度的高斯函数的模型。\n\n整个过程将使用国际单位制 (SI)，并根据数学惯例对三角函数和超越函数的要求，将角度统一转换为弧度进行计算。最终输出的力矩单位为牛顿米 ($\\mathrm{N\\cdot m}$)。\n\n程序步骤如下：\n\n**步骤 1：角度单位转换**\n所有以度 ($^\\circ$) 为单位提供的角度量，在用于任何计算之前都必须转换为弧度 (rad)。转换公式为：\n$$\n\\theta_{\\mathrm{rad}} = \\theta_{\\mathrm{deg}} \\times \\frac{\\pi}{180}\n$$\n这适用于输入角度测量值 ($\\theta_i$)、运动范围 (ROM) 的边界、力模型参数 ($\\theta_{\\mathrm{opt}}$, $\\sigma$) 以及评估网格的步长 ($1^\\circ$)。\n\n**步骤 2：使用多项式回归建立力臂模型**\n给定一组 $m$ 个力臂的离散测量值 $\\{(\\theta_i, r_i)\\}_{i=1}^{m}$，我们的目标是找到一个连续函数 $r(\\theta)$ 来近似这些数据。问题指定使用一个给定阶数 $n$ 的多项式。该模型形式如下：\n$$\nr_{\\mathrm{poly}}(\\theta) = \\sum_{k=0}^{n} a_k \\theta^k = a_n \\theta^n + a_{n-1} \\theta^{n-1} + \\dots + a_1 \\theta + a_0\n$$\n未知系数 $\\{a_k\\}_{k=0}^{n}$ 由最小二乘法原理确定，该原理旨在最小化残差平方和 $S$：\n$$\nS = \\sum_{i=1}^{m} \\left( r_i - r_{\\mathrm{poly}}(\\theta_i) \\right)^2 = \\sum_{i=1}^{m} \\left( r_i - \\sum_{k=0}^{n} a_k \\theta_i^k \\right)^2\n$$\n这个最小化问题产生一个称为正规方程组的线性方程系统，可以求解系数向量 $\\mathbf{a} = [a_0, a_1, \\dots, a_n]^T$。在实践中，强大的数值计算库（例如 `numpy.polyfit`）提供了直接根据数据 $(\\theta_i, r_i)$ 和阶数 $n$ 求解这些系数的函数。\n\n**步骤 3：强制实现物理真实性**\n力臂 $r(\\theta)$ 代表一个物理距离，因此必须为非负值。然而，多项式拟合作为一种无约束的数学近似，可能会产生负值，尤其是在外推或数据稀疏的区域。问题要求通过将预测的力臂值在为负时限制为零来进行物理上真实的校正。因此，最终的力臂模型为：\n$$\nr_{\\mathrm{pred}}(\\theta) = \\max\\{0, r_{\\mathrm{poly}}(\\theta)\\}\n$$\n\n**步骤 4：肌肉力建模**\n肌肉的产力能力 $F(\\theta)$ 依赖于关节角度，这主要是由于肌肉的长度-张力关系。问题为此依赖关系提供了一个成熟的高斯模型：\n$$\nF(\\theta) = F_{\\max}\\,\\exp\\!\\left(-\\dfrac{(\\theta - \\theta_{\\mathrm{opt}})^2}{2\\,\\sigma^2}\\right)\n$$\n此处，$F_{\\max}$ 是肌肉能产生的最大等长力，$\\theta_{\\mathrm{opt}}$ 是肌肉长度最适合产力时的关节角度，$\\sigma$ 是一个决定主动范围宽度的参数，其功能上与肌肉偏离最佳长度时力下降的速率有关。所有角度变量（$\\theta$、$\\theta_{\\mathrm{opt}}$、$\\sigma$）在此计算中都必须使用弧度。\n\n**步骤 5：力矩曲线计算与峰值力矩确定**\n有了力臂模型 $r_{\\mathrm{pred}}(\\theta)$ 和肌肉力模型 $F(\\theta)$，就可以通过两者的乘积计算出产生的关节力矩 $\\tau(\\theta)$：\n$$\n\\tau(\\theta) = F(\\theta)\\,r_{\\mathrm{pred}}(\\theta)\n$$\n为了找到指定运动范围内的峰值力矩，我们在该运动范围内的一个精细角度网格上评估 $\\tau(\\theta)$。问题指定了一个步长为 $1^\\circ$ 的均匀网格。设运动范围为 $[\\theta_{\\mathrm{start}}, \\theta_{\\mathrm{end}}]$。我们将创建一个覆盖此范围的离散角度集合 $\\Theta = \\{\\theta_j\\}$。对于每个 $\\theta_j \\in \\Theta$，我们计算 $\\tau(\\theta_j)$。峰值力矩 $\\tau_{\\mathrm{peak}}$ 则是这个计算集合中找到的最大值：\n$$\n\\tau_{\\mathrm{peak}} = \\max_{\\theta_j \\in \\Theta} \\{\\tau(\\theta_j)\\}\n$$\n这个以 $\\mathrm{N\\cdot m}$ 为单位计算出的值，将按最终答案要求四舍五入到 $3$ 位小数。对每个提供的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the peak musculoskeletal torque for a series of test cases\n    based on provided biomechanical models and data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (elbow flexors)\n        {\n            \"angles_deg\": np.array([20, 40, 60, 80, 100, 120, 140]),\n            \"moment_arms_m\": np.array([0.020, 0.035, 0.042, 0.045, 0.042, 0.035, 0.025]),\n            \"rom_deg\": [20, 140],\n            \"poly_degree\": 3,\n            \"force_params\": {\"F_max\": 800, \"theta_opt_deg\": 90, \"sigma_deg\": 25}\n        },\n        # Case 2 (knee extensors)\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120]),\n            \"moment_arms_m\": np.array([0.045, 0.048, 0.050, 0.047, 0.040]),\n            \"rom_deg\": [0, 120],\n            \"poly_degree\": 3,\n            \"force_params\": {\"F_max\": 3000, \"theta_opt_deg\": 45, \"sigma_deg\": 30}\n        },\n        # Case 3 (shoulder abductors)\n        {\n            \"angles_deg\": np.array([10, 30, 50]),\n            \"moment_arms_m\": np.array([0.030, 0.030, 0.030]),\n            \"rom_deg\": [10, 50],\n            \"poly_degree\": 1,\n            \"force_params\": {\"F_max\": 1200, \"theta_opt_deg\": 30, \"sigma_deg\": 10}\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Extract data and convert angles from degrees to radians for computation.\n        angles_rad = np.deg2rad(case[\"angles_deg\"])\n        moment_arms_m = case[\"moment_arms_m\"]\n        rom_start_deg, rom_end_deg = case[\"rom_deg\"]\n        poly_degree = case[\"poly_degree\"]\n        \n        F_max = case[\"force_params\"][\"F_max\"]\n        theta_opt_rad = np.deg2rad(case[\"force_params\"][\"theta_opt_deg\"])\n        sigma_rad = np.deg2rad(case[\"force_params\"][\"sigma_deg\"])\n\n        # Step 2: Fit a polynomial to the moment arm data.\n        # np.polyfit finds coefficients for the polynomial that best fits the data.\n        coeffs = np.polyfit(angles_rad, moment_arms_m, poly_degree)\n        \n        # Create a callable polynomial function from the coefficients.\n        poly_func = np.poly1d(coeffs)\n\n        # Step 5 (part 1): Create a uniform angle grid across the ROM.\n        # The grid has a step size of 1 degree, as specified.\n        # The endpoint is included, so we add 1 to the a`range` end.\n        angle_grid_deg = np.arange(rom_start_deg, rom_end_deg + 1, 1)\n        angle_grid_rad = np.deg2rad(angle_grid_deg)\n\n        # Step 3: Evaluate the polynomial on the grid and enforce physical realism (non-negativity).\n        r_pred_rad = poly_func(angle_grid_rad)\n        r_pred_clamped = np.maximum(0, r_pred_rad)\n\n        # Step 4: Evaluate the muscle force model on the grid.\n        # F(theta) = F_max * exp(-((theta - theta_opt)^2) / (2 * sigma^2))\n        exponent = -((angle_grid_rad - theta_opt_rad)**2) / (2 * sigma_rad**2)\n        force_profile = F_max * np.exp(exponent)\n\n        # Step 5 (part 2): Compute the torque profile.\n        # Torque(theta) = Force(theta) * MomentArm(theta)\n        torque_profile = force_profile * r_pred_clamped\n\n        # Step 6: Find the peak torque from the computed profile.\n        peak_torque = np.max(torque_profile)\n\n        # Step 7: Round the result to 3 decimal places and append.\n        results.append(round(peak_torque, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}