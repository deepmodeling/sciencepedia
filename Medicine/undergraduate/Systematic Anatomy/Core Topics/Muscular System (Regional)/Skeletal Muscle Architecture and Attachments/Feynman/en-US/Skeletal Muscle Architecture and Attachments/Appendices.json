{
    "hands_on_practices": [
        {
            "introduction": "A muscle's strength is not determined by its simple anatomical girth, but by the total cross-sectional area of its force-generating fibers. This quantity, the Physiological Cross-Sectional Area (PCSA), is a fundamental predictor of a muscle's force potential. This practice guides you through the calculation of PCSA from basic physical properties and demonstrates how to predict the maximum force a muscle can transmit to its tendon, accounting for the architectural arrangement of its fibers ().",
            "id": "5149885",
            "problem": "A unipennate skeletal muscle attaches via a distal tendon to a bone across a joint. The fascicles insert into the tendon at an average pennation angle of $\\theta=15^\\circ$ relative to the tendon’s line of action. The excised wet muscle mass is $m=120\\ \\mathrm{g}$, and the muscle tissue density is $\\rho=1060\\ \\mathrm{kg/m^3}$. The mean fascicle length measured in situ is $l_f=9\\ \\mathrm{cm}$. Assume the muscle is at its optimal length for isometric activation. Take the muscle’s maximum specific tension (peak isometric stress along the fiber direction) to be $\\sigma=30\\ \\mathrm{N/cm^2}$.\n\nUsing first principles and definitions grounded in systematic anatomy and muscle architecture, determine:\n1. The Physiological Cross-Sectional Area (PCSA), defined as the sum of the fiber cross-sectional areas across the muscle.\n2. The predicted maximum isometric tendon force $F_{iso}$ along the muscle’s line of action.\n\nAssumptions:\n- Muscle density is uniform, and the measured mass corresponds to the active muscle tissue.\n- Fascicles are approximately uniform in length, and volume can be related to PCSA through fiber length.\n- The tendon is aligned with the line of action, and force transmission from fibers to tendon follows geometric projection based on pennation.\n\nExpress the PCSA in square centimeters ($\\mathrm{cm^2}$) and $F_{iso}$ in newtons ($\\mathrm{N}$). Use the angle in degrees for any trigonometric calculations. Round both final quantities to three significant figures.",
            "solution": "The goal is to compute the Physiological Cross-Sectional Area (PCSA) and the maximum isometric tendon force $F_{iso}$ based on fundamental definitions of muscle architecture and basic physical relations.\n\nFundamental bases:\n1. Mass–density relation: muscle volume $V$ satisfies $V = \\frac{m}{\\rho}$, where $m$ is mass and $\\rho$ is density.\n2. Definition of PCSA: PCSA is the sum of fiber cross-sectional areas. For a muscle with approximately uniform fiber length $l_f$, the muscle volume $V$ can be expressed as $V = (\\text{sum of fiber areas}) \\times l_f = PCSA \\times l_f$. Hence,\n   $$PCSA = \\frac{V}{l_f} = \\frac{m}{\\rho\\,l_f}.$$\n3. Maximum specific tension: Under maximal isometric activation, the total fiber force summed across fibers is $F_{\\text{fibers}} = \\sigma \\times PCSA$, where $\\sigma$ is the peak isometric stress along the fiber direction.\n4. Pennation geometry: Fiber force is not colinear with the tendon axis. The component of fiber force along the tendon is reduced by the cosine of the pennation angle $\\theta$. Thus, the tendon force is\n   $$F_{iso} = F_{\\text{fibers}} \\cos(\\theta) = \\sigma \\cdot PCSA \\cdot \\cos(\\theta).$$\n\nStep 1: Compute volume $V$ from mass and density.\nConvert the mass to kilograms to match the density units:\n$$m = 120\\ \\mathrm{g} = 0.12\\ \\mathrm{kg}.$$\nGiven $\\rho = 1060\\ \\mathrm{kg/m^3}$, the muscle volume is\n$$V = \\frac{m}{\\rho} = \\frac{0.12}{1060}\\ \\mathrm{m^3} = 1.1320754717 \\times 10^{-4}\\ \\mathrm{m^3}.$$\n\nStep 2: Compute $PCSA$ from volume and fiber length.\nConvert fiber length to meters:\n$$l_f = 9\\ \\mathrm{cm} = 0.09\\ \\mathrm{m}.$$\nThen,\n$$PCSA_{\\mathrm{m^2}} = \\frac{V}{l_f} = \\frac{1.1320754717 \\times 10^{-4}\\ \\mathrm{m^3}}{0.09\\ \\mathrm{m}} = 1.257861635 \\times 10^{-3}\\ \\mathrm{m^2}.$$\nConvert to square centimeters using $1\\ \\mathrm{m^2} = 10^{4}\\ \\mathrm{cm^2}$:\n$$PCSA_{\\mathrm{cm^2}} = 1.257861635 \\times 10^{-3}\\ \\mathrm{m^2} \\times 10^{4}\\ \\frac{\\mathrm{cm^2}}{\\mathrm{m^2}} = 12.57861635\\ \\mathrm{cm^2}.$$\n\nStep 3: Compute $F_{iso}$ using $\\sigma$ and pennation angle.\nWe use $\\sigma$ in $\\mathrm{N/cm^2}$ and $PCSA$ in $\\mathrm{cm^2}$ to get newtons directly, and the cosine with the angle in degrees:\n$$F_{iso} = \\sigma \\cdot PCSA_{\\mathrm{cm^2}} \\cdot \\cos(15^\\circ) = 30\\ \\frac{\\mathrm{N}}{\\mathrm{cm^2}} \\times 12.57861635\\ \\mathrm{cm^2} \\times \\cos(15^\\circ).$$\nCompute the intermediate product:\n$$30 \\times 12.57861635 = 377.3584905\\ \\mathrm{N}.$$\nUsing $\\cos(15^\\circ) \\approx 0.9659258263$, we obtain\n$$F_{iso} \\approx 377.3584905\\ \\mathrm{N} \\times 0.9659258263 = 364.5003\\ \\mathrm{N}.$$\n\nStep 4: Apply the rounding instruction.\n- $PCSA$: $12.57861635\\ \\mathrm{cm^2}$ rounded to three significant figures is $12.6\\ \\mathrm{cm^2}$.\n- $F_{iso}$: $364.5003\\ \\mathrm{N}$ rounded to three significant figures is $365\\ \\mathrm{N}$.\n\nTherefore, the final results are $PCSA = 12.6\\ \\mathrm{cm^2}$ and $F_{iso} = 365\\ \\mathrm{N}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}12.6 & 365\\end{pmatrix}}$$"
        },
        {
            "introduction": "Muscle force creates rotation, or torque, at a joint, which is the basis for all movement. The effectiveness of a muscle's force in generating torque depends critically on its attachment geometry, quantified by the moment arm. This exercise explores how torque is a product of both force and this anatomical lever, and how changes in joint angle can alter the moment arm to maximize torque production ().",
            "id": "5149869",
            "problem": "A single-compartment model of an elbow flexor muscle-tendon unit is used to study how skeletal muscle architecture and attachment geometry determine joint torque. The muscle attaches such that its perpendicular moment arm about the elbow joint varies smoothly with elbow angle due to changing line-of-action geometry and wrapping. Let the elbow flexion angle be denoted by $\\theta$ (in radians), with physiological range $0 \\le \\theta \\le \\pi$. The measured moment arm as a function of angle is given by $r(\\theta)=0.035+0.005\\sin\\theta$ in meters, reflecting a baseline bone-lever distance and a sinusoidal modulation due to anatomical path changes. Assume the muscle can produce a constant angle-independent maximal isometric force $F_{\\mathrm{iso}}=1500\\ \\mathrm{N}$ at the tested joint posture because the muscle fibers are maintained near their optimal length by experimental adjustment.\n\nStarting only from the definition of joint torque as the moment of force about a pivot, and the isometric condition (no joint angular acceleration), derive the torque–angle relation for this muscle–joint system and determine:\n- the peak isometric joint torque within $0 \\le \\theta \\le \\pi$, and\n- the joint angle (in radians) at which this peak torque occurs.\n\nExpress the final torque in $\\mathrm{N\\cdot m}$ and the angle in radians. No rounding is required; report exact values.",
            "solution": "The definition of joint torque, $\\tau$, is the product of the force, $F$, and its perpendicular moment arm, $r$:\n$$\n\\tau = F \\cdot r\n$$\nIn this problem, the force is a constant maximal isometric force, $F_{\\mathrm{iso}} = 1500\\ \\mathrm{N}$, and the moment arm is a function of the elbow angle $\\theta$, given by $r(\\theta) = 0.035 + 0.005\\sin\\theta\\ \\mathrm{[m]}$.\n\nTherefore, the torque-angle relation, $\\tau(\\theta)$, can be expressed as:\n$$\n\\tau(\\theta) = F_{\\mathrm{iso}} \\cdot r(\\theta) = 1500 \\cdot (0.035 + 0.005\\sin\\theta)\n$$\nDistributing the constant force value yields the torque-angle relation:\n$$\n\\tau(\\theta) = 52.5 + 7.5\\sin\\theta\n$$\nThis equation gives the isometric torque in $\\mathrm{N\\cdot m}$ as a function of the angle $\\theta$ in radians.\n\nTo find the peak isometric joint torque, we must find the maximum value of the function $\\tau(\\theta)$ on the physiological range $0 \\le \\theta \\le \\pi$. Because $\\tau(\\theta)$ is a linear function of $\\sin\\theta$ with a positive coefficient (7.5), its maximum value will occur when the $\\sin\\theta$ term is at its maximum.\n\nWithin the interval $[0, \\pi]$, the maximum value of the sine function, $\\sin\\theta$, is $1$. This maximum occurs at the angle $\\theta = \\frac{\\pi}{2}$ radians.\n\nWe can formally verify this using calculus. First, find the critical points by taking the derivative of $\\tau(\\theta)$ with respect to $\\theta$ and setting it to zero:\n$$\n\\frac{d\\tau}{d\\theta} = \\frac{d}{d\\theta}(52.5 + 7.5\\sin\\theta) = 7.5\\cos\\theta\n$$\nSetting the derivative to zero, $7.5\\cos\\theta = 0$, implies $\\cos\\theta = 0$. The only solution within the domain $0 \\le \\theta \\le \\pi$ is $\\theta = \\frac{\\pi}{2}$.\n\nTo confirm this is a maximum, we can use the second derivative test. The second derivative is:\n$$\n\\frac{d^2\\tau}{d\\theta^2} = \\frac{d}{d\\theta}(7.5\\cos\\theta) = -7.5\\sin\\theta\n$$\nAt $\\theta = \\frac{\\pi}{2}$, the second derivative is $-7.5\\sin(\\frac{\\pi}{2}) = -7.5$, which is negative, confirming a local maximum.\n\nFinally, we substitute the angle of peak torque back into the torque equation to find the peak torque value:\n$$\n\\tau_{\\mathrm{peak}} = \\tau\\left(\\frac{\\pi}{2}\\right) = 52.5 + 7.5\\sin\\left(\\frac{\\pi}{2}\\right) = 52.5 + 7.5(1) = 60\\ \\mathrm{N\\cdot m}\n$$\nThus, the peak isometric joint torque is $60\\ \\mathrm{N\\cdot m}$, and it occurs at a joint angle of $\\frac{\\pi}{2}$ radians.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60 & \\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In a living system, neither muscle force nor moment arm is constant; both vary dynamically as a joint moves through its range of motion. This advanced practice simulates a modern biomechanics workflow where you will build a predictive model of joint torque from sparse experimental data. By fitting a mathematical model to discrete moment arm measurements and combining it with a physiological model of muscle force, you will construct a complete and realistic torque-angle curve for a joint ().",
            "id": "5149902",
            "problem": "You are given discrete measurements of the musculoskeletal moment arm as a function of joint angle and a model of muscle force variation with joint angle. Starting from fundamental definitions in systematic anatomy and classical mechanics, derive a principled approach to predict joint torque over the Range of Motion (ROM), then implement it as a complete program. Range of Motion (ROM) is the set of anatomically permissible joint angles for the joint under consideration. The moment arm is defined as the perpendicular distance from the line of action of the muscle force to the joint center. The torque magnitude at a joint due to a muscle is defined by the cross product of position and force vectors, yielding the scalar identity $|\\tau(\\theta)| = |r(\\theta)|\\,|F(\\theta)|\\,\\sin(\\phi)$, where $\\phi$ is the angle between the moment arm vector and the force vector. In the standard anatomical definition of a moment arm $r(\\theta)$ as the perpendicular distance, $\\phi = \\pi/2$ and thus $\\sin(\\phi) = 1$, making the torque magnitude simplify to $\\tau(\\theta) = F(\\theta)\\,r(\\theta)$ for flexion or extension in a single plane. Your task is to fit a polynomial model to the measured $r(\\theta)$ as a function of angle, then compute the torque profile across the ROM for a given $F(\\theta)$, and finally report the peak torque.\n\nUse the following fundamental base:\n- The torque magnitude identity with perpendicular definition of the moment arm: $\\tau(\\theta) = F(\\theta)\\,r(\\theta)$.\n- The least-squares polynomial fitting principle: given samples $\\{(\\theta_i, r_i)\\}_{i=1}^{m}$ and a chosen degree $n$, find coefficients $\\{a_k\\}_{k=0}^{n}$ that minimize $\\sum_{i=1}^{m}\\left[r_i - \\sum_{k=0}^{n} a_k\\,\\theta_i^k\\right]^2$ to form the model $r(\\theta) \\approx \\sum_{k=0}^{n} a_k\\,\\theta^k$.\n- A well-tested descriptive model of angle-dependent muscle force magnitude based on a Gaussian profile centered at the angle of optimal length-tension: $F(\\theta) = F_{\\max}\\,\\exp\\!\\left(-\\dfrac{(\\theta - \\theta_{\\mathrm{opt}})^2}{2\\,\\sigma^2}\\right)$.\n\nImplement the following algorithmic requirements:\n1. Convert all angles from degrees to radians for computation. When reporting angles in the description or lists below, they are in degrees; internally, the program must convert to radians. Use $\\pi$ for conversions.\n2. Fit a polynomial of the specified degree $n$ to the provided $(\\theta_i, r_i)$ pairs by least squares. The independent variable is the angle $\\theta$ in radians, and the dependent variable is the moment arm $r(\\theta)$ in meters.\n3. Enforce physical realism by clamping the predicted moment arm to be non-negative for all evaluation angles, i.e., use $r_{\\mathrm{pred}}(\\theta) \\leftarrow \\max\\{0, r_{\\mathrm{pred}}(\\theta)\\}$.\n4. Evaluate $F(\\theta)$ using the Gaussian profile with parameters $F_{\\max}$ in newtons, $\\theta_{\\mathrm{opt}}$ in radians, and $\\sigma$ in radians.\n5. Compute the torque profile $\\tau(\\theta) = F(\\theta)\\,r_{\\mathrm{pred}}(\\theta)$ across the ROM using a uniform angle grid with step size of $1^\\circ$ (convert to radians internally).\n6. For each test case, return the peak torque value across the ROM.\n7. Express the final torque answers in Newton-meter $(\\mathrm{N\\cdot m})$, rounded to $3$ decimal places.\n\nTest suite and parameters (each case is independent and should be processed in order):\n- Case $1$ (elbow flexors): angles in degrees $\\{20, 40, 60, 80, 100, 120, 140\\}$; moment arms in meters $\\{0.020, 0.035, 0.042, 0.045, 0.042, 0.035, 0.025\\}$; ROM in degrees $[20, 140]$; polynomial degree $n=3$; Gaussian force parameters $F_{\\max} = 800$ newtons, $\\theta_{\\mathrm{opt}} = 90^\\circ$, $\\sigma = 25^\\circ$.\n- Case $2$ (knee extensors): angles in degrees $\\{0, 30, 60, 90, 120\\}$; moment arms in meters $\\{0.045, 0.048, 0.050, 0.047, 0.040\\}$; ROM in degrees $[0, 120]$; polynomial degree $n=3$; Gaussian force parameters $F_{\\max} = 3000$ newtons, $\\theta_{\\mathrm{opt}} = 45^\\circ$, $\\sigma = 30^\\circ$.\n- Case $3$ (shoulder abductors, near-constant moment arm over a narrow ROM): angles in degrees $\\{10, 30, 50\\}$; moment arms in meters $\\{0.030, 0.030, 0.030\\}$; ROM in degrees $[10, 50]$; polynomial degree $n=1$; Gaussian force parameters $F_{\\max} = 1200$ newtons, $\\theta_{\\mathrm{opt}} = 30^\\circ$, $\\sigma = 10^\\circ$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$), where each $result_i$ is the peak torque for the corresponding case, rounded to $3$ decimal places and expressed in $\\mathrm{N\\cdot m}$.\n\nAngle unit specification: all angles provided in the test suite are in degrees; internally, convert to radians for computation. The angle grid step is $1^\\circ$.\n\nPhysical unit specification: report torque in $\\mathrm{N\\cdot m}$, rounded to $3$ decimal places.\n\nDesign for coverage:\n- Case $1$ is a general scenario with a unimodal moment arm peaking near mid-ROM.\n- Case $2$ has a higher force capacity and mildly varying moment arm across a wider ROM.\n- Case $3$ tests the handling of near-constant moment arms and a narrow force profile, with minimal polynomial degree and sparse data, ensuring boundary-condition behavior and non-negativity clamping.",
            "solution": "The problem statement is critically validated as well-posed, scientifically grounded, and self-contained. It provides a clear, principled framework for modeling musculoskeletal torque production based on established concepts from systematic anatomy and classical mechanics.\n\nThe problem requires the derivation and implementation of a computational method to predict joint torque, $\\tau$, as a function of joint angle, $\\theta$. The approach synthesizes three core components:\n$1$. The definition of torque as the product of force and moment arm, $\\tau(\\theta) = F(\\theta)r(\\theta)$.\n$2$. A model of the moment arm, $r(\\theta)$, derived by fitting a polynomial to discrete experimental data.\n$3$. A descriptive model of the muscle force, $F(\\theta)$, as a Gaussian function of the joint angle.\n\nThe entire process will be conducted using SI units, with angles consistently converted to radians for computation as required by mathematical convention for trigonometric and transcendental functions. The final output torque will be in Newton-meters ($\\mathrm{N\\cdot m}$).\n\nThe procedural steps are as follows:\n\n**Step 1: Angle Unit Conversion**\nAll angular quantities provided in degrees ($^\\circ$) must be converted to radians (rad) before being used in any calculation. The conversion formula is:\n$$\n\\theta_{\\mathrm{rad}} = \\theta_{\\mathrm{deg}} \\times \\frac{\\pi}{180}\n$$\nThis applies to the input angle measurements ($\\theta_i$), the Range of Motion (ROM) boundaries, the parameters of the force model ($\\theta_{\\mathrm{opt}}$, $\\sigma$), and the evaluation grid step size ($1^\\circ$).\n\n**Step 2: Moment Arm Modeling using Polynomial Regression**\nGiven a set of $m$ discrete measurements of the moment arm, $\\{(\\theta_i, r_i)\\}_{i=1}^{m}$, we aim to find a continuous function $r(\\theta)$ that approximates these data. The problem specifies using a polynomial of a given degree $n$. The model is of the form:\n$$\nr_{\\mathrm{poly}}(\\theta) = \\sum_{k=0}^{n} a_k \\theta^k = a_n \\theta^n + a_{n-1} \\theta^{n-1} + \\dots + a_1 \\theta + a_0\n$$\nThe unknown coefficients $\\{a_k\\}_{k=0}^{n}$ are determined by the principle of least squares, which seeks to minimize the sum of squared residuals, $S$:\n$$\nS = \\sum_{i=1}^{m} \\left( r_i - r_{\\mathrm{poly}}(\\theta_i) \\right)^2 = \\sum_{i=1}^{m} \\left( r_i - \\sum_{k=0}^{n} a_k \\theta_i^k \\right)^2\n$$\nThis minimization problem yields a system of linear equations known as the normal equations, which can be solved for the coefficient vector $\\mathbf{a} = [a_0, a_1, \\dots, a_n]^T$. In practice, robust numerical libraries provide functions (e.g., `numpy.polyfit`) that directly solve for these coefficients given the data $(\\theta_i, r_i)$ and the degree $n$.\n\n**Step 3: Enforcement of Physical Realism**\nThe moment arm, $r(\\theta)$, represents a physical distance and must therefore be non-negative. However, a polynomial fit, being an unconstrained mathematical approximation, may yield negative values, particularly when extrapolating or in regions of sparse data. The problem mandates a physically realistic correction by clamping the predicted moment arm values to zero if they are negative. The final moment arm model is thus:\n$$\nr_{\\mathrm{pred}}(\\theta) = \\max\\{0, r_{\\mathrm{poly}}(\\theta)\\}\n$$\n\n**Step 4: Muscle Force Modeling**\nThe force-generating capacity of a muscle, $F(\\theta)$, is dependent on the joint angle, primarily due to the muscle's length-tension relationship. The problem provides a well-established Gaussian model for this dependency:\n$$\nF(\\theta) = F_{\\max}\\,\\exp\\!\\left(-\\dfrac{(\\theta - \\theta_{\\mathrm{opt}})^2}{2\\,\\sigma^2}\\right)\n$$\nHere, $F_{\\max}$ is the maximum isometric force the muscle can produce, $\\theta_{\\mathrm{opt}}$ is the joint angle at which the muscle's length is optimal for force production, and $\\sigma$ is a parameter that determines the width of the active range, functionally related to the rate at which force declines as the muscle moves away from its optimal length. All angular variables ($\\theta$, $\\theta_{\\mathrm{opt}}$, $\\sigma$) must be in radians for this calculation.\n\n**Step 5: Torque Profile Computation and Peak Torque Identification**\nWith models for both the moment arm, $r_{\\mathrm{pred}}(\\theta)$, and the muscle force, $F(\\theta)$, the resulting joint torque, $\\tau(\\theta)$, can be computed by their product:\n$$\n\\tau(\\theta) = F(\\theta)\\,r_{\\mathrm{pred}}(\\theta)\n$$\nTo find the peak torque across the specified ROM, we evaluate $\\tau(\\theta)$ over a fine grid of angles within the ROM. The problem specifies a grid with a uniform step size of $1^\\circ$. Let the ROM be $[\\theta_{\\mathrm{start}}, \\theta_{\\mathrm{end}}]$. We will create a discrete set of angles $\\Theta = \\{\\theta_j\\}$ covering this range. For each $\\theta_j \\in \\Theta$, we compute $\\tau(\\theta_j)$. The peak torque, $\\tau_{\\mathrm{peak}}$, is then the maximum value found in this computed set:\n$$\n\\tau_{\\mathrm{peak}} = \\max_{\\theta_j \\in \\Theta} \\{\\tau(\\theta_j)\\}\n$$\nThis value, calculated in $\\mathrm{N\\cdot m}$, is then rounded to $3$ decimal places as required for the final answer. This procedure is repeated for each test case provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the peak musculoskeletal torque for a series of test cases\n    based on provided biomechanical models and data.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (elbow flexors)\n        {\n            \"angles_deg\": np.array([20, 40, 60, 80, 100, 120, 140]),\n            \"moment_arms_m\": np.array([0.020, 0.035, 0.042, 0.045, 0.042, 0.035, 0.025]),\n            \"rom_deg\": [20, 140],\n            \"poly_degree\": 3,\n            \"force_params\": {\"F_max\": 800, \"theta_opt_deg\": 90, \"sigma_deg\": 25}\n        },\n        # Case 2 (knee extensors)\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120]),\n            \"moment_arms_m\": np.array([0.045, 0.048, 0.050, 0.047, 0.040]),\n            \"rom_deg\": [0, 120],\n            \"poly_degree\": 3,\n            \"force_params\": {\"F_max\": 3000, \"theta_opt_deg\": 45, \"sigma_deg\": 30}\n        },\n        # Case 3 (shoulder abductors)\n        {\n            \"angles_deg\": np.array([10, 30, 50]),\n            \"moment_arms_m\": np.array([0.030, 0.030, 0.030]),\n            \"rom_deg\": [10, 50],\n            \"poly_degree\": 1,\n            \"force_params\": {\"F_max\": 1200, \"theta_opt_deg\": 30, \"sigma_deg\": 10}\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Extract data and convert angles from degrees to radians for computation.\n        angles_rad = np.deg2rad(case[\"angles_deg\"])\n        moment_arms_m = case[\"moment_arms_m\"]\n        rom_start_deg, rom_end_deg = case[\"rom_deg\"]\n        poly_degree = case[\"poly_degree\"]\n        \n        F_max = case[\"force_params\"][\"F_max\"]\n        theta_opt_rad = np.deg2rad(case[\"force_params\"][\"theta_opt_deg\"])\n        sigma_rad = np.deg2rad(case[\"force_params\"][\"sigma_deg\"])\n\n        # Step 2: Fit a polynomial to the moment arm data.\n        # np.polyfit finds coefficients for the polynomial that best fits the data.\n        coeffs = np.polyfit(angles_rad, moment_arms_m, poly_degree)\n        \n        # Create a callable polynomial function from the coefficients.\n        poly_func = np.poly1d(coeffs)\n\n        # Step 5 (part 1): Create a uniform angle grid across the ROM.\n        # The grid has a step size of 1 degree, as specified.\n        # The endpoint is included, so we add 1 to the arange end.\n        angle_grid_deg = np.arange(rom_start_deg, rom_end_deg + 1, 1)\n        angle_grid_rad = np.deg2rad(angle_grid_deg)\n\n        # Step 3: Evaluate the polynomial on the grid and enforce physical realism (non-negativity).\n        r_pred_rad = poly_func(angle_grid_rad)\n        r_pred_clamped = np.maximum(0, r_pred_rad)\n\n        # Step 4: Evaluate the muscle force model on the grid.\n        # F(theta) = F_max * exp(-((theta - theta_opt)^2) / (2 * sigma^2))\n        exponent = -((angle_grid_rad - theta_opt_rad)**2) / (2 * sigma_rad**2)\n        force_profile = F_max * np.exp(exponent)\n\n        # Step 5 (part 2): Compute the torque profile.\n        # Torque(theta) = Force(theta) * MomentArm(theta)\n        torque_profile = force_profile * r_pred_clamped\n\n        # Step 6: Find the peak torque from the computed profile.\n        peak_torque = np.max(torque_profile)\n\n        # Step 7: Round the result to 3 decimal places and append.\n        results.append(round(peak_torque, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}