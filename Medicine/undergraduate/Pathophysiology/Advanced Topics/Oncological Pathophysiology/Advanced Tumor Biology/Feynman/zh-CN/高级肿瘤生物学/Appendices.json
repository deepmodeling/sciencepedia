{
    "hands_on_practices": [
        {
            "introduction": "肿瘤细胞要实现侵袭，首先必须降解其周围的细胞外基质（ECM），这层屏障就像一道物理墙。这个关键过程通常由基质金属蛋白酶（MMPs）等酶来执行。本练习  运用经典的米氏方程（Michaelis-Menten model）来量化这一降解过程，从而将基础的生物化学原理与癌症病理生理学联系起来，让你亲手计算癌细胞“破壁”的效率。",
            "id": "4761605",
            "problem": "一个正在侵袭的恶性上皮细胞分泌一种锚定在细胞膜上的基质金属蛋白酶 (MMP)，该酶降解一种表示为 $S$ 的细胞外基质 (ECM) 底物。其催化机制遵循单底物酶反应方案 $E + S \\rightleftharpoons ES \\rightarrow E + P$，其中 $E$ 是酶，$ES$ 是酶-底物复合物，$P$ 是产物。假设 $ES$ 处于准稳态且总酶 $[E]_{T}$ 守恒。在一个分离了细胞周降解步骤的体外测定中，测量得到ECM底物的最大速率 $V_{\\max} = 1\\,\\mu\\text{M}\\,\\text{s}^{-1}$ 和米氏常数 $K_{m} = 10\\,\\mu\\text{M}$。从上述核心假设和基本酶动力学定义出发，推导以 $V_{\\max}$、$K_{m}$ 和 $[S]$ 表示的ECM底物降解的初始速率表达式。然后，当ECM底物浓度为 $[S] = 5\\,\\mu\\text{M}$ 时，计算初始降解速率。此外，从与侵袭相关的生物学角度解释当 $[S] \\to 0$ 和 $[S] \\to \\infty$ 时速率的极限行为。以 $\\mu\\text{M}\\,\\text{s}^{-1}$ 为单位表示计算出的初始降解速率，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于酶动力学的既定原理（米氏模型），与指定的高级肿瘤生物学领域相关，并且问题阐述清晰，信息充分且一致。\n\n问题要求推导底物降解的初始速率表达式，计算特定底物浓度下的该速率，并对速率方程的极限行为进行生物学解释。\n\n设反应方案表示为：\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_2}{\\rightarrow} E + P $$\n其中 $E$ 是酶 (MMP)，$S$ 是底物 (ECM)，$ES$ 是酶-底物复合物，$P$ 是降解产物。正向结合、反向解离和催化步骤的速率常数分别为 $k_1$、$k_{-1}$ 和 $k_2$。\n\n反应的初始速率 $v$ 是产物生成的速率，它与酶-底物复合物的浓度 $[ES]$ 成正比：\n$$ v = \\frac{d[P]}{dt} = k_2 [ES] $$\n\n酶-底物复合物浓度 $[ES]$ 的变化率由其生成速率减去其消耗速率得出：\n$$ \\frac{d[ES]}{dt} = k_1 [E] [S] - k_{-1} [ES] - k_2 [ES] = k_1 [E] [S] - (k_{-1} + k_2) [ES] $$\n\n问题陈述了对 $[ES]$ 复合物采用准稳态的假设。这意味着在极短的初始瞬态之后，中间复合物 $[ES]$ 的浓度大致保持不变。在数学上，这表示为：\n$$ \\frac{d[ES]}{dt} \\approx 0 $$\n因此，\n$$ k_1 [E] [S] = (k_{-1} + k_2) [ES] $$\n\n第二个假设是总酶守恒。酶的总浓度 $[E]_T$ 是游离酶 $[E]$ 和结合在复合物中的酶 $[ES]$ 的总和：\n$$ [E]_T = [E] + [ES] $$\n由此，我们可以将游离酶的浓度表示为：\n$$ [E] = [E]_T - [ES] $$\n\n现在，将这个 $[E]$ 的表达式代入稳态方程：\n$$ k_1 ([E]_T - [ES]) [S] = (k_{-1} + k_2) [ES] $$\n展开左边得到：\n$$ k_1 [E]_T [S] - k_1 [ES] [S] = (k_{-1} + k_2) [ES] $$\n重新整理以求解 $[ES]$：\n$$ k_1 [E]_T [S] = (k_{-1} + k_2) [ES] + k_1 [ES] [S] $$\n$$ k_1 [E]_T [S] = [ES] (k_{-1} + k_2 + k_1 [S]) $$\n$$ [ES] = \\frac{k_1 [E]_T [S]}{k_{-1} + k_2 + k_1 [S]} $$\n为了简化此表达式，我们将分子和分母同时除以 $k_1$：\n$$ [ES] = \\frac{[E]_T [S]}{\\frac{k_{-1} + k_2}{k_1} + [S]} $$\n\n我们现在引入米氏常数 $K_m$ 和最大速率 $V_{\\max}$ 的标准定义。\n米氏常数 $K_m$ 定义为：\n$$ K_m = \\frac{k_{-1} + k_2}{k_1} $$\n最大速率 $V_{\\max}$ 是当酶被底物完全饱和时的速率（即，当 $[ES] = [E]_T$ 时）。从我们的初始速率方程 $v = k_2[ES]$ 可得：\n$$ V_{\\max} = k_2 [E]_T $$\n\n将 $K_m$ 的定义代入 $[ES]$ 的表达式中：\n$$ [ES] = \\frac{[E]_T [S]}{K_m + [S]} $$\n最后，将这个 $[ES]$ 的表达式代入速率方程 $v = k_2 [ES]$ 中：\n$$ v = k_2 \\left( \\frac{[E]_T [S]}{K_m + [S]} \\right) = \\frac{k_2 [E]_T [S]}{K_m + [S]} $$\n使用定义 $V_{\\max} = k_2 [E]_T$，我们得到米氏方程，这就是所求的ECM底物降解的初始速率表达式：\n$$ v = \\frac{V_{\\max} [S]}{K_m + [S]} $$\n\n接下来，我们根据给定值计算初始降解速率：\n$V_{\\max} = 1\\,\\mu\\text{M}\\,\\text{s}^{-1}$\n$K_{m} = 10\\,\\mu\\text{M}$\n$[S] = 5\\,\\mu\\text{M}$\n\n将这些值代入推导出的方程中：\n$$ v = \\frac{(1\\,\\mu\\text{M}\\,\\text{s}^{-1}) (5\\,\\mu\\text{M})}{10\\,\\mu\\text{M} + 5\\,\\mu\\text{M}} = \\frac{5}{15}\\,\\mu\\text{M}\\,\\text{s}^{-1} = \\frac{1}{3}\\,\\mu\\text{M}\\,\\text{s}^{-1} $$\n作为小数并四舍五入到四位有效数字，结果是 $0.3333\\,\\mu\\text{M}\\,\\text{s}^{-1}$。\n\n最后，我们在肿瘤侵袭的生物学背景下解释极限行为。\n\n情况1：低底物浓度，$[S] \\to 0$。\n在这个极限下，其中 $[S] \\ll K_m$，速率方程的分母简化为 $K_m + [S] \\approx K_m$。速率方程变为：\n$$ v \\approx \\frac{V_{\\max}}{K_m} [S] $$\n速率 $v$ 相对于底物浓度 $[S]$ 近似为一级反应。\n生物学解释：当ECM底物稀疏时，癌细胞分泌的MMP酶大多未结合。ECM的降解速率受限于酶分子与底物分子相遇的频率。因此，总降解速率与ECM的局部浓度成正比。这种情况描述了侵袭的初始阶段或侵袭到基质密度低的组织中，此时该过程对可用底物的量高度敏感。\n\n情况2：高底物浓度，$[S] \\to \\infty$。\n在这个极限下，其中 $[S] \\gg K_m$，速率方程的分母简化为 $K_m + [S] \\approx [S]$。速率方程变为：\n$$ v \\approx \\frac{V_{\\max} [S]}{[S]} = V_{\\max} $$\n速率 $v$ 接近一个恒定的最大值 $V_{\\max}$，并相对于底物浓度 $[S]$ 变为零级反应（即独立于底物浓度）。\n生物学解释：当癌细胞处于密集的ECM环境中时，底物是丰富的。MMP酶的活性位点被底物分子饱和。限速步骤不再是底物的扩散和结合，而是酶的内在催化速度（即它能多快地切割底物并为下一个底物做好准备）。降解以最大、恒定的速率进行，使癌细胞能够高效、快速地在密集的组织屏障中开辟出一条通路。这种持续的高速降解对于侵袭性的局部侵袭和随后的转移至关重要。",
            "answer": "$$\\boxed{0.3333}$$"
        },
        {
            "introduction": "虽然转移是导致癌症死亡的主要原因，但它实际上是一个效率极低的过程。从原发肿瘤脱落的数百万个细胞中，只有极少数能够成功地在远处器官形成新的肿瘤。本练习  提供了一个概率模型，将转移过程分解为一系列连续且充满挑战的步骤，通过计算来帮助你直观地理解为何肿瘤转移的成功率如此之低。",
            "id": "4761646",
            "problem": "在高等肿瘤生物学中，转移级联包含一系列连续的必要步骤：局部侵袭、侵入脉管系统（血管内渗）、在循环系统中存活、在远端毛细血管床中停滞、渗出血管进入组织实质（血管外渗），以及增殖形成临床可检测的病灶。设 $S_i$ 表示单个肿瘤细胞在已到达第 $i$ 步的条件下成功完成该步骤的事件，其中 $i=1,\\dots,6$，顺序如上所列。将 $p_i$ 定义为条件成功概率 $p_i = P(S_i \\,|\\, S_1 \\cap S_2 \\cap \\dots \\cap S_{i-1})$，并约定 $p_1 = P(S_1)$。\n\n仅使用概率公理和条件概率的链式法则，推导单个肿瘤细胞完成转移级联所有六个步骤的总概率的表达式。然后，使用分别对应于侵袭、血管内渗、循环中存活、停滞、血管外渗和生长的各步骤概率 $p = (10^{-1},\\,10^{-2},\\,10^{-3},\\,10^{-1},\\,10^{-2},\\,10^{-1})$，计算该表达式的值。\n\n将最终数值答案以标准科学记数法表示，并四舍五入至三位有效数字。无需单位。",
            "solution": "本题要求推导单个肿瘤细胞完成一个六步转移级联的总概率表达式，并利用一组给定的各步骤成功概率计算该概率值。\n\n### 步骤 1：问题验证\n\n首先，我将提取给定信息并验证问题陈述。\n\n**已知条件：**\n1.  转移级联是一个包含 $6$ 个步骤的序列：局部侵袭、血管内渗、循环中存活、停滞、血管外渗和生长。\n2.  设 $S_i$ 为单个肿瘤细胞成功完成第 $i$ 步的事件，其中 $i=1, \\dots, 6$。\n3.  第 $i$ 步的条件成功概率定义为 $p_i = P(S_i \\,|\\, S_1 \\cap S_2 \\cap \\dots \\cap S_{i-1})$。\n4.  对第一步有约定：$p_1 = P(S_1)$。\n5.  任务是推导完成所有六个步骤的总概率表达式，$P(S_1 \\cap S_2 \\cap S_3 \\cap S_4 \\cap S_5 \\cap S_6)$。\n6.  任务是使用具体概率 $p_1 = 10^{-1}$，$p_2 = 10^{-2}$，$p_3 = 10^{-3}$，$p_4 = 10^{-1}$，$p_5 = 10^{-2}$ 和 $p_6 = 10^{-1}$ 计算该表达式的值。\n7.  最终数值答案必须采用标准科学记数法，并四舍五入至三位有效数字。\n\n**验证：**\n1.  **科学基础：** 本题描述了一个简化但标准的转移级联模型，这是癌症进展的一个关键过程。各步骤的顺序性和概率性是肿瘤生物学中公认的概念。所给的概率尽管是示例性的，但其数量级似乎是合理的，反映了公认的低效转移过程。本题基于已确立的生物学概念。\n2.  **适定性：** 本题在数学上是适定的。事件和条件概率定义清晰。它要求基于这些定义进行计算，且存在唯一解。\n3.  **客观性：** 语言正式且精确，没有主观或含糊不清的术语。\n4.  **完整性与一致性：** 提供了所有必要的信息。将 $p_i$ 定义为条件概率与过程的顺序性相一致，并允许直接应用概率论。约定 $p_1 = P(S_1)$ 是一个标准且合乎逻辑的基础情况。\n5.  **无其他缺陷：** 本题并非不切实际、病态、无足轻重或无法验证。它是将基础概率论直接应用于生物学模型的一个直接应用。\n\n**结论：**\n本题有效。我将继续解答。\n\n### 步骤 2：总概率的推导\n\n目标是找到单个肿瘤细胞完成转移级联全部六个步骤的总概率，我们称之为 $P_{total}$。这即为事件 $S_1, S_2, S_3, S_4, S_5$ 和 $S_6$ 的交集概率。\n$$\nP_{total} = P(S_1 \\cap S_2 \\cap S_3 \\cap S_4 \\cap S_5 \\cap S_6)\n$$\n问题陈述明确指示使用条件概率的链式法则。链式法则指出，对于任意 $n$ 个事件 $A_1, A_2, \\dots, A_n$：\n$$\nP(A_1 \\cap A_2 \\cap \\dots \\cap A_n) = P(A_1) \\times P(A_2|A_1) \\times P(A_3|A_1 \\cap A_2) \\times \\dots \\times P(A_n|A_1 \\cap \\dots \\cap A_{n-1})\n$$\n将此规则应用于我们的 $6$ 个事件 $S_1, \\dots, S_6$：\n$$\nP(S_1 \\cap \\dots \\cap S_6) = P(S_1) \\times P(S_2|S_1) \\times P(S_3|S_1 \\cap S_2) \\times P(S_4|S_1 \\cap S_2 \\cap S_3) \\times P(S_5|S_1 \\cap \\dots \\cap S_4) \\times P(S_6|S_1 \\cap \\dots \\cap S_5)\n$$\n现在，我们使用问题陈述中提供的 $p_i$ 的定义。\n问题将 $p_i$ 定义为 $p_i = P(S_i \\,|\\, S_1 \\cap \\dots \\cap S_{i-1})$。\n让我们列出每一项：\n- 对于 $i=1$：$p_1 = P(S_1)$\n- 对于 $i=2$：$p_2 = P(S_2|S_1)$\n- 对于 $i=3$：$p_3 = P(S_3|S_1 \\cap S_2)$\n- 对于 $i=4$：$p_4 = P(S_4|S_1 \\cap S_2 \\cap S_3)$\n- 对于 $i=5$：$p_5 = P(S_5|S_1 \\cap S_2 \\cap S_3 \\cap S_4)$\n- 对于 $i=6$：$p_6 = P(S_6|S_1 \\cap S_2 \\cap S_3 \\cap S_4 \\cap S_5)$\n\n通过将这些定义直接代入从链式法则推导出的表达式中，我们得到总概率 $P_{total}$ 的通用公式：\n$$\nP_{total} = p_1 \\times p_2 \\times p_3 \\times p_4 \\times p_5 \\times p_6 = \\prod_{i=1}^{6} p_i\n$$\n这就是所要求的表达式。它表明，要成功完成一个条件依赖的步骤序列，其总概率是各个条件概率的乘积。\n\n### 步骤 3：数值计算\n\n接下来，我们使用给定的概率 $p_i$ 数值来计算该表达式：\n- $p_1 = 10^{-1}$ (侵袭)\n- $p_2 = 10^{-2}$ (血管内渗)\n- $p_3 = 10^{-3}$ (循环中存活)\n- $p_4 = 10^{-1}$ (停滞)\n- $p_5 = 10^{-2}$ (血管外渗)\n- $p_6 = 10^{-1}$ (生长)\n\n将这些值代入我们推导出的表达式中：\n$$\nP_{total} = (10^{-1}) \\times (10^{-2}) \\times (10^{-3}) \\times (10^{-1}) \\times (10^{-2}) \\times (10^{-1})\n$$\n为计算该乘积，我们使用指数属性 $a^m \\times a^n = a^{m+n}$。我们将所有指数相加：\n$$\n\\text{Sum of exponents} = (-1) + (-2) + (-3) + (-1) + (-2) + (-1) = -10\n$$\n因此，总概率为：\n$$\nP_{total} = 10^{-10}\n$$\n题目要求答案以标准科学记数法表示，并四舍五入至三位有效数字。标准科学记数法的形式为 $a \\times 10^b$，其中 $1 \\le |a|  10$。\n$10^{-10}$ 可以写成 $1 \\times 10^{-10}$。为用三位有效数字表示，我们将系数写为 $1.00$。\n$$\nP_{total} = 1.00 \\times 10^{-10}\n$$\n这个最终值代表了单个肿瘤细胞从原发肿瘤开始，成功建立一个转移性病灶的极低概率。",
            "answer": "$$\n\\boxed{1.00 \\times 10^{-10}}\n$$"
        },
        {
            "introduction": "转移灶要生长到超过微观尺寸，就必须诱导新血管的生成，这一过程被称为血管生成（angiogenesis）。这一过程的核心是内皮细胞如何分化为引领血管生长的“顶端细胞”（tip cell）和构成血管壁的“柄细胞”（stalk cell）。本练习  将引导你通过一个计算模型，探索这一迷人的生物学机制，展示简单的局部细胞间通讯规则如何涌现出复杂的、有序的血管网络模式。",
            "id": "4761561",
            "problem": "要求您推导并实现一个最小化的确定性模型，该模型将血管内皮生长因子 (VEGF; Vascular Endothelial Growth Factor) 的梯度感知与通过 Delta 样配体 4 (Dll4; Delta-like ligand 4) 和 Notch 信号传导实现的侧向抑制相结合，以展示在一维血管片段上交替出现的尖端-柄 (tip-stalk) 细胞模式的形成。建模域为一条由内皮细胞组成的离散直线，细胞索引为 $i \\in \\{0,1,\\dots,N-1\\}$，位于位置 $x_i = i\\,\\Delta x$，其中 $N$ 是细胞总数，$\\Delta x$ 是细胞间的均匀间距。沿血管的细胞外 VEGF 浓度场是静态的，并由线性梯度定义，其中 $V(x)$ 的单位为纳摩尔/升 ($\\mathrm{nM}$)。时间 $t$ 的单位为小时 ($\\mathrm{h}$)。\n\n请仅从以下基本事实出发，推导出一个适合进行数值模拟的最小系统：\n1. 配体-受体占有率随局部配体浓度的增加而增加，并在受体被占满时饱和，这与一级结合等温线一致。定义一个无量纲的信号变量 $S_i$，该变量随局部 $V(x_i)$ 单调递增，并在 $V(x_i)$ 很大时饱和。\n2. 内皮细胞中的 Notch 信号由相邻细胞上的 Dll4 激活，而 Notch 的激活会抑制同一细胞内的 Dll4（侧向抑制），这与已公认的 Notch-Delta 耦合机制一致。使用常微分方程对细胞内 Dll4 的产生和衰变以及 Notch 的激活进行建模，其产生项由局部信号 $S_i$ 和依赖于邻近细胞的耦合驱动，并伴有线性衰变。确保方程是确定性的和空间局域的，仅使用最近邻相互作用。\n3. 尖端细胞表型受 VEGF 信号传导的促进，并受 Notch 激活的抑制。定义一个无量纲的尖端倾向性 $P_i$，它随 $S_i$ 的增加而增加，并随同一细胞中 Notch 激活的增强而减少。使用一个固定阈值将每个细胞分类为尖端细胞 ($T_i = 1$) 或柄细胞 ($T_i = 0$)。\n\n您的程序必须使用对时间 $t$ 的显式前向欧拉离散化方法来实现所推导的系统，从明确的、确定性的初始条件开始，模拟直到系统达到稳态（或模拟指定的步数）。使用边界条件，即每个末端细胞只有一个邻居。模拟必须严格使用以下单位：$V$ 的单位为 $\\mathrm{nM}$，$x$ 的单位为 $\\mu\\mathrm{m}$，$t$ 的单位为 $\\mathrm{h}$。输出不带物理单位。\n\n模拟结束后，为每个测试用例计算并报告两个无量纲指标：\n- 交替分数 $A$，定义为状态不同的相邻细胞对所占的比例，\n$$\nA = \\frac{1}{N-1}\\sum_{i=0}^{N-2} \\mathbf{1}\\big(T_i \\ne T_{i+1}\\big),\n$$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数，且 $T_i \\in \\{0,1\\}$。\n- 尖端细胞比例 $F$，定义为\n$$\nF = \\frac{1}{N}\\sum_{i=0}^{N-1} T_i.\n$$\n\n请针对以下测试套件实现模拟。每个参数集指定：细胞数量 $N$、间距 $\\Delta x$ (单位 $\\mu\\mathrm{m}$)、基线 VEGF $V_0$ (单位 $\\mathrm{nM}$)、VEGF 梯度 $g$ (单位 $\\mathrm{nM}/\\mu\\mathrm{m}$)、配体敏感性常数 $K_V$ (单位 $\\mathrm{nM}$)、Dll4 产生速率 $\\alpha_D$ (单位 $\\mathrm{h}^{-1}$)、Dll4 衰变速率 $\\beta_D$ (单位 $\\mathrm{h}^{-1}$)、Notch 激活速率 $\\alpha_N$ (单位 $\\mathrm{h}^{-1}$)、Notch 衰变速率 $\\beta_N$ (单位 $\\mathrm{h}^{-1}$)、Dll4 抑制强度 $\\lambda$ (无量纲)、尖端抑制强度 $\\gamma$ (无量纲)、尖端阈值 $\\theta$ (无量纲)、时间步长 $\\Delta t$ (单位 $\\mathrm{h}$)，以及步数 $n_{\\text{steps}}$。\n\n测试套件：\n- 案例 1 (中等梯度，强抑制，预期出现交替模式)：\n  $N=20$，$\\Delta x=10$，$V_0=1.5$，$g=0.01$，$K_V=1.0$，$\\alpha_D=1.0$，$\\beta_D=1.0$，$\\alpha_N=2.0$，$\\beta_N=1.0$，$\\lambda=4.0$，$\\gamma=6.0$，$\\theta=0.40$，$\\Delta t=0.05$，$n_{\\text{steps}}=2000$。\n- 案例 2 (平坦梯度，强抑制，预期因对称性导致低交替度)：\n  $N=20$，$\\Delta x=10$，$V_0=2.0$，$g=0.0$，$K_V=1.0$，$\\alpha_D=1.0$，$\\beta_D=1.0$，$\\alpha_N=2.0$，$\\beta_N=1.0$，$\\lambda=4.0$，$\\gamma=6.0$，$\\theta=0.40$，$\\Delta t=0.05$，$n_{\\text{steps}}=2000$。\n- 案例 3 (中等梯度，弱抑制，预期出现连续的尖端细胞区域)：\n  $N=20$，$\\Delta x=10$，$V_0=1.5$，$g=0.01$，$K_V=1.0$，$\\alpha_D=1.0$，$\\beta_D=1.0$，$\\alpha_N=1.0$，$\\beta_N=1.0$，$\\lambda=0.5$，$\\gamma=0.5$，$\\theta=0.40$，$\\Delta t=0.05$，$n_{\\text{steps}}=2000$。\n- 案例 4 (强梯度，强抑制，预期在高 VEGF 端附近出现部分交替)：\n  $N=20$，$\\Delta x=10$，$V_0=1.5$，$g=0.05$，$K_V=1.0$，$\\alpha_D=1.0$，$\\beta_D=1.0$，$\\alpha_N=2.0$，$\\beta_N=1.0$，$\\lambda=4.0$，$\\gamma=6.0$，$\\theta=0.40$，$\\Delta t=0.05$，$n_{\\text{steps}}=2000$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果以双元素列表 $[A,F]$ 的形式报告，顺序与测试套件中的顺序相同（例如，`[[A_1,F_1],[A_2,F_2],\\dots]`）。不应打印任何额外文本。",
            "solution": "我们从核心的生物学和物理学原理出发，推导出一个最小模型。首先，我们通过可饱和的占有率来形式化血管内皮生长因子 (VEGF) 的梯度感知。被占用的受体比例，即下游信号强度，可以用一个无量纲函数来表示，该函数随局部配体浓度增加而增加，并在高浓度下饱和。一种基于一级结合的标准且经过充分检验的表示方法是有理等温线。因此，对于位于位置 $x_i$、经历 VEGF 浓度为 $V(x_i)$ 的细胞，我们定义\n$$\nS_i = \\frac{V(x_i)}{K_V + V(x_i)},\n$$\n其中 $K_V$ 是一个正常数（单位为 $\\mathrm{nM}$），表示配体敏感度的尺度。该映射是 Langmuir 等温线或 Michaelis-Menten 占有率的一种重新标度形式，并作为配体-受体信号传导的一个被广泛接受的模型。\n\n其次，我们将 Delta 样配体 4 (Dll4) 的产生和 Notch 的激活建模为带有耦合的简单线性产生-衰变系统。细胞中的 Notch 信号由相邻细胞上的 Dll4 驱动，而被激活的 Notch 会抑制同一细胞内的 Dll4（侧向抑制）。我们在一维晶格上采用最近邻耦合。设 $D_i(t)$ 表示细胞 $i$ 内的 Dll4 水平（无量纲），$H_i(t)$ 表示 Notch 激活水平（无量纲）。$D_i$ 的产生由局部 VEGF 信号 $S_i$ 驱动，但受到该细胞自身 Notch 激活 $H_i$ 的抑制。与抑制作用与 Notch 水平成比例这一原则相符的最小数学表示，是将产生项除以一个随 $H_i$ 递增的因子。线性衰变使方程闭合：\n$$\n\\frac{dD_i}{dt} = \\alpha_D \\frac{S_i}{1 + \\lambda H_i} - \\beta_D D_i,\n$$\n其中 $\\alpha_D$ 和 $\\beta_D$ 是正常数速率常数（单位为 $\\mathrm{h}^{-1}$），而 $\\lambda$ 是一个无量纲的抑制强度。对于 Notch 的激活，我们将其产生项建模为与相邻 Dll4 水平之和成正比，并伴有线性衰变：\n$$\n\\frac{dH_i}{dt} = \\alpha_N \\sum_{j \\in \\mathcal{N}(i)} D_j - \\beta_N H_i,\n$$\n其中 $\\mathcal{N}(i)$ 表示细胞 $i$ 的最近邻（即，在域内限制为 $i-1$ 和 $i+1$），$\\alpha_N, \\beta_N$ 是正常数速率常数（单位为 $\\mathrm{h}^{-1}$）。对于边界细胞，$\\mathcal{N}(0) = \\{1\\}$ 且 $\\mathcal{N}(N-1) = \\{N-2\\}$。\n\n第三，尖端细胞表型受 VEGF 信号传导的促进，并受 Notch 激活的抑制。我们定义一个尖端倾向性\n$$\nP_i = \\frac{S_i}{1 + \\gamma H_i},\n$$\n其中 $\\gamma$ 是一个无量纲的抑制强度。然后通过一个固定阈值对尖端细胞进行分类：\n$$\nT_i = \n\\begin{cases}\n1,  P_i \\ge \\theta,\\\\\n0,  P_i  \\theta,\n\\end{cases}\n$$\n其中 $\\theta$ 是无量纲的。这捕捉到了实验所支持的观察结果：在低 Notch 水平下，高 VEGF 信号有利于尖端细胞的形成，而高 Notch 激活则会抑制尖端细胞的形成。\n\n沿血管的细胞外 VEGF 场由以下线性梯度指定：\n$$\nV(x_i) = V_0 + g\\,x_i,\n$$\n其中 $V_0$ 是基线 VEGF 浓度（单位为 $\\mathrm{nM}$），$g$ 是梯度（单位为 $\\mathrm{nM}/\\mu\\mathrm{m}$），以及 $x_i = i\\,\\Delta x$，其中 $\\Delta x$ 的单位为 $\\mu\\mathrm{m}$。\n\n初始条件和数值方案：为了获得确定性模拟，我们设置 $D_i(0) = S_i$ 和 $H_i(0) = 0$。我们使用时间步长为 $\\Delta t$（单位为 $\\mathrm{h}$）的显式前向欧拉法对时间进行离散化。在每一步中，我们计算 $D_i$ 的最近邻总和，根据上述常微分方程更新 $H_i$ 和 $D_i$，并持续迭代 $n_{\\text{steps}}$ 次。因为方程右端项对于 $(D_i,H_i)$ 是 Lipschitz 连续的，并且衰变项是线性的，又因为我们选择了足够小的 $\\Delta t$，所以在所考虑的参数范围内，积分在数值上是稳定的。\n\n模式度量：模拟结束后，我们计算交替分数\n$$\nA = \\frac{1}{N-1}\\sum_{i=0}^{N-2} \\mathbf{1}\\big(T_i \\ne T_{i+1}\\big),\n$$\n和尖端细胞比例\n$$\nF = \\frac{1}{N}\\sum_{i=0}^{N-1} T_i.\n$$\n\n科学原理与交替模式的出现：该耦合结构在相邻细胞之间产生了负反馈回路。如果一个细胞 $i$（由 VEGF 梯度的较高 $S_i$ 驱动）获得了较高的 $D_i$，其邻近细胞的 Notch 水平 $H_{i\\pm 1}$ 会增加，这会通过分母中的因子 $(1+\\lambda H_{i\\pm 1})$ 抑制它们的 Dll4 产生。这使得 $P_i$ 相对于 $P_{i\\pm 1}$ 升高，倾向于将 $T_i$ 推向高值，同时将 $T_{i\\pm 1}$ 拉向低值，从而建立反向排列的尖端-柄细胞状态。在一个简化的双细胞稳态分析中，将导数设为零并对耦合进行线性化，结果表明，当 $\\lambda(\\alpha_N/\\beta_N)$ 足够大时，$S$ 的差异会被抑制因子放大，导致相邻细胞间的 $D$ 呈负相关，从而促进棋盘状模式的形成。中等梯度 $g$ 打破了对称性并引发交替；强的侧向抑制（大的 $\\lambda, \\gamma$）增强了反向排列，而弱的抑制（小的 $\\lambda, \\gamma$）则允许连续的尖端细胞区域存在。平坦梯度（$g=0$）产生均匀的 $S_i$；在没有噪声的情况下，对称性得以保持，交替现象会减弱。\n\n每个测试用例的算法如下：\n1. 对 $i=0,\\dots,N-1$，设置 $x_i = i\\,\\Delta x$。\n2. 计算 $V(x_i) = V_0 + g\\,x_i$ 和 $S_i = \\frac{V(x_i)}{K_V + V(x_i)}$。\n3. 初始化 $D_i(0) = S_i$ 和 $H_i(0) = 0$。\n4. 对于 $k=1$ 到 $n_{\\text{steps}}$，计算 $D$ 的最近邻总和，然后更新\n   $D_i \\leftarrow D_i + \\Delta t\\left(\\alpha_D \\frac{S_i}{1+\\lambda H_i} - \\beta_D D_i\\right)$ 和\n   $H_i \\leftarrow H_i + \\Delta t\\left(\\alpha_N \\sum_{j \\in \\mathcal{N}(i)} D_j - \\beta_N H_i\\right)$。\n5. 计算 $P_i = \\frac{S_i}{1 + \\gamma H_i}$ 并通过阈值 $\\theta$ 计算 $T_i$。\n6. 计算 $A$ 和 $F$ 并报告 $[A,F]$。\n\n我们将此算法应用于四个指定的参数集。输出是无量纲的，并为每个案例报告为浮点数。单行输出将四个 $[A,F]$ 元组合并成一个列表：$[[A_1,F_1],[A_2,F_2],[A_3,F_3],[A_4,F_4]]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_case(N, dx, V0, g, K_V, alpha_D, beta_D, alpha_N, beta_N,\n                  lam, gamma, theta, dt, n_steps):\n    # Positions and VEGF field\n    x = np.arange(N) * dx\n    V = V0 + g * x  # nM\n    S = V / (K_V + V)  # dimensionless signaling, saturating\n    \n    # Initialize Dll4 (D) and Notch activation (H)\n    D = S.copy()\n    H = np.zeros(N, dtype=float)\n    \n    # Time integration (explicit Euler)\n    for _ in range(n_steps):\n        # Nearest-neighbor sums of D\n        neighbor_sum = np.zeros(N, dtype=float)\n        if N > 1:\n            neighbor_sum[0] = D[1]\n            neighbor_sum[-1] = D[-2]\n            if N > 2:\n                neighbor_sum[1:-1] = D[:-2] + D[2:]\n        # Update H and D\n        dH = alpha_N * neighbor_sum - beta_N * H\n        H = H + dt * dH\n        dD = alpha_D * (S / (1.0 + lam * H)) - beta_D * D\n        D = D + dt * dD\n    \n    # Tip propensity and classification\n    P = S / (1.0 + gamma * H)\n    T = (P >= theta).astype(int)\n    \n    # Metrics: alternation score A and tip fraction F\n    if N > 1:\n        alt_pairs = np.sum(T[:-1] != T[1:])\n        A = alt_pairs / (N - 1)\n    else:\n        A = 0.0\n    F = np.mean(T)\n    \n    return A, F\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: moderate gradient, strong inhibition\n        {\n            \"N\": 20, \"dx\": 10.0, \"V0\": 1.5, \"g\": 0.01, \"K_V\": 1.0,\n            \"alpha_D\": 1.0, \"beta_D\": 1.0, \"alpha_N\": 2.0, \"beta_N\": 1.0,\n            \"lam\": 4.0, \"gamma\": 6.0, \"theta\": 0.40, \"dt\": 0.05, \"n_steps\": 2000\n        },\n        # Case 2: flat gradient, strong inhibition\n        {\n            \"N\": 20, \"dx\": 10.0, \"V0\": 2.0, \"g\": 0.0, \"K_V\": 1.0,\n            \"alpha_D\": 1.0, \"beta_D\": 1.0, \"alpha_N\": 2.0, \"beta_N\": 1.0,\n            \"lam\": 4.0, \"gamma\": 6.0, \"theta\": 0.40, \"dt\": 0.05, \"n_steps\": 2000\n        },\n        # Case 3: moderate gradient, weak inhibition\n        {\n            \"N\": 20, \"dx\": 10.0, \"V0\": 1.5, \"g\": 0.01, \"K_V\": 1.0,\n            \"alpha_D\": 1.0, \"beta_D\": 1.0, \"alpha_N\": 1.0, \"beta_N\": 1.0,\n            \"lam\": 0.5, \"gamma\": 0.5, \"theta\": 0.40, \"dt\": 0.05, \"n_steps\": 2000\n        },\n        # Case 4: strong gradient, strong inhibition\n        {\n            \"N\": 20, \"dx\": 10.0, \"V0\": 1.5, \"g\": 0.05, \"K_V\": 1.0,\n            \"alpha_D\": 1.0, \"beta_D\": 1.0, \"alpha_N\": 2.0, \"beta_N\": 1.0,\n            \"lam\": 4.0, \"gamma\": 6.0, \"theta\": 0.40, \"dt\": 0.05, \"n_steps\": 2000\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        A, F = simulate_case(\n            case[\"N\"], case[\"dx\"], case[\"V0\"], case[\"g\"], case[\"K_V\"],\n            case[\"alpha_D\"], case[\"beta_D\"], case[\"alpha_N\"], case[\"beta_N\"],\n            case[\"lam\"], case[\"gamma\"], case[\"theta\"], case[\"dt\"], case[\"n_steps\"]\n        )\n        results.append([round(A, 6), round(F, 6)])\n\n    # Final print statement in the exact required format.\n    # Format: list of [A,F] for each test case\n    formatted = \"[\" + \",\".join(\"[\" + \",\".join(f\"{x:.6f}\" for x in pair) + \"]\" for pair in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        }
    ]
}