{
    "hands_on_practices": [
        {
            "introduction": "支气管扩张症的核心病理生理学概念是“恶性循环”假说，即细菌感染、炎症反应和气道损伤之间相互加剧。通过这个练习 ()，你将把这个概念模型转化为一个动态系统，使用一组微分方程来模拟细菌负荷 $B(t)$、炎症 $I(t)$、黏液 $M(t)$ 和清除功能 $F(t)$ 之间的相互作用。这种方法使你能够超越静态的图表，亲手探索这些因素如何随时间演变并驱动疾病的持续进展。",
            "id": "4769624",
            "problem": "您需要将支气管扩张症中恶性循环假说的简化动力学系统模型形式化为一组源自质量平衡和比例原则的无量纲常微分方程。该系统在无量纲时间 $t$ 内追踪四个状态变量的演化：细菌负荷 $B(t)$、炎症活动 $I(t)$、黏液负荷 $M(t)$ 和黏膜纤毛清除 (Mucociliary Clearance (MCC)) 功能 $F(t)$。该模型必须基于以下基本原理：(i) 种群动态，其中变化率是产生率与移除率之差；(ii) 受环境承载力约束的逻辑斯谛增长；(iii) 反映接触依赖性效应的比例相互作用项，从而产生乘积项。您必须仅使用无量纲单位，并通过时间步进提供数值解。本问题不使用物理单位。\n\n根据支气管扩张症病理生理学中以下公认的机制，构建该系统，并表示为无量纲速率方程：\n- 细菌以内禀增长率 $r_B$ 和环境承载力 $K_B$ 进行逻辑斯谛增长，其清除速率与 $F$ 和 $B$ 的乘积成正比，并通过免疫作用被清除，其清除速率与 $I$ 和 $B$ 的乘积成正比。\n- 炎症被细菌激活，激活速率与 $B$ 成正比，并以与 $I$ 成正比的速率衰减。\n- 黏液产生受炎症刺激，其产生速率与 $I$ 成正比，并以与 $M$ 成正比的速率衰减。\n- 黏膜纤毛功能 $F$ 向基线水平 $F_{\\text{base}}$ 恢复，恢复速率与差值 $F_{\\text{base}}-F$ 成正比，其功能受损程度与乘积 $M F$ 和 $I F$ 成正比。\n\n使用这些原则，实现以下无量纲系统：\n$$\n\\frac{dB}{dt} = r_B\\, B\\left(1-\\frac{B}{K_B}\\right) - k_{\\text{clear}}\\,F\\,B - a_I\\, I\\, B,\n$$\n$$\n\\frac{dI}{dt} = s_B\\, B - d_I\\, I,\n$$\n$$\n\\frac{dM}{dt} = s_I\\, I - d_M\\, M,\n$$\n$$\n\\frac{dF}{dt} = r_F\\,(F_{\\text{base}} - F) - c_M\\, M\\, F - c_I\\, I\\, F.\n$$\n\n在时间范围 $T_{\\text{end}}$ 内，使用步长为 $dt$ 的显式欧拉时间步进法。每一步之后，通过将数值限制在相应区间内来强制施加符合生物学合理性的边界条件 $B \\ge 0$，$I \\ge 0$，$M \\ge 0$ 和 $0 \\le F \\le F_{\\text{base}}$。\n\n分类规则：如果在模拟结束时，满足 $B(T_{\\text{end}}) \\ge B_{\\text{crit}}$ 或 $F(T_{\\text{end}}) \\le F_{\\text{crit}}$，则判定系统表现出持续的恶性循环，其中 $B_{\\text{crit}}$ 和 $F_{\\text{crit}}$ 在下方给出。程序必须输出一个布尔值列表，对应每个测试用例的分类结果。\n\n您必须对所有测试用例使用以下数值积分参数：\n- $K_B = 1.0$,\n- $dt = 0.01$,\n- $T_{\\text{end}} = 50.0$,\n- $B_{\\text{crit}} = 0.3$,\n- $F_{\\text{crit}} = 0.5$.\n\n测试套件：对于每个测试用例，您将获得参数集 $\\{r_B, k_{\\text{clear}}, a_I, s_B, d_I, s_I, d_M, r_F, F_{\\text{base}}, c_M, c_I\\}$ 和初始条件 $\\{B(0), I(0), M(0), F(0)\\}$。模拟该系统并报告在时间 $t=T_{\\text{end}}$ 时，恶性循环分类是真还是假。\n\n为以下4个测试用例提供结果：\n- 病例1（预期感染会消退且清除功能得以保留）：$r_B=0.8$, $k_{\\text{clear}}=1.2$, $a_I=0.2$, $s_B=0.6$, $d_I=0.8$, $s_I=0.4$, $d_M=0.5$, $r_F=0.6$, $F_{\\text{base}}=1.0$, $c_M=0.4$, $c_I=0.2$，初始条件 $B(0)=0.2$, $I(0)=0.05$, $M(0)=0.05$, $F(0)=1.0$。\n- 病例2（预期会演变为恶性循环，清除功能受损）：$r_B=0.9$, $k_{\\text{clear}}=0.4$, $a_I=0.05$, $s_B=0.8$, $d_I=0.4$, $s_I=0.9$, $d_M=0.2$, $r_F=0.3$, $F_{\\text{base}}=0.7$, $c_M=0.9$, $c_I=0.6$，初始条件 $B(0)=0.15$, $I(0)=0.1$, $M(0)=0.2$, $F(0)=0.7$。\n- 病例3（边界情况，趋向于消退）：$r_B=0.7$, $k_{\\text{clear}}=0.6$, $a_I=0.1$, $s_B=0.6$, $d_I=0.6$, $s_I=0.5$, $d_M=0.4$, $r_F=0.5$, $F_{\\text{base}}=0.9$, $c_M=0.5$, $c_I=0.3$，初始条件 $B(0)=0.2$, $I(0)=0.05$, $M(0)=0.1$, $F(0)=0.8$。\n- 病例4（边缘情况，无免疫介导的杀伤作用）：$r_B=0.8$, $k_{\\text{clear}}=0.5$, $a_I=0.0$, $s_B=0.5$, $d_I=0.7$, $s_I=0.6$, $d_M=0.3$, $r_F=0.4$, $F_{\\text{base}}=0.8$, $c_M=0.7$, $c_I=0.5$，初始条件 $B(0)=0.2$, $I(0)=0.0$, $M(0)=0.1$, $F(0)=0.8$。\n\n最终输出格式：您的程序应生成单行输出，其中包含布尔分类结果，格式为方括号内的逗号分隔列表，例如 $[{\\tt True},{\\tt False},\\dots]$。输出中不允许包含任何其他文本。",
            "solution": "用户提供的问题已经过分析，并被认为是 **有效的**。它作为一个已知病理生理学假说的简化模型，具有科学依据；作为一个初值问题，在数学上是适定的；并且客观地陈述了所有必要的参数和条件。\n\n该问题要求对一个由四个耦合的一阶非线性常微分方程 (ODE) 组成的系统进行数值求解，该系统模拟了支气管扩张症中的恶性循环假说。系统状态由四个无量纲变量描述：细菌负荷 $B(t)$、炎症活动 $I(t)$、黏液负荷 $M(t)$ 和黏膜纤毛清除 (MCC) 功能 $F(t)$。这些变量在无量纲时间 $t$ 内的演化由以下方程组决定：\n\n$$\n\\frac{dB}{dt} = r_B\\, B\\left(1-\\frac{B}{K_B}\\right) - k_{\\text{clear}}\\,F\\,B - a_I\\, I\\, B\n$$\n$$\n\\frac{dI}{dt} = s_B\\, B - d_I\\, I\n$$\n$$\n\\frac{dM}{dt} = s_I\\, I - d_M\\, M\n$$\n$$\n\\frac{dF}{dt} = r_F\\,(F_{\\text{base}} - F) - c_M\\, M\\, F - c_I\\, I\\, F\n$$\n\n我们将使用显式欧拉方法对该初值问题进行数值求解。该方法根据系统在时间 $t$ 的状态及其变化率来近似其在时间 $t + dt$ 的状态。对于状态向量 $\\mathbf{Y}(t) = [B(t), I(t), M(t), F(t)]^T$ 及其导数 $d\\mathbf{Y}/dt = \\mathbf{f}(\\mathbf{Y}(t))$，大小为 $dt$ 的单个时间步的更新规则是：\n\n$$\n\\mathbf{Y}(t+dt) \\approx \\mathbf{Y}(t) + dt \\cdot \\mathbf{f}(\\mathbf{Y}(t))\n$$\n\n设第 $n$ 个时间步的状态为 $\\mathbf{Y}_n = [B_n, I_n, M_n, F_n]^T$。下一步的状态 $\\mathbf{Y}_{n+1}$ 计算如下：\n$B_{n+1} = B_n + dt \\cdot \\left[ r_B\\, B_n\\left(1-\\frac{B_n}{K_B}\\right) - k_{\\text{clear}}\\,F_n\\,B_n - a_I\\, I_n\\, B_n \\right]$\n$I_{n+1} = I_n + dt \\cdot \\left[ s_B\\, B_n - d_I\\, I_n \\right]$\n$M_{n+1} = M_n + dt \\cdot \\left[ s_I\\, I_n - d_M\\, M_n \\right]$\n$F_{n+1} = F_n + dt \\cdot \\left[ r_F\\,(F_{\\text{base}} - F_n) - c_M\\, M_n\\, F_n - c_I\\, I_n\\, F_n \\right]$\n\n模拟从 $t=0$ 开始，采用给定的初始条件 $\\{B(0), I(0), M(0), F(0)\\}$，使用固定时间步长 $dt = 0.01$，总模拟时间为 $T_{\\text{end}} = 50.0$。总步数为 $N = T_{\\text{end}}/dt = 5000$。\n\n在每个时间步之后，通过限制数值来强制执行以下符合生物学合理性的约束：\n$B_{n+1} = \\max(0, B_{n+1})$\n$I_{n+1} = \\max(0, I_{n+1})$\n$M_{n+1} = \\max(0, M_{n+1})$\n$F_{n+1} = \\max(0, \\min(F_{\\text{base}}, F_{n+1}))$\n\n对所提供的四个测试用例中的每一个都重复此过程。对于每个用例，我们使用其特定的参数集 $\\{r_B, k_{\\text{clear}}, a_I, s_B, d_I, s_I, d_M, r_F, F_{\\text{base}}, c_M, c_I\\}$ 和初始条件，以及全局固定的参数 $K_B = 1.0$，$dt = 0.01$ 和 $T_{\\text{end}} = 50.0$。\n\n在模拟结束时，即 $t=T_{\\text{end}}$，将最终状态值 $B(T_{\\text{end}})$ 和 $F(T_{\\text{end}})$ 与分类标准进行比较评估。如果满足 $B(T_{\\text{end}}) \\ge B_{\\text{crit}}$ 或 $F(T_{\\text{end}}) \\le F_{\\text{crit}}$，则判定存在持续的恶性循环（即结果为 `True`），其中临界阈值给定为 $B_{\\text{crit}} = 0.3$ 和 $F_{\\text{crit}} = 0.5$。否则，结果为 `False`。最终输出是所有测试用例的这些布尔分类结果的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bronchiectasis model for the given test cases and prints the classification results.\n    \"\"\"\n\n    def simulate_case(params, initial_conditions, K_B, dt, T_end):\n        \"\"\"\n        Simulates one test case of the bronchiectasis ODE system using the explicit Euler method.\n\n        Args:\n            params (tuple): A tuple of model parameters (r_B, k_clear, a_I, s_B, d_I, s_I, d_M, r_F, F_base, c_M, c_I).\n            initial_conditions (tuple): The initial state vector (B0, I0, M0, F0).\n            K_B (float): Bacterial carrying capacity.\n            dt (float): Time step for integration.\n            T_end (float): Total simulation time.\n\n        Returns:\n            tuple: The final state of (B, F) at T_end.\n        \"\"\"\n        # Unpack parameters\n        r_B, k_clear, a_I, s_B, d_I, s_I, d_M, r_F, F_base, c_M, c_I = params\n        \n        # Unpack and initialize state variables\n        B, I, M, F = initial_conditions\n\n        # Calculate the number of integration steps\n        num_steps = int(T_end / dt)\n\n        # Time-stepping loop\n        for _ in range(num_steps):\n            # Calculate derivatives at the current state\n            dB_dt = r_B * B * (1.0 - B / K_B) - k_clear * F * B - a_I * I * B\n            dI_dt = s_B * B - d_I * I\n            dM_dt = s_I * I - d_M * M\n            dF_dt = r_F * (F_base - F) - c_M * M * F - c_I * I * F\n\n            # Update state variables using the explicit Euler step\n            B += dt * dB_dt\n            I += dt * dI_dt\n            M += dt * dM_dt\n            F += dt * dF_dt\n\n            # Apply biologically plausible bounds (clamping)\n            B = max(0.0, B)\n            I = max(0.0, I)\n            M = max(0.0, M)\n            F = max(0.0, min(F_base, F))\n\n        return B, F\n\n    # Fixed numerical integration parameters for all cases\n    K_B = 1.0\n    dt = 0.01\n    T_end = 50.0\n    \n    # Classification thresholds\n    B_crit = 0.3\n    F_crit = 0.5\n\n    # Test suite with parameters and initial conditions for each case\n    test_cases = [\n        # Case 1\n        {'params': (0.8, 1.2, 0.2, 0.6, 0.8, 0.4, 0.5, 0.6, 1.0, 0.4, 0.2), \n         'initial': (0.2, 0.05, 0.05, 1.0)},\n        # Case 2\n        {'params': (0.9, 0.4, 0.05, 0.8, 0.4, 0.9, 0.2, 0.3, 0.7, 0.9, 0.6), \n         'initial': (0.15, 0.1, 0.2, 0.7)},\n        # Case 3\n        {'params': (0.7, 0.6, 0.1, 0.6, 0.6, 0.5, 0.4, 0.5, 0.9, 0.5, 0.3), \n         'initial': (0.2, 0.05, 0.1, 0.8)},\n        # Case 4\n        {'params': (0.8, 0.5, 0.0, 0.5, 0.7, 0.6, 0.3, 0.4, 0.8, 0.7, 0.5), \n         'initial': (0.2, 0.0, 0.1, 0.8)},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Run the simulation for the current case\n        B_final, F_final = simulate_case(case['params'], case['initial'], K_B, dt, T_end)\n        \n        # Apply the classification rule\n        is_vicious_cycle = (B_final >= B_crit) or (F_final = F_crit)\n        results.append(is_vicious_cycle)\n\n    # Format the final output as a comma-separated list of booleans in brackets\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "“恶性循环”的一个关键物理后果是气道阻力显著增加，这是导致患者呼吸困难的主要原因。本练习 () 应用了流体动力学的基本原理（泊肃叶定律），要求你量化黏液堵塞和气道结构改变对气流的影响。通过计算和比较儿童与成人支气管扩张模型中的节段气道阻力，你将深刻理解气道半径 $r$（尤其是其对阻力 $R \\propto 1/r^4$ 的四次方反比影响）等结构性因素是如何决定通气功能的。",
            "id": "4769623",
            "problem": "一位研究人员正在通过从第一性原理出发对肺段气道阻力进行建模，来分析不同年龄组支气管扩张症患者的气流受限情况。考虑一名患有支气管扩张症的儿童的单个肺段和一名患有支气管扩张症的成人的单个肺段。在每个肺段内，小支气管被假定为笔直的圆柱体，内部为层流气流，在各自组内尺寸相同，并且功能上呈并联排列。儿童的肺段包含基线数量为 $N_{\\text{base,ped}} = 100$ 的小支气管，其中比例为 $f_{\\text{occl,ped}} = 0.40$ 的支气管被黏液完全阻塞，因此不导气。成人的肺段包含基线数量为 $N_{\\text{base,adult}} = 120$ 的小支气管，其中比例为 $f_{\\text{occl,adult}} = 0.25$ 的支气管被完全阻塞。在通畅的支气管中，儿童的平均内半径为 $r_{\\text{ped}} = 1.2 \\,\\text{mm}$，平均长度为 $L_{\\text{ped}} = 10 \\,\\text{mm}$；成人的平均内半径为 $r_{\\text{adult}} = 1.6 \\,\\text{mm}$，平均长度为 $L_{\\text{adult}} = 12 \\,\\text{mm}$。假设吸入空气的动力黏度在两组中相同，并且在这些小气道中可压缩性效应可以忽略不计。\n\n仅使用流体管道中阻力的基本定义、圆柱管中层流的经过物理检验的关系式以及并联路径的组合规则，推导儿童病例与成人病例的总肺段气道阻力的无量纲比率 $\\frac{R_{\\text{ped}}}{R_{\\text{adult}}}$，并计算其数值。将最终答案表示为四舍五入到三位有效数字的无量纲小数。",
            "solution": "该问题经评估具有科学依据、提法恰当、客观且内部一致。它基于应用于呼吸生理病理学标准模型的流体动力学基本原理（泊肃叶定律）。所有必要数据均已提供，目标明确。因此，该问题被认为是有效的，可以推导出解答。\n\n该问题要求计算儿童病例与成人病例的总肺段气道阻力之比，即 $\\frac{R_{\\text{ped}}}{R_{\\text{adult}}}$。该分析基于一个模型，其中小支气管被视为具有层流气流的笔直圆柱体。\n\n单个圆柱管对层流的阻力 $R_{\\text{single}}$ 由泊肃叶定律给出：\n$$R_{\\text{single}} = \\frac{8\\mu L}{\\pi r^4}$$\n其中 $\\mu$ 是流体的动力黏度，$L$ 是管的长度，$r$ 是其内半径。\n\n首先，我们确定每种情况下导气（通畅）支气管的数量。问题陈述，基线支气管数量 $N_{\\text{base}}$ 的一部分（比例为 $f_{\\text{occl}}$）被阻塞。\n儿童病例中通畅支气管的数量 $N_{\\text{pat,ped}}$ 为：\n$$N_{\\text{pat,ped}} = N_{\\text{base,ped}} (1 - f_{\\text{occl,ped}})$$\n代入给定值：\n$$N_{\\text{pat,ped}} = 100 \\times (1 - 0.40) = 100 \\times 0.60 = 60$$\n\n成人病例中通畅支气管的数量 $N_{\\text{pat,adult}}$ 为：\n$$N_{\\text{pat,adult}} = N_{\\text{base,adult}} (1 - f_{\\text{occl,adult}})$$\n代入给定值：\n$$N_{\\text{pat,adult}} = 120 \\times (1 - 0.25) = 120 \\times 0.75 = 90$$\n\n问题陈述支气管功能上呈并联排列。对于 $N$ 个阻力均为 $R_{\\text{single}}$ 的相同阻力元件并联，总阻力 $R_{\\text{total}}$ 由下式给出：\n$$\\frac{1}{R_{\\text{total}}} = \\sum_{i=1}^{N} \\frac{1}{R_{\\text{single}}} = \\frac{N}{R_{\\text{single}}}$$\n因此，总肺段阻力为：\n$$R_{\\text{total}} = \\frac{R_{\\text{single}}}{N_{\\text{pat}}}$$\n\n将此应用于我们的具体情况：\n儿童肺段的总阻力 $R_{\\text{ped}}$ 为：\n$$R_{\\text{ped}} = \\frac{R_{\\text{single,ped}}}{N_{\\text{pat,ped}}} = \\frac{1}{N_{\\text{pat,ped}}} \\left( \\frac{8\\mu L_{\\text{ped}}}{\\pi r_{\\text{ped}}^4} \\right)$$\n成人肺段的总阻力 $R_{\\text{adult}}$ 为：\n$$R_{\\text{adult}} = \\frac{R_{\\text{single,adult}}}{N_{\\text{pat,adult}}} = \\frac{1}{N_{\\text{pat,adult}}} \\left( \\frac{8\\mu L_{\\text{adult}}}{\\pi r_{\\text{adult}}^4} \\right)$$\n假设动力黏度 $\\mu$ 在两种情况下相同。\n\n我们需要求出无量纲比率 $\\frac{R_{\\text{ped}}}{R_{\\text{adult}}}$。\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{ \\frac{1}{N_{\\text{pat,ped}}} \\left( \\frac{8\\mu L_{\\text{ped}}}{\\pi r_{\\text{ped}}^4} \\right) }{ \\frac{1}{N_{\\text{pat,adult}}} \\left( \\frac{8\\mu L_{\\text{adult}}}{\\pi r_{\\text{adult}}^4} \\right) }$$\n常数 $8$、$\\mu$ 和 $\\pi$ 相互抵消，得到：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{ \\frac{L_{\\text{ped}}}{N_{\\text{pat,ped}} r_{\\text{ped}}^4} }{ \\frac{L_{\\text{adult}}}{N_{\\text{pat,adult}} r_{\\text{adult}}^4} }$$\n重新整理此表达式可得：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\left(\\frac{L_{\\text{ped}}}{L_{\\text{adult}}}\\right) \\left(\\frac{r_{\\text{adult}}}{r_{\\text{ped}}}\\right)^4 \\left(\\frac{N_{\\text{pat,adult}}}{N_{\\text{pat,ped}}}\\right)$$\n\n现在，我们将数值代入此表达式。\n已知：\n$L_{\\text{ped}} = 10 \\,\\text{mm}$，$L_{\\text{adult}} = 12 \\,\\text{mm}$\n$r_{\\text{ped}} = 1.2 \\,\\text{mm}$，$r_{\\text{adult}} = 1.6 \\,\\text{mm}$\n$N_{\\text{pat,ped}} = 60$，$N_{\\text{pat,adult}} = 90$\n\n各比率为：\n$$\\frac{L_{\\text{ped}}}{L_{\\text{adult}}} = \\frac{10}{12} = \\frac{5}{6}$$\n$$\\frac{r_{\\text{adult}}}{r_{\\text{ped}}} = \\frac{1.6}{1.2} = \\frac{16}{12} = \\frac{4}{3}$$\n$$\\frac{N_{\\text{pat,adult}}}{N_{\\text{pat,ped}}} = \\frac{90}{60} = \\frac{3}{2}$$\n\n将这些比率代入主方程：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\left(\\frac{5}{6}\\right) \\left(\\frac{4}{3}\\right)^4 \\left(\\frac{3}{2}\\right)$$\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{5}{6} \\times \\frac{4^4}{3^4} \\times \\frac{3}{2} = \\frac{5}{2 \\times 3} \\times \\frac{256}{81} \\times \\frac{3}{2}$$\n我们可以消去一个因子 $3$：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{5}{2} \\times \\frac{256}{81} \\times \\frac{1}{2} = \\frac{5 \\times 256}{4 \\times 81}$$\n由于 $256 = 4 \\times 64$，我们可以进一步简化：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{5 \\times 64}{81} = \\frac{320}{81}$$\n为了获得最终的数值，我们进行除法运算：\n$$\\frac{R_{\\text{ped}}}{R_{\\text{adult}}} = \\frac{320}{81} \\approx 3.950617...$$\n四舍五入到三位有效数字，该比率为 $3.95$。",
            "answer": "$$\\boxed{3.95}$$"
        },
        {
            "introduction": "将病理生理学的深刻理解转化为临床应用是医学科学的最终目标之一。在这个综合练习中 ()，你将扮演一名临床建模科学家的角色，结合气道流体物理学、黏液纤毛清除模型和一个随机事件模型（泊松过程）来构建一个实用的风险分层工具。这项实践旨在让你理解如何将基础生理参数（如气道半径、黏液粘度和纤毛功能）转化为对未来急性加重风险的量化预测，从而弥合基础科学与临床决策之间的鸿沟。",
            "id": "4769611",
            "problem": "构建一个程序，该程序基于第一性原理生理学和随机事件模型，对支气管扩张症进行机械性风险分层。您的任务是使用以下基本原理和定义，推导、实施和评估一个严重程度到风险的映射，所有计算均以指定单位表示。\n\n使用以下基本原理：\n\n- 气道流动物理学（Hagen–Poiseuille 关系）：对于圆柱形气道中的层流，阻力 $R$ 与 $1/r^4$ 成正比，其中 $r$ 是气道半径。定义一个无量纲的阻塞因子 $O$，即患者基线气道半径 $r_0$ 与当前气道半径 $r$之比的四次方，即当 $r$ 相对于 $r_0$ 减小时，$O$ 增大。\n- 黏液纤毛运输：黏液纤毛速度 $v$ 与纤毛摆动频率 $f_c$ 成线性关系，与黏液动态黏度 $\\mu$ 成反比。给定在基线频率 $f_{c0}$ 和基线黏度 $\\mu_0$ 下的校准基线速度 $v_0$，相对速度满足 $v/v_0 \\propto (f_c/f_{c0})(\\mu_0/\\mu)$。使用校准值 $v_0 = 5\\,\\mathrm{mm/min}$，此时 $f_{c0} = 12\\,\\mathrm{Hz}$ 且 $\\mu_0 = 1\\,\\mathrm{Pa\\cdot s}$。\n- 清除时间：对于长度为 $L$ 的黏液柱，清除时间为 $t_c = L/v$，相应的基线时间为 $t_{c0} = L/v_0$。比率 $t_c/t_{c0}$ 取决于比率 $v_0/v$。\n- 急性加重事件模型：将急性加重建模为强度为每年 $\\lambda$ 的齐次泊松过程的事件。在宿主和环境条件固定的情况下，假设 $\\lambda$ 与阻塞因子和清除时间因子的乘积成正比，并由一个捕获慢性病原体存在的定植乘数 $M \\ge 0$（无量纲）以及患者特异性基线率 $\\lambda_0$（单位为 $\\mathrm{year}^{-1}$）进行缩放。将阻塞和清除时间依赖关系的指数视为1。使用持续时间 $T$（以年为单位）进行预测。\n- 时间窗内的泊松过程概率：给定在持续时间 $T$ 内的事件率 $\\lambda$，在该持续时间内至少发生一次事件的概率 $p$ 满足无记忆过程的标准泊松关系。\n\n使用计算出的在 $T$ 时间内至少发生一次急性加重的概率 $p$ 来定义风险类别：如果 $p  0.2$，则分配整数类别 $C=0$；如果 $0.2 \\le p  0.5$，则 $C=1$；如果 $p \\ge 0.5$，则 $C=2$。将 $p$ 报告为小数（而非百分比），并四舍五入到4位小数。\n\n实施上述模型以评估以下测试套件。每个测试案例提供 $(r_0, r, L, \\mu, f_c, M, \\lambda_0, T)$，单位为 $(\\mathrm{mm}, \\mathrm{mm}, \\mathrm{mm}, \\mathrm{Pa\\cdot s}, \\mathrm{Hz}, \\text{无量纲}, \\mathrm{year}^{-1}, \\mathrm{year})$：\n\n- 测试 A：$r_0 = 2.5$, $r = 2.5$, $L = 30$, $\\mu = 1.0$, $f_c = 12$, $M = 0.8$, $\\lambda_0 = 0.5$, $T = 1.0$。\n- 测试 B：$r_0 = 2.5$, $r = 1.25$, $L = 30$, $\\mu = 1.2$, $f_c = 10$, $M = 1.2$, $\\lambda_0 = 0.4$, $T = 1.0$。\n- 测试 C：$r_0 = 2.5$, $r = 2.5$, $L = 30$, $\\mu = 3.0$, $f_c = 10$, $M = 1.0$, $\\lambda_0 = 0.3$, $T = 1.0$。\n- 测试 D：$r_0 = 2.5$, $r = 2.0$, $L = 30$, $\\mu = 2.0$, $f_c = 9$, $M = 0.0$, $\\lambda_0 = 0.6$, $T = 1.0$。\n- 测试 E：$r_0 = 2.38$, $r = 2.0$, $L = 30$, $\\mu = 1.2$, $f_c = 12$, $M = 0.9$, $\\lambda_0 = 0.32$, $T = 1.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试的结果是序对 $[p,C]$，$p$ 四舍五入到4位小数。例如，总输出格式必须类似于 `[[p_A,C_A],[p_B,C_B],\\dots]`，位于单行上，无额外文本。",
            "solution": "该问题要求构建一个用于支气管扩张症的机械性风险分层模型。该模型必须从气道生理学的第一性原理和急性加重的随机事件模型中推导出来。最终输出将是一系列测试案例的风险分类。\n\n### 步骤1：问题验证\n\n首先对问题陈述进行严格的验证过程。\n\n**提取的已知条件：**\n1.  **气道流动物理学：** 气道阻力 $R$ 与 $1/r^4$ 成正比，其中 $r$ 是气道半径。\n2.  **阻塞因子 ($O$)：** $O$ 是一个无量纲因子，定义为 $O = (r_0/r)^4$，其中 $r_0$ 是基线半径，$r$ 是当前半径。\n3.  **黏液纤毛运输：** 相对黏液纤毛速度 $v/v_0$ 与 $(f_c/f_{c0})(\\mu_0/\\mu)$ 成正比，其中 $v$ 是速度，$f_c$ 是纤毛摆动频率，$\\mu$ 是黏液动态黏度。基线值用下标 $0$ 表示。\n4.  **基线常数：** $v_0 = 5\\,\\mathrm{mm/min}$，$f_{c0} = 12\\,\\mathrm{Hz}$，以及 $\\mu_0 = 1\\,\\mathrm{Pa\\cdot s}$。\n5.  **清除时间 ($t_c$)：** 对于长度为 $L$ 的黏液柱，$t_c = L/v$。基线时间为 $t_{c0} = L/v_0$。\n6.  **事件模型：** 急性加重被建模为强度（率）为每年 $\\lambda$ 的齐次泊松过程。\n7.  **强度模型 ($\\lambda$)：** $\\lambda$ 与阻塞因子 $O$、清除时间因子 $t_c/t_{c0}$、定植乘数 $M \\ge 0$ 以及基线率 $\\lambda_0$（单位为 $\\mathrm{year}^{-1}$）的乘积成正比。依赖关系的指数为1。\n8.  **泊松概率 ($p$)：** 在持续时间 $T$（以年为单位）内至少发生一次事件的概率由标准泊松关系给出。\n9.  **风险分类 ($C$)：**\n    - 如果 $p  0.2$，则 $C=0$。\n    - 如果 $0.2 \\le p  0.5$，则 $C=1$。\n    - 如果 $p \\ge 0.5$，则 $C=2$。\n10. **输出格式：** 报告 $p$（四舍五入到4位小数），每个测试用例的结果格式化为 $[p,C]$。\n11. **测试案例：**\n    - 测试 A：$(r_0=2.5, r=2.5, L=30, \\mu=1.0, f_c=12, M=0.8, \\lambda_0=0.5, T=1.0)$\n    - 测试 B：$(r_0=2.5, r=1.25, L=30, \\mu=1.2, f_c=10, M=1.2, \\lambda_0=0.4, T=1.0)$\n    - 测试 C：$(r_0=2.5, r=2.5, L=30, \\mu=3.0, f_c=10, M=1.0, \\lambda_0=0.3, T=1.0)$\n    - 测试 D：$(r_0=2.5, r=2.0, L=30, \\mu=2.0, f_c=9, M=0.0, \\lambda_0=0.6, T=1.0)$\n    - 测试 E：$(r_0=2.38, r=2.0, L=30, \\mu=1.2, f_c=12, M=0.9, \\lambda_0=0.32, T=1.0)$\n\n**验证结论：**\n该问题是 **有效的**。\n- 它是 **有科学依据的**：该模型基于已建立的生物物理学原理（Hagen–Poiseuille 流动、黏液纤毛运输力学）和标准随机建模技术（泊松过程）。其简化是有原则的，参数值在生理上是合理的。\n- 它是 **适定的**：为每个测试案例提供了所有必要的定义、常数和参数。逻辑是顺序的，并为每个案例导出一个唯一的、确定性的解。\n- 它是 **客观的**：问题陈述使用精确的定量语言，没有歧义或主观论断。\n\n### 步骤2：风险分层模型的推导\n\n核心任务是根据输入参数推导出概率 $p$ 的单一公式。这是通过顺序组合给定的原理来完成的。\n\n**1. 阻塞因子 ($O$)**\n阻塞因子 $O$ 量化了由于管腔变窄而导致的气道阻力增加。根据题目，它被定义为基线气道半径 $r_0$ 与当前半径 $r$ 的比值：\n$$\nO = \\left(\\frac{r_0}{r}\\right)^4\n$$\n该因子是无量纲的。$O$ 的增加表示更严重的阻塞。\n\n**2. 黏液纤毛清除时间因子 ($t_c/t_{c0}$)**\n该因子量化了相对于基线状态清除气道黏液所需时间的变化。首先，我们形式化黏液纤毛速度 $v$ 的关系。问题陈述 $v/v_0 \\propto (f_c/f_{c0})(\\mu_0/\\mu)$。这可以写成 $v/v_0 = k \\cdot (f_c/f_{c0})(\\mu_0/\\mu)$，其中 $k$ 是一个比例常数。在基线条件下（$f_c = f_{c0}$ 和 $\\mu = \\mu_0$），速度必须是基线速度（$v=v_0$）。将这些代入方程得到 $v_0/v_0 = k \\cdot (f_{c0}/f_{c0})(\\mu_0/\\mu_0)$，简化为 $1 = k \\cdot 1 \\cdot 1$，因此 $k=1$。该关系是一个等式：\n$$\n\\frac{v}{v_0} = \\left(\\frac{f_c}{f_{c0}}\\right) \\left(\\frac{\\mu_0}{\\mu}\\right)\n$$\n清除时间为 $t_c = L/v$，其基线为 $t_{c0} = L/v_0$。因此，清除时间的比率为：\n$$\n\\frac{t_c}{t_{c0}} = \\frac{L/v}{L/v_0} = \\frac{v_0}{v}\n$$\n代入速度比的表达式，我们得到清除时间因子：\n$$\n\\frac{t_c}{t_{c0}} = \\left( \\frac{v}{v_0} \\right)^{-1} = \\left[ \\left(\\frac{f_c}{f_{c0}}\\right) \\left(\\frac{\\mu_0}{\\mu}\\right) \\right]^{-1} = \\left(\\frac{f_{c0}}{f_c}\\right) \\left(\\frac{\\mu}{\\mu_0}\\right)\n$$\n这个无量纲因子随着黏液黏度 $\\mu$ 的增加和纤毛摆动频率 $f_c$ 的降低而增加，正确地代表了清除功能受损。长度 $L$ 被抵消，计算相对因子时不需要它。\n\n**3. 急性加重率 ($\\lambda$)**\n急性加重率 $\\lambda$ 被建模为患者基线率 $\\lambda_0$ 与几个无量纲风险乘数的乘积：定植乘数 $M$、阻塞因子 $O$ 和清除时间因子 $t_c/t_{c0}$。问题规定生理学因子的指数为1。\n$$\n\\lambda = \\lambda_0 \\cdot M \\cdot O \\cdot \\left(\\frac{t_c}{t_{c0}}\\right)\n$$\n代入推导出的 $O$ 和 $t_c/t_{c0}$ 的表达式：\n$$\n\\lambda = \\lambda_0 \\cdot M \\cdot \\left(\\frac{r_0}{r}\\right)^4 \\cdot \\left(\\frac{f_{c0}}{f_c}\\right) \\left(\\frac{\\mu}{\\mu_0}\\right)\n$$\n$\\lambda$ 的单位是 $\\mathrm{year}^{-1}$，与 $\\lambda_0$ 一致，因为所有其他因子都是无量纲的。\n\n**4. 急性加重概率 ($p$)**\n对于速率为 $\\lambda$ 的齐次泊松过程，在持续时间为 $T$ 的时间间隔内的事件数 $N$ 服从概率质量函数 $P(N=k) = (\\lambda T)^k e^{-\\lambda T} / k!$。至少发生一次事件的概率是 $p = P(N \\ge 1) = 1 - P(N=0)$。\n$$\nP(N=0) = \\frac{(\\lambda T)^0 e^{-\\lambda T}}{0!} = e^{-\\lambda T}\n$$\n因此，至少发生一次急性加重的概率是：\n$$\np = 1 - e^{-\\lambda T}\n$$\n代入 $\\lambda$ 的完整表达式：\n$$\np = 1 - \\exp\\left( - \\lambda_0 \\cdot M \\cdot T \\cdot \\left(\\frac{r_0}{r}\\right)^4 \\cdot \\left(\\frac{f_{c0}}{f_c}\\right) \\left(\\frac{\\mu}{\\mu_0}\\right) \\right)\n$$\n这个方程是该机械性模型的最终形式。\n\n**5. 风险分类 ($C$)**\n计算出的概率 $p$ 用于根据指定的阈值分配一个离散的风险类别 $C$（一个整数）：\n- 如果 $p  0.2$，则 $C=0$（低风险）。\n- 如果 $0.2 \\le p  0.5$，则 $C=1$（中风险）。\n- 如果 $p \\ge 0.5$，则 $C=2$（高风险）。\n\n### 步骤3：应用于测试案例\n\n现在应用推导出的模型来计算每个测试案例的风险。基线常数为 $f_{c0} = 12\\,\\mathrm{Hz}$ 和 $\\mu_0 = 1\\,\\mathrm{Pa\\cdot s}$。\n\n作为演示，我们将计算测试案例B的结果：\n- 给定参数：$r_0 = 2.5\\,\\mathrm{mm}$，$r = 1.25\\,\\mathrm{mm}$，$\\mu = 1.2\\,\\mathrm{Pa\\cdot s}$，$f_c = 10\\,\\mathrm{Hz}$，$M = 1.2$，$\\lambda_0 = 0.4\\,\\mathrm{year}^{-1}$，$T = 1.0\\,\\mathrm{year}$。\n- 计算总速率项 $\\lambda T$：\n$$\n\\lambda T = \\lambda_0 \\cdot M \\cdot T \\cdot \\left(\\frac{r_0}{r}\\right)^4 \\cdot \\left(\\frac{f_{c0}}{f_c}\\right) \\left(\\frac{\\mu}{\\mu_0}\\right)\n$$\n$$\n\\lambda T = (0.4) \\cdot (1.2) \\cdot (1.0) \\cdot \\left(\\frac{2.5}{1.25}\\right)^4 \\cdot \\left(\\frac{12}{10}\\right) \\left(\\frac{1.2}{1.0}\\right)\n$$\n$$\n\\lambda T = (0.48) \\cdot (2)^4 \\cdot (1.2) \\cdot (1.2) = 0.48 \\cdot 16 \\cdot 1.44 = 11.0592\n$$\n- 计算概率 $p$：\n$$\np = 1 - e^{-11.0592} \\approx 1 - 0.00001578 \\approx 0.999984\n$$\n- 将 $p$ 四舍五入到4位小数：$p \\approx 1.0000$。\n- 确定风险类别 $C$：由于 $p = 1.0000 \\ge 0.5$，因此 $C=2$。\n- 测试案例B的结果是 $[1.0000, 2]$。\n\n对所有测试案例以编程方式实施相同的过程，以生成最终输出。该实现将确保按照规定进行精确的四舍五入和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a mechanistic risk stratification model for bronchiectasis\n    based on first-principles physiology and a stochastic event model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (r0, r, L, mu, fc, M, lambda0, T)\n    # Units: (mm, mm, mm, Pa.s, Hz, dimensionless, year^-1, year)\n    test_cases = [\n        # Test A\n        (2.5, 2.5, 30, 1.0, 12, 0.8, 0.5, 1.0),\n        # Test B\n        (2.5, 1.25, 30, 1.2, 10, 1.2, 0.4, 1.0),\n        # Test C\n        (2.5, 2.5, 30, 3.0, 10, 1.0, 0.3, 1.0),\n        # Test D\n        (2.5, 2.0, 30, 2.0, 9, 0.0, 0.6, 1.0),\n        # Test E\n        (2.38, 2.0, 30, 1.2, 12, 0.9, 0.32, 1.0),\n    ]\n\n    # Baseline physiological constants\n    fc0 = 12.0  # Baseline ciliary beat frequency in Hz\n    mu0 = 1.0   # Baseline mucus viscosity in Pa.s\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        # Note: L (mucus column length) is not needed for the calculation\n        # as it cancels out in the relative clearance time factor.\n        r0, r, _, mu, fc, M, lambda0, T = case\n\n        # Step 1: Calculate the dimensionless obstruction factor (O)\n        # O = (r0 / r)^4\n        obstruction_factor = (r0 / r)**4\n\n        # Step 2: Calculate the dimensionless clearance time factor (tc/tc0)\n        # tc/tc0 = (fc0 / fc) * (mu / mu0)\n        clearance_time_factor = (fc0 / fc) * (mu / mu0)\n\n        # Step 3: Calculate the exacerbation rate (lambda) in events per year\n        # lambda = lambda0 * M * O * (tc/tc0)\n        lambda_rate = lambda0 * M * obstruction_factor * clearance_time_factor\n\n        # Step 4: Calculate the probability (p) of at least one exacerbation\n        # over duration T using the Poisson process formula p = 1 - exp(-lambda*T)\n        p = 1.0 - np.exp(-lambda_rate * T)\n\n        # Round p to 4 decimal places as required\n        p_rounded = round(p, 4)\n\n        # Step 5: Determine the risk category (C) based on p\n        if p_rounded  0.2:\n            C = 0\n        elif p_rounded  0.5:\n            C = 1\n        else:\n            C = 2\n            \n        # Format the result pair for this case as a string '[p,C]'\n        # to ensure no spaces are present, as per the example format.\n        # The f-string formatting ensures trailing zeros for the float part.\n        result_str = f\"[{p_rounded:.4f},{C}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format: [[pA,CA],[pB,CB],...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}