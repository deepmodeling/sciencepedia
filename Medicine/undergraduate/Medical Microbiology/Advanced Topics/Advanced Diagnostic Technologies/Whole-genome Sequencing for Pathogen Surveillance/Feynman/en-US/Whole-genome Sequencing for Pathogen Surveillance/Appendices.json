{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing sequencing data is often the most critical: determining if you have enough high-quality data to answer your biological question. This is especially challenging for clinical samples, which are frequently dominated by host DNA. This exercise  will walk you through the practical calculation of effective pathogen coverage from a mixed sample and how to use this metric to decide whether downstream analyses like genome assembly or variant calling are feasible.",
            "id": "4688565",
            "problem": "A public health laboratory performs whole-genome sequencing (WGS) directly on a nasopharyngeal swab during an outbreak to monitor a suspected bacterial pathogen. Sequencing produced $R$ paired-end read pairs, each read of length $L$ nucleotides, from a mixed sample in which a fraction $h$ of reads are of human origin. Among the non-human reads, a fraction $f$ taxonomically classifies to the pathogen of interest. The pathogen genome size is $G$ nucleotides. Assume all pathogen-assigned reads map uniquely and uniformly across the pathogen genome.\n\nUsing only core definitions and well-tested assumptions:\n- Average depth (also called coverage) is defined as total sequenced bases assigned to the target divided by the target genome size.\n- Under the classical random coverage (Poisson) model of Lander and Waterman, the number of times a given base is covered follows a Poisson distribution with mean equal to the average depth; therefore, the expected breadth of coverage (the fraction of bases covered at least once) can be derived from this model.\n\nGiven the following values:\n- $R = 25{,}000{,}000$ read pairs,\n- $L = 150$ nucleotides per read,\n- $h = 0.98$,\n- $f = 0.70$,\n- $G = 4{,}800{,}000$ nucleotides,\n\ncompute the expected residual pathogen average depth after excluding human reads and accounting for the taxonomic fraction $f$. Then, under the Poisson coverage assumption, assess viability for de novo assembly and for single-nucleotide variant calling using the following criteria:\n- Assembly is viable if average depth is at least $30$ and expected breadth is at least $0.95$.\n- Variant calling is viable if average depth is at least $20$ and expected breadth is at least $0.90$.\n\nReport as your final answer only the computed residual pathogen average depth as a pure number (fold depth, dimensionless), rounded to three significant figures. Use any additional conclusions only in your solution reasoning; do not include them in the final answer.",
            "solution": "The problem has been validated and is scientifically grounded, well-posed, and objective. It contains sufficient information for a unique solution based on established principles in genomics and bioinformatics.\n\nThe objective is to compute the average sequencing depth for a pathogen genome from a metagenomic sample and subsequently assess the viability for de novo assembly and single-nucleotide variant (SNV) calling based on given criteria.\n\nThe following parameters are provided:\n- Total number of paired-end read pairs: $R = 25,000,000 = 2.5 \\times 10^7$\n- Length of each read: $L = 150$ nucleotides\n- Fraction of human reads (host contamination): $h = 0.98$\n- Fraction of pathogen reads among non-human reads: $f = 0.70$\n- Pathogen genome size: $G = 4,800,000 = 4.8 \\times 10^6$ nucleotides\n\nFirst, we calculate the total number of sequenced bases in the experiment. Since there are $R$ read pairs and each read has a length of $L$, the total number of reads is $2R$, and the total number of sequenced bases, $B_{total}$, is:\n$$B_{total} = 2 \\times R \\times L$$\n\nNext, we determine the number of bases that belong to the pathogen of interest. The fraction of reads originating from human DNA is $h$. Therefore, the fraction of non-human reads is $(1 - h)$.\nFraction of non-human reads $= 1 - 0.98 = 0.02$.\n\nOf these non-human reads, a fraction $f$ is attributed to the pathogen. Thus, the total number of bases sequenced from the pathogen, $B_{pathogen}$, is:\n$$B_{pathogen} = B_{total} \\times (1 - h) \\times f = 2 \\times R \\times L \\times (1 - h) \\times f$$\n\nSubstituting the given values:\n$$B_{pathogen} = 2 \\times (2.5 \\times 10^7) \\times 150 \\times (1 - 0.98) \\times 0.70$$\n$$B_{pathogen} = (5.0 \\times 10^7) \\times 150 \\times 0.02 \\times 0.70$$\n$$B_{pathogen} = (7.5 \\times 10^9) \\times 0.014$$\n$$B_{pathogen} = 1.05 \\times 10^8 \\text{ bases}$$\n\nThe average depth, also known as coverage ($C$), is defined as the total number of bases assigned to the target genome divided by the size of the target genome.\n$$C = \\frac{B_{pathogen}}{G}$$\n\nUsing the calculated value for $B_{pathogen}$ and the given value for $G$:\n$$C = \\frac{1.05 \\times 10^8}{4.8 \\times 10^6}$$\n$$C = \\frac{105}{4.8} = \\frac{1050}{48} = \\frac{525}{24} = \\frac{175}{8}$$\n$$C = 21.875$$\nThe average depth of coverage for the pathogen genome is $21.875\\text{x}$. The problem requests this value rounded to three significant figures, which is $21.9$.\n\nNow, we must assess the viability for de novo assembly and variant calling. This requires calculating the expected breadth of coverage. According to the Lander-Waterman model, the probability that a given base is not covered (i.e., covered $0$ times) follows a Poisson distribution with mean $\\lambda = C$. The probability of zero coverage, $P(k=0)$, is:\n$$P(k=0) = \\frac{e^{-C} C^0}{0!} = e^{-C}$$\nThe expected breadth of coverage, $B$, is the fraction of the genome covered at least once, which is $1 - P(k=0)$.\n$$B = 1 - e^{-C}$$\nFor our calculated average depth $C = 21.875$:\n$$B = 1 - e^{-21.875}$$\nThe value of $e^{-21.875}$ is extremely small, approximately $3.16 \\times 10^{-10}$. Therefore, the breadth of coverage is effectively $1.0$ to a very high precision.\n$$B \\approx 1.0$$\n\nWe can now evaluate the viability based on the provided criteria:\n\n1.  **De novo assembly viability:**\n    - Criterion 1: Average depth $\\ge 30$. Our calculated depth is $C = 21.875$. Since $21.875 < 30$, this criterion is **not met**.\n    - Criterion 2: Expected breadth $\\ge 0.95$. Our calculated breadth is $B \\approx 1.0$. Since $1.0 \\ge 0.95$, this criterion is met.\n    - Because the average depth criterion is not met, de novo assembly is deemed **not viable**.\n\n2.  **SNV calling viability:**\n    - Criterion 1: Average depth $\\ge 20$. Our calculated depth is $C = 21.875$. Since $21.875 \\ge 20$, this criterion is **met**.\n    - Criterion 2: Expected breadth $\\ge 0.90$. Our calculated breadth is $B \\approx 1.0$. Since $1.0 \\ge 0.90$, this criterion is **met**.\n    - Because both criteria are met, SNV calling is deemed **viable**.\n\nThe problem asks for the computed residual pathogen average depth, rounded to three significant figures.\n\nAverage Depth $C = 21.875$.\nRounding to three significant figures gives $21.9$.",
            "answer": "$$\\boxed{21.9}$$"
        },
        {
            "introduction": "With sufficient sequencing coverage, the next challenge is to distinguish true genetic variants from random sequencing errors. This is fundamentally a probabilistic question, where we weigh the evidence in the data against the possibility of error. By applying Bayes' theorem, we can formally calculate the confidence we have in a potential variant, a cornerstone of modern bioinformatics, as you will explore in this problem .",
            "id": "4688508",
            "problem": "In a pathogen outbreak investigation using Whole-Genome Sequencing (WGS), a site in the genome shows evidence for a non-reference base from sequencing data. Suppose there are $k$ independent reads supporting this same non-reference base at the site, and the average Phred quality score (Phred) of those base calls is $Q$. Assume the following generative model:\n\n- The Phred quality score $Q$ relates to the probability of an incorrect base call $p_{\\mathrm{err}}$ by the definition of Phred quality, namely $Q = -10 \\log_{10}(p_{\\mathrm{err}})$. This implies $p_{\\mathrm{err}} = 10^{-Q/10}$.\n- Under the hypothesis of a true variant at the site ($H_{1}$), each supporting read correctly reports the non-reference base with probability $1 - p_{\\mathrm{err}}$, independently across reads.\n- Under the hypothesis of no true variant ($H_{0}$), each supporting read reports the non-reference base only by sequencing error with probability $p_{\\mathrm{err}}$, independently across reads.\n- The prior probability that any given site harbors a true variant in this pathogen sample is $\\pi$, and the prior probability of no true variant is $1 - \\pi$.\n\nUsing Bayes’ theorem and the assumptions above, derive a closed-form expression for the posterior probability of a true variant at the site, $P(H_{1} \\mid \\text{$k$ supporting reads with average quality $Q$})$, in terms of $k$, $Q$, and $\\pi$. Your final answer must be a single closed-form analytic expression. No numerical approximation is required.",
            "solution": "The objective is to derive a closed-form expression for the posterior probability of a true variant at a genomic site, given evidence from whole-genome sequencing data. We are asked to find $P(H_{1} \\mid D)$, where $H_{1}$ is the hypothesis that a true variant exists, and $D$ is the observation of $k$ independent reads supporting a non-reference base, with an average Phred quality score of $Q$.\n\nWe begin by applying Bayes’ theorem, which relates the posterior probability to the prior probability and the likelihood of the data:\n$$\nP(H_{1} \\mid D) = \\frac{P(D \\mid H_{1}) P(H_{1})}{P(D)}\n$$\n\nThe denominator, $P(D)$, is the marginal probability of observing the data, which can be computed using the law of total probability by summing over all possible hypotheses. In this case, there are two mutually exclusive hypotheses: $H_{1}$ (a true variant exists) and $H_{0}$ (no true variant exists).\n$$\nP(D) = P(D \\mid H_{1}) P(H_{1}) + P(D \\mid H_{0}) P(H_{0})\n$$\n\nSubstituting this into the Bayes' theorem expression gives:\n$$\nP(H_{1} \\mid D) = \\frac{P(D \\mid H_{1}) P(H_{1})}{P(D \\mid H_{1}) P(H_{1}) + P(D \\mid H_{0}) P(H_{0})}\n$$\n\nNext, we must define the terms in this equation based on the problem statement.\n\nThe prior probabilities are given as:\n-   $P(H_{1}) = \\pi$ (the prior probability of a true variant)\n-   $P(H_{0}) = 1 - \\pi$ (the prior probability of no true variant)\n\nThe Phred quality score $Q$ is related to the probability of an incorrect base call, $p_{\\mathrm{err}}$, by the formula:\n$$\nQ = -10 \\log_{10}(p_{\\mathrm{err}})\n$$\nSolving for $p_{\\mathrm{err}}$, we get:\n$$\np_{\\mathrm{err}} = 10^{-Q/10}\n$$\nThis value of $p_{\\mathrm{err}}$ will be treated as the error probability for each of the $k$ reads. The probability of a *correct* base call is therefore $1 - p_{\\mathrm{err}}$.\n\nNow, we formulate the likelihoods, which are the probabilities of observing the data $D$ under each hypothesis. The data $D$ is the event that all $k$ independent reads support the non-reference base.\n\n1.  Likelihood under hypothesis $H_{1}$ (true variant):\n    If a true variant exists, observing a read that supports this variant is a *correct* call. The probability for a single read to be correct is $1 - p_{\\mathrm{err}}$. Since the $k$ reads are independent, the probability that all $k$ reads correctly report the variant is:\n    $$\n    P(D \\mid H_{1}) = (1 - p_{\\mathrm{err}})^k\n    $$\n\n2.  Likelihood under hypothesis $H_{0}$ (no true variant):\n    If no true variant exists, observing a read that supports the non-reference base must be a sequencing *error*. The probability for a single read to be an error is $p_{\\mathrm{err}}$. Since the $k$ reads are independent, the probability that all $k$ reads erroneously report the non-reference base is:\n    $$\n    P(D \\mid H_{0}) = (p_{\\mathrm{err}})^k\n    $$\n\nNow, we substitute the priors and the derived likelihoods into the full Bayesian formula:\n$$\nP(H_{1} \\mid D) = \\frac{(1 - p_{\\mathrm{err}})^k \\cdot \\pi}{(1 - p_{\\mathrm{err}})^k \\cdot \\pi + (p_{\\mathrm{err}})^k \\cdot (1 - \\pi)}\n$$\n\nThe final step is to express this posterior probability in terms of the given variables $k$, $Q$, and $\\pi$. We substitute $p_{\\mathrm{err}} = 10^{-Q/10}$ into the expression:\n$$\nP(H_{1} \\mid \\text{$k$ reads, quality $Q$}) = \\frac{\\pi (1 - 10^{-Q/10})^k}{\\pi (1 - 10^{-Q/10})^k + (1 - \\pi) (10^{-Q/10})^k}\n$$\n\nThis equation represents the closed-form expression for the posterior probability of a true variant. It can be further simplified to highlight the role of the prior odds and the likelihood ratio. Let's divide the numerator and the denominator by $\\pi (1 - 10^{-Q/10})^k$:\n$$\nP(H_{1} \\mid D) = \\frac{1}{1 + \\frac{(1 - \\pi)}{\\pi} \\frac{(10^{-Q/10})^k}{(1 - 10^{-Q/10})^k}}\n$$\nThis can be written as:\n$$\nP(H_{1} \\mid D) = \\frac{1}{1 + \\frac{1 - \\pi}{\\pi} \\left( \\frac{10^{-Q/10}}{1 - 10^{-Q/10}} \\right)^k}\n$$\nBoth forms are equivalent. The first form derived is more direct. We will present the first form as the final answer.",
            "answer": "$$\n\\boxed{\\frac{\\pi (1 - 10^{-Q/10})^k}{\\pi (1 - 10^{-Q/10})^k + (1 - \\pi) (10^{-Q/10})^k}}\n$$"
        },
        {
            "introduction": "The genetic differences between two pathogen genomes, or Single Nucleotide Polymorphisms (SNPs), serve as a molecular clock, ticking away as the pathogens evolve. By counting these differences and knowing the mutation rate, we can estimate how long it has been since two lineages shared a common ancestor. This exercise  will guide you through the derivation of this estimate, a powerful tool for reconstructing transmission timelines in an outbreak.",
            "id": "4688541",
            "problem": "In whole-genome sequencing (WGS) for pathogen surveillance, two isolates are compared by their observed pairwise single-nucleotide polymorphism (SNP) distance. Suppose point mutations at each site occur independently according to a Poisson process with a constant per-site rate $\\mu$ (per site per year). Across a genome of $L$ independently evolving sites, the total mutation process along one lineage is assumed to be the superposition of $L$ independent Poisson processes. Under these assumptions, differences between two isolates accumulate along both lineages after they diverge from their most recent common ancestor, and the time to the most recent common ancestor (TMRCA) is denoted by $t$ (in years).\n\nStarting from these fundamental assumptions and properties of Poisson processes, derive an expression for the expected time to common ancestry in terms of the observed pairwise SNP count $d$, the per-site mutation rate $\\mu$, and the genome length $L$. Then evaluate your expression using $\\mu = 1.0 \\times 10^{-6}$, $L = 5.0 \\times 10^{6}$, and an observed pairwise SNP distance $d = 24$. Express the final answer in years and round your numerical result to three significant figures.",
            "solution": "The problem asks for a derivation of the expected time to the most recent common ancestor ($t$) based on a set of assumptions about the molecular evolutionary process, and then for a numerical evaluation of this expression.\n\nFirst, we must validate the problem statement.\nThe givens are:\n1.  Point mutations at a single site occur as a Poisson process with a constant rate $\\mu$ (per site per year).\n2.  The genome consists of $L$ independently evolving sites.\n3.  The total mutation process is the superposition of $L$ independent Poisson processes.\n4.  Two isolates diverged from a common ancestor at a time $t$ years ago (TMRCA).\n5.  The observed pairwise single-nucleotide polymorphism (SNP) count is $d$.\n6.  The numerical values for evaluation are: $\\mu = 1.0 \\times 10^{-6}$, $L = 5.0 \\times 10^{6}$, and $d = 24$.\n\nThe problem is scientifically grounded, as it uses the Poisson process to model mutations, a standard and fundamental assumption in molecular clock theory and phylogenetics. It is well-posed, providing all necessary information ($d, \\mu, L$) to derive an expression for $t$ and subsequently calculate a numerical value. The language is objective and precise. The provided parameters are realistic for microbial genomics. Therefore, the problem is deemed valid.\n\nWe now proceed with the derivation.\n\nThe fundamental assumption is that the number of mutations occurring at a single site along a lineage follows a Poisson distribution. The rate of this process is given as $\\mu$ mutations per site per year.\n\nThe two isolates being compared diverged from their most recent common ancestor at a time $t$ in the past. The evolutionary path connecting these two isolates consists of two separate lineages branching from this common ancestor, each of length $t$. Therefore, the total time over which mutations could accumulate to create differences between the two isolates is the sum of the lengths of these two lineages, which is $t + t = 2t$ years.\n\nFor a single site in the genome (let's say site $i$), the number of mutations, $N_i$, that have occurred over the total divergence time of $2t$ follows a Poisson distribution. The parameter of a Poisson distribution, often denoted $\\lambda$, is the product of the rate and the time interval. In this case, the rate is $\\mu$ and the total time interval is $2t$. Thus, the parameter for a single site is $\\lambda_{\\text{site}} = \\mu \\times (2t) = 2\\mu t$.\nSo, for any site $i$, the number of mutations $N_i$ is a random variable described by:\n$$N_i \\sim \\text{Poisson}(2\\mu t)$$\n\nThe problem states that the genome consists of $L$ such sites, and they evolve independently. The total number of SNPs observed between the two genomes, which we denote by the random variable $D$, is the sum of the mutations at each of the $L$ sites:\n$$D = \\sum_{i=1}^{L} N_i$$\n\nA crucial property of the Poisson distribution is that the sum of independent Poisson-distributed random variables is also a Poisson-distributed random variable. The parameter of the resulting distribution is the sum of the parameters of the individual distributions. Since each of the $L$ sites has the same parameter $\\lambda_{\\text{site}} = 2\\mu t$, the parameter for the total number of SNPs, $\\lambda_{\\text{total}}$, is:\n$$\\lambda_{\\text{total}} = \\sum_{i=1}^{L} (2\\mu t) = L \\times (2\\mu t) = 2\\mu L t$$\n\nTherefore, the total number of SNPs, $D$, is a random variable following the distribution:\n$$D \\sim \\text{Poisson}(2\\mu L t)$$\n\nThe expected value, $E[D]$, of a Poisson-distributed random variable is equal to its parameter $\\lambda$. Thus, the expected number of SNPs between the two isolates is:\n$$E[D] = 2\\mu L t$$\n\nThe problem provides the *observed* pairwise SNP count, $d$. In the context of parameter estimation, the observed count $d$ serves as the canonical estimate for the expected value $E[D]$. This is the basis for both the method of moments and the maximum likelihood estimation for the rate of a Poisson process. We therefore set the observed count equal to the expected value to find an estimate for the time parameter $t$:\n$$d \\approx E[D] = 2\\mu L t$$\n\nRearranging this equation to solve for $t$, we obtain the desired expression for the time to the most recent common ancestor:\n$$t = \\frac{d}{2\\mu L}$$\n\nThis is the general expression derived from the given assumptions. We now evaluate this expression using the provided numerical values:\n- Observed SNP count, $d = 24$\n- Per-site mutation rate, $\\mu = 1.0 \\times 10^{-6} \\text{ years}^{-1}$\n- Genome length, $L = 5.0 \\times 10^{6} \\text{ sites}$\n\nSubstituting these values into our derived formula for $t$:\n$$t = \\frac{24}{2 \\times (1.0 \\times 10^{-6}) \\times (5.0 \\times 10^{6})}$$\n\nFirst, we compute the value of the denominator:\n$$2 \\times (1.0 \\times 10^{-6}) \\times (5.0 \\times 10^{6}) = 2 \\times 1.0 \\times 5.0 \\times 10^{-6} \\times 10^{6} = 10.0 \\times 10^{0} = 10.0$$\nThe unit of the denominator is years$^{-1}$.\n\nNow, we can calculate $t$:\n$$t = \\frac{24}{10.0} = 2.4 \\text{ years}$$\n\nThe problem requires the final numerical answer to be rounded to three significant figures. The calculated value $2.4$ has two significant figures. To express this with three significant figures, we write it as $2.40$.",
            "answer": "$$\\boxed{2.40}$$"
        }
    ]
}