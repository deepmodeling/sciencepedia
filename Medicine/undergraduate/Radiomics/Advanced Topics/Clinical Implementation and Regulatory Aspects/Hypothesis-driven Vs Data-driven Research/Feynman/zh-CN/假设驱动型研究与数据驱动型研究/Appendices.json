{
    "hands_on_practices": [
        {
            "introduction": "在任何多中心放射组学研究中，确保数据的一致性是至关重要的第一步。一个纯粹由数据驱动的方法可能会错误地将不同扫描仪或成像协议引起的技术性差异解读为有意义的生物学信号。相比之下，一个由假说驱动的方法会预见到这些潜在的混杂因素，并主动进行校正。这项练习通过一个具体的计算任务，向我们展示了为什么数据标准化对于获得可靠和可重复的研究结果是必不可少的。",
            "id": "4544647",
            "problem": "一项放射组学研究汇集了来自两个中心的磁共振成像（MRI）图像，以构建肿瘤表型的预测模型。在假设驱动的设计中，您假定在经过适当的标准化之后，同一组织病理学类别内的固定感兴趣区域（ROI）在不同中心之间应具有可比的放射组学特征。在纯粹由数据驱动的探索中，处理流程可能会天真地将中心间的特征差异视为判别信号。中心间虚假差异的一个已知来源是强度非标准化：扫描仪和重建流程可能会对底层组织信号产生不同的线性缩放。\n\n考虑一个感兴趣区域（ROI），其中中心A的体素强度以任意单位（a.u.）测量为 $[70, 74, 76, 72, 68, 80]$，中心B的体素强度测量为 $[30, 40, 45, 35, 25, 55]$。假设这些强度来自相同的基础组织微观结构，但存在中心特异性的线性缩放，并且对于此ROI，中心之间没有生物学差异。\n\n使用第一性原理和标准定义，完成以下任务：\n1. 对每个中心，在进行任何标准化之前，计算由 $$E = \\sum_{i=1}^{n} x_i^2$$ 定义的一阶放射组学“能量”特征，并在假设驱动与数据驱动的背景下解释结果。\n2. 指定一种逐中心的 $z$-score 变换以恢复可比性，使用分别由以下公式定义的总体均值和总体标准差：$$\\mu = \\frac{1}{n}\\sum_{i=1}^{n} x_i, \\quad \\sigma = \\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} (x_i - \\mu)^2}, \\quad z_i = \\frac{x_i - \\mu}{\\sigma}.$$\n3. 计算每个中心标准化强度后的能量 $$E^{(z)} = \\sum_{i=1}^{n} z_i^2,$$ 然后计算比率 $$R = \\frac{E^{(z)}_{\\text{A}}}{E^{(z)}_{\\text{B}}}.$$\n\n将 $R$ 的最终答案表示为精确值。$R$ 无需单位，因为它是无量纲的。如果报告任何中间数值，则无需四舍五入；如果任何中间步骤需要四舍五入，则保留四位有效数字。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它具有科学依据，问题定义明确，客观且内部一致。它提出了放射组学领域中一个现实的场景，即需要通过数据标准化来校正医学影像数据中的中心间变异性。所有必要的定义和数据均已提供。\n\n问题要求对两个中心（A和B）之间的放射组学特征可比性进行三部分分析。我们将系统地处理每个部分。\n\n提供的感兴趣区域（ROI）的强度数据如下：\n- 中心A: $X_A = [70, 74, 76, 72, 68, 80]$\n- 中心B: $X_B = [30, 40, 45, 35, 25, 55]$\n\n对于两个中心，体素（样本）数量均为 $n=6$。\n\n**1. 标准化前能量的计算与解释**\n\n一阶放射组学特征“能量”定义为 $E = \\sum_{i=1}^{n} x_i^2$。我们为每个中心计算该值。\n\n对于中心A：\n$$E_A = \\sum_{i=1}^{6} x_{A,i}^2 = 70^2 + 74^2 + 76^2 + 72^2 + 68^2 + 80^2$$\n$$E_A = 4900 + 5476 + 5776 + 5184 + 4624 + 6400 = 32360$$\n\n对于中心B：\n$$E_B = \\sum_{i=1}^{6} x_{B,i}^2 = 30^2 + 40^2 + 45^2 + 35^2 + 25^2 + 55^2$$\n$$E_B = 900 + 1600 + 2025 + 1225 + 625 + 3025 = 9400$$\n\n*解释*：\n能量特征反映了体素强度的总体量级，在两个中心之间存在显著差异（$E_A = 32360$ vs. $E_B = 9400$）。\n- 在纯粹的**数据驱动**方法中，机器学习模型很可能会将这个巨大的能量差异识别为一个高判别力的特征。例如，如果任务是预测肿瘤表型，模型可能会错误地学习到将扫描仪特有的强度缩放与生物学结果关联起来。这是一个典型的混杂变量示例，模型学习到的是数据收集过程中的伪影，而不是真实的生物学信号。\n- 在**假设驱动**的框架中，研究人员基于对成像物理和多中心数据收集的先验知识，会预见到这种非生物学差异。明确的假设是，底层组织是相同的，观察到的强度差异是由线性缩放伪影引起的。原始能量特征 $E$ 的巨大差异会促使研究人员执行数据协调，例如下一步要求的标准化，以便在检验任何生物学假设之前移除这个混杂因素。\n\n**2. $z$-score 变换的规定**\n\n$z$-score 变换 $z_i = \\frac{x_i - \\mu}{\\sigma}$ 需要计算每个中心的总体均值（$\\mu$）和总体标准差（$\\sigma$）。\n\n对于中心A：\n均值为：\n$$\\mu_A = \\frac{1}{6}(70 + 74 + 76 + 72 + 68 + 80) = \\frac{440}{6} = \\frac{220}{3}$$\n方差为：\n$$\\sigma_A^2 = \\frac{1}{n}\\sum_{i=1}^{n} (x_{A,i} - \\mu_A)^2 = \\frac{1}{6}\\left[\\left(70-\\frac{220}{3}\\right)^2 + \\left(74-\\frac{220}{3}\\right)^2 + \\dots + \\left(80-\\frac{220}{3}\\right)^2\\right]$$\n$$\\sigma_A^2 = \\frac{1}{6}\\left[\\left(\\frac{-10}{3}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 + \\left(\\frac{8}{3}\\right)^2 + \\left(\\frac{-4}{3}\\right)^2 + \\left(\\frac{-16}{3}\\right)^2 + \\left(\\frac{20}{3}\\right)^2\\right]$$\n$$\\sigma_A^2 = \\frac{1}{6} \\cdot \\frac{100+4+64+16+256+400}{9} = \\frac{1}{6} \\cdot \\frac{840}{9} = \\frac{140}{9}$$\n标准差为：\n$$\\sigma_A = \\sqrt{\\frac{140}{9}} = \\frac{\\sqrt{140}}{3} = \\frac{2\\sqrt{35}}{3}$$\n中心A的变换为 $z_{A,i} = \\frac{x_{A,i} - 220/3}{2\\sqrt{35}/3}$。\n\n对于中心B：\n均值为：\n$$\\mu_B = \\frac{1}{6}(30 + 40 + 45 + 35 + 25 + 55) = \\frac{230}{6} = \\frac{115}{3}$$\n方差为：\n$$\\sigma_B^2 = \\frac{1}{n}\\sum_{i=1}^{n} (x_{B,i} - \\mu_B)^2 = \\frac{1}{6}\\left[\\left(30-\\frac{115}{3}\\right)^2 + \\dots + \\left(55-\\frac{115}{3}\\right)^2\\right]$$\n$$\\sigma_B^2 = \\frac{1}{6}\\left[\\left(\\frac{-25}{3}\\right)^2 + \\left(\\frac{5}{3}\\right)^2 + \\left(\\frac{20}{3}\\right)^2 + \\left(\\frac{-10}{3}\\right)^2 + \\left(\\frac{-40}{3}\\right)^2 + \\left(\\frac{50}{3}\\right)^2\\right]$$\n$$\\sigma_B^2 = \\frac{1}{6} \\cdot \\frac{625+25+400+100+1600+2500}{9} = \\frac{1}{6} \\cdot \\frac{5250}{9} = \\frac{875}{9}$$\n标准差为：\n$$\\sigma_B = \\sqrt{\\frac{875}{9}} = \\frac{\\sqrt{25 \\cdot 35}}{3} = \\frac{5\\sqrt{35}}{3}$$\n中心B的变换为 $z_{B,i} = \\frac{x_{B,i} - 115/3}{5\\sqrt{35}/3}$。\n\n**3. 标准化能量及其比率的计算**\n\n标准化强度的能量为 $E^{(z)} = \\sum_{i=1}^{n} z_i^2$。我们可以根据所提供的定义，通过一般性推导来计算这个值。\n$$E^{(z)} = \\sum_{i=1}^{n} z_i^2 = \\sum_{i=1}^{n} \\left(\\frac{x_i - \\mu}{\\sigma}\\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (x_i - \\mu)^2$$\n总体方差的定义是 $\\sigma^2 = \\frac{1}{n}\\sum_{i=1}^{n} (x_i - \\mu)^2$。整理此式可得 $\\sum_{i=1}^{n} (x_i - \\mu)^2 = n\\sigma^2$。\n将此结果代入 $E^{(z)}$ 的表达式中：\n$$E^{(z)} = \\frac{1}{\\sigma^2}(n\\sigma^2) = n$$\n这是一个基本性质：对于任何数据集，其 z-score（使用总体均值和总体标准差计算）的平方和精确等于数据点的数量 $n$。\n\n对于中心A和中心B，样本数量均为 $n=6$。因此，每个中心的标准化能量为：\n$$E^{(z)}_{\\text{A}} = n = 6$$\n$$E^{(z)}_{\\text{B}} = n = 6$$\n\n这一结果表明，$z$-score 变换已成功移除了中心之间的线性缩放差异，从而得到相同的能量值。这个经过协调的特征现在正确地反映了问题的初始条件，即两个中心的ROI之间没有生物学差异。\n\n最后，我们计算比率 $R$：\n$$R = \\frac{E^{(z)}_{\\text{A}}}{E^{(z)}_{\\text{B}}} = \\frac{6}{6} = 1$$\n\n比率恰好为 $1$，证实了 $z$-score 变换已使能量特征在中心之间具有可比性。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "当我们进入数据分析阶段，尤其是在探索性的数据驱动研究中，我们常常会检验成百上千个特征与临床结果之间的关联。这种大规模测试带来了一个严峻的统计挑战：多重比较问题。随着检验次数的增加，仅仅因为偶然性而获得“显著”结果的风险也急剧上升。这项练习将帮助你量化这种风险（即“族群谬误率”，Family-Wise Error Rate），并介绍一种经典的校正方法——Bonferroni校正，以确保我们研究结论的统计严谨性。",
            "id": "4544682",
            "problem": "一项假设驱动的放射组学研究计划测试 $m$ 个从先前医学影像中的机理学原理推导出的预定义特征-结果关联。每次假设检验均在单次检验显著性水平 $\\alpha = 0.05$ 下进行，不进行多重检验校正。假设全局零假设为真（所有 $m$ 个零假设均为真），并且各个检验是独立的。\n\n使用族系误差率 (FWER) 的定义，即 $P(\\text{在 } m \\text{ 次检验中至少有一次错误拒绝})$，推导在这些条件下预期假阳性率作为 $m$ 的函数。然后，确定 Bonferroni 校正所要求的单次检验显著性水平，以确保 FWER 被控制在 $0.05$，无论检验之间是否存在依赖关系。\n\n请以两个关于 $m$ 的解析表达式的形式提供最终答案：首先是未经校正的预期假阳性率；其次是经过 Bonferroni 校正的单次检验显著性水平。无需进行数值计算，也不涉及单位。",
            "solution": "这个问题提法恰当，有科学依据，并包含了求解所需的所有必要信息。族系误差率 (FWER)、多重假设检验和 Bonferroni 校正等概念是统计学及其应用（如放射组学）中的标准概念。问题第一部分关于全局零假设为真和检验独立性的假设是明确的，可以直接进行推导。\n\n问题要求求解两个不同的量：\n1.  在独立性假设且无多重比较校正的条件下，预期假阳性率作为检验次数 $m$ 的函数。\n2.  为将 FWER 控制在 0.05，Bonferroni 校正所需的单次检验显著性水平。\n\n让我们依次解决每个部分。\n\n**第一部分：未经校正的预期假阳性率 (FWER)**\n\n族系误差率 (FWER) 在问题中被定义为在 $m$ 次检验中犯至少一次错误拒绝的概率。这也被称为假设“族”上的 I 类错误。设 $V$ 为代表假阳性（I 类错误）数量的随机变量。那么 FWER 就是 $P(V \\ge 1)$。\n\n问题陈述了全局零假设为真，这意味着所有 $m$ 个独立的零假设 $H_{0,1}, H_{0,2}, \\dots, H_{0,m}$ 均为真。因此，根据定义，任何对零假设的拒绝都是一次错误拒绝（I 类错误）。\n\n单次检验的显著性水平 $\\alpha$ 是在单个零假设为真的情况下拒绝它的概率。我们已知 $\\alpha = 0.05$。\n对于任意单次检验 $i$，犯 I 类错误的概率为：\n$$ P(\\text{reject } H_{0,i}) = \\alpha = 0.05 $$\n因此，对于单次检验，正确地不拒绝一个真零假设的概率为：\n$$ P(\\text{do not reject } H_{0,i}) = 1 - \\alpha = 1 - 0.05 = 0.95 $$\n直接计算 FWER，即 $P(V \\ge 1)$，会涉及一个复杂的概率求和。更直接的方法是计算其互补事件的概率，即零次错误拒绝的概率 $P(V=0)$，然后使用关系式 $P(V \\ge 1) = 1 - P(V=0)$。\n\n事件 $\\{V=0\\}$ 对应于不拒绝任何一个 $m$ 个真零假设。问题陈述了各个检验是独立的。因此，不拒绝任何一个 $m$ 个假设的概率是不拒绝每个假设的各个独立概率的乘积：\n$$ P(V=0) = P(\\text{no rejections in } m \\text{ tests}) = \\prod_{i=1}^{m} P(\\text{do not reject } H_{0,i}) $$\n由于每次检验都在相同的显著性水平 $\\alpha$ 下进行，这可以简化为：\n$$ P(V=0) = (1 - \\alpha)^m $$\n现在，我们可以求出 FWER：\n$$ \\text{FWER} = P(V \\ge 1) = 1 - P(V=0) = 1 - (1 - \\alpha)^m $$\n代入给定的值 $\\alpha = 0.05$，预期假阳性率作为 $m$ 的函数的表达式为：\n$$ \\text{FWER}(m) = 1 - (1 - 0.05)^m = 1 - (0.95)^m $$\n\n**第二部分：经过 Bonferroni 校正的单次检验显著性水平**\n\n问题的第二部分要求的是 Bonferroni 校正所需的单次检验显著性水平（我们称之为 $\\alpha'$），以将 FWER 控制在一个指定水平 $\\alpha_{\\text{FWER}} = 0.05$ 或以下。\n\nBonferroni 校正是一种控制 FWER 的方法，它不要求检验之间相互独立。它基于 Boole 不等式，也称为并集界。设 $E_i$ 为第 $i$ 次检验中发生 I 类错误的事件。FWER 是这些事件并集的概率：\n$$ \\text{FWER} = P\\left(\\bigcup_{i=1}^{m} E_i\\right) $$\nBoole 不等式表明，对于任意一组事件 $E_1, \\dots, E_m$：\n$$ P\\left(\\bigcup_{i=1}^{m} E_i\\right) \\le \\sum_{i=1}^{m} P(E_i) $$\n将此应用于我们的情境，FWER 的上界是各个单次检验错误概率的总和。如果我们对每次检验使用一个新的、调整后的显著性水平 $\\alpha'$，那么 $P(E_i) = \\alpha'$。该不等式变为：\n$$ \\text{FWER} \\le \\sum_{i=1}^{m} \\alpha' = m \\alpha' $$\n为保证 FWER 被控制在 0.05 的水平，我们必须确保其上界不超过这个值。也就是说，我们需要 $m \\alpha' \\le 0.05$。Bonferroni 校正通过求解等式来设定调整后的单次检验显著性水平 $\\alpha'$：\n$$ m \\alpha' = 0.05 $$\n求解 $\\alpha'$ 得到所需的单次检验显著性水平：\n$$ \\alpha' = \\frac{0.05}{m} $$\n这个校正后的显著性水平 $\\alpha'$ 保证了 $\\text{FWER} \\le 0.05$，无论检验之间的依赖结构如何，正如问题所规定的。\n\n所要求的两个最终解析表达式是 $1 - (0.95)^m$ 和 $\\frac{0.05}{m}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 - (0.95)^m \\\\ \\frac{0.05}{m} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在构建了预测模型之后，最后一步是评估其性能和临床实用性。然而，选择哪一个性能指标并非无关紧要，一个不恰当的指标可能会描绘出过于乐观的画面，尤其是在预测罕见事件时。这项练习将揭示为何在类别极不平衡的情况下，常用的ROC曲线下面积（AUC）可能会产生误导，并阐明了为什么精确率-召回率（Precision-Recall）曲线及其AUC在评估这类问题时通常是更诚实、更具临床相关性的选择。",
            "id": "4544659",
            "problem": "训练一个放射组学分类器，以从高维图像衍生特征中预测罕见的二元临床终点（事件发生与否）。在假设驱动的研究中，性能指标的选择应遵循关于决策权衡和事件普遍性的先验临床假设，而在数据驱动的研究中，如果事后优化的单一指标不能反映临床基础率，则可能会产生误导。\n\n仅使用混淆矩阵条目和派生率的核心定义，解释为什么在放射组学中典型的严重类别不平衡情况下，受试者工作特征曲线下面积（ROC AUC）可能会产生误导，并论证在该情况下优先选择精确率-召回率曲线（PR 曲线）及其面积（PR AUC）的合理性。\n\n然后，对于以下由预测分数和二元真实标签组成的假设数据集，计算 PR AUC。数据集包含 $N=20$ 名患者，其中有 $P=2$ 个事件阳性病例（$1$ 表示事件发生，$0$ 表示事件未发生）。每对数据以 $(\\text{分数}, \\text{标签})$ 的形式给出，分数越高表示事件发生的可信度越高。列表已按分数从高到低预先排序：\n$\\{(0.97,1),(0.89,0),(0.83,0),(0.78,0),(0.71,0),(0.68,0),(0.62,0),(0.55,0),(0.49,0),(0.44,0),(0.40,1),(0.38,0),(0.33,0),(0.29,0),(0.27,0),(0.22,0),(0.18,0),(0.14,0),(0.09,0),(0.03,0)\\}$.\n\nPR AUC 计算说明：\n- 使用标准定义 $ \\text{precision} = \\frac{TP}{TP+FP} $（精确率）和 $ \\text{recall} = \\frac{TP}{P} $（召回率），其中 $TP$ 和 $FP$ 分别是在给定阈值下的真阳性（true positives）和假阳性（false positives），该阈值将所有分数大于或等于它的项目分类为阳性。\n- 按分数降序扫描阈值，并累积更新 $(TP,FP)$。\n- 以此阈值顺序构建精确率对召回率的 PR 曲线，包括召回率为 $0$、精确率为 $1$ 的常规锚点，以及所有 $N$ 个实例都被预测为阳性的最终状态。\n- 使用梯形法则，在召回率发生变化的连续点上，通过精确率对召回率进行积分，来计算此 PR 曲线下的面积。召回率不变的垂直线段贡献的面积为零。\n\n将最终的 PR AUC 表示为小数，并四舍五入到四位有效数字。无需单位。",
            "solution": "该问题要求分两部分作答：首先，从理论上解释为什么在存在严重类别不平衡的情况下，受试者工作特征曲线下面积（ROC AUC）可能会产生误导，以及为什么精确率-召回率（PR）曲线及其面积（PR AUC）在这种情况下通常是更优的选择。其次，要求为特定数据集计算 PR AUC。\n\n**第一部分：在不平衡数据集中 PR AUC 优于 ROC AUC 的概念性论证**\n\n为解答此问题，我们必须首先为二元分类问题定义从混淆矩阵中导出的基本量。设 $P$ 为数据集中真阳性实例（事件）的数量，$N_{neg}$ 为真阴性实例（非事件）的数量。在给定的分类阈值下，设 $TP$ 为真阳性（true positives）的数量，$FP$ 为假阳性（false positives）的数量，$TN$ 为真阴性（true negatives）的数量，$FN$ 为假阴性（false negatives）的数量。我们有 $P = TP + FN$ 和 $N_{neg} = FP + TN$。\n\nROC 曲线绘制了在不同阈值设置下，真阳性率（TPR）相对于假阳性率（FPR）的变化。\nTPR，也称为召回率（recall）或灵敏度（sensitivity），定义为：\n$$\n\\text{TPR} = \\text{Recall} = \\frac{TP}{P} = \\frac{TP}{TP+FN}\n$$\nFPR 定义为：\n$$\n\\text{FPR} = \\frac{FP}{N_{neg}} = \\frac{FP}{FP+TN}\n$$\nROC AUC 是该曲线下的面积，表示随机选择的阳性实例的排序高于随机选择的阴性实例的概率。\n\n在类别严重不平衡的情况下（这在放射组学中预测罕见事件时很常见），阴性实例的数量远大于阳性实例的数量（$N_{neg} \\gg P$）。ROC AUC 的问题源于 FPR 的定义。因为 FPR 的分母是阴性实例的总数 $N_{neg}$，所以即使假阳性（$FP$）的绝对数量很大，仍然可能导致一个非常小、看似理想的 FPR 值。例如，如果 $P=10$ 且 $N_{neg}=10000$，一个分类器产生了 $100$ 个假阳性（$FP=100$），同时正确识别了所有阳性实例（$TP=10$, $FN=0$），那么它的 TPR 将是完美的 $1.0$，但其 FPR 仅为 $\\frac{100}{10000} = 0.01$。这个点 $(0.01, 1.0)$ 非常接近 ROC 空间的理想左上角，表明性能优异。然而，在预测为阳性的 $110$ 个病例中（$TP+FP = 10+100$），只有 $10$ 个是正确的。这种分类器的临床效用很差，因为它的阳性预测并不可靠。ROC 曲线及其 AUC 对这种效应不敏感，因为 FPR 分母中的巨大值 $N_{neg}$ 掩盖了大量假阳性对性能造成的影响。\n\n精确率-召回率（PR）曲线解决了这个缺陷。它绘制了精确率相对于召回率的变化。\n精确率，也称为阳性预测值（PPV），定义为：\n$$\n\\text{Precision} = \\frac{TP}{TP+FP}\n$$\n召回率与 TPR 相同。因此，PR 曲线直观地展示了模型识别所有阳性实例的能力（召回率）与其阳性预测的准确性（精确率）之间的权衡。\n\n精确率的分母是所有被分类为阳性的实例总数（$TP+FP$）。与 FPR 不同，精确率不涉及 $TN$。在不平衡的情况下（$N_{neg} \\gg P$），$FP$ 的任何增加都会对精确率产生重大的负面影响，因为 $TP$ 的数量本身就很小。使用前面的例子，精确率将是 $\\frac{10}{10+100} = \\frac{10}{110} \\approx 0.09$。在 PR 曲线上，一个召回率为 $1.0$、精确率为 $0.09$ 的点清楚地表明了性能不佳，而这一点在 ROC 曲线上被掩盖了。因此，PR 曲线能够更翔实地反映分类器在少数阳性类别上的性能，而这在罕见事件预测中通常是感兴趣的类别。因此，对于阳性发现的临床效用至关重要的假设驱动研究，或在不平衡领域进行数据驱动的发现，PR 曲线及其面积（PR AUC）是比 ROC AUC 更合适且不易产生误导的度量标准。\n\n**第二部分：PR AUC 的计算**\n\n给定一个数据集，包含 $N=20$ 名患者，其中有 $P=2$ 个阳性病例和 $N_{neg}=18$ 个阴性病例。数据已按分数预排序，为 $\\{(0.97,1),(0.89,0), \\ldots, (0.03,0)\\}$。我们将按照指定，使用梯形法则计算 PR AUC。通过从 $i=1$ 到 $i=20$ 逐个纳入患者来降低分类阈值，生成点 $(\\text{Recall}_i, \\text{Precision}_i)$，从而构建 PR 曲线。\n\n设 $TP_i$ 和 $FP_i$ 为考虑前 $i$ 个实例后的累积真阳性和假阳性计数。\n$\\text{Recall}_i = \\frac{TP_i}{P} = \\frac{TP_i}{2}$。\n$\\text{Precision}_i = \\frac{TP_i}{TP_i+FP_i} = \\frac{TP_i}{i}$。\n\nPR AUC 是通过精确率对召回率进行积分来计算的。使用梯形法则，面积由连续点之间的小梯形面积之和给出：\n$$\n\\text{AUC} = \\sum_{i=1}^{N} \\frac{1}{2} (\\text{Precision}_i + \\text{Precision}_{i-1}) (\\text{Recall}_i - \\text{Recall}_{i-1})\n$$\n常规锚点是 $p_0 = (\\text{Recall}_0, \\text{Precision}_0) = (0, 1)$。仅当遇到阳性实例，即 $\\text{Recall}_i \\neq \\text{Recall}_{i-1}$ 时，求和项中的项才为非零。\n\n1.  **初始状态（锚点）：** $i=0$。$p_0 = (\\text{Recall}_0=0, \\text{Precision}_0=1)$。\n\n2.  **在 $i=1$ 处的第一个阳性实例：** 数据对为 $(0.97, 1)$。\n    $TP_1 = 1$, $FP_1 = 0$。\n    $\\text{Recall}_1 = \\frac{1}{2} = 0.5$。\n    $\\text{Precision}_1 = \\frac{1}{1} = 1$。\n    召回率的变化为 $\\text{Recall}_1 - \\text{Recall}_0 = 0.5 - 0 = 0.5$。\n    第一个梯形的面积为 $A_1 = \\frac{1}{2}(\\text{Precision}_1 + \\text{Precision}_0)(\\text{Recall}_1 - \\text{Recall}_0) = \\frac{1}{2}(1 + 1)(0.5) = 0.5$。\n\n3.  **从 $i=2$到 $i=10$ 的实例均为阴性。**\n    对于此范围内的任何 $i$，$TP_i$ 保持为 $1$。因此，$\\text{Recall}_i = \\frac{1}{2}$，与 $\\text{Recall}_1$ 相同。所以，对于 $i \\in \\{2, 3, \\ldots, 10\\}$，$(\\text{Recall}_i - \\text{Recall}_{i-1}) = 0$。根据“垂直线段”规则，这些步骤贡献的面积为零。该序列的最后一个点在 $i=10$ 处。\n    在 $i=10$ 时，我们处理了 1 个阳性和 9 个阴性。所以 $TP_{10}=1$, $FP_{10}=9$。\n    $\\text{Recall}_{10} = \\frac{1}{2} = 0.5$。\n    $\\text{Precision}_{10} = \\frac{1}{1+9} = \\frac{1}{10} = 0.1$。\n    这个点是 $p_{10} = (0.5, 0.1)$。这是在召回率下一次变化之前的那个点。\n\n4.  **在 $i=11$ 处的第二个阳性实例：** 数据对为 $(0.40, 1)$。\n    在此步骤，我们处理了 11 个实例。$TP_{11} = 2$, $FP_{11} = 9$。\n    $\\text{Recall}_{11} = \\frac{2}{2} = 1.0$。\n    $\\text{Precision}_{11} = \\frac{2}{2+9} = \\frac{2}{11}$。\n    召回率的变化为 $\\text{Recall}_{11} - \\text{Recall}_{10} = 1.0 - 0.5 = 0.5$。\n    第二个梯形的面积是在此次变化前的点（$p_{10}$）和当前点（$p_{11}$）之间计算的。\n    $A_2 = \\frac{1}{2}(\\text{Precision}_{11} + \\text{Precision}_{10})(\\text{Recall}_{11} - \\text{Recall}_{10})$。\n    $A_2 = \\frac{1}{2}\\left(\\frac{2}{11} + \\frac{1}{10}\\right)(0.5) = \\frac{1}{4}\\left(\\frac{2 \\times 10 + 1 \\times 11}{110}\\right) = \\frac{1}{4}\\left(\\frac{20+11}{110}\\right) = \\frac{1}{4}\\left(\\frac{31}{110}\\right) = \\frac{31}{440}$。\n\n5.  **从 $i=12$ 到 $i=20$ 的实例均为阴性。**\n    对于此范围内的任何 $i$，$TP_i$ 保持为 $2$。因此，$\\text{Recall}_i = 1.0$，与 $\\text{Recall}_{11}$ 相同。所有后续项 $(\\text{Recall}_i - \\text{Recall}_{i-1})$ 均为零，不再贡献任何面积。\n\n总 PR AUC 是所有非零线段面积的总和。\n$$\n\\text{PR AUC} = A_1 + A_2 = \\frac{1}{2} + \\frac{31}{440}\n$$\n为了求和，我们找到一个公分母：\n$$\n\\text{PR AUC} = \\frac{220}{440} + \\frac{31}{440} = \\frac{251}{440}\n$$\n现在，我们将此分数转换为小数，并四舍五入到四位有效数字。\n$$\n\\text{PR AUC} = \\frac{251}{440} \\approx 0.5704545...\n$$\n四舍五入到四位有效数字得到 $0.5705$。",
            "answer": "$$\\boxed{0.5705}$$"
        }
    ]
}