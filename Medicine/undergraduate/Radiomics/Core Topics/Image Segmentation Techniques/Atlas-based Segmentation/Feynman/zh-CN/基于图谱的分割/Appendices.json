{
    "hands_on_practices": [
        {
            "introduction": "在评估基于图谱的分割结果时，单一的性能指标往往无法全面反映其准确性。本练习将探讨两种在医学图像分析中至关重要的指标：戴斯相似系数（Dice Similarity Coefficient）和豪斯多夫距离（Hausdorff Distance）。通过计算一个包含孤立伪影的分割案例，你将亲身体会到为何需要结合使用体积重叠指标和边界误差指标来诊断分割错误 。",
            "id": "4529150",
            "problem": "在影像组学的基于图谱分割中，通过配准将一个包含解剖学标签的群体图谱形变到目标对象上，从而生成一个候选分割，该分割可与手动的“金标准”分割进行比较。考虑一个各向同性体素间距为 $1\\,\\mathrm{mm}$ 的二维切片，并设“金标准”掩模由前景体素坐标集合 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$ 表示。获得一个图谱配准后的掩模 $T$，由于轻微的配准错误，它除了包含预期结构外，还在 $(10,10)$ 处包含一个伪影孤立体素标签，因此 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。使用体素坐标上的标准欧几里得度量，并将掩模视作前景体素的集合，计算 $S$ 和 $T$ 之间的 Dice 相似系数以及对称豪斯多夫距离。以毫米为单位表示豪斯多夫距离。根据您在这些度量指标之间发现的任何差异，在您的推理中指出基于图谱的分割相对于“金标准”存在的主要误差模式。无需四舍五入；请提供精确值。您的最终数值答案必须分别包含 Dice 相似系数和豪斯多夫距离的这对值。",
            "solution": "用户提供了一个来自影像组学领域的问题，具体涉及评估基于图谱的分割与“金标准”的对比。我将首先验证问题陈述，如果有效，则继续进行详细解答。\n\n### 步骤 1：提取给定信息\n-   **领域**：影像组学中的基于图谱分割。\n-   **图像空间**：二维切片。\n-   **体素间距**：各向同性，$1\\,\\mathrm{mm}$。\n-   **“金标准”掩模**：前景体素坐标集合为 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$。\n-   **图谱配准后的掩模**：前景体素坐标集合为 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。\n-   **距离度量**：体素坐标上的标准欧几里得度量。\n-   **任务 1**：计算 $S$ 和 $T$ 之间的 Dice 相似系数。\n-   **任务 2**：计算 $S$ 和 $T$ 之间的对称豪斯多夫距离。\n-   **任务 3**：以毫米为单位表示豪斯多夫距离。\n-   **任务 4**：根据度量指标识别主要误差模式。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，使用了医学图像分析中的基本分割评估度量标准（Dice 相似系数和豪斯多夫距离）的标准定义。配准错误产生伪影孤立体素的场景是分割伪影的一个实际且现实的例子。该问题是适定的；集合 $S$ 和 $T$ 被明确定义，且度量标准具有明确的数学定义，确保了唯一解的存在。语言客观、精确。所有必要信息，包括用于单位转换的体素间距，均已提供。该问题并非无足轻重，因为它要求正确应用两种不同的度量标准并解读其结果。\n\n### 步骤 3：结论与行动\n问题有效。我现在开始解决它。\n\n### 解题过程\n该问题要求为给定的“金标准”集合 $S$ 和图谱配准后的集合 $T$ 计算两个用于比较分割掩模的标准度量指标：Dice 相似系数 (DSC) 和对称豪斯多夫距离。\n\n设“金标准”集合为 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$，图谱配准后的集合为 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。\n\n**1. Dice 相似系数 (DSC)**\n\nDice 相似系数衡量两个集合之间的重叠程度。其定义为：\n$$\n\\text{DSC}(S, T) = \\frac{2 |S \\cap T|}{|S| + |T|}\n$$\n其中 $|A|$ 表示集合 $A$ 的基数（元素数量）。\n\n首先，我们确定集合 $S$ 和 $T$ 的基数：\n$$\n|S| = 4\n$$\n$$\n|T| = 5\n$$\n\n接下来，我们求两个集合的交集 $S \\cap T$：\n$$\nS \\cap T = \\{(0,0),(0,1),(1,0),(1,1)\\}\n$$\n交集的基数为：\n$$\n|S \\cap T| = 4\n$$\n\n现在，我们可以计算 DSC：\n$$\n\\text{DSC}(S, T) = \\frac{2 \\times 4}{4 + 5} = \\frac{8}{9}\n$$\nDice 系数是一个介于 $0$ 和 $1$ 之间的值，其中 $1$ 表示完全一致。值为 $\\frac{8}{9}$ 表明重叠度很高。\n\n**2. 对称豪斯多夫距离**\n\n对称豪斯多夫距离 $H(S,T)$ 量化了一个集合中的点到另一个集合中最近点的最大距离。其定义为：\n$$\nH(S, T) = \\max \\left( h(S, T), h(T, S) \\right)\n$$\n其中 $h(S, T)$ 是从 $S$ 到 $T$ 的有向豪斯多夫距离：\n$$\nh(S, T) = \\max_{s \\in S} \\left( \\min_{t \\in T} d(s, t) \\right)\n$$\n且 $d(s, t)$ 是点（体素）$s$ 和 $t$ 之间的标准欧几里得距离。\n\n首先，我们计算有向豪斯多夫距离 $h(S, T)$。它衡量的是从 $S$ 中任意一点到 $T$ 中最近点的最大距离。\n由于集合 $S$ 是 $T$ 的一个真子集（即 $S \\subset T$），对于每个点 $s \\in S$，该点 $s$ 也在 $T$ 中。因此，从任何 $s \\in S$ 到集合 $T$ 的最小距离为 $0$，因为 $d(s, s) = 0$。\n$$\n\\min_{t \\in T} d(s, t) = 0 \\quad \\forall s \\in S\n$$\n对所有 $s \\in S$ 取最大值：\n$$\nh(S, T) = \\max_{s \\in S} (0) = 0\n$$\n\n接下来，我们计算有向豪斯多夫距离 $h(T, S)$，它衡量的是从 $T$ 中任意一点到 $S$ 中最近点的最大距离。\n$$\nh(T, S) = \\max_{t \\in T} \\left( \\min_{s \\in S} d(t, s) \\right)\n$$\n我们需要为 $T$ 中的每个点 $t$ 计算 $\\min_{s \\in S} d(t, s)$。\n集合 $T$ 由 $S$ 中的点加上离群点 $(10,10)$ 组成。\n对于任何同时在 $S$ 和 $T$ 中的点 $t$，到 $S$ 的最小距离为 $0$。这适用于点 $(0,0)$、$(0,1)$、$(1,0)$ 和 $(1,1)$。\n我们唯一需要考虑的点是 $t^* = (10,10)$，它在 $T$ 中但不在 $S$ 中。我们必须找到它到集合 $S$ 的最小距离。\n$$\n\\min_{s \\in S} d((10,10), s) = \\min \\left\\{ d((10,10),(0,0)), d((10,10),(0,1)), d((10,10),(1,0)), d((10,10),(1,1)) \\right\\}\n$$\n让我们计算各个欧几里得距离，$d((x_1,y_1),(x_2,y_2)) = \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$：\n-   $d((10,10),(0,0)) = \\sqrt{(10-0)^2 + (10-0)^2} = \\sqrt{100+100} = \\sqrt{200} = 10\\sqrt{2}$\n-   $d((10,10),(0,1)) = \\sqrt{(10-0)^2 + (10-1)^2} = \\sqrt{100+81} = \\sqrt{181}$\n-   $d((10,10),(1,0)) = \\sqrt{(10-1)^2 + (10-0)^2} = \\sqrt{81+100} = \\sqrt{181}$\n-   $d((10,10),(1,1)) = \\sqrt{(10-1)^2 + (10-1)^2} = \\sqrt{81+81} = \\sqrt{162} = 9\\sqrt{2}$\n\n这些距离中的最小值为 $\\sqrt{162} = 9\\sqrt{2}$。\n因此，$h(T, S) = \\max(0, 0, 0, 0, 9\\sqrt{2}) = 9\\sqrt{2}$。\n\n对称豪斯多夫距离是两个有向距离中的最大值：\n$$\nH(S, T) = \\max(h(S, T), h(T, S)) = \\max(0, 9\\sqrt{2}) = 9\\sqrt{2}\n$$\n这个距离是以体素为单位的。问题指定了各向同性体素间距为 $1\\,\\mathrm{mm}$。因此，以毫米为单位的豪斯多夫距离是：\n$$\nH(S, T) = 9\\sqrt{2}\\,\\mathrm{mm}\n$$\n\n**3. 误差模式解读**\n\n我们计算出 Dice 系数为 $\\text{DSC} = \\frac{8}{9} \\approx 0.889$，豪斯多夫距离为 $H = 9\\sqrt{2} \\approx 12.7\\,\\mathrm{mm}$。\n-   **Dice 系数**是一种体积重叠度量。它的值很高，因为分割不匹配的部分仅构成一个体素（$T$ 有 $5$ 个体素，$S$ 有 $4$ 个体素，其中 $4$ 个重叠）。该度量对不匹配区域的空间位置相对不敏感。\n-   **豪斯多夫距离**是一种基于边界的度量，是衡量最坏情况误差的指标。它对离群点极为敏感。$9\\sqrt{2}\\,\\mathrm{mm}$ 的较大值完全是由位于 $(10,10)$ 的单个伪影体素造成的，该体素远离“金标准”集合 $S$。\n\n高 Dice 系数值（表明整体分割效果好）与大豪斯多夫距离值（表明分割边界差）之间的差异指向了一种特定类型的误差。主要的误差模式是存在一个远离实际对象边界的**伪影孤立体素簇**（离群点）。分割的主体部分基本正确，但配准错误在一个相当远的距离处引入了一个假阳性元素。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{8}{9} & 9\\sqrt{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "多图谱分割的核心在于如何智能地融合来自不同图谱的标签信息，而非简单地“投票”。本练习将引导你进入基于概率的融合世界，将真实的组织标签视为一个未知的“潜变量”，而每个图谱的分割结果则是带有噪声的观测。你将应用贝叶斯定理，在一个期望最大化（EM）算法的框架内，计算给定所有图谱观测值后，某个体素真实标签的后验概率 。",
            "id": "4529145",
            "problem": "在用于放射组学的基于图谱的分割中，考虑一个二元组织分类问题，其中体素 $v$ 处的潜在真实组织标签为 $T_v \\in \\{0,1\\}$，并且三个图谱为 $i \\in \\{1,2,3\\}$ 提供了观测标签 $\\ell_{iv} \\in \\{0,1\\}$。假设给定 $T_v$ 时，图谱的观测结果是条件独立的，并且每个图谱遵循一个伯努利模型，其敏感性为 $s_i = \\mathbb{P}(\\ell_{iv} = 1 \\mid T_v = 1)$，特异性为 $c_i = \\mathbb{P}(\\ell_{iv} = 0 \\mid T_v = 0)$。设先验概率为 $\\pi = \\mathbb{P}(T_v = 1)$，在所有体素中均相同。\n\n您已获得以下初始参数：$s_1 = 0.90$，$c_1 = 0.95$，$s_2 = 0.85$，$c_2 = 0.90$，$s_3 = 0.80$，$c_3 = 0.92$，以及 $\\pi = 0.30$。对于四个体素 $v = 1,2,3,4$，观测到的图谱标签为：\n- 体素 $1$：$\\ell_{1,1} = 1$, $\\ell_{2,1} = 1$, $\\ell_{3,1} = 1$。\n- 体素 $2$：$\\ell_{1,2} = 1$, $\\ell_{2,2} = 0$, $\\ell_{3,2} = 1$。\n- 体素 $3$：$\\ell_{1,3} = 0$, $\\ell_{2,3} = 0$, $\\ell_{3,3} = 1$。\n- 体素 $4$：$\\ell_{1,4} = 0$, $\\ell_{2,4} = 0$, $\\ell_{3,4} = 0$。\n\n执行一次期望最大化（EM）迭代，其中期望最大化（EM）指的是在期望步骤（E-步）中计算后验概率，并在最大化步骤（M-步）中根据期望充分统计量更新敏感性和特异性参数。具体来说：\n1. 在 E-步中，使用贝叶斯定理和条件独立性假设，为每个体素 $v$ 计算后验概率 $p_v = \\mathbb{P}(T_v = 1 \\mid \\ell_{1v}, \\ell_{2v}, \\ell_{3v})$。\n2. 在 M-步中，使用期望计数更新每个图谱的敏感性和特异性：\n   - $s_i^{(1)} = \\dfrac{\\sum_{v} p_v \\, \\ell_{iv}}{\\sum_{v} p_v}$，\n   - $c_i^{(1)} = \\dfrac{\\sum_{v} (1 - p_v) \\, (1 - \\ell_{iv})}{\\sum_{v} (1 - p_v)}$。\n\n提供在 E-步中根据给定的初始参数获得的后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$ 的数值。请将您的答案表示为四舍五入到四位有效数字的小数。无需单位。",
            "solution": "首先根据既定标准对问题进行验证。\n\n### 问题验证\n\n#### 第 1 步：提取已知条件\n- **模型**：一个二元组织分类问题，其中体素 $v$ 处的潜在真实组织标签为 $T_v \\in \\{0,1\\}$。\n- **观测值**：三个图谱为 $i \\in \\{1,2,3\\}$ 提供了观测标签 $\\ell_{iv} \\in \\{0,1\\}$。\n- **假设**：给定真实标签 $T_v$ 时，图谱观测结果是条件独立的。每个图谱遵循一个伯努利模型。\n- **定义**：\n    - 敏感性：$s_i = \\mathbb{P}(\\ell_{iv} = 1 \\mid T_v = 1)$\n    - 特异性：$c_i = \\mathbb{P}(\\ell_{iv} = 0 \\mid T_v = 0)$\n    - 先验概率：$\\pi = \\mathbb{P}(T_v = 1)$\n- **初始参数**：\n    - $s_1 = 0.90$, $c_1 = 0.95$\n    - $s_2 = 0.85$, $c_2 = 0.90$\n    - $s_3 = 0.80$, $c_3 = 0.92$\n    - $\\pi = 0.30$\n- **观测数据**：\n    - 体素 $1$：$(\\ell_{1,1}, \\ell_{2,1}, \\ell_{3,1}) = (1, 1, 1)$\n    - 体素 $2$：$(\\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2}) = (1, 0, 1)$\n    - 体素 $3$：$(\\ell_{1,3}, \\ell_{2,3}, \\ell_{3,3}) = (0, 0, 1)$\n    - 体素 $4$：$(\\ell_{1,4}, \\ell_{2,4}, \\ell_{3,4}) = (0, 0, 0)$\n- **任务**：在 EM 算法第一次迭代的 E-步中，计算后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$。\n\n#### 第 2 步：使用提取的已知条件进行验证\n1.  **科学性**：该问题描述了一个用于医学图像分割的潜变量模型，这是期望最大化（EM）算法的一个标准应用。敏感性、特异性和贝叶斯推断的使用是统计建模和机器学习的基础。该设置在科学上是合理的。\n2.  **良态性**：该问题是良态的。它要求计算一个特定的后验概率 $p_2$，并提供了所有必要的数据、初始参数和一个明确定义的概率模型。可以确定一个唯一的、稳定的解。\n3.  **客观性**：所有术语都有数学定义，数据以数值形式提供。该问题不含主观性语言。\n4.  **完整性与一致性**：该问题是自洽的。它提供了计算所需的所有模型假设、参数和数据。没有矛盾之处；所有概率都在 $[0, 1]$ 的有效范围内。\n5.  **现实性**：在医学成像和基于图谱的分割背景下，敏感性、特异性和先验概率的数值是合理的。\n\n#### 第 3 步：结论与行动\n此问题有效。将推导解答。\n\n### 解答\n\n目标是为体素 $v=2$ 计算后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$。设体素 $v$ 的观测标签向量表示为 $\\boldsymbol{\\ell}_v = (\\ell_{1v}, \\ell_{2v}, \\ell_{3v})$。对于体素 2，观测标签为 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$。\n\n我们应用贝叶斯定理来计算后验概率：\n$$ p_v = \\mathbb{P}(T_v=1 \\mid \\boldsymbol{\\ell}_v) = \\frac{\\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1)}{\\mathbb{P}(\\boldsymbol{\\ell}_v)} $$\n分母 $\\mathbb{P}(\\boldsymbol{\\ell}_v)$ 是边际似然或证据，可以使用全概率定律展开：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v) = \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1) + \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=0)\\mathbb{P}(T_v=0) $$\n先验概率给定为 $\\mathbb{P}(T_v=1) = \\pi = 0.30$，因此 $\\mathbb{P}(T_v=0) = 1 - \\pi = 1 - 0.30 = 0.70$。\n\n问题陈述，给定真实标签 $T_v$ 时，图谱的观测结果是条件独立的。这使我们能够将标签向量 $\\boldsymbol{\\ell}_v$ 的条件概率表示为单个概率的乘积：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v) = \\prod_{i=1}^{3} \\mathbb{P}(\\ell_{iv} \\mid T_v) $$\n现在我们可以使用给定的敏感性（$s_i$）和特异性（$c_i$）来计算体素 $v=2$ 的两个条件似然项。\n\n1.  **给定真实标签为 $1$ ($T_2 = 1$) 时的似然**：\n    我们使用敏感性 $s_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=1)$ 及其补集 $1-s_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=1)$。\n    对于 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=1) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = s_1 \\cdot (1-s_2) \\cdot s_3 $$\n    代入给定值 $s_1 = 0.90$，$s_2 = 0.85$ 和 $s_3 = 0.80$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = (0.90) \\cdot (1 - 0.85) \\cdot (0.80) = 0.90 \\cdot 0.15 \\cdot 0.80 = 0.108 $$\n\n2.  **给定真实标签为 $0$ ($T_2 = 0$) 时的似然**：\n    我们使用特异性 $c_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=0)$ 及其补集 $1-c_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=0)$。\n    对于 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=0) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1-c_1) \\cdot c_2 \\cdot (1-c_3) $$\n    代入给定值 $c_1 = 0.95$，$c_2 = 0.90$ 和 $c_3 = 0.92$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1 - 0.95) \\cdot (0.90) \\cdot (1 - 0.92) = 0.05 \\cdot 0.90 \\cdot 0.08 = 0.0036 $$\n\n现在我们结合这些结果来计算后验概率 $p_2$。\n贝叶斯定理的分子是：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) = (0.108) \\cdot (0.30) = 0.0324 $$\n分母（证据）是：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) + \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0)\\mathbb{P}(T_2=0) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = (0.108 \\cdot 0.30) + (0.0036 \\cdot 0.70) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = 0.0324 + 0.00252 = 0.03492 $$\n最后，后验概率 $p_2$ 是分子与分母的比值：\n$$ p_2 = \\frac{0.0324}{0.03492} \\approx 0.92783505... $$\n根据要求，将结果四舍五入到四位有效数字，得到 $0.9278$。",
            "answer": "$$\\boxed{0.9278}$$"
        },
        {
            "introduction": "本练习将图谱先验信息与另一类强大的分割工具——马尔可夫随机场（MRF）和图割（Graph Cut）算法相结合。你将探索一个能量函数，它同时考虑了来自图像本身的数据、图谱提供的先验知识以及空间平滑性约束。通过分析图谱先验权重如何影响最终的分割边界，你将理解在实践中如何平衡不同信息源，以获得一个既符合数据又空间连续的理想结果 。",
            "id": "4529181",
            "problem": "在放射组学的基于图谱的分割中，一种常见方法是计算一个二元标记，该标记能最小化一个马尔可夫随机场（MRF）能量函数。该能量函数在一个Potts模型下结合了图像衍生数据项、图谱衍生先验项和空间正则化项。考虑一个在大小为 $2 \\times 2$ 的网格上的二元分割问题，其节点为 $\\{p_{1},p_{2},p_{3},p_{4}\\}$，其中 $p_{1},p_{2}$ 在顶行，$p_{3},p_{4}$ 在底行。邻域系统是具有无向边 $\\{(p_{1},p_{2}), (p_{1},p_{3}), (p_{2},p_{4}), (p_{3},p_{4})\\}$ 的$4$-连通网格。设标签为 $\\mathcal{L}=\\{\\text{F},\\text{B}\\}$，分别对应前景和背景。通过最小源汇切割（s-t切割）最小化的能量为\n$$\nE(L;\\lambda) \\;=\\; \\sum_{i \\in \\{1,2,3,4\\}} D_{i}^{\\lambda}(l_{i}) \\;+\\; \\gamma \\sum_{(i,j)} [l_{i} \\neq l_{j}],\n$$\n其中 $[\\,\\cdot\\,]$ 是Iverson括号，$\\gamma>0$ 是Potts正则化权重，图谱调制的单元项为\n$$\nD_{i}^{\\lambda}(\\text{F}) \\;=\\; D_{i}(\\text{F}) \\;-\\; \\lambda \\frac{w_{i}}{2}, \n\\qquad\nD_{i}^{\\lambda}(\\text{B}) \\;=\\; D_{i}(\\text{B}) \\;+\\; \\lambda \\frac{w_{i}}{2}.\n$$\n此处，$\\lambda \\ge 0$ 是一个标量图谱权重，$w_{i} \\in \\mathbb{R}$ 编码了局部图谱对数几率强度，当 $w_{i}>0$ 时偏向于前景，当 $w_{i}<0$ 时偏向于背景。图像衍生的基础单元成本由下式给出\n$$\nD_{1}(\\text{F})=1,\\; D_{1}(\\text{B})=5;\\quad\nD_{2}(\\text{F})=3,\\; D_{2}(\\text{B})=2;\\\\\nD_{3}(\\text{F})=2,\\; D_{3}(\\text{B})=4;\\quad\nD_{4}(\\text{F})=6,\\; D_{4}(\\text{B})=1,\n$$\n且Potts权重为 $\\gamma=2$。图谱先验仅在节点 $p_{2}$ 处非零，为 $w_{2}=3$，而 $w_{1}=w_{3}=w_{4}=0$。假设采用用于子模二元Potts模型的标准s-t切割构造，并且最小s-t切割能得到 $E(L;\\lambda)$ 的全局最小值。\n\n从这些定义和事实出发，根据第一性原理确定图谱先验如何影响最优切割和诱导的分割边界。特别地，计算使得最小s-t切割标记首次将节点 $p_{2}$ 标记为前景（即最优标记发生变化，使得 $l_{2}=\\text{F}$）的最小非负值 $\\lambda^{\\star} \\ge 0$。请以精确数值的形式提供您关于 $\\lambda^{\\star}$ 的最终答案，不带单位。无需四舍五入。",
            "solution": "用户希望找到图谱权重 $\\lambda^{\\star}$ 的最小非负值，在该值下，$2 \\times 2$ 节点网格的最优二元标记将前景标签 $\\text{F}$ 分配给节点 $p_2$。\n\n问题是最小化能量函数：\n$$E(L;\\lambda) = \\sum_{i \\in \\{1,2,3,4\\}} D_{i}^{\\lambda}(l_{i}) + \\gamma \\sum_{(i,j)} [l_{i} \\neq l_{j}]$$\n其中 $L = (l_1, l_2, l_3, l_4)$ 是四个节点的标记，$l_i \\in \\{\\text{F}, \\text{B}\\}$。Potts正则化权重给定为 $\\gamma=2$。邻域系统包含边 $\\{(p_1,p_2), (p_1,p_3), (p_2,p_4), (p_3,p_4)\\}$。\n\n图谱调制的单元（数据）项由下式给出：\n$$D_{i}^{\\lambda}(\\text{F}) = D_{i}(\\text{F}) - \\lambda \\frac{w_{i}}{2}$$\n$$D_{i}^{\\lambda}(\\text{B}) = D_{i}(\\text{B}) + \\lambda \\frac{w_{i}}{2}$$\n\n基础单元成本 $D_i(l)$ 给定如下：\n- $p_1$：$D_1(\\text{F}) = 1$, $D_1(\\text{B}) = 5$\n- $p_2$：$D_2(\\text{F}) = 3$, $D_2(\\text{B}) = 2$\n- $p_3$：$D_3(\\text{F}) = 2$, $D_3(\\text{B}) = 4$\n- $p_4$：$D_4(\\text{F}) = 6$, $D_4(\\text{B}) = 1$\n\n图谱先验强度 $w_i$ 给定为 $w_2=3$ 且 $w_1=w_3=w_4=0$。\n因此，唯一依赖于 $\\lambda$ 的单元项是节点 $p_2$ 的项：\n$$D_{2}^{\\lambda}(\\text{F}) = D_{2}(\\text{F}) - \\lambda \\frac{w_{2}}{2} = 3 - \\frac{3}{2}\\lambda$$\n$$D_{2}^{\\lambda}(\\text{B}) = D_{2}(\\text{B}) + \\lambda \\frac{w_{2}}{2} = 2 + \\frac{3}{2}\\lambda$$\n对于所有其他节点 $i \\in \\{1,3,4\\}$，由于 $w_i=0$，有 $D_{i}^{\\lambda}(l_i) = D_i(l_i)$。\n\n值 $\\lambda^{\\star}$ 是 $p_2$ 的最优标签从背景（$\\text{B}$）切换到前景（$\\text{F}$）的临界点。当使用 $l_2=\\text{B}$ 可实现的最小能量与使用 $l_2=\\text{F}$ 可实现的最小能量相等时，发生此转换。\n\n设 $E(L;\\lambda)$ 是标记 $L$ 的能量。我们可以明确地表达对 $\\lambda$ 的依赖关系。总能量可以写为与 $\\lambda$ 无关的项和与 $\\lambda$ 相关的项之和。\n如果 $l_2=\\text{B}$，能量为 $E(L;\\lambda) = E(L;0) + \\frac{3}{2}\\lambda$。\n如果 $l_2=\\text{F}$，能量为 $E(L;\\lambda) = E(L;0) - \\frac{3}{2}\\lambda$。\n\n设 $L_{opt}^B$ 是在 $l_2=\\text{B}$ 约束下，使 $\\lambda=0$ 时的能量最小化的标记。其能量为 $E_{opt}^B(0) = \\min_{L: l_2=\\text{B}} E(L;0)$。\n设 $L_{opt}^F$ 是在 $l_2=\\text{F}$ 约束下，使 $\\lambda=0$ 时的能量最小化的标记。其能量为 $E_{opt}^F(0) = \\min_{L: l_2=\\text{F}} E(L;0)$。\n\n对于任何 $\\lambda \\ge 0$，具有 $l_2=\\text{B}$ 的最优标记仍然是 $L_{opt}^B$，其能量为 $E(L_{opt}^B; \\lambda) = E_{opt}^B(0) + \\frac{3}{2}\\lambda$。\n类似地，具有 $l_2=\\text{F}$ 的最优标记仍然是 $L_{opt}^F$，其能量为 $E(L_{opt}^F; \\lambda) = E_{opt}^F(0) - \\frac{3}{2}\\lambda$。\n\n从 $l_2=\\text{B}$ 到 $l_2=\\text{F}$ 成为全局最优的转换发生在当这两个最小能量相等时：\n$$E(L_{opt}^B; \\lambda^{\\star}) = E(L_{opt}^F; \\lambda^{\\star})$$\n$$E_{opt}^B(0) + \\frac{3}{2}\\lambda^{\\star} = E_{opt}^F(0) - \\frac{3}{2}\\lambda^{\\star}$$\n$$3\\lambda^{\\star} = E_{opt}^F(0) - E_{opt}^B(0)$$\n$$\\lambda^{\\star} = \\frac{E_{opt}^F(0) - E_{opt}^B(0)}{3}$$\n\n我们的任务简化为，在 $\\lambda=0$ 时，为剩余的节点 $\\{p_1, p_3, p_4\\}$ 求解两个独立的能量最小化问题，一次是将 $p_2$ 固定为 $\\text{B}$，另一次是将 $p_2$ 固定为 $\\text{F}$。\n\n**1. 当 $l_2=\\text{B}$ 时的最小化**\n我们固定 $l_2=\\text{B}$。在 $\\lambda=0$ 时的总能量是 $E(L;0) = D_2(\\text{B}) + \\text{subproblem_energy}$。\n子问题是最小化 $\\{p_1, p_3, p_4\\}$ 标签的能量。与 $p_2$ 固定标签的相互作用可以被吸收到其邻居 $p_1$ 和 $p_4$ 的单元项中。\n子问题的修正单元成本为：\n- 对 $p_1$：\n  $D'_1(\\text{F}) = D_1(\\text{F}) + \\gamma[ \\text{F} \\neq \\text{B} ] = 1+2 = 3$\n  $D'_1(\\text{B}) = D_1(\\text{B}) + \\gamma[ \\text{B} \\neq \\text{B} ] = 5+0 = 5$\n- 对 $p_3$：（不是 $p_2$ 的邻居）\n  $D'_3(\\text{F}) = D_3(\\text{F}) = 2$\n  $D'_3(\\text{B}) = D_3(\\text{B}) = 4$\n- 对 $p_4$：\n  $D'_4(\\text{F}) = D_4(\\text{F}) + \\gamma[ \\text{F} \\neq \\text{B} ] = 6+2 = 8$\n  $D'_4(\\text{B}) = D_4(\\text{B}) + \\gamma[ \\text{B} \\neq \\text{B} ] = 1+0 = 1$\n$(l_1,l_3,l_4)$ 的单元项偏好是 $(\\text{F},\\text{F},\\text{B})$。我们来测试一下这个子问题的标记。\n子问题的邻域是 $\\{(p_1,p_3), (p_3,p_4)\\}$。成对成本为 $\\gamma[l_1\\neq l_3] + \\gamma[l_3\\neq l_4]$。对于 $(l_1,l_3,l_4)=(\\text{F},\\text{F},\\text{B})$，这是 $2[F\\neq F] + 2[F\\neq B] = 0+2=2$。\n子问题的能量为 $(D'_1(\\text{F}) + D'_3(\\text{F}) + D'_4(\\text{B})) + 2 = (3+2+1)+2=8$。\n这个配置 $(\\text{F},\\text{F},\\text{B})$ 确实是子问题的最小值。\n所以，$L_{opt}^B = (\\text{F}, \\text{B}, \\text{F}, \\text{B})$。总最小能量是 $E_{opt}^B(0) = \\text{subproblem_energy} + D_2(\\text{B}) = 8+2=10$。\n\n**2. 当 $l_2=\\text{F}$ 时的最小化**\n我们固定 $l_2=\\text{F}$。在 $\\lambda=0$ 时的总能量是 $E(L;0) = D_2(\\text{F}) + \\text{subproblem_energy}$。\n子问题的修正单元成本变为：\n- 对 $p_1$：\n  $D''_1(\\text{F}) = D_1(\\text{F}) + \\gamma[ \\text{F} \\neq \\text{F} ] = 1+0 = 1$\n  $D''_1(\\text{B}) = D_1(\\text{B}) + \\gamma[ \\text{B} \\neq \\text{F} ] = 5+2 = 7$\n- 对 $p_3$：\n  $D''_3(\\text{F}) = D_3(\\text{F}) = 2$\n  $D''_3(\\text{B}) = D_3(\\text{B}) = 4$\n- 对 $p_4$：\n  $D''_4(\\text{F}) = D_4(\\text{F}) + \\gamma[ \\text{F} \\neq \\text{F} ] = 6+0 = 6$\n  $D''_4(\\text{B}) = D_4(\\text{B}) + \\gamma[ \\text{B} \\neq \\text{F} ] = 1+2 = 3$\n$(l_1,l_3,l_4)$ 的单元项偏好是 $(\\text{F},\\text{F},\\text{B})$。我们来测试一下这个标记。\n子问题的成对成本同样为 $\\gamma[l_1\\neq l_3] + \\gamma[l_3\\neq l_4] = 2[F\\neq F]+2[F\\neq B]=0+2=2$。\n子问题的能量为 $(D''_1(\\text{F}) + D''_3(\\text{F}) + D''_4(\\text{B})) + 2 = (1+2+3)+2=8$。\n这个配置也是这个子问题的最小值。\n所以，$L_{opt}^F = (\\text{F}, \\text{F}, \\text{F}, \\text{B})$。总最小能量是 $E_{opt}^F(0) = \\text{subproblem_energy} + D_2(\\text{F}) = 8+3=11$。\n\n**3. 计算 $\\lambda^{\\star}$**\n现在我们有了必要的值：\n$E_{opt}^B(0) = 10$\n$E_{opt}^F(0) = 11$\n将这些值代入我们的 $\\lambda^{\\star}$ 方程：\n$$\\lambda^{\\star} = \\frac{11 - 10}{3} = \\frac{1}{3}$$\n\n为了验证，我们可以注意到最优标记 $L_{opt}^B = (\\text{F}, \\text{B}, \\text{F}, \\text{B})$ 和 $L_{opt}^F = (\\text{F}, \\text{F}, \\text{F}, \\text{B})$ 仅在 $p_2$ 的标签上有所不同。其他节点的标签是相同的。因此，当将 $p_2$ 从 $\\text{B}$ 翻转到 $\\text{F}$ 时，能量的变化仅取决于涉及 $p_2$ 的项。\n$$E(L_{opt}^F;\\lambda) - E(L_{opt}^B;\\lambda) = (D_2^{\\lambda}(\\text{F}) - D_2^{\\lambda}(\\text{B})) + (E_{pair}(L_{opt}^F) - E_{pair}(L_{opt}^B))$$\n对于 $L_{opt}^B = (\\text{F}, \\text{B}, \\text{F}, \\text{B})$ 的成对能量是 $\\gamma([l_1\\neq l_2]) + \\gamma([l_1\\neq l_3]) + \\gamma([l_2\\neq l_4]) + \\gamma([l_3\\neq l_4]) = 2(1) + 2(0) + 2(0) + 2(1) = 4$。\n对于 $L_{opt}^F = (\\text{F}, \\text{F}, \\text{F}, \\text{B})$ 的成对能量是 $\\gamma([l_1\\neq l_2]) + \\gamma([l_1\\neq l_3]) + \\gamma([l_2\\neq l_4]) + \\gamma([l_3\\neq l_4]) = 2(0) + 2(0) + 2(1) + 2(1) = 4$。\n成对能量相等，因此总能量的变化仅仅是节点 $p_2$ 的单元项的变化：\n$$\\Delta E = D_2^{\\lambda}(\\text{F}) - D_2^{\\lambda}(\\text{B}) = \\left(3 - \\frac{3}{2}\\lambda\\right) - \\left(2 + \\frac{3}{2}\\lambda\\right) = 1 - 3\\lambda$$\n转换发生在 $\\Delta E = 0$ 时，这给出 $1 - 3\\lambda^{\\star} = 0$，所以 $\\lambda^{\\star} = \\frac{1}{3}$。\n对于 $\\lambda  1/3$，$\\Delta E > 0$，所以 $E(L_{opt}^F) > E(L_{opt}^B)$ 且 $l_2=\\text{B}$ 是最优的。对于 $\\lambda > 1/3$，$ \\Delta E  0$，所以 $E(L_{opt}^F)  E(L_{opt}^B)$ 且 $l_2=\\text{F}$ 是最优的。因此，$\\lambda^{\\star}=1/3$ 是发生切换的最小非负值。",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        }
    ]
}