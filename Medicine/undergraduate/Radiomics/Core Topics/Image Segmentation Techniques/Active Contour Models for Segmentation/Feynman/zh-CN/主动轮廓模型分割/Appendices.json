{
    "hands_on_practices": [
        {
            "introduction": "经典的主动轮廓模型（或称“蛇模型”）通过模拟一条向图像边缘移动的弹性曲线来进行分割。其核心驱动力是“外部力”，它将蛇模型拉向高对比度的区域。本练习将引导你完成一个基础但至关重要的计算：如何从一个基于边缘的能量场中推导出这个吸引力。通过这个练习，你会具体地看到“力”是如何作为能量势的负梯度产生的，从而将一个抽象的概念转化为一个可计算的量。",
            "id": "4528455",
            "problem": "一个影像组学流程试图使用主动轮廓模型（蛇模型）来分割磁共振成像（MRI）切片中的肿瘤边界。考虑一个离散的图像块，其像素中心位于一个 $6 \\times 6$ 网格上的整数格点坐标 $(x,y)$，其中 $x \\in \\{0,1,2,3,4,5\\}$ 且 $y \\in \\{0,1,2,3,4,5\\}$。现有边缘图，其中检测到两个边界像素，分别位于 $(x_{e1},y_{e1}) = (1,3)$ 和 $(x_{e2},y_{e2}) = (4,1)$。定义欧几里得距离变换（EDT）$D(x,y)$ 为\n$$\nD(x,y) = \\min\\left\\{\\sqrt{(x-x_{e1})^{2} + (y-y_{e1})^{2}}, \\ \\sqrt{(x-x_{e2})^{2} + (y-y_{e2})^{2}}\\right\\}。\n$$\n为了将蛇模型吸引到边缘，外部能量密度被建模为\n$$\nE_{\\text{ext}}(x,y) = \\frac{1}{2} \\, D(x,y)^{2}，\n$$\n而相应的外部力场由该势能的负梯度定义，\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y)。\n$$\n将像素中心视为连续平面中的点，并假设在最近边缘像素是唯一的情况下，$D(x,y)$ 局部可微。对于位于 $(x,y) = (2,2)$ 的蛇模型控制点，计算外部力向量的模 $|\\mathbf{F}_{\\text{ext}}(2,2)|$。将最终答案表示为无舍入的精确值，以无量纲的像素单位表示。",
            "solution": "用户提供了一个需要解决的问题。根据指示，第一步是严格验证问题陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   问题设定在一个 $6 \\times 6$ 的网格上，像素中心位于整数坐标 $(x,y)$，其中 $x \\in \\{0, 1, 2, 3, 4, 5\\}$ 且 $y \\in \\{0, 1, 2, 3, 4, 5\\}$。\n*   有两个检测到的边界像素：$P_{e1} = (x_{e1}, y_{e1}) = (1, 3)$ 和 $P_{e2} = (x_{e2}, y_{e2}) = (4, 1)$。\n*   欧几里得距离变换 (EDT) 定义为 $D(x,y) = \\min\\left\\{\\sqrt{(x-x_{e1})^{2} + (y-y_{e1})^{2}}, \\ \\sqrt{(x-x_{e2})^{2} + (y-y_{e2})^{2}}\\right\\}$。\n*   外部能量密度为 $E_{\\text{ext}}(x,y) = \\frac{1}{2} \\, D(x,y)^{2}$。\n*   外部力场为 $\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y)$。\n*   坐标空间 $(x,y)$ 在求导时被视为连续平面。\n*   假设在最近边缘像素是唯一的情况下，$D(x,y)$ 局部可微。\n*   任务是计算在点 $(x,y) = (2,2)$ 处的外部力向量的模 $|\\mathbf{F}_{\\text{ext}}(2,2)|$。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **有科学依据：** 该问题牢固地植根于计算机视觉和医学图像分析的原理，特别是主动轮廓模型（蛇模型）的理论。能量泛函、源自图像特征（此处为由距离变换表示的边缘图）的外部能量，以及作为势能负梯度的力等概念，都是该领域的标准和基础。该设置是作用于蛇模型上的外部力的一个简化但正确的表示。\n*   **适定性：** 该问题提供了所有必要的定义和数据。函数 $D(x,y)$ 包含一个 $\\min$ 算子，这使其在与 $P_{e1}$ 和 $P_{e2}$ 等距的点的轨迹上不可微。问题陈述明确地承认了这一点，通过假设“在最近边缘像素是唯一的情况下”可微，这是一个正确的条件。任务是计算一个特定点上的一个特定值，这是一个定义明确的数学问题。解的存在性和唯一性取决于点 $(2,2)$ 是否有唯一的最近边缘点，这是一个可以验证的条件。\n*   **客观性：** 问题以精确的数学语言陈述，没有任何主观性或歧义。\n*   **其他缺陷：** 问题没有违反任何其他验证标准。它是完整的、一致的、现实的（在建模问题的背景下），并且需要实质性的计算。\n\n**第3步：结论与行动**\n问题是有效的。这是一个基于既定科学原理、表述清晰的问题。我现在将着手解决。\n\n### 解题过程\n\n目标是计算在特定点 $(x,y)=(2,2)$ 处的外部力向量 $\\mathbf{F}_{\\text{ext}}(x,y)$ 的模。力被定义为外部能量势的负梯度，即 $\\mathbf{F}_{\\text{ext}} = - \\nabla E_{\\text{ext}}$。\n\n首先，我们必须确定在目标点 $P = (2,2)$ 的邻域内外部能量 $E_{\\text{ext}}(x,y) = \\frac{1}{2} D(x,y)^2$ 的表达式。欧几里得距离变换 $D(x,y)$ 的定义涉及一个最小化算子，因此我们必须确定两个边缘点 $P_{e1}=(1,3)$ 和 $P_{e2}=(4,1)$ 中哪一个离点 $P=(2,2)$ 更近。\n\n我们来计算从点 $P$到 $P_{e1}$ 和 $P_{e2}$ 的欧几里得距离的平方。\n到 $P_{e1}=(1,3)$ 的距离平方为：\n$$\nd_{1}^{2} = (x - x_{e1})^{2} + (y - y_{e1})^{2} = (2-1)^{2} + (2-3)^{2} = 1^{2} + (-1)^{2} = 1 + 1 = 2\n$$\n到 $P_{e2}=(4,1)$ 的距离平方为：\n$$\nd_{2}^{2} = (x - x_{e2})^{2} + (y - y_{e2})^{2} = (2-4)^{2} + (2-1)^{2} = (-2)^{2} + 1^{2} = 4 + 1 = 5\n$$\n比较距离的平方，我们发现 $d_{1}^{2}  d_{2}^{2}$（因为 $2  5$）。这证实了 $P_{e1}=(1,3)$ 是距离点 $P=(2,2)$ 唯一的最近边缘像素。\n\n根据问题陈述，由于在点 $P=(2,2)$ 处最近的边缘像素是唯一的，我们可以将函数 $D(x,y)$ 在该点的一个局部邻域内视为可微的。在这个邻域内，$D(x,y)$ 定义中的 $\\min$ 算子可简化为到 $P_{e1}$ 的距离：\n$$\nD(x,y) = \\sqrt{(x - x_{e1})^{2} + (y - y_{e1})^{2}} = \\sqrt{(x - 1)^{2} + (y - 3)^{2}}\n$$\n因此，外部能量密度由下式给出：\n$$\nE_{\\text{ext}}(x,y) = \\frac{1}{2} D(x,y)^{2} = \\frac{1}{2} \\left[ (\\sqrt{(x - 1)^{2} + (y - 3)^{2}})^{2} \\right] = \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right)\n$$\n接下来，我们通过计算 $E_{\\text{ext}}(x,y)$ 的负梯度来求外部力场 $\\mathbf{F}_{\\text{ext}}(x,y)$：\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\nabla E_{\\text{ext}}(x,y) = - \\left( \\frac{\\partial E_{\\text{ext}}}{\\partial x} \\mathbf{i} + \\frac{\\partial E_{\\text{ext}}}{\\partial y} \\mathbf{j} \\right)\n$$\n我们计算 $E_{\\text{ext}}(x,y)$ 的偏导数：\n$$\n\\frac{\\partial E_{\\text{ext}}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right) \\right] = \\frac{1}{2} \\cdot 2(x - 1) = x - 1\n$$\n$$\n\\frac{\\partial E_{\\text{ext}}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\frac{1}{2} \\left( (x - 1)^{2} + (y - 3)^{2} \\right) \\right] = \\frac{1}{2} \\cdot 2(y - 3) = y - 3\n$$\n将这些偏导数代入力场的表达式中，得到：\n$$\n\\mathbf{F}_{\\text{ext}}(x,y) = - \\left( (x-1)\\mathbf{i} + (y-3)\\mathbf{j} \\right) = (1-x)\\mathbf{i} + (3-y)\\mathbf{j}\n$$\n这个结果在直观上是正确的：在任何点 $(x,y)$ 的力向量都直接指向最近的边缘点，在这个区域是 $(1,3)$。\n\n现在，我们计算在特定点 $(x,y) = (2,2)$ 的力向量：\n$$\n\\mathbf{F}_{\\text{ext}}(2,2) = (1-2)\\mathbf{i} + (3-2)\\mathbf{j} = -1\\mathbf{i} + 1\\mathbf{j}\n$$\n向量的分量是 $(-1, 1)$。\n\n最后，我们计算这个力向量的模：\n$$\n|\\mathbf{F}_{\\text{ext}}(2,2)| = \\sqrt{(-1)^{2} + 1^{2}} = \\sqrt{1 + 1} = \\sqrt{2}\n$$\n在点 $(2,2)$ 处的外部力向量的模是 $\\sqrt{2}$，单位为无量纲像素单位。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "除了依赖边缘信息，另一类强大的主动轮廓模型是基于区域的。这类模型，如著名的Chan-Vese模型，不寻找梯度最大的地方，而是试图找到一个轮廓，将图像最优地分割成几个内部同质的区域。这个练习将向你展示这类模型的核心机制：如何根据当前的轮廓位置，计算出“内部”和“外部”区域的最佳平均强度$c_1$和$c_2$，这是模型迭代演化的关键一步。",
            "id": "4528376",
            "problem": "一项小型计算机断层扫描（CT）图像切片的放射组学分割任务，使用主动轮廓模型（ACM，也称为蛇模型）以及一种 Chan-Vese 类型的区域能量进行建模。考虑一个由 $3 \\times 3$ 像素组成的离散图像域 $\\Omega$，像素由 $(i,j)$ 索引，其中 $i \\in \\{1,2,3\\}$ 且 $j \\in \\{1,2,3\\}$。设测量到的强度由函数 $I : \\Omega \\to \\mathbb{R}$ 给出：\n- $I(1,1)=12$, $I(1,2)=10$, $I(1,3)=14$,\n- $I(2,1)=13$, $I(2,2)=11$, $I(2,3)=12$,\n- $I(3,1)=5$, $I(3,2)=4$, $I(3,3)=6$.\n\n设 $\\phi : \\Omega \\to \\mathbb{R}$ 为一个水平集函数，其符号表示当前分割：$\\phi(i,j) > 0$ 的像素被认为在演化轮廓内部，而 $\\phi(i,j) \\le 0$ 的像素则在外部。水平集函数的值为：\n- $\\phi(1,1)=0.8$, $\\phi(1,2)=0.3$, $\\phi(1,3)=1.2$,\n- $\\phi(2,1)=0.5$, $\\phi(2,2)=0.4$, $\\phi(2,3)=-0.2$,\n- $\\phi(3,1)=-0.6$, $\\phi(3,2)=-0.7$, $\\phi(3,3)=-0.4$.\n\n定义 Heaviside 函数 $H(\\cdot)$ 为：如果 $\\phi(i,j)>0$，则 $H(\\phi(i,j))=1$；如果 $\\phi(i,j)\\le0$，则 $H(\\phi(i,j))=0$。考虑对于固定的 $\\phi$，Chan-Vese 区域数据保真能量为：\n$$\nE(c_{1},c_{2}\\,|\\,\\phi) \\;=\\; \\lambda_{1} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\lambda_{2} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big),\n$$\n其中 $\\lambda_{1}=\\lambda_{2}=1$。依赖于 $\\phi$ 的几何正则化项（如轮廓长度和面积惩罚）存在于完整模型中，但它们独立于 $c_{1}$ 和 $c_{2}$，因此为了最小化关于 $c_{1}$ 和 $c_{2}$ 的 $E$ 可以忽略这些项。\n\n任务：\n- 从上述能量定义和最小二乘法最小化的基本原理出发，推导在给定 $\\phi$ 的情况下，最小化 $E(c_{1},c_{2}\\,|\\,\\phi)$ 的 $c_{1}$ 和 $c_{2}$ 的更新规则。\n- 使用所提供的 $I$ 和 $\\phi$，计算 $c_{1}$ 和 $c_{2}$ 的数值。\n- 从第一性原理出发，证明对于固定的 $\\phi$ 下，对 $c_{1}$ 和 $c_{2}$ 进行交替最小化的收敛特性（即，固定 $c_{2}$ 更新 $c_{1}$，然后固定 $c_{1}$ 更新 $c_{2}$，并重复此过程），重点关注存在性、唯一性和能量单调性。\n\n将最终数值答案表示为有序对 $\\big(c_{1},\\,c_{2}\\big)$，使用精确算术。不要四舍五入。最终答案必须是使用 LaTeX $\\texttt{pmatrix}$ 环境编写的单行矩阵，不带单位。",
            "solution": "该问题是有效的，因为它科学地基于成熟的用于图像分割的 Chan-Vese 模型，在数学上是适定的、自洽的且客观的。我们将提供一个完整的解答。\n\n该问题要求三件事：推导常数 $c_{1}$ 和 $c_{2}$ 的更新规则，根据给定的图像数据和水平集函数计算它们的数值，以及证明针对这些常数的交替最小化方案的收敛特性。\n\n设图像域为 $\\Omega = \\{ (i,j) \\mid i,j \\in \\{1,2,3\\} \\}$。对于一个固定的水平集函数 $\\phi$，常数 $c_{1}$ 和 $c_{2}$ 的 Chan-Vese 能量泛函为：\n$$\nE(c_{1},c_{2}\\,|\\,\\phi) \\;=\\; \\lambda_{1} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\lambda_{2} \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big)\n$$\n使用给定参数 $\\lambda_{1}=1$ 和 $\\lambda_{2}=1$，上式简化为：\n$$\nE(c_{1},c_{2}) \\;=\\; \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{1}\\big)^{2}\\, H\\!\\big(\\phi(i,j)\\big) \\;+\\; \\sum_{(i,j)\\in\\Omega} \\big(I(i,j)-c_{2}\\big)^{2}\\, \\big(1 - H\\!\\big(\\phi(i,j)\\big)\\big)\n$$\n为使符号清晰，令 $\\Omega_{1} = \\{ (i,j) \\in \\Omega \\mid \\phi(i,j) > 0 \\}$ 为轮廓内部的像素集合，$\\Omega_{2} = \\{ (i,j) \\in \\Omega \\mid \\phi(i,j) \\le 0 \\}$ 为外部的像素集合。对于 $(i,j) \\in \\Omega_{1}$，Heaviside 函数 $H(\\phi(i,j))$ 为 $1$，对于 $(i,j) \\in \\Omega_{2}$ 则为 $0$。于是能量可以写成：\n$$\nE(c_{1},c_{2}) \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2} \\;+\\; \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2}\n$$\n\n**1. 推导 $c_1$ 和 $c_2$ 的更新规则**\n\n为了找到最小化能量 $E(c_{1},c_{2})$ 的 $c_{1}$ 和 $c_{2}$ 的值，我们必须通过对 $c_{1}$ 和 $c_{2}$ 求偏导数并将其设为零来找到临界点。这是最小值的必要条件。\n\n对于 $c_{1}$，我们计算其偏导数：\n$$\n\\frac{\\partial E}{\\partial c_{1}} \\;=\\; \\frac{\\partial}{\\partial c_{1}} \\left( \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2} \\right) \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} 2(I(i,j)-c_{1})(-1) \\;=\\; -2 \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})\n$$\n将此导数设为零以求最小值：\n$$\n-2 \\left( \\sum_{(i,j)\\in\\Omega_{1}} I(i,j) - \\sum_{(i,j)\\in\\Omega_{1}} c_{1} \\right) \\;=\\; 0\n$$\n由于 $c_{1}$ 在求和中是常数，并令 $|\\Omega_{1}|$ 为 $\\Omega_1$ 中的像素数：\n$$\n\\sum_{(i,j)\\in\\Omega_{1}} I(i,j) - |\\Omega_{1}| c_{1} \\;=\\; 0\n$$\n求解 $c_{1}$ 可得更新规则：\n$$\nc_{1} \\;=\\; \\frac{\\sum_{(i,j)\\in\\Omega_{1}} I(i,j)}{|\\Omega_{1}|}\n$$\n这是当前轮廓内部所有像素的平均强度。\n\n同理，对于 $c_{2}$：\n$$\n\\frac{\\partial E}{\\partial c_{2}} \\;=\\; \\frac{\\partial}{\\partial c_{2}} \\left( \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2} \\right) \\;=\\; \\sum_{(i,j)\\in\\Omega_{2}} 2(I(i,j)-c_{2})(-1) \\;=\\; -2 \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})\n$$\n将此导数设为零：\n$$\n\\sum_{(i,j)\\in\\Omega_{2}} I(i,j) - |\\Omega_{2}| c_{2} \\;=\\; 0\n$$\n求解 $c_{2}$ 可得更新规则：\n$$\nc_{2} \\;=\\; \\frac{\\sum_{(i,j)\\in\\Omega_{2}} I(i,j)}{|\\Omega_{2}|}\n$$\n这是当前轮廓外部所有像素的平均强度。\n\n为确认这些是最小值点，我们检查二阶偏导数：\n$$\n\\frac{\\partial^{2}E}{\\partial c_{1}^{2}} \\;=\\; \\sum_{(i,j)\\in\\Omega_{1}} 2 \\;=\\; 2 |\\Omega_{1}| \\qquad \\qquad \\frac{\\partial^{2}E}{\\partial c_{2}^{2}} \\;=\\; \\sum_{(i,j)\\in\\Omega_{2}} 2 \\;=\\; 2 |\\Omega_{2}| \\qquad \\qquad \\frac{\\partial^{2}E}{\\partial c_{1} \\partial c_{2}} \\;=\\; 0\n$$\n由于 $|\\Omega_{1}| > 0$ 且 $|\\Omega_{2}| > 0$（假设分割不是平凡的），关于 $c_1$ 和 $c_2$ 的二阶偏导数是正的。Hessian 矩阵是对角矩阵且对角线元素为正，表明它是正定的。因此，临界点 $(c_1, c_2)$ 是一个唯一的全局最小值点。\n\n**2. 数值计算**\n\n首先，我们必须使用给定的水平集函数 $\\phi(i,j)$ 来确定集合 $\\Omega_{1}$ 和 $\\Omega_{2}$。\n$\\Omega_{1} = \\{ (i,j) \\mid \\phi(i,j) > 0 \\}$：\n$\\phi(1,1)=0.8>0$, $\\phi(1,2)=0.3>0$, $\\phi(1,3)=1.2>0$, $\\phi(2,1)=0.5>0$, $\\phi(2,2)=0.4>0$。\n所以，$\\Omega_{1} = \\{(1,1), (1,2), (1,3), (2,1), (2,2)\\}$。其大小为 $|\\Omega_{1}|=5$。\n\n$\\Omega_{2} = \\{ (i,j) \\mid \\phi(i,j) \\le 0 \\}$：\n$\\phi(2,3)=-0.2\\le0$, $\\phi(3,1)=-0.6\\le0$, $\\phi(3,2)=-0.7\\le0$, $\\phi(3,3)=-0.4\\le0$。\n所以，$\\Omega_{2} = \\{(2,3), (3,1), (3,2), (3,3)\\}$。其大小为 $|\\Omega_{2}|=4$。\n\n现在我们使用推导出的公式和给定的强度 $I(i,j)$ 来计算 $c_{1}$ 和 $c_{2}$：\n对于 $c_{1}$：\n$$\nc_{1} = \\frac{I(1,1)+I(1,2)+I(1,3)+I(2,1)+I(2,2)}{5} = \\frac{12+10+14+13+11}{5} = \\frac{60}{5} = 12\n$$\n对于 $c_{2}$：\n$$\nc_{2} = \\frac{I(2,3)+I(3,1)+I(3,2)+I(3,3)}{4} = \\frac{12+5+4+6}{4} = \\frac{27}{4}\n$$\n\n**3. 收敛特性的证明**\n\n问题要求证明交替最小化方案的特性，即首先固定 $c_{2}$ 更新 $c_{1}$，然后固定新的 $c_{1}$ 更新 $c_{2}$。设迭代次数由 $k$ 索引。\n更新步骤如下：\n步骤 1：$c_{1}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c, c_{2}^{(k)})$\n步骤 2：$c_{2}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c_{1}^{(k+1)}, c)$\n\n从能量函数中可以得到一个关键的观察结果，即它对于 $c_{1}$ 和 $c_{2}$ 是可分离的：\n$$\nE(c_{1},c_{2}) = E_{1}(c_{1}) + E_{2}(c_{2})\n$$\n其中 $E_{1}(c_{1}) = \\sum_{(i,j)\\in\\Omega_{1}} (I(i,j)-c_{1})^{2}$ 且 $E_{2}(c_{2}) = \\sum_{(i,j)\\in\\Omega_{2}} (I(i,j)-c_{2})^{2}$。\n\n**存在性与唯一性**：函数 $E_{1}(c_{1})$ 是关于 $c_{1}$ 的二次函数，其首项系数为正（$|\\Omega_1|$），因此它是一个严格凸的抛物线。一个严格凸函数至多有一个最小值。由于它也是连续的和强制的（即，当 $|c_1| \\to \\infty$ 时，$E_{1}(c_1) \\to \\infty$），因此保证存在唯一的全局最小值。同样的论证也适用于 $E_{2}(c_{2})$。唯一的最小化子正是我们在第一部分中推导出的值。\n\n**能量单调性**：对于凸函数上的任何交替最小化（或坐标下降）方案，能量在每一步都保证是非递增的。设 $(c_{1}^{(k)}, c_{2}^{(k)})$ 是第 $k$ 次迭代时的值。\n第一次更新得到 $c_{1}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c, c_{2}^{(k)})$。根据最小值的定义，我们必然有 $E(c_{1}^{(k+1)}, c_{2}^{(k)}) \\leq E(c_{1}^{(k)}, c_{2}^{(k)})$。\n第二次更新得到 $c_{2}^{(k+1)} = \\underset{c}{\\operatorname{argmin}} E(c_{1}^{(k+1)}, c)$。同样，根据定义，有 $E(c_{1}^{(k+1)}, c_{2}^{(k+1)}) \\leq E(c_{1}^{(k+1)}, c_{2}^{(k)})$。\n将两者结合可得 $E(c_{1}^{(k+1)}, c_{2}^{(k+1)}) \\leq E(c_{1}^{(k)}, c_{2}^{(k)})$，这证明了能量是单调非递增的。\n\n**收敛性**：$E(c_1, c_2)$ 的可分离性带来了一个重要的推论。$E$ 关于 $c_1$ 的最小化完全独立于 $c_2$ 的值，反之亦然。\n$$\n\\underset{c_{1}}{\\operatorname{argmin}} E(c_1, c_2) = \\underset{c_{1}}{\\operatorname{argmin}} (E_1(c_1) + E_2(c_2)) = \\underset{c_{1}}{\\operatorname{argmin}} E_1(c_1)\n$$\n这个最小化问题的解是最优的 $c_1^*$，即 $12$。这个结果与 $c_2$ 的初始值或当前值无关。\n同理，关于 $c_2$ 进行最小化可得到最优的 $c_2^* = 27/4$，而这与 $c_1$ 的值无关。\n因此，交替最小化方案的第一步，即更新 $c_1$，就会将 $c_1$ 设置为其全局最优值 $c_1^* = 12$。第二步会将 $c_2$ 设置为其全局最优值 $c_2^* = 27/4$。因此，无论起点如何，该算法在一次迭代中就达到了唯一的全局最小值 $(c_1^*, c_2^*)$。所有后续迭代都将产生相同的值，从而证实了收敛性。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 12  \\frac{27}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个成功的分割不仅需要精确地被图像特征所吸引，还需要轮廓自身的平滑和规整。蛇模型的“内部能量”负责维持这种规整性，但有时它会与“外部能量”产生冲突，尤其是在处理凹形结构时。本练习设置了一个经典场景，让你量化分析蛇模型是会“抄近道”穿过凹陷，还是会忠实地跟随边界。通过对比不同能量项的贡献，你将学会如何调整模型以解决这个挑战，并理解一些高级技术（如梯度矢量流）的原理。",
            "id": "4528186",
            "problem": "一项在二维计算机断层扫描图像上的放射组学分割任务，需要描绘一个带有凹陷的病变边界。考虑一个参数化活动轮廓，其能量是内部正则化和图像衍生的外部吸引力之和。从经典活动轮廓内部能量和基于边缘的外部能量的核心定义开始：内部能量通过 $|v'(s)|^2$ 和 $|v''(s)|^2$ 的积分来惩罚弹性和曲率，权重分别为 $ \\alpha $ 和 $ \\beta $，而外部能量是边缘衍生势的线积分，该势在图像梯度附近降低能量。假设曲线近似按弧长参数化，因此弹性项与曲线长度成正比。\n\n该凹陷可以很好地用一个半径为 $ r $、对向圆心角为 $ \\theta $ 的圆弧来近似，因此其曲率为 $ k = 1/r $，弧长为 $ L_{\\text{arc}} = r \\theta $。穿过该凹陷的直线弦长度为 $ L_{\\text{chord}} = 2 r \\sin(\\theta/2) $，且在该跨度上的曲率可忽略不计。真实边界附近的边缘强度沿弧线产生每单位长度 $ \\mu $ 的外部能量减少，而跨越弦的内部区域边缘信号要弱得多，每单位长度产生 $ \\mu_{i} $ 的能量减少。\n\n设基础参数为 $ \\alpha = 0.5 $，$ \\beta = 2 $，$ r = 5 $，$ \\theta = \\pi/2 $，$ \\mu = 0.06 $，以及 $ \\mu_{i} = 0.01 $。利用沿圆弧的曲率贡献为 $ \\int \\beta k^{2} \\, ds = \\beta \\int (1/r^{2}) \\, ds = \\beta L_{\\text{arc}} / r^{2} $ 这一事实。\n\n假设蛇形模型可以选择跟随凹弧或横跨弦走捷径。基于第一性原理，量化曲率正则化如何与凹边界相互作用，并确定哪些调整使弧线在能量上比弦更有利，从而在保留正则化的同时防止走捷径。\n\n考虑以下候选调整方案，每个方案都将根据指定的参数变化进行独立评估：\n\nA. 将曲率权重 $ \\beta $ 从 $ 2 $ 全局增加到 $ 4 $。\n\nB. 将曲率权重乘以一个边缘指示器 $g(|\\nabla I|)$，该指示器在强边缘处值很小，在均匀区域接近 $ 1 $，沿弧线设置 $ g_{\\text{edge}} = 0.01 $，沿弦设置 $ g_{\\text{int}} = 1 $，因此曲率项变为 $\\beta g(|\\nabla I|) \\int k^{2} ds$。\n\nC. 通过设置 $ \\alpha = 0 $ 来移除弹性项。\n\nD. 引入梯度向量流 (GVF) 外力（首次出现时定义 GVF），它将边缘信息传播到均匀区域，并增加凹边缘附近的有效外部能量减少；通过将沿弧线的每单位长度能量减少从 $ \\mu = 0.06 $ 提高到 $ \\mu_{\\text{GVF}} = 0.20 $ 来对此建模，同时保持弦跨度的 $ \\mu_{i} = 0.01 $ 不变。\n\nE. 引入边缘加权长度正则化，方法是将弹性系数与相同的边缘指示器 $g(|\\nabla I|)$ 相乘，即通过 $\\alpha g(|\\nabla I|)$ 惩罚长度，沿弧线设置 $ g_{\\text{edge}} = 0.01 $，沿弦设置 $ g_{\\text{int}} = 1 $。\n\n在给定数值下，哪些选项能防止蛇形模型横跨凹陷走捷徑？为什么？\n\n选择所有适用项。\n\nA. 将 $ \\beta $ 从 $ 2 $ 全局增加到 $ 4 $。\n\nB. 边缘加权曲率正则化 $\\beta g(|\\nabla I|)$，其中 $g_{\\text{edge}} = 0.01$，$g_{\\text{int}} = 1$。\n\nC. 通过设置 $ \\alpha = 0 $ 来移除弹性。\n\nD. 使用梯度向量流 (GVF) 将沿凹弧的外部吸引力增加到 $ \\mu_{\\text{GVF}} = 0.20 $。\n\nE. 边缘加权长度正则化 $\\alpha g(|\\nabla I|)$，其中 $g_{\\text{edge}} = 0.01$，$g_{\\text{int}} = 1$。",
            "solution": "用户要求对问题陈述进行严格验证，然后提供一个从第一性原理推导出答案并评估每个选项的完整解决方案。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n\n- **模型**：用于二维图像分割的参数化活动轮廓（蛇形模型）。\n- **能量函数**：$E = E_{\\text{internal}} + E_{\\text{external}}$。\n- **内部能量**：$E_{\\text{internal}} = \\int (\\alpha |v'(s)|^{2} + \\beta |v''(s)|^{2}) \\, ds$。$\\alpha |v'(s)|^2$ 项惩罚弹性，$\\beta |v''(s)|^2$ 项惩罚曲率。\n- **近似**：曲线近似按弧长参数化，因此弹性项与曲线长度成正比，我们可以将其写为 $\\alpha L$。\n- **外部能量**：一个边缘衍生的势，提供每单位长度 $\\mu$ 的能量减少。这可以建模为 $E_{\\text{external}} = -\\int \\mu \\, ds = -\\mu L$。\n- **几何设置**：一个由圆弧近似的凹陷，对比一条直线弦捷径。\n    - **弧线路径**：半径 $r$，圆心角 $\\theta$，曲率 $k = 1/r$，长度 $L_{\\text{arc}} = r \\theta$。每单位长度的外部能量减少为 $\\mu$。\n    - **弦路径**：长度 $L_{\\text{chord}} = 2 r \\sin(\\theta/2)$，曲率可忽略 ($k \\approx 0$)。每单位长度的外部能量减少为 $\\mu_{i}$。\n- **曲率能量公式**：沿弧线的曲率能量由 $\\int \\beta k^{2} \\, ds = \\beta L_{\\text{arc}} / r^{2}$ 给出。\n- **基础参数**：\n    - $\\alpha = 0.5$\n    - $\\beta = 2$\n    - $r = 5$ 单位\n    - $\\theta = \\pi/2$ 弧度\n    - $\\mu = 0.06$ (弧线上每单位长度的能量减少)\n    - $\\mu_{i} = 0.01$ (弦上每单位长度的能量减少)\n- **任务**：为使蛇形模型跟随凹陷边界，弧线路径的总能量 ($E_{\\text{arc}}$) 必须小于弦路径的总能量 ($E_{\\text{chord}}$)。问题是确定对模型参数的哪些建议调整可以实现这一条件 ($E_{\\text{arc}}  E_{\\text{chord}}$)。\n\n**步骤2：使用提取的给定条件进行验证**\n\n- **科学基础**：该问题基于 Kass、Witkin 和 Terzopoulos 的经典活动轮廓模型（蛇形模型）理论。能量泛函、其组成部分（弹性、曲率）以及图像衍生的外部能量概念都是标准内容。提出的修改，如梯度向量流 (GVF) 和空间变化系数 ($g(|\\nabla I|)$)，是原始模型有据可查且已确立的扩展。使用简化的几何案例（弧线 vs. 弦）是一种有效且常见的分析方法。\n- **适定性**：该问题是适定的。它为成功建立了一个清晰、定量的标准 ($E_{\\text{arc}}  E_{\\text{chord}}$)。对于每个选项，都提供了计算两种能量并进行比较所需的所有信息，从而得出一个唯一的、确定性的答案。\n- **客观性**：问题以客观、数学的术语陈述。所有参数都给定了数值，物理模型定义清晰。没有歧义或主观语言。\n\n**步骤3：结论与行动**\n\n问题陈述在科学上是合理的、适定的和客观的。它不包含任何不一致之处或缺失的信息。因此，该问题是 **有效的**。我将继续进行解答。\n\n### 解答推导\n\n给定路径的总能量是其内部（弹性和曲率）和外部能量的总和。\n$E = E_{\\text{elasticity}} + E_{\\text{curvature}} + E_{\\text{external}}$\n\n根据问题陈述的定义：\n- 弹性势能：$E_{\\text{elasticity}} = \\alpha L$\n- 曲率能量：$E_{\\text{curvature}} = \\int \\beta k^2 \\, ds$\n- 外部能量：$E_{\\text{external}} = -\\mu L$\n\n总能量为 $E = (\\alpha - \\mu)L + \\int \\beta k^2 \\, ds$。\n\n**弧线路径的能量 ($E_{\\text{arc}}$)**\n- 长度：$L_{\\text{arc}} = r \\theta$\n- 曲率：$k = 1/r$ 是常数。\n- 曲率能量：$\\int \\beta k^2 \\, ds = \\beta (1/r)^2 \\int_0^{L_{\\text{arc}}} ds = \\frac{\\beta L_{\\text{arc}}}{r^2} = \\frac{\\beta (r \\theta)}{r^2} = \\frac{\\beta \\theta}{r}$。\n- 总弧线能量：$E_{\\text{arc}} = (\\alpha - \\mu)L_{\\text{arc}} + \\frac{\\beta L_{\\text{arc}}}{r^2} = (\\alpha - \\mu)r\\theta + \\frac{\\beta \\theta}{r}$。\n\n**弦路径的能量 ($E_{\\text{chord}}$)**\n- 长度：$L_{\\text{chord}} = 2r \\sin(\\theta/2)$\n- 曲率：$k \\approx 0$，因此曲率能量为 $0$。\n- 注意：沿弦的外部能量减少为 $\\mu_i$。\n- 总弦能量：$E_{\\text{chord}} = (\\alpha - \\mu_i)L_{\\text{chord}} = (\\alpha - \\mu_i)2r \\sin(\\theta/2)$。\n\n防止走捷径的条件是 $E_{\\text{arc}}  E_{\\text{chord}}$。\n\n**基础情况计算**\n首先，我们评估基础参数下的能量：$\\alpha = 0.5$，$\\beta = 2$，$r = 5$，$\\theta = \\pi/2$，$\\mu = 0.06$，$\\mu_i = 0.01$。\n\n- $L_{\\text{arc}} = 5(\\pi/2) = 2.5\\pi \\approx 7.854$\n- $L_{\\text{chord}} = 2(5)\\sin(\\pi/4) = 10(\\frac{\\sqrt{2}}{2}) = 5\\sqrt{2} \\approx 7.071$\n\n现在，我们计算能量：\n$E_{\\text{arc}} = (0.5 - 0.06) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = 0.44(2.5\\pi) + \\frac{5\\pi}{25} = 1.1\\pi + 0.2\\pi = 1.3\\pi \\approx 4.084$\n$E_{\\text{chord}} = (0.5 - 0.01) (5\\sqrt{2}) = 0.49 (5\\sqrt{2}) = 2.45\\sqrt{2} \\approx 3.465$\n\n由于 $E_{\\text{arc}} \\approx 4.084 > E_{\\text{chord}} \\approx 3.465$，在基础情况下，蛇形模型会横跨弦走捷径。我们现在评估每个选项，看它是否能逆转这个不等式。\n\n### 逐项分析\n\n**A. 将 $ \\beta $ 从 $ 2 $ 全局增加到 $ 4 $。**\n此修改将 $\\beta$ 更改为 $4$。所有其他参数保持其基础值。这只影响 $E_{\\text{arc}}$。\n$E_{\\text{arc, new}} = (0.5 - 0.06) (2.5\\pi) + \\frac{4(2.5\\pi)}{5^2} = 1.1\\pi + \\frac{10\\pi}{25} = 1.1\\pi + 0.4\\pi = 1.5\\pi \\approx 4.712$\n$E_{\\text{chord}}$ 保持为 $\\approx 3.465$。\n我们检查条件 $E_{\\text{arc, new}}  E_{\\text{chord}}$：$4.712  3.465$ 是假的。\n增加曲率权重 $\\beta$ 会更严厉地惩罚弯曲。由于弧线路径有显著曲率而弦路径没有，这一变化增加了弧线的能量，使得捷径更加有利。\n**结论：不正确**\n\n**B. 边缘加权曲率正则化 $\\beta g(|\\nabla I|)$，其中 $g_{\\text{edge}} = 0.01$，$g_{\\text{int}} = 1$。**\n这引入了一个空间变化的曲率权重。沿着弧线（强边缘），有效系数为 $\\beta_{\\text{arc}} = \\beta \\cdot g_{\\text{edge}} = 2 \\cdot 0.01 = 0.02$。沿着弦（均匀区域），系数将是 $\\beta_{\\text{chord}} = \\beta \\cdot g_{\\text{int}} = 2 \\cdot 1 = 2$，但其曲率无论如何都为零。我们用 $\\beta_{\\text{arc}}$ 重新计算 $E_{\\text{arc}}$。\n$E_{\\text{arc, new}} = (0.5 - 0.06) (2.5\\pi) + \\frac{0.02(2.5\\pi)}{5^2} = 1.1\\pi + \\frac{0.05\\pi}{25} = 1.1\\pi + 0.002\\pi = 1.102\\pi \\approx 3.4620$\n$E_{\\text{chord}}$ 保持为 $\\approx 3.465$。\n我们检查条件 $E_{\\text{arc, new}}  E_{\\text{chord}}$：$3.4620  3.465$ 是真的。\n通过在强边缘处大幅降低曲率惩罚，这种方法允许蛇形模型弯曲并跟随真实的凹陷边界，而不会产生巨大的能量成本。弧线路径在能量上变得比弦略微有利。\n**结论：正确**\n\n**C. 通过设置 $ \\alpha = 0 $ 来移除弹性。**\n此修改设置 $\\alpha = 0$。\n$E_{\\text{arc, new}} = (0 - 0.06) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = -0.15\\pi + 0.2\\pi = 0.05\\pi \\approx 0.157$\n$E_{\\text{chord, new}} = (0 - 0.01) (5\\sqrt{2}) = -0.05\\sqrt{2} \\approx -0.071$\n我们检查条件 $E_{\\text{arc, new}}  E_{\\text{chord, new}}$：$0.157  -0.071$ 是假的。\n设置 $\\alpha=0$ 消除了对长度的惩罚。由于 $L_{\\text{arc}} > L_{\\text{chord}}$，这对弧线路径不成比例地有利。然而，在给定参数下，剩余的能量平衡（外部 vs. 曲率）不足以使弧线路径比弦路径更有利。弦的能量变为负数，低于弧的正能量。\n**结论：不正确**\n\n**D. 使用梯度向量流 (GVF) 将沿凹弧的外部吸引力增加到 $ \\mu_{\\text{GVF}} = 0.20 $。**\n梯度向量流 (GVF) 是通过扩散图像边缘图的梯度计算出的外力场。它的主要优点是为蛇形模型创造了更大的捕获范围，并能主动将蛇形模型拉入凹陷边界区域。该问题将此效应建模为沿弧线路径的外部能量减少增加，设置 $\\mu = \\mu_{\\text{GVF}} = 0.20$。\n$E_{\\text{arc, new}} = (0.5 - 0.20) (2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = 0.3(2.5\\pi) + 0.2\\pi = 0.75\\pi + 0.2\\pi = 0.95\\pi \\approx 2.985$\n$E_{\\text{chord}}$ 保持为 $\\approx 3.465$。\n我们检查条件 $E_{\\text{arc, new}}  E_{\\text{chord}}$：$2.985  3.465$ 是真的。\n通过显著增加沿弧线的能量减少（吸引力），GVF 使得跟随真实边界变得更有回报。这种强大的外部吸引力克服了对长度和曲率的内部能量惩罚，使得弧线路径的能量显著低于捷径。\n**结论：正确**\n\n**E. 边缘加权长度正则化 $\\alpha g(|\\nabla I|)$，其中 $g_{\\text{edge}} = 0.01$，$g_{\\text{int}} = 1$。**\n这引入了一个空间变化的弹性权重。沿弧线，有效系数为 $\\alpha_{\\text{arc}} = \\alpha \\cdot g_{\\text{edge}} = 0.5 \\cdot 0.01 = 0.005$。沿弦，系数为 $\\alpha_{\\text{chord}} = \\alpha \\cdot g_{\\text{int}} = 0.5 \\cdot 1 = 0.5$。\n我们必须用各自的 $\\alpha$ 值重新计算两种能量。\n$E_{\\text{arc, new}} = (0.005 - 0.06)(2.5\\pi) + \\frac{2(2.5\\pi)}{5^2} = -0.055(2.5\\pi) + 0.2\\pi = -0.1375\\pi + 0.2\\pi = 0.0625\\pi \\approx 0.196$\n$E_{\\text{chord, new}} = (0.5 - 0.01)(5\\sqrt{2}) = 0.49(5\\sqrt{2}) \\approx 3.465$（弦能量不变）。\n我们检查条件 $E_{\\text{arc, new}}  E_{\\text{chord, new}}$：$0.196  3.465$ 是真的。\n标准的弹性项 $\\alpha L$ 惩罚较长的路径，这不利于弧线。通过在强边缘处使 $\\alpha$ 变小，我们几乎消除了跟随真实边界的长度惩罚。这极大地降低了弧线的能量，使其比弦更有利，因为弦穿过无边缘区域时仍有很高的长度惩罚。\n**结论：正确**",
            "answer": "$$\\boxed{BDE}$$"
        }
    ]
}