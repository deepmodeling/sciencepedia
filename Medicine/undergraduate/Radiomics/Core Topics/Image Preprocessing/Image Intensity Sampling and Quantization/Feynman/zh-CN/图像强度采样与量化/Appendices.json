{
    "hands_on_practices": [
        {
            "introduction": "医学图像以原始像素值的形式存储信息，但为了进行临床和定量分析，这些值必须被转换为具有物理意义的单位。本次练习将演示一种标准方法，用于将CT扫描中的存储值转换为亨氏单位（Hounsfield Units, HU），这是任何放射组学工作流程中的基础步骤。通过这个计算，您将把抽象的数字数据与临床实践中使用的物理测量联系起来。",
            "id": "4546167",
            "problem": "一个影像组学流程处理一幅以医学数字成像与通信 (DICOM) 格式存储的计算机断层扫描 (CT) 轴向切片。在CT中，与患者相关的强度标度是亨斯菲尔德单位 (HU)，它由线性衰减系数通过以下关系定义：$$\\mathrm{HU} = 1000 \\cdot \\frac{\\mu - \\mu_{\\mathrm{water}}}{\\mu_{\\mathrm{water}}},$$ 并且，在临床图像的实际应用中，它是通过对存储的量化像素值进行线性重标度来提供的。DICOM头文件指定了一个从存储值到真实世界值的线性映射，其形式为：$$x_{\\mathrm{real}} = m \\cdot x_{\\mathrm{stored}} + b,$$ 其中 $m$ 是重标度斜率，$b$ 是重标度截距。假设这个真实世界值就是亨斯菲尔德单位 (HU)。一个体素的存储值为 $x_{\\mathrm{stored}} = 1240$，其 $\\mathrm{RescaleSlope} = m = 1.2$ 且 $\\mathrm{RescaleIntercept} = b = -1024$。\n\n仅使用上述给出的定义和线性重标度约定，计算该体素的亨斯菲尔德单位 (HU)。然后，根据典型的CT组织值范围，评估此映射出的HU值在人体解剖学和临床CT实践中是否物理上合理。将计算出的HU值作为您的最终数值答案（不带单位）。如果需要四舍五入，则保留四位有效数字；否则，给出精确值。",
            "solution": "该问题要求使用DICOM标准中定义的线性重标度变换，从存储的像素值计算出亨斯菲尔德单位 (HU) 值，然后评估其物理合理性。\n\n首先，进行问题验证。\n- **已知条件提取**：\n  - 亨斯菲尔德单位定义：$\\mathrm{HU} = 1000 \\cdot \\frac{\\mu - \\mu_{\\mathrm{water}}}{\\mu_{\\mathrm{water}}}$\n  - DICOM线性重标度方程：$x_{\\mathrm{real}} = m \\cdot x_{\\mathrm{stored}} + b$\n  - 假设：$x_{\\mathrm{real}}$ 是亨斯菲尔德单位，因此 $\\mathrm{HU} = x_{\\mathrm{real}}$。\n  - 存储的体素值：$x_{\\mathrm{stored}} = 1240$\n  - 重标度斜率：$m = 1.2$\n  - 重标度截距：$b = -1024$\n- **验证结论**：该问题具有科学依据、良定、客观且自洽。所提供的定义和数值（例如，HU的公式、线性重标度模型以及特定的截距 $b = -1024$）在医学影像领域和计算机断层扫描 (CT) 的DICOM规范中是标准且正确的。因此，该问题被认为是**有效的**。\n\n求解过程如下。\n\n存储值 ($x_{\\mathrm{stored}}$) 与真实世界物理值 ($x_{\\mathrm{real}}$) 之间的关系由以下线性方程给出：\n$$x_{\\mathrm{real}} = m \\cdot x_{\\mathrm{stored}} + b$$\n问题陈述对于此CT图像，真实世界值是亨斯菲尔德单位 (HU)。因此，我们可以写出：\n$$\\mathrm{HU} = m \\cdot x_{\\mathrm{stored}} + b$$\n问题提供了以下数值：\n- 存储值，$x_{\\mathrm{stored}} = 1240$。\n- 重标度斜率，$m = 1.2$。\n- 重标度截距，$b = -1024$。\n\n将这些值代入方程，得出该体素的HU值：\n$$\\mathrm{HU} = (1.2) \\cdot (1240) + (-1024)$$\n首先进行乘法运算：\n$$1.2 \\times 1240 = 1488$$\n现在，将此结果代回方程并进行加法运算：\n$$\\mathrm{HU} = 1488 - 1024$$\n$$\\mathrm{HU} = 464$$\n计算得出一个精确的整数值。问题要求仅在必要时四舍五入到四位有效数字。由于 $464$ 是一个具有三位有效数字的精确结果，因此不进行四舍五入。\n\n任务的第二部分是评估此HU值的物理合理性。亨斯菲尔德单位是一种用于描述射线密度的定量标度。它由蒸馏水和空气的参考值定义：\n- 在标准温度和压力下，蒸馏水的射线密度定义为 $0$ HU。\n- 按照惯例，空气的射线密度为 $-1000$ HU。\n\n在临床CT图像中，各种人体组织和物质的典型HU值已被广泛确立：\n- 脂肪：大约 $-100$ HU 到 $-50$ HU。\n- 软组织（例如，肌肉、肝脏、脾脏、大脑）：大约 $+10$ HU 到 $+100$ HU。\n- 血液（未凝固）：大约 $+30$ HU 到 $+45$ HU。\n- 松质骨（海绵骨）：大约 $+200$ HU 到 $+700$ HU。\n- 皮质骨（密质骨）：大于 $+1000$ HU，通常高达 $+3000$ HU。\n- 病理性钙化：通常在 $+150$ HU 到 $+1000$ HU 或更高的范围内。\n\n计算出的值为 $\\mathrm{HU} = 464$。将此值与典型范围进行比较，我们观察到它正好落在松质骨的范围内。对于致密钙化（例如可能在动脉或肾结石中发现的钙化），它也是一个合理的值。该值显著高于软组织或脂肪的值，但低于密质皮质骨的值。因此，在人体CT扫描中发现一个强度为 $464$ HU 的体素是完全物理上合理的，并且很可能对应于骨性结构。",
            "answer": "$$\\boxed{464}$$"
        },
        {
            "introduction": "数字图像在一个离散的网格上表示场景，但我们常常需要估计那些落在网格点之间的位置的数值。本练习探讨了不同的插值算法——从简单的最近邻法到更复杂的立方插值法——以理解它们的准确性和行为。这项技能对于图像重采样、配准和几何变换等任务至关重要。",
            "id": "4546210",
            "problem": "在一个放射组学流程中，一个一维连续强度剖面由函数 $f(x)=x^{2}$ 建模，其中 $x$ 是沿扫描线测量的空间坐标，单位为像素宽度。一个成像系统在整数坐标 $x \\in \\mathbb{Z}$ 处采集样本，生成离散序列 $f[n]=f(n)$，该过程没有测量噪声和量化误差。为了估计离网格位置 $x=0.25$ 处的强度，考虑了三种常用于图像重采样的插值方案：\n\n- 最近邻插值：选择距离 $x$ 最近的整数坐标处的样本值。\n- 线性（分段线性）插值：在界定 $x$ 的相邻整数样本之间的区间 $[0,1]$ 上进行插值。\n- 三次插值：使用一个穿过坐标为 $x \\in \\{-1,0,1,2\\}$ 的四个最近整数样本的、唯一的最高次数为3的多项式。\n\n使用采样和插值的基本原理，计算每种方法在 $x=0.25$ 处的绝对插值误差，其定义为 $\\varepsilon=\\left|\\hat{f}(0.25)-f(0.25)\\right|$，其中 $\\hat{f}(x)$ 是根据可用整数样本得出的插值估计值。将这三个绝对误差表示为无舍入的精确有理数。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于数字信号处理和数值分析的原理，提法得当，提供了所有必要信息，并且其表述是客观的。我们可以开始求解。\n\n核心任务是计算三种不同插值方案的绝对插值误差 $\\varepsilon = \\left|\\hat{f}(0.25) - f(0.25)\\right|$。连续强度剖面由函数 $f(x)=x^2$ 给出。成像系统在整数坐标处提供样本，$f[n] = f(n) = n^2$。\n\n首先，我们计算在离网格位置 $x=0.25$ 处强度的真实基准值。\n$$f(0.25) = (0.25)^2 = \\left(\\frac{1}{4}\\right)^2 = \\frac{1}{16}$$\n\n接下来，我们针对这三种方法分别计算插值估计值 $\\hat{f}(0.25)$ 和相应的绝对误差 $\\varepsilon$。\n\n1.  **最近邻插值**\n    该方法将最近采样点的值赋给插值点。目标位置是 $x=0.25$。整数坐标为 $\\dots, -1, 0, 1, 2, \\dots$。$x=0.25$ 到坐标 $x=0$ 的距离是 $|0.25-0|=0.25$，到坐标 $x=1$ 的距离是 $|0.25-1|=0.75$。最近的整数坐标是 $x=0$。\n    因此，插值 $\\hat{f}_{NN}(0.25)$ 是在 $x=0$ 处的样本值。\n    $$\\hat{f}_{NN}(0.25) = f[0] = f(0) = 0^2 = 0$$\n    最近邻插值的绝对误差 $\\varepsilon_{NN}$ 是：\n    $$\\varepsilon_{NN} = |\\hat{f}_{NN}(0.25) - f(0.25)| = \\left|0 - \\frac{1}{16}\\right| = \\frac{1}{16}$$\n\n2.  **线性插值**\n    该方法在界定插值点的两个相邻整数样本之间构造一条直线。目标位置 $x=0.25$ 位于区间 $[0, 1]$ 内。相邻样本位于 $x=0$ 和 $x=1$ 处。\n    样本值为 $f[0] = f(0) = 0$ 和 $f[1] = f(1) = 1^2 = 1$。\n    对于位于整数样本位置 $n$ 和 $n+1$ 之间的点 $x$，线性插值的通用公式由下式给出：\n    $$\\hat{f}(x) = (1 - (x-n))f[n] + (x-n)f[n+1]$$\n    在我们的例子中，$n=0$ 且 $x=0.25$。\n    $$\\hat{f}_{L}(0.25) = (1 - (0.25 - 0))f[0] + (0.25 - 0)f[1]$$\n    $$\\hat{f}_{L}(0.25) = (1 - 0.25)(0) + (0.25)(1) = 0.75 \\cdot 0 + 0.25 \\cdot 1 = 0.25 = \\frac{1}{4}$$\n    线性插值的绝对误差 $\\varepsilon_{L}$ 是：\n    $$\\varepsilon_{L} = |\\hat{f}_{L}(0.25) - f(0.25)| = \\left|\\frac{1}{4} - \\frac{1}{16}\\right| = \\left|\\frac{4}{16} - \\frac{1}{16}\\right| = \\frac{3}{16}$$\n\n3.  **三次插值**\n    该方法需要找到一个穿过四个最近整数样本的、次数最多为3的唯一多项式，我们称之为 $P(x)$。对于点 $x=0.25$，四个最近的整数坐标是 $x \\in \\{-1, 0, 1, 2\\}$。\n    四个样本点 $(x, f(x))$ 是：\n    $$(-1, f(-1)) = (-1, (-1)^2) = (-1, 1)$$\n    $$(0, f(0)) = (0, 0^2) = (0, 0)$$\n    $$(1, f(1)) = (1, 1^2) = (1, 1)$$\n    $$(2, f(2)) = (2, 2^2) = (2, 4)$$\n    设插值多项式为 $P(x) = ax^3 + bx^2 + cx + d$。我们必须满足对于 $x_i \\in \\{-1, 0, 1, 2\\}$ 都有 $P(x_i) = f(x_i)$。\n    问题指明样本取自函数 $f(x)=x^2$，它本身就是一个2次多项式。多项式插值的一个基本定理指出，如果我们尝试用一个N次多项式拟合位于一个M次多项式（其中 $M \\le N$）上的N+1个点，那么得到的插值多项式与原始多项式完全相同。\n    在本例中，我们用一个次数最多为3（即 $N \\le 3$）的多项式 $P(x)$ 来拟合位于2次多项式 $f(x)=x^2$（即 $M=2$）上的4个点。由于 $M=2 \\le N=3$，唯一的插值多项式 $P(x)$ 必须与原始函数 $f(x)=x^2$ 完全相同。\n    因此，三次插值函数是 $\\hat{f}_{C}(x) = P(x) = x^2$。\n    在 $x=0.25$ 处的插值是：\n    $$\\hat{f}_{C}(0.25) = (0.25)^2 = \\left(\\frac{1}{4}\\right)^2 = \\frac{1}{16}$$\n    三次插值的绝对误差 $\\varepsilon_{C}$ 是：\n    $$\\varepsilon_{C} = |\\hat{f}_{C}(0.25) - f(0.25)| = \\left|\\frac{1}{16} - \\frac{1}{16}\\right| = 0$$\n\n最近邻插值、线性插值和三次插值的三个绝对误差分别为 $\\frac{1}{16}$、$\\frac{3}{16}$ 和 $0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{16} & \\frac{3}{16} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了确保放射组学特征在不同图像和扫描仪之间具有稳健性和可比性，强度值通常通过一个称为量化的过程被分入固定数量的离散区间中。本练习提供了两种常见量化方案的实践机会：固定区间数量（Fixed Bin Number, FBN）和固定区间宽度（Fixed Bin Width, FBW）。它揭示了连续的强度值是如何被映射为离散等级以用于后续的特征提取。",
            "id": "4546204",
            "problem": "一个放射组学预处理流程在计算纹理特征之前，需要对图像强度进行离散化。在此背景下，离散化通过将连续或高分辨率的强度值替换为灰度级箱索引，以实现跨扫描的稳定性和可重复性。两种广泛使用的方案是固定箱数（FBN）和固定箱宽（FBW），两者都假定使用基于1的箱索引。在FBN方案下，从最小强度 $I_{\\min}$ 到最大强度 $I_{\\max}$ 的范围被线性划分为 $N_{g}$ 个箱，强度值通过其在范围内的位置按比例缩放来映射到这些箱中。在FBW方案下，强度轴被划分为宽度恒为 $w$ 的箱，箱索引由强度值与 $I_{\\min}$ 之间完整宽度的数量决定；按照惯例，对于恰好等于 $I_{\\max}$ 的值，其索引被分配给最高的箱。在本题中，选择 $w$ 使得恰好有 $N_{g}$ 个箱覆盖半开区间 $\\left[I_{\\min}, I_{\\max}\\right)$，即 $w = \\left(I_{\\max} - I_{\\min}\\right)/N_{g}$。\n\n给定体素强度 $I = 75$，最小强度 $I_{\\min} = 0$，最大强度 $I_{\\max} = 255$，以及灰度级箱数 $N_{g} = 32$，请计算在固定箱数（FBN）和固定箱宽（FBW）两种方案下的离散化灰度级。将最终答案表示为一个包含两个条目（按 $\\left(\\text{FBN}, \\text{FBW}\\right)$ 顺序）的行矩阵。无需四舍五入，箱索引不附带物理单位。",
            "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。计算固定箱数（FBN）和固定箱宽（FBW）方案下离散化灰度级所需的所有数据和定义均已提供。\n\n设给定参数为：\n- 体素强度：$I = 75$\n- 最小强度：$I_{\\min} = 0$\n- 最大强度：$I_{\\max} = 255$\n- 灰度级箱数：$N_{g} = 32$\n\n箱索引是基于1的，即范围从 $1$ 到 $N_{g}$。\n\n首先，我们计算固定箱数（FBN）方案的离散化灰度级。\nFBN方案将强度范围 $[I_{\\min}, I_{\\max}]$ 划分为 $N_{g}$ 个箱。“通过其在范围内的位置按比例缩放”的描述意味着一种线性映射。一个强度 $I$ 相对于范围起始点的位置由差值 $I - I_{\\min}$ 给出。范围的总跨度是 $I_{\\max} - I_{\\min}$。$I$ 在范围内的相对位置比例是 $\\frac{I - I_{\\min}}{I_{\\max} - I_{\\min}}$。\n\n为了将这个位于 $[0, 1]$ 区间内的相对位置比例映射到 $N_{g}$ 个箱中的一个，我们将其乘以 $N_{g}$。这会得到一个在 $[0, N_{g}]$ 范围内的值。由于分箱需要将一个强度值分配给单个离散的箱，我们使用向下取整函数来确定该值落入哪个箱区间。具体来说，$I_{\\min}$ 和 $I$ 之间可容纳的完整箱宽数量决定了基于0的索引。加上1后，就转换为所需的基于1的索引。\n因此，FBN箱索引 $k_{\\text{FBN}}$ 的公式为：\n$$k_{\\text{FBN}} = \\left\\lfloor N_{g} \\frac{I - I_{\\min}}{I_{\\max} - I_{\\min}} \\right\\rfloor + 1$$\n该公式能正确地将 $I = I_{\\min}$ 映射到箱1。对于一个趋近于 $I_{\\max}$ 的强度 $I$，向下取整函数的参数趋近于 $N_{g}$，从而得到箱索引 $N_{g}$。当 $I=I_{\\max}$ 时，公式会得出 $N_g+1$，这需要一个特殊处理规则（例如，分配到箱 $N_g$）。然而，对于给定的强度 $I=75$，我们不在端点处，所以通用公式是足够的。\n\n代入给定值：\n$$k_{\\text{FBN}} = \\left\\lfloor 32 \\times \\frac{75 - 0}{255 - 0} \\right\\rfloor + 1$$\n我们简化分数：\n$$\\frac{75}{255} = \\frac{15 \\times 5}{15 \\times 17} = \\frac{5}{17}$$\n表达式变为：\n$$k_{\\text{FBN}} = \\left\\lfloor 32 \\times \\frac{5}{17} \\right\\rfloor + 1 = \\left\\lfloor \\frac{160}{17} \\right\\rfloor + 1$$\n由于 $17 \\times 9 = 153$ 且 $17 \\times 10 = 170$，分数 $\\frac{160}{17}$ 的值介于9和10之间。具体来说，$\\frac{160}{17} \\approx 9.41$。\n$$k_{\\text{FBN}} = \\lfloor 9.41... \\rfloor + 1 = 9 + 1 = 10$$\n因此，FBN的灰度级是 $10$。\n\n接下来，我们计算固定箱宽（FBW）方案的离散化灰度级。\n题目指定箱宽 $w$ 的选择要使 $N_{g}$ 个箱恰好覆盖半开区间 $[I_{\\min}, I_{\\max})$。这导出了以下定义：\n$$w = \\frac{I_{\\max} - I_{\\min}}{N_{g}}$$\n箱索引 $k_{\\text{FBW}}$ 由“强度值与 $I_{\\min}$ 之间完整宽度的数量”决定。这直接转化为对强度位置与箱宽之比使用向下取整函数。对于基于1的索引，公式为：\n$$k_{\\text{FBW}} = \\left\\lfloor \\frac{I - I_{\\min}}{w} \\right\\rfloor + 1$$\n将 $w$ 的表达式代入此公式，得到：\n$$k_{\\text{FBW}} = \\left\\lfloor \\frac{I - I_{\\min}}{(I_{\\max} - I_{\\min}) / N_{g}} \\right\\rfloor + 1 = \\left\\lfloor N_{g} \\frac{I - I_{\\min}}{I_{\\max} - I_{\\min}} \\right\\rfloor + 1$$\n这个解析表达式与为FBN方案推导出的表达式完全相同。这是题目对FBW方法中 $w$ 的特定约束的直接结果，该约束强制两种方法的参数等效。\n\n因此，$k_{\\text{FBW}}$ 的数值计算与 $k_{\\text{FBN}}$ 的完全相同。\n$$k_{\\text{FBW}} = \\left\\lfloor \\frac{160}{17} \\right\\rfloor + 1 = 9 + 1 = 10$$\nFBW的灰度级也是 $10$。\n\n最终答案是包含按（FBN, FBW）顺序排列的计算出的灰度级的行矩阵。两个值都是 $10$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 10 & 10 \\end{pmatrix}}$$"
        }
    ]
}