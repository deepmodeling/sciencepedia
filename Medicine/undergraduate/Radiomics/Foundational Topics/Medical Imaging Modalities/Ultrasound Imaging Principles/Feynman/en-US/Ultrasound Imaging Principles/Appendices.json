{
    "hands_on_practices": [
        {
            "introduction": "An ultrasound wave's ability to form an image or have biological effects is determined by the energy it carries. This exercise connects the measurable acoustic pressure to the physical quantity of acoustic intensity, which describes this energy flow. By deriving the relationship from first principles, you will build a quantitative understanding of how wave amplitude and tissue properties dictate the power delivered by an ultrasound beam .",
            "id": "4568803",
            "problem": "An Ultrasound (US) transducer operating in the continuous-wave regime produces a monochromatic plane longitudinal wave that propagates through homogeneous, lossless soft tissue. At a point in the field where the beam can be approximated as planar, the measured peak (amplitude) acoustic pressure is $1.0 \\times 10^{6}$ Pa. The tissue has mass density $\\rho = 1000$ kg/m$^{3}$ and speed of sound $c = 1540$ m/s. Using only the following base principles:\n- The instantaneous acoustic intensity is the instantaneous power flux density, defined as the product of the instantaneous acoustic pressure $p(t)$ and the instantaneous particle velocity $u(t)$.\n- For a plane, lossless, longitudinal wave in a homogeneous medium, the acoustic pressure and particle velocity are in phase, and the specific acoustic impedance is $Z = \\rho c$.\n\nDerive, from these principles, an expression for the time-averaged intensity in terms of the pressure amplitude, $\\rho$, and $c$, and then evaluate it numerically for the given parameters. Express the final intensity in W/cm$^{2}$ and round your answer to four significant figures.\n\nFinally, briefly interpret the physical meaning of this intensity in the context of energy transport relevant to ultrasound image formation and safety, but note that only the numerical intensity will be graded.",
            "solution": "We begin from the definition of instantaneous acoustic intensity as the power flux density:\n$$\nI(t) = p(t)\\,u(t),\n$$\nwhere $p(t)$ is the instantaneous acoustic pressure and $u(t)$ is the instantaneous particle velocity. The time-averaged (over one period $T$) intensity is\n$$\n\\langle I \\rangle = \\frac{1}{T}\\int_{0}^{T} p(t)\\,u(t)\\,dt.\n$$\nFor a plane, lossless, longitudinal harmonic wave in a homogeneous medium, pressure and particle velocity are in phase, and the specific acoustic impedance is $Z = \\rho c$. Therefore, the linear constitutive relation between pressure and particle velocity holds:\n$$\np(t) = Z\\,u(t).\n$$\nLet the pressure be harmonic with peak (amplitude) value $p_{0}$:\n$$\np(t) = p_{0}\\cos(\\omega t - kx).\n$$\nThen the particle velocity is\n$$\nu(t) = \\frac{p(t)}{Z} = \\frac{p_{0}}{Z}\\cos(\\omega t - kx).\n$$\nThe instantaneous intensity is\n$$\nI(t) = p(t)\\,u(t) = \\frac{p_{0}^{2}}{Z}\\cos^{2}(\\omega t - kx).\n$$\nThe time average over one period uses $\\langle \\cos^{2}(\\cdot)\\rangle = \\frac{1}{2}$:\n$$\n\\langle I \\rangle = \\frac{p_{0}^{2}}{Z}\\,\\frac{1}{2} = \\frac{p_{0}^{2}}{2Z} = \\frac{p_{0}^{2}}{2\\rho c}.\n$$\nThis is the required expression in terms of the pressure amplitude, mass density, and speed of sound.\n\nNow we evaluate numerically using $p_{0} = 1.0 \\times 10^{6}$ Pa, $\\rho = 1000$ kg/m$^{3}$, and $c = 1540$ m/s. First compute the specific acoustic impedance:\n$$\nZ = \\rho c = (1000)\\times(1540) = 1.54\\times 10^{6}\\ \\text{Pa}\\cdot\\text{s}/\\text{m}.\n$$\nThen compute the time-averaged intensity in W/m$^{2}$:\n$$\n\\langle I \\rangle = \\frac{(1.0\\times 10^{6})^{2}}{2\\times 1.54\\times 10^{6}}\n= \\frac{1.0\\times 10^{12}}{3.08\\times 10^{6}}\n= 3.2467532468\\times 10^{5}\\ \\text{W/m}^{2}.\n$$\nConvert to W/cm$^{2}$ using $1\\ \\text{W/cm}^{2} = 10^{4}\\ \\text{W/m}^{2}$:\n$$\n\\langle I \\rangle = \\frac{3.2467532468\\times 10^{5}}{10^{4}} = 32.467532468\\ \\text{W/cm}^{2}.\n$$\nRounding to four significant figures gives\n$$\n\\langle I \\rangle = 32.47\\ \\text{W/cm}^{2}.\n$$\n\nPhysical interpretation: The time-averaged intensity $\\langle I \\rangle$ is the average rate at which acoustic energy is transported across a unit area perpendicular to the propagation direction for the continuous plane wave. In the context of ultrasound image formation, larger local intensity implies greater potential backscattered signal amplitude from tissue microstructure, which can influence radiomics-derived texture features through changes in speckle statistics and signal-to-noise ratio. From a safety perspective, this intensity represents the continuous energy flux that, when integrated over exposure time and spatial distribution, contributes to thermal loading; however, diagnostic systems typically use pulsed emission with low duty cycle, making the temporal-average over longer intervals substantially smaller than the plane-wave continuous value computed here.",
            "answer": "$$\\boxed{32.47}$$"
        },
        {
            "introduction": "As an ultrasound pulse travels through tissue, its intensity diminishes due to absorption and scattering, a process called attenuation. This practice demonstrates how to quantify this signal loss using a standard model where attenuation is proportional to both frequency and distance. You will see how this physical phenomenon directly impacts the Signal-to-Noise Ratio ($SNR$), a critical determinant of image quality and diagnostic confidence .",
            "id": "4568792",
            "problem": "An imaging scientist is analyzing how propagation losses affect echo detectability in ultrasound (US) radiomics. Consider a homogeneous soft tissue in which the frequency-dependent attenuation coefficient is approximately constant and linear with frequency, with value $\\alpha = 0.7$ decibels per centimeter per megahertz (dB/cm/MHz). A pulsed plane wave at center frequency $f = 7$ megahertz (MHz) is transmitted from a flat transducer toward a small isotropic point scatterer at depth $2$ centimeters (cm). The echo returns along the same path, for a total propagation distance of $4$ centimeters (cm). Assume that reflection, beamforming, and impedance mismatch losses are negligible, scattering is weak so that single backscatter dominates, and the receiver noise power spectrum is flat over the relevant bandwidth so that the noise level at the receiver is independent of path length and frequency over this narrowband scenario. Also assume that attenuation acts only on the signal, not on the receiver noise.\n\nStarting from the definition of decibels (dB) for intensity ratios and the empirical linear frequency dependence of soft-tissue attenuation, determine the received signal-to-noise ratio (SNR) in decibels after propagation if, in the hypothetical absence of propagation losses, the received SNR would be $35$ decibels (dB). Express the final SNR in decibels and round your answer to four significant figures.",
            "solution": "The Signal-to-Noise Ratio (SNR) in decibels (dB) is defined in terms of the ratio of signal intensity ($I_S$) to noise intensity ($I_N$):\n$$SNR_{dB} = 10 \\log_{10}\\left(\\frac{I_S}{I_N}\\right)$$\nThe problem states that in the hypothetical absence of propagation losses, the received SNR would be $35$ dB. Let us denote the signal intensity in this hypothetical case as $I_{S,0}$ and the corresponding SNR as $SNR_{0,dB}$. The noise intensity, $I_N$, is assumed to be constant and independent of the signal path.\n$$SNR_{0,dB} = 10 \\log_{10}\\left(\\frac{I_{S,0}}{I_N}\\right) = 35 \\text{ dB}$$\nAttenuation causes a reduction in the signal intensity. The total attenuation loss, expressed in decibels, is dependent on the material's attenuation coefficient, the signal frequency, and the total distance traversed by the signal.\n\nThe problem gives a linear relationship between the attenuation coefficient, $\\alpha_c$, and frequency, $f$. The proportionality constant is given as $\\alpha = 0.7$ dB/cm/MHz. Thus, the attenuation coefficient at a specific frequency $f$ is:\n$$\\alpha_c(f) = \\alpha \\cdot f$$\nFor the given center frequency $f = 7$ MHz, the attenuation coefficient is:\n$$\\alpha_c(7 \\text{ MHz}) = (0.7 \\text{ dB/cm/MHz}) \\times (7 \\text{ MHz}) = 4.9 \\text{ dB/cm}$$\nThe ultrasound pulse travels from the transducer to the scatterer at a depth of $2$ cm and then returns to the transducer. The total propagation distance, $d$, is therefore:\n$$d = 2 \\times 2 \\text{ cm} = 4 \\text{ cm}$$\nThe total attenuation loss, $A_{dB}$, in decibels is the product of the attenuation coefficient at the given frequency and the total propagation distance:\n$$A_{dB} = \\alpha_c(f) \\cdot d$$\nSubstituting the calculated values:\n$$A_{dB} = (4.9 \\text{ dB/cm}) \\times (4 \\text{ cm}) = 19.6 \\text{ dB}$$\nThis loss in decibels directly subtracts from the signal level. Let the actual received signal intensity after attenuation be $I_S$. The relationship between the attenuated signal intensity $I_S$ and the unattenuated signal intensity $I_{S,0}$ is given by:\n$$10 \\log_{10}\\left(\\frac{I_S}{I_{S,0}}\\right) = -A_{dB}$$\nThe final or measured SNR, which we denote as $SNR_{final,dB}$, is:\n$$SNR_{final,dB} = 10 \\log_{10}\\left(\\frac{I_S}{I_N}\\right)$$\nUsing the properties of logarithms, we can rewrite this expression:\n$$SNR_{final,dB} = 10 \\log_{10}\\left(\\frac{I_{S,0}}{I_N} \\cdot \\frac{I_S}{I_{S,0}}\\right)$$\n$$SNR_{final,dB} = 10 \\log_{10}\\left(\\frac{I_{S,0}}{I_N}\\right) + 10 \\log_{10}\\left(\\frac{I_S}{I_{S,0}}\\right)$$\nThe first term is the initial SNR without attenuation, $SNR_{0,dB}$, and the second term is the total attenuation loss, $-A_{dB}$. Therefore, the final SNR is simply the initial SNR minus the total attenuation loss in decibels.\n$$SNR_{final,dB} = SNR_{0,dB} - A_{dB}$$\nSubstituting the numerical values:\n$$SNR_{final,dB} = 35 \\text{ dB} - 19.6 \\text{ dB} = 15.4 \\text{ dB}$$\nThe problem requires the answer to be rounded to four significant figures. To express $15.4$ with four significant figures, we write it as $15.40$.",
            "answer": "$$\\boxed{15.40}$$"
        },
        {
            "introduction": "Ultrasound images of seemingly uniform tissue exhibit a characteristic granular pattern known as speckle. This texture is not noise in the typical sense but is information that arises from the coherent interference of echoes from microscopic scatterers. This exercise explores the fundamental statistical properties of this phenomenon, guiding you to derive the \"speckle contrast,\" a measure of its texture, and revealing a key principle for its interpretation in radiomics .",
            "id": "4568817",
            "problem": "Consider Ultrasound (US) backscatter in a homogeneous tissue where the received radio-frequency signal arises from a large number of sub-resolution scatterers with independent phases. In the regime of many scatterers per resolution cell (fully developed speckle), the in-phase component $I$ and quadrature component $Q$ of the complex baseband signal are independent zero-mean Gaussian random variables with equal variance that scales linearly with the total scattered power. Denote the envelope amplitude by $A = \\sqrt{I^2 + Q^2}$. Under these conditions, the envelope amplitude $A$ is Rayleigh distributed. Let the instantaneous envelope statistics depend on three physical parameters: scatterer concentration $\\rho$ in $\\mathrm{mm}^{-3}$, effective resolution cell volume $V$ in $\\mathrm{mm}^3$, and a per-scatterer backscatter power coefficient $\\eta$ (dimensionless). Assume that the variance of each Gaussian component is proportional to the total scattered power in the resolution cell, which is proportional to $\\rho V \\eta$.\n\nDefine the speckle contrast for the envelope amplitude as $\\mathrm{SC} = \\sigma_A / \\mu_A$, where $\\mu_A$ is the mean of $A$ and $\\sigma_A$ is the standard deviation of $A$. Starting from the above model and fundamental probabilistic definitions, derive the dependence (or independence) of $\\mathrm{SC}$ on $\\rho$, $V$, and $\\eta$, and then implement a program that computes $\\mathrm{SC}$ for the Rayleigh-distributed envelope amplitude for each parameter set in the test suite below. Express each result as a dimensionless float (no units). Angles, if any, are not used in this problem.\n\nUse only fundamental properties of Gaussian sums and Rayleigh envelopes implied by the central limit theorem and random phasor addition; do not assume or use any pre-given expression for $\\mu_A$, $\\sigma_A$, or $\\mathrm{SC}$ in the problem statement. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$).\n\nTest suite (each case is a tuple $(\\rho, V, \\eta)$ with units as specified):\n- Case $1$: $(\\rho, V, \\eta) = (1.0 \\times 10^{5}\\ \\mathrm{mm}^{-3},\\ 0.02\\ \\mathrm{mm}^3,\\ 1.0)$\n- Case $2$: $(\\rho, V, \\eta) = (5.0 \\times 10^{5}\\ \\mathrm{mm}^{-3},\\ 0.02\\ \\mathrm{mm}^3,\\ 1.0)$\n- Case $3$: $(\\rho, V, \\eta) = (1.0 \\times 10^{5}\\ \\mathrm{mm}^{-3},\\ 0.20\\ \\mathrm{mm}^3,\\ 1.0)$\n- Case $4$: $(\\rho, V, \\eta) = (1.0 \\times 10^{5}\\ \\mathrm{mm}^{-3},\\ 0.02\\ \\mathrm{mm}^3,\\ 3.5)$\n\nYour program must compute $\\mathrm{SC}$ for each case and output a single line containing the four results in the format $[r_1,r_2,r_3,r_4]$.",
            "solution": "The problem requires the derivation and computation of the speckle contrast, $\\mathrm{SC}$, for a fully developed speckle pattern in ultrasound imaging.\n\nThe core of the problem is to derive the speckle contrast $\\mathrm{SC} = \\sigma_A / \\mu_A$. This requires calculating the first moment (mean, $\\mu_A$) and the second central moment (variance, $\\sigma_A^2$) of the envelope amplitude $A$.\n\nAs stated, the in-phase component $I$ and quadrature component $Q$ are independent and identically distributed Gaussian random variables with zero mean and variance $\\sigma^2$.\n$$I \\sim \\mathcal{N}(0, \\sigma^2)$$\n$$Q \\sim \\mathcal{N}(0, \\sigma^2)$$\nTheir joint probability density function (PDF) is the product of their individual PDFs:\n$$f_{I,Q}(i, q) = f_I(i) f_Q(q) = \\left( \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-i^2/(2\\sigma^2)} \\right) \\left( \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-q^2/(2\\sigma^2)} \\right) = \\frac{1}{2\\pi\\sigma^2} e^{-(i^2+q^2)/(2\\sigma^2)}$$\nThe envelope amplitude is $A = \\sqrt{I^2 + Q^2}$. This formulation corresponds to a Rayleigh distribution for $A$. The PDF of a Rayleigh-distributed random variable $A$ with parameter $\\sigma$ is:\n$$f_A(a) = \\frac{a}{\\sigma^2} e^{-a^2 / (2\\sigma^2)}, \\quad \\text{for } a \\ge 0$$\n\nWe need to calculate the mean $\\mu_A = \\mathbb{E}[A]$ and the variance $\\sigma_A^2 = \\mathbb{E}[A^2] - (\\mathbb{E}[A])^2$.\n\nThe mean is the first moment of the distribution, calculated by integrating $a \\cdot f_A(a)$ over its support:\n$$\\mu_A = \\mathbb{E}[A] = \\int_0^\\infty a \\cdot f_A(a) \\, da = \\int_0^\\infty a \\left( \\frac{a}{\\sigma^2} e^{-a^2 / (2\\sigma^2)} \\right) \\, da = \\frac{1}{\\sigma^2} \\int_0^\\infty a^2 e^{-a^2 / (2\\sigma^2)} \\, da$$\nTo solve this integral, we can use a standard form or a substitution. Let $u = a / (\\sqrt{2}\\sigma)$, so $a = \\sqrt{2}\\sigma u$ and $da = \\sqrt{2}\\sigma \\, du$.\n$$\\mu_A = \\frac{1}{\\sigma^2} \\int_0^\\infty (\\sqrt{2}\\sigma u)^2 e^{-u^2} (\\sqrt{2}\\sigma \\, du) = \\frac{1}{\\sigma^2} (2\\sigma^2) (\\sqrt{2}\\sigma) \\int_0^\\infty u^2 e^{-u^2} \\, du = 2\\sqrt{2}\\sigma \\int_0^\\infty u^2 e^{-u^2} \\, du$$\nThe definite integral $\\int_0^\\infty u^2 e^{-u^2} \\, du$ is a known result related to the Gamma function, equal to $\\sqrt{\\pi}/4$.\n$$\\mu_A = 2\\sqrt{2}\\sigma \\left( \\frac{\\sqrt{\\pi}}{4} \\right) = \\sigma \\frac{\\sqrt{2\\pi}}{2} = \\sigma \\sqrt{\\frac{\\pi}{2}}$$\n\nThe second moment, $\\mathbb{E}[A^2]$, can be calculated more directly from the properties of $I$ and $Q$.\n$$\\mathbb{E}[A^2] = \\mathbb{E}[I^2 + Q^2]$$\nBy the linearity of expectation, this is:\n$$\\mathbb{E}[A^2] = \\mathbb{E}[I^2] + \\mathbb{E}[Q^2]$$\nFor any random variable $X$, its variance is $\\text{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$. Since $I$ and $Q$ are zero-mean, $\\mathbb{E}[I] = 0$ and $\\mathbb{E}[Q] = 0$. Therefore:\n$$\\mathbb{E}[I^2] = \\text{Var}(I) + (\\mathbb{E}[I])^2 = \\sigma^2 + 0^2 = \\sigma^2$$\n$$\\mathbb{E}[Q^2] = \\text{Var}(Q) + (\\mathbb{E}[Q])^2 = \\sigma^2 + 0^2 = \\sigma^2$$\nSubstituting these back, we get:\n$$\\mathbb{E}[A^2] = \\sigma^2 + \\sigma^2 = 2\\sigma^2$$\n\nThe variance of $A$ is given by:\n$$\\sigma_A^2 = \\mathbb{E}[A^2] - (\\mu_A)^2 = 2\\sigma^2 - \\left(\\sigma \\sqrt{\\frac{\\pi}{2}}\\right)^2 = 2\\sigma^2 - \\sigma^2 \\frac{\\pi}{2} = \\sigma^2 \\left(2 - \\frac{\\pi}{2}\\right)$$\n\nThe standard deviation of the envelope amplitude $\\sigma_A$ is the square root of the variance:\n$$\\sigma_A = \\sqrt{\\sigma_A^2} = \\sqrt{\\sigma^2 \\left(2 - \\frac{\\pi}{2}\\right)} = \\sigma \\sqrt{2 - \\frac{\\pi}{2}}$$\n\nNow we can compute the speckle contrast by substituting the expressions for $\\mu_A$ and $\\sigma_A$:\n$$\\mathrm{SC} = \\frac{\\sigma_A}{\\mu_A} = \\frac{\\sigma \\sqrt{2 - \\frac{\\pi}{2}}}{\\sigma \\sqrt{\\frac{\\pi}{2}}}$$\nThe parameter $\\sigma$ cancels out, demonstrating that the speckle contrast is independent of the scale of the underlying Gaussian distributions.\n$$\\mathrm{SC} = \\frac{\\sqrt{2 - \\frac{\\pi}{2}}}{\\sqrt{\\frac{\\pi}{2}}} = \\sqrt{\\frac{4 - \\pi}{\\pi}}$$\n\nThe derived expression for speckle contrast, $\\mathrm{SC} = \\sqrt{(4 - \\pi)/\\pi}$, is a numerical constant. It does not contain $\\sigma$. Since $\\sigma^2$ is proportional to the physical parameters $\\rho$, $V$, and $\\eta$, $\\mathrm{SC}$ is therefore also independent of $\\rho$, $V$, and $\\eta$. This is a hallmark of fully developed speckle: the relative fluctuation of the signal (contrast) is constant, irrespective of the absolute signal strength.\n\nThe value of speckle contrast is:\n$$\\mathrm{SC} = \\sqrt{\\frac{4 - \\pi}{\\pi}} \\approx \\sqrt{\\frac{4 - 3.14159265}{3.14159265}} \\approx \\sqrt{\\frac{0.85840735}{3.14159265}} \\approx \\sqrt{0.27323954} \\approx 0.5227232$$\nSince the result is a constant, it will be the same for all four test cases provided in the problem statement. The specific values of $(\\rho, V, \\eta)$ affect the overall backscattered power and thus $\\sigma$, but not the speckle contrast $\\mathrm{SC}$. The program to be implemented will compute this constant value for each case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating speckle contrast for Rayleigh-distributed\n    ultrasound envelope amplitudes.\n    \"\"\"\n\n    # Test suite (each case is a tuple (rho, V, eta))\n    # rho: scatterer concentration in mm^-3\n    # V: effective resolution cell volume in mm^3\n    # eta: per-scatterer backscatter power coefficient (dimensionless)\n    # These parameters are provided to test the conceptual understanding that SC\n    # is independent of them for fully developed speckle.\n    test_cases = [\n        (1.0e5, 0.02, 1.0),  # Case 1\n        (5.0e5, 0.02, 1.0),  # Case 2\n        (1.0e5, 0.20, 1.0),  # Case 3\n        (1.0e5, 0.02, 3.5),  # Case 4\n    ]\n\n    def calculate_speckle_contrast(rho, V, eta):\n        \"\"\"\n        Calculates the speckle contrast (SC) for a Rayleigh-distributed envelope.\n\n        The problem specifies a model for fully developed speckle, where the\n        in-phase (I) and quadrature (Q) components of the signal are\n        independent, zero-mean Gaussian random variables with equal variance sigma^2.\n        The envelope amplitude is A = sqrt(I^2 + Q^2), which is Rayleigh distributed.\n        Speckle contrast is defined as SC = sigma_A / mu_A.\n\n        As derived in the solution, this value simplifies to a constant,\n        independent of the physical parameters (rho, V, eta) that determine sigma^2.\n        The derived constant is SC = sqrt((4 - pi) / pi).\n        \n        Args:\n            rho (float): Scatterer concentration.\n            V (float): Resolution cell volume.\n            eta (float): Backscatter power coefficient.\n            \n        Returns:\n            float: The constant value of speckle contrast for fully developed speckle.\n        \"\"\"\n        # The theoretical value is a constant for fully developed Rayleigh speckle.\n        # It is independent of the parameters rho, V, and eta.\n        sc_value = np.sqrt((4.0 - np.pi) / np.pi)\n        return sc_value\n\n    results = []\n    # Iterate through the test cases and compute the result for each.\n    # The result will be the same for all cases.\n    for case in test_cases:\n        rho_val, v_val, eta_val = case\n        result = calculate_speckle_contrast(rho_val, v_val, eta_val)\n        results.append(result)\n\n    # Format the output as a single line: a comma-separated list enclosed in square brackets.\n    # The default string conversion of a float is used as per standard output practices.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}