{
    "hands_on_practices": [
        {
            "introduction": "Building a genetic map from scratch is a foundational skill in genetics. The three-point testcross is the classic experimental design that allows us to determine the linear order of genes on a chromosome and the genetic distances between them. This exercise will guide you through the logical steps of analyzing raw progeny data to infer gene order and calculate map distances, a process that turns crossover frequencies into a coherent chromosomal map. ",
            "id": "2801497",
            "problem": "A trihybrid individual that is heterozygous at three loci $A$, $B$, and $C$ carries coupling-phase haplotypes $A B C$ and $a b c$. This individual is testcrossed to a triple-recessive $a b c$ tester. The phenotypic classes in the testcross progeny directly reflect the gametes produced by the trihybrid parent. You observe the following eight progeny classes (total $N = 10{,}000$):\n\n- $A B C: 3{,}579$\n- $a b c: 3{,}573$\n- $A b c: 525$\n- $a B C: 523$\n- $A B c: 826$\n- $a b C: 824$\n- $A b C: 76$\n- $a B c: 74$\n\nStarting only from core definitions about recombination fraction, double crossover (DCO), and three-point testcross logic in classical genetics, infer the linear gene order and compute the genetic map distances between adjacent loci in the inferred order.\n\n- Report the gene order from left to right as a permutation of locus indices $(1,2,3)$, where $1 \\equiv A$, $2 \\equiv B$, and $3 \\equiv C$.\n- Compute the two adjacent-locus distances $d_{1\\text{–}2}$ and $d_{2\\text{–}3}$ in centiMorgans (centiMorgan, cM), using the standard short-distance approximation that the recombination fraction multiplied by $100$ equals genetic distance in $\\text{cM}$.\n- Round each distance to four significant figures.\n- Express your final answer as a single row matrix $\\begin{pmatrix} i_1 & i_2 & i_3 & d_{1\\text{–}2} & d_{2\\text{–}3} \\end{pmatrix}$, with no units inside the matrix. In the body of your solution, state the units as $\\text{cM}$.",
            "solution": "The problem is subjected to validation.\n\nGivens are extracted verbatim:\n- A trihybrid individual is heterozygous at three loci $A$, $B$, and $C$.\n- The individual carries coupling-phase haplotypes $A B C$ and $a b c$.\n- This individual is testcrossed to a triple-recessive $a b c$ tester.\n- The total progeny count is $N = 10,000$.\n- Progeny phenotypic class counts:\n  - $A B C: 3,579$\n  - $a b c: 3,573$\n  - $A b c: 525$\n  - $a B C: 523$\n  - $A B c: 826$\n  - $a b C: 824$\n  - $A b C: 76$\n  - $a B c: 74$\n\nValidation verdict: The problem is valid.\n- It is scientifically grounded in the principles of classical genetics, specifically three-point testcross analysis for gene mapping.\n- It is well-posed, providing all necessary data for a unique solution.\n- The language is objective and precise.\n- The data are internally consistent; the sum of progeny counts is $3,579 + 3,573 + 525 + 523 + 826 + 824 + 76 + 74 = 10,000$, which matches the given total $N$. The reciprocal classes (e.g., $A B C$ and $a b c$) have quantitatively similar counts, as expected from meiosis. All criteria for a valid problem are met.\n\nThe solution proceeds. The objective is to determine the linear order of the three genes and the genetic distances between them. The analysis of a three-point testcross relies on identifying the different classes of gametes produced by the heterozygous parent. Since the tester parent is homozygous recessive ($a b c$), the phenotype of the progeny directly reveals the genetic constitution of the gamete from the trihybrid parent.\n\nFirst, we classify the progeny based on their frequencies. The principle is that parental (non-recombinant) gametes are the most frequent, and double crossover (DCO) gametes are the least frequent.\n- The two most frequent phenotypic classes are $A B C$ (count $3,579$) and $a b c$ (count $3,573$). These represent the parental, or non-recombinant, gametes. The total number of non-recombinant progeny is $N_{P} = 3,579 + 3,573 = 7,152$. This is consistent with the given parental haplotypes $A B C$ and $a b c$.\n- The two least frequent phenotypic classes are $A b C$ (count $76$) and $a B c$ (count $74$). These represent the double crossover (DCO) gametes, which arise from two simultaneous crossover events. The total number of DCO progeny is $N_{DCO} = 76 + 74 = 150$.\n\nNext, we determine the gene order. A double crossover event switches the middle allele between the two parental chromosomes. By comparing the allelic composition of a DCO gamete with a parental gamete, we can identify the gene in the middle. Let us compare the parental haplotype $A B C$ with the DCO haplotype $A b C$. The alleles for loci $A$ and $C$ are the same ($A$ and $C$), while the allele for locus $B$ has been exchanged ($B$ for $b$). This indicates that locus $B$ is located between loci $A$ and $C$. The correct gene order is therefore $A - B - C$. As per the problem's notation where $1 \\equiv A$, $2 \\equiv B$, and $3 \\equiv C$, the gene order is $(1, 2, 3)$.\n\nWith the gene order established, we can now classify the remaining four progeny classes, which result from single crossover (SCO) events.\n- A single crossover between gene $A$ and gene $B$ (Region $1$) would produce the gametes $A b c$ and $a B C$. The observed counts for these classes are $525$ and $523$, respectively. The total number of SCO progeny for Region $1$ is $N_{SCO1} = 525 + 523 = 1,048$.\n- A single crossover between gene $B$ and gene $C$ (Region $2$) would produce the gametes $A B c$ and $a b C$. The observed counts for these classes are $826$ and $824$, respectively. The total number of SCO progeny for Region $2$ is $N_{SCO2} = 826 + 824 = 1,650$.\n\nNow, we compute the genetic map distances. The map distance between two loci is defined as the recombination frequency between them, expressed in centiMorgans ($\\text{cM}$). One centiMorgan corresponds to a $1\\%$ recombination frequency. The recombination frequency ($RF$) is the ratio of the number of recombinant progeny to the total number of progeny. It is crucial to remember that the total number of recombinant events between two loci includes *both* single crossovers in that interval *and all* double crossovers.\n\nThe distance between locus $A$ and locus $B$, denoted $d_{1\\text{–}2}$, is calculated as:\n$$RF_{A-B} = \\frac{N_{SCO1} + N_{DCO}}{N_{total}} = \\frac{1,048 + 150}{10,000} = \\frac{1,198}{10,000} = 0.1198$$\nThe map distance is then:\n$$d_{1\\text{–}2} = RF_{A-B} \\times 100 = 0.1198 \\times 100 = 11.98 \\text{ cM}$$\nThis value is already provided to four significant figures.\n\nThe distance between locus $B$ and locus $C$, denoted $d_{2\\text{–}3}$, is calculated similarly:\n$$RF_{B-C} = \\frac{N_{SCO2} + N_{DCO}}{N_{total}} = \\frac{1,650 + 150}{10,000} = \\frac{1,800}{10,000} = 0.1800$$\nThe map distance is then:\n$$d_{2\\text{–}3} = RF_{B-C} \\times 100 = 0.1800 \\times 100 = 18.00 \\text{ cM}$$\nThis value is given to four significant figures.\n\nThe inferred genetic map is: $A \\xrightarrow{11.98\\text{ cM}} B \\xrightarrow{18.00\\text{ cM}} C$.\n\nTo confirm the non-randomness of crossover events (genetic interference), we can compare the observed DCO frequency with the expected DCO frequency. The expected frequency is the product of the recombination frequencies of the two adjacent regions:\n$$RF_{expected DCO} = RF_{A-B} \\times RF_{B-C} = 0.1198 \\times 0.1800 \\approx 0.02156$$\nThe expected number of DCO progeny is $10,000 \\times 0.02156 = 215.6$.\nThe observed number is $150$. The coefficient of coincidence is $C = \\frac{\\text{Observed DCO}}{\\text{Expected DCO}} = \\frac{150}{215.6} \\approx 0.696$.\nThe interference is $I = 1 - C = 1 - 0.696 = 0.304$. This positive interference value indicates that a crossover in one region reduces the probability of a simultaneous crossover in the adjacent region, a common biological phenomenon.\n\nThe final answer requires the gene order as a permutation of $(1,2,3)$ and the two adjacent map distances, $d_{1\\text{–}2}$ and $d_{2\\text{–}3}$.\nThe gene order is $A-B-C$, which corresponds to $(1, 2, 3)$.\nThe distances are $d_{1\\text{–}2} = 11.98$ and $d_{2\\text{–}3} = 18.00$.\nThe required output is a single row matrix containing these five values.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2 & 3 & 11.98 & 18.00\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While our basic mapping calculations often assume crossover events are independent, the reality is more complex. The phenomenon of crossover interference, where one crossover event influences the likelihood of another nearby, provides deeper insight into the mechanics of meiosis. This practice focuses on quantifying this effect by calculating the coefficient of coincidence ($c$) and interference ($I$) from testcross data, helping you to interpret the non-random nature of recombination. ",
            "id": "5038239",
            "problem": "A three-point testcross is performed in humans on a chromosome carrying three autosomal markers arranged in the linear order $A$–$B$–$C$. A heterozygous parent for all three markers is crossed to a homozygous recessive tester. Among the $N = 1200$ offspring, the following aggregated crossover categories are observed after unambiguous phase determination: single crossover events confined to interval $A$–$B$ occur in $220$ offspring, single crossover events confined to interval $B$–$C$ occur in $180$ offspring, and double crossover (DCO) events involving both intervals occur in $30$ offspring.\n\nStarting from core definitions in genetic linkage and recombination, estimate the coefficient of coincidence $c$ and the interference $I$ for these intervals. Your derivation should begin from the definition of the recombination fraction for an interval and the independence assumption for crossovers in adjacent intervals when interference is absent, and proceed logically to quantities that capture deviation from independence. Briefly interpret what the numerical values of $c$ and $I$ imply about the underlying biological mechanisms of crossover interference in this dataset.\n\nExpress both $c$ and $I$ as decimals and round your answers to four significant figures.",
            "solution": "**Problem Validation**\n\n**Step 1: Extract Givens**\n- The three autosomal markers are in the linear order $A$–$B$–$C$.\n- A cross is performed between a parent heterozygous for all three markers and a homozygous recessive tester. This is a three-point testcross.\n- Total number of offspring, $N = 1200$.\n- Number of single crossover (SCO) events in interval $A$–$B$: $n_{SCO, A-B} = 220$.\n- Number of single crossover (SCO) events in interval $B$–$C$: $n_{SCO, B-C} = 180$.\n- Number of double crossover (DCO) events: $n_{DCO} = 30$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded:** The problem describes a classic three-point testcross, a fundamental experimental design in genetic mapping. The concepts of linkage, recombination, coefficient of coincidence, and interference are central Mendelian and molecular genetics principles. The provided data are biologically plausible for a eukaryotic organism. The problem is scientifically sound.\n- **Well-Posed:** All necessary data ($N$, counts of SCO and DCO classes) are provided to calculate the requested quantities ($c$ and $I$). The question is unambiguous and has a unique, stable solution.\n- **Objective:** The problem is stated using precise, formal language common in genetics, free of subjective or opinion-based content.\n- **Other Flaws:** The problem does not exhibit any other flaws. It is not metaphorical, is complete, consistent, realistic, and well-structured. It requires a substantive application of genetic principles.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe problem requires the calculation of the coefficient of coincidence, $c$, and the interference, $I$. We begin from the fundamental definitions of recombination frequency and proceed to the definitions of $c$ and $I$.\n\nThe recombination fraction, $RF$, between two loci is the proportion of gametes that are recombinant for those loci. It is estimated from testcross data as the number of recombinant offspring divided by the total number of offspring.\n\nThe total number of offspring is given as $N = 1200$.\n\nThe three-point testcross allows us to determine the recombination frequencies for two adjacent intervals, $A$–$B$ and $B$–$C$.\n\nFor interval $1$ ($A$–$B$), recombinant offspring are those that experienced a crossover between loci $A$ and $B$. These include the offspring from single crossovers in interval $A$–$B$ and the offspring from double crossovers (which involve a crossover in both intervals).\nThe total number of recombinant offspring for interval $A$–$B$ is:\n$$ n_{rec, A-B} = n_{SCO, A-B} + n_{DCO} = 220 + 30 = 250 $$\nThe recombination fraction for interval $A$–$B$ is therefore:\n$$ RF_{A-B} = \\frac{n_{rec, A-B}}{N} = \\frac{250}{1200} $$\n\nFor interval $2$ ($B$–$C$), recombinant offspring are those that experienced a crossover between loci $B$ and $C$. These include the offspring from single crossovers in interval $B$–$C$ and the offspring from double crossovers.\nThe total number of recombinant offspring for interval $B$–$C$ is:\n$$ n_{rec, B-C} = n_{SCO, B-C} + n_{DCO} = 180 + 30 = 210 $$\nThe recombination fraction for interval $B$–$C$ is therefore:\n$$ RF_{B-C} = \\frac{n_{rec, B-C}}{N} = \\frac{210}{1200} $$\n\nThe coefficient of coincidence, $c$, compares the observed frequency of double crossovers to the frequency expected if crossovers in the two intervals occurred independently. It is defined as:\n$$ c = \\frac{\\text{Observed frequency of DCO}}{\\text{Expected frequency of DCO}} $$\n\nThe observed frequency of double crossovers, $f_{DCO, obs}$, is the proportion of DCO offspring in the total population:\n$$ f_{DCO, obs} = \\frac{n_{DCO}}{N} = \\frac{30}{1200} $$\n\nThe expected frequency of double crossovers, $f_{DCO, exp}$, assuming independence (i.e., no interference), is the product of the individual recombination frequencies for each interval:\n$$ f_{DCO, exp} = RF_{A-B} \\times RF_{B-C} = \\left(\\frac{250}{1200}\\right) \\times \\left(\\frac{210}{1200}\\right) $$\n\nNow, we can calculate the coefficient of coincidence, $c$:\n$$ c = \\frac{f_{DCO, obs}}{f_{DCO, exp}} = \\frac{\\frac{30}{1200}}{\\frac{250}{1200} \\times \\frac{210}{1200}} = \\frac{30 \\times 1200}{250 \\times 210} = \\frac{36000}{52500} $$\nSimplifying the fraction:\n$$ c = \\frac{360}{525} = \\frac{24}{35} $$\nAs a decimal, this is approximately $c \\approx 0.685714...$. Rounding to four significant figures as requested:\n$$ c \\approx 0.6857 $$\n\nInterference, $I$, measures the degree to which a crossover in one interval inhibits the formation of a crossover in an adjacent interval. It is defined in relation to the coefficient of coincidence:\n$$ I = 1 - c $$\nUsing the calculated value of $c$:\n$$ I = 1 - \\frac{24}{35} = \\frac{35 - 24}{35} = \\frac{11}{35} $$\nAs a decimal, this is approximately $I \\approx 0.314285...$. Rounding to four significant figures as requested:\n$$ I \\approx 0.3143 $$\n\n**Interpretation of Results:**\nThe coefficient of coincidence $c \\approx 0.6857$ means that the observed number of double crossovers is only $68.57\\%$ of the number that would be expected if crossovers in intervals $A$–$B$ and $B$–$C$ were independent events.\nThe interference $I \\approx 0.3143$, or $31.43\\%$, is positive ($I > 0$). This indicates the presence of positive crossover interference. The occurrence of one crossover event in one of the intervals has reduced the probability of a second crossover event occurring in the adjacent interval by approximately $31.43\\%$. This phenomenon is a common feature of meiosis in most eukaryotes and is thought to result from mechanical stresses along the chromosome that disfavor the formation of closely spaced chiasmata.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6857 & 0.3143\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The principles of genetic mapping have been powerfully adapted for the genomic era of medicine. In this practice, we shift from mapping hypothetical genes to a critical application in medical genetics: identifying Runs of Homozygosity (ROH) to locate recessive disease genes. You will implement a computational approach to analyze single-nucleotide polymorphism (SNP) data, demonstrating how genetic map distances in centiMorgans ($cM$) are used in modern bioinformatics to pinpoint segments of the genome that are likely identical by descent. ",
            "id": "5038275",
            "problem": "You are given single-nucleotide polymorphism (SNP) genotype series for two affected siblings from a consanguineous pedigree. Runs of Homozygosity (ROH) that are shared by affected siblings and identical by state are indicative of potential autozygous segments harboring a recessive risk allele. Using known genetic map positions in centiMorgans (cM) for each SNP along a chromosome, implement a program that identifies maximal shared ROH segments and computes their genetic lengths.\n\nUse the following foundational base:\n- A genetic map position in centiMorgans (cM) is a monotonic coordinate along the chromosome where $1$ cM is defined as the genetic distance corresponding to a recombination fraction of $0.01$. The map is additive along intervals: the genetic length of a segment spanning SNPs indexed from $i$ to $j$ equals $m_j - m_i$, where $m_k$ is the map position (in cM) of SNP index $k$.\n- A SNP genotype is coded as an integer: $0$ for homozygous allele $A$, $1$ for heterozygous allele $A/B$, $2$ for homozygous allele $B$, and $-1$ for missing. A SNP is homozygous if its code is in $\\{0, 2\\}$. Two siblings share a SNP identically by state if both are homozygous and have the same homozygous code (both $0$ or both $2$).\n- A shared ROH segment is a maximal consecutive block of SNPs along the chromosome where both siblings are identically homozygous by state at each SNP in the block. Missing data ($-1$) or heterozygosity ($1$) at any SNP breaks the segment.\n\nYour program must:\n1. Identify all maximal shared ROH segments that satisfy a minimum SNP count threshold $t$ (i.e., the block length in SNPs must be $\\geq t$).\n2. For each accepted segment, compute its genetic length in cM as the difference between the map positions (in cM) of the last and first SNP in the segment, i.e., $L = m_{\\text{end}} - m_{\\text{start}}$.\n3. Express lengths as decimal numbers in centiMorgans (cM), rounded to three decimal places.\n\nImplement the program for the following test suite. Each test case is specified by:\n- A list of genetic map positions (in cM) $[m_0, m_1, \\dots, m_{n-1}]$ with non-decreasing values.\n- Two genotype lists (integers as above) for the siblings, $[g^{(1)}_0, \\dots, g^{(1)}_{n-1}]$ and $[g^{(2)}_0, \\dots, g^{(2)}_{n-1}]$.\n- The minimum SNP threshold $t$ (an integer).\n\nTest suite:\n- Case A (general happy path):\n  - Map cM: $[0.0, 0.5, 1.0, 1.5, 3.0, 3.2, 4.0]$\n  - Sibling $1$ genotypes: $[0, 0, 0, 1, 2, 2, 2]$\n  - Sibling $2$ genotypes: $[0, 0, 0, 1, 2, 2, 2]$\n  - Threshold $t = 3$\n- Case B (boundary condition, segment length exactly at threshold):\n  - Map cM: $[10.0, 10.2, 10.4]$\n  - Sibling $1$ genotypes: $[2, 2, 2]$\n  - Sibling $2$ genotypes: $[2, 2, 2]$\n  - Threshold $t = 3$\n- Case C (edge case: no segment meets threshold):\n  - Map cM: $[1.0, 1.5, 2.0]$\n  - Sibling $1$ genotypes: $[0, 0, 0]$\n  - Sibling $2$ genotypes: $[0, 0, 0]$\n  - Threshold $t = 4$\n- Case D (edge case: homozygous blocks with allele mismatch breaking shared identity):\n  - Map cM: $[5.0, 5.4, 5.8, 6.4, 7.0]$\n  - Sibling $1$ genotypes: $[0, 0, 2, 2, 2]$\n  - Sibling $2$ genotypes: $[0, 0, 0, 0, 2]$\n  - Threshold $t = 2$\n- Case E (edge case: heterozygosity and missing data break segments):\n  - Map cM: $[12.0, 12.6, 13.0, 13.2, 13.8, 14.0]$\n  - Sibling $1$ genotypes: $[2, 2, 1, -1, 2, 2]$\n  - Sibling $2$ genotypes: $[2, 2, 1, -1, 2, 2]$\n  - Threshold $t = 2$\n- Case F (edge case: long homozygous runs but different alleles in siblings):\n  - Map cM: $[20.0, 20.5, 21.0, 21.5]$\n  - Sibling $1$ genotypes: $[0, 0, 0, 0]$\n  - Sibling $2$ genotypes: $[2, 2, 2, 2]$\n  - Threshold $t = 2$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is the list of segment lengths (in cM) for that case, rounded to three decimals (e.g., $[[1.000, 0.400],[\\dots],\\dots]$). The printed Python list representation with decimal numbers is acceptable; do not include any text other than this single-line list.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of medical genetics, specifically autozygosity mapping, and presents a well-posed computational task with clear, objective, and complete definitions.\n\n### Principle-Based Design\n\nThe problem addresses the identification of shared Runs of Homozygosity (ROH) between two affected siblings from a consanguineous family. This is a fundamental technique in medical genetics for mapping the location of recessive disease genes. The underlying principle is that in a consanguineous mating, offspring have an increased probability of inheriting two copies of the same ancestral chromosomal segment from a common ancestor. This state is known as being homozygous by descent, or autozygous. If a rare recessive disease allele is present on such a segment, an affected individual will be homozygous for it. When two siblings are affected by the same recessive disease, it is highly probable that they are both autozygous for the same causal genomic region. By searching for segments where both siblings are homozygous and share the same alleles—a state known as identical by state (IBS), which serves as a proxy for autozygosity—we can identify candidate regions that may harbor the disease gene.\n\nThe problem provides a formalized, computational approach to this search. We are given Single-Nucleotide Polymorphism (SNP) genotypes and their corresponding genetic map positions in centiMorgans ($cM$) along a chromosome.\n\nA SNP at a given index $k$ is considered for inclusion in a shared ROH if and only if both siblings are homozygous for the same allele at that position. Let $g_k^{(1)}$ and $g_k^{(2)}$ be the integer-coded genotypes for sibling $1$ and sibling $2$ at SNP index $k$, respectively. The set of homozygous genotypes is $\\{0, 2\\}$. A SNP at index $k$ contributes to a shared ROH if the following condition holds:\n$$\ng_k^{(1)} = g_k^{(2)} \\land g_k^{(1)} \\in \\{0, 2\\}\n$$\nAny SNP where either sibling is heterozygous (genotype code $1$), has missing data (code $-1$), or where both are homozygous but for different alleles (e.g., $g_k^{(1)}=0$ and $g_k^{(2)}=2$) will break a shared ROH.\n\nA shared ROH segment is defined as a *maximal* consecutive block of SNPs that all satisfy the shared homozygosity criterion. The task is to identify all such maximal segments that meet or exceed a minimum length threshold, $t$, defined by the number of SNPs in the segment.\n\nFor each valid segment, its genetic length, $L$, must be calculated. The genetic map provides a coordinate system in centiMorgans ($cM$). If a valid segment starts at SNP index $i_{\\text{start}}$ and ends at SNP index $i_{\\text{end}}$, its genetic length is the difference in their map positions:\n$$\nL = m_{i_{\\text{end}}} - m_{i_{\\text{start}}}\n$$\nwhere $m_k$ is the genetic map position in cM for the SNP at index $k$.\n\n### Algorithmic Strategy\n\nTo implement this, we can employ a single-pass algorithm that iterates through the SNP data, maintaining state to identify the boundaries of potential shared ROH segments.\n\n1.  **State Initialization**: We use a state variable, for instance `run_start_index`, initialized to a sentinel value (e.g., $-1$) to indicate that we are not currently within a shared ROH.\n\n2.  **Iteration**: We iterate through each SNP index $i$ from $0$ to $n-1$, where $n$ is the total number of SNPs.\n\n3.  **State Transition**: At each SNP $i$, we check if it meets the shared homozygosity condition: $g_i^{(1)} = g_i^{(2)} \\land g_i^{(1)} \\in \\{0, 2\\}$.\n    - If the condition is **met** and `run_start_index` is $-1$, it signifies the beginning of a new potential segment. We record this starting position by setting `run_start_index = i`.\n    - If the condition is **not met** and `run_start_index` is not $-1$, it signifies the end of the current segment. The just-ended segment spans from `run_start_index` to $i-1$. We proceed to process this segment (Step 4) and then reset `run_start_index` to $-1$.\n\n4.  **Segment Processing**: When a segment terminates (either by a non-qualifying SNP or by reaching the end of the chromosome data), we determine its properties.\n    - Let the start index be $i_{\\text{start}} = \\text{run\\_start\\_index}$ and the end index be $i_{\\text{end}}$.\n    - The number of SNPs in the segment is $N_{SNPs} = i_{\\text{end}} - i_{\\text{start}} + 1$.\n    - We check if this count meets the threshold: $N_{SNPs} \\geq t$.\n    - If the segment is valid, we compute its genetic length $L = m_{i_{\\text{end}}} - m_{i_{\\text{start}}}$. This length, rounded to three decimal places, is stored.\n\n5.  **Termination**: After the loop has finished, we must perform a final check to see if a segment was active up to the very last SNP. If `run_start_index` is not $-1$ after the loop, it means the last segment extends to the end of the data (index $n-1$), and it must be processed as described in Step 4. A clean way to implement this is to extend the iteration one step beyond the end of the data, which forces any trailing active segment to be processed.\n\nThis algorithm correctly identifies all maximal, non-overlapping shared ROH segments and calculates their genetic lengths as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the shared ROH identification problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case A (general happy path)\n        {\n            \"map_cm\": [0.0, 0.5, 1.0, 1.5, 3.0, 3.2, 4.0],\n            \"g1\": [0, 0, 0, 1, 2, 2, 2],\n            \"g2\": [0, 0, 0, 1, 2, 2, 2],\n            \"t\": 3\n        },\n        # Case B (boundary condition, segment length exactly at threshold)\n        {\n            \"map_cm\": [10.0, 10.2, 10.4],\n            \"g1\": [2, 2, 2],\n            \"g2\": [2, 2, 2],\n            \"t\": 3\n        },\n        # Case C (edge case: no segment meets threshold)\n        {\n            \"map_cm\": [1.0, 1.5, 2.0],\n            \"g1\": [0, 0, 0],\n            \"g2\": [0, 0, 0],\n            \"t\": 4\n        },\n        # Case D (edge case: homozygous blocks with allele mismatch)\n        {\n            \"map_cm\": [5.0, 5.4, 5.8, 6.4, 7.0],\n            \"g1\": [0, 0, 2, 2, 2],\n            \"g2\": [0, 0, 0, 0, 2],\n            \"t\": 2\n        },\n        # Case E (edge case: heterozygosity and missing data break segments)\n        {\n            \"map_cm\": [12.0, 12.6, 13.0, 13.2, 13.8, 14.0],\n            \"g1\": [2, 2, 1, -1, 2, 2],\n            \"g2\": [2, 2, 1, -1, 2, 2],\n            \"t\": 2\n        },\n        # Case F (edge case: long homozygous runs but different alleles)\n        {\n            \"map_cm\": [20.0, 20.5, 21.0, 21.5],\n            \"g1\": [0, 0, 0, 0],\n            \"g2\": [2, 2, 2, 2],\n            \"t\": 2\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result_lengths = find_shared_roh(\n            case[\"map_cm\"],\n            case[\"g1\"],\n            case[\"g2\"],\n            case[\"t\"]\n        )\n        all_results.append(result_lengths)\n\n    # Format the final output string to match the required format precisely.\n    # e.g., [[1.000,1.000],[0.400],[],[0.400],[0.600,0.200],[]]\n    output_parts = []\n    for case_result in all_results:\n        formatted_nums = [f\"{num:.3f}\" for num in case_result]\n        inner_str = \",\".join(formatted_nums)\n        output_parts.append(f\"[{inner_str}]\")\n    \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\ndef find_shared_roh(map_cm, g1, g2, t):\n    \"\"\"\n    Identifies maximal shared ROH segments and computes their genetic lengths.\n\n    Args:\n        map_cm (list[float]): Genetic map positions in centiMorgans.\n        g1 (list[int]): Genotypes for sibling 1.\n        g2 (list[int]): Genotypes for sibling 2.\n        t (int): Minimum SNP count threshold for a segment.\n\n    Returns:\n        list[float]: A list of genetic lengths (in cM) for valid segments,\n                     rounded to three decimal places.\n    \"\"\"\n    n = len(map_cm)\n    g1_np = np.array(g1)\n    g2_np = np.array(g2)\n\n    # A SNP is in a shared ROH if both siblings are homozygous for the same allele.\n    # Genotype codes for homozygous are 0 and 2.\n    is_shared_homozygous = (g1_np == g2_np)  np.isin(g1_np, [0, 2])\n\n    found_lengths = []\n    run_start_index = -1\n\n    # Iterate one position past the end to handle runs at the very end of the array.\n    for i in range(n + 1):\n        is_in_run = i  n and is_shared_homozygous[i]\n\n        if is_in_run:\n            # If a run is starting, record its start index.\n            if run_start_index == -1:\n                run_start_index = i\n        else:\n            # If we were in a run, it has now ended.\n            if run_start_index != -1:\n                run_end_index = i - 1\n                snp_count = run_end_index - run_start_index + 1\n\n                # Check if the run meets the minimum SNP threshold.\n                if snp_count >= t:\n                    # Calculate genetic length and round to 3 decimal places.\n                    length = map_cm[run_end_index] - map_cm[run_start_index]\n                    found_lengths.append(round(length, 3))\n                \n                # Reset state to indicate we are no longer in a run.\n                run_start_index = -1\n                \n    return found_lengths\n\nsolve()\n```"
        }
    ]
}