{
    "hands_on_practices": [
        {
            "introduction": "在应用责任阈值模型时，第一步是建立可观察的群体统计数据与模型理论参数之间的联系。本练习将引导你探索一个关键的数学关系：如何从已知的疾病患病率（$K$）推导出模型中的一个核心参数——责任阈值（$T$）。掌握这种转换是进行任何深入分析的基础。",
            "id": "5052684",
            "problem": "在一个大型随机交配群体中，一种复杂疾病在易感性阈值模型下进行建模。设未观察到的易感性为一个标准正态随机变量$L \\sim \\mathcal{N}(0,1)$，并假设当且仅当个体的易感性超过一个阈值$T$时，该个体才被视为患病。群体患病率为$K$，定义为随机选择的个体患病的概率。令$\\Phi(\\cdot)$表示标准正态累积分布函数（CDF），$\\phi(\\cdot)$表示标准正态概率密度函数（PDF）。\n\n仅使用$K$的定义和标准正态分布的性质，推导出一个用$K$表示$T$的表达式。然后，计算当$K = 0.01$时的$T$值。最后，用一两句话，从平均易感性的微小变化如何改变患病率的第一性原理出发，在用于阈值性状的尺度转换公式（例如，将观察尺度上的效应或方差与易感性尺度上的量联系起来时）的背景下，解释量$z = \\phi(T)$的含义。\n\n在最终答案中仅报告$T$的数值。将答案四舍五入至四位有效数字。不需要单位。",
            "solution": "题目陈述描述了一个标准的易感性阈值模型，这是数量遗传学中分析受潜在连续易感性影响的二分类结局（例如，患病与未患病）性状的一个基础概念。题目的所有组成部分都有明确的定义，具有科学依据，并且在数学上是一致的。该问题是有效的。\n\n该问题需要一个三部分的解答：首先，推导易感性阈值 $T$ 关于群体患病率 $K$ 的表达式；其次，计算特定患病率下的 $T$ 值；第三，解释量 $z = \\phi(T)$ 的含义。\n\n**第一部分：阈值 $T$ 的推导**\n\n设 $L$ 是代表个体易感性的随机变量，假设其服从标准正态分布，$L \\sim \\mathcal{N}(0,1)$。群体患病率 $K$ 定义为随机选择的个体患病的概率。根据该模型，当且仅当个体的易感性 $L$ 超过一个固定的阈值 $T$ 时，该个体才患病。\n\n在数学上，这可以表示为：\n$$K = P(L > T)$$\n由于 $L$ 是一个连续随机变量，$L$ 大于 $T$ 的概率是 $L$ 小于或等于 $T$ 的概率的补集。后者的概率由标准正态分布的累积分布函数（CDF）给出，记为 $\\Phi(z) = P(L \\le z)$。\n因此，我们可以写出：\n$$K = 1 - P(L \\le T)$$\n$$K = 1 - \\Phi(T)$$\n为了推导 $T$ 关于 $K$ 的表达式，我们整理这个方程：\n$$\\Phi(T) = 1 - K$$\n对等式两边应用标准正态CDF的反函数，即标准正态分位数函数，记为 $\\Phi^{-1}(\\cdot)$，可以分离出 $T$：\n$$T = \\Phi^{-1}(1 - K)$$\n这个表达式将易感性阈值 $T$ 定义为累积概率为 $1-K$ 的值。换句话说，$T$ 是标准正态分布的 $(1-K)$ 分位数。\n\n**第二部分：计算 $K = 0.01$ 时的 $T$ 值**\n\n给定群体患病率为 $K = 0.01$。使用推导出的公式：\n$$T = \\Phi^{-1}(1 - 0.01)$$\n$$T = \\Phi^{-1}(0.99)$$\n这要求计算 $T$ 的值，使得标准正态概率密度曲线在 $T$ 左侧的面积等于 $0.99$。这是标准正态分布的第 $99$ 百分位数。标准的统计表或计算软件可以提供这个值。该值约为 $2.32634787...$。\n按要求四舍五入到四位有效数字，我们得到：\n$$T \\approx 2.326$$\n\n**第三部分：$z = \\phi(T)$ 的解释**\n\n量 $z = \\phi(T)$ 是标准正态概率密度函数（PDF）在阈值 $T$ 处的取值。为了在尺度转换的背景下解释其含义，我们研究平均易感性的微小变化如何影响患病率 $K$。\n\n设群体的平均易感性发生一个微小的变化 $\\Delta\\mu$，因此新的易感性分布为 $L' \\sim \\mathcal{N}(\\Delta\\mu, 1)$。新的患病率 $K'$ 是个体易感性超过同一阈值 $T$ 的概率：\n$$K' = P(L' > T) = P(L + \\Delta\\mu > T) = P(L > T - \\Delta\\mu)$$\n其中 $L \\sim \\mathcal{N}(0,1)$。使用CDF，这可以表示为：\n$$K' = 1 - \\Phi(T - \\Delta\\mu)$$\n患病率的变化量 $\\Delta K$ 为：\n$$\\Delta K = K' - K = [1 - \\Phi(T - \\Delta\\mu)] - [1 - \\Phi(T)] = \\Phi(T) - \\Phi(T - \\Delta\\mu)$$\n对于一个无穷小的变化 $\\Delta\\mu$，我们可以使用 $\\Phi(T - \\Delta\\mu)$ 在点 $T$ 附近的一阶泰勒级数展开：\n$$\\Phi(T - \\Delta\\mu) \\approx \\Phi(T) + \\Phi'(T)(-\\Delta\\mu)$$\n标准正态CDF的导数 $\\Phi'(T)$ 是标准正态PDF $\\phi(T)$。因此：\n$$\\Phi(T - \\Delta\\mu) \\approx \\Phi(T) - \\phi(T)\\Delta\\mu$$\n将此近似值代入 $\\Delta K$ 的表达式中：\n$$\\Delta K \\approx \\Phi(T) - [\\Phi(T) - \\phi(T)\\Delta\\mu] = \\phi(T)\\Delta\\mu$$\n这导出了关系式 $\\frac{\\Delta K}{\\Delta\\mu} \\approx \\phi(T)$。在 $\\Delta\\mu \\to 0$ 的极限情况下，这变成了一个导数：\n$$\\frac{dK}{d\\mu}\\bigg|_{\\mu=0} = \\phi(T)$$\n从第一性原理出发，量 $z = \\phi(T)$ 是群体患病率相对于平均易感性的导数，表示平均易感性单位变化时患病率的变化率。因此，在尺度转换公式中，它充当线性缩放因子，将未观察到的连续易感性尺度上的效应大小与其在观察到的疾病状态二元尺度上的相应效应联系起来。",
            "answer": "$$\\boxed{2.326}$$"
        },
        {
            "introduction": "理解了模型的基本设定后，我们可以将其用于一项最强大的应用：估算遗传度。本练习模拟了一项经典的双生子研究，展示了如何利用亲属间的相关性来剖析基因和环境对疾病责任的贡献。通过这个实践，你将学会如何从双生子数据中量化复杂疾病的遗传基础。",
            "id": "5052635",
            "problem": "一种罕见的复杂疾病在易感性-阈值模型下进行建模，其中每个个体的潜在易感性$L$是三个独立的、均值为零的组分之和：一个加性遗传组分$A$，一个共享（共同）环境组分$C$，以及一个独特环境组分$E$。易感性的方差被标准化，使得$\\mathrm{Var}(L)=1$，并且这三个组分满足$\\mathrm{Var}(A)=V_{A}$、$\\mathrm{Var}(C)=V_{C}$和$\\mathrm{Var}(E)=V_{E}$，其中$V_{A}+V_{C}+V_{E}=1$。在经典双生子设计下，同卵（MZ）双生子共享所有加性遗传效应，而异卵（DZ）双生子平均共享一半的加性遗传效应；双生子对的成员共享共同环境，而独特环境在个体内部和个体之间均不相关。\n\n在一项使用易感性-阈值方法的基于人群的双生子研究中，在易感性尺度上，同卵双生子对的孪生子间四分相关性估计为$r_{MZ}=\\;0.58$，异卵双生子对的估计为$r_{DZ}=\\;0.32$。假设双生子对内部的阈值相等，并且这些四分相关性能有效估计孪生子间的易感性相关性。\n\n仅从上述定义、假设以及协方差和相关性的标准属性出发，推导将$r_{MZ}$和$r_{DZ}$与$V_{A}$和$V_{C}$联系起来的方程，求解易感性尺度上的狭义遗传力$h^{2}=V_{A}$，并使用观测到的$r_{MZ}$和$r_{DZ}$计算其数值。\n\n将$h^{2}$的最终答案表示为十进制数，并四舍五入到四位有效数字。",
            "solution": "设一对双生子中两个个体的易感性分别为$L_1$和$L_2$。根据模型，每个易感性是三个独立组分的和：\n$$L_1 = A_1 + C_1 + E_1$$\n$$L_2 = A_2 + C_2 + E_2$$\n双生子间易感性的相关性$r(L_1, L_2)$定义为$\\frac{\\mathrm{Cov}(L_1, L_2)}{\\sqrt{\\mathrm{Var}(L_1)\\mathrm{Var}(L_2)}}$。由于易感性方差被标准化为1，相关性等于协方差：$r(L_1, L_2) = \\mathrm{Cov}(L_1, L_2)$。\n\n展开协方差项，并利用各组分独立的性质，我们得到：\n$$\\mathrm{Cov}(L_1, L_2) = \\mathrm{Cov}(A_1, A_2) + \\mathrm{Cov}(C_1, C_2) + \\mathrm{Cov}(E_1, E_2)$$\n\n**对于同卵（MZ）双生子：**\n- 他们遗传上相同 ($A_1 = A_2$)，因此$\\mathrm{Cov}(A_1, A_2) = \\mathrm{Var}(A) = V_A$。\n- 他们共享共同环境 ($C_1 = C_2$)，因此$\\mathrm{Cov}(C_1, C_2) = \\mathrm{Var}(C) = V_C$。\n- 他们的独特环境不相关，因此$\\mathrm{Cov}(E_1, E_2) = 0$。\n将这些代入，我们得到MZ双生子的相关性方程：\n$$r_{MZ} = V_A + V_C$$\n\n**对于异卵（DZ）双生子：**\n- 他们平均共享一半的加性基因，因此$\\mathrm{Cov}(A_1, A_2) = \\frac{1}{2}\\mathrm{Var}(A) = \\frac{1}{2}V_A$。\n- 他们共享共同环境，因此$\\mathrm{Cov}(C_1, C_2) = V_C$。\n- 他们的独特环境不相关，因此$\\mathrm{Cov}(E_1, E_2) = 0$。\n将这些代入，我们得到DZ双生子的相关性方程：\n$$r_{DZ} = \\frac{1}{2}V_A + V_C$$\n\n现在我们有了一个由两个方程组成的线性方程组：\n1.  $r_{MZ} = V_A + V_C$\n2.  $r_{DZ} = \\frac{1}{2}V_A + V_C$\n\n为了求解代表狭义遗传力$h^2$的$V_A$，我们将方程1减去方程2：\n$$r_{MZ} - r_{DZ} = (V_A + V_C) - \\left(\\frac{1}{2}V_A + V_C\\right)$$\n$$r_{MZ} - r_{DZ} = \\frac{1}{2}V_A$$\n这就得出了著名的Falconer公式：\n$$V_A = 2(r_{MZ} - r_{DZ})$$\n因为$h^2 = V_A$，所以：\n$$h^2 = 2(r_{MZ} - r_{DZ})$$\n\n代入题目给定的数值$r_{MZ}=0.58$和$r_{DZ}=0.32$：\n$$h^2 = 2(0.58 - 0.32)$$\n$$h^2 = 2(0.26)$$\n$$h^2 = 0.52$$\n根据题目要求，将答案四舍五入到四位有效数字，得到$0.5200$。",
            "answer": "$$\\boxed{0.5200}$$"
        },
        {
            "introduction": "责任阈值模型不仅是描述性的，也具有预测能力。在最后一个练习中，我们将运用数量遗传学的原理来预测群体在面临选择压力时，其疾病风险会如何变化。这个练习将展示该模型在理解复杂性状跨代动态变化中的实用价值。",
            "id": "5052720",
            "problem": "一种复杂疾病在易感性-阈值框架下进行建模，其中，一个不可观测的连续易感性$L$被假定服从标准正态分布，$L \\sim \\mathcal{N}(0,1)$。当$L$超过一个固定的阈值$T$时，疾病就会发生，该阈值由人群患病率$K$通过$P(L > T) = K$确定。假设易感性尺度上的狭义遗传力为$h^{2}$，且易感性尺度上的表型方差被标准化为$1$。\n\n考虑一个群体，其疾病患病率为$K = 0.1$，狭义遗传力为$h^{2} = 0.5$。假设通过对易感性进行截断选择来挑选亲本，具体来说，选择易感性最高的$p = 0.05$比例的个体作为亲本。利用易感性-阈值模型和加性遗传模型的基本原理，计算：\n\n1. 子代在易感性尺度上实现的遗传响应$R$。\n2. 从移动后的均值测量的新有效阈值$T'$，即，在由$R$引起的均值移动下解释$T$的变化。\n\n将你的最终答案表示为行矩阵$\\begin{pmatrix} R  T' \\end{pmatrix}$，并将数值四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题要求在易感性-阈值模型下计算一种复杂疾病的选择响应和新的有效阈值。解决方案源自数量遗传学的基本原理。\n\n### 步骤1：问题验证\n\n问题陈述已经过验证，被认为是有效的。它在科学上基于既定的数量遗传学易感性-阈值模型，问题设定良好，提供了所有必要的参数（$K = 0.1$, $h^2 = 0.5$, $p = 0.05$），并使用了清晰、客观的语言。该问题是数量遗传学理论的一个标准应用，可以使用既定公式解决。\n\n### 步骤2：求解推导\n\n求解过程包括两个主要计算：求选择响应 $R$，然后确定新的有效阈值 $T'$。\n\n#### 第1部分：计算选择响应 ($R$)\n\n选择响应 $R$ 是子代平均易感性的变化，由育种家方程预测：\n$$R = h^2 S$$\n其中 $h^2$ 是狭义遗传力，$S$ 是选择差。\n\n我们已知 $h^2 = 0.5$。必须计算选择差 $S$。$S$ 是被选中的亲本的平均易感性 $\\mu_s$ 与整个亲代群体平均易感性 $\\mu_p$ 之间的差值。\n$$S = \\mu_s - \\mu_p$$\n亲代群体的易感性 $L$ 服从标准正态分布 $L \\sim \\mathcal{N}(0,1)$。因此，亲代群体的平均易感性为 $\\mu_p = 0$。\n\n亲本是通过从易感性分布的上部 $p = 0.05$ 比例中进行截断选择得到的。这个被选群体的平均易感性 $\\mu_s$ 是一个截断标准正态分布的均值。该均值的公式为：\n$$\\mu_s = \\frac{\\phi(z_p)}{p}$$\n其中 $p$ 是选择比例，$z_p$ 是标准正态尺度上的截断点，$\\phi(z)$ 是标准正态概率密度函数（PDF）。\n\n首先，我们找到截断点 $z_p$。它是这样一个值，使得随机个体易感性大于 $z_p$ 的概率为 $p$。\n$$P(L > z_p) = p = 0.05$$\n这等同于找到值 $z_p$ 使得累积分布函数（CDF）$\\Phi(z_p)$ 为 $1 - p$。\n$$\\Phi(z_p) = 1 - 0.05 = 0.95$$\n使用标准正态CDF的反函数，我们得到：\n$$z_p = \\Phi^{-1}(0.95) \\approx 1.64485$$\n\n接下来，我们在 $z_p$ 点计算标准正态PDF $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$ 的值：\n$$\\phi(1.64485) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(1.64485)^2}{2}\\right) \\approx 0.103136$$\n\n现在我们可以计算选择差 $S$：\n$$S = \\mu_s - \\mu_p = \\frac{\\phi(z_p)}{p} - 0 = \\frac{0.103136}{0.05} \\approx 2.06271$$\n\n最后，我们使用育种家方程来求选择响应 $R$：\n$$R = h^2 S = 0.5 \\times 2.06271 \\approx 1.03136$$\n四舍五入到四位有效数字，选择响应为 $R = 1.031$。\n\n#### 第2部分：计算新的有效阈值 ($T'$)\n\n首先，我们必须确定疾病的原始易感性阈值 $T$。群体中的疾病患病率给定为 $K = 0.1$。如果个体的易感性 $L$ 超过阈值 $T$，则会发病。\n$$P(L > T) = K = 0.1$$\n对于标准正态易感性分布，这意味着：\n$$\\Phi(T) = 1 - K = 1 - 0.1 = 0.9$$\n从标准正态CDF的反函数中找到 $T$ 的值：\n$$T = \\Phi^{-1}(0.9) \\approx 1.28155$$\n\n选择响应 $R$ 代表子代易感性分布均值的移动。子代的新易感性分布 $L'$ 以 $R$ 为中心：\n$$L' \\sim \\mathcal{N}(R, 1)$$\n这里我们假设方差保持标准化为 $1$。\n\n疾病阈值 $T$ 是易感性尺度上的一个固定点。问题要求计算“从移动后的均值测量的新有效阈值 $T'$”。这是从新均值 $R$到固定阈值 $T$ 的距离。\n为了找到新一代的患病率，我们需要计算 $P(L' > T)$。我们可以通过考虑变量 $Z = L' - R \\sim \\mathcal{N}(0,1)$ 来将其标准化。\n$$P(L' > T) = P(Z + R > T) = P(Z > T - R)$$\n项 $T - R$ 是子代在标准正态尺度上的新阈值，我们将其表示为 $T'$。\n\n$$T' = T - R$$\n使用先前计算的 $T$ 和 $R$ 的值：\n$$T' \\approx 1.28155 - 1.03136 = 0.25019$$\n四舍五入到四位有效数字，新的有效阈值为 $T' = 0.2502$。\n\n### 最终答案组合\n\n问题要求最终答案为行矩阵 $\\begin{pmatrix} R  T' \\end{pmatrix}$，数值四舍五入到四位有效数字。\n- $R \\approx 1.031$\n- $T' \\approx 0.2502$\n\n得到的矩阵是 $\\begin{pmatrix} 1.031  0.2502 \\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.031  0.2502 \\end{pmatrix}}$$"
        }
    ]
}