{
    "hands_on_practices": [
        {
            "introduction": "定量性状，如身高或血压，受到众多遗传和环境因素的共同影响。为了揭示其遗传基础，我们首先需要将观察到的总变异（表型方差）分解为其不同组分。这项练习  提供了一个实际情景，用于计算狭义遗传力和广义遗传力，这两个基本指标不仅指导着数量性状位点（QTL）定位策略，也为我们在研究中能检测到的遗传效应大小设定了预期。",
            "id": "5076756",
            "problem": "一项人类队列研究调查了一个受遗传和环境因素影响的连续临床性状。在一项基于无亲缘关系个体的方差组分分析中，总表型方差估计为 $V_{P}=100$（单位为性状单位的平方）。加性遗传方差估计为 $V_{A}=40$，显性遗传方差为 $V_{D}=20$，环境方差为 $V_{E}=40$。上位性遗传方差 $V_{I}$ 在此设计中无法直接估计，应保持为符号形式。\n\n使用数量遗传学中复杂性状的标准方差分解以及狭义和广义遗传力的标准定义，计算狭义遗传力 $h^{2}$ 和广义遗传力 $H^{2}$。将 $h^{2}$ 报告为数值，并将 $H^{2}$ 报告为以 $V_{I}$ 表示的闭式表达式。将这两个量表示为小数或代数分数，不带百分号。然后，简要解释这些值对于使用优先考虑加性效应的模型在该人类队列中可检测到的数量性状基因座（QTL；quantitative trait locus）的预期效应大小意味着什么。",
            "solution": "基本出发点是数量遗传学中表型方差的标准分解。对于一个复杂性状，总表型方差 $V_{P}$ 可写作\n$$\nV_{P} = V_{G} + V_{E},\n$$\n其中 $V_{G}$ 是总遗传方差，$V_{E}$ 是环境方差。遗传方差可以进一步分解为以下组分来源：\n$$\nV_{G} = V_{A} + V_{D} + V_{I},\n$$\n其中 $V_{A}$ 是加性遗传方差，$V_{D}$ 是显性遗传方差，$V_{I}$ 是上位性（交互作用）遗传方差。\n\n狭义遗传力 $h^{2}$ 定义为表型方差中可归因于加性效应的比例：\n$$\nh^{2} = \\frac{V_{A}}{V_{P}}.\n$$\n广义遗传力 $H^{2}$ 定义为表型方差中可归因于所有遗传效应的比例：\n$$\nH^{2} = \\frac{V_{G}}{V_{P}} = \\frac{V_{A} + V_{D} + V_{I}}{V_{P}}.\n$$\n\n现在我们使用给定的数值计算 $h^{2}$：\n$$\nh^{2} = \\frac{V_{A}}{V_{P}} = \\frac{40}{100} = 0.4.\n$$\n\n对于 $H^{2}$，我们以符号形式保留 $V_{I}$：\n$$\nH^{2} = \\frac{V_{A} + V_{D} + V_{I}}{V_{P}} = \\frac{40 + 20 + V_{I}}{100} = 0.6 + \\frac{V_{I}}{100}.\n$$\n\n在人类队列中进行数量性状基因座（QTL；quantitative trait locus）定位的解释：\n- $h^{2}=0.4$ 的值表明加性遗传效应占表型方差的 $40\\%$。由于标准的人类队列QTL分析和全基因组关联研究通常拟合加性模型，这表明此类分析可及的遗传信号大部分是加性的，且强度中等。\n- $H^{2}$ 和 $h^{2}$ 之间的差异，即 $H^{2} - h^{2} = 0.2 + \\frac{V_{I}}{100}$，反映了非加性贡献（显性和上位性）。在采用无亲缘关系个体和侧重加性效应模型的设计中，显性（$V_{D}$）和上位性（$V_{I}$）通常更难检测，并且它们贡献的方差通常不会被捕获为单个加性QTL效应。因此，该队列中可检测到的预期QTL效应大小将倾向于更小且数量更多，这对应于加性部分，而非加性效应在没有相应增加可检测的加性QTL信号的情况下，抬高了 $H^{2}$ 的值。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.4 & 0.6 + \\frac{V_{I}}{100}\\end{pmatrix}}$$"
        },
        {
            "introduction": "一旦我们确定一个性状是可遗传的，下一步便是精确定位具体的遗传变异并对其效应进行建模。这项练习  深入探讨了QTL定位的统计学核心，展示了不同的遗传模式（如加性效应和显性效应）如何在线性模型中被转化为特定的数学编码。掌握这些参数化方法是正确检验基因变异如何影响性状这一科学假设的关键。",
            "id": "5076734",
            "problem": "一个具有等位基因 $A$ 和 $a$ 的双等位基因单核苷酸多态性（SNP）有三种基因型 $AA$、$Aa$ 和 $aa$。在数量性状位点（QTL）定位中，对数量性状 $Y$ 的关联检验通常使用线性模型将基因型与预期性状值联系起来。根据第一性原理，将加性效应定义为纯合子均值之差的一半，将显性离差定义为雜合子均值与纯合子均值中点之间的偏差。具体来说，设基因型特异性期望值为 $\\mu_{AA}$、$\\mu_{Aa}$ 和 $\\mu_{aa}$。加性效应 $a$ 定义为 $a = \\left(\\mu_{AA} - \\mu_{aa}\\right)/2$，显性离差 $d$ 定义为 $d = \\mu_{Aa} - \\left(\\mu_{AA} + \\mu_{aa}\\right)/2$。在纯加性（无显性离差）的情况下，杂合子均值等于纯合子均值的中点，此时可以拟合一个带有单个加性预测变量的广义线性模型（GLM）。为了考虑可能的显性离差，我们在模型中增加一个额外的预测变量，其作用是捕捉杂合子与加性中点之间的偏差。\n\n考虑以下三种针对 $Y$ 的建模策略：（i）一个仅包含单个基因型编码预测变量 $G_A$ 的纯加性GLM；（ii）一个包含两个预测变量 $G_A$ 和 $G_D$ 的加性-显性GLM；以及（iii）一个使用两个指示变量并将一种基因型作为基线的完全基因型GLM。哪个选项正确地指定了 $G_A$ 和 $G_D$ 的基因型编码，并阐明了适当的原假设（线性对比），以便在模型（ii）中通过附加的 $G_D$ 项和在模型（iii）中通过基因型系数间的对比来检验显性离差？\n\nA. 在模型（i）中，按等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$, $Aa \\mapsto $ $1$, $AA \\mapsto $ $2$。在模型（ii）中，添加编码为杂合子指示变量的 $G_D$：$aa \\mapsto $ $0$, $Aa \\mapsto $ $1$, $AA \\mapsto $ $0$，并通过在 $Y = \\mu + \\beta_A G_A + \\beta_D G_D + \\varepsilon$ 中检验 $H_0\\!:\\,\\beta_D = 0$ 来检验显性离差。在模型（iii）中，以 $aa$ 为基线，使用两个指示变量 $I_{Aa}$ 和 $I_{AA}$，使得 $Y = \\mu + \\gamma_{Aa} I_{Aa} + \\gamma_{AA} I_{AA} + \\varepsilon$，并通过线性对比 $H_0\\!:\\,2\\gamma_{Aa} - \\gamma_{AA} = 0$ 检验显性离差。\n\nB. 在模型（i）中，编码 $G_A$ 为 $aa \\mapsto $ $-1$, $Aa \\mapsto $ $0$, $AA \\mapsto $ $1$。在模型（ii）中，将 $G_D$ 编码为 $AA$ 的指示变量：$aa \\mapsto $ $0$, $Aa \\mapsto $ $0$, $AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型（iii）中，以 $Aa$ 为基线，使用 $I_{aa}$ 和 $I_{AA}$，使得 $Y = \\mu + \\gamma_{aa} I_{aa} + \\gamma_{AA} I_{AA} + \\varepsilon$，并通过 $H_0\\!:\\,\\gamma_{AA} - \\gamma_{aa} = 0$ 检验显性离差。\n\nC. 在模型（i）中，按等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$, $Aa \\mapsto $ $1$, $AA \\mapsto $ $2$。在模型（ii）中，将 $G_D$ 编码为 $aa \\mapsto $ $-1$, $Aa \\mapsto $ $0$, $AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型（iii）中，以 $aa$ 为基线，使用 $I_{Aa}$ 和 $I_{AA}$，并通过 $H_0\\!:\\,\\gamma_{Aa} = \\gamma_{AA}/2$ 检验显性离差。\n\nD. 在模型（i）中，按等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$, $Aa \\mapsto $ $1$, $AA \\mapsto $ $2$。在模型（ii）中，将 $G_D$ 编码为纯合子指示变量：$aa \\mapsto $ $1$, $Aa \\mapsto $ $0$, $AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型（iii）中，使用单个指示变量 $I_{AA}$，使得 $Y = \\mu + \\gamma_{AA} I_{AA} + \\varepsilon$，无需进一步对比。",
            "solution": "### 推导与选项评估\n\n核心任务是将所提出的线性模型中的统计参数（回归系数）与遗传参数（$a$ 和 $d$）联系起来，并为检验不存在显性（$d=0$）构建正确的原假设。无显性的条件是 $d=0$，根据其定义，这意味着 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$。我们将逐一分析每个选项提出的模型和检验。\n\n#### 选项A的分析\n\n*   **模型（i）- 纯加性GLM**：对于基因型 $(aa, Aa, AA)$，为 $G_A$ 提出的编码是 $(0, 1, 2)$。这是一种等位基因剂量编码（计算 `$A$` 等位基因的数量）。模型是 $E[Y] = \\mu_{model} + \\beta_A G_A$。\n    *   对于基因型 $aa$ ($G_A=0$): $E[Y|aa] = \\mu_{aa} = \\mu_{model}$。\n    *   对于基因型 $Aa$ ($G_A=1$): $E[Y|Aa] = \\mu_{Aa} = \\mu_{model} + \\beta_A$。\n    *   对于基因型 $AA$ ($G_A=2$): $E[Y|AA] = \\mu_{AA} = \\mu_{model} + 2\\beta_A$。\n    该模型对均值施加了线性关系：$\\mu_{Aa} - \\mu_{aa} = \\beta_A$ 和 $\\mu_{AA} - \\mu_{Aa} = \\beta_A$。这意味着 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$，这正是纯加性（$d=0$）的定义。系数 $\\beta_A$ 可以用加性效应 $a$ 来解释：$a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu_{model} + 2\\beta_A) - \\mu_{model})/2 = \\beta_A$。对于加性模型，这种编码是正确的。\n\n*   **模型（ii）- 加性-显性GLM**：模型是 $E[Y] = \\mu + \\beta_A G_A + \\beta_D G_D$，其中 $G_A=(0, 1, 2)$ 和 $G_D=(0, 1, 0)$（杂合子的指示变量）。\n    *   对于基因型 $aa$：$E[Y|aa] = \\mu_{aa} = \\mu + \\beta_A(0) + \\beta_D(0) = \\mu$。\n    *   对于基因型 $Aa$：$E[Y|Aa] = \\mu_{Aa} = \\mu + \\beta_A(1) + \\beta_D(1) = \\mu + \\beta_A + \\beta_D$。\n    *   对于基因型 $AA$：$E[Y|AA] = \\mu_{AA} = \\mu + \\beta_A(2) + \\beta_D(0) = \\mu + 2\\beta_A$。\n    该模型有三个参数（$\\mu$, $\\beta_A$, $\\beta_D$）来拟合三个均值，因此可以完美地表示任何一组基因型均值。让我们将系数与 $a$ 和 $d$ 联系起来：\n    *   $a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu + 2\\beta_A) - \\mu)/2 = 2\\beta_A/2 = \\beta_A$。\n    *   $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2 = (\\mu + \\beta_A + \\beta_D) - ((\\mu + 2\\beta_A) + \\mu)/2 = \\mu + \\beta_A + \\beta_D - (\\mu + \\beta_A) = \\beta_D$。\n    因此，$\\beta_A$ 直接估计加性效应 $a$，而 $\\beta_D$ 直接估计显性离差 $d$。要检验无显性（$d=0$），必须检验原假设 $H_0: \\beta_D = 0$。这是正确的。\n\n*   **模型（iii）- 完全基因型GLM**：该模型使用 $aa$作为基线，带有用于基因型 $Aa$ 的指示变量 $I_{Aa}$ 和用于基因型 $AA$ 的指示变量 $I_{AA}$。模型是 $E[Y] = \\mu + \\gamma_{Aa} I_{Aa} + \\gamma_{AA} I_{AA}$。\n    *   对于基因型 $aa$：$E[Y|aa] = \\mu_{aa} = \\mu$。\n    *   对于基因型 $Aa$：$E[Y|Aa] = \\mu_{Aa} = \\mu + \\gamma_{Aa}$。所以，$\\gamma_{Aa} = \\mu_{Aa} - \\mu_{aa}$。\n    *   对于基因型 $AA$：$E[Y|AA] = \\mu_{AA} = \\mu + \\gamma_{AA}$。所以，$\\gamma_{AA} = \\mu_{AA} - \\mu_{aa}$。\n    要检验无显性（$d=0$），我们使用条件 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$。我们代入模型参数表达式：\n    *   $\\mu + \\gamma_{Aa} = ((\\mu + \\gamma_{AA}) + \\mu)/2$。\n    *   $\\mu + \\gamma_{Aa} = (2\\mu + \\gamma_{AA})/2 = \\mu + \\gamma_{AA}/2$。\n    *   $\\gamma_{Aa} = \\gamma_{AA}/2$。\n    这个条件可以写成用于假设检验的线性对比：$H_0: \\gamma_{Aa} - \\gamma_{AA}/2 = 0$，或者等价地，$H_0: 2\\gamma_{Aa} - \\gamma_{AA} = 0$。这是正确的。\n\n*   **结论**：选项A的所有三个部分都是正确的。其他选项中提出的模型或检验至少有一个部分不正确，因此选项A是唯一完全正确的答案。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使一个QTL真实存在，也并不意味着我们一定能发现它；这取决于研究的统计功效。最后的这项实践  通过让你在一个典型的全基因组关联研究（GWAS）中计算预期关联信号的强度（$t$-统计量）及其显著性（$p$-值），从而在理论与现实之间架起一座桥梁。这有助于建立一种直觉，理解样本量、等位基因频率和效应大小如何共同决定一项遗传研究的成败。",
            "id": "5076742",
            "problem": "一项关于数量医学性状的全基因组关联研究（Genome-Wide Association Study, GWAS）使用加性遗传模型进行。对于一个次要等位基因频率为 $p=0.3$ 的单核苷酸多态性（Single Nucleotide Polymorphism, SNP），基因型 $G \\in \\{0,1,2\\}$ 被编码为次要等位基因的数量，并假定其遵循哈迪-温伯格平衡。性状 $Y$ 由一个简单线性回归模型建模，\n$$\nY = \\mu + \\beta G + \\varepsilon,\n$$\n其中 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2})$，且 $\\sigma^{2}=1$。样本包含 $n=5000$ 个无亲缘关系的个体，真实的加性效应为 $\\beta=0.1$。加性关联检验使用普通最小二乘法得到的常用 $t$ 统计量来评估原假设 $H_{0}:\\beta=0$。\n\n请仅使用基本定义和成熟的结果，推导在备择假设下的期望 $t$ 统计量以及相应的双边 $p$ 值，检验时采用自由度为 $n-2$ 的 $t$ 分布。在推导中，使用哈迪-温伯格平衡下基因型的二项分布方差以及斜率估计量的普通最小二乘方差。评估该关联是否达到标准的 GWAS 全基因组显著性阈值 $\\alpha=5\\times 10^{-8}$。\n\n将您的最终数值结果以 $1\\times 3$ 行矩阵 $\\big[t_{\\mathrm{exp}} \\;\\; p_{\\mathrm{two\\text{-}sided}} \\;\\; I\\big]$ 的形式报告，其中 $t_{\\mathrm{exp}}$ 是期望 $t$ 统计量，$p_{\\mathrm{two\\text{-}sided}}$ 是双边 $p$ 值，如果 $p_{\\mathrm{two\\text{-}sided}} < \\alpha$，则指示符 $I$ 等于 $1$，否则等于 $0$。将 $t_{\\mathrm{exp}}$ 和 $p_{\\mathrm{two\\text{-}sided}}$ 四舍五入至四位有效数字。指示符 $I$ 必须精确报告为 $0$ 或 $1$，无需四舍五入。",
            "solution": "第一步：陈述基本公式和假设\n我们旨在检验简单线性回归模型 $Y = \\mu + \\beta G + \\varepsilon$ 中回归系数 $\\beta$ 的显著性，原假设为 $H_{0}:\\beta=0$。普通最小二乘法（OLS）的检验统计量为：\n$$\nt = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})}\n$$\n其中 $\\hat{\\beta}$ 是 $\\beta$ 的OLS估计量，$SE(\\hat{\\beta})$ 是其标准误。对于大样本，在备择假设下，该统计量的期望值约等于非中心化参数（NCP），即：\n$$\nt_{\\mathrm{exp}} \\approx \\frac{\\beta}{SE(\\hat{\\beta})} = \\frac{\\beta}{\\sqrt{\\text{Var}(\\hat{\\beta})}} \\approx \\frac{\\beta\\sqrt{n \\cdot \\text{Var}(G)}}{\\sigma}\n$$\n这里 $n$ 是样本量，$\\text{Var}(G)$ 是基因型编码的方差，$\\sigma$ 是残差的标准差。\n\n第二步：计算基因型方差 $\\text{Var}(G)$\n基因型 $G$ 被编码为次要等位基因的数量（$0, 1, 2$），其次要等位基因频率为 $p=0.3$。在哈迪-温伯格平衡（HWE）下，基因型 $G$ 的分布服从二项分布 $B(2, p)$。因此，其方差为：\n$$\n\\text{Var}(G) = 2p(1-p) = 2 \\times 0.3 \\times (1 - 0.3) = 2 \\times 0.3 \\times 0.7 = 0.42\n$$\n\n第三步：计算期望的 $t$ 统计量 $t_{\\mathrm{exp}}$\n我们使用给定的参数：样本量 $n=5000$，真实效应大小 $\\beta=0.1$，残差标准差 $\\sigma=\\sqrt{1}=1$。将这些值代入近似公式：\n$$\nt_{\\mathrm{exp}} \\approx \\frac{0.1 \\times \\sqrt{5000 \\times 0.42}}{1} = 0.1 \\times \\sqrt{2100} = 0.1 \\times 10\\sqrt{21} = \\sqrt{21}\n$$\n计算数值并四舍五入至四位有效数字：\n$$\nt_{\\mathrm{exp}} \\approx 4.58257... \\approx 4.583\n$$\n\n第四步：计算相应的双边 $p$ 值\n在原假设 $H_{0}:\\beta=0$ 下，$t$ 统计量服从自由度为 $df = n-2 = 5000-2 = 4998$ 的中心 $t$ 分布。由于自由度非常大，我们可以用标准正态分布 $\\mathcal{N}(0,1)$ 来近似。双边 $p$ 值是：\n$$\np_{\\mathrm{two\\text{-}sided}} = P(|T_{df=4998}| > t_{\\mathrm{exp}}) \\approx P(|Z| > \\sqrt{21})\n$$\n使用统计软件计算此概率，采用更精确的 $t$ 分布：\n$$\np_{\\mathrm{two\\text{-}sided}} = P(|T_{df=4998}| > 4.5826) \\approx 4.686 \\times 10^{-6}\n$$\n将此结果四舍五入至四位有效数字，我们得到 $4.686 \\times 10^{-6}$。\n\n第五步：评估全基因组显著性\n我们将计算出的 $p$ 值与标准的GWAS全基因组显著性阈值 $\\alpha=5\\times 10^{-8}$ 进行比较。\n$$\n4.686 \\times 10^{-6} > 5 \\times 10^{-8}\n$$\n由于 $p$ 值大于阈值 $\\alpha$，该关联未达到全基因组显著性水平。因此，指示符 $I$ 的值为 $0$。\n\n最后，我们将期望的 $t$ 统计量、$p$ 值和显著性指示符组合成所要求的矩阵形式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.583 & 4.686 \\times 10^{-6} & 0 \\end{pmatrix}}\n$$"
        }
    ]
}