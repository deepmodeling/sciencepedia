{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在建立统计推断中的一个基本联系：假设检验和置信区间之间的对偶性。通过计算一个95%置信区间并进行相应的双边t检验，你将凭经验验证这两个过程并非孤立，而是对同一问题的两种不同视角 。这项练习将巩固你对单样本t检验核心机制及解读的理解。",
            "id": "4934484",
            "problem": "一个临床研究团队正在研究标准化干预后血清中C反应蛋白的平均浓度。假设浓度的潜在总体分布是方差未知的近似正态分布。一个大小为 $n=25$ 的简单随机样本得到的样本均值为 $\\bar{X}=9.8$，样本标准差为 $s=2.5$（单位均为 $\\mathrm{mg}/\\mathrm{L}$）。考虑在显著性水平 $\\alpha=0.05$ 下对 $H_{0}: \\mu=\\mu_{0}$ 与 $H_{1}: \\mu\\neq\\mu_{0}$ 进行双边假设检验，其中 $\\mu_{0}=9$（单位为 $\\mathrm{mg}/\\mathrm{L}$）。使用适用于单样本 $t$ 程序的首要原则，计算真实均值 $\\mu$ 的 $95\\%$ $t$ 置信区间，并验证在 $\\alpha=0.05$ 水平下相应的双边单样本 $t$ 检验的决策是否与置信区间中包含或排除 $\\mu_{0}$ 的情况相符。报告区间的两个端点，并将检验决策数值编码为：$1$ 表示“拒绝 $H_{0}$”，$0$ 表示“未能拒绝 $H_{0}$”。将所有报告的数值四舍五入至四位有效数字。以 $\\mathrm{mg}/\\mathrm{L}$ 为单位表示区间端点。",
            "solution": "该问题要求计算总体均值 $\\mu$ 的置信区间，并执行关于 $\\mu$ 的假设检验，然后验证两者之间的一致性。由于总体标准差未知且总体假定为正态分布，因此单样本 $t$-程序是正确的统计方法。\n\n**步骤1：计算95%置信区间**\n$\\mu$ 的 $(1-\\alpha) \\times 100\\%$ 置信区间的公式为：\n$$ \\bar{X} \\pm t_{\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} $$\n根据给定值：\n-   样本均值 $\\bar{X} = 9.8$ mg/L。\n-   样本标准差 $s = 2.5$ mg/L。\n-   样本量 $n = 25$。\n-   显著性水平 $\\alpha = 0.05$。\n\n自由度为 $df = n-1 = 25-1 = 24$。对于双边置信区间，我们需要临界值 $t_{\\alpha/2, df} = t_{0.025, 24}$。查阅 $t$ 分布表或使用统计软件，可得 $t_{0.025, 24} \\approx 2.0639$。\n\n均值的标准误 ($SE_{\\bar{X}}$) 为：\n$$ SE_{\\bar{X}} = \\frac{s}{\\sqrt{n}} = \\frac{2.5}{\\sqrt{25}} = \\frac{2.5}{5} = 0.5 $$\n置信区间的误差范围 ($ME$) 为：\n$$ ME = t_{0.025, 24} \\times SE_{\\bar{X}} \\approx 2.0639 \\times 0.5 = 1.03195 $$\n置信区间为 $\\bar{X} \\pm ME$，即 $9.8 \\pm 1.03195$。\n计算得区间为 $(9.8 - 1.03195, 9.8 + 1.03195)$，即 $(8.76805, 10.83195)$。\n将端点四舍五入至四位有效数字：\n-   下端点：$8.768$\n-   上端点：$10.83$\n\n**步骤2：执行单样本t检验**\n假设为：\n-   $H_{0}: \\mu = 9$\n-   $H_{1}: \\mu \\neq 9$\n\n检验统计量 $t$ 的计算公式为：\n$$ t = \\frac{\\bar{X} - \\mu_{0}}{s/\\sqrt{n}} = \\frac{9.8 - 9}{0.5} = \\frac{0.8}{0.5} = 1.6 $$\n在 $\\alpha=0.05$ 和 $df=24$ 的双边检验中，拒绝域为 $|t| > t_{0.025, 24} \\approx 2.0639$。\n比较检验统计量与临界值：$|t| = |1.6| = 1.6$。\n由于 $1.6  2.0639$，检验统计量未落入拒绝域。因此，我们未能拒绝原假设 $H_{0}$。对应的数值代码是 $0$。\n\n**步骤3：验证对偶性**\n根据假设检验和置信区间的对偶性原理，当且仅当 $\\mu_0$ 的值落在 $\\mu$ 的 $(1-\\alpha) \\times 100\\%$ 置信区间内时，我们才会在 $\\alpha$ 显著性水平上无法拒绝 $H_0: \\mu = \\mu_0$。\n我们计算的 $95\\%$ 置信区间为 $(8.768, 10.83)$。\n原假设中的均值 $\\mu_0 = 9$ 位于此区间内 ($8.768  9  10.83$)。\n这一结果与我们未能拒绝 $H_0$ 的检验决策完全一致。验证成功。\n\n**最终答案**\n-   置信区间下端点：$8.768$ mg/L\n-   置信区间上端点：$10.83$ mg/L\n-   检验决策代码：$0$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 8.768  10.83  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "统计方法依赖于各种假设，但当这些假设未能完美满足时我们该如何应对？这个问题将引导你从计算转向批判性思维，处理一个在实践中常见的情景：正态性检验失败 。你将探索t检验的稳健性这一概念，理解为何一个统计上显著的Shapiro-Wilk检验结果并不必然意味着你的t检验结论无效，并学习如何作为一名生物统计学家做出合理的判断。",
            "id": "4934529",
            "problem": "一项临床试验评估了一种新饮食干预后收缩压（单位：毫米汞柱）的平均变化。对于 $n=20$ 名参与者，观察到的样本平均变化为 $\\bar{x}=-6.2$，样本标准差为 $s=8.5$。主要目标是检验 $H_0:\\mu=0$ 与 $H_a:\\mu  0$，其中 $\\mu$ 是总体平均变化。探索性图表显示数据呈轻微右偏，没有极端异常值。对这些变化应用Shapiro–Wilk正态性检验，得到的 $p$ 值为 $p=0.03$。\n\n你的任务是决定如何对 $\\mu$ 进行推断，并通过明确引用基本原理来证明你的选择，例如均值的抽样分布、单样本 $t$ 检验中分布假设的作用以及正态性检验 $p$ 值的解释。选择唯一的最佳选项。\n\nA. 在预先设定的显著性水平上继续进行关于 $\\mu$ 的单样本 $t$ 检验，同时指出在没有极端异常值的情况下，当 $n=20$ 时，该检验对轻微非正态性具有稳健性，并辅以敏感性分析（例如，Wilcoxon符号秩检验）来确认结论。\n\nB. 放弃 $t$ 检验，改用单样本 $z$ 检验，因为 $p=0.03$ 使 $t$ 检验无效，而 $z$ 检验不需要分布假设。\n\nC. 当正态性检验的 $p  0.05$ 时，不应使用任何参数方法；只使用Wilcoxon符号秩检验，因为拒绝正态性原假设自动使得 $t$ 检验不适用。\n\nD. 将显著性水平提高到 $\\alpha=10$ 以补偿Shapiro–Wilk检验检测到的非正态性，这会使检验更加保守。\n\nE. 对数据进行变换，直到达到精确正态性，然后应用单样本 $t$ 检验；如果无法实现精确正态性，则无法对 $\\mu$ 进行推断。",
            "solution": "此问题要求在正态性假设检验失败（Shapiro-Wilk检验的 $p=0.03$）的情况下，选择最佳的统计推断策略。这是一个关于统计实践中判断与权衡的典型问题。\n\n**核心原理分析**\n1.  **t检验的正态性假设**：严格来说，单样本t检验要求数据来自正态分布的总体。这样可以保证t统计量精确服从t分布。\n2.  **中心极限定理 (CLT) 与稳健性**：t检验的强大之处在于其**稳健性**。由于中心极限定理，即使总体分布不是正态的，只要样本量足够大，样本均值的抽样分布也会趋于正态。因此，t检验对于偏离正态性假设的情况（尤其是Type I错误率）具有一定的抵抗能力。\n3.  **稳健性的条件**：t检验的稳健性依赖于几个因素。对于中等样本量（如本题中的 $n=20$），如果数据分布的偏斜不严重且没有极端异常值，t检验的结果通常被认为是可靠的。本题明确指出数据是“轻微右偏”且“没有极端异常值”，这满足了t检验稳健性的条件。\n4.  **正态性检验的解释**：像Shapiro-Wilk这样的正态性检验，其原假设是“数据来自正态分布”。一个小的p值（如 $p=0.03$）意味着我们有证据拒绝这个原假设。然而，这只告诉我们数据“不完全是”正态的，但并没有告诉我们偏离的程度有多严重，以及这种偏离是否会对t检验的有效性产生实质性影响。在实践中，正态性检验常常过于敏感，会检测到统计上显著但实际影响很小的偏离。\n\n**选项分析**\n\n*   **A. 在预先设定的显著性水平上继续进行关于 $\\mu$ 的单样本 $t$ 检验……**\n    这个选项承认了正态性检验的结果，但基于t检验对轻微非正态性的稳健性（尤其是在没有异常值的情况下），认为继续使用t检验是合理的。此外，它还建议使用非参数的Wilcoxon符号秩检验作为敏感性分析，来验证结论的稳定性。这是一个非常成熟和务实的统计实践策略。如果参数检验和非参数检验得出相同的结论，则会极大地增强研究结果的可信度。这是最佳选项。\n\n*   **B. 放弃 $t$ 检验，改用单样本 $z$ 检验……**\n    这个选项是错误的。首先，单样本z检验要求总体标准差 $\\sigma$ 已知，而本题中我们只有样本标准差 $s=8.5$。其次，z检验并非“不需要分布假设”，它同样依赖于中心极限定理来保证其在大样本下的有效性。\n\n*   **C. 当正态性检验的 $p  0.05$ 时，不应使用任何参数方法……**\n    这个选项过于教条和僵化。如上所述，拒绝正态性原假设不等于t检验完全失效。这种“非黑即白”的决策规则忽略了t检验的稳健性，可能会导致不必要地损失统计功效（t检验通常比非参数检验功效更高）。\n\n*   **D. 将显著性水平提高到 $\\alpha=0.10$……**\n    这个选项是错误的。提高显著性水平 $\\alpha$ 会增加犯第一类错误的概率（即更容易拒绝原假设），这会使检验变得更*不*保守（更激进）。这种做法与补偿非正态性没有任何逻辑关系。\n\n*   **E. 对数据进行变换，直到达到精确正态性……**\n    这个选项是不可取的。首先，“数据变换”会改变所检验的假设（如文章正文所述，从检验算术均值变为检验几何均值或中位数），这可能不符合最初的研究目的。其次，追求“精确正态性”是一种不切实际的“数据操纵”，可能会引入偏见。最后，宣称如果无法实现正态性就无法推断，是完全错误的，因为我们还有稳健方法和非参数方法可用。\n\n**结论**\n选项A代表了在面对轻微违反假设时最合理、最科学的实践方法。它结合了理论知识（稳健性）、务实判断（评估偏离程度）和严谨的验证步骤（敏感性分析）。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "均值和标准差是强大但敏感的度量。本练习通过一个引人注目的动手实践，展示了经典t检验在面对单个极端异常值时的非稳健性 。通过比较原始数据、受异常值污染的数据以及稳健的Winsor化分析得出的结果，你将量化异常值带来的扭曲效应，并体会到稳健统计方法在确保结论可靠性方面的重要价值。",
            "id": "4934504",
            "problem": "一项临床研究监测了一组健康成年人的空腹血糖浓度（mg/dL），以评估其总体均值是否等于一个参考值。假设观测值是来自一个连续总体的独立同分布样本，且原假设为总体均值等于 $100$ mg/dL。考虑以下由 $10$ 名参与者组成的样本：$96$、 $102$、 $105$、 $98$、 $110$、 $94$、 $101$、 $99$、 $107$、 $100$。然后，假设一个因设备未校准而产生的错误极端测量值被无意中包含了进来：$300$ mg/dL，从而得到了一个包含 $11$ 个观测值的增广样本。\n\n从第一性原理出发——即样本均值、无偏样本方差和正态抽样下单样本 $t$ 统计量的定义——执行以下操作：\n\n- 使用包含 $10$ 个观测值的样本，计算无偏样本方差 $S_{\\text{clean}}^{2}$ 和用于检验均值是否等于 $100$ mg/dL 的单样本 $t$ 统计量。\n- 使用包含 $11$ 个观测值的样本（即原始的 $10$ 个观测值加上一个极端离群值 $300$ mg/dL），计算无偏样本方差 $S_{\\text{out}}^{2}$ 和用于检验均值是否等于 $100$ mg/dL 的单样本 $t$ 统计量。\n- 通过比率 $R = S_{\\text{out}}^{2} / S_{\\text{clean}}^{2}$ 来量化离群值导致的变异性膨胀。\n- 为了进行稳健比较，对包含 $11$ 个观测值的样本进行 $20\\%$ 的 Winsorized 分析：将最小的 $g$ 个和最大的 $g$ 个观测值分别替换为第 $(g+1)$ 小和第 $(n-g)$ 大的观测值，其中 $g = \\lfloor 0.2 n \\rfloor$ 且 $n = 11$。使用 Winsorized 样本计算 Winsorized 均值和 Winsorized 无偏样本方差 $S_{\\text{win}}^{2}$。在常规的单样本 $t$ 统计量构造中，用 Winsorized 均值和 $\\sqrt{S_{\\text{win}}^{2}}$ 替换经典均值和标准差，从而构建一个类 $t$ 统计量。在显著性水平 $\\alpha = 0.05$（双侧）下，比较包含离群值的经典分析与 Winsorized 稳健分析的检验决策是否发生改变。\n- 令 $t_{\\text{out}}$ 表示在包含离群值的 $11$ 个观测值样本上计算的经典 $t$ 统计量，令 $t_{\\text{win}}$ 表示在 $11$ 个观测值样本上计算的 Winsorized 类 $t$ 统计量。定义标量\n$$\nQ \\;=\\; R \\;-\\; \\left(|t_{\\text{win}}| \\;-\\; |t_{\\text{out}}|\\right).\n$$\n\n将 $Q$ 的最终数值四舍五入到四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "本练习要求通过计算来量化单个离群值对样本方差和t统计量的影响，并与稳健的Winsorized分析进行比较。原假设均值为 $\\mu_0 = 100$ mg/dL。\n\n**1. 对包含10个观测值（“干净”）样本的分析**\n干净样本 ($n_{\\text{clean}} = 10$): $\\{96, 102, 105, 98, 110, 94, 101, 99, 107, 100\\}$。\n-   **样本均值** ($\\bar{x}_{\\text{clean}}$):\n    $$ \\bar{x}_{\\text{clean}} = \\frac{96+102+105+98+110+94+101+99+107+100}{10} = \\frac{1012}{10} = 101.2 $$\n-   **无偏样本方差** ($S_{\\text{clean}}^{2}$):\n    $$ \\sum (x_i - \\bar{x}_{\\text{clean}})^2 = (96-101.2)^2 + \\dots + (100-101.2)^2 = 221.6 $$\n    $$ S_{\\text{clean}}^{2} = \\frac{221.6}{10-1} = \\frac{221.6}{9} \\approx 24.6222 $$\n-   **单样本 t 统计量** ($t_{\\text{clean}}$):\n    $$ t_{\\text{clean}} = \\frac{\\bar{x}_{\\text{clean}} - \\mu_0}{\\sqrt{S_{\\text{clean}}^{2} / n_{\\text{clean}}}} = \\frac{101.2 - 100}{\\sqrt{24.6222 / 10}} \\approx 0.7647 $$\n\n**2. 对包含11个观测值（含离群值）样本的分析**\n含离群值样本 ($n_{\\text{out}} = 11$): $\\{96, ..., 100, 300\\}$。\n-   **样本均值** ($\\bar{x}_{\\text{out}}$):\n    $$ \\bar{x}_{\\text{out}} = \\frac{1012 + 300}{11} = \\frac{1312}{11} \\approx 119.2727 $$\n-   **无偏样本方差** ($S_{\\text{out}}^{2}$):\n    $$ \\sum (x_i - \\bar{x}_{\\text{out}})^2 \\approx (96-119.27)^2 + \\dots + (100-119.27)^2 + (300-119.27)^2 \\approx 36150.18 $$\n    $$ S_{\\text{out}}^{2} = \\frac{36150.18}{11-1} \\approx 3615.018 $$\n-   **单样本 t 统计量** ($t_{\\text{out}}$):\n    $$ t_{\\text{out}} = \\frac{\\bar{x}_{\\text{out}} - \\mu_0}{\\sqrt{S_{\\text{out}}^{2} / n_{\\text{out}}}} = \\frac{119.2727 - 100}{\\sqrt{3615.018 / 11}} \\approx \\frac{19.2727}{18.1281} \\approx 1.0631 $$\n\n**3. 量化变异性膨胀**\n比率 $R$ 定义为 $R = S_{\\text{out}}^{2} / S_{\\text{clean}}^{2}$：\n$$ R \\approx \\frac{3615.018}{24.6222} \\approx 146.82 $$\n\n**4. 稳健的 Winsorized 分析**\n对于 $n=11$ 的样本，进行 $20\\%$ 的 Winsorized 处理，即 $g = \\lfloor 0.2 \\times 11 \\rfloor = \\lfloor 2.2 \\rfloor = 2$。\n-   **排序后样本**: $\\{94, 96, 98, 99, 100, 101, 102, 105, 107, 110, 300\\}$。\n-   **Winsorized 样本**: 最小的两个值($94, 96$)被替换为第3小的值($98$)；最大的两个值($110, 300$)被替换为第3大的值($107$)。\n    $x_{\\text{win}} = \\{98, 98, 98, 99, 100, 101, 102, 105, 107, 107, 107\\}$\n-   **Winsorized 均值** ($\\bar{x}_{\\text{win}}$):\n    $$ \\bar{x}_{\\text{win}} = \\frac{3 \\times 98 + 99 + 100 + 101 + 102 + 105 + 3 \\times 107}{11} = \\frac{1122}{11} = 102 $$\n-   **Winsorized 无偏样本方差** ($S_{\\text{win}}^{2}$):\n    $$ \\sum (x_{i, \\text{win}} - \\bar{x}_{\\text{win}})^2 = 3(98-102)^2 + (99-102)^2 + \\dots + 3(107-102)^2 = 146 $$\n    $$ S_{\\text{win}}^{2} = \\frac{146}{11-1} = 14.6 $$\n-   **Winsorized 类 t 统计量** ($t_{\\text{win}}$):\n    $$ t_{\\text{win}} = \\frac{\\bar{x}_{\\text{win}} - \\mu_0}{\\sqrt{S_{\\text{win}}^{2} / n}} = \\frac{102 - 100}{\\sqrt{14.6 / 11}} \\approx \\frac{2}{1.1521} \\approx 1.7360 $$\n\n**检验决策比较**:\n-   含离群值检验: $|t_{\\text{out}}| \\approx 1.0631$。自由度 $df=10$，临界值 $t_{0.025, 10} \\approx 2.228$。因为 $|1.0631|  2.228$，不拒绝 $H_0$。\n-   Winsorized 检验: $|t_{\\text{win}}| \\approx 1.7360$。使用修正的自由度 $df_{\\text{win}} = n - 2g - 1 = 11 - 4 - 1 = 6$，临界值 $t_{0.025, 6} \\approx 2.447$。因为 $|1.7360|  2.447$，同样不拒绝 $H_0$。在此例中，检验决策没有改变。\n\n**5. $Q$ 的最终计算**\n$$ Q = R - (|t_{\\text{win}}| - |t_{\\text{out}}|) $$\n使用计算出的值：\n$$ Q \\approx 146.82 - (|1.7360| - |1.0631|) = 146.82 - (1.7360 - 1.0631) = 146.82 - 0.6729 = 146.1471 $$\n四舍五入到四位有效数字，我们得到 $Q = 146.1$。",
            "answer": "$$\\boxed{146.1}$$"
        }
    ]
}