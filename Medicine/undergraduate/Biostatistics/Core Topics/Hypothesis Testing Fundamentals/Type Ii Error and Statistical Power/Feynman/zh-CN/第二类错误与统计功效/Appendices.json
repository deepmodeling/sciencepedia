{
    "hands_on_practices": [
        {
            "introduction": "统计学检验效力最核心的应用之一，便是在研究设计阶段估算所需的样本量。本练习将引导你为一项比较两组均值的临床试验推导样本量计算公式，这是生物统计学中一项至关重要的基本技能。通过这个过程，你将理解第一类错误（$\\alpha$）、第二类错误（$\\beta$）、效应大小（$\\delta$）和变异性（$\\sigma$）这些抽象概念是如何共同决定一项研究需要投入的资源的。",
            "id": "4992656",
            "problem": "计划进行一项双臂随机对照试验（RCT），以等量分配的方式比较一种降压药与安慰剂。主要终点是收缩压的变化，单位为毫米汞柱。研究者将使用双侧假设检验来检验总体均值之差，I型错误率设为 $\\alpha = 0.05$。假设每个臂内的个体患者结果是独立同分布的，近似服从正态分布，且具有一个共同的已知标准差 $\\sigma = 10$ 毫米汞柱。需要检测的具有临床意义的差异是，治疗臂相对于安慰剂臂的真实平均降幅为 $\\delta = 4$ 毫米汞柱。设计目标是统计功效 $1 - \\beta = 0.80$。\n\n从I型错误、II型错误和统计功效的定义，以及在原假设和固定备择假设下样本均值之差的标准化分布出发，推导在等量分配的双侧检验中每臂所需样本量的表达式。然后，在 $\\delta = 4$，$\\sigma = 10$ 和 $\\alpha = 0.05$ 的条件下，计算为达到至少 $0.80$ 的功效，每臂所需的最少整数参与者人数。以单个整数形式给出每臂所需的样本量作为最终答案。",
            "solution": "该问题陈述有效，是一个标准的、适定的生物统计学问题，不存在科学或逻辑缺陷。\n\n设 $\\mu_1$ 和 $\\mu_2$ 分别为安慰剂组和治疗组的收缩压变化的总体均值。样本量相等，即 $n_1 = n_2 = n$。假设结果服从正态分布，且具有一个共同的已知标准差 $\\sigma$。双侧检验的假设为：\n$$ H_0: \\mu_1 - \\mu_2 = 0 $$\n$$ H_a: \\mu_1 - \\mu_2 \\neq 0 $$\n\n检验统计量是样本均值之差的标准化值，$\\bar{X}_1 - \\bar{X}_2$。该差值的抽样分布为 $\\bar{X}_1 - \\bar{X}_2 \\sim N(\\mu_1 - \\mu_2, \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n}) = N(\\mu_1 - \\mu_2, \\frac{2\\sigma^2}{n})$。\n在原假设 $H_0$ 下，检验统计量为：\n$$ Z = \\frac{\\bar{X}_1 - \\bar{X}_2}{\\sqrt{\\frac{2\\sigma^2}{n}}} $$\n其服从标准正态分布，$Z \\sim N(0, 1)$。\n\n当我们拒绝一个为真的 $H_0$ 时，就会发生I型错误。对于显著性水平为 $\\alpha$ 的双侧检验，如果 $|Z| > z_{1-\\alpha/2}$，我们就拒绝 $H_0$，其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $(1-\\alpha/2)$ 分位数。这以观测到的样本差的形式定义了拒绝域为 $|\\bar{X}_1 - \\bar{X}_2| > z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^2}{n}}$。\n\n当我们未能拒绝一个为假的 $H_0$ 时，就会发生II型错误。II型错误的概率为 $\\beta$。统计功效 $1-\\beta$ 是在备择假设 $H_a$ 为真时，正确拒绝 $H_0$ 的概率。我们针对一个特定的备择假设来计算功效，即真实差值为具有临床意义的差值 $\\delta$。因此，我们假设 $\\mu_1 - \\mu_2 = \\delta$。\n\n在此备择假设下，抽样分布为 $\\bar{X}_1 - \\bar{X}_2 \\sim N(\\delta, \\frac{2\\sigma^2}{n})$。功效是在 $\\mu_1 - \\mu_2 = \\delta$ 的条件下，观测到的差值落入拒绝域的概率：\n$$ 1 - \\beta = P\\left(|\\bar{X}_1 - \\bar{X}_2| > z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^2}{n}} \\;\\middle|\\; \\mu_1 - \\mu_2 = \\delta\\right) $$\n假设 $\\delta > 0$，功效主要由拒绝域的上尾部分的检测所决定。功效可以表示为：\n$$ 1 - \\beta = P\\left(\\bar{X}_1 - \\bar{X}_2 > z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^2}{n}}\\right) + P\\left(\\bar{X}_1 - \\bar{X}_2  -z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^2}{n}}\\right) $$\n为了在 $H_a$ 下评估此概率，我们使用均值 $\\delta$ 进行标准化：\n$$ Z' = \\frac{(\\bar{X}_1 - \\bar{X}_2) - \\delta}{\\sqrt{\\frac{2\\sigma^2}{n}}} \\sim N(0, 1) $$\n用 $Z'$ 重写不等式：\n$$ 1 - \\beta = P\\left(Z' > z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}\\right) + P\\left(Z'  -z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}\\right) $$\n对于典型的研究设计，第二项可以忽略不计，因为 $-z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}$ 是一个很大的负数，使其概率极小。因此，我们使用标准近似法继续推导：\n$$ 1 - \\beta \\approx P\\left(Z' > z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}\\right) $$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数。那么 $1-\\beta \\approx 1 - \\Phi\\left(z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}\\right)$，这意味着 $\\beta \\approx \\Phi\\left(z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}}\\right)$。\n根据正态分位数的定义，$z_\\beta = \\Phi^{-1}(\\beta)$。因此：\n$$ z_\\beta = z_{1-\\alpha/2} - \\frac{\\delta}{\\sqrt{2\\sigma^2/n}} $$\n由于标准正态分布关于 $0$ 对称，所以 $z_\\beta = -z_{1-\\beta}$。代入可得：\n$$ -z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{\\delta\\sqrt{n}}{\\sigma\\sqrt{2}} $$\n重新整理以求解样本量 $n$：\n$$ \\frac{\\delta\\sqrt{n}}{\\sigma\\sqrt{2}} = z_{1-\\alpha/2} + z_{1-\\beta} $$\n$$ \\sqrt{n} = \\frac{\\sigma\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{\\delta} $$\n两边平方即可得到每臂所需样本量的表达式：\n$$ n = \\frac{2\\sigma^2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\delta^2} $$\n现在，我们根据给定参数计算所需的最小整数样本量：\nI型错误率 $\\alpha = 0.05$。\n统计功效 $1 - \\beta = 0.80$，所以II型错误率为 $\\beta = 0.20$。\n共同标准差 $\\sigma = 10$ 毫米汞柱。\n具有临床意义的差异 $\\delta = 4$ 毫米汞柱。\n\n首先，我们从标准正态分布中找到所需的分位数：\n对于 $\\alpha = 0.05$ 的双侧检验，我们需要上 $1 - \\alpha/2 = 1 - 0.025 = 0.975$ 分位数：\n$$ z_{1-\\alpha/2} = z_{0.975} \\approx 1.960 $$\n对于 $0.80$ 的功效，我们需要上 $1 - \\beta = 0.80$ 分位数：\n$$ z_{1-\\beta} = z_{0.80} \\approx 0.842 $$\n将这些值代入推导出的 $n$ 的公式中：\n$$ n = \\frac{2(10)^2(1.960 + 0.842)^2}{(4)^2} $$\n$$ n = \\frac{2 \\times 100 \\times (2.802)^2}{16} $$\n$$ n = \\frac{200 \\times 7.851204}{16} $$\n$$ n = 12.5 \\times 7.851204 $$\n$$ n \\approx 98.14005 $$\n由于参与者人数必须是整数，并且功效必须*至少*为 $0.80$，我们必须将计算出的 $n$ 值向上取整到下一个整数。选择 $n=98$ 会导致功效略低于 $0.80$ 的目标。因此，每臂所需的最少整数参与者人数为 $99$。",
            "answer": "$$ \\boxed{99} $$"
        },
        {
            "introduction": "虽然样本量公式非常实用，但检验效力的根本定义是在备择假设为真时，检验统计量落在拒绝域内的概率之和。本练习将带你通过编程实践，为一个单样本比例检验精确计算其检验效力，并将其与经典的“正态近似”方法的结果进行比较。这个过程不仅能加深你对检验效力本质的理解，还能让你洞察在何种条件下近似方法是可靠的，以及它的局限性何在。",
            "id": "4964009",
            "problem": "您需要实现一个程序，该程序使用两种方法推导和计算单样本二项式比例检验的统计功效，并对它们进行比较。考虑一项研究，其中在 $n$ 次独立的伯努利试验中，成功概率为 $p$ 的成功次数 $X$ 服从二项分布。您正在显著性水平为 $\\alpha$ 的条件下检验双边复合假设 $H_{0}: p = p_{0}$ 与 $H_{1}: p \\neq p_{0}$。您的推导和实现必须从以下基础开始：$X$ 的二项模型，作为大样本近似基础的中心极限定理 (CLT)，以及通过半整数调整将离散计数与连续正态近似联系起来的标准连续性校正。\n\n仅从这些基础出发，对每个指定的测试用例执行以下步骤：\n1. 使用带有连续性校正的正态近似，根据成功次数 $X$ 构建一个双边拒绝域。该构建必须源于 $H_{0}$ 下 $X$ 分布的正态近似，以及使用半整数边界将离散 $X$ 的尾部概率替换为相应连续正态尾部概率的连续性校正原则。\n2. 使用此拒绝域，在固定的“真实”备择假设 $p_{1}$ 下计算两个功效值：\n   - 一个近似功效，通过在 $p = p_{1}$ 时，对 $X$ 的备择分布应用带有相同连续性校正的正态近似获得。\n   - 一个精确功效，通过在 $p = p_{1}$ 下枚举 $X$ 的二项概率并在拒绝域上求和获得。\n3. 对于每个测试用例，返回一对实数值 $[\\text{approx\\_power}, \\text{exact\\_power}]$。所有功效值必须表示为小数，而不是百分比。\n\n您必须为以下测试套件实现上述内容（每个测试用例是一个元组 $(n, p_{0}, p_{1}, \\alpha)$）：\n- $(40, 0.5, 0.62, 0.05)$\n- $(20, 0.1, 0.2, 0.05)$\n- $(200, 0.6, 0.55, 0.01)$\n- $(100, 0.02, 0.05, 0.05)$\n- $(10, 0.5, 0.8, 0.05)$\n\n科学和数值要求：\n- 在 $H_{0}$ 和备择假设 $p = p_{1}$ 下，均将 $X$ 视为精确的二项分布。\n- 使用水平为 $\\alpha$ 的双边检验，并在两尾对称分割。\n- 如果使用连续性校正计算的基于正态近似的拒绝域超出了可行计数范围 $[0, n]$，则通过假定该尾部不发生拒绝来进行适当的截断。\n- 不涉及物理单位。所有报告的功效值必须是四舍五入到小数点后六位的小数。\n\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的五个值对列表，按上面列出的顺序排列，并用方括号括起来。例如，输出格式必须与以下完全相同：\n[[a1,b1],[a2,b2],[a3,b3],[a4,b4],[a5,b5]]\n其中每个 $a_{i}$ 和 $b_{i}$ 分别是测试用例 $i$ 的近似功效和精确功效，每个都四舍五入到小数点后六位。",
            "solution": "该问题要求推导和计算一个双边、单样本二项式比例检验的统计功效。我们已知试验次数 $n$、原假设比例 $p_0$、备择假设比例 $p_1$ 和显著性水平 $\\alpha$。功效将通过两种方式计算：首先，使用带有连续性校正的正态近似；其次，使用精确的二项分布。\n\n### 1. 拒绝域的推导\n\n检验假设为 $H_{0}: p = p_{0}$ 对 $H_{1}: p \\neq p_{0}$。检验统计量是成功次数 $X$，它服从二项分布，$X \\sim \\text{Binomial}(n, p)$。\n\n在原假设 $H_0$ 下，$X \\sim \\text{Binomial}(n, p_0)$。$X$ 的均值和方差分别为 $\\mu_0 = E[X|H_0] = n p_0$ 和 $\\sigma_0^2 = \\text{Var}(X|H_0) = n p_0 (1-p_0)$。\n\n中心极限定理 (CLT) 允许我们在 $n$ 足够大时，用正态分布来近似 $X$ 的分布：$X \\dot\\sim N(\\mu_0, \\sigma_0^2)$。将 $X$ 标准化得到一个标准正态变量：\n$$\nZ = \\frac{X - \\mu_0}{\\sigma_0} \\dot\\sim N(0, 1)\n$$\n对于显著性水平为 $\\alpha$ 的双边检验，我们从标准正态分布中找到临界值 $z_{\\alpha/2}$，使得 $P(Z  z_{\\alpha/2}) = \\alpha/2$。由于对称性，$P(Z  -z_{\\alpha/2}) = \\alpha/2$。如果观测到的标准化统计量 $|z_{obs}|  z_{\\alpha/2}$，我们就拒绝 $H_0$。\n\n为了用离散计数 $X$ 来定义拒绝域，我们应用连续性校正。离散值 $k$ 的概率可以通过正态曲线在区间 $[k-0.5, k+0.5]$ 下的面积来近似。\n- 下尾概率 $P(X \\le k_L)$ 可近似为 $P(\\text{Normal} \\le k_L + 0.5)$。\n- 上尾概率 $P(X \\ge k_U)$ 可近似为 $P(\\text{Normal} \\ge k_U - 0.5)$。\n\n我们定义拒绝域的边界 $k_L$ 和 $k_U$，使得尾部的总概率近似为 $\\alpha$。\n\n对于下临界值 $k_L$，我们找到满足以下条件的最大整数：\n$$\nP(X \\le k_L) \\approx P\\left( \\frac{X - \\mu_0}{\\sigma_0} \\le \\frac{k_L + 0.5 - \\mu_0}{\\sigma_0} \\right) \\approx \\frac{\\alpha}{2}\n$$\n这意味着 $\\frac{k_L + 0.5 - \\mu_0}{\\sigma_0} \\approx -z_{\\alpha/2}$。求解 $k_L$：\n$$\nk_L + 0.5 \\approx \\mu_0 - z_{\\alpha/2}\\sigma_0 \\implies k_L \\approx \\mu_0 - 0.5 - z_{\\alpha/2}\\sigma_0\n$$\n由于 $k_L$ 必须是整数计数，我们取其下取整：$k_L = \\lfloor \\mu_0 - 0.5 - z_{\\alpha/2}\\sigma_0 \\rfloor$。\n\n对于上临界值 $k_U$，我们找到满足以下条件的最小整数：\n$$\nP(X \\ge k_U) \\approx P\\left( \\frac{X - \\mu_0}{\\sigma_0} \\ge \\frac{k_U - 0.5 - \\mu_0}{\\sigma_0} \\right) \\approx \\frac{\\alpha}{2}\n$$\n这意味着 $\\frac{k_U - 0.5 - \\mu_0}{\\sigma_0} \\approx z_{\\alpha/2}$。求解 $k_U$：\n$$\nk_U - 0.5 \\approx \\mu_0 + z_{\\alpha/2}\\sigma_0 \\implies k_U \\approx \\mu_0 + 0.5 + z_{\\alpha/2}\\sigma_0\n$$\n由于 $k_U$ 必须是整数计数，我们取其上取整：$k_U = \\lceil \\mu_0 + 0.5 + z_{\\alpha/2}\\sigma_0 \\rceil$。\n\n拒绝域 $\\mathcal{R}$ 是 $X$ 的整数结果集合，使得 $\\mathcal{R} = \\{k \\in \\{0, 1, \\dots, n\\} \\mid k \\le k_L \\text{ 或 } k \\ge k_U\\}$。如果计算出的 $k_L  0$，则下拒绝域为空。如果 $k_U > n$，则上拒绝域为空。\n\n### 2. 统计功效的计算\n\n统计功效是在 $H_0$ 为假时拒绝它的概率。我们假设真实比例为 $p = p_1$ 来计算这个概率。在这个备择假设下，$X \\sim \\text{Binomial}(n, p_1)$，其均值为 $\\mu_1 = n p_1$，方差为 $\\sigma_1^2 = n p_1 (1-p_1)$。\n\n功效由 $P(X \\in \\mathcal{R} \\mid p=p_1) = P(X \\le k_L \\mid p=p_1) + P(X \\ge k_U \\mid p=p_1)$ 给出。\n\n#### 2a. 近似功效\n\n我们对备择假设下 $X$ 的分布使用带有连续性校正的正态近似，其中 $X \\dot\\sim N(\\mu_1, \\sigma_1^2)$。\n\n落入拒绝域下尾的概率是：\n$$\nP(X \\le k_L \\mid p=p_1) \\approx P(\\text{Normal}(\\mu_1, \\sigma_1^2) \\le k_L+0.5) = \\Phi\\left(\\frac{k_L+0.5-\\mu_1}{\\sigma_1}\\right)\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)。如果 $k_L  0$，此项取为 $0$。\n\n落入拒绝域上尾的概率是：\n$$\nP(X \\ge k_U \\mid p=p_1) \\approx P(\\text{Normal}(\\mu_1, \\sigma_1^2) \\ge k_U-0.5) = 1 - \\Phi\\left(\\frac{k_U-0.5-\\mu_1}{\\sigma_1}\\right)\n$$\n如果 $k_U > n$，此项取为 $0$。\n\n近似功效是这两个概率之和。\n\n#### 2b. 精确功效\n\n精确功效通过对真实二项分布 $X \\sim \\text{Binomial}(n, p_1)$ 在拒绝域 $\\mathcal{R}$ 上的概率求和来计算。其概率质量函数 (PMF) 为 $P(X=k \\mid p=p_1) = \\binom{n}{k} p_1^k (1-p_1)^{n-k}$。\n\n精确功效为：\n$$\n\\text{Power}_{\\text{exact}} = \\sum_{k=0}^{\\lfloor k_L \\rfloor} P(X=k \\mid p=p_1) + \\sum_{k=\\lceil k_U \\rceil}^{n} P(X=k \\mid p=p_1)\n$$\n第一个和是对从 $0$ 到 $k_L$（含）的整数求和，前提是 $k_L \\ge 0$。第二个和是对从 $k_U$ 到 $n$（含）的整数求和，前提是 $k_U \\le n$。\n\n### 3. 算法总结\n\n对于每个测试用例 $(n, p_0, p_1, \\alpha)$：\n1.  在 $H_0$ 下计算一组初始参数：$\\mu_0 = n p_0$ 和 $\\sigma_0 = \\sqrt{n p_0 (1-p_0)}$。\n2.  找到与总尾部概率 $\\alpha$ 对应的标准正态临界值 $z_{\\alpha/2}$。\n3.  使用上面推导的带连续性校正的正态近似公式，确定拒绝域 $\\mathcal{R}$ 的整数临界值 $k_L$ 和 $k_U$。\n4.  在备择假设 $H_1$ 下计算参数：$\\mu_1 = n p_1$ 和 $\\sigma_1 = \\sqrt{n p_1 (1-p_1)}$。\n5.  使用 $\\mu_1$ 和 $\\sigma_1$，通过对基于正态 CDF 的 $P(X \\le k_L)$ 和 $P(X \\ge k_U)$ 的近似值求和，来计算近似功效。\n6.  通过对拒绝域 $\\mathcal{R}$ 内的 $X \\sim \\text{Binomial}(n, p_1)$ 的二项 PMF 值求和，来计算精确功效。\n7.  存储数值对 $[\\text{approx\\_power}, \\text{exact\\_power}]$，并四舍五入到小数点后六位。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm, binom\n\ndef solve():\n    \"\"\"\n    Computes and compares approximate (normal approximation with continuity correction)\n    and exact (binomial) statistical power for a one-sample binomial test.\n    \"\"\"\n\n    test_cases = [\n        # (n, p0, p1, alpha)\n        (40, 0.5, 0.62, 0.05),\n        (20, 0.1, 0.2, 0.05),\n        (200, 0.6, 0.55, 0.01),\n        (100, 0.02, 0.05, 0.05),\n        (10, 0.5, 0.8, 0.05),\n    ]\n\n    results = []\n    for n, p0, p1, alpha in test_cases:\n        # Step 1: Construct the rejection region based on the normal approximation under H0.\n        \n        # Mean and std dev under H0\n        mu0 = n * p0\n        sigma0 = np.sqrt(n * p0 * (1 - p0))\n\n        # Critical z-value for a two-sided test\n        z_alpha_half = norm.ppf(1 - alpha / 2)\n\n        # Calculate critical values for X (number of successes) with continuity correction.\n        # sigma0 cannot be 0 unless p0 is 0 or 1, which are trivial cases not in the test suite.\n        k_L_float = mu0 - 0.5 - z_alpha_half * sigma0\n        k_U_float = mu0 + 0.5 + z_alpha_half * sigma0\n\n        k_L = int(np.floor(k_L_float))\n        k_U = int(np.ceil(k_U_float))\n\n        # The rejection region is X = k_L or X >= k_U.\n\n        # Step 2: Compute approximate and exact power at the alternative p1.\n        \n        # Mean and std dev under H1\n        mu1 = n * p1\n        sigma1 = np.sqrt(n * p1 * (1 - p1))\n\n        # --- Approximate Power Calculation ---\n        # Using normal approximation with continuity correction under H1.\n        \n        lower_power_approx = 0.0\n        # Only calculate if the lower region is non-empty and sigma1 is positive.\n        if k_L >= 0 and sigma1 > 0:\n            lower_power_approx = norm.cdf((k_L + 0.5 - mu1) / sigma1)\n\n        upper_power_approx = 0.0\n        # Only calculate if the upper region is non-empty and sigma1 is positive.\n        if k_U = n and sigma1 > 0:\n            upper_power_approx = 1.0 - norm.cdf((k_U - 0.5 - mu1) / sigma1)\n        \n        approx_power = lower_power_approx + upper_power_approx\n        \n        # Handle cases where sigma1 is 0 (p1=0 or p1=1)\n        if sigma1 == 0:\n            if mu1 = k_L: # if all mass is in lower tail\n                approx_power = 1.0\n            elif mu1 >= k_U: # if all mass is in upper tail\n                approx_power = 1.0\n            else: # all mass is between k_L and k_U\n                approx_power = 0.0\n\n        # --- Exact Power Calculation ---\n        # Summing binomial probabilities under H1.\n        \n        binom_dist_h1 = binom(n, p1)\n        \n        lower_power_exact = 0.0\n        # The CDF P(X=k) sums probabilities from 0 to k.\n        if k_L >= 0:\n            lower_power_exact = binom_dist_h1.cdf(k_L)\n            \n        upper_power_exact = 0.0\n        # The SF P(X>k) is 1 - CDF(k). We want P(X>=k_U), which is P(X > k_U-1).\n        if k_U = n:\n            upper_power_exact = binom_dist_h1.sf(k_U - 1)\n\n        exact_power = lower_power_exact + upper_power_exact\n\n        # Store rounded results.\n        results.append([round(approx_power, 6), round(exact_power, 6)])\n\n    # Format the final output string exactly as specified.\n    pair_strings = [f\"[{p[0]},{p[1]}]\" for p in results]\n    final_output = f\"[{','.join(pair_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "任何检验效力或样本量的计算都建立在一系列参数假设之上，例如群体标准差（$\\sigma$）。但如果我们的初步估计存在偏差，将会带来什么后果？这个进阶练习将使用微积分工具来探索样本量对$\\sigma$估计误差的敏感性。通过推导，你将发现一个简洁而深刻的“弹性”关系，这对于在实际研究设计中进行稳健的敏感性分析，以及理解为何精确估计变异性至关重要，具有极高的指导价值。",
            "id": "4963993",
            "problem": "一位生物统计学家正在设计一项单样本研究，旨在使用形式为 $H_{0}:\\ \\mu=\\mu_{0}$ 对 $H_{1}:\\ \\mu\\neq\\mu_{0}$ 的双边假设检验，在显著性水平 $\\alpha$ 下检测具有临床意义的均值漂移。该连续终点被建模为独立同分布的正态分布，其真实均值为 $\\mu$，真实标准差为 $\\sigma$。检验统计量为 $T=(\\bar{X}-\\mu_{0})/(\\sigma/\\sqrt{n})$，拒绝域为 $|T|z_{1-\\alpha/2}$，其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。令 $\\Delta=\\mu-\\mu_{0}$ 表示一个固定的、非零的、具有临床意义的效应量，并将功效函数 $\\pi(\\mu)$ 定义为在真实均值为 $\\mu$ 的情况下拒绝 $H_{0}$ 的概率。\n\n请仅使用正态模型以及I类错误、II类错误和统计功效的定义，完成以下任务：\n\n- 推导功效函数关于标准差的偏导数 $\\frac{\\partial \\pi(\\mu)}{\\partial \\sigma}$，将 $\\mu$、$n$ 和 $\\alpha$ 视为固定值。\n- 然后，在保持目标功效固定的情况下，使用全微分法推导为保持功效恒定所需的 $d n$ 和 $d \\sigma$ 之间的无穷小关系，并由此定义所需样本量关于标准差的局部弹性 $E=\\frac{d n / n}{d \\sigma / \\sigma}$。\n\n请将 $E$ 的值作为最终答案报告。无需四舍五入。",
            "solution": "该问题将通过首先提取给定信息，然后评估其科学依据、良定性和客观性来进行验证。\n\n### 步骤1：提取已知信息\n- **假设检验**：单均值的双边检验，$H_{0}:\\ \\mu=\\mu_{0}$ 对 $H_{1}:\\ \\mu\\neq\\mu_{0}$。\n- **显著性水平**：$\\alpha$。\n- **数据模型**：来自真实均值为 $\\mu$、真实标准差为 $\\sigma$ 的正态分布的独立同分布（i.i.d.）观测值。\n- **检验统计量**：$T=(\\bar{X}-\\mu_{0})/(\\sigma/\\sqrt{n})$，其中 $\\bar{X}$ 是样本均值，$n$ 是样本量。\n- **拒绝域**：$|T|z_{1-\\alpha/2}$，其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。\n- **效应量**：$\\Delta=\\mu-\\mu_{0}$，一个固定的、非零的、具有临床意义的效应。\n- **功效函数**：$\\pi(\\mu)$ 是当真实均值为 $\\mu$ 时拒绝 $H_{0}$ 的概率。\n- **任务**：\n    1. 推导功效函数关于标准差的偏导数 $\\frac{\\partial \\pi(\\mu)}{\\partial \\sigma}$，保持 $\\mu$、$n$ 和 $\\alpha$ 固定。\n    2. 在保持功效固定的情况下，使用全微分推导 $d n$ 和 $d \\sigma$ 之间的无穷小关系。\n    3. 根据此关系，定义并计算局部弹性 $E=\\frac{d n / n}{d \\sigma / \\sigma}$。\n\n### 步骤2：使用提取的已知信息进行验证\n问题评估如下：\n- **科学依据**：该问题基于频率学派统计推断的基本原理，特别是Z检验的假设检验和功效分析。所有定义和概念，如正态模型、显著性水平、功效和检验统计量，在生物统计学中都是标准的。该问题具有科学合理性。\n- **良定性**：问题规定明确。任务涉及将标准的数学推导（偏微分、全微分）应用于一个定义明确的统计函数。预期会有一个唯一且有意义的解。\n- **客观性**：问题使用精确、形式化的数学和统计语言陈述，没有任何主观性或歧义。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供完整的解答。\n\n***\n\n检验的功效 $\\pi(\\mu)$ 是在真实均值为 $\\mu$ 的条件下拒绝原假设 $H_0$ 的概率。当检验统计量 $T$ 落入拒绝域，即 $|T|  z_{1-\\alpha/2}$ 时，发生拒绝。\n\n首先，我们必须确定在备择假设下（真实均值为 $\\mu$）检验统计量 $T = (\\bar{X}-\\mu_0)/(\\sigma/\\sqrt{n})$ 的分布。样本均值 $\\bar{X}$ 服从正态分布 $\\bar{X} \\sim N(\\mu, \\sigma^2/n)$。为了找到 $T$ 的分布，我们用其真实均值 $\\mu$ 对 $\\bar{X}$ 进行标准化，并在 $T$ 的分子中加上和减去 $\\mu$：\n$$T = \\frac{\\bar{X}-\\mu_0}{\\sigma/\\sqrt{n}} = \\frac{(\\bar{X}-\\mu) + (\\mu-\\mu_0)}{\\sigma/\\sqrt{n}} = \\frac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}} + \\frac{\\mu-\\mu_0}{\\sigma/\\sqrt{n}}$$\n项 $\\frac{\\bar{X}-\\mu}{\\sigma/\\sqrt{n}}$ 是一个标准正态变量，$Z \\sim N(0,1)$。项 $\\frac{\\mu-\\mu_0}{\\sigma/\\sqrt{n}}$ 是一个常数，等于 $\\frac{\\Delta\\sqrt{n}}{\\sigma}$。\n因此，在备择假设下，$T \\sim N(\\frac{\\Delta\\sqrt{n}}{\\sigma}, 1)$。\n\n功效函数 $\\pi(\\mu)$ 是概率 $P(|T|  z_{1-\\alpha/2})$。由于 $T$ 不是一个标准正态变量，我们必须使用其推导出的分布来计算这个概率。令 $\\Phi(\\cdot)$ 表示标准正态分布的累积分布函数（CDF）。\n$$\\pi(\\mu) = P(T > z_{1-\\alpha/2}) + P(T  -z_{1-\\alpha/2})$$\n设 $T$ 的均值为 $\\delta_T = \\frac{\\Delta\\sqrt{n}}{\\sigma}$。那么 $T = Z + \\delta_T$，其中 $Z \\sim N(0,1)$。\n$$P(T > z_{1-\\alpha/2}) = P(Z + \\delta_T > z_{1-\\alpha/2}) = P(Z > z_{1-\\alpha/2} - \\delta_T) = 1 - \\Phi(z_{1-\\alpha/2} - \\delta_T) = \\Phi(\\delta_T - z_{1-\\alpha/2})$$\n$$P(T  -z_{1-\\alpha/2}) = P(Z + \\delta_T  -z_{1-\\alpha/2}) = P(Z  -z_{1-\\alpha/2} - \\delta_T) = \\Phi(-z_{1-\\alpha/2} - \\delta_T)$$\n代入 $\\delta_T = \\frac{\\Delta\\sqrt{n}}{\\sigma}$，功效函数（视为 $n$ 和 $\\sigma$ 的函数）为：\n$$\\pi(n, \\sigma) = \\Phi\\left(\\frac{\\Delta\\sqrt{n}}{\\sigma} - z_{1-\\alpha/2}\\right) + \\Phi\\left(-\\frac{\\Delta\\sqrt{n}}{\\sigma} - z_{1-\\alpha/2}\\right)$$\n\n第一个任务是求偏导数 $\\frac{\\partial \\pi}{\\partial \\sigma}$。令 $\\phi(\\cdot)$ 为标准正态分布的概率密度函数（PDF），因此 $\\frac{d\\Phi(x)}{dx} = \\phi(x)$。令 $A(n, \\sigma) = \\frac{\\Delta\\sqrt{n}}{\\sigma}$。使用链式法则：\n$$\\frac{\\partial \\pi}{\\partial \\sigma} = \\phi\\left(A - z_{1-\\alpha/2}\\right) \\frac{\\partial A}{\\partial \\sigma} + \\phi\\left(-A - z_{1-\\alpha/2}\\right) \\frac{\\partial (-A)}{\\partial \\sigma}$$\n$A$ 关于 $\\sigma$ 的导数是 $\\frac{\\partial A}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma}(\\Delta\\sqrt{n}\\sigma^{-1}) = -\\Delta\\sqrt{n}\\sigma^{-2} = -\\frac{A}{\\sigma}$。\n因此，$\\frac{\\partial (-A)}{\\partial \\sigma} = \\frac{A}{\\sigma}$。\n将这些代入 $\\frac{\\partial \\pi}{\\partial \\sigma}$ 的表达式中：\n$$\\frac{\\partial \\pi}{\\partial \\sigma} = \\phi\\left(A - z_{1-\\alpha/2}\\right) \\left(-\\frac{A}{\\sigma}\\right) + \\phi\\left(-A - z_{1-\\alpha/2}\\right) \\left(\\frac{A}{\\sigma}\\right)$$\n$$\\frac{\\partial \\pi}{\\partial \\sigma} = \\frac{A}{\\sigma} \\left[ \\phi\\left(-A - z_{1-\\alpha/2}\\right) - \\phi\\left(A - z_{1-\\alpha/2}\\right) \\right]$$\n利用性质 $\\phi(-x) = \\phi(x)$，我们可以写出 $\\phi(-A - z_{1-\\alpha/2}) = \\phi(A + z_{1-\\alpha/2})$。\n$$\\frac{\\partial \\pi}{\\partial \\sigma} = \\frac{A}{\\sigma} \\left[ \\phi\\left(A + z_{1-\\alpha/2}\\right) - \\phi\\left(A - z_{1-\\alpha/2}\\right) \\right]$$\n这就完成了第一部分的推导。\n\n接下来，我们保持功效 $\\pi$ 恒定，这意味着其全微分 $d\\pi$ 必须为零。$\\pi(n, \\sigma)$ 的全微分是：\n$$d\\pi = \\frac{\\partial \\pi}{\\partial n} dn + \\frac{\\partial \\pi}{\\partial \\sigma} d\\sigma = 0$$\n这给出了关系 $\\frac{\\partial \\pi}{\\partial n} dn = - \\frac{\\partial \\pi}{\\partial \\sigma} d\\sigma$，由此我们可以求得 $\\frac{dn}{d\\sigma} = -\\frac{\\partial \\pi / \\partial \\sigma}{\\partial \\pi / \\partial n}$。\n\n我们需要计算 $\\frac{\\partial \\pi}{\\partial n}$：\n$$\\frac{\\partial \\pi}{\\partial n} = \\phi\\left(A - z_{1-\\alpha/2}\\right) \\frac{\\partial A}{\\partial n} + \\phi\\left(-A - z_{1-\\alpha/2}\\right) \\frac{\\partial (-A)}{\\partial n}$$\n$A$ 关于 $n$ 的导数是 $\\frac{\\partial A}{\\partial n} = \\frac{\\partial}{\\partial n}(\\frac{\\Delta}{\\sigma}n^{1/2}) = \\frac{\\Delta}{\\sigma}\\frac{1}{2}n^{-1/2} = \\frac{\\Delta\\sqrt{n}}{2n\\sigma} = \\frac{A}{2n}$。\n因此，$\\frac{\\partial (-A)}{\\partial n} = -\\frac{A}{2n}$。\n将这些代入 $\\frac{\\partial \\pi}{\\partial n}$ 的表达式中：\n$$\\frac{\\partial \\pi}{\\partial n} = \\phi\\left(A - z_{1-\\alpha/2}\\right) \\left(\\frac{A}{2n}\\right) + \\phi\\left(-A - z_{1-\\alpha/2}\\right) \\left(-\\frac{A}{2n}\\right)$$\n$$\\frac{\\partial \\pi}{\\partial n} = \\frac{A}{2n} \\left[ \\phi\\left(A - z_{1-\\alpha/2}\\right) - \\phi\\left(-A - z_{1-\\alpha/2}\\right) \\right]$$\n再次使用 $\\phi(-x) = \\phi(x)$：\n$$\\frac{\\partial \\pi}{\\partial n} = \\frac{A}{2n} \\left[ \\phi\\left(A - z_{1-\\alpha/2}\\right) - \\phi\\left(A + z_{1-\\alpha/2}\\right) \\right]$$\n现在我们构造 $\\frac{dn}{d\\sigma}$ 的比率：\n$$\\frac{dn}{d\\sigma} = -\\frac{\\frac{A}{\\sigma} \\left[ \\phi\\left(A + z_{1-\\alpha/2}\\right) - \\phi\\left(A - z_{1-\\alpha/2}\\right) \\right]}{\\frac{A}{2n} \\left[ \\phi\\left(A - z_{1-\\alpha/2}\\right) - \\phi\\left(A + z_{1-\\alpha/2}\\right) \\right]}$$\n分子括号中的项是分母括号中项的负数。只要括号中的项不为零，这个等式就成立，这要求 $A \\neq 0$ 和 $z_{1-\\alpha/2} \\neq 0$，这些条件是满足的。同时，因为 $A \\neq 0$，$A$ 可以被消去。\n$$\\frac{dn}{d\\sigma} = -\\frac{\\frac{1}{\\sigma}}{\\frac{1}{2n}} \\cdot \\frac{\\phi\\left(A + z_{1-\\alpha/2}\\right) - \\phi\\left(A - z_{1-\\alpha/2}\\right)}{-\\left( \\phi\\left(A + z_{1-\\alpha/2}\\right) - \\phi\\left(A - z_{1-\\alpha/2}\\right) \\right)} = \\frac{1/\\sigma}{1/(2n)} = \\frac{2n}{\\sigma}$$\n因此，无穷小关系是 $dn = \\frac{2n}{\\sigma} d\\sigma$。\n\n最后，我们计算局部弹性 $E$，定义为 $E = \\frac{dn/n}{d\\sigma/\\sigma}$。\n我们可以将推导出的关系重新整理为 $\\frac{dn}{n} = 2 \\frac{d\\sigma}{\\sigma}$。\n因此，弹性为：\n$$E = \\frac{2 \\frac{d\\sigma}{\\sigma}}{\\frac{d\\sigma}{\\sigma}} = 2$$\n或者，使用定义 $E = \\frac{dn}{d\\sigma} \\frac{\\sigma}{n}$：\n$$E = \\left(\\frac{2n}{\\sigma}\\right) \\frac{\\sigma}{n} = 2$$\n所需样本量关于标准差的弹性是2。这意味着，标准差的一个小百分比增长，需要样本量增加两倍的百分比，才能保持相同的统计功效。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}