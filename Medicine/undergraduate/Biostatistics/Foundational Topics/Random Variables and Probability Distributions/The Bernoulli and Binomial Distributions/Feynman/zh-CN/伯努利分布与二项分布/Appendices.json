{
    "hands_on_practices": [
        {
            "introduction": "似然函数是现代统计推断的基石。本练习将指导你推导二项分布结果的似然函数，找出最直观的估计量（最大似然估计量 $\\hat{p}$），然后利用该框架构建一个强大的假设检验（似然比检验）。这项练习旨在巩固生物统计学中许多方法所依赖的理论基础。",
            "id": "4957552",
            "problem": "一个临床实验室正在验证一种新的二元检测方法。当应用于从目标人群中随机选择的样本时，该检测以未知的概率 $p$ 返回阳性结果。假设 $X_{1}, X_{2}, \\ldots, X_{n}$ 是成功概率为 $p$ 的独立同分布（i.i.d.）的伯努利随机变量，其中 $X_{i}=1$ 表示检测结果为阳性，$X_{i}=0$ 表示检测结果为阴性。令 $K=\\sum_{i=1}^{n} X_{i}$ 为观测到的阳性结果总数。\n\n仅使用伯努利概率质量函数、独立性的基本定义，以及似然函数作为给定观测数据下参数的函数的联合概率这一定义，完成以下任务：\n\n1) 基于观测数据推导 $p$ 的似然函数，并将其简化为充分统计量 $K$ 的函数。将此解释为该模型中 $p$ 的剖面似然。\n\n2) 通过在 $p \\in [0,1]$ 上最大化似然函数来确定最大似然估计量 $\\hat{p}$，并特别注意 $K=0$ 和 $K=n$ 的边界情况。\n\n3) 构建似然比检验（LRT）统计量 $W=-2\\ln \\lambda$，用于检验简单原假设 $H_{0}: p=p_{0}$ 与双边备择假设 $H_{1}: p \\neq p_{0}$。对于内部情况 $0  p_0  1$，将该统计量表示为 $n$、$\\hat{p}$ 和 $p_0$ 的函数。然后，计算当 $n=100$, $k=25$ 时，检验原假设 $H_0: p=0.2$ 的 $W$ 值。",
            "solution": "1.  **推导似然函数 $L(p)$**\n    由于观测值 $X_i$ 是独立同分布的，整个数据集的联合概率（即似然函数）是每个观测值概率的乘积：\n    $L(p | x_1, \\dots, x_n) = \\prod_{i=1}^{n} P(X_i = x_i | p)$\n    对于伯努利试验，$P(X_i=x_i|p) = p^{x_i}(1-p)^{1-x_i}$。因此：\n    $L(p) = \\prod_{i=1}^{n} p^{x_i}(1-p)^{1-x_i} = p^{\\sum_{i=1}^{n} x_i} (1-p)^{\\sum_{i=1}^{n} (1-x_i)} = p^K (1-p)^{n-K}$\n    似然函数仅通过成功总数 $K$ 依赖于数据，因此 $K$ 是 $p$ 的充分统计量。\n\n2.  **确定最大似然估计量 (MLE) $\\hat{p}$**\n    为了找到最大化 $L(p)$ 的 $p$ 值，我们通常最大化其对数似然函数 $\\ell(p) = \\ln L(p)$，因为对数函数是单调递增的：\n    $\\ell(p) = K \\ln(p) + (n-K) \\ln(1-p)$\n    我们对 $p$ 求导并令其等于零来找到极值点：\n    $\\frac{d\\ell}{dp} = \\frac{K}{p} - \\frac{n-K}{1-p} = 0$\n    $\\frac{K(1-p) - p(n-K)}{p(1-p)} = 0 \\implies K - Kp - np + Kp = 0 \\implies K = np$\n    因此，最大似然估计量是 $\\hat{p} = \\frac{K}{n}$。\n    对于边界情况：\n    -   如果 $K=0$（所有检测结果均为阴性），则 $\\hat{p}=0$。\n    -   如果 $K=n$（所有检测结果均为阳性），则 $\\hat{p}=1$。\n\n3.  **构建似然比检验 (LRT) 统计量**\n    似然比 $\\lambda$ 定义为原假设下似然函数的最大值与备择假设下似然函数的最大值之比。\n    -   在 $H_1$ 下，似然函数在 MLE $\\hat{p}=K/n$ 处达到最大值：$L(\\hat{p}) = \\hat{p}^K (1-\\hat{p})^{n-K}$。\n    -   在 $H_0$ 下，参数固定为 $p_0$：$L(p_0) = p_0^K (1-p_0)^{n-K}$。\n    似然比为 $\\lambda = \\frac{L(p_0)}{L(\\hat{p})} = \\frac{p_0^K (1-p_0)^{n-K}}{\\hat{p}^K (1-\\hat{p})^{n-K}} = \\left(\\frac{p_0}{\\hat{p}}\\right)^K \\left(\\frac{1-p_0}{1-\\hat{p}}\\right)^{n-K}$。\n    LRT 统计量 $W$ 为：\n    $W = -2\\ln(\\lambda) = -2 \\left[ K\\ln\\left(\\frac{p_0}{\\hat{p}}\\right) + (n-K)\\ln\\left(\\frac{1-p_0}{1-\\hat{p}}\\right) \\right]$\n    这可以重写为：\n    $W = 2 \\left[ K\\ln\\left(\\frac{\\hat{p}}{p_0}\\right) + (n-K)\\ln\\left(\\frac{1-\\hat{p}}{1-p_0}\\right) \\right]$。\n\n    **计算**：\n    给定 $n=100, k=25, p_0=0.2$。\n    首先，计算 MLE：$\\hat{p} = k/n = 25/100 = 0.25$。\n    然后，将这些值代入 $W$ 的公式：\n    $W = 2 \\left[ 25 \\ln\\left(\\frac{0.25}{0.2}\\right) + (100-25) \\ln\\left(\\frac{1-0.25}{1-0.2}\\right) \\right]$\n    $W = 2 \\left[ 25 \\ln(1.25) + 75 \\ln\\left(\\frac{0.75}{0.80}\\right) \\right]$\n    $W = 2 \\left[ 25 \\ln(1.25) + 75 \\ln(0.9375) \\right]$\n    使用自然对数值 $\\ln(1.25) \\approx 0.22314$ 和 $\\ln(0.9375) \\approx -0.06454$：\n    $W \\approx 2 [ (25 \\times 0.22314) + (75 \\times -0.06454) ]$\n    $W \\approx 2 [ 5.5785 - 4.8405 ] = 2 [ 0.738 ] = 1.476$。",
            "answer": "$$ \\boxed{1.476} $$"
        },
        {
            "introduction": "本练习将估计的理论概念与规划研究的实际挑战联系起来。它展示了如何确定所需的样本量 $n$，以便在预期的置信度 $1-\\alpha$ 和精确度 $\\epsilon$ 下估计一个群体的患病率 $p$。掌握这项技能对于设计高效且符合伦理的临床试验和流行病学研究至关重要。",
            "id": "4957558",
            "problem": "在一项横断面生物统计学研究中，您将使用独立同分布的伯努利观测值来估计二元生物标志物的患病率 $p$。您计划在中心极限定理（CLT）证明的正态近似下，为 $p$ 报告一个名义置信水平为 $1-\\alpha$ 的双侧置信区间。从伯努利随机变量和二项样本比例的定义出发，并利用大样本 $n$ 时标准化样本比例近似于标准正态分布这一事实，推导所需样本量 $n$ 的设计表达式，以确保绝对误差范围在置信度为 $1-\\alpha$ 的情况下不超过预设的容差 $\\epsilon$。然后，确定能产生保守（最坏情况）设计的 $p$ 值，并用它来计算确保对于任何真实 $p \\in [0,1]$，误差范围最多为 $\\epsilon$ 的最小整数 $n$。\n\n假设 $\\alpha = 0.05$ 和 $\\epsilon = 0.04$，并将置信水平 $1-\\alpha$ 对应的标准正态上分位数 $z_{1-\\alpha/2}$ 取为实践中常用的值。报告满足要求的最小整数 $n$。不包括单位。无需按有效数字进行四舍五入；报告满足设计标准的精确最小整数。",
            "solution": "用户提供了一个有效的问题陈述。该问题在科学上基于标准统计理论，问题阐述清晰，并使用了客观和精确的语言。所有必要信息均已提供。\n\n该问题要求推导用于估计总体比例 $p$ 的样本量公式，并将其应用于特定情况。我们首先定义统计框架。\n\n设 $X_1, X_2, \\dots, X_n$ 为一组来自参数为 $p$ 的伯努利分布的 $n$ 个独立同分布（i.i.d.）随机变量，记作 $X_i \\sim \\text{Bernoulli}(p)$。参数 $p$ 代表群体中生物标志物的真实患病率。对于每次观测 $i$，$X_i=1$ 表示生物标志物存在（概率为 $p$），$X_i=0$ 表示其不存在（概率为 $1-p$）。每次观测的期望值为 $E[X_i] = p$，方差为 $\\text{Var}(X_i) = p(1-p)$。\n\n样本比例 $\\hat{p}$ 是 $p$ 的点估计量，定义为观测值的均值：\n$$ \\hat{p} = \\frac{1}{n} \\sum_{i=1}^{n} X_i $$\n作为估计量，$\\hat{p}$ 的期望值为 $E[\\hat{p}] = E\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right] = \\frac{1}{n}\\sum_{i=1}^{n} E[X_i] = \\frac{1}{n}(np) = p$，因此它是 $p$ 的无偏估计量。$\\hat{p}$ 的方差由 $\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2}\\sum_{i=1}^{n} \\text{Var}(X_i) = \\frac{1}{n^2}(np(1-p)) = \\frac{p(1-p)}{n}$ 给出，这是由于观测值的独立性。\n\n根据中心极限定理（CLT），对于足够大的样本量 $n$，$\\hat{p}$ 的抽样分布近似为正态分布：\n$$ \\hat{p} \\approx N\\left(p, \\frac{p(1-p)}{n}\\right) $$\n对随机变量 $\\hat{p}$ 进行标准化，得到一个近似于标准正态分布的变量：\n$$ Z = \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\approx N(0,1) $$\n基于枢轴量 $Z$ 构建 $p$ 的置信水平为 $1-\\alpha$ 的双侧置信区间。我们寻求满足以下条件的界限：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $1-\\alpha/2$ 分位数。\n\n绝对误差范围，我们可以用 $E_{margin}$ 表示，是置信区间的半宽。从上面的不等式可以清楚地看出，估计 $p$ 的误差范围的表达式是 $E_{margin} = z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$。问题陈述要求此误差范围不应超过预设的容差 $\\epsilon$。\n$$ z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}} \\le \\epsilon $$\n我们的目标是找到满足此条件的最小样本量 $n$。我们重新整理不等式以求解 $n$：\n$$ \\sqrt{\\frac{p(1-p)}{n}} \\le \\frac{\\epsilon}{z_{1-\\alpha/2}} $$\n$$ \\frac{p(1-p)}{n} \\le \\left(\\frac{\\epsilon}{z_{1-\\alpha/2}}\\right)^2 $$\n$$ n \\ge p(1-p) \\left(\\frac{z_{1-\\alpha/2}}{\\epsilon}\\right)^2 $$\n这是所需样本量的一般设计表达式。然而，该表达式依赖于未知的比例 $p$。为保证对于 *任何* 可能的 $p \\in [0, 1]$ 值都满足误差范围要求，我们必须采用一种保守（最坏情况）的方法。这涉及到找到使所需样本量 $n$ 最大化的 $p$ 值。当 $p(1-p)$ 这一项最大化时，样本量 $n$ 也达到最大。\n\n设 $f(p) = p(1-p) = p - p^2$。为了在区间 $[0, 1]$ 上找到该函数的最大值，我们可以使用微积分。一阶导数为 $f'(p) = 1 - 2p$。令导数等于零，$1 - 2p = 0$，得出 $p = \\frac{1}{2} = 0.5$。由于二阶导数 $f''(p) = -2$ 为负，所以 $p=0.5$ 是一个局部最大值。这也是在区间 $[0, 1]$ 上的全局最大值，最大值为 $f(0.5) = 0.5(1-0.5) = 0.25$。\n\n通过将这个最坏情况下的 $p(1-p)$ 值代入样本量不等式，我们得到一个与 $p$ 无关的保守公式 $n$：\n$$ n \\ge 0.25 \\left(\\frac{z_{1-\\alpha/2}}{\\epsilon}\\right)^2 $$\n我们给定了以下值：\n- 置信水平 $1-\\alpha = 1 - 0.05 = 0.95$。\n- 这意味着 $\\alpha/2 = 0.025$，所以我们需要标准正态分布的 $1 - 0.025 = 0.975$ 分位数。问题指定使用“常用值”，即 $z_{0.975} = 1.96$。\n- 最大容许误差范围 $\\epsilon = 0.04$。\n\n将这些值代入保守的样本量公式中：\n$$ n \\ge 0.25 \\left(\\frac{1.96}{0.04}\\right)^2 $$\n首先，我们计算括号内的比率：\n$$ \\frac{1.96}{0.04} = \\frac{196}{4} = 49 $$\n现在，我们将其代回不等式中：\n$$ n \\ge 0.25 \\times (49)^2 $$\n$$ n \\ge 0.25 \\times 2401 $$\n$$ n \\ge 600.25 $$\n由于样本量 $n$ 必须是整数，我们必须选择满足此条件的最小整数。因此，我们对计算出的值取上取整：\n$$ n_{min} = \\lceil 600.25 \\rceil = 601 $$\n为确保在 $95\\%$ 的置信度下，对于任何真实患病率 $p$，误差范围最多为 $0.04$，所需的最小整数样本量为 $601$。",
            "answer": "$$ \\boxed{601} $$"
        },
        {
            "introduction": "虽然点估计很有用，但置信区间能更完整地展示我们对估计的不确定性。这项高级练习要求你实现并比较三种构建置信区间的方法——简单的 Wald 区间、更稳健的 Wilson 区间以及精确的 Clopper-Pearson 区间。通过在覆盖率和区间长度方面严格评估它们的表现，你将对选择统计方法时涉及的权衡有更深入的理解。",
            "id": "4957555",
            "problem": "一个由 $n$ 次成功概率为 $p$ 的独立同分布伯努利试验组成的序列，总共产生了 $k$ 次成功，其中 $k \\in \\{0,1,\\dots,n\\}$。令 $\\ell(p)$ 表示二项对数似然， $U(p)$ 表示得分函数， $I(p)$ 表示费雪信息。仅从以下基本要素出发：\n- 伯努利模型和二项模型的定义。\n- 二项对数似然及其导数。\n- 简单原假设下得分检验统计量的大样本正态近似。\n你必须推导出一个算法，通过反演水平为 $\\alpha$ 的双边得分检验，来构造 $p$ 的威尔逊得分区间。具体来说，构造在水平 $\\alpha$ 下对 $H_0: p = p_0$ 进行得分检验的接受域，并对其进行数学反演，从而得到一个依赖于 $n$ 和观测值 $k$ 的关于 $p$ 的区间。\n\n然后，给定 $n$ 和 $k$，实现三种 $p$ 的区间估计量：\n1. 基于最大似然估计（MLE） $\\hat{p}$ 和大样本正态近似的沃尔德区间。\n2. 通过反演上述推导的得分检验得到的威尔逊得分区间。\n3. 通过反演精确二项累积分布函数（CDF）得到的克洛普-皮尔逊区间。\n\n为了数值的有效性，对于任何端点在单位区间外的区间估计量，将端点截断到单位区间 $[0,1]$。对于克洛普-皮尔逊区间，以与精确二项反演一致的方式处理极端结果 $k=0$ 和 $k=n$，以确保允许的端点始终在 $[0,1]$ 内。\n\n对于一个固定的真实 $p$ 和样本量 $n$，将区间过程的覆盖概率定义为随机区间包含真实参数 $p$ 的概率（相对于 $K \\sim \\text{Binomial}(n,p)$ 的二项抽样分布）：\n$$\n\\text{coverage}(n,p,\\alpha) \\;=\\; \\sum_{k=0}^{n} \\mathbb{I}\\{L(n,k,\\alpha) \\le p \\le U(n,k,\\alpha)\\} \\cdot \\binom{n}{k} p^k (1-p)^{n-k},\n$$\n其中 $[L(n,k,\\alpha),U(n,k,\\alpha)]$ 是该方法为实现的 $k$ 所产生的区间，$\\mathbb{I}\\{\\cdot\\}$ 是指示函数。将区间方法在 $(n,p,\\alpha)$ 处的期望长度定义为\n$$\n\\text{Elen}(n,p,\\alpha) \\;=\\; \\sum_{k=0}^{n} \\left(U(n,k,\\alpha) - L(n,k,\\alpha)\\right) \\cdot \\binom{n}{k} p^k (1-p)^{n-k}.\n$$\n\n你的程序必须对每个测试用例 $(n,p,\\alpha)$，为每种方法计算两个浮点数：覆盖概率和期望长度，使用对 $k \\in \\{0,\\dots,n\\}$ 的精确求和以及二项概率质量函数。不允许进行蒙特卡洛模拟。\n\n测试套件：\n- 案例 1: $n=10$, $p=0.2$, $\\alpha=0.05$。\n- 案例 2: $n=40$, $p=0.5$, $\\alpha=0.05$。\n- 案例 3: $n=5$, $p=0.05$, $\\alpha=0.05$。\n- 案例 4: $n=30$, $p=0.9$, $\\alpha=0.05$。\n- 案例 5: $n=2$, $p=0.5$, $\\alpha=0.10$。\n- 案例 6: $n=100$, $p=0.01$, $\\alpha=0.05$。\n\n最终输出格式：\n你的程序应该生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表。对于每个测试用例，按以下顺序输出一个包含六个数字的列表：\n$[\\text{沃尔德覆盖率}, \\text{沃尔德期望长度}, \\text{威尔逊覆盖率}, \\text{威尔逊期望长度}, \\text{克洛普-皮尔逊覆盖率}, \\text{克洛普-皮尔逊期望长度}]$。\n最后一行必须看起来像\n$$\n[[\\dots],\\,[\\dots],\\dots\\,]\n$$\n所有数值都以小数形式表示（无百分号），且全部输出都在一行上，没有额外的文本。",
            "solution": "该问题要求推导并实现三种不同的二项比例 $p$ 的置信区间估计量，并随后根据覆盖概率和期望长度对其进行评估。我们将首先按照规定，为每种方法提供理论背景和推导过程。\n\n### 1. 置信区间的推导与公式\n\n设 $K$ 为 $n$ 次成功概率为 $p$ 的独立同分布伯努利试验中的成功次数。随机变量 $K$ 服从二项分布，$K \\sim \\text{Binomial}(n,p)$，其概率质量函数（PMF）为 $f(k;p) = \\binom{n}{k} p^k (1-p)^{n-k}$，其中 $k \\in \\{0, 1, \\dots, n\\}$。给定观测到的成功次数 $k$，我们的目标是为 $p$构造一个 $100(1-\\alpha)\\%$ 的置信区间。\n\n#### 1.1. 威尔逊得分区间\n\n该区间是通过对原假设 $H_0: p = p_0$ 的得分检验进行反演推导出来的。推导过程从二项对数似然函数开始。\n\n对于观测值 $k$ 的似然函数为 $L(p) = \\binom{n}{k} p^k (1-p)^{n-k}$。对数似然函数为：\n$$ \\ell(p) = \\log L(p) = \\log\\binom{n}{k} + k \\log(p) + (n-k) \\log(1-p) $$\n得分函数 $U(p)$ 是对数似然函数关于 $p$ 的一阶导数：\n$$ U(p) = \\frac{d\\ell(p)}{dp} = \\frac{k}{p} - \\frac{n-k}{1-p} = \\frac{k - np}{p(1-p)} $$\n费雪信息 $I(p)$ 是对数似然函数二阶导数的负期望值。二阶导数为：\n$$ \\frac{d^2\\ell(p)}{dp^2} = -\\frac{k}{p^2} - \\frac{n-k}{(1-p)^2} $$\n取负期望，其中 $E[K] = np$，我们得到：\n$$ I(p) = -E\\left[\\frac{d^2\\ell(p)}{dp^2}\\right] = E\\left[\\frac{K}{p^2} + \\frac{n-K}{(1-p)^2}\\right] = \\frac{np}{p^2} + \\frac{n-np}{(1-p)^2} = \\frac{n}{p} + \\frac{n}{1-p} = \\frac{n}{p(1-p)} $$\n对于原假设 $H_0: p = p_0$ 的得分检验统计量由 $Z = U(p_0) / \\sqrt{I(p_0)}$ 给出。对于大样本 $n$，$Z$ 近似服从标准正态分布，$Z \\sim N(0,1)$。\n$$ Z = \\frac{ (k - np_0) / (p_0(1-p_0)) }{ \\sqrt{n / (p_0(1-p_0))} } = \\frac{k - np_0}{\\sqrt{n p_0 (1-p_0)}} $$\n令 $\\hat{p} = k/n$ 为最大似然估计（MLE）。该统计量可以写成 $Z = (\\hat{p}-p_0)/\\sqrt{p_0(1-p_0)/n}$。在显著性水平 $\\alpha$ 下，如果 $|Z| \\le z_{\\alpha/2}$，则双边得分检验不拒绝 $H_0$，其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位数。$p_0$ 的接受域由以下不等式定义：\n$$ \\frac{(\\hat{p} - p_0)^2}{p_0(1-p_0)/n} \\le z_{\\alpha/2}^2 $$\n为了获得 $p$ 的置信区间，我们对这个不等式求解 $p_0$，现在我们将其视为变量 $p$：\n$$ n(\\hat{p}-p)^2 \\le z_{\\alpha/2}^2 p(1-p) $$\n$$ n(\\hat{p}^2 - 2\\hat{p}p + p^2) \\le z_{\\alpha/2}^2(p-p^2) $$\n整理各项后得到一个关于 $p$ 的二次不等式：\n$$ (n + z_{\\alpha/2}^2)p^2 - (2n\\hat{p} + z_{\\alpha/2}^2)p + n\\hat{p}^2 \\le 0 $$\n置信区间的端点是相应二次方程 $Ap^2 + Bp + C = 0$ 的根，其中 $A = n+z_{\\alpha/2}^2$，$B = -(2n\\hat{p} + z_{\\alpha/2}^2)$，$C = n\\hat{p}^2$。使用二次公式 $p = (-B \\pm \\sqrt{B^2-4AC})/(2A)$，端点为：\n$$ p = \\frac{2n\\hat{p} + z_{\\alpha/2}^2 \\pm \\sqrt{(2n\\hat{p} + z_{\\alpha/2}^2)^2 - 4(n+z_{\\alpha/2}^2)(n\\hat{p}^2)}}{2(n+z_{\\alpha/2}^2)} $$\n判别式可简化为 $B^2 - 4AC = z_{\\alpha/2}^2(4n\\hat{p}(1-\\hat{p}) + z_{\\alpha/2}^2)$。代入 $\\hat{p}=k/n$：\n$$ p = \\frac{2k + z_{\\alpha/2}^2 \\pm z_{\\alpha/2}\\sqrt{4k(1-k/n) + z_{\\alpha/2}^2}}{2(n+z_{\\alpha/2}^2)} $$\n该公式定义了威尔逊得分区间的下界和上界，即 $[L_W(k,n,\\alpha), U_W(k,n,\\alpha)]$。根据构造，所得区间包含在 $[0,1]$ 内。\n\n#### 1.2. 沃尔德区间\n沃尔德区间基于最大似然估计量 $\\hat{p}=k/n$ 分布的大样本正态近似。$\\hat{p}$ 的方差是 $p(1-p)/n$，通过代入最大似然估计量进行估计，得到估计的标准误 $\\text{SE}(\\hat{p}) = \\sqrt{\\hat{p}(1-\\hat{p})/n}$。\n沃尔德区间以 $\\hat{p}$ 为中心，误差范围由 $z_{\\alpha/2}$ 确定：\n$$ \\left[ \\hat{p} - z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}, \\quad \\hat{p} + z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right] $$\n对于小样本 $n$以及接近 $0$ 或 $1$ 的 $p$，该区间的表现不佳。当 $k=0$ 或 $k=n$ 时，$\\hat{p}$ 分别为 $0$ 或 $1$，导致标准误为 $0$，区间坍缩为单点。根据问题陈述，端点被截断到区间 $[0,1]$。\n\n#### 1.3. 克洛普-皮尔逊区间\n克洛普-皮尔逊区间是一种“精确”方法，它基于反演两个单边二项检验，确保对于所有的 $p$，覆盖概率至少为 $1-\\alpha$。端点 $[p_L, p_U]$ 定义为：\n1. 下界 $p_L$ 是方程 $P(K \\ge k | p=p_L) = \\sum_{i=k}^{n} \\binom{n}{i}p_L^i(1-p_L)^{n-i} = \\alpha/2$ 的解。\n2. 上界 $p_U$ 是方程 $P(K \\le k | p=p_U) = \\sum_{i=0}^{k} \\binom{n}{i}p_U^i(1-p_U)^{n-i} = \\alpha/2$ 的解。\n\n这些方程可以使用二项累积分布函数（CDF）和正则化不完全贝塔函数之间的关系来求解。解由贝塔分布的分位数给出：\n- $p_L = \\text{BetaInv}(\\alpha/2; k, n-k+1)$\n- $p_U = \\text{BetaInv}(1-\\alpha/2; k+1, n-k)$\n其中 $\\text{BetaInv}(q; a, b)$ 是形状参数为 $a$ 和 $b$ 的贝塔分布的 $q$ 分位数。\n对于极端情况：\n- 如果 $k=0$，下界方程为 $P(K \\ge 0 | p_L) = 1 = \\alpha/2$，此方程无解。下界取为 $p_L=0$。\n- 如果 $k=n$，上界方程为 $P(K \\le n | p_U) = 1 = \\alpha/2$，同样无解。上界取为 $p_U=1$。\n这些约定与贝塔分布分位数函数的极限行为是一致的。\n\n### 2. 评估指标与算法\n\n这些区间估计量的性能通过两个指标进行评估，这两个指标是通过对所有可能的结果 $k \\in \\{0, 1, \\dots, n\\}$ 按其二项概率加权求和来计算的。\n\n- **覆盖概率**：随机区间 $[L(K), U(K)]$ 包含真实参数 $p$ 的概率。\n$$ \\text{coverage}(n,p,\\alpha) = \\sum_{k=0}^{n} \\mathbb{I}\\{L(n,k,\\alpha) \\le p \\le U(n,k,\\alpha)\\} \\cdot \\binom{n}{k} p^k (1-p)^{n-k} $$\n- **期望长度**：区间的平均长度。\n$$ \\text{Elen}(n,p,\\alpha) = \\sum_{k=0}^{n} \\left(U(n,k,\\alpha) - L(n,k,\\alpha)\\right) \\cdot \\binom{n}{k} p^k (1-p)^{n-k} $$\n这里，$\\mathbb{I}\\{\\cdot\\}$ 是指示函数。\n\n计算给定 $(n, p, \\alpha)$ 的这些指标的算法如下：\n1. 初始化六个累加器为 $0$：三种方法（沃尔德、威尔逊、克洛普-皮尔逊）中的每一种都有一个用于覆盖率和一个用于长度的累加器。\n2. 计算标准正态分位数 $z_{\\alpha/2}$。\n3. 对于从 $0$ 到 $n$ 的每个整数 $k$：\n   a. 计算二项概率 $P(K=k) = \\binom{n}{k} p^k (1-p)^{n-k}$。\n   b. 对于三种方法中的每一种，计算与观测值 $k$ 对应的置信区间 $[L, U]$。\n   c. 对于每种方法，如果真实参数 $p$ 位于其计算出的区间 $[L, U]$ 内，则将步骤 3a 中的概率加到该方法的覆盖率累加器中。\n   d. 对于每种方法，将区间长度 $(U-L)$ 与步骤 3a 中的概率的乘积加到该方法的期望长度累加器中。\n4. 遍历所有 $k$ 之后，累加器将保存每种方法的覆盖概率和期望长度的最终值。实现遵循这个精确求和过程。",
            "answer": "[[0.8926258176,0.3551524,0.9672065024,0.4079495148,0.9990838144,0.4913793741],[0.9544997361,0.306019778,0.9502011311,0.306019778,0.978255956,0.3129868779],[0.7737809375,0.2319409028,0.9975700625,0.2198031024,1,0.4018772024],[0.9268339238,0.1706240293,0.9472305542,0.1764124318,0.985655326,0.1982737525],[0.5,0.8224967964,0.9375,0.6558661643,1,0.8],[0.3660323413,0.019623632,0.9620573719,0.0469046395,0.9901768654,0.0583000632]]"
        }
    ]
}