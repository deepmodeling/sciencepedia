{
    "hands_on_practices": [
        {
            "introduction": "在生物统计学中，我们经常遇到一些既不完全离散也不完全连续的现象，例如在生存分析中，一些受试者可能在研究开始时（零时刻）就立即发生事件，而其他人则在之后某个连续的时间点发生。本练习  将通过一个混合随机变量的例子，引导您从第一性原理出发计算其期望值，从而加深您对离散概率质量和连续概率密度如何共同定义一个随机变量的理解。",
            "id": "4944773",
            "problem": "一个生物统计学团队正在研究一个队列中即时生化反应的时间，该队列中有些个体在基线时即有反应，而其他个体则在稍后才有反应。令$X$表示反应时间（单位：小时）。根据经验，在$0$处存在一个点质量，代表即时反应的概率为$p$；对于延迟反应，在$(0,\\infty)$上有一个连续部分，其概率密度函数（PDF）为$(1-p)\\lambda \\exp(-\\lambda x)$，其中$\\lambda0$是一个率参数。因此，$X$是一个混合随机变量，其在$0$处的概率质量函数（PMF）等于$p$，在$(0,\\infty)$上的PDF等于$(1-p)\\lambda \\exp(-\\lambda x)$。假设$0 \\leq p \\leq 1$且$\\lambda0$。\n\n从期望作为关于$X$的分布的勒贝格积分的基本定义（即$E[g(X)] = \\int g(x)\\,\\mathrm{d}F_X(x)$）出发，并仅使用关于积分和指数函数的公认事实，计算$E[X]$和$E[|X|]$关于$p$和$\\lambda$的精确闭式表达式。然后，根据勒贝格定义（即$E[|X|]$何时有限），讨论$X$关于参数$p$和$\\lambda$的可积性条件，并提供与混合分布结构相关的清晰推理。\n\n将$E[X]$和$E[|X|]$的最终结果表示为关于$p$和$\\lambda$的精确代数表达式。不需要数值四舍五入。在最终表达式中不要包含单位，但可以在解释中提及单位。",
            "solution": "该问题陈述经评估是有效的，因为它具有科学依据、自成体系且提法得当。它描述了一个混合随机变量，这是概率论和生物统计学中的一个标准概念，并要求推导其期望和讨论其可积性，这些都是明确定义的数学任务。\n\n代表反应时间的随机变量$X$具有混合分布。其概率测度由一个离散部分和一个连续部分组成。\n1.  在$X=0$处有一个离散点质量，其概率为$P(X=0) = p$。\n2.  在区间$(0, \\infty)$上有一个连续分布，其概率密度函数为$f_c(x) = (1-p)\\lambda \\exp(-\\lambda x)$，对于$x0$。\n\n总概率是离散事件的概率与连续密度在其支撑集上积分的总和：\n$$P(X=0) + \\int_{0}^{\\infty} f_c(x) \\, \\mathrm{d}x = p + \\int_0^\\infty (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n该积分的计算结果为：\n$$(1-p)\\lambda \\int_0^\\infty \\exp(-\\lambda x) \\, \\mathrm{d}x = (1-p)\\lambda \\left[ -\\frac{1}{\\lambda} \\exp(-\\lambda x) \\right]_0^\\infty = (1-p) \\left( \\lim_{x\\to\\infty} (-\\exp(-\\lambda x)) - (-\\exp(0)) \\right)$$\n由于$\\lambda  0$，$\\lim_{x\\to\\infty} \\exp(-\\lambda x) = 0$。因此，积分为$(1-p)(0 - (-1)) = 1-p$。\n总概率为$p + (1-p) = 1$，这证实了该分布的有效性。\n\n问题要求从基本定义$E[g(X)] = \\int g(x)\\,\\mathrm{d}F_X(x)$出发计算函数$g(X)$的期望，其中$F_X(x)$是$X$的累积分布函数。对于这样的混合分布，勒贝格-斯蒂尔切斯积分可以分解为离散质量点上的求和以及连续域上的标准黎曼积分。\n$$E[g(X)] = g(0)P(X=0) + \\int_0^\\infty g(x) f_c(x) \\, \\mathrm{d}x$$\n$$E[g(X)] = g(0) \\cdot p + \\int_0^\\infty g(x) (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n\n首先，我们计算$X$的期望，记为$E[X]$。这对应于$g(x) = x$的情况。\n$$E[X] = (0) \\cdot p + \\int_0^\\infty x (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n$$E[X] = (1-p)\\lambda \\int_0^\\infty x \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n为了计算该积分，我们使用分部积分法，$\\int u \\, \\mathrm{d}v = uv - \\int v \\, \\mathrm{d}u$。令$u=x$且$\\mathrm{d}v = \\exp(-\\lambda x) \\, \\mathrm{d}x$。则$\\mathrm{d}u = \\mathrm{d}x$且$v = -\\frac{1}{\\lambda}\\exp(-\\lambda x)$。\n$$\\int_0^\\infty x \\exp(-\\lambda x) \\, \\mathrm{d}x = \\left[ x \\left(-\\frac{1}{\\lambda}\\exp(-\\lambda x)\\right) \\right]_0^\\infty - \\int_0^\\infty \\left(-\\frac{1}{\\lambda}\\exp(-\\lambda x)\\right) \\, \\mathrm{d}x$$\n$$= \\left[ -\\frac{x}{\\lambda}\\exp(-\\lambda x) \\right]_0^\\infty + \\frac{1}{\\lambda} \\int_0^\\infty \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n第一项在极限处求值：$\\lim_{x\\to\\infty} \\left(-\\frac{x}{\\lambda}\\exp(-\\lambda x)\\right) - 0$。当$x\\to\\infty$时，极限为$0$，这可以通过对$\\frac{x}{\\exp(\\lambda x)}$使用洛必达法则来验证。第二项是$\\frac{1}{\\lambda}$乘以一个指数PDF（不含其率常数）的积分，我们已经知道其值为$\\frac{1}{\\lambda}$。\n$$\\int_0^\\infty x \\exp(-\\lambda x) \\, \\mathrm{d}x = 0 + \\frac{1}{\\lambda} \\left[ -\\frac{1}{\\lambda}\\exp(-\\lambda x) \\right]_0^\\infty = \\frac{1}{\\lambda^2} (-\\lim_{x\\to\\infty}\\exp(-\\lambda x) - (-\\exp(0))) = \\frac{1}{\\lambda^2}(0 - (-1)) = \\frac{1}{\\lambda^2}$$\n将此结果代回$E[X]$的表达式中：\n$$E[X] = (1-p)\\lambda \\left(\\frac{1}{\\lambda^2}\\right) = \\frac{1-p}{\\lambda}$$\n\n接下来，我们计算$E[|X|]$，这对应于$g(x) = |x|$的情况。\n$$E[|X|] = |0| \\cdot p + \\int_0^\\infty |x| (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n随机变量$X$的支撑集是集合$\\{0\\} \\cup (0, \\infty)$，其中所有值都是非负的。因此，对于$X$可以取到的任何值$x$，都有$|x|=x$。\n这意味着$|X| = X$，因此，它们的期望必须相等。\n$$E[|X|] = E[X] = \\frac{1-p}{\\lambda}$$\n为了严谨起见，我们从积分定义出发来证明这一点：\n$$E[|X|] = 0 \\cdot p + \\int_0^\\infty x (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$$\n这与$E[X]$的表达式完全相同，因此得到相同的结果。\n$$E[|X|] = \\frac{1-p}{\\lambda}$$\n\n最后，我们讨论$X$在勒贝格定义下的可积性条件。一个随机变量$X$被定义为可积的，如果其期望存在且有限，这等价于条件$E[|X|]  \\infty$。\n根据我们的计算，我们有：\n$$E[|X|] = \\frac{1-p}{\\lambda}$$\n问题给出了参数的约束条件：$0 \\le p \\le 1$和$\\lambda  0$。\n在这些约束条件下：\n-   分子$1-p$的范围是$[0, 1]$。\n-   分母$\\lambda$是严格为正的，所以$\\lambda \\in (0, \\infty)$。\n因此，比率$\\frac{1-p}{\\lambda}$总是非负且有限的。它可能为无穷大的唯一方式是$\\lambda=0$，但这被问题陈述明确排除了。\n因此，对于任何有效的参数$p$和$\\lambda$，$E[|X|]$总是有限的。\n\n这种必然的可积性根植于分布的结构。总期望$E[|X|]$是离散部分和连续部分贡献的总和。在$x=0$处的离散部分贡献了$|0| \\cdot p = 0$，这是有限的。连续部分的贡献由积分$\\int_0^\\infty x (1-p)\\lambda \\exp(-\\lambda x) \\, \\mathrm{d}x$确定。这个积分的收敛性取决于密度的尾部行为。对于任何$\\lambda  0$，项$\\exp(-\\lambda x)$衰减到零的速度远快于项$x$增长到无穷大的速度。这种快速的指数衰减确保了积分是有限的。因此，在给定的参数范围内，随机变量$X$总是可积的。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1-p}{\\lambda}  \\frac{1-p}{\\lambda} \\end{pmatrix}}$$"
        },
        {
            "introduction": "生存分析是生物统计学的核心内容之一，但在实际研究中，数据往往是“删失”的，即我们无法观察到所有研究对象的事件发生时间。本练习  将指导您完成一项生物统计学家的关键技能：为右删失数据推导最大似然估计（MLE）。您将学习如何构建一个同时考虑了观测事件和删失数据的似然函数，并用它来估计指数生存模型中的关键参数 $\\lambda$。",
            "id": "4944733",
            "problem": "一项临床研究对 $n=12$ 名患者从入组开始进行随访，直至发生关注的生物医学事件或行政性右删失。假设每位患者的事件发生时间是来自率参数为 $\\lambda0$ 的独立同分布 (i.i.d.) 指数随机变量的一个实现值，并且右删失是非信息性的。对于患者 $i$，令 $t_i$ 表示观测到的随访时间（单位：月），令 $\\delta_i$ 表示观测到的事件指示符，其中如果事件在时间 $t_i$ 发生，则 $\\delta_i=1$；如果观测值在时间 $t_i$ 被右删失，则 $\\delta_i=0$。观测数据如下：\n- 随访时间（月）：$2.1, 3.5, 5.2, 1.8, 4.0, 6.7, 3.3, 7.5, 2.9, 5.0, 8.2, 4.6$。\n- 事件指示符：$1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0$。\n\n从具有右删失的独立连续时间生存数据的似然第一性原理出发，用 $\\lambda$、观测时间 $\\{t_i\\}$ 和事件指示符 $\\{\\delta_i\\}$ 写出完整似然函数。对对数似然函数求导以获得得分方程，求解率参数 $\\lambda$ 的最大似然估计量，然后计算其在上述数据集下的数值。将最终数值答案四舍五入到四位有效数字。以“每月”为单位表示最终的率。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是良定的和客观的。\n\n### 步骤1：提取已知条件\n- 患者数量：$n=12$。\n- 每位患者的事件发生时间是来自率参数为 $\\lambda  0$ 的独立同分布 (i.i.d.) 指数随机变量的一个实现值。\n- 右删失是非信息性的。\n- 对于患者 $i$，$t_i$ 是观测到的随访时间（单位：月）。\n- 对于患者 $i$，$\\delta_i$ 是观测到的事件指示符，其中 $\\delta_i=1$ 表示事件发生，$\\delta_i=0$ 表示右删失。\n- 观测到的随访时间 $\\{t_i\\}_{i=1}^{12}$：$2.1, 3.5, 5.2, 1.8, 4.0, 6.7, 3.3, 7.5, 2.9, 5.0, 8.2, 4.6$。\n- 观测到的事件指示符 $\\{\\delta_i\\}_{i=1}^{12}$：$1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于指数分布和右删失数据的最大似然原理，这些是生物统计学和生存分析中的标准和基本概念。该模型在科学上是合理的。\n- **良定性：** 该问题提供了所有必要的数据和清晰的定义。目标是为一个标准分布的良定义参数找到最大似然估计量 (MLE)，该问题有唯一且有意义的解。\n- **客观性：** 问题以精确、量化且无偏见的语言陈述。\n\n### 步骤3：结论与行动\n问题是有效的。将提供完整的解答。\n\n假设患者的事件发生时间 $T$ 服从率参数为 $\\lambda  0$ 的指数分布。其概率密度函数 (PDF) 由下式给出：\n$$f(t|\\lambda) = \\lambda \\exp(-\\lambda t), \\quad t \\ge 0$$\n相应的生存函数 $S(t|\\lambda)$，即事件在时间 $t$ 之前尚未发生的概率，为：\n$$S(t|\\lambda) = P(T  t) = \\int_{t}^{\\infty} \\lambda \\exp(-\\lambda u) du = \\exp(-\\lambda t)$$\n似然函数是基于 $n=12$ 名独立患者中每一位的贡献构建的。患者 $i$ 的贡献取决于其事件是被观测到还是其观测值被右删失。\n\n对于在时间 $t_i$ 经历事件的患者 $i$（即 $\\delta_i=1$），其对似然函数的贡献是在该特定时间发生事件的概率密度，即 $f(t_i|\\lambda)$。\n\n对于在时间 $t_i$ 被右删失的患者 $i$（即 $\\delta_i=0$），我们只知道其真实的事件时间大于 $t_i$。其对似然函数的贡献是这种情况发生的概率，由生存函数 $S(t_i|\\lambda)$ 给出。\n\n我们可以使用事件指示符 $\\delta_i$ 将单个患者 $i$ 的似然贡献写成一般形式：\n$$L_i(\\lambda) = [f(t_i|\\lambda)]^{\\delta_i} [S(t_i|\\lambda)]^{1-\\delta_i}$$\n代入指数分布的 PDF 和生存函数的表达式：\n$$L_i(\\lambda) = [\\lambda \\exp(-\\lambda t_i)]^{\\delta_i} [\\exp(-\\lambda t_i)]^{1-\\delta_i}$$\n通过合并指数项，该表达式可以简化为：\n$$L_i(\\lambda) = \\lambda^{\\delta_i} \\exp(-\\lambda t_i \\delta_i) \\exp(-\\lambda t_i (1-\\delta_i)) = \\lambda^{\\delta_i} \\exp(-\\lambda t_i (\\delta_i + 1 - \\delta_i)) = \\lambda^{\\delta_i} \\exp(-\\lambda t_i)$$\n由于观测是独立的，对于 $n$ 名患者的整个样本，总似然函数 $L(\\lambda)$ 是各个似然贡献的乘积：\n$$L(\\lambda) = \\prod_{i=1}^{n} L_i(\\lambda) = \\prod_{i=1}^{n} \\left(\\lambda^{\\delta_i} \\exp(-\\lambda t_i)\\right)$$\n这可以简化为：\n$$L(\\lambda) = \\left(\\prod_{i=1}^{n} \\lambda^{\\delta_i}\\right) \\left(\\prod_{i=1}^{n} \\exp(-\\lambda t_i)\\right) = \\lambda^{\\sum_{i=1}^{n} \\delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right)$$\n为了找到 $\\lambda$ 的最大似然估计量 (MLE)，在数学上更方便的做法是最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$：\n$$\\ell(\\lambda) = \\ln\\left(\\lambda^{\\sum_{i=1}^{n} \\delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right)\\right)$$\n$$\\ell(\\lambda) = \\left(\\sum_{i=1}^{n} \\delta_i\\right) \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} t_i$$\n为了找到使 $\\ell(\\lambda)$ 最大化的 $\\lambda$ 值，我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求导，并令结果为零。这个导数被称为得分函数 $U(\\lambda)$。\n$$U(\\lambda) = \\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda}\\left[\\left(\\sum_{i=1}^{n} \\delta_i\\right) \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} t_i\\right] = \\frac{\\sum_{i=1}^{n} \\delta_i}{\\lambda} - \\sum_{i=1}^{n} t_i$$\n得分方程为 $U(\\hat{\\lambda}) = 0$，其中 $\\hat{\\lambda}$ 表示 MLE：\n$$\\frac{\\sum_{i=1}^{n} \\delta_i}{\\hat{\\lambda}} - \\sum_{i=1}^{n} t_i = 0$$\n求解 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{\\sum_{i=1}^{n} \\delta_i}{\\sum_{i=1}^{n} t_i}$$\n率参数的 MLE 是观测到的事件总数除以总随访人时。\n\n现在，我们使用提供的数据计算 $\\hat{\\lambda}$ 的数值。\n首先，我们计算事件总数 $d = \\sum_{i=1}^{12} \\delta_i$：\n$$d = 1+1+0+1+0+1+1+0+1+1+0+0 = 7$$\n接下来，我们计算总随访人时 $T = \\sum_{i=1}^{12} t_i$：\n$$T = 2.1+3.5+5.2+1.8+4.0+6.7+3.3+7.5+2.9+5.0+8.2+4.6 = 54.8 \\text{ 月}$$\n最后，我们计算估计值 $\\hat{\\lambda}$：\n$$\\hat{\\lambda} = \\frac{d}{T} = \\frac{7}{54.8} \\approx 0.127737226...$$\n题目要求将数值答案四舍五入到四位有效数字。\n$$\\hat{\\lambda} \\approx 0.1277$$\n率的单位是 事件/月。",
            "answer": "$$\\boxed{0.1277}$$"
        },
        {
            "introduction": "在对生物过程进行建模后，我们常常需要从该模型中模拟数据，以检验假设或评估统计方法的性能，而一个常见的需求是从一个被限制在特定范围内的分布（即截断分布）中抽样。本练习  将让您亲手设计并实现一个高效的模拟算法，您将推导并应用逆变换采样法来处理截断正态分布。通过这个过程，您将掌握一种通用且重要的计算技巧，并加深对分布函数与其应用的理解。",
            "id": "4944715",
            "problem": "您的任务是设计并分析一种在生物统计学背景下从截断正态分布中进行模拟的方法，并量化朴素拒绝采样器的效率。考虑一个连续随机变量 $X$，它服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，记为 $X \\sim \\mathcal{N}(\\mu,\\sigma^2)$。您希望从限制在开区间 $(a,b)$ 上的 $X$ 的条件分布中抽取样本，即从 $(a,b)$ 上的截断正态分布中抽样。此外，您还希望分析一个朴素拒绝采样器的接受率，该采样器从 $\\mathcal{N}(\\mu,\\sigma^2)$ 中提出建议样本，并在建议样本位于 $(a,b)$ 内时接受该样本。\n\n您的任务如下：\n\n1.  **推导逆变换采样算法**：从第一性原理出发，仅使用概率密度函数和累积分布函数的定义等核心概念，推导一个正确且计算高效的算法，用于从限制在 $(a,b)$ 上的 $X$ 的截断正态分布中抽样。该算法必须完全用标准正态分布的变换来表示，并且必须对任何有限实数 $a  b$ 和 $\\sigma > 0$ 有效。\n2.  **推导接受率**：推导上述朴素拒绝采样器的理论接受概率的精确表达式，该表达式应以标准正态CDF $\\Phi$、$\\mu$、$\\sigma$、$a$ 和 $b$ 表示。\n3.  **计算数值**：对于以下五个测试案例，计算朴素拒绝采样器的理论接受率。将这五个案例的计算接受率作为浮点数列表返回，每个浮点数四舍五入到小数点后六位。案例为 $(\\mu, \\sigma, a, b)$：$(0, 1, -1, 1)$, $(0, 1, 2, 3)$, $(5, 2, 4, 6)$, $(0, 1, -10, 10)$, $(0, 1, 0, 0.0001)$。",
            "solution": "该问题要求我们为截断正态分布开发一个高效的采样算法，并分析朴素拒绝采样器的效率。我们将分步解决。\n\n**第一部分：逆变换采样算法推导**\n\n我们的目标是从一个正态分布 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 在区间 $(a, b)$ 上的截断版本中抽样。令 $X_T$ 表示这个截断随机变量。\n\n1.  **截断分布的CDF**：根据定义，截断变量 $X_T$ 的累积分布函数 (CDF) $F_{X_T}(x)$ 是条件概率 $P(X \\le x | a  X  b)$。对于任意 $x \\in (a, b)$，我们有：\n    $$ F_{X_T}(x) = \\frac{P(a  X \\le x)}{P(a  X  b)} = \\frac{F_X(x) - F_X(a)}{F_X(b) - F_X(a)} $$\n    其中 $F_X$ 是原始正态分布的 CDF。\n\n2.  **标准化**：为了使算法更通用和数值稳定，我们使用标准正态CDF $\\Phi(z)$ 来表达 $F_X(x)$。我们知道 $F_X(x) = \\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right)$。令标准化边界为 $\\alpha = (a-\\mu)/\\sigma$ 和 $\\beta = (b-\\mu)/\\sigma$。代入上式可得：\n    $$ F_{X_T}(x) = \\frac{\\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right) - \\Phi(\\alpha)}{\\Phi(\\beta) - \\Phi(\\alpha)} $$\n\n3.  **逆变换法**：逆变换采样法的核心思想是，如果 $U$ 是一个在 $(0, 1)$ 上均匀分布的随机变量，那么 $F^{-1}(U)$ 就具有 CDF $F$。我们设 $u = F_{X_T}(x)$，然后解出 $x$。\n    $$ u = \\frac{\\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right) - \\Phi(\\alpha)}{\\Phi(\\beta) - \\Phi(\\alpha)} $$\n    重新整理得到：\n    $$ \\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right) = \\Phi(\\alpha) + u \\cdot (\\Phi(\\beta) - \\Phi(\\alpha)) $$\n    这个方程的右边是一个在 $(\\Phi(\\alpha), \\Phi(\\beta))$ 区间内的值。这是因为 $u$ 在 $(0,1)$ 内，所以 $\\Phi(\\alpha) + u(\\Phi(\\beta) - \\Phi(\\alpha))$ 是 $\\Phi(\\alpha)$ 和 $\\Phi(\\beta)$ 之间的一个线性插值。\n\n4.  **求解 $x$**：我们对上式两边应用标准正态分布的逆CDF（或分位数函数）$\\Phi^{-1}$：\n    $$ \\frac{x-\\mu}{\\sigma} = \\Phi^{-1}\\left(\\Phi(\\alpha) + u \\cdot (\\Phi(\\beta) - \\Phi(\\alpha))\\right) $$\n    最后，解出 $x$：\n    $$ x = \\mu + \\sigma \\cdot \\Phi^{-1}\\left(\\Phi(\\alpha) + u \\cdot (\\Phi(\\beta) - \\Phi(\\alpha))\\right) $$\n\n**算法流程**:\n1.  计算标准化边界 $\\alpha = (a-\\mu)/\\sigma$ 和 $\\beta = (b-\\mu)/\\sigma$。\n2.  计算这些边界处的标准正态CDF值：$C_\\alpha = \\Phi(\\alpha)$ 和 $C_\\beta = \\Phi(\\beta)$。\n3.  从标准均匀分布 $U \\sim \\text{Uniform}(0, 1)$ 中抽取一个样本 $u$。\n4.  将 $u$ 映射到截断的CDF范围内：$v = C_\\alpha + u \\cdot (C_\\beta - C_\\alpha)$。\n5.  使用标准正态分位数函数（逆CDF）计算标准化的截断样本：$z_T = \\Phi^{-1}(v)$。\n6.  将样本变换回原始尺度：$x_T = \\mu + \\sigma \\cdot z_T$。\n\n该算法计算效率高，因为它只需要一次均匀抽样和几次CDF/PPF调用，避免了拒绝采样的不确定性和潜在的低效率。\n\n**第二部分：朴素拒绝采样器的接受率**\n\n朴素拒绝采样器的工作方式如下：\n1.  从原始（非截断）正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 中抽取一个建议样本 $X_{prop}$。\n2.  如果 $a  X_{prop}  b$，则接受该样本。\n3.  否则，拒绝该样本并返回步骤1。\n\n该采样器的接受率就是建议样本恰好落入所需区间 $(a, b)$ 的概率。这个概率就是：\n$$ P(\\text{接受}) = P(a  X  b) $$\n这个概率可以直接用原始正态分布的CDF计算：\n$$ P(a  X  b) = F_X(b) - F_X(a) $$\n使用标准正态CDF $\\Phi$ 和标准化边界 $\\alpha, \\beta$，表达式为：\n$$ P(\\text{接受}) = \\Phi(\\beta) - \\Phi(\\alpha) = \\Phi\\left(\\frac{b-\\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right) $$\n这个表达式给出了朴素拒绝采样器一次尝试就成功的理论概率。当区间 $(a,b)$ 位于分布的尾部时，这个概率会非常小，导致采样效率极低，这正是逆变换法如此优越的原因。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef truncated_normal_sample(mu, sigma, a, b, n, rng):\n    \"\"\"\n    Sample n values from N(mu, sigma^2) truncated to (a, b)\n    using inverse transform sampling on the standard normal.\n    \"\"\"\n    alpha = (a - mu) / sigma\n    beta = (b - mu) / sigma\n\n    # Compute CDF bounds\n    cdf_alpha = norm.cdf(alpha)\n    cdf_beta = norm.cdf(beta)\n\n    # Draw uniforms over the truncated CDF interval\n    u = rng.random(n)\n    # Map to the target quantiles in (cdf_alpha, cdf_beta)\n    target = cdf_alpha + u * (cdf_beta - cdf_alpha)\n    # Invert to get truncated standard normal samples\n    z = norm.ppf(target)\n    # Affine transform back to N(mu, sigma^2)\n    x = mu + sigma * z\n    return x\n\ndef acceptance_rate(mu, sigma, a, b):\n    \"\"\"\n    Analytical acceptance probability for naive rejection sampling\n    from N(mu, sigma^2) keeping samples in (a, b).\n    \"\"\"\n    alpha = (a - mu) / sigma\n    beta = (b - mu) / sigma\n    return float(norm.cdf(beta) - norm.cdf(alpha))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (mu, sigma, a, b).\n    test_cases = [\n        (0.0, 1.0, -1.0, 1.0),       # Case 1: central moderate interval\n        (0.0, 1.0, 2.0, 3.0),        # Case 2: right tail interval\n        (5.0, 2.0, 4.0, 6.0),        # Case 3: shifted-scaled moderate interval\n        (0.0, 1.0, -10.0, 10.0),     # Case 4: very wide interval ~ full support\n        (0.0, 1.0, 0.0, 0.0001),     # Case 5: very narrow near zero\n    ]\n\n    # Initialize RNG with fixed seed for determinism if sampling is used\n    rng = np.random.default_rng(12345)\n\n    results = []\n    # Also construct the sampler (demonstration; samples are not printed)\n    for mu, sigma, a, b in test_cases:\n        # Compute analytical acceptance rate\n        acc = acceptance_rate(mu, sigma, a, b)\n        # Demonstrate sampler correctness by drawing a small batch (not used in output)\n        _ = truncated_normal_sample(mu, sigma, a, b, n=10, rng=rng)\n        # Round to 6 decimals as required\n        results.append(f\"{acc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}