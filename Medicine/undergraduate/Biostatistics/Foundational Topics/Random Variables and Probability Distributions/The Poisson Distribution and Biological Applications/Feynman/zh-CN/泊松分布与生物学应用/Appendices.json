{
    "hands_on_practices": [
        {
            "introduction": "在生物学中应用泊松分布时，我们常常需要考虑观测努力度的差异，例如不同的采样时间或区域。本练习将指导你从第一性原理出发，构建一个包含“偏移量”项的泊松广义线性模型（GLM），以处理这种变异 。你将亲手推导最大似然估计量（MLEs），从而深刻理解这些模型如何将原始计数数据与有意义的生物学效应联系起来。",
            "id": "4960760",
            "problem": "一项实地研究监测了两个生境中寄生虫感染的发生率，在不同抽样单元间的观测投入不均等。令 $Y_{i}$ 表示单元 $i$ 的新增感染计数，令 $E_{i}$ 表示该单元的观测投入（暴露）。假设 $Y_{i}$ 是独立的，并服从适用于稀有事件计数的泊松模型，该模型使用对数连接函数和暴露的偏移量：\n$$\n\\log(\\mu_{i}) \\;=\\; \\log(E_{i}) \\;+\\; \\alpha \\;+\\; \\beta x_{i},\n$$\n其中 $\\mu_{i} = \\mathbb{E}[Y_{i}]$，$x_{i} \\in \\{0,1\\}$ 是一个表示生境的二元预测变量（$x_{i}=0$ 代表生境 A，$x_{i}=1$ 代表生境 B），$\\alpha$ 是截距，$\\beta$ 是生境效应的系数。由于在 $x_{i}$ 的两个水平上都有观测值，因此不存在协变量共线性。数据如下：\n- 生境 A ($x_{i}=0$)：$(E_{i},Y_{i}) \\in \\{(1.2,3),(0.8,1),(1.5,2),(0.5,0)\\}$，\n- 生境 B ($x_{i}=1$)：$(E_{i},Y_{i}) \\in \\{(1.0,5),(2.0,9),(1.3,4),(0.7,3)\\}$。\n\n任务：\n1. 从泊松概率质量函数和广义线性模型（GLM）关于对数连接和偏移量的定义出发，通过求对数似然函数关于 $(\\alpha,\\beta)$ 的偏导数并令其为零，构建得分方程。\n2. 将得分方程具体化到单个二元预测变量 $x_{i}\\in\\{0,1\\}$ 的情况，并推导出最大似然估计量（MLEs）$\\widehat{\\alpha}$ 和 $\\widehat{\\beta}$ 关于 $Y_{i}$ 和 $E_{i}$ 分组总和的闭式表达式。\n3. 使用所提供的数据，计算最大似然估计量 $\\widehat{\\beta}$ 的数值。将答案四舍五入到四位有效数字。最终报告的数字不包含单位。",
            "solution": "该问题陈述经评估有效。它在科学上基于广义线性模型（GLM）理论，这是现代统计学的基石，并且其在生物计数数据上的应用是恰当的。该问题设定良好，提供了所有必要信息、清晰的模型规范以及足以进行所要求的推导和计算的数据集。术语精确客观，任务是统计理论与应用中一个标准的、有一定难度的练习。因此，有必要给出完整解答。\n\n### 1. 得分方程的推导\n\n第一个任务是构建参数 $(\\alpha, \\beta)$ 的得分方程。得分方程通过将对数似然函数关于参数的一阶偏导数设为零来获得。\n\n令 $Y_i$ 为单元 $i$ 的观测计数，假设其服从均值为 $\\mu_i$ 的泊松分布，即 $Y_i \\sim \\text{Poisson}(\\mu_i)$。单个观测值 $Y_i=y_i$ 的概率质量函数（PMF）为：\n$$\nP(Y_i = y_i | \\mu_i) = \\frac{\\mu_i^{y_i} \\exp(-\\mu_i)}{y_i!}\n$$\n单个观测值的对数似然 $\\ell_i$ 是概率质量函数的自然对数：\n$$\n\\ell_i(\\mu_i | y_i) = \\log\\left( P(Y_i = y_i | \\mu_i) \\right) = y_i \\log(\\mu_i) - \\mu_i - \\log(y_i!)\n$$\n问题指定了一个带有对数连接函数和暴露 $E_i$ 的偏移项的广义线性模型。线性预测器为 $\\eta_i = \\log(E_i) + \\alpha + \\beta x_i$。连接函数将均值 $\\mu_i$ 与线性预测器联系起来：\n$$\n\\log(\\mu_i) = \\eta_i = \\log(E_i) + \\alpha + \\beta x_i\n$$\n由此，我们可以将 $\\mu_i$ 表示为：\n$$\n\\mu_i = \\exp(\\log(E_i) + \\alpha + \\beta x_i) = E_i \\exp(\\alpha + \\beta x_i)\n$$\n将 $\\log(\\mu_i)$ 和 $\\mu_i$ 代入 $\\ell_i$ 的表达式中，我们得到以参数 $\\alpha$ 和 $\\beta$ 表示的观测值 $i$ 的对数似然：\n$$\n\\ell_i(\\alpha, \\beta) = y_i (\\log(E_i) + \\alpha + \\beta x_i) - E_i \\exp(\\alpha + \\beta x_i) - \\log(y_i!)\n$$\n假设 $n$ 个观测值是独立的，总对数似然 $L(\\alpha, \\beta)$ 是各个对数似然之和：\n$$\nL(\\alpha, \\beta) = \\sum_{i=1}^{n} \\ell_i(\\alpha, \\beta) = \\sum_{i=1}^{n} \\left[ y_i (\\log(E_i) + \\alpha + \\beta x_i) - E_i \\exp(\\alpha + \\beta x_i) - \\log(y_i!) \\right]\n$$\n得分向量由 $L(\\alpha, \\beta)$ 关于 $\\alpha$ 和 $\\beta$ 的偏导数组成。\n\n关于 $\\alpha$ 的偏导数是：\n$$\n\\frac{\\partial L}{\\partial \\alpha} = \\sum_{i=1}^{n} \\frac{\\partial}{\\partial \\alpha} \\left[ y_i \\alpha - E_i \\exp(\\alpha + \\beta x_i) \\right] = \\sum_{i=1}^{n} \\left[ y_i - E_i \\exp(\\alpha + \\beta x_i) \\right]\n$$\n回顾 $\\mu_i = E_i \\exp(\\alpha + \\beta x_i)$，这可以简化为：\n$$\n\\frac{\\partial L}{\\partial \\alpha} = \\sum_{i=1}^{n} (y_i - \\mu_i)\n$$\n关于 $\\beta$ 的偏导数是：\n$$\n\\frac{\\partial L}{\\partial \\beta} = \\sum_{i=1}^{n} \\frac{\\partial}{\\partial \\beta} \\left[ y_i \\beta x_i - E_i \\exp(\\alpha + \\beta x_i) \\right] = \\sum_{i=1}^{n} \\left[ y_i x_i - E_i x_i \\exp(\\alpha + \\beta x_i) \\right]\n$$\n这可以简化为：\n$$\n\\frac{\\partial L}{\\partial \\beta} = \\sum_{i=1}^{n} x_i (y_i - \\mu_i)\n$$\n将这些偏导数设为零，即可得到得分方程。令 $\\widehat{\\alpha}$ 和 $\\widehat{\\beta}$ 表示最大似然估计量（MLEs）。得分方程为：\n$$\n\\sum_{i=1}^{n} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta} x_i)) = 0\n$$\n$$\n\\sum_{i=1}^{n} x_i (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta} x_i)) = 0\n$$\n\n### 2. 闭式最大似然估计量的推导\n\n第二个任务是找到当 $x_i$ 是二元预测变量（$x_i \\in \\{0, 1\\}$）时，$\\widehat{\\alpha}$ 和 $\\widehat{\\beta}$ 的闭式表达式。我们将得分方程中的求和项分为两组：$x_i=0$（生境A）和 $x_i=1$（生境B）的组。\n\n令 $I_0 = \\{i | x_i = 0\\}$ 且 $I_1 = \\{i | x_i = 1\\}$。\n\n第一个得分方程变为：\n$$\n\\sum_{i \\in I_0} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta} \\cdot 0)) + \\sum_{i \\in I_1} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta} \\cdot 1)) = 0\n$$\n$$\n\\implies \\sum_{i \\in I_0} (Y_i - E_i \\exp(\\widehat{\\alpha})) + \\sum_{i \\in I_1} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta})) = 0\n$$\n第二个得分方程包含项 $x_i$，对于第一组而言，该项为零：\n$$\n\\sum_{i \\in I_0} 0 \\cdot (Y_i - E_i \\exp(\\widehat{\\alpha})) + \\sum_{i \\in I_1} 1 \\cdot (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta})) = 0\n$$\n$$\n\\implies \\sum_{i \\in I_1} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta})) = 0\n$$\n从第二个简化后的方程，我们可以解出项 $\\exp(\\widehat{\\alpha} + \\widehat{\\beta})$：\n$$\n\\sum_{i \\in I_1} Y_i = \\sum_{i \\in I_1} E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta}) = \\exp(\\widehat{\\alpha} + \\widehat{\\beta}) \\sum_{i \\in I_1} E_i\n$$\n$$\n\\implies \\exp(\\widehat{\\alpha} + \\widehat{\\beta}) = \\frac{\\sum_{i \\in I_1} Y_i}{\\sum_{i \\in I_1} E_i}\n$$\n现在将第二个方程的结果代回第一个方程。注意到第一个方程的第二部分 $\\sum_{i \\in I_1} (Y_i - E_i \\exp(\\widehat{\\alpha} + \\widehat{\\beta}))$，恰好是第二个得分方程设为零的部分。因此，第一个方程简化为：\n$$\n\\sum_{i \\in I_0} (Y_i - E_i \\exp(\\widehat{\\alpha})) = 0\n$$\n求解 $\\exp(\\widehat{\\alpha})$：\n$$\n\\sum_{i \\in I_0} Y_i = \\sum_{i \\in I_0} E_i \\exp(\\widehat{\\alpha}) = \\exp(\\widehat{\\alpha}) \\sum_{i \\in I_0} E_i\n$$\n$$\n\\implies \\exp(\\widehat{\\alpha}) = \\frac{\\sum_{i \\in I_0} Y_i}{\\sum_{i \\in I_0} E_i}\n$$\n对两个表达式取自然对数，得到闭式最大似然估计量。令 $Y_A = \\sum_{i \\in I_0} Y_i$，$E_A = \\sum_{i \\in I_0} E_i$，$Y_B = \\sum_{i \\in I_1} Y_i$，以及 $E_B = \\sum_{i \\in I_1} E_i$。\n$\\alpha$ 的最大似然估计量为：\n$$\n\\widehat{\\alpha} = \\ln\\left( \\frac{\\sum_{i: x_i=0} Y_i}{\\sum_{i: x_i=0} E_i} \\right) = \\ln\\left( \\frac{Y_A}{E_A} \\right)\n$$\n这表示生境 A 中背景发生率的对数。\n我们还有：\n$$\n\\widehat{\\alpha} + \\widehat{\\beta} = \\ln\\left( \\frac{\\sum_{i: x_i=1} Y_i}{\\sum_{i: x_i=1} E_i} \\right) = \\ln\\left( \\frac{Y_B}{E_B} \\right)\n$$\n$\\beta$ 的最大似然估计量通过相减得到：\n$$\n\\widehat{\\beta} = (\\widehat{\\alpha} + \\widehat{\\beta}) - \\widehat{\\alpha} = \\ln\\left( \\frac{Y_B}{E_B} \\right) - \\ln\\left( \\frac{Y_A}{E_A} \\right) = \\ln\\left( \\frac{Y_B/E_B}{Y_A/E_A} \\right)\n$$\n这是生境 B 与生境 A 之间发生率之比的对数，也称为对数率比。\n\n### 3. $\\beta$ 的最大似然估计量计算\n\n最后一个任务是使用所提供的数据计算 $\\widehat{\\beta}$ 的数值。\n\n生境 A ($x_i=0$) 的数据：$(E_i, Y_i) \\in \\{(1.2,3), (0.8,1), (1.5,2), (0.5,0)\\}$。\n- 生境 A 中的总观测计数：$Y_A = 3 + 1 + 2 + 0 = 6$。\n- 生境 A 中的总观测投入：$E_A = 1.2 + 0.8 + 1.5 + 0.5 = 4.0$。\n\n生境 B ($x_i=1$) 的数据：$(E_i, Y_i) \\in \\{(1.0,5), (2.0,9), (1.3,4), (0.7,3)\\}$。\n- 生境 B 中的总观测计数：$Y_B = 5 + 9 + 4 + 3 = 21$。\n- 生境 B 中的总观测投入：$E_B = 1.0 + 2.0 + 1.3 + 0.7 = 5.0$。\n\n现在我们计算每个生境的估计发生率。\n- 生境 A 的估计发生率：$\\frac{Y_A}{E_A} = \\frac{6}{4.0} = 1.5$。\n- 生境 B 的估计发生率：$\\frac{Y_B}{E_B} = \\frac{21}{5.0} = 4.2$。\n\n使用推导出的 $\\widehat{\\beta}$ 公式：\n$$\n\\widehat{\\beta} = \\ln\\left( \\frac{Y_B/E_B}{Y_A/E_A} \\right) = \\ln\\left( \\frac{4.2}{1.5} \\right) = \\ln(2.8)\n$$\n计算数值：\n$$\n\\widehat{\\beta} \\approx 1.029619417...\n$$\n四舍五入到四位有效数字，我们注意到第五位有效数字是 6，所以我们将第四位数字（9）向上取整。这会导致进位。\n$$\n\\widehat{\\beta} \\approx 1.030\n$$\n末尾的零是有效数字，必须保留。",
            "answer": "$$\\boxed{1.030}$$"
        },
        {
            "introduction": "泊松模型的一个关键假设是计数的方差等于其均值。然而在现实中，生物学数据常常违反这一假设，表现出“过度离散”的现象。本练习将教你一项至关重要的诊断技能：如何在广义线性模型的框架下，使用皮尔逊卡方统计量来检验过度离散 。掌握这一技能可以帮助你验证模型假设，并判断是否需要更复杂的替代模型。",
            "id": "4960753",
            "problem": "一项实地研究量化了在具有不同环境条件的湿地中放置的 $n$ 个独立捕蚊器中每个捕蚊器的蚊子幼虫数量。研究人员拟合了一个具有泊松响应的对数线性广义线性模型(GLM)，使用 $p$ 个回归参数（包括截距）来解释第 $i$ 个捕蚊器中的平均计数 $\\mu_i$。在泊松分布的等离散性下，每个计数满足 $\\operatorname{Var}(Y_i)=\\mu_i$ 和 $\\mathbb{E}(Y_i)=\\mu_i$，且不同捕蚊器的 $Y_i$ 相互独立。通过最大似然法拟合GLM后，获得了估计的均值 $\\hat{\\mu}_i$ 和回归参数。考虑 Pearson 统计量\n$$\nX_P^2=\\sum_{i=1}^{n}\\frac{(Y_i-\\hat{\\mu}_i)^2}{\\hat{\\mu}_i}.\n$$\n要求您使用离散度估计 $\\hat{\\phi}_P=X_P^2$ 除以其自由度来构建一个过度离散检验，并分析其在等离散情况下的零分布。\n\n从泊松分布的定义性质和最大似然估计量的大样本行为出发，推导在正确指定的泊松GLM下 $X_P^2$ 的大样本零分布，并由此推导出 $\\hat{\\phi}_P=X_P^2/(n-p)$ 的近似零分布。使用此结果提出一个针对备择假设 $\\phi1$ 的过度离散的渐近单侧检验，并解释如何计算其 $p$ 值。\n\n然后，将您的检验应用于以下来自蚊子幼虫数据的拟合模型摘要：捕蚊器数量为 $n=120$，拟合的回归参数数量为 $p=6$，计算出的 Pearson 统计量为 $X_P^2=180$。根据您的推导，从以下选项中确定正确的陈述，该陈述指定了用于检验过度离散的适当检验统计量、其在等离散下的零分布、正确的自由度以及最终的 $p$ 值。\n\n选择一个选项：\n\nA. 检验使用 $\\hat{\\phi}_P=X_P^2/(n-p)$，备择假设为单侧的 $\\phi1$。在等离散情况下，$X_P^2$ 近似服从自由度为 $n-p$ 的 $\\chi^2$ 分布，因此 $\\mathbb{E}(\\hat{\\phi}_P)\\approx 1$ 且 $\\operatorname{Var}(\\hat{\\phi}_P)\\approx 2/(n-p)$。$p$ 值为 $P\\!\\left(\\chi^2_{114}\\ge 180\\right)$，等价于 $P\\!\\left(Z\\ge \\dfrac{180-114}{\\sqrt{2\\cdot 114}}\\right)$，约等于 $6\\times 10^{-6}$。\n\nB. 检验使用偏差(deviance)除以 $n$，备择假设为双侧的。在等离散情况下，该比率精确服从均值为 $1$、方差为 $1/n$ 的泊松分布，因此对于 $n=120$， $p$ 值约等于 $0.05$。\n\nC. 检验使用 $\\hat{\\phi}_P=X_P^2/n$ 并将其与自由度为 $n-p$ 的学生 $t$ 分布进行比较；对于 $n=120$，$p=6$，$p$ 值为 $P\\!\\left(t_{114}\\ge 1.58\\right)\\approx 0.06$。\n\nD. 检验使用 $X_P^2$，备择假设为双侧的，并将其与自由度为 $n$ 的 $\\chi^2$ 分布进行比较；对于 $n=120$ 和 $X_P^2=180$，$p$ 值约等于 $0.02$。\n\nE. 检验使用 $\\hat{\\phi}_P=X_P^2/(n-p)$ 并假设在等离散情况下 $\\sqrt{X_P^2/(n-p)}$ 服从标准正态分布；对于 $n=120$，$p=6$，$p$ 值约等于 $0.08$。",
            "solution": "用户希望我验证问题陈述，如果有效，则为一个关于泊松广义线性模型(GLM)中过度离散检验的生物统计学问题推导解决方案。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **研究数据**：来自 $n$ 个独立捕蚊器的蚊子幼虫计数 $Y_i$。\n*   **模型**：具有泊松响应和 $p$ 个回归参数（包括截距）的对数线性 GLM。\n*   **均值和方差（在零假设下）**：对于每个计数 $Y_i$，模型假设等离散，其中 $\\mathbb{E}(Y_i) = \\mu_i$ 且 $\\operatorname{Var}(Y_i) = \\mu_i$。\n*   **估计值**：最大似然拟合提供了估计的均值 $\\hat{\\mu}_i$。\n*   **Pearson 统计量**：$X_P^2 = \\sum_{i=1}^{n}\\frac{(Y_i-\\hat{\\mu}_i)^2}{\\hat{\\mu}_i}$。\n*   **离散度估计**：$\\hat{\\phi}_P = X_P^2$ 除以其自由度。\n*   **任务**：\n    1.  在正确指定的泊松 GLM 下，推导 $X_P^2$ 的大样本零分布。\n    2.  推导 $\\hat{\\phi}_P = X_P^2/(n-p)$ 的近似零分布。\n    3.  提出一个针对过度离散 ($\\phi  1$) 的渐近单侧检验。\n    4.  将此检验应用于具体案例：$n=120$，$p=6$，$X_P^2=180$。\n*   **问题**：确定关于检验统计量、零分布、自由度和 p 值的正确陈述。\n\n**步骤2：使用已知条件进行验证**\n\n1.  **科学基础**：该问题基于广义线性模型的成熟统计理论，特别是泊松回归和过度离散的诊断。这些是生物统计学和生态学中的标准和关键主题。该问题在科学上是合理的。\n2.  **良态问题**：问题定义清晰。它要求推导一个标准的统计检验并将其应用于给定的数据集。所有必要的组成部分都已提供：模型、统计量、零假设（等离散，$\\phi=1$）、备择假设（过度离散，$\\phi  1$）以及 $n$、$p$ 和 $X_P^2$ 的数值。基于大样本统计理论存在唯一解。\n3.  **客观性**：问题以精确、客观和定量的语言陈述。它没有歧义和主观论断。\n4.  **缺陷核对清单**：该问题未违反任何列出的无效性标准。它在科学上是合理的、可形式化的、完整的、现实的并且是良态的。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。我将继续进行推导和求解。\n\n### 推导与求解\n\n问题要求对泊松GLM中的过度离散检验进行分析。当观测数据的方差大于模型预测的方差时，就会出现过度离散。对于泊松分布，方差等于均值（$\\operatorname{Var}(Y_i) = \\mathbb{E}(Y_i) = \\mu_i$）。对过度离散建模的一种常用方法是假设 $\\operatorname{Var}(Y_i) = \\phi \\mu_i$，其中 $\\phi$ 是离散参数。等离散的零假设对应于 $H_0: \\phi = 1$，过度离散的备择假设是 $H_A: \\phi  1$。\n\n**1. Pearson 统计量 $X_P^2$ 的分布**\n\nPearson 统计量由 $X_P^2 = \\sum_{i=1}^{n}\\frac{(Y_i-\\hat{\\mu}_i)^2}{\\hat{\\mu}_i}$ 给出。该统计量衡量观测计数 $Y_i$ 与拟合均值 $\\hat{\\mu}_i$ 之间的平方差，并按拟合均值（即泊松假设下的估计方差）进行缩放。\n\nGLM理论的一个基本结果指出，对于一个被正确指定并通过最大似然法拟合的模型，在大样本量 $n$ 的情况下，Pearson 统计量 $X_P^2$ 渐近服从卡方 ($\\chi^2$) 分布。\n\n该分布的自由度 ($df$) 是观测数 $n$ 减去估计的回归参数个数 $p$。这是因为估计 $p$ 个参数会对残差 ($Y_i - \\hat{\\mu}_i$) 引入 $p$ 个约束，从而将自由度从 $n$ 减少到 $n-p$。\n\n因此，在零假设 $H_0: \\phi = 1$ 下，Pearson 统计量的大样本分布为：\n$$X_P^2 \\sim \\chi^2_{n-p}$$\n\n**2. 离散度估计 $\\hat{\\phi}_P$ 的分布**\n\n问题将离散度估计 $\\hat{\\phi}_P$ 定义为 Pearson 统计量除以其自由度。根据上述分析，自由度为 $n-p$。因此，\n$$\\hat{\\phi}_P = \\frac{X_P^2}{n-p}$$\n该量也被称为每自由度的 Pearson 卡方统计量。它作为离散参数 $\\phi$ 的一个样本估计。\n\n为了找到 $\\hat{\\phi}_P$ 的近似零分布，我们使用 $\\chi^2$ 分布的性质。对于一个随机变量 $W \\sim \\chi^2_k$，其期望值为 $\\mathbb{E}(W) = k$，其方差为 $\\operatorname{Var}(W) = 2k$。\n\n将此应用于 $X_P^2 \\sim \\chi^2_{n-p}$：\n在 $H_0$ 下 $\\hat{\\phi}_P$ 的期望值为：\n$$\\mathbb{E}(\\hat{\\phi}_P) = \\mathbb{E}\\left(\\frac{X_P^2}{n-p}\\right) = \\frac{1}{n-p}\\mathbb{E}(X_P^2) \\approx \\frac{n-p}{n-p} = 1$$\n在 $H_0$ 下 $\\hat{\\phi}_P$ 的方差为：\n$$\\operatorname{Var}(\\hat{\\phi}_P) = \\operatorname{Var}\\left(\\frac{X_P^2}{n-p}\\right) = \\frac{1}{(n-p)^2}\\operatorname{Var}(X_P^2) \\approx \\frac{2(n-p)}{(n-p)^2} = \\frac{2}{n-p}$$\n在零假设下，我们期望离散度估计 $\\hat{\\phi}_P$ 接近于 $1$。\n\n**3. 过度离散检验**\n\n假设检验为：\n$H_0: \\phi = 1$ (等离散)\n$H_A: \\phi  1$ (过度离散)\n\n该检验是单侧的，因为低度离散 ($\\phi  1$) 在实践中很少见，而过度离散是主要关注的问题。一个显著大于 $1$ 的 $\\hat{\\phi}_P$ 值提供了反对 $H_0$ 的证据。\n\n该检验可以通过将观测到的 $X_P^2$ 值与其零分布 $\\chi^2_{n-p}$ 进行比较来执行。p值是在假设零假设为真的情况下，观测到与数据计算出的检验统计量一样极端或更极端的概率。\n$$p\\text{-值} = P(X \\ge X_P^2_{\\text{obs}}), \\quad \\text{其中 } X \\sim \\chi^2_{n-p}$$\n\n对于大的自由度 $k$，$\\chi^2_k$ 分布可以近似为正态分布 $N(k, 2k)$。这允许使用标准正态 ($Z$) 分布来计算 p 值：\n$$Z = \\frac{\\chi^2_k - k}{\\sqrt{2k}} \\sim N(0, 1)$$\n因此，p 值可以近似为：\n$$p\\text{-值} \\approx P\\left(Z \\ge \\frac{X_P^2_{\\text{obs}} - (n-p)}{\\sqrt{2(n-p)}}\\right)$$\n\n**4. 在数据上的应用**\n\n给定数据：\n*   捕蚊器数量, $n = 120$\n*   参数数量, $p = 6$\n*   观测到的 Pearson 统计量, $X_P^2_{\\text{obs}} = 180$\n\n首先，计算自由度：\n$df = n-p = 120 - 6 = 114$\n\n检验统计量为 $X_P^2 = 180$，在 $H_0$ 下，其分布近似为 $\\chi^2_{114}$。离散度估计为 $\\hat{\\phi}_P = \\frac{180}{114} \\approx 1.579$。该值显著大于 $1$，表明存在过度离散的证据。\n\n为了量化这一证据，我们计算 p 值：\n$$p\\text{-值} = P(\\chi^2_{114} \\ge 180)$$\n\n由于自由度 ($df=114$) 很大，我们可以使用正态近似：\n$$Z = \\frac{180 - 114}{\\sqrt{2 \\times 114}} = \\frac{66}{\\sqrt{228}}$$\n$$\\sqrt{228} \\approx 15.0997$$\n$$Z \\approx \\frac{66}{15.0997} \\approx 4.371$$\np 值是标准正态分布右尾的面积：\n$$p\\text{-值} \\approx P(Z \\ge 4.371)$$\n这是一个非常小的概率。例如，$P(Z  3.5) \\approx 0.00023$。一个 $4.371$ 的Z分数对应一个极小的p值，数量级为 $10^{-6}$。$6 \\times 10^{-6}$ 这个值是该概率的一个合理近似。\n\n### 逐项分析选项\n\n*   **A. 检验使用 $\\hat{\\phi}_P=X_P^2/(n-p)$，备择假设为单侧的 $\\phi1$。在等离散情况下，$X_P^2$ 近似服从自由度为 $n-p$ 的 $\\chi^2$ 分布，因此 $\\mathbb{E}(\\hat{\\phi}_P)\\approx 1$ 且 $\\operatorname{Var}(\\hat{\\phi}_P)\\approx 2/(n-p)$。$p$ 值为 $P\\!\\left(\\chi^2_{114}\\ge 180\\right)$，等价于 $P\\!\\left(Z\\ge \\dfrac{180-114}{\\sqrt{2\\cdot 114}}\\right)$，约等于 $6\\times 10^{-6}$。**\n    该陈述正确地指出了针对过度离散的单侧备择假设。它正确地说明了在零假设下 $X_P^2 \\sim \\chi^2_{n-p}$。它正确地推导了离散度估计量 $\\hat{\\phi}_P$ 的近似期望和方差。它正确地构建了 p 值的计算，同时使用了具有正确自由度 ($114$) 的 $\\chi^2$ 分布及其正态近似。p 值的数值与计算结果一致。此陈述的所有部分都与统计理论相符。\n    **结论：正确。**\n\n*   **B. 检验使用偏差(deviance)除以 $n$，备择假设为双侧的。在等离散情况下，该比率精确服从均值为 $1$、方差为 $1/n$ 的泊松分布，因此对于 $n=120$， $p$ 值约等于 $0.05$。**\n    该陈述在多个方面都是错误的。首先，不能保证用于离散度的检验统计量服从泊松分布。Pearson 统计量和偏差(deviance)近似服从 $\\chi^2$ 分布。其次，分母应该是自由度 ($n-p$)，而不是样本量 ($n$)。第三，过度离散的备择假设通常是单侧的 ($\\phi  1$)，而不是双侧的。第四，声称*精确*服从泊松分布是错误的。\n    **结论：不正确。**\n\n*   **C. 检验使用 $\\hat{\\phi}_P=X_P^2/n$ 并将其与自由度为 $n-p$ 的学生 $t$ 分布进行比较；对于 $n=120$，$p=6$，$p$ 值为 $P\\!\\left(t_{114}\\ge 1.58\\right)\\approx 0.06$。**\n    该陈述是错误的。离散度估计量 $\\hat{\\phi}_P$ 的定义中分母是 $n-p$，而不是 $n$。检验统计量的零分布基于 $\\chi^2$ 分布，而不是学生 $t$ 分布。在这种情况下，$t$ 分布与检验整体拟合优度或离散度无关。\n    **结论：不正确。**\n\n*   **D. 检验使用 $X_P^2$，备择假设为双侧的，并将其与自由度为 $n$ 的 $\\chi^2$ 分布进行比较；对于 $n=120$ 和 $X_P^2=180$，$p$ 值约等于 $0.02$。**\n    该陈述是错误的。$\\chi^2$ 分布的自由度是 $n-p = 114$，而不是 $n=120$。此外，我们感兴趣的备择假设是单侧的。最后，$P(\\chi^2_{120}  180)$ 的 p 值约等于 $1.8 \\times 10^{-4}$，而不是 $0.02$。\n    **结论：不正确。**\n\n*   **E. 检验使用 $\\hat{\\phi}_P=X_P^2/(n-p)$ 并假设在等离散情况下 $\\sqrt{X_P^2/(n-p)}$ 服从标准正态分布；对于 $n=120$，$p=6$，$p$ 值约等于 $0.08$。**\n    该陈述是错误的。离散度估计 $\\hat{\\phi}_P$ 是一个经过缩放的 $\\chi^2$ 变量，它总是非负的。它的平方根不可能服从标准正态分布，因为标准正态变量的均值为 $0$，且可取正值和负值。正确的标准化方法是减去均值并除以标准差，如选项 A 的推导中所述，这会得到一个 Z 分数，而不是假设 $\\sqrt{\\hat{\\phi}_P}$ 是一个 Z 分数。\n    **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "过度离散不仅仅是一个统计上的麻烦，它常常指向背后有趣的生物学过程。本练习将挑战你剖析两种不同情景下的方差来源：聚集性事件（复合泊松过程）和个体异质性（混合泊松过程）。通过运用全期望定律和全方差定律，你将看到不同的机制如何产生统计上相似的模式，这突显了将统计模型与生物学机制相结合的重要性。",
            "id": "4960763",
            "problem": "一位生物统计学家研究鱼类体内的寄生虫负荷。对于在标准化的鳃洗实验中每条鱼所回收的寄生虫计数，正在考虑两种机理假设。\n\n假设 1 (复合泊松簇大小之和): 寄生虫的定殖以离散的沉积事件发生。每条鱼的沉积事件数，记为 $N$，服从速率参数为 $\\lambda$ 的泊松分布。给定 $N$，每个事件贡献一个随机大小为 $Y$ 的寄生虫簇，总负荷为 $S = \\sum_{i=1}^{N} Y_i$，其中事件大小 $(Y_i)$ 是独立同分布的 (i.i.d.) 且独立于 $N$。在特定环境中，定殖事件以速率 $\\lambda = 5$ 发生，事件大小分布的均值为 $E(Y) = 3$，方差为 $\\operatorname{Var}(Y) = 2$。\n\n假设 2 (因速率异质性导致的混合泊松计数): 单个寄生虫的到达遵循一个泊松过程，其宿主特定速率 $\\Lambda$ 因鱼之间的生物学异质性而变化。在给定 $\\Lambda$ 的条件下，寄生虫计数为 $N \\mid \\Lambda \\sim \\text{Poisson}(\\Lambda)$。在所有鱼中，该速率的均值为 $E(\\Lambda) = \\mu$，方差为 $\\operatorname{Var}(\\Lambda) = \\sigma^2$。在可比较的情况下，宿主特定速率满足 $E(\\Lambda) = \\mu = 15$ 和 $\\operatorname{Var}(\\Lambda) = \\sigma^2 = 40$。\n\n根据泊松过程的定义、独立性结构以及全期望定律和全方差定律（不直接使用快捷公式），确定以下哪些陈述是正确的。\n\nA. 在假设 $1$ 下，当 $\\lambda = 5$ 时，$E(S) = 15$ 且 $\\operatorname{Var}(S) = 55$，超出均值的额外方差反映了除泊松计数变异外，事件大小 $Y$ 的随机性。\n\nB. 在假设 $2$ 下，当 $E(\\Lambda) = 15$ 和 $\\operatorname{Var}(\\Lambda) = 40$ 时，$E(N) = 15$ 且 $\\operatorname{Var}(N) = 55$，超出均值的额外方差反映了宿主间到达率 $\\Lambda$ 的异质性。\n\nC. 因为在这个数值例子中，假设 $1$ 和假设 $2$ 产生相同的均值和方差，所以它们必然意味着计数具有相同的完整分布，因此从任何数据集中都无法从机理上区分它们。\n\nD. 如果在假设 $1$ 中，事件大小是确定性的，即 $Y \\equiv 1$，那么 $S$ 的方差将等于其均值（$\\operatorname{Var}(S) = E(S)$），从而消除了过度离散，除非引入了速率异质性。\n\nE. 在假设 $1$ 中，当 $N \\sim \\text{Poisson}(\\lambda)$ 且事件大小 $Y$ 是独立同分布时，$S$ 的方差就是 $\\lambda \\operatorname{Var}(Y)$；任何涉及 $[E(Y)]^2$ 的贡献仅发生在泊松速率的混合模型中。",
            "solution": "用户要求对问题陈述进行严格验证，然后进行完整推导并评估所提供的选项，同时遵守严格的格式规则。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题陈述为鱼类的寄生虫计数提供了两种假设。\n\n**假设 1 (复合泊松):**\n-   沉积事件的数量 $N$ 服从泊松分布：$N \\sim \\text{Poisson}(\\lambda)$。\n-   总寄生虫负荷是簇大小的总和：$S = \\sum_{i=1}^{N} Y_i$。\n-   簇大小 $Y_i$ 是独立同分布 (i.i.d.) 的随机变量。\n-   簇大小 $Y_i$ 独立于事件数 $N$。\n-   参数值为：$\\lambda = 5$，$E(Y) = 3$，$\\operatorname{Var}(Y) = 2$。\n\n**假设 2 (混合泊松):**\n-   寄生虫计数 $N$，在给定宿主特定速率 $\\Lambda$ 的条件下，服从泊松分布：$N \\mid \\Lambda \\sim \\text{Poisson}(\\Lambda)$。\n-   速率 $\\Lambda$ 是一个在鱼之间变化的随机变量。\n-   速率分布的矩为：$E(\\Lambda) = \\mu = 15$，$\\operatorname{Var}(\\Lambda) = \\sigma^2 = 40$。\n\n**指令：**\n-   推导必须基于第一性原理：全期望定律和全方差定律。不得直接调用快捷公式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题在科学上是合理的。复合泊松过程和混合泊松过程都是生物统计学和生态学中标准的、广泛使用的随机模型，用于描述表现出过度离散（方差大于均值）的计数数据，这是寄生虫负荷等生物计数中的常见现象。该场景是现实的。\n2.  **适定性：** 该问题是适定的。它提供了两个明确定义的随机模型，以及计算所得计数分布的前两个矩（均值和方差）所需的所有必要参数。问题要求基于这些模型进行计算和评估陈述，这是一个可解且有唯一答案的任务。\n3.  **客观性：** 问题以精确、客观的数学和统计术语陈述。没有主观语言。\n4.  **完整性和一致性：** 设置是完整的。所需计算的所有参数（假设 1 的 $\\lambda$，$E(Y)$，$\\operatorname{Var}(Y)$；假设 2 的 $E(\\Lambda)$，$\\operatorname{Var}(\\Lambda)$）都已提供。给定信息中没有矛盾之处。\n5.  **不现实或不可行性：** 参数值对于生物学研究是合理的，并且在数学上是一致的。\n6.  **琐碎或同义反复：** 该问题并非琐碎。它要求将全期望定律和全方差定律正确应用于两个不同且细致的随机模型，并理解每个模型中方差的来源。\n7.  **未发现其他缺陷。**\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效的**。解决方案将继续进行推导和选项分析。\n\n### 基于第一性原理的推导\n\n**假设 1：复合泊松和 ($S = \\sum_{i=1}^{N} Y_i$)**\n\n问题要求使用全期望定律和全方差定律推导 $E(S)$ 和 $\\operatorname{Var}(S)$。\n\n**1. S 的均值, $E(S)$:**\n使用全期望定律：$E(S) = E[E(S \\mid N)]$。\n首先，我们求在给定 $N=n$ 时 $S$ 的条件期望：\n$E(S \\mid N=n) = E\\left[\\sum_{i=1}^{n} Y_i \\mid N=n\\right]$。\n由于 $Y_i$ 独立于 $N$，这可以简化为 $E\\left[\\sum_{i=1}^{n} Y_i\\right]$。\n根据期望的线性性质以及 $Y_i$ 是同分布的，我们有：\n$E\\left[\\sum_{i=1}^{n} Y_i\\right] = \\sum_{i=1}^{n} E(Y_i) = n E(Y)$。\n所以，随机变量 $E(S \\mid N)$ 是 $N E(Y)$。\n现在，我们对 $N$ 求期望：\n$E(S) = E[N E(Y)] = E(N) E(Y)$。\n因为 $N \\sim \\text{Poisson}(\\lambda)$，其均值为 $E(N) = \\lambda$。\n因此，$E(S) = \\lambda E(Y)$。\n\n**2. S 的方差, $\\operatorname{Var}(S)$:**\n使用全方差定律：$\\operatorname{Var}(S) = E[\\operatorname{Var(S \\mid N)}] + \\operatorname{Var}[E(S \\mid N)]$。\n我们分别计算每一项：\n-   **第一项：$E[\\operatorname{Var}(S \\mid N)]$**\n    我们需要在给定 $N=n$ 时 $S$ 的条件方差：\n    $\\operatorname{Var}(S \\mid N=n) = \\operatorname{Var}\\left[\\sum_{i=1}^{n} Y_i \\mid N=n\\right]$。\n    由于 $Y_i$ 独立于 $N$ 且是独立同分布的，和的方差是方差的和：\n    $\\operatorname{Var}\\left[\\sum_{i=1}^{n} Y_i\\right] = \\sum_{i=1}^{n} \\operatorname{Var}(Y_i) = n \\operatorname{Var}(Y)$。\n    所以，随机变量 $\\operatorname{Var}(S \\mid N)$ 是 $N \\operatorname{Var}(Y)$。\n    对 $N$ 求期望：$E[N \\operatorname{Var}(Y)] = E(N) \\operatorname{Var}(Y) = \\lambda \\operatorname{Var}(Y)$。\n-   **第二项：$\\operatorname{Var}[E(S \\mid N)]$**\n    从均值的计算中，我们知道 $E(S \\mid N) = N E(Y)$。\n    我们需要这个随机变量的方差：\n    $\\operatorname{Var}[N E(Y)] = [E(Y)]^2 \\operatorname{Var}(N)$。\n    因为 $N \\sim \\text{Poisson}(\\lambda)$，其方差为 $\\operatorname{Var}(N) = \\lambda$。\n    所以，$\\operatorname{Var}[E(S \\mid N)] = [E(Y)]^2 \\lambda$。\n合并两项：\n$\\operatorname{Var}(S) = \\lambda \\operatorname{Var}(Y) + \\lambda [E(Y)]^2 = \\lambda (\\operatorname{Var}(Y) + [E(Y)]^2)$。\n\n**假设 2：混合泊松计数 ($N$)**\n\n问题要求使用全期望定律和全方差定律推导 $E(N)$ 和 $\\operatorname{Var}(N)$。\n\n**1. N 的均值, $E(N)$:**\n使用全期望定律：$E(N) = E[E(N \\mid \\Lambda)]$。\n对于速率为 $\\Lambda$ 的泊松分布，条件均值为 $E(N \\mid \\Lambda) = \\Lambda$。\n对 $\\Lambda$ 的分布求期望：\n$E(N) = E[\\Lambda]$。\n问题定义了 $E(\\Lambda) = \\mu$。所以，$E(N) = \\mu$。\n\n**2. N 的方差, $\\operatorname{Var}(N)$:**\n使用全方差定律：$\\operatorname{Var}(N) = E[\\operatorname{Var(N \\mid \\Lambda)}] + \\operatorname{Var}[E(N \\mid \\Lambda)]$。\n我们分别计算每一项：\n-   **第一项：$E[\\operatorname{Var}(N \\mid \\Lambda)]$**\n    对于速率为 $\\Lambda$ 的泊松分布，条件方差等于均值：$\\operatorname{Var}(N \\mid \\Lambda) = \\Lambda$。\n    对 $\\Lambda$ 的分布求期望：$E[\\Lambda] = \\mu$。\n-   **第二项：$\\operatorname{Var}[E(N \\mid \\Lambda)]$**\n    从均值的计算中，我们知道 $E(N \\mid \\Lambda) = \\Lambda$。\n    这个随机变量的方差就是 $\\operatorname{Var}(\\Lambda)$。\n    问题定义了 $\\operatorname{Var}(\\Lambda) = \\sigma^2$。\n合并两项：\n$\\operatorname{Var}(N) = \\mu + \\sigma^2$。\n\n### 数值计算与选项分析\n\n**应用假设 1 的值：**\n$\\lambda = 5$，$E(Y) = 3$，$\\operatorname{Var}(Y) = 2$。\n$E(S) = \\lambda E(Y) = 5 \\times 3 = 15$。\n$\\operatorname{Var}(S) = \\lambda (\\operatorname{Var}(Y) + [E(Y)]^2) = 5 \\times (2 + 3^2) = 5 \\times (2+9) = 5 \\times 11 = 55$。\n\n**应用假设 2 的值：**\n$\\mu = 15$，$\\sigma^2 = 40$。\n$E(N) = \\mu = 15$。\n$\\operatorname{Var}(N) = \\mu + \\sigma^2 = 15 + 40 = 55$。\n\n**逐项分析选项：**\n\n**A. 在假设 $1$ 下，当 $\\lambda = 5$ 时，$E(S) = 15$ 且 $\\operatorname{Var}(S) = 55$，超出均值的额外方差反映了除泊松计数变异外，事件大小 $Y$ 的随机性。**\n我们的计算证实了 $E(S) = 15$ 和 $\\operatorname{Var}(S) = 55$。方差大于均值（$55 > 15$），这种情况被称为过度离散。方差公式 $\\operatorname{Var}(S) = \\lambda \\operatorname{Var}(Y) + \\lambda [E(Y)]^2$ 显示了两个变异来源。$\\lambda [E(Y)]^2$ 项可以解释为由随机事件数（$N$）引起的方差，并按平均事件大小的平方进行缩放。$\\lambda \\operatorname{Var}(Y)$ 项是由事件大小本身的可变性引起的方差。该陈述正确地指出，总方差以及因此产生的过度离散，是由于 $Y$ 的随机性（其均值大于 1 及其自身的方差）作用于泊松事件计数器 $N$ 的基本随机性之上。该陈述是一个准确的定性描述。\n**结论：正确。**\n\n**B. 在假设 $2$ 下，当 $E(\\Lambda) = 15$ 和 $\\operatorname{Var}(\\Lambda) = 40$ 时，$E(N) = 15$ 且 $\\operatorname{Var}(N) = 55$，超出均值的额外方差反映了宿主间到达率 $\\Lambda$ 的异质性。**\n我们的计算证实了 $E(N) = 15$ 和 $\\operatorname{Var}(N) = 55$。额外方差（或过度离散）是 $\\operatorname{Var}(N) - E(N) = 55 - 15 = 40$。我们推导出的方差公式是 $\\operatorname{Var}(N) = E(\\Lambda) + \\operatorname{Var}(\\Lambda)$。因此，过度离散是 $\\operatorname{Var}(N) - E(N) = \\operatorname{Var}(\\Lambda) = \\sigma^2$。给定的 $\\sigma^2$ 值为 40。关于额外方差反映了到达率 $\\Lambda$ 的异质性的陈述是完全正确的；过度离散在数学上等同于速率参数 $\\Lambda$ 的方差。\n**结论：正确。**\n\n**C. 因为在这个数值例子中，假设 $1$ 和假设 $2$ 产生相同的均值和方差，所以它们必然意味着计数具有相同的完整分布，因此从任何数据集中都无法从机理上区分它们。**\n这个陈述是不正确的。概率分布并非由其前两个矩（均值和方差）唯一确定。虽然子分布的一些特定选择（例如，H1 中的对数级数分布的 $Y$ 和 H2 中的伽马分布的 $\\Lambda$）都可能导致负二项分布，但这并非普遍规律。总的来说，完整的分布将会不同。例如，我们可以比较观察到零计数的概率。\n- 在 H1 下：$P(S=0) = P(N=0) = e^{-\\lambda} = e^{-5} \\approx 0.0067$。\n- 在 H2 下：$P(N=0) = E[P(N=0 \\mid \\Lambda)] = E[e^{-\\Lambda}]$。根据 Jensen 不等式，对于凸函数 $f(x)=e^{-x}$，我们有 $E[e^{-\\Lambda}] \\ge e^{-E[\\Lambda]} = e^{-15}$。如果 $\\Lambda$ 不是常数，则不等式是严格的。\n零计数的概率是不同的（$e^{-5} \\neq E[e^{-\\Lambda}]$），所以分布是不同的。因此，这些模型在原则上可以通过足够的数据来区分。\n**结论：不正确。**\n\n**D. 如果在假设 $1$ 中，事件大小是确定性的，即 $Y \\equiv 1$，那么 $S$ 的方差将等于其均值（$\\operatorname{Var}(S) = E(S)$），从而消除了过度离散，除非引入了速率异质性。**\n如果对所有 $i$ 都有 $Y_i \\equiv 1$，那么 $E(Y)=1$ 且 $\\operatorname{Var}(Y)=0$。总负荷 $S$ 变为 $S = \\sum_{i=1}^{N} 1 = N$。因为 $N \\sim \\text{Poisson}(\\lambda)$，所以 $S \\sim \\text{Poisson}(\\lambda)$。对于泊松分布，均值为 $E(S) = \\lambda$，方差为 $\\operatorname{Var}(S) = \\lambda$。因此，$\\operatorname{Var}(S) = E(S)$。这个性质被称为等离散。过度离散（$\\operatorname{Var}(S)  E(S)$）确实被消除了。要重新引入过度离散，就需要一种不同的机制，例如假设 2 中描述的速率异质性。该陈述完全正确。\n**结论：正确。**\n\n**E. 在假设 $1$ 中，当 $N \\sim \\text{Poisson}(\\lambda)$ 且事件大小 $Y$ 是独立同分布时，$S$ 的方差就是 $\\lambda \\operatorname{Var}(Y)$；任何涉及 $[E(Y)]^2$ 的贡献仅发生在泊松速率的混合模型中。**\n这个陈述是错误的。正如从第一性原理推导出来的，假设 1 下的方差是 $\\operatorname{Var}(S) = \\lambda \\operatorname{Var}(Y) + \\lambda [E(Y)]^2$。该陈述错误地省略了第二项 $\\lambda [E(Y)]^2$。这一项直接源于复合泊松模型的结构，具体来说是源于条件期望的方差 $\\operatorname{Var}[E(S \\mid N)]$。声称这样一项只出现在泊松速率的混合模型中的说法也是错误的；这个模型是一个复合模型，而不是假设 2 意义上的混合模型。\n**结论：不正确。**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}