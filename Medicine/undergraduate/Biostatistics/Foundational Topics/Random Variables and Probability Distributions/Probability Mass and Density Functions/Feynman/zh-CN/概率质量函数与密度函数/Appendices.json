{
    "hands_on_practices": [
        {
            "introduction": "在生物统计学中，我们经常需要对随机变量进行变换，以满足特定模型的假设或改变其取值范围。例如，在风险建模中，将一个表示概率的变量（取值范围在 $(0,1)$）变换到整个实数轴上，是进行广义线性回归的关键一步。这个练习将带你实践变量变换的基本功，通过运用变量代换法则，从一个基础的Beta分布推导出其对数几率（logit）变换后的新概率密度函数。",
            "id": "4942226",
            "problem": "在一个关于个体风险的生物统计模型中，假设潜在风险概率 $X \\in (0,1)$ 服从一个参数为 $(\\alpha,\\beta)$ 的贝塔分布（$\\mathrm{Beta}(\\alpha,\\beta)$），其概率密度函数 (PDF) 为\n$$\nf_{X}(x) \\;=\\; \\frac{1}{B(\\alpha,\\beta)}\\, x^{\\alpha - 1}\\,(1-x)^{\\beta - 1}, \\quad x \\in (0,1),\n$$\n其中 $\\alpha0$, $\\beta0$，且 $B(\\alpha,\\beta)$ 表示贝塔函数。定义逻辑斯谛（logit）变换 $Z = \\log\\!\\left(\\frac{X}{1-X}\\right)$，该变换将 $(0,1)$ 映射到 $\\mathbb{R}$。\n\n从第一性原理出发——即概率密度函数的定义以及可微、单调的变量变换的定义——推导：\n- 从 $z$ 到 $x$ 的变换的雅可比行列式的绝对值，以及\n- $Z$ 的导出概率密度函数。\n\n您的推导过程必须清楚地确定每个变量的支撑集，并且只使用基本定义和公认事实，而不援引任何预先给出的变换公式。将您的最终答案表示为一个数对，该数对由雅可比行列式（作为 $z$ 的函数）和导出的概率密度函数 $f_{Z}(z)$ 组成，两者均需以精确的符号形式表示。不需要进行数值近似。",
            "solution": "问题陈述被评估为有效。它具有科学依据、提法恰当、客观且内容完整。它提出了一个概率论中的标准问题——推导变换后随机变量的概率密度函数（PDF）——使用了诸如贝塔分布和logit变换等已确立的概念，这些概念在生物统计学中是基础性的。陈述中没有不一致、歧义或事实错误。因此，我们可以进行推导。\n\n此推导的核心原理是概率密度函数的变量替换定理。设 $X$ 是一个连续随机变量，其概率密度函数为 $f_{X}(x)$，定义在支撑集 $S_{X}$ 上。设 $Z = g(X)$ 是一个新的随机变量，其中函数 $g$ 在 $S_{X}$ 上是连续可微且严格单调的。这确保了存在唯一的反函数 $X = h(Z) = g^{-1}(Z)$。$Z$ 的概率密度函数，记为 $f_{Z}(z)$，由以下公式给出：\n$$\nf_{Z}(z) = f_{X}(h(z)) \\left| \\frac{dh}{dz}(z) \\right|\n$$\n项 $\\left| \\frac{dh}{dz} \\right|$ 是反变换的雅可比行列式的绝对值。对于一维变换，这仅仅是反函数的导数的绝对值。$Z$ 的支撑集，记为 $S_{Z}$，是 $S_{X}$ 在变换 $g$ 下的像。\n\n首先，我们必须找到反变换 $x = h(z)$。给定的变换是 $z = g(x) = \\log\\left(\\frac{x}{1-x}\\right)$。为了求反函数，我们解出 $x$：\n$$\nz = \\ln\\left(\\frac{x}{1-x}\\right)\n$$\n对两边取以 $e$ 为底的指数：\n$$\n\\exp(z) = \\frac{x}{1-x}\n$$\n现在，我们整理方程以分离出 $x$：\n$$\n\\exp(z)(1-x) = x\n$$\n$$\n\\exp(z) - x\\exp(z) = x\n$$\n$$\n\\exp(z) = x + x\\exp(z)\n$$\n$$\n\\exp(z) = x(1 + \\exp(z))\n$$\n$$\nx = \\frac{\\exp(z)}{1+\\exp(z)}\n$$\n这就是反函数 $x = h(z)$。这个函数通常被称为逻辑斯谛S型函数（logistic sigmoid function）。\n\n接下来，我们确定新变量 $Z$ 的支撑集。$X$ 的支撑集是开区间 $(0,1)$。我们考察 $z = \\log\\left(\\frac{x}{1-x}\\right)$ 在该区间边界处的行为。\n当 $x \\to 0^{+}$ 时，分式 $\\frac{x}{1-x} \\to 0^{+}$，因此 $z = \\ln\\left(\\frac{x}{1-x}\\right) \\to -\\infty$。\n当 $x \\to 1^{-}$ 时，分母 $1-x \\to 0^{+}$，分式 $\\frac{x}{1-x} \\to +\\infty$，因此 $z = \\ln\\left(\\frac{x}{1-x}\\right) \\to +\\infty$。\n因此，$Z$ 的支撑集是整个实轴，$S_Z = (-\\infty, \\infty)$ 或 $\\mathbb{R}$，如问题中所述。\n\n现在，我们推导第一个要求的量：从 $z$ 到 $x$ 的变换的雅可比行列式的绝对值。这就是 $\\left|\\frac{dx}{dz}\\right|$。\n对 $x(z) = \\frac{\\exp(z)}{1+\\exp(z)}$ 使用微分的商法则：\n设 $u = \\exp(z)$ 且 $v = 1+\\exp(z)$。则 $u' = \\exp(z)$ 且 $v' = \\exp(z)$。\n$$\n\\frac{dx}{dz} = \\frac{u'v - uv'}{v^2} = \\frac{\\exp(z)(1+\\exp(z)) - \\exp(z)(\\exp(z))}{(1+\\exp(z))^2}\n$$\n$$\n\\frac{dx}{dz} = \\frac{\\exp(z) + \\exp(2z) - \\exp(2z)}{(1+\\exp(z))^2} = \\frac{\\exp(z)}{(1+\\exp(z))^2}\n$$\n由于对所有 $z \\in \\mathbb{R}$ 都有 $\\exp(z)  0$，导数 $\\frac{dx}{dz}$ 恒为正。这证实了该变换是严格单调递增的。因此，雅可比行列式的绝对值等于导数本身：\n$$\n\\left|\\frac{dx}{dz}\\right| = \\frac{\\exp(z)}{(1+\\exp(z))^2}\n$$\n\n最后，我们推导 $Z$ 的导出概率密度函数 $f_Z(z)$。我们从 $X$ 的概率密度函数开始：\n$$\nf_{X}(x) = \\frac{1}{B(\\alpha,\\beta)}\\, x^{\\alpha - 1}\\,(1-x)^{\\beta - 1}\n$$\n我们将 $x$ 替换为 $h(z) = \\frac{\\exp(z)}{1+\\exp(z)}$。我们还需要用 $z$ 表示 $1-x$ 的表达式：\n$$\n1-x = 1 - \\frac{\\exp(z)}{1+\\exp(z)} = \\frac{1+\\exp(z)-\\exp(z)}{1+\\exp(z)} = \\frac{1}{1+\\exp(z)}\n$$\n现在，将这些代入 $f_{X}(x)$：\n$$\nf_{X}(h(z)) = \\frac{1}{B(\\alpha,\\beta)} \\left(\\frac{\\exp(z)}{1+\\exp(z)}\\right)^{\\alpha-1} \\left(\\frac{1}{1+\\exp(z)}\\right)^{\\beta-1}\n$$\n合并分母中的项：\n$$\nf_{X}(h(z)) = \\frac{1}{B(\\alpha,\\beta)} \\frac{(\\exp(z))^{\\alpha-1}}{(1+\\exp(z))^{\\alpha-1}} \\frac{1}{(1+\\exp(z))^{\\beta-1}} = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1))}{(1+\\exp(z))^{\\alpha+\\beta-2}}\n$$\n现在，我们应用变量替换公式：\n$$\nf_Z(z) = f_X(h(z)) \\left|\\frac{dx}{dz}\\right|\n$$\n$$\nf_Z(z) = \\left( \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1))}{(1+\\exp(z))^{\\alpha+\\beta-2}} \\right) \\left( \\frac{\\exp(z)}{(1+\\exp(z))^2} \\right)\n$$\n通过将指数相加来合并分子和分母：\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1)) \\exp(z)}{(1+\\exp(z))^{\\alpha+\\beta-2} (1+\\exp(z))^2}\n$$\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1)+z)}{(1+\\exp(z))^{(\\alpha+\\beta-2)+2}}\n$$\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}}\n$$\n这就是随机变量 $Z$ 的概率密度函数，对所有 $z \\in \\mathbb{R}$ 均有定义。此分布被称为广义逻辑斯谛分布或对数贝塔分布。\n\n两个要求的量是雅可比行列式的绝对值 $\\frac{\\exp(z)}{(1+\\exp(z))^2}$ 和概率密度函数 $f_Z(z)$ $\\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\exp(z)}{(1+\\exp(z))^{2}},  \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了如何变换概率密度函数之后，我们可以利用这一思想来从特定的分布中*生成*随机数，这在生物统计学的模拟研究中至关重要。本练习将展示如何利用最简单的均匀分布，通过逆变换采样法生成服从指数分布的随机样本。指数分布是生存分析中的基石，常用于模拟事件发生前的等待时间。",
            "id": "4942189",
            "problem": "在一个关于具有恒定风险率的事件时间数据的生物统计学模拟研究中，假设一个齐次泊松过程中下一个事件的等待时间由一个率参数为 $\\lambda0$ 的指数分布建模。您需要实现逆变换采样，通过从单位区间上的均匀随机变量进行单次抽样来生成合成的生存时间。\n\n从以下基本定义出发：(i) 率参数为 $\\lambda$ 的指数分布的概率密度函数 (PDF) 是 $f(x)$，其支撑集为 $x\\geq 0$，并且是非负的，积分为 $1$；(ii) 连续随机变量的累积分布函数 (CDF) $F(x)$ 定义为 $F(x)=\\int_{-\\infty}^{x} f(t)\\,dt$。请推导指数分布 Exponential$(\\lambda)$ 的 CDF $F(x)$ 的显式形式。然后，对 $x$ 求解方程 $u=F(x)$，以获得 $0u1$ 范围内的逆 CDF $x=F^{-1}(u)$。通过从 $U \\sim \\mathrm{Unif}(0,1)$ 中抽取一个值来生成随机变量 $X$ 的最终表达式是什么？最后，通过推导所生成变量 $X$ 的 CDF 来严格验证您的结果，并证明它确实与指数分布的 CDF 相符。将 $X$ 作为 $U$ 和 $\\lambda$ 的函数的最终表达式作为您的答案。",
            "solution": "该问题要求推导使用逆变换法，从一个均匀随机变量 $U$ 生成一个服从率参数为 $\\lambda$ 的指数分布的随机变量 $X$ 的公式，并验证所得到的变量 $X$ 确实服从指定的指数分布。\n\n首先，我们验证问题陈述的有效性。\n该问题在科学上和数学上都是合理的，因为它基于概率论的基本原理，特别是指数分布、概率密度函数 (PDF)、累积分布函数 (CDF) 以及逆变换采样法。这是一个计算统计学和生物统计学中的标准、良态问题。该问题客观、完整，且不含矛盾或歧义。结论是该问题有效。\n\n我们按要求开始推导。\n\n第一个原理是率参数为 $\\lambda  0$ 的指数分布的 PDF 定义。代表等待时间的随机变量必须是非负的。其 PDF $f(x)$ 由下式给出：\n$$\nf(x) = \\begin{cases} \\lambda \\exp(-\\lambda x)  \\text{if } x \\geq 0 \\\\ 0  \\text{if } x  0 \\end{cases}\n$$\n对于 $\\lambda  0$，此函数是非负的，并且其积分为 $1$，因为 $\\int_{0}^{\\infty} \\lambda \\exp(-\\lambda x) \\,dx = [-\\exp(-\\lambda x)]_{0}^{\\infty} = 0 - (-1) = 1$。\n\n接下来，我们推导累积分布函数 (CDF) $F(x)$，其定义为 $F(x) = \\int_{-\\infty}^{x} f(t)\\,dt$。\n对于任何 $x  0$，PDF $f(t)$ 为 $0$，所以 $F(x) = \\int_{-\\infty}^{x} 0 \\,dt = 0$。\n对于任何 $x \\geq 0$，CDF 计算如下：\n$$\nF(x) = \\int_{-\\infty}^{x} f(t)\\,dt = \\int_{-\\infty}^{0} 0\\,dt + \\int_{0}^{x} \\lambda \\exp(-\\lambda t)\\,dt\n$$\n$$\nF(x) = 0 + \\lambda \\int_{0}^{x} \\exp(-\\lambda t)\\,dt\n$$\n$$\nF(x) = \\lambda \\left[ -\\frac{1}{\\lambda} \\exp(-\\lambda t) \\right]_{0}^{x} = \\left[ -\\exp(-\\lambda t) \\right]_{0}^{x}\n$$\n$$\nF(x) = (-\\exp(-\\lambda x)) - (-\\exp(-\\lambda \\cdot 0)) = -\\exp(-\\lambda x) - (-1) = 1 - \\exp(-\\lambda x)\n$$\n所以，指数分布 Exponential($\\lambda$) 的 CDF 为：\n$$\nF(x) = \\begin{cases} 1 - \\exp(-\\lambda x)  \\text{if } x \\geq 0 \\\\ 0  \\text{if } x  0 \\end{cases}\n$$\n\n逆变换法包括将 CDF 等于一个从区间 $(0, 1)$ 上的均匀分布中抽取的值 $u$，即 $u = F(x)$，然后对 $x$ 求解。这就得到了逆 CDF，$x = F^{-1}(u)$。我们已知 $U \\sim \\mathrm{Unif}(0,1)$，且 $X = F^{-1}(U)$。由于 $x \\geq 0$，$x$ 的一个有效解将把 $u \\in (0, 1)$ 映射到 $x \\in [0, \\infty)$。\n我们对给定的 $u \\in (0, 1)$ 求解关于 $x$ 的方程：\n$$\nu = 1 - \\exp(-\\lambda x)\n$$\n整理各项以解出 $x$：\n$$\n\\exp(-\\lambda x) = 1 - u\n$$\n对两边取自然对数：\n$$\n\\ln(\\exp(-\\lambda x)) = \\ln(1 - u)\n$$\n$$\n-\\lambda x = \\ln(1 - u)\n$$\n$$\nx = -\\frac{1}{\\lambda} \\ln(1 - u)\n$$\n这就是逆 CDF $F^{-1}(u)$ 的表达式。随机变量 $X$ 是通过将均匀随机变量 $U$ 替换 $u$ 生成的：\n$$\nX = F^{-1}(U) = -\\frac{1}{\\lambda} \\ln(1 - U)\n$$\n这就是所要求的最终表达式。\n\n最后，问题要求严格验证 $X = -\\frac{1}{\\lambda} \\ln(1 - U)$ 服从 Exponential($\\lambda$) 分布。我们将通过求出 $X$ 的 CDF（称之为 $G_X(x)$），并证明它与我们上面推导的 $F(x)$ 相同来完成此验证。$X$ 的 CDF 定义为 $G_X(x) = P(X \\leq x)$。\n\n首先，我们确定 $X$ 的支撑集。由于 $U \\sim \\mathrm{Unif}(0,1)$，$U$ 的取值范围是区间 $(0, 1)$。\n那么 $1-U$ 的取值范围也是 $(0, 1)$。\n自然对数 $\\ln(1-U)$ 的取值范围是 $(-\\infty, 0)$。\n由于 $\\lambda  0$，$-\\frac{1}{\\lambda}$ 是负数。\n因此，$X = -\\frac{1}{\\lambda} \\ln(1 - U)$ 的取值范围是 $(0, \\infty)$。\n$X$ 的支撑集是 $x  0$。这意味着对于任何 $x \\leq 0$，$G_X(x) = P(X \\leq x) = 0$。\n\n现在，对于 $x  0$，我们计算 $G_X(x)$：\n$$\nG_X(x) = P(X \\leq x) = P\\left(-\\frac{1}{\\lambda} \\ln(1 - U) \\leq x\\right)\n$$\n我们操作不等式以分离出 $U$：\n$$\n\\ln(1 - U) \\geq -\\lambda x\n$$\n(因为我们乘以了一个负数 $-\\lambda$，所以不等号反向)。\n我们对两边取指数。由于指数函数 $y \\mapsto \\exp(y)$ 是单调递增的，不等号方向保持不变：\n$$\n\\exp(\\ln(1 - U)) \\geq \\exp(-\\lambda x)\n$$\n$$\n1 - U \\geq \\exp(-\\lambda x)\n$$\n$$\n-U \\geq \\exp(-\\lambda x) - 1\n$$\n$$\nU \\leq 1 - \\exp(-\\lambda x)\n$$\n(因为我们乘以了 $-1$，所以不等号再次反向)。\n\n所以我们有：\n$$\nG_X(x) = P(U \\leq 1 - \\exp(-\\lambda x))\n$$\n由于 $U \\sim \\mathrm{Unif}(0,1)$，它的 CDF 是 $F_U(v) = P(U \\leq v) = v$，对于 $v \\in [0, 1]$。\n对于 $x  0$，项 $1 - \\exp(-\\lambda x)$ 在区间 $(0, 1)$ 内。令 $v = 1 - \\exp(-\\lambda x)$。\n那么，$G_X(x) = F_U(1 - \\exp(-\\lambda x)) = 1 - \\exp(-\\lambda x)$。\n\n综合所有情况，$X$ 的 CDF 是：\n$$\nG_X(x) = \\begin{cases} 1 - \\exp(-\\lambda x)  \\text{if } x \\geq 0 \\\\ 0  \\text{if } x  0 \\end{cases}\n$$\n这与我们之前推导出的指数分布 Exponential($\\lambda$) 的 CDF $F(x)$ 完全相同。通过对 $x \\geq 0$ 的 $G_X(x)$ 关于 $x$ 求导，我们将得到 PDF $f(x) = \\lambda \\exp(-\\lambda x)$，从而证实 $X$ 确实是一个率参数为 $\\lambda$ 的指数分布随机变量。验证完成。\n\n问题要求的是 $X$ 关于 $U$ 和 $\\lambda$ 的最终表达式。",
            "answer": "$$\n\\boxed{-\\frac{1}{\\lambda}\\ln(1 - U)}\n$$"
        },
        {
            "introduction": "既然我们已经能够操作和模拟概率分布，下一步自然就是将它们与观测数据相结合。这个练习将演示如何利用概率密度函数（如此处用于模拟等待时间的伽马分布）的数学形式来构建似然函数，并找到能够最佳解释数据的参数值。这一过程将理论上的概率分布与实际的统计推断紧密联系起来，是参数估计的核心方法。",
            "id": "4942238",
            "problem": "一个生物统计学团队在标准化测定中为每个受试者建模，直到发生固定数量的分子结合事件为止的总观察时间。对于每个受试者 $i \\in \\{1,\\dots,n\\}$，直到发生 $k$ 次事件的总等待时间 $X_i$ 被假定为独立同分布 (i.i.d.)，服从伽玛分布，其已知形状参数为 $k0$，未知尺度参数为 $\\theta0$，记作 $X_i \\sim \\mathrm{Gamma}(k,\\theta)$。$X_i$ 的概率密度函数 (PDF) 为\n$$\nf(x_i; k,\\theta) = \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}, \\quad x_i0,\n$$\n其中 $\\Gamma(k)$ 是伽玛函数。你观察到实现值 $x_1,\\dots,x_n$。\n\n从独立同分布样本的似然定义、得分函数 $U(\\theta)=\\frac{\\partial}{\\partial \\theta}\\ell(\\theta)$（其中 $\\ell(\\theta)$ 是对数似然）以及费雪信息 (FI) $I(\\theta)=-\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta^2}\\ell(\\theta)\\right]$ 的定义出发，推导得分函数 $U(\\theta)$ 和费雪信息 $I(\\theta)$ 的确切形式，并求解 $\\theta$ 的最大似然估计量 (MLE)，记作 $\\hat{\\theta}$。将你的最终答案表示为一个单行向量，其条目分别为 $U(\\theta)$、$I(\\theta)$ 和 $\\hat{\\theta}$，用 $n$、$k$ 和观测数据 $\\{x_i\\}_{i=1}^n$ 表示。提供精确表达式；无需四舍五入。",
            "solution": "用户提供了一个生物统计学领域的问题，具体关注伽玛分布的参数估计。我将首先验证问题陈述，如果有效，则提供完整的推导。\n\n### 步骤 1：提取已知条件\n-   数据由 $n$ 个独立同分布 (i.i.d.) 的随机变量 $X_i$ 组成，其中 $i \\in \\{1, \\dots, n\\}$。\n-   每个 $X_i$ 代表一个受试者等待 $k$ 次事件的总时间。\n-   每个 $X_i$ 的分布是伽玛分布，记作 $X_i \\sim \\mathrm{Gamma}(k,\\theta)$。\n-   形状参数 $k0$ 已知。\n-   尺度参数 $\\theta0$ 未知。\n-   概率密度函数 (PDF) 给出为 $f(x_i; k,\\theta) = \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}$，其中 $x_i0$。\n-   观测数据是一组实现值 $\\{x_1, \\dots, x_n\\}$。\n-   对数似然函数用 $\\ell(\\theta)$ 表示。\n-   得分函数定义为 $U(\\theta)=\\frac{\\partial}{\\partial \\theta}\\ell(\\theta)$。\n-   费雪信息 (FI) 定义为 $I(\\theta)=-\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta^2}\\ell(\\theta)\\right]$。\n-   $\\theta$ 的最大似然估计量 (MLE) 用 $\\hat{\\theta}$ 表示。\n-   任务是推导 $U(\\theta)$、$I(\\theta)$ 和 $\\hat{\\theta}$ 的确切形式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。这是最大似然估计理论中的一个标准练习，该理论是经典统计学的基石，并广泛应用于生物统计学。伽玛分布是模拟等待时间的常用且合适的模型。得分函数和费雪信息的定义是标准的。该问题是自洽的、适定的，没有歧义或矛盾。它既不微不足道也不过于复杂，代表了该领域的标准推导。因此，该问题被认为是**有效的**。\n\n### 步骤 3：结论与行动\n问题有效。我现在将进行求解。\n\n###\n解决方案包括三个主要部分：推导得分函数 $U(\\theta)$，找到最大似然估计量 $\\hat{\\theta}$，以及计算费雪信息 $I(\\theta)$。\n\n#### 似然函数和对数似然函数\n鉴于观测值 $x_1, \\dots, x_n$ 是独立同分布随机变量 $X_1, \\dots, X_n$ 的实现，似然函数 $L(\\theta)$ 是各个概率密度函数的乘积：\n$$\nL(\\theta) = \\prod_{i=1}^{n} f(x_i; k, \\theta) = \\prod_{i=1}^{n} \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}\n$$\n我们可以将依赖于 $\\theta$ 的项与不依赖于 $\\theta$ 的项分开：\n$$\nL(\\theta) = \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\left( \\frac{1}{\\theta^k} \\right)^n \\exp\\left(-\\sum_{i=1}^{n} \\frac{x_i}{\\theta}\\right) = \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\frac{1}{\\theta^{nk}} \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right)\n$$\n对数似然函数 $\\ell(\\theta)$ 是似然函数的自然对数：\n$$\n\\ell(\\theta) = \\ln(L(\\theta)) = \\ln\\left[ \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\frac{1}{\\theta^{nk}} \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right) \\right]\n$$\n利用对数的性质，我们可以展开这个表达式：\n$$\n\\ell(\\theta) = \\sum_{i=1}^{n} \\ln\\left( \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) + \\ln(\\theta^{-nk}) + \\ln\\left( \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right) \\right)\n$$\n$$\n\\ell(\\theta) = \\sum_{i=1}^{n} ((k-1)\\ln(x_i) - \\ln(\\Gamma(k))) - nk\\ln(\\theta) - \\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\n$$\n第一项是关于 $\\theta$ 的常数，所以我们可以将 $\\ell(\\theta)$ 写成（不计一个加性常数）：\n$$\n\\ell(\\theta) = \\mathrm{const} - nk\\ln(\\theta) - \\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\n$$\n\n#### 得分函数 $U(\\theta)$ 的推导\n得分函数 $U(\\theta)$ 是对数似然函数关于参数 $\\theta$ 的一阶导数。\n$$\nU(\\theta) = \\frac{\\partial \\ell(\\theta)}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\mathrm{const} - nk\\ln(\\theta) - \\left(\\sum_{i=1}^{n} x_i\\right)\\theta^{-1} \\right)\n$$\n$$\nU(\\theta) = 0 - nk\\left(\\frac{1}{\\theta}\\right) - \\left(\\sum_{i=1}^{n} x_i\\right)(-1)\\theta^{-2}\n$$\n$$\nU(\\theta) = -\\frac{nk}{\\theta} + \\frac{\\sum_{i=1}^{n} x_i}{\\theta^2}\n$$\n这可以写成一个共同的分母：\n$$\nU(\\theta) = \\frac{\\sum_{i=1}^{n} x_i - nk\\theta}{\\theta^2}\n$$\n这是第一个要求的表达式。\n\n#### 最大似然估计量 $\\hat{\\theta}$ 的推导\n最大似然估计量 (MLE) $\\hat{\\theta}$ 是使似然函数最大化的 $\\theta$ 值，这等同于使对数似然函数最大化。我们通过将得分函数（一阶导数）设为零并求解 $\\theta$ 来找到它。\n$$\nU(\\hat{\\theta}) = 0 \\implies \\frac{\\sum_{i=1}^{n} x_i - nk\\hat{\\theta}}{\\hat{\\theta}^2} = 0\n$$\n因为 $\\theta  0$，我们知道 $\\hat{\\theta}^2 \\neq 0$。因此，分子必须为零：\n$$\n\\sum_{i=1}^{n} x_i - nk\\hat{\\theta} = 0\n$$\n求解 $\\hat{\\theta}$：\n$$\nnk\\hat{\\theta} = \\sum_{i=1}^{n} x_i \\implies \\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}\n$$\n为确认这是一个最大值，我们检查 $\\ell(\\theta)$ 的二阶导数的符号。\n$$\n\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} = \\frac{\\partial U(\\theta)}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( -nk\\theta^{-1} + \\left(\\sum_{i=1}^{n} x_i\\right)\\theta^{-2} \\right) = -nk(-1)\\theta^{-2} + \\left(\\sum_{i=1}^{n} x_i\\right)(-2)\\theta^{-3}\n$$\n$$\n\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} = \\frac{nk}{\\theta^2} - \\frac{2\\sum_{i=1}^{n} x_i}{\\theta^3}\n$$\n在 $\\theta=\\hat{\\theta}$ 处求值，并代入 $\\sum_{i=1}^{n} x_i = nk\\hat{\\theta}$：\n$$\n\\left. \\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} \\right|_{\\theta=\\hat{\\theta}} = \\frac{nk}{\\hat{\\theta}^2} - \\frac{2(nk\\hat{\\theta})}{\\hat{\\theta}^3} = \\frac{nk}{\\hat{\\theta}^2} - \\frac{2nk}{\\hat{\\theta}^2} = -\\frac{nk}{\\hat{\\theta}^2}\n$$\n由于 $n  0$，$k  0$ 且 $\\hat{\\theta}^2  0$，二阶导数为负。这证实了 $\\hat{\\theta}$ 是一个局部最大值。由于它是参数空间中唯一的临界点，因此它也是全局最大值。\nMLE 是 $\\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}$。\n\n#### 费雪信息 $I(\\theta)$ 的推导\n费雪信息 $I(\\theta)$ 定义为对数似然函数二阶导数期望值的负数。\n$$\nI(\\theta) = -\\mathbb{E}\\left[\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2}\\right] = -\\mathbb{E}\\left[\\frac{nk}{\\theta^2} - \\frac{2\\sum_{i=1}^{n} X_i}{\\theta^3}\\right]\n$$\n利用期望的线性性质：\n$$\nI(\\theta) = -\\left( \\mathbb{E}\\left[\\frac{nk}{\\theta^2}\\right] - \\mathbb{E}\\left[\\frac{2\\sum_{i=1}^{n} X_i}{\\theta^3}\\right] \\right) = -\\frac{nk}{\\theta^2} + \\frac{2}{\\theta^3}\\mathbb{E}\\left[\\sum_{i=1}^{n} X_i\\right]\n$$\n给定 PDF 的 $\\mathrm{Gamma}(k,\\theta)$ 分布的均值为 $\\mathbb{E}[X_i] = k\\theta$。由于 $X_i$ 是同分布的：\n$$\n\\mathbb{E}\\left[\\sum_{i=1}^{n} X_i\\right] = \\sum_{i=1}^{n} \\mathbb{E}[X_i] = \\sum_{i=1}^{n} k\\theta = nk\\theta\n$$\n将此结果代入 $I(\\theta)$ 的表达式中：\n$$\nI(\\theta) = -\\frac{nk}{\\theta^2} + \\frac{2}{\\theta^3}(nk\\theta) = -\\frac{nk}{\\theta^2} + \\frac{2nk}{\\theta^2} = \\frac{nk}{\\theta^2}\n$$\n这是参数 $\\theta$ 的费雪信息。\n\n推导出的三个量是：\n1.  得分函数: $U(\\theta) = \\frac{\\sum_{i=1}^{n} x_i - nk\\theta}{\\theta^2}$\n2.  费雪信息: $I(\\theta) = \\frac{nk}{\\theta^2}$\n3.  最大似然估计量: $\\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}$\n这些将表示为一个单行向量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sum_{i=1}^n x_i - nk\\theta}{\\theta^2},  \\frac{nk}{\\theta^2},  \\frac{\\sum_{i=1}^n x_i}{nk} \\end{pmatrix}}\n$$"
        }
    ]
}