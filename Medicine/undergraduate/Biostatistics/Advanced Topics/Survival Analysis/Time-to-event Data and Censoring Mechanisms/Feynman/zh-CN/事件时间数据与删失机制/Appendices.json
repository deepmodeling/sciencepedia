{
    "hands_on_practices": [
        {
            "introduction": "理解生存分析始于掌握 Kaplan-Meier 估计量，这是一种基础的非参数工具。本练习将通过原始数据，为您提供构建生存曲线的直接、动手实践，教您如何正确处理右删失观测值并逐步计算生存概率。",
            "id": "4962132",
            "problem": "一个包含$12$名患者的临床队列从研究开始被随访，直至发生疾病事件或行政性右删失。假设右删失是独立的、非信息性的，并且当一个事件和一个删失记录在同一时间时，为了风险集核算，事件被认为发生在删失之前。时间以月为单位。每个患者的观测数据以有序对 $(\\text{时间}, \\text{指示符})$ 的形式给出，其中 $\\text{指示符}=1$ 表示观测到事件，$\\text{指示符}=0$ 表示右删失：\n- 受试者 $1$：$(3, 1)$\n- 受试者 $2$：$(4, 0)$\n- 受试者 $3$：$(4, 1)$\n- 受试者 $4$：$(5, 1)$\n- 受试者 $5$：$(6, 0)$\n- 受试者 $6$：$(7, 1)$\n- 受试者 $7$：$(7, 0)$\n- 受试者 $8$：$(8, 1)$\n- 受试者 $9$：$(9, 1)$\n- 受试者 $10$：$(11, 0)$\n- 受试者 $11$：$(12, 1)$\n- 受试者 $12$：$(12, 0)$\n\n从适用于事件发生时间数据的基本原理出发，包括生存函数 $S(t)=\\Pr(T>t)$ 的定义以及在右删失情况下不同观测事件时间点的条件事件概率概念，通过将其表示为在不同观测事件时间点上的乘积来构建 $S(t)$ 的非参数乘积极限估计量。在你的构建中，精确定义在每个不同事件时间点上计算事件数和风险人数的符号。\n\n然后，使用你构建的估计量，计算上述数据在 $t=10$ 个月时的估计生存概率。将你的最终数值答案四舍五入到四位有效数字，并以小数形式表示。",
            "solution": "该问题是有效的，因为它科学地基于生物统计学原理，特别是生存分析，其数据和假设完整一致，问题阐述清晰，并且以客观、正式的语言表达。因此，我们可以着手求解。\n\n该问题要求构建生存函数 $S(t)$ 的乘积极限估计量，并将其应用于给定的数据集以求出在 $t=10$ 个月时的估计生存概率。\n\n首先，我们从基本原理出发构建估计量。生存函数 $S(t)$ 定义为真实事件时间（一个随机变量 $T$）大于某个指定时间 $t$ 的概率：\n$$S(t) = \\Pr(T > t)$$\n设在队列中观测到的不同有序事件时间为 $t_{(1)} < t_{(2)} < \\dots < t_{(k)}$。生存函数可以表示为在这些事件时间定义的区间上的条件概率的乘积。对于任何时间 $t$ 使得 $t_{(j)} \\le t < t_{(j+1)}$，存活超过时间 $t$ 的概率与存活超过时间 $t_{(j)}$ 的概率相同。这可以写成：\n$$S(t) = \\Pr(T > t_{(j)}) = \\Pr(T > t_{(1)}) \\times \\Pr(T > t_{(2)} | T > t_{(1)}) \\times \\dots \\times \\Pr(T > t_{(j)} | T > t_{(j-1)})$$\n使用乘积符号，并定义 $t_{(0)} = 0$，我们有：\n$$S(t) = \\prod_{i: t_{(i)} \\le t} \\Pr(T > t_{(i)} | T > t_{(i-1)})$$\n在非信息性删失的假设下，我们可以从观测数据中估计每个条件概率项。让我们为每个不同的事件时间 $t_{(i)}$ 定义以下量：\n-   $n_i$：在时间 $t_{(i)}$ 之前即将面临事件风险的个体数量。这构成了风险集。这些是所有观测时间（事件或删失）大于或等于 $t_{(i)}$ 的受试者。\n-   $d_i$：在时间 $t_{(i)}$ 发生事件的个体数量。\n\n在给定一个受试者存活到时间 $t_{(i)}$ 的条件下，在时间 $t_{(i)}$ 发生事件的条件概率可以通过在 $t_{(i)}$ 发生事件的风险受试者比例来估计：\n$$\\widehat{\\Pr}(T = t_{(i)} | T \\ge t_{(i)}) = \\frac{d_i}{n_i}$$\n因此，在给定存活到时间 $t_{(i)}$ 的条件下，存活超过时间 $t_{(i)}$ 的条件概率估计为：\n$$\\widehat{\\Pr}(T > t_{(i)} | T \\ge t_{(i)}) = 1 - \\frac{d_i}{n_i}$$\n由于在 $t_{(i-1)}$ 和 $t_{(i)}$ 之间没有事件发生，$\\Pr(T > t_{(i)} | T > t_{(i-1)})$ 等价于 $\\Pr(T > t_{(i)} | T \\ge t_{(i)})$。将此估计值代入 $S(t)$ 的乘积表达式，得到乘积极限估计量，也称为 Kaplan-Meier 估计量，$\\hat{S}(t)$：\n$$\\hat{S}(t) = \\prod_{i: t_{(i)} \\le t} \\left(1 - \\frac{d_i}{n_i}\\right)$$\n按照惯例，对于 $t < t_{(1)}$，$\\hat{S}(t) = 1$。\n\n接下来，我们将此估计量应用于所提供的数据以计算 $\\hat{S}(10)$。我们必须首先确定在每个不同事件时间点的 $n_i$ 和 $d_i$ 的值。受试者总数为 $N=12$。\n事件或删失的有序时间是：$3(1), 4(0), 4(1), 5(1), 6(0), 7(1), 7(0), 8(1), 9(1), 11(0), 12(1), 12(0)$。\n不同的事件时间是 $3, 4, 5, 7, 8, 9, 12$。我们需要计算 $\\hat{S}(10)$，因此我们考虑所有小于或等于 $10$ 的事件时间 $t_{(i)}$。这些时间是 $t_{(1)}=3, t_{(2)}=4, t_{(3)}=5, t_{(4)}=7, t_{(5)}=8, t_{(6)}=9$。\n\n我们构建一个生命表来组织计算。事件和删失时间相同的处理规则是，被删失的受试者被包含在该时间的风险集中。\n\n-   在 $t_{(1)} = 3$ 时：\n    风险受试者数量为全部 $12$ 名，所以 $n_1 = 12$。\n    一名受试者发生事件，所以 $d_1 = 1$。\n    生存因子为 $1 - \\frac{d_1}{n_1} = 1 - \\frac{1}{12} = \\frac{11}{12}$。\n\n-   在 $t_{(2)} = 4$ 时：\n    在 $t=3$ 时有一名受试者发生事件。风险受试者数量为 $12 - 1 = 11$，所以 $n_2 = 11$。（在 $t=4$ 时被删失的受试者 $2$ 被包含在此风险集中）。\n    一名受试者发生事件，所以 $d_2 = 1$。\n    生存因子为 $1 - \\frac{d_2}{n_2} = 1 - \\frac{1}{11} = \\frac{10}{11}$。\n\n-   在 $t_{(3)} = 5$ 时：\n    在 $t=4$ 时，一名受试者发生事件，一名被删失。风险受试者数量为 $11 - 2 = 9$，所以 $n_3 = 9$。\n    一名受试者发生事件，所以 $d_3 = 1$。\n    生存因子为 $1 - \\frac{d_3}{n_3} = 1 - \\frac{1}{9} = \\frac{8}{9}$。\n\n-   在 $t_{(4)} = 7$ 时：\n    在 $t=5$ 时，一名受试者发生事件。在 $t=6$ 时，一名被删失。风险受试者数量为 $9 - 2 = 7$，所以 $n_4 = 7$。（在 $t=7$ 时被删失的受试者 $7$ 被包含在内）。\n    一名受试者发生事件，所以 $d_4 = 1$。\n    生存因子为 $1 - \\frac{d_4}{n_4} = 1 - \\frac{1}{7} = \\frac{6}{7}$。\n\n-   在 $t_{(5)} = 8$ 时：\n    在 $t=7$ 时，一名受试者发生事件，一名被删失。风险受试者数量为 $7 - 2 = 5$，所以 $n_5 = 5$。\n    一名受试者发生事件，所以 $d_5 = 1$。\n    生存因子为 $1 - \\frac{d_5}{n_5} = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n\n-   在 $t_{(6)} = 9$ 时：\n    在 $t=8$ 时，一名受试者发生事件。风险受试者数量为 $5 - 1 = 4$，所以 $n_6 = 4$。\n    一名受试者发生事件，所以 $d_6 = 1$。\n    生存因子为 $1 - \\frac{d_6}{n_6} = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n\n下一个事件时间在 $t=12$，大于 $10$。因此，生存概率估计值 $\\hat{S}(10)$ 是直到并包括 $t=9$ 的所有事件时间的生存因子的乘积。\n$$\\hat{S}(10) = \\prod_{i=1}^{6} \\left(1 - \\frac{d_i}{n_i}\\right)$$\n$$\\hat{S}(10) = \\left(\\frac{11}{12}\\right) \\times \\left(\\frac{10}{11}\\right) \\times \\left(\\frac{8}{9}\\right) \\times \\left(\\frac{6}{7}\\right) \\times \\left(\\frac{4}{5}\\right) \\times \\left(\\frac{3}{4}\\right)$$\n我们可以通过约去项来简化这个乘积：\n$$\\hat{S}(10) = \\frac{11 \\times 10 \\times 8 \\times 6 \\times 4 \\times 3}{12 \\times 11 \\times 9 \\times 7 \\times 5 \\times 4}$$\n约去 $11$ 和 $4$：\n$$\\hat{S}(10) = \\frac{10 \\times 8 \\times 6 \\times 3}{12 \\times 9 \\times 7 \\times 5}$$\n分解项以进一步简化：\n$$\\hat{S}(10) = \\frac{(2 \\times 5) \\times 8 \\times 6 \\times 3}{(2 \\times 6) \\times (3 \\times 3) \\times 7 \\times 5}$$\n约去 $(2 \\times 5 \\times 6 \\times 3)$：\n$$\\hat{S}(10) = \\frac{8}{3 \\times 7} = \\frac{8}{21}$$\n为了提供数值答案，我们将分数转换为小数，并按要求四舍五入到四位有效数字。\n$$\\frac{8}{21} \\approx 0.38095238...$$\n四舍五入到四位有效数字得到 $0.3810$。",
            "answer": "$$\\boxed{0.3810}$$"
        },
        {
            "introduction": "真实世界的数据常常涉及竞争性事件，即个体可能经历多种不同结局中的一种。一个常见的错误是将竞争性事件视为简单的删失，这会导致严重的偏倚。本实践问题将引导您量化这种偏倚，从而提供一个关键的教训，说明为什么累积发生率函数 (CIF) 是处理竞争风险的正确方法。",
            "id": "4962185",
            "problem": "一个队列的个体从基线开始被随访，以评估在存在竞争事件（其他原因导致的死亡，$k=2$）的情况下，发生特定疾病死亡（$k=1$）的时间。假设事件遵循竞争风险结构，其特定原因风险率为常数：特定疾病风险率为 $\\lambda_{1}(t)=\\lambda_{1}$，其他原因风险率为 $\\lambda_{2}(t)=\\lambda_{2}$，其中 $\\lambda_{1}$ 和 $\\lambda_{2}$ 均为正常数。假设没有失访和管理性删失；只有竞争事件会阻止特定疾病事件的发生。独立性和非信息性删失的假设适用于任何与失败类型无关的删失情况，但在本例中，竞争事件排除了我们感兴趣的事件。\n\n根据定义，原因 $k$ 的累积发生率函数（CIF），记为 $F_{k}(t)$，是在时间 $t$ 之前因原因 $k$ 发生失败的概率。考虑一种常见但错误的做法，即在使用 Kaplan-Meier (KM) 估计量估计原因 $k=1$ 的风险时，将竞争事件（$k=2$）视为独立右删失。在这种错误的做法下，估计量所针对的目标是移除了竞争事件后的净风险。\n\n从风险、生存和特定原因失败概率随时间变化的核心定义出发，推导在时间 $t$ 的偏差的解析表达式，该偏差定义为不正确的基于 KM 的估计（将竞争事件视为独立删失）与原因 $k=1$ 的真实累积发生率函数之差。然后，对于 $\\lambda_{1}=0.05$（每年），$\\lambda_{2}=0.10$（每年）和 $t=5$（年），对此偏差进行数值计算。将最终数值结果表示为十进制概率，并四舍五入到四位有效数字。",
            "solution": "该问题要求我们推导在存在竞争风险的情况下，因错误使用基于 Kaplan-Meier (KM) 的方法估计事件风险而产生的偏差的解析表达式，然后为一组特定参数计算此偏差。在给定时间 $t$ 的偏差是不正确的风险估计与真实的累积发生率函数（CIF）之差。\n\n设 $T$ 为首次事件发生的时间，$K$ 为事件类型，其中 $K=1$ 表示特定疾病死亡，$K=2$ 表示其他原因导致的死亡。特定原因风险率给定为常数：$\\lambda_{1}(t) = \\lambda_{1} > 0$ 和 $\\lambda_{2}(t) = \\lambda_{2} > 0$。\n\n首先，我们推导原因 1 的真实累积发生率函数的表达式，记为 $F_{1}(t)$。CIF 是在时间 $t$ 之前因原因 1 而失败的概率，即 $P(T \\le t, K=1)$。这需要总生存函数 $S(t)$，它是在时间 $t$ 之前未发生任何事件（任何原因）的概率。\n\n总风险率 $\\lambda(t)$ 是特定原因风险率的总和：\n$$ \\lambda(t) = \\lambda_{1}(t) + \\lambda_{2}(t) = \\lambda_{1} + \\lambda_{2} $$\n总生存函数 $S(t)$ 由下式给出：\n$$ S(t) = \\exp\\left(-\\int_{0}^{t} \\lambda(u) \\, du\\right) $$\n由于总风险率为常数，积分很简单：\n$$ S(t) = \\exp\\left(-\\int_{0}^{t} (\\lambda_{1} + \\lambda_{2}) \\, du\\right) = \\exp(-(\\lambda_{1} + \\lambda_{2})t) $$\n原因 $k=1$ 的 CIF $F_{1}(t)$ 是其特定原因风险率乘以总生存函数在时间区间 $[0, t]$ 上的积分：\n$$ F_{1}(t) = \\int_{0}^{t} \\lambda_{1}(u) S(u) \\, du $$\n代入 $\\lambda_{1}(u)$ 和 $S(u)$ 的表达式：\n$$ F_{1}(t) = \\int_{0}^{t} \\lambda_{1} \\exp(-(\\lambda_{1} + \\lambda_{2})u) \\, du $$\n$$ F_{1}(t) = \\lambda_{1} \\left[ \\frac{\\exp(-(\\lambda_{1} + \\lambda_{2})u)}{-(\\lambda_{1} + \\lambda_{2})} \\right]_{0}^{t} $$\n$$ F_{1}(t) = \\lambda_{1} \\left( \\frac{\\exp(-(\\lambda_{1} + \\lambda_{2})t)}{-(\\lambda_{1} + \\lambda_{2})} - \\frac{\\exp(0)}{-(\\lambda_{1} + \\lambda_{2})} \\right) $$\n$$ F_{1}(t) = \\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right) $$\n这是原因 1 的累积发生率的正确表达式。\n\n接下来，我们推导通过将竞争事件（$k=2$）视为独立右删失而获得的不正确风险估计的表达式。在这种不正确的假设下，Kaplan-Meier 估计量针对的是原因 1 的*净*生存函数，我们记为 $S_{1}^{*}(t)$。该函数描述了一个假设情景下的生存概率，在该情景中，原因 1 是唯一可能发生的事件。此情景下的风险率就是 $\\lambda_1(t) = \\lambda_1$。\n$$ S_{1}^{*}(t) = \\exp\\left(-\\int_{0}^{t} \\lambda_{1}(u) \\, du\\right) = \\exp(-\\lambda_{1} t) $$\n相应的累积风险估计，我们记为 $F_{KM,1}(t)$，是 1 减去此净生存函数：\n$$ F_{KM,1}(t) = 1 - S_{1}^{*}(t) = 1 - \\exp(-\\lambda_{1} t) $$\n这个量通常被称为净风险。\n\n在时间 $t$ 的偏差的解析表达式是不正确的估计与真实 CIF 之间的差：\n$$ \\text{Bias}(t) = F_{KM,1}(t) - F_{1}(t) $$\n代入推导出的表达式：\n$$ \\text{Bias}(t) = \\left(1 - \\exp(-\\lambda_{1} t)\\right) - \\left(\\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right)\\right) $$\n这就是所要求的偏差的解析表达式。\n\n现在，我们使用给定参数 $\\lambda_{1}=0.05$，$\\lambda_{2}=0.10$ 和 $t=5$ 对此偏差进行数值计算。\n\n首先，计算不正确的基于 KM 的估计 $F_{KM,1}(5)$：\n$$ F_{KM,1}(5) = 1 - \\exp(-\\lambda_{1} t) = 1 - \\exp(-0.05 \\times 5) = 1 - \\exp(-0.25) $$\n接下来，计算真实的 CIF $F_{1}(5)$：\n$$ F_{1}(5) = \\frac{\\lambda_{1}}{\\lambda_{1} + \\lambda_{2}} \\left( 1 - \\exp(-(\\lambda_{1} + \\lambda_{2})t) \\right) $$\n$$ F_{1}(5) = \\frac{0.05}{0.05 + 0.10} \\left( 1 - \\exp(-(0.05 + 0.10) \\times 5) \\right) $$\n$$ F_{1}(5) = \\frac{0.05}{0.15} \\left( 1 - \\exp(-0.15 \\times 5) \\right) = \\frac{1}{3} \\left( 1 - \\exp(-0.75) \\right) $$\n$t=5$ 时的偏差为：\n$$ \\text{Bias}(5) = \\left(1 - \\exp(-0.25)\\right) - \\frac{1}{3} \\left(1 - \\exp(-0.75)\\right) $$\n现在我们计算数值：\n$$ \\exp(-0.25) \\approx 0.77880078 $$\n$$ \\exp(-0.75) \\approx 0.47236655 $$\n将这些值代入偏差表达式中：\n$$ \\text{Bias}(5) \\approx (1 - 0.77880078) - \\frac{1}{3}(1 - 0.47236655) $$\n$$ \\text{Bias}(5) \\approx 0.22119922 - \\frac{1}{3}(0.52763345) $$\n$$ \\text{Bias}(5) \\approx 0.22119922 - 0.17587782 $$\n$$ \\text{Bias}(5) \\approx 0.04532140 $$\n将结果四舍五入到四位有效数字，我们得到 $0.04532$。",
            "answer": "$$ \\boxed{0.04532} $$"
        },
        {
            "introduction": "数据收集的方式从根本上决定了其分析方法；理解左截断（延迟入组）和左删失之间的区别至关重要。本练习挑战您批判性地思考受试者如何进入研究，以及这对定义风险集和构建似然函数的影响。正确区分这些概念对于避免在估计风险率时出现重大偏倚至关重要。",
            "id": "4962211",
            "problem": "一项队列研究调查从时间 $0$ 的一个共同生物学起点（例如，疾病发作）到事件时间 $T$ 的时间。研究中的个体不一定从时间 $0$ 开始被观察。相反，每个个体 $i$ 在一个延迟的进入时间 $E_i \\ge 0$ 加入研究，然后按日历时间向前随访，直到在 $T_i$ 发生事件或在 $C_i$ 发生右删失，得到观测时间 $X_i=\\min(T_i,C_i)$ 和事件指示符 $\\Delta_i=\\mathbf{1}\\{T_i \\le C_i\\}$。事件时间 $T_i \\le E_i$ 的个体永远不会被观察到，因为他们在加入研究之前就已经发生了事件。假设延迟进入是非信息性的，即在给定测量的协变量的条件下，$E_i$ 与 $T_i$ 独立，且在给定协变量和 $E_i$ 的条件下，右删失与 $T_i$ 独立。\n\n仅使用生存分析和概率的基本定义——即生存函数为 $S_T(t)=\\Pr(T>t)$，概率密度函数（如果存在）为 $f_T(t)=\\frac{d}{dt}\\Pr(T\\le t)$，风险函数为 $h_T(t)=\\lim_{\\Delta t \\downarrow 0}\\frac{\\Pr(t \\le T < t+\\Delta t \\mid T \\ge t)}{\\Delta t}=\\frac{f_T(t)}{S_T(t)}$——来推断延迟进入与左删失的含义。\n\n选择所有关于因在 $E_i$ 延迟进入导致的左截断及其与左删失区别的正确陈述：\n\nA. 在因 $E_i$ 延迟进入引起的左截断下，对于在时间 $t_i$ 观测到的未删失事件，其似然贡献与条件密度 $f_T(t_i \\mid T>E_i)$ 成正比，对于 $t_i>E_i$，该密度等于 $\\frac{f_T(t_i)}{S_T(E_i)}$；$t_i \\le E_i$ 的值是观测不到的。\n\nB. 在延迟进入的情况下，事件时间 $T_i \\le E_i$ 的个体应被视为在时间 $E_i$ 左删失（其贡献涉及 $\\Pr(T_i \\le E_i)$），因为确切的事件时间未知，但事件发生在 $E_i$ 之前。\n\nC. 对于左截断下的非参数估计，时间 $t$ 的风险集应包含个体 $i$ 当且仅当 $E_i \\le t \\le X_i$，这样个体 $i$ 仅在时间 $t \\ge E_i$ 开始贡献风险，这操作化了对 $T_i > E_i$ 的条件化。\n\nD. 左删失和左截断对于在 $t_i>E_i$ 观测到的事件产生相同的似然贡献，因为两种机制都涉及 $E_i$ 之前的信息缺失。\n\nE. 如果忽略延迟进入，并将所有个体视为从时间 $0$ 开始观察，那么在早期时间（接近 $0$）估计的风险函数 $h_T(t)$ 通常会向下偏倚，因为被分析的队列必然排除了那些在他们各自的 $E_i$ 之前失败的个体，从而人为地增加了早期无事件的暴露时间。\n\n选择所有适用的选项。",
            "solution": "问题陈述描述了一项队列研究，其事件时间数据存在延迟进入（左截断）和右删失。这是生存分析中的一个标准设定。这个问题具有科学依据，提法明确，并使用了精确、客观的术语。非信息性进入和删失的假设是标准的，并允许进行明确定义的分析。因此，问题陈述是有效的。我们现在开始评估每个陈述。\n\n问题的核心是左截断和左删失之间的区别。\n- **左截断（延迟进入）：** 一个事件时间为 $T_i$、进入时间为 $E_i$ 的个体 $i$ 只有在进入研究时无事件发生（即 $T_i > E_i$）才被纳入研究。对于 $T_i \\le E_i$ 的个体，他们永远不会被观察到，也不属于研究样本。所有后续分析都必须以观察到个体这一事实为条件，这意味着以事件 $T_i > E_i$ 为条件。\n- **左删失：** 一个个体 $i$ 已知在研究中，并且已知其事件发生在某个时间 $E_i$ 之前，但确切的事件时间未知。对于一个左删失的观测，数据是 $T_i \\le E_i$。我们拥有关于这些个体的信息，尽管是不完整的信息。\n\n让我们使用提供的基本定义：\n- 生存函数: $S_T(t) = \\Pr(T > t)$\n- 概率密度函数 (PDF): $f_T(t) = -\\frac{d}{dt}S_T(t)$\n- 风险函数: $h_T(t) = \\frac{f_T(t)}{S_T(t)}$\n\n对于一个个体 $i$ 要被包含在数据集中，必须满足条件 $T_i > E_i$。因此，每个观察到的个体 $i$ 的似然贡献必须从以 $T_i > E_i$ 为条件的概率中导出。\n\n让我们分析一个观察到的个体 $i$，其进入时间为 $E_i$，观测数据为 $(X_i, \\Delta_i)$，其中 $X_i = \\min(T_i, C_i)$ 且 $\\Delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$。观察窗口是 $[E_i, C_i]$。\n\n- 如果事件被观察到（$\\Delta_i=1$），则 $T_i=X_i=t_i$。似然与在给定存活至进入时间的条件下，在时间 $t_i$ 观察到事件的条件概率密度成正比。这是 $f_{T|T>E_i}(t_i)$。\n- 如果观测是右删失的（$\\Delta_i=0$），则 $T_i > X_i=c_i$。似然与在给定存活至进入时间的条件下，存活超过删失时间 $c_i$ 的条件概率成正比。这是 $\\Pr(T_i > c_i \\mid T_i > E_i)$。\n\n### 选项评估\n\n**A. 在因 $E_i$ 延迟进入引起的左截断下，对于在时间 $t_i$ 观测到的未删失事件，其似然贡献与条件密度 $f_T(t_i \\mid T>E_i)$ 成正比，对于 $t_i>E_i$，该密度等于 $\\frac{f_T(t_i)}{S_T(E_i)}$；$t_i \\le E_i$ 的值是观测不到的。**\n\n这个陈述分析了未删失观测（$T_i = t_i$）的似然。如前所述，由于个体仅因为 $T_i > E_i$ 才被纳入研究，相关的概率分布是基于此事件的条件分布。根据定义，给定 $T > E_i$ 的条件下 $T$ 的条件概率密度函数是：\n$$ f_{T|T>E_i}(t_i) = \\frac{f_T(t_i)}{\\Pr(T > E_i)} $$\n对于 $t_i > E_i$，否则为 $0$。\n使用生存函数的定义，$\\Pr(T > E_i) = S_T(E_i)$。因此，条件密度是：\n$$ f_{T|T>E_i}(t_i) = \\frac{f_T(t_i)}{S_T(E_i)} $$\n该陈述正确地指出，这个条件密度是似然贡献的基础，并且由于左截断的性质，事件时间 $t_i \\le E_i$ 是无法观测的。该陈述是对未删失事件似然贡献的精确且正确的描述。\n\n**结论：正确。**\n\n**B. 在延迟进入的情况下，事件时间 $T_i \\le E_i$ 的个体应被视为在时间 $E_i$ 左删失（其贡献涉及 $\\Pr(T_i \\le E_i)$），因为确切的事件时间未知，但事件发生在 $E_i$ 之前。**\n\n这个陈述从根本上将左截断误解为左删失。在问题描述中，明确指出“事件时间 $T_i \\le E_i$ 的个体**永远不会被观察到**”。这意味着我们没有关于他们的任何信息；他们不在我们的数据集中。如果研究人员不知道某个个体的存在，就不能将其纳入分析。这个选项中描述的程序——包含一个个体，其贡献与 $\\Pr(T_i \\le E_i)$ 相关——是用于左删失观测的正确程序，在左删失情况下，我们知道个体的存在并且其事件发生在 $E_i$ 之前。因为问题的设定是截断，所以这个陈述是错误的。\n\n**结论：错误。**\n\n**C. 对于左截断下的非参数估计，时间 $t$ 的风险集应包含个体 $i$ 当且仅当 $E_i \\le t \\le X_i$，这样个体 $i$ 仅在时间 $t \\ge E_i$ 开始贡献风险，这操作化了对 $T_i > E_i$ 的条件化。**\n\n像 Kaplan-Meier 或 Nelson-Aalen 估计量这样的非参数估计量依赖于风险集 $R(t)$ 的概念，风险集是在时间 $t$ 处于观察中且有风险发生事件的个体集合。在一个标准的（非截断）分析中，如果一个个体 $i$ 在时间 $t$ 仍然处于观察中，即 $X_i \\ge t$，那么他就在 $R(t)$ 中。\n\n对于延迟进入，个体直到其进入时间 $E_i$ 才开始被观察。因此，个体 $i$ 只有在进入研究后的时间 $t$ 才可能处于风险中。这意味着必须满足条件 $t \\ge E_i$（或 $E_i \\le t$）。将此与他们尚未发生事件或被删失的标准要求相结合，在时间 $t$ 处于风险集的条件就变成了他们在时间 $t$ 或之前已进入研究，并且在时间 $t$ 仍在被随访。该陈述提出了条件 $E_i \\le t \\le X_i$。\n- $E_i \\le t$：个体已进入研究，并在时间 $t$ 处于观察中。\n- $t \\le X_i$：个体在时间 $t$ 尚未经历事件或被删失。\n这正确地定义了在时间 $t$ 处于风险中的个体集合。通过强制个体仅在时间 $E_i$ 加入风险集，分析正确地考虑了个体为被观察到必须至少存活到 $E_i$ 这一事实。对标准风险集定义的这种修改正是非参数分析中处理左截断的方式，有效地操作化了研究设计所要求的条件化。\n\n**结论：正确。**\n\n**D. 左删失和左截断对于在 $t_i>E_i$ 观测到的事件产生相同的似然贡献，因为两种机制都涉及 $E_i$ 之前的信息缺失。**\n\n这个陈述是错误的。正如在选项 A 的分析中所展示的，在左截断下，在 $t_i$ 发生的未删失事件的似然贡献与 $\\frac{f_T(t_i)}{S_T(E_i)}$ 成正比。分母 $S_T(E_i)$ 来自于被纳入样本（$T_i > E_i$）的条件。\n\n在一个有 $E_i$ 处左删失的研究中，在 $t_i > E_i$ 处观察到的事件的似然将简单地与无条件密度 $f_T(t_i)$ 成正比。左删失的个体会向似然函数贡献形如 $\\Pr(T_i \\le E_i) = 1-S_T(E_i)$ 的项。总似然是这些不同类型项的乘积。观察到的事件的似然没有 $S_T(E_i)$ 这个分母。似然的数学形式是根本不同的，因为截断修改了抽样框架本身，而删失处理的是一个完整样本上的不完全测量。\n\n**结论：错误。**\n\n**E. 如果忽略延迟进入，并将所有个体视为从时间 $0$ 开始观察，那么在早期时间（接近 $0$）估计的风险函数 $h_T(t)$ 通常会向下偏倚，因为被分析的队列必然排除了那些在他们各自的 $E_i$ 之前失败的个体，从而人为地增加了早期无事件的暴露时间。**\n\n让我们分析忽略延迟进入的后果。这意味着我们错误地假设样本中所有个体 $i$ 的 $E_i = 0$。风险函数被估计为事件数与风险集中的个体数之比，$ \\hat{h}(t) = d(t) / |R(t)| $。\n\n考虑一个早期的时间点 $t$。\n- **正确的风险集：** 真实的风险集 $R_{\\text{correct}}(t)$ 只包括那些实际已进入研究的个体，即 $\\{i \\mid E_i \\le t \\text{ and } X_i \\ge t\\}$。对于一个早期的 $t$，这个集合可能很小。\n- **错误的（朴素的）风险集：** 朴素的分析会假设风险集是 $R_{\\text{naive}}(t) = \\{i \\mid X_i \\ge t\\}$。这个集合包括最终样本中所有尚未发生事件的个体，无论他们的进入时间如何。对于一个早期的 $t$，当许多个体的 $E_i > t$ 时，很明显 $|R_{\\text{naive}}(t)| > |R_{\\text{correct}}(t)|$。朴素风险集被夸大了。\n- **事件数量：** 在时间 $t$ 观察到的事件数 $d(t)$ 在两种分析中是相同的，因为只有当个体进入研究后才能观察到事件。\n\n朴素风险估计量是 $\\hat{h}_{\\text{naive}}(t) = \\frac{d(t)}{|R_{\\text{naive}}(t)|}$。正确的估计量是 $\\hat{h}_{\\text{correct}}(t) = \\frac{d(t)}{|R_{\\text{correct}}(t)|}$。由于 $|R_{\\text{naive}}(t)| > |R_{\\text{correct}}(t)|$，因此 $\\hat{h}_{\\text{naive}}(t) < \\hat{h}_{\\text{correct}}(t)$。风险被低估了，即向下偏倚。\n\n选项中提供的推理是准确的。通过将个体从时间 $0$ 就纳入风险集，即使他们的进入时间 $E_i$ 要晚得多，这就在风险估计量的分母中加入了“永生”人时。这些个体在区间 $[0, E_i)$ 内不可能有观察到的事件，但他们却被计为处于风险中。这人为地夸大了分母并压低了风险估计值。该队列偏向于幸存者，尤其是在早期时间点，导致估计的风险存在向下偏倚。\n\n**结论：正确。**\n\n最终总结：陈述 A、C 和 E 是正确的。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}