{
    "hands_on_practices": [
        {
            "introduction": "非参数推断的核心思想之一是直接利用研究设计中的随机化来构建检验，而无需对数据来自特定概率分布做出假设。本练习将引导你为一项区组随机试验构建一个精确的置换检验 (permutation test)。通过这个过程，你将体验如何从第一性原理出发，为特定的实验设计量身定做假设检验，从而深刻理解随机化推断的逻辑基础。",
            "id": "4920236",
            "problem": "一个生物统计学团队正在进行一项随机对照试验（RCT），以评估一种新疗法相对于对照组是否能提高一种连续生物标志物反应。随机化采用不等分配的置换区组：在每个大小为 $3$ 的区组内，恰好有 $2$ 名参与者被分配到治疗组， $1$ 名被分配到对照组。共有 $3$ 个区组。每个区组中的三个治疗后生物标志物结果，以及本次试验中实际观察到的分配情况如下。\n区组 $1$：结果为 $8$、$4$、$2$；结果为 $8$ 和 $4$ 的受试者被分配到治疗组，结果为 $2$ 的受试者被分配到对照组。\n区组 $2$：结果为 $7$、$6$、$1$；结果为 $7$ 和 $6$ 的受试者被分配到治疗组，结果为 $1$ 的受试者被分配到对照组。\n区组 $3$：结果为 $9$、$3$、$0$；结果为 $9$ 和 $0$ 的受试者被分配到治疗组，结果为 $3$ 的受试者被分配到对照组。\n你将构建一个尊重该随机化方案的、基于随机化的置换检验。使用以下基本依据：\n- 在治疗无效的零假设 $H_0$ 下，观察到的结果是固定的，只有治疗标签根据随机化机制是随机的。\n- 为了尊重随机化方案，置换必须限制在那些可能由实际设计产生的重新标记上；在这里，在每个大小为 $3$ 的区组内，必须恰好有 $2$ 个标签是治疗， $1$ 个标签是对照。\n将检验统计量 $T$ 定义为治疗组和对照组之间平均结果的差异，即 $T = \\bar{Y}_T - \\bar{Y}_C$，并考虑治疗会增加平均结果的单侧备择假设 $H_1$。通过枚举所有与区组随机化和每个区组内 $2{:}1$ 分配一致的标记，构建在 $H_0$ 下 $T$ 的精确置换分布，并计算精确的单侧 $p$ 值 $\\Pr(T \\ge T_{\\text{obs}} \\mid H_0)$。将你的最终答案表示为最简分数。无需四舍五入。",
            "solution": "该问题陈述具有科学依据，提法明确，并包含了进行所要求分析的所有必要信息。它描述了一个用于区组随机对照试验（RCT）的标准基于随机化的置换检验，这是非参数生物统计学中一个有效且基本的过程。因此，我将继续进行解答。\n\n该问题要求为一个基于区组随机化设计的置换检验计算精确的单侧 $p$ 值。零假设 $H_0$ 假定治疗对生物标志物结果没有影响。这是尖锐零假设，它意味着每个参与者的观察结果将是相同的，无论他们被分配到哪个治疗组。在 $H_0$ 下，所有 $9$ 个结果的集合被认为是固定的。唯一的随机性来源是治疗标签的分配，它遵循指定的随机化方案。\n\n该随机化方案由大小为 $3$ 的置换区组组成。在 $3$ 个区组中的每一个区组内，有 $2$ 名参与者被分配到治疗组， $1$ 名被分配到对照组。在一个区组内，选择哪位参与者接受对照组分配是随机的。对于一个有 $3$ 名参与者的区组，有 $\\binom{3}{1} = 3$ 种可能的方式来分配 $1$ 个对照标签和 $2$ 个治疗标签。由于有 $3$ 个独立的区组，与随机化方案一致的可能治疗分配总数为 $3 \\times 3 \\times 3 = 27$。在 $H_0$ 下，这 $27$ 种分配中的每一种都是等可能的，概率为 $\\frac{1}{27}$。\n\n检验统计量定义为治疗组（T）和对照组（C）之间平均结果的差异：$T = \\bar{Y}_T - \\bar{Y}_C$。参与者总数为 $N=9$，其中治疗组有 $N_T = 3 \\times 2 = 6$ 人，对照组有 $N_C = 3 \\times 1 = 3$ 人。\n\n首先，我们根据问题中给出的实际分配，计算检验统计量的观测值 $T_{\\text{obs}}$。\n每个区组的结果是：\n区组 $1$：$\\{8, 4, 2\\}$\n区组 $2$：$\\{7, 6, 1\\}$\n区组 $3$：$\\{9, 3, 0\\}$\n\n观察到的分配是：\n治疗组结果：$Y_T = \\{8, 4, 7, 6, 9, 0\\}$\n对照组结果：$Y_C = \\{2, 1, 3\\}$\n\n观察到的治疗组的总和与平均值为：\n$$ \\sum Y_T = 8 + 4 + 7 + 6 + 9 + 0 = 34 $$\n$$ \\bar{Y}_T = \\frac{34}{6} = \\frac{17}{3} $$\n\n观察到的对照组的总和与平均值为：\n$$ \\sum Y_C = 2 + 1 + 3 = 6 $$\n$$ \\bar{Y}_C = \\frac{6}{3} = 2 $$\n\n观察到的检验统计量为：\n$$ T_{\\text{obs}} = \\bar{Y}_T - \\bar{Y}_C = \\frac{17}{3} - 2 = \\frac{17}{3} - \\frac{6}{3} = \\frac{11}{3} $$\n\n单侧 $p$ 值是在零假设下观察到至少与 $T_{\\text{obs}}$ 一样极端的检验统计量的概率，即 $p = \\Pr(T \\ge T_{\\text{obs}} \\mid H_0)$。为了找到这个值，我们必须考虑所有 $27$ 种可能的随机化情况。\n\n我们可以通过将 $T$ 表示为单个变量（例如对照组结果的总和 $\\sum Y_C$）来简化计算。所有结果的总和在所有置换中是一个常数：\n$$ S_{\\text{total}} = \\sum_{i=1}^{9} Y_i = (8+4+2) + (7+6+1) + (9+3+0) = 14 + 14 + 12 = 40 $$\n由于 $\\sum Y_T + \\sum Y_C = S_{\\text{total}} = 40$，我们有 $\\sum Y_T = 40 - \\sum Y_C$。\n检验统计量可以重写为：\n$$ T = \\frac{\\sum Y_T}{N_T} - \\frac{\\sum Y_C}{N_C} = \\frac{40 - \\sum Y_C}{6} - \\frac{\\sum Y_C}{3} = \\frac{40 - \\sum Y_C - 2\\sum Y_C}{6} = \\frac{40 - 3\\sum Y_C}{6} $$\n条件 $T \\ge T_{\\text{obs}}$ 等价于：\n$$ \\frac{40 - 3\\sum Y_C}{6} \\ge \\frac{11}{3} $$\n$$ 40 - 3\\sum Y_C \\ge 6 \\times \\frac{11}{3} = 22 $$\n$$ 18 \\ge 3\\sum Y_C $$\n$$ \\sum Y_C \\le 6 $$\n因此，$p$ 值是在 $27$ 种可能的随机化中，对照组结果总和小于或等于 $6$ 的情况所占的比例。\n\n我们需要枚举满足此条件的对照组分配组合。对于每次随机化，从每个区组中选择一个结果作为对照组的结果。设 $y_{c1}$、$y_{c2}$ 和 $y_{c3}$ 分别是来自区组 $1$、区组 $2$ 和区组 $3$ 的对照组结果。\n可能的对照组结果是：\n- 来自区组 $1$：$y_{c1} \\in \\{2, 4, 8\\}$\n- 来自区组 $2$：$y_{c2} \\in \\{1, 6, 7\\}$\n- 来自区组 $3$：$y_{c3} \\in \\{0, 3, 9\\}$\n\n我们需要找到所有满足 $y_{c1} + y_{c2} + y_{c3} \\le 6$ 的组合 $(y_{c1}, y_{c2}, y_{c3})$。\n让我们从每个集合中最小的可能值开始，系统地枚举它们。\n1.  从每个区组中选择最小值：$y_{c1} = 2$, $y_{c2} = 1$, $y_{c3} = 0$。总和是 $2+1+0=3$。因为 $3 \\le 6$，所以这是一种符合条件的随机化。\n2.  保持 $y_{c1}=2$ 和 $y_{c2}=1$。$y_{c3}$ 的下一个值是 $3$。总和是 $2+1+3=6$。因为 $6 \\le 6$，所以这是第二种符合条件的随机化（这是观察到的情况）。$y_{c3}$ 的下一个值是 $9$，总和为 $12$，大于 $6$。\n3.  现在，让我们尝试 $y_{c1}$ 的下一个值，即 $4$，同时保持其他值为最小值。设 $y_{c1}=4$, $y_{c2}=1$, $y_{c3}=0$。总和是 $4+1+0=5$。因为 $5 \\le 6$，所以这是第三种符合条件的随机化。如果我们将 $y_{c3}$ 改为 $3$，总和变为 $4+1+3=8$，太大了。\n4. 如果我们从 $y_{c1}=8$ 开始，最小的可能总和是 $8+1+0=9$，已经大于 $6$。\n5. 如果我们从 $y_{c1}=2$ 开始并使用 $y_{c2}=6$，最小的总和是 $2+6+0=8$，大于 $6$。\n\n因此，在 $27$ 种可能的随机化中，恰好有 $3$ 种满足 $\\sum Y_C \\le 6$。它们是：\n- 对照组结果 $\\{2, 1, 0\\}$，总和为 $3$。\n- 对照组结果 $\\{2, 1, 3\\}$，总和为 $6$。\n- 对照组结果 $\\{4, 1, 0\\}$，总和为 $5$。\n\n这 $3$ 种随机化中的每一种都会得到一个大于或等于 $T_{\\text{obs}}$ 的检验统计量 $T$。由于 $27$ 种随机化中的每一种都是等可能的，精确的单侧 $p$ 值是符合条件的结果数与总结果数的比率。\n$$ p \\text{值} = \\frac{\\text{满足 } T \\ge T_{\\text{obs}} \\text{ 的置换数}}{\\text{总置换数}} = \\frac{3}{27} $$\n将其表示为最简分数，我们得到：\n$$ p \\text{值} = \\frac{1}{9} $$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        },
        {
            "introduction": "在置换检验思想的基础上，统计学家开发了一系列标准化的秩检验 (rank-based tests)，这些检验在处理非正态数据时非常稳健。本练习将聚焦于其中一种经典的检验——Wilcoxon 符号秩检验，它常用于配对数据的比较。你将学习如何处理真实数据中常见的棘手问题，例如数据中的“结”(ties) 和零值，并计算一个更精确的“中点 p 值”(mid-p value)，这对于理解离散检验统计量的行为至关重要。",
            "id": "4920252",
            "problem": "一项配对生物统计学研究评估了干预后12周与基线相比，受试者体内某一连续生物标志物的变化。令配对差异表示为 $d_{i} = \\text{post}_{i} - \\text{pre}_{i}$，其中 $i=1,\\dots,25$。由于仪器舍入和检测限的原因，一些观测到的差异恰好为零，且多个非零绝对差异存在结（tie）。观测到的差异为\n$$\n\\{0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,1,\\,1,\\,1,\\,2,\\,2,\\,3,\\,3,\\,6,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0\\}。\n$$\n假设在差异分布关于0对称的原假设下，威尔科克森符号秩检验（Wilcoxon signed-rank test）的标准条件成立，其中零差异被移除，并且结的绝对差异被赋予平均秩次。\n\n仅使用原假设下的基本概率推理（即非零配对的符号是随机的，概率相等且相互独立），进行精确的威尔科克森符号秩检验并计算双侧中位p值（mid-$p$ value）。按以下步骤进行：\n- 移除零差异。\n- 将非零绝对差异从小到大排序，为结指定平均秩次。\n- 计算统计量 $W^{+}$，其值为与正差异相关联的秩次之和。\n- 使用由独立随机符号导出的 $W^{+}$ 的精确分布来获得双侧中位p值，其定义为超出观测统计量的尾部概率加上相关尾部（们）上等于观测统计量处概率的一半。\n\n将最终的中位p值表示为精确分数或四舍五入到四位有效数字的小数。简要解释绝对差异中存在结如何影响符号秩统计量的分布以及中位p值的解释。最终数值答案必须是单个值（而非区间或不等式）。",
            "solution": "首先验证问题以确保其具有科学依据、提法明确且客观。\n\n**1. 提取已知条件**\n- 样本量：$n=25$ 个配对差异，$d_i = \\text{post}_i - \\text{pre}_i$。\n- 观测差异：$\\{0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,1,\\,1,\\,1,\\,2,\\,2,\\,3,\\,3,\\,6,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0\\}$。\n- 检验：威尔科克森符号秩检验。\n- 原假设 ($H_0$)：差异的分布关于0对称。\n- 零值处理：移除零差异。\n- 结的处理：为结的绝对差异分配平均秩次。\n- 检验统计量：$W^{+}$，与正差异相对应的秩次之和。\n- 任务：计算精确的双侧中位p值。\n- 中位p值定义：超出观测统计量的尾部概率，加上在相关尾部（们）上取到该值的概率的一半。\n\n**2. 验证结论**\n问题是有效的。它描述了威尔科克森符号秩检验的标准应用，这是一种成熟的非参数方法。数据，包括零值和结的存在，代表了生物统计学中的一个现实场景。处理这些问题的说明是清晰和标准的。精确中位p值的概念是处理离散检验统计量的一种有效统计工具。该问题是自洽的、逻辑一致的，并且在科学上是合理的。\n\n**3. 解答**\n\n解答过程遵循问题陈述中概述的步骤。\n\n**步骤1：数据准备**\n初始集合包含 $n=25$ 个观测差异。我们首先按照指示处理零差异。\n零差异的数量为 $m_0 = 16$。\n这些差异从分析中移除。检验的有效样本量是非零差异的数量，即 $n'$。\n非零差异为 $\\{1,\\,1,\\,1,\\,2,\\,2,\\,3,\\,3,\\,6\\}$。\n共有 $n'=8$ 个非零差异。\n\n**步骤2：绝对差异排序**\n我们取这 $n'=8$ 个非零差异的绝对值：$\\{1,\\,1,\\,1,\\,2,\\,2,\\,3,\\,3,\\,6\\}$。\n然后我们将这些绝对值从小到大排序，为结分配平均秩次。\n- 三个值为 $1$ 的数占据了秩次 $1$、$2$ 和 $3$。它们的平均秩次是 $\\frac{1+2+3}{3} = \\frac{6}{3} = 2$。\n- 两个值为 $2$ 的数占据了秩次 $4$ 和 $5$。它们的平均秩次是 $\\frac{4+5}{2} = \\frac{9}{2} = 4.5$。\n- 两个值为 $3$ 的数占据了秩次 $6$ 和 $7$。它们的平均秩次是 $\\frac{6+7}{2} = \\frac{13}{2} = 6.5$。\n- 值为 $6$ 的数占据了秩次 $8$。其秩次为 $8$。\n\n这 $n'=8$ 个非零差异的秩次集合是 $\\{2,\\,2,\\,2,\\,4.5,\\,4.5,\\,6.5,\\,6.5,\\,8\\}$。\n检查秩次总和：$3 \\times 2 + 2 \\times 4.5 + 2 \\times 6.5 + 8 = 6 + 9 + 13 + 8 = 36$。这与 $n'=8$ 的总秩次和相匹配，即 $\\frac{n'(n'+1)}{2} = \\frac{8(8+1)}{2} = \\frac{72}{2} = 36$。\n\n**步骤3：计算检验统计量 $W^{+}$**\n检验统计量 $W^{+}$ 是与正差异相对应的秩次之和。\n非零差异集为 $\\{1,\\,1,\\,1,\\,2,\\,2,\\,3,\\,3,\\,6\\}$。所有这些都是正数。\n因此，$W^{+}$ 是所有秩次的总和。\n观测到的统计量是 $W_{obs}^{+} = 2+2+2+4.5+4.5+6.5+6.5+8 = 36$。\n\n**步骤4：精确零分布与p值计算**\n在关于0对称的原假设下，每个非零差异为正或为负的概率是相等的。这等同于为 $n'=8$ 个秩次中的每一个随机分配一个 $+$ 或 $-$ 符号，$2^{n'} = 2^8 = 256$ 种符号组合中的每一种都是等可能的，其概率为 $(\\frac{1}{2})^8 = \\frac{1}{256}$。\n\n检验统计量 $W^{+}$ 是分配了 $+$ 符号的秩次之和。$W^{+}$ 的最小可能值为 $0$（所有符号都为负），最大可能值为秩次总和 $36$（所有符号都为正）。$W^{+}$ 的分布关于其均值 $E[W^{+}] = \\frac{1}{2} \\sum_{i=1}^{n'} R_i = \\frac{36}{2} = 18$ 对称。\n\n观测到的统计量是 $W_{obs}^{+} = 36$，这是上尾部可能的最极端值。下尾部同样极端的值是 $W_{symm}^{-} = 0$。\n\n双侧中位p值的计算公式为：\n$$p_{\\text{mid}} = P(W^{+}  W_{obs}^{+}) + \\frac{1}{2}P(W^{+} = W_{obs}^{+}) + P(W^{+}  W_{symm}^{-}) + \\frac{1}{2}P(W^{+} = W_{symm}^{-})$$\n代入 $W_{obs}^{+} = 36$ 和 $W_{symm}^{-} = 0$：\n$$p_{\\text{mid}} = P(W^{+}  36) + \\frac{1}{2}P(W^{+} = 36) + P(W^{+}  0) + \\frac{1}{2}P(W^{+} = 0)$$\n\n现在我们计算这些概率：\n- $P(W^{+}  36)$: $W^{+}$ 的最大可能值为 $36$，所以这个概率是 $0$。\n- $P(W^{+} = 36)$: 这种情况只在所有 $8$ 个非零差异都为正时发生。在 $256$ 种等可能的结果中，只有一种是这样的。因此，$P(W^{+} = 36) = \\frac{1}{256}$。\n- $P(W^{+}  0)$: $W^{+}$ 的最小可能值为 $0$，所以这个概率是 $0$。\n- $P(W^{+} = 0)$: 这种情况只在所有 $8$ 个非零差异都为负时发生。只有一种这样的结果。因此，$P(W^{+} = 0) = \\frac{1}{256}$。\n\n将这些概率代入中位p值的公式中：\n$$p_{\\text{mid}} = 0 + \\frac{1}{2} \\left( \\frac{1}{256} \\right) + 0 + \\frac{1}{2} \\left( \\frac{1}{256} \\right)$$\n$$p_{\\text{mid}} = \\frac{1}{512} + \\frac{1}{512} = \\frac{2}{512} = \\frac{1}{256}$$\n\n作为四舍五入到四位有效数字的小数，$\\frac{1}{256} \\approx 0.00390625$，即 $0.003906$。题目允许使用精确分数，这是更优选的。\n\n**步骤5：解释结的影响**\n差异绝对值中存在结对威尔科克森符号秩统计量 $W^{+}$ 的零分布有关键影响。\n1.  **秩次的修正**：我们必须为结组使用平均秩次，而不是使用整数秩次集合 $\\{1, 2, \\dots, n'\\}$。这导致秩次集合中包含非整数和重复值，正如我们在本问题中看到的秩次集合 $\\{2, 2, 2, 4.5, 4.5, 6.5, 6.5, 8\\}$。\n2.  **自定义零分布**：威尔科克森符号秩检验分布的标准表格假设没有结，因此不适用。$W^{+}$ 的零分布必须根据从数据中获得的实际秩次集合专门生成。虽然 $2^{n'}$ 种等可能的符号组合的原则保持不变，但 $W^{+}$ 的可能取值集合及其对应的概率会发生改变。例如，在 $n'=8$ 且无结的情况下，$W^{+}$ 可以取值 $1$，但对于我们有结的秩次，最小的非零值为 $2$。\n3.  **中位p值的解释**：中位p值是一种通用技术，用于在处理任何离散检验统计量时（无论是否存在结）校正标准p值的保守性。一个标准的双侧p值将是 $P(W^{+} \\geq 36) + P(W^{+} \\leq 0) = \\frac{1}{256} + \\frac{1}{256} = \\frac{1}{128}$。$\\frac{1}{256}$ 的中位p值不那么保守。它被解释为获得比观测结果更极端的结果的概率，加上在两个尾部上观测到该结果本身概率的一半之和。这提供了一个检验，其检验水准（第一类错误的概率）更接近名义显著性水平 $\\alpha$。",
            "answer": "$$\\boxed{\\frac{1}{256}}$$"
        },
        {
            "introduction": "非参数方法的能力远不止于比较数据的中心位置（如均值或中位数），它们还可以用来检验两个样本是否来自同一个整体分布。本练习介绍的 Kolmogorov-Smirnov (KS) 检验就是实现这一目标的强大工具。你将通过计算和比较两个样本的经验累积分布函数 (ECDF) 来亲手实践这一检验，这有助于你掌握评估和比较整个数据分布形态的核心技能。",
            "id": "4920263",
            "problem": "一项临床研究比较了两个独立队列之间的基线生物标志物浓度。假设这两个队列是从连续分布中抽取的独立简单随机样本。设治疗组为大小为 $n$ 的样本，对照组为大小为 $m$ 的样本。观测值（单位为 $\\mathrm{mg}/\\mathrm{dL}$）如下：\n\n- 治疗组 $\\mathcal{A}$ ($n = 8$): $3.1$, $4.7$, $5.0$, $5.2$, $6.3$, $6.8$, $7.4$, $9.0$。\n- 对照组 $\\mathcal{B}$ ($m = 7$): $2.9$, $3.5$, $4.4$, $5.5$, $6.0$, $7.9$, $8.2$。\n\n从样本 $X_{1}, \\dots, X_{n}$ 的经验累积分布函数 (ECDF) 的基本定义出发，即 $F_{n}(x)$ 等于不超过 $x$ 的样本点比例，对第二个样本的 $G_{m}(x)$ 也作类似定义，计算双样本柯尔莫哥洛夫-斯米尔诺夫统计量，该统计量是两个 ECDF 之间绝对差对所有 $x$ 的上确界。\n\n然后，在两个样本均从同一连续分布中抽取的原假设下，使用标度化的柯尔莫哥洛夫-斯米尔诺夫统计量的大样本渐近零分布来获得 $p$ 值的近似值。将 $p$ 值四舍五入到四位有效数字。将您的最终答案以行矩阵的形式报告，矩阵中依次包含柯尔莫哥洛夫-斯米尔诺夫统计量和近似的 $p$ 值，矩阵内不含单位。",
            "solution": "用户要求我解决一个涉及双样本柯尔莫哥洛夫-斯米尔诺夫 (KS) 检验的生物统计学问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   **提取已知条件：** 我需要列出两个样本数据集、它们的样本大小、ECDF 的定义、KS 统计量的定义，以及计算该统计量和使用渐近分布近似 p 值的任务。\n    *   **检查无效性：**\n        *   **科学依据：** KS 检验是一种标准的、成熟的非参数方法。ECDF 是一个基本概念。渐近分布也是标准的。这在科学上是合理的。\n        *   **良态性（Well-Posed）：** 问题提供了计算统计量和 p 值所需的所有数据和定义。解应该是唯一的。\n        *   **客观性：** 问题以精确的数学和统计术语陈述。没有主观语言。\n        *   **自洽性：** 它提供了数据和所需的定义。\n        *   **现实性：** 数据值对于生物标志物浓度来说是合理的。样本量很小，但问题明确要求使用大样本近似，这是一个标准的学术练习。\n\n    *   **结论：** 此问题看来是有效的。\n\n2.  **解决问题：**\n    *   **步骤 1：定义 ECDF。**\n        *   对于样本 $X_1, \\ldots, X_n$，ECDF 为 $F_n(x) = \\frac{1}{n} \\sum_{i=1}^n I(X_i \\le x)$，其中 $I(\\cdot)$ 是指示函数。\n        *   因此，队列 $\\mathcal{A}$（治疗组）的 $F_n(x)$ 将是一个阶梯函数，在每个观测值处跳跃 $1/n = 1/8$。\n        *   同样，队列 $\\mathcal{B}$（对照组）的 $G_m(x)$ 将是一个阶梯函数，在每个观测值处跳跃 $1/m = 1/7$。\n\n    *   **步骤 2：计算 KS 统计量 $D_{n,m}$。**\n        *   KS 统计量定义为 $D_{n,m} = \\sup_x |F_n(x) - G_m(x)|$。\n        *   上确界将出现在合并样本的某个观测数据点上。\n        *   让我们创建一个包含所有唯一观测值的合并排序列表。\n        *   合并样本 ($n+m = 15$): $2.9 (\\mathcal{B}), 3.1 (\\mathcal{A}), 3.5 (\\mathcal{B}), 4.4 (\\mathcal{B}), 4.7 (\\mathcal{A}), 5.0 (\\mathcal{A}), 5.2 (\\mathcal{A}), 5.5 (\\mathcal{B}), 6.0 (\\mathcal{B}), 6.3 (\\mathcal{A}), 6.8 (\\mathcal{A}), 7.4 (\\mathcal{A}), 7.9 (\\mathcal{B}), 8.2 (\\mathcal{B}), 9.0 (\\mathcal{A})$。\n        *   我需要计算在这些点上每个点的 $|F_n(x) - G_m(x)|$。ECDF 是右连续的，所以我们评估 $F_n(x_i)$ 和 $G_m(x_i)$。差值 $|F_n(x) - G_m(x)|$ 在点与点之间是恒定的，所以我们只需要检查跳跃点处和跳跃点之前的值。\n        *   设 $x_{(i)}$ 为合并样本中第 $i$ 个有序值。上确界在某个样本值处达到。所以我们需要计算 $D_{n,m} = \\max_{i} |F_n(x_{(i)}) - G_m(x_{(i)})|$ 和 $\\max_{i} |F_n(x_{(i-1)}) - G_m(x_{(i-1)})|$。\n        *   一个更高效的方法是在合并样本中的每个点 $z$ 处计算差值，包括恰好在该点之前和在该点之时。\n        *   设 $S_A = \\{3.1, 4.7, 5.0, 5.2, 6.3, 6.8, 7.4, 9.0\\}$, $n=8$。\n        *   设 $S_B = \\{2.9, 3.5, 4.4, 5.5, 6.0, 7.9, 8.2\\}$, $m=7$。\n        *   让我们创建一个表格。\n| $x$ | 队列 | $F_8(x)$ (跳跃后的值) | $G_7(x)$ (跳跃后的值) | $|F_8(x) - G_7(x)|$ |\n|---|---|---|---|---|\n| $ 2.9$ | - | $0/8=0$ | $0/7=0$ | 0 |\n| $2.9$ | $\\mathcal{B}$ | $0/8=0$ | $1/7 \\approx 0.1429$| $1/7 \\approx 0.1429$|\n| $3.1$ | $\\mathcal{A}$ | $1/8=0.125$ | $1/7 \\approx 0.1429$| $|0.125 - 0.1429| \\approx 0.0179$|\n| $3.5$ | $\\mathcal{B}$ | $1/8=0.125$ | $2/7 \\approx 0.2857$| $|0.125 - 0.2857| \\approx 0.1607$|\n| $4.4$ | $\\mathcal{B}$ | $1/8=0.125$ | $3/7 \\approx 0.4286$| $|0.125 - 0.4286| \\approx 0.3036$|\n| $4.7$ | $\\mathcal{A}$ | $2/8=0.25$ | $3/7 \\approx 0.4286$| $|0.25 - 0.4286| \\approx 0.1786$|\n| $5.0$ | $\\mathcal{A}$ | $3/8=0.375$ | $3/7 \\approx 0.4286$| $|0.375 - 0.4286| \\approx 0.0536$|\n| $5.2$ | $\\mathcal{A}$ | $4/8=0.5$ | $3/7 \\approx 0.4286$| $|0.5 - 0.4286| \\approx 0.0714$|\n| $5.5$ | $\\mathcal{B}$ | $4/8=0.5$ | $4/7 \\approx 0.5714$| $|0.5 - 0.5714| \\approx 0.0714$|\n| $6.0$ | $\\mathcal{B}$ | $4/8=0.5$ | $5/7 \\approx 0.7143$| $|0.5 - 0.7143| \\approx 0.2143$|\n| $6.3$ | $\\mathcal{A}$ | $5/8=0.625$ | $5/7 \\approx 0.7143$| $|0.625 - 0.7143| \\approx 0.0893$|\n| $6.8$ | $\\mathcal{A}$ | $6/8=0.75$ | $5/7 \\approx 0.7143$| $|0.75 - 0.7143| \\approx 0.0357$|\n| $7.4$ | $\\mathcal{A}$ | $7/8=0.875$ | $5/7 \\approx 0.7143$| $|0.875 - 0.7143| \\approx 0.1607$|\n| $7.9$ | $\\mathcal{B}$ | $7/8=0.875$ | $6/7 \\approx 0.8571$| $|0.875 - 0.8571| \\approx 0.0179$|\n| $8.2$ | $\\mathcal{B}$ | $7/8=0.875$ | $7/7 = 1$ | $|0.875 - 1| = 0.125$ |\n| $9.0$ | $\\mathcal{A}$ | $8/8=1$ | $7/7 = 1$ | 0 |\n\n该表计算了在合并样本中的点 $x$ 处的差值 $|F_n(x) - G_m(x)|$。然而，上确界是跳跃点之前或之后评估的差值的最大值。\n设 $Z = S_{\\mathcal{A}} \\cup S_{\\mathcal{B}}$ 是合并观测值的集合。那么 $D_{n,m} = \\sup_x |F_n(x) - G_m(x)| = \\max_{z \\in Z} \\{\\max(|F_n(z) - G_m(z)|, |F_n(z^-) - G_m(z^-)|)\\}$。\n$F_n(z^-) = \\lim_{x \\to z^-} F_n(x)$。\n让我们重新思考计算过程。让我们创建一个更精确的表格。\n$n=8, m=7$。让我们使用分数以求精确。\n合并排序数据：$z_1=2.9(B), z_2=3.1(A), z_3=3.5(B), z_4=4.4(B), z_5=4.7(A), z_6=5.0(A), z_7=5.2(A), z_8=5.5(B), z_9=6.0(B), z_{10}=6.3(A), z_{11}=6.8(A), z_{12}=7.4(A), z_{13}=7.9(B), z_{14}=8.2(B), z_{15}=9.0(A)$。\n\n设 $i_j$ 是来自样本 A 的点数 $\\le z_j$。\n设 $k_j$ 是来自样本 B 的点数 $\\le z_j$。\n$F_n(z_j) = i_j/n$, $G_m(z_j) = k_j/m$。\n$F_n(z_j^-) = (i_j-1)/n$ 如果 $z_j \\in S_A$，否则为 $i_j/n$。更准确地说，$F_n(z_j^-) = i_{j-1}/n$。\n$G_m(z_j^-) = (k_j-1)/m$ 如果 $z_j \\in S_B$，否则为 $k_j/m$。更准确地说，$G_m(z_j^-) = k_{j-1}/m$。\n\n让我们只计算合并排序列表中每个点 $z_j$ 的差值。\nECDF 的值只在数据点处改变。所以差值的上确界必定在这些数据点之一处出现。\n我们需要检查合并列表中每个数据点 $x_j$ 之前和之后的 $|F_n(x) - G_m(x)|$ 值。\n让我们列出合并的数据点和每个点上的 ECDF。\n\n$n=8, m=7$。\n值是 $1/8 = 0.125$ 和 $1/7 \\approx 0.142857$。\n让我们用分数来精确计算。\n$F_8(x)$: 跳跃 $1/8$。$G_7(x)$: 跳跃 $1/7$。\n\n| j | $z_j$ | 来自 | 累积 A | 累积 B | $F_8(z_j)$ | $G_7(z_j)$ | $|F_8 - G_7|$ |\n|---|---|---|---|---|---|---|---|\n| 0 | $ 2.9$ | - | 0 | 0 | 0 | 0 | 0 |\n| 1 | 2.9 | B | 0 | 1 | 0 | $1/7$ | $|0 - 1/7| = 1/7$ |\n| 2 | 3.1 | A | 1 | 1 | $1/8$ | $1/7$ | $|1/8 - 1/7| = |-1/56| = 1/56$ |\n| 3 | 3.5 | B | 1 | 2 | $1/8$ | $2/7$ | $|1/8 - 2/7| = |-9/56| = 9/56$ |\n| 4 | 4.4 | B | 1 | 3 | $1/8$ | $3/7$ | $|1/8 - 3/7| = |-17/56| = 17/56 \\approx 0.3036$ |\n| 5 | 4.7 | A | 2 | 3 | $2/8=1/4$ | $3/7$ | $|1/4 - 3/7| = |-5/28| = 5/28 \\approx 0.1786$ |\n| 6 | 5.0 | A | 3 | 3 | $3/8$ | $3/7$ | $|3/8 - 3/7| = |-3/56| = 3/56$ |\n| 7 | 5.2 | A | 4 | 3 | $4/8=1/2$ | $3/7$ | $|1/2 - 3/7| = |1/14| = 1/14$ |\n| 8 | 5.5 | B | 4 | 4 | $4/8=1/2$ | $4/7$ | $|1/2 - 4/7| = |-1/14| = 1/14$ |\n| 9 | 6.0 | B | 4 | 5 | $4/8=1/2$ | $5/7$ | $|1/2 - 5/7| = |-3/14| = 3/14$ |\n| 10 | 6.3 | A | 5 | 5 | $5/8$ | $5/7$ | $|5/8 - 5/7| = |-5/56| = 5/56$ |\n| 11 | 6.8 | A | 6 | 5 | $6/8=3/4$ | $5/7$ | $|3/4 - 5/7| = |1/28| = 1/28$ |\n| 12 | 7.4 | A | 7 | 5 | $7/8$ | $5/7$ | $|7/8 - 5/7| = |9/56| = 9/56$ |\n| 13 | 7.9 | B | 7 | 6 | $7/8$ | $6/7$ | $|7/8 - 6/7| = |1/56| = 1/56$ |\n| 14 | 8.2 | B | 7 | 7 | $7/8$ | $7/7=1$ | $|7/8 - 1| = |-1/8| = 1/8$ |\n| 15 | 9.0 | A | 8 | 7 | $8/8=1$ | $7/7=1$ | 0 |\n\n此表计算了 $|F_n(z_j) - G_m(z_j)|$。但是上确界也必须考虑在跳跃点 $z_j$ *之前*的函数值。我们称它们为 $F_n(z_j^-)$ 和 $G_m(z_j^-)$。\n$F_n(z_j^-) = F_n(z_{j-1})$ 且 $G_m(z_j^-) = G_m(z_{j-1})$。\n所以我们还需要检查差值 $|F_n(z_{j-1}) - G_m(z_{j-1})|$。这已经在前一行中。\n关键是在 $x=z_j$ 处，差值可能是 $|F_n(z_j) - G_m(z_j)|$ 或 $|F_n(z_j^-) - G_m(z_j^-)|$。\n例如，让我们看一下 $z_4 = 4.4$。\n$F_8(4.4) = 1/8$, $G_7(4.4) = 3/7$。差值为 $|1/8 - 3/7| = 17/56$。\n在 $4.4$ 之前，比如在 $x = 4.4 - \\epsilon$，ECDF 是基于直到 $z_3=3.5$ 的值。\n$F_8(z_4^-) = F_8(z_3) = 1/8$。\n$G_7(z_4^-) = G_7(z_3) = 2/7$。\n差值为 $|1/8 - 2/7| = 9/56$。\n因此，我们需要在每个点 $z_j$ 检查两个差值：\n1. Diff_post: $|F_n(z_j) - G_m(z_j)| = |i_j/n - k_j/m|$\n2. Diff_pre: $|F_n(z_j^-) - G_m(z_j^-)| = |i_{j-1}/n - k_{j-1}/m|$。这只是前一个点 $z_{j-1}$ 的 Diff_post。\n因此，最大差值的候选集合就是所有 $j=1, ..., n+m$ 的 $|F_n(z_j) - G_m(z_j)|$ 的列表。\n\n让我们检查一下差值表：\n$1/7 \\approx 0.1429$\n$1/56 \\approx 0.0179$\n$9/56 \\approx 0.1607$\n$17/56 \\approx 0.3036$ 这是目前为止的最大值。\n$5/28 = 10/56 \\approx 0.1786$\n$3/56 \\approx 0.0536$\n$1/14 = 4/56 \\approx 0.0714$\n$1/14 = 4/56 \\approx 0.0714$\n$3/14 = 12/56 \\approx 0.2143$\n$5/56 \\approx 0.0893$\n$1/28 = 2/56 \\approx 0.0357$\n$9/56 \\approx 0.1607$\n$1/56 \\approx 0.0179$\n$1/8 = 7/56 \\approx 0.125$\n$0$\n\n在 $|F_8 - G_7|$ 列中的最大值是 $17/56$。\n这发生在 $x=4.4$ 处。\n在 $x=4.4$ 处，$F_8(4.4) = 1/8$ 且 $G_7(4.4) = 3/7$。\n差值为 $|1/8 - 3/7| = |\\frac{7-24}{56}| = |-17/56| = 17/56$。\nKS 统计量是 $D_{n,m} = D_{8,7} = 17/56$。\n让我们计算其小数形式：$17/56 \\approx 0.3035714$。\n\n*   **步骤 3：近似 p 值。**\n    *   问题要求使用大样本渐近零分布。\n    *   在两个样本来自同一连续分布的原假设 $H_0$ 下，标度化的统计量\n        $$K_{n,m} = \\sqrt{\\frac{nm}{n+m}} D_{n,m}$$\n        在分布上收敛于柯尔莫哥洛夫分布。\n    *   柯尔莫哥洛夫分布的 CDF 由下式给出\n        $$ \\text{Prob}(K \\le k) = 1 - 2 \\sum_{i=1}^{\\infty} (-1)^{i-1} \\exp(-2i^2 k^2) $$\n    *   p 值是观测到至少与计算出的统计量一样极端的统计量的概率。\n        $$ p = \\text{Prob}(K \\ge k_{obs}) $$\n        其中 $k_{obs}$ 是标度化统计量的观测值。\n    *   对于大的 $k$，p 值可以用级数的第一项来近似：\n        $$ p \\approx 2 \\exp(-2 k_{obs}^2) $$\n    *   首先，计算标度化统计量 $k_{obs}$。\n        $n=8, m=7$。\n        $n+m = 15$。\n        $nm = 56$。\n        标度因子：$\\sqrt{\\frac{nm}{n+m}} = \\sqrt{\\frac{56}{15}}$。\n        $k_{obs} = \\sqrt{\\frac{56}{15}} \\times D_{8,7} = \\sqrt{\\frac{56}{15}} \\times \\frac{17}{56} = \\frac{17}{\\sqrt{15 \\times 56}} = \\frac{17}{\\sqrt{840}}$。\n    *   让我们计算 $k_{obs}$ 的值。\n        $\\sqrt{840} = \\sqrt{4 \\times 210} = 2\\sqrt{210}$。\n        $k_{obs} = \\frac{17}{2\\sqrt{210}}$。\n        $k_{obs} \\approx \\frac{17}{2 \\times 14.49137} \\approx \\frac{17}{28.9827} \\approx 0.58655$。\n\n    *   现在，使用近似式 $p \\approx 2 \\exp(-2 k_{obs}^2)$ 计算 p 值。\n        $k_{obs}^2 = \\left(\\frac{17}{\\sqrt{840}}\\right)^2 = \\frac{17^2}{840} = \\frac{289}{840}$。\n        $k_{obs}^2 \\approx 0.3440476$。\n        $p \\approx 2 \\exp(-2 \\times \\frac{289}{840}) = 2 \\exp(-\\frac{289}{420})$。\n        $-\\frac{289}{420} \\approx -0.688095$。\n        $p \\approx 2 \\exp(-0.688095) \\approx 2 \\times 0.50253$。\n        $p \\approx 1.00506$。\n\n    *   等等，p 值不能大于 1。这意味着近似式 $2\\exp(-2k^2)$ 不够准确，或者我犯了一个错误。\n        让我们重新阅读 p 值的公式。\n        $P(K > k) = 2 \\sum_{i=1}^{\\infty} (-1)^{i-1} \\exp(-2i^2 k^2)$。\n        $P(K > k) = 2(\\exp(-2k^2) - \\exp(-8k^2) + \\exp(-18k^2) - \\dots)$。\n        近似式 $2\\exp(-2k^2)$ 适用于大的 $k$。$k_{obs} \\approx 0.58655$ 算大吗？不算。\n        这种近似效果好的 $k$ 值通常大于 $1.5$ 左右。\n        这里，我们需要使用更多的项。\n\n        设 $k_{obs} = \\frac{17}{\\sqrt{840}}$ 且 $k_{obs}^2 = \\frac{289}{840}$。\n        $p = 2 \\left( \\exp(-2 k_{obs}^2) - \\exp(-8 k_{obs}^2) + \\exp(-18 k_{obs}^2) - \\dots \\right)$\n        $p = 2 \\left( \\exp(-2 \\frac{289}{840}) - \\exp(-8 \\frac{289}{840}) + \\exp(-18 \\frac{289}{840}) - \\dots \\right)$\n        $p = 2 \\left( \\exp(-\\frac{289}{420}) - \\exp(-\\frac{2312}{840}) + \\exp(-\\frac{5202}{840}) - \\dots \\right)$\n        $p = 2 \\left( \\exp(-\\frac{289}{420}) - \\exp(-\\frac{289}{105}) + \\exp(-\\frac{289}{46.66...}) - \\dots \\right)$\n        \n        让我们使用小数值。\n        $k_{obs}^2 \\approx 0.3440476$。\n        $2k_{obs}^2 \\approx 0.6880952$\n        $8k_{obs}^2 \\approx 2.752381$\n        $18k_{obs}^2 \\approx 6.192857$\n        $32k_{obs}^2 \\approx 10.909... $ (下一项 $i=4$)\n\n        第 1 项: $\\exp(-0.6880952) \\approx 0.502534$\n        第 2 项: $\\exp(-2.752381) \\approx 0.063781$\n        第 3 项: $\\exp(-6.192857) \\approx 0.002044$\n        第 4 项: $\\exp(-10.909...) \\approx 0.000018$\n\n        $p \\approx 2 \\times (0.502534 - 0.063781 + 0.002044 - 0.000018)$\n        $p \\approx 2 \\times (0.438753 + 0.002026)$\n        $p \\approx 2 \\times (0.440779)$\n        $p \\approx 0.881558$\n\n    *   问题要求将 p 值四舍五入到四位有效数字。\n        $p \\approx 0.8816$。\n\n    *   让我们停下来反思一下。p 值为 0.8816 是非常高的，表明原假设非常可信。这与数据是否相符？\n        最大差值 $D_{n,m}$ 是 $17/56 \\approx 0.3036$。让我们考虑一下 $D_{n,m}$ 的可能范围。它可以达到 1。\n        小样本量 $n=8, m=7$ 意味着 ECDF 相当粗糙。0.3 的差异可能并不那么显著。\n        作为比较，使用渐近公式在 $\\alpha=0.05$ 时的 $D_{n,m}$ 临界值将是\n        $D_{crit} \\approx c_{\\alpha} / \\sqrt{\\frac{nm}{n+m}}$ 其中 $c_{0.05} \\approx 1.358$。\n        $D_{crit} \\approx 1.358 / \\sqrt{56/15} = 1.358 / 1.932 = 0.7029$。\n        我们观测到的 $D_{8,7}=0.3036$ 远小于这个临界值，所以预期会得到一个大的 p 值。\n        对于如此小的样本（$n=8, m=7$），使用渐近分布是众所周知不准确的。它倾向于产生保守的 p 值（即比确切的 p 值更大）。然而，问题明确指示要使用这种近似方法。\n\n    *   让我们重新验证计算。\n        *   KS 统计量 $D_{8,7} = 17/56$。\n            表格检查：\n            $z=2.9, |0-1/7|=1/7=8/56$\n            $z=3.1, |1/8-1/7|=1/56$\n            $z=3.5, |1/8-2/7|=9/56$\n            $z=4.4, |1/8-3/7|=17/56 \\leftarrow$ 最大差值\n            $z=4.7, |2/8-3/7|=|1/4-3/7|=5/28=10/56$\n            ...\n            $z=6.0, |4/8-5/7|=|1/2-5/7|=3/14=12/56$\n            最大差值确实是 $17/56$。这部分是正确的。\n\n        *   标度化统计量 $k_{obs}$。\n            $k_{obs} = \\sqrt{\\frac{8 \\times 7}{8+7}} \\times \\frac{17}{56} = \\sqrt{\\frac{56}{15}} \\times \\frac{17}{56} = \\frac{17}{\\sqrt{56 \\times 15/56^2}} \\times \\frac{56}{56}$ 等等...\n            $k_{obs} = \\sqrt{\\frac{56}{15}} \\frac{17}{56} = \\frac{17 \\sqrt{56}}{\\sqrt{15} \\times 56} = \\frac{17}{\\sqrt{15} \\sqrt{56}} = \\frac{17}{\\sqrt{840}}$。正确。\n            $k_{obs}^2 = 289/840$。正确。\n\n        *   p 值计算。\n            $p = 2 \\sum_{i=1}^{\\infty} (-1)^{i-1} \\exp(-2i^2 k^2)$\n            $k^2 = 289/840$。\n            第 1 项 ($i=1$): $2 \\exp(-2 \\times 289/840) = 2 \\exp(-289/420)$。\n            第 2 项 ($i=2$): $-2 \\exp(-8 \\times 289/840) = -2 \\exp(-289/105)$。\n            第 3 项 ($i=3$): $2 \\exp(-18 \\times 289/840) = 2 \\exp(-289 \\times 9 / 420) = 2 \\exp(-2601/420) = 2 \\exp(-867/140)$。\n            让我们用更高精度的计算器重新计算。\n            $k_{obs} = 17 / \\sqrt{840} \\approx 0.5865503$\n            $k_{obs}^2 = 289/840 \\approx 0.344047619$\n            $2 k_{obs}^2 \\approx 0.688095238$\n            $8 k_{obs}^2 \\approx 2.752380952$\n            $18 k_{obs}^2 \\approx 6.192857143$\n            $32 k_{obs}^2 \\approx 10.90952381$\n\n            $\\exp(-0.688095238) \\approx 0.50253406$\n            $\\exp(-2.752380952) \\approx 0.06378135$\n            $\\exp(-6.192857143) \\approx 0.00204415$\n            $\\exp(-10.90952381) \\approx 0.00001828$\n\n            总和 = $0.50253406 - 0.06378135 + 0.00204415 - 0.00001828 + \\dots$\n            总和 $\\approx 0.43875271 + 0.00204415 - 0.00001828 = 0.44079686 - 0.00001828 = 0.44077858$。\n            \n            $p$ 值 = $2 \\times \\text{总和} \\approx 2 \\times 0.44077858 = 0.88155716$。\n\n            四舍五入到四位有效数字：$0.8816$。\n\n3.  **最终整合：**\n    *   声明问题是有效的。\n    *   清晰地列出解决步骤。\n    *   定义 ECDF $F_n(x)$ 和 $G_m(x)$。\n    *   解释 KS 统计量 $D_{n,m}$ 是绝对差的上确界，并通过在每个数据点评估差值来找到。\n    *   构建显示差值计算的表格。\n    *   陈述结果 $D_{8,7} = 17/56$。\n    *   定义标度化统计量 $K_{n,m}$ 及其渐近柯尔莫哥洛夫分布。\n    *   计算观测到的标度化统计量 $k_{obs}$。\n    *   陈述从柯尔莫哥洛夫分布的尾概率计算 p 值的公式。\n    *   使用级数的前几项计算 p 值。\n    *   按要求对值进行四舍五入。\n    *   最终答案必须是行矩阵 `\\begin{pmatrix} D_{n,m}  p \\end{pmatrix}`。\n    *   KS 统计量本身不需要四舍五入。p 值需要四舍五入到 4 位有效数字。\n    *   KS 统计量：$17/56$。这是一个精确分数。我将以这种形式报告。等等，问题没有指定 KS 统计量的形式。小数表示在报告中可能更常规。让我们提供一个合理的小数表示。让我们遵循将检验统计量报告到 3 或 4 个小数位的惯例。\n    *   $17/56 \\approx 0.30357$。让我们使用 4 个小数位，$0.3036$。\n    *   p 值：$0.8816$。\n    *   让我们重新考虑 KS 统计量的报告方式。如果我以小数形式报告它，我就引入了一个没有被要求的四舍五入。让我将其报告为精确分数 $17/56$。但指令是“仅最终答案”。但是如何写一个包含分数和小数的矩阵？我认为两者都提供为小数更好。\n    *   “将 p 值四舍五入到四位有效数字”。这是对 p 值的明确指示。对统计量没有指示。\n    *   让我们检查其他报告此内容的示例。通常检验统计量报告为 2-4 个小数位。我将使用 4 个小数位，以与 p 值要求的精度保持一致。\n    *   $D_{8,7} = 17/56 \\approx 0.3036$。\n    *   p 值 $\\approx 0.8816$。\n    *   最终答案将是 $\\begin{pmatrix} 0.3036  0.8816 \\end{pmatrix}$。这似乎是合理的。用分数更好吗？`\\begin{pmatrix} \\frac{17}{56}  0.8816 \\end{pmatrix}`。让我们看看说明。“对于数值答案，除非问题陈述要求近似，否则保留精确形式。”KS 统计量是计算的结果。$17/56$ 是它的精确形式。p 值的计算从一开始就是近似的，并且需要四舍五入。所以一个精确一个近似是有道理的。让我们用这个方案。\n\n    *   再次检查整个过程。\n        - 问题验证：通过。\n        - ECDF 定义：正确。\n        - KS 统计量定义：正确。\n        - KS 统计量计算：\n            - 所有 $15$ 个点的排序列表。\n            - ECDF 以 $1/8$ 和 $1/7$ 的步长跳跃。\n            - 创建了每个点的差值表。这是标准方法。\n            - $D_{n,m} = \\max_j |F_n(z_j) - G_m(z_j)|$ 或 $\\max_j |F_n(z_j^-) - G_m(z_j^-)|$。集合 $\\{|F_n(z_j)-G_m(z_j)|\\}$ 和 $\\{|F_n(z_j^-)-G_m(z_j^-)|\\}$ 与 $\\{|F_n(z_j)-G_m(z_j)|\\}$ 和 $\\{|F_n(z_{j})-G_m(z_j^-)|\\}$ 相同。\n            - 让我们检查这个细节，因为这是一个常见的混淆点。\n            $D = \\sup_x |F_n(x) - G_m(x)|$。上确界在观测点 $z_j$ 之一处达到。在 $z_j$ 处，差值可以在跳跃前或跳跃时/后。\n            设 $i_j, k_j$ 是 $\\le z_j$ 的观测值的累积计数。那么 $F_n(z_j) = i_j/n$, $G_m(z_j) = k_j/m$。\n            且 $F_n(z_j^-) = i_{j-1}/n$, $G_m(z_j^-) = k_{j-1}/m$。\n            所以我们需要检查所有 $j=1, \\dots, n+m$ 的 $|i_j/n - k_j/m|$ 和 $|i_{j-1}/n - k_{j-1}/m|$。\n            基本上，这意味着在每次跳跃后计算差值并取最大值。我的表格正是这样做的。最大值是 $17/56$。所以这是正确的。\n        - 渐近分布和 p 值：\n            - 标度化统计量 $K_{n,m}$ 的公式是正确的。\n            - 计算是正确的：$k_{obs} = \\frac{17}{\\sqrt{840}}$。\n            - 柯尔莫哥洛夫分布尾概率的公式是正确的。\n            - 使用前几项的计算是正确的。\n            - 四舍五入到 4 位有效数字是正确的。\n        - 最终答案格式：使用 `pmatrix` 的行矩阵。一个精确分数，一个四舍五入的小数。这似乎是对规则最忠实的解释。\n\n逻辑看起来很可靠。我现在将写下解答。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{17}{56}  0.8816 \\end{pmatrix} } $$"
        }
    ]
}