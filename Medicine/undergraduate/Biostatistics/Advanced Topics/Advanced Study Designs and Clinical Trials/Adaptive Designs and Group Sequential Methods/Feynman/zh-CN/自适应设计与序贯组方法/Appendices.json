{
    "hands_on_practices": [
        {
            "introduction": "在贯序试验中，由于我们在多个时间点上对累积数据进行分析，必须仔细控制总体I类错误率。$\\alpha$消耗函数 (alpha-spending function) 为此提供了一个优雅的解决方案，它允许我们在试验进程中动态“花费”预设的总I类错误概率$\\alpha$。本练习  将通过一个简单而常见的线性消耗函数，帮助你直观地理解错误率是如何在试验的不同阶段被分配和使用的。",
            "id": "4892107",
            "problem": "一项单侧成组序贯临床试验旨在检验治疗效果，计划总 I 型错误水平为 $\\alpha$，并在累积信息时间 $t \\in [0,1]$ 进行 $K=4$ 次期中分析。该设计使用一个 $\\alpha$ 消耗函数，定义为一个非递减函数 $\\alpha(t)$，满足 $\\alpha(0)=0$ 和 $\\alpha(1)=\\alpha$，以控制各次分析中假阳性的累积概率。假设该设计指定了线性消耗函数 $\\alpha(t)=\\alpha t$。第三次分析在信息分数为 $t_3=0.75$ 时进行。\n\n计算到第三次分析为止累积消耗的总 I 型错误 $\\alpha$ 的比例。答案以小数形式表示，无需四舍五入。用一两句话解释该比例对于第三次分析与之前分析相比提前终止的可能性意味着什么，但最终答案只报告数值比例。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   该试验是一项单侧成组序贯临床试验。\n-   总I型错误水平为$\\alpha$。\n-   期中分析次数为$K=4$。\n-   累积信息时间由$t \\in [0,1]$表示。\n-   使用了一个$\\alpha$消耗函数$\\alpha(t)$，它是一个非递减函数，满足$\\alpha(0)=0$和$\\alpha(1)=\\alpha$。\n-   特定的消耗函数是线性函数$\\alpha(t) = \\alpha t$。\n-   第三次期中分析在信息分数为$t_3 = 0.75$时进行。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在生物统计学理论中有充分依据，特别是关于成组序贯方法和适应性设计。由Lan和DeMets引入的$\\alpha$消耗函数概念，是设计临床试验期中分析的标准和基本工具。线性消耗函数$\\alpha(t) = \\alpha t$是一个常见且有效的选择。\n-   **适定性**：该问题是适定的。它提供了一个特定的数学函数和计算所需量所需的所有必要值。问题明确无歧义，并有唯一、稳定的解。\n-   **客观性**：该问题使用生物统计学领域的标准、客观、精确的术语进行陈述。\n-   **完整性和一致性**：所提供的信息是完整且内部一致的。不存在矛盾。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n此问题的核心是应用定义的$\\alpha$消耗函数。函数$\\alpha(t)$指定了到信息分数$t$为止，为拒绝原假设而分配的总 I 型错误$\\alpha$的累积比例。\n\n问题陈述$\\alpha$消耗函数是信息时间$t$的线性函数：\n$$\n\\alpha(t) = \\alpha t\n$$\n其中$\\alpha$是试验的总 I 型错误。\n\n我们被要求计算到第$3$次分析为止累积消耗的总 I 型错误$\\alpha$的*比例*。这次分析在信息分数为$t_3 = 0.75$时进行。\n\n首先，我们通过在$t = t_3$处计算消耗函数$\\alpha(t)$来计算到第三次分析（含）为止累积消耗的 I 型错误：\n$$\n\\alpha(t_3) = \\alpha \\times t_3\n$$\n代入给定的值$t_3 = 0.75$，我们得到：\n$$\n\\alpha(0.75) = \\alpha \\times 0.75\n$$\n这个表达式$0.75\\alpha$表示到第三次分析为止累积消耗的 I 型错误的绝对量。\n\n问题要求的是这个量占总 I 型错误$\\alpha$的*比例*。这个比例是在第$3$次分析时累积消耗的$\\alpha$与整个试验计划的总$\\alpha$的比值。\n$$\n\\text{Fraction} = \\frac{\\alpha(t_3)}{\\alpha}\n$$\n代入$\\alpha(t_3)$的表达式：\n$$\n\\text{Fraction} = \\frac{0.75\\alpha}{\\alpha}\n$$\n分子和分母中的$\\alpha$项相互抵消，前提是$\\alpha \\neq 0$，这是假设检验的一个基本假设。\n$$\n\\text{Fraction} = 0.75\n$$\n问题要求答案以小数表示，而它已经是小数形式。\n\n至于解释，这个比例意味着总 I 型错误的线性分配，即当收集到75%的信息时，已经使用了75%做出假阳性声明的机会。这使得在第$3$次分析时因有效而终止试验的可能性，比在更早的分析中（因为消耗了更多的累积$\\alpha$）更高，也比在更保守的消耗方案（如 O'Brien-Fleming 方案，该方案为试验后期保留更多$\\alpha$）下更高。",
            "answer": "$$\n\\boxed{0.75}\n$$"
        },
        {
            "introduction": "采用贯序设计的一个主要动机是提高临床试验的效率，即有机会在证明有效性或无效性后提前终止试验，从而节省时间和资源。衡量这种效率的关键指标是“期望样本量” (expected sample size)。本练习  将指导你推导并计算这一指标，让你亲身体会早期停止的概率是如何转化为平均样本量的节省的。",
            "id": "4892080",
            "problem": "一项双臂随机临床试验采用组序贯设计，包含一次期中分析和一次期末分析，旨在比较一种新疗法与对照组。主要终点近似服从正态分布，且各臂方差相等。第 $k$ 次分析时的标准化检验统计量记为 $Z_k$。假设组序贯统计量服从典型的联合正态模型：根据中心极限定理 (CLT)，对于在第 $k$ 次分析时累积的信息分数 $t_k \\in (0,1]$，在真实标准化治疗效应为 $\\theta$ 的情况下，该统计量满足 $Z_k \\sim \\mathcal{N}(\\theta \\sqrt{t_k}, 1)$，其中 $\\mathcal{N}(\\mu,\\sigma^2)$ 表示均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。\n\n该设计按如下方式进行：\n- 计划的最大总样本量为 $n_{\\max} = 240$ 名受试者。\n- 期中分析在纳入 $n_1 = 120$ 名受试者后进行，因此信息分数为 $t_1 = n_1 / n_{\\max}$。\n- 期中分析采用双侧有效性中止规则：如果 $|Z_1| \\ge c_1$（其中 $c_1 = 2.0$），则因有效性提前中止试验。如果未达到期中止规则，试验将继续进行，直至达到 $n_{\\max}$ 的期末分析。\n\n请根据第一性原理，用分析指数的中止分布来定义此组序贯设计的期望样本量，并推导出期望样本量作为真实效应 $\\theta$、期中界值 $c_1$ 和计划的最大样本量 $n_{\\max}$ 的函数的解析表达式。然后，使用上述设计参数，计算当 $\\theta = 0.3$ 时的期望样本量。在适当之处使用标准正态累积分布函数 $\\Phi(\\cdot)$。将最终的期望样本量四舍五入至 $4$ 位有效数字。以“受试者”为单位表示答案。",
            "solution": "该问题提法明确，科学上基于生物统计学原理，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的。\n\n组序贯设计的期望样本量，记为 $E[N|\\theta]$，取决于真实的治疗效应 $\\theta$。样本量 $N$ 是一个离散随机变量，在本例中可以取两个可能的值：如果试验在期中分析时中止，则为 $n_1$；如果试验继续到期末分析，则为 $n_{\\max}$。\n\n离散随机变量的期望值的定义是该变量的每个可能值与其相应概率的乘积之和。因此，期望样本量由下式给出：\n$$\nE[N|\\theta] = n_1 \\cdot P(N=n_1 | \\theta) + n_{\\max} \\cdot P(N=n_{\\max} | \\theta)\n$$\n如果满足中止条件 $|Z_1| \\ge c_1$，试验将在期中分析时中止。在这种情况下，样本量为 $N=n_1$。此事件的概率为 $P(N=n_1 | \\theta) = P(|Z_1| \\ge c_1 | \\theta)$。\n如果未满足中止条件，即 $|Z_1|  c_1$，试验将继续到期末分析，样本量为 $N=n_{\\max}$。继续的概率为 $P(N=n_{\\max} | \\theta) = P(|Z_1|  c_1 | \\theta)$。\n\n由于这是第一阶段仅有的两种结果，其概率之和为 1：\n$$\nP(|Z_1|  c_1 | \\theta) = 1 - P(|Z_1| \\ge c_1 | \\theta)\n$$\n让我们将在期中分析时中止的概率记为 $p_1(\\theta) = P(|Z_1| \\ge c_1 | \\theta)$。期望样本量的表达式可以重写为：\n$$\nE[N|\\theta] = n_1 \\cdot p_1(\\theta) + n_{\\max} \\cdot (1 - p_1(\\theta))\n$$\n整理各项，我们得到一个更便于计算的形式：\n$$\nE[N|\\theta] = n_1 p_1(\\theta) + n_{\\max} - n_{\\max} p_1(\\theta) = n_{\\max} - (n_{\\max} - n_1)p_1(\\theta)\n$$\n下一步是推导中止概率 $p_1(\\theta)$ 的解析表达式。问题陈述，期中分析时的检验统计量 $Z_1$ 服从正态分布 $Z_1 \\sim \\mathcal{N}(\\theta\\sqrt{t_1}, 1)$，其中 $t_1$ 是第一阶段的信息分数。中止概率为：\n$$\np_1(\\theta) = P(|Z_1| \\ge c_1 | \\theta) = P(Z_1 \\ge c_1 \\text{ or } Z_1 \\le -c_1 | \\theta)\n$$\n这两个事件是互斥的，因此我们可以将它们的概率相加：\n$$\np_1(\\theta) = P(Z_1 \\ge c_1 | \\theta) + P(Z_1 \\le -c_1 | \\theta)\n$$\n为了计算这些概率，我们对随机变量 $Z_1$ 进行标准化。设 $W$ 为一个标准正态随机变量，$W \\sim \\mathcal{N}(0, 1)$。那么 $Z_1$ 可以表示为 $Z_1 = W + \\theta\\sqrt{t_1}$。\n第一项是：\n$$\nP(Z_1 \\ge c_1) = P(W + \\theta\\sqrt{t_1} \\ge c_1) = P(W \\ge c_1 - \\theta\\sqrt{t_1})\n$$\n使用标准正态分布的累积分布函数 (CDF) $\\Phi(x) = P(W \\le x)$，我们有 $P(W \\ge a) = 1 - P(W  a) = 1 - \\Phi(a)$。因此：\n$$\nP(Z_1 \\ge c_1) = 1 - \\Phi(c_1 - \\theta\\sqrt{t_1})\n$$\n第二项是：\n$$\nP(Z_1 \\le -c_1) = P(W + \\theta\\sqrt{t_1} \\le -c_1) = P(W \\le -c_1 - \\theta\\sqrt{t_1}) = \\Phi(-c_1 - \\theta\\sqrt{t_1})\n$$\n综合这些，中止概率为：\n$$\np_1(\\theta) = 1 - \\Phi(c_1 - \\theta\\sqrt{t_1}) + \\Phi(-c_1 - \\theta\\sqrt{t_1})\n$$\n使用恒等式 $\\Phi(-x) = 1 - \\Phi(x)$，这意味着 $1 - \\Phi(x) = \\Phi(-x)$，我们可以将第一项重写为：\n$$\n1 - \\Phi(c_1 - \\theta\\sqrt{t_1}) = \\Phi(-(c_1 - \\theta\\sqrt{t_1})) = \\Phi(\\theta\\sqrt{t_1} - c_1)\n$$\n这就得出了中止概率的最终表达式：\n$$\np_1(\\theta) = \\Phi(\\theta\\sqrt{t_1} - c_1) + \\Phi(-c_1 - \\theta\\sqrt{t_1})\n$$\n信息分数 $t_1$ 定义为 $t_1 = n_1 / n_{\\max}$。将它和 $p_1(\\theta)$ 的表达式代入 $E[N|\\theta]$ 的方程中，我们得到所需的解析表达式：\n$$\nE[N|\\theta] = n_{\\max} - (n_{\\max} - n_1) \\left[ \\Phi\\left(\\theta\\sqrt{\\frac{n_1}{n_{\\max}}} - c_1\\right) + \\Phi\\left(-c_1 - \\theta\\sqrt{\\frac{n_1}{n_{\\max}}}\\right) \\right]\n$$\n现在，我们使用给定的参数来计算该表达式的值：\n- 最大样本量：$n_{\\max} = 240$\n- 期中样本量：$n_1 = 120$\n- 期中中止界值：$c_1 = 2.0$\n- 真实标准化效应：$\\theta = 0.3$\n\n首先，我们计算信息分数 $t_1$：\n$$\nt_1 = \\frac{n_1}{n_{\\max}} = \\frac{120}{240} = 0.5\n$$\n接下来，我们计算 $Z_1$ 的均值，即 $\\mu_1 = \\theta\\sqrt{t_1}$：\n$$\n\\mu_1 = 0.3 \\sqrt{0.5} = 0.3 \\times \\frac{1}{\\sqrt{2}} \\approx 0.212132\n$$\n现在我们计算中止概率 $p_1(\\theta=0.3)$ 中 $\\Phi$ 函数的自变量：\n$$\n\\theta\\sqrt{t_1} - c_1 \\approx 0.212132 - 2.0 = -1.787868\n$$\n$$\n-c_1 - \\theta\\sqrt{t_1} \\approx -2.0 - 0.212132 = -2.212132\n$$\n中止概率为：\n$$\np_1(0.3) = \\Phi(-1.787868) + \\Phi(-2.212132)\n$$\n使用标准统计表或软件查询标准正态CDF值：\n$$\n\\Phi(-1.787868) \\approx 0.036894\n$$\n$$\n\\Phi(-2.212132) \\approx 0.013481\n$$\n$$\np_1(0.3) \\approx 0.036894 + 0.013481 = 0.050375\n$$\n最后，我们计算期望样本量：\n$$\nE[N | \\theta=0.3] = n_{\\max} - (n_{\\max} - n_1) p_1(0.3)\n$$\n$$\nE[N | \\theta=0.3] \\approx 240 - (240 - 120) \\times 0.050375\n$$\n$$\nE[N | \\theta=0.3] \\approx 240 - 120 \\times 0.050375\n$$\n$$\nE[N | \\theta=0.3] \\approx 240 - 6.045\n$$\n$$\nE[N | \\theta=0.3] \\approx 233.955\n$$\n问题要求答案四舍五入至 $4$ 位有效数字。\n$$\n233.955 \\approx 234.0\n$$\n期望样本量约为 $234.0$ 名受试者。",
            "answer": "$$\\boxed{234.0}$$"
        },
        {
            "introduction": "在许多临床试验中（例如肿瘤学或心脏病学研究），期中分析并非按固定的日历时间进行，而是由观测到的关键事件（如疾病进展或死亡）数量触发的。这就给试验的运行规划带来了挑战：我们该如何预测这些分析将在何时发生？本练习  聚焦于这一实际问题，教你如何基于预估的事件发生率，将由事件数定义的“信息时间”转化为用于后勤与资源管理的具体“日历时间”。",
            "id": "4892079",
            "problem": "一个生物统计学团队正在计划一项事件驱动的组序贯试验，该试验将使用对数秩检验（logrank test）比较两种治疗在时间-事件终点上的效果。该试验采用组序贯设计，在累积事件数达到 $d = (75, 150, 225, 300)$ 时进行四次期中分析，其中 $D = 300$ 是最终的目标总事件数。期中分析由越过这些事件阈值触发，而非由日历时间触发。\n\n为了规划期中检查的日历时间，该团队将累积事件过程建模为一个非齐次泊松过程，其瞬时事件强度 $\\lambda(t)$（事件数/月）是日历时间 $t$（以月为单位，从首位患者随机化开始计算）的函数。由于预期的启动和爬坡阶段，预期事件累积率是分段常数：\n$$\n\\lambda(t) = \n\\begin{cases}\n0,  0 \\leq t   3, \\\\\n6,  3 \\leq t   9, \\\\\n15,  9 \\leq t   15, \\\\\n25,  t \\geq 15.\n\\end{cases}\n$$\n使用此模型，到时间 $t$ 为止的预期累积事件数是累积强度函数 $\\Lambda(t) = \\int_{0}^{t} \\lambda(u)\\,du$。定义 $t_i$ 为第 $i$ 次检查发生的日历时间，由方程 $\\Lambda(t_i) = d_i$ 决定，其中 $i = 1, 2, 3, 4$。\n\n计算预期发生检查的日历时间向量 $t_i$。利用 $\\Lambda(t)$ 和 $\\lambda(t)$ 的结构，解释在事件驱动的组序贯试验中，事件累积延迟如何影响期中分析的时间安排。\n\n将每个 $t_i$ 四舍五入到三位有效数字。时间以月为单位表示。",
            "solution": "该问题要求计算一项事件驱动的组序贯试验中四次期中分析的预期日历时间。这些时间记为 $t_i$，由预期累积事件数达到特定阈值 $d_i$ 的时刻确定。事件累积过程被建模为一个非齐次泊松过程，具有给定的分段瞬时事件强度 $\\lambda(t)$。\n\n首先，我们必须确定累积强度函数 $\\Lambda(t)$，它表示到日历时间 $t$ 为止的预期事件数。这通过对瞬时强度 $\\lambda(t)$ 从 $0$ 到 $t$ 积分得到。给定的强度函数为：\n$$\n\\lambda(u) = \n\\begin{cases}\n0,  0 \\leq u   3 \\\\\n6,  3 \\leq u   9 \\\\\n15,  9 \\leq u   15 \\\\\n25,  u \\geq 15.\n\\end{cases}\n$$\n我们对每个 $t$ 的区间计算 $\\Lambda(t) = \\int_{0}^{t} \\lambda(u)\\,du$。\n\n对于 $0 \\leq t  3$：\n$$ \\Lambda(t) = \\int_{0}^{t} 0 \\, du = 0 $$\n\n对于 $3 \\leq t  9$：\n$$ \\Lambda(t) = \\int_{0}^{3} 0 \\, du + \\int_{3}^{t} 6 \\, du = 0 + [6u]_{3}^{t} = 6t - 18 $$\n在边界 $t=9$ 处，累积事件数为 $\\Lambda(9) = 6(9) - 18 = 54 - 18 = 36$。\n\n对于 $9 \\leq t  15$：\n$$ \\Lambda(t) = \\Lambda(9) + \\int_{9}^{t} 15 \\, du = 36 + [15u]_{9}^{t} = 36 + 15t - 15(9) = 36 + 15t - 135 = 15t - 99 $$\n在边界 $t=15$ 处，累积事件数为 $\\Lambda(15) = 15(15) - 99 = 225 - 99 = 126$。\n\n对于 $t \\geq 15$：\n$$ \\Lambda(t) = \\Lambda(15) + \\int_{15}^{t} 25 \\, du = 126 + [25u]_{15}^{t} = 126 + 25t - 25(15) = 126 + 25t - 375 = 25t - 249 $$\n\n因此，完整的分段累积强度函数为：\n$$\n\\Lambda(t) = \n\\begin{cases}\n0,  0 \\leq t  3 \\\\\n6t - 18,  3 \\leq t  9 \\\\\n15t - 99,  9 \\leq t  15 \\\\\n25t - 249,  t \\geq 15.\n\\end{cases}\n$$\n期中分析的时间 $t_i$ 通过对目标事件数 $d = (75, 150, 225, 300)$ 求解方程 $\\Lambda(t_i) = d_i$ 来找到。\n\n为了求 $t_1$，我们设 $\\Lambda(t_1) = d_1 = 75$。我们检查区间：\n由于 $\\Lambda(9) = 36$ 且 $\\Lambda(15) = 126$，条件 $36  75  126$ 意味着 $t_1$ 必须位于区间 $[9, 15)$ 内。我们使用 $\\Lambda(t)$ 的相应公式：\n$$ 15t_1 - 99 = 75 $$\n$$ 15t_1 = 174 $$\n$$ t_1 = \\frac{174}{15} = 11.6 $$\n四舍五入到三位有效数字，$t_1 = 11.6$ 月。\n\n为了求 $t_2$，我们设 $\\Lambda(t_2) = d_2 = 150$。\n由于 $\\Lambda(15) = 126$，且 $150 > 126$，所以 $t_2$ 必须位于区间 $t \\geq 15$ 内。我们使用此区间的公式：\n$$ 25t_2 - 249 = 150 $$\n$$ 25t_2 = 399 $$\n$$ t_2 = \\frac{399}{25} = 15.96 $$\n四舍五入到三位有效数字，$t_2 = 16.0$ 月。\n\n为了求 $t_3$，我们设 $\\Lambda(t_3) = d_3 = 225$。\n由于 $225 > 126$，所以 $t_3$ 也位于区间 $t \\geq 15$ 内：\n$$ 25t_3 - 249 = 225 $$\n$$ 25t_3 = 474 $$\n$$ t_3 = \\frac{474}{25} = 18.96 $$\n四舍五入到三位有效数字，$t_3 = 19.0$ 月。\n\n为了求 $t_4$，我们设 $\\Lambda(t_4) = d_4 = 300$。\n由于 $300 > 126$，所以 $t_4$ 也位于区间 $t \\geq 15$ 内：\n$$ 25t_4 - 249 = 300 $$\n$$ 25t_4 = 549 $$\n$$ t_4 = \\frac{549}{25} = 21.96 $$\n四舍五入到三位有效数字，$t_4 = 22.0$ 月。\n\n日历时间向量为 $(11.6, 16.0, 19.0, 22.0)$ 月。\n\n关于事件累积延迟的影响，$\\lambda(t)$ 和 $\\Lambda(t)$ 的结构提供了一个清晰的解释。在事件驱动的试验中，一次分析的日历时间 $t_i$ 由累积强度函数的反函数确定，即 $t_i = \\Lambda^{-1}(d_i)$。根据定义，函数 $\\Lambda(t)$ 是事件率 $\\lambda(t)$ 的积分。微积分基本定理指出 $\\frac{d}{dt}\\Lambda(t) = \\lambda(t)$，这意味着瞬时事件率是累积事件曲线的斜率。\n\n给定的 $\\lambda(t)$ 明确地模拟了累积延迟：\n1. 启动延迟：对于 $t \\in [0, 3)$，$\\lambda(t) = 0$。这导致在此期间 $\\Lambda(t) = 0$。事件累积的“时钟”直到 $t=3$ 月才开始，这直接延迟了所有后续的里程碑。\n2. 爬坡阶段：对于 $t \\in [3, 9)$ 和 $t \\in [9, 15)$，速率 $\\lambda(t) = 6$ 和 $\\lambda(t) = 15$ 低于最终的稳态速率 $\\lambda(t) = 25$。\n\n任何 $\\lambda(t)$ 较低的时期都对应于 $\\Lambda(t)$ 曲线上斜率较缓的一段。为了实现累积事件的指定增长（在 $\\Lambda(t)$ 图上的垂直上升），当斜率较缓时，需要更长的日历时间（水平行程）。因此，初始的零速率期和随后的较慢速率爬坡阶段延长了试验的时间线。如果累积率从一开始（$t=0$）就是恒定的 $\\lambda(t) = 25$，那么达到任何事件数 $d_i$ 所需的时间将是 $t_i = d_i/25$，这将显著缩短时间。例如，第一次检查（$d_1=75$）预计将在 $t_1=3$ 月时进行，而不是计算出的 $11.6$ 月。因此，如 $\\lambda(t)$ 结构所模拟的累积延迟，直接且定量地决定了达到试验的基于事件的终点所需的延长日历时间。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11.6  16.0  19.0  22.0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}