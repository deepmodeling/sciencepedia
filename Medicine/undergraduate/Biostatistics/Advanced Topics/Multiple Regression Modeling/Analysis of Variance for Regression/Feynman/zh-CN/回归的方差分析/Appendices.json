{
    "hands_on_practices": [
        {
            "introduction": "理解回归方差分析（ANOVA）的第一步是掌握其核心组成部分。本练习将帮助你熟悉ANOVA表的基本结构，通过使用已知的平方和与自由度，重点练习如何计算F统计量，这是检验整个回归模型显著性的关键指标。通过这个基础练习，你将学会如何利用变异分解的逻辑来评估模型解释响应变量变异的能力。",
            "id": "1895430",
            "problem": "一位农业科学家正在研究施用于土壤的新型营养补充剂的用量与特定植物物种后续高度之间的关系。一个简单线性回归模型被拟合到收集的数据中，用以根据补充剂的用量预测植物高度。\n\n拟合模型后，一项统计分析得出了以下量值：\n- 总平方和 ($SST$)，用于衡量植物高度的总方差，经计算为 $100.0$。\n- 回归平方和 ($SSR$)，代表由回归模型解释的植物高度变异，经计算为 $40.0$。\n- 该分析基于的样本量使得误差（残差）项的自由度为 $df_E = 10$。\n\n根据方差分析 (ANOVA) 的这些结果，计算用于检验简单线性回归模型总体显著性的F统计量。将您的答案表示为一个四舍五入到三位有效数字的数值。",
            "solution": "在带截距的单预测变量简单线性回归中，方差分析 (ANOVA) 将总变异分解为 $SST = SSR + SSE$。因此，误差平方和为\n$$\nSSE = SST - SSR.\n$$\n回归均方和误差均方定义为\n$$\nMSR = \\frac{SSR}{df_{R}}, \\quad MSE = \\frac{SSE}{df_{E}},\n$$\n而总F统计量为\n$$\nF = \\frac{MSR}{MSE} = \\frac{\\frac{SSR}{df_{R}}}{\\frac{SSE}{df_{E}}}.\n$$\n对于简单线性回归，$df_{R} = 1$。使用给定值 $SST = 100.0$、$SSR = 40.0$ 和 $df_{E} = 10$，计算\n$$\nSSE = 100.0 - 40.0 = 60.0,\n$$\n$$\nMSR = \\frac{40.0}{1} = 40.0, \\quad MSE = \\frac{60.0}{10} = 6.0,\n$$\n所以\n$$\nF = \\frac{40.0}{6.0} = 6.\\overline{6}.\n$$\n四舍五入到三位有效数字，F统计量为 $6.67$。",
            "answer": "$$\\boxed{6.67}$$"
        },
        {
            "introduction": "在掌握了ANOVA表的基本结构后，我们将通过一个实际数据集来亲手计算其各个部分。本练习旨在揭示简单线性回归中的一个深刻联系：用于检验斜率系数的t统计量与用于检验模型整体显著性的F统计量之间存在精确的数学关系。通过亲自计算这两个统计量，你将验证 $F=t^2$ 这一重要特性，从而加深对回归检验理论的理解。",
            "id": "1895391",
            "problem": "一位化学工程专业的本科生正在研究一种新型催化剂的浓度与化学反应速率之间的关系。该学生进行了五次反应，每次使用不同的催化剂浓度，并测量了相应的反应速率。收集到的数据如下：\n\n-   催化剂浓度，$x$ (单位：mol/L): `{1.0, 2.0, 3.0, 4.0, 5.0}`\n-   反应速率，$y$ (单位：mol/L/s): `{2.5, 4.0, 4.8, 6.0, 7.5}`\n\n该学生提出了一个形式为 $Y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$ 的简单线性回归模型，其中误差项 $\\epsilon_i$ 被假设为独立且服从均值为0、方差为常数 $\\sigma^2$ 的正态分布。\n\n你的任务是对此模型执行两项关键的统计检验。\n首先，计算用于检验原假设 $H_0: \\beta_1 = 0$ 与双侧备择假设 $H_a: \\beta_1 \\neq 0$ 的t-统计量。\n其次，为该回归构建一个方差分析（ANOVA）表，并计算 F-统计量。\n\n提供 t-统计量和 F-统计量的值。将你的答案四舍五入到四位有效数字，并以行矩阵 `[t-统计量, F-统计量]` 的格式报告。",
            "solution": "我们采用简单线性回归模型 $Y_{i}=\\beta_{0}+\\beta_{1}x_{i}+\\epsilon_{i}$，其误差项独立、服从正态分布且方差恒定。对于带截距的简单线性回归，最小二乘斜率估计量及其标准误为\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}},\\quad S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad S_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y}),\n$$\n和\n$$\n\\operatorname{SE}(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\operatorname{MSE}}{S_{xx}}},\\quad \\operatorname{MSE}=\\frac{\\operatorname{SSE}}{n-2},\\quad \\operatorname{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}},\\quad S_{yy}=\\sum_{i=1}^{n}(y_{i}-\\bar{y})^{2}.\n$$\n用于检验 $H_{0}:\\beta_{1}=0$ 与 $H_{a}:\\beta_{1}\\neq 0$ 的 $t$-统计量为\n$$\nt=\\frac{\\hat{\\beta}_{1}}{\\operatorname{SE}(\\hat{\\beta}_{1})}.\n$$\n\n使用数据 $x=\\{1,2,3,4,5\\}$ 和 $y=\\{2.5,4.0,4.8,6.0,7.5\\}$，其中 $n=5$，计算样本均值 $\\bar{x}=3$ 和 $\\bar{y}=\\frac{2.5+4.0+4.8+6.0+7.5}{5}=4.96$。那么\n$$\nS_{xx}=\\sum(x_{i}-\\bar{x})^{2}=10,\\quad S_{xy}=\\sum(x_{i}-\\bar{x})(y_{i}-\\bar{y})=12.\n$$\n因此，斜率估计值为\n$$\n\\hat{\\beta}_{1}=\\frac{S_{xy}}{S_{xx}}=\\frac{12}{10}=1.2.\n$$\n接下来，计算\n$$\nS_{yy}=\\sum(y_{i}-\\bar{y})^{2}=\\left(\\sum y_{i}^{2}\\right)-n\\bar{y}^{2}=(6.25+16+23.04+36+56.25)-5(4.96)^{2}=137.54-123.008=14.532.\n$$\n因此，\n$$\n\\operatorname{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}}=14.532-\\frac{144}{10}=14.532-14.4=0.132,\\quad \\operatorname{MSE}=\\frac{\\operatorname{SSE}}{n-2}=\\frac{0.132}{3}=0.044.\n$$\n斜率的标准误为\n$$\n\\operatorname{SE}(\\hat{\\beta}_{1})=\\sqrt{\\frac{\\operatorname{MSE}}{S_{xx}}}=\\sqrt{\\frac{0.044}{10}}=\\sqrt{0.0044}=\\sqrt{\\frac{11}{2500}}=\\frac{\\sqrt{11}}{50}.\n$$\n因此 $t$-统计量为\n$$\nt=\\frac{\\hat{\\beta}_{1}}{\\operatorname{SE}(\\hat{\\beta}_{1})}=\\frac{1.2}{\\sqrt{11}/50}=\\frac{60}{\\sqrt{11}}\\approx 18.09\\quad(\\text{自由度为 }3).\n$$\n\n对于方差分析(ANOVA)，回归平方和为\n$$\n\\operatorname{SSR}=\\frac{S_{xy}^{2}}{S_{xx}}=\\frac{144}{10}=14.4,\n$$\n自由度为1，误差平方和为 $\\operatorname{SSE}=0.132$，自由度为 $n-2=3$。均方为\n$$\n\\operatorname{MSR}=\\frac{\\operatorname{SSR}}{1}=14.4,\\quad \\operatorname{MSE}=\\frac{\\operatorname{SSE}}{3}=0.044.\n$$\n用于检验整体回归的 F-统计量为\n$$\nF=\\frac{\\operatorname{MSR}}{\\operatorname{MSE}}=\\frac{14.4}{0.044}=\\frac{3600}{11}\\approx 327.3.\n$$\n在简单线性回归中，$F=t^{2}$ 成立，并且确实有 $\\left(\\frac{60}{\\sqrt{11}}\\right)^{2}=\\frac{3600}{11}$。\n\n四舍五入到四位有效数字后，所求的统计量为 $t\\approx 18.09$ 和 $F\\approx 327.3$。",
            "answer": "$$\\boxed{\\begin{pmatrix}18.09  327.3\\end{pmatrix}}$$"
        },
        {
            "introduction": "回归分析的威力在于其灵活性，而ANOVA是评估各种回归模型的统一框架。本练习将展示如何将ANOVA的原理应用于一个更复杂的场景，其中涉及对响应变量进行变换并引入多项式项来更好地拟合数据。通过这个例子，你将学会如何为一个包含多个预测变量（即使它们是同一变量的不同次幂）的模型构建ANOVA表，并执行整体F检验来评估模型的有效性。",
            "id": "4893869",
            "problem": "一个生物统计学团队研究了对于 $n=20$ 只动物，连续剂量变量 $x$ 与代表组织学图像中每个视野的酶聚集体计数的非负响应 $y$ 之间的关系。拟合了一个初始的简单线性回归模型 $y_i=\\beta_0+\\beta_1 x_i+\\varepsilon_i$。对于这个初始拟合，获得了以下汇总统计量：\n- 关于均值的总平方和：$\\sum_{i=1}^{n}(y_i-\\bar{y})^2 = 520$。\n- 回归平方和：$\\sum_{i=1}^{n}(\\hat{y}_i-\\bar{y})^2 = 120$。\n- 误差平方和：$\\sum_{i=1}^{n}(y_i-\\hat{y}_i)^2 = 400$。\n\n诊断图显示出明显的曲率和方差随拟合均值增加的趋势，这表明线性和同方差性的假设被违反了。受计数型响应的近似方差稳定化方法的启发，该团队应用了平方根变换 $z_i=\\sqrt{y_i}$，并将均值函数扩展为 $x$ 的二次函数：\n$$\nz_i=\\gamma_0+\\gamma_1 x_i+\\gamma_2 x_i^2+\\varepsilon_i',\n$$\n其中 $\\varepsilon_i'$ 是在变换后的尺度上具有恒定方差的独立误差。\n\n对于变换后的二次模型，该团队报告了：\n- 关于变换后均值的总平方和：$\\sum_{i=1}^{n}(z_i-\\bar{z})^2 = 49.98$。\n- 序贯回归平方和：将 $x$ 添加到仅含截距项的模型中时，为 $14.04$；在模型中已有 $x$ 的情况下添加 $x^2$ 时，为 $22.68$。因此，总回归平方和为 $36.72$。\n- 误差平方和：$\\sum_{i=1}^{n}(z_i-\\hat{z}_i)^2 = 13.26$。\n\n假设回归的方差分析的标准条件在每个尺度上都适用：特别是在相关尺度上，误差是独立的、具有恒定方差且服从正态分布。使用回归平方和、误差平方和、均方以及用于检验所有斜率系数为零的 $F$ 统计量的核心定义，完成以下任务：\n- 确定初始线性模型和变换后的二次模型中回归、误差和总自由度，并口头陈述相应的方差分析分解（各组成部分及其自由度）。\n- 使用变换后的二次模型，计算用于检验 $H_0:\\gamma_1=\\gamma_2=0$ 与一般备择假设的 $F$ 统计量。\n\n将最终数值答案四舍五入到四位有效数字。无需单位。",
            "solution": "该问题要求对两个不同的回归模型进行方差分析（ANOVA）。任务的第一部分是确定每个模型的自由度（$df$）并陈述相应的方差分析分解。第二部分是计算第二个模型的总 $F$ 统计量。\n\n一个样本量为 $n$、有 $p$ 个预测变量的一般线性回归模型，将响应变量与预测变量联系起来。响应中的总变异可分解为模型解释的变异和未解释的变异（误差）。自由度也进行类似的分解。\n- 总自由度为 $df_{Total} = n - 1$。\n- 与预测变量相关的回归自由度为 $df_{Reg} = p$。\n- 误差（或残差）自由度为 $df_{Error} = n - p - 1$。\n一个基本的恒等式是 $df_{Total} = df_{Reg} + df_{Error}$。\n\n**初始简单线性模型的分析**\n第一个模型是简单线性回归 $y_i=\\beta_0+\\beta_1 x_i+\\varepsilon_i$。\n给定样本量为 $n=20$。\n该模型有一个预测变量 $x_i$。因此，预测变量的数量为 $p=1$。\n现在我们可以计算该模型的自由度：\n- $df_{Total} = n - 1 = 20 - 1 = 19$。\n- $df_{Reg} = p = 1$。\n- $df_{Error} = n - p - 1 = 20 - 1 - 1 = 18$。\n该模型的方差分析分解的口头陈述如下：具有 $19$ 个自由度的总平方和（$SSTO = \\sum_{i=1}^{n}(y_i-\\bar{y})^2 = 520$）被分解为具有 $1$ 个自由度的回归平方和（$SSR = \\sum_{i=1}^{n}(\\hat{y}_i-\\bar{y})^2 = 120$）和具有 $18$ 个自由度的误差平方和（$SSE = \\sum_{i=1}^{n}(y_i-\\hat{y}_i)^2 = 400$）。\n\n**变换后的二次模型的分析**\n第二个模型是对变换后响应的二次回归：$z_i=\\gamma_0+\\gamma_1 x_i+\\gamma_2 x_i^2+\\varepsilon_i'$。\n样本量仍为 $n=20$。\n该模型包含两个预测变量项，$x_i$ 和 $x_i^2$。因此，预测变量的数量为 $p=2$。\n该模型的自由度（用撇号表示以作区分）为：\n- $df'_{Total} = n - 1 = 20 - 1 = 19$。\n- $df'_{Reg} = p = 2$。\n- $df'_{Error} = n - p - 1 = 20 - 2 - 1 = 17$。\n该模型的方差分析分解的口头陈述是：在变换后的尺度上，具有 $19$ 个自由度的总平方和（$SSTO' = \\sum_{i=1}^{n}(z_i-\\bar{z})^2 = 49.98$）被分解为具有 $2$ 个自由度的回归平方和（$SSR' = 36.72$）和具有 $17$ 个自由度的误差平方和（$SSE' = \\sum_{i=1}^{n}(z_i-\\hat{z}_i)^2 = 13.26$）。\n\n**计算变换后模型的 F 统计量**\n任务是计算用于检验原假设 $H_0: \\gamma_1 = \\gamma_2 = 0$ 的 $F$ 统计量。这是检验回归模型显著性的总 $F$ 检验。$F$ 统计量定义为回归均方（$MSR'$）与误差均方（$MSE'$）的比值。\n\n首先，我们计算回归均方：\n$$\nMSR' = \\frac{SSR'}{df'_{Reg}}\n$$\n使用给定的平方和 $SSR' = 36.72$ 和计算出的自由度 $df'_{Reg} = 2$：\n$$\nMSR' = \\frac{36.72}{2} = 18.36\n$$\n\n接下来，我们计算误差均方：\n$$\nMSE' = \\frac{SSE'}{df'_{Error}}\n$$\n使用给定的平方和 $SSE' = 13.26$ 和计算出的自由度 $df'_{Error} = 17$：\n$$\nMSE' = \\frac{13.26}{17}\n$$\n\n最后，$F$ 统计量是这两个均方的比值：\n$$\nF = \\frac{MSR'}{MSE'} = \\frac{18.36}{\\frac{13.26}{17}} = \\frac{18.36 \\times 17}{13.26} = \\frac{312.12}{13.26} \\approx 23.5384615\n$$\n题目要求将最终答案四舍五入到四位有效数字。这得出 $23.54$。",
            "answer": "$$\\boxed{23.54}$$"
        }
    ]
}