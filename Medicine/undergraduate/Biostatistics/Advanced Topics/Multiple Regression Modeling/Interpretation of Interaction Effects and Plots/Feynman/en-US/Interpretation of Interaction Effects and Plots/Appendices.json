{
    "hands_on_practices": [
        {
            "introduction": "Understanding interaction effects often begins with the most intuitive case: the linear regression model. In many real-world scenarios, such as in pharmacogenomics, the effect of a treatment is not uniform across all individuals. This exercise  provides a hands-on opportunity to calculate a \"simple effect,\" which is the effect of one predictor at a specific, fixed value of another. Mastering this helps translate the abstract interaction coefficient from a regression model into a tangible and clinically meaningful value.",
            "id": "4918651",
            "problem": "A randomized clinical trial investigates the effect of an antihypertensive drug dose on the reduction in systolic blood pressure after eight weeks. Let the outcome be the reduction in systolic blood pressure, denoted by $Y$ (in millimeters of mercury). Let $G$ be a binary genotype indicator where $G=1$ indicates carriers of a pharmacogenomic variant and $G=0$ indicates non-carriers. Let $X$ denote the drug dose in units of $10$ milligrams per day, centered at $50$ milligrams per day, i.e., $X = \\frac{\\text{dose (mg/day)} - 50}{10}$.\n\nA linear regression with an interaction term is fit to the data, modeling the conditional expectation as\n$$\n\\mathbb{E}[Y \\mid X, G] = \\beta_{0} + \\beta_{X} X + \\beta_{G} G + \\beta_{XG} XG.\n$$\nThe estimated coefficients are\n$$\n\\beta_{0} = 8.0, \\quad \\beta_{X} = 1.5, \\quad \\beta_{G} = 2.0, \\quad \\beta_{XG} = 0.6.\n$$\n\nStarting from the definition of a conditional expectation under a linear model and the definition of a simple effect as the contrast of expected outcomes at a fixed value of the moderator, compute the simple effect of genotype (carriers minus non-carriers) at a dose of $70$ milligrams per day. That is, compute the difference in predicted reductions in systolic blood pressure between $G=1$ and $G=0$ at that dose.\n\nExpress the final difference in millimeters of mercury and round your answer to four significant figures.",
            "solution": "The problem requires the computation of the simple effect of genotype ($G$) on the reduction in systolic blood pressure ($Y$) at a specific drug dose. The simple effect is defined as the difference in the expected outcome between the two levels of the factor of interest, holding the moderator variable at a fixed value.\n\nThe provided linear regression model for the conditional expectation of $Y$ is:\n$$\n\\mathbb{E}[Y \\mid X, G] = \\beta_{0} + \\beta_{X} X + \\beta_{G} G + \\beta_{XG} XG\n$$\nwhere $Y$ is the reduction in systolic blood pressure, $G$ is the binary genotype indicator ($G=1$ for carriers, $G=0$ for non-carriers), and $X$ is the centered and scaled drug dose.\n\nThe simple effect of genotype at a fixed dose corresponding to value $x$ is the difference in the conditional expectation of $Y$ for carriers ($G=1$) versus non-carriers ($G=0$). This is expressed as:\n$$\n\\text{SE}_{G}(X=x) = \\mathbb{E}[Y \\mid X=x, G=1] - \\mathbb{E}[Y \\mid X=x, G=0]\n$$\nFirst, we evaluate the conditional expectations for each level of $G$ using the given model.\n\nFor carriers ($G=1$):\n$$\n\\mathbb{E}[Y \\mid X=x, G=1] = \\beta_{0} + \\beta_{X} x + \\beta_{G}(1) + \\beta_{XG} x(1) = \\beta_{0} + \\beta_{X} x + \\beta_{G} + \\beta_{XG} x\n$$\nFor non-carriers ($G=0$):\n$$\n\\mathbb{E}[Y \\mid X=x, G=0] = \\beta_{0} + \\beta_{X} x + \\beta_{G}(0) + \\beta_{XG} x(0) = \\beta_{0} + \\beta_{X} x\n$$\nNext, we compute the difference to find the expression for the simple effect:\n$$\n\\text{SE}_{G}(X=x) = (\\beta_{0} + \\beta_{X} x + \\beta_{G} + \\beta_{XG} x) - (\\beta_{0} + \\beta_{X} x)\n$$\nSimplifying the expression by canceling common terms yields:\n$$\n\\text{SE}_{G}(X=x) = \\beta_{G} + \\beta_{XG} x\n$$\nThis equation shows that due to the interaction term $\\beta_{XG} XG$, the effect of genotype is not constant but is a linear function of the drug dose $X$.\n\nThe problem specifies the dose as $70$ milligrams per day. We must first convert this dose into the scaled variable $X$ using the given transformation:\n$$\nX = \\frac{\\text{dose (mg/day)} - 50}{10}\n$$\nSubstituting the dose of $70$ mg/day:\n$$\nx = \\frac{70 - 50}{10} = \\frac{20}{10} = 2\n$$\nSo, a dose of $70$ mg/day corresponds to $X=2$.\n\nNow, we can compute the simple effect of genotype at this dose by substituting $x=2$ and the estimated coefficients into our derived formula. The given coefficients are:\n$$\n\\beta_{G} = 2.0, \\quad \\beta_{XG} = 0.6\n$$\nSubstituting these values:\n$$\n\\text{SE}_{G}(X=2) = 2.0 + (0.6)(2)\n$$\n$$\n\\text{SE}_{G}(X=2) = 2.0 + 1.2 = 3.2\n$$\nThe value of the simple effect is $3.2$. This represents the difference in the predicted reduction in systolic blood pressure (in millimeters of mercury) between carriers and non-carriers at a dose of $70$ mg/day. Specifically, carriers are predicted to have a $3.2$ mmHg greater reduction in blood pressure than non-carriers at this dose.\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $3.2$ has two significant figures. To express it with four significant figures, we write it as $3.200$.",
            "answer": "$$\\boxed{3.200}$$"
        },
        {
            "introduction": "When outcomes are binary (e.g., presence or absence of a disease), we often use logistic regression. In this context, interaction effects can be subtle; an interaction that is linear on the log-odds scale is non-linear on the probability scale. This practice problem  challenges you to compute both the conditional odds ratio and the absolute risk difference, illustrating how the same interaction can be described in multiplicative or additive terms. This skill is vital for accurately communicating treatment effects and risks in clinical settings.",
            "id": "4918650",
            "problem": "A biostatistics team is studying the probability of a postoperative complication within $30$ days for patients undergoing elective surgery. They fit a logistic regression with an interaction between treatment assignment and a standardized inflammatory biomarker. The model uses the logit link and is specified as\n$$\n\\operatorname{logit}(p) \\equiv \\ln\\!\\left(\\frac{p}{1-p}\\right) = \\beta_{0} + \\beta_{1} t + \\beta_{2} x + \\beta_{3} (t \\cdot x) + \\beta_{4} a,\n$$\nwhere $p$ is the probability of complication, $t \\in \\{0,1\\}$ indicates standard care ($t=0$) versus prehabilitation ($t=1$), $x$ is the standardized biomarker (mean $0$, standard deviation $1$), and $a$ is age in years. Estimated coefficients are\n$$\n\\beta_{0} = -2.0,\\quad \\beta_{1} = 0.9,\\quad \\beta_{2} = 0.7,\\quad \\beta_{3} = -0.5,\\quad \\beta_{4} = 0.01.\n$$\nConsider a patient with biomarker $x = 1.5$ and age $a = 50$. In an interaction plot of predicted log-odds versus $x$, non-parallel lines across $t$ reflect that the treatment effect depends on $x$.\n\nUsing only the definitions of the logit link, odds, and odds ratio, compute the following at $x=1.5$ and $a=50$:\n- The conditional odds ratio (odds for $t=1$ divided by odds for $t=0$) of complication for prehabilitation versus standard care.\n- The absolute difference in predicted probabilities $p(t=1) - p(t=0)$.\n\nRound your answers to four significant figures. Express the probability difference as a decimal (not a percentage). Provide your two numbers as an ordered pair $(\\text{odds ratio}, \\text{risk difference})$.",
            "solution": "The logistic regression model for the probability of complication, $p$, is given by the logit link function:\n$$\n\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_{0} + \\beta_{1} t + \\beta_{2} x + \\beta_{3} (t \\cdot x) + \\beta_{4} a\n$$\nThe provided estimated coefficients are $\\beta_{0} = -2.0$, $\\beta_{1} = 0.9$, $\\beta_{2} = 0.7$, $\\beta_{3} = -0.5$, and $\\beta_{4} = 0.01$. The analysis is for a patient with biomarker level $x = 1.5$ and age $a = 50$.\n\nFirst, we compute the conditional odds ratio of complication for prehabilitation ($t=1$) versus standard care ($t=0$). The odds of an event are defined as $\\frac{p}{1-p}$. The log-odds are given directly by the model. Let $L(t, x, a)$ be the log-odds for a given set of predictors.\nThe difference in the log-odds, which is the natural logarithm of the odds ratio (OR), is:\n$$\n\\ln(\\text{OR}) = L(t=1, x, a) - L(t=0, x, a) = (\\beta_{0} + \\beta_{1} + \\beta_{2} x + \\beta_{3} x + \\beta_{4} a) - (\\beta_{0} + \\beta_{2} x + \\beta_{4} a) = \\beta_{1} + \\beta_{3} x\n$$\nThis expression shows that the log-odds ratio for treatment depends on the value of the biomarker $x$, which is the definition of an interaction effect. We now substitute the given values for the coefficients and $x=1.5$:\n$$\n\\ln(\\text{OR}) = 0.9 + (-0.5)(1.5) = 0.9 - 0.75 = 0.15\n$$\nTo find the odds ratio, we exponentiate this value:\n$$\n\\text{OR} = \\exp(0.15) \\approx 1.161834\n$$\nRounding to four significant figures, the conditional odds ratio is $1.162$.\n\nSecond, we compute the absolute difference in predicted probabilities, $p(t=1) - p(t=0)$, for the patient with $x=1.5$ and $a=50$.\nTo find the probability $p$ from the log-odds $L$, we use the inverse logit function:\n$$\np = \\frac{\\exp(L)}{1 + \\exp(L)} = \\frac{1}{1 + \\exp(-L)}\n$$\nWe must first calculate the log-odds for this specific patient under both treatment conditions.\nFor prehabilitation ($t=1$):\n$$\nL(t=1, x=1.5, a=50) = -2.0 + 0.9 + 0.7(1.5) + (-0.5)(1.5) + 0.01(50)\n$$\n$$\nL(t=1, x=1.5, a=50) = -2.0 + 0.9 + 1.05 - 0.75 + 0.5 = -0.3\n$$\nFor standard care ($t=0$):\n$$\nL(t=0, x=1.5, a=50) = -2.0 + 0.7(1.5) + 0.01(50)\n$$\n$$\nL(t=0, x=1.5, a=50) = -2.0 + 1.05 + 0.5 = -0.45\n$$\nNow, we calculate the predicted probabilities:\n$$\np(t=1) = \\frac{1}{1 + \\exp(-(-0.3))} = \\frac{1}{1 + \\exp(0.3)} \\approx \\frac{1}{1 + 1.349859} \\approx 0.425557\n$$\n$$\np(t=0) = \\frac{1}{1 + \\exp(-(-0.45))} = \\frac{1}{1 + \\exp(0.45)} \\approx \\frac{1}{1 + 1.568312} \\approx 0.389362\n$$\nThe absolute difference in predicted probabilities, also known as the risk difference, is:\n$$\np(t=1) - p(t=0) \\approx 0.425557 - 0.389362 = 0.036195\n$$\nRounding to four significant figures, the difference in probabilities is $0.03620$.\n\nThe final answer is the ordered pair of the odds ratio and the risk difference, both rounded to four significant figures.",
            "answer": "$$\n\\boxed{(1.162, 0.03620)}\n$$"
        },
        {
            "introduction": "Moving beyond continuous and binary outcomes, we often encounter count data, such as the number of infection events over time. Generalized linear models with a log link, like Poisson or Negative Binomial regression, are standard tools for analyzing such rates. This exercise  demonstrates a unifying principle: for any model using a log link, the exponentiated interaction coefficient has a direct interpretation as an interaction rate ratio. By working through this problem, you will see how this interpretation holds regardless of the underlying count distribution, reinforcing a core concept in the analysis of rate data.",
            "id": "4918640",
            "problem": "A cohort study of hospital-acquired infections models the number of infections, $Y_i$, observed for patient $i$ during a follow-up of length $t_i$ (in person-days). Two modeling approaches are considered for rates: a Poisson generalized linear model (GLM) and a negative binomial GLM, both with a logarithmic link and an offset for exposure time. The covariates are: an indicator for receiving prophylaxis, $A_i \\in \\{0,1\\}$, and an indicator for immune-compromised status, $G_i \\in \\{0,1\\}$. An interaction term $A_i G_i$ is included to allow the effect of prophylaxis to differ by immune-compromised status.\n\nThe Poisson GLM assumes that $Y_i \\sim \\text{Poisson}(\\mu_i)$ with mean satisfying\n$$\n\\ln(\\mu_i) = \\ln(t_i) + \\beta_0 + \\beta_A A_i + \\beta_G G_i + \\beta_{AG} A_i G_i,\n$$\nand the negative binomial GLM assumes that $Y_i \\sim \\text{Negative Binomial}(\\mu_i, \\theta)$ with mean satisfying\n$$\n\\ln(\\mu_i) = \\ln(t_i) + \\gamma_0 + \\gamma_A A_i + \\gamma_G G_i + \\gamma_{AG} A_i G_i,\n$$\nwhere $\\theta$ is an overdispersion parameter. In both models, the log link and offset imply that the expected rate $E[Y_i]/t_i$ is determined by the linear predictor.\n\nSuppose the fitted coefficients are:\n- Poisson model: $\\beta_0 = -3.50$, $\\beta_A = -0.30$, $\\beta_G = 0.40$, $\\beta_{AG} = 0.25$.\n- Negative binomial model: $\\gamma_0 = -3.60$, $\\gamma_A = -0.35$, $\\gamma_G = 0.45$, $\\gamma_{AG} = 0.10$.\n\nDefine the interaction rate ratio for prophylaxis as the ratio of rate ratios for the effect of $A_i$ when $G_i=1$ versus $G_i=0$. Using only the model structures stated above and these coefficient values, derive the interaction rate ratio for each model and then compute the ratio of the Poisson-model interaction rate ratio to the negative binomial-model interaction rate ratio. Express your final answer as a dimensionless decimal and round your answer to four significant figures.\n\nFor interpretive context, imagine a plot of $\\ln$-rate against $A_i$ with separate lines for $G_i=0$ and $G_i=1$. An interaction manifests as a difference in the change in $\\ln$-rate with $A_i$ between the two $G_i$ groups, but do not use any shortcut formulas from such plots in your derivation; proceed from the model definitions above.",
            "solution": "Let $\\lambda(A, G)$ denote the infection rate for a patient with prophylaxis status $A$ and immune status $G$. For a generic log-linear model, the rate is given by $\\lambda(A, G) = \\exp(\\alpha_0 + \\alpha_A A + \\alpha_G G + \\alpha_{AG} AG)$, where $\\alpha$ represents the coefficients.\n\n1.  **Rate Ratio (RR) for Prophylaxis in Non-Immune-Compromised ($G=0$):**\n    $$ RR_{A|G=0} = \\frac{\\lambda(A=1, G=0)}{\\lambda(A=0, G=0)} = \\frac{\\exp(\\alpha_0 + \\alpha_A)}{\\exp(\\alpha_0)} = \\exp(\\alpha_A) $$\n\n2.  **Rate Ratio (RR) for Prophylaxis in Immune-Compromised ($G=1$):**\n    $$ RR_{A|G=1} = \\frac{\\lambda(A=1, G=1)}{\\lambda(A=0, G=1)} = \\frac{\\exp(\\alpha_0 + \\alpha_A + \\alpha_G + \\alpha_{AG})}{\\exp(\\alpha_0 + \\alpha_G)} = \\exp(\\alpha_A + \\alpha_{AG}) $$\n\n3.  **Interaction Rate Ratio (IRR):**\n    The IRR is the ratio of these two rate ratios, which demonstrates how the effect of prophylaxis is modified by immune status.\n    $$ IRR = \\frac{RR_{A|G=1}}{RR_{A|G=0}} = \\frac{\\exp(\\alpha_A + \\alpha_{AG})}{\\exp(\\alpha_A)} = \\exp(\\alpha_{AG}) $$\n    This confirms that for a GLM with a log link, the interaction rate ratio is simply the exponential of the interaction coefficient. This holds for both the Poisson and Negative Binomial models.\n\n**For the Poisson model:**\nThe interaction coefficient is $\\beta_{AG} = 0.25$.\n$$ IRR_{\\text{Poisson}} = \\exp(\\beta_{AG}) = \\exp(0.25) $$\n\n**For the Negative Binomial model:**\nThe interaction coefficient is $\\gamma_{AG} = 0.10$.\n$$ IRR_{\\text{NB}} = \\exp(\\gamma_{AG}) = \\exp(0.10) $$\n\n**Ratio of Interaction Rate Ratios:**\nThe problem asks for the ratio of the Poisson-model IRR to the Negative Binomial-model IRR.\n$$ \\text{Ratio} = \\frac{IRR_{\\text{Poisson}}}{IRR_{\\text{NB}}} = \\frac{\\exp(0.25)}{\\exp(0.10)} = \\exp(0.25 - 0.10) = \\exp(0.15) $$\nNow, we calculate the numerical value:\n$$ \\exp(0.15) \\approx 1.161834 $$\nRounding to four significant figures, the result is $1.162$.",
            "answer": "$$\\boxed{1.162}$$"
        }
    ]
}