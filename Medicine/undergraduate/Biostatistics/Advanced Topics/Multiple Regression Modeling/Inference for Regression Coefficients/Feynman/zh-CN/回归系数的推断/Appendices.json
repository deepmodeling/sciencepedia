{
    "hands_on_practices": [
        {
            "introduction": "标准最小二乘法 (OLS) 的一个关键假设是误差方差恒定。然而在许多生物统计学应用中，不同观测值的测量精度可能存在差异，这就导致了异方差性。本练习  将引导您应用加权最小二乘法 (WLS) 来解决这一问题，它通过为更精确的观测值分配更高的权重来优化模型拟合。通过从基本定义出发推导估计值，您将深入理解 WLS 的工作原理。",
            "id": "4916039",
            "problem": "一位生物统计学家正在对两个独立患者的生物标志物浓度 $x$ 与连续临床结局 $y$ 之间的关系进行建模，其中由于检测精度不同，测量误差是异方差的。在带截距的简单线性回归模型下，结局被建模为 $y_{i} = \\beta_{0} + \\beta_{1} x_{i} + \\varepsilon_{i}$（对于 $i=1,2$），其中独立误差满足 $\\mathbb{E}[\\varepsilon_{i} \\mid x_{i}] = 0$ 和 $\\operatorname{Var}(\\varepsilon_{i} \\mid x_{i}) \\propto 1/w_{i}$，其中 $w_{i} > 0$ 是一个已知的权重，与 $\\varepsilon_{i}$ 的方差的倒数成正比。加权最小二乘 (WLS) 估计量被定义为加权残差平方和 $\\sum_{i=1}^{2} w_{i} \\left(y_{i} - \\beta_{0} - \\beta_{1} x_{i}\\right)^{2}$ 的最小化者。\n\n给定数据向量 $w=(1,4)$、$x=(0,1)$ 和 $y=(1,3)$。仅从上述 WLS 定义和最小二乘法最小化的一般性质出发，计算该模型截距 $\\beta_{0}$ 和斜率 $\\beta_{1}$ 的 WLS 估计值。将您的最终答案以有序对 $(\\beta_{0}, \\beta_{1})$ 的形式报告。不需要四舍五入，最终答案中不应包含单位。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、提法得当的和客观的。它为标准的生物统计计算提供了一个完整且一致的设置。\n\n目标是为简单线性回归模型 $y_{i} = \\beta_{0} + \\beta_{1} x_{i} + \\varepsilon_{i}$ 找到截距 $\\beta_{0}$ 和斜率 $\\beta_{1}$ 的加权最小二乘 (WLS) 估计值。WLS 估计值是使加权残差平方和函数 $S(\\beta_{0}, \\beta_{1})$ 最小化的 $\\beta_{0}$ 和 $\\beta_{1}$ 的值。\n\n加权残差平方和定义为：\n$$S(\\beta_{0}, \\beta_{1}) = \\sum_{i=1}^{2} w_{i} (y_{i} - \\beta_{0} - \\beta_{1} x_{i})^{2}$$\n\n问题为两名患者 ($i=1, 2$) 提供了以下数据：\n- 权重：$w = (w_{1}, w_{2}) = (1, 4)$\n- 生物标志物浓度：$x = (x_{1}, x_{2}) = (0, 1)$\n- 临床结局：$y = (y_{1}, y_{2}) = (1, 3)$\n\n将这些值代入 $S(\\beta_{0}, \\beta_{1})$ 的表达式中：\n$$S(\\beta_{0}, \\beta_{1}) = w_{1}(y_{1} - \\beta_{0} - \\beta_{1} x_{1})^{2} + w_{2}(y_{2} - \\beta_{0} - \\beta_{1} x_{2})^{2}$$\n$$S(\\beta_{0}, \\beta_{1}) = 1 \\cdot (1 - \\beta_{0} - \\beta_{1} \\cdot 0)^{2} + 4 \\cdot (3 - \\beta_{0} - \\beta_{1} \\cdot 1)^{2}$$\n$$S(\\beta_{0}, \\beta_{1}) = (1 - \\beta_{0})^{2} + 4(3 - \\beta_{0} - \\beta_{1})^{2}$$\n\n为了找到使该函数最小化的 $\\beta_{0}$ 和 $\\beta_{1}$ 的值，我们必须通过求关于 $\\beta_{0}$ 和 $\\beta_{1}$ 的偏导数并令其等于零来找到临界点。这会得到一个由两个线性方程组成的方程组，称为正规方程组。\n\n首先，我们计算关于 $\\beta_{0}$ 的偏导数：\n$$\\frac{\\partial S}{\\partial \\beta_{0}} = \\frac{\\partial}{\\partial \\beta_{0}} \\left[ (1 - \\beta_{0})^{2} + 4(3 - \\beta_{0} - \\beta_{1})^{2} \\right]$$\n$$\\frac{\\partial S}{\\partial \\beta_{0}} = 2(1 - \\beta_{0}) \\cdot (-1) + 4 \\cdot 2(3 - \\beta_{0} - \\beta_{1}) \\cdot (-1)$$\n$$\\frac{\\partial S}{\\partial \\beta_{0}} = -2(1 - \\beta_{0}) - 8(3 - \\beta_{0} - \\beta_{1})$$\n将此导数设为零以求最小值：\n$$-2(1 - \\beta_{0}) - 8(3 - \\beta_{0} - \\beta_{1}) = 0$$\n除以 $-2$：\n$$(1 - \\beta_{0}) + 4(3 - \\beta_{0} - \\beta_{1}) = 0$$\n$$1 - \\beta_{0} + 12 - 4\\beta_{0} - 4\\beta_{1} = 0$$\n$$13 - 5\\beta_{0} - 4\\beta_{1} = 0$$\n这给了我们第一个正规方程：\n$$5\\beta_{0} + 4\\beta_{1} = 13 \\quad (1)$$\n\n接下来，我们计算关于 $\\beta_{1}$ 的偏导数：\n$$\\frac{\\partial S}{\\partial \\beta_{1}} = \\frac{\\partial}{\\partial \\beta_{1}} \\left[ (1 - \\beta_{0})^{2} + 4(3 - \\beta_{0} - \\beta_{1})^{2} \\right]$$\n第一项 $(1 - \\beta_{0})^{2}$ 不依赖于 $\\beta_{1}$，所以其导数为零。\n$$\\frac{\\partial S}{\\partial \\beta_{1}} = 0 + 4 \\cdot 2(3 - \\beta_{0} - \\beta_{1}) \\cdot (-1)$$\n$$\\frac{\\partial S}{\\partial \\beta_{1}} = -8(3 - \\beta_{0} - \\beta_{1})$$\n将此导数设为零：\n$$-8(3 - \\beta_{0} - \\beta_{1}) = 0$$\n$$3 - \\beta_{0} - \\beta_{1} = 0$$\n这给了我们第二个正规方程：\n$$\\beta_{0} + \\beta_{1} = 3 \\quad (2)$$\n\n现在我们必须解这个由两个线性方程组成的方程组：\n$$1) \\quad 5\\beta_{0} + 4\\beta_{1} = 13$$\n$$2) \\quad \\beta_{0} + \\beta_{1} = 3$$\n\n从方程 (2) 中，我们可以用 $\\beta_{1}$ 表示 $\\beta_{0}$：\n$$\\beta_{0} = 3 - \\beta_{1}$$\n将这个 $\\beta_{0}$ 的表达式代入方程 (1)：\n$$5(3 - \\beta_{1}) + 4\\beta_{1} = 13$$\n$$15 - 5\\beta_{1} + 4\\beta_{1} = 13$$\n$$15 - \\beta_{1} = 13$$\n$$\\beta_{1} = 15 - 13$$\n$$\\beta_{1} = 2$$\n\n最后，将 $\\beta_{1}$ 的值代回 $\\beta_{0}$ 的表达式中：\n$$\\beta_{0} = 3 - \\beta_{1} = 3 - 2$$\n$$\\beta_{0} = 1$$\n\nWLS 估计值为 $\\hat{\\beta}_{0} = 1$ 和 $\\hat{\\beta}_{1} = 2$。问题要求以有序对 $(\\beta_{0}, \\beta_{1})$ 的形式作答。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在回归分析中，仅仅估计出模型系数是不够的，我们往往需要回答关于这些系数之间关系的具体科学问题，例如，两种药物的疗效是否存在差异？本练习将向您介绍线性反差（linear contrast）检验，这是一种用于检验关于回归系数的线性假设的强大工具。通过构建一个检验统计量 ，您将学会如何严谨地比较模型中不同预测变量的效应。",
            "id": "4916000",
            "problem": "一项随机临床研究调查了一种新型抗炎药的两种给药方案对C-反应蛋白浓度的对数的影响，该影响已根据基线协变量进行了调整。研究人员拟合了一个多元线性回归模型，其设计矩阵为$X$，包含一个截距项、两个代表给药方案（相对于安慰剂）的二元指示变量，以及其他协变量（年龄、性别、基线体重指数和研究中心），从而得到参数向量$\\beta = (\\beta_0, \\beta_1, \\beta_2, \\beta_3, \\dots, \\beta_p)^{\\top}$。回归模型为$Y = X \\beta + \\varepsilon$，其中$\\varepsilon$是均值为$0$、方差为$\\sigma^2$的独立误差，系数通过普通最小二乘法（OLS）进行估计。\n\n临床问题是这两种给药方案是否对结果有相同的影响。这可以表示为原假设$H_{0} : \\beta_{1} = \\beta_{2}$，对应于线性对比$c = (0, 1, -1, 0, \\dots, 0)^{\\top}$和$H_{0} : c^{\\top} \\beta = 0$。假设OLS估计值满足$\\hat{\\beta}_{1} = 0.5$和$\\hat{\\beta}_{2} = 0.1$。根据拟合模型，报告的对比估计方差为$\\widehat{\\operatorname{Var}}(\\hat{\\beta}_{1} - \\hat{\\beta}_{2}) = 0.09$。\n\n请从线性模型的第一性原理以及OLS系数线性对比的抽样分布出发，推导适用于$H_{0} : \\beta_{1} = \\beta_{2}$的检验统计量，然后使用所给定的量计算其数值。请以精确值（不要四舍五入）给出最终数值答案。",
            "solution": "该问题已被验证，并被确定为生物统计学中一个良定的、有科学依据的问题。\n\n该问题要求推导多元线性回归模型中系数线性对比的检验统计量，并计算其值。\n\n设多元线性回归模型指定为：\n$$\nY = X \\beta + \\varepsilon\n$$\n其中$Y$是$n \\times 1$的结果向量，$X$是秩为$p+1$的$n \\times (p+1)$设计矩阵，$\\beta$是$(p+1) \\times 1$的未知参数向量，$\\varepsilon$是$n \\times 1$的随机误差向量。问题陈述中指出，误差$\\varepsilon_i$是独立的，均值为$0$，方差恒为$\\sigma^2$。为了进行精确的有限样本推断，我们做出标准假设，即误差呈正态分布。因此，$\\varepsilon \\sim N(0, \\sigma^2 I_n)$，其中$I_n$是$n \\times n$的单位矩阵。\n\n系数通过普通最小二乘法（OLS）进行估计。$\\beta$的OLS估计量由下式给出：\n$$\n\\hat{\\beta} = (X^{\\top}X)^{-1}X^{\\top}Y\n$$\n由于$\\hat{\\beta}$是正态分布向量$Y$的线性变换，$\\hat{\\beta}$也呈正态分布。其分布为：\n$$\n\\hat{\\beta} \\sim N(\\beta, \\sigma^2 (X^{\\top}X)^{-1})\n$$\n均值$\\mathbb{E}[\\hat{\\beta}] = \\beta$表明$\\hat{\\beta}$是$\\beta$的无偏估计量。方差-协方差矩阵为$\\operatorname{Var}(\\hat{\\beta}) = \\sigma^2 (X^{\\top}X)^{-1}$。\n\n我们感兴趣的原假设是$H_{0} : \\beta_{1} = \\beta_{2}$，它可以写成线性对比的形式$H_{0} : c^{\\top}\\beta = 0$，其中对比向量$c$由$c = (0, 1, -1, 0, \\dots, 0)^{\\top}$给出。对应的对比估计量是$c^{\\top}\\hat{\\beta} = \\hat{\\beta}_{1} - \\hat{\\beta}_{2}$。\n\n作为$\\hat{\\beta}$各元素的线性组合，对比估计量$c^{\\top}\\hat{\\beta}$也呈正态分布：\n$$\n\\mathbb{E}[c^{\\top}\\hat{\\beta}] = c^{\\top}\\mathbb{E}[\\hat{\\beta}] = c^{\\top}\\beta\n$$\n$$\n\\operatorname{Var}(c^{\\top}\\hat{\\beta}) = c^{\\top}\\operatorname{Var}(\\hat{\\beta})c = c^{\\top}(\\sigma^2 (X^{\\top}X)^{-1})c = \\sigma^2 c^{\\top}(X^{\\top}X)^{-1}c\n$$\n因此，$c^{\\top}\\hat{\\beta} \\sim N(c^{\\top}\\beta, \\sigma^2 c^{\\top}(X^{\\top}X)^{-1}c)$。\n\n在原假设$H_{0} : c^{\\top}\\beta = 0$下，我们有$\\mathbb{E}[c^{\\top}\\hat{\\beta}] = 0$。如果$\\sigma^2$已知，我们可以构建以下标准正态统计量：\n$$\nZ = \\frac{c^{\\top}\\hat{\\beta}}{\\sqrt{\\operatorname{Var}(c^{\\top}\\hat{\\beta})}} = \\frac{c^{\\top}\\hat{\\beta}}{\\sigma\\sqrt{c^{\\top}(X^{\\top}X)^{-1}c}} \\sim N(0, 1)\n$$\n然而，误差方差$\\sigma^2$通常是未知的。它必须从数据中估计。$\\sigma^2$的无偏估计量是均方误差（MSE），记为$\\hat{\\sigma}^2$：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n-(p+1)} \\sum_{i=1}^n (y_i - \\hat{y}_i)^2 = \\frac{SSE}{n-(p+1)}\n$$\n其中$SSE$是残差平方和，$df = n-(p+1)$是残差自由度。线性模型理论中的一个基本结果是，随机变量$\\frac{(n-(p+1))\\hat{\\sigma}^2}{\\sigma^2} = \\frac{SSE}{\\sigma^2}$服从自由度为$n-(p+1)$的卡方分布，即$\\chi^2_{n-(p+1)}$。同样已知的是，$\\hat{\\sigma}^2$与$\\hat{\\beta}$在统计上是独立的。\n\n为了构建一个不依赖于未知$\\sigma^2$的检验统计量，我们用其估计值$\\hat{\\sigma}^2$来代替$\\sigma^2$。这就得到了学生t统计量。一个自由度为$df$的t分布随机变量的一般形式是，一个标准正态随机变量与一个独立的、除以其自由度的卡方随机变量的平方根之比。\n$$\nT = \\frac{Z}{\\sqrt{\\chi^2_{df}/df}} \\sim t_{df}\n$$\n在我们的情境中，该统计量构建如下：\n$$\nT = \\frac{\\frac{c^{\\top}\\hat{\\beta} - c^{\\top}\\beta}{\\sigma\\sqrt{c^{\\top}(X^{\\top}X)^{-1}c}}}{\\sqrt{\\frac{(n-(p+1))\\hat{\\sigma}^2}{\\sigma^2} / (n-(p+1))}} = \\frac{\\frac{c^{\\top}\\hat{\\beta} - c^{\\top}\\beta}{\\sigma\\sqrt{c^{\\top}(X^{\\top}X)^{-1}c}}}{\\sqrt{\\hat{\\sigma}^2/\\sigma^2}} = \\frac{c^{\\top}\\hat{\\beta} - c^{\\top}\\beta}{\\hat{\\sigma}\\sqrt{c^{\\top}(X^{\\top}X)^{-1}c}}\n$$\n分母是对比估计量的估计标准误：\n$$\n\\operatorname{SE}(c^{\\top}\\hat{\\beta}) = \\sqrt{\\widehat{\\operatorname{Var}}(c^{\\top}\\hat{\\beta})} = \\sqrt{\\hat{\\sigma}^2 c^{\\top}(X^{\\top}X)^{-1}c}\n$$\n所以，统计量$T = \\frac{c^{\\top}\\hat{\\beta} - c^{\\top}\\beta}{\\operatorname{SE}(c^{\\top}\\hat{\\beta})}$服从自由度为$n-(p+1)$的t分布。\n\n为了检验特定的原假设$H_{0} : c^{\\top}\\beta = 0$，我们在$T$的表达式中令$c^{\\top}\\beta = 0$。因此，适用的检验统计量是：\n$$\nt = \\frac{c^{\\top}\\hat{\\beta}}{\\operatorname{SE}(c^{\\top}\\hat{\\beta})} = \\frac{\\hat{\\beta}_{1} - \\hat{\\beta}_{2}}{\\sqrt{\\widehat{\\operatorname{Var}}(\\hat{\\beta}_{1} - \\hat{\\beta}_{2})}}\n$$\n这就是所要求推导的检验统计量。\n\n现在我们使用问题陈述中提供的信息计算其数值。\n给定的量是：\n- 方案1的估计系数：$\\hat{\\beta}_{1} = 0.5$\n- 方案2的估计系数：$\\hat{\\beta}_{2} = 0.1$\n- 对比的估计方差：$\\widehat{\\operatorname{Var}}(\\hat{\\beta}_{1} - \\hat{\\beta}_{2}) = 0.09$\n\n首先，计算估计的对比值：\n$$\n\\hat{\\beta}_{1} - \\hat{\\beta}_{2} = 0.5 - 0.1 = 0.4\n$$\n接下来，计算对比的标准误，即估计方差的平方根：\n$$\n\\operatorname{SE}(\\hat{\\beta}_{1} - \\hat{\\beta}_{2}) = \\sqrt{\\widehat{\\operatorname{Var}}(\\hat{\\beta}_{1} - \\hat{\\beta}_{2})} = \\sqrt{0.09} = 0.3\n$$\n最后，计算t统计量的值：\n$$\nt = \\frac{0.4}{0.3} = \\frac{4/10}{3/10} = \\frac{4}{3}\n$$\n检验统计量的数值为$\\frac{4}{3}$。",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "并非所有的回归模型都能被明确地设定；有时，预测变量之间的线性依赖关系（即共线性）会导致模型参数的模糊性，使得我们无法获得唯一的系数估计。本练习探讨了模型可识别性（identifiability）这一关键概念。通过分析一个存在共线性的设计矩阵 ，您将学会如何判断哪些参数组合是可估计的（estimable），并掌握如何通过重新参数化来构建一个可识别的模型，这对于诊断和解决回归分析中的根本性问题至关重要。",
            "id": "4916052",
            "problem": "一位生物统计学家将一个连续生物标志物响应建模为两个连续暴露的线性函数，并带有一个加性复合项。对于受试者索引 $i \\in \\{1,\\dots,n\\}$，线性模型为\n$$\nY_{i} \\;=\\; \\beta_{0} + \\beta_{A}\\,A_{i} + \\beta_{B}\\,B_{i} + \\beta_{S}\\,(A_{i}+B_{i}) + \\varepsilon_{i},\n$$\n其中误差项满足线性模型的标准高斯-马尔可夫条件：$E(\\varepsilon_{i}\\mid A_{i},B_{i})=0$，$\\operatorname{Var}(\\varepsilon_{i}\\mid A_{i},B_{i})=\\sigma^{2}$，以及对于 $i\\ne j$ 有 $\\operatorname{Cov}(\\varepsilon_{i},\\varepsilon_{j}\\mid A_{i},B_{i},A_{j},B_{j})=0$。设设计矩阵为 $\\mathbf{X}=[\\mathbf{1},\\mathbf{A},\\mathbf{B},\\mathbf{A}+\\mathbf{B}]$，系数向量为 $\\boldsymbol{\\beta}=(\\beta_{0},\\beta_{A},\\beta_{B},\\beta_{S})^{\\top}$，其中 $\\mathbf{1}$ 是元素全为1的 $n$ 维向量，$\\mathbf{A},\\mathbf{B}$ 是观测到的暴露列向量。假设 $n\\geq 3$ 且三个列向量 $\\mathbf{1}$、$\\mathbf{A}$ 和 $\\mathbf{B}$ 在 $\\mathbb{R}^{n}$ 中是线性无关的。\n\n从线性模型、普通最小二乘法 (OLS; Ordinary Least Squares) 的定义以及系数线性泛函的可估性概念出发，确定 $\\mathbf{X}$ 的列秩，描述可估线性组合 $c^{\\top}\\boldsymbol{\\beta}$ 的集合，并提出一个最小维度的重参数化 $\\boldsymbol{\\gamma}$，将其表示为 $(\\beta_{0},\\beta_{A},\\beta_{B},\\beta_{S})$ 的线性函数，使得均值函数保持不变且 $\\boldsymbol{\\gamma}$ 的所有分量都是可识别的。\n\n将你的最终答案以一个包含三个条目的单行矩阵形式报告，顺序如下：\n- $\\mathbf{X}$ 的秩（单个整数），\n- 一个 $3\\times 4$ 矩阵（其行构成了可估系数泛函空间的基），\n- 一个 $3\\times 1$ 向量（给出你所提出的重参数化 $\\boldsymbol{\\gamma}$，表示为 $(\\beta_{0},\\beta_{A},\\beta_{B},\\beta_{S})$ 的线性组合）。\n\n无需数值舍入。所有量均以符号形式表示。",
            "solution": "该问题要求对一个由秩亏设计矩阵表征的给定线性回归模型进行分析。分析内容包括确定设计矩阵的秩，描述模型系数的可估线性函数集合，以及提出一个最小维度的可识别重参数化。\n\n对于受试者 $i \\in \\{1, \\dots, n\\}$，模型由下式给出：\n$$\nY_{i} \\;=\\; \\beta_{0} + \\beta_{A}\\,A_{i} + \\beta_{B}\\,B_{i} + \\beta_{S}\\,(A_{i}+B_{i}) + \\varepsilon_{i}\n$$\n用矩阵表示法，该模型为 $\\mathbf{Y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{Y}$ 是 $n \\times 1$ 的响应向量，$\\boldsymbol{\\beta} = (\\beta_{0}, \\beta_{A}, \\beta_{B}, \\beta_{S})^{\\top}$ 是 $4 \\times 1$ 的系数向量，$\\boldsymbol{\\varepsilon}$ 是满足高斯-马尔可夫条件的误差向量。$n \\times 4$ 的设计矩阵 $\\mathbf{X}$ 由其列向量指定：\n$$\n\\mathbf{X} = [\\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{X}_3, \\mathbf{X}_4] = [\\mathbf{1}, \\mathbf{A}, \\mathbf{B}, \\mathbf{A}+\\mathbf{B}]\n$$\n其中 $\\mathbf{1}$、$\\mathbf{A}$ 和 $\\mathbf{B}$ 是 $n \\times 1$ 的列向量。\n\n首先，我们确定设计矩阵 $\\mathbf{X}$ 的列秩。矩阵的秩是其列空间的维度，等价于线性无关列的最大数量。通过观察 $\\mathbf{X}$ 的各列，我们发现一个线性相关性：第四列是第二列和第三列的和。\n$$\n\\mathbf{X}_4 = \\mathbf{A} + \\mathbf{B} = 1 \\cdot \\mathbf{X}_2 + 1 \\cdot \\mathbf{X}_3\n$$\n这可以写成 $0 \\cdot \\mathbf{X}_1 + 1 \\cdot \\mathbf{X}_2 + 1 \\cdot \\mathbf{X}_3 - 1 \\cdot \\mathbf{X}_4 = \\mathbf{0}$，明确地表明 $\\mathbf{X}$ 的四列是线性相关的。因此，$\\mathbf{X}$ 的秩必须小于 $4$。问题陈述假设三个列向量 $\\mathbf{1}$、$\\mathbf{A}$ 和 $\\mathbf{B}$ 是线性无关的。它们是 $\\mathbf{X}$ 的前三列。由于第四列 $\\mathbf{A}+\\mathbf{B}$ 位于前三列（具体来说是第 $2$ 列和第 $3$ 列）的张成空间中，它对增加列空间的维度没有贡献。$\\mathbf{X}$ 的列空间由 $\\{\\mathbf{1}, \\mathbf{A}, \\mathbf{B}\\}$ 张成。因为假设该集合是线性无关的且大小为 $3$，所以列空间的维度是 $3$。因此，$\\mathbf{X}$ 的秩是 $3$。\n\n其次，我们描述可估线性组合 $c^{\\top}\\boldsymbol{\\beta}$ 的集合，其中 $c=(c_0, c_A, c_B, c_S)^{\\top}$。如果存在观测值的线性组合 $a^{\\top}\\mathbf{Y}$，其是参数线性组合 $c^{\\top}\\boldsymbol{\\beta}$ 的一个无偏估计量，即 $E[a^{\\top}\\mathbf{Y}] = c^{\\top}\\boldsymbol{\\beta}$，那么 $c^{\\top}\\boldsymbol{\\beta}$ 就被称为可估的。线性模型理论中的一个基本定理指出，$c^{\\top}\\boldsymbol{\\beta}$ 是可估的当且仅当向量 $c$ 位于设计矩阵 $\\mathbf{X}$ 的行空间中。$\\mathbf{X}$ 的行空间是其零空间 $N(\\mathbf{X})$ 的正交补。我们通过寻找 $N(\\mathbf{X})$ 的一组基来继续。一个向量 $v=(v_0, v_A, v_B, v_S)^{\\top}$ 属于 $N(\\mathbf{X})$ 如果 $\\mathbf{X}v = \\mathbf{0}$。\n$$\nv_0 \\mathbf{1} + v_A \\mathbf{A} + v_B \\mathbf{B} + v_S (\\mathbf{A}+\\mathbf{B}) = \\mathbf{0}\n$$\n重新整理这些项，我们得到：\n$$\nv_0 \\mathbf{1} + (v_A + v_S) \\mathbf{A} + (v_B + v_S) \\mathbf{B} = \\mathbf{0}\n$$\n因为向量 $\\mathbf{1}$、$\\mathbf{A}$ 和 $\\mathbf{B}$ 是线性无关的，所以这个线性组合中的系数必须全部为零。这得出了以下方程组：\n$v_0 = 0$\n$v_A + v_S = 0 \\implies v_A = -v_S$\n$v_B + v_S = 0 \\implies v_B = -v_S$\n任何向量 $v \\in N(\\mathbf{X})$ 都必须是 $(0, -v_S, -v_S, v_S)^{\\top} = v_S(0, -1, -1, 1)^{\\top}$ 的形式，其中 $v_S$ 是某个标量。因此，零空间 $N(\\mathbf{X})$ 是一个由向量 $k = (0, -1, -1, 1)^{\\top}$ 张成的一维空间。\n为了使 $c$ 位于 $\\mathbf{X}$ 的行空间中，它必须与 $N(\\mathbf{X})$ 中的每个向量正交，即 $c^{\\top}k = 0$。\n$$\nc^{\\top}k = (c_0, c_A, c_B, c_S) \\begin{pmatrix} 0 \\\\ -1 \\\\ -1 \\\\ 1 \\end{pmatrix} = -c_A - c_B + c_S = 0\n$$\n$c^{\\top}\\boldsymbol{\\beta}$ 可估的条件是 $c_S = c_A + c_B$。所有这类向量 $c$ 的集合构成了 $\\mathbb{R}^4$ 的一个 $3$ 维子空间。我们可以为这个子空间构建一组基。一组简单的基的选择是：\n$c^{(1)} = (1, 0, 0, 0)^{\\top}$，满足 $0 = 0+0$。\n$c^{(2)} = (0, 1, 0, 1)^{\\top}$，满足 $1 = 1+0$。\n$c^{(3)} = (0, 0, 1, 1)^{\\top}$，满足 $1 = 0+1$。\n这三个向量是线性无关的，并且张成了可估系数向量的空间。一个其行构成此基的矩阵是：\n$$\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  1 \\\\\n0  0  1  1\n\\end{pmatrix}\n$$\n\n第三，我们提出了一个最小维度的重参数化。原始模型是不可识别的，因为设计矩阵 $\\mathbf{X}$ 不是满列秩的。我们寻求一个新的维度为 $p=\\text{rank}(\\mathbf{X})=3$ 的参数向量 $\\boldsymbol{\\gamma}$ 和一个新的设计矩阵 $\\mathbf{Z}$，使得 $E[\\mathbf{Y}] = \\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{Z}\\boldsymbol{\\gamma}$ 并且 $\\mathbf{Z}$ 具有满列秩。这确保了 $\\boldsymbol{\\gamma}$ 的所有分量都是可识别的（因此也是可估的）。\n我们检查观测值 $i$ 的均值函数：\n$$\nE[Y_i] = \\beta_0 + \\beta_A A_i + \\beta_B B_i + \\beta_S(A_i+B_i)\n$$\n通过按协变量 $1$、$A_i$ 和 $B_i$ 对各项进行重新组合，我们得到了一个提示重参数化结构的表达式：\n$$\nE[Y_i] = \\beta_0 + (\\beta_A + \\beta_S) A_i + (\\beta_B + \\beta_S) B_i\n$$\n这引出了对新参数的如下选择：\n$\\gamma_0 = \\beta_0$\n$\\gamma_1 = \\beta_A + \\beta_S$\n$\\gamma_2 = \\beta_B + \\beta_S$\n新的参数向量是 $\\boldsymbol{\\gamma} = (\\gamma_0, \\gamma_1, \\gamma_2)^{\\top}$。均值模型变为 $E[Y_i] = \\gamma_0 + \\gamma_1 A_i + \\gamma_2 B_i$。相应的设计矩阵是 $\\mathbf{Z} = [\\mathbf{1}, \\mathbf{A}, \\mathbf{B}]$。根据假设，$\\mathbf{Z}$ 的列是线性无关的，所以 $\\mathbf{Z}$ 的秩为 $3$。由于 $\\mathbf{Z}$ 是一个秩为 $3$ 的 $n \\times 3$ 矩阵，它具有满列秩。$\\boldsymbol{\\gamma}$ 的维度是 $3$，这是可识别重参数化的最小可能维度。$\\boldsymbol{\\gamma}$ 的分量是构成自然基的具体可估函数。新参数的向量表示为原始参数 $\\boldsymbol{\\beta}$ 的线性变换如下：\n$$\n\\boldsymbol{\\gamma} = \\begin{pmatrix} \\beta_{0} \\\\ \\beta_{A} + \\beta_{S} \\\\ \\beta_{B} + \\beta_{S} \\end{pmatrix}\n$$\n这构成了一个满足所有要求的有效重参数化。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3  \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  1 \\\\ 0  0  1  1 \\end{pmatrix}  \\begin{pmatrix} \\beta_{0} \\\\ \\beta_{A} + \\beta_{S} \\\\ \\beta_{B} + \\beta_{S} \\end{pmatrix} \\end{pmatrix}}\n$$"
        }
    ]
}