{
    "hands_on_practices": [
        {
            "introduction": "在我们探索多重共线性的世界时，第一步是学会如何量化它。方差膨胀因子（VIF）是衡量模型中多重共线性严重程度的关键指标。本练习提供了一个基础的计算任务，旨在将我们熟悉的相关性概念直接转化为VIF值，为你进行模型诊断打下坚实的计算基础。",
            "id": "1938207",
            "problem": "一位计量经济学家正在开发一个线性回归模型来预测一家公司的年度利润。在潜在的预测变量中，有两个变量特别引人关注：$X_1$，即公司的年度营销支出，和 $X_2$，即其销售团队的规模。该计量经济学家怀疑这两个变量可能高度相关，这可能会使估计回归系数的方差膨胀。为了研究这个问题，他们根据数据集计算了营销支出和销售团队规模之间的样本相关系数，发现其值为 $r = 0.960$。\n\n为了量化这种多重共线性的严重程度，请计算这两个预测变量中任意一个的方差膨胀因子（VIF）。VIF 是衡量由于共线性导致估计回归系数的方差增加了多少的指标。将您的答案表示为一个数值，并四舍五入到三位有效数字。",
            "solution": "预测变量 $X_{j}$ 系数的方差膨胀因子定义为 $\\mathrm{VIF}_{j}=\\frac{1}{1-R_{j}^{2}}$，其中 $R_{j}^{2}$ 是将 $X_{j}$ 对所有其他预测变量进行回归得到的决定系数。当只有两个预测变量 $X_{1}$ 和 $X_{2}$ 时，一个变量对另一个变量的回归具有 $R_{1}^{2}=R_{2}^{2}=r^{2}$ 的关系，其中 $r$ 是 $X_{1}$ 和 $X_{2}$ 之间的样本相关系数。已知 $r=0.960$，我们有\n$$\nR_{j}^{2}=r^{2}=(0.960)^{2}=0.9216,\n$$\n所以\n$$\n\\mathrm{VIF}=\\frac{1}{1-R_{j}^{2}}=\\frac{1}{1-0.9216}=\\frac{1}{0.0784}=\\frac{625}{49}\\approx 12.7551020408.\n$$\n四舍五入到三位有效数字得到 $12.8$。",
            "answer": "$$\\boxed{12.8}$$"
        },
        {
            "introduction": "在掌握了VIF的计算之后，理解其对模型解释的实际影响至关重要。严重的多重共线性会破坏模型的稳定性，有时甚至导致回归系数的符号与理论预期或简单相关性相悖。本练习将深入探究这一看似矛盾的现象，通过一个具体的案例计算来揭示预测变量之间的高度相关性如何导致系数符号反转，从而强调诊断共线性的必要性。",
            "id": "1938238",
            "problem": "一位农业科学家正在研究一种新的玉米品种的产量。他们进行了一项实验，使用了两种不同液体肥料的不同用量，“Gro-Fast”（单位：毫升/株）和“Yield-Max”（单位：毫升/株）。科学家提出了一个关于玉米产量（单位：千克/株）$Y$ 的多元线性回归模型，该模型基于两种肥料的施用量，$X_1$ 代表 Gro-Fast 的施用量，$X_2$ 代表 Yield-Max 的施用量：\n$$Y = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\epsilon$$\n根据作物科学的先验知识，预计两种肥料都对产量有积极影响。然而，这两种肥料的化学成分相似，并且实验设计导致施用的 $X_1$ 和 $X_2$ 的量之间存在高度正相关。\n\n实验结束后，根据收集到的数据计算出以下汇总统计量：\n- 产量 ($Y$) 与 Gro-Fast ($X_1$) 之间的样本相关系数：$r_{y1} = 0.80$\n- 产量 ($Y$) 与 Yield-Max ($X_2$) 之间的样本相关系数：$r_{y2} = 0.90$\n- Gro-Fast ($X_1$) 与 Yield-Max ($X_2$) 之间的样本相关系数：$r_{12} = 0.95$\n\n- 产量 ($Y$) 的样本标准差：$s_y = 1.5$ kg\n- Gro-Fast ($X_1$) 的样本标准差：$s_1 = 10.0$ mL\n- Yield-Max ($X_2$) 的样本标准差：$s_2 = 12.0$ mL\n\n尽管 Gro-Fast 与产量之间存在强正简单相关 ($r_{y1} = 0.80$)，但多元回归分析却出人意料地得出了 Gro-Fast 的一个负估计系数 $\\hat{\\beta}_1$。计算 $\\hat{\\beta}_1$ 的值。答案以 kg/mL 为单位，并四舍五入到三位有效数字。",
            "solution": "我们从 $Y$ 对 $X_{1}$ 和 $X_{2}$ 的多元线性回归开始。令 $Z_{y}=(Y-\\bar{Y})/s_{y}$、$Z_{1}=(X_{1}-\\bar{X}_{1})/s_{1}$ 和 $Z_{2}=(X_{2}-\\bar{X}_{2})/s_{2}$ 为标准化变量。标准化回归的形式为\n$$\nZ_{y}=b_{1}^{\\ast}Z_{1}+b_{2}^{\\ast}Z_{2}+\\varepsilon,\n$$\n其中标准化系数满足\n$$\n\\begin{pmatrix}\nb_{1}^{\\ast}\\\\\nb_{2}^{\\ast}\n\\end{pmatrix}\n=R^{-1}\n\\begin{pmatrix}\nr_{y1}\\\\\nr_{y2}\n\\end{pmatrix},\n\\quad\nR=\n\\begin{pmatrix}\n1  & r_{12}\\\\\nr_{12} & 1\n\\end{pmatrix}.\n$$\n这个 $2\\times 2$ 相关矩阵的逆矩阵是\n$$\nR^{-1}=\\frac{1}{1-r_{12}^{2}}\n\\begin{pmatrix}\n1 & -r_{12}\\\\\n-r_{12} & 1\n\\end{pmatrix}.\n$$\n因此，\n$$\nb_{1}^{\\ast}=\\frac{r_{y1}-r_{12}r_{y2}}{1-r_{12}^{2}},\n\\qquad\nb_{2}^{\\ast}=\\frac{r_{y2}-r_{12}r_{y1}}{1-r_{12}^{2}}.\n$$\n$X_{1}$ 的非标准化系数通过重新缩放得到：\n$$\n\\hat{\\beta}_{1}=b_{1}^{\\ast}\\frac{s_{y}}{s_{1}}=\\frac{r_{y1}-r_{12}r_{y2}}{1-r_{12}^{2}}\\cdot\\frac{s_{y}}{s_{1}}.\n$$\n代入给定值 $r_{y1}=0.80$，$r_{y2}=0.90$，$r_{12}=0.95$，$s_{y}=1.5$ 和 $s_{1}=10.0$，我们计算\n$$\nr_{y1}-r_{12}r_{y2}=0.80-0.95\\cdot 0.90=0.80-0.855=-0.055,\n$$\n$$\n1-r_{12}^{2}=1-0.95^{2}=1-0.9025=0.0975,\n$$\n所以\n$$\nb_{1}^{\\ast}=\\frac{-0.055}{0.0975}=-\\frac{22}{39}\\approx -0.56410256.\n$$\n然后\n$$\n\\hat{\\beta}_{1}=b_{1}^{\\ast}\\frac{s_{y}}{s_{1}}=-\\frac{22}{39}\\cdot\\frac{1.5}{10}=-\\frac{22}{39}\\cdot 0.15\\approx -0.08461538.\n$$\n四舍五入到三位有效数字，我们得到\n$$\n\\hat{\\beta}_{1}\\approx -0.0846.\n$$\n尽管存在正的简单相关性，但这个负系数的出现是由于 $X_{1}$ 和 $X_{2}$ 之间存在强正共线性，这改变了偏效应的估计值。",
            "answer": "$$\\boxed{-0.0846}$$"
        },
        {
            "introduction": "在实际应用中，多重共线性常常出现在多项式回归等特定模型结构中。这个高级练习将引导你处理一个常见场景：一个变量 $X$ 和其平方项 $X^2$ 之间存在的高度相关性。你将学习并应用一种强大的技术——均值中心化——来解决这个问题，并通过亲手计算来观察该技术如何有效地降低VIF值，从而提高模型的稳定性和可解释性。",
            "id": "4929491",
            "problem": "考虑一项生物统计学研究中，关于连续协变量 $X$ 对结果变量 $Y$ 的二次多项式回归，其模型指定为 $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} X^{2} + \\varepsilon$，其中 $\\varepsilon$ 是一个均值为零且与 $X$ 无关的误差项。研究人员担心 $X$ 和 $X^{2}$ 之间存在多重共线性，并希望通过方差膨胀因子 (VIF) 来量化它。\n\n给定一个大小为 $n=7$ 的简单且科学上合理的协变量样本：$X_{i} \\in \\{1, 2, 3, 4, 5, 6, 7\\}$，其中 $i=1,\\dots,7$。请仅使用最小二乘回归和决定系数 $R^{2}$ 的基本定义（不依赖任何非由这些定义推导出的快捷公式），计算在以下两种设计规格中，预测变量 $X$ 和 $X^{2}$ 的方差膨胀因子（VIF）：\n\n- 中心化之前：设计矩阵的列分别对应于截距项、$X$ 和 $X^{2}$。\n- 中心化之后：定义 $Z = X - \\bar{X}$，其中 $\\bar{X}$ 是 $X$ 的样本均值。设计矩阵的列分别对应于截距项、$Z$ 和 $Z^{2}$。\n\n在每种规格中，根据多重共线性的基本定义，通过将每个预测变量（索引为 $j$）对其他预测变量和截距项进行回归，以获得相关的 $R_{j}^{2}$，然后计算 $X$ 和 $X^{2}$（或中心化后的 $Z$ 和 $Z^{2}$）的相应 VIF。最后，基于 $X$ 的矩的性质，解释未中心化和中心化规格之间 $R_{j}^{2}$ 的观察到的差异。\n\n将你的最终答案表示为一个单行矩阵中的四个数字，顺序为：中心化前 $X$ 的 VIF、中心化前 $X^{2}$ 的 VIF、中心化后 $Z$ 的 VIF、中心化后 $Z^{2}$ 的 VIF。无需四舍五入。",
            "solution": "该问题要求计算二次回归模型 $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} X^{2} + \\varepsilon$ 中，协变量 $X$ 在中心化前后，预测变量的方差膨胀因子 (VIF)。预测变量 $j$ 的 VIF，记为 $VIF_j$，是多重共线性的一个度量，由以下公式定义：\n$$VIF_j = \\frac{1}{1 - R_j^2}$$\n此处，$R_j^2$ 是将预测变量 $X_j$ 对模型中所有其他预测变量（包括截距项）进行辅助普通最小二乘 (OLS) 回归得到的决定系数。对于变量 $U$ 对变量 $V$ 的简单线性回归 $U = \\gamma_0 + \\gamma_1 V + \\text{error}$，决定系数 $R^2$ 是 $U$ 和 $V$ 之间 Pearson 相关系数的平方。其基本计算公式为：\n$$R^2 = \\frac{\\left( \\sum_{i=1}^n (U_i - \\bar{U})(V_i - \\bar{V}) \\right)^2}{\\left( \\sum_{i=1}^n (U_i - \\bar{U})^2 \\right) \\left( \\sum_{i=1}^n (V_i - \\bar{V})^2 \\right)}$$\n我们得到一个大小为 $n=7$ 的协变量 $X$ 样本：$X_i \\in \\{1, 2, 3, 4, 5, 6, 7\\}$。\n\n首先，我们为给定数据汇总计算必要的样本和与矩。\n$X$ 的值为 $\\{1, 2, 3, 4, 5, 6, 7\\}$。\n$\\sum_{i=1}^7 X_i = 1+2+3+4+5+6+7 = 28$。\n$X$ 的样本均值为 $\\bar{X} = \\frac{28}{7} = 4$。\n$X^2$ 的值为 $\\{1^2, 2^2, \\dots, 7^2\\} = \\{1, 4, 9, 16, 25, 36, 49\\}$。\n$\\sum_{i=1}^7 X_i^2 = 1+4+9+16+25+36+49 = 140$。\n$X^2$ 的样本均值为 $\\overline{X^2} = \\frac{140}{7} = 20$。\n我们还需要更高阶的矩来进行交叉乘积的计算：\n$\\sum_{i=1}^7 X_i^3 = 1^3+2^3+\\dots+7^3 = 1+8+27+64+125+216+343 = 784$。\n$\\sum_{i=1}^7 X_i^4 = 1^4+2^4+\\dots+7^4 = 1+16+81+256+625+1296+2401 = 4676$。\n\n**第1部分：中心化前的 VIF**\n\n预测变量是截距项、$P_1 = X$ 和 $P_2 = X^2$。\n\n为了找到 $X$ 的 VIF，我们必须计算 $X$ 对 $X^2$ 和截距项回归的 $R_X^2$。\n令 $U=X$ 且 $V=X^2$。我们计算 $R^2$ 公式中的各项：\n$X$ 的总平方和是：\n$$SS_{tot}(X) = \\sum_{i=1}^7 (X_i - \\bar{X})^2 = \\sum X_i^2 - n\\bar{X}^2 = 140 - 7(4^2) = 140 - 112 = 28$$\n$X^2$ 的总平方和是：\n$$SS_{tot}(X^2) = \\sum_{i=1}^7 (X_i^2 - \\overline{X^2})^2 = \\sum X_i^4 - n(\\overline{X^2})^2 = 4676 - 7(20^2) = 4676 - 2800 = 1876$$\n$X$ 和 $X^2$ 之间的交叉积和是：\n$$S_{X,X^2} = \\sum_{i=1}^7 (X_i - \\bar{X})(X_i^2 - \\overline{X^2}) = \\sum X_i^3 - n\\bar{X}\\overline{X^2} = 784 - 7(4)(20) = 784 - 560 = 224$$\n现在，我们计算 $R_X^2$：\n$$R_X^2 = \\frac{S_{X,X^2}^2}{SS_{tot}(X) \\cdot SS_{tot}(X^2)} = \\frac{224^2}{28 \\cdot 1876} = \\frac{50176}{52528} = \\frac{448}{469}$$\n因此，$X$ 的 VIF 是：\n$$VIF_X = \\frac{1}{1 - R_X^2} = \\frac{1}{1 - \\frac{448}{469}} = \\frac{1}{\\frac{469 - 448}{469}} = \\frac{469}{21}$$\n为了找到 $X^2$ 的 VIF，我们需要从 $X^2$ 对 $X$ 和截距项的回归中得到 $R_{X^2}^2$。因为在简单线性回归中，决定系数 $R^2$ 对两个变量是对称的，所以 $R_{X^2}^2 = R_X^2 = \\frac{448}{469}$。\n因此，$X^2$ 的 VIF 与 $X$ 的 VIF 相同：\n$$VIF_{X^2} = \\frac{1}{1 - R_{X^2}^2} = \\frac{469}{21}$$\n\n**第2部分：中心化后的 VIF**\n\n我们定义中心化变量 $Z = X - \\bar{X} = X - 4$。现在的预测变量是截距项、$P'_1 = Z$ 和 $P'_2 = Z^2$。\n$Z$ 的值为 $\\{1-4, 2-4, \\dots, 7-4\\} = \\{-3, -2, -1, 0, 1, 2, 3\\}$。\n$Z$ 的样本均值为 $\\bar{Z} = \\frac{1}{7}\\sum Z_i = \\frac{0}{7} = 0$。\n$Z^2$ 的值为 $\\{(-3)^2, (-2)^2, \\dots, 3^2\\} = \\{9, 4, 1, 0, 1, 4, 9\\}$。\n$\\sum_{i=1}^7 Z_i^2 = 9+4+1+0+1+4+9 = 28$。\n$Z^2$ 的样本均值为 $\\overline{Z^2} = \\frac{28}{7} = 4$。\n\n为了找到 $Z$ 的 VIF，我们计算 $Z$ 对 $Z^2$ 和截距项回归的 $R_Z^2$。\n令 $U=Z$ 且 $V=Z^2$。我们计算交叉积和 $S_{Z,Z^2}$：\n$$S_{Z,Z^2} = \\sum_{i=1}^7 (Z_i - \\bar{Z})(Z_i^2 - \\overline{Z^2})$$\n由于 $\\bar{Z}=0$，这可以简化为：\n$$S_{Z,Z^2} = \\sum_{i=1}^7 Z_i(Z_i^2 - \\overline{Z^2}) = \\sum_{i=1}^7 Z_i^3 - \\overline{Z^2} \\sum_{i=1}^7 Z_i$$\n我们知道 $\\sum Z_i = 0$。我们计算 $\\sum Z_i^3$：\n$\\sum_{i=1}^7 Z_i^3 = (-3)^3 + (-2)^3 + (-1)^3 + 0^3 + 1^3 + 2^3 + 3^3 = -27 - 8 - 1 + 0 + 1 + 8 + 27 = 0$。\n因此，交叉积和为：\n$$S_{Z,Z^2} = 0 - 4(0) = 0$$\n由于 $R^2$ 公式的分子是 $S_{Z,Z^2}^2 = 0^2 = 0$，所以立即得出 $R_Z^2 = 0$。\n$Z$ 的 VIF 是：\n$$VIF_Z = \\frac{1}{1 - R_Z^2} = \\frac{1}{1 - 0} = 1$$\n根据与未中心化情况相同的对称性论证，$R_{Z^2}^2 = R_Z^2 = 0$。因此，$Z^2$ 的 VIF 是：\n$$VIF_{Z^2} = \\frac{1}{1 - R_{Z^2}^2} = 1$$\n\n**第3部分：差异解释**\n\n未中心化和中心化规格之间VIF的显著差异，源于一个变量与其平方之间的样本相关性，而这从根本上与该变量样本分布的对称性质相关。\n\n在**未中心化**的情况下，预测变量是 $X$ 和 $X^2$。高 VIF 值（$\\frac{469}{21} \\approx 22.3$）表明存在强多重共线性。这种共线性由 $X$ 和 $X^2$ 之间的非零样本相关性来量化。相关性之所以非零，是因为交叉积和 $S_{X,X^2} = \\sum (X_i-\\bar{X})(X_i^2-\\overline{X^2})$ 非零。项 $(X_i-\\bar{X})$ 代表一个关于零对称的变量，但项 $(X_i^2-\\overline{X^2})$ 并非对称。这些项的乘积在样本上求和后不会抵消为零，从而导致非零的协方差，并因此产生高相关性。\n\n在**中心化**的情况下，预测变量是 $Z = X-\\bar{X}$ 和 $Z^2$。VIF 均为 1，这是可能的最小值，表明 $Z$ 和 $Z^2$ 之间完全不存在多重共线性。这是因为 $Z$ 和 $Z^2$ 之间的样本相关性恰好为零。交叉积和 $S_{Z,Z^2} = \\sum (Z_i-\\bar{Z})(Z_i^2-\\overline{Z^2})$ 为零。如计算所示，当 $\\bar{Z}=0$ 时，该和简化为 $\\sum Z_i^3$。$Z$ 的样本数据 $\\{-3, -2, -1, 0, 1, 2, 3\\}$ 关于其均值 0 是完全对称的。任何关于零对称的数据分布的一个基本性质是，其所有奇数阶样本矩均为零。因此，三阶样本矩 $\\sum Z_i^3$ 为零。这种零协方差导致了零相关性和 $R^2=0$，进而得到 $VIF=1$。\n\n总而言之，对协变量 $X$ 进行中心化创建了一个新变量 $Z$，其样本分布关于零对称。这种特定的对称性质使得 $Z$ 和 $Z^2$ 不相关（在有截距项的回归背景下是正交的），从而解决了原始未中心化预测变量 $X$ 与其平方 $X^2$ 之间存在的多重共线性问题。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{469}{21} & \\frac{469}{21} & 1 & 1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}