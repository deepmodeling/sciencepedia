{
    "hands_on_practices": [
        {
            "introduction": "在构建倾向性得分模型之前，我们必须首先回答一个基本问题：“应该在模型中包含哪些变量？”。有向无环图（DAGs）为我们提供了一个强大的理论框架，通过可视化变量间的因果关系来识别混杂路径。这项练习将帮助你运用DAG和d-分离规则，精确识别需要调整的混杂变量，从而为建立一个有效的倾向性得分模型奠定坚实的基础。",
            "id": "4943138",
            "problem": "考虑一项观察性研究，旨在评估二元处理 $A$ 对连续结果 $Y$ 的因果效应。设 $X$ 表示一个可测量的处理前协变量，$U$ 表示一个未测量的患者因素。假设数据生成过程由以下有向无环图 (DAG) 表示：存在有向边 $U \\to A$、$U \\to X$、$X \\to A$、$X \\to Y$ 和 $A \\to Y$，并且没有其他箭头。假设满足倾向性得分方法的标准因果可识别性条件，包括正性和一致性。使用 DAG 上的 d-分离规则来推断混杂，其中从 $A$ 到 $Y$ 的后门路径是指任何以指向 $A$ 的箭头开始，并且在给定空条件集的情况下保持开放的路径。识别该 DAG 中从 $A$ 到 $Y$ 的所有开放后门路径，并指定一个由观测变量组成的最小调整集，该调整集能阻断所有这些后门路径，而不会阻断因果路径 $A \\to Y$ 或通过对撞节点打开新的路径。你的答案应适合纳入倾向性得分 (PS) 模型。\n\n哪个选项正确列出了开放的后门路径并给出了阻断它们的最小调整集？\n\nA. 后门路径：仅 $A \\leftarrow X \\to Y$；最小调整集 $\\{X\\}$。\n\nB. 后门路径：$A \\leftarrow U \\to Y$ 和 $A \\leftarrow X \\to Y$；最小调整集 $\\{U,X\\}$。\n\nC. 后门路径：$A \\leftarrow U \\to X \\to Y$ 和 $A \\leftarrow X \\to Y$；最小调整集 $\\{X\\}$。\n\nD. 无后门路径；最小调整集 $\\varnothing$。\n\nE. 后门路径：仅 $A \\leftarrow U \\to X \\to Y$；最小调整集 $\\{U\\}$。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知信息\n-   **研究类型**：观察性研究。\n-   **变量**：\n    -   $A$：二元处理。\n    -   $Y$：连续结果。\n    -   $X$：可测量的处理前协变量。\n    -   $U$：未测量的患者因素。\n-   **数据生成过程 (DAG)**：该有向无环图包含以下有向边：\n    1.  $U \\to A$\n    2.  $U \\to X$\n    3.  $X \\to A$\n    4.  $X \\to Y$\n    5.  $A \\to Y$\n    -   不存在其他箭头。\n-   **假设**：标准的因果可识别性条件，包括正性和一致性。\n-   **定义**：从 $A$ 到 $Y$ 的后门路径定义为“任何以指向 $A$ 的箭头开始，并且在给定空条件集的情况下保持开放的路径。”\n-   **目标**：识别从 $A$ 到 $Y$ 的所有开放后门路径，并指定一个由观测变量组成的最小调整集来阻断所有这些路径，该调整集适用于倾向性得分 (PS) 模型。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题陈述进行分析：\n\n-   **科学依据**：该问题在因果推断理论中有充分的依据，该理论使用有向无环图 (DAG)，是生物统计学、流行病学和计算机科学中的一个标准且严谨的框架。混杂、d-分离、后门路径和调整集等概念都是该框架的核心原则。\n-   **适定性**：该问题是适定的。DAG 结构被明确定义，目标清晰，d-分离规则为识别路径和确定条件化效应提供了一种确定性方法。存在一个唯一且有意义的解。\n-   **客观性**：该问题以精确、客观和技术性的语言陈述，没有歧义或主观性论断。\n-   **完整性和一致性**：该问题提供了所有必要信息：变量、它们的关系（DAG）、可测量 ($X$) 和未测量 ($U$) 变量之间的区别，以及具体目标（找到路径和一个由观测变量组成的最小调整集）。前提条件是内部一致的。\n-   **现实性和可行性**：该场景代表了观察性研究中一种典型的混杂结构，其中一个可测量的协变量 ($X$) 和一个未测量的协变量 ($U$) 都是处理和结果（或结果路径上的变量）的共同原因。在应用研究中，区分可测量和未测量的变量是一个关键且现实的约束。\n-   **其他缺陷**：该问题不是琐碎的、同义反复的、不适定的或不可验证的。它需要正确应用已建立的因果推断原则。\n\n### 步骤 3：结论与行动\n问题是**有效的**。可以继续进行分析。\n\n## 解题推导\n\n目标是识别从处理 $A$ 到结果 $Y$ 的所有开放后门路径，然后找到一个由观测变量组成的最小充分调整集来阻断这些路径。我们感兴趣的因果路径是直接边 $A \\to Y$。后门路径是 $A$ 和 $Y$ 之间的一条非因果路径，它会产生伪关联。\n\nDAG 由以下边定义：$U \\to A$、$U \\to X$、$X \\to A$、$X \\to Y$ 和 $A \\to Y$。\n\n**1. 识别后门路径**\n\n从 $A$ 到 $Y$ 的后门路径是一条以指向 $A$ 的箭头开始的路径（即 $A \\leftarrow \\dots$）。我们必须追踪所有连接 $A$ 和 $Y$ 但不包含边 $A \\to Y$ 的此类路径。如果一条路径上没有对撞节点，或者路径上的每个对撞节点都在条件集中（当前为空集），则该路径是“开放的”。\n\n-   **路径 1**：考虑通过协变量 $X$ 的路径。该路径为 $A \\leftarrow X \\to Y$。\n    -   它以指向 $A$ 的箭头开始：$A \\leftarrow X$。\n    -   它将 $A$ 连接到 $Y$。\n    -   这条路径是以 $X$ 为中心的分叉结构。该路径上没有对撞节点。\n    -   因此，在给定空条件集的情况下，$A \\leftarrow X \\to Y$ 是一条开放的后门路径。\n\n-   **路径 2**：考虑涉及未测量因素 $U$ 的路径。\n    -   一条路径以 $A \\leftarrow U$ 开始。为了从 $U$ 到达 $Y$，我们观察到路径 $U \\to X \\to Y$。\n    -   将它们组合起来得到路径：$A \\leftarrow U \\to X \\to Y$。\n    -   它以指向 $A$ 的箭头开始：$A \\leftarrow U$。\n    -   它通过 $U$ 和 $X$ 将 $A$ 连接到 $Y$。\n    -   这条路径是一个链式结构 ($U \\to X \\to Y$)。该路径上没有对撞节点。\n    -   因此，在给定空条件集的情况下，$A \\leftarrow U \\to X \\to Y$ 是一条开放的后门路径。\n\n-   **其他潜在路径**：还有其他路径吗？我们来检查一下涉及对撞节点的路径。\n    -   节点 $A$ 是路径 $U \\to A \\leftarrow X$ 上的一个对撞节点。这条路径连接的是 $U$ 和 $X$，而不是 $A$ 和 $Y$。它不是从 $A$ 到 $Y$ 的后门路径。\n    -   节点 $Y$ 是路径 $X \\to Y \\leftarrow A$ 上的一个对撞节点，但后门路径不能通过结果变量。\n\n因此，从 $A$ 到 $Y$ 共有两条开放的后门路径：\n1.  $A \\leftarrow X \\to Y$\n2.  $A \\leftarrow U \\to X \\to Y$\n\n**2. 识别最小充分调整集**\n\n为了估计 $A$ 对 $Y$ 的因果效应，我们必须通过对一组观测协变量进行条件化来阻断这两条后门路径。唯一的观测协变量是 $X$。因素 $U$ 是未测量的，不能包含在倾向性得分模型的调整集中。\n\n-   **阻断路径 1 ($A \\leftarrow X \\to Y$)**：这条路径在 $X$ 处是一个分叉。根据 d-分离规则，对分叉变量 $X$ 进行条件化可以阻断该路径。\n-   **阻断路径 2 ($A \\leftarrow U \\to X \\to Y$)**：这条路径是一个链条。对链条中的任何中间变量进行条件化都可以阻断该路径。$X$ 是这条路径上的一个中间变量。因此，对 $X$ 进行条件化也阻断了这条路径。\n    \n对集合 $\\{X\\}$ 进行条件化足以阻断两条开放的后门路径。\n\n现在，我们必须验证 $\\{X\\}$ 是否是一个最小集合，以及对其进行条件化是否会引发任何新问题。\n-   **最小性**：唯一更小的集合是空集 $\\varnothing$。对 $\\varnothing$ 进行条件化会使两条路径都保持开放。因此，$\\{X\\}$ 是一个最小充分调整集。\n-   **条件化的有效性**：我们必须确保对 $X$ 进行条件化不会阻断因果路径或打开一条新的偏倚路径。\n    -   $X$ 不是因果路径 $A \\to Y$ 上的中介变量，因此对其进行条件化不会阻断因果效应。\n    -   如果一个变量是某条路径上的对撞节点，那么对该变量进行条件化会打开该路径。系统中除结果变量外唯一的对撞节点是路径 $U \\to A \\leftarrow X$ 上的 $A$。对 $X$ 进行条件化不会打开这条路径（只有对 $A$ 或其后代进行条件化才会）。\n    \n因此，$\\{X\\}$ 是由观测变量组成的正确的最小充分调整集。\n\n## 逐项分析\n\n-   **A. 后门路径：仅 $A \\leftarrow X \\to Y$；最小调整集 $\\{X\\}$。**\n    -   识别出的后门路径列表不完整；它遗漏了路径 $A \\leftarrow U \\to X \\to Y$。虽然最小调整集是正确的，但其选择的前提是有缺陷的。\n    -   **结论**：错误。\n\n-   **B. 后门路径：$A \\leftarrow U \\to Y$ 和 $A \\leftarrow X \\to Y$；最小调整集 $\\{U,X\\}$。**\n    -   路径 $A \\leftarrow U \\to Y$ 在指定的 DAG 中不存在；从 $U$ 到 $Y$ 的路径是由 $X$ 中介的。正确的路径是 $A \\leftarrow U \\to X \\to Y$。调整集 $\\{U,X\\}$ 是无效的，因为 $U$ 是未测量的，在实践中无法对其进行条件化。此外，该集合不是最小的，因为 $\\{X\\}$ 就足够了。\n    -   **结论**：错误。\n\n-   **C. 后门路径：$A \\leftarrow U \\to X \\to Y$ 和 $A \\leftarrow X \\to Y$；最小调整集 $\\{X\\}$。**\n    -   该选项正确地识别了两条开放的后门路径：$A \\leftarrow X \\to Y$ 和 $A \\leftarrow U \\to X \\to Y$。\n    -   它还正确地将 $\\{X\\}$ 识别为由观测变量组成的最小充分调整集，该调整集可以阻断这两条路径。\n    -   **结论**：正确。\n\n-   **D. 无后门路径；最小调整集 $\\varnothing$。**\n    -   这是错误的。如推导所示，存在两条开放的后门路径造成混杂。空集 $\\varnothing$ 不是一个充分的调整集。\n    -   **结论**：错误。\n\n-   **E. 后门路径：仅 $A \\leftarrow U \\to X \\to Y$；最小调整集 $\\{U\\}$。**\n    -   后门路径列表不完整；它遗漏了路径 $A \\leftarrow X \\to Y$。建议的调整集 $\\{U\\}$ 是错误的，原因有二：(1) $U$ 是未测量的，(2) 仅对 $U$ 进行条件化不会阻断路径 $A \\leftarrow X \\to Y$。\n    -   **结论**：错误。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "倾向性得分模型的最终目标并非是完美预测治疗分配，而是为了在治疗组和对照组之间实现协变量的平衡。因此，模型的构建过程不应以预测准确性指标（如$AIC$或$c$-统计量）为导向，而应以平衡性诊断为核心。这项练习将指导你采用一种迭代的、以诊断为驱动的策略来构建模型，确保最终的因果效应估计是基于一个真正实现了协变量平衡的伪群体。",
            "id": "4943065",
            "problem": "一项观察性队列研究旨在使用倾向性得分方法，估计一个二元处理 $T \\in \\{0,1\\}$ 对一个连续结果 $Y$ 的平均处理效应。设协变量向量为 $\\mathbf{X} = (X_1, X_2, \\dots, X_p)$，所有协变量均在处理分配前测量。倾向性得分定义为 $e(\\mathbf{X}) = \\mathbb{P}(T=1 \\mid \\mathbf{X})$。一个基本性质是，在模型设定正确且无未测量混杂的情况下，以任何平衡得分为条件，可以使处理独立于协变量：$T \\perp \\mathbf{X} \\mid b(\\mathbf{X})$，其中倾向性得分 $e(\\mathbf{X})$ 就是一个平衡得分。治疗概率倒数加权法（IPTW）构建权重 $w_i$ 来近似一个伪人群，在该伪人群中，$\\mathbf{X}$ 的分布在 $T=1$ 和 $T=0$ 两组间是相同的。如果 $e(\\mathbf{X})$ 设定正确，则可以得到加权后的协变量平衡。在实践中，经验性平衡通常使用标准化均值差异（SMD）来评估，每个协变量及其显著变换的可接受平衡的常用阈值为 $\\lvert \\text{SMD} \\rvert  0.1$。处理分配模型的模型拟合指标，如赤池信息准则（AIC）和一致性统计量（C-统计量），量化的是基于似然的拟合优度或区分度，但并不直接评估加权或匹配后处理组间的协变量平衡。重叠性与正性要求对所有个体 $i$，存在某个小的 $\\epsilon > 0$，使得 $e(\\mathbf{X}_i) \\in (\\epsilon, 1-\\epsilon)$，以避免出现极端权重。\n\n您的任务是选择一种迭代式倾向性得分模型再设定策略。该策略在设计上应优先实现经验性协变量平衡（由平衡性诊断指标显示），而不是改善处理模型的基于似然的拟合优度或区分度。该策略应具有科学合理性，尊重时序性（不包含处理后变量），并包含与平衡得分原理一致的停止规则和诊断方法。哪个选项最符合这些标准？\n\nA. 从一个用于 $e(\\mathbf{X})$ 的逻辑回归模型开始，执行逐步选择以最小化赤池信息准则（AIC），当模型达到最低AIC时停止。只要一致性统计量（C-统计量）超过0.8，就使用得到的模型进行IPTW，不再进一步迭代。\n\nB. 初始化一个用于 $e(\\mathbf{X})$ 的逻辑回归模型，根据专业知识，纳入所有可能与 $T$ 和/或 $Y$ 相关的处理前协变量。在估计权重后（如有需要，考虑稳定化或截断权重），计算每个 $X_j$ 以及预先设定的灵活项（例如，$X_j^2$，交互作用如 $X_j X_k$，或样条基）的加权标准化均值差异（SMD）。通过添加、转换或交互那些显示最大残余不平衡的协变量来迭代地再设定倾向性得分模型，重新估计 $e(\\mathbf{X})$ 和权重，并重新检查加权后的SMD。持续此过程，直到所有 $\\lvert \\text{SMD} \\rvert  0.1$ 且权重诊断表明重叠性和稳定性可接受（例如，极端权重很少），无论AIC或C-统计量如何，然后继续进行效应估计。\n\nC. 选择最近邻匹配法，其卡尺（calipers）的选择旨在最小化匹配样本中结果 $Y$ 的回归模型的交叉验证预测误差。迭代卡尺宽度和匹配比例，直到预测 $Y$ 的样本外均方误差最小化，然后使用匹配后的数据估计处理效应。\n\nD. 拟合一个用于 $e(\\mathbf{X})$ 的逻辑回归模型，并迭代地添加协变量，直到Hosmer–Lemeshow拟合优度检验的p值大于0.05。以此作为停止规则，并假设一个校准良好的处理模型能确保协变量平衡，然后进行IPTW。\n\nE. 通过纳入效应的强基线后中介变量（在处理开始后测量且受 $T$ 影响的变量）来扩展倾向性得分模型，以改善处理组和未处理组之间的分离度，迭代直到C-统计量超过0.9；然后估计IPTW。\n\n选择唯一的最佳选项。",
            "solution": "用户提供了一个关于为因果推断选择合适的倾向性得分模型构建策略的问题陈述。核心任务是识别出那个正确地将实现经验性协变量平衡作为优先级的策略。\n\n### 问题陈述验证\n\n**第1步：提取已知条件**\n- **研究类型**：一项观察性队列研究。\n- **目标**：估计一个二元处理 $T \\in \\{0,1\\}$ 对一个连续结果 $Y$ 的平均处理效应。\n- **协变量**：一个处理前向量 $\\mathbf{X} = (X_1, X_2, \\dots, X_p)$。\n- **倾向性得分定义**：$e(\\mathbf{X}) = \\mathbb{P}(T=1 \\mid \\mathbf{X})$。\n- **基本性质**：在模型设定正确且无未测量混杂的情况下，以一个平衡得分 $b(\\mathbf{X})$（如倾向性得分 $e(\\mathbf{X})$）为条件，可以使处理独立于协变量：$T \\perp \\mathbf{X} \\mid b(\\mathbf{X})$。\n- **IPTW方法**：治疗概率倒数加权法（IPTW）使用权重 $w_i$ 来模拟一个伪人群，其中 $\\mathbf{X}$ 的分布在处理组（$T=1$）和对照组（$T=0$）之间是相同的。\n- **平衡性诊断**：经验性平衡使用标准化均值差异（SMD）进行评估，一个共同的目标是 $\\lvert \\text{SMD} \\rvert  0.1$。\n- **模型拟合指标**：像赤池信息准则（AIC）和一致性统计量（C-统计量）这类指标量化的是基于似然的拟合优度或区分度，但不是协变量平衡的直接度量。\n- **正性假设**：对所有受试者 $i$，倾向性得分必须有界，不为 $0$ 或 $1$，即对某个小的 $\\epsilon > 0$，有 $e(\\mathbf{X}_i) \\in (\\epsilon, 1-\\epsilon)$。\n- **任务**：为倾向性得分选择一种迭代式模型再设定策略，该策略具有科学合理性，尊重时序性，并明确地将实现经验性协变量平衡置于改善基于似然的模型拟合或区分度之上。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础**：该问题陈述牢固地植根于由Rosenbaum、Rubin等人发展的因果推断和倾向性得分方法的既定理论。所有定义——倾向性得分、平衡性质、IPTW、正性以及像SMD这样的诊断方法——都是标准的并且描述准确。在用于预测的模型（用AIC/C-统计量优化）和用于因果调整的模型（通过实现平衡来优化）之间所做的区分，是生物统计学中一个关键且有效的概念。\n- **问题定义明确**：问题定义明确。它要求根据清晰、明确的标准（优先考虑经验性平衡），从一系列选项中选择*最佳*策略。这种结构允许基于既定的方法论原则得出一个唯一且有意义的解。\n- **客观性**：语言精确、技术性强，没有主观或带偏见的措辞。它提出了应用统计学中一个标准的方法论挑战。\n\n**第3步：结论与行动**\n该问题陈述科学合理、定义明确、客观且自洽。没有矛盾、歧义或事实错误。问题是有效的。我将通过评估所提供的选项与倾向性得分方法论的原则来推导出正确答案。\n\n### 解题推导与选项分析\n\n在因果推断中，倾向性得分模型的主要目的不是以最高精度预测处理分配。相反，它的功能是作为协变量向量 $\\mathbf{X}$ 的一个降维工具，当以它为条件时，能够平衡处理组和未处理组之间这些协变量的分布。性质 $T \\perp \\mathbf{X} \\mid e(\\mathbf{X})$ 意味着，在由倾向性得分 $e(\\mathbf{X})$ 定义的层内，协变量 $\\mathbf{X}$ 和处理分配 $T$ 是独立的。这有效地模仿了在随机对照试验中平均期望达到的协变量平衡。\n\n因此，倾向性得分模型的成功与否，不是由其预测性能（例如，高C-统计量或低AIC）来判断，而是由其实现这种经验性平衡的能力来判断。模型构建策略必须围绕这个目标。这个过程应该是迭代的，即提出一个初始模型，检查由此产生的平衡，然后改进模型，直到根据预先设定的诊断标准（如SMD）达到平衡。评估预测能力的指标，如C-统计量，可能会产生误导。一个非常高的C-统计量（例如， 0.9）通常表示缺乏重叠（违反了正性假设），意味着在相反的处理组中没有可比较的受试者，这使得因果效应估计变得不可能。同样，最小化AIC或其他基于似然的标准是为了优化预测，这与实现平衡是不同的目标。\n\n最后，一个关键原则是时序性。倾向性得分模型必须只包含处理前的协变量。包含处理后的变量，特别是处理效应的中介变量，是一个严重的方法论缺陷，它可能通过调整掉部分感兴趣的因果效应或以一个对撞因子为条件而引入偏倚。\n\n基于这些原则，我将评估每个选项。\n\n**A. 从一个用于 $e(\\mathbf{X})$ 的逻辑回归模型开始，执行逐步选择以最小化赤池信息准则（AIC），当模型达到最低AIC时停止。只要一致性统计量（C-统计量）超过0.8，就使用得到的模型进行IPTW，不再进一步迭代。**\n该策略明确地将基于似然的模型拟合（最小化AIC）和区分度（C-统计量）放在首位。如前所述，这些不是为因果推断开发倾向性得分模型的适当标准。主要目标是平衡，而这个策略没有评估平衡。它缺少了检查和改善平衡这一必要的迭代循环。此外，高C-统计量不一定是可取的。\n**结论：错误。**\n\n**B. 初始化一个用于 $e(\\mathbf{X})$ 的逻辑回归模型，根据专业知识，纳入所有可能与 $T$ 和/或 $Y$ 相关的处理前协变量。在估计权重后（如有需要，考虑稳定化或截断权重），计算每个 $X_j$ 以及预先设定的灵活项（例如，$X_j^2$，交互作用如 $X_j X_k$，或样条基）的加权标准化均值差异（SMD）。通过添加、转换或交互那些显示最大残余不平衡的协变量来迭代地再设定倾向性得分模型，重新估计 $e(\\mathbf{X})$ 和权重，并重新检查加权后的SMD。持续此过程，直到所有 $\\lvert \\text{SMD} \\rvert  0.1$ 且权重诊断表明重叠性和稳定性可接受（例如，极端权重很少），无论AIC或C-统计量如何，然后继续进行效应估计。**\n这个策略是正确方法的教科书式例子。它从一个有科学依据的模型开始，使用一个由正确诊断指标（用于平衡的SMD）驱动的迭代过程，有一个清晰且适当的停止规则（$\\lvert \\text{SMD} \\rvert  0.1$），为此目的正确地忽略了像AIC和C-统计量这样的不当指标，并包含了对实际问题（如正性违规）的检查（权重诊断）。这个程序是专门为实现协变量平衡的目标而设计的。\n**结论：正确。**\n\n**C. 选择最近邻匹配法，其卡尺（calipers）的选择旨在最小化匹配样本中结果 $Y$ 的回归模型的交叉验证预测误差。迭代卡尺宽度和匹配比例，直到预测 $Y$ 的样本外均方误差最小化，然后使用匹配后的数据估计处理效应。**\n这个策略存在根本性缺陷，因为它使用结果变量 $Y$ 来调整倾向性得分应用（匹配）的参数。观察性研究的“设计阶段”，包括构建倾向性得分模型并用其进行匹配或加权，应该在对结果不知情的情况下进行。使用结果来优化设计可能导致偏倚、无效的统计推断，并且实质上是“p值操纵”或调整分析以找到期望的结果。匹配的目标是平衡协变量，这必须直接评估，而不是通过像结果预测准确性这样的代理指标。\n**结论：错误。**\n\n**D. 拟合一个用于 $e(\\mathbf{X})$ 的逻辑回归模型，并迭代地添加协变量，直到Hosmer–Lemeshow拟合优度检验的p值大于0.05。以此作为停止规则，并假设一个校准良好的处理模型能确保协变量平衡，然后进行IPTW。**\nHosmer-Lemeshow检验评估的是模型预测概率的校准度，即一个组内的平均预测概率是否与该组中观察到的事件比例相符。虽然与模型拟合有关，但它不是协变量在处理组之间平衡的直接或充分的度量。一个模型可以校准良好，但仍然无法平衡特定的、重要的协变量矩或交互作用。“良好校准*确保*平衡”的假设是不正确的。通过SMD直接评估平衡才是必需的诊断方法。\n**结论：错误。**\n\n**E. 通过纳入效应的强基线后中介变量（在处理开始后测量且受 $T$ 影响的变量）来扩展倾向性得分模型，以改善处理组和未处理组之间的分离度，迭代直到C-统计量超过0.9；然后估计IPTW。**\n这个选项包含两个截然不同的、致命的错误。首先，它主张在倾向性得分模型中包含处理后变量（中介变量）。这违反了时序性，并通过调整因果路径上的变量来导致对总处理效应的偏倚估计。其次，它旨在将C-统计量最大化到超过0.9。这表明组间存在严重的分离，违反了正性假设，使得找到可比较的个体变得不可能，从而使因果估计不可靠或无意义。\n**结论：错误。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在实践中，我们常会遇到一些具有极端倾向性得分（非常接近$0$或$1$）的个体，这可能导致逆概率加权估计的方差过大。虽然通过“修剪”（Trimming）这些个体可以提高估计的稳定性，但这一操作会改变我们研究的目标人群和因果估计量。此练习通过一个具体的例子，揭示了修剪如何将分析从全体平均处理效应（ATE）转移到重叠子集上的效应，并强调了透明报告这一过程的重要性。",
            "id": "4943099",
            "problem": "一项观察性队列研究评估了二元处理 $A \\in \\{0,1\\}$ 对6个月时的连续结局 $Y$ 的影响。令 $\\mathbf{X}$ 表示一个处理前协变量的向量，并定义倾向性得分 $e(\\mathbf{X}) = \\Pr(A=1 \\mid \\mathbf{X})$。假设满足稳定单位处理值假设（SUTVA）、一致性、条件可交换性 $(Y^{1}, Y^{0}) \\perp A \\mid \\mathbf{X}$ 以及在 $\\mathbf{X}$ 的支撑集上的正值性。研究者估计了 $\\hat{e}(\\mathbf{X})$，并决定通过丢弃所有满足 $\\hat{e}(\\mathbf{X})  a$ 或 $\\hat{e}(\\mathbf{X}) > 1-a$ 的单位来修剪具有极端估计倾向性得分的观测值，其中 $a = 0.05$。假设为了推断估计量的目的，$\\hat{e}(\\mathbf{X}) \\approx e(\\mathbf{X})$。\n\n考虑一个简单的协变量结构，其中 $\\mathbf{X}$ 中包含一个二元协变量 $G \\in \\{0,1\\}$，满足 $\\Pr(G=1) = 0.20$ 和 $\\Pr(G=0) = 0.80$。在总体中，当 $G=1$ 时，倾向性得分满足 $e(\\mathbf{X}) = 0.98$；当 $G=0$ 时，倾向性得分满足 $e(\\mathbf{X}) = 0.50$。令 $S = \\{\\mathbf{x} : a \\le e(\\mathbf{x}) \\le 1-a\\}$ 表示在阈值 $a = 0.05$ 处进行修剪所引出的重叠集。\n\n仅使用上述核心定义和条件期望的性质，推断修剪如何改变目标总体和因果估计量。然后选择一个选项，该选项最准确地描述了此设置中修剪后的因果估计量，并指明了为透明地传达修剪后的估计量而应报告的关键要素。\n\nA. 在 $a=0.05$ 处进行修剪后，因果估计量变为 $E[Y^{1} - Y^{0} \\mid \\mathbf{X} \\in S]$，在此设置中，这简化为 $E[Y^{1} - Y^{0} \\mid G=0]$，因为所有 $G=1$ 的单位都被排除了（$0.98 > 0.95$）。透明的报告应包括修剪阈值 $a$、 $S$ 的定义、总体上和按 $A$ 分组的修剪比例、修剪前后的协变量平衡，以及一种解释，即该效应可推广到重叠子总体 $S$ 而非整个总体。\n\nB. 修剪不改变估计量；它仍然是针对整个总体的 $E[Y^{1} - Y^{0}]$。因为修剪主要减少由极端权重引起的方差，所以报告点估计及其95%置信区间就足够了。\n\nC. 修剪将估计量改变为处理组的平均处理效应 $E[Y^{1} - Y^{0} \\mid A=1]$，因为倾向性得分 $e(\\mathbf{X})$ 接近1的单位被保留了。透明性要求报告所有协变量比较的p值，并声明混杂已被消除。\n\nD. 修剪后的估计量是 $E[Y^{1} - Y^{0} \\mid e(\\mathbf{X}) > 0.95]$（高倾向性分组），因为信息量最大的单位是那些处理几近确定的单位。报告应仅包括总体的修剪比例和修剪后的样本量。",
            "solution": "用户希望我验证问题陈述，如果有效，则提供详细的解决方案并评估给定的选项。\n\n### 问题验证\n\n**第1步：提取给定信息**\n\n*   **研究设计**：观察性队列研究。\n*   **处理**：二元，$A \\in \\{0,1\\}$。\n*   **结局**：连续，$Y$，在6个月时测量。\n*   **协变量**：一个处理前协变量的向量，$\\mathbf{X}$。\n*   **倾向性得分定义**：$e(\\mathbf{X}) = \\Pr(A=1 \\mid \\mathbf{X})$。\n*   **假设**：\n    1.  稳定单位处理值假设（SUTVA）。\n    2.  一致性：$Y = Y^A$。\n    3.  条件可交换性：$(Y^{1}, Y^{0}) \\perp A \\mid \\mathbf{X}$。\n    4.  正值性：对于 $\\mathbf{X}$ 支撑集中的所有 $\\mathbf{x}$，$0  e(\\mathbf{x})  1$。\n*   **步骤**：研究者估计倾向性得分 $\\hat{e}(\\mathbf{X})$，并进行修剪。\n*   **修剪规则**：丢弃所有满足 $\\hat{e}(\\mathbf{X})  a$ 或 $\\hat{e}(\\mathbf{X}) > 1-a$ 的单位。\n*   **修剪阈值**：$a = 0.05$。\n*   **用于推理的近似**：$\\hat{e}(\\mathbf{X}) \\approx e(\\mathbf{X})$。\n*   **特定协变量结构**：\n    *   $\\mathbf{X}$ 中包含一个二元协变量 $G \\in \\{0,1\\}$。\n    *   $\\Pr(G=1) = 0.20$。\n    *   $\\Pr(G=0) = 0.80$。\n*   **总体倾向性得分**：\n    *   当 $G=1$ 时，$e(\\mathbf{X}) = 0.98$。\n    *   当 $G=0$ 时，$e(\\mathbf{X}) = 0.50$。\n*   **重叠集定义**：$S = \\{\\mathbf{x} : a \\le e(\\mathbf{x}) \\le 1-a\\}$。\n*   **问题**：推断修剪如何改变目标总体和估计量，然后选择最准确地描述修剪后的因果估计量并指明透明报告要求的选项。\n\n**第2步：使用提取的给定信息进行验证**\n\n1.  **科学依据**：该问题在因果推断和倾向性得分方法的理论中有很好的基础。假设（SUTVA、可交换性、正值性）是识别因果效应的标准假设。修剪是实践中常用但有争议的一种技术。使用具有二元协变量的简化总体结构是说明统计程序后果的标准教学工具。\n2.  **定义明确**：问题定义明确。它要求对特定统计程序（修剪）对推断目标（估计量）和报告标准的影响进行概念性分析。根据所提供的信息，可以遵循一条清晰且唯一的推理路线。\n3.  **客观性**：问题以精确、客观和数学的语言陈述。没有主观或基于意见的陈述。\n4.  **未发现缺陷**：该问题没有违反基本原则，对于当前的概念性任务没有规定不足，不包含矛盾，并且并非微不足道。近似 $\\hat{e}(\\mathbf{X}) \\approx e(\\mathbf{X})$ 被明确说明为一种推理手段，这是为了理解概念影响的合理简化。\n\n**第3步：结论和行动**\n\n问题陈述是**有效的**。可以继续进行分析。\n\n### 解决方案推导\n\n研究的最初目标是估计总体平均处理效应（ATE），其定义为 $E[Y^1 - Y^0]$。该估计量代表了在由协变量 $\\mathbf{X}$ 的分布所定义的整个总体上，处理 $A$ 的平均因果效应。\n\n研究者根据估计的倾向性得分应用修剪程序。修剪规则是丢弃倾向性得分满足 $\\hat{e}(\\mathbf{X})  a$ 或 $\\hat{e}(\\mathbf{X}) > 1-a$ 的受试者。当 $a=0.05$ 时，这意味着满足 $\\hat{e}(\\mathbf{X})  0.05$ 或 $\\hat{e}(\\mathbf{X}) > 0.95$ 的受试者将从分析中移除。后续分析仅在协变量值 $\\mathbf{x}$ 属于集合 $S = \\{\\mathbf{x} : 0.05 \\le e(\\mathbf{x}) \\le 0.95\\}$ 的子总体上进行。近似 $\\hat{e}(\\mathbf{X}) \\approx e(\\mathbf{X})$ 允许我们使用真实的倾向性得分 $e(\\mathbf{X})$ 来确定哪些受试者被修剪。\n\n让我们将此规则应用于指定的总体结构：\n1.  对于协变量 $G=1$ 的子总体，倾向性得分为 $e(\\mathbf{X}) = 0.98$。由于 $0.98 > 0.95$，该子总体中的所有个体都将从数据集中被修剪掉。\n2.  对于协变量 $G=0$ 的子总体，倾向性得分为 $e(\\mathbf{X}) = 0.50$。由于 $0.05 \\le 0.50 \\le 0.95$，该子总体中的所有个体都将保留用于分析。\n\n这意味着原始总体（由 $G=1$ (20%) 和 $G=0$ (80%) 的个体混合而成）被修改了。现在的分析*完全*局限于 $G=0$ 的个体组成的子总体。\n\n可以从这个修剪后的样本中估计的因果估计量是*在这个新的、受限的总体内*的平均处理效应。原始估计量是针对整个总体的ATE。新的估计量是针对由 $\\mathbf{X} \\in S$ 定义的子总体的ATE。在我们的特定案例中，条件 $\\mathbf{X} \\in S$ 完全等同于条件 $G=0$。\n\n因此，修剪后的估计量是：\n$$ E[Y^1 - Y^0 \\mid \\mathbf{X} \\in S] = E[Y^1 - Y^0 \\mid G=0] $$\n\n这个新的估计量通常不等于原始的、针对整个总体的ATE，$E[Y^1 - Y^0]$。只有在一个强的、无法检验的假设下，即 $G=0$ 子总体和 $G=1$ 子总体中的平均处理效应相同（即 $E[Y^1 - Y^0 \\mid G=0] = E[Y^1 - Y^0 \\mid G=1]$），两者才会相等。这种效应同质性的假设没有给出，也不能被假定。\n\n因此，修剪改变了研究问题。分析不再回答“在整个总体中的效应是什么？”，而是回答“在 $G=0$ 的个体组成的子总体中的效应是什么？”这是一个关键的区别。结果的透明报告必须承认目标估计量和目标总体的这种变化。\n\n在这种情况下，良好的报告实践应包括：\n*   使用的确切修剪规则（$a$ 的值）。\n*   由此产生的分析总体（$S$）的定义。\n*   被修剪的受试者数量和比例，最好按处理组细分。\n*   修剪前后协变量分布的比较。在本案例中，$G$ 的分布从 $\\Pr(G=1)=0.20$ 变为 $\\Pr(G=1)=0$。这是一个重大变化，必须报告。\n*   明确声明估计的效应适用于其倾向性得分具有良好‘重叠’的子总体，并且不能保证推广到原始的整个总体。\n\n### 逐项分析选项\n\n**A. 在 $a=0.05$ 处进行修剪后，因果估计量变为 $E[Y^{1} - Y^{0} \\mid \\mathbf{X} \\in S]$，在此设置中，这简化为 $E[Y^{1} - Y^{0} \\mid G=0]$，因为所有 $G=1$ 的单位都被排除了（$0.98 > 0.95$）。透明的报告应包括修剪阈值 $a$、 $S$ 的定义、总体上和按 $A$ 分组的修剪比例、修剪前后的协变量平衡，以及一种解释，即该效应可推广到重叠子总体 $S$ 而非整个总体。**\n\n*   此选项正确地指出修剪将估计量更改为以重叠集 $S$ 为条件的估计量。\n*   它正确地将修剪规则应用于给定的总体结构，推断出 $G=1$ 的子总体被完全移除，新的估计量特定于 $G=0$ 的子总体。\n*   它提供了一个全面而准确的透明报告所需元素列表，包括可推广性的变化。\n*   **结论：正确。**\n\n**B. 修剪不改变估计量；它仍然是针对整个总体的 $E[Y^{1} - Y^{0}]$。因为修剪主要减少由极端权重引起的方差，所以报告点估计及其95%置信区间就足够了。**\n\n*   声称修剪不改变估计量是根本错误的，如上所示。分析是在原始总体的不同、非随机子集上进行的。\n*   “修剪主要用于减少方差”的理由忽略了其对推断目标和可推广性的关键影响。\n*   仅报告估计值和置信区间就足够的建议，助长了不透明和可能产生误导的科学。\n*   **结论：不正确。**\n\n**C. 修剪将估计量改变为处理组的平均处理效应 $E[Y^{1} - Y^{0} \\mid A=1]$，因为倾向性得分 $e(\\mathbf{X})$ 接近1的单位被保留了。透明性要求报告所有协变量比较的p值，并声明混杂已被消除。**\n\n*   声称估计量变为处理组的平均处理效应（ATT）是不正确的。新的估计量是协变量值在 $S$ 中的子总体的ATE。\n*   “因为倾向性得分 $e(\\mathbf{X})$ 接近1的单位被保留了”的推理与问题陈述的事实不符。规则明确*丢弃*了 $e(\\mathbf{X}) > 0.95$ 的单位，其中包括那些 $e(\\mathbf{X})$ 接近1的单位。\n*   “声明混杂已被消除”的报告建议是一种夸大。倾向性得分方法旨在控制*可观测*的混杂，而不是消除所有混杂（这将包括未观测的混杂）。\n*   **结论：不正确。**\n\n**D. 修剪后的估计量是 $E[Y^{1} - Y^{0} \\mid e(\\mathbf{X}) > 0.95]$（高倾向性分组），因为信息量最大的单位是那些处理几近确定的单位。报告应仅包括总体的修剪比例和修剪后的样本量。**\n\n*   此选项完全错误地描述了修剪过程。$e(\\mathbf{X}) > 0.95$ 的组是*被移除*的组，而不是被研究的组。\n*   其理由存在缺陷。具有极端倾向性得分的单位通常对估计构成问题（导致逆概率加权估计量的高方差），因为在相反的处理组中缺乏可比较的单位。\n*   建议的报告标准过于简化，不足以传达目标总体和估计量的变化。\n*   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}