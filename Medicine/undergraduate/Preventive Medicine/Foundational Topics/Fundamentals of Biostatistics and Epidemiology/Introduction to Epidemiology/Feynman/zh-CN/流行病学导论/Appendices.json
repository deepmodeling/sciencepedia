{
    "hands_on_practices": [
        {
            "introduction": "流行病学研究的核心是量化疾病的发生频率。发病率是衡量新发病例出现速度的关键指标。在真实的队列研究中，受试者常常在不同时间点加入（交错入组），并因各种原因在研究结束前退出（删失）。本练习将指导你如何在这种动态队列中，通过精确计算人时（person-time），来获得一个无偏的发病率估计值，这是流行病学的一项基本功。",
            "id": "4541669",
            "problem": "一项队列研究旨在评估在一个从$0$到$24$个月的固定日历时间窗口内，成年志愿者中某种特定传染病首次发作的发生情况。研究对象的入组在该时间窗口内是交错进行的。每位参与者从其入组开始被认为处于风险之中，直到以下最早发生的时间点为止：首次事件、失访或研究管理性终止（$24$个月）。假设没有参与者经历超过一次事件，并且不存在竞争风险。\n\n您获得了以下每位参与者以月为单位的个人日历入组时间和退出时间，并注明了每个人的退出类型：\n\n- 参与者$1$：入组时间$0$，退出时间$6$（事件）。\n- 参与者$2$：入组时间$0$，退出时间$24$（管理性删失）。\n- 参与者$3$：入组时间$4$，退出时间$17$（事件）。\n- 参与者$4$：入组时间$5$，退出时间$14$（失访）。\n- 参与者$5$：入组时间$8$，退出时间$23$（事件）。\n- 参与者$6$：入组时间$10$，退出时间$24$（管理性删失）。\n- 参与者$7$：入组时间$12$，退出时间$20$（事件）。\n- 参与者$8$：入组时间$15$，退出时间$16$（事件）。\n- 参与者$9$：入组时间$18$，退出时间$24$（管理性删失）。\n- 参与者$10$：入组时间$20$，退出时间$22$（失访）。\n\n任务：\n1. 计算总风险人时（使用$12$个月等于$1$年的换算关系，将月份转换为年份）。\n2. 使用总人时，计算研究窗口内首次事件的发生率。\n\n科学真实性假设：失访是由于搬迁或联系信息变更引起的，与疾病过程无关。请明确陈述为使基于人时的发生率无偏所需满足的关于删失的假设，然后在该假设下进行计算。\n\n将发生率以“病例/人年”为单位表示，并将最终数值答案四舍五入至三位有效数字。",
            "solution": "该队列在一个固定的日历时间窗口内被观察，具有交错入组以及因研究管理性终止和失访导致的右删失。根据核心的流行病学定义，人时是所有个体处于风险中的持续时间的总和，而发生率是新发事件数与总风险人时之比。\n\n设$t_{i}^{\\text{entry}}$表示参与者$i$的入组日历时间（以月为单位），$t_{i}^{\\text{exit}}$表示参与者$i$的退出日历时间（以月为单位），其中退出发生在首次事件、失访或研究管理性终止的最早时间点。参与者$i$的人时（以月为单位）为\n$$\n\\Delta t_{i} = t_{i}^{\\text{exit}} - t_{i}^{\\text{entry}}.\n$$\n为将人时以年表示，我们将其除以$12$，因为$12$个月等于$1$年。设$\\delta_{i}$为事件指示变量，如果退出是由于事件，则$\\delta_{i} = 1$，否则$\\delta_{i} = 0$。总事件数是$\\sum_{i=1}^{10} \\delta_{i}$，总人时（以年为单位）是$\\sum_{i=1}^{10} \\Delta t_{i} / 12$。\n\n在计算之前，我们陈述关于删失的必要假设：我们假设独立或非信息性删失。具体来说，在给定删失时间点之前观察到的历史信息的条件下，删失后事件的风险率与那些仍在观察中的个体的风险率相同。在本研究背景下，这对应于因搬迁或失联造成的删失与潜在的疾病过程无关，因此右删失不会使基于人时的发生率产生偏倚。\n\n我们现在计算每个$\\Delta t_{i}$（以月为单位）：\n- 参与者$1$：$\\Delta t_{1} = 6 - 0 = 6$。\n- 参与者$2$：$\\Delta t_{2} = 24 - 0 = 24$。\n- 参与者$3$：$\\Delta t_{3} = 17 - 4 = 13$。\n- 参与者$4$：$\\Delta t_{4} = 14 - 5 = 9$。\n- 参与者$5$：$\\Delta t_{5} = 23 - 8 = 15$。\n- 参与者$6$：$\\Delta t_{6} = 24 - 10 = 14$。\n- 参与者$7$：$\\Delta t_{7} = 20 - 12 = 8$。\n- 参与者$8$：$\\Delta t_{8} = 16 - 15 = 1$。\n- 参与者$9$：$\\Delta t_{9} = 24 - 18 = 6$。\n- 参与者$10$：$\\Delta t_{10} = 22 - 20 = 2$。\n\n人时总和（以月为单位）：\n$$\n\\sum_{i=1}^{10} \\Delta t_{i} = 6 + 24 + 13 + 9 + 15 + 14 + 8 + 1 + 6 + 2 = 98 \\text{ months}.\n$$\n转换为年：\n$$\n\\text{Total person-time (years)} = \\frac{98}{12} = 8.\\overline{16} \\text{ years}.\n$$\n\n统计事件数：\n- 参与者$1, 3, 5, 7, 8$发生了事件，得出$\\sum_{i=1}^{10} \\delta_{i} = 5$。\n\n根据定义，发生率（病例/人年）为\n$$\n\\text{Incidence rate} = \\frac{\\sum_{i=1}^{10} \\delta_{i}}{\\sum_{i=1}^{10} \\Delta t_{i}/12} = \\frac{5}{98/12} = \\frac{60}{98} = \\frac{30}{49}.\n$$\n计算小数值以便进行四舍五入：\n$$\n\\frac{30}{49} \\approx 0.6122448979\\ldots\n$$\n四舍五入至三位有效数字，发生率为$0.612$ 病例/人年。\n\n在所述的独立删失（相对于事件风险而言为非信息性）的假设下，这个基于人时的发生率是观察到的风险时间内平均事件发生率的无偏估计。",
            "answer": "$$\\boxed{0.612}$$"
        },
        {
            "introduction": "在量化了疾病的发生频率后，下一步通常是比较暴露组与非暴露组的疾病风险，以评估两者之间是否存在关联。本练习将重点介绍优势比（odds ratio, $OR$）的计算，它是在病例对照研究和队列研究中广泛使用的关联强度指标。通过这个练习，你不仅会计算$OR$，还将深入探讨它与风险比（risk ratio, $RR$）之间的关键区别，以及在何种条件下两者可以近似，这对于深刻理解研究结果的含义至关重要。",
            "id": "4541737",
            "problem": "对一个制造业工人队列进行了为期 $1$ 年的随访，以研究溶剂暴露与新发接触性皮炎之间的关联。数据按暴露和结局状态汇总在一个 $2 \\times 2$ 表格中。在暴露组中，有 $n_{1} = 560$ 名工人，随访期间有 $a = 84$ 例新发皮炎病例。在非暴露组中，有 $n_{0} = 900$ 名工人，随访期间有 $c = 45$ 例新发病例。仅使用风险、比值、风险比和比值比的核心定义，根据这些数据计算暴露与新发皮炎关联的粗比值比。然后，根据第一性原理，阐述比值比近似于风险比的数学条件，并解释为何即使在没有混杂或效应修饰的情况下，比值比的不可坍缩性也会使边际关联与条件关联的解释变得复杂。\n\n将您的最终数值答案报告为粗比值比，表示为一个纯数字，并四舍五入到四位有效数字。最终数值答案中不要包含任何单位或符号。",
            "solution": "分析过程首先将所提供的数据整理成一个标准的 $2 \\times 2$ 列联表，然后计算粗比值比，最后解决关于比值比与风险比之间关系以及不可坍缩性属性的理论问题。\n\n数据可汇总为以下 $2 \\times 2$ 表格，其中行代表暴露状态，列代表结局状态（皮炎）。\n\n| | 皮炎（病例）| 无皮炎（非病例）| 总计 |\n| :--- | :---: | :---: | :---: |\n| **暴露** | $a=84$ | $b$ | $n_1=560$ |\n| **非暴露**| $c=45$ | $d$ | $n_0=900$ |\n\n各组中非病例的数量可以从给定的总数计算得出：\n无皮炎的暴露工人数：$b = n_1 - a = 560 - 84 = 476$。\n无皮炎的非暴露工人数：$d = n_0 - c = 900 - 45 = 855$。\n\n完整的表格如下：\n| | 皮炎（病例）| 无皮炎（非病例）| 总计 |\n| :--- | :---: | :---: | :---: |\n| **暴露** | $a=84$ | $b=476$ | $n_1=560$ |\n| **非暴露**| $c=45$ | $d=855$ | $n_0=900$ |\n\n**1. 粗比值比（$OR$）的计算**\n\n发病比值定义为发病人数与未发病人数之比。\n\n暴露组中患皮炎的比值（$Odds_1$）为：\n$$ Odds_1 = \\frac{\\text{暴露组病例数}}{\\text{暴露组非病例数}} = \\frac{a}{b} = \\frac{84}{476} $$\n\n非暴露组中患皮炎的比值（$Odds_0$）为：\n$$ Odds_0 = \\frac{\\text{非暴露组病例数}}{\\text{非暴露组非病例数}} = \\frac{c}{d} = \\frac{45}{855} $$\n\n比值比（$OR$）是暴露组发病比值与非暴露组发病比值之比。\n$$ OR = \\frac{Odds_1}{Odds_0} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n\n代入数据中的数值：\n$$ OR = \\frac{84 \\times 855}{476 \\times 45} = \\frac{71820}{21420} \\approx 3.352941... $$\n\n按要求四舍五入到四位有效数字，粗比值比为 $3.353$。\n\n**2. $OR \\approx RR$ 的数学条件**\n\n风险（或累积发病率）是在指定时间段内发生疾病的概率。\n暴露组的风险（$R_1$）为：\n$$ R_1 = \\frac{a}{a+b} $$\n非暴露组的风险（$R_0$）为：\n$$ R_0 = \\frac{c}{c+d} $$\n风险比（$RR$）是这两个风险的比值：\n$$ RR = \\frac{R_1}{R_0} = \\frac{a/(a+b)}{c/(c+d)} $$\n任何组的比值与风险之间的关系是 $Odds = \\frac{Risk}{1-Risk}$。\n因此，我们可以用风险来表示比值比：\n$$ OR = \\frac{Odds_1}{Odds_0} = \\frac{R_1/(1-R_1)}{R_0/(1-R_0)} = \\left(\\frac{R_1}{R_0}\\right) \\left(\\frac{1-R_0}{1-R_1}\\right) = RR \\times \\left(\\frac{1-R_0}{1-R_1}\\right) $$\n要使比值比（$OR$）近似于风险比（$RR$），校正因子 $\\frac{1-R_0}{1-R_1}$ 必须约等于 $1$。\n$$ \\frac{1-R_0}{1-R_1} \\approx 1 $$\n当疾病罕见时，此条件成立。具体来说，如果疾病在非暴露组和暴露组中的风险都非常小，即 $R_0 \\ll 1$ 且 $R_1 \\ll 1$。在这种情况下，分母 $(1-R_0)$ 和 $(1-R_1)$ 都接近 $1$，使得它们的比值也接近 $1$。\n$$ \\text{若 } R_0 \\to 0 \\text{ 且 } R_1 \\to 0, \\text{ 则 } (1-R_0) \\to 1 \\text{ 且 } (1-R_1) \\to 1. $$\n$$ \\implies \\frac{1-R_0}{1-R_1} \\to \\frac{1}{1} = 1 $$\n因此，比值比近似于风险比的数学条件是，在所有被比较的组中，结局都是罕见的。这通常被称为“罕见病假设”。\n\n**3. 比值比的不可坍缩性**\n\n可坍缩性是指关联度量的一种属性，即其粗略（边际）值是分层特异性（条件）值的加权平均。风险比和风险差是可坍缩的。而比值比则不是，它是不可坍缩的。\n\n不可坍缩性意味着即使在完全没有混杂的情况下，边际比值比也不是条件比值比的简单加权平均。当一个粗略的关联度量与一个共同的条件度量不同，并且这种差异是由于分层变量同时与暴露和结局相关时，就存在混杂。\n\n对于比值比，即使分层变量不是混杂因素（即，在结局的各水平内，它与暴露不相关），粗 $OR$ 与共同的分层特异性 $OR$ 之间也可能出现差异。这是 $OR$ 的一个纯数学属性。通常，如果分层特异性比值比在各分层中恒定（即无效应修饰）且大于 $1$，那么边际（粗）比值比将向无效值 $1$ 衰减。也就是说，$1 \\le OR_{crude}  OR_{conditional}$。相反，如果条件比值比小于 $1$，则粗比值比将更大（更接近 $1$），即 $OR_{conditional}  OR_{crude} \\le 1$。只有当关联为空（$OR=1$）或分层变量与结局不相关时，粗 $OR$ 和条件 $OR$ 才会相等。\n\n这种不可坍缩性使解释复杂化，因为它将混杂的概念与粗略估计和调整后估计之间的差异分离开来。当使用风险比时，如果 $RR_{crude} \\neq RR_{adjusted}$，可以断定存在混杂。而当使用比值比时，$OR_{crude} \\neq OR_{adjusted}$ 本身并不意味着存在混杂；这种差异可能仅仅是由于不可坍缩性这一属性造成的。这意味着，通过比值比测量的关联强度，仅仅因为对一个非混杂变量进行调整，其大小似乎就发生了变化。因此，当用比值比来衡量时，边际（人群平均）效应和条件（分层特异性）效应是根本不同的参数，这在决定是报告粗略估计还是调整后估计时，可能会导致解释上的挑战。",
            "answer": "$$\\boxed{3.353}$$"
        },
        {
            "introduction": "在观察到暴露与疾病之间的关联后，我们必须警惕是否存在第三个因素——即混杂因素——扭曲了这种关系。本练习将介绍分层分析和Mantel-Haenszel方法，这是一种控制混杂的经典而强大的工具。通过计算合并优势比，你将学会如何获得一个调整后的关联估计值，并亲身体验它与未调整的粗略估计值有何不同。",
            "id": "4541790",
            "problem": "一项预防医学领域的分层病例对照研究旨在调查职业性溶剂暴露（记为 $E$，暴露与非暴露）与慢性肾脏病（记为 $D$，病例与非病例）之间的关联。年龄被视为一个潜在的混杂因素，并据此分为两个层：第 $1$ 层为年龄 $ 50$ 岁的参与者，第 $2$ 层为年龄 $\\geq 50$ 岁的参与者。观察到以下数据。\n\n对于第 $1$ 层（年龄 $ 50$ 岁）：\n- 暴露组中，有 $54$ 例病例和 $246$ 例非病例。\n- 非暴露组中，有 $30$ 例病例和 $270$ 例非病例。\n\n对于第 $2$ 层（年龄 $\\geq 50$ 岁）：\n- 暴露组中，有 $120$ 例病例和 $180$ 例非病例。\n- 非暴露组中，有 $80$ 例病例和 $240$ 例非病例。\n\n一项独立的多变量逻辑回归（logistic regression）分析将年龄分层作为协变量，报告了 $E$ 与 $D$ 之间关联的调整后比值比（odds ratio (OR)）为 $1.99$。\n\n请仅使用比值、比值比的基本定义，以及分层分析和跨层适当合并的逻辑，计算跨越两个年龄分层的 Mantel-Haenszel (MH) 合并比值比。然后，通过与粗略估计值和基于回归的调整值进行比较，使用此合并估计值来评估年龄是否混杂了 $E$ 与 $D$ 之间的粗略关联。将你最终的 Mantel-Haenszel 合并比值比四舍五入到四位有效数字，并以小数形式表示。仅报告 Mantel-Haenszel 合并比值比作为你的最终答案。",
            "solution": "问题要求计算按年龄分层的职业性溶剂暴露 ($E$) 与慢性肾脏病 ($D$) 之间关联的 Mantel-Haenszel (MH) 合并比值比 ($OR_{MH}$)。分析将首先构建所提供的数据，然后应用 Mantel-Haenszel 公式。\n\n让我们用一个标准的 $2 \\times 2$ 列联表来表示每个分层 $i$ 的数据，其中 $i=1$ 对应年龄组 $ 50$ 岁，$i=2$ 对应年龄组 $\\geq 50$ 岁。表格单元定义如下：\n- $a_i$：暴露组 ($E+$) 中的病例数（患病，$D+$）。\n- $b_i$：暴露组 ($E+$) 中的非病例数（未患病，$D-$）。\n- $c_i$：非暴露组 ($E-$) 中的病例数（患病，$D+$）。\n- $d_i$：非暴露组 ($E-$) 中的非病例数（未患病，$D-$）。\n第 $i$ 层的参与者总数为 $N_i = a_i + b_i + c_i + d_i$。\n\n根据题目陈述，我们可以填充这两个分层的表格。\n\n对于第 $1$ 层（年龄 $ 50$ 岁）：\n- $a_1 = 54$（暴露组病例）\n- $b_1 = 246$（暴露组非病例）\n- $c_1 = 30$（非暴露组病例）\n- $d_1 = 270$（非暴露组非病例）\n该层的参与者总数为 $N_1 = 54 + 246 + 30 + 270 = 600$。\n\n对于第 $2$ 层（年龄 $\\geq 50$ 岁）：\n- $a_2 = 120$（暴露组病例）\n- $b_2 = 180$（暴露组非病例）\n- $c_2 = 80$（非暴露组病例）\n- $d_2 = 240$（非暴露组非病例）\n该层的参与者总数为 $N_2 = 120 + 180 + 80 + 240 = 620$。\n\n跨越 $k$ 个分层的 Mantel-Haenszel 合并比值比公式为：\n$$ OR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{N_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{N_i}} $$\n在这个问题中，我们有 $k=2$ 个分层。我们将分别计算分子和分母的各项。\n\n分子是每个分层的加权交叉乘积 $\\frac{a_i d_i}{N_i}$ 的和：\n对于第 $1$ 层：\n$$ \\frac{a_1 d_1}{N_1} = \\frac{54 \\times 270}{600} = \\frac{14580}{600} = 24.3 $$\n对于第 $2$ 层：\n$$ \\frac{a_2 d_2}{N_2} = \\frac{120 \\times 240}{620} = \\frac{28800}{620} = \\frac{1440}{31} $$\n分子的和为：\n$$ \\sum_{i=1}^{2} \\frac{a_i d_i}{N_i} = 24.3 + \\frac{1440}{31} = \\frac{243}{10} + \\frac{1440}{31} = \\frac{243 \\times 31 + 1440 \\times 10}{310} = \\frac{7533 + 14400}{310} = \\frac{21933}{310} $$\n\n分母是每个分层的加权交叉乘积 $\\frac{b_i c_i}{N_i}$ 的和：\n对于第 $1$ 层：\n$$ \\frac{b_1 c_1}{N_1} = \\frac{246 \\times 30}{600} = \\frac{7380}{600} = 12.3 $$\n对于第 $2$ 层：\n$$ \\frac{b_2 c_2}{N_2} = \\frac{180 \\times 80}{620} = \\frac{14400}{620} = \\frac{720}{31} $$\n分母的和为：\n$$ \\sum_{i=1}^{2} \\frac{b_i c_i}{N_i} = 12.3 + \\frac{720}{31} = \\frac{123}{10} + \\frac{720}{31} = \\frac{123 \\times 31 + 720 \\times 10}{310} = \\frac{3813 + 7200}{310} = \\frac{11013}{310} $$\n\n现在，我们可以计算 Mantel-Haenszel 合并比值比：\n$$ OR_{MH} = \\frac{\\frac{21933}{310}}{\\frac{11013}{310}} = \\frac{21933}{11013} \\approx 1.991555434... $$\n\n问题要求将最终答案四舍五入到四位有效数字。计算值为 $1.991555...$。第五位有效数字是 $5$，因此我们将第四位数字向上取整。\n$$ OR_{MH} \\approx 1.992 $$\n\n为了评估是否存在混杂，按照题目的指示，我们将这个调整后的比值比与粗略比值比进行比较。首先，我们必须通过将各分层合并成一个单一的 $2 \\times 2$ 表格来计算粗略比值比：\n- 暴露组总病例数：$a_{crude} = a_1 + a_2 = 54 + 120 = 174$\n- 暴露组总非病例数：$b_{crude} = b_1 + b_2 = 246 + 180 = 426$\n- 非暴露组总病例数：$c_{crude} = c_1 + c_2 = 30 + 80 = 110$\n- 非暴露组总非病例数：$d_{crude} = d_1 + d_2 = 270 + 240 = 510$\n\n粗略比值比为：\n$$ OR_{crude} = \\frac{a_{crude} \\times d_{crude}}{b_{crude} \\times c_{crude}} = \\frac{174 \\times 510}{426 \\times 110} = \\frac{88740}{46860} \\approx 1.894 $$\n调整后的 Mantel-Haenszel 比值比 ($OR_{MH} \\approx 1.992$) 与粗略比值比 ($OR_{crude} \\approx 1.894$) 不同。各分层的特定比值比为 $OR_1 = \\frac{54 \\times 270}{246 \\times 30} = \\frac{14580}{7380} \\approx 1.976$ 和 $OR_2 = \\frac{120 \\times 240}{180 \\times 80} = \\frac{28800}{14400} = 2.0$。这些比值比相对同质，并且都与粗略估计值不同，表明年龄是一个混杂因素。Mantel-Haenszel 估计值 ($1.992$) 提供了一个经年龄调整后的单一关联汇总度量，它与所报告的逻辑回归调整后 OR $1.99$ 非常接近，这加强了此调整估计值的有效性。粗略 OR 低估了关联的强度。\n\n最终要求的答案是 Mantel-Haenszel 合并比值比，四舍五入到四位有效数字。",
            "answer": "$$\n\\boxed{1.992}\n$$"
        }
    ]
}