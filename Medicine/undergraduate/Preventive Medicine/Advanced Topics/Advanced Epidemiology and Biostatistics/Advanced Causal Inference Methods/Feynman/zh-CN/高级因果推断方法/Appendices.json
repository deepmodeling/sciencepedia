{
    "hands_on_practices": [
        {
            "introduction": "在我们运用倾向性得分来估计因果效应之前，我们必须首先理解其基本属性：平衡协变量。本练习将通过一个仅包含单个二元混杂因素的简单清晰场景来展示这一原理。通过计算倾向性得分并检验分层后的平衡性，我们可以为该方法的有效性建立起坚实的直觉。",
            "id": "4501622",
            "problem": "一种预防性药物根据一个二元风险指标进行施用，其中治疗为 $T \\in \\{0,1\\}$，一个二元混杂因素为 $X \\in \\{0,1\\}$，代表高心血管风险（$X=1$）与较低风险（$X=0$）。假设临床医生倾向于为高风险患者提供治疗，因此条件治疗概率为 $P(T=1 \\mid X=1)=0.8$ 和 $P(T=1 \\mid X=0)=0.3$。倾向性得分（Propensity Score, PS）定义为 $e(X)=P(T=1 \\mid X)$。\n\n从倾向性得分的定义和条件概率法则出发，完成以下任务：\n\n1) 计算函数 $e(X)$ 在 $X=1$ 和 $X=0$ 时的值。\n\n2) 考虑基于已实现的倾向性得分值进行分层，分为两个层 $\\{e(X)=0.8\\}$ 和 $\\{e(X)=0.3\\}$。对于每个分层值 $s \\in \\{0.8,0.3\\}$，将在治疗组和未治疗组之间 $X$ 分布的层内绝对不平衡度定义为\n$$\nB(s) \\equiv \\left|P(X=1 \\mid T=1, e(X)=s) - P(X=1 \\mid T=0, e(X)=s)\\right|.\n$$\n\n3) 计算这些层中的最大绝对不平衡度，\n$$\nB_{\\max} \\equiv \\max\\{B(0.8),\\, B(0.3)\\}.\n$$\n\n将最终答案表示为一个实数。无需四舍五入。",
            "solution": "我们从核心定义开始。倾向性得分是在给定协变量的情况下接受治疗的条件概率，因此对于一个二元混杂因素 $X \\in \\{0,1\\}$，倾向性得分函数为\n$$\ne(X) = P(T=1 \\mid X).\n$$\n根据给定的条件治疗概率，我们立即得到\n$$\ne(1) = P(T=1 \\mid X=1) = 0.8, \\quad e(0) = P(T=1 \\mid X=0) = 0.3.\n$$\n\n接下来，我们研究按已实现的倾向性得分值进行的分层。$e(X)$ 的两个可能值是 $0.8$ 和 $0.3$，并且，由于 $e(X)$ 是 $X$ 的一个确定性函数，我们可以将每个层与相应的 $X$ 值对应起来：\n- 如果 $e(X) = 0.8$，那么必然有 $X=1$，因为 $e(1)=0.8$ 且 $e(0)=0.3 \\neq 0.8$。\n- 如果 $e(X) = 0.3$，那么必然有 $X=0$，因为 $e(0)=0.3$ 且 $e(1)=0.8 \\neq 0.3$。\n\n形式上，事件 $\\{e(X)=0.8\\}$ 和 $\\{X=1\\}$ 重合，事件 $\\{e(X)=0.3\\}$ 和 $\\{X=0\\}$ 重合。这意味着在层 $e(X)=0.8$ 内，协变量 $X$ 确定性地等于 $1$；而在层 $e(X)=0.3$ 内，协变量 $X$ 确定性地等于 $0$。\n\n我们现在为 $s \\in \\{0.8, 0.3\\}$ 计算层内绝对不平衡度 $B(s)$。根据定义，\n$$\nB(s) = \\left|P(X=1 \\mid T=1, e(X)=s) - P(X=1 \\mid T=0, e(X)=s)\\right|.\n$$\n\n考虑 $s=0.8$。因为 $e(X)=0.8$ 必然意味着 $X=1$，我们有\n$$\nP(X=1 \\mid T=1, e(X)=0.8) = 1, \\quad P(X=1 \\mid T=0, e(X)=0.8) = 1.\n$$\n因此，\n$$\nB(0.8) = |1 - 1| = 0.\n$$\n\n考虑 $s=0.3$。因为 $e(X)=0.3$ 必然意味着 $X=0$，我们有\n$$\nP(X=1 \\mid T=1, e(X)=0.3) = 0, \\quad P(X=1 \\mid T=0, e(X)=0.3) = 0.\n$$\n因此，\n$$\nB(0.3) = |0 - 0| = 0.\n$$\n\n最后，各层之间的最大绝对不平衡度为\n$$\nB_{\\max} = \\max\\{B(0.8), B(0.3)\\} = \\max\\{0, 0\\} = 0.\n$$\n\n换句话说，这验证了平衡性：在每个倾向性得分层内，$X$ 在治疗组和未治疗组中的分布是相同的。在这个具有不同倾向性得分值的离散、两水平案例中，各分层在 $X$ 方面是完全同质的，因此两个分层中的不平衡度指标均为零，其最大值也为零。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在理解了倾向性得分的概念之后，本练习将从理论转向应用。我们将探索一种最常用的倾向性得分应用方法：逆概率治疗加权（IPTW）。通过这个动手计算，你将学习如何创建一个“伪人群”，在这个人群中，治疗组和对照组在基线特征上是平衡的，从而可以无偏地估计平均治疗效应（ATE）。",
            "id": "4501672",
            "problem": "一项预防医学项目评估接受生活方式咨询干预是否能降低 $6$ 个月后测量的收缩压。对于每位参与者 $i$，设 $T_{i} \\in \\{0,1\\}$ 表示治疗分配（$1$ 表示干预，$0$ 表示其他），设 $Y_{i}$ 表示观察到的收缩压降低值（单位：毫米汞柱，mmHg），设 $X_{i}$ 表示影响治疗分配和结果的基线协变量。倾向性得分定义为 $e(X_{i}) = \\Pr(T_{i} = 1 \\mid X_{i})$。\n\n假设以下识别条件成立：一致性（也称为稳定单位治疗价值假设，SUTVA）、给定 $X$ 的条件下可交换性（即 $(Y^{1}, Y^{0}) \\perp T \\mid X$）以及正定性（$0  e(X)  1$ 几乎必然成立）。仅从这些定义和迭代期望定律出发，使用逆概率治疗加权（IPTW）推导平均治疗效应（ATE）的经验估计量，然后为以下包含 $4$ 名参与者的小型数据集计算其值。三元组 $(T_{i}, Y_{i}, e(X_{i}))$ 如下：\n- $(1, 5, 0.9)$，\n- $(0, 3, 0.2)$，\n- $(1, 4, 0.8)$，\n- $(0, 2, 0.1)$。\n\n为清楚起见，每个三元组中的第三个数字是个人倾向性得分 $e(X_{i})$。使用 Horvitz–Thompson 形式的 IPTW 估计量计算 ATE。\n\n用毫米汞柱（mmHg）表示最终数值。以精确形式（不要四舍五入）提供最终答案。",
            "solution": "首先将根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知信息\n- **领域：** 预防医学，高级因果推断方法。\n- **变量：**\n  - $T_{i} \\in \\{0,1\\}$：参与者 $i$ 的治疗分配（$1$ 表示干预，$0$ 表示对照）。\n  - $Y_{i}$：观察到的收缩压降低值（mmHg）。\n  - $X_{i}$：基线协变量。\n  - $Y^{1}, Y^{0}$：分别在治疗和对照下的潜在结果。\n- **定义：**\n  - 倾向性得分：$e(X_{i}) = \\Pr(T_{i} = 1 \\mid X_{i})$。\n- **假设（识别条件）：**\n  1. 一致性（稳定单位治疗价值假设，SUTVA）：如果 $T_i=t$，那么 $Y_i=Y_i^t$ 对于 $t \\in \\{0, 1\\}$。\n  2. 条件可交换性：$(Y^{1}, Y^{0}) \\perp T \\mid X$。\n  3. 正定性：$0  e(X)  1$ 几乎必然成立。\n- **目标：**\n  1. 使用逆概率治疗加权（IPTW）的 Horvitz–Thompson 形式推导平均治疗效应（ATE）的经验估计量。\n  2. 为给定数据集计算 ATE。\n- **数据 (N=4)：** 数据集由三元组 $(T_{i}, Y_{i}, e(X_{i}))$ 组成。\n  - 参与者 1：$(1, 5, 0.9)$\n  - 参与者 2：$(0, 3, 0.2)$\n  - 参与者 3：$(1, 4, 0.8)$\n  - 参与者 4：$(0, 2, 0.1)$\n\n### 第 2 步：使用提取的已知信息进行验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题牢固地植根于因果推断的统计学领域。潜在结果、倾向性得分以及一致性、可交换性和正定性等假设是流行病学和预防医学中现代因果分析的基础。\n- **问题适定：** 该问题提供了推导特定估计量和计算唯一数值结果所需的所有必要定义、假设和数据。\n- **客观性：** 该问题使用统计学和流行病学中精确、标准和客观的术语进行陈述。\n- **完整性和一致性：** 该问题是自洽的。提供的数据足以进行计算，并且没有内部矛盾。所有倾向性得分都严格介于 $0$ 和 $1$ 之间，满足正定性假设。\n- **相关性：** 该问题与 *预防医学* 领域内指定的 *高级因果推断方法（倾向性得分...）* 主题直接相关。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### ATE 的 IPTW 估计量的推导\n\n平均治疗效应（ATE）定义为治疗下的潜在结果（$Y^{1}$）与对照下的潜在结果（$Y^{0}$）之间的期望差异。\n$$ \\text{ATE} = E[Y^{1}] - E[Y^{0}] $$\n我们将使用给定的假设分别推导 $E[Y^{1}]$ 和 $E[Y^{0}]$ 的估计量。\n\n首先，考虑治疗下的期望潜在结果 $E[Y^{1}]$。根据迭代期望定律，我们可以对协变量 $X$ 取条件：\n$$ E[Y^{1}] = E_{X}[E[Y^{1} \\mid X]] $$\n根据条件可交换性假设 $(Y^{1}, Y^{0}) \\perp T \\mid X$，给定 $X$ 的条件下，潜在结果 $Y^{1}$ 的期望与实际接受的治疗无关。因此，我们可以进一步以 $T=1$ 为条件：\n$$ E[Y^{1} \\mid X] = E[Y^{1} \\mid X, T=1] $$\n根据一致性假设，对于接受治疗的个体（$T=1$），他们观察到的结果 $Y$ 就是他们在治疗下的潜在结果，即 $Y=Y^{1}$。因此：\n$$ E[Y^{1} \\mid X, T=1] = E[Y \\mid X, T=1] $$\n结合这些步骤可得：\n$$ E[Y^{1}] = E_{X}[E[Y \\mid X, T=1]] $$\n为了构建一个 Horvitz-Thompson 形式的估计量，我们使用逆概率加权。考虑数量 $\\frac{T_i Y_i}{e(X_i)}$ 的期望：\n$$ E\\left[\\frac{T Y}{e(X)}\\right] = E_{X}\\left[E\\left[\\frac{T Y}{e(X)} \\mid X\\right]\\right] $$\n由于 $e(X)$ 是 $X$ 的函数，它在内层期望中是固定的：\n$$ E\\left[\\frac{T Y}{e(X)} \\mid X\\right] = \\frac{1}{e(X)} E[T Y \\mid X] $$\n期望 $E[T Y \\mid X]$ 是在给定 $X$ 的条件下，对 $T$ 和 $Y$ 的条件分布计算的。由于 $T$ 是二元的：\n$$ E[T Y \\mid X] = \\Pr(T=1 \\mid X) \\cdot 1 \\cdot E[Y \\mid X, T=1] + \\Pr(T=0 \\mid X) \\cdot 0 \\cdot E[Y \\mid X, T=0] $$\n使用倾向性得分的定义，$\\Pr(T=1 \\mid X) = e(X)$：\n$$ E[T Y \\mid X] = e(X) E[Y \\mid X, T=1] $$\n将其代回：\n$$ E\\left[\\frac{T Y}{e(X)} \\mid X\\right] = \\frac{1}{e(X)} \\cdot e(X) E[Y \\mid X, T=1] = E[Y \\mid X, T=1] $$\n最后，对 $X$ 取外层期望并使用我们之前的结果：\n$$ E\\left[\\frac{T Y}{e(X)}\\right] = E_{X}[E[Y \\mid X, T=1]] = E[Y^{1}] $$\n这就为 $E[Y^{1}]$ 建立了一个恒等式。对于 $E[Y^{0}]$ 也有类似的推导。考虑数量 $\\frac{(1-T)Y}{1-e(X)}$：\n$$ E\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = E_{X}\\left[E\\left[\\frac{(1-T)Y}{1-e(X)} \\mid X\\right]\\right] = E_{X}\\left[\\frac{1}{1-e(X)} E[(1-T)Y \\mid X]\\right] $$\n我们有 $E[(1-T)Y \\mid X] = \\Pr(T=0 \\mid X) E[Y \\mid X, T=0] = (1-e(X))E[Y \\mid X, T=0]$。\n$$ E\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = E_{X}[E[Y \\mid X, T=0]] $$\n使用一致性（如果 $T=0$，则 $Y=Y^0$）和条件可交换性（$Y^0 \\perp T \\mid X$），我们有 $E[Y \\mid X, T=0] = E[Y^0 \\mid X, T=0] = E[Y^0 \\mid X]$。\n$$ E\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = E_{X}[E[Y^0 \\mid X]] = E[Y^0] $$\n结合这些结果，可以得到 ATE 的表达式：\n$$ \\text{ATE} = E[Y^{1}] - E[Y^{0}] = E\\left[\\frac{T Y}{e(X)}\\right] - E\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = E\\left[\\frac{T Y}{e(X)} - \\frac{(1-T)Y}{1-e(X)}\\right] $$\nATE 的 Horvitz–Thompson 形式的 IPTW 估计量是此表达式的经验模拟，通过将期望算子替换为样本均值 $\\frac{1}{n} \\sum_{i=1}^n$ 得到：\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{T_i Y_i}{e(X_i)} - \\frac{(1-T_i) Y_i}{1-e(X_i)} \\right) $$\n\n### ATE 的计算\n\n现在我们将此公式应用于包含 $n=4$ 名参与者的给定数据集。三元组为 $(T_i, Y_i, e(X_i))$。\n\n- 对于参与者 $i=1$：$(1, 5, 0.9)$。对总和的贡献是 $\\frac{1 \\cdot 5}{0.9} - \\frac{(1-1) \\cdot 5}{1-0.9} = \\frac{5}{0.9}$。\n- 对于参与者 $i=2$：$(0, 3, 0.2)$。对总和的贡献是 $\\frac{0 \\cdot 3}{0.2} - \\frac{(1-0) \\cdot 3}{1-0.2} = -\\frac{3}{0.8}$。\n- 对于参与者 $i=3$：$(1, 4, 0.8)$。对总和的贡献是 $\\frac{1 \\cdot 4}{0.8} - \\frac{(1-1) \\cdot 4}{1-0.8} = \\frac{4}{0.8}$。\n- 对于参与者 $i=4$：$(0, 2, 0.1)$。对总和的贡献是 $\\frac{0 \\cdot 2}{0.1} - \\frac{(1-0) \\cdot 2}{1-0.1} = -\\frac{2}{0.9}$。\n\n将这些代入估计量公式：\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left[ \\left(\\frac{5}{0.9}\\right) + \\left(-\\frac{3}{0.8}\\right) + \\left(\\frac{4}{0.8}\\right) + \\left(-\\frac{2}{0.9}\\right) \\right] $$\n将具有相同分母的项分组：\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left[ \\left(\\frac{5}{0.9} - \\frac{2}{0.9}\\right) + \\left(\\frac{4}{0.8} - \\frac{3}{0.8}\\right) \\right] $$\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left[ \\frac{3}{0.9} + \\frac{1}{0.8} \\right] $$\n将小数转换为分数：\n$$ \\frac{3}{0.9} = \\frac{3}{9/10} = \\frac{30}{9} = \\frac{10}{3} $$\n$$ \\frac{1}{0.8} = \\frac{1}{8/10} = \\frac{10}{8} = \\frac{5}{4} $$\n将这些代回表达式中：\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left[ \\frac{10}{3} + \\frac{5}{4} \\right] $$\n找到括号中各项的公分母，即 $12$：\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left[ \\frac{10 \\cdot 4}{12} + \\frac{5 \\cdot 3}{12} \\right] = \\frac{1}{4} \\left[ \\frac{40}{12} + \\frac{15}{12} \\right] $$\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{1}{4} \\left( \\frac{40+15}{12} \\right) = \\frac{1}{4} \\left( \\frac{55}{12} \\right) $$\n$$ \\widehat{\\text{ATE}}_{\\text{IPTW}} = \\frac{55}{48} $$\n估计的平均治疗效应为 $\\frac{55}{48}$ mmHg。这个正值表明，基于这个小样本和给定的倾向性得分，与不进行干预相比，生活方式咨询干预与收缩压平均降低约 $1.15$ mmHg 相关。",
            "answer": "$$\\boxed{\\frac{55}{48}}$$"
        },
        {
            "introduction": "有时，即使使用了倾向性得分，我们也无法控制所有的混杂变量，特别是那些未被测量的变量。在这种情况下，工具变量（IV）分析就成为一个强大的工具。本练习介绍经典的 Wald 估计量，用以估计局部平均治疗效应（LATE），展示一个外部因素（即工具变量）如何在存在未观测混杂的情况下，帮助我们分离出因果效应。",
            "id": "4501617",
            "problem": "一个公共卫生部门正在评估一项诊所提醒计划对季节性流感疫苗接种率及后续流感感染风险的因果效应，作为一项预防医学倡议的一部分。设二元工具变量 $Z$ 表示患者是否收到了诊所提醒（$Z=1$ 表示收到，$Z=0$ 表示未收到）。设二元处理变量 $T$ 表示患者是否接种了疫苗（$T=1$ 表示接种，$T=0$ 表示未接种）。设二元结果变量 $Y$ 表示患者在该季节是否患有经实验室确认的流感（$Y=1$ 表示患有，$Y=0$ 表示未患有）。假设在该情境下，工具变量（IV）分析的以下公认条件成立：工具变量相关性、在给定基线协变量的情况下工具变量与潜在结果和潜在处理的独立性、排他性限制（即工具变量仅通过处理影响结果）以及单调性（即不存在反抗者）。\n\n从潜在结果框架、主分层和条件期望的定义出发，推导 Wald 估计量，该估计量是识别局部平均处理效应（LATE）的比率。其中，局部平均处理效应（LATE）定义为在依从者（compliers）中疫苗接种对 $Y$ 的平均因果效应。然后，使用观测到的量 $E[Y \\mid Z=1]=0.12$、$E[Y \\mid Z=0]=0.18$、$E[T \\mid Z=1]=0.80$ 和 $E[T \\mid Z=0]=0.50$ 来计算其值。\n\n将最终答案表示为小数比例。无需四舍五入。",
            "solution": "该问题要求在潜在结果框架下推导用于局部平均处理效应（LATE）的 Wald 估计量，并使用所提供的数据进行后续计算。\n\n设 $Z$ 为是否收到诊所提醒的二元工具变量（$Z=1$ 表示收到，$Z=0$ 表示未收到）。\n设 $T$ 为是否接种疫苗的二元处理变量（$T=1$ 表示接种，$T=0$ 表示未接种）。\n设 $Y$ 为是否患流感的二元结果变量（$Y=1$ 表示患病，$Y=0$ 表示未患病）。\n\n我们首先为每个个体（以 $i$ 为索引）定义潜在结果。设 $T_i(z)$ 为个体 $i$ 在其工具变量状态为 $z$ 时的潜在处理状态，其中 $z \\in \\{0, 1\\}$。设 $Y_i(t)$ 为个体 $i$ 在其处理状态为 $t$ 时的潜在结果，其中 $t \\in \\{0, 1\\}$。这种表示潜在结果 $Y_i(t)$ 的方法包含了**排他性限制**，即假定工具变量 $Z$ 仅通过处理 $T$ 影响结果 $Y$。也就是说，$Y_i(z, t) = Y_i(t)$，对于 $z \\in \\{0, 1\\}$。\n\n根据个体的潜在处理反应 $T_i(0)$ 和 $T_i(1)$，可以将人群划分为四个主分层：\n1.  **依从者 (c)：** 对这些个体而言，$T_i(0)=0$ 且 $T_i(1)=1$。他们当且仅当收到提醒时才会接种疫苗。\n2.  **从不拒绝者 (a)：** 对这些个体而言，$T_i(0)=1$ 且 $T_i(1)=1$。无论是否收到提醒，他们都会接种疫苗。\n3.  **从不接受者 (n)：** 对这些个体而言，$T_i(0)=0$ 且 $T_i(1)=0$。无论是否收到提醒，他们从不接种疫苗。\n4.  **反抗者 (d)：** 对这些个体而言，$T_i(0)=1$ 且 $T_i(1)=0$。他们当且仅当*没有*收到提醒时才会接种疫苗。\n\n问题陈述中提到，**单调性假设**成立，这意味着不存在反抗者。因此，人群中反抗者的比例为 $P(d)=0$。\n\n局部平均处理效应（LATE）定义为处理对依从者子群体结果的平均因果效应：\n$$\n\\text{LATE} = E[Y_i(1) - Y_i(0) \\mid \\text{stratum}_i = \\text{c}]\n$$\n\nWald 估计量是意向性治疗对结果的效应与意向性治疗对处理的效应之比：\n$$\n\\text{Wald Estimator} = \\frac{E[Y \\mid Z=1] - E[Y \\mid Z=0]}{E[T \\mid Z=1] - E[T \\mid Z=0]}\n$$\n\n我们现在将证明该估计量能够识别 LATE。\n\n首先，我们分析分母 $E[T \\mid Z=1] - E[T \\mid Z=0]$。\n根据全期望定律，我们可以通过对主分层进行条件化来表示 $T$ 的条件期望：\n$$\nE[T \\mid Z=1] = \\sum_{s \\in \\{a, n, c\\}} E[T \\mid Z=1, \\text{stratum}=s] P(\\text{stratum}=s \\mid Z=1)\n$$\n**工具变量独立性**假设指出，$Z$ 与潜在结果和潜在处理无关，这意味着 $Z$ 也与主分层类型无关。因此，$P(\\text{stratum}=s \\mid Z=1) = P(\\text{stratum}=s)$。\n对于给定分层中的个体，当 $Z=1$ 时，其处理状态 $T$ 由该分层的定义决定，即 $T = T(1)$。\n所以，$E[T \\mid Z=1, \\text{stratum}=a] = T(1)_a = 1$。\n$E[T \\mid Z=1, \\text{stratum}=n] = T(1)_n = 0$。\n$E[T \\mid Z=1, \\text{stratum}=c] = T(1)_c = 1$。\n\n于是，\n$$\nE[T \\mid Z=1] = 1 \\cdot P(a) + 0 \\cdot P(n) + 1 \\cdot P(c) = P(a) + P(c)\n$$\n同样地，对于 $Z=0$：\n$$\nE[T \\mid Z=0] = \\sum_{s \\in \\{a, n, c\\}} E[T \\mid Z=0, \\text{stratum}=s] P(\\text{stratum}=s)\n$$\n这里，$T = T(0)$。\n$E[T \\mid Z=0, \\text{stratum}=a] = T(0)_a = 1$。\n$E[T \\mid Z=0, \\text{stratum}=n] = T(0)_n = 0$。\n$E[T \\mid Z=0, \\text{stratum}=c] = T(0)_c = 0$。\n于是，\n$$\nE[T \\mid Z=0] = 1 \\cdot P(a) + 0 \\cdot P(n) + 0 \\cdot P(c) = P(a)\n$$\n差值为：\n$$\nE[T \\mid Z=1] - E[T \\mid Z=0] = (P(a) + P(c)) - P(a) = P(c)\n$$\nWald 估计量的分母是人群中依从者的比例。\n\n接下来，我们分析分子 $E[Y \\mid Z=1] - E[Y \\mid Z=0]$。\n当 $Z=1$ 时，个体的观测结果为 $Y = Y(T(1))$。使用全期望定律和工具变量独立性：\n\\begin{align*} E[Y \\mid Z=1] = E[Y(T(1))] \\\\ = E[Y(T(1)) \\mid \\text{a}]P(\\text{a}) + E[Y(T(1)) \\mid \\text{n}]P(\\text{n}) + E[Y(T(1)) \\mid \\text{c}]P(\\text{c}) \\\\ = E[Y(1) \\mid \\text{a}]P(\\text{a}) + E[Y(0) \\mid \\text{n}]P(\\text{n}) + E[Y(1) \\mid \\text{c}]P(\\text{c})\\end{align*}\n当 $Z=0$ 时，观测结果为 $Y=Y(T(0))$。\n\\begin{align*} E[Y \\mid Z=0] = E[Y(T(0))] \\\\ = E[Y(T(0)) \\mid \\text{a}]P(\\text{a}) + E[Y(T(0)) \\mid \\text{n}]P(\\text{n}) + E[Y(T(0)) \\mid \\text{c}]P(\\text{c}) \\\\ = E[Y(1) \\mid \\text{a}]P(\\text{a}) + E[Y(0) \\mid \\text{n}]P(\\text{n}) + E[Y(0) \\mid \\text{c}]P(\\text{c})\\end{align*}\n独立性假设允许我们陈述 $E[Y(t) \\mid \\text{stratum}, Z=z] = E[Y(t) \\mid \\text{stratum}]$。\n计算差值：\n\\begin{align*} E[Y \\mid Z=1] - E[Y \\mid Z=0] = \\left( E[Y(1) \\mid \\text{a}]P(\\text{a}) + \\dots + E[Y(1) \\mid \\text{c}]P(\\text{c}) \\right) - \\left( E[Y(1) \\mid \\text{a}]P(\\text{a}) + \\dots + E[Y(0) \\mid \\text{c}]P(\\text{c}) \\right) \\\\ = E[Y(1) \\mid \\text{c}]P(\\text{c}) - E[Y(0) \\mid \\text{c}]P(\\text{c}) \\\\ = \\left( E[Y(1) \\mid \\text{c}] - E[Y(0) \\mid \\text{c}] \\right) P(\\text{c}) \\\\ = E[Y(1) - Y(0) \\mid \\text{c}] P(\\text{c})\\end{align*}\n分子是 LATE 乘以依从者的比例。\n\n最后，构造比率：\n$$\n\\frac{E[Y \\mid Z=1] - E[Y \\mid Z=0]}{E[T \\mid Z=1] - E[T \\mid Z=0]} = \\frac{E[Y(1) - Y(0) \\mid \\text{c}] P(\\text{c})}{P(\\text{c})} = E[Y(1) - Y(0) \\mid \\text{c}] = \\text{LATE}\n$$\n推导至此完成。Wald 估计量识别了 LATE。\n\n现在，我们使用给定的观测值计算其值：\n$E[Y \\mid Z=1] = 0.12$\n$E[Y \\mid Z=0] = 0.18$\n$E[T \\mid Z=1] = 0.80$\n$E[T \\mid Z=0] = 0.50$\n\n将这些值代入 Wald 估计量公式：\n$$\n\\text{LATE} = \\frac{0.12 - 0.18}{0.80 - 0.50} = \\frac{-0.06}{0.30}\n$$\n$$\n\\text{LATE} = -0.2\n$$\n局部平均处理效应为 $-0.2$。这表明对于依从者（即那些仅因为收到提醒才接种疫苗的人），接种疫苗可使患流感的概率降低 $20$ 个百分点。该人群中依从者的比例是 $P(c) = E[T \\mid Z=1] - E[T \\mid Z=0] = 0.80 - 0.50 = 0.30$，即 $30\\%$。",
            "answer": "$$\\boxed{-0.2}$$"
        }
    ]
}