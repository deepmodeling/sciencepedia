{
    "hands_on_practices": [
        {
            "introduction": "Parametric models are cornerstones of quantal dose-response analysis. This first practice invites you to explore the mathematical foundations of the classic probit model, which links response probability to the logarithm of the dose via the cumulative normal distribution. By deriving the relationship between the slope parameter $ \\beta $ and the ratio of effective doses ($ ED_{90}/ED_{10} $), you will gain a deeper, quantitative understanding of how the curve's steepness reflects the population's sensitivity to changes in drug concentration . This exercise builds essential skills in manipulating model equations to reveal the pharmacological meaning of their parameters.",
            "id": "4984806",
            "problem": "A pharmacologist models a binary (quantal) response to dose in a homogeneous population using a probit dose-response model. Let $p(d)$ denote the probability of response at dose $d > 0$. The model assumes that the probit-transformed response probability is linear in the natural logarithm of dose:\n$$\\Phi^{-1}\\!\\big(p(d)\\big) = \\alpha + \\beta \\ln d,$$\nwhere $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi^{-1}$ is its inverse (the probit), $\\alpha \\in \\mathbb{R}$ is a location parameter, and $\\beta > 0$ is a slope parameter. The effective dose at probability level $p \\in (0, 1)$, denoted $\\mathrm{ED}_{p}$, is defined by $p(\\mathrm{ED}_{p})=p$.\n\nStarting from these definitions, and without invoking any pre-given closed-form for $\\mathrm{ED}_{p}$, derive a symbolic expression for $\\mathrm{ED}_{p}$ in terms of $\\alpha$, $\\beta$, and $p$. Then specialize to $p=0.1$ and $p=0.9$ to obtain $\\mathrm{ED}_{10}$ and $\\mathrm{ED}_{90}$. Finally, form the ratio $R=\\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ and simplify it using only fundamental properties of the standard normal distribution to eliminate $\\alpha$, expressing $R$ solely as a function of $\\beta$. Provide your final answer as a single closed-form expression for $R$ in terms of $\\beta$. No numerical approximation or rounding is required, and no units are needed for $R$ since it is dimensionless.",
            "solution": "The problem will first be validated for scientific soundness, self-consistency, and well-posedness.\n\n### Step 1: Extract Givens\n-   The probability of response at dose $d > 0$ is denoted by $p(d)$.\n-   The probit dose-response model is given by the equation: $\\Phi^{-1}\\!\\big(p(d)\\big) = \\alpha + \\beta \\ln d$.\n-   $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution.\n-   $\\Phi^{-1}$ is the inverse of $\\Phi$, also known as the probit function.\n-   $\\alpha \\in \\mathbb{R}$ is a location parameter.\n-   $\\beta > 0$ is a slope parameter.\n-   The effective dose at probability level $p \\in (0, 1)$, denoted $\\mathrm{ED}_{p}$, is defined by the condition $p(\\mathrm{ED}_{p})=p$.\n-   The task is to derive an expression for the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ using the cases $p=0.9$ and $p=0.1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria.\n-   **Scientifically Grounded:** The probit model is a cornerstone of classical toxicology and pharmacology for analyzing quantal (all-or-none) dose-response data. It assumes that the logarithm of the tolerance of individuals in a population is normally distributed. The model formulation is standard and correctly stated.\n-   **Well-Posed:** The problem provides all necessary definitions and constraints to derive a unique symbolic expression for the ratio $R$. The parameters are defined, and the functional form of the model is explicit. The question is unambiguous.\n-   **Objective:** The problem is stated in precise mathematical and scientific language, free of subjectivity or opinion.\n-   The problem does not suffer from any of the invalidity flaws. It is scientifically sound, formalizable, complete, feasible, well-posed, and non-trivial. It asks for a standard derivation within its domain.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to derive a simplified, closed-form expression for the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$ as a function of the parameter $\\beta$.\n\nFirst, we derive a general expression for the effective dose, $\\mathrm{ED}_{p}$. By definition, $\\mathrm{ED}_{p}$ is the dose $d$ that satisfies the condition $p(d) = p$. Substituting $d = \\mathrm{ED}_{p}$ and $p(d) = p$ into the probit model equation gives:\n$$\n\\Phi^{-1}(p) = \\alpha + \\beta \\ln(\\mathrm{ED}_{p})\n$$\nWe must now solve this equation for $\\mathrm{ED}_{p}$. Rearranging the terms to isolate $\\ln(\\mathrm{ED}_{p})$:\n$$\n\\beta \\ln(\\mathrm{ED}_{p}) = \\Phi^{-1}(p) - \\alpha\n$$\n$$\n\\ln(\\mathrm{ED}_{p}) = \\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\n$$\nExponentiating both sides of the equation yields the general expression for $\\mathrm{ED}_{p}$:\n$$\n\\mathrm{ED}_{p} = \\exp\\left(\\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\\right)\n$$\nNext, we specialize this general expression for the two required cases: $\\mathrm{ED}_{90}$ and $\\mathrm{ED}_{10}$. The problem states that these correspond to response probabilities $p=0.9$ and $p=0.1$, respectively.\n\nFor $\\mathrm{ED}_{90}$, we set $p=0.9$:\n$$\n\\mathrm{ED}_{90} = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right)\n$$\nFor $\\mathrm{ED}_{10}$, we set $p=0.1$:\n$$\n\\mathrm{ED}_{10} = \\exp\\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)\n$$\nNow, we form the ratio $R = \\mathrm{ED}_{90}/\\mathrm{ED}_{10}$:\n$$\nR = \\frac{\\mathrm{ED}_{90}}{\\mathrm{ED}_{10}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right)}{\\exp\\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)}\n$$\nUsing the property of exponential functions, $\\exp(a)/\\exp(b) = \\exp(a-b)$, we simplify the ratio:\n$$\nR = \\exp\\left(\\left(\\frac{\\Phi^{-1}(0.9) - \\alpha}{\\beta}\\right) - \\left(\\frac{\\Phi^{-1}(0.1) - \\alpha}{\\beta}\\right)\\right)\n$$\nCombining the terms in the exponent over the common denominator $\\beta$:\n$$\nR = \\exp\\left(\\frac{(\\Phi^{-1}(0.9) - \\alpha) - (\\Phi^{-1}(0.1) - \\alpha)}{\\beta}\\right)\n$$\nThe parameter $\\alpha$ cancels out in the numerator:\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - \\Phi^{-1}(0.1)}{\\beta}\\right)\n$$\nThe final step is to simplify the numerator using a fundamental property of the standard normal distribution. The standard normal probability density function is symmetric about $z=0$. This implies a symmetry for its CDF, $\\Phi(z)$, and its inverse, $\\Phi^{-1}(p)$. The property is $\\Phi(-z) = 1 - \\Phi(z)$.\nLet $p = \\Phi(z)$, which implies $z = \\Phi^{-1}(p)$. Substituting these into the symmetry property gives:\n$$\n1-p = \\Phi(-z) = \\Phi(-\\Phi^{-1}(p))\n$$\nApplying the inverse CDF, $\\Phi^{-1}$, to both sides:\n$$\n\\Phi^{-1}(1-p) = -\\Phi^{-1}(p)\n$$\nWe can apply this property to the term $\\Phi^{-1}(0.1)$ in our expression for $R$. Setting $p=0.9$, we have $1-p = 1-0.9 = 0.1$. Therefore:\n$$\n\\Phi^{-1}(0.1) = \\Phi^{-1}(1-0.9) = -\\Phi^{-1}(0.9)\n$$\nSubstituting this result back into the expression for $R$:\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) - (-\\Phi^{-1}(0.9))}{\\beta}\\right)\n$$\n$$\nR = \\exp\\left(\\frac{\\Phi^{-1}(0.9) + \\Phi^{-1}(0.9)}{\\beta}\\right)\n$$\n$$\nR = \\exp\\left(\\frac{2\\Phi^{-1}(0.9)}{\\beta}\\right)\n$$\nThis is the final simplified expression for the ratio $R$. It is a function solely of the slope parameter $\\beta$, as the term $\\Phi^{-1}(0.9)$ represents a specific numerical constant (the $z$-score corresponding to the $90$th percentile of the standard normal distribution). The location parameter $\\alpha$ has been eliminated as required.",
            "answer": "$$\\boxed{\\exp\\left(\\frac{2\\Phi^{-1}(0.9)}{\\beta}\\right)}$$"
        },
        {
            "introduction": "While idealized models are useful, real-world data is rarely perfect. This practice moves from a perfect observation scenario to a more realistic one where experimental measurements are subject to error. Here, we will investigate the systematic effects of endpoint misclassification—specifically, false positives and false negatives—on a dose-response curve described by a logistic function. This derivation will demonstrate how such errors can distort key pharmacological parameters like the $ED_{50}$, leading to biased conclusions about a drug's potency . This exercise underscores the critical importance of considering sources of measurement error in experimental design and data interpretation.",
            "id": "4984840",
            "problem": "A pharmacology laboratory measures a binary quantal endpoint (e.g., loss of righting reflex) in a rodent cohort exposed to a drug at dose $D$ (in mg/kg). Assume the underlying true probability of response, denoted $p_{\\mathrm{true}}(D)$, follows a logistic link on the natural-log dose scale: the logit of $p_{\\mathrm{true}}$ is an affine function of $\\ln(D)$, and the Effective Dose for $50\\%$ of subjects (ED50) on the dose scale, $D_{50,\\mathrm{true}}$, satisfies $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$. The slope parameter on the $\\ln(D)$ scale is a positive constant $b$.\n\nIn the laboratory’s scoring system, independent random endpoint misclassification occurs: a non-responder is recorded as a responder with false-positive probability $\\alpha$, and a true responder is recorded as a non-responder with false-negative probability $\\beta$, where both $\\alpha$ and $\\beta$ are dose-independent and satisfy $0  \\alpha  0.5$, $0  \\beta  0.5$, and $\\alpha + \\beta  1$. Let the observed response probability be $p_{\\mathrm{obs}}(D)$, defined by the law of total probability given the above misclassification mechanism.\n\nStarting from the definitions of the logistic link for $p_{\\mathrm{true}}(D)$, the ED50 definition $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$, and the dose-independent misclassification mechanism described above, derive the dose $D_{50,\\mathrm{app}}$ that would be inferred as the ED50 if one naively fits a logistic model to $p_{\\mathrm{obs}}(D)$ under the (incorrect) assumption of no misclassification, i.e., by solving $p_{\\mathrm{obs}}(D)=0.5$ for $D$.\n\nFor a preparation characterized by $D_{50,\\mathrm{true}}=4.0$ mg/kg, slope $b=2.0$ on the $\\ln(D)$ scale, false-positive rate $\\alpha=0.05$, and false-negative rate $\\beta=0.20$, compute the numerical value of $D_{50,\\mathrm{app}}$ in mg/kg. Round your final numeric answer to four significant figures. In your derivation, explicitly justify why the misclassification mechanism flattens the quantal curve and how the solution for $D_{50,\\mathrm{app}}$ reflects an increased apparent ED50 when $\\beta > \\alpha$.",
            "solution": "### Step 1: Problem Validation\n\n**Extract Givens:**\n*   Quantal endpoint in a rodent cohort.\n*   Dose $D$ (in mg/kg).\n*   True probability of response: $p_{\\mathrm{true}}(D)$.\n*   Model for $p_{\\mathrm{true}}(D)$: logistic link on the natural-log dose scale.\n*   The logit of $p_{\\mathrm{true}}$ is an affine function of $\\ln(D)$.\n*   Effective Dose for $50\\%$ of subjects (ED50) on the dose scale: $D_{50,\\mathrm{true}}$.\n*   Condition for ED50: $p_{\\mathrm{true}}(D_{50,\\mathrm{true}})=0.5$.\n*   Slope parameter on the $\\ln(D)$ scale is a positive constant $b$.\n*   False-positive probability: $\\alpha$. A non-responder is recorded as a responder. Dose-independent. $0  \\alpha  0.5$.\n*   False-negative probability: $\\beta$. A true responder is recorded as a non-responder. Dose-independent. $0  \\beta  0.5$.\n*   Constraint: $\\alpha + \\beta  1$.\n*   Observed response probability: $p_{\\mathrm{obs}}(D)$, defined by the law of total probability.\n*   Apparent ED50: $D_{50,\\mathrm{app}}$ is the solution to $p_{\\mathrm{obs}}(D)=0.5$.\n*   Numerical values: $D_{50,\\mathrm{true}}=4.0$ mg/kg, $b=2.0$, $\\alpha=0.05$, $\\beta=0.20$.\n*   Task: Derive $D_{50,\\mathrm{app}}$, justify the flattening of the curve, explain the shift in ED50 when $\\beta > \\alpha$, and compute the numerical value of $D_{50,\\mathrm{app}}$. Round to four significant figures.\n\n**Validate Using Extracted Givens:**\n1.  **Scientifically Grounded:** The problem is a standard exercise in pharmacological statistics (quantal dose-response analysis). The use of a logistic model, log-dose transformation, ED50, and accounting for misclassification errors ($\\alpha$, $\\beta$) are all well-established concepts in this field. The model is a scientifically reasonable simplification. The constraints on $\\alpha$ and $\\beta$ ($0  \\alpha, \\beta  0.5$ and $\\alpha + \\beta  1$) are sensible. The problem is scientifically grounded.\n2.  **Well-Posed:** The problem provides all necessary information to derive the relationship between $D_{50,\\mathrm{app}}$ and the other parameters. The functions are well-defined. The question asks for a specific derivation and calculation, which should lead to a unique solution. The problem is well-posed.\n3.  **Objective:** The language is clear, precise, and mathematical. There are no subjective or opinion-based statements. The problem is objective.\n4.  **Flaw Checklist:**\n    *   No scientific/factual unsoundness.\n    *   Formalizable and relevant to the topic.\n    *   Complete and consistent setup.\n    *   Realistic and feasible within the context of a modeling problem.\n    *   Well-posed and structured.\n    *   Not trivial or tautological.\n    *   Verifiable through mathematical derivation.\n\n**Verdict and Action:**\nThe problem is **valid**. I will proceed with the solution.\n\n---\n\n### Step 2: Solution Derivation\n\n**Part 1: Theoretical Derivation**\n\n*   **True Probability Model:**\n    The logit of $p_{\\mathrm{true}}(D)$ is an affine function of $\\ln(D)$:\n    $$ \\mathrm{logit}(p_{\\mathrm{true}}(D)) = \\ln\\left(\\frac{p_{\\mathrm{true}}(D)}{1-p_{\\mathrm{true}}(D)}\\right) = a + b \\ln(D) $$\n    The constant $a$ is determined by the condition $p_{\\mathrm{true}}(D_{50,\\mathrm{true}}) = 0.5$. At this dose, $\\mathrm{logit}(0.5) = \\ln(1) = 0$.\n    $$ 0 = a + b \\ln(D_{50,\\mathrm{true}}) \\implies a = -b \\ln(D_{50,\\mathrm{true}}) $$\n    Substituting $a$ back, we obtain the log-dose logistic model:\n    $$ \\ln\\left(\\frac{p_{\\mathrm{true}}(D)}{1-p_{\\mathrm{true}}(D)}\\right) = b \\ln(D) - b \\ln(D_{50,\\mathrm{true}}) = b \\ln\\left(\\frac{D}{D_{50,\\mathrm{true}}}\\right) $$\n\n*   **Observed Probability Model:**\n    Let $R$ be the event of a true response and $O$ be the event of an observed response. The true response probability is $P(R|D) = p_{\\mathrm{true}}(D)$. The misclassification probabilities are the false-positive rate $\\alpha = P(O | \\neg R)$ and the false-negative rate $\\beta = P(\\neg O | R)$. The true-positive rate is thus $P(O | R) = 1-\\beta$.\n    Using the law of total probability, the observed probability of response $p_{\\mathrm{obs}}(D)$ is:\n    $$ p_{\\mathrm{obs}}(D) = P(O|D) = P(O | R, D) P(R|D) + P(O | \\neg R, D) P(\\neg R|D) $$\n    Given that misclassification is dose-independent:\n    $$ p_{\\mathrm{obs}}(D) = (1-\\beta) p_{\\mathrm{true}}(D) + \\alpha (1 - p_{\\mathrm{true}}(D)) $$\n    This simplifies to a linear transformation of the true probability:\n    $$ p_{\\mathrm{obs}}(D) = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D) $$\n\n*   **Apparent ED50 Derivation:**\n    The apparent ED50, $D_{50,\\mathrm{app}}$, is the dose at which the observed response probability is $0.5$. We set $p_{\\mathrm{obs}}(D_{50,\\mathrm{app}}) = 0.5$:\n    $$ 0.5 = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D_{50,\\mathrm{app}}) $$\n    Solving for the true probability at this apparent dose:\n    $$ p_{\\mathrm{true}}(D_{50,\\mathrm{app}}) = \\frac{0.5 - \\alpha}{1 - \\alpha - \\beta} $$\n    Let's denote this required true probability as $p^* = p_{\\mathrm{true}}(D_{50,\\mathrm{app}})$. We now substitute this into the true probability model:\n    $$ \\ln\\left(\\frac{p_{\\mathrm{true}}(D_{50,\\mathrm{app}})}{1-p_{\\mathrm{true}}(D_{50,\\mathrm{app}})}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    $$ \\ln\\left(\\frac{p^*}{1-p^*}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    The term $\\frac{p^*}{1-p^*}$ is calculated as:\n    $$ \\frac{p^*}{1-p^*} = \\frac{\\frac{0.5 - \\alpha}{1 - \\alpha - \\beta}}{1 - \\frac{0.5 - \\alpha}{1 - \\alpha - \\beta}} = \\frac{0.5 - \\alpha}{(1 - \\alpha - \\beta) - (0.5 - \\alpha)} = \\frac{0.5 - \\alpha}{0.5 - \\beta} $$\n    Substituting this back into the equation:\n    $$ \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right) = b \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) $$\n    Solving for $D_{50,\\mathrm{app}}$:\n    $$ \\ln\\left(\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}}\\right) = \\frac{1}{b} \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right) $$\n    $$ \\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}} = \\exp\\left[\\frac{1}{b} \\ln\\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)\\right] = \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} $$\n    The final expression for the apparent ED50 is:\n    $$ D_{50,\\mathrm{app}} = D_{50,\\mathrm{true}} \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} $$\n\n**Part 2: Justification and Interpretation**\n\n*   **Flattening of the Curve:**\n    The true probability $p_{\\mathrm{true}}(D)$ ranges over $(0, 1)$ as $D$ varies from $0$ to $\\infty$. The observed probability is $p_{\\mathrm{obs}}(D) = \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D)$.\n    At zero dose ($D \\to 0$), $p_{\\mathrm{true}}(D) \\to 0$, so $p_{\\mathrm{obs}}(D) \\to \\alpha$. At infinite dose ($D \\to \\infty$), $p_{\\mathrm{true}}(D) \\to 1$, so $p_{\\mathrm{obs}}(D) \\to \\alpha + (1-\\alpha-\\beta) = 1-\\beta$.\n    The range of observed probabilities is $(\\alpha, 1-\\beta)$. Given $0  \\alpha$ and $0  \\beta$, this range is smaller than $(0, 1)$. The lower asymptote is raised from $0$ to $\\alpha$, and the upper asymptote is lowered from $1$ to $1-\\beta$. This compression of the probability range is referred to as \"flattening\" of the dose-response curve.\n    Mathematically, the slope on the log-dose scale, $\\frac{dp}{d(\\ln D)}$, is also reduced.\n    $$ \\frac{d p_{\\mathrm{obs}}(D)}{d(\\ln D)} = \\frac{d}{d(\\ln D)} \\left[ \\alpha + (1 - \\alpha - \\beta) p_{\\mathrm{true}}(D) \\right] = (1 - \\alpha - \\beta) \\frac{d p_{\\mathrm{true}}(D)}{d(\\ln D)} $$\n    Since $0  \\alpha + \\beta  1$, the scaling factor $1 - \\alpha - \\beta$ is between $0$ and $1$. Thus, the slope of the observed curve is strictly less than the slope of the true curve at every dose $D$, confirming the curve is flattened.\n\n*   **Shift in ED50 for $\\beta > \\alpha$:**\n    The ratio of apparent to true ED50 is $\\frac{D_{50,\\mathrm{app}}}{D_{50,\\mathrm{true}}} = \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b}$.\n    We are given that the slope $b$ is a positive constant. The constraints $0  \\alpha  0.5$ and $0  \\beta  0.5$ ensure that both the numerator ($0.5-\\alpha$) and the denominator ($0.5-\\beta$) are positive.\n    If $\\beta > \\alpha$, then $-\\beta  -\\alpha$. Adding $0.5$ to both sides gives $0.5 - \\beta  0.5 - \\alpha$.\n    Since both sides are positive, dividing by the smaller term $(0.5-\\beta)$ yields:\n    $$ \\frac{0.5 - \\alpha}{0.5 - \\beta} > 1 $$\n    Because the base of the power is greater than $1$ and the exponent $1/b$ is positive, the entire factor is greater than $1$:\n    $$ \\left(\\frac{0.5 - \\alpha}{0.5 - \\beta}\\right)^{1/b} > 1 $$\n    This implies $D_{50,\\mathrm{app}} > D_{50,\\mathrm{true}}$.\n    Intuitively, if the false-negative rate $\\beta$ exceeds the false-positive rate $\\alpha$, there is a net bias towards observing a non-response. At the true ED50 ($D_{50,\\mathrm{true}}$), where $p_{\\mathrm{true}}=0.5$, the observed probability is $p_{\\mathrm{obs}}(D_{50,\\mathrm{true}}) = 0.5 + 0.5(\\alpha - \\beta)$. If $\\beta > \\alpha$, then $p_{\\mathrm{obs}}(D_{50,\\mathrm{true}})  0.5$. Since $p_{\\mathrm{obs}}(D)$ is a monotonically increasing function of dose, a higher dose is required to reach the apparent $50\\%$ response level, leading to an overestimation of the ED50.\n\n**Part 3: Numerical Calculation**\n\nWe are given the following values:\n*   $D_{50,\\mathrm{true}} = 4.0$\n*   $b = 2.0$\n*   $\\alpha = 0.05$\n*   $\\beta = 0.20$\n\nUsing the derived formula:\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(\\frac{0.5 - 0.05}{0.5 - 0.20}\\right)^{1/2.0} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(\\frac{0.45}{0.30}\\right)^{0.5} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\left(1.5\\right)^{0.5} $$\n$$ D_{50,\\mathrm{app}} = 4.0 \\sqrt{1.5} $$\n$$ D_{50,\\mathrm{app}} \\approx 4.0 \\times 1.22474487... $$\n$$ D_{50,\\mathrm{app}} \\approx 4.89897948... $$\nRounding the result to four significant figures gives $4.899$.",
            "answer": "$$\n\\boxed{4.899}\n$$"
        },
        {
            "introduction": "Modern pharmacology increasingly relies on computational methods to not only estimate parameters but also to rigorously quantify their uncertainty. This final practice brings together modeling concepts in a practical, computer-based exercise that reflects contemporary data analysis workflows. Using a Bayesian framework, you will learn to transform the uncertainty from a model's primary parameters ($\\alpha$ and $\\beta$) to a derived quantity of clinical interest: the effective dose ($ED_p$). This hands-on coding task will equip you with the skill to construct robust credible intervals, providing a complete and nuanced picture of the uncertainty surrounding a drug's potency .",
            "id": "4984880",
            "problem": "You are tasked with implementing a program that constructs the posterior distribution of the effective dose at target response probability $ED_{p}$ for a quantal dose-response model, using transformation of posterior samples of the slope and intercept parameters, and then summarizes that posterior with highest posterior density (HPD) intervals. The setting is a log-dose logistic model for quantal outcomes in pharmacology.\n\nStart from the following fundamental base. In a standard quantal dose-response model, each individual at dose $d$ has a binary outcome $Y \\in \\{0,1\\}$, modeled as a Bernoulli random variable with success probability $P(Y=1 \\mid d)$ that depends on dose. Under a log-dose logistic link, the relationship is given by $ \\operatorname{logit}(P(Y=1 \\mid d)) = \\alpha + \\beta \\ln(d) $, where $ \\operatorname{logit}(x) = \\ln\\!\\left(\\frac{x}{1-x}\\right) $, $ \\alpha $ is the intercept parameter, $ \\beta $ is the slope parameter, and $ d $ is the dose in $\\mathrm{mg/kg}$. The effective dose $ ED_{p} $ is defined as the dose $ d $ for which the response probability equals a specified target $ p $, where $ p \\in (0,1) $.\n\nYour program must:\n- Use the transformation principle for posterior samples: if $(\\alpha, \\beta)$ has a posterior represented by independent draws, then the posterior samples of $ ED_{p} $ are obtained by applying the deterministic transformation implied by the model definition of $ ED_{p} $ to each $(\\alpha,\\beta)$ draw.\n- Enforce monotonicity consistent with pharmacological realism by discarding any posterior samples with $ \\beta \\le 0 $. Only retained samples should be transformed to $ ED_{p} $.\n- Compute the sample median of the resulting $ ED_{p} $ posterior samples.\n- Compute the $q$-mass Highest Posterior Density (HPD) interval for the $ ED_{p} $ posterior samples, defined as the shortest interval $[L, U]$ that contains a proportion $ q $ of the samples. For practical computation from a sorted sample $ \\{x_{(1)}, \\dots, x_{(n)}\\} $, with $ k = \\lfloor q n \\rfloor $, the HPD interval is the pair $[x_{(i)}, x_{(i+k)}]$ that minimizes $ x_{(i+k)} - x_{(i)} $ over all valid $ i $.\n\nPhysical units and answer specification:\n- All doses $ d $ and effective doses $ ED_{p} $ are in $\\mathrm{mg/kg}$.\n- Credible masses $ q $ must be provided and treated as decimals (for example, $ 0.95 $), not with a percentage sign.\n\nTest suite and parameterization:\nFor each test case, you will generate posterior samples of $(\\alpha,\\beta)$ from a bivariate normal distribution with a specified mean vector and covariance matrix, then discard samples with $ \\beta \\le 0 $, and transform the remaining samples to obtain $ ED_{p} $ samples. Use the following test suite of three cases, each specified by a random seed, a desired number of retained samples $ N $, a mean vector $ (\\mu_{\\alpha}, \\mu_{\\beta}) $, a covariance matrix $ \\Sigma $, the target probability $ p $, and credible mass $ q $.\n\n- Case A:\n  - Seed $ 17 $.\n  - Desired retained sample size $ N = 4000 $.\n  - Mean vector $ (\\mu_{\\alpha}, \\mu_{\\beta}) = (-1.2, 1.0) $.\n  - Covariance matrix $ \\Sigma = \\begin{pmatrix} 0.15^{2}  -0.015 \\\\ -0.015  0.12^{2} \\end{pmatrix} $.\n  - Target probability $ p = 0.5 $.\n  - Credible mass $ q = 0.95 $.\n\n- Case B:\n  - Seed $ 123 $.\n  - Desired retained sample size $ N = 2500 $.\n  - Mean vector $ (\\mu_{\\alpha}, \\mu_{\\beta}) = (0.4, 0.6) $.\n  - Covariance matrix $ \\Sigma = \\begin{pmatrix} 0.25^{2}  -0.02 \\\\ -0.02  0.18^{2} \\end{pmatrix} $.\n  - Target probability $ p = 0.9 $.\n  - Credible mass $ q = 0.90 $.\n\n- Case C:\n  - Seed $ 7 $.\n  - Desired retained sample size $ N = 5000 $.\n  - Mean vector $ (\\mu_{\\alpha}, \\mu_{\\beta}) = (-2.0, 0.8) $.\n  - Covariance matrix $ \\Sigma = \\begin{pmatrix} 0.2^{2}  -0.03 \\\\ -0.03  0.15^{2} \\end{pmatrix} $.\n  - Target probability $ p = 0.1 $.\n  - Credible mass $ q = 0.95 $.\n\nImplementation constraints:\n- For each case, draw $(\\alpha,\\beta)$ from the specified bivariate normal distribution using the given seed. To ensure that the number of retained samples is equal to $ N $ after discarding draws with $ \\beta \\le 0 $, you may oversample in batches until $ N $ valid draws are obtained.\n- For each case, compute the sample median of the $ ED_{p} $ posterior and the $ q $-mass HPD interval $[L,U]$ as defined above.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is itself a list of three floats $[m, L, U]$ denoting the median $ m $, HPD lower bound $ L $, and HPD upper bound $ U $ of $ ED_{p} $ in $\\mathrm{mg/kg}$. The line must have the exact format:\n  - $ [[m_{A},L_{A},U_{A}],[m_{B},L_{B},U_{B}],[m_{C},L_{C},U_{C}]] $.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in established principles of pharmacological dose-response modeling and Bayesian statistics, is mathematically and computationally well-posed, and is specified with objective, unambiguous language. All necessary parameters and data for a unique, reproducible solution are provided. The covariance matrix for Case C is singular, implying perfect correlation between the parameters, which represents a valid (though degenerate) bivariate normal distribution that is computationally tractable.\n\nThe solution proceeds as follows, based on fundamental principles of statistical modeling and posterior analysis.\n\n**1. Theoretical Framework of the Log-Dose Logistic Model**\n\nThe problem specifies a quantal dose-response relationship governed by a log-dose logistic model. The probability $P$ of a response at a given dose $d > 0$ is modeled as:\n$$\n\\operatorname{logit}(P(Y=1 \\mid d)) = \\alpha + \\beta \\ln(d)\n$$\nwhere $\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)$ is the logit function. The parameters $\\alpha$ and $\\beta$ represent the intercept and the slope on the log-dose scale, respectively. A positive slope, $\\beta > 0$, is pharmacologically realistic, signifying that the probability of response increases with dose.\n\nThe effective dose, $ED_p$, is defined as the dose that elicits a response with a specific target probability $p \\in (0, 1)$. To derive an expression for $ED_p$, we set $P(Y=1 \\mid d) = p$ and solve for $d$:\n$$\n\\operatorname{logit}(p) = \\alpha + \\beta \\ln(ED_p)\n$$\nRearranging the terms to solve for $\\ln(ED_p)$:\n$$\n\\beta \\ln(ED_p) = \\operatorname{logit}(p) - \\alpha\n$$\nProvided that $\\beta \\neq 0$, we can write:\n$$\n\\ln(ED_p) = \\frac{\\operatorname{logit}(p) - \\alpha}{\\beta}\n$$\nExponentiating both sides yields the deterministic transformation from the model parameters $(\\alpha, \\beta)$ to the effective dose $ED_p$:\n$$\nED_p = \\exp\\left(\\frac{\\operatorname{logit}(p) - \\alpha}{\\beta}\\right)\n$$\nThis transformation is central to the solution. The problem's constraint to discard posterior samples where $\\beta \\le 0$ ensures the denominator is strictly positive, leading to a well-defined, positive $ED_p$.\n\n**2. Bayesian Posterior Analysis by Sample Transformation**\n\nThe problem adopts a Bayesian framework where the uncertainty in the parameters $(\\alpha, \\beta)$ is captured by a posterior probability distribution. We are given that samples from this posterior distribution are to be generated from a specified bivariate normal distribution, $(\\alpha, \\beta) \\sim N(\\boldsymbol{\\mu}, \\Sigma)$.\n\nThe core of the method is the principle of transformation of posterior samples. If we have a set of $N$ random draws $\\{(\\alpha_i, \\beta_i)\\}_{i=1}^N$ from the posterior distribution of the parameters, we can obtain a set of $N$ draws $\\{ED_{p,i}\\}_{i=1}^N$ from the posterior distribution of the derived quantity $ED_p$ by applying the derived transformation to each sample:\n$$\nED_{p,i} = \\exp\\left(\\frac{\\operatorname{logit}(p) - \\alpha_i}{\\beta_i}\\right)\n$$\nThis process yields an empirical representation of the posterior distribution for $ED_p$, which can then be summarized.\n\n**3. Generation of Valid Posterior Samples**\n\nFor each test case, we are required to generate a specific number, $N$, of valid posterior samples. The process is as follows:\n1. Initialize a random number generator with a given seed for reproducibility.\n2. Draw samples of $(\\alpha, \\beta)$ from the specified bivariate normal distribution, $N((\\mu_\\alpha, \\mu_\\beta), \\Sigma)$.\n3. Apply the pharmacological constraint by retaining only those samples for which $\\beta > 0$.\n4. Repeat this sampling and filtering process, potentially in batches, until exactly $N$ valid samples have been collected.\n\n**4. Summarization of the $ED_p$ Posterior Distribution**\n\nOnce the $N$ samples of $ED_p$ are generated, we compute two summary statistics:\n\n**a. Sample Median:**\nThe median is a measure of central tendency. For the sorted posterior samples of the effective dose, denoted $edp_{(1)}, edp_{(2)}, \\dots, edp_{(N)}$, the sample median is the value that separates the lower half from the upper half of the distribution. It is calculated as the $50^{th}$ percentile of the samples.\n\n**b. Highest Posterior Density (HPD) Interval:**\nAn HPD interval is a type of credible interval that is, by definition, the shortest possible interval for a given credible mass $q$. For a posterior distribution represented by samples, the $q$-mass HPD interval is computed algorithmically:\n1. Sort the $N$ posterior samples of $ED_p$ in ascending order: $edp_{(1)} \\le edp_{(2)} \\le \\dots \\le edp_{(N)}$.\n2. Determine the number of samples to be contained within the interval: $k = \\lfloor qN \\rfloor$.\n3. Consider all possible intervals of the form $[edp_{(i)}, edp_{(i+k)}]$ for $i = 1, 2, \\dots, N-k$.\n4. Calculate the width of each interval, $w_i = edp_{(i+k)} - edp_{(i)}$.\n5. The HPD interval is the specific interval $[L, U] = [edp_{(j)}, edp_{(j+k)}]$ for which the width $w_j$ is minimized. This interval represents the region of highest probability density containing a proportion $q$ of the posterior mass.\n\nThis complete procedure is applied to each of the three test cases specified, using their respective parameters, to generate the final results.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import logit\n\ndef solve():\n    \"\"\"\n    Solves the quantal dose-response problem for three test cases.\n\n    For each case, it generates posterior samples for (alpha, beta),\n    filters them based on beta > 0, transforms them to EDp samples,\n    and then computes the median and Highest Posterior Density (HPD) interval.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"seed\": 17,\n            \"N\": 4000,\n            \"mean_vec\": np.array([-1.2, 1.0]),\n            \"cov_mat\": np.array([[0.15**2, -0.015], [-0.015, 0.12**2]]),\n            \"p\": 0.5,\n            \"q\": 0.95\n        },\n        {\n            \"name\": \"Case B\",\n            \"seed\": 123,\n            \"N\": 2500,\n            \"mean_vec\": np.array([0.4, 0.6]),\n            \"cov_mat\": np.array([[0.25**2, -0.02], [-0.02, 0.18**2]]),\n            \"p\": 0.9,\n            \"q\": 0.90\n        },\n        {\n            \"name\": \"Case C\",\n            \"seed\": 7,\n            \"N\": 5000,\n            \"mean_vec\": np.array([-2.0, 0.8]),\n            \"cov_mat\": np.array([[0.2**2, -0.03], [-0.03, 0.15**2]]),\n            \"p\": 0.1,\n            \"q\": 0.95\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        seed = case[\"seed\"]\n        N = case[\"N\"]\n        mean_vec = case[\"mean_vec\"]\n        cov_mat = case[\"cov_mat\"]\n        p = case[\"p\"]\n        q = case[\"q\"]\n\n        # 1. Generate N valid posterior samples for (alpha, beta)\n        rng = np.random.default_rng(seed)\n        valid_samples = np.empty((0, 2))\n        \n        while valid_samples.shape[0]  N:\n            num_needed = N - valid_samples.shape[0]\n            # Oversample to efficiently gather the required number of valid samples.\n            # A factor of 1.2 should be sufficient as P(beta=0) is low.\n            # Add a small constant to avoid very small batch sizes.\n            batch_size = int(num_needed * 1.2) + 50\n            \n            draws = rng.multivariate_normal(mean_vec, cov_mat, size=batch_size, check_valid='warn')\n            \n            # Filter samples to enforce the pharmacological constraint beta > 0\n            retained_draws = draws[draws[:, 1] > 0]\n            \n            if valid_samples.shape[0] == 0:\n                valid_samples = retained_draws\n            else:\n                valid_samples = np.vstack([valid_samples, retained_draws])\n\n        # Truncate to exactly N samples\n        alpha_beta_samples = valid_samples[:N, :]\n\n        # 2. Transform samples to the EDp scale\n        logit_p = logit(p)\n        alphas = alpha_beta_samples[:, 0]\n        betas = alpha_beta_samples[:, 1]\n        edp_samples = np.exp((logit_p - alphas) / betas)\n\n        # 3. Compute the sample median\n        median_edp = np.median(edp_samples)\n\n        # 4. Compute the q-mass Highest Posterior Density (HPD) interval\n        sorted_edp = np.sort(edp_samples)\n        \n        # Number of samples in the interval\n        k = int(np.floor(q * N))\n        \n        # There are N - k possible intervals of the form [x_i, x_{i+k}]\n        # We want to find the one with the minimum width.\n        num_intervals = N - k\n        \n        # Calculate widths of all possible intervals in a vectorized way\n        widths = sorted_edp[k:] - sorted_edp[:num_intervals]\n        \n        # Find the index of the interval with the minimum width\n        min_width_idx = np.argmin(widths)\n        \n        # The HPD interval is the one starting at this index\n        hpd_lower = sorted_edp[min_width_idx]\n        hpd_upper = sorted_edp[min_width_idx + k]\n\n        all_results.append([median_edp, hpd_lower, hpd_upper])\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}