{
    "hands_on_practices": [
        {
            "introduction": "药物警戒分析的核心任务之一是从自发呈报系统 (Spontaneous Reporting System, SRS) 的海量数据中识别潜在的药物不良事件信号。为了量化特定药物与特定不良事件之间的报告关联强度，我们通常使用 $2 \\times 2$ 列联表进行不成比例分析。本练习将指导您计算两种最基本且重要的不成比例衡量指标：报告比例比 (Proportional Reporting Ratio, PRR) 和报告比值比 (Reporting Odds Ratio, ROR)，并理解它们的统计学意义。",
            "id": "4978934",
            "problem": "一名药品警戒监管分析师正在评估一个国家自发报告系统 (SRS) 中关于某个潜在不良事件的不成比例信号。一个 $2 \\times 2$ 列联表由以下计数构成：$a$ 为关注药物出现该不良事件的报告数，$b$ 为同一药物出现其他事件的报告数，$c$ 为所有其他药物出现该不良事件的报告数，以及 $d$ 为所有其他药物出现其他事件的报告数。分析师将概率（风险即比例）和比值的核心定义应用于这个 $2 \\times 2$ 结构，计算报告比例比 (PRR) 和报告比值比 (ROR) 作为不成比例性的度量指标。在大样本正态近似下，Woolf 方法将每个度量指标的自然对数视为近似服从正态分布；对于比值比，其对数的方差是各单元格计数的倒数之和，而对于比例之比，其对数的方差可以通过 delta 方法从二项模型中推导出来。\n\n对于数据集 $a = 45$，$b = 155$，$c = 120$ 和 $d = 7{,}680$，计算：\n- PRR 和 ROR，\n- 每个度量指标自然对数的标准误，\n- 每个度量指标在原始（比值）尺度上的 $95\\%$ 置信区间。\n\n最后，判断每个置信区间的下限是否超过 $1$，如果超过则记为 $1$，否则记为 $0$。将所有结果表示为无量纲的小数，并将您的数值四舍五入到三位有效数字。在您的最终数值报告中，按以下顺序排列条目：PRR, $\\mathrm{SE}(\\ln(\\mathrm{PRR}))$, $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{PRR})$, $\\mathrm{CI}_{\\mathrm{U}}(\\mathrm{PRR})$, ROR, $\\mathrm{SE}(\\ln(\\mathrm{ROR}))$, $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{ROR})$, $\\mathrm{CI}_{\\mathrm{U}}(\\mathrm{ROR})$, PRR 的指示符，ROR 的指示符。",
            "solution": "该问题要求根据一个 $2 \\times 2$ 计数表，计算药品警戒中的两个不成比例性度量指标：报告比例比 (PRR) 和报告比值比 (ROR)，以及它们各自的 $95\\%$ 置信区间和相关统计量。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n提供了 $2 \\times 2$ 列联表的计数：\n- $a = 45$：关注药物出现该不良事件的报告数。\n- $b = 155$：关注药物出现其他事件的报告数。\n- $c = 120$：所有其他药物出现该不良事件的报告数。\n- $d = 7{,}680$：所有其他药物出现其他事件的报告数。\n\n问题还描述了分析方法：\n- 报告比例比 (PRR) 是比例之比。\n- 报告比值比 (ROR) 是比值之比。\n- 这些度量指标的自然对数被视为近似服从正态分布。\n- $\\ln(\\mathrm{ROR})$ 的方差由 Woolf 方法给出，为各单元格计数的倒数之和。\n- $\\ln(\\mathrm{PRR})$ 的方差使用 delta 方法从二项模型推导得出。\n- 指定了区间的置信水平为 $95\\%$。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据，是药物流行病学和药品警戒中使用的生物统计方法的标准应用。这些度量指标 (PRR, ROR) 和统计技术 (Woolf 方法, delta 方法, 对数尺度上的置信区间) 是成熟且适用的，适合分析自发报告数据。该问题提法得当，因为它提供了所有必要的数据 ($a, b, c, d$) 并明确了要计算的确切量。语言客观精确。该问题不违反任何无效标准。\n\n**1.3. 结论与行动**\n问题有效。将提供完整解答。\n\n### 步骤 2：求解推导\n\n分析基于以下 $2 \\times 2$ 表格结构：\n\n|                   | 不良事件 | 其他事件  | 合计         |\n|-------------------|:-------------:|:-------------:|:-------------:|\n| **关注药物** |      $a$      |      $b$      |     $a+b$     |\n| **其他药物**    |      $c$      |      $d$      |     $c+d$     |\n| **合计**          |      $a+c$    |      $b+d$    | $N=a+b+c+d$ |\n\n给定值为 $a=45$，$b=155$，$c=120$ 和 $d=7{,}680$。\n我们首先计算行合计：\n- 关注药物的总报告数：$n_1 = a+b = 45 + 155 = 200$。\n- 其他药物的总报告数：$n_2 = c+d = 120 + 7{,}680 = 7{,}800$。\n\n**报告比例比 (PRR)**\n\nPRR 是关注药物的不良事件报告比例与所有其他药物的不良事件报告比例之比。\n$$ \\mathrm{PRR} = \\frac{P_1}{P_2} = \\frac{a/(a+b)}{c/(c+d)} $$\n代入数值：\n$$ \\mathrm{PRR} = \\frac{45/200}{120/7{,}800} = \\frac{0.225}{0.0153846...} = 14.625 $$\n四舍五入到三位有效数字，$\\mathrm{PRR} = 14.6$。\n\nPRR 自然对数的标准误使用 delta 方法推导。$\\ln(\\mathrm{PRR})$ 的方差由下式给出：\n$$ \\mathrm{Var}(\\ln(\\mathrm{PRR})) = \\frac{1}{a} - \\frac{1}{a+b} + \\frac{1}{c} - \\frac{1}{c+d} = \\frac{b}{a(a+b)} + \\frac{d}{c(c+d)} $$\n标准误是方差的平方根：\n$$ \\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{\\frac{b}{a(a+b)} + \\frac{d}{c(c+d)}} $$\n代入数值：\n$$ \\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{\\frac{155}{45(200)} + \\frac{7{,}680}{120(7{,}800)}} = \\sqrt{\\frac{155}{9{,}000} + \\frac{7{,}680}{936{,}000}} $$\n$$ \\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{0.017222... + 0.008205...} = \\sqrt{0.025427...} = 0.159459... $$\n四舍五入到三位有效数字，$\\mathrm{SE}(\\ln(\\mathrm{PRR})) = 0.159$。\n\nPRR 的 $95\\%$ 置信区间在对数尺度上计算，然后取指数。$95\\%$ CI 的临界值为 $z_{0.975} \\approx 1.96$。\n对数尺度上的置信区间为 $\\ln(\\mathrm{PRR}) \\pm z_{0.975} \\times \\mathrm{SE}(\\ln(\\mathrm{PRR}))$。\n$$ \\ln(14.625) = 2.6828... $$\n误差范围：$1.96 \\times 0.159459... = 0.31254...$\n下限（对数尺度）：$2.6828 - 0.31254 = 2.37026...$\n上限（对数尺度）：$2.6828 + 0.31254 = 2.99534...$\n取指数以获得原始尺度上的置信区间：\n$$ \\mathrm{CI}_{\\mathrm{L}}(\\mathrm{PRR}) = \\exp(2.37026...) = 10.700... $$\n$$ \\mathrm{CI}_{\\mathrm{U}}(\\mathrm{PRR}) = \\exp(2.99534...) = 19.991... $$\n四舍五入到三位有效数字，PRR 的 $95\\%$ 置信区间为 $[10.7, 20.0]$。\n\n下限 $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{PRR}) = 10.7$ 大于 $1$。因此，指示符为 $1$。\n\n**报告比值比 (ROR)**\n\nROR 是关注药物发生不良事件的比值与所有其他药物发生不良事件的比值之比。\n$$ \\mathrm{ROR} = \\frac{\\text{Odds}_1}{\\text{Odds}_2} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n代入数值：\n$$ \\mathrm{ROR} = \\frac{45 \\times 7{,}680}{155 \\times 120} = \\frac{345{,}600}{18{,}600} = 18.5806... $$\n四舍五入到三位有效数字，$\\mathrm{ROR} = 18.6$。\n\nROR 自然对数的标准误由 Woolf 方法给出。方差为：\n$$ \\mathrm{Var}(\\ln(\\mathrm{ROR})) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d} $$\n标准误是方差的平方根：\n$$ \\mathrm{SE}(\\ln(\\mathrm{ROR})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}} $$\n代入数值：\n$$ \\mathrm{SE}(\\ln(\\mathrm{ROR})) = \\sqrt{\\frac{1}{45} + \\frac{1}{155} + \\frac{1}{120} + \\frac{1}{7{,}680}} $$\n$$ \\mathrm{SE}(\\ln(\\mathrm{ROR})) = \\sqrt{0.022222... + 0.006451... + 0.008333... + 0.000130...} = \\sqrt{0.037137...} = 0.192709... $$\n四舍五入到三位有效数字，$\\mathrm{SE}(\\ln(\\mathrm{ROR})) = 0.193$。\n\nROR 的 $95\\%$ 置信区间以类似方式计算。\n$$ \\ln(18.5806...) = 2.9221... $$\n误差范围：$1.96 \\times 0.192709... = 0.37771...$\n下限（对数尺度）：$2.9221 - 0.37771 = 2.5444...$\n上限（对数尺度）：$2.9221 + 0.37771 = 3.2998...$\n取指数以获得原始尺度上的置信区间：\n$$ \\mathrm{CI}_{\\mathrm{L}}(\\mathrm{ROR}) = \\exp(2.5444...) = 12.735... $$\n$$ \\mathrm{CI}_{\\mathrm{U}}(\\mathrm{ROR}) = \\exp(3.2998...) = 27.107... $$\n四舍五入到三位有效数字，ROR 的 $95\\%$ 置信区间为 $[12.7, 27.1]$。\n\n下限 $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{ROR}) = 12.7$ 大于 $1$。因此，指示符为 $1$。\n\n### 结果总结\n\n- PRR：$14.6$\n- $\\mathrm{SE}(\\ln(\\mathrm{PRR}))$：$0.159$\n- $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{PRR})$：$10.7$\n- $\\mathrm{CI}_{\\mathrm{U}}(\\mathrm{PRR})$：$20.0$\n- ROR：$18.6$\n- $\\mathrm{SE}(\\ln(\\mathrm{ROR}))$：$0.193$\n- $\\mathrm{CI}_{\\mathrm{L}}(\\mathrm{ROR})$：$12.7$\n- $\\mathrm{CI}_{\\mathrm{U}}(\\mathrm{ROR})$：$27.1$\n- PRR 的指示符：$1$\n- ROR 的指示符：$1$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 14.6  0.159  10.7  20.0  18.6  0.193  12.7  27.1  1  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在计算报告比值比 (ROR) 时，我们可能会遇到一个常见的实际问题：当某个药物与事件组合的报告数为零时（即 $a=0$），标准公式会因涉及零的乘法或除法而失效。为了解决这个问题并获得稳定且有意义的估计值，统计学家提出了连续性校正方法。本练习将向您介绍 Haldane–Anscombe 修正法，即为每个单元格计数加上 $0.5$，并演示如何应用它来处理零计数数据，从而计算出经过校正的 ROR。",
            "id": "4979009",
            "problem": "一个自发报告数据库被用于筛查某一目标药物与某一不良事件之间是否存在不成比例的报告。设 $2 \\times 2$ 列联表的单元格计数定义如下：$a$ 是同时提及目标药物和目标事件的报告数量，$b$ 是提及目标药物与任何其他事件的报告数量，$c$ 是提及任何其他药物与目标事件的报告数量，以及 $d$ 是提及任何其他药物与任何其他事件的报告数量。报告比值比（ROR）从第一性原理定义为目标药物发生该事件的报告比值与所有其他药物发生该事件的报告比值之比。从比值（odds）的定义（即某一结果的概率与其补集概率之比）出发，推导出 ROR 关于 $a$、$b$、$c$ 和 $d$ 的表达式。然后，解释为什么零单元格计数（例如，$a = 0$）会在此模型下给估计和推断带来问题，并以此引出 Haldane–Anscombe 修正，该修正将每个单元格的计数值加上 $0.5$。\n\n对于数据 $a = 0$，$b = 40$，$c = 25$ 和 $d = 10{,}000$，应用 Haldane–Anscombe 修正并计算修正后的报告比值比。将你的答案四舍五入至 $4$ 位有效数字。将最终的比值表示为一个纯数（无单位）。",
            "solution": "这是一个药物警戒领域中的不成比例分析，其中比较了目标药物与所有其他药物相比，某一事件的报告比值。其基本原理是比值（odds）的定义：对于任何概率为 $p$ 的二元结果，其比值为 $p/(1-p)$。在一个由大型自发报告数据库创建的 $2 \\times 2$ 计数表中，给定暴露情况下事件的经验比值可以计算为该暴露层内事件计数与非事件计数之比。\n\n设该表的排列方式为：行为暴露（$\\text{目标药物}$ vs. $\\text{其他药物}$），列为结果（$\\text{目标事件}$ vs. $\\text{其他事件}$）。计数如下：\n- 目标药物和事件：$a$。\n- 目标药物和其他事件：$b$。\n- 其他药物和事件：$c$。\n- 其他药物和其他事件：$d$。\n\n根据比值为 $p/(1-p)$ 的定义，并用每个暴露层中的经验比例代替概率，在涉及目标药物的报告中，事件的比值为\n$$\n\\text{odds}_{\\text{drug}} = \\frac{a/(a+b)}{b/(a+b)} = \\frac{a}{b}.\n$$\n类似地，在涉及其他药物的报告中，事件的比值为\n$$\n\\text{odds}_{\\text{other}} = \\frac{c/(c+d)}{d/(c+d)} = \\frac{c}{d}.\n$$\n报告比值比（ROR）是这两个比值的比率：\n$$\n\\text{ROR} = \\frac{\\text{odds}_{\\text{drug}}}{\\text{odds}_{\\text{other}}} = \\frac{a/b}{c/d} = \\frac{a d}{b c}.\n$$\n\n零单元格计数会导致众所周知的问题。如果 $a = 0$，药物暴露层中的经验比值为 $\\text{odds}_{\\text{drug}} = 0/b = 0$，从而得到 $\\text{ROR} = 0$。虽然可以计算出零的点估计值，但标准的推断量会变得退化：ROR 的对数 $\\ln(\\text{ROR})$ 涉及 $\\ln(a)$，而它在 $a = 0$ 时是未定义的。此外，$\\ln(\\text{ROR})$ 的通常大样本方差公式，即\n$$\n\\operatorname{Var}\\!\\left(\\ln(\\text{ROR})\\right) \\approx \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d},\n$$\n会因为 $1/a$ 在 $a = 0$ 时无界而发散。这促使我们使用连续性修正来避免零计数。Haldane–Anscombe 修正为每个单元格加上 $0.5$，即用 $(a+0.5,\\,b+0.5,\\,c+0.5,\\,d+0.5)$ 替换 $(a,b,c,d)$。即使某些观测计数为零，这种方法也能为 $\\text{ROR}$ 及其对数产生有限且稳定的估计值。\n\n对于给定的数据 $a = 0$，$b = 40$，$c = 25$ 和 $d = 10{,}000$，修正后的计数为\n$$\na' = a + 0.5 = 0.5,\\quad b' = b + 0.5 = 40.5,\\quad c' = c + 0.5 = 25.5,\\quad d' = d + 0.5 = 10{,}000.5.\n$$\n经过 Haldane–Anscombe 修正的 ROR 是\n$$\n\\text{ROR}_{\\text{HA}} = \\frac{a' d'}{b' c'} = \\frac{(0.5)(10{,}000.5)}{(40.5)(25.5)}.\n$$\n计算分子：\n$$\n(0.5)(10{,}000.5) = 5{,}000.25.\n$$\n计算分母：\n$$\n(40.5)(25.5) = 1{,}032.75.\n$$\n因此，\n$$\n\\text{ROR}_{\\text{HA}} = \\frac{5{,}000.25}{1{,}032.75}.\n$$\n为了进行数值计算，注意到将分子和分母都乘以 $4$ 可得\n$$\n\\text{ROR}_{\\text{HA}} = \\frac{20{,}001}{4{,}131} \\approx 4.8416848\\ldots\n$$\n四舍五入到 $4$ 位有效数字，得到\n$$\n\\text{ROR}_{\\text{HA}} \\approx 4.842.\n$$\n这个值展示了 Haldane–Anscombe 修正的影响：当 $a = 0$ 时，朴素的点估计 $\\text{ROR} = 0$ 对于不成比例性分析没有提供信息，而修正后的估计值则反映了相对的报告结构，同时使得对数和方差能够进行有限计算以用于推断。",
            "answer": "$$\\boxed{4.842}$$"
        },
        {
            "introduction": "现代药物警戒实践通常涉及同时对数千个“药物-事件”组合进行自动化筛选，这导致了“多重比较”问题。如果对每次检验都使用传统的显著性水平（例如 $p \\lt 0.05$），将会产生大量的假阳性信号，即假发现 (false discoveries)。本练习将介绍由 Benjamini 和 Hochberg 提出的控制假发现率 (False Discovery Rate, FDR) 的方法，这是一种在保持发现能力的同时严格控制错误信号比例的强大统计工具。",
            "id": "4978956",
            "problem": "一个药物警戒团队正在使用一个以国际医学用语词典 (MedDRA) 编码的大型观察性数据库，评估一种新上市抗凝剂的潜在药物不良反应信号。对于 $m=10$ 个预定义的药物不良事件类别中的每一个，该团队都进行了一项假设检验，将药物暴露期间的观测事件数与基于背景发生率的期望事件数进行比较，获得了排序后的p值：$0.001, 0.006, 0.012, 0.02, 0.04, 0.06, 0.08, 0.12, 0.20, 0.40$。目标是使用 Benjamini–Hochberg (BH) 程序将错误发现率 (FDR) 控制在 $q=0.05$ 的水平。错误发现率定义为在所有被拒绝的零假设中，错误拒绝的零假设所占的期望比例。\n\n从假设检验的核心定义和多重检验中FDR控制的概念出发，使用 Benjamini–Hochberg (BH) 程序来确定哪些假设被拒绝，并计算所有 $m=10$ 个检验的BH校正p值。作为最终的数值输出，报告在FDR水平 $q=0.05$ 下，根据BH程序被拒绝的假设总数。最终数值答案无需四舍五入。",
            "solution": "该问题陈述是在药物流行病学和药物警戒中一个常见场景下对统计方法的有效且适定的应用。它提供了所有必要的数据和明确的目标，并以成熟的统计理论为基础。\n\n核心问题是多重假设检验。当同时进行 $m$ 个假设检验时，若对每个检验独立使用常规的显著性水平 $\\alpha$（例如，如果 $p \\le \\alpha$ 就拒绝零假设），会导致总体第一类错误率的膨胀。例如，做出至少一次错误拒绝的概率，即族系错误率 (FWER)，会随着检验数量的增加而增加。在药物警戒等大规模筛选中，控制FWER通常过于保守，可能导致遗漏真实的信号。\n\n一种替代方法是控制错误发现率 (FDR)，它被定义为所有拒绝的假设中错误拒绝（第一类错误）所占的期望比例。设 $V$ 为被错误拒绝的真实零假设的数量（错误发现），设 $R$ 为被拒绝的假设总数。错误发现比例 (FDP) 为 $FDP = V/R$（如果 $R=0$，则 $FDP=0$）。FDR是该量的期望值：$FDR = E[FDP]$。Benjamini–Hochberg (BH) 程序是一种标准方法，可以保证 $FDR \\le q$，其中 $q$ 是期望的控制水平。\n\n问题给出了以下已知条件：\n- 假设检验的总数：$m = 10$。\n- 期望的FDR控制水平：$q = 0.05$。\n- $m$ 个p值，已按升序排列：$p_{(1)} = 0.001$, $p_{(2)} = 0.006$, $p_{(3)} = 0.012$, $p_{(4)} = 0.02$, $p_{(5)} = 0.04$, $p_{(6)} = 0.06$, $p_{(7)} = 0.08$, $p_{(8)} = 0.12$, $p_{(9)} = 0.20$, $p_{(10)} = 0.40$。\n\nBH程序如下：\n1.  设排序后的p值为 $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n2.  找到最大的整数索引 $k$（其中 $1 \\le k \\le m$），使得对应的排序后p值 $p_{(k)}$ 满足不等式：\n    $$p_{(k)} \\le \\frac{k}{m}q$$\n3.  如果存在这样的 $k$，则拒绝与p值 $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$ 对应的零假设 $H_{(1)}, H_{(2)}, \\dots, H_{(k)}$。如果不存在这样的 $k$，则不拒绝任何零假设。\n\n我们将此程序应用于给定的数据。我们必须对从1到10的每个索引 $i$ 检查不等式。\n\n对于 $i=1$：$p_{(1)} = 0.001$。BH阈值为 $\\frac{1}{10} \\times 0.05 = 0.005$。因为 $0.001 \\le 0.005$，所以条件满足。\n对于 $i=2$：$p_{(2)} = 0.006$。BH阈值为 $\\frac{2}{10} \\times 0.05 = 0.010$。因为 $0.006 \\le 0.010$，所以条件满足。\n对于 $i=3$：$p_{(3)} = 0.012$。BH阈值为 $\\frac{3}{10} \\times 0.05 = 0.015$。因为 $0.012 \\le 0.015$，所以条件满足。\n对于 $i=4$：$p_{(4)} = 0.02$。BH阈值为 $\\frac{4}{10} \\times 0.05 = 0.020$。因为 $0.02 \\le 0.020$，所以条件满足。\n对于 $i=5$：$p_{(5)} = 0.04$。BH阈值为 $\\frac{5}{10} \\times 0.05 = 0.025$。因为 $0.04 > 0.025$，所以条件不满足。\n对于 $i=6$：$p_{(6)} = 0.06$。BH阈值为 $\\frac{6}{10} \\times 0.05 = 0.030$。因为 $0.06 > 0.030$，所以条件不满足。\n对于 $i=7$：$p_{(7)} = 0.08$。BH阈值为 $\\frac{7}{10} \\times 0.05 = 0.035$。因为 $0.08 > 0.035$，所以条件不满足。\n对于 $i=8$：$p_{(8)} = 0.12$。BH阈值为 $\\frac{8}{10} \\times 0.05 = 0.040$。因为 $0.12 > 0.040$，所以条件不满足。\n对于 $i=9$：$p_{(9)} = 0.20$。BH阈值为 $\\frac{9}{10} \\times 0.05 = 0.045$。因为 $0.20 > 0.045$，所以条件不满足。\n对于 $i=10$：$p_{(10)} = 0.40$。BH阈值为 $\\frac{10}{10} \\times 0.05 = 0.050$。因为 $0.40 > 0.050$，所以条件不满足。\n\n满足 $p_{(k)} \\le \\frac{k}{m}q$ 的最大索引 $k$ 是 $k=4$。因此，根据BH程序，我们拒绝与四个最小p值 $p_{(1)}, p_{(2)}, p_{(3)},$ 和 $p_{(4)}$ 对应的零假设。被拒绝的假设总数为 $4$。\n\n问题还要求计算BH校正p值。第 $i$ 个排序检验的校正p值 $p_{(i)}^{adj}$，可以解释为在该检验会被宣布为显著的最小FDR水平 $q$。它是为每个排序后的p值 $p_{(i)}$ 计算的，并强制保持单调性。第 $i$ 个校正p值的公式是：\n$$p_{(i)}^{adj} = \\min_{j=i, \\dots, m} \\left( \\min \\left( 1, \\frac{m}{j} p_{(j)} \\right) \\right)$$\n一个实用的计算方法是，首先计算中间值 $p}_{(i)}' = \\frac{m}{i} p_{(i)}$（对于 $i=1, \\dots, m$），然后通过从后向前取累积最小值来强制其非递减顺序。\n让我们为每个 $i$ 计算 $p_{(i)}' = \\frac{10}{i} p_{(i)}$：\n$p_{(10)}' = \\frac{10}{10}(0.40) = 0.40$\n$p_{(9)}' = \\frac{10}{9}(0.20) = \\frac{2}{9} \\approx 0.222$\n$p_{(8)}' = \\frac{10}{8}(0.12) = 0.15$\n$p_{(7)}' = \\frac{10}{7}(0.08) = \\frac{0.8}{7} \\approx 0.114$\n$p_{(6)}' = \\frac{10}{6}(0.06) = 0.10$\n$p_{(5)}' = \\frac{10}{5}(0.04) = 0.08$\n$p_{(4)}' = \\frac{10}{4}(0.02) = 0.05$\n$p_{(3)}' = \\frac{10}{3}(0.012) = 0.04$\n$p_{(2)}' = \\frac{10}{2}(0.006) = 0.03$\n$p_{(1)}' = \\frac{10}{1}(0.001) = 0.01$\n\n现在我们强制执行单调性。令 $p_{(i)}^{adj} = \\min(p_{(i+1)}^{adj}, p_{(i)}')$（对于 $i=m-1, \\dots, 1$），从 $p_{(m)}^{adj} = p_{(m)}'$ 开始。\n$p_{(10)}^{adj} = p_{(10)}' = 0.40$\n$p_{(9)}^{adj} = \\min(p_{(10)}^{adj}, p_{(9)}') = \\min(0.40, \\frac{2}{9}) = \\frac{2}{9}$\n$p_{(8)}^{adj} = \\min(p_{(9)}^{adj}, p_{(8)}') = \\min(\\frac{2}{9}, 0.15) = 0.15$\n$p_{(7)}^{adj} = \\min(p_{(8)}^{adj}, p_{(7)}') = \\min(0.15, \\frac{0.8}{7}) = \\frac{0.8}{7} = \\frac{4}{35}$\n$p_{(6)}^{adj} = \\min(p_{(7)}^{adj}, p_{(6)}') = \\min(\\frac{4}{35}, 0.10) = 0.10$\n$p_{(5)}^{adj} = \\min(p_{(6)}^{adj}, p_{(5)}') = \\min(0.10, 0.08) = 0.08$\n$p_{(4)}^{adj} = \\min(p_{(5)}^{adj}, p_{(4)}') = \\min(0.08, 0.05) = 0.05$\n$p_{(3)}^{adj} = \\min(p_{(4)}^{adj}, p_{(3)}') = \\min(0.05, 0.04) = 0.04$\n$p_{(2)}^{adj} = \\min(p_{(3)}^{adj}, p_{(2)}') = \\min(0.04, 0.03) = 0.03$\n$p_{(1)}^{adj} = \\min(p_{(2)}^{adj}, p_{(1)}') = \\min(0.03, 0.01) = 0.01$\n\n完整的BH校正p值集合是：\n$p_{(1)}^{adj}=0.01, p_{(2)}^{adj}=0.03, p_{(3)}^{adj}=0.04, p_{(4)}^{adj}=0.05, p_{(5)}^{adj}=0.08, p_{(6)}^{adj}=0.10, p_{(7)}^{adj}=\\frac{4}{35}, p_{(8)}^{adj}=0.15, p_{(9)}^{adj}=\\frac{2}{9}, p_{(10)}^{adj}=0.40$。\n\n使用这些校正p值，拒绝规则是拒绝所有满足 $p_{(i)}^{adj} \\le q$ 的假设。当 $q=0.05$ 时，我们拒绝与 $p_{(1)}, p_{(2)}, p_{(3)},$ 和 $p_{(4)}$ 对应的假设，因为它们的校正p值分别为 $0.01, 0.03, 0.04,$ 和 $0.05$，所有这些值都小于或等于 $0.05$。这证实了有 $4$ 个假设被拒绝。\n\n最终答案是被拒绝的假设总数。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}