{
    "hands_on_practices": [
        {
            "introduction": "单克隆抗体是无法轻易穿透组织的大分子，因此其在血液中的浓度并不能完全代表其在作用部位的浓度。本练习旨在引导你建立血浆药物浓度与组织间液（即药物靶点所在位置）药物浓度之间的定量联系，并进一步计算靶点结合率。通过这个实践，你将学会运用质量守恒和质量作用定律，将药代动力学（PK）中的药物分布与药效动力学（PD）中的靶点结合联系起来，这是理解生物制剂疗效的关键一步。",
            "id": "4957438",
            "problem": "长期施用一种针对白细胞介素-6 (IL-6) 的中和性单克隆抗体，使其血浆浓度达到不随时间变化的稳态。考虑一个双室生理模型，其中血浆和目标组织间质通过通透性限制的转运交换抗体。假设如下：\n\n- 间质是充分混合的，并且对于抗体转运处于稳态。\n- 血浆与间质之间的转运由通透性-表面积乘积描述，通透性-表面积乘积 (PS) 等于 $0.015$ $\\mathrm{L \\cdot h^{-1}}$。\n- 从间质的淋巴流出由一个清除率 $CL_{L}$ 描述，其值等于 $0.025$ $\\mathrm{L \\cdot h^{-1}}$。\n- 稳态血浆抗体浓度为 $C_{p} = 24.0$ $\\mathrm{mg \\cdot L^{-1}}$。\n- 抗体的分子量为 $MW = 150{,}000$ $\\mathrm{g \\cdot mol^{-1}}$。\n- 间质中抗体与 IL-6 的结合是快速且可逆的，解离常数为 $K_{d} = 3.0$ $\\mathrm{nM}$，并且 IL-6 浓度足够低，以至于因结合导致的抗体消耗可以忽略不计（将游离抗体浓度视为与间质中的总抗体浓度相等）。\n- IL-6 对抗体只有一个结合位点。\n\n从房室间转运的稳态质量守恒和平衡状态下结合的质量作用定律出发，推导间质抗体浓度，然后计算间质中被抗体结合的 IL-6 的比例。在结合计算中使用摩尔浓度；使用给定的分子量从质量浓度进行转换。将最终被结合的 IL-6 比例（靶点占有率）表示为无单位的小数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题描述了药代动力学和药效动力学中的一个有效情景。所有参数均已提供，且对于一个简化模型而言，这些假设在科学上是合理的。我们可以开始求解。\n\n首先，我们确定间质中抗体的稳态浓度，记为 $C_{i}$。这可以通过对间质房室应用质量守恒原理来实现。在稳态下，抗体质量流入间质的速率必须等于其流出速率。\n\n抗体从血浆到间质的净转运速率由通透性-表面积乘积 $PS$ 以及血浆 ($C_p$) 和间质 ($C_i$) 之间的浓度梯度描述。\n$$\n\\text{Rate of Influx} = PS \\cdot (C_{p} - C_{i})\n$$\n抗体通过淋巴引流从间质流出，这被建模为一个清除过程。流出速率是淋巴清除率 $CL_{L}$ 与间质浓度 $C_i$ 的乘积。\n$$\n\\text{Rate of Efflux} = CL_{L} \\cdot C_{i}\n$$\n在稳态下，流入速率等于流出速率：\n$$\nPS \\cdot (C_{p} - C_{i}) = CL_{L} \\cdot C_i\n$$\n我们重新整理这个方程以求解 $C_i$：\n$$\nPS \\cdot C_p - PS \\cdot C_i = CL_{L} \\cdot C_i\n$$\n$$\nPS \\cdot C_p = (PS + CL_{L}) \\cdot C_i\n$$\n$$\nC_i = \\frac{PS}{PS + CL_{L}} \\cdot C_p\n$$\n现在，我们代入给定值：$PS = 0.015$ $\\mathrm{L \\cdot h^{-1}}$，$CL_{L} = 0.025$ $\\mathrm{L \\cdot h^{-1}}$，以及 $C_p = 24.0$ $\\mathrm{mg \\cdot L^{-1}}$。\n$$\nC_i = \\frac{0.015}{0.015 + 0.025} \\cdot 24.0 = \\frac{0.015}{0.040} \\cdot 24.0 = 0.375 \\cdot 24.0 = 9.0 \\, \\mathrm{mg \\cdot L^{-1}}\n$$\n接下来，我们必须将此质量浓度转换为摩尔浓度以分析结合平衡。设 $[Ab]_i$ 代表间质中抗体的摩尔浓度。给定的分子量为 $MW = 150{,}000$ $\\mathrm{g \\cdot mol^{-1}}$。\n$$\nC_i = 9.0 \\, \\mathrm{mg \\cdot L^{-1}} = 9.0 \\times 10^{-3} \\, \\mathrm{g \\cdot L^{-1}}\n$$\n$$\n[Ab]_i = \\frac{C_i}{MW} = \\frac{9.0 \\times 10^{-3} \\, \\mathrm{g \\cdot L^{-1}}}{150{,}000 \\, \\mathrm{g \\cdot mol^{-1}}} = \\frac{9.0 \\times 10^{-3}}{1.5 \\times 10^{5}} \\, \\mathrm{mol \\cdot L^{-1}} = 6.0 \\times 10^{-8} \\, \\mathrm{mol \\cdot L^{-1}}\n$$\n所以，间质中抗体的摩尔浓度为 $[Ab]_i = 6.0 \\times 10^{-8}$ M。\n\n问题的第二部分是确定被抗体结合的 IL-6 的比例。结合反应为 $Ab + IL6 \\rightleftharpoons Ab \\cdot IL6$。解离常数 $K_d$ 由平衡状态下的质量作用定律定义：\n$$\nK_d = \\frac{[Ab]_{\\text{free}} [IL6]_{\\text{free}}}{[Ab \\cdot IL6]}\n$$\n被结合的 IL-6 的比例（我们记为 $f_b$）是结合复合物浓度与总 IL-6 浓度的比值。\n$$\nf_b = \\frac{[Ab \\cdot IL6]}{[IL6]_{\\text{total}}} = \\frac{[Ab \\cdot IL6]}{[IL6]_{\\text{free}} + [Ab \\cdot IL6]}\n$$\n从 $K_d$ 的表达式中，我们可以将 $[IL6]_{\\text{free}}$ 表示为 $K_d \\frac{[Ab \\cdot IL6]}{[Ab]_{\\text{free}}}$。将此式代入 $f_b$ 的方程中：\n$$\nf_b = \\frac{[Ab \\cdot IL6]}{K_d \\frac{[Ab \\cdot IL6]}{[Ab]_{\\text{free}}} + [Ab \\cdot IL6]}\n$$\n通过将分子和分母同除以 $[Ab \\cdot IL6]$，我们简化该表达式：\n$$\nf_b = \\frac{1}{\\frac{K_d}{[Ab]_{\\text{free}}} + 1} = \\frac{[Ab]_{\\text{free}}}{K_d + [Ab]_{\\text{free}}}\n$$\n问题陈述“因结合导致的抗体消耗可以忽略不计”。这是一个关键假设，这意味着游离抗体的浓度 $[Ab]_{\\text{free}}$ 实际上等于间质总抗体浓度 $[Ab]_i$。因此：\n$$\nf_b \\approx \\frac{[Ab]_i}{K_d + [Ab]_i}\n$$\n为了进行最终计算，我们必须使用一致的单位。给定的解离常数为 $K_d = 3.0$ nM。我们将计算出的间质抗体浓度转换为 nM：\n$$\n[Ab]_i = 6.0 \\times 10^{-8} \\, \\mathrm{M} = 60 \\times 10^{-9} \\, \\mathrm{M} = 60 \\, \\mathrm{nM}\n$$\n现在我们将 $[Ab]_i$ 和 $K_d$ 的值代入 $f_b$ 的方程：\n$$\nf_b = \\frac{60 \\, \\mathrm{nM}}{3.0 \\, \\mathrm{nM} + 60 \\, \\mathrm{nM}} = \\frac{60}{63}\n$$\n数值为：\n$$\nf_b = \\frac{60}{63} = \\frac{20}{21} \\approx 0.95238095...\n$$\n按照要求将结果四舍五入到四位有效数字，得到最终答案。",
            "answer": "$$\n\\boxed{0.9524}\n$$"
        },
        {
            "introduction": "生物疗法面临的一个核心挑战是免疫原性，即患者的免疫系统可能将治疗性蛋白识别为“外来物”并产生抗药物抗体（ADA）。这些抗体能够中和药物或加速其清除，从而导致疗效下降。本练习将引导你进入计算系统药理学的世界，通过建立并求解一个常微分方程组来模拟药物、抗药物抗体（ADA）以及它们形成的复合物之间的动态相互作用。通过这个实践，你将能够量化不同特征的ADA（如亲和力、产生速率）对药物暴露量的影响，并深刻理解免疫原性这一复杂且动态的临床难题。",
            "id": "4957487",
            "problem": "一种生物免疫调节剂可引发免疫球蛋白G（IgG）抗药抗体（anti-drug antibodies, ADA），这些抗体与药物结合并改变其药代动力学。考虑一个单一、均匀混合的房室，其中游离药物浓度为 $D(t)$，游离抗体浓度为 $A(t)$，药物-抗体复合物浓度为 $C(t)$，每个浓度均以任意浓度单位（a.u.）计量。结合过程遵循质量作用动力学，所有消除过程均为一级动力学。基本出发点是质量作用定律和一级衰减，应用于可逆结合反应 $D + A \\rightleftharpoons C$（其正向速率常数为 $k_{\\mathrm{on}}$，逆向速率常数为 $k_{\\mathrm{off}}$），以及游离药物、游离抗体和复合物的独立一级消除。\n\n根据这些原理，可得常微分方程组（ODEs）如下：\n$$\n\\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C,\n$$\n$$\n\\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C,\n$$\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - k_{\\mathrm{off}}\\,C - k_{\\mathrm{clearC}}\\,C,\n$$\n其中，$k_{\\mathrm{el}}$ 是游离药物的一级消除速率（单位为 $\\mathrm{hr}^{-1}$），$k_{\\mathrm{on}}$ 是结合速率常数（单位为 $\\mathrm{(a.u.)}^{-1}\\mathrm{hr}^{-1}$），$k_{\\mathrm{off}}$ 是解离速率（单位为 $\\mathrm{hr}^{-1}$），$k_{\\mathrm{clearC}}$ 是复合物消除速率（单位为 $\\mathrm{hr}^{-1}$），$p$ 是恒定的抗体生成速率（单位为 $\\mathrm{a.u./hr}$），$d$ 是抗体的一级消除速率（单位为 $\\mathrm{hr}^{-1}$）。给药模型是在指定时间对 $D$ 进行瞬时推注。在时间 $t=0$ 时的初始条件为 $D(0)=0$，$A(0)=A_0$，$C(0)=0$，之后立即进行一次初始推注。\n\n在时间 $t \\in \\{0,168,336,504\\}$ 小时给予一个四剂量的给药方案，每次给药瞬时为 $D$ 增加 $\\Delta D$ a.u.。目标是计算在 $T=672$ 小时（即最后一次给药后 $168$ 小时）时，不同 ADA 情景下的谷时游离药物浓度 $D(T)$（单位为 a.u.）。在两次推注给药之间的时间段内，对常微分方程组进行数值积分；在每个推注时间点，将 $D$ 增加 $\\Delta D$ 后继续积分。\n\n您的程序必须实现此模型，并为以下测试套件中的每个参数集生成谷时浓度 $D(T)$。最终结果以 a.u. 为单位表示，并四舍五入到三位小数。不涉及角度，也没有百分比。\n\n测试套件的参数集以有序元组形式指定：\n$(\\Delta D,\\; k_{\\mathrm{el}},\\; k_{\\mathrm{on}},\\; k_{\\mathrm{off}},\\; k_{\\mathrm{clearC}},\\; p,\\; d,\\; A_0)$\n其中所有量的定义如上。使用以下测试套件：\n- 案例 $1$（无 ADA）：$(20,\\; 0.03,\\; 0,\\; 0,\\; 0.02,\\; 0,\\; 0,\\; 0)$。\n- 案例 $2$（中度 ADA）：$(20,\\; 0.03,\\; 0.03,\\; 0.01,\\; 0.02,\\; 0.005,\\; 0.01,\\; 0)$。\n- 案例 $3$（高亲和力、高产率 ADA）：$(20,\\; 0.03,\\; 0.10,\\; 0.005,\\; 0.05,\\; 0.02,\\; 0.02,\\; 0)$。\n- 案例 $4$（复合物清除缓慢）：$(20,\\; 0.03,\\; 0.03,\\; 0.02,\\; 0.005,\\; 0.005,\\; 0.01,\\; 0)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4]$），$x_i$ 是上述四种情况下在 $D(672)$ 时的谷时浓度值，每个值均以 a.u. 为单位，并四舍五入到三位小数。",
            "solution": "用户提供了一个问题，要求通过数值求解一个常微分方程组（ODEs）来模拟一种生物药物在存在抗药抗体（ADA）时的药代动力学。\n\n### 问题验证\n\n首先，根据强制性标准对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n-   **状态变量**：游离药物浓度 $D(t)$，游离抗体浓度 $A(t)$，以及药物-抗体复合物浓度 $C(t)$。所有浓度单位均为任意浓度单位（a.u.）。\n-   **常微分方程组**：\n    $$\n    \\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n    $$\n    $$\n    \\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n    $$\n    $$\n    \\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - k_{\\mathrm{off}}\\,C - k_{\\mathrm{clearC}}\\,C\n    $$\n-   **参数**：$k_{\\mathrm{el}}$ ($\\mathrm{hr}^{-1}$)，$k_{\\mathrm{on}}$ ($\\mathrm{(a.u.)}^{-1}\\mathrm{hr}^{-1}$)，$k_{\\mathrm{off}}$ ($\\mathrm{hr}^{-1}$)，$k_{\\mathrm{clearC}}$ ($\\mathrm{hr}^{-1}$)，$p$ ($\\mathrm{a.u./hr}$)，$d$ ($\\mathrm{hr}^{-1}$)。\n-   **$t=0$ 时的初始条件**：$D(0)=0$，$A(0)=A_0$，$C(0)=0$。\n-   **给药方案**：在时间点 $t \\in \\{0, 168, 336, 504\\}$ 小时，向 $D(t)$ 中瞬时推注剂量 $\\Delta D$ (a.u.)。\n-   **目标**：计算在 $T=672$ 小时时的谷时游离药物浓度 $D(T)$。\n-   **测试套件**：包含四个参数集的列表 $(\\Delta D,\\; k_{\\mathrm{el}},\\; k_{\\mathrm{on}},\\; k_{\\mathrm{off}},\\; k_{\\mathrm{clearC}},\\; p,\\; d,\\; A_0)$：\n    1.  $(20,\\; 0.03,\\; 0,\\; 0,\\; 0.02,\\; 0,\\; 0,\\; 0)$\n    2.  $(20,\\; 0.03,\\; 0.03,\\; 0.01,\\; 0.02,\\; 0.005,\\; 0.01,\\; 0)$\n    3.  $(20,\\; 0.03,\\; 0.10,\\; 0.005,\\; 0.05,\\; 0.02,\\; 0.02,\\; 0)$\n    4.  $(20,\\; 0.03,\\; 0.03,\\; 0.02,\\; 0.005,\\; 0.005,\\; 0.01,\\; 0)$\n\n**步骤2：使用提取的已知信息进行验证**\n-   **科学依据**：该问题基于质量作用定律和一级衰减，这些是化学动力学和药理学中的基本原理。该模型是靶介导的药物处置（TMDD）的标准表示，这是一个成熟的概念。\n-   **适定性**：该问题指定了一个具有明确初始条件和分段强迫事件（给药）的常微分方程组。这构成了每个给药间隔内的一个适定初值问题，保证了唯一的数值解。\n-   **客观性**：问题陈述使用了精确的数学术语，没有主观或含糊不清的语言。这是一个纯粹的计算任务。\n-   **完整性和一致性**：问题是自洽的。提供了所有必需的参数、初始条件和给药方案。单位在内部是一致的。\n-   **合理性**：参数值在此类生物过程的实际范围内。\n\n**步骤3：结论与行动**\n该问题具有科学依据、数学上适定、客观且自洽。因此，判定为**有效**。将提供解决方案。\n\n### 解决方案\n\n该问题需要求解一个由三个耦合的非线性常微分方程组成的方程组，该方程组描述了药物浓度 $D(t)$、抗药抗体浓度 $A(t)$ 和药物-抗体复合物浓度 $C(t)$。该系统受多剂量给药方案的约束，这会在药物浓度中引入不连续性。\n\n控制方程为：\n$$\n\\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n$$\n$$\n\\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n$$\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - (k_{\\mathrm{off}} + k_{\\mathrm{clearC}})\\,C\n$$\n系统的状态由浓度向量 $y(t) = [D(t), A(t), C(t)]^T$ 描述。$t=0$ 时的初始状态为 $y(0) = [0, A_0, 0]^T$。\n\n给药方案包括在时间点 $t \\in \\{0, 168, 336, 504\\}$ 小时进行四次剂量为 $\\Delta D$ 的推注。这些注射被建模为药物浓度的瞬时增加。问题的这种分段性质要求进行分段模拟。总模拟时间从 $t=0$ 到 $T=672$ 小时，分为四个区间：\n1.  $t \\in [0, 168]$\n2.  $t \\in [168, 336]$\n3.  $t \\in [336, 504]$\n4.  $t \\in [504, 672]$\n\n通过对每个参数集执行以下步骤来找到解决方案：\n1.  在 $t=0$ 时将状态向量初始化为 $y_{current} = [0, A_0, 0]$。\n2.  遍历四个时间区间。设当前区间为 $[t_{start}, t_{end}]$。\n3.  在每个区间开始时，$t_{start}$，通过更新药物浓度来施加推注剂量：$D(t_{start}) \\leftarrow D(t_{start}) + \\Delta D$。这对 $t_{start} \\in \\{0, 168, 336, 504\\}$ 执行。\n4.  使用 $t_{start}$ 时的状态（如果适用，则在给药后）作为初始条件，在区间 $[t_{start}, t_{end}]$ 上数值求解常微分方程组。为此，我们采用高质量的数值积分器。使用 `scipy.integrate.solve_ivp` 函数，并采用 `Radau` 方法，这是一种隐式 Runge-Kutta 方法，非常适合处理药代动力学中经常遇到的潜在刚性系统。为确保准确性，使用了严格的绝对和相对误差容限（分别为 $10^{-12}$ 和 $10^{-9}$）。\n5.  区间结束时的状态向量 $y(t_{end})$ 成为下一个区间的起始状态。\n6.  重复此过程，直到达到最终时间 $T=672$ 小时。游离药物浓度 $D(672)$ 就是所求的谷值。\n7.  每个案例的最终结果按照要求四舍五入到三位小数。\n\n对四个测试案例中的每一个都执行此程序，并将结果汇总成一个格式化的输出字符串。",
            "answer": "[11.246,7.725,0.820,10.360]"
        }
    ]
}