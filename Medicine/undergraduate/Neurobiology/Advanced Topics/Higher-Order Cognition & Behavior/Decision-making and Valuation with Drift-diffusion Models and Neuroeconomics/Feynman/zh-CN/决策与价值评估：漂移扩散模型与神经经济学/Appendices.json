{
    "hands_on_practices": [
        {
            "introduction": "对漂移扩散模型（DDM）的理解始于其最核心的预测：证据如何转化为选择。本练习将指导你从第一性原理出发，推导做出正确选择的概率。这个过程将强调决策边界（$A$）在平衡决策速度与准确性（即速度-准确性权衡）中的关键作用。",
            "id": "5011105",
            "problem": "在双择一知觉决策中，一个经典的经验现象是速度-准确率权衡：被试可以通过降低决策标准来提高决策速度，但会以牺牲准确率为代价。考虑一个神经上合理的证据累积过程，该过程由一个漂移扩散模型 (DDM) 建模，其中一个标量决策变量 $x(t)$ 根据随机微分方程 $dx(t) = \\mu \\, dt + \\sigma \\, dW_t$ 演化，其中 $W_t$ 是一个标准维纳过程，$\\mu$ 是一个恒定的漂移，反映了支持正确选项的平均瞬时证据，而 $\\sigma$ 是扩散幅度，反映了神经变异性。该过程从 $x(0) = 0$ 开始，当它到达上吸收边界 $x = +A$ (当 $\\mu > 0$ 时做出正确选择) 或下吸收边界 $x = -A$ (做出错误选择) 时终止。假设边界对称且起始点无偏。\n\n从该漂移扩散过程的柯尔莫哥洛夫后向算子和在 $\\pm A$ 处吸收的适当边界条件出发，推导从 $x(0) = 0$ 开始时到达上边界的概率表达式，用 $\\mu$、$\\sigma$ 和 $A$ 表示。然后，施加一个目标准确率为 $p^{\\star} = 0.82$ 的固定准确率策略，并计算在 $\\mu = 0.75$ (证据/秒) 和 $\\sigma = 1.10$ (证据/秒的平方根) 的条件下，为达到此准确率所需的边界大小 $A$。最终的 $A$ 以证据单位表示。将你的答案四舍五入到四位有效数字。",
            "solution": "该问题要求做两件事：第一，推导在具有对称边界的漂移扩散模型 (DDM) 中做出正确决策的概率表达式；第二，根据给定的模型参数，计算达到特定准确率 $p^{\\star}$ 所需的边界高度 $A$。\n\n### 步骤1：问题陈述的验证\n\n我们首先验证问题陈述。\n\n**1. 提取已知条件：**\n- **模型：** 用于标量决策变量 $x(t)$ 的漂移扩散模型 (DDM)。\n- **随机微分方程：** $dx(t) = \\mu \\, dt + \\sigma \\, dW_t$。\n- **参数：**\n    -   $\\mu$：恒定漂移率。\n    -   $\\sigma$：扩散幅度 (维纳过程增量的标准差)。\n- **过程：** $W_t$ 是一个标准维纳过程。\n- **初始条件：** 过程从 $x(0) = 0$ 开始。\n- **边界条件：** 两个吸收边界位于 $x = +A$ 和 $x = -A$。\n- **决策映射：** 到达 $x = +A$ 对应于正确选择 (对于 $\\mu > 0$)，到达 $x = -A$ 对应于错误选择。\n- **任务1 (推导)：** 从 $x(0) = 0$ 开始，推导到达上边界 $+A$ 的概率，用 $\\mu$、$\\sigma$ 和 $A$ 表示。推导必须从柯尔莫哥洛夫后向算子开始。\n- **任务2 (计算)：**\n    -   目标准确率：$p^{\\star} = 0.82$。\n    -   漂移率：$\\mu = 0.75$ 证据/秒。\n    -   扩散幅度：$\\sigma = 1.10$ 证据/$\\text{秒}^{1/2}$。\n    -   计算所需的边界大小 $A$。\n    -   最终答案 $A$ 应四舍五入到四位有效数字。\n\n**2. 验证：**\n- **科学依据：** 该问题牢固地植根于计算神经科学和数学心理学。DDM 是决策制定的一个典型模型，通过柯尔莫哥洛夫后向方程 (费曼-卡茨公式的一种特定形式) 对其进行分析是研究随机过程中首次穿越时间问题的标准而严谨的数学技术。为 $\\mu$ 和 $\\sigma$ 提供的单位在量纲上是一致的。\n- **适定性：** 该问题是适定的。它要求推导一个标准结果，然后进行数值计算。所提供的信息是充分且一致的，可以导出一个唯一的解。\n- **客观性：** 该问题以精确、客观和定量的术语陈述。\n\n**3. 结论：**\n问题陈述在科学上是合理的，内部是一致的，并且是适定的。因此，它被判定为**有效**。\n\n### 步骤2：求解\n\n#### 第1部分：选择概率的推导\n\n令 $P(x)$ 为决策变量 $x(t)$ 从 $x(0) = x$ 开始，在到达下边界 $-A$ 之前先到达上边界 $+A$ 的概率。我们感兴趣的是求 $P(0)$。这个概率也称为准确率或正确概率，记为 $P_c$。\n\n对于一个形如 $dx_t = a(x_t, t)dt + b(x_t, t)dW_t$ 的伊藤过程，首次穿越事件的概率，如 $P(x)$，满足柯尔莫哥洛夫后向方程。对于我们的时间齐次过程 $dx(t) = \\mu \\, dt + \\sigma \\, dW_t$，漂移项是 $a(x) = \\mu$，扩散项是 $b(x) = \\sigma$。柯尔莫哥洛夫后向算子 $\\mathcal{L}$ 由下式给出：\n$$\n\\mathcal{L} = a(x)\\frac{d}{dx} + \\frac{1}{2}b(x)^2\\frac{d^2}{dx^2}\n$$\n对于我们特定的 DDM，这变为：\n$$\n\\mathcal{L} = \\mu\\frac{d}{dx} + \\frac{1}{2}\\sigma^2\\frac{d^2}{dx^2}\n$$\n概率 $P(x)$ 对于边界内的所有起始点 $x$（即 $x \\in (-A, A)$）都必须满足微分方程 $\\mathcal{L}P(x) = 0$。这导出了以下二阶常微分方程 (ODE)：\n$$\n\\frac{1}{2}\\sigma^2 \\frac{d^2P}{dx^2} + \\mu \\frac{dP}{dx} = 0\n$$\n边界条件由吸收的性质决定。如果过程从上边界开始，它会立即被吸收，因此到达该边界的概率是 $1$。如果它从下边界开始，它也会被吸收，而到达上边界的概率是 $0$。\n$$\nP(A) = 1\n$$\n$$\nP(-A) = 0\n$$\n为了求解该 ODE，我们可以先令 $Q(x) = \\frac{dP}{dx}$。方程变为关于 $Q(x)$ 的一阶线性 ODE：\n$$\n\\frac{1}{2}\\sigma^2 \\frac{dQ}{dx} + \\mu Q = 0 \\implies \\frac{dQ}{Q} = -\\frac{2\\mu}{\\sigma^2} dx\n$$\n对两边积分得到：\n$$\n\\ln|Q| = -\\frac{2\\mu}{\\sigma^2}x + C_1' \\implies Q(x) = C_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)\n$$\n现在我们对 $Q(x)$ 积分以求得 $P(x)$：\n$$\nP(x) = \\int Q(x) dx = \\int C_1 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) dx\n$$\n如果 $\\mu \\neq 0$，积分为：\n$$\nP(x) = C_1 \\left(-\\frac{\\sigma^2}{2\\mu}\\right) \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + C_2\n$$\n为方便起见，我们重新定义常数。通解的形式为 $P(x) = K_1 + K_2 \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right)$。\n我们现在应用边界条件来确定常数 $K_1$ 和 $K_2$：\n1. $P(A) = K_1 + K_2 \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) = 1$\n2. $P(-A) = K_1 + K_2 \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) = 0$\n\n从方程 (2)，我们得到 $K_1 = -K_2 \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right)$。将此代入方程 (1)：\n$$\n-K_2 \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) + K_2 \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) = 1\n$$\n$$\nK_2 \\left( \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) \\right) = 1 \\implies K_2 = \\frac{1}{\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n那么，$K_1$ 是：\n$$\nK_1 = - \\frac{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right)}{\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right)} = \\frac{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right)}{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n将 $K_1$ 和 $K_2$ 代回 $P(x)$ 的通解中：\n$$\nP(x) = \\frac{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu x}{\\sigma^2}\\right)}{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n问题要求的是从 $x(0)=0$ 开始时做出正确选择的概率。我们在 $x=0$ 处计算 $P(x)$：\n$$\nP(0) = \\frac{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp(0)}{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)} = \\frac{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - 1}{\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n为了简化这个表达式，我们可以将分子和分母同乘以 $\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)$：\n$$\nP(0) = \\frac{\\left(\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - 1\\right)\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}{\\left(\\exp\\left(\\frac{2\\mu A}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)\\right)\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)} = \\frac{1 - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{4\\mu A}{\\sigma^2}\\right)}\n$$\n分母可以因式分解为平方差，$1 - y^2 = (1-y)(1+y)$，其中 $y=\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)$：\n$$\nP(0) = \\frac{1 - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}{\\left(1 - \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)\\right)\\left(1 + \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)\\right)}\n$$\n假设 $\\mu A \\neq 0$，我们可以消去公因式，得到做出正确选择的概率的最终简化表达式：\n$$\nP(0) = \\frac{1}{1 + \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n这是一个以 $\\frac{2\\mu A}{\\sigma^2}$ 为自变量的逻辑斯蒂 (sigmoid) 函数。\n\n#### 第2部分：边界高度 A 的计算\n\n给定目标准确率 $p^{\\star} = 0.82$。这对应于 $P(0)$。我们将我们推导出的表达式设为等于 $p^{\\star}$ 并求解 $A$：\n$$\np^{\\star} = \\frac{1}{1 + \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right)}\n$$\n整理方程以求解 $A$：\n$$\n1 + \\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) = \\frac{1}{p^{\\star}}\n$$\n$$\n\\exp\\left(-\\frac{2\\mu A}{\\sigma^2}\\right) = \\frac{1}{p^{\\star}} - 1 = \\frac{1 - p^{\\star}}{p^{\\star}}\n$$\n取两边的自然对数：\n$$\n-\\frac{2\\mu A}{\\sigma^2} = \\ln\\left(\\frac{1 - p^{\\star}}{p^{\\star}}\\right)\n$$\n最后，分离出 $A$：\n$$\nA = -\\frac{\\sigma^2}{2\\mu} \\ln\\left(\\frac{1 - p^{\\star}}{p^{\\star}}\\right) = \\frac{\\sigma^2}{2\\mu} \\ln\\left(\\left(\\frac{1 - p^{\\star}}{p^{\\star}}\\right)^{-1}\\right) = \\frac{\\sigma^2}{2\\mu} \\ln\\left(\\frac{p^{\\star}}{1 - p^{\\star}}\\right)\n$$\n现在，我们代入给定的数值：$\\mu = 0.75$，$\\sigma = 1.10$，以及 $p^{\\star} = 0.82$。\n$$\nA = \\frac{(1.10)^2}{2(0.75)} \\ln\\left(\\frac{0.82}{1 - 0.82}\\right)\n$$\n$$\nA = \\frac{1.21}{1.5} \\ln\\left(\\frac{0.82}{0.18}\\right)\n$$\n$$\nA = \\frac{1.21}{1.5} \\ln\\left(\\frac{41}{9}\\right)\n$$\n计算数值：\n$$\nA \\approx (0.80666...) \\times \\ln(4.5555...)\n$$\n$$\nA \\approx (0.80666...) \\times (1.5163475...)\n$$\n$$\nA \\approx 1.2229561\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nA \\approx 1.223\n$$\nA 的单位是证据单位，这与决策变量 $x(t)$ 的定义一致。",
            "answer": "$$\\boxed{1.223}$$"
        },
        {
            "introduction": "现实世界中的决策常常受到先验信念或偏好的影响，因此我们需要将模型从简单的对称起点扩展开来。本练习展示了漂移扩散模型如何通过调整证据累积过程的起点（$Y_0$）来巧妙地整合这些先验信息。你将通过计算来量化这种起点偏置对最终选择概率的影响。",
            "id": "5011103",
            "problem": "神经经济学任务中的一个二选一强制选择决策被建模为漂移扩散模型（Drift-Diffusion Model, DDM）。内部决策变量是对数似然比（Log-Likelihood Ratio, LLR），记为 $Y_t$，它作为一个连续时间随机过程演化，其动态由随机微分方程 $dY_t = v\\,dt + \\sigma\\,dW_t$ 给出，其中 $v$ 是恒定漂移率，$\\sigma$ 是扩散系数，$W_t$ 是标准维纳过程。当 $Y_t$ 到达上吸收边界 $+B$（选择选项 $\\mathcal{A}$）或下吸收边界 $-B$（选择选项 $\\mathcal{B}$）时，决策终止。关于选项的先验信念将初始条件设置为先验对数优势 $Y_0 = \\ln\\!\\big(\\pi_{\\mathcal{A}}/\\pi_{\\mathcal{B}}\\big)$，这提供了一个起始点偏差。\n\n从 DDM 的定义和上述边界条件出发，推导选择选项 $\\mathcal{A}$ 的概率的闭式表达式，该表达式是参数 $v$、$\\sigma$、$B$ 和初始条件 $Y_0$ 的函数。然后，对于 $v = 0.4$（单位：对数优势/秒）、$\\sigma = 1.2$（单位：对数优势/秒的平方根）、$B = 1.1$（单位：对数优势）以及先验概率 $\\pi_{\\mathcal{A}} = 0.65$ 和 $\\pi_{\\mathcal{B}} = 0.35$，计算这个概率。将最终概率表示为小数，并四舍五入到四位有效数字。",
            "solution": "用户希望我解决一个与神经经济学中的漂移扩散模型（DDM）相关的问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   **步骤 1：提取给定条件：** 我将列出所有提供的方程、变量和常数。\n        *   模型：漂移扩散模型 (DDM)。\n        *   决策变量：对数似然比 (LLR)，$Y_t$。\n        *   随机微分方程 (SDE): $dY_t = v\\,dt + \\sigma\\,dW_t$。\n        *   $v$：恒定漂移率。\n        *   $\\sigma$：扩散系数。\n        *   $W_t$：标准维纳过程。\n        *   上边界：$+B$（选择选项 $\\mathcal{A}$）。\n        *   下边界：$-B$（选择选项 $\\mathcal{B}$）。\n        *   初始条件：$Y_0 = \\ln(\\pi_{\\mathcal{A}}/\\pi_{\\mathcal{B}})$。\n        *   任务：推导选择选项 $\\mathcal{A}$ 的概率，$P(\\text{选择 } \\mathcal{A})$。\n        *   任务：针对特定值计算此概率：\n            *   $v = 0.4$。\n            *   $\\sigma = 1.2$。\n            *   $B = 1.1$。\n            *   $\\pi_{\\mathcal{A}} = 0.65$。\n            *   $\\pi_{\\mathcal{B}} = 0.35$。\n        *   最终答案格式：小数，四舍五入到四位有效数字。\n\n    *   **步骤 2：使用提取的给定条件进行验证：**\n        *   **科学依据：** DDM 是认知神经科学和神经经济学中用于二选一强制选择任务的标准且成熟的模型。SDE $dY_t = v\\,dt + \\sigma\\,dW_t$ 是带漂移的维纳过程的典型形式。吸收边界和基于先验对数优势的初始条件的概念也是该领域的标准实践。该问题牢固地建立在公认的科学和数学原理之上。\n        *   **适定性：** 该问题要求计算一个一维扩散过程从两边界之间的一点出发，撞击其中一个吸收边界的概率。这是一个经典的首过时间问题，特别是在连续时间、连续空间设置下的“赌徒破产”问题。在随机过程的文献中，存在一个唯一、稳定且有意义的解，并且是众所周知的。\n        *   **客观性：** 语言精确、量化，没有偏见。\n        *   **科学或事实上的不健全性：** 无。该模型是决策理论的基石。\n        *   **不可形式化或不相关：** 无。该问题是一个与所述主题直接相关的形式化数学练习。\n        *   **不完整或矛盾的设置：** 所有必要的参数（$v, \\sigma, B, \\pi_{\\mathcal{A}}, \\pi_{\\mathcal{B}}$）都已提供。初始条件定义明确。边界是对称的，这是一种常见的设置。问题是自洽的。提供的单位（对数优势/秒等）与 DDM 框架一致。\n        *   **不切实际或不可行：** 对于典型的知觉决策任务，参数值是合理的。\n        *   **不适定或结构不良：** 否。该问题是一个标准的推导，后跟一个计算。\n        *   **伪深刻、琐碎或同义反复：** 否。推导需要随机微积分或相关技术的知识，后续计算是所推导公式的直接应用。这是一个标准的教科书级别的问题。\n        *   **超出科学可验证性：** 解可以通过数学方法验证。\n\n    *   **步骤 3：结论与行动：** 问题是有效的。我将着手解决它。\n\n2.  **解决问题：**\n    *   **第一部分：概率的推导。**\n        *   问题是要求过程 $Y_t$ 从 $Y_0$ 出发，在撞击边界 $-B$ 之前先撞击边界 $+B$ 的概率。我们将这个概率称为 $P(Y_0)$。\n        *   这是随机过程中的一个经典问题。从 $Y_0 = y$ 出发，在撞击 $-B$ 之前先撞击边界 $+B$ 的概率 $P(y)$ 满足称为柯尔莫哥洛夫后向方程的常微分方程（ODE）。对于一个过程 $dY_t = \\mu(Y_t) dt + \\sigma(Y_t) dW_t$，概率 $P(y)$ 满足：\n            $$ \\mu(y) \\frac{dP}{dy} + \\frac{1}{2}\\sigma^2(y) \\frac{d^2P}{dy^2} = 0 $$\n        *   在我们的具体案例中，漂移 $\\mu(y) = v$ 和扩散系数 $\\sigma(y) = \\sigma$ 是常数。所以 ODE 简化为：\n            $$ v \\frac{dP}{dy} + \\frac{1}{2}\\sigma^2 \\frac{d^2P}{dy^2} = 0 $$\n        *   边界条件由吸收边界确定。如果过程从 $+B$ 开始，它已经“选择”了 $\\mathcal{A}$，所以选择 $\\mathcal{A}$ 的概率是 $1$。如果它从 $-B$ 开始，它已经选择了 $\\mathcal{B}$，所以选择 $\\mathcal{A}$ 的概率是 $0$。\n            *   $P(+B) = 1$\n            *   $P(-B) = 0$\n        *   我们来解这个 ODE。令 $P'(y) = \\frac{dP}{dy}$ 和 $P''(y) = \\frac{d^2P}{dy^2}$。方程为：\n            $$ \\frac{1}{2}\\sigma^2 P'' + v P' = 0 $$\n            $$ P'' = -\\frac{2v}{\\sigma^2} P' $$\n        *   这是一个关于 $P'$ 的一阶线性 ODE。令 $Q(y) = P'(y)$。\n            $$ Q' = -\\frac{2v}{\\sigma^2} Q $$\n        *   其解为 $Q(y) = C_1 \\exp\\left(-\\frac{2v}{\\sigma^2} y\\right)$。\n        *   现在，我们对 $Q(y)$ 积分以求得 $P(y)$：\n            $$ P(y) = \\int Q(y) dy = \\int C_1 \\exp\\left(-\\frac{2v}{\\sigma^2} y\\right) dy $$\n            $$ P(y) = C_1 \\left(-\\frac{\\sigma^2}{2v}\\right) \\exp\\left(-\\frac{2v}{\\sigma^2} y\\right) + C_2 $$\n        *   这可以写成具有常系数的二阶线性齐次 ODE 的标准形式。特征方程是 $\\frac{1}{2}\\sigma^2 r^2 + vr = 0$，得到 $r(\\frac{1}{2}\\sigma^2 r + v) = 0$。根是 $r_1=0$ 和 $r_2 = -2v/\\sigma^2$。\n        *   因此，$P(y)$ 的通解是：\n            $$ P(y) = C_1 + C_2 \\exp\\left(-\\frac{2v}{\\sigma^2}y\\right) $$\n        *   我们应用边界条件来求解常数 $C_1$ 和 $C_2$。\n            对于下边界 $y=-B$，$P(-B) = 0$：\n            $$ C_1 + C_2 \\exp\\left(-\\frac{2v(-B)}{\\sigma^2}\\right) = C_1 + C_2 \\exp\\left(\\frac{2vB}{\\sigma^2}\\right) = 0 \\quad (1) $$\n            对于上边界 $y=B$，$P(B) = 1$：\n            $$ C_1 + C_2 \\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) = 1 \\quad (2) $$\n        *   方程 (2) 减去方程 (1) 得到：\n            $$ C_2 \\left[\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)\\right] = 1 $$\n            $$ C_2 = \\frac{1}{\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)} $$\n        *   从方程 (1) 中，我们求得 $C_1$：\n            $$ C_1 = -C_2 \\exp\\left(\\frac{2vB}{\\sigma^2}\\right) = -\\frac{\\exp\\left(\\frac{2vB}{\\sigma^2}\\right)}{\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)} $$\n        *   将 $C_1$ 和 $C_2$ 代回 $P(y)$ 的通解中：\n            $$ P(y) = \\frac{-\\exp\\left(\\frac{2vB}{\\sigma^2}\\right) + \\exp\\left(-\\frac{2vy}{\\sigma^2}\\right)}{\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)} $$\n        *   为简化此表达式，我们可以将分子和分母同乘以 $-1$：\n            $$ P(y) = \\frac{\\exp\\left(\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2vy}{\\sigma^2}\\right)}{\\exp\\left(\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(-\\frac{2vB}{\\sigma^2}\\right)} $$\n        *   通过考虑一个从 $z_0 = y+B$ 开始，边界在 $0$ 和 $2B$ 的过程，可以找到一个更方便的形式。对于位于 $a$ 和 $b$（$a  b$）的边界，通解是 $P(y;a,b) = \\frac{\\exp(-\\frac{2vy}{\\sigma^2}) - \\exp(-\\frac{2va}{\\sigma^2})}{\\exp(-\\frac{2vb}{\\sigma^2}) - \\exp(-\\frac{2va}{\\sigma^2})}$。\n        *   使用我们的边界 $a=-B$ 和 $b=B$，可得：\n            $$ P(y) = \\frac{\\exp\\left(-\\frac{2vy}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)}{\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right) - \\exp\\left(\\frac{2vB}{\\sigma^2}\\right)} $$\n        *   为了得到更简洁的形式，我们将分子和分母同乘以 $\\exp\\left(-\\frac{2vB}{\\sigma^2}\\right)$：\n            分子：$(\\exp(-\\frac{2vy}{\\sigma^2}) - \\exp(\\frac{2vB}{\\sigma^2})) \\times \\exp(-\\frac{2vB}{\\sigma^2}) = \\exp(-\\frac{2v(y+B)}{\\sigma^2}) - 1$。\n            分母：$(\\exp(-\\frac{2vB}{\\sigma^2}) - \\exp(\\frac{2vB}{\\sigma^2})) \\times \\exp(-\\frac{2vB}{\\sigma^2}) = \\exp(-\\frac{4vB}{\\sigma^2}) - 1$。\n        *   该比率变为：\n            $$ P(y) = \\frac{\\exp(-\\frac{2v(y+B)}{\\sigma^2}) - 1}{\\exp(-\\frac{4vB}{\\sigma^2}) - 1} = \\frac{1 - \\exp\\left(-\\frac{2v(y+B)}{\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{4vB}{\\sigma^2}\\right)} $$\n        *   这就是在给定起始点 $y$ 的情况下，选择选项 $\\mathcal{A}$ 的概率的闭式表达式。对于本问题，我们使用初始条件 $y=Y_0$。\n            $$ P(\\text{选择 } \\mathcal{A}) = \\frac{1 - \\exp\\left(-\\frac{2v(Y_0+B)}{\\sigma^2}\\right)}{1 - \\exp\\left(-\\frac{4vB}{\\sigma^2}\\right)} $$\n        *   现在，我们针对给定的参数值计算这个表达式。\n            参数为：\n            $v = 0.4$\n            $\\sigma = 1.2$\n            $B = 1.1$\n            $\\pi_{\\mathcal{A}} = 0.65$\n            $\\pi_{\\mathcal{B}} = 0.35$\n        *   首先，计算初始条件 $Y_0$：\n            $$ Y_0 = \\ln\\left(\\frac{\\pi_{\\mathcal{A}}}{\\pi_{\\mathcal{B}}}\\right) = \\ln\\left(\\frac{0.65}{0.35}\\right) = \\ln\\left(\\frac{13}{7}\\right) $$\n        *   接下来，计算指数中的项 $\\frac{2v}{\\sigma^2}$：\n            $$ \\frac{2v}{\\sigma^2} = \\frac{2 \\times 0.4}{(1.2)^2} = \\frac{0.8}{1.44} = \\frac{80}{144} = \\frac{5 \\times 16}{9 \\times 16} = \\frac{5}{9} $$\n        *   现在，我们计算指数函数的自变量。\n            分子的指数的自变量：\n            $$ -\\frac{2v(Y_0+B)}{\\sigma^2} = -\\frac{5}{9}\\left(\\ln\\left(\\frac{13}{7}\\right) + 1.1\\right) $$\n            分母的指数的自变量：\n            $$ -\\frac{4vB}{\\sigma^2} = -\\frac{2v(2B)}{\\sigma^2} = -\\frac{5}{9}(2 \\times 1.1) = -\\frac{5}{9}(2.2) = -\\frac{11}{9} $$\n        *   将这些代入概率公式中：\n            $$ P(\\text{选择 } \\mathcal{A}) = \\frac{1 - \\exp\\left(-\\frac{5}{9}\\left(\\ln\\left(\\frac{13}{7}\\right) + 1.1\\right)\\right)}{1 - \\exp\\left(-\\frac{11}{9}\\right)} $$\n        *   现在我们计算数值：\n            $Y_0 = \\ln(13/7) \\approx 0.6190392$\n            $Y_0 + B \\approx 0.6190392 + 1.1 = 1.7190392$\n            分子指数：$-\\frac{5}{9} \\times 1.7190392 \\approx -0.9550218$\n            $\\exp(-0.9550218) \\approx 0.384813$\n            分子 = $1 - 0.384813 = 0.615187$\n            分母指数：$-\\frac{11}{9} \\approx -1.222222$\n            $\\exp(-1.222222) \\approx 0.294570$\n            分母 = $1 - 0.294570 = 0.705430$\n            $$ P(\\text{选择 } \\mathcal{A}) \\approx \\frac{0.615187}{0.705430} \\approx 0.872080 $$\n        *   将结果四舍五入到四位有效数字，得到 $0.8721$。",
            "answer": "$$\n\\boxed{0.8721}\n$$"
        },
        {
            "introduction": "本练习将理论模型与动态、可观察的行为联系起来，应用了前一个练习中探讨的起点偏置概念。你将探索如何利用该模型来解释前一次决策的结果如何影响下一次决策。这是对漂移扩散模型如何解释序列效应（例如在心理学实验中常见的重复或交替选择的倾向）的一个有力展示。",
            "id": "5011115",
            "problem": "在神经经济学和决策神经科学中，一个核心的构造是用于证据累积的漂移扩散过程。考虑一个二择一强迫选择决策，其由潜决策变量 $X_t$ 的一维随机微分方程建模，\n$$\ndX_t \\;=\\; v\\,dt \\;+\\; \\sigma\\,dW_t,\n$$\n其在 $X_t=0$（下边界）和 $X_t=a$（上边界）处有吸收边界，初始条件为 $X_0=z$，其中 $z\\in[0,a]$。此处，$v$ 是漂移率，$\\sigma0$ 是扩散尺度，$W_t$ 是标准维纳过程，$a0$ 是边界间距。到达上边界的轨迹映射为“上方”选择，而到达下边界的轨迹映射为“下方”选择。\n\n序列依赖性和历史偏差通常通过让第 $n$ 次试验的起始点 $z$ 依赖于前一次的选择 $c_{n-1}\\in\\{+1,-1\\}$ 来引入，具体如下：\n$$\nz \\;=\\; \\frac{a}{2} \\;+\\; b\\,c_{n-1},\n$$\n其中 $b$ 是一个以决策坐标为单位的恒定“保持”偏差大小。正值 $b$ 会产生重复前一次选择（“保持”）的倾向，而负值 $b$ 则会产生交替选择（“转换”）的倾向。为确保合理性，$z$ 被限制在区间 $[0,a]$ 内。当前试验的漂移率通过一个比例常数 $k0$ 与带符号的刺激强度 $s$ 耦合：\n$$\nv \\;=\\; k\\,s.\n$$\n假设扩散的单位时间方差为 $\\sigma^2$，并且非决策延迟不影响选择概率。你可以假设 $W_t$ 具有标准正则性以及吸收边界值问题的适定性。\n\n任务：\n- 从适用于神经生物学中随机过程的第一性原理出发，推导从 $z$ 开始的过程序列在到达下边界之前被上边界吸收的概率的闭式表达式，该表达式是关于 $v$、$\\sigma$、$a$ 和 $z$ 的函数。推导需包括当 $v=0$ 时的正确极限行为以及起始点在边界上 $z\\in\\{0,a\\}$ 的边缘情况。使用向后方程或等效的基本工具来证明每一步。\n- 使用该表达式，根据前一次选择 $c_{n-1}$ 定义下一次试验的重复概率如下：如果 $c_{n-1}=+1$，重复概率等于在上边界的吸收概率；如果 $c_{n-1}=-1$，重复概率等于 1 减去该吸收概率。\n- 实现一个算法，为给定参数确定性地计算此重复概率，并正确处理极限和边缘情况。\n\n每个测试用例的输入参数：\n- 边界间距 $a$。\n- 扩散尺度 $\\sigma$。\n- 漂移增益 $k$。\n- 带符号的刺激强度 $s$。\n- 历史偏差大小 $b$。\n- 前一次选择 $c_{n-1}\\in\\{+1,-1\\}$。\n\n为了数值报告的一致性，将每个重复概率四舍五入到六位小数。\n\n测试套件：\n- 案例1（一般“顺利路径”）：$a=1.0$, $\\sigma=1.0$, $k=0.8$, $s=0.5$, $b=0.1$, $c_{n-1}=+1$。\n- 案例2（零漂移极限）：$a=1.0$, $\\sigma=1.0$, $k=0.5$, $s=0.0$, $b=0.2$, $c_{n-1}=+1$。\n- 案例3（负向的前一次选择和非单位尺度）：$a=1.2$, $\\sigma=0.9$, $k=1.0$, $s=0.6$, $b=0.15$, $c_{n-1}=-1$。\n- 案例4（因强保持偏差导致从边界开始）：$a=1.0$, $\\sigma=1.0$, $k=0.5$, $s=1.5$, $b=0.5$, $c_{n-1}=+1$。\n- 案例5（负漂移与弱偏差）：$a=1.0$, $\\sigma=0.5$, $k=0.4$, $s=-0.2$, $b=0.05$, $c_{n-1}=+1$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含五个案例的、四舍五入到六位小数的重复概率，格式为用方括号括起来的逗号分隔列表（例如，“$[0.500000,0.600000,0.700000,0.800000,0.900000]$”）。不应打印任何其他文本。",
            "solution": "问题陈述在计算神经科学和随机过程领域提供了一个有效且适定的问题。它科学地基于已建立的用于决策的漂移扩散模型理论。参数、关系和目标都得到了清晰客观的定义。不存在矛盾、歧义或违反科学原理之处。因此，我们可以进行完整的推导和求解。\n\n主要任务是推导一维扩散过程在其下边界之前被其上边界吸收的概率。该过程由决策变量 $X_t$ 的随机微分方程描述：\n$$\ndX_t = v\\,dt + \\sigma\\,dW_t\n$$\n其中 $X_t$ 从起始点 $X_0 = z \\in [0, a]$ 开始演化。该过程在碰到下边界 $0$ 或上边界 $a  0$ 时终止。我们旨在求出首先碰到上边界的概率，我们将其表示为 $p(z) = P(\\tau_a  \\tau_0 | X_0=z)$，其中 $\\tau_k$ 是到达边界 $k$ 的首次通过时间。\n\n为推导 $p(z)$，我们使用解决此类问题的一个基本工具：Kolmogorov 向后方程。对于一个一般的时齐 Itô 过程，从 $x$ 出发到达状态空间某个区域的概率满足稳态向后方程 $\\mathcal{L} p(x) = 0$，其中 $\\mathcal{L}$ 是该过程的生成元。对于我们特定的漂移扩散模型，漂移系数是常数 $v$，扩散系数是常数 $\\sigma$。因此，生成元 $\\mathcal{L}$ 是：\n$$\n\\mathcal{L} = v\\frac{d}{dz} + \\frac{1}{2}\\sigma^2\\frac{d^2}{dz^2}\n$$\n将此算子应用于我们的函数 $p(z)$ 并将结果设为 $0$，得到以下二阶常微分方程（ODE）：\n$$\n\\frac{1}{2}\\sigma^2\\frac{d^2p}{dz^2} + v\\frac{dp}{dz} = 0\n$$\n此 ODE 必须在从 $p(z)$ 定义导出的边界条件下求解。如果过程从上边界 $z=a$ 开始，它会立即以概率 $1$ 在那里被吸收。如果它从下边界 $z=0$ 开始，*首先*被上边界吸收的概率是 $0$。因此，边界条件是：\n$$\np(0) = 0 \\quad \\text{and} \\quad p(a) = 1\n$$\n\n我们现在求解这个边值问题。我们考虑漂移率 $v$ 的两种情况。\n\n情况1：$v \\neq 0$。\n令 $q(z) = \\frac{dp}{dz}$。该 ODE 变为关于 $q(z)$ 的一阶线性方程：\n$$\n\\frac{1}{2}\\sigma^2\\frac{dq}{dz} + vq = 0 \\implies \\frac{dq}{q} = -\\frac{2v}{\\sigma^2}dz\n$$\n对两边积分得到 $\\ln(q) = -\\frac{2v}{\\sigma^2}z + C_0$，这意味着对于某个常数 $C_1$，有 $q(z) = C_1 e^{-\\frac{2v}{\\sigma^2}z}$。\n为了求得 $p(z)$，我们对 $q(z)$ 积分：\n$$\np(z) = \\int q(z) dz = \\int C_1 e^{-\\frac{2v}{\\sigma^2}z} dz = C_1 \\left(-\\frac{\\sigma^2}{2v}\\right) e^{-\\frac{2v}{\\sigma^2}z} + C_2\n$$\n现在，我们应用边界条件来求解常数 $C_1$ 和 $C_2$：\n$p(0) = 0 \\implies C_1 \\left(-\\frac{\\sigma^2}{2v}\\right) + C_2 = 0 \\implies C_2 = C_1 \\frac{\\sigma^2}{2v}$。\n$p(a) = 1 \\implies C_1 \\left(-\\frac{\\sigma^2}{2v}\\right) e^{-\\frac{2va}{\\sigma^2}} + C_2 = 1$。\n将 $C_2$ 的表达式代入第二个方程：\n$$\nC_1 \\left(-\\frac{\\sigma^2}{2v}\\right) e^{-\\frac{2va}{\\sigma^2}} + C_1 \\frac{\\sigma^2}{2v} = 1 \\implies C_1 \\frac{\\sigma^2}{2v} \\left(1 - e^{-\\frac{2va}{\\sigma^2}}\\right) = 1\n$$\n解出 $C_1$ 得到 $C_1 = \\frac{2v/\\sigma^2}{1 - e^{-2va/\\sigma^2}}$。\n随后，$C_2 = \\frac{1}{1 - e^{-2va/\\sigma^2}}$。\n将这些常数代回 $p(z)$ 的表达式中：\n$$\np(z) = \\left(\\frac{2v/\\sigma^2}{1 - e^{-2va/\\sigma^2}}\\right) \\left(-\\frac{\\sigma^2}{2v}\\right) e^{-\\frac{2vz}{\\sigma^2}} + \\frac{1}{1 - e^{-2va/\\sigma^2}}\n$$\n$$\np(z) = \\frac{-e^{-\\frac{2vz}{\\sigma^2}}}{1 - e^{-2va/\\sigma^2}} + \\frac{1}{1 - e^{-2va/\\sigma^2}} = \\frac{1 - e^{-\\frac{2vz}{\\sigma^2}}}{1 - e^{-\\frac{2va}{\\sigma^2}}}\n$$\n这就是当 $v \\neq 0$ 时，在上边界吸收概率的闭式解。\n\n情况2：$v = 0$（零漂移极限）。\n当 $v=0$ 时，ODE 大大简化：\n$$\n\\frac{1}{2}\\sigma^2\\frac{d^2p}{dz^2} = 0 \\implies \\frac{d^2p}{dz^2} = 0\n$$\n对 $z$ 积分两次，得到一个线性解：$p(z) = C_1 z + C_2$。\n应用边界条件：\n$p(0) = 0 \\implies C_1(0) + C_2 = 0 \\implies C_2 = 0$。\n$p(a) = 1 \\implies C_1 a + C_2 = 1 \\implies C_1 a = 1 \\implies C_1 = 1/a$。\n因此，对于 $v=0$，解为：\n$$\np(z) = \\frac{z}{a}\n$$\n这个结果是直观的：在没有漂移的情况下，碰到一个边界的概率与起始点到另一个边界的距离成线性正比。\n我们可以使用洛必达法则来验证当 $v \\to 0$ 时，对于 $v \\neq 0$ 的通解会收敛到这个结果，该比值的形式为 $0/0$：\n$$\n\\lim_{v \\to 0} p(z) = \\lim_{v \\to 0} \\frac{1 - e^{-\\frac{2vz}{\\sigma^2}}}{1 - e^{-\\frac{2va}{\\sigma^2}}} = \\lim_{v \\to 0} \\frac{\\frac{d}{dv}\\left(1 - e^{-\\frac{2vz}{\\sigma^2}}\\right)}{\\frac{d}{dv}\\left(1 - e^{-\\frac{2va}{\\sigma^2}}\\right)} = \\lim_{v \\to 0} \\frac{\\frac{2z}{\\sigma^2} e^{-\\frac{2vz}{\\sigma^2}}}{\\frac{2a}{\\sigma^2} e^{-\\frac{2va}{\\sigma^2}}} = \\frac{z}{a}\n$$\n极限值匹配，证实了我们解的一致性。推导出的公式也能正确处理起始点在边界上 $z \\in \\{0, a\\}$ 的边缘情况。\n\n现在我们构建算法来计算给定试验的重复概率。\n1.  根据刺激强度 $s$ 和增益 $k$ 计算漂移率 $v$：\n    $$v = k\\,s$$\n2.  根据前一次选择 $c_{n-1} \\in \\{+1, -1\\}$ 和偏差大小 $b$ 计算初始位置 $z_{raw}$：\n    $$z_{raw} = \\frac{a}{2} + b\\,c_{n-1}$$\n3.  将起始点 $z$ 截断，以确保它位于决策边界 $[0, a]$ 内：\n    $$z = \\max(0, \\min(a, z_{raw}))$$\n4.  使用推导出的公式计算在上边界的吸收概率 $P_{upper} = p(z)$。必须特别注意 $v=0$ 的情况以确保数值稳定性。\n    $$\n    P_{upper} = \\begin{cases}\n    \\frac{z}{a}  \\text{ if } v = 0 \\\\\n    \\frac{1 - e^{-2vz/\\sigma^2}}{1 - e^{-2va/\\sigma^2}}  \\text{ if } v \\neq 0\n    \\end{cases}\n    $$\n5.  根据前一次选择 $c_{n-1}$ 确定下一次试验的重复概率 $P_{repeat}$。重复选择意味着如果前一次是“上方”选择（$c_{n-1}=+1$），则再次选择“上方”；如果前一次是“下方”选择（$c_{n-1}=-1$），则再次选择“下方”。\n    - 如果 $c_{n-1} = +1$，重复即为一次“上方”选择。其概率是 $P_{upper}$。\n    - 如果 $c_{n-1} = -1$，重复即为一次“下方”选择。其概率是 $P(\\text{到达 } 0) = 1 - P(\\text{到达 } a) = 1 - P_{upper}$。\n    因此：\n    $$\n    P_{repeat} = \\begin{cases}\n    P_{upper}  \\text{ if } c_{n-1} = +1 \\\\\n    1 - P_{upper}  \\text{ if } c_{n-1} = -1\n    \\end{cases}\n    $$\n最后，按要求将结果四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the repeat probability for a series of drift-diffusion model test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, sigma, k, s, b, c_n-1)\n    test_cases = [\n        (1.0, 1.0, 0.8, 0.5, 0.1, 1),   # Case 1\n        (1.0, 1.0, 0.5, 0.0, 0.2, 1),   # Case 2\n        (1.2, 0.9, 1.0, 0.6, 0.15, -1), # Case 3\n        (1.0, 1.0, 0.5, 1.5, 0.5, 1),   # Case 4\n        (1.0, 0.5, 0.4, -0.2, 0.05, 1)  # Case 5\n    ]\n\n    results = []\n    \n    # A small tolerance for floating point comparison with zero.\n    epsilon = 1e-12\n\n    for case in test_cases:\n        a, sigma, k, s, b, c_prev = case\n\n        # 1. Calculate drift rate v\n        v = k * s\n\n        # 2. Calculate initial position z_raw\n        z_raw = a / 2.0 + b * c_prev\n\n        # 3. Clip starting point z to be within [0, a]\n        z = np.clip(z_raw, 0, a)\n\n        # 4. Calculate the probability of absorption at the upper boundary, p_upper\n        p_upper = 0.0\n\n        if a = 0: # Defensive check, though problem implies a > 0\n            # If boundary separation is zero or negative, interpretation is difficult.\n            # A starting point z > 0 would mean it must hit the upper boundary.\n            if z > 0:\n                p_upper = 1.0\n            else:\n                p_upper = 0.0\n        elif abs(v)  epsilon:\n            # Handle v=0 case (linear solution)\n            p_upper = z / a\n        else:\n            # Handle v!=0 case (exponential solution)\n            # Using np.expm1(x) = exp(x) - 1 for numerical stability when the exponent is close to zero.\n            # The formula is (1 - exp(-2vz/s^2)) / (1 - exp(-2va/s^2))\n            # which is equivalent to (-expm1(-2vz/s^2)) / (-expm1(-2va/s^2))\n            \n            # Check for z being at a boundary, which are trivial cases\n            if z == 0:\n                p_upper = 0.0\n            elif z == a:\n                p_upper = 1.0\n            else:\n                exponent_arg_z = -2.0 * v * z / (sigma**2)\n                exponent_arg_a = -2.0 * v * a / (sigma**2)\n                \n                numerator = np.expm1(exponent_arg_z)\n                denominator = np.expm1(exponent_arg_a)\n                \n                # Avoid division by zero if denominator is zero (can happen with large exponents).\n                if abs(denominator)  epsilon:\n                    # Occurs if exp(exponent_arg_a) is 1. Should be caught by the v=0 case, but for safety.\n                    # Or if exp(exponent_arg_a) is numerically indistinguishable from 0.\n                    # If arg_a is large and positive (v  0), denominator -> -1.\n                    # If arg_a is large and negative (v > 0), denominator -> inf.\n                    # This edge case is unlikely given the standard formula.\n                    p_upper = z / a # Fallback to linear approximation\n                else: \n                     p_upper = numerator / denominator\n\n        # 5. Determine the repeat probability based on the previous choice\n        if c_prev == 1:\n            p_repeat = p_upper\n        else:  # c_prev == -1\n            p_repeat = 1.0 - p_upper\n\n        # Round to six decimal places for reporting\n        results.append(round(p_repeat, 6))\n\n    # Format the final output string as specified.\n    # We use .6f to ensure trailing zeros are printed.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}