{
    "hands_on_practices": [
        {
            "introduction": "味觉感知的第一步是味觉分子从唾液到达味蕾中的受体细胞。这个过程涉及到分子在微小空间内的物理运动，其效率直接影响我们感知味道的速度。本练习将引导你使用物理学中的扩散定律来估算一个亲水性味觉分子穿过味孔到达其受体所需的特征时间，从而帮助你理解味觉感知的物理限制和时间尺度。",
            "id": "5069244",
            "problem": "一种亲水性呈味物质要激活味觉感受器细胞顶端微绒毛上的G蛋白偶联受体（GPCR），必须从主体唾液中通过味孔扩散以到达该受体。考虑一个圆柱形味孔，从孔口处的唾液界面到微绒毛受体区域的有效一维路径长度为 $L$。假设在孔口处，呈味物质的浓度是固定的，而在孔内部最初不存在呈味物质，并且微绒毛区域对呈味物质来说是一个吸收边界。孔内的扩散可以理想化为一维扩散，扩散系数为 $D$。\n\n从扩散方程（Fick第二定律）出发，使用量纲分析或无量纲化，推导呈味物质穿过味孔并到达受体区域所需的特征时间尺度 $\\tau$ 的表达式。然后，使用Stokes–Einstein关系，在绝对温度为 $T$、粘度为 $\\eta$ 的牛顿流体中，估算一个流体动力学半径为 $r$ 的亲水性小分子的扩散系数 $D$。\n\n对唾液和味孔使用以下科学上合理的参数：\n- 绝对温度 $T = 310\\,\\mathrm{K}$。\n- 唾液的动力粘度 $\\eta = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$。\n- 呈味物质的流体动力学半径 $r = 0.35\\,\\mathrm{nm}$。\n- 味孔路径长度 $L = 12\\,\\mu \\mathrm{m}$。\n- Boltzmann常数 $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n在推导出 $\\tau$ 的表达式后，使用上述参数计算其数值。用秒表示最终时间，并将答案四舍五入到三位有效数字。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **物理系统**：亲水性呈味物质通过圆柱形味孔的扩散。\n- **模型**：由Fick第二定律支配的一维扩散。\n- **几何**：有效一维路径长度 $L$。\n- **边界条件**：\n    - 在孔口（$x=0$）：呈味物质浓度固定。\n    - 在微绒毛受体区域（$x=L$）：吸收边界。\n- **初始条件**：在孔内部最初不存在呈味物质（$t=0, x>0$）。\n- **扩散系数模型**：适用于亲水性小分子的Stokes-Einstein关系。\n- **参数**：\n    - 绝对温度：$T = 310\\,\\mathrm{K}$。\n    - 唾液动力粘度：$\\eta = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$。\n    - 呈味物质流体动力学半径：$r = 0.35\\,\\mathrm{nm}$。\n    - 味孔路径长度：$L = 12\\,\\mu \\mathrm{m}$。\n    - Boltzmann常数：$k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：该问题建立在物理学和物理化学的基本原理之上，即Fick扩散定律和Stokes-Einstein关系。将这些原理应用于模拟像味孔这样的生物微环境中的输运，是生物物理学和神经生物学中一种标准且有效的方法。\n- **适定性**：问题定义清晰。它要求从控制方程和参数中推导出一个特征时间尺度，然后进行数值计算。所提供的信息对于完成这些任务是充分且一致的。存在唯一且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。所提供的参数在指定的生物学背景下是科学合理的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它科学合理、适定且客观。将提供解答。\n\n第一步是推导在距离 $L$ 上扩散的特征时间尺度 $\\tau$ 的表达式。该过程由Fick第二定律支配，其一维形式为：\n$$\n\\frac{\\partial C(x,t)}{\\partial t} = D \\frac{\\partial^2 C(x,t)}{\\partial x^2}\n$$\n其中 $C(x,t)$ 是呈味物质在位置 $x$ 和时间 $t$ 的浓度，$D$ 是扩散系数。\n\n为了找到特征时间尺度，我们使用量纲分析。所涉及的物理量具有以下量纲，其中 $[L]$ 表示长度，$[T]$ 表示时间：\n- 位置 $x$: $[x] = [L]$\n- 时间 $t$: $[t] = [T]$\n- 扩散系数 $D$: $[D] = [L]^2 [T]^{-1}$\n\n该问题只有一个特征长度尺度，即孔长 $L$。我们寻求一个可以由 $L$ 和 $D$ 构成的特征时间尺度 $\\tau$。我们提出一个形式如下的关系：\n$$\n\\tau \\propto L^a D^b\n$$\n其中 $a$ 和 $b$ 是无量纲指数。为确保量纲一致，等式两边的量纲必须匹配：\n$$\n[T] = ([L])^a ([L]^2 [T]^{-1})^b = [L]^{a+2b} [T]^{-b}\n$$\n对每个基本量纲的指数进行等价：\n- 对于时间 $[T]$：$1 = -b \\implies b = -1$\n- 对于长度 $[L]$：$0 = a+2b \\implies a = -2b = -2(-1) = 2$\n\n因此，特征时间尺度必须与 $L^2/D$ 成正比。在此类标度分析中，通常将比例常数视为1的量级。我们将特征时间定义为：\n$$\n\\tau = \\frac{L^2}{D}\n$$\n这个表达式代表了粒子扩散通过距离 $L$ 所需的典型时间。\n\n第二步是找到扩散系数 $D$ 的表达式。题目要求我们使用Stokes-Einstein关系，该关系描述了半径为 $r$ 的球形粒子在绝对温度为 $T$、粘度为 $\\eta$ 的流体中的扩散：\n$$\nD = \\frac{k_B T}{6 \\pi \\eta r}\n$$\n其中 $k_B$ 是Boltzmann常数。\n\n结合这两个表达式，我们得到了用给定的物理参数表示的特征时间 $\\tau$ 的公式：\n$$\n\\tau = \\frac{L^2}{D} = \\frac{L^2}{\\left( \\frac{k_B T}{6 \\pi \\eta r} \\right)} = \\frac{6 \\pi \\eta r L^2}{k_B T}\n$$\n最后一步是计算 $\\tau$ 的数值。给定的参数必须首先转换为国际单位制（SI）的基本单位：\n- $T = 310\\,\\mathrm{K}$\n- $\\eta = 1.0 \\times 10^{-3}\\,\\mathrm{Pa\\,s}$\n- $r = 0.35\\,\\mathrm{nm} = 0.35 \\times 10^{-9}\\,\\mathrm{m}$\n- $L = 12\\,\\mu \\mathrm{m} = 12 \\times 10^{-6}\\,\\mathrm{m}$\n- $k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\n将这些值代入 $\\tau$ 的表达式中：\n$$\n\\tau = \\frac{6 \\pi (1.0 \\times 10^{-3}) (0.35 \\times 10^{-9}) (12 \\times 10^{-6})^2}{(1.380\\,649 \\times 10^{-23}) (310)}\n$$\n$$\n\\tau = \\frac{6 \\pi (1.0 \\times 10^{-3}) (0.35 \\times 10^{-9}) (144 \\times 10^{-12})}{4.279\\,9119 \\times 10^{-21}}\\,\\mathrm{s}\n$$\n$$\n\\tau = \\frac{9.499\\,813 \\times 10^{-22}}{4.279\\,9119 \\times 10^{-21}}\\,\\mathrm{s}\n$$\n$$\n\\tau \\approx 0.221\\,963\\,\\mathrm{s}\n$$\n按照要求，将结果四舍五入到三位有效数字，我们得到：\n$$\n\\tau \\approx 0.222\\,\\mathrm{s}\n$$",
            "answer": "$$\\boxed{0.222}$$"
        },
        {
            "introduction": "一旦味觉分子到达受体，神经元如何将其浓度信息转换为神经放电信号？通常，这个转换过程具有协同性，表现出类似开关的特性，使得感知系统对浓度的微小变化异常敏感。本练习通过分析经典的希尔方程（Hill equation），来探索受体结合的协同性（以希尔系数 $n$ 为特征）如何影响系统在检测阈值附近的敏感度，从而揭示了神经系统增强感觉辨别能力的精妙机制。",
            "id": "5069198",
            "problem": "舌头中对甜味敏感的味觉感受器细胞群将蔗糖浓度 $C$ 转换为初级味觉传入神经放电频率 $F(C)$，该频率可以通过希尔（Hill）剂量反应函数 $F(C) = \\dfrac{F_{\\max} C^{n}}{K_{d}^{n} + C^{n}}$ 进行合理建模，其中 $F_{\\max}$ 是最大放电频率，$K_{d}$ 是产生半数最大反应时的浓度，$n$ 是反映受体激活协同性的希尔系数。假设 $F_{\\max}$ 和 $K_{d}$ 是固定的生理参数，在 $n$ 变化时保持不变。将行为检测阈值处的灵敏度定义为输入-输出函数在 $C = K_{d}$ 处的斜率，即 $S_{\\mathrm{th}}(n) = \\left.\\dfrac{dF}{dC}\\right|_{C = K_{d}}$。以微积分和这些定义为出发点，推导出 $S_{\\mathrm{th}}(n)$，并计算当 $n$ 从 $1$ 增加到 $2$ 时灵敏度的倍数变化，即计算比率 $\\dfrac{S_{\\mathrm{th}}(2)}{S_{\\mathrm{th}}(1)}$。将最终答案表示为一个没有单位的纯数。简要解释这种变化将如何影响沿中枢味觉通路（该通路始于孤束核（NTS）并投射到味觉皮层）在阈值附近的辨别能力。无需四舍五入。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 步骤 1：提取已知条件\n-   初级味觉传入神经的放电频率 $F(C)$ 由希尔（Hill）剂量反应函数建模：$F(C) = \\dfrac{F_{\\max} C^{n}}{K_{d}^{n} + C^{n}}$。\n-   $C$ 是蔗糖浓度。\n-   $F_{\\max}$ 是最大放电频率，被视为固定参数。\n-   $K_{d}$ 是产生半数最大反应时的浓度，被视为固定参数。\n-   $n$ 是希尔系数。\n-   行为检测阈值处的灵敏度被定义为在 $C = K_{d}$ 处评估的输入-输出函数的斜率：$S_{\\mathrm{th}}(n) = \\left.\\dfrac{dF}{dC}\\right|_{C = K_{d}}$。\n-   任务是推导 $S_{\\mathrm{th}}(n)$ 的表达式，并计算比率 $\\dfrac{S_{\\mathrm{th}}(2)}{S_{\\mathrm{th}}(1)}$。\n-   任务还要求在中枢味觉通路的背景下对结果进行简要解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于定量神经生物学和药理学。希尔方程是描述协同结合和剂量反应现象（包括感觉受体对刺激的反应）的标准且被广泛接受的模型。将灵敏度定义为反应函数的一阶导数是感觉生理学中的一个基本概念。所提到的中枢通路（孤束核到味觉皮层）是对初级上行味觉通路的正确但简化的表述。\n-   **问题定义明确**：该问题定义明确。它提供了一个清晰定义的函数，并要求进行特定的数学推导（求导）和后续计算（求比率）。该函数是可微的，并且得出解的步骤是合乎逻辑且明确的。存在一个唯一且有意义的解。\n-   **客观性**：该问题以精确、客观和数学的语言陈述。它没有主观论断或含糊之处。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为它是科学合理的、定义明确的、并且客观的。它没有违反任何指定的无效标准。因此，我将继续进行解答。\n\n主要任务是推导灵敏度 $S_{\\mathrm{th}}(n)$，然后计算希尔系数 $n=2$ 和 $n=1$ 时灵敏度的比值。\n\n首先，我们必须求出放电频率函数 $F(C)$ 相对于浓度 $C$ 的导数。该函数为：\n$$ F(C) = \\dfrac{F_{\\max} C^{n}}{K_{d}^{n} + C^{n}} $$\n我们使用除法定则求导，该法则指出，对于函数 $f(x) = \\frac{u(x)}{v(x)}$，其导数为 $f'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$。\n设 $u(C) = F_{\\max} C^{n}$ 和 $v(C) = K_{d}^{n} + C^{n}$。\n$u(C)$ 和 $v(C)$ 相对于 $C$ 的导数是：\n$$ \\dfrac{du}{dC} = n F_{\\max} C^{n-1} $$\n$$ \\dfrac{dv}{dC} = n C^{n-1} $$\n应用除法定则：\n$$ \\dfrac{dF}{dC} = \\dfrac{(n F_{\\max} C^{n-1})(K_{d}^{n} + C^{n}) - (F_{\\max} C^{n})(n C^{n-1})}{(K_{d}^{n} + C^{n})^2} $$\n我们可以通过提取公因式 $n F_{\\max} C^{n-1}$ 来简化分子：\n$$ \\dfrac{dF}{dC} = \\dfrac{n F_{\\max} C^{n-1} [(K_{d}^{n} + C^{n}) - C^{n}]}{(K_{d}^{n} + C^{n})^2} $$\n括号中的 $C^n$ 项相互抵消：\n$$ \\dfrac{dF}{dC} = \\dfrac{n F_{\\max} C^{n-1} K_{d}^{n}}{(K_{d}^{n} + C^{n})^2} $$\n这个表达式代表了在任意浓度 $C$ 下剂量反应曲线的斜率。\n\n阈值处的灵敏度 $S_{\\mathrm{th}}(n)$ 定义为在 $C = K_{d}$ 处计算的该导数：\n$$ S_{\\mathrm{th}}(n) = \\left.\\dfrac{dF}{dC}\\right|_{C = K_{d}} = \\dfrac{n F_{\\max} (K_{d})^{n-1} K_{d}^{n}}{(K_{d}^{n} + (K_{d})^{n})^2} $$\n现在我们简化这个表达式。在分子中，我们合并 $K_{d}$ 的幂：\n$$ (K_{d})^{n-1} K_{d}^{n} = K_{d}^{(n-1)+n} = K_{d}^{2n-1} $$\n在分母中，我们合并括号内的项：\n$$ (K_{d}^{n} + K_{d}^{n})^2 = (2 K_{d}^{n})^2 = 4 (K_{d}^{n})^2 = 4 K_{d}^{2n} $$\n将这些代回到 $S_{\\mathrm{th}}(n)$ 的表达式中：\n$$ S_{\\mathrm{th}}(n) = \\dfrac{n F_{\\max} K_{d}^{2n-1}}{4 K_{d}^{2n}} $$\n使用指数法则 $\\frac{a^x}{a^y} = a^{x-y}$，我们简化 $K_d$ 项：\n$$ \\dfrac{K_{d}^{2n-1}}{K_{d}^{2n}} = K_{d}^{(2n-1) - 2n} = K_{d}^{-1} = \\dfrac{1}{K_{d}} $$\n因此，阈值处灵敏度的最终表达式是：\n$$ S_{\\mathrm{th}}(n) = \\dfrac{n F_{\\max}}{4 K_{d}} $$\n这表明在 $C=K_d$ 处的灵敏度与希尔系数成正比。\n\n接下来，我们必须计算当 $n$ 从 $1$ 增加到 $2$ 时灵敏度的倍数变化。这是比率 $\\dfrac{S_{\\mathrm{th}}(2)}{S_{\\mathrm{th}}(1)}$。\n使用我们推导出的 $S_{\\mathrm{th}}(n)$ 公式：\n当 $n = 1$ 时：\n$$ S_{\\mathrm{th}}(1) = \\dfrac{(1) F_{\\max}}{4 K_{d}} = \\dfrac{F_{\\max}}{4 K_{d}} $$\n当 $n = 2$ 时：\n$$ S_{\\mathrm{th}}(2) = \\dfrac{(2) F_{\\max}}{4 K_{d}} = \\dfrac{F_{\\max}}{2 K_{d}} $$\n现在，我们计算这个比率：\n$$ \\dfrac{S_{\\mathrm{th}}(2)}{S_{\\mathrm{th}}(1)} = \\dfrac{\\frac{F_{\\max}}{2 K_{d}}}{\\frac{F_{\\max}}{4 K_{d}}} $$\n常数 $F_{\\max}$ 和 $K_{d}$ 是固定的且非零，所以它们可以消去：\n$$ \\dfrac{S_{\\mathrm{th}}(2)}{S_{\\mathrm{th}}(1)} = \\dfrac{1/2}{1/4} = \\dfrac{1}{2} \\times \\dfrac{4}{1} = 2 $$\n灵敏度的倍数变化是 $2$。\n\n最后，我们提供一个简要的解释。灵敏度，作为响应曲线的斜率，量化了神经放电频率随刺激浓度的微小变化而变化的程度。希尔系数 $n$ 从 $1$ 增加到 $2$ 会使检测阈值（$C=K_d$）处的灵敏度加倍。这意味着，对于 $K_d$ 附近蔗糖浓度的微小变化，传入神经纤维的放电频率将表现出两倍大的变化。这个放大的信号随后被传输到孤束核（NTS），并中继到更高级的脑中枢，如味觉皮层。对于给定的刺激差异，更大的神经信号差异增强了系统辨别相似浓度的能力，使系统更像一个急剧的、开关式的检测器。因此，受体激活中更高的协同性（$n > 1$）导致阈值附近的感觉辨别能力增强。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "味觉信息不是由单个神经元编码的，而是通过整个神经元群体的活动模式来表征，这种模式被称为群体编码。我们如何解码这种复杂的群体活动来理解大脑是如何区分甜、咸、酸等不同味觉身份的？本练习将介绍主成分分析（PCA）这一强大的数据分析工具，并用它来识别神经响应数据中的主要变化维度，同时计算“参与率”来量化神经编码的分布式程度，让你亲身体验系统神经科学中用于分析群体编码的核心方法。",
            "id": "5069220",
            "problem": "给定一个实值神经响应矩阵 $R \\in \\mathbb{R}^{N \\times M}$，其中 $R_{ij}$ 表示神经元 $i$ 对味质 $j$ 的平均发放响应。目标是使用主成分分析（PCA）来识别低维味觉身份成分，并使用参与率来量化每个成分中有效参与的神经元数量。您的程序必须纯粹用数学术语实现以下过程。\n\n基本基础和定义：\n- 主成分分析（PCA）被定义为一种正交线性变换，它在观测空间中对协方差进行对角化。对于一个均值中心化的数据矩阵 $X \\in \\mathbb{R}^{N \\times M}$，一个等效且数值稳定的构造方法是奇异值分解 $X = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{N \\times N}$ 和 $V \\in \\mathbb{R}^{M \\times M}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{N \\times M}$ 是一个对角矩阵，其对角线上的非负奇异值按非递增顺序排列。\n- 神经元空间中的第 $k$ 个主成分由单位范数向量 $u_k \\in \\mathbb{R}^{N}$ 表示，该向量是 $U$ 的第 $k$ 列。\n- 一个单位向量 $w \\in \\mathbb{R}^{N}$ 的参与率（有效参与神经元的数量）定义为\n$$\n\\mathrm{PR}(w) \\equiv \\frac{1}{\\sum_{i=1}^{N} w_i^4}.\n$$\n\n每个测试用例需要执行的算法任务：\n1. 给定 $R \\in \\mathbb{R}^{N \\times M}$，为每个神经元构建跨味质的均值中心化矩阵：\n$$\nX_{ij} = R_{ij} - \\frac{1}{M}\\sum_{j'=1}^{M} R_{ij'}.\n$$\n2. 计算奇异值分解 $X = U \\Sigma V^{\\top}$。\n3. 设 $K = 3$。对于每个 $k \\in \\{1,2,3\\}$：\n   - 如果第 $k$ 个奇异值严格大于一个数值公差（将趋近于零的奇异值视为零方差分量），则取 $u_k$ 为 $U$ 的第 $k$ 列并计算\n   $$\n   \\mathrm{PR}_k = \\frac{1}{\\sum_{i=1}^{N} (u_k(i))^4}.\n   $$\n   - 否则，定义 $\\mathrm{PR}_k = 0$。\n4. 报告每个测试矩阵的序列 $\\mathrm{PR}_1, \\mathrm{PR}_2, \\mathrm{PR}_3$。每个参与率必须表示为四舍五入到 $6$ 位小数的小数。\n\n测试套件：\n- 案例 A ($N=5$, $M=4$):\n$$\nR^{(A)} =\n\\begin{bmatrix}\n4  4  0  0 \\\\\n3  3  0  0 \\\\\n0  0  5  5 \\\\\n0  0  6  6 \\\\\n1  1  1  1 \\\\\n\\end{bmatrix}.\n$$\n- 案例 B ($N=4$, $M=3$):\n$$\nR^{(B)} =\n\\begin{bmatrix}\n5  0  0 \\\\\n1  1  1 \\\\\n1  1  1 \\\\\n1  1  1 \\\\\n\\end{bmatrix}.\n$$\n- 案例 C ($N=3$, $M=4$):\n$$\nR^{(C)} =\n\\begin{bmatrix}\n2  2  2  2 \\\\\n2  2  2  2 \\\\\n2  2  2  2 \\\\\n\\end{bmatrix}.\n$$\n\n最终输出规格：\n- 您的程序必须生成单行输出，其中包含按 A、B、C 顺序连接的测试用例的参与率，每个案例按 $\\mathrm{PR}_1, \\mathrm{PR}_2, \\mathrm{PR}_3$ 的顺序贡献其结果。\n- 最终输出必须是一个用方括号括起来的逗号分隔列表。例如，一个有效的输出格式是 $[\\mathrm{A1},\\mathrm{A2},\\mathrm{A3},\\mathrm{B1},\\mathrm{B2},\\mathrm{B3},\\mathrm{C1},\\mathrm{C2},\\mathrm{C3}]$，其中每个条目都是一个四舍五入到 $6$ 位小数的小数。",
            "solution": "该问题要求对三个不同测试用例的神经响应数据的前三个主成分计算参与率。该过程基于对均值中心化响应矩阵进行主成分分析（PCA），通过奇异值分解（SVD）实现。\n\n核心定义如下：\n- 数据是一个神经响应矩阵 $R \\in \\mathbb{R}^{N \\times M}$，其中 $N$ 是神经元数量， $M$ 是味质数量。\n- 数据按每个神经元（逐行）进行均值中心化以获得矩阵 $X$：\n$$\nX_{ij} = R_{ij} - \\frac{1}{M}\\sum_{j'=1}^{M} R_{ij'}.\n$$\n- $X$ 的奇异值分解（SVD）为 $X = U \\Sigma V^{\\top}$。$U \\in \\mathbb{R}^{N \\times N}$ 的列（表示为 $u_k$）是神经元空间中的主成分。\n- 向量 $w \\in \\mathbb{R}^{N}$ 的参与率（PR）定义为：\n$$\n\\mathrm{PR}(w) = \\frac{1}{\\sum_{i=1}^{N} w_i^4}.\n$$\n我们必须计算 $k \\in \\{1, 2, 3\\}$ 的 $\\mathrm{PR}_k = \\mathrm{PR}(u_k)$。如果第 $k$ 个奇异值 $\\sigma_k$ 实际上为零，则我们定义 $\\mathrm{PR}_k = 0$。\n\n我们现在将根据指定的算法处理每个测试用例。\n\n### 案例 A\n\n给定的响应矩阵为：\n$$\nR^{(A)} =\n\\begin{bmatrix}\n4  4  0  0 \\\\\n3  3  0  0 \\\\\n0  0  5  5 \\\\\n0  0  6  6 \\\\\n1  1  1  1 \\\\\n\\end{bmatrix}.\n$$\n这里，神经元数量为 $N=5$，味质数量为 $M=4$。\n\n**步骤 1：均值中心化**\n我们计算每个神经元（行）对所有味质的平均响应。\n- 第 1 行均值：$\\mu_1 = (4+4+0+0)/4 = 2$。\n- 第 2 行均值：$\\mu_2 = (3+3+0+0)/4 = 1.5$。\n- 第 3 行均值：$\\mu_3 = (0+0+5+5)/4 = 2.5$。\n- 第 4 行均值：$\\mu_4 = (0+0+6+6)/4 = 3$。\n- 第 5 行均值：$\\mu_5 = (1+1+1+1)/4 = 1$。\n\n从它们各自的行中减去这些均值，得到均值中心化矩阵 $X^{(A)}$：\n$$\nX^{(A)} =\n\\begin{bmatrix}\n4-2  4-2  0-2  0-2 \\\\\n3-1.5  3-1.5  0-1.5  0-1.5 \\\\\n0-2.5  0-2.5  5-2.5  5-2.5 \\\\\n0-3  0-3  6-3  6-3 \\\\\n1-1  1-1  1-1  1-1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2  2  -2  -2 \\\\\n1.5  1.5  -1.5  -1.5 \\\\\n-2.5  -2.5  2.5  2.5 \\\\\n-3  -3  3  3 \\\\\n0  0  0  0\n\\end{bmatrix}.\n$$\n\n**步骤 2：奇异值分解**\n矩阵 $X^{(A)}$ 是一个秩为 1 的矩阵。这是因为每一列都是向量 $c = [2, 1.5, -2.5, -3, 0]^{\\top}$ 的倍数。具体来说，$X^{(A)} = c d^{\\top}$，其中 $d = [1, 1, -1, -1]^{\\top}$。对于一个秩为 1 的矩阵，其 SVD 将只有一个非零奇异值 $\\sigma_1$。所有其他奇异值（$\\sigma_2, \\sigma_3, \\dots$）都为零。\n第一个左奇异向量 $u_1$ 是归一化后的向量 $c$：\n$$\nu_1 = \\frac{c}{\\|c\\|_2}.\n$$\n首先，我们计算 $c$ 的欧几里得范数的平方：\n$$\n\\|c\\|_2^2 = (2)^2 + (1.5)^2 + (-2.5)^2 + (-3)^2 + (0)^2 = 4 + 2.25 + 6.25 + 9 = 21.5.\n$$\n所以，$u_1 = \\frac{1}{\\sqrt{21.5}} [2, 1.5, -2.5, -3, 0]^{\\top}$。\n\n**步骤 3：参与率**\n由于只有 $\\sigma_1$ 非零，根据问题定义，$\\mathrm{PR}_2 = 0$ 且 $\\mathrm{PR}_3 = 0$。\n我们计算 $\\mathrm{PR}_1$：\n$$\n\\mathrm{PR}_1 = \\frac{1}{\\sum_{i=1}^{5} (u_1(i))^4}.\n$$\n$u_1$ 各分量四次方的和是：\n$$\n\\sum_{i=1}^{5} (u_1(i))^4 = \\sum_{i=1}^{5} \\left(\\frac{c_i}{\\|c\\|_2}\\right)^4 = \\frac{\\sum_{i=1}^{5} c_i^4}{\\|c\\|_2^4}.\n$$\n我们计算分子和分母：\n$$\n\\sum_{i=1}^{5} c_i^4 = (2)^4 + (1.5)^4 + (-2.5)^4 + (-3)^4 + (0)^4 = 16 + 5.0625 + 39.0625 + 81 = 141.125.\n$$\n$$\n\\|c\\|_2^4 = (\\|c\\|_2^2)^2 = (21.5)^2 = 462.25.\n$$\n因此，参与率为：\n$$\n\\mathrm{PR}_1 = \\frac{1}{\\frac{141.125}{462.25}} = \\frac{462.25}{141.125} \\approx 3.2755102...\n$$\n四舍五入到 6 位小数，$\\mathrm{PR}_1 = 3.275510$。案例 A 的值为 $\\mathrm{PR}_1 = 3.275510$，$\\mathrm{PR}_2 = 0.000000$，$\\mathrm{PR}_3 = 0.000000$。\n\n### 案例 B\n\n给定的响应矩阵为：\n$$\nR^{(B)} =\n\\begin{bmatrix}\n5  0  0 \\\\\n1  1  1 \\\\\n1  1  1 \\\\\n1  1  1 \\\\\n\\end{bmatrix}.\n$$\n这里，$N=4$，$M=3$。\n\n**步骤 1：均值中心化**\n- 第 1 行均值：$\\mu_1 = (5+0+0)/3 = 5/3$。\n- 第 2, 3, 4 行均值：$\\mu_{2,3,4} = (1+1+1)/3 = 1$。\n\n均值中心化矩阵 $X^{(B)}$ 为：\n$$\nX^{(B)} =\n\\begin{bmatrix}\n5 - 5/3  0 - 5/3  0 - 5/3 \\\\\n1-1  1-1  1-1 \\\\\n1-1  1-1  1-1 \\\\\n1-1  1-1  1-1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n10/3  -5/3  -5/3 \\\\\n0  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n\n**步骤 2：奇异值分解**\n这也是一个秩为 1 的矩阵。它可以写成 $X^{(B)} = c d^{\\top}$，其中 $c=[1, 0, 0, 0]^{\\top}$，$d=[10/3, -5/3, -5/3]^{\\top}$。\n因此，只有第一个奇异值 $\\sigma_1$ 是非零的。第一个左奇异向量 $u_1$ 是归一化后的向量 $c$：\n$$\nu_1 = \\frac{c}{\\|c\\|_2} = \\frac{[1, 0, 0, 0]^{\\top}}{\\sqrt{1^2+0^2+0^2+0^2}} = [1, 0, 0, 0]^{\\top}.\n$$\n（注意：SVD 算法可能会得出 $[-1, 0, 0, 0]^{\\top}$，但由于 PR 使用四次方，因此它对符号变化是不变的）。\n\n**步骤 3：参与率**\n由于只有 $\\sigma_1$ 非零，因此 $\\mathrm{PR}_2 = 0$ 且 $\\mathrm{PR}_3 = 0$。\n我们计算 $\\mathrm{PR}_1$：\n$$\n\\mathrm{PR}_1 = \\frac{1}{\\sum_{i=1}^{4} (u_1(i))^4} = \\frac{1}{1^4 + 0^4 + 0^4 + 0^4} = \\frac{1}{1} = 1.\n$$\n案例 B 的值为 $\\mathrm{PR}_1 = 1.000000$，$\\mathrm{PR}_2 = 0.000000$，$\\mathrm{PR}_3 = 0.000000$。\n\n### 案例 C\n\n给定的响应矩阵为：\n$$\nR^{(C)} =\n\\begin{bmatrix}\n2  2  2  2 \\\\\n2  2  2  2 \\\\\n2  2  2  2 \\\\\n\\end{bmatrix}.\n$$\n这里，$N=3$，$M=4$。\n\n**步骤 1：均值中心化**\n每个神经元的响应对所有味质都是恒定的。每行的均值为 $(2+2+2+2)/4 = 2$。\n从每个元素中减去均值，得到一个零矩阵：\n$$\nX^{(C)} =\n\\begin{bmatrix}\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n\\end{bmatrix}.\n$$\n\n**步骤 2：奇异值分解**\n零矩阵的 SVD 导致所有奇异值都为零。因此，$\\sigma_1 = \\sigma_2 = \\sigma_3 = 0$。\n\n**步骤 3：参与率**\n根据问题陈述，如果一个奇异值不严格为正（即为零或在数值公差范围内接近零），相应的参与率定义为 $0$。由于 $\\sigma_1, \\sigma_2, \\sigma_3$ 都为零，我们有：\n$$\n\\mathrm{PR}_1 = 0, \\quad \\mathrm{PR}_2 = 0, \\quad \\mathrm{PR}_3 = 0.\n$$\n案例 C 的值为 $\\mathrm{PR}_1 = 0.000000$，$\\mathrm{PR}_2 = 0.000000$，$\\mathrm{PR}_3 = 0.000000$。\n\n### 结果总结\n计算出的参与率，四舍五入到 6 位小数，如下：\n- 案例 A: $[\\mathrm{3.275510, 0.000000, 0.000000}]$\n- 案例 B: $[\\mathrm{1.000000, 0.000000, 0.000000}]$\n- 案例 C: $[\\mathrm{0.000000, 0.000000, 0.000000}]$\n这些结果将被合并成一个列表作为最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the final result.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        np.array([\n            [4, 4, 0, 0],\n            [3, 3, 0, 0],\n            [0, 0, 5, 5],\n            [0, 0, 6, 6],\n            [1, 1, 1, 1]\n        ], dtype=float),\n        # Case B\n        np.array([\n            [5, 0, 0],\n            [1, 1, 1],\n            [1, 1, 1],\n            [1, 1, 1]\n        ], dtype=float),\n        # Case C\n        np.array([\n            [2, 2, 2, 2],\n            [2, 2, 2, 2],\n            [2, 2, 2, 2]\n        ], dtype=float)\n    ]\n\n    all_results = []\n    \n    # Define a numerical tolerance to check for non-zero singular values.\n    # Standard machine epsilon for float64 is ~2.22e-16. A slightly larger\n    # tolerance is robust for general numerical computations.\n    TOLERANCE = 1e-12\n\n    for R in test_cases:\n        # Step 1: Construct the mean-centered matrix X.\n        # The mean is calculated along axis 1 (across columns/tastants).\n        # keepdims=True ensures that the mean array has shape (N, 1) for broadcasting.\n        X = R - R.mean(axis=1, keepdims=True)\n\n        # Step 2: Compute the singular value decomposition X = U S V^T.\n        # We use full_matrices=True to be consistent with the definition of U in R^(N x N).\n        # SVD in numpy returns U, a vector of singular values 's', and V^T 'Vh'.\n        U, s, Vh = np.linalg.svd(X, full_matrices=True)\n\n        # Step 3: Compute participation ratios for the first K=3 components.\n        K = 3\n        case_results = []\n        for k in range(K):\n            # Check if the k-th singular value exists and is strictly positive.\n            # The length of 's' is min(N, M).\n            if k  len(s) and s[k] > TOLERANCE:\n                # The k-th principal component is the k-th column of U.\n                u_k = U[:, k]\n                # Compute PR_k using the formula.\n                pr_k = 1.0 / np.sum(np.power(u_k, 4))\n                case_results.append(pr_k)\n            else:\n                # If the singular value is zero (or near-zero), PR_k is 0.\n                case_results.append(0.0)\n        \n        all_results.extend(case_results)\n\n    # Step 4: Format and print the final output.\n    # Each value must be a decimal rounded to 6 places.\n    formatted_results = [f\"{res:.6f}\" for res in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver function.\nsolve()\n```"
        }
    ]
}