{
    "hands_on_practices": [
        {
            "introduction": "逻辑回归模型的直接输出是“对数优势”（log-odds），这个尺度并不直观。第一个练习将指导你完成一个基础过程：将对数优势值转换回概率。这个概率为个体风险提供了清晰且可解释的度量。掌握从线性预测值 $\\eta$ 到概率 $p$ 的转换是应用逻辑回归模型的基石。",
            "id": "4970702",
            "problem": "一个临床研究团队正在为因急性失代偿性心力衰竭入住重症监护室（ICU）的患者开发一个$30$天死亡率的预后模型。设 $Y \\in \\{0,1\\}$ 表示二元结局，其中 $Y=1$ 表示在$30$天内死亡，$Y=0$ 表示存活。假设 $Y \\mid \\boldsymbol{X}$ 服从参数为 $p(\\boldsymbol{X})$ 的伯努利分布，并且该模型是具有典则对数优势 (logit) 链接的广义线性模型。对于一个具有协变量 $\\boldsymbol{X}$ 的特定患者，拟合的线性预测值（也称为对数优势）为 $\\eta=-1.386$。\n\n仅从伯努利模型和广义线性模型中典则对数优势链接的定义出发，推导从线性预测值 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系，并计算该患者的 $p$ 的数值。简要说明所获得的 $p$ 值对于$30$天死亡风险的临床意义。\n\n以保留三位有效数字的小数形式提供 $p$ 的值。不要使用百分号。",
            "solution": "评估问题陈述的有效性。\n\n**步骤1：提取已知条件**\n-   结局变量：$Y \\in \\{0,1\\}$，其中 $Y=1$ 表示30天内死亡，$Y=0$ 表示存活。\n-   结局的条件分布：$Y \\mid \\boldsymbol{X} \\sim \\text{Bernoulli}(p(\\boldsymbol{X}))$。\n-   模型框架：广义线性模型（GLM）。\n-   链接函数：典则对数优势 (logit) 链接。\n-   特定患者的拟合线性预测值：$\\eta = -1.386$。\n-   任务：\n    1.  推导从线性预测值 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系。\n    2.  计算给定患者的 $p$ 的数值。\n    3.  简要说明所计算出的概率的临床意义。\n    4.  提供保留三位有效数字的 $p$ 值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于广义线性模型的理论，这是统计建模中一个标准和基础的课题。在此框架内，对二元结局使用伯努利分布和对数优势链接函数是典则选择。该问题提法恰当，提供了执行所要求的推导和计算所需的所有必要信息，从而能得出一个唯一的解。术语精确且客观。提供的线性预测值 $\\eta = -1.386$ 是一个合理的真实世界数值。不存在矛盾、歧义或违反科学原理的情况。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n***\n\n本题要求在广义线性模型（GLM）框架下，针对伯努利分布的结局，推导线性预测值 $\\eta$ 与事件概率 $p$ 之间的关系。\n\n一个广义线性模型由三个部分组成：\n1.  随机部分：响应变量 $Y$ 的分布是指数族的一员。\n2.  系统部分：一个线性预测值，$\\eta = \\boldsymbol{X}^T\\boldsymbol{\\beta}$。\n3.  链接函数：一个函数 $g$，它将随机部分的期望值 $\\mu = E[Y]$ 与系统部分关联起来，使得 $g(\\mu) = \\eta$。\n\n对于二元结局 $Y \\in \\{0,1\\}$，其条件分布是参数为 $p = P(Y=1 \\mid \\boldsymbol{X})$ 的伯努利分布。其概率质量函数为 $f(y;p) = p^y(1-p)^{1-y}$。为了确定典则链接函数，我们必须将其表示为指数族的典则形式：\n$$f(y; \\theta) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y, \\phi) \\right)$$\n重写伯努利概率质量函数（PMF）：\n$$f(y;p) = p^y(1-p)^{1-y} = \\exp\\left( \\ln\\left(p^y(1-p)^{1-y}\\right) \\right)$$\n$$= \\exp\\left( y\\ln(p) + (1-y)\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln(p) + \\ln(1-p) - y\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\left[\\ln(p) - \\ln(1-p)\\right] + \\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln\\left(\\frac{p}{1-p}\\right) + \\ln(1-p) \\right)$$\n将其与典则形式进行比较，我们可以确定典则参数为 $\\theta = \\ln\\left(\\frac{p}{1-p}\\right)$。量 $\\frac{p}{1-p}$ 是事件 $Y=1$ 发生的优势，其自然对数就是对数优势。伯努利变量的期望值为 $\\mu = E[Y] = p$。\n\n典则链接函数是将均值 $\\mu$ 映射到典则参数 $\\theta$ 的函数。对于伯努利分布，它是：\n$$g(p) = \\theta = \\ln\\left(\\frac{p}{1-p}\\right)$$\n这个函数 $g(p)$ 被称为对数优势函数（logit function）。\n\n在广义线性模型中，链接函数将结局的均值与线性预测值 $\\eta$ 联系起来。使用典则对数优势链接，我们有：\n$$\\eta = g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$$\n第一个任务是推导从 $\\eta$ 到 $p$ 的映射。这需要对对数优势函数求逆。我们对上述方程求解 $p$：\n$$\\exp(\\eta) = \\frac{p}{1-p}$$\n$$\\exp(\\eta)(1-p) = p$$\n$$\\exp(\\eta) - p\\exp(\\eta) = p$$\n$$\\exp(\\eta) = p + p\\exp(\\eta)$$\n$$\\exp(\\eta) = p(1 + \\exp(\\eta))$$\n$$p = \\frac{\\exp(\\eta)}{1 + \\exp(\\eta)}$$\n这个表达式提供了从线性预测值 $\\eta$ 到概率 $p$ 的映射。该函数通常被称为逻辑S型函数（logistic sigmoid function）。通过将分子和分母同除以 $\\exp(\\eta)$，可以得到一个等价且通常在数值上更稳定的形式：\n$$p = \\frac{1}{\\exp(-\\eta) + 1}$$\n推导完成。\n\n第二个任务是计算线性预测值为 $\\eta = -1.386$ 的患者的 $p$ 的数值。使用推导出的公式：\n$$p = \\frac{1}{1 + \\exp(-\\eta)} = \\frac{1}{1 + \\exp(-(-1.386))}$$\n$$p = \\frac{1}{1 + \\exp(1.386)}$$\n我们计算 $\\exp(1.386)$ 的值：\n$$\\exp(1.386) \\approx 3.998854$$\n将此值代回 $p$ 的表达式中：\n$$p \\approx \\frac{1}{1 + 3.998854} = \\frac{1}{4.998854} \\approx 0.20004585$$\n题目要求答案保留三位有效数字。第一位有效数字是 $2$，第二位是 $0$，第三位是 $0$。第四位数字是 $0$，因此我们向下舍入。\n$$p \\approx 0.200$$\n\n最后一个任务是陈述该值的临床意义。概率 $p$ 代表了模型对于具有给定协变量集合 $\\boldsymbol{X}$ 的患者发生事件 $Y=1$（30天内死亡）的可能性的预测。因此，$p=0.200$ 的值意味着，对于这位特定患者，预后模型估计其在入住ICU后30天内的死亡概率为 $20.0\\%$。这是该患者的个体预测风险。",
            "answer": "$$\n\\boxed{0.200}\n$$"
        },
        {
            "introduction": "除了预测个体风险，我们常常还想了解每个因素对风险的贡献程度。本练习侧重于解释模型的系数 $\\beta$，通过将其转换为优势比（Odds Ratio, OR）来实现。你将看到，对系数取指数可以揭示预测变量每增加一个单位，事件发生优势的乘法变化，这是沟通模型发现的关键技能。",
            "id": "4970670",
            "problem": "一项针对成年手术患者的前瞻性队列研究对二元结果 $Y \\in \\{0,1\\}$ 进行建模，其中 $Y=1$ 表示在 $30$ 天内发生严重术后感染。设 $\\mathbf{x} = (x_1,\\dots,x_p)$ 表示患者的协变量，其中包括高敏C反应蛋白 (hs-CRP)。hs-CRP 协变量被编码为 $x_j$，其定义为一个单位的 $x_j$ 增加对应于 hs-CRP 增加 $10$ mg/L。研究人员拟合了一个使用 logit 链接函数的逻辑斯蒂回归模型，其中给定协变量下的感染概率为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$，感染优势为 $p(\\mathbf{x})/(1 - p(\\mathbf{x}))$，对数优势 (logit) 为 $\\ln\\!\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)$。假设 $x_j$ 的估计回归系数为 $\\beta_j = 0.693$。\n\n从优势和 logit 链接函数的定义出发，并将所有其他协变量视为固定的，推导与 $x_j$ 增加一个单位相关的严重术后感染优势的乘法变化。然后，计算给定 $\\beta_j$ 的这个乘法变化。将您的最终数值答案四舍五入到四位有效数字，并且不包括单位。此外，陈述 $x_j$ 每增加一个单位，优势比为 $2$ 的临床解释（此解释不作为最终数值答案的一部分）。",
            "solution": "该问题是有效的，因为它在科学上基于生物统计学的原理，特别是逻辑斯蒂回归，并且问题提法清晰，为得出唯一解提供了所有必要信息。\n\n该问题要求在逻辑斯蒂回归模型中，为一个协变量单位增加推导事件优势的乘法变化，计算给定系数下的该值，并提供临床解释。\n\n设二元结果为 $Y \\in \\{0, 1\\}$，其中 $Y=1$ 代表我们感兴趣的事件（严重术后感染）。在给定协变量向量 $\\mathbf{x} = (x_1, \\dots, x_p)$ 的条件下，此事件的概率表示为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$。\n\n逻辑斯蒂回归模型使用 logit 链接函数，该函数将事件优势的自然对数建模为协变量的线性函数。优势定义为事件发生的概率与不发生的概率之比：\n$$\n\\text{Odds}(\\mathbf{x}) = \\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\n$$\n因此，对数优势（或 logit）为：\n$$\n\\text{logit}(p(\\mathbf{x})) = \\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)\n$$\n在逻辑斯蒂回归模型中，logit 表示为：\n$$\n\\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\n$$\n其中 $\\beta_0, \\beta_1, \\dots, \\beta_p$ 是回归系数。\n\n为了推导与特定协变量 $x_j$ 增加一个单位相关的优势的乘法变化，我们必须比较 $x_j$ 在两个不同水平下的优势，同时保持所有其他协变量（$k \\neq j$ 的 $x_k$）不变。\n\n设具有协变量 $\\mathbf{x}$ 的患者的优势表示为 $\\text{Odds}(\\mathbf{x})$。通过对 logit 方程取指数，我们得到：\n$$\n\\text{Odds}(\\mathbf{x}) = \\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)\n$$\n现在，考虑第二种情况，其中协变量 $x_j$ 增加一个单位至 $x_j + 1$。新的协变量向量是 $\\mathbf{x}' = (x_1, \\dots, x_j+1, \\dots, x_p)$。这种情况下的优势是：\n$$\n\\text{Odds}(\\mathbf{x}') = \\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)\n$$\n优势的乘法变化是新优势与原始优势的比值。这个比值被定义为 $x_j$ 变化一个单位的优势比 (OR)。\n$$\n\\text{OR}_j = \\frac{\\text{Odds}(\\mathbf{x}')}{\\text{Odds}(\\mathbf{x})} = \\frac{\\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n我们可以重写分子中的指数：\n$$\n\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j x_j + \\beta_j = \\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\n$$\n将此代回优势比的表达式中：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n使用属性 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们得到：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) \\exp(\\beta_j)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n项 $\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)$ 从分子和分母中消去，得到基本结果：\n$$\n\\text{OR}_j = \\exp(\\beta_j)\n$$\n这个推导表明，$x_j$ 每增加一个单位，优势的乘法变化等于系数 $\\beta_j$ 的指数。\n\n问题陈述，协变量 $x_j$（代表 hs-CRP）的估计系数为 $\\beta_j = 0.693$。我们现在可以计算优势的乘法变化：\n$$\n\\text{OR}_j = \\exp(0.693)\n$$\n我们计算这个值，并按要求四舍五入到四位有效数字：\n$$\n\\exp(0.693) \\approx 1.99970535 \\approx 2.000\n$$\n优势的乘法变化是 $2.000$。\n\n问题还要求对 $x_j$ 每增加一个单位，优势比为 $2$ 进行临床解释。协变量 $x_j$ 的编码方式是，其每增加一个单位对应于 hs-CRP 增加 $10$ mg/L。因此，$x_j$ 的优势比为 $2$ 意味着，在模型中所有其他患者特征保持不变的情况下，患者的 hs-CRP 水平每增加 $10$ mg/L，其在 $30$ 天内发生严重术后感染的优势估计会乘以 $2$（即，加倍）。",
            "answer": "$$\\boxed{2.000}$$"
        },
        {
            "introduction": "从模型中计算出的优势比是一个点估计，也就是基于数据的最佳猜测。然而，量化该估计值周围的不确定性也至关重要。最后一个练习将演示如何为优势比构建置信区间，为真实效应提供一个合理的范围，从而得出更稳健的科学结论。",
            "id": "4608660",
            "problem": "一项针对成年参与者的队列研究，在一个流感季节中进行随访，记录了一个二元结果 $Y$（$Y=1$ 表示新发流感，$Y=0$ 表示无流感），以及一组协变量，其中包括一个表示当前吸烟状况的二元指示变量 $X_{j}$（$X_{j}=1$ 表示当前吸烟者，$X_{j}=0$ 表示非当前吸烟者）。拟合了一个逻辑斯谛回归模型，该模型对二元结果使用标准对数优势链接函数，使得在给定协变量 $X$ 的条件下，$Y$ 的条件均值满足\n$$\\ln\\!\\left(\\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)}\\right) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k}.$$\n在协变量向量 $X$ 下的优势定义为\n$$O(X) = \\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)},$$\n并且，在其余协变量 $X_{-j}$ 取固定值时，比较 $X_{j}=1$ 与 $X_{j}=0$ 的优势比为\n$$\\text{OR} = \\frac{O(X_{j}=1, X_{-j})}{O(X_{j}=0, X_{-j})}.$$\n假设系数 $\\beta_{j}$ 的最大似然估计 (MLE) 为 $\\hat{\\beta}_{j} = 0.6425$，其估计的标准误为 $\\operatorname{SE}(\\hat{\\beta}_{j}) = 0.158$。在标准正则性条件下，假设 $\\hat{\\beta}_{j}$ 的大样本正态近似成立。仅使用上述定义和渐近正态性假设，推导与 $X_j$ 增加一个单位相关的优势比的点估计，并通过对系数尺度上的一个适当区间应用一个合适的单调变换，为该优势比构建一个双侧 $0.95$ 置信区间 (CI)。提供三个数值——点估计、置信区间的下界和上界——并将每个值四舍五入到四位有效数字。最终数值不需要单位。",
            "solution": "该问题要求计算从逻辑斯谛回归模型推导出的优势比 (OR) 的点估计和一个 $0.95$ 置信区间。该问题是良定的，并包含了得出完整解所需的所有信息。\n\n逻辑斯谛回归模型由下式给出：\n$$ \\ln\\!\\left(\\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)}\\right) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k} $$\n该方程的左边是在给定协变量向量 $X$ 的情况下，结果 $Y=1$ 的优势的自然对数。这通常被称为对数优势函数 (logit function)，$\\text{logit}(p) = \\ln(p/(1-p))$。\n因此，对数优势为：\n$$ \\ln(O(X)) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k} $$\n我们感兴趣的是，在保持所有其他协变量 $X_{-j}$ 不变的情况下，比较二元协变量 $X_j$ 为 $1$ 与为 $0$ 时结果的优势比。\n\n设 $X^{(1)}$ 为协变量向量，其中 $X_j = 1$ 且 $X_{-j}$ 固定。其对数优势为：\n$$ \\ln(O(X_j=1, X_{-j})) = \\beta_0 + \\beta_j(1) + \\sum_{k \\neq j} \\beta_k X_k $$\n设 $X^{(0)}$ 为协变量向量，其中 $X_j = 0$ 且 $X_{-j}$ 保持在相同的固定值。其对数优势为：\n$$ \\ln(O(X_j=0, X_{-j})) = \\beta_0 + \\beta_j(0) + \\sum_{k \\neq j} \\beta_k X_k = \\beta_0 + \\sum_{k \\neq j} \\beta_k X_k $$\n优势比 (OR) 定义为这两个优势的比值：\n$$ \\text{OR} = \\frac{O(X_j=1, X_{-j})}{O(X_j=0, X_{-j})} $$\n对优势比取自然对数，我们得到对数优势比：\n$$ \\ln(\\text{OR}) = \\ln(O(X_j=1, X_{-j})) - \\ln(O(X_j=0, X_{-j})) $$\n代入对数优势的表达式：\n$$ \\ln(\\text{OR}) = \\left(\\beta_0 + \\beta_j + \\sum_{k \\neq j} \\beta_k X_k\\right) - \\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k X_k\\right) = \\beta_j $$\n这表明系数 $\\beta_j$ 是 $X_j$ 变化一个单位的对数优势比。为了求出优势比本身，我们对对数优势比取指数：\n$$ \\text{OR} = \\exp(\\beta_j) $$\n\nOR 的点估计可以通过将 $\\beta_j$ 的最大似然估计 (MLE) $\\hat{\\beta}_j$ 代入此表达式得到。这由最大似然估计的不变性来保证。给定 $\\hat{\\beta}_j = 0.6425$：\n$$ \\widehat{\\text{OR}} = \\exp(\\hat{\\beta}_j) = \\exp(0.6425) \\approx 1.901233 $$\n四舍五入到四位有效数字，点估计为 $1.901$。\n\n为了构建 OR 的置信区间 (CI)，我们首先构建参数 $\\beta_j$ 的置信区间，然后应用单调变换。问题指出 $\\hat{\\beta}_j$ 是渐近正态分布的。$\\beta_j$ 的一个 $(1-\\alpha) \\times 100\\%$ 置信区间由下式给出：\n$$ \\hat{\\beta}_j \\pm z_{1-\\alpha/2} \\cdot \\operatorname{SE}(\\hat{\\beta}_j) $$\n对于一个 $0.95$ 的置信区间，$\\alpha = 0.05$，因此 $1-\\alpha/2 = 0.975$。来自标准正态分布的相应临界值为 $z_{0.975} \\approx 1.960$。\n给定 $\\hat{\\beta}_j = 0.6425$ 和 $\\operatorname{SE}(\\hat{\\beta}_j) = 0.158$，$\\beta_j$ 的 $95\\%$ 置信区间为：\n$$ 0.6425 \\pm 1.960 \\times 0.158 $$\n误差范围为 $1.960 \\times 0.158 = 0.30968$。\n$\\beta_j$ 的下界是 $L_{\\beta} = 0.6425 - 0.30968 = 0.33282$。\n$\\beta_j$ 的上界是 $U_{\\beta} = 0.6425 + 0.30968 = 0.95218$。\n所以，$\\beta_j$ 的 $95\\%$ 置信区间是 $[0.33282, 0.95218]$。\n\n由于函数 $f(x) = \\exp(x)$ 是严格单调递增的，我们可以通过对 $\\beta_j$ 置信区间的端点取指数来获得 $\\text{OR} = \\exp(\\beta_j)$ 的置信区间。\nOR 的下界是：\n$$ L_{\\text{OR}} = \\exp(L_{\\beta}) = \\exp(0.33282) \\approx 1.394895 $$\nOR 的上界是：\n$$ U_{\\text{OR}} = \\exp(U_{\\beta}) = \\exp(0.95218) \\approx 2.591453 $$\n\n最后，我们按要求将点估计和置信区间界限四舍五入到四位有效数字。\n点估计: $\\widehat{\\text{OR}} \\approx 1.901$\n下界: $L_{\\text{OR}} \\approx 1.395$\n上界: $U_{\\text{OR}} \\approx 2.591$\n\n三个数值分别是点估计 $1.901$，下界 $1.395$ 和上界 $2.591$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.901  1.395  2.591\n\\end{pmatrix}\n}\n$$"
        }
    ]
}