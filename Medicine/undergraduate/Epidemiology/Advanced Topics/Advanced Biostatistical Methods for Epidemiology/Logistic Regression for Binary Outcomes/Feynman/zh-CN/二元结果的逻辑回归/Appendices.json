{
    "hands_on_practices": [
        {
            "introduction": "逻辑回归模型的核心应用之一是进行个体风险预测。然而，模型直接输出的线性预测值（$\\eta$）是对数优势（log-odds），这个数值本身不够直观。为了使模型结果更具临床或实践意义，我们必须将其转换回一个介于 $0$ 和 $1$ 之间的概率值。这项练习  将指导您完成这个关键的转换过程，即将模型的抽象输出转化为对特定个体发生事件（如疾病）的直观风险评估。",
            "id": "4970702",
            "problem": "一个临床研究团队正在为因急性失代偿性心力衰竭入住重症监护室（ICU）的患者开发一个$30$天死亡率的预后模型。设$Y \\in \\{0,1\\}$表示二元结果，其中$Y=1$表示30天内死亡，$Y=0$表示存活。假设$Y \\mid \\boldsymbol{X}$服从参数为$p(\\boldsymbol{X})$的伯努利分布，并且该模型是一个带有典则logit链接的广义线性模型。对于一个具有协变量$\\boldsymbol{X}$的特定患者，拟合的线性预测子（也称为对数几率）为$\\eta=-1.386$。\n\n仅从伯努利模型和广义线性模型中典则logit链接的定义出发，推导从线性预测子$\\eta$到概率$p(\\boldsymbol{X})$的映射，并计算该患者的$p$的数值。简要说明所获得的$p$值对于30天死亡风险的临床意义。\n\n以小数形式提供$p$的值，并四舍五入到三位有效数字。不要使用百分号。",
            "solution": "评估问题陈述的有效性。\n\n**步骤1：提取已知条件**\n-   结果变量：$Y \\in \\{0,1\\}$，其中 $Y=1$ 表示30天内死亡，$Y=0$ 表示存活。\n-   结果的条件分布：$Y \\mid \\boldsymbol{X} \\sim \\text{Bernoulli}(p(\\boldsymbol{X}))$。\n-   模型框架：广义线性模型 (GLM)。\n-   链接函数：典则logit链接。\n-   特定患者的拟合线性预测子：$\\eta = -1.386$。\n-   任务：\n    1.  推导从线性预测子 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射。\n    2.  计算给定患者的 $p$ 的数值。\n    3.  简要说明所计算概率的临床意义。\n    4.  提供四舍五入到三位有效数字的 $p$ 值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于广义线性模型理论，这是统计建模中的一个标准和基础课题。在此框架内，对二元结果使用伯努利分布和logit链接函数是典则选择。问题提法得当，提供了执行所需推导和计算的所有必要信息，从而得到唯一解。术语精确客观。提供的线性预测子值 $\\eta = -1.386$ 是一个合理的现实世界值。不存在矛盾、歧义或违反科学原则的情况。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n***\n\n该问题要求在伯努利分布结果的广义线性模型（GLM）框架内，推导线性预测子 $\\eta$ 与事件概率 $p$ 之间的关系。\n\n一个GLM包含三个组成部分：\n1.  随机部分：响应变量 $Y$ 的分布是指数族的一员。\n2.  系统部分：一个线性预测子，$\\eta = \\boldsymbol{X}^T\\boldsymbol{\\beta}$。\n3.  链接函数：一个函数 $g$，它将随机部分的期望值 $\\mu = E[Y]$ 与系统部分关联起来，使得 $g(\\mu) = \\eta$。\n\n对于二元结果 $Y \\in \\{0,1\\}$，条件分布是参数为 $p = P(Y=1 \\mid \\boldsymbol{X})$ 的伯努利分布。其概率质量函数为 $f(y;p) = p^y(1-p)^{1-y}$。为了确定典则链接函数，我们必须将其表示为指数族的典则形式：\n$$f(y; \\theta) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y, \\phi) \\right)$$\n重写伯努利概率质量函数（PMF）：\n$$f(y;p) = p^y(1-p)^{1-y} = \\exp\\left( \\ln\\left(p^y(1-p)^{1-y}\\right) \\right)$$\n$$= \\exp\\left( y\\ln(p) + (1-y)\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln(p) + \\ln(1-p) - y\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\left[\\ln(p) - \\ln(1-p)\\right] + \\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln\\left(\\frac{p}{1-p}\\right) + \\ln(1-p) \\right)$$\n将其与典则形式进行比较，我们可以确定典则参数 $\\theta = \\ln\\left(\\frac{p}{1-p}\\right)$。量 $\\frac{p}{1-p}$ 是事件 $Y=1$ 的几率，其自然对数是对数几率。伯努利变量的期望值为 $\\mu = E[Y] = p$。\n\n典则链接函数是将均值 $\\mu$ 映射到典则参数 $\\theta$ 的函数。对于伯努利分布，它是：\n$$g(p) = \\theta = \\ln\\left(\\frac{p}{1-p}\\right)$$\n这个函数 $g(p)$ 被称为logit函数。\n\n在GLM中，链接函数将结果的均值与线性预测子 $\\eta$ 关联起来。使用典则logit链接，我们有：\n$$\\eta = g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$$\n第一个任务是推导从 $\\eta$ 到 $p$ 的映射。这需要对logit函数求逆。我们对上述方程求解 $p$：\n$$\\exp(\\eta) = \\frac{p}{1-p}$$\n$$\\exp(\\eta)(1-p) = p$$\n$$\\exp(\\eta) - p\\exp(\\eta) = p$$\n$$\\exp(\\eta) = p + p\\exp(\\eta)$$\n$$\\exp(\\eta) = p(1 + \\exp(\\eta))$$\n$$p = \\frac{\\exp(\\eta)}{1 + \\exp(\\eta)}$$\n这个表达式提供了从线性预测子 $\\eta$ 到概率 $p$ 的映射。这个函数通常被称为逻辑S型函数（logistic sigmoid function）。通过将分子和分母同时除以 $\\exp(\\eta)$，可以得到一个等价且通常数值上更稳定的形式：\n$$p = \\frac{1}{\\exp(-\\eta) + 1}$$\n推导完成。\n\n第二个任务是计算线性预测子为 $\\eta = -1.386$ 的患者的 $p$ 值。使用推导出的公式：\n$$p = \\frac{1}{1 + \\exp(-\\eta)} = \\frac{1}{1 + \\exp(-(-1.386))}$$\n$$p = \\frac{1}{1 + \\exp(1.386)}$$\n我们计算 $\\exp(1.386)$ 的值：\n$$\\exp(1.386) \\approx 3.998854$$\n将此值代回 $p$ 的表达式中：\n$$p \\approx \\frac{1}{1 + 3.998854} = \\frac{1}{4.998854} \\approx 0.20004585$$\n问题要求答案四舍五入到三位有效数字。第一位有效数字是 $2$，第二位是 $0$，第三位是 $0$。第四位数字是 $0$，所以我们向下舍入。\n$$p \\approx 0.200$$\n\n最后一个任务是说明这个值的临床意义。概率 $p$ 代表模型对于具有给定协变量集 $\\boldsymbol{X}$ 的患者发生事件 $Y=1$（30天内死亡）的可能性的预测。因此，$p=0.200$ 的值意味着，对于这位特定患者，预后模型估计其在入住ICU后30天内的死亡概率为 $20.0\\%$。这是该患者的个体预测风险。",
            "answer": "$$\n\\boxed{0.200}\n$$"
        },
        {
            "introduction": "除了预测个体风险，我们更关心的是理解不同风险因素如何影响结果。逻辑回归模型中的回归系数（$\\beta$）提供了量化这种影响的钥匙，但系数本身的大小并不直接对应于风险的倍数变化。通过本练习 ，您将学习如何将逻辑回归系数转换为优势比（Odds Ratio, OR），这是流行病学中衡量关联强度的核心指标。掌握这项技能，能让您清晰地解释某个风险因素（如某个生物标志物水平升高）会使疾病发生的优势增加多少倍。",
            "id": "4970670",
            "problem": "一项针对成年手术患者的前瞻性队列研究对二元结局 $Y \\in \\{0,1\\}$ 进行建模，其中 $Y=1$ 表示在 $30$ 天内发生严重术后感染。设 $\\mathbf{x} = (x_1,\\dots,x_p)$ 表示患者的协变量，包括高敏C反应蛋白 (hs-CRP)。hs-CRP 协变量被编码为 $x_j$，其定义为 $x_j$ 每增加一个单位，对应于 hs-CRP 增加 $10$ mg/L。研究人员使用 logit 链接函数拟合了一个逻辑回归模型，其中给定协变量下的感染概率为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$，感染的比值为 $p(\\mathbf{x})/(1 - p(\\mathbf{x}))$，对数比值 (logit) 为 $\\ln\\!\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)$。假设 $x_j$ 的估计回归系数为 $\\beta_j = 0.693$。\n\n从比值和 logit 链接的定义出发，并将所有其他协变量视为固定不变，推导与 $x_j$ 增加一个单位相关的严重术后感染比值的乘法变化。然后，根据给定的 $\\beta_j$ 计算这个乘法变化。将你的最终数值答案四舍五入到四位有效数字，并且不包括单位。此外，说明当 $x_j$ 每增加一个单位，比值比为 $2$ 时的临床解释（此解释不作为最终数值答案的一部分）。",
            "solution": "该问题是有效的，因为它在科学上基于生物统计学原理，特别是逻辑回归，并且提法明确，为得出唯一解提供了所有必要信息。\n\n该问题要求在一个逻辑回归模型中，推导协变量增加一个单位时事件比值的乘法变化，根据给定的系数计算其值，并提供临床解释。\n\n设二元结局为 $Y \\in \\{0, 1\\}$，其中 $Y=1$ 代表感兴趣的事件（严重术后感染）。在协变量向量 $\\mathbf{x} = (x_1, \\dots, x_p)$ 的条件下，该事件的概率记为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$。\n\n逻辑回归模型使用 logit 链接函数，该函数将事件比值的自然对数建模为协变量的线性函数。比值定义为事件发生的概率与不发生的概率之比：\n$$\n\\text{Odds}(\\mathbf{x}) = \\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\n$$\n因此，对数比值（或 logit）为：\n$$\n\\text{logit}(p(\\mathbf{x})) = \\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)\n$$\n在逻辑回归模型中，logit 表示为：\n$$\n\\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\n$$\n其中 $\\beta_0, \\beta_1, \\dots, \\beta_p$ 是回归系数。\n\n为了推导与特定协变量 $x_j$ 增加一个单位相关的比值的乘法变化，我们必须在保持所有其他协变量（$k \\neq j$ 时的 $x_k$）不变的情况下，比较 $x_j$ 在两个不同水平下的比值。\n\n设具有协变量 $\\mathbf{x}$ 的患者的比值为 $\\text{Odds}(\\mathbf{x})$。对 logit 方程取指数，我们得到：\n$$\n\\text{Odds}(\\mathbf{x}) = \\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)\n$$\n现在，考虑第二种情况，其中协变量 $x_j$ 增加一个单位变为 $x_j + 1$。新的协变量向量是 $\\mathbf{x}' = (x_1, \\dots, x_j+1, \\dots, x_p)$。这种情况下的比值为：\n$$\n\\text{Odds}(\\mathbf{x}') = \\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)\n$$\n比值的乘法变化是新比值与原始比值的比率。这个比率被定义为 $x_j$ 变化一个单位的比值比 (OR)。\n$$\n\\text{OR}_j = \\frac{\\text{Odds}(\\mathbf{x}')}{\\text{Odds}(\\mathbf{x})} = \\frac{\\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n我们可以重写分子中的指数项：\n$$\n\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j x_j + \\beta_j = \\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\n$$\n将此代回比值比的表达式中：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们得到：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) \\exp(\\beta_j)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n分子和分母中的项 $\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)$ 相互抵消，得出基本结果：\n$$\n\\text{OR}_j = \\exp(\\beta_j)\n$$\n这个推导表明，$x_j$ 每增加一个单位，比值的乘法变化等于系数 $\\beta_j$ 的指数。\n\n题目指出，协变量 $x_j$（代表 hs-CRP）的估计系数为 $\\beta_j = 0.693$。我们现在可以计算比值的乘法变化：\n$$\n\\text{OR}_j = \\exp(0.693)\n$$\n我们计算该值并按要求四舍五入到四位有效数字：\n$$\n\\exp(0.693) \\approx 1.99970535 \\approx 2.000\n$$\n比值的乘法变化为 $2.000$。\n\n该问题还要求对 $x_j$ 每增加一个单位的比值比为 $2$ 给出临床解释。协变量 $x_j$ 的编码方式是，其值增加一个单位对应于 hs-CRP 增加 $10$ mg/L。因此，$x_j$ 的比值比为 $2$ 意味着，假设模型中所有其他患者特征保持不变，患者的 hs-CRP 水平每增加 $10$ mg/L，其在 $30$ 天内发生严重术后感染的比值估计会乘以 $2$（即翻倍）。",
            "answer": "$$\\boxed{2.000}$$"
        },
        {
            "introduction": "我们从样本数据中估计出的优势比（OR）只是一个点估计值，它代表了真实效应的最佳猜测，但本身带有不确定性。为了更全面地评估风险因素的影响，我们需要量化这种不确定性，而置信区间（Confidence Interval, CI）正是实现这一目标的标准工具。本练习  将在前一个练习的基础上更进一步，教您如何利用回归系数的标准误来计算优势比的置信区间。这使得我们不仅能报告效应的大小，还能给出一个效应可能存在的合理范围，这是做出稳健科学推断的基石。",
            "id": "4608660",
            "problem": "一项对成年参与者在一个流感季节内进行的队列研究记录了一个二元结果 $Y$，该结果指示新发流感（$Y=1$）与无流感（$Y=0$），以及一组协变量，其中包括一个用于表示当前吸烟状况的二元指标 $X_{j}$（$X_{j}=1$ 表示当前吸烟者，$X_{j}=0$ 则表示非吸烟者）。使用适用于二元结果的典则 logit 链接拟合了一个逻辑斯谛回归模型，使得在给定协变量 $X$ 的情况下，$Y$ 的条件均值满足\n$$\\ln\\!\\left(\\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)}\\right) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k}.$$\n在协变量向量 $X$ 下的几率定义为\n$$O(X) = \\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)},$$\n并且在其余协变量 $X_{-j}$ 的值固定的情况下，比较 $X_{j}=1$ 与 $X_{j}=0$ 的几率比是\n$$\\text{OR} = \\frac{O(X_{j}=1, X_{-j})}{O(X_{j}=0, X_{-j})}.$$\n假设系数 $\\beta_{j}$ 的最大似然估计（maximum likelihood estimator (MLE)）为 $\\hat{\\beta}_{j} = 0.6425$，估计的标准误为 $\\operatorname{SE}(\\hat{\\beta}_{j}) = 0.158$。在标准正则性条件下，假设 $\\hat{\\beta}_{j}$ 的大样本正态近似成立。仅使用上述定义和渐近正态性假设，推导与 $X_{j}$ 增加一个单位相关的几率比的点估计，并通过对系数尺度上的适当区间应用合适的单调变换，构建该几率比的一个双侧 $0.95$ 置信区间（confidence interval (CI)）。提供三个数值——点估计、置信区间的下限和上限——并将每个数值四舍五入到四位有效数字。最终数值不需要单位。",
            "solution": "问题要求计算一个源自逻辑斯谛回归模型的几率比（OR）的点估计和一个 $0.95$ 置信区间。该问题提法恰当，并包含了完整解答所需的所有信息。\n\n逻辑斯谛回归模型由下式给出：\n$$ \\ln\\!\\left(\\frac{P(Y=1 \\mid X)}{1 - P(Y=1 \\mid X)}\\right) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k} $$\n该方程的左侧是在给定协变量向量 $X$ 的情况下结果 $Y=1$ 的几率的自然对数。这通常被称为 logit 函数，$\\text{logit}(p) = \\ln(p/(1-p))$。\n因此，对数几率为：\n$$ \\ln(O(X)) = \\beta_{0} + \\sum_{k} \\beta_{k} X_{k} $$\n我们感兴趣的是在保持所有其他协变量 $X_{-j}$ 不变的情况下，比较二元协变量 $X_j$ 为 $1$ 与为 $0$ 时结果的几率比。\n\n令 $X^{(1)}$ 为协变量向量，其中 $X_j = 1$ 且 $X_{-j}$ 固定。对数几率为：\n$$ \\ln(O(X_j=1, X_{-j})) = \\beta_0 + \\beta_j(1) + \\sum_{k \\neq j} \\beta_k X_k $$\n令 $X^{(0)}$ 为协变量向量，其中 $X_j = 0$ 且 $X_{-j}$ 保持在相同的固定值。对数几率为：\n$$ \\ln(O(X_j=0, X_{-j})) = \\beta_0 + \\beta_j(0) + \\sum_{k \\neq j} \\beta_k X_k = \\beta_0 + \\sum_{k \\neq j} \\beta_k X_k $$\n几率比（OR）定义为这两个几率之比：\n$$ \\text{OR} = \\frac{O(X_j=1, X_{-j})}{O(X_j=0, X_{-j})} $$\n对几率比取自然对数，我们得到对数几率比：\n$$ \\ln(\\text{OR}) = \\ln(O(X_j=1, X_{-j})) - \\ln(O(X_j=0, X_{-j})) $$\n代入对数几率的表达式：\n$$ \\ln(\\text{OR}) = \\left(\\beta_0 + \\beta_j + \\sum_{k \\neq j} \\beta_k X_k\\right) - \\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k X_k\\right) = \\beta_j $$\n这表明系数 $\\beta_j$ 是 $X_j$ 变化一个单位的对数几率比。为了求出几率比本身，我们对对数几率比取指数：\n$$ \\text{OR} = \\exp(\\beta_j) $$\n\nOR 的点估计可以通过将 $\\beta_j$ 的最大似然估计（MLE） $\\hat{\\beta}_j$ 代入此表达式来获得。这由最大似然估计的不变性性质所保证。给定 $\\hat{\\beta}_j = 0.6425$：\n$$ \\widehat{\\text{OR}} = \\exp(\\hat{\\beta}_j) = \\exp(0.6425) \\approx 1.901233 $$\n四舍五入到四位有效数字，点估计为 $1.901$。\n\n要构建 OR 的置信区间（CI），我们首先为参数 $\\beta_j$ 构建一个 CI，然后应用单调变换。问题指出 $\\hat{\\beta}_j$ 是渐近服从正态分布的。$\\beta_j$ 的一个 $(1-\\alpha) \\times 100\\%$ CI 由下式给出：\n$$ \\hat{\\beta}_j \\pm z_{1-\\alpha/2} \\cdot \\operatorname{SE}(\\hat{\\beta}_j) $$\n对于一个 $0.95$ 的 CI，$\\alpha = 0.05$，所以 $1-\\alpha/2 = 0.975$。来自标准正态分布的相应临界值为 $z_{0.975} \\approx 1.960$。\n给定 $\\hat{\\beta}_j = 0.6425$ 和 $\\operatorname{SE}(\\hat{\\beta}_j) = 0.158$，$\\beta_j$ 的 $95\\%$ CI 为：\n$$ 0.6425 \\pm 1.960 \\times 0.158 $$\n误差范围是 $1.960 \\times 0.158 = 0.30968$。\n$\\beta_j$ 的下限是 $L_{\\beta} = 0.6425 - 0.30968 = 0.33282$。\n$\\beta_j$ 的上限是 $U_{\\beta} = 0.6425 + 0.30968 = 0.95218$。\n所以，$\\beta_j$ 的 $95\\%$ CI 是 $[0.33282, 0.95218]$。\n\n由于函数 $f(x) = \\exp(x)$ 是严格单调递增的，我们可以通过对 $\\beta_j$ 的 CI 的端点取指数来获得 $\\text{OR} = \\exp(\\beta_j)$ 的 CI。\nOR 的下限是：\n$$ L_{\\text{OR}} = \\exp(L_{\\beta}) = \\exp(0.33282) \\approx 1.394895 $$\nOR 的上限是：\n$$ U_{\\text{OR}} = \\exp(U_{\\beta}) = \\exp(0.95218) \\approx 2.591453 $$\n\n最后，我们按要求将点估计和 CI 的界限四舍五入到四位有效数字。\n点估计：$\\widehat{\\text{OR}} \\approx 1.901$\n下限：$L_{\\text{OR}} \\approx 1.395$\n上限：$U_{\\text{OR}} \\approx 2.591$\n\n三个数值是点估计 $1.901$、下限 $1.395$ 和上限 $2.591$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.901  1.395  2.591\n\\end{pmatrix}\n}\n$$"
        }
    ]
}