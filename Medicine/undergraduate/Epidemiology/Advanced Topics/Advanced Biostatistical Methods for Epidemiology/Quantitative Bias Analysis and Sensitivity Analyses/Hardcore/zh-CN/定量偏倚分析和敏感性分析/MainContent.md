## 引言
在流行病学及临床研究中，从观察性数据中推断因果关系是一项核心任务，但其结论的可靠性常常受到系统性误差（偏倚）的挑战。传统研究往往仅在讨论部分定性提及偏倚的可能性，这使得结果的不确定性难以评估。定量偏倚分析（Quantitative Bias Analysis, QBA）与[敏感性分析](@entry_id:147555)正是为了填补这一空白而生，它们提供了一套严谨的框架，用以量化混杂、选择偏倚和信息偏倚对研究结果的具体影响，从而增强[科学推断](@entry_id:155119)的透明度与可信度。

本文将系统性地引导读者深入了解这一重要方法学领域。在“原理与机制”一章中，我们将详细拆解量化各类偏倚的数学模型，并介绍E值等关键的敏感性分析工具。随后的“应用与跨学科联系”一章将通过药物流行病学、健康公平性研究等领域的真实案例，展示这些分析方法如何将充满偏倚的原始数据转化为可靠的决策证据。最后，通过“动手实践”部分，读者将有机会亲手应用所学知识解决具体问题。通过本次学习，你将能够超越传统的统计分析，以更严谨、更负责任的方式评估和报告研究发现。

## 原理与机制

在流行病学和临床研究中，我们的目标通常是估计暴露与结局之间的因果效应。然而，[观察性研究](@entry_id:174507)的内在挑战在于，由于系统性误差（即偏倚）的存在，观测到的关联（association）可能并不等于真实的因果效应（causal effect）。定量偏倚分析（Quantitative Bias Analysis, QBA）和[敏感性分析](@entry_id:147555)（sensitivity analyses）为我们提供了一套严谨的数学工具，用以评估和校正这些偏倚对研究结果的潜在影响。本章将深入探讨三种主要偏倚——混杂（confounding）、信息偏倚（information bias）和选择偏倚（selection bias）——的量化原理，并介绍一种关键的[敏感性分析](@entry_id:147555)工具：E-值（E-value）。

### 定量偏倚分析框架

传统的流行病学分析通常在讨论部分定性地承认研究可能存在偏倚，但很少量化其大小和方向。定量偏倚分析则超越了这种定性描述，它要求研究者明确指定描述偏倚大小和方向的**偏倚参数**（bias parameters），然后利用这些参数计算出**偏倚校正后的效应估计值**（bias-adjusted effect estimate）。这个过程使我们能够评估，在给定的偏倚假设下，真实的因果效应可能与我们观测到的效应有何不同。

定量偏倚分析可以采取两种主要形式：
1.  **简单偏倚分析**：研究者为偏倚参数指定固定的、被认为是“最可能”的数值，并计算出一个单一的校正后估计值。
2.  **[敏感性分析](@entry_id:147555)**：由于偏倚参数通常是未知或不确定的，研究者可以探索一系列可能的参数值，从而得到一系列校正后的估计值。这有助于我们了解研究结论在多大程度上对不同的偏倚假设保持稳健（robust）。

接下来的几节将详细阐述如何为不同类型的偏倚建立数学模型。

### 量化未测混杂偏倚

混杂偏倚是最为熟知的系统性误差来源之一。当一个既与暴露相关又与结局相关的第三变量（即**混杂因素**，confounder）未被测量或未被充分控制时，就会产生混杂偏倚。

#### 混杂偏倚的机制与校正

假设我们研究一项二元暴露 $E$ 与二元结局 $Y$ 之间的关系，并观测到一个风险比（Risk Ratio）为 $RR_{obs}$。我们担心一个未测量的二元混杂因素 $U$ 可能扭曲了这一结果。为了量化这种偏倚，我们需要定义三个关键的偏倚参数：
*   $p_1 = P(U=1 \mid E=1)$：暴露组中混杂因素的患病率。
*   $p_0 = P(U=1 \mid E=0)$：非暴露组中混杂因素的患病率。
*   $RR_{UY}$：混杂因素 $U$ 与结局 $Y$ 之间的风险比，假定在暴露 $E$ 的各个分层中该值恒定。

利用全[概率法则](@entry_id:268260)，我们可以将观测到的风险比 $RR_{obs} = \frac{P(Y=1 \mid E=1)}{P(Y=1 \mid E=0)}$ 展开。暴露组的风险可以表示为混杂因素存在（$U=1$）和不存在（$U=0$）两种情况下的风险加权平均值：
$P(Y=1 \mid E=1) = P(Y=1 \mid E=1, U=1)P(U=1 \mid E=1) + P(Y=1 \mid E=1, U=0)P(U=0 \mid E=1)$

假设在混杂因素 $U$ 的每个分层内，暴露 $E$ 对结局 $Y$ 的真实因果风险比 $RR_{true}$ 是恒定的（即不存在效应修饰）。那么，$P(Y=1 \mid E=1, U=u) = RR_{true} \times P(Y=1 \mid E=0, U=u)$。同时，根据 $RR_{UY}$ 的定义，$P(Y=1 \mid E=e, U=1) = RR_{UY} \times P(Y=1 \mid E=e, U=0)$。通过代数替换和简化，我们可以推导出观测风险比与真实因果风险比之间的关系：

$RR_{obs} = RR_{true} \times B$

其中，$B$ 是**偏倚因子**（bias factor），它完全由我们定义的偏倚参数决定：
$B = \frac{p_1(RR_{UY} - 1) + 1}{p_0(RR_{UY} - 1) + 1}$

这个公式清晰地表明，观测到的关联是真实因果效应与由混杂引起的偏倚的乘积。因此，要得到偏倚校正后的因果风险比，我们只需将观测风险比除以偏倚因子：
$RR_{true} = \frac{RR_{obs}}{B}$

这一关系也可以通过潜在结局（potential outcomes）框架来理解。偏倚因子 $B$ 在一些文献中也被称为**混杂函数** $c$ ，它代表了暴露组与非暴露组之间基线（即如果两组均未暴露）风险的差异，这种差异完全由混杂因素 $U$ 的分布不均所致。

**示例：校正未测混杂**
一项观察性队列研究估计暴露 $E$ 对结局 $Y$ 的风险比 $RR_{obs} = 1.8$。研究者担心存在一个未测量的二元混杂因素 $U$。外部数据显示，暴露组中 $U$ 的患病率为 $P(U=1 \mid E=1) = 0.40$，非暴露组中为 $P(U=1 \mid E=0) = 0.20$。此外，混杂因素 $U$ 使结局 $Y$ 的风险增加到 $2.5$ 倍，即 $RR_{UY} = 2.5$。

根据上述公式，我们可以计算偏倚因子 $B$：
$B = \frac{0.40(2.5 - 1) + 1}{0.20(2.5 - 1) + 1} = \frac{0.40(1.5) + 1}{0.20(1.5) + 1} = \frac{0.60 + 1}{0.30 + 1} = \frac{1.6}{1.3} \approx 1.23$

然后，我们计算校正后的因果风险比：
$RR_{true} = \frac{RR_{obs}}{B} = \frac{1.8}{1.6/1.3} = 1.8 \times \frac{1.3}{1.6} = 1.4625$

校正到四位有效数字后为 $1.463$ 。这个例子表明，一个与暴露和结局均相关的混杂因素可以使观测关联（$1.8$）显著偏离真实的因果关联（$1.463$），偏倚分析能够帮助我们量化并校正这种影响。

### 纠正信息偏倚：错分

信息偏倚（或测量误差）源于对研究变量（如暴露、结局或协变量）的不精确测量。当这种测量误差导致个体被分入错误的类别时，我们称之为**错分**（misclassification）。

#### 无差异暴露错分的校正

最常见的一种情况是**无差异暴露错分**（nondifferential exposure misclassification），即暴露的测量误差独立于结局状态。这种错分通常（但不总是）会使效应估计值偏向于零关联。我们可以使用测量的**敏感性**（sensitivity, $Se$）和**特异性**（specificity, $Sp$）来量化并校正这种偏倚。
*   $Se = P(E^{\ast}=1 \mid E=1)$：真实暴露者被正确测量为暴露的概率。
*   $Sp = P(E^{\ast}=0 \mid E=0)$：真实非暴露者被正确测量为非暴露的概率。

我们的目标是从观测到的 $2 \times 2$ 表（基于错误的测量 $E^{\ast}$ 和真实的结局 $D$）恢复真实的 $2 \times 2$ 表（基于真实的暴露 $E$ 和真实的结局 $D$）。令 $a^{\ast}, c^{\ast}$ 分别为观测到的暴露和非暴露病例数，而 $a, c$ 为相应的真实病例数。它们之间的关系可以通过一个[线性方程组](@entry_id:140416)来描述：
$a^{\ast} = a \cdot Se + c \cdot (1-Sp)$
$c^{\ast} = a \cdot (1-Se) + c \cdot Sp$

其中，$1-Sp$ 是[假阳性](@entry_id:635878)概率，$1-Se$ 是假阴性概率。同样的关系也适用于非病例。通过求解这两组独立的[二元一次方程](@entry_id:172877)组，我们可以得到真实的病例数 $(a, c)$ 和非病例数 $(b, d)$，从而构建出校正后的 $2 \times 2$ 表，并计算出校正后的风险比 。

**示例：重建真实关联**
一项队列研究通过自我报告来评估职业溶剂暴露是否增加支[气管](@entry_id:150174)炎发作的风险。验证研究表明，自我报告的敏感性为 $0.70$，特异性为 $0.90$。在主研究中，观测到的病例中，120人报告暴露，80人报告未暴露；非病例中，880人报告暴露，3920人报告未暴露。

首先，计算观测到的风险比：风险（暴露）= $120 / (120+880) = 0.12$；风险（未暴露）= $80 / (80+3920) = 0.02$。观测 $RR = 0.12 / 0.02 = 6$。

现在，我们应用校正公式来求解真实的病例数 $(a, c)$：
$120 = a \cdot 0.70 + c \cdot 0.10$
$80 = a \cdot 0.30 + c \cdot 0.90$
解这个方程组得到 $a = 500/3$ 和 $c = 100/3$。

对非病例应用同样的方法得到真实的非病例数 $b = 2000/3$ 和 $d = 12400/3$。

现在，我们用这些“真实”的计数来计算校正后的风险：
真实暴露组风险 $R_{E=1} = \frac{a}{a+b} = \frac{500/3}{500/3 + 2000/3} = \frac{500}{2500} = \frac{1}{5}$
真实非暴露组风险 $R_{E=0} = \frac{c}{c+d} = \frac{100/3}{100/3 + 12400/3} = \frac{100}{12500} = \frac{1}{125}$

校正后的风险比为 $RR_{corrected} = \frac{1/5}{1/125} = 25$ 。这个惊人的结果表明，中等程度的无差异暴露错分（$Se=0.7, Sp=0.9$）可以将一个非常强的真实关联（$RR=25$）严重地削弱到仅为中等强度的观测关联（$RR=6$）。

### 应对选择偏倚

选择偏倚发生在研究样本不能代表我们想要研究的目标人群时，并且这种选择过程与暴露和结局均相关。

#### 类型一：信息性失访

在队列研究中，如果参与者的失访（loss to follow-up）概率取决于他们的暴露状态和未来的结局状态，就会产生**信息性失访**（informative censoring）。在这种情况下，仅基于被保留下来的参与者计算出的效应估计值可能是有偏的。

为了校正这种偏倚，我们可以进行[敏感性分析](@entry_id:147555)。这需要对失访人群中的结局风险做出假设。一个常见的方法是定义一个敏感性参数 $\lambda$，它表示在每个暴露组内，失访人群的结局风险相对于被保留人群的结局风险的比值 。
$\lambda_{E} = \frac{P(Y=1 \mid E=1, R=0)}{P(Y=1 \mid E=1, R=1)}$
$\lambda_{U} = \frac{P(Y=1 \mid E=0, R=0)}{P(Y=1 \mid E=0, R=1)}$
其中 $R=1$ 表示被保留，$R=0$ 表示失访。

利用全[概率法则](@entry_id:268260)，我们可以将每个暴露组的真实风险表示为保留人群和失访人群风险的加权平均值，从而计算出校正后的风险比。

**示例：失访偏倚校正**
一项队列研究中，暴露组的保留率为 $80\%$，保留者中的结局风险为 $0.12$。非暴露组的保留率为 $90\%$，保留者中的结局风险为 $0.08$。仅基于保留者的粗略风险比为 $0.12/0.08 = 1.50$。研究者假设，在暴露组中，失访者的风险是保留者的 $1.5$ 倍（$\lambda_E = 1.5$），而在非暴露组中，失访者的风险是保留者的 $0.75$ 倍（$\lambda_U = 0.75$）。

校正后暴露组的真实风险为：
$P(Y=1|E=1) = (0.12 \times 0.80) + (\lambda_E \times 0.12 \times 0.20) = (0.12 \times 0.80) + (1.5 \times 0.12 \times 0.20) = 0.096 + 0.036 = 0.132$

校正后非暴露组的真实风险为：
$P(Y=1|E=0) = (0.08 \times 0.90) + (\lambda_U \times 0.08 \times 0.10) = (0.08 \times 0.90) + (0.75 \times 0.08 \times 0.10) = 0.072 + 0.006 = 0.078$

校正后的风险比为 $RR_{adj} = 0.132 / 0.078 \approx 1.69$ 。与粗略值 $1.50$ 相比，这表明信息性失访可能掩盖了部分真实关联。

#### 类型二：对撞机-分层偏倚

当选择进入研究的变量（$S$）本身是暴露（$E$）和结局（$D$）的共同效应（即 $E \rightarrow S \leftarrow D$）时，$S$ 就被称为**[对撞机](@entry_id:192770)**（collider）。在分析中对 $S$ 进行分层或限制（例如，只分析 $S=1$ 的人群），可能会在 $E$ 和 $D$ 之间引入虚假的关联，即使它们在源人群中是独立的。这种偏倚被称为**对撞机-分层偏倚**（collider-stratification bias）。

如果我们可以从外部数据中获得选择概率，即 $P(S=1 \mid E=e, D=d)$，我们就可以校正这种偏倚。利用贝叶斯定理的逻辑，我们可以从在选定人群（$S=1$）中观测到的风险 $R_e^* = P(D=1 \mid E=e, S=1)$ 反推回源人群中的真实风险 $R_e = P(D=1 \mid E=e)$。校正公式如下 ：
$R_e = \frac{R_e^* \cdot P(S=1 \mid E=e, D=0)}{P(S=1 \mid E=e, D=1)(1 - R_e^*) + R_e^* \cdot P(S=1 \mid E=e, D=0)}$

这个公式允许我们从有偏的样本中恢复出源人群的真实风险，从而计算出无偏的风险比。

### 未测混杂的敏感性分析：E-值

在许多情况下，我们并不知道未测混杂因素的确切参数。此时，与其进行单一的偏倚校正，不如进行敏感性分析，以评估结果的稳健性。**E-值**（E-value）是一个广受欢迎的敏感性分析工具，它回答了一个关键问题：“一个未测混杂因素需要与暴露和结局有多强的关联，才能将观测到的效应完全‘解释掉’（即将其风险比移至零值1.0）？” 。

E-值的定义是：**在风险比尺度上，一个未测混杂因素必须与暴露和结局同时具有的最小关联强度，才能将观测到的风险比[点估计](@entry_id:174544)值解释为完全由混杂造成**。

E-值越大，表明结果越稳健，因为需要一个非常强的混杂因素才能推翻观测到的关联。

#### E-值的推导与计算

E-值的推导基于混杂偏倚因子的一个[上界](@entry_id:274738)。可以证明，对于一个与暴露关联强度为 $RR_{EU}$、与结局关联强度为 $RR_{UY}$ 的混杂因素，其能产生的最大偏倚因子为 $B_{max} = \frac{RR_{EU} \cdot RR_{UY}}{RR_{EU} + RR_{UY} - 1}$。要将观测到的 $RR_{obs}$ 解释掉，偏倚因子必须至少等于 $RR_{obs}$。E-值是在“最坏情况”下（即 $RR_{EU} = RR_{UY}$）计算得出的。我们设这个共同的关联强度为 $R^{\star}$（也称为**[临界点](@entry_id:142397)**，tipping point），并求解方程 $RR_{obs} = \frac{(R^{\star})^2}{2R^{\star}-1}$ 。

这会得到一个关于 $R^{\star}$ 的二次方程，其解为：
$R^{\star} = RR_{obs} \pm \sqrt{RR_{obs}(RR_{obs}-1)}$

我们取较大的根作为 E-值，因为它代表了所需的最小关联强度（必须大于等于1）。
*   对于风险关联 ($RR_{obs} > 1$):
    $E\text{-value} = RR_{obs} + \sqrt{RR_{obs}(RR_{obs} - 1)}$
*   对于保护性关联 ($RR_{obs}  1$):
    $E\text{-value} = \frac{1}{RR_{obs}} + \sqrt{\frac{1}{RR_{obs}}\left(\frac{1}{RR_{obs}} - 1\right)}$

**示例：计算和解释E-值**
1.  一项研究发现，调整协变量后，某暴露与疾病的风险比为 $RR_{obs} = 2.13$。该结果的E-值为：
    $E\text{-value} = 2.13 + \sqrt{2.13(2.13-1)} \approx 3.681$ 
    *   **解释**：一个未测量的混杂因素，如果它与暴露的关联以及与结局的关联（在调整了已测量协变量后）都至少达到风险比 $3.681$，才有可能将观测到的风险比 $2.13$ 完全解释为混杂所致。如果不存在这样强的混杂因素，那么观测到的关联中至少有一部分是真实的因果效应。

2.  一项比较有效性研究发现，新药相对于华法林的卒中风险比为 $RR_{obs} = 0.70$。这是一个保护性关联。其E-值为：
    $E\text{-value} = \frac{1}{0.70} + \sqrt{\frac{1}{0.70}\left(\frac{1}{0.70}-1\right)} \approx 2.21$ 
    *   **解释**：一个未测量的混杂因素（例如，基线衰弱，它可能导致医生更倾向于开新药，并且本身也增加卒中风险），如果它与用药选择的关联以及与卒中风险的关联都至少达到风险比 $2.21$，才有可能将观测到的保护性效应（$RR=0.70$）完全解释掉。

### 统一方法：序贯偏倚校正

在现实世界的研究中，多种偏倚来源往往并存。一个全面的定量偏倚分析可能需要按顺序校正这些偏倚。虽然不同偏倚之间的相互作用可能很复杂，但一种直观且可行的近似方法是**序贯校正**（sequential correction）。

一个典型的序贯校正流程如下：
1.  **第一步：校正信息偏倚**。从观测数据开始，首先校正暴露和/或结局的错分，得到一个校正了测量误差但仍然受到选择和混杂偏倚影响的效应估计值。
2.  **第二步：校正选择偏倚**。对上一步得到的结果进行选择偏倚校正，得到一个在源人群中但仍可能被混杂的效应估计值。
3.  **第三步：校正混杂偏倚**。最后，对上一步的结果进行未测混杂校正，得到最终的、旨在尽可能接近真实因果效应的估计值。

**综合示例：多重偏倚的序贯校正**
一项研究同时存在暴露错分（$Se=0.85, Sp=0.90$）和未测混杂（$p_1=0.30, p_0=0.10, RR_{UY}=2.0$）。研究人员从观测计数开始 ：
1.  首先，他们校正暴露错分，发现经错分校正后的风险比为 $5.5$。这表明原始观测数据中的测量误差严重低估了关联强度。
2.  然后，他们利用混杂偏倚参数计算偏倚因子 $B = \frac{0.30(2.0-1)+1}{0.10(2.0-1)+1} = \frac{1.3}{1.1}$。
3.  最后，他们将错分校正后的风险比除以偏倚因子，得到最终的因果风险比估计值：$RR_{final} = \frac{5.5}{1.3/1.1} \approx 4.65$。

这个过程展示了如何系统地“剥离”不同层次的偏倚，以期得到一个更接近真相的估计。虽然每一步都依赖于关于偏倚参数的假设，但这种透明的量化过程极大地增强了我们对研究结果不确定性的理解。