{
    "hands_on_practices": [
        {
            "introduction": "这个练习是一个思想实验，旨在阐明随机缺失（MAR）和非随机缺失（MNAR）之间微妙但至关重要的区别。通过构建一个特定的数据生成过程，您将亲身验证一个缺失机制如何能同时被视为MAR和MNAR，这完全取决于分析中包含了哪些变量。这项实践将揭示为何看似简单的完整案例分析（即只分析无缺失值的观测）即使在MAR条件下也可能导致有偏倚的结论 。",
            "id": "4928144",
            "problem": "考虑一项队列研究，其二元结局 $Y$ 表示某种状况的存在 ($Y=1$) 或不存在 ($Y=0$)，并有一个连续协变量 $X$ 代表一个标准化的风险评分。设 $X \\sim \\mathcal{N}(0,1)$，并假设数据收集方案仅记录协变量超过某个阈值的参与者的结局 $Y$。定义 $Y$ 的缺失指示变量 $R$，$R=1$ 表示观测到 $Y$，$R=0$ 表示 $Y$ 缺失。假设存在以下数据生成过程：\n- 结局由阈值规则 $Y=\\mathbf{1}\\{X0\\}$ 决定。\n- 缺失机制为 $R=\\mathbf{1}\\{X-0.5\\}$。\n\n使用完全随机缺失 (MCAR)、随机缺失 (MAR) 和非随机缺失 (MNAR) 的标准定义，在以 $X$ 为条件时将机制 $R$ 视为 MAR，但在从条件集中省略 $X$ 时将其视为 MNAR，并通过在指定的联合分布下计算 $P(R=1 \\mid Y=1)$ 和 $P(R=1 \\mid Y=0)$ 来形式化地证明这一点。\n\n接着，考虑边际患病率 $p=\\Pr(Y=1)$ 的完整病例估计量，定义为 $p_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)$。推导 $p$ 和 $p_{\\mathrm{cc}}$，并以标准正态累积分布函数 $\\Phi$ 的形式计算偏差 $b = p_{\\mathrm{cc}} - p$ 的闭式解析表达式。最后，简要解释此机制对完整病例分析和多重插补 (MI) 有效性的影响。\n\n你的最终答案应为偏差 $b$ 关于 $\\Phi$ 的单个闭式解析表达式。",
            "solution": "我们从基本定义开始。设 $R$ 表示 $Y$ 的缺失指示变量。完全随机缺失 (MCAR) 定义为 $P(R \\mid Y_{\\mathrm{mis}}, Y_{\\mathrm{obs}}, X)=P(R)$，随机缺失 (MAR) 定义为 $P(R \\mid Y_{\\mathrm{mis}}, Y_{\\mathrm{obs}}, X)=P(R \\mid Y_{\\mathrm{obs}}, X)$，而非随机缺失 (MNAR) 是其补集，即即使在以观测值为条件后，$R$ 的分布仍依赖于未观测到的数据。\n\n在给定的设置中，$X \\sim \\mathcal{N}(0,1)$，结局为 $Y=\\mathbf{1}\\{X0\\}$，缺失为 $R=\\mathbf{1}\\{X-0.5\\}$。因为 $R$ 仅依赖于 $X$，我们有\n$$\nP(R=1 \\mid X,Y)=P(R=1 \\mid X)=\\mathbf{1}\\{X-0.5\\},\n$$\n这表明，在以 $X$ 为条件下，缺失不依赖于 $Y$ 的未观测值，因此在以 $X$ 为条件时满足随机缺失 (MAR) 条件。\n\n为了证明当省略 $X$ 时该机制为非随机缺失 (MNAR)，我们通过对 $X$ 进行边际化并以 $Y$ 为条件来计算 $P(R=1 \\mid Y)$。首先观察到，根据阈值规则，$Y=1 \\iff X0$ 且 $Y=0 \\iff X \\le 0$。那么：\n- 对于 $Y=1$，我们有 $X0$，这意味着 $X-0.5$，因此\n$$\nP(R=1 \\mid Y=1)=P(X-0.5 \\mid X0)=1.\n$$\n- 对于 $Y=0$，我们有 $X \\le 0$，当 $X-0.5$ 时，缺失为 $R=1$。因此\n$$\nP(R=1 \\mid Y=0)=P(-0.5  X \\le 0 \\mid X \\le 0)\n=\\frac{P(-0.5  X \\le 0)}{P(X \\le 0)}\n=\\frac{\\Phi(0)-\\Phi(-0.5)}{\\Phi(0)},\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。利用对称性 $\\Phi(-a)=1-\\Phi(a)$ 和 $\\Phi(0)=\\frac{1}{2}$，这可以化简为\n$$\nP(R=1 \\mid Y=0)=\\frac{\\frac{1}{2}-\\left(1-\\Phi(0.5)\\right)}{\\frac{1}{2}}\n=\\frac{\\Phi(0.5)-\\frac{1}{2}}{\\frac{1}{2}}\n=2\\Phi(0.5)-1.\n$$\n由于 $P(R=1 \\mid Y=1)=1$ 且 $P(R=1 \\mid Y=0)=2\\Phi(0.5)-1$，我们得到 $P(R=1 \\mid Y=1) \\neq P(R=1 \\mid Y=0)$，这证明了当省略 $X$ 时机制为非随机缺失 (MNAR)。\n\n接下来，我们推导真实的边际患病率 $p=\\Pr(Y=1)$。因为 $Y=\\mathbf{1}\\{X0\\}$ 且 $X \\sim \\mathcal{N}(0,1)$，我们有\n$$\np=\\Pr(Y=1)=\\Pr(X0)=1-\\Phi(0)=\\frac{1}{2}.\n$$\n\n我们现在推导完整病例患病率 $p_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)$。由于 $R=1$ 当且仅当 $X-0.5$，且 $Y=1$ 当且仅当 $X0$，我们有\n$$\np_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)=\\Pr(X0 \\mid X-0.5)\n=\\frac{\\Pr(X0)}{\\Pr(X-0.5)}=\\frac{\\frac{1}{2}}{\\Phi(0.5)}.\n$$\n因此，边际患病率的完整病例估计量的偏差是\n$$\nb = p_{\\mathrm{cc}} - p \n= \\frac{\\frac{1}{2}}{\\Phi(0.5)} - \\frac{1}{2}\n= \\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right).\n$$\n\n对分析的影响：\n- 完整病例分析估计的是 $p_{\\mathrm{cc}}$ 而非 $p$，并且它是有偏的，因为观测数据中富集了较大的 $X$ 值，而根据阈值规则，这些值确定性地对应于 $Y=1$；因此 $p_{\\mathrm{cc}}>p$，偏差 $b$ 为正。\n- 如果插补模型以 $X$（驱动缺失的变量）为条件，那么多重插补 (MI) 在随机缺失 (MAR) 假设下会得出有效的推断。因为 $R$ 仅依赖于 $X$，将 $X$ 包含在插补模型中符合 MAR 假设，并允许一致地恢复 $Y$ 的边际分布。相反，省略 $X$ 会将缺失机制错误地指定为相对于插补模型而言的非随机缺失 (MNAR)，这通常会导致有偏的插补和对 $p$ 的有偏估计。\n\n所要求的偏差 $b$ 的闭式解析表达式为\n$$\nb=\\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right).\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right)}$$"
        },
        {
            "introduction": "在理解了完整案例分析的潜在陷阱后，我们转向更复杂的解决方案：多重插补（MI）。在实际应用MI时，一个核心问题是“需要进行多少次插补？”。本练习将理论与实践相结合，指导您推导并应用一个公式，该公式将缺失信息的比例与结果的统计效率联系起来，从而确定实现可靠推断所需的最少插补次数 $M$ 。",
            "id": "4928119",
            "problem": "一项前瞻性队列研究使用线性回归调查基线收缩压与一种连续性炎症生物标志物之间的关联。由于调查后勤方面的原因，一部分生物标志物的测量值缺失。探索性分析和研究程序表明，缺失机制为随机缺失（MAR），其条件是为所有参与者收集了已观测到的协变量。研究人员计划使用多重插补（MI）来处理缺失数据，并且必须选择插补次数 $M$，以确保相对于无限次插补的理想情况，推断是稳定的。\n\n他们进行了一项初步的 MI，使用了较大的临时插补次数，以估计目标回归斜率的缺失信息比例，得到的估计值为 $\\hat{\\lambda} = 0.35$。研究团队希望选择最小的 $M$，使得相对效率（定义为有限 $M$ 次 MI 相对于无限次 MI 的效率）至少为 $\\tau = 0.99$。\n\n根据缺失机制的核心定义（完全随机缺失 (MCAR)、随机缺失 (MAR) 和非随机缺失 (MNAR)）、完整病例分析的概念，以及在 MI 下缺失信息比例与相对效率之间的标准大样本关系，解决以下问题：\n\n1.  在 MCAR 和 MAR 机制下，定性解释总体缺失率如何影响缺失信息比例 $\\lambda$，以及这又如何影响稳定推断所需的插补次数 $M$。将此与完整病例分析进行对比，重点关注信息损失。\n2.  使用一个经过充分检验的、将 MI 下的相对效率与缺失信息比例联系起来的近似公式，推导出保证达到期望效率阈值的、用 $\\lambda$ 和 $\\tau$ 表示 $M$ 的不等式。\n3.  当 $\\hat{\\lambda} = 0.35$ 且 $\\tau = 0.99$ 时，计算满足该标准的最小整数 $M$。报告最小整数值 $M$。除了选择这个最小整数外，不需要进行额外的舍入。",
            "solution": "#### 1. 关于缺失、信息和分析选择的定性解释\n\n缺失数据机制由缺失概率对数据的依赖性来定义。如果一个值的缺失概率与所有变量（无论是观测到的还是未观测到的）都无关，则该值为完全随机缺失（MCAR）。如果以观测数据为条件，值的缺失概率与未观测值无关，则该值为随机缺失（MAR）。如果缺失概率依赖于未观测值本身，即使在以观测数据为条件后也是如此，则该值为非随机缺失（MNAR）。本问题陈述了一种 MAR 机制。\n\n缺失信息比例 $\\lambda$ 量化了由于数据缺失而损失的关于特定参数（此处为回归斜率）的统计信息量。它不仅仅是缺失数据点的百分比，而是其函数，同时也受到观测数据对缺失值的预测能力的影响。\n\n在 MCAR 和 MAR 两种机制下，总体缺失率与 $\\lambda$ 呈直接的正相关关系。生物标志物变量中缺失值的比例越高，通常会导致回归斜率的缺失信息比例 $\\lambda$ 越大。然而，在 MAR 机制下，这种关系受到插补模型强度的调节。如果用于插补的观测协变量与生物标志物高度相关，它们可以“恢复”大量信息，从而在给定的缺失率下，使得 $\\lambda$ 低于在弱插补模型或 MCAR 机制下的情况。\n\n所需的插补次数 $M$ 直接由 $\\lambda$ 决定。多重插补通过生成 $M$ 个合理的完整数据集版本并合并结果来解释由缺失数据引起的不确定性。MI 估计的总方差是插补内方差的平均值与插补间方差之和，后者捕捉了由缺失引起的不确定性。较大的 $\\lambda$ 意味着由缺失带来的更大不确定性，这表现为更大的插补间方差。为了可靠地估计此方差分量并实现稳定、高效的推断，需要更多的插补次数 $M$。\n\n相比之下，完整病例分析（CCA）只分析没有缺失数据的受试者，通过删除来处理缺失。对于 CCA，信息损失的主要形式是样本量的减少。这种统计功效的损失通常比正确执行的 MI 中的有效信息损失要严重得多。虽然 CCA 在严格的 MCAR 假设下提供无偏估计，但在 MAR（即本问题中的情景）下可能导致严重的有偏估计。例如，如果较高的生物标志物值与一个同时也预测该测量值被获取机会较低的观测协变量相关联，CCA 会系统地排除这些受试者，从而使估计的回归斜率产生偏差。MI 通过使用所有可用数据，避免了这种样本量的减少，并且如果插补模型设定正确，在 MAR 下能提供无偏且更高效的估计值。\n\n#### 2. 推导关于 $M$ 的不等式\n\n设 $\\hat{\\theta}$ 为目标参数（回归斜率）的估计值。在具有 $M$ 个插补数据集的多重插补中，根据鲁宾法则，合并估计的总方差 $T_M$ 为：\n$$ T_M = W + \\left(1 + \\frac{1}{M}\\right)B $$\n其中 $W$ 是平均插补内方差，B 是插补间方差。\n\n在无限次插补（$M \\to \\infty$）时获得的理想方差为：\n$$ T_{\\infty} = \\lim_{M\\to\\infty} \\left[W + \\left(1 + \\frac{1}{M}\\right)B\\right] = W + B $$\n缺失信息比例 $\\lambda$ 定义为可归因于缺失数据的总方差的比例：\n$$ \\lambda = \\frac{B}{T_{\\infty}} = \\frac{B}{W+B} $$\n相对效率 $\\tau$ 是理想方差与有限次插补 $M$ 时的方差之比：\n$$ \\tau = \\frac{T_{\\infty}}{T_M} = \\frac{W+B}{W + \\left(1 + \\frac{1}{M}\\right)B} $$\n为了用 $\\lambda$ 表示它，我们可以将分子和分母同除以 $T_{\\infty} = W+B$：\n$$ \\tau = \\frac{\\frac{W+B}{W+B}}{\\frac{W}{W+B} + \\left(1 + \\frac{1}{M}\\right)\\frac{B}{W+B}} $$\n根据 $\\lambda$ 的定义，我们知道 $\\frac{B}{W+B} = \\lambda$ 且 $\\frac{W}{W+B} = 1 - \\lambda$。将这些代入 $\\tau$ 的方程中得到：\n$$ \\tau = \\frac{1}{(1-\\lambda) + \\left(1 + \\frac{1}{M}\\right)\\lambda} = \\frac{1}{1-\\lambda + \\lambda + \\frac{\\lambda}{M}} = \\frac{1}{1 + \\frac{\\lambda}{M}} $$\n这就是那个“经过充分检验的近似公式”或标准公式。问题要求相对效率至少为 $\\tau$。因此我们建立不等式：\n$$ \\frac{1}{1 + \\frac{\\lambda}{M}} \\geq \\tau $$\n由于 $1 + \\frac{\\lambda}{M}$ 和 $\\tau$ 都是正数，我们可以变换不等式：\n$$ 1 \\geq \\tau \\left(1 + \\frac{\\lambda}{M}\\right) $$\n$$ \\frac{1}{\\tau} \\geq 1 + \\frac{\\lambda}{M} $$\n$$ \\frac{1}{\\tau} - 1 \\geq \\frac{\\lambda}{M} $$\n$$ \\frac{1-\\tau}{\\tau} \\geq \\frac{\\lambda}{M} $$\n由于 $M$ 必须是正整数，我们可以乘以 $M$ 并重新整理以解出 $M$：\n$$ M \\left(\\frac{1-\\tau}{\\tau}\\right) \\geq \\lambda $$\n$$ M \\geq \\lambda \\left(\\frac{\\tau}{1-\\tau}\\right) $$\n这就是所求的用 $\\lambda$ 和 $\\tau$ 表示 $M$ 的不等式。\n\n#### 3. 计算最小整数 $M$\n\n我们已知估计的缺失信息比例 $\\hat{\\lambda} = 0.35$ 和目标相对效率 $\\tau = 0.99$。我们将估计的 $\\hat{\\lambda}$ 作为真实 $\\lambda$ 的代入值，代入推导出的不等式中。\n$$ M \\geq 0.35 \\left(\\frac{0.99}{1-0.99}\\right) $$\n$$ M \\geq 0.35 \\left(\\frac{0.99}{0.01}\\right) $$\n$$ M \\geq 0.35 \\times 99 $$\n$$ M \\geq 34.65 $$\n由于插补次数 $M$ 必须是整数，我们必须选择满足此条件的最小整数。大于或等于 $34.65$ 的最小整数是 $35$。\n因此，为了达到至少 $99\\%$ 的期望相对效率，需要至少进行 $M=35$ 次插补。",
            "answer": "$$\\boxed{35}$$"
        },
        {
            "introduction": "多重插补的质量在很大程度上取决于其插补模型的优劣。确定了插补次数后，下一步便是构建一个能够准确反映数据关系的插补模型。本练习模拟了一个在流行病学研究中常见的真实场景：您需要从几个候选模型中选择最合适的插补模型。通过使用像贝叶斯信息准则（BIC）这样的标准统计工具，您将学会如何在模型复杂性与拟合优度之间做出权衡，以确保生成的插补值尽可能真实有效 。",
            "id": "4611910",
            "problem": "一项队列研究旨在估计在基线测量的连续性炎症生物标志物 $Y$ 与两个协变量之间的关联：年龄 $X$（以年为单位）和吸烟状况 $Z$（二元变量，$Z \\in \\{0,1\\}$）。由于部分参与者未响应，生物标志物 $Y$ 的数据存在缺失。研究人员根据研究设计和辅助信息判断，该缺失属于随机缺失（Missing At Random, MAR），即 $P(R=1 \\mid Y, X, Z) = P(R=1 \\mid X, Z)$，其中 $R$ 表示 $Y$ 的响应情况。为了执行多重插补（Multiple Imputation, MI），他们将使用一个同方差正态线性模型对条件分布 $Y \\mid X, Z$ 下的 $Y$ 进行插补。\n\n他们考虑了三个候选的 $Y \\mid X, Z$ 插补模型，所有模型都具有独立同分布的正态误差和未知的残差方差：\n\n- 模型 $M_{1}$: $Y = \\beta_{0} + \\beta_{1} X + \\varepsilon$。\n- 模型 $M_{2}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\varepsilon$。\n- 模型 $M_{3}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ + \\beta_{4} X^{2} + \\varepsilon$。\n\n所有三个模型都包含一个未知的误差方差 $\\sigma^{2}$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2})$，在参与者之间相互独立。仅使用 $Y$ 的观测案例（$n_{\\text{obs}} = 420$），三个模型的最大观测数据对数似然值如下：\n$$\\ell_{1} = -605.3,\\quad \\ell_{2} = -598.9,\\quad \\ell_{3} = -597.2.$$\n\n请根据一个在MAR下一致且适用于选择 $Y \\mid X, Z$ 的观测数据分布的参数模型的大样本、基于似然的选择原则来选择一个插补模型。将所选模型的索引 $m \\in \\{1,2,3\\}$ 作为单个数字报告。最终答案无需四舍五入。",
            "solution": "插补模型的选择将基于贝叶斯信息准则（BIC），因为它满足问题对大样本、基于似然且一致的选择原则的要求。BIC的定义为：\n$$\\text{BIC} = k \\ln(n) - 2\\ell$$\n其中 $k$ 是模型中估计的参数数量， $n$ 是用于拟合模型的观测数量， $\\ell$ 是对数似然函数的最大化值。应优先选择BIC值最小的模型。\n\n在这个问题中，模型是使用具有 $Y$ 完整数据的 $n_{\\text{obs}} = 420$ 名参与者进行拟合的。因此，我们设 $n = 420$。每个模型 $M_m$ 的对数似然值 $\\ell_m$ 是已知的。必须确定每个模型的参数数量 $k$ 。对于正态线性模型，参数包括回归系数（$\\beta$）和残差方差（$\\sigma^{2}$）。\n\n1.  **模型 $M_{1}$: $Y = \\beta_{0} + \\beta_{1} X + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$ 和 $\\sigma^2$。\n    参数数量为 $k_{1} = 3$。\n    对数似然值为 $\\ell_{1} = -605.3$。\n    BIC为：\n    $$\\text{BIC}_{1} = k_{1} \\ln(n_{\\text{obs}}) - 2\\ell_{1} = 3 \\ln(420) - 2(-605.3) = 3 \\ln(420) + 1210.6$$\n\n2.  **模型 $M_{2}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$、$\\beta_2$ 和 $\\sigma^2$。\n    参数数量为 $k_{2} = 4$。\n    对数似然值为 $\\ell_{2} = -598.9$。\n    BIC为：\n    $$\\text{BIC}_{2} = k_{2} \\ln(n_{\\text{obs}}) - 2\\ell_{2} = 4 \\ln(420) - 2(-598.9) = 4 \\ln(420) + 1197.8$$\n\n3.  **模型 $M_{3}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ + \\beta_{4} X^{2} + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$、$\\beta_2$、$\\beta_3$、$\\beta_4$ 和 $\\sigma^2$。\n    参数数量为 $k_{3} = 6$。\n    对数似然值为 $\\ell_{3} = -597.2$。\n    BIC为：\n    $$\\text{BIC}_{3} = k_{3} \\ln(n_{\\text{obs}}) - 2\\ell_{3} = 6 \\ln(420) - 2(-597.2) = 6 \\ln(420) + 1194.4$$\n\n现在，我们必须比较三个BIC值以找到最小值。我们可以使用近似值 $\\ln(420) \\approx 6.04025$。\n$$\\text{BIC}_{1} \\approx 3(6.04025) + 1210.6 = 18.12075 + 1210.6 = 1228.72075$$\n$$\\text{BIC}_{2} \\approx 4(6.04025) + 1197.8 = 24.161 + 1197.8 = 1221.961$$\n$$\\text{BIC}_{3} \\approx 6(6.04025) + 1194.4 = 36.2415 + 1194.4 = 1230.6415$$\n\n比较计算出的值：\n$\\text{BIC}_{1} \\approx 1228.72$\n$\\text{BIC}_{2} \\approx 1221.96$\n$\\text{BIC}_{3} \\approx 1230.64$\n\n最小值是 $\\text{BIC}_{2}$。这表明根据BIC，模型 $M_2$ 在模型拟合度（由对数似然值衡量）和模型复杂度（由参数数量衡量）之间提供了最佳的权衡。\n\n因此，选择的模型是 $M_{2}$。问题要求提供所选模型的索引 $m$，即 $2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}