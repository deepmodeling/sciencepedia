{
    "hands_on_practices": [
        {
            "introduction": "缺失数据机制的分类并非绝对，而是取决于分析中可用的信息。本练习通过一个思想实验，展示了一个在技术上属于随机缺失（MAR）的机制，在忽略一个关键变量时，其行为会类似于非随机缺失（MNAR），从而导致简单方法（如完整案例分析）产生有偏倚的结果。这个练习强调了将与缺失相关的变量纳入分析的重要性，以获得有效的推断 。",
            "id": "4928144",
            "problem": "考虑一个队列研究，其二元结果 $Y$ 表示某种状况的存在（$Y=1$）或不存在（$Y=0$），以及一个代表标准化风险评分的连续协变量 $X$。设 $X \\sim \\mathcal{N}(0,1)$，并假设数据收集方案仅记录协变量超过某个阈值的参与者的结果 $Y$。定义 $Y$ 的缺失指示变量 $R$，当 $Y$ 被观测到时 $R=1$，当 $Y$ 缺失时 $R=0$。假设数据生成过程如下：\n- 结果由阈值规则 $Y=\\mathbf{1}\\{X>0\\}$ 决定。\n- 缺失机制为 $R=\\mathbf{1}\\{X>-0.5\\}$。\n\n使用完全随机缺失（MCAR）、随机缺失（MAR）和非随机缺失（MNAR）的标准定义，将机制 $R$ 在以 $X$ 为条件时视为 MAR，但在条件集中省略 $X$ 时视为 MNAR，并通过在指定的联合分布下计算 $P(R=1 \\mid Y=1)$ 和 $P(R=1 \\mid Y=0)$ 来正式证明这一点。\n\n然后，考虑边际患病率 $p=\\Pr(Y=1)$ 的完整案例估计量，其定义为 $p_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)$。推导 $p$ 和 $p_{\\mathrm{cc}}$，并以标准正态累积分布函数 $\\Phi$ 的形式，计算偏差 $b = p_{\\mathrm{cc}} - p$ 的闭式解析表达式。最后，简要解释此机制对完整案例分析和多重插补（MI）有效性的影响。\n\n你的最终答案应为 $b$ 的一个以 $\\Phi$ 表示的闭式解析表达式。",
            "solution": "我们从基本定义开始。设 $R$ 表示 $Y$ 的缺失指示变量。完全随机缺失（MCAR）定义为 $P(R \\mid Y_{\\mathrm{mis}}, Y_{\\mathrm{obs}}, X)=P(R)$，随机缺失（MAR）定义为 $P(R \\mid Y_{\\mathrm{mis}}, Y_{\\mathrm{obs}}, X)=P(R \\mid Y_{\\mathrm{obs}}, X)$，而非随机缺失（MNAR）是其补集，即即使在对观测数据进行条件化之后，$R$ 的分布仍然依赖于未观测到的数据。\n\n在给定的设置中，$X \\sim \\mathcal{N}(0,1)$，结果为 $Y=\\mathbf{1}\\{X>0\\}$，缺失为 $R=\\mathbf{1}\\{X>-0.5\\}$。因为 $R$ 仅依赖于 $X$，我们有\n$$\nP(R=1 \\mid X,Y)=P(R=1 \\mid X)=\\mathbf{1}\\{X>-0.5\\},\n$$\n这表明，以 $X$ 为条件，缺失不依赖于未观测到的 $Y$ 值，因此在以 $X$ 为条件时满足随机缺失（MAR）。\n\n为了证明当省略 $X$ 时该机制为非随机缺失（MNAR），我们通过对 $X$ 进行边际化但以 $Y$ 为条件来计算 $P(R=1 \\mid Y)$。首先，根据阈值规则，观察到 $Y=1 \\iff X>0$ 和 $Y=0 \\iff X \\le 0$。然后：\n- 对于 $Y=1$，我们有 $X>0$，这意味着 $X>-0.5$，因此\n$$\nP(R=1 \\mid Y=1)=P(X>-0.5 \\mid X>0)=1.\n$$\n- 对于 $Y=0$，我们有 $X \\le 0$，并且如果 $X>-0.5$，则缺失为 $R=1$。因此\n$$\nP(R=1 \\mid Y=0)=P(-0.5  X \\le 0 \\mid X \\le 0)\n=\\frac{P(-0.5  X \\le 0)}{P(X \\le 0)}\n=\\frac{\\Phi(0)-\\Phi(-0.5)}{\\Phi(0)},\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。利用对称性 $\\Phi(-a)=1-\\Phi(a)$ 和 $\\Phi(0)=\\frac{1}{2}$，上式可简化为\n$$\nP(R=1 \\mid Y=0)=\\frac{\\frac{1}{2}-\\left(1-\\Phi(0.5)\\right)}{\\frac{1}{2}}\n=\\frac{\\Phi(0.5)-\\frac{1}{2}}{\\frac{1}{2}}\n=2\\Phi(0.5)-1.\n$$\n由于 $P(R=1 \\mid Y=1)=1$ 且 $P(R=1 \\mid Y=0)=2\\Phi(0.5)-1$，我们得到 $P(R=1 \\mid Y=1) \\neq P(R=1 \\mid Y=0)$，这证明了当省略 $X$ 时，缺失机制为非随机缺失（MNAR）。\n\n接下来，我们推导真实的边际患病率 $p=\\Pr(Y=1)$。因为 $Y=\\mathbf{1}\\{X0\\}$ 且 $X \\sim \\mathcal{N}(0,1)$，我们有\n$$\np=\\Pr(Y=1)=\\Pr(X0)=1-\\Phi(0)=\\frac{1}{2}.\n$$\n\n我们现在推导完整案例患病率 $p_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)$。由于 $R=1$ 当且仅当 $X-0.5$，$Y=1$ 当且仅当 $X0$，我们有\n$$\np_{\\mathrm{cc}}=\\Pr(Y=1 \\mid R=1)=\\Pr(X0 \\mid X-0.5)\n=\\frac{\\Pr(X0)}{\\Pr(X-0.5)}=\\frac{\\frac{1}{2}}{\\Phi(0.5)}.\n$$\n因此，边际患病率的完整案例估计量的偏差为\n$$\nb = p_{\\mathrm{cc}} - p \n= \\frac{\\frac{1}{2}}{\\Phi(0.5)} - \\frac{1}{2}\n= \\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right).\n$$\n\n对分析的影响：\n- 完整案例分析估计的是 $p_{\\mathrm{cc}}$ 而非 $p$，并且存在偏差，因为观测数据中富集了较大的 $X$ 值，而根据阈值规则，这些值确定性地对应于 $Y=1$；因此 $p_{\\mathrm{cc}}p$，偏差 $b$ 为正。\n- 如果插补模型以 $X$（驱动缺失的变量）为条件，那么多重插补（MI）在随机缺失（MAR）假设下将产生有效的推断。因为 $R$ 仅依赖于 $X$，将 $X$ 包含在插补模型中符合 MAR 假设，并允许对 $Y$ 的边际分布进行一致的恢复。相反，省略 $X$ 将导致缺失被错误地指定为相对于插补模型的非随机缺失（MNAR），这通常会导致有偏的插补和对 $p$ 的有偏估计。\n\n偏差 $b$ 所需的闭式解析表达式为\n$$\nb=\\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right).\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}\\left(\\frac{1}{\\Phi(0.5)} - 1\\right)}$$"
        },
        {
            "introduction": "一旦我们决定使用多重插补，关键的一步是建立一个好的“插补模型”来预测缺失值。本练习提供了一个实际场景，学生必须使用一个标准的统计准则——贝叶斯信息准则（BIC）——从几个候选模型中选择最佳的插补模型。这需要在模型拟合优度和模型复杂性之间做出权衡 。",
            "id": "4611910",
            "problem": "一项队列研究旨在估计在基线测量的连续炎症生物标志物 $Y$ 与两个协变量之间的关联：年龄 $X$（以年为单位）和吸烟状况 $Z$（二元，$Z \\in \\{0,1\\}$）。由于无应答，部分参与者的生物标志物 $Y$ 数据缺失。研究人员根据研究设计和辅助信息判断，缺失是随机缺失（MAR），即 $P(R=1 \\mid Y, X, Z) = P(R=1 \\mid X, Z)$，其中 $R$ 表示 $Y$ 的应答指示变量。为了执行多重插补（MI），他们将使用一个关于条件分布 $Y \\mid X, Z$ 的同方差正态线性模型来插补 $Y$。\n\n他们考虑了三个关于 $Y \\mid X, Z$ 的候选插补模型，所有模型都具有独立同分布的正态误差和未知的残差方差：\n\n- 模型 $M_{1}$: $Y = \\beta_{0} + \\beta_{1} X + \\varepsilon$。\n- 模型 $M_{2}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\varepsilon$。\n- 模型 $M_{3}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ + \\beta_{4} X^{2} + \\varepsilon$。\n\n所有三个模型都包含一个未知的误差方差 $\\sigma^{2}$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2})$，且在参与者之间独立。仅使用 $Y$ 的观测案例，其中 $n_{\\text{obs}} = 420$，三个模型的最大观测数据对数似然为：\n$$\\ell_{1} = -605.3,\\quad \\ell_{2} = -598.9,\\quad \\ell_{3} = -597.2.$$\n\n根据一个在大样本下、基于似然且在 MAR 条件下一致的选择原则，来选择一个插补模型。该原则适用于在 $Y \\mid X, Z$ 的观测数据分布的参数模型中进行选择。以单个数字的形式报告所选模型的索引 $m \\in \\{1,2,3\\}$。最终答案无需四舍五入。",
            "solution": "插补模型的选择将基于贝叶斯信息准则（BIC），因为它满足问题所要求的大样本、基于似然且一致的选择原则。BIC 定义为：\n$$BIC = k \\ln(n) - 2\\ell$$\n其中 $k$ 是模型中估计参数的数量，$n$ 是用于拟合模型的观测数量，$\\ell$ 是对数似然函数的最大化值。应首选具有最小 BIC 值的模型。\n\n在这个问题中，模型是使用具有完整 $Y$ 数据的 $n_{\\text{obs}} = 420$ 名参与者进行拟合的。因此，我们设定 $n = 420$。每个模型 $M_m$ 的对数似然值 $\\ell_m$ 已给出。必须确定每个模型的参数数量 $k$。对于正态线性模型，参数包括回归系数（$\\beta$s）和残差方差（$\\sigma^{2}$）。\n\n1.  **模型 $M_{1}$: $Y = \\beta_{0} + \\beta_{1} X + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$ 和 $\\sigma^2$。\n    参数数量为 $k_{1} = 3$。\n    对数似然为 $\\ell_{1} = -605.3$。\n    BIC为：\n    $$BIC_{1} = k_{1} \\ln(n_{\\text{obs}}) - 2\\ell_{1} = 3 \\ln(420) - 2(-605.3) = 3 \\ln(420) + 1210.6$$\n\n2.  **模型 $M_{2}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$、$\\beta_2$ 和 $\\sigma^2$。\n    参数数量为 $k_{2} = 4$。\n    对数似然为 $\\ell_{2} = -598.9$。\n    BIC为：\n    $$BIC_{2} = k_{2} \\ln(n_{\\text{obs}}) - 2\\ell_{2} = 4 \\ln(420) - 2(-598.9) = 4 \\ln(420) + 1197.8$$\n\n3.  **模型 $M_{3}$: $Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ + \\beta_{4} X^{2} + \\varepsilon$**\n    参数为 $\\beta_0$、$\\beta_1$、$\\beta_2$、$\\beta_3$、$\\beta_4$ 和 $\\sigma^2$。\n    参数数量为 $k_{3} = 6$。\n    对数似然为 $\\ell_{3} = -597.2$。\n    BIC为：\n    $$BIC_{3} = k_{3} \\ln(n_{\\text{obs}}) - 2\\ell_{3} = 6 \\ln(420) - 2(-597.2) = 6 \\ln(420) + 1194.4$$\n\n现在，我们必须比较三个 BIC 值以找到最小值。我们可以使用近似值 $\\ln(420) \\approx 6.04025$。\n$$BIC_{1} \\approx 3(6.04025) + 1210.6 = 18.12075 + 1210.6 = 1228.72075$$\n$$BIC_{2} \\approx 4(6.04025) + 1197.8 = 24.161 + 1197.8 = 1221.961$$\n$$BIC_{3} \\approx 6(6.04025) + 1194.4 = 36.2415 + 1194.4 = 1230.6415$$\n\n比较计算出的值：\n$BIC_{1} \\approx 1228.72$\n$BIC_{2} \\approx 1221.96$\n$BIC_{3} \\approx 1230.64$\n\n最小值为 $BIC_{2}$。这表明根据 BIC，模型 $M_2$ 在模型拟合度（由对数似然衡量）和模型复杂度（由参数数量衡量）之间提供了最佳的权衡。\n\n因此，选择的模型是 $M_{2}$。问题要求提供所选模型的索引 $m$，即 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在选择了插补模型后，一个常见的实际问题是“需要多少个插补数据集才足够？”。本练习将阐明“缺失信息”的比例、结果的期望精度与所需插补次数 $M$ 之间的形式化关系。通过这个练习，学生可以将一个抽象的统计概念转化为具体的计算，从而确定在实践中应使用的插补次数 。",
            "id": "4928119",
            "problem": "一项前瞻性队列研究使用线性回归来调查基线收缩压与一种连续性炎症生物标志物之间的关联。由于调查实施方面的原因，一部分生物标志物的测量值缺失。探索性分析和研究流程表明，在对所有参与者收集的已观测协变量作为条件的情况下，缺失机制为随机缺失 (MAR)。研究人员计划使用多重插补 (MI) 来处理缺失数据，并且必须选择插补次数 $M$，以确保相对于无限次插补的理想情况，统计推断是稳定的。\n\n他们进行了一项初步的 MI 分析，使用一个较大的临时插补次数来估计目标回归斜率的缺失信息分数，得到的估计值为 $\\hat{\\lambda} = 0.35$。团队希望选择最小的 $M$ 值，使得相对效率（定义为使用有限次插补 $M$ 的 MI 相对于使用无限次插补的 MI 的效率）至少为 $\\tau = 0.99$。\n\n基于缺失机制（完全随机缺失 (MCAR)、随机缺失 (MAR) 和非随机缺失 (MNAR)）的核心定义、完整病例分析的概念，以及 MI 中缺失信息分数与相对效率之间的标准大样本关系，解答以下问题：\n\n1. 定性解释在 MCAR 和 MAR 机制下，总体缺失率如何影响缺失信息分数 $\\lambda$，而这又如何影响为获得稳定推断所需的插补次数 $M$。将此与完整病例分析进行对比，重点关注信息损失。\n2. 使用一个将 MI 下的相对效率与缺失信息分数联系起来的、经过充分检验的近似方法，推导出以 $\\lambda$ 和 $\\tau$ 表示的、保证达到所需效率阈值的 $M$ 的不等式。\n3. 当 $\\hat{\\lambda} = 0.35$ 且 $\\tau = 0.99$ 时，计算满足该标准的最小整数 $M$。报告 $M$ 的最小整数值。除了选择此最小整数外，不需要进行额外的四舍五入。",
            "solution": "按照要求，分三部分解答该问题。\n\n#### 1. 关于缺失、信息和分析选择的定性解释\n\n缺失数据机制由缺失概率对数据的依赖关系来定义。如果一个值的缺失概率与所有变量（包括观测到的和未观测到的）都无关，则该值为完全随机缺失 (MCAR)。如果在已观测数据的条件下，一个值的缺失概率与未观测到的值无关，则该值为随机缺失 (MAR)。如果缺失概率依赖于未观测值本身，即使在已观测数据为条件的情况下也是如此，则该值为非随机缺失 (MNAR)。本问题陈述的是 MAR 机制。\n\n缺失信息分数 $\\lambda$ 量化了由于数据缺失而损失的关于特定参数（此处为回归斜率）的统计信息量。它不简单是缺失数据点的百分比，而是其函数，同时也受到已观测数据对缺失值的预测能力的影响。\n\n在 MCAR 和 MAR 两种机制下，总体缺失率与 $\\lambda$ 存在直接的正相关关系。生物标志物变量中较高的缺失值比例通常会导致回归斜率的缺失信息分数 $\\lambda$ 更大。然而，在 MAR 机制下，这种关系会受到插补模型强度的调节。如果用于插补的已观测协变量与生物标志物高度相关，它们可以“恢复”大量信息，使得在给定的缺失率下，$\\lambda$ 会比在弱插补模型或 MCAR 机制下观察到的要低。\n\n所需的插补次数 $M$ 直接由 $\\lambda$ 决定。多重插补通过生成 $M$ 个可能的完整数据集版本并合并结果来解释由数据缺失引起的不确定性。MI 估计量的总方差是平均插补内方差和插补间方差之和，后者捕捉了由缺失引起的不确定性。较大的 $\\lambda$ 意味着由缺失带来的不确定性更大，这表现为更大的插补间方差。为了可靠地估计这个方差分量并实现稳定、高效的推断，就需要更多的插补次数 $M$。\n\n相比之下，完整病例分析 (CCA) 仅分析没有缺失数据的受试者，通过删除来处理缺失。对于 CCA，信息损失的主要形式是样本量的减少。这种统计功效的损失通常比正确执行的 MI 中的有效信息损失要严重得多。虽然 CCA 在严格的 MCAR 假设下提供无偏估计，但在 MAR（即本问题中的情景）下可能导致严重的有偏估计。例如，如果高的生物标志物值与一个同时也预测测量被获取机会较低的已观测协变量相关，CCA 将系统地排除这些受试者，从而使估计的回归斜率产生偏差。MI 通过使用所有可用数据，避免了这种样本量的减少，并且如果插补模型被正确设定，它在 MAR 下能提供无偏且更高效的估计。\n\n#### 2. $M$ 的不等式推导\n\n设 $\\hat{\\theta}$ 为目标参数（回归斜率）的估计量。在使用 $M$ 个插补数据集进行多重插补时，根据 Rubin 法则，合并估计量的总方差（记为 $T_M$）为：\n$$ T_M = W + \\left(1 + \\frac{1}{M}\\right)B $$\n其中 $W$ 是平均插补内方差，$B$ 是插补间方差。\n\n理想方差，即通过无限次插补 ($M \\to \\infty$) 获得的方差，为：\n$$ T_{\\infty} = \\lim_{M\\to\\infty} \\left[W + \\left(1 + \\frac{1}{M}\\right)B\\right] = W + B $$\n缺失信息分数 $\\lambda$ 定义为总方差中可归因于缺失数据的部分：\n$$ \\lambda = \\frac{B}{T_{\\infty}} = \\frac{B}{W+B} $$\n相对效率 $\\tau$ 是理想方差与使用有限次插补 $M$ 时的方差之比：\n$$ \\tau = \\frac{T_{\\infty}}{T_M} = \\frac{W+B}{W + \\left(1 + \\frac{1}{M}\\right)B} $$\n为了用 $\\lambda$ 来表示，我们可以将分子和分母同除以 $T_{\\infty} = W+B$：\n$$ \\tau = \\frac{\\frac{W+B}{W+B}}{\\frac{W}{W+B} + \\left(1 + \\frac{1}{M}\\right)\\frac{B}{W+B}} $$\n根据 $\\lambda$ 的定义，我们知道 $\\frac{B}{W+B} = \\lambda$ 且 $\\frac{W}{W+B} = 1 - \\lambda$。将这些代入 $\\tau$ 的方程中可得：\n$$ \\tau = \\frac{1}{(1-\\lambda) + \\left(1 + \\frac{1}{M}\\right)\\lambda} = \\frac{1}{1-\\lambda + \\lambda + \\frac{\\lambda}{M}} = \\frac{1}{1 + \\frac{\\lambda}{M}} $$\n这就是那个“经过充分检验的近似方法”或标准公式。问题要求相对效率至少为 $\\tau$。因此，我们建立不等式：\n$$ \\frac{1}{1 + \\frac{\\lambda}{M}} \\geq \\tau $$\n由于 $1 + \\frac{\\lambda}{M}$ 和 $\\tau$ 均为正数，我们可以对不等式进行变换：\n$$ 1 \\geq \\tau \\left(1 + \\frac{\\lambda}{M}\\right) $$\n$$ \\frac{1}{\\tau} \\geq 1 + \\frac{\\lambda}{M} $$\n$$ \\frac{1}{\\tau} - 1 \\geq \\frac{\\lambda}{M} $$\n$$ \\frac{1-\\tau}{\\tau} \\geq \\frac{\\lambda}{M} $$\n由于 $M$ 必须是正整数，我们可以乘以 $M$ 并重新整理以求解 $M$：\n$$ M \\left(\\frac{1-\\tau}{\\tau}\\right) \\geq \\lambda $$\n$$ M \\geq \\lambda \\left(\\frac{\\tau}{1-\\tau}\\right) $$\n这就是所求的以 $\\lambda$ 和 $\\tau$ 表示的 $M$ 的不等式。\n\n#### 3. 最小整数 $M$ 的计算\n\n我们已知估计的缺失信息分数为 $\\hat{\\lambda} = 0.35$，目标相对效率为 $\\tau = 0.99$。我们将估计的 $\\hat{\\lambda}$ 作为真值 $\\lambda$ 的代入值，用于推导出的不等式中。\n$$ M \\geq 0.35 \\left(\\frac{0.99}{1-0.99}\\right) $$\n$$ M \\geq 0.35 \\left(\\frac{0.99}{0.01}\\right) $$\n$$ M \\geq 0.35 \\times 99 $$\n$$ M \\geq 34.65 $$\n由于插补次数 $M$ 必须为整数，我们必须选择满足此条件的最小整数。大于或等于 $34.65$ 的最小整数是 $35$。\n因此，至少需要 $M=35$ 次插补才能达到至少 $99\\%$ 的目标相对效率。",
            "answer": "$$\\boxed{35}$$"
        }
    ]
}