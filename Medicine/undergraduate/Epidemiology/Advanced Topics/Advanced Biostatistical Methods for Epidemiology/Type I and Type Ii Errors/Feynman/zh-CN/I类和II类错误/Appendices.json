{
    "hands_on_practices": [
        {
            "introduction": "在流行病学中，筛查测试很少能给出简单的“是”或“否”的答案。通常，它们测量的是一个连续的生物标志物，这需要我们设定一个阈值来对个体进行分类。本练习将演示如何通过选择一个阈值来控制I型错误率（$\\alpha$），并直接影响II型错误率（$\\beta$），从而让您切实地理解两者之间的基本权衡。",
            "id": "4646871",
            "problem": "一个流行病学筛查项目使用连续生物标志物 $X$ 来将个体分类为患病或未患病。$X$ 的值越高，表示患病的可能性越大。假设在未患病（零假设 $H_{0}$）的条件下，该生物标志物呈正态分布，即 $X \\mid H_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，其中 $\\mu_{0} = 50$，$\\sigma_{0} = 10$；在患病（备择假设 $H_{1}$）的条件下，其分布为 $X \\mid H_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})$，其中 $\\mu_{1} = 80$，$\\sigma_{1} = 12$。使用阈值规则进行分类：如果 $X \\geq \\tau$，则分类为患病，否则分类为未患病。\n\n从I类错误（$\\alpha$）的基本定义（将未患病个体错误分类为患病的概率）和II类错误（$\\beta$）的基本定义（将患病个体错误分类为未患病的概率）出发，仅使用正态分布的性质和标准正态分布的累积分布函数（CDF）$\\Phi$，推导使 $\\alpha = 0.05$ 的阈值 $\\tau$，然后计算在 $H_{1}$ 下对应的 $\\beta$。\n\n将 $\\tau$ 和 $\\beta$ 四舍五入到四位有效数字。以小数形式报告 $\\beta$。最终答案必须包含 $(\\tau, \\beta)$ 这两个值。",
            "solution": "该问题经验证具有科学依据、提法明确、客观且完整。它代表了假设检验在生物医学背景下的一个标准应用。我们可以开始求解。\n\n设 $X$ 为连续生物标志物。零假设 $H_{0}$ 对应于未患病个体，备择假设 $H_{1}$ 对应于患病个体。在每个假设下，$X$ 的分布如下所示：\n$X \\mid H_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，其中 $\\mu_{0} = 50$，$\\sigma_{0} = 10$。\n$X \\mid H_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})$，其中 $\\mu_{1} = 80$，$\\sigma_{1} = 12$。\n\n决策规则是：如果个体的生物标志物值 $X$ 大于或等于一个阈值 $\\tau$，则将其分类为患病，即 $X \\geq \\tau$。\n\nI类错误率 $\\alpha$ 是将未患病个体错误分类为患病的概率。这是在 $H_{0}$ 为真时拒绝 $H_{0}$ 的概率。\n$$ \\alpha = P(\\text{Reject } H_{0} \\mid H_{0} \\text{ is true}) = P(X \\geq \\tau \\mid H_{0}) $$\n为了计算这个概率，我们使用 $H_{0}$ 下 $X$ 分布的参数来标准化随机变量 $X$。设 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$ \\alpha = P\\left(\\frac{X - \\mu_{0}}{\\sigma_{0}} \\geq \\frac{\\tau - \\mu_{0}}{\\sigma_{0}} \\mid H_{0}\\right) = P\\left(Z \\geq \\frac{\\tau - \\mu_{0}}{\\sigma_{0}}\\right) $$\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数 (CDF)，定义为 $\\Phi(z) = P(Z \\leq z)$。$Z$ 超过一个值 $z$ 的概率是 $P(Z \\geq z) = 1 - P(Z  z) = 1 - \\Phi(z)$。\n因此，我们可以将 $\\alpha$ 写成：\n$$ \\alpha = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma_{0}}\\right) $$\n给定 $\\alpha = 0.05$。我们现在可以解出 $\\Phi$ 的参数：\n$$ 0.05 = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma_{0}}\\right) $$\n$$ \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma_{0}}\\right) = 1 - 0.05 = 0.95 $$\n这意味着项 $\\frac{\\tau - \\mu_{0}}{\\sigma_{0}}$ 是标准正态分布的第95个百分位数。设这个值为 $z_{0.05}$，其中 $\\Phi(z_{0.05}) = 0.95$。$z_{0.05}$ 的值约等于 $1.64485$。\n$$ \\frac{\\tau - \\mu_{0}}{\\sigma_{0}} = z_{0.05} \\approx 1.64485 $$\n我们现在可以解出阈值 $\\tau$：\n$$ \\tau = \\mu_{0} + z_{0.05} \\cdot \\sigma_{0} $$\n代入给定值 $\\mu_{0} = 50$ 和 $\\sigma_{0} = 10$：\n$$ \\tau = 50 + (1.64485) \\cdot 10 = 50 + 16.4485 = 66.4485 $$\n四舍五入到四位有效数字，阈值为 $\\tau \\approx 66.45$。\n\n接下来，我们计算II类错误率 $\\beta$，它是将患病个体错误分类为未患病的概率。这是在 $H_{1}$ 为真时未能拒绝 $H_{0}$ 的概率。分类为未患病的规则是 $X  \\tau$。\n$$ \\beta = P(\\text{Fail to reject } H_{0} \\mid H_{1} \\text{ is true}) = P(X  \\tau \\mid H_{1}) $$\n为了计算这个概率，我们现在使用备择假设下的分布，$X \\mid H_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})$。我们使用参数 $\\mu_{1}=80$ 和 $\\sigma_{1}=12$ 来标准化 $X$。\n$$ \\beta = P\\left(\\frac{X - \\mu_{1}}{\\sigma_{1}}  \\frac{\\tau - \\mu_{1}}{\\sigma_{1}} \\mid H_{1}\\right) = P\\left(Z  \\frac{\\tau - \\mu_{1}}{\\sigma_{1}}\\right) $$\n使用标准正态CDF的定义，可得：\n$$ \\beta = \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma_{1}}\\right) $$\n我们在中间计算中使用未四舍五入的 $\\tau = 66.4485$ 值以保持精度。\n$$ \\beta = \\Phi\\left(\\frac{66.4485 - 80}{12}\\right) = \\Phi\\left(\\frac{-13.5515}{12}\\right) $$\n$$ \\beta = \\Phi(-1.12929...) $$\n使用标准正态CDF计算器，我们得到 $\\beta$ 的值：\n$$ \\beta \\approx 0.129386 $$\n四舍五入到四位有效数字，II类错误率为 $\\beta \\approx 0.1294$。\n\n最终结果为 $\\tau \\approx 66.45$ 和 $\\beta \\approx 0.1294$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 66.45  0.1294 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个常见的混淆点是检验本身的错误率与检验结果对患者的实际意义之间的区别。本练习将挑战您使用贝叶斯定理计算阳性预测值（PPV），并理解为什么它不等于 $1-\\alpha$。它突出了疾病患病率在真实世界人群中解释诊断信息时所起的关键作用。",
            "id": "4646863",
            "problem": "一个公共卫生实验室采用一种二元诊断检测方法来筛查社区中一种低流行率的传染病。设 $D$ 表示个体确实患有该疾病的事件，$T^{+}$ 表示检测结果为阳性的事件。该检测的灵敏度为 $\\Pr(T^{+}\\mid D)=0.88$，特异度为 $\\Pr(T^{-}\\mid \\neg D)=0.96$，筛查人群中的疾病流行率为 $\\Pr(D)=0.03$。研究人员建议将阳性检测结果解释为“拒绝原假设 $H_{0}$：无疾病”，其名义显著性水平 $\\alpha$ 等于该检测的假阳性率 $\\Pr(T^{+}\\mid \\neg D)$。\n\n从贝叶斯定理以及灵敏度、特异度、流行率、第一类错误和第二类错误的核心定义出发，推导阳性预测值 $\\Pr(D\\mid T^{+})$ 关于 $\\Pr(T^{+}\\mid D)$、$\\Pr(T^{-}\\mid \\neg D)$ 和 $\\Pr(D)$ 的解析表达式。然后，计算上述检测的阳性预测值的数值。在推导过程中，请仅使用第一性原理解释为什么在假设检验中，即使使用了“检测阳性 $\\Rightarrow$ 拒绝 $H_{0}$”的决策规则，$\\Pr(D\\mid T^{+})$ 也不能被解释为 $1-\\alpha$。\n\n请以小数形式提供 $\\Pr(D\\mid T^{+})$ 的数值，并四舍五入到四位有效数字。不要使用百分号。",
            "solution": "我们从贝叶斯定理和流行病学检测评估中使用的标准定义开始。灵敏度定义为 $\\Pr(T^{+}\\mid D)$，特异度定义为 $\\Pr(T^{-}\\mid \\neg D)$，流行率定义为 $\\Pr(D)$。阳性预测值 (PPV) 是 $\\Pr(D\\mid T^{+})$，即在检测结果为阳性的条件下，某人患有该疾病的概率。\n\n根据贝叶斯定理，\n$$\n\\Pr(D\\mid T^{+}) \\;=\\; \\frac{\\Pr(T^{+}\\mid D)\\,\\Pr(D)}{\\Pr(T^{+})}.\n$$\n阳性检测的边际概率可以按疾病状态分解：\n$$\n\\Pr(T^{+}) \\;=\\; \\Pr(T^{+}\\mid D)\\,\\Pr(D) \\;+\\; \\Pr(T^{+}\\mid \\neg D)\\,\\Pr(\\neg D).\n$$\n注意，$\\Pr(T^{+}\\mid \\neg D)$ 是假阳性概率，它等于 $1-\\text{特异度}$，因为 $\\Pr(T^{-}\\mid \\neg D)=\\text{特异度}$ 且 $\\Pr(T^{+}\\mid \\neg D)=1-\\Pr(T^{-}\\mid \\neg D)$。此外，根据全概率定律，$\\Pr(\\neg D)=1-\\Pr(D)$。\n\n代入这些恒等式，我们得到解析表达式\n$$\n\\Pr(D\\mid T^{+}) \\;=\\; \\frac{\\Pr(T^{+}\\mid D)\\,\\Pr(D)}{\\Pr(T^{+}\\mid D)\\,\\Pr(D) \\;+\\; \\bigl(1-\\Pr(T^{-}\\mid \\neg D)\\bigr)\\,\\bigl(1-\\Pr(D)\\bigr)}.\n$$\n这个表达式表明，阳性预测值取决于三个量：灵敏度、特异度和流行率。\n\n现在我们用给定的参数计算其数值。灵敏度为 $\\Pr(T^{+}\\mid D)=0.88$，特异度为 $\\Pr(T^{-}\\mid \\neg D)=0.96$，因此假阳性概率为 $\\Pr(T^{+}\\mid \\neg D)=1-0.96=0.04$，流行率为 $\\Pr(D)=0.03$，所以 $\\Pr(\\neg D)=1-0.03=0.97$。代入表达式，\n$$\n\\Pr(D\\mid T^{+})\n\\;=\\;\n\\frac{0.88 \\times 0.03}{0.88 \\times 0.03 \\;+\\; 0.04 \\times 0.97}\n\\;=\\;\n\\frac{0.0264}{0.0264 \\;+\\; 0.0388}\n\\;=\\;\n\\frac{0.0264}{0.0652}.\n$$\n该比率可精确简化为 $\\frac{66}{163}$，其数值为\n$$\n\\Pr(D\\mid T^{+}) \\approx 0.404907954\\ldots\n$$\n四舍五入到四位有效数字，阳性预测值为 $0.4049$。\n\n接下来我们解释为什么在假设检验中 $\\Pr(D\\mid T^{+})$ 不能被解释为 $1-\\alpha$。在“检测阳性 $\\Rightarrow$ 拒绝 $H_{0}$”（其中 $H_{0}$ 为“无疾病”）的决策框架中，第一类错误（假阳性）率是\n$$\n\\alpha \\;=\\; \\Pr(\\text{拒绝 } H_{0}\\mid H_{0} \\text{ 为真}) \\;=\\; \\Pr(T^{+}\\mid \\neg D) \\;=\\; 1-\\text{特异度}.\n$$\n因此，$1-\\alpha$ 等于特异度：\n$$\n1-\\alpha \\;=\\; \\Pr(T^{-}\\mid \\neg D) \\;=\\; \\text{特异度}.\n$$\n特异度是 $\\Pr(T^{-}\\mid \\neg D)$，即在没有疾病的情况下检测结果为阴性的条件概率，这是检测在无疾病条件下的一种属性。相比之下，阳性预测值是\n$$\n\\Pr(D\\mid T^{+}) \\;=\\; \\frac{\\Pr(T^{+}\\mid D)\\,\\Pr(D)}{\\Pr(T^{+}\\mid D)\\,\\Pr(D)+\\Pr(T^{+}\\mid \\neg D)\\,\\Pr(\\neg D)},\n$$\n一个在给定阳性检测结果下的疾病后验概率，它依赖于流行率 $\\Pr(D)$ 以及灵敏度和特异度。这些概率是基于不同事件的条件概率：$\\Pr(D\\mid T^{+})$ 的条件是检测结果，而 $\\Pr(T^{-}\\mid \\neg D)$ 的条件是疾病状态。\n\n具体到这个情景中，$1-\\alpha=\\text{特异度}=0.96$，而计算出的 $\\Pr(D\\mid T^{+})\\approx 0.4049$。巨大的差异之所以产生，是因为阳性预测值包含了低流行率 $\\Pr(D)=0.03$ 这一因素，即使在特异度很高的情况下，这也会拉低后验概率。因此，根据第一性原理，$\\Pr(D\\mid T^{+})$ 不能被解释为 $1-\\alpha$；它们是具有不同条件和对流行率依赖性不同的两个不同量。此外，虽然第二类错误 $\\beta = \\Pr(\\text{未能拒绝 } H_{0} \\mid H_{1} \\text{ 为真}) = \\Pr(T^{-} \\mid D) = 1 - \\text{灵敏度}$ 会通过灵敏度影响 $\\Pr(D\\mid T^{+})$，但 $1-\\alpha$ 仅依赖于特异度，而不依赖于流行率或灵敏度，这进一步强调了除非在退化情况下，否则 $\\Pr(D\\mid T^{+}) \\neq 1-\\alpha$。",
            "answer": "$$\\boxed{0.4049}$$"
        },
        {
            "introduction": "在将大量资源投入临床试验之前，研究人员必须确保研究有很高的成功机会，这涉及到通过“把握度计算”来确定所需的样本量。这个高级问题让您扮演研究设计者的角色，使用I型和II型错误的目标值来计算可靠地检测出特定效应大小所需的参与者数量。",
            "id": "4646891",
            "problem": "一个公共卫生团队计划进行一项双臂随机试验，以比较干预措施与对照组在一个季节内的二元感染结局。设对照组的基线风险为 $p_{0} = 0.1$，并假设干预措施预计会使风险增加一个风险比 $r = 1.5$，因此干预组的风险为 $p_{1} = r p_{0}$。组内和组间的结局是独立的伯努利试验，分配比例为 $1:1$，每组有 $n$ 个个体。该团队将对 $H_{0}: \\text{风险比} = 1$ 进行双侧假设检验，I 型错误率 $\\alpha = 0.05$。他们希望达到 $1 - \\beta = 0.9$ 的功效来检测备择假设 $H_{1}: \\text{风险比} = 1.5$。假设对对数风险比进行大样本双侧 Wald 检验，并对独立伯努利抽样下的对数风险比估计量使用标准渐近正态近似。\n\n从 I 型和 II 型错误的定义以及中心极限定理和 delta 方法下估计量的大样本行为出发，推导所需的样本量公式，并计算在该设计下每组达到至少 $0.9$ 功效所需的最小整数 $n$。只报告每组的这个最小整数 $n$。不要提供任何中间量。对于任何对数变换，请使用自然对数。将您的最终答案表示为最小整数 $n$ (无单位)。",
            "solution": "假设为 $H_{0}: r = 1$ 对双侧备择假设 $H_{1}: r \\neq 1$，目标检测值为 $r = 1.5$。I 型错误率控制在双侧 $\\alpha = 0.05$，对应于标准正态分布的临界值 $z_{1-\\alpha/2}$。II 型错误 $\\beta$ 对应于当效应真实存在时未能检测到该效应；功效为 $1-\\beta = 0.9$，其中 $z_{1-\\beta}$ 表示 $(1-\\beta)$ 标准正态分位数。\n\n设 $p_{0} = 0.1$ 为对照组风险，在备择假设 $r = 1.5$ 下，干预组风险为 $p_{1} = r p_{0} = 0.15$。考虑对数风险比的估计量 $\\widehat{\\theta} = \\ln(\\widehat{p}_{1}/\\widehat{p}_{0})$，其中 $\\widehat{p}_{a}$ 是每组有 $n$ 个观测值的组 $a \\in \\{0,1\\}$ 中的样本比例。\n\n根据中心极限定理，$\\widehat{p}_{a} \\overset{approx}{\\sim} \\mathcal{N}(p_{a}, p_{a}(1-p_{a})/n)$。根据 delta 方法，对于 $g(x) = \\ln(x)$ 和 $g'(x) = 1/x$，我们有\n$$\n\\operatorname{Var}\\!\\left(\\ln(\\widehat{p}_{a})\\right) \\approx \\left(\\frac{1}{p_{a}}\\right)^{2} \\operatorname{Var}(\\widehat{p}_{a}) = \\frac{1-p_{a}}{n\\,p_{a}}.\n$$\n组间的独立性意味着\n$$\n\\operatorname{Var}\\!\\left(\\ln\\!\\left(\\frac{\\widehat{p}_{1}}{\\widehat{p}_{0}}\\right)\\right) \\approx \\frac{1-p_{1}}{n\\,p_{1}} + \\frac{1-p_{0}}{n\\,p_{0}}.\n$$\n设 $\\theta = \\ln(r)$ 表示真实的对数风险比。那么，对于大样本 $n$，Wald 统计量 $T$\n$$\nT = \\frac{\\widehat{\\theta} - 0}{\\sqrt{\\operatorname{Var}(\\widehat{\\theta})}}\n$$\n在 $H_{0}$ 下近似服从标准正态分布，而在备择假设下近似服从均值为 $\\mu = \\theta / \\sigma$、单位方差的正态分布，其中\n$$\n\\sigma = \\sqrt{\\frac{1-p_{1}}{n\\,p_{1}} + \\frac{1-p_{0}}{n\\,p_{0}}} = \\sqrt{\\frac{1}{n}\\left(\\frac{1-p_{1}}{p_{1}} + \\frac{1-p_{0}}{p_{0}}\\right)}.\n$$\n一个双侧水平为 $\\alpha$ 的 Wald 检验在 $|T| > z_{1-\\alpha/2}$ 时拒绝原假设。在 $\\mu > 0$ 的备择假设下，功效为\n$$\n\\Pr(|T| > z_{1-\\alpha/2}\\,|\\,\\mu) = \\Pr(T > z_{1-\\alpha/2}\\,|\\,\\mu) + \\Pr(T  -z_{1-\\alpha/2}\\,|\\,\\mu).\n$$\n由于 $\\mu > 0$，左尾项相对于右尾项可以忽略不计，一个确保功效至少为 $1-\\beta$ 的标准样本量构建方法是通过要求以下条件获得：\n$$ \\mu \\ge z_{1-\\alpha/2} + z_{1-\\beta}. $$\n代入 $\\mu = \\theta/\\sigma$ 并求解 $n$ 可得\n$$\n\\frac{\\ln(r)}{\\sqrt{\\frac{1}{n}\\left(\\frac{1-p_{1}}{p_{1}} + \\frac{1-p_{0}}{p_{0}}\\right)}} \\ge z_{1-\\alpha/2} + z_{1-\\beta}\n$$\n$$\n\\Longrightarrow\\quad\nn \\ge \\frac{\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^{2}\\left(\\frac{1-p_{1}}{p_{1}} + \\frac{1-p_{0}}{p_{0}}\\right)}{\\left(\\ln(r)\\right)^{2}}.\n$$\n代入 $p_{0} = 0.1$，$r = 1.5$ 从而 $p_{1} = 0.15$，$\\alpha = 0.05$ 从而 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.9599639845$，以及 $1-\\beta = 0.9$ 从而 $z_{1-\\beta} = z_{0.9} \\approx 1.2815515655$，我们计算：\n$$\n\\frac{1-p_{1}}{p_{1}} + \\frac{1-p_{0}}{p_{0}} = \\frac{0.85}{0.15} + \\frac{0.9}{0.1} = \\frac{17}{3} + 9 = \\frac{44}{3} \\approx 14.6666666667,\n$$\n$$\n\\ln(r) = \\ln(1.5) \\approx 0.4054651081,\n$$\n$$\nz_{1-\\alpha/2} + z_{1-\\beta} \\approx 1.9599639845 + 1.2815515655 \\approx 3.2415155501,\n$$\n$$\n\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^{2} \\approx 10.507422646,\n\\qquad\n\\left(\\ln(r)\\right)^{2} \\approx 0.1644019539.\n$$\n因此\n$$\nn \\ge \\frac{10.507422646 \\times 14.6666666667}{0.1644019539} \\approx \\frac{154.1088653}{0.1644019539} \\approx 937.39.\n$$\n为保证功效至少为 $0.9$，我们取满足该不等式的最小整数 $n$，即向上取整：\n$$\nn = \\lceil 937.39 \\rceil = 938.\n$$\n因此，每组所需的样本量为 $n = 938$。",
            "answer": "$$\\boxed{938}$$"
        }
    ]
}