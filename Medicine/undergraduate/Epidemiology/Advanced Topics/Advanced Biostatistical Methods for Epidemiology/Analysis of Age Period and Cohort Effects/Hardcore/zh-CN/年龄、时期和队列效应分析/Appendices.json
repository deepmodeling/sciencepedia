{
    "hands_on_practices": [
        {
            "introduction": "年龄-时期-队列（APC）分析的核心在于理解这三个时间维度如何相互关联。在进行任何复杂的建模之前，我们必须掌握一个基本恒等式：出生队列约等于日历时期减去年龄。这个练习  旨在通过一个简单的计算来巩固这个基础概念，它将帮助你理解流行病学数据是如何被归入不同的队列中，并揭示APC模型中固有的线性依赖关系。",
            "id": "4571535",
            "problem": "一个基于人群的癌症登记系统按单岁年龄和日历年汇总了计数和人时数据。数据被组织成一个矩形阵列，其中每个单元格对应一个年龄-时期-队列（Age-Period-Cohort, APC）的组合。令 $a$ 表示在日历年中点时的足岁年龄，$p$ 表示日历年，$c$ 表示出生队列年份。对于APC分析，每个APC单元格由 $(a,p)$ 索引，其中 $a \\in \\{0,1,2,\\dots,99\\}$ 且 $p \\in \\{1995,1996,\\dots,2010\\}$。队列索引 $c$ 的定义需要与流行病学中关于年龄（自出生以来的流逝时间）和时期（日历时间）的定义保持一致。\n\n给定登记系统中的一个单元格：在日历年 $p = 2009$ 观察到的年龄 $a = 37$，其新发病例数 $N_{37,2009} = 54$，人年数 $Y_{37,2009} = 17{,}300$。请使用与上述年龄和时期的基本定义相符的科学一致的 $a$、$p$ 和 $c$ 索引方法，确定此APC单元格的队列索引 $c$。请将答案表示为整数日历年份。无需四舍五入。",
            "solution": "该问题要求确定一个特定的年龄-时期-队列（APC）数据单元格的出生队列年份，用索引 $c$ 表示。给定的单元格由年龄索引 $a$ 和时期索引 $p$ 定义。\n\n**步骤1：问题验证**\n\n首先，我将提取给定信息并验证问题陈述。\n\n**已知条件：**\n*   年龄索引：$a = 37$ 岁，定义为“在日历年中点时的足岁年龄”。\n*   时期索引：$p = 2009$，定义为日历年。\n*   队列索引：$c$，定义为出生队列年份。\n*   $a$、$p$ 和 $c$ 之间的关系必须“与流行病学中关于年龄（自出生以来的流逝时间）和时期（日历时间）的定义保持一致”。\n*   单元格 $(a,p) = (37, 2009)$ 的附加数据：新发病例数 $N_{37,2009} = 54$ 和人年数 $Y_{37,2009} = 17,300$。\n\n**验证：**\n1.  **科学依据**：该问题基于流行病学和生物统计学的既定原则，特别是年龄-时期-队列（APC）分析方法。年龄、时期和队列的概念是人口学和公共卫生的基础。\n2.  **适定性**：该问题是适定的。年龄、时期和出生队列之间的关系是确定性的。给定这三个变量中的任意两个，第三个通常由一个明确的恒等式确定。问题要求为给定的年龄和时期找到一个单一、唯一的队列索引。\n3.  **客观性**：问题陈述使用了流行病学领域常见的精确、客观的术语。\n4.  **缺陷分析**：\n    *   该问题不违反任何科学原则。\n    *   它可直接形式化，并与APC分析相关。\n    *   所提供的信息（$a=37$，$p=2009$）足以确定 $c$。附加数据（$N_{37,2009}$ 和 $Y_{37,2009}$）在计算发病率方面具有上下文相关性，但对于确定队列索引本身并非必需。它们不会引入矛盾。\n    *   这些数值是现实的，设定是可行的。\n    *   该问题并非不适定；标准的索引约定提供了一个唯一的答案。虽然在某一年将人群汇总到“37岁”年龄组中会涉及来自两个相邻出生队列的个体，但单元格 $(a,p)$ 本身的索引传统上遵循一个单一、简单的恒等式。\n\n**结论：** 该问题是有效的。\n\n**步骤2：求解推导**\n\n年龄-时期-队列分析的核心在于三个时间尺度之间的相互关系：年龄（$a$）、时期（$p$）和队列（$c$）。\n\n*   **时期 ($p$)** 是日历时间。\n*   **年龄 ($a$)** 是自出生以来流逝的时间。\n*   **队列 ($c$)** 是出生时间。\n\n这三个量不是独立的。对于一个在日历年 $c$ 出生的个体，其在日历年 $p$ 的年龄 $a$ 由当前年份与出生年份之差给出。这引出了APC分析中使用的基本恒等式：\n$$a \\approx p - c$$\n重新整理这个恒等式以求解出生队列年份 $c$ 可得：\n$$c \\approx p - a$$\n在APC模型的背景下，数据被汇总到由年龄 $a$ 和时期 $p$ 的整数值索引的离散单元格中，为了索引队列效应，这个近似被视为一个精确的恒等式：\n$$c = p - a$$\n这种线性依赖关系是APC模型的一个决定性特征，也是“识别问题”的根源，即在不对模型参数施加至少一个约束的情况下，无法唯一地估计年龄、时期和队列各自的线性效应。问题陈述中要求的“科学一致的索引”指的就是这个基本恒等式。\n\n问题提供了所讨论单元格的年龄和时期索引的具体值：\n*   年龄索引：$a = 37$\n*   时期索引：$p = 2009$\n\n将这些值代入队列索引恒等式：\n$$c = 2009 - 37$$\n执行减法运算得出队列年份：\n$$c = 1972$$\n因此，2009年年龄为37岁的APC单元格对应于1972年的出生队列。提供的关于新发病例（$N_{37,2009} = 54$）和人年数（$Y_{37,2009} = 17,300$）的数据用于计算该单元格的发病率，但与确定队列索引 $c$ 的任务无关。",
            "answer": "$$\\boxed{1972}$$"
        },
        {
            "introduction": "APC分析中最著名的挑战是“不可识别问题”，它源于年龄、时期和队列之间的线性关系。这意味着我们无法在不施加额外约束的情况下，唯一地分离出这三个效应的线性趋势。然而，这并不意味着我们一无所获；某些参数的组合，即“可估计函数”，是不受此问题影响的。这个练习  将引导你计算这些可估计函数中的一种——“曲率”（或二阶差分），从而揭示我们能够从数据中稳健估计出的APC效应的非线性特征。",
            "id": "4571547",
            "problem": "考虑一个标准的年龄-时期-队列（APC）模型，用于描述发病率，其中年龄类别 $a$ 和时期类别 $p$ 的发病率的对数被建模为 $\\ln(\\lambda_{ap}) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}$，队列类别 $c$ 由恒等式 $c = p - a$ 决定。假设年龄 $(\\alpha_{a})$、时期 $(\\pi_{p})$ 和队列 $(\\gamma_{c})$ 具有分类效应，并且数据是在完整的年龄-时期网格上构建的，因此队列指数由年龄和时期唯一确定。\n\n给定 $P = 6$ 个时期类别，其时期效应为 $(\\pi_{1}, \\pi_{2}, \\pi_{3}, \\pi_{4}, \\pi_{5}, \\pi_{6}) = (0.10, 0.18, 0.27, 0.29, 0.31, 0.30)$，以及 $C = 7$ 个队列类别，其队列效应为 $(\\gamma_{1}, \\gamma_{2}, \\gamma_{3}, \\gamma_{4}, \\gamma_{5}, \\gamma_{6}, \\gamma_{7}) = (-0.05, -0.02, 0.01, 0.05, 0.06, 0.06, 0.04)$。\n\n将序列 $\\{f_{k}\\}$ 上的一阶差分算子定义为 $\\Delta f_{k} = f_{k} - f_{k-1}$，将二阶差分算子定义为 $\\Delta^{2} f_{k} = \\Delta(\\Delta f_{k}) = f_{k+1} - 2 f_{k} + f_{k-1}$（对于内部指数）。\n\n从 APC 恒等式 $c = p - a$ 和分类 APC 效应的定义出发，推导 $(\\pi_{p})$ 和 $(\\gamma_{c})$ 的哪些特征是无需施加任意约束即可估计的，然后计算特定的曲率对比 $\\Delta^{2} \\pi_{3}$ 和 $\\Delta^{2} \\gamma_{4}$。最后，确定在给定 $P$ 和 $C$ 的情况下，时期和队列效应组合集的可估计曲率子空间的维度（以单个整数表示）。\n\n将您的最终答案表示为一个行矩阵，其中包含三个条目，顺序为 $\\Delta^{2} \\pi_{3}$、$\\Delta^{2} \\gamma_{4}$ 和维度。无需四舍五入。不要包含单位。",
            "solution": "该问题被评估为有效。它在科学上基于年龄-时期-队列（APC）模型的统计理论，问题陈述清晰，信息充分，可以得出唯一解，并且使用了客观、精确的术语。\n\n该问题围绕用于描述率 $\\lambda_{ap}$ 的年龄-时期-队列（APC）模型展开，其中指数 $a$ 表示年龄类别， $p$ 表示时期类别。该模型由以下公式给出：\n$$\n\\ln(\\lambda_{ap}) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}\n$$\n队列类别 $c$ 通过恒等式 $c = p - a$ 与年龄和时期呈线性依赖关系。这种精确的线性关系是 APC 模型中基本不可识别问题的根源。具体来说，对于任何常数 $k$，对参数进行以下变换\n\\begin{align*}\n\\alpha_{a}^{*} = \\alpha_{a} + k \\cdot a \\\\\n\\pi_{p}^{*} = \\pi_{p} - k \\cdot p \\\\\n\\gamma_{c}^{*} = \\gamma_{c} + k \\cdot c\n\\end{align*}\n不会改变模型的预测值。这可以通过将变换后的参数代入模型方程来证明：\n$$\n\\mu + \\alpha_{a}^{*} + \\pi_{p}^{*} + \\gamma_{c}^{*} = \\mu + (\\alpha_{a} + k \\cdot a) + (\\pi_{p} - k \\cdot p) + (\\gamma_{c} + k \\cdot c)\n$$\n使用恒等式 $c = p - a$，涉及 $k$ 的项会相互抵消：\n$$\n\\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c} + ka - kp + k(p - a) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c} + (ka - ka) + (-kp + kp) = \\mu + \\alpha_{a} + \\pi_{p} + \\gamma_{c}\n$$\n由于模型的预测值对于任何任意 $k$ 的这种变换都是不变的，因此单个参数 $\\alpha_{a}$、$\\pi_{p}$ 和 $\\gamma_{c}$ 无法从数据中唯一估计。具体来说，它们的线性趋势（或“漂移”）是混杂的。\n\n如果一个模型参数的函数在所有不可识别的变换下保持不变，则称其为“可估计的”。我们研究二阶差分算子，定义为 $\\Delta^{2} f_{k} = f_{k+1} - 2 f_{k} + f_{k-1}$。该算子的关键特性是它能消除线性函数。如果 $f_k = m \\cdot k + b$，那么 $\\Delta^2 f_k = (m(k+1)+b) - 2(mk+b) + (m(k-1)+b) = m(k+1 - 2k + k-1) + b(1-2+1) = 0$。\n\n让我们将此算子应用于变换后的时期效应 $\\pi_{p}^{*} = \\pi_{p} - k \\cdot p$：\n$$\n\\Delta^{2} \\pi_{p}^{*} = \\Delta^{2} (\\pi_{p} - k \\cdot p) = \\Delta^{2} \\pi_{p} - k \\cdot \\Delta^{2} p\n$$\n由于 $\\Delta^{2} p = (p+1) - 2p + (p-1) = 0$，我们有：\n$$\n\\Delta^{2} \\pi_{p}^{*} = \\Delta^{2} \\pi_{p}\n$$\n时期效应的二阶差分在此变换下是不变的，因此是一个可估计函数。这些量通常被称为时期效应的“曲率”。\n\n类似地，对于变换后的队列效应 $\\gamma_{c}^{*} = \\gamma_{c} + k \\cdot c$：\n$$\n\\Delta^{2} \\gamma_{c}^{*} = \\Delta^{2} (\\gamma_{c} + k \\cdot c) = \\Delta^{2} \\gamma_{c} + k \\cdot \\Delta^{2} c\n$$\n由于 $\\Delta^{2} c = (c+1) - 2c + (c-1) = 0$，我们有：\n$$\n\\Delta^{2} \\gamma_{c}^{*} = \\Delta^{2} \\gamma_{c}\n$$\n队列效应的二阶差分，即曲率，也是一个可估计函数。这些二阶差分是时期和队列效应的主要特征，可以在不 对模型参数施加任意约束的情况下进行估计。\n\n接下来，我们使用所提供的数据计算特定的曲率对比 $\\Delta^{2} \\pi_{3}$ 和 $\\Delta^{2} \\gamma_{4}$。\n给定的时期效应为 $(\\pi_{1}, \\pi_{2}, \\pi_{3}, \\pi_{4}, \\pi_{5}, \\pi_{6}) = (0.10, 0.18, 0.27, 0.29, 0.31, 0.30)$。\n时期效应在指数 $p=3$ 处的二阶差分为：\n$$\n\\Delta^{2} \\pi_{3} = \\pi_{4} - 2 \\pi_{3} + \\pi_{2} = 0.29 - 2(0.27) + 0.18 = 0.29 - 0.54 + 0.18 = -0.07\n$$\n\n给定的队列效应为 $(\\gamma_{1}, \\gamma_{2}, \\gamma_{3}, \\gamma_{4}, \\gamma_{5}, \\gamma_{6}, \\gamma_{7}) = (-0.05, -0.02, 0.01, 0.05, 0.06, 0.06, 0.04)$。\n队列效应在指数 $c=4$ 处的二阶差分为：\n$$\n\\Delta^{2} \\gamma_{4} = \\gamma_{5} - 2 \\gamma_{4} + \\gamma_{3} = 0.06 - 2(0.05) + 0.01 = 0.06 - 0.10 + 0.01 = -0.03\n$$\n\n最后，我们确定时期和队列效应组合集的可估计曲率子空间的维度。\n时期效应的可估计曲率是所有内部指数 $p$ 的二阶差分集合 $\\{\\Delta^{2} \\pi_{p}\\}$。给定 $P=6$ 个时期类别，内部指数为 $p = 2, 3, 4, 5$。这提供了 $P-2 = 6-2=4$ 个线性无关的可估计对比，它们构成了时期曲率子空间的一个基。\n队列效应的可估计曲率是所有内部指数 $c$ 的二阶差分集合 $\\{\\Delta^{2} \\gamma_{c}\\}$。给定 $C=7$ 个队列类别，内部指数为 $c = 2, 3, 4, 5, 6$。这提供了 $C-2 = 7-2=5$ 个线性无关的可估计对比，它们构成了队列曲率子空间的一个基。\n\n组合的可估计曲率子空间由时期曲率的基向量和队列曲率的基向量的并集张成。由于时期对比仅涉及参数 $\\{\\pi_p\\}$，而队列对比仅涉及参数 $\\{\\gamma_c\\}$，因此这两组基向量是相互线性无关的。因此，组合子空间的维度是个体子空间维度之和。\n$$\n\\text{维度} = (\\text{时期曲率子空间的维度}) + (\\text{队列曲率子空间的维度})\n$$\n$$\n\\text{维度} = (P-2) + (C-2)\n$$\n代入给定的值 $P=6$ 和 $C=7$：\n$$\n\\text{维度} = (6-2) + (7-2) = 4 + 5 = 9\n$$\n时期和队列效应组合集的可估计曲率子空间的维度是 $9$。\n\n所要求的三个值是 $\\Delta^{2} \\pi_{3} = -0.07$，$\\Delta^{2} \\gamma_{4} = -0.03$，以及维度为 $9$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.07  -0.03  9 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在拟合了APC模型（通常是泊松对数线性模型）之后，一个关键的步骤是评估模型的拟合优度，并检验其基本假设是否成立。一个常见的挑战是“过度离散”，即观测数据的变异性大于泊松模型所预测的。这个练习  将带你动手计算一个关键的诊断统计量——皮尔逊卡方离散度估计，它能帮助你判断数据是否存在过度离散，并决定是否需要使用更灵活的模型来分析数据。",
            "id": "4571569",
            "problem": "一位流行病学家将一个年龄-时期-队列 (APC) 对数线性泊松模型拟合到一个 $4 \\times 4$ 的年龄-时期新发病例计数表，其中线性预测变量包括加性的年龄、时期和队列主效应，并带有标准的可识别性约束。使用的基本假设是：在泊松模型下，方差等于均值，并且由观测计数和模型预测均值构建的标准化残差可用于通过大样本近似来评估模型的充分性。拟合的 APC 模型包含一个截距，对年龄、时期和队列分类效应的和为零约束，以及一个额外的线性约束来解决年龄、时期和队列指数之间固有的混叠问题；在这些约束下，设计矩阵的秩为 $r = 13$。\n\n给定年龄 $a \\in \\{1,2,3,4\\}$ 和时期 $p \\in \\{1,2,3,4\\}$ 的观测计数 $Y_{a,p}$ 和拟合均值 $\\hat{\\mu}_{a,p}$：\n- 年龄组 1：$Y_{1,\\cdot} = (8, 7, 7, 6)$ 和 $\\hat{\\mu}_{1,\\cdot} = (7.3, 7.2, 7.5, 6.2)$。\n- 年龄组 2：$Y_{2,\\cdot} = (14, 13, 12, 10)$ 和 $\\hat{\\mu}_{2,\\cdot} = (13.5, 13.0, 12.6, 11.4)$。\n- 年龄组 3：$Y_{3,\\cdot} = (25, 22, 19, 17)$ 和 $\\hat{\\mu}_{3,\\cdot} = (24.0, 21.7, 20.5, 18.9)$。\n- 年龄组 4：$Y_{4,\\cdot} = (47, 32, 26, 24)$ 和 $\\hat{\\mu}_{4,\\cdot} = (38.1, 36.2, 33.3, 29.7)$。\n\n从泊松模型中 $\\mathrm{Var}(Y_{a,p})=\\mathbb{E}(Y_{a,p})$ 这一基本假设出发，以及标准化残差的平方和渐近地可与具有适当自由度的卡方参考分布相比较，构建 APC 泊松模型的基于皮尔逊的过度离散检验，计算定义为皮尔逊卡方值除以其自由度的离散度估计值 $\\hat{\\phi}$，并给出其数值。使用单元格数 $N = 16$ 和秩 $r = 13$ 来确定自由度。将您的答案四舍五入到三位有效数字。将您的最终答案表示为一个无量纲数。",
            "solution": "该问题是有效的。这是一个基于标准流行病学建模原理的、定义明确的统计计算，特别是使用对数线性泊松模型对计数数据进行分析。所有必要的数据和参数均已提供，问题内部一致且有科学依据。\n\n主要目标是为一个拟合到 $4 \\times 4$ 新发病例计数表的年龄-时期-队列 (APC) 模型计算基于皮尔逊的过度离散估计值 $\\hat{\\phi}$。该估计值是评估泊松模型均值-方差假设有效性的关键诊断工具。\n\n在泊松广义线性模型中，响应变量 $Y_{a,p}$ 的方差被假定为其均值，即 $\\mathrm{Var}(Y_{a,p}) = \\mathbb{E}(Y_{a,p}) = \\mu_{a,p}$。当观测到的方差大于均值时，就会出现过度离散。皮尔逊卡方统计量 $X^2$ 提供了一种拟合优度的度量，可用于估计这种过度离散的尺度。\n\n皮尔逊卡方统计量定义为数据表中所有 $N$ 个单元格上皮尔逊残差的平方和。对于一个观测计数为 $Y_{a,p}$、拟合均值为 $\\hat{\\mu}_{a,p}$ 的单元格，其皮尔逊残差由 $\\frac{Y_{a,p} - \\hat{\\mu}_{a,p}}{\\sqrt{\\hat{\\mu}_{a,p}}}$ 给出。因此，该统计量为：\n$$ X^2 = \\sum_{a=1}^{4} \\sum_{p=1}^{4} \\frac{(Y_{a,p} - \\hat{\\mu}_{a,p})^2}{\\hat{\\mu}_{a,p}} $$\n在模型设定正确的原假设下，$X^2$ 渐近服从卡方分布 $\\chi^2_{df}$，其自由度 $df$ 计算为数据点数 ($N$) 减去估计参数的数量 ($r$)。问题说明有 $N = 16$ 个单元格，设计矩阵的秩为 $r = 13$，这对应于带约束的 APC 模型中独立参数的数量。\n自由度为：\n$$ df = N - r = 16 - 13 = 3 $$\n然后，离散度估计值 $\\hat{\\phi}$ 计算为皮尔逊卡方统计量除以其自由度。$\\hat{\\phi} \\approx 1$ 的值表明泊松模型是合适的，而 $\\hat{\\phi}  1$ 则表示存在过度离散。\n$$ \\hat{\\phi} = \\frac{X^2}{df} $$\n我们现在使用给定的观测计数 $Y_{a,p}$ 和拟合均值 $\\hat{\\mu}_{a,p}$ 来计算 $X^2$ 的值。\n\n对于年龄组 $a=1$：\n- $\\frac{(8 - 7.3)^2}{7.3} = \\frac{0.49}{7.3} \\approx 0.067123$\n- $\\frac{(7 - 7.2)^2}{7.2} = \\frac{0.04}{7.2} \\approx 0.005556$\n- $\\frac{(7 - 7.5)^2}{7.5} = \\frac{0.25}{7.5} \\approx 0.033333$\n- $\\frac{(6 - 6.2)^2}{6.2} = \\frac{0.04}{6.2} \\approx 0.006452$\n\n对于年龄组 $a=2$：\n- $\\frac{(14 - 13.5)^2}{13.5} = \\frac{0.25}{13.5} \\approx 0.018519$\n- $\\frac{(13 - 13.0)^2}{13.0} = \\frac{0}{13.0} = 0$\n- $\\frac{(12 - 12.6)^2}{12.6} = \\frac{0.36}{12.6} \\approx 0.028571$\n- $\\frac{(10 - 11.4)^2}{11.4} = \\frac{1.96}{11.4} \\approx 0.171930$\n\n对于年龄组 $a=3$：\n- $\\frac{(25 - 24.0)^2}{24.0} = \\frac{1}{24.0} \\approx 0.041667$\n- $\\frac{(22 - 21.7)^2}{21.7} = \\frac{0.09}{21.7} \\approx 0.004147$\n- $\\frac{(19 - 20.5)^2}{20.5} = \\frac{2.25}{20.5} \\approx 0.109756$\n- $\\frac{(17 - 18.9)^2}{18.9} = \\frac{3.61}{18.9} \\approx 0.190995$\n\n对于年龄组 $a=4$：\n- $\\frac{(47 - 38.1)^2}{38.1} = \\frac{79.21}{38.1} \\approx 2.079003$\n- $\\frac{(32 - 36.2)^2}{36.2} = \\frac{17.64}{36.2} \\approx 0.487293$\n- $\\frac{(26 - 33.3)^2}{33.3} = \\frac{53.29}{33.3} \\approx 1.600300$\n- $\\frac{(24 - 29.7)^2}{29.7} = \\frac{32.49}{29.7} \\approx 1.093939$\n\n将这 16 个项相加，得到皮尔逊卡方统计量：\n$$ X^2 \\approx 0.067123 + 0.005556 + 0.033333 + 0.006452 + 0.018519 + 0 + 0.028571 + 0.171930 \\\\ + 0.041667 + 0.004147 + 0.109756 + 0.190995 + 2.079003 + 0.487293 + 1.600300 + 1.093939 $$\n$$ X^2 \\approx 5.938584 $$\n最后，我们将 $X^2$ 除以自由度 $df=3$，计算离散度估计值 $\\hat{\\phi}$：\n$$ \\hat{\\phi} = \\frac{X^2}{df} \\approx \\frac{5.938584}{3} \\approx 1.979528 $$\n问题要求将结果四舍五入到三位有效数字。\n$$ \\hat{\\phi} \\approx 1.98 $$\n这个值表明数据中的方差大约是均值的 $1.98$ 倍，说明存在显著的过度离散。",
            "answer": "$$\n\\boxed{1.98}\n$$"
        }
    ]
}