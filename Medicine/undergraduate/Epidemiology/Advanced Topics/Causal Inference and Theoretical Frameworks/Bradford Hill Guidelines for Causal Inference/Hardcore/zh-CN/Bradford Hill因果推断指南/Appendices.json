{
    "hands_on_practices": [
        {
            "introduction": "在评估潜在的因果关系时，第一步是量化暴露与结局之间的关联强度。本练习将引导您计算流行病学中三种核心的关联测量指标：风险差（$RD$）、风险比（$RR$）和优势比（$OR$），并探讨如何根据 Bradford Hill 准则中的“关联强度”来解读这些数值。通过这个练习，您将理解不同测量尺度如何为因果推断提供独特的视角。",
            "id": "4574269",
            "problem": "一项关于某暴露因素和二分类结局的队列研究，其数据由一个$2\\times 2$表格总结，各单元格计数如下：暴露组病例$=120$，暴露组非病例$=480$，非暴露组病例$=30$，非暴露组非病例$=570$。从流行病学的基础定义出发——即风险是组内出现结局的概率，而比值是出现结局的概率与不出现结局的概率之比——仅使用这些计数来推导和计算风险差（RD）、风险比（RR）和比值比（OR）。然后，在每种度量尺度上解释 Bradford Hill 准则中关联的“强度”，说明每种效应量的大小对因果效应的合理性意味着什么，并论证当基线风险在不同亚群中变化时，哪种尺度对判断因果关系最具诊断价值。\n\n将每个计算出的度量指标（$RD$、$RR$ 和 $OR$）四舍五入至四位有效数字。将 $RD$ 表示为小数（例如，$0.05$），不带百分号，将 $RR$ 和 $OR$ 表示为无单位的比率。按 $RD$、$RR$、$OR$ 的顺序，以单行矩阵的形式提供最终的数值三元组。",
            "solution": "基础量由$2\\times 2$表格的计数推导得出。设暴露组总人数为 $n_{1} = 120 + 480$，非暴露组总人数为 $n_{0} = 30 + 570$。暴露组的风险，记为 $p_{1}$，是在暴露人群中成为病例的概率，计算方法为暴露组病例数除以暴露组总人数。同样，非暴露组的风险，记为 $p_{0}$，是在非暴露人群中成为病例的概率。每组的比值定义为风险除以（1-风险）。\n\n计算各组总人数：\n$$\nn_{1} = 120 + 480 = 600, \\quad n_{0} = 30 + 570 = 600.\n$$\n计算风险：\n$$\np_{1} = \\frac{120}{600} = 0.2, \\quad p_{0} = \\frac{30}{600} = 0.05.\n$$\n计算风险差 (RD)：\n$$\nRD = p_{1} - p_{0} = 0.2 - 0.05 = 0.15.\n$$\n计算风险比 (RR)：\n$$\nRR = \\frac{p_{1}}{p_{0}} = \\frac{0.2}{0.05} = 4.\n$$\n计算各组的比值。暴露组的比值 $o_{1}$ 为\n$$\no_{1} = \\frac{p_{1}}{1 - p_{1}} = \\frac{0.2}{0.8} = \\frac{120}{480} = 0.25,\n$$\n非暴露组的比值 $o_{0}$ 为\n$$\no_{0} = \\frac{p_{0}}{1 - p_{0}} = \\frac{0.05}{0.95} = \\frac{30}{570} = \\frac{1}{19} \\approx 0.0526315789.\n$$\n因此，比值比 (OR) 为\n$$\nOR = \\frac{o_{1}}{o_{0}} = \\frac{0.25}{1/19} = 0.25 \\times 19 = \\frac{19}{4} = 4.75.\n$$\n\n将每个度量指标四舍五入至四位有效数字，得到：\n$$\nRD = 0.1500, \\quad RR = 4.000, \\quad OR = 4.750.\n$$\n\n根据 Bradford Hill 准则对“强度”的解释，重点在于关联的大小及其对因果推断的启示。一个较大的效应量不太可能完全由残余混杂或偏倚来解释，尽管它并非因果关系的最终证明。在绝对尺度上，$RD = 0.15$ 表明暴露导致结局发生的概率增加了 $0.15$；考虑到基线风险 $p_{0} = 0.05$，这个绝对差异在公共卫生方面是显著的。在相对尺度上，$RR = 4$ 表明暴露组的风险是非暴露组的四倍，这是一个强关联。$OR = 4.75$ 同样表明了一个强关联，但其数值上大于 $RR$，因为该结局并非罕见，且随着患病率的增加，比值比会偏离风险比。\n\n关于在存在基线风险异质性的情况下，哪种尺度对判断因果关系最具诊断价值，关键是要考虑当基线风险在不同亚群中变化时，每种度量指标的表现。风险差对基线风险高度敏感：即使在恒定的乘性因果效应下，$RD$ 也会随 $p_{0}$ 变化，这使得跨层间的比较可能产生误导，并且在基线风险不同时为“强度”提供不太稳定的证据。比值比是不可坍缩的（noncollapsible），这意味着即使在没有混杂的情况下，它也可能随分层而改变，并且随着结局患病率的上升，它倾向于夸大相对于风险比的效应量，这使得在异质性基线下的解释变得复杂。相比之下，风险比是可坍缩的（collapsible），并且在流行病学中常见的乘性因果结构下通常更稳定；当基线风险变化时，它为跨层比较“强度”提供了一个更易于解释和比较的度量。因此，在存在基线风险异质性的情况下，风险比通常是评估 Bradford Hill 框架中“强度”标准最具诊断价值的尺度，同时也要承认，因果推断需要与其他准则（如时间顺序、剂量-反应关系、一致性和特异性）进行三角验证，并排除其他可能的解释。\n\n按 $RD$、$RR$、$OR$ 顺序排列的最终数值三元组为\n$$\n\\begin{pmatrix}\n0.1500  4.000  4.750\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.1500  4.000  4.750\\end{pmatrix}}$$"
        },
        {
            "introduction": "“剂量-反应关系”是 Bradford Hill 准则中一个极具说服力的指标，它指的是随着暴露水平的增加，结局风险也呈现出规律性变化。本练习将向您展示如何使用Cochran-Armitage趋势检验这一统计学工具，来量化评估暴露剂量与疾病风险之间是否存在线性趋势。掌握这种方法能让您超越简单的“有”或“无”的关联判断，从而为因果关系提供更强的证据。",
            "id": "4574335",
            "problem": "一项队列研究考察了一个有序分类暴露，该暴露被分为对应于剂量递增的四个四分位数。在每个四分位数中，有 $n_{i} = 500$ 名参与者，对于 $i = 1,2,3,4$，观察到的二元不良结局的风险分别为 $0.05$、$0.08$、$0.12$ 和 $0.20$。为正式评估 Bradford Hill 准则中的剂量反应梯度，假设暴露评分等距（$w_{i} = 1, 2, 3, 4$），计算跨有序四分位数的 Cochran–Armitage 趋势检验（CATT）的标准化检验统计量。以最简根式的形式给出该标准化统计量的精确闭式解析表达式。然后，基于假设检验的基本原理和 Bradford Hill 因果推断准则中的剂量反应考量，解释观察到的梯度是否支持因果关系。\n\n将最终的标准化 Cochran–Armitage 趋势检验统计量表示为精确的解析表达式。不要四舍五入。无需单位。",
            "solution": "Bradford Hill 因果推断准则包括剂量反应（生物学梯度）的考量：如果风险随着暴露的增加而单调增加，这支持（但不能证明）因果关系。在统计上，评估二元结局在有序暴露类别中是否存在单调梯度的一个可靠方法是 Cochran–Armitage 趋势检验（CATT），该检验测试了在分配给有序类别的评分上，结局概率不存在线性趋势的原假设。\n\n基本原理：\n- 对于每个组 $i$，观察到的病例数 $x_{i}$ 和总人数 $n_{i}$ 定义了经验风险 $p_{i} = x_{i}/n_{i}$。\n- 对于 $k$ 个有序组，合并风险为 $p = \\left(\\sum_{i=1}^{k} x_{i}\\right) / \\left(\\sum_{i=1}^{k} n_{i}\\right)$。\n- 在有序组上给定固定评分 $w_{i}$，CATT 构建一个线性统计量\n$$\nT = \\sum_{i=1}^{k} w_{i} \\left(x_{i} - n_{i} p\\right),\n$$\n在无线性趋势的原假设下，其方差为\n$$\n\\operatorname{Var}(T) = p(1-p) \\sum_{i=1}^{k} n_{i} \\left(w_{i} - \\bar{w}\\right)^{2}, \\quad \\text{其中} \\quad \\bar{w} = \\frac{\\sum_{i=1}^{k} n_{i} w_{i}}{\\sum_{i=1}^{k} n_{i}}。\n$$\n标准化检验统计量为\n$$\nZ = \\frac{T}{\\sqrt{\\operatorname{Var}(T)}}.\n$$\n\n我们有 $k = 4$ 个有序四分位数，各组大小相等 $n_{1} = n_{2} = n_{3} = n_{4} = 500$，风险分别为 $p_{1} = 0.05, p_{2} = 0.08, p_{3} = 0.12, p_{4} = 0.20$。暴露评分是等距的：$w_{1} = 1, w_{2} = 2, w_{3} = 3, w_{4} = 4$。\n\n从风险计算病例数：\n$$\nx_{1} = 500 \\times 0.05 = 25, \\quad x_{2} = 500 \\times 0.08 = 40, \\quad x_{3} = 500 \\times 0.12 = 60, \\quad x_{4} = 500 \\times 0.20 = 100.\n$$\n总病例数和总样本量：\n$$\n\\sum_{i=1}^{4} x_{i} = 25 + 40 + 60 + 100 = 225, \\quad \\sum_{i=1}^{4} n_{i} = 4 \\times 500 = 2000.\n$$\n合并风险：\n$$\np = \\frac{225}{2000} = \\frac{9}{80}.\n$$\n计算评分的加权平均值：\n$$\n\\bar{w} = \\frac{\\sum_{i=1}^{4} n_{i} w_{i}}{\\sum_{i=1}^{4} n_{i}} = \\frac{500(1+2+3+4)}{2000} = \\frac{500 \\times 10}{2000} = \\frac{5}{2}.\n$$\n\n计算 $T$：\n首先，计算每个组的 $n_{i} p$：$n_{i} p = 500 \\times \\frac{9}{80} = \\frac{500 \\times 9}{80} = \\frac{4500}{80} = \\frac{225}{4} = 56.25$。\n因此，\n$$\nx_{1} - n_{1} p = 25 - \\frac{225}{4} = -\\frac{125}{4}, \\quad\nx_{2} - n_{2} p = 40 - \\frac{225}{4} = -\\frac{65}{4}, \\quad\nx_{3} - n_{3} p = 60 - \\frac{225}{4} = \\frac{15}{4}, \\quad\nx_{4} - n_{4} p = 100 - \\frac{225}{4} = \\frac{175}{4}.\n$$\n乘以评分并求和：\n$$\nT = 1\\left(-\\frac{125}{4}\\right) + 2\\left(-\\frac{65}{4}\\right) + 3\\left(\\frac{15}{4}\\right) + 4\\left(\\frac{175}{4}\\right)\n= -\\frac{125}{4} - \\frac{130}{4} + \\frac{45}{4} + \\frac{700}{4}\n= \\frac{-125 - 130 + 45 + 700}{4}\n= \\frac{490}{4}\n= \\frac{245}{2}.\n$$\n\n计算 $\\operatorname{Var}(T)$：\n首先计算评分偏差的平方，\n$$\n(1 - \\tfrac{5}{2})^{2} = \\left(-\\tfrac{3}{2}\\right)^{2} = \\tfrac{9}{4}, \\quad\n(2 - \\tfrac{5}{2})^{2} = \\left(-\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\n(3 - \\tfrac{5}{2})^{2} = \\left(\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\n(4 - \\tfrac{5}{2})^{2} = \\left(\\tfrac{3}{2}\\right)^{2} = \\tfrac{9}{4}.\n$$\n按相等的 $n_{i}$ 加权求和：\n$$\n\\sum_{i=1}^{4} n_{i} \\left(w_{i} - \\bar{w}\\right)^{2} = 500\\left(\\tfrac{9}{4} + \\tfrac{1}{4} + \\tfrac{1}{4} + \\tfrac{9}{4}\\right) = 500 \\times \\tfrac{20}{4} = 500 \\times 5 = 2500.\n$$\n计算 $p(1-p)$：\n$$\np(1-p) = \\frac{9}{80}\\left(1 - \\frac{9}{80}\\right) = \\frac{9}{80} \\cdot \\frac{71}{80} = \\frac{639}{6400}.\n$$\n因此，\n$$\n\\operatorname{Var}(T) = \\frac{639}{6400} \\times 2500 = \\frac{639 \\times 2500}{6400} = \\frac{639 \\times 25}{64} = \\frac{15975}{64}.\n$$\n\n标准化统计量：\n$$\nZ = \\frac{T}{\\sqrt{\\operatorname{Var}(T)}} = \\frac{\\frac{245}{2}}{\\sqrt{\\frac{15975}{64}}} = \\frac{\\frac{245}{2}}{\\frac{\\sqrt{15975}}{8}} = \\frac{245}{2} \\cdot \\frac{8}{\\sqrt{15975}} = \\frac{980}{\\sqrt{15975}}.\n$$\n这就是精确的闭式表达式。\n\n相对于 Bradford Hill 剂量反应准则的解释：\n有序风险 $0.05, 0.08, 0.12, 0.20$ 显示出随暴露四分位数增加而清晰的单调递增趋势。较大的标准化趋势统计量 $Z = \\frac{980}{\\sqrt{15975}}$ 在标准正态近似下对应一个非常小的双侧尾部概率，这表明有强有力的统计证据支持结局风险在不同暴露类别间存在正向线性趋势。这一具有统计学显著性的单调梯度支持 Bradford Hill 准则中的生物学梯度考量，从而加强了暴露与结局之间存在因果关系的论证。然而，与所有 Bradford Hill 准则的考量一样，仅有梯度本身并不能确立因果关系；仍必须评估并排除混杂、偏倚和其他替代解释。",
            "answer": "$$\\boxed{\\frac{980}{\\sqrt{15975}}}$$"
        },
        {
            "introduction": "在观察性研究中，一个强关联未必等同于因果关系，因为它可能被未测量的混杂因素所扭曲。E-值（E-value）是评估研究结果对潜在未测量混杂因素稳健性的现代工具。 这个练习将教您如何计算和解释E-值，从而量化一个未知的混杂因素需要多强才能使我们观察到的关联完全消失，这对于批判性地解读流行病学证据至关重要。",
            "id": "4574397",
            "problem": "一项观察性队列研究报告了二元暴露与二元结局之间的关联，其调整后的风险比 (RR) 为 $RR=2.4$，95% 置信区间 (CI) 为 $1.3$ 到 $4.4$。为评估关联强度的布拉德福德·希尔准则在未测量混杂方面的稳健性，请使用 E 值的概念。E 值定义为：在已测量协变量的条件下，一个未测量的混杂因素要完全解释掉观察到的关联（点估计 E 值），或将置信区间的相应限值移动至包含无效值 $1$（极限 E 值），该混杂因素需要在风险比尺度上与暴露和结局都具有的最小关联强度。\n\n从以下基本事实出发：\n- 风险比 $RR$ 定义为风险之比 $RR = \\frac{P(Y=1 \\mid A=1)}{P(Y=1 \\mid A=0)}$。\n- 对于单个未测量的二元混杂因素 $U$，给定暴露与混杂因素之间的风险比关联 $RR_{EU}$，以及混杂因素与结局之间的风险比关联 $RR_{UY}$，风险比尺度上的最大可能偏倚因子 $B$ 受以下不等式约束：\n$$\nB \\leq \\frac{RR_{EU} \\, RR_{UY}}{RR_{EU} + RR_{UY} - 1},\n$$\n此条件是基于已测量的协变量，并且在风险比尺度上的关联满足正向性和单调性。\n- E 值被定义为满足以下条件的最小值 $x \\geq 1$：当设置 $RR_{EU} = RR_{UY} = x$ 时，产生的偏倚因子 $B$ 等于观察到的目标值（点估计 $RR$ 或相关的置信限）。\n\n利用这些基础，推导 E 值作为通用风险比 $r1$ 的函数的封闭形式表达式，然后计算：\n1) 使用 $r=2.4$ 计算点估计 E 值。\n2) 使用 $95\\%$ 置信区间的下限 $r=1.3$ 计算极限 E 值。\n\n将两个 E 值四舍五入到四位有效数字。以无单位行矩阵的形式报告您的最终答案，将点估计 E 值放在前面，极限 E 值放在后面。此外，在您的解题过程中，简要解释这些 E 值对于观察到的关联在布拉德福德·希尔强度准则意义下对未测量混杂的稳健性意味着什么。",
            "solution": "该问题要求推导 E 值的封闭式表达式，并随后计算两种情景下的 E 值。\n\n首先，我们推导对于一个观察到的风险比 $r  1$ 的 E 值（表示为 $E$）的通用公式。E 值被定义为一个未测量的混杂因素要完全解释掉风险比 $r$ 所必须与暴露和结局同时具有的最小关联强度 $x$。这对应于混杂偏倚因子 $B$ 等于观察到的风险比 $r$ 的情景。\n\n问题指出，对于相等的混杂因素-暴露（$RR_{EU}$）和混杂因素-结局（$RR_{UY}$）的风险比（我们将其设为 $x$），偏倚因子 $B$ 由以下表达式给出：\n$$\nB = \\frac{RR_{EU} \\cdot RR_{UY}}{RR_{EU} + RR_{UY} - 1} = \\frac{x \\cdot x}{x + x - 1} = \\frac{x^{2}}{2x - 1}\n$$\n为了找到 E 值，我们将此偏倚因子设为等于目标风险比 $r$，并求解 $x$，约束条件为 $x \\geq 1$。\n$$\nr = \\frac{x^{2}}{2x - 1}\n$$\n重新整理此方程可得到一个关于 $x$ 的二次方程：\n$$\nr(2x - 1) = x^{2}\n$$\n$$\n2rx - r = x^{2}\n$$\n$$\nx^{2} - 2rx + r = 0\n$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^{2} - 4ac}}{2a}$ 来解这个关于 $x$ 的二次方程，其中 $a=1$，$b=-2r$，$c=r$。\n$$\nx = \\frac{-(-2r) \\pm \\sqrt{(-2r)^{2} - 4(1)(r)}}{2(1)} = \\frac{2r \\pm \\sqrt{4r^{2} - 4r}}{2} = r \\pm \\sqrt{r^{2} - r}\n$$\n这给出了 $x$ 的两个可能解。然而，E 值必须至少为 $1$。对于 $r1$，满足 $x \\geq 1$ 的唯一有效解是较大的根。E 值 $E$ 作为风险比 $r1$ 的函数的封闭式表达式为：\n$$\nE(r) = r + \\sqrt{r^{2} - r}\n$$\n\n现在，我们计算所要求的两个 E 值。\n\n1) 点估计 E 值是使用观察到的风险比 $r = RR = 2.4$ 计算的。\n$$\nE_{\\text{point}} = 2.4 + \\sqrt{(2.4)^{2} - 2.4}\n$$\n$$\nE_{\\text{point}} = 2.4 + \\sqrt{5.76 - 2.4}\n$$\n$$\nE_{\\text{point}} = 2.4 + \\sqrt{3.36}\n$$\n$$\nE_{\\text{point}} \\approx 2.4 + 1.833030278...\n$$\n$$\nE_{\\text{point}} \\approx 4.233030278...\n$$\n四舍五入到四位有效数字，点估计 E 值为 $4.233$。\n\n2) 极限 E 值的计算是为了评估需要多大的未测量混杂才能将置信区间移动到包含无效值 $1$。对于大于 $1$ 的风险比，我们使用置信区间的下限 $r = 1.3$。\n$$\nE_{\\text{limit}} = 1.3 + \\sqrt{(1.3)^{2} - 1.3}\n$$\n$$\nE_{\\text{limit}} = 1.3 + \\sqrt{1.69 - 1.3}\n$$\n$$\nE_{\\text{limit}} = 1.3 + \\sqrt{0.39}\n$$\n$$\nE_{\\text{limit}} \\approx 1.3 + 0.6244998...\n$$\n$$\nE_{\\text{limit}} \\approx 1.9244998...\n$$\n四舍五入到四位有效数字，极限 E 值为 $1.924$。\n\n最后，我们简要解释这些 E 值。布拉德福德·希尔的“强度”准则假设，更强的关联不太可能完全由混杂因素解释。E 值量化了这一概念。\n- 点估计 E 值为 $4.233$ 意味着，要完全解释掉观察到的风险比 $2.4$，一个未测量的混杂因素需要在已测量协变量的条件下，与暴露和结局的风险比关联都至少为 $4.233$。这种强度的关联是相当强的。如果认为存在如此强的混杂因素是不太可能的，那么观察到的 $2.4$ 的关联对于未测量的混杂是稳健的。\n- 极限 E 值为 $1.924$ 意味着，要将 $95\\%$ 置信区间的下限从 $1.3$ 移动到无效值 $1.0$，一个未测量的混杂因素需要与暴露和结局的风险比关联都至少为 $1.924$。这种强度的关联是中等的。这表明研究结果的统计显著性（即置信区间不包括无效值）的稳健性较差。如果存在一个中等强度的混杂因素，它可能足以使该关联在统计上不显著，即使它不能完全解释掉点估计值。\n总而言之，虽然点估计看起来是稳健的，但置信区间更容易受到未测量混杂的影响。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.233  1.924 \\end{pmatrix}}\n$$"
        }
    ]
}