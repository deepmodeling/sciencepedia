{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是基础。它将帮助我们直观地理解信息如何在因果图中流动。我们将通过一个包含因果路径和混杂路径的常见场景，来探索对不同变量进行条件化如何选择性地阻断或打开这些路径，这正是d-分离的核心原理 。",
            "id": "4587645",
            "problem": "考虑一个流行病学情境，其中包含暴露 $E$、中介变量 $M$、结局 $Y$，以及一个暴露前同时作为 $E$ 和 $Y$ 的共同原因 $C$。构建一个有向无环图（DAG），其边为 $E \\to M \\to Y$ 和 $E \\leftarrow C \\to Y$。假设不存在其他变量或边，也没有选择或测量过程。\n\n使用d-分离的形式化概念，确定在以下每个条件集下，$E$ 和 $Y$ 之间的哪些路径是开放的：无变量（空集）、仅 $\\{C\\}$、仅 $\\{M\\}$ 以及 $\\{C,M\\}$。对于每个条件集，请在您的解题过程中定性地列出所有开放路径，但最终答案只需报告每种条件情景下开放路径的数量。\n\n答案规格：\n- 以四元行向量的形式提供开放路径的数量，顺序为：无变量、$\\{C\\}$、$\\{M\\}$、$\\{C,M\\}$。\n- 最终答案必须是单个整数行向量。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于使用有向无环图（DAG）进行因果推断的原理，问题设定良好，具有唯一且可验证的解，并以客观、形式化的语言陈述。\n\n该问题描述了一个包含四个变量的系统：暴露 $E$、中介变量 $M$、结局 $Y$ 和一个共同原因（混杂因素）$C$。这些关系由一组有向边给出：$C \\to E$、$C \\to Y$、$E \\to M$ 和 $M \\to Y$。因此，相应的有向无环图（DAG）由节点 $\\{E, M, Y, C\\}$ 和代表这些因果影响的边构成。\n\n任务是识别暴露 $E$ 和结局 $Y$ 之间的所有路径，并根据d-分离的规则，确定在不同的条件集下，这些路径中的哪些是开放的或被阻断的。路径是连接两个变量的一系列边，无论箭头的方向如何。\n\n首先，我们在指定的图中识别出 $E$ 和 $Y$ 之间的所有路径。存在两条这样的路径：\n1.  路径 1：$E \\to M \\to Y$。这是一条从 $E$ 到 $Y$ 的有向因果路径，由 $M$ 所中介。\n2.  路径 2：$E \\leftarrow C \\to Y$。这是一条由共同原因 $C$ 产生的从 $E$到 $Y$的非因果“后门”路径。\n\n接下来，我们应用d-分离规则来确定每条路径在给定条件集 $S$ 下的状态（开放或阻断）。如果一条路径包含一个位于 $S$ 中的非对撞节点，或者包含一个不在 $S$ 中且在 $S$ 中没有后代的对撞节点，那么该路径就被集合 $S$ 阻断。反之，如果一条路径未被阻断，则它是开放的。\n\n-   路径上的一个节点如果是“链”结构，则箭头首尾相接（例如 $\\to Z \\to$）。通过对中间节点 $Z$ 进行条件化，可以阻断链。\n-   路径上的一个节点如果是“分叉”结构，则箭头从该节点发出（例如 $\\leftarrow Z \\to$）。通过对中间节点 $Z$ 进行条件化，可以阻断分叉。\n-   路径上的一个节点如果是“对撞节点”，则箭头在该节点头对头相遇（例如 $\\to Z \\leftarrow$）。对撞节点默认会阻断路径。对该对撞节点本身或其后代进行条件化，会打开该路径。\n\n在我们的图中，路径 1 ($E \\to M \\to Y$) 是一个通过 $M$ 的链。路径 2 ($E \\leftarrow C \\to Y$) 是一个在 $C$ 处的分叉。在 $E$ 和 $Y$ 之间的任何路径上都没有对撞节点。\n\n我们现在为每个指定的条件集分析这些路径：\n\n1.  **条件集 $S = \\emptyset$ (无变量)**\n    -   **路径 1 ($E \\to M \\to Y$)：** 这条路径是一个通过 $M$ 的链。由于中间节点 $M$ 不在条件集 $S = \\emptyset$ 中，该路径是**开放**的。\n    -   **路径 2 ($E \\leftarrow C \\to Y$)：** 这条路径是在 $C$ 处的分叉。由于分叉节点 $C$ 不在条件集 $S = \\emptyset$ 中，该路径是**开放**的。\n    -   **总开放路径数：** $2$。开放路径为 $E \\to M \\to Y$ 和 $E \\leftarrow C \\to Y$。\n\n2.  **条件集 $S = \\{C\\}$**\n    -   **路径 1 ($E \\to M \\to Y$)：** 这条路径是一个通过 $M$ 的链。中间节点 $M$ 不在条件集 $S = \\{C\\}$ 中。因此，该路径保持**开放**。\n    -   **路径 2 ($E \\leftarrow C \\to Y$)：** 这条路径是在 $C$ 处的分叉。分叉节点 $C$ 在条件集 $S = \\{C\\}$ 中。因此，该路径被**阻断**。\n    -   **总开放路径数：** $1$。唯一的开放路径是 $E \\to M \\to Y$。\n\n3.  **条件集 $S = \\{M\\}$**\n    -   **路径 1 ($E \\to M \\to Y$)：** 这条路径是一个通过 $M$ 的链。中间节点 $M$ 在条件集 $S = \\{M\\}$ 中。因此，该路径被**阻断**。\n    -   **路径 2 ($E \\leftarrow C \\to Y$)：** 这条路径是在 $C$ 处的分叉。分叉节点 $C$ 不在条件集 $S = \\{M\\}$ 中。因此，该路径保持**开放**。\n    -   **总开放路径数：** $1$。唯一的开放路径是 $E \\leftarrow C \\to Y$。\n\n4.  **条件集 $S = \\{C, M\\}$**\n    -   **路径 1 ($E \\to M \\to Y$)：** 这条路径是一个通过 $M$ 的链。中间节点 $M$ 在条件集 $S = \\{C, M\\}$ 中。因此，该路径被**阻断**。\n    -   **路径 2 ($E \\leftarrow C \\to Y$)：** 这条路径是在 $C$ 处的分叉。分叉节点 $C$ 在条件集 $S = \\{C, M\\}$ 中。因此，该路径被**阻断**。\n    -   **总开放路径数：** $0$。两条路径均被阻断。\n\n综上所述，对于条件集 $\\emptyset$、$\\{C\\}$、$\\{M\\}$ 和 $\\{C,M\\}$，$E$ 和 $Y$ 之间的开放路径数量分别为 $2$、$1$、$1$ 和 $0$。问题要求将这些计数以一个四元行向量的形式给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在路径分析的基础上，这个练习将我们从理论带入策略层面。我们将学习如何应用后门准则，从一组包括混杂因素、中介变量和其他变量的潜在协变量中，选择一个*最小充分调整集*。这个练习强调了，为了分离出我们感兴趣的因果效应，不仅仅是进行变量调整，更重要的是调整*正确*的变量 。",
            "id": "4587650",
            "problem": "考虑一个有向无环图 (DAG)，其节点为 $E$ (暴露)、$Y$ (结果)、$C$ ($E$ 和 $Y$ 的共同原因)、$M$ ($E$ 到 $Y$ 路径上的中介变量)以及 $L$ ($E$ 的后代)。其因果结构如下：存在箭头 $C \\to E$ 和 $C \\to Y$ (因此 $C$ 是一个混杂因素)，一条直接的因果箭头 $E \\to Y$，一条中介路径 $E \\to M \\to Y$，以及一个额外的箭头 $E \\to L$ ($L$ 不会导致 $Y$)。假设您只能从观测到的协变量集 $\\{C, M, L\\}$ 中构建调整集，以通过协变量调整来识别 $E$ 对 $Y$ 的总因果效应。\n\n定义 $N$ 为 $\\{C, M, L\\}$ 的子集中，在因果识别的标准图形条件下，可作为识别 $E$ 对 $Y$ 总效应的最小充分调整集的数量。计算 $N$ 的精确值。以单个整数形式提供您的答案。无需四舍五入。",
            "solution": "该问题要求我们，在给定一组可观测协变量 $\\{C, M, L\\}$ 和一个特定的因果结构的情况下，确定用于识别暴露 $E$ 对结果 $Y$ 的总因果效应的最小充分调整集的数量 $N$。该因果结构被编码在一个有向无环图 (DAG) 中。\n\n首先，我们根据问题描述来形式化这个 DAG。节点为 $E$ (暴露)、$Y$ (结果)、$C$ (混杂因素)、$M$ (中介变量)和 $L$ ($E$ 的后代)。因果箭头（边）如下：\n1.  $C \\to E$ 和 $C \\to Y$：$C$ 是 $E$ 和 $Y$ 的共同原因。\n2.  $E \\to Y$：存在从 $E$ 到 $Y$ 的直接因果效应。\n3.  $E \\to M \\to Y$：存在一条通过 $M$ 从 $E$ 到 $Y$ 的中介因果路径。这意味存在两个箭头：$E \\to M$ 和 $M \\to Y$。\n4.  $E \\to L$：$L$ 是 $E$ 的后代。问题说明 $L$ 不会导致 $Y$，因此没有从 $L$ 到 $Y$ 的有向路径。\n\n可用于调整的协变量集是 $Z_{obs} = \\{C, M, L\\}$。我们正在寻找 $Z_{obs}$ 中作为最小充分调整集的子集。\n\n为了通过协变量调整来识别 $E$ 对 $Y$ 的总因果效应，我们需要找到一个协变量集 $Z \\subseteq Z_{obs}$，使其成为一个“充分调整集”。如果集合 $Z$ 满足以下两个条件，它就足以估计 $E$ 对 $Y$ 的总因果效应：\n1.  它阻断了 $E$ 和 $Y$ 之间的所有非因果路径。\n2.  它不阻断任何从 $E$ 到 $Y$ 的因果路径。\n非因果路径是 $E$ 与 $Y$ 之间的任意路径，只要它不是从 $E$ 到 $Y$ 的有向路径。因果路径是从 $E$ 到 $Y$ 的有向路径。我们还必须确保以 $Z$ 为条件不会打开任何新的伪路径，这通常发生在以对撞节点为条件时。\n\n让我们分析指定的 DAG 中 $E$ 和 $Y$ 之间的路径。\n- **因果路径**：这些是从 $E$ 到 $Y$ 的有向路径。\n    1.  直接路径：$E \\to Y$。\n    2.  中介路径：$E \\to M \\to Y$。\n    总效应是所有因果路径上效应的总和。为了估计总效应，我们的调整集 $Z$ 不能阻断任何这些路径。如果一个变量在路径上，那么以该变量为条件会阻断该路径。变量 $M$ 是第二条因果路径上的一个节点。因此，为避免阻断此路径，调整集 $Z$ 必须不包含 $M$。\n    $$M \\notin Z$$\n\n- **非因果路径（后门路径）**：这些是 $E$ 和 $Y$ 之间以指向 $E$ 的箭头开始的路径。\n    1.  唯一这样的路径是 $E \\leftarrow C \\to Y$。这条路径是混杂的来源，因为它代表了共同原因 $C$ 的影响。\n    要阻断这条路径，我们必须以中间节点 $C$ 为条件，它是一个分叉。因此，调整集 $Z$ 必须包含 $C$。\n    $$C \\in Z$$\n\n结合这两个必要条件，从 $\\{C, M, L\\}$ 中选取的任何充分调整集 $Z$ 都必须包含 $C$ 且不包含 $M$。这为 $Z$ 留下了两种可能性：\n1.  $Z_1 = \\{C\\}$\n2.  $Z_2 = \\{C, L\\}$\n\n我们现在必须验证这些集合是否确实是充分的。这涉及到检查是否有任何意外后果，例如通过以对撞节点为条件而打开一条伪路径。路径上的对撞节点是一个有两个箭头指向它的节点（例如，$i \\to m \\leftarrow j$）。以对撞节点（或其后代）为条件会打开该路径。\n- 在我们的 DAG 中，对撞节点是 $E$（在路径 $C \\to E \\to L$ 和 $C \\to E \\to M$ 上）和 $Y$（在路径 $E \\to M \\to Y \\leftarrow C$ 上）。\n- $C$ 和 $L$ 都不是对撞节点。$C$ 只有指出的箭头。$L$ 只有一个指向的箭头（$E \\to L$）。\n- 因此，以 $C$ 或 $L$ 为条件不会在 $E$ 和 $Y$ 之间打开任何伪路径。\n\n$Z_1 = \\{C\\}$ 和 $Z_2 = \\{C, L\\}$ 都满足充分调整集的条件：\n- 它们都包含 $C$，从而阻断了后门路径 $E \\leftarrow C \\to Y$。\n- 它们都不包含 $M$，因此不会阻断因果路径 $E \\to M \\to Y$。\n- 以它们为条件不会打开任何伪路径。\n\n因此，可以从 $\\{C, M, L\\}$ 构建的所有充分调整集的集合是 $\\mathcal{S} = \\{\\{C\\}, \\{C, L\\}\\}$。\n\n问题要求的是**最小**充分调整集的数量 $N$。如果一个充分调整集 $S \\in \\mathcal{S}$ 的任何真子集都不在 $\\mathcal{S}$ 中，则该集合是最小的。\n让我们检查一下 $\\mathcal{S}$ 中的集合：\n- 考虑集合 $\\{C\\}$。它唯一的真子集是空集 $\\emptyset$。集合 $\\emptyset$ 不是一个充分调整集，因为它没有阻断后门路径 $E \\leftarrow C \\to Y$。因此，$\\{C\\}$ 是一个最小充分调整集。\n- 考虑集合 $\\{C, L\\}$。它有一个真子集 $\\{C\\}$。由于 $\\{C\\}$ 是一个充分调整集（即 $\\{C\\} \\in \\mathcal{S}$），所以集合 $\\{C, L\\}$ 不是最小的。\n\n因此，只有一个最小充分调整集，即 $\\{C\\}$。\n最小充分调整集的数量是 $N = 1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "最后一步是将我们识别出的因果结构转化为一个具体的数值。这个练习提供了一个带有观测数据的场景，并要求我们应用后门调整公式（或称g-公式）。通过完成这个计算，我们将看到如何估计因果风险差，从而从理论上的识别走向对干预效果的量化评估 。",
            "id": "4587606",
            "problem": "考虑一项关于传染病的研究，其中二元暴露 $E$ 表示是否接受了预防性干预（$E=1$ 表示接受，$E=0$ 表示未接受），二元结局 $Y$ 表示30天内是否发生新发感染（$Y=1$ 表示感染，$Y=0$ 表示未感染），二元协变量 $Z$ 表示基线时是否存在高合并症负担（$Z=1$ 表示高负担，$Z=0$ 表示低负担）。其因果结构由一个有向无环图（DAG）表示，其中 $Z$ 有指向 $E$ 和 $Y$ 的箭头，$E$ 有指向 $Y$ 的箭头。假设 $E$ 和 $Y$ 没有其他共同原因，所有变量的测量均无误差，并且满足以下条件：给定 $Z$ 的条件可交换性、一致性和正性。\n\n该研究估计了以下量：\n- $p(Z=1)=0.4$ 和 $p(Z=0)=0.6$。\n- $p(Y=1\\mid E=1,Z=0)=0.25$ 和 $p(Y=1\\mid E=1,Z=1)=0.60$。\n- $p(Y=1\\mid E=0,Z=0)=0.10$ 和 $p(Y=1\\mid E=0,Z=1)=0.50$。\n\n使用 $Z$ 作为在所述DAG下识别 $E$ 对 $Y$ 的因果效应的有效后门调整集，计算经后门调整的因果风险差 $E[Y\\mid \\mathrm{do}(E=1)]-E[Y\\mid \\mathrm{do}(E=0)]$。将最终答案表示为小数（不带百分号）。提供精确值，无需四舍五入。",
            "solution": "该问题要求计算经后门调整的因果风险差，其定义为 $E[Y\\mid \\mathrm{do}(E=1)] - E[Y\\mid \\mathrm{do}(E=0)]$。该问题被验证为合理、定义明确且包含所有必要信息。\n\n因果结构由一个有向无环图（DAG）描述，其中协变量 $Z$ 是暴露 $E$ 和结局 $Y$ 的一个共同原因。具体来说，因果路径为 $Z \\rightarrow E$、$Z \\rightarrow Y$ 和 $E \\rightarrow Y$。路径 $E \\leftarrow Z \\rightarrow Y$ 是一条“后门路径”，因为它是 $E$ 和 $Y$ 之间的一条非因果路径，以一个指向 $E$ 的箭头开始。为了估计 $E$ 对 $Y$ 的因果效应，必须阻断这条后门路径。问题指出 $Z$ 是一个有效的后门调整集。这与后门准则一致，因为 $Z$ 不是 $E$ 的后代，并且以 $Z$ 为条件可以阻断路径 $E \\leftarrow Z \\rightarrow Y$。\n\n条件可交换性、一致性和正性的假设，以及指定的DAG，使得我们可以从提供的观测数据中识别出因果效应。我们可以使用后门调整公式（也称为标准化或g-公式）来计算潜在结局的均值 $E[Y \\mid \\mathrm{do}(E=e)]$。对于二元结局 $Y$，这等同于干预下结局的概率 $p(Y=1 \\mid \\mathrm{do}(E=e))$。\n\n该公式由下式给出：\n$$p(Y=1 \\mid \\mathrm{do}(E=e)) = \\sum_z p(Y=1 \\mid E=e, Z=z) \\cdot p(Z=z)$$\n\n我们需要为 $e=1$ 和 $e=0$ 分别计算这个量。\n\n首先，让我们计算如果人群中的每个人都接受了预防性干预，其感染风险为 $p(Y=1 \\mid \\mathrm{do}(E=1))$。求和是基于混杂因素 $Z$ 的各个分层，即 $Z=0$ 和 $Z=1$。\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = p(Y=1 \\mid E=1, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=1, Z=1) \\cdot p(Z=1)$$\n问题提供了以下值：\n- $p(Y=1\\mid E=1,Z=0) = 0.25$\n- $p(Y=1\\mid E=1,Z=1) = 0.60$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\n将这些值代入公式：\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = (0.25)(0.6) + (0.60)(0.4)$$\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = 0.15 + 0.24$$\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = 0.39$$\n\n接下来，我们计算如果人群中没有人接受干预，其感染风险为 $p(Y=1 \\mid \\mathrm{do}(E=0))$。\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = p(Y=1 \\mid E=0, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=0, Z=1) \\cdot p(Z=1)$$\n问题提供了：\n- $p(Y=1\\mid E=0,Z=0) = 0.10$\n- $p(Y=1\\mid E=0,Z=1) = 0.50$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\n代入这些值：\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = (0.10)(0.6) + (0.50)(0.4)$$\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = 0.06 + 0.20$$\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = 0.26$$\n\n最后，因果风险差是这两个量之间的差值。\n$$E[Y\\mid \\mathrm{do}(E=1)] - E[Y\\mid \\mathrm{do}(E=0)] = p(Y=1 \\mid \\mathrm{do}(E=1)) - p(Y=1 \\mid \\mathrm{do}(E=0))$$\n$$= 0.39 - 0.26$$\n$$= 0.13$$\n\n这个结果表示，在考虑了合并症负担 $Z$ 的混杂效应后，干预措施对总人群的感染风险的估计平均因果效应是降低了0.13。",
            "answer": "$$\\boxed{0.13}$$"
        }
    ]
}