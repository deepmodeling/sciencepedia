## 引言
在公共卫生、临床医学乃至社会政策领域，准确评估一项新措施、新指南或新法律的实际效果，是循证决策的基石。然而，在许多真实世界场景中，开展随机对照试验（RCT）并不可行。这为我们提出了一个关键挑战：如何在没有[对照组](@entry_id:188599)的情况下，严谨地推断干预措施的因果效应？中断时间序列（Interrupted Time Series, ITS）分析正是为应对这一挑战而设计的强大[准实验方法](@entry_id:636714)。它超越了简单的干预前后对比，通过分析长期数据趋势，为我们提供了一个更可靠的评估框架。本文将系统地引导您掌握ITS的核心知识。在“原理与机制”一章中，您将学习ITS的设计逻辑和作为其核心工具的分段回归模型。接着，在“应用与跨学科联系”一章中，我们将通过丰富的案例，展示ITS如何解决从评估国家政策到优化医院流程等多样化问题。最后，“动手实践”部分将提供练习，帮助您巩固相关的统计学基础。通过学习本文，您将能够理解并初步应用这一重要的流行病学研究方法。

## 原理与机制

在上一章对研究设计进行宏观介绍之后，本章将深入探讨中断时间序列（Interrupted Time Series, ITS）分析的核心原理与统计机制。作为一种强大的准实验设计，ITS被广泛应用于评估在明确时间点实施的干预措施（如政策、临床指南或公共卫生项目）的效果。本章旨在阐明ITS的设计逻辑、其核心分析工具——分段回归（segmented regression）的构建与解释，以及确保研究结论具有因果解释力的关键假设。

### 中断时间序列的设计逻辑

**中断时间序列（Interrupted Time Series, ITS）**是一种准实验设计，它利用在干预措施实施前后的一系列（即时间序列）观测数据来评估干预的效果。与仅比较干预前后单个时间点或平均值的简单前后对比设计不同，ITS的威力在于其利用了多个干预前的数据点来建立一个基线趋势（baseline trend）。这个基线趋势构成了对“反事实”（counterfactual）的预测基础——即在没有发生干预的情况下，结果变量的预期发展轨迹。

当干预在一个已知的时间点 $T_0$ 发生后，我们可以观测到一个新的、干预后的趋势。通过比较干预后观测到的实际趋势与由干预前趋势推断出的反事实趋势，我们便能量化干预带来的影响。这种影响可以表现为两个方面：结果变量水平的即刻改变（level change），以及其长期变化趋势的改变（slope change）。

例如，假设一个城市为了减少交通事故伤害，在某个月份 $T_0$ 开始实施一项新的交通安全条例。研究人员拥有该法令实施前后连续数月的每月伤害事故计数 $Y_t$。ITS分析的目的便是利用这些数据，严谨地回答以下问题：这项法令是否立即降低了伤害事故的数量？并且，它是否改变了伤害事故数量随时间变化的长期趋势？

### 使用分段回归模型量化影响

为了量化干预带来的水平和趋势变化，**分段回归（segmented regression）**是最常用的[统计模型](@entry_id:755400)。该模型通过构建特定的[自变量](@entry_id:267118)，将干预前后的时间序列拟合在同一个线性模型框架下。一个标准的分段回归模型可以表示为：

$$
E[Y_t] = \beta_0 + \beta_1 t + \beta_2 A_t + \beta_3 P_t
$$

其中，模型中的各个组成部分定义如下：

*   $Y_t$：在时间点 $t$ 观测到的结果变量（例如，每月的伤害事故计数）。

*   $t$：表示时间的连续变量，例如从研究开始计数的月份（$t = 1, 2, 3, \dots, T$）。

*   $A_t$：一个[虚拟变量](@entry_id:138900)，用于指示干预是否已经发生。它在干预前为 $0$，在干预开始及之后为 $1$。即：
    $$
    A_t = \begin{cases} 0  \text{if } t  T_0 \\ 1  \text{if } t \ge T_0 \end{cases}
    $$
    其中 $T_0$ 是干预开始的时间点。

*   $P_t$：一个表示干预后时间的连续变量。它在干预前为 $0$，在干预后则等于从干预开始算起的时间。即：
    $$
    P_t = \begin{cases} 0  \text{if } t  T_0 \\ t - T_0  \text{if } t \ge T_0 \end{cases}
    $$

现在，我们来深入理解模型中每个参数（$\beta$系数）的含义。

#### 参数的解释：解码干预效果

通过考察干预前后模型的形式，我们可以清晰地揭示每个参数的特定作用。

**1. 干预前时期 ($t  T_0$)**

在干预实施之前，根据定义，$A_t = 0$ 且 $P_t = 0$。此时，[模型简化](@entry_id:171175)为：

$$
E[Y_t] = \beta_0 + \beta_1 t
$$

在这个简化形式中：
*   $\beta_0$ 代表时间 $t=0$ 时的截距，即研究开始时结果变量的基线水平。
*   $\beta_1$ 代表干预前的**基线趋势（baseline slope）**。它描述了在没有干预的情况下，结果变量随时间变化的平均速率。

**2. 干预后时期 ($t \ge T_0$)**

在干预实施之后，$A_t = 1$ 且 $P_t = t - T_0$。完整的模型表达式为：

$$
E[Y_t] = \beta_0 + \beta_1 t + \beta_2 (1) + \beta_3 (t - T_0)
$$

为了更清晰地看出干预后的截距和斜率，我们可以对上式进行代数重排：

$$
E[Y_t] = (\beta_0 + \beta_2 - \beta_3 T_0) + (\beta_1 + \beta_3) t
$$

从这个重排后的表达式可以看出，干预后的趋势线有了一个新的截距和新的斜率。这引出了我们最关心的两个参数的解释：

*   **$\beta_2$：即时水平变化 (Level Change)**
    $\beta_2$ 代表了干预措施在实施瞬间 ($t=T_0$) 带来的结果变量水平的即刻变化。我们可以通过比较 $t=T_0$ 时刻，干预前趋势的预测值与干预后趋势的起始值来理解这一点。
    - 干预前趋势线在 $t=T_0$ 的预测值（反事实）为：$\beta_0 + \beta_1 T_0$。
    - 干预后趋势线在 $t=T_0$ 的实际值（此时 $A_{T_0}=1, P_{T_0}=0$）为：$\beta_0 + \beta_1 T_0 + \beta_2(1) + \beta_3(0) = \beta_0 + \beta_1 T_0 + \beta_2$。
    - 两者之差即为 $\beta_2$。因此，$\beta_2$ 精确地量化了干预带来的“跳跃”或“跌落”效应。

*   **$\beta_3$：趋势变化 (Slope Change)**
    $\beta_3$ 代表了干预实施后，结果变量随时间变化趋势的改变。
    - 干预前的斜率为 $\beta_1$。
    - 干预后的斜率为 $\beta_1 + \beta_3$。
    - 两者之差即为 $\beta_3$。因此，$\beta_3$ 量化了干预对结果变量长期趋势的持续性影响。一个负的 $\beta_3$ 值意味着干预使得原本上升的趋势变缓，或使得原本下降的趋势变得更陡峭。

在实际应用中，模型通常还会包含其他协变量，例如用于控制季节性波动的变量或已知的随时间变化的其他影响因素。这些变量以加性方式被包含在模型中，以更准确地估计$\beta_2$和$\beta_3$。

### 从关联到因果：关键的识别假设

分段[回归模型](@entry_id:163386)可以出色地描述数据中的关联，但要将参数 $\beta_2$ 和 $\beta_3$ 解释为干预的**因果效应 (causal effects)**，我们必须依赖一个核心的反事实假设，并排除一系列对该假设的潜在威胁。

**核心假设：反事实的延续性**

ITS分析的基石是这样一个假设：**在没有发生干预的情况下，干预前的趋势（由$\beta_0 + \beta_1 t$所刻画）会持续到干预后的时期**。换句话说，这条外推的干预前趋势线代表了我们对反事实结果 $Y_t(0)$（即未接受干预时的结果）的最佳估计。只有当这个假设成立时，我们观测到的干预后实际轨迹与这条反事实轨迹之间的差异（由 $\beta_2$ 和 $\beta_3$ 捕捉）才能被归因于干预本身。

为了让这个核心假设显得合理可信，研究者必须审慎评估并尽可能排除以下几类**效度威胁 (threats to validity)**：

1.  **同期历史事件 (Co-interventions)**：在干预发生的同时（$T_0$时刻），是否发生了其他可能影响结果变量的事件？例如，在城市实施新交通条例的同时，媒体恰好开展了一场大规模的交通安全宣传运动。如果存在这类同期事件，那么观测到的效应可能部分或全部由这些事件导致，而非我们研究的干预。

2.  **预知效应 (Anticipatory Effects)**：公众或目标人群是否在干预正式实施前就预知了其内容，并提前改变了行为？例如，如果公众提前知道将要实施更严格的交通法规，他们可能在法令生效前就开始更谨慎驾驶。这种预知效应会扭曲干预前的基线趋势，导致对干预效果的错误估计。

3.  **测量或群体构成的改变**：结果变量的定义、数据收集方法或研究群体的构成是否在 $T_0$ 时刻发生了突变？例如，如果医院在 $T_0$ 月份更新了伤害事故的记录系统，那么观测到的变化可能只是源于记录方式的改变，而非真实的效应。

4.  **[模型设定错误](@entry_id:170325) (Model Misspecification)**：分段[回归模型](@entry_id:163386)的函数形式（如线性趋势）是否准确地捕捉了数据的潜在模式（underlying pattern）？如果真实的趋势是非线性的，使用[线性模型](@entry_id:178302)可能会产生误导性结果。此外，[时间序列数据](@entry_id:262935)常常存在**[自相关](@entry_id:138991) (autocorrelation)** 问题，即一个时间点的误差项与其前后时间点的误差项相关。在进行[统计推断](@entry_id:172747)时，必须对[自相关](@entry_id:138991)进行检验和校正（例如使用[ARIMA模型](@entry_id:146503)），否则会导致[置信区间](@entry_id:138194)和[p值](@entry_id:136498)不准确。

5.  **稳定单位处理值假设 (Stable Unit Treatment Value Assumption, SUTVA)**：这是因果推断中的一个基本假设，它包含两个方面：一是处理的一致性，即所有单位接受的干预是相同的；二是无干扰，即一个单位是否接受干预不会影响其他单位的结果。在单组ITS分析中（如单个城市），主要需要确保干预的定义是清晰且一致的。

只有在认真排除了上述威胁之后，我们才能更有信心地宣称，分段[回归模型](@entry_id:163386)中估计出的水平变化（$\beta_2$）和趋势变化（$\beta_3$）反映了干预措施的真实因果效应。