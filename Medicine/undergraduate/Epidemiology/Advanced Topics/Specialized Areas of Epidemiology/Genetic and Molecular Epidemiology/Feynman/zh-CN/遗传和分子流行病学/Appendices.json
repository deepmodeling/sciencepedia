{
    "hands_on_practices": [
        {
            "introduction": "哈代-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）是群体遗传学的基石，也是遗传关联研究中一个至关重要的数据质量控制步骤。这项练习  将引导你超越仅仅应用软件工具的层面，通过从第一性原理出发推导精确检验的统计方法。这将巩固你对 HWE 检验 $p$ 值真正含义的理解，以及在何种情况下可以使用近似方法。",
            "id": "4595384",
            "problem": "一个具有等位基因 $A$ 和 $a$ 的双等位基因单核苷酸多态性在一个病例-对照研究中进行了基因分型。在病例组中，观察到的基因型计数为 $(n_{AA}^{\\mathrm{case}}, n_{Aa}^{\\mathrm{case}}, n_{aa}^{\\mathrm{case}}) = (18, 12, 2)$。在对照组中，观察到的基因型计数为 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}}) = (16, 0, 4)$。仅关注对照组，使用孟德尔分离定律和随机交配的第一性原理来构建哈代-温伯格平衡（HWE）的精确检验。按以下步骤进行：\n\n- 从随机交配群体中HWE的定义开始，如果等位基因 $a$ 的群体频率为 $p$，则基因型概率对于 $AA$ 是 $(1-p)^{2}$，对于 $Aa$ 是 $2p(1-p)$，对于 $aa$ 是 $p^{2}$。\n- 在HWE下，将对照组的基因型计数 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}})$ 建模为大小为 $n$ 的多项分布样本。证明通过以对照组中观察到的等位基因 $a$ 的总数为条件，可以消除滋扰参数 $p$，并获得杂合子计数的条件分布。\n- 使用此条件分布，计算精确的双侧 $p$ 值，其定义为所有与观察到的等位基因 $a$ 总数一致且概率小于或等于观察到的对照组构型的所有对照组基因型构型的概率之和。将最终的 $p$ 值表示为小数并四舍五入到三位有效数字。\n\n最后，根据第一性原理和预期基因型计数，论证何时对对照组中HWE检验的大样本卡方（$\\chi^{2}$）近似是有效的，并评估其对于给定对照组计数的有效性。您最终报告的答案应该仅为精确检验的数值 $p$ 值，并按要求四舍五入。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了统计遗传学中的一个标准问题：执行哈代-温伯格平衡（HWE）的精确检验。所有必要的数据和定义都已提供。\n\n该问题要求对对照组进行HWE的精确检验。对照组观察到的基因型计数为 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}}) = (16, 0, 4)$。\n\n对照组样本中的个体总数为 $n = n_{AA}^{\\mathrm{ctrl}} + n_{Aa}^{\\mathrm{ctrl}} + n_{aa}^{\\mathrm{ctrl}} = 16 + 0 + 4 = 20$。\n\n在HWE的原假设下，对于一个等位基因 $A$ 和 $a$ 的频率分别为 $p_A$ 和 $p_a$（$p_A + p_a = 1$）的群体，基因型频率由 $P(AA) = p_A^2$, $P(Aa) = 2p_A p_a$ 和 $P(aa) = p_a^2$ 给出。问题将等位基因 $a$ 的频率定义为 $p_a = p$，因此频率为 $P(AA) = (1-p)^2$, $P(Aa) = 2p(1-p)$ 和 $P(aa) = p^2$。\n\n大小为 $n$ 的样本中的基因型计数 $(N_{AA}, N_{Aa}, N_{aa})$ 被建模为从一个多项分布中抽取。观察到一组特定计数 $(n_{AA}, n_{Aa}, n_{aa})$ 的概率为：\n$$ P(N_{AA}=n_{AA}, N_{Aa}=n_{Aa}, N_{aa}=n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} [P(AA)]^{n_{AA}} [P(Aa)]^{n_{Aa}} [P(aa)]^{n_{aa}} $$\n代入HWE概率，我们得到未知参数 $p$ 的似然函数：\n$$ L(p; n_{AA}, n_{Aa}, n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} ((1-p)^2)^{n_{AA}} (2p(1-p))^{n_{Aa}} (p^2)^{n_{aa}} $$\n$$ L(p) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} (1-p)^{2n_{AA}+n_{Aa}} p^{n_{Aa}+2n_{aa}} $$\n设 $N_a$ 为样本中等位基因 $a$ 的总计数，其中 $N_a = n_{Aa} + 2n_{aa}$。样本中的等位基因总数为 $2n$。等位基因 $A$ 的计数为 $N_A = 2n_{AA} + n_{Aa} = 2n - N_a$。似然函数可以重写为：\n$$ L(p) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} (1-p)^{2n-N_a} p^{N_a} $$\n根据费希尔-奈曼分解定理，$N_a$ 是滋扰参数 $p$ 的充分统计量。为了创建一个与 $p$ 无关的检验，我们以该充分统计量的观测值为条件。对于给定的对照组数据，等位基因 $a$ 的观测计数为 $N_a^{\\mathrm{obs}} = n_{Aa}^{\\mathrm{ctrl}} + 2n_{aa}^{\\mathrm{ctrl}} = 0 + 2(4) = 8$。\n\n我们需要找到在给定 $n=20$ 和 $N_a=8$ 的条件下基因型计数的条件概率：\n$$ P(N_{AA}=n_{AA}, N_{Aa}=n_{Aa}, N_{aa}=n_{aa} \\mid N_a=8, n=20) $$\n这是观察到特定基因型计数的概率与观察到等位基因总计数 $N_a=8$ 的概率之比。在一个包含 $2n$ 个等位基因的样本中，等位基因 $a$ 的总数服从二项分布 $N_a \\sim \\mathrm{Binomial}(2n, p)$。因此，$P(N_a=k) = \\binom{2n}{k} p^k (1-p)^{2n-k}$。\n条件概率为：\n$$ P(\\text{counts} \\mid N_a=8) = \\frac{P(\\text{counts})}{P(N_a=8)} = \\frac{\\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} p^8 (1-p)^{32}}{\\binom{2n}{8} p^8 (1-p)^{32}} = \\frac{n! 2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}! \\binom{2n}{8}} $$\n这个概率与 $p$ 无关。给定 $n=20$ 和 $N_a=8$，基因型计数受到以下约束：\n$n_{AA} + n_{Aa} + n_{aa} = 20$\n$2n_{AA} + n_{Aa} = 2(20) - 8 = 32$\n$n_{Aa} + 2n_{aa} = 8$\n\n从这些约束中，我们可以用 $n_{Aa}$ 来表示 $n_{AA}$ 和 $n_{aa}$：\n$n_{aa} = (8 - n_{Aa})/2$\n$n_{AA} = (32 - n_{Aa})/2$\n为了使 $n_{AA}$ 和 $n_{aa}$ 为整数，$n_{Aa}$ 必须是偶数。此外，所有计数都必须为非负数，所以 $n_{Aa} \\ge 0$, $8 - n_{Aa} \\ge 0 \\implies n_{Aa} \\le 8$。\n因此，杂合子计数 $n_{Aa}$ 的可能值为 $\\{0, 2, 4, 6, 8\\}$。\n\n双侧精确 $p$ 值是所有可能的基因型构型（对于固定的 $N_a=8, n=20$）中，其概率小于或等于观察到的构型 $(16, 0, 4)$ 的概率之和。观察到的构型对应于 $n_{Aa}=0$。\n\n令 $f(k)$ 为概率中与 $n_{Aa}=k$ 的构型成正比的项：\n$f(n_{Aa}) = \\frac{2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}!}$。条件概率为 $P(n_{Aa}=k) = \\frac{n!}{\\binom{2n}{N_a}} f(k)$。\n我们计算 $k \\in \\{0, 2, 4, 6, 8\\}$ 时 $f(k)$ 的相对值。\n可能的构型 $(n_{AA}, n_{Aa}, n_{aa})$ 是：\n- $n_{Aa} = 0$: $(16, 0, 4)$ (观察值)\n- $n_{Aa} = 2$: $(15, 2, 3)$\n- $n_{Aa} = 4$: $(14, 4, 2)$\n- $n_{Aa} = 6$: $(13, 6, 1)$\n- $n_{Aa} = 8$: $(12, 8, 0)$\n\n让我们计算概率的比率：\n$\\frac{P(n_{Aa}=2)}{P(n_{Aa}=0)} = \\frac{f(2)}{f(0)} = \\frac{2^2/(15!2!3!)}{2^0/(16!0!4!)} = \\frac{4 \\cdot 16! \\cdot 4!}{15! \\cdot 2! \\cdot 3!} = 4 \\cdot 16 \\cdot \\frac{24}{12} = 128$。\n$\\frac{P(n_{Aa}=4)}{P(n_{Aa}=2)} = \\frac{f(4)}{f(2)} = \\frac{2^4/(14!4!2!)}{2^2/(15!2!3!)} = \\frac{4 \\cdot 15! \\cdot 2! \\cdot 3!}{14! \\cdot 4! \\cdot 2!} = 4 \\cdot 15 \\cdot \\frac{6}{24} = 15$。\n$\\frac{P(n_{Aa}=6)}{P(n_{Aa}=4)} = \\frac{f(6)}{f(4)} = \\frac{2^6/(13!6!1!)}{2^4/(14!4!2!)} = \\frac{4 \\cdot 14! \\cdot 4! \\cdot 2!}{13! \\cdot 6!} = 4 \\cdot 14 \\cdot \\frac{48}{720} = \\frac{56}{15}$。\n$\\frac{P(n_{Aa}=8)}{P(n_{Aa}=6)} = \\frac{f(8)}{f(6)} = \\frac{2^8/(12!8!0!)}{2^6/(13!6!1!)} = \\frac{4 \\cdot 13! \\cdot 6!}{12! \\cdot 8!} = 4 \\cdot 13 \\cdot \\frac{1}{8 \\cdot 7} = \\frac{13}{14}$。\n\n这些比率表明 $P(n_{Aa}=0)  P(n_{Aa}=2)  P(n_{Aa}=4)  P(n_{Aa}=6)$，且 $P(n_{Aa}=8)  P(n_{Aa}=6)$。全面比较显示，$P(n_{Aa}=0)$ 是所有可能构型中概率最小的。\n因此，概率小于或等于观察构型的唯一构型就是观察到的构型本身。$p$ 值是观察到 $n_{Aa}=0$ 的条件概率。\n$$p\\text{-value} = P(n_{Aa}=0 \\mid N_a=8) = \\frac{f(0)}{\\sum_{k \\in \\{0,2,4,6,8\\}} f(k)}$$\n令 $f(0)=1$（作为参考单位）。其他值为：\n$f(2) = \\frac{P(n_{Aa}=2)}{P(n_{Aa}=0)} f(0) = 128 \\cdot f(0)$。\n$f(4) = \\frac{P(n_{Aa}=4)}{P(n_{Aa}=2)} f(2) = 15 \\cdot 128 \\cdot f(0) = 1920 \\cdot f(0)$。\n$f(6) = \\frac{P(n_{Aa}=6)}{P(n_{Aa}=4)} f(4) = \\frac{56}{15} \\cdot 1920 \\cdot f(0) = 56 \\cdot 128 \\cdot f(0) = 7168 \\cdot f(0)$。\n$f(8) = \\frac{P(n_{Aa}=8)}{P(n_{Aa}=6)} f(6) = \\frac{13}{14} \\cdot 7168 \\cdot f(0) = 13 \\cdot 512 \\cdot f(0) = 6656 \\cdot f(0)$。\n\n相对概率的总和是：\n$\\sum f(k) = (1 + 128 + 1920 + 7168 + 6656) \\cdot f(0) = 15873 \\cdot f(0)$。\n$p$ 值为：\n$$ p\\text{-value} = \\frac{f(0)}{15873 \\cdot f(0)} = \\frac{1}{15873} \\approx 0.00006299943... $$\n四舍五入到三位有效数字，$p$ 值为 $0.0000630$。\n\n最后，我们评估大样本卡方（$\\chi^2$）近似的有效性。HWE 的 $\\chi^2$ 检验统计量 $\\sum (O-E)^2/E$ 近似服从自由度为 1 的 $\\chi^2$ 分布。这种近似基于对基因型计数多项分布的正态近似。这种近似的有效性根本上要求每个单元（基因型）的期望计数不能太小。一个被广泛接受的准则是，所有期望计数应至少为 $5$。\n\n为了计算对照组的期望计数，我们首先从样本数据中估计等位基因频率 $p$。最大似然估计是样本等位基因频率：\n$$\\hat{p} = \\frac{n_{Aa}^{\\mathrm{ctrl}} + 2n_{aa}^{\\mathrm{ctrl}}}{2n} = \\frac{0 + 2(4)}{2(20)} = \\frac{8}{40} = 0.2$$\nHWE下的期望基因型计数为：\n$E_{AA} = n(1-\\hat{p})^2 = 20(0.8)^2 = 20(0.64) = 12.8$\n$E_{Aa} = n(2\\hat{p}(1-\\hat{p})) = 20(2 \\cdot 0.2 \\cdot 0.8) = 20(0.32) = 6.4$\n$E_{aa} = n(\\hat{p}^2) = 20(0.2)^2 = 20(0.04) = 0.8$\n\n$aa$ 基因型的期望计数是 $E_{aa} = 0.8$，这远低于常规的阈值 $5$。因为其中一个期望计数非常小，所以不满足 $\\chi^2$ 近似的理论条件。因此，大样本 $\\chi^2$ 检验对该数据集无效，使用精确检验是必要且合适的。",
            "answer": "$$\\boxed{6.30 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在进行全基因组关联研究（GWAS）后，我们常常观察到整个基因组的关联检验统计量存在“膨胀”（inflation）现象，即其数值普遍高于随机预期的水平。这项练习  介绍了一种经典方法——基因组控制（Genomic Control），用于量化和校正这种膨胀。你将推导出膨胀因子 $\\lambda$ 的调整方法，并批判性地评估该方法的核心假设，即膨胀是由混杂因素而非真实的“多基因性”（polygenicity）引起的。",
            "id": "4595350",
            "problem": "一项全基因组关联研究 (GWAS) 使用标准分数检验来评估单核苷酸多态性 (SNP) 与某一数量性状的关联。在无关联的原假设下，每个SNP的检验统计量被假定服从自由度为1的卡方分布，记为 $\\chi^{2}_{1}$。隐性群体结构和亲缘关系可能导致所有检验统计量发生均匀乘性膨胀，从而偏离其零分布。基因组控制 (GC) 方法使用GC因子 $\\lambda$ 来刻画这种膨胀，$\\lambda$ 定义为观测到的全基因组检验统计量的经验中位数与 $\\chi^{2}_{1}$ 分布中位数的比值。设 $m_{0}$ 表示 $\\chi^{2}_{1}$ 分布的中位数。\n\n假设膨胀机制是将每个零检验统计量乘以一个共同的因子，并且 $\\lambda$ 通过中位数的比值一致地估计了这个因子。严格地从这些定义和零分布假设出发，推导一个校正后的单位点检验统计量 $T^{\\mathrm{GC}}$ 的表达式，该表达式能将全基因组中位数恢复到 $m_{0}$。\n\n然后，考虑一个目标SNP，其观测到的卡方统计量为 $T_{\\mathrm{obs}} = 9.84$，以及从汇总统计数据中估计出的全研究GC因子 $\\lambda = 1.23$。使用你推导的表达式，计算此SNP的校正后卡方值 $T^{\\mathrm{GC}}$。将你的最终数值答案四舍五入到四位有效数字。\n\n在你的推导中，请清楚说明GC校正I类错误膨胀所依据的假设，并解释这种校正何时可能会削弱由广泛多基因性而非混杂引起的真实信号。你最终报告的量必须是目标SNP的单个校正值。",
            "solution": "问题要求推导基因组控制 (GC) 校正检验统计量 $T^{\\mathrm{GC}}$，并为一个特定的单核苷酸多态性 (SNP) 计算其值。推导过程必须基于所提供的定义。\n\n设 $T$ 代表来自全基因组关联研究 (GWAS) 的一个检验统计量。在给定SNP与性状无关联的原假设 ($H_0$) 下，该检验统计量被假定服从自由度为1的中心卡方分布，记为 $\\chi^{2}_{1}$。设 $m_0$ 是这个理论零分布的中位数。具体来说，对于 $\\chi^{2}_{1}$ 分布，其累积分布函数 (CDF) 为 $F(x) = P(X \\le x) = \\text{erf}(\\sqrt{x/2})$。中位数 $m_0$ 是满足 $F(m_0) = 0.5$ 的值。这得到 $\\text{erf}(\\sqrt{m_0/2}) = 0.5$，解得 $m_0 = 2(\\text{erf}^{-1}(0.5))^2 \\approx 0.454937$。\n\n问题陈述了隐性群体结构导致检验统计量的均匀乘性膨胀。设 $T_{\\text{null}}$ 是一个随机变量，代表一个正确服从 $\\chi^{2}_{1}$ 分布的检验统计量。观测到的、膨胀的检验统计量 $T_{\\text{obs}}$ 被建模为乘以一个共同的膨胀因子 $c$。\n$$T_{\\text{obs}} = c \\cdot T_{\\text{null}}$$\n该模型假设，对于基因组中所有真正为空的SNP，这个膨胀因子 $c$ 是恒定的。\n\n基因组控制因子 $\\lambda$ 被定义为观测到的全基因组检验统计量的经验中位数（我们记为 $\\text{median}(T_{\\text{obs}})$）与零分布的理论中位数 $m_0$ 的比值。\n$$\\lambda = \\frac{\\text{median}(T_{\\text{obs}})}{m_0}$$\nGWAS中的一个关键假设是，绝大多数被测试的SNP与性状无关，即它们是真正的零假设SNP。因此，所有观测统计量的经验中位数主要由这些零假设SNP的分布决定。在这个假设下，我们可以将经验中位数近似为：\n$$\\text{median}(T_{\\text{obs}}) \\approx \\text{median}(c \\cdot T_{\\text{null}})$$\n中位数的一个基本性质是，对于任何正常数 $k$ 和随机变量 $X$，都有 $\\text{median}(kX) = k \\cdot \\text{median}(X)$。应用此性质，我们得到：\n$$\\text{median}(T_{\\text{obs}}) \\approx c \\cdot \\text{median}(T_{\\text{null}})$$\n由于 $T_{\\text{null}}$ 服从 $\\chi^{2}_{1}$ 分布，其中位数为 $m_0$。因此：\n$$\\text{median}(T_{\\text{obs}}) \\approx c \\cdot m_0$$\n将此代入 $\\lambda$ 的定义中：\n$$\\lambda \\approx \\frac{c \\cdot m_0}{m_0} = c$$\n这表明GC因子 $\\lambda$ 是均匀乘性膨胀因子 $c$ 的一个估计量。问题中提到 $\\lambda$ 一致地估计了这个因子，这验证了我们的推导。\n\n目标是定义一个校正后的检验统计量 $T^{\\mathrm{GC}}$，它能校正这种膨胀，从而将其在原假设下的分布恢复到理论的 $\\chi^{2}_{1}$ 分布。为了逆转因子 $\\lambda$ 带来的乘性膨胀，我们必须将观测到的检验统计量除以 $\\lambda$。对于任何给定的、具有观测统计量 $T_{\\text{obs}}$ 的SNP，GC校正后的统计量 $T^{\\mathrm{GC}}$ 是：\n$$T^{\\mathrm{GC}} = \\frac{T_{\\text{obs}}}{\\lambda}$$\n为了验证此校正将全基因组中位数恢复到 $m_0$，我们考虑校正后统计量的中位数：\n$$\\text{median}(T^{\\mathrm{GC}}) = \\text{median}\\left(\\frac{T_{\\text{obs}}}{\\lambda}\\right) = \\frac{1}{\\lambda} \\text{median}(T_{\\text{obs}})$$\n根据 $\\lambda$ 的定义，我们有 $\\text{median}(T_{\\text{obs}}) = \\lambda \\cdot m_0$。代入此式可得：\n$$\\text{median}(T^{\\mathrm{GC}}) = \\frac{1}{\\lambda} (\\lambda \\cdot m_0) = m_0$$\n这证实了所提出的校正方法能正确地将检验统计量的中位数缩放回其在原假设下的期望值。\n\n基因组控制作为一种有效的I类错误控制方法，其基本假设是检验统计量的膨胀（即 $\\lambda > 1$）完全是由系统性偏差（如群体分层和隐性亲缘关系）引起的，而不是由真实的生物学效应引起的。这假设了一种“稀疏效应”遗传结构，即绝大多数SNP对性状没有影响。当这些条件成立时，除以 $\\lambda$ 可以正确校正零假设SNP的P值，并防止过多的假阳性。\n\n然而，在不同的遗传结构下，这种校正可能会削弱真实信号。对于一个高度多基因性的性状，即基因组中有大量变异具有微小但真实的影响，原假设对于很大一部分SNP来说在技术上是错误的。这些众多微小、真实关联的累积效应将导致检验统计量的分布偏离理论零分布，从而产生一个大于1的膨胀因子 $\\lambda > 1$。在这种情况下，膨胀因子 $\\lambda$ 不仅捕捉了来自群体结构的偏差，还包含了来自真实的、广泛的多基因性的一个分量。应用标准的GC校正 $T^{\\mathrm{GC}} = T_{\\text{obs}}/\\lambda$ 会不恰当地将由多基因性引起的那部分膨胀当作偏差来处理。这种过度校正会缩减所有的检验统计量，包括那些真正关联的SNP，从而降低统计功效，使检测真实关联变得更加困难。这一局限性促使了更先进方法的发展，例如LD分数回归，该方法可以区分来自混杂的膨胀和来自多基因性的膨胀。\n\n现在，我们将推导出的公式应用于目标SNP。给定值为：\n观测到的卡方统计量，$T_{\\mathrm{obs}} = 9.84$。\n全研究GC因子，$\\lambda = 1.23$。\n\n校正后的卡方值 $T^{\\mathrm{GC}}$ 计算如下：\n$$T^{\\mathrm{GC}} = \\frac{T_{\\mathrm{obs}}}{\\lambda} = \\frac{9.84}{1.23}$$\n$$T^{\\mathrm{GC}} = 8$$\n问题要求最终答案四舍五入到四位有效数字。\n$$T^{\\mathrm{GC}} = 8.000$$",
            "answer": "$$\n\\boxed{8.000}\n$$"
        },
        {
            "introduction": "基于基因组控制方法的局限性，最后一项练习  将探讨一种更现代的技术——连锁不平衡分数回归（LD Score Regression, LDSC）。这种强大的方法利用全基因组的连锁不平衡（LD）模式，来区分由群体结构等混杂因素引起的统计量膨胀和由真实、广泛存在的多基因效应引起的膨胀。通过理解其内在逻辑，你将学会如何直接从 GWAS 的汇总统计数据中估算由 SNP 解释的遗传力以及混杂因素的程度。",
            "id": "4595371",
            "problem": "在一同质人群中，对一复杂性状进行了一项全基因组关联研究（GWAS），该研究使用了经过标准质量控制的单核苷酸多态性（SNPs），产生了 $M$ 个独立的 SNP 水平关联检验。样本量为 $N$。SNP $j$ 的关联检验统计量是一个自由度为1的卡方统计量，记为 $\\chi_{j}^{2}$，由标准化的基因型和表型计算得出。分位数-分位数（Q-Q）图显示出检验统计量偏离了零假设基线，这与检验统计量的膨胀现象一致。为了区分这种膨胀是由真实的多基因性还是由混杂因素（例如，群体分层或隐性亲缘关系）引起的，你需要从多基因模型和连锁不平衡（LD）性质的基本原理出发进行推理，然后使用 LD 分数回归（LDSC）。\n\n使用以下基本依据：\n- 在无关联且无混杂因素的原假设下，自由度为1的卡方统计量的期望值为 $1$。\n- 在一个包含许多微小独立 SNP 效应和标准化输入的多基因加性模型下，由 SNP $j$ 标记的表型预期方差随其 LD 分数 $l_{j}$ 的增加而增加，其中 LD 分数定义为 SNP $j$ 与该区域内其他 SNP 相关系数的平方和。这导致了 $\\chi_{j}^{2}$ 的非中心性期望随 $l_{j}$ 的增加而增加。\n- 对所有 SNP 影响近似均匀的混杂因素，会对 $\\chi_{j}^{2}$ 的期望值产生一个不依赖于 $l_{j}$ 的加性膨胀。\n\n从这些基础出发，推导 $\\chi_{j}^{2}$ 期望值的线性分解，将其分解为一个基线、一个由多基因性引起的与 $l_{j}$ 成正比的分量，以及一个由混杂因素引起的与 $l_{j}$ 无关的分量。证明对所有 SNP 进行 $\\chi_{j}^{2}$ 对 $l_{j}$ 的普通最小二乘（OLS）回归，所估计的斜率捕捉了每单位 LD 分数的多基因贡献，而截距则捕捉了基线加混杂因素。然后，利用提供的全基因组汇总样本矩，计算 LDSC 截距和斜率，并根据 SNP 遗传力解释斜率，以及根据可归因于混杂因素的观测膨胀比例解释截距：\n\n- SNP 数量：$M = 1{,}000{,}000$。\n- 样本量：$N = 200{,}000$。\n- LD 分数的样本均值：$\\bar{l} = 85$。\n- LD 分数的样本方差：$\\operatorname{Var}(l) = 65$。\n- LD 分数与卡方统计量之间的样本协方差：$\\operatorname{Cov}(l, \\chi^{2}) = 0.39$。\n- 卡方统计量的样本均值：$\\overline{\\chi^{2}} = 1.56$。\n\n按如下方式定义你的估计值：\n- OLS 斜率 $\\hat{b}$ 估计了由于多基因性，每单位 LD 分数引起的 $\\chi^{2}$ 期望值的增加量。\n- OLS 截距 $\\hat{a}$ 估计了在 $l_{j} = 0$ 时 $\\chi^{2}$ 期望值的基线加混杂因素分量。\n- 假设采用标准 LDSC 识别方法，将斜率解释为 $\\hat{b} \\approx N h^{2} / M$ 以估计 SNP 遗传力 $h^{2}$。\n- 将截距解释为 $\\hat{a} \\approx 1 +$ 混杂因素，并计算观测到的膨胀中可归因于混杂因素的比例，其公式为 $(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。\n\n将你的答案四舍五入至四位有效数字。将最终结果表示为一个行矩阵，其条目按顺序为：LDSC 截距 $\\hat{a}$、LDSC 斜率 $\\hat{b}$、SNP 遗传力估计值 $\\hat{h}^{2}$，以及可归因于混杂因素的观测膨胀比例 $(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。不需要物理单位。",
            "solution": "用户提供了一个遗传流行病学问题，涉及使用 LD 分数回归（LDSC）解释全基因组关联研究（GWAS）的结果。该问题要求推导 LDSC 背后的基本线性关系，然后将其应用于一组给定的汇总统计数据以估计关键参数。\n\n### 步骤1：问题验证\n\n首先，我将提取已知条件并验证问题陈述。\n\n**已知条件：**\n- 独立 SNP 数量：$M = 1{,}000{,}000$\n- 样本量：$N = 200{,}000$\n- SNP $j$ 的关联检验统计量：$\\chi_{j}^{2}$，一个自由度为1的卡方统计量。\n- SNP $j$ 的 LD 分数：$l_{j} = \\sum_{k} r_{jk}^{2}$，其中 $r_{jk}$ 是 SNP $j$ 和 SNP $k$ 之间的相关系数。\n- 基本依据：\n    1. 在无遗传关联且无混杂因素的原假设下，检验统计量的期望值为 $E[\\chi_{j}^{2}] = 1$。\n    2. 在多基因加性模型下，$\\chi_{j}^{2}$ 的期望非中心性随 LD 分数 $l_{j}$ 成比例增加。\n    3. 混杂因素对 $\\chi_{j}^{2}$ 的期望值产生一个与 $l_{j}$ 无关的加性膨胀。\n- 全基因组汇总样本矩：\n    - LD 分数的样本均值：$\\bar{l} = 85$\n    - LD 分数的样本方差：$\\operatorname{Var}(l) = 65$\n    - LD 分数与卡方统计量之间的样本协方差：$\\operatorname{Cov}(l, \\chi^{2}) = 0.39$\n    - 卡方统计量的样本均值：$\\overline{\\chi^{2}} = 1.56$\n- 要求的计算与解释：\n    - 从 $\\chi^{2}$ 对 $l$ 的回归中得到的 OLS 斜率 $\\hat{b}$ 和截距 $\\hat{a}$。\n    - 使用关系式 $\\hat{b} \\approx N h^{2} / M$ 估计 SNP 遗传力 $\\hat{h}^{2}$。\n    - 可归因于混杂因素的观测膨胀比例：$(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。\n    - 最终答案需四舍五入至四位有效数字。\n\n**验证：**\n- **科学依据：** 该问题坚实地基于连锁不平衡（LD）分数回归的既定原则，这是一种遗传流行病学中标准且广泛使用的统计方法。对多基因性、混杂因素、LD 分数及其与 GWAS 卡方统计量关系的描述是正确的，反映了该方法的基础理论。\n- **适定性：** 该问题是适定的。它要求推导一个线性模型并使用普通最小二乘法（OLS）估计其参数。它精确地提供了计算 OLS 斜率和截距所需的样本矩（$\\operatorname{Cov}(l, \\chi^2)$、$\\operatorname{Var}(l)$、$\\bar{l}$、$\\overline{\\chi^2}$）。后续解释所需的所有常数（$N$、$M$）也都已提供。存在唯一解。\n- **客观性：** 问题以精确、客观、技术性的语言陈述，没有歧义或主观性断言。\n\n**结论：**\n该问题有效。它在科学上是合理的，适定的，客观的，并且包含了完整解答所需的所有信息。我将继续进行推导和计算。\n\n### 步驟2：推導與求解\n\n**LD 分数回归模型的推导**\n\n问题要求推导期望 $\\chi_{j}^{2}$ 统计量的线性分解。我们从提供的基本依据开始。\n\n1.  **基线：** 在没有任何遗传效应或混杂因素的情况下，一个自由度为1的卡方检验统计量的期望均值为 $1$。这为我们的模型建立了基线：$E[\\chi_{j}^{2}]_{\\text{null}} = 1$。\n\n2.  **多基因性：** 问题指出，在多基因模型下，$\\chi_{j}^{2}$ 的期望非中心性随其 LD 分数 $l_{j}$ 的增加而增加。让我们将其形式化。对于 SNP $j$，其通过对标准化基因型 $G_j$ 和表型 $Y$ 进行简单线性回归得到的 $\\chi_{j}^{2}$ 统计量约等于 $N \\hat{\\beta}_{j, \\text{marginal}}^{2}$，其中 $\\hat{\\beta}_{j, \\text{marginal}}$ 是估计的边际效应大小。该统计量的期望值约为 $1 + N E[\\hat{\\beta}_{j, \\text{marginal}}^{2}]$。SNP $j$ 的边际效应捕捉了其自身的因果效应 $\\beta_j$，以及所有与其处于连锁不平衡状态的其他 SNP ($k$) 的效应，并由相关系数 $r_{jk}$ 加权：$\\beta_{j, \\text{marginal}} \\approx \\sum_{k} r_{jk} \\beta_k$。期望的平方边际效应为 $E[\\beta_{j, \\text{marginal}}^{2}] = E[(\\sum_{k} r_{jk} \\beta_k)^2]$。假设因果效应 $\\beta_k$ 相互独立，均值为 $0$，方差为 $h^2/M$（其中 $h^2$ 是分布在 $M$ 个因果 SNP 上的总 SNP 遗传力），则上式可简化为 $E[\\beta_{j, \\text{marginal}}^{2}] = \\sum_{k} r_{jk}^{2} E[\\beta_k^2] = (\\sum_{k} r_{jk}^{2}) \\frac{h^2}{M} = l_j \\frac{h^2}{M}$。因此，由多基因性对期望卡方统计量的贡献为 $N l_j \\frac{h^2}{M}$。\n\n3.  **混杂因素：** 问题指出，混杂因素（例如，群体分层或隐性亲缘关系）会增加一个不依赖于 LD 分数 $l_j$ 的恒定膨胀项 $C$。该项对所有 SNP 的影响近似相等。\n\n结合这三个分量，我们得到 SNP $j$ 的卡方统计量期望值的线性模型：\n$$E[\\chi_{j}^{2}] = 1 + N \\frac{h^{2}}{M} l_{j} + C$$\n该方程是一个形如 $E[Y_j] = a + b X_j$ 的线性模型，其中因变量是 $Y_j = \\chi_j^2$，自变量是 $X_j = l_j$。模型参数为：\n-   **斜率：** $b = \\frac{N h^{2}}{M}$。该项量化了多基因性的贡献。更高的 LD 分数 $l_j$ 意味着该 SNP 标记了更多的遗传变异，从而导致更强的预期关联信号。\n-   **截距：** $a = 1 + C$。该项捕捉了基线期望值 $1$ 以及由混杂因素引起的任何膨胀 $C$。\n\n**使用普通最小二乘法（OLS）进行估计**\n\n我们需要对所有 $M$ 个 SNP 进行 $\\chi_j^2$ 对 $l_j$ 的回归拟合：\n$$ \\chi_{j}^{2} = a + b l_{j} + \\epsilon_{j} $$\n斜率（$\\hat{b}$）和截距（$\\hat{a}$）的 OLS 估计量由样本矩计算得出。斜率估计量的公式为：\n$$ \\hat{b} = \\frac{\\operatorname{Cov}(l, \\chi^{2})}{\\operatorname{Var}(l)} $$\n截距估计量的公式为：\n$$ \\hat{a} = \\overline{\\chi^{2}} - \\hat{b} \\bar{l} $$\n这些估计量提供了对真实斜率 $b$ 和截距 $a$ 的估计。\n\n**数值计算**\n\n使用提供的样本矩：\n- $\\operatorname{Cov}(l, \\chi^{2}) = 0.39$\n- $\\operatorname{Var}(l) = 65$\n- $\\overline{\\chi^{2}} = 1.56$\n- $\\bar{l} = 85$\n\n首先，我们计算 OLS 斜率 $\\hat{b}$：\n$$ \\hat{b} = \\frac{0.39}{65} = 0.006 $$\n\n接着，我们计算 OLS 截距 $\\hat{a}$：\n$$ \\hat{a} = 1.56 - (0.006 \\times 85) = 1.56 - 0.51 = 1.05 $$\n\n按要求四舍五入至四位有效数字：\n- $\\hat{b} = 0.006000$\n- $\\hat{a} = 1.050$\n\n**解释与最终计算**\n\n1.  **SNP 遗传力 ($h^2$)**：\n    我们使用关系式 $\\hat{b} \\approx \\frac{N h^{2}}{M}$ 来估计 $h^2$。\n    $$ \\hat{h}^{2} = \\frac{M \\hat{b}}{N} $$\n    代入 $M$、$N$ 和我们估计的 $\\hat{b}$ 的值：\n    $$ \\hat{h}^{2} = \\frac{1{,}000{,}000 \\times 0.006}{200{,}000} = \\frac{6000}{200000} = \\frac{6}{200} = 0.03 $$\n    四舍五入至四位有效数字，$\\hat{h}^2 = 0.03000$。\n\n2.  **来自混杂因素的膨胀比例**：\n    平均检验统计量的总观测膨胀为 $\\overline{\\chi^{2}} - 1 = 1.56 - 1 = 0.56$。\n    截距 $\\hat{a}$ 是 $1 + C$ 的估计值，其中 $C$ 是由混杂因素引起的膨胀。因此，可归因于混杂因素的膨胀部分由 $\\hat{a} - 1$ 估计。\n    $$ \\text{混杂膨胀} = \\hat{a} - 1 = 1.050 - 1 = 0.050 $$\n    总观测膨胀中由混杂因素导致的部分所占的比例为：\n    $$ \\frac{\\hat{a} - 1}{\\overline{\\chi^{2}} - 1} = \\frac{0.050}{0.56} \\approx 0.0892857... $$\n    四舍五入至四位有效数字，此比例为 $0.08929$。\n\n此分析表明，检验统计量中观测到的膨胀（$\\overline{\\chi^2}=1.56$）绝大部分是由真实的多基因信号而非混杂因素造成的。具体而言，$1.050$ 的截距表明混杂水平适中，而非零的斜率 $0.006000$ 为多基因架构提供了强有力的证据，得出的 SNP 遗传力估计值为 $3\\%$。\n\n**结果总结：**\n- LDSC 截距 $\\hat{a} = 1.050$\n- LDSC 斜率 $\\hat{b} = 0.006000$\n- SNP 遗传力估计值 $\\hat{h}^2 = 0.03000$\n- 来自混杂因素的膨胀比例 = $0.08929$\n\n这些值将被放入一个行矩阵中作为最终答案。",
            "answer": "$$\n\\boxed{ \\begin{pmatrix} 1.050  0.006000  0.03000  0.08929 \\end{pmatrix} }\n$$"
        }
    ]
}