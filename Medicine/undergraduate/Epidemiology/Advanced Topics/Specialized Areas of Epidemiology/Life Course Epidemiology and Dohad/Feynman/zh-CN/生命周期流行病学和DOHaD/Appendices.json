{
    "hands_on_practices": [
        {
            "introduction": "在生命历程流行病学中，早期暴露对健康的影响通常不是一成不变的。这种影响的强度或方向可能取决于其他因素，这一现象被称为效应量修饰。本练习将通过一个交互项的实例，向您展示如何在回归模型中量化和解释这种复杂的关联，从而更深入地理解暴露如何发挥作用 。",
            "id": "4607085",
            "problem": "一项针对$3{,}000$名30岁成年人的队列研究，旨在探讨胎儿生长与成年人收缩压之间的关系，其研究动机源于“健康与疾病的发育起源”（DOHaD）假说。出生体重 $B$ 在分娩时记录，并以100克为单位进行换算，因此 $B$ 每增加一个单位，对应于出生体重增加100克。胎龄 $G$ 以周为单位记录，并以40周为中心（即 $G$ 表示与40周相差的周数）。成年人收缩压 $Y$ 通过线性回归模型进行建模，模型中包含出生体重和胎龄之间的交互作用，并对孕期母体吸烟 $S$（二元变量，0代表否，1代表是）和子代性别 $M$（二元变量，0代表女性，1代表男性）进行了调整：\n$$\n\\mathbb{E}[Y \\mid B,G,S,M] \\;=\\; \\beta_{0} \\;+\\; \\beta_{B}\\,B \\;+\\; \\beta_{G}\\,G \\;+\\; \\beta_{BG}\\,B\\,G \\;+\\; \\gamma_{S}\\,S \\;+\\; \\gamma_{M}\\,M.\n$$\n假设拟合系数为 $ \\beta_{0} = 112.0$，$ \\beta_{B} = -0.36$，$ \\beta_{G} = 0.50$，$ \\beta_{BG} = -0.08$，$ \\gamma_{S} = 2.5$，$ \\gamma_{M} = -3.1$。对于本问题，请仅关注暴露变量 $B$ 和 $G$ 及其交互项。\n\n根据线性模型中效应度量修饰的基本原理，推导在给定胎龄 $g$（与40周相差的周数）下，$B$ 每增加一个单位（即出生体重增加100克）的条件效应表达式，然后计算在 $g=-3$（对应于37周）和 $g=1$（对应于41周）时的分层效应。最后，计算这些分层效应的差异（由胎龄引起的效应度量修饰，此处定义为41周时的效应减去37周时的效应），并将此差异报告为单个数值。\n\n所有效应均以毫米汞柱每100克（$\\mathrm{mmHg}$ 每 $100$ g）为单位表示。将您的最终数值答案四舍五入到三位有效数字。最终答案必须仅为该差异的单个数值。",
            "solution": "在线性回归中，当结局变量相对于某个暴露变量的期望变化取决于另一个变量的水平时，就会出现带有交互项的效应度量修饰。在给定模型中，\n$$\n\\mathbb{E}[Y \\mid B,G,S,M] \\;=\\; \\beta_{0} \\;+\\; \\beta_{B}\\,B \\;+\\; \\beta_{G}\\,G \\;+\\; \\beta_{BG}\\,B\\,G \\;+\\; \\gamma_{S}\\,S \\;+\\; \\gamma_{M}\\,M,\n$$\n交互项 $\\beta_{BG}\\,B\\,G$ 使得 $B$ 对 $Y$ 的效应可以随 $G$ 的变化而变化。\n\n根据线性模型的定义，$B$ 每增加一个单位在固定胎龄 $g$ 时的条件效应是条件期望对 $B$ 的偏导数，同时保持 $G=g$（以及其他协变量固定）：\n$$\n\\frac{\\partial}{\\partial B}\\,\\mathbb{E}[Y \\mid B,G,S,M] \\bigg|_{G=g} \\;=\\; \\beta_{B} \\;+\\; \\beta_{BG}\\,g.\n$$\n此表达式表明，出生体重的效应受胎龄修饰，其修饰量由 $\\beta_{BG}$ 量化。\n\n我们现在使用给定的系数计算在指定胎龄下的分层效应。\n\n当 $g=-3$ 时（由于 $G$ 是以40周为中心，这对应于37周）：\n$$\n\\text{在 }g=-3 \\text{ 时的效应} \\;=\\; \\beta_{B} + \\beta_{BG}(-3) \\;=\\; (-0.36) + (-0.08)(-3) \\;=\\; -0.36 + 0.24 \\;=\\; -0.12.\n$$\n因此，在37周时，出生体重每增加100克，与收缩压 $-0.12$ $\\mathrm{mmHg}$ 的变化相关。\n\n当 $g=1$ 时（对应于41周）：\n$$\n\\text{在 }g=1 \\text{ 时的效应} \\;=\\; \\beta_{B} + \\beta_{BG}(1) \\;=\\; (-0.36) + (-0.08)(1) \\;=\\; -0.36 - 0.08 \\;=\\; -0.44.\n$$\n因此，在41周时，出生体重每增加100克，与收缩压 $-0.44$ $\\mathrm{mmHg}$ 的变化相关。\n\n由胎龄引起的效应度量修饰，此处定义为分层效应的差异（41周时的效应减去37周时的效应），为：\n$$\n\\Delta \\;=\\; \\left[\\,\\beta_{B} + \\beta_{BG}(1)\\,\\right] \\;-\\; \\left[\\,\\beta_{B} + \\beta_{BG}(-3)\\,\\right] \\;=\\; \\beta_{BG}\\,(1 - (-3)) \\;=\\; \\beta_{BG}\\,(4).\n$$\n代入 $\\beta_{BG} = -0.08$，\n$$\n\\Delta \\;=\\; (-0.08)\\times 4 \\;=\\; -0.32.\n$$\n四舍五入到三位有效数字，差异为 $-0.320$。\n\n解读：因为 $\\Delta$ 是负数，所以出生体重与收缩压之间的负相关关系在41周时比在37周时强 $0.32$ $\\mathrm{mmHg}$ 每 $100$ 克。这表明存在由胎龄引起的效应度量修饰，与“健康与疾病的发育起源”假说一致，即胎儿生长对成年心血管表型的影响随妊娠时间的不同而变化。",
            "answer": "$$\\boxed{-0.320}$$"
        },
        {
            "introduction": "观察性研究的一个核心挑战是无法测量的混杂因素，特别是在家庭层面共享的遗传和环境因素。同胞比较设计（或家庭内固定效应模型）为控制这些稳定的混杂因素提供了一种强有力的策略。本练习将引导您推导家庭内估计量的公式，揭示这种准实验设计是如何帮助我们分离出随时间变化的暴露（如孕期吸烟）的因果效应的 。",
            "id": "4607026",
            "problem": "考虑一项“健康与疾病的发育起源”（DOHaD）研究，该研究使用同胞对来调查产前吸烟对出生体重的影响。对于家庭 $i \\in \\{1,\\dots, N\\}$，令 $Y_{ij}$ 表示孩子 $j \\in \\{1,2\\}$ 的出生体重（单位：克），$S_{ij}$ 表示母亲在怀孩子 $j$ 期间每天平均吸烟的支数。为简化起见，假设为单胎、足月分娩，且没有测量的同胞特异性协变量。假设数据由以下线性模型生成：\n$$\nY_{ij} = \\alpha_i + \\beta S_{ij} + u_{ij},\n$$\n其中 $\\alpha_i$ 是一个未观测到的家庭固定效应（捕捉稳定的共同遗传和社会经济禀赋），$u_{ij}$ 是一个异质性误差。您的目标是识别因果效应参数 $\\beta$。\n\n从线性投影和最小二乘法的基本定义出发，仅使用代数和普通最小二乘法规则，推导基于同胞差异的 $\\beta$ 的家庭内估计量。直接处理同胞间的差分方程，并估计不含截距项的斜率。将该估计量表示为可观测数据 $\\{Y_{i1}, Y_{i2}, S_{i1}, S_{i2}\\}_{i=1}^{N}$ 的闭式函数。\n\n此外，请陈述在此设定下，该家庭内估计量能够一致地估计产前吸烟对出生体重的因果效应所需的最小识别假设集。\n\n您的最终答案必须是 $\\beta$ 的家庭内估计量关于可观测数据的单个闭式解析表达式。无需四舍五入，最终表达式中也不应包含单位。",
            "solution": "对于家庭 $i \\in \\{1,\\dots, N\\}$ 中孩子 $j \\in \\{1,2\\}$ 的出生体重 $Y_{ij}$ 的模型由下式给出：\n$$\nY_{ij} = \\alpha_i + \\beta S_{ij} + u_{ij}\n$$\n其中 $S_{ij}$ 是产前吸烟暴露，$α_i$ 是一个未观测到的家庭特异性固定效应，$u_{ij}$ 是一个异质性误差项。我们感兴趣的参数是 $\\beta$，即产前吸烟对出生体重的因果效应。\n\n为了消除未观测到的家庭固定效应 $\\alpha_i$，我们可以对每个家庭中两个同胞的方程进行差分。\n对于第一个同胞 ($j=1$)：\n$$\nY_{i1} = \\alpha_i + \\beta S_{i1} + u_{i1}\n$$\n对于第二个同胞 ($j=2$)：\n$$\nY_{i2} = \\alpha_i + \\beta S_{i2} + u_{i2}\n$$\n将第一个同胞的方程从第二个同胞的方程中减去，得到：\n$$\n(Y_{i2} - Y_{i1}) = (\\alpha_i - \\alpha_i) + \\beta(S_{i2} - S_{i1}) + (u_{i2} - u_{i1})\n$$\n我们将家庭 $i$ 的家庭内差异定义为：\n$\\Delta Y_i = Y_{i2} - Y_{i1}$\n$\\Delta S_i = S_{i2} - S_{i1}$\n$\\Delta u_i = u_{i2} - u_{i1}$\n\n将这些定义代入差分方程，得到每个家庭 $i$ 的一个新线性模型：\n$$\n\\Delta Y_i = \\beta \\Delta S_i + \\Delta u_i\n$$\n请注意，未观测到的家庭特异性混杂因素 $\\alpha_i$ 已被消除。问题指定我们要从这个差分方程中估计 $\\beta$，将其视为一个只有一个回归量 $\\Delta S_i$ 且没有截距的简单线性回归模型。\n\n$\\beta$ 的估计量，我们记为 $\\hat{\\beta}_{WF}$（“家庭内”之意），是通过应用普通最小二乘法 (OLS) 的原理找到的。我们寻求使所有 $N$ 个家庭的残差平方和 (SSR) 最小化的 $\\hat{\\beta}_{WF}$ 值。家庭 $i$ 的残差为 $e_i = \\Delta Y_i - \\hat{\\beta}_{WF} \\Delta S_i$。SSR 是需要最小化的目标函数：\n$$\nQ(\\hat{\\beta}_{WF}) = \\sum_{i=1}^{N} e_i^2 = \\sum_{i=1}^{N} (\\Delta Y_i - \\hat{\\beta}_{WF} \\Delta S_i)^2\n$$\n为了找到最小值，我们对 $Q(\\hat{\\beta}_{WF})$ 关于 $\\hat{\\beta}_{WF}$ 求一阶导数，并令其为零。使用链式法则：\n$$\n\\frac{dQ}{d\\hat{\\beta}_{WF}} = \\sum_{i=1}^{N} 2 (\\Delta Y_i - \\hat{\\beta}_{WF} \\Delta S_i) \\cdot (-\\Delta S_i) = 0\n$$\n两边除以 $-2$ 并分配 $\\Delta S_i$ 项：\n$$\n\\sum_{i=1}^{N} \\left( (\\Delta Y_i)(\\Delta S_i) - \\hat{\\beta}_{WF} (\\Delta S_i)^2 \\right) = 0\n$$\n分离求和项：\n$$\n\\sum_{i=1}^{N} (\\Delta Y_i)(\\Delta S_i) - \\hat{\\beta}_{WF} \\sum_{i=1}^{N} (\\Delta S_i)^2 = 0\n$$\n现在，我们求解 $\\hat{\\beta}_{WF}$：\n$$\n\\hat{\\beta}_{WF} \\sum_{i=1}^{N} (\\Delta S_i)^2 = \\sum_{i=1}^{N} (\\Delta Y_i)(\\Delta S_i)\n$$\n这给出了通过原点的回归的 OLS 估计量：\n$$\n\\hat{\\beta}_{WF} = \\frac{\\sum_{i=1}^{N} (\\Delta Y_i)(\\Delta S_i)}{\\sum_{i=1}^{N} (\\Delta S_i)^2}\n$$\n最后，我们通过代回 $\\Delta Y_i$ 和 $\\Delta S_i$ 的定义，将估计量用原始可观测数据 $\\{Y_{i1}, Y_{i2}, S_{i1}, S_{i2}\\}_{i=1}^{N}$ 表示：\n$$\n\\hat{\\beta}_{WF} = \\frac{\\sum_{i=1}^{N} (Y_{i2} - Y_{i1})(S_{i2} - S_{i1})}{\\sum_{i=1}^{N} (S_{i2} - S_{i1})^2}\n$$\n这就是 $\\beta$ 的家庭内估计量的闭式表达式。\n\n要使该估计量 $\\hat{\\beta}_{WF}$ 能够一致估计真实的因果参数 $\\beta$，需要一个最小的识别假设集：\n\n1.  **正确的模型设定**：出生体重、吸烟和未观测效应之间的真实关系必须是线性和可加的，如模型所示：$Y_{ij} = \\alpha_i + \\beta S_{ij} + u_{ij}$。参数 $\\beta$ 必须在个体和时间上是恒定的。\n\n2.  **异质性误差的严格外生性**：这是关键的识别假设。它要求异质性误差项 $u_{ij}$ 与*两个*同胞怀孕期 ($k=1,2$) 的解释变量 $S_{ik}$ 都不相关。形式上，这表示为 $E[u_{ij} \\mid S_{i1}, S_{i2}, \\alpha_i] = 0$ 对 $j=1,2$ 成立。在差分方程 $\\Delta Y_i = \\beta \\Delta S_i + \\Delta u_i$ 的背景下，该假设确保差分后的回归量 $\\Delta S_i$ 与差分后的误差项 $\\Delta u_i$ 不相关。即 $E[\\Delta u_i \\mid \\Delta S_i] = 0$，这等价于 $Cov(\\Delta S_i, \\Delta u_i) = 0$。如果存在任何未观测到的*随时间变化*（即同胞特异性）的因素，同时影响母亲吸烟行为的改变和孩子的出生体重，那么这个假设就会被违背。例如，两次怀孕之间母亲压力或健康状况的变化可能会同时影响 $S_{i2}$ 和 $u_{i2}$，从而引发伪相关，并导致 $\\beta$ 的估计有偏。\n\n3.  **家庭内变异**：为了使估计量有定义，分母必须非零。这要求在整个样本中，两次怀孕之间的吸烟习惯至少存在一些变异。也就是说，对于至少一个家庭 $i$，$S_{i1} \\neq S_{i2}$，从而使得 $\\sum_{i=1}^{N} (S_{i2} - S_{i1})^2 > 0$。如果没有母亲改变她的吸烟习惯，$\\beta$ 用此方法将无法识别。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{i=1}^{N} (Y_{i2} - Y_{i1})(S_{i2} - S_{i1})}{\\sum_{i=1}^{N} (S_{i2} - S_{i1})^{2}}}\n$$"
        },
        {
            "introduction": "生命历程数据常常具有聚类结构，例如，来自同一位母亲的多个孩子。线性混合模型是分析此类数据的标准工具，它能恰当地处理观测值之间的非独立性。本练习旨在训练您解释混合模型输出结果的实用技能，特别是如何将标准化变量的系数转换回其原始的、具有实际意义的单位，这是应用研究中一项常见且重要的任务 。",
            "id": "4607047",
            "problem": "一项生命历程流行病学中的队列研究通过对母亲多次怀孕期间的婴儿出生体重进行建模，来检验健康与疾病的发育起源 (DOHaD) 假说。设 $y_{ij}$ 表示第 $j$ 位母亲的第 $i$ 个婴儿的出生体重（单位：克），设 $p_{ij}$ 表示怀孕期间母亲的蛋白质摄入量（单位：克/天）。一个带有母亲随机截距的线性混合模型被拟合到数据上。该模型对蛋白质摄入量使用了一个标准化预测变量 $z_{ij}$，其定义采用广泛使用的 $z$-分数变换 $z_{ij} = (p_{ij} - \\mu_{p}) / s_{p}$，其中 $\\mu_{p}$ 是 $p$ 的样本均值，$s_{p}$ 是 $p$ 的样本标准差。\n\n拟合的模型为\n$$\ny_{ij} = \\beta_{0} + b_{0j} + \\beta_{1} z_{ij} + \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + \\varepsilon_{ij},\n$$\n其中 $b_{0j}$ 是特定于母亲的随机截距，满足 $b_{0j} \\sim \\mathcal{N}(0, \\sigma_{b0}^{2})$，$\\varepsilon_{ij} \\sim \\mathcal{N}(0, \\sigma^{2})$，$\\mathbf{x}_{ij}$ 是怀孕期间测量的其他协变量的向量。标准化蛋白质摄入量的估计固定效应系数为 $\\hat{\\beta}_{1} = 52$，这意味着在保持其他协变量不变的情况下，母亲蛋白质摄入量每增加一个标准差，出生体重的期望变化为 $52$ 克。母亲蛋白质摄入量的样本均值和标准差分别为 $\\mu_{p} = 70$ 和 $s_{p} = 15$（单位均为克/天）。\n\n利用混合模型的线性特性和 $z$-分数的定义，计算与母亲蛋白质摄入量每天增加 $10$ 克相关联的出生体重（以克为单位）的期望变化。将您的数值答案四舍五入到四位有效数字。用克表示您的最终答案。此外，在 DOHaD 框架内，就母亲蛋白质摄入量每增加一个单位所导致的出生体重期望变化而言，对此随机截距模型中的斜率系数进行简要解释。",
            "solution": "所提供的线性混合模型将结果（出生体重 $y_{ij}$）与一组预测变量（包括标准化的母亲蛋白质摄入量 $z_{ij}$）联系起来：\n$$\ny_{ij} = \\beta_{0} + b_{0j} + \\beta_{1} z_{ij} + \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + \\varepsilon_{ij}\n$$\n标准化预测变量 $z_{ij}$ 是根据原始蛋白质摄入量变量 $p_{ij}$（单位：克/天）定义的：\n$$\nz_{ij} = \\frac{p_{ij} - \\mu_{p}}{s_{p}}\n$$\n其中 $\\mu_{p}$ 是 $p_{ij}$ 的样本均值，$s_{p}$ 是其样本标准差。\n\n为了确定出生体重 $y_{ij}$ 和原始蛋白质摄入量 $p_{ij}$ 之间的关系，我们将 $z_{ij}$ 的表达式代入模型方程：\n$$\ny_{ij} = \\beta_{0} + b_{0j} + \\beta_{1} \\left( \\frac{p_{ij} - \\mu_{p}}{s_{p}} \\right) + \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + \\varepsilon_{ij}\n$$\n我们可以通过分配 $\\beta_{1}$ 项来重新整理这个方程：\n$$\ny_{ij} = \\beta_{0} + b_{0j} + \\frac{\\beta_{1}}{s_{p}} p_{ij} - \\frac{\\beta_{1}\\mu_{p}}{s_{p}} + \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + \\varepsilon_{ij}\n$$\n通过对各项进行分组，我们可以用一个关于 $p_{ij}$ 的显式斜率和一个修正后的截距来表示模型：\n$$\ny_{ij} = \\left( \\beta_{0} - \\frac{\\beta_{1}\\mu_{p}}{s_{p}} \\right) + b_{0j} + \\left( \\frac{\\beta_{1}}{s_{p}} \\right) p_{ij} + \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + \\varepsilon_{ij}\n$$\n令 $\\beta_{p} = \\frac{\\beta_{1}}{s_{p}}$ 为非标准化蛋白质摄入量 $p_{ij}$ 的斜率系数。系数 $\\beta_p$ 表示在保持所有其他协变量和特定于母亲的随机效应 $b_{0j}$ 不变的情况下，蛋白质摄入量 $p_{ij}$ 每增加一个单位（1 克/天）时，出生体重 $y_{ij}$ 的期望变化。\n\n问题要求计算与母亲蛋白质摄入量每天增加 $10$ 克相关联的出生体重的期望变化。这个变化我们记为 $\\Delta E[y]$，是斜率系数 $\\beta_p$ 的 $10$ 倍：\n$$\n\\Delta E[y] = 10 \\times \\beta_{p} = 10 \\times \\frac{\\beta_{1}}{s_{p}}\n$$\n我们已知标准化变量的估计系数 $\\hat{\\beta}_{1} = 52$ 克，以及蛋白质摄入量的样本标准差 $s_{p} = 15$ 克/天。我们使用这些估计值来计算估计的变化量：\n$$\n\\widehat{\\Delta E[y]} = 10 \\times \\frac{\\hat{\\beta}_{1}}{s_{p}} = 10 \\times \\frac{52}{15}\n$$\n进行计算：\n$$\n\\widehat{\\Delta E[y]} = \\frac{520}{15} = \\frac{104}{3} \\approx 34.666... \\text{ 克}\n$$\n将结果四舍五入到四位有效数字，我们得到 $34.67$ 克。\n\n### 斜率系数的解释\n\n任务的第二部分要求对非标准化蛋白质摄入量的斜率系数进行解释。这个系数是 $\\beta_p = \\beta_1/s_p$，其估计值为 $\\hat{\\beta}_p = 52/15 \\approx 3.467$。在这个随机截距模型和 DOHaD 框架的背景下，这个系数有特定的解释。该模型将变异的来源分为两个部分：母亲间变异（由随机截距 $b_{0j}$ 捕获）和母亲内变异（每次怀孕与其母亲平均水平的偏差）。系数 $\\hat{\\beta}_p$ 量化了*母亲内部*的关联。\n\n因此，解释如下：对于一位给定的母亲，在保持所有其他测量的协变量不变的情况下，某次怀孕期间每天额外摄入一克蛋白质，与她的其他怀孕相比，该次怀孕婴儿的出生体重期望增加约 $3.47$ 克。这种母亲内部的分析是 DOHaD 研究的一个关键优势，因为随机截距控制了所有稳定的、不随时间变化的母亲特征（例如，遗传、长期健康状况、社会经济背景）——这些特征在她历次怀孕中是恒定的，从而减少了潜在的混淆，并加强了产前暴露变化的直接影响的证据。",
            "answer": "$$\n\\boxed{34.67}\n$$"
        }
    ]
}