## 引言
药物流行病学与药物警戒是公共卫生与临床医学的关键交叉领域，它运用流行病学方法研究药物在真实世界人群中的使用效果与安全性。当随机对照试验（RCT）因伦理、成本或实践性限制而无法解答所有关于药物长期效果、罕见不良反应以及在多样化人群中表现的问题时，药物流行病学便提供了不可或缺的证据来源。然而，从充满混杂与偏倚的观察性数据中得出可靠的因果结论，是该学科面临的核心挑战。如何区分真实的药物效应与由患者选择、疾病严重程度等因素造成的虚假关联，需要一套严谨的理论框架和方法学工具。

本文旨在系统性地介绍这一领域的核心知识。在第一章“原理与机制”中，我们将奠定因果推断的理论基石，并深入剖析适应证混杂、永生时间偏倚等关键挑战及其应对策略。随后，在第二章“应用与跨学科交叉”中，我们将展示这些原理如何应用于药物利用研究、疫苗安全评估，并与遗传学、数据科学等前沿领域交织。最后，在第三章“动手实践”中，您将有机会通过计算具体指标来巩固所学知识。通过这一学习路径，读者将能全面掌握评估药物真实世界证据的关键技能。

## 原理与机制

药物流行病学是一门独特的交叉学科，它将药理学的严谨性与流行病学在真实世界人群中的研究方法相结合。本章将深入探讨支撑这一学科的核心原理与机制。我们将从定义药物流行病学的范畴及其因果推断的理论基础开始，继而阐述在[观察性研究](@entry_id:174507)中遇到的独特挑战，并介绍为应对这些挑战而设计的专门研究方法。最后，我们将审视药物警戒的完整生命周期，从最初的信号检测到最终的监管行动，并探讨用于评估因果关系的各类数据来源和框架。

### 药物流行病学的范畴与因果推断基础

要理解药物流行病学的贡献，首先必须将其与其母学科——临床药理学和经典流行病学——进行区分。**临床药理学** 主要关注个体层面，研究药物在体内的过程（药代动力学，PK）以及药物浓度与药理效应之间的关系（药效动力学，PD），其研究通常在严格控制的剂量和条件下进行。而**经典流行病学** 研究人群中健康相关状态或事件的分布和决定因素，其关注点可能与特定的药物干预无关。

**药物流行病学** 则架起了这两者之间的桥梁：它运用流行病学的方法，研究药物在广泛、异质性人群中的使用情况及效果 。其独特之处在于，它主要处理在常规临床实践中收集的观察性数据，例如电子健康记录（EHR）和保险理赔数据。这使得研究者能够回答一些随机对照试验（RCT）通常无法解决的关键问题，例如：
-   在真实世界中，不同药物的比较效果和安全性如何？
-   药物的效应是否存在异质性，即在不同亚组（如年龄、性别或合并症）中是否有所不同？
-   罕见但严重的[药物不良反应](@entry_id:163563)的风险有多大？
-   患者的用药依从性模式对临床结局有何影响？

由于药物流行病学研究多为非随机化的[观察性研究](@entry_id:174507)，其核心挑战在于从关联中推断因果。为了严谨地定义和估计因果效应，我们引入**潜在结局（或反事实）框架**。假设我们研究一种新药对某结局的因果效应。对于任何一个个体，存在两种潜在结局：$Y^1$，即该个体接受治疗（$A=1$）后的结局；以及 $Y^0$，即同一位个体未接受治疗（$A=0$）后的结局。对于单个个体而言，因果效应即为 $Y^1 - Y^0$。然而，在现实中我们永远无法同时观测到同一个体的两种潜在结局，这就是所谓的“因果推断的根本问题”。因此，我们的目标是估计**平均因果效应 (Average Causal Effect, ACE)**，即在目标人群中该个[体效应](@entry_id:261475)的[期望值](@entry_id:150961)：

$$ ACE = E[Y^1 - Y^0] $$

为了能从观察性数据中（我们只能观测到个体在其实际接受的治疗水平下的结局）估计这一反事实的量，必须依赖三个核心的、不可检验的**可识别性假设** ：

1.  **一致性 (Consistency):** 个体被观测到的结局，与其在所接受的治疗水平下的潜在结局是一致的。也就是说，如果一个个体实际接受了治疗 $A=a$，那么他/她的观测结局 $Y$ 就等于其潜在结局 $Y^a$。此假设要求治疗（例如，“基线时开始用药”）的定义必须明确无[歧义](@entry_id:276744)。

2.  **[可交换性](@entry_id:263314) (Exchangeability):** 在给定一组基线协变量 $L$ 的条件下，治疗分配与潜在结局是独立的。数学上表示为 $Y^a \perp \!\!\! \perp A \mid L$。这个假设也被称为“无未测量混杂”，它意味着在控制了 $L$ 之后，接受治疗和未接受治疗的两组人就好像是随机分配的一样，具有可比性。这是处理观察性研究中混杂偏倚的关键。

3.  **正性 (Positivity):** 在由协变量 $L$ 定义的每个亚组中，接受每种治疗水平的概率都必须大于零且小于一。即对于所有 $P(L=\ell) > 0$ 的 $\ell$，都有 $0  P(A=a \mid L=\ell)  1$。该假设确保在人群的每个阶层中，都有人接受治疗，也有人未接受治疗，从而使得比较成为可能。

只有在这三个假设都成立的前提下，我们才能利用观察性数据，通过统计方法（如标准化或倾向性评分）估计出无偏的平均因果效应。

### [观察性研究](@entry_id:174507)中的核心方法学挑战

在药物流行病学研究中，[可交换性](@entry_id:263314)假设最常受到威胁，主要源于各类偏倚，其中一些在药物研究中尤为突出。

#### 适应证混杂与引导偏倚

**混杂 (Confounding)** 是指某个第三变量既与暴露（药物使用）相关，又与结局相关（且不位于暴露到结局的因果路径上），从而扭曲了暴露与结局之间的真实关系。一个经典的例子是年龄，老年人可能更倾向于接种[流感疫苗](@entry_id:165908)，同时他们的死亡风险也更高，如果不控制年龄，疫苗的效果就可能被低估 。

在药物研究中，两种特殊形式的混杂偏倚尤其值得关注：

-   **适应证混杂 (Confounding by indication):** 这是药物流行病学中最核心的偏倚。简而言之，驱动医生开具某种药物的临床原因（即适应证的严重程度），本身就是影响结局的风险因素。例如，病情更严重（适应证更强）的哮喘患者更可能接受口服皮质[类固醇](@entry_id:146569)治疗，同时也更可能住院。在粗略分析中，这会造成皮质[类固醇](@entry_id:146569)似乎会增加住院风险的假象，而实际上是疾病的严重程度同时导致了用药选择和不良结局 。

-   **引导偏倚 (Channeling bias):** 这是一种特殊的适应证混杂，通常发生在新药上市初期。医生会基于患者的某些特征（如合并症、年龄、虚弱程度等）而“引导”他们优先选择某种药物而非另一种。例如，如果一种新型降糖药被认为对肾脏更安全，医生可能倾向于将其开给已有慢性肾病的患者。由于慢性肾病本身就是许多不良结局的强风险因素，这种引导行为会在不同药物使用者之间造成基线风险的巨大差异，从而产生偏倚 。

在随机对照试验（RCT）中，随机化过程能确保治疗组和[对照组](@entry_id:188599)在所有基线特征（无论已知还是未知）上具有可比性，从而在设计层面消除了这些混杂偏倚 。但在观察性研究中，我们必须通过精巧的研究设计和统计分析来尽可能地控制它们。

#### 时间相关偏倚：永生时间偏倚

除了混杂偏倚，对暴露时间的错误定义也会导致严重的偏倚，其中最臭名昭著的是**永生时间偏倚 (Immortal time bias)**。这种偏倚源于将一段研究对象在设计上不可能发生结局的“永生”时间，错误地归类到暴露组的随访时间内，从而人为地稀释了暴露组的事件发生率，造成药物具有虚假保护作用的假象 。

让我们通过一个具体的例子来理解。假设一项研究评估出院后使用药物X能否降低一年内死亡率。研究将任何在随访期间使用了药物X的患者定义为“暴露组”，并在分析时将他们的暴露时间从队列研究开始时（出院日）算起。假设有3000名患者在出院后第91天才开始使用药物X。根据这个错误的定义，他们从第0天到第90天的这段时间被计入了“暴露组”的随访时间。然而，为了能在第91天开始用药，他们必须在这90天内保持存活。这段时间是“永生的”，因为在这期间死亡的患者永远不会被归类为暴露者。

-   **错误分析：** 假设这3000名患者在用药后的274天内（第91天至第365天）有68例死亡。错误分析将他们的总暴露人年计为 $3000 \times 1 = 3000$ 人年，计算出的死亡率为 $68 / 3000 \approx 0.0227$ 例/人年。与此同时，7000名从未使用药物的[对照组](@entry_id:188599)有240例死亡，死亡率为 $240 / 7000 \approx 0.0343$ 例/人年。据此计算出的率比为 $0.0227 / 0.0343 \approx 0.66$，显示药物有显著的保护作用。

-   **正确分析：** 正确的方法是将暴露状态视为一个**随时间变化的变量**。这3000名患者在用药前的91天（0.25年）贡献了 $3000 \times 0.25 = 750$ 人年的“未暴露”时间（期间死亡数为0），在用药后贡献了 $3000 \times 0.75 = 2250$ 人年的“暴露”时间（期间死亡数为68）。因此，正确的暴露组死亡率为 $68 / 2250 \approx 0.0302$ 例/人年。而未暴露的总人年为7000名未用药者贡献的7000人年，加上3000名用药者在用药前贡献的750人年，共计7750人年，总死亡数为240例，死亡率为 $240 / 7750 \approx 0.0310$ 例/人年。正确的率比为 $0.0302 / 0.0310 \approx 0.97$，表明药物几乎没有效果。

这个例子清晰地表明，永生时间偏倚能够凭空制造出保护作用的假象，因此在研究设计中正确处理随时间变化的暴露至关重要 。

### 缓解偏倚的研究设计策略

为了应对上述挑战，药物流行病学家发展出了一系列复杂的研究设计。

#### 新使用者设计 vs. 现患使用者设计

一个基本的设计原则是优先采用**新使用者设计 (New-user design)**。这种设计仅纳入刚刚开始使用目标药物或对照药物的患者，并将他们开始用药的当天作为随访的“第0天”。

与之相对的是**现患使用者设计 (Prevalent-user design)**，该设计纳入的是在研究开始时已经使用了一段时间药物的患者。这种设计存在严重缺陷，因为它会引入**易感者耗竭偏倚 (depletion of susceptibles bias)**，也称作“健康使用者效应”或“幸存者偏倚” 。如果一种药物在使用的早期阶段会引起不良反应，那么那些对药物不耐受或在早期就经历了不良事件的患者，在研究者开始招募“现患使用者”时，很可能已经停药或死亡，从而被排除在研究之外。这样一来，被纳入研究的现患使用者是一群“幸存者”，他们能够耐受药物的早期风险，这会使得药物看起来比实际更安全。

例如，假设一种降压药在用药第一个月内会显著增加某不良事件的风险，此后风险恢复正常。一项新使用者研究会完整地捕捉到这一早期风险。然而，一项在药物上市4个月后才开始招募已连续用药3个月以上的“现患使用者”的研究，则会完全错过这个高风险期。其结果是，这项研究可能会错误地得出药物无害的结论（例如，风险比为1.0），而新使用者设计则能正确地估计出包含早期风险在内的整体危害（例如，风险比为1.17） 。因此，通过将随访的起点与暴露的起点对齐，新使用者设计能有效避免因条件化于“幸存”或“耐受”而产生的偏倚。

#### 积极对照，新使用者设计

为了更有效地解决适应证混杂问题，**积极对照，新使用者设计 (Active comparator, new-user design)** 已成为现代药物流行病学的黄金标准之一 。其核心思想是，与其将药物使用者与“不使用者”进行比较（这两组人因适应证不同而可比性极差），不如将新使用者与另一组开始使用**替代性治疗药物**（即积极对照药）的新使用者进行比较。

选择一个合适的积极对照药至关重要，理想的对照药应满足以下标准：
-   具有与研究药物相同的临床适应证和治疗线级。
-   在相似的临床场景下开具，具有重叠的禁忌症和安全性考量。
-   具有可比的给药途径和频率。

例如，在评估一种新型[SGLT2抑制剂](@entry_id:152281)（一种二线降糖药）对心衰风险的影响时，一个优秀的积极[对照组](@entry_id:188599)是开始使用另一种二线降糖药（如GLP-1受体激动剂）的新使用者。由于这两组患者都是因为一线治疗（如[二甲双胍](@entry_id:154107)）效果不佳而需要升级治疗，他们在疾病严重程度、合并症和基线风险方面可能更为相似。这种设计使得两组更接近“可交换”，从而极大地减轻了适应证混杂和引导偏倚 。即便如此，研究者仍需仔细测量并统计调整所有剩余的基线协变量差异，例如通过构建倾向性评分。

### 药物警戒：从信号到行动

除了进行正式的流行病学研究外，药物流行病学的一个关键分支是**药物警戒 (Pharmacovigilance)**，即对已上市药品不良反应的持续监测、评估、理解和预防。这是一个从数据中发现潜在风险并采取行动的完整生命周期 。

#### 第一阶段：[信号检测](@entry_id:263125)（假设生成）

药物警戒的起点是**信号检测**，即识别需要进一步调查的药物-不良事件之间潜在的新关联。这一阶段主要依赖于**被动监测系统**，也称为**自发呈报系统 (Spontaneous Reporting Systems, SRS)**，如美国的FDA不良事件报告系统（FAERS）和欧洲的EudraVigilance。这些系统收集来自医生、患者和其他来源的个案安全报告。

由于SRS数据没有分母（即不清楚总共有多少人使用了该药物），我们无法计算真实的事件发生率。取而代之的是，我们使用**不均衡性分析 (Disproportionality analysis)** 来筛选信号 。其核心思想是，检验某个特定的“药物-事件”组合的报告数量，是否超出了在数据库中基于背景报告频率所“期望”的数量。如果超出，就构成一个“信号”。常用的衡量指标包括：
-   **报告比例比 (Proportional Reporting Ratio, PRR):** 比较在使用目标药物的报告中特定事件所占的比例，与在使用其他所有药物的报告中该事件所占的比例。
-   **报告比值比 (Reporting Odds Ratio, ROR):** 比较目标药物报告中特定事件与所有其他事件的比值，与其他药物报告中这一比值的比值。
-   **贝叶斯方法 (如信息成分IC，[经验贝叶斯](@entry_id:171034)几何均数EBGM):** 这些更先进的方法应用了贝叶斯统计中的“收缩”(shrinkage)思想，能够对计数很少的罕见事件的估计值进行稳定化处理，从而减少因随机波动产生的虚假信号 。

重要的是要记住，一个信号仅仅是一个**待验证的假设**，而不是因果关系的证明，因为它极易受到报告偏倚的影响。

#### 第二阶段：信号评估（假设检验）

一旦检测到一个信号，就必须通过严谨的流行病学研究来对其进行评估。这时就需要**主动监测系统**，如FDA的“哨兵计划”(Sentinel System)。这类系统利用庞大的、标准化的电子健康记录或保险理赔数据库网络，可以在定义明确的人群中快速开展队列研究或自身对照研究。通过这些研究，可以计算出如**率比 (Incidence Rate Ratio, IRR)** 等关联强度指标，并对重要的混杂因素进行控制。只有经过这样严格的评估，才能判断信号是否反映了真实的因果风险 。

#### 第三阶段：风险管理

如果分析证实药物确实存在临床上重要的风险，监管机构和生产商必须采取与风险程度相称的**风险最小化措施**。这些措施可能包括：
-   更新药品标签（说明书），增加警告、注意事项或禁忌症。
-   发布“致医务人员的信函”以进行风险沟通。
-   实施结构化的**风险评估与管控策略 (Risk Evaluation and Mitigation Strategy, REMS)**（美国）或**风险管理计划 (Risk Management Plan, RMP)**（欧盟），其中可能包括要求对患者进行特定监测或限制处方权限等。

市场撤市是最后的手段，仅适用于那些风险远超其获益的药物。

### 数据来源与因果关系评估框架

药物流行病学和药物警戒的实践依赖于多样化的数据来源和严谨的评估框架。

#### 真实世界数据来源的权衡

不同的数据来源在用于药物安全研究时各有优劣 ：

-   **行政理赔数据 (Administrative claims):** 优点在于对**已配药**的处方具有很高的**完整性**，但**时效性**较差（数据延迟通常为30-90天），且对临床结局的**有效性**（如[诊断准确性](@entry_id:185860)）有限，因为缺乏详细的临床信息。

-   **电子健康记录 (EHRs):** 优点在于**时效性**极佳（数据接近实时），且包含丰富的临床细节，使得结局认定的**有效性**很高。但其缺点在于对药物暴露的**完整性**较差，因为它记录的是医生的**处方指令**，而无法确认患者是否真的在院外药房取药。

-   **登记研究 (Registries):** 对于特定疾病或药品的登记研究，其数据质量和结局认定的**有效性**通常是最高的，因为数据经过专门收集和专家审核。然而，它们的**时效性**最差（数据整理可能需要数月），且人群覆盖面有限，**完整性**较低。

-   **主动监测网络 (Active surveillance networks):** 如Sentinel系统，通过使用通用数据模型整合来自多个机构的EHR和理赔数据，旨在实现时效性、规模和有效性之间的平衡，是进行快速、大规模安全评估的强大工具。

#### 因果关系的评估层次

最后，在评估药物与不良事件之间的因果关系时，区分**个体层面**的判断和**群体层面**的推断至关重要 。

-   **WHO-UMC 因果关系评估体系:** 该体系用于评估**单个病例报告 (ICSR)** 的因果可能性。它依赖于临床证据，如事件发生的时间顺序、停药后反应（去激发，dechallenge）、重新用药后反应（再激发，rechallenge）以及是否存在其他合理解释。基于这些信息，将病例评定为“肯定的”、“很可能的”、“可能的”等类别。例如，一个在用药后出现肝损伤、停药后好转、再次用药后复发的病例，就可能被评为“肯定的”。

-   **Bradford Hill 因果推断准则:** 这九条准则并非一个僵硬的清单，而是用于指导我们从**群体水平**的流行病学研究结果中进行因果推断的“观点”。这些准则包括关联的强度、一致性、特异性、时间顺序、生物学梯度（剂量-反应关系）、生物学合理性等。在这些准则中，**时间顺序**（原因必须在结果之前）是唯一被公认为不可或缺的。Bradford Hill准则帮助我们将一系列研究证据综合起来，形成一个关于药物在人群中是否具有因果效应的整体判断。

综上所述，药物流行病学通过其独特的理论框架、研究设计和评估体系，为理解药物在真实世界中的风险与获益提供了不可或缺的科学依据。它从严谨的因果推断理论出发，发展出针对性的方法学来克服观察性数据固有的偏倚，并通过药物警戒的实践，将科学发现转化为保护公众健康的具体行动。