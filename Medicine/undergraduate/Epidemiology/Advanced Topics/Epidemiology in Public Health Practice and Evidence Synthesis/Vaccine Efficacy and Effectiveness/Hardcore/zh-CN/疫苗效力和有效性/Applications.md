## 应用与跨学科交叉

在前面的章节中，我们已经详细介绍了[疫苗效力](@entry_id:194367)（vaccine efficacy, VE）与效果（vaccine effectiveness, VE）的核心原理与机制。然而，这些理论概念的真正价值在于其在真实世界中的应用。本章旨在将这些核心原理置于多样化、跨学科的实际应用场景中进行探讨。我们将不再重复基本定义，而是聚焦于展示如何利用这些原理来设计研究、分析数据、解决复杂的科学问题，并为公共卫生决策提供依据。

从严格控制的随机试验（RCT）到复杂的真实世界观察性研究，疫苗效力的评估远非一个单一的计算过程，而是一个涵盖流行病学、生物统计学、免疫学、实施科学乃至卫生经济学等多个领域的综合性学科。本章将通过一系列精心设计的应用场景，带领读者深入探索这一交叉学科领域的广度与深度。我们将首先回顾评估疫苗效果的经典与现代流行病学研究设计，随后深入探讨用于处理复杂数据和因果推断的高级方法，最后将视野拓宽至疫苗评估在[传染病](@entry_id:182324)动力学、公共卫生政策制定和安全性监测等领域的跨学科应用。通过这一过程，我们希望阐明，对疫苗效果的每一次评估，都是一次科学探究，其方法的选择和结果的解读都必须根植于具体的科学问题和现实背景之中。

### 评估疫苗效果的核心流行病学研究设计

对疫苗效果的评估始于严谨的研究设计。不同的设计有其各自的优势、局限性和适用场景。本节将介绍几种在疫苗评估中至关重要的流行病学研究设计方法。

#### 队列研究中的混杂因素控制

队列研究是一种直观的研究设计，它通过比较接种疫苗和未接种疫苗两个人群的发病风险来直接估计疫苗的保护效果。然而，在观察性研究中，这两个人群可能在除疫苗接种状态外的其他方面存在系统性差异，这些差异（即混杂因素）可能会扭曲我们对疫苗效果的估计。

一个典型的例子是在一个封闭的长期护理机构中暴发了由特定病原体引起的胃肠炎。研究人员进行了一项回顾性队列研究，以评估先前接种的疫苗对此次暴发的保护效果。数据显示，在暴发期间，接种疫苗居民的发病率（Attack Rate, AR）显著低于未接种疫苗的居民，这表明疫苗似乎是有效的。然而，进一步分析发现，居民的暴露强度（例如，是否与最初的感染源在同一张桌子上吃饭）与他们的发病风险和疫苗接种状况都相关。高暴露强度的居民发病风险更高，但他们的疫苗接种比例可能与低暴露强度的居民不同。这种情况下，暴露强度就是一个混杂因素。

如果我们忽略这个混杂因素，直接计算总人群中的风险比（Risk Ratio, RR），即 $RR_{crude} = \frac{AR_{vaccinated}}{AR_{unvaccinated}}$，并由此得到粗略的疫苗效果 $VE_{crude} = 1 - RR_{crude}$，这个估计可能是有偏的。为了得到更准确的估计，我们需要对暴露强度进行分层分析。通过在“高暴露”和“低暴露”两个层内部分别计算RR，然后使用如Mantel-Haenszel方法等统计技术计算一个调整后的合并RR（$RR_{adjusted}$），我们可以得到一个消除了暴露强度混杂效应的调整后疫苗效果 $VE_{adjusted} = 1 - RR_{adjusted}$。通常，$VE_{crude}$ 和 $VE_{adjusted}$ 会有所不同，这个差异的大小正反映了混杂效应的强度。这个过程清晰地展示了在队列研究中识别并控制混杂因素对于准确评估疫苗效果的极端重要性。

#### 病例对照研究：效率与理论基础

与队列研究相比，病例对照研究在评估罕见疾病的疫苗效果时尤其高效。它不是跟踪庞大的人群，而是从一个源人群中选择所有（或一部分）患病个体作为病例组，并从中选择一部分未患病个体作为[对照组](@entry_id:188599)，然后回顾性地比较两组的疫苗接种史。

病例对照研究的核心挑战在于，它直接测量的是病例和对照中的暴露（疫苗接种）比值比（Odds Ratio, OR），而非人群中的发病风险比（RR）。然而，流行病学的一个基石理论证明了这两者之间的重要联系。通过贝叶斯定理可以从第一性原理推导出，在病例对照研究中计算的暴露比值比，在数学上恒等于源人群中的疾病比值比。当所研究的疾病在人群中是罕见的（即在接种和未接种人群中发病率都很低）时，疾病比值比又可以很好地近似于疾病风险比（RR）。因此，我们得到了一个关键的结论：在罕见病假设下，病例对照研究得到的暴露比值比（$OR_{exposure}$）约等于风险比（RR），即 $OR_{exposure} \approx RR$。

基于疫苗效果的定义 $VE = 1 - RR$，我们可以通过病例对照研究的结果来估计VE，即 $VE \approx 1 - OR_{exposure}$。在实际应用中，我们通常使用logistic回归模型来分析病例对照数据，该模型可以直接估计调整了其他混杂因素（如年龄、基础疾病等）后的暴露比值比。具体而言，我们会拟合一个模型 $\text{logit}\{P(D=1 \mid V, X)\} = \alpha + \beta V + \gamma^{\top} X$，其中 $D=1$ 表示病例，$V$ 是疫苗接种状态，$X$ 是其他协变量。模型中的系数 $\beta$ 的指数形式 $\exp(\beta)$ 就是调整后的OR，因此，调整后的疫苗效果可以被估计为 $VE_{adj} \approx 1 - \exp(\beta)$。这一系列推导为在资源有限的情况下，使用高效的病例对照研究来评估疫苗效果提供了坚实的理论基础。

#### 测试阴性设计：一项现代创新

测试阴性设计（Test-Negative Design, TND）是病例对照研究的一种巧妙变体，近年来在评估呼吸道病毒（如流感病毒和SARS-CoV-2）疫苗的效果方面得到了广泛应用。在该设计中，研究对象是所有因出现急性呼吸道症状而寻求医疗服务并接受病原体检测的个体。那些检测结果为阳性的人被定义为“病例”，而那些检测结果为阴性的人则被定义为“对照”。

TND的巧妙之处在于其[对照组](@entry_id:188599)的选择。理论上，病例组和[对照组](@entry_id:188599)都来自同一个源人群——即因出现相似症状而主动就医的人群。这使得两组在医疗保健寻求行为、对症状的敏感度以及暴露于其他病原体的风险等方面具有很高的可比性。该设计的核心假设是，在控制了其他已知混杂因素后，个体的疫苗接种状况不应影响其因感染 *其他* 呼吸道病原体（导致测试阴性）而就医的倾向。如果这一假设成立，那么测试阴性[对照组](@entry_id:188599)的疫苗接种率就可以代表源人群（即出现症状并就医的人群）中的疫苗接种率。

因此，TND本质上是一个病例对照研究，我们可以计算病例组（测试阳性）与[对照组](@entry_id:188599)（测试阴性）之间疫苗接种的OR。这个OR同样可以用来估计疫苗效果，即 $VE = 1 - OR$。计算其[置信区间](@entry_id:138194)也采用标准的方法，例如基于对数OR的大样本方差公式 $\operatorname{Var}(\ln \widehat{\text{OR}}) \approx \frac{1}{a} + \frac{1}{b} + \frac{1}{c} + \frac{1}{d}$ 来构建。TND因其数据易于从常规监测系统中获取、实施高效且能有效控制关键混杂因素而备受青睐。

#### 筛查法：一种高效的监测工具

除了上述传统设计，还有一种被称为“筛查法”（Screening Method）的高效监测工具，尤其适用于拥有完整病例监测系统和人群疫苗接种登记系统的公共卫生机构。这种方法通过比较病例人群中的疫苗接种比例（$p_c$）和背景人群中的疫苗接种比例（$p_p$）来快速评估疫苗效果。

其背后的逻辑同样基于比值比。病例人群中的疫苗接种比值是 $\frac{p_c}{1-p_c}$，而背景人群中的疫苗接种比值是 $\frac{p_p}{1-p_p}$。这两个比值的比率，即 $\frac{p_c/(1-p_c)}{p_p/(1-p_p)}$，正是病例与人群对照的疫苗接种OR。一个非常优雅的数学推导可以证明，这个OR精确地等于接种疫苗者相对于未接种者的发病风险比（RR），即 $RR = \frac{I_v}{I_u}$。值得注意的是，这一等式成立 *无需* 罕见病假设，只要病例能够被完整捕获且独立于接种状态。

因此，我们可以直接通过这个比值比来计算疫苗效果：
$$
VE = 1 - RR = 1 - \frac{p_c(1 - p_p)}{p_p(1 - p_c)}
$$
例如，如果在一次监测中发现，确诊病例中有 $35\%$ 接种了疫苗（$p_c = 0.35$），而在总人口中疫苗覆盖率为 $70\%$（$p_p = 0.70$），那么我们可以迅速估算出疫苗效果约为 $76.9\%$。这种方法的简洁性和高效性使其成为[公共卫生监测](@entry_id:170581)中一个极具价值的工具。

### 复杂因果推断的高级方法

传统的[观察性研究](@entry_id:174507)设计在面对复杂的现实世界数据时，往往会遇到更棘手的挑战，如时变混杂、选择偏倚等。为了更接近随机对照试验（RCT）的因果推断强度，流行病学家发展了一系列高级分析方法。

#### 利用观察性数据模拟目标试验

“目标试验模拟”（Target Trial Emulation）是一个强大的因果推断框架，旨在指导我们如何利用观察性数据（如电子健康记录）来模仿一个理想化的随机试验。其核心思想是，在分析数据之前，首先明确地设计一个我们希望执行的“目标试验”，包括详细的合格标准、治疗策略、分配程序、随访计划和结局定义。然后，在分析观察性数据时，尽可能地模拟这个目标试验的每一个环节。

以评估老年人季节性[流感疫苗](@entry_id:165908)效果为例，一个明确定义的目标试验可能是在流感季节开始时，招募所有在特定时间窗口内（例如，季节的前30天）有初级保健就诊记录、之前未接种[流感疫苗](@entry_id:165908)且当前无流感症状的65岁以上成年人。治疗策略可以是“在本次就诊时立即接种”与“推迟接种”。随访从就诊日（定义为“时间零点”）开始，持续固定的一段时间。

在模拟这一试验时，一个最关键的步骤是为每个合格个体设定一个统一的“时间零点”。在上述例子中，这个时间点就是合格的临床就诊日。所有人的随访都从这一刻开始计算。这种做法可以有效避免“永生时间偏倚”（immortal time bias）——这是一种常见的偏倚，当错误地将接种日期作为接种组的随访起点时，接种者在接种前的一段“永生”时间内（因为他们必须存活且未感染才能接种）被人为地排除在风险之外，从而导致对疫苗效果的高估。通过严格对齐时间零点，并使用如逆概率加权等高级统计方法来调[整基](@entry_id:190217)线混杂因素，我们可以从观察性数据中得到一个更可靠、更接[近因](@entry_id:149158)果效应的疫苗效果估计值。

#### 准实验设计：利用“自然实验”

在许多情况下，虽然无法进行真正的随机化，但政策实施或自然事件的发生为我们提供了“准实验”或“自然实验”的机会。

**[双重差分法](@entry_id:636293) (Difference-in-Differences, DiD)**

DiD是一种强大的[准实验方法](@entry_id:636714)，常用于评估大规模公共卫生干预（如疫苗接种项目）的效果。它利用了干预在不同地区或不同时间点推行的时间差。例如，假设一个地区（早期推广区）在某月开始实施疫苗接种计划，而另一个可比的地区（晚期推广区）则尚未开始。我们可以收集两个地区在计划实施前和实施后的发病率数据。

DiD的核心思想是，晚期推广区在干预前后的发病率变化，可以被看作是在没有干预的情况下，早期推广区本应发生的“平行趋势”。因此，早期推广区实际观察到的发病率变化，减去晚期推广区同期的发病率变化，其差值就可以被解释为疫苗计划的净效应。即：
$$
\text{效应} = (\text{早期区实施后} - \text{早期区实施前}) - (\text{晚期区实施后} - \text{晚期区实施前})
$$
这个估计量的有效性依赖于一个关键假设——“[平行趋势假设](@entry_id:633981)”，即在没有干预的情况下，两个地区的发病率会随时间以相同的方式变化。DiD方法通过巧妙地利用[对照组](@entry_id:188599)信息，剔除了共同的时间趋势，从而分离出干预的因果效应。

**回归断点设计 (Regression Discontinuity Design, RDD)**

RDD是另一种利用政策规则进行因果推断的强大工具。当一项干预措施的资格是基于某个连续变量（称为“驱动变量”）是否超过一个明确的“断点”时，就可以使用RDD。例如，一个疫苗接种计划可能规定，只有年龄达到或超过65岁的人才有资格免费接种。

在这种情况下，年龄就是驱动变量，65岁就是断点。RDD的核心逻辑是，年龄恰好在65岁左右（例如，64.9岁和65.1岁）的个体，在所有其他方面（如健康状况、社会经济地位等）都应是高度相似的，他们之间唯一的系统性差异就是是否刚好有资格获得疫苗。因此，通过比较断点两侧人群结局（如感染率）的微小跳跃或“不连续性”，我们就可以估计出疫苗在断点处的“局部因果效应”（Local Causal Effect）。这种方法的有效性依赖于一个核心假设，即除了干预本身，其他所有影响结局的因素在断点附近都是平滑连续变化的，并且个体无法精确地操控自己的驱动变量以进入自己想要的组别。对于年龄这样的驱动变量，这个假设通常是相当可信的。

#### G-方法：应对时变混杂

在长期观察性研究中，最复杂的挑战之一是处理“受过往治疗影响的时变混杂因素”（time-varying confounders affected by prior treatment）。以评估新冠疫苗的长期效果为例：个体在每个时间点（例如，每周）的感染史（$L(t)$）会影响其未来的接种决策（$A(t+1)$，例如，感染过的人可能会推迟接种）和未来的感染风险（$Y(t+1)$，例如，感染后获得短期免疫）。同时，过往的疫苗接种（$A(t)$）又会影响其未来的感染史（$L(t+1)$，因为疫苗能预防感染）。

这种“治疗-混杂-反馈”的复杂因果环路使得传统的回归调整方法（如在Cox模型中将感染史作为时变协变量）会产生偏倚。这是因为，当我们调整一个受过往治疗影响的变量时，我们可能无意中阻断了治疗的部分因果路径，或引入了选择偏倚（一种[对撞偏倚](@entry_id:163186)）。

为了解决这一难题，研究者发展了G-方法，其中最著名的是使用**逆概率加权（Inverse Probability Weighting, IPW）的边际结构模型（Marginal Structural Models, MSM）**。其基本思想是通过加权来创建一个“伪人群”。在这个伪人群中，每个时间点的治疗分配（疫苗接种）与测量的时变混杂因素（感染史）之间不再存在关联。具体来说，每个个体在每个时间点的权重，是其接受实际治疗概率的倒数。为了增加稳定性，通常使用“稳定权重”，其分子是基于基线变量的治疗概率，分母是基于完整历史（包括时变混杂因素）的治疗概率。
$$
w_i^{\text{trt}} = \prod_{t=0}^{T}\frac{P\big(A_i(t)\mid \bar{A}_i(t-1),X_i\big)}{P\big(A_i(t)\mid \bar{A}_i(t-1),\bar{L}_i(t),X_i\big)}
$$
在对数据进行加权后，我们就可以拟合一个“边际”模型（因为它不再需要调整时变混杂因素），例如一个加权的logistic回归模型，来估计疫苗效果随时间的变化 $VE(t)$。MSM是现代流行病学中处理复杂纵向数据因果推断的黄金标准之一。

### 跨学科交叉与专门化应用

疫苗效果的评估不仅是流行病学和统计学内部的议题，它还与传染病动力学、基因组学、[公共卫生政策](@entry_id:185037)等多个领域紧密相连。

#### 传染病动力学背景下的疫苗评估

**家庭传播研究**

家庭是研究[传染病](@entry_id:182324)传播的理想“微观实验室”。通过对家庭内部的传播链进行精细建模，我们可以将疫苗的保护效果分解为两个不同的部分：降低个体感染风险的能力，即对易感性的效果（Vaccine Efficacy for susceptibility, VEs）；以及降低已感染个体将病毒传染给他人风险的能力，即对传染性的效果（Vaccine Efficacy for infectiousness, VEi）。

链式二项分布模型（Chain-binomial model）是这类研究的经典工具，它将家庭内部的二次传播事件看作一系列独立的伯努利试验。通过构建一个能够同时包含VEs和VEi参数的[似然函数](@entry_id:141927)，并利用混合效应模型（例如，加入家庭层面的随机效应来解释家庭间的异质性），我们可以从家庭传播数据中同时估计出这两个参数。区分VEs和VEi对于理解疫苗的总体公共卫生影响至关重要，因为一个能显著降低传染性的疫苗，即使其对易感性的保护效果一般，也可能在阻断社区传播方面发挥巨大作用。

**比较针对不同变异株的疫苗效果**

当病原体（如SARS-CoV-2）不断进化，出现新的变异株时，一个紧迫的公共卫生问题是：现有疫苗对新变异株的保护效果如何？直接比较感染不同变异株人群的疫苗效果可能会受到严重混杂，因为变异株的流行、疫苗的覆盖率以及人群行为都随时间和地点剧烈变化。

“病例-病例设计”（case-case design）为解决此问题提供了一个巧妙的方案。该设计只关注确诊病例，通过比较感染变异株X的病例和感染变异株Y的病例之间的疫苗接种比值，来评估疫苗对两种变异株的相对保护效果。为了控制时空混杂，研究通常会进行匹配，例如，将每个感染X的病例与一个在同一天、同一地区确诊的感染Y的病例进行配对。

在这种设计下，计算出的匹配比值比（$OR_{matched}$）所估计的，不再是绝对的VE，而是两种变异株风险比的比值，即 $RR_X / RR_Y$。因为 $VE = 1 - RR$，所以这个比值也等于 $(1-VE_X)/(1-VE_Y)$。如果这个OR估计值小于1，则意味着 $RR_X  RR_Y$，即 $VE_X > VE_Y$，说明疫苗对变异株X的保护效果优于对Y的保护效果。这种方法巧妙地利用病例间的比较，为快速评估疫苗在[病原体进化](@entry_id:176826)背景下的相对性能提供了有力工具。

#### 疫苗结局的先进[统计模型](@entry_id:755400)

**[竞争风险分析](@entry_id:634319)**

在许多疫苗效果研究中，我们关心的结局（如住院）可能会被另一个事件（如未住院即康复）的发生所“阻碍”，这种情况被称为“竞争风险”（competing risks）。例如，一个感染者如果在家中康复了，他/她就不可能再经历“因本次感染而住院”这一结局。

在这种情况下，使用传统的生存分析方法（如[Kaplan-Meier曲线](@entry_id:178171)或标准的Cox比例风险模型）来估计结局的发生率可能会产生误导。这是因为这些方法通常会将竞争事件的发生处理为“删失”，这会违反其核心的独立删失假设，导致对结局累积发生率的错误估计。

正确的处理方法是采用竞争风险模型。其中，Fine-Gray模型是一种常用的[半参数模型](@entry_id:200031)，它直接对“子分布风险”（subdistribution hazard）进行建模。子分布风险考虑的是，在某个时间点，事件在那些至今尚未发生任何类型事件或已经发生了竞争事件的个体中的“瞬时发生率”。通过拟合Fine-Gray模型，我们可以得到疫苗接种对于我们关心的结局（例如住院）累积发生概率的影响，并由此计算出在存在[竞争风险](@entry_id:173277)情况下的疫苗效果。

#### 从数据到决策：公共卫生与政策应用

**实施科学与效力-效果差距**

疫苗在严格控制的RCT中表现出的高效力（efficacy），与其在真实世界常规使用条件下观察到的效果（effectiveness）之间常常存在差距，这被称为“效力-效果差距”。实施科学（Implementation Science）正是研究如何缩小这一差距的学科。

造成这种差距的因素多种多样，主要与“实施保真度”（fidelity）和“背景适配性”有关。例如，**冷链完整性**的破坏（疫苗在储存或运输过程中暴露于不当温度）可能导致疫苗抗原降解，[免疫原性](@entry_id:164807)下降；对**多剂次接种程序依从性**不佳（如延迟接种加强针）可能导致免疫反应未达到最优状态；疫苗抗原与社区**循环流行的病原株抗原不匹配**（抗原漂移）也会直接降低疫苗的生物学效果。理解并量化这些实施决定因素的影响，对于优化疫苗接种项目、最大化其公共卫生效益至关重要。

**优化疫苗接种策略**

疫苗效果的评估数据是公共卫生决策的关键依据，尤其是在资源有限的环境中。一个典型的决策困境是：在年度疫苗剂量固定的情况下，应该采用提供更高个体保护率的两剂次接种方案，还是采用个体保护率稍低但能覆盖更多人群的单剂次方案？

解决这个问题需要进行定量的权衡分析。我们需要分别计算两种策略下的有效覆盖率（$c$），并结合各自的疫苗效果（$VE$）。最终的公共卫生影响，尤其是对社区传播的阻断效果，更多地取决于群体免疫水平，而这又与 $VE \times c$ 的乘积成正比。通过计算[有效再生数](@entry_id:164900) $R_e \approx R_0 (1 - VE \times c)$，我们可以判断哪种策略更有可能将 $R_e$ 压低到1以下，从而实现对[疾病传播](@entry_id:170042)的控制。例如，对于HPV疫苗，在某些资源受限地区，尽管单剂次方案的个体保护率（如$VE_1=0.85$）略低于双剂次方案（如$VE_2=0.95$），但其能达到的覆盖率（$c_1$）远高于双剂次方案（$c_2$）。如果计算得出 $VE_1 \times c_1 > VE_2 \times c_2$，那么从群体角度出发，单剂次策略就是更优的选择。此外，免疫学数据（如[抗体滴度](@entry_id:181075)能否在长期内维持在保护阈值之上）也为这种策略选择提供了重要的生物学证据。

#### 上市后安全性监测

疫苗的评估是一个贯穿其整个生命周期的持续过程，除了有效性，安全性监测同样至关重要。在疫苗大规模使用后，需要有系统来近乎实时地监测罕见的潜在不良事件。

[序贯分析](@entry_id:176451)（Sequential Analysis）是此类监测的有力工具，其中最大化[序贯概率比检验](@entry_id:176474)（Maximized Sequential Probability Ratio Test, MaxSPRT）是一种常用方法。该方法将随时间累积的观测不良事件数（$C_t$）与基于背景发病率计算的期望数（$E_t$）进行比较。其检验统计量是一个最大化的[对数似然比](@entry_id:274622)：
$$
LLR_t = C_t \ln\left(\frac{C_t}{E_t}\right) - (C_t - E_t) \quad (\text{当 } C_t > E_t \text{ 时})
$$
这个统计量会随着新数据的到来而不断更新。一旦它超过了预先设定的、旨在控制I类错误率（即错误地发出安全警报的概率）的临界值 $h$（例如，$h = -\ln(\alpha)$），系统就会发出一个需要进一步调查的信号。这种方法能够在保证统计严谨性的同时，实现对潜在安全问题的早期预警。