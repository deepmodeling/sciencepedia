{
    "hands_on_practices": [
        {
            "introduction": "在启动一项随机对照试验之前，一个最基本也最关键的问题是：“我们需要多少参与者？” 样本量的大小直接决定了研究的成本、可行性以及最终能否可靠地检测出干预措施的真实效果。本练习将引导你从第一性原理出发，推导出计算样本量的核心公式，揭示研究效力（power）、预期效应大小（effect size）和所需样本量之间密不可分的统计学联系。",
            "id": "4628034",
            "problem": "考虑一项双臂随机对照试验，干预组和对照组等比例分配，在稳定的条件下，在统一的随访时间点为每位参与者评估一次二元结局。设 $p_0$ 表示对照组的真实事件概率，$p_1$ 表示干预组的真实事件概率。目标效应为风险差 $\\Delta = p_1 - p_0$，并假设该设计旨在检验原假设 $H_0: p_1 - p_0 = 0$ 与双侧备择假设 $H_1: p_1 - p_0 \\neq 0$，要求I类错误率为 $\\,\\alpha\\,$，并且在检测预设的非零风险差 $\\,\\Delta\\,$ 时达到 $\\,1 - \\beta\\,$ 的把握度（power）。\n\n使用以下基本原理：\n- 根据中心极限定理，在独立抽样下，对于每组 $n$ 名参与者，组别 $a \\in \\{0,1\\}$ 中的样本比例 $\\hat{p}_a$ 的大样本分布为 $\\hat{p}_a \\approx \\mathcal{N}\\!\\left(p_a,\\, p_a(1 - p_a)/n\\right)$，并且在等比例分配下，两组是独立的。\n- 由于独立性，样本比例之差 $D = \\hat{p}_1 - \\hat{p}_0$ 近似服从正态分布，其均值为 $p_1 - p_0$，方差为 $p_1(1 - p_1)/n + p_0(1 - p_0)/n$。\n- 对于 $H_0$ 的双侧 $\\alpha$-水平检验，使用标准正态分位数函数 $\\Phi^{-1}(\\cdot)$ 和设计阶段的原假设方差来设定拒绝阈值。设设计阶段的合并计划值为 $p_{\\ast} = (p_0 + p_1)/2$，则 $D$ 在原假设下的标准差为 $\\sqrt{2\\,p_{\\ast}(1 - p_{\\ast})/n}$。\n\n从这些基本原理出发，并且不使用任何预先记忆的样本量公式，推导在等比例分配下，为确保I类错误率为 $\\,\\alpha\\,$、把握度为 $\\,1 - \\beta\\,$ 来检测风险差 $\\Delta$ 时，所需每组样本量 $n$ 的闭式解析表达式（结果无需为整数；忽略任何取整）。最终答案必须表示为关于 $p_0$、$p_1$、$\\alpha$、$\\beta$、$\\Delta$ 和标准正态分位数函数 $\\Phi^{-1}(\\cdot)$ 的单个解析表达式。可以假设 $\\Delta \\neq 0$。不需要进行数值计算，也不需要取整。答案必须是每组的样本量。",
            "solution": "该问题陈述是生物统计学领域一个有效且定义明确的问题，具体涉及随机对照试验的设计。它提供了一套完整且一致的已知条件和假设，可以从中推导出唯一的解析解。\n\n### 第 1 步：提取已知条件\n-   **研究设计**：双臂随机对照试验，等比例分配（每组 $n$ 名参与者）。\n-   **结局**：二元变量。\n-   **参数**：$p_0$ 为对照组的真实事件概率；$p_1$ 为干预组的真实事件概率。\n-   **效应量**：风险差，$\\Delta = p_1 - p_0$。\n-   **假设**：原假设 $H_0: p_1 - p_0 = 0$；备择假设 $H_1: p_1 - p_0 \\neq 0$。\n-   **错误率**：I 类错误率为 $\\alpha$；II 类错误率为 $\\beta$，对应把握度为 $1 - \\beta$。\n-   **分布假设**：\n    1.  组别 $a \\in \\{0,1\\}$ 中的样本比例，记为 $\\hat{p}_a$，近似服从正态分布：$\\hat{p}_a \\sim \\mathcal{N}(p_a, \\frac{p_a(1-p_a)}{n})$。\n    2.  样本比例之差 $D = \\hat{p}_1 - \\hat{p}_0$ 近似服从正态分布：$D \\sim \\mathcal{N}(p_1 - p_0, \\frac{p_1(1-p_1)}{n} + \\frac{p_0(1-p_0)}{n})$。\n-   **检验构建**：\n    1.  该检验使用标准正态分位数函数 $\\Phi^{-1}(\\cdot)$。\n    2.  在设计阶段，$D$ 在原假设下的方差基于计划值 $p_{\\ast} = (p_0 + p_1)/2$ 计算，得出 $D$ 在 $H_0$ 下的标准差为 $\\sqrt{2 p_{\\ast}(1-p_{\\ast})/n}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于完善的统计理论，即使用正态近似二项分布来比较两个比例，这是设计临床试验的一个基本概念。\n-   **定义明确**：该问题定义清晰，提供了推导所需样本量 $n$ 的所有必要参数（$\\alpha, \\beta, p_0, p_1$）和分布基础。说明明确，可以导出一个唯一的解。\n-   **客观性**：语言正式、精确，没有任何主观性或歧义。\n\n该问题满足一个严谨科学问题的所有标准，是有效的。\n\n### 样本量公式的推导\n\n目标是推导满足指定的 I 类和 II 类错误率约束的每组样本量 $n$ 的表达式。推导过程从给定的第一性原理出发。\n\n**1. I 类错误与拒绝法则**\n\n原假设为 $H_0: \\Delta = p_1 - p_0 = 0$。检验统计量是观察到的比例差 $D = \\hat{p}_1 - \\hat{p}_0$。\n\n根据问题陈述，为了试验设计的目的，$D$ 在 $H_0$ 下的分布被视为近似正态分布，均值为 $0$，方差为 $\\text{Var}_0(D)$，该方差使用计划值 $p_{\\ast} = (p_0 + p_1)/2$ 构建。\n$$ \\text{Var}_0(D) = \\frac{2 p_{\\ast}(1 - p_{\\ast})}{n} = \\frac{2 \\left(\\frac{p_0+p_1}{2}\\right) \\left(1 - \\frac{p_0+p_1}{2}\\right)}{n} $$\n对于 I 类错误率为 $\\alpha$ 的双侧检验，如果观察到的差异 $|D|$ 大于某个临界值 $C$，我们就拒绝 $H_0$。这个临界值由原假设分布的尾部确定。在 $H_0$ 下的标准化统计量为 $Z = D / \\sqrt{\\text{Var}_0(D)}$。如果 $|Z| > \\Phi^{-1}(1 - \\alpha/2)$，我们则拒绝原假设。\n这意味着对于非标准化的差异 $D$，其拒绝域为 $|D| > C$，其中：\n$$ C = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\text{Var}_0(D)} = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\frac{2 p_{\\ast}(1 - p_{\\ast})}{n}} $$\n\n**2. II 类错误与把握度**\n\n把握度是在备择假设 $H_1$ 为真时正确拒绝 $H_0$ 的概率。在 $H_1$ 下，真实差异为 $\\Delta = p_1 - p_0 \\neq 0$。\n\n$D$ 在 $H_1$ 下的分布近似为正态分布，均值为 $\\Delta$，方差为 $\\text{Var}_1(D)$：\n$$ D \\sim \\mathcal{N}\\left(\\Delta, \\text{Var}_1(D)\\right) \\quad \\text{其中} \\quad \\text{Var}_1(D) = \\frac{p_1(1-p_1)}{n} + \\frac{p_0(1-p_0)}{n} $$\n把握度 $1 - \\beta$ 是 $D$ 落在拒绝域的概率，即 $P(|D| > C | H_1)$。\n$$ 1 - \\beta = P(D > C | H_1) + P(D  -C | H_1) $$\n假设 $\\Delta  0$（$\\Delta  0$ 的情况是对称的），对于一个有足够把握度的研究，项 $P(D  -C | H_1)$ 通常可以忽略不计，因为 $D$ 的分布中心远离 $-C$。因此，我们可以用第一项来近似把握度：\n$$ 1 - \\beta \\approx P(D  C | H_1) $$\n为了计算这个概率，我们使用 $D$ 在 $H_1$ 下的分布对其进行标准化：\n$$ 1 - \\beta \\approx P\\left( \\frac{D - \\Delta}{\\sqrt{\\text{Var}_1(D)}}  \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} \\right) $$\n概率内部左侧的项是一个标准正态变量，$Z \\sim \\mathcal{N}(0,1)$。\n$$ P\\left( Z  \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} \\right) = 1 - \\beta $$\n根据标准正态累积分布函数 $\\Phi$ 的定义，这意味着：\n$$ \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} = \\Phi^{-1}(1 - (1-\\beta)) = \\Phi^{-1}(\\beta) $$\n求解临界值 $C$，我们得到了它的第二个表达式，这次是根据把握度的要求得出的：\n$$ C = \\Delta + \\Phi^{-1}(\\beta) \\sqrt{\\text{Var}_1(D)} $$\n\n**3. 求解样本量 n**\n\n我们现在有两个关于临界值 $C$ 的表达式，一个来自 I 类错误率约束，另一个来自把握度约束。通过令它们相等，我们可以求解 $n$。\n$$ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\text{Var}_0(D)} = \\Delta + \\Phi^{-1}(\\beta) \\sqrt{\\text{Var}_1(D)} $$\n代入方差的表达式，它们都依赖于 $1/\\sqrt{n}$：\n$$ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\frac{\\sqrt{2 p_{\\ast}(1 - p_{\\ast})}}{\\sqrt{n}} = \\Delta + \\Phi^{-1}(\\beta) \\frac{\\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\sqrt{n}} $$\n重新整理方程以分离出 $\\Delta$：\n$$ \\Delta = \\frac{1}{\\sqrt{n}} \\left[ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} - \\Phi^{-1}(\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)} \\right] $$\n利用标准正态分位数函数的对称性，$\\Phi^{-1}(\\beta) = -\\Phi^{-1}(1-\\beta)$：\n$$ \\Delta = \\frac{1}{\\sqrt{n}} \\left[ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)} \\right] $$\n现在，我们求解 $\\sqrt{n}$，然后将结果平方得到 $n$：\n$$ \\sqrt{n} = \\frac{\\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\Delta} $$\n$$ n = \\left( \\frac{\\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\Delta} \\right)^2 $$\n代入 $p_{\\ast} = (p_0+p_1)/2$ 的定义，并将表达式写成一个单独的分数，就得到了每组样本量 $n$ 的最终闭式表达式。\n$$ n = \\frac{\\left( \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 \\left(\\frac{p_0+p_1}{2}\\right)\\left(1 - \\frac{p_0+p_1}{2}\\right)} + \\Phi^{-1}(1-\\beta) \\sqrt{p_0(1-p_0) + p_1(1-p_1)} \\right)^2}{\\Delta^2} $$\n该表达式提供了所需每组样本量，它是关于指定参数 $p_0$、$p_1$、$\\alpha$、$\\beta$ 和风险差 $\\Delta = p_1-p_0$ 的函数。",
            "answer": "$$ \\boxed{ \\frac{\\left( \\Phi^{-1}\\left(1-\\frac{\\alpha}{2}\\right) \\sqrt{2 \\left(\\frac{p_0+p_1}{2}\\right) \\left(1 - \\frac{p_0+p_1}{2}\\right)} + \\Phi^{-1}(1-\\beta) \\sqrt{p_0(1-p_0) + p_1(1-p_1)} \\right)^{2}}{\\Delta^{2}} } $$"
        },
        {
            "introduction": "当试验数据收集完毕后，我们的核心任务是量化干预措施的效果。本练习将使用一组假设的试验数据，带你计算三种最核心的效应量指标：风险差（Risk Difference）、风险比（Risk Ratio）和比值比（Odds Ratio）。通过这个过程，你不仅会掌握它们的计算方法，还将探索它们一个重要但更精细的统计学特性——可坍缩性（collapsibility），理解为什么在不同情况下选择合适的效应指标至关重要。",
            "id": "4628160",
            "problem": "一项随机对照试验 (RCT) 评估了一项旨在减少二元结局的预防性干预措施。在随机分配到干预组的 $1000$ 名参与者中，有 $100$ 人出现了该结局。在随机分配到对照组的 $1000$ 名参与者中，有 $150$ 人出现了该结局。从流行病学的基本原理出发，使用概率、比值和随机化所致独立性的核心定义，根据观测数据推导并计算以下群体效应度量：风险差、风险比和比值比。然后，根据可坍缩性（在随机化且无效应修正的情况下，边际效应等于共同的层特异性效应）的定义进行推理，以确定在这三种度量中，哪一种在随机分配且无未测量混杂因素的背景下是可坍缩的。将最终答案表示为一个行矩阵，顺序为 $[\\text{风险差}, \\text{风险比}, \\text{比值比}, I_{\\text{RD}}, I_{\\text{RR}}, I_{\\text{OR}}]$，其中如果度量是可坍缩的，$I_{\\text{RD}}$、$I_{\\text{RR}}$ 和 $I_{\\text{OR}}$ 是取值为 $1$ 的指示变量，否则取值为 $0$。如果可能，以精确分数形式提供风险差、风险比和比值比；如果选择提供小数近似值，则四舍五入到 $4$ 位有效数字。不涉及物理单位；所有量均以无量纲数报告。",
            "solution": "该问题是有效的，因为它在流行病学和生物统计学原理上具有科学依据，信息充分、一致且定义明确，并且陈述客观。\n\n设 $X$ 表示治疗分配，其中 $X=1$ 代表干预组，$X=0$ 代表对照组。设 $Y$ 表示二元结局，其中 $Y=1$ 代表结局发生，$Y=0$ 代表结局未发生。该问题提供了一项随机对照试验 (RCT) 的以下数据：\n对于干预组 ($X=1$)：\n- 参与者人数：$N_1 = 1000$\n- 出现结局的人数：$A_1 = 100$\n- 未出现结局的人数：$B_1 = N_1 - A_1 = 1000 - 100 = 900$\n\n对于对照组 ($X=0$)：\n- 参与者人数：$N_0 = 1000$\n- 出现结局的人数：$A_0 = 150$\n- 未出现结局的人数：$B_0 = N_0 - A_0 = 1000 - 150 = 850$\n\n任务是推导并计算三种效应度量（风险差、风险比、比值比）并确定它们的可坍缩性。\n\n首先，我们定义各组中结局的风险（概率）。风险是在给定治疗分配下结局发生的条件概率，$P(Y=1|X=x)$。在随机对照试验中，这些概率可以直接从各组的观测比例中估计。\n\n干预组的风险估计为：\n$$ \\hat{R}_1 = \\frac{A_1}{N_1} = \\frac{100}{1000} = \\frac{1}{10} $$\n对照组的风险估计为：\n$$ \\hat{R}_0 = \\frac{A_0}{N_0} = \\frac{150}{1000} = \\frac{15}{100} = \\frac{3}{20} $$\n\n**第一部分：效应度量的计算**\n\n1.  **风险差 (RD)**：风险差是两组风险之间的算术差异。\n    $$ RD = R_1 - R_0 $$\n    使用样本估计值：\n    $$ \\hat{RD} = \\hat{R}_1 - \\hat{R}_0 = \\frac{1}{10} - \\frac{3}{20} = \\frac{2}{20} - \\frac{3}{20} = -\\frac{1}{20} $$\n\n2.  **风险比 (RR)**：风险比是两组风险的比率。\n    $$ RR = \\frac{R_1}{R_0} $$\n    使用样本估计值：\n    $$ \\hat{RR} = \\frac{\\hat{R}_1}{\\hat{R}_0} = \\frac{1/10}{3/20} = \\frac{1}{10} \\times \\frac{20}{3} = \\frac{20}{30} = \\frac{2}{3} $$\n\n3.  **比值比 (OR)**：首先，我们将结局的比值定义为结局发生的概率与不发生的概率之比。\n    $$ \\text{Odds}(x) = \\frac{P(Y=1|X=x)}{P(Y=0|X=x)} = \\frac{R_x}{1-R_x} $$\n    比值比是干预组的比值与对照组的比值之比。\n    $$ OR = \\frac{\\text{Odds}(1)}{\\text{Odds}(0)} = \\frac{R_1 / (1-R_1)}{R_0 / (1-R_0)} $$\n    样本比值为：\n    $$ \\hat{\\text{Odds}}_1 = \\frac{\\hat{R}_1}{1-\\hat{R}_1} = \\frac{1/10}{1 - 1/10} = \\frac{1/10}{9/10} = \\frac{1}{9} $$\n    $$ \\hat{\\text{Odds}}_0 = \\frac{\\hat{R}_0}{1-\\hat{R}_0} = \\frac{3/20}{1 - 3/20} = \\frac{3/20}{17/20} = \\frac{3}{17} $$\n    样本比值比为：\n    $$ \\hat{OR} = \\frac{\\hat{\\text{Odds}}_1}{\\hat{\\text{Odds}}_0} = \\frac{1/9}{3/17} = \\frac{1}{9} \\times \\frac{17}{3} = \\frac{17}{27} $$\n    或者，比值比可以从 $2 \\times 2$ 列联表中计算交叉乘积比得到：\n    $$ \\hat{OR} = \\frac{A_1 B_0}{A_0 B_1} = \\frac{100 \\times 850}{150 \\times 900} = \\frac{85000}{135000} = \\frac{85}{135} = \\frac{17}{27} $$\n\n**第二部分：可坍缩性分析**\n\n可坍缩性指的是，在各层之间没有效应修正的情况下，边际（粗略）效应度量等于共同的层特异性效应度量的性质。分层是通过第三个变量（比如 $Z$）进行的。问题指明了‘随机分配且无未测量混杂因素’和‘无效应修正’的背景。\n\n设 $Z$ 是一个基线协变量（例如，年龄、性别），其水平为 $k=1, 2, \\dots, K$。\n组 $x$ 的边际风险为 $R_x = P(Y=1|X=x)$。根据全概率定律，我们可以将其按 $Z$ 的分层展开：\n$$ R_x = \\sum_{k=1}^{K} P(Y=1|X=x, Z=k) P(Z=k|X=x) $$\n设 $R_{xk} = P(Y=1|X=x, Z=k)$ 为层特异性风险。\n在随机对照试验中，随机化确保了治疗分配 $X$ 与任何基线协变量 $Z$ 统计独立。因此，对于所有 $x$，$P(Z=k|X=x) = P(Z=k)$。设 $p_k = P(Z=k)$。\n边际风险是层特异性风险的加权平均值：\n$$ R_1 = \\sum_{k} R_{1k} p_k $$\n$$ R_0 = \\sum_{k} R_{0k} p_k $$\n‘无效应修正’的条件意味着效应度量在 $Z$ 的各层中是恒定的。\n\n- **风险差 (RD)**：\n  边际 RD 为 $RD = R_1 - R_0$。层特异性 RD 为 $RD_k = R_{1k} - R_{0k}$。\n  ‘无效应修正’的条件意味着对所有 $k$ 都有 $RD_k = RD_{\\text{common}}$。\n  $$ RD = R_1 - R_0 = \\sum_{k} R_{1k} p_k - \\sum_{k} R_{0k} p_k = \\sum_{k} (R_{1k} - R_{0k}) p_k = \\sum_{k} RD_k p_k $$\n  代入 $RD_k = RD_{\\text{common}}$：\n  $$ RD = \\sum_{k} RD_{\\text{common}} p_k = RD_{\\text{common}} \\sum_{k} p_k = RD_{\\text{common}} \\times 1 = RD_{\\text{common}} $$\n  边际 RD 等于共同的层特异性 RD。因此，风险差是可坍缩的。$I_{\\text{RD}} = 1$。\n\n- **风险比 (RR)**：\n  边际 RR 为 $RR = R_1 / R_0$。层特异性 RR 为 $RR_k = R_{1k} / R_{0k}$。\n  ‘无效应修正’的条件意味着对所有 $k$ 都有 $RR_k = RR_{\\text{common}}$，因此 $R_{1k} = RR_{\\text{common}} \\times R_{0k}$。\n  $$ RR = \\frac{R_1}{R_0} = \\frac{\\sum_{k} R_{1k} p_k}{\\sum_{k} R_{0k} p_k} $$\n  代入 $R_{1k} = RR_{\\text{common}} R_{0k}$：\n  $$ RR = \\frac{\\sum_{k} (RR_{\\text{common}} R_{0k}) p_k}{\\sum_{k} R_{0k} p_k} = \\frac{RR_{\\text{common}} \\sum_{k} R_{0k} p_k}{\\sum_{k} R_{0k} p_k} = RR_{\\text{common}} $$\n  边际 RR 等于共同的层特异性 RR。因此，风险比是可坍缩的。$I_{\\text{RR}} = 1$。\n\n- **比值比 (OR)**：\n  边际 OR 为 $OR = \\frac{R_1/(1-R_1)}{R_0/(1-R_0)}$。层特异性 OR 为 $OR_k = \\frac{R_{1k}/(1-R_{1k})}{R_{0k}/(1-R_{0k})}$。\n  ‘无效应修正’的条件意味着对所有 $k$ 都有 $OR_k = OR_{\\text{common}}$。\n  比值函数 $f(p) = p/(1-p)$ 是一个非线性函数。由于这种非线性，风险的加权平均值不能简单地转换为比值的形式。边际比值为：\n  $$ \\text{Odds}_1 = \\frac{\\sum_k R_{1k}p_k}{1 - \\sum_k R_{1k}p_k} \\quad \\text{和} \\quad \\text{Odds}_0 = \\frac{\\sum_k R_{0k}p_k}{1 - \\sum_k R_{0k}p_k} $$\n  根据詹森不等式，对于一个非线性函数 $f$，$f(E[X]) \\neq E[f(X)]$。在这里，边际风险 $R_x$ 是层特异性风险 $R_{xk}$ 在 $Z$ 的分布上的期望值。因此，边际比值 $\\text{Odds}_x = f(R_x) = f(E[R_{xk}])$ 不等于层特异性比值的加权平均值 $E[f(R_{xk})] = \\sum_k f(R_{xk}) p_k$。\n  因此，边际比值比 $OR = \\text{Odds}_1 / \\text{Odds}_0$ 通常不等于共同的层特异性比值比 $OR_{\\text{common}}$，除非 $Z$ 不是结局的风险因素（即 $R_{0k}$ 在 $k$ 上是常数）或者治疗无效 ($OR_{\\text{common}}=1$)。由于这些例外情况通常不成立，比值比是不可坍缩的。$I_{\\text{OR}} = 0$。\n\n综合结果，最终值为：\n- 风险差：$-\\frac{1}{20}$\n- 风险比：$\\frac{2}{3}$\n- 比值比：$\\frac{17}{27}$\n- $I_{\\text{RD}} = 1$ (可坍缩)\n- $I_{\\text{RR}} = 1$ (可坍缩)\n- $I_{\\text{OR}} = 0$ (不可坍缩)\n\n最终答案将以行矩阵的形式呈现。\n$$\n\\begin{pmatrix}\n-\\frac{1}{20}  \\frac{2}{3}  \\frac{17}{27}  1  1  0\n\\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{20}  \\frac{2}{3}  \\frac{17}{27}  1  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个好的研究不仅要得出结论，更要让结果易于理解并诚实地呈现其不确定性。本练习将介绍一个非常直观的临床指标——需治数（Number Needed to Treat, NNT），它将抽象的风险降低转化为一个具体的数字。更重要的是，我们将深入探讨如何为 NNT 构建置信区间，并解释为什么简单对称的区间估计可能是错误的，从而强调在结果报告中严谨处理不确定性的重要性。",
            "id": "4628182",
            "problem": "一项平行双臂随机对照试验 (RCT) 评估了一项旨在减少不良结局的干预措施。在治疗组中， $n_{T} = 500$ 名参与者被随机分配，其中 $x_{T} = 60$ 名经历了该结局。在对照组中， $n_{C} = 500$ 名参与者被随机分配，其中 $x_{C} = 100$ 名经历了该结局。仅使用独立二项式抽样下的风险和抽样变异性的基本定义，完成以下任务：\n\n1. 从第一性原理出发，定义适用于减少不良结局的有益干预的各组特定风险 $p_{T}$ 和 $p_{C}$、风险差 $RD$ 以及绝对风险降低 $\\Delta$。然后，计算作为绝对风险降低倒数的需治数 (NNT)。将 NNT 表示为患者计数，并将您的数值答案四舍五入至三位有效数字。\n\n2. 在两组结局为独立伯努利试验的假设下，推导估计风险差的大样本方差，并解释此方差如何通过 delta 方法与 NNT 的变异性相关联。提供 NNT 近似标准误的符号表达式，用 $\\Delta$、$p_{T}$、$p_{C}$、$n_{T}$ 和 $n_{C}$ 表示。\n\n3. 简要说明为什么基于 delta 方法的 NNT 朴素对称置信区间可能不适用，并提出一种区间估计策略，该策略通过反转风险差的双侧置信区间（例如，基于比例差的得分法或 Wilson 型方法）来构建 NNT 的置信区间。陈述当干预有益时（即当 $\\Delta  0$ 时），将风险差区间的端点映射到 NNT 区间端点的闭式变换。不要计算任何数值区间端点。\n\n将任何所需的数值四舍五入至三位有效数字。如果需要单位，请将 NNT 以患者为单位表示。百分比必须以小数或分数形式表示，不得使用百分号。",
            "solution": "该问题陈述已经过验证，被认为是科学可靠、问题明确且客观的。它呈现了一个基于随机对照试验数据的标准生物统计分析场景。所有必要信息均已提供，问题内部一致，并可使用流行病学和统计学的既定原则解决。\n\n### 第 1 部分：NNT 的定义和计算\n\n从第一性原理出发，我们定义各组特定风险及相关度量。设 $p_{T}$ 为治疗组中不良结局的真实概率， $p_{C}$ 为对照组中的真实概率。这些是总体参数。问题提供了样本数据，我们可以据此估计这些风险。\n\n治疗组风险的点估计量由样本比例给出：\n$$ \\hat{p}_{T} = \\frac{x_{T}}{n_{T}} = \\frac{60}{500} = 0.12 $$\n对照组风险的点估计量为：\n$$ \\hat{p}_{C} = \\frac{x_{C}}{n_{C}} = \\frac{100}{500} = 0.20 $$\n\n风险差 ($RD$) 定义为治疗组风险与对照组风险之差：\n$$ RD = p_{T} - p_{C} $$\n其点估计为 $\\widehat{RD} = \\hat{p}_{T} - \\hat{p}_{C} = 0.12 - 0.20 = -0.08$。\n\n绝对风险降低 ($\\Delta$) 是为有益干预定义的，其中风险被降低。因此，它是对照组风险与治疗组风险之差：\n$$ \\Delta = p_{C} - p_{T} $$\n绝对风险降低的点估计为：\n$$ \\hat{\\Delta} = \\hat{p}_{C} - \\hat{p}_{T} = 0.20 - 0.12 = 0.08 $$\n这个正值表明，观察到的治疗组风险低于对照组，这与有益干预相符。\n\n需治数 (NNT) 定义为绝对风险降低的倒数。它表示与对照组相比，为预防一例额外的不良结局，需要用该干预措施治疗的估计患者数。\n$$ NNT = \\frac{1}{\\Delta} $$\nNNT 的点估计使用估计的绝对风险降低来计算：\n$$ \\widehat{NNT} = \\frac{1}{\\hat{\\Delta}} = \\frac{1}{0.08} = 12.5 $$\n问题要求将其表示为患者计数，并四舍五入至三位有效数字。计算出的值 $12.5$ 已经有三位有效数字。因此，估计的 NNT 是 $12.5$ 名患者。通常，NNT 常常向上取整到下一个整数，但根据明确的指示，该值为 $12.5$。\n\n### 第 2 部分：NNT 的方差推导和标准误\n\n估计风险差的大样本方差的推导假设两组的结局是独立的伯努利试验。每组的事件数 $x_{T}$ 和 $x_{C}$ 服从二项分布：\n$$ x_{T} \\sim \\text{Binomial}(n_{T}, p_{T}) \\quad \\text{and} \\quad x_{C} \\sim \\text{Binomial}(n_{C}, p_{C}) $$\n样本比例 $\\hat{p} = x/n$ 的方差是 $\\text{Var}(\\hat{p}) = \\frac{p(1-p)}{n}$。因此，各组特定风险估计量的方差为：\n$$ \\text{Var}(\\hat{p}_{T}) = \\frac{p_{T}(1-p_{T})}{n_{T}} \\quad \\text{and} \\quad \\text{Var}(\\hat{p}_{C}) = \\frac{p_{C}(1-p_{C})}{n_{C}} $$\n估计的绝对风险降低是 $\\hat{\\Delta} = \\hat{p}_{C} - \\hat{p}_{T}$。由于两个试验组是独立的，估计量之差的方差是它们各自方差的和：\n$$ \\text{Var}(\\hat{\\Delta}) = \\text{Var}(\\hat{p}_{C} - \\hat{p}_{T}) = \\text{Var}(\\hat{p}_{C}) + \\text{Var}(\\hat{p}_{T}) = \\frac{p_{C}(1-p_{C})}{n_{C}} + \\frac{p_{T}(1-p_{T})}{n_{T}} $$\n这就是估计风险差的大样本方差。\n\n为了找到 NNT 的变异性，我们使用 delta 方法。NNT 是绝对风险降低的非线性函数， $g(\\Delta) = 1/\\Delta$。Delta 方法为随机变量函数的方差提供了一阶泰勒级数近似。对于函数 $g(Y)$，其近似方差为 $\\text{Var}(g(Y)) \\approx [g'(E[Y])]^{2} \\text{Var}(Y)$。\n在我们的例子中， $Y = \\hat{\\Delta}$， $E[Y] = \\Delta$，函数是 $g(\\Delta) = 1/\\Delta$。其导数为：\n$$ g'(\\Delta) = \\frac{d}{d\\Delta}\\left(\\frac{1}{\\Delta}\\right) = -\\frac{1}{\\Delta^{2}} $$\n应用 delta 方法，$\\widehat{NNT}$ 的近似方差是：\n$$ \\text{Var}(\\widehat{NNT}) \\approx [g'(\\Delta)]^{2} \\text{Var}(\\hat{\\Delta}) = \\left(-\\frac{1}{\\Delta^{2}}\\right)^{2} \\text{Var}(\\hat{\\Delta}) = \\frac{1}{\\Delta^{4}} \\text{Var}(\\hat{\\Delta}) $$\n标准误 (SE) 是方差的平方根。因此，NNT 近似标准误的符号表达式为：\n$$ \\text{SE}(\\widehat{NNT}) \\approx \\sqrt{\\frac{1}{\\Delta^{4}} \\text{Var}(\\hat{\\Delta})} = \\frac{1}{\\Delta^{2}} \\sqrt{\\text{Var}(\\hat{\\Delta})} $$\n代入 $\\text{Var}(\\hat{\\Delta})$ 的表达式，得到最终的符号表达式：\n$$ \\text{SE}(\\widehat{NNT}) \\approx \\frac{1}{\\Delta^{2}} \\sqrt{\\frac{p_{C}(1-p_{C})}{n_{C}} + \\frac{p_{T}(1-p_{T})}{n_{T}}} $$\n在实践中，未知的参数 $\\Delta$、$p_{C}$ 和 $p_{T}$ 将被它们的样本估计值 $\\hat{\\Delta}$、$\\hat{p}_{C}$ 和 $\\hat{p}_{T}$ 替换，以计算标准误的数值。\n\n### 第 3 部分：NNT 的置信区间\n\n一个朴素的、构造为 $\\widehat{NNT} \\pm z_{\\alpha/2} \\times \\text{SE}(\\widehat{NNT})$ 的 NNT 对称置信区间是不适用的，原因有以下几个基本方面：\n1.  **非线性与偏度**：关系式 $NNT = 1/\\Delta$ 是高度非线性的。对于大样本，$\\hat{\\Delta}$ 的抽样分布可能近似正态分布，但 $1/\\hat{\\Delta}$ 的分布并非如此。它是高度偏斜的，尤其是在 $\\Delta$ 接近 $0$ 时，这使得基于正态近似的对称区间无效。\n2.  **边界问题**：当 $\\hat{\\Delta}$ 趋近于 $0$ 时，$\\widehat{NNT}$ 趋近于 $\\pm\\infty$。使用 delta 方法计算的对称置信区间可能产生无意义的结果。例如，即使点估计为正值并表明有益，该区间也可能包含负值，从而错误地暗示了需害数。它也可能包含 $0$，这对 NNT 来说是不可解释的。\n3.  **风险差区间包含零**：如果风险差 $\\Delta$ 的置信区间包含 $0$（即，结果不具有统计显著性），那么对应的 NNT 置信区间在逻辑上应该从某个 NNT 值延伸到 $\\infty$，并从 $-\\infty$ 延伸到某个 NNH（需害数）值。一个简单的对称区间无法表示这种不连续的范围。\n\n一个更稳健和适用的策略是首先为风险差 $\\Delta$ 构建一个置信区间，然后变换其端点以获得 NNT 的置信区间。这被称为反转法。\n其步骤如下：\n1.  为 $\\Delta = p_{C} - p_{T}$ 计算一个 $(1-\\alpha)$ 置信区间。设该区间为 $[L_{\\Delta}, U_{\\Delta}]$。最好使用对比例表现良好的方法，例如差值的 Wilson 得分区间法，而不是更简单的 Wald 区间法，尤其是在比例接近 $0$ 或 $1$ 或者样本量中等的情况下。\n2.  将变换 $g(\\Delta) = 1/\\Delta$ 应用于端点 $L_{\\Delta}$ 和 $U_{\\Delta}$。\n\n问题要求给出当干预有益时（$\\Delta  0$）的闭式变换。在这种情况下，我们考虑风险差的置信区间完全为正的情况，即 $0  L_{\\Delta} \\leq U_{\\Delta}$。函数 $f(x) = 1/x$ 在 $x > 0$ 时是严格递减函数。因此，该变换会反转端点的顺序。$\\Delta$ 的上界成为 NNT 的下界，而 $\\Delta$ 的下界成为 NNT 的上界。\n\n因此，将风险差区间 $[L_{\\Delta}, U_{\\Delta}]$ 的端点映射到 NNT 区间端点的闭式变换是：\n$$ \\text{CI}_{NNT} = \\left[ \\frac{1}{U_{\\Delta}}, \\frac{1}{L_{\\Delta}} \\right] $$\n该方法正确地处理了非线性和不对称性，产生一个在哲学上和数学上比朴素对称方法更连贯的区间。如果 $\\Delta$ 的区间跨越了 $0$，例如 $L_{\\Delta}  0  U_{\\Delta}$，该方法会正确地得出 NNT 的一个不连续区间，即 $(-\\infty, 1/L_{\\Delta}] \\cup [1/U_{\\Delta}, \\infty)$，这反映了不显著的结果。",
            "answer": "$$\n\\boxed{12.5}\n$$"
        }
    ]
}