{
    "hands_on_practices": [
        {
            "introduction": "固定区组随机化是维持治疗组间平衡的常用方法。然而，如果研究者知道了区组的大小，会发生什么呢？本练习  通过一个简单的计算来揭示该设计的一个关键弱点，展示了一个区组中的最终分配如何变得完全可预测，从而破坏分配隐藏。",
            "id": "4570947",
            "problem": "一项双臂随机对照试验 (RCT) 采用区组大小为 $4$ 的置换区组随机化方法，且每个区组内部分配均等。等比例分配强制要求每个区组恰好包含 $2$ 个分配给治疗组 $T$ 的名额和 $2$ 个分配给对照组 $C$ 的名额。随机化过程定义为对多重集 $\\{T, T, C, C\\}$ 形成的所有不同序列进行均匀随机置换，因此每个允许的区组序列都具有相等的概率。\n\n考虑一名招募者，他知道区组大小为 $4$、等比例分配的约束（每个区组 $2$ 个 $T$ 和 $2$ 个 $C$）以及序列是如上所述均匀置换的，但他无法接触到隐藏的序列本身。该招募者实时观察一个给定区组的前 $3$ 次分配，并试图在第四次分配揭晓前对其进行预测。\n\n仅使用随机化和条件概率的基本定义，并且不假定超出所述设计之外的任何额外信息，计算在观察到区组内前 $3$ 次分配的情况下，招募者能够正确预测第四次分配的概率。请将最终答案表示为单个实数。无需四舍五入。",
            "solution": "本题要求计算，在给定试验设计参数的情况下，一名招募者能够正确预测一个大小为 $4$ 的置换区组中第四次也是最后一次分配的概率。\n\n令 $T$ 表示治疗组分配，$C$ 表示对照组分配。题目说明每个区组的大小固定为 $4$，且恰好由 $2$ 个分配给 $T$ 的名额和 $2$ 个分配给 $C$ 的名额组成。因此，任何区组的元素集合都是多重集 $\\{T, T, C, C\\}$。\n\n随机化过程包括对这些元素进行均匀随机置换。可以形成的不同序列（区组）的总数由多项式系数给出：\n$$N = \\binom{4}{2, 2} = \\frac{4!}{2! \\cdot 2!} = \\frac{24}{4} = 6$$\n由于置换是均匀的，这 $6$ 个不同的序列中每一个被选中的概率都相等，即 $P(\\text{sequence}) = \\frac{1}{6}$。这 $6$ 种可能的序列是：\n$1$. $TTCC$\n$2$. $TCTC$\n$3$. $TCCT$\n$4$. $CTTC$\n$5$. $CTCT$\n$6$. $CCTT$\n\n招募者知道区组大小（$4$）和分配规则（$2$ 个 $T$ 和 $2$ 个 $C$）。招募者的任务是在观察到前三次分配 $(a_1, a_2, a_3)$ 后，预测第四次分配，记为 $a_4$。\n\n令 $E$ 为招募者对第四次分配的预测是正确的事件。我们要求计算概率 $P(E)$。一个理性的招募者会利用所有可用的信息来做出最佳预测。这些信息包括观察到的序列 $(a_1, a_2, a_3)$ 和已知的区组构成约束。\n\n令 $N_T(k)$ 和 $N_C(k)$ 分别为区组中前 $k$ 个位置中 $T$ 和 $C$ 分配的数量。招募者观察 $(a_1, a_2, a_3)$，因此可以计算出 $N_T(3)$ 和 $N_C(3)$。区组的定义性约束是 $N_T(4) = 2$ 和 $N_C(4) = 2$。\n\n观察到 $3$ 次分配后，必然有 $N_T(3) + N_C(3) = 3$。由于整个区组只能包含 $2$ 个 $T$ 和 $2$ 个 $C$，因此前三次分配不可能全部是 $T$（即 $N_T(3)=3$）或全部是 $C$（即 $N_C(3)=3$）。因此，对于观察到的前三次分配的构成，只有两种可能的情况：\n\n情况1：前三次分配包含两个 $T$ 和一个 $C$。\n在这种情况下，$N_T(3) = 2$ 且 $N_C(3) = 1$。招募者知道，对于完整的四个分配的区组，$N_T(4)$ 必须为 $2$。由于 $N_T(4) = N_T(3) + (\\text{count of } T \\text{ in } a_4)$，我们得到 $2 = 2 + (\\text{count of } T \\text{ in } a_4)$，这意味着第四次分配 $a_4$ 不可能是 $T$。\n同时，招募者知道 $N_C(4) = 2$。由于 $N_C(4) = N_C(3) + (\\text{count of } C \\text{ in } a_4)$，我们得到 $2 = 1 + (\\text{count of } C \\text{ in } a_4)$，这意味着第四次分配 $a_4$ 必须是 $C$。\n因此，第四次分配被唯一确定为 $C$。招募者运用此逻辑将预测为 $C$。由于这个结论是区组设计的逻辑必然结果，该预测保证是正确的。\n\n情况2：前三次分配包含一个 $T$ 和两个 $C$。\n在这种情况下，$N_T(3) = 1$ 且 $N_C(3) = 2$。使用与上述相同的逻辑，招募者可以推断出 $a_4$ 的身份。\n根据约束 $N_T(4) = 2$，我们有 $2 = 1 + (\\text{count of } T \\text{ in } a_4)$，这意味着 $a_4$ 必须是 $T$。\n根据约束 $N_C(4) = 2$，我们有 $2 = 2 + (\\text{count of } C \\text{ in } a_4)$，这意味着 $a_4$ 不可能是 $C$。\n因此，第四次分配被唯一确定为 $T$。招募者将预测为 $T$，并且该预测保证是正确的。\n\n在每一种可能的情况下，观察到前三次分配后，第四次分配的身份不再是概率性的，而是确定性的。因此，招募者基于已知规则的预测将百分之百正确。\n\n为了使用条件概率来形式化这一点，令 $O_3$ 为观察到的前三次分配序列的随机变量，令 $o$ 为 $O_3$ 的一个特定结果。事件 $E$ 是预测正确。我们在计算 $P(E)$。根据全概率定律：\n$$P(E) = \\sum_{o} P(E | O_3 = o) P(O_3 = o)$$\n求和是针对前三次分配的所有可能结果 $o$ 进行的。正如我们所展示的，对于任何可能观察到的序列 $o$（它将属于情况1或情况2），招募者都能确定地预测第四次分配。这意味着在给定任何特定观察值的情况下，预测正确的条件概率为 $1$：\n$$P(E | O_3 = o) = 1 \\quad \\forall o$$\n因此，该方程变为：\n$$P(E) = \\sum_{o} (1) \\cdot P(O_3 = o) = \\sum_{o} P(O_3 = o)$$\n根据定义，随机变量 $O_3$ 所有可能的不相交结果的概率之和等于 $1$。\n$$P(E) = 1$$\n招募者能够正确预测第四次分配的概率是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "我们已经看到了可预测性是如何产生的；现在让我们来量化其影响。当招募者能够预测分配时，他们可能会系统地将不同的患者招募到治疗组和对照组中，从而导致选择偏倚。本练习  将指导您推导出治疗效果估计中的确切数学偏倚，将分配隐藏的失败直接与无效的科学结论联系起来。",
            "id": "4571000",
            "problem": "考虑一项双臂随机对照试验（Randomized Controlled Trial, RCT），旨在评估一种疗法对二元结局的影响。由于分配隐藏不完善，临床医生会预测治疗分配并选择性地招募患者，导致各组之间的基线风险存在系统性差异。设 $T \\in \\{0,1\\}$ 表示治疗指示变量，$X$ 为治疗分配前测量的基线风险评分，$Y$ 为结局。假设以下结构性期望模型对所有参与者均成立：\n$$E[Y \\mid T, X] = \\alpha + \\Delta T + \\beta X$$\n其中 $\\alpha$ 是基线截距，$\\Delta$ 是治疗对结局的因果效应，$\\beta$ 则捕捉了基线风险与结局之间的关联。\n\n假设分配隐藏的失败导致平均基线风险出现系统性差异，即：\n$$E[X \\mid T=1] = E[X \\mid T=0] + \\delta$$\n其中 $\\delta$ 是一个已知的非零常数，表示由于选择偏倚，治疗组平均基线风险的增加量。假设样本量很大，因此均值差估计量等于各组特定条件期望之差：\n$$\\hat{\\Delta} = E[Y \\mid T=1] - E[Y \\mid T=0]$$。\n\n仅从条件期望定律和给定的结局模型出发，推导 $\\hat{\\Delta}$ 作为 $\\Delta$、$\\beta$ 和 $\\delta$ 的封闭形式函数的大样本表达式。将最终答案表示为单个解析表达式。无需四舍五入。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n问题陈述中逐字给出的已知条件如下：\n- 一项双臂随机对照试验。\n- 治疗指示变量：$T \\in \\{0,1\\}$。\n- 基线风险评分：$X$。\n- 结局：$Y$。\n- 结构性期望模型：$E[Y \\mid T, X] = \\alpha + \\Delta T + \\beta X$。\n- $\\alpha$：基线截距。\n- $\\Delta$：治疗的因果效应。\n- $\\beta$：基线风险与结局之间的关联。\n- 平均基线风险的系统性差异：$E[X \\mid T=1] = E[X \\mid T=0] + \\delta$。\n- $\\delta$：一个已知的非零常数。\n- 大样本均值差估计量：$\\hat{\\Delta} = E[Y \\mid T=1] - E[Y \\mid T=0]$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的科学有效性、适定性和客观性进行评估。\n\n- **科学依据**：该问题在生物统计学和流行病学原理方面有坚实的基础，特别涉及因果推断和临床试验中的偏倚。结局模型是标准的线性条件期望函数。所描述的场景是选择偏倚，这是一种因分配隐藏失败而导致的、有充分文献记载的现象。所需的数学工具，即迭代期望定律，是概率论中的基本工具。\n- **适定性**：该问题是适定的。它提供了所有必要的定义和关系，以便根据指定的参数 $\\Delta$、$\\beta$ 和 $\\delta$ 推导出目标量 $\\hat{\\Delta}$ 的唯一表达式。\n- **客观性**：该问题以临床试验方法学领域中使用的精确、客观和标准的术语进行陈述。\n\n基于此评估，该问题被认为是有效的，可以进行求解。\n\n### 解答推导\n目标是推导大样本均值差估计量 $\\hat{\\Delta}$ 的表达式，其定义为：\n$$\n\\hat{\\Delta} = E[Y \\mid T=1] - E[Y \\mid T=0]\n$$\n我们将使用迭代期望定律推导右侧两项 $E[Y \\mid T=1]$ 和 $E[Y \\mid T=0]$ 的表达式。该定律指出，对于随机变量 $A$ 和 $B$，$E[A] = E[E[A \\mid B]]$。我们通过以治疗分配 $T$ 为条件来应用此原理。\n\n首先，我们来评估治疗组中的期望结局 $E[Y \\mid T=1]$。根据迭代期望定律，我们可以通过以基线风险评分 $X$ 为条件来表示它：\n$$\nE[Y \\mid T=1] = E[E[Y \\mid T=1, X] \\mid T=1]\n$$\n问题给出了内部的条件期望，$E[Y \\mid T, X] = \\alpha + \\Delta T + \\beta X$。将 $T=1$ 代入此模型可得：\n$$\nE[Y \\mid T=1, X] = \\alpha + \\Delta(1) + \\beta X = \\alpha + \\Delta + \\beta X\n$$\n现在，我们将其代回迭代期望表达式中：\n$$\nE[Y \\mid T=1] = E[\\alpha + \\Delta + \\beta X \\mid T=1]\n$$\n利用期望算子的线性性质，我们可以分配期望：\n$$\nE[Y \\mid T=1] = E[\\alpha \\mid T=1] + E[\\Delta \\mid T=1] + E[\\beta X \\mid T=1]\n$$\n由于 $\\alpha$、$\\Delta$ 和 $\\beta$ 被定义为常数，它们不受期望算子的影响。因此，我们有：\n$$\nE[Y \\mid T=1] = \\alpha + \\Delta + \\beta E[X \\mid T=1]\n$$\n\n接下来，我们遵循类似的过程来评估对照组中的期望结局 $E[Y \\mid T=0]$。再次应用迭代期望定律：\n$$\nE[Y \\mid T=0] = E[E[Y \\mid T=0, X] \\mid T=0]\n$$\n将 $T=0$ 代入给定的结构性期望模型：\n$$\nE[Y \\mid T=0, X] = \\alpha + \\Delta(0) + \\beta X = \\alpha + \\beta X\n$$\n将此代入对照组的迭代期望表达式中：\n$$\nE[Y \\mid T=0] = E[\\alpha + \\beta X \\mid T=0]\n$$\n根据期望的线性性质，并且由于 $\\alpha$ 和 $\\beta$ 是常数：\n$$\nE[Y \\mid T=0] = \\alpha + \\beta E[X \\mid T=0]\n$$\n\n现在我们得到了两组期望结局的表达式。我们可以将它们代入估计量 $\\hat{\\Delta}$ 的定义中：\n$$\n\\hat{\\Delta} = E[Y \\mid T=1] - E[Y \\mid T=0]\n$$\n$$\n\\hat{\\Delta} = (\\alpha + \\Delta + \\beta E[X \\mid T=1]) - (\\alpha + \\beta E[X \\mid T=0])\n$$\n截距项 $\\alpha$ 被消去：\n$$\n\\hat{\\Delta} = \\Delta + \\beta E[X \\mid T=1] - \\beta E[X \\mid T=0]\n$$\n提取公因子 $\\beta$：\n$$\n\\hat{\\Delta} = \\Delta + \\beta (E[X \\mid T=1] - E[X \\mid T=0])\n$$\n最后，我们使用给定的关于两组间平均基线风险系统性差异的关系：\n$$\nE[X \\mid T=1] = E[X \\mid T=0] + \\delta\n$$\n这意味着差异为：\n$$\nE[X \\mid T=1] - E[X \\mid T=0] = \\delta\n$$\n将此差异 $\\delta$ 代入我们的 $\\hat{\\Delta}$ 表达式中，得到最终结果：\n$$\n\\hat{\\Delta} = \\Delta + \\beta \\delta\n$$\n该表达式表明，朴素的均值差估计量 $\\hat{\\Delta}$ 是真实因果效应 $\\Delta$ 的一个有偏估计量。偏倚项是 $\\beta \\delta$，即基线风险因素与结局之间的关联（$\\beta$）与治疗组间平均基线风险因素的系统性差异（$\\delta$）的乘积。由于 $\\beta$ 和 $\\delta$ 均不为零，所以该偏倚不为零。",
            "answer": "$$\n\\boxed{\\Delta + \\beta \\delta}\n$$"
        },
        {
            "introduction": "在现实世界的研究中，选择偏倚的确切程度通常是未知的。此时，敏感性分析成为评估试验结果稳健性的关键工具。这个高级问题  要求您对选择性招募过程进行机理建模，并计算由此产生的偏倚，让您深入了解流行病学家如何评估研究有效性的潜在威胁。",
            "id": "4570929",
            "problem": "考虑一项个体随机对照试验（随机化比例为 $1:1$），旨在评估二元处理 $T \\in \\{0,1\\}$ 对连续结局 $Y$ 的影响。设 $X \\in \\{0,1\\}$ 表示一个二元基线预后协变量，在所有合格参与者中，其群体流行率为 $\\Pr(X=1)=p$。假设稳定单位治疗价值假设（SUTVA）和一致性成立，并且在理想的操作和完美的分配隐藏下，处理分配 $T$ 在合格人群中独立于 $X$。\n\n假设结构性结局模型是可加的，由 $\\mathbb{E}[Y \\mid T, X] = \\alpha + \\beta X + \\delta T$ 给出，其中 $\\delta$ 是合格人群中真实的平均处理效应（ATE）。\n\n现在考虑一种分配隐藏被破坏的情况：招募者可以观察到即将进行的分配，并根据患者的协变量 $X$ 和预测的分配来选择性地招募他们。设 $S \\in \\{0,1\\}$ 表示是否入组。通过比值加权函数来对此入组机制建模：\n$$w(T,X) = \\gamma^{TX}$$\n因此，相对于其他组合，当预测分配为 $T=1$ 时，仅对 $X=1$ 的个体，其入组比值乘以 $\\gamma$；否则比值不变。假设在入组者中，随机化比例仍为 $1:1$。\n\n定义在入组者中计算的朴素均值差估计量为：\n$$\\widehat{\\Delta}_{\\text{naive}} = \\overline{Y}_{T=1,S=1} - \\overline{Y}_{T=0,S=1}$$。\n从随机化和条件期望的核心定义出发，推导在入组机制 $w(T,X)$ 下产生的偏差\n$$B(\\gamma) = \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] - \\delta$$\n作为 $\\gamma$、$p$ 和 $\\beta$ 的闭式函数。然后，对于 $\\gamma=3$、$p=0.3$ 和 $\\beta=4$ 的敏感性分析，计算 $B(3)$ 的数值。将最终答案表示为一个实数。如果使用近似值，请将答案四舍五入到四位有效数字；否则请提供精确值。",
            "solution": "用户要求我解决一个关于个体随机对照试验中分配隐藏的问题。\n\n### 第 1 步：提取已知条件\n-   **试验设计**：个体随机对照试验。\n-   **随机化比例**：处理组与对照组为 $1:1$。\n-   **处理**：二元，$T \\in \\{0,1\\}$。\n-   **结局**：连续，$Y$。\n-   **协变量**：二元基线预后协变量，$X \\in \\{0,1\\}$。\n-   **协变量的人群流行率**：$\\Pr(X=1)=p$。\n-   **假设**：稳定单位治疗价值假设（SUTVA）、一致性，以及在合格人群中（选择之前）$T \\perp X$。\n-   **结构性结局模型**：$\\mathbb{E}[Y \\mid T, X] = \\alpha + \\beta X + \\delta T$。\n-   **真实平均处理效应（ATE）**：$\\delta$。\n-   **入组指示变量**：$S \\in \\{0,1\\}$，其中 $S=1$ 表示已入组。\n-   **分配隐藏的破坏**：招募者观察即将进行的分配并选择性地招募。\n-   **入组机制模型**：比值加权函数 $w(T,X) = \\gamma^{TX}$。当预测分配为 $T=1$ 时，对于 $X=1$ 的个体，其入组比值乘以 $\\gamma$。\n-   **约束**：在入组者中，随机化比例仍为 $1:1$。\n-   **估计量**：朴素均值差估计量，$\\widehat{\\Delta}_{\\text{naive}} = \\overline{Y}_{T=1,S=1} - \\overline{Y}_{T=0,S=1}$。\n-   **目标**：推导偏差 $B(\\gamma) = \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] - \\delta$ 作为 $\\gamma$、$p$ 和 $\\beta$ 的函数。\n-   **数值计算**：当 $\\gamma=3$、$p=0.3$ 和 $\\beta=4$ 时，计算 $B(3)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在生物统计学和流行病学关于临床试验的理论中有坚实的基础。它解决了因分配隐藏被破坏而产生的选择偏倚，这是一个已知且关键的问题。使用结构模型、用于敏感性分析的比值加权函数以及偏差的推导是该领域的标准技术。\n-   **适定性**：该问题是适定的。它提供了明确的目标、一套完整的定义、一个可量化的偏倚诱导机制模型以及所有必要的参数。可以推导出唯一且有意义的解。\n-   **客观性**：该问题以精确、客观和数学化的语言陈述，不含任何主观因素。\n\n### 第 3 步：结论与行动\n该问题有效。我将继续进行求解。\n\n目标是推导朴素估计量的偏差，定义为 $B(\\gamma) = \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] - \\delta$。\n在大样本背景下，朴素估计量的期望是入组人群（$S=1$）中处理组和对照组之间期望结局的差异：\n$$ \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] = \\mathbb{E}[Y \\mid T=1, S=1] - \\mathbb{E}[Y \\mid T=0, S=1] $$\n我们将分别计算这两个条件期望。\n\n结构性结局模型为 $\\mathbb{E}[Y \\mid T, X] = \\alpha + \\beta X + \\delta T$。在此类敏感性分析中，一个标准假设是，在给定处理 $T$ 和协变量 $X$ 的条件下，入组 $S$ 与结局 $Y$ 是独立的，即 $Y \\perp S \\mid (T, X)$。这意味着 $\\mathbb{E}[Y \\mid T, S=1, X] = \\mathbb{E}[Y \\mid T, X]$。\n\n使用全期望定律，我们可以将 $Y$ 的条件期望用协变量 $X$ 的条件期望来表示：\n$$ \\mathbb{E}[Y \\mid T=t, S=1] = \\mathbb{E}[\\mathbb{E}[Y \\mid T=t, S=1, X] \\mid T=t, S=1] $$\n$$ \\mathbb{E}[Y \\mid T=t, S=1] = \\mathbb{E}[\\mathbb{E}[Y \\mid T=t, X] \\mid T=t, S=1] $$\n$$ \\mathbb{E}[Y \\mid T=t, S=1] = \\mathbb{E}[\\alpha + \\beta X + \\delta t \\mid T=t, S=1] $$\n$$ \\mathbb{E}[Y \\mid T=t, S=1] = \\alpha + \\delta t + \\beta \\mathbb{E}[X \\mid T=t, S=1] $$\n因此，问题简化为在入组人群的每个治疗组内，求出协变量 $X$ 的期望值 $\\mathbb{E}[X \\mid T=t, S=1]$。\n\n$\\mathbb{E}[X \\mid T=t, S=1]$ 就是在指定亚组中协变量 $X=1$ 的流行率，即 $\\Pr(X=1 \\mid T=t, S=1)$。我们通过对选择过程建模来推导这个概率。\n\n问题陈述招募者可以看到即将到来的分配（$T=0$ 或 $T=1$），然后根据患者的协变量 $X$ 选择性地招募他们。入组者中随机化比例保持 $1:1$ 的约束意味着，为了填补两个规模相等的治疗组，存在两个独立的招募过程。\n\n对于对照组（$T=0$）：\n比值加权函数为 $w(T,X) = \\gamma^{TX}$。当 $T=0$ 时，权重为 $w(0,0)=\\gamma^{0}=1$ 和 $w(0,1)=\\gamma^{0}=1$。由于协变量 $X$ 的两个水平的权重相同，因此在对照组中没有选择性入组。对照组中 $X$ 的分布与合格人群中的分布相同。\n$$ \\Pr(X=1 \\mid T=0, S=1) = \\Pr(X=1) = p $$\n\n对于处理组（$T=1$）：\n权重为 $w(1,0)=\\gamma^{0}=1$ 和 $w(1,1)=\\gamma^{1}=\\gamma$。当分配到处理组时，选择机制会优先招募 $X=1$ 的个体（假设 $\\gamma>1$）。在入组的处理组中，一个个体具有 $X=x$ 的概率，与其在合格人群中的流行率 $\\Pr(X=x)$ 乘以选择权重 $w(1,x)$ 成正比。\n$$ \\Pr(X=1 \\mid T=1, S=1) = \\frac{\\Pr(X=1) w(1,1)}{\\Pr(X=1) w(1,1) + \\Pr(X=0) w(1,0)} $$\n鉴于 $\\Pr(X=1)=p$ 和 $\\Pr(X=0)=1-p$：\n$$ \\Pr(X=1 \\mid T=1, S=1) = \\frac{p \\cdot \\gamma}{p \\cdot \\gamma + (1-p) \\cdot 1} = \\frac{\\gamma p}{1-p+\\gamma p} $$\n\n现在我们可以计算入组群体中的期望结局。\n对于对照组：\n$$ \\mathbb{E}[X \\mid T=0, S=1] = \\Pr(X=1 \\mid T=0, S=1) = p $$\n$$ \\mathbb{E}[Y \\mid T=0, S=1] = \\alpha + \\beta \\mathbb{E}[X \\mid T=0, S=1] = \\alpha + \\beta p $$\n\n对于处理组：\n$$ \\mathbb{E}[X \\mid T=1, S=1] = \\Pr(X=1 \\mid T=1, S=1) = \\frac{\\gamma p}{1-p+\\gamma p} $$\n$$ \\mathbb{E}[Y \\mid T=1, S=1] = \\alpha + \\delta + \\beta \\mathbb{E}[X \\mid T=1, S=1] = \\alpha + \\delta + \\beta \\frac{\\gamma p}{1-p+\\gamma p} $$\n\n现在我们可以求出朴素估计量的期望：\n$$ \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] = \\mathbb{E}[Y \\mid T=1, S=1] - \\mathbb{E}[Y \\mid T=0, S=1] $$\n$$ \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] = \\left(\\alpha + \\delta + \\beta \\frac{\\gamma p}{1-p+\\gamma p}\\right) - (\\alpha + \\beta p) $$\n$$ \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] = \\delta + \\beta \\left( \\frac{\\gamma p}{1-p+\\gamma p} - p \\right) $$\n\n偏差 $B(\\gamma)$ 是这个期望与真实 ATE $\\delta$ 之间的差：\n$$ B(\\gamma) = \\mathbb{E}[\\widehat{\\Delta}_{\\text{naive}}] - \\delta = \\beta \\left( \\frac{\\gamma p}{1-p+\\gamma p} - p \\right) $$\n为了得到一个更易于解释的闭式形式，我们将括号内的项合并：\n$$ \\frac{\\gamma p}{1-p+\\gamma p} - \\frac{p(1-p+\\gamma p)}{1-p+\\gamma p} = \\frac{\\gamma p - p + p^2 - \\gamma p^2}{1-p+\\gamma p} $$\n$$ = \\frac{p(\\gamma - 1 + p - \\gamma p)}{1-p+\\gamma p} = \\frac{p[(\\gamma - 1) - p(\\gamma - 1)]}{1-p+\\gamma p} = \\frac{p(1-p)(\\gamma-1)}{1-p+\\gamma p} $$\n因此，偏差的闭式表达式为：\n$$ B(\\gamma) = \\beta \\frac{p(1-p)(\\gamma-1)}{1-p+\\gamma p} $$\n\n最后，我们使用参数 $\\gamma=3$、$p=0.3$ 和 $\\beta=4$ 计算敏感性分析的偏差数值。\n$$ B(3) = 4 \\times \\frac{0.3 \\times (1-0.3) \\times (3-1)}{1-0.3 + 3 \\times 0.3} $$\n$$ B(3) = 4 \\times \\frac{0.3 \\times 0.7 \\times 2}{0.7 + 0.9} $$\n$$ B(3) = 4 \\times \\frac{0.42}{1.6} $$\n$$ B(3) = \\frac{1.68}{1.6} $$\n$$ B(3) = \\frac{168}{160} = \\frac{21 \\times 8}{20 \\times 8} = \\frac{21}{20} = 1.05 $$\n该值为精确有理数，因此无需四舍五入。",
            "answer": "$$\\boxed{1.05}$$"
        }
    ]
}