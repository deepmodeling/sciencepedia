{
    "hands_on_practices": [
        {
            "introduction": "在病例-对照研究中，个体匹配是一种强有力的控制混杂因素的策略，尤其是在嵌套病例-对照研究中，通过风险集抽样可以高效地估计风险比。本练习将引导您处理一个经典的1:1匹配研究数据。通过关注信息量最大的不一致配对，您将亲手计算出匹配比值比，并理解为何在这个设计中，该估计值可以作为瞬时风险比的直接估计。",
            "id": "4610283",
            "problem": "一个动态队列在日历时间内被随访，疾病事件在不同的时间点发生。一项巢式病例对照研究使用风险集抽样，并按日历时间和年龄进行 $1:1$ 匹配：在每个事件时间 $\\tau_j$，从风险集中确定一例病例，并从同一风险集中独立于暴露（给定匹配因素）抽取一例对照。设二元暴露为 $X \\in \\{0,1\\}$，其可能随时间变化。假设在每个风险集内，瞬时疾病发生率对 $X$ 的依赖仅通过一个跨时间恒定的风险比来体现。\n\n在四个事件时间点 $\\tau_1,\\tau_2,\\tau_3,\\tau_4$，观察到的病例及其匹配对照的暴露状态如下：\n\n- 在时间 $\\tau_1$：病例 $X=1$，对照 $X=0$。\n- 在时间 $\\tau_2$：病例 $X=0$，对照 $X=1$。\n- 在时间 $\\tau_3$：病例 $X=1$，对照 $X=0$。\n- 在时间 $\\tau_4$：病例 $X=1$，对照 $X=1$。\n\n仅使用风险集抽样和匹配分析的原理，根据这4个匹配对计算暴露 $X$ 的匹配比值比，并根据研究设计的假设，说明其在瞬时风险（风险比）方面的解释。请以简化分数或整数形式提供您的数值答案。无需四舍五入。最终数值不带任何单位。",
            "solution": "该问题要求根据一项 $1:1$ 巢式病例对照研究计算匹配比值比并对其进行解释。这种研究设计的分析方法基于条件逻辑回归，该方法源于Cox比例风险模型的偏似然。\n\n在 $1:1$ 匹配的病例对照研究中，每个匹配集由一个病例和一个对照组成，他们按某些变量（本例中为日历时间和年龄）进行匹配。分析旨在估计暴露 $X \\in \\{0,1\\}$ 与疾病结局之间的关联。此分析的一个基本原则是，只有不一致对（即病例和对照具有不同暴露状态的对）才为比值比的估计提供信息。一致对（即病例和对照具有相同暴露状态的对）对用于估计的条件似然函数没有贡献，因此在点估计的计算中被忽略。\n\n让我们根据病例和对照的二元暴露状态对匹配对进行分类。我们可以定义 $n_{10}$ 为病例暴露（$X=1$）而对照未暴露（$X=0$）的对数，定义 $n_{01}$ 为病例未暴露（$X=0$）而对照暴露（$X=1$）的对数。这是两种类型的不一致对。\n\n匹配比值比（$OR$）的最大条件似然估计量由这两种不一致对的计数之比给出：\n$$ OR = \\frac{n_{10}}{n_{01}} $$\n该估计量是通过最大化潜在比例风险模型中风险比 $\\exp(\\beta)$ 的条件似然函数得出的，对于 $1:1$ 匹配设计，该函数简化为此比率。\n\n我们得到了在四个不同事件时间 $\\tau_1, \\tau_2, \\tau_3, \\tau_4$ 的4个匹配对的暴露数据：\n- 在时间 $\\tau_1$：病例暴露为 $X=1$，对照暴露为 $X=0$。这是一个第一类不一致对（$n_{10}$）。\n- 在时间 $\\tau_2$：病例暴露为 $X=0$，对照暴露为 $X=1$。这是一个第二类不一致对（$n_{01}$）。\n- 在时间 $\\tau_3$：病例暴露为 $X=1$，对照暴露为 $X=0$。这是另一个第一类不一致对（$n_{10}$）。\n- 在时间 $\\tau_4$：病例暴露为 $X=1$，对照暴露为 $X=1$。这是一个一致对。如前所述，它对比值比估计的计算没有贡献。\n\n现在，我们根据所提供的数据统计不一致对的数量：\n病例暴露而对照未暴露的对数为 $n_{10} = 2$（来自 $\\tau_1$ 和 $\\tau_3$ 的配对）。\n病例未暴露而对照暴露的对数为 $n_{01} = 1$（来自 $\\tau_2$ 的配对）。\n\n使用匹配比值比的公式，我们可以计算出其值：\n$$ OR = \\frac{n_{10}}{n_{01}} = \\frac{2}{1} = 2 $$\n\n问题的第二部分要求解释这个结果。问题指明，该研究设计是采用风险集抽样的巢式病例对照研究，并且暴露的风险比（$HR$）是恒定的。这种特定设计的一个关键特性是，从匹配分析中估计的比值比是源队列中风险比的直接且一致的估计量。也就是说，$OR_{matched}$ 提供了 $HR$ 的无偏估计。\n\n因此，计算出的比值比为2的解释是，它是风险比的一个估计值。这意味着，在保持匹配因素（年龄和日历时间）不变的情况下，暴露个体（$X=1$）发生疾病的瞬时风险（风险率）是未暴露个体（$X=0$）的2倍。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "频率匹配是另一种在病例-对照研究中控制混杂的常用设计策略，它确保病例组和对照组在匹配变量（如年龄分层）的分布上具有可比性。本练习将带您实践处理由此类设计产生的分层数据。您将应用经典的Mantel-Haenszel方法，学习如何合并来自不同地层的信息，以计算一个调整了混杂因素后的合并比值比，这是流行病学数据分析的一项核心技能。",
            "id": "4610307",
            "problem": "一项基于人群的病例对照研究调查了二元暴露与二元疾病结局之间的关联。该研究使用按年龄类别的频数匹配以减少年龄造成的混杂，从而产生对应于年龄组的三个分层。在每个分层内，$2 \\times 2$ 表格的单元格计数定义如下：$a_k$ 是暴露组病例数，$b_k$ 是非暴露组病例数，$c_k$ 是暴露组对照数，$d_k$ 是非暴露组对照数，分层指数 $k \\in \\{1,2,3\\}$。令 $N_k = a_k + b_k + c_k + d_k$ 表示分层 $k$ 中的总受试者数。\n\n数据如下：\n- 分层 $1$：$a_1 = 18$, $b_1 = 22$, $c_1 = 12$, $d_1 = 38$。\n- 分层 $2$：$a_2 = 25$, $b_2 = 15$, $c_2 = 20$, $d_2 = 40$。\n- 分层 $3$：$a_3 = 10$, $b_3 = 30$, $c_3 = 8$, $d_3 = 52$。\n\n从 $2 \\times 2$ 表中比数和比值比的基本定义出发，并使用分层原理来控制匹配因素，使用 Mantel-Haenszel 方法 (Mantel-Haenszel (MH)) 推导出适用于所有分层的共同比值比的合并估计量。然后根据给定数据计算该合并估计量的值。将您的数值答案四舍五入到四位有效数字。不应使用单位。最后，在频数匹配的病例对照研究背景下解释该估计值。",
            "solution": "目标是计算分层病例对照数据的 Mantel-Haenszel (MH) 合并比值比，并解释其结果。该研究采用按年龄的频数匹配，分析则使用分层来控制年龄这一潜在的混杂变量。\n\n首先，我们定义单个分层 $k$ 的比值比 (OR)。在病例对照研究中，我们比较病例组中的暴露比数与对照组中的暴露比数。对于分层 $k$，其单元格计数为 $a_k$ (暴露组病例)、$b_k$ (非暴露组病例)、$c_k$ (暴露组对照) 和 $d_k$ (非暴露组对照)，数据结构如下：\n\n| | 暴露 | 非暴露 |\n|---|---|---|\n| 病例 | $a_k$ | $b_k$ |\n| 对照 | $c_k$ | $d_k$ |\n\n病例组中的暴露比数估计为暴露病例数与非暴露病例数之比：$\\frac{a_k}{b_k}$。\n对照组中的暴露比数估计为暴露对照数与非暴露对照数之比：$\\frac{c_k}{d_k}$。\n\n分层 $k$ 的比值比，记为 $OR_k$，是这两个比数的比值：\n$$OR_k = \\frac{a_k / b_k}{c_k / d_k} = \\frac{a_k d_k}{b_k c_k}$$\n\nMantel-Haenszel 方法提供了一个跨所有分层的共同比值比 $\\psi_{MH}$ 的合并估计值，其前提是假设真实比值比在各分层间是恒定的。MH 估计量是一个加权汇总，它给予信息量更多的分层更大的权重。它的计算方法是观察到的一致对 ($a_k d_k$) 的总和除以观察到的不一致对 ($b_k c_k$) 的总和，其中每对的贡献通过其所在分层总人数 $N_k = a_k + b_k + c_k + d_k$ 的倒数进行加权。\n\nMantel-Haenszel 合并比值比的公式是：\n$$\\psi_{MH} = \\frac{\\sum_{k=1}^{K} R_k}{\\sum_{k=1}^{K} S_k} = \\frac{\\sum_{k=1}^{K} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{K} \\frac{b_k c_k}{N_k}}$$\n其中 $K$ 是总分层数，在本问题中为 $3$。\n\n现在，我们使用所提供的数据计算三个分层中每个分层的必要组成部分。\n\n**分层 1 ($k=1$):**\n给定数据：$a_1 = 18$, $b_1 = 22$, $c_1 = 12$, $d_1 = 38$。\n分层 1 的总受试者数：$N_1 = a_1 + b_1 + c_1 + d_1 = 18 + 22 + 12 + 38 = 90$。\n分子部分：$R_1 = \\frac{a_1 d_1}{N_1} = \\frac{18 \\times 38}{90} = \\frac{684}{90} = 7.6$。\n分母部分：$S_1 = \\frac{b_1 c_1}{N_1} = \\frac{22 \\times 12}{90} = \\frac{264}{90} = \\frac{44}{15}$。\n\n**分层 2 ($k=2$):**\n给定数据：$a_2 = 25$, $b_2 = 15$, $c_2 = 20$, $d_2 = 40$。\n分层 2 的总受试者数：$N_2 = a_2 + b_2 + c_2 + d_2 = 25 + 15 + 20 + 40 = 100$。\n分子部分：$R_2 = \\frac{a_2 d_2}{N_2} = \\frac{25 \\times 40}{100} = \\frac{1000}{100} = 10$。\n分母部分：$S_2 = \\frac{b_2 c_2}{N_2} = \\frac{15 \\times 20}{100} = \\frac{300}{100} = 3$。\n\n**分层 3 ($k=3$):**\n给定数据：$a_3 = 10$, $b_3 = 30$, $c_3 = 8$, $d_3 = 52$。\n分层 3 的总受试者数：$N_3 = a_3 + b_3 + c_3 + d_3 = 10 + 30 + 8 + 52 = 100$。\n分子部分：$R_3 = \\frac{a_3 d_3}{N_3} = \\frac{10 \\times 52}{100} = \\frac{520}{100} = 5.2$。\n分母部分：$S_3 = \\frac{b_3 c_3}{N_3} = \\frac{30 \\times 8}{100} = \\frac{240}{100} = 2.4$。\n\n接下来，我们将这些部分在所有分层中求和。\n分子部分的总和：\n$$\\sum_{k=1}^{3} R_k = R_1 + R_2 + R_3 = 7.6 + 10 + 5.2 = 22.8$$\n分母部分的总和：\n$$\\sum_{k=1}^{3} S_k = S_1 + S_2 + S_3 = \\frac{44}{15} + 3 + 2.4 = \\frac{44}{15} + \\frac{45}{15} + \\frac{36}{15} = \\frac{44 + 45 + 36}{15} = \\frac{125}{15} = \\frac{25}{3}$$\n注意 $2.4 = \\frac{24}{10} = \\frac{12}{5} = \\frac{36}{15}$。\n\n最后，我们计算 Mantel-Haenszel 合并比值比：\n$$\\psi_{MH} = \\frac{\\sum_{k=1}^{3} R_k}{\\sum_{k=1}^{3} S_k} = \\frac{22.8}{\\frac{25}{3}} = \\frac{22.8 \\times 3}{25} = \\frac{68.4}{25} = 2.736$$\n结果 $2.736$ 有四位有效数字，符合要求。\n\n**解释：**\nMantel-Haenszel 合并比值比 $\\psi_{MH} = 2.736$ 是暴露与疾病之间关联性的估计值，该值已对年龄的混杂效应进行了校正。在此病例对照研究的背景下，比值比比较的是病例组中的暴露比数与对照组中的暴露比数。比值比为 $1$ 表示没有关联，大于 $1$ 表示存在正相关（暴露是潜在的风险因素），小于 $1$ 表示存在负相关（暴露可能是保护性因素）。\n\n计算出的值 $2.736$ 表明存在正相关。其解释如下：在通过分层控制了年龄的混杂效应后，在所研究的人群中，患有该疾病的个体（病例）的暴露比数估计是未患该疾病的个体（对照）的 $2.736$ 倍。需要注意的是，频数匹配是一种研究设计策略，旨在确保每个分层有足够的数据以进行有效的分层分析，而 Mantel-Haenszel 程序是实际控制混杂因素的分析方法。",
            "answer": "$$\n\\boxed{2.736}\n$$"
        },
        {
            "introduction": "匹配是一种在研究设计阶段控制混杂的方法，但它要求在分析阶段也必须进行相应的处理，否则可能引入偏倚。本练习是一个关键的思维实验，它揭示了当研究者在频率匹配后、却错误地忽略分层信息而直接合并数据进行分析时，会发生什么。通过从第一性原理出发推导并量化由此产生的偏倚，您将深刻理解为何在匹配设计后必须采用分层分析。",
            "id": "4610264",
            "problem": "一位研究者进行了一项频率匹配的病例-对照研究，以评估二元暴露 $E \\in \\{0,1\\}$ 对二元疾病 $D \\in \\{0,1\\}$ 的影响，其中对二元分层变量 $S \\in \\{0,1\\}$（例如，年龄组）进行了频率匹配。该研究的设计是，对于每个分层 $s \\in \\{0,1\\}$，精确抽取 $n_s$ 个病例和 $n_s$ 个对照，其中 $n_0 = 300$，$n_1 = 100$。在源人群中，每个分层 $s$ 内，暴露 $E$ 在对照组中的暴露率为 $\\pi_s$，其中 $\\pi_0 = 0.7$ 和 $\\pi_1 = 0.2$。比较 $E=1$ 与 $E=0$ 的真实的分层特异性疾病比值比（odds ratio, OR）在各分层间是同质的，且等于 $\\theta = 2$。\n\n仅从比值、比值比的核心定义以及病例-对照研究的抽样规则出发，推导忽略 $S$（即合并所有分层并拟合一个不含任何分层指标的无条件模型）时得到的 $E$ 的期望未分层粗比值比。然后，将乘性偏倚因子定义为 $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$，其中 $\\mathrm{OR}_{\\text{unadj}}$ 是忽略 $S$ 的未分层粗比值比。根据给定的设计和参数计算 $b$。\n\n将 $b$ 的最终答案表示为一个实数，四舍五入到四位有效数字。无需单位。",
            "solution": "目标是计算乘性偏倚因子 $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$。为此，我们必须首先推导出期望的未分层粗比值比 $\\mathrm{OR}_{\\text{unadj}}$。该比值比是从一个合并了两个分层 $S=0$ 和 $S=1$ 数据的 $2 \\times 2$ 表中计算得出的。\n\n期望计数的合并表格如下：\n| | 暴露（$E=1$） | 未暴露（$E=0$） |\n|---|---|---|\n| 病例（$D=1$） | $E[A]$ | $E[B]$ |\n| 对照（$D=0$） | $E[C]$ | $E[D]$ |\n\n粗比值比由下式给出 $\\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]}$。\n$E[A], E[B], E[C], E[D]$ 这些项代表合并研究样本中的期望总计数。设 $N_{eds}$ 为研究中暴露状态为 $e$、疾病状态为 $d$ 且位于分层 $s$ 中的个体数量。\n合并计数为：\n$A = N_{110} + N_{111}$（暴露病例）\n$B = N_{010} + N_{011}$（未暴露病例）\n$C = N_{100} + N_{101}$（暴露对照）\n$D = N_{000} + N_{001}$（未暴露对照）\n\n我们需要求出这些计数的期望值。\n\n**1. 对照组（$D=0$）的期望计数**\n\n问题给出了源人群中每个分层对照组的暴露率，$\\pi_s = P(E=1|D=0, S=s)$。\n在分层 $s=0$ 中，我们抽取了 $n_0 = 300$ 个对照。暴露率为 $\\pi_0 = 0.7$。\n分层0中暴露对照的期望数量为：\n$E[N_{100}] = n_0 \\cdot \\pi_0 = 300 \\cdot 0.7 = 210$。\n分层0中未暴露对照的期望数量为：\n$E[N_{000}] = n_0 \\cdot (1 - \\pi_0) = 300 \\cdot (1 - 0.7) = 90$。\n\n在分层 $s=1$ 中，我们抽取了 $n_1 = 100$ 个对照。暴露率为 $\\pi_1 = 0.2$。\n分层1中暴露对照的期望数量为：\n$E[N_{101}] = n_1 \\cdot \\pi_1 = 100 \\cdot 0.2 = 20$。\n分层1中未暴露对照的期望数量为：\n$E[N_{001}] = n_1 \\cdot (1 - \\pi_1) = 100 \\cdot (1 - 0.2) = 80$。\n\n合并表格中对照组的总期望计数为：\n$E[C] = E[N_{100}] + E[N_{101}] = 210 + 20 = 230$。\n$E[D] = E[N_{000}] + E[N_{001}] = 90 + 80 = 170$。\n\n**2. 病例组（$D=1$）的期望计数**\n\n我们需要确定病例组中的暴露率，我们将其表示为 $\\pi_s^* = P(E=1|D=1, S=s)$。这可以从分层特异性比值比 $\\theta$ 推导出来。给定暴露的疾病比值比等于给定疾病的暴露比值比。\n$$ \\theta = \\frac{\\text{odds}(E=1|D=1, S=s)}{\\text{odds}(E=1|D=0, S=s)} = \\frac{\\pi_s^*/(1-\\pi_s^*)}{\\pi_s/(1-\\pi_s)} $$\n求解 $\\pi_s^*$，我们得到病例组中暴露的比值：\n$$ \\frac{\\pi_s^*}{1-\\pi_s^*} = \\theta \\cdot \\frac{\\pi_s}{1-\\pi_s} $$\n这导出了病例组中暴露率的表达式：\n$$ \\pi_s^* = \\frac{\\theta \\pi_s}{1-\\pi_s + \\theta\\pi_s} = \\frac{\\theta \\pi_s}{1 + (\\theta-1)\\pi_s} $$\n使用给定值 $\\theta = 2$，$\\pi_0 = 0.7$ 和 $\\pi_1 = 0.2$：\n\n对于分层 $s=0$：\n$$ \\pi_0^* = \\frac{2 \\cdot 0.7}{1 + (2-1) \\cdot 0.7} = \\frac{1.4}{1.7} = \\frac{14}{17} $$\n对于分层 $s=1$：\n$$ \\pi_1^* = \\frac{2 \\cdot 0.2}{1 + (2-1) \\cdot 0.2} = \\frac{0.4}{1.2} = \\frac{1}{3} $$\n现在我们可以计算病例组的期望计数。\n在分层 $s=0$ 中，我们抽取了 $n_0 = 300$ 个病例。\n$E[N_{110}] = n_0 \\cdot \\pi_0^* = 300 \\cdot \\frac{14}{17} = \\frac{4200}{17}$。\n$E[N_{010}] = n_0 \\cdot (1 - \\pi_0^*) = 300 \\cdot \\left(1 - \\frac{14}{17}\\right) = 300 \\cdot \\frac{3}{17} = \\frac{900}{17}$。\n\n在分层 $s=1$ 中，我们抽取了 $n_1 = 100$ 个病例。\n$E[N_{111}] = n_1 \\cdot \\pi_1^* = 100 \\cdot \\frac{1}{3} = \\frac{100}{3}$。\n$E[N_{011}] = n_1 \\cdot (1 - \\pi_1^*) = 100 \\cdot \\left(1 - \\frac{1}{3}\\right) = 100 \\cdot \\frac{2}{3} = \\frac{200}{3}$。\n\n合并表格中病例组的总期望计数为：\n$E[A] = E[N_{110}] + E[N_{111}] = \\frac{4200}{17} + \\frac{100}{3} = \\frac{12600 + 1700}{51} = \\frac{14300}{51}$。\n$E[B] = E[N_{010}] + E[N_{011}] = \\frac{900}{17} + \\frac{200}{3} = \\frac{2700 + 3400}{51} = \\frac{6100}{51}$。\n\n**3. 计算未分层粗比值比 ($\\mathrm{OR}_{\\text{unadj}}$)**\n\n使用合并表格的期望计数：\n$E[A] = \\frac{14300}{51}$，$E[B] = \\frac{6100}{51}$，$E[C] = 230$，$E[D] = 170$。\n$$ \\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]} = \\frac{\\left(\\frac{14300}{51}\\right) \\cdot 170}{\\left(\\frac{6100}{51}\\right) \\cdot 230} $$\n$51$ 的分母相互抵消：\n$$ \\mathrm{OR}_{\\text{unadj}} = \\frac{14300 \\cdot 170}{6100 \\cdot 230} = \\frac{143 \\cdot 17}{61 \\cdot 23} = \\frac{2431}{1403} $$\n\n**4. 计算偏倚因子 ($b$)**\n\n乘性偏倚因子为 $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$。\n给定 $\\theta = 2$：\n$$ b = \\frac{\\mathrm{OR}_{\\text{unadj}}}{\\theta} = \\frac{2431/1403}{2} = \\frac{2431}{2 \\cdot 1403} = \\frac{2431}{2806} $$\n现在，我们计算数值并四舍五入到四位有效数字：\n$$ b = \\frac{2431}{2806} \\approx 0.8663578047... $$\n四舍五入到四位有效数字，我们得到 $0.8664$。",
            "answer": "$$\\boxed{0.8664}$$"
        }
    ]
}