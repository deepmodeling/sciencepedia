{
    "hands_on_practices": [
        {
            "introduction": "在病例对照研究中，比值比（Odds Ratio, $OR$）是衡量暴露与疾病关联强度的核心指标。本练习旨在提供计算该指标及置信区间的基本实践，这是量化暴露与疾病之间关联强度的必备技能。通过分析一个假设的医院研究数据，你将掌握从原始计数到统计推断的关键步骤 。",
            "id": "4638770",
            "problem": "一项基于医院的病例对照研究评估了接触工作场所溶剂是否与一种慢性呼吸系统疾病相关。在抽样的病例中，暴露人数为 $a=45$，未暴露人数为 $b=55$。在抽样的对照组中，暴露人数为 $c=30$，未暴露人数为 $d=70$。请仅使用基本定义和大样本性质进行分析：一组中的比值（odds）定义为该组中暴露的概率除以未暴露的概率，而比值比（odds ratio）定义为病例组的比值与对照组的比值之比。假设样本比值比的自然对数在大样本中近似服从正态分布，并在自然对数尺度上构建一个 Wald 型置信区间。\n\n任务：\n1. 使用计数 $a$、$b$、$c$ 和 $d$，计算比值比，即病例组的暴露比值与对照组的暴露比值之比。\n2. 在自然对数尺度上，使用大样本正态近似法，计算比值比自然对数的 95% 置信区间。不要将该区间转换回原始尺度。\n3. 用一句话，从病因学关联的角度解释所估计关联的大小和方向。再用一句话，说明影响该估计值解释的一个病例对照研究设计的优点和一个局限性。\n\n将最终数值结果以单行矩阵的形式报告，该矩阵包含按以下顺序排列的三个条目：比值比、比值比自然对数的 95% 置信区间的下限，以及比值比自然对数的 95% 置信区间的上限。将比值比四舍五入至三位有效数字，并将每个置信界限四舍五入至三位有效数字。无需单位。",
            "solution": "该问题经评估有效，因为它代表了一个标准的、定义明确的流行病学计算，具有足够的数据和清晰的定义。\n\n提供的数据来自一项病例对照研究，计数如下：\n- 暴露病例：$a = 45$\n- 未暴露病例：$b = 55$\n- 暴露对照：$c = 30$\n- 未暴露对照：$d = 70$\n\n病例总数为 $N_{cases} = a + b = 45 + 55 = 100$。\n对照组总数为 $N_{controls} = c + d = 30 + 70 = 100$。\n\n**1. 计算比值比 (OR)**\n\n病例组中的暴露比值通过暴露病例与未暴露病例的比率来估计：\n$$ \\hat{O}_{cases} = \\frac{a}{b} = \\frac{45}{55} $$\n对照组中的暴露比值通过暴露对照与未暴露对照的比率来估计：\n$$ \\hat{O}_{controls} = \\frac{c}{d} = \\frac{30}{70} $$\n样本比值比，记作 $\\hat{OR}$，是这两个比值的比率，可简化为交叉乘积比：\n$$ \\hat{OR} = \\frac{\\hat{O}_{cases}}{\\hat{O}_{controls}} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n代入给定的数值：\n$$ \\hat{OR} = \\frac{45 \\times 70}{55 \\times 30} = \\frac{3150}{1650} = \\frac{21}{11} \\approx 1.90909... $$\n按要求四舍五入至三位有效数字，比值比为：\n$$ \\hat{OR} \\approx 1.91 $$\n\n**2. 计算 $\\ln(OR)$ 的 $95\\%$ 置信区间**\n\n问题要求为比值比的自然对数 $\\ln(OR)$ 构建一个 Wald 型置信区间。该参数的点估计值为 $\\ln(\\hat{OR})$。\n$$ \\ln(\\hat{OR}) = \\ln\\left(\\frac{21}{11}\\right) \\approx 0.646627 $$\n$\\ln(\\hat{OR})$ 的标准误的大样本近似值由 Woolf 方法给出：\n$$ SE[\\ln(\\hat{OR})] = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}} $$\n代入单元格计数：\n$$ SE[\\ln(\\hat{OR})] = \\sqrt{\\frac{1}{45} + \\frac{1}{55} + \\frac{1}{30} + \\frac{1}{70}} $$\n$$ SE[\\ln(\\hat{OR})] \\approx \\sqrt{0.022222... + 0.018181... + 0.033333... + 0.014285...} $$\n$$ SE[\\ln(\\hat{OR})] \\approx \\sqrt{0.088023...} \\approx 0.296686 $$\n$\\ln(OR)$ 的 $(1-\\alpha) \\times 100\\%$ 置信区间的公式为：\n$$ \\ln(\\hat{OR}) \\pm z_{1-\\alpha/2} \\times SE[\\ln(\\hat{OR})] $$\n对于 $95\\%$ 置信区间，$\\alpha = 0.05$，来自标准正态分布的相应临界值为 $z_{1-0.05/2} = z_{0.975} \\approx 1.96$。\n误差范围是：\n$$ E = z_{0.975} \\times SE[\\ln(\\hat{OR})] \\approx 1.96 \\times 0.296686 \\approx 0.581505 $$\n置信区间的下限和上限为：\n下限：$LCL = \\ln(\\hat{OR}) - E \\approx 0.646627 - 0.581505 = 0.065122$\n上限：$UCL = \\ln(\\hat{OR}) + E \\approx 0.646627 + 0.581505 = 1.228132$\n将每个界限四舍五入至三位有效数字：\n$$ LCL \\approx 0.0651 $$\n$$ UCL \\approx 1.23 $$\n因此，$\\ln(OR)$ 的 $95\\%$ 置信区间约为 $(0.0651, 1.23)$。\n\n**3. 结果解释**\n\n估计的比值比约为 $1.91$，表明患有慢性呼吸系统疾病的病例组接触工作场所溶剂的比值比基于医院的对照组高出约 $91\\%$，这提示存在正向的病因学关联。病例对照研究设计的一个关键优点是其在研究罕见疾病方面的效率，但一个关键的局限性是其易受选择偏倚的影响，尤其是在基于医院的环境中，对照组的住院原因可能与暴露相关。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.91  0.0651  1.23 \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然我们从病例对照研究中计算的是比值比（$OR$），但我们通常更关心相对风险（Risk Ratio, $RR$）。本练习通过一个常见病的假设情景，让你从代数和数值上证明 $OR$ 为何仅在“罕见病假设”下才能很好地近似 $RR$。理解这一点对于准确解读病例对照研究的结果至关重要，也是每位流行病学研究者必须注意的关键限制 。",
            "id": "4638781",
            "problem": "病例对照研究的一个核心优势是其在研究罕见结局时的效率，但一个核心局限性是它们通常估计的是比值比（OR），而比值比仅在罕见结局假设下才近似于风险比（RR）。从以下基本定义出发：(i) 风险是在某一暴露分层中的患病概率，(ii) 比值是在某一暴露分层中患病概率与不患病概率之比。请使用代数推导风险比和比值比的表达式，并用 $P(D=1 \\mid E=1)$ 和 $P(D=1 \\mid E=0)$ 表示。然后，对于一个疾病常见的人群，其中 $P(D=1 \\mid E=1)=0.3$ 和 $P(D=1 \\mid E=0)=0.2$，计算风险比和比值比，并报告它们的数值。将您的答案四舍五入到四位有效数字。将您的最终答案表示为一个行矩阵，顺序为 $\\left(\\text{RR}, \\text{OR}\\right)$。",
            "solution": "该问题被评估为有效，因为它在科学上基于流行病学的既定原则，提法得当，为求得唯一解提供了所有必要信息，并以客观、明确的语言表述。\n\n第一步是根据所提供的定义推导风险比（$RR$）和比值比（$OR$）的代数表达式。我们使用符号 $D=1$ 表示患病，$D=0$ 表示未患病。同样，$E=1$ 表示暴露，$E=0$ 表示未暴露。\n\n疾病风险定义为特定暴露分层内的患病概率。\n暴露组的风险，记为 $R_1$，是在暴露条件下的患病条件概率：\n$$R_1 = P(D=1 \\mid E=1)$$\n未暴露组的风险，记为 $R_0$，是在未暴露条件下的患病条件概率：\n$$R_0 = P(D=1 \\mid E=0)$$\n\n风险比（$RR$）是暴露组风险与未暴露组风险之比。\n$$RR = \\frac{R_1}{R_0} = \\frac{P(D=1 \\mid E=1)}{P(D=1 \\mid E=0)}$$\n这就是风险比的推导表达式。\n\n疾病比值定义为在某个暴露分层内，患病概率与不患病概率之比。\n在给定分层中不患病的概率是 $1$ 减去患病的概率。因此，$P(D=0 \\mid E=1) = 1 - P(D=1 \\mid E=1)$ 且 $P(D=0 \\mid E=0) = 1 - P(D=1 \\mid E=0)$。\n\n暴露组的疾病比值，记为 $Odds_1$，是：\n$$Odds_1 = \\frac{P(D=1 \\mid E=1)}{P(D=0 \\mid E=1)} = \\frac{P(D=1 \\mid E=1)}{1 - P(D=1 \\mid E=1)}$$\n未暴露组的疾病比值，记为 $Odds_0$，是：\n$$Odds_0 = \\frac{P(D=1 \\mid E=0)}{P(D=0 \\mid E=0)} = \\frac{P(D=1 \\mid E=0)}{1 - P(D=1 \\mid E=0)}$$\n\n比值比（$OR$）是暴露组的疾病比值与未暴露组的疾病比值之比。\n$$OR = \\frac{Odds_1}{Odds_0} = \\frac{\\frac{P(D=1 \\mid E=1)}{1 - P(D=1 \\mid E=1)}}{\\frac{P(D=1 \\mid E=0)}{1 - P(D=1 \\mid E=0)}}$$\n这就是比值比的推导表达式。\n\n第二步是使用所提供的概率计算 $RR$ 和 $OR$ 的数值：\n$P(D=1 \\mid E=1) = 0.3$\n$P(D=1 \\mid E=0) = 0.2$\n\n首先，我们计算风险比（$RR$）：\n$$RR = \\frac{P(D=1 \\mid E=1)}{P(D=1 \\mid E=0)} = \\frac{0.3}{0.2} = 1.5$$\n为了以四位有效数字表示该值，我们将其写作 $1.500$。\n\n接下来，我们计算比值比（$OR$）。我们首先计算每个组的比值。\n$Odds_1 = \\frac{0.3}{1 - 0.3} = \\frac{0.3}{0.7}$\n$Odds_0 = \\frac{0.2}{1 - 0.2} = \\frac{0.2}{0.8}$\n\n现在，我们计算这些比值的比率：\n$$OR = \\frac{Odds_1}{Odds_0} = \\frac{0.3/0.7}{0.2/0.8} = \\frac{0.3 \\times 0.8}{0.7 \\times 0.2} = \\frac{0.24}{0.14} = \\frac{24}{14} = \\frac{12}{7}$$\n将其表示为四舍五入到四位有效数字的小数：\n$$OR \\approx 1.7142857...$$\n四舍五入到四位有效数字得到 $1.714$。\n\n计算出的值为 $RR = 1.500$ 和 $OR = 1.714$。正如对常见疾病所预期的那样，比值比（$1.714$）是风险比（$1.500$）的一个较差的近似，高估了其量值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.500  1.714\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在现实世界的研究中，暴露与疾病之间的关联常常受到混杂变量的干扰。本练习将介绍分层分析和 Mantel-Haenszel 方法，这是一种经典的流行病学技术，用于调整混杂因素的影响，从而获得一个更准确的合并关联估计值。通过处理分层数据，你将学会如何在存在混杂时提炼出更真实的效应大小 。",
            "id": "4638789",
            "problem": "一项病例对照研究旨在调查某项暴露与一种疾病之间的关联，并根据一个潜在的混杂因素进行分层。该研究设计根据疾病状态进行抽样：病例（患有该疾病的个体）和对照（未患该疾病的个体）。根据该混杂因素定义了两个层。对于每个层，观察到的计数如下：\n\n- 第 $1$ 层：暴露病例 $a_{1} = 120$，暴露对照 $b_{1} = 90$，非暴露病例 $c_{1} = 80$，非暴露对照 $d_{1} = 210$。\n- 第 $2$ 层：暴露病例 $a_{2} = 60$，暴露对照 $b_{2} = 40$，非暴露病例 $c_{2} = 140$，非暴露对照 $d_{2} = 260$。\n\n根据基本定义，在病例对照研究中，病例组的暴露比值是暴露病例与非暴露病例之比，对照组的暴露比值是暴露对照与非暴露对照之比。请从这些定义出发，用单元格计数 $(a_{i}, b_{i}, c_{i}, d_{i})$ 推导出第 $1$ 层和第 $2$ 层的层特异性比值比。然后，假设各层之间存在一个共同比值比，并使用基于 Mantel-Haenszel 方法的条件估计原理，推导出基于这两个层的共同比值比的合并估计量的表达式，并根据上述数据集计算其值。\n\n运用混杂控制和效应修饰的基本原理，简要讨论在病例对照研究中，跨层合并在何种条件下是合适的，并指出层特异性比值比的同质性和各层可比性的作用。\n\n仅报告 Mantel-Haenszel 合并比值比，结果为四舍五入到 $4$ 位有效数字的小数。最终报告的数字不需要单位。",
            "solution": "该问题要求从一项病例对照研究中推导并计算层特异性比值比和合并比值比，然后讨论合并程序背后的原理。\n\n首先，验证问题陈述。\n**步骤 1：提取已知信息**\n- 研究设计：分层病例对照研究。\n- 第 $1$ 层数据：暴露病例 $a_{1} = 120$，暴露对照 $b_{1} = 90$，非暴露病例 $c_{1} = 80$，非暴露对照 $d_{1} = 210$。\n- 第 $2$ 层数据：暴露病例 $a_{2} = 60$，暴露对照 $b_{2} = 40$，非暴露病例 $c_{2} = 140$，非暴露对照 $d_{2} = 260$。\n- 定义：病例中的暴露比值 = (暴露病例) / (非暴露病例)。\n- 定义：对照中的暴露比值 = (暴露对照) / (非暴露对照)。\n- 假设：为进行合并，各层存在一个共同的比值比。\n- 任务：推导层特异性比值比 ($OR_i$) 的表达式。\n- 任务：推导共同比值比的 Mantel-Haenszel 合并估计量 ($OR_{MH}$) 的表达式。\n- 任务：根据给定数据计算 $OR_{MH}$ 的值，并四舍五入到 $4$ 位有效数字。\n- 任务：讨论在何种条件下合并是合适的。\n\n**步骤 2：使用提取的已知信息进行验证**\n- 该问题在科学上基于流行病学和生物统计学的既定原则，特别是关于病例对照研究设计、分层、混杂、效应修饰和 Mantel-Haenszel 方法。\n- 该问题提法明确，提供了所有必要的数值数据和清晰的定义，以执行所需的推导和计算。明确陈述了共同比值比的假设，这是所要求计算的必要条件。\n- 该问题是客观的，使用精确的术语和定量数据，没有主观论断。\n- 该问题是完整的、一致的、现实的，并且结构严谨。它没有违反任何无效标准。\n\n**步骤 3：结论和行动**\n该问题被视为有效。将提供完整的解答。\n\n**层特异性比值比的推导与计算**\n\n对于给定的层 $i$，数据可以整理成一个 $2 \\times 2$ 表格：\n|             | 病例  | 对照     |\n|-------------|-------|----------|\n| 暴露        | $a_i$ | $b_i$    |\n| 非暴露      | $c_i$ | $d_i$    |\n\n根据所提供的定义，第 $i$ 层病例中的暴露比值由以下公式给出：\n$$ \\text{Odds}_{\\text{cases}, i} = \\frac{a_i}{c_i} $$\n第 $i$ 层对照中的暴露比值为：\n$$ \\text{Odds}_{\\text{controls}, i} = \\frac{b_i}{d_i} $$\n第 $i$ 层的比值比 ($OR$) 是这两个比值的比率：\n$$ OR_i = \\frac{\\text{Odds}_{\\text{cases}, i}}{\\text{Odds}_{\\text{controls}, i}} = \\frac{a_i / c_i}{b_i / d_i} = \\frac{a_i d_i}{b_i c_i} $$\n这是标准的交叉乘积比。\n\n使用所提供的数据：\n对于第 $1$ 层：\n$a_{1} = 120$, $b_{1} = 90$, $c_{1} = 80$, $d_{1} = 210$。\n$$ OR_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{120 \\times 210}{90 \\times 80} = \\frac{25200}{7200} = 3.5 $$\n\n对于第 $2$ 层：\n$a_{2} = 60$, $b_{2} = 40$, $c_{2} = 140$, $d_{2} = 260$。\n$$ OR_2 = \\frac{a_2 d_2}{b_2 c_2} = \\frac{60 \\times 260}{40 \\times 140} = \\frac{15600}{5600} = \\frac{156}{56} = \\frac{39}{14} \\approx 2.7857 $$\n\n**Mantel-Haenszel 合并比值比的推导与计算**\n\nMantel-Haenszel 方法用于在真实比值比同质的假设下，估计跨多个层的共同比值比。该方法提供了一个合并估计值，该估计值针对分层变量的混杂效应进行了调整。该估计量是作为加权平均值构建的，但加权的不是层特异性比值比本身，而是构成它们的单元格计数。\n\n对于 $k$ 个层，共同比值比的 Mantel-Haenszel 估计量 $OR_{MH}$ 由以下公式给出：\n$$ OR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{N_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{N_i}} $$\n其中 $N_i = a_i + b_i + c_i + d_i$ 是第 $i$ 层中的受试者总数。每个层对总分子 ($a_i d_i$) 和总分母 ($b_i c_i$) 的贡献都由该层总大小的倒数 $1/N_i$ 进行加权。这种加权方案使得信息量更多的层（即方差更小的层）具有更大的影响力。\n\n现在，我们为给定的数据（$k=2$）计算这个值。\n首先，计算每个层的总大小 $N_i$：\n对于第 $1$ 层：$N_1 = 120 + 90 + 80 + 210 = 500$。\n对于第 $2$ 层：$N_2 = 60 + 40 + 140 + 260 = 500$。\n\n接下来，计算分子和分母总和的加权分量：\n对于第 $1$ 层：\n分子分量：$\\frac{a_1 d_1}{N_1} = \\frac{120 \\times 210}{500} = \\frac{25200}{500} = 50.4$。\n分母分量：$\\frac{b_1 c_1}{N_1} = \\frac{90 \\times 80}{500} = \\frac{7200}{500} = 14.4$。\n\n对于第 $2$ 层：\n分子分量：$\\frac{a_2 d_2}{N_2} = \\frac{60 \\times 260}{500} = \\frac{15600}{500} = 31.2$。\n分母分量：$\\frac{b_2 c_2}{N_2} = \\frac{40 \\times 140}{500} = \\frac{5600}{500} = 11.2$。\n\n最后，通过将这些分量相加来计算合并比值比：\n$$ OR_{MH} = \\frac{50.4 + 31.2}{14.4 + 11.2} = \\frac{81.6}{25.6} = 3.1875 $$\n四舍五入到 $4$ 位有效数字，结果是 $3.188$。\n\n**关于合并条件的讨论**\n\n将层特异性估计值合并成单一汇总指标（如 Mantel-Haenszel 比值比）的适宜性，取决于混杂控制和不存在效应修饰的基本原则。\n\n1.  **比值比的同质性（不存在效应修饰）：** 合并最关键的假设是比值比在所有层中是恒定的，即同质的。分层变量不应是“效应修饰因子”。当暴露与疾病之间关联的大小或方向在分层变量的不同水平上存在差异时，就存在效应修饰（或交互作用）。如果层特异性比值比（例如 $OR_1$ 和 $OR_2$）有显著差异，则表明暴露对疾病的影响取决于所在的层。在这种情况下，将估计值合并成一个单一数字在科学上是无效且具有误导性的，因为它会掩盖这一重要发现。正确的做法是分别报告层特异性比值比，并得出分层变量修饰了暴露效应的结论。正式的统计检验，如 Breslow-Day 检验或逻辑回归模型中交互作用项的似然比检验，可用于评估这一同质性假设。在本问题中，我们被明确指示要假设存在一个共同的比值比。\n\n2.  **混杂控制：** 分层和合并的主要目的是控制混杂。混杂因素是既与暴露相关又与结局相关，并能扭曲它们之间表面关系的变量。通过在混杂因素的每个层内计算比值比，其效应被保持恒定。如果粗略（未分层）比值比与（同质的）层特异性比值比有显著差异，则存在混杂。合并估计量 $OR_{MH}$ 提供了一个关联性的汇总度量，该度量在统计上对混杂因素的效应进行了调整。与粗略比值比相比，它代表了对真实暴露-疾病关系的更准确估计。在本问题中，粗略比值比约为 2.96，这与层特异性比值比（$3.5$ 和 $\\approx 2.79$）以及合并比值比（$3.1875$）差异巨大，表明分层变量造成了强烈的混杂。因此，有必要提供一个调整后的估计值。\n\n总而言之，当存在混杂时，为了获得一个单一的、调整后的关联度量，进行合并是合适的，但这仅限于各层间效应同质的假设成立时。",
            "answer": "$$\\boxed{3.188}$$"
        }
    ]
}