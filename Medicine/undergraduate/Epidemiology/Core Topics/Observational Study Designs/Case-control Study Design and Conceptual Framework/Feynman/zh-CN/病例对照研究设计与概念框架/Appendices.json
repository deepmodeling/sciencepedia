{
    "hands_on_practices": [
        {
            "introduction": "比值比（Odds Ratio, $OR$）是病例对照研究中衡量关联强度的主要指标。本次练习将指导您完成从一个标准的 $2 \\times 2$ 表格中计算 $OR$ 及其95%置信区间的基本步骤。掌握这项技能至关重要，因为它使您能够得出一个效应的点估计值并量化其统计精确度，这是此类研究中数据分析的基础。",
            "id": "4574844",
            "problem": "一项病例对照研究旨在调查二元暴露与二元疾病之间的关联。研究人员招募了 $N_{D} = a + c$ 名病例和 $N_{\\bar{D}} = b + d$ 名对照，记录其暴露状态，形成一个 $2 \\times 2$ 的四格表，其单元格计数分别为 $a$（暴露病例）、$b$（暴露对照）、$c$（非暴露病例）和 $d$（非暴露对照）。假设病例和对照的抽样是独立的，暴露测量无差异，并且在大样本条件下，对数比值比的最大似然估计量（MLE）是渐近正态的。\n\n从比值（odds）和比值比（odds ratio）的基本定义出发，其中病例中暴露的比值为 $\\text{odds}_{D} = \\frac{P(E \\mid D)}{P(\\bar{E} \\mid D)}$，对照中暴露的比值为 $\\text{odds}_{\\bar{D}} = \\frac{P(E \\mid \\bar{D})}{P(\\bar{E} \\mid \\bar{D})}$，比值比（OR）定义为 $\\text{OR} = \\frac{\\text{odds}_{D}}{\\text{odds}_{\\bar{D}}}$。根据大样本理论，$\\log(\\text{OR})$ 的估计量近似服从正态分布，其方差可通过一阶近似从单元格计数中导出。\n\n假设观察到的计数为 $a = 75$，$b = 30$，$c = 25$，$d = 70$。使用病例对照研究的概念框架和大样本近似，按以下步骤进行：\n- 从定义中推导出比值比的估计量。\n- 从单元格计数中推导出 $\\log(\\text{OR})$ 估计量的大样本方差。\n- 利用 $\\log(\\text{OR})$ 的渐近正态性，为比值比构建一个置信水平为 $0.95$ 的双侧置信区间（CI），方法是将对数尺度上的置信区间转换回比值比尺度。\n\n最后，仅报告比值比的双侧 $0.95$ 置信区间的下限，以小数形式表示，并四舍五入到四位有效数字。答案中无需单位。",
            "solution": "该问题要求根据一项病例对照研究的数据，计算比值比（OR）的 $0.95$ 置信区间的下限。解答将按要求分三个阶段进行：首先，推导比值比的估计量；其次，推导该估计量对数的大样本方差；第三，构建置信区间并使用所提供的数据计算其下限。\n\n该问题经验证是合理的。它在科学上基于流行病学和生物统计学的既定原则，问题阐述清晰，信息充分且一致，并且陈述客观。\n\n**1. 比值比估计量的推导**\n\n比值比定义为病例（$D$）中暴露的比值与对照（$\\bar{D}$）中暴露的比值之比。\n设 $E$ 表示暴露，$\\bar{E}$ 表示非暴露。病例组中暴露的比值为：\n$$\n\\text{odds}_{D} = \\frac{P(E \\mid D)}{P(\\bar{E} \\mid D)} = \\frac{P(E \\mid D)}{1 - P(E \\mid D)}\n$$\n对照组中暴露的比值为：\n$$\n\\text{odds}_{\\bar{D}} = \\frac{P(E \\mid \\bar{D})}{P(\\bar{E} \\mid \\bar{D})} = \\frac{P(E \\mid \\bar{D})}{1 - P(E \\mid \\bar{D})}\n$$\n真实的比值比是这两个量之比：\n$$\n\\text{OR} = \\frac{\\text{odds}_{D}}{\\text{odds}_{\\bar{D}}}\n$$\n在病例对照研究中，我们抽取固定数量的病例 $N_{D} = a+c$ 和固定数量的对照 $N_{\\bar{D}} = b+d$。在这些样本中，我们可以直接估计暴露的条件概率。给定病例身份的暴露概率 $P(E \\mid D)$ 的最大似然估计量（MLE）是暴露病例的样本比例：\n$$\n\\hat{P}(E \\mid D) = \\frac{a}{a+c}\n$$\n类似地，给定病例身份的非暴露概率的 MLE 为：\n$$\n\\hat{P}(\\bar{E} \\mid D) = \\frac{c}{a+c}\n$$\n因此，病例中暴露比值的估计量为：\n$$\n\\widehat{\\text{odds}}_{D} = \\frac{\\hat{P}(E \\mid D)}{\\hat{P}(\\bar{E} \\mid D)} = \\frac{a / (a+c)}{c / (a+c)} = \\frac{a}{c}\n$$\n类似的逻辑也适用于对照组：\n$$\n\\hat{P}(E \\mid \\bar{D}) = \\frac{b}{b+d} \\quad \\text{和} \\quad \\hat{P}(\\bar{E} \\mid \\bar{D}) = \\frac{d}{b+d}\n$$\n对照组中暴露比值的估计量为：\n$$\n\\widehat{\\text{odds}}_{\\bar{D}} = \\frac{\\hat{P}(E \\mid \\bar{D})}{\\hat{P}(\\bar{E} \\mid \\bar{D})} = \\frac{b / (b+d)}{d / (b+d)} = \\frac{b}{d}\n$$\n比值比的估计量，记为 $\\widehat{\\text{OR}}$，是这些估计比值的比，通常称为交叉乘积比：\n$$\n\\widehat{\\text{OR}} = \\frac{\\widehat{\\text{odds}}_{D}}{\\widehat{\\text{odds}}_{\\bar{D}}} = \\frac{a/c}{b/d} = \\frac{ad}{bc}\n$$\n\n**2. $\\log(\\widehat{\\text{OR}})$ 的大样本方差的推导**\n\n$\\widehat{\\text{OR}}$ 的分布通常是偏态的。然而，其自然对数 $\\log(\\widehat{\\text{OR}})$ 在大样本量下近似服从正态分布。令 $\\hat{\\theta} = \\log(\\widehat{\\text{OR}})$。\n$$\n\\hat{\\theta} = \\log\\left(\\frac{ad}{bc}\\right) = \\log(a) + \\log(d) - \\log(b) - \\log(c)\n$$\n$\\hat{\\theta}$ 的方差可以使用 delta 方法推导。一个称为 Woolf 方法的标准结果是，$\\log(\\widehat{\\text{OR}})$ 方差的大样本近似值是各单元格计数的倒数之和。这可以通过以下考虑来证明：在病例和对照独立抽样的情况下，暴露对象的计数 $a$ 和 $b$ 是独立的二项随机变量：$a \\sim \\text{Bin}(N_D, p_1)$ 和 $b \\sim \\text{Bin}(N_{\\bar{D}}, p_2)$，其中 $p_1 = P(E|D)$ 且 $p_2 = P(E|\\bar{D})$。量 $\\hat{\\theta}$ 可以写成 $\\text{logit}(\\hat{p}_1) - \\text{logit}(\\hat{p}_2)$，其中 $\\hat{p}_1 = a/N_D$ 且 $\\hat{p}_2=b/N_{\\bar{D}}$。\n根据 delta 方法，二项比例 $\\hat{p} = k/n$ 的 logit 变换的方差近似为 $\\frac{1}{np(1-p)}$。通过代入观察到的计数进行估计，得到 $\\frac{1}{k} + \\frac{1}{n-k}$。\n将此应用于我们的独立样本：\n$$\n\\text{Var}(\\hat{\\theta}) = \\text{Var}(\\text{logit}(\\hat{p}_1)) + \\text{Var}(\\text{logit}(\\hat{p}_2)) \\approx \\left(\\frac{1}{a} + \\frac{1}{c}\\right) + \\left(\\frac{1}{b} + \\frac{1}{d}\\right)\n$$\n因此，$\\log(\\widehat{\\text{OR}})$ 方差的估计量为：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}\n$$\n\n**3. 置信区间的构建与计算**\n\n在大样本假设下，估计量 $\\hat{\\theta} = \\log(\\widehat{\\text{OR}})$ 服从正态分布：\n$$\n\\log(\\widehat{\\text{OR}}) \\sim \\mathcal{N}\\left(\\log(\\text{OR}), \\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}}))\\right)\n$$\n$\\log(\\widehat{\\text{OR}})$ 的标准误（SE）是其方差的平方根：\n$$\n\\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}}\n$$\n$\\log(\\text{OR})$ 的一个双侧 $100(1-\\alpha)\\%$ 置信区间构建如下：\n$$\n\\log(\\widehat{\\text{OR}}) \\pm z_{1-\\alpha/2} \\times \\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}}))\n$$\n其中 $z_{1-\\alpha/2}$ 是来自标准正态分布的临界值。对于 $0.95$ 的置信水平，$\\alpha=0.05$，因此 $1-\\alpha/2 = 0.975$。相应的临界值是 $z_{0.975} \\approx 1.96$。\n\n为了获得 $\\text{OR}$ 本身的置信区间，我们对 $\\log(\\text{OR})$ 区间的下限和上限取指数。$\\text{OR}$ 的下限是：\n$$\n\\text{LL}_{\\text{OR}} = \\exp\\left[\\log(\\widehat{\\text{OR}}) - z_{1-\\alpha/2} \\times \\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}}))\\right]\n$$\n现在，我们代入给定的单元格计数：$a = 75$，$b = 30$，$c = 25$，$d = 70$。\n\n首先，计算点估计值 $\\widehat{\\text{OR}}$：\n$$\n\\widehat{\\text{OR}} = \\frac{ad}{bc} = \\frac{75 \\times 70}{30 \\times 25} = \\frac{5250}{750} = 7\n$$\n接下来，计算 $\\log(\\widehat{\\text{OR}})$ 的方差和标准误：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{1}{75} + \\frac{1}{30} + \\frac{1}{25} + \\frac{1}{70}\n$$\n使用公分母 $1050$：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{14}{1050} + \\frac{35}{1050} + \\frac{42}{1050} + \\frac{15}{1050} = \\frac{14+35+42+15}{1050} = \\frac{106}{1050} = \\frac{53}{525}\n$$\n数值上，$\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) \\approx 0.10095238$。\n标准误是：\n$$\n\\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}})) = \\sqrt{\\frac{53}{525}} \\approx 0.3177300\n$$\n现在我们构建 $\\log(\\text{OR})$ 的 $0.95$ 置信区间。点估计值为 $\\log(\\widehat{\\text{OR}}) = \\ln(7) \\approx 1.945910$。\n$\\log(\\text{OR})$ 的下限是：\n$$\n\\text{LL}_{\\log(\\text{OR})} = \\ln(7) - 1.96 \\times \\sqrt{\\frac{53}{525}} \\approx 1.945910 - 1.96 \\times 0.3177300 \\approx 1.945910 - 0.6227508 \\approx 1.3231592\n$$\n最后，我们通过对这个值取指数来计算 $\\text{OR}$ 的下限：\n$$\n\\text{LL}_{\\text{OR}} = \\exp(1.3231592) \\approx 3.75515\n$$\n按要求四舍五入到四位有效数字，下限为 $3.755$。",
            "answer": "$$\\boxed{3.755}$$"
        },
        {
            "introduction": "虽然我们从病例对照研究中直接计算的是比值比（$OR$），但我们通常希望推断风险比（Risk Ratio, $RR$），这是一个更直观的效应衡量指标。本次练习探讨了 $OR$ 和 $RR$ 之间的精确数学关系，揭示了人群中的基线风险如何影响两者之间的一致性。通过解决这个问题，您将学会如何定量评估“罕见病假设”是否成立，这是正确解读研究结果的一项关键技能。",
            "id": "4574814",
            "problem": "一项关于职业性溶剂暴露与一种神经退行性疾病的病例对照研究报告称，暴露与疾病之间的关联性的比值比 (OR) 为 $OR = 1.8$。来自同一人群的独立队列研究数据提供了 $P_0 = 0.03$ 的基线（未暴露）疾病风险。使用风险比 (RR) 为 $RR = \\frac{P_1}{P_0}$ 和比值比 (OR) 为 $OR = \\frac{P_1/(1 - P_1)}{P_0/(1 - P_0)}$ 的标准流行病学定义（其中 $P_1$ 是暴露人群中的疾病风险），从第一性原理推导计算 $RR$ 作为 $OR$ 和 $P_0$ 函数所需的关系，计算数值差异 $OR - RR$，然后根据以下量化标准评估罕见病假设是否可接受：如果 $\\lvert OR - RR \\rvert  0.05$ 且 $P_0 \\leq 0.10$，则该假设可接受。将最终的数值差异四舍五入至四位有效数字。将最终的数值差异表示为无量纲数。",
            "solution": "首先对问题陈述进行验证程序。\n\n### 步骤1：提取已知条件\n-   暴露与疾病关联的比值比：$OR = 1.8$。\n-   基线疾病风险（未暴露）：$P_0 = 0.03$。\n-   风险比 (RR) 的定义：$RR = \\frac{P_1}{P_0}$，其中 $P_1$ 是暴露人群中的疾病风险。\n-   比值比 (OR) 的定义：$OR = \\frac{P_1/(1 - P_1)}{P_0/(1 - P_0)}$。\n-   任务1：推导计算 $RR$ 作为 $OR$ 和 $P_0$ 函数的关系。\n-   任务2：计算数值差异 $OR - RR$。\n-   任务3：根据量化标准评估罕见病假设：如果 $|OR - RR|  0.05$ 且 $P_0 \\leq 0.10$，则可接受。\n-   取整说明：将最终数值差异四舍五入至四位有效数字。\n-   单位说明：最终数值差异是无量纲数。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n-   **科学依据**：该问题使用了流行病学领域关于关联度量（$OR$，$RR$）和风险（$P_0$，$P_1$）的标准定义和关系。所提供的值（$OR = 1.8$，$P_0 = 0.03$）对于流行病学研究是切合实际的。问题的核心在于探索比值比和风险比之间的数学关系，这是该领域的一个基本概念。\n-   **良态问题**：该问题是良态的。它提供了所有必要的定义、常数和明确的量化评估标准。它要求进行特定的推导和后续计算，并且存在唯一解。\n-   **客观性**：问题以精确、客观的语言陈述。接受罕见病假设的标准是明确且量化定义的，没有主观解释的余地。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、是良态的且客观的。它不包含任何不一致、模糊之处或事实错误。可以继续解答过程。\n\n解答过程按要求分为三个部分：推导风险比（$RR$）的函数关系，计算数值差异 $OR - RR$，以及评估罕见病假设的指定标准。\n\n**第1部分：推导RR作为OR和$P_0$的函数**\n\n我们从比值比（$OR$）的定义开始：\n$$ OR = \\frac{P_1 / (1 - P_1)}{P_0 / (1 - P_0)} $$\n我们的目标是用 $OR$ 和 $P_0$ 表示 $RR = P_1/P_0$。为此，我们必须首先求解 $P_1$。我们重新排列 $OR$ 方程，以分离出暴露组中的疾病发生比值，$P_1 / (1 - P_1)$：\n$$ \\frac{P_1}{1 - P_1} = OR \\cdot \\left( \\frac{P_0}{1 - P_0} \\right) $$\n为简化代数运算，令右侧为 $K$，即 $K = OR \\cdot \\frac{P_0}{1 - P_0}$。方程变为：\n$$ \\frac{P_1}{1 - P_1} = K $$\n我们现在求解 $P_1$：\n$$ P_1 = K(1 - P_1) $$\n$$ P_1 = K - K \\cdot P_1 $$\n$$ P_1 + K \\cdot P_1 = K $$\n$$ P_1(1 + K) = K $$\n$$ P_1 = \\frac{K}{1 + K} $$\n将 $K$ 的表达式代回此方程：\n$$ P_1 = \\frac{OR \\cdot \\frac{P_0}{1 - P_0}}{1 + OR \\cdot \\frac{P_0}{1 - P_0}} $$\n为了简化这个繁分数，我们将分子和分母同乘以 $(1 - P_0)$：\n$$ P_1 = \\frac{OR \\cdot P_0}{(1 - P_0) + OR \\cdot P_0} $$\n现在，我们使用风险比的定义，$RR = P_1 / P_0$：\n$$ RR = \\frac{1}{P_0} \\left( \\frac{OR \\cdot P_0}{1 - P_0 + OR \\cdot P_0} \\right) $$\n$P_0$ 项被消掉，得到所需的关系：\n$$ RR = \\frac{OR}{1 - P_0 + OR \\cdot P_0} $$\n这个表达式可以重新整理，以突显 $P_0$ 在 $RR$ 偏离 $OR$ 中所起的作用：\n$$ RR = \\frac{OR}{1 + P_0(OR - 1)} $$\n这就是所要求的 $RR$ 作为 $OR$ 和 $P_0$ 函数的关系。\n\n**第2部分：计算数值差异 $OR - RR$**\n\n已知 $OR = 1.8$ 和 $P_0 = 0.03$。我们将这些值代入推导出的 $RR$ 公式中：\n$$ RR = \\frac{1.8}{1 + 0.03(1.8 - 1)} $$\n$$ RR = \\frac{1.8}{1 + 0.03(0.8)} $$\n$$ RR = \\frac{1.8}{1 + 0.024} $$\n$$ RR = \\frac{1.8}{1.024} $$\n$RR$ 的值约为 $1.7578125$。\n接下来，我们计算差异 $OR - RR$：\n$$ OR - RR = 1.8 - \\frac{1.8}{1.024} $$\n$$ OR - RR = 1.8 - 1.7578125 $$\n$$ OR - RR = 0.0421875 $$\n问题要求将此结果四舍五入到四位有效数字。第一个非零数字是 $4$，因此前四位有效数字是 $4$、$2$、$1$ 和 $8$。第五位有效数字是 $7$，大于等于 $5$，所以我们将最后一位数字向上取整。\n$$ OR - RR \\approx 0.04219 $$\n\n**第3部分：评估罕见病假设**\n\n罕见病假设可接受的标准有两方面：\n1.  $|OR - RR|  0.05$\n2.  $P_0 \\leq 0.10$\n\n我们使用计算出的值检查这两个条件。\n1.  根据我们的计算， $|OR - RR| \\approx |0.04219| = 0.04219$。条件是 $0.04219  0.05$，这是成立的。\n2.  已知 $P_0 = 0.03$。条件是 $0.03 \\leq 0.10$，这也是成立的。\n\n由于两个条件都得到满足，根据指定的量化标准，使用比值比作为风险比的近似值（“罕见病假设”）被认为是可接受的。问题要求计算数值差异，我们已经计算并进行了四舍五入。",
            "answer": "$$\\boxed{0.04219}$$"
        },
        {
            "introduction": "病例对照研究的有效性在很大程度上取决于病例的正确选择。使用现患病例（prevalent cases）而非新发病例（incident cases）可能会导致严重的选择偏倚，即奈曼偏倚（Neyman bias），特别是当所研究的暴露因素也会影响发病后的生存时间时。本次练习通过一个假设情景，演示了如何量化这种偏倚的程度，从而强调了在旨在探索病因学的研究中招募新发病例的至关重要性。",
            "id": "4574846",
            "problem": "一个群体处于人口学和流行病学稳态，存在罕见病 $D$ 和二元暴露 $E$。您计划进行一项病例-对照研究来估计暴露 $E$ 与疾病 $D$ 之间的关联。对照组将从风险人群中在固定的日历时间进行抽样。对于病例，您有两种选择：新发病例（在诊断时确定）或现患病例（与对照组在同一日历时间确定）。在稳定条件下，通过高质量的监测可获得以下数据：\n\n- 在暴露人群中，疾病 $D$ 的发病率为每 $1000$ 人年 $7$ 例；在非暴露人群中，为每 $1000$ 人年 $4$ 例。\n- 疾病 $D$ 的诊断后生存时间可以很好地用具有恒定风险的指数分布来近似。暴露病例的死亡风险为每年 $0.10$，非暴露病例的死亡风险为每年 $0.25$。\n\n仅使用基本的流行病学定义和上述信息，计算在此设计中使用现患病例而非新发病例，会对暴露-疾病比值比产生的乘性偏倚因子。将最终答案表示为无量纲量。将答案四舍五入至四位有效数字。",
            "solution": "在采用密度抽样的新发病例-对照研究设计中，目标估计量是发病率比，即暴露人群和非暴露人群的发病率之比。令 $I_{E}$ 表示暴露人群的发病率，$I_{U}$ 表示非暴露人群的发病率。在适当的密度抽样下，新发病例-对照研究的比值比是发病率比的一致估计，因此目标是 $I_{E}/I_{U}$。\n\n当病例是在某个日历时间点作为现患病例进行抽样时，被选入病例组的概率与患病个体带病存活的时间长短成正比。在人口学和流行病学稳态以及疾病罕见的情况下，某一时点的患病率与发病率和平均病程的乘积成正比。形式上，对于组 $g \\in \\{E, U\\}$，时点患病率满足 $P_{g} \\propto I_{g} \\times L_{g}$，其中 $L_{g}$ 是组 $g$ 中病例的平均诊断后生存时间。\n\n因此，在从风险人群中同时抽样对照组的现患病例-对照研究中，其比值比正比于\n$$\n\\frac{I_{E} \\times L_{E}}{I_{U} \\times L_{U}}.\n$$\n相对于新发病例-对照研究的目标比值比 $I_{E}/I_{U}$，由使用现患病例引起的乘性偏倚因子 $B$ 为\n$$\nB \\equiv \\frac{\\left(I_{E} \\times L_{E}\\right)/\\left(I_{U} \\times L_{U}\\right)}{I_{E}/I_{U}} = \\frac{L_{E}}{L_{U}}.\n$$\n\n为了从生存风险中计算 $L_{E}$ 和 $L_{U}$，注意到风险（率）参数为 $\\mu$ 的指数分布的均值是风险的倒数：\n$$\nL = \\int_{0}^{\\infty} S(t)\\,dt = \\int_{0}^{\\infty} \\exp(-\\mu t)\\,dt = \\frac{1}{\\mu}.\n$$\n因此，\n$$\nL_{E} = \\frac{1}{\\mu_{E}} = \\frac{1}{0.10} = 10,\n\\quad\nL_{U} = \\frac{1}{\\mu_{U}} = \\frac{1}{0.25} = 4.\n$$\n那么偏倚因子为\n$$\nB = \\frac{L_{E}}{L_{U}} = \\frac{10}{4} = 2.5.\n$$\n\n从方向上解释，$B  1$ 表明使用现患病例会相对于新发病例的目标值夸大比值比，因为暴露病例平均生存时间更长，导致他们在现患病例中占比过高。其大小为 $2.5$，意味着与新发病例的比值比相比，现患病例的比值比将乘以 $2.5$，这是一个很大的影响；因此，建议限定为新发病例，以避免这种由生存差异引起的选择偏倚。\n\n四舍五入至四位有效数字，无量纲的偏倚因子为 $2.500$。",
            "answer": "$$\\boxed{2.500}$$"
        }
    ]
}