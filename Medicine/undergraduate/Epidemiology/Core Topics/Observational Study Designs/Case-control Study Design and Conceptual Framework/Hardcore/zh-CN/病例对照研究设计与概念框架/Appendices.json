{
    "hands_on_practices": [
        {
            "introduction": "在病例对照研究中，比值比（Odds Ratio, $OR$）是衡量暴露与疾病之间关联强度的核心指标。这个练习将带你从一个标准的 $2 \\times 2$ 表格数据出发，亲手计算 $OR$ 的点估计值及其置信区间，这是分析病例对照研究数据的第一步 。掌握这一基本计算，是量化关联效应和进行更复杂分析的基础。",
            "id": "4574844",
            "problem": "一项病例对照研究旨在调查一种二元暴露与一种二元疾病之间的关联。研究人员招募了 $N_{D} = a + c$ 名病例和 $N_{\\bar{D}} = b + d$ 名对照，记录其暴露状态，形成一个 $2 \\times 2$ 四格表，其单元格计数分别为 $a$（暴露病例）、$b$（暴露对照）、$c$（非暴露病例）和 $d$（非暴露对照）。假设病例和对照的抽样是独立的，暴露测量无差异，并且在大样本条件下，对数优势比的最大似然估计量（MLE）是渐近正态的。\n\n从优势和优势比的基本定义出发，病例组的暴露优势为 $\\text{odds}_{D} = \\frac{P(E \\mid D)}{P(\\bar{E} \\mid D)}$，对照组的暴露优势为 $\\text{odds}_{\\bar{D}} = \\frac{P(E \\mid \\bar{D})}{P(\\bar{E} \\mid \\bar{D})}$，优势比（OR）定义为 $\\text{OR} = \\frac{\\text{odds}_{D}}{\\text{odds}_{\\bar{D}}}$。根据大样本理论，$\\log(\\text{OR})$ 的估计量近似服从正态分布，其方差可通过一阶近似从单元格计数中推导出。\n\n假设观察到的计数为 $a = 75$、$b = 30$、$c = 25$ 和 $d = 70$。请使用病例对照研究的概念框架和大样本近似方法，按以下步骤进行：\n- 从定义推导出优势比的估计量。\n- 从单元格计数推导出 $\\log(\\text{OR})$ 估计量的大样本方差。\n- 利用 $\\log(\\text{OR})$ 的渐近正态性，为优势比构建一个置信水平为 $0.95$ 的双侧置信区间（CI），方法是将对数尺度上的置信区间转换回优势比尺度。\n\n最后，仅报告优势比的双侧 $0.95$ 置信区间的下限，以十进制形式表示，并四舍五入到四位有效数字。答案中不需要单位。",
            "solution": "该问题要求根据一项病例对照研究的数据，计算优势比（OR）的 $0.95$ 置信区间的下限。解题过程将按要求分三个阶段进行：首先，推导优势比的估计量；其次，推导该估计量对数的大样本方差；第三，构建置信区间并使用所提供的数据计算其下限。\n\n该问题经验证是合理的。它在科学上基于流行病学和生物统计学的既定原则，问题表述清晰，信息充分且一致，陈述客观。\n\n**1. 优势比估计量的推导**\n\n优势比定义为病例组（$D$）的暴露优势与对照组（$\\bar{D}$）的暴露优势之比。\n令 $E$ 表示暴露，$\\bar{E}$ 表示非暴露。病例组中的暴露优势为：\n$$\n\\text{odds}_{D} = \\frac{P(E \\mid D)}{P(\\bar{E} \\mid D)} = \\frac{P(E \\mid D)}{1 - P(E \\mid D)}\n$$\n对照组中的暴露优势为：\n$$\n\\text{odds}_{\\bar{D}} = \\frac{P(E \\mid \\bar{D})}{P(\\bar{E} \\mid \\bar{D})} = \\frac{P(E \\mid \\bar{D})}{1 - P(E \\mid \\bar{D})}\n$$\n真实的优势比是这两个量的比值：\n$$\n\\text{OR} = \\frac{\\text{odds}_{D}}{\\text{odds}_{\\bar{D}}}\n$$\n在病例对照研究中，我们抽取固定数量的病例 $N_{D} = a+c$ 和固定数量的对照 $N_{\\bar{D}} = b+d$。在这些样本中，我们可以直接估计暴露的条件概率。在给定病例状态下暴露概率 $P(E \\mid D)$ 的最大似然估计量（MLE）是暴露病例的样本比例：\n$$\n\\hat{P}(E \\mid D) = \\frac{a}{a+c}\n$$\n类似地，在给定病例状态下非暴露概率的 MLE 为：\n$$\n\\hat{P}(\\bar{E} \\mid D) = \\frac{c}{a+c}\n$$\n因此，病例组中暴露优势的估计量为：\n$$\n\\widehat{\\text{odds}}_{D} = \\frac{\\hat{P}(E \\mid D)}{\\hat{P}(\\bar{E} \\mid D)} = \\frac{a / (a+c)}{c / (a+c)} = \\frac{a}{c}\n$$\n类似的逻辑也适用于对照组：\n$$\n\\hat{P}(E \\mid \\bar{D}) = \\frac{b}{b+d} \\quad \\text{和} \\quad \\hat{P}(\\bar{E} \\mid \\bar{D}) = \\frac{d}{b+d}\n$$\n对照组中暴露优势的估计量为：\n$$\n\\widehat{\\text{odds}}_{\\bar{D}} = \\frac{\\hat{P}(E \\mid \\bar{D})}{\\hat{P}(\\bar{E} \\mid \\bar{D})} = \\frac{b / (b+d)}{d / (b+d)} = \\frac{b}{d}\n$$\n优势比的估计量，记为 $\\widehat{\\text{OR}}$，是这些估计优势的比值，通常称为交叉乘积比：\n$$\n\\widehat{\\text{OR}} = \\frac{\\widehat{\\text{odds}}_{D}}{\\widehat{\\text{odds}}_{\\bar{D}}} = \\frac{a/c}{b/d} = \\frac{ad}{bc}\n$$\n\n**2. $\\log(\\widehat{\\text{OR}})$ 的大样本方差推导**\n\n$\\widehat{\\text{OR}}$ 的分布通常是偏态的。然而，其自然对数 $\\log(\\widehat{\\text{OR}})$ 在大样本量下近似服从正态分布。令 $\\hat{\\theta} = \\log(\\widehat{\\text{OR}})$。\n$$\n\\hat{\\theta} = \\log\\left(\\frac{ad}{bc}\\right) = \\log(a) + \\log(d) - \\log(b) - \\log(c)\n$$\n$\\hat{\\theta}$ 的方差可以使用 delta 方法推导。一个标准结果，即 Woolf 方法，表明 $\\log(\\widehat{\\text{OR}})$ 方差的大样本近似值是各单元格计数的倒数之和。其理由是，在病例和对照独立抽样的情况下，暴露对象的计数 $a$ 和 $b$ 是独立的二项随机变量：$a \\sim \\text{Bin}(N_D, p_1)$ 和 $b \\sim \\text{Bin}(N_{\\bar{D}}, p_2)$，其中 $p_1 = P(E|D)$ 且 $p_2 = P(E|\\bar{D})$。量 $\\hat{\\theta}$ 可以写成 $\\text{logit}(\\hat{p}_1) - \\text{logit}(\\hat{p}_2)$，其中 $\\hat{p}_1 = a/N_D$ 且 $\\hat{p}_2=b/N_{\\bar{D}}$。\n根据 delta 方法，二项比例 $\\hat{p} = k/n$ 的 logit 的方差近似为 $\\frac{1}{np(1-p)}$。通过代入观察到的计数进行估计，得到 $\\frac{1}{k} + \\frac{1}{n-k}$。\n将此应用于我们的独立样本：\n$$\n\\text{Var}(\\hat{\\theta}) = \\text{Var}(\\text{logit}(\\hat{p}_1)) + \\text{Var}(\\text{logit}(\\hat{p}_2)) \\approx \\left(\\frac{1}{a} + \\frac{1}{c}\\right) + \\left(\\frac{1}{b} + \\frac{1}{d}\\right)\n$$\n因此，$\\log(\\widehat{\\text{OR}})$ 方差的估计量为：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}\n$$\n\n**3. 置信区间的构建与计算**\n\n在大样本假设下，估计量 $\\hat{\\theta} = \\log(\\widehat{\\text{OR}})$ 服从正态分布：\n$$\n\\log(\\widehat{\\text{OR}}) \\sim \\mathcal{N}\\left(\\log(\\text{OR}), \\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}}))\\right)\n$$\n$\\log(\\widehat{\\text{OR}})$ 的标准误（SE）是其方差的平方根：\n$$\n\\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}}\n$$\n$\\log(\\text{OR})$ 的一个双侧 $100(1-\\alpha)\\%$ 置信区间构建如下：\n$$\n\\log(\\widehat{\\text{OR}}) \\pm z_{1-\\alpha/2} \\times \\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}}))\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的临界值。对于 $0.95$ 的置信水平，$\\alpha=0.05$，因此 $1-\\alpha/2 = 0.975$。对应的临界值是 $z_{0.975} \\approx 1.96$。\n\n为了获得 $\\text{OR}$ 本身的置信区间，我们对 $\\log(\\text{OR})$ 区间的下限和上限取指数。$\\text{OR}$ 的下限是：\n$$\n\\text{LL}_{\\text{OR}} = \\exp\\left[\\log(\\widehat{\\text{OR}}) - z_{1-\\alpha/2} \\times \\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}}))\\right]\n$$\n现在，我们代入给定的单元格计数：$a = 75$、$b = 30$、$c = 25$ 和 $d = 70$。\n\n首先，计算点估计值 $\\widehat{\\text{OR}}$：\n$$\n\\widehat{\\text{OR}} = \\frac{ad}{bc} = \\frac{75 \\times 70}{30 \\times 25} = \\frac{5250}{750} = 7\n$$\n接下来，计算 $\\log(\\widehat{\\text{OR}})$ 的方差和标准误：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{1}{75} + \\frac{1}{30} + \\frac{1}{25} + \\frac{1}{70}\n$$\n使用公分母 $1050$：\n$$\n\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) = \\frac{14}{1050} + \\frac{35}{1050} + \\frac{42}{1050} + \\frac{15}{1050} = \\frac{14+35+42+15}{1050} = \\frac{106}{1050} = \\frac{53}{525}\n$$\n数值上，$\\widehat{\\text{Var}}(\\log(\\widehat{\\text{OR}})) \\approx 0.10095238$。\n标准误为：\n$$\n\\widehat{\\text{SE}}(\\log(\\widehat{\\text{OR}})) = \\sqrt{\\frac{53}{525}} \\approx 0.3177300\n$$\n现在我们构建 $\\log(\\text{OR})$ 的 $0.95$ 置信区间。点估计值为 $\\log(\\widehat{\\text{OR}}) = \\ln(7) \\approx 1.945910$。\n$\\log(\\text{OR})$ 的下限是：\n$$\n\\text{LL}_{\\log(\\text{OR})} = \\ln(7) - 1.96 \\times \\sqrt{\\frac{53}{525}} \\approx 1.945910 - 1.96 \\times 0.3177300 \\approx 1.945910 - 0.6227508 \\approx 1.3231592\n$$\n最后，我们通过对该值取指数来计算 $\\text{OR}$ 的下限：\n$$\n\\text{LL}_{\\text{OR}} = \\exp(1.3231592) \\approx 3.75515\n$$\n按要求四舍五入到四位有效数字，下限为 $3.755$。",
            "answer": "$$\\boxed{3.755}$$"
        },
        {
            "introduction": "我们从病例对照研究中计算出比值比（$OR$），但通常更希望了解直观的风险比（Risk Ratio, $RR$）。此练习通过一个具体的计算任务，探讨了 $OR$ 和 $RR$ 之间的定量关系，揭示了基线疾病风险如何影响两者的一致性 。通过这项实践，你将能更深刻地理解“罕见病假设”的实际意义和应用条件，这是正确解读研究结果的关键。",
            "id": "4574814",
            "problem": "一项关于职业性溶剂暴露与一种神经退行性疾病的病例对照研究报告称，暴露与疾病之间关联的比值比（OR）为 $OR = 1.8$。来自同一人群的独立队列数据显示，基线（未暴露）疾病风险为 $P_0 = 0.03$。使用标准流行病学定义，风险比（RR）为 $RR = \\frac{P_1}{P_0}$，比值比（OR）为 $OR = \\frac{P_1/(1 - P_1)}{P_0/(1 - P_0)}$，其中 $P_1$ 是暴露人群中的疾病风险。请从第一性原理出发，推导出计算 $RR$ 作为 $OR$ 和 $P_0$ 函数所需的关系式，计算数值差异 $OR - RR$，然后根据以下量化标准评估罕见病假设是否可接受：如果 $\\lvert OR - RR \\rvert  0.05$ 且 $P_0 \\leq 0.10$，则该假设可接受。将最终的数值差异四舍五入到四位有效数字。将最终的数值差异表示为一个无量纲数。",
            "solution": "首先对问题陈述进行验证程序。\n\n### 步骤1：提取已知条件\n-   暴露与疾病之间关联的比值比：$OR = 1.8$。\n-   基线疾病风险（未暴露）：$P_0 = 0.03$。\n-   风险比（RR）的定义：$RR = \\frac{P_1}{P_0}$，其中 $P_1$ 是暴露人群中的疾病风险。\n-   比值比（OR）的定义：$OR = \\frac{P_1/(1 - P_1)}{P_0/(1 - P_0)}$。\n-   任务1：推导计算 $RR$ 作为 $OR$ 和 $P_0$ 函数的关系式。\n-   任务2：计算数值差异 $OR - RR$。\n-   任务3：根据量化标准评估罕见病假设：如果 $|OR - RR|  0.05$ 且 $P_0 \\leq 0.10$，则可接受。\n-   取整说明：将最终的数值差异四舍五入到四位有效数字。\n-   单位说明：最终的数值差异是一个无量纲数。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n-   **科学依据**：该问题使用了流行病学领域关于关联度量（$OR$, $RR$）和风险（$P_0$, $P_1$）的标准定义和关系。所提供的值（$OR = 1.8$, $P_0 = 0.03$）对于流行病学研究是现实的。问题的核心在于探讨比值比和风险比之间的数学关系，这是该领域的一个基本概念。\n-   **适定性**：该问题是适定的。它提供了所有必要的定义、常数和明确的评估量化标准。它要求进行特定的推导和后续计算，存在唯一解。\n-   **客观性**：问题以精确、客观的语言陈述。接受罕见病假设的标准被明确且量化地定义，没有主观解释的余地。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定性和客观性。它不包含任何不一致、模糊或事实错误。可以继续进行求解过程。\n\n解答过程按要求分为三部分：推导风险比（$RR$）的函数关系，计算数值差异 $OR - RR$，以及评估罕见病假设的指定标准。\n\n**第1部分：推导 RR 作为 OR 和 $P_0$ 的函数**\n\n我们从比值比（$OR$）的定义开始：\n$$ OR = \\frac{P_1 / (1 - P_1)}{P_0 / (1 - P_0)} $$\n我们的目标是用 $OR$ 和 $P_0$ 来表示 $RR = P_1/P_0$。为此，我们必须首先解出 $P_1$。我们重排 $OR$ 方程，以分离出暴露组的疾病比值 $P_1 / (1 - P_1)$：\n$$ \\frac{P_1}{1 - P_1} = OR \\cdot \\left( \\frac{P_0}{1 - P_0} \\right) $$\n为简化代数运算，令右侧为 $K$，即 $K = OR \\cdot \\frac{P_0}{1 - P_0}$。方程变为：\n$$ \\frac{P_1}{1 - P_1} = K $$\n现在我们求解 $P_1$：\n$$ P_1 = K(1 - P_1) $$\n$$ P_1 = K - K \\cdot P_1 $$\n$$ P_1 + K \\cdot P_1 = K $$\n$$ P_1(1 + K) = K $$\n$$ P_1 = \\frac{K}{1 + K} $$\n将 $K$ 的表达式代回此方程：\n$$ P_1 = \\frac{OR \\cdot \\frac{P_0}{1 - P_0}}{1 + OR \\cdot \\frac{P_0}{1 - P_0}} $$\n为简化这个复合分数，我们将分子和分母同乘以 $(1 - P_0)$：\n$$ P_1 = \\frac{OR \\cdot P_0}{(1 - P_0) + OR \\cdot P_0} $$\n现在，我们使用风险比的定义，$RR = P_1 / P_0$：\n$$ RR = \\frac{1}{P_0} \\left( \\frac{OR \\cdot P_0}{1 - P_0 + OR \\cdot P_0} \\right) $$\n项 $P_0$ 被消去，得到所需的关系式：\n$$ RR = \\frac{OR}{1 - P_0 + OR \\cdot P_0} $$\n这个表达式可以被重排，以突出 $P_0$ 在 $RR$ 偏离 $OR$ 过程中的作用：\n$$ RR = \\frac{OR}{1 + P_0(OR - 1)} $$\n这就是所要求的 $RR$ 作为 $OR$ 和 $P_0$ 的函数关系式。\n\n**第2部分：计算数值差异 $OR - RR$**\n\n我们已知 $OR = 1.8$ 和 $P_0 = 0.03$。我们将这些值代入推导出的 $RR$ 公式中：\n$$ RR = \\frac{1.8}{1 + 0.03(1.8 - 1)} $$\n$$ RR = \\frac{1.8}{1 + 0.03(0.8)} $$\n$$ RR = \\frac{1.8}{1 + 0.024} $$\n$$ RR = \\frac{1.8}{1.024} $$\n$RR$ 的值约为 $1.7578125$。\n接下来，我们计算差异 $OR - RR$：\n$$ OR - RR = 1.8 - \\frac{1.8}{1.024} $$\n$$ OR - RR = 1.8 - 1.7578125 $$\n$$ OR - RR = 0.0421875 $$\n问题要求将此结果四舍五入到四位有效数字。第一个非零数字是 $4$，所以前四位有效数字是 $4$、$2$、$1$ 和 $8$。第五位有效数字是 $7$，由于 $7 \\geq 5$，所以我们对最后一位进行进位。\n$$ OR - RR \\approx 0.04219 $$\n\n**第3部分：评估罕见病假设**\n\n罕见病假设可接受的标准有两条：\n1.  $|OR - RR|  0.05$\n2.  $P_0 \\leq 0.10$\n\n我们使用计算出的值来检查这两个条件。\n1.  根据我们的计算， $|OR - RR| \\approx |0.04219| = 0.04219$。条件是 $0.04219  0.05$，这是成立的。\n2.  我们已知 $P_0 = 0.03$。条件是 $0.03 \\leq 0.10$，这也是成立的。\n\n由于两个条件都满足，根据指定的量化标准，使用比值比作为风险比的近似（即“罕见病假设”）被认为是可接受的。问题要求的是数值差异，我们已经计算并进行了四舍五入。",
            "answer": "$$\\boxed{0.04219}$$"
        },
        {
            "introduction": "一项研究的有效性在很大程度上取决于其设计。本练习将探讨一个关键的设计抉择：是选择新诊断的病例（新发病例）还是研究特定时间点的现有病例（现患病例）。你将学习如何量化因选择现患病例而可能引入的选择偏倚（即生存偏倚），这对于避免研究结论出现严重偏差至关重要。",
            "id": "4574846",
            "problem": "一个群体处于人口学和流行病学稳态，存在罕见病 $D$ 和二元暴露 $E$。您计划进行一项病例对照研究，以估计 $E$ 和 $D$ 之间的关联性。对照组将在一个固定的日历时间点从风险人群中抽样。对于病例，您有两种选择：新发病例（在诊断时确定）或现患病例（与对照组在同一日历时间点确定）。在稳定条件下，通过高质量监测可获得以下数据：\n\n- 在暴露组中，$D$ 的发病率为每 $1000$ 人年 $7$ 例；在非暴露组中，为每 $1000$ 人年 $4$ 例。\n- $D$ 的诊断后生存时间可以很好地由具有恒定风险率的指数分布来近似。暴露组病例的死亡风险率为每年 $0.10$，非暴露组病例的死亡风险率为每年 $0.25$。\n\n仅使用基础流行病学定义和上述信息，计算在该设计中因使用现患病例而非新发病例而导致的暴露-疾病比值比的乘性偏倚因子。将最终答案表示为一个无量纲量。将答案四舍五入到四位有效数字。",
            "solution": "在采用密度抽样的新发病例对照研究设计中，目标估计量是发病率比，即暴露组与非暴露组的发病率之比。令 $I_{E}$ 表示暴露组的发病率，$I_{U}$ 表示非暴露组的发病率。在适当的密度抽样下，新发病例对照研究的比值比是发病率比的一致估计，因此目标是 $I_{E}/I_{U}$。\n\n当病例是在某一特定日历时间点作为现患病例被抽样时，被选入病例组的概率与患病个体的带病存活时间成正比。在人口学和流行病学稳态以及疾病罕见的条件下，时点患病率与发病率和平均患病持续时间的乘积成正比。形式上，对于组 $g \\in \\{E, U\\}$，时点患病率满足 $P_{g} \\propto I_{g} \\times L_{g}$，其中 $L_{g}$ 是组 $g$ 中病例的平均诊断后生存时间。\n\n因此，在对照组与病例组于同一时间从风险人群中抽样的现患病例对照研究中，其比值比正比于\n$$\n\\frac{I_{E} \\times L_{E}}{I_{U} \\times L_{U}}.\n$$\n相对于新发病例对照研究的目标比值比 $I_{E}/I_{U}$，使用现患病例引入的乘性偏倚因子 $B$ 是\n$$\nB \\equiv \\frac{\\left(I_{E} \\times L_{E}\\right)/\\left(I_{U} \\times L_{U}\\right)}{I_{E}/I_{U}} = \\frac{L_{E}}{L_{U}}.\n$$\n\n为了从生存风险率计算 $L_{E}$ 和 $L_{U}$，需要注意风险（率）参数为 $\\mu$ 的指数分布的均值是该风险率的倒数：\n$$\nL = \\int_{0}^{\\infty} S(t)\\,dt = \\int_{0}^{\\infty} \\exp(-\\mu t)\\,dt = \\frac{1}{\\mu}.\n$$\n因此，\n$$\nL_{E} = \\frac{1}{\\mu_{E}} = \\frac{1}{0.10} = 10,\n\\quad\nL_{U} = \\frac{1}{\\mu_{U}} = \\frac{1}{0.25} = 4.\n$$\n那么偏倚因子是\n$$\nB = \\frac{L_{E}}{L_{U}} = \\frac{10}{4} = 2.5.\n$$\n\n从方向上解释，$B > 1$ 表明使用现患病例会相对于新发病例的目标值夸大比值比，因为暴露组病例平均存活时间更长，导致他们在现患病例中被过度代表。其大小为 $2.5$，意味着与新发病例的比值比相比，现患病例的比值比将被乘以 $2.5$，这是一个很大的影响；因此，建议限定研究于新发病例，以避免这种由生存期差异导致的选择偏倚。\n\n四舍五入到四位有效数字，无量纲的偏倚因子是 $2.500$。",
            "answer": "$$\\boxed{2.500}$$"
        }
    ]
}