{
    "hands_on_practices": [
        {
            "introduction": "The first step in understanding a scientific approximation is to see precisely where it deviates from the exact value. This exercise provides a concrete numerical scenario to do just that. By starting with a known risk ratio ($RR$) and a baseline disease risk ($p_0$), you will calculate the exact odds ratio ($OR$) and quantify the relative error, giving you a tangible sense of the discrepancy when a disease is not exceptionally rare .",
            "id": "4645537",
            "problem": "Consider a prospective cohort study evaluating an exposure suspected to increase the risk of a disease. Let the cumulative incidence (risk) in the unexposed group be $p_0$, and let the relative risk (RR) be defined by $\\text{RR} = p_1 / p_0$, where $p_1$ is the risk in the exposed group. The odds in a group with risk $p$ are defined as $p/(1-p)$, and the odds ratio (OR) between exposed and unexposed is the ratio of the odds in the exposed group to the odds in the unexposed group. The “rare disease assumption” posits that when $p$ is small, the odds $p/(1-p)$ are well approximated by $p$, which underlies the first-order approximation $\\text{OR} \\approx \\text{RR}$.\n\nUsing only these fundamental definitions, for $p_0 = 0.05$ and $\\text{RR} = 3$:\n\n- Compute the exact $\\text{OR}$ based on the definitions of odds and odds ratio.\n- Take the first-order rare disease approximation for the odds ratio to be $\\text{RR}$, and compute the relative error between this approximation and the exact value, defined as\n$$\\text{relative error} = \\frac{|\\text{approx} - \\text{exact}|}{|\\text{exact}|}.$$\n- Round your final numerical answer to four significant figures and express it as a decimal (no units).\n- Based on the magnitude of the relative error you compute, briefly state whether the rare disease assumption is defensible in this setting.\n\nDo not use any pre-derived shortcuts for the relationship between $\\text{OR}$ and $\\text{RR}$; derive any needed expressions from the provided definitions.",
            "solution": "The problem asks for the computation of the exact odds ratio ($\\text{OR}$), the relative error of the rare disease approximation ($\\text{OR} \\approx \\text{RR}$), and a judgment on the defensibility of this approximation under the given conditions.\n\nThe provided definitions and values are:\n- The cumulative incidence (risk) in the unexposed group: $p_0 = 0.05$.\n- The relative risk: $\\text{RR} = 3$.\n- The definition of relative risk: $\\text{RR} = \\frac{p_1}{p_0}$, where $p_1$ is the risk in the exposed group.\n- The odds for a group with risk $p$: $\\frac{p}{1-p}$.\n- The odds ratio: $\\text{OR} = \\frac{\\text{odds}_{\\text{exposed}}}{\\text{odds}_{\\text{unexposed}}}$.\n\nFirst, we determine the risk in the exposed group, $p_1$, using the definition of relative risk:\n$$p_1 = \\text{RR} \\times p_0$$\nSubstituting the given values:\n$$p_1 = 3 \\times 0.05 = 0.15$$\n\nNext, we calculate the odds for both the unexposed and exposed groups using the definition of odds, $\\frac{p}{1-p}$.\n\nFor the unexposed group, the odds are:\n$$\\text{odds}_0 = \\frac{p_0}{1-p_0} = \\frac{0.05}{1-0.05} = \\frac{0.05}{0.95}$$\n\nFor the exposed group, the odds are:\n$$\\text{odds}_1 = \\frac{p_1}{1-p_1} = \\frac{0.15}{1-0.15} = \\frac{0.15}{0.85}$$\n\nNow, we compute the exact odds ratio, $\\text{OR}$, which is the ratio of these odds:\n$$\\text{OR}_{\\text{exact}} = \\frac{\\text{odds}_1}{\\text{odds}_0} = \\frac{0.15/0.85}{0.05/0.95}$$\nRearranging the expression to solve:\n$$\\text{OR}_{\\text{exact}} = \\frac{0.15}{0.85} \\times \\frac{0.95}{0.05} = \\frac{0.1425}{0.0425}$$\nThis can be simplified by removing the decimals:\n$$\\text{OR}_{\\text{exact}} = \\frac{1425}{425} = \\frac{57 \\times 25}{17 \\times 25} = \\frac{57}{17}$$\n\nThe problem states that the first-order rare disease approximation for the odds ratio is the relative risk itself. Therefore:\n$$\\text{OR}_{\\text{approx}} = \\text{RR} = 3$$\n\nWe are asked to compute the relative error between this approximation and the exact value, using the formula:\n$$\\text{relative error} = \\frac{|\\text{approx} - \\text{exact}|}{|\\text{exact}|}$$\nSubstituting the values for $\\text{OR}_{\\text{approx}}$ and $\\text{OR}_{\\text{exact}}$:\n$$\\text{relative error} = \\frac{|3 - \\frac{57}{17}|}{|\\frac{57}{17}|}$$\nTo evaluate the numerator, we find a common denominator:\n$$3 - \\frac{57}{17} = \\frac{3 \\times 17}{17} - \\frac{57}{17} = \\frac{51 - 57}{17} = -\\frac{6}{17}$$\nNow, we substitute this back into the relative error formula:\n$$\\text{relative error} = \\frac{|-\\frac{6}{17}|}{\\frac{57}{17}} = \\frac{\\frac{6}{17}}{\\frac{57}{17}} = \\frac{6}{57}$$\nSimplifying the fraction:\n$$\\text{relative error} = \\frac{6 \\div 3}{57 \\div 3} = \\frac{2}{19}$$\nTo express this as a decimal rounded to four significant figures:\n$$\\frac{2}{19} \\approx 0.10526315...$$\nRounding to four significant figures gives $0.1053$.\n\nFinally, we must assess whether the rare disease assumption is defensible. A relative error of $0.1053$ corresponds to an error of $10.53\\%$. This is a significant discrepancy. The approximation ($\\text{RR}=3$) underestimates the true odds ratio ($\\text{OR} = \\frac{57}{17} \\approx 3.353$) by over $10\\%$. The underlying reason is that the baseline risk, $p_0=0.05$, is not sufficiently small for the \"rare disease\" condition ($p \\ll 1$) to hold well, especially when combined with a strong effect ($\\text{RR}=3$) that elevates the risk in the exposed group to $p_1=0.15$. In many scientific and clinical contexts, a potential error of this magnitude is unacceptable. Therefore, the rare disease assumption is not defensible in this setting.",
            "answer": "$$\\boxed{0.1053}$$"
        },
        {
            "introduction": "Building upon a single calculation, this next practice challenges you to explore the rare disease assumption more systematically. You will derive the exact mathematical relationship between the risk ratio ($RR$) and the odds ratio ($OR$) to see how the approximation's accuracy depends directly on the baseline risk in the unexposed population ($p_0$). This exercise is key to understanding *why* the term 'rare' is so critical to the assumption .",
            "id": "4645560",
            "problem": "A case-control study estimates an odds ratio (OR) of $\\text{OR}=2.5$ for the association between a binary exposure and a rare disease. An external cohort provides baseline risks in the unexposed group $\\{p_0\\}=\\{0.01,\\,0.05,\\,0.10,\\,0.20\\}$. Starting solely from the core definitions of risk, odds, odds ratio, and risk ratio, and standard algebra, perform the following:\n\n1. Let $p_0=\\Pr(D=1\\mid E=0)$ and $p_1=\\Pr(D=1\\mid E=1)$. Use the definitions of odds, odds ratio, and risk ratio to express the exact risk ratio $\\text{RR}$ in terms of $\\text{OR}$ and $p_0$ without introducing any additional assumptions beyond those definitions. Then, evaluate $\\text{RR}$ for $\\text{OR}=2.5$ at each $p_0\\in\\{0.01,\\,0.05,\\,0.10,\\,0.20\\}$.\n\n2. Define the deviation from the rare disease approximation $\\text{RR}\\approx \\text{OR}$ as the absolute relative deviation $\\delta(p_0)=\\left|\\text{RR}-\\text{OR}\\right|/\\text{OR}$. Compute $\\delta(p_0)$ for each $p_0\\in\\{0.01,\\,0.05,\\,0.10,\\,0.20\\}$.\n\nReport, as your final answer, the row vector of $\\delta(p_0)$ values ordered by $p_0=0.01,\\,0.05,\\,0.10,\\,0.20$. Express each entry as a decimal and round your answer to $4$ significant figures.",
            "solution": "**1. Derivation of the Risk Ratio ($\\text{RR}$) in terms of Odds Ratio ($\\text{OR}$) and baseline risk ($p_0$)**\n\nFirst, we state the core definitions:\n- Risk in the unexposed group: $p_0 = \\Pr(D=1 \\mid E=0)$.\n- Risk in the exposed group: $p_1 = \\Pr(D=1 \\mid E=1)$.\n\nThe odds of disease in each group are the ratio of the probability of having the disease to the probability of not having it.\n- Odds in the unexposed group: $\\text{odds}_0 = \\frac{\\Pr(D=1 \\mid E=0)}{\\Pr(D=0 \\mid E=0)} = \\frac{p_0}{1 - p_0}$.\n- Odds in the exposed group: $\\text{odds}_1 = \\frac{\\Pr(D=1 \\mid E=1)}{\\Pr(D=0 \\mid E=1)} = \\frac{p_1}{1 - p_1}$.\n\nThe Odds Ratio ($\\text{OR}$) is the ratio of the odds in the exposed group to the odds in the unexposed group:\n$$ \\text{OR} = \\frac{\\text{odds}_1}{\\text{odds}_0} = \\frac{p_1 / (1 - p_1)}{p_0 / (1 - p_0)} $$\nThe Risk Ratio ($\\text{RR}$) is the ratio of the risk in the exposed group to the risk in the unexposed group:\n$$ \\text{RR} = \\frac{p_1}{p_0} $$\nOur objective is to express $\\text{RR}$ as a function of $\\text{OR}$ and $p_0$. To do this, we must eliminate $p_1$. From the definition of $\\text{RR}$, we can write $p_1 = \\text{RR} \\cdot p_0$. We substitute this into the equation for $\\text{OR}$:\n$$ \\text{OR} = \\frac{(\\text{RR} \\cdot p_0) / (1 - \\text{RR} \\cdot p_0)}{p_0 / (1 - p_0)} $$\nNow, we perform algebraic manipulation to solve for $\\text{RR}$.\n$$ \\text{OR} = \\frac{\\text{RR} \\cdot p_0}{1 - \\text{RR} \\cdot p_0} \\cdot \\frac{1 - p_0}{p_0} $$\nThe term $p_0$ cancels out, assuming $p_0 \\neq 0$:\n$$ \\text{OR} = \\text{RR} \\cdot \\frac{1 - p_0}{1 - \\text{RR} \\cdot p_0} $$\nMultiply both sides by $(1 - \\text{RR} \\cdot p_0)$:\n$$ \\text{OR} \\cdot (1 - \\text{RR} \\cdot p_0) = \\text{RR} \\cdot (1 - p_0) $$\nDistribute the terms:\n$$ \\text{OR} - \\text{OR} \\cdot \\text{RR} \\cdot p_0 = \\text{RR} - \\text{RR} \\cdot p_0 $$\nGroup all terms containing $\\text{RR}$ on one side of the equation:\n$$ \\text{OR} = \\text{RR} - \\text{RR} \\cdot p_0 + \\text{OR} \\cdot \\text{RR} \\cdot p_0 $$\nFactor out $\\text{RR}$:\n$$ \\text{OR} = \\text{RR} \\cdot (1 - p_0 + \\text{OR} \\cdot p_0) $$\n$$ \\text{OR} = \\text{RR} \\cdot (1 + p_0(\\text{OR} - 1)) $$\nFinally, isolating $\\text{RR}$ gives the exact relationship:\n$$ \\text{RR} = \\frac{\\text{OR}}{1 + p_0(\\text{OR} - 1)} $$\nThis completes the first part of Task 1. Now, we evaluate $\\text{RR}$ for $\\text{OR} = 2.5$ and the given values of $p_0$. The expression becomes:\n$$ \\text{RR} = \\frac{2.5}{1 + p_0(2.5 - 1)} = \\frac{2.5}{1 + 1.5 p_0} $$\nFor each $p_0$:\n- If $p_0 = 0.01$: $\\text{RR} = \\frac{2.5}{1 + 1.5(0.01)} = \\frac{2.5}{1.015} \\approx 2.46305$\n- If $p_0 = 0.05$: $\\text{RR} = \\frac{2.5}{1 + 1.5(0.05)} = \\frac{2.5}{1.075} \\approx 2.32558$\n- If $p_0 = 0.10$: $\\text{RR} = \\frac{2.5}{1 + 1.5(0.10)} = \\frac{2.5}{1.15} \\approx 2.17391$\n- If $p_0 = 0.20$: $RR = \\frac{2.5}{1 + 1.5(0.20)} = \\frac{2.5}{1.30} \\approx 1.92308$\n\n**2. Calculation of the Absolute Relative Deviation $\\delta(p_0)$**\n\nThe deviation is defined as $\\delta(p_0) = \\frac{|\\text{RR} - \\text{OR}|}{\\text{OR}}$.\nWe can substitute the expression for $\\text{RR}$ into this definition. Since we have $\\text{OR} = 2.5  1$ and $p_0 \\ge 0$, the denominator $1 + p_0(\\text{OR} - 1) \\ge 1$. This implies that $\\text{RR} \\le \\text{OR}$, so the absolute value $|\\text{RR} - \\text{OR}|$ simplifies to $\\text{OR} - \\text{RR}$.\n$$ \\delta(p_0) = \\frac{\\text{OR} - \\text{RR}}{\\text{OR}} = 1 - \\frac{\\text{RR}}{\\text{OR}} $$\nSubstituting the expression for $\\text{RR}$:\n$$ \\delta(p_0) = 1 - \\frac{1}{\\text{OR}} \\left( \\frac{\\text{OR}}{1 + p_0(\\text{OR} - 1)} \\right) = 1 - \\frac{1}{1 + p_0(\\text{OR} - 1)} $$\nSimplifying this expression by finding a common denominator:\n$$ \\delta(p_0) = \\frac{1 + p_0(\\text{OR} - 1) - 1}{1 + p_0(\\text{OR} - 1)} = \\frac{p_0(\\text{OR} - 1)}{1 + p_0(\\text{OR} - 1)} $$\nThis simplified formula shows that the deviation increases as $p_0$ increases, which is consistent with the principles of the rare disease assumption.\n\nNow, we compute $\\delta(p_0)$ for $\\text{OR} = 2.5$ and the given values of $p_0$:\n$$ \\delta(p_0) = \\frac{p_0(2.5 - 1)}{1 + p_0(2.5 - 1)} = \\frac{1.5 p_0}{1 + 1.5 p_0} $$\n- For $p_0 = 0.01$:\n  $\\delta(0.01) = \\frac{1.5(0.01)}{1 + 1.5(0.01)} = \\frac{0.015}{1.015} \\approx 0.014778325$\n- For $p_0 = 0.05$:\n  $\\delta(0.05) = \\frac{1.5(0.05)}{1 + 1.5(0.05)} = \\frac{0.075}{1.075} \\approx 0.069767442$\n- For $p_0 = 0.10$:\n  $\\delta(0.10) = \\frac{1.5(0.10)}{1 + 1.5(0.10)} = \\frac{0.15}{1.15} \\approx 0.130434783$\n- For $p_0 = 0.20$:\n  $\\delta(0.20) = \\frac{1.5(0.20)}{1 + 1.5(0.20)} = \\frac{0.30}{1.30} \\approx 0.230769231$\n\nFinally, we round these results to $4$ significant figures as required for the final answer.\n- $\\delta(0.01) \\approx 0.01478$\n- $\\delta(0.05) \\approx 0.06977$\n- $\\delta(0.10) \\approx 0.1304$\n- $\\delta(0.20) \\approx 0.2308$\n\nThese values are formatted into a row vector for the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01478  0.06977  0.1304  0.2308\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Epidemiological research rarely happens in a perfect world with flawless measurements. This advanced practice introduces the crucial real-world complication of outcome misclassification and its impact on the rare disease assumption. You will develop a computational sensitivity analysis to investigate how uncertainty in diagnostic accuracy (sensitivity $Se$ and specificity $Sp$) and baseline risk ($p_0$) combine to affect the true risk ratio inferred from an observed odds ratio, a vital skill for critically appraising published research .",
            "id": "4645563",
            "problem": "You are given an observed odds ratio $OR^\\ast$ for the association between a binary exposure $E$ and a binary, imperfectly classified outcome $D^\\ast$. Assume non-differential outcome misclassification, meaning the classification performance is identical in the exposed and unexposed groups. Let $Se$ denote sensitivity, $Sp$ denote specificity of the outcome classification (for the true disease status $D$), and let $p_0$ denote the true baseline risk of disease in the unexposed group, expressed as a decimal in $[0,1]$. The rare disease assumption asserts that for small $p_0$, the odds ratio approximates the risk ratio. Your task is to build a sensitivity analysis framework that explores plausible ranges for $Se$, $Sp$, and $p_0$ and quantifies the uncertainty in the rare disease approximation for the observed odds ratio $OR^\\ast$.\n\nFundamental definitions and setup to use:\n- Sensitivity $Se$ is the probability $P(D^\\ast=1 \\mid D=1)$.\n- Specificity $Sp$ is the probability $P(D^\\ast=0 \\mid D=0)$.\n- The true risks are $p_0 = P(D=1 \\mid E=0)$ and $p_1 = P(D=1 \\mid E=1)$, and the true risk ratio is $RR = p_1 / p_0$.\n- Under non-differential outcome misclassification, the observed risks are linear transformations of the true risks:\n  $$p^\\ast = Se \\cdot p + (1 - Sp)\\cdot(1 - p) = (Se + Sp - 1)\\,p + (1 - Sp),$$\n  applied to $p_0$ and $p_1$ respectively.\n- The observed odds ratio is defined by\n  $$OR^\\ast = \\frac{\\dfrac{p_1^\\ast}{1 - p_1^\\ast}}{\\dfrac{p_0^\\ast}{1 - p_0^\\ast}}.$$\n- The rare disease approximation treats $RR \\approx OR$ when $p_0$ is sufficiently small and outcome classification is perfect, but here you must quantify the approximation error when outcome classification may be imperfect and $p_0$ varies within a plausible range.\n\nYour program must, for each provided test case, perform the following:\n1. Construct an equally spaced grid of $11$ points for each parameter within its specified closed interval: $Se \\in [Se_{\\min}, Se_{\\max}]$, $Sp \\in [Sp_{\\min}, Sp_{\\max}]$, and $p_0 \\in [p_{0,\\min}, p_{0,\\max}]$.\n2. For each grid point $(Se, Sp, p_0)$, compute the implied true risk ratio $RR$ that is algebraically consistent with the given $OR^\\ast$ under the misclassification model above. Use the relationship $p_1 = RR \\cdot p_0$ and the definition of $OR^\\ast$ in terms of the odds of $p_1^\\ast$ and $p_0^\\ast$. Treat only parameter combinations where $Se + Sp - 1  0$ and the resulting $RR$ yields $0  RR \\cdot p_0  1$; discard combinations that lead to invalid probabilities or division by zero in the algebraic solution.\n3. For the accepted combinations, compute the minimum and maximum of $RR$ over the grid, and compute the maximum absolute deviation of $RR$ from the naive rare disease approximation that uses $OR^\\ast$ directly as an estimate of $RR$. That is, compute\n   $$\\max\\limits_{\\text{grid}} \\left| RR - OR^\\ast \\right|.$$\n\nYour output for each test case must be a list of three floats in the order:\n- the minimum $RR$ over the accepted grid points,\n- the maximum $RR$ over the accepted grid points,\n- the maximum absolute deviation $\\max |RR - OR^\\ast|$ over the accepted grid points.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case’s result is itself a list of three floats. For example: \"[[min1,max1,max_abs_dev1],[min2,max2,max_abs_dev2],...]\". Express all probabilities ($Se$, $Sp$, $p_0$) and ratios ($OR^\\ast$, $RR$) as decimals without percentage signs.\n\nTest Suite:\n- Test Case 1 (typical rare outcome, good but imperfect classification):\n  - $OR^\\ast = 2.5$,\n  - $Se \\in [0.85, 0.95]$,\n  - $Sp \\in [0.90, 0.99]$,\n  - $p_0 \\in [0.005, 0.02]$.\n- Test Case 2 (near-perfect classification, very rare outcome):\n  - $OR^\\ast = 1.8$,\n  - $Se \\in [0.98, 1.0]$,\n  - $Sp \\in [0.98, 1.0]$,\n  - $p_0 \\in [0.001, 0.005]$.\n- Test Case 3 (moderate prevalence, lower specificity range):\n  - $OR^\\ast = 3.0$,\n  - $Se \\in [0.70, 0.90]$,\n  - $Sp \\in [0.85, 0.95]$,\n  - $p_0 \\in [0.05, 0.10]$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with the structure \"[[minRR1,maxRR1,maxAbsDev1],[minRR2,maxRR2,maxAbsDev2],[minRR3,maxRR3,maxAbsDev3]]\". Round each reported float to six decimal places.",
            "solution": "The problem requires the development of a sensitivity analysis framework to evaluate the impact of non-differential outcome misclassification on the relationship between an observed odds ratio, $OR^\\ast$, and the true risk ratio, $RR$. This analysis is crucial for understanding the limitations of the rare disease assumption, which posits $OR \\approx RR$, particularly when the outcome classification is imperfect. The framework will systematically explore plausible ranges for the sensitivity ($Se$), specificity ($Sp$), and true baseline disease prevalence in the unexposed group ($p_0$) to quantify the uncertainty in the true $RR$.\n\nThe fundamental principle is to algebraically invert the standard epidemiological model for misclassification to express the true parameter of interest, $RR$, as a function of the observed data, $OR^\\ast$, and the nuisance parameters, $Se$, $Sp$, and $p_0$.\n\nLet us define the core quantities. The true risks in the unexposed and exposed groups are $p_0 = P(D=1 \\mid E=0)$ and $p_1 = P(D=1 \\mid E=1)$, respectively. The true risk ratio is $RR = p_1 / p_0$. The outcome classification performance is defined by sensitivity, $Se = P(D^\\ast=1 \\mid D=1)$, and specificity, $Sp = P(D^\\ast=0 \\mid D=0)$.\n\nUnder non-differential misclassification, the probability of observing the outcome, $p^\\ast$, is a linear function of the true risk, $p$:\n$$p^\\ast = Se \\cdot p + (1 - Sp) \\cdot (1 - p)$$\nThis can be rearranged to a more convenient form:\n$$p^\\ast = (Se + Sp - 1)p + (1 - Sp) \\quad (*)$$\nThis transformation applies to both the unexposed and exposed groups, yielding the observed risks $p_0^\\ast$ and $p_1^\\ast$.\n\nThe observed odds ratio, $OR^\\ast$, is defined by the odds of the observed risks:\n$$OR^\\ast = \\frac{p_1^\\ast / (1 - p_1^\\ast)}{p_0^\\ast / (1 - p_0^\\ast)}$$\n\nOur objective is to solve for $RR$ for a given set of $(OR^\\ast, Se, Sp, p_0)$. The logical procedure is as follows:\n\n1.  **Calculate the observed risk in the unexposed, $p_0^\\ast$**: Given a value for $p_0$ from the sensitivity grid, we apply the transformation in equation $(*)$:\n    $$p_0^\\ast = (Se + Sp - 1)p_0 + (1 - Sp)$$\n\n2.  **Calculate the corresponding observed risk in the exposed, $p_1^\\ast$**: We can rearrange the definition of $OR^\\ast$ to solve for $p_1^\\ast$ in terms of $p_0^\\ast$ and $OR^\\ast$. A standard algebraic manipulation yields:\n    $$p_1^\\ast = \\frac{OR^\\ast \\cdot p_0^\\ast}{1 + p_0^\\ast(OR^\\ast - 1)}$$\n    This expression gives the observed risk in the exposed group that is consistent with the observed odds ratio and the observed risk in the unexposed group.\n\n3.  **Calculate the true risk in the exposed, $p_1$**: To find the true risk $p_1$ that corresponds to the calculated observed risk $p_1^\\ast$, we must invert equation $(*)$. Solving for $p$ gives:\n    $$p = \\frac{p^\\ast - (1 - Sp)}{Se + Sp - 1}$$\n    This inversion is well-defined only if the denominator, $Se + Sp - 1$, is greater than $0$. This quantity, often called Youden's J statistic, being positive implies that the classification is better than random chance. The problem mandates discarding any parameter combinations where this condition is not met. Applying this inversion to $p_1^\\ast$ allows us to recover the true risk in the exposed group:\n    $$p_1 = \\frac{p_1^\\ast - (1 - Sp)}{Se + Sp - 1}$$\n\n4.  **Calculate the true risk ratio, $RR$**: With the true risk $p_1$ now determined, and given the true baseline risk $p_0$, the true risk ratio is simply their quotient:\n    $$RR = \\frac{p_1}{p_0}$$\n\nThis sequence of calculations allows us to determine the unique $RR$ implied by each specific combination of $(OR^\\ast, Se, Sp, p_0)$.\n\nThe computational task involves performing this calculation over a grid of parameters. For each test case, we construct a three-dimensional grid by creating $11$ equally spaced points within the specified intervals for $Se$, $Sp$, and $p_0$. We iterate through every point $(Se_i, Sp_j, p_{0,k})$ in this grid.\n\nFor each point, we execute the four-step procedure described above to compute a candidate $RR$. After the calculation, we must enforce a critical validity constraint: the derived true risk $p_1$ must be a valid probability, i.e., $0  p_1  1$. If a given set of parameters $(Se, Sp, p_0)$ combined with the observed $OR^\\ast$ implies a $p_1$ outside this range, that parameter combination is logically inconsistent with reality and is discarded.\n\nAfter iterating through all $11 \\times 11 \\times 11 = 1331$ grid points and collecting the set of all valid $RR$ values, we compute the required summary statistics:\n-   The minimum $RR$ found across the valid grid points.\n-   The maximum $RR$ found across the valid grid points.\n-   The maximum absolute deviation, $\\max|RR - OR^\\ast|$, which quantifies the worst-case error of the naive approximation that equates the observed odds ratio with the true risk ratio.\n\nThese three statistics provide a concise summary of the range of plausible true effect sizes and the potential for bias due to outcome misclassification, given the uncertainty in the sensitivity analysis parameters.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the sensitivity analysis for all test cases.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {'OR_star': 2.5, 'Se_range': [0.85, 0.95], 'Sp_range': [0.90, 0.99], 'p0_range': [0.005, 0.02]},\n        # Test Case 2\n        {'OR_star': 1.8, 'Se_range': [0.98, 1.0], 'Sp_range': [0.98, 1.0], 'p0_range': [0.001, 0.005]},\n        # Test Case 3\n        {'OR_star': 3.0, 'Se_range': [0.70, 0.90], 'Sp_range': [0.85, 0.95], 'p0_range': [0.05, 0.10]},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        OR_star = case['OR_star']\n        \n        # 1. Construct equally spaced grids for Se, Sp, and p0.\n        se_grid = np.linspace(case['Se_range'][0], case['Se_range'][1], 11)\n        sp_grid = np.linspace(case['Sp_range'][0], case['Sp_range'][1], 11)\n        p0_grid = np.linspace(case['p0_range'][0], case['p0_range'][1], 11)\n        \n        valid_rrs = []\n        \n        # 2. Iterate through each grid point (Se, Sp, p0).\n        for Se in se_grid:\n            for Sp in sp_grid:\n                # The term (Se + Sp - 1) is used frequently.\n                A = Se + Sp - 1\n                \n                # Discard combinations where Se + Sp - 1 = 0.\n                if A = 0:\n                    continue\n                \n                for p0 in p0_grid:\n                    # Calculate observed risk in the unexposed group.\n                    p0_star = A * p0 + (1 - Sp)\n                    \n                    # Denominator for p1_star calculation.\n                    denom_p1_star = 1 + p0_star * (OR_star - 1)\n                    \n                    # Avoid division by zero, although theoretically safe\n                    # for OR_star = 0 and p0_star in [0, 1].\n                    if np.isclose(denom_p1_star, 0):\n                        continue\n                        \n                    # Calculate observed risk in the exposed group.\n                    p1_star = (OR_star * p0_star) / denom_p1_star\n                    \n                    # Invert the misclassification model to find the true risk p1.\n                    p1 = (p1_star - (1 - Sp)) / A\n                    \n                    # Discard combinations that yield invalid probabilities for p1.\n                    if not (0  p1  1):\n                        continue\n                        \n                    # Calculate the implied true risk ratio.\n                    # p0 is from the grid and will be  0.\n                    rr = p1 / p0\n                    \n                    valid_rrs.append(rr)\n\n        # 3. Compute summary statistics for the valid RR values.\n        if not valid_rrs:\n            # This case should not occur with the given test inputs,\n            # but as a fallback, we'd have no valid range.\n            min_rr, max_rr, max_abs_dev = np.nan, np.nan, np.nan\n        else:\n            min_rr = np.min(valid_rrs)\n            max_rr = np.max(valid_rrs)\n            \n            # Compute max absolute deviation from the naive approximation RR = OR_star.\n            valid_rrs_array = np.array(valid_rrs)\n            max_abs_dev = np.max(np.abs(valid_rrs_array - OR_star))\n            \n        all_results.append([min_rr, max_rr, max_abs_dev])\n\n    # Format the final output string precisely as required.\n    case_strings = []\n    for res in all_results:\n        # Round to 6 decimal places and format to avoid spaces and scientific notation.\n        s = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        case_strings.append(s)\n        \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}