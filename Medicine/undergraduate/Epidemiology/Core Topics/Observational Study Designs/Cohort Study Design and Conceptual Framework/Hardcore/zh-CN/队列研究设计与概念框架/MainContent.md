## 引言
队列研究是流行病学和公共卫生研究的基石，它通过随时间观察特定人群，为探索疾病病因、评估干预措施效果和理解疾病自然史提供了无可比拟的视角。其核心优势在于能够确立暴露与结局之间明确的时间顺序，这是进行因果推断的先决条件。然而，从看似简单的“追踪一群人”到得出科学可靠的结论，其过程充满了复杂的方法学挑战。研究者必须谨慎应对混杂、选择偏倚和信息偏倚等潜在陷阱，否则极易得出错误或误导性的结论。

本文旨在为您提供一个关于队列研究的结构化、深度的概念框架，帮助您系统性地掌握这一强大的研究工具。我们将超越基础定义，深入探讨其内在逻辑和现代应用。

在“原理与机制”一章中，我们将剖析队列研究的基本结构，阐明测量疾病发生的核心指标，并建立严谨的因果推断框架。您将学会如何识别并处理威胁研究有效性的各种偏倚。接着，在“应用与跨学科连接”一章中，我们将通过目标试验模拟等前沿概念和跨学科案例，展示队列研究在解决临床医学、药物警戒、基因组学及卫生政策等复杂现实问题中的强大威力。最后，“动手实践”部分将提供具体的练习，帮助您将理论知识转化为计算和解决实际问题的能力。通过这一系列学习，您将能够更自信、更严谨地设计、分析和评判队列研究。

## 原理与机制

在上一章对队列研究的概述之后，本章将深入探讨其核心原理与机制。我们将剖析队列研究的设计结构，阐明其用于衡量疾病发生的核心指标，并构建一个严谨的因果推断框架。在此基础上，本章将系统地识别和分析可能威胁研究有效性的主要偏倚来源，包括混杂、选择偏倚和信息偏倚，并介绍相应的纠正策略。最后，我们将探讨在大型队列中提高效率的高级抽样设计。

### 队列研究的基本结构

队列研究的[逻辑核心](@entry_id:751444)在于其时间上的前瞻性。研究从一个在研究基线时刻（$t_0$）未发生目标结局的特定人群（即**队列 (cohort)**）开始。这一基本资格标准，即对每个入组个体 $i$，其在基线时的结局状态 $Y_i(t_0) = 0$，是至关重要的。研究者在基线或之前确定每个个体的暴露状态 $E_i$，然后随时间推移（$t > t_0$）对该队列进行随访，以观察并记录新发（或称“事件”）结局的出现，即 $Y_i(t)$ 从 $0$ 变为 $1$ 的时刻。

根据研究者进行研究的日历时间与队列暴露和结局事件发生的日历时间的相对关系，队列研究可分为两种主要类型：**前瞻性队列研究 (prospective cohort study)** 和 **回顾性队列研究 (retrospective cohort study)**。

**前瞻性队列研究**是在事件发生之前开始的。例如，一项始于2025年的研究，研究者会在2025年招募队列，测量其当前的暴露状况，并确认他们此时没有发生结局。然后，研究者会向前追随这个队列进入未来（如2026年、2027年等），等待并记录新发结局的出现。在这里，研究的进行与事件的发生是同步或先于事件的。

相比之下，**回顾性队列研究**（又称历史性队列研究）则在所有事件（暴露和结局）均已发生之后启动。假设一项研究同样在2025年启动，研究者可以利用历史记录（如医疗档案、雇佣记录）在过去定义一个基线时间点，例如2015年。他们会从2015年或之前的记录中确定个体的暴露状态，并确认这些个体在2015年时是“无结局”的。然后，研究者会通过查阅从2015年到研究启动时（或更早的某个时间点）的记录，来“重建”这个队列的结局发生史。

尽管这两种设计在研究者的时间视角上有所不同，但它们在数据结构上共享一个不可动摇的核心原则：暴露和资格的确定在逻辑时间上总是早于结局的随访。无论是前瞻性还是回顾性，研究的内在逻辑都是从暴露到结局的“前向”追溯 。

### 疾病发生的测量

在建立并随访队列后，下一个关键步骤是量化疾病的发生频率。两个核心指标被广泛使用：累积发病率和发病率。

**累积发病率 (Cumulative Incidence)**，也称为**风险 (risk)**，衡量的是在一个特定时间段内（例如 $\Delta t = 5$ 年），初始无病队列中发生结局的个体所占的比例。它是一个无量纲的概率，取值范围在 $0$ 到 $1$ 之间，直观地回答了“在未来5年内，这个队列中的一个普通成员发生某事件的平均概率是多少？”这个问题。在没有随访丢失的理想情况下，累积发病率的计算很简单：新发病例数除以队列初始总人数。然而，在实际研究中，部分参与者可能会因为失联、退出研究或研究预定结束而停止观察，这种情况称为**删失 (censoring)**。当存在删失时，简单地用初始人数作为分母会低估真实风险，因为它没有考虑到删失者并未被完整观察整个时期。正确的做法是使用生存分析方法，如 **Kaplan-Meier 法**，来估计生存函数 $S(t)$（到时间 $t$ 仍未发生事件的概率），进而计算累积发病率 $CI(t) = 1 - S(t)$。这种方法通过在每个事件发生时间点动态调整风险集（即仍在观察且未发生事件的人数），正确地处理了[删失数据](@entry_id:173222) 。

**发病率 (Incidence Rate)**，又称**发病密度 (incidence density)**，衡量的是疾病发生的速度。它的定义是单位“人-时”内的发病事件数，例如“每1000人年发生5例”。其计算公式为：
$$
IR = \frac{\text{新发病例总数}}{\text{总人时数}}
$$
**人时 (person-time)** 是队列中所有个体处于“风险中”状态的时间总和。每个个体从进入队列开始贡献人时，直到其发生结局、被删失或研究结束为止。发病率的核心优势在于它自然地处理了不等的随访时间，这使得它在有删失的情况下尤为适用。只要删失是**非信息性的 (non-informative)**，即删失的发生与未来的结局风险无关，那么基于人时的发病率就是一个无偏的估计量 。

在处理删失数据时，必须清晰地区分不同类型的“随访终止”：
- **管理删失 (Administrative censoring)**：指由于研究预先设定的结束日期到来而导致的随访终止。这是一种计划内的、通常与个体预后无关的删失。
- **失访 (Loss to follow-up)**：指由于无法联系到参与者、参与者主动退出等非计划性原因导致的观察中断。这可能导致信息性删失，即失访本身与结局风险相关（例如，病情加重的患者更可能失访）。
- **竞争性事件 (Competing events)**：指发生了另一种事件，从而排除了目标事件发生可能性的情况。例如，在研究非致死性中风时，因车祸死亡就是一个竞争性事件。将竞争性事件错误地当作普通删失处理，会高估目标事件的发生概率（例如，使用标准[Kaplan-Meier](@entry_id:169317)方法会引入偏倚），因此需要特殊的分析方法（如[竞争风险](@entry_id:173277)模型）。

非信息性删失的核心假设是，在任何时间点 $t$，对于处于风险集中的个体，那些在 $t$ 时刻被删失的个体，其未来的结局发生风险与那些继续被随访的个体是相同的，前提是控制了所有已知的预后因素。用数学语言表达，即结局时间 $T$ 与删失时间 $C$ 在给定暴露历史 $\bar A(t)$ 和协变量历史 $\bar L(t)$ 的条件下是独立的：$T \perp C \mid \bar L(t), \bar A(t)$。这本质上是一个**[可交换性](@entry_id:263314) (exchangeability)** 的假设 。

### 因果推断的目标与假设

观察性队列研究的主要目标往往超越描述，旨在进行因果推断——即回答“暴露是否‘导致’了结局？”这类问题。为此，我们需要一个清晰的框架来定义因果效应并阐明得出因果结论所必需的假设。**潜在结局框架 (potential outcomes framework)** 为此提供了严谨的语言。

在一个简单的二元暴露（如用药 $A=1$ vs. 不用药 $A=0$）研究中，对于每个个体，我们设想存在两个潜在结局：$Y^1$（如果该个体接受用药，将会观察到的结局）和$Y^0$（如果该个体未接受用药，将会观察到的结局）。当然，在现实中，我们只能观察到其中之一。

在这个框架下，我们可以精确地定义三位一体的核心概念：**估计目标 (estimand)**、**估计量 (estimator)** 和 **估计值 (estimate)** 。
- **估计目标 (Estimand)**：我们希望了解的、存在于目标人群中的理论上的因果量。例如，人群平均因果效应（Average Causal Effect, ACE），可以用5年风险差来表示：$E[Y^{a=1}(5) - Y^{a=0}(5)]$。这是一个抽象的、固定的数值，独立于任何具体的研究样本。
- **估计量 (Estimator)**：一个应用于实际观测数据的数学公式或算法，其目的是为了估计“估计目标”。例如，用于校正混杂的**逆概率加权 (Inverse Probability Weighting, IPW)** 估计量就是一个复杂的函数，它利用观测数据（暴露、结局、协变量）来计算因果风险差的一个近似值。
- **估计值 (Estimate)**：将“估计量”应用于一个特定数据集后得到的具体数值。例如，通过IPW方法计算出某项研究的5年风险差为 $-0.01$。这个数值是对我们无法直接得知的真实因果效应（估计目标）的一次估计。

从可观测的数据关联（association）跨越到不可观测的因果效应（causation），需要三个关键的、不可检验的**可识别性假设 (identifiability assumptions)** ：
1.  **一致性 (Consistency)**：个体在实际接受的暴露水平 $A=a$ 下观察到的结局 $Y$，等同于其在该暴露水平下的潜在结局 $Y^a$。即，若 $A=a$，则 $Y=Y^a$。这个假设连接了现实世界和潜在结局世界，并要求暴露的定义是清晰无歧义的。
2.  **[可交换性](@entry_id:263314) (Exchangeability)**（或称**无混杂 (no confounding)**）：在控制了所有相关的基线协变量 $X$ 后，暴露组和非暴露组是可以相互交换的。这意味着，在任何一个协变量层 $X=x$ 内部，个体的潜在结局与其最终实际接受的暴露水平是独立的。数学上表示为 $Y^a \perp A \mid X$。这个假设意味着我们已经测量并恰当地控制了所有影响暴露选择和结局的[共同原因](@entry_id:266381)（即混杂因素）。
3.  **正定性 (Positivity)**（或称**重叠性 (overlap)**）：在每一个协变量层 $X=x$ 内，接受每种暴露水平（$A=0$ 或 $A=1$）的概率都大于零。即 $0  P(A=1 \mid X=x)  1$。这个假设确保在需要进行比较的每个亚组中，我们总能找到暴露者和非暴露者，从而使得比较成为可能。

只有当这三个假设同时成立时，我们才能从观测数据中无偏地估计出因果效应。

### 对有效性的主要威胁：偏倚

偏倚（Bias）是导致研究结果系统性地偏离真相的任何因素。在队列研究中，主要偏倚可分为三类：混杂偏倚、选择偏倚和信息偏倚。

#### 混杂偏倚 (Confounding Bias)

**混杂**是指暴露与结局的表观关联，被一个与二者皆有关的外部因素（混杂因素）所扭曲。在潜在结局框架下，混杂是**边际不可交换性 (marginal non-exchangeability)** 的体现，即 $Y^a \not\perp A$。这意味着，即使在未接受暴露的情况下，暴露组和非暴露组的结局风险也天然不同。

我们需要区分两种“不平衡”：
- **结构性混杂 (Structural confounding)**：这是[观察性研究](@entry_id:174507)数据生成过程的固有特征。例如，医生更倾向于给高危患者使用某种新药。这种由共同原因（疾病严重程度）导致的暴露与结局的关联，存在于人群层面，不会因为样本量的增大而消失。随机对照试验（RCT）通过随机分配暴露，从设计上打破了所有已知和未知的混杂因素与暴露选择的关联，从而消除了结构性混杂。
- **偶然不平衡 (Chance imbalance)**：即使在设计完美的RCT中，由于抽样变异，一个有限的样本也可能偶然出现暴露组和[对照组](@entry_id:188599)在某些基线特征上的不平衡（例如，暴露组平均年龄稍高）。这种不平衡是随机误差，会随着样本量的增大而趋于消失 。

校正混杂的常用方法包括在设计阶段进行匹配（matching），或在分析阶段进行分层（stratification）、标准化（standardization）或[回归建模](@entry_id:170726)（如使用逆概率加权）。这些方法的目标都是在满足可识别性假设的前提下，模拟出一个“可交换”的比较。

#### 选择偏倚 (Selection Bias)

选择偏倚源于研究对象的选择方式或其在研究期间的留存方式，导致样本不能代表目标人群，或者暴露组与非暴露组的比较因选择过程本身而产生扭曲。

一个典型的例子是**幸存者偏倚 (survivor bias)**，它常常出现在**患病队列 (prevalent cohort)** 研究中。与从疾病刚发生时开始入组的**新发病例队列 (incident/inception cohort)** 不同，患病队列是在某个时间点横断面地招募所有“已患病且存活”的个体。这种设计天然地排除了那些在诊断后、研究开始前就已经死亡或痊愈的个体。如果疾病的持续时间与暴露有关，那么这种**左截断 (left truncation)**——即只纳入了那些“幸存”到研究基线时的个体——会导致样本中长病程者比例过高，从而对暴露与结局关联的估计产生偏倚。例如，在研究某预后因素时，患病队列会倾向于富集那些生存时间较长的患者，可能导致对生存率的过高估计。分析这[类数](@entry_id:156164)据时，需要使用能够处理延迟进入（delayed entry）的[统计模型](@entry_id:755400)来校正这种偏倚 。

另一种重要的选择偏倚是**信息性删失**，如前所述，当失访本身与结局风险相关时发生，这破坏了标准生存分析所需的核心假设 。

#### 信息偏倚 (Information Bias)

信息偏倚，或称**测量偏倚 (measurement bias)**，源于对暴露、结局或协变量信息的系统性错误测量。这里我们重点讨论**暴露错分 (exposure misclassification)**。

假设我们用一个不完美的工具 $E^*$ 去测量真实的暴露状态 $E$。错分的类型及其影响至关重要：
- **非差异性错分 (Nondifferential misclassification)**：指暴露的测量误差独立于结局状态。换言之，无论个体最终是否发病，将其暴露状态测错的概率是相同的。例如，回顾性地询问饮食习惯，健康人和病人都可能同样记错。对于一个二元暴露，当真实风险比（RR）大于1时，这种类型的错分通常（但非绝对）会导致观察到的风险比被低估，即**偏向于无效值 (bias towards the null)**。例如，在一项真实RR为 $2.0$ 的研究中，由于80%的灵敏度和90%的特异度的非差异性错分，观察到的RR可能被稀释到 $1.60$ 左右 。
- **差异性错分 (Differential misclassification)**：指暴露的测量误差依赖于结局状态。例如，在一项病例对照研究中，患有某种癌症的病例可能比健康对照更仔细地回忆和报告其过去的化学品暴露史，这被称为**回忆偏倚 (recall bias)**。差异性错分的影响是不可预测的，它可能导致观察到的关联被高估、低估，甚至反转方向。例如，在上述真实RR为 $2.0$ 的研究中，如果病例的暴露被更准确地识别（灵敏度更高），而健康人的暴露识别较差，观察到的RR可能被夸大到 $3.17$ 。

#### 特殊偏倚：不死时间偏倚

**不死时间偏倚 (Immortal time bias)** 是一种在药物流行病学等领域中，分析随时间变化的暴露（如药物使用）时常出现的微妙但严重的偏倚。它源于对暴露前的一段“风险”时间的错误归类。

考虑一项研究，比较糖尿病患者中使用药物A与未使用者的死亡率。药物A可能在诊断后的任何时间点开始使用。一种幼稚的分析方法是，将所有“最终”使用了药物A的患者从诊断之日（$t=0$）起就划为“暴露组”。然而，从诊断到实际开始用药的这段时间里，这些患者为了能成为“用药者”，他们必须保持存活。这段他们尚未用药但被错误地计入暴露组随访时间的时期，就是“不[死时间](@entry_id:273487)”。将这段零风险（因为死亡会阻止他们成为用药者）的时间加入暴露组的分母（人时），会人为地拉低暴露组的发病率，从而夸大药物的保护效应 。

例如，一项[模拟计算](@entry_id:273038)显示，这种幼稚分析可能得出一个接近 $0.49$ 的发病率比（IRR），显示药物有强大的保护作用。然而，正确的做法是将暴露处理为**时依性协变量 (time-dependent covariate)**：在开始用药前，个体贡献的人时应计入“未暴露”组；只有在开始用药后，其贡献的人时才计入“暴露”组。通过这种正确的风险时间归类，计算出的IRR可能为 $0.74$——药物效果依然存在，但远没有之前夸张。这清晰地揭示了不死时间偏倚如何能凭空创造出虚假的“疗效”。

### 队列内的高级抽样设计

大型队列研究，特别是那些需要收集昂贵生物样本或进行复杂测量的研究，成本可能非常高昂。为了提高效率，研究者可以在一个已建立的“母队列”中进行巧妙的抽样，从而在保留大部分统计效力的同时，大幅削减成本。两种主要的设计是**巢式病例对照研究 (nested case-control study)** 和 **病例队列研究 (case-cohort study)**。

**巢式病例对照研究**采用“风险集抽样”的策略。在母队列随访过程中，每当出现一个新病例时，研究者会从该病例发生事件时仍然处于风险中的个体（即当时仍存活且未发病的队列成员）中，随机抽取一个或多个“对照”。这个过程在每个病例出现时都重复一遍。分析时使用**条件逻辑回归 (conditional logistic regression)**，这种方法估计的优势比（Odds Ratio）在无需“稀有疾病假设”的情况下，就是对风险比（Hazard Ratio）的[无偏估计](@entry_id:756289)。然而，这种设计的缺点是，由于对照是为特定病例抽取的，它不能直接用于估计人群的暴露率或绝对风险 。

**病例队列研究**则采用不同的抽样逻辑。在研究开始时（$t=0$），研究者从整个母队列中随机抽取一个固定比例的样本，称为“亚队列 (subcohort)”。然后，研究正常进行，收集所有新发病例的信息。最终用于分析的数据集包括：所有病例（无论他们是否在亚队列中）和整个亚队列的所有成员。在分析时，对于每个发生的病例，其风险集由该病例和当时亚队列中仍处于风险状态的成员共同组成。由于亚队列是基线人群的随机样本，分析时需要使用**加权Cox模型 (weighted Cox model)** 来进行适当的调整。这种设计的一个主要优势是，作为基线人群的缩影，亚队列可用于估计整个人群的暴露率和协变量分布，并能进一步估算绝对风险和基线风险函数 $\lambda_0(t)$，这是巢式病例对照研究通常无法做到的 。

这两种设计都是在完整队列分析的框架下，通过减少需要收集详细信息的人数，来实现[资源优化](@entry_id:172440)的强大工具，代表了流行病学方法学的精妙与实用。