{
    "hands_on_practices": [
        {
            "introduction": "从随访研究中准确量化疾病的发生是流行病学分析的核心。这项练习将带你完成一个基本但至关重要的计算：从观察到的事件数和累积的人时数据中得出发生率()。通过这个过程，你不仅能掌握计算本身，还能深入理解将此发生率解释为恒定风险时所需的重要假设。",
            "id": "4593995",
            "problem": "一项前瞻性队列研究对有单一、非复发性结局风险的个体进行追踪。所有参与者在基线时入组，并遵循统一的程序进行随访，结局评估完整。在研究期间，共观察到 $50$ 例首次事件，队列累积了 $1{,}250$ 人年的风险随访时间。请使用流行病学关于发病率和事件发生时间风险的核心定义，根据观察数据计算发病率。将您的数值答案四舍五入至 3 位有效数字，并以“事件/人年”为单位表示。此外，请阐明在此发病率可被解释为潜在的事件发生时间过程的恒定风险时所依赖的一系列假设，依据基本定义和经过充分检验的统计事实，而非任何简化公式。",
            "solution": "该问题被认为是有效的，因为它科学地基于既定的流行病学原理，问题设置合理，数据充分且一致，并以客观、明确的语言表述。\n\n解答包括两个部分：第一，计算发病率；第二，阐明在该发病率可被解释为恒定风险时所依赖的假设。\n\n第一部分：发病率的计算\n\n发病率，也称为发病密度，是衡量在特定时期内风险人群中新事件发生速率的指标。其定义为新发事件总数除以总风险人时。\n\n设 $I$ 为观察到的首次事件总数。\n设 $PT$ 为总风险随访人年数。\n\n问题提供以下数值：\n事件数，$I = 50$。\n总人年数，$PT = 1,250$ 人年。\n\n发病率 ($IR$) 的计算公式为：\n$$ IR = \\frac{I}{PT} $$\n将给定值代入公式：\n$$ IR = \\frac{50}{1,250} \\, \\text{事件/人年} $$\n$$ IR = \\frac{1}{25} \\, \\text{事件/人年} $$\n$$ IR = 0.04 \\, \\text{事件/人年} $$\n问题要求答案保留 3 位有效数字。为了将 $0.04$ 表示为三位有效数字，我们将其写作 $0.0400$。\n因此，发病率为 $0.0400$ 事件/人年。\n\n第二部分：将发病率解释为恒定风险的假设\n\n风险函数 $\\lambda(t)$ 表示在存活至时间 $t$ 的条件下，在时间点 $t$ 发生事件的瞬时风险。其定义为：\n$$ \\lambda(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\le T  t + \\Delta t \\mid T \\ge t)}{\\Delta t} $$\n其中 $T$ 是事件发生时间的随机变量。\n\n计算出的发病率 $IR = \\frac{I}{PT}$ 是对整个研究人群和随访期内平均事件发生率的总结性度量。要使这个平均率成为恒定风险 $\\lambda$ 的有效估计，必须满足几个关键假设。首要假设是，风险率实际上不随时间变化。\n\n让我们将其形式化。对于一个包含 $N$ 个体的队列研究，其中个体 $i$ 被随访了 $t_i$ 时间，其事件状态为 $\\delta_i$（$\\delta_i=1$ 表示发生事件，$\\delta_i=0$ 表示删失），其似然函数由个体贡献的乘积给出。如果发生事件，个体贡献是概率密度函数 $f(t_i) = \\lambda(t_i) S(t_i)$；如果个体被删失，个体贡献是生存函数 $S(t_i)$。生存函数为 $S(t) = \\exp\\left(-\\int_0^t \\lambda(u) du\\right)$。\n\n核心假设是风险率不随时间变化：\n**1. 恒定风险率：** 我们假设在随访期内对所有 $t$ 都有 $\\lambda(t) = \\lambda$。这意味着事件的风险不随个体处于风险中的时间而改变。这是事件发生时间呈指数概率分布的决定性特征，其中 $S(t) = \\exp(-\\lambda t)$ 且 $f(t) = \\lambda \\exp(-\\lambda t)$。\n\n在此假设下，观测数据的似然函数得到显著简化。似然函数 $L$ 与各个体似然贡献的乘积成正比：\n$$ L(\\lambda) \\propto \\prod_{i=1}^{N} [f(t_i)]^{\\delta_i} [S(t_i)]^{1-\\delta_i} $$\n$$ L(\\lambda) \\propto \\prod_{i=1}^{N} [\\lambda \\exp(-\\lambda t_i)]^{\\delta_i} [\\exp(-\\lambda t_i)]^{1-\\delta_i} $$\n$$ L(\\lambda) \\propto \\prod_{i=1}^{N} \\lambda^{\\delta_i} \\exp(-\\lambda t_i) $$\n合并所有个体的项：\n$$ L(\\lambda) \\propto \\lambda^{\\sum \\delta_i} \\exp\\left(-\\lambda \\sum t_i\\right) $$\n设 $I = \\sum \\delta_i$ 为事件总数， $PT = \\sum t_i$ 为总人时。似然函数为：\n$$ L(\\lambda) \\propto \\lambda^{I} \\exp(-\\lambda \\cdot PT) $$\n为了找到使该似然函数最大化的 $\\lambda$ 值，我们处理对数似然函数 $\\ln L(\\lambda)$：\n$$ \\ln L(\\lambda) = I \\ln(\\lambda) - \\lambda \\cdot PT + C $$\n其中 $C$ 是一个常数。我们对 $\\lambda$ 求导并令其为零：\n$$ \\frac{d}{d\\lambda} \\ln L(\\lambda) = \\frac{I}{\\lambda} - PT = 0 $$\n解出 $\\lambda$ 得到最大似然估计（MLE），记作 $\\hat{\\lambda}$：\n$$ \\hat{\\lambda} = \\frac{I}{PT} $$\n此结果表明，计算出的发病率 $IR$ 正是*在风险率恒定的假设下*，风险率 $\\lambda$ 的最大似然估计。\n\n除了这个基本假设外，结果的有效性和解释还需要其他几个条件，其中一些条件已在问题陈述中暗示：\n\n**2. 风险同质性：** 为了使计算出的率 $\\hat{\\lambda}$ 能代表队列中任何个体的风险（而不仅仅是一个平均值），我们必须假设恒定风险率 $\\lambda$ 对研究中的所有个体都是相同的。如果不同亚组具有不同（但恒定）的风险，则计算出的率代表这些风险的加权平均值。\n\n**3. 独立删失：** 删失（即个体在未发生事件的情况下结束随访）的原因必须与结局风险无关。这意味着失访或观察期结束的个体，其风险不能系统性地高于或低于仍在观察中的个体。问题中提到的“结局评估完整”和“统一程序”有助于满足这一点，但在实践中这仍然是一个关键假设。\n\n**4. 个体独立性：** 任何给定个体的事件发生时间与队列中所有其他个体的事件发生时间是独立的。一个参与者发生事件不会改变其他参与者发生事件的概率。\n\n总之，将发病率解释为潜在过程的恒定风险，主要基于风险率不随时间变化的假设，这对应于指数生存模型。",
            "answer": "$$ \\boxed{0.0400} $$"
        },
        {
            "introduction": "在现代流行病学研究中，我们常常依赖自动化算法（如基于医疗理赔数据的算法）来认定研究结局。这项练习模拟了这一真实场景，要求你使用灵敏度、特异度和患病率等核心指标来评估一个结局认定算法的预测性能()。通过推导和计算阳性预测值 ($PPV$) 和阴性预测值 ($NPV$)，你将学会如何量化这类工具在实践中的可靠性。",
            "id": "4593917",
            "problem": "一个卫生系统部署了一种基于行政理赔数据的算法，用于在一个动态成人队列的常规随访中确定急性心肌梗死的发生。结局的确定以人年（PY）为单位，每年进行一次，为每个 PY 产生一个二元分类：算法阳性或算法阴性。在一个 PY 内，急性心肌梗死真实发生的患病率为 $p = 7 \\times 10^{-3}$。一项验证性研究表明，该算法的灵敏度为 $Se = 0.84$，特异度为 $Sp = 0.97$。假设人年分类是可交换的，并且算法的分类性能不随时间或个体而变化。阳性预测值（PPV）定义为算法阳性的 PY 确实患病的概率，阴性预测值（NPV）定义为算法阴性的 PY 确实未患病的概率。\n\n仅使用灵敏度、特异度和贝叶斯定理的核心定义，推导出适用于此人年级别确定的 $PPV$ 和 $NPV$ 的表达式，用 $p$、$Se$ 和 $Sp$ 表示。然后，根据给定的 $p$、$Se$ 和 $Sp$ 计算 $PPV$ 和 $NPV$ 的数值（以小数形式表示）。最后，在所述假设下，计算每 $1{,}000$ 人年的预期假阳性数，其定义为每 $1{,}000$ 个 PY 中，在真实未患病的 PY 里出现算法阳性分类的预期数量。\n\n将所有数值答案四舍五入至三位有效数字。将 $PPV$ 和 $NPV$ 以小数形式表示。对于假阳性，报告其每 $1{,}000$ 人年的发生率。",
            "solution": "该问题涉及流行病学中在人年层面上使用基于理赔数据的算法进行结局确定。我们从核心定义开始：\n- 灵敏度 $Se$ 定义为 $Se = \\Pr(T^{+} \\mid D^{+})$，即在一个 PY 中，给定真实患病的情况下，算法呈阳性的概率。\n- 特异度 $Sp$ 定义为 $Sp = \\Pr(T^{-} \\mid D^{-})$，即在一个 PY 中，给定真实未患病的情况下，算法呈阴性的概率。\n- 人年层面的患病率为 $p = \\Pr(D^{+})$。因此 $\\Pr(D^{-}) = 1 - p$。\n- 阳性预测值 $PPV$ 为 $PPV = \\Pr(D^{+} \\mid T^{+})$。\n- 阴性预测值 $NPV$ 为 $NPV = \\Pr(D^{-} \\mid T^{-})$。\n\n为了推导 $PPV$，使用贝叶斯定理。设 $T^{+}$ 表示阳性分类，$D^{+}$ 表示该 PY 真实患病。则\n$$\nPPV = \\Pr(D^{+} \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid D^{+}) \\Pr(D^{+})}{\\Pr(T^{+})}.\n$$\n通过全概率公式计算 $\\Pr(T^{+})$：\n$$\n\\Pr(T^{+}) = \\Pr(T^{+} \\mid D^{+}) \\Pr(D^{+}) + \\Pr(T^{+} \\mid D^{-}) \\Pr(D^{-}).\n$$\n根据定义，$\\Pr(T^{+} \\mid D^{+}) = Se$ 且 $\\Pr(T^{+} \\mid D^{-}) = 1 - Sp$。因此\n$$\nPPV = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp) \\cdot (1 - p)}.\n$$\n\n类似地，为了推导 $NPV$，设 $T^{-}$ 表示阴性分类，$D^{-}$ 表示该 PY 真实未患病。贝叶斯定理给出\n$$\nNPV = \\Pr(D^{-} \\mid T^{-}) = \\frac{\\Pr(T^{-} \\mid D^{-}) \\Pr(D^{-})}{\\Pr(T^{-})}.\n$$\n计算 $\\Pr(T^{-})$：\n$$\n\\Pr(T^{-}) = \\Pr(T^{-} \\mid D^{-}) \\Pr(D^{-}) + \\Pr(T^{-} \\mid D^{+}) \\Pr(D^{+}).\n$$\n根据定义，$\\Pr(T^{-} \\mid D^{-}) = Sp$ 且 $\\Pr(T^{-} \\mid D^{+}) = 1 - Se$。因此\n$$\nNPV = \\frac{Sp \\cdot (1 - p)}{Sp \\cdot (1 - p) + (1 - Se) \\cdot p}.\n$$\n\n对于每 $1{,}000$ 人年的假阳性数，我们寻求每 $1{,}000$ 个 PY 中，在真实未患病的 PY 里出现算法阳性分类的预期数量。一个 PY 真实未患病的概率是 $(1 - p)$，并且在给定 $D^{-}$ 的条件下，阳性分类的概率是 $(1 - Sp)$。因此，每个 PY 发生假阳性的概率为\n$$\n\\Pr(T^{+} \\cap D^{-}) = \\Pr(T^{+} \\mid D^{-}) \\Pr(D^{-}) = (1 - Sp) (1 - p),\n$$\n而每 $1{,}000$ 个 PY 的预期数量是\n$$\n1000 \\times (1 - Sp) (1 - p).\n$$\n\n现在代入给定值 $p = 7 \\times 10^{-3}$，$Se = 0.84$ 和 $Sp = 0.97$。\n\n计算 $PPV$：\n$$\nPPV = \\frac{0.84 \\times 0.007}{0.84 \\times 0.007 + (1 - 0.97) \\times (1 - 0.007)}.\n$$\n计算各组成部分：\n$$\n0.84 \\times 0.007 = 0.00588,\n$$\n$$\n1 - 0.97 = 0.03, \\quad 1 - 0.007 = 0.993,\n$$\n$$\n0.03 \\times 0.993 = 0.02979,\n$$\n所以分母是\n$$\n0.00588 + 0.02979 = 0.03567,\n$$\n因此\n$$\nPPV = \\frac{0.00588}{0.03567} \\approx 0.16484.\n$$\n四舍五入到三位有效数字：\n$$\nPPV \\approx 0.165.\n$$\n\n计算 $NPV$：\n$$\nNPV = \\frac{0.97 \\times (1 - 0.007)}{0.97 \\times (1 - 0.007) + (1 - 0.84) \\times 0.007}.\n$$\n计算各组成部分：\n$$\n0.97 \\times 0.993 = 0.96321,\n$$\n$$\n1 - 0.84 = 0.16, \\quad 0.16 \\times 0.007 = 0.00112,\n$$\n分母：\n$$\n0.96321 + 0.00112 = 0.96433,\n$$\n于是，\n$$\nNPV = \\frac{0.96321}{0.96433} \\approx 0.99884.\n$$\n四舍五入到三位有效数字：\n$$\nNPV \\approx 0.999.\n$$\n\n计算每 $1{,}000$ 人年的预期假阳性数：\n$$\n1000 \\times (1 - Sp) (1 - p) = 1000 \\times 0.03 \\times 0.993 = 1000 \\times 0.02979 = 29.79.\n$$\n四舍五入到三位有效数字：\n$$\n\\text{每 }1{,}000\\text{ 人年的假阳性数} \\approx 29.8.\n$$\n\n因此，所要求的值四舍五入到三位有效数字后分别为 $PPV \\approx 0.165$，$NPV \\approx 0.999$，以及每 $1{,}000$ 人年的假阳性数 $\\approx 29.8$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.165  0.999  29.8\\end{pmatrix}}$$"
        },
        {
            "introduction": "结局认定的不完美并非没有后果，它可能导致我们对暴露与疾病之间关联的估计产生偏倚。这项练习将引导你量化这种偏倚的具体影响，特别是在观察工具的准确性（灵敏度）因暴露状态而异的情况下()。通过计算由于结局错分导致的风险比偏倚，你将亲身体会到确保结局认定无差异性在维持研究效力方面的重要性。",
            "id": "4593973",
            "problem": "一项前瞻性队列研究对个体进行为期一年的随访，以估计二元暴露对二元结局的因果效应。设 $R_{1}$ 表示暴露组中结局的真实一年期风险，$R_{0}$ 表示非暴露组中的真实一年期风险，并将真实风险比 (RR) 定义为 $RR_{\\text{true}} = R_{1} / R_{0}$。在随访结束时，使用一种算法来确定结局，该算法的敏感度和特异度可能因差异性监测而随暴露状态而异。敏感度定义为 $Se_{x} = \\Pr(\\text{观察结局} = 1 \\mid \\text{真实结局} = 1, X=x)$，特异度定义为 $Sp = \\Pr(\\text{观察结局} = 0 \\mid \\text{真实结局} = 0)$，其中 $X \\in \\{0,1\\}$ 表示非暴露 ($0$) 与暴露 ($1$) 。\n\n假设以下内容对于本研究在科学上和操作上是准确的：\n- 真实风险比为 $RR_{\\text{true}} = 1.5$。\n- 非暴露组的真实一年期风险为 $R_{0} = 0.10$，因此 $R_{1} = RR_{\\text{true}} \\times R_{0}$。\n- 暴露组的敏感度为 $Se_{1} = 0.95$；非暴露组的敏感度为 $Se_{0} = 0.85$。\n- 特异度在各暴露组中相同，为 $Sp = 0.98$。\n- 随访是完整的，没有失访；唯一的缺陷是在结局确认时存在结局错分，如上所述。\n- 队列足够大，使得期望值与其经验对应值相等。\n\n从风险、敏感度和特异度的核心定义出发，推导暴露组和非暴露组的期望观察一年期风险，并由此推导出期望观察风险比 $RR_{\\text{obs}}$。将由结局错分引起的风险比加性偏倚定义为 $B = RR_{\\text{obs}} - RR_{\\text{true}}$。计算 $B$。将最终数值答案四舍五入至四位有效数字。以无量纲数的形式提供最终答案。",
            "solution": "用户提供了一个流行病学领域中有效且定义明确的问题。任务是量化由于差异性结局错分导致的观察风险比中的偏倚。解决方案将首先推导观察风险的一般表达式，然后将其应用于给定的暴露组和非暴露组的特定参数，以计算观察风险比和由此产生的偏倚。\n\n问题将暴露组的真实一年期风险定义为 $R_{1}$，非暴露组的真实一年期风险定义为 $R_{0}$。真实风险比为 $RR_{\\text{true}} = \\frac{R_{1}}{R_{0}}$。给定 $RR_{\\text{true}} = 1.5$ 和 $R_{0} = 0.10$。由此，我们可以计算暴露组的真实风险：\n$$\nR_{1} = RR_{\\text{true}} \\times R_{0} = 1.5 \\times 0.10 = 0.15\n$$\n\n结局错分的特征由敏感度 ($Se_{x}$) 和特异度 ($Sp_{x}$) 描述，其中 $x \\in \\{0, 1\\}$ 表示暴露状态。\n敏感度定义为 $Se_{x} = \\Pr(\\text{观察结局} = 1 \\mid \\text{真实结局} = 1, X=x)$。\n特异度定义为 $Sp_{x} = \\Pr(\\text{观察结局} = 0 \\mid \\text{真实结局} = 0, X=x)$。\n问题指出特异度是非差异性的，因此 $Sp_{1} = Sp_{0} = Sp = 0.98$。\n敏感度是差异性的：暴露组为 $Se_{1} = 0.95$，非暴露组为 $Se_{0} = 0.85$。\n\n对于暴露组 $x$，其观察一年期风险 $R_{\\text{obs}, x}$ 是该组中个体被分类为有结局的概率。我们可以使用全概率定律，通过对真实结局状态进行条件化来表达这一点：\n$$\nR_{\\text{obs}, x} = \\Pr(\\text{观察结局} = 1 \\mid X=x)\n$$\n$$\nR_{\\text{obs}, x} = \\Pr(\\text{观察}=1 \\mid \\text{真实}=1, X=x)\\Pr(\\text{真实}=1 \\mid X=x) + \\Pr(\\text{观察}=1 \\mid \\text{真实}=0, X=x)\\Pr(\\text{真实}=0 \\mid X=x)\n$$\n这里，$\\Pr(\\text{真实}=1 \\mid X=x)$ 是真实风险 $R_{x}$，而 $\\Pr(\\text{真实}=0 \\mid X=x)$ 是 $1 - R_{x}$。\n项 $\\Pr(\\text{观察}=1 \\mid \\text{真实}=1, X=x)$ 是敏感度 $Se_{x}$ 的定义。\n项 $\\Pr(\\text{观察}=1 \\mid \\text{真实}=0, X=x)$ 代表假阳性。它等于 $1 - \\Pr(\\text{观察}=0 \\mid \\text{真实}=0, X=x)$，也就是 $1 - Sp$。\n将这些定义代入观察风险的方程，得到通用公式：\n$$\nR_{\\text{obs}, x} = (Se_{x} \\times R_{x}) + ((1 - Sp) \\times (1 - R_{x}))\n$$\n\n我们现在应用这个公式来计算非暴露组 ($x=0$) 和暴露组 ($x=1$) 的观察风险。\n\n对于非暴露组 ($x=0$)：\n参数为 $R_{0} = 0.10$，$Se_{0} = 0.85$，以及 $Sp = 0.98$。\n$$\nR_{\\text{obs}, 0} = (Se_{0} \\times R_{0}) + ((1 - Sp) \\times (1 - R_{0}))\n$$\n$$\nR_{\\text{obs}, 0} = (0.85 \\times 0.10) + ((1 - 0.98) \\times (1 - 0.10))\n$$\n$$\nR_{\\text{obs}, 0} = 0.085 + (0.02 \\times 0.90)\n$$\n$$\nR_{\\text{obs}, 0} = 0.085 + 0.018 = 0.103\n$$\n\n对于暴露组 ($x=1$)：\n参数为 $R_{1} = 0.15$，$Se_{1} = 0.95$，以及 $Sp = 0.98$。\n$$\nR_{\\text{obs}, 1} = (Se_{1} \\times R_{1}) + ((1 - Sp) \\times (1 - R_{1}))\n$$\n$$\nR_{\\text{obs}, 1} = (0.95 \\times 0.15) + ((1 - 0.98) \\times (1 - 0.15))\n$$\n$$\nR_{\\text{obs}, 1} = 0.1425 + (0.02 \\times 0.85)\n$$\n$$\nR_{\\text{obs}, 1} = 0.1425 + 0.017 = 0.1595\n$$\n\n观察风险比 $RR_{\\text{obs}}$ 是这些观察风险的比率：\n$$\nRR_{\\text{obs}} = \\frac{R_{\\text{obs}, 1}}{R_{\\text{obs}, 0}} = \\frac{0.1595}{0.103} \\approx 1.548543689...\n$$\n\n问题将加性偏倚 $B$ 定义为观察风险比与真实风险比之间的差值：\n$$\nB = RR_{\\text{obs}} - RR_{\\text{true}}\n$$\n代入计算出的和给定的值：\n$$\nB = \\frac{0.1595}{0.103} - 1.5\n$$\n$$\nB \\approx 1.548543689... - 1.5\n$$\n$$\nB \\approx 0.048543689...\n$$\n\n问题要求将最终答案四舍五入至四位有效数字。第一位有效数字是 $4$，其后是 $8$、$5$ 和 $4$。下一位数字是 $3$，小于 $5$，所以我们不进行进位。\n$$\nB \\approx 0.04854\n$$\n这代表了由指定的差异性结局错分引起的风险比中的加性偏倚。",
            "answer": "$$\\boxed{0.04854}$$"
        }
    ]
}