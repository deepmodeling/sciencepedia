{
    "hands_on_practices": [
        {
            "introduction": "这个练习是您流行病学分析技能的基石。您将通过编写一个简短的程序来自动化计算比值比（Odds Ratio, $OR$）、其置信区间以及进行假设检验。这项实践不仅能巩固您对核心计算公式的理解，还将展示计算工具在将原始数据转化为有意义的流行病学证据方面的强大作用。",
            "id": "4616344",
            "problem": "一项病例对照研究评估了二元暴露与二元疾病结局之间的关联。构建如下的 $2 \\times 2$ 计数表：第一行对应患有该疾病的个体（病例），其中有 $a$ 名暴露者和 $b$ 名非暴露者；第二行对应未患该疾病的个体（对照），其中有 $c$ 名暴露者和 $d$ 名非暴露者。病例中的暴露比值定义为 $a/b$，对照中的暴露比值定义为 $c/d$。比值比定义为这两个比值的比率。假设在病例和对照内部进行独立抽样。\n\n从这些核心定义出发，推导一个程序来：\n- 估计比值比、其自然对数，以及估计比值比的自然对数的标准误。\n- 使用大样本正态近似，为真实比值比构建一个双侧 $(1-\\alpha)$ 置信区间（CI），其中 $\\alpha = 0.05$ 是以小数表示的 I 型错误率。\n- 对真实比值比等于 $1$ 的零假设进行双侧 Wald 假设检验。\n- 当 $a$、$b$、$c$ 或 $d$ 中任意一个等于 $0$ 时，应用 Haldane–Anscombe 校正（将所有四个单元格计数都加上 $0.5$），以避免出现未定义量。\n\n您的程序必须实现上述推导，并为每个测试用例计算一个包含以下七个元素的列表（按顺序）：\n1. 估计的比值比 $\\widehat{\\mathrm{OR}}$，四舍五入到六位小数。\n2. 估计的自然对数 $\\log(\\widehat{\\mathrm{OR}})$，四舍五入到六位小数。\n3. $\\log(\\widehat{\\mathrm{OR}})$ 的估计标准误，四舍五入到六位小数。\n4. 比值比的 $(1-\\alpha)$ 置信区间的下限，四舍五入到六位小数。\n5. 比值比的 $(1-\\alpha)$ 置信区间的上限，四舍五入到六位小数。\n6. 用于检验真实比值比是否等于 $1$ 的双侧 Wald 检验 p 值，四舍五入到六位小数。\n7. 一个布尔值，指示在显著性水平 $\\alpha$ 下是否拒绝零假设（使用 $True$ 表示拒绝，否则使用 $False$）。\n\n测试套件：\n使用以下六个测试用例，每个用例按 $(a,b,c,d)$ 的顺序指定：\n- 案例 1（一般中等计数）：$(40,60,20,80)$。\n- 案例 2（含零单元格的边界条件）：$(0,50,30,70)$。\n- 案例 3（接近零关联）：$(30,70,28,72)$。\n- 案例 4（关联小于 1）：$(10,90,30,70)$。\n- 案例 5（对照组暴露单元格为零的边界条件）：$(5,95,0,100)$。\n- 案例 6（大样本稳定性）：$(1000,1500,1100,1400)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个测试用例，其本身也是一个用方括号括起来的逗号分隔列表，顺序与上文规定相同。输出中不应包含任何空格。例如，输出格式应如下所示：\n$[\\,[x_{11},x_{12},\\dots,x_{17}],[x_{21},x_{22},\\dots,x_{27}],\\dots\\,]$,\n其中 $x_{ij}$ 是案例 $i$ 和元素 $j$ 的计算值。",
            "solution": "该问题是有效的，因为它基于生物统计学和流行病学的标准原则，提出了一个定义明确、有科学依据且客观的任务。问题是自包含的，所有必要的数据和方法都已明确。不存在不一致、歧义或不合理的假设。因此，我们可以继续进行推导和求解。\n\n问题要求分析来自病例对照研究的数据，这些数据呈现在一个 $2 \\times 2$ 列联表中，具有以下单元格计数：\n- $a$：暴露病例（疾病存在，暴露存在）\n- $b$：非暴露病例（疾病存在，暴露不存在）\n- $c$：暴露对照（疾病不存在，暴露存在）\n- $d$：非暴露对照（疾病不存在，暴露不存在）\n\n病例总数为 $n_1 = a+b$，对照总数为 $n_2 = c+d$。抽样方式是选取一定数量的病例和一定数量的对照，然后确定他们的暴露史。\n\n**1. 比值比（$\\mathrm{OR}$）的估计**\n\n病例中的暴露比值估计为暴露病例与非暴露病例的比率，$\\mathrm{Odds}_{\\text{cases}} = a/b$。\n对照中的暴露比值估计为暴露对照与非暴露对照的比率，$\\mathrm{Odds}_{\\text{controls}} = c/d$。\n\n样本比值比，记作 $\\widehat{\\mathrm{OR}}$，是这两个比值的比率。它作为真实总体比值比 $\\mathrm{OR}$ 的估计量。\n\n$$\n\\widehat{\\mathrm{OR}} = \\frac{a/b}{c/d} = \\frac{ad}{bc}\n$$\n\n这是比值比的最大似然估计量。$\\widehat{\\mathrm{OR}}  1$ 的值表示暴露与疾病之间存在正向关联，$\\widehat{\\mathrm{OR}}  1$ 的值表示负向（保护性）关联，接近 $1$ 的值表示无关联。\n\n如果任何单元格计数 $a, b, c, d$ 为零，就会出现一个实际问题。如果 $b=0$ 或 $c=0$，估计量是未定义的。如果 $a=0$ 或 $d=0$（且 $b, c \\neq 0$），估计量会变为 $0$ 或无穷大。为规避此问题，应用 Haldane–Anscombe 校正。按照规定，如果任何单元格计数为 $0$，我们将所有四个单元格的计数都加上 $0.5$。设（可能校正后的）计数为 $a', b', c', d'$。校正后的估计量为：\n\n$$\n\\widehat{\\mathrm{OR}} = \\frac{a'd'}{b'c'}\n$$\n其中，如果任何原始计数为 $0$，则 $a' = a+0.5$, $b' = b+0.5$, $c' = c+0.5$, and $d' = d+0.5$；否则 $a'=a$, $b'=b$, $c'=c$, $d'=d$。\n\n**2. 对数比值比及其标准误**\n\n对于统计推断，使用比值比的自然对数 $\\log(\\widehat{\\mathrm{OR}})$ 非常有利。$\\log(\\widehat{\\mathrm{OR}})$ 的抽样分布比 $\\widehat{\\mathrm{OR}}$ 的抽样分布更接近正态分布，尤其是在有限样本中。\n\n估计的对数比值比如下：\n$$\n\\log(\\widehat{\\mathrm{OR}}) = \\log\\left(\\frac{a'd'}{b'c'}\\right) = \\log(a') + \\log(d') - \\log(b') - \\log(c')\n$$\n\n对数比值比估计量的方差可以使用 delta 方法进行近似。$\\log(\\widehat{\\mathrm{OR}})$ 方差的大样本近似由各单元格计数的倒数之和给出：\n$$\n\\mathrm{Var}(\\log(\\widehat{\\mathrm{OR}})) \\approx \\frac{1}{a'} + \\frac{1}{b'} + \\frac{1}{c'} + \\frac{1}{d'}\n$$\n\n对数比值比的标准误 $\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$ 是该估计方差的平方根：\n$$\n\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})] = \\sqrt{\\frac{1}{a'} + \\frac{1}{b'} + \\frac{1}{c'} + \\frac{1}{d'}}\n$$\n\n**3. 比值比的置信区间**\n\n利用对数比值比的正态近似，为真实对数比值比 $\\log(\\mathrm{OR})$ 构建一个双侧 $(1-\\alpha)$ 置信区间（CI）如下：\n$$\n\\log(\\widehat{\\mathrm{OR}}) \\pm z_{1-\\alpha/2} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。对于 $\\alpha = 0.05$ 的显著性水平，我们需要 $1 - 0.05/2 = 0.975$ 分位数，其值为 $z_{0.975} \\approx 1.95996$。\n\n设此置信区间的下限和上限分别为 $L = \\log(\\widehat{\\mathrm{OR}}) - z_{0.975} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$ 和 $U = \\log(\\widehat{\\mathrm{OR}}) + z_{0.975} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$。\n\n为了获得比值比 $\\mathrm{OR}$ 本身的置信区间，我们对这些界限取指数：\n$$\n\\text{CI for OR} = [\\exp(L), \\exp(U)]\n$$\n\n**4. Wald 假设检验**\n\n我们希望检验零假设 $H_0$，即暴露与疾病之间没有关联，这对应于真实比值比为 $1$。备择假设 $H_1$ 是存在关联。\n- $H_0: \\mathrm{OR} = 1$\n- $H_1: \\mathrm{OR} \\neq 1$\n\n在对数尺度上，这等价于：\n- $H_0: \\log(\\mathrm{OR}) = 0$\n- $H_1: \\log(\\mathrm{OR}) \\neq 0$\n\nWald 检验统计量 $Z$ 的构建方法是将估计的对数比值比除以其标准误。这衡量了估计值与零假设值 $0$ 相差多少个标准误。\n$$\nZ = \\frac{\\log(\\widehat{\\mathrm{OR}}) - 0}{\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]} = \\frac{\\log(\\widehat{\\mathrm{OR}})}{\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]}\n$$\n在 $H_0$ 下，该统计量 $Z$ 近似服从标准正态分布 $\\mathcal{N}(0, 1)$。\n\n双侧 p 值是在假设 $H_0$ 为真的情况下，观测到至少与当前观测值一样极端的检验统计量的概率。其计算公式为：\n$$\np = P(|Z_{obs}| \\ge |z|) = 2 \\times P(Z_{obs} \\ge |z|) = 2 \\times (1 - \\Phi(|z|))\n$$\n其中 $z$ 是检验统计量 $Z$ 的观测值，$\\Phi(\\cdot)$ 是标准正态分布的累积分布函数（CDF）。\n\n如果在显著性水平 $\\alpha$ 下，计算出的 p 值小于或等于 $\\alpha$，则拒绝零假设 $H_0$。对于本问题，如果 $p \\le 0.05$，我们拒绝 $H_0$。\n\n该程序将应用于每个测试用例，产生七个所需的输出：\n1. $\\widehat{\\mathrm{OR}}$\n2. $\\log(\\widehat{\\mathrm{OR}})$\n3. $\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$\n4. OR 的 $95\\%$ CI 的下限\n5. OR 的 $95\\%$ CI 的上限\n6. 双侧 Wald 检验 p 值\n7. 一个布尔值，指示在 $\\alpha=0.05$ 时是否拒绝 $H_0$。\n所有数值结果将四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and generate the final output string.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, b, c, d)\n        (40, 60, 20, 80),    # Case 1: general moderate counts\n        (0, 50, 30, 70),     # Case 2: boundary condition with a zero cell\n        (30, 70, 28, 72),    # Case 3: near-null association\n        (10, 90, 30, 70),    # Case 4: association below one\n        (5, 95, 0, 100),     # Case 5: boundary condition with a zero control exposure cell\n        (1000, 1500, 1100, 1400), # Case 6: large-sample stability\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _calculate_or_statistics(*case)\n        results.append(result)\n\n    # Format the final output string as per the problem specification.\n    # e.g., [[val1,val2,...],[val1,val2,...]] with no spaces.\n    # The str() function for a boolean correctly produces 'True' or 'False'.\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, r))}]' for r in results])}]\"\n    print(output_str)\n\ndef _calculate_or_statistics(a, b, c, d):\n    \"\"\"\n    Calculates statistics related to the odds ratio for a 2x2 table.\n\n    Args:\n        a (int): Exposed cases\n        b (int): Unexposed cases\n        c (int): Exposed controls\n        d (int): Unexposed controls\n\n    Returns:\n        list: A list containing 7 elements:\n              1. Estimated odds ratio\n              2. Natural log of the estimated odds ratio\n              3. Standard error of the log odds ratio\n              4. Lower bound of the 95% CI for the odds ratio\n              5. Upper bound of the 95% CI for the odds ratio\n              6. Wald test p-value\n              7. Boolean for rejection of the null hypothesis at alpha=0.05\n    \"\"\"\n    alpha = 0.05\n    a_calc, b_calc, c_calc, d_calc = float(a), float(b), float(c), float(d)\n\n    # Apply Haldane–Anscombe correction if any cell is zero.\n    if a == 0 or b == 0 or c == 0 or d == 0:\n        a_calc += 0.5\n        b_calc += 0.5\n        c_calc += 0.5\n        d_calc += 0.5\n\n    # 1. Estimate the odds ratio (OR_hat)\n    # Check for division by zero in the denominator, even after correction (though unlikely)\n    if b_calc == 0 or c_calc == 0:\n        # This case is highly pathological and shouldn't occur with the correction\n        # in place for non-negative integer inputs. We handle it defensively.\n        return [None] * 7\n        \n    or_hat = (a_calc * d_calc) / (b_calc * c_calc)\n\n    # 2. Estimate the natural logarithm of the odds ratio\n    log_or_hat = np.log(or_hat)\n\n    # 3. Estimate the standard error of the log odds ratio\n    se_log_or_hat = np.sqrt(1/a_calc + 1/b_calc + 1/c_calc + 1/d_calc)\n\n    # 4.  5. Construct a (1-alpha) CI for the true odds ratio\n    z_alpha_2 = norm.ppf(1 - alpha / 2)\n    log_ci_lower = log_or_hat - z_alpha_2 * se_log_or_hat\n    log_ci_upper = log_or_hat + z_alpha_2 * se_log_or_hat\n    \n    ci_or_lower = np.exp(log_ci_lower)\n    ci_or_upper = np.exp(log_ci_upper)\n\n    # 6. Perform a two-sided Wald hypothesis test (H0: OR = 1, i.e., log(OR) = 0)\n    wald_z_stat = log_or_hat / se_log_or_hat\n    p_value = 2 * norm.sf(np.abs(wald_z_stat)) # sf = 1 - cdf, more accurate for tails\n\n    # 7. Determine whether to reject the null hypothesis\n    reject_h0 = p_value = alpha\n\n    # Round numerical results to six decimal places\n    return [\n        round(or_hat, 6),\n        round(log_or_hat, 6),\n        round(se_log_or_hat, 6),\n        round(ci_or_lower, 6),\n        round(ci_or_upper, 6),\n        round(p_value, 6),\n        reject_h0\n    ]\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "真实世界的数据往往并不完美。这个引人深思的练习提出了一个在研究中常见的情景：当您的$2 \\times 2$表格中出现零计数时会发生什么。您将探索为何标准的大样本公式在这种情况下会失效，并理解精确检验（如Fisher精确检验）背后的原理，它为我们处理小样本或稀疏数据提供了可靠的统计推断方法。",
            "id": "4616364",
            "problem": "一项非匹配病例对照研究调查了暴露于一种罕见污染物是否与某种疾病相关。数据汇总在一个 $2\\times 2$ 表格中，格子计数如下（使用常规表示法，其中 $a$ 为暴露病例数，$b$ 为非暴露病例数，$c$ 为暴露对照数，$d$ 为非暴露对照数）：$a=2$，$b=4$，$c=0$，$d=6$。病例总数为 $n_{1}=6$，对照总数为 $n_{0}=6$，暴露对象总数为 $m_1=2$。假设采用标准的病例对照抽样，其中 $n_{1}$ 和 $n_{0}$ 由研究设计固定。\n\n仅使用流行病学和概率论的核心定义，包括比值和比值比（OR）的定义，以及在无关联的原假设下，给定固定边际总量时暴露病例数的条件分布为超几何分布这一事实，判断下列哪些陈述是正确的。选择所有适用项。\n\nA. 对于这些数据，通过 $2\\times 2$ 表的交叉乘积计算得到的常规样本比值比是无穷大。\n\nB. 如果为了处理零格子而应用 Haldane–Anscombe 校正（仅在零格子中加上 $0.5$），然后计算比值比，其估计值约为 $8.13$。\n\nC. 使用 Fisher 精确检验（将在原假设下，与观测表格相同或更极端的表格的超几何概率相加），检验无关联性的双侧精确 $p$ 值为 $0.454$。\n\nD. 比值比的等尾精确条件 $95\\%$ 置信区间没有有限的上界，并且包含 $1$。\n\nE. 基于渐近正态性的对数比值比的 Wald $95\\%$ 置信区间在此处是有效的，因为 $n_{1}$ 和 $n_{0}$ 是由研究设计固定的。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、问题清晰且客观的。它为标准的流行病学分析提供了一个完整且一致的数据集。\n\n来自该非匹配病例对照研究的数据可总结为以下 $2 \\times 2$ 表格：\n\n| | 病例 (疾病+) | 对照 (疾病-) | 总计 |\n| :--- | :--- | :--- | :--- |\n| **暴露** | $a=2$ | $c=0$ | $m_1=2$ |\n| **未暴露** | $b=4$ | $d=6$ | $m_0=10$|\n| **总计** | $n_1=6$ | $n_0=6$ | $N=12$ |\n\n边际总量是固定的：病例总数 $n_1 = a+b = 6$，对照总数 $n_0 = c+d = 6$，暴露总数 $m_1 = a+c = 2$，未暴露总数 $m_0 = b+d=10$。总样本量为 $N=12$。\n\n我们现在来评估每个陈述。\n\n### 选项 A 分析\n**陈述：** 对于这些数据，通过 $2\\times 2$ 表的交叉乘积计算得到的常规样本比值比是无穷大。\n\n样本比值比（$OR$）是总体比值比的一个估计值。对于病例对照研究，它被计算为病例中暴露比值与对照中暴露比值的比率。\n病例中的暴露比值为 $\\frac{a}{b}$。\n对照中的暴露比值为 $\\frac{c}{d}$。\n因此，样本比值比 $\\widehat{OR}$ 为：\n$$ \\widehat{OR} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n代入给定的格子计数：\n$$ \\widehat{OR} = \\frac{(2)(6)}{(4)(0)} = \\frac{12}{0} $$\n除以零是一个未定义的操作。在比值比的背景下，分母中出现零格子（$b$ 或 $c$）会导致点估计值为 $0$ 或无穷大。此处，由于 $c=0$，比值比的估计值为无穷大。\n\n**对 A 的判断：** 正确。计算导致除以零，从而得出无穷大的样本比值比。\n\n### 选项 B 分析\n**陈述：** 如果为了处理零格子而应用 Haldane–Anscombe 校正（仅在零格子中加上 $0.5$），然后计算比值比，其估计值约为 $8.13$。\n\n该陈述描述了一个特定的、尽管非标准的程序：“仅在零格子中加上 $0.5$”。让我们应用这个程序。\n唯一的零格子是 $c=0$。\n修改后的格子计数为：$a' = 2$，$b' = 4$，$c' = 0+0.5 = 0.5$，$d' = 6$。\n根据这些修改后的计数计算的比值比是：\n$$ \\widehat{OR} = \\frac{a'd'}{b'c'} = \\frac{(2)(6)}{(4)(0.5)} = \\frac{12}{2} = 6 $$\n这个值不约等于 $8.13$。\n\n更常见的“Haldane-Anscombe 校正”指的是在表格的*所有*格子中都加上 $0.5$。让我们使用这个标准程序来计算比值比：\n校正后的格子计数为：$a''=2.5$，$b''=4.5$，$c''=0.5$，$d''=6.5$。\n得到的比值比是：\n$$ \\widehat{OR} = \\frac{a''d''}{b''c''} = \\frac{(2.5)(6.5)}{(4.5)(0.5)} = \\frac{16.25}{2.25} \\approx 7.22 $$\n这个值也不约等于 $8.13$。该陈述基于其自己描述的程序以及与其同名的标准程序都是事实错误的。\n\n**对 B 的判断：** 错误。基于所述程序计算得出的比值比为 $6$，而标准的 Haldane-Anscombe 校正得出的比值比约为 $7.22$。两者都与声称的 $8.13$ 不符。\n\n### 选项 C 分析\n**陈述：** 使用 Fisher 精确检验（将在原假设下，与观测表格相同或更极端的表格的超几何概率相加），检验无关联性的双侧精确 $p$ 值为 $0.454$。\n\n在无关联的原假设下，并以边际总量（$n_1=6, n_0=6, m_1=2, m_0=10$）为条件，暴露病例数 $a$ 服从超几何分布。观测到一个有 $a$ 个暴露病例的表格的概率由以下公式给出：\n$$ P(a) = \\frac{\\binom{m_1}{a} \\binom{m_0}{n_1-a}}{\\binom{N}{n_1}} = \\frac{\\binom{2}{a} \\binom{10}{6-a}}{\\binom{12}{6}} $$\n$a$ 的可能值受边际总量的约束：$\\max(0, n_1-m_0) \\le a \\le \\min(n_1, m_1)$，即 $\\max(0, 6-10) \\le a \\le \\min(6, 2)$，所以 $a \\in \\{0, 1, 2\\}$。\n\n让我们计算 $a$ 的所有可能值的概率：\n分母是 $\\binom{12}{6} = \\frac{12!}{6!6!} = 924$。\n- 对于 $a=0$：$P(a=0) = \\frac{\\binom{2}{0}\\binom{10}{6}}{924} = \\frac{1 \\cdot 210}{924} = \\frac{210}{924}$。\n- 对于 $a=1$：$P(a=1) = \\frac{\\binom{2}{1}\\binom{10}{5}}{924} = \\frac{2 \\cdot 252}{924} = \\frac{504}{924}$。\n- 对于 $a=2$（观测值）：$P(a=2) = \\frac{\\binom{2}{2}\\binom{10}{4}}{924} = \\frac{1 \\cdot 210}{924} = \\frac{210}{924}$。\n\n双侧 p 值是与观测表格相同或更极端的表格的概率之和。“更极端”通常定义为概率小于或等于观测表格的概率。\n我们观测到的表格（$a=2$）的概率是 $P(a=2) = 210/924$。\n概率小于或等于此值的表格是 $a=2$ 和 $a=0$ 的情况。\n因此，双侧 p 值为：\n$$ p = P(a=2) + P(a=0) = \\frac{210}{924} + \\frac{210}{924} = \\frac{420}{924} $$\n化简分数为：$\\frac{420}{924} = \\frac{210}{462} = \\frac{105}{231} = \\frac{35}{77} = \\frac{5}{11}$。\n作为小数，$p = 5/11 \\approx 0.454545...$。\n截断到三位小数得到 $0.454$，四舍五入得到 $0.455$。陈述的值 $0.454$ 是该结果的有效表示。\n\n**对 C 的判断：** 正确。双側 Fisher 精确检验 p 值的计算是准确的。\n\n### 选项 D 分析\n**陈述：** 比值比的等尾精确条件 $95\\%$ 置信区间没有有限的上界，并且包含 $1$。\n\n比值比（$OR$ 或 $\\psi$）的精确条件置信区间是通过反转 Fisher 精确检验来构建的。区间 $[\\psi_L, \\psi_U]$ 通过求解以下方程得到：\n1. 对于下界，求解 $P(X \\ge a | \\psi = \\psi_L) = \\alpha/2$。\n2. 对于上界，求解 $P(X \\le a | \\psi = \\psi_U) = \\alpha/2$。\n这里，$a=2$ 且 $\\alpha=0.05$。\n\n**上界：** 我们需要求解 $P(X \\le 2 | \\psi_U) = 0.025$。格子计数 $a$ 的可能值为 $\\{0, 1, 2\\}$。观测值 $a=2$ 是最大可能值。因此，累积概率 $P(X \\le 2 | \\psi)$ 是所有可能结果的概率之和，对于任何 $\\psi  0$ 的值，它总是 $1$：\n$$ P(X \\le 2 | \\psi) = P(X=0|\\psi) + P(X=1|\\psi) + P(X=2|\\psi) = 1 $$\n方程 $1 = 0.025$ 对于 $\\psi_U$ 没有解。按照惯例，当观测值是可能的最大值（或最小值）时，相应的置信限被设置为无穷大（或零）。因此，上界为 $\\psi_U = \\infty$。\n\n**是否包含 $1$：** 要确定 $OR=1$ 是否在置信区间内，我们可以进行一个显著性水平为 $\\alpha=0.05$ 的假设检验 $H_0: OR=1$。如果我们未能拒绝原假设，则 $OR=1$ 包含在 $95\\%$ CI 中。在选项 C 中计算的用于检验 $H_0: OR=1$ 的双侧 p 值为 $p=5/11 \\approx 0.455$。\n由于 $p \\approx 0.455  0.05$，我们不拒绝原假设。因此，比值比为 $1$ 是一个合理的值，并被包含在 $95\\%$ 置信区间内。\n\n**对 D 的判断：** 正确。该区间没有有限的上界，因为观测的格子计数是可能的最大值。它包含 $1$ 是因为对于原假设 $OR=1$ 的 p 值大于 $0.05$。\n\n### 选项 E 分析\n**陈述：** 基于渐近正态性的对数比值比的 Wald $95\\%$ 置信区间在此处是有效的，因为 $n_1$ 和 $n_0$ 是由研究设计固定的。\n\n构建置信区间的 Wald 方法依赖于对数比值比估计量的渐近正态性。置信区间的公式为 $\\log(\\widehat{OR}) \\pm z_{\\alpha/2} \\sqrt{\\widehat{Var}(\\log(\\widehat{OR}))}$，其中估计方差为：\n$$ \\widehat{Var}(\\log(\\widehat{OR})) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d} $$\n对于给定的数据，$c=0$。这直接导致两个问题：\n1. 对数比值比本身，即 $\\log(\\frac{ad}{bc})$，由于除以零而未定义。\n2. 方差估计包含项 $1/c$，即 $1/0$，因此是无穷大。\nWald 方法在没有修正（如 Haldane-Anscombe 校正）的情况下不适用于这些数据。更根本的是，像 Wald 区间这样的渐近方法的有效性取决于大样本量，特别是表格中所有格子都有合理大的计数。对于像 $a=2$，$b=4$，$d=6$ 这样的小计数，尤其是 $c=0$ 的零计数，正态性假设被严重违反。所提供的理由，“因为 $n_1$ 和 $n_0$ 是由研究设计固定的”，是使用精确条件方法（如 Fisher 精确检验）的条件，而不是将渐近方法应用于稀疏数据的理由。\n\n**对 E 的判断：** 错误。由于零格子计数和小样本量违反了渐近假设，Wald 区间对这些数据无效。所提供的理由与 Wald 方法的有效性无关。",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "一个未经调整的比值比可能会产生误导，特别是当存在第三个变量（即混杂因素）扭曲了暴露与疾病之间的真实关联时。这项练习向您介绍分层分析和经典的Mantel-Haenszel方法，这是一种计算调整后比值比以控制混杂效应的强大技术。通过这个练习，您还将巩固一个关键概念：为什么在病例对照研究中，比值比是主要的关联度量指标，而不是风险比。",
            "id": "4808937",
            "problem": "一位医学研究者进行了一项分层病例对照研究，以评估二元暴露 $E$ 与二元疾病结局 $D$ 之间的关联，通过在 $3$ 个水平（例如，年龄组或医院地点）上进行分层来控制一个潜在的混杂因素。在每个层 $k \\in \\{1,2,3\\}$ 内，数据构成一个 $2 \\times 2$ 的计数表格，其中有 $a_k$ 名暴露病例，$b_k$ 名暴露对照，$c_k$ 名非暴露病例，和 $d_k$ 名非暴露对照。观察到的计数如下：\n\n- 层 $1$：$a_1 = 72$，$b_1 = 96$，$c_1 = 48$，$d_1 = 144$。\n- 层 $2$：$a_2 = 48$，$b_2 = 64$，$c_2 = 32$，$d_2 = 96$。\n- 层 $3$：$a_3 = 36$，$b_3 = 48$，$c_3 = 24$，$d_3 = 72$。\n\n假设各层之间存在一个共同的层特异性比值比。使用 Mantel-Haenszel (MH) 方法对病例对照研究进行分层分析，根据这些数据计算共同比值比估计量 $\\hat{\\theta}_{MH}$。将您的最终数值答案四舍五入至四位有效数字。\n\n然后，基于病例对照抽样和分层分析的基本原则，解释为什么在没有额外信息或假设的情况下，从相同的 $2 \\times 2$ 表格计算出的 Mantel-Haenszel 风险比估计量 $\\hat{R}_{MH}$ 在这种病例对照设计中通常是不可解释的。您的解释应依赖于病例对照抽样下哪些参数是可识别的、哪些是不可识别的基本原理，并且不应引用任何未经证实的简化公式。需要报告的最终答案仅为计算出的 $\\hat{\\theta}_{MH}$ 的值（按指定的四舍五入要求）。",
            "solution": "该问题要求从一项分层病例对照研究中计算 Mantel-Haenszel (MH) 共同比值比估计量 $\\hat{\\theta}_{MH}$，并解释为什么相应的 MH 风险比估计量在这种情况下是不可解释的。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 一项分层病例对照研究，有 $3$ 个层，索引为 $k \\in \\{1, 2, 3\\}$。\n- 对于每个层 $k$，数据以 $2 \\times 2$ 表格的形式给出：$a_k$（暴露病例），$b_k$（暴露对照），$c_k$（非暴露病例），和 $d_k$（非暴露对照）。\n- 层 1 的数据：$a_1 = 72$，$b_1 = 96$，$c_1 = 48$，$d_1 = 144$。\n- 层 2 的数据：$a_2 = 48$，$b_2 = 64$，$c_2 = 32$，$d_2 = 96$。\n- 层 3 的数据：$a_3 = 36$，$b_3 = 48$，$c_3 = 24$，$d_3 = 72$。\n- 提供了各层之间比值比相同的假设。\n- 任务是计算 $\\hat{\\theta}_{MH}$ 并解释在此实验设计中 MH 风险比估计量的不可解释性。\n\n该问题具有科学依据，因为它涉及生物统计学和流行病学中的一个标准和基本方法。问题提法明确，为获得唯一解提供了所有必要的数据和定义。语言客观而精确。数据内部一致，对于此类研究而言是现实的。因此，该问题是有效的。\n\n我们开始求解。\n\n第 1 部分：计算 Mantel-Haenszel 共同比值比估计量 $\\hat{\\theta}_{MH}$。\n\n跨越 $K$ 个层的共同比值比 $\\theta$ 的 Mantel-Haenszel 估计量由以下公式给出：\n$$ \\hat{\\theta}_{MH} = \\frac{\\sum_{k=1}^{K} R_k}{\\sum_{k=1}^{K} S_k} = \\frac{\\sum_{k=1}^{K} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{K} \\frac{b_k c_k}{N_k}} $$\n其中 $N_k = a_k + b_k + c_k + d_k$ 是第 $k$ 层中的受试者总数。\n\n我们为 3 个层中的每一个计算其组成部分。\n\n对于层 1 ($k=1$):\n- $a_1 = 72$，$b_1 = 96$，$c_1 = 48$，$d_1 = 144$。\n- 受试者总数为 $N_1 = 72 + 96 + 48 + 144 = 360$。\n- 分子部分是 $R_1 = \\frac{a_1 d_1}{N_1} = \\frac{72 \\times 144}{360} = \\frac{10368}{360} = 28.8$。\n- 分母部分是 $S_1 = \\frac{b_1 c_1}{N_1} = \\frac{96 \\times 48}{360} = \\frac{4608}{360} = 12.8$。\n\n对于层 2 ($k=2$):\n- $a_2 = 48$，$b_2 = 64$，$c_2 = 32$，$d_2 = 96$。\n- 受试者总数为 $N_2 = 48 + 64 + 32 + 96 = 240$。\n- 分子部分是 $R_2 = \\frac{a_2 d_2}{N_2} = \\frac{48 \\times 96}{240} = \\frac{4608}{240} = 19.2$。\n- 分母部分是 $S_2 = \\frac{b_2 c_2}{N_2} = \\frac{64 \\times 32}{240} = \\frac{2048}{240} = \\frac{128}{15}$。\n\n对于层 3 ($k=3$):\n- $a_3 = 36$，$b_3 = 48$，$c_3 = 24$，$d_3 = 72$。\n- 受试者总数为 $N_3 = 36 + 48 + 24 + 72 = 180$。\n- 分子部分是 $R_3 = \\frac{a_3 d_3}{N_3} = \\frac{36 \\times 72}{180} = \\frac{2592}{180} = 14.4$。\n- 分母部分是 $S_3 = \\frac{b_3 c_3}{N_3} = \\frac{48 \\times 24}{180} = \\frac{1152}{180} = 6.4$。\n\n现在，我们将所有层的分量相加：\n$$ \\sum_{k=1}^{3} R_k = R_1 + R_2 + R_3 = 28.8 + 19.2 + 14.4 = 62.4 $$\n$$ \\sum_{k=1}^{3} S_k = S_1 + S_2 + S_3 = 12.8 + \\frac{128}{15} + 6.4 = 19.2 + \\frac{128}{15} = \\frac{19.2 \\times 15 + 128}{15} = \\frac{288 + 128}{15} = \\frac{416}{15} $$\n\n最后，我们计算 Mantel-Haenszel 估计量：\n$$ \\hat{\\theta}_{MH} = \\frac{\\sum R_k}{\\sum S_k} = \\frac{62.4}{\\frac{416}{15}} = \\frac{62.4 \\times 15}{416} = \\frac{936}{416} $$\n化简分数：\n$$ \\hat{\\theta}_{MH} = \\frac{936 \\div 104}{416 \\div 104} = \\frac{9}{4} = 2.25 $$\n问题要求将答案四舍五入到四位有效数字。这得到 $2.250$。\n\n该数据集的一个值得注意的特点是层特异性比值比是恒定的：\n$\\hat{OR}_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{72 \\times 144}{96 \\times 48} = 2.25$。\n$\\hat{OR}_2 = \\frac{a_2 d_2}{b_2 c_2} = \\frac{48 \\times 96}{64 \\times 32} = 2.25$。\n$\\hat{OR}_3 = \\frac{a_3 d_3}{b_3 c_3} = \\frac{36 \\times 72}{48 \\times 24} = 2.25$。\n当层特异性比值比相同时，MH 估计量等于这个共同的值，我们的计算证实了这一点。\n\n第 2 部分：Mantel-Haenszel 风险比 ($\\hat{R}_{MH}$) 在病例对照研究中的不可解释性。\n\n该解释基于研究设计的基本原则以及从所得数据中可以识别哪些参数。\n\n$1$. **病例对照抽样原则**：病例对照研究根据受试者的疾病结局状态（$D$）进行抽样。招募一组患有该疾病的个体（病例，$D=1$）和另一组未患该疾病的个体（对照，$D=0$）。然后，研究人员确定两组受试者先前的暴露状态（$E$）。研究中病例和对照的数量由设计固定，通常不反映源人群中疾病的患病率。\n\n$2$. **可识别参数与不可识别参数**：\n   - 由于抽样是以 $D$ 为条件的，病例对照研究允许直接估计在给定疾病状态下的暴露概率 $P(E|D)$。在层 $k$ 内，我们可以通过比例 $\\frac{a_k}{a_k+c_k}$ 估计 $P(E=1|D=1, k)$，通过 $\\frac{b_k}{b_k+d_k}$ 估计 $P(E=1|D=0, k)$。\n   - 这允许计算*暴露比值比*：\n     $$ OR_{\\text{exposure}, k} = \\frac{P(E=1|D=1, k) / P(E=0|D=1, k)}{P(E=1|D=0, k) / P(E=0|D=0, k)} = \\frac{a_k/c_k}{b_k/d_k} = \\frac{a_k d_k}{b_k c_k} $$\n   - 比值比的一个关键特性是其对于研究设计的不变性。暴露比值比在数学上与在队列研究中估计的*疾病比值比*相同：\n     $$ OR_{\\text{disease}, k} = \\frac{P(D=1|E=1, k) / P(D=0|E=1, k)}{P(D=1|E=0, k) / P(D=0|E=0, k)} $$\n   - 因此，在病例对照研究中，比值比是一个可识别的参数。\n\n$3$. **风险和风险比的问题**：\n   - 疾病*风险*是条件概率 $P(D|E)$。具体来说，暴露组的风险是 $P(D=1|E=1)$，非暴露组的风险是 $P(D=1|E=0)$。\n   - *风险比* ($RR$) 是这些风险的比率：$RR = \\frac{P(D=1|E=1)}{P(D=1|E=0)}$。\n   - 要估计风险，需要根据暴露状态（$E$）进行抽样，就像在队列研究中所做的那样。在队列研究中，比例 $\\frac{a_k}{a_k+b_k}$ 和 $\\frac{c_k}{c_k+d_k}$ 分别是层 $k$ 内暴露组和非暴露组风险的有效估计。\n   - 然而，在病例对照研究中，数量 $a_k+b_k$（样本中暴露的总受试者）和 $c_k+d_k$（样本中非暴露的总受试者）并不代表源人群中所有暴露和非暴露个体的随机样本。这些总数中的病例数（$a_k$、$c_k$）和对照数（$b_k$、$d_k$）是研究者选择的抽样比率的人为结果。\n   - 因此，从病例对照数据计算出的数量 $\\frac{a_k}{a_k+b_k}$ 和 $\\frac{c_k}{c_k+d_k}$ 并不能估计真实的群体风险。它们不能被解释为 $P(D=1|E=1, k)$ 和 $P(D=1|E=0, k)$。\n\n$4$. **$\\hat{R}_{MH}$ 公式之无效性**：Mantel-Haenszel 风险比估计量的公式为：\n   $$ \\hat{R}_{MH} = \\frac{\\sum_{k=1}^{K} \\frac{a_k (c_k+d_k)}{N_k}}{\\sum_{k=1}^{K} \\frac{c_k (a_k+b_k)}{N_k}} $$\n   这个公式是层特异性风险比的加权平均值，由用于估计队列研究中风险的项构成。由于从病例对照数据中无法识别估计层特异性风险所需的分量，将此公式应用于此类数据会产生一个缺乏预期流行病学解释的数值。它并不能估计真实的共同风险比。只有在额外的假设下（例如，稀有疾病假设，此时 $OR \\approx RR$）或有外部信息（例如，人群疾病患病率）的情况下，才能从病例对照数据中获得风险比的估计值，而问题陈述中并未提供这些信息。",
            "answer": "$$\\boxed{2.250}$$"
        }
    ]
}