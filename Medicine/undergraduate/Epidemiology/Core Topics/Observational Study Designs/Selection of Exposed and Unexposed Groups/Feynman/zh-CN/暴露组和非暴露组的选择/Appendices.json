{
    "hands_on_practices": [
        {
            "introduction": "观察性研究中的一个根本挑战是确保暴露组和非暴露组具有可比性。本练习将展示从不同人群（例如，不同的转诊网络）中抽样如何引入潜在但严重的偏倚，即使在调整了明显的混杂因素后也是如此。我们将通过一个假设情景，揭示未测量因素和选择偏倚的隐藏作用。",
            "id": "4635157",
            "problem": "一位研究者希望使用观测数据来估计一种新的基于临床的暴露 $X$ 对二元结局 $Y$ 的因果效应。令 $Y^x$ 表示在暴露水平 $x \\in \\{0,1\\}$ 下的潜在结局。目标可交换性条件为 $Y^x \\perp X \\mid Z$，其中 $Z$ 是一个已测量的协变量。该研究者从一个转诊网络中招募了暴露组，并从另一个不同的转诊网络中招募了非暴露组。考虑以下明确的数据生成过程，该过程对于基于临床的暴露是科学上合理的：\n\n- 令 $Z \\in \\{0,1\\}$ 表示年龄组，其中 $P(Z=1)=0.5$。为简单起见，假设 $Z$ 与下文的其他基线变量独立。\n- 令 $U \\in \\{0,1\\}$ 表示一种未测量的就医倾向，它既会增加被转诊到特定网络的几率，也会增加结局的风险。令 $P(U=1)=0.5$ 且 $U \\perp Z$。\n- 令 $R \\in \\{0,1\\}$ 表示转诊网络，其中 $R=1$ 是一个大型三级网络，$R=0$ 是一个社区网络。就医倾向 $U$ 强烈影响转诊：$P(R=1 \\mid U=1)=0.9$ 且 $P(R=1 \\mid U=0)=0.1$。\n- 临床暴露 $X$ 仅在三级网络中可用：$P(X=1 \\mid R=1)=0.5$ 且 $P(X=1 \\mid R=0)=0$。因此，在给定 $R=1$ 的条件下，$X \\perp (U,Z)$，但当 $R=0$ 时，$X=0$ 几乎是必然的。\n- 结局 $Y \\in \\{0,1\\}$ 的潜在结局风险由 $U$ 和暴露益处驱动：$P(Y^1=1 \\mid U=1)=0.3$，$P(Y^1=1 \\mid U=0)=0.1$，$P(Y^0=1 \\mid U=1)=0.4$，以及 $P(Y^0=1 \\mid U=0)=0.2$。因此，对于任何固定的 $U$，暴露都会降低风险。\n- 组建的研究仅抽样选择指示变量 $S=1$ 的个体，其设计为：暴露者取自三级网络，非暴露者取自社区网络。形式上，$S=1$ 当且仅当 $(X=1 \\wedge R=1)$ 或 $(X=0 \\wedge R=0)$；否则 $S=0$。这体现了“暴露者来自网络 $R=1$”和“非暴露者来自网络 $R=0$”。\n\n在 $S=1$ 的组建样本中进行分析：\n\n- 通过上述定义进行推理，说明 $Y^x \\perp X \\mid Z$ 是否成立。\n- 简要论证其成立或不成立的因果机制，并参考 $U, R, X, S, Z$ 和 $Y^x$ 之间的结构关系。\n\n哪个选项最佳地描述了在这个组建的样本中 $Y^x \\perp X \\mid Z$ 是否成立及其机制？\n\nA. 不成立。从一个不同的转诊网络中选择非暴露者，会通过 $X \\rightarrow S \\leftarrow R \\leftarrow U$ 在 $S=1$ 的样本内诱导 $X$ 和未测量的 $U$ 之间的关联，从而即使在校正 $Z$ 之后也违反了 $Y^x \\perp X \\mid Z$。此外，在 $S=1$ 的样本内存在关于 $R$ 的正值性违背（$P(X=1 \\mid R=0,S=1)=0$ 和 $P(X=0 \\mid R=1,S=1)=0$），因此校正 $R$ 也无法恢复可交换性。\n\nB. 成立。因为在 $R=1$ 内暴露分配是随机的，并且来自 $R=0$ 的非暴露者在 $Z$ 的各层内代表了相同的源人群，所以我们有 $Y^x \\perp X \\mid Z$。\n\nC. 不成立。可交换性不成立，但可以通过校正转诊网络 $R$ 来恢复，因为 $R$ 阻断了所有后门路径，所以 $Y^x \\perp X \\mid (Z,R)$ 成立且效应是可识别的。\n\nD. 成立。年龄组 $Z$ 完全捕捉了与 $R$ 和 $Y$ 相关的就医倾向差异，因此即使网络不同，对 $Z$ 进行条件化也足以保证 $Y^x \\perp X \\mid Z$ 成立。",
            "solution": "用户希望我验证并解决一个关于因果推断和选择偏倚的流行病学问题。\n\n### 第一步：提取已知条件\n\n问题陈述提供了以下信息：\n-   **目标**：估计二元暴露 $X \\in \\{0,1\\}$ 对二元结局 $Y \\in \\{0,1\\}$ 的因果效应。\n-   **潜在结局**：$Y^x$，其中 $x \\in \\{0,1\\}$。\n-   **目标条件**：可交换性，$Y^x \\perp X \\mid Z$。\n-   **已测量的协变量**：$Z \\in \\{0,1\\}$（年龄组），其中 $P(Z=1)=0.5$。$Z$ 与其他基线变量独立。\n-   **未测量的协变量**：$U \\in \\{0,1\\}$（就医倾向），其中 $P(U=1)=0.5$。\n-   **独立性**：$U \\perp Z$。\n-   **转诊网络**：$R \\in \\{0,1\\}$，其中 $R=1$ 为三级网络，$R=0$ 为社区网络。\n-   **U 和 R 之间的关系**：$P(R=1 \\mid U=1)=0.9$ 且 $P(R=1 \\mid U=0)=0.1$。\n-   **R 和 X 之间的关系**：暴露 $X$ 仅在网络 $R=1$ 中可用。形式上，$P(X=1 \\mid R=1)=0.5$ 且 $P(X=1 \\mid R=0)=0$。\n-   **条件独立性**：给定 $R=1$ 时，$X \\perp (U,Z)$。\n-   **U 和 Y^x 之间的关系**：\n    -   $P(Y^1=1 \\mid U=1)=0.3$\n    -   $P(Y^1=1 \\mid U=0)=0.1$\n    -   $P(Y^0=1 \\mid U=1)=0.4$\n    -   $P(Y^0=1 \\mid U=0)=0.2$\n-   **研究选择**：分析仅限于选择指示变量 $S=1$ 的样本。选择规则是：$S=1$ 当且仅当 $(X=1 \\wedge R=1)$ 或 $(X=0 \\wedge R=0)$。\n\n### 第二步：使用提取的已知条件进行验证\n\n该问题是一个定义明确的因果推断练习，具体考察了选择偏倚对可交换性的影响。\n\n-   **科学依据充分**：该问题使用了来自现代流行病学的标准潜在结局符号和概念，如可交换性、混杂和选择偏倚。从不同临床人群中抽取暴露组和非暴露组的场景是观测研究中一个现实且常见的挑战。该概率模型是内部一致的。\n-   **问题适定**：该问题提供了一个完整的量化数据生成过程，并提出了一个精确的数学问题：确定条件独立性陈述 $Y^x \\perp X \\mid Z$ 在由 $S=1$ 定义的子群体中是否成立。可以从给定的概率中推导出明确的答案。\n-   **客观性**：该问题以客观、形式化的语言陈述。所有术语都以概率方式定义。\n\n该问题不违反任何无效标准。它是一个科学合理、适定且客观的问题，是流行病学领域的核心问题。\n\n### 第三步：结论与行动\n\n该问题是**有效的**。我将继续进行解答。\n\n### 推导\n\n主要任务是确定可交换性条件 $Y^x \\perp X \\mid Z$ 在组建的样本（即 $S=1$ 的层）中是否成立。\n\n条件 $Y^x \\perp X \\mid Z$ 成立，如果在 $Z$ 的各层内，暴露组（$X=1$）和非暴露组（$X=0$）的潜在结局 $Y^x$ 的分布相同。在这个问题中，潜在结局 $Y^x$ 由未测量的变量 $U$ 直接导致。因此，可交换性成立当且仅当在给定 $Z$ 的条件下，暴露组和非暴露组中 $U$ 的分布相同。也就是说，我们必须检验 $U \\perp X \\mid Z, S=1$ 是否成立。\n\n问题陈述 $Z$ 与所有其他基线变量（包括 $U$）独立。此外，根据指定的概率，$Z$ 不影响 $R$、$X$ 或 $Y^x$。因此，对 $Z$ 进行条件化不会改变 $U$ 和 $X$ 之间的关系。该条件简化为检验 $U \\perp X \\mid S=1$ 是否成立。为了检验这一点，我们将计算并比较 $P(U=1 \\mid X=1, S=1)$ 和 $P(U=1 \\mid X=0, S=1)$。\n\n1.  **分析样本构成：**\n    -   样本由 $S=1$ 定义，这意味着 $(X=1 \\wedge R=1)$ 或 $(X=0 \\wedge R=0)$。\n    -   这意味着在样本中，一个个体是暴露的（$X=1$）当且仅当他们来自三级网络（$R=1$）。\n    -   类似地，一个个体是非暴露的（$X=0$）当且仅当他们来自社区网络（$R=0$）。\n    -   因此，在 $S=1$ 层内，事件 $\\{X=1\\}$ 和 $\\{R=1\\}$ 是相同的，事件 $\\{X=0\\}$ 和 $\\{R=0\\}$ 也是相同的。\n\n2.  **计算暴露组（$X=1, S=1$）中 $U$ 的分布：**\n    我们需要计算 $P(U=1 \\mid X=1, S=1)$。根据样本定义，这等价于 $P(U=1 \\mid R=1)$。\n    我们使用贝叶斯定理：\n    $$ P(U=1 \\mid R=1) = \\frac{P(R=1 \\mid U=1)P(U=1)}{P(R=1)} $$\n    首先，我们计算边际概率 $P(R=1)$：\n    $$ P(R=1) = P(R=1 \\mid U=1)P(U=1) + P(R=1 \\mid U=0)P(U=0) $$\n    $$ P(R=1) = (0.9)(0.5) + (0.1)(0.5) = 0.45 + 0.05 = 0.5 $$\n    现在，将其代回：\n    $$ P(U=1 \\mid R=1) = \\frac{(0.9)(0.5)}{0.5} = 0.9 $$\n    所以，在暴露组中，$90\\%$ 的个体具有高就医倾向（$U=1$）。\n\n3.  **计算非暴露组（$X=0, S=1$）中 $U$ 的分布：**\n    我们需要计算 $P(U=1 \\mid X=0, S=1)$。这等价于 $P(U=1 \\mid R=0)$。\n    我们再次使用贝叶斯定理：\n    $$ P(U=1 \\mid R=0) = \\frac{P(R=0 \\mid U=1)P(U=1)}{P(R=0)} $$\n    我们知道 $P(R=0) = 1 - P(R=1) = 1 - 0.5 = 0.5$。\n    且 $P(R=0 \\mid U=1) = 1 - P(R=1 \\mid U=1) = 1 - 0.9 = 0.1$。\n    $$ P(U=1 \\mid R=0) = \\frac{(0.1)(0.5)}{0.5} = 0.1 $$\n    所以，在非暴露组中，只有 $10\\%$ 的个体具有高就医倾向（$U=1$）。\n\n4.  **关于可交换性的结论：**\n    我们发现 $P(U=1 \\mid X=1, S=1, Z) = 0.9$ 而 $P(U=1 \\mid X=0, S=1, Z) = 0.1$。由于这些概率不相等，研究样本中暴露组和非暴露组之间混杂因素 $U$ 的分布截然不同。因为 $U$ 是潜在结局 $Y^x$ 的直接原因，这种 $U$ 的不平衡转化为了结局基线风险的不平衡。\n    因此，在 $S=1$ 的样本中，$Y^x \\not\\perp X \\mid Z$。可交换性条件不成立。\n\n5.  **因果机制：**\n    可交换性的不成立是一种选择偏倚。研究设计通过从一个网络（$R=1$）中选择暴露者，从另一个网络（$R=0$）中选择非暴露者，在暴露 $X$ 和未测量的混杂因素 $U$ 之间制造了虚假关联。该因果结构可以用有向无环图（DAG）表示，其中我们有路径 $U \\rightarrow R \\rightarrow X$ 和 $U \\rightarrow Y^x$。变量 $S$ 是一个对撞节点，由 $X$ 和 $R$ 共同决定。对 $S=1$ 进行条件化（即选择研究样本）会诱导 $X$ 和 $U$ 之间的关联。路径 $X \\rightarrow S \\leftarrow R \\leftarrow U$ 因对对撞节点 $S$ 进行条件化而被打开，从而在 $X$ 和 $U$ 之间产生了非因果关联。由于 $U$ 是 $Y^x$ 的一个原因，这导致了混杂。暴露组和非暴露组不具有可比性，因为暴露组中有更高比例的个体具有高风险因素 $U=1$。\n\n### 逐项分析选项\n\n**A. 不成立。从一个不同的转诊网络中选择非暴露者，会通过 $X \\rightarrow S \\leftarrow R \\leftarrow U$ 在 $S=1$ 的样本内诱导 $X$ 和未测量的 $U$ 之间的关联，从而即使在校正 $Z$ 之后也违反了 $Y^x \\perp X \\mid Z$。此外，在 $S=1$ 的样本内存在关于 $R$ 的正值性违背（$P(X=1 \\mid R=0,S=1)=0$ 和 $P(X=0 \\mid R=1,S=1)=0$），因此校正 $R$ 也无法恢复可交换性。**\n-   此选项正确地指出可交换性 ($Y^x \\perp X \\mid Z$) 不成立。\n-   它正确地识别了机制：选择过程诱导了暴露 $X$ 和未测量的混杂因素 $U$ 之间的关联。对路径 $X \\rightarrow S \\leftarrow R \\leftarrow U$ 的描述准确地描绘了对撞分层偏倚机制。\n-   它正确地指出了一个关键的次要问题：正值性违背。在样本（$S=1$）中，如果我们知道一个人来自网络 $R=0$，他们必须有 $X=0$。所以，$P(X=1 \\mid R=0, S=1)=0$。相反，如果他们来自网络 $R=1$，他们必须有 $X=1$，所以 $P(X=0 \\mid R=1, S=1)=0$。这种正值性的缺乏意味着不可能通过校正转诊网络 $R$ 来试图修复偏倚，因为在 $R=0$ 层中没有暴露的受试者，在 $R=1$ 层中也没有非暴露的受试者。\n-   **结论：正确。**\n\n**B. 成立。因为在 $R=1$ 内暴露分配是随机的，并且来自 $R=0$ 的非暴露者在 $Z$ 的各层内代表了相同的源人群，所以我们有 $Y^x \\perp X \\mid Z$。**\n-   此选项错误地声称可交换性成立。\n-   推理中的关键缺陷是断言来自 $R=0$ 的非暴露者与来自 $R=1$ 的暴露者“代表了相同的源人群”。正如我们的计算所证明的，未测量的预后因素 $U$ 的分布在暴露组（$R=1$）中为 $90\\%$，而在非暴露组（$R=0$）中为 $10\\%$。这两个是根本不同的人群。\n-   **结论：不正确。**\n\n**C. 不成立。可交换性不成立，但可以通过校正转诊网络 $R$ 来恢复，因为 $R$ 阻断了所有后门路径，所以 $Y^x \\perp X \\mid (Z,R)$ 成立且效应是可识别的。**\n-   此选项正确地指出可交换性不成立。\n-   然而，它错误地声称这个问题可以通过校正 $R$ 来解决。正如对选项 A 的分析所示，研究设计在所选样本中（当 $S=1$ 时，$X=R$）造成了 $X$ 和 $R$ 之间的完美相关性。这导致了正值性的完全缺乏，使得对 $R$ 进行校正成为不可能。人们无法在相同的 $R$ 层内比较暴露和非暴露的受试者。\n-   **结论：不正确。**\n\n**D. 成立。年龄组 $Z$ 完全捕捉了与 $R$ 和 $Y$ 相关的就医倾向差异，因此即使网络不同，对 $Z$ 进行条件化也足以保证 $Y^x \\perp X \\mid Z$ 成立。**\n-   此选项错误地声称可交换性成立。\n-   根据问题陈述，这个推理在事实上是错误的。问题明确指出 $U$ 是就医倾向，并且 $U \\perp Z$。因此，测量的变量 $Z$ *完全没有*捕捉到就医倾向 $U$ 的任何差异。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在上一概念的基础上，本练习探讨了另一个常见错误：根据未来的信息来定义非暴露组。这个例子将要求您量化当研究者通过排除后来开始接受暴露的个体来创建一个“纯净”的非暴露组时所产生的偏倚，这个错误破坏了因果推断的基本规则。通过具体的计算，您将清楚地看到这个看似无害的选择是如何扭曲结果的。",
            "id": "4635169",
            "problem": "考虑一个有两个时间点 $t \\in \\{1,2\\}$ 的纵向队列。令 $L \\in \\{0,1\\}$ 为 $t=1$ 之前测量的基线协变量，$A_1 \\in \\{0,1\\}$ 为 $t=1$ 时的暴露，$A_2 \\in \\{0,1\\}$ 为 $t=2$ 时的后续暴露，以及 $Y \\in \\{0,1\\}$ 为在 $t=2$ 测量的最终结局。定义潜在结局 $Y^a$ 为：如果 $t=1$ 时的暴露被设定为 $a \\in \\{0,1\\}$，并且所有后续事件在该干预下按其自然过程发展时，在 $t=2$ 将被观测到的结局。目标估计量是平均治疗效应 (ATE)，即 $E[Y^1] - E[Y^0]$。\n\n假设存在以下科学上合理的数据生成机制：\n- 基线协变量：$P(L=1) = 0.5$。\n- $t=1$ 时的暴露：$P(A_1=1 \\mid L=1) = 0.8$ 和 $P(A_1=1 \\mid L=0) = 0.2$。\n- 在 $t=1$ 未暴露者中 $t=2$ 时的后续暴露：$P(A_2=1 \\mid A_1=0, L=1) = 0.7$ 和 $P(A_2=1 \\mid A_1=0, L=0) = 0.1$。在 $t=1$ 时暴露的个体在 $t=2$ 时仍然保持暴露，也就是说，如果 $A_1=1$，则 $A_2=1$ 是确定性的。\n- 一致性假设下的结局模型：对于 $A_1=a$ 的个体，给定 $L$ 的条件下，其条件均值等于相应的潜在结局均值，即 $E(Y \\mid L, A_1=a) = E(Y^a \\mid L)$。具体来说，\n  - $E(Y^1 \\mid L=1) = 0.6$, $E(Y^1 \\mid L=0) = 0.2$,\n  - $E(Y^0 \\mid L=1) = 0.3$, $E(Y^0 \\mid L=0) = 0.1$。\n\n一位研究人员错误地定义了 $t=1$ 时的未暴露比较组，将其限定为在 $t=1$ 和 $t=2$ 时均未暴露的个体（即所谓的截至 $t=2$ 的“从未暴露者”），然后计算观测均值的朴素差异 $E(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0)$ 来估计 $E[Y^1] - E[Y^0]$。\n\n计算这个错误估计量相对于真实 $E[Y^1] - E[Y^0]$ 的偏倚。将最终答案表示为一个精确分数。无需四舍五入，也不涉及任何单位。",
            "solution": "用户希望我验证并解决一个流行病学领域的问题，该问题侧重于因果推断。\n\n### 步骤1：提取已知条件\n-   **研究设计**：一个有两个时间点 $t \\in \\{1,2\\}$ 的纵向队列。\n-   **变量**：\n    -   $L \\in \\{0,1\\}$：一个基线协变量。\n    -   $A_1 \\in \\{0,1\\}$：$t=1$ 时的暴露。\n    -   $A_2 \\in \\{0,1\\}$：$t=2$ 时的暴露。\n    -   $Y \\in \\{0,1\\}$：$t=2$ 时的结局。\n-   **潜在结局**：$Y^a$ 是在干预 $A_1=a$ 下的结局，其中 $a \\in \\{0,1\\}$。\n-   **目标估计量**：平均治疗效应 (ATE)，定义为 $E[Y^1] - E[Y^0]$。\n-   **数据生成机制**：\n    -   $P(L=1) = 0.5$。\n    -   $P(A_1=1 \\mid L=1) = 0.8$。\n    -   $P(A_1=1 \\mid L=0) = 0.2$。\n    -   $P(A_2=1 \\mid A_1=0, L=1) = 0.7$。\n    -   $P(A_2=1 \\mid A_1=0, L=0) = 0.1$。\n    -   如果 $A_1=1$，则 $A_2=1$ 是确定性的。\n-   **结局模型**：一致性和条件可交换性假设被合并为关系式 $E(Y \\mid L, A_1=a) = E(Y^a \\mid L)$。\n    -   $E(Y^1 \\mid L=1) = 0.6$。\n    -   $E(Y^1 \\mid L=0) = 0.2$。\n    -   $E(Y^0 \\mid L=1) = 0.3$。\n    -   $E(Y^0 \\mid L=0) = 0.1$。\n-   **错误估计量**：朴素均值差异，$E(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0)$。\n-   **目标**：计算错误估计量的偏倚，定义为 $(E(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0)) - (E[Y^1] - E[Y^0])$。答案必须是精确分数。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是因果推断领域一个形式完善的练习，因果推断是流行病学和生物统计学的核心领域。它使用了潜在结局、混杂和选择偏倚等标准概念。该设置是一个纵向研究的简化但概念上合理的模型。所有假设，如一致性和给定的概率，对于此类教学性问题都是标准的。\n-   **适定性**：问题提供了计算真实ATE和错误估计量值所需的所有数值和概率关系。目标陈述清晰。假设 $E(Y \\mid L, A_1=a) = E(Y^a \\mid L)$ 意味着在给定 $L$ 和 $A_1$ 的条件下，结局的期望值不依赖于 $A_2$，这使得问题是完全指定的。\n-   **客观性**：问题以精确、正式的语言陈述，没有模糊性或主观因素。\n\n### 步骤3：结论与行动\n该问题是有效的。它科学上合理、适定、客观，并包含获得唯一解所需的所有信息。我将继续进行计算。\n\n### 解题过程\n\n目标是计算研究者估计量的偏倚。偏倚是估计量的期望值与我们感兴趣的真实参数之间的差异。\n$$\n\\text{偏倚} = \\left( E(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0) \\right) - \\left( E[Y^1] - E[Y^0] \\right)\n$$\n我们将计算四个期望项中的每一项。为求精确，我们将所有给定的十进制概率转换为分数：$0.1 = \\frac{1}{10}$，$0.2 = \\frac{1}{5}$，$0.3 = \\frac{3}{10}$，$0.5 = \\frac{1}{2}$，$0.6 = \\frac{3}{5}$，$0.7 = \\frac{7}{10}$，$0.8 = \\frac{4}{5}$。\n\n**1. 计算真实的平均治疗效应 (ATE)，$E[Y^1] - E[Y^0]$**\n\n我们使用全期望定律，对协变量 $L$ 进行边缘化。\n$$\nE[Y^a] = E[E[Y^a \\mid L]] = E[Y^a \\mid L=1]P(L=1) + E[Y^a \\mid L=0]P(L=0)\n$$\n已知 $P(L=1) = \\frac{1}{2}$，因此 $P(L=0) = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n\n-   对于暴露下的潜在结局 ($a=1$)：\n    $$\n    E[Y^1] = \\left(\\frac{3}{5}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{5}\\right)\\left(\\frac{1}{2}\\right) = \\frac{3}{10} + \\frac{1}{10} = \\frac{4}{10} = \\frac{2}{5}\n    $$\n-   对于无暴露下的潜在结局 ($a=0$)：\n    $$\n    E[Y^0] = \\left(\\frac{3}{10}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{10}\\right)\\left(\\frac{1}{2}\\right) = \\frac{3}{20} + \\frac{1}{20} = \\frac{4}{20} = \\frac{1}{5}\n    $$\n-   真实的ATE是：\n    $$\n    E[Y^1] - E[Y^0] = \\frac{2}{5} - \\frac{1}{5} = \\frac{1}{5}\n    $$\n\n**2. 计算错误的估计量，$E(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0)$**\n\n这需要从观测数据分布中计算两个条件期望。\n\n**a. 计算 $E(Y \\mid A_1=1)$**\n\n我们使用全期望定律，以 $L$ 为条件：\n$$\nE(Y \\mid A_1=1) = E(Y \\mid A_1=1, L=1)P(L=1 \\mid A_1=1) + E(Y \\mid A_1=1, L=0)P(L=0 \\mid A_1=1)\n$$\n根据问题的结局模型，$E(Y \\mid L, A_1=a) = E(Y^a \\mid L)$。因此，$E(Y \\mid A_1=1, L=1) = E(Y^1 \\mid L=1) = \\frac{3}{5}$ 且 $E(Y \\mid A_1=1, L=0) = E(Y^1 \\mid L=0) = \\frac{1}{5}$。\n\n我们使用贝叶斯定理来求条件概率 $P(L=l \\mid A_1=1)$，这需要先求边缘概率 $P(A_1=1)$：\n$$\nP(A_1=1) = P(A_1=1 \\mid L=1)P(L=1) + P(A_1=1 \\mid L=0)P(L=0) = \\left(\\frac{4}{5}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{5}\\right)\\left(\\frac{1}{2}\\right) = \\frac{4}{10} + \\frac{1}{10} = \\frac{5}{10} = \\frac{1}{2}\n$$\n现在，应用贝叶斯定理：\n$$\nP(L=1 \\mid A_1=1) = \\frac{P(A_1=1 \\mid L=1)P(L=1)}{P(A_1=1)} = \\frac{(\\frac{4}{5})(\\frac{1}{2})}{\\frac{1}{2}} = \\frac{4}{5}\n$$\n并且 $P(L=0 \\mid A_1=1) = 1 - P(L=1 \\mid A_1=1) = 1 - \\frac{4}{5} = \\frac{1}{5}$。\n\n将这些代入 $E(Y \\mid A_1=1)$ 的表达式中：\n$$\nE(Y \\mid A_1=1) = \\left(\\frac{3}{5}\\right)\\left(\\frac{4}{5}\\right) + \\left(\\frac{1}{5}\\right)\\left(\\frac{1}{5}\\right) = \\frac{12}{25} + \\frac{1}{25} = \\frac{13}{25}\n$$\n\n**b. 计算 $E(Y \\mid A_1=0, A_2=0)$**\n\n我们以 $L$ 为条件：\n$$\nE(Y \\mid A_1=0, A_2=0) = E(Y \\mid A_1=0, A_2=0, L=1)P(L=1|A_1=0, A_2=0) + E(Y \\mid A_1=0, A_2=0, L=0)P(L=0|A_1=0, A_2=0)\n$$\n问题的结局模型 $E(Y \\mid L, A_1=a) = E(Y^a \\mid L)$ 意味着在以 $A_1$ 和 $L$ 为条件后，$Y$ 的期望不依赖于 $A_2$。因此，$E(Y \\mid A_1=0, A_2=0, L=l) = E(Y \\mid A_1=0, L=l) = E(Y^0 \\mid L=l)$。所以，$E(Y \\mid A_1=0, A_2=0, L=1) = \\frac{3}{10}$ 且 $E(Y \\mid A_1=0, A_2=0, L=0) = \\frac{1}{10}$。\n\n我们使用贝叶斯定理找到权重 $P(L=l \\mid A_1=0, A_2=0)$。首先，我们计算联合概率 $P(A_1=0, A_2=0 \\mid L=l)$：\n- 对于 $L=1$：$P(A_1=0 \\mid L=1) = 1 - \\frac{4}{5} = \\frac{1}{5}$。$P(A_2=0 \\mid A_1=0, L=1) = 1 - \\frac{7}{10} = \\frac{3}{10}$。\n  $$\n  P(A_1=0, A_2=0 \\mid L=1) = P(A_2=0 \\mid A_1=0, L=1) P(A_1=0 \\mid L=1) = \\left(\\frac{3}{10}\\right)\\left(\\frac{1}{5}\\right) = \\frac{3}{50}\n  $$\n- 对于 $L=0$：$P(A_1=0 \\mid L=0) = 1 - \\frac{1}{5} = \\frac{4}{5}$。$P(A_2=0 \\mid A_1=0, L=0) = 1 - \\frac{1}{10} = \\frac{9}{10}$。\n  $$\n  P(A_1=0, A_2=0 \\mid L=0) = P(A_2=0 \\mid A_1=0, L=0) P(A_1=0 \\mid L=0) = \\left(\\frac{9}{10}\\right)\\left(\\frac{4}{5}\\right) = \\frac{36}{50} = \\frac{18}{25}\n  $$\n边缘概率 $P(A_1=0, A_2=0)$ 是：\n$$\nP(A_1=0, A_2=0) = P(A_1=0, A_2=0 \\mid L=1)P(L=1) + P(A_1=0, A_2=0 \\mid L=0)P(L=0) = \\left(\\frac{3}{50}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{36}{50}\\right)\\left(\\frac{1}{2}\\right) = \\frac{3}{100} + \\frac{36}{100} = \\frac{39}{100}\n$$\n现在，根据贝叶斯定理：\n$$\nP(L=1 \\mid A_1=0,A_2=0) = \\frac{P(A_1=0,A_2=0 \\mid L=1)P(L=1)}{P(A_1=0,A_2=0)} = \\frac{\\frac{3}{100}}{\\frac{39}{100}} = \\frac{3}{39} = \\frac{1}{13}\n$$\n所以，$P(L=0 \\mid A_1=0,A_2=0) = 1 - \\frac{1}{13} = \\frac{12}{13}$。\n\n代入这些值：\n$$\nE(Y \\mid A_1=0, A_2=0) = \\left(\\frac{3}{10}\\right)\\left(\\frac{1}{13}\\right) + \\left(\\frac{1}{10}\\right)\\left(\\frac{12}{13}\\right) = \\frac{3}{130} + \\frac{12}{130} = \\frac{15}{130} = \\frac{3}{26}\n$$\n\n**3. 计算偏倚**\n\n错误估计量的值是：\n$$\nE(Y \\mid A_1=1) - E(Y \\mid A_1=0, A_2=0) = \\frac{13}{25} - \\frac{3}{26} = \\frac{13 \\times 26 - 3 \\times 25}{25 \\times 26} = \\frac{338 - 75}{650} = \\frac{263}{650}\n$$\n偏倚是这个值与真实ATE之间的差异：\n$$\n\\text{偏倚} = \\frac{263}{650} - \\text{ATE} = \\frac{263}{650} - \\frac{1}{5}\n$$\n为了相减，我们找到一个公分母：$\\frac{1}{5} = \\frac{1 \\times 130}{5 \\times 130} = \\frac{130}{650}$。\n$$\n\\text{偏倚} = \\frac{263}{650} - \\frac{130}{650} = \\frac{133}{650}\n$$\n分数 $\\frac{133}{650}$ 是最简形式，因为 $133$ 的质因数是 $7$ 和 $19$，而 $650=2 \\times 5^2 \\times 13$ 的质因数不包括 $7$ 或 $19$。",
            "answer": "$$\n\\boxed{\\frac{133}{650}}\n$$"
        },
        {
            "introduction": "在了解了偏倚是如何轻易被引入之后，我们转向一种评估和改善可比性的有效方法：倾向性评分。这最后一个练习模拟了现代流行病学中的一个常见情景，您必须诊断暴露组和非暴露组之间缺乏“重叠”的问题。您将学习如何解读倾向性评分的分布，应用有原则的“修剪”规则以确保组间的可比性，并理解这一操作对您能回答的研究问题所带来的重要影响。",
            "id": "4635182",
            "problem": "一项队列研究评估了一项二元干预 $A$（暴露与未暴露）对一个二元结局 $Y$ 的因果效应，其中混杂因素通过倾向性得分 $e(X) = P(A=1 \\mid X)$ 进行控制，而 $X$ 表示测量的基线协变量。在施加任何限制之前，我们感兴趣的因果估计量是平均处理效应（ATE），定义为 $E[Y^1 - Y^0]$，其中 $Y^1$ 和 $Y^0$ 分别是暴露和不暴露下的潜在结局。使用基于倾向性得分的方法来识别 ATE 需要满足正性（重叠）假设：对于所有具有正密度的协变量值 $x$，$0 < P(A=1 \\mid X=x) < 1$（等价于 $0 < e(x) < 1$）。\n\n你对 $A$ 和 $X$ 拟合了一个逻辑斯蒂回归模型来估计 $e(X)$，然后按暴露状态检查 $e(X)$ 的经验支撑集。得到以下摘要：\n\n- 在暴露组（$A=1$）中：观测到的 $e(X)$ 值范围为 $0.22$ 到 $0.96$，其中 $15\\%$ 的暴露者 $e(X) < 0.30$，$70\\%$ 在 $0.30$ 和 $0.80$ 之间， $15\\%$ 高于 $0.80$。\n- 在未暴露组（$A=0$）中：观测到的 $e(X)$ 值范围为 $0.03$ 到 $0.62$，其中 $40\\%$ 的未暴露者 $e(X) < 0.20$，$55\\%$ 在 $0.20$ 和 $0.60$ 之间， $5\\%$ 高于 $0.60$。\n\n假设样本量很大且 $e(X)$ 被正确设定。你希望通过检查倾向性得分的支撑集来诊断实际的正性违背情况，并提出一个有原则的修剪规则以确保因果估计有充分的重叠。你还必须说明在实施你提出的修剪后，余下的因果估计量是什么。\n\n哪个选项能最好地诊断重叠情况，提出适当的修剪规则，并正确地说明余下的估计量？\n\nA. 对于低于 $0.22$ 和高于 $0.62$ 的 $e(X)$ 值，实际正性假设被违背，因为其中一个暴露组在那里基本上没有支撑。修剪至支撑集的交集，$e(X) \\in [0.22, 0.62]$。余下的估计量是 $E[Y^1 - Y^0 \\mid e(X) \\in [0.22, 0.62]]$，即修剪后人群中的 ATE（公共支撑区域）。\n\nB. 在低和高 $e(X)$ 值处，实际正性均被违背，但修剪是不必要的；相反，保留所有 $e(X) \\in [0.03, 0.96]$（支撑集的并集）的观测值，并使用逆概率加权来估计原始的 ATE。余下的估计量是针对完整人群的 $E[Y^1 - Y^0]$。\n\nC. 不存在实际的正性问题，因为暴露组之间存在一些重叠。不要修剪；使用未稳定的逆概率权重。余下的估计量是 $E[Y^1 - Y^0]$。\n\nD. 在高密度区域之外，重叠情况不佳；为提高精确度，积极地修剪至 $e(X) \\in [0.30, 0.60]$。余下的估计量是受处理组的平均处理效应（ATT），即 $E[Y^1 - Y^0 \\mid A=1]$。\n\nE. 在极端的 $e(X)$ 值处，重叠不充分；修剪至 $e(X) \\in [0.22, 0.60]$，因为高于 $0.60$ 的未暴露单位很罕见。余下的估计量是 $E[Y^1 - Y^0 \\mid e(X) \\in [0.22, 0.60]]$，即修剪后人群中的 ATE。",
            "solution": "用户需要对一个关于倾向性得分分析中正性假设的因果推断问题进行批判性评估。\n\n### 第1步：提取已知条件\n\n- **因果模型：** 一项队列研究，包含一个二元干预 $A$（$1$ 为暴露，$0$ 为未暴露）、一个二元结局 $Y$ 和一组测量的基线协变量 $X$。\n- **倾向性得分（PS）：** 在给定协变量下暴露的概率，$e(X) = P(A=1 \\mid X)$。\n- **初始估计量：** 平均处理效应（ATE），$E[Y^1 - Y^0]$。\n- **识别假设（正性）：** 对于所有具有正概率密度的协变量分布 $x$，$0 < e(x) < 1$。\n- **经验数据（估计的PS）：** 使用逻辑斯蒂回归模型来估计 $e(X)$。研究假设样本量大且 $e(X)$ 的模型设定正确。\n- **暴露组（$A=1$）的 $\\hat{e}(X)$ 支撑集：**\n    - 范围：$[0.22, 0.96]$。\n    - 分布：$15\\%$ 的暴露者 $\\hat{e}(X) < 0.30$，$70\\%$ 的暴露者 $\\hat{e}(X) \\in [0.30, 0.80]$，以及 $15\\%$ 的暴露者 $\\hat{e}(X) > 0.80$。\n- **未暴露组（$A=0$）的 $\\hat{e}(X)$ 支撑集：**\n    - 范围：$[0.03, 0.62]$。\n    - 分布：$40\\%$ 的未暴露者 $\\hat{e}(X) < 0.20$，$55\\%$ 的未暴露者 $\\hat{e}(X) \\in [0.20, 0.60]$，以及 $5\\%$ 的未暴露者 $\\hat{e}(X) > 0.60$。\n- **目标：** 诊断实际的正性违背情况，提出一个有原则的修剪规则，并说明由此产生的因果估计量。\n\n### 第2步：使用提取的已知条件进行验证\n\n问题陈述具有科学依据，表述清晰且客观。它描述了在使用倾向性得分的应用因果推断中一个经典而现实的场景。\n\n1.  **科学合理性：** 所呈现的概念——ATE、潜在结局、倾向性得分、正性假设和修剪——是流行病学及相关领域中现代因果推断方法论的基础。其逻辑是严谨的。\n2.  **表述清晰性：** 该问题提供了关于估计的倾向性得分的经验分布的充分量化信息，从而可以对重叠问题进行明确诊断。问题要求一组可以从所提供数据中得出的具体交付成果（诊断、规则、估计量）。\n3.  **客观性：** 问题以精确的、量化的术语陈述，没有主观性语言。关于倾向性得分分布的数据清晰明确。\n4.  **一致性：** 所提供的倾向性得分分布的范围和百分比在内部是一致的，不包含矛盾。\n5.  **相关性：** 该问题直接涉及基于协变量分布选择暴露组和未暴露组，这是流行病学的一个核心主题。\n\n### 第3步：结论和行动\n\n该问题是**有效的**。将根据因果推断的原则，通过分析所提供的数据来推导解决方案。\n\n### 解决方案的推导\n\n正性假设，也称为重叠或公共支撑条件，要求对于倾向性得分 $e(X)$ 的任何给定值，都存在非零概率观测到暴露（$A=1$）和未暴露（$A=0$）的个体。在实践中，这意味着在用于估计的整个倾向性得分范围内，我们必须有来自两个暴露组的研究对象。\n\n1.  **诊断正性违背：**\n    我们得到了每个暴露组估计的倾向性得分 $\\hat{e}(X)$ 的经验支撑集（范围）：\n    - 暴露组（$A=1$）的支撑集：$S_1 = [0.22, 0.96]$\n    - 未暴露组（$A=0$）的支撑集：$S_0 = [0.03, 0.62]$\n\n    为了使因果效应在一个由 $\\hat{e}(X) = e$ 定义的给定子人群中可被识别，我们必须在该子人群中同时拥有来自两个组别的研究对象。满足此条件的区域是*公共支撑集*，即各个支撑集的交集：\n    $$ S_{\\text{common}} = S_1 \\cap S_0 $$\n    $$ S_{\\text{common}} = [0.22, 0.96] \\cap [0.03, 0.62] $$\n    两个闭区间 $[a, b]$ 和 $[c, d]$ 的交集是 $[\\max(a, c), \\min(b, d)]$。\n    $$ S_{\\text{common}} = [\\max(0.22, 0.03), \\min(0.96, 0.62)] = [0.22, 0.62] $$\n    在此区间之外，正性假设在经验上被违背：\n    - 在范围 $\\hat{e}(X) \\in [0.03, 0.22)$ 内，有未暴露的研究对象，但没有暴露的研究对象。\n    - 在范围 $\\hat{e}(X) \\in (0.62, 0.96]$ 内，有暴露的研究对象，但没有未暴露的研究对象。\n    在这些非重叠区域，无法估计因果效应，因为没有反事实组中的个体可供比较。例如，一个 $\\hat{e}(X) = 0.80$ 的暴露研究对象没有具有相似倾向性得分的未暴露对应者。像逆概率加权（IPW）这样的方法在这些区域会变得不稳定和无效，因为当分母趋近于零时，权重 $1/\\hat{e}(X)$ 或 $1/(1-\\hat{e}(X))$ 会变得极大。\n\n2.  **提出有原则的修剪规则：**\n    处理这种缺乏重叠情况的一个有原则且标准的方法是，将分析限制在公共支撑区域内的人群。这被称为*修剪*。基于非重叠诊断的最直接的修剪规则是，丢弃所有倾向性得分在公共支撑区域之外的个体。\n    - 建议的修剪规则：将分析限制在 $\\hat{e}(X) \\in [0.22, 0.62]$ 的个体。\n\n3.  **说明余下的估计量：**\n    最初的目标是估计整个人群的 ATE，即 $E[Y^{1} - Y^{0}]$。通过修剪样本，我们明确地改变了推断的目标人群。我们不再对整个原始人群做出陈述，而只对那些其特征（由 $X$ 总结）与暴露和非暴露都兼容的子人群做出陈述。这个新的、修剪后的人群的估计量是在该人群中的条件性 ATE。\n    - 余下的估计量：$E[Y^{1} - Y^{0} \\mid \\hat{e}(X) \\in [0.22, 0.62]]$。这是“修剪后人群中的 ATE”或“公共支撑区域中的 ATE”。\n\n### 逐项分析选项\n\n**A. 对于低于 $0.22$ 和高于 $0.62$ 的 $e(X)$ 值，实际正性假设被违背，因为其中一个暴露组在那里基本上没有支撑。修剪至支撑集的交集，$e(X) \\in [0.22, 0.62]$。余下的估计量是 $E[Y^{1} - Y^{0} \\mid e(X) \\in [0.22, 0.62]]$，即修剪后人群中的 ATE（公共支撑区域）。**\n- 该选项正确地识别了非重叠区域（低于 $0.22$ 和高于 $0.62$）。它基于经验支撑集的交集，提出了正确且有原则的修剪规则。它还正确地将所得估计量确定为由修剪规则定义的修剪后子人群中的 ATE。\n- **结论：正确。**\n\n**B. 在低和高 $e(X)$ 值处，实际正性均被违背，但修剪是不必要的；相反，保留所有 $e(X) \\in [0.03, 0.96]$（支撑集的并集）的观测值，并使用逆概率加权来估计原始的 ATE。余下的估计量是针对完整人群的 $E[Y^{1} - Y^{0}]$。**\n- 该选项正确地指出了违背情况，但提出了一个错误的解决方案。试图在支撑集的*并集*（$[0.03, 0.96]$）上估计 ATE，恰恰是正性违背导致像 IPW 这样的估计器因极端权重和缺乏反事实而失效的地方。在这种条件下，无法可靠地估计原始的 ATE。\n- **结论：不正确。**\n\n**C. 不存在实际的正性问题，因为暴露组之间存在一些重叠。不要修剪；使用未稳定的逆概率权重。余下的估计量是 $E[Y^{1} - Y^{0}]$。**\n- 该选项错误地声称不存在实际的正性问题。完全非重叠区域（$[0.03, 0.22)$ 和 $(0.62, 0.96]$）的存在本身就是实际正性违背的定义。忽略这一点而不进行修剪，在方法论上是不健全的。\n- **结论：不正确。**\n\n**D. 在高密度区域之外，重叠情况不佳；为提高精确度，积极地修剪至 $e(X) \\in [0.30, 0.60]$。余下的估计量是受处理组的平均处理效应（ATT），即 $E[Y^{1} - Y^{0} \\mid A=1]$。**\n- 虽然积极地修剪到高密度区域是一种可能的减少方差的策略，但该选项在识别余下估计量时犯了一个关键错误。基于倾向性得分 $e(X)$ 的修剪定义了一个基于协变量 $X$ 的子人群，而不是基于处理状态 $A$。由此产生的估计量是该协变量定义的子人群的 ATE，而不是受处理组的平均处理效应（ATT），即 $E[Y^{1} - Y^{0} \\mid A=1]$。ATT 的目标人群不同（所有接受了处理的个体）。\n- **结论：不正确。**\n\n**E. 在极端的 $e(X)$ 值处，重叠不充分；修剪至 $e(X) \\in [0.22, 0.60]$，因为高于 $0.60$ 的未暴露单位很罕见。余下的估计量是 $E[Y^{1} - Y^{0} \\mid e(X) \\in [0.22, 0.60]]$，即修剪后人群中的 ATE。**\n- 该选项提出了一个 $[0.22, 0.60]$ 的修剪规则。这是公共支撑区域 $[0.22, 0.62]$ 的一个子集。其理由（在 $0.60$ 和 $0.62$ 之间未暴露单位的稀有性）是提高估计器精确度的一个貌似合理的启发式方法。然而，*确保重叠*的最有原则和最直接的规则是修剪到完整的公共支撑区域。选项 A 的规则 $[0.22, 0.62]$ 是对非重叠问题的直接和完整的答案。选项 E 的规则略显武断，不如选项 A 的规则根本。因此，A 是更优的选择，因为它根据已知条件精确地定义了公共支撑的边界。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}