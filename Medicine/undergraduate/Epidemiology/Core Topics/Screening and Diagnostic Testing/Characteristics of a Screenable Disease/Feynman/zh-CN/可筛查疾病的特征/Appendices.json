{
    "hands_on_practices": [
        {
            "introduction": "一项筛查测试的效用并不仅仅取决于其固有的灵敏度和特异度。阳性预测值（PPV）——即一个阳性结果真正为阳性的概率——在很大程度上依赖于被测人群中的疾病患病率。这个练习  将通过定量计算，向你展示针对高风险人群（这是公共卫生领域的关键策略）如何能让一个好的测试在实践中变得更加有效。",
            "id": "4577361",
            "problem": "考虑对一种疾病进行人群筛查。一种可筛查疾病的关键特征是它有一个可检测的临床前期，在此期间，检测可以在症状出现前识别病例，而筛查的有效性取决于检测在目标人群中的阳性预测值 (PPV)。已知该检测的灵敏度和特异度在不同人群中是恒定的，但患病率随风险分层而变化。\n\n在普通人群中，该疾病的患病率为 $0.03$。在由风险因素（例如，年龄和家族史）定义的高风险层中，患病率翻倍至 $0.06$。该筛查检测的灵敏度为 $0.92$，特异度为 $0.96$。\n\n使用贝叶斯定理，并且仅使用灵敏度、特异度和患病率的基本定义，推导出阳性预测值作为患病率函数的表达式。然后，在患病率翻倍但灵敏度和特异度不变的情况下，计算高风险层与普通人群中阳性预测值的比率 $R$。\n\n将你的答案 $R$ 四舍五入到 $4$ 位有效数字。最终答案以小数形式表示（不带百分号）。",
            "solution": "### 阳性预测值 (PPV) 的推导\n\n设 $D$ 为个体患病的事件，$D^c$ 为个体未患病的事件。设 $T^+$ 为检测结果为阳性的事件。患病率 $P_{prev}$ 是患病的先验概率，即 $P(D)$。因此，$P(D^c) = 1 - P(D) = 1 - P_{prev}$。\n\n检测的灵敏度 $Se$ 是在个体患病的情况下，检测结果为阳性的概率：\n$$Se = P(T^+ | D)$$\n\n检测的特异度 $Sp$ 是在个体未患病的情况下，检测结果为阴性的概率：\n$$Sp = P(T^- | D^c)$$\n由此，在个体未患病的情况下，检测结果为阳性的概率（即假阳性率）为：\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$$\n\n阳性预测值 $PPV$ 是在检测结果为阳性的情况下，个体确实患病的概率，即 $P(D | T^+)$。使用贝叶斯定理，我们可以将其表示为：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率。它可以使用全概率公式计算：\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\n\n将灵敏度、特异度和患病率的定义代入此表达式，得到：\n$$P(T^+) = (Se \\cdot P_{prev}) + ((1 - Sp) \\cdot (1 - P_{prev}))$$\n\n现在，将 $P(T^+)$ 的这个表达式代回 $PPV$ 的贝叶斯定理公式中，我们推导出 $PPV$ 作为患病率、灵敏度和特异度的函数表达式：\n$$PPV(P_{prev}, Se, Sp) = \\frac{Se \\cdot P_{prev}}{(Se \\cdot P_{prev}) + (1 - Sp)(1 - P_{prev})}$$\n这完成了任务的第一部分。\n\n### 比率 R 的计算\n\n接下来，我们使用给定的值计算普通人群的 $PPV$ ($PPV_{gen}$) 和高风险层的 $PPV$ ($PPV_{high}$)：\n-   $P_{gen} = 0.03$\n-   $P_{high} = 0.06$\n-   $Se = 0.92$\n-   $Sp = 0.96 \\implies 1 - Sp = 1 - 0.96 = 0.04$\n\n对于普通人群：\n$$PPV_{gen} = \\frac{0.92 \\cdot 0.03}{(0.92 \\cdot 0.03) + (0.04)(1 - 0.03)}$$\n$$PPV_{gen} = \\frac{0.0276}{0.0276 + (0.04)(0.97)}$$\n$$PPV_{gen} = \\frac{0.0276}{0.0276 + 0.0388}$$\n$$PPV_{gen} = \\frac{0.0276}{0.0664}$$\n\n对于高风险层：\n$$PPV_{high} = \\frac{0.92 \\cdot 0.06}{(0.92 \\cdot 0.06) + (0.04)(1 - 0.06)}$$\n$$PPV_{high} = \\frac{0.0552}{0.0552 + (0.04)(0.94)}$$\n$$PPV_{high} = \\frac{0.0552}{0.0552 + 0.0376}$$\n$$PPV_{high} = \\frac{0.0552}{0.0928}$$\n\n比率 $R$ 定义为 $R = \\frac{PPV_{high}}{PPV_{gen}}$：\n$$R = \\frac{\\frac{0.0552}{0.0928}}{\\frac{0.0276}{0.0664}}$$\n我们可以注意到 $PPV_{high}$ 的分子 ($0.0552$) 恰好是 $PPV_{gen}$ 的分子 ($0.0276$) 的两倍，因为 $P_{high} = 2 \\cdot P_{gen}$，从而简化此表达式。\n$$R = 2 \\cdot \\frac{0.0664}{0.0928}$$\n$$R = \\frac{0.1328}{0.0928} \\approx 1.43093023...$$\n\n问题要求将结果四舍五入到 $4$ 位有效数字。前四位有效数字是 $1$、$4$、$3$ 和 $0$。第五位有效数字是 $9$，大于或等于 $5$，所以我们将第四位有效数字向上舍入。\n$$R \\approx 1.431$$",
            "answer": "$$ \\boxed{1.431} $$"
        },
        {
            "introduction": "在筛查诊断后观察到更长的生存期，并不自动意味着筛查正在挽救生命。这种现象可能由“领先时间偏倚”造成，即仅仅因为诊断提前，而使得生存期看起来被人为地延长了。本练习  将帮助你从第一性原理出发，剖析并量化这种偏倚，从而让你掌握评估筛查研究有效性的一个批判性思维工具。",
            "id": "4577406",
            "problem": "在一个患有存在可检测临床前期的疾病的人群中，假设单个病例的事件时间线如下：生物学发病发生在时间 $0$，临床诊断（在没有筛查的情况下）发生在发病后 $S > 0$ 时间，死亡发生在发病后 $T > 0$ 时间。现实施一个筛查项目，该项目将诊断时间提前了一个领先时间 $L \\in (0, S)$，但并不改变死亡时间（也就是说，治疗对死亡率没有影响；仅仅是诊断提前了）。观测到的诊断后生存期被定义为从诊断到死亡的时间间隔。\n\n请仅使用生存时间和领先时间的核心定义，且不假设任何特殊的参数分布，推导出筛查情况下的观测诊断后生存期，并将其表示为 $L$、$S$ 和 $T$ 的函数，然后与无筛查情况下的观测诊断后生存期进行比较。接着，从第一性原理出发，推导在引入筛查后，一个非对照前后比较（UBA）会报告的平均观测诊断后生存期的乘法变化量，已知真实死亡时间不受筛查影响。\n\n最后，考虑一个科学上合理的情景：从生物学发病到死亡的平均真实生存期为 $\\mathbb{E}[T] = 10$ 年，无筛查情况下从发病到临床诊断的平均时间为 $\\mathbb{E}[S] = 4$ 年，且筛查项目将诊断时间提前了一个恒定的领先时间 $L = 1.5$ 年。在上述假设下，计算引入筛查后UBA报告的平均观测诊断后生存期的乘法变化量。将您的最终答案四舍五入至四位有效数字，并将其表示为一个无量纲的小数因子。",
            "solution": "### 求解推导\n\n让我们根据问题陈述来定义相关的时间间隔。参考点是生物学发病时间，记为 $t=0$。\n\n首先，我们考虑没有筛查项目的情况。\n诊断时间为 $S$。\n死亡时间为 $T$。\n观测到的诊断后生存期，我们记为 $U_{no\\_screen}$，是从诊断到死亡的持续时间。\n因此，\n$$U_{no\\_screen} = T - S$$\n为使该生存时间具有实际意义（即为正值），这隐含了 $T > S$。\n\n接下来，我们考虑有筛查项目的情况。\n筛查项目将诊断时间提前了一个领先时间 $L$。原始诊断时间为 $S$，因此新的、更早的诊断时间为 $S - L$。\n问题陈述指出筛查不改变死亡时间，因此死亡时间仍为 $T$。\n筛查情况下的观测诊断后生存期，我们记为 $U_{screen}$，是从新的诊断时间到死亡的持续时间。\n因此，\n$$U_{screen} = T - (S - L) = T - S + L$$\n\n比较这两个观测生存时间，我们可以用 $U_{no\\_screen}$ 来表示 $U_{screen}$：\n$$U_{screen} = (T - S) + L = U_{no\\_screen} + L$$\n这个方程表明，观测到的诊断后生存时间被人为地增加了，增加量恰好等于领先时间 $L$。这种现象被称为领先时间偏倚。患者的实际生存时间并没有延长（因为 $T$ 不变），但仅仅因为诊断时间提前，他们看起来在诊断后生存得更长。\n\n问题接着要求计算非对照前后比较（UBA）会报告的*平均*观测诊断后生存期的乘法变化量。这对应于筛查后平均观测生存期与筛查前平均观测生存期的比率。\n\n无筛查情况下的平均观测诊断后生存期是 $U_{no\\_screen}$ 的期望值：\n$$\\mathbb{E}[U_{no\\_screen}] = \\mathbb{E}[T - S]$$\n根据期望算子的线性性质，我们有：\n$$\\mathbb{E}[U_{no\\_screen}] = \\mathbb{E}[T] - \\mathbb{E}[S]$$\n\n有筛查情况下的平均观测诊断后生存期是 $U_{screen}$ 的期望值：\n$$\\mathbb{E}[U_{screen}] = \\mathbb{E}[T - S + L]$$\n再次利用期望的线性性质：\n$$\\mathbb{E}[U_{screen}] = \\mathbb{E}[T] - \\mathbb{E}[S] + \\mathbb{E}[L]$$\n问题陈述指出领先时间 $L$ 是一个常数，因此其期望就是 $L$ 本身，即 $\\mathbb{E}[L] = L$。因此，\n$$\\mathbb{E}[U_{screen}] = \\mathbb{E}[T] - \\mathbb{E}[S] + L$$\n\n乘法变化量，我们记为 $R$，是这两个平均值的比率：\n$$R = \\frac{\\mathbb{E}[U_{screen}]}{\\mathbb{E}[U_{no\\_screen}]} = \\frac{\\mathbb{E}[T] - \\mathbb{E}[S] + L}{\\mathbb{E}[T] - \\mathbb{E}[S]}$$\n\n最后，我们针对给定情景计算该因子的数值。所提供的值是：\n$\\mathbb{E}[T] = 10$ 年\n$\\mathbb{E}[S] = 4$ 年\n$L = 1.5$ 年\n\n将这些值代入推导出的 $R$ 的表达式中：\n$$R = \\frac{10 - 4 + 1.5}{10 - 4}$$\n首先，我们计算分母，即无筛查情况下的平均诊断后生存期：\n$$\\mathbb{E}[U_{no\\_screen}] = 10 - 4 = 6 \\text{ 年}$$\n接着，我们计算分子，即有筛查情况下的平均诊断后生存期：\n$$\\mathbb{E}[U_{screen}] = 6 + 1.5 = 7.5 \\text{ 年}$$\n乘法变化量是该比率：\n$$R = \\frac{7.5}{6} = 1.25$$\n问题要求答案四舍五入至四位有效数字。精确值 $1.25$ 可以通过在末尾补零来表示为四位有效数字。\n$$R = 1.250$$\n这一结果表明，UBA比较会错误地得出结论，认为筛查项目将平均诊断后生存期提高了 $1.25$ 倍，即增加了 $25\\%$。这整个表观上的益处是领先时间偏倚造成的人为结果，因为从生物学发病开始的真实生存时间（$T$）并未受该项目影响。",
            "answer": "$$\\boxed{1.250}$$"
        },
        {
            "introduction": "一个成功的筛查项目，其带来的益处必须明确大于其造成的伤害。这项综合性练习  将指导你进行一次定量的伤害-获益分析，它整合了测试性能、疾病进展、依从性和治疗效果等多个现实世界中的因素。通过计算并比较预期避免的死亡人数与筛查过程中的潜在伤害（如活检并发症和假阳性结果），你将能够对一个筛查项目的整体净影响做出全面评估。",
            "id": "4577312",
            "problem": "一个卫生系统正在评估一种具有较长临床前可检测期和有效早期治疗方法的疾病，是否在一个由 $N = 1{,}000$ 名年龄在 $55$–$74$ 岁之间的成年人组成的队列中，符合可筛查疾病的特征。该筛查测试的灵敏度为 $Se = 0.92$，特异性为 $Sp = 0.94$。该队列在未来一年内的疾病患病率为 $p = 0.015$。所有筛查测试结果为阳性的个体都会被建议进行确认性活检；筛查结果为阳性者接受活检的概率为 $b = 0.85$。活检导致严重并发症的概率为 $c_{m} = 0.007$，且假定该概率与是否患病无关。对于患有该疾病的人，（在没有筛查的情况下）通过临床检测发现将伴随 $5$ 年的疾病特异性死亡率 $m_{c} = 0.35$。与临床检测相比，通过筛查早期发现并随后进行治疗，可使疾病特异性死亡率实现 $RRR = 0.30$ 的相对风险降低（RRR）。在筛查结果为真阳性并接受了活检的个体中，依从并完成有效治疗的概率为 $t = 0.90$。\n\n假设如下：\n- 灵敏度 $Se$ 是指在患病情况下测试结果为阳性的概率，特异性 $Sp$ 是指在未患病情况下测试结果为阴性的概率。\n- 每个阳性筛查结果独立地以概率 $b$ 导致进行活检。\n- 一次严重的活检并发症计为一次伤害事件。\n- 一次假阳性活检（在未患病者身上进行的活检）计为一次伤害事件。\n- 当一名患病者通过筛查被早期发现、接受活检、完成有效治疗，并经历了由相对风险降低所带来的绝对死亡率下降时，即为一次避免的死亡。\n\n使用这些假设和仅提供的数据，计算每筛查 $1{,}000$ 人的伤害-效益比，该比率定义为预期伤害事件数除以预期避免的死亡人数。最终答案以纯数字形式表示，不带单位。将您的答案四舍五入至三位有效数字。",
            "solution": "目标是计算在一个由 $N = 1,000$ 名个体组成的队列中，某筛查项目的伤害-效益比。该比率定义为预期伤害事件数除以预期避免的死亡人数。\n\n首先，我们确定基线人群计数。\n- 队列总人数：$N = 1,000$。\n- 疾病患病率：$p = 0.015$。\n- 患病（D+）个体数量：$N_D = N \\times p = 1,000 \\times 0.015 = 15$。\n- 未患病（D-）个体数量：$N_{\\neg D} = N \\times (1-p) = 1,000 \\times (1-0.015) = 985$。\n\n计算分为两部分：预期效益（分母）和预期伤害（分子）。\n\n**1. 计算预期避免的死亡人数（效益）**\n\n如果一个患病个体成功地完成了筛查和治疗的全过程，并经历了相应的死亡率降低，那么就算避免了一次死亡。这构成了一个事件链：\n\n- 该个体必须患有该疾病：$N_D = 15$。\n- 该个体必须测试呈阳性。这些是真阳性（$N_{TP}$）。其数量由测试的灵敏度（$Se = 0.92$）决定。\n$$N_{TP} = N_D \\times Se = 15 \\times 0.92 = 13.8$$\n- 该个体在阳性测试后必须接受活检。此概率为 $b = 0.85$。\n$$N_{\\text{TP, biopsy}} = N_{TP} \\times b = 13.8 \\times 0.85 = 11.73$$\n- 该个体必须依从并完成治疗。此概率为 $t = 0.90$。\n$$N_{\\text{treated}} = N_{\\text{TP, biopsy}} \\times t = 11.73 \\times 0.90 = 10.557$$\n这就得出了有资格从筛查中获益的预期个体数量。\n\n效益本身是死亡率的绝对风险降低（$ARR$）。\n- 临床检测下的死亡率：$m_c = 0.35$。\n- 早期治疗带来的相对风险降低：$RRR = 0.30$。\n- $ARR$ 是死亡风险的绝对差异：\n$$ARR = m_c \\times RRR = 0.35 \\times 0.30 = 0.105$$\n预期避免的死亡人数 $B_{exp}$ 是成功治疗的个体数量与每个个体的 $ARR$ 的乘积。\n$$B_{exp} = N_{\\text{treated}} \\times ARR = 10.557 \\times 0.105 = 1.108485$$\n\n用符号表示，预期效益为：\n$$B_{exp} = (N \\cdot p \\cdot Se \\cdot b \\cdot t) \\times (m_c \\cdot RRR)$$\n\n**2. 计算预期伤害事件数（伤害）**\n\n伤害事件由两个部分定义：严重的活检并发症和假阳性活检。问题陈述中指出，每种情况都计为一次伤害事件。根据此措辞，我们将伤害事件总数解释为这两种事件类型发生次数的总和。\n$$H_{exp} = E[\\text{major complications}] + E[\\text{false positive biopsies}]$$\n\n- **来自假阳性活检的伤害：** 假阳性活检定义为在未患病者身上进行的活检。首先，我们使用特异性 $Sp = 0.94$ 计算假阳性筛查测试的数量（$N_{FP}$）。\n$$N_{FP} = N_{\\neg D} \\times (1 - Sp) = 985 \\times (1 - 0.94) = 985 \\times 0.06 = 59.1$$\n这些无疾病个体中预期进行的活检数量为：\n$$E[\\text{false positive biopsies}] = N_{FP} \\times b = 59.1 \\times 0.85 = 50.235$$\n\n- **来自严重活检并发症的伤害：** 任何接受活检的个体都可能出现并发症，无论其是否患病。我们首先需要计算总的活检数量。\n总阳性测试数：$N_{\\text{test+}} = N_{TP} + N_{FP} = 13.8 + 59.1 = 72.9$。\n总活检数：$N_{\\text{biopsy}} = N_{\\text{test+}} \\times b = 72.9 \\times 0.85 = 61.965$。\n活检导致严重并发症的概率为 $c_m = 0.007$。\n预期严重并发症的数量为：\n$$E[\\text{major complications}] = N_{\\text{biopsy}} \\times c_m = 61.965 \\times 0.007 = 0.433755$$\n\n- **预期伤害事件总数：**\n预期伤害事件总数 $H_{exp}$ 是这两个部分的总和。\n$$H_{exp} = 50.235 + 0.433755 = 50.668755$$\n\n用符号表示，预期伤害为：\n$$H_{exp} = [N(1-p)(1-Sp)b] + [N(p \\cdot Se + (1-p)(1-Sp))b \\cdot c_m]$$\n\n**3. 计算伤害-效益比**\n\n该比率是一个无量纲的量，计算如下：\n$$\\text{Ratio} = \\frac{H_{exp}}{B_{exp}} = \\frac{50.668755}{1.108485} \\approx 45.7143$$\n\n问题要求将最终答案四舍五入至三位有效数字。\n$$\\text{Ratio} \\approx 45.7$$\n这表明，该筛查项目每避免一次死亡，估计会发生 $45.7$ 次伤害事件。",
            "answer": "$$\\boxed{45.7}$$"
        }
    ]
}