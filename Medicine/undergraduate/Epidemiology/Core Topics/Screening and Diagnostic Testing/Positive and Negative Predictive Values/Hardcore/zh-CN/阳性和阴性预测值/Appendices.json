{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在奠定基础。它要求学生从条件概率的基本定义出发，使用给定的检验灵敏度、特异度和人群中的疾病患病率，来推导阳性预测值 ($PPV$) 和阴性预测值 ($NPV$)。这项练习旨在强化核心的数学关系，并展示如何根据标准的检验性能数据计算这些关键指标。",
            "id": "4332248",
            "problem": "一家医院正在评估一种新的血浆 microRNA 检测方法，该方法用于在人群筛查中区分恶性上皮性肿瘤与良性病变。在一个代表普通筛查人群的无症状队列中，恶性上皮性肿瘤的患病率为 $\\;0.05\\;$。据报道，该检测方法的灵敏度为 $\\;0.90\\;$，特异性为 $\\;0.95\\;$。从基于条件概率的核心定义出发，并且不使用任何预先记忆的公式，完成以下任务：\n\n1. 以疾病存在事件和检测结果为基础，用文字定义灵敏度、特异性、阳性预测值 (PPV) 和阴性预测值 (NPV)。\n\n2. 仅使用这些定义和适用于病理学中诊断性检测的基本概率法则，推导该检测方法在该队列中的 PPV 和 NPV 的表达式，并根据给定的灵敏度、特异性和患病率计算它们的数值。\n\n将最终的 PPV 和 NPV 数值以小数形式表示，四舍五入到四位有效数字，并且在答案中不要使用百分号。",
            "solution": "该问题是有效的，因为它在科学上基于生物统计学和流行病学的原理，问题提法得当，具有足够的数据以获得唯一解，并且以清晰、客观的术语陈述。\n\n让我们定义以下事件：\n- $D$: 队列中的个体患有恶性上皮性肿瘤（该疾病）的事件。\n- $D^c$: 个体未患该疾病的事件。\n- $T^+$: microRNA 检测得出阳性结果的事件。\n- $T^-$: microRNA 检测得出阴性结果的事件。\n\n根据问题陈述，我们得到以下概率：\n- 疾病的患病率为 $P(D) = 0.05$。\n- 未患该疾病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.05 = 0.95$。\n- 检测的灵敏度为 $0.90$。\n- 检测的特异性为 $0.95$。\n\n**1. 定义**\n\n基于条件概率的原理，我们可以将关键术语定义如下：\n\n- **灵敏度**：灵敏度是指在被检测个体确实患有该疾病的情况下，检测将得出阳性结果的概率。它衡量了检测正确识别患病个体的能力。用概率术语来说，它是指在疾病存在($D$)的条件下，检测结果为阳性($T^+$)的条件概率：\n$$ \\text{灵敏度} = P(T^+ | D) $$\n\n- **特异性**：特异性是指在被检测个体确实未患该疾病的情况下，检测将得出阴性结果的概率。它衡量了检测正确识别未患病个体的能力。用概率术语来说，它是指在疾病不存在($D^c$)的条件下，检测结果为阴性($T^-$)的条件概率：\n$$ \\text{特异性} = P(T^- | D^c) $$\n\n- **阳性预测值 (PPV)**：阳性预测值是指检测结果为阳性的个体确实患有该疾病的概率。它量化了在得出阳性结果后，患病的后验概率。用概率术语来说，它是指在检测结果为阳性($T^+$)的条件下，疾病存在($D$)的条件概率：\n$$ \\text{PPV} = P(D | T^+) $$\n\n- **阴性预测值 (NPV)**：阴性预测值是指检测结果为阴性的个体确实未患该疾病的概率。它量化了在得出阴性结果后，未患病的后验概率。用概率术语来说，它是指在检测结果为阴性($T^-$)的条件下，疾病不存在($D^c$)的条件概率：\n$$ \\text{NPV} = P(D^c | T^-) $$\n\n**2. PPV 和 NPV 的推导与计算**\n\n我们将使用条件概率的基本定义 $P(A|B) = \\frac{P(A \\cap B)}{P(B)}$ 和全概率公式来推导 PPV 和 NPV 的表达式。\n\n**阳性预测值 (PPV) 的推导：**\nPPV 定义为 $P(D | T^+)$。使用条件概率的定义：\n$$ \\text{PPV} = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)} $$\n分子 $P(D \\cap T^+)$ 是患病且检测为阳性（真阳性）的联合概率。我们可以将其表示为 $P(D \\cap T^+) = P(T^+ | D) P(D)$。\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率。阳性结果可能发生在两种互斥的情况下：真阳性 ($D \\cap T^+$) 或假阳性 ($D^c \\cap T^+$)。使用全概率公式：\n$$ P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c) $$\n$$ P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c) $$\n给定灵敏度 $P(T^+ | D) = 0.90$。我们需要 $P(T^+ | D^c)$，即未患病但检测为阳性的概率。这与特异性 $P(T^- | D^c) = 0.95$ 有关。由于未患病的个体检测结果只能是阳性或阴性，我们有 $P(T^+ | D^c) + P(T^- | D^c) = 1$。因此，$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - \\text{特异性} = 1 - 0.95 = 0.05$。\n\n将这些部分代回 PPV 表达式中：\n$$ \\text{PPV} = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} $$\n现在，我们计算其数值：\n$$ \\text{PPV} = \\frac{(0.90)(0.05)}{(0.90)(0.05) + (0.05)(0.95)} = \\frac{0.045}{0.045 + 0.0475} = \\frac{0.045}{0.0925} \\approx 0.486486... $$\n四舍五入到四位有效数字，$\\text{PPV} = 0.4865$。\n\n**阴性预测值 (NPV) 的推导：**\nNPV 定义为 $P(D^c | T^-)$。使用条件概率的定义：\n$$ \\text{NPV} = P(D^c | T^-) = \\frac{P(D^c \\cap T^-)}{P(T^-)} $$\n分子 $P(D^c \\cap T^-)$ 是未患病且检测为阴性（真阴性）的联合概率。我们可以将其表示为 $P(D^c \\cap T^-) = P(T^- | D^c) P(D^c)$。\n\n分母 $P(T^-)$ 是检测结果为阴性的总概率。阴性结果可能发生在两种互斥的情况下：真阴性 ($D^c \\cap T^-$) 或假阴性 ($D \\cap T^-$)。使用全概率公式：\n$$ P(T^-) = P(T^- \\cap D^c) + P(T^- \\cap D) $$\n$$ P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D) $$\n给定特异性 $P(T^- | D^c) = 0.95$。我们需要 $P(T^- | D)$，即患病但检测为阴性的概率。这与灵敏度 $P(T^+ | D) = 0.90$ 有关。由于患病的个体检测结果只能是阳性或阴性，我们有 $P(T^- | D) + P(T^+ | D) = 1$。因此，$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\text{灵敏度} = 1 - 0.90 = 0.10$。\n\n将这些部分代回 NPV 表达式中：\n$$ \\text{NPV} = \\frac{P(T^- | D^c) P(D^c)}{P(T^- | D^c) P(D^c) + P(T^- | D) P(D)} $$\n现在，我们计算其数值：\n$$ \\text{NPV} = \\frac{(0.95)(0.95)}{(0.95)(0.95) + (0.10)(0.05)} = \\frac{0.9025}{0.9025 + 0.005} = \\frac{0.9025}{0.9075} \\approx 0.994490... $$\n四舍五入到四位有效数字，$\\text{NPV} = 0.9945$。\n\n计算出的阳性预测值为 $0.4865$，阴性预测值为 $0.9945$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.4865  0.9945 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在第一个练习的基础上，这个问题模拟了一个更真实的情景，即从一项验证性研究的原始计数数据（真阳性、假阳性等）开始。你不仅需要计算 $PPV$ 和 $NPV$，还需要计算它们的互补指标：假发现率 ($FDR$) 和假遗漏率 ($FOR$)。这项练习强调了如何处理列联表数据，并突出了这四个关键的检验后概率之间的重要关系。",
            "id": "4622628",
            "problem": "一项针对某种二分类疾病的新诊断检测在一项横断面研究中进行了评估，该研究包含 $N=8000$ 名个体，其真实患病状态已通过金标准验证。在患病个体中，$1020$ 人检测结果为阳性，$180$ 人检测结果为阴性。在未患病个体中，$680$ 人检测结果为阳性，$6120$ 人检测结果为阴性。仅使用应用于诊断测试的条件概率基本定义，根据这些计数计算阳性预测值（PPV，positive predictive value）、假发现率（FDR，false discovery rate）、阴性预测值（NPV，negative predictive value）和假遗漏率（FOR，false omission rate），并简要解释它们如何通过概率互补关系相关联。然后，使用您计算出的值，计算标量\n$$R=\\frac{\\mathrm{PPV}+\\mathrm{NPV}}{\\mathrm{FDR}+\\mathrm{FOR}}.$$\n将 $R$ 的最终值表示为单个最简分数。任何地方都不要使用百分号；根据需要将任何中间比例表示为小数或分数。您唯一需要报告的数字是 $R$ 的最终值。",
            "solution": "问题陈述已经过验证，是自洽的、有科学依据且良定的。所有必要数据均已提供，不存在内部矛盾或歧义。因此，我们可以开始求解。\n\n问题要求根据给定的计数计算几个诊断测试指标。我们可以将所提供的数据整理成一个标准的 $2 \\times 2$ 列联表。设 $D+$ 表示患病，$D-$ 表示未患病。设 $T+$ 表示阳性测试结果，$T-$ 表示阴性测试结果。\n\n已知条件如下：\n- 研究中的总个体数，$N=8000$。\n- 在患病个体中（$D+$）：\n  - 检测结果为阳性（$T+$）的人数：这是真阳性（True Positives）的计数，$TP = 1020$。\n  - 检测结果为阴性（$T-$）的人数：这是假阴性（False Negatives）的计数，$FN = 180$。\n- 在未患病个体中（$D-$）：\n  - 检测结果为阳性（$T+$）的人数：这是假阳性（False Positives）的计数，$FP = 680$。\n  - 检测结果为阴性（$T-$）的人数：这是真阴性（True Negatives）的计数，$TN = 6120$。\n\n根据这些基本计数，我们可以计算出边际总数：\n- 患病个体总数：$TP + FN = 1020 + 180 = 1200$。\n- 未患病个体总数：$FP + TN = 680 + 6120 = 6800$。\n- 检测结果为阳性的个体总数：$TP + FP = 1020 + 680 = 1700$。\n- 检测结果为阴性的个体总数：$FN + TN = 180 + 6120 = 6300$。\n总计为 $1200 + 6800 = 8000$（或 $1700 + 6300 = 8000$），与给定的总数 $N$ 相符。\n\n问题要求使用条件概率的基本定义计算四个指标。\n\n1.  **阳性预测值 (PPV)**：在检测结果为阳性的条件下，个体患病的概率，即 $P(D+|T+)$。\n    $$ \\mathrm{PPV} = P(D+|T+) = \\frac{\\text{数量}(D+ \\cap T+)}{\\text{数量}(T+)} = \\frac{TP}{TP+FP} = \\frac{1020}{1020+680} = \\frac{1020}{1700} = \\frac{102}{170} = \\frac{3}{5} $$\n\n2.  **假发现率 (FDR)**：在检测结果为阳性的条件下，个体未患病的概率，即 $P(D-|T+)$。\n    $$ \\mathrm{FDR} = P(D-|T+) = \\frac{\\text{数量}(D- \\cap T+)}{\\text{数量}(T+)} = \\frac{FP}{TP+FP} = \\frac{680}{1020+680} = \\frac{680}{1700} = \\frac{68}{170} = \\frac{2}{5} $$\n\n3.  **阴性预测值 (NPV)**：在检测结果为阴性的条件下，个体未患病的概率，即 $P(D-|T-)$。\n    $$ \\mathrm{NPV} = P(D-|T-) = \\frac{\\text{数量}(D- \\cap T-)}{\\text{数量}(T-)} = \\frac{TN}{TN+FN} = \\frac{6120}{6120+180} = \\frac{6120}{6300} = \\frac{612}{630} = \\frac{34}{35} $$\n\n4.  **假遗漏率 (FOR)**：在检测结果为阴性的条件下，个体患病的概率，即 $P(D+|T-)$。\n    $$ \\mathrm{FOR} = P(D+|T-) = \\frac{\\text{数量}(D+ \\cap T-)}{\\text{数量}(T-)} = \\frac{FN}{TN+FN} = \\frac{180}{6120+180} = \\frac{180}{6300} = \\frac{18}{630} = \\frac{1}{35} $$\n\n接下来，我们解释这些指标对之间的关系。\n- 对于检测结果为阳性的个体群体，只有两种可能性：他们要么患病（真阳性），要么不患病（假阳性）。这两个结果是互斥且穷尽的。因此，它们的概率之和必须等于 $1$。这就是 PPV 和 FDR 之间的关系。\n$$ \\mathrm{PPV} + \\mathrm{FDR} = P(D+|T+) + P(D-|T+) = 1 $$\n我们计算出的值证实了这一点：$\\frac{3}{5} + \\frac{2}{5} = \\frac{5}{5} = 1$。\n\n- 类似地，对于检测结果为阴性的个体群体，他们要么未患病（真阴性），要么患病（假阴性）。这些结果也是互斥且穷尽的。它们的概率之和必须等于 $1$。这就是 NPV 和 FOR 之间的关系。注意，FOR 被定义为 $P(D+|T-)$。\n$$ \\mathrm{NPV} + \\mathrm{FOR} = P(D-|T-) + P(D+|T-) = 1 $$\n我们计算出的值证实了这一点：$\\frac{34}{35} + \\frac{1}{35} = \\frac{35}{35} = 1$。\n\n最后，我们必须计算标量 $R$。\n$$ R = \\frac{\\mathrm{PPV}+\\mathrm{NPV}}{\\mathrm{FDR}+\\mathrm{FOR}} $$\n我们代入我们计算出的分数值以保持精度。\n分子是：\n$$ \\mathrm{PPV} + \\mathrm{NPV} = \\frac{3}{5} + \\frac{34}{35} = \\frac{3 \\times 7}{5 \\times 7} + \\frac{34}{35} = \\frac{21}{35} + \\frac{34}{35} = \\frac{55}{35} $$\n分母是：\n$$ \\mathrm{FDR} + \\mathrm{FOR} = \\frac{2}{5} + \\frac{1}{35} = \\frac{2 \\times 7}{5 \\times 7} + \\frac{1}{35} = \\frac{14}{35} + \\frac{1}{35} = \\frac{15}{35} $$\n现在我们计算比率 $R$：\n$$ R = \\frac{\\frac{55}{35}}{\\frac{15}{35}} = \\frac{55}{15} $$\n这个分数可以通过将分子和分母除以它们的最大公约数 $5$ 来进行约简。\n$$ R = \\frac{55 \\div 5}{15 \\div 5} = \\frac{11}{3} $$\n$R$ 的最终值是 $\\frac{11}{3}$。",
            "answer": "$$\\boxed{\\frac{11}{3}}$$"
        },
        {
            "introduction": "这是最后一个也是最关键的练习，它阐释了为何预测值并非检验的固有属性。你将分析一项在高患病率环境中进行的研究数据，以确定检验的灵敏度和特异度，然后利用这些特性来预测该检验在低患病率普通人群中的表现。这种对比将鲜明地展示患病率对阳性预测值的深远影响，这是在不同临床或公共卫生背景下应用诊断检验时必须吸取的关键一课。",
            "id": "4622606",
            "problem": "一家临床实验室正在一家专科诊所评估一种用于目标疾病的新诊断检测方法，该诊所的病例相对于普通人群更为富集。设 $D$ 表示患者确实患有该病的事件，$\\bar{D}$ 表示患者没有患该病的事件。设 $+$ 表示阳性检测结果，$-$ 表示阴性检测结果。在这项研究中，对 $500$ 名连续就诊的患者进行了检测，得到了以下经过验证的结果：在 $100$ 名患有疾病 $D$ 的患者中，$95$ 人检测结果为 $+$， $5$ 人为 $-$；在 $400$ 名没有患病 $\\bar{D}$ 的患者中，$20$ 人检测结果为 $+$， $380$ 人为 $-$。假设从本研究中估计出的该检测的操作特性同样适用于其他人群，且保持不变。另外，高质量的监测数据表明，在一个大型初级保健网络中，该疾病的人群患病率为 $\\pi^\\ast = 0.02$。\n\n仅使用灵敏度、特异度和患病率的定义，结合贝叶斯定理和全概率公式，计算在两种患病率情景下的阳性预测值（PPV），记为 $P(D \\mid +)$：研究中的患病率 $\\hat{\\pi}$ 和人群患病率 $\\pi^\\ast$。按 $\\left(PPV_{\\text{研究}}, PPV_{\\text{人群}}\\right)$ 的顺序列出你的两个 PPV 值，以小数形式表示。将你的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在两种不同的患病率情景下计算一种诊断检测的阳性预测值（PPV）。计算必须基于所提供的研究数据和概率论的基本原理，即灵敏度、特异度、患病率的定义，以及贝叶斯定理和全概率公式。\n\n首先，我们必须根据提供的研究数据确定该诊断检测的内在操作特性。这些特性，即灵敏度和特异性，被假定在不同人群中是恒定的。\n\n设 $D$ 为患者患有该病的事件，$\\bar{D}$ 为患者未患该病的事件。设 $+$ 表示阳性检测结果，$-$ 表示阴性检测结果。\n\n研究数据可总结如下：\n-   患病患者数量， $N_D = 100$。\n-   未患病患者数量， $N_{\\bar{D}} = 400$。\n-   患者总数， $N = N_D + N_{\\bar{D}} = 500$。\n-   真阳性（$TP$）数量，即患病且检测结果为阳性的患者：$TP = 95$。\n-   假阴性（$FN$）数量，即患病但检测结果为阴性的患者：$FN = 5$。\n-   假阳性（$FP$）数量，即未患病但检测结果为阳性的患者：$FP = 20$。\n-   真阴性（$TN$）数量，即未患病且检测结果为阴性的患者：$TN = 380$。\n\n检测的灵敏度（$Se$）定义为在患者患有该病的情况下检测结果为阳性的概率，即 $P(+ \\mid D)$。我们根据研究数据估计它：\n$$Se = P(+ \\mid D) = \\frac{TP}{TP + FN} = \\frac{95}{100} = 0.95$$\n\n检测的特异性（$Sp$）定义为在患者未患该病的情况下检测结果为阴性的概率，即 $P(- \\mid \\bar{D})$。我们根据研究数据估计它：\n$$Sp = P(- \\mid \\bar{D}) = \\frac{TN}{TN + FP} = \\frac{380}{400} = 0.95$$\n\n阳性预测值（$PPV$）定义为在患者检测结果为阳性的情况下其确实患有该病的概率，即 $P(D \\mid +)$。我们使用贝叶斯定理来表示这个量：\n$$P(D \\mid +) = \\frac{P(+ \\mid D) P(D)}{P(+)}$$\n项 $P(+ \\mid D)$ 是灵敏度 $Se$。项 $P(D)$ 是疾病的患病率，我们用 $\\pi$ 表示。分母 $P(+)$ 是检测结果为阳性的总概率。根据全概率公式，我们可以将 $P(+)$ 展开为：\n$$P(+) = P(+ \\mid D)P(D) + P(+ \\mid \\bar{D})P(\\bar{D})$$\n我们可以将灵敏度和患病率的定义代入此表达式。项 $P(\\bar{D})$ 是 $1 - P(D) = 1 - \\pi$。项 $P(+ \\mid \\bar{D})$ 是假阳性概率，等于 $1 - Sp$。\n$$P(+ \\mid \\bar{D}) = 1 - P(- \\mid \\bar{D}) = 1 - Sp$$\n将这些项代入全概率公式得到：\n$$P(+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\n现在，将此结果代回 PPV 的贝叶斯定理公式，得到以灵敏度、特异性和患病率表示的 PPV 通用表达式：\n$$PPV = P(D \\mid +) = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}$$\n我们现在将使用这个公式来计算两种指定情景下的 PPV。\n\n**情景 1：研究人群中的 PPV ($PPV_{\\text{study}}$)**\n\n研究人群中的患病率 $\\hat{\\pi}$ 是研究样本中患病个体的比例：\n$$\\hat{\\pi} = \\frac{N_D}{N} = \\frac{100}{500} = 0.2$$\n使用 $Se = 0.95$、$Sp = 0.95$ 和 $\\pi = \\hat{\\pi} = 0.2$ 的值，我们计算 $PPV_{\\text{study}}$：\n$$PPV_{\\text{study}} = \\frac{0.95 \\cdot 0.2}{0.95 \\cdot 0.2 + (1 - 0.95)(1 - 0.2)} = \\frac{0.19}{0.19 + (0.05)(0.8)} = \\frac{0.19}{0.19 + 0.04} = \\frac{0.19}{0.23}$$\n$$PPV_{\\text{study}} = \\frac{19}{23} \\approx 0.8260869...$$\n四舍五入到四位有效数字，我们得到 $PPV_{\\text{study}} = 0.8261$。\n\n**情景 2：普通初级保健人群中的 PPV ($PPV_{\\text{population}}$)**\n\n该人群的患病率给定为 $\\pi^\\ast = 0.02$。我们假设检测特性 $Se=0.95$ 和 $Sp=0.95$ 保持不变。\n使用 PPV 公式，其中 $\\pi = \\pi^\\ast = 0.02$：\n$$PPV_{\\text{population}} = \\frac{0.95 \\cdot 0.02}{0.95 \\cdot 0.02 + (1 - 0.95)(1 - 0.02)} = \\frac{0.019}{0.019 + (0.05)(0.98)} = \\frac{0.019}{0.019 + 0.049} = \\frac{0.019}{0.068}$$\n$$PPV_{\\text{population}} = \\frac{19}{68} \\approx 0.2794117...$$\n四舍五入到四位有效数字，我们得到 $PPV_{\\text{population}} = 0.2794$。\n\n所要求的两个 PPV 值分别为：研究患病率下的 0.8261 和人群患病率下的 0.2794。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8261  0.2794 \\end{pmatrix}}$$"
        }
    ]
}