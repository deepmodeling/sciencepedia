{
    "hands_on_practices": [
        {
            "introduction": "掌握预测值的最佳方法是从基本原理出发进行计算。本练习将指导你基于条件概率来定义灵敏度、特异度、阳性预测值 (PPV) 和阴性预测值 (NPV)，并将这些定义应用于一个假设的筛查场景。 这个练习旨在巩固理论基础，为更复杂的应用打下坚实的基础。",
            "id": "4332248",
            "problem": "一家医院正在评估一种新的血浆微小RNA（microRNA）检测方法，该方法旨在在人群筛查中区分恶性上皮性肿瘤和良性病变。在一个代表普通筛查人群的无症状队列中，恶性上皮性肿瘤的患病率为 $0.05$。据报道，该检测的灵敏度为 $0.90$，特异度为 $0.95$。从基于条件概率的核心定义出发，且不使用任何预先记忆的公式，完成以下任务：\n\n1. 用文字定义灵敏度、特异度、阳性预测值（PPV）和阴性预测值（NPV），并以疾病存在事件和检测结果事件作为每个定义的基础。\n\n2. 仅使用这些定义和适用于病理学诊断性检测的基本概率定律，推导该检测在此队列中的PPV和NPV表达式，并根据给定的灵敏度、特异度和患病率计算它们的数值。\n\n将最终的PPV和NPV数值表示为小数，四舍五入至四位有效数字，并且答案中不要使用百分号。",
            "solution": "该问题是有效的，因为它科学地基于生物统计学和流行病学的原理，提法恰当，有足够的数据得出唯一解，并且以清晰、客观的术语陈述。\n\n让我们定义以下事件：\n- $D$: 队列中的个体患有恶性上皮性肿瘤（疾病）的事件。\n- $D^c$: 个体未患该疾病的事件。\n- $T^+$: 微小RNA检测结果为阳性的事件。\n- $T^-$: 微小RNA检测结果为阴性的事件。\n\n根据问题陈述，我们已知以下概率：\n- 疾病的患病率为 $P(D) = 0.05$。\n- 未患该疾病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.05 = 0.95$。\n- 该检测的灵敏度为 $0.90$。\n- 该检测的特异度为 $0.95$。\n\n**1. 定义**\n\n基于条件概率的原理，我们可以如下定义关键术语：\n\n- **灵敏度**：灵敏度是指在被测个体确实患有该疾病的情况下，检测结果为阳性的概率。它衡量了检测正确识别出患病个体的能力。用概率术语来说，它是在疾病存在（$D$）的条件下，检测结果为阳性（$T^+$）的条件概率：\n$$ \\text{灵敏度} = P(T^+ | D) $$\n\n- **特异度**：特异度是指在被测个体确实未患该疾病的情况下，检测结果为阴性的概率。它衡量了检测正确识别出未患病个体的能力。用概率术语来说，它是在疾病不存在（$D^c$）的条件下，检测结果为阴性（$T^-$）的条件概率：\n$$ \\text{特异度} = P(T^- | D^c) $$\n\n- **阳性预测值 (PPV)**：阳性预测值是指在检测结果为阳性的个体中，其确实患有该疾病的概率。它量化了在得出阳性结果后，患病的后验概率。用概率术语来说，它是在检测结果为阳性（$T^+$）的条件下，疾病存在（$D$）的条件概率：\n$$ \\text{PPV} = P(D | T^+) $$\n\n- **阴性预测值 (NPV)**：阴性预测值是指在检测结果为阴性的个体中，其确实未患该疾病的概率。它量化了在得出阴性结果后，未患病的后验概率。用概率术语来说，它是在检测结果为阴性（$T^-$）的条件下，疾病不存在（$D^c$）的条件概率：\n$$ \\text{NPV} = P(D^c | T^-) $$\n\n**2. PPV和NPV的推导与计算**\n\n我们将使用条件概率的基本定义 $P(A|B) = \\frac{P(A \\cap B)}{P(B)}$ 和全概率定律来推导PPV和NPV的表达式。\n\n**阳性预测值（PPV）的推导：**\nPPV定义为 $P(D | T^+)$。根据条件概率的定义：\n$$ \\text{PPV} = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)} $$\n分子 $P(D \\cap T^+)$ 是同时患病且检测为阳性（真阳性）的联合概率。我们可以将其表示为 $P(D \\cap T^+) = P(T^+ | D) P(D)$。\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率。阳性结果可能发生在两种互斥的情况下：真阳性（$D \\cap T^+$）或假阳性（$D^c \\cap T^+$）。根据全概率定律：\n$$ P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c) $$\n$$ P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c) $$\n我们已知灵敏度 $P(T^+ | D) = 0.90$。我们需要 $P(T^+ | D^c)$，即在没有疾病的情况下检测结果为阳性的概率。这与特异度 $P(T^- | D^c) = 0.95$ 相关。由于未患病的个体检测结果只能是阳性或阴性，我们有 $P(T^+ | D^c) + P(T^- | D^c) = 1$。\n因此，$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - \\text{特异度} = 1 - 0.95 = 0.05$。\n\n将这些部分代回PPV的表达式中：\n$$ \\text{PPV} = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} $$\n现在，我们计算其数值：\n$$ \\text{PPV} = \\frac{(0.90)(0.05)}{(0.90)(0.05) + (0.05)(0.95)} = \\frac{0.045}{0.045 + 0.0475} = \\frac{0.045}{0.0925} \\approx 0.486486... $$\n四舍五入至四位有效数字，$\\text{PPV} = 0.4865$。\n\n**阴性预测值（NPV）的推导：**\nNPV定义为 $P(D^c | T^-)$。根据条件概率的定义：\n$$ \\text{NPV} = P(D^c | T^-) = \\frac{P(D^c \\cap T^-)}{P(T^-)} $$\n分子 $P(D^c \\cap T^-)$ 是同时未患病且检测为阴性（真阴性）的联合概率。我们可以将其表示为 $P(D^c \\cap T^-) = P(T^- | D^c) P(D^c)$。\n\n分母 $P(T^-)$ 是检测结果为阴性的总概率。阴性结果可能发生在两种互斥的情况下：真阴性（$D^c \\cap T^-$）或假阴性（$D \\cap T^-$）。根据全概率定律：\n$$ P(T^-) = P(T^- \\cap D^c) + P(T^- \\cap D) $$\n$$ P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D) $$\n我们已知特异度 $P(T^- | D^c) = 0.95$。我们需要 $P(T^- | D)$，即在患有疾病的情况下检测结果为阴性的概率。这与灵敏度 $P(T^+ | D) = 0.90$ 相关。由于患病的个体检测结果只能是阳性或阴性，我们有 $P(T^- | D) + P(T^+ | D) = 1$。\n因此，$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\text{灵敏度} = 1 - 0.90 = 0.10$。\n\n将这些部分代回NPV的表达式中：\n$$ \\text{NPV} = \\frac{P(T^- | D^c) P(D^c)}{P(T^- | D^c) P(D^c) + P(T^- | D) P(D)} $$\n现在，我们计算其数值：\n$$ \\text{NPV} = \\frac{(0.95)(0.95)}{(0.95)(0.95) + (0.10)(0.05)} = \\frac{0.9025}{0.9025 + 0.005} = \\frac{0.9025}{0.9075} \\approx 0.994490... $$\n四舍五入至四位有效数字，$\\text{NPV} = 0.9945$。\n\n计算得出的阳性预测值为 $0.4865$，阴性预测值为 $0.9945$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.4865  0.9945 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在现实世界的流行病学研究中，我们通常从列联表的原始计数开始分析。本练习提供了一个直接的动手实践机会，让你从这类数据中计算预测值。 此外，它还引入了假发现率 (FDR) 和假遗漏率 (FOR) 的概念，它们分别与 PPV 和 NPV 互补，对于全面解读检测结果至关重要。",
            "id": "4622628",
            "problem": "一项针对二元疾病的新诊断检测在一项涉及 $N=8000$ 名个体的横断面研究中进行评估，这些个体的真实患病状态通过金标准得到验证。在患病个体中，$1020$ 人检测呈阳性，$180$ 人检测呈阴性。在未患病个体中，$680$ 人检测呈阳性，$6120$ 人检测呈阴性。仅使用应用于诊断检测的条件概率基本定义，根据这些计数计算阳性预测值（PPV）、错误发现率（FDR）、阴性预测值（NPV）和错误遗漏率（FOR），并简要解释它们如何通过概率互补关系相关联。然后，使用您计算出的值，评估标量\n$$R=\\frac{\\mathrm{PPV}+\\mathrm{NPV}}{\\mathrm{FDR}+\\mathrm{FOR}}$$.\n将 $R$ 的最终值表示为单个最简分数。任何地方都不要使用百分号；根据需要，将任何中间比例表示为小数或分数。您唯一需要报告的数字是 $R$ 的最终值。",
            "solution": "该问题陈述已经过验证，是自洽的、有科学依据的、且表述清晰。所有必要数据均已提供，不存在内部矛盾或歧义。因此，我们可以着手求解。\n\n问题要求从一组给定的计数中计算几个诊断测试指标。我们可以将所提供的数据整理成一个标准的 $2 \\times 2$ 列联表。设 $D+$ 表示患病，$D-$ 表示未患病。设 $T+$ 表示阳性检测结果，$T-$ 表示阴性检测结果。\n\n已知条件如下：\n- 研究中的总个体数，$N=8000$。\n- 在患病个体中（$D+$）：\n  - 检测呈阳性者（$T+$）的数量：这是真阳性（True Positives）的计数，$TP = 1020$。\n  - 检测呈阴性者（$T-$）的数量：这是假阴性（False Negatives）的计数，$FN = 180$。\n- 在未患病个体中（$D-$）：\n  - 检测呈阳性者（$T+$）的数量：这是假阳性（False Positives）的计数，$FP = 680$。\n  - 检测呈阴性者（$T-$）的数量：这是真阴性（True Negatives）的计数，$TN = 6120$。\n\n根据这些基本计数，我们可以计算出边际总数：\n- 患病个体总数：$TP + FN = 1020 + 180 = 1200$。\n- 未患病个体总数：$FP + TN = 680 + 6120 = 6800$。\n- 检测结果为阳性的个体总数：$TP + FP = 1020 + 680 = 1700$。\n- 检测结果为阴性的个体总数：$FN + TN = 180 + 6120 = 6300$。\n总计为 $1200 + 6800 = 8000$（或 $1700 + 6300 = 8000$），与给定的总数 $N$ 相符。\n\n问题要求使用条件概率的基本定义计算四个指标。\n\n1.  **阳性预测值 (PPV)**：在检测结果为阳性的条件下，个体确实患病的概率，$P(D+|T+)$。\n    $$ \\mathrm{PPV} = P(D+|T+) = \\frac{\\text{Number}(D+ \\cap T+)}{\\text{Number}(T+)} = \\frac{TP}{TP+FP} = \\frac{1020}{1020+680} = \\frac{1020}{1700} = \\frac{102}{170} = \\frac{3}{5} $$\n\n2.  **错误发现率 (FDR)**：在检测结果为阳性的条件下，个体并未患病的概率，$P(D-|T+)$。\n    $$ \\mathrm{FDR} = P(D-|T+) = \\frac{\\text{Number}(D- \\cap T+)}{\\text{Number}(T+)} = \\frac{FP}{TP+FP} = \\frac{680}{1020+680} = \\frac{680}{1700} = \\frac{68}{170} = \\frac{2}{5} $$\n\n3.  **阴性预测值 (NPV)**：在检测结果为阴性的条件下，个体确实未患病的概率，$P(D-|T-)$。\n    $$ \\mathrm{NPV} = P(D-|T-) = \\frac{\\text{Number}(D- \\cap T-)}{\\text{Number}(T-)} = \\frac{TN}{TN+FN} = \\frac{6120}{6120+180} = \\frac{6120}{6300} = \\frac{612}{630} = \\frac{34}{35} $$\n\n4.  **错误遗漏率 (FOR)**：在检测结果为阴性的条件下，个体却患病的概率，$P(D+|T-)$。\n    $$ \\mathrm{FOR} = P(D+|T-) = \\frac{\\text{Number}(D+ \\cap T-)}{\\text{Number}(T-)} = \\frac{FN}{TN+FN} = \\frac{180}{6120+180} = \\frac{180}{6300} = \\frac{18}{630} = \\frac{1}{35} $$\n\n接下来，我们解释这些指标对之间的关系。\n- 对于检测结果为阳性的个体群体，只有两种可能性：他们要么患病（真阳性），要么不患病（假阳性）。这两个结果是互斥且穷尽的。因此，它们的概率之和必须等于 $1$。这就是 PPV 和 FDR 之间的关系。\n$$ \\mathrm{PPV} + \\mathrm{FDR} = P(D+|T+) + P(D-|T+) = 1 $$\n我们的计算值证实了这一点：$\\frac{3}{5} + \\frac{2}{5} = \\frac{5}{5} = 1$。\n\n- 类似地，对于检测结果为阴性的个体群体，他们要么不患病（真阴性），要么患病（假阴性）。这些结果也是互斥且穷尽的。它们的概率之和必须等于 $1$。这就是 NPV 和 FOR 之间的关系。注意，FOR 被定义为 $P(D+|T-)$。\n$$ \\mathrm{NPV} + \\mathrm{FOR} = P(D-|T-) + P(D+|T-) = 1 $$\n我们的计算值证实了这一点：$\\frac{34}{35} + \\frac{1}{35} = \\frac{35}{35} = 1$。\n\n最后，我们必须计算标量 $R$。\n$$ R = \\frac{\\mathrm{PPV}+\\mathrm{NPV}}{\\mathrm{FDR}+\\mathrm{FOR}} $$\n我们代入计算出的分数值以保持精度。\n分子是：\n$$ \\mathrm{PPV} + \\mathrm{NPV} = \\frac{3}{5} + \\frac{34}{35} = \\frac{3 \\times 7}{5 \\times 7} + \\frac{34}{35} = \\frac{21}{35} + \\frac{34}{35} = \\frac{55}{35} $$\n分母是：\n$$ \\mathrm{FDR} + \\mathrm{FOR} = \\frac{2}{5} + \\frac{1}{35} = \\frac{2 \\times 7}{5 \\times 7} + \\frac{1}{35} = \\frac{14}{35} + \\frac{1}{35} = \\frac{15}{35} $$\n现在我们计算比率 $R$：\n$$ R = \\frac{\\frac{55}{35}}{\\frac{15}{35}} = \\frac{55}{15} $$\n这个分数可以通过将分子和分母除以它们的最大公约数 $5$ 来化简。\n$$ R = \\frac{55 \\div 5}{15 \\div 5} = \\frac{11}{3} $$\n$R$ 的最终值是 $\\frac{11}{3}$。",
            "answer": "$$\\boxed{\\frac{11}{3}}$$"
        },
        {
            "introduction": "一个检测的预测值并非其固有属性，而是严重依赖于受检人群中的疾病患病率。本练习探讨了这一关键概念 ，通过对比一种检测在专科诊所（高患病率）和普通人群（低患病率）中阳性预测值的差异，突显了为何必须在预期的具体应用场景下评估检测的性能。",
            "id": "4622606",
            "problem": "一家临床实验室正在评估一种用于目标疾病的新型诊断检测方法，评估地点是一家专科诊所，该诊所的病例相对于总人口而言较为富集。设 $D$ 表示患者确实患有该病的事件，$\\bar{D}$ 表示患者未患该病的事件。设 $+$ 表示阳性检测结果，$-$ 表示阴性检测结果。研究中，对 $500$ 名连续就诊的患者进行了检测，得到以下已验证的结果：在 $100$ 名患有疾病 $D$ 的患者中，$95$ 人检测为 $+$，$5$ 人检测为 $-$；在 $400$ 名未患疾病 $\\bar{D}$ 的患者中，$20$ 人检测为 $+$，$380$ 人检测为 $-$。假设从本研究中估算的该检测的操作特性在其他人群中保持不变。另外，高质量的监测数据表明，在一个大型初级保健网络中，该疾病的人群患病率为 $\\pi^\\ast = 0.02$。\n\n请仅使用灵敏度、特异度和患病率的定义，结合贝叶斯定理和全概率公式，计算在两种患病率情景下的阳性预测值（PPV），记为 $P(D \\mid +)$：研究患病率 $\\hat{\\pi}$ 和人群患病率 $\\pi^\\ast$。请按 $\\left(PPV_{\\text{study}}, PPV_{\\text{population}}\\right)$ 的顺序报告您的两个PPV值，以小数形式表示。将您的答案四舍五入至四位有效数字。",
            "solution": "该问题要求在两种不同的患病率情景下，计算一种诊断检测方法的阳性预测值（PPV）。计算必须基于所提供的研究数据以及概率论的基本原理，即灵敏度、特异度、患病率的定义、贝叶斯定理和全概率公式。\n\n首先，我们必须从提供的研究数据中确定该诊断测试的内在操作特性。这些特性，即灵敏度和特异度，被假定在不同人群中是恒定的。\n\n设 $D$ 为患者患有该疾病的事件，$\\bar{D}$ 为患者未患该疾病的事件。设 $+$ 表示阳性检测结果，$-$ 表示阴性检测结果。\n\n研究数据可总结如下：\n-   患病患者数量，$N_D = 100$。\n-   未患病患者数量，$N_{\\bar{D}} = 400$。\n-   患者总数，$N = N_D + N_{\\bar{D}} = 500$。\n-   真阳性（$TP$）数量，即患病且检测结果为阳性的患者：$TP = 95$。\n-   假阴性（$FN$）数量，即患病但检测结果为阴性的患者：$FN = 5$。\n-   假阳性（$FP$）数量，即未患病但检测结果为阳性的患者：$FP = 20$。\n-   真阴性（$TN$）数量，即未患病且检测结果为阴性的患者：$TN = 380$。\n\n某项检测的灵敏度（$Se$）定义为在患者患有该疾病的条件下，检测结果为阳性的概率，即 $P(+ \\mid D)$。我们根据研究数据估计它：\n$$Se = P(+ \\mid D) = \\frac{TP}{TP + FN} = \\frac{95}{100} = 0.95$$\n\n某项检测的特异度（$Sp$）定义为在患者未患该疾病的条件下，检测结果为阴性的概率，即 $P(- \\mid \\bar{D})$。我们根据研究数据估计它：\n$$Sp = P(- \\mid \\bar{D}) = \\frac{TN}{TN + FP} = \\frac{380}{400} = 0.95$$\n\n阳性预测值（$PPV$）定义为在患者检测结果为阳性的条件下，其确实患有该疾病的概率，即 $P(D \\mid +)$。我们使用贝叶斯定理来表示这个量：\n$$P(D \\mid +) = \\frac{P(+ \\mid D) P(D)}{P(+)}$$\n项 $P(+ \\mid D)$ 是灵敏度 $Se$。项 $P(D)$ 是疾病的患病率，我们将其记为 $\\pi$。分母 $P(+)$ 是检测结果为阳性的总概率。根据全概率公式，我们可以将 $P(+)$ 展开为：\n$$P(+) = P(+ \\mid D)P(D) + P(+ \\mid \\bar{D})P(\\bar{D})$$\n我们可以将灵敏度和患病率的定义代入此表达式。项 $P(\\bar{D})$ 是 $1 - P(D) = 1 - \\pi$。项 $P(+ \\mid \\bar{D})$ 是假阳性概率，它等于 $1 - Sp$。\n$$P(+ \\mid \\bar{D}) = 1 - P(- \\mid \\bar{D}) = 1 - Sp$$\n将这些项代入全概率公式可得：\n$$P(+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\n现在，将此结果代回PPV的贝叶斯定理公式，可得出以灵敏度、特异度和患病率表示的PPV的一般表达式：\n$$PPV = P(D \\mid +) = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}$$\n现在我们将使用这个公式来计算两种指定情景下的PPV。\n\n**情景1：研究人群中的PPV ($PPV_{\\text{study}}$)**\n\n研究人群中的患病率 $\\hat{\\pi}$ 是研究样本中患病个体所占的比例：\n$$\\hat{\\pi} = \\frac{N_D}{N} = \\frac{100}{500} = 0.2$$\n使用值 $Se = 0.95$，$Sp = 0.95$，和 $\\pi = \\hat{\\pi} = 0.2$，我们计算 $PPV_{\\text{study}}$：\n$$PPV_{\\text{study}} = \\frac{0.95 \\cdot 0.2}{0.95 \\cdot 0.2 + (1 - 0.95)(1 - 0.2)} = \\frac{0.19}{0.19 + (0.05)(0.8)} = \\frac{0.19}{0.19 + 0.04} = \\frac{0.19}{0.23}$$\n$$PPV_{\\text{study}} = \\frac{19}{23} \\approx 0.8260869...$$\n四舍五入到四位有效数字，我们得到 $PPV_{\\text{study}} = 0.8261$。\n\n**情景2：普通初级保健人群中的PPV ($PPV_{\\text{population}}$)**\n\n该人群的患病率给定为 $\\pi^\\ast = 0.02$。我们假设检测特性 $Se=0.95$ 和 $Sp=0.95$ 保持不变。\n使用 $\\pi = \\pi^\\ast = 0.02$ 的PPV公式：\n$$PPV_{\\text{population}} = \\frac{0.95 \\cdot 0.02}{0.95 \\cdot 0.02 + (1 - 0.95)(1 - 0.02)} = \\frac{0.019}{0.019 + (0.05)(0.98)} = \\frac{0.019}{0.019 + 0.049} = \\frac{0.019}{0.068}$$\n$$PPV_{\\text{population}} = \\frac{19}{68} \\approx 0.2794117...$$\n四舍五入到四位有效数字，我们得到 $PPV_{\\text{population}} = 0.2794$。\n\n所要求的两个PPV值分别为：研究患病率下的0.8261和人群患病率下的0.2794。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8261  0.2794 \\end{pmatrix}}$$"
        }
    ]
}