{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本节的第一个练习将带你直接处理原始数据。通过一个标准的 $2 \\times 2$ 列联表（或称混淆矩阵），我们将计算最基本的性能指标：灵敏度和特异度。这个练习不仅能加深你对这些指标作为条件概率的理解，也是掌握诊断试验评估的第一步，同时还将探讨一个关于研究设计的重要概念 ()。",
            "id": "4332588",
            "problem": "一项靶向二代测序分析被评估用于在精准肿瘤学背景下检测致病性变异。在一项多中心病例对照评估中，样本被该分析方法分类为阳性或阴性，并由一种金标准正交方法确定其真实的变异状态。设真阳性计数为 $TP = 48$，假阴性计数为 $FN = 12$，假阳性计数为 $FP = 18$，真阴性计数为 $TN = 122$。仅使用条件概率和二元分类中错误率的基本定义，计算以下四种性能特征：灵敏度、特异度、假阳性率和假阴性率。然后，使用关于回顾性（病例对照）抽样下条件概率的第一性原理论证，确定这四个量中哪些在病例对照抽样下对疾病患病率是不变的。\n\n将最终答案以单行矩阵的形式报告，顺序为 $\\bigl(\\text{灵敏度},\\ \\text{特异度},\\ \\text{假阳性率},\\ \\text{假阴性率},\\ I_{\\text{灵敏度}},\\ I_{\\text{特异度}},\\ I_{\\text{假阳性率}},\\ I_{\\text{假阴性率}}\\bigr)$，其中如果该量在病例对照抽样下对患病率不变，则 $I_{\\cdot}$ 为 $1$，否则为 $0$。将四种率表示为精确的既约分数。不允许四舍五入。不变性指标必须报告为精确整数 $0$ 或 $1$。",
            "solution": "该问题陈述经评估具有科学依据、提法恰当、客观且内容自洽。计算所需的所有数据均已提供，且所用概念为统计学和临床诊断学的基础。因此，该问题是有效的。\n\n设 $D^+$ 为个体携带致病性变异（为病例）的事件， $D^-$ 为个体不携带该变异（为对照）的事件。设 $T^+$ 为分析结果为阳性的事件， $T^-$ 为分析结果为阴性的事件。\n\n提供的数据是二元分类混淆矩阵中四种可能结果的计数：\n- 真阳性 ($TP$)：携带变异且检测结果为阳性的个体数量。$TP = 48$。\n- 假阴性 ($FN$)：携带变异但检测结果为阴性的个体数量。$FN = 12$。\n- 假阳性 ($FP$)：不携带变异但检测结果为阳性的个体数量。$FP = 18$。\n- 真阴性 ($TN$)：不携带变异且检测结果为阴性的个体数量。$TN = 122$。\n\n根据这些计数，我们可以确定研究中病例和对照的总数：\n- 病例总数（携带变异的个体）：$P = TP + FN = 48 + 12 = 60$。\n- 对照总数（不携带变异的个体）：$N = FP + TN = 18 + 122 = 140$。\n\n这四种性能特征是根据它们作为条件概率的定义来计算的。\n\n1.  **灵敏度（真阳性率, $TPR$）**\n    灵敏度是在个体确实携带变异的条件下，检测结果为阳性的概率。它是衡量检测方法识别真病例能力的一个指标。\n    $$ \\text{灵敏度} = P(T^+ | D^+) = \\frac{\\text{同时具有 } T^+ \\text{ 和 } D^+ \\text{ 的个体数}}{\\text{具有 } D^+ \\text{ 的个体总数}} = \\frac{TP}{TP + FN} $$\n    代入给定值：\n    $$ \\text{灵敏度} = \\frac{48}{48 + 12} = \\frac{48}{60} = \\frac{4 \\times 12}{5 \\times 12} = \\frac{4}{5} $$\n\n2.  **特异度（真阴性率, $TNR$）**\n    特异度是在个体确实不携带变异的条件下，检测结果为阴性的概率。它是衡量检测方法识别真非病例能力的一个指标。\n    $$ \\text{特异度} = P(T^- | D^-) = \\frac{\\text{同时具有 } T^- \\text{ 和 } D^- \\text{ 的个体数}}{\\text{具有 } D^- \\text{ 的个体总数}} = \\frac{TN}{TN + FP} $$\n    代入给定值：\n    $$ \\text{特异度} = \\frac{122}{122 + 18} = \\frac{122}{140} = \\frac{61 \\times 2}{70 \\times 2} = \\frac{61}{70} $$\n\n3.  **假阳性率 ($FPR$)**\n    假阳性率是在个体确实不携带变异的条件下，检测结果为阳性的概率。这是一个 I 类错误率。\n    $$ FPR = P(T^+ | D^-) = \\frac{\\text{同时具有 } T^+ \\text{ 和 } D^- \\text{ 的个体数}}{\\text{具有 } D^- \\text{ 的个体总数}} = \\frac{FP}{FP + TN} $$\n    根据定义，它也与特异度相关：$FPR = 1 - \\text{特异度}$。\n    代入给定值：\n    $$ FPR = \\frac{18}{18 + 122} = \\frac{18}{140} = \\frac{9 \\times 2}{70 \\times 2} = \\frac{9}{70} $$\n\n4.  **假阴性率 ($FNR$)**\n    假阴性率是在个体确实携带变异的条件下，检测结果为阴性的概率。这是一个 II 类错误率。\n    $$ FNR = P(T^- | D^+) = \\frac{\\text{同时具有 } T^- \\text{ 和 } D^+ \\text{ 的个体数}}{\\text{具有 } D^+ \\text{ 的个体总数}} = \\frac{FN}{TP + FN} $$\n    根据定义，它也与灵敏度相关：$FNR = 1 - \\text{灵敏度}$。\n    代入给定值：\n    $$ FNR = \\frac{12}{48 + 12} = \\frac{12}{60} = \\frac{1 \\times 12}{5 \\times 12} = \\frac{1}{5} $$\n\n接下来，我们必须确定这些量中哪些在病例对照抽样下对疾病患病率是不变的。\n\n病例对照研究是一种回顾性研究设计，其中根据受试者已知的结果状态来选择他们。在这里，一组“病例”（携带变异的个体, $D^+$）和一组“对照”（不携带变异的个体, $D^-$）被组合起来。研究样本中病例与对照的比例是由研究设计决定的，而不是由疾病在人群中的自然患病率决定的。患病率 $\\pi = P(D^+)$ 是指在可能从中抽取研究样本的普通人群中患有该疾病的先验概率。在病例对照设计中，样本患病率是人为固定的，并不是 $\\pi$ 的估计值。\n\n我们根据这种抽样方案来分析这四个指标的定义：\n\n-   **灵敏度, $P(T^+|D^+)$**：这个概率是以事件 $D^+$ 为条件的。计算 $\\frac{TP}{TP+FN}$ 完全在病例组内进行。由于灵敏度的估计仅取决于已知患有该疾病的受试者，因此它与研究中包含了多少不患病的受试者无关。因此，灵敏度是检测方法在患病人群中性能的内在特征，并且对普通人群中的疾病患病率是**不变的**。指标 $I_{\\text{灵敏度}}$ 为 $1$。\n\n-   **特异度, $P(T^-|D^-)$**：这个概率是以事件 $D^-$ 为条件的。计算 $\\frac{TN}{TN+FP}$ 完全在对照组内进行。与灵敏度类似，特异度的估计仅取决于已知无病的受试者。因此，它是检测方法在非患病人群中性能的内在特征，并且对疾病患病率是**不变的**。指标 $I_{\\text{特异度}}$ 为 $1$。\n\n-   **假阳性率, $P(T^+|D^-)$**：这个概率也是以事件 $D^-$ 为条件的。其计算 $\\frac{FP}{FP+TN}$ 完全在对照组内进行。由于它就是 $1 - \\text{特异度}$，因此它具有相同的性质。假阳性率对疾病患病率是**不变的**。指标 $I_{\\text{假阳性率}}$ 为 $1$。\n\n-   **假阴性率, $P(T^-|D^+)$**：这个概率也是以事件 $D^+$ 为条件的。其计算 $\\frac{FN}{TP+FN}$ 完全在病例组内进行。由于它就是 $1 - \\text{灵敏度}$，因此它也具有相同的性质。假阴性率对疾病患病率是**不变的**。指标 $I_{\\text{假阴性率}}$ 为 $1$。\n\n总而言之，所有四个指标——灵敏度、特异度、假阳性率和假阴性率——都是由以真实疾病状态为条件的概率定义的。病例对照研究设计之所以能够直接估计这些量，正是因为它从患病和非患病个体的不同分层中抽样。这些指标是检测方法本身的属性，而不是其使用人群的属性。相比之下，像阳性预测值 ($PPV = P(D^+|T^+)$) 和阴性预测值 ($NPV = P(D^-|T^-)$) 这样的指标，通过贝叶斯定理，严重依赖于患病率 $\\pi = P(D^+)$，并且在没有关于 $\\pi$ 的外部知识的情况下，无法从病例对照研究中直接估计。\n\n计算出的值及其不变性指标如下：\n- 灵敏度：$\\frac{4}{5}$，不变 ($I=1$)\n- 特异度：$\\frac{61}{70}$，不变 ($I=1$)\n- 假阳性率：$\\frac{9}{70}$，不变 ($I=1$)\n- 假阴性率：$\\frac{1}{5}$，不变 ($I=1$)\n\n最终答案按指定顺序以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{61}{70}  \\frac{9}{70}  \\frac{1}{5}  1  1  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在现实世界中，我们常常采用序贯检测策略——先用一种廉价的筛查试验，再对阳性者使用更精确的确证试验。本练习将探讨如何计算这种多步骤策略的整体性能。你将学习如何将单个试验的特性结合起来，以确定最终的诊断准确性，这对于设计高效的筛查方案至关重要 ()。",
            "id": "4578191",
            "problem": "一项基于社区的预防医学项目旨在根据个体健康和疾病谱系，对一种潜伏性传染病进行分层。个体首先接受一项低成本的筛查检测，只有筛查结果为阳性者才会进行确认检测。只有当两次检测结果均为阳性时，该个体才被归类为总体阳性。\n\n筛查检测的灵敏度为 $0.8$，特异度为 $0.7$。确认检测的灵敏度为 $0.95$，特异度为 $0.95$。使用核心定义，即灵敏度为 $P(\\text{test positive} \\mid D=1)$，特异度为 $P(\\text{test negative} \\mid D=0)$，其中 $D=1$ 表示患病，$D=0$ 表示未患病。假设在给定真实疾病状态的情况下，检测结果是条件独立的，即对于任意一对检测结果 $X$ 和 $Y$，有 $P(X,Y \\mid D)=P(X \\mid D)P(Y \\mid D)$。\n\n根据第一性原理及上述假设，推导该序贯策略的组合假阳性率，其定义为 $P(\\text{总体阳性} \\mid D=0)$。请用小数表示最终答案，不要包含任何单位。无需四舍五入。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   筛查检测灵敏度：$0.8$\n-   筛查检测特异度：$0.7$\n-   确认检测灵敏度：$0.95$\n-   确认检测特异度：$0.95$\n-   灵敏度定义：$P(\\text{test positive} \\mid D=1)$\n-   特异度定义：$P(\\text{test negative} \\mid D=0)$\n-   疾病状态标签：$D=1$ 表示患病，$D=0$ 表示未患病。\n-   总体阳性分类：只有当两次检测结果均为阳性时，个体才被归类为总体阳性。\n-   检测顺序：只有筛查结果为阳性者才会进行确认检测。\n-   条件独立性假设：$P(X,Y \\mid D)=P(X \\mid D)P(Y \\mid D)$，其中 $X$ 和 $Y$ 是检测结果，$D$ 是真实疾病状态。\n-   要求计算：组合假阳性率，定义为 $P(\\text{总体阳性} \\mid D=0)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它基于概率论的标准原理及其在医学诊断中的应用，这是流行病学和预防医学的核心课题。所有必要的数据（灵敏度、特异度、定义和假设）均已提供，且不存在内部矛盾。数值是现实的。问题明确，要求计算一个具体的、可计算的量。该问题不违反任何无效标准。\n\n### 步骤 3：结论与行动\n该问题被判定为有效。将推导解答。\n\n### 推导过程\n目标是计算该序贯检测策略的组合假阳性率。该率在问题中定义为 $P(\\text{总体阳性} \\mid D=0)$，即在个体实际未患病的情况下，被整个检测方案归类为阳性的概率。\n\n让我们正式定义以下事件：\n-   $D=1$：个体患有该疾病。\n-   $D=0$：个体未患有该疾病。\n-   $T_1=1$：筛查检测结果为阳性。\n-   $T_1=0$：筛查检测结果为阴性。\n-   $T_2=1$：确认检测结果为阳性。\n-   $T_2=0$：确认检测结果为阴性。\n\n给定的参数可以用以下符号表示：\n-   筛查检测的灵敏度 ($S_1$)：$P(T_1=1 \\mid D=1) = 0.8$。\n-   筛查检测的特异度 ($P_1$)：$P(T_1=0 \\mid D=0) = 0.7$。\n-   确认检测的灵敏度 ($S_2$)：$P(T_2=1 \\mid D=1) = 0.95$。\n-   确认检测的特异度 ($P_2$)：$P(T_2=0 \\mid D=0) = 0.95$。\n\n只有当两次检测结果均为阳性时，个体才被归类为“总体阳性”。这对应于联合事件 $\\{T_1=1 \\text{ 且 } T_2=1\\}$，可以写成事件的交集 $T_1=1 \\cap T_2=1$。\n\n所求的量是该总体策略的假阳性率，即在个体未患病（$D=0$）的条件下，此联合事件发生的概率。我们必须计算 $P(T_1=1 \\cap T_2=1 \\mid D=0)$。\n\n问题陈述中要求假设在给定真实疾病状态的情况下，检测结果是条件独立的：$P(X, Y \\mid D) = P(X \\mid D)P(Y \\mid D)$。将此假设应用于我们的具体问题，我们得到：\n$$P(T_1=1 \\cap T_2=1 \\mid D=0) = P(T_1=1 \\mid D=0) \\times P(T_2=1 \\mid D=0)$$\n请注意，尽管检测是序贯进行的，但条件独立性假设简化了计算。对于一个未患病的个体，联合结果的概率是该个体每次检测呈阳性的概率的乘积。\n\n我们需要求出方程右侧的各项。\n第一项，$P(T_1=1 \\mid D=0)$，是筛查检测的假阳性率。这是筛查检测特异度的补集。\n给定的特异度为 $P_1 = P(T_1=0 \\mid D=0) = 0.7$。\n因此，筛查检测的假阳性率为：\n$$P(T_1=1 \\mid D=0) = 1 - P(T_1=0 \\mid D=0) = 1 - P_1 = 1 - 0.7 = 0.3$$\n\n第二项，$P(T_2=1 \\mid D=0)$，是确认检测的假阳性率。这是确认检测特异度的补集。\n给定的特异度为 $P_2 = P(T_2=0 \\mid D=0) = 0.95$。\n因此，确认检测的假阳性率为：\n$$P(T_2=1 \\mid D=0) = 1 - P(T_2=0 \\mid D=0) = 1 - P_2 = 1 - 0.95 = 0.05$$\n\n现在，我们可以通过将这两个概率相乘来计算组合假阳性率：\n$$P(\\text{overall positive} \\mid D=0) = P(T_1=1 \\mid D=0) \\times P(T_2=1 \\mid D=0)$$\n$$P(\\text{overall positive} \\mid D=0) = (1 - P_1) \\times (1 - P_2)$$\n$$P(\\text{overall positive} \\mid D=0) = 0.3 \\times 0.05$$\n$$P(\\text{overall positive} \\mid D=0) = 0.015$$\n\n这个结果表示一个未患病者在第一次检测中呈阳性，并且在第二次检测中也呈阳性的概率，从而被该序贯方案错误地归类为患有该疾病。该检测策略的序贯性有效地筛选了人群，但由于条件独立性假设，组合结果的总体假阳性率由各个假阳性率的乘积决定。",
            "answer": "$$\\boxed{0.015}$$"
        },
        {
            "introduction": "许多现代诊断试验不仅仅给出“阳性”或“阴性”的二元结果，而是提供一个连续的评分。如何选择一个分界值（阈值）来定义“阳性”至关重要。本练习将指导你如何从原始评分数据中构建受试者工作特征（ROC）曲线，它能够全面展示一个诊断试验在所有可能阈值下的诊断能力 ()。",
            "id": "4332613",
            "problem": "在精准肿瘤学中使用的一个基因组分类器为每个个体输出一个连续的诊断评分。考虑一个评估队列，其中包含 $n_{D} = 4$ 名疾病病例和 $n_{N} = 4$ 名非患病对照。观测到的分类器评分如下：疾病病例的评分为 $[0.95, 0.81, 0.77, 0.62]$，非患病对照的评分为 $[0.83, 0.79, 0.70, 0.40]$。使用决策规则“如果评分大于或等于阈值 $\\tau$，则预测为疾病”，并通过在观测到的评分范围内改变 $\\tau$ 来构建经验性受试者工作特征（ROC）曲线，其中 ROC 曲线绘制了真阳性率（TPR）随 $\\tau$ 变化的假阳性率（FPR）的关系。\n\n从基本原理出发，使用灵敏度和特异度作为条件概率的标准定义，来推导通过对有限样本进行阈值化处理而产生的经验性 ROC 点。明确指出不同疾病状态的评分之间存在的任何并列值，并解释在有限样本中必须如何处理这些并列值，以生成一个良定义的经验性 ROC 曲线和曲线下面积。然后，使用与决策规则引起的阶梯式变化一致的阈值扫描方法，并沿 FPR 轴进行几何上合理的积分，计算 ROC 的经验性曲线下面积（AUC）。\n\n将最终的 AUC 四舍五入到 $4$ 位有效数字，并以小数形式表示，不带任何百分号。",
            "solution": "该问题要求根据一组来自患病和非患病个体队列的诊断评分，构建受试者工作特征（ROC）曲线并计算曲线下面积（AUC）。\n\n### 步骤 1：问题验证\n\n问题给出了以下已知条件：\n-   疾病病例数：$n_{D} = 4$。\n-   疾病病例的评分：$[0.95, 0.81, 0.77, 0.62]$。\n-   非患病对照数：$n_{N} = 4$。\n-   非患病对照的评分：$[0.83, 0.79, 0.70, 0.40]$。\n-   决策规则：如果评分 $\\ge \\tau$，则预测为疾病。\n\n问题要求：\n1.  通过改变阈值 $\\tau$ 构建经验性 ROC 曲线。\n2.  解释如何处理并列评分。\n3.  沿假阳性率（FPR）轴使用几何积分计算经验性 AUC。\n4.  将最终的 AUC 四舍五入到 $4$ 位有效数字。\n\n该问题在科学上基于用于诊断测试评估的成熟统计方法——ROC分析。问题提法恰当，提供了所有必要数据且无矛盾。任务是客观的，需要进行标准的、可验证的计算。因此，该问题被认定为**有效的**。\n\n### 步骤 2：理论框架\n\n设 $S$ 为诊断评分。设 $D$ 表示患病状态，$N$ 表示非患病状态。决策规则将评分 $S$ 大于或等于阈值 $\\tau$ 的个体分类为阳性（$T+$），否则分类为阴性（$T-$）。\n\nROC 曲线的两个关键性能指标是真阳性率（TPR）和假阳性率（FPR）。\n\n-   **真阳性率（TPR）**，或称灵敏度，是在患病人群中做出正确阳性预测的概率：$TPR(\\tau) = P(S \\ge \\tau | D)$。\n-   **假阳性率（FPR）**是在非患病人群中做出错误阳性预测的概率：$FPR(\\tau) = P(S \\ge \\tau | N)$。注意，特异度为 $1 - FPR(\\tau)$。\n\n对于有限样本，这些概率通过比例来估计：\n$$TPR(\\tau) = \\frac{\\text{Number of diseased individuals with score} \\ge \\tau}{n_D} = \\frac{TP(\\tau)}{n_D}$$\n$$FPR(\\tau) = \\frac{\\text{Number of non-diseased individuals with score} \\ge \\tau}{n_N} = \\frac{FP(\\tau)}{n_N}$$\n其中 $TP(\\tau)$ 和 $FP(\\tau)$ 分别是在阈值 $\\tau$ 下的真阳性（True Positives）和假阳性（False Positives）计数。\n\n### 步骤 3：经验性 ROC 曲线构建\n\n经验性 ROC 曲线是通过为每个可能的阈值计算 $(FPR, TPR)$ 对来构建的。在有限样本中，相关阈值的集合由数据中存在的唯一评分值组成。为了构建曲线，我们可以将阈值 $\\tau$ 从高于最高分的值扫描到低于最低分的值。\n\n给定的评分为：\n-   患病者 ($S_D$): $\\{0.95, 0.81, 0.77, 0.62\\}$\n-   非患病者 ($S_N$): $\\{0.83, 0.79, 0.70, 0.40\\}$\n\n我们将所有评分合并并按降序排序，同时记下每个评分的类别：\n$0.95 (D), 0.83 (N), 0.81 (D), 0.79 (N), 0.77 (D), 0.70 (N), 0.62 (D), 0.40 (N)$。\n\n现在，我们改变阈值 $\\tau$ 并计算 $TP$ 和 $FP$ 的累积计数，以及相应的比率 $TPR$ 和 $FPR$。ROC 曲线从 $(0,0)$（对于 $\\tau > \\max(S)$）开始，到 $(1,1)$（对于 $\\tau \\le \\min(S)$）结束。\n\n1.  **初始点：** 对于任何 $\\tau > 0.95$，没有评分 $\\ge \\tau$。因此，$TP=0, FP=0$。这给出了点 $(FPR, TPR) = (0/4, 0/4) = (0, 0)$。\n\n2.  **阈值 $\\tau$ 越过 $0.95$ (D)：** 对于 $0.83  \\tau \\le 0.95$，一个患病病例的评分 $\\ge \\tau$。$TP=1, FP=0$。这给出了点 $(0/4, 1/4) = (0, 0.25)$。曲线从 $(0,0)$ 向上移动到 $(0,0.25)$。\n\n3.  **阈值 $\\tau$ 越过 $0.83$ (N)：** 对于 $0.81  \\tau \\le 0.83$，一个患病病例和一个非患病对照的评分 $\\ge \\tau$。$TP=1, FP=1$。这给出了点 $(1/4, 1/4) = (0.25, 0.25)$。曲线从 $(0,0.25)$ 向右移动到 $(0.25,0.25)$。\n\n4.  **阈值 $\\tau$ 越过 $0.81$ (D)：** 对于 $0.79  \\tau \\le 0.81$，$TP=2, FP=1$。点：$(1/4, 2/4) = (0.25, 0.5)$。\n\n5.  **阈值 $\\tau$ 越过 $0.79$ (N)：** 对于 $0.77  \\tau \\le 0.79$，$TP=2, FP=2$。点：$(2/4, 2/4) = (0.5, 0.5)$。\n\n6.  **阈值 $\\tau$ 越过 $0.77$ (D)：** 对于 $0.70  \\tau \\le 0.77$，$TP=3, FP=2$。点：$(2/4, 3/4) = (0.5, 0.75)$。\n\n7.  **阈值 $\\tau$ 越过 $0.70$ (N)：** 对于 $0.62  \\tau \\le 0.70$，$TP=3, FP=3$。点：$(3/4, 3/4) = (0.75, 0.75)$。\n\n8.  **阈值 $\\tau$ 越过 $0.62$ (D)：** 对于 $0.40  \\tau \\le 0.62$，$TP=4, FP=3$。点：$(3/4, 4/4) = (0.75, 1.0)$。\n\n9.  **阈值 $\\tau$ 越过 $0.40$ (N)：** 对于 $\\tau \\le 0.40$，所有评分都 $\\ge \\tau$。$TP=4, FP=4$。点：$(4/4, 4/4) = (1.0, 1.0)$。\n\n经验性 ROC 曲线的顶点是以下点序列：\n$P_0=(0, 0)$, $P_1=(0, 0.25)$, $P_2=(0.25, 0.25)$, $P_3=(0.25, 0.5)$, $P_4=(0.5, 0.5)$, $P_5=(0.5, 0.75)$, $P_6=(0.75, 0.75)$, $P_7=(0.75, 1.0)$, $P_8=(1.0, 1.0)$。\n\n### 步骤 4：处理并列评分\n\n问题要求解释如何处理并列评分。首先，我们注意到在给定的数据集中，患病和非患病个体之间没有相同的评分，两个组内部也没有。所有 $n_D + n_N = 8$ 个评分都是唯一的。\n\n在存在并列值的一般情况下，假设评分值 $s^*$ 被 $k_D$ 个患病个体和 $k_N$ 个非患病个体共享。当决策阈值 $\\tau$ 降低到 $s^*$ 以下时，所有这些个体都同时被重新分类为阳性。这导致真阳性计数在一步之内增加 $k_D$，假阳性计数增加 $k_N$。\n\n如果在此阈值之前的 ROC 曲线上一点是 $(FPR_{i-1}, TPR_{i-1})$，那么新的点变为：\n$$FPR_i = FPR_{i-1} + \\frac{k_N}{n_N}$$\n$$TPR_i = TPR_{i-1} + \\frac{k_D}{n_D}$$\n这会在 ROC 图上产生一条连接 $(FPR_{i-1}, TPR_{i-1})$ 到 $(FPR_i, TPR_i)$ 的单一对角线段。这个过程确保了 ROC 曲线及其面积是良定义的。\n\n### 步骤 5：AUC 计算\n\n曲线下面积（AUC）是 ROC 函数 $TPR(FPR)$ 从 $FPR=0$ 到 $FPR=1$ 的积分。对于由一组顶点 $(x_i, y_i) = (FPR_i, TPR_i)$ 定义的经验性 ROC 曲线，AUC 可以通过对每对连续顶点与 FPR 轴形成的梯形面积求和来计算。具有顶点 $(x_{i-1}, y_{i-1})$ 和 $(x_i, y_i)$ 的梯形面积由下式给出：\n$$Area_i = \\frac{y_{i-1} + y_i}{2} (x_i - x_{i-1})$$\n总 AUC 是曲线上所有线段的这些面积之和。使用上面推导出的顶点 $P_0, \\dots, P_8$：\n\n-   线段 $P_0 \\to P_1$：$x_0=0, y_0=0$；$x_1=0, y_1=0.25$。面积 = $\\frac{0+0.25}{2}(0-0) = 0$。\n-   线段 $P_1 \\to P_2$：$x_1=0, y_1=0.25$；$x_2=0.25, y_2=0.25$。面积 = $\\frac{0.25+0.25}{2}(0.25-0) = 0.25 \\times 0.25 = 0.0625$。\n-   线段 $P_2 \\to P_3$：$x_2=0.25, y_2=0.25$；$x_3=0.25, y_3=0.5$。面积 = $\\frac{0.25+0.5}{2}(0.25-0.25) = 0$。\n-   线段 $P_3 \\to P_4$：$x_3=0.25, y_3=0.5$；$x_4=0.5, y_4=0.5$。面积 = $\\frac{0.5+0.5}{2}(0.5-0.25) = 0.5 \\times 0.25 = 0.125$。\n-   线段 $P_4 \\to P_5$：$x_4=0.5, y_4=0.5$；$x_5=0.5, y_5=0.75$。面积 = $\\frac{0.5+0.75}{2}(0.5-0.5) = 0$。\n-   线段 $P_5 \\to P_6$：$x_5=0.5, y_5=0.75$；$x_6=0.75, y_6=0.75$。面积 = $\\frac{0.75+0.75}{2}(0.75-0.5) = 0.75 \\times 0.25 = 0.1875$。\n-   线段 $P_6 \\to P_7$：$x_6=0.75, y_6=0.75$；$x_7=0.75, y_7=1.0$。面积 = $\\frac{0.75+1.0}{2}(0.75-0.75) = 0$。\n-   线段 $P_7 \\to P_8$：$x_7=0.75, y_7=1.0$；$x_8=1.0, y_8=1.0$。面积 = $\\frac{1.0+1.0}{2}(1.0-0.75) = 1.0 \\times 0.25 = 0.25$。\n\n总 AUC 是非零面积部分的总和：\n$$AUC = 0.0625 + 0.125 + 0.1875 + 0.25 = 0.625$$\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$AUC = 0.6250$$",
            "answer": "$$\\boxed{0.6250}$$"
        }
    ]
}