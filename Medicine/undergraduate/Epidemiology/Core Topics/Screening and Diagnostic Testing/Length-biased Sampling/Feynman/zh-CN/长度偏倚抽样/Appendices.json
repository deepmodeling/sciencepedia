{
    "hands_on_practices": [
        {
            "introduction": "这项练习将我们置于一个假设但合理的流行病学情景中。我们将探讨一种暴露因素如何仅仅通过影响疾病的持续时间，而非其发病率，就在横断面研究中产生误导性的关联。这个实践突出了理解长度偏倚对于正确解读研究结果至关重要，揭示了从患病率数据中观察到的关联可能具有欺骗性。",
            "id": "4606204",
            "problem": "在一个人口规模恒定的封闭、稳态社区中，研究一种慢性传染病。设 $E \\in \\{0,1\\}$ 表示暴露状态，其中 $E=1$ 表示有暴露，$E=0$ 表示无暴露。假设以下科学上真实的条件成立：\n- 在任何时刻，该疾病都是罕见的。\n- 两个暴露分层的瞬时发病率（每人年）相同，均等于 $\\lambda = 0.01$。\n- 暴露对发病率没有影响（因此比较 $E=1$ 与 $E=0$ 的发病率比为 $1$），但它通过加速康复将平均病程缩短一半。具体来说，未暴露者的平均病程为 $\\bar{D}_{0} = 2$ 年，而暴露者的平均病程为 $\\bar{D}_{1} = 1$ 年。\n- 系统处于稳态，随日历时间推移，$\\lambda$、$\\bar{D}_{0}$ 和 $\\bar{D}_{1}$ 均为常数，且无净迁移。\n\n在任意一个日历时间点进行一次横断面调查，以确定每个个体当前是否为现患病例。设 $p_{1}$ 和 $p_{0}$ 分别表示暴露组和未暴露组的预期患病率。仅使用稳态和罕见病条件下的发病率和患病率的基本定义，计算此次横断面调查中暴露组与未暴露组比较的患病率比值比（odds ratio, OR）：\n$$\n\\text{OR}_{\\text{prev}} \\;=\\; \\frac{\\frac{p_{1}}{1 - p_{1}}}{\\frac{p_{0}}{1 - p_{0}}}.\n$$\n最终数值答案中不需要解释偏倚方向，但你的推导过程应明确指出患病率比值比相对于真实的发病零效应是偏离零值还是趋向零值。将最终的比值比表示为精确值（不进行四舍五入）。将比值比报告为纯数（无单位）。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个在理论流行病学中具有科学依据、提法恰当且客观的问题。它提供了一个经典场景，用以阐释患病率研究中病程偏倚抽样（length-biased sampling）的概念，其中所有必要信息都已给出，以推导出一个唯一的、有意义的解。\n\n该问题要求根据在一个稳态人群中进行的横断面调查，计算患病率比值比（$\\text{OR}_{\\text{prev}}$）。在给定的稳态和罕见病条件下，其核心关联原理是患病率（$p$）、发病率（$\\lambda$）和平均病程（$\\bar{D}$）之间的关系。\n\n在稳态人群中，进入患病状态的个体速率（发病）必须与离开该状态的个体速率（康复或死亡）相平衡。对于一种罕见病，在特定分层中，易感个体的数量约等于总人口规模。这种关系可以表示为：\n$$\np \\approx \\lambda \\times \\bar{D}\n$$\n问题陈述明确指出了“罕见病条件”，表明应使用此近似。为此推导目的，我们可以将此近似视为等式，这是此类理论问题的标准做法。\n\n设下标 $0$ 和 $1$ 分别表示未暴露组（$E=0$）和暴露组（$E=1$）。我们已知：\n- 两个分层的发病率相同：$\\lambda = 0.01 \\text{ 年}^{-1}$。\n- 未暴露组的平均病程为 $\\bar{D}_{0} = 2 \\text{ 年}$。\n- 暴露组的平均病程为 $\\bar{D}_{1} = 1 \\text{ 年}$。\n\n使用该基本关系，我们可以计算每个分层的患病率：\n\n对于未暴露组（$E=0$）：\n$$\np_{0} = \\lambda \\times \\bar{D}_{0} = (0.01 \\text{ year}^{-1}) \\times (2 \\text{ years}) = 0.02\n$$\n\n对于暴露组（$E=1$）：\n$$\np_{1} = \\lambda \\times \\bar{D}_{1} = (0.01 \\text{ year}^{-1}) \\times (1 \\text{ year}) = 0.01\n$$\n\n患病率 $p_{0}=0.02$ 和 $p_{1}=0.01$ 均很小，这证实了罕见病假设的一致性。\n\n患病率比值比 $\\text{OR}_{\\text{prev}}$ 定义为暴露组的患病比值除以未暴露组的患病比值。在患病率为 $p$ 的组中，患病比值为 $\\frac{p}{1-p}$。\n因此，比值比的公式为：\n$$\n\\text{OR}_{\\text{prev}} = \\frac{\\frac{p_{1}}{1 - p_{1}}}{\\frac{p_{0}}{1 - p_{0}}}\n$$\n\n将计算出的患病率值代入此公式：\n$$\n\\text{OR}_{\\text{prev}} = \\frac{\\frac{0.01}{1 - 0.01}}{\\frac{0.02}{1 - 0.02}}\n$$\n$$\n\\text{OR}_{\\text{prev}} = \\frac{\\frac{0.01}{0.99}}{\\frac{0.02}{0.98}}\n$$\n\n为简化这个繁分数，我们将分子乘以分母的倒数：\n$$\n\\text{OR}_{\\text{prev}} = \\frac{0.01}{0.99} \\times \\frac{0.98}{0.02}\n$$\n$$\n\\text{OR}_{\\text{prev}} = \\frac{0.01 \\times 0.98}{0.02 \\times 0.99} = \\frac{1 \\times 0.98}{2 \\times 0.99} = \\frac{0.98}{1.98}\n$$\n\n为了将其表示为整数的精确分数，我们可以写成：\n$$\n\\text{OR}_{\\text{prev}} = \\frac{98}{198}\n$$\n将分子和分母同时除以它们的最大公约数 $2$：\n$$\n\\text{OR}_{\\text{prev}} = \\frac{49}{99}\n$$\n\n分析偏倚的来源是有启发性的。衡量发病关联的真实指标是发病率比（IRR），其计算如下：\n$$\n\\text{IRR} = \\frac{\\lambda_{\\text{exposed}}}{\\lambda_{\\text{unexposed}}} = \\frac{0.01}{0.01} = 1\n$$\nIRR 为 $1$ 表示暴露与疾病发病之间没有关联（零效应）。然而，患病率比值比为 $\\frac{49}{99} \\approx 0.495$，小于 $1$。这表明存在一种虚假的保护效应。该估计值偏离了零值 $1$。这种偏倚的产生是因为横断面调查确定的是现患病例。现患病例是新发病例的一个“病程偏倚”样本，意味着病程较长的病例更有可能被抽样到。由于暴露将病程缩短了一半（从 $2$ 年到 $1$ 年），暴露个体一旦患病，其在患病人群中存在的时间更短。因此，即使发病率相同，他们在横断面调查中被计入的可能性也较小，导致暴露组的患病率较低（$p_{1} < p_{0}$）。这种现象是流行病学研究中选择偏倚（具体来说是病程偏倚抽样）的一个经典例子。",
            "answer": "$$\n\\boxed{\\frac{49}{99}}\n$$"
        },
        {
            "introduction": "基于前一个练习的见解，这个问题解决了一个流行病学中的核心任务：估计疾病的发病率。你将看到，使用患病率和观察到的平均病程进行的朴素估计是有偏的，然后通过正确考虑病程数据的长度偏倚特性，你将推导出一个一致的估计量，将著名的 $P = I \\cdot \\mathbb{E}[T]$ 关系与现实世界中的抽样挑战联系起来。",
            "id": "4606282",
            "problem": "一种地方性、非致命的慢性病在一个人数众多且封闭的人群中演变，为方便起见，可将该人群规模归一化为$1$。假设处于稳定状态：发病率$I$（每人每年的新发病例数）在日历时间内恒定，每个患病个体的总病程$T$是独立的，具有有限的均值$\\mathbb{E}[T]$和不依赖于日历时间的概率密度函数（PDF）$f_T(t)$。在日历时间$\\tau$进行的一次横断面调查记录了时点患病率$P$（当前患病人群的比例）。通过招募在时间$\\tau$确定的现患病例并对其进行随访直至病情缓解，您可以观察到每个招募病例的总病程$T$（即从发病到缓解的时间，对于现患病例，这是通过随访将后向和前向复发时间相加重构得出的）。将这些观察到的病程记为$T_1,\\dots,T_n$，其样本均值记为$\\bar{D}_{\\mathrm{obs}}$。\n\n您被告知，相对于新发病例，对现患病例的横断面抽样会过采样较长的病程。\n\na) 仅使用核心定义和稳态假设，推导横断面调查中现患病例总病程$T$的PDF，用$f_T(t)$和$\\mathbb{E}[T]$表示。然后用$T$的前两阶矩表示$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}]$，并证明朴素估计量$\\tilde{I} \\equiv P/\\bar{D}_{\\mathrm{obs}}$是$I$的有偏估计量。用$\\mathbb{E}[T]$和$\\mathbb{E}[T^2]$的封闭形式表示乘性偏差因子（即$\\mathbb{E}[\\tilde{I}]/I$）。\n\nb) 通过建立一个将长度偏倚分布下的期望与$\\mathbb{E}[T]$联系起来的恒等式，说明如何从总病程的长度偏倚样本中恢复$\\mathbb{E}[T]$。基于此恢复步骤，提供一个校正估计量$\\hat{I}$的单一简化表达式，该估计量使用观测到的$P$和$T_1,\\dots,T_n$，并且在稳态模型下是$I$的一致估计量。\n\nc) 一次横断面调查得出$P=0.08$（以分数表示），对在时间$\\tau$观察到的$n=10$个现患病例进行完整随访，得到的总病程（以年为单位）为：$1.2,\\,0.7,\\,3.4,\\,2.1,\\,4.0,\\,5.5,\\,0.9,\\,1.8,\\,2.7,\\,3.0$。使用您在(b)部分得到的估计量，计算校正后的发病率估计值。将您的最终答案四舍五入到四位有效数字。以“每年”为单位表示最终发病率。",
            "solution": "该问题经证实具有科学依据、提法明确且客观。它代表了更新理论和抽样理论在流行病学中的一个标准应用。我们可以进行完整解答。\n\n此问题的核心在于区分新发病例和现患病例的病程分布。由于横断面抽样的性质，病程较长的个体更有可能在调查中被抽中，这种现象被称为长度偏倚抽样。\n\n首先，我们建立稳定状态下患病率$P$、发病率$I$和平均病程$\\mathbb{E}[T]$之间的基本关系。考虑一个规模为$N$的大型人群（归一化为$N=1$）。在任何给定时间，患病人数（现患病例数）为$P \\times N = P$。在稳定状态下，进入患病状态的速率必须等于离开该状态的速率。进入速率是发病率$I$（每人每年的新发病例数）。每年新发病例总数为$I \\times N = I$。离开速率是现患病例数$P$除以其平均病程。要使此关系成立，使用的平均病程必须是新发病例的平均病程，即$\\mathbb{E}[T]$。因此，康复率为$P/\\mathbb{E}[T]$。令流入和流出相等，得到$I = P/\\mathbb{E}[T]$，即著名的公式：\n$$P = I \\cdot \\mathbb{E}[T]$$\n这里，$T$是新发病例中病程的随机变量，其概率密度函数（PDF）为$f_T(t)$，均值$\\mathbb{E}[T]$有限。\n\na) 长度偏倚分布的推导及朴素估计量的偏差。\n\n设$D$为横断面抽样中从现患人群中抽取的病例的总病程的随机变量。观察到病程长度为$t$的个体的概率与$t$本身成正比，因为他们可被抽样的时间更长。病程在$[t, t+dt]$内的新发病例数与$f_T(t)dt$成正比。这些个体中的每一个都会在现患病例库中存在时间$t$。因此，现患病例中病程的密度与$t \\cdot f_T(t)$成正比。\n\n为了找到$D$的PDF（我们记为$f_D(t)$），我们对该关系进行归一化：\n$$f_D(t) = C \\cdot t \\cdot f_T(t)$$\n其中$C$是归一化常数。要使$f_D(t)$成为一个有效的PDF，其在所有可能病程上的积分必须为$1$：\n$$\\int_0^\\infty f_D(t) dt = \\int_0^\\infty C \\cdot t \\cdot f_T(t) dt = 1$$\n$C \\int_0^\\infty t \\cdot f_T(t) dt = 1$。根据定义，该积分是$T$的期望值$\\mathbb{E}[T]$。\n$$C \\cdot \\mathbb{E}[T] = 1 \\implies C = \\frac{1}{\\mathbb{E}[T]}$$\n因此，现患病例中总病程$T$（为清楚起见，此处记为$D$）的PDF为：\n$$f_D(t) = \\frac{t \\cdot f_T(t)}{\\mathbb{E}[T]}$$\n这就是长度偏倚分布。\n\n接下来，我们推导观察到的病程样本均值的期望值$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}]$。观察到的病程$T_1, \\dots, T_n$是从这个长度偏倚分布$f_D(t)$中抽取的独立同分布样本。因此，$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}] = \\mathbb{E}[D]$。\n$$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}] = \\mathbb{E}[D] = \\int_0^\\infty t \\cdot f_D(t) dt = \\int_0^\\infty t \\cdot \\frac{t \\cdot f_T(t)}{\\mathbb{E}[T]} dt$$\n$$\\mathbb{E}[D] = \\frac{1}{\\mathbb{E}[T]} \\int_0^\\infty t^2 \\cdot f_T(t) dt$$\n该积分是$T$的二阶矩$\\mathbb{E}[T^2]$的定义。所以，\n$$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}] = \\frac{\\mathbb{E}[T^2]}{\\mathbb{E}[T]}$$\n\n发病率的朴素估计量是$\\tilde{I} \\equiv P/\\bar{D}_{\\mathrm{obs}}$。为评估其偏差，我们考察其期望值。直接计算$\\mathbb{E}[1/\\bar{D}_{\\mathrm{obs}}]$是复杂的。对于大样本量$n$，通常使用$\\mathbb{E}[1/\\bar{D}_{\\mathrm{obs}}] \\approx 1/\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}]$来近似$\\mathbb{E}[\\tilde{I}]$。\n$$\\mathbb{E}[\\tilde{I}] = \\mathbb{E}\\left[\\frac{P}{\\bar{D}_{\\mathrm{obs}}}\\right] = P \\cdot \\mathbb{E}\\left[\\frac{1}{\\bar{D}_{\\mathrm{obs}}}\\right] \\approx P \\cdot \\frac{1}{\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}]}$$\n代入$\\mathbb{E}[\\bar{D}_{\\mathrm{obs}}]$的表达式：\n$$\\mathbb{E}[\\tilde{I}] \\approx \\frac{P}{\\frac{\\mathbb{E}[T^2]}{\\mathbb{E}[T]}} = \\frac{P \\cdot \\mathbb{E}[T]}{\\mathbb{E}[T^2]}$$\n使用稳态关系$P = I \\cdot \\mathbb{E}[T]$：\n$$\\mathbb{E}[\\tilde{I}] \\approx \\frac{(I \\cdot \\mathbb{E}[T]) \\cdot \\mathbb{E}[T]}{\\mathbb{E}[T^2]} = I \\cdot \\frac{(\\mathbb{E}[T])^2}{\\mathbb{E}[T^2]}$$\n乘性偏差因子是比率$\\mathbb{E}[\\tilde{I}] / I$：\n$$\\frac{\\mathbb{E}[\\tilde{I}]}{I} \\approx \\frac{(\\mathbb{E}[T])^2}{\\mathbb{E}[T^2]}$$\n由于对于任何非恒定病程，$T$的方差$\\text{Var}(T) = \\mathbb{E}[T^2] - (\\mathbb{E}[T])^2$必须为正，我们有$\\mathbb{E}[T^2] > (\\mathbb{E}[T])^2$。这意味着偏差因子小于$1$，因此朴素估计量$\\tilde{I}$是有偏的，并且系统性地低估了真实发病率$I$。\n\nb) 发病率的校正估计量。\n\n为了校正偏差，我们需要一个从长度偏倚的病程样本$T_1, \\dots, T_n$中得到的$\\mathbb{E}[T]$的无偏估计量。让我们考察单个长度偏倚病程$D$的倒数的期望。\n$$\\mathbb{E}\\left[\\frac{1}{D}\\right] = \\int_0^\\infty \\frac{1}{t} f_D(t) dt = \\int_0^\\infty \\frac{1}{t} \\left(\\frac{t \\cdot f_T(t)}{\\mathbb{E}[T]}\\right) dt$$\n$$\\mathbb{E}\\left[\\frac{1}{D}\\right] = \\frac{1}{\\mathbb{E}[T]} \\int_0^\\infty f_T(t) dt$$\n由于$f_T(t)$是一个PDF，$\\int_0^\\infty f_T(t) dt = 1$。这就得到了关键的恒等式：\n$$\\mathbb{E}\\left[\\frac{1}{D}\\right] = \\frac{1}{\\mathbb{E}[T]}$$\n这个恒等式使我们能够将$\\mathbb{E}[T]$恢复为$\\mathbb{E}[T] = 1 / \\mathbb{E}[1/D]$。\n基于此，我们可以构建$\\mathbb{E}[T]$的一致估计量。根据大数定律，观测病程倒数的样本均值是$\\mathbb{E}[1/D]$的一致估计量：\n$$\\frac{1}{n} \\sum_{i=1}^n \\frac{1}{T_i} \\xrightarrow{p} \\mathbb{E}\\left[\\frac{1}{D}\\right] = \\frac{1}{\\mathbb{E}[T]}$$\n因此，$\\mathbb{E}[T]$的一个一致估计量是样本的调和平均数：\n$$\\widehat{\\mathbb{E}[T]} = \\left( \\frac{1}{n} \\sum_{i=1}^n \\frac{1}{T_i} \\right)^{-1}$$\n现在我们可以通过将此代入基本关系$I = P/\\mathbb{E}[T]$来构建一个校正的、一致的发病率$I$的估计量，记为$\\hat{I}$：\n$$\\hat{I} = \\frac{P}{\\widehat{\\mathbb{E}[T]}} = \\frac{P}{\\left( \\frac{1}{n} \\sum_{i=1}^n \\frac{1}{T_i} \\right)^{-1}}$$\n简化此表达式得到校正后的估计量：\n$$\\hat{I} = P \\cdot \\left( \\frac{1}{n} \\sum_{i=1}^n \\frac{1}{T_i} \\right) = \\frac{P}{n} \\sum_{i=1}^n \\frac{1}{T_i}$$\n\nc) 校正后发病率估计值的计算。\n\n我们已知以下数据：\n- 时点患病率$P = 0.08$\n- 样本量$n = 10$\n- 观察到的病程（以年为单位）：$T_i \\in \\{1.2, 0.7, 3.4, 2.1, 4.0, 5.5, 0.9, 1.8, 2.7, 3.0\\}$\n\n我们使用在(b)部分推导出的校正估计量$\\hat{I}$：\n$$\\hat{I} = \\frac{P}{n} \\sum_{i=1}^n \\frac{1}{T_i} = \\frac{0.08}{10} \\sum_{i=1}^{10} \\frac{1}{T_i}$$\n首先，我们计算病程倒数之和：\n$$\\sum_{i=1}^{10} \\frac{1}{T_i} = \\frac{1}{1.2} + \\frac{1}{0.7} + \\frac{1}{3.4} + \\frac{1}{2.1} + \\frac{1}{4.0} + \\frac{1}{5.5} + \\frac{1}{0.9} + \\frac{1}{1.8} + \\frac{1}{2.7} + \\frac{1}{3.0}$$\n$$\\sum_{i=1}^{10} \\frac{1}{T_i} \\approx 0.83333 + 1.42857 + 0.29412 + 0.47619 + 0.25000 + 0.18182 + 1.11111 + 0.55556 + 0.37037 + 0.33333$$\n$$\\sum_{i=1}^{10} \\frac{1}{T_i} \\approx 5.83440$$\n现在，我们计算发病率估计值：\n$$\\hat{I} = 0.008 \\times 5.83440 \\approx 0.0466752$$\n四舍五入到四位有效数字，我们得到：\n$$\\hat{I} \\approx 0.04668$$\n单位是“每年”，因为$P$是无量纲的，而每个$1/T_i$项的单位是“年$^{-1}$”。校正后的发病率约为每人每年$0.04668$。",
            "answer": "$$\\boxed{0.04668}$$"
        },
        {
            "introduction": "我们最后的练习将深入探讨统计理论的核心。假设疾病持续时间服从一个已知的指数分布，你将推导出长度偏倚分布的精确数学形式。然后，你将利用这个校正后的分布来构建一个似然函数，并找到疾病参数的最大似然估计（MLE），从而展示一种处理有偏数据的强大而通用的方法。",
            "id": "4606274",
            "problem": "考虑一项流行病学中的横断面（流行）研究，其中在某一固定日历时间点对患有持续性疾病的个体进行抽样。假设总病程持续时间的真实分布为指数分布，其密度函数为 $f(t;\\lambda) = \\lambda \\exp(-\\lambda t)$，$t \\geq 0$，其中 $\\lambda > 0$ 是风险参数。在流行抽样中，持续时间较长的病程更有可能被抽中，从而产生长度偏倚抽样：纳入概率与病程持续时间成正比。从长度偏倚抽样的基本定义出发——即与持续时间成比例的抽样下的观测密度是原始密度经持续时间加权并由期望持续时间归一化得到的——请用 $f(t;\\lambda)$ 和 $E_{\\lambda}[T]$ 表示，推导出长度偏倚密度 $g(t;\\lambda)$。然后，假设您从这个长度偏倚分布中观测到独立的病程持续时间 $t_{1}, t_{2}, \\ldots, t_{n}$。请写出使用您推导的长度偏倚密度的关于 $\\lambda$ 的校正似然函数，并求出 $\\lambda$ 的最大似然估计量 (MLE) 的封闭形式解。您的最终答案必须是一个仅包含 $n$ 和 $\\sum_{i=1}^{n} t_{i}$ 的解析表达式。最终表达式中不需要数值取整，也不需要单位。",
            "solution": "### 解答推导\n\n解答过程分三个阶段进行：首先，我们推导长度偏倚概率密度函数 $g(t;\\lambda)$；其次，我们根据观测数据构建似然函数；最后，我们最大化该似然函数以求得 $\\lambda$ 的最大似然估计量。\n\n**1. 推导长度偏倚密度 $g(t;\\lambda)$**\n\n问题给出了长度偏倚密度的公式：\n$$\ng(t;\\lambda) = \\frac{t \\cdot f(t;\\lambda)}{E_{\\lambda}[T]}\n$$\n其中 $T$ 是一个服从原始指数分布的随机变量，其密度为 $f(t;\\lambda) = \\lambda \\exp(-\\lambda t)$。\n\n首先，我们必须计算指数分布的期望持续时间 $E_{\\lambda}[T]$。\n$$\nE_{\\lambda}[T] = \\int_{0}^{\\infty} t \\cdot f(t;\\lambda) \\, dt = \\int_{0}^{\\infty} t \\cdot \\lambda \\exp(-\\lambda t) \\, dt\n$$\n我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$。令 $u = t$ 且 $dv = \\lambda \\exp(-\\lambda t) \\, dt$。则 $du = dt$ 且 $v = -\\exp(-\\lambda t)$。\n$$\nE_{\\lambda}[T] = \\left[-t \\exp(-\\lambda t)\\right]_{0}^{\\infty} - \\int_{0}^{\\infty} (-\\exp(-\\lambda t)) \\, dt\n$$\n第一项的计算结果为 $0$：\n$$\n\\lim_{t \\to \\infty} (-t \\exp(-\\lambda t)) - (-0 \\cdot \\exp(0)) = 0 - 0 = 0\n$$\n其中极限是使用洛必达法则求得的。第二项变为：\n$$\n\\int_{0}^{\\infty} \\exp(-\\lambda t) \\, dt = \\left[-\\frac{1}{\\lambda} \\exp(-\\lambda t)\\right]_{0}^{\\infty} = \\left(0 - \\left(-\\frac{1}{\\lambda}\\right)\\right) = \\frac{1}{\\lambda}\n$$\n因此，期望持续时间为 $E_{\\lambda}[T] = \\frac{1}{\\lambda}$。\n\n现在我们将这个结果和 $f(t;\\lambda)$ 的表达式代入 $g(t;\\lambda)$ 的公式中：\n$$\ng(t;\\lambda) = \\frac{t \\cdot (\\lambda \\exp(-\\lambda t))}{\\frac{1}{\\lambda}} = \\lambda^2 t \\exp(-\\lambda t)\n$$\n这是对于 $t \\geq 0$ 的观测持续时间 $t_i$ 的密度函数。这是一个形状参数为 $k=2$、率参数为 $\\lambda$ 的伽马分布的PDF。\n\n**2. 构建似然函数**\n\n我们有来自密度为 $g(t;\\lambda)$ 的分布的 $n$ 个独立同分布的观测值 $t_1, t_2, \\ldots, t_n$。似然函数 $L(\\lambda)$ 是在每个观测点处求值的密度函数的乘积：\n$$\nL(\\lambda) = \\prod_{i=1}^{n} g(t_i; \\lambda) = \\prod_{i=1}^{n} \\left(\\lambda^2 t_i \\exp(-\\lambda t_i)\\right)\n$$\n我们可以将依赖于 $\\lambda$ 的项与不依赖于 $\\lambda$ 的项分开：\n$$\nL(\\lambda) = \\left(\\prod_{i=1}^{n} \\lambda^2\\right) \\left(\\prod_{i=1}^{n} t_i\\right) \\left(\\prod_{i=1}^{n} \\exp(-\\lambda t_i)\\right)\n$$\n$$\nL(\\lambda) = (\\lambda^2)^n \\left(\\prod_{i=1}^{n} t_i\\right) \\exp\\left(-\\sum_{i=1}^{n} \\lambda t_i\\right)\n$$\n$$\nL(\\lambda) = \\lambda^{2n} \\left(\\prod_{i=1}^{n} t_i\\right) \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right)\n$$\n\n**3. 求解最大似然估计量 (MLE)**\n\n为了找到使 $L(\\lambda)$ 最大化的 $\\lambda$ 值，更方便的做法是最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$。\n$$\n\\ell(\\lambda) = \\ln\\left(\\lambda^{2n} \\left(\\prod_{i=1}^{n} t_i\\right) \\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right)\\right)\n$$\n利用对数的性质：\n$$\n\\ell(\\lambda) = \\ln(\\lambda^{2n}) + \\ln\\left(\\prod_{i=1}^{n} t_i\\right) + \\ln\\left(\\exp\\left(-\\lambda \\sum_{i=1}^{n} t_i\\right)\\right)\n$$\n$$\n\\ell(\\lambda) = 2n \\ln(\\lambda) + \\sum_{i=1}^{n} \\ln(t_i) - \\lambda \\sum_{i=1}^{n} t_i\n$$\n为了求最大值，我们对 $\\ell(\\lambda)$ 关于 $\\lambda$ 求导，并令其等于 $0$。设 $S = \\sum_{i=1}^{n} t_i$。\n$$\n\\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda} \\left(2n \\ln(\\lambda) + \\sum_{i=1}^{n} \\ln(t_i) - \\lambda S\\right)\n$$\n$$\n\\frac{d\\ell}{d\\lambda} = \\frac{2n}{\\lambda} + 0 - S = \\frac{2n}{\\lambda} - \\sum_{i=1}^{n} t_i\n$$\n将导数设为零以找到临界点，该点对应于最大似然估计量 $\\hat{\\lambda}$：\n$$\n\\frac{2n}{\\hat{\\lambda}} - \\sum_{i=1}^{n} t_i = 0\n$$\n$$\n\\frac{2n}{\\hat{\\lambda}} = \\sum_{i=1}^{n} t_i\n$$\n求解 $\\hat{\\lambda}$ 得到最大似然估计量：\n$$\n\\hat{\\lambda} = \\frac{2n}{\\sum_{i=1}^{n} t_i}\n$$\n为了确认这是一个最大值，我们检查二阶导数：\n$$\n\\frac{d^2\\ell}{d\\lambda^2} = \\frac{d}{d\\lambda} \\left(\\frac{2n}{\\lambda} - \\sum_{i=1}^{n} t_i\\right) = -\\frac{2n}{\\lambda^2}\n$$\n因为 $n > 0$ 且 $\\lambda^2 > 0$，所以二阶导数恒为负。这证实了对数似然函数是凹函数，我们找到的临界点确实是一个最大值。\n\n因此，$\\lambda$ 的最大似然估计量是 $\\frac{2n}{\\sum_{i=1}^{n} t_i}$。",
            "answer": "$$\n\\boxed{\\frac{2n}{\\sum_{i=1}^{n} t_{i}}}\n$$"
        }
    ]
}