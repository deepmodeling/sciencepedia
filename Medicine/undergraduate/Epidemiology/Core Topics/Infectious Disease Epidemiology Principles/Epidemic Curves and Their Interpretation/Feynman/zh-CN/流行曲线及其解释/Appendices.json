{
    "hands_on_practices": [
        {
            "introduction": "在流行病爆发的初期，病例数通常呈指数级增长。本练习旨在将抽象的增长率$r$转化为一个更直观的指标——倍增时间$T_d$，即病例数翻倍所需的时间。通过这个实践，你将学会如何从增长率的统计估计值推导出倍增时间，并量化其不确定性，这是评估疫情增长速度时的一项核心技能。",
            "id": "4590055",
            "problem": "通过汇总每日报告的发病病例来监测疫情暴发，从而构建流行曲线。在易感人群比例较大的早期阶段，预期每日病例数可用指数增长模型 $I(t) = I_{0} \\exp(r t)$ 来近似，其中 $I(t)$ 是时间 $t$ 的预期病例数，$I_{0}$ 是一个正常数，$r$ 是指数增长率。倍增时间 $T_{d}$ 定义为在 $r$ 恒定的情况下，预期病例数翻倍所需的时间间隔。将带有对数连接函数的广义线性模型（GLM）拟合到流行曲线的前 $12$ 天数据，得到增长率估计值 $\\hat{r} = 0.245$ 天$^{-1}$，其标准误为 $s_{r} = 0.021$ 天$^{-1}$。\n\n仅使用指数增长模型和倍增时间的定义，即满足 $I(t + T_{d}) = 2 I(t)$ 的时间 $T_{d}$，推导出 $T_{d}$ 关于 $r$ 的表达式。然后使用一阶不确定性传播（delta方法）推导估计的倍增时间 $\\hat{T}_{d}$ 的近似标准误（用 $\\hat{r}$ 和 $s_{r}$ 表示）。最后，使用 $\\hat{r} = 0.245$ 计算估计的倍增时间的数值。将您的答案四舍五入到四位有效数字。最终答案以天为单位表示。",
            "solution": "该问题需要三部分推理：首先，从指数增长模型推导倍增时间 $T_{d}$ 的解析表达式；其次，使用delta方法推导估计的倍增时间标准误 $s_{\\hat{T}_{d}}$ 的表达式；第三，计算估计的倍增时间 $\\hat{T}_{d}$ 的数值。\n\n问题陈述已经过验证，被认为是科学上合理的、适定的、客观的，并包含所有必要的信息以继续进行。\n\n首先，我们推导倍增时间 $T_{d}$ 的表达式。倍增时间定义为病例数翻倍所需的时间间隔。这由方程 $I(t + T_{d}) = 2 I(t)$ 表示。\n时间 $t$ 的预期病例数模型如下：\n$$I(t) = I_{0} \\exp(r t)$$\n其中 $I_{0}$ 是一个正常数，$r$ 是指数增长率。\n\n将此模型代入倍增时间的定义，我们得到：\n$$I_{0} \\exp(r (t + T_{d})) = 2 \\cdot I_{0} \\exp(r t)$$\n由于 $I_{0}$ 是一个正常数，我们可以将等式两边同时除以 $I_{0}$：\n$$\\exp(r (t + T_{d})) = 2 \\exp(r t)$$\n使用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将左边写成：\n$$\\exp(r t) \\exp(r T_{d}) = 2 \\exp(r t)$$\n由于 $\\exp(r t)$ 恒为正，我们可以将等式两边同时除以它：\n$$\\exp(r T_{d}) = 2$$\n为了求解 $T_{d}$，我们对等式两边取自然对数：\n$$\\ln(\\exp(r T_{d})) = \\ln(2)$$\n$$r T_{d} = \\ln(2)$$\n最后，分离出 $T_{d}$ 得到其关于 $r$ 的表达式：\n$$T_{d} = \\frac{\\ln(2)}{r}$$\n\n其次，我们推导估计的倍增时间（记为 $\\hat{T}_{d}$）的近似标准误。估计的倍增时间 $\\hat{T}_{d}$ 与估计的增长率 $\\hat{r}$ 之间的关系由上面推导的公式给出：\n$$\\hat{T}_{d} = f(\\hat{r}) = \\frac{\\ln(2)}{\\hat{r}}$$\n为了求出 $\\hat{T}_{d}$ 的标准误，我们使用一阶不确定性传播公式，也称为delta方法。对于函数 $Y=f(X)$，$Y$ 的方差可以近似为 $\\text{Var}(Y) \\approx (\\frac{df}{dX})^{2} \\text{Var}(X)$。标准误是方差的平方根，因此 $s_{Y} \\approx |\\frac{df}{dX}| s_{X}$。\n在我们的例子中，变量是 $\\hat{r}$，其标准误为 $s_{r}$，函数是 $T_{d}(r) = \\frac{\\ln(2)}{r}$。我们需要计算 $T_{d}$ 关于 $r$ 的导数：\n$$\\frac{dT_{d}}{dr} = \\frac{d}{dr} \\left( \\frac{\\ln(2)}{r} \\right) = \\ln(2) \\frac{d}{dr} (r^{-1})$$\n$$\\frac{dT_{d}}{dr} = \\ln(2) (-1 \\cdot r^{-2}) = -\\frac{\\ln(2)}{r^2}$$\n那么，估计的倍增时间的标准误 $s_{\\hat{T}_{d}}$ 近似为：\n$$s_{\\hat{T}_{d}} \\approx \\left| \\frac{dT_{d}}{dr} \\right|_{r=\\hat{r}} s_{r}$$\n$$s_{\\hat{T}_{d}} \\approx \\left| -\\frac{\\ln(2)}{\\hat{r}^2} \\right| s_{r}$$\n由于增长率 $\\hat{r}$ 是正的，$\\hat{r}^2$ 是正的，并且 $\\ln(2)$ 也是正的。因此，绝对值可以简化为：\n$$s_{\\hat{T}_{d}} \\approx \\frac{\\ln(2)}{\\hat{r}^2} s_{r}$$\n这就是所要求的估计的倍增时间的近似标准误的表达式。\n\n第三，我们计算估计的倍增时间 $\\hat{T}_{d}$ 的数值。我们已知估计的增长率为 $\\hat{r} = 0.245 \\text{ day}^{-1}$。使用 $T_{d}$ 的公式：\n$$\\hat{T}_{d} = \\frac{\\ln(2)}{\\hat{r}}$$\n代入给定的 $\\hat{r}$ 值：\n$$\\hat{T}_{d} = \\frac{\\ln(2)}{0.245} \\text{ 天}$$\n使用 $\\ln(2) \\approx 0.693147$：\n$$\\hat{T}_{d} \\approx \\frac{0.693147}{0.245} \\text{ 天} \\approx 2.829172 \\text{ 天}$$\n问题要求将答案四舍五入到四位有效数字。\n前四位有效数字是 $2$、$8$、$2$ 和 $9$。第五位数字是 $1$，所以我们向下舍入。\n$$\\hat{T}_{d} \\approx 2.829 \\text{ 天}$$",
            "answer": "$$\\boxed{2.829}$$"
        },
        {
            "introduction": "我们观察到的流行曲线（按报告日期）往往不是疾病发生的真实写照（按发病日期），因为从发病到报告存在延迟。本练习探讨了报告延迟如何“平滑”和“右移”真实的发病曲线，这一过程在数学上可以用卷积来描述。通过解决这个问题，你将能够理解并量化报告高峰相对于真实发病高峰的延迟，这是准确解读监测数据的关键一步。",
            "id": "4590082",
            "problem": "一个城市的疫情通过两条每日曲线进行监测：一条是发病日期曲线，另一条是报告日期曲线。发病日期曲线表示预期的发病事件，是一个连续时间函数 $I(t)$（单位：每日病例数），以天为单位的日历时间 $t$ 为中心。每个病例从发病到报告都存在一个独立的报告延迟 $D$（单位：天）。流行病学团队根据病例清单估计，延迟的经验均值为 $\\mathbb{E}[D]=4$ 天，方差为 $\\operatorname{Var}(D)=9$ 天$^{2}$。假设延迟与发病时间无关。\n\n从条件期望的核心定义以及从发病时间 $S$ 到报告时间 $T=S+D$ 的转换出发，推导预期报告日期曲线 $R(t)$ 作为 $I(t)$ 和延迟分布函数的积分表达式。利用这个表达式，论证为什么报告日期曲线是发病日期曲线的平滑和右移版本，并具体解释为什么报告日期曲线的右尾滞后于发病日期曲线的右尾。\n\n然后，将问题具体化到以下情况：发病日期曲线 $I(t)$ 可以很好地用一个关于 $t$ 的缩放正态函数来近似，其均值为 $\\mu_{I}$，方差为 $\\sigma_{I}^{2}$；延迟 $D$ 近似服从正态分布，其均值为 $\\mu_{D}=4$ 天，方差为 $\\sigma_{D}^{2}=9$ 天$^{2}$。在这些假设和独立性条件下，确定报告日期曲线峰值相对于发病日期曲线峰值的日历时间预期位移。\n\n用天数表示您的最终数值答案。无需四舍五入；报告精确值。",
            "solution": "该问题要求推导发病日期曲线和报告日期曲线之间的关系，对这种关系进行解释，并在正态性假设下进行具体计算。问题陈述的验证是第一步。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 发病日期曲线：$I(t)$（每日病例数），一个连续时间函数。\n- 报告日期曲线：$R(t)$，预期的报告日期曲线。\n- 报告延迟：$D$（天），一个随机变量。\n- 延迟均值：$\\mathbb{E}[D] = 4$ 天。\n- 延迟方差：$\\operatorname{Var}(D) = 9$ 天$^2$。\n- 发病时间 $S$ 和报告时间 $T$ 之间的关系：$T = S + D$。\n- 假设：延迟 $D$ 与发病时间 $S$ 无关。\n- 具体化 A：发病曲线 $I(t)$ 是一个缩放正态函数，均值为 $\\mu_{I}$，方差为 $\\sigma_{I}^{2}$。\n- 具体化 B：延迟 $D$ 近似服从正态分布，均值为 $\\mu_{D} = 4$ 天，方差为 $\\sigma_{D}^{2} = 9$ 天$^2$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于流行病学和概率论的基本原理。将报告病例曲线建模为发病率曲线和延迟分布的卷积，是传染病监测中的一种标准且稳健的技术。\n- **适定性**：该问题是适定的。它提供了一个清晰的理论框架和足够的信息来推导所需的表达式并计算最终量。从一般推导到具体案例的推进过程结构逻辑清晰。\n- **客观性**：该问题使用精确、客观和定量的语言陈述。\n- **缺陷分析**：\n  1.  **科学/事实不准确**：无。该模型是对现实的有效且广泛使用的简化。\n  2.  **无法形式化/不相关**：无。该问题可以直接使用概率论进行形式化，并且是流行曲线解释这一主题的核心。\n  3.  **不完整/矛盾**：无。所提供的数据是充分且一致的。例如，一般参数 $\\mathbb{E}[D]=4$ 和 $\\operatorname{Var}(D)=9$ 与第二部分中使用的具体参数 $\\mu_{D}=4$ 和 $\\sigma_{D}^{2}=9$ 一致。\n  4.  **不切实际/不可行**：无。报告延迟的均值和方差对于许多现实世界中的疾病来说是合理的值。\n  5.  **不适定**：无。正态性和独立性的假设导致了峰值位移的唯一稳定解。\n  6.  **伪深刻/琐碎**：无。该问题要求对卷积、期望、方差以及正态分布的性质有扎实的理解。\n  7.  **无法科学验证**：无。推导和结果在数学上是可验证的。\n\n**步骤 3：结论与行动**\n问题被判定为有效。将提供完整解答。\n\n**解题推导**\n\n设 $S$ 为随机选取病例的发病时间随机变量，设 $D$ 为该病例的报告延迟随机变量。则报告时间为随机变量 $T = S + D$。\n\n发病日期曲线 $I(t)$ 代表在时间 $t$ 发病的新病例率。如果我们设 $N$ 为疫情中的总病例数，即 $N = \\int_{-\\infty}^{\\infty} I(\\tau) d\\tau$，那么发病时间 $S$ 的概率密度函数 (PDF) 为 $f_S(s) = \\frac{I(s)}{N}$。类似地，报告日期曲线 $R(t)$ 对应于报告时间 $T$ 的概率密度函数，因此 $T$ 的概率密度函数为 $f_T(t) = \\frac{R(t)}{N}$。\n\n问题陈述延迟 $D$ 与发病时间 $S$ 无关。概率论中的一个基本定理指出，两个独立随机变量之和的概率密度函数是它们各自概率密度函数的卷积。设 $f_D(d)$ 是延迟 $D$ 的概率密度函数。那么报告时间 $T$ 的概率密度函数由下式给出：\n$$f_T(t) = (f_S * f_D)(t) = \\int_{-\\infty}^{\\infty} f_S(s) f_D(t-s) ds$$\n将 $f_S(s)$ 和 $f_T(t)$ 用 $I(s)$ 和 $R(t)$ 的表达式代入：\n$$\\frac{R(t)}{N} = \\int_{-\\infty}^{\\infty} \\frac{I(s)}{N} f_D(t-s) ds$$\n两边乘以 $N$，我们得到预期报告日期曲线 $R(t)$ 的积分表达式：\n$$R(t) = \\int_{-\\infty}^{\\infty} I(s) f_D(t-s) ds$$\n这是发病日期曲线 $I(t)$ 与延迟分布的概率密度函数 $f_D(t)$ 的卷积，通常写作 $R(t) = (I * f_D)(t)$。由于延迟必须为非负数，所以当 $d  0$ 时，$f_D(d) = 0$。这意味着当 $t-s  0$（即 $s > t$）时，$f_D(t-s) = 0$。因此，积分的上限可以设为 $t$：\n$$R(t) = \\int_{-\\infty}^{t} I(s) f_D(t-s) ds$$\n\n接下来，我们论证为什么 $R(t)$ 是 $I(t)$ 的一个平滑和右移的版本。我们分析基础时间分布的均值和方差。报告曲线的平均时间对应于期望 $\\mathbb{E}[T]$，其展宽程度对应于方差 $\\operatorname{Var}(T)$。\n平均发病时间是 $\\mathbb{E}[S]$，平均延迟是 $\\mathbb{E}[D]$。根据期望的线性性质：\n$$\\mathbb{E}[T] = \\mathbb{E}[S+D] = \\mathbb{E}[S] + \\mathbb{E}[D]$$\n由于 $\\mathbb{E}[D]=4  0$，报告的平均时间 $\\mathbb{E}[T]$ 大于发病的平均时间 $\\mathbb{E}[S]$。这意味着整个报告曲线 $R(t)$相对于发病曲线 $I(t)$向右移动（时间上更晚），其中心点晚了 $\\mathbb{E}[D]$ 天。这解释了“右移”属性。\n\n对于“平滑”属性，我们考察方差。由于 $S$ 和 $D$ 是独立的，它们之和的方差等于它们方差的和：\n$$\\operatorname{Var}(T) = \\operatorname{Var}(S+D) = \\operatorname{Var}(S) + \\operatorname{Var}(D)$$\n我们已知 $\\operatorname{Var}(D) = 9 \\text{ days}^2$，这是一个正量。因此，$\\operatorname{Var}(T)  \\operatorname{Var}(S)$。方差是衡量分布离散程度或展宽的指标。与发病时间 $S$ 相比，报告时间 $T$ 的方差更大，意味着报告曲线 $R(t)$ 更为分散，峰值更低（假设两条曲线下的总面积相同）。这种增加展宽并降低峰值的过程正是“平滑”的含义。\n\n报告日期曲线的右尾滞后于发病日期曲线的右尾，这是由卷积运算造成的。从 $R(t) = \\int_{-\\infty}^{t} I(s) f_D(t-s) ds$ 可以看出，在任何时间 $t$，$R(t)$ 的值是发病曲线 $I(s)$ 在过去时刻 $s  t$ 的值的加权平均。即使在发病曲线 $I(t)$ 达到峰值并下降到可忽略的水平之后，$R(t)$ 仍然可以很大。这是因为在疫情高峰期发病的病例可能会经历很长的延迟，这由延迟分布 $f_D(d)$ 的尾部描述。这些长延迟的病例在新的发病停止很久之后仍在继续报告，从而为报告曲线 $R(t)$ 创造了一个更肥、衰减更慢的右尾。\n\n现在，我们具体到两种分布都是正态分布的情况。发病时间 $S$ 服从一个其概率密度函数与 $I(t)$ 成比例的分布，所以我们可以说 $S \\sim \\mathcal{N}(\\mu_{I}, \\sigma_{I}^{2})$。延迟 $D$ 被给定为近似正态分布，$D \\sim \\mathcal{N}(\\mu_{D}, \\sigma_{D}^{2})$，其中 $\\mu_{D}=4$ 且 $\\sigma_{D}^{2}=9$。\n正态分布的一个性质是，两个独立的服从正态分布的随机变量之和也服从正态分布。因此，报告时间 $T=S+D$ 服从正态分布。\n所得分布的均值是两个均值之和：\n$$\\mu_{T} = \\mu_{S} + \\mu_{D} = \\mu_{I} + \\mu_{D}$$\n所得分布的方差是两个方差之和：\n$$\\sigma_{T}^{2} = \\sigma_{S}^{2} + \\sigma_{D}^{2} = \\sigma_{I}^{2} + \\sigma_{D}^{2}$$\n因此，$T \\sim \\mathcal{N}(\\mu_{I} + \\mu_{D}, \\sigma_{I}^{2} + \\sigma_{D}^{2})$。\n\n正态分布的峰值出现在其均值处。\n- 发病日期曲线 $I(t)$ 的峰值出现在时间 $t = \\mu_{I}$。\n- 报告日期曲线 $R(t)$（与 $T$ 的概率密度函数成正比）的峰值出现在时间 $t = \\mu_{T} = \\mu_{I} + \\mu_{D}$。\n\n峰值的日历时间位移是报告曲线峰值时间与发病曲线峰值时间之差：\n$$\\text{Shift} = (\\text{Peak time of } R(t)) - (\\text{Peak time of } I(t)) = \\mu_{T} - \\mu_{I}$$\n代入 $\\mu_{T}$ 的表达式：\n$$\\text{Shift} = (\\mu_{I} + \\mu_{D}) - \\mu_{I} = \\mu_{D}$$\n问题给出了延迟分布的均值，$\\mu_{D} = 4$ 天。因此，峰值的预期位移是 $4$ 天。\n这个位移只取决于延迟分布的均值，而与延迟分布的方差以及发病曲线的参数无关。这一事实是卷积和期望性质的直接结果，这个结论具有普适性，但在正态分布的情况下尤其容易证明。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在分析流行病数据时，将不同区域的数据合并分析是一种常见做法，但这可能隐藏着巨大的风险。本练习通过一个关于有效再生数$R_{t}$的具体例子，揭示了辛普森悖论（Simpson's paradox）在流行病学中的体现：一个总体下降的趋势可能掩盖了局部地区截然相反的增长态势。这个实践将让你亲身体会到数据聚合的潜在误导性，并强调分层分析在揭示真实疫情动态中的重要性。",
            "id": "4590632",
            "problem": "一种传染病正在A、B两个区域传播。假设一个离散时间更新过程，其代际间隔为两点分布，使得区域 $i$ 在时间 $t$ 的总传染力由 $\\Lambda_{t}^{(i)} = w_{1} I_{t-1}^{(i)} + w_{2} I_{t-2}^{(i)}$ 给出，其中 $w_{1} = 0.7$，$w_{2} = 0.3$，$I_{t}^{(i)}$ 是区域 $i$ 在时间 $t$ 的发病数。有效再生数 $R_{t}^{(i)}$ 由更新方程 $I_{t}^{(i)} = R_{t}^{(i)} \\Lambda_{t}^{(i)}$ 定义。合并（汇总）发病数为 $I_{t}^{\\mathrm{agg}} = I_{t}^{(A)} + I_{t}^{(B)}$，合并传染力为 $\\Lambda_{t}^{\\mathrm{agg}} = w_{1} I_{t-1}^{\\mathrm{agg}} + w_{2} I_{t-2}^{\\mathrm{agg}}$，合并再生数为 $R_{t}^{\\mathrm{agg}} = I_{t}^{\\mathrm{agg}} / \\Lambda_{t}^{\\mathrm{agg}}$。\n\n你观察到以下发病数（所有计数均为非负整数）：\n- 区域 A：$I_{-1}^{(A)} = 10$，$I_{0}^{(A)} = 50$，$I_{1}^{(A)} = 40$，$I_{2}^{(A)} = 50$。\n- 区域 B：$I_{-1}^{(B)} = 200$，$I_{0}^{(B)} = 180$，$I_{1}^{(B)} = 160$，$I_{2}^{(B)} = 120$。\n\n根据以上定义：\n- 计算 $R_{1}^{(A)}$、$R_{2}^{(A)}$、$R_{1}^{(B)}$ 和 $R_{2}^{(B)}$。\n- 计算 $R_{1}^{\\mathrm{agg}}$ 和 $R_{2}^{\\mathrm{agg}}$。\n- 简要论证在 $t=1$ 和 $t=2$ 之间，合并趋势是否掩盖了相反的区域趋势（一个区域的 $R_{t}$ 增加，而另一个区域的 $R_{t}$ 减少），并在此背景下阐释辛普森悖论。\n\n作为一种分层建模的修正方法，将每个区域在时间 $t$ 的发病数建模为给定其有效再生数的条件泊松分布，$I_{t}^{(i)} \\mid R_{t}^{(i)} \\sim \\mathrm{Poisson}\\!\\left(R_{t}^{(i)} \\Lambda_{t}^{(i)}\\right)$，并为各区域设置一个共享的共轭伽马先验，$R_{t}^{(i)} \\sim \\mathrm{Gamma}(a,b)$，其中 $a = 10$，$b = 10$。仅使用这些假设和上述发病数数据，推导在此分层伽马-泊松模型下 $R_{2}^{(A)}$ 的后验均值。将最终数值答案四舍五入至四位有效数字。将最终答案表示为无单位量。",
            "solution": "该问题被评估为有效，因为它科学地基于标准的流行病学模型（更新方程），内部一致，并为一组明确定义的计算提供了所有必要的信息。未发现与科学合理性、完整性或客观性相关的缺陷。\n\n该问题按要求分为四个部分进行解答。给定参数为代际间隔权重 $w_{1} = 0.7$ 和 $w_{2} = 0.3$。区域 $i$ 在时间 $t$ 的总传染力为 $\\Lambda_{t}^{(i)} = w_{1} I_{t-1}^{(i)} + w_{2} I_{t-2}^{(i)}$，有效再生数为 $R_{t}^{(i)} = I_{t}^{(i)} / \\Lambda_{t}^{(i)}$。\n\n第1部分：计算各区域的有效再生数。\n\n对于区域A，我们有发病数数据 $I_{-1}^{(A)} = 10$，$I_{0}^{(A)} = 50$，$I_{1}^{(A)} = 40$ 和 $I_{2}^{(A)} = 50$。\n首先，我们计算在时间 $t=1$ 和 $t=2$ 的总传染力：\n$$\n\\Lambda_{1}^{(A)} = w_{1} I_{0}^{(A)} + w_{2} I_{-1}^{(A)} = (0.7)(50) + (0.3)(10) = 35 + 3 = 38\n$$\n$$\n\\Lambda_{2}^{(A)} = w_{1} I_{1}^{(A)} + w_{2} I_{0}^{(A)} = (0.7)(40) + (0.3)(50) = 28 + 15 = 43\n$$\n现在，我们计算有效再生数 $R_{1}^{(A)}$ 和 $R_{2}^{(A)}$：\n$$\nR_{1}^{(A)} = \\frac{I_{1}^{(A)}}{\\Lambda_{1}^{(A)}} = \\frac{40}{38} = \\frac{20}{19} \\approx 1.0526\n$$\n$$\nR_{2}^{(A)} = \\frac{I_{2}^{(A)}}{\\Lambda_{2}^{(A)}} = \\frac{50}{43} \\approx 1.1628\n$$\n\n对于区域B，我们有发病数数据 $I_{-1}^{(B)} = 200$，$I_{0}^{(B)} = 180$，$I_{1}^{(B)} = 160$ 和 $I_{2}^{(B)} = 120$。\n在时间 $t=1$ 和 $t=2$ 的总传染力为：\n$$\n\\Lambda_{1}^{(B)} = w_{1} I_{0}^{(B)} + w_{2} I_{-1}^{(B)} = (0.7)(180) + (0.3)(200) = 126 + 60 = 186\n$$\n$$\n\\Lambda_{2}^{(B)} = w_{1} I_{1}^{(B)} + w_{2} I_{0}^{(B)} = (0.7)(160) + (0.3)(180) = 112 + 54 = 166\n$$\n有效再生数 $R_{1}^{(B)}$ 和 $R_{2}^{(B)}$ 为：\n$$\nR_{1}^{(B)} = \\frac{I_{1}^{(B)}}{\\Lambda_{1}^{(B)}} = \\frac{160}{186} = \\frac{80}{93} \\approx 0.8602\n$$\n$$\nR_{2}^{(B)} = \\frac{I_{2}^{(B)}}{\\Lambda_{2}^{(B)}} = \\frac{120}{166} = \\frac{60}{83} \\approx 0.7229\n$$\n\n第2部分：计算合并有效再生数。\n\n首先，我们计算合并发病数 $I_{t}^{\\mathrm{agg}} = I_{t}^{(A)} + I_{t}^{(B)}$：\n$I_{-1}^{\\mathrm{agg}} = 10 + 200 = 210$\n$I_{0}^{\\mathrm{agg}} = 50 + 180 = 230$\n$I_{1}^{\\mathrm{agg}} = 40 + 160 = 200$\n$I_{2}^{\\mathrm{agg}} = 50 + 120 = 170$\n\n接下来，我们计算合并传染力 $\\Lambda_{t}^{\\mathrm{agg}} = w_{1} I_{t-1}^{\\mathrm{agg}} + w_{2} I_{t-2}^{\\mathrm{agg}}$：\n$$\n\\Lambda_{1}^{\\mathrm{agg}} = w_{1} I_{0}^{\\mathrm{agg}} + w_{2} I_{-1}^{\\mathrm{agg}} = (0.7)(230) + (0.3)(210) = 161 + 63 = 224\n$$\n$$\n\\Lambda_{2}^{\\mathrm{agg}} = w_{1} I_{1}^{\\mathrm{agg}} + w_{2} I_{0}^{\\mathrm{agg}} = (0.7)(200) + (0.3)(230) = 140 + 69 = 209\n$$\n最后，我们计算合并再生数 $R_{1}^{\\mathrm{agg}}$ 和 $R_{2}^{\\mathrm{agg}}$：\n$$\nR_{1}^{\\mathrm{agg}} = \\frac{I_{1}^{\\mathrm{agg}}}{\\Lambda_{1}^{\\mathrm{agg}}} = \\frac{200}{224} = \\frac{25}{28} \\approx 0.8929\n$$\n$$\nR_{2}^{\\mathrm{agg}} = \\frac{I_{2}^{\\mathrm{agg}}}{\\Lambda_{2}^{\\mathrm{agg}}} = \\frac{170}{209} \\approx 0.8134\n$$\n\n第3部分：趋势分析与辛普森悖论。\n\n比较从 $t=1$ 到 $t=2$ 有效再生数的趋势：\n- 区域A：$R_{t}^{(A)}$ 从约 $1.05$ 增加到 $1.16$。这表明疫情增长正在加速。\n- 区域B：$R_{t}^{(B)}$ 从约 $0.86$ 减少到 $0.72$。这表明疫情正在减速（下降）。\n- 合并：$R_{t}^{\\mathrm{agg}}$ 从约 $0.89$ 减少到 $0.81$。这表明总体呈下降趋势。\n\n合并趋势确实掩盖了相反的区域趋势。仅对合并数据进行分析表明，疫情总体上正在减弱，如 $R_{t}^{\\mathrm{agg}}$ 的下降所示。然而，这掩盖了一个关键事实，即在传染性不断增加的区域A，疫情正在加速。这种在汇总后趋势的逆转是辛普森悖论的一个例证。出现这种差异的原因是，区域B的发病数远高于区域A，因此其下降趋势在合并再生数的计算中占主导地位。这表明在对异质群体进行汇总分析时，可能会得出误导性结论。\n\n第4部分：在分层模型下推导 $R_{2}^{(A)}$ 的后验均值。\n\n我们给定一个分层模型，其中再生数 $R$ 的先验是伽马分布，发病数 $I$ 的似然是泊松分布。具体来说，对于区域A在时间 $t=2$ 时，我们有：\n先验：$R_{2}^{(A)} \\sim \\mathrm{Gamma}(a, b)$，其中形状参数 $a=10$，速率参数 $b=10$。\n似然：$I_{2}^{(A)} \\mid R_{2}^{(A)} \\sim \\mathrm{Poisson}(R_{2}^{(A)} \\Lambda_{2}^{(A)})$，其中 $I_{2}^{(A)} = 50$ 且 $\\Lambda_{2}^{(A)} = 43$。\n\n伽马分布是泊松似然的共轭先验。我们可以推导出 $R_{2}^{(A)}$ 的后验分布。令 $R \\equiv R_{2}^{(A)}$，$I \\equiv I_{2}^{(A)}$，以及 $\\Lambda \\equiv \\Lambda_{2}^{(A)}$。\n先验概率密度函数 (PDF) 为 $p(R) = \\frac{b^a}{\\Gamma(a)} R^{a-1} \\exp(-bR)$。\n似然函数为 $L(R \\mid I) = P(I \\mid R) = \\frac{(R\\Lambda)^I \\exp(-R\\Lambda)}{I!}$。\n\n根据贝叶斯定理，后验概率密度函数 $p(R \\mid I)$ 与似然和先验的乘积成正比：\n$p(R \\mid I) \\propto L(R \\mid I) p(R)$\n$p(R \\mid I) \\propto \\left( \\frac{(R\\Lambda)^I \\exp(-R\\Lambda)}{I!} \\right) \\left( \\frac{b^a}{\\Gamma(a)} R^{a-1} \\exp(-bR) \\right)$\n\n我们可以舍去不依赖于 $R$ 的项，以找到后验分布的核：\n$p(R \\mid I) \\propto (R\\Lambda)^I \\exp(-R\\Lambda) R^{a-1} \\exp(-bR)$\n$p(R \\mid I) \\propto R^I \\exp(-R\\Lambda) R^{a-1} \\exp(-bR)$\n$p(R \\mid I) \\propto R^{I+a-1} \\exp(-R(\\Lambda+b))$\n\n这是具有更新后参数的伽马分布的核：\n形状参数：$a' = a + I$\n速率参数：$b' = b + \\Lambda$\n因此，后验分布为 $R \\mid I \\sim \\mathrm{Gamma}(a+I, b+\\Lambda)$。\n\n形状参数为 $a'$、速率参数为 $b'$ 的伽马分布的均值为 $\\mathbb{E}[R] = a'/b'$。因此，$R_{2}^{(A)}$ 的后验均值为：\n$$\n\\mathbb{E}[R_{2}^{(A)} \\mid I_{2}^{(A)}] = \\frac{a + I_{2}^{(A)}}{b + \\Lambda_{2}^{(A)}}\n$$\n代入给定值：$a=10$，$b=10$，$I_{2}^{(A)}=50$，以及 $\\Lambda_{2}^{(A)}=43$。\n$$\n\\mathbb{E}[R_{2}^{(A)} \\mid I_{2}^{(A)}=50] = \\frac{10 + 50}{10 + 43} = \\frac{60}{53}\n$$\n数值约为 $1.13207547...$。四舍五入到四位有效数字，我们得到 $1.132$。",
            "answer": "$$\\boxed{1.132}$$"
        }
    ]
}