## 引言
在公共卫生领域，评估一项暴露因素（如吸烟或环境污染物）的影响时，我们不仅想知道它与疾病的关联有多强，更迫切地想回答一个问题：如果能消除这项暴露，我们究竟能预防多少疾病？从描述[统计关联](@entry_id:172897)到量化干预效果的这一步，正是流行病学中“归因分析”的核心任务。本文旨在系统介绍归因分值（Attributable Fractions）这一关键工具集，以解决上述知识缺口。通过学习本文，读者将深入理解归因分值的内涵及其在公共卫生决策中的重要作用。文章将分为三个核心部分展开：第一章“原则与机制”将详细拆解暴露人群归因分值（$AF_e$）和人群归因分值（$PAF$）的定义、计算方法及其背后的因果推断逻辑；第二章“应用与跨学科联系”将通过真实案例展示归因分值如何用于量化疾病负担、指导政策制定，并探讨其与临床医学、环境科学等领域的交叉；最后，在“动手实践”部分，读者将有机会通过具体问题来巩固和应用所学知识。

## 原则与机制

在流行病学研究中，我们不仅关心暴露与疾病之间的关联强度，更希望量化这种关联在公共卫生层面的重要性。换言之，如果我们能够通过干预措施消除某项有害暴露，或者推广某项保护性暴露，将会在多大程度上降低人群的疾病负担？回答这类“如果……将会怎样？”的问题，需要我们从关联分析走向归因分析。归因分值（Attributable Fractions）正是为此而生的一套核心概念和工具。本章将深入探讨其背后的基本原则与作用机制。

### 从关联到归因：效应量度的区分

在评估暴露与疾病的关系时，两个基本的关联强度指标是相对危险度（Relative Risk, $RR$）和风险差（Risk Difference, $RD$）。相对危险度是暴露组风险（$R_e$）与非暴露组风险（$R_u$）的比值，$RR = R_e / R_u$；风险差则是二者的绝对差值，$RD = R_e - R_u$。

理解这两个指标的量纲属性至关重要。风险本身是一个概率，即在特定时间段内发生疾病的个体数除以期初风险人群总数，它是一个无量纲的比例。因此，$RR$ 作为两个相同单位（比例）的量的比值，其本身也是一个无量纲的纯数。而 $RD$ 作为两个风险的差值，它保留了风险的单位，例如“每十万人中的病例数”或“百分点”。 这种差异决定了它们在交流信息时的不同侧重：$RR$ 衡量的是风险的相对倍数，而 $RD$ 衡量的是风险的绝对增量。

然而，关联不等于因果，这些指标本身只描述了观测数据中的统计关系。要评估公共卫生影响，我们必须引入反事实（counterfactual）的思维框架。归因分值正是建立在这一因果推断框架之上，旨在回答：在暴露人群或整个人群中，有多大比例的疾病可归因于该暴露？或者说，如果通过干预将该暴露消除，能够预防多大比例的病例？

### 暴露人群归因分值 ($AF_e$)

**暴露人群归因分值**（Attributable Fraction among the Exposed, $AF_e$）旨在回答一个非常具体的问题：“在暴露人群所发生的病例中，有多大比例是由该暴露本身所导致的？”

#### 因果定义与可识别性

从因果推断的角度看，要回答这个问题，我们需要比较暴露人群的实际患病风险（$R_e$）与一个反事实情况下的风险——即**同一群暴露者**假如没有被暴露，他们的患病风险会是多少。在潜在结局（potential outcomes）框架下，我们用 $Y^1$ 和 $Y^0$ 分别表示个体在接受暴露（$A=1$）和未接受暴露（$A=0$）时的潜在结局。那么，暴露人群的实际风险是 $P(Y^1=1|A=1)$，根据**一致性 (consistency)** 假设，这等于观测到的风险 $R_e = P(Y=1|A=1)$。他们假如未被暴露的反事实风险则是 $P(Y^0=1|A=1)$。

因此，$AF_e$ 的因果定义是：
$$
AF_{e, \text{causal}} = \frac{P(Y^1=1|A=1) - P(Y^0=1|A=1)}{P(Y^1=1|A=1)} = \frac{R_e - P(Y^0=1|A=1)}{R_e}
$$

这个定义中的反事实风险 $P(Y^0=1|A=1)$ 是无法被直接观测到的。为了从数据中估计它，我们需要一个关键的假设——**可交换性 (exchangeability)**。该假设要求暴露组和非暴露组在基线风险上是可比的，即 $P(Y^0=1|A=1) = P(Y^0=1|A=0)$。这意味着，如果暴露组的人未被暴露，他们的疾病风险将与我们实际观察到的非暴露组的风险相同。在一致性假设下，$P(Y^0=1|A=0)$ 等于观测到的非暴露组风险 $R_u = P(Y=1|A=0)$。因此，在可交换性成立的前提下，我们可以用 $R_u$ 来替代不可观测的反事实风险。

这样，$AF_e$ 的因果定义就与一个可通过观测数据计算的公式联系起来：
$$
AF_e = \frac{R_e - R_u}{R_e} = 1 - \frac{R_u}{R_e} = 1 - \frac{1}{RR}
$$
这个公式之所以有因果意义，完全依赖于其背后的可交换性等假设。

#### 因果解释与计算示例

$AF_e$ 的正确因果解释是：“假设因果关系成立，在暴露人群中，有 $(AF_e \times 100)\%$ 的病例是由于该暴露所致的。换言之，如果我们能通过一项理想干预，将该暴露从这群人中移除，那么他们当中所发生的病例将减少 $(AF_e \times 100)\%$。”

例如，一项队列研究发现，某暴露因素的暴露组风险 $R_e = 0.20$，非暴露组风险 $R_u = 0.05$。在满足可交换性、一致性和阳性（positivity）假设的条件下，我们可以计算 $AF_e$：
$$
AF_e = \frac{0.20 - 0.05}{0.20} = \frac{0.15}{0.20} = 0.75
$$
这里的因果解释是：在暴露人群中，75%的疾病可归因于该暴露。如果能对暴露人群进行干预并移除该暴露，他们中75%的病例本可以被预防。

### 人群归因分值 ($PAF$)

与 $AF_e$ 关注暴露人群不同，**人群归因分值**（Population Attributable Fraction, $PAF$）关注的是整个目标人群。它旨在回答一个更宏观的公共卫生问题：“在总人群发生的所有病例中，有多大比例是由该暴露所导致的？”

#### 因果定义与可识别性

$PAF$ 的概念同样根植于反事实推理。它比较的是当前人群的总体疾病风险（$R_p$）与一个反事实情景下的总体风险——即如果整个人群中的该项暴露被完全消除，人群的疾病风险将会是多少（$R_{cf}$）。

$PAF$ 的因果定义为：
$$
PAF = \frac{R_p - R_{cf}}{R_p} = \frac{P(Y=1) - P(Y^0=1)}{P(Y=1)}
$$
这里，$P(Y=1)$ 是观测到的人群总体风险，$P(Y^0=1)$ 则是如果人群中每个人都被设置为“未暴露”状态下的反事实风险。

要从观测数据中识别 $PAF$，我们首先需要计算 $R_p$。如果已知暴露在人群中的比例为 $p_e$，则非暴露比例为 $1-p_e$。根据[全概率公式](@entry_id:194231)，$R_p$ 是暴露组和非暴露组风险的加权平均值：
$$
R_p = R_e \cdot p_e + R_u \cdot (1-p_e)
$$
接下来，我们需要识别反事实风险 $R_{cf} = P(Y^0=1)$。在与之前相同的[可交换性](@entry_id:263314)等假设下，无论个体实际的暴露状态如何，其在未暴露下的潜在结局风险都被认为与观测到的非暴露组风险 $R_u$ 相同。因此，$R_{cf}$ 可以被 $R_u$ 识别。

于是，我们得到了 $PAF$ 的可识别计算公式：
$$
PAF = \frac{R_p - R_u}{R_p}
$$
归因分值的计算，无论是 $AF_e$ 还是 $PAF$，其分母的选择都至关重要，因为它定义了“归因”的参照系或“整体”是什么。对于 $AF_e$，我们关注的是“暴露人群中的病例”，因此分母是 $R_e$；对于 $PAF$，我们关注的是“总人群中的病例”，因此分母是 $R_p$。

#### 暴露率 ($p_e$) 的关键作用

$PAF$ 的一个核心特征是它不仅取决于暴露的危害程度（由$RR$反映），还严重依赖于暴露在人群中的普遍程度（由$p_e$反映）。我们可以通过代数转换得到一个更能体现这一点的 $PAF$ 公式：
$$
PAF = \frac{p_e(RR - 1)}{1 + p_e(RR - 1)}
$$
这个公式清晰地表明，$PAF$ 是 $p_e$ 和 $RR$ 的函数。 这也带来一个重要的公共卫生洞见：一个危害极强（$RR$ 很大）的暴露因素，如果它在人群中非常罕见（$p_e$ 很小），其对整个人群的疾病负担贡献（$PAF$）可能依然很小。

例如，假设某有害暴露的 $RR = 8$，风险极高，但它是一种罕见暴露，人群暴露率 $p_e = 0.005$。那么其对人群的整体影响为：
$$
PAF = \frac{0.005 \times (8 - 1)}{1 + 0.005 \times (8 - 1)} = \frac{0.035}{1.035} \approx 0.034
$$
这意味着，尽管该暴露能使个体风险增加8倍，但它仅造成了总人群中约3.4%的病例。与之相反，一个中等强度（如 $RR=2$）但非常普遍（如 $p_e=0.5$）的暴露因素，其 $PAF$ 可能要大得多。

继续使用上一节的例子（$R_e=0.20, R_u=0.05$），并假设人群暴露率为 $p_e = 0.40$。首先计算人群总风险：
$$
R_p = (0.20 \times 0.40) + (0.05 \times 0.60) = 0.08 + 0.03 = 0.11
$$
然后计算 $PAF$：
$$
PAF = \frac{R_p - R_u}{R_p} = \frac{0.11 - 0.05}{0.11} = \frac{0.06}{0.11} \approx 0.545
$$
其因果解释为：在该人群中，约54.5%的疾病可归因于该暴露。如果能在全人群中消除此暴露，可以预防约54.5%的病例。

### 归因分值的因果基础

明确区分**关联性归因分值**和**因果性归因分值**至关重要。我们在流行病学研究中计算的任何归因分值，其本质都是一个基于观测数据的统计量，即关联性归因分值。例如，公式 $PAF = (R_p - R_u)/R_p$ 本身只是对观测风险的代数运算。

将其解释为“如果消除暴露将会预防的病例比例”——这样一个具有干预和反事实含义的因果结论，则必须依赖一系列严格的、往往难以完全满足的假设。 一个研究若要声称其计算的归因分值具有因果解释力，必须审慎评估以下核心假设清单：

1.  **定义明确的干预与一致性 (Well-defined Intervention and Consistency)**：我们所说的“消除暴露”必须是一个清晰、可设想的操作。一致性假设要求，个体的观测结局就是其在自身所受暴露水平下的潜在结局。

2.  **[可交换性](@entry_id:263314) (Exchangeability)**：这是“无未测量混杂”的正式表达。它要求暴露组与非暴露组在所有影响结局的基线特征上具有可比性。在观察性研究中，我们通常希望通过对已测量的混杂因素 $L$ 进行调整（如分层或回归）来达到**条件[可交换性](@entry_id:263314)** ($Y^0 \perp A | L$)。随机试验之所以是因果推断的“金标准”，正是因为它通过随机分配过程，在期望上保证了暴露组与非暴露组之间（关于所有基线特征，无论测量与否）的[可交换性](@entry_id:263314)。

3.  **阳性 (Positivity)**：在所有协变量 $L$ 的层级内，都必须有暴露和非暴露的个体存在。如果某个亚组（如“80岁以上男性吸烟者”）中所有人都被暴露，我们就无从知晓这个亚组在不暴露下的情况。

4.  **稳定单位治疗价值假设 (SUTVA)**：该假设包含两个方面：一是无干扰（一个人的暴露状态不影响他人的结局），二是不存在不同版本的暴露（暴露 $A=1$ 对所有人来说是同质的）。

5.  **无测量误差和无选择偏倚**：这包括对暴露、结局和协变量的准确测量，以及研究对象的入组和随访过程没有引入系统性偏倚。

如果这些假设不成立，尤其是[可交换性](@entry_id:263314)被破坏（即存在混杂），那么基于观测数据计算的归因分值将偏离真实的因果值。例如，如果暴露组本身就是高风险人群（即使没有暴露，他们的风险也高于非暴露组），那么直接使用 $R_u$ 作为反事实参照会高估暴露的危害，从而夸大归因分值。反之，如果暴露组是更健康的“幸存”人群，则可能低估其危害，甚至在暴露完全无效时得到一个负的 $AF_e$。

### 实际应用与细微差别

在公共卫生实践中，理解不同归因指标的含义并恰当使用它们至关重要。

#### 绝对影响 vs. 相对影响：$PAR$ 与 $PAF$

除了相对指标 $PAF$ 外，还有一个重要的绝对指标——**人群归因风险差** (Population Attributable Risk, PAR)。它被定义为观察到的人群风险与消除暴露后的反事实风险之差的绝对值。
$$
PAR = R_p - R_{cf}
$$
在可交换性假设下，这等于 $R_p - R_u$。$PAR$ 的单位是风险（例如，每10万人病例数），它代表了消除暴露能在人群层面带来的**绝对风险下降**。

$PAF$ 和 $PAR$ 的关系非常直接：
$$
PAR = PAF \times R_p
$$
$PAF$ 回答的是“多大比例”的问题，而 $PAR$ 回答的是“多少病例”的问题。在规划公共卫生资源时，二者缺一不可。

例如，考虑两个社区 X 和 Y，它们面临同一种暴露，且暴露的 $RR=2.5$、暴露率 $p_e=0.10$ 都相同。因此，它们的 $PAF$ 是相同的。然而，社区 X 的基线风险 $R_0 = 0.05$，而社区 Y 的基线风险较低，为 $R_0 = 0.02$。
- 在社区 X，$RD = R_0(RR-1) = 0.05(1.5) = 0.075$。每10000人中，消除暴露能预防的病例数（与 $PAR$ 成正比）大约是 $10000 \times RD \times p_e = 10000 \times 0.075 \times 0.10 = 75$ 例。
- 在社区 Y，$RD = R_0(RR-1) = 0.02(1.5) = 0.03$。每10000人中，能预防的病例数是 $10000 \times 0.03 \times 0.10 = 30$ 例。

尽管 $PAF$ 相同，提示该暴露在这两个社区的疾病负担中占据同等相对比例，但干预措施在社区 X 能带来的绝对健康收益（预防的病例数）是社区 Y 的2.5倍。因此，仅靠 $PAF$ 来决定干预优先级可能会产生误导，必须结合 $PAR$ 或 $RD$ 等绝对效应量。

#### 保护性暴露：预防分值

当暴露是保护性的（如接种疫苗、健康饮食），即 $RR  1$ 时，我们更关心它“预防了”多少疾病，而非“导致了”多少疾病。此时，归因分值的概念可以镜像应用于**预防分值** (Prevented Fraction)。

**暴露人群预防分值** ($PF_e$) 指在暴露（如接种疫苗）的人群中，由于暴露而得以避免的潜在病例占所有潜在病例的比例。
$$
PF_e = \frac{R_u - R_e}{R_u} = 1 - RR
$$
这个值在疫苗研究中通常被称为**疫苗效力 (vaccine efficacy)**。

**人群预防分值** ($PF_p$) 指在整个人群中，由于该保护性暴露的存在而得以避免的潜在病例占总潜在病例的比例。
$$
PF_p = \frac{R_u - R_p}{R_u}
$$
一个简化的关系是，$PF_p$ 等于暴露人群预防分值与其在人群中普及率的乘积：
$$
PF_p = p_e \times PF_e
$$
例如，一项疫苗研究显示，接种组风险 $R_e=0.005$，未接种组风险 $R_u=0.025$。疫苗在总人群中的接种率为 $p_e=0.60$。
- [疫苗效力](@entry_id:194367) $PF_e = 1 - (0.005 / 0.025) = 1 - 0.2 = 0.80$。即，在接种者中，80%的潜在感染被疫苗预防了。
- 人群预防效果 $PF_p = 0.60 \times 0.80 = 0.48$。即，在当前60%的接种率下，该疫苗项目使整个人群的潜在病例数减少了48%。

总之，归因分值和预防分值是流行病学中将关联研究结果转化为公共卫生影响评估的关键工具。它们本质上是因果性指标，其解释的有效性完全取决于背后一系列严格的、可检验或不可检验的假设。正确理解和审慎使用这些指标，对于科学地制定公共卫生策略至关重要。