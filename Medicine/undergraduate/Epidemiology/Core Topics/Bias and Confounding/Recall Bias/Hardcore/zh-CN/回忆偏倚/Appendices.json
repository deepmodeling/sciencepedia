{
    "hands_on_practices": [
        {
            "introduction": "在着手校正偏倚之前，我们首先需要量化误差的大小。这通常通过“验证子研究”来完成，即将自我报告的数据与“金标准”测量进行比较。这个练习  将向你展示如何利用验证研究的原始数据，为病例组和对照组分别计算灵敏度（$Se$）和特异度（$Sp$），并使用约登指数（Youden's $J$）等指标来评估分类的准确性。",
            "id": "4629116",
            "problem": "一项病例对照验证子研究旨在评估相对于生物标志物金标准的自我报告暴露中的回忆偏倚。设 $Y \\in \\{0,1\\}$ 表示结局状态，其中 $Y=1$ 为病例，$Y=0$ 为对照。对于 $Y$ 的每一层，您观察到自我报告暴露与来自生物标志物的真实暴露的 $2 \\times 2$ 交叉分类。计数如下：\n\n对于病例 ($Y=1$; 总计 $200$):\n- 真实暴露 ($E=1$): $100$ 人报告暴露，$20$ 人报告未暴露。\n- 真实未暴露 ($E=0$): $12$ 人报告暴露，$68$ 人报告未暴露。\n\n对于对照 ($Y=0$; 总计 $250$):\n- 真实暴露 ($E=1$): $70$ 人报告暴露，$30$ 人报告未暴露。\n- 真实未暴露 ($E=0$): $30$ 人报告暴露，$120$ 人报告未暴露。\n\n使用这些数据：\n- 计算 $Y$ 每一层内暴露分类的观察一致性 $P_{o}$ 和科恩 kappa 系数 $\\kappa$。\n- 将一致性信息转化为 $Y$ 每一层内自我报告暴露相对于生物标志物的敏感性 ($\\mathrm{Se}$) 和特异性 ($\\mathrm{Sp}$) 的估计值。\n- 计算每一层的尤登指数 $J$，其中 $J = \\mathrm{Se} + \\mathrm{Sp} - 1$。\n\n将单一数值 $J_{Y=1} - J_{Y=0}$ 作为您的最终答案报告。最终答案以精确分数或小数表示；无需四舍五入。",
            "solution": "将对由结局变量 $Y$ 定义的两个分层分别进行分析：病例 ($Y=1$) 和对照 ($Y=0$)。设 $R$ 表示自我报告的暴露状态（$R=1$ 为报告暴露，$R=0$ 为报告未暴露），设 $E$ 表示由生物标志物确定的真实暴露状态（$E=1$ 为真实暴露，$E=0$ 为真实未暴露）。\n\n对于一个通用的 $2 \\times 2$ 计数表：\n$$\n\\begin{array}{c|cc|c}\n  E=1  E=0  \\text{合计} \\\\\n\\hline\nR=1  a  b  a+b \\\\\nR=0  c  d  c+d \\\\\n\\hline\n\\text{合计}  a+c  b+d  n=a+b+c+d\n\\end{array}\n$$\n各项指标定义如下：\n- 敏感性: $\\mathrm{Se} = P(R=1|E=1) = \\frac{a}{a+c}$\n- 特异性: $\\mathrm{Sp} = P(R=0|E=0) = \\frac{d}{b+d}$\n- 观察一致性: $P_o = \\frac{a+d}{n}$\n- 期望机遇一致性: $P_e = \\frac{(a+b)(a+c)}{n^2} + \\frac{(c+d)(b+d)}{n^2}$\n- 科恩 kappa 系数: $\\kappa = \\frac{P_o - P_e}{1 - P_e}$\n- 尤登指数: $J = \\mathrm{Se} + \\mathrm{Sp} - 1$\n\n我们现在将这些定义应用于每个分层。\n\n**第 1 层：病例 ($Y=1$)**\n\n病例 ($n_1 = 200$) 的数据可整理为以下列联表：\n$$\n\\begin{array}{c|cc|c}\n\\text{病例 } (Y=1)  E=1  E=0  \\text{合计} \\\\\n\\hline\nR=1  a_1=100  b_1=12  112 \\\\\nR=0  c_1=20  d_1=68  88 \\\\\n\\hline\n\\text{合计}  120  80  n_1=200\n\\end{array}\n$$\n\n首先，我们按要求计算一致性指标。\n- 观察一致性:\n$$P_{o,1} = \\frac{a_1+d_1}{n_1} = \\frac{100+68}{200} = \\frac{168}{200} = 0.84$$\n- 期望一致性:\n$$P_{e,1} = \\frac{(112)(120) + (88)(80)}{200^2} = \\frac{13440 + 7040}{40000} = \\frac{20480}{40000} = 0.512$$\n- 科恩 kappa 系数:\n$$\\kappa_1 = \\frac{P_{o,1} - P_{e,1}}{1 - P_{e,1}} = \\frac{0.84 - 0.512}{1 - 0.512} = \\frac{0.328}{0.488} \\approx 0.6721$$\n\n接下来，我们计算病例子层的敏感性、特异性和尤登指数。\n- 敏感性:\n$$\\mathrm{Se}_{1} = \\frac{a_1}{a_1+c_1} = \\frac{100}{100+20} = \\frac{100}{120} = \\frac{5}{6}$$\n- 特异性:\n$$\\mathrm{Sp}_{1} = \\frac{d_1}{b_1+d_1} = \\frac{68}{12+68} = \\frac{68}{80} = \\frac{17}{20}$$\n- 尤登指数:\n$$J_{1} = \\mathrm{Se}_{1} + \\mathrm{Sp}_{1} - 1 = \\frac{5}{6} + \\frac{17}{20} - 1$$\n为了对分数求和，我们找到一个公分母，即 $60$。\n$$J_{1} = \\frac{5 \\times 10}{60} + \\frac{17 \\times 3}{60} - \\frac{60}{60} = \\frac{50+51-60}{60} = \\frac{41}{60}$$\n\n**第 2 层：对照 ($Y=0$)**\n\n对照 ($n_0 = 250$) 的数据整理如下：\n$$\n\\begin{array}{c|cc|c}\n\\text{对照 } (Y=0)  E=1  E=0  \\text{合计} \\\\\n\\hline\nR=1  a_0=70  b_0=30  100 \\\\\nR=0  c_0=30  d_0=120  150 \\\\\n\\hline\n\\text{合计}  100  150  n_0=250\n\\end{array}\n$$\n\n首先，我们计算一致性指标。\n- 观察一致性:\n$$P_{o,0} = \\frac{a_0+d_0}{n_0} = \\frac{70+120}{250} = \\frac{190}{250} = \\frac{19}{25} = 0.76$$\n- 期望一致性:\n$$P_{e,0} = \\frac{(100)(100) + (150)(150)}{250^2} = \\frac{10000 + 22500}{62500} = \\frac{32500}{62500} = \\frac{13}{25} = 0.52$$\n- 科恩 kappa 系数:\n$$\\kappa_0 = \\frac{P_{o,0} - P_{e,0}}{1 - P_{e,0}} = \\frac{0.76 - 0.52}{1 - 0.52} = \\frac{0.24}{0.48} = 0.5$$\n\n接下来，我们计算对照子层的敏感性、特异性和尤登指数。\n- 敏感性:\n$$\\mathrm{Se}_{0} = \\frac{a_0}{a_0+c_0} = \\frac{70}{70+30} = \\frac{70}{100} = \\frac{7}{10}$$\n- 特异性:\n$$\\mathrm{Sp}_{0} = \\frac{d_0}{b_0+d_0} = \\frac{120}{30+120} = \\frac{120}{150} = \\frac{12}{15} = \\frac{4}{5}$$\n- 尤登指数:\n$$J_{0} = \\mathrm{Se}_{0} + \\mathrm{Sp}_{0} - 1 = \\frac{7}{10} + \\frac{4}{5} - 1$$\n使用公分母 $10$：\n$$J_{0} = \\frac{7}{10} + \\frac{8}{10} - \\frac{10}{10} = \\frac{7+8-10}{10} = \\frac{5}{10} = \\frac{1}{2}$$\n\n**最终计算**\n\n问题要求计算单一数值 $J_{Y=1} - J_{Y=0}$。\n$$J_{Y=1} - J_{Y=0} = J_1 - J_0 = \\frac{41}{60} - \\frac{1}{2}$$\n我们将 $\\frac{1}{2}$ 转换为分母为 $60$ 的分数：$\\frac{1}{2} = \\frac{30}{60}$。\n$$J_{1} - J_0 = \\frac{41}{60} - \\frac{30}{60} = \\frac{41-30}{60} = \\frac{11}{60}$$\n这个差值量化了病例和对照组之间自我报告暴露分类准确性的变化，是回忆偏倚的一个指标。",
            "answer": "$$\n\\boxed{\\frac{11}{60}}\n$$"
        },
        {
            "introduction": "一旦我们获得了灵敏度和特异度的估计值（正如上一个练习所示），我们就可以从有偏倚的观测数据出发，反向推算出真实、无偏倚的关联强度。这个实践  提供了一个具体的“偏倚校正”案例。它将演示如何运用核心的代数方法，针对差异性错分对观察到的比值比（odds ratio）进行校正。",
            "id": "4629076",
            "problem": "一项病例对照研究旨在调查二元暴露 $X$ 与二元疾病 $D$ 之间的关联。由于暴露是自我报告的，回忆偏倚导致了病例组和对照组之间的差异性暴露错分。设 $Se_1$ 和 $Sp_1$ 分别表示病例组（$D=1$）中自我报告暴露的灵敏度和特异度，而 $Se_0$ 和 $Sp_0$ 分别表示对照组（$D=0$）中的灵敏度和特异度。基于自我报告暴露 $X^{\\ast}$ 的观察 $2 \\times 2$ 数据如下：\n- 病例组中（$D=1$）：200人 $X^{\\ast}=1$，100人 $X^{\\ast}=0$。\n- 对照组中（$D=0$）：100人 $X^{\\ast}=1$，100人 $X^{\\ast}=0$。\n\n这些观察数据得出的观察比值比（OR）为 $OR_{\\text{obs}} = 2.0$。假设错分参数为 $Se_1 = 0.9$、$Sp_1 = 0.95$、$Se_0 = 0.8$ 和 $Sp_0 = 0.98$。\n\n仅使用灵敏度和特异度的基本定义以及应用于每个疾病分层的基础线性代数，计算真实暴露 $X$ 与疾病 $D$ 之间关联的经偏倚校正的比值比。将最终答案报告为一个实数，并四舍五入到四位有效数字。",
            "solution": "目标是求出真实的比值比 $OR_{\\text{true}} = \\frac{ad}{bc}$，其中 $a, b, c, d$ 代表真实暴露状态 $X$ 的单元格计数。\n- $a$：真实暴露病例数（$X=1, D=1$）\n- $b$：真实暴露对照数（$X=1, D=0$）\n- $c$：真实未暴露病例数（$X=0, D=1$）\n- $d$：真实未暴露对照数（$X=0, D=0$）\n\n我们必须根据观察计数（$a', b', c', d'$）和错分参数来计算这些真实计数。由于错分的差异性，对病例组和对照组分层进行单独分析。\n\n**对病例组（$D=1$）的分析**\n病例总数为 $N_1 = a' + c' = 200 + 100 = 300$。这个总数在错分情况下是不变的，所以 $a+c = N_1 = 300$。\n观察到的暴露病例数 $a'$ 是被正确识别的真实暴露病例数与被错误识别的真实未暴露病例数之和：\n$$a' = a \\cdot P(X^{\\ast}=1|X=1, D=1) + c \\cdot P(X^{\\ast}=1|X=0, D=1)$$\n使用灵敏度（$Se_1 = P(X^{\\ast}=1|X=1, D=1)$）和特异度（$Sp_1 = P(X^{\\ast}=0|X=0, D=1)$）的定义，上式变为：\n$$a' = a \\cdot Se_1 + c \\cdot (1 - Sp_1)$$\n我们得到一个关于 $a$ 和 $c$ 的二元线性方程组：\n$$\n\\begin{cases}\na \\cdot Se_1 + c \\cdot (1 - Sp_1) = a' \\\\\na + c = N_1\n\\end{cases}\n$$\n将 $c = N_1 - a$ 代入第一个方程：\n$$a \\cdot Se_1 + (N_1 - a) \\cdot (1 - Sp_1) = a'$$\n$$a \\cdot Se_1 + N_1(1-Sp_1) - a(1-Sp_1) = a'$$\n$$a \\cdot (Se_1 - 1 + Sp_1) = a' - N_1(1-Sp_1)$$\n$$a = \\frac{a' - N_1(1 - Sp_1)}{Se_1 + Sp_1 - 1}$$\n代入病例分层的给定值：\n$a' = 200$, $N_1 = 300$, $Se_1 = 0.9$, $Sp_1 = 0.95$。\n$$a = \\frac{200 - 300(1 - 0.95)}{0.9 + 0.95 - 1} = \\frac{200 - 300(0.05)}{0.85} = \\frac{200 - 15}{0.85} = \\frac{185}{0.85} = \\frac{18500}{85} = \\frac{3700}{17}$$\n真实的未暴露病例数是：\n$$c = N_1 - a = 300 - \\frac{3700}{17} = \\frac{5100 - 3700}{17} = \\frac{1400}{17}$$\n\n**对对照组（$D=0$）的分析**\n对照组总数为 $N_0 = b' + d' = 100 + 100 = 200$。这意味着 $b+d = N_0 = 200$。\n类似地，对于对照分层，关联暴露个体的观察计数和真实计数的方程是：\n$$b' = b \\cdot Se_0 + d \\cdot (1 - Sp_0)$$\n我们求解该方程组：\n$$\n\\begin{cases}\nb \\cdot Se_0 + d \\cdot (1 - Sp_0) = b' \\\\\nb + d = N_0\n\\end{cases}\n$$\n$b$ 的解法与 $a$ 的解法类似：\n$$b = \\frac{b' - N_0(1 - Sp_0)}{Se_0 + Sp_0 - 1}$$\n代入对照分层的给定值：\n$b' = 100$, $N_0 = 200$, $Se_0 = 0.8$, $Sp_0 = 0.98$。\n$$b = \\frac{100 - 200(1 - 0.98)}{0.8 + 0.98 - 1} = \\frac{100 - 200(0.02)}{0.78} = \\frac{100 - 4}{0.78} = \\frac{96}{0.78} = \\frac{9600}{78} = \\frac{1600}{13}$$\n真实的未暴露对照数是：\n$$d = N_0 - b = 200 - \\frac{1600}{13} = \\frac{2600 - 1600}{13} = \\frac{1000}{13}$$\n\n**计算真实比值比（$OR_{\\text{true}}$）**\n现在我们使用计算出的真实单元格计数来计算真实的比值比：\n$$OR_{\\text{true}} = \\frac{ad}{bc}$$\n$$OR_{\\text{true}} = \\frac{\\left(\\frac{3700}{17}\\right) \\left(\\frac{1000}{13}\\right)}{\\left(\\frac{1600}{13}\\right) \\left(\\frac{1400}{17}\\right)}$$\n分子和分母中的分母 $(17 \\cdot 13)$ 可以消掉：\n$$OR_{\\text{true}} = \\frac{3700 \\times 1000}{1600 \\times 1400}$$\n$$OR_{\\text{true}} = \\frac{37 \\times 100 \\times 1000}{16 \\times 100 \\times 14 \\times 100} = \\frac{37 \\times 10}{16 \\times 14} = \\frac{370}{224}$$\n化简分数：\n$$OR_{\\text{true}} = \\frac{185}{112}$$\n为了给出最终答案，我们计算其小数值并四舍五入到四位有效数字：\n$$OR_{\\text{true}} \\approx 1.6517857...$$\n四舍五入到四位有效数字得到 $1.652$。\n回忆偏倚导致观察到的比值比为 $2.0$，高估了真实的关联（$1.652$）。",
            "answer": "$$\\boxed{1.652}$$"
        },
        {
            "introduction": "在现实研究中，我们很少能确切知道灵敏度和特异度的精确值。我们拥有的往往是来自文献或预试验的合理取值范围。这个练习  引入了灵敏度分析，这是一项至关重要的技术，用于探索在一系列可能的错分参数下，校正后的比值比会如何变化，从而使我们能够为最终估计值报告一个置信范围。",
            "id": "4628985",
            "problem": "一项病例对照研究旨在调查一种二元暴露与一种二元疾病之间的关联。由于病例组和对照组在回忆方面存在差异，研究人员担心存在由灵敏度和特异度决定的差异性暴露错分。基于自我报告的暴露，按疾病状态划分的观察到的暴露 $2 \\times 2$ 表如下：病例组中，200人暴露，300人未暴露；对照组中，125人暴露，375人未暴露。设 $Se_1$ 和 $Sp_1$ 分别表示病例组中暴露分类的灵敏度和特异度，设 $Se_0$ 和 $Sp_0$ 表示对照组中的灵敏度和特异度。灵敏度 (Se) 定义为将真实暴露者分类为暴露的概率，特异度 (Sp) 定义为将真实未暴露者分类为未暴露的概率。目标估计量是校正比值比 $OR_{\\text{adj}}$，该比值比在这些定义所隐含的标准分类误差模型下，对观察到的数据表进行了差异性错分校正。\n\n从基本原理出发，使用灵敏度、特异度和比值比 (OR) 的定义，将观察计数表示为真实计数和错分概率的函数，推导出对真实计数的校正方法，然后推导出 $OR_{\\text{adj}}$ 作为 $(Se_1,Sp_1,Se_0,Sp_0)$ 和观察计数的函数。进行敏感性分析，将 $(Se_1,Se_0)$ 在区间 $\\left[0.7,0.95\\right]$ 内变动，同时保持 $(Sp_1,Sp_0)=(0.95,0.95)$ 不变。确定在此范围内 $OR_{\\text{adj}}$ 的最小和最大可能值（界限）。将最终界限表示为精确的简化分数，不进行四舍五入，不带单位。",
            "solution": "设 $A$、$C$ 分别为病例组中真实暴露和未暴露的受试者人数。设 $B$、$D$ 分别为对照组中真实暴露和未暴露的受试者人数。\n病例组总人数为 $N_1 = a_{obs} + c_{obs} = 200 + 300 = 500$。\n对照组总人数为 $N_0 = b_{obs} + d_{obs} = 125 + 375 = 500$。\n总人数不受错分影响，因此 $N_1 = A+C$ 且 $N_0 = B+D$。\n\n观察计数是真实计数和错分参数的函数。对于病例组 (疾病=1)：\n观察到的暴露病例数 $a_{obs}$ 是被正确分类的真实暴露病例数与被错误分类的真实未暴露病例数之和：\n$$a_{obs} = A \\cdot Se_1 + C \\cdot (1 - Sp_1)$$\n观察到的未暴露病例数 $c_{obs}$ 是被错误分类的真实暴露病例数与被正确分类的真实未暴露病例数之和：\n$$c_{obs} = A \\cdot (1 - Se_1) + C \\cdot Sp_1$$\n\n通过求解关于 $A$ 和 $C$ 的线性方程组（利用 $C = N_1 - A$），我们可以推导出校正后的计数 $A$：\n$$A = \\frac{a_{obs} - N_1(1 - Sp_1)}{Se_1 + Sp_1 - 1}$$\n类似地，校正后的计数 $C$ 为：\n$$C = \\frac{c_{obs} - N_1(1 - Se_1)}{Se_1 + Sp_1 - 1}$$\n\n通过对对照组 (疾病=0) 进行完全相同的类比，校正后的计数 $B$ 和 $D$ 为：\n$$B = \\frac{b_{obs} - N_0(1 - Sp_0)}{Se_0 + Sp_0 - 1}$$\n$$D = \\frac{d_{obs} - N_0(1 - Se_0)}{Se_0 + Sp_0 - 1}$$\n\n校正比值比 $OR_{\\text{adj}}$ 是基于真实计数的比值比：\n$$OR_{\\text{adj}} = \\frac{A/C}{B/D} = \\frac{AD}{BC}$$\n代入 $A, B, C, D$ 的表达式，分母项会消去，得到校正比值比的通用公式：\n$$OR_{\\text{adj}} = \\frac{\\left( a_{obs} - N_1(1 - Sp_1) \\right) \\left( d_{obs} - N_0(1 - Se_0) \\right)}{\\left( b_{obs} - N_0(1 - Sp_0) \\right) \\left( c_{obs} - N_1(1 - Se_1) \\right)}$$\n\n现在，我们代入给定的数值和参数范围来进行敏感性分析。\n给定数据：$a_{obs}=200, c_{obs}=300, N_1=500$；$b_{obs}=125, d_{obs}=375, N_0=500$。\n给定参数：$Sp_1=0.95, Sp_0=0.95, Se_1 \\in [0.7, 0.95], Se_0 \\in [0.7, 0.95]$。\n\n我们来计算 $OR_{\\text{adj}}$ 表达式中的四项：\n-   $a_{obs} - N_1(1 - Sp_1) = 200 - 500(1 - 0.95) = 200 - 500(0.05) = 200 - 25 = 175$。\n-   $d_{obs} - N_0(1 - Se_0) = 375 - 500(1 - Se_0) = 375 - 500 + 500 Se_0 = 500 Se_0 - 125$。\n-   $b_{obs} - N_0(1 - Sp_0) = 125 - 500(1 - 0.95) = 125 - 500(0.05) = 125 - 25 = 100$。\n-   $c_{obs} - N_1(1 - Se_1) = 300 - 500(1 - Se_1) = 300 - 500 + 500 Se_1 = 500 Se_1 - 200$。\n\n将这些代入 $OR_{\\text{adj}}$ 公式：\n$$OR_{\\text{adj}}(Se_1, Se_0) = \\frac{175 \\cdot (500 Se_0 - 125)}{100 \\cdot (500 Se_1 - 200)}$$\n我们可以简化这个表达式：\n$$OR_{\\text{adj}}(Se_1, Se_0) = \\frac{175}{100} \\cdot \\frac{500(Se_0 - 0.25)}{500(Se_1 - 0.4)} = \\frac{7}{4} \\cdot \\frac{Se_0 - 0.25}{Se_1 - 0.4}$$\n我们需要在 $Se_1 \\in [0.7, 0.95]$ 和 $Se_0 \\in [0.7, 0.95]$ 的范围内求该函数的最小值和最大值。\n\n$OR_{\\text{adj}}(Se_1, Se_0)$ 对 $Se_1$ 是递减的（因为 $Se_1$ 在分母中），对 $Se_0$ 是递增的（因为 $Se_0$ 在分子中）。由于该函数在矩形定义域上对两个变量都是单调的，所以极值会出现在该定义域的角点上。\n\n为了求得 $OR_{\\text{adj}}$ 的最小值，我们必须最大化分母（即最大化 $Se_1$）并最小化分子（即最小化 $Se_0$）。\n设 $Se_1 = 0.95$ 和 $Se_0 = 0.7$。\n$$OR_{\\text{adj, min}} = \\frac{7}{4} \\cdot \\frac{0.7 - 0.25}{0.95 - 0.4} = \\frac{7}{4} \\cdot \\frac{0.45}{0.55} = \\frac{7}{4} \\cdot \\frac{45}{55} = \\frac{7}{4} \\cdot \\frac{9}{11} = \\frac{63}{44}$$\n\n为了求得 $OR_{\\text{adj}}$ 的最大值，我们必须最小化分母（即最小化 $Se_1$）并最大化分子（即最大化 $Se_0$）。\n设 $Se_1 = 0.7$ 和 $Se_0 = 0.95$。\n$$OR_{\\text{adj, max}} = \\frac{7}{4} \\cdot \\frac{0.95 - 0.25}{0.7 - 0.4} = \\frac{7}{4} \\cdot \\frac{0.70}{0.30} = \\frac{7}{4} \\cdot \\frac{7}{3} = \\frac{49}{12}$$\n\n在指定范围内，校正比值比的最小和最大可能值分别是 $\\frac{63}{44}$ 和 $\\frac{49}{12}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{63}{44}  \\frac{49}{12} \\end{pmatrix}}\n$$"
        }
    ]
}