{
    "hands_on_practices": [
        {
            "introduction": "在处理潜在偏倚时，第一步是理解其如何影响我们的测量结果。本练习将通过一个具体的数值示例，帮助您亲手计算失访偏倚的大小，即所谓的“偏倚因子”。通过从概率论的基本原理出发，您将推导出观察风险比相对于真实风险比的失真程度，从而将抽象的偏倚概念转化为一个可以量化的数值。",
            "id": "4609093",
            "problem": "考虑一项旨在评估某暴露对二元健康结局的因果效应的队列研究。设 $A \\in \\{0,1\\}$ 表示暴露状态，$Y \\in \\{0,1\\}$ 表示随访结束时的结局，$S \\in \\{0,1\\}$ 表示在随访中是否成功观察到结局，其中 $S=1$ 表示没有失访。对于 $a \\in \\{0,1\\}$，真实风险定义为 $r_{a} = \\Pr(Y=1 \\mid A=a)$，在完成随访的个体中观察到的风险为 $R_{a}^{S} = \\Pr(Y=1 \\mid A=a, S=1)$。该研究旨在量化因同时依赖于暴露和结局的失访而引入到观测风险比中的偏倚。\n\n假设真实风险为 $r_{1} = \\Pr(Y=1 \\mid A=1) = 0.25$ 和 $r_{0} = \\Pr(Y=1 \\mid A=0) = 0.10$。失访机制由以下概率表征：\n- $\\Pr(S=1 \\mid A=1, Y=1) = 0.9$，\n- $\\Pr(S=1 \\mid A=1, Y=0) = 0.6$，\n- $\\Pr(S=1 \\mid A=0, Y=1) = 0.7$，\n- $\\Pr(S=1 \\mid A=0, Y=0) = 0.8$。\n\n仅使用风险、条件概率、贝叶斯定理和全概率定律的核心定义，推导以 $r_{a}$ 和选择概率表示的 $R_{a}^{S}$ 的表达式，计算在 $S=1$ 的个体中的观测风险比，定义为 $\\mathrm{RR}_{\\text{obs}} = \\frac{R_{1}^{S}}{R_{0}^{S}}$，然后计算定义为 $\\mathrm{BF} = \\frac{\\mathrm{RR}_{\\text{obs}}}{\\mathrm{RR}_{\\text{true}}}$ 的偏倚因子，其中 $\\mathrm{RR}_{\\text{true}} = \\frac{r_{1}}{r_{0}}$。将最终的偏倚因子表示为小数，并将您的答案四舍五入到四位有效数字。最终数值答案无需单位。",
            "solution": "该问题是有效的，因为它在科学上基于流行病学原理，定义明确，提供了唯一解所需的所有数据，并使用客观、正式的语言陈述。其中没有矛盾、歧义或事实不准确之处。\n\n目标是量化因差异性失访导致的风险比偏倚。这需要以下几个步骤：\n1. 在完成随访的子队列（$S=1$）中，推导观测风险 $R_{a}^{S}$ 的通用表达式。\n2. 使用所提供的数据，计算具体的观测风险 $R_{1}^{S}$ 和 $R_{0}^{S}$。\n3. 计算真实风险比（$\\mathrm{RR}_{\\text{true}}$）和观测风险比（$\\mathrm{RR}_{\\text{obs}}$）。\n4. 计算偏倚因子（$\\mathrm{BF}$），即观测风险比与真实风险比之比。\n\n首先，我们推导观测风险 $R_{a}^{S} = \\Pr(Y=1 \\mid A=a, S=1)$ 的表达式。\n使用条件概率的定义（这是贝叶斯定理的一种形式）：\n$$ R_{a}^{S} = \\Pr(Y=1 \\mid A=a, S=1) = \\frac{\\Pr(Y=1, S=1 \\mid A=a)}{\\Pr(S=1 \\mid A=a)} $$\n分子可以使用概率的链式法则展开：\n$$ \\Pr(Y=1, S=1 \\mid A=a) = \\Pr(S=1 \\mid Y=1, A=a) \\Pr(Y=1 \\mid A=a) $$\n项 $\\Pr(Y=1 \\mid A=a)$ 是真实风险 $r_{a}$。\n分母 $\\Pr(S=1 \\mid A=a)$ 可以使用全概率定律，通过对结局 $Y \\in \\{0, 1\\}$ 进行条件化来展开：\n$$ \\Pr(S=1 \\mid A=a) = \\Pr(S=1 \\mid Y=1, A=a)\\Pr(Y=1 \\mid A=a) + \\Pr(S=1 \\mid Y=0, A=a)\\Pr(Y=0 \\mid A=a) $$\n我们知道 $\\Pr(Y=0 \\mid A=a) = 1 - \\Pr(Y=1 \\mid A=a) = 1-r_{a}$。\n将这些代入分母的表达式中，得到：\n$$ \\Pr(S=1 \\mid A=a) = \\Pr(S=1 \\mid Y=1, A=a)r_{a} + \\Pr(S=1 \\mid Y=0, A=a)(1-r_{a}) $$\n现在，我们将展开的分子和分母代回到 $R_{a}^{S}$ 的公式中：\n$$ R_{a}^{S} = \\frac{\\Pr(S=1 \\mid Y=1, A=a) r_{a}}{\\Pr(S=1 \\mid Y=1, A=a) r_{a} + \\Pr(S=1 \\mid Y=0, A=a) (1-r_{a})} $$\n这就是用真实风险和选择概率表示的观测风险的通用表达式。\n\n接下来，我们计算暴露组（$A=1$）的观测风险。给定值为：\n$r_{1} = 0.25$\n$\\Pr(S=1 \\mid A=1, Y=1) = 0.9$\n$\\Pr(S=1 \\mid A=1, Y=0) = 0.6$\n将这些值代入推导出的公式中：\n$$ R_{1}^{S} = \\frac{0.9 \\times 0.25}{0.9 \\times 0.25 + 0.6 \\times (1-0.25)} = \\frac{0.225}{0.225 + 0.6 \\times 0.75} = \\frac{0.225}{0.225 + 0.45} = \\frac{0.225}{0.675} = \\frac{1}{3} $$\n现在，我们计算非暴露组（$A=0$）的观测风险。给定值为：\n$r_{0} = 0.10$\n$\\Pr(S=1 \\mid A=0, Y=1) = 0.7$\n$\\Pr(S=1 \\mid A=0, Y=0) = 0.8$\n代入这些值：\n$$ R_{0}^{S} = \\frac{0.7 \\times 0.10}{0.7 \\times 0.10 + 0.8 \\times (1-0.10)} = \\frac{0.07}{0.07 + 0.8 \\times 0.9} = \\frac{0.07}{0.07 + 0.72} = \\frac{0.07}{0.79} = \\frac{7}{79} $$\n观测风险比 $\\mathrm{RR}_{\\text{obs}}$ 是这些观测风险的比值：\n$$ \\mathrm{RR}_{\\text{obs}} = \\frac{R_{1}^{S}}{R_{0}^{S}} = \\frac{1/3}{7/79} = \\frac{1}{3} \\times \\frac{79}{7} = \\frac{79}{21} $$\n真实风险比 $\\mathrm{RR}_{\\text{true}}$ 是真实风险的比值：\n$$ \\mathrm{RR}_{\\text{true}} = \\frac{r_{1}}{r_{0}} = \\frac{0.25}{0.10} = 2.5 $$\n最后，偏倚因子 $\\mathrm{BF}$ 是观测风险比与真实风险比的比值：\n$$ \\mathrm{BF} = \\frac{\\mathrm{RR}_{\\text{obs}}}{\\mathrm{RR}_{\\text{true}}} = \\frac{79/21}{2.5} = \\frac{79/21}{5/2} = \\frac{79}{21} \\times \\frac{2}{5} = \\frac{158}{105} $$\n为了得到最终的小数值，我们进行除法运算：\n$$ \\mathrm{BF} = \\frac{158}{105} \\approx 1.5047619... $$\n将此值四舍五入到四位有效数字，得到 $1.505$。",
            "answer": "$$\\boxed{1.505}$$"
        },
        {
            "introduction": "认识到偏倚的存在后，下一步是学习如何利用统计方法进行校正。本练习将向您介绍一种在现代流行病学中广泛应用的强大技术：逆概率审查加权（IPCW）。您将为一个在纵向研究中被完整观察的个体计算其“稳定权重”，从而直观地理解该方法如何通过重新分配权重来“模拟”一个没有选择性失访的理想队列。",
            "id": "4609104",
            "problem": "一项包含 $3$ 次预定随访的纵向队列研究，旨在估计基线暴露 $A$ 对 $t=3$ 时测量的结局的边际因果效应，同时处理潜在的失访偏倚。设 $S_t$ 为参与者在第 $t$ 次随访时仍被观察到（未失访）的指示变量，其中 $S_t=1$ 表示被观察到，$S_t=0$ 表示在第 $t-1$ 次和第 $t$ 次随访之间失访。按照惯例，$S_0=1$。在每次随访 $t \\in \\{1,2,3\\}$ 时，会对 $S_t=1$ 的参与者测量一组时变协变量 $L_t$。\n\n为调整因失访导致的选择偏倚，该研究使用了稳定删失概率逆权（IPCW）方法。假设用于估计每次随访时保持未删失概率的模型，对所有个体和所有 $t \\in \\{1,2,3\\}$ 得出以下值：\n- 一个仅基于基线变量的分子模型：$\\Pr(S_t=1 \\mid S_{t-1}=1, A) = 0.9$。\n- 一个基于基线和时变变量的分母模型：$\\Pr(S_t=1 \\mid S_{t-1}=1, A, L_t) = 0.8$。\n\n考虑一个在 $t=3$ 之前被完整观察到的个体（即，对于 $t=1,2,3$，均有 $S_t=1$）。仅使用删失调整中稳定权重法的基本定义，计算该个体在这 $3$ 次随访中的稳定权重。将您的答案表示为一个精确分数。无需四舍五入，也不需要单位。",
            "solution": "核心问题是调整因失访导致的选择偏倚。在纵向分析中，如果失访（删失）依赖于那些同时也与结局相关的时变协变量，则可能引入偏倚。删失概率逆权（IPCW）通过使用研究对象在其观察历史中保持未删失的概率的倒数对其进行重新加权来解决这个问题。稳定化通过引入一个以简化变量集（通常是基线因素）为条件的分子来减小方差。\n\n设 $K=3$ 为总随访次数。对于一个在所有随访中都保持被观察到的研究对象，其在 $t=3$ 之前保持未删失的事件可以使用链式法则分解为条件概率的乘积，\n$$\n\\Pr(S_1=1, S_2=1, S_3=1) \\;=\\; \\prod_{t=1}^{3} \\Pr(S_t=1 \\mid S_{t-1}=1, \\text{history up to } t),\n$$\n其中分母模型的特定条件集包括在时间 $t$ 被观察到的个体中的 $A$ 和 $L_t$。当分母模型以被认为决定删失的完整历史为条件时，一个被完整观察的研究对象的非稳定IPCW等于该乘积的倒数。稳定IPCW将该乘积的分子替换为来自一个简化模型的概率，这里是仅以 $S_{t-1}$ 和 $A$ 为条件的概率。\n\n因此，根据定义，一个在 $t=3$ 之前被完整观察的研究对象的稳定权重为\n$$\nW \\;=\\; \\prod_{t=1}^{3} \\frac{\\Pr(S_t=1 \\mid S_{t-1}=1, A)}{\\Pr(S_t=1 \\mid S_{t-1}=1, A, L_t)}.\n$$\n在所述情景中，这些条件概率在 $t$ 上是恒定的，并且对所有个体都是相等的：\n$$\n\\Pr(S_t=1 \\mid S_{t-1}=1, A) \\;=\\; 0.9 \\quad \\text{and} \\quad \\Pr(S_t=1 \\mid S_{t-1}=1, A, L_t) \\;=\\; 0.8 \\quad \\text{for all } t \\in \\{1,2,3\\}.\n$$\n因此，\n$$\nW \\;=\\; \\prod_{t=1}^{3} \\frac{0.9}{0.8} \\;=\\; \\left(\\frac{0.9}{0.8}\\right)^{3} \\;=\\; \\left(\\frac{9}{8}\\right)^{3} \\;=\\; \\frac{729}{512}.\n$$\n该表达式是精确的，不需要四舍五入。",
            "answer": "$$\\boxed{\\frac{729}{512}}$$"
        },
        {
            "introduction": "任何偏倚校正方法都依赖于对我们无法观测到的数据的假设，而这些假设本身也存在不确定性。因此，严谨的研究需要评估其结论在不同假设下的稳健性。本练习将引导您进行一次“临界点分析”，这是一种重要的敏感性分析，通过系统地改变对失访人群结局发生风险的假设，来探究在何种条件下，研究的定性结论（例如，暴露是有害的还是有益的）会发生逆转。",
            "id": "4609079",
            "problem": "考虑一项前瞻性队列研究，旨在评估暴露 $A \\in \\{0,1\\}$ 对二元结局 $Y \\in \\{0,1\\}$ 的影响。其中，$S \\in \\{0,1\\}$ 表示参与者在随访结束时是否被观察到（$S=1$）或失访（$S=0$）。失访（LTFU）可能会引入偏倚，因为 $S=0$ 的参与者的结局是未被观察到的。你需要进行一项临界点分析，方法是在一个网格上改变未观察到的风险 $\\Pr(Y=1 \\mid A=a, S=0)$，并确定基于风险比（RR）的因果结论发生改变的数值。\n\n记录的数据如下：\n- 在暴露组（$A=1$）中：总人数 $N_{1} = 800$，随访结束时观察到的人数 $R_{1} = 600$，失访人数 $L_{1} = 200$。在被观察到的参与者（$S=1$）中，发生结局的例数为 $y_{1,\\text{obs}} = 90$。\n- 在非暴露组（$A=0$）中：总人数 $N_{0} = 1200$，随访结束时观察到的人数 $R_{0} = 1000$，失访人数 $L_{0} = 200$。在被观察到的参与者（$S=1$）中，发生结局的例数为 $y_{0,\\text{obs}} = 100$。\n\n定义 $p_{1u} = \\Pr(Y=1 \\mid A=1, S=0)$ 和 $p_{0u} = \\Pr(Y=1 \\mid A=0, S=0)$，并假设 $p_{1u} \\in [0,1]$ 和 $p_{0u} \\in [0,1]$。使用概率的基本定义和全概率定律，推导出风险比\n$$RR(p_{1u}, p_{0u}) = \\frac{\\Pr(Y=1 \\mid A=1)}{\\Pr(Y=1 \\mid A=0)}$$\n作为 $p_{1u}$ 和 $p_{0u}$ 的函数，并在 $(p_{1u}, p_{0u})$ 平面中刻画出临界点边界，在该边界上，结论 $RR > 1$ 变为 $RR \\leq 1$。\n\n然后，通过固定 $p_{0u} = 0.20$ 并计算使 $RR = 1$ 的 $p_{1u}$ 的阈值，提供一个计算示例。将最终的数值答案表示为四舍五入到四位有效数字的小数。",
            "solution": "经评估，该问题陈述有效。它在科学上基于流行病学和概率论的原理，特别解决了因失访导致的选择偏倚问题。该问题提法恰当，为获得唯一解提供了所有必要数据，并以客观、正式的语言表述。所提供的数据内部一致（例如，$R_1 + L_1 = 600 + 200 = 800 = N_1$）。因此，可以推导出完整的解。\n\n主要目标是推导风险比（$RR$）作为失访（LTFU）组中未观察到的结局概率的函数，然后找到一个特定的“临界点”值。风险比定义为：\n$$RR = \\frac{\\Pr(Y=1 \\mid A=1)}{\\Pr(Y=1 \\mid A=0)}$$\n设 $P_1 = \\Pr(Y=1 \\mid A=1)$ 为暴露组（$A=1$）的真实风险，$P_0 = \\Pr(Y=1 \\mid A=0)$ 为非暴露组（$A=0$）的真实风险。我们可以使用全概率定律，通过对随访状态 $S \\in \\{0, 1\\}$ 进行条件化来表示这些真实风险。\n\n对于暴露组（$A=1$）：\n$$P_1 = \\Pr(Y=1 \\mid A=1, S=1)\\Pr(S=1 \\mid A=1) + \\Pr(Y=1 \\mid A=1, S=0)\\Pr(S=0 \\mid A=1)$$\n我们可以从所提供的数据中识别和计算各项：\n- 在观察到的暴露者中，结局的概率为 $\\Pr(Y=1 \\mid A=1, S=1) = \\frac{y_{1,\\text{obs}}}{R_1} = \\frac{90}{600} = \\frac{3}{20}$。\n- 在暴露组中，被观察到的概率为 $\\Pr(S=1 \\mid A=1) = \\frac{R_1}{N_1} = \\frac{600}{800} = \\frac{3}{4}$。\n- 在未被观察到的（失访的）暴露者中，结局的概率定义为 $p_{1u}$。\n- 在暴露组中，失访的概率为 $\\Pr(S=0 \\mid A=1) = \\frac{L_1}{N_1} = \\frac{200}{800} = \\frac{1}{4}$。\n\n将这些代入 $P_1$ 的方程中：\n$$P_1 = \\left(\\frac{90}{600}\\right)\\left(\\frac{600}{800}\\right) + p_{1u}\\left(\\frac{200}{800}\\right)$$\n该公式直接表明，总事件数是观察层和未观察层中事件数的总和，再除以总人口规模 $N_1$。\n$$P_1 = \\frac{y_{1,\\text{obs}} + p_{1u}L_1}{N_1} = \\frac{90 + 200 p_{1u}}{800}$$\n\n同样，对于非暴露组（$A=0$）：\n$$P_0 = \\Pr(Y=1 \\mid A=0, S=1)\\Pr(S=1 \\mid A=0) + \\Pr(Y=1 \\mid A=0, S=0)\\Pr(S=0 \\mid A=0)$$\n非暴露组的各项为：\n- 在观察到的非暴露者中，结局的概率为 $\\Pr(Y=1 \\mid A=0, S=1) = \\frac{y_{0,\\text{obs}}}{R_0} = \\frac{100}{1000} = \\frac{1}{10}$。\n- 在非暴露组中，被观察到的概率为 $\\Pr(S=1 \\mid A=0) = \\frac{R_0}{N_0} = \\frac{1000}{1200} = \\frac{5}{6}$。\n- 在未被观察到的（失访的）非暴露者中，结局的概率定义为 $p_{0u}$。\n- 在非暴露组中，失访的概率为 $\\Pr(S=0 \\mid A=0) = \\frac{L_0}{N_0} = \\frac{200}{1200} = \\frac{1}{6}$。\n\n将这些代入 $P_0$ 的方程中：\n$$P_0 = \\frac{y_{0,\\text{obs}} + p_{0u}L_0}{N_0} = \\frac{100 + 200 p_{0u}}{1200}$$\n\n现在，我们可以将风险比 $RR(p_{1u}, p_{0u})$ 写为 $P_1$ 与 $P_0$ 的比值：\n$$RR(p_{1u}, p_{0u}) = \\frac{P_1}{P_0} = \\frac{\\frac{90 + 200 p_{1u}}{800}}{\\frac{100 + 200 p_{0u}}{1200}}$$\n我们可以简化这个表达式：\n$$RR(p_{1u}, p_{0u}) = \\frac{90 + 200 p_{1u}}{800} \\cdot \\frac{1200}{100 + 200 p_{0u}} = \\frac{90 + 200 p_{1u}}{100 + 200 p_{0u}} \\cdot \\frac{1200}{800}$$\n$$RR(p_{1u}, p_{0u}) = \\frac{3}{2} \\cdot \\frac{90 + 200 p_{1u}}{100 + 200 p_{0u}}$$\n\n临界点边界是使 $RR=1$ 的点集 $(p_{1u}, p_{0u})$。这是关于暴露效应的定性结论发生改变的线。我们将 $RR$ 的表达式设为 $1$：\n$$1 = \\frac{3}{2} \\cdot \\frac{90 + 200 p_{1u}}{100 + 200 p_{0u}}$$\n重排方程以求解 $p_{1u}$ 和 $p_{0u}$ 之间的关系：\n$$\\frac{2}{3} = \\frac{90 + 200 p_{1u}}{100 + 200 p_{0u}}$$\n$$2(100 + 200 p_{0u}) = 3(90 + 200 p_{1u})$$\n$$200 + 400 p_{0u} = 270 + 600 p_{1u}$$\n将 $p_{1u}$ 解为 $p_{0u}$ 的函数：\n$$600 p_{1u} = 400 p_{0u} - 70$$\n$$p_{1u} = \\frac{400 p_{0u} - 70}{600} = \\frac{40 p_{0u} - 7}{60} = \\frac{2}{3}p_{0u} - \\frac{7}{60}$$\n这个线性方程定义了 $(p_{0u}, p_{1u})$ 平面中的临界点边界。$RR > 1$ 的区域由 $p_{1u} > \\frac{2}{3}p_{0u} - \\frac{7}{60}$ 表征。$RR \\leq 1$ 的区域由 $p_{1u} \\leq \\frac{2}{3}p_{0u} - \\frac{7}{60}$ 表征。\n\n对于计算示例，我们被要求在 $p_{0u}$ 固定为 $0.20$ 时，求出 $p_{1u}$ 的阈值。我们使用推导出的边界方程：\n$$p_{1u} = \\frac{2}{3}(0.20) - \\frac{7}{60}$$\n代入 $0.20 = \\frac{1}{5}$：\n$$p_{1u} = \\frac{2}{3} \\cdot \\frac{1}{5} - \\frac{7}{60} = \\frac{2}{15} - \\frac{7}{60}$$\n为了进行分数减法，我们找到一个公分母，即 $60$：\n$$p_{1u} = \\frac{2 \\cdot 4}{15 \\cdot 4} - \\frac{7}{60} = \\frac{8}{60} - \\frac{7}{60} = \\frac{1}{60}$$\n题目要求将此答案表示为四舍五入到四位有效数字的小数。\n$$p_{1u} = \\frac{1}{60} = 0.016666...$$\n四舍五入到四位有效数字，得到 $0.01667$。",
            "answer": "$$\\boxed{0.01667}$$"
        }
    ]
}