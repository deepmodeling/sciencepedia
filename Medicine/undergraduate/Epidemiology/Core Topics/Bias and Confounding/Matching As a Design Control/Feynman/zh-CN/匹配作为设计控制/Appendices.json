{
    "hands_on_practices": [
        {
            "introduction": "频率匹配确保了病例组和对照组中混杂变量（如年龄）的分布相似。然而，一个常见的误解是，仅凭这一设计选择就能消除混杂。本练习通过一个假设情景，用数字证明了为何在分析中对频率匹配变量进行调整以获得暴露效应的无偏估计是至关重要的。",
            "id": "4610003",
            "problem": "为评估职业性粉尘暴露对疾病风险的影响，开展了一项关于慢性呼吸系统疾病的病例对照研究。年龄与暴露和疾病均相关，因此是一个潜在的混杂因素。研究者在选择对照组时，按年龄分层（年龄 $ 50$ 岁 vs 年龄 $\\ge 50$ 岁）进行频数匹配，以使对照组的年龄分布与病例组的年龄分布相似。考虑以下科学上合理的情景：该疾病在年龄较大分层中更常见，且暴露在年龄较大的工人中更普遍。\n\n分析的基本依据是混杂因素的定义（一个与暴露相关且独立与结局相关的变量）以及病例对照研究设计的一个特性，即在分层内，病例组相对于对照组的暴露比值可以识别暴露与疾病关联的分层特异性比值比（OR）。匹配是一种确保病例组和对照组之间匹配因素可比性的设计工具，但频数匹配本身并不能消除混杂，除非在分析中对匹配因素进行校正。\n\n假设以下分层特异性信息成立：\n\n- 在较年轻的分层（$S_1$：年龄 $ 50$ 岁）中，对照组的暴露率为 $p_{E|C,S_1}=0.10$，分层特异性的疾病-暴露关联为 $\\mathrm{OR}_{S_1}=3$。\n- 在较年长的分层（$S_2$：年龄 $\\ge 50$ 岁）中，对照组的暴露率为 $p_{E|C,S_2}=0.50$，分层特异性的疾病-暴露关联为 $\\mathrm{OR}_{S_2}=3$。\n\n病例组的年龄分布为：$n_{S_1}^{\\text{cases}}=300$ 和 $n_{S_2}^{\\text{cases}}=700$；对照组按年龄进行 $1{:}1$ 频数匹配，因此 $n_{S_1}^{\\text{controls}}=300$ 和 $n_{S_2}^{\\text{controls}}=700$。\n\n使用这些输入和仅上述基本定义：\n\n1.  计算每个分层中病例组和对照组的预期暴露人数，然后合并分层并计算忽略年龄的粗略、未经调整的比值比 $\\mathrm{OR}_{\\text{crude}}$。\n2.  使用尊重匹配设计的适当分层调整方法（例如，Mantel–Haenszel 型汇总），计算分层调整后的比值比，记为 $\\mathrm{OR}_{\\text{adj}}$。\n3.  根据你的计算和频数匹配的逻辑，确定当分析未能对匹配变量进行调整时产生的偏倚方向，并解释在该特定混杂情景下为何会发生此方向的偏倚。\n\n哪个选项最能概括其方向和解释？\n\nA. 在此情景下，未能在频数匹配分析中对年龄进行调整会使暴露效应偏向于无效值；数值上，$\\mathrm{OR}_{\\text{crude}}\\approx 2.45$ 而 $\\mathrm{OR}_{\\text{adj}}=3.00$，因为当暴露在病例组中过度代表的年龄较大分层中更常见时，匹配会夸大对照组中的暴露率。\n\nB. 在频数匹配下，粗略比值比和调整后比值比是一致的，因此忽略年龄不会对估计的暴露效应产生偏倚。\n\nC. 未能进行调整会使暴露效应偏离无效值；粗略比值比将超过调整后比值比，因为年龄与暴露和疾病均呈正相关。\n\nD. 在设计阶段进行匹配完全消除了混杂；在分析中对匹配变量进行调整是不必要的，并且会引入偏倚。",
            "solution": "我们从与流行病学研究设计和分析相关的基本原则开始：\n\n- 混杂因素是与暴露相关且独立与结局相关的变量；如果不加以控制，它会扭曲暴露与结局之间的关联。\n- 在病例对照研究中，只要在给定病例/对照状态和分层的条件下，选择与暴露无关，那么在一个分层内比较病例组与对照组的暴露比值所得到的比值比（OR），无论抽样比例如何，都能识别该分层的疾病-暴露关联。\n- 频数匹配是一种使匹配变量在病例组和对照组之间分布相似的设计策略。然而，与使用适当的条件方法分析的个体匹配不同，频数匹配本身并不能消除混杂；必须在分析中包含匹配变量，以正确解释其与暴露和疾病的关联。\n- 当分层特异性比值比大致同质时，Mantel–Haenszel（MH）分层调整通过汇总各分层的 $2{\\times}2$ 表来估计一个共同的比值比。\n\n步骤 1：按分层计算暴露人数，然后计算忽略年龄的粗略比值比。\n\n各分层对照组的暴露率：\n- $S_1$：$p_{E|C,S_1}=0.10 \\Rightarrow S_1$ 中暴露的对照者为 $0.10\\times 300=30$ 人，未暴露的对照者为 $300-30=270$ 人。\n- $S_2$：$p_{E|C,S_2}=0.50 \\Rightarrow S_2$ 中暴露的对照者为 $0.50\\times 700=350$ 人，未暴露的对照者为 $700-350=350$ 人。\n\n给定 $\\mathrm{OR}_{S_1}=\\mathrm{OR}_{S_2}=3$，从对照组的暴露比值计算每个分层内病例组的预期暴露率。对于 $S_1$，对照组中的暴露比值为\n$$\n\\text{odds}_{E|C,S_1}=\\frac{0.10}{0.90}=\\frac{1}{9}.\n$$\n乘以分层特异性比值比，得到病例组中的暴露比值：\n$$\n\\text{odds}_{E|K,S_1}=3\\times \\frac{1}{9}=\\frac{1}{3},\n$$\n因此，$S_1$ 中病例组的暴露率为\n$$\np_{E|K,S_1}=\\frac{\\text{odds}}{1+\\text{odds}}=\\frac{\\frac{1}{3}}{1+\\frac{1}{3}}=\\frac{1}{4}=0.25.\n$$\n因此，$S_1$ 中暴露的病例为 $0.25\\times 300=75$ 人，未暴露的病例为 $300-75=225$ 人。\n\n对于 $S_2$，对照组中的暴露比值为\n$$\n\\text{odds}_{E|C,S_2}=\\frac{0.50}{0.50}=1.\n$$\n乘以分层特异性比值比，得到病例组中的暴露比值：\n$$\n\\text{odds}_{E|K,S_2}=3\\times 1=3,\n$$\n因此，$S_2$ 中病例组的暴露率为\n$$\np_{E|K,S_2}=\\frac{3}{1+3}=\\frac{3}{4}=0.75.\n$$\n因此，$S_2$ 中暴露的病例为 $0.75\\times 700=525$ 人，未暴露的病例为 $700-525=175$ 人。\n\n合并分层以计算病例组和对照组的粗略暴露比值：\n\n- 总暴露病例数：$75+525=600$。\n- 总未暴露病例数：$225+175=400$。\n- 病例组中的暴露比值：$\\dfrac{600}{400}=1.5$。\n\n- 总暴露对照数：$30+350=380$。\n- 总未暴露对照数：$270+350=620$。\n- 对照组中的暴露比值：$\\dfrac{380}{620}\\approx 0.6129$。\n\n因此，忽略年龄的粗略比值比为\n$$\n\\mathrm{OR}_{\\text{crude}}=\\frac{\\text{odds}_{E|K,\\text{collapsed}}}{\\text{odds}_{E|C,\\text{collapsed}}}=\\frac{1.5}{0.6129}\\approx 2.449.\n$$\n\n步骤 2：使用 Mantel–Haenszel 型汇总计算分层调整后的比值比。\n\n构建每个分层的 $2{\\times}2$ 表，其中计数为 $a_s$（暴露病例），$b_s$（暴露对照），$c_s$（未暴露病例），$d_s$（未暴露对照），总数为 $n_s=a_s+b_s+c_s+d_s$：\n- $S_1$：$a_1=75$, $b_1=30$, $c_1=225$, $d_1=270$, $n_1=600$。\n- $S_2$：$a_2=525$, $b_2=350$, $c_2=175$, $d_2=350$, $n_2=1400$。\n\n共同比值比的 Mantel–Haenszel 估计量为\n$$\n\\mathrm{OR}_{\\text{MH}}=\\frac{\\sum_s \\frac{a_s d_s}{n_s}}{\\sum_s \\frac{b_s c_s}{n_s}}.\n$$\n计算分子和分母：\n- 分子：$\\dfrac{75\\times 270}{600}+\\dfrac{525\\times 350}{1400}=33.75+131.25=165$。\n- 分母：$\\dfrac{30\\times 225}{600}+\\dfrac{350\\times 175}{1400}=11.25+43.75=55$。\n\n因此，\n$$\n\\mathrm{OR}_{\\text{adj}}=\\mathrm{OR}_{\\text{MH}}=\\frac{165}{55}=3.00,\n$$\n根据构建，这等于共同的分层特异性比值比。\n\n步骤 3：确定当未能对匹配变量进行调整时产生的偏倚方向，并解释其发生原因。\n\n粗略估计值 $\\mathrm{OR}_{\\text{crude}}\\approx 2.45$ 小于分层调整后的估计值 $\\mathrm{OR}_{\\text{adj}}=3.00$，表明当忽略年龄时，偏倚偏向于无效值。其根本机制植根于研究设计和混杂结构：年龄较大者既更容易患病，也更容易暴露。频数匹配迫使对照组的年龄分布与病例组的年龄分布相似，从而过度抽样了年龄较大的对照者。因为暴露在年龄较大的分层中更普遍，所以对照组中的暴露率相对于源人群中具有年龄代表性的样本而言被提高了。对照组暴露率的这种夸大将粗略比值比拉向 1，从而削弱了估计的效应。适当的分层调整（或在回归中包含匹配变量）恢复了正确的比较性，并恢复了共同的分层特异性关联。\n\n逐项分析选项：\n\n- 选项 A：它指出偏倚偏向于无效值，并通过数值确认 $\\mathrm{OR}_{\\text{crude}}\\approx 2.45$ 对比 $\\mathrm{OR}_{\\text{adj}}=3.00$，并正确解释了当暴露在过度代表的年龄较大分层中更常见时，频数匹配会夸大对照组中的暴露率。这与推导相符。结论：正确。\n\n- 选项 B：它声称在频数匹配下，粗略和调整后的比值比是一致的。这是不正确的：频数匹配需要对匹配变量进行调整以消除混杂并解释抽样设计；我们的计算显示 $\\mathrm{OR}_{\\text{crude}}\\ne \\mathrm{OR}_{\\text{adj}}$。结论：不正确。\n\n- 选项 C：它断言偏倚偏离无效值（粗略值超过调整值）。我们的推导显示了相反的情况：$\\mathrm{OR}_{\\text{crude}}  \\mathrm{OR}_{\\text{adj}}$，因为通过过度抽样年龄较大的对照者，对照组的暴露率被提高了。结论：不正确。\n\n- 选项 D：它声称在设计阶段进行匹配完全消除了混杂，并且调整会引入偏倚。在频数匹配中，匹配本身并不能消除混杂；调整是必要的。我们的例子表明，不进行调整会产生偏倚。结论：不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在个体匹配的病例-对照研究中，估计关联强度的关键在于“不一致对”——即病例和对照有不同暴露史的配对。这些配对提供了关键信息，而“一致对”（双方都暴露或都未暴露）对优势比的主要估计没有贡献。这个动手计算将指导你直接从不一致对的数量中推导和计算配对优势比，从而巩固这一基本概念。",
            "id": "4610053",
            "problem": "一个公共卫生团队进行了一项 $1{:}1$ 匹配的病例对照研究，旨在探讨吸入性职业暴露与哮喘恶化之间的关系。研究将每例病例与一名对照者在年龄（相差 $2$ 年以内）、性别和工作场所上进行匹配。在每个匹配对中，恰好有一名受试者是病例，一名是对照。设暴露指标为 $E \\in \\{0,1\\}$，疾病指标为 $D \\in \\{0,1\\}$，匹配变量记为 $M$。研究人员将所有匹配对的数据汇总为以下计数：两名受试者均暴露的配对 ($a$)、两名受试者均未暴露的配对 ($d$)、仅病例暴露的配对 ($b$)、以及仅对照者暴露的配对 ($c$)。他们报告了 $a = 110$，$d = 60$，$b = 57$ 和 $c = 23$。\n\n仅使用匹配集内比值、比值比和条件概率的核心定义，推导基于这些数据的适当的匹配集比值比估计量，并根据报告的计数计算其数值。然后，在给定匹配因素 $M$ 的条件下，以及满足条件可交换性、一致性和正定性的假设下，解释此估计量所对应的因果参数。\n\n仅报告比值比的数值，四舍五入到 $3$ 位有效数字，作为一个无单位的小数。最终数值答案中不要包含任何解释；仅在推导过程中提供解释。",
            "solution": "该问题要求从一项 $1{:}1$ 匹配病例对照研究中推导和计算匹配集比值比，并在特定假设下对估计的参数进行因果解释。\n\n匹配病例对照研究的分析需要以匹配集为条件，以消除匹配变量带来的混杂。在 $1{:}1$ 匹配研究中，每个匹配集（或配对）包含一个病例（$D=1$）和一个对照（$D=0$）。数据按每对内的暴露状态进行汇总。设 $E_{case}$ 和 $E_{control}$ 分别是给定配对中病例和对照的暴露状态（$1$ 为暴露，$0$ 为未暴露）。数据被分类为四种类型的配对：\n1.  两者均暴露 ($E_{case}=1, E_{control}=1$)：计数 $a = 110$。这些是一致对。\n2.  病例暴露，对照未暴露 ($E_{case}=1, E_{control}=0$)：计数 $b = 57$。这些是不一致对。\n3.  病例未暴露，对照暴露 ($E_{case}=0, E_{control}=1$)：计数 $c = 23$。这些是不一致对。\n4.  两者均未暴露 ($E_{case}=0, E_{control}=0$)：计数 $d = 60$。这些是一致对。\n\n适当的估计量是使用条件似然法推导出来的。该方法以每对内观察到的暴露集为条件，其效果是消除每个匹配集（层）特有的讨厌参数。\n\n考虑一个由 $i$ 索引的、具有匹配因素 $M_i$ 的单一匹配对。我们感兴趣的参数是比值比（$\\text{OR}$），假设它在由 $M$ 定义的所有层中是恒定的。比值比关联暴露与疾病：\n$$ \\text{OR} = \\frac{P(E=1|D=1, M_i)/P(E=0|D=1, M_i)}{P(E=1|D=0, M_i)/P(E=0|D=0, M_i)} $$\n设 $p_{1i} = P(E=1|D=1, M_i)$ 为配对 $i$ 中病例的暴露概率， $p_{0i} = P(E=1|D=0, M_i)$ 为配对 $i$ 中对照的暴露概率。特定层的比值比为 $\\text{OR}_i = \\frac{p_{1i}/(1-p_{1i})}{p_{0i}/(1-p_{0i})}$。我们假设对于所有 $i$ 都有 $\\text{OR}_i = \\text{OR}$。\n\n条件似然法只考虑不一致对，因为一致对不提供关于比值比的任何信息。要成为不一致对，一个受试者必须暴露，另一个必须未暴露。我们计算在配对不一致的条件下，观察到当前排列（哪个受试者是病例）的概率。\n\n观察到b型对（病例暴露，对照未暴露）的概率正比于 $P(E=1|D=1, M_i)P(E=0|D=0, M_i) \\propto p_{1i}(1-p_{0i})$。\n观察到c型对（病例未暴露，对照暴露）的概率正比于 $P(E=0|D=1, M_i)P(E=1|D=0, M_i) \\propto (1-p_{1i})p_{0i}$。\n\n在配对不一致的条件下，病例是暴露者的条件概率是：\n$$ P(\\text{case exposed} | \\text{discordant}, M_i) = \\frac{p_{1i}(1-p_{0i})}{p_{1i}(1-p_{0i}) + (1-p_{1i})p_{0i}} $$\n我们可以通过将分子和分母同除以 $(1-p_{1i})(1-p_{0i})$ 来简化这个表达式：\n$$ P(\\text{case exposed} | \\text{discordant}, M_i) = \\frac{\\frac{p_{1i}}{1-p_{1i}}}{\\frac{p_{1i}}{1-p_{1i}} + \\frac{p_{0i}}{1-p_{0i}}} $$\n将这些项识别为病例和对照的暴露比值，并使用比值比的定义 $\\text{OR} = \\frac{p_{1i}/(1-p_{1i})}{p_{0i}/(1-p_{0i})}$，我们可以将病例的暴露比值写成 $\\text{OR} \\times (\\text{odds for control})$。代入此式：\n$$ P(\\text{case exposed} | \\text{discordant}, M_i) = \\frac{\\text{OR} \\cdot \\left(\\frac{p_{0i}}{1-p_{0i}}\\right)}{\\text{OR} \\cdot \\left(\\frac{p_{0i}}{1-p_{0i}}\\right) + \\left(\\frac{p_{0i}}{1-p_{0i}}\\right)} = \\frac{\\text{OR}}{\\text{OR} + 1} $$\n类似地，在配对不一致的条件下，对照是暴露者（即病例未暴露）的条件概率是：\n$$ P(\\text{case unexposed} | \\text{discordant}, M_i) = \\frac{(1-p_{1i})p_{0i}}{p_{1i}(1-p_{0i}) + (1-p_{1i})p_{0i}} = \\frac{\\frac{p_{0i}}{1-p_{0i}}}{\\frac{p_{1i}}{1-p_{1i}} + \\frac{p_{0i}}{1-p_{0i}}} = \\frac{1}{\\text{OR} + 1} $$\n总条件似然 $L(\\text{OR})$ 是这 $b+c$ 个不一致对的这些概率的乘积。我们有 $b$ 对病例暴露和 $c$ 对照暴露。\n$$ L(\\text{OR}) = \\left( \\frac{\\text{OR}}{\\text{OR} + 1} \\right)^b \\left( \\frac{1}{\\text{OR} + 1} \\right)^c = \\frac{\\text{OR}^b}{(\\text{OR} + 1)^{b+c}} $$\n为了找到 $\\text{OR}$ 的最大似然估计量（MLE），我们最大化对数似然 $\\ell(\\text{OR}) = \\ln(L(\\text{OR}))$：\n$$ \\ell(\\text{OR}) = b \\ln(\\text{OR}) - (b+c) \\ln(\\text{OR} + 1) $$\n我们对 $\\text{OR}$求导并令其为零：\n$$ \\frac{d\\ell}{d\\text{OR}} = \\frac{b}{\\text{OR}} - \\frac{b+c}{\\text{OR} + 1} = 0 $$\n$$ \\frac{b}{\\text{OR}} = \\frac{b+c}{\\text{OR} + 1} $$\n$$ b(\\text{OR} + 1) = c(\\text{OR}) + b(\\text{OR}) $$\n$$ b \\cdot \\text{OR} + b = c \\cdot \\text{OR} + b \\cdot \\text{OR} $$\n$$ b = c \\cdot \\text{OR} $$\n因此，匹配集比值比的 MLE 是：\n$$ \\widehat{\\text{OR}}_M = \\frac{b}{c} $$\n这个估计量也被称为 McNemar 比值比。它仅取决于不一致对的计数。\n\n使用所提供的数据（$a=110$，$d=60$，$b=57$，$c=23$），我们可以计算其数值：\n$$ \\widehat{\\text{OR}}_M = \\frac{57}{23} \\approx 2.4782608... $$\n四舍五入到 $3$ 位有效数字，其值为 $2.48$。\n\n问题的第二部分要求在条件可交换性、一致性和正定性的假设下，解释该估计量所对应的因果参数。\n1.  **条件可交换性：** 在匹配因素 $M$（年龄、性别、工作场所）的各层内，个体发生哮喘恶化的潜在可能性与其真实暴露状态无关。这意味着 $M$ 是一个足以控制暴露 $E$ 和结果 $D$ 之间所有混杂的变量集。\n2.  **一致性：** 个体的观测结果等于其在观测暴露水平下的潜在结果。\n3.  **正定性：** 在 $M$ 的每个分层中，都存在暴露和未暴露的个体。\n\n在这些假设下，关联性比值比（即 $\\widehat{\\text{OR}}_M$ 所估计的）等同于因果比值比。由 $b/c$ 估计的参数是在 $M$ 的各层中假定为常数的共同条件比值比。这个因果参数是指，在任何给定的年龄、性别和工作场所分层中，如果受试者暴露，其发生哮喘恶化的比值，与同样这些受试者未暴露时发生哮喘恶化的比值之比。数值 $2.48$ 意味着，对于具有相同年龄、性别和工作场所特征的个体，与不接受该暴露的反事实情况相比，在有职业暴露的条件下，发生哮喘恶化的比值要高出 $2.48$ 倍。",
            "answer": "$$\\boxed{2.48}$$"
        }
    ]
}