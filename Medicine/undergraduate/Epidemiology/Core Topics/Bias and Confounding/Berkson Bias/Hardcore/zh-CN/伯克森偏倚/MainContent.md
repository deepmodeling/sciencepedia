## 引言
在流行病学和许多定量科学研究中，我们的最终目标是准确地理解世界。我们希望知道某种暴露是否会导致某种结局，一项干预是否有效。然而，从数据中得出有效结论的道路上布满了被称为“偏倚”的陷阱，它们是可能系统性地扭曲我们观察结果的幽灵。如果不能识别并妥善处理，偏倚将导致错误的结论，从而可能对科学知识、临床实践和公共卫生政策产生深远的不良影响。

在众多偏倚中，**伯克森偏倚 (Berkson's Bias)** 是一种尤为微妙且普遍的选择偏倚。它常常潜伏在看似合理的研究设计中，例如在医院或特定诊所内招募研究对象。这种偏倚的狡猾之处在于，它能使两个在现实世界中完全独立的因素，在研究样本中呈现出虚假的关联。这种现象的产生并非偶然，而是遵循着特定的[因果结构](@entry_id:159914)。理解这一结构，是研究设计和数据分析中不可或缺的批判性思维技能。

本文旨在系统地剖析伯克森偏倚。我们将分为三个部分，带领读者层层深入：
-   **原理与机制**：我们将借助有向无环图（DAGs）这一强大的因果推理工具，揭示“对撞节点”作为伯克森偏倚核心机制的原理，并通过经典悖论和数学推导，展示偏倚如何量化地影响关联度量。
-   **应用与跨学科联系**：我们将跳出理论框架，探讨伯克森偏倚在各种真实世界场景中的表现，从经典的医院病例对照研究，到现代的电子健康记录分析，再到公共卫生项目评估和基础科学实验，展示其广泛的影响。
-   **动手实践**：通过一系列精心设计的练习，你将有机会亲自推导、计算和模拟伯克森偏倚的产生过程，将抽象的理论知识转化为具体的实践能力。

通过学习本章，您将不仅能定义和识别伯克森偏倚，更能掌握其背后的因果逻辑，从而在未来的研究中，能够更有信心地设计出稳健的研究方案，并对研究结果进行更为审慎和深刻的解读。

## 原理与机制

在流行病学研究中，我们旨在准确估计暴露与结局之间的关联。然而，研究设计和数据收集过程中的系统性误差（即偏倚）可能会扭曲这种关联，导致错误的结论。在上一章中，我们介绍了偏倚的总体概念。本章将深入探讨一种特定但普遍存在的选择偏倚——**伯克森偏倚 (Berkson's Bias)**，阐明其产生的[因果结构](@entry_id:159914)、作用机制及其对研究结果的潜在影响。

### 伯克森偏倚的[因果结构](@entry_id:159914)：对撞节点

要理解伯克森偏倚，我们必须首先引入**有向无环图 (Directed Acyclic Graphs, DAGs)** 中的一个关键结构：**对撞节点 (collider)**。当一个变量是两个或多个其他变量的共同效应时，它就被称为对撞节点。在图形上，这意味着有两条或多条箭头指向该变量。

一个典型的例子是医院收治。假设在普通人群中，某种暴露（如吸烟，$X$）和某种疾病（如呼吸道疾病，$Y$）是相互独立的。然而，吸烟者和患有呼吸道疾病者都更有可能因各种原因被医院收治。如果我们用 $S$ 表示“被医院收治”这一事件，那么吸烟 ($X$) 和呼吸道疾病 ($Y$) 都是导致医院收治 ($S$) 的原因。这种因果关系可以用以下DAG表示：

$X \rightarrow S \leftarrow Y$

在这个结构中，$S$ 就是一个对撞节点，因为它“接收”了来自 $X$ 和 $Y$ 的两条因果箭头。

理解对撞节点的关键规则来自 **[d-分离](@entry_id:748152) (d-separation)** 理论 。该理论指出，在不对对撞节点或其任何后代节点进行“调整”（即**条件化 (conditioning)**）的情况下，对撞节点会**阻断 (block)** 其原因之间的路径。换言之，在上述 $X \rightarrow S \leftarrow Y$ 结构中，$X$ 和 $Y$ 之间的路径在 $S$ 处被阻断了。这意味着，如果 $X$ 和 $Y$ 在源人群中是独立的，那么它们在统计上也是不相关的。

然而，[d-分离](@entry_id:748152)理论还有一个至关重要的推论：**对对撞节点进行条件化，会“打开” (unblock) 这条原本被阻断的路径**。在研究实践中，“对对撞节点进行条件化”通常意味着将分析局限于该变量的某个特定水平。例如，在医院进行一项研究，只纳入被收治的病人，这实际上就是对 $S=1$ 进行了条件化。这种行为会打开 $X$ 和 $Y$ 之间的非因果关联路径，即使它们在源人群中是独立的，但在医院样本中也会表现出虚假的统计关联。这种由对撞节点条件化引起的偏倚，就是伯克森偏倚的核心机制。

### 伯克森悖论：一个直观的例证

为了更直观地理解这一现象，我们来看一个常被称为**伯克森悖论 (Berkson's Paradox)** 的经典思想实验 。

假设有一家专科医院，其入院规则非常简单：病人必须至少患有两种独立疾病（$D_1$ 或 $D_2$）中的一种才能入院。我们用 $H=1$ 表示入院。那么入院规则就是：$H=1$ 当且仅当 $D_1=1$ 或 $D_2=1$。在普通人群中，这两种疾病是独立的，我们假设它们的患病率分别为 $\Pr(D_1=1) = 0.10$ 和 $\Pr(D_2=1) = 0.20$。

现在，我们只在医院内部观察病人（即以 $H=1$ 为条件）。假设我们遇到一位住院病人，并得知他**没有**患 $D_1$（即 $D_1=0$）。根据入院规则，他必须患有 $D_2$ 才能住进医院。因此，对于这位病人，$\Pr(D_2=1 \mid D_1=0, H=1) = 1$。

再假设我们遇到另一位住院病人，并得知他**患有** $D_1$（即 $D_1=1$）。他的入院条件已经满足。由于在源人群中 $D_1$ 和 $D_2$ 是独立的，知道他患有 $D_1$ 并不会改变他患 $D_2$ 的概率。因此，$\Pr(D_2=1 \mid D_1=1, H=1) = \Pr(D_2=1) = 0.20$。

比较这两个概率：
- 在住院病人中，没有 $D_1$ 的人患 $D_2$ 的概率是 $1$。
- 在住院病人中，患有 $D_1$ 的人患 $D_2$ 的概率是 $0.20$。

显然，$1 > 0.20$。这意味着在医院这个子群体中，两种疾病之间出现了一种强烈的**负相关**——患有一种疾病似乎可以“防止”患上另一种疾病。这与它们在普通人群中相互独立的事实形成了鲜明对比，显得非常“悖谬”。这种虚假的负相关并非源于任何生物学上的保护作用，而纯粹是由于我们的观察被局限在医院这个由对撞节点定义的特殊子集中所产生的统计学假象。这就是伯克森偏倚的威力。

### 量化偏倚：诱导出的比值比

虽然上述悖论提供了一个极端的例子，但伯克森偏倚在更普遍的概率情境下同样存在。我们可以通过计算**比值比 (Odds Ratio, OR)** 来量化这种偏倚。

我们来看一个更真实的医院收治场景 。假设在源人群中，糖尿病 ($X$) 和慢性肾病 ($Y$) 相互独立。$\Pr(X=1) = 0.20$，$\Pr(Y=1) = 0.10$。由于独立性，源人群中 $X$ 与 $Y$ 关联的比值比 $\text{OR}_{XY} = 1$。

医院的收治概率 ($A=1$) 取决于这两种疾病的存在情况，具体如下：
- $\Pr(A=1 \mid X=0, Y=0)=0.05$ (无病)
- $\Pr(A=1 \mid X=1, Y=0)=0.60$ (仅有糖尿病)
- $\Pr(A=1 \mid X=0, Y=1)=0.50$ (仅有慢性肾病)
- $\Pr(A=1 \mid X=1, Y=1)=0.80$ (两种疾病都有)

我们的目标是计算在入院病人中 ($A=1$)，$X$ 和 $Y$ 之间的比值比 $\text{OR}_{XY \mid A=1}$。该比值比的定义为：
$$
\text{OR}_{XY\mid A=1}=\frac{\Pr(X=1,Y=1\mid A=1)\,\Pr(X=0,Y=0\mid A=1)}{\Pr(X=1,Y=0\mid A=1)\,\Pr(X=0,Y=1\mid A=1)}
$$

利用贝叶斯定理，$\Pr(X=x, Y=y \mid A=1) = \frac{\Pr(A=1 \mid X=x, Y=y) \Pr(X=x, Y=y)}{\Pr(A=1)}$。代入上式后，公分母 $\Pr(A=1)$ 会被约掉，得到：
$$
\text{OR}_{XY\mid A=1} = \frac{\Pr(A=1\mid 1,1)\Pr(1,1) \cdot \Pr(A=1\mid 0,0)\Pr(0,0)}{\Pr(A=1\mid 1,0)\Pr(1,0) \cdot \Pr(A=1\mid 0,1)\Pr(0,1)}
$$
其中 $\Pr(x,y)$ 表示 $\Pr(X=x, Y=y)$。

首先，根据源人群的独立性假设，我们计算[联合概率](@entry_id:266356)：
- $\Pr(1,1) = 0.20 \times 0.10 = 0.02$
- $\Pr(0,0) = (1-0.20) \times (1-0.10) = 0.80 \times 0.90 = 0.72$
- $\Pr(1,0) = 0.20 \times 0.90 = 0.18$
- $\Pr(0,1) = 0.80 \times 0.10 = 0.08$

现在，将所有数值代入 $\text{OR}_{XY \mid A=1}$ 的表达式：
$$
\text{OR}_{XY\mid A=1} = \frac{(0.80 \times 0.02) \times (0.05 \times 0.72)}{(0.60 \times 0.18) \times (0.50 \times 0.08)} = \frac{0.016 \times 0.036}{0.108 \times 0.040} = \frac{0.000576}{0.00432} = \frac{2}{15} \approx 0.133
$$
在医院样本中，比值比约为 $0.133$，远小于 $1$。这表明，尽管糖尿病和慢性肾病在普通人群中是独立的，但在住院病人中却表现出一种虚假的负相关。

值得注意的是，伯克森偏倚**不一定**总是产生负相关。偏倚的方向取决于具体的选择机制。例如，在另一个假设场景中 ，如果入院概率表现出正向的[交互作用](@entry_id:164533)（即同时患两种病的人入院概率的增加幅度超过了各自效应的简单相加），那么在入院病人中可能会观察到一种虚假的**正相关**。

### 对撞节点偏倚的通用公式

为了更深刻地理解偏倚的来源，我们可以推导一个更通用的公式 。假设两种独立疾病 $D_1$ 和 $D_2$ 的患病率分别为 $p_1$ 和 $p_2$。入院概率 $S=1$ 取决于疾病状态，如下定义：
- 无病时入院概率为 $s_0$
- 仅患一种病时入院概率为 $s_1$
- 患有两种病时入院概率为 $s_2$

遵循与上节类似的推导，我们可以证明，在入院病人中，$D_1$ 和 $D_2$ 之间的比值比为：
$$
\text{OR}_{\{S=1\}} = \frac{s_0 s_2}{s_1^2}
$$
这个简洁的公式揭示了几个重要事实：
1.  **偏倚的来源**：诱导出的关联完全由选择概率（$s_0, s_1, s_2$）决定，而与源人群中疾病的原始患病率（$p_1, p_2$）无关。
2.  **无偏倚的条件**：当且仅当 $s_0 s_2 = s_1^2$ 时，$\text{OR}_{\{S=1\}} = 1$，此时没有偏倚。这种情况对应于选择概率在对数尺度上是可加的。
3.  **偏倚的方向**：
    - 如果 $s_0 s_2  s_1^2$，则 $\text{OR}_{\{S=1\}}  1$，产生虚假的负相关。
    - 如果 $s_0 s_2 > s_1^2$，则 $\text{OR}_{\{S=1\}} > 1$，产生虚假的正相关。

### 与其他偏倚的区别

清晰地辨别不同类型的偏倚对于采取正确的应对策略至关重要。

#### 伯克森偏倚 vs. 混杂偏倚

伯克森偏倚常常与**混杂偏倚 (Confounding Bias)** 相混淆，但它们的[因果结构](@entry_id:159914)和应对方法截然相反 。

- **混杂偏倚**：源于一个**共同原因 (common cause)**，即混杂因素 $Z$。其结构为 $X \leftarrow Z \rightarrow Y$。$Z$ 同时影响暴露 $X$ 和结局 $Y$，在 $X$ 和 $Y$ 之间产生一条非因果的“后门路径”。如果不进行处理，观察到的 $X-Y$ 关联是混杂的、有偏的。**解决方法**是对混杂因素 $Z$ 进行条件化（如分层或在[回归模型](@entry_id:163386)中进行调整），以阻断后门路径。

- **伯克森偏倚**：源于对一个**共同效应 (common effect)**，即对撞节点 $S$ 进行条件化。其结构为 $X \rightarrow S \leftarrow Y$。在源人群中，$X$ 和 $Y$ 之间没有关联。问题恰恰**产生于**对 $S$ 的条件化，这个行为打开了一条非因果路径。**解决方法**是避免对对撞节点进行条件化。

简而言之，对于混杂，我们需要**调整**以消除偏倚；而对于对撞节点，调整（条件化）本身就是**引入**偏倚的根源。

#### 伯克森偏倚 vs. 其他选择偏倚

伯克森偏倚是选择偏倚的一种，但并非所有选择偏倚都遵循对撞[节点结构](@entry_id:151019) 。例如，在队列研究中，如果**失访 (loss to follow-up)** 仅与暴露 $A$ 相关（结构为 $A \rightarrow L$，其中 $L$ 为失访[指示变量](@entry_id:266428)），而与结局 $D$ 无关，那么将分析局限于未失访者（对 $L=0$ 条件化）并不会在 $A$ 和 $D$ 之间引入虚假关联。

然而，如果失访本身是一个对撞节点，例如，同时受暴露 $A$ 和结局 $D$（或其早期症状）的影响（结构为 $A \rightarrow L \leftarrow D$），那么因失访导致的选择偏倚就具有了伯克森偏倚的结构，对未失访者进行分析将会引入虚假的关联。

### 对研究实践的启示

理解伯克森偏倚的机制对研究设计和数据分析具有重要的实践意义。

首先，研究者应高度警惕在特定场所（如医院、诊所）或特定人群（如志愿者、幸存者）中进行的研究所固有的选择偏倚风险。在这些情境下发现的关联可能仅存在于该特定样本中，而不能推广到目标人群。

其次，一个常见的误解是，可以通过在回归模型中“调整”选择变量 $S$ 来消除伯克森偏倚。这是错误的 。
- 如果你的研究样本**已经**是经过选择的（例如，所有研究对象都来自医院，即 $S=1$），那么变量 $S$ 在你的数据集中是一个常数。你无法在一个模型中对一个常数进行调整。偏倚已经由抽样过程本身固化在数据中了。
- 如果你有包含已选择和未选择个体的完整人群数据，那么在[回归模型](@entry_id:163386)中加入 $S$ 作为协变量（例如，$\text{模型: } Y \sim X + S$）是一种错误的做法。如前所述，对对撞节点 $S$ 进行条件化（调整）恰恰是**引入**偏倚的行为，它会扭曲 $X$ 和 $Y$ 之间的真实关联。正确的做法是，在没有混杂的情况下，直接分析 $X$ 和 $Y$ 的关系，而**不**将对撞节点 $S$ 放入模型中。

总之，伯克森偏倚是一种微妙而强大的偏倚来源，它提醒我们，研究样本的选择过程本身就是一个需要严格审视的因果步骤。通过运用DAG等因果推理工具，研究者可以更好地识别潜在的对撞[节点结构](@entry_id:151019)，从而避免在研究设计和分析中落入这一统计陷阱。