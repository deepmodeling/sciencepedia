{
    "hands_on_practices": [
        {
            "introduction": "流行病学研究中的一个核心挑战是混杂因素的存在，它会扭曲暴露与结局之间的真实关系。标准化（或g-公式）是一种基本且直观的方法，用于调整已测量的混杂因素。本练习将通过一个具体案例，指导您逐步计算平均处理效应 (ATE)，让您亲手实践如何通过在协变量的不同层中进行加权平均，来获得一个可比较的、无偏的因果效应估计值 。",
            "id": "4575757",
            "problem": "您正在一个包含 $n=1000$ 名个体的观察性队列中，研究二元暴露 $A$ 对二元结局 $Y$ 的因果效应。您将使用对单个测量的基线协变量 $L$ 进行分层的方法，通过插件g-公式来估计平均治疗效应 (ATE)。假设以下识别条件成立：一致性、给定 $L$ 的条件可交换性以及正值性。协变量 $L$ 有三个水平，$L \\in \\{0,1,2\\}$。观测到的 $(L,A,Y)$ 的单元格计数如下：\n- 对于 $L=0$：$A=1$ 组有 $66$ 例 $Y=1$ 和 $154$ 例 $Y=0$；$A=0$ 组有 $54$ 例 $Y=1$ 和 $126$ 例 $Y=0$。\n- 对于 $L=1$：$A=1$ 组有 $56$ 例 $Y=1$ 和 $84$ 例 $Y=0$；$A=0$ 组有 $84$ 例 $Y=1$ 和 $126$ 例 $Y=0$。\n- 对于 $L=2$：$A=1$ 组有 $20$ 例 $Y=1$ 和 $30$ 例 $Y=0$；$A=0$ 组有 $60$ 例 $Y=1$ 和 $140$ 例 $Y=0$。\n\n从平均治疗效应的潜在结局定义出发，使用识别条件来论证一个基于全期望定律的待估参数。然后，仅使用所提供的计数，概述计算 $A=1$ 和 $A=0$ 下的层特异性风险、获得 $L$ 的经验分布，并计算平均治疗效应（风险差）的插件g-公式估计值的数值步骤。请用小数表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "首先验证该问题，以确保其具有科学依据、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- 研究类型：观察性队列\n- 样本量：$n = 1000$\n- 暴露：二元，$A \\in \\{0, 1\\}$\n- 结局：二元，$Y \\in \\{0, 1\\}$\n- 测量的协变量：三元，$L \\in \\{0, 1, 2\\}$\n- 识别假设：一致性、给定 $L$ 的条件可交换性、正值性。\n- 估计方法：分层和插件g-公式。\n- 目标参数：平均治疗效应 (ATE)，表示为风险差。\n- 观测到的单元格计数，$N(L=l, A=a, Y=y)$：\n  - 对于 $L=0$：\n    - $N(L=0, A=1, Y=1) = 66$\n    - $N(L=0, A=1, Y=0) = 154$\n    - $N(L=0, A=0, Y=1) = 54$\n    - $N(L=0, A=0, Y=0) = 126$\n  - 对于 $L=1$：\n    - $N(L=1, A=1, Y=1) = 56$\n    - $N(L=1, A=1, Y=0) = 84$\n    - $N(L=1, A=0, Y=1) = 84$\n    - $N(L=1, A=0, Y=0) = 126$\n  - 对于 $L=2$：\n    - $N(L=2, A=1, Y=1) = 20$\n    - $N(L=2, A=1, Y=0) = 30$\n    - $N(L=2, A=0, Y=1) = 60$\n    - $N(L=2, A=0, Y=0) = 140$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了因果推断方法（用于ATE估计的g-公式）在流行病学中的一个标准应用，其基于潜在结局框架。一致性、可交换性和正值性等假设是该领域的基础。该问题牢固地建立在公认的科学原则之上。\n- **提法恰当**：该问题提供了计算唯一待估参数所需的所有数据和假设。目标陈述清晰。\n- **客观性**：该问题使用精确、无歧义的语言进行陈述，并提供了客观数据。\n- **完整性与一致性**：所有提供的单元格计数之和为 $66 + 154 + 54 + 126 + 56 + 84 + 84 + 126 + 20 + 30 + 60 + 140 = 1000$，与给定的总样本量 $n=1000$ 相匹配。数据内部一致。\n- **正值性**：正值性假设 $P(A=a|L=l) > 0$，在样本中凭经验是满足的。对于 $L$ 的每个分层，暴露组（$A=1$）和非暴露组（$A=0$）中都有个体，从而可以计算层特异性风险。所有 $(L,A)$ 组合的计数都大于零。\n- **可行性**：所有提供的数据都是非负整数，对于一项观察性研究而言在科学上是合理的。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是一个提法恰当、一致且在应用流行病学中具有科学合理性的问题。我将继续进行解答。\n\n### 因果框架与识别\n平均治疗效应 (ATE) 在潜在结局框架内定义。令 $Y^a$ 表示一个个体在暴露水平被（可能与事实相反地）设定为 $a$ 时，本应观察到的潜在结局。对于二元结局，ATE 即风险差 (RD)：\n$$ATE_{RD} = E[Y^{a=1}] - E[Y^{a=0}] = P(Y^{a=1}=1) - P(Y^{a=0}=1)$$\n这个因果量是不能直接观测的。我们必须使用所提供的识别假设，将 ATE 用可观测数据的概率来表示。\n\n关键步骤是根据协变量 $L$ 进行标准化。根据全期望定律，我们可以将边际潜在结局概率写成层特异性潜在结局概率的加权平均值：\n$$P(Y^a=1) = \\sum_{l=0}^{2} P(Y^a=1 | L=l) P(L=l)$$\n现在，我们应用识别假设：\n1.  **条件可交换性**：给定协变量 $L$，暴露分配 $A$ 独立于潜在结局 $Y^a$。形式上，$Y^a \\perp A | L$ 对 $a \\in \\{0, 1\\}$ 成立。这个假设允许我们写出：\n    $$P(Y^a=1 | L=l) = P(Y^a=1 | A=a, L=l)$$\n2.  **一致性**：对于接受了暴露 $A=a$ 的个体，其观测结局 $Y$ 等于其潜在结局 $Y^a$。形式上，如果 $A=a$，那么 $Y=Y^a$。这使我们能够将潜在结局与观测结局联系起来：\n    $$P(Y^a=1 | A=a, L=l) = P(Y=1 | A=a, L=l)$$\n结合这些步骤，我们可以用可观测的量来表示潜在结局概率：\n$$P(Y^a=1) = \\sum_{l=0}^{2} P(Y=1 | A=a, L=l) P(L=l)$$\n这被称为g-公式或标准化公式。因此，ATE 可以被识别为：\n$$ATE_{RD} = \\sum_{l=0}^{2} P(Y=1 | A=1, L=l) P(L=l) - \\sum_{l=0}^{2} P(Y=1 | A=0, L=l) P(L=l)$$\n$$ATE_{RD} = \\sum_{l=0}^{2} \\left[ P(Y=1 | A=1, L=l) - P(Y=1 | A=0, L=l) \\right] P(L=l)$$\n\n3. **正值性**：$P(A=a|L=l) > 0$ 对所有的 $a,l$ 成立，确保了条件概率 $P(Y=1|A=a,L=l)$ 是良定义的，并且可以从数据中估计。\n\n### 插件估计\n我们通过将g-公式中每个组成部分的经验估计值代入来估计 ATE。\n\n**步骤 1：估计协变量的边际分布, $\\hat{P}(L=l)$**\n首先，我们计算 $L$ 的每个分层中的个体数量。设 $N_l$ 为 $L=l$ 的个体数。\n- $N_0 = 66 + 154 + 54 + 126 = 400$\n- $N_1 = 56 + 84 + 84 + 126 = 350$\n- $N_2 = 20 + 30 + 60 + 140 = 250$\n总样本量为 $n = N_0 + N_1 + N_2 = 400 + 350 + 250 = 1000$。\n经验概率为：\n- $\\hat{P}(L=0) = \\frac{N_0}{n} = \\frac{400}{1000} = 0.4$\n- $\\hat{P}(L=1) = \\frac{N_1}{n} = \\frac{350}{1000} = 0.35$\n- $\\hat{P}(L=2) = \\frac{N_2}{n} = \\frac{250}{1000} = 0.25$\n\n**步骤 2：估计层特异性风险, $\\hat{P}(Y=1 | A=a, L=l)$**\n我们计算由 $(L, A)$ 定义的每个分层中结局为 ($Y=1$) 的个体比例。\n- 对于 $L=0$：\n  - $\\hat{P}(Y=1 | A=1, L=0) = \\frac{N(L=0, A=1, Y=1)}{N(L=0, A=1)} = \\frac{66}{66+154} = \\frac{66}{220} = 0.3$\n  - $\\hat{P}(Y=1 | A=0, L=0) = \\frac{N(L=0, A=0, Y=1)}{N(L=0, A=0)} = \\frac{54}{54+126} = \\frac{54}{180} = 0.3$\n- 对于 $L=1$：\n  - $\\hat{P}(Y=1 | A=1, L=1) = \\frac{N(L=1, A=1, Y=1)}{N(L=1, A=1)} = \\frac{56}{56+84} = \\frac{56}{140} = 0.4$\n  - $\\hat{P}(Y=1 | A=0, L=1) = \\frac{N(L=1, A=0, Y=1)}{N(L=1, A=0)} = \\frac{84}{84+126} = \\frac{84}{210} = 0.4$\n- 对于 $L=2$：\n  - $\\hat{P}(Y=1 | A=1, L=2) = \\frac{N(L=2, A=1, Y=1)}{N(L=2, A=1)} = \\frac{20}{20+30} = \\frac{20}{50} = 0.4$\n  - $\\hat{P}(Y=1 | A=0, L=2) = \\frac{N(L=2, A=0, Y=1)}{N(L=2, A=0)} = \\frac{60}{60+140} = \\frac{60}{200} = 0.3$\n\n**步骤 3：计算标准化风险和 ATE 估计值**\n首先，我们计算如果所有人都被暴露 ($A=1$) 时的标准化风险：\n$$\\hat{P}(Y^{a=1}=1) = \\sum_{l=0}^{2} \\hat{P}(Y=1 | A=1, L=l) \\hat{P}(L=l)$$\n$$\\hat{P}(Y^{a=1}=1) = (0.3)(0.4) + (0.4)(0.35) + (0.4)(0.25)$$\n$$\\hat{P}(Y^{a=1}=1) = 0.12 + 0.14 + 0.10 = 0.36$$\n接下来，我们计算如果所有人都未被暴露 ($A=0$) 时的标准化风险：\n$$\\hat{P}(Y^{a=0}=1) = \\sum_{l=0}^{2} \\hat{P}(Y=1 | A=0, L=l) \\hat{P}(L=l)$$\n$$\\hat{P}(Y^{a=0}=1) = (0.3)(0.4) + (0.4)(0.35) + (0.3)(0.25)$$\n$$\\hat{P}(Y^{a=0}=1) = 0.12 + 0.14 + 0.075 = 0.335$$\n最后，ATE（风险差）的插件估计值是这些标准化风险之间的差值：\n$$\\widehat{ATE}_{RD} = \\hat{P}(Y^{a=1}=1) - \\hat{P}(Y^{a=0}=1)$$\n$$\\widehat{ATE}_{RD} = 0.36 - 0.335 = 0.025$$\n题目要求答案四舍五入到四位有效数字。数字 $0.025$ 有两位有效数字。为了将此结果表示为四位有效数字，我们在后面添加零。\n$$\\widehat{ATE}_{RD} = 0.02500$$",
            "answer": "$$\\boxed{0.02500}$$"
        },
        {
            "introduction": "逆概率加权 (IPW) 是控制混杂的另一种强大技术，其核心思想与标准化不同，但目标一致。通过为每个研究对象分配一个基于其接受处理概率的权重，IPW可以创建一个“伪人群”，在这个人群中，暴露分配与混杂因素无关。 这个练习将让您从原始数据出发，计算倾向性得分、构建权重，并最终估算平均处理效应，从而深入理解IPW如何巧妙地平衡组间差异。",
            "id": "4575753",
            "problem": "一项观察性队列研究评估了单剂次流感疫苗接种对一个月后测量的C反应蛋白（记为 $Y$，单位为毫克/升）的因果效应。治疗是一个指示变量 $A \\in \\{0,1\\}$，其中 $A=1$ 表示接种疫苗，$A=0$ 表示未接种疫苗。单个基线协变量 $L \\in \\{0,1\\}$ 代表年龄组，其中 $L=1$ 表示年龄 $\\geq 50$ 岁，$L=0$ 表示年龄  50 岁。样本包含 $8$ 名个体，其观测数据 $(L_i, A_i, Y_i)$ 如下：\n\n- 个体 $1$：$(0, 1, 2.1)$\n- 个体 $2$：$(0, 1, 1.8)$\n- 个体 $3$：$(0, 1, 2.5)$\n- 个体 $4$：$(0, 0, 3.0)$\n- 个体 $5$：$(0, 0, 2.7)$\n- 个体 $6$：$(1, 1, 1.9)$\n- 个体 $7$：$(1, 0, 3.3)$\n- 个体 $8$：$(1, 0, 3.5)$\n\n假设以下数据生成条件成立：一致性、正值性和给定 $L$ 的条件可交换性。使用逻辑回归 $\\logit\\{\\Pr(A=1 \\mid L)\\}$ 作为 $L$ 的线性函数来对治疗分配进行建模。\n\n任务：\n- 使用样本拟合 $A$ 关于 $L$ 的逻辑回归，并获得当 $L=0$ 和 $L=1$ 时的拟合倾向性得分 $e(L)=\\Pr(A=1 \\mid L)$。\n- 对每个个体，计算治疗组个体（$A=1$）的逆概率权重 $1/e(L)$ 和对照组个体（$A=0$）的逆概率权重 $1/\\{1-e(L)\\}$。\n- 使用这些权重，计算平均治疗效应 (ATE) 的逆概率加权估计值。ATE 定义为治疗下的平均潜在结果与对照下的平均潜在结果之差，以毫克/升为单位表示。\n\n将最终的 ATE 估计值表示为以毫克/升为单位的精确分数（不要四舍五入）。",
            "solution": "我们从因果定义和假设开始。平均治疗效应 (ATE) 定义为 $E[Y(1) - Y(0)]$，其中 $Y(1)$ 和 $Y(0)$ 分别是接受治疗和不接受治疗的潜在结果。在一致性、正值性和给定 $L$ 的条件可交换性假设下，我们可以从观测数据中识别 ATE。一种常用的方法是逆概率加权 (IPW)，即我们用接受所观测到的治疗的概率的倒数来对观测结果进行加权。倾向性得分是 $e(L) = \\Pr(A=1 \\mid L)$。ATE 的 Horvitz–Thompson IPW 估计量是\n$$\n\\widehat{\\text{ATE}} \\;=\\; \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{e(L_i)} - \\frac{(1-A_i) Y_i}{1 - e(L_i)} \\right),\n$$\n在我们的样本中 $n=8$。\n\n为了获得 $e(L)$，我们使用以下模型拟合 $A$ 关于 $L$ 的逻辑回归\n$$\n\\logit\\{\\Pr(A=1 \\mid L)\\} \\;=\\; \\beta_0 + \\beta_1 L,\n$$\n其中 $\\logit(p) = \\ln\\left(\\frac{p}{1-p}\\right)$ 且 $L \\in \\{0,1\\}$。因为 $L$ 是二元变量，所以逻辑回归导出两个不同的线性预测量：对于 $L=0$ 是 $\\eta_0 = \\beta_0$，对于 $L=1$ 是 $\\eta_1 = \\beta_0 + \\beta_1$，因此得到两个概率 $p_0 = \\expit(\\eta_0)$ 和 $p_1 = \\expit(\\eta_1)$，其中 $\\expit(x) = \\frac{1}{1+\\exp(-x)}$。\n\n对于每个层 $L=\\ell$ 的分组伯努利对数似然为\n$$\n\\ell(p_{\\ell}) \\;=\\; \\sum_{i:L_i=\\ell} \\left\\{ A_i \\ln(p_{\\ell}) + (1-A_i)\\ln(1 - p_{\\ell}) \\right\\},\n$$\n所以得分方程 $\\frac{\\partial \\ell(p_{\\ell})}{\\partial p_{\\ell}} = 0$ 得到\n$$\np_{\\ell} \\;=\\; \\frac{\\sum_{i:L_i=\\ell} A_i}{\\sum_{i:L_i=\\ell} 1},\n$$\n也就是说，层特定概率的最大似然估计 (MLE) 等于该层中观测到的治疗比例。因此，MLE 满足\n$$\n\\hat{p}_0 \\;=\\; \\Pr(A=1 \\mid L=0) \\;=\\; \\frac{\\text{treated in }L=0}{\\text{total in }L=0}, \\quad\n\\hat{p}_1 \\;=\\; \\Pr(A=1 \\mid L=1) \\;=\\; \\frac{\\text{treated in }L=1}{\\text{total in }L=1},\n$$\n和\n$$\n\\hat{\\beta}_0 \\;=\\; \\logit(\\hat{p}_0), \\qquad \\hat{\\beta}_1 \\;=\\; \\logit(\\hat{p}_1) - \\logit(\\hat{p}_0).\n$$\n\n计算各层的计数：\n- 对于 $L=0$：有 $5$ 名个体（索引 $1$ 到 $5$），其中 $3$ 名接受治疗（个体 $1, 2, 3$ 的 $A=1$），所以\n$$\n\\hat{p}_0 \\;=\\; \\frac{3}{5} \\;=\\; 0.6.\n$$\n- 对于 $L=1$：有 $3$ 名个体（索引 $6$ 到 $8$），其中 $1$ 名接受治疗（个体 $6$ 的 $A=1$），所以\n$$\n\\hat{p}_1 \\;=\\; \\frac{1}{3} \\;=\\; 0.\\overline{3}.\n$$\n\n因此，拟合的倾向性得分是\n$$\ne(0) \\;=\\; \\hat{p}_0 \\;=\\; \\frac{3}{5}, \\qquad e(1) \\;=\\; \\hat{p}_1 \\;=\\; \\frac{1}{3}.\n$$\n\n接下来，计算逆概率权重。对于治疗组观测值（$A=1$），权重为 $1/e(L)$；对于对照组观测值（$A=0$），权重为 $1/\\{1-e(L)\\}$：\n- 对于 $L=0$：治疗组的权重为 $1/e(0) = \\frac{1}{3/5} = \\frac{5}{3}$；对照组的权重为 $1/\\{1-e(0)\\} = \\frac{1}{1-3/5} = \\frac{1}{2/5} = \\frac{5}{2}$。\n- 对于 $L=1$：治疗组的权重为 $1/e(1) = \\frac{1}{1/3} = 3$；对照组的权重为 $1/\\{1-e(1)\\} = \\frac{1}{1-1/3} = \\frac{1}{2/3} = \\frac{3}{2}$。\n\n现在计算 Horvitz–Thompson 估计量的分量。令\n$$\nS_{\\text{treat}} \\;=\\; \\sum_{i=1}^{n} \\frac{A_i Y_i}{e(L_i)}, \\qquad\nS_{\\text{control}} \\;=\\; \\sum_{i=1}^{n} \\frac{(1-A_i) Y_i}{1 - e(L_i)}.\n$$\n那么\n$$\n\\widehat{\\text{ATE}} \\;=\\; \\frac{1}{n} \\left( S_{\\text{treat}} - S_{\\text{control}} \\right).\n$$\n\n通过对治疗组个体求和来计算 $S_{\\text{treat}}$：\n- 个体 $1$：$L=0$, $A=1$, $Y=2.1$，贡献值 $= 2.1 \\times \\frac{5}{3} = \\frac{21}{10} \\times \\frac{5}{3} = \\frac{105}{30} = 3.5$。\n- 个体 $2$：$L=0$, $A=1$, $Y=1.8$，贡献值 $= 1.8 \\times \\frac{5}{3} = \\frac{9}{5} \\times \\frac{5}{3} = \\frac{45}{15} = 3.0$。\n- 个体 $3$：$L=0$, $A=1$, $Y=2.5$，贡献值 $= 2.5 \\times \\frac{5}{3} = \\frac{5}{2} \\times \\frac{5}{3} = \\frac{25}{6}$。\n- 个体 $6$：$L=1$, $A=1$, $Y=1.9$，贡献值 $= 1.9 \\times 3 = \\frac{19}{10} \\times 3 = \\frac{57}{10}$。\n\n因此，\n$$\nS_{\\text{treat}} \\;=\\; 3.5 + 3.0 + \\frac{25}{6} + \\frac{57}{10} \\;=\\; \\frac{491}{30}.\n$$\n\n通过对对照组个体求和来计算 $S_{\\text{control}}$：\n- 个体 $4$：$L=0$, $A=0$, $Y=3.0$，贡献值 $= 3.0 \\times \\frac{5}{2} = \\frac{3}{1} \\times \\frac{5}{2} = \\frac{15}{2}$。\n- 个体 $5$：$L=0$, $A=0$, $Y=2.7$，贡献值 $= 2.7 \\times \\frac{5}{2} = \\frac{27}{10} \\times \\frac{5}{2} = \\frac{135}{20}$。\n- 个体 $7$：$L=1$, $A=0$, $Y=3.3$，贡献值 $= 3.3 \\times \\frac{3}{2} = \\frac{33}{10} \\times \\frac{3}{2} = \\frac{99}{20}$。\n- 个体 $8$：$L=1$, $A=0$, $Y=3.5$，贡献值 $= 3.5 \\times \\frac{3}{2} = \\frac{35}{10} \\times \\frac{3}{2} = \\frac{105}{20}$。\n\n因此，\n$$\nS_{\\text{control}} \\;=\\; \\frac{15}{2} + \\frac{135}{20} + \\frac{99}{20} + \\frac{105}{20}\n\\;=\\; \\frac{489}{20}.\n$$\n\n最后，当 $n=8$ 时，IPW ATE 估计值为\n$$\n\\widehat{\\text{ATE}} \\;=\\; \\frac{1}{8} \\left( \\frac{491}{30} - \\frac{489}{20} \\right)\n\\;=\\; \\frac{1}{8} \\left( \\frac{982}{60} - \\frac{1467}{60} \\right)\n\\;=\\; \\frac{1}{8} \\left( -\\frac{485}{60} \\right)\n\\;=\\; -\\frac{97}{96}.\n$$\n这是一个以毫克/升为单位的精确分数。负号表示，在为调整由 $L$ 引起的混杂而进行重新加权后，该样本中疫苗接种与平均C反应蛋白水平降低 $\\frac{97}{96}$ 毫克/升相关。",
            "answer": "$$\\boxed{-\\frac{97}{96}}$$"
        },
        {
            "introduction": "当暴露与结局之间存在未测量的混杂因素时，传统的调整方法（如标准化或IPW）便会失效。然而，这并不意味着因果推断的终结。“前门准则”提供了一种精妙的识别策略，它利用一个完全中介了暴露效应的中间变量（中介者）来估计因果效应。 这个练习将向您展示，即便在存在棘手的未测量混杂的情况下，如何利用暴露-中介-结局的路径信息，分步“绕过”混杂，准确量化暴露对结局的净影响。",
            "id": "4575734",
            "problem": "考虑一个由有向无环图 (DAG) 表示的因果系统，该系统包含节点 $A$（二元暴露）、$M$（分类中介变量）和 $Y$（连续结果），其中路径为 $A \\rightarrow M \\rightarrow Y$，并且存在一个未测量的混杂因素 $U$ 影响 $A$ 和 $Y$。假设以下条件成立：(i) $A$ 对 $M$ 的效应不存在未测量的混杂，(ii) 以 $A$ 为条件可以阻断所有从 $M$ 到 $Y$ 的后门路径，以及 (iii) $A$ 仅通过 $M$ 影响 $Y$（不存在直接路径 $A \\rightarrow Y$）。同时假设正性 (positivity) 条件成立：对于 $M$ 的所有水平 $m$ 和 $A$ 的所有水平 $a$，条件概率 $P(M=m \\mid A=a)$ 和 $P(A=a)$ 均严格为正。\n\n设 $A \\in \\{0,1\\}$ 且 $M \\in \\{m_{1}, m_{2}, m_{3}\\}$。通过一项设计良好的研究，可凭经验获得以下量值：\n\n- 边际暴露分布：$P(A=1)=0.35$，$P(A=0)=0.65$。\n- 条件分布 $P(M \\mid A)$：\n  - 当 $A=0$ 时：$P(M=m_{1} \\mid A=0)=0.20$，$P(M=m_{2} \\mid A=0)=0.50$，$P(M=m_{3} \\mid A=0)=0.30$。\n  - 当 $A=1$ 时：$P(M=m_{1} \\mid A=1)=0.60$，$P(M=m_{2} \\mid A=1)=0.30$，$P(M=m_{3} \\mid A=1)=0.10$。\n- 条件期望 $E[Y \\mid M, A]$：\n  - $E[Y \\mid M=m_{1}, A=0]=2.10$，$E[Y \\mid M=m_{1}, A=1]=2.80$。\n  - $E[Y \\mid M=m_{2}, A=0]=3.00$，$E[Y \\mid M=m_{2}, A=1]=3.20$。\n  - $E[Y \\mid M=m_{3}, A=0]=4.50$，$E[Y \\mid M=m_{3}, A=1]=4.60$。\n\n在给定假设和量值下，使用前门识别策略计算 $A$ 对 $Y$ 的平均因果效应，其定义为 $E[Y \\mid \\operatorname{do}(A=1)] - E[Y \\mid \\operatorname{do}(A=0)]$。将你的最终答案表示为一个实数，并四舍五入到四位有效数字。无需单位。",
            "solution": "问题陈述经评估有效。该问题在科学上基于使用有向无环图 (DAG) 进行因果推断的既定理论，特别是前门识别策略。所提供的假设——(i) $A-M$ 关系没有未测量的混杂，(ii) 以 $A$ 为条件阻断了从 $M$ 到 $Y$ 的所有后门路径，以及 (iii) $A$ 仅通过 $M$ 影响 $Y$——是前门准则所需的精确条件。该问题是适定的，为计算提供了所有必要的定量数据，并且这些数据是内部一致的。概率之和按要求为 $1$：$P(A=1)+P(A=0) = 0.35+0.65 = 1$，$\\sum_m P(M=m|A=0) = 0.20+0.50+0.30=1$，以及 $\\sum_m P(M=m|A=1) = 0.60+0.30+0.10=1$。因此，该问题可以使用标准方法求解。\n\n目标是计算二元暴露 $A$ 对连续结果 $Y$ 的平均因果效应 (ACE)，其定义为 $ACE = E[Y \\mid \\operatorname{do}(A=1)] - E[Y \\mid \\operatorname{do}(A=0)]$。影响 $A$ 和 $Y$ 的未测量混杂因素 $U$ 的存在，排除了使用简单调整方法的可能性，因为 $E[Y \\mid A=a]$ 不等于 $E[Y \\mid \\operatorname{do}(A=a)]$。然而，满足前门准则使得因果效应的识别成为可能。\n\n在给定假设下，应用 do-演算的规则，从全概率定律推导出在对 $A$ 进行干预时连续结果 $Y$ 的期望值的前门识别公式。该公式为：\n$$\nE[Y \\mid \\operatorname{do}(A=a)] = \\sum_{m} \\left( \\sum_{a'} E[Y \\mid M=m, A=a'] P(A=a') \\right) P(M=m \\mid A=a)\n$$\n其中求和遍及中介变量 $M$ 和暴露 $A$ 的所有水平。\n\n这个公式可以分两步计算。\n首先，我们计算括号中的项，它代表了通过对 $A$ 进行调整而识别出的中介变量 $M$ 对结果 $Y$ 的因果效应。我们将这个量表示为 $g(m)$：\n$$\ng(m) = \\sum_{a' \\in \\{0,1\\}} E[Y \\mid M=m, A=a'] P(A=a')\n$$\n我们使用给定的数据 $P(A=0)=0.65$ 和 $P(A=1)=0.35$，对中介变量 $M \\in \\{m_1, m_2, m_3\\}$ 的每个水平进行计算。\n\n对于 $M=m_1$：\n$$\ng(m_1) = E[Y \\mid M=m_1, A=0]P(A=0) + E[Y \\mid M=m_1, A=1]P(A=1)\n$$\n$$\ng(m_1) = (2.10)(0.65) + (2.80)(0.35) = 1.365 + 0.98 = 2.345\n$$\n\n对于 $M=m_2$：\n$$\ng(m_2) = E[Y \\mid M=m_2, A=0]P(A=0) + E[Y \\mid M=m_2, A=1]P(A=1)\n$$\n$$\ng(m_2) = (3.00)(0.65) + (3.20)(0.35) = 1.95 + 1.12 = 3.07\n$$\n\n对于 $M=m_3$：\n$$\ng(m_3) = E[Y \\mid M=m_3, A=0]P(A=0) + E[Y \\mid M=m_3, A=1]P(A=1)\n$$\n$$\ng(m_3) = (4.50)(0.65) + (4.60)(0.35) = 2.925 + 1.61 = 4.535\n$$\n\n其次，我们使用这些值来计算 $a=1$ 和 $a=0$ 时的潜在结果 $E[Y \\mid \\operatorname{do}(A=a)]$。主公式简化为：\n$$\nE[Y \\mid \\operatorname{do}(A=a)] = \\sum_{m \\in \\{m_1, m_2, m_3\\}} g(m) P(M=m \\mid A=a)\n$$\n\n对于干预 $\\operatorname{do}(A=1)$：\n$$\nE[Y \\mid \\operatorname{do}(A=1)] = g(m_1)P(M=m_1 \\mid A=1) + g(m_2)P(M=m_2 \\mid A=1) + g(m_3)P(M=m_3 \\mid A=1)\n$$\n$$\nE[Y \\mid \\operatorname{do}(A=1)] = (2.345)(0.60) + (3.07)(0.30) + (4.535)(0.10)\n$$\n$$\nE[Y \\mid \\operatorname{do}(A=1)] = 1.407 + 0.921 + 0.4535 = 2.7815\n$$\n\n对于干预 $\\operatorname{do}(A=0)$：\n$$\nE[Y \\mid \\operatorname{do}(A=0)] = g(m_1)P(M=m_1 \\mid A=0) + g(m_2)P(M=m_2 \\mid A=0) + g(m_3)P(M=m_3 \\mid A=0)\n$$\n$$\nE[Y \\mid \\operatorname{do}(A=0)] = (2.345)(0.20) + (3.07)(0.50) + (4.535)(0.30)\n$$\n$$\nE[Y \\mid \\operatorname{do}(A=0)] = 0.469 + 1.535 + 1.3605 = 3.3645\n$$\n\n最后，我们通过计算这两个潜在结果的差值来计算平均因果效应 (ACE)：\n$$\nACE = E[Y \\mid \\operatorname{do}(A=1)] - E[Y \\mid \\operatorname{do}(A=0)]\n$$\n$$\nACE = 2.7815 - 3.3645 = -0.583\n$$\n问题要求答案四舍五入到四位有效数字。因此，ACE 为 $-0.5830$。",
            "answer": "$$\\boxed{-0.5830}$$"
        }
    ]
}