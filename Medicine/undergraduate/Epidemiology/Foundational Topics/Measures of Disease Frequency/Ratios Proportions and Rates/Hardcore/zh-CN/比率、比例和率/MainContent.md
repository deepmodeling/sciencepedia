## 引言
流行病学作为一门研究人群中健康与疾病分布的定量科学，其基石在于能够精确地测量疾病发生的频率。若无一套严谨的度量体系，我们将无法客观描述疾病负担，比较不同人群的风险，或评估公共卫生干预措施的成效。本文旨在系统性地解决这一核心问题，深入剖析流行病学定量分析的三大支柱：比、比例和率。通过学习本文，您将能够掌握从基础到高级的疾病频率测量方法。在“原理与机制”章节中，我们将从基本定义出发，辨析比、比例与率的差异，并探讨如何应用它们计算患病率和发病率，同时揭示混杂、标准化等复杂概念。接下来的“应用与跨学科联系”章节将展示这些理论在流行病学实践、临床医学、公共卫生政策等领域的广泛应用。最后，“动手实践”部分将通过具体问题，帮助您巩固和应用所学知识。现在，让我们从最基本的原理开始，深入探索这些强大的流行病学工具。

## 原理与机制

流行病学是一门以定量方法为核心的学科，旨在描述和解释人群中健康相关状态或事件的分布和决定因素。为了实现这一目标，我们需要一套精确的工具来衡量疾病的频率。本章将系统地阐述疾病频率测量的三大基石：比（ratio）、比例（proportion）和率（rate），并从基本定义出发，逐步深入到它们之间的相互关系以及在实际研究中遇到的复杂问题，如混杂、标准化和[竞争风险](@entry_id:173277)。

### 疾病频率的基本度量

在流行病学中，我们首先需要区分三个基本的数学概念：比、比例和率。

- **比（Ratio）** 是两个任意数量的比较，形式为 $a/b$。例如，一个医院的医生与护士数量之比。

- **比例（Proportion）** 是一种特殊的比，其分子是分母的一部分，形式为 $a/(a+b)$。因此，比例的值总是在 $0$ 到 $1$ 之间，并且是无量纲的。它通常用来描述某个部分在整体中所占的份额，例如，某一人群中女性所占的比例。

- **率（Rate）** 是衡量一个量相对于另一个量的变化速度，其分母通常包含时间单位。它描述了事件在单位时间内发生的频率，因此具有量纲（例如，时间$^{-1}$）。

这三个概念为我们理解和[计算流行病学](@entry_id:636134)中更具体的疾病频率指标——患病率和发病率——奠定了基础。

### 衡量疾病存量：患病率

**患病率（Prevalence）** 是一个比例，它衡量的是在特定时间点或特定时期内，人群中患有某种疾病（包括新发和既有病例）的个体所占的比例 。患病率是衡量疾病负担的一个静态“快照”。

患病率的计算公式为：
$$
P = \frac{\text{特定时间点存在的病例数}}{\text{同一时间点的总人口数}}
$$

例如，一项在一个时间点进行的横断面调查（cross-sectional survey）发现，在抽样的 $5,000$ 名个体中，有 $300$ 人患有某种慢性病。那么，该人群在该时间点的点患病率（point prevalence）就是 $300 / 5,000 = 0.06$ 或 $6\%$ 。患病率是一个无量纲的比例，反映了在特定时刻疾病在人群中的分布情况。除点患病率外，还有时期患病率（period prevalence），它衡量在某一时期内（如一年）患病个体所占的比例 。

### 衡量新发疾病：发病

与衡量疾病存量的患病率不同，**发病（Incidence）** 关注的是新发病例的出现。流行病学提供了两种核心方法来量化发病：发病比例和发病率。

#### 发病比例（累计发病率或风险）

**发病比例（Incidence Proportion）**，更常被称为 **累计发病率（Cumulative Incidence, CI）** 或 **风险（Risk）**，指的是在一个特定时间段内，一个处于风险中的人群发生新病例的比例 [@problem_id:4837912, @problem_id:4632263]。它直接衡量了个体在给定时期内患病的平均概率。

其计算公式为：
$$
\text{CI (Risk)} = \frac{\text{特定时期内的新发病例数}}{\text{时期开始时的风险人口数}}
$$

风险的计算需要一个 **封闭队列（closed cohort）**，即一个成员固定、在研究开始时均未患病、并被随访一段固定时间的群体。例如，一项研究对 $4,000$ 名最初无病的人群进行了为期 $3$ 年的随访，期间观察到 $120$ 例新发病例。那么，这 $3$ 年的累计发病率（或风险）为 $120 / 4,000 = 0.03$ 。风险是一个介于 $0$ 和 $1$ 之间的无量纲概率，其解释必须与特定的随访时间相关联（例如，“3年风险”）。

**核心概念：分母的重要性**
在计算风险时，分母的选择至关重要。分母必须是 **风险人口（population at risk）**，即那些在研究开始时易感、有可能发展成病例的个体。将总人口用作分母是一个常见的概念性错误，这会稀释风险的真实度量，导致偏倚。

考虑这样一个情景：在一个拥有 $120,000$ 人的城镇，一个为期 $8$ 周的监测期内出现了 $1,260$ 例新发感染。假设总人口中有 $25\%$ 的人接种了完全保护性疫苗，另有 $5\%$ 的人因既往感染而具有完全免疫力。这些免疫个体（总计 $120,000 \times (0.25 + 0.05) = 36,000$ 人）在定义上并非风险人口。
- **错误的计算**：如果使用总人口作为分母，会得到一个被低估的“风险”：$IP_{\text{naive}} = \frac{1,260}{120,000} = 0.0105$。
- **正确的计算**：真正的风险人口是总人口减去免疫人口，即 $120,000 - 36,000 = 84,000$ 人。因此，正确的风险是 $IP_{\text{correct}} = \frac{1,260}{84,000} = 0.015$。

错误地使用总人口作为分母，导致风险被低估了 $30\%$（相对偏倚为 $(0.0105 - 0.015) / 0.015 = -0.3000$）。这清晰地表明，准确界定并使用风险人口是计算真实风险的先决条件。

#### 发病率（发病密度）

**发病率（Incidence Rate）**，又称 **发病密度（Incidence Density）**，是一个真正的率，它衡量新病例在风险人口中出现的“速度”或强度 [@problem_id:4837912, @problem_id:4632263]。

其计算公式为：
$$
\text{IR} = \frac{\text{新发病例数}}{\text{总人时数}}
$$

分母 **人时（Person-Time）** 是所有个体处于风险状态下被观察时间的总和。发病率适用于 **动态队列（dynamic cohort）**，其中个体在不同时间进入和退出研究，随访时间各不相同。发病率的单位是时间的倒数，例如“每 $1000$ 人年”。

为了理解人时的计算，我们来看一个具体的例子 。一个研究随访了 $6$ 名参与者，记录了他们的进入、[退出时间](@entry_id:193122)和状态：
- 参与者1：$0.0$ 年进入，$2.3$ 年发病。贡献人时：$2.3 - 0.0 = 2.3$ 人年。
- 参与者2：$0.5$ 年进入，$2.0$ 年失访。贡献人时：$2.0 - 0.5 = 1.5$ 人年。
- 参与者3：$1.0$ 年进入，$3.0$ 年研究结束时仍未发病。贡献人时：$3.0 - 1.0 = 2.0$ 人年。
- 参与者4：$1.2$ 年进入，$1.7$ 年发病。贡献人时：$1.7 - 1.2 = 0.5$ 人年。
- 参与者5：$2.4$ 年进入，$2.6$ 年退出。贡献人时：$2.6 - 2.4 = 0.2$ 人年。
- 参与者6：$0.0$ 年进入，$0.8$ 年迁出。贡献人时：$0.8 - 0.0 = 0.8$ 人年。

总人时数是所有个体贡献时间的总和：$2.3 + 1.5 + 2.0 + 0.5 + 0.2 + 0.8 = 7.3$ 人年。研究期间共发生 $2$ 例事件。因此，发病率为 $\frac{2 \text{ 事件}}{7.3 \text{ 人年}} \approx 0.274$ 事件/人年，或 $27.4$ 事件/每 $100$ 人年。这种方法精确地利用了每个个体贡献的风险时间信息。

### 流行病学指标间的相互关系

#### 发病率与患病率的关系

患病率和发病率通过疾病的 **病程（duration）** 相互关联。在一个人口规模稳定、发病率 $(I)$ 和平均病程 $(d)$ 恒定的理想状态（即[稳态](@entry_id:139253)）下，进入患病人群的“流量”（新发病例）应等于离开患病人群的“流量”（痊愈或死亡）。
流入率 = 流出率
$I \times (\text{易感人群}) = \frac{1}{d} \times (\text{患病人群})$

如果疾病是罕见的，那么绝大多数人都处于易感状态，患病率 $P$ 很低。此时，我们可以得到一个非常有用的近似关系 ：
$$
P \approx I \times d
$$
这个公式直观地说明了患病率取决于新发病例的速度和患者带病生存的时间。对于一个罕见病，我们可以通过更精确的公式 $I \times (1 - P) = P/d$ 推导出患病率 $P = \frac{I \times d}{1 + I \times d}$ 。

#### 风险与率的关系

累计发病率（风险）和发病率（率）之间也存在着深刻的数学联系。发病率的理论基础是 **风险函数（hazard function）** $\lambda(t)$，它表示在 $t$ 时刻仍然健康的个体发生事件的瞬时速率 [@problem_id:4837928, @problem_id:4628667]。

如果风险函数 $\lambda$ 在时间段 $[0, T]$ 内保持不变，那么到时间 $T$ 为止的累计发病率 $CI(T)$ 与 $\lambda$ 的精确关系为 ：
$$
CI(T) = 1 - \exp(-\lambda T)
$$
这个公式来自于生存函数 $S(T) = \exp(-\lambda T)$，其中 $S(T)$ 是存活过时间 $T$ 的概率，而 $CI(T) = 1 - S(T)$。

当疾病罕见时，即 $\lambda T$ 的值很小，指数函数 $e^{-x}$ 可以通过[泰勒级数近似](@entry_id:143104)为 $1 - x$。此时，上述精确关系可以简化为一个广为使用的近似公式 ：
$$
CI(T) \approx \lambda T
$$
例如，在一个 $5,000$ 人的队列中，随访 $2$ 年，发病率 $\lambda$ 约为 $0.006036$ 例/人年。那么 $\lambda T \approx 0.012072$。使用精确公式计算的 $2$ 年风险为 $1 - \exp(-0.012072) \approx 0.011999$，而直接用近似公式得到的结果是 $0.012072$，两者极为接近。

在更高级的生存分析中，发病率比（Incidence Rate Ratio, IRR）是在假定风险比（Hazard Ratio, HR）恒定（即[比例风险假设](@entry_id:163597)）的条件下，对 HR 的一个良好估计 。

### 比较疾病频率：混杂与标准化

流行病学研究的核心任务之一是比较不同人群（例如，暴露组与非暴露组）的疾病频率。然而，直接比较原始的（或称“粗”）率可能会产生误导，因为人群在其他风险因素（如年龄、性别）上的构成可能不同。这种效应的混合被称为 **混杂（confounding）**。

#### 辛普森悖論：一个关于混杂的警示

**[辛普森悖论](@entry_id:136589)（Simpson's Paradox）** 是一个经典的统计现象，它鲜明地揭示了混杂的危险。在[辛普森悖论](@entry_id:136589)中，分层分析中观察到的关联方向，在合并数据进行总体（粗）分析时却发生逆转。

考虑一项关于某暴露因素与疾病结局的研究，按年龄分为年轻和年老两个阶层 。
- **年轻组**：暴露组发病率（$180/90,000 = 0.002$）是未暴露组（$10/10,000 = 0.001$）的 $2$ 倍（率比 $RR_A=2.0$）。
- **年老组**：暴露组发病率（$75/5,000 = 0.015$）是未暴露组（$950/95,000 = 0.010$）的 $1.5$ 倍（率比 $RR_B=1.5$）。
在两个年龄层中，暴露都增加了疾病风险。

然而，当我们合并数据计算 **粗率比** 时：
- **总暴露组**：$180+75=255$ 例，$90,000+5,000=95,000$ 人年，粗率 $R_E = 255/95,000$。
- **总未暴露组**：$10+950=960$ 例，$10,000+95,000=105,000$ 人年，粗率 $R_U = 960/105,000$。
- **粗率比** $RR_{\text{crude}} = \frac{255/95,000}{960/105,000} \approx 0.2936$。

悖论出现了：合并分析显示暴露因素具有强烈的“保护”作用（$RR  1$），与分层分析的结果完全相反。其原因是年龄作为一个强大的混杂因素，它既与结局相关（老年人发病率更高），也与暴露相关（暴露组主要是年轻人，而未暴露组主要是老年人）。粗率比错误地比较了一个低风险的年轻人群和一个高风险的老年人群，导致了虚假的结论。

#### 控制混杂：标准化方法

为了在比较不同人群的率时消除年龄等混杂因素的影响，流行病学家使用 **标准化（standardization）** 方法，创建可供公平比较的摘要率。

**直接标准化（Direct Standardization）**
直接标准化的核心思想是：如果被比较的人群都具有和一个共同的“标准人群”相同的年龄结构，那么他们的率会是多少？。计算方法是将每个研究人群的年龄别率（age-specific rates）应用于标准人群的年龄分布（人时或人口数），然后计算出一个加权平均率。

例如，要计算A医院的直接标化死亡率，我们将其年龄别死亡率（$18-49$岁为 $2/1,000$ PY，$50-69$岁为 $8/1000$ PY，$\ge 70$岁为 $40/1000$ PY）应用于标准人群的人时分布（$18-49$岁 $50,000$ PY，$50-69$岁 $30,000$ PY，$\ge 70$岁 $20,000$ PY）。
- 预期死亡数 = $(2/1000 \times 50000) + (8/1000 \times 30000) + (40/1000 \times 20000) = 100 + 240 + 800 = 1140$。
- 标准人群总人时 = $50000 + 30000 + 20000 = 100000$ PY。
- A医院的直接标化死亡率 = $(1140 / 100000) \times 1000 = 11.4$ /每$1000$人年。

通过对所有待比较的人群进行同样的操作，我们可以得到经过年龄校正的、可直接比较的标化率。值得注意的是，如果年龄别率在不同人群间存在交叉（即一个群体在某些年龄段率更高，而在另一些年龄段率更低），那么标准人群的选择可能会影响标化率的排序 。

**间接标准化（Indirect Standardization）**
间接标准化则回答一个不同的问题：如果我们的研究人群具有和一个“参考人群”相同的年龄别率，那么我们预期会发生多少事件？。该方法通常在研究人群的年龄别率不稳定（例如，由于样本量小）时使用。

计算的核心是 **标准化死亡比（Standardized Mortality Ratio, SMR）**：
$$
SMR = \frac{\text{研究人群中观察到的事件数}}{\text{研究人群中预期的事件数}}
$$
预期事件数是将参考人群的年龄别率应用于研究人群的年龄分布（人时）计算得出的。例如，要计算B医院的SMR，我们先计算其预期死亡数：将参考人群的年龄别死亡率（$2.5, 9, 38$ /每$1000$ PY）应用于B医院的人时分布（$40000, 45000, 15000$ PY），得到预期死亡数 $1075$。B医院的观察死亡数为 $960$。因此，$SMR_B = 960 / 1075 \approx 0.89$。一个小于 $1$ 的SMR表明，B医院的死亡风险低于参考人群经年龄调整后的水平 。

### 高级主题：删失与[竞争风险](@entry_id:173277)

#### 删失数据的影响

在队列研究中，个体可能因失访、退出研究或研究结束等原因在未发生事件的情况下停止随访。这种情况称为 **删失（censoring）**。虽然计算发病率时使用人时可以恰当地处理[删失数据](@entry_id:173222)，但如果天真地计算累计发病率（风险），则会产生偏倚。

一个常见的错误是简单地将被删失的个体视为未发生事件，并计算观测到的事件数占总人数的比例（即“粗风险”）。这种方法是错误的，因为它忽略了被删失的个体只被观察了有限的时间，他们在这段时间之后是否发生事件是未知的。

考虑两组具有完全相同的瞬时风险（hazard $\lambda = 0.10$），但删失模式不同 。
- A组：$1000$ 人全部随访 $1$ 年。预期的观测事件数约为 $1000 \times (1 - e^{-0.1 \times 1}) \approx 95.2$，粗风险为 $0.0952$。
- B组：$1000$ 人中，$800$ 人在 $0.25$ 年被删失，$200$ 人随访 $1$ 年。预期的观测事件数为 $800 \times (1 - e^{-0.1 \times 0.25}) + 200 \times (1 - e^{-0.1 \times 1}) \approx 38.8$，粗风险仅为 $0.0388$。

尽管两组的潜在风险完全相同，但由于B组的观察时间更短，其观测到的粗风险显著低于A组。这说明，在存在删失的情况下，如果不使用像[Kaplan-Meier](@entry_id:169317)方法这样能正确处理删失数据的统计技术，而仅仅计算粗风险，将会导致对真实风险的严重低估。

#### 竞争风险

在许多研究中，个体可能经历多种相互排斥的事件类型，这些事件互为 **竞争风险（competing risks）**。例如，在对心脏病患者的随访中，患者可能死于心脏病，也可能死于癌症。死于癌症的事件就阻碍了我们观察到该患者因心脏病死亡的可能。

在这种情况下，估计特定原因 $k$ 的发生概率需要使用 **累计发病函数（Cumulative Incidence Function, CIF）**，记为 $F_k(t)$。它定义为到时间 $t$ 为止，因原因 $k$ 发生事件的概率，其形式化定义为 $F_k(t) = P(T \le t, J=k)$，其中 $T$ 是首次事件时间，$J$ 是事件类型 。CIF可以通过整合原因别[风险函数](@entry_id:166593) $\lambda_k(u)$ 与总生存函数 $S(u-)$ 的乘积得到：$F_k(t) = \int_0^t S(u-) \lambda_k(u) du$。

一个常见的严重错误是，在估计原因 $k$ 的风险时，将所有其他竞争事件当作删失处理，然后使用传统的[Kaplan-Meier](@entry_id:169317)方法计算 $1 - \hat{S}_k^{KM}(t)$。这种方法估算的是一种称为“净风险”（net risk）的假设量，即“如果所有其他竞争风险都不存在，那么因原因 $k$ 发生事件的概率会是多少？” 。由于[竞争风险](@entry_id:173277)的存在会“带走”一部分风险人口，使得他们不再有机会发生原因 $k$ 事件，因此在现实世界中，真实的CIF总是小于或等于虚构的净风险。正确估计CIF需要使用专门的方法，如Aalen-Johansen估计量。