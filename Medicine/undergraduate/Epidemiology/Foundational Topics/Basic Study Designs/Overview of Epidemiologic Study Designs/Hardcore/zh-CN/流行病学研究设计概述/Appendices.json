{
    "hands_on_practices": [
        {
            "introduction": "队列研究是流行病学中用于衡量疾病发病率的基石。这项练习将指导你完成从原始计数和人时数据计算关键关联指标——发病率比 ($IRR$) 的核心过程。通过这项实践 ，你不仅能掌握计算和解释 $IRR$ 的能力，还能理解这一基本指标如何与泊松回归等统计模型联系起来，这是现代流行病学分析中的重要一步。",
            "id": "4617375",
            "problem": "一项前瞻性队列研究旨在比较在一个固定的随访期内，暴露组与非暴露组之间某一罕见结局的发病率。研究记录了每个组别观测到的总事件数和累积人时。暴露组在 $1{,}250$ 人年内发生了 $37$ 例事件。非暴露组在 $2{,}000$ 人年内发生了 $22$ 例事件。假设如下：\n\n- 任何组别的发病率定义为 $I = \\frac{E}{T}$，其中 $E$ 是总事件数，$T$ 是累积人时。\n- 每个组别的事件计数来自一个泊松过程，其均值等于特定组别的率与人时的乘积，并且在观测期间内各组的率是恒定的。\n- 使用一个广义线性模型 (GLM) 对计数数据进行拟合，该模型使用对数连接函数，包含暴露指示变量 $X \\in \\{0,1\\}$，并以人时的对数作为偏移量，从而使得暴露系数能够捕捉率的乘法变化。\n\n仅使用这些定义和假设，完成以下任务：\n\n1. 计算每个组的发病率，然后计算暴露组与非暴露组之间的发病率比。\n2. 在具有对数连接函数和人时偏移量的泊松GLM下，从基本原理推导暴露系数与发病率比之间的关系。\n3. 最后，报告由观测数据所隐含的泊松回归暴露系数的数值。将最终数值答案四舍五入至四位有效数字。最终报告值无需单位。",
            "solution": "基本定义和假设意味着以下内容。一个组的发病率定义为 $I = \\frac{E}{T}$，其中 $E$ 是总事件数，$T$ 是累积人时。发病率比 (IRR) 比较暴露组（其率记为 $\\lambda_{1}$）与非暴露组（其率记为 $\\lambda_{0}$）的率，由下式给出\n$$\n\\text{IRR} = \\frac{\\lambda_{1}}{\\lambda_{0}}.\n$$\n\n步骤 $1$：根据观测数据计算各组的率和发病率比。对于暴露组，\n$$\n\\lambda_{1} = \\frac{E_{1}}{T_{1}} = \\frac{37}{1250}.\n$$\n对于非暴露组，\n$$\n\\lambda_{0} = \\frac{E_{0}}{T_{0}} = \\frac{22}{2000}.\n$$\n因此，\n$$\n\\text{IRR} = \\frac{\\lambda_{1}}{\\lambda_{0}} = \\frac{\\frac{37}{1250}}{\\frac{22}{2000}} = \\frac{37 \\times 2000}{1250 \\times 22} = \\frac{74000}{27500} = \\frac{148}{55}.\n$$\n\n步骤 $2$：推导泊松回归中的暴露系数与发病率比之间的关系。在具有恒定率的泊松过程假设下，组 $i \\in \\{0,1\\}$ 在人时 $T_{i}$ 内的计数 $Y_{i}$ 服从均值为 $\\mu_{i} = \\lambda_{i} T_{i}$ 的泊松分布。一个具有对数连接函数和以人时对数作为偏移量的广义线性模型将均值表示为\n$$\n\\ln(\\mu_{i}) = \\beta_{0} + \\beta_{1} X_{i} + \\ln(T_{i}),\n$$\n其中 $X_{i} \\in \\{0,1\\}$ 表示暴露状态。整理可得\n$$\n\\ln(\\lambda_{i} T_{i}) = \\beta_{0} + \\beta_{1} X_{i} + \\ln(T_{i}) \\quad \\Rightarrow \\quad \\ln(\\lambda_{i}) = \\beta_{0} + \\beta_{1} X_{i}.\n$$\n因此，对于暴露组 ($X_{1} = 1$)，我们有 $\\ln(\\lambda_{1}) = \\beta_{0} + \\beta_{1}$；对于非暴露组 ($X_{0} = 0$)，我们有 $\\ln(\\lambda_{0}) = \\beta_{0}$。两式相减，\n$$\n\\ln(\\lambda_{1}) - \\ln(\\lambda_{0}) = \\beta_{1},\n$$\n这意味着\n$$\n\\beta_{1} = \\ln\\!\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) = \\ln(\\text{IRR}).\n$$\n因此，泊松回归中的暴露系数等于发病率比的自然对数。\n\n步骤 $3$：使用观测数据计算 $\\beta_{1}$ 的数值。从步骤 $1$ 可知，$\\text{IRR} = \\frac{148}{55}$。因此，\n$$\n\\beta_{1} = \\ln\\!\\left(\\frac{148}{55}\\right).\n$$\n进行数值计算，\n$$\n\\beta_{1} \\approx \\ln(2.6909090909) \\approx 0.989879088\\ldots\n$$\n四舍五入至四位有效数字，暴露系数为\n$$\n0.9899.\n$$",
            "answer": "$$\\boxed{0.9899}$$"
        },
        {
            "introduction": "在观察性研究中，混杂是评估暴露与结局之间真实关联时最常见的挑战。这项练习将带你超越混杂的定性定义，通过一个精心设计的假设场景，让你亲手量化混杂因素所引入的偏倚大小与方向 。通过在一个已知真实效应为空（即相对风险 $RR_{\\text{true}} = 1$）的情境下进行计算，你将深刻且定量地理解混杂是如何扭曲我们观察到的关联的。",
            "id": "4617352",
            "problem": "一项前瞻性队列研究旨在检验二元暴露 $E$（暴露与未暴露）与二元结局 $Y$（发生事件与未发生事件）之间的关系。存在一个二元混杂因素 $C$，它在不同暴露组中的分布不同，并以相乘的方式影响结局。设 $P(C=1 \\mid E=1) = 0.60$ 且 $P(C=1 \\mid E=0) = 0.20$。未暴露且无混杂因素的个体中，$Y$ 的风险为 $R(Y=1 \\mid E=0, C=0) = 0.05$。该混杂因素通过一个恒定的相对风险增加 $Y$ 的风险，使得 $RR_{Y \\mid C} = \\frac{R(Y=1 \\mid C=1)}{R(Y=1 \\mid C=0)} = 3.0$，并且在相对风险尺度上，$E$ 和 $C$ 之间没有交互作用。\n\n假设 $E$ 对 $Y$ 没有因果效应（即 $E$ 对 $Y$ 的真实相对风险为 $RR_{\\text{true}} = 1$）。使用相对风险的定义和基于 $C$ 的分层的全概率定律，计算观测相对风险中的有符号混杂偏倚，定义为 $B = RR_{\\text{obs}} - RR_{\\text{true}}$，其中 $RR_{\\text{obs}}$ 是比较暴露组与未暴露组时 $Y$ 的边际相对风险，未对 $C$ 进行分层或校正。将 $B$ 的最终答案四舍五入至四位有效数字。无需单位。",
            "solution": "本题要求计算观测相对风险 $RR_{\\text{obs}}$ 的有符号混杂偏倚 $B$。该偏倚定义为 $B = RR_{\\text{obs}} - RR_{\\text{true}}$。已知真实相对风险 $RR_{\\text{true}}$ 为 $1$。观测相对风险是比较暴露组与未暴露组的边际（粗略）风险比。\n\n设 $E$ 为二元暴露变量，其中 $E=1$ 表示暴露，$E=0$ 表示未暴露。设 $Y$ 为二元结局变量，其中 $Y=1$ 表示发生事件，$Y=0$ 表示未发生事件。设 $C$ 为二元混杂因素，其中 $C=1$ 表示存在混杂因素，$C=0$ 表示不存在混杂因素。\n\n已知条件如下：\n1.  暴露组中混杂因素的比例：$P(C=1 \\mid E=1) = 0.60$。\n2.  未暴露组中混杂因素的比例：$P(C=1 \\mid E=0) = 0.20$。\n3.  未暴露且无混杂因素的个体中结局的风险：$R(Y=1 \\mid E=0, C=0) = 0.05$。\n4.  与混杂因素相关的结局相对风险在各暴露分层中是恒定的：$RR_{YC} = \\frac{R(Y=1 \\mid E, C=1)}{R(Y=1 \\mid E, C=0)} = 3.0$。\n5.  暴露对结局没有因果效应，这意味着真实的、分层特异性相对风险为1：$RR_{\\text{true}} = \\frac{R(Y=1 \\mid E=1, C)}{R(Y=1 \\mid E=0, C)} = 1$。在相对风险尺度上无交互作用的条件意味着该值在 $C$ 的各分层中是恒定的。\n\n我们的目标是计算 $B = RR_{\\text{obs}} - 1$，其中 $RR_{\\text{obs}} = \\frac{R(Y=1 \\mid E=1)}{R(Y=1 \\mid E=0)}$。\n\n首先，我们确定四个分层特异性风险，记为 $R_{ec} = R(Y=1 \\mid E=e, C=c)$。\n基线风险已知：\n$R_{00} = R(Y=1 \\mid E=0, C=0) = 0.05$。\n\n使用真实相对风险 $RR_{\\text{true}}=1$，我们求出无混杂因素的暴露组的风险：\n$R_{10} = R(Y=1 \\mid E=1, C=0) = R_{00} \\times RR_{\\text{true}} = 0.05 \\times 1 = 0.05$。\n\n使用与混杂因素相关的相对风险 $RR_{YC}=3.0$，我们求出有混杂因素的受试者的风险。对于未暴露组：\n$R_{01} = R(Y=1 \\mid E=0, C=1) = R_{00} \\times RR_{YC} = 0.05 \\times 3.0 = 0.15$。\n\n对于暴露组：\n$R_{11} = R(Y=1 \\mid E=1, C=1) = R_{10} \\times RR_{YC} = 0.05 \\times 3.0 = 0.15$。\n这与 $C=1$ 分层中 $RR_{\\text{true}}=1$ 的情况一致，因为 $R_{11}/R_{01} = 0.15/0.15 = 1$。\n\n接下来，我们使用全概率定律计算暴露组和未暴露组的边际风险。一个组的边际风险是分层特异性风险的加权平均值，其中权重是该组中混杂因素的比例。\n\n未暴露组的边际风险 $R_0 = R(Y=1 \\mid E=0)$ 为：\n$$R_0 = R(Y=1 \\mid E=0, C=0)P(C=0 \\mid E=0) + R(Y=1 \\mid E=0, C=1)P(C=1 \\mid E=0)$$\n已知 $P(C=1 \\mid E=0) = 0.20$，所以 $P(C=0 \\mid E=0) = 1 - 0.20 = 0.80$。\n代入数值：\n$$R_0 = R_{00} \\times (1 - P(C=1 \\mid E=0)) + R_{01} \\times P(C=1 \\mid E=0)$$\n$$R_0 = (0.05)(0.80) + (0.15)(0.20)$$\n$$R_0 = 0.04 + 0.03 = 0.07$$\n\n同样地，暴露组的边际风险 $R_1 = R(Y=1 \\mid E=1)$ 为：\n$$R_1 = R(Y=1 \\mid E=1, C=0)P(C=0 \\mid E=1) + R(Y=1 \\mid E=1, C=1)P(C=1 \\mid E=1)$$\n已知 $P(C=1 \\mid E=1) = 0.60$，所以 $P(C=0 \\mid E=1) = 1 - 0.60 = 0.40$。\n代入数值：\n$$R_1 = R_{10} \\times (1 - P(C=1 \\mid E=1)) + R_{11} \\times P(C=1 \\mid E=1)$$\n$$R_1 = (0.05)(0.40) + (0.15)(0.60)$$\n$$R_1 = 0.02 + 0.09 = 0.11$$\n\n现在，我们可以计算观测相对风险 $RR_{\\text{obs}}$：\n$$RR_{\\text{obs}} = \\frac{R_1}{R_0} = \\frac{0.11}{0.07} = \\frac{11}{7}$$\n\n最后，我们计算有符号混杂偏倚 $B$：\n$$B = RR_{\\text{obs}} - RR_{\\text{true}}$$\n$$B = \\frac{11}{7} - 1 = \\frac{11}{7} - \\frac{7}{7} = \\frac{4}{7}$$\n\n为得出数值答案，我们将分数转换为小数并四舍五入至四位有效数字。\n$$B = \\frac{4}{7} \\approx 0.57142857...$$\n四舍五入至四位有效数字得到 $0.5714$。",
            "answer": "$$\\boxed{0.5714}$$"
        },
        {
            "introduction": "除了混杂之外，研究设计的另一个微妙陷阱是选择偏倚，它源于我们纳入研究对象的方式。本练习通过一个经典的医院基础病例对照研究的例子，探讨了伯克森偏倚 (Berkson's bias) 。通过这个练习，你将看到一个看似方便的抽样策略（在病例所在的同一家医院选择对照组）如何可能导致与事实完全相反的结论，从而突显了在研究设计中审慎选择对照组的极端重要性。",
            "id": "4617319",
            "problem": "一个研究团队正在设计一项基于医院的病例对照研究，以评估某种暴露与一种疾病之间的关联。设二元暴露由 $E \\in \\{0,1\\}$ 表示，二元疾病由 $D \\in \\{0,1\\}$ 表示。设 $S \\in \\{0,1\\}$ 表示研究期间的入院情况。病例定义为 $D=1$ 的住院患者，对照组定义为 $D=0$ 的其他住院患者。该团队意识到 Berkson 偏倚的存在，这种偏倚可能在医院对照组的入院概率依赖于暴露时产生。\n\n在源人群中，假设疾病风险为 $P(D=1 \\mid E=1)=0.06$ 和 $P(D=1 \\mid E=0)=0.03$，并且患有该疾病的病例 ($D=1$) 无论暴露与否，其入院概率均相等，即 $P(S=1 \\mid D=1, E=1)=1$ 和 $P(S=1 \\mid D=1, E=0)=1$。然而，在非患病个体 ($D=0$) 中，由于不相关的状况，入院与否取决于暴露情况：$P(S=1 \\mid D=0, E=1)=0.20$ 和 $P(S=1 \\mid D=0, E=0)=0.05$。\n\n仅从比值比 (OR) 的核心定义（病例中暴露的比值与对照组中暴露的比值之比）以及概率法则（包括贝叶斯法则）出发，推导在此背景下基于医院的观测比值比 $OR_{\\text{obs}}$。在您的推导中，明确指出医院对照组中差异化的入院概率是如何产生 Berkson 偏倚的，并确定其相对于真实源人群比值比的方向。\n\n请以 $OR_{\\text{obs}}$ 的精确值（不要四舍五入）作为您的最终答案。",
            "solution": "该问题要求在一个基于医院的病例对照研究中推导观测比值比 ($OR_{\\text{obs}}$) 并分析 Berkson 偏倚。我们将首先计算源人群中的真实比值比，然后利用给定的入院概率推导观测比值比，最后比较两者以描述偏倚的特征。\n\n设变量定义如下：\n- $E \\in \\{0,1\\}$ 代表暴露状态。\n- $D \\in \\{0,1\\}$ 代表疾病状态。\n- $S \\in \\{0,1\\}$ 代表入院状态。\n\n给定的概率为：\n- $P(D=1 \\mid E=1) = 0.06$\n- $P(D=1 \\mid E=0) = 0.03$\n- $P(S=1 \\mid D=1, E=1) = 1$\n- $P(S=1 \\mid D=1, E=0) = 1$\n- $P(S=1 \\mid D=0, E=1) = 0.20$\n- $P(S=1 \\mid D=0, E=0) = 0.05$\n\n由此，我们可以推导出非患病的概率：\n- $P(D=0 \\mid E=1) = 1 - P(D=1 \\mid E=1) = 1 - 0.06 = 0.94$\n- $P(D=0 \\mid E=0) = 1 - P(D=1 \\mid E=0) = 1 - 0.03 = 0.97$\n\n首先，我们计算源人群中的真实比值比 ($OR_{\\text{true}}$)。这是暴露人群中患病比值与非暴露人群中患病比值之比。\n$$OR_{\\text{true}} = \\frac{P(D=1 \\mid E=1) / P(D=0 \\mid E=1)}{P(D=1 \\mid E=0) / P(D=0 \\mid E=0)}$$\n代入给定值和推导值：\n$$OR_{\\text{true}} = \\frac{0.06 / 0.94}{0.03 / 0.97} = \\frac{0.06 \\times 0.97}{0.03 \\times 0.94} = 2 \\times \\frac{0.97}{0.94} = \\frac{1.94}{0.94} = \\frac{194}{94} = \\frac{97}{47}$$\n真实比值比大于 $1$，表明在源人群中，暴露与疾病之间存在正向关联。\n\n接下来，我们从基于医院的研究中推导观测比值比 ($OR_{\\text{obs}}$)。问题将其定义为医院病例中暴露的比值与医院对照组中暴露的比值之比。\n- 医院病例是 $D=1$ 且 $S=1$ 的个体。\n- 医院对照组是 $D=0$ 且 $S=1$ 的个体。\n\n观测比值比为：\n$$OR_{\\text{obs}} = \\frac{\\text{Odds}(E=1 \\mid D=1, S=1)}{\\text{Odds}(E=1 \\mid D=0, S=1)} = \\frac{P(E=1 \\mid D=1, S=1) / P(E=0 \\mid D=1, S=1)}{P(E=1 \\mid D=0, S=1) / P(E=0 \\mid D=0, S=1)}$$\n\n我们需要求出医院人群 ($S=1$) 中病例和对照组的暴露比值。我们使用贝叶斯法则将这些条件概率与给定概率联系起来。对于给定的疾病状态 $D$，住院个体中的暴露比值为：\n$$ \\frac{P(E=1 \\mid D, S=1)}{P(E=0 \\mid D, S=1)} = \\frac{P(S=1 \\mid E=1, D) P(E=1, D) / P(S=1, D)}{P(S=1 \\mid E=0, D) P(E=0, D) / P(S=1, D)} $$\n$$ = \\frac{P(S=1 \\mid E=1, D) P(D \\mid E=1) P(E=1)}{P(S=1 \\mid E=0, D) P(D \\mid E=0) P(E=0)} $$\n设 $p_e = P(E=1)$ 为源人群中的暴露率，因此 $P(E=0) = 1-p_e$。暴露比值的表达式变为：\n$$ \\text{Odds}(E=1 \\mid D, S=1) = \\frac{P(S=1 \\mid E=1, D) P(D \\mid E=1)}{P(S=1 \\mid E=0, D) P(D \\mid E=0)} \\times \\frac{p_e}{1-p_e} $$\n\n对于医院病例 ($D=1, S=1$)：\n$$ \\text{Odds}(E=1 \\mid D=1, S=1) = \\frac{P(S=1 \\mid E=1, D=1) P(D=1 \\mid E=1)}{P(S=1 \\mid E=0, D=1) P(D=1 \\mid E=0)} \\times \\frac{p_e}{1-p_e} $$\n代入给定值：\n$$ \\text{Odds}(E=1 \\mid D=1, S=1) = \\frac{(1)(0.06)}{(1)(0.03)} \\times \\frac{p_e}{1-p_e} = 2 \\times \\frac{p_e}{1-p_e} $$\n\n对于医院对照组 ($D=0, S=1$)：\n$$ \\text{Odds}(E=1 \\mid D=0, S=1) = \\frac{P(S=1 \\mid E=1, D=0) P(D=0 \\mid E=1)}{P(S=1 \\mid E=0, D=0) P(D=0 \\mid E=0)} \\times \\frac{p_e}{1-p_e} $$\n代入给定值和推导值：\n$$ \\text{Odds}(E=1 \\mid D=0, S=1) = \\frac{(0.20)(0.94)}{(0.05)(0.97)} \\times \\frac{p_e}{1-p_e} = \\frac{0.188}{0.0485} \\times \\frac{p_e}{1-p_e} $$\n\n现在，我们通过计算这两个比值的比率来求出 $OR_{\\text{obs}}$。项 $\\frac{p_e}{1-p_e}$ 会消掉，表明结果与源人群中的暴露率无关。\n$$ OR_{\\text{obs}} = \\frac{2 \\times \\frac{p_e}{1-p_e}}{\\frac{0.188}{0.0485} \\times \\frac{p_e}{1-p_e}} = \\frac{2}{\\frac{0.188}{0.0485}} = \\frac{2 \\times 0.0485}{0.188} = \\frac{0.097}{0.188} $$\n为将其表示为精确分数：\n$$ OR_{\\text{obs}} = \\frac{97 \\times 10^{-3}}{188 \\times 10^{-3}} = \\frac{97}{188} $$\n由于 $97$ 是一个质数，而 $188 = 2 \\times 94$ 不是 $97$ 的倍数，因此该分数是不可约分的。\n\n最后，我们分析偏倚。真实比值比为 $OR_{\\text{true}} = \\frac{97}{47} \\approx 2.06$，表明暴露是该疾病的一个危险因素。而观测比值比为 $OR_{\\text{obs}} = \\frac{97}{188} \\approx 0.52$，这虚假地表明暴露是保护性的。\n\n这种差异是 Berkson 偏倚（一种选择偏倚）的结果。该偏倚的产生是因为入院（被选入研究）与暴露相关，但这种关联在病例组和对照组之间是不同的。\n观测比值比与真实比值比之间的关系可以明确表述为：\n$$ OR_{\\text{obs}} = \\left( \\frac{P(S=1|D=1,E=1)/P(S=1|D=1,E=0)}{P(S=1|D=0,E=1)/P(S=1|D=0,E=0)} \\right) \\times OR_{\\text{true}} $$\n我们来计算括号中的偏倚因子：\n- 对于病例 ($D=1$)，入院概率之比为 $\\frac{P(S=1|D=1,E=1)}{P(S=1|D=1,E=0)} = \\frac{1}{1} = 1$。\n- 对于对照组 ($D=0$)，入院概率之比为 $\\frac{P(S=1|D=0,E=1)}{P(S=1|D=0,E=0)} = \\frac{0.20}{0.05} = 4$。\n\n偏倚因子为 $\\frac{1}{4} = 0.25$。\n因此，$OR_{\\text{obs}} = 0.25 \\times OR_{\\text{true}} = \\frac{1}{4} \\times \\frac{97}{47} = \\frac{97}{188}$。这与我们直接计算的结果一致。\n\n对照组的差异化入院概率是偏倚的来源。有暴露的非患病个体 ($E=1, D=0$) 的住院可能性是无暴露的非患病个体 ($E=0, D=0$) 的四倍。这导致与源人群中的非患病个体相比，基于医院的对照组中暴露个体的比例过高。对照组中暴露率的这种膨胀人为地拉低了观测比值比，产生了一种虚假的保护效应，并逆转了真实关联的方向。偏倚的方向是朝向无效值并越过它，从一个危险因素 ($OR > 1$) 变为一个保护因素 ($OR  1$)。",
            "answer": "$$\\boxed{\\frac{97}{188}}$$"
        }
    ]
}