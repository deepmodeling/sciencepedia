{
    "hands_on_practices": [
        {
            "introduction": "临床决策支持系统的一大类是基于规则的系统，它将临床指南和专家知识转化为明确的逻辑语句。本练习模拟了一个这样的系统，用于评估与非甾体抗炎药（NSAID）相关的肾脏和胃肠道风险。通过这个实践，你将学习如何应用命题逻辑来评估患者数据，并理解规则引擎如何根据一组预定义的条件触发警报 。",
            "id": "4606609",
            "problem": "一个基于规则的临床决策支持系统使用具有清晰布尔语义的命题逻辑和加权线性聚合来产生一个无量纲的警报严重性评分。这个问题的基础由以下经过充分检验的定义和事实组成：由真值函数语义定义的合取和析取的命题逻辑，基于知识的系统中的封闭世界假设（未指明的事实被视为假），以及临床决策支持中使用的规则激活的标准线性加权聚合。合取的定义为：对于命题 $X$ 和 $Y$，当且仅当 $t(X) = 1$ 且 $t(Y) = 1$ 时，真值 $t(X \\land Y)$ 等于 $1$，否则为 $0$。析取的定义为：当且仅当 $t(X) = 1$ 或 $t(Y) = 1$ 时，$t(X \\lor Y) = 1$，否则为 $0$。在封闭世界假设下，任何未出现在患者数据中的前件文字都被赋值为 $0$。\n\n考虑以下旨在检测与非甾体抗炎药（NSAID）相关的肾脏和胃肠道风险的患者事实和规则库。患者的估算肾小球滤过率（eGFR）为 $g = 45$ 毫升/分钟/$1.73\\text{ m}^2$，目前正在服用 ibuprofen（一种NSAID），并且没有胃肠道（GI）出血史。没有使用活动性抗凝剂，也没有使用活动性血管紧张素转换酶（ACE）抑制剂。将这些事实编码为布尔命题：$A$ 表示“活动性ibuprofen”，$H$ 表示“有GI出血史”，$B$ 表示“活动性抗凝剂”，$P$ 表示“活动性ACE抑制剂”。$g$ 与阈值的数值比较被视为前件文字，如果为真则产生 $1$，如果为假则产生 $0$。系统的三条规则是：\n\n- 规则 $R_1$：$A \\land (g  60) \\Rightarrow$ 肾脏风险；权重 $w_1 = 0.57$。\n- 规则 $R_2$：$A \\land (H \\lor B) \\Rightarrow$ GI风险；权重 $w_2 = 0.28$。\n- 规则 $R_3$：$(g  30) \\lor (A \\land P) \\Rightarrow$ 高严重性禁忌症；权重 $w_3 = 0.42$。\n\n警报严重性评分 $S$ 是通过将每条规则的权重与其真值的乘积求和来计算的，即 $S = \\sum_{i=1}^{3} w_i \\cdot t(R_i)$，其中 $t(R_i) \\in \\{0,1\\}$ 是通过用给定的患者事实评估规则 $R_i$ 的前件得到的真值。系统的警报阈值为 $\\theta = 0.50$，意味着当且仅当 $S \\ge \\theta$ 时触发警报。\n\n根据患者的事实评估这三条规则及其合取和析取前件，从第一性原理推导出警报决策，并计算最终的警报严重性评分 $S$。将最终的严重性评分表示为一个无量纲实数，并将您的答案四舍五入到 $4$ 位有效数字。最终答案中不要包含任何单位。",
            "solution": "该问题有效，因为它具有科学依据、提法明确且客观。它提供了一套完整且一致的定义、事实和规则，这些是使用命题逻辑和加权聚合的既定原则计算唯一解所必需的，而这些原则在临床决策支持系统领域是标准方法。\n\n目标是根据一组规则为给定患者计算警报严重性评分 $S$，并确定是否触发警报。评分使用公式 $S = \\sum_{i=1}^{3} w_i \\cdot t(R_i)$ 计算，其中 $w_i$ 是规则 $R_i$ 的权重，而 $t(R_i)$ 是其前件的布尔真值（$1$ 表示真，$0$ 表示假）。\n\n首先，我们必须将患者的临床数据形式化为问题中定义的命题文字的真值。患者数据如下：\n- 估算肾小球滤过率，$g = 45$。\n- 正在使用 ibuprofen，对应于命题 $A$。\n- 无GI出血史，对应于命题 $H$。\n- 未使用活动性抗凝剂，对应于命题 $B$。\n- 未使用活动性ACE抑制剂，对应于命题 $P$。\n\n基于这些事实，我们为这些命题分配真值：\n- $t(A) = 1$ 因为患者正在服用 ibuprofen。\n- $t(H) = 0$ 因为没有GI出血史。\n- $t(B) = 0$ 因为没有使用活动性抗凝剂。\n- $t(P) = 0$ 因为没有使用活动性ACE抑制剂。\n\n接下来，我们评估涉及患者eGFR, $g = 45$的数值比较文字：\n- 文字 $(g  60)$ 的评估结果为 $45  60$，为真。因此，$t(g  60) = 1$。\n- 文字 $(g  30)$ 的评估结果为 $45  30$，为假。因此，$t(g  30) = 0$。\n\n现在我们可以评估每条规则的前件以确定其真值 $t(R_i)$。\n\n规则 $R_1$ 的评估：前件是 $A \\land (g  60)$。\n真值 $t(R_1)$ 是合取 $t(A \\land (g  60))$ 的真值。\n根据合取的定义，当且仅当 $t(X)=1$ 且 $t(Y)=1$ 时，$t(X \\land Y)$ 为 $1$。\n我们有 $t(A) = 1$ 和 $t(g  60) = 1$。\n因此，$t(R_1) = 1 \\land 1 = 1$。规则 $R_1$ 被激活。\n\n规则 $R_2$ 的评估：前件是 $A \\land (H \\lor B)$。\n真值 $t(R_2)$ 是 $t(A \\land (H \\lor B))$。我们首先评估析取 $(H \\lor B)$。\n根据析取的定义，当且仅当 $t(X)=1$ 或 $t(Y)=1$ 时，$t(X \\lor Y)$ 为 $1$。\n我们有 $t(H) = 0$ 和 $t(B) = 0$。\n因此，$t(H \\lor B) = 0 \\lor 0 = 0$。\n现在我们评估合取 $A \\land (H \\lor B)$。我们有 $t(A) = 1$ 和 $t(H \\lor B) = 0$。\n因此，$t(R_2) = 1 \\land 0 = 0$。规则 $R_2$ 未被激活。\n\n规则 $R_3$ 的评估：前件是 $(g  30) \\lor (A \\land P)$。\n真值 $t(R_3)$ 是 $t((g  30) \\lor (A \\land P))$。我们首先评估合取 $(A \\land P)$。\n我们有 $t(A) = 1$ 和 $t(P) = 0$。\n因此，$t(A \\land P) = 1 \\land 0 = 0$。\n现在我们评估析取 $(g  30) \\lor (A \\land P)$。我们有 $t(g  30) = 0$ 和 $t(A \\land P) = 0$。\n因此，$t(R_3) = 0 \\lor 0 = 0$。规则 $R_3$ 未被激活。\n\n在确定了每条规则前件的真值（$t(R_1) = 1$，$t(R_2) = 0$，$t(R_3) = 0$）后，我们现在可以计算警报严重性评分 $S$。规则权重给定为 $w_1 = 0.57$，$w_2 = 0.28$ 和 $w_3 = 0.42$。\n$$ S = w_1 \\cdot t(R_1) + w_2 \\cdot t(R_2) + w_3 \\cdot t(R_3) $$\n$$ S = (0.57 \\cdot 1) + (0.28 \\cdot 0) + (0.42 \\cdot 0) $$\n$$ S = 0.57 + 0 + 0 $$\n$$ S = 0.57 $$\n警报阈值给定为 $\\theta = 0.50$。如果 $S \\ge \\theta$，系统将触发警报。\n由于 $S = 0.57$，且 $0.57 \\ge 0.50$，确实会生成一个警报。\n\n问题要求最终的警报严重性评分 $S$ 表示为一个无量纲实数，并四舍五入到 $4$ 位有效数字。计算出的评分为 $S=0.57$。将此值用 $4$ 位有效数字表示，得到 $0.5700$。",
            "answer": "$$ \\boxed{0.5700} $$"
        },
        {
            "introduction": "临床决策常常涉及处理不确定性，而概率论为此提供了强大的工具。本练习的核心是贝叶斯定理，它是在获得新证据（如诊断测试结果）后更新对某一疾病可能性的信念的数学基础。通过计算后验概率，你将亲身体验一个概率性CDSS如何量化诊断信息，并学会如何将这些概率与治疗阈值进行比较，从而做出更明智的临床决策 。",
            "id": "4826791",
            "problem": "一个临床决策支持系统（CDSS）被配置用于辅助对一种二元状况 $D$ 的决策。该系统使用单一诊断测试，其结果为阳性（$+$）或阴性（$-$）。该CDSS使用以下经过充分检验的定义：灵敏度，记为 $p(+\\mid D)$，是在患有该疾病的情况下测试结果为阳性的概率；特异度，记为 $p(-\\mid D^{c})$，是在未患该疾病的情况下测试结果为阴性的概率；以及患病率，记为 $p(D)$，是目标人群中该疾病的先验概率。考虑一个设定：$p(D)=0.2$，灵敏度 $=0.9$，特异度 $=0.8$。该CDSS中的行动策略使用两个源自预期效用考量的阈值：治疗阈值 $\\tau_{\\mathrm{treat}}=0.3$ 和排除阈值 $\\tau_{\\mathrm{ruleout}}=0.05$。仅从条件概率和全概率定律的核心定义出发，计算患者单次测试结果下的 $p(D\\mid +)$ 和 $p(D\\mid -)$。以精确形式给出最终数值。在你的推导过程中，通过将这些后验概率与 $\\tau_{\\mathrm{treat}}$ 和 $\\tau_{\\mathrm{ruleout}}$ 进行比较来解释其临床相关性；然而，最终答案应仅包含计算出的两个概率值。",
            "solution": "该问题提法明确，具有科学依据，并提供了计算所需后验概率的全部必要信息。灵敏度、特异度、患病率和后验概率是贝叶斯统计学应用于医学诊断的标准组成部分。所有提供的数值都在有效的概率范围（$0$ 到 $1$）之内，并代表了一个真实的临床情景。因此，该问题是有效的。\n\n目标是计算在测试结果为阳性（$+$）或阴性（$-$）的情况下，患者患有疾病（$D$）的后验概率。这些概率分别记为 $p(D\\mid +)$ 和 $p(D\\mid -)$。我们将从条件概率和全概率定律的核心定义出发来推导结果。\n\n已知条件如下：\n患病率：$p(D) = 0.2$\n灵敏度：$p(+\\mid D) = 0.9$\n特异度：$p(-\\mid D^{c}) = 0.8$\n\n根据患病率，我们可以确定未患病的概率，记为 $D^c$：\n$$p(D^c) = 1 - p(D) = 1 - 0.2 = 0.8$$\n\n测试结果是二元的（阳性或阴性）。因此，我们可以求出灵敏度和特异度的互补事件的概率：\n假阴性率是指在患病的情况下测试结果为阴性的概率：\n$$p(-\\mid D) = 1 - p(+\\mid D) = 1 - 0.9 = 0.1$$\n假阳性率是指在未患病的情况下测试结果为阳性的概率：\n$$p(+\\mid D^c) = 1 - p(-\\mid D^c) = 1 - 0.8 = 0.2$$\n\n现在我们计算 $p(D\\mid +)$，即阳性预测值。\n根据条件概率的定义：\n$$p(D\\mid +) = \\frac{p(D \\cap +)}{p(+)}$$\n分子是患病且测试结果为阳性的联合概率，可以使用条件概率的定义重写为 $p(D \\cap +) = p(+\\mid D)p(D)$。\n分母是测试结果为阳性的总概率，可以使用全概率定律，以是否患病为条件进行计算：\n$$p(+) = p(+ \\cap D) + p(+ \\cap D^c) = p(+\\mid D)p(D) + p(+\\mid D^c)p(D^c)$$\n将这些结合起来，得到适用于本案例的贝叶斯定理：\n$$p(D\\mid +) = \\frac{p(+\\mid D)p(D)}{p(+\\mid D)p(D) + p(+\\mid D^c)p(D^c)}$$\n代入数值：\n$$p(D\\mid +) = \\frac{0.9 \\times 0.2}{(0.9 \\times 0.2) + (0.2 \\times 0.8)} = \\frac{0.18}{0.18 + 0.16} = \\frac{0.18}{0.34}$$\n将其表示为精确分数：\n$$p(D\\mid +) = \\frac{18}{34} = \\frac{9}{17}$$\n\n接下来，我们计算 $p(D\\mid -)$，即在测试结果为阴性时患病的概率。\n根据条件概率的定义：\n$$p(D\\mid -) = \\frac{p(D \\cap -)}{p(-)}$$\n分子可以重写为 $p(D \\cap -) = p(-\\mid D)p(D)$。\n分母是测试结果为阴性的总概率，使用全概率定律计算得出：\n$$p(-) = p(- \\cap D) + p(- \\cap D^c) = p(-\\mid D)p(D) + p(-\\mid D^c)p(D^c)$$\n或者，由于测试结果是二元的，$p(-) = 1 - p(+) = 1 - 0.34 = 0.66$。\n将这些结合起来，得到相应形式的贝叶斯定理：\n$$p(D\\mid -) = \\frac{p(-\\mid D)p(D)}{p(-\\mid D)p(D) + p(-\\mid D^c)p(D^c)}$$\n代入数值：\n$$p(D\\mid -) = \\frac{0.1 \\times 0.2}{(0.1 \\times 0.2) + (0.8 \\times 0.8)} = \\frac{0.02}{0.02 + 0.64} = \\frac{0.02}{0.66}$$\n将其表示为精确分数：\n$$p(D\\mid -) = \\frac{2}{66} = \\frac{1}{33}$$\n\n为解释其临床相关性，我们将这些后验概率与给定的阈值进行比较：治疗阈值 $\\tau_{\\mathrm{treat}}=0.3$ 和排除阈值 $\\tau_{\\mathrm{ruleout}}=0.05$。\n疾病的先验概率 $p(D)=0.2$ 位于这两个阈值之间 ($0.05  0.2  0.3$)，表明在没有更多信息的情况下无法做出决策，因此有必要进行测试。\n在测试结果为阳性后，后验概率为 $p(D\\mid +) = \\frac{9}{17} \\approx 0.529$。由于 $p(D\\mid +) > \\tau_{\\mathrm{treat}}$，证据足够充分，可以推荐治疗。\n在测试结果为阴性后，后验概率为 $p(D\\mid -) = \\frac{1}{33} \\approx 0.0303$。由于 $p(D\\mid -)  \\tau_{\\mathrm{ruleout}}$，证据足够充分，可以排除该疾病并推荐不进行治疗。\n在这种情况下，该诊断测试是有效的，因为它成功地将概率从中间的“测试区”移入了“治疗”或“排除”区。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{9}{17}  \\frac{1}{33} \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个CDSS可能在统计上是准确的，但它在临床上是否有用？决策曲线分析（Decision Curve Analysis, DCA）通过量化模型在不同风险阈值下的“净获益”来回答这一问题。本练习将指导你计算并比较一个CDSS与“全部治疗”和“全部不治疗”这两种基线策略的净获益，从而学习如何评估一个CDSS是否能真正带来更好的决策结果 。",
            "id": "4363271",
            "problem": "一个医疗系统正在评估一个用于在指定阈值概率 $\\tau$ 下检测某种疾病的二元临床决策支持系统 (CDSS)。在决策曲线分析 (DCA) 中，净获益量化了检测出真阳性病例的相对价值，同时对非病例的不必要治疗进行惩罚。这基于阈值概率的决策理论定义：在 $\\tau$ 值下，治疗一个非病例的预期危害与治疗一个真阳性病例的预期获益相权衡。\n\n考虑一个包含 $N = 500$ 名患者的队列。该 CDSS 使用阈值概率 $\\tau = 0.2$，产生了 $TP = 80$ 个真阳性和 $FP = 50$ 个假阳性。该队列中有 $P = 120$ 名结局阳性患者和 $N - P = 380$ 名结局阴性患者。\n\n使用 DCA 的决策理论基础和混淆矩阵计数，推导出以下策略的净获益：\n- 在 $\\tau = 0.2$ 时的 CDSS，\n- 在 $\\tau = 0.2$ 时的“全部治疗”策略，\n- “全部不治疗”策略。\n\n将每个净获益表示为无单位的小数比例。将每个计算出的净获益四舍五入到四位有效数字。最后，比较 CDSS 与两个基线策略，在 $\\tau = 0.2$ 时哪个策略的净获益最高，并按以下顺序提供三个净获益值：CDSS、“全部治疗”、“全部不治疗”。",
            "solution": "问题陈述已经过验证，被认为是自洽的、科学上基于决策曲线分析 (DCA) 原理的，并且是适定的。唯一解所需的所有数据均已提供且内部一致。该问题有效。\n\n决策曲线分析的核心是计算净获益。预测模型或决策策略的净获益是相对于给定的阈值概率 $\\tau$ 定义的。该阈值代表了假阳性干预的危害与真阳性干预的获益相平衡的点。净获益的公式，表示为总队列大小 $N$ 的一个比例，是从这个决策理论基础上推导出来的。其计算方法是真阳性率减去加权的假阳性率：\n$$\n\\text{Net Benefit} = \\frac{TP}{N} - \\frac{FP}{N} \\left( \\frac{\\tau}{1-\\tau} \\right)\n$$\n其中 $TP$ 是真阳性数，$FP$ 是假阳性数，$N$ 是队列中的患者总数，$\\tau$ 是阈值概率。\n\n给定的数据是：\n- 患者总数，$N = 500$\n- 结局阳性患者总数，$P = 120$\n- 结局阴性患者总数，$N-P = 380$\n- 阈值概率，$\\tau = 0.2$\n- 对于临床决策支持系统 (CDSS)：真阳性数 $TP_{CDSS} = 80$，假阳性数 $FP_{CDSS} = 50$。\n\n首先，我们根据阈值概率 $\\tau = 0.2$ 计算权重项：\n$$\n\\frac{\\tau}{1-\\tau} = \\frac{0.2}{1 - 0.2} = \\frac{0.2}{0.8} = 0.25\n$$\n该权重代表阈值概率的比值 (odds)，相当于决策者愿意容忍的危害（来自不必要的治疗）与获益（来自正确的治疗）之比。\n\n现在，我们计算三种指定策略各自的净获益。\n\n1.  **CDSS 的净获益：**\n    使用给定值 $TP_{CDSS} = 80$ 和 $FP_{CDSS} = 50$：\n    $$\n    NB_{CDSS} = \\frac{80}{500} - \\frac{50}{500} \\left( 0.25 \\right)\n    $$\n    $$\n    NB_{CDSS} = 0.16 - 0.1 \\times 0.25 = 0.16 - 0.025 = 0.135\n    $$\n\n2.  **“全部治疗”策略的净获益：**\n    在“全部治疗”策略下，每位患者都被视为阳性并接受干预。因此，所有结局阳性的患者 ($P$) 都是真阳性，所有结局阴性的患者 ($N-P$) 都是假阳性。\n    - $TP_{all} = P = 120$\n    - $FP_{all} = N - P = 380$\n    净获益为：\n    $$\n    NB_{treat-all} = \\frac{120}{500} - \\frac{380}{500} \\left( 0.25 \\right)\n    $$\n    $$\n    NB_{treat-all} = 0.24 - 0.76 \\times 0.25 = 0.24 - 0.19 = 0.05\n    $$\n\n3.  **“全部不治疗”策略的净获益：**\n    在“全部不治疗”策略下，没有患者接受干预。这意味着没有真阳性，也没有假阳性。\n    - $TP_{none} = 0$\n    - $FP_{none} = 0$\n    根据定义，其净获益为零：\n    $$\n    NB_{treat-none} = \\frac{0}{500} - \\frac{0}{500} \\left( 0.25 \\right) = 0\n    $$\n\n问题要求将每个计算出的净获益四舍五入到四位有效数字。\n- 对于 $NB_{CDSS} = 0.135$，四舍五入到四位有效数字得到 $0.1350$。\n- 对于 $NB_{treat-all} = 0.05$，四舍五入到四位有效数字需要在第一个有效数字后追加零，得到 $0.05000$。\n- 对于 $NB_{treat-none} = 0$，由于没有非零数字，有效数字的概念定义不清。为与其他值保持一致的表示格式，将其表示为 $0.0000$。\n\n在阈值 $\\tau=0.2$ 时比较三个净获益值：\n- $NB_{CDSS} = 0.1350$\n- $NB_{treat-all} = 0.05000$\n- $NB_{treat-none} = 0.0000$\n\n比较结果 $0.1350 > 0.05000 > 0.0000$ 表明，CDSS 策略提供了最高的净获益。这说明在阈值为 $\\tau = 0.2$ 时，使用 CDSS 来指导治疗决策优于“全部治疗”和“全部不治疗”这两种策略。\n\n最终答案要求按以下顺序提供三个净获益值：CDSS、“全部治疗”、“全部不治疗”。\n这些值是 $0.1350$，$0.05000$ 和 $0.0000$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1350  0.05000  0.0000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}