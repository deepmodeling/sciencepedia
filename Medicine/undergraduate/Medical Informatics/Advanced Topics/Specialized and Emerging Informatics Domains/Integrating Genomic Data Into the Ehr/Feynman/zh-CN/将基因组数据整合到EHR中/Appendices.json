{
    "hands_on_practices": [
        {
            "introduction": "在将基因组数据用于临床决策之前，我们必须首先确保其准确性。本练习将介绍基因型质量 (Genotype Quality, GQ) 分数，这是一个用于评估基因变异调用可靠性的行业标准。你将学习如何将 GQ 分数转换为具体的错误概率，并利用这一原理为一个基因检测组合设定一个实际的报告阈值，从而在临床应用和可接受的错误率之间取得平衡。",
            "id": "4845063",
            "problem": "一家医院正在将其临床基因组学整合到其电子健康记录（EHR）系统中。变异检出流程提供了一种名为基因型质量（GQ）的逐个基因型置信度评分，该评分在Phred标度上报告。Phred标度由质量值 $Q$ 和错误概率 $p$ 之间的关系定义为 $Q=-10\\log_{10}(p)$。该医院计划每位患者报告 $N=200$ 个药物基因组学基因型检出结果，并希望设定一个最低的 $GQ$ 报告阈值，以使每位患者的预期错误基因型检出结果数量不超过 $\\alpha=0.05$ 的容差。假设每个报告的基因型检出结果具有仅由其 $GQ$ 决定的相同错误概率，并且预期的错误检出数量是个体错误概率的总和。\n(a) 从Phred定义 $Q=-10\\log_{10}(p)$ 出发，将错误概率 $p$ 表示为 $GQ$ 的函数。\n(b) 使用你的表达式，确定当 $GQ=20$ 时错误基因型检出结果的概率。\n(c) 推导最小整数阈值 $GQ^{\\ast}$，使得在所有 $N=200$ 个报告的基因型中，预期的错误基因型检出结果数量最多为 $\\alpha=0.05$。按 $(p \\text{ at } GQ=20,\\; GQ^{\\ast})$ 的顺序提供(b)和(c)部分的最终答案。不需要单位。(b)部分不需要四舍五入。对于(c)部分，报告满足约束条件的最小整数 $GQ^{\\ast}$。",
            "solution": "该问题要求我们在基因组数据分析的背景下，进行与Phred质量值标度相关的计算。我们将首先验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- Phred质量值 $Q$ 的定义：$Q = -10 \\log_{10}(p)$，其中 $p$ 是错误概率。问题使用 $GQ$ 来表示该分数。\n- 每位患者的药物基因组学基因型检出结果数量：$N = 200$。\n- 每位患者的预期错误基因型检出结果数量的容差：$\\alpha = 0.05$。\n- 假设1：每个报告的基因型都有一个由其 $GQ$ 分数决定的错误概率 $p$。为了设定阈值，我们假设所有报告的检出结果的质量值都等于最低阈值，这代表了最坏情况。\n- 假设2：预期的错误检出数量是个体错误概率的总和。\n- 目标(a)：将 $p$ 表示为 $GQ$ 的函数。\n- 目标(b)：计算 $GQ = 20$ 时的 $p$。\n- 目标(c)：找到最小整数阈值 $GQ^{\\ast}$，使得预期的错误基因型检出结果数量最多为 $\\alpha$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：Phred标度及其定义 $Q = -10 \\log_{10}(p)$，是生物信息学和基因组学中用于量化序列数据和变异检出质量的基本和标准概念。设定质量阈值以控制错误率的问题是临床基因组学中一个常见且实际的任务。因此，该问题是科学合理的。\n- **适定性**：问题陈述清晰，提供了推导所需量（$p(GQ)$, $p(20)$ 和 $GQ^{\\ast}$）的所有必要数据（$N$, $\\alpha$）和定义。目标明确，并能导出一个唯一的解。\n- **客观性**：问题使用精确、定量的语言表述，没有任何主观或模棱两可的术语。\n\n**步骤3：结论与行动**\n该问题科学合理、适定且客观。判定为**有效**。我们继续进行求解。\n\n### 解答\n\n**(a) 将错误概率 $p$ 表示为 $GQ$ 的函数。**\n\n我们已知基因型质量（$GQ$）分数在Phred标度上的定义：\n$$GQ = -10 \\log_{10}(p)$$\n我们的目标是解出这个方程中的错误概率 $p$。\n\n首先，我们将两边同时除以 $-10$ 来分离对数项：\n$$-\\frac{GQ}{10} = \\log_{10}(p)$$\n为了解出 $p$，我们使用以10为底的对数的定义，即如果 $y = \\log_{10}(x)$，那么 $x = 10^y$。将此应用于我们的方程，我们得到：\n$$p = 10^{-\\frac{GQ}{10}}$$\n这个表达式给出了错误概率 $p$ 作为 $GQ$ 分数的函数。\n\n**(b) 确定当 $GQ=20$ 时错误基因型检出结果的概率。**\n\n使用(a)部分推导的公式，我们代入 $GQ = 20$：\n$$p(20) = 10^{-\\frac{20}{10}}$$\n$$p(20) = 10^{-2}$$\n$$p(20) = \\frac{1}{10^2} = \\frac{1}{100} = 0.01$$\n所以，一个 $GQ$ 分数为20的基因型检出结果有 $1\\%$ 的可能性是错误的。\n\n**(c) 推导最小整数阈值 $GQ^{\\ast}$。**\n\n医院报告 $N = 200$ 个基因型。设 $GQ^{\\ast}$ 为最低质量阈值。为确保所有报告基因型的质量，我们必须考虑最坏情况，即所有 $N$ 个基因型的质量值都等于这个最低阈值 $GQ^{\\ast}$。在这种情况下，每个检出结果的错误概率是 $p(GQ^{\\ast})$。\n\n预期的错误检出数量 $E[\\text{false calls}]$ 是每个检出结果的错误概率之和。在我们的最坏情况假设下，这是：\n$$E[\\text{false calls}] = \\sum_{i=1}^{N} p(GQ^{\\ast}) = N \\cdot p(GQ^{\\ast})$$\n医院要求这个预期数量不超过 $\\alpha = 0.05$ 的容差。这给了我们以下不等式：\n$$N \\cdot p(GQ^{\\ast}) \\le \\alpha$$\n代入(a)部分得到的 $p(GQ^{\\ast})$ 表达式以及已知的 $N$ 和 $\\alpha$ 的值：\n$$200 \\cdot 10^{-\\frac{GQ^{\\ast}}{10}} \\le 0.05$$\n现在我们求解 $GQ^{\\ast}$：\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{0.05}{200}$$\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{5 \\times 10^{-2}}{2 \\times 10^{2}} = 2.5 \\times 10^{-4}$$\n右边项的另一种写法是 $\\frac{1}{4000}$。\n$$10^{-\\frac{GQ^{\\ast}}{10}} \\le \\frac{1}{4000}$$\n为了求解 $GQ^{\\ast}$，我们对两边取以10为底的对数。因为 $\\log_{10}(x)$ 是一个单调递增函数，所以不等号的方向保持不变。\n$$\\log_{10}\\left(10^{-\\frac{GQ^{\\ast}}{10}}\\right) \\le \\log_{10}\\left(\\frac{1}{4000}\\right)$$\n$$-\\frac{GQ^{\\ast}}{10} \\le -\\log_{10}(4000)$$\n将两边同乘以 $-10$。这个操作会反转不等号的方向：\n$$GQ^{\\ast} \\ge 10 \\log_{10}(4000)$$\n我们可以简化对数项：\n$$\\log_{10}(4000) = \\log_{10}(4 \\times 1000) = \\log_{10}(4) + \\log_{10}(1000) = \\log_{10}(2^2) + 3 = 2 \\log_{10}(2) + 3$$\n$\\log_{10}(2)$ 的值约等于 $0.30103$。\n$$GQ^{\\ast} \\ge 10 (2 \\cdot (0.30103) + 3)$$\n$$GQ^{\\ast} \\ge 10 (0.60206 + 3)$$\n$$GQ^{\\ast} \\ge 10 (3.60206)$$\n$$GQ^{\\ast} \\ge 36.0206$$\n问题要求满足此条件的最小整数阈值 $GQ^{\\ast}$。大于或等于 $36.0206$ 的最小整数是 $37$。\n因此，最小整数 $GQ$ 阈值必须是 $37$。\n(b)部分和(c)部分的最终答案分别是 $0.01$ 和 $37$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.01 & 37 \\end{pmatrix}}$$"
        },
        {
            "introduction": "药物基因组学是基因组数据与电子健康记录 (EHR) 集成最成熟的应用之一，它根据患者的基因构成来指导药物处方。这个实践模拟了一个真实的临床决策支持 (Clinical Decision Support, CDS) 场景。你将使用一个包含患者年龄以及关键基因变异 ($VKORC1$ 和 $CYP2C9$) 的算法，来计算个性化的药物剂量，亲身体验基因组数据如何直接优化治疗方案。",
            "id": "4845094",
            "problem": "一个集成了电子健康记录 (EHR) 的临床决策支持 (CDS) 模块被设计用于计算窄治疗指数药物的初始剂量，其方法是通过一个带有对数连接函数的广义线性模型 (GLM) 来整合基因组特征。在一个带有对数连接函数的广义线性模型中，预测的正值量是通过对协变量的线性组合取指数来建模的。这种设置适用于剂量计算，因为指数化确保了剂量严格为正，并允许协变量在均值尺度上具有乘法效应。考虑一个实现方案，其中将维生素K环氧化物还原酶复合物亚基$1$ ($VKORC1$) 风险等位基因的存在编码为$1$，不存在则为$0$；将细胞色素P$450$ $2C9$ ($CYP2C9$) 功能减退基因型的存在编码为$1$，不存在则为$0$。该临床决策支持系统 (CDS) 使用规则 $Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$ 来计算剂量（单位：毫克/天），其系数为 $\\beta_0 = 3.5$，$\\beta_1 = -0.01$，$\\beta_2 = -0.3$ 和 $\\beta_3 = -0.2$。对于一位年龄为$65$岁、 $VKORC1 = 1$（存在风险等位基因）且 $CYP2C9 = 1$（功能减退）的患者，计算推荐剂量。以毫克/天为单位表示答案，并四舍五入到四位有效数字。",
            "solution": "本题要求使用一个给定的带有对数连接函数的广义线性模型（GLM）来计算药物剂量。这种类型的模型适用于预测严格为正的量，例如药物剂量。该模型的结构是协变量线性组合的指数函数。\n\n题目提供的剂量模型（$Dose$，单位：毫克/天）为：\n$$Dose = \\exp(\\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9)$$\n\n题目提供了以下模型系数值：\n- 截距：$\\beta_0 = 3.5$\n- 年龄的系数：$\\beta_1 = -0.01$\n- $VKORC1$ 等位基因存在的系数：$\\beta_2 = -0.3$\n- $CYP2C9$ 功能减退的系数：$\\beta_3 = -0.2$\n\n具体的患者数据如下：\n- 年龄：$65$ 岁\n- $VKORC1$ 状态：$1$（存在风险等位基因）\n- $CYP2C9$ 状态：$1$（存在功能减退基因型）\n\n首先，我们计算线性预测器的值，也就是指数函数的参数。我们用 $\\eta$ 表示线性预测器：\n$$\\eta = \\beta_0 + \\beta_1 \\cdot Age + \\beta_2 \\cdot VKORC1 + \\beta_3 \\cdot CYP2C9$$\n\n将给定值代入此表达式：\n$$\\eta = 3.5 + (-0.01) \\cdot 65 + (-0.3) \\cdot 1 + (-0.2) \\cdot 1$$\n\n现在，我们进行算术运算来求 $\\eta$ 的值：\n$$\\eta = 3.5 - 0.65 - 0.3 - 0.2$$\n$$\\eta = 3.5 - (0.65 + 0.3 + 0.2)$$\n$$\\eta = 3.5 - 1.15$$\n$$\\eta = 2.35$$\n\n计算出线性预测器的值后，我们现在可以通过应用指数函数来计算剂量：\n$$Dose = \\exp(\\eta) = \\exp(2.35)$$\n\n使用计算器计算此表达式：\n$$Dose \\approx 10.4855905...$$\n\n题目要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$4$ 和 $8$。第五位有效数字是 $5$，因此需要将第四位数字向上舍入。\n所以，四舍五入后的剂量是 $10.49$ 毫克/天。",
            "answer": "$$\\boxed{10.49}$$"
        },
        {
            "introduction": "除了药物反应，基因组学还能帮助我们预测复杂疾病的风险，这些疾病通常受到多个基因的共同影响。本练习将带你探索多基因风险评分 (Polygenic Risk Score, PRS) 这一前沿概念。你将从一个基线风险出发，利用个体的 PRS 和相关的比值比来计算其个性化的十年期疾病风险，这展示了 EHR 如何向医生和患者提供前瞻性的、个性化的健康风险信息。",
            "id": "4845077",
            "problem": "一家医院正在将其电子健康记录 (EHR) 系统与多基因风险评分 (PRS) 相整合，以提供个性化的$10$年疾病风险评估。该PRS经过标准化处理，在参考人群中其均值为$0$，标准差为$1$。对于PRS $= 0$的个体，该疾病的$10$年基线绝对风险为$p_0 = 0.05$。一项全基因组关联研究报告称，PRS每增加一个标准差，其比值比 (odds ratio) 为$r = 1.6$。假设比值比在PRS的各个标准差上以乘法方式作用于疾病发生比 (disease odds)，并且绝对风险是通过使用发生比的标准定义将其转换为概率而获得的。对于一个PRS为$+2$的个体，计算其个性化的$10$年绝对风险。请以小数形式表示您的答案，并将其四舍五入至四位有效数字。",
            "solution": "用户提供了一个关于医学信息学的问题，涉及基于多基因风险评分 (PRS) 计算个性化疾病风险。我将首先验证问题的陈述，如果问题有效，则继续进行解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   多基因风险评分 (PRS) 经过标准化，均值为$0$，标准差为$1$。\n-   对于PRS $= 0$的个体，$10$年基线绝对风险为 $p_0 = 0.05$。\n-   PRS每增加一个标准差，比值比为$r = 1.6$。\n-   比值比在PRS的各个标准差上以乘法方式作用于疾病发生比。\n-   绝对风险通过将发生比转换为概率获得。\n-   目标个体的PRS为$+2$。\n-   要求输出的是个性化的$10$年绝对风险，以小数形式表示并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于流行病学和统计遗传学的既定原则。使用比值比、基线风险和标准化的PRS来调节风险是该领域的标准方法。所提供的基线风险值 ($5\\%$) 和比值比 ($1.6$) 在常见复杂疾病的实际范围内。逻辑斯谛模型（在发生比尺度上是乘法关系）是此类分析的基石。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了所有必要的信息：基线概率、一个明确的风险修正机制（比值比）以及预测变量（PRS）的具体值。目标陈述清晰。可以确定一个唯一的解。\n-   **客观性**：该问题以精确、量化和客观的语言陈述，没有歧义或主观论断。\n-   **完整性与一致性**：该问题自成体系且内部一致。所有必需的参数（$p_0$、$r$和个体的PRS）均已提供。\n-   **现实性与可行性**：在个性化医疗和将基因组数据整合到临床实践的背景下，该场景和数据是现实的。\n-   **结构与清晰度**：该问题结构清晰，并使用了生物统计学的标准术语。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学依据、适定、客观和完整。我将继续进行解答。\n\n### 解题推导\n\n求解过程需要将基线风险转换为发生比 (odds)，然后根据个体的PRS应用比值比的乘法效应，最后将得出的发生比转换回概率（绝对风险）。\n\n概率$p$与发生比$O$之间的关系定义如下：\n$$O = \\frac{p}{1-p}$$\n反之：\n$$p = \\frac{O}{1+O}$$\n\n首先，我们计算PRS为$0$的个体的基线发生比$O_0$。给定的基线风险（概率）为$p_0 = 0.05$。\n$$O_0 = \\frac{p_0}{1-p_0} = \\frac{0.05}{1-0.05} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\n\n接下来，我们计算所讨论个体的发生比。问题陈述，PRS每增加一个标准差，比值比为$r = 1.6$。发生比是以乘法方式累积的。对于一个PRS值为$z$（即距离均值$z$个标准差）的个体，其个性化发生比$O(z)$由下式给出：\n$$O(z) = O_0 \\times r^z$$\n\n该个体的PRS为$+2$，所以$z = 2$。我们可以计算其个性化发生比$O_{ind}$：\n$$O_{ind} = O(2) = O_0 \\times r^2$$\n代入$O_0$和$r$的值：\n$$O_{ind} = \\left(\\frac{1}{19}\\right) \\times (1.6)^2 = \\frac{1}{19} \\times 2.56 = \\frac{2.56}{19}$$\n\n最后，我们将这个性化发生比转换回绝对风险（概率）$p_{ind}$：\n$$p_{ind} = \\frac{O_{ind}}{1+O_{ind}}$$\n代入$O_{ind}$的表达式：\n$$p_{ind} = \\frac{\\frac{2.56}{19}}{1 + \\frac{2.56}{19}} = \\frac{\\frac{2.56}{19}}{\\frac{19}{19} + \\frac{2.56}{19}} = \\frac{\\frac{2.56}{19}}{\\frac{19 + 2.56}{19}} = \\frac{2.56}{21.56}$$\n\n现在，我们进行数值计算：\n$$p_{ind} = \\frac{2.56}{21.56} \\approx 0.11873840445...$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是$1$、$1$、$8$和$7$。第五位有效数字是$3$，小于$5$，所以我们向下舍入（即截断）。\n$$p_{ind} \\approx 0.1187$$\n\n因此，对于一个PRS为$+2$的人，其个性化的$10$年绝对风险约为$0.1187$。",
            "answer": "$$\\boxed{0.1187}$$"
        }
    ]
}