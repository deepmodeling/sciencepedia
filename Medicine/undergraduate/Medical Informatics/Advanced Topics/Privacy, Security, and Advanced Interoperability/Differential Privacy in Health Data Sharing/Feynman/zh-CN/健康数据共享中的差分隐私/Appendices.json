{
    "hands_on_practices": [
        {
            "introduction": "要应用差分隐私，一个关键的初始步骤是量化单个个体的数据对查询输出可能产生的最大影响。本练习将指导您计算一个常见的健康指标——总和统计量——的“敏感度”，然后用它来确定需要添加的恰当噪音量，这一过程称为校准拉普拉斯机制 。",
            "id": "4835475",
            "problem": "一家研究型医院计划发布一个从其电子健康记录（EHR）系统中导出的聚合质量指标：一个月内记录的所有成年患者的血清肌酐测量值的总和。对于每位患者 $i$，假设有 $m_i$ 次抽血检测，测量值为 $x_{i1}, x_{i2}, \\dots, x_{im_i}$，单位为 $\\text{mg/dL}$。患者的原始总和定义为 $t_i = \\sum_{j=1}^{m_i} x_{ij}$。为了保护隐私并增强鲁棒性，医院将每位患者的贡献值以一个固定的上限 $C$（单位为 $\\text{mg/dL}$）进行裁剪，形成 $s_i = \\min(t_i, C)$。发布的统计量是求和查询\n$$\nf(D) = \\sum_{i=1}^{n} s_i,\n$$\n其中 $D$ 是包含 $n$ 名患者的数据集。\n\n医院将使用纯差分隐私（DP），隐私参数为 $\\varepsilon$，并采用添加/删除相邻关系：如果一个数据集可以通过添加或删除单个患者的完整 EHR 记录得到另一个数据集，则这两个数据集 $D$ 和 $D'$ 是相邻的。该随机化机制会向查询输出添加从拉普拉斯分布中抽取的噪声，该分布以零为中心，尺度参数为 $b$（单位与查询相同，为 $\\text{mg/dL}$）。\n\n仅使用基本原理——差分隐私的形式化定义、指定相邻关系下查询的全局 $\\ell_1$ 敏感度概念，以及拉普拉斯分布的概率密度函数——推导出 $f$ 的全局 $\\ell_1$ 敏感度，然后确定满足此求和查询的 $\\varepsilon$-DP 所需的尺度参数 $b$。取 $C = 10\\,\\text{mg/dL}$ 和 $\\varepsilon = 0.8$。将 $b$ 的最终值四舍五入到四位有效数字，并以 $\\text{mg/dL}$ 为单位表示。只报告 $b$ 的值。",
            "solution": "我们从差分隐私（DP）的形式化定义开始。如果对于所有相邻数据集 $D$ 和 $D'$ 以及所有输出的可测子集 $S$，一个随机化机制 $\\mathcal{M}$ 在添加/删除相邻关系下满足 $\\varepsilon$-DP，则有：\n$$\n\\Pr[\\mathcal{M}(D) \\in S] \\leq \\exp(\\varepsilon)\\,\\Pr[\\mathcal{M}(D') \\in S].\n$$\n\n我们感兴趣的机制是应用于求和查询 $f(D)$ 的拉普拉斯机制，即\n$$\n\\mathcal{M}(D) = f(D) + Y,\n$$\n其中 $Y$ 是一个服从拉普拉斯分布的随机变量，其均值为 $0$，尺度参数为 $b$。$Y$ 的概率密度函数（pdf）是\n$$\np_{Y}(y) = \\frac{1}{2b}\\,\\exp\\!\\left(-\\frac{|y|}{b}\\right).\n$$\n\n为了使用拉普拉斯机制，我们需要在指定的相邻关系下，查询 $f$ 的全局 $\\ell_1$ 敏感度。全局 $\\ell_1$ 敏感度 $\\Delta_{1}(f)$ 定义为\n$$\n\\Delta_{1}(f) = \\max_{D \\sim D'} |f(D) - f(D')|,\n$$\n其中 $D \\sim D'$ 表示 $D$ 和 $D'$ 是相邻数据集（因添加或删除一名患者的记录而不同）。\n\n给定 $f(D) = \\sum_{i=1}^{n} s_i$，其中 $s_i = \\min(t_i, C)$ 且 $t_i = \\sum_{j=1}^{m_i} x_{ij}$，在添加/删除邻接关系下，$D'$ 与 $D$ 的区别在于单个患者 $p$ 的存在与否。那么\n$$\nf(D) - f(D') = \n\\begin{cases}\ns_p  \\text{若 } D' \\text{ 是由 } D \\text{ 移除患者 } p \\text{ 得到},\\\\\n-s_p  \\text{若 } D \\text{ 是由 } D' \\text{ 移除患者 } p \\text{ 得到}。\n\\end{cases}\n$$\n因此，\n$$\n|f(D) - f(D')| = |s_p|.\n$$\n根据构造，每个 $s_p$ 都被裁剪：$s_p = \\min(t_p, C)$，这意味着 $0 \\leq s_p \\leq C$。因此，\n$$\n|f(D) - f(D')| \\leq C,\n$$\n并且由于存在患者能达到 $s_p = C$ 的数据集，因此可能的最大变化量在 $C$ 处达到。所以，\n$$\n\\Delta_{1}(f) = C.\n$$\n\n接下来，我们推导拉普拉斯机制满足 $\\varepsilon$-DP 所需的尺度参数 $b$。考虑在固定值 $z \\in \\mathbb{R}$ 处输出密度的比率：\n$$\n\\frac{p_{\\mathcal{M}(D)}(z)}{p_{\\mathcal{M}(D')}(z)} \n= \n\\frac{\\frac{1}{2b}\\exp\\!\\left(-\\frac{|z - f(D)|}{b}\\right)}{\\frac{1}{2b}\\exp\\!\\left(-\\frac{|z - f(D')|}{b}\\right)}\n=\n\\exp\\!\\left(\\frac{|z - f(D')| - |z - f(D)|}{b}\\right).\n$$\n使用反三角不等式 $||a|-|b|| \\leq |a-b|$，我们得到\n$$\n\\left||z - f(D')| - |z - f(D)|\\right| \\leq |f(D) - f(D')|.\n$$\n因此，对于所有 $z$，\n$$\n\\frac{p_{\\mathcal{M}(D)}(z)}{p_{\\mathcal{M}(D')}(z)} \n\\leq \\exp\\!\\left(\\frac{|f(D) - f(D')|}{b}\\right)\n\\leq \\exp\\!\\left(\\frac{\\Delta_{1}(f)}{b}\\right).\n$$\n为了确保对所有可测子集 $S$ 都满足 DP 条件 $\\Pr[\\mathcal{M}(D) \\in S] \\leq \\exp(\\varepsilon)\\,\\Pr[\\mathcal{M}(D') \\in S]$，只需满足：\n$$\n\\exp\\!\\left(\\frac{\\Delta_{1}(f)}{b}\\right) \\leq \\exp(\\varepsilon),\n$$\n这等价于\n$$\n\\frac{\\Delta_{1}(f)}{b} \\leq \\varepsilon\n\\quad\\Rightarrow\\quad\nb \\geq \\frac{\\Delta_{1}(f)}{\\varepsilon}.\n$$\n\n使用推导出的敏感度 $\\Delta_{1}(f) = C$ 以及给定的参数 $C = 10\\,\\text{mg/dL}$ 和 $\\varepsilon = 0.8$，最小尺度为\n$$\nb = \\frac{C}{\\varepsilon} = \\frac{10}{0.8} = 12.5\\,\\text{mg/dL}.\n$$\n按要求四舍五入到四位有效数字（并以 $\\text{mg/dL}$ 为单位表示），结果是：\n$$\nb = 12.50\\,\\text{mg/dL}.\n$$\n\n题目要求我们只报告 $b$ 的值，并四舍五入到四位有效数字。",
            "answer": "$$\\boxed{12.50}$$"
        },
        {
            "introduction": "隐私保障的强度完全取决于我们如何定义“个体”。本练习探讨了事件级隐私（保护单次就诊记录）和用户级隐私（保护单个患者的所有数据）之间的关键区别 。您将看到这个选择如何从根本上改变敏感度的计算，并因此影响所需添加的噪音量。",
            "id": "4835559",
            "problem": "一个医疗系统维护着一个电子健康记录（EHR）就诊事件数据库，其中每条就诊记录包含一个患者标识符和一个时间戳。考虑一个$30$天的报告窗口期和以下计数查询：对于一个由该窗口期内的就诊记录组成的数据集$D$，定义\n$$\nq(D) = \\sum_{u \\in \\mathcal{U}} \\min\\{v_u(D), K\\},\n$$\n其中 $\\mathcal{U}$ 是在该窗口期内至少有一次就诊的用户（患者）集合，$v_u(D)$ 是用户 $u$ 在该窗口期内在 $D$ 中的就诊记录数，而 $K$ 是一个策略上限，通过裁剪将每个用户的贡献限制为最多 $K$ 次就诊。假设所有就诊都具有单位权重，并且系统对每个用户在$30$天的窗口期内强制执行$K = 7$的裁剪。\n\n对于差分隐私（DP），使用了两种邻近性概念。在事件级邻近性下，如果两个数据集 $D$ 和 $D'$ 相差恰好一条就诊记录，则它们是邻近的。在用户级邻近性下，如果两个数据集 $D$ 和 $D'$ 相差恰好一个用户的全部就诊记录集合，则它们是邻近的。\n\n从函数 $q$ 的全局敏感度的核心定义出发，即\n$$\n\\Delta = \\max_{D \\sim D'} |q(D) - q(D')|,\n$$\n其中 $D \\sim D'$ 表示在指定概念下的邻近关系，请在此健康数据共享情境中，推导 $q$ 在事件级和用户级邻近性下的全局敏感度，然后计算用户级全局敏感度与事件级全局敏感度之间的差值。将您的最终答案表示为单个实数。无需四舍五入。",
            "solution": "问题要求计算给定计数查询的用户级和事件级全局敏感度之间的差值。该查询定义为：\n$$\nq(D) = \\sum_{u \\in \\mathcal{U}} \\min\\{v_u(D), K\\}\n$$\n其中 $D$ 是一个就诊记录的数据集，$\\mathcal{U}$ 是数据集中的用户集合，$v_u(D)$ 是用户 $u$ 在 $D$ 中的就诊次数，而 $K$ 是一个设置为 $K=7$ 的裁剪参数。\n\n函数 $q$ 的全局敏感度 $\\Delta$ 定义为在所有可能的邻近数据集对 $D$ 和 $D'$ 上，函数输出的最大绝对差值。\n$$\n\\Delta = \\max_{D \\sim D'} |q(D) - q(D')|\n$$\n邻近性的定义 $D \\sim D'$ 取决于隐私模型。我们将分析两种模型下的敏感度：事件级邻近性和用户级邻近性。\n\n首先，我们推导事件级全局敏感度，我们将其记为 $\\Delta_{\\text{event}}$。\n在事件级邻近性下，如果两个数据集 $D$ 和 $D'$ 相差恰好一条就诊记录，则它们是邻近的。不失一般性地，我们假设 $D' = D \\cup \\{r\\}$，其中 $r$ 是某个用户 $u^*$ 的单条就诊记录。$D' = D \\setminus \\{r\\}$ 的情况是对称的。\n\n当为用户 $u^*$ 添加记录 $r$ 时，任何其他用户 $u \\neq u^*$ 的就诊次数保持不变，即 $v_u(D') = v_u(D)$。用户 $u^*$ 的就诊次数增加一：$v_{u^*}(D') = v_{u^*}(D) + 1$。因此，查询输出的差值完全由用户 $u^*$ 对应项的变化决定。\n$$\n|q(D') - q(D)| = \\left| \\left( \\sum_{u \\neq u^*} \\min\\{v_u(D'), K\\} + \\min\\{v_{u^*}(D'), K\\} \\right) - \\left( \\sum_{u \\neq u^*} \\min\\{v_u(D), K\\} + \\min\\{v_{u^*}(D), K\\} \\right) \\right|\n$$\n$$\n|q(D') - q(D)| = |\\min\\{v_{u^*}(D'), K\\} - \\min\\{v_{u^*}(D), K\\}|\n$$\n代入 $v_{u^*}(D') = v_{u^*}(D) + 1$，我们得到：\n$$\n|q(D') - q(D)| = |\\min\\{v_{u^*}(D) + 1, K\\} - \\min\\{v_{u^*}(D), K\\}|\n$$\n为了找到全局敏感度，我们必须在所有可能的数据集 $D$ 上使该量最大化，这等价于在所有可能的初始就诊次数 $v_{u^*}(D)$ 上进行最大化。设 $v = v_{u^*}(D)$，其中 $v$ 是一个非负整数。我们分析当 $K=7$ 时表达式 $|\\min\\{v+1, K\\} - \\min\\{v, K\\}|$ 的值。\n\n情况1：$v \\ge K$。在这种情况下，$v \\ge 7$。那么 $v+1 > K$。\n差值为 $|\\min\\{v+1, 7\\} - \\min\\{v, 7\\}| = |7 - 7| = 0$。\n\n情况2：$v  K$。在这种情况下，$v \\le 6$。\n如果 $v = K-1 = 6$，差值为 $|\\min\\{6+1, 7\\} - \\min\\{6, 7\\}| = |\\min\\{7, 7\\} - \\min\\{6, 7\\}| = |7 - 6| = 1$。\n如果 $v  K-1$，即 $v \\le 5$，那么 $v+1  K=7$。差值为 $|\\min\\{v+1, 7\\} - \\min\\{v, 7\\}| = |(v+1) - v| = 1$。\n\n因此，当添加或删除单条记录时，可能的最大变化是 $1$。所以，事件级全局敏感度为：\n$$\n\\Delta_{\\text{event}} = 1\n$$\n\n接下来，我们推导用户级全局敏感度，记为 $\\Delta_{\\text{user}}$。\n在用户级邻近性下，如果两个数据集 $D$ 和 $D'$ 相差单个用户的全部就诊记录集合，则它们是邻近的。让我们通过考虑向数据集中添加一个用户 $u^*$ 来分析可能的最大变化。设 $D$ 是一个不包含用户 $u^*$ 记录的数据集，因此 $v_{u^*}(D)=0$。设 $D'$ 是数据集 $D$ 加上用户 $u^*$ 的所有就诊记录。该用户在 $D'$ 中的就诊次数为 $v_{u^*}(D') = n$，其中 $n$ 可以是任何大于或等于 $1$ 的整数。所有其他用户 $u \\neq u^*$ 的就诊次数不受影响。\n\n查询输出的变化是：\n$$\n|q(D') - q(D)| = |\\min\\{v_{u^*}(D'), K\\} - \\min\\{v_{u^*}(D), K\\}|\n$$\n代入 $v_{u^*}(D')=n$ 和 $v_{u^*}(D)=0$：\n$$\n|q(D') - q(D)| = |\\min\\{n, K\\} - \\min\\{0, K\\}| = |\\min\\{n, K\\} - 0| = \\min\\{n, K\\}\n$$\n为了找到全局敏感度，我们必须在所有可能的邻近数据集 $D$ 和 $D'$ 上使该量最大化。这等价于选择用户 $u^*$ 的就诊次数 $n$ 以使 $\\min\\{n, K\\}$ 最大化。由于问题陈述未对 $30$ 天窗口期内用户的就诊次数 $n$ 进行限制，我们可以假设 $n$ 可以是任意大的。函数 $\\min\\{n, K\\}$ 随 $n$ 的增加而增加，直到 $n=K$，然后对于所有 $n \\ge K$ 的情况，它都保持在 $K$ 不变。\n$\\min\\{n, K\\}$ 的最大值是 $K$。对于任何就诊次数 $n \\ge K$ 的用户，都可以达到这个最大值。\n\n因此，用户级全局敏感度为：\n$$\n\\Delta_{\\text{user}} = K\n$$\n根据策略上限 $K=7$，我们有：\n$$\n\\Delta_{\\text{user}} = 7\n$$\n\n最后，问题要求计算用户级全局敏感度与事件级全局敏感度之间的差值。\n$$\n\\text{差值} = \\Delta_{\\text{user}} - \\Delta_{\\text{event}} = 7 - 1 = 6\n$$\n所得差值为单个实数。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "发布差分隐私数据只是成功的一半，如何利用这些数据进行有效的统计推断是另一半。本练习揭示了一个常见的陷阱：直接将标准统计检验应用于带噪音的数据可能会得出错误的结论。您将推导出一个修正的检验统计量，它能恰当地将隐私机制引入的噪音考虑在内，从而实现可靠的假设检验 。",
            "id": "4835490",
            "problem": "一家医院正在评估本季度低密度脂蛋白胆固醇 (LDL-C) 异常升高的患者比例是否超过了先前验证过的基线比例。为保护患者隐私，该医院遵守差分隐私 (DP) 原则，仅发布一个净化后的 LDL-C 升高病例数，该数据是通过向真实计数添加独立的拉普拉斯噪声得到的。医院希望检验一个原假设，即 LDL-C 升高的真实比例保持在基线值。\n\n假设存在以下科学上合理的设定：\n- 在 $n$ 名患者中，LDL-C 升高的真实病历数是一个随机变量 $C$，其模型为 $C \\sim \\mathrm{Binomial}(n,p)$。\n- 在原假设 $H_{0}: p = p_{0}$下，$p_{0}$ 是基线比例。\n- 发布的差分隐私计数为 $\\tilde{C} = C + \\eta$，其中 $\\eta \\sim \\mathrm{Laplace}(0,b)$ 且独立于 $C$。这里，$b$ 是数据管理者为满足固定的隐私预算而选择的拉普拉斯尺度参数；你可以认为拉普拉斯分布的均值为零，方差为 $2b^{2}$。\n- 经典的二项比例大样本 $z$ 检验在 $H_{0}$ 下使用 $C$ 的正态近似。\n\n请从二项式模型的基本原理和独立加性噪声的性质出发，解释为什么在忽略差分隐私噪声的情况下，对发布的 $\\tilde{C}$ 朴素地应用标准 $z$ 检验会导致错误估计的 $p$ 值。然后，推导一个修正后的大样本检验统计量，该统计量将差分隐私引起的噪声方差纳入到原假设方差中。最后，根据以下具体发布的数据计算该修正后的检验统计量：\n- $n = 800$ 名患者，\n- $p_{0} = 0.12$，\n- $b = 5$，\n- 发布的计数 $\\tilde{C} = 118.5$，\n\n并报告修正后的检验统计量的值。将你的数值答案四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "首先，我们建立一个用于比例检验的经典大样本 z 检验框架。在原假设 $H_{0}: p = p_{0}$ 下，真实的病例数 $C$ 服从二项分布，$C \\sim \\mathrm{Binomial}(n, p_{0})$。对于大样本 $n$，该分布可以很好地用正态分布近似，$C \\approx \\mathrm{Normal}(\\mu_{C}, \\sigma_{C}^{2})$，其中均值为 $\\mu_{C} = \\mathrm{E}[C] = np_{0}$，方差为 $\\sigma_{C}^{2} = \\mathrm{Var}(C) = np_{0}(1-p_{0})$。标准的检验统计量通过对观测到的计数 $C$ 进行标准化来构建：\n$$ Z = \\frac{C - \\mathrm{E}[C]}{\\sqrt{\\mathrm{Var}(C)}} = \\frac{C - np_{0}}{\\sqrt{np_{0}(1-p_{0})}} $$\n这等价于使用样本比例 $\\hat{p} = C/n$ 的更常见的形式：\n$$ Z = \\frac{\\hat{p} - p_{0}}{\\sqrt{p_{0}(1-p_{0})/n}} $$\n\n现在，考虑将此检验朴素地应用于发布的差分隐私计数 $\\tilde{C}$。朴素方法会用 $\\tilde{C}$ 替代标准公式中的 $C$，或者等效地，使用含噪比例 $\\tilde{p} = \\tilde{C}/n$ 来代替 $\\hat{p}$。这会得到一个朴素检验统计量：\n$$ Z_{\\text{naive}} = \\frac{\\tilde{C} - np_{0}}{\\sqrt{np_{0}(1-p_{0})}} $$\n这种构造的缺陷在于分子中的随机变量与分母中用于标准化的方差不匹配。分子 $\\tilde{C} - np_{0}$ 包含来自两个独立来源的变异性：原始抽样过程（$C$ 的变异性）和添加的拉普拉斯噪声（$\\eta$ 的变异性）。然而，分母 $\\sqrt{np_{0}(1-p_{0})}$ 只考虑了真实计数 $C$ 的方差。\n\n为了将其形式化，我们来分析含噪计数 $\\tilde{C} = C + \\eta$ 的方差。由于 $C$ 和 $\\eta$ 被指定为独立的，它们的和的方差等于它们方差的和：\n$$ \\mathrm{Var}(\\tilde{C}) = \\mathrm{Var}(C + \\eta) = \\mathrm{Var}(C) + \\mathrm{Var}(\\eta) $$\n在原假设 $H_{0}$ 下，我们有 $\\mathrm{Var}(C) = np_{0}(1-p_{0})$。问题陈述噪声 $\\eta \\sim \\mathrm{Laplace}(0, b)$ 的方差为 $\\mathrm{Var}(\\eta) = 2b^{2}$。因此，在 $H_{0}$ 下，含噪计数的真实方差是：\n$$ \\mathrm{Var}_{H_{0}}(\\tilde{C}) = np_{0}(1-p_{0}) + 2b^{2} $$\n朴素检验统计量错误地使用 $\\sqrt{np_{0}(1-p_{0})}$ 作为标准误，这严格小于真实的标准误 $\\sqrt{np_{0}(1-p_{0}) + 2b^{2}}$。在分母中使用一个被低估的方差会人为地夸大检验统计量 $|Z_{\\text{naive}}|$ 的大小。这会导致对统计显著性的高估、计算出的 $p$ 值偏小，并增加犯 I 型错误（即在原假设为真时错误地拒绝它）的概率。\n\n为了推导一个修正后的大样本检验统计量，我们必须使用 $\\tilde{C}$ 在原假设下的正确均值和标准差来对其观测值进行标准化。在 $H_{0}$ 下，$\\tilde{C}$ 的期望值为：\n$$ \\mathrm{E}_{H_{0}}[\\tilde{C}] = \\mathrm{E}[C + \\eta] = \\mathrm{E}[C] + \\mathrm{E}[\\eta] = np_{0} + 0 = np_{0} $$\n如上推导，在 $H_{0}$ 下，$\\tilde{C}$ 的方差为 $\\mathrm{Var}_{H_{0}}(\\tilde{C}) = np_{0}(1-p_{0}) + 2b^{2}$。对于大样本检验，我们用具有此均值和方差的正态分布来近似 $\\tilde{C}$ 的抽样分布。因此，修正后的检验统计量 $Z_{\\text{corr}}$ 为：\n$$ Z_{\\text{corr}} = \\frac{\\tilde{C} - \\mathrm{E}_{H_{0}}[\\tilde{C}]}{\\sqrt{\\mathrm{Var}_{H_{0}}(\\tilde{C})}} = \\frac{\\tilde{C} - np_{0}}{\\sqrt{np_{0}(1-p_{0}) + 2b^{2}}} $$\n该统计量恰当地考虑了两种随机性来源：二项抽样和加性拉普拉斯噪声。\n\n最后，我们使用所提供的数据计算修正后的检验统计量的值：$n = 800$，$p_{0} = 0.12$，$b = 5$，以及观测到的发布计数 $\\tilde{C} = 118.5$。\n\n首先，我们计算原假设下的期望计数：\n$$ \\mathrm{E}_{H_{0}}[\\tilde{C}] = np_{0} = 800 \\times 0.12 = 96 $$\n接下来，我们计算方差的两个组成部分：\n来自二项过程的方差是：\n$$ \\sigma_{C}^{2} = np_{0}(1-p_{0}) = 800 \\times 0.12 \\times (1 - 0.12) = 96 \\times 0.88 = 84.48 $$\n来自拉普拉斯噪声的方差是：\n$$ \\sigma_{\\eta}^{2} = 2b^{2} = 2 \\times 5^{2} = 2 \\times 25 = 50 $$\n原假设下的总方差是这两个分量的和：\n$$ \\mathrm{Var}_{H_{0}}(\\tilde{C}) = \\sigma_{C}^{2} + \\sigma_{\\eta}^{2} = 84.48 + 50 = 134.48 $$\n检验统计量的分子是观测计数与期望计数之差：\n$$ \\tilde{C} - np_{0} = 118.5 - 96 = 22.5 $$\n现在我们可以计算修正后的检验统计量：\n$$ Z_{\\text{corr}} = \\frac{22.5}{\\sqrt{134.48}} \\approx \\frac{22.5}{11.596551} \\approx 1.939912 $$\n将结果四舍五入到四位有效数字得到 $1.940$。",
            "answer": "$$\\boxed{1.940}$$"
        }
    ]
}