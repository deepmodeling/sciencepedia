{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any outbreak investigation is to quantify the association between a suspected exposure and the resulting illness. This involves comparing how often the disease occurred in those who were exposed versus those who were not. This exercise  challenges you to calculate and distinguish between two fundamental measures of disease frequency: risk (often called the attack rate in an outbreak) and rate. By working through a realistic foodborne outbreak scenario, you will develop the essential skill of using these metrics to compute risk ratios and rate ratios, which are critical for identifying the source of an outbreak.",
            "id": "4977747",
            "problem": "A suspected foodborne outbreak occurs following a school banquet. Investigators construct a closed cohort over $1$ month of surveillance starting the day after the event. Among those who ate the implicated dish (exposed), there are $1{,}000$ students; among those who did not eat it (unexposed), there are $2{,}000$ students. Over the $1$-month period, there are $80$ new illness episodes among the exposed and $60$ among the unexposed that meet the case definition. Because of short absences and early departures, accrued person-time totals $800$ person-months in the exposed and $1{,}900$ person-months in the unexposed.\n\nUsing only core epidemiologic definitions for cumulative incidence (risk), incidence rate (incidence density), attack rate, risk ratio, and rate ratio as your starting point, do the following:\n\n1. Compute the attack rates in the exposed and unexposed groups over the $1$-month period, and from these compute the risk ratio comparing exposed to unexposed.\n2. Compute the incidence rates in each group using the provided person-time, and from these compute the rate ratio comparing exposed to unexposed.\n3. Provide a concise, one-sentence interpretation of the attack rates in the context of this school outbreak.\n\nAnswer specification:\n- Round the risk ratio and the rate ratio to three significant figures.\n- Express the exposed and unexposed attack rates as decimals rounded to four significant figures.\n- In your final answer, report the four numbers in the order: exposed attack rate, unexposed attack rate, risk ratio, rate ratio. Do not include units and do not include any text in the final answer box.",
            "solution": "The problem statement has been validated and is determined to be a valid, self-contained, and well-posed question grounded in standard epidemiologic principles. All necessary data for the required calculations are provided, and there are no internal contradictions or scientific inaccuracies. We will proceed with the solution.\n\nThe problem requires the calculation of several core epidemiologic measures of association from data collected during a closed cohort study of a foodborne outbreak. We will first define the necessary terms, then compute the values as requested.\n\nThe following data are given:\n- Number of exposed individuals, $N_e = 1{,}000$.\n- Number of unexposed individuals, $N_u = 2{,}000$.\n- Number of new cases in the exposed group, $I_e = 80$.\n- Number of new cases in the unexposed group, $I_u = 60$.\n- Person-time at risk in the exposed group, $PT_e = 800$ person-months.\n- Person-time at risk in the unexposed group, $PT_u = 1{,}900$ person-months.\n\n1.  **Attack Rates and Risk Ratio**\n\nThe **attack rate (AR)** is a form of cumulative incidence (risk) calculated for a specific group over a defined period during an epidemic. It is the proportion of individuals at risk who develop the illness.\n$$\n\\text{AR} = \\frac{\\text{Number of new cases}}{\\text{Number of people at risk}}\n$$\nWe calculate the attack rate for the exposed ($AR_e$) and unexposed ($AR_u$) groups.\n\nFor the exposed group:\n$$\nAR_e = \\frac{I_e}{N_e} = \\frac{80}{1{,}000} = 0.08\n$$\nAs specified, rounding to four decimal places gives $AR_e = 0.0800$.\n\nFor the unexposed group:\n$$\nAR_u = \\frac{I_u}{N_u} = \\frac{60}{2{,}000} = 0.03\n$$\nRounding to four decimal places gives $AR_u = 0.0300$.\n\nThe **risk ratio (RR)**, also known as the cumulative incidence ratio, compares the risk of disease in the exposed group to the risk in the unexposed group.\n$$\n\\text{RR} = \\frac{AR_e}{AR_u}\n$$\nUsing the calculated attack rates:\n$$\n\\text{RR} = \\frac{0.08}{0.03} = \\frac{8}{3} \\approx 2.666...\n$$\nRounding to three significant figures, the risk ratio is $\\text{RR} \\approx 2.67$.\n\n2.  **Incidence Rates and Rate Ratio**\n\nThe **incidence rate (IR)**, or incidence density, measures the rate at which new cases occur in a population over time. It is calculated by dividing the number of new cases by the total person-time at risk.\n$$\n\\text{IR} = \\frac{\\text{Number of new cases}}{\\text{Total person-time at risk}}\n$$\nWe calculate the incidence rate for the exposed ($IR_e$) and unexposed ($IR_u$) groups.\n\nFor the exposed group:\n$$\nIR_e = \\frac{I_e}{PT_e} = \\frac{80 \\text{ cases}}{800 \\text{ person-months}} = 0.1 \\frac{\\text{cases}}{\\text{person-month}}\n$$\n\nFor the unexposed group:\n$$\nIR_u = \\frac{I_u}{PT_u} = \\frac{60 \\text{ cases}}{1{,}900 \\text{ person-months}} = \\frac{6}{190} \\frac{\\text{cases}}{\\text{person-month}} \\approx 0.031578... \\frac{\\text{cases}}{\\text{person-month}}\n$$\n\nThe **rate ratio (IRR)**, also known as the incidence density ratio, compares the incidence rate of disease in the exposed group to the incidence rate in the unexposed group.\n$$\n\\text{IRR} = \\frac{IR_e}{IR_u}\n$$\nUsing the calculated incidence rates:\n$$\n\\text{IRR} = \\frac{80/800}{60/1900} = \\frac{0.1}{60/1900} = 0.1 \\times \\frac{1900}{60} = \\frac{190}{60} = \\frac{19}{6} \\approx 3.1666...\n$$\nRounding to three significant figures, the rate ratio is $\\text{IRR} \\approx 3.17$.\n\n3.  **Interpretation of Attack Rates**\n\nThe attack rates represent the risk of becoming ill during the one-month period for each group. Over the one-month surveillance period, the risk of developing illness was $8.00\\%$ among students who ate the implicated dish and $3.00\\%$ among those who did not.\n\nThe final answer requires only the four computed numerical values in the specified order: exposed attack rate, unexposed attack rate, risk ratio, and rate ratio.\n- Exposed attack rate: $0.0800$\n- Unexposed attack rate: $0.0300$\n- Risk ratio: $2.67$\n- Rate ratio: $3.17$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0800 & 0.0300 & 2.67 & 3.17 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Effective public health surveillance relies on diagnostic tests, but interpreting their results requires more than just knowing their lab-rated sensitivity and specificity. The probability that a positive test result is truly positive—its Positive Predictive Value ($PPV$)—critically depends on the prevalence of the disease in the population. This practice  will guide you through calculating a test's $PPV$ and Negative Predictive Value ($NPV$) and demonstrate how our confidence in a diagnosis can be updated with additional information, a core principle of evidence-based medicine.",
            "id": "4977769",
            "problem": "A citywide syndromic surveillance program monitors influenza-like illness and estimates the point prevalence of active infection in adult outpatients to be $0.02$. A rapid antigen test used in the program has sensitivity $0.85$ and specificity $0.97$ for detecting current infection. For a patient without prior testing, the test is performed twice on separate swabs by independent technicians within the same visit; conditional on true disease status, the two test results can be assumed independent and identically distributed with the same sensitivity and specificity.\n\nUsing only the fundamental definitions of sensitivity, specificity, prevalence, and conditional probability, and adopting scientifically standard reasoning to combine independent evidence, determine the following for this surveillance context:\n\n- The positive predictive value (PPV), defined as the probability of true infection given a single positive rapid test result.\n- The negative predictive value (NPV), defined as the probability of no infection given a single negative rapid test result.\n- The posterior probability of true infection after two independent positive rapid test results on the same patient.\n\nExpress each probability as a decimal and round your answers to four significant figures. Do not use percent signs in your responses.",
            "solution": "The problem is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n- Point prevalence of active infection, $P_D$: $0.02$\n- Sensitivity of the rapid antigen test, $S_e$: $0.85$\n- Specificity of the rapid antigen test, $S_p$: $0.97$\n- Two tests are performed on separate swabs by independent technicians.\n- Conditional on true disease status, the two test results are independent and identically distributed.\n- The task is to determine:\n    1. Positive predictive value (PPV) for a single test.\n    2. Negative predictive value (NPV) for a single test.\n    3. Posterior probability of true infection after two independent positive tests.\n- All results must be expressed as decimals rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on fundamental principles of probability theory, specifically Bayes' theorem, and its application in medical diagnostics and epidemiology. The concepts of prevalence, sensitivity, specificity, and predictive values are standard in this field. The given numerical values are realistic for a rapid antigen test.\n- **Well-Posed:** The problem is well-defined. It provides all necessary data (prevalence, sensitivity, specificity) and clearly specifies the quantities to be calculated. The assumption of conditional independence is explicitly stated, which is a standard and necessary condition for solving the third part of the problem. A unique, stable, and meaningful solution exists.\n- **Objective:** The problem is stated in precise, unbiased, and objective language, free of subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is scientifically sound, self-contained, and well-posed. The solution process may proceed.\n\n---\n\nLet $D$ be the event that a patient has the true infection, and let $D^c$ be the event that the patient does not have the infection. Let $T^+$ denote a positive test result and $T^-$ denote a negative test result.\n\nThe givens can be formulated in terms of conditional probabilities:\n- The prevalence is the prior probability of disease: $P(D) = 0.02$.\n- The probability of not having the disease is $P(D^c) = 1 - P(D) = 1 - 0.02 = 0.98$.\n- Sensitivity is the probability of a positive test given the disease is present: $P(T^+ | D) = 0.85$.\n- Specificity is the probability of a negative test given the disease is absent: $P(T^- | D^c) = 0.97$.\n\nFrom these, we can derive the probabilities of the complementary events:\n- The false negative rate is $P(T^- | D) = 1 - P(T^+ | D) = 1 - 0.85 = 0.15$.\n- The false positive rate is $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.97 = 0.03$.\n\n**1. Positive Predictive Value (PPV) for a Single Test**\n\nThe PPV is the probability of having the disease given a positive test result, which is $P(D | T^+)$. We use Bayes' theorem:\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\nTo find the denominator, $P(T^+)$, we apply the law of total probability:\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\nSubstituting the given values:\n$$P(T^+) = (0.85)(0.02) + (0.03)(0.98) = 0.017 + 0.0294 = 0.0464$$\nNow we can compute the PPV:\n$$P(D | T^+) = \\frac{0.017}{0.0464} \\approx 0.3663793...$$\nRounding to four significant figures, the PPV is $0.3664$.\n\n**2. Negative Predictive Value (NPV) for a Single Test**\n\nThe NPV is the probability of not having the disease given a negative test result, which is $P(D^c | T^-)$. Again, we use Bayes' theorem:\n$$P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\nFirst, we find the denominator, $P(T^-)$, using the law of total probability:\n$$P(T^-) = P(T^- | D) P(D) + P(T^- | D^c) P(D^c)$$\nSubstituting the values:\n$$P(T^-) = (0.15)(0.02) + (0.97)(0.98) = 0.003 + 0.9506 = 0.9536$$\n(As a consistency check, note that $P(T^+) + P(T^-) = 0.0464 + 0.9536 = 1.0000$, as expected.)\nNow we compute the NPV:\n$$P(D^c | T^-) = \\frac{(0.97)(0.98)}{0.9536} = \\frac{0.9506}{0.9536} \\approx 0.9968540...$$\nRounding to four significant figures, the NPV is $0.9969$.\n\n**3. Posterior Probability of Infection After Two Positive Tests**\n\nLet $T_1^+$ and $T_2^+$ be the events of the first and second tests being positive, respectively. We want to find the posterior probability $P(D | T_1^+ \\cap T_2^+)$. Using Bayes' theorem:\n$$P(D | T_1^+ \\cap T_2^+) = \\frac{P(T_1^+ \\cap T_2^+ | D) P(D)}{P(T_1^+ \\cap T_2^+)}$$\nThe problem states that the tests are independent conditional on the true disease status. Therefore:\n$$P(T_1^+ \\cap T_2^+ | D) = P(T_1^+ | D) \\times P(T_2^+ | D) = (0.85) \\times (0.85) = (0.85)^2 = 0.7225$$\nAnd similarly for the non-diseased state:\n$$P(T_1^+ \\cap T_2^+ | D^c) = P(T_1^+ | D^c) \\times P(T_2^+ | D^c) = (0.03) \\times (0.03) = (0.03)^2 = 0.0009$$\nNext, we find the denominator, $P(T_1^+ \\cap T_2^+)$, using the law of total probability:\n$$P(T_1^+ \\cap T_2^+) = P(T_1^+ \\cap T_2^+ | D) P(D) + P(T_1^+ \\cap T_2^+ | D^c) P(D^c)$$\nSubstituting the calculated values:\n$$P(T_1^+ \\cap T_2^+) = (0.7225)(0.02) + (0.0009)(0.98) = 0.01445 + 0.000882 = 0.015332$$\nFinally, we compute the desired posterior probability:\n$$P(D | T_1^+ \\cap T_2^+) = \\frac{(0.7225)(0.02)}{0.015332} = \\frac{0.01445}{0.015332} \\approx 0.9424732...$$\nRounding to four significant figures, the posterior probability is $0.9425$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3664 & 0.9969 & 0.9425 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "During an epidemic, a crucial question for public health officials is whether transmission is accelerating or declining. The time-varying reproduction number, $R_t$, provides a quantitative answer by estimating the average number of secondary infections caused by a single infected individual at time $t$. This advanced practice  moves from static metrics to dynamic modeling, tasking you with implementing a method based on the renewal equation to estimate $R_t$ from daily case counts. Mastering this skill bridges the gap between raw surveillance data and actionable intelligence for pandemic preparedness.",
            "id": "4977785",
            "problem": "You are tasked with designing and implementing a program that estimates the instantaneous time-varying reproduction number $R_t$ from discrete daily incidence counts $I_t$ using the renewal equation and a principled statistical model. The goal is to demonstrate, from first principles, how to compute a posterior mean estimate of $R_t$ given surveillance data and a specified generation time distribution. The context is disease transmission modeling for public health surveillance, outbreak investigation, and pandemic preparedness.\n\nBase assumptions and definitions must be used to derive the estimation procedure. At minimum, use the following foundations:\n- The renewal equation describes transmission: for each day $t$, new cases are generated as a weighted sum of prior cases scaled by $R_t$. Define the total infectiousness on day $t$ as\n$$\\Lambda_t = \\sum_{\\tau=1}^{W} I_{t-\\tau} \\, w_{\\tau},$$\nwhere $w_{\\tau}$ is the discrete generation time distribution for lags $\\tau \\in \\{1,\\dots,W\\}$ and satisfies $\\sum_{\\tau=1}^{W} w_{\\tau} = 1$, and $I_{t-\\tau} = 0$ whenever $t-\\tau < 0$. The renewal equation implies\n$$I_t \\approx R_t \\, \\Lambda_t.$$\n- Incidence counts are modeled as conditionally Poisson given the renewal process: for day $t$, \n$$I_t \\mid R_t, \\Lambda_t \\sim \\text{Poisson}(R_t \\Lambda_t).$$\n- To stabilize estimation, use a sliding window of length $L$ days up to a target day $t^\\star$ to aggregate information. Use a Gamma prior $\\text{Gamma}(a_0,b_0)$ on $R_t$ with shape $a_0$ and rate $b_0$ (rate parameterization).\n\nYou must implement a method that, for each test case specified below, computes the posterior mean estimate of $R_t$ for the last day in the incidence series, using a window of length $L$ that is truncated to the available data near the beginning. Formally, for the final index $t^\\star = T-1$ (where $T$ is the length of the incidence series), define the window start $s_0 = \\max(0, t^\\star - L + 1)$, and use the observed incidence $\\{I_s\\}_{s=s_0}^{t^\\star}$ and infectiousness $\\{\\Lambda_s\\}_{s=s_0}^{t^\\star}$ to compute your estimate. If $\\sum_{s=s_0}^{t^\\star} \\Lambda_s = 0$, your method must default to the prior-driven value implied by the model and provide a finite estimate.\n\nYour program must produce, for each test case, the posterior mean estimate of $R_{t^\\star}$ rounded to $4$ decimal places, with no physical units attached. The final output should be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, for example, \"[$0.9876$, $1.2345$, $0.5432$]\".\n\nTest suite. For each case below, $I_t$ is a list of daily counts and $w_{\\tau}$ is a list representing the discrete generation time distribution for $\\tau \\in \\{1,\\dots,W\\}$ with $w_0 = 0$ implicitly. Use the same prior and window parameters $a_0$, $b_0$, and $L$ for all tests, as specified at the end.\n\n- Case $1$ (general case, moderate growth with mild noise):\n    - Incidence $I$: [$5$, $6$, $6$, $7$, $7$, $8$, $8$, $9$, $9$, $9$, $10$, $10$, $10$, $10$].\n    - Generation time weights $w$: [$0.25$, $0.35$, $0.20$, $0.10$, $0.06$, $0.04$].\n\n- Case $2$ (step change from higher transmission to lower transmission):\n    - Incidence $I$: [$3$, $4$, $5$, $6$, $7$, $9$, $10$, $8$, $7$, $6$, $5$, $4$, $4$, $3$, $3$].\n    - Generation time weights $w$: [$0.25$, $0.35$, $0.20$, $0.10$, $0.06$, $0.04$].\n\n- Case $3$ (edge case with initial zeros and a heavy-tailed generation time):\n    - Incidence $I$: [$0$, $0$, $0$, $3$, $5$, $7$, $6$, $5$, $4$, $3$, $2$].\n    - Generation time weights $w$: [$0.05$, $0.15$, $0.20$, $0.20$, $0.15$, $0.10$, $0.08$, $0.07$].\n\n- Case $4$ (boundary case with a short incidence series and short generation time):\n    - Incidence $I$: [$2$, $2$, $3$, $3$, $4$].\n    - Generation time weights $w$: [$0.50$, $0.30$, $0.20$].\n\nGlobal parameters for all cases:\n- Prior shape $a_0 = 1.0$.\n- Prior rate $b_0 = 1.0$.\n- Window length $L = 7$.\n\nYour program should produce a single line of output containing the posterior mean estimates as a comma-separated list enclosed in square brackets. The list must contain exactly $4$ floats in the order of the cases above, each value rounded to $4$ decimal places, and must not include any extra text. For example: \"[$x_1$, $x_2$, $x_3$, $x_4$]\".",
            "solution": "The problem requires the design and implementation of a method to compute the posterior mean estimate of the time-varying reproduction number, $R_t$, from daily incidence data, $I_t$. The solution is grounded in a Bayesian statistical framework, combining a prior belief about $R_t$ with the likelihood of observed data under a generative model of transmission.\n\nThe core of the transmission model is the renewal equation. The total infectiousness, $\\Lambda_t$, on a given day $t$ is the sum of infectious contributions from all previously infected individuals, weighted by the generation time distribution, $w_{\\tau}$. This is formally expressed as:\n$$\n\\Lambda_t = \\sum_{\\tau=1}^{W} I_{t-\\tau} \\, w_{\\tau}\n$$\nwhere $W$ is the maximum duration of the generation interval and $w_{\\tau}$ is the probability that a secondary case is generated $\\tau$ days after the primary case becomes infected. The series $w_{\\tau}$ is a discrete probability distribution, so $\\sum_{\\tau=1}^{W} w_{\\tau} = 1$. By definition, any incidence $I_{t-\\tau}$ is considered to be $0$ if its index $t-\\tau$ is less than $0$.\n\nThe expected number of new cases on day $t$ is given by the product of the reproduction number $R_t$ and the total infectiousness $\\Lambda_t$. The problem models the observed daily incidence counts, $I_t$, as random variables drawn from a Poisson distribution with this expected value:\n$$\nI_t \\mid R_t, \\Lambda_t \\sim \\text{Poisson}(R_t \\Lambda_t)\n$$\n\nTo estimate $R_t$, we employ Bayesian inference. The estimation is performed over a sliding window of length $L$ ending on the target day $t^\\star$. A key assumption for this method is that the reproduction number is constant within this window, i.e., $R_s = R$ for all $s$ in the window $[s_0, t^\\star]$, where $s_0 = \\max(0, t^\\star - L + 1)$.\n\nThe components of the Bayesian model are as follows:\n\n1.  **Prior Distribution**: We assume a prior belief about the value of $R$, modeled by a Gamma distribution. The Gamma distribution is chosen for its support on the positive real numbers, which is appropriate for $R$, and for its conjugacy with the Poisson likelihood, which simplifies the posterior calculation. The prior is given by:\n    $$\n    p(R) = \\text{Gamma}(R \\mid a_0, b_0) = \\frac{b_0^{a_0}}{\\Gamma(a_0)} R^{a_0-1} e^{-b_0 R}\n    $$\n    where $a_0$ is the shape parameter and $b_0$ is the rate parameter.\n\n2.  **Likelihood Function**: The likelihood of observing the incidence data $\\{I_s\\}_{s=s_0}^{t^\\star}$ within the window, given a constant reproduction number $R$, is the product of the individual Poisson probabilities. Assuming the counts $I_s$ are conditionally independent given $R$ and the respective $\\Lambda_s$:\n    $$\n    L(\\{I_s\\}_{s=s_0}^{t^\\star} \\mid R) = \\prod_{s=s_0}^{t^\\star} P(I_s \\mid R, \\Lambda_s) = \\prod_{s=s_0}^{t^\\star} \\frac{(R \\Lambda_s)^{I_s} e^{-R \\Lambda_s}}{I_s!}\n    $$\n\n3.  **Posterior Distribution**: According to Bayes' theorem, the posterior distribution of $R$ is proportional to the product of the prior and the likelihood:\n    $$\n    p(R \\mid \\{I_s\\}_{s=s_0}^{t^\\star}) \\propto p(R) \\cdot L(\\{I_s\\}_{s=s_0}^{t^\\star} \\mid R)\n    $$\n    Substituting the expressions for the prior and likelihood, and dropping terms not dependent on $R$:\n    $$\n    p(R \\mid \\{I_s\\}) \\propto \\left( R^{a_0-1} e^{-b_0 R} \\right) \\cdot \\left( \\prod_{s=s_0}^{t^\\star} (R \\Lambda_s)^{I_s} e^{-R \\Lambda_s} \\right)\n    $$\n    We can simplify the product term:\n    $$\n    \\prod_{s=s_0}^{t^\\star} (R \\Lambda_s)^{I_s} e^{-R \\Lambda_s} = \\left( \\prod_{s=s_0}^{t^\\star} \\Lambda_s^{I_s} \\right) \\left( \\prod_{s=s_0}^{t^\\star} R^{I_s} \\right) \\left( \\prod_{s=s_0}^{t^\\star} e^{-R \\Lambda_s} \\right)\n    $$\n    $$\n    \\propto R^{\\sum_{s=s_0}^{t^\\star} I_s} \\cdot e^{-R \\sum_{s=s_0}^{t^\\star} \\Lambda_s}\n    $$\n    Combining this with the prior:\n    $$\n    p(R \\mid \\{I_s\\}) \\propto R^{a_0-1} e^{-b_0 R} \\cdot R^{\\sum_{s=s_0}^{t^\\star} I_s} \\cdot e^{-R \\sum_{s=s_0}^{t^\\star} \\Lambda_s}\n    $$\n    $$\n    p(R \\mid \\{I_s\\}) \\propto R^{\\left(a_0 + \\sum_{s=s_0}^{t^\\star} I_s\\right) - 1} \\cdot e^{-\\left(b_0 + \\sum_{s=s_0}^{t^\\star} \\Lambda_s\\right) R}\n    $$\n    This expression is the kernel of a Gamma distribution. Therefore, the posterior distribution for $R$ is:\n    $$\n    R \\mid \\{I_s\\}_{s=s_0}^{t^\\star} \\sim \\text{Gamma}(a', b')\n    $$\n    with posterior shape parameter $a'$ and posterior rate parameter $b'$ given by:\n    $$\n    a' = a_0 + \\sum_{s=s_0}^{t^\\star} I_s\n    $$\n    $$\n    b' = b_0 + \\sum_{s=s_0}^{t^\\star} \\Lambda_s\n    $$\n\nThe problem asks for the posterior mean estimate of $R$. For a Gamma distribution with shape $\\alpha$ and rate $\\beta$, the mean is $\\alpha / \\beta$. Thus, the posterior mean estimate of $R$ for the window ending at $t^\\star$ is:\n$$\n\\mathbb{E}[R \\mid \\{I_s\\}_{s=s_0}^{t^\\star}] = \\frac{a'}{b'} = \\frac{a_0 + \\sum_{s=s_0}^{t^\\star} I_s}{b_0 + \\sum_{s=s_0}^{t^\\star} \\Lambda_s}\n$$\nThis formula is robust, even for the edge case where no transmission has occurred prior to the window (i.e., $\\sum_{s=s_0}^{t^\\star} \\Lambda_s = 0$). In that scenario, the incidence counts $I_s$ within the window must also be zero for the model to be consistent, leading to an estimate of $\\frac{a_0+0}{b_0+0} = \\frac{a_0}{b_0}$, which is the mean of the prior distribution, as coherence demands. The implementation will compute this quantity for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes posterior mean estimates of R_t for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            np.array([5, 6, 6, 7, 7, 8, 8, 9, 9, 9, 10, 10, 10, 10], dtype=float),\n            np.array([0.25, 0.35, 0.20, 0.10, 0.06, 0.04], dtype=float)\n        ),\n        # Case 2\n        (\n            np.array([3, 4, 5, 6, 7, 9, 10, 8, 7, 6, 5, 4, 4, 3, 3], dtype=float),\n            np.array([0.25, 0.35, 0.20, 0.10, 0.06, 0.04], dtype=float)\n        ),\n        # Case 3\n        (\n            np.array([0, 0, 0, 3, 5, 7, 6, 5, 4, 3, 2], dtype=float),\n            np.array([0.05, 0.15, 0.20, 0.20, 0.15, 0.10, 0.08, 0.07], dtype=float)\n        ),\n        # Case 4\n        (\n            np.array([2, 2, 3, 3, 4], dtype=float),\n            np.array([0.50, 0.30, 0.20], dtype=float)\n        )\n    ]\n\n    # Global parameters for all cases\n    a0 = 1.0\n    b0 = 1.0\n    L = 7\n\n    results = []\n    \n    for I, w in test_cases:\n        T = len(I)\n        W = len(w)\n        \n        # Calculate total infectiousness Lambda_t for all t\n        Lambda = np.zeros(T)\n        for t in range(T):\n            for tau in range(1, W + 1):\n                if t - tau >= 0:\n                    Lambda[t] += I[t - tau] * w[tau - 1]\n        \n        # Define the estimation window for the last day\n        t_star = T - 1\n        s0 = max(0, t_star - L + 1)\n        \n        # Sum incidence and infectiousness over the window [s0, t_star]\n        I_sum_window = np.sum(I[s0:t_star + 1])\n        Lambda_sum_window = np.sum(Lambda[s0:t_star + 1])\n        \n        # Calculate posterior parameters for the Gamma distribution\n        a_posterior = a0 + I_sum_window\n        b_posterior = b0 + Lambda_sum_window\n        \n        # Calculate the posterior mean estimate for R\n        # This defaults to a0/b0 if Lambda_sum_window and I_sum_window are 0\n        R_estimate = a_posterior / b_posterior\n        \n        results.append(R_estimate)\n\n    # Format the final output string with results rounded to 4 decimal places\n    # The f-string format '{:.4f}' ensures four decimal places are always shown\n    formatted_results = [f'{r:.4f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}