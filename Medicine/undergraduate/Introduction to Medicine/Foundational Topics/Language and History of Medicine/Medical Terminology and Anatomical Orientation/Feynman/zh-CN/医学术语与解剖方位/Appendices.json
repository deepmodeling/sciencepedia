{
    "hands_on_practices": [
        {
            "introduction": "医学影像（如MRI和CT）的精确性依赖于明确的坐标系，这意味着描述性的解剖术语必须能被精确地转换为数学语言。本练习旨在将基本的解剖方向（如前、上、左）映射为标准坐标系中的向量，并进一步通过向量加法构建复合方向。掌握这项技能是解读医学影像、理解人体空间关系定量描述的基础。",
            "id": "4969445",
            "problem": "一个医学影像数据集使用右-前-上 (RAS) 坐标约定，其中 $x$ 轴指向患者的右侧 ($\\hat{R}$)，$y$ 轴指向患者的前方 ($\\hat{A}$)，$z$ 轴指向患者的上方 ($\\hat{S}$)。假设这些轴构成一个标准正交基。在解剖学术语中，“左侧”对应于患者右侧的相反方向。\n\n从标准正交基和标准解剖方向术语的核心定义出发，将“前”、“上”和“左”映射到它们在 RAS 基中的相应单位方向。然后，利用复合方向形容词（例如，“前上外侧”）表示每个所含方向的贡献相等且未命名方向无贡献的原则，构建代表“前上外侧”方向的向量，并将其归一化为单位长度。\n\n以单个行向量 $$\\begin{pmatrix} R  A  S \\end{pmatrix}$$ 的形式给出您的最终答案，给出沿 $\\hat{R}$、$\\hat{A}$ 和 $\\hat{S}$ 的分量，使用精确形式。不要四舍五入。",
            "solution": "该问题要求在右-前-上 (RAS) 坐标系内构建一个代表“前上外侧”方向的归一化向量。对问题陈述的验证证实了其科学性、适定性和客观性，从而可以进行严谨的求解。\n\n首先，我们建立由 RAS 坐标系定义的标准正交基向量的数学表示。设 $\\hat{R}$、$\\hat{A}$ 和 $\\hat{S}$ 分别是对应于右、前、上方向的单位向量。我们可以将它们与标准笛卡尔基向量 $\\hat{i}$、$\\hat{j}$ 和 $\\hat{k}$ 相关联：\n$$\n\\hat{R} \\equiv \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\hat{A} \\equiv \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\hat{S} \\equiv \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n如问题所述，这些向量构成一个标准正交集：$\\hat{R} \\cdot \\hat{A} = 0$，$\\hat{R} \\cdot \\hat{S} = 0$，$\\hat{A} \\cdot \\hat{S} = 0$，且 $|\\hat{R}| = |\\hat{A}| = |\\hat{S}| = 1$。\n\n接下来，我们将指定的解剖学术语映射到此基中的相应单位向量。\n1.  **前 (Anterior)**：问题指出 $y$ 轴指向患者的前方。因此，前方向的单位向量为 $\\vec{v}_{\\text{anterior}} = \\hat{A}$。\n    $$\n    \\vec{v}_{\\text{anterior}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n    $$\n2.  **上 (Superior)**：问题指出 $z$ 轴指向患者的上方。因此，上方向的单位向量为 $\\vec{v}_{\\text{superior}} = \\hat{S}$。\n    $$\n    \\vec{v}_{\\text{superior}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n    $$\n3.  **左 (Left)**：问题将“左侧”定义为与患者右侧相反的方向。右方向由 $\\hat{R}$ 给出。因此相反方向是 $-\\hat{R}$。左方向的单位向量为 $\\vec{v}_{\\text{left}} = -\\hat{R}$。\n    $$\n    \\vec{v}_{\\text{left}} = -\\hat{R} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n\n问题要求表示“前上外侧”方向的向量。这是一个由“前”、“上”和“外侧”组成的复合词。在标准解剖学术语中，“外侧”表示远离身体中线的方向。在 RAS 系统的背景下，这对应于由 $\\hat{R}$ 向量（内外侧轴）定义的轴。方向可以是右或左。鉴于问题明确要求映射术语“左”而不是“右”（“右”是主基向量），在问题自身的框架内，最合乎逻辑且一致的解释是，这个复合词中的“外侧”指的是“左”方向。\n\n我们现在构建“前上外侧”方向的未归一化向量，记为 $\\vec{V}$。问题指出，复合方向中每个包含的方向贡献相等。这意味着 $\\vec{V}$ 是构成方向（前、上、左）的单位向量的向量和。\n$$\n\\vec{V} = \\vec{v}_{\\text{anterior}} + \\vec{v}_{\\text{superior}} + \\vec{v}_{\\text{left}}\n$$\n代入这些向量的分量形式：\n$$\n\\vec{V} = \\hat{A} + \\hat{S} + (-\\hat{R}) = -\\hat{R} + \\hat{A} + \\hat{S}\n$$\n$$\n\\vec{V} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n该向量 $\\vec{V}$ 在 $(\\hat{R}, \\hat{A}, \\hat{S})$ 基中的分量为 $(-1, 1, 1)$。\n\n最后，我们必须将此向量归一化为单位长度。$\\vec{V}$ 的模由欧几里得范数给出：\n$$\n|\\vec{V}| = \\sqrt{(-1)^2 + 1^2 + 1^2} = \\sqrt{1 + 1 + 1} = \\sqrt{3}\n$$\n归一化单位向量 $\\hat{u}$ 通过将 $\\vec{V}$ 除以其模 $|\\vec{V}|$ 得到：\n$$\n\\hat{u} = \\frac{\\vec{V}}{|\\vec{V}|} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\end{pmatrix}\n$$\n为了便于常规表示，我们将分母有理化：\n$$\n\\hat{u} = \\begin{pmatrix} -\\frac{\\sqrt{3}}{3} \\\\ \\frac{\\sqrt{3}}{3} \\\\ \\frac{\\sqrt{3}}{3} \\end{pmatrix}\n$$\n此向量在 RAS 基中表示为“前上外侧”方向的单位向量。沿 $\\hat{R}$、$\\hat{A}$ 和 $\\hat{S}$ 轴的分量分别为 $-\\frac{\\sqrt{3}}{3}$、$\\frac{\\sqrt{3}}{3}$ 和 $\\frac{\\sqrt{3}}{3}$。最终答案按要求以行向量形式表示。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\sqrt{3}}{3}  \\frac{\\sqrt{3}}{3}  \\frac{\\sqrt{3}}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "患者的位置（例如，解剖学姿势、仰卧位、俯卧位）会从根本上改变其身体相对于外部世界或成像设备的方位。本练习超越了静态方向的描述，利用刚体旋转的数学原理来模拟姿势的动态变化，你将使用特殊正交群 $SO(3)$ 中的旋转矩阵来形式化地描述这些常见临床位置之间的转换。这种严谨的方法在放射治疗和外科导航等要求高精度的领域至关重要，它揭示了看似简单的位置变化背后坚实的数学基础。",
            "id": "4969460",
            "problem": "在医学影像实验室内，患者的方位采用右-前-上 (RAS) 约定进行编码，其中基于患者的标准正交基向量分别表示为 $\\hat{\\mathbf{r}}$ (右)、$\\hat{\\mathbf{a}}$ (前) 和 $\\hat{\\mathbf{s}}$ (上)。考虑一个固定的实验室（世界）坐标系，其标准正交基向量为 $\\hat{\\mathbf{x}}_{w}$ (东)、$\\hat{\\mathbf{y}}_{w}$ (北) 和 $\\hat{\\mathbf{z}}_{w}$ (上)。在标准解剖位置下，患者面向 $\\hat{\\mathbf{y}}_{w}$，右侧指向 $\\hat{\\mathbf{x}}_{w}$，头部（上）指向 $\\hat{\\mathbf{z}}_{w}$，因此 $\\hat{\\mathbf{r}}=\\hat{\\mathbf{x}}_{w}$、$\\hat{\\mathbf{a}}=\\hat{\\mathbf{y}}_{w}$ 和 $\\hat{\\mathbf{s}}=\\hat{\\mathbf{z}}_{w}$ 的等同关系成立。临床仰卧位定义为背部着床、面部朝上；临床俯卧位定义为腹部着床、面部朝下。假设患者通过三维空间中的刚体旋转在这些位置之间转换，该旋转由一个旋转矩阵 $R \\in SO(3)$ 建模，其中 $SO(3)$ 是旋转的特殊正交群。使用关于患者右轴 $\\hat{\\mathbf{r}}$ 的右手定则来确定旋转方向，并将所有角度用弧度表示。\n\n仅从解剖位置、仰卧位和俯卧位的核心定义，以及 $SO(3)$ 中刚体旋转的标准属性出发，执行以下推理：\n- 通过确定每次旋转后 $\\hat{\\mathbf{r}}$、$\\hat{\\mathbf{a}}$ 和 $\\hat{\\mathbf{s}}$ 如何与 $\\hat{\\mathbf{x}}_{w}$、$\\hat{\\mathbf{y}}_{w}$ 和 $\\hat{\\mathbf{z}}_{w}$ 对齐，来确定从解剖位置转换到仰卧位以及从解剖位置转换到俯卧位时，RAS基向量相对于世界坐标系的符号变化。\n- 在世界坐标系中构建显式的旋转矩阵 $R_{\\text{supine}}$ 和 $R_{\\text{prone}}$，以实现这些分别绕 $\\hat{\\mathbf{r}}$ 轴旋转角度 $\\theta_{\\text{supine}}$ 和 $\\theta_{\\text{prone}}$ 的转换。\n- 计算将仰卧位映射到俯卧位的净旋转 $R_{\\text{net}}=R_{\\text{prone}}\\,R_{\\text{supine}}^{-1}$。\n- 根据 $R_{\\text{net}}$，计算其迹 $\\operatorname{tr}(R_{\\text{net}})$。\n\n你的最终答案必须是等于 $\\operatorname{tr}(R_{\\text{net}})$ 的单个实数值。不需要四舍五入。在最终的方框答案中不要标明单位。",
            "solution": "首先验证问题，以确保其是自洽的、有科学依据且适定的。\n\n### 第1步：提取已知条件\n- 患者坐标系：右-前-上 (RAS)，标准正交基向量为 $\\hat{\\mathbf{r}}$、$\\hat{\\mathbf{a}}$、$\\hat{\\mathbf{s}}$。这是一个右手系，因此 $\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{a}} = \\hat{\\mathbf{s}}$。\n- 世界坐标系：固定的实验室坐标系，标准正交基向量为 $\\hat{\\mathbf{x}}_{w}$ (东)、$\\hat{\\mathbf{y}}_{w}$ (北) 和 $\\hat{\\mathbf{z}}_{w}$ (上)。这是一个右手系，$\\hat{\\mathbf{x}}_{w} \\times \\hat{\\mathbf{y}}_{w} = \\hat{\\mathbf{z}}_{w}$。\n- 解剖位置：患者坐标系与世界坐标系对齐：$\\hat{\\mathbf{r}}=\\hat{\\mathbf{x}}_{w}$、$\\hat{\\mathbf{a}}=\\hat{\\mathbf{y}}_{w}$、$\\hat{\\mathbf{s}}=\\hat{\\mathbf{z}}_{w}$。\n- 临床仰卧位：患者背部着床、面部朝上。\n- 临床俯卧位：患者腹部着床、面部朝下。\n- 转换是绕患者右轴 $\\hat{\\mathbf{r}}$ 的刚体旋转 $R \\in SO(3)$。\n- 使用右手定则确定旋转方向。角度以弧度为单位。\n\n### 第2步：使用提取的已知条件进行验证\n问题是适定的。它使用了医学影像学（RAS、仰卧、俯卧）的标准术语以及线性代数和运动学（旋转矩阵、$SO(3)$、坐标系）的既定原理。对仰卧和俯卧位置的物理描述，结合旋转是绕患者 $\\hat{\\mathbf{r}}$ 轴发生的约束，使得可以进行无歧义的数学解释。该问题具有科学合理性、客观性，并包含足够的信息来推导出唯一解。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n令世界坐标系的基向量由 $\\mathbb{R}^3$ 中的标准基表示：$\\hat{\\mathbf{x}}_{w} = (1, 0, 0)^T$，$\\hat{\\mathbf{y}}_{w} = (0, 1, 0)^T$，以及 $\\hat{\\mathbf{z}}_{w} = (0, 0, 1)^T$。\n\n在标准解剖位置下，患者的RAS基向量与世界坐标系对齐：\n$\\hat{\\mathbf{r}}_{\\text{anat}} = \\hat{\\mathbf{x}}_{w} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$\\hat{\\mathbf{a}}_{\\text{anat}} = \\hat{\\mathbf{y}}_{w} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n$\\hat{\\mathbf{s}}_{\\text{anat}} = \\hat{\\mathbf{z}}_{w} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n\n向仰卧位和俯卧位的转换是从这个解剖位置开始，绕患者的右轴 $\\hat{\\mathbf{r}}$ 旋转。在解剖位置，该轴为 $\\hat{\\mathbf{r}}_{\\text{anat}} = \\hat{\\mathbf{x}}_{w}$。绕 $\\hat{\\mathbf{x}}_{w}$ 轴旋转角度 $\\theta$ 的旋转由以下矩阵给出：\n$$R_x(\\theta) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\theta  -\\sin\\theta \\\\ 0  \\sin\\theta  \\cos\\theta \\end{pmatrix}$$\n该矩阵作用于初始（解剖）基向量，以生成旋转后位置的新基向量。\n\n**1. 确定方位和旋转矩阵**\n\n**仰卧位：**\n患者“背部着床、面部朝上”。在解剖位置，前方向 ($\\hat{\\mathbf{a}}_{\\text{anat}}$) 是北 ($\\hat{\\mathbf{y}}_{w}$)，上方向 ($\\hat{\\mathbf{s}}_{\\text{anat}}$) 是上 ($\\hat{\\mathbf{z}}_{w}$)。要通过绕东西向 ($\\hat{\\mathbf{r}}$) 轴旋转变为仰卧位，患者向后倾斜。前方向（“面部”）从指北旋转到指上。\n因此，新的前向向量 $\\hat{\\mathbf{a}}_{\\text{sup}}$ 必须与世界坐标系的“上”向量 $\\hat{\\mathbf{z}}_{w}$ 对齐。\n设旋转为 $R_{\\text{supine}} = R_x(\\theta_{\\text{supine}})$。新的前向向量由 $\\hat{\\mathbf{a}}_{\\text{sup}} = R_{\\text{supine}}\\hat{\\mathbf{a}}_{\\text{anat}}$ 给出。\n$$\\hat{\\mathbf{a}}_{\\text{sup}} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\theta_{\\text{supine}}  -\\sin\\theta_{\\text{supine}} \\\\ 0  \\sin\\theta_{\\text{supine}}  \\cos\\theta_{\\text{supine}} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\cos\\theta_{\\text{supine}} \\\\ \\sin\\theta_{\\text{supine}} \\end{pmatrix}$$\n我们需要 $\\hat{\\mathbf{a}}_{\\text{sup}} = \\hat{\\mathbf{z}}_{w} = (0, 0, 1)^T$。这意味着 $\\cos\\theta_{\\text{supine}} = 0$ 且 $\\sin\\theta_{\\text{supine}} = 1$。主角度为 $\\theta_{\\text{supine}} = \\frac{\\pi}{2}$ 弧度。这对应于绕 $\\hat{\\mathbf{x}}_{w}$ 轴逆时针旋转 $90^\\circ$。\n\n仰卧位转换的旋转矩阵是：\n$$R_{\\text{supine}} = R_x\\left(\\frac{\\pi}{2}\\right) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(\\frac{\\pi}{2})  -\\sin(\\frac{\\pi}{2}) \\\\ 0  \\sin(\\frac{\\pi}{2})  \\cos(\\frac{\\pi}{2}) \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  0  -1 \\\\ 0  1  0 \\end{pmatrix}$$\n仰卧位下的RAS向量是：\n- $\\hat{\\mathbf{r}}_{\\text{sup}} = R_{\\text{supine}}\\hat{\\mathbf{r}}_{\\text{anat}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\hat{\\mathbf{x}}_{w}$\n- $\\hat{\\mathbf{a}}_{\\text{sup}} = R_{\\text{supine}}\\hat{\\mathbf{a}}_{\\text{anat}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\hat{\\mathbf{z}}_{w}$\n- $\\hat{\\mathbf{s}}_{\\text{sup}} = R_{\\text{supine}}\\hat{\\mathbf{s}}_{\\text{anat}} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix} = -\\hat{\\mathbf{y}}_{w}$\n\n_从解剖位到仰卧位的对齐关系_：$\\hat{\\mathbf{r}}$ 不变，$\\hat{\\mathbf{a}}$ 从 $\\hat{\\mathbf{y}}_{w}$ 映射到 $\\hat{\\mathbf{z}}_{w}$，$\\hat{\\mathbf{s}}$ 从 $\\hat{\\mathbf{z}}_{w}$ 映射到 $-\\hat{\\mathbf{y}}_{w}$。\n\n**俯卧位：**\n患者“腹部着床、面部朝下”。前方向（“腹部”或“面部”）现在指向下方。世界坐标系的“下”方向是 $-\\hat{\\mathbf{z}}_{w}$。\n新的前向向量 $\\hat{\\mathbf{a}}_{\\text{pro}}$ 必须与 $-\\hat{\\mathbf{z}}_{w}$ 对齐。\n设旋转为 $R_{\\text{prone}} = R_x(\\theta_{\\text{prone}})$。\n$$\\hat{\\mathbf{a}}_{\\text{pro}} = R_x(\\theta_{\\text{prone}})\\hat{\\mathbf{a}}_{\\text{anat}} = \\begin{pmatrix} 0 \\\\ \\cos\\theta_{\\text{prone}} \\\\ \\sin\\theta_{\\text{prone}} \\end{pmatrix}$$\n我们需要 $\\hat{\\mathbf{a}}_{\\text{pro}} = -\\hat{\\mathbf{z}}_{w} = (0, 0, -1)^T$。这意味着 $\\cos\\theta_{\\text{prone}} = 0$ 且 $\\sin\\theta_{\\text{prone}} = -1$。主角度为 $\\theta_{\\text{prone}} = -\\frac{\\pi}{2}$ 弧度。这对应于绕 $\\hat{\\mathbf{x}}_{w}$ 轴顺时针旋转 $90^\\circ$。\n\n俯卧位转换的旋转矩阵是：\n$$R_{\\text{prone}} = R_x\\left(-\\frac{\\pi}{2}\\right) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(-\\frac{\\pi}{2})  -\\sin(-\\frac{\\pi}{2}) \\\\ 0  \\sin(-\\frac{\\pi}{2})  \\cos(-\\frac{\\pi}{2}) \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{pmatrix}$$\n俯卧位下的RAS向量是：\n- $\\hat{\\mathbf{r}}_{\\text{pro}} = R_{\\text{prone}}\\hat{\\mathbf{r}}_{\\text{anat}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\hat{\\mathbf{x}}_{w}$\n- $\\hat{\\mathbf{a}}_{\\text{pro}} = R_{\\text{prone}}\\hat{\\mathbf{a}}_{\\text{anat}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix} = -\\hat{\\mathbf{z}}_{w}$\n- $\\hat{\\mathbf{s}}_{\\text{pro}} = R_{\\text{prone}}\\hat{\\mathbf{s}}_{\\text{anat}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\hat{\\mathbf{y}}_{w}$\n\n_从解剖位到俯卧位的对齐关系_：$\\hat{\\mathbf{r}}$ 不变，$\\hat{\\mathbf{a}}$ 从 $\\hat{\\mathbf{y}}_{w}$ 映射到 $-\\hat{\\mathbf{z}}_{w}$，$\\hat{\\mathbf{s}}$ 从 $\\hat{\\mathbf{z}}_{w}$ 映射到 $\\hat{\\mathbf{y}}_{w}$。\n\n**2. 计算净旋转**\n\n将仰卧位映射到俯卧位的净旋转 $R_{\\text{net}}$ 将仰卧位基向量转换为俯卧位基向量。如果 $M_{\\text{sup}}$ 和 $M_{\\text{pro}}$ 是以基向量为列的矩阵，我们有 $M_{\\text{sup}} = R_{\\text{supine}}$ 和 $M_{\\text{pro}} = R_{\\text{prone}}$（因为解剖基是单位矩阵）。该变换由 $M_{\\text{pro}} = R_{\\text{net}} M_{\\text{sup}}$ 给出。\n$$R_{\\text{prone}} = R_{\\text{net}} R_{\\text{supine}}$$\n求解 $R_{\\text{net}}$ 得 $R_{\\text{net}} = R_{\\text{prone}} R_{\\text{supine}}^{-1}$。\n对于旋转矩阵 $R \\in SO(3)$，其逆矩阵等于其转置矩阵，$R^{-1} = R^T$。\n$$R_{\\text{supine}}^{-1} = R_{\\text{supine}}^T = \\begin{pmatrix} 1  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{pmatrix}$$\n现在，我们计算乘积：\n$$R_{\\text{net}} = R_{\\text{prone}} R_{\\text{supine}}^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  0  1 \\\\ 0  -1  0 \\end{pmatrix}$$\n$$R_{\\text{net}} = \\begin{pmatrix} 1(1)+0(0)+0(0)  1(0)+0(0)+0(-1)  1(0)+0(1)+0(0) \\\\ 0(1)+0(0)+1(0)  0(0)+0(0)+1(-1)  0(0)+0(1)+1(0) \\\\ 0(1)+(-1)(0)+0(0)  0(0)+(-1)(0)+0(-1)  0(0)+(-1)(1)+0(0) \\end{pmatrix}$$\n$$R_{\\text{net}} = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix}$$\n所得矩阵对应于绕 $\\hat{\\mathbf{x}}_{w}$ 轴旋转 $\\pi$ 弧度（$180^\\circ$），这是从仰卧（向后倾斜 $\\pi/2$）到俯卧（向前倾斜 $\\pi/2$）的旋转。总旋转角度是绕 $\\hat{\\mathbf{r}}$ 轴的 $(-\\pi/2) - (\\pi/2) = -\\pi$。\n$R_x(-\\pi) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(-\\pi)  -\\sin(-\\pi) \\\\ 0  \\sin(-\\pi)  \\cos(-\\pi) \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix}$，与我们的结果相符。\n\n**3. 计算迹**\n\n方阵的迹是其主对角线上元素的总和。\n$$\\operatorname{tr}(R_{\\text{net}}) = \\operatorname{tr}\\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix} = 1 + (-1) + (-1)$$\n$$\\operatorname{tr}(R_{\\text{net}}) = 1 - 1 - 1 = -1$$\n一个三维空间中绕某轴旋转角度 $\\alpha$ 的旋转矩阵的迹由 $1 + 2\\cos\\alpha$ 给出。对于 $\\alpha = -\\pi$，迹为 $1 + 2\\cos(-\\pi) = 1 + 2(-1) = -1$，这验证了计算结果。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "现代医学越来越多地使用可穿戴传感器（如惯性测量单元IMU）来监测和诊断运动障碍，但我们如何将原始的传感器数据转化为有意义的临床诊断呢？本练习将向量代数应用于解决一个真实的生物力学问题，你将通过计算向量投影和有向角，从模拟的传感器方向数据中区分踝内翻和膝内翻等特定的关节运动。这项实践连接了理论与应用，展示了解剖方向和向量数学的抽象原理如何在临床分析和诊断的计算工具中得以实现。",
            "id": "4969424",
            "problem": "给定佩戴式惯性测量单元（IMU；Inertial Measurement Units）提供的三维方向信息，这些单元刚性地固定在受试者的右大腿、右小腿和右足上。请使用解剖学方向和向量代数的核心定义，推导并实现一套标准，仅根据在全局坐标系中测量的单位方向向量来区分踝内翻或外翻与膝内翻或外翻对线。\n\n基本基础。使用以下解剖学和数学定义作为推导的起点。解剖平面与坐标轴：全局坐标系为右手系，前后轴沿 $+\\hat{\\mathbf{x}}$ 方向（前），左右轴沿 $+\\hat{\\mathbf{y}}$ 方向（受试者左侧，对于右侧肢体为内侧），上下轴沿 $+\\hat{\\mathbf{z}}$ 方向（上）。额状面是由 $\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{z}}$ 张成的平面，与 $\\hat{\\mathbf{x}}$ 正交。踝内翻对应于足底面（法向量）向内侧方向（对于右侧肢体，朝向 $+\\hat{\\mathbf{y}}$）倾斜；外翻对应于向外侧方向（对于右侧肢体，朝向 $-\\hat{\\mathbf{y}}$）倾斜。膝内翻对应于在额状面内，小腿远端相对于大腿近端向内侧偏移（对于右侧肢体，朝向 $+\\hat{\\mathbf{y}}$）；外翻对应于向外侧偏移（对于右侧肢体，朝向 $-\\hat{\\mathbf{y}}$）。向量代数：向量 $\\mathbf{v}$ 在单位法向量为 $\\hat{\\mathbf{n}}$ 的平面上的投影为 $\\mathbf{v}_{\\perp} = \\mathbf{v} - (\\mathbf{v} \\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$。两个非零向量 $\\mathbf{a}$ 和 $\\mathbf{b}$ 之间的夹角 $\\theta$ 满足 $\\cos\\theta = \\dfrac{\\mathbf{a}\\cdot\\mathbf{b}}{\\|\\mathbf{a}\\|\\|\\mathbf{b}\\|}$，并且在已知平面内的带符号角度可以通过该平面的法向量利用标量三重积来确定方向。\n\n任务。在一个程序中推导并实现以下计算：\n\n1) 踝内翻或外翻角。设 $\\hat{\\mathbf{p}}$ 为全局坐标系中足底面的单位法向量。计算 $\\hat{\\mathbf{p}}$ 相对于 $+\\hat{\\mathbf{z}}$ 在额状面内的带符号倾斜角。首先将 $\\hat{\\mathbf{p}}$ 投影到额状面（法向量为 $+\\hat{\\mathbf{x}}$），然后计算一个绕 $+\\hat{\\mathbf{x}}$ 轴的带符号角度，当 $\\hat{\\mathbf{p}}$ 向 $+\\hat{\\mathbf{y}}$ 方向倾斜时（右侧肢体为内翻），该角度为正；当它向 $-\\hat{\\mathbf{y}}$ 方向倾斜时（外翻），该角度为负。用度数表示此角度。\n\n2) 膝内翻或外翻角。设 $\\hat{\\mathbf{z}}_{\\text{thigh}}$ 和 $\\hat{\\mathbf{z}}_{\\text{shank}}$ 分别为全局坐标系中表示大腿和小腿向上方向（长轴）的单位向量。计算从 $\\hat{\\mathbf{z}}_{\\text{thigh}}$ 到 $\\hat{\\mathbf{z}}_{\\text{shank}}$ 在额状面内的带符号角度。首先将两个向量都投影到额状面（法向量为 $+\\hat{\\mathbf{x}}$），然后确定绕 $+\\hat{\\mathbf{x}}$ 轴的带符号角度。当小腿向 $+\\hat{\\mathbf{y}}$ 方向偏移时（右侧肢体为内翻），符号为正；当它向 $-\\hat{\\mathbf{y}}$ 方向偏移时（右侧肢体为外翻），符号为负。用度数表示此角度。\n\n3) 带阈值的分类。使用一个以度为单位的额状面角度阈值 $\\tau$，对每个带符号角度 $\\theta$ 进行如下分类：如果 $|\\theta|  \\tau|$，则类别为中性，编码为 $0$；否则类别由符号决定，踝内翻或膝内翻编码为 $+1$，踝外翻或膝外翻编码为 $-1$。使用 $\\tau = 2.0$ 度。角度必须四舍五入到三位小数。\n\n输入和测试套件。你的程序必须硬编码并使用以下四个测试用例，每个用例包含全局坐标系中的三个单位向量：足底法向量 $\\hat{\\mathbf{p}}$、大腿长轴 $\\hat{\\mathbf{z}}_{\\text{thigh}}$ 和小腿长轴 $\\hat{\\mathbf{z}}_{\\text{shank}}$。这些用例旨在覆盖一个典型情况、相反的运动、仅矢状面内的运动（边缘情况）以及在分类阈值处的边界情况。所有向量均以笛卡尔三元组 $(x,y,z)$ 的形式给出。\n\n- 用例 $1$（踝内翻和膝内翻，均在额状面内）：\n  $\\hat{\\mathbf{p}} = (\\,0.0\\,,\\,0.1736481777\\,,\\,0.9848077530\\,)$, $\\hat{\\mathbf{z}}_{\\text{thigh}} = (\\,0.0\\,,\\,0.0\\,,\\,1.0\\,)$, $\\hat{\\mathbf{z}}_{\\text{shank}} = (\\,0.0\\,,\\,0.0871557427\\,,\\,0.9961946981\\,)$。\n\n- 用例 $2$（踝外翻和膝外翻，均在额状面内）：\n  $\\hat{\\mathbf{p}} = (\\,0.0\\,,\\,-0.2079116908\\,,\\,0.9781476007\\,)$, $\\hat{\\mathbf{z}}_{\\text{thigh}} = (\\,0.0\\,,\\,0.0\\,,\\,1.0\\,)$, $\\hat{\\mathbf{z}}_{\\text{shank}} = (\\,0.0\\,,\\,-0.1218693434\\,,\\,0.9925461516\\,)$。\n\n- 用例 $3$（仅矢状面内的膝屈曲和踝背屈；额状面内两者均为中性）：\n  $\\hat{\\mathbf{p}} = (\\,-0.2588190451\\,,\\,0.0\\,,\\,0.9659258263\\,)$, $\\hat{\\mathbf{z}}_{\\text{thigh}} = (\\,0.0\\,,\\,0.0\\,,\\,1.0\\,)$, $\\hat{\\mathbf{z}}_{\\text{shank}} = (\\,0.5\\,,\\,0.0\\,,\\,0.8660254038\\,)$。\n\n- 用例 $4$（踝关节和膝关节在额状面内的角度均处于阈值 $\\tau = $ $2.0$ 度的边界）：\n  $\\hat{\\mathbf{p}} = (\\,0.0\\,,\\,0.0348994967\\,,\\,0.9993908270\\,)$, $\\hat{\\mathbf{z}}_{\\text{thigh}} = (\\,0.0\\,,\\,0.0\\,,\\,1.0\\,)$, $\\hat{\\mathbf{z}}_{\\text{shank}} = (\\,0.0\\,,\\,0.0348994967\\,,\\,0.9993908270\\,)$。\n\n角度单位和四舍五入。所有角度内部必须以弧度计算，但以度数表示，并四舍五入到三位小数。分类阈值 $\\tau$ 以度为单位，分类规则对中性情况使用严格不等式 $|\\theta|  \\tau$；与 $\\tau$ 相等不属于中性。\n\n要求的最终输出格式。对于每个测试用例，输出一个包含四个条目的列表：踝关节类别代码（整数）、膝关节类别代码（整数）、带符号的踝关节角度（以度为单位，浮点数，四舍五入到三位小数）和带符号的膝关节角度（以度为单位，浮点数，四舍五入到三位小数）。将每个用例的列表聚合到一个单一列表中，并严格按照以下格式打印一行：\n[case1_list,case2_list,case3_list,case4_list]\n例如，一个有效的行看起来像 [ [a,b,c,d], [e,f,g,h], ... ]，但没有任何附加文本。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个用例的列表包含四个逗号分隔的值。",
            "solution": "问题陈述被评估为**有效**。它在科学上基于生物力学和向量代数的原理，定义和数据齐全，问题阐述清晰，并以客观、正式的语言表达。没有矛盾、歧义或不合理的假设。\n\n问题的核心是根据方向向量计算两个具有临床意义的角度——踝内翻/外翻和膝内翻/外翻，然后对这些运动进行分类。这需要系统地应用向量数学。推导过程如下。\n\n首先，我们建立用于计算指定平面内带符号角度的数学框架。问题将所有额状面计算定义为相对于全局额状面，即由 $\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{z}}$ 轴张成的平面。该平面的单位法向量是 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{x}} = (1, 0, 0)$。\n\n一个向量 $\\mathbf{v} = (v_x, v_y, v_z)$ 使用公式 $\\mathbf{v}_{\\perp} = \\mathbf{v} - (\\mathbf{v} \\cdot \\hat{\\mathbf{n}})\\hat{\\mathbf{n}}$ 投影到额状面上。当 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{x}}$ 时，该公式变为：\n$$ \\mathbf{v}_{\\perp} = (v_x, v_y, v_z) - ((v_x, v_y, v_z) \\cdot (1, 0, 0)) (1, 0, 0) $$\n$$ \\mathbf{v}_{\\perp} = (v_x, v_y, v_z) - v_x (1, 0, 0) = (0, v_y, v_z) $$\n这证实了任何向量在全局额状面上的投影是一个新向量，其分量就是原向量的 $y$ 和 $z$ 分量。\n\n在 $y-z$ 平面中，这样一个投影向量 $(0, v_y, v_z)$ 的带符号角度是从正 $\\hat{\\mathbf{z}}$ 轴开始测量的，正角度表示朝向正 $\\hat{\\mathbf{y}}$ 轴的旋转。这个角度 $\\phi$ 可以使用双参数反正切函数 $\\text{atan2}$ 计算。在一个坐标系中，如果第一个参数是“类y”坐标，第二个参数是“类x”坐标，则函数为 $\\text{atan2}(y, x)$。对于我们的 $y-z$ 平面，角度从 $z$ 轴测量，这对应于 $\\phi = \\text{atan2}(v_y, v_z)$。该函数能正确处理所有象限，并提供一个弧度值结果，通常在 $(-\\pi, \\pi]$ 范围内。\n\n**1. 踝内翻/外翻角 ($\\theta_{\\text{ankle}}$)**\n\n踝关节角被定义为足底面法向量 $\\hat{\\mathbf{p}}$ 相对于全局向上方向 $+\\hat{\\mathbf{z}}$ 在额状面内的带符号倾斜角。\n\n设足底法向量为 $\\hat{\\mathbf{p}} = (p_x, p_y, p_z)$。它在额状面上的投影产生一个在 $y-z$ 平面内分量为 $(p_y, p_z)$ 的向量。参考方向是 $\\hat{\\mathbf{z}} = (0,0,1)$，它完全位于额状面内，其分量为 $(0, 1)$。\n\n参考向量 $\\hat{\\mathbf{z}}$ 的角度是 $\\alpha_{\\text{ref}} = \\text{atan2}(0, 1) = 0$。\n投影后的足部向量的角度是 $\\alpha_{\\text{foot}} = \\text{atan2}(p_y, p_z)$。\n\n踝关节角是足部向量相对于参考方向的角度，即 $\\alpha_{\\text{foot}}$。\n$$ \\theta_{\\text{ankle}} = \\text{atan2}(p_y, p_z) $$\n如果 $p_y > 0$（向 $+\\hat{\\mathbf{y}}$ 倾斜，内侧），该角度为正，对应于内翻；如果 $p_y  0$（向 $-\\hat{\\mathbf{y}}$ 倾斜，外侧），该角度为负，对应于外翻。这与问题的符号约定相符。\n\n**2. 膝内翻/外翻角 ($\\theta_{\\text{knee}}$)**\n\n膝关节角是从大腿长轴 $\\hat{\\mathbf{z}}_{\\text{thigh}}$ 到小腿长轴 $\\hat{\\mathbf{z}}_{\\text{shank}}$ 在额状面内的带符号角度。\n\n设大腿向量为 $\\hat{\\mathbf{z}}_{\\text{thigh}} = (z_{tx}, z_{ty}, z_{tz})$，小腿向量为 $\\hat{\\mathbf{z}}_{\\text{shank}} = (z_{sx}, z_{sy}, z_{sz})$。我们将两者都投影到额状面上，分别得到 $y-z$ 分量为 $(z_{ty}, z_{tz})$ 和 $(z_{sy}, z_{sz})$ 的向量。\n\n投影后的大腿向量相对于全局 $\\hat{\\mathbf{z}}$ 轴的角度是：\n$$ \\alpha_{\\text{thigh}} = \\text{atan2}(z_{ty}, z_{tz}) $$\n投影后的小腿向量相对于全局 $\\hat{\\mathbf{z}}$ 轴的角度是：\n$$ \\alpha_{\\text{shank}} = \\text{atan2}(z_{sy}, z_{sz}) $$\n膝关节角是从大腿向量到小腿向量的角度，计算为它们各自角度的差值：\n$$ \\theta_{\\text{knee}} = \\alpha_{\\text{shank}} - \\alpha_{\\text{thigh}} $$\n结果必须被归一化到区间 $(-\\pi, \\pi]$ 内，以处理角度跨越 $\\pm\\pi$ 边界的情况，尽管这在典型的生物力学数据中不常见。这种归一化的公式是 $\\theta_{\\text{wrapped}} = (\\theta + \\pi) \\pmod{2\\pi} - \\pi$。\n符号约定为内翻（小腿向内侧偏移，朝向 $+\\hat{\\mathbf{y}}$）时为正，外翻（小腿向外侧偏移，朝向 $-\\hat{\\mathbf{y}}$）时为负，此公式能正确地产生该结果。对于完全垂直的大腿，$\\alpha_{\\text{thigh}} = 0$，膝关节角仅由小腿的方向决定。\n\n**3. 分类**\n\n每个角度 $\\theta$（以度为单位）的分类基于一个阈值 $\\tau = 2.0$ 度。指定的规则如下：\n- 如果 $|\\theta|  \\tau|$，则类别为中性，编码为 $0$。\n- 如果 $\\theta \\ge \\tau|$，类别为内翻/膝内翻，编码为 $+1$。\n- 如果 $\\theta \\le -\\tau|$，类别为外翻/膝外翻，编码为 $-1$。\n这个逻辑正确地处理了 $|\\theta| = \\tau$ 的边界情况，将其分类为非中性。\n\n所有角度都以弧度计算，然后通过乘以 $\\frac{180}{\\pi}$ 转换为度，最后四舍五入到三位小数以供输出。推导出的公式按要求直接在 Python 程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the biomechanical orientation problem for a given set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Ankle inversion and knee varus\n        {\n            \"p_vec\": (0.0, 0.1736481777, 0.9848077530),\n            \"z_thigh\": (0.0, 0.0, 1.0),\n            \"z_shank\": (0.0, 0.0871557427, 0.9961946981),\n        },\n        # Case 2: Ankle eversion and knee valgus\n        {\n            \"p_vec\": (0.0, -0.2079116908, 0.9781476007),\n            \"z_thigh\": (0.0, 0.0, 1.0),\n            \"z_shank\": (0.0, -0.1218693434, 0.9925461516),\n        },\n        # Case 3: Sagittal-plane motion only\n        {\n            \"p_vec\": (-0.2588190451, 0.0, 0.9659258263),\n            \"z_thigh\": (0.0, 0.0, 1.0),\n            \"z_shank\": (0.5, 0.0, 0.8660254038),\n        },\n        # Case 4: Boundary case at the threshold\n        {\n            \"p_vec\": (0.0, 0.0348994967, 0.9993908270),\n            \"z_thigh\": (0.0, 0.0, 1.0),\n            \"z_shank\": (0.0, 0.0348994967, 0.9993908270),\n        },\n    ]\n\n    # Classification threshold in degrees\n    tau = 2.0\n\n    def classify_angle(angle_deg, threshold):\n        \"\"\"Classifies an angle based on the given threshold.\"\"\"\n        if abs(angle_deg)  threshold:\n            return 0\n        elif angle_deg >= threshold:\n            return 1\n        else:  # angle_deg = -threshold\n            return -1\n\n    results = []\n    for case in test_cases:\n        p_vec = case[\"p_vec\"]\n        z_thigh = case[\"z_thigh\"]\n        z_shank = case[\"z_shank\"]\n\n        # 1. Ankle Inversion/Eversion Angle\n        # The projection onto the frontal plane (normal x-axis) means we only\n        # consider the y and z components. The angle is from the z-axis to the\n        # projected vector in the y-z plane.\n        # atan2(y, z) gives the angle from the positive z-axis towards the positive y-axis.\n        ankle_angle_rad = np.arctan2(p_vec[1], p_vec[2])\n        ankle_angle_deg = np.degrees(ankle_angle_rad)\n\n        # 2. Knee Varus/Valgus Angle\n        # This is the signed angle from the projected thigh vector to the projected\n        # shank vector in the frontal plane.\n        thigh_angle_rad = np.arctan2(z_thigh[1], z_thigh[2])\n        shank_angle_rad = np.arctan2(z_shank[1], z_shank[2])\n        \n        knee_angle_rad = shank_angle_rad - thigh_angle_rad\n        # Normalize the angle to the range (-pi, pi] in case of wrapping around\n        knee_angle_rad = (knee_angle_rad + np.pi) % (2 * np.pi) - np.pi\n        knee_angle_deg = np.degrees(knee_angle_rad)\n\n        # 3. Classification\n        ankle_class = classify_angle(ankle_angle_deg, tau)\n        knee_class = classify_angle(knee_angle_deg, tau)\n\n        # Round angles to three decimal places for output\n        rounded_ankle_angle = round(ankle_angle_deg, 3)\n        rounded_knee_angle = round(knee_angle_deg, 3)\n\n        results.append([\n            ankle_class,\n            knee_class,\n            rounded_ankle_angle,\n            rounded_knee_angle\n        ])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    # Using map(str,...) and join generates a string representation.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}