{
    "hands_on_practices": [
        {
            "introduction": "这项练习通过检验静力平衡近似的局限性，探讨了对流解析模型的物理依据。您将比较简单的静力平衡理论预测的冷池（一种密度流）传播速度与更真实的非静力模拟结果。通过标度分析，您将推导出一个判据，用以确定非静力效应在何时变得至关重要，从而巩固您对对流解析模型不可或缺的物理尺度的理解。",
            "id": "4026014",
            "problem": "一个代表对流性冷池的二维密度流在一个稳定层结环境中沿地表传播。对于Boussinesq流体，静力浅水理论预测其锋面速度为 $c=\\sqrt{g' h}$，其中 $g' = g \\Delta \\rho/\\rho$ 是折减重力，h 是流体深度。在大气中，在Boussinesq近似下，折减重力可以表示为 $g' = g \\Delta \\theta / \\theta_0$，其中 $\\Delta \\theta$ 是冷池相对于环境的位温亏损，$\\theta_0$ 是参考位温。一个非静力Boussinesq模型（NBM）在对流允许分辨率下模拟了相同的密度流，能够解析垂直加速度和内重力波动力学。\n\n假设以下科学上合理的参数：\n- 参考位温 $\\theta_0 = 300\\ \\mathrm{K}$。\n- 冷池位温亏损 $\\Delta \\theta = 3\\ \\mathrm{K}$。\n- 重力 $g = 9.81\\ \\mathrm{m\\ s^{-2}}$。\n- 密度流深度 $h = 1.2\\times 10^3\\ \\mathrm{m}$。\n- 环境Brunt–Väisälä频率 $N = 0.012\\ \\mathrm{s^{-1}}$。\n- 非静力Boussinesq模型模拟的传播速度 $U_{nh} = 13\\ \\mathrm{m\\ s^{-1}}$。\n- 对应于锋面水平尺度的对流允许模型（CPM）水平网格间距 $L_f \\in \\{1.0\\times 10^3,\\ 3.0\\times 10^3\\}\\ \\mathrm{m}$。\n\n从静力浅水预测 $c=\\sqrt{g' h}$ 以及Boussinesq质量连续性方程和动量方程出发，根据第一性原理进行推导，以：\n1) 计算给定参数下的静力速度 $c$，并将其与 $U_{nh}$ 进行比较。\n2) 基于Boussinesq垂直动量方程和连续性方程，使用标度分析推导一个准则——通过一个无量纲参数表示——用于判断在对流允许分辨率下，垂直方向的静力平衡何时会失效，并针对 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 和 $L_f=3.0\\times 10^3\\ \\mathrm{m}$ 评估该准则。\n\n根据您的推导和计算，哪个（些）选项是正确的？\n\nA. 静力预测速度 $c$ 比模拟速度低估了约 $20\\%$；这种差异与非静力效应在垂直弗劳德数 $Fr_v = U/(N L_f) \\gtrsim 1$ 时变得重要相一致，对于给定参数，该条件在 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 时得到满足。\n\nB. 因为 $g' \\ll g$，静力公式 $c=\\sqrt{g' h}$ 在任何分辨率下都必然准确；与 $U_{nh}$ 的任何差异都必定是由于数值扩散而非动力学原因造成的。\n\nC. 静力平衡的破坏主要由罗斯贝数 $Ro = U/(f L_f)$ 决定，其中 $f$ 是科里奥利参数；中纬度地区的大 $Ro$ 值意味着在所有尺度上静力平衡都会失效，且与 $N$ 无关。\n\nD. 随着分辨率粗化至 $L_f=3.0\\times 10^3\\ \\mathrm{m}$，条件 $Fr_v \\ll 1$ 和更小的长宽比 $h/L_f$ 使得静力估计 $c$ 成为一个一阶近似，其误差量级为百分之几十；相比之下，在 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 时，$Fr_v \\gtrsim 1$ 且 $h/L_f$ 不小，这意味着在 $1\\ \\mathrm{km}$ 尺度上静力平衡失效。",
            "solution": "在进行求解之前，首先分析问题陈述的有效性。\n\n### 步骤1：提取给定条件\n-   静力浅水锋面速度预测：$c=\\sqrt{g' h}$\n-   折减重力定义（密度）：$g' = g \\Delta \\rho/\\rho$\n-   折减重力定义（Boussinesq，位温）：$g' = g \\Delta \\theta / \\theta_0$\n-   参考位温：$\\theta_0 = 300\\ \\mathrm{K}$\n-   冷池位温亏损：$\\Delta \\theta = 3\\ \\mathrm{K}$\n-   重力加速度：$g = 9.81\\ \\mathrm{m\\ s^{-2}}$\n-   密度流深度：$h = 1.2\\times 10^3\\ \\mathrm{m}$\n-   环境Brunt–Väisälä频率：$N = 0.012\\ \\mathrm{s^{-1}}$\n-   非静力Boussinesq模型模拟的传播速度：$U_{nh} = 13\\ \\mathrm{m\\ s^{-1}}$\n-   锋面水平尺度（网格间距）：$L_f \\in \\{1.0\\times 10^3,\\ 3.0\\times 10^3\\}\\ \\mathrm{m}$\n\n### 步骤2：使用提取的给定条件进行验证\n-   **科学基础**：该问题牢固地植根于地球物理流体动力学的既定原理。它涉及密度流（冷池）的传播、Boussinesq近似和静力近似、浅水理论，以及非静力动力学和层结（$N$）的作用。所给方程和参数是大气科学中的标准内容。所有数值对于地球大气中的冷池都是物理上合理的。\n-   **适定性**：该问题是适定的。它提供了执行所要求的两项任务（直接计算和标度分析）所需的所有必要信息。问题具体明确，并能导出可验证的结论。\n-   **客观性**：问题以精确、客观和定量的方式陈述。没有主观或模糊的陈述。\n\n### 步骤3：结论和行动\n该问题在科学上是合理的、适定的和客观的。它没有违反任何无效性标准。因此，问题陈述是**有效的**。将进行完整的推导和求解。\n\n### 解题推导\n\n该问题需要完成两个主要任务：（1）计算静力速度并将其与模拟速度进行比较；（2）推导静力近似失效的准则，并将其应用于给定的尺度。\n\n**1) 静力速度计算与比较**\n\n首先，在Boussinesq近似下，使用给定的热力学参数计算折减重力 $g'$：\n$$ g' = g \\frac{\\Delta \\theta}{\\theta_0} $$\n代入给定值：\n$$ g' = (9.81\\ \\mathrm{m\\ s^{-2}}) \\frac{3\\ \\mathrm{K}}{300\\ \\mathrm{K}} = 9.81\\ \\mathrm{m\\ s^{-2}} \\times 0.01 = 0.0981\\ \\mathrm{m\\ s^{-2}} $$\n接下来，计算静力浅水速度 $c$：\n$$ c = \\sqrt{g' h} $$\n代入计算出的 $g'$ 和给定的 $h$：\n$$ c = \\sqrt{(0.0981\\ \\mathrm{m\\ s^{-2}}) (1.2\\times 10^3\\ \\mathrm{m})} = \\sqrt{117.72\\ \\mathrm{m^2\\ s^{-2}}} \\approx 10.85\\ \\mathrm{m\\ s^{-1}} $$\n给定的模拟非静力速度为 $U_{nh} = 13\\ \\mathrm{m\\ s^{-1}}$。静力预测速度 $c$ 低于模拟速度 $U_{nh}$。差值为 $U_{nh} - c = 13 - 10.85 = 2.15\\ \\mathrm{m\\ s^{-1}}$。\n\n为了量化这种低估，我们可以计算相对于静力预测速度 $c$ 的百分比差异：\n$$ \\text{百分比误差} = \\frac{U_{nh} - c}{c} \\times 100\\% = \\frac{2.15\\ \\mathrm{m\\ s^{-1}}}{10.85\\ \\mathrm{m\\ s^{-1}}} \\times 100\\% \\approx 19.8\\% $$\n因此，静力理论低估了传播速度约 $20\\%$。这种差异在物理上是预期的，因为在流体头部，非静力模型能够解析而非静力浅水理论中缺失的非静力压力效应，通常会增加传播速度。\n\n**2) 静力平衡失效的准则**\n\n当垂直加速度与垂直气压梯度力和浮力相比可以忽略不计时，静力近似是有效的。Boussinesq垂直动量方程为：\n$$ \\frac{D w}{D t} = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} - g\\frac{\\rho'}{\\rho_0} $$\n其中 $w$ 是垂直速度，$\\frac{D}{Dt}$ 是物质导数，$p'$ 是气压扰动，$\\rho'$ 是密度扰动。静力近似用 $0 = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial z} - g\\frac{\\rho'}{\\rho_0}$ 代替该方程，实际上是假设 $\\frac{Dw}{Dt} \\approx 0$。当这个假设不成立时，静力平衡就会失效。\n\n我们进行标度分析来确定垂直加速度项 $\\frac{Dw}{Dt}$ 何时是显著的。设 $U$ 为特征水平速度尺度（传播速度），$W$ 为垂直速度尺度，$L_f$ 为水平长度尺度（锋面尺度），$h$ 为垂直长度尺度（流体深度）。\n物质导数中主要的平流项是 $u \\frac{\\partial w}{\\partial x}$。因此，垂直加速度的标度为：\n$$ \\frac{Dw}{Dt} \\sim U \\frac{W}{L_f} $$\n从二维不可压缩连续性方程 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$，我们关联速度尺度：\n$$ \\frac{U}{L_f} \\sim \\frac{W}{h} \\implies W \\sim U \\frac{h}{L_f} $$\n将此代入加速度的标度关系中，得到：\n$$ \\frac{Dw}{Dt} \\sim U \\frac{1}{L_f} \\left( U \\frac{h}{L_f} \\right) = \\frac{U^2 h}{L_f^2} $$\n在一个稳定层结的环境中，垂直运动的主要恢复力是浮力，其振荡频率为Brunt–Väisälä频率 $N$。流体质块响应垂直位移的特征时间尺度是浮力周期 $T_N \\sim 1/N$。质块穿过水平特征所需的时间是平流时间尺度 $T_{adv} = L_f/U$。\n\n当流体在水平移动时有足够的时间进行垂直调整时，即 $T_{adv} \\gg T_N$，静力近似成立。当这些时间尺度变得相当时，该近似失效：\n$$ T_{adv} \\lesssim T_N \\implies \\frac{L_f}{U} \\lesssim \\frac{1}{N} $$\n重新整理可得静力平衡失效的准则：\n$$ \\frac{U}{N L_f} \\gtrsim 1 $$\n无量纲参数 $Fr_v = \\frac{U}{N L_f}$ 是一个垂直弗劳德数。当 $Fr_v \\gtrsim 1$ 时，静力平衡失效。\n\n现在，我们使用 $U \\approx U_{nh}=13\\ \\mathrm{m\\ s^{-1}}$ 和 $N=0.012\\ \\mathrm{s^{-1}}$ 来评估给定参数下的这个准则。\n-   对于 $L_f = 1.0\\times 10^3\\ \\mathrm{m}$：\n    $$ Fr_v = \\frac{13\\ \\mathrm{m\\ s^{-1}}}{(0.012\\ \\mathrm{s^{-1}})(1.0\\times 10^3\\ \\mathrm{m})} = \\frac{13}{12} \\approx 1.08 $$\n    由于 $Fr_v \\approx 1.08 \\gtrsim 1$，预计在此分辨率下静力近似会失效。\n\n-   对于 $L_f = 3.0\\times 10^3\\ \\mathrm{m}$：\n    $$ Fr_v = \\frac{13\\ \\mathrm{m\\ s^{-1}}}{(0.012\\ \\mathrm{s^{-1}})(3.0\\times 10^3\\ \\mathrm{m})} = \\frac{13}{36} \\approx 0.36  1$$\n    由于 $Fr_v \\approx 0.36  1$，静力近似更具合理性，尽管非静力效应可能并非完全可以忽略。\n\n另一个相关指标是流动的长宽比 $\\delta = h/L_f$。静力假设在 $\\delta \\ll 1$ 时是形式上有效的。\n- 对于 $L_f = 1.0\\times 10^3\\ \\mathrm{m}$，$\\delta = (1.2\\times 10^3\\ \\mathrm{m}) / (1.0\\times 10^3\\ \\mathrm{m}) = 1.2$。\n- 对于 $L_f = 3.0\\times 10^3\\ \\mathrm{m}$，$\\delta = (1.2\\times 10^3\\ \\mathrm{m}) / (3.0\\times 10^3\\ \\mathrm{m}) = 0.4$。\n在 $1\\ \\mathrm{km}$ 尺度上，长宽比为1的量级，这加强了静力平衡失效的结论。在 $3\\ \\mathrm{km}$ 尺度上，长宽比较小，与流动更接近静力平衡的结论一致。\n\n### 逐项分析选项\n\n**A. 静力预测速度 $c$ 比模拟速度低估了约 $20\\%$；这种差异与非静力效应在垂直弗劳德数 $Fr_v = U/(N L_f) \\gtrsim 1$ 时变得重要相一致，对于给定参数，该条件在 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 时得到满足。**\n- 静力速度 $c \\approx 10.85\\ \\mathrm{m\\ s^{-1}}$ 低估了非静力速度 $U_{nh} = 13\\ \\mathrm{m\\ s^{-1}}$。相对于 $c$ 的低估约为 $19.8\\%$，可以近似为“约 $20\\%$”。\n- 其理由是当 $Fr_v = U/(N L_f) \\gtrsim 1$ 时，非静力效应变得重要。这是从标度原理推导出的正确准则。\n- 对 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 的评估得出 $Fr_v \\approx 1.08$，满足 $Fr_v \\gtrsim 1$ 的条件。\n- 该陈述的所有部分都是正确的，并与推导一致。\n**结论：正确**\n\n**B. 因为 $g' \\ll g$，静力公式 $c=\\sqrt{g' h}$ 在任何分辨率下都必然准确；与 $U_{nh}$ 的任何差异都必定是由于数值扩散而非动力学原因造成的。**\n- 条件 $g' \\ll g$（这是正确的，因为 $0.0981 \\ll 9.81$）是Boussinesq近似的理由，而不是静力近似的理由。静力近似关系到垂直加速度的相对大小，而这取决于流动尺度（$h$, $L_f$）、速度（$U$）和层结（$N$）。\n- 静力公式在任何分辨率下都准确的说法是错误的。其准确性明确地依赖于尺度，如 $Fr_v$ 准则所示。\n- $c$ 和 $U_{nh}$ 之间的差异主要是由被解析的非静力压力动力学（一种真实的物理效应）引起的，而不是像扩散那样的数值产物。\n**结论：错误**\n\n**C. 静力平衡的破坏主要由罗斯贝数 $Ro = U/(f L_f)$ 决定，其中 $f$ 是科里奥利参数；中纬度地区的大 $Ro$ 值意味着在所有尺度上静力平衡都会失效，且与 $N$ 无关。**\n- 罗斯贝数 $Ro$ 比较的是惯性力与科里奥利力。它决定了行星旋转的重要性，这是一种水平效应。\n- 静力平衡是垂直方向的力平衡。其失效是由垂直加速度决定的，而垂直加速度与以 $N$ 为特征的层结（浮力）有关。\n- 该陈述错误地将罗斯贝数认定为静力平衡的主导参数，并错误地声称与 $N$ 无关。\n**结论：错误**\n\n**D. 随着分辨率粗化至 $L_f=3.0\\times 10^3\\ \\mathrm{m}$，条件 $Fr_v \\ll 1$ 和更小的长宽比 $h/L_f$ 使得静力估计 $c$ 成为一个一阶近似，其误差量级为百分之几十；相比之下，在 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 时，$Fr_v \\gtrsim 1$ 且 $h/L_f$ 不小，这意味着在 $1\\ \\mathrm{km}$ 尺度上静力平衡失效。**\n- 在 $L_f=3.0\\times 10^3\\ \\mathrm{m}$ 时，我们发现 $Fr_v \\approx 0.36$ 且 $h/L_f = 0.4$。这些值小于它们在 $L_f = 1.0\\times 10^3\\ \\mathrm{m}$ 时的对应值，表明流动“更”接近静力平衡。$Fr_v \\ll 1$ 的描述略有夸大，但反映了正确的趋势。“误差量级为百分之几十”的说法与我们计算出的 $\\sim 20\\%$ 的误差是一致的。\n- 在 $L_f=1.0\\times 10^3\\ \\mathrm{m}$ 时，我们发现 $Fr_v \\approx 1.08 \\gtrsim 1$ 且 $h/L_f = 1.2$，这个值不小。这些条件正确地暗示了在此尺度上静力近似的失效。\n- 该选项正确地对比了两种尺度下的行为，并准确地在其推理中同时使用了垂直弗劳德数和长宽比。整个物理论证是合理的。\n**结论：正确**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "稳定的数值积分是任何成功的天气或气候模拟的基础。本练习聚焦于模型的数值核心，指导您对一种广泛使用的龙格-库塔时间积分方案进行稳定性分析。通过应用傅里叶分析，您将确定一个平流问题的稳定性约束，并学习一项实用技能：选择满足 Courant-Friedrichs-Lewy (CFL) 条件的时间步长（$Δt$），以确保模拟不会因数值误差而失败。",
            "id": "4025927",
            "problem": "在对流可分辨的数值天气预报中，考虑一个预报示踪物的一维线性平流，作为全欧拉可压缩模型中半拉格朗日输送变量的替代。控制方程是在间距为 $h$ 的均匀网格上的线性平流方程 $u_{t} + U u_{x} = 0$。假设在周期性域上对 $u_{x}$ 采用二阶中心有限差分进行空间半离散化，并采用显式三阶段三阶龙格-库塔 (Runge–Kutta, RK) 方法进行时间积分。令库朗数定义为 $C = U \\Delta t / h$。\n\n任务：\n- 从二阶中心差分的半离散算子的傅里叶分析和线性测试方程 $y' = \\lambda y$ 出发，推导显式三阶段三阶龙格-库塔方法的标量放大因子 $R(z)$，其中 $z = \\lambda \\Delta t$。\n- 确定在 $z = \\mathrm{i} y$ 中，虚轴参数 $y$ 满足绝对稳定性条件 $\\lvert R(\\mathrm{i} y) \\rvert \\le 1$ 的条件。然后，将此条件转化为线性平流的中心差分空间离散化的库朗数 $C$ 的界限。\n- 当风速 $U = 20\\ \\mathrm{m\\,s^{-1}}$、网格间距 $h = 1\\ \\mathrm{km}$ 时，选择与目标库朗数 $C = 0.5$ 对应的时间步长 $\\Delta t$。将 $\\Delta t$ 的最终值以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题经检验，被确认为一个在应用于地球物理流体动力学的数值分析领域中，自洽、有科学依据且适定的问题。解答过程按提出的顺序处理这三个任务。\n\n控制方程是关于示踪物浓度 $u(x,t)$ 的一维线性平流方程：\n$$ u_{t} + U u_{x} = 0 $$\n其中 $u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$。该方程在间距为 $h$ 的均匀网格上离散化，并以步长 $\\Delta t$ 进行时间积分。\n\n### 第1部分：放大因子 $R(z)$ 的推导\n问题指定采用显式三阶段三阶龙格-库塔 (RK) 方法进行时间积分。为了推导放大因子 $R(z)$，我们将该数值方法应用于线性测试方程 $y' = \\lambda y$，其中 $\\lambda$ 是一个复常数。精确解的演化为 $y(t_{n+1}) = y(t_n) \\exp(\\lambda \\Delta t)$。\n\n一个 $p$ 阶数值方法提供了一个近似解 $y_{n+1} = R(\\lambda \\Delta t) y_n$。为了使该方法达到 $p$ 阶精度，其放大因子 $R(z)$ 必须与 $\\exp(z)$ 的泰勒级数展开式匹配，直到并包括 $p$ 阶项。此处，$z = \\lambda \\Delta t$。\n\n指数函数的泰勒展开式为：\n$$ \\exp(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} + \\dots $$\n对于一个三阶方法 ($p=3$)，放大因子 $R(z)$ 必须与此级数的前四项完全相同。因此，任何显式三阶 RK 方法的标量放大因子为：\n$$ R(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 $$\n\n### 第2部分：稳定性条件与库朗数的界限\n首先，我们分析空间半离散化。偏导数 $u_x$ 在网格点 $j$ 处用二阶中心有限差分近似：\n$$ u_x \\approx \\frac{u_{j+1} - u_{j-1}}{2h} $$\n将此代入平流方程，得到一个常微分方程组 (ODEs)，每个网格点 $u_j(t)$ 对应一个方程：\n$$ \\frac{du_j}{dt} + U \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) = 0 \\implies \\frac{du_j}{dt} = - \\frac{U}{2h} (u_{j+1} - u_{j-1}) $$\n为了进行 von Neumann 稳定性分析，我们考虑单个傅里叶模式解 $u_j(t) = \\hat{u}(t) \\exp(\\mathrm{i} k x_j)$，其中 $k$ 是波数，$x_j = jh$。将此代入半离散方程得到：\n$$ \\frac{d\\hat{u}}{dt} \\exp(\\mathrm{i} kjh) = - \\frac{U}{2h} \\left[ \\hat{u}\\exp(\\mathrm{i}k(j+1)h) - \\hat{u}\\exp(\\mathrm{i}k(j-1)h) \\right] $$\n两边同除以 $\\hat{u} \\exp(\\mathrm{i} kjh)$：\n$$ \\frac{1}{\\hat{u}}\\frac{d\\hat{u}}{dt} = - \\frac{U}{2h} \\left[ \\exp(\\mathrm{i}kh) - \\exp(-\\mathrm{i}kh) \\right] $$\n使用欧拉 (Euler) 恒等式 $\\sin(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\mathrm{i}}$，方括号中的项变为 $2\\mathrm{i}\\sin(kh)$。\n$$ \\frac{d\\hat{u}}{dt} = \\left( - \\frac{U}{2h} [2\\mathrm{i}\\sin(kh)] \\right) \\hat{u} = \\left( - \\frac{\\mathrm{i} U \\sin(kh)}{h} \\right) \\hat{u} $$\n该方程的形式为 $\\frac{d\\hat{u}}{dt} = \\lambda \\hat{u}$，其中对于模式 $k$ 的空间算子的特征值 $\\lambda$ 是纯虚数：\n$$ \\lambda = - \\frac{\\mathrm{i} U \\sin(kh)}{h} $$\n放大因子 $R(z)$ 的自变量是 $z = \\lambda \\Delta t$：\n$$ z = \\left( - \\frac{\\mathrm{i} U \\sin(kh)}{h} \\right) \\Delta t = - \\mathrm{i} \\frac{U \\Delta t}{h} \\sin(kh) $$\n使用库朗数定义 $C = U \\Delta t / h$，我们得到：\n$$ z = - \\mathrm{i} C \\sin(kh) $$\n$z$ 的这个表达式是纯虚数。我们可以写成 $z = \\mathrm{i}y$，其中 $y = -C \\sin(kh)$。稳定性条件是 $|R(z)| \\le 1$，这转化为 $|R(\\mathrm{i}y)| \\le 1$。我们将 $z = \\mathrm{i}y$ 代入 $R(z)$ 的表达式：\n$$ R(\\mathrm{i}y) = 1 + (\\mathrm{i}y) + \\frac{1}{2}(\\mathrm{i}y)^2 + \\frac{1}{6}(\\mathrm{i}y)^3 = 1 + \\mathrm{i}y - \\frac{1}{2}y^2 - \\frac{\\mathrm{i}}{6}y^3 $$\n将实部和虚部分组：\n$$ R(\\mathrm{i}y) = \\left(1 - \\frac{1}{2}y^2\\right) + \\mathrm{i}\\left(y - \\frac{1}{6}y^3\\right) $$\n幅值的平方为 $|R(\\mathrm{i}y)|^2 = (\\mathrm{Re}[R(\\mathrm{i}y)])^2 + (\\mathrm{Im}[R(\\mathrm{i}y)])^2$：\n$$ |R(\\mathrm{i}y)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + \\left(y - \\frac{1}{6}y^3\\right)^2 = \\left(1 - y^2 + \\frac{1}{4}y^4\\right) + \\left(y^2 - \\frac{1}{3}y^4 + \\frac{1}{36}y^6\\right) $$\n$$ |R(\\mathrm{i}y)|^2 = 1 + \\left(\\frac{1}{4} - \\frac{1}{3}\\right)y^4 + \\frac{1}{36}y^6 = 1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6 $$\n稳定性条件 $|R(\\mathrm{i}y)|^2 \\le 1$ 转化为：\n$$ 1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6 \\le 1 \\implies \\frac{1}{36}y^6 - \\frac{1}{12}y^4 \\le 0 $$\n提出因子 $\\frac{y^4}{36}$：\n$$ \\frac{y^4}{36} (y^2 - 3) \\le 0 $$\n由于 $y^4 \\ge 0$，当且仅当 $y^2 - 3 \\le 0$ 时该不等式成立，即 $y^2 \\le 3$。因此，对虚轴参数 $y$ 的条件是：\n$$ |y| \\le \\sqrt{3} $$\n为了将此转化为对库朗数 $C$ 的界限，我们使用 $y = -C \\sin(kh)$：\n$$ |-C \\sin(kh)| \\le \\sqrt{3} \\implies C |\\sin(kh)| \\le \\sqrt{3} $$\n此条件必须对数值解中存在的所有波数 $k$ 成立。格式的稳定性由最严格的情况决定，即当 $|\\sin(kh)|$ 达到其最大值时。$|\\sin(kh)|$ 的最大值为 $1$。因此，为确保所有傅里叶模式的稳定性，我们必须有：\n$$ C \\le \\sqrt{3} $$\n\n### 第3部分：时间步长 $\\Delta t$ 的计算\n问题提供了以下参数：\n- 风速：$U = 20\\ \\mathrm{m\\,s^{-1}}$\n- 网格间距：$h = 1\\ \\mathrm{km} = 1000\\ \\mathrm{m}$\n- 目标库朗数：$C = 0.5$\n\n所选库朗数 $C = 0.5$ 满足稳定性条件 $C \\le \\sqrt{3}$，因为 $\\sqrt{3} \\approx 1.732$。我们现在可以根据库朗数的定义计算相应的时间步长 $\\Delta t$：\n$$ C = \\frac{U \\Delta t}{h} \\implies \\Delta t = \\frac{C h}{U} $$\n代入数值：\n$$ \\Delta t = \\frac{0.5 \\times 1000\\ \\mathrm{m}}{20\\ \\mathrm{m\\,s^{-1}}} = \\frac{500}{20}\\ \\mathrm{s} = 25\\ \\mathrm{s} $$\n问题要求将结果以秒为单位表示，并四舍五入到四位有效数字。\n$$ \\Delta t = 25.00\\ \\mathrm{s} $$",
            "answer": "$$ \\boxed{25.00} $$"
        },
        {
            "introduction": "评估模型的预报质量是建模工作流程中的关键一步。这个动手编程练习将介绍一种复杂的基于对象的检验方法，它比传统的格点比较能提供更深刻的见解。您将开发一个程序，用于识别和表征模型预报和观测数据中的对流“对象”，然后对它们进行匹配，以定量评估模型在模拟风暴结构、强度和位置方面的真实性。",
            "id": "4026010",
            "problem": "给定两个表示对流降水率的网格化强度场：一个来自对流可分辨模式 (CPM)，另一个来自雷达衍生观测。模式场和雷达场共享相同的笛卡尔网格间距。您的任务是使用基于阈值的连通分量方法在每个场中检测对流目标，并计算基于目标的诊断。然后，基于质心距离在 CPM 和雷达目标之间执行一对一匹配以评估其真实性。请实现一个完整的程序，执行此工作流程，并为指定的测试套件返回定量指标。\n\n基本依据和定义：\n- 对流目标定义为一个连通的网格单元集合，其中强度 $I(i,j)$ 满足 $I(i,j) \\ge T$，$T$ 为预设阈值。使用$8$-邻域连通（每个单元与其周围的8个邻居相连）。\n- 设网格间距均匀，为 $\\Delta x = \\Delta y$，单位为公里。设网格点 $(i,j)$ 的物理坐标为 $x_{i} = i \\Delta x$ 和 $y_{j} = j \\Delta y$，原点 $(x,y) = (0,0)$ 位于索引 $(i,j) = (0,0)$ 处。索引 $i$ 和 $j$ 分别是列索引和行索引。\n- 对于每个检测到的目标 $o$（一组索引 $(i,j)$）：\n  - 尺寸 $S(o)$ 是目标的总面积，计算公式为 $S(o) = N(o) \\Delta x \\Delta y$，其中 $N(o)$ 是 $o$ 中的网格单元数。以 $\\mathrm{km}^2$ 为单位报告 $S(o)$。\n  - 峰值强度 $P(o)$ 是目标上的最大局部强度，$P(o) = \\max_{(i,j) \\in o} I(i,j)$。以毫米/小时 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$ 为单位报告 $P(o)$。\n  - 几何质心 $C(o)$ 为 $(x_c(o),y_c(o))$，其中\n    $$\n    x_c(o) = \\frac{1}{N(o)} \\sum_{(i,j) \\in o} x_i, \\quad\n    y_c(o) = \\frac{1}{N(o)} \\sum_{(i,j) \\in o} y_j.\n    $$\n- 匹配规则：给定 CPM 目标集 $\\{o^M_k\\}$ 和雷达目标集 $\\{o^R_\\ell\\}$，构建成对欧几里得距离矩阵 $D_{k\\ell} = \\lVert C(o^M_k) - C(o^R_\\ell) \\rVert_2$。执行最小成本一对一分配，以最小化距离总和。仅当距离小于或等于预设的最大值 $D_{\\max}$ 时才接受匹配；舍弃超过此阈值的配对。\n- 基于已接受匹配的真实性指标：\n  - 匹配分数 $F = \\dfrac{N_{\\text{matched}}}{\\max(N_M, N_R)}$，其中 $N_{\\text{matched}}$ 是已接受的匹配数，$N_M$ 是 CPM 目标数，$N_R$ 是雷达目标数。如果 $N_M = N_R = 0$，定义 $F = 1$。\n  - 平均绝对尺寸差异 $\\overline{\\Delta S} = \\dfrac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} | S(o^M) - S(o^R) |$，以 $\\mathrm{km}^2$ 为单位报告。如果 $N_{\\text{matched}} = 0$，定义 $\\overline{\\Delta S} = 0$。\n  - 平均绝对峰值强度差异 $\\overline{\\Delta P} = \\dfrac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} | P(o^M) - P(o^R) |$，以 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$ 为单位报告。如果 $N_{\\text{matched}} = 0$，定义 $\\overline{\\Delta P} = 0$。\n  - 平均质心距离 $\\overline{d} = \\dfrac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} \\lVert C(o^M) - C(o^R) \\rVert_2$，以公里为单位报告。如果 $N_{\\text{matched}} = 0$，定义 $\\overline{d} = 0$。\n\n使用以下参数和测试套件实现上述内容。所有强度单位为毫米/小时 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$；距离单位为公里；面积单位为 $\\mathrm{km}^2$。\n\n全局参数：\n- 阈值 $T = 10$。\n- 网格间距 $\\Delta x = \\Delta y = 2$。\n- 最大匹配距离 $D_{\\max} = 5$。\n\n包含四个案例的测试套件，每个案例指定 $(I_M, I_R)$，即两个 $6 \\times 6$ 的数组：\n\n案例1（理想情况；两个相似的目标）：\n- $I_M =$\n  $\n  \\begin{bmatrix}\n  0  0  12  14  0  0 \\\\\n  0  0  11  13  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  20  21  0  0  0 \\\\\n  0  18  22  0  0  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n- $I_R =$\n  $\n  \\begin{bmatrix}\n  0  0  13  15  0  0 \\\\\n  0  0  12  16  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  19  20  0  0  0 \\\\\n  0  18  23  0  0  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n\n案例2（CPM 分裂对比雷达合并）：\n- $I_M =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  11  0  0  0 \\\\\n  0  0  12  0  0  0 \\\\\n  0  0  0  14  15  0 \\\\\n  0  0  0  13  16  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n- $I_R =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  11  12  0  0 \\\\\n  0  0  12  13  0  0 \\\\\n  0  0  11  14  15  0 \\\\\n  0  0  0  13  16  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n\n案例3（两个场中均无目标）：\n- $I_M =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n- $I_R =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n\n案例4（雷达有一个 CPM 中不存在的额外目标）：\n- $I_M =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  11  12  0  0  17  0 \\\\\n  13  14  0  0  18  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0\n  \\end{bmatrix}\n  $\n- $I_R =$\n  $\n  \\begin{bmatrix}\n  0  0  0  0  0  0 \\\\\n  0  0  0  0  0  0 \\\\\n  10  13  0  0  18  0 \\\\\n  12  15  0  0  19  0 \\\\\n  0  0  0  0  0  0 \\\\\n  0  0  0  16  17  18\n  \\end{bmatrix}\n  $\n\n您的程序必须：\n- 使用上述定义和参数检测 CPM 和雷达目标。\n- 为每个目标计算 $S(o)$、$P(o)$ 和 $C(o)$。\n- 在 $D_{\\max}$ 准则的约束下执行最小成本匹配。\n- 为每个测试案例计算真实性指标 $F$、$\\overline{\\Delta S}$（单位 $\\mathrm{km}^2$）、$\\overline{\\Delta P}$（单位 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$）和 $\\overline{d}$（单位 $\\mathrm{km}$）。\n- 将所有测试案例的结果汇总到一行输出中，该输出包含一个用方括号括起来的逗号分隔列表，其中每个测试案例的结果本身也是一个列表，顺序为 $[F,\\overline{\\Delta S},\\overline{\\Delta P},\\overline{d}]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[[\\dots],[\\dots],[\\dots],[\\dots]]$），每个内部列表的顺序为 $[F,\\overline{\\Delta S},\\overline{\\Delta P},\\overline{d}]$。",
            "solution": "用户在数值天气预报检验领域提供了一个定义明确的问题。经过严格评估，确认其有效性。\n\n### 步骤1：提取给定条件\n- **场**：对流可分辨模式 (CPM) 强度场 $I_M$ 和雷达衍生观测强度场 $I_R$。\n- **网格**：均匀笛卡尔网格，间距为 $\\Delta x = \\Delta y$。列索引为 $i$、行索引为 $j$ 的网格点的物理坐标为 $(x_i, y_j)$，其中 $x_i = i \\Delta x$，$y_j = j \\Delta y$。原点 $(x,y)=(0,0)$ 对应索引 $(i,j)=(0,0)$。\n- **目标定义**：对流目标是一个连通的网格单元集合，其中强度 $I(i,j)$ 大于或等于阈值 $T$。连通性由8个周围邻居（摩尔邻域）定义。\n- **目标属性**：对于一个包含 $N(o)$ 个网格单元的目标 $o$：\n  - 尺寸：$S(o) = N(o) \\Delta x \\Delta y$，单位为 $\\mathrm{km}^2$。\n  - 峰值强度：$P(o) = \\max_{(i,j) \\in o} I(i,j)$，单位为 $\\mathrm{mm}\\ \\mathrm{h}^{-1}$。\n  - 几何质心：$C(o) = (x_c(o), y_c(o))$，其中 $x_c(o) = \\frac{1}{N(o)} \\sum_{(i,j) \\in o} x_i$，$y_c(o) = \\frac{1}{N(o)} \\sum_{(i,j) \\in o} y_j$。\n- **匹配**：给定 CPM 目标 $\\{o^M_k\\}$ 和雷达目标 $\\{o^R_\\ell\\}$，通过最小化成对欧几里得质心距离的总和 $D_{k\\ell} = \\lVert C(o^M_k) - C(o^R_\\ell) \\rVert_2$ 来找到一对一分配。只有当其距离小于或等于最大距离 $D_{\\max}$ 时，匹配才被接受。\n- **真实性指标**：\n  - 匹配分数：$F = N_{\\text{matched}} / \\max(N_M, N_R)$，其中 $N_{\\text{matched}}$ 是接受的匹配数，$N_M$ 是 CPM 目标数，$N_R$ 是雷达目标数。如果 $N_M = N_R = 0$，则 $F = 1$。\n  - 平均绝对尺寸差异：$\\overline{\\Delta S} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} | S(o^M) - S(o^R) |$。若 $N_{\\text{matched}} = 0$，则 $\\overline{\\Delta S} = 0$。\n  - 平均绝对峰值强度差异：$\\overline{\\Delta P} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} | P(o^M) - P(o^R) |$。若 $N_{\\text{matched}} = 0$，则 $\\overline{\\Delta P} = 0$。\n  - 平均质心距离：$\\overline{d} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} \\lVert C(o^M) - C(o^R) \\rVert_2$。若 $N_{\\text{matched}} = 0$，则 $\\overline{d} = 0$。\n- **全局参数**：\n  - 阈值 $T = 10\\ \\mathrm{mm}\\ \\mathrm{h}^{-1}$。\n  - 网格间距 $\\Delta x = 2\\ \\mathrm{km}$，$\\Delta y = 2\\ \\mathrm{km}$。\n  - 最大匹配距离 $D_{\\max} = 5\\ \\mathrm{km}$。\n- **测试套件**：四个测试案例，每个案例由一对 $6 \\times 6$ 的 $I_M$ 和 $I_R$ 矩阵定义。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题被评估为**有效**。\n- **科学依据充分**：该问题描述了一种用于评估高分辨率降水预报的标准基于目标的检验方法，这在气象学中是常用的。所有概念都是数据分析和图像处理中的标准概念。\n- **定义明确**：该问题在计算上是适定的。输入、参数、算法步骤和输出格式都得到了明确的规定。对于边缘情况（如无目标、无匹配）的定义确保了总能计算出唯一且稳定的解。\n- **客观性**：问题陈述使用了正式的数学定义和精确、无偏见的语言。\n- **完整性与一致性**：所有必要的数据和参数（$I_M, I_R, T, \\Delta x, \\Delta y, D_{\\max}$）均已提供。定义内部一致。\n- **真实性与可行性**：物理背景、参数值和网格数据对于指定的应用场景是合理的。该问题在计算上是可行的。\n\n### 步骤3：结论与行动\n此问题有效。将提供一个完整、合理的解决方案。\n\n### 解决方案\n\n该解决方案实现了一个系统性的、基于目标的检验工作流。这种方法通过比较离散现象（对流目标）的属性来评估预报质量，而不是对整个场进行逐点比较。该过程分为四个主要阶段：目标识别、属性计算、目标匹配和指标计算。\n\n**1. 目标识别**\n\n对于每个强度场 $I_M$ 和 $I_R$，通过两步过程识别目标。首先，通过应用强度阈值 $T$ 创建一个二值掩码。如果位于 $(i,j)$ 位置的网格单元的强度 $I(i,j) \\ge T$，则认为该单元是潜在目标的一部分。设该二值场为 $B(i,j)$。\n$$\nB(i,j) = \\begin{cases} 1  \\text{若 } I(i,j) \\ge T \\\\ 0  \\text{否则} \\end{cases}\n$$\n其次，对二值场 $B$ 应用连通分量标记算法。问题指定了8-连通性，意味着一个单元与其八个直接邻居（水平、垂直和对角线方向）相连。此算法将所有 $B(i,j) = 1$ 的单元集合划分为不相交的子集，每个子集构成一个独立的目标。每个目标被分配一个唯一的整数标签。找到的唯一标签数量对应于场中目标的总数（模式场为 $N_M$，雷达场为 $N_R$）。\n\n**2. 目标属性计算**\n\n对于每个已识别的目标 $o$，计算一组物理属性。一个目标 $o_k$ 由共享标签 $k$ 的网格索引 $\\{(i,j)\\}$ 集合表示。\n\n- **尺寸 ($S$)**：目标的尺寸是其物理面积。通过将目标中的网格单元数 $N(o_k)$ 乘以单个网格单元的面积 $\\Delta x \\Delta y$ 来计算。\n  $$\n  S(o_k) = N(o_k) \\cdot \\Delta x \\cdot \\Delta y\n  $$\n  给定 $\\Delta x = \\Delta y = 2 \\ \\mathrm{km}$，一个单元的面积为 $4 \\ \\mathrm{km}^2$。\n\n- **峰值强度 ($P$)**：峰值强度是在原始的、未经阈值处理的场 $I$ 中，在属于该目标的所有单元上找到的最大强度值。\n  $$\n  P(o_k) = \\max_{(i,j) \\in o_k} I(i,j)\n  $$\n\n- **几何质心 ($C$)**：质心代表了目标在假设密度均匀情况下的质心。它是目标中所有单元物理坐标的算术平均值。对于一个由单元索引 $\\{(i_m, j_m)\\}_{m=1}^{N(o_k)}$ 构成的目标 $o_k$，其质心 $(x_c(o_k), y_c(o_k))$ 为：\n  $$\n  x_c(o_k) = \\frac{1}{N(o_k)} \\sum_{(i,j) \\in o_k} x_i = \\frac{\\Delta x}{N(o_k)} \\sum_{(i,j) \\in o_k} i\n  $$\n  $$\n  y_c(o_k) = \\frac{1}{N(o_k)} \\sum_{(i,j) \\in o_k} y_j = \\frac{\\Delta y}{N(o_k)} \\sum_{(i,j) \\in o_k} j\n  $$\n  此处，$i$ 和 $j$ 分别是问题中定义的列和行索引。\n\n**3. 目标匹配**\n\n此阶段在模式目标 $\\{o^M_k\\}$ 和雷达目标 $\\{o^R_\\ell\\}$ 之间建立对应关系。这被表述为一个最小成本分配问题。\n\n- **成本矩阵**：构建一个 $N_M \\times N_R$ 的成本矩阵 $D$。元素 $D_{k\\ell}$ 是第 $k$ 个模式目标和第 $\\ell$ 个雷达目标质心之间的欧几里得距离。\n  $$\n  D_{k\\ell} = \\lVert C(o^M_k) - C(o^R_\\ell) \\rVert_2 = \\sqrt{(x_c(o^M_k) - x_c(o^R_\\ell))^2 + (y_c(o^M_k) - y_c(o^R_\\ell))^2}\n  $$\n\n- **最优分配**：目标是找到一组一对一的配对 $(k, \\ell)$，使得距离总和 $\\sum D_{k\\ell}$ 最小化。这是一个经典的线性总和分配问题，可以通过匈牙利算法高效解决。该算法找到行（模式目标）与列（雷达目标）的最优配对，或反之，取决于哪个集合更小。\n\n- **筛选**：根据距离标准对得到的最优配对进行筛选。只有当配对的质心距离在指定的最大值范围内，$D_{k\\ell} \\le D_{\\max}$，才被视为有效匹配。距离超过 $D_{\\max}$ 的配对将被舍弃。剩余配对的数量为 $N_{\\text{matched}}$。\n\n**4. 指标计算**\n\n最后，根据已接受的匹配计算一组汇总指标，以量化模型的真实性。\n\n- **匹配分数 ($F$)**：该指标量化了空间对应程度。它是匹配的目标数与目标总数的比率，通过除以 $N_M$ 或 $N_R$ 中的较大者进行归一化，以对漏报和空报都进行惩罚。\n  $$\n  F = \\frac{N_{\\text{matched}}}{\\max(N_M, N_R)}\n  $$\n  规则指定如果 $N_M=N_R=0$，则 $F=1$，否则按上述公式计算。\n\n- **平均属性差异 ($\\overline{\\Delta S}, \\overline{\\Delta P}$)**：这些指标评估目标属性的偏差。它们是在所有匹配对上尺寸和峰值强度的平均绝对差异。\n  $$\n  \\overline{\\Delta S} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} |S(o^M) - S(o^R)|\n  $$\n  $$\n  \\overline{\\Delta P} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} |P(o^M) - P(o^R)|\n  $$\n  如果 $N_{\\text{matched}} = 0$，这两个指标都定义为 $0$。\n\n- **平均质心距离 ($\\overline{d}$)**：该指标衡量匹配目标间的平均位置误差。\n  $$\n  \\overline{d} = \\frac{1}{N_{\\text{matched}}} \\sum_{\\text{matched pairs}} \\lVert C(o^M) - C(o^R) \\rVert_2\n  $$\n  如果 $N_{\\text{matched}} = 0$，该指标也定义为 $0$。\n\n这个综合过程将复杂的场间比较转化为一套易于理解的定量评分，为评估模型再现观测到的对流系统的位置、大小和强度的能力提供了见解。",
            "answer": "[[1.0,0.0,1.5,0.0],[0.5,20.0,4.0,2.8284271247461903],[1.0,0.0,0.0,0.0],[0.5,0.0,1.0,2.0]]"
        }
    ]
}