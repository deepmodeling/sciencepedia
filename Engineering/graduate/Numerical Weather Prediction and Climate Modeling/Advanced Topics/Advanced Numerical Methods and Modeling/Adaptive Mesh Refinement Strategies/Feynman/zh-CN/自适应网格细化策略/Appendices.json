{
    "hands_on_practices": [
        {
            "introduction": "自适应网格加密（AMR）的根本目的是有效地分配计算资源，以解析最重要的物理现象。本练习将物理世界与数值算法直接联系起来，指导您确定捕捉关键大气尺度——罗斯贝变形半径（Rossby radius of deformation）所需的最少加密层级 。掌握这种计算是为地球物理模型设计有效AMR策略的关键第一步。",
            "id": "4009014",
            "problem": "在一个用于数值天气预报和气候模拟的原始方程大气模型的水平自适应网格加密策略中，基础水平网格间距为 $\\Delta x_0$。每个加密级别都以一个恒定的加密比 $r$ 进行各向同性加密，其中 $r>1$ 是一个固定的数，在每个级别上将网格间距缩小 $r$ 倍。因此，经过 $L$ 个加密级别后，最细的网格间距表示为 $\\Delta x_{\\min}$。\n\n为了充分表示平衡的中尺度动力学，网格必须能解析罗斯贝变形半径（Rossby deformation radius），对于连续分层流体，此处近似为 $L_d = N H / f$，其中 $N>0$ 是浮力频率， $H>0$ 是一个代表性的垂直分层尺度， $f>0$ 是科里奥利参数。分辨率准则是，在最细的网格上，变形半径至少要由 $n$ 个点来解析，其中 $n \\ge 1$，即 $L_d / \\Delta x_{\\min} \\ge n$。\n\n假设 $\\Delta x_0>0$、 $r>1$、 $N>0$、 $H>0$、 $f>0$ 且 $n \\ge 1$，并且加密级别数 $L$ 必须是一个非负整数，请从第一性原理出发，推导满足分辨率准则所需的最小加密级别数。用 $N$、 $H$、 $f$、 $\\Delta x_0$、 $r$ 和 $n$ 将你的最终答案表示为一个单一的封闭形式解析表达式。在你的最终表达式中不要包含单位。如果你的结果涉及到对整数级别数的舍入，请使用适当的数学函数来表示，而不是指定一个数值舍入规则。",
            "solution": "我们从连续分层流体的罗斯贝变形半径的定义开始，其近似为 $L_d = N H / f$，其中 $N>0$ 是浮力频率， $H>0$ 是一个垂直尺度， $f>0$ 是科里奥利参数。采用几何加密比 $r>1$ 的自适应网格加密策略意味着，经过 $L$ 个加密级别后，最细的网格间距为\n$$\n\\Delta x_{\\min} = \\frac{\\Delta x_0}{r^{L}}.\n$$\n变形半径在最细网格上至少由 $n$ 个网格间距解析的分辨率要求是\n$$\n\\frac{L_d}{\\Delta x_{\\min}} \\ge n.\n$$\n代入 $\\Delta x_{\\min} = \\Delta x_0 / r^{L}$ 可得\n$$\n\\frac{L_d}{\\Delta x_0 / r^{L}} \\ge n \\quad \\Longrightarrow \\quad \\frac{L_d r^{L}}{\\Delta x_0} \\ge n.\n$$\n整理后得，\n$$\nr^{L} \\ge \\frac{n \\,\\Delta x_0}{L_d}.\n$$\n因为 $r>1$，函数 $L \\mapsto r^{L}$ 是严格递增的。对两边取自然对数，不等式方向保持不变，得到\n$$\nL \\,\\ln(r) \\ge \\ln\\!\\left(\\frac{n \\,\\Delta x_0}{L_d}\\right).\n$$\n两边除以 $\\ln(r)>0$ 可得\n$$\nL \\ge \\frac{\\ln\\!\\left(\\frac{n \\,\\Delta x_0}{L_d}\\right)}{\\ln(r)}.\n$$\n使用 $L_d = N H / f$，我们得到\n$$\n\\frac{n \\,\\Delta x_0}{L_d} = \\frac{n \\,\\Delta x_0}{N H / f} = \\frac{n \\, f \\,\\Delta x_0}{N H},\n$$\n因此不等式变为\n$$\nL \\ge \\frac{\\ln\\!\\left(\\frac{n \\, f \\,\\Delta x_0}{N H}\\right)}{\\ln(r)}.\n$$\n由于 $L$ 必须是表示加密级别数的非负整数，满足该不等式的最小 $L$ 是大于或等于右侧项的最小整数，但不能小于 $0$。这可以用向上取整函数 $\\lceil \\cdot \\rceil$ 和与 $0$ 取最大值来表示：\n$$\nL_{\\min} = \\max\\!\\left(0, \\left\\lceil \\frac{\\ln\\!\\left(\\frac{n \\, f \\,\\Delta x_0}{N H}\\right)}{\\ln(r)} \\right\\rceil \\right).\n$$\n该表达式确保如果基础网格已经满足准则，即如果 $n \\, f \\,\\Delta x_0 /(N H) \\le 1$，则 $L_{\\min}=0$；否则，它返回所需的最小整数加密级别数。",
            "answer": "$$\\boxed{\\max\\!\\left(0,\\left\\lceil \\dfrac{\\ln\\!\\left(\\dfrac{n f \\Delta x_{0}}{N H}\\right)}{\\ln(r)} \\right\\rceil\\right)}$$"
        },
        {
            "introduction": "当创建新的细网格时，必须通过一个称为“延拓”（prolongation）的过程，用其父级粗网格的数据对其进行初始化。简单的插值可能会违反物理守恒定律并降低解的精度。本实践将指导您推导一个二阶守恒的延拓算子模板，揭示AMR方案如何在保持底层数值方法基本原则的同时，在不同层级之间传递信息 。",
            "id": "4009052",
            "problem": "在数值天气预报 (NWP) 和气候模拟中，自适应网格加密 (AMR) 需要延拓算子既是守恒的，又至少是二阶精确的，以防止标量（如示踪物质量）的伪生或伪灭。考虑一个以原点为中心的有限体积粗网格单元，其在 $x$ 和 $y$ 方向上的均匀间距分别为 $\\Delta x_c$ 和 $\\Delta y_c$。设一个无量纲守恒标量场在粗网格层级上由粗网格单元平均值 $\\bar{q}_c$ 表示。假设在粗网格单元内进行双线性重构，形式如下\n$$\np(x,y) \\equiv \\bar{q}_c + S_x\\,x + S_y\\,y + S_{xy}\\,x\\,y,\n$$\n其中 $S_x$、$S_y$ 和 $S_{xy}$ 是局部一阶导数和混合项系数的二阶精确粗网格层级估算值，而 $(x,y)$ 是从粗网格单元中心测量的局部坐标，满足 $x \\in [-\\Delta x_c/2,\\,\\Delta x_c/2]$ 和 $y \\in [-\\Delta y_c/2,\\,\\Delta y_c/2]$。细网格层级是在每个空间方向上进行2倍加密，通过在 $x=0$ 和 $y=0$ 处分裂产生四个细子单元：东北 (NE) 子单元，$x \\in [0,\\,\\Delta x_c/2]$，$y \\in [0,\\,\\Delta y_c/2]$；西北 (NW) 子单元，$x \\in [-\\Delta x_c/2,\\,0]$，$y \\in [0,\\,\\Delta y_c/2]$；西南 (SW) 子单元，$x \\in [-\\Delta x_c/2,\\,0]$，$y \\in [-\\Delta y_c/2,\\,0]$；以及东南 (SE) 子单元，$x \\in [0,\\,\\Delta x_c/2]$，$y \\in [-\\Delta y_c/2,\\,0]$。\n\n仅使用单元平均值的有限体积定义和守恒原理，推导将粗网格单元平均值和双线性系数映射到四个细网格单元平均值的二阶守恒延拓模板，其定义如下：\n$$\n\\bar{q}_{R} \\equiv \\frac{1}{A_R} \\int_{R} p(x,y)\\, \\mathrm{d}A,\n$$\n对于每个区域 $R \\in \\{\\mathrm{NE},\\mathrm{NW},\\mathrm{SW},\\mathrm{SE}\\}$，其面积为 $A_R = (\\Delta x_c/2)(\\Delta y_c/2)$，且 $\\mathrm{d}A = \\mathrm{d}x\\,\\mathrm{d}y$。您的最终答案必须是关于 $\\bar{q}_{\\mathrm{NE}}$、$\\bar{q}_{\\mathrm{NW}}$、$\\bar{q}_{\\mathrm{SW}}$ 和 $\\bar{q}_{\\mathrm{SE}}$ 的显式解析表达式，用 $\\bar{q}_c$、$\\Delta x_c$、$\\Delta y_c$、$S_x$、$S_y$ 和 $S_{xy}$ 表示。将您的最终答案表示为单行矩阵，顺序为 $(\\bar{q}_{\\mathrm{NE}}, \\bar{q}_{\\mathrm{NW}}, \\bar{q}_{\\mathrm{SW}}, \\bar{q}_{\\mathrm{SE}})$。请精确表达您的答案；无需四舍五入或单位。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、自洽、一致且适定的。任务是为有限体积法推导二阶守恒延拓模板，该模板将粗网格单元平均值及其重构分布映射到四个细网格单元平均值。\n\n所使用的基本原理是守恒标量场 $q$ 的单元平均值定义。对于任何面积为 $A_R$ 的区域 $R$，单元平均值 $\\bar{q}_R$ 定义为该区域上标量场的积分除以该区域的面积：\n$$\n\\bar{q}_{R} \\equiv \\frac{1}{A_R} \\int_{R} q(x,y)\\, \\mathrm{d}A\n$$\n在这个问题中，粗网格单元内的标量场分布由双线性重构多项式 $p(x,y)$ 给出：\n$$\np(x,y) = \\bar{q}_c + S_x\\,x + S_y\\,y + S_{xy}\\,x\\,y\n$$\n粗网格单元以原点为中心，定义域为 $x \\in [-\\Delta x_c/2, \\Delta x_c/2]$ 和 $y \\in [-\\Delta y_c/2, \\Delta y_c/2]$。细网格是2倍加密的结果，产生四个子单元 (NE, NW, SW, SE)，每个子单元的面积为 $A_R = (\\Delta x_c/2)(\\Delta y_c/2) = \\frac{\\Delta x_c \\Delta y_c}{4}$。\n\n我们的目标是计算 $p(x,y)$ 在这四个子单元中每一个上的平均值。让我们将一个通用子单元区域表示为 $R$。其平均值为：\n$$\n\\bar{q}_{R} = \\frac{1}{A_R} \\int_{R} (\\bar{q}_c + S_x\\,x + S_y\\,y + S_{xy}\\,x\\,y)\\, \\mathrm{d}x\\,\\mathrm{d}y\n$$\n根据积分的线性性质，我们可以将各项分离：\n$$\n\\bar{q}_{R} = \\frac{1}{A_R} \\left( \\bar{q}_c \\int_{R} 1\\, \\mathrm{d}x\\,\\mathrm{d}y + S_x \\int_{R} x\\, \\mathrm{d}x\\,\\mathrm{d}y + S_y \\int_{R} y\\, \\mathrm{d}x\\,\\mathrm{d}y + S_{xy} \\int_{R} xy\\, \\mathrm{d}x\\,\\mathrm{d}y \\right)\n$$\n第一个积分 $\\int_{R} 1\\, \\mathrm{d}x\\,\\mathrm{d}y$ 就是该区域的面积 $A_R$。这可将表达式简化为：\n$$\n\\bar{q}_{R} = \\bar{q}_c + \\frac{S_x}{A_R} \\int_{R} x\\, \\mathrm{d}x\\,\\mathrm{d}y + \\frac{S_y}{A_R} \\int_{R} y\\, \\mathrm{d}x\\,\\mathrm{d}y + \\frac{S_{xy}}{A_R} \\int_{R} xy\\, \\mathrm{d}x\\,\\mathrm{d}y\n$$\n剩余的积分可以对一个面积为 $A_R = (x_2 - x_1)(y_2 - y_1)$ 的一般矩形区域 $[x_1, x_2] \\times [y_1, y_2]$ 进行求值。该矩形的形心为 $(\\bar{x}_R, \\bar{y}_R) = (\\frac{x_1+x_2}{2}, \\frac{y_1+y_2}{2})$。\n积分为：\n$$\n\\int_{R} x\\, \\mathrm{d}A = \\int_{y_1}^{y_2} \\int_{x_1}^{x_2} x\\, \\mathrm{d}x\\,\\mathrm{d}y = \\left[\\frac{x^2}{2}\\right]_{x_1}^{x_2} \\left[y\\right]_{y_1}^{y_2} = \\frac{x_2^2-x_1^2}{2}(y_2-y_1) = \\frac{(x_2-x_1)(x_2+x_1)}{2}(y_2-y_1) = A_R \\bar{x}_R\n$$\n$$\n\\int_{R} y\\, \\mathrm{d}A = \\int_{y_1}^{y_2} \\int_{x_1}^{x_2} y\\, \\mathrm{d}x\\,\\mathrm{d}y = (x_2-x_1)\\frac{y_2^2-y_1^2}{2} = A_R \\bar{y}_R\n$$\n$$\n\\int_{R} xy\\, \\mathrm{d}A = \\int_{y_1}^{y_2} \\int_{x_1}^{x_2} xy\\, \\mathrm{d}x\\,\\mathrm{d}y = \\left[\\frac{x^2}{2}\\right]_{x_1}^{x_2} \\left[\\frac{y^2}{2}\\right]_{y_1}^{y_2} = \\frac{x_2^2-x_1^2}{2} \\frac{y_2^2-y_1^2}{2} = (A_R \\bar{x}_R) \\bar{y}_R = A_R \\bar{x}_R \\bar{y}_R\n$$\n将这些结果代回 $\\bar{q}_R$ 的表达式，我们得到双线性多项式在任何矩形子区域 $R$ 上的平均值的通用公式：\n$$\n\\bar{q}_R = \\bar{q}_c + S_x \\bar{x}_R + S_y \\bar{y}_R + S_{xy} \\bar{x}_R \\bar{y}_R\n$$\n这个简洁的结果表明，细网格单元的平均值是通过在细网格单元的形心处计算导数项的贡献来确定的。现在我们将此公式应用于四个子单元，通过找到它们的形心。\n\n1.  **东北 (NE) 子单元**：$x \\in [0, \\Delta x_c/2]$，$y \\in [0, \\Delta y_c/2]$。\n    形心为 $(\\bar{x}_{\\mathrm{NE}}, \\bar{y}_{\\mathrm{NE}}) = (\\frac{0+\\Delta x_c/2}{2}, \\frac{0+\\Delta y_c/2}{2}) = (\\frac{\\Delta x_c}{4}, \\frac{\\Delta y_c}{4})$。\n    $$\n    \\bar{q}_{\\mathrm{NE}} = \\bar{q}_c + S_x \\left(\\frac{\\Delta x_c}{4}\\right) + S_y \\left(\\frac{\\Delta y_c}{4}\\right) + S_{xy} \\left(\\frac{\\Delta x_c}{4}\\right)\\left(\\frac{\\Delta y_c}{4}\\right) = \\bar{q}_c + \\frac{S_x \\Delta x_c}{4} + \\frac{S_y \\Delta y_c}{4} + \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}\n    $$\n\n2.  **西北 (NW) 子单元**：$x \\in [-\\Delta x_c/2, 0]$，$y \\in [0, \\Delta y_c/2]$。\n    形心为 $(\\bar{x}_{\\mathrm{NW}}, \\bar{y}_{\\mathrm{NW}}) = (\\frac{-\\Delta x_c/2+0}{2}, \\frac{0+\\Delta y_c/2}{2}) = (-\\frac{\\Delta x_c}{4}, \\frac{\\Delta y_c}{4})$。\n    $$\n    \\bar{q}_{\\mathrm{NW}} = \\bar{q}_c + S_x \\left(-\\frac{\\Delta x_c}{4}\\right) + S_y \\left(\\frac{\\Delta y_c}{4}\\right) + S_{xy} \\left(-\\frac{\\Delta x_c}{4}\\right)\\left(\\frac{\\Delta y_c}{4}\\right) = \\bar{q}_c - \\frac{S_x \\Delta x_c}{4} + \\frac{S_y \\Delta y_c}{4} - \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}\n    $$\n\n3.  **西南 (SW) 子单元**：$x \\in [-\\Delta x_c/2, 0]$，$y \\in [-\\Delta y_c/2, 0]$。\n    形心为 $(\\bar{x}_{\\mathrm{SW}}, \\bar{y}_{\\mathrm{SW}}) = (\\frac{-\\Delta x_c/2+0}{2}, \\frac{-\\Delta y_c/2+0}{2}) = (-\\frac{\\Delta x_c}{4}, -\\frac{\\Delta y_c}{4})$。\n    $$\n    \\bar{q}_{\\mathrm{SW}} = \\bar{q}_c + S_x \\left(-\\frac{\\Delta x_c}{4}\\right) + S_y \\left(-\\frac{\\Delta y_c}{4}\\right) + S_{xy} \\left(-\\frac{\\Delta x_c}{4}\\right)\\left(-\\frac{\\Delta y_c}{4}\\right) = \\bar{q}_c - \\frac{S_x \\Delta x_c}{4} - \\frac{S_y \\Delta y_c}{4} + \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}\n    $$\n\n4.  **东南 (SE) 子单元**：$x \\in [0, \\Delta x_c/2]$，$y \\in [-\\Delta y_c/2, 0]$。\n    形心为 $(\\bar{x}_{\\mathrm{SE}}, \\bar{y}_{\\mathrm{SE}}) = (\\frac{0+\\Delta x_c/2}{2}, \\frac{-\\Delta y_c/2+0}{2}) = (\\frac{\\Delta x_c}{4}, -\\frac{\\Delta y_c}{4})$。\n    $$\n    \\bar{q}_{\\mathrm{SE}} = \\bar{q}_c + S_x \\left(\\frac{\\Delta x_c}{4}\\right) + S_y \\left(-\\frac{\\Delta y_c}{4}\\right) + S_{xy} \\left(\\frac{\\Delta x_c}{4}\\right)\\left(-\\frac{\\Delta y_c}{4}\\right) = \\bar{q}_c + \\frac{S_x \\Delta x_c}{4} - \\frac{S_y \\Delta y_c}{4} - \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}\n    $$\n\n为验证此延拓模板的守恒性质，我们检查细网格单元平均值的平均值是否等于粗网格单元的平均值。\n$$\n\\frac{1}{4}(\\bar{q}_{\\mathrm{NE}} + \\bar{q}_{\\mathrm{NW}} + \\bar{q}_{\\mathrm{SW}} + \\bar{q}_{\\mathrm{SE}}) = \\frac{1}{4} \\left( 4\\bar{q}_c \\right)\n+ \\frac{1}{4}\\frac{S_x \\Delta x_c}{4}(1 - 1 - 1 + 1)\n+ \\frac{1}{4}\\frac{S_y \\Delta y_c}{4}(1 + 1 - 1 - 1)\n+ \\frac{1}{4}\\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}(1 - 1 + 1 - 1)\n$$\n$$\n= \\bar{q}_c + 0 + 0 + 0 = \\bar{q}_c\n$$\n由于细网格单元平均值的平均值等于粗网格单元平均值，因此该过程是守恒的。推导出的表达式构成了所求的延拓模板。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\bar{q}_c + \\frac{S_x \\Delta x_c}{4} + \\frac{S_y \\Delta y_c}{4} + \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16} & \\bar{q}_c - \\frac{S_x \\Delta x_c}{4} + \\frac{S_y \\Delta y_c}{4} - \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16} & \\bar{q}_c - \\frac{S_x \\Delta x_c}{4} - \\frac{S_y \\Delta y_c}{4} + \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16} & \\bar{q}_c + \\frac{S_x \\Delta x_c}{4} - \\frac{S_y \\Delta y_c}{4} - \\frac{S_{xy} \\Delta x_c \\Delta y_c}{16}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了最大限度地提高效率，AMR模拟通常采用时间子循环（time subcycling），即细网格比粗网格使用更小的时间步长演化。这种交错演化需要一系列复杂的同步和数据交换操作，以在所有层级上维持一个一致且守恒的解。本练习要求您详细规划一个三层AMR系统精确的时间调度，确定延拓（prolongation）、限制（restriction）和通量重通（flux refluxing）等关键操作必须发生的确切时刻 。",
            "id": "4009024",
            "problem": "考虑一个用于双曲守恒律有限体积离散化的块结构自适应网格加密（AMR）层次结构，其层级为 $\\ell=0,1,2$。假设在时间上采用子循环，连续层级之间的加密比恒为 $r=2$，且基础（最粗）时间步长为 $\\Delta t_0$。该离散化是守恒的，并在每个层级的每个时间步长上使用面积分的面通量。由 Courant–Friedrichs–Lewy (CFL) 条件给出的稳定性要求强制规定，加密层级上的时间步长相对于较粗层级必须充分减小，并且每个加密层级在其父层级的一个时间步长区间内执行 $r$ 个子步。所有层级都从绝对时间 $t=0$ 开始，积分推进直到绝对时间 $t=3\\,\\Delta t_0$。\n\n您需要根据以上基础和离散守恒结构进行推理，以确定三个层级间子循环的时间协调。具体而言：\n- 计算在 $[0,3\\,\\Delta t_0]$ 时间区间内，层级 $\\ell=2$ 与层级 $\\ell=1$ 同步、层级 $\\ell=1$ 与层级 $\\ell=0$ 同步，以及所有三个层级 $\\ell=0,1,2$ 同时同步的完整、有序的时间序列。\n- 通过列出 $[0，3\\,\\Delta t_0]$ 内对应的绝对时间，确定必须发生回流（refluxing）的时刻。回流是在细层级完成了足够多的子步以达到粗层级的时间后，为在粗细网格界面上强制实现离散守恒而应用的通量修正操作。\n- 通过列出 $[0，3\\,\\Delta t_0]$ 内对应的绝对时间，确定必须发生从层级 $\\ell=2$ 到层级 $\\ell=1$ 以及从层级 $\\ell=1$ 到层级 $\\ell=0$ 的限制（restriction，将细层级单元的平均值降采样到下一个更粗的层级）的时刻。\n- 通过列出 $[0-3\\,\\Delta t_0]$ 内对应的绝对时间，确定层级 $\\ell=1$ 和层级 $\\ell=2$ 必须发生延拓（prolongation，将粗层级状态插值到细层级的虚拟单元中，以在细层级推进前初始化和填充边界数据）的时刻，这被解释为 $[0,3\\,\\Delta t_0]$ 内每个细层级子步的开始时间。\n\n所有时间都用 $\\Delta t_0$ 符号表示。将您的最终答案表示为一个单行矩阵，其条目按顺序分别为以下各项的时间集合：\n1. 层级 $\\ell=2$ 与层级 $\\ell=1$ 同步的时间，\n2. 层级 $\\ell=1$ 与层级 $\\ell=0$ 同步的时间，\n3. 所有层级 $\\ell=0,1,2$ 同步的时间，\n4. 回流事件的时间，\n5. 从层级 $\\ell=2$ 到层级 $\\ell=1$ 的限制事件的时间，\n6. 从层级 $\\ell=1$ 到层级 $\\ell=0$ 的限制事件的时间，\n7. 层级 $\\ell=1$ 的延拓事件的时间，\n8. 层级 $\\ell=2$ 的延拓事件的时间。\n\n无需舍入。将最终答案表示为关于 $\\Delta t_0$ 的精确符号集合，不带单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤1：提取给定条件\n- 具有层级 $\\ell=0,1,2$ 的 AMR 层次结构。\n- 双曲守恒律的有限体积离散化。\n- 时间上的子循环。\n- 恒定的加密比 $r=2$。\n- 基础（最粗）时间步长为 $\\Delta t_0$。\n- 离散化是守恒的并使用面通量。\n- CFL 条件决定了加密层级上的时间步长缩减。\n- 每个加密层级在一个父层级步长内执行 $r$ 个子步。\n- 所有层级从绝对时间 $t=0$ 开始。\n- 积分推进到绝对时间 $t=3\\,\\Delta t_0$。\n- 需要分析的操作：同步、回流、限制、延拓。\n- 输出要求：八个有序的时间集合，以 $\\Delta t_0$ 的符号形式表示。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学基础**：该问题在偏微分方程数值分析领域有坚实的科学基础。块结构自适应网格加密（AMR）、子循环、CFL 条件、回流（通量修正）、限制和延拓等概念是已建立算法（如用于双曲系统的 Berger-Oliger 方法）的标准组成部分。该设置在科学上是合理的，并描述了物理和工程领域模拟中典型的高性能计算场景。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（层级数、加密比 $r$、基础时间步长 $\\Delta t_0$ 和总积分时间），以唯一确定所有指定 AMR 操作的时间序列。问题是精确的，并能导出一个唯一的、可确定的解。\n- **客观性**：问题使用计算科学中常见的客观、技术性语言陈述。没有主观或模糊的陈述。\n- **缺陷清单**：该问题不违反任何无效性标准。它科学合理、可形式化、完整、现实、适定且并非无足轻重。\n\n### 步骤3：结论与行动\n该问题被判定为 **有效**。将推导解答。\n\n### 解答推导\n\n该问题要求确定在一个采用子循环的块结构 AMR 算法中，关键操作发生的确切时间。该层次结构包含三个层级 $\\ell=0, 1, 2$，连续层级之间在时间和空间上的加密比均为 $r=2$。\n\n首先，我们确定每个层级的时间步长。基础时间步长为 $\\Delta t_0$，对应层级 $\\ell=0$。由于加密比为 $r=2$，更精细层级的时间步长为：\n- 层级 $\\ell=1$ 的时间步长：$\\Delta t_1 = \\frac{\\Delta t_0}{r} = \\frac{\\Delta t_0}{2}$。\n- 层级 $\\ell=2$ 的时间步长：$\\Delta t_2 = \\frac{\\Delta t_1}{r} = \\frac{\\Delta t_0}{r^2} = \\frac{\\Delta t_0}{4}$。\n\n总积分时间为 $T = 3\\,\\Delta t_0$。子循环过程规定，对于粗层级的每一步，下一个更细的层级必须完成 $r$ 个子步以覆盖相同的时间间隔。模拟通过以大小为 $\\Delta t_0$ 的三个步长推进最粗层级 $\\ell=0$ 来进行。\n\n现在我们将在区间 $[0, 3\\,\\Delta t_0]$ 内确定每个指定操作的时间序列。\n\n**1. 同步时间：层级 $\\ell=2$ 与层级 $\\ell=1$**\n层级 $\\ell=2$ 必须在其父层级 $\\ell=1$ 的每个时间步结束时与之同步。这发生在 $\\Delta t_1$ 的整数倍时刻。时间点为 $t_k = k\\,\\Delta t_1 = k\\,\\frac{\\Delta t_0}{2}$。由于模拟从 $t=0$ 运行到 $t=3\\,\\Delta t_0 = 6\\,\\Delta t_1$，同步时间对应于 $k=0, 1, 2, 3, 4, 5, 6$。包含 $t=0$ 反映了所有层级的初始同步状态。\n时间集合为：$\\{0, \\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\}$。\n\n**2. 同步时间：层级 $\\ell=1$ 与层级 $\\ell=0$**\n类似地，层级 $\\ell=1$ 在其父层级 $\\ell=0$ 的每个时间步结束时与之同步。这发生在 $\\Delta t_0$ 的整数倍时刻。时间点为 $t_k = k\\,\\Delta t_0$。由于模拟运行到 $t=3\\,\\Delta t_0$，同步时间对应于 $k=0, 1, 2, 3$。\n时间集合为：$\\{0, \\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\}$。\n\n**3. 同步时间：所有层级 ($\\ell=0, 1, 2$)**\n所有三个层级同时同步，当且仅当层级 $\\ell=1$ 与 $\\ell=0$ 同步且层级 $\\ell=2$ 与 $\\ell=1$ 同步。这对应于上面推导的两个时间集合的交集。$\\{k\\,\\frac{\\Delta t_0}{2} \\mid k \\in \\{0,..,6\\}\\}$ 和 $\\{k\\,\\Delta t_0 \\mid k \\in \\{0,..,3\\}\\}$ 的交集是层级 $\\ell=0$ 的时间集合。\n时间集合为：$\\{0, \\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\}$。\n\n**4. 回流时间**\n回流是一种通量修正，在细层级推进到与粗层级相同的时间后，应用于粗细网格界面，以确保离散守恒。它是在一个循环结束时执行的操作，因此它发生在 $t > 0$ 的时刻。\n- **L2/L1 界面**：从 $\\ell=2$到$\\ell=1$的回流发生在每个$\\ell=1$时间步的结束时刻，即在时间点 $k\\,\\Delta t_1$ (其中$k=1, ..., 6$)。时间点为：$\\{\\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\}$。\n- **L1/L0 界面**：从 $\\ell=1$到$\\ell=0$的回流发生在每个$\\ell=0$时间步的结束时刻，即在时间点 $k\\,\\Delta t_0$ (其中$k=1, 2, 3$)。时间点为：$\\{\\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\}$。\n问题要求一个单一的回流时间集合。这意味着所有发生回流操作的时间的并集。\n时间集合是上述两个集合的并集：$\\{\\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\}$。\n\n**5. 限制时间：层级 $\\ell=2$到层级 $\\ell=1$**\n限制是将细网格数据平均到其下的粗网格单元上。这发生在细网格推进后，于与粗网格同步的时刻。对于 $\\ell=2 \\rightarrow \\ell=1$，这发生在每个层级 $\\ell=1$ 时间步的结束时刻（对于 $t>0$）。\n时间集合与 L2/L1 回流时间相同：$\\{\\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\}$。\n\n**6. 限制时间：层级 $\\ell=1$到层级 $\\ell=0$**\n类似地，从 $\\ell=1 \\rightarrow \\ell=0$ 的限制发生在每个层级 $\\ell=0$ 时间步的结束时刻（对于 $t > 0$）。\n时间集合为：$\\{\\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\}$。\n\n**7. 层级 $\\ell=1$ 的延拓 时间**\n延拓通过从父层级插值来为细层级提供边界数据。这必须在每个细层级时间步的开始时完成。层级 $\\ell=1$ 以大小为 $\\Delta t_1$ 的步长推进。总区间 $[0, 3\\Delta t_0]$ 对应于 $[0, 6\\Delta t_1]$。层级 $\\ell=1$ 的时间步为 $[k\\Delta t_1, (k+1)\\Delta t_1]$，其中 $k=0, 1, 2, 3, 4, 5$。在每个这些区间的开始都需要进行延拓。\n时间集合为：$\\{0, \\Delta t_1, 2\\Delta t_1, 3\\Delta t_1, 4\\Delta t_1, 5\\Delta t_1\\}$，即 $\\{0, \\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0\\}$。\n\n**8. 层级 $\\ell=2$ 的延拓 时间**\n层级 $\\ell=2$ 以大小为 $\\Delta t_2$ 的步长推进。总区间 $[0, 3\\Delta t_0]$ 对应于 $[0, 12\\Delta t_2]$。层级 $\\ell=2$ 的时间步为 $[k\\Delta t_2, (k+1)\\Delta t_2]$，其中 $k=0, 1, ..., 11$。在每个这些区间的开始都需要进行延拓。时间点为 $t_k = k\\,\\Delta t_2 = k\\,\\frac{\\Delta t_0}{4}$，其中 $k=0, 1, ..., 11$。\n时间集合为：$\\{0, \\frac{1}{4}\\Delta t_0, \\frac{2}{4}\\Delta t_0, \\frac{3}{4}\\Delta t_0, \\frac{4}{4}\\Delta t_0, \\frac{5}{4}\\Delta t_0, \\frac{6}{4}\\Delta t_0, \\frac{7}{4}\\Delta t_0, \\frac{8}{4}\\Delta t_0, \\frac{9}{4}\\Delta t_0, \\frac{10}{4}\\Delta t_0, \\frac{11}{4}\\Delta t_0\\}$。\n简化分数后得到：$\\{0, \\frac{1}{4}\\Delta t_0, \\frac{1}{2}\\Delta t_0, \\frac{3}{4}\\Delta t_0, \\Delta t_0, \\frac{5}{4}\\Delta t_0, \\frac{3}{2}\\Delta t_0, \\frac{7}{4}\\Delta t_0, 2\\Delta t_0, \\frac{9}{4}\\Delta t_0, \\frac{5}{2}\\Delta t_0, \\frac{11}{4}\\Delta t_0\\}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\{0, \\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\} & \\{0, \\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\} & \\{0, \\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\} & \\{\\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\} & \\{\\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0, 3\\Delta t_0\\} & \\{\\Delta t_0, 2\\Delta t_0, 3\\Delta t_0\\} & \\{0, \\frac{1}{2}\\Delta t_0, \\Delta t_0, \\frac{3}{2}\\Delta t_0, 2\\Delta t_0, \\frac{5}{2}\\Delta t_0\\} & \\{0, \\frac{1}{4}\\Delta t_0, \\frac{1}{2}\\Delta t_0, \\frac{3}{4}\\Delta t_0, \\Delta t_0, \\frac{5}{4}\\Delta t_0, \\frac{3}{2}\\Delta t_0, \\frac{7}{4}\\Delta t_0, 2\\Delta t_0, \\frac{9}{4}\\Delta t_0, \\frac{5}{2}\\Delta t_0, \\frac{11}{4}\\Delta t_0\\} \\end{pmatrix}}$$"
        }
    ]
}