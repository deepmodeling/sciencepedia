{
    "hands_on_practices": [
        {
            "introduction": "Regional climate models operate over limited geographical areas, making them critically dependent on the information supplied at their lateral boundaries. A fundamental question in designing and interpreting any limited-area simulation is how long boundary-derived information persists as it travels across the domain. This exercise  provides a first-principles approach to this question by having you calculate the advective transit time, $t_{\\mathrm{in}}$, which serves as a crucial baseline for the model's 'memory' of its boundary conditions.",
            "id": "4081150",
            "problem": "A Limited-Area Model (LAM) used in a regional climate modeling system is configured over a zonal domain of length $L = 2000\\,\\mathrm{km}$. Assume a passive scalar is advected by a spatially uniform and steady horizontal wind with magnitude $U = 10\\,\\mathrm{m\\,s^{-1}}$ entering at the western lateral boundary. Starting from the kinematic definition of advection and without invoking any pre-derived \"timescale\" formulas, derive the expression for the inflow transit time $t_{\\mathrm{in}}$ required for an air parcel to travel from the inflow boundary to the opposite boundary under these assumptions. Then, compute $t_{\\mathrm{in}}$ for the given $L$ and $U$, and express the final numerical value in hours. Round your final numerical answer to four significant figures.\n\nFinally, based on fundamental dynamical considerations, briefly explain how the magnitude of $t_{\\mathrm{in}}$ constrains the memory of lateral boundary conditions in a limited-area model and under what dynamical circumstances the effective memory could be shorter or longer than $t_{\\mathrm{in}}$, without using any heuristic or shortcut formulas.",
            "solution": "The starting point is the kinematic definition of advection for a parcel in a spatially uniform and steady horizontal wind. Let $x(t)$ denote the parcel position along the zonal axis aligned with the mean wind, and let the inflow boundary be at $x = 0$ and the opposite boundary at $x = L$. The motion of the parcel is governed by\n$$\n\\frac{dx}{dt} = U,\n$$\nwhere $U$ is the constant zonal wind speed. This ordinary differential equation states that the rate of change of position with respect to time is equal to the constant advective speed, reflecting the fundamental definition of uniform rectilinear motion.\n\nIntegrating this equation with respect to time from the inflow location $x(0) = 0$ to the outflow location $x(t_{\\mathrm{in}}) = L$, we have\n$$\n\\int_{x(0)=0}^{x(t_{\\mathrm{in}})=L} dx = \\int_{t=0}^{t=t_{\\mathrm{in}}} U\\, dt,\n$$\nwhich yields\n$$\nL = U\\, t_{\\mathrm{in}}.\n$$\nSolving for the inflow transit time gives\n$$\nt_{\\mathrm{in}} = \\frac{L}{U}.\n$$\n\nWe now compute $t_{\\mathrm{in}}$ for the given parameters. First, convert the domain length to meters to be consistent with the wind speed expressed in meters per second:\n$$\nL = 2000\\,\\mathrm{km} = 2000 \\times 10^{3}\\,\\mathrm{m} = 2.0 \\times 10^{6}\\,\\mathrm{m}.\n$$\nThe wind speed is\n$$\nU = 10\\,\\mathrm{m\\,s^{-1}}.\n$$\nThus,\n$$\nt_{\\mathrm{in}} = \\frac{2.0 \\times 10^{6}\\,\\mathrm{m}}{10\\,\\mathrm{m\\,s^{-1}}} = 2.0 \\times 10^{5}\\,\\mathrm{s}.\n$$\nTo express this in hours, use $1\\,\\mathrm{h} = 3600\\,\\mathrm{s}$:\n$$\nt_{\\mathrm{in,\\,h}} = \\frac{2.0 \\times 10^{5}\\,\\mathrm{s}}{3600\\,\\mathrm{s\\,h^{-1}}} = \\frac{200000}{3600}\\,\\mathrm{h} = 55.\\overline{5}\\,\\mathrm{h}.\n$$\nRounding to four significant figures gives\n$$\nt_{\\mathrm{in,\\,h}} \\approx 55.56\\,\\mathrm{h}.\n$$\n\nImplications for memory of lateral boundary conditions in a Limited-Area Model (LAM): The time $t_{\\mathrm{in}}$ represents an advective timescale over which boundary-imposed anomalies or information can traverse the domain through mean flow advection. In a purely advective, steady, and uniform flow, interior fields downstream of the inflow boundary retain direct influence from lateral boundary conditions over a timescale on the order of $t_{\\mathrm{in}}$, because parcels entering at the boundary continue to advect their properties across the domain.\n\nHowever, the effective memory can be shorter or longer than $t_{\\mathrm{in}}$ depending on the dynamical regime:\n- Shorter than $t_{\\mathrm{in}}$: If fast-propagating disturbances such as gravity waves transmit boundary information at speeds exceeding $U$, interior adjustments can occur on timescales smaller than $\\frac{L}{U}$. Additionally, strong internal dynamics (e.g., deep convection, baroclinic instability) can rapidly alter parcel properties, diminishing the direct advective memory of boundary conditions.\n- Longer than $t_{\\mathrm{in}}$: If the mean flow is weak, blocked, or recirculating, or if the domain geometry and internal forcing (e.g., terrain-induced stationary waves) trap anomalies, the interior can continue to reflect boundary-imposed conditions beyond a single advective crossing time. Also, if lateral boundary relaxation (e.g., spectral nudging or relaxation zones) is weak or confined, interior solutions may retain features longer than the nominal advective timescale.\nTherefore, $\\frac{L}{U}$ provides a first-principles baseline for the advective memory, modulated by wave propagation, diabatic processes, diffusion, and internal variability that can either accelerate interior adjustments or prolong residence of boundary-forced signals.",
            "answer": "$$\\boxed{55.56}$$"
        },
        {
            "introduction": "A key advantage of Regional Climate Models is their ability to resolve fine-scale surface features like mountains, which requires a vertical coordinate system that follows the terrain. However, this elegant solution introduces a notorious numerical challenge: the spurious pressure gradient force error over steep slopes. This practice  delves into the heart of this issue, guiding you to derive a scaling estimate for this error and design a practical terrain-smoothing strategy to mitigate it, offering insight into the delicate balance between physical representation and numerical accuracy.",
            "id": "4081110",
            "problem": "Consider a terrain-following (sigma) vertical coordinate used in a Regional Climate Model (RCM) designed for Numerical Weather Prediction (NWP) and climate simulations. Assume an isothermal, dry atmosphere in hydrostatic balance. The hydrostatic relation is $ \\frac{\\partial p}{\\partial z} = - \\rho g $, and the ideal gas law is $ p = \\rho R_{d} T $, where $ p $ is pressure, $ \\rho $ is air density, $ g $ is gravitational acceleration, $ R_{d} $ is the gas constant for dry air, and $ T $ is temperature. For an isothermal atmosphere, the pressure profile is $ p(z) = p_{0} \\exp(-z/H) $ with scale height $ H = \\frac{R_{d} T}{g} $. Across adjacent columns at the same sigma level, the geometric height differs due to terrain slope. Consider a uniform terrain slope $ m = \\frac{\\partial z_{s}}{\\partial x} = 0.2 $ over grid spacing $ \\Delta x = 1.0 \\times 10^{3}\\ \\mathrm{m} $, such that the height offset between adjacent columns is $ \\Delta z_{s} = m \\Delta x $. In a perfectly resting isothermal atmosphere, the continuous horizontal pressure-gradient force cancels exactly with metric terms associated with the sloping coordinate surfaces, but discrete finite differences introduce a residual spurious horizontal acceleration.\n\nStarting from the hydrostatic and ideal gas relations, derive a leading-order scaling estimate for the spurious horizontal pressure-gradient acceleration magnitude as a function of $ g $, $ H $, $ m $, and $ \\Delta x $. Then, design a terrain-smoothing strategy using a one-dimensional explicit Laplacian filter applied to the terrain field $ z_{s}(x) $:\n$$ z_{s}^{(n+1)}(i) = z_{s}^{(n)}(i) + \\alpha \\left[z_{s}^{(n)}(i+1) - 2 z_{s}^{(n)}(i) + z_{s}^{(n)}(i-1)\\right], $$\nwhere $ \\alpha $ is the smoothing coefficient, $ i $ indexes grid points, and $ n $ is the iteration index. For a sinusoidal terrain $ z_{s}(x) = A \\sin\\left(\\frac{2\\pi x}{L}\\right) $ with wavelength $ L = 1.0 \\times 10^{4}\\ \\mathrm{m} $, the filter reduces the amplitude (and thus the slope amplitude) by a factor per pass given by\n$$ F = 1 - 4 \\alpha \\sin^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right). $$\nAssume $ H = 8.0 \\times 10^{3}\\ \\mathrm{m} $, $ g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2} $, $ \\alpha = 0.25 $, and require the post-smoothing spurious acceleration to be below the threshold $ a_{\\mathrm{thr}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-2} $. Compute the minimal integer number of smoothing iterations $ N $ such that the filtered slope amplitude $ m_{\\mathrm{new}} = F^{N} m $ satisfies your derived threshold condition. Express only the minimal integer $ N $ in your final answer. If any numerical approximation is needed in intermediate steps, carry it through consistently, but the final reported $ N $ must be the minimal integer that meets the requirement.",
            "solution": "**Part 1: Derivation of Spurious Acceleration Scaling**\n\nIn a resting, hydrostatic atmosphere, the true horizontal pressure-gradient force (PGF) is zero. In a terrain-following coordinate system $(\\sigma)$, the discrete PGF calculation introduces a spurious acceleration, $a_s$. This error arises from the finite-difference approximation of two terms that should analytically cancel. Let two adjacent grid points, $i$ and $i+1$, at the same $\\sigma$-level have a vertical separation of $\\Delta z$. The spurious acceleration is:\n$$ a_s \\approx -\\frac{1}{\\bar{\\rho}\\Delta x}\\left[p(z+\\Delta z) - p(z)\\right] + \\frac{g \\Delta z}{\\Delta x} $$\nA Taylor series expansion of $p(z+\\Delta z)$ around $z$ gives:\n$$ p(z+\\Delta z) \\approx p(z) + \\frac{dp}{dz}\\Delta z + \\frac{1}{2}\\frac{d^2p}{dz^2}(\\Delta z)^2 + O((\\Delta z)^3) $$\nSubstituting this into the expression for $a_s$ and using the hydrostatic relation $\\frac{dp}{dz} = -\\rho g$ (which cancels the first-order term with $g \\Delta z / \\Delta x$), the leading-order residual is:\n$$ a_s \\approx -\\frac{1}{2\\rho \\Delta x} \\frac{d^2p}{dz^2}(\\Delta z)^2 $$\nFor an isothermal atmosphere with scale height $H$, the pressure profile is $p(z) = p_0 \\exp(-z/H)$. The second derivative is $\\frac{d^2p}{dz^2} = \\frac{1}{H^2}p(z)$. Substituting this and using the ideal gas law in the form $p/\\rho = gH$:\n$$ a_s \\approx -\\frac{1}{2\\rho \\Delta x} \\frac{p}{H^2}(\\Delta z)^2 = -\\frac{gH}{2 \\Delta x} \\frac{(\\Delta z)^2}{H^2} = -\\frac{g(\\Delta z)^2}{2H \\Delta x} $$\nThe height difference $\\Delta z$ is related to the terrain slope $m$ and grid spacing $\\Delta x$ by $\\Delta z \\approx m \\Delta x$. Thus, the magnitude of the spurious acceleration scales as:\n$$ |a_s| \\approx \\frac{g m^2 \\Delta x}{2H} $$\n\n**Part 2: Calculation of Smoothing Iterations**\n\nWe need to find the minimum integer number of iterations, $N$, such that the post-smoothing spurious acceleration is below the threshold $a_{\\mathrm{thr}}$. After $N$ iterations, the new slope is $m_{\\text{new}} = m F^N$. The condition is:\n$$ \\frac{g (m F^N)^2 \\Delta x}{2H}  a_{\\text{thr}} \\implies F^{2N}  \\frac{2 H a_{\\text{thr}}}{g m^2 \\Delta x} $$\nSolving for $N$ (and noting $\\ln(F)$ is negative, which reverses the inequality):\n$$ N > \\frac{1}{2\\ln(F)} \\ln\\left(\\frac{2H a_{\\text{thr}}}{g m^2 \\Delta x}\\right) $$\nThe reduction factor $F$ for a sinusoidal terrain component is $F = 1 - 4 \\alpha \\sin^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right)$. Given $\\alpha = 0.25$, this simplifies to $F = \\cos^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right)$.\nSubstituting the given values:\n$g = 9.81\\,\\mathrm{m\\,s^{-2}}$, $H = 8.0 \\times 10^3\\,\\mathrm{m}$, $m = 0.2$, $\\Delta x = 1.0 \\times 10^3\\,\\mathrm{m}$, $a_{\\mathrm{thr}} = 1.0 \\times 10^{-3}\\,\\mathrm{m\\,s^{-2}}$, $L = 1.0 \\times 10^4\\,\\mathrm{m}$.\n$$ F = \\cos^2\\left(\\frac{\\pi \\times 10^3}{10^4}\\right) = \\cos^2\\left(\\frac{\\pi}{10}\\right) $$\n$$ \\frac{2 H a_{\\text{thr}}}{g m^2 \\Delta x} = \\frac{2(8.0 \\times 10^3)(1.0 \\times 10^{-3})}{(9.81)(0.2)^2(1.0 \\times 10^3)} = \\frac{16}{392.4} \\approx 0.04077 $$\n$$ N > \\frac{\\ln(0.04077)}{2\\ln\\left(\\cos^2\\left(\\frac{\\pi}{10}\\right)\\right)} = \\frac{\\ln(0.04077)}{4\\ln\\left(\\cos\\left(\\frac{\\pi}{10}\\right)\\right)} \\approx \\frac{-3.1997}{4(-0.05017)} \\approx \\frac{-3.1997}{-0.20068} \\approx 15.944 $$\nSince $N$ must be an integer, the minimal number of iterations is $N = 16$.",
            "answer": "$$\\boxed{16}$$"
        },
        {
            "introduction": "Even the most sophisticated Regional Climate Models exhibit systematic biases when their output is compared to historical observations. Before this output can be used for climate impact studies, these biases must be corrected through statistical post-processing. This exercise  introduces quantile mapping, a powerful and widely-used bias correction technique that adjusts the statistical distribution of model output to match that of an observational reference, thereby enhancing the credibility and utility of climate projections.",
            "id": "4081132",
            "problem": "In a bias-correction workflow for a Regional Climate Model (RCM), the daily precipitation variable is corrected using quantile mapping relative to an observational reference climatology. Let the modeled daily precipitation on a given day be a realization of a random variable with cumulative distribution function (CDF) denoted by $F_{m}(x)$, and let the observational reference daily precipitation be a random variable with CDF denoted by $F_{o}(x)$. Assume $F_{o}(x)$ is strictly increasing on the support of positive precipitation, so that its inverse exists there. The corrected precipitation is defined as the value in the observational space that has the same rank (quantile) as the modeled value.\n\nStarting from the foundational definition of the cumulative distribution function $F(x)=\\Pr\\{X\\leq x\\}$ and the probability integral transform, explain why mapping a modeled realization $x_{m}$ to $y$ such that $y$ has the same CDF value under $F_{o}$ as $x_{m}$ has under $F_{m}$ yields a corrected variable whose marginal distribution matches $F_{o}$. Then compute the corrected precipitation for a daily modeled realization whose modeled CDF rank satisfies $F_{m}(x_{m})=0.8$ and for which the observational inverse CDF satisfies $F_{o}^{-1}(0.8)=12\\ \\mathrm{mm}$.\n\nExpress your final corrected precipitation in $\\mathrm{mm}$ and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "**Part 1: Theoretical Explanation**\n\nQuantile mapping transforms a modeled random variable $X_m$ into a corrected variable $Y$ whose cumulative distribution function (CDF) matches that of an observational reference variable $X_o$. Let the respective CDFs be $F_m$ and $F_o$. The transformation is defined by equating quantiles:\n$$ F_o(y) = F_m(x_m) $$\nwhere $x_m$ is a realization of $X_m$ and $y$ is the corresponding corrected value. Assuming $F_o$ is invertible, the transformation is explicitly $Y = F_o^{-1}(F_m(X_m))$.\n\nTo prove that the CDF of $Y$, denoted $F_Y(y)$, is equal to $F_o(y)$, we start with the definition of the CDF of Y:\n$$ F_Y(y) = \\Pr\\{Y \\le y\\} = \\Pr\\{F_o^{-1}(F_m(X_m)) \\le y\\} $$\nSince $F_o$ is a strictly increasing function (a property of CDFs for continuous variables, which allows for an inverse), we can apply it to both sides of the inequality:\n$$ F_Y(y) = \\Pr\\{F_m(X_m) \\le F_o(y)\\} $$\nBy the probability integral transform (PIT), the random variable $U = F_m(X_m)$ is uniformly distributed on the interval $[0, 1]$, i.e., $U \\sim \\mathcal{U}[0, 1]$. The CDF of a standard uniform variable is $F_U(u) = u$ for $u \\in [0, 1]$.\nOur expression becomes:\n$$ F_Y(y) = \\Pr\\{U \\le F_o(y)\\} = F_U(F_o(y)) $$\nSince the value of $F_o(y)$ is a probability in $[0, 1]$, we have:\n$$ F_Y(y) = F_o(y) $$\nThis confirms that the corrected variable $Y$ has the same marginal distribution as the observational reference $X_o$.\n\n**Part 2: Numerical Calculation**\n\nThe problem provides a modeled realization $x_m$ whose rank (CDF value) is:\n$$ F_m(x_m) = 0.8 $$\nThe corrected precipitation value, $y$, is found using the quantile mapping formula:\n$$ y = F_o^{-1}(F_m(x_m)) = F_o^{-1}(0.8) $$\nThe problem states that the inverse observational CDF at this rank is:\n$$ F_o^{-1}(0.8) = 12\\ \\mathrm{mm} $$\nTherefore, the corrected precipitation is $12\\ \\mathrm{mm}$.\nRounding to four significant figures as requested gives:\n$$ y = 12.00\\ \\mathrm{mm} $$",
            "answer": "$$ \\boxed{12.00} $$"
        }
    ]
}