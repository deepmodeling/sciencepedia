{
    "hands_on_practices": [
        {
            "introduction": "超参数化方法的一个主要挑战是其巨大的计算成本。本练习将通过计算显式时间积分方案的稳定性约束，来探究这一挑战的根源。你将发现，嵌入的云解析模型（CRM）中的快速、小尺度过程，特别是垂直传播的波动，决定了整个耦合系统的时间步长，导致步长非常小，从而使得计算异常昂贵 。",
            "id": "4096898",
            "problem": "在一个超参数化数值天气和气候模型中，主全球气候模型 (GCM) 的每个网格柱都包含一个嵌入的二维云解析模型 (CRM)，该模型被显式积分且没有方向分裂。CRM 解析内重力波和平流。大尺度的 GCM 动力学也包含快速外重力波。\n\n从应用于线性化双曲动力学（平流和重力波传播）的显式时间步长法的 Courant–Friedrichs–Lewy (CFL) 稳定性条件出发，通过识别相关的特征速度和网格间距，推导 CRM 垂直和水平方向以及大尺度 GCM 水平动力学所允许的显式时间步长。然后，确定耦合的超参数化系统必须遵守的单一限制性显式时间步长（即 CRM 垂直约束、CRM 水平约束和主 GCM 水平约束中的最小值）。\n\n使用以下科学上合理的参数：\n- CRM 最快内重力波相速度：$c_{g} = 48 \\,\\text{m s}^{-1}$。\n- CRM 垂直网格间距：$\\Delta z = 32 \\,\\text{m}$。\n- CRM 水平网格间距：$\\Delta x = 1000 \\,\\text{m}$。\n- CRM 解析的最大水平平流速度：$U_{\\max} = 22 \\,\\text{m s}^{-1}$。\n- GCM 水平网格间距：$\\Delta X = 25000 \\,\\text{m}$。\n- GCM 最快外重力波速度：$c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$。\n\n假设显式格式要求在每个方向上，基于该方向上存在的最大特征速度计算的 Courant 数小于 1，并且耦合格式使用一个单一的全局显式时间步长，该步长必须同时满足所有方向和分量的约束。计算限制性显式时间步长 $\\delta t_{\\text{lim}}$。以秒为单位表示最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求确定一个超参数化数值模型的限制性显式时间步长，该模型由一个主全球气候模型 (GCM) 和嵌入的云解析模型 (CRM) 组成。显式时间步长格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定。\n\n对于描述平流和波传播等过程的一维线性双曲偏微分方程，CFL 条件指出，数值依赖域必须包含物理依赖域。对于一个简单的显式有限差分格式，这可以用 Courant 数 $C$ 来表示。该条件通常表示为 $C \\le 1$。Courant 数定义为：\n$$C = \\frac{v_{\\text{char}} \\delta t}{\\delta s}$$\n其中 $v_{\\text{char}}$ 是传播最快信号的特征速度，$\\delta t$ 是时间步长，$\\delta s$ 是传播方向上的网格间距。为确保稳定性，时间步长必须满足：\n$$\\delta t \\le \\frac{\\delta s}{v_{\\text{char}}}$$\n\n我们必须将此条件应用于耦合模型内的所有相关过程和空间方向。题目指明了三个必须评估的独立约束。\n\n1.  **CRM 垂直约束：**\n    在 CRM 的垂直方向上，传播最快的信号是内重力波。题目说明最快的内重力波相速度为 $c_g$，垂直网格间距为 $\\Delta z$。因此，特征速度为 $v_{\\text{char}, z} = c_g$。基于此垂直约束的最大允许时间步长 $\\delta t_{CRM, z}$ 为：\n    $$\\delta t \\le \\frac{\\Delta z}{c_g}$$\n    代入给定值：\n    $c_{g} = 48 \\,\\text{m s}^{-1}$\n    $\\Delta z = 32 \\,\\text{m}$\n    $$\\delta t_{CRM, z} \\le \\frac{32 \\,\\text{m}}{48 \\,\\text{m s}^{-1}} = \\frac{2}{3} \\,\\text{s} \\approx 0.6667 \\,\\text{s}$$\n\n2.  **CRM 水平约束：**\n    在 CRM 的水平方向上，有两个过程对信号传播有贡献：解析流的平流和内重力波的水平传播。题目说明，解析的最大水平平流速度为 $U_{\\max}$，内重力波速度为 $c_g$。对于线性系统，移动最快的信号速度将等于平流速度和波相速度之和（对于与流向相同方向传播的波）。因此，CRM 水平方向的特征速度为 $v_{\\text{char}, x} = U_{\\max} + c_g$。水平网格间距为 $\\Delta x$。基于此水平约束的最大允许时间步长 $\\delta t_{CRM, x}$ 为：\n    $$\\delta t \\le \\frac{\\Delta x}{U_{\\max} + c_g}$$\n    代入给定值：\n    $\\Delta x = 1000 \\,\\text{m}$\n    $U_{\\max} = 22 \\,\\text{m s}^{-1}$\n    $c_g = 48 \\,\\text{m s}^{-1}$\n    $$\\delta t_{CRM, x} \\le \\frac{1000 \\,\\text{m}}{22 \\,\\text{m s}^{-1} + 48 \\,\\text{m s}^{-1}} = \\frac{1000 \\,\\text{m}}{70 \\,\\text{m s}^{-1}} = \\frac{100}{7} \\,\\text{s} \\approx 14.2857 \\,\\text{s}$$\n\n3.  **GCM 水平约束：**\n    主 GCM 有其自身的动力学，其中包括快速外重力波。这些波的传播速度通常远快于大尺度平流，因此它们决定了显式 GCM 的时间步长限制。题目给出的最快外重力波速度为 $c_{\\text{ext}}$，GCM 水平网格间距为 $\\Delta X$。特征速度为 $v_{\\text{char}, X} = c_{\\text{ext}}$。相应的最大允许时间步长 $\\delta t_{GCM, X}$ 为：\n    $$\\delta t \\le \\frac{\\Delta X}{c_{\\text{ext}}}$$\n    代入给定值：\n    $\\Delta X = 25000 \\,\\text{m}$\n    $c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$\n    $$\\delta t_{GCM, X} \\le \\frac{25000 \\,\\text{m}}{300 \\,\\text{m s}^{-1}} = \\frac{250}{3} \\,\\text{s} \\approx 83.3333 \\,\\text{s}$$\n\n**耦合系统的限制性时间步长：**\n超参数化模型使用单一的全局显式时间步长 $\\delta t$，它必须同时满足所有三个稳定性约束，以确保整个系统的数值稳定性。因此，所选的时间步长必须小于或等于这三个独立最大值中的最小值。限制性显式时间步长 $\\delta t_{\\text{lim}}$ 为：\n$$\\delta t_{\\text{lim}} = \\min(\\delta t_{CRM, z}, \\delta t_{CRM, x}, \\delta t_{GCM, X})$$\n代入计算出的值：\n$$\\delta t_{\\text{lim}} = \\min \\left( \\frac{2}{3} \\,\\text{s}, \\frac{100}{7} \\,\\text{s}, \\frac{250}{3} \\,\\text{s} \\right)$$\n为了比较这些值，我们可以使用它们的小数近似值：\n$\\delta t_{CRM, z} \\approx 0.6667 \\,\\text{s}$\n$\\delta t_{CRM, x} \\approx 14.2857 \\,\\text{s}$\n$\\delta t_{GCM, X} \\approx 83.3333 \\,\\text{s}$\n\n这些值中的最小值显然与 CRM 中内重力波的垂直传播相关：\n$$\\delta t_{\\text{lim}} = \\frac{2}{3} \\,\\text{s}$$\n题目要求答案四舍五入到四位有效数字。\n$$\\delta t_{\\text{lim}} \\approx 0.666666... \\,\\text{s}$$\n将此值四舍五入到四位有效数字得到 $0.6667 \\,\\text{s}$。这个结果凸显了超参数化中的一个关键挑战：整个耦合系统的显式时间步长通常受到嵌入的 CRM 中小尺度、快速过程的严格限制，特别是在高分辨率垂直网格中垂直传播的波。",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "在了解了超参数化的高昂计算成本之后，一个实际的问题是：我们如何使这些模型在计算上更可行？本练习将引导你分析一个核心权衡：通过降低云解析模型（CRM）的分辨率来节省计算资源，以及由此带来的物理保真度的损失。通过量化关键物理量（对流加热率）中引入的误差，你将体会到模型开发者在设计模型时所面临的艰难抉择 。",
            "id": "4096921",
            "problem": "一个全球大气环流模型 (GCM) 采用超参数化方法，在每个 GCM 网格柱内嵌入一个具有水平坐标 $x$ 和垂直坐标 $z$ 的二维云解析模型 (CRM)。CRM 区域具有固定的水平长度 $L$ 和周期性侧边界条件。CRM 将区域平均对流加热率 $Q$（单位为开尔文/天）预报为湿静力能量通量垂直辐合的水平平均值，对于水平均匀的定常状态，该值可以用谱表示为\n$$\nQ \\;=\\; \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k,\n$$\n其中 $k$ 是水平波数，$k_{\\min} = \\frac{2\\pi}{L}$ 是区域的基本波数，$k_{\\mathrm{N}} = \\frac{\\pi}{\\Delta x_{\\mathrm{CRM}}}$ 是由 CRM 网格间距 $\\Delta x_{\\mathrm{CRM}}$ 设定的奈奎斯特波数，而 $S_Q(k)$ 是量化尺度 $k$ 对 $Q$ 贡献的交叉谱密度。\n\n假设惯性区对流输送满足以下科学上合理且广泛使用的谱标度律：\n$$\nS_Q(k) \\;=\\; A\\,k^{-p}, \\quad p \\;=\\; \\frac{5}{3}, \\quad k \\in [k_{\\min},\\,k_{\\mathrm{N}}],\n$$\n其中振幅 $A>0$ 为常数。在基准配置中，$\\Delta x_{\\mathrm{CRM}} = \\Delta x_0$，模型具有 $L = 128\\,\\mathrm{km}$ 和 $\\Delta x_0 = 1\\,\\mathrm{km}$，诊断出的区域平均对流加热率为 $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$。为了降低计算成本，建模者考虑将 CRM 网格间距加倍至 $\\Delta x_1 = 2\\,\\mathrm{km}$，同时保持 $L$ 不变，这将使 $k_{\\mathrm{N}}$ 减半。\n\n从 $Q$ 的谱定义和给定的标度律出发，仅使用标准采样理论（奈奎斯特波数）和幂律积分，推导将 $\\Delta x_{\\mathrm{CRM}}$ 从 $\\Delta x_0$ 加倍到 $\\Delta x_1$ 在区域平均加热率中引入的绝对误差 $\\Delta Q = Q_0 - Q_1$ 的表达式。然后，在给定参数下，对 $\\Delta Q$ 进行数值计算。以 $\\mathrm{K\\,day^{-1}}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。\n\n此外，从第一性原理出发，简要分析对于一个受 Courant–Friedrichs–Lewy (CFL) 条件（具有特征波速 $c$ 和库朗数 $C_{\\mathrm{CFL}}$）约束的显式时间步进方案，单位挂钟模拟时间的计算成本如何随 $\\Delta x_{\\mathrm{CRM}}$ 变化；这部分不需要数值计算。",
            "solution": "区域平均对流加热率 $Q$ 由谱密度 $S_Q(k)$ 从基本波数 $k_{\\min}$ 到奈奎斯特波数 $k_{\\mathrm{N}}$ 的积分给出：\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k\n$$\n代入给定的幂律标度律 $S_Q(k) = A\\,k^{-p}$，其中 $p = 5/3$：\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} A\\,k^{-5/3}\\,\\mathrm{d}k\n$$\n进行积分：\n$$\nQ = A \\left[ \\frac{k^{-5/3 + 1}}{-5/3 + 1} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = A \\left[ \\frac{k^{-2/3}}{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = -\\frac{3A}{2} \\left[ k^{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}}\n$$\n$$\nQ = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N}}^{-2/3})\n$$\n这个通用表达式将加热率 $Q$ 与模型参数 $L$（通过 $k_{\\min}$）和 $\\Delta x_{\\mathrm{CRM}}$（通过 $k_{\\mathrm{N}}$）联系起来。\n\n对于基准配置（下标为 0），我们有 $Q_0$、$k_{\\min}$ 和 $k_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0}$。\n$$\nQ_0 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n我们可以求解项 $\\frac{3A}{2}$：\n$$\n\\frac{3A}{2} = \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\n对于修改后的配置（下标为 1），网格间距变为 $\\Delta x_1$，从而得到新的奈奎斯特波数 $k_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1}$。加热率 $Q_1$ 为：\n$$\nQ_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\n绝对误差 $\\Delta Q$ 是差值 $Q_0 - Q_1$：\n$$\n\\Delta Q = Q_0 - Q_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}) - \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\n$$\n\\Delta Q = \\frac{3A}{2} (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n现在，代入从基准情况推导出的 $\\frac{3A}{2}$ 的表达式：\n$$\n\\Delta Q = \\left( \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}} \\right) (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n这就得到了误差 $\\Delta Q$ 所需的解析表达式：\n$$\n\\Delta Q = Q_0 \\frac{k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\n为了进行数值计算，我们首先使用给定参数计算波数：$L = 128\\,\\mathrm{km}$，$\\Delta x_0 = 1\\,\\mathrm{km}$，以及 $\\Delta x_1 = 2\\,\\mathrm{km}$。\n$$\nk_{\\min} = \\frac{2\\pi}{L} = \\frac{2\\pi}{128} = \\frac{\\pi}{64}\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0} = \\frac{\\pi}{1} = \\pi\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1} = \\frac{\\pi}{2}\\,\\mathrm{km}^{-1}\n$$\n将这些值代入 $\\Delta Q$ 的表达式中：\n$$\n\\Delta Q = Q_0 \\frac{(\\frac{\\pi}{2})^{-2/3} - (\\pi)^{-2/3}}{(\\frac{\\pi}{64})^{-2/3} - (\\pi)^{-2/3}}\n$$\n因子 $\\pi^{-2/3}$可以从分子和分母中提出并消去：\n$$\n\\Delta Q = Q_0 \\frac{\\pi^{-2/3} ((\\frac{1}{2})^{-2/3} - 1^{-2/3})}{\\pi^{-2/3} ((\\frac{1}{64})^{-2/3} - 1^{-2/3})} = Q_0 \\frac{2^{2/3} - 1}{64^{2/3} - 1}\n$$\n我们可以计算 $64^{2/3}$ 为 $(64^{1/3})^2 = 4^2 = 16$。\n$$\n\\Delta Q = Q_0 \\frac{2^{2/3} - 1}{16 - 1} = Q_0 \\frac{2^{2/3} - 1}{15}\n$$\n现在，我们代入 $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$ 的值：\n$$\n\\Delta Q = 4 \\times \\frac{2^{2/3} - 1}{15}\n$$\n使用计算器，$2^{2/3} \\approx 1.58740105$。\n$$\n\\Delta Q \\approx 4 \\times \\frac{1.58740105 - 1}{15} = 4 \\times \\frac{0.58740105}{15} = \\frac{2.3496042}{15} \\approx 0.15664028\\,\\mathrm{K\\,day^{-1}}\n$$\n四舍五入到四位有效数字，绝对误差为 $\\Delta Q = 0.1566\\,\\mathrm{K\\,day^{-1}}$。\n\n### 计算成本标度分析\n\n对于固定的挂钟模拟时间 $T_{\\mathrm{sim}}$，计算成本 $\\mathcal{C}$ 与 CRM 中的总网格点数和所需的总时间步数成正比。\n总网格点数为 $N_{\\mathrm{grid}} = N_x \\times N_z$，其中 $N_x = L / \\Delta x_{\\mathrm{CRM}}$ 是水平网格点数，$N_z$ 是垂直网格点数。我们假设 $L$ 和 $N_z$ 是常数。\n$$\nN_{\\mathrm{grid}} \\propto N_x = \\frac{L}{\\Delta x_{\\mathrm{CRM}}} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\n对于显式时间步进方案，时间步长 $\\Delta t$ 受到 Courant–Friedrichs–Lewy (CFL) 条件的约束：\n$$\nC_{\\mathrm{CFL}} = \\frac{c\\,\\Delta t}{\\Delta x_{\\mathrm{CRM}}} \\le C_{\\mathrm{max}}\n$$\n其中 $c$ 是特征波速，$C_{\\mathrm{max}}$ 是库朗数稳定性极限。为了最大化效率，我们选择在此极限处的 $\\Delta t$，因此 $\\Delta t = \\frac{C_{\\mathrm{max}}}{c} \\Delta x_{\\mathrm{CRM}}$。因此，时间步长与网格间距成正比：\n$$\n\\Delta t \\propto \\Delta x_{\\mathrm{CRM}}\n$$\n模拟固定时长 $T_{\\mathrm{sim}}$ 所需的时间步数 $N_t$ 为 $N_t = T_{\\mathrm{sim}} / \\Delta t$。\n$$\nN_t \\propto \\frac{1}{\\Delta t} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\n总计算成本 $\\mathcal{C}$ 是每时间步的成本（与 $N_{\\mathrm{grid}}$ 成正比）和时间步数（$N_t$）的乘积：\n$$\n\\mathcal{C} \\propto N_{\\mathrm{grid}} \\times N_t \\propto (\\Delta x_{\\mathrm{CRM}})^{-1} \\times (\\Delta x_{\\mathrm{CRM}})^{-1} = (\\Delta x_{\\mathrm{CRM}})^{-2}\n$$\n因此，单位挂钟模拟时间的计算成本与 CRM 水平网格间距的平方成反比。将网格间距加倍（例如，从 $1\\,\\mathrm{km}$ 到 $2\\,\\mathrm{km}$）将使计算成本降低为原来的 $(2)^{-2} = 1/4$。",
            "answer": "$$\n\\boxed{0.1566}\n$$"
        },
        {
            "introduction": "除了计算成本和分辨率的考量，超参数化中的一个根本问题是，有限的云解析模型（CRM）区域是否能准确地代表次网格尺度过程的统计特性。最后的这个练习深入探讨了这种“代表性误差”的概念。你将推导出区域平均加热率的方差如何依赖于区域大小和对流结构的物理尺度，从而为评估模型的统计可靠性提供一个定量的工具 。",
            "id": "4096875",
            "problem": "在超参数化中，一个云分辨模式（CRM）被嵌入到一个大气环流模式（GCM）的网格单元内，以显式模拟次网格的对流过程，并将其统计数据（例如，对流加热）反馈给粗分辨率模式。考虑一个长度为 $L$ 的一维、统计均匀的CRM区域，在该区域上对对流加热场 $Q_{c}(x)$ 进行采样。设 $Q_{c}(x)$ 是一个均值为零的二阶平稳随机场，其空间自协方差函数为 $R(r) = \\mathrm{Cov}(Q_{c}(x), Q_{c}(x+r))$。假设 $R(r)$ 可以用指数形式 $R(r) = \\sigma_{Q}^{2} \\exp(-|r|/\\xi)$ 很好地近似，其中 $\\sigma_{Q}^{2}$ 是 $Q_{c}$ 的点方差，$\\xi$ 是一个相关长度，它概括了有组织对流结构的有效尺度。CRM 提供区域平均加热\n$$\n\\langle Q_{c} \\rangle = \\frac{1}{L} \\int_{0}^{L} Q_{c}(x)\\, dx,\n$$\n该值作为次网格对流倾向传递给宿主GCM。有限区域采样在 $\\langle Q_{c} \\rangle$ 中引入了代表性误差，其大小由 $\\mathrm{Var}(\\langle Q_{c} \\rangle)$ 量化。\n\n从方差的定义和二阶平稳随机场的性质出发，在上述指数协方差假设下，推导出 $\\mathrm{Var}(\\langle Q_{c} \\rangle)$ 关于 $L$、$\\xi$ 和 $\\sigma_{Q}^{2}$ 的精确闭合形式表达式。你的推导应逻辑上证明 $\\mathrm{Var}(\\langle Q_{c} \\rangle)$ 随 $L$ 减小的标度关系，并从第一性原理出发，解释相关长度 $\\xi$ 如何控制区域平均中的有限区域代表性和次网格变率的混淆。\n\n将你的最终答案表示为关于 $L$、$\\xi$ 和 $\\sigma_{Q}^{2}$ 的单一闭合形式解析表达式。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含单位。",
            "solution": "目标是推导区域平均对流加热方差 $\\mathrm{Var}(\\langle Q_{c} \\rangle)$ 的表达式。区域平均加热 $\\langle Q_{c} \\rangle$ 定义为：\n$$\n\\langle Q_{c} \\rangle = \\frac{1}{L} \\int_{0}^{L} Q_{c}(x)\\, dx\n$$\n方差定义为 $\\mathrm{Var}(X) = E[(X - E[X])^2]$。问题陈述指出随机场 $Q_c(x)$ 的均值为零，即 $E[Q_{c}(x)] = 0$。因此，区域平均加热的期望值也为零：\n$$\nE[\\langle Q_{c} \\rangle] = E\\left[\\frac{1}{L} \\int_{0}^{L} Q_{c}(x)\\, dx\\right] = \\frac{1}{L} \\int_{0}^{L} E[Q_{c}(x)]\\, dx = 0\n$$\n因此，区域平均的方差简化为其平方的期望值：\n$$\n\\mathrm{Var}(\\langle Q_{c} \\rangle) = E[\\langle Q_{c} \\rangle^2] = E\\left[ \\left(\\frac{1}{L} \\int_{0}^{L} Q_{c}(x)\\, dx\\right)^2 \\right]\n$$\n利用期望的线性性质，并将积分的平方写成二重积分，我们得到：\n$$\n\\mathrm{Var}(\\langle Q_{c} \\rangle) = \\frac{1}{L^2} E\\left[ \\left(\\int_{0}^{L} Q_{c}(x)\\, dx\\right) \\left(\\int_{0}^{L} Q_{c}(y)\\, dy\\right) \\right] = \\frac{1}{L^2} E\\left[ \\int_{0}^{L} \\int_{0}^{L} Q_{c}(x) Q_{c}(y)\\, dx \\, dy \\right]\n$$\n我们可以交换期望和积分算子：\n$$\n\\mathrm{Var}(\\langle Q_{c} \\rangle) = \\frac{1}{L^2} \\int_{0}^{L} \\int_{0}^{L} E[Q_{c}(x) Q_{c}(y)]\\, dx \\, dy\n$$\n积分内的项 $E[Q_{c}(x) Q_{c}(y)]$ 是自协方差函数，因为均值为零。问题陈述指出 $Q_c(x)$ 是一个二阶平稳随机场，这意味着其自协方差仅取决于分离距离 $r = x-y$。\n$$\nE[Q_{c}(x) Q_{c}(y)] = \\mathrm{Cov}(Q_{c}(x), Q_{c}(y)) = R(x-y)\n$$\n问题为此函数指定了一个指数形式：$R(r) = \\sigma_{Q}^{2} \\exp(-|r|/\\xi)$。将此代入我们的方差表达式中，得到：\n$$\n\\mathrm{Var}(\\langle Q_{c} \\rangle) = \\frac{\\sigma_{Q}^{2}}{L^2} \\int_{0}^{L} \\int_{0}^{L} \\exp\\left(-\\frac{|x-y|}{\\xi}\\right)\\, dx \\, dy\n$$\n我们来计算二重积分 $I = \\int_{0}^{L} \\int_{0}^{L} \\exp(-|x-y|/\\xi)\\, dx \\, dy$。积分区域是 $x-y$ 平面上的一个正方形 $[0,L] \\times [0,L]$。被积函数关于直线 $x=y$ 对称。我们可以计算 $x \\ge y$ 区域上的积分，然后将结果乘以2：\n$$\nI = 2 \\int_{0}^{L} \\int_{0}^{x} \\exp\\left(-\\frac{x-y}{\\xi}\\right)\\, dy \\, dx\n$$\n首先，我们计算关于 $y$ 的内层积分：\n$$\n\\int_{0}^{x} \\exp\\left(-\\frac{x-y}{\\xi}\\right)\\, dy = \\exp\\left(-\\frac{x}{\\xi}\\right) \\int_{0}^{x} \\exp\\left(\\frac{y}{\\xi}\\right)\\, dy = \\exp\\left(-\\frac{x}{\\xi}\\right) \\left[ \\xi \\exp\\left(\\frac{y}{\\xi}\\right) \\right]_{0}^{x}\n$$\n$$\n= \\xi \\exp\\left(-\\frac{x}{\\xi}\\right) \\left( \\exp\\left(\\frac{x}{\\xi}\\right) - \\exp(0) \\right) = \\xi \\left(1 - \\exp(-x/\\xi)\\right)\n$$\n现在，我们将此结果代入外层积分，并对 $x$ 从 $0$ 到 $L$ 进行积分：\n$$\nI = 2 \\int_{0}^{L} \\xi \\left(1 - \\exp\\left(-\\frac{x}{\\xi}\\right)\\right)\\, dx = 2\\xi \\left[ x - (-\\xi) \\exp\\left(-\\frac{x}{\\xi}\\right) \\right]_{0}^{L}\n$$\n$$\nI = 2\\xi \\left[ x + \\xi \\exp\\left(-\\frac{x}{\\xi}\\right) \\right]_{0}^{L} = 2\\xi \\left[ \\left(L + \\xi \\exp\\left(-\\frac{L}{\\xi}\\right)\\right) - \\left(0 + \\xi \\exp(0)\\right) \\right]\n$$\n$$\nI = 2\\xi \\left( L + \\xi \\exp\\left(-\\frac{L}{\\xi}\\right) - \\xi \\right) = 2L\\xi - 2\\xi^2 + 2\\xi^2 \\exp\\left(-\\frac{L}{\\xi}\\right)\n$$\n最后，我们将 $I$ 的这个表达式代回方差方程中：\n$$\n\\mathrm{Var}(\\langle Q_{c} \\rangle) = \\frac{\\sigma_{Q}^{2}}{L^2} \\left[ 2L\\xi - 2\\xi^2 + 2\\xi^2 \\exp\\left(-\\frac{L}{\\xi}\\right) \\right]\n$$\n提取公因子后得到最终的闭合形式表达式：\n$$\n\\mathrm{Var}(\\langle Q_c \\rangle) = \\frac{2 \\sigma_Q^2 \\xi^2}{L^2} \\left( \\frac{L}{\\xi} - 1 + \\exp\\left(-\\frac{L}{\\xi}\\right) \\right)\n$$\n这个表达式量化了代表性误差。为了理解其行为，我们来探讨问题的定性部分。\n\n方差随着区域大小 $L$ 的增加而减小。这是因为更大的区域提供了场的更好统计样本，从而减少了采样误差。数学上，$\\mathrm{Var}(\\langle Q_{c} \\rangle)$ 对 $L$ 的导数对于所有 $L > 0$ 都是负的，这证实了它是一个单调递减函数。当 $L \\to \\infty$ 时，方差趋近于零，正如大数定律所预期的那样。\n\n相关长度 $\\xi$ 通过设定独立信息的有效空间尺度来控制代表性。无量纲比率 $L/\\xi$ 至关重要。\n\\begin{itemize}\n    \\item 当 $L \\gg \\xi$（区域相对于相关长度很大）时，该区域包含许多有效独立的子区域。平均过程在减小方差方面非常有效。在此极限下，$L/\\xi \\to \\infty$，且 $\\exp(-L/\\xi) \\to 0$。表达式简化为：\n    $$ \\mathrm{Var}(\\langle Q_{c} \\rangle) \\approx \\frac{2 \\sigma_{Q}^{2} \\xi^2}{L^2} \\left(\\frac{L}{\\xi}\\right) = \\frac{2 \\sigma_{Q}^{2} \\xi}{L} $$\n    方差很小，并按 $1/L$ 的比例缩放，这是对 $L/(2\\xi)$ 个独立样本进行平均的特征。实现了良好的代表性。\n\n    \\item 当 $L \\ll \\xi$（区域相对于相关长度很小）时，区域内的整个场是高度相关的。该区域本质上只捕捉了对流结构的单个实现，而不是一个集合。平均是无效的。在此极限下，$L/\\xi \\to 0$。对于 $z=L/\\xi$，使用泰勒展开 $\\exp(-z) \\approx 1-z+z^2/2$：\n    $$ \\mathrm{Var}(\\langle Q_{c} \\rangle) = \\frac{2 \\sigma_{Q}^{2} \\xi^2}{L^2} \\left( \\frac{L}{\\xi} - 1 + \\left(1 - \\frac{L}{\\xi} + \\frac{1}{2}\\left(\\frac{L}{\\xi}\\right)^2 + \\dots\\right) \\right) \\approx \\frac{2 \\sigma_{Q}^{2} \\xi^2}{L^2} \\left( \\frac{L^2}{2\\xi^2} \\right) = \\sigma_{Q}^{2} $$\n    平均值的方差接近点方差 $\\sigma_{Q}^{2}$。这是一种代表性差的状态，在这种状态下，反馈给GCM的区域平均值被单个未分辨的大尺度特征的变率所“混淆”，使得反馈充满噪声且不可靠。\n\\end{itemize}\n总之，相关长度 $\\xi$ 决定了大小为 $L$ 的区域内独立样本的有效数量。相对于 $L$ 较小的 $\\xi$ 确保了区域平均是一个稳健的统计量，而较大的 $\\xi$ 则意味着区域平均是对真实次网格倾向的一个差的、充满噪声的估计。",
            "answer": "$$\n\\boxed{\\frac{2 \\sigma_{Q}^{2} \\xi^{2}}{L^{2}} \\left( \\frac{L}{\\xi} - 1 + \\exp\\left(-\\frac{L}{\\xi}\\right) \\right)}\n$$"
        }
    ]
}