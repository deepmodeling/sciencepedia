{
    "hands_on_practices": [
        {
            "introduction": "超参数化方法的一个核心挑战是其巨大的计算开销，而内存消耗是其中的一个主要部分。本练习将指导您估算嵌入式云分辨模型（CRM）的内存足迹，这是评估超参数化方案可行性的第一步。通过这个计算，您不仅能理解模型分辨率和复杂度如何直接转化为硬件需求，还能思考数据在内存中的布局方式如何影响计算性能，这是气候模式优化中的一个关键问题 。",
            "id": "4096886",
            "problem": "在用于数值天气预报和气候模拟的超参数化框架中，一个云分辨模型（CRM）被嵌入到全球环流模型（GCM）的每个垂直气柱中。考虑一个二维CRM域，其包含$N_x$个水平点和$N_z$个垂直层。该CRM在每个网格点上存储一组预报状态变量：三个速度分量$u$、$v$、$w$，位温$\\theta$，以及水汽混合比$q_v$。此外，该CRM还携带$K$个被平流和扩散但不对动力学或热力学产生反馈的被动示踪剂。\n\n假设：\n- 每个存储的变量都以符合电气和电子工程师协会（IEEE）754标准的64位二进制浮点格式表示，因此每个值占用$8$字节。\n- 不使用晕圈或幽灵单元填充，并且只为每个数组分配大小为$N_x \\times N_z$的物理域。\n- 该CRM仅存储如上所述的主要状态变量，不分配单独的倾向项、工作空间或诊断数组。\n\n从总内存是存储元素数量与每个元素字节数之积的定义出发，推导每个CRM的总内存占用量的精确符号表达式，以兆字节（MiB）为单位，其中$1$兆字节等于$2^{20}$字节。最终答案仅用$K$、$N_x$和$N_z$表示。\n\n然后，讨论在现代处理器上优化缓存性能的数据布局选择，比较数组结构（structure-of-arrays）与结构数组（array-of-structures）方法，并探讨选择$N_x$或$N_z$作为步长为1（连续）维度的影响。讨论应是定性的，并基于空间和时间局部性的第一性原理，不涉及具体的编译器或硬件细节。\n\n以MiB为单位，给出最终内存占用量的精确符号表达式。不要近似或取整。",
            "solution": "该问题被评估为有效，因为它具有科学依据，问题明确，内部一致，并与计算科学中超参数化的特定主题直接相关。所有必要信息均已提供，所提出的问题可以根据计算机科学和数值模拟的既定原则得到解答。\n\n解决方案分为两部分。首先，我们推导内存占用量的符号表达式。其次，我们讨论数据布局选择的影响。\n\n**第一部分：内存占用量的推导**\n\n云分辨模型（CRM）的总内存占用量由存储的数值总数与每个值的内存大小之积决定。我们按步骤进行推导。\n\n1.  **网格点总数：** CRM域是一个二维网格，有$N_x$个水平点和$N_z$个垂直层。假设每个网格单元都存储状态变量，则网格点总数是维度的乘积：\n    $$ \\text{Total Grid Points} = N_x \\times N_z $$\n\n2.  **每个网格点的变量数：** 在每个网格点，模型存储一组状态变量。这些变量如下：\n    - $3$个速度分量：$u$、$v$、$w$。\n    - $1$个位温：$\\theta$。\n    - $1$个水汽混合比：$q_v$。\n    - $K$个被动示踪剂。\n    在每个网格点存储的变量总数是这些变量之和，即 $3 + 1 + 1 + K$。\n    $$ \\text{Variables per Grid Point} = 5 + K $$\n\n3.  **存储元素总数：** CRM存储的单个浮点值的总数是网格点总数与每个网格点变量数之积。\n    $$ \\text{Total Stored Elements} = (\\text{Total Grid Points}) \\times (\\text{Variables per Grid Point}) = (N_x N_z) \\times (5 + K) $$\n\n4.  **以字节为单位的总内存：** 每个存储的元素是一个$64$位二进制浮点数，占用$8$字节的内存。因此，以字节为单位的总内存占用量为：\n    $$ \\text{Memory (bytes)} = (\\text{Total Stored Elements}) \\times (\\text{Bytes per Element}) $$\n    $$ \\text{Memory (bytes)} = (5 + K) N_x N_z \\times 8 $$\n\n5.  **以兆字节（MiB）为单位的总内存：** 问题要求答案以兆字节（MiB）为单位，其中$1 \\text{ MiB} = 2^{20}$字节。我们通过除以$2^{20}$将总内存从字节转换为MiB。\n    $$ \\text{Memory (MiB)} = \\frac{\\text{Memory (bytes)}}{2^{20}} = \\frac{8 (5 + K) N_x N_z}{2^{20}} $$\n    由于$8 = 2^3$，我们可以简化表达式：\n    $$ \\text{Memory (MiB)} = \\frac{2^3 (5 + K) N_x N_z}{2^{20}} = (5 + K) N_x N_z \\times 2^{3-20} = (5 + K) N_x N_z \\times 2^{-17} $$\n    这就是每个CRM以兆字节为单位的总内存占用量的精确符号表达式。\n\n**第二部分：数据布局选择的讨论**\n\n在现代计算机体系结构中，数据在内存中的排列方式对数值模型的性能有深远影响，这些体系结构依赖于深层内存层次结构（寄存器、L1/L2/L3缓存、主内存）。高效使用缓存至关重要，这可以通过最大化引用局部性来实现，特别是空间局部性。空间局部性原理指出，在内存中位置相近的数据元素很可能在时间上也相近地被访问。我们基于这一原则分析指定的数据布局选择。\n\n**数组结构（SoA）与结构数组（AoS）的对比：**\n\nSoA布局为每个状态变量分配一个独立的、连续的内存块（一个数组）。对于本问题，我们将有$5+K$个不同的数组，例如`double u[Nx][Nz]`、`double v[Nx][Nz]`等。在这种布局中，单个场（例如位温$\\theta$）的所有值在内存中是聚集在一起的。这种布局对于在所有网格点上对单个变量执行的批量操作（例如计算空间导数或应用水平扩散算子）非常有利。当代码遍历所有点以更新$\\theta$时，它可以以规则、可预测的访问模式流式读取`theta`数组。这最大化了该操作的空间局部性，使硬件预取器能够有效工作，并且非常适合单指令多数据（SIMD）矢量化，即一个指令可以同时应用于一个数据向量（例如，$4$个或$8$个相邻的$\\theta$值）。\n\n相反，AoS布局将单个网格点的所有变量分组到一个结构中，然后创建一个这些结构的数组。对于本问题，可以定义 `struct State { double u, v, w, ...; };`，然后声明 `State grid[Nx][Nz]`。在这种布局中，`grid[i][j].u` 和 `grid[i][j].v` 在内存中是相邻的。这种布局在提供逐点或“垂直”计算的空间局部性方面表现出色，这些计算需要在同一网格位置使用多个场。例如，云微物理参数化方案可能需要在特定点`(i, j)`处的$\\theta$、$q_v$和$w$来计算倾向项。使用AoS，获取第一个变量（例如$\\theta$）很可能会将其他所需变量加载到同一个缓存行中，从而导致后续快速的缓存命中。AoS的主要缺点是对于逐场操作性能较差。访问所有的`u`值需要在内存中跨步跳跃，越过所有其他交错的变量，这会破坏空间局部性，阻碍SIMD矢量化，并用非急需的数据污染缓存。\n\n在大气模型中，这两种类型的操作都存在。动力学求解器通常倾向于SoA，而物理参数化方案（辐射、微物理）则倾向于AoS。这是一个权衡选择，一些现代框架甚至使用混合的AoSoA（数组的结构数组）布局来平衡这些相互竞争的需求。\n\n**步长为1（连续）维度的选择：**\n\n步长为1的维度是指其元素在内存中连续排列的维度。对于一个二维数组，这个选择决定了是按行还是按列顺序存储。决策应以主要的计算访问模式为指导。\n\n在大气模型中，许多计算最密集的过程，例如对流、辐射和边界层湍流的参数化方案，都是在模型网格的垂直气柱上操作的。也就是说，对于一个固定的水平位置$(i)$，算法会遍历从$1$到$N_z$的所有垂直层$j$。这通常被称为“柱物理过程”。为了优化这些操作，至关重要的是使垂直气柱内的数据在内存中是连续的。\n\n如果选择垂直维度（$N_z$）作为步长为1的维度，那么水平位置$i$处的气柱数据，即`(i, 1), (i, 2), ..., (i, Nz)`，将被顺序布局。当柱物理过程模块处理这个气柱时，它以单位步长从内存中读写，这是最高效的访问模式。这确保了缓存行的最大利用，并使硬件预取能够有效工作。\n\n相反，如果选择水平维度（$N_x$）作为步长为1的维度，那么一个垂直气柱中的数据将被$N_x$个元素的步长分隔开。对于$N_x$可能很大的典型模型分辨率，这种访问模式将导致非常差的缓存性能，因为每次访问都可能取回一个新的缓存行，但只使用其中的一个元素，然后就跳转到另一个内存位置。虽然连续的$N_x$维度会有利于纯水平操作，但柱物理过程的计算成本通常占主导地位，从而决定了最优的数据布局。因此，在几乎所有生产级的天气和气候模型中，垂直维度都被设为连续的、步长为1的维度。",
            "answer": "$$\\boxed{(5 + K) N_x N_z \\times 2^{-17}}$$"
        },
        {
            "introduction": "除了内存资源，计算效率还受到数值积分时间步长的严格限制。为了确保数值稳定性，时间步长必须满足 Courant-Friedrichs-Lewy (CFL) 条件，即信息在单个时间步内传播的距离不能超过一个网格间距。此练习将让您亲身计算并比较耦合系统中不同部分的稳定性约束，揭示为何高分辨率 CRM 中快速传播的内部重力波通常会成为整个模型的瓶颈，从而深刻理解超参数化所面临的“时间步专制”问题 。",
            "id": "4096898",
            "problem": "在一个超参数化数值天气和气候模型中，主体全球气候模式（GCM）的每个网格列都包含一个嵌入的二维云解析模式（CRM），该模式以无方向分裂的方式进行显式积分。CRM解析内重力波和平流。大尺度GCM动力学也包括快速外重力波。\n\n从应用于线性化双曲动力学（平流和重力波传播）的显式时间步长法的 Courant–Friedrichs–Lewy (CFL) 稳定性条件出发，通过确定相关的特征速度和网格间距，推导CRM垂直和水平方向以及大尺度GCM水平动力学所允许的显式时间步长。然后，确定耦合超参数化系统必须遵守的单一极限显式时间步长（即CRM垂直约束、CRM水平约束和主体GCM水平约束中的最小值）。\n\n使用以下科学上合理的参数：\n- CRM最快内重力波相速度：$c_{g} = 48 \\,\\text{m s}^{-1}$。\n- CRM垂直网格间距：$\\Delta z = 32 \\,\\text{m}$。\n- CRM水平网格间距：$\\Delta x = 1000 \\,\\text{m}$。\n- CRM解析的最大水平平流速度：$U_{\\max} = 22 \\,\\text{m s}^{-1}$。\n- GCM水平网格间距：$\\Delta X = 25000 \\,\\text{m}$。\n- GCM最快外重力波速度：$c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$。\n\n假设显式格式要求在每个方向上，基于该方向上存在的最大特征速度计算的Courant数小于1，并且耦合格式使用单一的全局显式时间步长，该步长必须同时满足所有方向和分量的约束。计算极限显式时间步长 $\\delta t_{\\text{lim}}$。以秒为单位表示你的最终答案，并将其四舍五入到四位有效数字。",
            "solution": "该问题要求确定一个超参数化数值模型的极限显式时间步长，该模型由一个主体全球气候模式（GCM）和嵌入的云解析模式（CRM）组成。显式时间步长格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件控制。\n\n对于描述平流和波传播等过程的一维线性双曲偏微分方程，CFL条件规定数值依赖域必须包含物理依赖域。对于一个简单的显式有限差分格式，这可以用Courant数 $C$ 来表示。该条件通常表示为 $C \\le 1$。Courant数的定义如下：\n$$C = \\frac{v_{\\text{char}} \\delta t}{\\delta s}$$\n其中 $v_{\\text{char}}$ 是最快传播信号的特征速度，$\\delta t$ 是时间步长，$\\delta s$ 是传播方向上的网格间距。为确保稳定性，时间步长必须满足：\n$$\\delta t \\le \\frac{\\delta s}{v_{\\text{char}}}$$\n\n我们必须将此条件应用于耦合模型内的所有相关过程和空间方向。问题指定了必须评估的三个不同约束。\n\n1.  **CRM垂直约束：**\n    在CRM的垂直方向上，最快的传播信号是内重力波。问题指出，最快的内重力波相速度为 $c_g$，垂直网格间距为 $\\Delta z$。因此，特征速度为 $v_{\\text{char}, z} = c_g$。基于此垂直约束的最大允许时间步长 $\\delta t_{CRM, z}$ 为：\n    $$\\delta t \\le \\frac{\\Delta z}{c_g}$$\n    代入给定值：\n    $c_{g} = 48 \\,\\text{m s}^{-1}$\n    $\\Delta z = 32 \\,\\text{m}$\n    $$\\delta t_{CRM, z} \\le \\frac{32 \\,\\text{m}}{48 \\,\\text{m s}^{-1}} = \\frac{2}{3} \\,\\text{s} \\approx 0.6667 \\,\\text{s}$$\n\n2.  **CRM水平约束：**\n    在CRM的水平方向上，有两个过程对信号传播有贡献：解析流的平流和内重力波的水平传播。问题指出，解析的最大水平平流速度为 $U_{\\max}$，内重力波速度为 $c_g$。对于一个线性系统，移动最快的信号速度将等于平流速度和波相速度之和（对于与流动同向传播的波）。因此，CRM水平方向的特征速度为 $v_{\\text{char}, x} = U_{\\max} + c_g$。水平网格间距为 $\\Delta x$。基于此水平约束的最大允许时间步长 $\\delta t_{CRM, x}$ 为：\n    $$\\delta t \\le \\frac{\\Delta x}{U_{\\max} + c_g}$$\n    代入给定值：\n    $\\Delta x = 1000 \\,\\text{m}$\n    $U_{\\max} = 22 \\,\\text{m s}^{-1}$\n    $c_g = 48 \\,\\text{m s}^{-1}$\n    $$\\delta t_{CRM, x} \\le \\frac{1000 \\,\\text{m}}{22 \\,\\text{m s}^{-1} + 48 \\,\\text{m s}^{-1}} = \\frac{1000 \\,\\text{m}}{70 \\,\\text{m s}^{-1}} = \\frac{100}{7} \\,\\text{s} \\approx 14.2857 \\,\\text{s}$$\n\n3.  **GCM水平约束：**\n    主体GCM有其自身的动力学，其中包括快速外重力波。这些波的传播速度通常远快于大尺度平流，因此它们为显式GCM设定了时间步长限制。问题给出了最快的外重力波速度为 $c_{\\text{ext}}$，GCM水平网格间距为 $\\Delta X$。特征速度为 $v_{\\text{char}, X} = c_{\\text{ext}}$。相应的最大允许时间步长 $\\delta t_{GCM, X}$ 为：\n    $$\\delta t \\le \\frac{\\Delta X}{c_{\\text{ext}}}$$\n    代入给定值：\n    $\\Delta X = 25000 \\,\\text{m}$\n    $c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$\n    $$\\delta t_{GCM, X} \\le \\frac{25000 \\,\\text{m}}{300 \\,\\text{m s}^{-1}} = \\frac{250}{3} \\,\\text{s} \\approx 83.3333 \\,\\text{s}$$\n\n**耦合系统的极限时间步长：**\n超参数化模型使用单一的全局显式时间步长 $\\delta t$，它必须同时满足所有三个稳定性约束，以确保整个系统的数值稳定性。因此，所选的时间步长必须小于或等于三个单独最大值中的最小值。极限显式时间步长 $\\delta t_{\\text{lim}}$ 为：\n$$\\delta t_{\\text{lim}} = \\min(\\delta t_{CRM, z}, \\delta t_{CRM, x}, \\delta t_{GCM, X})$$\n代入计算出的值：\n$$\\delta t_{\\text{lim}} = \\min \\left( \\frac{2}{3} \\,\\text{s}, \\frac{100}{7} \\,\\text{s}, \\frac{250}{3} \\,\\text{s} \\right)$$\n为了比较这些值，我们可以使用它们的小数近似值：\n$\\delta t_{CRM, z} \\approx 0.6667 \\,\\text{s}$\n$\\delta t_{CRM, x} \\approx 14.2857 \\,\\text{s}$\n$\\delta t_{GCM, X} \\approx 83.3333 \\,\\text{s}$\n\n这些值中的最小值显然是与CRM中内重力波的垂直传播相关的那一个：\n$$\\delta t_{\\text{lim}} = \\frac{2}{3} \\,\\text{s}$$\n问题要求答案四舍五入到四位有效数字。\n$$\\delta t_{\\text{lim}} \\approx 0.666666... \\,\\text{s}$$\n将此值四舍五入到四位有效数字得到 $0.6667 \\,\\text{s}$。这个结果突显了超参数化的一个关键挑战：整个耦合系统的显式时间步长通常受到嵌入式CRM中精细尺度、快速过程的严格限制，特别是在高分辨率垂直网格中垂直传播的波。",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "气候模式的开发总是在物理过程的真实性与计算成本之间进行权衡。本练习聚焦于超参数化中的这一核心权衡：通过提高 CRM 分辨率来提升物理保真度，以及随之而来的计算成本急剧增加。您将通过一个简化的谱模型，量化降低 CRM 分辨率对关键物理输出（如对流加热率）造成的误差，并分析计算成本如何随分辨率变化，从而具体地体会模式开发者在追求更高模拟精度的同时必须做出的实际妥协 。",
            "id": "4096921",
            "problem": "一个全球大气环流模式 (GCM) 采用超参数化方法，在每个 GCM 网格柱中嵌入一个具有水平坐标 $x$ 和垂直坐标 $z$ 的二维云分辨模式 (CRM)。CRM 区域具有固定的水平长度 $L$ 和周期性侧边界条件。CRM 将区域平均的对流加热率 $Q$（单位为开尔文/天）预报为湿静力能量通量垂直辐合的水平平均值。对于水平均匀的定常态，这可以谱表示为\n$$\nQ \\;=\\; \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k,\n$$\n其中 $k$ 是水平波数，$k_{\\min} = \\frac{2\\pi}{L}$ 是该区域的基波数，$k_{\\mathrm{N}} = \\frac{\\pi}{\\Delta x_{\\mathrm{CRM}}}$ 是由 CRM 网格间距 $\\Delta x_{\\mathrm{CRM}}$ 决定的奈奎斯特波数，而 $S_Q(k)$ 是量化尺度 $k$ 对 $Q$ 贡献的交叉谱密度。\n\n假设惯性区对流输送具有以下科学上合理且广泛使用的谱标度关系：\n$$\nS_Q(k) \\;=\\; A\\,k^{-p}, \\quad p \\;=\\; \\frac{5}{3}, \\quad k \\in [k_{\\min},\\,k_{\\mathrm{N}}],\n$$\n其中振幅 $A>0$ 为常数。在基准配置中，$\\Delta x_{\\mathrm{CRM}} = \\Delta x_0$，模式的 $L = 128\\,\\mathrm{km}$ 且 $\\Delta x_0 = 1\\,\\mathrm{km}$，诊断出的区域平均对流加热率为 $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$。为了降低计算成本，建模者考虑将 CRM 网格间距加倍至 $\\Delta x_1 = 2\\,\\mathrm{km}$，同时保持 $L$ 不变，这将使 $k_{\\mathrm{N}}$ 减半。\n\n从 $Q$ 的谱定义和给定的标度关系出发，仅使用标准采样理论（奈奎斯特波数）和幂律积分，推导一个表达式来表示将 $\\Delta x_{\\mathrm{CRM}}$ 从 $\\Delta x_0$ 加倍到 $\\Delta x_1$ 所引入的区域平均加热率的绝对误差 $\\Delta Q = Q_0 - Q_1$。然后在给定参数下对 $\\Delta Q$ 进行数值计算。请用 $\\mathrm{K\\,day^{-1}}$ 作为最终答案的单位，并四舍五入到四位有效数字。\n\n此外，从第一性原理出发，简要分析对于一个受 Courant–Friedrichs–Lewy (CFL) 条件（具有特征波速 $c$ 和库朗数 $C_{\\mathrm{CFL}}$）约束的显式时间步长方案，单位挂钟模拟时间内的计算成本如何随 $\\Delta x_{\\mathrm{CRM}}$ 变化；此部分不需要数值。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- 一个全球大气环流模式 (GCM) 使用超参数化，在每个 GCM 网格柱中嵌入一个二维云分辨模式 (CRM)。\n- CRM 坐标：水平 ($x$)、垂直 ($z$)。\n- CRM 区域：水平长度 $L$，周期性侧边界条件。\n- 诊断变量：区域平均对流加热率 $Q$（单位为 $\\mathrm{K\\,day^{-1}}$）。\n- $Q$ 的谱定义：$Q = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k$。\n- 基波数：$k_{\\min} = \\frac{2\\pi}{L}$。\n- 奈奎斯特波数：$k_{\\mathrm{N}} = \\frac{\\pi}{\\Delta x_{\\mathrm{CRM}}}$。\n- 谱标度：$S_Q(k) = A\\,k^{-p}$，对于 $k \\in [k_{\\min},\\,k_{\\mathrm{N}}]$。\n- 幂律指数：$p = \\frac{5}{3}$。\n- 振幅：$A > 0$。\n- 基准配置（下标 $0$）：$L = 128\\,\\mathrm{km}$，$\\Delta x_0 = 1\\,\\mathrm{km}$，$Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$。\n- 修改后配置（下标 $1$）：$L$ 固定，$\\Delta x_1 = 2\\,\\mathrm{km}$。\n- 要求输出：1) 绝对误差 $\\Delta Q = Q_0 - Q_1$ 的表达式。2) $\\Delta Q$ 的数值，四舍五入到四位有效数字。3) 计算成本如何随 $\\Delta x_{\\mathrm{CRM}}$ 变化的分析。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题很好地基于数值天气预报和气候模拟的原理。超参数化是一种成熟的技术。物理量的谱表示和 $k^{-5/3}$ 幂律（Kolmogorov 标度）的使用是大气科学和湍流理论中的标准概念。基波数和奈奎斯特波数的定义是正确的。\n- **适定性**：该问题提供了一套完整的数据和关系，可以找到唯一解。虽然没有给出振幅 $A$，但可以从基准配置的数据（$Q_0$，$L$，$\\Delta x_0$）中确定，从而可以计算 $Q_1$ 和随后的 $\\Delta Q$。\n- **客观性**：该问题使用精确、定量和客观的语言陈述，没有任何主观或模糊的术语。\n\n### 第 3 步：结论和行动\n该问题在科学上是有效的、适定的和客观的。它没有任何可察觉的缺陷。将推导解答。\n\n### 推导与计算\n\n区域平均对流加热率 $Q$ 由谱密度 $S_Q(k)$ 从基波数 $k_{\\min}$ 到奈奎斯特波数 $k_{\\mathrm{N}}$ 的积分给出：\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k\n$$\n代入给定的幂律标度关系 $S_Q(k) = A\\,k^{-p}$，其中 $p = 5/3$：\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} A\\,k^{-5/3}\\,\\mathrm{d}k\n$$\n执行积分：\n$$\nQ = A \\left[ \\frac{k^{-5/3 + 1}}{-5/3 + 1} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = A \\left[ \\frac{k^{-2/3}}{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = -\\frac{3A}{2} \\left[ k^{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}}\n$$\n$$\nQ = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N}}^{-2/3})\n$$\n这个通用表达式将加热率 $Q$ 与模型参数 $L$（通过 $k_{\\min}$）和 $\\Delta x_{\\mathrm{CRM}}$（通过 $k_{\\mathrm{N}}$）联系起来。\n\n对于基准配置（下标 $0$），我们有 $Q_0$，$k_{\\min}$ 和 $k_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0}$。\n$$\nQ_0 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n我们可以解出项 $\\frac{3A}{2}$：\n$$\n\\frac{3A}{2} = \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\n对于修改后的配置（下标 $1$），网格间距变为 $\\Delta x_1$，得到新的奈奎斯特波数 $k_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1}$。加热率 $Q_1$ 为：\n$$\nQ_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\n绝对误差 $\\Delta Q$ 是差值 $Q_0 - Q_1$：\n$$\n\\Delta Q = Q_0 - Q_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}) - \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\n$$\n\\Delta Q = \\frac{3A}{2} (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n现在，代入从基准情况推导出的 $\\frac{3A}{2}$ 的表达式：\n$$\n\\Delta Q = \\left( \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}} \\right) (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\n这就得到了误差 $\\Delta Q$ 所需的解析表达式：\n$$\n\\Delta Q = Q_0 \\frac{k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\n为了进行数值计算，我们首先使用给定参数计算波数：$L = 128\\,\\mathrm{km}$，$\\Delta x_0 = 1\\,\\mathrm{km}$ 和 $\\Delta x_1 = 2\\,\\mathrm{km}$。\n$$\nk_{\\min} = \\frac{2\\pi}{L} = \\frac{2\\pi}{128} = \\frac{\\pi}{64}\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0} = \\frac{\\pi}{1} = \\pi\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1} = \\frac{\\pi}{2}\\,\\mathrm{km}^{-1}\n$$\n将这些代入 $\\Delta Q$ 的表达式中：\n$$\n\\Delta Q = Q_0 \\frac{(\\frac{\\pi}{2})^{-2/3} - (\\pi)^{-2/3}}{(\\frac{\\pi}{64})^{-2/3} - (\\pi)^{-2/3}}\n$$\n因子 $\\pi^{-2/3}$ 可以从分子和分母中提出并约掉：\n$$\n\\Delta Q = Q_0 \\frac{\\pi^{-2/3} ((\\frac{1}{2})^{-2/3} - 1^{-2/3})}{\\pi^{-2/3} ((\\frac{1}{64})^{-2/3} - 1^{-2/3})} = Q_0 \\frac{2^{2/3} - 1}{64^{2/3} - 1}\n$$\n我们可以计算 $64^{2/3}$ 为 $(64^{1/3})^2 = 4^2 = 16$。\n$$\n\\Delta Q = Q_0 \\frac{2^{2/3} - 1}{16 - 1} = Q_0 \\frac{2^{2/3} - 1}{15}\n$$\n现在，我们代入 $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$ 的值：\n$$\n\\Delta Q = 4 \\times \\frac{2^{2/3} - 1}{15}\n$$\n使用计算器，$2^{2/3} \\approx 1.58740105$。\n$$\n\\Delta Q \\approx 4 \\times \\frac{1.58740105 - 1}{15} = 4 \\times \\frac{0.58740105}{15} = \\frac{2.3496042}{15} \\approx 0.15664028\\,\\mathrm{K\\,day^{-1}}\n$$\n四舍五入到四位有效数字，绝对误差为 $\\Delta Q = 0.1566\\,\\mathrm{K\\,day^{-1}}$。\n\n### 计算成本标度分析\n\n对于固定的挂钟模拟时间 $T_{\\mathrm{sim}}$，计算成本 $\\mathcal{C}$ 与 CRM 中的总网格点数和所需的总时间步数成正比。\n总网格点数为 $N_{\\mathrm{grid}} = N_x \\times N_z$，其中 $N_x = L / \\Delta x_{\\mathrm{CRM}}$ 是水平网格点数，$N_z$ 是垂直网格点数。我们假设 $L$ 和 $N_z$ 是常数。\n$$\nN_{\\mathrm{grid}} \\propto N_x = \\frac{L}{\\Delta x_{\\mathrm{CRM}}} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\n对于显式时间步长方案，时间步长 $\\Delta t$ 受 Courant–Friedrichs–Lewy (CFL) 条件的约束：\n$$\nC_{\\mathrm{CFL}} = \\frac{c\\,\\Delta t}{\\Delta x_{\\mathrm{CRM}}} \\le C_{\\mathrm{max}}\n$$\n其中 $c$ 是特征波速，$C_{\\mathrm{max}}$ 是库朗数稳定性极限。为了最大化效率，我们选择 $\\Delta t$ 在此极限上，因此 $\\Delta t = \\frac{C_{\\mathrm{max}}}{c} \\Delta x_{\\mathrm{CRM}}$。因此，时间步长与网格间距成正比：\n$$\n\\Delta t \\propto \\Delta x_{\\mathrm{CRM}}\n$$\n模拟固定时长 $T_{\\mathrm{sim}}$ 所需的时间步数 $N_t$ 是 $N_t = T_{\\mathrm{sim}} / \\Delta t$。\n$$\nN_t \\propto \\frac{1}{\\Delta t} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\n总计算成本 $\\mathcal{C}$ 是每时间步的成本（与 $N_{\\mathrm{grid}}$ 成正比）和时间步数（$N_t$）的乘积：\n$$\n\\mathcal{C} \\propto N_{\\mathrm{grid}} \\times N_t \\propto (\\Delta x_{\\mathrm{CRM}})^{-1} \\times (\\Delta x_{\\mathrm{CRM}})^{-1} = (\\Delta x_{\\mathrm{CRM}})^{-2}\n$$\n因此，单位挂钟模拟时间的计算成本与 CRM 水平网格间距的平方成反比。将网格间距加倍（例如，从 $1\\,\\mathrm{km}$ 到 $2\\,\\mathrm{km}$）会使计算成本降低为原来的 $(2)^{-2} = 1/4$。",
            "answer": "$$\n\\boxed{0.1566}\n$$"
        }
    ]
}