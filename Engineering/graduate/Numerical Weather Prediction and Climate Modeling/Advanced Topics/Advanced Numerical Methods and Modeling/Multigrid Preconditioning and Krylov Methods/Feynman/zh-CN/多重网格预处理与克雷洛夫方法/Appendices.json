{
    "hands_on_practices": [
        {
            "introduction": "在评估迭代求解器的性能时，一个关键指标是其收敛因子，它量化了每次迭代中误差减小的速度。这个练习将理论概念与实际应用联系起来，演示如何使用给定的多重网格V循环收敛因子来估算达到所需精度的计算工作量。通过这个基本计算，您可以将在选择和调整数值天气预报模型中的求解器时，对迭代次数和计算成本进行预先评估。",
            "id": "4068391",
            "problem": "在用于数值天气预报 (NWP) 的旋转浅水方程的半隐式离散化中，由快重力波项的非中心化产生的椭圆亥姆霍兹算子是对称正定的 (SPD)。预条件共轭梯度 (PCG) 法在每次外迭代中使用单个几何多重网格V循环作为右预条件子。考虑应用于线性系统残差的V循环的独立收缩。假设在红黑高斯-赛德尔光滑子和标准 coarsening 方案下，对于一个具有中纬度配置典型中等各向异性的经纬度网格，双网格收敛因子（定义为每个V循环中逐次残差范数的渐近比率）测量为 $\\rho = 0.12$。从残差 $r_k$ 和线性定常过程收敛因子的定义出发，确定最小整数 $k$，使得经过 $k$ 次V循环后的残差范数满足 $\\|r_k\\| \\le 10^{-8}\\,\\|r_0\\|$。通过显式计算所达到的缩减因子 $\\rho^{k}$ 来验证你的估计。以数对 $\\big(k,\\ \\rho^{k}\\big)$ 的形式报告你的答案，其中 $\\rho^{k}$ 四舍五入到3位有效数字。不需要单位。",
            "solution": "问题要求确定一个定常迭代过程达到指定的残差范数缩减量所需的最小迭代次数，该次数用整数 $k$ 表示。所讨论的迭代过程是一个多重网格V循环，其独立收敛行为由一个给定的收敛因子来刻画。\n\n设 $r_i$ 为应用 $i$ 次V循环后的残差向量，$r_0$ 为初始残差。问题提供了渐近收敛因子 $\\rho$，其定义为逐次残差向量范数之比。对于一个线性定常迭代方法，这个关系表示为：\n$$ \\frac{\\|r_i\\|}{\\|r_{i-1}\\|} \\approx \\rho $$\n通过重复应用此关系，我们可以将 $k$ 次循环后的残差范数 $\\|r_k\\|$ 用初始残差范数 $\\|r_0\\|$ 表示：\n$$ \\|r_k\\| = \\frac{\\|r_k\\|}{\\|r_{k-1}\\|} \\frac{\\|r_{k-1}\\|}{\\|r_{k-2}\\|} \\cdots \\frac{\\|r_1\\|}{\\|r_0\\|} \\|r_0\\| \\approx \\rho^k \\|r_0\\| $$\n在本次分析中，我们将此近似视为等式，这是基于渐近因子估算迭代次数的标准做法。\n\n问题指定了残差缩减的目标：\n$$ \\|r_k\\| \\le 10^{-8} \\|r_0\\| $$\n将 $\\|r_k\\|$ 的表达式代入此不等式，得到：\n$$ \\rho^k \\|r_0\\| \\le 10^{-8} \\|r_0\\| $$\n考虑到要使问题有意义，初始残差必须非零（即 $\\|r_0\\| > 0$），我们可以将两边同除以 $\\|r_0\\|$：\n$$ \\rho^k \\le 10^{-8} $$\n给定的收敛因子是 $\\rho = 0.12$。不等式变为：\n$$ (0.12)^k \\le 10^{-8} $$\n为了求解 $k$，我们对两边取自然对数。由于 $\\ln(x)$ 是一个严格递增函数，不等式的方向保持不变：\n$$ \\ln \\left( (0.12)^k \\right) \\le \\ln(10^{-8}) $$\n使用对数幂法则 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$ k \\ln(0.12) \\le -8 \\ln(10) $$\n为了分离出 $k$，我们必须除以 $\\ln(0.12)$。由于对数的参数 $0.12$ 在区间 $(0, 1)$ 内，其对数 $\\ln(0.12)$ 是一个负数。用负数除一个不等式需要反转不等号的方向：\n$$ k \\ge \\frac{-8 \\ln(10)}{\\ln(0.12)} $$\n使用对数的数值 $\\ln(10) \\approx 2.302585$ 和 $\\ln(0.12) \\approx -2.120264$：\n$$ k \\ge \\frac{-8 \\times 2.302585}{-2.120264} \\approx \\frac{18.42068}{2.120264} \\approx 8.6879 $$\n问题要求 $k$ 的最小整数值。由于 $k$ 必须大于或等于 $8.6879$，满足此条件的最小整数是 $k=9$。\n\n第二个任务是通过计算 $k=9$ 时所达到的缩减因子 $\\rho^k$ 来验证此结果。我们必须将此值四舍五入到3位有效数字。\n$$ \\rho^k = (0.12)^9 $$\n$$ (0.12)^9 \\approx 5.159780352 \\times 10^{-9} $$\n将此值四舍五入到3位有效数字，我们得到 $5.16 \\times 10^{-9}$。此值确实小于或等于 $10^{-8}$，证实了 $k=9$ 是足够的。对于 $k=8$，缩减量 $\\rho^8 = (0.12)^8 \\approx 4.2998 \\times 10^{-8}$，大于 $10^{-8}$，这证实了 $k=9$ 是最小的。\n\n因此，V循环的最小次数是 $k=9$，相应的残差范数缩减因子约为 $5.16 \\times 10^{-9}$。所要求的答案是数对 $(k, \\rho^k)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 9  & 5.16 \\times 10^{-9} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了设计高效的多重网格方法，我们需要一种能够从理论上预测其性能的工具，而局部傅里叶分析（LFA）正是这样一种强大的技术。本练习将引导您使用LFA来分析一个典型的二维网格设置中，平滑、限制和插值等不同组件如何共同作用于不同频率的误差。通过推导双网格算子的谱半径，您将深入理解为何多重网格方法如此高效，以及如何通过分析来优化其组件以获得最佳性能。",
            "id": "4068405",
            "problem": "考虑在线性椭圆求解中出现的一种半隐式离散化，该问题常见于大规模数值天气预报 (NWP) 和气候模拟，例如半隐式压力修正。在一个间距为 $h$ 的一维周期性均匀网格上，细网格离散算子 $A_h$ 是标准的二阶差分（离散拉普拉斯算子），其模板为 $\\{-1, 2, -1\\}$。因此，将 $A_h$ 应用于傅里叶模式 $e^{\\mathrm{i} j \\theta}$ 会产生符号 $a(\\theta)$，其中 $a(\\theta) = 2 - 2 \\cos(\\theta)$。一种常见的多重网格预处理策略使用双网格误差传播算子\n$$\nE = S_{\\omega} \\left( I - P A_H^{-1} R A_h \\right) S_{\\omega},\n$$\n其中 $S_{\\omega} = I - \\omega D^{-1} A_h$ 是松弛参数为 $\\omega$ 的加权雅可比平滑，$D$ 是 $A_h$ 的对角线，$R$ 是限制，$P$ 是延长（插值），$A_H = R A_h P$ 是伽辽金粗网格算子。假设进行一次前平滑和一次后平滑步骤。\n\n采用模板为 $\\{ \\tfrac{1}{4}, \\tfrac{1}{2}, \\tfrac{1}{4} \\}$ 的全加权限制和线性插值。在无限均匀网格（或周期性网格）上使用局部傅里叶分析 (LFA)，并通过配对波数为 $\\theta$ 和 $\\theta + \\pi$ 的傅里叶模式来分析粗网格补集上的双网格算子。在此设置中，细网格算子在傅里叶基中是对角的，其符号为 $a(\\theta)$ 和 $a(\\theta+\\pi)$；平滑算子也是对角的，其符号为 $s(\\theta)$ 和 $s(\\theta+\\pi)$，其中 $s(\\theta) = 1 - \\omega \\frac{a(\\theta)}{2}$。\n\n在由配对的傅里叶模式 $\\{ e^{\\mathrm{i} j \\theta}, e^{\\mathrm{i} j (\\theta + \\pi)} \\}$ 张成的二维子空间中，推导显式的双网格误差传播符号 $E(\\theta)$，并计算其在与因子2粗化相关的基本频率集上的谱半径 $\\rho(E)$。取加权雅可比参数 $\\omega = \\tfrac{2}{3}$。\n\n请以单一精确值（无单位）的形式给出 $\\rho(E)$ 的最终答案。如果得到一个数值，请以最简分数形式精确表示，不要四舍五入。",
            "solution": "该问题要求使用局部傅里叶分析 (LFA) 来确定一维离散拉普拉斯算子的双网格误差传播算子的谱半径。该过程涉及分析各种多重网格分量（平滑、限制、延长、粗网格求解）对傅里叶模式的作用。\n\n分析在由一个低频傅里叶模式 $e^{\\mathrm{i} j \\theta}$ 及其对应的高频混叠模式 $e^{\\mathrm{i} j (\\theta + \\pi)}$ 张成的二维子空间中进行，其中 $j$ 是网格点索引，$\\theta \\in [0, \\frac{\\pi}{2}]$ 是对应于因子2粗化的基本频率集中的波数。\n\n首先，我们在这个 $2 \\times 2$ 框架中为每个算子建立傅里叶符号。算子 $O$ 的傅里叶符号 $\\hat{O}(\\theta)$ 描述了它在配对的傅里叶模式上的作用。\n\n1.  **细网格算子 $A_h$**：\n    问题陈述 $A_h$ 的模板为 $\\{-1, 2, -1\\}$。$A_h$ 作用于模式 $e^{\\mathrm{i} j \\theta}$ 会产生 $a(\\theta)e^{\\mathrm{i} j \\theta}$，其中符号 $a(\\theta)$ 由 $a(\\theta) = 2 - 2 \\cos(\\theta)$ 给出。\n    在傅里叶基中，对配对模式的作用是对角的。符号矩阵 $\\hat{A}_h(\\theta)$ 为：\n    $$\n    \\hat{A}_h(\\theta) = \\begin{pmatrix} a(\\theta) & 0 \\\\ 0 & a(\\theta+\\pi) \\end{pmatrix}\n    $$\n    使用 $a(\\theta) = 2 - 2 \\cos(\\theta)$ 和 $a(\\theta+\\pi) = 2 - 2 \\cos(\\theta+\\pi) = 2 + 2 \\cos(\\theta)$，我们有：\n    $$\n    \\hat{A}_h(\\theta) = \\begin{pmatrix} 2 - 2 \\cos(\\theta) & 0 \\\\ 0 & 2 + 2 \\cos(\\theta) \\end{pmatrix}\n    $$\n\n2.  **加权雅可比平滑算子 $S_{\\omega}$**：\n    平滑算子为 $S_{\\omega} = I - \\omega D^{-1} A_h$。$A_h$ 的对角线是 $D=2I$。给定松弛参数 $\\omega = \\frac{2}{3}$，平滑算子为 $S_{2/3} = I - \\frac{1}{3} A_h$。\n    其符号 $s(\\theta)$ 为 $s(\\theta) = 1 - \\frac{1}{3} a(\\theta)$。符号矩阵 $\\hat{S}_{2/3}(\\theta)$ 是对角的：\n    $$\n    \\hat{S}_{2/3}(\\theta) = \\begin{pmatrix} s(\\theta) & 0 \\\\ 0 & s(\\theta+\\pi) \\end{pmatrix}\n    $$\n    其中 $s(\\theta) = 1 - \\frac{1}{3}(2 - 2 \\cos(\\theta)) = \\frac{1}{3} + \\frac{2}{3} \\cos(\\theta)$，以及 $s(\\theta+\\pi) = 1 - \\frac{1}{3}(2 + 2 \\cos(\\theta)) = \\frac{1}{3} - \\frac{2}{3} \\cos(\\theta)$。\n\n3.  **限制算子 $R$ 和延长算子 $P$**：\n    对于模板为 $\\{\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}\\}$ 的全加权限制，作用于模式 $e^{\\mathrm{i} j \\theta}$ 的傅里叶符号是 $r(\\theta) = \\frac{1}{2} + \\frac{1}{2} \\cos(\\theta) = \\cos^2(\\frac{\\theta}{2})$。\n    限制算子将低频模式 $\\theta$ 和高频模式 $\\theta+\\pi$ 耦合到单个粗网格模式中。符号 $\\hat{R}(\\theta)$ 是一个 $1 \\times 2$ 矩阵：\n    $$\n    \\hat{R}(\\theta) = \\begin{pmatrix} r(\\theta) & r(\\theta+\\pi) \\end{pmatrix}\n    $$\n    其中 $r(\\theta+\\pi) = \\frac{1}{2} + \\frac{1}{2} \\cos(\\theta+\\pi) = \\frac{1}{2} - \\frac{1}{2} \\cos(\\theta) = \\sin^2(\\frac{\\theta}{2})$。所以，\n    $$\n    \\hat{R}(\\theta) = \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) & \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n    线性插值 $P$ 是全加权限制的伴随算子，因此其符号 $\\hat{P}(\\theta)$ 是 $\\hat{R}(\\theta)$ 的共轭转置：\n    $$\n    \\hat{P}(\\theta) = \\hat{R}(\\theta)^* = \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n\n4.  **粗网格算子 $A_H$**：\n    伽辽金粗网格算子 $A_H = R A_h P$ 有一个标量 ($1 \\times 1$) 符号 $\\hat{A}_H(\\theta)$：\n    $$\n    \\hat{A}_H(\\theta) = \\hat{R}(\\theta) \\hat{A}_h(\\theta) \\hat{P}(\\theta) = a(\\theta) r(\\theta)^2 + a(\\theta+\\pi) r(\\theta+\\pi)^2\n    $$\n    代入符号：\n    $\\hat{A}_H(\\theta) = (2 - 2 \\cos(\\theta))(\\cos^2(\\frac{\\theta}{2}))^2 + (2 + 2 \\cos(\\theta))(\\sin^2(\\frac{\\theta}{2}))^2$\n    使用 $2-2\\cos(\\theta) = 4\\sin^2(\\frac{\\theta}{2})$ 和 $2+2\\cos(\\theta) = 4\\cos^2(\\frac{\\theta}{2})$：\n    $\\hat{A}_H(\\theta) = 4\\sin^2(\\frac{\\theta}{2}) \\cos^4(\\frac{\\theta}{2}) + 4\\cos^2(\\frac{\\theta}{2}) \\sin^4(\\frac{\\theta}{2})$\n    $= 4\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) (\\cos^2(\\frac{\\theta}{2}) + \\sin^2(\\frac{\\theta}{2}))$\n    $= (2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2}))^2 = \\sin^2(\\theta)$。\n\n5.  **双网格误差传播算子符号 $E(\\theta)$**：\n    误差传播算子为 $E = S_{\\omega} (I - P A_H^{-1} R A_h) S_{\\omega}$。其符号为 $\\hat{E}(\\theta) = \\hat{S}_{\\omega}(\\theta) \\hat{C}(\\theta) \\hat{S}_{\\omega}(\\theta)$，其中 $\\hat{C}(\\theta) = I - \\hat{P}(\\theta)\\hat{A}_H(\\theta)^{-1}\\hat{R}(\\theta)\\hat{A}_h(\\theta)$ 是粗网格校正的符号。\n    首先，我们计算乘积 $M(\\theta)=\\hat{P}(\\theta)\\hat{A}_H(\\theta)^{-1}\\hat{R}(\\theta)$：\n    $$\n    M(\\theta) = \\frac{1}{\\sin^2(\\theta)} \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix} \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) & \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix} = \\frac{1}{4\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2})} \\begin{pmatrix} \\cos^4(\\frac{\\theta}{2}) & \\cos^2(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) & \\sin^4(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n    然后，粗网格校正部分的符号是：$\\hat{C}(\\theta) = I - M(\\theta) \\hat{A}_h(\\theta)$。\n    $$\n    M(\\theta) \\hat{A}_h(\\theta) = M(\\theta) \\begin{pmatrix} 4\\sin^2(\\frac{\\theta}{2}) & 0 \\\\ 0 & 4\\cos^2(\\frac{\\theta}{2}) \\end{pmatrix} = \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) & \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) & \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n    所以，粗网格校正符号为：\n    $$\n    \\hat{C}(\\theta) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) & \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) & \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix} = \\begin{pmatrix} \\sin^2(\\frac{\\theta}{2}) & -\\cos^2(\\frac{\\theta}{2}) \\\\ -\\sin^2(\\frac{\\theta}{2}) & \\cos^2(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n    现在我们组装完整的双网格符号 $\\hat{E}(\\theta) = \\hat{S}_{\\omega}(\\theta) \\hat{C}(\\theta) \\hat{S}_{\\omega}(\\theta)$：\n    $$\n    \\hat{E}(\\theta) = \\begin{pmatrix} s(\\theta) & 0 \\\\ 0 & s(\\theta+\\pi) \\end{pmatrix} \\begin{pmatrix} \\sin^2(\\frac{\\theta}{2}) & -\\cos^2(\\frac{\\theta}{2}) \\\\ -\\sin^2(\\frac{\\theta}{2}) & \\cos^2(\\frac{\\theta}{2}) \\end{pmatrix} \\begin{pmatrix} s(\\theta) & 0 \\\\ 0 & s(\\theta+\\pi) \\end{pmatrix}\n    $$\n    $$\n    \\hat{E}(\\theta) = \\begin{pmatrix} s(\\theta)^2 \\sin^2(\\frac{\\theta}{2}) & -s(\\theta)s(\\theta+\\pi)\\cos^2(\\frac{\\theta}{2}) \\\\ -s(\\theta)s(\\theta+\\pi)\\sin^2(\\frac{\\theta}{2}) & s(\\theta+\\pi)^2 \\cos^2(\\frac{\\theta}{2}) \\end{pmatrix}\n    $$\n\n6.  **谱半径 $\\rho(E)$**：\n    谱半径 $\\rho(E)$ 是 $\\rho(\\hat{E}(\\theta))$ 在 $\\theta \\in [0, \\frac{\\pi}{2}]$ 上的最大值。$\\hat{E}(\\theta)$ 的特征值 $\\lambda$ 是特征多项式 $\\det(\\hat{E}(\\theta) - \\lambda I) = 0$ 的根。\n    $\\hat{E}(\\theta)$ 的行列式是：\n    $\\det(\\hat{E}(\\theta)) = (s(\\theta)^2 \\sin^2(\\frac{\\theta}{2}))(s(\\theta+\\pi)^2 \\cos^2(\\frac{\\theta}{2})) - (-s(\\theta)s(\\theta+\\pi)\\cos^2(\\frac{\\theta}{2}))(-s(\\theta)s(\\theta+\\pi)\\sin^2(\\frac{\\theta}{2})) = 0$。\n    由于行列式为 $0$，一个特征值为 $\\lambda_1 = 0$。另一个特征值是矩阵的迹：\n    $$\n    \\lambda_2(\\theta) = \\mathrm{tr}(\\hat{E}(\\theta)) = s(\\theta)^2 \\sin^2(\\frac{\\theta}{2}) + s(\\theta+\\pi)^2 \\cos^2(\\frac{\\theta}{2})\n    $$\n    $\\hat{E}(\\theta)$ 的谱半径是 $\\rho(\\hat{E}(\\theta)) = |\\lambda_2(\\theta)|$。我们来分析这个表达式。令 $C = \\cos(\\theta)$。\n    $s(\\theta) = \\frac{1}{3} + \\frac{2}{3}C$\n    $s(\\theta+\\pi) = \\frac{1}{3} - \\frac{2}{3}C$\n    $\\sin^2(\\frac{\\theta}{2}) = \\frac{1-C}{2}$\n    $\\cos^2(\\frac{\\theta}{2}) = \\frac{1+C}{2}$\n\n    将这些代入 $\\lambda_2(\\theta)$ 的表达式中：\n    $$\n    \\lambda_2(C) = \\left(\\frac{1+2C}{3}\\right)^2 \\left(\\frac{1-C}{2}\\right) + \\left(\\frac{1-2C}{3}\\right)^2 \\left(\\frac{1+C}{2}\\right)\n    $$\n    $$\n    \\lambda_2(C) = \\frac{1}{18} \\left[ (1+4C+4C^2)(1-C) + (1-4C+4C^2)(1+C) \\right]\n    $$\n    展开括号中的项：\n    $(1+4C+4C^2)(1-C) = 1+3C-4C^3$\n    $(1-4C+4C^2)(1+C) = 1-3C+4C^3$\n    将这两项相加得到 $(1+3C-4C^3) + (1-3C+4C^3) = 2$。\n    因此，\n    $$\n    \\lambda_2(C) = \\frac{1}{18} [2] = \\frac{1}{9}\n    $$\n    特征值 $\\lambda_2$ 对于所有频率 $\\theta$ 都是常数，等于 $\\frac{1}{9}$。这是该多重网格设置在选择了最优平滑参数 $\\omega=\\frac{2}{3}$ 时的特有属性。\n    因为对于所有 $\\theta$，$\\lambda_2(\\theta) = \\frac{1}{9} > 0$，所以该符号的谱半径为 $\\rho(\\hat{E}(\\theta)) = \\frac{1}{9}$。\n    双网格算子的谱半径是所有相关频率上的上确界：\n    $$\n    \\rho(E) = \\sup_{\\theta \\in [0, \\pi/2]} \\rho(\\hat{E}(\\theta)) = \\sup_{\\theta \\in [0, \\pi/2]} \\frac{1}{9} = \\frac{1}{9}\n    $$\n双网格误差传播算子的谱半径是 $\\frac{1}{9}$。",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        },
        {
            "introduction": "在现代高性能计算环境中，算法的并行可扩展性与纯粹的数值效率同等重要，尤其是在时间紧迫的数值天气预报中。本练习探讨了算法设计中一个核心的权衡问题：数值性能与并行潜力之间的矛盾。通过对顺序（字典序）高斯-赛德尔平滑和并行友好（红黑着色）高斯-赛德尔平滑进行定量比较，您将发现一种旨在提高并行速度的修改有时会牺牲数值收敛性，这是为现代超级计算机设计求解器时面临的中心挑战。",
            "id": "4068346",
            "problem": "考虑在用于数值天气预报和气候模拟的正压原始方程模型中出现的半隐式压力修正。在一个均匀的经纬度网格片上，每个时间步必须求解的椭圆子问题可以沿单条水平线理想化为具有三点模板的离散一维泊松算子。设离散算子在无限均匀网格上定义为 $A u_i = -u_{i-1} + 2 u_i - u_{i+1}$，并考虑使用高斯-赛德尔（GS）方法进行迭代光滑，作为诸如预条件共轭梯度（PCG）等克雷洛夫求解器的多重网格预条件子的一部分。\n\n您需要分析红黑着色对并行高斯-赛德尔方法的影响，并从两个方面量化其相对于字典序的影响：\n\n1. 光滑因子变化：在无限网格上使用局部傅里叶分析，推导作用于傅里叶模式 $e_i = \\exp(\\mathrm{i} \\theta i)$ 的单次前向字典序高斯-赛德尔扫描的误差放大因子，并确定字典序光滑因子 $\\mu_{\\mathrm{lex}}$ 为高频集 $\\Theta_{\\mathrm{hf}} = [\\pi/2,\\pi]$ 上放大因子幅值的最大值。然后，分析双色红黑高斯-赛德尔扫描并确定其在同一高频集上的光滑因子 $\\mu_{\\mathrm{RB}}$。最后，计算光滑因子的变化，定义为比率 $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$，并将该比率表示为精确的闭式表达式。\n\n2. 并行加速比：使用阿姆达尔定律（Amdahl’s law）对 $P=64$ 个相同处理单元上的并行执行进行建模。假设由于波前依赖性，字典序下可并行化的工作部分为 $\\phi_{\\mathrm{lex}} = 0.70$，而在红黑着色下为 $\\phi_{\\mathrm{RB}} = 0.97$（剩余部分用于同步和通信开销）。设相对于纯串行基准的并行时间因子为 $t_{\\mathrm{lex}}(P) = (1 - \\phi_{\\mathrm{lex}}) + \\phi_{\\mathrm{lex}}/P$ 和 $t_{\\mathrm{RB}}(P) = (1 - \\phi_{\\mathrm{RB}}) + \\phi_{\\mathrm{RB}}/P$。计算红黑高斯-赛德尔相对于字典序的预期加速比，定义为 $S = t_{\\mathrm{lex}}(P) / t_{\\mathrm{RB}}(P)$。\n\n将加速比 $S$ 四舍五入到四位有效数字，并将其表示为一个纯数。将光滑因子变化 $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$ 表示为精确表达式。您的最终答案必须以一个二元行矩阵 $\\begin{pmatrix} S & \\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}} \\end{pmatrix}$ 的形式给出。",
            "solution": "本题旨在通过局部傅里叶分析和阿姆达尔定律，比较字典序高斯-赛德尔（GS）光滑与红黑高斯-赛德尔光滑在数值性能和并行潜力上的差异。\n\n**第1部分：光滑因子分析**\n\n我们对误差传播过程进行傅里叶分析，以确定不同GS变体的光滑因子。\n\n**A. 字典序高斯-赛德尔光滑**\n\n对于一维离散泊松算子，一次前向字典序GS扫描的误差更新方程为：\n$$- e_{i-1}^{k+1} + 2 e_i^{k+1} - e_{i+1}^{k} = 0$$\n代入傅里叶模式 $e_i^k = (g(\\theta))^k \\exp(\\mathrm{i} \\theta i)$，其中 $g(\\theta)$ 是放大因子，我们得到：\n$$- g_{\\mathrm{lex}}(\\theta) e^{-\\mathrm{i}\\theta} + 2 g_{\\mathrm{lex}}(\\theta) - e^{\\mathrm{i}\\theta} = 0$$\n求解 $g_{\\mathrm{lex}}(\\theta)$：\n$$g_{\\mathrm{lex}}(\\theta) = \\frac{e^{\\mathrm{i}\\theta}}{2 - e^{-\\mathrm{i}\\theta}}$$\n其幅值为：\n$$|g_{\\mathrm{lex}}(\\theta)| = \\left| \\frac{\\cos\\theta + \\mathrm{i}\\sin\\theta}{2 - (\\cos\\theta - \\mathrm{i}\\sin\\theta)} \\right| = \\frac{1}{\\sqrt{(2 - \\cos\\theta)^2 + \\sin^2\\theta}} = \\frac{1}{\\sqrt{5 - 4\\cos\\theta}}$$\n光滑因子 $\\mu_{\\mathrm{lex}}$ 定义为高频范围 $\\theta \\in [\\pi/2, \\pi]$ 内放大因子的最大值。为了最大化 $|g_{\\mathrm{lex}}(\\theta)|$，我们需要最小化分母 $5 - 4\\cos\\theta$。在此区间内，该函数的最小值出现在 $\\theta=\\pi/2$ 处。因此：\n$$\\mu_{\\mathrm{lex}} = |g_{\\mathrm{lex}}(\\pi/2)| = \\frac{1}{\\sqrt{5 - 4\\cos(\\pi/2)}} = \\frac{1}{\\sqrt{5}}$$\n\n**B. 红黑高斯-赛德尔光滑**\n\n对于一维泊松算子，红黑GS光滑的放大因子是其对应的雅可比方法放大因子的平方。雅可比方法的放大因子为 $\\cos\\theta$，因此红黑GS的放大因子为：\n$$g_{\\mathrm{RB}}(\\theta) = \\cos^2(\\theta)$$\n光滑因子 $\\mu_{\\mathrm{RB}}$ 是高频范围 $\\theta \\in [\\pi/2, \\pi]$ 内放大因子的最大值。在此区间内，$|\\cos^2(\\theta)|$ 的最大值出现在 $\\theta=\\pi$ 处：\n$$\\mu_{\\mathrm{RB}} = |\\cos^2(\\pi)| = (-1)^2 = 1$$\n\n**C. 光滑因子变化**\n\n光滑因子的变化由比率 $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$ 给出：\n$$\\frac{\\mu_{\\mathrm{RB}}}{\\mu_{\\mathrm{lex}}} = \\frac{1}{1/\\sqrt{5}} = \\sqrt{5}$$\n这表明红黑排序在数值上（即光滑高频误差的能力上）不如字典序排序。\n\n**第2部分：并行加速比分析**\n\n我们使用阿姆达尔定律和给定的参数计算相对加速比。\n已知：处理器数量 $P = 64$，字典序可并行化部分 $\\phi_{\\mathrm{lex}} = 0.70$，红黑序可并行化部分 $\\phi_{\\mathrm{RB}} = 0.97$。\n\n字典序方法的并行时间因子为：\n$$t_{\\mathrm{lex}}(64) = (1 - \\phi_{\\mathrm{lex}}) + \\frac{\\phi_{\\mathrm{lex}}}{P} = (1 - 0.70) + \\frac{0.70}{64} = 0.30 + 0.0109375 = 0.3109375$$\n\n红黑方法的并行时间因子为：\n$$t_{\\mathrm{RB}}(64) = (1 - \\phi_{\\mathrm{RB}}) + \\frac{\\phi_{\\mathrm{RB}}}{P} = (1 - 0.97) + \\frac{0.97}{64} = 0.03 + 0.01515625 = 0.04515625$$\n\n红黑GS相对于字典序GS的预期加速比 $S$ 是它们执行时间的比率：\n$$S = \\frac{t_{\\mathrm{lex}}(64)}{t_{\\mathrm{RB}}(64)} = \\frac{0.3109375}{0.04515625} \\approx 6.8860759...$$\n四舍五入到四位有效数字，我们得到 $S \\approx 6.886$。\n\n这表明红黑排序提供了显著的并行加速，尽管其数值光滑性能较差。这就是高性能计算中常见的性能与并行性之间的权衡。",
            "answer": "$$\\boxed{\\begin{pmatrix} 6.886 & \\sqrt{5} \\end{pmatrix}}$$"
        }
    ]
}