{
    "hands_on_practices": [
        {
            "introduction": "任何区域模型都必须遵守基本的物理定律，其中质量守恒是最关键的一条。从粗分辨率母模型提供的侧边界条件并不自动保证区域模型内部的质量守恒，这可能导致人为的质量增加或减少。本练习  提供了一种实践方法，用于根据边界通量数据诊断质量不平衡问题，并实施一种简单实用的修正方案，这是模型开发和诊断中的一项常见任务。",
            "id": "4059193",
            "problem": "一个用于数值天气预报（NWP）的有限区域模式（LAM）在一个矩形域上进行积分，该域的西、东、南、北四侧设有侧边界。设每个侧边界上的外向单位法向量为 $\\mathbf{n}$，空气密度为 $\\rho$，风为 $\\mathbf{u}$。边界上的法向风分量为 $u_{n} = \\mathbf{u} \\cdot \\mathbf{n}$。假设在所关注的时间段内，模式顶部和底部的垂直通量可以忽略不计，且侧边界的质量通量在 $6$ 小时内近似为常数。\n\n由 $\\rho u_{n}$ 引起的、经垂直和沿边界积分的、向外为正的质量通量率在每个侧边界上如下（单位：千克/秒）：\n- 西侧：$Q_{\\mathrm{W}} = -3.0 \\times 10^{7}$，\n- 东侧：$Q_{\\mathrm{E}} = +4.0 \\times 10^{7}$，\n- 南侧：$Q_{\\mathrm{S}} = +1.5 \\times 10^{7}$，\n- 北侧：$Q_{\\mathrm{N}} = -0.5 \\times 10^{7}$。\n\n此外，每个侧边界对应的无符号积分量值（即 $\\rho |u_{n}|$ 的积分）为：\n- 西侧：$M_{\\mathrm{W}} = 4.5 \\times 10^{7}$，\n- 东侧：$M_{\\mathrm{E}} = 4.0 \\times 10^{7}$，\n- 南侧：$M_{\\mathrm{S}} = 2.5 \\times 10^{7}$，\n- 北侧：$M_{\\mathrm{N}} = 2.0 \\times 10^{7}$。\n\n以连续性方程和散度定理为基本依据，完成以下任务：\n1. 计算由这些侧向通量引起的域内 $6$ 小时内的累积总质量不平衡 $\\Delta M$。请用千克表示最终的 $\\Delta M$。\n2. 提出一种对边界法向风的比例校正方案，该方案统一地缩减外流并增益内流，从而使侧向质量收支在主导项上闭合。具体来说，考虑以下乘法校正\n$$\nu_{n}' = u_{n}\\left(1 - \\alpha \\,\\mathrm{sgn}(u_{n})\\right),\n$$\n其中 $\\mathrm{sgn}(\\cdot)$ 是符号函数，$\\alpha$ 是一个无量纲常数，统一应用于所有侧边界。推导使净侧向质量通量在主导项上为零的 $\\alpha$ 表达式，并根据上述数据计算其值。\n\n将质量不平衡 $\\Delta M$ 四舍五入至三位有效数字，校正因子 $\\alpha$ 四舍五入至四位有效数字。在最终答案框中报告您的最终答案，不带单位；第一个条目是质量不平衡（单位：千克），第二个条目是无量纲校正因子。",
            "solution": "该问题要求计算有限区域模式（LAM）域在指定时间内的总质量不平衡，并推导一个校正因子以消除这种不平衡。解答相应地分为两部分。\n\n**第一部分：累积总质量不平衡**\n\n控制体积 $V$ 内质量变化的基本原理是连续性方程，其积分形式可以写为：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\int_V \\rho \\, dV = - \\oint_{\\partial V} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA\n$$\n这里，$M(t)$ 是域内空气的总质量，$\\rho$ 是空气密度，$\\mathbf{u}$ 是风矢量，$\\mathbf{n}$ 是边界 $\\partial V$ 上指向外部的单位法向量。右侧项表示进入域内的净质量通量率。\n\n问题说明，模式顶部和底部的垂直通量可以忽略不计。因此，总通量是穿过四个侧边界（西、东、南、北）的通量之和：\n$$\n\\oint_{\\partial V} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA \\approx \\sum_{i \\in \\{\\mathrm{W, E, S, N}\\}} \\int_{A_i} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA_i\n$$\n其中 $A_i$ 是侧边界 $i$ 的面积。\n\n问题给出了每个侧边界经垂直和沿边界积分的、向外为正的质量通量率 $Q_i$：\n$$\nQ_i = \\int_{A_i} \\rho u_n \\, dA_i\n$$\n其中 $u_n = \\mathbf{u} \\cdot \\mathbf{n}$。总的净向外质量通量率 $Q_{net}$ 是这些单独通量率的总和：\n$$\nQ_{net} = Q_{\\mathrm{W}} + Q_{\\mathrm{E}} + Q_{\\mathrm{S}} + Q_{\\mathrm{N}}\n$$\n代入给定值：\n$$\nQ_{net} = (-3.0 \\times 10^{7} \\, \\mathrm{kg/s}) + (4.0 \\times 10^{7} \\, \\mathrm{kg/s}) + (1.5 \\times 10^{7} \\, \\mathrm{kg/s}) + (-0.5 \\times 10^{7} \\, \\mathrm{kg/s})\n$$\n$$\nQ_{net} = (-3.0 + 4.0 + 1.5 - 0.5) \\times 10^{7} \\, \\mathrm{kg/s} = 2.0 \\times 10^{7} \\, \\mathrm{kg/s}\n$$\n$Q_{net}$ 的正值表示有质量从域中净流出。\n\n因此，域内质量的变化率为：\n$$\n\\frac{dM}{dt} = -Q_{net} = -2.0 \\times 10^{7} \\, \\mathrm{kg/s}\n$$\n问题说明，该速率在 $\\Delta t = 6 \\, \\mathrm{h}$ 的时间间隔内是恒定的。首先，我们将此时间间隔转换为秒：\n$$\n\\Delta t = 6 \\, \\mathrm{h} \\times \\frac{3600 \\, \\mathrm{s}}{1 \\, \\mathrm{h}} = 21600 \\, \\mathrm{s} = 2.16 \\times 10^{4} \\, \\mathrm{s}\n$$\n累积总质量不平衡 $\\Delta M$ 是此期间的总质量变化：\n$$\n\\Delta M = \\int_0^{\\Delta t} \\frac{dM}{dt} \\, dt = \\frac{dM}{dt} \\times \\Delta t\n$$\n$$\n\\Delta M = (-2.0 \\times 10^{7} \\, \\mathrm{kg/s}) \\times (2.16 \\times 10^{4} \\, \\mathrm{s}) = -4.32 \\times 10^{11} \\, \\mathrm{kg}\n$$\n该值已按要求给出三位有效数字。\n\n**第二部分：比例校正因子**\n\n问题的第二部分要求一个无量纲常数 $\\alpha$，用于校正法向风分量 $u_n$，以使净质量收支闭合。建议的校正方法是：\n$$\nu_{n}' = u_{n}(1 - \\alpha \\,\\mathrm{sgn}(u_{n}))\n$$\n通过边界 $i$ 的新质量通量率，记为 $Q'_i$，是：\n$$\nQ'_i = \\int_{A_i} \\rho u'_n \\, dA_i = \\int_{A_i} \\rho u_n (1 - \\alpha \\,\\mathrm{sgn}(u_n)) \\, dA_i\n$$\n这个积分可以分为两部分：\n$$\nQ'_i = \\int_{A_i} \\rho u_n \\, dA_i - \\alpha \\int_{A_i} \\rho u_n \\,\\mathrm{sgn}(u_n) \\, dA_i\n$$\n认识到 $u_n \\,\\mathrm{sgn}(u_n) = |u_n|$，方程变为：\n$$\nQ'_i = \\int_{A_i} \\rho u_n \\, dA_i - \\alpha \\int_{A_i} \\rho |u_n| \\, dA_i\n$$\n问题为这些积分提供了定义：有符号通量率 $Q_i = \\int_{A_i} \\rho u_n \\, dA_i$ 和无符号积分量值 $M_i = \\int_{A_i} \\rho |u_n| \\, dA_i$。将这些代入 $Q'_i$ 的表达式中：\n$$\nQ'_i = Q_i - \\alpha M_i\n$$\n为了闭合侧向质量收支，新的总净通量率 $Q'_{net}$ 必须为零。$Q'_{net}$ 是所有边界上校正后通量的总和：\n$$\nQ'_{net} = \\sum_{i \\in \\{\\mathrm{W,E,S,N}\\}} Q'_i = \\sum_{i} (Q_i - \\alpha M_i) = 0\n$$\n重新整理该和式：\n$$\n\\left(\\sum_i Q_i\\right) - \\alpha \\left(\\sum_i M_i\\right) = 0\n$$\n令 $Q_{net} = \\sum_i Q_i$ 为原始总净通量，$M_{total} = \\sum_i M_i$ 为所有无符号通量量值的总和。关于 $\\alpha$ 的方程是：\n$$\nQ_{net} - \\alpha M_{total} = 0\n$$\n求解 $\\alpha$，我们得到表达式：\n$$\n\\alpha = \\frac{Q_{net}}{M_{total}}\n$$\n我们现在使用给定数据计算 $\\alpha$ 的值。我们已经求得 $Q_{net} = 2.0 \\times 10^{7} \\, \\mathrm{kg/s}$。我们计算 $M_{total}$：\n$$\nM_{total} = M_{\\mathrm{W}} + M_{\\mathrm{E}} + M_{\\mathrm{S}} + M_{\\mathrm{N}}\n$$\n$$\nM_{total} = (4.5 \\times 10^{7}) + (4.0 \\times 10^{7}) + (2.5 \\times 10^{7}) + (2.0 \\times 10^{7}) \\, \\mathrm{kg/s}\n$$\n$$\nM_{total} = (4.5 + 4.0 + 2.5 + 2.0) \\times 10^{7} \\, \\mathrm{kg/s} = 13.0 \\times 10^{7} \\, \\mathrm{kg/s} = 1.3 \\times 10^{8} \\, \\mathrm{kg/s}\n$$\n现在，代入 $Q_{net}$ 和 $M_{total}$ 的值来求 $\\alpha$：\n$$\n\\alpha = \\frac{2.0 \\times 10^{7} \\, \\mathrm{kg/s}}{1.3 \\times 10^{8} \\, \\mathrm{kg/s}} = \\frac{2.0}{13.0} \\approx 0.15384615...\n$$\n按要求四舍五入到四位有效数字：\n$$\n\\alpha \\approx 0.1538\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -4.32 \\times 10^{11}  0.1538 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在解决了全局守恒问题之后，我们将注意力转向动力学误差。一个关键挑战是让波能够离开模拟区域而不产生虚假的反射，因为这些反射会污染内部解。本练习探讨索末菲（Sommerfeld）辐射条件——一种创建“开放”边界的常用方法，并从数学上证明了假设的波位相速度误差如何导致非物理反射。通过推导反射系数 ，您将对边界条件的不完美之处如何产生噪音获得定量的理解，这对于设计和调试稳健的数值模型至关重要。",
            "id": "4059131",
            "problem": "考虑一个在数值天气预报（NWP）和气候模拟中使用的区域大气模型的一维侧边界。在此边界上，线性化浅水重力波以相速度 $c = \\sqrt{g H}$ 传播，并满足非色散的色散关系 $\\omega = c k$，其中 $g$ 表示重力加速度，$H$ 表示平均流体深度，$k$ 表示波数，$\\omega$ 表示角频率。在模型位于 $x=0$ 的左边界处，预设的开放（辐射）边界条件针对向外传播的左行波，以通常的 Sommerfeld 形式实现，但存在相速度误差：边界算子使用了 $c_{b} = c + \\delta c$ 而非真实的 $c$，这导致了一个不完美的辐射条件。假设一个单色、左行、平面重力波从内部区域（$x>0$）入射到该边界上。边界附近的总场是入射的左行波与反射的右行波的叠加。\n\n从线性化浅水波运动学和应用于边界预报场的标准左行波辐射边界算子（即 $(\\partial_{t} - c_{b}\\,\\partial_{x})$）出发，推导复反射系数 $R$。该系数定义为反射波振幅与入射波振幅之比，并表示为 $\\delta c$、$k$ 和 $c$ 的函数。然后，通过计算一阶导数 $\\partial R / \\partial(\\delta c)$ 在 $\\delta c = 0$ 处的值，来定量评估 $R$ 对相速度误差的敏感性。\n\n你的最终答案应为一个行向量，包含两个闭式解析表达式：反射系数 $R(\\delta c,k,c)$ 和敏感性 $\\left.\\frac{\\partial R}{\\partial(\\delta c)}\\right|_{\\delta c=0}$。无需进行数值计算。反射系数是无量纲的，敏感性的量纲是速度的倒数。最终答案中不要包含物理单位。如果产生数值近似值，请四舍五入到四位有效数字；否则，请提供精确表达式。",
            "solution": "设预报场变量（例如浅水系统中的自由表面高度）用 $\\eta(x,t)$ 表示。问题陈述一个单色、左行的平面波从区域内部（即 $x>0$）入射到位于 $x=0$ 的边界上。一个以角频率 $\\omega$ 和波数 $k$ 在负x方向（左行）传播的波可以用复指数形式表示为：\n$$ \\eta_I(x,t) = A_I \\exp\\left[i(kx + \\omega t)\\right] $$\n此处，$A_I$ 是入射波的复振幅。色散关系为 $\\omega = ck$，其中 $c$ 是真实的相速度。该波的相速度为 $v_p = -\\omega/k = -c$，证实其为左行波。\n\n当遇到位于 $x=0$ 的不完美边界时，该波的一部分会被反射。反射波必须从边界传播回区域内部，即沿正x方向（右行）。由于介质是线性、均匀且时不变的，该波将具有相同的频率 $\\omega$ 和波数大小 $k$。反射波的形式为：\n$$ \\eta_R(x,t) = A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n此处，$A_R$ 是反射波的复振幅。其相速度为 $v_p = \\omega/k = c$，证实其为右行波。\n\n边界附近的总场 $\\eta(x,t)$ 是入射波和反射波的线性叠加：\n$$ \\eta(x,t) = \\eta_I(x,t) + \\eta_R(x,t) = A_I \\exp\\left[i(kx + \\omega t)\\right] + A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n\n辐射边界条件应用于 $x=0$ 处。算子为 $(\\partial_{t} - c_{b}\\,\\partial_{x})$，其中 $c_b = c + \\delta c$ 是在边界条件实现中使用的错误相速度。该条件为：\n$$ \\left. \\left( \\frac{\\partial}{\\partial t} - c_b \\frac{\\partial}{\\partial x} \\right) \\eta(x,t) \\right|_{x=0} = 0 $$\n为应用此条件，我们首先计算总场 $\\eta(x,t)$ 的偏导数：\n$$ \\frac{\\partial \\eta}{\\partial t} = i\\omega A_I \\exp\\left[i(kx + \\omega t)\\right] + i\\omega A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n$$ \\frac{\\partial \\eta}{\\partial x} = ik A_I \\exp\\left[i(kx + \\omega t)\\right] - ik A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n现在，我们在边界 $x=0$ 处计算这些导数的值：\n$$ \\left. \\frac{\\partial \\eta}{\\partial t} \\right|_{x=0} = i\\omega (A_I + A_R) \\exp(i\\omega t) $$\n$$ \\left. \\frac{\\partial \\eta}{\\partial x} \\right|_{x=0} = ik (A_I - A_R) \\exp(i\\omega t) $$\n将这些表达式代入边界条件方程，得到：\n$$ i\\omega (A_I + A_R) \\exp(i\\omega t) - c_b \\left[ ik (A_I - A_R) \\exp(i\\omega t) \\right] = 0 $$\n公共因子 $i \\exp(i\\omega t)$ 非零，可以消去：\n$$ \\omega (A_I + A_R) - c_b k (A_I - A_R) = 0 $$\n我们的目标是求出定义为 $R = A_R / A_I$ 的复反射系数 $R$。我们重排方程以解出此比值：\n$$ \\omega A_I + \\omega A_R - c_b k A_I + c_b k A_R = 0 $$\n$$ A_R (\\omega + c_b k) = A_I (c_b k - \\omega) $$\n$$ R = \\frac{A_R}{A_I} = \\frac{c_b k - \\omega}{\\omega + c_b k} $$\n现在，我们代入给定关系 $\\omega = ck$ 和 $c_b = c + \\delta c$：\n$$ R = \\frac{(c + \\delta c) k - ck}{ck + (c + \\delta c) k} $$\n$$ R = \\frac{ck + k \\delta c - ck}{ck + ck + k \\delta c} $$\n$$ R = \\frac{k \\delta c}{2ck + k \\delta c} $$\n由于 $k$ 是物理波的波数，$k \\neq 0$，因此我们可以从分子和分母中消去它。这得到了第一个要求的表达式，即作为 $\\delta c$ 和 $c$ 的函数的反射系数 $R$：\n$$ R(\\delta c,c) = \\frac{\\delta c}{2c + \\delta c} $$\n注意，对于完美的边界条件，$\\delta c = 0$，此时 $R=0$（无反射），正如预期。\n\n任务的第二部分是通过计算一阶导数 $\\partial R / \\partial(\\delta c)$ 并在无误差点 $\\delta c = 0$ 处求值，来评估 $R$ 对相速度误差 $\\delta c$ 的敏感性。我们将 $R$ 对 $\\delta c$ 求导，并将 $c$ 视为常数。使用导数的商法则 $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$，其中 $u = \\delta c$，$v = 2c + \\delta c$：\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{\\frac{\\partial}{\\partial(\\delta c)}(\\delta c) \\cdot (2c + \\delta c) - (\\delta c) \\cdot \\frac{\\partial}{\\partial(\\delta c)}(2c + \\delta c)}{(2c + \\delta c)^2} $$\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{1 \\cdot (2c + \\delta c) - \\delta c \\cdot 1}{(2c + \\delta c)^2} $$\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{2c + \\delta c - \\delta c}{(2c + \\delta c)^2} = \\frac{2c}{(2c + \\delta c)^2} $$\n现在，我们在 $\\delta c = 0$ 处计算该导数的值：\n$$ \\left. \\frac{\\partial R}{\\partial(\\delta c)} \\right|_{\\delta c=0} = \\frac{2c}{(2c + 0)^2} = \\frac{2c}{(2c)^2} = \\frac{2c}{4c^2} = \\frac{1}{2c} $$\n这个表达式表示反射系数对边界相速度中小误差的一阶敏感性。这是第二个要求的表达式。\n\n最终答案是包含两个推导出的表达式的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\delta c}{2c + \\delta c}  \\frac{1}{2c}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从一维边界转向现实的二维区域会引入新的挑战，特别是在不同边界条件相交的角落点。相邻边界之间在数据或公式上的不兼容性，可能在角落网格点处形成一个持续的局部误差源。本练习  旨在分析这种角落不匹配如何被数值格式放大或衰减，从而突显在多维模型中确保不同侧边界条件之间兼容性的重要性。",
            "id": "4059117",
            "problem": "考虑一个用于数值天气预报 (NWP) 和气候模拟的二维有限区域模式，该模式推进一个标量预报场 $q(x,y,t)$，该场遵循线性平流方程\n$$\n\\frac{\\partial q}{\\partial t} + u\\,\\frac{\\partial q}{\\partial x} + v\\,\\frac{\\partial q}{\\partial y} = 0,\n$$\n其中速度 $u>0$ 和 $v>0$ 为常数。模式区域为矩形 $[0,L_x]\\times[0,L_y]$，因此 $x=0$ 和 $y=0$ 处的边界是入流边界。数值格式是在均匀网格上采用一阶显式迎风有限差分法，网格间距为 $\\Delta x$ 和 $\\Delta y$，时间步长为 $\\Delta t$：\n$$\nq^{n+1}_{i,j} = q^{n}_{i,j} - C_x\\left(q^{n}_{i,j} - q^{n}_{i-1,j}\\right) - C_y\\left(q^{n}_{i,j} - q^{n}_{i,j-1}\\right),\n$$\n其中 $C_x = \\dfrac{u\\,\\Delta t}{\\Delta x}$ 和 $C_y = \\dfrac{v\\,\\Delta t}{\\Delta y}$ 是库朗数。为了在入流边界处闭合该格式，虚单元值由外部信息给定，使用了两种在角点 $(x,y)=(0,0)$ 相交的不同侧边界条件处理方案：\n- 沿 $x=0$（西边界），一个弛豫 (Davies) 格式给定 $q^{n}_{-1,0} = q^{n}_{\\text{ext},x} + \\varepsilon_x$。\n- 沿 $y=0$（南边界），一个 Orlanski 型辐射格式给定 $q^{n}_{0,-1} = q^{n}_{\\text{ext},y} + \\varepsilon_y$。\n\n假设外部目标值与内部解完全相容，因此角点误差的唯一来源是角点处相邻边界给定值之间的不匹配 $\\boldsymbol{\\varepsilon}=(\\varepsilon_x,\\varepsilon_y)$。将一个时间步后的角点更新误差定义为 $e^{n+1}_{0,0} = q^{n+1}_{0,0} - q^{n}_{0,0}$，该误差仅由不匹配 $\\boldsymbol{\\varepsilon}$ 引起。令角点处的误差放大因子为线性映射 $\\boldsymbol{\\varepsilon}\\mapsto e^{n+1}_{0,0}$ 的算子范数（相对于欧几里得范数），即\n$$\nE_{\\max} \\equiv \\sup_{\\boldsymbol{\\varepsilon}\\neq \\boldsymbol{0}} \\frac{|e^{n+1}_{0,0}|}{\\|\\boldsymbol{\\varepsilon}\\|_2}.\n$$\n\n从平流方程和离散更新出发，用 $C_x$ 和 $C_y$ 推导 $E_{\\max}$。然后，对于符合物理实际的中纬度流场和网格设置，取 $u = 20\\,\\text{m s}^{-1}$，$v = 10\\,\\text{m s}^{-1}$，$\\Delta x = 10{,}000\\,\\text{m}$，$\\Delta y = 10{,}000\\,\\text{m}$，以及 $\\Delta t = 300\\,\\text{s}$。计算这些值对应的 $E_{\\max}$。将最终结果四舍五入至四位有效数字。答案以无量纲数表示。\n\n最后，基于你推导的表达式，通过将 $E_{\\max}$ 解释为传播到内部的初始伪波振幅与边界不匹配量级 $\\|\\boldsymbol{\\varepsilon}\\|_2$ 的比率，评估其对角点处伪波生成的影响，并评论在给定参数下，角点是作为放大器还是衰减器。你的最终数值答案应仅为 $E_{\\max}$。",
            "solution": "任务是推导并计算区域模式域角点的误差放大因子。该模式推进一个由二维线性平流方程控制的标量场 $q(x,y,t)$：\n$$\n\\frac{\\partial q}{\\partial t} + u\\,\\frac{\\partial q}{\\partial x} + v\\,\\frac{\\partial q}{\\partial y} = 0\n$$\n其中平流速度 $u$ 和 $v$ 是正常数，这意味着 $x=0$ 和 $y=0$ 处的边界是入流边界。\n\n数值格式为一阶显式迎风有限差分法，由下式给出：\n$$\nq^{n+1}_{i,j} = q^{n}_{i,j} - C_x\\left(q^{n}_{i,j} - q^{n}_{i-1,j}\\right) - C_y\\left(q^{n}_{i,j} - q^{n}_{i,j-1}\\right)\n$$\n其中 $C_x = \\frac{u\\,\\Delta t}{\\Delta x}$ 和 $C_y = \\frac{v\\,\\Delta t}{\\Delta y}$ 是库朗数。\n\n我们关心的是角点网格点 $(i,j)=(0,0)$ 处的更新。该点的格式为：\n$$\nq^{n+1}_{0,0} = q^{n}_{0,0} - C_x\\left(q^{n}_{0,0} - q^{n}_{-1,0}\\right) - C_y\\left(q^{n}_{0,0} - q^{n}_{0,-1}\\right)\n$$\n该方程可以重排，用时间层 $n$ 的值来表示 $q^{n+1}_{0,0}$：\n$$\nq^{n+1}_{0,0} = (1 - C_x - C_y)q^{n}_{0,0} + C_x q^{n}_{-1,0} + C_y q^{n}_{0,-1}\n$$\n值 $q^{n}_{-1,0}$ 和 $q^{n}_{0,-1}$ 来自区域外的虚单元。它们由侧边界条件给定。问题指出，这些给定值包含一个不匹配，由 $\\varepsilon_x$ 和 $\\varepsilon_y$ 表示：\n$$\nq^{n}_{-1,0} = q^{n}_{\\text{ext},x} + \\varepsilon_x\n$$\n$$\nq^{n}_{0,-1} = q^{n}_{\\text{ext},y} + \\varepsilon_y\n$$\n将这些代入角点的更新方程，得到：\n$$\nq^{n+1}_{0,0} = (1 - C_x - C_y)q^{n}_{0,0} + C_x(q^{n}_{\\text{ext},x} + \\varepsilon_x) + C_y(q^{n}_{\\text{ext},y} + \\varepsilon_y)\n$$\n$$\nq^{n+1}_{0,0} = (1 - C_x - C_y)q^{n}_{0,0} + C_x q^{n}_{\\text{ext},x} + C_y q^{n}_{\\text{ext},y} + C_x\\varepsilon_x + C_y\\varepsilon_y\n$$\n问题定义了一个完全相容的状态，其中不匹配为零（$\\varepsilon_x=0$, $\\varepsilon_y=0$），且解是稳态的，即 $q^{n+1}_{0,0} = q^{n}_{0,0}$。在这种理想情况下，方程变为：\n$$\nq^{n}_{0,0} = (1 - C_x - C_y)q^{n}_{0,0} + C_x q^{n}_{\\text{ext},x} + C_y q^{n}_{\\text{ext},y}\n$$\n重排此式可得完全相容的条件：\n$$\n(C_x + C_y)q^{n}_{0,0} = C_x q^{n}_{\\text{ext},x} + C_y q^{n}_{\\text{ext},y}\n$$\n在没有任何不匹配的情况下，该方程将角点处的内部解与外部强迫值联系起来。\n\n角点更新误差定义为 $e^{n+1}_{0,0} = q^{n+1}_{0,0} - q^{n}_{0,0}$，它仅由不匹配 $\\boldsymbol{\\varepsilon}$ 引起。我们假设时间 $n$ 的状态是相容的。\n$$\ne^{n+1}_{0,0} = \\left[(1 - C_x - C_y)q^{n}_{0,0} + C_x q^{n}_{\\text{ext},x} + C_y q^{n}_{\\text{ext},y} + C_x\\varepsilon_x + C_y\\varepsilon_y\\right] - q^{n}_{0,0}\n$$\n$$\ne^{n+1}_{0,0} = -(C_x+C_y)q^{n}_{0,0} + (C_x q^{n}_{\\text{ext},x} + C_y q^{n}_{\\text{ext},y}) + C_x\\varepsilon_x + C_y\\varepsilon_y\n$$\n使用上面推导的相容性条件，右侧的前两项相互抵消：\n$$\n-(C_x+C_y)q^{n}_{0,0} + (C_x + C_y)q^{n}_{0,0} = 0\n$$\n这只留下了与不匹配相关的项：\n$$\ne^{n+1}_{0,0} = C_x\\varepsilon_x + C_y\\varepsilon_y\n$$\n该表达式表示在单个时间步内，角点处引入的误差是边界条件不匹配量 $\\varepsilon_x$ 和 $\\varepsilon_y$ 的线性函数。\n\n误差放大因子 $E_{\\max}$ 定义为线性映射 $\\boldsymbol{\\varepsilon} \\mapsto e^{n+1}_{0,0}$ 的算子范数：\n$$\nE_{\\max} \\equiv \\sup_{\\boldsymbol{\\varepsilon}\\neq \\boldsymbol{0}} \\frac{|e^{n+1}_{0,0}|}{\\|\\boldsymbol{\\varepsilon}\\|_2} = \\sup_{(\\varepsilon_x, \\varepsilon_y)\\neq (0,0)} \\frac{|C_x\\varepsilon_x + C_y\\varepsilon_y|}{\\sqrt{\\varepsilon_x^2 + \\varepsilon_y^2}}\n$$\n分子是库朗数向量 $\\mathbf{C} = (C_x, C_y)$ 与不匹配向量 $\\boldsymbol{\\varepsilon} = (\\varepsilon_x, \\varepsilon_y)$ 之间点积的绝对值。根据柯西-施瓦茨不等式， $|\\mathbf{C} \\cdot \\boldsymbol{\\varepsilon}| \\le \\|\\mathbf{C}\\|_2 \\|\\boldsymbol{\\varepsilon}\\|_2$。当 $\\boldsymbol{\\varepsilon}$ 与 $\\mathbf{C}$ 共线时，达到上确界。因此，该比率的最大值是 $\\mathbf{C}$ 的欧几里得范数：\n$$\nE_{\\max} = \\|\\mathbf{C}\\|_2 = \\sqrt{C_x^2 + C_y^2}\n$$\n这就是推导出的误差放大因子的解析表达式。\n\n接下来，我们使用给定的参数计算其数值：\n$u = 20\\,\\text{m s}^{-1}$，$v = 10\\,\\text{m s}^{-1}$，$\\Delta x = 10{,}000\\,\\text{m}$，$\\Delta y = 10{,}000\\,\\text{m}$，以及 $\\Delta t = 300\\,\\text{s}$。\n\n首先，我们计算库朗数 $C_x$ 和 $C_y$：\n$$\nC_x = \\frac{u\\,\\Delta t}{\\Delta x} = \\frac{(20\\,\\text{m s}^{-1})(300\\,\\text{s})}{10{,}000\\,\\text{m}} = \\frac{6000}{10000} = 0.6\n$$\n$$\nC_y = \\frac{v\\,\\Delta t}{\\Delta y} = \\frac{(10\\,\\text{m s}^{-1})(300\\,\\text{s})}{10{,}000\\,\\text{m}} = \\frac{3000}{10000} = 0.3\n$$\n该格式的稳定性条件是 $C_x + C_y \\le 1$。这里，$0.6 + 0.3 = 0.9 \\le 1$，因此所选参数可实现稳定的数值积分。\n\n现在，我们计算 $E_{\\max}$：\n$$\nE_{\\max} = \\sqrt{C_x^2 + C_y^2} = \\sqrt{(0.6)^2 + (0.3)^2} = \\sqrt{0.36 + 0.09} = \\sqrt{0.45}\n$$\n数值结果四舍五入到四位有效数字为：\n$$\nE_{\\max} \\approx 0.6708\n$$\n\n最后，为了解释， $E_{\\max}$ 表示在角点产生的伪信号的最大可能振幅，该振幅已通过边界数据不匹配的量级 $\\|\\boldsymbol{\\varepsilon}\\|_2$ 进行了归一化。由于 $E_{\\max} \\approx 0.6708  1$，产生的误差量级总是小于不匹配向量的量级。这表明，对于给定的参数，角点起到了边界数据不相容性的 **衰减器** 作用，而不是放大器。在最坏的情况下，从角点传播到区域内部的伪波的初始振幅约为边界不匹配量级的 $67.08\\%$。",
            "answer": "$$\\boxed{0.6708}$$"
        }
    ]
}