{
    "hands_on_practices": [
        {
            "introduction": "质量守恒是流体动力学模型必须满足的基本物理定律。然而，在区域数值模型中，由驱动模型提供的侧边界通量可能与区域模型内部的动力学不完全一致，导致模型区域内出现虚假的质量源或汇。本练习旨在通过一个具体案例，演示如何量化这种由侧边界条件引起的全域质量不平衡，并提出一种实用的修正方案来恢复质量守恒，这是模型诊断和验证中的一项关键技能。",
            "id": "4059193",
            "problem": "一个用于数值天气预报 (NWP) 的区域模式 (LAM) 在一个矩形区域上进行积分，其侧边界分别位于西、东、南、北侧。设每个侧边界上的向外单位法向量表示为 $\\mathbf{n}$，空气密度为 $\\rho$，风矢量为 $\\mathbf{u}$。边界上的法向风分量为 $u_{n} = \\mathbf{u} \\cdot \\mathbf{n}$。假设在所关注的时间段内，模式顶部和底部的垂直通量可忽略不计，并且侧边界质量通量在 $6$ 小时内随时间近似保持不变。\n\n由 $\\rho u_{n}$ 引起的、经垂直和沿边界积分的、带符号（向外为正）的质量通量率在每个侧边界上如下（单位：千克/秒）：\n- 西边界：$Q_{\\mathrm{W}} = -3.0 \\times 10^{7}$，\n- 东边界：$Q_{\\mathrm{E}} = +4.0 \\times 10^{7}$，\n- 南边界：$Q_{\\mathrm{S}} = +1.5 \\times 10^{7}$，\n- 北边界：$Q_{\\mathrm{N}} = -0.5 \\times 10^{7}$。\n\n此外，每个边界对应的无符号积分量值（即 $\\rho |u_{n}|$ 的积分）如下：\n- 西边界：$M_{\\mathrm{W}} = 4.5 \\times 10^{7}$，\n- 东边界：$M_{\\mathrm{E}} = 4.0 \\times 10^{7}$，\n- 南边界：$M_{\\mathrm{S}} = 2.5 \\times 10^{7}$，\n- 北边界：$M_{\\mathrm{N}} = 2.0 \\times 10^{7}$。\n\n以连续性方程和散度定理为基本依据，完成以下任务：\n1. 计算 $6$ 小时内由这些侧向通量导致的区域内累积总质量不平衡量 $\\Delta M$。将最终的 $\\Delta M$ 以千克为单位表示。\n2. 提出一种针对边界法向风的比例修正方案，该方案统一地缩减流出量并增加入流量，从而在一阶近似下闭合侧边界质量收支。具体来说，考虑以下乘法修正：\n$$\nu_{n}' = u_{n}\\left(1 - \\alpha \\,\\mathrm{sgn}(u_{n})\\right),\n$$\n其中 $\\mathrm{sgn}(\\cdot)$ 是符号函数，$\\alpha$ 是一个统一应用于所有侧边界的无量纲常数。推导能使一阶净侧向质量通量为零的 $\\alpha$ 的表达式，并根据上述数据计算其值。\n\n将质量不平衡量 $\\Delta M$ 四舍五入到三位有效数字，修正因子 $\\alpha$ 四舍五入到四位有效数字。在最终答案框中报告您的答案，不带单位；第一个数值是以千克为单位的质量不平衡量，第二个数值是无量纲修正因子。",
            "solution": "问题要求计算在一个区域模式 (LAM) 域内指定时间段内的总质量不平衡，并推导一个修正因子来消除这种不平衡。解答分为相应的两个部分。\n\n**第1部分：累积总质量不平衡**\n\n控制体积 $V$ 内质量变化的基本原理是连续性方程，其积分形式可以写为：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\int_V \\rho \\, dV = - \\oint_{\\partial V} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA\n$$\n此处，$M(t)$ 是域内的总空气质量，$\\rho$ 是空气密度，$\\mathbf{u}$ 是风矢量，$\\mathbf{n}$ 是边界 $\\partial V$ 上指向外部的单位法向量。等式右侧项代表进入域内的净质量通量率。\n\n问题指出，模式顶部和底部的垂直通量可忽略不计。因此，总通量是穿过四个侧边界（西、东、南、北）的通量之和：\n$$\n\\oint_{\\partial V} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA \\approx \\sum_{i \\in \\{\\mathrm{W, E, S, N}\\}} \\int_{A_i} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dA_i\n$$\n其中 $A_i$ 是侧边界 $i$ 的面积。\n\n问题给出了每个侧边界经垂直和沿边界积分的、带符号（向外为正）的质量通量率 $Q_i$：\n$$\nQ_i = \\int_{A_i} \\rho u_n \\, dA_i\n$$\n其中 $u_n = \\mathbf{u} \\cdot \\mathbf{n}$。总净向外质量通量率 $Q_{net}$ 是这些单个通量率的总和：\n$$\nQ_{net} = Q_{\\mathrm{W}} + Q_{\\mathrm{E}} + Q_{\\mathrm{S}} + Q_{\\mathrm{N}}\n$$\n代入给定值：\n$$\nQ_{net} = (-3.0 \\times 10^{7} \\, \\mathrm{kg/s}) + (4.0 \\times 10^{7} \\, \\mathrm{kg/s}) + (1.5 \\times 10^{7} \\, \\mathrm{kg/s}) + (-0.5 \\times 10^{7} \\, \\mathrm{kg/s})\n$$\n$$\nQ_{net} = (-3.0 + 4.0 + 1.5 - 0.5) \\times 10^{7} \\, \\mathrm{kg/s} = 2.0 \\times 10^{7} \\, \\mathrm{kg/s}\n$$\n$Q_{net}$ 的正值表明有质量从该域净流出。\n\n因此，域内质量的变化率为：\n$$\n\\frac{dM}{dt} = -Q_{net} = -2.0 \\times 10^{7} \\, \\mathrm{kg/s}\n$$\n问题指出，在时间间隔 $\\Delta t = 6 \\, \\mathrm{h}$ 内，此速率是恒定的。首先，我们将此时间间隔转换为秒：\n$$\n\\Delta t = 6 \\, \\mathrm{h} \\times \\frac{3600 \\, \\mathrm{s}}{1 \\, \\mathrm{h}} = 21600 \\, \\mathrm{s} = 2.16 \\times 10^{4} \\, \\mathrm{s}\n$$\n累积的总质量不平衡量 $\\Delta M$ 是此期间内的总质量变化：\n$$\n\\Delta M = \\int_0^{\\Delta t} \\frac{dM}{dt} \\, dt = \\frac{dM}{dt} \\times \\Delta t\n$$\n$$\n\\Delta M = (-2.0 \\times 10^{7} \\, \\mathrm{kg/s}) \\times (2.16 \\times 10^{4} \\, \\mathrm{s}) = -4.32 \\times 10^{11} \\, \\mathrm{kg}\n$$\n该值已按要求保留三位有效数字。\n\n**第2部分：比例修正因子**\n\n问题的第二部分要求一个无量纲常数 $\\alpha$ 来修正法向风分量 $u_n$，以使净质量收支闭合。提议的修正是：\n$$\nu_{n}' = u_{n}(1 - \\alpha \\,\\mathrm{sgn}(u_{n}))\n$$\n通过边界 $i$ 的新质量通量率，记为 $Q'_i$，为：\n$$\nQ'_i = \\int_{A_i} \\rho u'_n \\, dA_i = \\int_{A_i} \\rho u_n (1 - \\alpha \\,\\mathrm{sgn}(u_n)) \\, dA_i\n$$\n这个积分可以分为两部分：\n$$\nQ'_i = \\int_{A_i} \\rho u_n \\, dA_i - \\alpha \\int_{A_i} \\rho u_n \\,\\mathrm{sgn}(u_n) \\, dA_i\n$$\n注意到 $u_n \\,\\mathrm{sgn}(u_n) = |u_n|$，方程变为：\n$$\nQ'_i = \\int_{A_i} \\rho u_n \\, dA_i - \\alpha \\int_{A_i} \\rho |u_n| \\, dA_i\n$$\n问题为这些积分提供了定义：带符号的通量率 $Q_i = \\int_{A_i} \\rho u_n \\, dA_i$ 和无符号的积分量值 $M_i = \\int_{A_i} \\rho |u_n| \\, dA_i$。将这些代入 $Q'_i$ 的表达式中：\n$$\nQ'_i = Q_i - \\alpha M_i\n$$\n为闭合侧边界质量收支，新的总净通量率 $Q'_{net}$ 必须为零。$Q'_{net}$ 是所有边界上修正后通量的总和：\n$$\nQ'_{net} = \\sum_{i \\in \\{\\mathrm{W,E,S,N}\\}} Q'_i = \\sum_{i} (Q_i - \\alpha M_i) = 0\n$$\n重新整理求和项：\n$$\n\\left(\\sum_i Q_i\\right) - \\alpha \\left(\\sum_i M_i\\right) = 0\n$$\n设 $Q_{net} = \\sum_i Q_i$ 为原始总净通量，$M_{total} = \\sum_i M_i$ 为所有无符号通量量值的总和。则 $\\alpha$ 的方程为：\n$$\nQ_{net} - \\alpha M_{total} = 0\n$$\n解出 $\\alpha$，我们得到表达式：\n$$\n\\alpha = \\frac{Q_{net}}{M_{total}}\n$$\n现在我们使用给定数据计算 $\\alpha$ 的值。我们已经求得 $Q_{net} = 2.0 \\times 10^{7} \\, \\mathrm{kg/s}$。我们计算 $M_{total}$：\n$$\nM_{total} = M_{\\mathrm{W}} + M_{\\mathrm{E}} + M_{\\mathrm{S}} + M_{\\mathrm{N}}\n$$\n$$\nM_{total} = (4.5 \\times 10^{7}) + (4.0 \\times 10^{7}) + (2.5 \\times 10^{7}) + (2.0 \\times 10^{7}) \\, \\mathrm{kg/s}\n$$\n$$\nM_{total} = (4.5 + 4.0 + 2.5 + 2.0) \\times 10^{7} \\, \\mathrm{kg/s} = 13.0 \\times 10^{7} \\, \\mathrm{kg/s} = 1.3 \\times 10^{8} \\, \\mathrm{kg/s}\n$$\n现在，代入 $Q_{net}$ 和 $M_{total}$ 的值来求 $\\alpha$：\n$$\n\\alpha = \\frac{2.0 \\times 10^{7} \\, \\mathrm{kg/s}}{1.3 \\times 10^{8} \\, \\mathrm{kg/s}} = \\frac{2.0}{13.0} \\approx 0.15384615...\n$$\n按要求四舍五入到四位有效数字：\n$$\n\\alpha \\approx 0.1538\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -4.32 \\times 10^{11}  0.1538 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "区域模型依赖于全球模型在离散时间点上提供的侧边界条件。为了在每个积分步长中使用这些信息，区域模型必须对边界数据进行时间插值。本练习通过一个简化的平流问题，清晰地揭示了即使是简单的线性时间插值，也会如何引入显著的误差，特别是影响天气系统（如锋面）的位置和过境时间，从而帮助理解更新频率与预报精度之间的权衡。",
            "id": "4059159",
            "problem": "考虑一个一维有限区域模式，其在位置 $x=0$ 处有一个开放的西侧向边界，该模式由一个粗分辨率的外部模式驱动，外部模式在离散的更新时刻 $t_k = k \\,\\Delta T$（其中 $k$ 为整数）提供侧向边界条件 (LBC)。该区域模式在连续的更新之间对 LBC 进行线性时间插值。一个振幅为 $A$ 的被动标量的急剧锋面不连续性在边界处进入区域，并以恒定的相速 $v0$ 向东传播，其传播由线性平流方程 $\\partial_t \\phi + v \\,\\partial_x \\phi = 0$ 控制。假设内部的数值扩散和反射可以忽略不计，因此内部解完全由边界信号沿特征线的平流决定。\n\n设 $x=0$ 处的真实边界信号是一个关于时间的阶跃函数：$\\phi(0,t)=A\\,H(t-t_0)$，其中 $H$ 是亥维赛德函数，$t_0 \\in (t_k, t_{k+1})$ 是未知的锋面在边界的真实到达时间。该区域模式基于粗分辨率的更新，在 $t_k$ 和 $t_{k+1}$ 之间对 $\\phi(0,t)$ 进行线性时间插值，从而将该时间间隔内的 $\\phi(0,t)$ 表示为一个从 $0$ 到 $A$ 的线性斜坡。\n\n将在任意时刻 $t$ 的瞬时锋面位置定义为满足 $\\phi(x_f(t),t)=A/2$ 的唯一位置 $x_f(t)$。设预报时效为 $T=24\\,\\mathrm{h}$。对于给定的 LBC 更新间隔 $\\Delta T$，边界处阶跃函数的线性时间插值会在 $x=0$ 处引入一个 $A/2$ 穿越点的时间误差，该误差随后通过平流传播到区域内部。\n\n仅使用平流方程、特征线法以及通过 $A/2$ 等值线定义的锋面位置，推导在时刻 $T$ 的最坏情况（针对 $t_0 \\in (t_k,t_{k+1})$）绝对锋面位置误差，该误差是 $v$ 和 $\\Delta T$ 的函数，并说明其如何依赖于 $T$。然后，将问题具体到两个 LBC 更新间隔 $\\Delta T_1=3\\,\\mathrm{h}$ 和 $\\Delta T_2=1\\,\\mathrm{h}$，并确定当使用 $\\Delta T_1$ 代替 $\\Delta T_2$ 时，在时刻 $T=24\\,\\mathrm{h}$ 的最坏情况锋面位置误差的增加量。\n\n将您的最终答案表示为以 $v$ 为变量的单一闭式解析表达式，单位为千米，并假设 $v$ 的单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。不要对您的答案进行四舍五入。",
            "solution": "被动标量 $\\phi$ 的控制方程是一维线性平流方程：\n$$\n\\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0\n$$\n其中 $v  0$ 是恒定相速。\n\n我们使用特征线法求解此偏微分方程。特征曲线由 $\\frac{dx}{dt} = v$ 定义。对此积分可得特征线 $x - vt = C$，其中 $C$ 是一个常数。沿着这些线，$\\phi$ 是恒定的。这意味着在任意点 $(x, t)$ 的解由 $\\phi$ 在西边界（$x=0$）更早时刻 $t' = t - x/v$ 的值决定。因此，通解为：\n$$\n\\phi(x,t) = \\phi(0, t - x/v)\n$$\n该关系表明，在指定的理想条件下（无数值扩散或反射），任何在边界 $x=0$ 处引入的信号都以速度 $v$ 传播到区域内部，而其形状不变。\n\n真实的物理过程涉及一个急剧的锋面在时刻 $t_0$ 到达边界。这由边界条件表示：\n$$\n\\phi_{\\text{true}}(0,t) = A H(t-t_0)\n$$\n其中 $H$ 是亥维赛德阶跃函数，且 $t_0 \\in (t_k, t_{k+1})$。通过将此边界条件代入通解，可得到区域内的真实解：\n$$\n\\phi_{\\text{true}}(x,t) = A H(t - x/v - t_0)\n$$\n瞬时锋面位置 $x_{f,\\text{true}}(t)$ 被定义为 $\\phi = A/2$ 的位置。对于一个急剧的阶跃函数，这对应于不连续点本身的位置。我们通过将亥维赛德函数的自变量设为零来找到这个位置：\n$$\nt - \\frac{x_{f,\\text{true}}(t)}{v} - t_0 = 0\n$$\n求解真实的锋面位置可得：\n$$\nx_{f,\\text{true}}(t) = v(t - t_0)\n$$\n此方程表明，真实的锋面从其在边界的初始到达时刻 $t_0$ 开始，随时间线性传播。\n\n区域模式无法获取连续函数 $\\phi_{\\text{true}}(0,t)$。相反，它在离散时刻 $t_k = k \\Delta T$ 采样边界状态。由于真实锋面在 $t_0 \\in (t_k, t_{k+1})$ 到达，粗分辨率模式提供的值为 $\\phi(0, t_k) = 0$ 和 $\\phi(0, t_{k+1}) = A$。区域模式随后在这两点之间应用线性时间插值。对于 $t \\in [t_k, t_{k+1}]$，模拟的边界条件 $\\phi_{\\text{model}}(0,t)$ 由连接点 $(t_k, 0)$ 和 $(t_{k+1}, A)$ 的直线给出：\n$$\n\\phi_{\\text{model}}(0,t) = 0 + \\frac{A - 0}{t_{k+1} - t_k} (t - t_k) = \\frac{A}{\\Delta T}(t - t_k)\n$$\n通过平流这个边界信号，得到内部的模拟解：\n$$\n\\phi_{\\text{model}}(x,t) = \\phi_{\\text{model}}(0, t - x/v) = \\frac{A}{\\Delta T}\\left(t - \\frac{x}{v} - t_k\\right)\n$$\n这在边界函数的自变量 $t - x/v$ 落在插值区间 $[t_k, t_{k+1}]$ 内的时间和位置上是有效的。\n\n模拟的锋面位置 $x_{f,\\text{model}}(t)$ 是 $\\phi_{\\text{model}} = A/2$ 的地方：\n$$\n\\frac{A}{2} = \\frac{A}{\\Delta T}\\left(t - \\frac{x_{f,\\text{model}}(t)}{v} - t_k\\right)\n$$\n求解 $x_{f,\\text{model}}(t)$：\n$$\n\\frac{\\Delta T}{2} = t - \\frac{x_{f,\\text{model}}(t)}{v} - t_k\n$$\n$$\n\\frac{x_{f,\\text{model}}(t)}{v} = t - t_k - \\frac{\\Delta T}{2}\n$$\n$$\nx_{f,\\text{model}}(t) = v\\left(t - t_k - \\frac{\\Delta T}{2}\\right)\n$$\n这表明，模型实际上将锋面视为在时刻 $t_k + \\Delta T / 2$（即 LBC 更新间隔的中点）到达边界。\n\n在时刻 $t$ 的锋面位置误差是模拟锋面位置与真实锋面位置之差：\n$$\n\\epsilon(t) = x_{f,\\text{model}}(t) - x_{f,\\text{true}}(t)\n$$\n$$\n\\epsilon(t) = v\\left(t - t_k - \\frac{\\Delta T}{2}\\right) - v(t - t_0) = v\\left(t_0 - t_k - \\frac{\\Delta T}{2}\\right)\n$$\n误差 $\\epsilon$ 与预报时间 $t$ 无关，仅取决于相速 $v$、LBC 更新间隔 $\\Delta T$ 以及真实到达时间 $t_0$ 相对于区间起始点 $t_k$ 的位置。\n\n题目要求我们找到最坏情况（最大绝对值）的锋面位置误差。这对应于对未知的真实到达时间 $t_0 \\in (t_k, t_{k+1})$ 最大化 $|\\epsilon|$。\n$$\n|\\epsilon|_{\\text{max}} = \\max_{t_0 \\in (t_k, t_{k+1})} \\left|v\\left(t_0 - t_k - \\frac{\\Delta T}{2}\\right)\\right| = v \\cdot \\max_{t_0 \\in (t_k, t_k+\\Delta T)} \\left|t_0 - \\left(t_k + \\frac{\\Delta T}{2}\\right)\\right|\n$$\n项 $|t_0 - (t_k + \\Delta T/2)|$ 表示真实到达时间与区间中点的偏差。当 $t_0$ 接近区间的端点 $t_k$ 或 $t_{k+1} = t_k + \\Delta T$ 时，该偏差最大。\n当 $t_0 \\to t_k$ 时，该项趋近于 $|t_k - (t_k + \\Delta T/2)| = |-\\Delta T/2| = \\Delta T/2$。\n当 $t_0 \\to t_{k+1}$ 时，该项趋近于 $|t_{k+1} - (t_k + \\Delta T/2)| = |(t_k+\\Delta T) - (t_k + \\Delta T/2)| = |\\Delta T/2| = \\Delta T/2$。\n因此，最坏情况的绝对位置误差为：\n$$\n|\\epsilon|_{\\text{max}} = v \\frac{\\Delta T}{2}\n$$\n该误差与预报时效 $T$ 无关。\n\n现在，我们具体分析给定的两个 LBC 更新间隔，$\\Delta T_1 = 3\\,\\mathrm{h}$ 和 $\\Delta T_2 = 1\\,\\mathrm{h}$。\n对于 $\\Delta T_1$，最坏情况误差为 $E_1 = v \\frac{\\Delta T_1}{2}$。\n对于 $\\Delta T_2$，最坏情况误差为 $E_2 = v \\frac{\\Delta T_2}{2}$。\n\n问题要求计算当使用 $\\Delta T_1$ 代替 $\\Delta T_2$ 时，最坏情况锋面位置误差的增加量。这即是差值 $E_1 - E_2$：\n$$\n\\text{误差增加量} = E_1 - E_2 = v \\frac{\\Delta T_1}{2} - v \\frac{\\Delta T_2}{2} = \\frac{v}{2}(\\Delta T_1 - \\Delta T_2)\n$$\n给定 $\\Delta T_1 = 3\\,\\mathrm{h}$ 和 $\\Delta T_2 = 1\\,\\mathrm{h}$。因此，$\\Delta T_1 - \\Delta T_2 = 2\\,\\mathrm{h}$。\n$$\n\\text{误差增加量} = \\frac{v}{2}(2\\,\\mathrm{h}) = v \\cdot (1\\,\\mathrm{h})\n$$\n为了以千米为单位表示答案，且 $v$ 的单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，我们必须进行单位转换。\n$$\n1\\,\\mathrm{h} = 60\\,\\mathrm{min/h} \\times 60\\,\\mathrm{s/min} = 3600\\,\\mathrm{s}\n$$\n误差的增加量，以米为单位，是：\n$$\n\\text{误差增加量 [m]} = v \\,[\\mathrm{m}\\,\\mathrm{s}^{-1}] \\times 3600 \\,[\\mathrm{s}] = 3600 v \\,[\\mathrm{m}]\n$$\n为了从米转换为千米，我们除以 1000：\n$$\n\\text{误差增加量 [km]} = \\frac{3600 v}{1000} = 3.6 v \\,[\\mathrm{km}]\n$$\n这就是最坏情况锋面位置误差增加量的最终解析表达式。",
            "answer": "$$\n\\boxed{3.6 v}\n$$"
        },
        {
            "introduction": "理想的侧边界条件应允许模型内部产生的波动和扰动无反射地传出计算区域，这种边界被称为“开放”或“辐射”边界。本练习将引导你从第一性原理出发，推导一种著名且应用广泛的辐射边界条件——Orlanski 格式。通过这个过程，你将掌握如何利用模型自身的解来实时估计局部波速，并构建一个能够自适应调整的开放边界条件，这是数值模拟中一项十分强大的技术。",
            "id": "4059114",
            "problem": "考虑一个一维有限区域模型，其向外法向坐标为 $n \\geq 0$，侧边界位于 $n=0$。一个无源标量场 $\\phi(n,t)$ 局部上由以下一维平流方程控制\n$$\n\\partial_{t}\\phi + u(n,t)\\,\\partial_{n}\\phi = 0,\n$$\n其中 $u(n,t)$ 是可随空间和时间变化的真实平流速度。在侧边界处，目标是施加一个无反射闭合条件，允许具有局地估计相速的扰动辐射出计算区域。Orlanski 辐射边界条件是一种数据驱动的闭合条件，它强制执行如下的边界法向传播关系\n$$\n\\partial_{t}\\phi + c_{b}(t)\\,\\partial_{n}\\phi = 0 \\quad \\text{at} \\quad n=0,\n$$\n其中 $c_{b}(t)$ 是一个单一的边界法向相速，需要在每个时间点根据 $\\phi$ 的局部行为进行估计。\n\n从线性平流的特征传播基本原理以及局地平面扰动的相速定义出发，通过将在边界处求值的 $\\partial_{t}\\phi$ 和 $\\partial_{n}\\phi$ 来表示边界法向相速的估计值 $c_{b}(t)$，从而推导出 Orlanski 辐射边界条件。然后，对于一个一阶有限差分实现，考虑以下离散配置：\n\n- 空间格点 $i=0$ 位于边界（$n=0$），$i=1$ 是第一个内部点（$n=\\Delta x$），网格间距均匀为 $\\Delta x0$。\n- 时间层为 $t^{m}=m\\,\\Delta t$（$m$ 为整数），时间步长均匀为 $\\Delta t0$。\n- 在时间 $t^{n}$ 和 $t^{n-1}$ 的已知边界值和内部值 $\\phi_{0}^{n}$、$\\phi_{0}^{n-1}$、$\\phi_{1}^{n}$，以及在 $t^{n+1}$ 的新推进的内部值 $\\phi_{1}^{n+1}$。\n- 用于边界法向导数的单侧一阶空间差分，\n$$\n\\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{m}} \\approx \\frac{\\phi_{1}^{m}-\\phi_{0}^{m}}{\\Delta x},\n$$\n以及用于边界处时间导数的一阶向后差分，\n$$\n\\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\Delta t}.\n$$\n\n假设用于从 $t^{n}$ 推进到 $t^{n+1}$ 的边界法向相速是在 $t^{n}$ 计算的局地估计值，并在 $t^{n+1}$ 时刻使用该时间层上相同的一阶空间差分来施加 Orlanski 辐射边界条件。在这些假设下，用给定的离散量 $\\phi_{0}^{n}$、$\\phi_{0}^{n-1}$、$\\phi_{1}^{n}$、$\\phi_{1}^{n+1}$、$\\Delta x$ 和 $\\Delta t$ 来推导更新后的边界值 $\\phi_{0}^{n+1}$ 的闭式解析表达式。\n\n你的最终答案必须是 $\\phi_{0}^{n+1}$ 的单个闭式符号表达式。无需四舍五入。最终答案不带单位，且最终答案中不要包含任何不等式或方程。在你的解题过程中，明确定义你所引入的任何中间符号。",
            "solution": "该问题要求针对一维平流方程的 Orlanski 辐射边界条件进行两部分的推导。首先，我们从基本原理出发，推导估计相速的表达式。其次，我们使用一个特定的有限差分格式，为标量场的更新后边界值推导一个闭式表达式。\n\n无源标量场 $\\phi(n,t)$ 的控制方程是一维平流方程：\n$$\n\\partial_{t}\\phi + u(n,t)\\,\\partial_{n}\\phi = 0\n$$\nOrlanski 辐射边界条件旨在允许类波扰动传播出区域。它通过假设场在边界 $n=0$ 处局部满足一个简单的波动方程来模拟其行为：\n$$\n\\partial_{t}\\phi + c_{b}(t)\\,\\partial_{n}\\phi = 0 \\quad \\text{at} \\quad n=0\n$$\n其中 $c_{b}(t)$ 是边界处扰动的相速。这种形式的动机是考虑形式为 $\\phi \\approx f(n-ct)$ 的局地平面波，对于这种波，$\\partial_t \\phi = -c f'$ 且 $\\partial_n \\phi = f'$。这些导数的比值给出了相速 $c = -\\frac{\\partial_t \\phi}{\\partial_n \\phi}$。\n\n遵循这一原则，Orlanski 条件通过在边界本身计算这个比值来确定相速 $c_b(t)$。通过重新整理边界条件方程，我们得到边界法向相速估计值的表达式：\n$$\nc_{b}(t) = - \\frac{\\left.\\partial_{t}\\phi\\right|_{n=0}}{\\left.\\partial_{n}\\phi\\right|_{n=0}}\n$$\n这就完成了所要求的第一部分推导。\n\n对于第二部分，我们使用一个离散实现来寻找新边界值 $\\phi_{0}^{n+1}$ 的表达式。过程如下：\n\n1.  **在时间 $t^n$ 估计相速**：问题指出，用于更新的相速是在时间 $t=t^n$ 计算的。我们将此估计速度表示为 $c_{b}^{n}$。我们使用所提供的在 $t^n$ 处的导数的有限差分近似：\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\Delta t}\n    $$\n    $$\n    \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{1}^{n}-\\phi_{0}^{n}}{\\Delta x}\n    $$\n    将这些代入相速的表达式中，我们得到离散的估计值：\n    $$\n    c_{b}^{n} = - \\frac{(\\phi_{0}^{n}-\\phi_{0}^{n-1})/\\Delta t}{(\\phi_{1}^{n}-\\phi_{0}^{n})/\\Delta x} = - \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\n    $$\n\n2.  **在时间 $t^{n+1}$ 施加边界条件**：我们在新的时间层 $t^{n+1}$ 应用 Orlanski 条件，使用在上一时间层计算的相速 $c_{b}^{n}$：\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n+1}} + c_{b}^{n} \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n+1}} = 0\n    $$\n    我们在 $t=t^{n+1}$ 处离散化导数。对于空间导数，我们使用指定的一阶单侧差分。对于时间导数，我们使用一阶向后差分，这与为 $t^n$ 给出的格式一致，并允许隐式地求解 $\\phi_0^{n+1}$。\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n+1}} \\approx \\frac{\\phi_{0}^{n+1}-\\phi_{0}^{n}}{\\Delta t}\n    $$\n    $$\n    \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n+1}} \\approx \\frac{\\phi_{1}^{n+1}-\\phi_{0}^{n+1}}{\\Delta x}\n    $$\n    将这些代入边界条件方程，得到：\n    $$\n    \\frac{\\phi_{0}^{n+1}-\\phi_{0}^{n}}{\\Delta t} + c_{b}^{n} \\left( \\frac{\\phi_{1}^{n+1}-\\phi_{0}^{n+1}}{\\Delta x} \\right) = 0\n    $$\n\n3.  **求解 $\\phi_{0}^{n+1}$**：我们现在通过代数方法解这个关于 $\\phi_{0}^{n+1}$ 的方程。首先，我们重新排列各项，将包含 $\\phi_{0}^{n+1}$ 的项组合在一起：\n    $$\n    \\phi_{0}^{n+1} \\left( \\frac{1}{\\Delta t} - \\frac{c_{b}^{n}}{\\Delta x} \\right) = \\frac{\\phi_{0}^{n}}{\\Delta t} - \\frac{c_{b}^{n}\\phi_{1}^{n+1}}{\\Delta x}\n    $$\n    为了消去分母，我们将整个方程乘以 $\\Delta t \\Delta x$：\n    $$\n    \\phi_{0}^{n+1} (\\Delta x - c_{b}^{n} \\Delta t) = \\Delta x \\phi_{0}^{n} - c_{b}^{n} \\Delta t \\phi_{1}^{n+1}\n    $$\n    分离出 $\\phi_{0}^{n+1}$ 可得：\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} - c_{b}^{n} \\Delta t \\phi_{1}^{n+1}}{\\Delta x - c_{b}^{n} \\Delta t}\n    $$\n\n4.  **代入 $c_{b}^{n}$ 的表达式**：最后，我们将先前推导出的 $c_{b}^{n}$ 的离散表达式代入此方程。\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} - \\left(- \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\Delta t \\phi_{1}^{n+1}}{\\Delta x - \\left(- \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\Delta t}\n    $$\n    分子和分母中的 $\\Delta t$ 项相互抵消：\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} + \\Delta x \\left(\\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\phi_{1}^{n+1}}{\\Delta x + \\Delta x \\left(\\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right)}\n    $$\n    我们可以从分子和分母中提出公因子 $\\Delta x$，然后将其消去：\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n} + \\frac{(\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}}{1 + \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}}\n    $$\n    为了简化这个繁分数，我们将分子和分母同乘以 $(\\phi_{1}^{n}-\\phi_{0}^{n})$：\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})}\n    $$\n    化简分母，得到更新后边界值的最终闭式表达式：\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n-1}}\n    $$\n    这个表达式用已知值 $\\phi_{0}^{n}$、$\\phi_{0}^{n-1}$、$\\phi_{1}^{n}$ 和 $\\phi_{1}^{n+1}$ 表示了在时间 $t^{n+1}$ 时边界上 $\\phi$ 的值。",
            "answer": "$$\n\\boxed{\\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n-1}}}\n$$"
        }
    ]
}