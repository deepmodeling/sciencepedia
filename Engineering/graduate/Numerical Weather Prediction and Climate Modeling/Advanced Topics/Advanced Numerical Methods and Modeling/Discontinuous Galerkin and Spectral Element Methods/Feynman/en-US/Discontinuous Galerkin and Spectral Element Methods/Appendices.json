{
    "hands_on_practices": [
        {
            "introduction": "A key strength of Discontinuous Galerkin and Spectral Element methods is their ability to handle complex geometries using unstructured meshes. To facilitate calculations such as numerical integration, each arbitrarily shaped physical element is mapped to a simple, uniform reference element. This exercise provides foundational practice in deriving the Jacobian of this transformation, a crucial geometric factor that relates derivatives and area elements between the physical and reference coordinate systems and is essential for implementing the method correctly .",
            "id": "4031870",
            "problem": "In a high-order Discontinuous Galerkin (DG) and Spectral Element Method (SEM) discretization for numerical weather prediction and climate modeling, transforming physical-element integrals to a canonical reference element is required to apply Gaussian quadrature and to maintain conservation properties. Consider a single planar quadrilateral element that models a local patch of the horizontal domain (e.g., a regional patch on a tangent plane to the sphere). The reference element is the square with coordinates $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$, and the physical element vertices (in kilometers) are given in counterclockwise order as follows:\n- Reference node $(-1,-1)$ maps to physical node $(x_1,y_1) = (0,0)$,\n- Reference node $(1,-1)$ maps to physical node $(x_2,y_2) = (100,0)$,\n- Reference node $(1,1)$ maps to physical node $(x_3,y_3) = (110,90)$,\n- Reference node $(-1,1)$ maps to physical node $(x_4,y_4) = (-10,80)$.\n\nStarting from the fundamental definition of isoparametric mapping for quadrilateral elements and the bilinear shape functions on the reference square, derive the expressions for the physical coordinates $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$, and then compute the Jacobian matrix $J(\\xi,\\eta)$ of the mapping, where $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$. Using these, obtain the Jacobian determinant $\\det(J(\\xi,\\eta))$ that scales area when transforming integrals from the physical element to the reference element. Express your final result as a single closed-form analytic expression in terms of $\\xi$ and $\\eta$, and express the coefficients so that the determinant has units of square kilometers. No numerical rounding is required; provide exact rational coefficients where appropriate. Your final boxed answer should be the analytic expression for $\\det(J(\\xi,\\eta))$ in square kilometers.",
            "solution": "The problem requires the derivation of the Jacobian determinant for an isoparametric mapping from a canonical reference element to a physical quadrilateral element. The reference element is the square defined by $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$. The transformation is built upon the standard bilinear shape functions for a quadrilateral element.\n\nThe four bilinear shape functions, $N_i(\\xi, \\eta)$ for $i \\in \\{1, 2, 3, 4\\}$, on the reference square are defined based on the corner nodes, which are, in counterclockwise order: node $1$ at $(-1, -1)$, node $2$ at $(1, -1)$, node $3$ at $(1, 1)$, and node $4$ at $(-1, 1)$. The functions are:\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\nThe physical coordinates $(x, y)$ are determined by an isoparametric interpolation using these shape functions and the coordinates of the physical element's vertices $(x_i, y_i)$:\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} x_i N_i(\\xi, \\eta)$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} y_i N_i(\\xi, \\eta)$$\n\nThe problem provides the physical vertex coordinates in kilometers:\n- $(x_1, y_1) = (0, 0)$\n- $(x_2, y_2) = (100, 0)$\n- $(x_3, y_3) = (110, 90)$\n- $(x_4, y_4) = (-10, 80)$\n\nWe substitute these vertex coordinates into the mapping equations:\n$$x(\\xi, \\eta) = (0)N_1(\\xi, \\eta) + (100)N_2(\\xi, \\eta) + (110)N_3(\\xi, \\eta) + (-10)N_4(\\xi, \\eta)$$\n$$y(\\xi, \\eta) = (0)N_1(\\xi, \\eta) + (0)N_2(\\xi, \\eta) + (90)N_3(\\xi, \\eta) + (80)N_4(\\xi, \\eta)$$\n\nExpanding these expressions:\n$$x(\\xi, \\eta) = \\frac{1}{4} [100(1+\\xi)(1-\\eta) + 110(1+\\xi)(1+\\eta) - 10(1-\\xi)(1+\\eta)]$$\n$$y(\\xi, \\eta) = \\frac{1}{4} [90(1+\\xi)(1+\\eta) + 80(1-\\xi)(1+\\eta)]$$\n\nTo simplify, we collect terms based on the basis $\\{1, \\xi, \\eta, \\xi\\eta\\}$:\nFor $x(\\xi, \\eta)$:\n$$4x = 100(1 - \\eta + \\xi - \\xi\\eta) + 110(1 + \\eta + \\xi + \\xi\\eta) - 10(1 + \\eta - \\xi - \\xi\\eta)$$\n$$4x = (100+110-10) \\cdot 1 + (100+110-(-10))\\xi + (-100+110-10)\\eta + (-100+110-(-10))\\xi\\eta$$\n$$4x = 200 + 220\\xi + 0\\eta + 20\\xi\\eta$$\n$$x(\\xi, \\eta) = 50 + 55\\xi + 5\\xi\\eta$$\n\nFor $y(\\xi, \\eta)$:\n$$4y = 90(1 + \\eta + \\xi + \\xi\\eta) + 80(1 + \\eta - \\xi - \\xi\\eta)$$\n$$4y = (90+80) \\cdot 1 + (90-80)\\xi + (90+80)\\eta + (90-80)\\xi\\eta$$\n$$4y = 170 + 10\\xi + 170\\eta + 10\\xi\\eta$$\n$$y(\\xi, \\eta) = \\frac{170}{4} + \\frac{10}{4}\\xi + \\frac{170}{4}\\eta + \\frac{10}{4}\\xi\\eta = \\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta$$\n\nThe Jacobian matrix $J(\\xi, \\eta)$ of the mapping is the matrix of first partial derivatives:\n$$J(\\xi, \\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\nWe compute the four partial derivatives from the expressions for $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$:\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(50 + 55\\xi + 5\\xi\\eta) = 55 + 5\\eta$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(50 + 55\\xi + 5\\xi\\eta) = 5\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta\\right) = \\frac{5}{2} + \\frac{5}{2}\\eta$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta\\right) = \\frac{85}{2} + \\frac{5}{2}\\xi$$\n\nThe Jacobian matrix is:\n$$J(\\xi, \\eta) = \\begin{pmatrix} 55 + 5\\eta  5\\xi \\\\ \\frac{5}{2} + \\frac{5}{2}\\eta  \\frac{85}{2} + \\frac{5}{2}\\xi \\end{pmatrix}$$\n\nThe Jacobian determinant, $\\det(J(\\xi, \\eta))$, is calculated as:\n$$\\det(J(\\xi, \\eta)) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)$$\n$$\\det(J(\\xi, \\eta)) = (55 + 5\\eta)\\left(\\frac{85}{2} + \\frac{5}{2}\\xi\\right) - (5\\xi)\\left(\\frac{5}{2} + \\frac{5}{2}\\eta\\right)$$\n\nExpanding the products:\n$$\\det(J) = \\left(55 \\cdot \\frac{85}{2} + 55 \\cdot \\frac{5}{2}\\xi + 5\\eta \\cdot \\frac{85}{2} + 5\\eta \\cdot \\frac{5}{2}\\xi\\right) - \\left(5\\xi \\cdot \\frac{5}{2} + 5\\xi \\cdot \\frac{5}{2}\\eta\\right)$$\n$$\\det(J) = \\left(\\frac{4675}{2} + \\frac{275}{2}\\xi + \\frac{425}{2}\\eta + \\frac{25}{2}\\xi\\eta\\right) - \\left(\\frac{25}{2}\\xi + \\frac{25}{2}\\xi\\eta\\right)$$\n\nCombining like terms simplifies the expression:\n$$\\det(J) = \\frac{4675}{2} + \\left(\\frac{275}{2} - \\frac{25}{2}\\right)\\xi + \\frac{425}{2}\\eta + \\left(\\frac{25}{2} - \\frac{25}{2}\\right)\\xi\\eta$$\n$$\\det(J) = \\frac{4675}{2} + \\frac{250}{2}\\xi + \\frac{425}{2}\\eta$$\n$$\\det(J(\\xi, \\eta)) = \\frac{4675}{2} + 125\\xi + \\frac{425}{2}\\eta$$\n\nThe physical coordinates were given in units of kilometers, and the reference coordinates $(\\xi, \\eta)$ are dimensionless. Therefore, the partial derivatives have units of kilometers, and the Jacobian determinant has units of square kilometers. The result is the required closed-form analytic expression with exact rational coefficients.",
            "answer": "$$\\boxed{\\frac{4675}{2} + 125\\xi + \\frac{425}{2}\\eta}$$"
        },
        {
            "introduction": "When solving nonlinear equations like those governing atmospheric dynamics, spectral methods face a unique challenge: the product of polynomials can generate higher-order terms that fall outside the chosen approximation space. This practice explores the concept of aliasing error by comparing a direct nodal evaluation of a nonlinear term with a more rigorous modal projection. By calculating the exact difference , you will gain a concrete understanding of how unresolved modes can contaminate the solution and why dealiasing techniques are critical for the long-term stability of weather and climate models.",
            "id": "4031843",
            "problem": "Consider a one-dimensional reference spectral element on the interval $[-1,1]$ used in the dynamical core of a numerical weather prediction model employing the Spectral Element Method (SEM). Let the polynomial approximation space be degree $N=2$, and let the basis be the Legendre polynomials $\\{P_0(x), P_1(x), P_2(x)\\}$, where $P_0(x)=1$, $P_1(x)=x$, and $P_2(x)=\\frac{1}{2}(3x^2-1)$. The nodal basis is formed at the Gauss–Lobatto–Legendre (GLL) nodes, which for $N=2$ are $x=-1,0,1$. In a typical Discontinuous Galerkin (DG) or SEM discretization of the Euler equations for atmospheric flow, nonlinear products such as $u^3$ appear and must be approximated within the degree-$N$ polynomial space.\n\nTake the prognostic field $u(x)$ within this element to be $u(x)=P_2(x)$. Consider two standard ways of forming the degree-$N$ approximation of the nonlinear term $u^3$:\n- Nodal interpolation: compute $u^3$ pointwise at the GLL nodes and interpolate it with the degree-$2$ nodal Lagrange basis to obtain a polynomial $f^I(x) \\in \\mathrm{span}\\{P_0,P_1,P_2\\}$.\n- Modal projection: form the $\\mathrm{L}^2$ projection of $u^3$ onto $\\mathrm{span}\\{P_0,P_1,P_2\\}$ using the Legendre basis and its orthogonality with respect to the standard inner product on $[-1,1]$, thereby obtaining $f^P(x) \\in \\mathrm{span}\\{P_0,P_1,P_2\\}$.\n\nStarting only from the definitions of Legendre polynomials, their orthogonality on $[-1,1]$, and the definition of $\\mathrm{L}^2$ projection, derive the exact expressions for $f^I(x)$ and $f^P(x)$ and compute the difference\n$$\nE(x)=f^I(x)-f^P(x).\n$$\nExpress your final answer as a single closed-form analytic expression in terms of $P_0(x)$ and $P_2(x)$. Briefly explain why the nonzero $E(x)$ represents aliasing error in the nonlinear evaluation and how this motivates dealiasing strategies in spectral element and discontinuous Galerkin models for climate and weather applications. No numerical rounding is required, and no physical units are involved. Provide $E(x)$ as your final answer.",
            "solution": "The problem requires the derivation of two different approximations for the nonlinear term $u(x)^3$ in a spectral element context and the calculation of their difference. The field $u(x)$ is given as the second-order Legendre polynomial, $u(x) = P_2(x)$, within a reference element $[-1, 1]$ discretized with a polynomial space of degree $N=2$. The two approximation methods are nodal interpolation at the Gauss-Lobatto-Legendre (GLL) nodes and modal $\\mathrm{L}^2$ projection onto the polynomial space spanned by $\\{P_0(x), P_1(x), P_2(x)\\}$.\n\nThe Legendre polynomials of degree up to $2$ are:\n$$P_0(x) = 1$$\n$$P_1(x) = x$$\n$$P_2(x) = \\frac{1}{2}(3x^2-1)$$\n\nThe problem states that for $N=2$, the GLL nodes are $x = -1, 0, 1$.\n\nLet's first calculate the nodal interpolation of $u(x)^3$, denoted $f^I(x)$. We begin by evaluating $u(x)$ and $u(x)^3$ at the GLL nodes.\nThe values of $u(x) = P_2(x)$ at the nodes are:\n$$u(-1) = P_2(-1) = \\frac{1}{2}(3(-1)^2-1) = 1$$\n$$u(0) = P_2(0) = \\frac{1}{2}(3(0)^2-1) = -\\frac{1}{2}$$\n$$u(1) = P_2(1) = \\frac{1}{2}(3(1)^2-1) = 1$$\n\nNow, we compute the values of the nonlinear term $u(x)^3$ at these nodes:\n$$u(-1)^3 = 1^3 = 1$$\n$$u(0)^3 = \\left(-\\frac{1}{2}\\right)^3 = -\\frac{1}{8}$$\n$$u(1)^3 = 1^3 = 1$$\n\nThe nodal interpolation $f^I(x)$ is the unique polynomial of degree $N=2$ that passes through the points $(-1, 1)$, $(0, -1/8)$, and $(1, 1)$. Let $f^I(x) = ax^2 + bx + c$.\nUsing the point $(0, -1/8)$, we find $c = -1/8$.\nUsing the points $(1, 1)$ and $(-1, 1)$:\n$$a(1)^2 + b(1) + c = 1 \\implies a+b-\\frac{1}{8} = 1 \\implies a+b = \\frac{9}{8}$$\n$$a(-1)^2 + b(-1) + c = 1 \\implies a-b-\\frac{1}{8} = 1 \\implies a-b = \\frac{9}{8}$$\nAdding these two equations gives $2a = \\frac{18}{8}$, so $a = \\frac{9}{8}$. Subtracting them gives $2b=0$, so $b=0$.\nThus, the interpolating polynomial is $f^I(x) = \\frac{9}{8}x^2 - \\frac{1}{8}$.\n\nTo express $f^I(x)$ in the Legendre basis, we invert the definition of $P_2(x)$:\n$P_2(x) = \\frac{3}{2}x^2 - \\frac{1}{2} \\implies x^2 = \\frac{2}{3}P_2(x) + \\frac{1}{3}$. Since $P_0(x)=1$, we have $x^2 = \\frac{2}{3}P_2(x) + \\frac{1}{3}P_0(x)$.\nSubstituting this into the expression for $f^I(x)$:\n$$f^I(x) = \\frac{9}{8}\\left(\\frac{2}{3}P_2(x) + \\frac{1}{3}P_0(x)\\right) - \\frac{1}{8}P_0(x)$$\n$$f^I(x) = \\frac{3}{4}P_2(x) + \\frac{3}{8}P_0(x) - \\frac{1}{8}P_0(x)$$\n$$f^I(x) = \\frac{3}{4}P_2(x) + \\frac{1}{4}P_0(x)$$\n\nNext, we calculate the modal projection of $u(x)^3$, denoted $f^P(x)$. This is the $\\mathrm{L}^2$ projection of $u(x)^3 = P_2(x)^3$ onto the space $\\mathrm{span}\\{P_0, P_1, P_2\\}$.\n$$f^P(x) = c_0 P_0(x) + c_1 P_1(x) + c_2 P_2(x)$$\nThe coefficients $c_k$ are given by the projection formula, which relies on the orthogonality of Legendre polynomials:\n$$c_k = \\frac{\\langle P_2^3, P_k \\rangle}{\\langle P_k, P_k \\rangle} = \\frac{\\int_{-1}^{1} P_2(x)^3 P_k(x) dx}{\\int_{-1}^{1} P_k(x)^2 dx}$$\nThe normalization factor is $\\langle P_k, P_k \\rangle = \\frac{2}{2k+1}$.\nThe function $P_2(x)^3$ is an even function of $x$, since $P_2(x)$ is even. The integral of an even function times an odd function ($P_1(x)=x$) over a symmetric interval is zero. Thus, $c_1=0$.\nTo find $c_0$ and $c_2$, we first express $P_2(x)^3$ as a sum of Legendre polynomials. We start by expanding $P_2(x)^2$:\n$$P_2(x)^2 = \\left(\\frac{1}{2}(3x^2-1)\\right)^2 = \\frac{1}{4}(9x^4-6x^2+1)$$\nWe use the known expansions $x^2 = \\frac{2}{3}P_2(x) + \\frac{1}{3}P_0(x)$ and $x^4 = \\frac{8}{35}P_4(x) + \\frac{4}{7}P_2(x) + \\frac{1}{5}P_0(x)$.\n$$P_2(x)^2 = \\frac{9}{4}\\left(\\frac{8}{35}P_4 + \\frac{4}{7}P_2 + \\frac{1}{5}P_0\\right) - \\frac{6}{4}\\left(\\frac{2}{3}P_2 + \\frac{1}{3}P_0\\right) + \\frac{1}{4}P_0$$\n$$P_2(x)^2 = \\frac{18}{35}P_4(x) + \\left(\\frac{9}{7}-1\\right)P_2(x) + \\left(\\frac{9}{20}-\\frac{1}{2}+\\frac{1}{4}\\right)P_0(x)$$\n$$P_2(x)^2 = \\frac{18}{35}P_4(x) + \\frac{2}{7}P_2(x) + \\frac{1}{5}P_0(x)$$\nNow we compute $P_2(x)^3 = P_2(x) \\cdot P_2(x)^2$:\n$$P_2(x)^3 = P_2(x) \\left( \\frac{18}{35}P_4(x) + \\frac{2}{7}P_2(x) + \\frac{1}{5}P_0(x) \\right)$$\n$$P_2(x)^3 = \\frac{18}{35} P_2(x)P_4(x) + \\frac{2}{7} P_2(x)^2 + \\frac{1}{5} P_2(x)$$\nThe $\\mathrm{L}^2$ projection onto $\\mathrm{span}\\{P_0, P_1, P_2\\}$ consists of taking only the terms with index $k \\le 2$. Let $\\mathcal{P}_2$ be the projection operator.\n$$f^P(x) = \\mathcal{P}_2(P_2(x)^3) = \\frac{18}{35} \\mathcal{P}_2(P_2 P_4) + \\frac{2}{7} \\mathcal{P}_2(P_2^2) + \\frac{1}{5} \\mathcal{P}_2(P_2)$$\nBy definition, $\\mathcal{P}_2(P_2) = P_2$, and from the expansion of $P_2^2$ above, $\\mathcal{P}_2(P_2^2) = \\frac{2}{7}P_2 + \\frac{1}{5}P_0$. The term $\\mathcal{P}_2(P_2 P_4)$ requires finding the $P_0$ and $P_2$ components of the product $P_2 P_4$. The product is a polynomial of degree $6$ and is even, so its expansion contains only $P_0, P_2, P_4, P_6$. The $P_0$ component is proportional to $\\int_{-1}^1 P_2 P_4 dx$, which is zero by orthogonality. The $P_2$ component is found via $\\frac{\\langle P_2 P_4, P_2 \\rangle}{\\langle P_2, P_2 \\rangle}P_2 = \\frac{\\int_{-1}^1 P_2^2 P_4 dx}{\\int_{-1}^1 P_2^2 dx}P_2$.\nUsing the expansion of $P_2^2$:\n$$\\int_{-1}^{1} P_2^2 P_4 dx = \\int_{-1}^{1} \\left( \\frac{18}{35}P_4 + \\frac{2}{7}P_2 + \\frac{1}{5}P_0 \\right) P_4 dx = \\frac{18}{35} \\int_{-1}^{1} P_4^2 dx = \\frac{18}{35} \\frac{2}{9} = \\frac{4}{35}$$\nThe coefficient for the $P_2$ component is $\\frac{4/35}{2/5} = \\frac{4}{35}\\frac{5}{2} = \\frac{2}{7}$. So $\\mathcal{P}_2(P_2 P_4) = \\frac{2}{7}P_2$.\nSubstituting back:\n$$f^P(x) = \\frac{18}{35}\\left(\\frac{2}{7}P_2\\right) + \\frac{2}{7}\\left(\\frac{2}{7}P_2 + \\frac{1}{5}P_0\\right) + \\frac{1}{5}P_2$$\n$$f^P(x) = \\left(\\frac{36}{245} + \\frac{4}{49} + \\frac{1}{5}\\right)P_2(x) + \\frac{2}{35}P_0(x)$$\n$$f^P(x) = \\left(\\frac{36}{245} + \\frac{20}{245} + \\frac{49}{245}\\right)P_2(x) + \\frac{2}{35}P_0(x) = \\frac{105}{245}P_2(x) + \\frac{2}{35}P_0(x)$$\n$$f^P(x) = \\frac{3}{7}P_2(x) + \\frac{2}{35}P_0(x)$$\n\nFinally, we compute the difference $E(x) = f^I(x) - f^P(x)$:\n$$E(x) = \\left(\\frac{3}{4}P_2(x) + \\frac{1}{4}P_0(x)\\right) - \\left(\\frac{3}{7}P_2(x) + \\frac{2}{35}P_0(x)\\right)$$\n$$E(x) = \\left(\\frac{3}{4} - \\frac{3}{7}\\right)P_2(x) + \\left(\\frac{1}{4} - \\frac{2}{35}\\right)P_0(x)$$\n$$E(x) = \\left(\\frac{21 - 12}{28}\\right)P_2(x) + \\left(\\frac{35 - 8}{140}\\right)P_0(x)$$\n$$E(x) = \\frac{9}{28}P_2(x) + \\frac{27}{140}P_0(x)$$\n\nThe nonzero difference $E(x)$ represents aliasing error. The exact nonlinear term $u^3(x)=P_2(x)^3$ is a polynomial of degree $6$ and thus contains components of higher-order Legendre polynomials ($P_4$ and $P_6$). The modal projection $f^P(x)$ is the mathematically optimal degree-2 approximation, as it correctly filters out these high-order modes. In contrast, the nodal interpolation $f^I(x)$ computes the nonlinear term on a grid that is too coarse to resolve all of its polynomial modes. The unresolved higher-order modes are spuriously represented as lower-order modes, a phenomenon known as aliasing. The coefficients of $f^I(x)$ are thus \"contaminated\" by this aliased energy. The difference $E(x)$ is precisely this contamination or aliasing error. In numerical simulations of nonlinear systems like the Euler equations, aliasing error can lead to a non-physical pile-up of energy at the highest resolved wavenumbers and cause numerical instability. This motivates the use of dealiasing techniques, such as oversampling (e.g., the 3/2-rule for quadratic nonlinearities), which evaluate nonlinear terms on a finer grid to exactly compute the product before projecting it back to the original polynomial space, effectively calculating $f^P(x)$ instead of $f^I(x)$.",
            "answer": "$$\\boxed{\\frac{9}{28}P_{2}(x) + \\frac{27}{140}P_{0}(x)}$$"
        },
        {
            "introduction": "High-order methods can produce non-physical oscillations near sharp gradients, a significant issue when modeling quantities with strict physical bounds like moisture content. This exercise demonstrates a practical solution: a moment-based limiter that enforces these bounds while preserving mass conservation. You will apply this technique to a polynomial that violates its physical constraints, calculating the precise scaling factor needed to restore physical realism without unnecessarily sacrificing the accuracy of the high-order representation .",
            "id": "4031860",
            "problem": "Consider one-dimensional advection of the water vapor mixing ratio, a bounded scalar field $q(x,t)$ satisfying the scalar conservation law $q_t + (c q)_x = 0$ with constant wind speed $c$, in a numerical weather prediction column model. On a single spectral element (cell) with reference coordinate $\\xi \\in [-1,1]$, a Discontinuous Galerkin (DG) representation uses a hierarchical Legendre modal basis $P_k(\\xi)$, with $P_0(\\xi) = 1$, $P_1(\\xi) = \\xi$, $P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)$, and $P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi)$. The degree-$p=3$ polynomial representation in the cell is\n$$\nq_h(\\xi) = a_0 P_0(\\xi) + a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi),\n$$\nwhere the cell-mean satisfies $\\frac{1}{2}\\int_{-1}^{1} q_h(\\xi)\\,d\\xi = a_0$.\n\nPhysical realism imposes the bound $0 \\le q \\le 1$ for the mixing ratio. In the presence of a shock-aligned gradient, the unbounded DG polynomial in a target cell at a given time step is\n$$\na_0 = \\frac{3}{5},\\quad a_1 = \\frac{7}{10},\\quad a_2 = \\frac{1}{5},\\quad a_3 = \\frac{2}{5}.\n$$\nTo enforce boundedness while preserving conservation, apply a moment-based limiter that preserves the cell mean $a_0$ and rescales all higher modal moments by a single factor $\\theta \\in [0,1]$:\n$$\n\\tilde{q}_h(\\xi) = a_0 P_0(\\xi) + \\theta\\big(a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi)\\big).\n$$\nAs the limiting set, use the Legendre–Gauss–Lobatto (GL) points for $p=3$: $\\xi \\in \\{-1,-1/\\sqrt{5},1/\\sqrt{5},1\\}$. The limiter must be chosen so that $0 \\le \\tilde{q}_h(\\xi) \\le 1$ at all these points, and must be the least restrictive scaling consistent with these bounds.\n\nStarting from the conservation law and the maximum principle requirement on $q$, derive the expression for the minimal admissible $\\theta$ satisfying the GL-point bounds and compute the modified modal coefficients $(\\tilde{a}_0,\\tilde{a}_1,\\tilde{a}_2,\\tilde{a}_3)$ for the degree-$3$ polynomial that enforces boundedness. Express the final modal coefficients as dimensionless numbers. If you choose to present decimal values, round to six significant figures.",
            "solution": "The problem requires the application of a moment-based limiter to a degree-3 polynomial representation of a scalar field, $\\tilde{q}_h(\\xi)$, to enforce the physical bounds $0 \\le q \\le 1$. The method must preserve the cell-mean modal coefficient $a_0$ while scaling the higher-order coefficients ($a_1, a_2, a_3$) by a single factor $\\theta \\in [0,1]$.\n\nThe limited polynomial is given by:\n$$\n\\tilde{q}_h(\\xi) = a_0 P_0(\\xi) + \\theta \\left( a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi) \\right)\n$$\nSince $P_0(\\xi)=1$, we can write this as $\\tilde{q}_h(\\xi) = a_0 + \\theta \\Delta q(\\xi)$, where $\\Delta q(\\xi) = a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi)$ represents the contribution from the higher-order modes.\n\nThe limiter must enforce the bounds $0 \\le \\tilde{q}_h(\\xi) \\le 1$ at the specified Legendre-Gauss-Lobatto (GL) points for $p=3$: $\\xi_j \\in \\{-1, -1/\\sqrt{5}, 1/\\sqrt{5}, 1\\}$. For each point $\\xi_j$, we have the two inequalities:\n$$\n0 \\le a_0 + \\theta \\Delta q(\\xi_j) \\quad \\text{and} \\quad a_0 + \\theta \\Delta q(\\xi_j) \\le 1\n$$\nRearranging these for $\\theta$ yields the upper bounds:\n$$\n\\theta \\le \\frac{1-a_0}{\\Delta q(\\xi_j)} \\quad \\text{if } \\Delta q(\\xi_j) > 0\n$$\n$$\n\\theta \\le \\frac{-a_0}{\\Delta q(\\xi_j)} \\quad \\text{if } \\Delta q(\\xi_j)  0\n$$\nThe \"least restrictive\" limiter corresponds to the largest possible value of $\\theta$ that satisfies the bounds for all points $\\xi_j$. This value is the minimum of all derived upper bounds, capped at 1.\n\nWe evaluate $\\Delta q(\\xi_j)$ at each GL point using the given coefficients $a_0=3/5$, $a_1=7/10$, $a_2=1/5$, and $a_3=2/5$. The constant terms are $a_0 = 3/5$ and $1-a_0 = 2/5$. The polynomial deviation is $\\Delta q(\\xi) = \\frac{7}{10} P_1(\\xi) + \\frac{1}{5} P_2(\\xi) + \\frac{2}{5} P_3(\\xi)$. We evaluate this at the four GL points:\n\n1.  At $\\xi = 1$: $P_k(1) = 1$ for all $k$.\n    $\\Delta q(1) = \\frac{7}{10}(1) + \\frac{1}{5}(1) + \\frac{2}{5}(1) = \\frac{7+2+4}{10} = \\frac{13}{10}$.\n    Since $\\Delta q(1) > 0$, the bound is $\\theta \\le \\frac{1-a_0}{\\Delta q(1)} = \\frac{2/5}{13/10} = \\frac{2}{5} \\cdot \\frac{10}{13} = \\frac{4}{13}$.\n\n2.  At $\\xi = -1$: $P_1(-1)=-1, P_2(-1)=1, P_3(-1)=-1$.\n    $\\Delta q(-1) = \\frac{7}{10}(-1) + \\frac{1}{5}(1) + \\frac{2}{5}(-1) = \\frac{-7+2-4}{10} = -\\frac{9}{10}$.\n    Since $\\Delta q(-1)  0$, the bound is $\\theta \\le \\frac{-a_0}{\\Delta q(-1)} = \\frac{-3/5}{-9/10} = \\frac{3}{5} \\cdot \\frac{10}{9} = \\frac{2}{3}$.\n\n3.  At $\\xi = 1/\\sqrt{5}$: $P_1(1/\\sqrt{5}) = 1/\\sqrt{5}$, $P_2(1/\\sqrt{5}) = -1/5$, $P_3(1/\\sqrt{5}) = -1/\\sqrt{5}$.\n    $\\Delta q(1/\\sqrt{5}) = \\frac{7}{10}(\\frac{1}{\\sqrt{5}}) + \\frac{1}{5}(-\\frac{1}{5}) + \\frac{2}{5}(-\\frac{1}{\\sqrt{5}}) = \\frac{7-4}{10\\sqrt{5}} - \\frac{1}{25} = \\frac{3\\sqrt{5}}{50} - \\frac{2}{50} = \\frac{3\\sqrt{5}-2}{50}$.\n    Since $3\\sqrt{5} > 2$, $\\Delta q(1/\\sqrt{5}) > 0$. The bound is $\\theta \\le \\frac{2/5}{(3\\sqrt{5}-2)/50} = \\frac{20}{3\\sqrt{5}-2} \\approx 4.25$. This is not restrictive.\n\n4.  At $\\xi = -1/\\sqrt{5}$: $P_1(-1/\\sqrt{5}) = -1/\\sqrt{5}$, $P_2(-1/\\sqrt{5}) = -1/5$, $P_3(-1/\\sqrt{5}) = 1/\\sqrt{5}$.\n    $\\Delta q(-1/\\sqrt{5}) = \\frac{7}{10}(-\\frac{1}{\\sqrt{5}}) + \\frac{1}{5}(-\\frac{1}{5}) + \\frac{2}{5}(\\frac{1}{\\sqrt{5}}) = \\frac{-7+4}{10\\sqrt{5}} - \\frac{1}{25} = -\\frac{3\\sqrt{5}+2}{50}$.\n    This is negative. The bound is $\\theta \\le \\frac{-3/5}{-(3\\sqrt{5}+2)/50} = \\frac{30}{3\\sqrt{5}+2} \\approx 3.44$. This is not restrictive.\n\nComparing all upper bounds on $\\theta$: $\\{\\frac{4}{13}, \\frac{2}{3}, \\dots \\}$. Since $\\frac{4}{13} \\approx 0.3077$ and $\\frac{2}{3} \\approx 0.6667$, the minimum bound is $\\frac{4}{13}$.\nThus, the least restrictive (i.e., maximal) scaling factor is $\\theta = \\frac{4}{13}$.\n\nThe modified modal coefficients, $(\\tilde{a}_0, \\tilde{a}_1, \\tilde{a}_2, \\tilde{a}_3)$, are calculated as follows:\n$\\tilde{a}_0 = a_0 = \\frac{3}{5}$\n$\\tilde{a}_k = \\theta a_k$ for $k = 1, 2, 3$.\n\n$\\tilde{a}_1 = \\theta a_1 = \\frac{4}{13} \\cdot \\frac{7}{10} = \\frac{28}{130} = \\frac{14}{65}$\n$\\tilde{a}_2 = \\theta a_2 = \\frac{4}{13} \\cdot \\frac{1}{5} = \\frac{4}{65}$\n$\\tilde{a}_3 = \\theta a_3 = \\frac{4}{13} \\cdot \\frac{2}{5} = \\frac{8}{65}$\n\nThe final modified modal coefficients are $(\\frac{3}{5}, \\frac{14}{65}, \\frac{4}{65}, \\frac{8}{65})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{5}  \\frac{14}{65}  \\frac{4}{65}  \\frac{8}{65}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}