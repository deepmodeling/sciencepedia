{
    "hands_on_practices": [
        {
            "introduction": "离散伽辽金（DG）和谱元法（SEM）的核心在于将物理域中任意形状的单元变换为一个统一的参考单元。这项练习是理解这一变换过程的基础。通过推导等参映射的雅可比行列式 ()，您将掌握数值方法如何处理几何属性，这是在天气和气候模型所使用的复杂网格上实现精确积分和离散化的关键一步。",
            "id": "4031870",
            "problem": "在用于数值天气预报和气候模拟的高阶非连续伽辽金（DG）和谱元法（SEM）离散化中，需要将物理单元上的积分变换到标准参考单元上，以便应用高斯求积并保持守恒性质。考虑一个平面四边形单元，它模拟了水平域的一个局部片区（例如，球体切平面上的一个区域块）。参考单元是坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1] $ 的正方形，物理单元的顶点（单位为千米）按逆时针顺序列出如下：\n- 参考节点 $(-1,-1)$ 映射到物理节点 $(x_{1},y_{1}) = (0,0)$，\n- 参考节点 $(1,-1)$ 映射到物理节点 $(x_{2},y_{2}) = (100,0)$，\n- 参考节点 $(1,1)$ 映射到物理节点 $(x_{3},y_{3}) = (110,90)$，\n- 参考节点 $(-1,1)$ 映射到物理节点 $(x_{4},y_{4}) = (-10,80)$。\n\n从四边形单元等参映射的基本定义以及参考正方形上的双线性形函数出发，推导物理坐标 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的表达式，然后计算映射的雅可比矩阵 $J(\\xi,\\eta)$，其中 $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$。利用这些结果，求出雅可比行列式 $\\det(J(\\xi,\\eta))$，该行列式在将积分从物理单元变换到参考单元时用于缩放面积。将最终结果表示为关于 $\\xi$ 和 $\\eta$ 的单一闭式解析表达式，并表示出其系数，使行列式的单位为平方千米。无需进行数值四舍五入；在适当的情况下提供精确的有理数系数。最终的方框答案应为 $\\det(J(\\xi,\\eta))$ 的解析表达式，单位为平方千米。",
            "solution": "该问题要求推导从一个标准参考单元到物理四边形单元的等参映射的雅可比行列式。参考单元是由 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 定义的正方形。该变换建立在四边形单元的标准双线性形函数之上。\n\n参考正方形上的四个双线性形函数 $N_i(\\xi, \\eta)$（其中 $i \\in \\{1, 2, 3, 4\\}$）是根据其角节点定义的，这些角节点按逆时针顺序为：节点 1 位于 $(-1, -1)$，节点 2 位于 $(1, -1)$，节点 3 位于 $(1, 1)$，以及节点 4 位于 $(-1, 1)$。这些函数是：\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\n物理坐标 $(x, y)$ 通过使用这些形函数和物理单元顶点的坐标 $(x_i, y_i)$ 进行等参插值来确定：\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} x_i N_i(\\xi, \\eta)$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} y_i N_i(\\xi, \\eta)$$\n\n问题给出了物理顶点的坐标（单位为千米）：\n- $(x_1, y_1) = (0, 0)$\n- $(x_2, y_2) = (100, 0)$\n- $(x_3, y_3) = (110, 90)$\n- $(x_4, y_4) = (-10, 80)$\n\n我们将这些顶点坐标代入映射方程中：\n$$x(\\xi, \\eta) = (0)N_1(\\xi, \\eta) + (100)N_2(\\xi, \\eta) + (110)N_3(\\xi, \\eta) + (-10)N_4(\\xi, \\eta)$$\n$$y(\\xi, \\eta) = (0)N_1(\\xi, \\eta) + (0)N_2(\\xi, \\eta) + (90)N_3(\\xi, \\eta) + (80)N_4(\\xi, \\eta)$$\n\n展开这些表达式：\n$$x(\\xi, \\eta) = \\frac{1}{4} [100(1+\\xi)(1-\\eta) + 110(1+\\xi)(1+\\eta) - 10(1-\\xi)(1+\\eta)]$$\n$$y(\\xi, \\eta) = \\frac{1}{4} [90(1+\\xi)(1+\\eta) + 80(1-\\xi)(1+\\eta)]$$\n\n为简化起见，我们根据基 $\\{1, \\xi, \\eta, \\xi\\eta\\}$ 收集各项：\n对于 $x(\\xi, \\eta)$：\n$$4x = 100(1 - \\eta + \\xi - \\xi\\eta) + 110(1 + \\eta + \\xi + \\xi\\eta) - 10(1 + \\eta - \\xi - \\xi\\eta)$$\n$$4x = (100+110-10) \\cdot 1 + (100+110-(-10))\\xi + (-100+110-10)\\eta + (-100+110-(-10))\\xi\\eta$$\n$$4x = 200 + 220\\xi + 0\\eta + 20\\xi\\eta$$\n$$x(\\xi, \\eta) = 50 + 55\\xi + 5\\xi\\eta$$\n\n对于 $y(\\xi, \\eta)$：\n$$4y = 90(1 + \\eta + \\xi + \\xi\\eta) + 80(1 + \\eta - \\xi - \\xi\\eta)$$\n$$4y = (90+80) \\cdot 1 + (90-80)\\xi + (90+80)\\eta + (90-80)\\xi\\eta$$\n$$4y = 170 + 10\\xi + 170\\eta + 10\\xi\\eta$$\n$$y(\\xi, \\eta) = \\frac{170}{4} + \\frac{10}{4}\\xi + \\frac{170}{4}\\eta + \\frac{10}{4}\\xi\\eta = \\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta$$\n\n映射的雅可比矩阵 $J(\\xi, \\eta)$ 是一阶偏导数矩阵：\n$$J(\\xi, \\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\n我们从 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$ 的表达式中计算四个偏导数：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(50 + 55\\xi + 5\\xi\\eta) = 55 + 5\\eta$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(50 + 55\\xi + 5\\xi\\eta) = 5\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta\\right) = \\frac{5}{2} + \\frac{5}{2}\\eta$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\frac{85}{2} + \\frac{5}{2}\\xi + \\frac{85}{2}\\eta + \\frac{5}{2}\\xi\\eta\\right) = \\frac{85}{2} + \\frac{5}{2}\\xi$$\n\n雅可比矩阵为：\n$$J(\\xi, \\eta) = \\begin{pmatrix} 55 + 5\\eta & 5\\xi \\\\ \\frac{5}{2} + \\frac{5}{2}\\eta & \\frac{85}{2} + \\frac{5}{2}\\xi \\end{pmatrix}$$\n\n雅可比行列式 $\\det(J(\\xi, \\eta))$ 计算如下：\n$$\\det(J(\\xi, \\eta)) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)$$\n$$\\det(J(\\xi, \\eta)) = (55 + 5\\eta)\\left(\\frac{85}{2} + \\frac{5}{2}\\xi\\right) - (5\\xi)\\left(\\frac{5}{2} + \\frac{5}{2}\\eta\\right)$$\n\n展开乘积：\n$$\\det(J) = \\left(55 \\cdot \\frac{85}{2} + 55 \\cdot \\frac{5}{2}\\xi + 5\\eta \\cdot \\frac{85}{2} + 5\\eta \\cdot \\frac{5}{2}\\xi\\right) - \\left(5\\xi \\cdot \\frac{5}{2} + 5\\xi \\cdot \\frac{5}{2}\\eta\\right)$$\n$$\\det(J) = \\left(\\frac{4675}{2} + \\frac{275}{2}\\xi + \\frac{425}{2}\\eta + \\frac{25}{2}\\xi\\eta\\right) - \\left(\\frac{25}{2}\\xi + \\frac{25}{2}\\xi\\eta\\right)$$\n\n合并同类项可简化表达式：\n$$\\det(J) = \\frac{4675}{2} + \\left(\\frac{275}{2} - \\frac{25}{2}\\right)\\xi + \\frac{425}{2}\\eta + \\left(\\frac{25}{2} - \\frac{25}{2}\\right)\\xi\\eta$$\n$$\\det(J) = \\frac{4675}{2} + \\frac{250}{2}\\xi + \\frac{425}{2}\\eta$$\n$$\\det(J(\\xi, \\eta)) = \\frac{4675}{2} + 125\\xi + \\frac{425}{2}\\eta$$\n\n物理坐标的单位是千米，而参考坐标 $(\\xi, \\eta)$ 是无量纲的。因此，偏导数的单位是千米，雅可比行列式的单位是平方千米。结果即为所求的带有精确有理数系数的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{4675}{2} + 125\\xi + \\frac{425}{2}\\eta}$$"
        },
        {
            "introduction": "在对大气中的流体平流等非线性物理过程进行建模时，我们必须在多项式空间内近似处理非线性项。这项练习探讨了在这种近似中出现的一个虽细微却至关重要的问题。通过比较节点插值和模态投影这两种处理非线性项的方法 ()，您将直接洞察混叠误差（aliasing error）这一现象，这对于确保非线性模拟的稳定性和准确性至关重要，并为在业务模型中使用去混叠技术提供了理论依据。",
            "id": "4031843",
            "problem": "考虑一个在区间 $[-1,1]$ 上的一维参考谱元，该谱元用于采用谱元法（SEM）的数值天气预报模式的动力核心中。设多项式逼近空间的次数为 $N=2$，基为 Legendre 多项式 $\\{P_{0}(x),P_{1}(x),P_{2}(x)\\}$，其中 $P_{0}(x)=1$，$P_{1}(x)=x$，$P_{2}(x)=\\frac{1}{2}(3x^{2}-1)$。节点基在 Gauss–Lobatto–Legendre (GLL) 节点上构成，对于 $N=2$，这些节点是 $x=-1,0,1$。在大气流动 Euler 方程的典型间断 Galerkin (DG) 或 SEM 离散化中，会出现诸如 $u^{3}$ 之类的非线性乘积，并且必须在次数为 $N$ 的多项式空间内进行逼近。\n\n将此单元内的预报场 $u(x)$ 取为 $u(x)=P_{2}(x)$。考虑两种形成非线性项 $u^{3}$ 的次数为 $N$ 的逼近的标准方法：\n- 节点插值：在 GLL 节点上逐点计算 $u^{3}$，并用 2 次节点 Lagrange 基对其进行插值，以获得一个多项式 $f^{I}(x)\\in\\mathrm{span}\\{P_{0},P_{1},P_{2}\\}$。\n- 模态投影：利用 Legendre 基及其在 $[-1,1]$ 上关于标准内积的正交性，将 $u^{3}$ 作 $\\mathrm{L}^{2}$ 投影到 $\\mathrm{span}\\{P_{0},P_{1},P_{2}\\}$ 上，从而得到 $f^{P}(x)\\in\\mathrm{span}\\{P_{0},P_{1},P_{2}\\}$。\n\n仅从 Legendre 多项式的定义、它们在 $[-1,1]$ 上的正交性以及 $\\mathrm{L}^{2}$ 投影的定义出发，推导 $f^{I}(x)$ 和 $f^{P}(x)$ 的精确表达式，并计算差值\n$$\nE(x)=f^{I}(x)-f^{P}(x).\n$$\n将您的最终答案表示为关于 $P_{0}(x)$ 和 $P_{2}(x)$ 的单个闭式解析表达式。简要解释为什么非零的 $E(x)$ 代表了非线性计算中的混叠误差，以及这如何推动了谱元和间断 Galerkin 模式在气候和天气应用中去混叠策略的发展。不需要数值舍入，也不涉及物理单位。请提供 $E(x)$ 作为您的最终答案。",
            "solution": "该问题要求在谱元背景下推导非线性项 $u(x)^3$ 的两种不同逼近，并计算它们之间的差值。场 $u(x)$ 被给定为二阶 Legendre 多项式 $u(x) = P_{2}(x)$，位于一个用次数为 $N=2$ 的多项式空间离散化的参考单元 $[-1, 1]$ 内。两种逼近方法是在 Gauss-Lobatto-Legendre (GLL) 节点上的节点插值和到由 $\\{P_{0}(x), P_{1}(x), P_{2}(x)\\}$ 张成的多项式空间上的模态 $\\mathrm{L}^2$ 投影。\n\n次数最高为 2 的 Legendre 多项式是：\n$$P_{0}(x) = 1$$\n$$P_{1}(x) = x$$\n$$P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$$\n\n问题陈述，对于 $N=2$，GLL 节点为 $x = \\{-1, 0, 1\\}$。\n\n让我们首先计算 $u(x)^3$ 的节点插值，记为 $f^{I}(x)$。我们首先在 GLL 节点上计算 $u(x)$ 和 $u(x)^3$ 的值。\n$u(x) = P_{2}(x)$ 在节点上的值为：\n$$u(-1) = P_{2}(-1) = \\frac{1}{2}(3(-1)^{2}-1) = 1$$\n$$u(0) = P_{2}(0) = \\frac{1}{2}(3(0)^{2}-1) = -\\frac{1}{2}$$\n$$u(1) = P_{2}(1) = \\frac{1}{2}(3(1)^{2}-1) = 1$$\n\n现在，我们计算非线性项 $u(x)^3$ 在这些节点上的值：\n$$u(-1)^3 = 1^3 = 1$$\n$$u(0)^3 = \\left(-\\frac{1}{2}\\right)^3 = -\\frac{1}{8}$$\n$$u(1)^3 = 1^3 = 1$$\n\n节点插值 $f^{I}(x)$ 是经过点 $(-1, 1)$、$(0, -1/8)$ 和 $(1, 1)$ 的唯一的次数为 $N=2$ 的多项式。设 $f^{I}(x) = ax^2 + bx + c$。\n使用点 $(0, -1/8)$，我们得到 $c = -1/8$。\n使用点 $(1, 1)$ 和 $(-1, 1)$：\n$$a(1)^2 + b(1) + c = 1 \\implies a+b-\\frac{1}{8} = 1 \\implies a+b = \\frac{9}{8}$$\n$$a(-1)^2 + b(-1) + c = 1 \\implies a-b-\\frac{1}{8} = 1 \\implies a-b = \\frac{9}{8}$$\n将这两个方程相加得到 $2a = \\frac{18}{8}$，所以 $a = \\frac{9}{8}$。将它们相减得到 $2b=0$，所以 $b=0$。\n因此，插值多项式为 $f^{I}(x) = \\frac{9}{8}x^2 - \\frac{1}{8}$。\n\n为了用 Legendre 基表示 $f^{I}(x)$，我们反解 $P_{2}(x)$ 的定义：\n$P_{2}(x) = \\frac{3}{2}x^2 - \\frac{1}{2} \\implies x^2 = \\frac{2}{3}P_{2}(x) + \\frac{1}{3}$。因为 $P_{0}(x)=1$，我们有 $x^2 = \\frac{2}{3}P_{2}(x) + \\frac{1}{3}P_{0}(x)$。\n将此代入 $f^{I}(x)$ 的表达式中：\n$$f^{I}(x) = \\frac{9}{8}\\left(\\frac{2}{3}P_{2}(x) + \\frac{1}{3}P_{0}(x)\\right) - \\frac{1}{8}P_{0}(x)$$\n$$f^{I}(x) = \\frac{3}{4}P_{2}(x) + \\frac{3}{8}P_{0}(x) - \\frac{1}{8}P_{0}(x)$$\n$$f^{I}(x) = \\frac{3}{4}P_{2}(x) + \\frac{1}{4}P_{0}(x)$$\n\n接下来，我们计算 $u(x)^3$ 的模态投影，记为 $f^{P}(x)$。这是 $u(x)^3 = P_{2}(x)^3$ 到空间 $\\mathrm{span}\\{P_0, P_1, P_2\\}$ 上的 $\\mathrm{L}^2$ 投影。\n$$f^{P}(x) = c_0 P_0(x) + c_1 P_1(x) + c_2 P_2(x)$$\n系数 $c_k$ 由投影公式给出，该公式依赖于 Legendre 多项式的正交性：\n$$c_k = \\frac{\\langle P_2^3, P_k \\rangle}{\\langle P_k, P_k \\rangle} = \\frac{\\int_{-1}^{1} P_2(x)^3 P_k(x) dx}{\\int_{-1}^{1} P_k(x)^2 dx}$$\n归一化因子为 $\\langle P_k, P_k \\rangle = \\frac{2}{2k+1}$。\n函数 $P_2(x)^3$ 是 $x$ 的偶函数，因为 $P_2(x)$ 是偶函数。一个偶函数乘以一个奇函数（$P_1(x)=x$）在对称区间上的积分为零。因此，$c_1=0$。\n为了求出 $c_0$ 和 $c_2$，我们首先将 $P_2(x)^3$ 表示为 Legendre 多项式的和。我们从展开 $P_2(x)^2$ 开始：\n$$P_2(x)^2 = \\left(\\frac{1}{2}(3x^2-1)\\right)^2 = \\frac{1}{4}(9x^4-6x^2+1)$$\n我们使用已知的展开式 $x^2 = \\frac{2}{3}P_2(x) + \\frac{1}{3}P_0(x)$ 和 $x^4 = \\frac{8}{35}P_4(x) + \\frac{4}{7}P_2(x) + \\frac{1}{5}P_0(x)$。\n$$P_2(x)^2 = \\frac{9}{4}\\left(\\frac{8}{35}P_4 + \\frac{4}{7}P_2 + \\frac{1}{5}P_0\\right) - \\frac{6}{4}\\left(\\frac{2}{3}P_2 + \\frac{1}{3}P_0\\right) + \\frac{1}{4}P_0$$\n$$P_2(x)^2 = \\frac{18}{35}P_4(x) + \\left(\\frac{9}{7}-1\\right)P_2(x) + \\left(\\frac{9}{20}-\\frac{1}{2}+\\frac{1}{4}\\right)P_0(x)$$\n$$P_2(x)^2 = \\frac{18}{35}P_4(x) + \\frac{2}{7}P_2(x) + \\frac{1}{5}P_0(x)$$\n现在我们计算 $P_2(x)^3 = P_2(x) \\cdot P_2(x)^2:$\n$$P_2(x)^3 = P_2(x) \\left( \\frac{18}{35}P_4(x) + \\frac{2}{7}P_2(x) + \\frac{1}{5}P_0(x) \\right)$$\n$$P_2(x)^3 = \\frac{18}{35} P_2(x)P_4(x) + \\frac{2}{7} P_2(x)^2 + \\frac{1}{5} P_2(x)$$\n到 $\\mathrm{span}\\{P_0, P_1, P_2\\}$ 上的 $\\mathrm{L}^2$ 投影包括只取指标 $k \\le 2$ 的项。设 $\\mathcal{P}_2$ 为投影算子。\n$$f^P(x) = \\mathcal{P}_2(P_2(x)^3) = \\frac{18}{35} \\mathcal{P}_2(P_2 P_4) + \\frac{2}{7} \\mathcal{P}_2(P_2^2) + \\frac{1}{5} \\mathcal{P}_2(P_2)$$\n根据定义，$\\mathcal{P}_2(P_2) = P_2$，并且从上面 $P_2^2$ 的展开式可知，$\\mathcal{P}_2(P_2^2) = \\frac{2}{7}P_2 + \\frac{1}{5}P_0$。项 $\\mathcal{P}_2(P_2 P_4)$ 需要找到乘积 $P_2 P_4$ 的 $P_0$ 和 $P_2$ 分量。该乘积是一个 6 次多项式并且是偶函数，因此其展开式只包含 $P_0, P_2, P_4, P_6$。$P_0$ 分量与 $\\int_{-1}^1 P_2 P_4 dx$ 成正比，根据正交性，该积分为零。$P_2$ 分量通过 $\\frac{\\langle P_2 P_4, P_2 \\rangle}{\\langle P_2, P_2 \\rangle}P_2 = \\frac{\\int_{-1}^1 P_2^2 P_4 dx}{\\int_{-1}^1 P_2^2 dx}P_2$ 找到。\n使用 $P_2^2$ 的展开式：\n$$\\int_{-1}^{1} P_2^2 P_4 dx = \\int_{-1}^{1} \\left( \\frac{18}{35}P_4 + \\frac{2}{7}P_2 + \\frac{1}{5}P_0 \\right) P_4 dx = \\frac{18}{35} \\int_{-1}^{1} P_4^2 dx = \\frac{18}{35} \\frac{2}{9} = \\frac{4}{35}$$\n$P_2$ 分量的系数是 $\\frac{4/35}{2/5} = \\frac{4}{35}\\frac{5}{2} = \\frac{2}{7}$。所以 $\\mathcal{P}_2(P_2 P_4) = \\frac{2}{7}P_2$。\n代回：\n$$f^P(x) = \\frac{18}{35}\\left(\\frac{2}{7}P_2\\right) + \\frac{2}{7}\\left(\\frac{2}{7}P_2 + \\frac{1}{5}P_0\\right) + \\frac{1}{5}P_2$$\n$$f^P(x) = \\left(\\frac{36}{245} + \\frac{4}{49} + \\frac{1}{5}\\right)P_2(x) + \\frac{2}{35}P_0(x)$$\n$$f^P(x) = \\left(\\frac{36}{245} + \\frac{20}{245} + \\frac{49}{245}\\right)P_2(x) + \\frac{2}{35}P_0(x) = \\frac{105}{245}P_2(x) + \\frac{2}{35}P_0(x)$$\n$$f^{P}(x) = \\frac{3}{7}P_{2}(x) + \\frac{2}{35}P_{0}(x)$$\n\n最后，我们计算差值 $E(x) = f^I(x) - f^P(x)$：\n$$E(x) = \\left(\\frac{3}{4}P_2(x) + \\frac{1}{4}P_0(x)\\right) - \\left(\\frac{3}{7}P_2(x) + \\frac{2}{35}P_0(x)\\right)$$\n$$E(x) = \\left(\\frac{3}{4} - \\frac{3}{7}\\right)P_2(x) + \\left(\\frac{1}{4} - \\frac{2}{35}\\right)P_0(x)$$\n$$E(x) = \\left(\\frac{21 - 12}{28}\\right)P_2(x) + \\left(\\frac{35 - 8}{140}\\right)P_0(x)$$\n$$E(x) = \\frac{9}{28}P_2(x) + \\frac{27}{140}P_0(x)$$\n\n非零差值 $E(x)$ 代表混叠误差。精确的非线性项 $u^3(x)=P_2(x)^3$ 是一个 6 次多项式，因此包含高阶 Legendre 多项式 ($P_4$ 和 $P_6$) 的分量。模态投影 $f^P(x)$ 是数学上最优的 2 次逼近，因为它正确地滤除了这些高阶模态。相比之下，节点插值 $f^I(x)$ 在一个过于粗糙以至于无法分辨其所有多项式模态的网格上计算非线性项。未分辨的高阶模态被虚假地表示为低阶模态，这种现象称为混叠。因此，$f^I(x)$ 的系数被这种混叠能量“污染”了。差值 $E(x)$ 正是这种污染或混叠误差。在像 Euler 方程这样的非线性系统的数值模拟中，混叠误差会导致能量在最高可分辨波数处发生非物理的堆积，并引起数值不稳定性。这促使了去混叠技术的使用，例如过采样（如针对二次非线性的 3/2 法则），这些技术在更精细的网格上计算非线性项以精确计算乘积，然后将其投影回原始多项式空间，从而有效地计算 $f^P(x)$ 而非 $f^I(x)$。",
            "answer": "$$\\boxed{\\frac{9}{28}P_{2}(x) + \\frac{27}{140}P_{0}(x)}$$"
        },
        {
            "introduction": "像DG这样的高阶方法在陡峭梯度附近可能会产生非物理的振荡，导致出现例如负水汽浓度等不切实际的数值。为了构建稳健的模型，我们必须对解强制施加物理边界。这项练习将指导您应用一种基于矩的限制器（moment-based limiter），这是一种确保物理解真实的常用技术 ()。通过在保持单元平均值不变的同时调整高阶矩，您将学会一种在维持守恒性和有界性方面的实用方法，这是开发可靠的天气和气候预报系统的关键技能。",
            "id": "4031860",
            "problem": "考虑一个数值天气预报柱状模型中，水汽混合比（一个有界标量场 $q(x,t)$）的一维平流，其满足标量守恒律 $q_t + (c q)_x = 0$，其中风速 $c$ 为常数。在参考坐标 $\\xi \\in [-1,1]$ 的单个谱元（单元）上，间断 Galerkin (DG) 表示法使用分层 Legendre 模态基 $P_k(\\xi)$，其中 $P_0(\\xi) = 1$，$P_1(\\xi) = \\xi$，$P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)$，以及 $P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi)$。单元内 $p=3$ 次的多项式表示为\n$$\nq_h(\\xi) = a_0 P_0(\\xi) + a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi),\n$$\n其中单元平均值满足 $\\frac{1}{2}\\int_{-1}^{1} q_h(\\xi)\\,d\\xi = a_0$。\n\n物理真实性要求混合比满足边界条件 $0 \\le q \\le 1$。在存在激波对齐梯度的情况下，给定时间步长下目标单元中的无界 DG 多项式为\n$$\na_0 = \\frac{3}{5},\\quad a_1 = \\frac{7}{10},\\quad a_2 = \\frac{1}{5},\\quad a_3 = \\frac{2}{5}.\n$$\n为了在保持守恒性的同时强制有界性，应用一个基于矩的限制器，该限制器保持单元平均值 $a_0$ 不变，并用一个单一因子 $\\theta \\in [0,1]$ 重新缩放所有更高阶的模态矩：\n$$\n\\tilde{q}_h(\\xi) = a_0 P_0(\\xi) + \\theta\\big(a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi)\\big).\n$$\n使用 $p=3$ 时的 Legendre–Gauss–Lobatto (GL) 点作为限制集：$\\xi \\in \\{-1,\\,-1/\\sqrt{5},\\,1/\\sqrt{5},\\,1\\}$。限制器必须被选择以确保在所有这些点上都有 $0 \\le \\tilde{q}_h(\\xi) \\le 1$，并且必须是与这些边界一致的限制性最小的缩放。\n\n从守恒律和对 $q$ 的极值原理要求出发，推导满足 GL 点边界的最小容许 $\\theta$ 的表达式，并计算强制有界性的 $3$ 次多项式的修正模态系数 $(\\tilde{a}_0,\\tilde{a}_1,\\tilde{a}_2,\\tilde{a}_3)$。将最终的模态系数表示为无量纲数。如果选择用小数表示，请四舍五入到六位有效数字。",
            "solution": "所述问题要求对一个标量场 $q_h(\\xi)$ 的 3 次多项式表示应用一个基于矩的限制器，以强制执行物理边界 $0 \\le q \\le 1$。该方法必须保持单元平均模态系数 $a_0$ 不变，同时用单一因子 $\\theta \\in [0,1]$ 缩放高阶系数（$a_1$、$a_2$、$a_3$）。\n\n限制后的多项式由下式给出：\n$$\n\\tilde{q}_h(\\xi) = a_0 P_0(\\xi) + \\theta \\left( a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi) \\right)\n$$\n由于 $P_0(\\xi)=1$，我们可以将其写为：\n$$\n\\tilde{q}_h(\\xi) = a_0 + \\theta \\Delta q(\\xi)\n$$\n其中 $\\Delta q(\\xi) = a_1 P_1(\\xi) + a_2 P_2(\\xi) + a_3 P_3(\\xi)$ 表示高阶模态的贡献。\n\n限制器必须在指定的 $p=3$ 时的 Legendre-Gauss-Lobatto (GL) 点 $\\xi_j \\in \\{-1, -1/\\sqrt{5}, 1/\\sqrt{5}, 1\\}$ 强制执行边界 $0 \\le \\tilde{q}_h(\\xi) \\le 1$。对于每个点 $\\xi_j$，我们有两个不等式：\n$$\n0 \\le a_0 + \\theta \\Delta q(\\xi_j) \\quad \\text{和} \\quad a_0 + \\theta \\Delta q(\\xi_j) \\le 1\n$$\n对 $\\theta$ 进行整理可得：\n$$\n\\theta \\Delta q(\\xi_j) \\ge -a_0 \\quad \\text{和} \\quad \\theta \\Delta q(\\xi_j) \\le 1 - a_0\n$$\n为了找到对 $\\theta$ 的约束，我们根据 $\\Delta q(\\xi_j)$ 的符号分析两种情况：\n1. 如果 $\\Delta q(\\xi_j) > 0$：\n   第一个不等式 $\\theta \\ge -a_0 / \\Delta q(\\xi_j)$ 不具限制性，因为 $a_0 = 3/5 > 0$ 且 $\\theta$ 已被约束为非负数。第二个不等式给出一个上限：$\\theta \\le \\frac{1 - a_0}{\\Delta q(\\xi_j)}$。\n2. 如果 $\\Delta q(\\xi_j) < 0$：\n   第一个不等式变为 $\\theta \\le \\frac{-a_0}{\\Delta q(\\xi_j)} = \\frac{a_0}{|\\Delta q(\\xi_j)|}$，这是一个上限。第二个不等式 $\\theta \\ge \\frac{1 - a_0}{\\Delta q(\\xi_j)}$ 提供了一个不具限制性的负下限，因为 $1-a_0 > 0$。\n\n“限制性最小”的限制器对应于满足所有点 $\\xi_j$ 边界的 $\\theta$ 的可能最大值。该值为所有导出上限中的最小值，且最大不能超过 $1$。\n$$\n\\theta = \\min\\left(1, \\min_{\\xi_j} \\begin{cases} \\frac{1-a_0}{\\Delta q(\\xi_j)} & \\text{若 } \\Delta q(\\xi_j) > 0 \\\\ \\frac{-a_0}{\\Delta q(\\xi_j)} & \\text{若 } \\Delta q(\\xi_j) < 0 \\end{cases} \\right)\n$$\n我们现在使用给定的系数 $a_0=3/5$、$a_1=7/10$、$a_2=1/5$ 和 $a_3=2/5$ 来计算每个 GL 点上的 $\\Delta q(\\xi_j)$。量 $1-a_0$ 为 $1 - 3/5 = 2/5$。\n\n函数 $\\Delta q(\\xi)$ 是：\n$$\n\\Delta q(\\xi) = \\frac{7}{10} P_1(\\xi) + \\frac{1}{5} P_2(\\xi) + \\frac{2}{5} P_3(\\xi)\n$$\n我们在四个 GL 点上计算该值：\n\n1. 在 $\\xi = 1$ 处：\n   对于所有 $k$，$P_k(1) = 1$。\n   $\\Delta q(1) = \\frac{7}{10}(1) + \\frac{1}{5}(1) + \\frac{2}{5}(1) = \\frac{7}{10} + \\frac{2}{10} + \\frac{4}{10} = \\frac{13}{10}$。\n   由于 $\\Delta q(1) > 0$，边界为 $\\theta \\le \\frac{1-a_0}{\\Delta q(1)} = \\frac{2/5}{13/10} = \\frac{2}{5} \\cdot \\frac{10}{13} = \\frac{4}{13}$。\n\n2. 在 $\\xi = -1$ 处：\n   $P_1(-1) = -1$, $P_2(-1) = 1$, $P_3(-1) = -1$。\n   $\\Delta q(-1) = \\frac{7}{10}(-1) + \\frac{1}{5}(1) + \\frac{2}{5}(-1) = -\\frac{7}{10} + \\frac{2}{10} - \\frac{4}{10} = -\\frac{9}{10}$。\n   由于 $\\Delta q(-1) < 0$，边界为 $\\theta \\le \\frac{-a_0}{\\Delta q(-1)} = \\frac{-3/5}{-9/10} = \\frac{3}{5} \\cdot \\frac{10}{9} = \\frac{2}{3}$。\n\n3. 在 $\\xi = 1/\\sqrt{5}$ 处：\n   $P_1(1/\\sqrt{5}) = 1/\\sqrt{5}$\n   $P_2(1/\\sqrt{5}) = \\frac{1}{2}(3(\\frac{1}{5}) - 1) = -\\frac{1}{5}$\n   $P_3(1/\\sqrt{5}) = \\frac{1}{2}(5(\\frac{1}{5\\sqrt{5}}) - 3(\\frac{1}{\\sqrt{5}})) = \\frac{1}{2}(\\frac{1}{\\sqrt{5}} - \\frac{3}{\\sqrt{5}}) = -\\frac{1}{\\sqrt{5}}$\n   $\\Delta q(1/\\sqrt{5}) = \\frac{7}{10}(\\frac{1}{\\sqrt{5}}) + \\frac{1}{5}(-\\frac{1}{5}) + \\frac{2}{5}(-\\frac{1}{\\sqrt{5}}) = \\frac{7}{10\\sqrt{5}} - \\frac{1}{25} - \\frac{4}{10\\sqrt{5}} = \\frac{3}{10\\sqrt{5}} - \\frac{1}{25} = \\frac{3\\sqrt{5}}{50} - \\frac{2}{50} = \\frac{3\\sqrt{5}-2}{50}$。\n   由于 $3\\sqrt{5} \\approx 6.7 > 2$，$\\Delta q(1/\\sqrt{5}) > 0$。边界为 $\\theta \\le \\frac{1-a_0}{\\Delta q(1/\\sqrt{5})} = \\frac{2/5}{(3\\sqrt{5}-2)/50} = \\frac{20}{3\\sqrt{5}-2}$。\n\n4. 在 $\\xi = -1/\\sqrt{5}$ 处：\n   $P_1(-1/\\sqrt{5}) = -1/\\sqrt{5}$\n   $P_2(-1/\\sqrt{5}) = -1/5$\n   $P_3(-1/\\sqrt{5}) = 1/\\sqrt{5}$\n   $\\Delta q(-1/\\sqrt{5}) = \\frac{7}{10}(-\\frac{1}{\\sqrt{5}}) + \\frac{1}{5}(-\\frac{1}{5}) + \\frac{2}{5}(\\frac{1}{\\sqrt{5}}) = -\\frac{7}{10\\sqrt{5}} - \\frac{1}{25} + \\frac{4}{10\\sqrt{5}} = -\\frac{3}{10\\sqrt{5}} - \\frac{1}{25} = -\\frac{3\\sqrt{5}+2}{50}$。\n   该值为负。边界为 $\\theta \\le \\frac{-a_0}{\\Delta q(-1/\\sqrt{5})} = \\frac{-3/5}{-(3\\sqrt{5}+2)/50} = \\frac{30}{3\\sqrt{5}+2}$。\n\n比较 $\\theta$ 的所有上界：$\\{ \\frac{4}{13}, \\frac{2}{3}, \\frac{20}{3\\sqrt{5}-2}, \\frac{30}{3\\sqrt{5}+2} \\}$，以及原始约束 $\\theta \\le 1$。\n$\\frac{4}{13} \\approx 0.3077$\n$\\frac{2}{3} \\approx 0.6667$\n另外两个界限远大于 1，因此限制性较弱。这些值的最小值是 $\\frac{4}{13}$。\n因此，限制性最小（即最大）的缩放因子是 $\\theta = \\frac{4}{13}$。\n\n问题要求修正后的模态系数，$(\\tilde{a}_0, \\tilde{a}_1, \\tilde{a}_2, \\tilde{a}_3)$。它们的计算方法如下：\n$\\tilde{a}_0 = a_0 = \\frac{3}{5}$\n对于 $k = 1, 2, 3$，$\\tilde{a}_k = \\theta a_k$。\n\n$\\tilde{a}_1 = \\theta a_1 = \\frac{4}{13} \\cdot \\frac{7}{10} = \\frac{28}{130} = \\frac{14}{65}$\n$\\tilde{a}_2 = \\theta a_2 = \\frac{4}{13} \\cdot \\frac{1}{5} = \\frac{4}{65}$\n$\\tilde{a}_3 = \\theta a_3 = \\frac{4}{13} \\cdot \\frac{2}{5} = \\frac{8}{65}$\n\n最终的修正模态系数为 $(\\frac{3}{5}, \\frac{14}{65}, \\frac{4}{65}, \\frac{8}{65})$。\n作为分数，它们是精确的。转换为小数并四舍五入到六位有效数字：\n$\\tilde{a}_0 = 0.6$\n$\\tilde{a}_1 = 14/65 \\approx 0.215385$\n$\\tilde{a}_2 = 4/65 \\approx 0.0615385$\n$\\tilde{a}_3 = 8/65 \\approx 0.123077$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{5} & \\frac{14}{65} & \\frac{4}{65} & \\frac{8}{65}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}