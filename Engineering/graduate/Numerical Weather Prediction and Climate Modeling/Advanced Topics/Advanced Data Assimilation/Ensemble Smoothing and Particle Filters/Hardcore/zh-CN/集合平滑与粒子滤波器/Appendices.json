{
    "hands_on_practices": [
        {
            "introduction": "集合是一组离散的样本，用于近似一个概率分布。虽然标准的集合卡尔曼滤波器（EnKF）仅使用样本均值和协方差来表征后验分布，但我们可以利用核密度估计（KDE）等方法构建一个更丰富、可能非高斯的后验估计。这个练习将指导你完成这一过程，并量化KDE方法与标准EnKF在表示后验协方差方面的差异，从而加深对集合作为分布近似的理解。",
            "id": "4037867",
            "problem": "考虑一个数值天气预报分析中的局部化、无量纲的双变量状态，该状态表示近地表温度和纬向风的标准化异常。一个集成卡尔曼滤波器 (EnKF) 产生了一个大小为 $N=5$ 的分析集合，其成员为 $\\{x^{(i)}\\}_{i=1}^{N}$，其中每个成员 $x^{(i)} \\in \\mathbb{R}^{2}$ 已经通过气候方差进行了标准化，因此是无量纲的。集合成员如下\n$$\nx^{(1)}=\\begin{pmatrix}0.80\\\\-1.20\\end{pmatrix},\\quad\nx^{(2)}=\\begin{pmatrix}1.10\\\\-0.90\\end{pmatrix},\\quad\nx^{(3)}=\\begin{pmatrix}0.50\\\\-1.50\\end{pmatrix},\\quad\nx^{(4)}=\\begin{pmatrix}0.95\\\\-1.05\\end{pmatrix},\\quad\nx^{(5)}=\\begin{pmatrix}0.65\\\\-1.35\\end{pmatrix}.\n$$\n在集合平滑中，可以使用核密度估计 (KDE) 来近似后验分布，此处使用以每个集合成员为中心的等权重高斯核来构建KDE。设核为多元高斯分布，其带宽矩阵为 $H=h^{2}I_{2}$，其中 $h=0.20$ (因此 $H=0.04\\,I_{2}$)。使用核 $K_{H}$ 的基本定义以及全期望定律和全协方差定律，执行以下操作：\n\n- 推导由给定核和集合所隐含的KDE后验 $\\hat{p}(x)$ 的解析表达式。\n- 从第一性原理出发，根据 $H$ 和集合矩推导 $\\hat{p}(x)$ 的均值和协方差的闭式表达式。\n- 对给定的集合和带宽，计算 $\\hat{p}(x)$ 的数值均值和协方差。\n- 计算集成卡尔曼滤波器 (EnKF) 对同一集合使用的无偏样本协方差。\n- 计算KDE协方差与EnKF样本协方差之差的弗罗贝尼乌斯范数。\n\n提供弗罗贝尼乌斯范数的最终标量值作为你的答案。最终答案必须是无量纲的，并四舍五入到四位有效数字。以无单位的标量形式表示最终结果。",
            "solution": "用户想要解决一个关于集合平滑和核密度估计 (KDE) 的问题。\n\n### 问题验证\n\n**第1步：提取给定条件**\n\n- **集合大小**：$N=5$。\n- **状态空间维度**：$d=2$。\n- **集合成员** $\\{x^{(i)}\\}_{i=1}^{5}$：\n$$\nx^{(1)}=\\begin{pmatrix}0.80\\\\-1.20\\end{pmatrix},\\quad\nx^{(2)}=\\begin{pmatrix}1.10\\\\-0.90\\end{pmatrix},\\quad\nx^{(3)}=\\begin{pmatrix}0.50\\\\-1.50\\end{pmatrix},\\quad\nx^{(4)}=\\begin{pmatrix}0.95\\\\-1.05\\end{pmatrix},\\quad\nx^{(5)}=\\begin{pmatrix}0.65\\\\-1.35\\end{pmatrix}.\n$$\n- **KDE核**：多元高斯分布。\n- **带宽矩阵**：$H=h^{2}I_{2}$，其中 $I_{2}$ 是 $2 \\times 2$ 单位矩阵。\n- **带宽参数**：$h=0.20$。这意味着 $H = (0.20)^{2} I_{2} = 0.04 \\, I_{2}$。\n\n**第2步：使用提取的给定条件进行验证**\n\n- **科学性**：该问题基于数据同化和统计估计中的标准、成熟方法，即集成卡尔曼滤波器 (EnKF) 和核密度估计 (KDE)。这些是数值天气预报及相关领域的常规工具。\n- **适定性**：该问题提供了所有必要的数据，并定义了一组清晰、有序的任务，这些任务导向一个唯一的数值解。集合成员的数量、它们的值以及KDE参数都已指定。\n- **客观性**：该问题以精确、定量的术语陈述。没有主观或模糊的元素。\n\n**第3步：结论与行动**\n\n该问题是有效的。这是在地球物理建模背景下，关于应用统计学和线性代数的一个定义明确的练习。将提供完整的解答。\n\n### 解答\n\n解答过程遵循问题陈述中列出的任务。\n\n**1. KDE后验的解析表达式**\n\n后验概率密度函数 $\\hat{p}(x)$ 通过由集合成员构建的核密度估计 (KDE) 来近似。对于等权重的高斯核，KDE是 $N$ 个高斯分布的混合模型，其中每个分量都以一个集合成员 $x^{(i)}$ 为中心。\n\nKDE的一般形式为：\n$$\n\\hat{p}(x) = \\frac{1}{N} \\sum_{i=1}^{N} K_{H}(x - x^{(i)})\n$$\n其中 $K_{H}$ 是带宽矩阵为 $H$ 的核函数。对于 $d$ 维的多元高斯核，其形式为：\n$$\nK_{H}(u) = \\frac{1}{(2\\pi)^{d/2} |H|^{1/2}} \\exp\\left(-\\frac{1}{2} u^T H^{-1} u\\right)\n$$\n在这个问题中，$d=2$，$N=5$，且 $H = 0.04 \\, I_{2}$。我们有：\n- $H$ 的行列式：$|H| = |0.04 \\, I_{2}| = 0.04^2 = 0.0016$。因此，$|H|^{1/2} = 0.04$。\n- $H$ 的逆矩阵：$H^{-1} = (0.04 \\, I_{2})^{-1} = \\frac{1}{0.04} I_{2} = 25 \\, I_{2}$。\n\n将这些代入核表达式中，KDE后验的解析表达式为：\n$$\n\\hat{p}(x) = \\frac{1}{5} \\sum_{i=1}^{5} \\frac{1}{(2\\pi)^{2/2} (0.04)} \\exp\\left(-\\frac{1}{2} (x - x^{(i)})^T (25 \\, I_{2}) (x - x^{(i)})\\right)\n$$\n$$\n\\hat{p}(x) = \\frac{1}{5 \\cdot 2\\pi \\cdot 0.04} \\sum_{i=1}^{5} \\exp\\left(-\\frac{25}{2} \\|x - x^{(i)}\\|^2\\right)\n$$\n$$\n\\hat{p}(x) = \\frac{1}{0.4\\pi} \\sum_{i=1}^{5} \\exp\\left(-12.5 \\|x - x^{(i)}\\|^2\\right)\n$$\n\n**2. KDE后验的均值和协方差**\n\n我们推导具有概率密度 $\\hat{p}(x)$ 的随机向量 $X$ 的均值和协方差。这是一个混合分布。我们可以将 $X$ 的抽样过程看作一个两阶段过程：首先，以均匀概率 $P(I=i) = 1/N$ 选择一个索引 $I \\in \\{1, 2, 3, 4, 5\\}$；其次，从高斯分布 $\\mathcal{N}(x^{(i)}, H)$ 中抽取 $X$。\n\n使用全期望定律计算均值 $\\mu_{KDE}$：\n$$\n\\mu_{KDE} = E[X] = E_I[E[X|I]]\n$$\n条件期望 $E[X|I=i]$ 是第 $i$ 个高斯分量的均值，即 $x^{(i)}$。因此：\n$$\n\\mu_{KDE} = E_I[x^{(I)}] = \\sum_{i=1}^{N} P(I=i) x^{(i)} = \\frac{1}{N} \\sum_{i=1}^{N} x^{(i)}\n$$\nKDE后验的均值是集合的样本均值，我们记为 $\\bar{x}$。\n\n使用全协方差定律计算协方差 $P_{KDE}$：\n$$\nP_{KDE} = \\text{Cov}(X) = E_I[\\text{Cov}(X|I)] + \\text{Cov}_I(E[X|I])\n$$\n条件协方差 $\\text{Cov}(X|I=i)$ 是第 $i$ 个高斯分量的协方差，即带宽矩阵 $H$。这对所有 $i$ 都是常数。所以，第一项是：\n$$\nE_I[\\text{Cov}(X|I)] = E_I[H] = H\n$$\n第二项是条件期望 $E[X|I]=x^{(I)}$ 的协方差：\n$$\n\\text{Cov}_I(E[X|I]) = \\text{Cov}_I(x^{(I)}) = E_I[(x^{(I)} - E_I[x^{(I)}])(x^{(I)} - E_I[x^{(I)}])^T]\n$$\n由于 $E_I[x^{(I)}] = \\bar{x}$，这变为：\n$$\n\\text{Cov}_I(x^{(I)}) = \\frac{1}{N} \\sum_{i=1}^{N} (x^{(i)} - \\bar{x})(x^{(i)} - \\bar{x})^T\n$$\n这是集合的有偏样本协方差。我们称之为 $P_{\\text{biased}}$。\n合并各项，KDE后验的协方差为：\n$$\nP_{KDE} = H + \\frac{1}{N} \\sum_{i=1}^{N} (x^{(i)} - \\bar{x})(x^{(i)} - \\bar{x})^T = H + P_{\\text{biased}}\n$$\n\n**3. 数值计算**\n\n首先，我们计算样本均值 $\\bar{x}$：\n$$\n\\sum_{i=1}^{5} x^{(i)} = \\begin{pmatrix}0.80+1.10+0.50+0.95+0.65\\\\-1.20-0.90-1.50-1.05-1.35\\end{pmatrix} = \\begin{pmatrix}4.00\\\\-6.00\\end{pmatrix}\n$$\n$$\n\\bar{x} = \\frac{1}{5} \\begin{pmatrix}4.00\\\\-6.00\\end{pmatrix} = \\begin{pmatrix}0.80\\\\-1.20\\end{pmatrix}\n$$\nKDE后验的均值为 $\\mu_{KDE} = \\bar{x} = \\begin{pmatrix}0.80\\\\-1.20\\end{pmatrix}$。\n\n接下来，我们计算与均值的偏差，$d^{(i)} = x^{(i)} - \\bar{x}$：\n$$\nd^{(1)} = \\begin{pmatrix}0\\\\0\\end{pmatrix}, \\quad d^{(2)} = \\begin{pmatrix}0.30\\\\0.30\\end{pmatrix}, \\quad d^{(3)} = \\begin{pmatrix}-0.30\\\\-0.30\\end{pmatrix}, \\quad d^{(4)} = \\begin{pmatrix}0.15\\\\0.15\\end{pmatrix}, \\quad d^{(5)} = \\begin{pmatrix}-0.15\\\\-0.15\\end{pmatrix}\n$$\n现在，我们计算偏差外积的和，$\\sum_{i=1}^{N} (x^{(i)} - \\bar{x})(x^{(i)} - \\bar{x})^T = \\sum_{i=1}^{5} d^{(i)}(d^{(i)})^T$：\n$$\n\\sum_{i=1}^{5} d^{(i)}(d^{(i)})^T = \\begin{pmatrix}0\\\\0\\end{pmatrix}\\begin{pmatrix}00\\end{pmatrix} + \\begin{pmatrix}0.3\\\\0.3\\end{pmatrix}\\begin{pmatrix}0.30.3\\end{pmatrix} + \\begin{pmatrix}-0.3\\\\-0.3\\end{pmatrix}\\begin{pmatrix}-0.3-0.3\\end{pmatrix} + \\begin{pmatrix}0.15\\\\0.15\\end{pmatrix}\\begin{pmatrix}0.150.15\\end{pmatrix} + \\begin{pmatrix}-0.15\\\\-0.15\\end{pmatrix}\\begin{pmatrix}-0.15-0.15\\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix}00\\\\00\\end{pmatrix} + \\begin{pmatrix}0.090.09\\\\0.090.09\\end{pmatrix} + \\begin{pmatrix}0.090.09\\\\0.090.09\\end{pmatrix} + \\begin{pmatrix}0.02250.0225\\\\0.02250.0225\\end{pmatrix} + \\begin{pmatrix}0.02250.0225\\\\0.02250.0225\\end{pmatrix}\n$$\n$$\n\\sum_{i=1}^{5} d^{(i)}(d^{(i)})^T = \\begin{pmatrix}0.09+0.09+0.0225+0.0225  0.09+0.09+0.0225+0.0225 \\\\ 0.09+0.09+0.0225+0.0225  0.09+0.09+0.0225+0.0225\\end{pmatrix} = \\begin{pmatrix}0.225  0.225 \\\\ 0.225  0.225\\end{pmatrix}\n$$\nEnKF使用的无偏样本协方差是：\n$$\nP_{EnKF} = \\frac{1}{N-1} \\sum_{i=1}^{N} (x^{(i)} - \\bar{x})(x^{(i)} - \\bar{x})^T = \\frac{1}{4} \\begin{pmatrix}0.225  0.225 \\\\ 0.225  0.225\\end{pmatrix} = \\begin{pmatrix}0.05625  0.05625 \\\\ 0.05625  0.05625\\end{pmatrix}\n$$\n有偏样本协方差是：\n$$\nP_{\\text{biased}} = \\frac{1}{N} \\sum_{i=1}^{N} (x^{(i)} - \\bar{x})(x^{(i)} - \\bar{x})^T = \\frac{1}{5} \\begin{pmatrix}0.225  0.225 \\\\ 0.225  0.225\\end{pmatrix} = \\begin{pmatrix}0.045  0.045 \\\\ 0.045  0.045\\end{pmatrix}\n$$\nKDE协方差计算为 $P_{KDE} = H + P_{\\text{biased}}$：\n$$H = \\begin{pmatrix}0.04  0 \\\\ 0  0.04\\end{pmatrix}$$\n$$\nP_{KDE} = \\begin{pmatrix}0.04  0 \\\\ 0  0.04\\end{pmatrix} + \\begin{pmatrix}0.045  0.045 \\\\ 0.045  0.045\\end{pmatrix} = \\begin{pmatrix}0.085  0.045 \\\\ 0.045  0.085\\end{pmatrix}\n$$\n\n**4. 弗罗贝尼乌斯范数计算**\n\n我们需要计算差分矩阵 $\\Delta P = P_{KDE} - P_{EnKF}$ 的弗罗贝尼乌斯范数。\n$$\n\\Delta P = \\begin{pmatrix}0.085  0.045 \\\\ 0.045  0.085\\end{pmatrix} - \\begin{pmatrix}0.05625  0.05625 \\\\ 0.05625  0.05625\\end{pmatrix}\n$$\n$$\n\\Delta P = \\begin{pmatrix}0.085 - 0.05625  0.045 - 0.05625 \\\\ 0.045 - 0.05625  0.085 - 0.05625\\end{pmatrix} = \\begin{pmatrix}0.02875  -0.01125 \\\\ -0.01125  0.02875\\end{pmatrix}\n$$\n弗罗贝尼乌斯范数 $\\|\\Delta P\\|_F$ 是其元素平方和的平方根：\n$$\n\\|\\Delta P\\|_F = \\sqrt{(0.02875)^2 + (-0.01125)^2 + (-0.01125)^2 + (0.02875)^2}\n$$\n$$\n\\|\\Delta P\\|_F = \\sqrt{2 \\times (0.02875)^2 + 2 \\times (-0.01125)^2}\n$$\n$$\n\\|\\Delta P\\|_F = \\sqrt{2 \\times (0.0008265625) + 2 \\times (0.0001265625)}\n$$\n$$\n\\|\\Delta P\\|_F = \\sqrt{0.001653125 + 0.000253125}\n$$\n$$\n\\|\\Delta P\\|_F = \\sqrt{0.00190625}\n$$\n$$\n\\|\\Delta P\\|_F \\approx 0.04365856\n$$\n四舍五入到四位有效数字，结果是 $0.04366$。",
            "answer": "$$\\boxed{0.04366}$$"
        },
        {
            "introduction": "在集合资料同化中，一个核心挑战是如何更新集合成员，使其样本协方差与理论上的后验协方差相匹配。随机EnKF通过扰动观测来实现这一点，但这会引入额外的采样误差。确定性“平方根”滤波器通过一个巧妙的变换矩阵来避免这个问题。本练习将引导你推导出这个关键的变换矩阵，揭示现代确定性集合平滑器更新步骤背后的数学原理。",
            "id": "4037861",
            "problem": "在代表数值天气预报和气候模拟的单个线性高斯数据同化步骤中，考虑一个维度为 $n$ 的状态向量和一个大小为 $m>1$ 的预报集合。设预报集合异常矩阵为 $A^{f} \\in \\mathbb{R}^{n \\times m}$，其列之和为零，预报误差协方差为 $P^{f} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}$。观测遵循线性模型 $y = H x + \\varepsilon$，其中观测算子为 $H \\in \\mathbb{R}^{p \\times n}$，观测误差为 $\\varepsilon \\sim \\mathcal{N}(0,R)$，其协方差矩阵 $R \\in \\mathbb{R}^{p \\times p}$ 是对称正定的。此线性高斯系统的卡尔曼滤波器分析协方差为 $P^{a} = P^{f} - P^{f} H^{\\mathsf{T}} \\left(H P^{f} H^{\\mathsf{T}} + R\\right)^{-1} H P^{f}$。\n\n比较扰动观测的随机集合卡尔曼滤波器（EnKF）与避免扰动观测的确定性平方根EnKF。然后，仅使用上述定义和线性高斯系统卡尔曼滤波器的基本性质，构建一个确定性的集合空间转换矩阵 $T \\in \\mathbb{R}^{m \\times m}$，使得分析异常 $A^{a} = A^{f} T$ 满足 $\\frac{1}{m-1} A^{a} (A^{a})^{\\mathsf{T}} = P^{a}$，且无需扰动观测。您的构建必须以 $H$、$R$、$A^{f}$ 和 $m$ 的闭合形式明确给出。\n\n将集合投影的观测异常定义为 $Y^{f} = H A^{f} \\in \\mathbb{R}^{p \\times m}$，并仅用 $Y^{f}$、$R$ 和 $m$ 来表示您关于 $T$ 的最终答案。最终答案必须是 $T$ 的单个闭合形式解析表达式。不需要进行数值计算。如果需要，您可以使用对称正定矩阵的平方根表示法。请将最终答案表示为单个解析矩阵表达式。不需要单位。",
            "solution": "在尝试求解之前，首先对问题进行严格验证。\n\n### 步骤 1：提取已知条件\n- 状态向量维度：$n$\n- 集合大小：$m > 1$\n- 预报集合异常矩阵：$A^{f} \\in \\mathbb{R}^{n \\times m}$，其列之和为零。\n- 预报误差协方差：$P^{f} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}$\n- 观测模型：$y = H x + \\varepsilon$\n- 观测算子：$H \\in \\mathbb{R}^{p \\times n}$\n- 观测误差：$\\varepsilon \\sim \\mathcal{N}(0,R)$\n- 观测误差协方差矩阵：$R \\in \\mathbb{R}^{p \\times p}$，对称正定。\n- 卡尔曼滤波器分析协方差：$P^{a} = P^{f} - P^{f} H^{\\mathsf{T}} \\left(H P^{f} H^{\\mathsf{T}} + R\\right)^{-1} H P^{f}$\n- 分析集合异常：$A^{a} = A^{f} T$，其中 $T \\in \\mathbb{R}^{m \\times m}$ 是待求的转换矩阵。\n- 需满足的条件：$\\frac{1}{m-1} A^{a} (A^{a})^{\\mathsf{T}} = P^{a}$\n- 集合投影的观测异常的定义：$Y^{f} = H A^{f} \\in \\mathbb{R}^{p \\times m}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了集合数据同化理论中的一个核心推导，特别是关于确定性平方根集合卡尔曼滤波器（EnKFs）。所提供的预报和分析协方差方程是线性高斯估计理论中的标准方程。该问题是适定的、客观的且自洽的，提供了构建矩阵 $T$ 所需的所有必要定义。其中没有矛盾、歧义或事实错误。该问题是应用于数值天气预报和气候模拟的矩阵代数中一个可形式化且相关的练习。\n\n### 步骤 3：结论与行动\n问题有效。将构建一个解。\n\n### 求解推导\n目标是找到一个确定性转换矩阵 $T \\in \\mathbb{R}^{m \\times m}$，使得定义为 $A^{a} = A^{f} T$ 的分析集合异常的样本协方差与卡尔曼滤波器的理论分析误差协方差 $P^{a}$ 相匹配。\n\n分析集合的样本协方差由下式给出：\n$$\n\\frac{1}{m-1} A^{a} (A^{a})^{\\mathsf{T}} = \\frac{1}{m-1} (A^{f} T) (A^{f} T)^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}}\n$$\n我们必须将其等同于卡尔曼分析协方差 $P^{a}$：\n$$\n\\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}} = P^{a}\n$$\n代入给定的 $P^{a}$ 表达式：\n$$\n\\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}} = P^{f} - P^{f} H^{\\mathsf{T}} \\left(H P^{f} H^{\\mathsf{T}} + R\\right)^{-1} H P^{f}\n$$\n现在，将预报误差协方差的定义 $P^{f} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}$ 代入此方程。\n$$\n\\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}} - \\left(\\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}\\right) H^{\\mathsf{T}} \\left(H \\left(\\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}\\right) H^{\\mathsf{T}} + R\\right)^{-1} H \\left(\\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}}\\right)\n$$\n我们可以使用定义 $Y^{f} = H A^{f}$。这意味着 $H P^{f} H^{\\mathsf{T}} = \\frac{1}{m-1} H A^{f} (A^{f})^{\\mathsf{T}} H^{\\mathsf{T}} = \\frac{1}{m-1} (H A^{f}) (H A^{f})^{\\mathsf{T}} = \\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}}$。同时，$P^{f} H^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}} H^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} (H A^{f})^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} (Y^{f})^{\\mathsf{T}}$。\n\n将这些代入 $P^{a}$ 的方程中：\n$$\n\\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} (A^{f})^{\\mathsf{T}} - \\left(\\frac{1}{m-1} A^{f} (Y^{f})^{\\mathsf{T}}\\right) \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} \\left(\\frac{1}{m-1} (Y^{f}) (A^{f})^{\\mathsf{T}}\\right)\n$$\n在右侧的左边提出 $A^{f}$，右边提出 $(A^{f})^{\\mathsf{T}}$，得到：\n$$\n\\frac{1}{m-1} A^{f} T T^{\\mathsf{T}} (A^{f})^{\\mathsf{T}} = \\frac{1}{m-1} A^{f} \\left( I_m - \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f} \\right) (A^{f})^{\\mathsf{T}}\n$$\n其中 $I_m$ 是 $m \\times m$ 的单位矩阵。通过比较两侧 $A^{f}$ 和 $(A^{f})^{\\mathsf{T}}$ 之间的项，我们确定 $T T^{\\mathsf{T}}$ 的表达式：\n$$\nT T^{\\mathsf{T}} = I_m - \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f}\n$$\n此表达式可以使用 Woodbury 矩阵恒等式进行简化，该恒等式表明 $(A+UCV)^{-1} = A^{-1} - A^{-1}U(C^{-1}+VA^{-1}U)^{-1}VA^{-1}$。对此问题而言，一个更方便的形式是证明一个相关矩阵的逆具有更简单的形式。我们假设 $T T^{\\mathsf{T}}$ 的逆是 $I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f}$。我们通过乘法来验证这一点：\n$$\n\\left( I_m - \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f} \\right) \\left( I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f} \\right)\n$$\n让我们展开这个乘积：\n$$\n= I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f} - \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f} - \\frac{1}{(m-1)^2} (Y^{f})^{\\mathsf{T}} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f}\n$$\n提出 $(Y^{f})^{\\mathsf{T}}$ 和 $Y^{f}$：\n$$\n= I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} \\left[ R^{-1} - \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} - \\frac{1}{m-1} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} Y^{f} (Y^{f})^{\\mathsf{T}} R^{-1} \\right] Y^{f}\n$$\n关注方括号中的项。提出公共的逆矩阵：\n$$\n= R^{-1} - \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} \\left( I_p + \\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} R^{-1} \\right)\n$$\n其中 $I_p$ 是 $p \\times p$ 的单位矩阵。我们可以将最后一个括号重写为：\n$$\nI_p + \\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} R^{-1} = \\left(R + \\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}}\\right) R^{-1}\n$$\n将此代回括号内的表达式：\n$$\nR^{-1} - \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right)^{-1} \\left(\\frac{1}{m-1} Y^{f} (Y^{f})^{\\mathsf{T}} + R\\right) R^{-1} = R^{-1} - I_p R^{-1} = R^{-1} - R^{-1} = 0\n$$\n由于方括号中的项为零，整个乘积简化为 $I_m$。这证明了：\n$$\n(T T^{\\mathsf{T}})^{-1} = I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f}\n$$\n因此：\n$$\nT T^{\\mathsf{T}} = \\left( I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f} \\right)^{-1}\n$$\n问题要求构建一个确定性矩阵 $T$。在平方根滤波器中，对于此类矩阵，一个常见且稳定的选择是 $T T^{\\mathsf{T}}$ 的对称正定平方根。我们定义矩阵 $S = I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f}$。由于 $R$ 是对称正定的，$R^{-1}$ 也是，因此 $(Y^{f})^{\\mathsf{T}} R^{-1} Y^{f}$ 是对称半正定的。所以，$S$ 是一个对称正定矩阵。因此，它存在唯一的对称正定平方根，记为 $S^{1/2}$。\n\n我们选择 $T$ 为对称矩阵 $T = (S^{-1})^{1/2} = S^{-1/2}$。这个选择使得 $T T^{\\mathsf{T}} = T^2 = S^{-1}$，满足条件。问题陈述明确允许使用对称正定矩阵的平方根表示法。\n\n$T$ 的最终表达式因此是矩阵 $S$ 的逆对称平方根。\n\n$$\nT = \\left( I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f} \\right)^{-1/2}\n$$\n此表达式是闭合形式，并且只依赖于 $Y^{f}$、$R$ 和 $m$，符合要求。",
            "answer": "$$\\boxed{\\left( I_m + \\frac{1}{m-1} (Y^{f})^{\\mathsf{T}} R^{-1} Y^{f} \\right)^{-1/2}}$$"
        },
        {
            "introduction": "对于任何平滑器而言，同化窗口的长度是一个关键的超参数。在如大气这样的混沌系统中，由于误差的指数级增长，来自遥远未来的观测信息对于当前状态估计的价值会迅速衰减。这个练习将展示如何利用系统的最大李雅普诺夫指数——一个衡量其混沌程度的指标——来确定一个最优的平滑窗口长度，从而将抽象的动力系统理论与资料同化的实际应用直接联系起来。",
            "id": "4037882",
            "problem": "考虑一个用于数值天气预报和气候建模的离散时间混沌动力系统。假设系统沿一条轨迹线性化，使得扰动根据一个切向传播算子演化，该算子具有一个主李雅普诺夫指数 $\\lambda_{1}  0$。这意味着在时间索引 $k$ 处的一个小扰动 $\\delta \\mathbf{x}_{k}$ 平均而言会按 $\\|\\delta \\mathbf{x}_{k+\\tau}\\| \\approx \\mathrm{e}^{\\lambda_{1} \\tau} \\|\\delta \\mathbf{x}_{k}\\|$ 增长，其中延迟 $\\tau \\in \\mathbb{N}$。假设在每个整数时间步长，都有与主不稳定子空间对齐的标量观测可用，这些观测带有方差为 $R  0$ 的独立高斯噪声，并且过程噪声足够小，以至于在所考虑的窗口内，线性化是有效的。考虑在一个长度为整数 $T \\in \\mathbb{N}$ 时间步长的同化窗口上应用的固定区间集合平滑器或粒子平滑器。\n\n从一个基本出发点开始：在线性高斯设置中，固定区间平滑可以用信息形式表示，其中关于初始状态沿某一给定模式累积的总信息（方差的倒数）是来自未来观测贡献的总和，每个贡献与该观测对初始状态的后向敏感性的平方成正比，与观测噪声方差成反比。利用主李雅普诺夫指数 $\\lambda_{1}$ 的定义，以及主不稳定子空间上的后向敏感性由于不稳定增长的时间反演而随延迟呈几何衰减的事实，推导由长度为 $T$ 的窗口捕获的总信息对 $\\lambda_{1}$ 的依赖关系，并证明来自超过 $T$ 的延迟的缺失信息随 $T$ 指数衰减。\n\n基于容差参数 $\\varepsilon \\in (0,1)$ 定义一个选择 $T$ 的严格准则，使得窗口未捕获的渐近信息的分数最多为 $\\varepsilon$。根据 $\\lambda_{1}$ 和 $\\varepsilon$ 推导满足此准则的最小整数 $T^{\\star}$ 的显式表达式。然后，对于下面指定的每个测试用例，计算：\n- 推荐的窗口长度 $T^{\\star}$，以离散时间步长为单位（无量纲）。\n- 此窗口实际捕获的渐近平滑信息的分数，记为 $F(T^{\\star}) \\in (0,1)$，四舍五入到至少六位小数。\n\n假设所有时间都以离散模型时间步长为单位进行测量，并将 $T^{\\star}$ 报告为非负整数，$F(T^{\\star})$ 报告为 $[0,1)$ 内的浮点数。\n\n测试套件（每个用例是一个元组 $(\\lambda_{1}, \\varepsilon, T_{\\max})$，其中 $T_{\\max}$ 是允许的窗口长度的上限；如果推导出的 $T^{\\star}$ 超过 $T_{\\max}$，则使用 $T^{\\star} = T_{\\max}$ 并仍然报告相应的 $F(T^{\\star})$）：\n- 用例 1: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.5, 0.01, 100)$。\n- 用例 2: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.1, 0.001, 250)$。\n- 用例 3: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (1.0, 0.1, 20)$。\n- 用例 4: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.02, 0.001, 300)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序如下：\n$[T^{\\star}_{1}, F(T^{\\star}_{1}), T^{\\star}_{2}, F(T^{\\star}_{2}), T^{\\star}_{3}, F(T^{\\star}_{3}), T^{\\star}_{4}, F(T^{\\star}_{4})]$,\n其中下标表示从 $1$ 到 $4$ 的用例索引。\n\n该问题完全是数学问题，除了上述离散时间步长规范外，不需要任何物理单位。不涉及角度。所有输出必须是指定类型：$T^{\\star}$ 为整数，$F(T^{\\star})$ 为浮点数。",
            "solution": "该问题要求基于系统的主李雅普诺夫指数 $\\lambda_{1}$ 和指定的信息容差 $\\varepsilon$，为固定区间平滑器推导一个最优的同化窗口长度 $T^{\\star}$。\n\n该分析的基础在于线性高斯背景下卡尔曼平滑的信息论视角。关于系统初始状态所获得的总信息是同化窗口内每个观测的信息贡献之和。我们关心的是与最不稳定方向对齐的状态分量，它根据主李雅普诺夫指数 $\\lambda_{1} > 0$ 增长。\n\n设系统在离散时间步长 $k=1, 2, 3, \\dots$ 被观测。问题陈述指出，来自一次观测的信息贡献与后向敏感性的平方成正比。在此背景下，“后向敏感性”一词指的是未来时间 $k$ 的一次观测对初始时间（比如 $t=0$）的状态估计的影响。在混沌系统中，前向动力学是不稳定的，其特征是正的李雅普诺夫指数 $\\lambda_1$。在时间 $0$ 的一个小扰动 $\\delta \\mathbf{x}_0$ 会按 $\\|\\delta\\mathbf{x}_k\\| \\approx e^{\\lambda_1 k} \\|\\delta\\mathbf{x}_0\\|$ 增长。\n\n反过来，时间 $k$ 的一次观测对时间 $0$ 的状态估计的影响必须随着 $k$ 的增加而衰减。这是因为，当在时间上回溯时，稳定的动力学对应于不稳定的前向动力学。时间 $k$ 的新息（观测减去预测）对时间 $0$ 的平滑估计的影响与 $\\mathrm{e}^{-\\lambda_{1} k}$ 成比例衰减。这是前向预测误差协方差演化和后向平滑增益传播之间对偶性的直接结果。\n\n所获得的信息，等同于方差的减少，与该影响的平方成正比。因此，在延迟 $k$（即时间步长 $k$）的一次观测对时间 $0$ 的状态贡献的信息可以建模为：\n$$ I_k = C \\cdot \\left(\\mathrm{e}^{-\\lambda_{1} k}\\right)^2 = C \\cdot \\mathrm{e}^{-2\\lambda_{1} k} $$\n其中 $C$ 是一个比例常数，它取决于观测算子和观测误差方差 $R$，但与延迟 $k$ 无关。\n\n长度为 $T$ 的平滑窗口捕获的总信息是来自延迟 $k=1, 2, \\dots, T$ 的观测贡献之和：\n$$ I_{\\text{total}}(T) = \\sum_{k=1}^{T} I_k = C \\sum_{k=1}^{T} \\mathrm{e}^{-2\\lambda_{1} k} $$\n\n渐近信息是从无限长窗口（$T \\to \\infty$）可以获得的总信息：\n$$ I_{\\text{asymptotic}} = \\sum_{k=1}^{\\infty} I_k = C \\sum_{k=1}^{\\infty} \\mathrm{e}^{-2\\lambda_{1} k} $$\n这是一个首项为 $a = C \\mathrm{e}^{-2\\lambda_{1}}$、公比为 $r = \\mathrm{e}^{-2\\lambda_{1}}$ 的几何级数。由于 $\\lambda_1 > 0$，我们有 $0  r  1$，级数收敛于：\n$$ I_{\\text{asymptotic}} = C \\frac{\\mathrm{e}^{-2\\lambda_{1}}}{1 - \\mathrm{e}^{-2\\lambda_{1}}} $$\n\n长度为 $T$ 的窗口 *未* 捕获的信息（“缺失信息”）包括来自所有超过延迟 $T$ 的观测的贡献：\n$$ I_{\\text{missing}}(T) = \\sum_{k=T+1}^{\\infty} I_k = C \\sum_{k=T+1}^{\\infty} (\\mathrm{e}^{-2\\lambda_{1}})^k $$\n这也是一个几何级数，首项为 $C \\mathrm{e}^{-2\\lambda_{1}(T+1)}$。其和为：\n$$ I_{\\text{missing}}(T) = C \\frac{\\mathrm{e}^{-2\\lambda_{1}(T+1)}}{1 - \\mathrm{e}^{-2\\lambda_{1}}} $$\n可以看出，$I_{\\text{missing}}(T)$ 与 $\\mathrm{e}^{-2\\lambda_{1}T}$ 成正比，表明缺失信息随窗口长度 $T$呈指数衰减。\n\n问题定义了一个基于所错失的渐近信息分数的准则。这个分数是：\n$$ \\frac{I_{\\text{missing}}(T)}{I_{\\text{asymptotic}}} = \\frac{C \\frac{\\mathrm{e}^{-2\\lambda_{1}(T+1)}}{1 - \\mathrm{e}^{-2\\lambda_{1}}}}{C \\frac{\\mathrm{e}^{-2\\lambda_{1}}}{1 - \\mathrm{e}^{-2\\lambda_{1}}}} = \\frac{\\mathrm{e}^{-2\\lambda_{1}(T+1)}}{\\mathrm{e}^{-2\\lambda_{1}}} = \\mathrm{e}^{-2\\lambda_{1}T} $$\n该准则要求此分数最多为 $\\varepsilon$，其中 $\\varepsilon \\in (0,1)$ 是给定的容差：\n$$ \\mathrm{e}^{-2\\lambda_{1}T} \\le \\varepsilon $$\n为了找到满足此条件的最小窗口长度 $T$，我们解这个关于 $T$ 的不等式。对两边取自然对数：\n$$ -2\\lambda_{1}T \\le \\ln(\\varepsilon) $$\n由于 $\\lambda_1 > 0$，除以 $-2\\lambda_1$ 会反转不等号：\n$$ T \\ge -\\frac{\\ln(\\varepsilon)}{2\\lambda_{1}} = \\frac{\\ln(1/\\varepsilon)}{2\\lambda_{1}} $$\n满足此条件的最小整数窗口长度 $T$，我们记为 $T^{\\star}_{\\text{derived}}$，是右侧表达式的上取整：\n$$ T^{\\star}_{\\text{derived}} = \\left\\lceil \\frac{\\ln(1/\\varepsilon)}{2\\lambda_{1}} \\right\\rceil $$\n问题进一步对窗口长度施加了上限 $T_{\\max}$。因此，最终推荐的窗口长度 $T^{\\star}$ 是：\n$$ T^{\\star} = \\min\\left(T^{\\star}_{\\text{derived}}, T_{\\max}\\right) $$\n由这个长度为 $T^{\\star}$ 的窗口实际捕获的渐近信息的分数，记为 $F(T^{\\star})$，由下式给出：\n$$ F(T^{\\star}) = 1 - \\frac{I_{\\text{missing}}(T^{\\star})}{I_{\\text{asymptotic}}} = 1 - \\mathrm{e}^{-2\\lambda_{1}T^{\\star}} $$\n我们现在将这些推导出的公式应用于指定的测试用例。\n\n用例 1: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.5, 0.01, 100)$\n$T^{\\star}_{\\text{derived}} = \\lceil \\frac{\\ln(1/0.01)}{2 \\times 0.5} \\rceil = \\lceil \\ln(100) \\rceil = \\lceil 4.605...\\rceil = 5$。\n$T^{\\star} = \\min(5, 100) = 5$。\n$F(5) = 1 - \\mathrm{e}^{-2 \\times 0.5 \\times 5} = 1 - \\mathrm{e}^{-5} \\approx 0.993262$。\n\n用例 2: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.1, 0.001, 250)$\n$T^{\\star}_{\\text{derived}} = \\lceil \\frac{\\ln(1/0.001)}{2 \\times 0.1} \\rceil = \\lceil \\frac{\\ln(1000)}{0.2} \\rceil = \\lceil 34.538...\\rceil = 35$。\n$T^{\\star} = \\min(35, 250) = 35$。\n$F(35) = 1 - \\mathrm{e}^{-2 \\times 0.1 \\times 35} = 1 - \\mathrm{e}^{-7} \\approx 0.999088$。\n\n用例 3: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (1.0, 0.1, 20)$\n$T^{\\star}_{\\text{derived}} = \\lceil \\frac{\\ln(1/0.1)}{2 \\times 1.0} \\rceil = \\lceil \\frac{\\ln(10)}{2} \\rceil = \\lceil 1.151...\\rceil = 2$。\n$T^{\\star} = \\min(2, 20) = 2$。\n$F(2) = 1 - \\mathrm{e}^{-2 \\times 1.0 \\times 2} = 1 - \\mathrm{e}^{-4} \\approx 0.981684$。\n\n用例 4: $(\\lambda_{1}, \\varepsilon, T_{\\max}) = (0.02, 0.001, 300)$\n$T^{\\star}_{\\text{derived}} = \\lceil \\frac{\\ln(1/0.001)}{2 \\times 0.02} \\rceil = \\lceil \\frac{\\ln(1000)}{0.04} \\rceil = \\lceil 172.693...\\rceil = 173$。\n$T^{\\star} = \\min(173, 300) = 173$。\n$F(173) = 1 - \\mathrm{e}^{-2 \\times 0.02 \\times 173} = 1 - \\mathrm{e}^{-6.92} \\approx 0.999012$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the recommended smoother window length T_star and the \n    corresponding fraction of captured information F(T_star) for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (lambda_1, epsilon, T_max).\n    test_cases = [\n        (0.5, 0.01, 100),\n        (0.1, 0.001, 250),\n        (1.0, 0.1, 20),\n        (0.02, 0.001, 300),\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_1, epsilon, T_max = case\n\n        # The fraction of missing information for a window of length T is exp(-2 * lambda_1 * T).\n        # We want this to be = epsilon.\n        # exp(-2 * lambda_1 * T) = epsilon\n        # -2 * lambda_1 * T = log(epsilon)\n        # T = -log(epsilon) / (2 * lambda_1)\n        # T = log(1/epsilon) / (2 * lambda_1)\n        \n        # Calculate the theoretical minimum T to satisfy the criterion.\n        # Since T must be an integer number of time steps, we take the ceiling.\n        T_star_derived = np.ceil(np.log(1.0 / epsilon) / (2.0 * lambda_1))\n\n        # The final T_star is the minimum of the derived value and the specified maximum T_max.\n        # The result must be an integer.\n        T_star = int(min(T_star_derived, T_max))\n\n        # Calculate the fraction of information actually captured by this window length T_star.\n        # F(T) = 1 - (fraction of missing information)\n        F_T_star = 1.0 - np.exp(-2.0 * lambda_1 * T_star)\n        \n        results.append(T_star)\n        results.append(F_T_star)\n\n    # Format the results into a single comma-separated string as required.\n    # The default string conversion for floats provides sufficient precision.\n    output_string = \",\".join(map(str, results))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{output_string}]\")\n\nsolve()\n```"
        }
    ]
}