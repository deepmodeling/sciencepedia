{
    "hands_on_practices": [
        {
            "introduction": "这个练习提供了一个具体的、简化的变分数据同化工作原理的例子。它探讨了单个观测如何更新一个二维状态向量。通过亲手计算分析增量（$\\delta\\mathbf{x}$），您将深入理解背景信息（由 $\\mathbf{B}$ 代表）和观测信息（由 $\\mathbf{R}$ 和 $\\mathbf{K}$ 代表）是如何被最优地融合，从而生成一个新的、更准确的大气状态 。",
            "id": "4012633",
            "problem": "在一个用于数值天气预报（NWP）的线性化变分资料同化设定中，考虑将一个经过偏差订正的卫星辐射通道同化到一个二维控制空间中。控制向量 $\\mathbf{x}$ 代表两个归一化、无量纲的控制变量。背景误差协方差矩阵 $\\mathbf{B}$、观测误差协方差 $\\mathbf{R}$（对于单个通道是一个标量），以及线性化观测算子雅可比矩阵（常称为权重函数或雅可比）$\\mathbf{K}$ 被指定为\n$$\n\\mathbf{B} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \n\\qquad \n\\mathbf{R} = 2,\n\\qquad \n\\mathbf{K} = \\begin{pmatrix} 1 & 2 \\end{pmatrix}.\n$$\n令新息（观测值减去背景场对应的模式模拟值）为标量\n$$\nd = y - H(\\mathbf{x_b}) = 3.\n$$\n假设一个标准的线性高斯设定，误差无偏，其中分析场是通过最小化包含背景项和观测项的二次贝叶斯代价函数得到的，并且前向算子在背景场附近的线性化产生 $H(\\mathbf{x_b} + \\delta \\mathbf{x}) \\approx H(\\mathbf{x_b}) + \\mathbf{K}\\,\\delta \\mathbf{x}$。\n\n从这些基础出发，推导分析增量 $\\delta \\mathbf{x}$ 和分析残差 $r_a = y - H(\\mathbf{x_a})$（其中 $\\mathbf{x_a} = \\mathbf{x_b} + \\delta \\mathbf{x}$）的闭合形式表达式。然后计算它们在给定的 $\\mathbf{B}$、$\\mathbf{R}$、$\\mathbf{K}$ 和 $d$ 下的数值。\n\n所有变量在构造上都是无量纲的；不需要物理单位。将最终数值答案以一个单行矩阵的形式给出，该矩阵按顺序包含 $\\delta \\mathbf{x}$ 的两个分量以及残差 $r_a$。不需要四舍五入；给出精确值。",
            "solution": "该问题是有效的，因为它代表了变分资料同化中一个标准的、适定的问题，所有必要组成部分都得到了统一定义。\n\n分析场是通过最小化一个二次代价函数 $J$ 来确定的，该函数衡量了分析状态与背景状态和观测值之间的失配，并由它们各自的误差协方差加权。控制变量是分析增量 $\\delta \\mathbf{x} = \\mathbf{x_a} - \\mathbf{x_b}$，其中 $\\mathbf{x_a}$ 是分析状态，$\\mathbf{x_b}$ 是背景状态。代价函数 $J(\\delta \\mathbf{x})$ 由下式给出：\n$$\nJ(\\delta \\mathbf{x}) = \\frac{1}{2} (\\delta \\mathbf{x})^T \\mathbf{B}^{-1} \\delta \\mathbf{x} + \\frac{1}{2} (y - H(\\mathbf{x_b} + \\delta \\mathbf{x}))^T \\mathbf{R}^{-1} (y - H(\\mathbf{x_b} + \\delta \\mathbf{x}))\n$$\n在线性假设下，观测算子 $H$ 可以在背景状态 $\\mathbf{x_b}$ 附近近似为 $H(\\mathbf{x_b} + \\delta \\mathbf{x}) \\approx H(\\mathbf{x_b}) + \\mathbf{K}\\delta \\mathbf{x}$，其中 $\\mathbf{K}$ 是 $H$ 在 $\\mathbf{x_b}$ 处计算的雅可比矩阵。代价函数的第二项涉及观测值 $y$ 和分析场对应的模式模拟值之间的差异，可以写成：\n$$\ny - H(\\mathbf{x_a}) \\approx y - (H(\\mathbf{x_b}) + \\mathbf{K}\\delta \\mathbf{x}) = (y - H(\\mathbf{x_b})) - \\mathbf{K}\\delta \\mathbf{x} = d - \\mathbf{K}\\delta \\mathbf{x}\n$$\n这里，$d = y - H(\\mathbf{x_b})$ 是新息向量（在本例中为标量）。代价函数变为：\n$$\nJ(\\delta \\mathbf{x}) = \\frac{1}{2} (\\delta \\mathbf{x})^T \\mathbf{B}^{-1} \\delta \\mathbf{x} + \\frac{1}{2} (d - \\mathbf{K}\\delta \\mathbf{x})^T \\mathbf{R}^{-1} (d - \\mathbf{K}\\delta \\mathbf{x})\n$$\n由于观测是单个标量值，$\\mathbf{R}$、$d$ 和 $\\mathbf{K}\\delta\\mathbf{x}$ 也都是标量。第二项中的转置可以省略。\n$$\nJ(\\delta \\mathbf{x}) = \\frac{1}{2} (\\delta \\mathbf{x})^T \\mathbf{B}^{-1} \\delta \\mathbf{x} + \\frac{1}{2} \\mathbf{R}^{-1} (d - \\mathbf{K}\\delta \\mathbf{x})^{2}\n$$\n为了找到最小化 $J$ 的分析增量 $\\delta \\mathbf{x}$，我们计算 $J$ 相对于 $\\delta \\mathbf{x}$ 的梯度并将其设为零：\n$$\n\\nabla_{\\delta\\mathbf{x}} J(\\delta \\mathbf{x}) = \\mathbf{B}^{-1} \\delta \\mathbf{x} - \\mathbf{K}^T \\mathbf{R}^{-1} (d - \\mathbf{K}\\delta \\mathbf{x}) = \\mathbf{0}\n$$\n重新整理各项以求解 $\\delta \\mathbf{x}$：\n$$\n\\mathbf{B}^{-1} \\delta \\mathbf{x} + \\mathbf{K}^T \\mathbf{R}^{-1} \\mathbf{K}\\delta \\mathbf{x} = \\mathbf{K}^T \\mathbf{R}^{-1} d\n$$\n$$\n(\\mathbf{B}^{-1} + \\mathbf{K}^T \\mathbf{R}^{-1} \\mathbf{K}) \\delta \\mathbf{x} = \\mathbf{K}^T \\mathbf{R}^{-1} d\n$$\n这导出了增量在分析空间中的解：\n$$\n\\delta \\mathbf{x} = (\\mathbf{B}^{-1} + \\mathbf{K}^T \\mathbf{R}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\mathbf{R}^{-1} d\n$$\n通过应用 Sherman-Morrison-Woodbury 公式，可以得到一个等价且通常计算上更方便的形式，称为观测空间解。\n$$\n\\delta \\mathbf{x} = \\mathbf{B} \\mathbf{K}^T (\\mathbf{R} + \\mathbf{K} \\mathbf{B} \\mathbf{K}^T)^{-1} d\n$$\n这种形式在这里特别有利，因为它需要对标量 $\\mathbf{R} + \\mathbf{K} \\mathbf{B} \\mathbf{K}^T$求逆，而不是对 $2 \\times 2$ 矩阵 $(\\mathbf{B}^{-1} + \\mathbf{K}^T \\mathbf{R}^{-1} \\mathbf{K})$ 求逆。\n\n我们现在代入给定的值：\n$$\n\\mathbf{B} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad \\mathbf{R} = 2, \\quad \\mathbf{K} = \\begin{pmatrix} 1 & 2 \\end{pmatrix}, \\quad d = 3.\n$$\n首先，我们计算项 $\\mathbf{K} \\mathbf{B} \\mathbf{K}^T$：\n$$\n\\mathbf{K}^T = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K} \\mathbf{B} = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (1)(2) + (2)(0) & (1)(0) + (2)(1) \\end{pmatrix} = \\begin{pmatrix} 2 & 2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K} \\mathbf{B} \\mathbf{K}^T = \\begin{pmatrix} 2 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (2)(1) + (2)(2) = 2 + 4 = 6\n$$\n接下来，我们计算需要求逆的标量：\n$$\n\\mathbf{R} + \\mathbf{K} \\mathbf{B} \\mathbf{K}^T = 2 + 6 = 8\n$$\n其逆就是 $(\\mathbf{R} + \\mathbf{K} \\mathbf{B} \\mathbf{K}^T)^{-1} = 8^{-1} = \\frac{1}{8}$。\n我们还需要计算项 $\\mathbf{B} \\mathbf{K}^T$：\n$$\n\\mathbf{B} \\mathbf{K}^T = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (0)(2) \\\\ (0)(1) + (1)(2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}\n$$\n现在我们组合出 $\\delta \\mathbf{x}$ 的表达式：\n$$\n\\delta \\mathbf{x} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} \\left(\\frac{1}{8}\\right) (3) = \\frac{3}{8} \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{8} \\\\ \\frac{6}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{4} \\\\ \\frac{3}{4} \\end{pmatrix}\n$$\n因此分析增量的分量是 $\\delta x_1 = \\frac{3}{4}$ 和 $\\delta x_2 = \\frac{3}{4}$。\n\n接下来，我们推导并计算分析残差 $r_a$。分析残差定义为观测值减去分析状态对应的模式模拟值，即 $r_a = y - H(\\mathbf{x_a})$。\n使用在 $\\mathbf{x_b}$ 附近的线性近似：\n$$\nr_a = y - H(\\mathbf{x_b} + \\delta\\mathbf{x}) \\approx y - (H(\\mathbf{x_b}) + \\mathbf{K}\\delta\\mathbf{x})\n$$\n$$\nr_a = (y - H(\\mathbf{x_b})) - \\mathbf{K}\\delta\\mathbf{x} = d - \\mathbf{K}\\delta\\mathbf{x}\n$$\n使用计算出的 $\\delta \\mathbf{x}$ 值：\n$$\nr_a = 3 - \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{4} \\\\ \\frac{3}{4} \\end{pmatrix} = 3 - \\left( (1)\\left(\\frac{3}{4}\\right) + (2)\\left(\\frac{3}{4}\\right) \\right)\n$$\n$$\nr_a = 3 - \\left( \\frac{3}{4} + \\frac{6}{4} \\right) = 3 - \\frac{9}{4} = \\frac{12}{4} - \\frac{9}{4} = \\frac{3}{4}\n$$\n分析残差为 $r_a = \\frac{3}{4}$。\n\n最终答案要求将 $\\delta \\mathbf{x}$ 的两个分量和残差 $r_a$ 放在一个单行矩阵中。这些值是 $\\delta x_1 = \\frac{3}{4}$、$\\delta x_2 = \\frac{3}{4}$ 和 $r_a = \\frac{3}{4}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{4} & \\frac{3}{4} & \\frac{3}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在任何数据同化系统中，观测误差协方差矩阵 $\\mathbf{R}$ 都是一个关键组成部分，它决定了赋予观测的权重。本练习不再将 $\\mathbf{R}$ 视为一个给定的数值，而是深入探究其物理来源。您将学习如何通过组合不同的误差来源——仪器噪声、正演模型误差和代表性误差——来构建 $\\mathbf{R}$ 矩阵，这将为了解我们如何在真实场景中量化卫星测量的非确定性提供至关重要的洞见 。",
            "id": "4012550",
            "problem": "在数值天气预报（NWP）和红外卫星辐射率气候数据同化的背景下，考虑对一个层平均大气温度状态 $x$（单位为 $\\mathrm{K}$）进行一维分析。从同一颗卫星上获得了关于一个含有云的非均匀场景的两个亮度温度（BT）观测通道，$y_{1}$ 和 $y_{2}$（单位均为 $\\mathrm{K}$）。观测算子围绕背景态进行线性化，因此小扰动满足 $y' \\approx H x'$，其中 $H = [h_{1}, h_{2}]$ 包含亮度温度（BT）相对于层平均温度 $x$ 的线性化雅可比 $h_{1}$ 和 $h_{2}$。在此场景下，观测误差被建模为零均值、高斯分布，且通道间相互不相关，其观测误差协方差为 $\\mathbf{R} = \\mathrm{diag}(R_{11}, R_{22})$。每个通道的误差方差是三个具有物理基础的贡献之和：仪器噪声、正演模型误差，以及由像元内场景非均匀性引起的代表性误差。\n\n使用以下具有科学合理性的场景特征和仪器属性：\n- $x$ 的背景误差方差：$\\sigma_{b}^{2} = 4.0 \\,\\mathrm{K}^{2}$。\n- 线性化雅可比：$h_{1} = 0.7$, $h_{2} = 0.4$。\n- 仪器噪声（噪声等效温差）：$\\sigma_{\\mathrm{instr},1} = 0.12 \\,\\mathrm{K}$，$\\sigma_{\\mathrm{instr},2} = 0.18 \\,\\mathrm{K}$。\n- 正演模型误差标准差（假设与通道无关，且在此场景中不相关）：$\\sigma_{\\mathrm{fm}} = 0.07 \\,\\mathrm{K}$。\n- 云量分数：$f_{c} = 0.25$，像元内温度变率：$\\sigma_{\\mathrm{sub}} = 2.0 \\,\\mathrm{K}$。\n- 通道层灵敏度因子（通道权重函数中目标层的分数权重）：$w_{1} = 0.8$，$w_{2} = 0.6$。\n- 每个通道的代表性误差建模为 $\\sigma_{\\mathrm{repr},i} = w_{i}\\,\\sigma_{\\mathrm{sub}}\\,\\sqrt{f_{c}}$。\n\n任务：\n1. 使用上述定义，根据公式 $R_{ii} = \\sigma_{\\mathrm{instr},i}^{2} + \\sigma_{\\mathrm{fm}}^{2} + \\sigma_{\\mathrm{repr},i}^{2}$ 计算 $R_{11}$ 和 $R_{22}$。\n2. 在标量控制变量 $x$ 和两个观测的线性高斯假设下，用背景误差方差和观测误差协方差推导标量分析误差方差 $P^{a}$，然后计算其在此场景下的数值。\n3. 将您的最终答案四舍五入到四位有效数字。以 $\\mathrm{K}^{2}$ 为单位表示最终的分析误差方差。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和自洽的。所提供的数据和模型与数值天气预报的卫星数据同化领域的既定原则一致。因此，我们可以开始解题。\n\n该问题需要分三步解决：首先，计算两个卫星通道的观测误差方差；其次，推导并计算单个大气温度状态变量的分析误差方差；第三，将最终结果四舍五入到指定精度。\n\n首先，我们计算观测误差协方差矩阵 $\\mathbf{R}$ 的对角元素 $R_{11}$ 和 $R_{22}$。问题陈述指出，给定通道 $i$ 的总观测误差方差（记为 $R_{ii}$）是来自三个独立误差源的方差之和：仪器噪声、正演模型误差和代表性误差。其公式如下：\n$$R_{ii} = \\sigma_{\\mathrm{instr},i}^{2} + \\sigma_{\\mathrm{fm}}^{2} + \\sigma_{\\mathrm{repr},i}^{2}$$\n仪器噪声标准差（$\\sigma_{\\mathrm{instr},i}$）和正演模型误差标准差（$\\sigma_{\\mathrm{fm}}$）已给出。我们必须首先使用给定的模型计算每个通道的代表性误差标准差 $\\sigma_{\\mathrm{repr},i}$：\n$$\\sigma_{\\mathrm{repr},i} = w_{i}\\,\\sigma_{\\mathrm{sub}}\\,\\sqrt{f_{c}}$$\n给定的参数为：云量分数 $f_{c} = 0.25$，像元内温度变率 $\\sigma_{\\mathrm{sub}} = 2.0 \\, \\mathrm{K}$，以及通道层灵敏度因子 $w_{1} = 0.8$ 和 $w_{2} = 0.6$。\n\n对于通道1：\n$$\\sigma_{\\mathrm{repr},1} = w_{1}\\,\\sigma_{\\mathrm{sub}}\\,\\sqrt{f_{c}} = (0.8)(2.0)\\sqrt{0.25} = (0.8)(2.0)(0.5) = 0.8 \\, \\mathrm{K}$$\n对于通道2：\n$$\\sigma_{\\mathrm{repr},2} = w_{2}\\,\\sigma_{\\mathrm{sub}}\\,\\sqrt{f_{c}} = (0.6)(2.0)\\sqrt{0.25} = (0.6)(2.0)(0.5) = 0.6 \\, \\mathrm{K}$$\n现在，我们可以使用给定的仪器噪声标准差（$\\sigma_{\\mathrm{instr},1} = 0.12 \\, \\mathrm{K}$，$\\sigma_{\\mathrm{instr},2} = 0.18 \\, \\mathrm{K}$）和正演模型误差标准差（$\\sigma_{\\mathrm{fm}} = 0.07 \\, \\mathrm{K}$）来计算 $R_{11}$ 和 $R_{22}$。\n\n对于通道1：\n$$R_{11} = \\sigma_{\\mathrm{instr},1}^{2} + \\sigma_{\\mathrm{fm}}^{2} + \\sigma_{\\mathrm{repr},1}^{2} = (0.12)^{2} + (0.07)^{2} + (0.8)^{2}$$\n$$R_{11} = 0.0144 + 0.0049 + 0.64 = 0.6593 \\, \\mathrm{K}^{2}$$\n对于通道2：\n$$R_{22} = \\sigma_{\\mathrm{instr},2}^{2} + \\sigma_{\\mathrm{fm}}^{2} + \\sigma_{\\mathrm{repr},2}^{2} = (0.18)^{2} + (0.07)^{2} + (0.6)^{2}$$\n$$R_{22} = 0.0324 + 0.0049 + 0.36 = 0.3973 \\, \\mathrm{K}^{2}$$\n\n其次，我们推导标量分析误差方差 $P^{a}$ 的表达式并计算其值。在线性高斯估计中，分析误差协方差矩阵 $\\mathbf{P}^{a}$ 的逆的一般公式为：\n$$(\\mathbf{P}^{a})^{-1} = (\\mathbf{P}^{b})^{-1} + \\mathbf{H}^{T} \\mathbf{R}^{-1} \\mathbf{H}$$\n在这个问题中，状态变量 $x$ 是一个标量，因此其背景误差协方差 $\\mathbf{P}^{b}$ 是标量方差 $P^{b} = \\sigma_{b}^{2}$，其分析误差协方差 $\\mathbf{P}^{a}$ 是标量方差 $P^{a}$。观测向量有两个分量，因此雅可比矩阵 $\\mathbf{H}$（表示两个观测对单个状态变量的敏感度）是一个 $2 \\times 1$ 的列向量：\n$$\\mathbf{H} = \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix}$$\n观测误差协方差矩阵 $\\mathbf{R}$ 是一个 $2 \\times 2$ 的对角矩阵，因为误差是不相关的：\n$$\\mathbf{R} = \\begin{pmatrix} R_{11} & 0 \\\\ 0 & R_{22} \\end{pmatrix}$$\n其逆矩阵为：\n$$\\mathbf{R}^{-1} = \\begin{pmatrix} \\frac{1}{R_{11}} & 0 \\\\ 0 & \\frac{1}{R_{22}} \\end{pmatrix}$$\n我们现在计算 $\\mathbf{H}^{T} \\mathbf{R}^{-1} \\mathbf{H}$ 这一项：\n$$\\mathbf{H}^{T} \\mathbf{R}^{-1} \\mathbf{H} = \\begin{pmatrix} h_{1} & h_{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{R_{11}} & 0 \\\\ 0 & \\frac{1}{R_{22}} \\end{pmatrix} \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{h_{1}}{R_{11}} & \\frac{h_{2}}{R_{22}} \\end{pmatrix} \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix} = \\frac{h_{1}^{2}}{R_{11}} + \\frac{h_{2}^{2}}{R_{22}}$$\n正如预期的，该项是一个标量。将其代入分析误差公式的标量形式：\n$$\\frac{1}{P^{a}} = \\frac{1}{P^{b}} + \\frac{h_{1}^{2}}{R_{11}} + \\frac{h_{2}^{2}}{R_{22}}$$\n使用 $P^{b} = \\sigma_{b}^{2}$， $P^{a}$ 的表达式为：\n$$P^{a} = \\left( \\frac{1}{\\sigma_{b}^{2}} + \\frac{h_{1}^{2}}{R_{11}} + \\frac{h_{2}^{2}}{R_{22}} \\right)^{-1}$$\n我们现在代入数值：$\\sigma_{b}^{2} = 4.0 \\, \\mathrm{K}^{2}$，$h_{1} = 0.7$，$h_{2} = 0.4$，以及先前计算出的 $R_{11}$ 和 $R_{22}$ 的值。\n\n首先，计算和的各个项（这些项代表信息含量或精度，单位为 $\\mathrm{K}^{-2}$）：\n$$\\frac{1}{\\sigma_{b}^{2}} = \\frac{1}{4.0} = 0.25 \\, \\mathrm{K}^{-2}$$\n$$\\frac{h_{1}^{2}}{R_{11}} = \\frac{(0.7)^{2}}{0.6593} = \\frac{0.49}{0.6593} \\approx 0.7432125 \\, \\mathrm{K}^{-2}$$\n$$\\frac{h_{2}^{2}}{R_{22}} = \\frac{(0.4)^{2}}{0.3973} = \\frac{0.16}{0.3973} \\approx 0.4027183 \\, \\mathrm{K}^{-2}$$\n分析误差方差的倒数是这些精度的总和：\n$$\\frac{1}{P^{a}} = 0.25 + 0.7432125... + 0.4027183... = 1.3959308... \\, \\mathrm{K}^{-2}$$\n分析误差方差是这个总和的倒数：\n$$P^{a} = \\frac{1}{1.3959308...} \\approx 0.7163683 \\, \\mathrm{K}^{2}$$\n\n第三，问题要求将最终答案四舍五入到四位有效数字。\n$$P^{a} \\approx 0.7164 \\, \\mathrm{K}^{2}$$\n这个最终值表示在将背景信息与两个卫星观测最优地结合后，大气温度估计的期望平方误差。正如预期的，$P^{a} < \\sigma_{b}^{2}$，这表明观测减少了状态估计的不确定性。",
            "answer": "$$ \\boxed{0.7164} $$"
        },
        {
            "introduction": "卫星辐射率测量常常相对于数值模式存在系统性偏差，这违反了标准同化方案中的零均值误差假设。本练习介绍了变分偏差校正（Variational Bias Correction, VarBC），这是一种先进技术，可在进行分析的同时估计和校正这种偏差。通过计算偏差模型参数（$\\boldsymbol{\\alpha}$）的更新，您将看到同化框架如何扩展以处理这些系统性误差，这是有效利用卫星数据的关键一步 。",
            "id": "4012681",
            "problem": "一个用于单一微波温度探测通道的大气数据同化系统，在一个三维变分 (3D-Var) 框架内使用变分偏差订正 (VarBC)。辐射率（表示为亮温）的观测算子被线性化为 $y \\approx H(x) + \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}$，其中 $\\mathbf{p} \\in \\mathbb{R}^{3}$ 是由扫描角、气团和温度直减率构成的预报因子向量，$\\boldsymbol{\\alpha} \\in \\mathbb{R}^{3}$ 是待估计的偏差参数向量。在此步骤中，背景场状态增量被约束为零（即，只更新 $\\boldsymbol{\\alpha}$），并且同化一个标量观测。\n\n使用针对单一标量观测和线性预报因子的标准三维变分代价函数作为基本基础。也就是说，在高斯误差假设和观测算子相对于 $\\boldsymbol{\\alpha}$ 的线性度下，最小化由背景项和观测失配项组成的关于 $\\boldsymbol{\\alpha}$ 的二次型。\n\n对于单一辐射率，提供以下数据：\n- 观测亮温 $y_{\\mathrm{obs}} = 220.5\\ \\mathrm{K}$。\n- 来自背景场状态的模拟亮温 $H(x_b) = 223.1\\ \\mathrm{K}$。\n- 观测误差标准差 $\\sigma_{o} = 1.0\\ \\mathrm{K}$（因此观测误差方差为 $R = \\sigma_{o}^{2}$）。\n- 预报因子向量 $\\mathbf{p} = \\begin{pmatrix} 0.30 \\\\ 1.20 \\\\ -0.50 \\end{pmatrix}$，由扫描角、气团和温度直减率预报因子组成（每个都已缩放为无量纲）。\n- 先验（背景）偏差参数 $\\boldsymbol{\\alpha}_{b} = \\begin{pmatrix} 0.60 \\\\ -0.40 \\\\ 0.10 \\end{pmatrix}$，其条目单位为亮温单位/预报因子单位。\n- 先验偏差参数协方差矩阵\n$$\n\\mathbf{B}_{\\alpha} \\;=\\;\n\\begin{pmatrix}\n0.25 & 0.05 & 0.00 \\\\\n0.05 & 0.16 & -0.02 \\\\\n0.00 & -0.02 & 0.09\n\\end{pmatrix},\n$$\n其单位为与偏差参数条目一致的平方单位。\n\n任务：\n1) 从上述定义和假设下关于 $\\boldsymbol{\\alpha}$ 的二次型 3D-Var 代价函数出发，推导偏差参数的解析形式分析增量 $\\Delta \\boldsymbol{\\alpha} \\equiv \\boldsymbol{\\alpha}_{a} - \\boldsymbol{\\alpha}_{b}$，用 $\\mathbf{p}$、$\\mathbf{B}_{\\alpha}$、$R$ 和偏差订正后的新息（定义如下）表示。\n2) 计算先验偏差 $b_{b} \\equiv \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}_{b}$ 和偏差订正后的新息 $d_{\\mathrm{bc}} \\equiv y_{\\mathrm{obs}} - H(x_b) - b_{b}$，以 $\\mathrm{K}$ 为单位表示。\n3) 使用你推导的表达式，计算此观测的单步 VarBC 参数更新量 $\\Delta \\boldsymbol{\\alpha}$。\n\n以 $\\mathrm{K}$ 为单位表示偏差订正后的新息，并以相同的亮温单位/预报因子单位表示参数更新量。将所有报告的数值四舍五入到四位有效数字。将你的最终答案报告为一个行矩阵，顺序为 $(d_{\\mathrm{bc}}, \\Delta \\alpha_{1}, \\Delta \\alpha_{2}, \\Delta \\alpha_{3})$，矩阵中不含单位。",
            "solution": "该问题要求在一个三维变分 (3D-Var) 数据同化框架内，推导并应用对偏差订正参数的单次观测更新。状态向量保持不变，只更新偏差参数向量 $\\boldsymbol{\\alpha}$。\n\n首先，我们验证问题陈述。\n**第 1 步：提取给定条件**\n- 线性化辐射率（亮温）的观测算子：$y \\approx H(x) + \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}$\n- 预报因子向量：$\\mathbf{p} = \\begin{pmatrix} 0.30 \\\\ 1.20 \\\\ -0.50 \\end{pmatrix}$\n- 偏差参数向量：$\\boldsymbol{\\alpha} \\in \\mathbb{R}^{3}$\n- 观测亮温：$y_{\\mathrm{obs}} = 220.5\\ \\mathrm{K}$\n- 来自背景场状态的模拟亮温：$H(x_b) = 223.1\\ \\mathrm{K}$\n- 观测误差标准差：$\\sigma_{o} = 1.0\\ \\mathrm{K}$\n- 观测误差方差：$R = \\sigma_{o}^{2} = (1.0)^{2} = 1.0\\ \\mathrm{K}^2$\n- 先验（背景）偏差参数：$\\boldsymbol{\\alpha}_{b} = \\begin{pmatrix} 0.60 \\\\ -0.40 \\\\ 0.10 \\end{pmatrix}$\n- 先验偏差参数误差协方差矩阵：\n$$\n\\mathbf{B}_{\\alpha} \\;=\\;\n\\begin{pmatrix}\n0.25 & 0.05 & 0.00 \\\\\n0.05 & 0.16 & -0.02 \\\\\n0.00 & -0.02 & 0.09\n\\end{pmatrix}\n$$\n- 定义：\n  - 偏差参数分析增量：$\\Delta \\boldsymbol{\\alpha} \\equiv \\boldsymbol{\\alpha}_{a} - \\boldsymbol{\\alpha}_{b}$\n  - 先验偏差：$b_{b} \\equiv \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}_{b}$\n  - 偏差订正后的新息：$d_{\\mathrm{bc}} \\equiv y_{\\mathrm{obs}} - H(x_b) - b_{b}$\n\n**第 2 步：使用提取的给定条件进行验证**\n该问题在科学上植根于变分数据同化和偏差订正的理论，这是数值天气预报系统的标准组成部分。所有术语都定义明确，问题在数学上是适定的，描述了二次代价函数的最小化过程。所提供的数据是自洽且真实的。问题是完整、客观且可形式化的。未发现任何缺陷。\n\n**第 3 步：结论与行动**\n问题有效。我们继续进行求解。\n\n**任务 1：推导 $\\Delta \\boldsymbol{\\alpha}$ 的解析形式分析增量**\n\n偏差参数 $\\boldsymbol{\\alpha}$ 的 3D-Var 代价函数 $J$ 由背景项 $J_b$ 和观测项 $J_o$ 组成。由于状态向量增量为零，我们只考虑控制向量 $\\boldsymbol{\\alpha}$。\n\n$$J(\\boldsymbol{\\alpha}) = J_b(\\boldsymbol{\\alpha}) + J_o(\\boldsymbol{\\alpha})$$\n\n背景项惩罚分析参数 $\\boldsymbol{\\alpha}_a$ 相对于背景参数 $\\boldsymbol{\\alpha}_b$ 的偏离，并由背景误差协方差矩阵 $\\mathbf{B}_{\\alpha}$ 的逆加权：\n$$J_b(\\boldsymbol{\\alpha}) = \\frac{1}{2} (\\boldsymbol{\\alpha} - \\boldsymbol{\\alpha}_b)^{\\mathsf{T}} \\mathbf{B}_{\\alpha}^{-1} (\\boldsymbol{\\alpha} - \\boldsymbol{\\alpha}_b)$$\n\n观测项惩罚观测值 $y_{\\mathrm{obs}}$ 与偏差订正后的模式等价值 $H(x_b) + \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}$ 之间的差异，并由观测误差方差 $R$ 的逆加权：\n$$J_o(\\boldsymbol{\\alpha}) = \\frac{1}{2R} (y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha})^2$$\n\n分析参数向量 $\\boldsymbol{\\alpha}_a$ 是通过最小化总代价函数 $J(\\boldsymbol{\\alpha})$ 求得的。我们通过将 $J$ 对 $\\boldsymbol{\\alpha}$ 的梯度设为零来找到最小值：\n$$\\nabla_{\\boldsymbol{\\alpha}} J(\\boldsymbol{\\alpha}_a) = \\mathbf{0}$$\n\n各项的梯度为：\n$$\\nabla_{\\boldsymbol{\\alpha}} J_b(\\boldsymbol{\\alpha}) = \\mathbf{B}_{\\alpha}^{-1} (\\boldsymbol{\\alpha} - \\boldsymbol{\\alpha}_b)$$\n$$\\nabla_{\\boldsymbol{\\alpha}} J_o(\\boldsymbol{\\alpha}) = \\frac{1}{R} (y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}) \\cdot (-\\mathbf{p})$$\n\n对 $\\boldsymbol{\\alpha} = \\boldsymbol{\\alpha}_a$ 将梯度之和设为零：\n$$\\mathbf{B}_{\\alpha}^{-1} (\\boldsymbol{\\alpha}_a - \\boldsymbol{\\alpha}_b) - \\frac{1}{R} (y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}_a) \\mathbf{p} = \\mathbf{0}$$\n\n设分析增量为 $\\Delta \\boldsymbol{\\alpha} = \\boldsymbol{\\alpha}_a - \\boldsymbol{\\alpha}_b$。因此，$\\boldsymbol{\\alpha}_a = \\boldsymbol{\\alpha}_b + \\Delta \\boldsymbol{\\alpha}$。将此代入方程：\n$$\\mathbf{B}_{\\alpha}^{-1} \\Delta \\boldsymbol{\\alpha} - \\frac{1}{R} (y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}}(\\boldsymbol{\\alpha}_b + \\Delta \\boldsymbol{\\alpha})) \\mathbf{p} = \\mathbf{0}$$\n\n我们可以重组括号中的项：\n$$\\mathbf{B}_{\\alpha}^{-1} \\Delta \\boldsymbol{\\alpha} - \\frac{1}{R} ([y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}}\\boldsymbol{\\alpha}_b] - \\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{p} = \\mathbf{0}$$\n\n方括号中的项是偏差订正后的新息，$d_{\\mathrm{bc}} = y_{\\mathrm{obs}} - H(x_b) - \\mathbf{p}^{\\mathsf{T}}\\boldsymbol{\\alpha}_b$。方程简化为：\n$$\\mathbf{B}_{\\alpha}^{-1} \\Delta \\boldsymbol{\\alpha} - \\frac{1}{R} (d_{\\mathrm{bc}} - \\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{p} = \\mathbf{0}$$\n\n重新整理以求解 $\\Delta \\boldsymbol{\\alpha}$：\n$$\\mathbf{B}_{\\alpha}^{-1} \\Delta \\boldsymbol{\\alpha} + \\frac{1}{R} (\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{p} = \\frac{d_{\\mathrm{bc}}}{R} \\mathbf{p}$$\n注意到 $(\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{p} = (\\mathbf{p}\\mathbf{p}^{\\mathsf{T}}) \\Delta \\boldsymbol{\\alpha}$，其中 $\\mathbf{p}\\mathbf{p}^{\\mathsf{T}}$ 是一个外积：\n$$\\left( \\mathbf{B}_{\\alpha}^{-1} + \\frac{1}{R} \\mathbf{p}\\mathbf{p}^{\\mathsf{T}} \\right) \\Delta \\boldsymbol{\\alpha} = \\frac{d_{\\mathrm{bc}}}{R} \\mathbf{p}$$\n为求解 $\\Delta \\boldsymbol{\\alpha}$ 而不求逆左侧的 Hessian 矩阵，我们可以将方程两边乘以 $\\mathbf{B}_{\\alpha}$：\n$$\\Delta \\boldsymbol{\\alpha} + \\frac{1}{R} (\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{B}_{\\alpha} \\mathbf{p} = \\frac{d_{\\mathrm{bc}}}{R} \\mathbf{B}_{\\alpha} \\mathbf{p}$$\n这是一个向量方程。为了求出标量 $\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}$，我们左乘 $\\mathbf{p}^{\\mathsf{T}}$：\n$$\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha} + \\frac{1}{R} (\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) (\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}) = \\frac{d_{\\mathrm{bc}}}{R} (\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p})$$\n提取公因式 $\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}$：\n$$(\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\left(1 + \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R}\\right) = d_{\\mathrm{bc}} \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R}$$\n求解 $\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}$：\n$$(\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\left(\\frac{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R}\\right) = d_{\\mathrm{bc}} \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R} \\implies \\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha} = d_{\\mathrm{bc}} \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}$$\n现在，将此表达式代回 $\\Delta \\boldsymbol{\\alpha}$ 的向量方程：\n$$\\Delta \\boldsymbol{\\alpha} = \\frac{d_{\\mathrm{bc}}}{R} \\mathbf{B}_{\\alpha} \\mathbf{p} - \\frac{1}{R} (\\mathbf{p}^{\\mathsf{T}}\\Delta \\boldsymbol{\\alpha}) \\mathbf{B}_{\\alpha} \\mathbf{p}$$\n$$\\Delta \\boldsymbol{\\alpha} = \\frac{d_{\\mathrm{bc}}}{R} \\mathbf{B}_{\\alpha} \\mathbf{p} - \\frac{1}{R} \\left(d_{\\mathrm{bc}} \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}\\right) \\mathbf{B}_{\\alpha} \\mathbf{p}$$\n提取公因式：\n$$\\Delta \\boldsymbol{\\alpha} = \\frac{\\mathbf{B}_{\\alpha} \\mathbf{p}}{R} d_{\\mathrm{bc}} \\left(1 - \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}\\right)$$\n简化括号中的项：\n$$1 - \\frac{\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}} = \\frac{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p} - \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}} = \\frac{R}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}}$$\n代回后，我们得到分析增量的最终解析表达式：\n$$\\Delta \\boldsymbol{\\alpha} = \\left( \\frac{\\mathbf{B}_{\\alpha} \\mathbf{p}}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}} \\right) d_{\\mathrm{bc}}$$\n这个表达式类似于卡尔曼更新方程，其中括号中的项是卡尔曼增益矩阵 $\\mathbf{K}$。\n\n**任务 2：计算先验偏差 $b_b$ 和偏差订正后的新息 $d_{\\mathrm{bc}}$**\n\n使用提供的数据，我们首先计算先验偏差估计 $b_b$：\n$$b_b = \\mathbf{p}^{\\mathsf{T}} \\boldsymbol{\\alpha}_b = \\begin{pmatrix} 0.30 & 1.20 & -0.50 \\end{pmatrix} \\begin{pmatrix} 0.60 \\\\ -0.40 \\\\ 0.10 \\end{pmatrix}$$\n$$b_b = (0.30)(0.60) + (1.20)(-0.40) + (-0.50)(0.10) = 0.18 - 0.48 - 0.05 = -0.35\\ \\mathrm{K}$$\n接下来，我们计算偏差订正后的新息 $d_{\\mathrm{bc}}$：\n$$d_{\\mathrm{bc}} = y_{\\mathrm{obs}} - H(x_b) - b_b = 220.5 - 223.1 - (-0.35) = -2.6 + 0.35 = -2.25\\ \\mathrm{K}$$\n四舍五入到四位有效数字，$d_{\\mathrm{bc}} = -2.250\\ \\mathrm{K}$。\n\n**任务 3：计算参数更新量 $\\Delta \\boldsymbol{\\alpha}$**\n\n我们使用推导出的 $\\Delta \\boldsymbol{\\alpha}$ 公式。首先，我们计算必要的中间量。\n观测误差方差为 $R = \\sigma_o^2 = (1.0)^2 = 1.0$。\n向量 $\\mathbf{B}_{\\alpha} \\mathbf{p}$ 为：\n$$\\mathbf{B}_{\\alpha} \\mathbf{p} = \\begin{pmatrix} 0.25 & 0.05 & 0.00 \\\\ 0.05 & 0.16 & -0.02 \\\\ 0.00 & -0.02 & 0.09 \\end{pmatrix} \\begin{pmatrix} 0.30 \\\\ 1.20 \\\\ -0.50 \\end{pmatrix} = \\begin{pmatrix} 0.25(0.30) + 0.05(1.20) + 0.00(-0.50) \\\\ 0.05(0.30) + 0.16(1.20) - 0.02(-0.50) \\\\ 0.00(0.30) - 0.02(1.20) + 0.09(-0.50) \\end{pmatrix}$$\n$$\\mathbf{B}_{\\alpha} \\mathbf{p} = \\begin{pmatrix} 0.075 + 0.060 \\\\ 0.015 + 0.192 + 0.010 \\\\ -0.024 - 0.045 \\end{pmatrix} = \\begin{pmatrix} 0.135 \\\\ 0.217 \\\\ -0.069 \\end{pmatrix}$$\n标量 $\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}$ 为：\n$$\\mathbf{p}^{\\mathsf{T}}(\\mathbf{B}_{\\alpha} \\mathbf{p}) = \\begin{pmatrix} 0.30 & 1.20 & -0.50 \\end{pmatrix} \\begin{pmatrix} 0.135 \\\\ 0.217 \\\\ -0.069 \\end{pmatrix}$$\n$$\\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p} = 0.30(0.135) + 1.20(0.217) - 0.50(-0.069) = 0.0405 + 0.2604 + 0.0345 = 0.3354$$\n现在，组合成 $\\Delta \\boldsymbol{\\alpha}$ 的最终表达式：\n$$\\Delta \\boldsymbol{\\alpha} = \\left( \\frac{1}{R + \\mathbf{p}^{\\mathsf{T}}\\mathbf{B}_{\\alpha} \\mathbf{p}} \\right) (\\mathbf{B}_{\\alpha} \\mathbf{p}) d_{\\mathrm{bc}}$$\n$$\\Delta \\boldsymbol{\\alpha} = \\left( \\frac{1}{1.0 + 0.3354} \\right) \\begin{pmatrix} 0.135 \\\\ 0.217 \\\\ -0.069 \\end{pmatrix} (-2.25)$$\n$$\\Delta \\boldsymbol{\\alpha} = \\frac{-2.25}{1.3354} \\begin{pmatrix} 0.135 \\\\ 0.217 \\\\ -0.069 \\end{pmatrix} \\approx -1.68489 \\begin{pmatrix} 0.135 \\\\ 0.217 \\\\ -0.069 \\end{pmatrix}$$\n$$\\Delta \\boldsymbol{\\alpha} \\approx \\begin{pmatrix} -0.22746 \\\\ -0.36561 \\\\ 0.11626 \\end{pmatrix}$$\n将各分量四舍五入到四位有效数字：\n$$\\Delta \\boldsymbol{\\alpha} = \\begin{pmatrix} -0.2275 \\\\ -0.3656 \\\\ 0.1163 \\end{pmatrix}$$\n最终要求的结果是行矩阵 $(d_{\\mathrm{bc}}, \\Delta \\alpha_{1}, \\Delta \\alpha_{2}, \\Delta \\alpha_{3})$。\n最终值：$d_{\\mathrm{bc}}=-2.250$，$\\Delta \\alpha_1 = -0.2275$，$\\Delta \\alpha_2 = -0.3656$，$\\Delta \\alpha_3 = 0.1163$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2.250 & -0.2275 & -0.3656 & 0.1163\n\\end{pmatrix}\n}\n$$"
        }
    ]
}