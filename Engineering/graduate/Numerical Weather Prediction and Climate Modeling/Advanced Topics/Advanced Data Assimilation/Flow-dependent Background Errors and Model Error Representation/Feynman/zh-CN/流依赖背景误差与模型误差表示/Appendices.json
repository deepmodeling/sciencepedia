{
    "hands_on_practices": [
        {
            "introduction": "在我们深入探讨复杂的高维模型之前，通过一个简单的标量模型来理解误差增长的基本原理是至关重要的。这个练习旨在揭示预报误差的两个核心来源之间的平衡：动力系统自身的误差增长特性与模型不完美性所引入的随机误差。通过推导稳态背景误差方差，您将亲身体会到预报不确定性是如何由流依赖的敏感性（动力学）和模型误差（持续的误差源）共同决定的。",
            "id": "4043311",
            "problem": "考虑一个数值天气预报系统中沿流场的标量线性化预报误差演变，其被建模为离散时间过程 $e_{k+1}=a\\,e_k+\\eta_k$，其中 $|a|1$ 概括了流场的局部、单步线性敏感性（例如，一个同化窗口内切线性传播子的主奇异值），而 $\\eta_k$ 是一个零均值、序列独立的高斯模型误差，其分布为 $\\eta_k \\sim \\mathcal{N}(0,q)$，且对于每个 $k$ 都与 $e_k$ 独立。设在时间 $k$ 的背景（预报）误差方差为 $P_k=\\mathbb{E}[e_k^2]$。假设该系统允许误差存在一个平稳分布，因此当 $k \\to \\infty$ 时，$P_k \\to P^\\ast$。\n\n仅使用所述的误差动力学、期望和方差的定义，以及上面给出的独立性和矩的假设，从第一性原理出发，推导平稳背景误差方差 $P^\\ast$ 作为 $a$ 和 $q$ 的函数的闭式表达式。然后，使用此表达式，通过解释 $P^\\ast$ 如何随 $q$ 缩放，以及当 $a \\to 0$ 和 $a \\to 1^{-}$ 时它如何依赖于流场敏感性 $a$，来将参数 $q$ 解释为模型误差强度的度量。在最终答案中仅报告 $P^\\ast$ 的解析表达式。不需要进行数值计算，也不需要单位。",
            "solution": "该问题要求推导一个标量预报误差演变模型的平稳背景误差方差 $P^\\ast$。\n\n在离散时间步长 $k$ 的预报误差 $e_k$ 模型由以下线性随机过程给出：\n$$e_{k+1} = a\\,e_k + \\eta_k$$\n此处，$a$ 是一个表示流场敏感性的标量参数，且 $|a|1$。项 $\\eta_k$ 代表模型误差，它是一个零均值、序列独立的高斯随机变量，其分布为 $\\eta_k \\sim \\mathcal{N}(0,q)$。这意味着 $\\eta_k$ 的期望为 $\\mathbb{E}[\\eta_k] = 0$，其方差为 $\\text{Var}(\\eta_k) = q$。由于均值为零，二阶矩等于方差：$\\mathbb{E}[\\eta_k^2] = \\text{Var}(\\eta_k) + (\\mathbb{E}[\\eta_k])^2 = q + 0^2 = q$。问题还指出，对于每个 $k$，$\\eta_k$ 与 $e_k$ 独立。\n\n在时间 $k$ 的背景误差方差定义为 $P_k = \\mathbb{E}[e_k^2]$。我们寻求其平稳值 $P^\\ast = \\lim_{k \\to \\infty} P_k$。\n\n我们首先建立方差 $P_k$ 的递推关系。根据定义，下一时间步长 $k+1$ 的方差为：\n$$P_{k+1} = \\mathbb{E}[e_{k+1}^2]$$\n将 $e_{k+1}$ 的演变方程代入此定义，我们得到：\n$$P_{k+1} = \\mathbb{E}[(a\\,e_k + \\eta_k)^2]$$\n展开期望内的平方项，得到：\n$$P_{k+1} = \\mathbb{E}[a^2 e_k^2 + 2a\\,e_k\\eta_k + \\eta_k^2]$$\n根据期望算子的线性性质，我们可以将其写为：\n$$P_{k+1} = \\mathbb{E}[a^2 e_k^2] + \\mathbb{E}[2a\\,e_k\\eta_k] + \\mathbb{E}[\\eta_k^2]$$\n由于 $a$ 是一个常数，我们可以将其和因子 $2$ 从期望中提出：\n$$P_{k+1} = a^2 \\mathbb{E}[e_k^2] + 2a\\,\\mathbb{E}[e_k\\eta_k] + \\mathbb{E}[\\eta_k^2]$$\n现在，我们使用问题陈述中给出的信息来评估每一项：\n1.  第一项包含 $\\mathbb{E}[e_k^2]$，这是方差 $P_k$ 的定义。所以，$a^2 \\mathbb{E}[e_k^2] = a^2 P_k$。\n2.  第三项 $\\mathbb{E}[\\eta_k^2]$ 是模型误差 $\\eta_k$ 的二阶矩。如前所述，由于 $\\eta_k$ 的均值为 $0$ 且方差为 $q$，其二阶矩为 $q$。所以，$\\mathbb{E}[\\eta_k^2] = q$。\n3.  第二项是 $2a\\,\\mathbb{E}[e_k\\eta_k]$。问题指出 $e_k$ 和 $\\eta_k$ 是独立的。对于独立的随机变量，其乘积的期望等于期望的乘积：$\\mathbb{E}[e_k\\eta_k] = \\mathbb{E}[e_k]\\mathbb{E}[\\eta_k]$。由于 $\\mathbb{E}[\\eta_k]=0$，此项变为 $\\mathbb{E}[e_k\\eta_k] = \\mathbb{E}[e_k] \\cdot 0 = 0$。\n\n将这些结果代回 $P_{k+1}$ 的方程中，我们得到误差方差的递推关系：\n$$P_{k+1} = a^2 P_k + 2a(0) + q$$\n$$P_{k+1} = a^2 P_k + q$$\n问题指出该系统允许一个平稳分布，这意味着当 $k \\to \\infty$ 时，方差收敛到一个常数值 $P^\\ast$。在这个平稳状态下，$P_{k+1} = P_k = P^\\ast$。我们可以通过将其代入递推关系来找到 $P^\\ast$：\n$$P^\\ast = a^2 P^\\ast + q$$\n现在，我们求解这个关于 $P^\\ast$ 的代数方程：\n$$P^\\ast - a^2 P^\\ast = q$$\n$$P^\\ast (1 - a^2) = q$$\n$$P^\\ast = \\frac{q}{1 - a^2}$$\n这就是平稳背景误差方差的闭式表达式。条件 $|a|1$ 确保了 $a^2  1$，因此分母 $1 - a^2$ 是正且非零的，从而保证了 $P^\\ast$ 是一个良定义（well-defined）的正方差（假设 $q > 0$）。\n\n问题进一步要求对此结果进行解释。\n首先，$P^\\ast$ 随 $q$ 的缩放关系：该表达式表明 $P^\\ast$ 与 $q$ 成正比。这意味着平稳背景误差方差与模型误差方差呈线性缩放。这是直观的：在每一步注入更大的随机误差（更大的 $q$）会导致系统中相应更大的平衡误差方差。因此，$q$ 可作为模型误差强度的直接度量。\n\n其次，对流场敏感性 $a$ 的依赖性：\n-   当 $a \\to 0$ 时，我们考察其极限：\n    $$\\lim_{a \\to 0} P^\\ast = \\lim_{a \\to 0} \\frac{q}{1 - a^2} = \\frac{q}{1 - 0} = q$$\n    当 $a=0$ 时，系统对过去的误差没有记忆（$e_{k+1} = \\eta_k$）。任何时候的预报误差都只是前一步注入的模型误差。因此，预报误差方差与模型误差方差相同，$P^\\ast = q$。\n-   当 $a \\to 1^{-}$（在满足约束 $|a|1$ 的前提下从下方趋近于 $1$）：\n    $$\\lim_{a \\to 1^{-}} P^\\ast = \\lim_{a \\to 1^{-}} \\frac{q}{1 - a^2} = +\\infty$$\n    当 $a$ 趋近于 $1$ 时，系统的记忆变得更强。误差从一步传播到下一步时几乎没有衰减。系统对于随机扰动 $\\eta_k$ 几乎像一个完美的累加器。误差的持续累积导致方差无界增长，因此平稳方差发散到无穷大。这标志着一个高敏感性的流场状况，其中微小、持续的模型误差可能导致预报不确定性的爆炸性增长。有限平稳方差的存在，关键依赖于由 $|a|1$ 保证的动力学系统的耗散性质。",
            "answer": "$$\\boxed{\\frac{q}{1 - a^2}}$$"
        },
        {
            "introduction": "现实世界中的天气和气候系统是高度耦合的，一个变量的误差往往与另一个变量的误差相关。这个练习将带您从单变量世界进入一个简单的双变量系统，以展示流依赖背景误差协方差的核心价值。通过仅观测一个风分量（例如纬向风 $u$）来更新未被观测的另一个分量（经向风 $v$），您将推导出协方差在信息传播中的关键作用，并理解为什么精确的多元误差结构对现代数据同化至关重要。",
            "id": "4043372",
            "problem": "考虑中纬度斜压环境下一个模式格点的二维风场状态，表示为 $x = (u, v)^{\\top}$，其中 $u$ 和 $v$ 分别表示纬向和经向风分量。背景（先验）不确定性是流场相关的，由误差协方差矩阵表示\n$$\nB = \\begin{pmatrix}\n\\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\\\\n\\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{v}^{2}\n\\end{pmatrix},\n$$\n其中 $\\sigma_{u}^{2}$ 和 $\\sigma_{v}^{2}$ 是 $u$ 和 $v$ 的背景误差方差，$\\rho \\in [-1, 1]$ 是它们的背景误差相关系数，该系数源于集合所捕捉到的动力学耦合流场特征。\n\n假设有一个仅测量 $u$ 的单一现场观测，其误差是独立的高斯误差，因此观测模型是线性的，由 $y = H x + \\epsilon$ 给出，其中 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$ 且 $\\epsilon \\sim \\mathcal{N}(0, R)$，$R = r  0$。$x$ 的背景分布是均值为零、协方差为 $B$ 的高斯分布，这反映了包含在 $B$ 中的初始条件不确定性和模式误差表示。\n\n从线性高斯贝叶斯数据同化框架和卡尔曼滤波器（KF）的分析（后验）协方差定义出发，推导在同化这个单一的仅 $u$ 观测后，$v$ 的分析误差方差的精确闭式表达式。您的推导必须从适用于线性高斯推断的第一性原理开始，并逻辑地进行到最终表达式。以符号形式用 $\\sigma_{u}$、$\\sigma_{v}$、$\\rho$ 和 $r$ 表示您的最终答案。不需要进行数值计算。如果您引入任何缩略词，请在首次使用时定义它们。仅提供 $v$ 的分析误差方差的最终标量表达式。",
            "solution": "该问题要求推导在同化纬向风分量 $u$ 的观测后，经向风分量 $v$ 的分析误差方差。这是贝叶斯数据同化中的一个标准问题，可以使用卡尔曼滤波器（KF）的方程来解决。分析（或后验）状态是背景（先验）信息和新观测的最优组合。该分析状态的不确定性由分析误差协方差矩阵描述。\n\n设状态向量为 $x = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$。背景信息由一个概率分布给出，其均值为 $x_b$（根据问题陈述，假定为 $\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$），背景误差协方差矩阵为 $B$。观测通过线性模型 $y = Hx + \\epsilon$ 与状态相关联，其中 $H$ 是观测算子，$\\epsilon$ 是观测误差，其协方差矩阵为 $R$。\n\n给定的条件是：\n背景误差协方差矩阵 $B$：\n$$\nB = \\begin{pmatrix}\n\\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\\\\n\\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{v}^{2}\n\\end{pmatrix}\n$$\n观测算子 $H$：\n$$\nH = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n观测误差协方差矩阵 $R$，在本例中为标量：\n$$\nR = r\n$$\n分析误差协方差矩阵，我们记为 $A$，由以下公式给出：\n$$\nA = (I - KH)B\n$$\n其中 $I$ 是单位矩阵，$K$ 是卡尔曼增益。卡尔曼增益定义为：\n$$\nK = B H^{\\top} (H B H^{\\top} + R)^{-1}\n$$\n我们的目标是找到矩阵 $A$ 的 $(2,2)$ 元素，它对应于状态分量 $v$ 的分析误差方差。\n\n首先，我们计算卡尔曼增益 $K$ 所需的各项。\n观测算子 $H$ 的转置 $H^{\\top}$ 是：\n$$\nH^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算 $H B H^{\\top}$ 项。这表示投影到观测空间中的背景误差方差。\n$$\nH B H^{\\top} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{v}^{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nH B H^{\\top} = \\begin{pmatrix} \\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sigma_{u}^{2}\n$$\n项 $(H B H^{\\top} + R)$ 是观测空间中的总误差方差。由于 $H B H^{\\top}$ 和 $R$ 都是标量（分别为 $\\sigma_u^2$ 和 $r$），它们的和也是一个标量：\n$$\nH B H^{\\top} + R = \\sigma_{u}^{2} + r\n$$\n这个标量项的逆就是它的倒数：\n$$\n(H B H^{\\top} + R)^{-1} = \\frac{1}{\\sigma_{u}^{2} + r}\n$$\n接下来，我们计算 $B H^{\\top}$ 项：\n$$\nB H^{\\top} = \\begin{pmatrix} \\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{v}^{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{u}^{2} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v} \\end{pmatrix}\n$$\n现在我们可以组装卡尔曼增益 $K$：\n$$\nK = (B H^{\\top}) (H B H^{\\top} + R)^{-1} = \\begin{pmatrix} \\sigma_{u}^{2} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v} \\end{pmatrix} \\frac{1}{\\sigma_{u}^{2} + r}\n$$\n卡尔曼增益 $K$ 是一个 $2 \\times 1$ 的列向量。\n\n在确定了卡尔曼增益后，我们继续计算分析误差协方差矩阵 $A = (I - KH)B$。\n首先，我们计算矩阵乘积 $KH$：\n$$\nKH = \\frac{1}{\\sigma_{u}^{2} + r} \\begin{pmatrix} \\sigma_{u}^{2} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v} \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\frac{1}{\\sigma_{u}^{2} + r} \\begin{pmatrix} \\sigma_{u}^{2}  0 \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  0 \\end{pmatrix}\n$$\n接下来，我们计算 $(I - KH)$ 项：\n$$\nI - KH = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{\\sigma_{u}^{2} + r} \\begin{pmatrix} \\sigma_{u}^{2}  0 \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  0 \\end{pmatrix}\n$$\n$$\nI - KH = \\frac{1}{\\sigma_{u}^{2} + r} \\left[ \\begin{pmatrix} \\sigma_{u}^{2} + r  0 \\\\ 0  \\sigma_{u}^{2} + r \\end{pmatrix} - \\begin{pmatrix} \\sigma_{u}^{2}  0 \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  0 \\end{pmatrix} \\right]\n$$\n$$\nI - KH = \\frac{1}{\\sigma_{u}^{2} + r} \\begin{pmatrix} r  0 \\\\ -\\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{u}^{2} + r \\end{pmatrix}\n$$\n现在我们可以通过将 $(I-KH)$ 右乘 $B$ 来计算分析误差协方差 $A$：\n$$\nA = (I - KH)B = \\frac{1}{\\sigma_{u}^{2} + r} \\begin{pmatrix} r  0 \\\\ -\\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{u}^{2} + r \\end{pmatrix} \\begin{pmatrix} \\sigma_{u}^{2}  \\rho\\,\\sigma_{u}\\sigma_{v} \\\\ \\rho\\,\\sigma_{u}\\sigma_{v}  \\sigma_{v}^{2} \\end{pmatrix}\n$$\n$v$ 的分析误差方差是元素 $A_{22}$，即矩阵 $A$ 的第二个对角元素。我们可以通过将 $(I-KH)$ 的第二行乘以 $B$ 的第二列来计算这个元素：\n$$\nA_{22} = \\frac{1}{\\sigma_{u}^{2} + r} \\left[ (-\\rho\\,\\sigma_{u}\\sigma_{v})(\\rho\\,\\sigma_{u}\\sigma_{v}) + (\\sigma_{u}^{2} + r)(\\sigma_{v}^{2}) \\right]\n$$\n展开方括号中的项：\n$$\nA_{22} = \\frac{1}{\\sigma_{u}^{2} + r} \\left[ -\\rho^{2}\\sigma_{u}^{2}\\sigma_{v}^{2} + \\sigma_{u}^{2}\\sigma_{v}^{2} + r\\sigma_{v}^{2} \\right]\n$$\n我们可以提取公因式来简化表达式。从括号中的所有项中提取 $\\sigma_{v}^{2}$：\n$$\nA_{22} = \\frac{\\sigma_{v}^{2}}{\\sigma_{u}^{2} + r} \\left[ -\\rho^{2}\\sigma_{u}^{2} + \\sigma_{u}^{2} + r \\right]\n$$\n在括号内提取 $\\sigma_{u}^{2}$：\n$$\nA_{22} = \\frac{\\sigma_{v}^{2}}{\\sigma_{u}^{2} + r} \\left[ \\sigma_{u}^{2}(1 - \\rho^{2}) + r \\right]\n$$\n这可以写成最终的表达式：\n$$\nA_{22} = \\sigma_{v}^{2} \\frac{r + \\sigma_{u}^{2}(1 - \\rho^{2})}{r + \\sigma_{u}^{2}}\n$$\n这个表达式表示经向风分量 $v$ 的分析误差方差。它表明，由于同化了 $u$ 的观测， $v$ 的后验方差从其先验值 $\\sigma_{v}^{2}$ 减小了。这种减小是通过背景误差相关性 $\\rho$ 介导的。如果 $\\rho=0$，则没有相关性，$v$ 的分析方差保持不变，即 $A_{22} = \\sigma_{v}^{2}$。如果相关性是完美的（$\\rho^2 = 1$）且观测是完美的（$r=0$），$v$ 的分析方差将变为 $0$。",
            "answer": "$$\n\\boxed{\\sigma_{v}^{2} \\frac{r + \\sigma_{u}^{2}(1 - \\rho^{2})}{r + \\sigma_{u}^{2}}}\n$$"
        },
        {
            "introduction": "虽然集合预报是估计流依赖背景误差的主要工具，但有限的集合成员数量会导致一个严重问题：秩亏陷。这意味着集合估计的协方差矩阵在状态空间的许多方向上错误地假定误差为零。本练习介绍了一种强大的解决方案——混合协方差方法，它将流依赖的集合分量与静态的气候学分量相结合。通过构建一个混合协方差矩阵并计算其“有效秩”，您将探索这种技术如何有效缓解秩亏陷问题，从而在实践中构建出更稳健、更全面的背景误差模型。",
            "id": "4043344",
            "problem": "考虑一种用于数值天气预报数据同化的混合背景误差协方差，它结合了流依赖的集合分量和静态的气候分量，以表示模式误差并减轻采样不足。设状态维数为 $m=4$，集合大小为 $N=3$。集合扰动矩阵 $X \\in \\mathbb{R}^{4 \\times 3}$ 的列和为零，其形式为\n$$\nX = \\begin{pmatrix}\n1  0  -1 \\\\\n0  1  -1 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n基于集合的背景协方差近似为\n$$\nB_{e} \\approx \\frac{1}{N-1} X X^{T},\n$$\n静态（气候）分量为\n$$\nB_{s} = 2 I_{4},\n$$\n其中 $I_{4}$ 是 $4 \\times 4$ 的单位矩阵。定义混合协方差为\n$$\nB_{h} = \\alpha B_{e} + (1-\\alpha) B_{s},\n$$\n其中 $\\alpha = 0.6$。使用有效秩的光谱熵定义，其中有效秩 $r_{\\mathrm{e}}$ 由下式给出\n$$\nr_{\\mathrm{e}} = \\exp\\!\\left( -\\sum_{i=1}^{m} p_{i} \\ln p_{i} \\right),\n$$\n且 $p_{i} = \\lambda_{i} / \\sum_{j=1}^{m} \\lambda_{j}$ 是 $B_{h}$ 的归一化特征值，计算 $B_{h}$ 的 $r_{\\mathrm{e}}$。将最终答案四舍五入至四位有效数字，并以无量纲量的形式报告。然后，简要讨论为什么以及如何通过引入静态分量来缓解流依赖集合协方差的秩亏问题。",
            "solution": "求解过程分为以下几个步骤：\n1.  计算基于集合的背景误差协方差矩阵 $B_e$。\n2.  计算混合背景误差协方差矩阵 $B_h$。\n3.  确定 $B_h$ 的特征值。\n4.  计算归一化特征值 $p_i$。\n5.  使用光谱熵定义计算有效秩 $r_e$。\n6.  讨论静态协方差分量的作用。\n\n步骤 1：计算 $B_e$\n基于集合的协方差 $B_e$ 由 $B_{e} = \\frac{1}{N-1} X X^{T}$ 给出。当 $N=3$ 时，前置因子为 $\\frac{1}{2}$。\n集合扰动矩阵为 $X = \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$。其转置为 $X^T = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ -1  -1  0  0 \\end{pmatrix}$。\n乘积 $X X^T$ 为：\n$$\nX X^{T} = \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ -1  -1  0  0 \\end{pmatrix} = \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n因此，$B_e$ 为：\n$$\nB_{e} = \\frac{1}{2} \\begin{pmatrix} 2  1  0  0 \\\\ 1  2  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  0  0 \\\\ \\frac{1}{2}  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n\n步骤 2：计算 $B_h$\n混合协方差 $B_h$ 定义为 $B_{h} = \\alpha B_{e} + (1-\\alpha) B_{s}$。\n给定 $\\alpha = 0.6$，则 $1-\\alpha = 0.4$。静态分量为 $B_s = 2I_4$。\n$$\nB_{h} = 0.6 \\begin{pmatrix} 1  \\frac{1}{2}  0  0 \\\\ \\frac{1}{2}  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} + 0.4 \\begin{pmatrix} 2  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  2  0 \\\\ 0  0  0  2 \\end{pmatrix}\n$$\n$$\nB_{h} = \\begin{pmatrix} 0.6  0.3  0  0 \\\\ 0.3  0.6  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0.8  0  0  0 \\\\ 0  0.8  0  0 \\\\ 0  0  0.8  0 \\\\ 0  0  0  0.8 \\end{pmatrix} = \\begin{pmatrix} 1.4  0.3  0  0 \\\\ 0.3  1.4  0  0 \\\\ 0  0  0.8  0 \\\\ 0  0  0.8  0 \\end{pmatrix}\n$$\n\n步骤 3：求 $B_h$ 的特征值\n矩阵 $B_h$ 是块对角矩阵，所以其特征值是其对角块的特征值。\n右下角的 $2 \\times 2$ 块是 $0.8 I_2$，它有两个特征值：$\\lambda_3 = 0.8$ 和 $\\lambda_4 = 0.8$。\n左上角的 $2 \\times 2$ 块是 $A = \\begin{pmatrix} 1.4  0.3 \\\\ 0.3  1.4 \\end{pmatrix}$。其特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n(1.4 - \\lambda)^{2} - (0.3)^{2} = 0 \\implies 1.4 - \\lambda = \\pm 0.3\n$$\n这得到两个特征值：\n$\\lambda_1 = 1.4 + 0.3 = 1.7$\n$\\lambda_2 = 1.4 - 0.3 = 1.1$\n$B_h$ 的特征值集合为 $\\{\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4\\} = \\{1.7, 1.1, 0.8, 0.8\\}$。\n\n步骤 4：计算归一化特征值 $p_i$\n特征值之和为 $\\sum_{j=1}^{4} \\lambda_j = 1.7 + 1.1 + 0.8 + 0.8 = 4.4$。\n归一化特征值为：\n$p_1 = \\frac{\\lambda_1}{\\sum \\lambda_j} = \\frac{1.7}{4.4} = \\frac{17}{44}$\n$p_2 = \\frac{\\lambda_2}{\\sum \\lambda_j} = \\frac{1.1}{4.4} = \\frac{11}{44}$\n$p_3 = \\frac{\\lambda_3}{\\sum \\lambda_j} = \\frac{0.8}{4.4} = \\frac{8}{44}$\n$p_4 = \\frac{\\lambda_4}{\\sum \\lambda_j} = \\frac{0.8}{4.4} = \\frac{8}{44}$\n\n步骤 5：计算有效秩 $r_e$\n有效秩为 $r_{\\mathrm{e}} = \\exp(-\\sum_{i=1}^{m} p_{i} \\ln p_{i})$。首先，我们计算熵项 $S = -\\sum p_i \\ln p_i$：\n$$\nS = -\\left( \\frac{17}{44} \\ln\\left(\\frac{17}{44}\\right) + \\frac{11}{44} \\ln\\left(\\frac{11}{44}\\right) + 2 \\times \\frac{8}{44} \\ln\\left(\\frac{8}{44}\\right) \\right)\n$$\n数值计算各项：\n$p_1 \\ln p_1 \\approx (0.38636) \\times (-0.95098) \\approx -0.36743$\n$p_2 \\ln p_2 = 0.25 \\ln(0.25) \\approx 0.25 \\times (-1.38629) \\approx -0.34657$\n$p_3 \\ln p_3 + p_4 \\ln p_4 = 2 \\times \\frac{8}{44} \\ln(\\frac{8}{44}) \\approx 2 \\times (0.18182) \\times (-1.70475) \\approx -0.61991$\n将这些项相加得到 $\\sum p_i \\ln p_i \\approx -0.36743 - 0.34657 - 0.61991 \\approx -1.33391$。\n熵为 $S \\approx -(-1.33391) = 1.33391$。\n有效秩为 $r_e = \\exp(S) \\approx \\exp(1.33391) \\approx 3.79585$。\n四舍五入到四位有效数字，$r_e = 3.796$。\n\n关于缓解秩亏问题的讨论：\n流依赖的集合协方差 $B_e$ 是秩亏的，因为它的秩最多是集合大小减一（$N-1=2$），这小于状态维数（$m=4$）。这意味着 $B_e$ 有一个零空间，即一个它表示零误差方差的方向子空间。这严重地将数据同化校正限制在低秩的“集合子空间”内。\n引入静态分量 $B_s = 2I_4$（一个满秩正定矩阵）解决了这个问题。混合协方差 $B_h = \\alpha B_e + (1-\\alpha) B_s$ 是一个半正定矩阵（$B_e$）和一个正定矩阵（$B_s$）的线性组合。对于 $\\alpha \\in(0,1)$，所得到的矩阵 $B_h$ 保证是正定的，因此是满秩的。这是因为在 $B_e$ 中方差为零的任何方向，现在都从 $B_s$ 中被赋予了正方差。在这种情况下，$B_e$ 的两个零特征值在 $B_h$ 中被正特征值所取代，使得 $B_h$ 可逆，并允许在状态空间的所有方向上进行同化更新。我们计算出的有效秩 $r_e \\approx 3.796$，接近满秩 $4$，证实了方差分布在所有维度上，从而缓解了秩亏问题。",
            "answer": "$$\\boxed{3.796}$$"
        }
    ]
}