{
    "hands_on_practices": [
        {
            "introduction": "在数据同化中，一个核心挑战是如何区分预测误差的来源。本练习采用一个简化的线性模型，旨在揭示一个根本性的模糊性问题：如果仅有单个时刻的观测数据，我们无法唯一地确定预测误差是源于不准确的初始条件，还是源于模式动力学本身的缺陷。通过这个思想实验 ，您将理解为何在变分资料同化中，诸如背景误差协方差（$B$）和模式误差协方差（$Q$）这样的先验统计信息对于构建一个适定（well-posed）问题至关重要。",
            "id": "4112127",
            "problem": "考虑一个一维离散时间线性预报模型，以及在最终时刻的单个同位观测。该预报模型根据 $x_{1} = \\alpha x_{0} + \\eta_{0}$ 将状态从初始时间 $t_0$推进到最终时间 $t_1$，其中 $x_{0}$ 是真实的初始状态，$x_{1}$ 是真实的最终状态，$\\alpha \\in \\mathbb{R}$ 且 $\\alpha \\neq 0$ 是已知的线性传播算子，捕捉了时间区间 $[t_0,t_1]$ 上的模型动力学，而 $\\eta_{0}$ 是该区间上的累积模型误差。在 $t_1$ 时刻的同位观测为 $y_{1} = x_{1} + \\epsilon_{1}$，其中 $\\epsilon_{1}$ 是观测误差。假设在分析时刻观测误差可以忽略不计，因此取 $\\epsilon_{1} = 0$。\n\n在四维变分资料同化（4D-Var）中，通常通过最小化一个受模型和观测关系约束的成本函数来估计分析场。在强约束公式（假设模型是完美的四维变分资料同化）中，设置 $\\eta_{0} = 0$。在弱约束公式（允许模型误差的四维变分资料同化）中，将 $\\eta_{0}$ 视为与初始状态一同估计的未知量。假设我们将初始条件表示为 $x_{0} = x_{0}^{b} + \\delta x_{0}$，其中 $x_{0}^{b}$ 是已知的先验（背景），$\\delta x_{0}$ 是未知的初始条件增量。\n\n假设对 $\\delta x_{0}$ 或 $\\eta_{0}$ 没有额外的约束或惩罚项（即没有背景或模型误差正则化），并且 $t_1$ 时刻的观测是唯一的信息。从这些假设和上面给出的线性关系出发，证明在弱约束设置下单次同位观测无法区分初始条件误差 $\\delta x_{0}$ 和模型误差 $\\eta_{0}$。具体来说：\n\n1.  给定 $x_{0}^{b}$ 和 $\\alpha$，推导连接单个观测 $y_{1}$ 与未知量 $\\delta x_{0}$ 和 $\\eta_{0}$ 的线性关系。\n2.  确定精确满足观测的所有 $(\\delta x_{0}, \\eta_{0})$ 对集合的维数，并使用一个标量参数 $\\lambda \\in \\mathbb{R}$ 对该集合进行参数化。\n3.  作为对比，在强约束假设 $\\eta_{0} = 0$ 下，确定精确满足观测的唯一 $\\delta x_{0}$。\n\n将您的最终答案表示为一个行矩阵，其条目按顺序为：第2部分的维数（无单位），您对 $\\delta x_{0}$ 的参数化（用 $\\lambda$ 表示），您对 $\\eta_{0}$ 的参数化（用 $\\lambda$ 表示），以及 $\\delta x_{0}$ 的强约束解。最终答案中不需要进行数值四舍五入，也不需要提供物理单位。",
            "solution": "该问题首先经过严格的验证过程。\n\n### 步骤1：提取已知条件\n给定的关系和定义如下：\n- 预报模型：$x_{1} = \\alpha x_{0} + \\eta_{0}$\n- 观测模型：$y_{1} = x_{1} + \\epsilon_{1}$\n- 初始状态分解：$x_{0} = x_{0}^{b} + \\delta x_{0}$\n- 已知量：线性传播算子 $\\alpha \\in \\mathbb{R}$ 且 $\\alpha \\neq 0$；先验初始状态 $x_{0}^{b}$；观测值 $y_{1}$。\n- 未知量：初始条件增量 $\\delta x_{0}$；模型误差 $\\eta_{0}$。\n- 假设：观测误差 $\\epsilon_{1} = 0$；无背景或模型误差正则化惩罚项。\n- 强约束条件：$\\eta_{0} = 0$。\n- 弱约束条件：$\\eta_{0}$ 是一个未知变量。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题提出了一个简化但标准的线性模型，用于资料同化的研究。强约束和弱约束4D-Var、模型误差、初始条件误差、背景场和观测等概念是数值天气预报和气候建模的基础。该问题在科学上是合理的。\n- **适定性**：该问题的结构旨在展示在特定弱约束条件下解的非唯一性，这是资料同化理论中的一个关键概念点。它要求对这种非唯一性进行数学分析，并将其与强约束下获得的唯一解进行对比。各项任务（推导关系、求解集的维数、提供参数化）在数学上都是明确定义的。\n- **客观性**：该问题使用精确、形式化的数学语言陈述，没有歧义或主观性。\n- **完整性与一致性**：该问题提供了进行所需分析的所有必要信息和约束。条件 $\\alpha \\neq 0$至关重要，并已明确说明。无正则化的假设也已明确说明，这对问题的结果至关重要。整个设定是内部一致的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。这是一个设计精良的学术练习，旨在阐明资料同化中的一个基本概念。将提供完整的解答。\n\n### 求解推导\n\n目标是分析在给定 $t_1$ 时刻的单个观测 $y_1$ 的情况下，初始条件误差 $\\delta x_{0}$ 和模型误差 $\\eta_{0}$ 之间的关系。我们按顺序解决问题的三个部分。\n\n**第1部分：推导线性关系**\n\n我们从给定的模型和观测方程开始：\n1. 预报模型：$x_{1} = \\alpha x_{0} + \\eta_{0}$\n2. 观测模型：$y_{1} = x_{1} + \\epsilon_{1}$\n\n给定观测误差可以忽略不计，因此我们设置 $\\epsilon_{1} = 0$。将此代入观测模型得到：\n$$y_{1} = x_{1}$$\n这意味着 $t_1$ 时刻的观测是对真实状态 $x_1$ 的完美测量。\n\n接下来，我们将此结果代入预报模型方程：\n$$y_{1} = \\alpha x_{0} + \\eta_{0}$$\n问题将初始条件 $x_{0}$ 定义为已知背景（先验）状态 $x_{0}^{b}$ 和未知增量 $\\delta x_{0}$ 的形式：\n$$x_{0} = x_{0}^{b} + \\delta x_{0}$$\n将此 $x_{0}$ 的表达式代入我们的组合方程中，得到：\n$$y_{1} = \\alpha (x_{0}^{b} + \\delta x_{0}) + \\eta_{0}$$\n将传播算子 $\\alpha$ 分配进去，我们得到：\n$$y_{1} = \\alpha x_{0}^{b} + \\alpha \\delta x_{0} + \\eta_{0}$$\n为了分离涉及未知数（$\\delta x_{0}$ 和 $\\eta_{0}$）的项，我们重新整理方程：\n$$\\alpha \\delta x_{0} + \\eta_{0} = y_{1} - \\alpha x_{0}^{b}$$\n这是连接观测 $y_{1}$ 与未知数 $\\delta x_{0}$ 和 $\\eta_{0}$ 的所求线性关系。右边的项 $y_{1} - \\alpha x_{0}^{b}$ 代表新息，即观测与从背景初始状态传播的预报之间的失配。\n\n**第2部分：弱约束解集的维数和参数化**\n\n在弱约束设置中，$\\delta x_{0}$ 和 $\\eta_{0}$ 都被视为待定未知数。控制方程是第1部分推导出的线性关系：\n$$\\alpha \\delta x_{0} + \\eta_{0} = y_{1} - \\alpha x_{0}^{b}$$\n这是一个具有两个未知数 $\\delta x_{0}$ 和 $\\eta_{0}$ 的单线性方程。在解 $(\\delta x_{0}, \\eta_{0})$ 的二维空间中，这个方程定义了一条直线。直线是一维仿射子空间。因此，精确满足观测的所有 $(\\delta x_{0}, \\eta_{0})$ 对集合的维数是 $1$。这表明寻找唯一一对 $(\\delta x_{0}, \\eta_{0})$ 的问题是欠定的。\n\n为了对这个解集进行参数化，我们可以用一个自由参数表示一个未知数，然后求解另一个未知数。我们引入一个标量参数 $\\lambda \\in \\mathbb{R}$，并令初始条件增量为该参数：\n$$\\delta x_{0} = \\lambda$$\n将此代入控制方程，我们可以解出相应的模型误差 $\\eta_{0}$：\n$$\\alpha (\\lambda) + \\eta_{0} = y_{1} - \\alpha x_{0}^{b}$$\n$$\\eta_{0} = y_{1} - \\alpha x_{0}^{b} - \\alpha \\lambda$$\n因此，所有解 $(\\delta x_{0}, \\eta_{0})$ 的集合可以由 $\\lambda \\in \\mathbb{R}$ 参数化为：\n$$(\\delta x_{0}(\\lambda), \\eta_{0}(\\lambda)) = (\\lambda, y_{1} - \\alpha x_{0}^{b} - \\alpha \\lambda)$$\n这个结果表明，对于任意选择的初始条件误差 $\\delta x_{0} = \\lambda$，都存在一个相应的模型误差 $\\eta_{0}$ 能够完美地解释观测。如果没有额外的信息或约束（例如，假设中省略的 $\\delta x_{0}$ 和 $\\eta_{0}$ 的背景误差协方差），就不可能区分这两种误差来源。\n\n**第3部分：强约束解**\n\n在强约束公式中，假设模型是完美的，这意味着模型误差项为零：\n$$\\eta_{0} = 0$$\n我们将此约束代入第1部分推导出的线性关系中：\n$$\\alpha \\delta x_{0} + 0 = y_{1} - \\alpha x_{0}^{b}$$\n$$\\alpha \\delta x_{0} = y_{1} - \\alpha x_{0}^{b}$$\n由于问题规定 $\\alpha \\neq 0$，我们可以通过两边除以 $\\alpha$ 来唯一地解出初始条件增量 $\\delta x_{0}$：\n$$\\delta x_{0} = \\frac{y_{1} - \\alpha x_{0}^{b}}{\\alpha}$$\n这可以简化为：\n$$\\delta x_{0} = \\frac{y_{1}}{\\alpha} - x_{0}^{b}$$\n在强约束假设下，问题变得适定，为初始条件增量产生一个唯一的解，该解确保模型预报与观测完全匹配。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  \\lambda  y_{1} - \\alpha x_{0}^{b} - \\alpha \\lambda  \\frac{y_{1}}{\\alpha} - x_{0}^{b} \\end{pmatrix}}$$"
        },
        {
            "introduction": "本练习探讨了弱约束四维变分（weak-constraint 4D-Var）如何从形式上解决前述的误差归属模糊性问题。通过引入贝叶斯视角，我们将推导出一个关于模式误差的最优估计，该估计巧妙地平衡了“与观测的失配程度”和我们对模式准确性的先验置信度（由 $B$ 和 $Q$ 矩阵量化）。这个推导  清晰地阐明了同化系统如何智能地分配误差，并揭示了强约束（strong-constraint）4D-Var只是弱约束方法中一个假设模式完全可信（即 $Q \\to 0$）的特例。",
            "id": "4112110",
            "problem": "考虑一个在弱约束四维变分 (4D-Var) 数据同化框架下制定的单步标量线性数据同化问题。设真实系统根据带有加性模式误差的线性模式演化，下一时刻的模式状态由 $x_1 = M x_0 + \\eta_0$ 给出。这里，$x_0$ 是初始状态，$\\eta_0$ 是时刻 0 的模式误差。时刻 1 的单个观测由 $y_1 = H x_1 + \\varepsilon_1$ 给出。假设具有以下概率结构：\n- 初始状态的背景（先验）是高斯的：$x_0 \\sim \\mathcal{N}(x_b, B)$。\n- 模式误差是高斯的：$\\eta_0 \\sim \\mathcal{N}(0, Q)$。\n- 观测误差是高斯的：$\\varepsilon_1 \\sim \\mathcal{N}(0, R)$。\n- 随机变量 $x_0$、$\\eta_0$ 和 $\\varepsilon_1$ 相互独立。\n\n在弱约束公式中，控制向量同时包含 $x_0$ 和 $\\eta_0$。从线性高斯模型的贝叶斯定理和上述独立性假设出发，推导以观测 $y_1$为条件的 $\\eta_0$ 的后验均值，并仅用 $y_1$、$H$、$M$、$x_b$、$B$、$Q$ 和 $R$ 表示。将您的最终结果表示为单一的封闭形式解析表达式。然后，简要地用文字解释该后验均值的大小如何反映观测失配与先验模式误差方差 $Q$ 之间的平衡，以及极限情况 $Q \\to 0$ 和 $Q \\to \\infty$ 如何与强约束和弱约束行为相关联。\n\n您的最终答案必须是 $\\eta_0$ 后验均值的单一解析表达式；不需要数值近似或单位。",
            "solution": "用户希望我在弱约束 4D-Var 的设定下解决一个问题。\n\n### 步骤 1：提取已知条件\n- **模式演化：** $x_1 = M x_0 + \\eta_0$。\n- **观测模型：** $y_1 = H x_1 + \\varepsilon_1$。\n- **初始状态的先验：** $x_0 \\sim \\mathcal{N}(x_b, B)$。\n- **模式误差的先验：** $\\eta_0 \\sim \\mathcal{N}(0, Q)$。\n- **观测误差的先验：** $\\varepsilon_1 \\sim \\mathcal{N}(0, R)$。\n- **独立性：** 变量 $x_0$、$\\eta_0$ 和 $\\varepsilon_1$ 相互独立。\n- **控制向量：** 分析旨在同时估计 $x_0$ 和 $\\eta_0$。\n- **目标：** 推导模式误差的后验均值 $\\mathbb{E}[\\eta_0 | y_1]$，并提供定性解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础：** 该问题是线性高斯假设下贝叶斯数据同化的一个典型例子。它构成了卡尔曼滤波和变分方法（4D-Var）的理论基础。这是数值天气预报、海洋学和其他地球物理科学中一个成熟且基础的课题。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。所有必要的概率模型（先验和似然）都已指定，目标是计算后验期望，这对于给定的高斯系统是一个唯一定义的量。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **完整性和一致性：** 所有需要的变量、常数和分布都已提供。没有矛盾之处。\n- **可行性：** 该设置是一个标准的、尽管是简化的（标量、单步）模型，用于理论推导。它是完全可行的。\n\n### 步骤 3：结论和行动\n问题有效。我将继续进行推导和求解。\n\n问题是求解给定观测 $y_1$ 时模式误差 $\\eta_0$ 的后验均值。在线性高斯框架中，后验分布也是高斯的。该后验分布的均值等价于最小化弱约束 4D-Var 代价函数的状态。此代价函数 $J(x_0, \\eta_0)$ 源于后验概率密度函数 $p(x_0, \\eta_0 | y_1)$ 的负对数。\n\n使用贝叶斯定理，$p(x_0, \\eta_0 | y_1) \\propto p(y_1 | x_0, \\eta_0) p(x_0, \\eta_0)$。考虑到先验估计的独立性，$p(x_0, \\eta_0) = p(x_0) p(\\eta_0)$。代价函数是这些概率密度负对数的和（忽略常数项）：\n$J(x_0, \\eta_0) = J_b + J_q + J_o$\n其中：\n- $J_b = (x_0 - x_b)^T B^{-1} (x_0 - x_b)$ 是初始状态的背景项。\n- $J_q = \\eta_0^T Q^{-1} \\eta_0$ 是模式误差惩罚项。\n- $J_o = (y_1 - Hx_1)^T R^{-1} (y_1 - Hx_1)$ 是观测项。\n\n将模式方程 $x_1 = M x_0 + \\eta_0$ 代入 $J_o$ 并写出标量情况下的表达式，总代价函数为：\n$$\nJ(x_0, \\eta_0) = \\frac{1}{2} \\frac{(x_0 - x_b)^2}{B} + \\frac{1}{2} \\frac{\\eta_0^2}{Q} + \\frac{1}{2} \\frac{(y_1 - H(M x_0 + \\eta_0))^2}{R}\n$$\n为了找到后验众数（对于高斯后验分布即为均值），我们必须找到最小化 $J$ 的 $x_0$ 和 $\\eta_0$ 的值。我们通过对 $x_0$ 和 $\\eta_0$ 求偏导数并将其设为零来实现这一点。\n\n关于 $x_0$ 的偏导数为：\n$$\n\\frac{\\partial J}{\\partial x_0} = \\frac{x_0 - x_b}{B} + \\frac{1}{R} (y_1 - H M x_0 - H \\eta_0) (-H M) = 0\n$$\n$$\n\\frac{x_0 - x_b}{B} = \\frac{H M}{R} (y_1 - H M x_0 - H \\eta_0) \\quad (*)$$\n\n关于 $\\eta_0$ 的偏导数为：\n$$\n\\frac{\\partial J}{\\partial \\eta_0} = \\frac{\\eta_0}{Q} + \\frac{1}{R} (y_1 - H M x_0 - H \\eta_0) (-H) = 0\n$$\n$$\n\\frac{\\eta_0}{Q} = \\frac{H}{R} (y_1 - H M x_0 - H \\eta_0) \\quad (**)\n$$\n从方程 $(**)$，我们可以分离出括号中的项：\n$$\ny_1 - H M x_0 - H \\eta_0 = \\frac{R}{H Q} \\eta_0\n$$\n现在，将此结果代回方程 $(*)$：\n$$\n\\frac{x_0 - x_b}{B} = \\frac{H M}{R} \\left( \\frac{R}{H Q} \\eta_0 \\right)\n$$\n$$\n\\frac{x_0 - x_b}{B} = \\frac{M}{Q} \\eta_0\n$$\n这给了我们 $x_0$ 和 $\\eta_0$ 最优校正之间的关系。我们可以用最优的 $\\eta_0$ 来表示最优的 $x_0$：\n$$\nx_0 = x_b + \\frac{M B}{Q} \\eta_0\n$$\n最后，我们将 $x_0$ 的这个表达式代回方程 $(**)$ 来求解 $\\eta_0$。\n$$\n\\frac{\\eta_0}{Q} = \\frac{H}{R} \\left( y_1 - H M \\left( x_b + \\frac{M B}{Q} \\eta_0 \\right) - H \\eta_0 \\right)\n$$\n$$\n\\frac{\\eta_0}{Q} = \\frac{H}{R} \\left( (y_1 - H M x_b) - \\frac{H M^2 B}{Q} \\eta_0 - H \\eta_0 \\right)\n$$\n现在我们将所有含 $\\eta_0$ 的项收集到一边：\n$$\n\\frac{\\eta_0}{Q} + \\frac{H^2 M^2 B}{R Q} \\eta_0 + \\frac{H^2}{R} \\eta_0 = \\frac{H}{R} (y_1 - H M x_b)\n$$\n提出 $\\eta_0$ 的因子：\n$$\n\\eta_0 \\left( \\frac{1}{Q} + \\frac{H^2 M^2 B}{R Q} + \\frac{H^2}{R} \\right) = \\frac{H}{R} (y_1 - H M x_b)\n$$\n为了简化括号中的项，找到公分母 $RQ$：\n$$\n\\eta_0 \\left( \\frac{R + H^2 M^2 B + H^2 Q}{R Q} \\right) = \\frac{H}{R} (y_1 - H M x_b)\n$$\n现在，我们求解 $\\eta_0$：\n$$\n\\eta_0 = \\frac{R Q}{R + H^2 M^2 B + H^2 Q} \\cdot \\frac{H}{R} (y_1 - H M x_b)\n$$\n$$\n\\eta_0 = \\frac{Q H}{R + H^2 M^2 B + H^2 Q} (y_1 - H M x_b)\n$$\n这个表达式是模式误差的后验均值 $\\mathbb{E}[\\eta_0 | y_1]$。\n\n**解释**\n推导出的模式误差后验均值表达式 $\\hat{\\eta}_0 = \\mathbb{E}[\\eta_0 | y_1]$ 揭示了同化系统如何归因模式预报与观测之间的差异。项 $(y_1 - H M x_b)$ 是新息（innovation），或称观测减背景残差，它代表了相对于从背景平均值 $x_b$ 开始的预报，观测 $y_1$ 所提供的新信息。\n\n后验均值 $\\hat{\\eta}_0$ 与此新息成正比。比例系数，或称增益，是 $\\frac{Q H}{H^2 M^2 B + H^2 Q + R}$。这个增益反映了系统中不同不确定性来源之间的平衡：\n1. 分子 $Q H$ 表明，估计的模式误差校正的大小与先验模式误差方差 $Q$ 成正比。较大的 $Q$ 表示对模式完美性的信心较低，使得系统更倾向于将新息归因于模式误差。\n2. 分母 $H^2 M^2 B + H^2 Q + R$ 是新息的总方差。它是传播到观测空间的背景误差方差（$H^2 M^2 B$）、观测空间中的模式误差方差（$H^2 Q$）以及观测误差方差（$R$）之和。因此，估计的模式误差与总不确定性成反比缩放。\n\n**极限情况：**\n- **$Q \\to 0$（强约束极限）：**当模式误差的先验方差趨于零时，我们强制认为模式是完美的。在此极限下，分子 $Q H \\to 0$，导致 $\\hat{\\eta}_0 \\to 0$。系统不会将任何新息归因于模式误差。任何差异都必须仅通过调整初始条件 $x_0$ 来解决。这就是**强约束 4D-Var**的定义。\n\n- **$Q \\to \\infty$（弱约束行为）：**当模式误差的先验方差变得无限大时，我们表示对模式动力学没有信心。为了分析这个极限，我们可以将增益的分子和分母同时除以 $Q$：\n$$\n\\hat{\\eta}_0 = \\frac{H}{\\frac{R}{Q} + \\frac{H^2 M^2 B}{Q} + H^2} (y_1 - H M x_b)\n$$\n当 $Q \\to \\infty$ 时，项 $\\frac{R}{Q}$ 和 $\\frac{H^2 M^2 B}{Q}$ 趋于零，表达式简化为：\n$$\n\\hat{\\eta}_0 \\to \\frac{H}{H^2} (y_1 - H M x_b) = \\frac{1}{H} (y_1 - H M x_b)\n$$\n这意味着 $H \\hat{\\eta}_0 \\to y_1 - H M x_b$。由于模式不可信，分析基本上将时刻 $t_1$ 的状态与初始状态 $x_0$ 解耦。对总模式贡献 $H(M x_0 + \\eta_0)$ 的最佳估计就是观测值 $y_1$（忽略噪声），因此调整模式误差项 $H \\eta_0$ 以解释相对于背景预报 $H M x_b$ 的全部新息。这展示了**弱约束**方法的本质，即模式方程不被严格强制执行。",
            "answer": "$$\\boxed{\\frac{Q H (y_1 - H M x_b)}{H^2 M^2 B + H^2 Q + R}}$$"
        },
        {
            "introduction": "在建立了理论框架之后，本练习提供了一个在具体数值环境中应用这些概念的动手实践机会。您将完整地解决一个强约束四维变分（strong-constraint 4D-Var）问题，从定义代价函数到推导并求解用于修正初始状态的正规方程。这项实践  将巩固您对整个过程的数学机制的理解，并让您对如何找到最优初始条件有一个切实的认识。",
            "id": "4112085",
            "problem": "考虑在强约束设置下的四维变分资料同化（4D-Var），其中假设模型在同化窗口内是完美的。设离散时间线性化动力学由状态转移矩阵 $A_{1}$ 和 $A_{2}$ 给出，因此时间指标为 $k$ 时的状态为 $\\mathbf{x}_{k} = M_{k:0} \\mathbf{x}_{0}$，其中 $M_{1:0} = A_{1}$ 且 $M_{2:0} = A_{2} A_{1}$。假设观测算子 $H$ 为线性算子，且背景误差和观测误差均为加性高斯误差。最大后验估计量通过最小化一个由背景和观测误差协方差构建的最小二乘代价函数来获得。\n\n给定以下具体数值实例：\n- 状态维数为 $n = 2$，观测算子为 $H = I$。\n- 背景状态为 $\\mathbf{x}_{b} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，背景误差协方差为 $B = \\sigma_{b}^{2} I$，其中 $\\sigma_{b}^{2} = 4$。\n- 同化两个观测时间 $k = 1, 2$。观测误差协方差分别为 $R_{1} = \\sigma_{r,1}^{2} I$（其中 $\\sigma_{r,1}^{2} = 1$）和 $R_{2} = \\sigma_{r,2}^{2} I$（其中 $\\sigma_{r,2}^{2} = 9$）。\n- 观测值为 $y_{1} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$ 和 $y_{2} = \\begin{pmatrix} 4 \\\\ 2 \\end{pmatrix}$。\n- 线性传播算子为\n$$\nA_{1} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}, \\quad\nA_{2} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n\n从强约束4D-Var的高斯最大后验估计的第一性原理出发，推导初始时刻分析状态 $\\mathbf{x}_{0}^{a}$ 的正规方程，并针对此实例求解。然后计算初始时刻分析增量 $\\delta \\mathbf{x}_{0} = \\mathbf{x}_{0}^{a} - \\mathbf{x}_{b}$。最后，计算欧几里得范数 $\\|\\delta \\mathbf{x}_{0}\\|_{2}$。\n\n所有状态变量都是无量纲的，因此不需要物理单位。请将最终答案表示为 $\\delta \\mathbf{x}_{0}$ 的两个分量及其欧几里得范数，形式为一个单行矩阵。无需四舍五入；给出精确值。",
            "solution": "用户希望解决一个强约束4D-Var资料同化问题。\n\n### 第一步：提取已知条件\n\n-   **状态维数**：$n = 2$。\n-   **线性观测算子**：$H = I$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n-   **背景状态**：$\\mathbf{x}_{b} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n-   **背景误差协方差**：$B = \\sigma_{b}^{2} I$，其中 $\\sigma_{b}^{2} = 4$。所以，$B = 4I$。\n-   **观测时间**：$k = 1, 2$。\n-   **$k=1$ 时的观测误差协方差**：$R_{1} = \\sigma_{r,1}^{2} I$，其中 $\\sigma_{r,1}^{2} = 1$。所以，$R_{1} = I$。\n-   **$k=2$ 时的观测误差协方差**：$R_{2} = \\sigma_{r,2}^{2} I$，其中 $\\sigma_{r,2}^{2} = 9$。所以，$R_{2} = 9I$。\n-   **观测值**：$y_{1} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$ 和 $y_{2} = \\begin{pmatrix} 4 \\\\ 2 \\end{pmatrix}$。\n-   **线性传播算子（状态转移矩阵）**：\n    $A_{1} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$，$A_{2} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$。\n-   **模型动力学**：$k$ 时刻的状态 $\\mathbf{x}_k$ 与初始状态 $\\mathbf{x}_0$ 的关系为 $\\mathbf{x}_{k} = M_{k:0} \\mathbf{x}_{0}$，其中 $M_{1:0} = A_{1}$ 且 $M_{2:0} = A_{2} A_{1}$。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题是贝叶斯估计理论（特别是线性高斯系统的最大后验估计）在资料同化领域的标准应用，代表了一个教科书式的强约束4D-Var场景。这在科学上是合理的。\n-   **适定性**：问题提供了唯一确定代价函数所需的所有信息（状态、算子、协方差）。所产生的正规方程构成一个线性系统，预期有唯一解，因为其Hessian矩阵通常是正定的。\n-   **客观性**：问题以精确的数学语言陈述，没有主观或模糊的术语。\n-   **完整性**：所有必需的矩阵、向量和常数都已提供。问题是自洽的。\n-   **一致性**：所有矩阵和向量的维数对于所需的操作是一致的（例如，$A_1$、$A_2$、$\\mathbf{x}_b$、$y_1$、$y_2$都与$n=2$的状态维数兼容）。\n\n### 第三步：结论与操作\n该问题有效。我现在将进行求解。\n\n### 求解推导\n\n强约束4D-Var旨在找到最小化代价函数 $J(\\mathbf{x}_0)$ 的初始状态 $\\mathbf{x}_0$。该代价函数衡量了从 $\\mathbf{x}_0$ 开始的模型轨迹与可用信息（背景状态 $\\mathbf{x}_b$ 和观测值 $y_k$）之间的失配。假设误差为高斯分布，这等价于找到 $\\mathbf{x}_0$ 的最大后验估计。代价函数是背景项 $J_b$ 和观测项 $J_o$ 的和：\n$$J(\\mathbf{x}_0) = J_b(\\mathbf{x}_0) + J_o(\\mathbf{x}_0)$$\n其中\n$$J_b(\\mathbf{x}_0) = \\frac{1}{2} (\\mathbf{x}_0 - \\mathbf{x}_b)^T B^{-1} (\\mathbf{x}_0 - \\mathbf{x}_b)$$\n$$J_o(\\mathbf{x}_0) = \\frac{1}{2} \\sum_{k=1}^{2} (H_k \\mathbf{x}_k - y_k)^T R_k^{-1} (H_k \\mathbf{x}_k - y_k)$$\n由于模型是强约束，我们有 $\\mathbf{x}_k = M_{k:0} \\mathbf{x}_0$。对于所有 $k$，观测算子 $H_k = H = I$。代价函数变为：\n$$J(\\mathbf{x}_0) = \\frac{1}{2} (\\mathbf{x}_0 - \\mathbf{x}_b)^T B^{-1} (\\mathbf{x}_0 - \\mathbf{x}_b) + \\frac{1}{2} \\sum_{k=1}^{2} (M_{k:0} \\mathbf{x}_0 - y_k)^T R_k^{-1} (M_{k:0} \\mathbf{x}_0 - y_k)$$\n为了找到最小化 $J(\\mathbf{x}_0)$ 的分析状态 $\\mathbf{x}_0^a$，我们计算 $J$ 相对于 $\\mathbf{x}_0$ 的梯度并将其设为零：\n$$\\nabla_{\\mathbf{x}_0} J(\\mathbf{x}_0) = B^{-1}(\\mathbf{x}_0 - \\mathbf{x}_b) + \\sum_{k=1}^{2} M_{k:0}^T R_k^{-1} (M_{k:0} \\mathbf{x}_0 - y_k) = 0$$\n整理各项以求解分析状态 $\\mathbf{x}_0^a$：\n$$\\left( B^{-1} + \\sum_{k=1}^{2} M_{k:0}^T R_k^{-1} M_{k:0} \\right) \\mathbf{x}_0^a = B^{-1}\\mathbf{x}_b + \\sum_{k=1}^{2} M_{k:0}^T R_k^{-1} y_k$$\n这是一个形如 $P \\mathbf{x}_0^a = q$ 的线性系统，即正规方程。\n\n首先，我们计算必要的矩阵及其逆矩阵：\n-   $B = 4I \\implies B^{-1} = \\frac{1}{4}I = \\begin{pmatrix} 1/4  0 \\\\ 0  1/4 \\end{pmatrix}$\n-   $R_1 = 1I \\implies R_1^{-1} = I$\n-   $R_2 = 9I \\implies R_2^{-1} = \\frac{1}{9}I$\n-   $M_{1:0} = A_1 = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$\n-   $M_{2:0} = A_2 A_1 = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2  2 \\\\ 0  1 \\end{pmatrix}$\n\n接下来，我们计算Hessian矩阵 $P = B^{-1} + M_{1:0}^T R_1^{-1} M_{1:0} + M_{2:0}^T R_2^{-1} M_{2:0}$：\n-   $M_{1:0}^T R_1^{-1} M_{1:0} = A_1^T I A_1 = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix}$\n-   $M_{2:0}^T R_2^{-1} M_{2:0} = M_{2:0}^T (\\frac{1}{9}I) M_{2:0} = \\frac{1}{9} \\begin{pmatrix} 2  0 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 2  2 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 4  4 \\\\ 4  5 \\end{pmatrix} = \\begin{pmatrix} 4/9  4/9 \\\\ 4/9  5/9 \\end{pmatrix}$\n-   $P = \\begin{pmatrix} 1/4  0 \\\\ 0  1/4 \\end{pmatrix} + \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} + \\begin{pmatrix} 4/9  4/9 \\\\ 4/9  5/9 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}+1+\\frac{4}{9}  1+\\frac{4}{9} \\\\ 1+\\frac{4}{9}  \\frac{1}{4}+2+\\frac{5}{9} \\end{pmatrix}$\n-   $P = \\begin{pmatrix} \\frac{9+36+16}{36}  \\frac{9+4}{9} \\\\ \\frac{9+4}{9}  \\frac{9+72+20}{36} \\end{pmatrix} = \\begin{pmatrix} \\frac{61}{36}  \\frac{13}{9} \\\\ \\frac{13}{9}  \\frac{101}{36} \\end{pmatrix} = \\frac{1}{36}\\begin{pmatrix} 61  52 \\\\ 52  101 \\end{pmatrix}$\n\n现在，我们计算右端项向量 $q = B^{-1}\\mathbf{x}_b + M_{1:0}^T R_1^{-1} y_1 + M_{2:0}^T R_2^{-1} y_2$：\n-   $B^{-1}\\mathbf{x}_b = \\frac{1}{4} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ -1/4 \\end{pmatrix}$\n-   $M_{1:0}^T R_1^{-1} y_1 = A_1^T I y_1 = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$\n-   $M_{2:0}^T R_2^{-1} y_2 = M_{2:0}^T (\\frac{1}{9}I) y_2 = \\frac{1}{9} \\begin{pmatrix} 2  0 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 8 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} 8/9 \\\\ 10/9 \\end{pmatrix}$\n-   $q = \\begin{pmatrix} \\frac{1}{4}+3+\\frac{8}{9} \\\\ -\\frac{1}{4}+4+\\frac{10}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{9+108+32}{36} \\\\ \\frac{-9+144+40}{36} \\end{pmatrix} = \\begin{pmatrix} \\frac{149}{36} \\\\ \\frac{175}{36} \\end{pmatrix} = \\frac{1}{36}\\begin{pmatrix} 149 \\\\ 175 \\end{pmatrix}$\n\n我们求解系统 $P \\mathbf{x}_0^a = q$：\n$\\frac{1}{36}\\begin{pmatrix} 61  52 \\\\ 52  101 \\end{pmatrix} \\mathbf{x}_0^a = \\frac{1}{36}\\begin{pmatrix} 149 \\\\ 175 \\end{pmatrix} \\implies \\begin{pmatrix} 61  52 \\\\ 52  101 \\end{pmatrix} \\mathbf{x}_0^a = \\begin{pmatrix} 149 \\\\ 175 \\end{pmatrix}$\n为了求 $\\mathbf{x}_0^a$，我们对矩阵求逆。行列式为 $\\det(P_{36}) = (61)(101) - (52)(52) = 6161 - 2704 = 3457$。\n逆矩阵是 $\\frac{1}{3457}\\begin{pmatrix} 101  -52 \\\\ -52  61 \\end{pmatrix}$。\n$$\\mathbf{x}_0^a = \\frac{1}{3457}\\begin{pmatrix} 101  -52 \\\\ -52  61 \\end{pmatrix} \\begin{pmatrix} 149 \\\\ 175 \\end{pmatrix} = \\frac{1}{3457}\\begin{pmatrix} (101)(149) - (52)(175) \\\\ (-52)(149) + (61)(175) \\end{pmatrix}$$\n$$\\mathbf{x}_0^a = \\frac{1}{3457}\\begin{pmatrix} 15049 - 9100 \\\\ -7748 + 10675 \\end{pmatrix} = \\frac{1}{3457}\\begin{pmatrix} 5949 \\\\ 2927 \\end{pmatrix}$$\n分析状态为 $\\mathbf{x}_0^a = \\begin{pmatrix} 5949/3457 \\\\ 2927/3457 \\end{pmatrix}$。\n\n初始时刻分析增量为 $\\delta \\mathbf{x}_0 = \\mathbf{x}_0^a - \\mathbf{x}_b$：\n$$\\delta \\mathbf{x}_0 = \\begin{pmatrix} \\frac{5949}{3457} \\\\ \\frac{2927}{3457} \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5949-3457}{3457} \\\\ \\frac{2927+3457}{3457} \\end{pmatrix} = \\begin{pmatrix} \\frac{2492}{3457} \\\\ \\frac{6384}{3457} \\end{pmatrix}$$\n增量的两个分量是 $\\delta x_{0,1} = \\frac{2492}{3457}$ 和 $\\delta x_{0,2} = \\frac{6384}{3457}$。\n\n最后，我们计算欧几里得范数 $\\|\\delta \\mathbf{x}_0\\|_2$：\n$$\\|\\delta \\mathbf{x}_0\\|_2^2 = \\left(\\frac{2492}{3457}\\right)^2 + \\left(\\frac{6384}{3457}\\right)^2 = \\frac{2492^2 + 6384^2}{3457^2}$$\n$$2492^2 = 6210064$$\n$$6384^2 = 40755456$$\n$$\\|\\delta \\mathbf{x}_0\\|_2^2 = \\frac{6210064 + 40755456}{3457^2} = \\frac{46965520}{3457^2}$$\n范数是该值的平方根：\n$$\\|\\delta \\mathbf{x}_0\\|_2 = \\frac{\\sqrt{46965520}}{3457}$$\n我们可以化简平方根下的项：$46965520 = 16 \\times 2935345$。\n$$\\|\\delta \\mathbf{x}_0\\|_2 = \\frac{\\sqrt{16 \\times 2935345}}{3457} = \\frac{4\\sqrt{2935345}}{3457}$$\n所要求的三个值是 $\\delta \\mathbf{x}_0$ 的分量及其范数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2492}{3457}  \\frac{6384}{3457}  \\frac{4\\sqrt{2935345}}{3457}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}