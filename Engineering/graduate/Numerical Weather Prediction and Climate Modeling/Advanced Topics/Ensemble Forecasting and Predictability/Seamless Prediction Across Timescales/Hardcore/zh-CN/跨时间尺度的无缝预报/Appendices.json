{
    "hands_on_practices": [
        {
            "introduction": "在无缝隙预测模型中，一个核心的数值挑战是如何高效地处理具有巨大时间尺度差异的物理过程，例如快速传播的重力波和缓慢的平流运动。本练习将引导你分析和比较两种时间积分方案，以揭示隐式-显式（IMEX）方法的优势。通过亲自推导，你将理解为什么对不同过程采用不同处理方式（对快速波进行隐式处理，对慢速平流进行显式处理）能够突破严格的CFL条件限制，从而在保证稳定性的前提下实现更高的计算效率，这是现代数值模型设计的基石之一。",
            "id": "4086415",
            "problem": "使用 Arakawa C-网格上的一维、周期性、线性化浅水系统来表示与数值天气预报和气候模拟中跨时间尺度的无缝预测相关的快重力波和慢平流运动。设自由表面高度为 $\\,\\eta_j(t)\\,$，定义在整数索引 $\\,j\\,$ 上；速度为 $\\,u_{j+1/2}(t)\\,$，定义在半整数索引 $\\,j+1/2\\,$ 上。围绕均匀平均深度 $\\,H>0\\,$ 和均匀平均纬向流 $\\,U\\,$ 线性化的控制方程为\n$$\n\\eta_t + U\\,\\eta_x + H\\,u_x = 0,\\qquad u_t + U\\,u_x + g\\,\\eta_x = 0,\n$$\n其中 $\\,g>0\\,$ 是重力加速度，重力波相速度为 $\\,c=\\sqrt{gH}\\,$。网格具有均匀间距 $\\,\\Delta x\\,$ 和周期性边界条件。\n\nA 部分 (显式重力波动力学)：忽略平流项 (令 $\\,U=0\\,$)，并使用 Arakawa C-网格上的前向-后向时间步进格式对剩余的快线性重力波系统进行离散化：\n- 对于质量方程，对 $\\,u_x\\,$ 使用一个前向欧拉步和 C-网格中心差分，即\n$$\n\\eta^{n+1}_j \\;=\\; \\eta^n_j \\;-\\; \\Delta t\\,H\\,\\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x}.\n$$\n- 对于动量方程，使用一个后向欧拉步，通过 C-网格中心差分在半点上对 $\\,\\eta_x\\,$ 进行隐式处理，即\n$$\nu^{n+1}_{j+1/2} \\;=\\; u^n_{j+1/2} \\;-\\; \\Delta t\\,g\\,\\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x}.\n$$\n使用与交错网格一致的标准 von Neumann (傅里叶) 稳定性分析，推导 $\\,\\Delta t\\,$ 的稳定性条件，并用 $\\,\\Delta x\\,$ 和 $\\,c\\,$ 表示重力波动力学的最大稳定显式时间步长。\n\nB 部分 (隐式-显式方案)：现在考虑 $\\,U\\neq 0\\,$ 的完整线性化系统。设计一个隐式-显式 (IMEX) 格式，该格式在与上述相同的 Arakawa C-网格算子上，使用后向欧拉 (隐式) 处理快重力波耦合项 $\\,H\\,u_x\\,$ 和 $\\,g\\,\\eta_x\\,$，同时使用适用于 $\\,U\\,$ 符号的一阶迎风差分，通过前向欧拉 (显式) 处理慢平流项 $\\,U\\,\\eta_x\\,$ 和 $\\,U\\,u_x\\,$。使用 von Neumann 分析证明，对重力波项的隐式处理消除了重力波的 Courant–Friedrichs–Lewy (CFL) 限制，且稳定性转而由平流 CFL 条件控制。用 $\\,\\Delta x\\,$ 和 $\\,U\\,$ 表示 IMEX 格式的最大稳定时间步长。\n\n答案说明：\n- 将 A 部分的最大稳定显式重力波时间步长和 B 部分的最大稳定 IMEX 时间步长作为一个依赖于 $\\,c\\,$、$\\,U\\,$ 和 $\\,\\Delta x\\,$ 的单个闭式解析表达式对提供。\n- 以秒为单位表示最终答案。\n- 无需进行数值代入；不要四舍五入。",
            "solution": "这个问题要求推导应用于一维线性化浅水方程的两种不同数值格式的稳定性条件。我们将对两个部分都使用 von Neumann 稳定性分析方法。\n\nA 部分：重力波的显式前向-后向格式\n\n平均平流项设为零（$U=0$）后的线性化浅水方程为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g \\frac{\\partial \\eta}{\\partial x} = 0\n$$\n问题指定了在 Arakawa C-网格上的前向-后向时间步进格式：\n$$\n\\frac{\\eta^{n+1}_j - \\eta^n_j}{\\Delta t} = -H \\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x} \\quad (1)\n$$\n$$\n\\frac{u^{n+1}_{j+1/2} - u^n_{j+1/2}}{\\Delta t} = -g \\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x} \\quad (2)\n$$\n对于 von Neumann 分析，我们为高度 $\\eta$ 和速度 $u$ 引入傅里叶模态解。由于是交错网格，拟设解为：\n$$\n\\eta^n_j = \\hat{\\eta}^n(k) e^{i k j \\Delta x}\n$$\n$$\nu^n_{j+1/2} = \\hat{u}^n(k) e^{i k (j+1/2) \\Delta x}\n$$\n其中 $k$ 是波数，$i=\\sqrt{-1}$，$\\hat{\\eta}^n$ 和 $\\hat{u}^n$ 是时间步 $n$ 时的傅里叶振幅。将这些代入方程 $(1)$ 和 $(2)$：\n\n由 $(1)$ 得：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} e^{i k j \\Delta x} = - \\frac{H}{\\Delta x} \\left( \\hat{u}^n e^{i k (j+1/2) \\Delta x} - \\hat{u}^n e^{i k (j-1/2) \\Delta x} \\right)\n$$\n除以 $e^{i k j \\Delta x}$：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} = - \\frac{H \\hat{u}^n}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i H \\hat{u}^n}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{\\eta}^{n+1} = \\hat{\\eta}^n - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n \\quad (3)\n$$\n\n由 $(2)$ 得：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} e^{i k (j+1/2) \\Delta x} = - \\frac{g}{\\Delta x} \\left( \\hat{\\eta}^{n+1} e^{i k (j+1) \\Delta x} - \\hat{\\eta}^{n+1} e^{i k j \\Delta x} \\right)\n$$\n除以 $e^{i k (j+1/2) \\Delta x}$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = - \\frac{g \\hat{\\eta}^{n+1}}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i g \\hat{\\eta}^{n+1}}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{u}^{n+1} = \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\quad (4)\n$$\n为了找到放大因子 $\\lambda$，我们寻求一个关于单个变量的递推关系。从 $(3)$ 中，我们可以用 $n$ 和 $n+1$ 步的 $\\hat{\\eta}$ 来表示 $\\hat{u}^n`。然后，将 $(4)$ 推进一个时间步即可代入。一个更直接的方法是将 $(3)$ 推进一个时间步到 $n+2$：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^{n+1}\n$$\n从 $(4)$ 代入 $\\hat{u}^{n+1}$：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\left[ \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\right]\n$$\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\left( \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) \\hat{u}^n - \\frac{4 \\Delta t^2 g H}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\n从 $(3)$，我们替换含有 $\\hat{u}^n$ 的项：\n$$\n- \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n = \\hat{\\eta}^{n+1} - \\hat{\\eta}^n\n$$\n将此代入关于 $\\hat{\\eta}^{n+2}$ 的方程：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} + (\\hat{\\eta}^{n+1} - \\hat{\\eta}^n) - \\frac{4 c^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\n其中 $c^2 = gH$。令 $K = \\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2$。递推关系是：\n$$\n\\hat{\\eta}^{n+2} - (2-K)\\hat{\\eta}^{n+1} + \\hat{\\eta}^n = 0\n$$\n假设解的形式为 $\\hat{\\eta}^n = \\lambda^n$，我们得到放大因子 $\\lambda$ 的特征方程：\n$$\n\\lambda^2 - (2-K)\\lambda + 1 = 0\n$$\n为使格式稳定，根 $\\lambda$ 的模不得超过 $1$，即 $|\\lambda| \\le 1$。根由二次公式给出：\n$$\n\\lambda = \\frac{(2-K) \\pm \\sqrt{(2-K)^2 - 4}}{2} = \\frac{2-K \\pm \\sqrt{K^2 - 4K}}{2}\n$$\n如果判别式为负或零，$K^2 - 4K \\le 0 \\implies K(K-4) \\le 0$。由于 $K \\ge 0$，这意味着 $0 \\le K \\le 4$。在这种情况下，根是共轭复数，并且 $|\\lambda|^2 = \\left(\\frac{2-K}{2}\\right)^2 + \\frac{4K-K^2}{4} = \\frac{4-4K+K^2+4K-K^2}{4} = 1$\n因此，对于 $0 \\le K \\le 4$，我们有 $|\\lambda|=1$，格式是中性稳定的。如果 $K > 4$，根是实数且其乘积为 $1$。它们的和是 $2-K  -2$，这意味着一个根必须小于 $-1$，使得格式不稳定。\n稳定性条件是 $K \\le 4$：\n$$\n\\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 \\le 4 \\implies \\frac{c \\Delta t}{\\Delta x} \\left|\\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right| \\le 1\n$$\n这个条件必须对所有可能的波数 $k$ 成立。最严格的情况发生在 $\\left|\\sin(k \\Delta x/2)\\right|$ 达到最大值时，即 $1$（在奈奎斯特波数 $k = \\pi/\\Delta x$ 处）。因此，稳定性条件简化为重力波的 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\frac{c \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{c}\n$$\nA 部分的最大稳定时间步长是 $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{c}$。\n\nB 部分：隐式-显式 (IMEX) 格式\n\n现在我们考虑 $U \\neq 0$ 的完整系统。IMEX 格式使用一阶迎风差分显式处理平流项，并隐式处理重力波项。对于 $U0$，迎风差分为 $(\\partial_x f)_j \\approx (f_j - f_{j-1})/\\Delta x$。离散化方程为：\n$$\n\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + U \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} + H \\frac{u_{j+1/2}^{n+1} - u_{j-1/2}^{n+1}}{\\Delta x} = 0\n$$\n$$\n\\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^n}{\\Delta t} + U \\frac{u_{j+1/2}^n - u_{j-1/2}^n}{\\Delta x} + g \\frac{\\eta_{j+1}^{n+1} - \\eta_j^{n+1}}{\\Delta x} = 0\n$$\n应用相同的傅里叶拟设解：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{\\eta}^n(1 - e^{-ik\\Delta x}) + \\frac{H}{\\Delta x}\\hat{u}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{u}^n(1 - e^{-ik\\Delta x}) + \\frac{g}{\\Delta x}\\hat{\\eta}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n令 $\\mathbf{v}^n = [\\hat{\\eta}^n, \\hat{u}^n]^T$。该系统可以写成矩阵形式 $\\mathbf{M} \\mathbf{v}^{n+1} = \\mathbf{N} \\mathbf{v}^n$：\n$$\n\\begin{pmatrix} 1  \\frac{2i\\Delta t H}{\\Delta x} S \\\\ \\frac{2i\\Delta t g}{\\Delta x} S  1 \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n+1} \\\\ \\hat{u}^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})  0 \\\\ 0  1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x}) \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n} \\\\ \\hat{u}^{n} \\end{pmatrix}\n$$\n其中 $S = \\sin(k\\Delta x/2)$。放大矩阵为 $G = \\mathbf{M}^{-1}\\mathbf{N}$。\n令 $A_U = 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})$ 为显式迎风平流格式的放大因子。那么 $\\mathbf{N} = A_U \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n$\\mathbf{M}$ 的行列式是 $\\det(\\mathbf{M}) = 1 - (i^2) \\frac{4\\Delta t^2 gH}{\\Delta x^2}S^2 = 1 + \\frac{4c^2\\Delta t^2}{\\Delta x^2}S^2 = 1 + K_c$，其中 $K_c = K$ 来自 A 部分。\n$G$ 的特征值 $\\lambda_G$ 是 $A_U$ 与 $\\mathbf{M}^{-1}$ 特征值的乘积。$\\mathbf{M}$ 的特征值是 $1 \\pm \\sqrt{-K_c} = 1 \\pm i\\sqrt{K_c}$。因此，$\\mathbf{M}^{-1}$ 的特征值是 $\\frac{1}{1 \\pm i\\sqrt{K_c}} = \\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}$。\n完整放大矩阵 $G$ 的特征值是 $\\lambda_G = A_U \\left(\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right)$。\n为保证稳定性，我们要求 $|\\lambda_G| \\le 1$。\n$$\n|\\lambda_G|^2 = |A_U|^2 \\left|\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right|^2 = |A_U|^2 \\frac{1+K_c}{(1+K_c)^2} = \\frac{|A_U|^2}{1+K_c}\n$$\n稳定性条件是 $\\frac{|A_U|^2}{1+K_c} \\le 1$，或 $|A_U|^2 \\le 1+K_c$。\n由于 $K_c = (\\frac{2c\\Delta t}{\\Delta x}\\sin(\\frac{k\\Delta x}{2}))^2 \\ge 0$，我们有 $1+K_c \\ge 1$。这意味着对重力波项的隐式处理具有稳定化效应。正如问题所暗示的，稳定性由显式平流项控制。稳定性的一个充分条件是 $|A_U| \\le 1$，因为这将意味着 $|A_U|^2 \\le 1 \\le 1+K_c$。\n我们来分析 $|A_U| \\le 1$。令 $\\alpha = U\\Delta t/\\Delta x$ (平流库朗数) 和 $\\theta=k\\Delta x$。\n$$\nA_U = 1 - \\alpha(1-\\cos\\theta+i\\sin\\theta)\n$$\n$$\n|A_U|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta\n$$\n$$\n|A_U|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-2\\cos\\theta+\\cos^2\\theta+\\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + 2\\alpha^2(1-\\cos\\theta)\n$$\n$$\n|A_U|^2 = 1 + 2\\alpha(\\alpha-1)(1-\\cos\\theta)\n$$\n为了稳定性，$|A_U|^2 \\le 1$，这要求 $2\\alpha(\\alpha-1)(1-\\cos\\theta) \\le 0$。\n由于 $\\alpha = U\\Delta t/\\Delta x  0$ 且 $1-\\cos\\theta \\ge 0$，该不等式当且仅当 $\\alpha-1 \\le 0$ 时成立，即 $\\alpha \\le 1$。\n对于 $U0$ 的分析将涉及迎风格式的前向空间差分，导致条件 $|U|\\Delta t/\\Delta x \\le 1$。因此，稳定性通常由平流 CFL 条件决定。\n$$\n\\frac{|U|\\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{|U|}\n$$\nIMEX 格式的最大稳定时间步长为 $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{|U|}$。这成功地消除了对快重力波速度 $c$ 的依赖。\n\n结合结果，A 部分和 B 部分的最大稳定时间步长对是 $(\\frac{\\Delta x}{c}, \\frac{\\Delta x}{|U|})$。这些表达式按要求以秒为单位。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Delta x}{c}  \\frac{\\Delta x}{|U|}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从数值方法转向可预报性的物理来源，气候系统的“记忆”是实现从天气预报到次季节尺度预测的关键。其中，海洋混合层的热惯性是一个主要的记忆载体，它能将大气的短期影响“储存”起来，并以较慢的时间尺度释放，从而为长期预报提供依据。本练习要求你从一个简化的海洋混合层热量收支模型出发，推导海温异常的e折衰减时间。这个过程将物理属性（海洋的热容量）与可预报性的概念直接联系起来，让你亲身体会可预报性的物理基础。",
            "id": "4086435",
            "problem": "考虑一个简化的海洋混合层整体模型，该模型用于数值天气预报和气候建模，以评估跨时间尺度的无缝预测。设海洋混合层的厚度 $h$ 恒定，其受到表面热通量和底部夹卷作用的影响。定义海表温度（SST）异常 $T'(t)$ 为相对于气候平均值的偏差，并假设在次季节时间尺度上水平平流可以忽略不计。混合层的热含量遵循能量守恒：海水密度 $\\rho_w$、定压比热容 $c_p$ 和混合层厚度 $h$ 的乘积再乘以SST的变化趋势，等于进入海洋的表面热通量与因底部夹卷而进入混合层的净热通量之和。使用线性整体通量反馈 $Q'(t) = -\\Lambda\\,T'(t)$ 来参数化异常表面热通量，并使用作用于混合层底部温跃 $(T_b - T)$ 的夹卷速度 $w_e$ 来参数化夹卷热通量。对于次季节异常，假设深层海洋温度异常消失，即 $T_b'(t) = 0$，并且没有外部随机强迫。从这些假设和能量守恒出发，推导控制 $T'(t)$ 的自治线性常微分方程，并获得SST异常的e折时间 $\\tau$ 的闭式表达式，其定义为在没有外部强迫的情况下 $T'(t) = T'(0)\\exp(-t/\\tau)$。然后，使用以下代表与次季节到季节（S2S）预报相关的亚热带海洋状况的科学上合理的参数值，对 $\\tau$ 进行数值计算：\n- $\\rho_w = 1025$（海水密度），\n- $c_p = 3990$（定压比热容），\n- $h = 40$（混合层深度），\n- $\\Lambda = 30$（线性整体热通量反馈系数），\n- $w_e = 0.8$（夹卷速度，单位为米/天）。\n以天为单位表示最终的e折时间。将您的答案四舍五入到 $4$ 位有效数字。如果需要，使用每天 $86400$ 秒进行单位转换。",
            "solution": "该问题陈述具有科学依据，数学上是适定的，并且没有矛盾或含糊之处。它描述了气候科学中使用的一个标准的、简化的物理模型——平板海洋模型，并要求基于能量守恒基本原理进行推导和计算。所有提供的参数在物理上都是合理的。因此，该问题是有效的，并将提供解答。\n\n问题要求推导海表温度（SST）异常 $T'(t)$ 的控制性常微分方程（ODE），并随后计算e折时间 $\\tau$。出发点是厚度为 $h$ 的恒定海洋混合层的能量守恒原理。\n\n混合层单位面积热含量的变化率等于进入其中的净热通量。单位面积的热含量由体积热容 $\\rho_w c_p$、混合层厚度 $h$ 及其温度 $T$ 的乘积给出。假设 $h$ 是常数，能量平衡方程为：\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{net}\n$$\n其中 $\\rho_w$ 是海水密度， $c_p$ 是比热容， $Q_{net}$ 是进入该层的净热通量。$Q_{net}$ 是表面热通量 $Q_{surf}$ 和底部夹卷热通量 $Q_{ent}$ 的和。\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{surf} + Q_{ent}\n$$\n温度 $T$ 可以分解为一个恒定的气候平均值 $T_{clim}$ 和一个随时间变化的异常 $T'$，使得 $T(t) = T_{clim} + T'(t)$。因此，$\\frac{dT}{dt} = \\frac{dT'}{dt}$。通量也同样进行分解。异常表面热通量由线性反馈参数化给出 $Q'(t) = -\\Lambda T'(t)$，因此总表面通量为 $Q_{surf} = Q_{clim} + Q' = Q_{clim} - \\Lambda T'(t)$。\n\n夹卷热通量是由混合层下方的较冷海水混入混合层而产生的。该通量与夹卷速度 $w_e$ 以及混合层下方水的温度 $T_b$ 和混合层本身温度 $T$ 之间的温差成正比。这代表一种冷却效应，因为通常 $T_b  T$。该通量的标准物理公式为 $Q_{ent} = \\rho_w c_p w_e (T_b - T)$。底部温度 $T_b$ 也分解为 $T_b(t) = T_{b,clim} + T_b'(t)$。\n\n将这些参数化代入能量平衡方程，得到：\n$$\n\\rho_w c_p h \\frac{d(T_{clim} + T')}{dt} = [Q_{clim} - \\Lambda T'] + [\\rho_w c_p w_e ((T_{b,clim} + T_b') - (T_{clim} + T'))]\n$$\n由于 $\\frac{dT_{clim}}{dt} = 0$，左边变为 $\\rho_w c_p h \\frac{dT'}{dt}$。展开右边得到：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = Q_{clim} - \\Lambda T' + \\rho_w c_p w_e (T_{b,clim} - T_{clim}) + \\rho_w c_p w_e (T_b' - T')\n$$\n在气候稳态下，所有异常和时间导数均为零。因此，平均状态由以下方程平衡：\n$$\n0 = Q_{clim} + \\rho_w c_p w_e (T_{b,clim} - T_{clim})\n$$\n从完整的异常方程中减去这个平均状态方程，得到 $T'$ 的控制方程：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' + \\rho_w c_p w_e (T_b' - T')\n$$\n问题指明，对于次季节异常，深层海洋温度异常消失，即 $T_b' = 0$。应用这个条件，方程简化为：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' - \\rho_w c_p w_e T'\n$$\n这就是 $T'(t)$ 的自治线性常微分方程。我们可以在右边提出因子 $T'$：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -(\\Lambda + \\rho_w c_p w_e) T'\n$$\n将方程重排为标准形式 $\\frac{dT'}{dt} = -k T'$，得到：\n$$\n\\frac{dT'}{dt} = -\\left( \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h} \\right) T'\n$$\n该常微分方程的解的形式为 $T'(t) = T'(0) \\exp(-kt)$。问题通过关系式 $T'(t) = T'(0)\\exp(-t/\\tau)$ 定义了e折时间 $\\tau$。通过比较这些形式，我们确定衰减率 $k$ 是e折时间 $\\tau$ 的倒数，即 $1/\\tau$。\n$$\n\\frac{1}{\\tau} = \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h}\n$$\n因此，e折时间 $\\tau$ 的闭式表达式为：\n$$\n\\tau = \\frac{\\rho_w c_p h}{\\Lambda + \\rho_w c_p w_e}\n$$\n接下来，我们使用提供的参数值对 $\\tau$ 进行数值计算。为保持一致性，所有单位都必须转换为国际单位制（SI）。\n给定的参数是：\n- $\\rho_w = 1025 \\text{ kg} \\cdot \\text{m}^{-3}$\n- $c_p = 3990 \\text{ J} \\cdot \\text{kg}^{-1} \\cdot \\text{K}^{-1}$\n- $h = 40 \\text{ m}$\n- $\\Lambda = 30 \\text{ W} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1} = 30 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$\n- $w_e = 0.8 \\text{ m/day}$\n\n夹卷速度 $w_e$ 必须使用转换因子 $1 \\text{ 天} = 86400 \\text{ s}$ 从米/天转换为米/秒：\n$$\nw_e = 0.8 \\frac{\\text{m}}{\\text{day}} \\times \\frac{1 \\text{ day}}{86400 \\text{ s}} = \\frac{0.8}{86400} \\text{ m} \\cdot \\text{s}^{-1}\n$$\n首先，计算分子，它代表混合层单位面积的热容量：\n$$\n\\text{Numerator} = \\rho_w c_p h = 1025 \\times 3990 \\times 40 = 163,590,000 \\text{ J} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n接下来，计算分母，它代表总阻尼系数。分母中的两项必须具有相同的单位 $\\text{J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$。\n$$\n\\text{Denominator} = \\Lambda + \\rho_w c_p w_e = 30 + (1025 \\times 3990 \\times \\frac{0.8}{86400})\n$$\n计算第二项：\n$$\n\\rho_w c_p w_e = 4,089,750 \\times \\frac{0.8}{86400} = \\frac{3,271,800}{86,400} \\approx 37.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n所以分母是：\n$$\n\\text{Denominator} = 30 + 37.868056 = 67.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n现在，我们可以计算 $\\tau$。结果的单位将是秒。\n$$\n\\tau_s = \\frac{163,590,000}{67.868056} \\approx 2,410,389.6 \\text{ s}\n$$\n最后，我们将e折时间从秒转换为天：\n$$\n\\tau_{days} = \\frac{\\tau_s}{86400} = \\frac{2,410,389.6}{86400} \\approx 27.90034 \\text{ days}\n$$\n根据要求将结果四舍五入到 $4$ 位有效数字，得到 $27.90$ 天。",
            "answer": "$$\n\\boxed{27.90}\n$$"
        },
        {
            "introduction": "一个复杂的无缝隙预测系统不仅需要高效和物理上准确，还必须在整个预报-分析循环中保持内在的物理一致性。然而，无论是平流方案还是数据同化过程，都可能在不经意间破坏基本的守恒定律，例如质量守恒。本练习模拟了一个真实世界中模式开发者会遇到的问题，即离散化方案如何导致质量不守恒，以及如何设计一个简单的“修复”策略来恢复系统的总质量。通过这个实践，你将更深刻地理解确保数值模型物理真实性的重要性与具体方法。",
            "id": "4086386",
            "problem": "考虑一个有界域，它被离散化为 $N$ 个准拉格朗日控制体积（单元），其面积为 $\\{A_i\\}_{i=1}^{N}$，这些控制体积构成了对水平面的一个划分。一个混合比为 $q$ 的被动示踪物在无辐散速度场（即 $\\nabla \\cdot \\boldsymbol{u} = 0$）的平流作用下演变，且没有源或汇。在连续形式下，$q$ 的连续性方程的积分形式意味着全域积分质量 $M(t) = \\int_{\\Omega} q(\\boldsymbol{x}, t) \\,\\mathrm{d}A$ 不随时间变化。\n\n你使用半拉格朗日方法将 $q$ 向前推进一个时间步长 $\\Delta t$，该方法通过线性插值从起始点重构出单元中心的预报场 $\\{q_f^i\\}_{i=1}^{N}$。这个离散映射可以抽象地写为\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij} \\, q^n_j,\n$$\n其中 $q^n_j$ 是前一时间层单元 $j$ 中的示踪物混合比，$W_{ij} \\ge 0$ 是由半拉格朗日格式以及起始点相对于网格的几何位置决定的插值权重。半拉格朗日步骤后的全局质量为 $M_f = \\sum_{i=1}^{N} A_i \\, q_f^i$。\n\n接下来，你执行一个三维变分（3D-Var）数据同化分析，通过增量 $\\{d^i\\}_{i=1}^{N}$ 将预报场更新为分析场，\n$$\nq_a^i = q_f^i + d^i.\n$$\n3D-Var 增量向量 $\\boldsymbol{d}$ 是一个二次代价函数的极小值点，该代价函数由一个对称正定背景误差协方差矩阵和一个对称正定观测误差协方差矩阵定义，但分析中没有明确的质量约束。\n\n假设 $\\nabla \\cdot \\boldsymbol{u} = 0$ 且没有源或汇，并假设没有穿过边界 $\\partial \\Omega$ 的通量。从积分守恒定律和上述离散形式出发：\n\n- 推导插值权重 $\\{W_{ij}\\}$ 需满足的条件，以使半拉格朗日步骤是离散质量守恒的，并说明为什么半拉格朗日格式中的通用线性插值可能会违反此条件。\n- 证明在一般情况下，3D-Var 分析会在离散层面上引入全局质量差异。\n- 提出一个统一应用于分析场的单一标量订正策略，$q_c^i = s \\, q_a^i$，将全域积分质量恢复到半拉格朗日预报质量 $M_f$，并达到机器精度。\n- 在上述假设下，根据 $\\{A_i\\}_{i=1}^{N}$、$\\{q_f^i\\}_{i=1}^{N}$ 和 $\\{q_a^i\\}_{i=1}^{N}$ 推导标量 $s$ 的闭式解析表达式。你的最终答案必须仅为 $s$ 的表达式。不需要进行数值计算。\n\n请用解析表达式表示你的最终答案。不要包含任何单位，也不要四舍五入。答案必须是单个表达式。",
            "solution": "在无源汇、无辐散流的平流作用下，被动示踪物混合比守恒的基本依据是连续性方程。设 $q(\\boldsymbol{x}, t)$ 为被动示踪物混合比。其欧拉形式为\n$$\n\\frac{\\partial q}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla q = 0,\n$$\n并且在 $\\nabla \\cdot \\boldsymbol{u} = 0$（无辐散流）的条件下，通量形式 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\boldsymbol{u}) = 0$ 简化为平流方程。在无边界通量的封闭域 $\\Omega$ 上对通量形式进行积分，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} q \\,\\mathrm{d}A = - \\int_{\\partial \\Omega} q \\, \\boldsymbol{u} \\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n因此全域积分质量 $M(t) = \\int_{\\Omega} q \\,\\mathrm{d}A$ 不随时间变化。\n\n在具有 $N$ 个面积为 $\\{A_i\\}$ 的控制体积和单元中心值的离散设置中，时间层 $n$ 的全域质量为 $M^n = \\sum_{j=1}^{N} A_j \\, q^n_j$。半拉格朗日预报为\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij}\\, q^n_j,\n$$\n其中权重 $W_{ij}\\ge 0$ 由起始点插值确定。半拉格朗日步骤后的全局质量为\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i = \\sum_{i=1}^{N} A_i \\sum_{j=1}^{N} W_{ij}\\, q^n_j = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij}\\right) q^n_j.\n$$\n为使半拉格朗日步骤对任意 $\\{q^n_j\\}$ 都是离散质量守恒的，一个充分条件是该映射能保持面积权重，即\n$$\n\\sum_{i=1}^{N} A_i \\, W_{ij} = A_j \\quad \\text{for all } j \\in \\{1,\\dots,N\\}.\n$$\n在此条件下，\n$$\nM_f = \\sum_{j=1}^{N} A_j \\, q^n_j = M^n,\n$$\n质量是离散守恒的。半拉格朗日格式中使用的通用线性插值旨在确保沿轨迹线的场值是准确的，但通常不强制执行面积加权恒等式 $\\sum_{i} A_i W_{ij} = A_j$。权重 $\\{W_{ij}\\}$ 通常被归一化以使对每个 $i$ 都有 $\\sum_{j} W_{ij} = 1$，以确保局部重构的一致性，但对面积加权的列和没有保证。因此，在没有守恒重映的情况下，半拉格朗日步骤会引入一个全局质量误差\n$$\n\\varepsilon_{\\mathrm{SL}} = M_f - M^n = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij} - A_j\\right) q^n_j,\n$$\n该误差在一般情况下不为零。\n\n三维变分（3D-Var）分析将 $\\boldsymbol{d}$ 构造为一个二次代价函数的极小值点，通常为\n$$\nJ(\\boldsymbol{x}) = \\frac{1}{2}(\\boldsymbol{x}-\\boldsymbol{x}_f)^{\\top} \\boldsymbol{B}^{-1} (\\boldsymbol{x}-\\boldsymbol{x}_f) + \\frac{1}{2}(\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y}),\n$$\n其中 $\\boldsymbol{x}$ 汇集了离散状态，$\\boldsymbol{x}_f$ 是预报，$\\boldsymbol{B}$ 是背景误差协方差矩阵，$\\boldsymbol{H}$ 是观测算子，$\\boldsymbol{R}$ 是观测误差协方差矩阵。在标准形式中，没有硬约束来强制 $\\sum_{i=1}^{N} A_i \\, d^i = 0$。因此，在分析之后\n$$\nq_a^i = q_f^i + d^i,\n$$\n分析质量为\n$$\nM_a = \\sum_{i=1}^{N} A_i \\, q_a^i = \\sum_{i=1}^{N} A_i \\, q_f^i + \\sum_{i=1}^{N} A_i \\, d^i = M_f + \\varepsilon_{\\mathrm{3DVar}},\n$$\n其中\n$$\n\\varepsilon_{\\mathrm{3DVar}} = \\sum_{i=1}^{N} A_i \\, d^i,\n$$\n这通常不为零。综合效应是 $M_a \\ne M^n$ 且 $M_a \\ne M_f$，除非强制执行特殊的兼容性约束或守恒重映。\n\n为了将质量精确地恢复到半拉格朗日预报质量 $M_f$ 并达到机器精度，一个简单的标量订正策略是通过一个统一的乘性因子 $s$ 来重缩放分析场：\n$$\nq_c^i = s \\, q_a^i, \\quad i = 1,\\dots,N.\n$$\n订正后的质量为\n$$\nM_c = \\sum_{i=1}^{N} A_i \\, q_c^i = \\sum_{i=1}^{N} A_i \\, s \\, q_a^i = s \\sum_{i=1}^{N} A_i \\, q_a^i = s \\, M_a.\n$$\n施加 $M_c = M_f$ 的要求，可以得到关于 $s$ 的一个标量方程：\n$$\ns \\, M_a = M_f \\quad \\Longrightarrow \\quad s = \\frac{M_f}{M_a}.\n$$\n用离散场表示，\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i, \\qquad M_a = \\sum_{i=1}^{N} A_i \\, q_a^i,\n$$\n因此订正因子的闭式解析表达式为\n$$\ns = \\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}.\n$$\n这种乘性订正将分析后的全局质量恢复到与半拉格朗日预报质量相等，并达到机器精度，因为得到的订正后质量 $M_c = s M_a = M_f$ 在求和中的浮点舍入误差范围内成立。这是一个最小秩（标量）订正，它保留了相对于 $\\boldsymbol{q}_a$ 的分析场空间形态，并且如果 $\\boldsymbol{q}_a$ 是正的且 $M_f/M_a  0$，则保持正性。",
            "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}}$$"
        }
    ]
}