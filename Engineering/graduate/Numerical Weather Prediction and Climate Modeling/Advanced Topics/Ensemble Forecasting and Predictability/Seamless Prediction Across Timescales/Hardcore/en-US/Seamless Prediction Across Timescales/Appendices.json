{
    "hands_on_practices": [
        {
            "introduction": "Seamless prediction models must simulate phenomena with vastly different timescales, from fast-moving gravity waves to slow advective processes. A purely explicit time-stepping scheme would be computationally prohibitive, as its stability is limited by the fastest waves; Implicit-Explicit (IMEX) schemes solve this by treating fast, stiff terms implicitly and slow terms explicitly. This exercise provides hands-on practice in analyzing the stability of such schemes, demonstrating how IMEX methods alleviate the stringent time-step constraints imposed by fast waves, a critical technique in modern Earth system models .",
            "id": "4086415",
            "problem": "A one-dimensional, periodic, linearized shallow-water system on an Arakawa C-grid is used to represent fast gravity waves and slower advective motions relevant to seamless prediction across timescales in numerical weather prediction and climate modeling. Let the free-surface height be $\\,\\eta_j(t)\\,$ defined at integer indices $\\,j\\,$, and the velocity be $\\,u_{j+1/2}(t)\\,$ defined at half-integer indices $\\,j+1/2\\,$. The governing equations linearized about a uniform mean depth $\\,H0\\,$ and a uniform mean zonal flow $\\,U\\,$ are\n$$\n\\eta_t + U\\,\\eta_x + H\\,u_x = 0,\\qquad u_t + U\\,u_x + g\\,\\eta_x = 0,\n$$\nwhere $\\,g0\\,$ is gravitational acceleration and the gravity-wave phase speed is $\\,c=\\sqrt{gH}\\,$. The grid has uniform spacing $\\,\\Delta x\\,$ and periodic boundary conditions.\n\nPart A (explicit gravity-wave dynamics): Ignore the advective terms (set $\\,U=0\\,$) and discretize the remaining fast linear gravity-wave system using the forward–backward time-stepping scheme on the Arakawa C-grid:\n- For the mass equation, use a forward Euler step with the centered C-grid difference for $\\,u_x\\,$, namely\n$$\n\\eta^{n+1}_j \\;=\\; \\eta^n_j \\;-\\; \\Delta t\\,H\\,\\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x}.\n$$\n- For the momentum equation, use a backward Euler step that treats $\\,\\eta_x\\,$ implicitly at half points with the centered C-grid difference, namely\n$$\nu^{n+1}_{j+1/2} \\;=\\; u^n_{j+1/2} \\;-\\; \\Delta t\\,g\\,\\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x}.\n$$\nUsing a standard von Neumann (Fourier) stability analysis consistent with the staggered grid, derive the stability condition on $\\,\\Delta t\\,$ and identify the maximum stable explicit time step for the gravity-wave dynamics in terms of $\\,\\Delta x\\,$ and $\\,c\\,$.\n\nPart B (Implicit–Explicit workaround): Now consider the full linearized system with $\\,U\\neq 0\\,$. Design an Implicit–Explicit (IMEX) scheme that treats the fast gravity-wave coupling terms $\\,H\\,u_x\\,$ and $\\,g\\,\\eta_x\\,$ with backward Euler (implicitly) on the same Arakawa C-grid operators as above, while treating the slow advective terms $\\,U\\,\\eta_x\\,$ and $\\,U\\,u_x\\,$ with forward Euler (explicitly) using first-order upwind differences appropriate to the sign of $\\,U\\,$. Using von Neumann analysis, show that the implicit treatment of gravity-wave terms removes the gravity-wave Courant–Friedrichs–Lewy (CFL) restriction and that stability is instead controlled by the advective CFL condition. Determine the maximum stable time step for the IMEX scheme in terms of $\\,\\Delta x\\,$ and $\\,U\\,$.\n\nAnswer specification:\n- Provide the pair consisting of the maximum stable explicit gravity-wave time step from Part A and the maximum stable IMEX time step from Part B as a single closed-form analytic expression depending on $\\,c\\,$, $\\,U\\,$, and $\\,\\Delta x\\,$.\n- Express the final answers in units of seconds.\n- No numerical substitution is required; do not round.",
            "solution": "This problem requires the derivation of stability conditions for two different numerical schemes applied to the one-dimensional linearized shallow-water equations. We will use the von Neumann stability analysis method for both parts.\n\nPart A: Explicit Forward-Backward Scheme for Gravity Waves\n\nThe linearized shallow-water equations with the mean advection term set to zero ($U=0$) are:\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g \\frac{\\partial \\eta}{\\partial x} = 0\n$$\nThe problem specifies a forward-backward time-stepping scheme on an Arakawa C-grid:\n$$\n\\frac{\\eta^{n+1}_j - \\eta^n_j}{\\Delta t} = -H \\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x} \\quad (1)\n$$\n$$\n\\frac{u^{n+1}_{j+1/2} - u^n_{j+1/2}}{\\Delta t} = -g \\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x} \\quad (2)\n$$\nFor the von Neumann analysis, we introduce Fourier modal solutions for the height $\\eta$ and velocity $u$. Due to the staggered grid, the ansatz is:\n$$\n\\eta^n_j = \\hat{\\eta}^n(k) e^{i k j \\Delta x}\n$$\n$$\nu^n_{j+1/2} = \\hat{u}^n(k) e^{i k (j+1/2) \\Delta x}\n$$\nwhere $k$ is the wavenumber, $i=\\sqrt{-1}$, and $\\hat{\\eta}^n$ and $\\hat{u}^n$ are the Fourier amplitudes at time step $n$. Substituting these into equations (1) and (2):\n\nFrom (1):\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} e^{i k j \\Delta x} = - \\frac{H}{\\Delta x} \\left( \\hat{u}^n e^{i k (j+1/2) \\Delta x} - \\hat{u}^n e^{i k (j-1/2) \\Delta x} \\right)\n$$\nDividing by $e^{i k j \\Delta x}$:\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} = - \\frac{H \\hat{u}^n}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i H \\hat{u}^n}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{\\eta}^{n+1} = \\hat{\\eta}^n - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n \\quad (3)\n$$\n\nFrom (2):\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} e^{i k (j+1/2) \\Delta x} = - \\frac{g}{\\Delta x} \\left( \\hat{\\eta}^{n+1} e^{i k (j+1) \\Delta x} - \\hat{\\eta}^{n+1} e^{i k j \\Delta x} \\right)\n$$\nDividing by $e^{i k (j+1/2) \\Delta x}$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = - \\frac{g \\hat{\\eta}^{n+1}}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i g \\hat{\\eta}^{n+1}}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{u}^{n+1} = \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\quad (4)\n$$\nTo find the amplification factor $\\lambda$, we seek a recurrence relation for a single variable. From (3), we can write $\\hat{u}^n$ in terms of $\\hat{\\eta}$ at steps $n$ and $n+1$. Then, advancing (4) by one time step allows substitution. A more direct method is to advance (3) one time step to $n+2$:\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^{n+1}\n$$\nSubstitute $\\hat{u}^{n+1}$ from (4):\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\left[ \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\right]\n$$\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\left( \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) \\hat{u}^n - \\frac{4 \\Delta t^2 g H}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\nFrom (3), we replace the term with $\\hat{u}^n$:\n$$\n- \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n = \\hat{\\eta}^{n+1} - \\hat{\\eta}^n\n$$\nSubstituting this into the equation for $\\hat{\\eta}^{n+2}$:\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} + (\\hat{\\eta}^{n+1} - \\hat{\\eta}^n) - \\frac{4 c^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\nwhere $c^2 = gH$. Let $K = \\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2$. The recurrence relation is:\n$$\n\\hat{\\eta}^{n+2} - (2-K)\\hat{\\eta}^{n+1} + \\hat{\\eta}^n = 0\n$$\nAssuming a solution of the form $\\hat{\\eta}^n = \\lambda^n$, we obtain the characteristic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^2 - (2-K)\\lambda + 1 = 0\n$$\nFor the scheme to be stable, the magnitudes of the roots $\\lambda$ must not exceed $1$, i.e., $|\\lambda| \\le 1$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{(2-K) \\pm \\sqrt{(2-K)^2 - 4}}{2} = \\frac{2-K \\pm \\sqrt{K^2 - 4K}}{2}\n$$\nIf the discriminant is negative or zero, $K^2 - 4K \\le 0 \\implies K(K-4) \\le 0$. As $K \\ge 0$, this implies $0 \\le K \\le 4$. In this case, the roots are complex conjugates, and \n$$|\\lambda|^2 = \\left(\\frac{2-K}{2}\\right)^2 + \\frac{4K-K^2}{4} = \\frac{4-4K+K^2+4K-K^2}{4} = 1$$\nThus, for $0 \\le K \\le 4$, we have $|\\lambda|=1$ and the scheme is neutrally stable. If $K > 4$, the roots are real and their product is $1$. Their sum is $2-K  -2$, which implies one root must be less than $-1$, making the scheme unstable.\nThe stability condition is $K \\le 4$:\n$$\n\\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 \\le 4 \\implies \\frac{c \\Delta t}{\\Delta x} \\left|\\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right| \\le 1\n$$\nThis condition must hold for all possible wavenumbers $k$. The most restrictive case occurs when $\\left|\\sin(k \\Delta x/2)\\right|$ is maximal, which is $1$ (at the Nyquist wavenumber $k = \\pi/\\Delta x$). Therefore, the stability condition simplifies to the Courant-Friedrichs-Lewy (CFL) condition for gravity waves:\n$$\n\\frac{c \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{c}\n$$\nThe maximum stable time step for Part A is $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{c}$.\n\nPart B: Implicit-Explicit (IMEX) Scheme\n\nNow we consider the full system with $U \\neq 0$. The IMEX scheme treats advection terms explicitly with first-order upwind differences and gravity wave terms implicitly. For $U>0$, the upwind differences are $(\\partial_x f)_j \\approx (f_j - f_{j-1})/\\Delta x$. The discretized equations are:\n$$\n\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + U \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} + H \\frac{u_{j+1/2}^{n+1} - u_{j-1/2}^{n+1}}{\\Delta x} = 0\n$$\n$$\n\\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^n}{\\Delta t} + U \\frac{u_{j+1/2}^n - u_{j-1/2}^n}{\\Delta x} + g \\frac{\\eta_{j+1}^{n+1} - \\eta_j^{n+1}}{\\Delta x} = 0\n$$\nApplying the same Fourier ansatz:\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{\\eta}^n(1 - e^{-ik\\Delta x}) + \\frac{H}{\\Delta x}\\hat{u}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{u}^n(1 - e^{-ik\\Delta x}) + \\frac{g}{\\Delta x}\\hat{\\eta}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\nLet $\\mathbf{v}^n = [\\hat{\\eta}^n, \\hat{u}^n]^T$. This system can be written in matrix form $\\mathbf{M} \\mathbf{v}^{n+1} = \\mathbf{N} \\mathbf{v}^n$:\n$$\n\\begin{pmatrix} 1  \\frac{2i\\Delta t H}{\\Delta x} S \\\\ \\frac{2i\\Delta t g}{\\Delta x} S  1 \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n+1} \\\\ \\hat{u}^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})  0 \\\\ 0  1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x}) \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n} \\\\ \\hat{u}^{n} \\end{pmatrix}\n$$\nwhere $S = \\sin(k\\Delta x/2)$. The amplification matrix is $G = \\mathbf{M}^{-1}\\mathbf{N}$.\nLet $A_U = 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})$ be the amplification factor of the explicit upwind advection scheme. Then $\\mathbf{N} = A_U \\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix.\nThe determinant of $\\mathbf{M}$ is $\\det(\\mathbf{M}) = 1 - (i^2) \\frac{4\\Delta t^2 gH}{\\Delta x^2}S^2 = 1 + \\frac{4c^2\\Delta t^2}{\\Delta x^2}S^2 = 1 + K_c$, where $K_c = K$ from Part A.\nThe eigenvalues $\\lambda_G$ of $G$ are the product of $A_U$ and the eigenvalues of $\\mathbf{M}^{-1}$. The eigenvalues of $\\mathbf{M}$ are $1 \\pm \\sqrt{-K_c} = 1 \\pm i\\sqrt{K_c}$. Thus, the eigenvalues of $\\mathbf{M}^{-1}$ are $\\frac{1}{1 \\pm i\\sqrt{K_c}} = \\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}$.\nThe eigenvalues of the full amplification matrix $G$ are $\\lambda_G = A_U \\left(\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right)$.\nFor stability, we require $|\\lambda_G| \\le 1$.\n$$\n|\\lambda_G|^2 = |A_U|^2 \\left|\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right|^2 = |A_U|^2 \\frac{1+K_c}{(1+K_c)^2} = \\frac{|A_U|^2}{1+K_c}\n$$\nThe stability condition is $\\frac{|A_U|^2}{1+K_c} \\le 1$, or $|A_U|^2 \\le 1+K_c$.\nSince $K_c = (\\frac{2c\\Delta t}{\\Delta x}\\sin(\\frac{k\\Delta x}{2}))^2 \\ge 0$, we have $1+K_c \\ge 1$. This means the implicit treatment of the gravity wave terms has a stabilizing effect. As the problem suggests, the stability is controlled by the explicit advection term. A sufficient condition for stability is $|A_U| \\le 1$, since this would imply $|A_U|^2 \\le 1 \\le 1+K_c$.\nLet's analyze $|A_U| \\le 1$. Let $\\alpha = U\\Delta t/\\Delta x$ (the advective Courant number) and $\\theta=k\\Delta x$.\n$$\nA_U = 1 - \\alpha(1-\\cos\\theta+i\\sin\\theta)\n$$\n$$\n|A_U|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta\n$$\n$$\n|A_U|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-2\\cos\\theta+\\cos^2\\theta+\\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + 2\\alpha^2(1-\\cos\\theta)\n$$\n$$\n|A_U|^2 = 1 + 2\\alpha(\\alpha-1)(1-\\cos\\theta)\n$$\nFor stability, $|A_U|^2 \\le 1$, which requires $2\\alpha(\\alpha-1)(1-\\cos\\theta) \\le 0$.\nSince $\\alpha = U\\Delta t/\\Delta x  0$ and $1-\\cos\\theta \\ge 0$, this inequality holds if and only if $\\alpha-1 \\le 0$, meaning $\\alpha \\le 1$.\nThe analysis for $U0$ would involve a forward spatial difference for the upwind scheme, leading to the condition $|U|\\Delta t/\\Delta x \\le 1$. Thus, the stability is generally determined by the advective CFL condition.\n$$\n\\frac{|U|\\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{|U|}\n$$\nThe maximum stable time step for the IMEX scheme is $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{|U|}$. This successfully removes the dependency on the fast gravity wave speed $c$.\n\nCombining the results, the pair of maximum stable time steps for Part A and Part B is $(\\frac{\\Delta x}{c}, \\frac{\\Delta x}{|U|})$. These expressions have units of seconds as required.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Delta x}{c}  \\frac{\\Delta x}{|U|}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Extending predictions to subseasonal and seasonal timescales relies on identifying components of the Earth system with long \"memory,\" and the ocean's upper layer is a primary source of this predictability. This practice uses a simplified ocean mixed-layer model to explore how the balance between surface heat fluxes and ocean dynamics determines the persistence of sea surface temperature ($SST$) anomalies. By deriving and calculating the e-folding time of $SST$ anomalies, you will gain a quantitative understanding of the ocean's thermal inertia, a key factor that provides skill in long-range forecasting .",
            "id": "4086435",
            "problem": "Consider a simplified bulk ocean mixed-layer model used in numerical weather prediction and climate modeling to assess seamless prediction across timescales. Let the mixed layer of the ocean have constant thickness $h$ and be subjected to surface heat fluxes and entrainment at its base. Define Sea Surface Temperature (SST) anomalies $T'(t)$ relative to a climatological mean, and assume horizontal advection is negligible on subseasonal timescales. The mixed-layer heat content obeys conservation of energy: the product of seawater density $\\rho_w$, specific heat capacity at constant pressure $c_p$, and mixed-layer thickness $h$ multiplied by the SST tendency equals the sum of surface heat flux into the ocean and the net heat flux into the mixed layer due to entrainment across its base. Parameterize the anomalous surface heat flux using a linear bulk flux feedback $Q'(t) = -\\Lambda\\,T'(t)$, and the entrainment heat flux using an entrainment velocity $w_e$ acting on the temperature jump $(T_b - T)$ at the base of the mixed layer. For subseasonal anomalies, assume deeper ocean temperature anomalies vanish, i.e., $T_b'(t) = 0$, and there is no external stochastic forcing. Starting from these assumptions and energy conservation, derive the autonomous linear ordinary differential equation governing $T'(t)$ and obtain the closed-form expression for the e-folding time $\\tau$ of SST anomalies, defined by $T'(t) = T'(0)\\exp(-t/\\tau)$ in the absence of external forcing. Then, evaluate $\\tau$ numerically for the following scientifically plausible parameter values representative of a subtropical ocean regime relevant to Subseasonal to Seasonal (S2S) forecasting:\n- $\\rho_w = 1025$ (seawater density),\n- $c_p = 3990$ (specific heat capacity at constant pressure),\n- $h = 40$ (mixed-layer depth),\n- $\\Lambda = 30$ (linear bulk heat flux feedback coefficient),\n- $w_e = 0.8$ (entrainment velocity given in meters per day).\nExpress the final e-folding time in days. Round your answer to $4$ significant figures. Use $86400$ seconds per day for unit conversion if needed.",
            "solution": "The problem asks for the derivation of the governing ordinary differential equation (ODE) for Sea Surface Temperature (SST) anomalies, $T'(t)$, and the subsequent calculation of the e-folding time, $\\tau$. The starting point is the principle of energy conservation for the ocean mixed layer, which has a constant thickness $h$.\n\nThe rate of change of heat content per unit area of the mixed layer is equal to the net heat flux into it. The heat content per unit area is given by the product of the volumetric heat capacity, $\\rho_w c_p$, the mixed-layer thickness, $h$, and its temperature, $T$. Assuming $h$ is constant, the energy balance equation is:\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{net}\n$$\nwhere $\\rho_w$ is the seawater density, $c_p$ is the specific heat capacity, and $Q_{net}$ is the net heat flux into the layer. $Q_{net}$ is the sum of the surface heat flux, $Q_{surf}$, and the heat flux from entrainment at the base, $Q_{ent}$.\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{surf} + Q_{ent}\n$$\nThe temperature $T$ can be decomposed into a constant climatological mean $T_{clim}$ and a time-varying anomaly $T'$, such that $T(t) = T_{clim} + T'(t)$. Consequently, $\\frac{dT}{dt} = \\frac{dT'}{dt}$. The fluxes are likewise decomposed. The anomalous surface heat flux is given by the linear feedback parameterization $Q'(t) = -\\Lambda T'(t)$, so the total surface flux is $Q_{surf} = Q_{clim} + Q' = Q_{clim} - \\Lambda T'(t)$.\n\nThe entrainment heat flux results from mixing colder water from below the mixed layer into it. This flux is proportional to the entrainment velocity, $w_e$, and the temperature difference between the water below the mixed layer, $T_b$, and the mixed layer itself, $T$. This represents a cooling effect, as typically $T_b  T$. A standard physical formulation for this flux is $Q_{ent} = \\rho_w c_p w_e (T_b - T)$. The base temperature $T_b$ is also decomposed as $T_b(t) = T_{b,clim} + T_b'(t)$.\n\nSubstituting these parameterizations into the energy balance equation yields:\n$$\n\\rho_w c_p h \\frac{d(T_{clim} + T')}{dt} = [Q_{clim} - \\Lambda T'] + [\\rho_w c_p w_e ((T_{b,clim} + T_b') - (T_{clim} + T'))]\n$$\nSince $\\frac{dT_{clim}}{dt} = 0$, the left side becomes $\\rho_w c_p h \\frac{dT'}{dt}$. Expanding the right side gives:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = Q_{clim} - \\Lambda T' + \\rho_w c_p w_e (T_{b,clim} - T_{clim}) + \\rho_w c_p w_e (T_b' - T')\n$$\nIn the climatological steady state, all anomalies and time derivatives are zero. Thus, the mean state is balanced by:\n$$\n0 = Q_{clim} + \\rho_w c_p w_e (T_{b,clim} - T_{clim})\n$$\nSubtracting this mean-state equation from the full equation for the anomalies yields the governing equation for $T'$:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' + \\rho_w c_p w_e (T_b' - T')\n$$\nThe problem specifies that for subseasonal anomalies, the deeper ocean temperature anomalies vanish, i.e., $T_b' = 0$. Applying this condition simplifies the equation to:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' - \\rho_w c_p w_e T'\n$$\nThis is the autonomous linear ordinary differential equation for $T'(t)$. We can factor out $T'$ on the right-hand side:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -(\\Lambda + \\rho_w c_p w_e) T'\n$$\nRearranging the equation into the standard form $\\frac{dT'}{dt} = -k T'$ gives:\n$$\n\\frac{dT'}{dt} = -\\left( \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h} \\right) T'\n$$\nThe solution to this ODE is of the form $T'(t) = T'(0) \\exp(-kt)$. The problem defines the e-folding time $\\tau$ via the relation $T'(t) = T'(0)\\exp(-t/\\tau)$. By comparing these forms, we identify the decay rate $k$ as the reciprocal of the e-folding time, $1/\\tau$.\n$$\n\\frac{1}{\\tau} = \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h}\n$$\nTherefore, the closed-form expression for the e-folding time $\\tau$ is:\n$$\n\\tau = \\frac{\\rho_w c_p h}{\\Lambda + \\rho_w c_p w_e}\n$$\nNext, we evaluate $\\tau$ numerically using the provided parameter values. For consistency, all units must be converted to the International System of Units (SI).\nThe given parameters are:\n- $\\rho_w = 1025 \\text{ kg} \\cdot \\text{m}^{-3}$\n- $c_p = 3990 \\text{ J} \\cdot \\text{kg}^{-1} \\cdot \\text{K}^{-1}$\n- $h = 40 \\text{ m}$\n- $\\Lambda = 30 \\text{ W} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1} = 30 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$\n- $w_e = 0.8 \\text{ m/day}$\n\nThe entrainment velocity $w_e$ must be converted from meters per day to meters per second using the conversion factor $1 \\text{ day} = 86400 \\text{ s}$:\n$$\nw_e = 0.8 \\frac{\\text{m}}{\\text{day}} \\times \\frac{1 \\text{ day}}{86400 \\text{ s}} = \\frac{0.8}{86400} \\text{ m} \\cdot \\text{s}^{-1}\n$$\nFirst, calculate the numerator, which represents the heat capacity of the mixed layer per unit area:\n$$\n\\text{Numerator} = \\rho_w c_p h = 1025 \\times 3990 \\times 40 = 163,590,000 \\text{ J} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nNext, calculate the denominator, which represents the total damping coefficient. The two terms in the denominator must have the same units of $\\text{J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$.\n$$\n\\text{Denominator} = \\Lambda + \\rho_w c_p w_e = 30 + (1025 \\times 3990 \\times \\frac{0.8}{86400})\n$$\nCalculating the second term:\n$$\n\\rho_w c_p w_e = 4,089,750 \\times \\frac{0.8}{86400} = \\frac{3,271,800}{86,400} \\approx 37.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nSo the denominator is:\n$$\n\\text{Denominator} = 30 + 37.868056 = 67.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nNow, we can calculate $\\tau$. The resulting unit will be seconds.\n$$\n\\tau_s = \\frac{163,590,000}{67.868056} \\approx 2,410,389.6 \\text{ s}\n$$\nFinally, we convert the e-folding time from seconds to days:\n$$\n\\tau_{days} = \\frac{\\tau_s}{86400} = \\frac{2,410,389.6}{86400} \\approx 27.90034 \\text{ days}\n$$\nRounding the result to $4$ significant figures as requested gives $27.90$ days.",
            "answer": "$$\n\\boxed{27.90}\n$$"
        },
        {
            "introduction": "The chaotic nature of the atmosphere fundamentally limits predictability, with small initial errors growing and eventually cascading across different spatial scales. This exercise uses the Lorenz '96 model, a simplified analogue of atmospheric dynamics, to investigate scale-dependent error growth using the tangent linear model and Finite-Time Lyapunov Exponents ($FTLEs$). By implementing this numerical experiment, you will directly quantify how predictability varies with both forecast lead time and spatial scale, providing foundational insights into the challenges of seamless prediction in a chaotic system .",
            "id": "4086427",
            "problem": "Consider the Lorenz '96 model, defined for $K$ variables $x_i(t)$ with cyclic indexing, by the autonomous system $$\\frac{dx_i}{dt} = \\left(x_{i+1} - x_{i-2}\\right) x_{i-1} - x_i + F,\\quad i = 1,\\dots,K,$$ where $F$ is the constant forcing and indices are interpreted modulo $K$. Starting from a deterministic initial condition for the base trajectory $$x_i(0) = F + a \\sin\\left(\\frac{2\\pi i}{K}\\right),$$ with amplitude $a$, define local predictability using the Finite-Time Lyapunov Exponent (FTLE), and design a numerical experiment to estimate scale-dependent predictability as $F$ varies across test cases.\n\nYour program must implement the tangent linear model along the evolving base trajectory to compute FTLEs over a finite prediction window. The FTLE over a finite time window $T$ for a perturbation vector $v(0)$ is defined as $$\\lambda(T) = \\frac{1}{T} \\ln\\left( \\frac{\\left\\|P_S v(T)\\right\\|_2}{\\left\\|v(0)\\right\\|_2} \\right),$$ where $v(t)$ satisfies the tangent linear dynamics $$\\frac{dv_i}{dt} = -x_{i-1}(t) v_{i-2}(t) + \\left(x_{i+1}(t) - x_{i-2}(t)\\right) v_{i-1}(t) - v_i(t) + x_{i-1}(t) v_{i+1}(t),$$ and $P_S$ denotes an orthogonal projection onto a prescribed spectral subspace $S$ in wavenumber space. The Euclidean norm $\\left\\|\\cdot\\right\\|_2$ is used. The projection $P_S$ must be constructed using the Discrete Fourier Transform (DFT), implemented by the Fast Fourier Transform (FFT): for a state vector $u \\in \\mathbb{R}^K$, let $\\widehat{u} = \\mathcal{F}(u)$ denote its DFT, and define the projection by zeroing the Fourier coefficients outside the selected set of wavenumbers and then applying the inverse transform. Let the low-wavenumber subspace be defined by the set $$S_{\\mathrm{low}} = \\{k \\in \\mathbb{Z}: 0 \\leq k \\leq k_c\\} \\cup \\{-k: 1 \\leq k \\leq k_c\\},$$ and let the high-wavenumber subspace be the complement $$S_{\\mathrm{high}} = \\{k \\in \\mathbb{Z}: k_c  |k| \\leq \\lfloor K/2 \\rfloor\\}.$$ Use $k_c$ as the cutoff wavenumber.\n\nTo ensure a scale-specific initial perturbation, construct a deterministic seed vector $$w_i = \\cos\\left(\\frac{2\\pi i}{K}\\right) + \\frac{1}{2}\\cos\\left(\\frac{2\\pi \\cdot 5\\, i}{K}\\right),$$ project it to obtain $v_{\\mathrm{low}}(0) = P_{S_{\\mathrm{low}}} w$ and $v_{\\mathrm{high}}(0) = P_{S_{\\mathrm{high}}} w$, and then scale each to have norm $\\varepsilon$ so that the perturbations remain in the linear regime. Evolve the base trajectory $x(t)$ and the two tangent perturbations $v_{\\mathrm{low}}(t)$ and $v_{\\mathrm{high}}(t)$ simultaneously using a numerically stable time integration method (you must implement the fourth-order Runge–Kutta method (RK4) explicitly) with fixed time step $dt$ and periodic boundary conditions. Compute the scale-dependent FTLEs for both short and long prediction windows, $T_{\\mathrm{short}}$ and $T_{\\mathrm{long}}$, using the appropriate projection $P_{S_{\\mathrm{low}}}$ or $P_{S_{\\mathrm{high}}}$ on $v(T)$ in the numerator of $\\lambda(T)$.\n\nYour program must address the concept of seamless prediction across timescales by reporting FTLEs at two windows $T_{\\mathrm{short}}$ and $T_{\\mathrm{long}}$ for both low-wavenumber and high-wavenumber subspaces, thereby quantifying predictability over short and long horizons and across scales in a unified framework.\n\nUse the following fixed parameters across all test cases: $K = 36$, $k_c = 3$, $dt = 0.01$, $a = 0.01$, and $\\varepsilon = 10^{-7}$. Treat time in nondimensional units consistent with the Lorenz '96 formulation.\n\nTest suite:\n- Case $1$: $(F, T_{\\mathrm{short}}, T_{\\mathrm{long}}) = (4.0, 1.0, 5.0)$.\n- Case $2$: $(F, T_{\\mathrm{short}}, T_{\\mathrm{long}}) = (8.0, 1.0, 5.0)$.\n- Case $3$: $(F, T_{\\mathrm{short}}, T_{\\mathrm{long}}) = (16.0, 1.0, 5.0)$.\n\nFor each case, your program must compute and return a list of four floating-point numbers $[\\lambda_{\\mathrm{low}}(T_{\\mathrm{short}}), \\lambda_{\\mathrm{high}}(T_{\\mathrm{short}}), \\lambda_{\\mathrm{low}}(T_{\\mathrm{long}}), \\lambda_{\\mathrm{high}}(T_{\\mathrm{long}})]$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of the three case results, each case result itself being a comma-separated list enclosed in square brackets. For example, the output must look like $$\\left[ [r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}], [r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}], [r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}] \\right],$$ where each $r_{i,j}$ is a floating-point number. No additional text should be printed.",
            "solution": "The core of the problem is to quantify error growth at different spatial scales and over different time horizons. This is a central theme in predictability studies, embodying the concept of seamless prediction across scales and times. We will use the Finite-Time Lyapunov Exponent (FTLE) as our metric for predictability. The methodology involves the following steps:\n1.  Simultaneous integration of the nonlinear Lorenz '96 model (the base trajectory) and its corresponding Tangent Linear Model (TLM) for two distinct, scale-separated initial perturbations.\n2.  Use of spectral methods (Fast Fourier Transform) to define and project onto low- and high-wavenumber subspaces.\n3.  Calculation of FTLEs for both short and long prediction windows to assess how predictability changes with forecast lead time.\n\n### Step 1: Governing Equations\nThe evolution of the system's base state, represented by a vector $\\vec{x}(t) = [x_1(t), \\dots, x_K(t)]^T \\in \\mathbb{R}^K$, is described by the Lorenz '96 equations:\n$$ \\frac{dx_i}{dt} = \\left(x_{i+1} - x_{i-2}\\right) x_{i-1} - x_i + F, \\quad i = 1, \\dots, K $$\nwhere indices are cyclic (modulo $K$) and $F$ is a constant forcing parameter. The system is initialized from a deterministic state:\n$$ x_i(0) = F + a \\sin\\left(\\frac{2\\pi i}{K}\\right) $$\nTo study predictability, we analyze the growth of an infinitesimal perturbation vector $\\vec{v}(t)$. Its evolution is governed by the Tangent Linear Model (TLM), obtained by linearizing the Lorenz '96 equations around the base trajectory $\\vec{x}(t)$:\n$$ \\frac{d\\vec{v}}{dt} = J(\\vec{x}(t)) \\vec{v}(t) $$\nwhere $J(\\vec{x}(t))$ is the Jacobian matrix of the Lorenz '96 flow evaluated at $\\vec{x}(t)$. The component-wise form of the TLM is:\n$$ \\frac{dv_i}{dt} = -x_{i-1}(t) v_{i-2}(t) + \\left(x_{i+1}(t) - x_{i-2}(t)\\right) v_{i-1}(t) - v_i(t) + x_{i-1}(t) v_{i+1}(t) $$\nThis equation shows that the perturbation's growth rate is coupled to the evolving base state $\\vec{x}(t)$.\n\n### Step 2: Numerical Integration\nTo solve the system, we must integrate the base state $\\vec{x}(t)$ and two separate perturbation vectors, $\\vec{v}_{\\mathrm{low}}(t)$ and $\\vec{v}_{\\mathrm{high}}(t)$, simultaneously. We form an augmented state vector $Y(t) \\in \\mathbb{R}^{3K}$:\n$$ Y(t) = \\begin{bmatrix} \\vec{x}(t) \\\\ \\vec{v}_{\\mathrm{low}}(t) \\\\ \\vec{v}_{\\mathrm{high}}(t) \\end{bmatrix} $$\nThe time evolution of $Y(t)$ is given by a combined system of ordinary differential equations, $\\frac{dY}{dt} = G(Y, F)$, which we solve using the fourth-order Runge-Kutta (RK4) method with a fixed time step $dt$. For a generic ODE $\\frac{dy}{dt} = f(y)$, one step of the RK4 method is:\n$$ y_{n+1} = y_n + \\frac{dt}{6} (k_1 + 2k_2 + 2k_3 + k_4) $$\nwhere\n$$ k_1 = f(y_n), \\quad k_2 = f(y_n + \\frac{dt}{2} k_1), \\quad k_3 = f(y_n + \\frac{dt}{2} k_2), \\quad k_4 = f(y_n + dt k_3) $$\nThe cyclic boundary conditions are implemented efficiently using array rolling operations.\n\n### Step 3: Spectral Space and Scale-Separation\nWe distinguish between large scales (low wavenumbers) and small scales (high wavenumbers) using the Discrete Fourier Transform (DFT). A projection operator $P_S$ is defined to isolate the components of a vector that lie within a specific wavenumber subspace $S$. This is achieved by:\n1.  Computing the DFT of the vector.\n2.  Multiplying the resulting Fourier coefficients by a mask that is $1$ for wavenumbers $k \\in S$ and $0$ otherwise.\n3.  Computing the inverse DFT of the masked coefficients.\n\nThe low- and high-wavenumber subspaces are defined by a cutoff wavenumber $k_c$:\n$$ S_{\\mathrm{low}} = \\{k \\in \\mathbb{Z}: |k| \\leq k_c\\} $$\n$$ S_{\\mathrm{high}} = \\{k \\in \\mathbb{Z}: k_c  |k| \\leq \\lfloor K/2 \\rfloor\\} $$\nThese projections are used to construct the initial perturbations. A seed vector $\\vec{w}$ with energy at both low and high wavenumbers is defined as:\n$$ w_i = \\cos\\left(\\frac{2\\pi i}{K}\\right) + \\frac{1}{2}\\cos\\left(\\frac{2\\pi \\cdot 5\\, i}{K}\\right) $$\nThe initial perturbations $\\vec{v}_{\\mathrm{low}}(0)$ and $\\vec{v}_{\\mathrm{high}}(0)$ are obtained by projecting $\\vec{w}$ onto $S_{\\mathrm{low}}$ and $S_{\\mathrm{high}}$ respectively, and then scaling each to have a small initial Euclidean norm of $\\left\\|\\cdot\\right\\|_2 = \\varepsilon$.\n\n### Step 4: Finite-Time Lyapunov Exponent (FTLE)\nThe scale-dependent predictability is quantified by the FTLE, which measures the average exponential growth rate of a perturbation over a finite time window $T$. For a perturbation originating in subspace $S$ and evolving from $\\vec{v}(0)$ to $\\vec{v}(T)$, the FTLE is:\n$$ \\lambda(T) = \\frac{1}{T} \\ln\\left( \\frac{\\left\\|P_S \\vec{v}(T)\\right\\|_2}{\\left\\|\\vec{v}(0)\\right\\|_2} \\right) $$\nThe projection $P_S$ in the numerator ensures that we measure the error growth that is realized within the specific scale of interest, filtering out any energy that has cascaded to other scales. We compute four FTLEs for each test case $(F, T_{\\mathrm{short}}, T_{\\mathrm{long}})$:\n1.  $\\lambda_{\\mathrm{low}}(T_{\\mathrm{short}})$: Growth of $\\vec{v}_{\\mathrm{low}}$ over $[0, T_{\\mathrm{short}}]$, projected back onto $S_{\\mathrm{low}}$.\n2.  $\\lambda_{\\mathrm{high}}(T_{\\mathrm{short}})$: Growth of $\\vec{v}_{\\mathrm{high}}$ over $[0, T_{\\mathrm{short}}]$, projected back onto $S_{\\mathrm{high}}$.\n3.  $\\lambda_{\\mathrm{low}}(T_{\\mathrm{long}})$: Growth of $\\vec{v}_{\\mathrm{low}}$ over $[0, T_{\\mathrm{long}}]$, projected back onto $S_{\\mathrm{low}}$.\n4.  $\\lambda_{\\mathrm{high}}(T_{\\mathrm{long}})$: Growth of $\\vec{v}_{\\mathrm{high}}$ over $[0, T_{\\mathrm{long}}]$, projected back onto $S_{\\mathrm{high}}$.\nThe simulation proceeds by integrating the augmented state vector $Y(t)$ from $t=0$ to $t=T_{\\mathrm{long}}$, recording the state of the perturbations at $t=T_{\\mathrm{short}}$ and $t=T_{\\mathrm{long}}$ to compute the required FTLEs. This process is repeated for each value of the forcing parameter $F$.",
            "answer": "```python\nimport numpy as np\nfrom typing import List, Tuple\n\ndef solve():\n    \"\"\"\n    Main function to run the Lorenz '96 predictability experiment.\n    \"\"\"\n    K = 36\n    k_c = 3\n    dt = 0.01\n    a = 0.01\n    epsilon = 1e-7\n\n    test_cases = [\n        (4.0, 1.0, 5.0),\n        (8.0, 1.0, 5.0),\n        (16.0, 1.0, 5.0),\n    ]\n\n    all_results = []\n\n    for F, T_short, T_long in test_cases:\n        results = run_l96_experiment(K, F, a, dt, T_short, T_long, k_c, epsilon)\n        all_results.append(results)\n\n    # Format the final output string\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef l96_rhs(x: np.ndarray, F: float) - np.ndarray:\n    \"\"\"Computes the right-hand side of the Lorenz '96 system.\"\"\"\n    x_m2 = np.roll(x, 2)\n    x_m1 = np.roll(x, 1)\n    x_p1 = np.roll(x, -1)\n    return (x_p1 - x_m2) * x_m1 - x + F\n\ndef tlm_rhs(x: np.ndarray, v: np.ndarray) - np.ndarray:\n    \"\"\"Computes the right-hand side of the Tangent Linear Model.\"\"\"\n    x_m2 = np.roll(x, 2)\n    x_m1 = np.roll(x, 1)\n    x_p1 = np.roll(x, -1)\n\n    v_m2 = np.roll(v, 2)\n    v_m1 = np.roll(v, 1)\n    v_p1 = np.roll(v, -1)\n\n    term1 = -x_m1 * v_m2\n    term2 = (x_p1 - x_m2) * v_m1\n    term3 = -v\n    term4 = x_m1 * v_p1\n    return term1 + term2 + term3 + term4\n\ndef combined_rhs(y: np.ndarray, K: int, F: float) - np.ndarray:\n    \"\"\"Computes the RHS for the combined system (base state + 2 perturbations).\"\"\"\n    x = y[:K]\n    v_low = y[K:2*K]\n    v_high = y[2*K:3*K]\n\n    dxdt = l96_rhs(x, F)\n    dv_low_dt = tlm_rhs(x, v_low)\n    dv_high_dt = tlm_rhs(x, v_high)\n    \n    return np.concatenate((dxdt, dv_low_dt, dv_high_dt))\n\ndef rk4_step(y: np.ndarray, dt: float, K: int, F: float) - np.ndarray:\n    \"\"\"Performs a single RK4 step on the combined system.\"\"\"\n    k1 = combined_rhs(y, K, F)\n    k2 = combined_rhs(y + dt / 2.0 * k1, K, F)\n    k3 = combined_rhs(y + dt / 2.0 * k2, K, F)\n    k4 = combined_rhs(y + dt * k3, K, F)\n    return y + dt / 6.0 * (k1 + 2 * k2 + 2 * k3 + k4)\n\ndef project(u: np.ndarray, K: int, k_c: int, subspace_type: str) - np.ndarray:\n    \"\"\"Projects a vector onto a specified spectral subspace.\"\"\"\n    if u.ndim != 1 or len(u) != K:\n        raise ValueError(\"Input vector must be 1D with length K.\")\n\n    wavenumbers = np.fft.fftfreq(K) * K\n    abs_k = np.abs(wavenumbers)\n    \n    if subspace_type == 'low':\n        mask = abs_k = k_c\n    elif subspace_type == 'high':\n        mask = (abs_k  k_c)  (abs_k = K // 2)\n    else:\n        raise ValueError(\"subspace_type must be 'low' or 'high'\")\n\n    u_hat = np.fft.fft(u)\n    u_hat_projected = u_hat * mask\n    return np.real(np.fft.ifft(u_hat_projected))\n\ndef run_l96_experiment(K: int, F: float, a: float, dt: float, T_short: float, \n                       T_long: float, k_c: int, epsilon: float) - List[float]:\n    \"\"\"Runs a single experiment case for the Lorenz '96 model.\"\"\"\n    \n    # 1. Initialization\n    i = np.arange(K)\n    x0 = F + a * np.sin(2 * np.pi * i / K)\n\n    w = np.cos(2 * np.pi * i / K) + 0.5 * np.cos(2 * np.pi * 5 * i / K)\n\n    v0_low_unscaled = project(w, K, k_c, 'low')\n    v0_high_unscaled = project(w, K, k_c, 'high')\n\n    v0_low = v0_low_unscaled / np.linalg.norm(v0_low_unscaled) * epsilon\n    v0_high = v0_high_unscaled / np.linalg.norm(v0_high_unscaled) * epsilon\n\n    norm_v0_low = np.linalg.norm(v0_low)\n    norm_v0_high = np.linalg.norm(v0_high)\n    \n    y = np.concatenate((x0, v0_low, v0_high))\n    \n    n_steps_short = round(T_short / dt)\n    n_steps_long = round(T_long / dt)\n    \n    ftle_low_short, ftle_high_short = 0.0, 0.0\n    \n    # 2. Time Integration\n    for step in range(1, n_steps_long + 1):\n        y = rk4_step(y, dt, K, F)\n        \n        if step == n_steps_short:\n            v_low_T_short = y[K:2*K]\n            v_high_T_short = y[2*K:3*K]\n\n            # Project final perturbations\n            v_low_T_short_proj = project(v_low_T_short, K, k_c, 'low')\n            v_high_T_short_proj = project(v_high_T_short, K, k_c, 'high')\n\n            norm_vT_low_short = np.linalg.norm(v_low_T_short_proj)\n            norm_vT_high_short = np.linalg.norm(v_high_T_short_proj)\n            \n            ftle_low_short = (1.0 / T_short) * np.log(norm_vT_low_short / norm_v0_low)\n            ftle_high_short = (1.0 / T_short) * np.log(norm_vT_high_short / norm_v0_high)\n\n    # 3. Final FTLE calculation at T_long\n    v_low_T_long = y[K:2*K]\n    v_high_T_long = y[2*K:3*K]\n    \n    v_low_T_long_proj = project(v_low_T_long, K, k_c, 'low')\n    v_high_T_long_proj = project(v_high_T_long, K, k_c, 'high')\n\n    norm_vT_low_long = np.linalg.norm(v_low_T_long_proj)\n    norm_vT_high_long = np.linalg.norm(v_high_T_long_proj)\n\n    ftle_low_long = (1.0 / T_long) * np.log(norm_vT_low_long / norm_v0_low)\n    ftle_high_long = (1.0 / T_long) * np.log(norm_vT_high_long / norm_v0_high)\n\n    return [ftle_low_short, ftle_high_short, ftle_low_long, ftle_high_long]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}