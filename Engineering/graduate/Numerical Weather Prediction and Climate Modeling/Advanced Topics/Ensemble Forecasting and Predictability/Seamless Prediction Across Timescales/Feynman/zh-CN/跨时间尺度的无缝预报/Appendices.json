{
    "hands_on_practices": [
        {
            "introduction": "地球系统模型包含多种时间尺度的过程，从快速的重力波到缓慢的平流运动。显式时间积分方案的步长受限于最快过程的稳定性条件（即CFL条件），这对于模拟较慢的大气和海洋环流而言效率极低。本练习旨在介绍一种核心的无缝隙预测技术——隐式-显式（IMEX）方法，它通过对快波进行隐式处理以保证稳定性，同时对慢波进行显式处理以提高计算效率，从而让您通过推导稳定性条件来理解其工作原理。",
            "id": "4086415",
            "problem": "一个一维、周期性的线性化浅水系统在 Arakawa C-网格上被用来表示与数值天气预报和气候模拟中跨时间尺度的无缝预测相关的快重力波和慢平流运动。设自由表面高度为 $\\eta_j(t)$，定义在整数索引 $j$ 上；速度为 $u_{j+1/2}(t)$，定义在半整数索引 $j+1/2$ 上。围绕均匀平均深度 $H>0$ 和均匀平均纬向流 $U$ 线性化的控制方程为：\n$$\n\\eta_t + U\\,\\eta_x + H\\,u_x = 0,\\qquad u_t + U\\,u_x + g\\,\\eta_x = 0,\n$$\n其中 $g>0$ 是重力加速度，重力波的相速度为 $c=\\sqrt{gH}$。网格具有均匀间距 $\\Delta x$ 和周期性边界条件。\n\nA部分（显式重力波动力学）：忽略平流项（设 $U=0$），并使用 Arakawa C-网格上的前向-后向时间步进格式对余下的快速线性重力波系统进行离散化：\n- 对于质量方程，使用前向欧拉步和针对 $u_x$ 的中心 C-网格差分，即\n$$\n\\eta^{n+1}_j \\;=\\; \\eta^n_j \\;-\\; \\Delta t\\,H\\,\\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x}.\n$$\n- 对于动量方程，使用后向欧拉步，通过中心 C-网格差分在半点上隐式处理 $\\eta_x$，即\n$$\nu^{n+1}_{j+1/2} \\;=\\; u^n_{j+1/2} \\;-\\; \\Delta t\\,g\\,\\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x}.\n$$\n使用与交错网格一致的标准 von Neumann (傅里叶) 稳定性分析，推导关于 $\\Delta t$ 的稳定性条件，并以 $\\Delta x$ 和 $c$ 的形式确定重力波动力学的最大稳定显式时间步长。\n\nB部分 (隐式–显式格式)：现在考虑包含 $U\\neq 0$ 的完整线性化系统。设计一个隐式–显式 (IMEX) 格式，该格式使用与上述相同的 Arakawa C-网格算子，以后向欧拉 (隐式) 处理快重力波耦合项 $H\\,u_x$ 和 $g\\,\\eta_x$，同时使用适用于 $U$ 符号的一阶迎风差分，以前向欧拉 (显式) 处理慢平流项 $U\\,\\eta_x$ 和 $U\\,u_x$。使用 von Neumann 分析，证明对重力波项的隐式处理消除了重力波的 Courant–Friedrichs–Lewy (CFL) 限制，并且稳定性转而由平流 CFL 条件控制。以 $\\Delta x$ 和 $U$ 的形式确定 IMEX 格式的最大稳定时间步长。\n\n答案规格：\n- 以一个依赖于 $c$, $U$ 和 $\\Delta x$ 的单一闭式解析表达式的形式，提供由 A 部分的最大稳定显式重力波时间步长和 B 部分的最大稳定 IMEX 时间步长组成的对。\n- 以秒为单位表示最终答案。\n- 不需要进行数值代入；不要四舍五入。",
            "solution": "本问题要求推导应用于一维线性化浅水方程的两种不同数值格式的稳定性条件。我们将对两个部分都使用 von Neumann 稳定性分析方法。\n\nA部分：重力波的显式前向-后向格式\n\n平均平流项设为零（$U=0$）的线性化浅水方程为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g \\frac{\\partial \\eta}{\\partial x} = 0\n$$\n问题指定了 Arakawa C-网格上的前向-后向时间步进格式：\n$$\n\\frac{\\eta^{n+1}_j - \\eta^n_j}{\\Delta t} = -H \\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x} \\quad (1)\n$$\n$$\n\\frac{u^{n+1}_{j+1/2} - u^n_{j+1/2}}{\\Delta t} = -g \\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x} \\quad (2)\n$$\n对于 von Neumann 分析，我们引入高度 $\\eta$ 和速度 $u$ 的傅里叶模态解。由于是交错网格，其拟设解为：\n$$\n\\eta^n_j = \\hat{\\eta}^n(k) e^{i k j \\Delta x}\n$$\n$$\nu^n_{j+1/2} = \\hat{u}^n(k) e^{i k (j+1/2) \\Delta x}\n$$\n其中 $k$ 是波数，$i=\\sqrt{-1}$，$\\hat{\\eta}^n$ 和 $\\hat{u}^n$ 是时间步 $n$ 上的傅里叶振幅。将这些代入方程 $(1)$ 和 $(2)$：\n\n从 $(1)$：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} e^{i k j \\Delta x} = - \\frac{H}{\\Delta x} \\left( \\hat{u}^n e^{i k (j+1/2) \\Delta x} - \\hat{u}^n e^{i k (j-1/2) \\Delta x} \\right)\n$$\n除以 $e^{i k j \\Delta x}$：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} = - \\frac{H \\hat{u}^n}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i H \\hat{u}^n}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{\\eta}^{n+1} = \\hat{\\eta}^n - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n \\quad (3)\n$$\n\n从 $(2)$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} e^{i k (j+1/2) \\Delta x} = - \\frac{g}{\\Delta x} \\left( \\hat{\\eta}^{n+1} e^{i k (j+1) \\Delta x} - \\hat{\\eta}^{n+1} e^{i k j \\Delta x} \\right)\n$$\n除以 $e^{i k (j+1/2) \\Delta x}$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = - \\frac{g \\hat{\\eta}^{n+1}}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i g \\hat{\\eta}^{n+1}}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{u}^{n+1} = \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\quad (4)\n$$\n为了求出增长因子 $\\lambda$，我们寻求一个单一变量的递推关系。从 $(3)$，我们可以用步长 $n$ 和 $n+1$ 时的 $\\hat{\\eta}$ 来表示 $\\hat{u}^n$。然后，将 $(4)$ 推进一个时间步可以进行代换。一个更直接的方法是将 $(3)$ 推进一个时间步到 $n+2$：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^{n+1}\n$$\n从 $(4)$ 中代入 $\\hat{u}^{n+1}$：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\left[ \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\right]\n$$\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\left( \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) \\hat{u}^n - \\frac{4 \\Delta t^2 g H}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\n从 $(3)$，我们替换含有 $\\hat{u}^n$ 的项：\n$$\n- \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n = \\hat{\\eta}^{n+1} - \\hat{\\eta}^n\n$$\n将此代入关于 $\\hat{\\eta}^{n+2}$ 的方程：\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} + (\\hat{\\eta}^{n+1} - \\hat{\\eta}^n) - \\frac{4 c^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\n其中 $c^2 = gH$。令 $K = \\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2$。递推关系为：\n$$\n\\hat{\\eta}^{n+2} - (2-K)\\hat{\\eta}^{n+1} + \\hat{\\eta}^n = 0\n$$\n假设解的形式为 $\\hat{\\eta}^n = \\lambda^n$，我们得到增长因子 $\\lambda$ 的特征方程：\n$$\n\\lambda^2 - (2-K)\\lambda + 1 = 0\n$$\n为使格式稳定，根 $\\lambda$ 的模不得超过 $1$，即 $|\\lambda| \\le 1$。根由二次公式给出：\n$$\n\\lambda = \\frac{(2-K) \\pm \\sqrt{(2-K)^2 - 4}}{2} = \\frac{2-K \\pm \\sqrt{K^2 - 4K}}{2}\n$$\n如果判别式为负或零，$K^2 - 4K \\le 0 \\implies K(K-4) \\le 0$。由于 $K \\ge 0$，这意味着 $0 \\le K \\le 4$。在这种情况下，根是共轭复数，且 $|\\lambda|^2 = \\left(\\frac{2-K}{2}\\right)^2 + \\frac{4K-K^2}{4} = \\frac{4-4K+K^2+4K-K^2}{4} = 1$\n因此，对于 $0 \\le K \\le 4$，我们有 $|\\lambda|=1$，格式是中性稳定的。如果 $K > 4$，根是实数且其乘积为 $1$。它们的和是 $2-K  -2$，这意味着一个根必须小于 $-1$，从而使格式不稳定。\n稳定性条件是 $K \\le 4$：\n$$\n\\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 \\le 4 \\implies \\frac{c \\Delta t}{\\Delta x} \\left|\\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right| \\le 1\n$$\n这个条件必须对所有可能的波数 $k$ 成立。最严格的情况发生在 $\\left|\\sin(k \\Delta x/2)\\right|$ 为最大值时，即 $1$（在奈奎斯特波数 $k = \\pi/\\Delta x$ 处）。因此，稳定性条件简化为重力波的 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\frac{c \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{c}\n$$\nA部分的最大稳定时间步长是 $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{c}$。\n\nB部分：隐式-显式 (IMEX) 格式\n\n现在我们考虑 $U \\neq 0$ 的完整系统。IMEX 格式使用一阶迎风差分显式处理平流项，并隐式处理重力波项。对于 $U>0$，迎风差分为 $(\\partial_x f)_j \\approx (f_j - f_{j-1})/\\Delta x$。离散化方程为：\n$$\n\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + U \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} + H \\frac{u_{j+1/2}^{n+1} - u_{j-1/2}^{n+1}}{\\Delta x} = 0\n$$\n$$\n\\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^n}{\\Delta t} + U \\frac{u_{j+1/2}^n - u_{j-1/2}^n}{\\Delta x} + g \\frac{\\eta_{j+1}^{n+1} - \\eta_j^{n+1}}{\\Delta x} = 0\n$$\n应用相同的傅里叶拟设解：\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{\\eta}^n(1 - e^{-ik\\Delta x}) + \\frac{H}{\\Delta x}\\hat{u}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{u}^n(1 - e^{-ik\\Delta x}) + \\frac{g}{\\Delta x}\\hat{\\eta}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n令 $\\mathbf{v}^n = [\\hat{\\eta}^n, \\hat{u}^n]^T$。该系统可以写成矩阵形式 $\\mathbf{M} \\mathbf{v}^{n+1} = \\mathbf{N} \\mathbf{v}^n$：\n$$\n\\begin{pmatrix} 1  \\frac{2i\\Delta t H}{\\Delta x} S \\\\ \\frac{2i\\Delta t g}{\\Delta x} S  1 \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n+1} \\\\ \\hat{u}^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})  0 \\\\ 0  1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x}) \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n} \\\\ \\hat{u}^{n} \\end{pmatrix}\n$$\n其中 $S = \\sin(k\\Delta x/2)$。增长矩阵是 $G = \\mathbf{M}^{-1}\\mathbf{N}$。\n令 $A_U = 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})$ 为显式迎风平流格式的增长因子。则 $\\mathbf{N} = A_U \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n$\\mathbf{M}$ 的行列式是 $\\det(\\mathbf{M}) = 1 - (i^2) \\frac{4\\Delta t^2 gH}{\\Delta x^2}S^2 = 1 + \\frac{4c^2\\Delta t^2}{\\Delta x^2}S^2 = 1 + K_c$，其中 $K_c = K$ 来自 A 部分。\n$G$ 的特征值 $\\lambda_G$ 是 $A_U$ 与 $\\mathbf{M}^{-1}$ 的特征值的乘积。$\\mathbf{M}$ 的特征值是 $1 \\pm \\sqrt{-K_c} = 1 \\pm i\\sqrt{K_c}$。因此，$\\mathbf{M}^{-1}$ 的特征值是 $\\frac{1}{1 \\pm i\\sqrt{K_c}} = \\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}$。\n完整增长矩阵 $G$ 的特征值是 $\\lambda_G = A_U \\left(\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right)$。\n为了稳定性，我们要求 $|\\lambda_G| \\le 1$。\n$$\n|\\lambda_G|^2 = |A_U|^2 \\left|\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right|^2 = |A_U|^2 \\frac{1+K_c}{(1+K_c)^2} = \\frac{|A_U|^2}{1+K_c}\n$$\n稳定性条件是 $\\frac{|A_U|^2}{1+K_c} \\le 1$，或 $|A_U|^2 \\le 1+K_c$。\n由于 $K_c = (\\frac{2c\\Delta t}{\\Delta x}\\sin(\\frac{k\\Delta x}{2}))^2 \\ge 0$，我们有 $1+K_c \\ge 1$。这意味着对重力波项的隐式处理具有稳定化效应。正如问题所提示的，稳定性由显式平流项控制。稳定性的一个充分条件是 $|A_U| \\le 1$，因为这将意味着 $|A_U|^2 \\le 1 \\le 1+K_c$。\n让我们分析 $|A_U| \\le 1$。令 $\\alpha = U\\Delta t/\\Delta x$（平流库朗数）和 $\\theta=k\\Delta x$。\n$$\nA_U = 1 - \\alpha(1-\\cos\\theta+i\\sin\\theta)\n$$\n$$\n|A_U|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta\n$$\n$$\n|A_U|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-2\\cos\\theta+\\cos^2\\theta+\\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + 2\\alpha^2(1-\\cos\\theta)\n$$\n$$\n|A_U|^2 = 1 + 2\\alpha(\\alpha-1)(1-\\cos\\theta)\n$$\n为了稳定性，$|A_U|^2 \\le 1$，这要求 $2\\alpha(\\alpha-1)(1-\\cos\\theta) \\le 0$。\n由于 $\\alpha = U\\Delta t/\\Delta x  0$ 且 $1-\\cos\\theta \\ge 0$，该不等式成立当且仅当 $\\alpha-1 \\le 0$，即 $\\alpha \\le 1$。\n对于 $U0$ 的分析将涉及迎风格式的向前空间差分，导致条件 $|U|\\Delta t/\\Delta x \\le 1$。因此，稳定性通常由平流 CFL 条件决定。\n$$\n\\frac{|U|\\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{|U|}\n$$\nIMEX 格式的最大稳定时间步长是 $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{|U|}$。这成功地消除了对快重力波速度 $c$ 的依赖。\n\n综合结果，A 部分和 B 部分的最大稳定时间步长对是 $(\\frac{\\Delta x}{c}, \\frac{\\Delta x}{|U|})$。这些表达式按要求具有秒的单位。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Delta x}{c}  \\frac{\\Delta x}{|U|}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在数值方法之外，可预测性的来源根植于地球系统的物理过程中。在次季节到季节（S2S）时间尺度上，海洋巨大的热容量提供了关键的“记忆”，使得长期预报成为可能。本练习将引导您使用一个简化的海洋混合层模型，通过推导海表温度异常的e折衰减时间，来量化这种海洋记忆，从而直接将一个物理属性（热惯性）与一个可预测性的度量联系起来。",
            "id": "4086435",
            "problem": "考虑一个用于数值天气预报和气候模拟的简化海洋体混合层模型，以评估跨时间尺度的无缝预测。假设海洋混合层具有恒定厚度 $h$，并受到表面热通量及其底部夹带作用的影响。定义海面温度 (SST) 异常 $T'(t)$ 为相对于气候平均值的偏差，并假设在次季节时间尺度上水平平流可忽略不计。混合层的热含量遵循能量守恒定律：海水密度 $\\rho_w$、恒压比热容 $c_p$ 和混合层厚度 $h$ 的乘积再乘以 SST 趋势（即温度变化率），等于进入海洋的表面热通量与因底部夹带而进入混合层的净热通量之和。使用线性体热通量反馈 $Q'(t) = -\\Lambda\\,T'(t)$ 来参数化异常表面热通量，并使用作用于混合层底部温度跃变 $(T_b - T)$ 的夹带速度 $w_e$ 来参数化夹带热通量。对于次季节异常，假设深层海洋温度异常消失，即 $T_b'(t) = 0$，并且没有外部随机强迫。从这些假设和能量守恒定律出发，推导控制 $T'(t)$ 的自治线性常微分方程，并获得在没有外部强迫的情况下，由 $T'(t) = T'(0)\\exp(-t/\\tau)$ 定义的 SST 异常的 e-折时间 $\\tau$ 的闭式表达式。然后，使用以下代表与次季节到季节 (S2S) 预报相关的亚热带海洋状况的科学合理参数值，数值计算 $\\tau$：\n- $\\rho_w = 1025$ (海水密度),\n- $c_p = 3990$ (恒压比热容),\n- $h = 40$ (混合层深度),\n- $\\Lambda = 30$ (线性体热通量反馈系数),\n- $w_e = 0.8$ (夹带速度，单位为米/天).\n以天为单位表示最终的 e-折时间。将您的答案四舍五入到 $4$ 位有效数字。如果需要，使用每天 $86400$ 秒进行单位转换。",
            "solution": "该问题要求推导海面温度（SST）异常 $T'(t)$ 的控制性常微分方程（ODE），并随后计算 e-折时间 $\\tau$。出发点是厚度为常数 $h$ 的海洋混合层的能量守恒原理。\n\n混合层单位面积热含量的变化率等于进入其中的净热通量。单位面积的热含量由体积热容 $\\rho_w c_p$、混合层厚度 $h$ 及其温度 $T$ 的乘积给出。假设 $h$ 是常数，能量平衡方程为：\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{net}\n$$\n其中 $\\rho_w$ 是海水密度，$c_p$ 是比热容，$Q_{net}$ 是进入该层的净热通量。$Q_{net}$ 是表面热通量 $Q_{surf}$ 和底部夹带热通量 $Q_{ent}$ 的和。\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{surf} + Q_{ent}\n$$\n温度 $T$ 可以分解为一个恒定的气候平均值 $T_{clim}$ 和一个随时间变化的异常 $T'$，使得 $T(t) = T_{clim} + T'(t)$。因此，$\\frac{dT}{dt} = \\frac{dT'}{dt}$。通量也同样被分解。异常表面热通量由线性反馈参数化 $Q'(t) = -\\Lambda T'(t)$ 给出，因此总表面通量为 $Q_{surf} = Q_{clim} + Q' = Q_{clim} - \\Lambda T'(t)$。\n\n夹带热通量是由于将混合层下方的较冷海水混合到混合层中而产生的。该通量与夹带速度 $w_e$ 以及混合层下方水的温度 $T_b$ 和混合层本身温度 $T$ 之间的温差成正比。这代表一种冷却效应，因为通常 $T_b  T$。该通量的标准物理公式为 $Q_{ent} = \\rho_w c_p w_e (T_b - T)$。底部温度 $T_b$ 也被分解为 $T_b(t) = T_{b,clim} + T_b'(t)$。\n\n将这些参数化代入能量平衡方程，得到：\n$$\n\\rho_w c_p h \\frac{d(T_{clim} + T')}{dt} = [Q_{clim} - \\Lambda T'] + [\\rho_w c_p w_e ((T_{b,clim} + T_b') - (T_{clim} + T'))]\n$$\n由于 $\\frac{dT_{clim}}{dt} = 0$，方程左边变为 $\\rho_w c_p h \\frac{dT'}{dt}$。展开右边可得：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = Q_{clim} - \\Lambda T' + \\rho_w c_p w_e (T_{b,clim} - T_{clim}) + \\rho_w c_p w_e (T_b' - T')\n$$\n在气候稳态下，所有异常项和时间导数项均为零。因此，平均态由以下方程平衡：\n$$\n0 = Q_{clim} + \\rho_w c_p w_e (T_{b,clim} - T_{clim})\n$$\n从完整的异常方程中减去这个平均态方程，即可得到 $T'$ 的控制方程：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' + \\rho_w c_p w_e (T_b' - T')\n$$\n题目规定，对于次季节异常，深海温度异常消失，即 $T_b' = 0$。应用此条件可将方程简化为：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' - \\rho_w c_p w_e T'\n$$\n这就是关于 $T'(t)$ 的自治线性常微分方程。我们可以将右侧的 $T'$ 因子提出来：\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -(\\Lambda + \\rho_w c_p w_e) T'\n$$\n将方程重排为标准形式 $\\frac{dT'}{dt} = -k T'$，可得：\n$$\n\\frac{dT'}{dt} = -\\left( \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h} \\right) T'\n$$\n该常微分方程的解形式为 $T'(t) = T'(0) \\exp(-kt)$。题目通过关系式 $T'(t) = T'(0)\\exp(-t/\\tau)$ 定义了 e-折时间 $\\tau$。通过比较这两种形式，我们确定衰减率 $k$ 是 e-折时间的倒数，即 $1/\\tau$。\n$$\n\\frac{1}{\\tau} = \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h}\n$$\n因此，e-折时间 $\\tau$ 的闭式表达式为：\n$$\n\\tau = \\frac{\\rho_w c_p h}{\\Lambda + \\rho_w c_p w_e}\n$$\n接下来，我们使用提供的参数值数值计算 $\\tau$。为保持一致性，所有单位都必须转换为国际单位制 (SI)。\n给定的参数是：\n- $\\rho_w = 1025 \\text{ kg} \\cdot \\text{m}^{-3}$\n- $c_p = 3990 \\text{ J} \\cdot \\text{kg}^{-1} \\cdot \\text{K}^{-1}$\n- $h = 40 \\text{ m}$\n- $\\Lambda = 30 \\text{ W} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1} = 30 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$\n- $w_e = 0.8 \\text{ m/day}$\n\n夹带速度 $w_e$ 必须使用转换因子 $1 \\text{ 天} = 86400 \\text{ s}$ 从米/天转换为米/秒：\n$$\nw_e = 0.8 \\frac{\\text{m}}{\\text{day}} \\times \\frac{1 \\text{ day}}{86400 \\text{ s}} = \\frac{0.8}{86400} \\text{ m} \\cdot \\text{s}^{-1}\n$$\n首先，计算分子，它代表混合层单位面积的热容量：\n$$\n\\text{分子} = \\rho_w c_p h = 1025 \\times 3990 \\times 40 = 163,590,000 \\text{ J} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n接下来，计算分母，它代表总阻尼系数。分母中的两项必须具有相同的单位 $\\text{J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$。\n$$\n\\text{分母} = \\Lambda + \\rho_w c_p w_e = 30 + (1025 \\times 3990 \\times \\frac{0.8}{86400})\n$$\n计算第二项：\n$$\n\\rho_w c_p w_e = 4,089,750 \\times \\frac{0.8}{86400} = \\frac{3,271,800}{86,400} \\approx 37.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n所以分母是：\n$$\n\\text{分母} = 30 + 37.868056 = 67.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\n现在，我们可以计算 $\\tau$。结果的单位将是秒。\n$$\n\\tau_s = \\frac{163,590,000}{67.868056} \\approx 2,410,389.6 \\text{ s}\n$$\n最后，我们将 e-折时间从秒转换为天：\n$$\n\\tau_{days} = \\frac{\\tau_s}{86400} = \\frac{2,410,389.6}{86400} \\approx 27.90034 \\text{ days}\n$$\n按要求将结果四舍五入到 $4$ 位有效数字，得到 $27.90$ 天。",
            "answer": "$$\n\\boxed{27.90}\n$$"
        },
        {
            "introduction": "一个完整的预报系统需要整合动力核心、物理过程和数据同化等多个组件，而确保物理量守恒是其中一个关键挑战。例如，半拉格朗日平流方案因其稳定性而被广泛使用，但其本身并不保证质量守恒；同样，数据同化步骤也可能引入质量偏差。本练习将探讨这些组件如何导致质量不守恒，并要求您推导一种常见且实用的订正方法，这突显了在现代无缝隙预测模型中“质量修复”的必要性。",
            "id": "4086386",
            "problem": "考虑一个有界域，它被离散化为 $N$ 个准拉格朗日控制体积（单元），其面积为 $\\{A_i\\}_{i=1}^{N}$，这些单元构成了水平面的一个划分。一个混合比为 $q$ 的无源示踪物在无辐散速度场（即 $\\nabla \\cdot \\boldsymbol{u} = 0$）的平流作用下演变，没有源或汇。在连续情况下，$q$ 的连续性方程的积分形式意味着区域积分质量 $M(t) = \\int_{\\Omega} q(\\boldsymbol{x}, t) \\,\\mathrm{d}A$ 不随时间变化。\n\n您使用半拉格朗日方法将 $q$ 向前推进一个时间步长 $\\Delta t$，该方法通过线性插值从离去点重构单元中心的预报场 $\\{q_f^i\\}_{i=1}^{N}$。这个离散映射可以抽象地写为\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij} \\, q^n_j,\n$$\n其中 $q^n_j$ 是上一个时间层单元 $j$ 中的示踪物混合比，$W_{ij} \\ge 0$ 是由半拉格朗日格式和离去点相对于网格的几何位置决定的插值权重。经过半拉格朗日步骤后的全局质量为 $M_f = \\sum_{i=1}^{N} A_i \\, q_f^i$。\n\n接下来，您执行一个三维变分（3D-Var）数据同化分析，通过增量 $\\{d^i\\}_{i=1}^{N}$ 将预报场更新为分析场，\n$$\nq_a^i = q_f^i + d^i.\n$$\n3D-Var 增量向量 $\\boldsymbol{d}$ 是一个二次代价函数的极小化子，该代价函数由一个对称正定的背景误差协方差矩阵和一个对称正定的观测误差协方差矩阵定义，但在分析中没有显式的质量约束。\n\n假设 $\\nabla \\cdot \\boldsymbol{u} = 0$ 且没有源或汇，并假设没有穿过 $\\partial \\Omega$ 的边界通量。从积分守恒定律和上述离散形式出发：\n\n- 推导插值权重 $\\{W_{ij}\\}$ 需满足的条件，该条件足以使半拉格朗日步骤离散质量守恒，并说明为什么半拉格朗日格式中的一般线性插值可能会违反此条件。\n- 证明在一般情况下，3D-Var 分析会在离散层面上引入全局质量差异。\n- 提出一种统一应用于分析场 $q_c^i = s \\, q_a^i$ 的单一标量订正策略，将区域积分质量恢复到半拉格朗日预报质量 $M_f$，并达到机器精度。\n- 在上述假设下，推导标量 $s$ 关于 $\\{A_i\\}_{i=1}^{N}$、$\\{q_f^i\\}_{i=1}^{N}$ 和 $\\{q_a^i\\}_{i=1}^{N}$ 的闭式解析表达式。您的最终答案必须仅为 $s$ 的表达式。不需要进行数值计算。\n\n将您的最终答案表示为一个解析表达式。不包含任何单位，也不要四舍五入。答案必须是单个表达式。",
            "solution": "在无辐散流的平流作用下，无源汇的无源示踪物混合比守恒的基本依据是连续性方程。令 $q(\\boldsymbol{x}, t)$ 为无源示踪物混合比。其欧拉形式为\n$$\n\\frac{\\partial q}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla q = 0,\n$$\n并且在 $\\nabla \\cdot \\boldsymbol{u} = 0$（无辐散流）的条件下，通量形式 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\boldsymbol{u}) = 0$ 简化为平流方程。在没有边界通量的闭合域 $\\Omega$ 上对通量形式进行积分，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} q \\,\\mathrm{d}A = - \\int_{\\partial \\Omega} q \\, \\boldsymbol{u} \\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\n因此区域积分质量 $M(t) = \\int_{\\Omega} q \\,\\mathrm{d}A$ 不随时间变化。\n\n在一个有 $N$ 个控制体积（面积为 $\\{A_i\\}$）和单元中心值的离散情况下，时间层 $n$ 的区域质量为 $M^n = \\sum_{j=1}^{N} A_j \\, q^n_j$。半拉格朗日预报为\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij}\\, q^n_j,\n$$\n其中权重 $W_{ij}\\ge 0$ 由离去点插值确定。经过半拉格朗日步骤后的全局质量为\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i = \\sum_{i=1}^{N} A_i \\sum_{j=1}^{N} W_{ij}\\, q^n_j = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij}\\right) q^n_j.\n$$\n为了使半拉格朗日步骤对于任意的 $\\{q^n_j\\}$ 都是离散质量守恒的，一个充分条件是该映射能保持从源到目标的面积权重，即\n$$\n\\sum_{i=1}^{N} A_i \\, W_{ij} = A_j \\quad \\text{for all } j \\in \\{1,\\dots,N\\}.\n$$\n在此条件下，\n$$\nM_f = \\sum_{j=1}^{N} A_j \\, q^n_j = M^n,\n$$\n质量是离散守恒的。半拉格朗日格式中使用的一般线性插值旨在保证沿轨迹的场值是准确的，但通常不强制执行面积加权恒等式 $\\sum_{i} A_i W_{ij} = A_j$。权重 $\\{W_{ij}\\}$ 通常被归一化，使得对每个 $i$ 都有 $\\sum_{j} W_{ij} = 1$，以确保局部重构的一致性，但对面积加权的列和没有保证。因此，在没有守恒重映的情况下，半拉格朗日步骤会引入一个全局质量误差\n$$\n\\varepsilon_{\\mathrm{SL}} = M_f - M^n = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij} - A_j\\right) q^n_j,\n$$\n该误差在一般情况下非零。\n\n三维变分（3D-Var）分析将 $\\boldsymbol{d}$ 构建为一个二次代价函数的极小化子，通常为\n$$\nJ(\\boldsymbol{x}) = \\frac{1}{2}(\\boldsymbol{x}-\\boldsymbol{x}_f)^{\\top} \\boldsymbol{B}^{-1} (\\boldsymbol{x}-\\boldsymbol{x}_f) + \\frac{1}{2}(\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y}),\n$$\n其中 $\\boldsymbol{x}$ 汇集了离散状态，$\\boldsymbol{x}_f$ 是预报，$\\boldsymbol{B}$ 是背景误差协方差矩阵，$\\boldsymbol{H}$ 是观测算子，$\\boldsymbol{R}$ 是观测误差协方差矩阵。在标准形式中，没有硬约束强制 $\\sum_{i=1}^{N} A_i \\, d^i = 0$。因此，在分析之后\n$$\nq_a^i = q_f^i + d^i,\n$$\n分析质量为\n$$\nM_a = \\sum_{i=1}^{N} A_i \\, q_a^i = \\sum_{i=1}^{N} A_i \\, q_f^i + \\sum_{i=1}^{N} A_i \\, d^i = M_f + \\varepsilon_{\\mathrm{3DVar}},\n$$\n其中\n$$\n\\varepsilon_{\\mathrm{3DVar}} = \\sum_{i=1}^{N} A_i \\, d^i,\n$$\n在一般情况下非零。综合效应是 $M_a \\ne M^n$ 且 $M_a \\ne M_f$，除非强制执行特殊的相容性约束或守恒重映。\n\n为了将质量精确恢复到半拉格朗日预报质量 $M_f$ 并达到机器精度，一个简单的标量订正策略是通过一个统一的乘法因子 $s$ 来重定标度分析场：\n$$\nq_c^i = s \\, q_a^i, \\quad i = 1,\\dots,N.\n$$\n订正后的质量为\n$$\nM_c = \\sum_{i=1}^{N} A_i \\, q_c^i = \\sum_{i=1}^{N} A_i \\, s \\, q_a^i = s \\sum_{i=1}^{N} A_i \\, q_a^i = s \\, M_a.\n$$\n施加 $M_c = M_f$ 的要求会得到一个关于 $s$ 的标量方程：\n$$\ns \\, M_a = M_f \\quad \\Longrightarrow \\quad s = \\frac{M_f}{M_a}.\n$$\n用离散场表示，\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i, \\qquad M_a = \\sum_{i=1}^{N} A_i \\, q_a^i,\n$$\n所以订正因子的闭式解析表达式为\n$$\ns = \\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}.\n$$\n这种乘法订正将分析后的全局质量恢复到与半拉格朗日预报质量相等，并达到机器精度，因为得到的订正后质量在求和的浮点舍入误差范围内为 $M_c = s M_a = M_f$。这是一种最小秩订正（标量），它保持了相对于 $\\boldsymbol{q}_a$ 的分析场的空间形状，并且如果 $\\boldsymbol{q}_a$ 是正的且 $M_f/M_a > 0$，则能保持正定性。",
            "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}}$$"
        }
    ]
}