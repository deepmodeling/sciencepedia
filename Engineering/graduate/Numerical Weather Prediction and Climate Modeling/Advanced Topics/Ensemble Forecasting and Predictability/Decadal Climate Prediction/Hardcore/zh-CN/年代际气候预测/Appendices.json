{
    "hands_on_practices": [
        {
            "introduction": "年代际预测的可预报性主要源于气候系统中一些变化缓慢的组成部分，例如海洋热含量。这个练习通过一个简单的一阶自回归（AR(1)）过程来模拟这种“记忆”，并推导其持续性预报技巧。通过这个实践，你将理解可预报性如何源于系统的记忆，以及这种技巧如何随预报时间的延长而衰减 。",
            "id": "4030524",
            "problem": "在年代际气候预测中，缓慢变化的成分，如海盆平均上层海洋热含量异常，通常被建模为一阶自回归过程。考虑一个用于年分辨率下海洋热含量异常序列 $\\{X_t\\}$ 的零均值一阶自回归 (AR(1)) 过程，由 $X_{t+1} = \\phi X_t + \\epsilon_t$ 给出，其中 $\\{ \\epsilon_t \\}$ 是一个零均值、序列不相关（白）噪声过程，其方差为 $\\sigma_{\\epsilon}^{2}$，且独立于 $\\{X_t\\}$，并且 $|\\phi|  1$，因此该过程是具有有限方差的严平稳过程。在时间 $t$ 为超前时间 $L$ 发布的持续性预报使用 $F_{t+L|t} = X_t$ 作为 $X_{t+L}$ 的预报。超前时间 $L$ 的异常相关系数 (ACC) 定义为在平稳分布下，对许多独立预报实例计算的预报异常与验证异常之间的皮尔逊相关系数，即 $\\mathrm{ACC}(L) = \\mathrm{Corr}(F_{t+L|t}, X_{t+L})$。\n\n仅从 AR(1) 定义、白噪声假设和相关性定义出发，推导期望 $\\mathrm{ACC}(L)$ 作为 $\\phi$ 和 $L$ 的函数的闭式表达式。以闭式形式给出最终表达式。然后，根据该模型中海洋热含量异常的记忆性来解释该表达式。最终答案必须是一个无单位的解析表达式。不需要进行数值舍入。",
            "solution": "我们从海洋热含量异常的模型定义开始，它是一个零均值的一阶自回归 (AR(1)) 过程：\n$$\nX_{t+1} = \\phi X_t + \\epsilon_t,\n$$\n其中 $|\\phi|  1$，且 $\\{\\epsilon_t\\}$ 是一个零均值、序列不相关（白）噪声新息序列，其方差为 $\\sigma_{\\epsilon}^{2}$ 且独立于 $\\{X_t\\}$。在这些条件下，该过程是具有有限方差的严平稳过程。\n\n在时间 $t$ 为超前时间 $L$ 的持续性预报定义为\n$$\nF_{t+L|t} = X_t.\n$$\n超前时间 $L$ 的异常相关系数 (ACC) 是在平稳分布下，从许多预报实例中抽取的 $F_{t+L|t}$ 与验证异常 $X_{t+L}$ 之间的皮尔逊相关系数：\n$$\n\\mathrm{ACC}(L) = \\mathrm{Corr}(F_{t+L|t}, X_{t+L}) = \\frac{\\mathrm{Cov}(F_{t+L|t}, X_{t+L})}{\\sqrt{\\mathrm{Var}(F_{t+L|t}) \\, \\mathrm{Var}(X_{t+L})}}.\n$$\n在平稳性条件下，$\\mathrm{Var}(X_{t+L}) = \\mathrm{Var}(X_t)$。同时，$\\mathrm{Var}(F_{t+L|t}) = \\mathrm{Var}(X_t)$。因此，\n$$\n\\mathrm{ACC}(L) = \\frac{\\mathrm{Cov}(X_t, X_{t+L})}{\\mathrm{Var}(X_t)}.\n$$\n\n接下来需要计算 $\\mathrm{Cov}(X_t, X_{t+L})$。将 AR(1) 模型向前迭代 $L$ 步，得到众所周知的线性分解（可通过重复代换获得）：\n$$\nX_{t+L} = \\phi^{L} X_t + \\sum_{k=0}^{L-1} \\phi^{k} \\epsilon_{t+L-1-k}.\n$$\n新息序列 $\\{\\epsilon_s\\}$ 独立于 $X_t$ 且序列不相关。因此，\n$$\n\\mathrm{Cov}(X_t, X_{t+L}) = \\mathrm{Cov}\\!\\left(X_t, \\phi^{L} X_t + \\sum_{k=0}^{L-1} \\phi^{k} \\epsilon_{t+L-1-k}\\right) = \\phi^{L} \\mathrm{Cov}(X_t, X_t) + \\sum_{k=0}^{L-1} \\phi^{k} \\mathrm{Cov}(X_t, \\epsilon_{t+L-1-k}).\n$$\n对于每个 $k$，$\\epsilon_{t+L-1-k}$ 独立于 $X_t$，所以 $\\mathrm{Cov}(X_t, \\epsilon_{t+L-1-k}) = 0$。因此，\n$$\n\\mathrm{Cov}(X_t, X_{t+L}) = \\phi^{L} \\mathrm{Var}(X_t).\n$$\n代入 ACC 表达式可得\n$$\n\\mathrm{ACC}(L) = \\frac{\\phi^{L} \\mathrm{Var}(X_t)}{\\mathrm{Var}(X_t)} = \\phi^{L}.\n$$\n\n这就是在 AR(1) 模型下，持续性预报在超前时间 $L$ 的期望异常相关系数的闭式表达式。\n\n关于记忆性的解释：ACC 等于 $\\phi^{L}$，即 AR(1) 过程在滞后 $L$ 时的自相关函数。因此，持续性预报的预报技巧随超前时间呈几何衰减，其幅度由 $|\\phi|$ 控制。有效记忆时间尺度，定义为以时间步长为单位的 $e$ 折退相关时间，为\n$$\n\\tau = -\\frac{1}{\\ln |\\phi|}.\n$$\n当 $0  \\phi  1$ 时，ACC 为正，并随 $L$ 单调衰减。如果 $\\phi  0$，ACC 的符号随 $L$ 交替变化，而其幅度按 $|\\phi|^{L}$ 衰减。较大的 $|\\phi|$ 意味着更长的记忆和更慢的基于持续性的预报技巧随超前时间的损失。",
            "answer": "$$\\boxed{\\phi^{L}}$$"
        },
        {
            "introduction": "在获得了预报结果之后，我们需要一个客观的方法来评估其质量。本练习介绍了一个关键的评估指标——均方技巧评分（$MSSS$），它通过将模型的预报与一个基准（如气候平均态）进行比较来量化技巧。这个练习不仅让你掌握$MSSS$的计算，更重要的是，它促使你思考选择不同基准将如何影响对预报技巧的解读 。",
            "id": "4030497",
            "problem": "考虑一个针对区域平均地表温度距平时间序列的年代际气候预测实验。设存在 $n$ 个年代际验证时间点，索引为 $i = 1, \\dots, n$。将预测距平表示为 $f_i$，观测距平表示为 $o_i$，参考气候学预测表示为 $c_i$。在此实验中，技巧评分定义为预测的均方误差相对于参考预测的均方误差的相对改进。\n\n从均方误差的基本定义 $MSE[X] = \\mathbb{E}\\left[(X - O)^{2}\\right]$ 出发，并使用其对于有限 $n$ 的无偏样本估计量 $\\frac{1}{n}\\sum_{i=1}^{n}(X_i - o_i)^{2}$，推导均方技巧评分（Mean Square Skill Score）的解析表达式，该表达式应以预测相对于气候学参考的误差平方和来表示。\n\n然后，将您推导的表达式应用于以下八个年代际的数据集（$n = 8$）。观测距平为\n$o_1 = 0.12$, $o_2 = -0.08$, $o_3 = 0.05$, $o_4 = 0.10$, $o_5 = -0.02$, $o_6 = 0.03$, $o_7 = 0.07$, $o_8 = -0.01$。\n预测距平为\n$f_1 = 0.10$, $f_2 = -0.05$, $f_3 = 0.00$, $f_4 = 0.12$, $f_5 = 0.00$, $f_6 = 0.02$, $f_7 = 0.06$, $f_8 = -0.02$。\n假设参考气候学是一个固定的距平基线，即对于所有 $i$，$c_i = 0$（也就是说，距平是相对于一个固定的基线期定义的，因此整个时期的气候学距平为零）。\n\n计算此数据集的均方技巧评分。将您的最终结果四舍五入到四位有效数字。将最终的技巧评分表示为一个无量纲小数。\n\n最后，解释参考气候学 $c_i$ 的选择（例如，固定基线与包含趋势估计的随时间演变的气候学）如何影响年代际预测中技巧评分的解释。",
            "solution": "**第一部分：均方技巧评分 (MSSS) 表达式的推导**\n\n均方技巧评分 (Mean Square Skill Score, MSSS) 定义为预测 ($f$) 相对于参考预测 ($c$) 的均方误差 (Mean-Square Error, MSE) 的相对改进，二者均对照观测 ($o$)进行评估。对于像 MSE 这样的误差度量，其值越低越好，完美评分为 $0$，技巧评分由以下公式给出：\n$$\nMSSS = \\frac{MSE_c - MSE_f}{MSE_c} = 1 - \\frac{MSE_f}{MSE_c}\n$$\n其中 $MSE_f$ 是预测的 MSE，$MSE_c$ 是参考预测的 MSE。\n\n使用所提供的对于长度为 $n$ 的时间序列的无偏样本估计量，我们有：\n$$\nMSE_f = \\frac{1}{n}\\sum_{i=1}^{n}(f_i - o_i)^{2}\n$$\n$$\nMSE_c = \\frac{1}{n}\\sum_{i=1}^{n}(c_i - o_i)^{2}\n$$\n将这些代入 MSSS 的定义中，$\\frac{1}{n}$ 项相互抵消：\n$$\nMSSS = 1 - \\frac{\\sum_{i=1}^{n}(f_i - o_i)^{2}}{\\sum_{i=1}^{n}(c_i - o_i)^{2}}\n$$\n为了推导问题所要求的表达式，我们可以处理分子。通过加减参考预测 $c_i$ 来展开项 $(f_i - o_i)^2$：\n$$\n(f_i - o_i)^2 = ((f_i - c_i) - (o_i - c_i))^2 = (f_i - c_i)^2 - 2(f_i - c_i)(o_i - c_i) + (o_i - c_i)^2\n$$\n对所有 $i=1, \\dots, n$ 求和：\n$$\n\\sum_{i=1}^{n}(f_i - o_i)^{2} = \\sum_{i=1}^{n}(f_i - c_i)^2 - 2\\sum_{i=1}^{n}(f_i - c_i)(o_i - c_i) + \\sum_{i=1}^{n}(o_i - c_i)^2\n$$\n现在，将这个展开的分子代回 MSSS 表达式中：\n$$\nMSSS = 1 - \\frac{\\sum_{i=1}^{n}(f_i - c_i)^2 - 2\\sum_{i=1}^{n}(f_i - c_i)(o_i - c_i) + \\sum_{i=1}^{n}(o_i - c_i)^2}{\\sum_{i=1}^{n}(c_i - o_i)^{2}}\n$$\n注意到 $\\sum_{i=1}^{n}(o_i - c_i)^{2} = \\sum_{i=1}^{n}(c_i - o_i)^{2}$，我们可以将分数拆分：\n$$\nMSSS = 1 - \\left( \\frac{\\sum_{i=1}^{n}(f_i - c_i)^2}{\\sum_{i=1}^{n}(c_i - o_i)^{2}} - \\frac{2\\sum_{i=1}^{n}(f_i - c_i)(o_i - c_i)}{\\sum_{i=1}^{n}(c_i - o_i)^{2}} + 1 \\right)\n$$\n$$\nMSSS = \\frac{2\\sum_{i=1}^{n}(f_i - c_i)(o_i - c_i) - \\sum_{i=1}^{n}(f_i - c_i)^2}{\\sum_{i=1}^{n}(c_i - o_i)^{2}}\n$$\n这就是所求的 MSSS 的解析表达式。对于参考气候学为零距平的特殊情况，即对所有 $i$ 都有 $c_i = 0$，该表达式简化为：\n$$\nMSSS = \\frac{2\\sum_{i=1}^{n}f_i o_i - \\sum_{i=1}^{n}f_i^2}{\\sum_{i=1}^{n}o_i^2}\n$$\n\n**第二部分：对给定数据集的计算**\n\n数据集是针对 $n=8$ 个年代际给出的。\n观测距平: $o = [0.12, -0.08, 0.05, 0.10, -0.02, 0.03, 0.07, -0.01]$。\n预测距平: $f = [0.10, -0.05, 0.00, 0.12, 0.00, 0.02, 0.06, -0.02]$。\n参考气候学: 对所有 $i$，$c_i = 0$。\n\n我们将使用针对 $c_i=0$ 的简化公式。\n首先，计算分母 $\\sum_{i=1}^{8} o_i^2$：\n$$\n\\sum_{i=1}^{8} o_i^2 = (0.12)^2 + (-0.08)^2 + (0.05)^2 + (0.10)^2 + (-0.02)^2 + (0.03)^2 + (0.07)^2 + (-0.01)^2\n$$\n$$\n\\sum_{i=1}^{8} o_i^2 = 0.0144 + 0.0064 + 0.0025 + 0.0100 + 0.0004 + 0.0009 + 0.0049 + 0.0001 = 0.0396\n$$\n接下来，计算分子中的两项。\n第一项是 $2\\sum_{i=1}^{8} f_i o_i$：\n$$\n\\sum_{i=1}^{8} f_i o_i = (0.10)(0.12) + (-0.05)(-0.08) + (0.00)(0.05) + (0.12)(0.10) + (0.00)(-0.02) + (0.02)(0.03) + (0.06)(0.07) + (-0.02)(-0.01)\n$$\n$$\n\\sum_{i=1}^{8} f_i o_i = 0.0120 + 0.0040 + 0 + 0.0120 + 0 + 0.0006 + 0.0042 + 0.0002 = 0.0330\n$$\n所以，$2\\sum_{i=1}^{8} f_i o_i = 2 \\times 0.0330 = 0.0660$。\n\n第二项是 $\\sum_{i=1}^{8} f_i^2$：\n$$\n\\sum_{i=1}^{8} f_i^2 = (0.10)^2 + (-0.05)^2 + (0.00)^2 + (0.12)^2 + (0.00)^2 + (0.02)^2 + (0.06)^2 + (-0.02)^2\n$$\n$$\n\\sum_{i=1}^{8} f_i^2 = 0.0100 + 0.0025 + 0 + 0.0144 + 0 + 0.0004 + 0.0036 + 0.0004 = 0.0313\n$$\n现在，组合成 MSSS：\n$$\nMSSS = \\frac{2\\sum f_i o_i - \\sum f_i^2}{\\sum o_i^2} = \\frac{0.0660 - 0.0313}{0.0396} = \\frac{0.0347}{0.0396}\n$$\n$$\nMSSS \\approx 0.87626262...\n$$\n四舍五入到四位有效数字，结果是 $0.8763$。\n\n**第三部分：参考气候学作用的解释**\n\n参考预测 $c_i$ 的选择是解释像 MSSS 这样的技巧评分的关键方面，因为它定义了衡量技巧的基线。MSSS 值为 $0$ 意味着预测的表现不优于此基线。\n\n1.  **固定基线气候学 ($c_i = 0$ 或 $c_i = \\text{constant}$):** 这种参考通常简称为“气候学”，它假设未来状态将是长期平均值，意味着零距平。此参考的 MSE，$MSE_c = \\frac{1}{n} \\sum (o_i - 0)^2$，是均方距平，与观测时间序列的方差密切相关。如果一个预测平均而言比零猜测更接近观测到的距平，那么它相对于这个参考就会获得正的技巧评分 ($MSSS > 0$)。在年代际预测的背景下，气候系统表现出强迫趋势（例如，由于人为增暖）和低频内部变率。固定基线是一个“低门槛”的技巧标准，因为任何能简单捕捉到长期变暖趋势的预测，都很容易胜过一个假设没有变化的参考。相对于固定基线的高 MSSS 可能主要反映了模型再现强迫气候响应的能力，而不一定反映其预测更具混沌性的内部年代际波动的能力。\n\n2.  **随时间演变的气候学（例如，包含趋势）:** 这是一个更复杂、更严格的参考。例如，$c_i$ 可以由拟合过去观测的线性趋势来定义，如 $c_i = a \\cdot t_i + b$。这种参考预测假设未来将遵循最近观测到的趋势。年代际预测的目标不仅是捕捉这种强迫趋势，还要预测*偏离*该趋势的偏差，这些偏差由气候系统的初始状态（例如，初始海洋热含量）及其内部动力学（例如，像大西洋多年代际振荡这样的模态）驱动。为了相对于基于趋势的参考获得正的技巧评分，预测系统 ($f_i$) 必须提供比单独的趋势外推更准确的全距平预测。这意味着它必须在预测年代际尺度内部气候变率的时间和振幅方面具有“真正的技巧”。\n\n总之，$c_i$ 的选择从根本上改变了所要回答的科学问题。使用固定基线评估的是预测是否优于假设气候是静态的。使用随时间演变的基线评估的是预测是否能预测超出可预测的外部强迫趋势之外的内部产生的气候变异。后者是一个高得多的标准，并且对于评估先进年代际预测系统的进展和效用更为相关。",
            "answer": "$$\\boxed{0.8763}$$"
        },
        {
            "introduction": "评估预报技巧时，尤其是在样本量有限的十年际预测中，必须警惕统计陷阱。“样本内”偏差校正可能导致技巧被高估，这种现象被称为“技巧虚高”。本练习通过一个编程任务，让你亲手实现“留一法”交叉验证，这是一种获得更稳健、更真实的预报技巧评估的重要方法 。",
            "id": "4030499",
            "problem": "给定一个全球平均气候指数的确定性年代际后报异常和相应的观测异常。将预报偏差视为预报与观测之间的期望差异。从数值天气预报和气候模拟领域的核心统计定义出发，构建一个程序，使用留一法 (LOO) 后报计算交叉验证的偏差校正，并量化其与样本内校正相比对技巧膨胀的影响。使用具有物理意义的单位进行计算。\n\n基本原理：\n- 定义年份索引为 $t$ 的预报为 $f_t$，观测为 $y_t$，其中 $t \\in \\{1, \\dots, N\\}$。\n- 定义预报误差 $e_t$ 为 $e_t = f_t - y_t$。\n- 定义恒定偏差 $\\beta$ 为期望 $\\beta = \\mathbb{E}[e_t]$。\n- 使用样本均值从 $N$ 年的集合中估计偏差：$\\hat{\\beta} = \\frac{1}{N}\\sum_{t=1}^{N} e_t$。\n- 在留一法交叉验证中，对于每个目标年份 $t$，使用所有其他年份来估计偏差：$\\hat{\\beta}_{-t} = \\frac{1}{N-1}\\sum_{s \\neq t} e_s$。\n\n技巧量化：\n- 定义年份 $t$ 的经偏差校正的样本内预报为 $\\tilde{f}_t^{\\text{in}} = f_t - \\hat{\\beta}$。\n- 定义年份 $t$ 的经偏差校正的交叉验证预报为 $\\tilde{f}_t^{\\text{cv}} = f_t - \\hat{\\beta}_{-t}$。\n- 定义均方误差 (MSE) 为 $\\mathrm{MSE} = \\frac{1}{N}\\sum_{t=1}^{N} (\\tilde{f}_t - y_t)^2$，其中 $\\tilde{f}_t$ 是评估中使用的校正后预报。\n- 定义技巧膨胀（正值表示样本内校正看起来人为地更好）为差值 $\\Delta = \\mathrm{MSE}_{\\text{cv}} - \\mathrm{MSE}_{\\text{in}}$。\n\n单位和数值要求：\n- 所有异常均以开尔文 ($\\mathrm{K}$) 为单位。您必须以平方开尔文 ($\\mathrm{K}^2$) 为单位计算并报告技巧膨胀 $\\Delta$。返回原始小数值。\n- 不涉及角度。\n- 最终输出必须将整个测试套件的结果汇总为单行：一个用方括号括起来的逗号分隔列表，例如 $[x_1, x_2, x_3]$。\n\n测试套件：\n对于以下每种情况，将所提供的序列视为完整的 $N$ 年后报-观测对。按规定计算 $\\Delta$ 并按顺序返回四个结果。\n\n1. 理想情况，样本量 $N = 10$ 为中等，具有近似恒定的正偏差：\n   - 观测值 $y^{(1)}$: $[0.10, 0.20, 0.00, -0.10, 0.30, 0.40, 0.20, 0.00, -0.20, 0.10]$ $\\mathrm{K}$\n   - 后报值 $f^{(1)}$: $[0.42, 0.49, 0.31, 0.20, 0.58, 0.73, 0.49, 0.32, 0.07, 0.40]$ $\\mathrm{K}$\n\n2. 边界情况，样本量 $N = 3$ 极小：\n   - 观测值 $y^{(2)}$: $[0.00, 0.40, -0.20]$ $\\mathrm{K}$\n   - 后报值 $f^{(2)}$: $[0.70, 0.80, 0.20]$ $\\mathrm{K}$\n\n3. 边缘情况，完美预报 $N = 8$：\n   - 观测值 $y^{(3)}$: $[0.05, -0.05, 0.10, -0.10, 0.00, 0.02, -0.03, 0.04]$ $\\mathrm{K}$\n   - 后报值 $f^{(3)}$: $[0.05, -0.05, 0.10, -0.10, 0.00, 0.02, -0.03, 0.04]$ $\\mathrm{K}$\n\n4. 趋势不匹配，偏差随时间变化 $N = 10$：\n   - 观测值 $y^{(4)}$: $[0.00, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]$ $\\mathrm{K}$\n   - 后报值 $f^{(4)}$: $[0.20, 0.33, 0.46, 0.55, 0.64, 0.77, 0.83, 0.96, 1.04, 1.15]$ $\\mathrm{K}$\n\n实现要求：\n- 对于每种情况，计算样本内偏差 $\\hat{\\beta}$、样本内校正预报 $\\tilde{f}_t^{\\text{in}}$ 和 $\\mathrm{MSE}_{\\text{in}}$。\n- 对于每种情况，计算每个 $t$ 的留一法偏差 $\\hat{\\beta}_{-t}$、留一法校正预报 $\\tilde{f}_t^{\\text{cv}}$ 和 $\\mathrm{MSE}_{\\text{cv}}$。\n- 对于每种情况，以 $\\mathrm{K}^2$ 为单位计算技巧膨胀 $\\Delta = \\mathrm{MSE}_{\\text{cv}} - \\mathrm{MSE}_{\\text{in}}$ 并收集四个 $\\Delta$ 值。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[x_1,x_2,x_3,x_4]$），其中每个 $x_i$ 是一个以 $\\mathrm{K}^2$ 为单位的小数。\n\n数据是固定的和自包含的。您的实现必须是确定性的和自包含的，仅使用标准的数值例程，无需外部输入或文件。留一法 (LOO) 和均方误差 (MSE) 必须直接根据上述定义实现。",
            "solution": "我们从适用于年代际气候后报评估的基本定义开始。年份索引为 $t$ 的预报是 $f_t$，观测是 $y_t$。预报误差是 $e_t = f_t - y_t$。偏差是误差的期望值，$\\beta = \\mathbb{E}[e_t]$，而一个基于 $N$ 个样本的标准且被广泛接受的估计量是样本均值 $\\hat{\\beta} = \\frac{1}{N}\\sum_{t=1}^{N} e_t$。\n\n偏差校正对预报应用一个恒定的移位以消除平均误差。对于样本内校正，每个 $t$ 的经偏差校正的预报是 $\\tilde{f}_t^{\\text{in}} = f_t - \\hat{\\beta}$。样本内校正下的均方误差 (MSE) 是\n$$\n\\mathrm{MSE}_{\\text{in}} = \\frac{1}{N}\\sum_{t=1}^{N} (\\tilde{f}_t^{\\text{in}} - y_t)^2 \n= \\frac{1}{N}\\sum_{t=1}^{N} (f_t - \\hat{\\beta} - y_t)^2 \n= \\frac{1}{N}\\sum_{t=1}^{N} (e_t - \\hat{\\beta})^2.\n$$\n\n为避免因在训练集中重复使用验证目标而导致的技巧膨胀，留一法 (LOO) 交叉验证使用所有其他年份来估计每个目标年份 $t$ 的偏差：\n$$\n\\hat{\\beta}_{-t} = \\frac{1}{N-1}\\sum_{s \\neq t} e_s.\n$$\n年份 $t$ 的经留一法校正的预报是 $\\tilde{f}_t^{\\text{cv}} = f_t - \\hat{\\beta}_{-t}$，相应的均方误差是\n$$\n\\mathrm{MSE}_{\\text{cv}} = \\frac{1}{N}\\sum_{t=1}^{N} (\\tilde{f}_t^{\\text{cv}} - y_t)^2 \n= \\frac{1}{N}\\sum_{t=1}^{N} (e_t - \\hat{\\beta}_{-t})^2.\n$$\n\n现在我们将这些定义联系起来以量化技巧膨胀。用 $m = \\hat{\\beta} = \\frac{1}{N}\\sum_{t=1}^{N} e_t$ 表示样本内平均误差。通过对留一法均值进行代数操作，注意到所有误差的总和是 $N m$，我们得到\n$$\n\\hat{\\beta}_{-t} = \\frac{N m - e_t}{N-1}.\n$$\n因此，\n$$\ne_t - \\hat{\\beta}_{-t} \n= e_t - \\frac{N m - e_t}{N-1} \n= \\frac{N(e_t - m)}{N-1}.\n$$\n对 $t$ 进行平方和平均，得到以下精确恒等式\n$$\n\\mathrm{MSE}_{\\text{cv}} \n= \\frac{1}{N}\\sum_{t=1}^{N} \\left( \\frac{N(e_t - m)}{N-1} \\right)^2\n= \\left( \\frac{N}{N-1} \\right)^2 \\cdot \\frac{1}{N} \\sum_{t=1}^{N} (e_t - m)^2\n= \\left( \\frac{N}{N-1} \\right)^2 \\mathrm{MSE}_{\\text{in}}.\n$$\n这表明，对于恒定偏差校正，当 $N > 1$ 时，交叉验证的 MSE 比样本内的 MSE 大一个乘法因子 $\\left( \\frac{N}{N-1} \\right)^2 > 1$。技巧膨胀，定义为差值\n$$\n\\Delta = \\mathrm{MSE}_{\\text{cv}} - \\mathrm{MSE}_{\\text{in}},\n$$\n是\n$$\n\\Delta = \\mathrm{MSE}_{\\text{in}} \\left[ \\left( \\frac{N}{N-1} \\right)^2 - 1 \\right].\n$$\n当 $N > 1$ 时，这个值是严格为正的，这表明样本内偏差校正是乐观偏倚的，这是由于信息重复使用而导致的技巧膨胀的典型表现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_inflation(y, f):\n    \"\"\"\n    Compute skill inflation (MSE_cv - MSE_in) in K^2 using\n    in-sample constant bias correction and leave-one-out cross-validated bias correction.\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    f = np.asarray(f, dtype=float)\n    assert y.shape == f.shape, \"Observation and forecast arrays must have the same shape.\"\n    n = y.size\n    # Errors\n    e = f - y\n    # In-sample bias estimate and corrected forecasts\n    beta_in = np.mean(e)\n    f_corr_in = f - beta_in\n    mse_in = np.mean((f_corr_in - y) ** 2)\n    # Leave-one-out bias correction per element\n    f_corr_cv = np.empty_like(f_corr_in)\n    # Precompute sum of errors for efficiency\n    sum_e = np.sum(e)\n    if n > 1:\n        for t in range(n):\n            # Leave-one-out mean of errors\n            beta_loo_t = (sum_e - e[t]) / (n - 1)\n            f_corr_cv[t] = f[t] - beta_loo_t\n    else: # Handle n=1 case, although not in test suite\n        f_corr_cv = f_corr_in\n        \n    mse_cv = np.mean((f_corr_cv - y) ** 2)\n    # Skill inflation: positive means in-sample appears better\n    inflation = mse_cv - mse_in\n    return float(inflation)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case 1: Happy path, moderate sample size N=10 with approximately constant positive bias\n    y1 = [0.10, 0.20, 0.00, -0.10, 0.30, 0.40, 0.20, 0.00, -0.20, 0.10]\n    f1 = [0.42, 0.49, 0.31, 0.20, 0.58, 0.73, 0.49, 0.32, 0.07, 0.40]\n\n    # Case 2: Boundary case, very small sample N=3\n    y2 = [0.00, 0.40, -0.20]\n    f2 = [0.70, 0.80, 0.20]\n\n    # Case 3: Edge case, perfect forecasts N=8\n    y3 = [0.05, -0.05, 0.10, -0.10, 0.00, 0.02, -0.03, 0.04]\n    f3 = [0.05, -0.05, 0.10, -0.10, 0.00, 0.02, -0.03, 0.04]\n\n    # Case 4: Trend mismatch with time-varying bias N=10\n    y4 = [0.00, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45, 0.50]\n    f4 = [0.20, 0.33, 0.46, 0.55, 0.64, 0.77, 0.83, 0.96, 1.04, 1.15]\n\n    test_cases = [\n        (y1, f1),\n        (y2, f2),\n        (y3, f3),\n        (y4, f4),\n    ]\n\n    results = []\n    for y, f in test_cases:\n        result = compute_inflation(y, f)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```\n[0.0000771851851851852,0.02500000000000002,0.0,0.0003311111111111112]"
        }
    ]
}