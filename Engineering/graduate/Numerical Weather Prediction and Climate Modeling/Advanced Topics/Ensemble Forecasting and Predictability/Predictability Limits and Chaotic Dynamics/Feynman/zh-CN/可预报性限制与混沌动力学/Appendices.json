{
    "hands_on_practices": [
        {
            "introduction": "要掌握混沌动力学的精髓，我们必须首先理解误差是如何产生和增长的。本练习使用在天气科学领域作为基石的 Lorenz '96 模型，深入探讨了线性不稳定性这一基本概念。通过分析系统在简单平衡态附近的行为，你将分析推导出小扰动可以放大的最大速率，从而揭示不可预测性的根源 。",
            "id": "4077566",
            "problem": "考虑一个用于数值天气预报 (NWP) 的理想化混沌多尺度系统，即 Lorenz '96 模型。该模型建立在一个具有 $N \\geq 3$ 个变量的周期性域上。状态向量为 $\\boldsymbol{x} = (x_{1}, x_{2}, \\dots, x_{N})$，其中索引对 $N$ 取模，因此 $x_{i+N} = x_{i}$。该模型的动力学由以下常微分方程组给出\n$$\n\\dot{x}_{i} = (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F, \\quad i = 1, 2, \\dots, N,\n$$\n其中 $F$ 是一个恒定的外力强迫。\n\n从非线性自治系统 $\\dot{\\boldsymbol{x}} = \\boldsymbol{f}(\\boldsymbol{x})$ 的标准切线性框架出发，其中局部误差增长由雅可比矩阵 $J(\\boldsymbol{x}) = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{x}}$ 通过 $\\dot{\\boldsymbol{\\delta x}} = J(\\boldsymbol{x}) \\boldsymbol{\\delta x}$ 控制。请按以下步骤进行：\n\n1. 推导 Lorenz '96 模型在周期性域上的一般雅可比矩阵元素 $J_{i,j}(\\boldsymbol{x}) = \\frac{\\partial \\dot{x}_{i}}{\\partial x_{j}}$。\n2. 证明对所有 $i$ 都存在一个均匀平衡点 $x_{i} = X$，并用 $F$ 表示 $X$。\n3. 将雅可比矩阵特殊化到这个均匀平衡点，并利用周期性通过离散傅里叶模态对线性算子进行对角化。求出雅可比矩阵的特征值 $\\lambda(q)$，作为波数 $q \\in [0, 2\\pi)$ 的函数。\n4. 在连续（大 $N$）极限下，确定扰动的最大瞬时线性增长率，定义为 $\\max_{q \\in [0, 2\\pi)} \\Re[\\lambda(q)]$，并用 $F$ 明确地以闭合形式表示。\n\n你的最终答案必须是单一的闭合形式解析表达式。不需要四舍五入，最终表达式中也不应报告单位。",
            "solution": "问题陈述已经过验证，被认为是科学可靠、问题明确且客观的。它展示了对 Lorenz '96 模型的标准分析，该模型是混沌动力学和数值天气预报研究中的一个典型系统。该问题没有任何科学、逻辑或结构上的缺陷。因此，我们可以进行完整解答。\n\n解答将根据问题陈述中要求的四个部分进行组织。\n\n**第一部分：雅可比矩阵的推导**\n\n系统的动力学由以下常微分方程组给出：\n$$\n\\dot{x}_{i} = f_i(\\boldsymbol{x}) = (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F, \\quad i = 1, 2, \\dots, N\n$$\n雅可比矩阵元素 $J_{i,j}(\\boldsymbol{x})$ 定义为 $J_{i,j} = \\frac{\\partial f_i}{\\partial x_j}$。函数 $f_i$ 显式地依赖于变量 $x_{i-2}$、$x_{i-1}$、$x_i$ 和 $x_{i+1}$。因此，只有当 $j$ 对应于这些索引之一时，偏导数才不为零。所有索引均对 $N$ 取模。\n\n我们计算偏导数：\n-   对于 $j=i$：\n    $$\n    \\frac{\\partial f_i}{\\partial x_i} = \\frac{\\partial}{\\partial x_i} \\left[ (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F \\right] = -1\n    $$\n-   对于 $j=i-1$：\n    $$\n    \\frac{\\partial f_i}{\\partial x_{i-1}} = \\frac{\\partial}{\\partial x_{i-1}} \\left[ (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F \\right] = x_{i+1} - x_{i-2}\n    $$\n-   对于 $j=i+1$：\n    $$\n    \\frac{\\partial f_i}{\\partial x_{i+1}} = \\frac{\\partial}{\\partial x_{i+1}} \\left[ (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F \\right] = x_{i-1}\n    $$\n-   对于 $j=i-2$：\n    $$\n    \\frac{\\partial f_i}{\\partial x_{i-2}} = \\frac{\\partial}{\\partial x_{i-2}} \\left[ (x_{i+1} - x_{i-2}) x_{i-1} - x_{i} + F \\right] = -x_{i-1}\n    $$\n对于所有其他 $j$ 值，导数为零。因此，雅可比矩阵 $J(\\boldsymbol{x})$ 的非零元素为：\n$$\nJ_{i,i} = -1 \\\\\nJ_{i,i-1} = x_{i+1} - x_{i-2} \\\\\nJ_{i,i+1} = x_{i-1} \\\\\nJ_{i,i-2} = -x_{i-1}\n$$\n\n**第二部分：均匀平衡态**\n\n平衡态 $\\boldsymbol{x}_{\\text{eq}}$ 是一个系统状态不随时间变化的点，即 $\\dot{\\boldsymbol{x}} = \\boldsymbol{0}$。对于均匀平衡，我们施加条件 $x_i = X$ 对所有 $i=1, \\dots, N$ 成立，其中 $X$ 是一个常数。\n将此代入任意 $i$ 的控制方程：\n$$\n\\dot{x}_i = (X - X) X - X + F = 0\n$$\n$$\n0 \\cdot X - X + F = 0\n$$\n$$\n-X + F = 0\n$$\n这得出 $X = F$。因此，存在一个均匀平衡态，由 $\\boldsymbol{x}_{\\text{eq}} = (F, F, \\dots, F)$ 给出。\n\n**第三部分：平衡点处的雅可比特征值**\n\n我们现在在均匀平衡态 $\\boldsymbol{x}_{\\text{eq}}$（其中对所有 $k$ 都有 $x_k = F$）处计算一般雅可比矩阵的元素。将得到的特殊化雅可比矩阵记为 $J_{\\text{eq}}$。\n$$\nJ_{\\text{eq},i,i} = -1 \\\\\nJ_{\\text{eq},i,i-1} = F - F = 0 \\\\\nJ_{\\text{eq},i,i+1} = F \\\\\nJ_{\\text{eq},i,i-2} = -F\n$$\n对于平衡点附近的小扰动 $\\boldsymbol{\\delta x}$，切线性模型 $\\dot{\\boldsymbol{\\delta x}} = J_{\\text{eq}} \\boldsymbol{\\delta x}$ 变为：\n$$\n\\dot{\\delta x}_i = -F\\delta x_{i-2} - \\delta x_i + F\\delta x_{i+1}\n$$\n这是一个线性齐次常系数常微分方程组。由于周期性边界条件和耦合结构，$J_{\\text{eq}}$ 矩阵是一个循环矩阵。循环矩阵的特征向量是离散傅里叶模态。我们寻求形如 $\\delta x_j(t) = v_j e^{\\lambda t}$ 的解，这导向特征值问题 $J_{\\text{eq}} \\boldsymbol{v} = \\lambda \\boldsymbol{v}$，或按分量表示为：\n$$\n\\lambda v_i = -F v_{i-2} - v_i + F v_{i+1}\n$$\n我们提出一个特征向量，其分量为 $v_j = e^{\\mathrm{i} q j}$，其中 $q$ 是某个波数。周期性条件 $v_{j+N} = v_j$ 意味着 $e^{\\mathrm{i} q (j+N)} = e^{\\mathrm{i} q j}$，这要求 $e^{\\mathrm{i} q N} = 1$。因此，离散波数为 $q_m = \\frac{2\\pi m}{N}$，其中 $m = 0, 1, \\dots, N-1$。对于大 $N$ 的连续极限，我们将 $q$ 视为区间 $[0, 2\\pi)$ 内的连续变量。\n\n将拟设 $v_j = e^{\\mathrm{i} q j}$ 代入特征值方程：\n$$\n\\lambda e^{\\mathrm{i} q i} = -F e^{\\mathrm{i} q (i-2)} - e^{\\mathrm{i} q i} + F e^{\\mathrm{i} q (i+1)}\n$$\n除以非零公因子 $e^{\\mathrm{i} q i}$：\n$$\n\\lambda(q) = -F e^{-2\\mathrm{i} q} - 1 + F e^{\\mathrm{i} q}\n$$\n该方程给出了作为波数 $q$ 函数的特征值 $\\lambda$。利用欧拉公式 $e^{\\mathrm{i}\\theta} = \\cos(\\theta) + \\mathrm{i}\\sin(\\theta)$，我们可以分离实部和虚部：\n$$\n\\lambda(q) = -1 + F(e^{\\mathrm{i} q} - e^{-2\\mathrm{i} q}) = -1 + F(\\cos(q) + \\mathrm{i}\\sin(q) - (\\cos(2q) - \\mathrm{i}\\sin(2q)))\n$$\n$$\n\\lambda(q) = [-1 + F(\\cos(q) - \\cos(2q))] + \\mathrm{i}[F(\\sin(q) + \\sin(2q))]\n$$\n\n**第四部分：最大瞬时线性增长率**\n\n扰动模态的瞬时线性增长率由其对应特征值的实部 $\\Re[\\lambda(q)]$ 给出。我们希望找到该量在所有可能模态上的最大值，即 $\\max_{q \\in [0, 2\\pi)} \\Re[\\lambda(q)]$。\n设 $g(q) = \\Re[\\lambda(q)] = -1 + F(\\cos(q) - \\cos(2q))$。为了找到 $g(q)$ 的最大值，我们计算它关于 $q$ 的导数并令其为零。\n$$\ng'(q) = \\frac{d}{dq} g(q) = F(-\\sin(q) + 2\\sin(2q))\n$$\n令 $g'(q) = 0$（并假设 $F \\neq 0$），我们有：\n$$\n-\\sin(q) + 2\\sin(2q) = 0\n$$\n使用倍角恒等式 $\\sin(2q) = 2\\sin(q)\\cos(q)$：\n$$\n-\\sin(q) + 4\\sin(q)\\cos(q) = 0\n$$\n$$\n\\sin(q) (4\\cos(q) - 1) = 0\n$$\n该方程在区间 $q \\in [0, 2\\pi)$ 内产生两组临界点：\n1. $\\sin(q) = 0$，得到 $q=0$ 和 $q=\\pi$。\n2. $4\\cos(q) - 1 = 0$，得到 $\\cos(q) = \\frac{1}{4}$。\n\n我们在这些点上计算 $g(q)$ 的值。\n对于情况 1（$q=0$ 和 $q=\\pi$）：\n- 如果 $q=0$，$g(0) = -1 + F(\\cos(0) - \\cos(0)) = -1$。\n- 如果 $q=\\pi$，$g(\\pi) = -1 + F(\\cos(\\pi) - \\cos(2\\pi)) = -1 + F(-1 - 1) = -1 - 2F$。\n\n对于情况 2（$\\cos(q)=\\frac{1}{4}$）：\n我们使用恒等式 $\\cos(2q) = 2\\cos^2(q) - 1$ 来求 $\\cos(2q)$。\n$$\n\\cos(2q) = 2\\left(\\frac{1}{4}\\right)^2 - 1 = 2\\left(\\frac{1}{16}\\right) - 1 = \\frac{1}{8} - 1 = -\\frac{7}{8}\n$$\n现在我们对这些 $q$ 值计算 $g(q)$：\n$$\ng(q) = -1 + F\\left(\\cos(q) - \\cos(2q)\\right) = -1 + F\\left(\\frac{1}{4} - \\left(-\\frac{7}{8}\\right)\\right)\n$$\n$$\ng(q) = -1 + F\\left(\\frac{2}{8} + \\frac{7}{8}\\right) = -1 + \\frac{9}{8}F\n$$\n为了确定这些临界点中哪一个对应于最大值，我们检查二阶导数 $g''(q)=F(-\\cos(q) + 4\\cos(2q))$。\n对于情况 1：\n- 在 $q=0$ 处，$g''(0) = F(-1+4)=3F$。如果 $F0$，这是一个局部最小值。\n- 在 $q=\\pi$ 处，$g''(\\pi) = F(-(-1)+4(1))=5F$。如果 $F0$，这是一个局部最小值。\n对于情况 2：\n- 当 $\\cos(q)=\\frac{1}{4}$ 时，$g''(q) = F(-\\frac{1}{4} + 4(-\\frac{7}{8}))=F(-\\frac{1}{4}-\\frac{7}{2}) = -\\frac{15}{4}F$。如果 $F0$，这是一个局部最大值。\n\n比较临界点处的值 $-1$、$-1-2F$ 和 $\\frac{9}{8}F - 1$，很明显对于任何正强迫 $F$（这是混沌行为所必需的），最大值是 $\\frac{9}{8}F - 1$。\n因此，最大瞬时线性增长率为 $\\frac{9}{8}F - 1$。",
            "answer": "$$\n\\boxed{\\frac{9}{8}F - 1}\n$$"
        },
        {
            "introduction": "线性分析中发现的指数级误差增长不可能无限持续；误差最终会受到系统自然变率的限制。本练习引入了一个逻辑斯谛模型，以捕捉误差演化的整个生命周期，从最初的指数增长到最终的非线性饱和 。这项概念性实践将抽象的增长率与初始不确定性和气候范数等具体参数联系起来，从而完整地描绘了预报随时间退化的过程。",
            "id": "4077561",
            "problem": "在数值天气预报（NWP）和气候模拟中，混沌流中小的初始条件扰动的增长，在切线性机制下，可以很好地由最大李雅普诺夫指数 $\\lambda$ 控制的指数放大来描述。因此，对于足够小的扰动，误差范数 $\\|\\delta x(t)\\|$ 最初表现为 $\\|\\delta x(0)\\|\\exp(\\lambda t)$。有限振幅效应和大气有限的背景变率限制了这种增长，导致在由气候变率设定的特征振幅处出现非线性饱和。考虑一个状态向量 $x(t)$ 和一个误差范数 $\\|\\delta x(t)\\|$，对于所有 $t \\geq 0$，其模型为饱和S形曲线\n$$\n\\|\\delta x(t)\\|=\\frac{A\\,\\exp(\\lambda t)}{1+B\\,\\exp(\\lambda t)},\n$$\n其中 $A0$ 和 $B0$ 是待定参数。设初始误差大小为 $\\|\\delta x(0)\\|=\\delta_{0}$（$\\delta_{0}0$），并设背景变率尺度为 $S0$，$S$ 定义为误差范数的渐近饱和水平，与感兴趣的时空尺度上 $\\|x\\|$ 的气候均方根振幅一致。假设 $\\delta_{0}S$。\n\n根据给定的信息：\n1. 确定参数 $A$ 和 $B$，用 $S$ 和 $\\delta_{0}$ 表示。\n2. 推导出一个表达式，用于计算误差范数达到其饱和值 $S$ 的一个分数 $p \\in (0,1)$ 所需的时间 $t_p$。\n\n将三个结果 $A$、$B$ 和 $t_p$ 表示为封闭形式的解析表达式。",
            "solution": "题目陈述是大气科学和混沌动力学领域一个有效且适定的问题。它要求确定一个逻辑斯谛增长模型的参数，并随后应用该模型。\n\n误差范数 $\\|\\delta x(t)\\|$ 的增长由以下函数建模：\n$$ \\|\\delta x(t)\\|=\\frac{A\\,\\exp(\\lambda t)}{1+B\\,\\exp(\\lambda t)} $$\n其中 $t \\geq 0$，且 $A$、$B$、$\\lambda$ 为正常数。\n\n我们有两个条件来确定参数 $A$ 和 $B$：\n1. $t=0$ 时的初始误差为 $\\|\\delta x(0)\\| = \\delta_{0}$。\n2. 当 $t \\to \\infty$ 时，渐近饱和水平为 $S$，因此 $\\lim_{t\\to\\infty} \\|\\delta x(t)\\| = S$。\n\n首先，我们应用 $t=0$ 时的初始条件：\n$$ \\|\\delta x(0)\\| = \\frac{A\\,\\exp(\\lambda \\cdot 0)}{1+B\\,\\exp(\\lambda \\cdot 0)} = \\frac{A \\cdot 1}{1+B \\cdot 1} = \\frac{A}{1+B} $$\n将其设为等于 $\\delta_{0}$，我们得到第一个方程：\n$$ \\delta_{0} = \\frac{A}{1+B} \\quad (1) $$\n\n接下来，我们通过计算当 $t \\to \\infty$ 时的极限来应用饱和条件。由于 $\\lambda  0$，当 $t \\to \\infty$ 时，$\\exp(\\lambda t) \\to \\infty$。为了计算这个有理表达式的极限，我们将分子和分母同时除以 $\\exp(\\lambda t)$：\n$$ S = \\lim_{t\\to\\infty} \\|\\delta x(t)\\| = \\lim_{t\\to\\infty} \\frac{A\\,\\exp(\\lambda t)}{1+B\\,\\exp(\\lambda t)} = \\lim_{t\\to\\infty} \\frac{A}{\\frac{1}{\\exp(\\lambda t)}+B} $$\n当 $t \\to \\infty$ 时，$\\exp(-\\lambda t) = \\frac{1}{\\exp(\\lambda t)} \\to 0$。因此，极限为：\n$$ S = \\frac{A}{0+B} = \\frac{A}{B} \\quad (2) $$\n\n我们现在得到了一个包含两个未知数 $A$ 和 $B$ 的方程组：\n1. $\\delta_{0}(1+B) = A$\n2. $A = SB$\n\n将方程 $(2)$ 中 $A$ 的表达式代入方程 $(1)$：\n$$ \\delta_{0} = \\frac{SB}{1+B} $$\n现在，我们求解 $B$。题目说明 $\\delta_{0}  S$。\n$$ \\delta_{0}(1+B) = SB $$\n$$ \\delta_{0} + \\delta_{0}B = SB $$\n$$ \\delta_{0} = SB - \\delta_{0}B $$\n$$ \\delta_{0} = B(S - \\delta_{0}) $$\n因为 $S > \\delta_{0}$，所以 $S - \\delta_{0} > 0$，我们可以通过除法求得 $B$：\n$$ B = \\frac{\\delta_{0}}{S - \\delta_{0}} $$\n现在我们可以用方程 $(2)$，$A = SB$，来求 $A$：\n$$ A = S \\left( \\frac{\\delta_{0}}{S - \\delta_{0}} \\right) = \\frac{S\\delta_{0}}{S - \\delta_{0}} $$\n题目说明 $A0$ 和 $B0$。由于 $S0$，$\\delta_{0}0$，且 $S\\delta_{0}$，两个分母都为正，因此 $A$ 和 $B$ 确实是正数。\n\n在确定了 $A$ 和 $B$ 之后，误差范数的模型变为：\n$$ \\|\\delta x(t)\\| = \\frac{\\frac{S\\delta_{0}}{S - \\delta_{0}}\\exp(\\lambda t)}{1+\\frac{\\delta_{0}}{S - \\delta_{0}}\\exp(\\lambda t)} $$\n将分子和分母同乘以 $(S-\\delta_{0})$ 可以简化表达式：\n$$ \\|\\delta x(t)\\| = \\frac{S\\delta_{0}\\exp(\\lambda t)}{(S - \\delta_{0}) + \\delta_{0}\\exp(\\lambda t)} $$\n\n任务的第二部分是求出误差范数达到饱和水平 $S$ 的一个分数 $p \\in (0,1)$ 时的时间 $t_{p}$。我们设 $\\|\\delta x(t_{p})\\| = pS$：\n$$ pS = \\frac{S\\delta_{0}\\exp(\\lambda t_{p})}{(S - \\delta_{0}) + \\delta_{0}\\exp(\\lambda t_{p})} $$\n由于 $S  0$，我们可以将等式两边同除以 $S$：\n$$ p = \\frac{\\delta_{0}\\exp(\\lambda t_{p})}{(S - \\delta_{0}) + \\delta_{0}\\exp(\\lambda t_{p})} $$\n我们现在求解 $t_{p}$。首先，我们分离出 $\\exp(\\lambda t_{p})$ 项：\n$$ p((S - \\delta_{0}) + \\delta_{0}\\exp(\\lambda t_{p})) = \\delta_{0}\\exp(\\lambda t_{p}) $$\n$$ p(S - \\delta_{0}) + p\\delta_{0}\\exp(\\lambda t_{p}) = \\delta_{0}\\exp(\\lambda t_{p}) $$\n$$ p(S - \\delta_{0}) = \\delta_{0}\\exp(\\lambda t_{p}) - p\\delta_{0}\\exp(\\lambda t_{p}) $$\n$$ p(S - \\delta_{0}) = (1-p)\\delta_{0}\\exp(\\lambda t_{p}) $$\n现在，我们可以解出 $\\exp(\\lambda t_{p})$：\n$$ \\exp(\\lambda t_{p}) = \\frac{p(S - \\delta_{0})}{(1-p)\\delta_{0}} $$\n为了求 $t_{p}$，我们取等式两边的自然对数。由于 $p \\in (0,1)$，$S\\delta_{0}$ 且 $\\delta_{0}0$，对数的参数为正。\n$$ \\lambda t_{p} = \\ln\\left(\\frac{p(S - \\delta_{0})}{(1-p)\\delta_{0}}\\right) $$\n最后，除以 $\\lambda$（因为 $\\lambda0$）得到 $t_{p}$ 的表达式：\n$$ t_{p} = \\frac{1}{\\lambda}\\ln\\left(\\frac{p(S - \\delta_{0})}{\\delta_{0}(1-p)}\\right) $$\n题目要求将 $t_{p}$ 以天为单位表示。这是一个关于单位的说明。如果最大李雅普诺夫指数 $\\lambda$ 的单位是 天$^{-1}$，那么上述 $t_{p}$ 的公式将得出以天为单位的结果。\n\n推导出的 $A$、$B$ 和 $t_{p}$ 的表达式为：\n- $A=\\frac{S\\delta_{0}}{S - \\delta_{0}}$\n- $B=\\frac{\\delta_{0}}{S - \\delta_{0}}$\n- $t_{p}=\\frac{1}{\\lambda}\\ln\\left(\\frac{p(S - \\delta_{0})}{\\delta_{0}(1-p)}\\right)$",
            "answer": "$$\n\\boxed{A = \\frac{S\\delta_{0}}{S - \\delta_{0}}, \\quad B = \\frac{\\delta_{0}}{S - \\delta_{0}}, \\quad t_{p} = \\frac{1}{\\lambda}\\ln\\left(\\frac{p(S - \\delta_{0})}{\\delta_{0}(1-p)}\\right)}\n$$"
        },
        {
            "introduction": "本练习连接了理论与实践，从分析模型转向在经典混沌系统中直接进行误差增长的数值计算。你将为一个经典的混沌研究模型——Lorenz '63 模型，实现一个计算有限时间李雅普诺夫指数（FTLE）的数值方案。这项动手编程任务提供了求解控制可预报性的变分方程的实践经验，使你能够测量沿混沌轨迹的误差放大的状态依赖性 。",
            "id": "4077615",
            "problem": "考虑一个由常微分方程（ODE）$\\,\\dot{\\boldsymbol{x}} = \\boldsymbol{f}(\\boldsymbol{x})\\,$定义的连续时间动力系统，其中$\\boldsymbol{x}(t) \\in \\mathbb{R}^3$。沿轨迹$\\boldsymbol{x}(t)$在有限时间$T0$内的有限时间李雅普诺夫指数（FTLE）是针对一个扰动$\\delta \\boldsymbol{x}(t)$定义的，该扰动根据变分（切线线性）方程演化，定义如下\n$$\n\\lambda_T = \\frac{1}{T}\\,\\ln\\left(\\frac{\\|\\delta \\boldsymbol{x}(T)\\|}{\\|\\delta \\boldsymbol{x}(0)\\|}\\right).\n$$\n扰动$\\delta \\boldsymbol{x}(t)$满足线性化动力学\n$$\n\\frac{d}{dt}\\,\\delta \\boldsymbol{x}(t) = \\mathbf{J}(\\boldsymbol{x}(t))\\,\\delta \\boldsymbol{x}(t),\n$$\n其中$\\mathbf{J}(\\boldsymbol{x}) = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{x}}$是$\\boldsymbol{f}$的雅可比矩阵，沿参考轨迹$\\boldsymbol{x}(t)$求值。设$\\mathbf{\\Phi}(t)$表示满足$\\dot{\\mathbf{\\Phi}}(t)=\\mathbf{J}(\\boldsymbol{x}(t))\\,\\mathbf{\\Phi}(t)$和$\\mathbf{\\Phi}(0)=\\mathbf{I}$的变分方程的基本矩阵解。则有$\\delta \\boldsymbol{x}(T) = \\mathbf{\\Phi}(T)\\,\\delta \\boldsymbol{x}(0)$。\n\n在本问题中，基础流是 Lorenz '63 模型：\n- $\\,\\dot{x} = \\sigma(y-x)$，\n- $\\,\\dot{y} = x(\\rho - z) - y$，\n- $\\,\\dot{z} = xy - \\beta z$，\n其标准参数为$\\sigma = 10$，$\\rho = 28$和$\\beta = 8/3$。基础轨迹的初始条件为$\\boldsymbol{x}(0)=(1,1,1)$，除非另有说明，时间范围为$T=5$。Lorenz '63 模型的雅可比矩阵$\\mathbf{J}(\\boldsymbol{x})$是\n$$\n\\mathbf{J}(x,y,z) =\n\\begin{bmatrix}\n-\\sigma  \\sigma  0 \\\\\n\\rho - z  -1  -x \\\\\ny  x  -\\beta\n\\end{bmatrix}.\n$$\n\n您的任务是使用变分方程计算有限时间李雅普诺夫指数$\\lambda_T$。具体方法是数值积分$(\\boldsymbol{x}(t), \\mathbf{\\Phi}(t))$的增广系统，然后应用$\\lambda_T$的定义。范数$\\|\\cdot\\|$将是以下之一：\n- $p=2$的欧几里得范数：$\\|\\boldsymbol{v}\\|_2 = \\sqrt{v_1^2 + v_2^2 + v_3^2}$。\n- $p=1$的曼哈顿范数：$\\|\\boldsymbol{v}\\|_1 = |v_1| + |v_2| + |v_3|$。\n- $p=\\infty$的最大范数：$\\|\\boldsymbol{v}\\|_\\infty = \\max(|v_1|,|v_2|,|v_3|)$。\n\n使用以下测试用例集，每个用例都指定了扰动向量$\\delta \\boldsymbol{x}(0)$、时间范围$T$和范数类型：\n1. 情况A（正常路径）：$\\delta \\boldsymbol{x}(0) = [1\\times 10^{-6},\\,0,\\,0]$, $T = 5$, 范数 $p=2$。\n2. 情况B（尺度不变性检查）：$\\delta \\boldsymbol{x}(0) = [1\\times 10^{-8},\\,0,\\,0]$, $T = 5$, 范数 $p=2$。\n3. 情况C（范数敏感性）：$\\delta \\boldsymbol{x}(0) = [0,\\,1\\times 10^{-6},\\,0]$, $T = 5$, 范数 $p=1$。\n4. 情况D（范数敏感性）：$\\delta \\boldsymbol{x}(0) = [0,\\,0,\\,1\\times 10^{-6}]$, $T = 5$, 范数 $p=\\infty$。\n5. 情况E（短时行为）：$\\delta \\boldsymbol{x}(0) = [1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6}]$, $T = 0.5$, 范数 $p=2$。\n\n要求和约束：\n- 对于所有情况，基础轨迹均从$\\boldsymbol{x}(0)=(1,1,1)$开始。\n- 积分$(\\boldsymbol{x}(t), \\mathbf{\\Phi}(t))$的增广系统，其中$\\mathbf{\\Phi}(0)=\\mathbf{I}$，然后计算$\\delta \\boldsymbol{x}(T)=\\mathbf{\\Phi}(T)\\delta \\boldsymbol{x}(0)$，并使用每种情况指定的范数来评估$\\lambda_T$。\n- 确保所有计算中$T0$。\n- 所有输出都是无量纲的。将最终数值结果表示为浮点数，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含情况A到E的结果，按顺序排列，格式为用方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC,resultD,resultE]”）。\n\n交付内容：\n- 一个完整、可运行的程序，该程序对指定情况下的 Lorenz '63 系统及其变分方程进行数值积分，并返回所要求的 FTLE 值，同时遵循上面指定的最终输出格式。",
            "solution": "该问题要求为 Lorenz '63 系统的几个测试用例计算有限时间李雅普诺夫指数（FTLE）。FTLE，表示为$\\lambda_T$，量化了在有限时间间隔$T0$内，无限接近的轨迹的平均指数发散率。其定义为：\n$$\n\\lambda_T = \\frac{1}{T}\\,\\ln\\left(\\frac{\\|\\delta \\boldsymbol{x}(T)\\|}{\\|\\delta \\boldsymbol{x}(0)\\|}\\right)\n$$\n其中$\\delta \\boldsymbol{x}(t)$是一个无穷小扰动向量，其演化由系统的线性化动力学控制。\n\n该方法的核心是求解一个增广的常微分方程（ODE）系统。该系统将状态向量$\\boldsymbol{x}(t) = [x(t), y(t), z(t)]^T \\in \\mathbb{R}^3$的原始非线性 Lorenz '63 方程与控制基本矩阵解$\\mathbf{\\Phi}(t) \\in \\mathbb{R}^{3 \\times 3}$演化的变分方程相结合。基本矩阵通过$\\delta\\boldsymbol{x}(T) = \\mathbf{\\Phi}(T)\\delta\\boldsymbol{x}(0)$将初始扰动映射到最终扰动。\n\n增广系统的状态是一个12维向量$\\boldsymbol{Y}(t)$，通过连接 Lorenz 状态向量$\\boldsymbol{x}(t)$和向量化的基本矩阵$\\mathbf{\\Phi}(t)$构建：\n$$\n\\boldsymbol{Y}(t) = [\\boldsymbol{x}(t)^T, (\\text{vec}(\\mathbf{\\Phi}(t)))^T]^T \\in \\mathbb{R}^{12}\n$$\n这个增广系统的控制ODE是$\\dot{\\boldsymbol{Y}}(t) = \\boldsymbol{F}(\\boldsymbol{Y}(t))$，它分为两部分：\n1. Lorenz '63 方程：\n$$\n\\dot{\\boldsymbol{x}} = \\boldsymbol{f}(\\boldsymbol{x}) =\n\\begin{pmatrix}\n\\sigma(y-x) \\\\\nx(\\rho - z) - y \\\\\nxy - \\beta z\n\\end{pmatrix}\n$$\n参数为$\\sigma = 10$，$\\rho = 28$和$\\beta = 8/3$。\n2. 基本矩阵的变分方程：\n$$\n\\dot{\\mathbf{\\Phi}}(t) = \\mathbf{J}(\\boldsymbol{x}(t))\\,\\mathbf{\\Phi}(t)\n$$\n其中$\\mathbf{J}(\\boldsymbol{x})$是$\\boldsymbol{f}(\\boldsymbol{x})$的雅可比矩阵，沿轨迹$\\boldsymbol{x}(t)$求值：\n$$\n\\mathbf{J}(x,y,z) =\n\\begin{bmatrix}\n-\\sigma  \\sigma  0 \\\\\n\\rho - z  -1  -x \\\\\ny  x  -\\beta\n\\end{bmatrix}\n$$\n这个增广系统的初始条件是$\\boldsymbol{x}(0) = (1,1,1)$和$\\mathbf{\\Phi}(0) = \\mathbf{I}$，其中$\\mathbf{I}$是$3 \\times 3$的单位矩阵。\n\n每个测试用例的计算过程如下：\n1. 为12维增广系统构建初始状态向量$\\boldsymbol{Y}(0)$。\n2. 使用高精度求解器（如`scipy.integrate.solve_ivp`）将12个ODE组成的系统从$t=0$数值积分到指定的最终时间$T$。\n3. 从最终状态$\\boldsymbol{Y}(T)$中提取$3 \\times 3$的基本矩阵$\\mathbf{\\Phi}(T)$。\n4. 对于给定的初始扰动$\\delta\\boldsymbol{x}(0)$，计算最终扰动$\\delta\\boldsymbol{x}(T) = \\mathbf{\\Phi}(T)\\delta\\boldsymbol{x}(0)$。\n5. 使用为该情况指定的范数（$p=1$、$p=2$或$p=\\infty$），计算初始扰动范数$\\|\\delta\\boldsymbol{x}(0)\\|$和最终扰动范数$\\|\\delta\\boldsymbol{x}(T)\\|$。\n6. 使用其定义计算FTLE $\\lambda_T$。\n\n由线性变分方程导出的FTLE的一个关键特性是，结果与初始扰动的幅度无关，仅与其方向有关。这是因为范数是齐次的，即$\\|c\\boldsymbol{v}\\| = |c|\\|\\boldsymbol{v}\\|$，并且项$|c|$在对数内的比率中被消掉。因此，情况A和情况B预计会产生相同的结果，从而为数值实现提供了验证。其他情况测试了对初始扰动方向和范数选择的敏感性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the finite-time Lyapunov exponent (FTLE) for the Lorenz '63 system\n    for a suite of test cases.\n    \"\"\"\n\n    def lorenz_augmented_rhs(t, state, sigma, rho, beta):\n        \"\"\"\n        Computes the time derivative of the augmented state vector, which includes\n        the Lorenz '63 state and the fundamental matrix.\n        \n        Args:\n            t (float): Current time (unused, as the system is autonomous).\n            state (np.ndarray): 12-element array [x, y, z, phi_11, ..., phi_33].\n            sigma (float): Lorenz parameter sigma.\n            rho (float): Lorenz parameter rho.\n            beta (float): Lorenz parameter beta.\n\n        Returns:\n            np.ndarray: The 12-element time derivative of the state vector.\n        \"\"\"\n        x, y, z = state[:3]\n        phi = state[3:].reshape((3, 3))\n\n        # Lorenz '63 equations\n        dxdt = sigma * (y - x)\n        dydt = x * (rho - z) - y\n        dzdt = x * y - beta * z\n        \n        lorenz_derivs = np.array([dxdt, dydt, dzdt])\n\n        # Jacobian matrix\n        J = np.array([\n            [-sigma, sigma, 0],\n            [rho - z, -1, -x],\n            [y, x, -beta]\n        ])\n\n        # Variational equations for the fundamental matrix\n        dphi_dt = J @ phi\n\n        # Concatenate derivatives into a single state derivative vector\n        d_state_dt = np.concatenate((lorenz_derivs, dphi_dt.flatten()))\n        \n        return d_state_dt\n\n    # Lorenz '63 parameters\n    sigma = 10.0\n    rho = 28.0\n    beta = 8.0 / 3.0\n\n    # Initial condition for the base trajectory\n    x0 = np.array([1.0, 1.0, 1.0])\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case A: happy path\n        {'delta_x0': np.array([1e-6, 0.0, 0.0]), 'T': 5.0, 'norm_p': 2},\n        # Case B: scaling invariance check\n        {'delta_x0': np.array([1e-8, 0.0, 0.0]), 'T': 5.0, 'norm_p': 2},\n        # Case C: norm sensitivity\n        {'delta_x0': np.array([0.0, 1e-6, 0.0]), 'T': 5.0, 'norm_p': 1},\n        # Case D: norm sensitivity\n        {'delta_x0': np.array([0.0, 0.0, 1e-6]), 'T': 5.0, 'norm_p': np.inf},\n        # Case E: short-time behavior\n        {'delta_x0': np.array([1e-6, 1e-6, 1e-6]), 'T': 0.5, 'norm_p': 2},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T = case['T']\n        delta_x0 = case['delta_x0']\n        norm_p = case['norm_p']\n\n        # Initial conditions for the augmented system\n        phi0_flat = np.identity(3).flatten()\n        y0 = np.concatenate((x0, phi0_flat))\n\n        # Integrate the augmented ODE system.\n        # Higher precision is used for better accuracy in chaotic systems.\n        sol = solve_ivp(\n            lorenz_augmented_rhs,\n            [0, T],\n            y0,\n            t_eval=[T],\n            args=(sigma, rho, beta),\n            method='RK45',\n            rtol=1e-9,  # Relative tolerance\n            atol=1e-12 # Absolute tolerance\n        )\n        \n        # Extract the final state and the fundamental matrix\n        y_T = sol.y[:, 0]\n        Phi_T = y_T[3:].reshape((3, 3))\n\n        # Compute the final perturbation vector\n        delta_x_T = Phi_T @ delta_x0\n\n        # Calculate initial and final norms\n        norm_initial = np.linalg.norm(delta_x0, ord=norm_p)\n        norm_final = np.linalg.norm(delta_x_T, ord=norm_p)\n\n        # Calculate FTLE, ensuring T > 0 and norm_initial > 0 to avoid division by zero\n        if T > 0 and norm_initial > 0:\n            ftle = (1.0 / T) * np.log(norm_final / norm_initial)\n        else:\n            # This case should not be reached based on the problem description\n            ftle = 0.0\n\n        results.append(f\"{ftle:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}