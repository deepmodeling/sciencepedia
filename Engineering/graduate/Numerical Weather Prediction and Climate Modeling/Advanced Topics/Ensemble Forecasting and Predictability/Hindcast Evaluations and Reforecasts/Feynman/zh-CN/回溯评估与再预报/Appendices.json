{
    "hands_on_practices": [
        {
            "introduction": "评估一个预报的价值，我们必须将其与一个基准进行比较。本练习将介绍技巧评分（skill score），这是一个核心指标，用于量化数值模型相比于简单参考预报所带来的改进。你将为一个后报计算均方根误差（$RMSE$），并将其与气候学和持续性这两个标准基准进行比较，以观察预报技巧如何随预报时效演变 。",
            "id": "4051836",
            "problem": "考虑对以摄氏度表示的$2$米气温的周回报进行评估。这些回报由一个数值天气预报（NWP）系统生成，并根据周平均观测值进行验证。使用了两个参考基准：一个是从先前的再预报期派生出的气候学参考，另一个是定义为每次预报初始化之前最后一个可用的观测周平均值的持续性参考。目标是比较这两个参考对于周气温回报的性能，并计算在均方根误差（RMSE）下，每个参考在多个预报时效的技巧评分。\n\n基本原理：对于一组预报和相应的观测，单个案例的平方误差定义为预报与观测之差的平方。均方误差（MSE）定义为所有案例的平方误差的算术平均值。均方根误差（RMSE）定义为MSE的平方根。RMSE下的技巧评分是一个无量纲量，它通过将RMSE相对于参考的RMSE进行归一化，来量化相对于指定参考的改进程度。\n\n数据集描述和测试套件：\n- 独立回报案例数：$N = 3$。\n- 预报周数：$L = 4$，预报时效 $\\ell \\in \\{1,2,3,4\\}$。\n- 初始化周（年内周指数）：$[\\,3,\\,20,\\,30\\,]$。对于每个案例 $i \\in \\{1,2,3\\}$，预报时效 $\\ell$ 的验证年内周为 $w_{i,\\ell} = w_{0,i} + \\ell$。\n- 观测矩阵 $Y \\in \\mathbb{R}^{N \\times L}$（周平均值，单位：摄氏度）：\n  - 案例1：$[\\,2.5,\\;3.2,\\;4.1,\\;5.3\\,]$\n  - 案例2：$[\\,15.2,\\;15.8,\\;16.9,\\;18.5\\,]$\n  - 案例3：$[\\,22.3,\\;23.5,\\;24.7,\\;25.2\\,]$\n- 回报模型矩阵 $H \\in \\mathbb{R}^{N \\times L}$（周平均值，单位：摄氏度）：\n  - 案例1：$[\\,2.0,\\;2.8,\\;4.5,\\;5.1\\,]$\n  - 案例2：$[\\,14.5,\\;15.7,\\;17.2,\\;18.9\\,]$\n  - 案例3：$[\\,22.7,\\;23.2,\\;24.2,\\;25.8\\,]$\n- 气候学参考矩阵 $C \\in \\mathbb{R}^{N \\times L}$（周平均值，单位：摄氏度），映射到验证周：\n  - 案例1（验证周 $[\\,4,5,6,7\\,]$）：$[\\,2.0,\\;3.0,\\;4.0,\\;5.0\\,]$\n  - 案例2（验证周 $[\\,21,22,23,24\\,]$）：$[\\,15.0,\\;16.0,\\;17.0,\\;18.0\\,]$\n  - 案例3（验证周 $[\\,31,32,33,34\\,]$）：$[\\,22.0,\\;23.0,\\;24.0,\\;25.0\\,]$\n- 持续性参考向量 $P \\in \\mathbb{R}^{N}$（摄氏度），等于每次初始化前一周的观测周平均温度：\n  - 案例1：$1.8$\n  - 案例2：$14.9$\n  - 案例3：$22.1$\n  对于每个预报时效 $\\ell$，案例 $i$ 的持续性预报值保持为 $P_i$。\n\n任务：\n1. 对于每个预报时效 $\\ell \\in \\{1,2,3,4\\}$，使用 $H_{\\cdot,\\ell}$ 和 $Y_{\\cdot,\\ell}$ 计算 $N$ 个案例的 $RMSE_{model}(\\ell)$，以摄氏度表示。\n2. 对于每个预报时效 $\\ell$，使用 $C_{\\cdot,\\ell}$ 和 $Y_{\\cdot,\\ell}$ 计算 $N$ 个案例的 $RMSE_{clim}(\\ell)$，以摄氏度表示。\n3. 对于每个预报时效 $\\ell$，使用 $P$ 和 $Y_{\\cdot,\\ell}$ 计算 $N$ 个案例的 $RMSE_{pers}(\\ell)$，以摄氏度表示。\n4. 使用RMSE值，计算每个参考和预报时效在RMSE下的技巧评分。将每个技巧评分表示为小数（无百分号），并四舍五入到$5$位小数。\n\n要求的最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，内含两个子列表，按预报时效 $\\ell = 1$ 到 $\\ell = 4$ 排序：\n- 第一个子列表：$[\\,SS_{clim}(1),\\,SS_{clim}(2),\\,SS_{clim}(3),\\,SS_{clim}(4)\\,]$。\n- 第二个子列表：$[\\,SS_{pers}(1),\\,SS_{pers}(2),\\,SS_{pers}(3),\\,SS_{pers}(4)\\,]$。\n例如：$[[s_1,s_2,s_3,s_4],[t_1,t_2,t_3,t_4]]$。\n\n科学真实性和覆盖范围：\n- 数据集包括冬季、晚春和仲夏的周（$[\\,3,\\,20,\\,30\\,]$），以覆盖季节性变化。\n- 该测试套件同时探究了典型案例、持续性预报在较长预报时效下的相对劣势，以及在较短预报时效下相对于气候学参考可能出现的负技巧评分。\n- 所有涉及物理单位的量都必须按规定以摄氏度报告；技巧评分是无量纲的，必须以小数形式报告。",
            "solution": "该问题已经过验证，被认为是可靠、适定且具有科学依据的。它代表了数值天气预报回报验证中的一个标准练习。\n\n目标是计算一组回报相对于两个参考预报（气候学和持续性）的均方根误差（RMSE）技巧评分。解决方案首先定义了必要的统计量，然后为每个预报时效系统地将它们应用于所提供的数据集。\n\n对于一组 $N$ 个预报 $F_i$ 和相应的观测 $Y_i$，均方误差（MSE）由下式给出：\n$$MSE = \\frac{1}{N} \\sum_{i=1}^{N} (F_i - Y_i)^2$$\n均方根误差（RMSE）是MSE的平方根：\n$$RMSE = \\sqrt{MSE}$$\n模型预报相对于参考预报的技巧评分（SS）定义为：\n$$SS = 1 - \\frac{RMSE_{model}}{RMSE_{ref}}$$\n正的技巧评分表示模型比参考更准确，负的技巧评分表示其准确性较低，而评分为$0$则意味着准确性相等。一个完美的预报将有 $RMSE_{model}=0$，从而得到技巧评分为$1$。\n\n给定的数据如下：\n- 案例数 $N = 3$。\n- 观测矩阵 $Y = \\begin{pmatrix} 2.5 & 3.2 & 4.1 & 5.3 \\\\ 15.2 & 15.8 & 16.9 & 18.5 \\\\ 22.3 & 23.5 & 24.7 & 25.2 \\end{pmatrix}$。\n- 回报模型矩阵 $H = \\begin{pmatrix} 2.0 & 2.8 & 4.5 & 5.1 \\\\ 14.5 & 15.7 & 17.2 & 18.9 \\\\ 22.7 & 23.2 & 24.2 & 25.8 \\end{pmatrix}$。\n- 气候学参考矩阵 $C = \\begin{pmatrix} 2.0 & 3.0 & 4.0 & 5.0 \\\\ 15.0 & 16.0 & 17.0 & 18.0 \\\\ 22.0 & 23.0 & 24.0 & 25.0 \\end{pmatrix}$。\n- 持续性参考向量 $P = \\begin{pmatrix} 1.8 \\\\ 14.9 \\\\ 22.1 \\end{pmatrix}$。\n\n计算针对每个预报周 $\\ell \\in \\{1, 2, 3, 4\\}$ 进行。\n\n**预报周 $\\ell=1$**\n此预报时效的数据向量为：\n- 观测值：$Y_{\\cdot,1} = [2.5, 15.2, 22.3]$\n- 模型：$H_{\\cdot,1} = [2.0, 14.5, 22.7]$\n- 气候学：$C_{\\cdot,1} = [2.0, 15.0, 22.0]$\n- 持续性：$P = [1.8, 14.9, 22.1]$\n\n计算每个案例 $i \\in \\{1,2,3\\}$ 的平方误差：\n- $SE_{model}(1) = [ (2.0-2.5)^2, (14.5-15.2)^2, (22.7-22.3)^2 ] = [0.25, 0.49, 0.16]$\n- $SE_{clim}(1) = [ (2.0-2.5)^2, (15.0-15.2)^2, (22.0-22.3)^2 ] = [0.25, 0.04, 0.09]$\n- $SE_{pers}(1) = [ (1.8-2.5)^2, (14.9-15.2)^2, (22.1-22.3)^2 ] = [0.49, 0.09, 0.04]$\n\nMSE和RMSE值为：\n- $MSE_{model}(1) = \\frac{0.25+0.49+0.16}{3} = 0.30 \\implies RMSE_{model}(1) \\approx 0.54772$\n- $MSE_{clim}(1) = \\frac{0.25+0.04+0.09}{3} \\approx 0.12667 \\implies RMSE_{clim}(1) \\approx 0.35590$\n- $MSE_{pers}(1) = \\frac{0.49+0.09+0.04}{3} \\approx 0.20667 \\implies RMSE_{pers}(1) \\approx 0.45461$\n\n预报时效1的技巧评分为：\n- $SS_{clim}(1) = 1 - \\frac{0.54772}{0.35590} \\approx -0.53901$\n- $SS_{pers}(1) = 1 - \\frac{0.54772}{0.45461} \\approx -0.20483$\n\n**预报周 $\\ell=2$**\n- $Y_{\\cdot,2} = [3.2, 15.8, 23.5]$\n- $H_{\\cdot,2} = [2.8, 15.7, 23.2]$\n- $C_{\\cdot,2} = [3.0, 16.0, 23.0]$\n- $P = [1.8, 14.9, 22.1]$\n\nMSE和RMSE值为：\n- $MSE_{model}(2) = \\frac{(2.8-3.2)^2+(15.7-15.8)^2+(23.2-23.5)^2}{3} = \\frac{0.16+0.01+0.09}{3} \\approx 0.08667 \\implies RMSE_{model}(2) \\approx 0.29439$\n- $MSE_{clim}(2) = \\frac{(3.0-3.2)^2+(16.0-15.8)^2+(23.0-23.5)^2}{3} = \\frac{0.04+0.04+0.25}{3} = 0.11 \\implies RMSE_{clim}(2) \\approx 0.33166$\n- $MSE_{pers}(2) = \\frac{(1.8-3.2)^2+(14.9-15.8)^2+(22.1-23.5)^2}{3} = \\frac{1.96+0.81+1.96}{3} \\approx 1.57667 \\implies RMSE_{pers}(2) \\approx 1.25565$\n\n预报时效2的技巧评分为：\n- $SS_{clim}(2) = 1 - \\frac{0.29439}{0.33166} \\approx 0.11234$\n- $SS_{pers}(2) = 1 - \\frac{0.29439}{1.25565} \\approx 0.76555$\n\n**预报周 $\\ell=3$**\n- $Y_{\\cdot,3} = [4.1, 16.9, 24.7]$\n- $H_{\\cdot,3} = [4.5, 17.2, 24.2]$\n- $C_{\\cdot,3} = [4.0, 17.0, 24.0]$\n- $P = [1.8, 14.9, 22.1]$\n\nMSE和RMSE值为：\n- $MSE_{model}(3) = \\frac{(4.5-4.1)^2+(17.2-16.9)^2+(24.2-24.7)^2}{3} = \\frac{0.16+0.09+0.25}{3} \\approx 0.16667 \\implies RMSE_{model}(3) \\approx 0.40825$\n- $MSE_{clim}(3) = \\frac{(4.0-4.1)^2+(17.0-16.9)^2+(24.0-24.7)^2}{3} = \\frac{0.01+0.01+0.49}{3} = 0.17 \\implies RMSE_{clim}(3) \\approx 0.41231$\n- $MSE_{pers}(3) = \\frac{(1.8-4.1)^2+(14.9-16.9)^2+(22.1-24.7)^2}{3} = \\frac{5.29+4.00+6.76}{3} = 5.35 \\implies RMSE_{pers}(3) \\approx 2.31301$\n\n预报时效3的技巧评分为：\n- $SS_{clim}(3) = 1 - \\frac{0.40825}{0.41231} \\approx 0.00985$\n- $SS_{pers}(3) = 1 - \\frac{0.40825}{2.31301} \\approx 0.82350$\n\n**预报周 $\\ell=4$**\n- $Y_{\\cdot,4} = [5.3, 18.5, 25.2]$\n- $H_{\\cdot,4} = [5.1, 18.9, 25.8]$\n- $C_{\\cdot,4} = [5.0, 18.0, 25.0]$\n- $P = [1.8, 14.9, 22.1]$\n\nMSE和RMSE值为：\n- $MSE_{model}(4) = \\frac{(5.1-5.3)^2+(18.9-18.5)^2+(25.8-25.2)^2}{3} = \\frac{0.04+0.16+0.36}{3} \\approx 0.18667 \\implies RMSE_{model}(4) \\approx 0.43205$\n- $MSE_{clim}(4) = \\frac{(5.0-5.3)^2+(18.0-18.5)^2+(25.0-25.2)^2}{3} = \\frac{0.09+0.25+0.04}{3} \\approx 0.12667 \\implies RMSE_{clim}(4) \\approx 0.35590$\n- $MSE_{pers}(4) = \\frac{(1.8-5.3)^2+(14.9-18.5)^2+(22.1-25.2)^2}{3} = \\frac{12.25+12.96+9.61}{3} \\approx 11.60667 \\implies RMSE_{pers}(4) \\approx 3.40686$\n\n预报时效4的技巧评分为：\n- $SS_{clim}(4) = 1 - \\frac{0.43205}{0.35590} \\approx -0.21396$\n- $SS_{pers}(4) = 1 - \\frac{0.43205}{3.40686} \\approx 0.87318$\n\n**结果总结**\n计算出的技巧评分，四舍五入到5位小数，如下所示：\n\n- 相对于气候学的技巧评分：\n  - $SS_{clim}(1) = -0.53901$\n  - $SS_{clim}(2) = 0.11234$\n  - $SS_{clim}(3) = 0.00985$\n  - $SS_{clim}(4) = -0.21396$\n\n- 相对于持续性的技巧评分：\n  - $SS_{pers}(1) = -0.20483$\n  - $SS_{pers}(2) = 0.76555$\n  - $SS_{pers}(3) = 0.82350$\n  - $SS_{pers}(4) = 0.87318$\n\n这些结果展示了预报技巧的典型特征。相对于持续性的技巧评分起初为负，表明对于一周的短预报时效，一个简单的持续性预报对于这个小样本来说比NWP模型更准确。然而，随着预报时效的增加，技巧评分迅速提高，显示了模型在预报天气状态演变方面的价值。相对于气候学的技巧评分变化更大，并保持在较低水平（甚至为负），这表明对于这些特定案例，模型在这些预报时效上相对于长期平均值几乎没有提供改进。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes hindcast skill scores for a numerical weather prediction model\n    against climatology and persistence references.\n    \"\"\"\n    # Number of independent hindcast cases\n    N = 3\n    # Number of lead weeks\n    L = 4\n    \n    # Observation matrix Y (N x L)\n    Y = np.array([\n        [2.5, 3.2, 4.1, 5.3],\n        [15.2, 15.8, 16.9, 18.5],\n        [22.3, 23.5, 24.7, 25.2]\n    ])\n\n    # Hindcast model matrix H (N x L)\n    H = np.array([\n        [2.0, 2.8, 4.5, 5.1],\n        [14.5, 15.7, 17.2, 18.9],\n        [22.7, 23.2, 24.2, 25.8]\n    ])\n\n    # Climatology reference matrix C (N x L)\n    C = np.array([\n        [2.0, 3.0, 4.0, 5.0],\n        [15.0, 16.0, 17.0, 18.0],\n        [22.0, 23.0, 24.0, 25.0]\n    ])\n\n    # Persistence reference vector P (N)\n    P = np.array([1.8, 14.9, 22.1])\n\n    ss_clim_list = []\n    ss_pers_list = []\n\n    # Iterate through each lead time from l=1 to L=4 (indices 0 to 3)\n    for lead_idx in range(L):\n        # Extract the column vectors for the current lead time\n        y_lead = Y[:, lead_idx]\n        h_lead = H[:, lead_idx]\n        c_lead = C[:, lead_idx]\n        # The persistence forecast is constant for all leads\n        p_lead = P\n\n        # Calculate Mean Squared Error (MSE) for model, climatology, and persistence\n        mse_model = np.mean((h_lead - y_lead)**2)\n        mse_clim = np.mean((c_lead - y_lead)**2)\n        mse_pers = np.mean((p_lead - y_lead)**2)\n\n        # Calculate Root Mean Squared Error (RMSE)\n        rmse_model = np.sqrt(mse_model)\n        rmse_clim = np.sqrt(mse_clim)\n        rmse_pers = np.sqrt(mse_pers)\n\n        # Calculate the skill score (SS) under RMSE\n        # SS = 1 - (RMSE_model / RMSE_reference)\n        ss_clim = 1 - (rmse_model / rmse_clim)\n        ss_pers = 1 - (rmse_model / rmse_pers)\n\n        # Append the rounded results to their respective lists\n        ss_clim_list.append(round(ss_clim, 5))\n        ss_pers_list.append(round(ss_pers, 5))\n\n    # Format the final output string as specified\n    output_str = f\"[[{','.join(map(str, ss_clim_list))}],[{','.join(map(str, ss_pers_list))}]]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个好的预报可能意味着不同的事情：是准确预测绝对温度，还是准确捕捉其与常态的偏差。本练习深入探讨了验证绝对值与验证距平值之间的关键区别，同时使用了均方根误差（$RMSE$）和距平相关系数（$ACC$）。通过这些计算，你将看到不同的评分如何凸显预报在不同方面的优缺点，例如平均态误差与动态型式误差 。",
            "id": "4051766",
            "problem": "您将执行一项后报验证任务，旨在使用同一组再预报数据，比较绝对空间和异常空间中的验证。一个再预报时间序列包含一个模型预报序列和一个在固定时期内的验证观测序列。对于每个测试用例，您会得到四个等长的序列：模型预报序列 $F_t$、观测序列 $O_t$、模型气候学序列 $C^{(f)}_t$ 和观测气候学序列 $C^{(o)}_t$，时间跨度为 $t = 1,\\dots,N$。异常序列通过减去相应的气候学值来定义，即预报异常 $F^{\\prime}_t = F_t - C^{(f)}_t$ 和观测异常 $O^{\\prime}_t = O_t - C^{(o)}_t$。您的任务是为每个测试用例计算两种表示（绝对值和异常）下的两个指标，并以固定格式报告它们。\n\n使用以下基本定义：\n- 均方根误差 (RMSE) 定义为\n$$\n\\mathrm{RMSE}(X, Y) = \\sqrt{\\frac{1}{N} \\sum_{t=1}^{N} \\left( X_t - Y_t \\right)^2}.\n$$\n- 异常相关系数 (ACC) 定义为皮尔逊相关系数，此处计算为\n$$\n\\mathrm{ACC}(X, Y) = \\frac{\\sum_{t=1}^{N} \\left( X_t - \\bar{X} \\right)\\left( Y_t - \\bar{Y} \\right)}{\\sqrt{\\sum_{t=1}^{N} \\left( X_t - \\bar{X} \\right)^2} \\sqrt{\\sum_{t=1}^{N} \\left( Y_t - \\bar{Y} \\right)^2}},\n$$\n其中 $\\bar{X} = \\frac{1}{N}\\sum_{t=1}^{N} X_t$ 且 $\\bar{Y} = \\frac{1}{N}\\sum_{t=1}^{N} Y_t$。在 $X$ 或 $Y$ 的标准差为零（分母为零）的退化情况下，定义 $\\mathrm{ACC}(X, Y) = 0$。\n\n对于每个测试用例，计算：\n1. 绝对空间 RMSE: $\\mathrm{RMSE}(F, O)$。\n2. 绝对空间 ACC: $\\mathrm{ACC}(F, O)$。\n3. 异常空间 RMSE: $\\mathrm{RMSE}(F^{\\prime}, O^{\\prime})$。\n4. 异常空间 ACC: $\\mathrm{ACC}(F^{\\prime}, O^{\\prime})$。\n\n在此问题中，所有值都是无单位的。将报告的每个浮点数四舍五入到六位小数。\n\n测试套件：\n- 共享的观测气候学值 $C^{(o)}$ 和观测异常值 $A^{(o)}$：\n  - $C^{(o)} = [0.0, 1.0, 2.0, 1.0, 0.0, -1.0, -2.0, -1.0]$,\n  - $A^{(o)} = [0.5, -0.5, 1.0, -1.0, 0.2, -0.2, 0.0, 0.0]$,\n  - 观测值 $O = C^{(o)} + A^{(o)}$。\n- 测试用例 1（模型气候学中存在季节性偏差和振幅误差；异常预报相当好）：\n  - $C^{(f)} = 0.5 + 1.5 \\times C^{(o)}$,\n  - $A^{(f)} = [0.4, -0.6, 0.9, -0.8, 0.3, -0.1, 0.1, -0.2]$,\n  - 预报值 $F = C^{(f)} + A^{(f)}$。\n- 测试用例 2（仅气候学预报；无预报异常）：\n  - $C^{(f)} = 0.5 + 1.5 \\times C^{(o)}$,\n  - $A^{(f)} = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$,\n  - 预报值 $F = C^{(f)} + A^{(f)}$。\n- 测试用例 3（完美预报；完美的气候学和完美的异常）：\n  - $C^{(f)} = C^{(o)}$,\n  - $A^{(f)} = A^{(o)}$,\n  - 预报值 $F = C^{(f)} + A^{(f)}$。\n- 测试用例 4（完美的气候学但异常符号相反）：\n  - $C^{(f)} = C^{(o)}$,\n  - $A^{(f)} = - A^{(o)}$,\n  - 预报值 $F = C^{(f)} + A^{(f)}$。\n\n您的程序应生成单行输出，其中包含结果，格式为以逗号分隔的列表的列表，每个测试用例一个列表，其中每个内部列表的顺序为 $[\\mathrm{RMSE}(F,O), \\mathrm{ACC}(F,O), \\mathrm{RMSE}(F^{\\prime},O^{\\prime}), \\mathrm{ACC}(F^{\\prime},O^{\\prime})]$。所有浮点数必须四舍五入到六位小数。例如，整体结构应如下所示\n$[[x_{11},x_{12},x_{13},x_{14}],[x_{21},x_{22},x_{23},x_{24}],[x_{31},x_{32},x_{33},x_{34}],[x_{41},x_{42},x_{43},x_{44}]]$\n，不含任何额外文本。",
            "solution": "用户提供了一个定义明确的后报验证问题。任务是为四种不同的预报情景计算两个标准验证指标：均方根误差 (RMSE) 和异常相关系数 (ACC)。比较将在绝对空间（使用完整的预报和观测场）和异常空间（使用与气候学的偏差）中进行。\n\n首先，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **序列**：预报 ($F_t$)、观测 ($O_t$)、模型气候学 ($C^{(f)}_t$)、观测气候学 ($C^{(o)}_t$)，时间范围为 $t=1, \\dots, N$。\n- **异常**：预报异常 $F^{\\prime}_t = F_t - C^{(f)}_t$，观测异常 $O^{\\prime}_t = O_t - C^{(o)}_t$。\n- **指标**：\n    - $\\mathrm{RMSE}(X, Y) = \\sqrt{\\frac{1}{N} \\sum_{t=1}^{N} \\left( X_t - Y_t \\right)^2}$。\n    - $\\mathrm{ACC}(X, Y) = \\frac{\\sum_{t=1}^{N} \\left( X_t - \\bar{X} \\right)\\left( Y_t - \\bar{Y} \\right)}{\\sqrt{\\sum_{t=1}^{N} \\left( X_t - \\bar{X} \\right)^2} \\sqrt{\\sum_{t=1}^{N} \\left( Y_t - \\bar{Y} \\right)^2}}$，如果分母为零，则 $\\mathrm{ACC}(X, Y)=0$。\n- **要求输出**：对于每个测试用例，计算 $[\\mathrm{RMSE}(F,O), \\mathrm{ACC}(F,O), \\mathrm{RMSE}(F^{\\prime},O^{\\prime}), \\mathrm{ACC}(F^{\\prime},O^{\\prime})]$。所有浮点数必须四舍五入到六位小数。\n- **数据**：\n    - 共享观测数据：\n        - $C^{(o)} = [0.0, 1.0, 2.0, 1.0, 0.0, -1.0, -2.0, -1.0]$\n        - $A^{(o)} = [0.5, -0.5, 1.0, -1.0, 0.2, -0.2, 0.0, 0.0]$\n        - 观测值 $O = C^{(o)} + A^{(o)}$\n    - 测试用例 1：$C^{(f)} = 0.5 + 1.5 \\times C^{(o)}$，$A^{(f)} = [0.4, -0.6, 0.9, -0.8, 0.3, -0.1, 0.1, -0.2]$，$F = C^{(f)} + A^{(f)}$。\n    - 测试用例 2：$C^{(f)} = 0.5 + 1.5 \\times C^{(o)}$，$A^{(f)} = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$，$F = C^{(f)} + A^{(f)}$。\n    - 测试用例 3：$C^{(f)} = C^{(o)}$，$A^{(f)} = A^{(o)}$，$F = C^{(f)} + A^{(f)}$。\n    - 测试用例 4：$C^{(f)} = C^{(o)}$，$A^{(f)} = -A^{(o)}$，$F = C^{(f)} + A^{(f)}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性**：该问题使用了预报验证领域的标准、正确定义的指标（RMSE、ACC）和概念（气候学、异常）。它在科学上是合理的。\n- **适定性**：该问题是适定的，提供了计算唯一结果集所需的所有数据和定义。明确处理了标准差为零时 ACC 的特殊情况。\n- **客观性**：该问题以精确的数值数据和数学公式客观陈述。\n- **其他标准**：该问题是自包含的、一致的、在计算情境下是现实的，并且并非微不足道。它是一个富有指导意义的预报验证练习。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个解决方案。\n\n### 解题推导\n\n解决方案涉及将所提供的公式系统地应用于给定的数据。我们将首先建立观测的完整时间序列，然后为四个预报测试用例中的每一个计算所需的四个指标。所有时间序列的长度为 $N=8$。\n\n**共享数据序列**\n给定的观测气候学值 $C^{(o)}$ 和观测原始异常值 $A^{(o)}$ 如下：\n$$ C^{(o)} = \\begin{bmatrix} 0.0 & 1.0 & 2.0 & 1.0 & 0.0 & -1.0 & -2.0 & -1.0 \\end{bmatrix} $$\n$$ A^{(o)} = \\begin{bmatrix} 0.5 & -0.5 & 1.0 & -1.0 & 0.2 & -0.2 & 0.0 & 0.0 \\end{bmatrix} $$\n完整的观测时间序列 $O$ 是其气候学和异常分量的和，$O_t = C^{(o)}_t + A^{(o)}_t$：\n$$ O = \\begin{bmatrix} 0.5 & 0.5 & 3.0 & 0.0 & 0.2 & -1.2 & -2.0 & -1.0 \\end{bmatrix} $$\n用于验证的观测异常序列 $O'$ 定义为 $O^{\\prime}_t = O_t - C^{(o)}_t$，可简化为 $O^{\\prime}_t = (C^{(o)}_t + A^{(o)}_t) - C^{(o)}_t = A^{(o)}_t$。因此，$O' = A^{(o)}$。\n\n类似地，对于每个测试用例，预报异常序列 $F'$ 定义为 $F^{\\prime}_t = F_t - C^{(f)}_t$。由于 $F_t = C^{(f)}_t + A^{(f)}_t$，这可简化为 $F^{\\prime}_t = A^{(f)}_t$。\n\n因此，每个用例的核心计算是：\n1.  绝对空间 RMSE：$\\mathrm{RMSE}(F, O)$\n2.  绝对空间 ACC：$\\mathrm{ACC}(F, O)$\n3.  异常空间 RMSE：$\\mathrm{RMSE}(A^{(f)}, A^{(o)})$\n4.  异常空间 ACC：$\\mathrm{ACC}(A^{(f)}, A^{(o)})$\n\n计算过程将使用 Python 的 `numpy` 库来实现，以进行高效的向量运算。ACC 将根据公式计算，并处理方差为零的情况以防止除以零。\n\n**测试用例 1：气候学中的季节性偏差和振幅误差**\n- $C^{(f)} = 0.5 + 1.5 \\times C^{(o)} = \\begin{bmatrix} 0.5 & 2.0 & 3.5 & 2.0 & 0.5 & -1.0 & -2.5 & -1.0 \\end{bmatrix}$\n- $A^{(f)} = \\begin{bmatrix} 0.4 & -0.6 & 0.9 & -0.8 & 0.3 & -0.1 & 0.1 & -0.2 \\end{bmatrix}$\n- $F = C^{(f)} + A^{(f)} = \\begin{bmatrix} 0.9 & 1.4 & 4.4 & 1.2 & 0.8 & -1.1 & -2.4 & -1.2 \\end{bmatrix}$\n- 为 $(F, O)$ 和 $(A^{(f)}, A^{(o)})$ 对计算指标。\n\n**测试用例 2：仅气候学预报**\n- $C^{(f)} = 0.5 + 1.5 \\times C^{(o)}$ (与用例 1 相同)\n- $A^{(f)} = \\begin{bmatrix} 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\end{bmatrix}$\n- $F = C^{(f)} + A^{(f)} = C^{(f)}$\n- $A^{(f)}$ 的标准差为 $0$。因此，根据问题定义，$\\mathrm{ACC}(A^{(f)}, A^{(o)})$ 必须为 $0.0$。\n\n**测试用例 3：完美预报**\n- $C^{(f)} = C^{(o)}$\n- $A^{(f)} = A^{(o)}$\n- $F = C^{(f)} + A^{(f)} = C^{(o)} + A^{(o)} = O$。\n- 由于预报与观测完全相同，误差为零，相关性为一。\n- $\\mathrm{RMSE}(F, O) = 0.0$ 且 $\\mathrm{ACC}(F, O) = 1.0$。\n- 类似地，$A^{(f)} = A^{(o)}$，所以 $\\mathrm{RMSE}(A^{(f)}, A^{(o)}) = 0.0$ 且 $\\mathrm{ACC}(A^{(f)}, A^{(o)}) = 1.0$。\n\n**测试用例 4：完美的气候学，相反的异常**\n- $C^{(f)} = C^{(o)}$\n- $A^{(f)} = -A^{(o)} = \\begin{bmatrix} -0.5 & 0.5 & -1.0 & 1.0 & -0.2 & 0.2 & 0.0 & 0.0 \\end{bmatrix}$\n- $F = C^{(f)} + A^{(f)} = C^{(o)} - A^{(o)}$\n- 异常中的误差是 $A^{(f)} - A^{(o)} = -2A^{(o)}$。\n- $\\mathrm{RMSE}(A^{(f)}, A^{(o)}) = \\sqrt{\\frac{1}{N}\\sum(-2A^{(o)}_t)^2} = 2 \\sqrt{\\frac{1}{N}\\sum(A^{(o)}_t)^2}$。\n- 由于 $A^{(f)}$ 与 $A^{(o)}$ 完全负相关，它们的相关系数 $\\mathrm{ACC}(A^{(f)}, A^{(o)})$ 将为 $-1.0$。\n\n这些步骤将在提供的 Python 代码块中实现。对于每个测试用例，将计算四个指标，四舍五入到六位小数，并收集到一个列表中。最终输出将是这些列表组成的列表，格式化为字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hindcast verification problem by calculating RMSE and ACC\n    in absolute and anomaly space for four test cases.\n    \"\"\"\n\n    def rmse(x, y):\n        \"\"\"Computes the Root Mean Square Error between two sequences.\"\"\"\n        return np.sqrt(np.mean((x - y) ** 2))\n\n    def acc(x, y):\n        \"\"\"\n        Computes the Anomaly Correlation Coefficient (Pearson correlation)\n        between two sequences. Handles the case of zero standard deviation.\n        \"\"\"\n        if x.size != y.size or x.size == 0:\n            return 0.0\n\n        mean_x = np.mean(x)\n        mean_y = np.mean(y)\n\n        var_x_sum = np.sum((x - mean_x) ** 2)\n        var_y_sum = np.sum((y - mean_y) ** 2)\n\n        # Handle degenerate cases where standard deviation is zero\n        if var_x_sum == 0 or var_y_sum == 0:\n            return 0.0\n\n        numerator = np.sum((x - mean_x) * (y - mean_y))\n        denominator = np.sqrt(var_x_sum) * np.sqrt(var_y_sum)\n        \n        return numerator / denominator\n\n    # Shared observed data\n    C_o = np.array([0.0, 1.0, 2.0, 1.0, 0.0, -1.0, -2.0, -1.0])\n    A_o = np.array([0.5, -0.5, 1.0, -1.0, 0.2, -0.2, 0.0, 0.0])\n    O = C_o + A_o\n    O_prime = A_o # Since O_prime = O - C_o\n\n    # Define the test cases\n    test_cases_defs = [\n        {\n            \"C_f_def\": lambda c: 0.5 + 1.5 * c,\n            \"A_f\": np.array([0.4, -0.6, 0.9, -0.8, 0.3, -0.1, 0.1, -0.2])\n        },\n        {\n            \"C_f_def\": lambda c: 0.5 + 1.5 * c,\n            \"A_f\": np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])\n        },\n        {\n            \"C_f_def\": lambda c: c,\n            \"A_f\": A_o\n        },\n        {\n            \"C_f_def\": lambda c: c,\n            \"A_f\": -A_o\n        }\n    ]\n\n    all_results = []\n\n    for case_def in test_cases_defs:\n        # Construct forecast series for the current case\n        C_f = case_def[\"C_f_def\"](C_o)\n        A_f = case_def[\"A_f\"]\n        F = C_f + A_f\n        F_prime = A_f # Since F_prime = F - C_f\n\n        # 1. Absolute-space RMSE\n        rmse_abs = rmse(F, O)\n        \n        # 2. Absolute-space ACC\n        acc_abs = acc(F, O)\n\n        # 3. Anomaly-space RMSE\n        rmse_anom = rmse(F_prime, O_prime)\n\n        # 4. Anomaly-space ACC\n        acc_anom = acc(F_prime, O_prime)\n\n        case_results = [\n            round(rmse_abs, 6),\n            round(acc_abs, 6),\n            round(rmse_anom, 6),\n            round(acc_anom, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    # The default str() for a list in Python adds spaces, which might be undesirable.\n    # To be precise and avoid spaces, we format it manually.\n    inner_strings = [f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results]\n    final_output_str = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个“更好”的预报会导致一个“更差”的检验得分吗？这个练习旨在探讨这个在预报评估中常见的悖论。你将分析推导出一个特定的偏差订正过程如何在提高距平相关系数（$ACC$）的同时，却增大了均方根误差（$RMSE$），从而深刻理解这些基本评分指标的独特属性 。",
            "id": "4051808",
            "problem": "一个季节性后报实验评估了亚热带附近的一个网格点，在该网格点，时刻 $t$ 的观测近地表温度被建模为 $y(t) = \\mu_{o} + z(t)$，其中 $z(t)$ 是观测异常，满足 $\\mathbb{E}[z(t)] = 0$ 和 $\\operatorname{Var}(z(t)) = 1$。一个数值天气预报模型产生了一个后报 $x(t)$，该后报带有一个系统性的季节平均偏差 $b(t)$（在评估期内均值为零，但方差不为零）、一个相对于 $z(t)$ 具有正确相位和振幅系数 $c$ 的信号，以及一个不可预测的误差 $\\epsilon(t)$，因此\n$$\nx(t) = \\mu_{o} + b(t) + c\\,z(t) + \\epsilon(t),\n$$\n其中 $b(t)$、$z(t)$ 和 $\\epsilon(t)$ 是相互不相关的过程，$\\mathbb{E}[b(t)] = 0$，$\\operatorname{Var}(b(t)) = \\sigma_{b}^{2}$，且 $\\mathbb{E}[\\epsilon(t)] = 0$，$\\operatorname{Var}(\\epsilon(t)) = \\sigma_{\\epsilon}^{2}$。考虑以下基于后报的偏差校正，该校正移除了季节性偏差，并对相对于观测气候态的预报异常应用了一个乘性方差因子 $\\alpha$：\n$$\nx_{\\mathrm{corr}}(t) = \\mu_{o} + \\alpha\\big(x(t) - \\mu_{o} - b(t)\\big) = \\mu_{o} + \\alpha\\big(c\\,z(t) + \\epsilon(t)\\big).\n$$\n假设模型的信号振幅是无阻尼的，$c = 1$，不可预测误差的方差为 $\\sigma_{\\epsilon}^{2} = 0.01$，季节性偏差的方差为 $\\sigma_{b}^{2} = 0.40$，并且从一个短训练集估计出的乘性因子为 $\\alpha = 1.8$（这会夸大校正后预报异常的方差）。\n\n仅使用第一性原理和核心定义，完成以下任务：\n\n- 推导校正前绝对水平上的均方根误差 (RMSE) 表达式 $\\,\\mathrm{RMSE}_{\\mathrm{pre}} = \\sqrt{\\mathbb{E}\\big[(x(t) - y(t))^{2}\\big]}\\,$，以及校正后绝对水平上的 RMSE 表达式 $\\,\\mathrm{RMSE}_{\\mathrm{post}} = \\sqrt{\\mathbb{E}\\big[(x_{\\mathrm{corr}}(t) - y(t))^{2}\\big]}\\,$。以开尔文为单位计算它们的数值并进行比较。\n- 将季节性后报验证中使用的异常相关系数 (ACC) 定义为相对于观测气候态的预报异常与观测异常之间的皮尔逊相关性，即 $\\mathrm{ACC} = \\mathrm{Corr}\\big(x(t) - \\mu_{o},\\, y(t) - \\mu_{o}\\big) = \\mathrm{Corr}\\big(x(t) - \\mu_{o},\\, z(t)\\big)$。推导校正前和校正后的 ACC 表达式并计算它们的数值。\n- 基于这些评分的属性，解释在此设置下，偏差校正为何可能在增加绝对 RMSE 的同时提高异常 ACC。\n\n最后，报告校正后 ACC 的数值。答案四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "题目陈述经评估为有效。它在科学上基于统计预报验证的原理，问题提出得当，提供了所有必要信息，并且表述客观。所有术语定义清晰，前提条件内部一致，且与数值天气预报和气候模拟领域相关。\n\n我们接下来推导所要求的验证评分。\n\n观测温度为 $y(t) = \\mu_{o} + z(t)$，其中 $\\mathbb{E}[z(t)] = 0$ 且 $\\operatorname{Var}(z(t)) = \\mathbb{E}[z(t)^2] = 1$。\n原始预报为 $x(t) = \\mu_{o} + b(t) + c\\,z(t) + \\epsilon(t)$，其中 $b(t)$、$z(t)$ 和 $\\epsilon(t)$ 是相互不相关的过程，且 $\\mathbb{E}[b(t)] = 0$，$\\operatorname{Var}(b(t)) = \\sigma_{b}^{2}$，$\\mathbb{E}[\\epsilon(t)] = 0$，$\\operatorname{Var}(\\epsilon(t)) = \\sigma_{\\epsilon}^{2}$。\n校正后预报为 $x_{\\mathrm{corr}}(t) = \\mu_{o} + \\alpha\\big(c\\,z(t) + \\epsilon(t)\\big)$。\n给定的数值为 $c = 1$，$\\sigma_{\\epsilon}^{2} = 0.01$，$\\sigma_{b}^{2} = 0.40$ 和 $\\alpha = 1.8$。\n\n首先，我们推导校正前后的均方根误差 (RMSE) 表达式。\n\n校正前误差是预报与观测之差：\n$$\nx(t) - y(t) = \\big(\\mu_{o} + b(t) + c\\,z(t) + \\epsilon(t)\\big) - \\big(\\mu_{o} + z(t)\\big) = b(t) + (c-1)z(t) + \\epsilon(t)\n$$\n平均误差为 $\\mathbb{E}[x(t) - y(t)] = \\mathbb{E}[b(t)] + (c-1)\\mathbb{E}[z(t)] + \\mathbb{E}[\\epsilon(t)] = 0 + 0 + 0 = 0$。\n校正前均方误差 ($\\mathrm{MSE}_{\\mathrm{pre}}$) 是该误差的方差：\n$$\n\\mathrm{MSE}_{\\mathrm{pre}} = \\mathbb{E}\\big[(x(t) - y(t))^{2}\\big] = \\mathbb{E}\\big[\\big(b(t) + (c-1)z(t) + \\epsilon(t)\\big)^{2}\\big]\n$$\n由于 $b(t)$、$z(t)$ 和 $\\epsilon(t)$ 相互不相关且均值为零，它们的交叉乘积项的期望为零。因此，和的方差等于方差的和：\n$$\n\\mathrm{MSE}_{\\mathrm{pre}} = \\operatorname{Var}(b(t)) + \\operatorname{Var}((c-1)z(t)) + \\operatorname{Var}(\\epsilon(t)) = \\sigma_{b}^{2} + (c-1)^2\\operatorname{Var}(z(t)) + \\sigma_{\\epsilon}^{2}\n$$\n代入 $\\operatorname{Var}(z(t)) = 1$：\n$$\n\\mathrm{MSE}_{\\mathrm{pre}} = \\sigma_{b}^{2} + (c-1)^2 + \\sigma_{\\epsilon}^{2}\n$$\n校正前 RMSE 为 $\\mathrm{RMSE}_{\\mathrm{pre}} = \\sqrt{\\sigma_{b}^{2} + (c-1)^2 + \\sigma_{\\epsilon}^{2}}$。\n使用给定值：\n$$\n\\mathrm{RMSE}_{\\mathrm{pre}} = \\sqrt{0.40 + (1-1)^2 + 0.01} = \\sqrt{0.41} \\approx 0.6403 \\, \\mathrm{K}\n$$\n\n校正后误差为：\n$$\nx_{\\mathrm{corr}}(t) - y(t) = \\big(\\mu_{o} + \\alpha(c\\,z(t) + \\epsilon(t))\\big) - \\big(\\mu_{o} + z(t)\\big) = (\\alpha c - 1)z(t) + \\alpha\\epsilon(t)\n$$\n平均误差为 $\\mathbb{E}[x_{\\mathrm{corr}}(t) - y(t)] = (\\alpha c - 1)\\mathbb{E}[z(t)] + \\alpha\\mathbb{E}[\\epsilon(t)] = 0$。\n校正后均方误差 ($\\mathrm{MSE}_{\\mathrm{post}}$) 是该误差的方差。由于 $z(t)$ 和 $\\epsilon(t)$ 不相关：\n$$\n\\mathrm{MSE}_{\\mathrm{post}} = \\mathbb{E}\\big[((\\alpha c - 1)z(t) + \\alpha\\epsilon(t))^{2}\\big] = (\\alpha c - 1)^2\\operatorname{Var}(z(t)) + \\alpha^2\\operatorname{Var}(\\epsilon(t))\n$$\n$$\n\\mathrm{MSE}_{\\mathrm{post}} = (\\alpha c - 1)^2 + \\alpha^2\\sigma_{\\epsilon}^{2}\n$$\n校正后 RMSE 为 $\\mathrm{RMSE}_{\\mathrm{post}} = \\sqrt{(\\alpha c - 1)^2 + \\alpha^2\\sigma_{\\epsilon}^{2}}$。\n使用给定值：\n$$\n\\mathrm{RMSE}_{\\mathrm{post}} = \\sqrt{(1.8 \\cdot 1 - 1)^2 + (1.8)^2(0.01)} = \\sqrt{(0.8)^2 + 3.24(0.01)} = \\sqrt{0.64 + 0.0324} = \\sqrt{0.6724} \\approx 0.8200 \\, \\mathrm{K}\n$$\n比较两者，我们发现 $\\mathrm{RMSE}_{\\mathrm{post}} > \\mathrm{RMSE}_{\\mathrm{pre}}$。偏差校正过程增加了绝对 RMSE。\n\n接下来，我们推导异常相关系数 (ACC) 的表达式。ACC 是预报异常与观测异常之间的皮尔逊相关性。\n观测异常为 $y(t) - \\mu_{o} = z(t)$。我们知道 $\\operatorname{Var}(z(t)) = 1$。相关性定义为 $\\mathrm{Corr}(X, Y) = \\frac{\\mathrm{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n对于校正前 ACC，预报异常为 $x(t) - \\mu_{o} = b(t) + c\\,z(t) + \\epsilon(t)$。\n协方差项为：\n$$\n\\mathrm{Cov}\\big(x(t) - \\mu_{o}, z(t)\\big) = \\mathbb{E}\\big[(b(t) + c\\,z(t) + \\epsilon(t))z(t)\\big] = \\mathbb{E}[b(t)z(t)] + c\\mathbb{E}[z(t)^2] + \\mathbb{E}[\\epsilon(t)z(t)]\n$$\n由于不相关性和零均值，这简化为 $c\\mathbb{E}[z(t)^2] = c\\operatorname{Var}(z(t)) = c$。\n校正前预报异常的方差为：\n$$\n\\operatorname{Var}\\big(x(t) - \\mu_{o}\\big) = \\operatorname{Var}\\big(b(t) + c\\,z(t) + \\epsilon(t)\\big) = \\sigma_{b}^{2} + c^2\\operatorname{Var}(z(t)) + \\sigma_{\\epsilon}^{2} = \\sigma_{b}^{2} + c^2 + \\sigma_{\\epsilon}^{2}\n$$\n因此，校正前 ACC 为：\n$$\n\\mathrm{ACC}_{\\mathrm{pre}} = \\frac{c}{\\sqrt{(\\sigma_{b}^{2} + c^2 + \\sigma_{\\epsilon}^{2})\\operatorname{Var}(z(t))}} = \\frac{c}{\\sqrt{\\sigma_{b}^{2} + c^2 + \\sigma_{\\epsilon}^{2}}}\n$$\n使用给定值：\n$$\n\\mathrm{ACC}_{\\mathrm{pre}} = \\frac{1}{\\sqrt{0.40 + 1^2 + 0.01}} = \\frac{1}{\\sqrt{1.41}} \\approx 0.8422\n$$\n\n对于校正后 ACC，预报异常为 $x_{\\mathrm{corr}}(t) - \\mu_{o} = \\alpha(c\\,z(t) + \\epsilon(t))$。\n协方差项为：\n$$\n\\mathrm{Cov}\\big(x_{\\mathrm{corr}}(t) - \\mu_{o}, z(t)\\big) = \\mathbb{E}\\big[\\alpha(c\\,z(t) + \\epsilon(t))z(t)\\big] = \\alpha c\\mathbb{E}[z(t)^2] + \\alpha\\mathbb{E}[\\epsilon(t)z(t)] = \\alpha c\n$$\n校正后预报异常的方差为：\n$$\n\\operatorname{Var}\\big(x_{\\mathrm{corr}}(t) - \\mu_{o}\\big) = \\operatorname{Var}\\big(\\alpha(c\\,z(t) + \\epsilon(t))\\big) = \\alpha^2\\operatorname{Var}(c\\,z(t) + \\epsilon(t)) = \\alpha^2(c^2 + \\sigma_{\\epsilon}^{2})\n$$\n因此，校正后 ACC 为：\n$$\n\\mathrm{ACC}_{\\mathrm{post}} = \\frac{\\alpha c}{\\sqrt{\\alpha^2(c^2 + \\sigma_{\\epsilon}^{2})\\operatorname{Var}(z(t))}} = \\frac{\\alpha c}{\\sqrt{\\alpha^2(c^2 + \\sigma_{\\epsilon}^{2})}} = \\frac{\\alpha c}{|\\alpha|\\sqrt{c^2 + \\sigma_{\\epsilon}^{2}}}\n$$\n由于 $\\alpha = 1.8 > 0$，这简化为：\n$$\n\\mathrm{ACC}_{\\mathrm{post}} = \\frac{c}{\\sqrt{c^2 + \\sigma_{\\epsilon}^{2}}}\n$$\n使用给定值：\n$$\n\\mathrm{ACC}_{\\mathrm{post}} = \\frac{1}{\\sqrt{1^2 + 0.01}} = \\frac{1}{\\sqrt{1.01}} \\approx 0.9950\n$$\n比较两者，$\\mathrm{ACC}_{\\mathrm{post}} > \\mathrm{ACC}_{\\mathrm{pre}}$。ACC 得到了改善。\n\n最后，我们解释这个矛盾的结果。\nACC 衡量预报异常与观测异常之间的线性相关性。校正前的预报异常 $x(t)-\\mu_{o} = b(t) + c\\,z(t) + \\epsilon(t)$ 包含系统性偏差项 $b(t)$，它与真实信号 $z(t)$ 不相关。该项充当噪声，降低了相关性。校正过程 $x_{\\mathrm{corr}}(t) = \\mu_{o} + \\alpha(x(t) - \\mu_{o} - b(t))$ 明确地移除了 $b(t)$。从 $\\mathrm{ACC}_{\\mathrm{post}}$ 的推导中可以看出，分母中的 $\\sigma_b^2$ 项被消除，从而导致更高的相关性。ACC 对线性缩放因子 $\\alpha$（当 $\\alpha>0$ 时）不敏感，该因子在分子和分母中被抵消了。\n\n另一方面，RMSE 衡量总误差 $e(t) = \\text{forecast}(t) - y(t)$ 的大小。其平方，即 MSE，是误差分量平方的和。\n$$\n\\mathrm{MSE}_{\\mathrm{pre}} = \\sigma_{b}^{2} + (c-1)^2 + \\sigma_{\\epsilon}^{2} = 0.40 + 0 + 0.01 = 0.41\n$$\n$$\n\\mathrm{MSE}_{\\mathrm{post}} = (\\alpha c - 1)^2 + \\alpha^2\\sigma_{\\epsilon}^{2} = (1.8 - 1)^2 + (1.8)^2(0.01) = 0.64 + 0.0324 = 0.6724\n$$\n校正移除了系统性偏差带来的误差贡献（$\\sigma_{b}^{2} = 0.40$）。然而，它应用了一个乘性因子 $\\alpha = 1.8$。题目指出这是从一个短训练集中估计出来的，这意味着它可能是一个不佳的、过拟合的估计。使 $\\mathrm{MSE}_{\\mathrm{post}}$ 最小化的 $\\alpha$ 的最优值为 $\\alpha_{\\mathrm{opt}} = \\frac{c}{c^2+\\sigma_\\epsilon^2} = \\frac{1}{1+0.01} \\approx 0.99$。所应用的 $\\alpha=1.8$ 远非最优值，并严重夸大了预报异常。这引入了一个大的条件偏差或信号振幅误差，由项 $(\\alpha c - 1)^2 = (1.8 - 1)^2 = 0.64$ 表示。这个新的误差分量远大于原始的总 MSE（$0.41$），导致尽管移除了系统性偏差 $b(t)$，校正后的 RMSE 仍然增加。总而言之，校正改善了异常的相位（更高的 ACC），但降低了它们的振幅（更高的 RMSE）。\n\n校正后 ACC 的数值，四舍五入到四位有效数字，是 $\\frac{1}{\\sqrt{1.01}} \\approx 0.9950$。",
            "answer": "$$\\boxed{0.9950}$$"
        }
    ]
}