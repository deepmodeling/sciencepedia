{
    "hands_on_practices": [
        {
            "introduction": "地表能量平衡是陆地-大气相互作用的基石，也是评估任何陆面模型物理过程的出发点。一个物理上一致的陆面方案必须在日循环尺度上近似守恒能量。本练习将通过一个理想化的场景，教你如何利用观测数据来量化模型参数化方案导致的日总能量不平衡，这是识别和诊断模式系统性偏差的一项关键技能。",
            "id": "4079638",
            "problem": "在数值天气预报（NWP）中，对陆面模型物理过程的面向过程评估需要诊断整个日循环中的通量分配和能量守恒。考虑一个均匀的陆地站点，其上设有一座涡度相关塔，提供观测的全波段净辐射 $R_n(t)$、湍流感热通量 $H(t)$ 和湍流潜热通量 $LE(t)$，单位均为 $\\mathrm{W\\,m^{-2}}$。潜热通量 $LE(t)$ 是汽化潜热与蒸发率的乘积，但在此仅作为一种测量通量来处理。假设地表能量平衡由陆地表面的能量守恒决定，忽略除塔脚下土壤/地面热通量 $G(t)$ 之外的存储项。设时间 $t$ 以当地午夜为起点，单位为秒，一个日循环周期为 $T = 86400$。\n\n为模拟晴空暖季的一天，观测到的通量由以下带有弧度相位的日周期函数表示：\n$$\nR_n(t) = R_0 + A_R \\cos(\\omega t) - B_R \\cos(2\\omega t), \\quad \\omega = \\frac{2\\pi}{T},\n$$\n$$\nH(t) = H_0 + A_H \\cos(\\omega t - \\phi_H),\n$$\n$$\nLE(t) = LE_0 + A_{LE} \\cos(\\omega t - \\phi_{LE}),\n$$\n其中常数为 $R_0 = 80$，$A_R = 220$，$B_R = 30$，$H_0 = 35$，$A_H = 160$，$\\phi_H = \\frac{\\pi}{6}$，$LE_0 = 40$，$A_{LE} = 120$ 以及 $\\phi_{LE} = \\frac{\\pi}{4}$。\n\n嵌入在NWP系统中的陆面模型（LSM）使用一个简单的参数化方案来预测土壤热通量，该方案旨在捕捉辐射强迫分配和热惯性的组合效应：\n$$\n\\hat{G}(t) = \\alpha\\,R_n(t) - \\tau\\,\\frac{d R_n}{dt},\n$$\n其中 $\\alpha = 0.12$ 且 $\\tau = 1200$。\n\n任务：\n1. 从陆地表面能量守恒出发，导出观测数据所隐含的残余地面热通量 $G_{\\mathrm{res}}(t)$。\n2. 将给定日强迫下模型的日积分能量不平衡定义为\n$$\nI \\equiv \\int_{0}^{T} \\big(R_n(t) - H(t) - LE(t) - \\hat{G}(t)\\big)\\,dt,\n$$\n并根据给定的表达式和参数推导出 $I$ 的闭式解析表达式。\n3. 计算 $I$ 的数值，并确定模型的陆面方案在该日强迫下是否能量守恒（$I = 0$ 对应精确守恒）。将最终数值答案四舍五入至四位有效数字，并以 $\\mathrm{kJ\\,m^{-2}}$ 为单位表示最终能量。计算中所有角度均以弧度处理。",
            "solution": "首先根据指定标准验证问题。\n\n### 步骤 1：提取给定条件\n给定的量和关系是：\n-   全波段净辐射：$R_n(t) = R_0 + A_R \\cos(\\omega t) - B_R \\cos(2\\omega t)$，单位为 $\\mathrm{W\\,m^{-2}}$\n-   湍流感热通量：$H(t) = H_0 + A_H \\cos(\\omega t - \\phi_H)$，单位为 $\\mathrm{W\\,m^{-2}}$\n-   湍流潜热通量：$LE(t) = LE_0 + A_{LE} \\cos(\\omega t - \\phi_{LE})$，单位为 $\\mathrm{W\\,m^{-2}}$\n-   日循环周期：$T = 86400$ s\n-   角频率：$\\omega = \\frac{2\\pi}{T}$\n-   $R_n(t)$ 的常数：$R_0 = 80$, $A_R = 220$, $B_R = 30$\n-   $H(t)$ 的常数：$H_0 = 35$, $A_H = 160$, $\\phi_H = \\frac{\\pi}{6}$\n-   $LE(t)$ 的常数：$LE_0 = 40$, $A_{LE} = 120$, $\\phi_{LE} = \\frac{\\pi}{4}$\n-   土壤热通量的模型参数化方案：$\\hat{G}(t) = \\alpha\\,R_n(t) - \\tau\\,\\frac{d R_n}{dt}$\n-   $\\hat{G}(t)$ 的常数：$\\alpha = 0.12$, $\\tau = 1200$\n-   日积分能量不平衡的定义：$I \\equiv \\int_{0}^{T} \\big(R_n(t) - H(t) - LE(t) - \\hat{G}(t)\\big)\\,dt$\n-   地表能量平衡原理：陆地表面的能量守恒，隐式表述为 $R_n(t) = H(t) + LE(t) + G(t)$，其中 $G(t)$ 是真实的地面热通量。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题在科学上基于微气象学和陆面建模拟的原理。地表能量平衡是一个基本概念。通量的函数形式是理想化的，但是是晴天条件下日循环的常见表示方法。土壤热通量的参数化方案 $\\hat{G}(t)$ 是一种简化形式，与陆面模型中使用的强迫-恢复法有关。该问题提法明确，提供了执行所要求任务所需的所有函数、常数和定义。语言客观且技术性强。问题设置自成体系，没有矛盾之处。该问题要求应用积分学来分析一个物理相关模型的性能，这是模型评估中的一项标准任务。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\n### 解答推导\n\n**任务 1：推导残余地面热通量 $G_{\\mathrm{res}}(t)$**\n\n陆地表面能量守恒原理指出，净辐射必须由湍流通量（感热和潜热）与地面热通量之和来平衡。残余地面热通量 $G_{\\mathrm{res}}(t)$ 被定义为基于观测通量完全闭合该收支的项。\n$$\nR_n(t) = H(t) + LE(t) + G_{\\mathrm{res}}(t)\n$$\n求解 $G_{\\mathrm{res}}(t)$:\n$$\nG_{\\mathrm{res}}(t) = R_n(t) - H(t) - LE(t)\n$$\n代入给定的函数形式：\n$$\nG_{\\mathrm{res}}(t) = \\left(R_0 + A_R \\cos(\\omega t) - B_R \\cos(2\\omega t)\\right) - \\left(H_0 + A_H \\cos(\\omega t - \\phi_H)\\right) - \\left(LE_0 + A_{LE} \\cos(\\omega t - \\phi_{LE})\\right)\n$$\n该表达式代表了由观测数据和能量守恒原理所隐含的地面热通量。\n\n**任务 2：推导 $I$ 的闭式解析表达式**\n\n模型的日积分能量不平衡 $I$ 定义为：\n$$\nI = \\int_{0}^{T} \\big(R_n(t) - H(t) - LE(t) - \\hat{G}(t)\\big)\\,dt\n$$\n我们可以将这个积分分解为各项积分之和：\n$$\nI = \\int_{0}^{T} R_n(t)\\,dt - \\int_{0}^{T} H(t)\\,dt - \\int_{0}^{T} LE(t)\\,dt - \\int_{0}^{T} \\hat{G}(t)\\,dt\n$$\n我们在一个完整周期 $T = \\frac{2\\pi}{\\omega}$ 上计算每个积分。对于任何非零整数 $n$，形式为 $\\cos(n\\omega t + \\phi)$ 的余弦函数在一个或多个完整周期上的积分为零。\n\n$R_n(t)$ 的积分：\n$$\n\\int_{0}^{T} R_n(t)\\,dt = \\int_{0}^{T} \\left(R_0 + A_R \\cos(\\omega t) - B_R \\cos(2\\omega t)\\right)\\,dt\n$$\n$$\n= \\int_{0}^{T} R_0\\,dt + A_R \\int_{0}^{T} \\cos(\\omega t)\\,dt - B_R \\int_{0}^{T} \\cos(2\\omega t)\\,dt\n$$\n余弦项的积分为零，所以：\n$$\n\\int_{0}^{T} R_n(t)\\,dt = R_0 [t]_{0}^{T} = R_0 T\n$$\n\n$H(t)$ 的积分：\n$$\n\\int_{0}^{T} H(t)\\,dt = \\int_{0}^{T} \\left(H_0 + A_H \\cos(\\omega t - \\phi_H)\\right)\\,dt = \\int_{0}^{T} H_0\\,dt + A_H \\int_{0}^{T} \\cos(\\omega t - \\phi_H)\\,dt = H_0 T\n$$\n\n$LE(t)$ 的积分：\n$$\n\\int_{0}^{T} LE(t)\\,dt = \\int_{0}^{T} \\left(LE_0 + A_{LE} \\cos(\\omega t - \\phi_{LE})\\right)\\,dt = \\int_{0}^{T} LE_0\\,dt + A_{LE} \\int_{0}^{T} \\cos(\\omega t - \\phi_{LE})\\,dt = LE_0 T\n$$\n\n$\\hat{G}(t)$ 的积分：\n地面热通量的模型是 $\\hat{G}(t) = \\alpha\\,R_n(t) - \\tau\\,\\frac{d R_n}{dt}$。\n$$\n\\int_{0}^{T} \\hat{G}(t)\\,dt = \\int_{0}^{T} \\left(\\alpha\\,R_n(t) - \\tau\\,\\frac{d R_n}{dt}\\right)\\,dt = \\alpha \\int_{0}^{T} R_n(t)\\,dt - \\tau \\int_{0}^{T} \\frac{d R_n}{dt}\\,dt\n$$\n第一项是 $\\alpha \\int_{0}^{T} R_n(t)\\,dt = \\alpha (R_0 T)$。\n第二项是全微分的积分：\n$$\n\\int_{0}^{T} \\frac{d R_n}{dt}\\,dt = R_n(T) - R_n(0)\n$$\n由于 $R_n(t)$ 是周期为 $T$ 的周期函数，所以 $R_n(T) = R_n(0)$。因此，该项为零。\n$$\n\\int_{0}^{T} \\hat{G}(t)\\,dt = \\alpha R_0 T\n$$\n这表明土壤热通量参数化方案中的时间导数分量对一个完整日循环内的净能量交换没有贡献。\n\n现在，我们组合出 $I$ 的表达式：\n$$\nI = R_0 T - H_0 T - LE_0 T - \\alpha R_0 T\n$$\n提出公因子 $T$：\n$$\nI = T \\left( R_0 - H_0 - LE_0 - \\alpha R_0 \\right)\n$$\n整理后：\n$$\nI = T \\left( (1-\\alpha)R_0 - H_0 - LE_0 \\right)\n$$\n这就是模型日积分能量不平衡的闭式解析表达式。\n\n**任务 3：计算 $I$ 的数值**\n\n我们将给定的数值代入推导出的 $I$ 的表达式中。\n给定：\n- $T = 86400$ s\n- $\\alpha = 0.12$\n- $R_0 = 80\\ \\mathrm{W\\,m^{-2}}$\n- $H_0 = 35\\ \\mathrm{W\\,m^{-2}}$\n- $LE_0 = 40\\ \\mathrm{W\\,m^{-2}}$\n\n$$\nI = 86400 \\times \\left( (1 - 0.12) \\times 80 - 35 - 40 \\right)\n$$\n$$\nI = 86400 \\times \\left( (0.88) \\times 80 - (35 + 40) \\right)\n$$\n$$\nI = 86400 \\times \\left( 70.4 - 75 \\right)\n$$\n$$\nI = 86400 \\times (-4.6)\n$$\n$$\nI = -397440 \\,\\mathrm{J\\,m^{-2}}\n$$\n问题要求答案以千焦耳每平方米（$\\mathrm{kJ\\,m^{-2}}$）为单位。\n$$\nI = \\frac{-397440}{1000} \\,\\mathrm{kJ\\,m^{-2}} = -397.44 \\,\\mathrm{kJ\\,m^{-2}}\n$$\n四舍五入到四位有效数字，得到：\n$$\nI = -397.4 \\,\\mathrm{kJ\\,m^{-2}}\n$$\n由于 $I \\neq 0$，模型的陆面方案在该日强迫下不满足能量守恒。负号表示在一天内系统存在净能量损失，这意味着该模型参数化方案每天会产生一个 $397.4\\,\\mathrm{kJ\\,m^{-2}}$ 的虚假能量汇。",
            "answer": "$$\n\\boxed{-397.4}\n$$"
        },
        {
            "introduction": "在检验了能量守恒等基本定律之后，过程导向评估的下一步是深入到特定的物理参数化方案。本练习聚焦于大气边界层，这是天气和气候模型中湍流混合的关键区域。你将应用莫宁-奥布霍夫相似性理论 (Monin-Obukhov Similarity Theory)，利用模拟的观测数据来标定一个稳定边界层湍流闭合方案中的关键参数，这个过程清晰地展示了如何连接理论、观测与模式参数化，是模式评估的核心实践之一。",
            "id": "4079679",
            "problem": "考虑在均一草地上方$z = 10~\\mathrm{m}$高度处的一个夜间稳定层结大气边界层（ABL）。其中的湍流通量和平均廓线与Monin–Obukhov相似性理论（MOST）一致。设von Kármán常数为$\\kappa = 0.40$。观测数据提供摩擦速度$u_{*} = 0.25~\\mathrm{m\\,s^{-1}}$，平均风切变$\\partial U/\\partial z = 0.12~\\mathrm{s^{-1}}$，以及Monin–Obukhov长度$L = 80~\\mathrm{m}$。\n\n一个用于动量通量的一阶闭合方案使用了一个依赖于稳定度的混合长度$l$和一个涡动扩散系数$K_{m}$，它们由模型的面向过程物理学定义如下：无量纲切变函数$\\phi_{m}$通过MOST将平均切变与湍流尺度联系起来，混合长度为$l = \\kappa z / \\phi_{m}$，涡动扩散系数为$K_{m} = l^{2}\\,|\\partial U/\\partial z|$。在此方案中，稳定度函数在稳定层结条件下参数化为$\\phi_{m}(z/L) = 1 + a\\,(z/L)$，其中$a$是一个需要通过观测数据来估计的无量纲常数。\n\n使用MOST对无量纲切变$\\phi_{m}$的定义和所提供的观测数据：\n- 推导出$z = 10~\\mathrm{m}$处观测到的$\\phi_{m}$。\n- 计算$z = 10~\\mathrm{m}$处的混合长度$l$和涡动扩散系数$K_{m}$（将$l$以$\\mathrm{m}$为单位表示，$K_{m}$以$\\mathrm{m^{2}\\,s^{-1}}$为单位表示）。\n- 施加方案的$\\phi_{m}(z/L)$等于观测到的$\\phi_{m}$这一要求，以求解常数$a$。\n\n将您最终估计出的常数$a$作为答案，四舍五入到四位有效数字。最终答案必须是无量纲的，且不带单位。",
            "solution": "问题陈述具有科学依据、是适定的且客观的。它基于大气边界层中已建立的Monin–Obukhov相似性理论（MOST）的原则。所提供的数据在物理上是现实的，并且足以确定所求量的唯一解。为模型物理学提供的定义虽然具体，但内部一致且与基础理论相符。因此，该问题是有效的，并且可以推导出解。\n\n该问题要求我们在MOST框架内，根据观测数据来评估一个一阶闭合方案。第一步是根据提供的测量值确定“观测到的”无量纲风切变$\\phi_{m}$。根据Monin–Obukhov相似性理论，$\\phi_{m}$定义为：\n$$\n\\phi_{m} = \\frac{\\kappa z}{u_{*}} \\frac{\\partial U}{\\partial z}\n$$\n此处，$\\kappa$是von Kármán常数，$z$是离地高度，$u_{*}$是摩擦速度，$\\partial U/\\partial z$是平均垂直风切变。在$z = 10~\\mathrm{m}$高度处提供的观测数据为：$\\kappa = 0.40$，$u_{*} = 0.25~\\mathrm{m\\,s^{-1}}$，以及$\\partial U/\\partial z = 0.12~\\mathrm{s^{-1}}$。\n\n将这些值代入$\\phi_{m}$的定义中，得到观测值，我们将其记为$\\phi_{m, \\text{obs}}$：\n$$\n\\phi_{m, \\text{obs}} = \\frac{(0.40)(10~\\mathrm{m})}{0.25~\\mathrm{m\\,s^{-1}}} (0.12~\\mathrm{s^{-1}})\n$$\n$$\n\\phi_{m, \\text{obs}} = \\frac{4.0}{0.25} \\times 0.12 = 16 \\times 0.12 = 1.92\n$$\n正如预期的那样，这个值是无量纲的。\n\n接下来，我们被要求使用模型指定的定义，计算同一高度处的混合长度$l$和动量涡动扩散系数$K_{m}$。模型将混合长度定义为：\n$$\nl = \\frac{\\kappa z}{\\phi_{m}}\n$$\n使用观测值$\\phi_{m, \\text{obs}} = 1.92$，我们计算$l$：\n$$\nl = \\frac{(0.40)(10~\\mathrm{m})}{1.92} = \\frac{4.0}{1.92}~\\mathrm{m} \\approx 2.0833~\\mathrm{m}\n$$\n将此表示为精确分数：\n$$\nl = \\frac{4}{1.92} = \\frac{400}{192} = \\frac{100}{48} = \\frac{25}{12}~\\mathrm{m}\n$$\n涡动扩散系数$K_{m}$由模型的物理学定义为：\n$$\nK_{m} = l^{2} \\left| \\frac{\\partial U}{\\partial z} \\right|\n$$\n代入我们刚刚求得的$l$值和给定的风切变$\\partial U/\\partial z = 0.12~\\mathrm{s^{-1}}$（其为正值，因此绝对值是多余的）：\n$$\nK_{m} = \\left(\\frac{25}{12}~\\mathrm{m}\\right)^{2} (0.12~\\mathrm{s^{-1}}) = \\frac{625}{144}~\\mathrm{m}^{2} \\times \\frac{12}{100}~\\mathrm{s^{-1}}\n$$\n$$\nK_{m} = \\frac{625 \\times 12}{144 \\times 100}~\\mathrm{m^{2}\\,s^{-1}} = \\frac{625}{12 \\times 100}~\\mathrm{m^{2}\\,s^{-1}} = \\frac{625}{1200}~\\mathrm{m^{2}\\,s^{-1}} = \\frac{25}{48}~\\mathrm{m^{2}\\,s^{-1}}\n$$\n数值上，$K_{m} \\approx 0.5208~\\mathrm{m^{2}\\,s^{-1}}$。\n\n最后，问题要求我们从模型在稳定条件下对$\\phi_{m}$的参数化中确定无量纲常数$a$：\n$$\n\\phi_{m}\\left(\\frac{z}{L}\\right) = 1 + a \\frac{z}{L}\n$$\n为了估计$a$，我们强制要求模型的$\\phi_{m}$在指定高度处必须等于观测值$\\phi_{m, \\text{obs}}$。首先，我们使用给定的数据计算稳定度参数$z/L$：$z = 10~\\mathrm{m}$ 和 Monin–Obukhov长度$L = 80~\\mathrm{m}$。\n$$\n\\frac{z}{L} = \\frac{10~\\mathrm{m}}{80~\\mathrm{m}} = \\frac{1}{8} = 0.125\n$$\n现在，我们将参数化的$\\phi_m$设为等于观测值$\\phi_{m, \\text{obs}} = 1.92$：\n$$\n1.92 = 1 + a (0.125)\n$$\n求解$a$：\n$$\na \\times 0.125 = 1.92 - 1\n$$\n$$\n0.125 a = 0.92\n$$\n$$\na = \\frac{0.92}{0.125} = \\frac{0.92}{1/8} = 0.92 \\times 8 = 7.36\n$$\n常数$a$的值恰好为$7.36$。问题要求答案四舍五入到四位有效数字。因此，我们将结果表示为$7.360$。",
            "answer": "$$\n\\boxed{7.360}\n$$"
        },
        {
            "introduction": "真实的模式调优过程往往不是追求单一指标的最优，而是在多个相互竞争的目标之间寻求平衡。本项高级练习引入帕累托前沿 (Pareto front) 分析，这是一个强大的多目标优化工具，用于探索模式物理过程中的内在权衡。通过分析一个简化的云微物理方案，你将学习如何在一个二维参数空间中识别最优的参数组合，以平衡降水效率和云反照率这两个相互制约的关键过程，这正是现代气候模式发展面临的核心挑战之一。",
            "id": "4079653",
            "problem": "考虑一个简化的、稳态的、用于浅层积云微物理的单柱诊断模型，该模型设计用于在数值天气预报和气候模拟中对模式物理过程进行面向过程的评估。目标是探索在一个块体暖雨方案中，通过改变两个可调参数——自动转换系数和夹卷蒸发系数，来研究两个过程级指标之间的权衡关系。基于基本的稳态液态水收支和广泛使用的辐射传输近似，推导并实施一个帕累托分析，以量化这种权衡关系并确定一个代表性的调参方案。\n\n使用以下基本且经过充分检验的公式：\n\n- 稳态柱积分液态水收支：预报的液水路径 $L$ 满足以下平衡\n$$0 = C - P - E_d,$$\n其中 $C$ 是一个给定的大尺度凝结源（柱积分，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$），$P$ 是降雨形成汇，而 $E_d$ 是夹卷蒸发汇。假设线性闭合方案\n$$P = a\\,L,\\quad E_d = e\\,L,$$\n其中 $a$ 为可调的自动转换系数，$e$ 为可调的夹卷蒸发系数（两者单位均为 $\\mathrm{s^{-1}}$）。因此，\n$$L = \\frac{C}{a+e}.$$\n\n- 将降水效率（无量纲）定义为\n$$\\mathrm{PE} = \\frac{P}{C} = \\frac{a}{a+e}.$$\n\n- 对于云光学厚度，使用标准近似\n$$\\tau_c = \\frac{3\\,L}{2\\,\\rho_w\\,r_e},$$\n其中液水密度 $\\rho_w = 1000\\ \\mathrm{kg\\,m^{-3}}$，有效半径 $r_e$（单位为 $\\mathrm{m}$）通过与滴数浓度 $N_d$ 的 Twomey 型标度关系进行参数化：\n$$r_e = r_{\\mathrm{ref}} \\left(\\frac{N_d}{N_{\\mathrm{ref}}}\\right)^{-1/3},\\quad r_{\\mathrm{ref}} = 12\\times 10^{-6}\\ \\mathrm{m},\\quad N_{\\mathrm{ref}} = 100\\ \\mathrm{cm^{-3}}.$$\n此处 $N_d$ 的单位为 $\\mathrm{cm^{-3}}$，在内部计算时必须转换为相对于 $N_{\\mathrm{ref}}$ 的无量纲比值。\n\n- 对于黑暗洋面上空的宽带短波云反照率，使用广泛接受的双流漫射近似\n$$A = \\frac{\\tau_c}{\\tau_c + 7.7},$$\n使得 $A \\in (0,1)$。\n\n目标和帕累托支配：\n\n- 两个需要最大化的目标是 $f_1 = \\mathrm{PE}$ 和 $f_2 = A$。\n- 如果 $f_1(a',e') \\ge f_1(a,e)$ 且 $f_2(a',e') \\ge f_2(a,e)$，并且其中至少一个不等式为严格不等，则参数对 $(a,e)$ 被 $(a',e')$ 帕累托支配。帕累托前沿是所有非支配对的集合。\n\n离散参数集：\n\n- 将可调参数限制在以下离散网格上\n$$a \\in \\{1\\times 10^{-4},\\ 2\\times 10^{-4},\\ 5\\times 10^{-4},\\ 1\\times 10^{-3},\\ 2\\times 10^{-3},\\ 5\\times 10^{-3}\\}\\ \\mathrm{s^{-1}},$$\n$$e \\in \\{1\\times 10^{-4},\\ 2\\times 10^{-4},\\ 5\\times 10^{-4},\\ 1\\times 10^{-3},\\ 2\\times 10^{-3},\\ 5\\times 10^{-3}\\}\\ \\mathrm{s^{-1}}.$$\n\n拐点选择：\n\n- 在所有帕累托最优解中，将“拐点”定义为在目标空间中与理想点 $(1,1)$ 的欧几里得距离最小的那个点：\n$$d = \\sqrt{(1-\\mathrm{PE})^2 + (1-A)^2}.$$\n- 平局打破规则：如果多个帕累托点在 $10^{-12}$ 的数值公差范围内具有相同的最小距离 $d$，则选择乘积 $\\mathrm{PE}\\times A$ 最大的那个点；如果仍然平局，则选择 $a$ 最小的那个点；如果依旧平局，则选择 $e$ 最小的那个点。\n\n测试组：\n\n评估三个科学上合理的案例，它们探讨了不同的强迫和气溶胶状况：\n\n1. 案例 H（理想路径）：$C = 1.5\\times 10^{-4}\\ \\mathrm{kg\\,m^{-2}\\,s^{-1}}$, $N_d = 100\\ \\mathrm{cm^{-3}}$。\n2. 案例 L（弱强迫，污染）：$C = 5\\times 10^{-5}\\ \\mathrm{kg\\,m^{-2}\\,s^{-1}}$, $N_d = 300\\ \\mathrm{cm^{-3}}$。\n3. 案例 S（强强迫，清洁）：$C = 2\\times 10^{-4}\\ \\mathrm{kg\\,m^{-2}\\,s^{-1}}$, $N_d = 50\\ \\mathrm{cm^{-3}}$。\n\n任务：\n\n- 实现一个完整的程序，为测试组中的每个案例计算：\n  - 指定离散网格上的帕累托前沿，\n  - 帕累托最优点数量，\n  - 以及拐点的指标和参数。\n- 您必须使用上述公式计算 $L$、$\\mathrm{PE}$、$\\tau_c$ 和 $A$，其中 $a$ 和 $e$ 的单位为 $\\mathrm{s^{-1}}$，$C$ 的单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$，$r_e$ 的单位为 $\\mathrm{m}$，$\\tau_c$ 和 $A$ 为无量纲。\n- 为每个案例输出一个包含五个条目的列表：\n  $$[\\ \\text{nPareto},\\ \\mathrm{PE}_{\\mathrm{knee}},\\ A_{\\mathrm{knee}},\\ a_{\\mathrm{knee}},\\ e_{\\mathrm{knee}}\\ ],$$\n  其中 $\\text{nPareto}$ 是一个整数，其他四个是小数值。$a_{\\mathrm{knee}}$ 和 $e_{\\mathrm{knee}}$ 的单位为 $\\mathrm{s^{-1}}$。将 $\\mathrm{PE}_{\\mathrm{knee}}$ 和 $A_{\\mathrm{knee}}$ 四舍五入到 $6$ 位小数。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含三个案例的结果，结果为逗号分隔的列表，每个案例本身都是一个如上指定的列表，并用方括号括起来，例如：\n$$[[\\text{nPareto}_H,\\ \\mathrm{PE}_H,\\ A_H,\\ a_H,\\ e_H],[\\text{nPareto}_L,\\ \\mathrm{PE}_L,\\ A_L,\\ a_L,\\ e_L],[\\text{nPareto}_S,\\ \\mathrm{PE}_S,\\ A_S,\\ a_S,\\ e_S]].$$\n不应打印任何额外文本。\n\n角度单位不适用。没有百分号；所有小数答案必须是十进制数。\n\n所有常数、单位和参数集均已在上面指定。您的实现必须具有足够的通用性，以精确应用所述的支配和拐点选择定义，并且必须使用提供的测试组，无需任何用户输入。",
            "solution": "该问题要求进行帕累托分析，以评估一个简化的云微物理模型中两个性能目标之间的权衡。该分析需要针对三个不同的环境案例进行，通过在离散网格上改变两个可调模型参数来实现。解决方案包括为所有参数组合计算目标函数值，识别非支配（帕累托最优）解集，然后根据明确定义的度量标准和打破平局的规则，从该集合中选择一个“拐点”。\n\n首先，我们根据所提供的物理模型，将目标函数形式化。模型参数是自动转换系数 $a$ 和夹卷蒸发系数 $e$。环境条件由大尺度凝结源 $C$ 和云滴数浓度 $N_d$ 设定。\n\n第一个目标是降水效率 $\\mathrm{PE}$。它被定义为降雨形成汇 $P = aL$ 与凝结源 $C$ 的比率。使用稳态液水路径 $L = \\frac{C}{a+e}$，我们得到：\n$$f_1 = \\mathrm{PE} = \\frac{P}{C} = \\frac{aL}{C} = \\frac{a}{C} \\left( \\frac{C}{a+e} \\right) = \\frac{a}{a+e}$$\n这个目标需要被最大化。最大化 $f_1$ 有利于 $a$ 相对于 $e$ 取较大的值。\n\n第二个目标是云反照率 $A$。它取决于云光学厚度 $\\tau_c$，而云光学厚度又取决于液水路径 $L$。反照率由双流近似给出：\n$$f_2 = A = \\frac{\\tau_c}{\\tau_c + 7.7}$$\n由于当 $\\tau_c > 0$ 时，$A$ 是 $\\tau_c$ 的单调递增函数，因此最大化 $A$ 等同于最大化 $\\tau_c$。光学厚度由以下公式给出：\n$$\\tau_c = \\frac{3L}{2\\rho_w r_e}$$\n其中液水密度 $\\rho_w = 1000\\ \\mathrm{kg\\,m^{-3}}$，有效半径 $r_e$ 参数化为：\n$$r_e = r_{\\mathrm{ref}} \\left(\\frac{N_d}{N_{\\mathrm{ref}}}\\right)^{-1/3}$$\n常数为 $r_{\\mathrm{ref}} = 12\\times 10^{-6}\\ \\mathrm{m}$ 和 $N_{\\mathrm{ref}} = 100\\ \\mathrm{cm^{-3}}$。对于给定的测试案例，$C$ 和 $N_d$ 是固定的，这意味着 $r_e$ 也是固定的。代入 $L$ 的表达式：\n$$\\tau_c = \\frac{3}{2\\rho_w r_e} L = \\frac{3C}{2\\rho_w r_e (a+e)}$$\n这表明 $\\tau_c$ 与 $a+e$ 的和成反比。因此，为了最大化第二个目标 $f_2 = A$，我们必须最小化 $a+e$ 的和。\n\n因此，这两个目标是直接冲突的。增加 $a$ 相对于 $e$ 的值会倾向于增加 $\\mathrm{PE}$ 但减少 $A$（通过增加 $a+e$ 或减少 $L$），反之亦然。这种权衡是帕累托分析的核心。\n\n对每个测试案例的分析都按三个主要步骤进行：\n1.  **目标空间生成**：我们遍历指定离散网格中的每一对 $(a, e)$。对于每一对，我们计算两个目标 $f_1 = \\mathrm{PE}$ 和 $f_2 = A$ 的值，形成二维目标空间中的一个点 $(\\mathrm{PE}, A)$。我们将这个点及其对应的参数 $(a, e)$ 一起存储。\n\n2.  **帕累托前沿识别**：我们识别非支配点的集合，该集合构成了帕累托前沿。如果 $\\mathrm{PE}_j \\ge \\mathrm{PE}_i$ 且 $A_j \\ge A_i$，并且至少有一个不等式是严格的，那么具有目标 $(\\mathrm{PE}_i, A_i)$ 的点 $(a_i, e_i)$ 被另一个具有目标 $(\\mathrm{PE}_j, A_j)$ 的点 $(a_j, e_j)$ 支配。帕累托前沿由集合中不存在任何支配它的点的所有点组成。我们的算法遍历每个点，并将其与所有其他点进行比较，以确定它是否被支配。如果它不被任何其他点支配，则将其添加到帕累托前沿。该集合中的点数是 $\\text{nPareto}$。\n\n3.  **拐点选择**：从已识别的帕累托最优点中，我们选择一个称为“拐点”的单一代表性调参方案。这个点代表了在冲突目标之间的一个平衡折衷。选择遵循一个多级标准：\n    a.  首先，我们计算每个帕累托点到理想但无法达到的点 $(1,1)$ 的欧几里得距离 $d = \\sqrt{(1-\\mathrm{PE})^2 + (1-A)^2}$。主要目标是找到使这个距离最小化的点。\n    b.  如果发现多个点与理想点的距离相等（在 $10^{-12}$ 的数值公差范围内），我们应用一系列打破平局的规则。第一个平局打破规则是选择乘积 $\\mathrm{PE} \\times A$ 具有最大值的点。\n    c.  如果仍然存在平局，我们选择具有最小自动转换系数 $a$ 的点。\n    d.  如果平局依然存在，我们选择具有最小夹卷蒸发系数 $e$ 的点。这个最终规则保证了选择的唯一性，因为每个 $(a, e)$ 对都是唯一的。\n    \n实现此选择的一种有效方法是使用一个复合键对帕累托最优点列表进行排序，该复合键按顺序反映了选择标准：`(distance, -product, a, e)`。排序后列表的第一个元素就是所求的拐点。\n\n此过程将应用于三个测试案例（案例 H、案例 L、案例 S）中的每一个，这些案例旨在探究模型在不同大尺度强迫和气溶胶条件下的行为。每个案例的最终输出是一个列表，包含帕累托点的数量 $\\text{nPareto}$，以及所选拐点的属性：$\\mathrm{PE}_{\\mathrm{knee}}$、 $A_{\\mathrm{knee}}$、 $a_{\\mathrm{knee}}$ 和 $e_{\\mathrm{knee}}$。",
            "answer": "[[11,0.666667,0.490715,0.0002,0.0001],[11,0.666667,0.292212,0.0002,0.0001],[11,0.666667,0.596008,0.0002,0.0001]]"
        }
    ]
}