{
    "hands_on_practices": [
        {
            "introduction": "极地地区独特的太阳辐射模式是极地气候系统的主要驱动力。本练习将指导您从轨道力学的第一性原理出发，推导高纬度地区的日照日循环和日平均日照量，以此揭示数值模型必须准确捕捉的极端辐射环境。掌握这种计算是理解极地表面能量平衡和气候动态的基础。",
            "id": "4022013",
            "problem": "考虑高纬度辐射强迫在极地条件下与数值天气预报 (NWP) 和气候模拟的相关性。在大气层顶 (TOA)，入射到水平面上的瞬时直接太阳辐照度是地外太阳常数与太阳天顶角的余弦的乘积（当太阳在地平线之上时），否则为零。假设：\n- 地球轨道为圆形，太阳常数恒定为 $S_0 = 1361\\,\\mathrm{W\\,m^{-2}}$。\n- 地球的黄赤交角（倾角）为 $\\varepsilon = 23.44^\\circ$。\n- 时间为北半球夏至，因此太阳赤纬为 $\\delta = +\\varepsilon$。\n- 某地点的纬度为 $\\phi = 80^\\circ$。\n- 无大气消光、折射或地形遮蔽。\n- 所有三角函数和时角均使用弧度。\n- 一个平太阳日为 $24\\,\\mathrm{h}$，地球均匀自转，因此在一个地方太阳日内，时角 $h$ 在区间 $h \\in [-\\pi, \\pi]$ 上均匀变化。\n\n从地日几何关系的第一性原理出发，并根据大气层顶辐照度等于 $S_0$ 乘以单位太阳光束方向在当地地表法线上的标量投影（当太阳在地平线以下时为零）的定义，推导在至日条件下 $\\phi=80^\\circ$ 处大气层顶日照 $I(h)$ 的日变化周期。然后，通过将 $I(h)$ 在一个地方太阳日内均匀平均来计算日平均日照 $\\overline{I}$。将日平均值四舍五入至四位有效数字，并以 $\\mathrm{W\\,m^{-2}}$ 为单位表示最终数值答案。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **太阳常数**：$S_0 = 1361\\,\\mathrm{W\\,m^{-2}}$\n- **地球黄赤交角**：$\\varepsilon = 23.44^\\circ$\n- **时间**：北半球夏至，这意味着太阳赤纬 $\\delta = +\\varepsilon$。\n- **地点**：某地点的纬度为 $\\phi = 80^\\circ$。\n- **假设**：\n    - 地球轨道为圆形。\n    - 无大气效应（消光、折射）。\n    - 无地形遮蔽。\n- **定义**：\n    - 大气层顶 (TOA) 瞬时直接太阳辐照度 $I(h)$ 由 $S_0$ 乘以太阳天顶角 $\\theta_z$ 的余弦给出，当太阳在地平线以下时为零。\n    - 在一个 $24\\,\\mathrm{h}$ 的太阳日内，时角 $h$ 在区间 $h \\in [-\\pi, \\pi]$ 上均匀变化。\n- **任务**：\n    1. 推导大气层顶日照 $I(h)$ 的日变化周期。\n    2. 通过将 $I(h)$ 在一个地方太阳日内平均来计算日平均日照 $\\overline{I}$。\n    3. 将 $\\overline{I}$ 的最终数值答案四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于定位天文学和辐射传输的基本原理。基于太阳天顶角的太阳日照公式是大气科学和气候学的基石。所有提供的常数（$S_0$, $\\varepsilon$）都是标准和公认的值。\n2.  **适定性**：该问题提供了推导日照及其日平均值所需的所有必要信息。任务定义明确，数学框架允许唯一解。\n3.  **客观性**：问题陈述没有主观语言、推测或歧义。它提出了一个纯粹的定量物理问题。\n\n### 步骤 3：结论与行动\n该问题是有效的。它科学合理、适定、客观，并包含足够的信息以获得唯一解。开始求解。\n\n大气层顶水平面上的瞬时太阳日照 $I$ 由入射太阳辐射在当地地表法线上的投影给出。其表达式为：\n$$\nI(h) = S_0 \\max(0, \\cos(\\theta_z))\n$$\n其中 $S_0$ 是太阳常数，$\\theta_z$ 是太阳天顶角。$\\max(0, \\dots)$ 项说明了当太阳在地平线以下时（即当 $\\theta_z > \\frac{\\pi}{2}$，这使得 $\\cos(\\theta_z)  0$），没有日照。\n\n太阳天顶角的余弦由标准公式给出，该公式将其与观测者纬度 $\\phi$、太阳赤纬 $\\delta$ 和时角 $h$ 联系起来：\n$$\n\\cos(\\theta_z) = \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)\n$$\n时角 $h$ 的定义是：地方太阳正午时 $h=0$，上午 $h0$，下午 $h>0$。在一个持续时间为 $T = 24\\,\\mathrm{h}$ 的完整太阳日内，它的范围是 $[-\\pi, \\pi]$。\n\n问题指定了夏至，因此太阳赤纬等于地球的黄赤交角：$\\delta = \\varepsilon = 23.44^\\circ$。给定的纬度是 $\\phi = 80^\\circ$。\n\n首先，我们确定在这一天，太阳在该地点是否会落下。如果纬度与赤纬之和大于 $90^\\circ$，那么太阳就是拱极的（即全天都保持在地平线之上）。\n$$\n\\phi + \\delta = 80^\\circ + 23.44^\\circ = 103.44^\\circ\n$$\n由于 $103.44^\\circ > 90^\\circ$，该地点经历24小时白昼（极昼）。这意味着 $\\theta_z$ 始终小于 $90^\\circ$（或 $\\frac{\\pi}{2}$ 弧度），因此 $\\cos(\\theta_z)$ 始终为正。为了证实这一点，我们可以检查 $\\cos(\\theta_z)$ 的最小值，它出现在地方午夜时，此时 $h = \\pm\\pi$ 且 $\\cos(h) = -1$：\n$$\n\\cos(\\theta_{z, \\text{at midnight}}) = \\sin(\\phi)\\sin(\\delta) - \\cos(\\phi)\\cos(\\delta)\n$$\n该值关联的是午夜时的 $\\cos(\\theta_z)$。\n数值上，$\\sin(80^\\circ) \\approx 0.9848$，$\\sin(23.44^\\circ) \\approx 0.3978$，$\\cos(80^\\circ) \\approx 0.1736$，且 $\\cos(23.44^\\circ) \\approx 0.9174$。\n所以，$\\cos(\\theta_{z, \\text{at midnight}}) \\approx (0.9848)(0.3978) - (0.1736)(0.9174) \\approx 0.3918 - 0.1593 = 0.2325$。\n由于 $\\cos(\\theta_z)$ 的最小值为正，太阳始终在地平线之上。\n\n因此，在这种特殊情况下，$\\max(0, \\dots)$ 运算是多余的，大气层顶日照 $I(h)$ 的日变化周期由以下公式给出：\n$$\nI(h) = S_0 \\left( \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h) \\right) \\quad \\text{for } h \\in [-\\pi, \\pi]\n$$\n这就是在指定条件下推导出的的大气层顶日照日变化周期的表达式。\n\n接下来，我们通过将 $I(h)$ 在一个完整的日变化周期内平均来计算日平均日照 $\\overline{I}$。时角 $h$ 的平均区间为 $-\\pi$ 到 $\\pi$，总长度为 $2\\pi$。\n$$\n\\overline{I} = \\frac{1}{\\pi - (-\\pi)} \\int_{-\\pi}^{\\pi} I(h) \\,dh = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} S_0 \\left( \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h) \\right) \\,dh\n$$\n我们可以将积分分成两部分：\n$$\n\\overline{I} = \\frac{S_0}{2\\pi} \\left[ \\int_{-\\pi}^{\\pi} \\sin(\\phi)\\sin(\\delta) \\,dh + \\int_{-\\pi}^{\\pi} \\cos(\\phi)\\cos(\\delta)\\cos(h) \\,dh \\right]\n$$\n项 $\\sin(\\phi)\\sin(\\delta)$ 和 $\\cos(\\phi)\\cos(\\delta)$ 相对于积分变量 $h$ 是常数。\n第一个积分是：\n$$\n\\int_{-\\pi}^{\\pi} \\sin(\\phi)\\sin(\\delta) \\,dh = \\sin(\\phi)\\sin(\\delta) [h]_{-\\pi}^{\\pi} = \\sin(\\phi)\\sin(\\delta) (\\pi - (-\\pi)) = 2\\pi\\sin(\\phi)\\sin(\\delta)\n$$\n第二个积分取决于 $\\cos(h)$ 的积分：\n$$\n\\int_{-\\pi}^{\\pi} \\cos(\\phi)\\cos(\\delta)\\cos(h) \\,dh = \\cos(\\phi)\\cos(\\delta) \\int_{-\\pi}^{\\pi} \\cos(h) \\,dh\n$$\n余弦函数在一个完整周期内的积分为零：\n$$\n\\int_{-\\pi}^{\\pi} \\cos(h) \\,dh = [\\sin(h)]_{-\\pi}^{\\pi} = \\sin(\\pi) - \\sin(-\\pi) = 0 - 0 = 0\n$$\n将这些结果代回 $\\overline{I}$ 的表达式中：\n$$\n\\overline{I} = \\frac{S_0}{2\\pi} \\left[ 2\\pi\\sin(\\phi)\\sin(\\delta) + 0 \\right]\n$$\n这可以简化为极昼期间日平均日照的解析表达式：\n$$\n\\overline{I} = S_0 \\sin(\\phi)\\sin(\\delta)\n$$\n现在，我们代入数值：\n$S_0 = 1361\\,\\mathrm{W\\,m^{-2}}$\n$\\phi = 80^\\circ$\n$\\delta = 23.44^\\circ$\n$$\n\\overline{I} = (1361) \\sin(80^\\circ) \\sin(23.44^\\circ)\n$$\n使用计算器计算三角函数：\n$\\sin(80^\\circ) \\approx 0.98480775$\n$\\sin(23.44^\\circ) \\approx 0.39778200$\n$$\n\\overline{I} \\approx 1361 \\times 0.98480775 \\times 0.39778200\n$$\n$$\n\\overline{I} \\approx 1361 \\times 0.3917904\n$$\n$$\n\\overline{I} \\approx 533.22673\\,\\mathrm{W\\,m^{-2}}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\overline{I} \\approx 533.2\\,\\mathrm{W\\,m^{-2}}\n$$",
            "answer": "$$\n\\boxed{533.2}\n$$"
        },
        {
            "introduction": "在地球物理流体动力学中，地球自转的影响在向两极移动时变得愈发主导。本练习将探讨惯性振荡——在没有压力梯度力情况下的基本运动模式——并计算其周期，从而阐明为何其在高纬度地区的短周期对天气和气候模型的数值稳定性与数据同化方案构成了严峻挑战。",
            "id": "4021925",
            "problem": "在高纬度地区，对数值天气预报 (NWP) 和气候模型构成挑战的一个重要动力学时间尺度是在旋转作用下水平运动的惯性周期。考虑一个位于纬度 $\\phi$ 处地球局部切平面（一个 $f$-平面近似）上的水平均匀干空气块，其水平气压梯度可忽略，摩擦力可忽略，并且除了旋转参考系表述中隐含的力之外，没有其他外部体积力。从应用于旋转参考系的牛顿第二定律出发，用科里奥利参数推导由此产生的水平惯性振荡的周期。然后，使用地球自转速率 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}$，计算纬度 $\\phi = 80^{\\circ}$ 处的这个周期。\n\n要求：\n- 从旋转参考系下的动量方程开始，并明确陈述所有假设。\n- 将惯性振荡周期推导为用科里奥利参数 $f$ 和纬度 $\\phi$ 表示的解析表达式，不引用任何预先推导出的惯性周期公式。\n- 角度以度为单位处理；相应地写出 $\\sin(80^{\\circ})$。\n- 以小时为单位计算最终周期，并将最终数值答案四舍五入到四位有效数字。\n- 将以小时为单位的最终周期作为答案。",
            "solution": "问题陈述经评估具有科学依据、提法恰当且客观。它基于地球物理流体动力学的基本原理，包含所有必要信息，且没有歧义或矛盾。该问题有效，将提供解答。\n\n我们从随地球旋转的参考系中流体微团的牛顿第二定律开始。动量方程为：\n$$\n\\frac{d\\vec{v}}{dt} + 2\\vec{\\Omega} \\times \\vec{v} = -\\frac{1}{\\rho}\\nabla p - \\vec{g}_{eff} + \\vec{F}_r\n$$\n此处，$\\vec{v}$ 是空气块相对于旋转地球的速度，$\\vec{\\Omega}$ 是地球的角速度矢量，$\\rho$ 是空气密度，$p$ 是气压，$\\vec{g}_{eff}$ 是有效重力（真实重力加上未被旋转参考系定义吸收的离心力分量），$\\vec{F}_r$ 代表摩擦力。\n\n我们应用问题陈述中指定的条件：\n1.  我们考虑一个局部切平面，称为 $f$-平面。我们使用一个笛卡尔坐标系，其中 $x$ 指向东方（纬向），$y$ 指向北方（经向），$z$ 垂直向上。速度分量为 $\\vec{v} = (u, v, w)$。\n2.  在纬度 $\\phi$ 处，地球的角速度矢量为 $\\vec{\\Omega} = (0, \\Omega\\cos\\phi, \\Omega\\sin\\phi)$。\n3.  科里奥利加速度项是 $2\\vec{\\Omega} \\times \\vec{v}$。对于大尺度大气运动，水平速度（$u, v$）远大于垂直速度（$w$），因此我们可以在科里奥利项中近似 $w \\approx 0$。这是地球物理流体动力学中传统近似的一个标准部分。\n    $$\n    2\\vec{\\Omega} \\times \\vec{v} = 2 \\begin{vmatrix} \\hat{i}  \\hat{j}  \\hat{k} \\\\ 0  \\Omega\\cos\\phi  \\Omega\\sin\\phi \\\\ u  v  0 \\end{vmatrix} = 2(-v\\Omega\\sin\\phi)\\hat{i} + 2(u\\Omega\\sin\\phi)\\hat{j} - 2(u\\Omega\\cos\\phi)\\hat{k}\n    $$\n4.  我们定义科里奥利参数为 $f = 2\\Omega\\sin\\phi$。科里奥利加速度的水平分量是 $(-fv, fu)$。\n5.  水平气压梯度可忽略：$\\frac{\\partial p}{\\partial x} = 0$ 且 $\\frac{\\partial p}{\\partial y} = 0$。\n6.  摩擦力可忽略：$\\vec{F}_r = 0$。\n\n在这些假设下，我们研究的是纯惯性运动，其中气块的加速度仅由科里奥利力平衡。动量方程的水平分量变为：\n$$\n\\frac{du}{dt} = f v\n$$\n$$\n\\frac{dv}{dt} = -f u\n$$\n这是一个一阶线性常微分方程的耦合系统。为了求解它，我们可以将第一个方程对时间 $t$ 求导：\n$$\n\\frac{d^2u}{dt^2} = f \\frac{dv}{dt}\n$$\n现在，从第二个方程中代入 $\\frac{dv}{dt}$ 的表达式：\n$$\n\\frac{d^2u}{dt^2} = f (-f u) = -f^2 u\n$$\n这就得到了关于纬向速度分量 $u$ 的一个二阶齐次微分方程：\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\n这是简谐振子的方程。$u(t)$ 的通解是\n$$\nu(t) = C_1 \\cos(ft) + C_2 \\sin(ft)\n$$\n其中 $C_1$ 和 $C_2$ 是由初始条件决定的常数。$v(t)$ 的解可以从方程 $\\frac{du}{dt} = fv$ 中找到，即 $v = \\frac{1}{f}\\frac{du}{dt}$：\n$$\nv(t) = \\frac{1}{f} \\frac{d}{dt} \\left( C_1 \\cos(ft) + C_2 \\sin(ft) \\right) = \\frac{1}{f} \\left( -C_1 f \\sin(ft) + C_2 f \\cos(ft) \\right)\n$$\n$$\nv(t) = -C_1 \\sin(ft) + C_2 \\cos(ft)\n$$\n速度分量 $u(t)$ 和 $v(t)$ 以角频率 $\\omega_i = |f|$ 振荡。振荡周期 $T_i$ 与其角频率的关系为 $T_i = \\frac{2\\pi}{\\omega_i}$。因此，惯性振荡的周期是：\n$$\nT_i = \\frac{2\\pi}{|f|}\n$$\n代入科里奥利参数的定义 $f = 2\\Omega\\sin\\phi$，我们得到惯性周期的解析表达式：\n$$\nT_i = \\frac{2\\pi}{|2\\Omega\\sin\\phi|} = \\frac{\\pi}{\\Omega|\\sin\\phi|}\n$$\n周期恒为正值，因此使用绝对值。对于给定的纬度 $\\phi = 80^{\\circ}$（在北半球），$\\sin\\phi > 0$，所以我们可以去掉绝对值符号。\n\n现在，我们对该周期进行数值计算。给定条件如下：\n地球自转速率 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n纬度 $\\phi = 80^{\\circ}$\n\n首先，我们计算以秒为单位的周期：\n$$\nT_i = \\frac{\\pi}{(7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times \\sin(80^{\\circ})}\n$$\n使用 $\\sin(80^{\\circ}) \\approx 0.98480775$：\n$$\nT_i \\approx \\frac{\\pi}{(7.292 \\times 10^{-5}) \\times 0.98480775} \\approx \\frac{\\pi}{7.182503 \\times 10^{-5}}\\,\\mathrm{s} \\approx 43748.69\\,\\mathrm{s}\n$$\n问题要求最终答案以小时为单位。要从秒转换为小时，我们除以 $3600$：\n$$\nT_i \\text{ (小时)} = \\frac{T_i (\\text{秒})}{3600} = \\frac{43748.69}{3600} \\approx 12.15241\\,\\text{小时}\n$$\n将结果四舍五入到四位有效数字，我们得到 $12.15$。第五位有效数字是 $2$，因此我们不对第四位进行进位。",
            "answer": "$$\n\\boxed{12.15}\n$$"
        },
        {
            "introduction": "从理想化的物理问题过渡到实际的建模挑战，极地表面并非均匀一致，海冰中的开阔水域（即冰间水道）会导致表面特性的巨大差异。这项高级实践要求您构建一个计算参数化方案，以确定冰水混合网格单元的有效表面粗糙度和感热通量，这对于在气候模型中准确模拟地气交换至关重要。",
            "id": "4021937",
            "problem": "在北极地区的数值天气预报 (NWP) 和气候模式中，一个粗网格单元包含非均匀海冰以及次网格尺度的海冰冰间水道（狭窄的开阔水域通道）。任务是为这些次网格冰间水道构建一个参数化方案，以得出粗网格尺度上的有效动量粗糙度长度和感热通量增强因子。假设在粗网格尺度上，参考高度的风速和气温是水平均一的，大气稳定度为中性，并忽略内部边界层的发展或遮蔽效应。请使用基于原理的推导，从近地层理论和面积平均通量一致性出发，不要引用任何直接给出有效参数的快捷公式。\n\n使用的基本原理：\n- Reynolds 平均地表动量通量由 $$\\tau = \\rho \\, u_*^2$$ 给出，其中 $\\rho$ 是空气密度， $u_*$ 是摩擦速度。\n- 在中性层结条件下，对数风廓线为 $$U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right),$$ 其中 $U(z)$ 是高度 $z$ 处的风速，$\\kappa$ 是 von Kármán 常数，$z_{0m}$ 是动量粗糙度长度。\n- 参考高度 $z$ 处的中性总体拖曳系数满足 $$C_D = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m}}\\right)}\\right]^2.$$\n- 中性总体感热输送系数满足 $$C_H = \\frac{\\kappa^2}{\\ln\\left(\\frac{z}{z_{0m}}\\right)\\,\\ln\\left(\\frac{z}{z_{0t}}\\right)},$$ 其中 $z_{0t}$ 是标量（热力）粗糙度长度。\n- 总体感热通量为 $$H = \\rho \\, c_p \\, C_H \\, U(z) \\, \\left(T_s - T_a\\right),$$ 其中 $c_p$ 是空气定压比热，$T_s$ 是地表温度，$T_a$ 是高度 $z$ 处的气温。\n- 对于开阔水域，使用带有粘性修正的 Charnock 关系式从 $u_*$ 确定 $z_{0m}$：$$z_{0m} = \\alpha \\frac{u_*^2}{g} + \\beta \\frac{\\nu_a}{u_*},$$ 其中 $\\alpha$ 是 Charnock 系数，$g$ 是重力加速度，$\\beta$ 是粘性修正系数，$\\nu_a$ 是空气运动粘度。\n\n情景与参数：\n- 考虑一个粗网格单元，其冰间水道面积分数为 $f_\\ell \\in [0, 1]$。剩余的分数 $1 - f_\\ell$ 是海冰。\n- 参考高度为 $z = 10\\,\\mathrm{m}$，给定为 $10$。\n- 空气密度为 $\\rho = 1.3\\,\\mathrm{kg\\,m^{-3}}$，给定为 $1.3$。\n- 定压比热为 $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，给定为 $1004$。\n- Von Kármán 常数为 $\\kappa = 0.4$，给定为 $0.4$。\n- 重力加速度为 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，给定为 $9.81$。\n- 空气运动粘度为 $\\nu_a = 1.5\\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$，给定为 $1.5\\times 10^{-5}$。\n- Charnock 系数为 $\\alpha = 0.014$，给定为 $0.014$；粘性修正系数为 $\\beta = 0.11$，给定为 $0.11$。\n- $z$ 处风速为 $U(z) = 8\\,\\mathrm{m\\,s^{-1}}$，给定为 $8$。\n- 气温为 $T_a = -25\\,^{\\circ}\\text{C}$，给定为 $-25$；海冰表面温度为 $T_{s,i} = -20\\,^{\\circ}\\text{C}$，给定为 $-20$；冰间水道（开阔水域）表面温度为 $T_{s,w} = -1.8\\,^{\\circ}\\text{C}$，给定为 $-1.8$。\n- 海冰动量粗糙度长度为 $z_{0m,i} = 0.003\\,\\mathrm{m}$，给定为 $0.003$。\n- 假设热力粗糙度长度与动量粗糙度长度之间存在恒定比率，$z_{0t} = r_t \\, z_{0m}$，其中 $r_t = 0.1$，给定为 $0.1$，该比率适用于两种表面。\n\n任务：\n- 仅使用上面列出的基本原理，通过在参考高度 $z$ 处强制执行面积平均通量一致性，为次网格冰间水道构建一个参数化方案，以获得混合表面的有效总体动量输送。由此，确定有效动量粗糙度长度 $z_{0m,\\mathrm{eff}}$（单位：米）。\n- 使用相同的原理，计算混合表面的面积平均感热通量，并将感热通量增强因子 $E$ 定义为在相同参考条件下，混合表面感热通量与纯冰表面感热通量之比。将 $E$ 表示为十进制小数（无量纲）。\n\n测试组：\n- 对以下冰间水道分数 $f_\\ell$ 评估该参数化方案：$0$, $0.01$, $0.05$, $0.3$, $1$。\n\n答案规格和输出格式：\n- 对于每个测试用例，返回一个包含两个元素的列表，其中包含 $z_{0m,\\mathrm{eff}}$（单位：米）和 $E$（十进制小数）。\n- 你的程序应生成一行输出，包含所有测试用例的结果，形式为方括号内包含的逗号分隔列表，其中每个元素是上述的双元素列表。例如，输出形式应为 `[[z0_1,E_1],[z0_2,E_2],...]`。",
            "solution": "该问题要求推导并实现一个针对粗网格模式单元内次网格尺度海冰冰间水道的参数化方案。目标是基于面积平均通量一致性原理，为非均匀表面找到有效动量粗糙度长度 $z_{0m,\\mathrm{eff}}$ 和感热通量增强因子 $E$。\n\n基本假设是，来自粗网格单元的总通量是其组成的次网格表面——海冰（下标 $i$）和开阔水域冰间水道（下标 $w$）——通量的面积加权平均值。海冰的面积分数为 $1 - f_\\ell$，冰间水道的面积分数为 $f_\\ell$。假设参考高度的风速 $U(z)$ 和气温 $T_a$ 在整个单元上是水平均一的。\n\n### 第1部分：有效动量粗糙度长度 ($z_{0m,\\mathrm{eff}}$) 的推导\n\n应用于地表动量通量 $\\tau$（应力）的面积平均通量一致性原理表明：\n$$ \\tau_{\\mathrm{eff}} = (1 - f_\\ell)\\tau_i + f_\\ell \\tau_w $$\n使用定义 $\\tau = \\rho u_*^2 = \\rho C_D U(z)^2$，其中 $u_*$ 是摩擦速度，$C_D$ 是总体拖曳系数，$\\rho$ 是恒定的空气密度，我们可以将有效拖曳系数 $C_{D,\\mathrm{eff}}$ 表示为次网格拖曳系数的面积加权平均值：\n$$ C_{D,\\mathrm{eff}} = (1 - f_\\ell)C_{D,i} + f_\\ell C_{D,w} $$\n我们的目标是求出 $z_{0m,\\mathrm{eff}}$，它通过中性总体拖曳系数公式与 $C_{D,\\mathrm{eff}}$ 相关联：\n$$ C_{D,\\mathrm{eff}} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m,\\mathrm{eff}}}\\right)}\\right]^2 $$\n对该方程求解 $z_{0m,\\mathrm{eff}}$，可得：\n$$ z_{0m,\\mathrm{eff}} = z \\cdot \\exp\\left(-\\frac{\\kappa}{\\sqrt{C_{D,\\mathrm{eff}}}}\\right) $$\n为了计算 $z_{0m,\\mathrm{eff}}$，我们必须首先确定 $C_{D,i}$ 和 $C_{D,w}$。\n\n**1.a. 海冰上的拖曳系数 ($C_{D,i}$)**\n海冰的动量粗糙度长度 $z_{0m,i}$ 是一个给定的常数。因此，$C_{D,i}$ 可以直接计算：\n$$ C_{D,i} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m,i}}\\right)}\\right]^2 $$\n使用给定参数，$z = 10\\,\\mathrm{m}$，$\\kappa=0.4$，$z_{0m,i} = 0.003\\,\\mathrm{m}$。\n\n**1.b. 水面上的拖曳系数 ($C_{D,w}$)**\n水面的粗糙度 $z_{0m,w}$ 是动态的，并通过 Charnock 关系式取决于水面上的摩擦速度 $u_{*,w}$。而摩擦速度又通过对数风廓线取决于粗糙度长度。这就形成了一个必须迭代求解的非线性方程组：\n1.  $$ z_{0m,w} = \\alpha \\frac{u_{*,w}^2}{g} + \\beta \\frac{\\nu_a}{u_{*,w}} $$\n2.  $$ u_{*,w} = \\frac{\\kappa U(z)}{\\ln\\left(\\frac{z}{z_{0m,w}}\\right)} $$\n迭代求解过程如下：\n- 以 $u_{*,w}$ 的初始猜测值开始（例如，冰面上的值 $u_{*,i}$）。\n- 使用当前的 $u_{*,w}$，通过方程 (1) 反复更新 $z_{0m,w}$。\n- 随后使用新的 $z_{0m,w}$，通过方程 (2) 更新 $u_{*,w}$。\n- 持续此过程，直到 $u_{*,w}$ 的值收敛。\n\n一旦找到收敛的 $u_{*,w}$ 值，就可以通过关系式 $u_{*,w}^2 = C_{D,w} U(z)^2$ 来确定拖曳系数 $C_{D,w}$：\n$$ C_{D,w} = \\left(\\frac{u_{*,w}}{U(z)}\\right)^2 $$\n当 $C_{D,i}$ 和 $C_{D,w}$ 都已知时，就可以对任何给定的 $f_\\ell$ 计算出 $C_{D,\\mathrm{eff}}$，并由此计算出 $z_{0m,\\mathrm{eff}}$。\n\n### 第2部分：感热通量增强因子 ($E$) 的推导\n\n增强因子 $E$ 是混合表面总感热通量 $H_{\\mathrm{eff}}$ 与纯冰表面通量 $H_{i, \\text{pure}}$ 之比：\n$$ E = \\frac{H_{\\mathrm{eff}}}{H_{i, \\text{pure}}} $$\n面积平均感热通量 $H_{\\mathrm{eff}}$ 是冰面和水面通量的加权平均值：\n$$ H_{\\mathrm{eff}} = (1 - f_\\ell)H_i + f_\\ell H_w $$\n使用总体公式 $H = \\rho c_p C_H U(z) (T_s - T_a)$，其中 $C_H$ 是总体感热输送系数，我们有：\n$$ H_{\\mathrm{eff}} = \\rho c_p U(z) \\left[ (1 - f_\\ell)C_{H,i}(T_{s,i} - T_a) + f_\\ell C_{H,w}(T_{s,w} - T_a) \\right] $$\n参考通量 $H_{i, \\text{pure}}$ 是 100% 冰面上的通量：\n$$ H_{i, \\text{pure}} = \\rho c_p C_{H,i} U(z) (T_{s,i} - T_a) $$\n将 $H_{\\mathrm{eff}}$ 除以 $H_{i, \\text{pure}}$ 得到 $E$ 的表达式：\n$$ E = (1 - f_\\ell) + f_\\ell \\frac{C_{H,w}}{C_{H,i}} \\frac{(T_{s,w} - T_a)}{(T_{s,i} - T_a)} $$\n\n要计算 $E$，我们需要热输送系数 $C_{H,i}$ 和 $C_{H,w}$。它们由以下公式给出：\n$$ C_H = \\frac{\\kappa^2}{\\ln\\left(\\frac{z}{z_{0m}}\\right)\\,\\ln\\left(\\frac{z}{z_{0t}}\\right)} $$\n其中 $z_{0t}$ 是热力粗糙度长度，与动量粗糙度长度通过 $z_{0t} = r_t z_{0m}$ 相关联，其中 $r_t=0.1$。\n\n**2.a. 冰面上的热输送系数 ($C_{H,i}$)**\n已知 $z_{0m,i}$，我们求得 $z_{0t,i} = r_t z_{0m,i}$，然后直接根据其公式计算 $C_{H,i}$。\n\n**2.b. 水面上的热输送系数 ($C_{H,w}$)**\n使用第 1.b 部分得到的收敛的 $u_{*,w}$ 和 $z_{0m,w}$ 值，我们求得 $z_{0t,w} = r_t z_{0m,w}$，然后计算 $C_{H,w}$。\n\n定义了所有系数后，就可以对任何给定的 $f_\\ell$ 计算出 $E$。这样就完成了所需的推导。上面概述的计算步骤将被执行以评估测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs a parameterization for subgrid sea-ice leads to find the\n    effective momentum roughness length and sensible heat flux enhancement.\n    \"\"\"\n    # --- Given Parameters ---\n    z = 10.0  # Reference height (m)\n    rho = 1.3  # Air density (kg/m^3)\n    c_p = 1004.0  # Specific heat of air (J/kg/K)\n    kappa = 0.4  # Von Kármán constant (-)\n    g = 9.81  # Gravitational acceleration (m/s^2)\n    nu_a = 1.5e-5  # Kinematic viscosity of air (m^2/s)\n    alpha = 0.014  # Charnock coefficient (-)\n    beta = 0.11  # Viscous correction coefficient (-)\n    U_z = 8.0  # Wind speed at reference height (m/s)\n    T_a = -25.0  # Air temperature (°C)\n    T_si = -20.0  # Sea-ice surface temperature (°C)\n    T_sw = -1.8  # Lead (water) surface temperature (°C)\n    z0m_i = 0.003  # Sea-ice momentum roughness length (m)\n    r_t = 0.1  # Ratio z_0t / z_0m (-)\n\n    # --- Test Cases ---\n    test_cases_fl = [0.0, 0.01, 0.05, 0.3, 1.0]\n\n    # --- Part 1: Ice Surface Properties (Constant) ---\n    ln_z_z0m_i = np.log(z / z0m_i)\n    C_D_i = (kappa / ln_z_z0m_i)**2\n    \n    z0t_i = r_t * z0m_i\n    ln_z_z0t_i = np.log(z / z0t_i)\n    C_H_i = kappa**2 / (ln_z_z0m_i * ln_z_z0t_i)\n    \n    delta_T_i = T_si - T_a\n    \n    # --- Part 2: Water Surface Properties (Iterative Solution) ---\n    # Initial guess for friction velocity over water, u_*,w\n    u_star_i = np.sqrt(C_D_i) * U_z\n    u_star_w = u_star_i \n\n    # Fixed-point iteration to find u_star_w and z_0m,w\n    for _ in range(15):  # Convergence is rapid\n        # Charnock relation to find z_0m,w from u_*,w\n        z0m_w_current = alpha * u_star_w**2 / g + beta * nu_a / u_star_w\n        # Update u_*,w using the log wind profile\n        u_star_w_new = kappa * U_z / np.log(z / z0m_w_current)\n        u_star_w = u_star_w_new\n\n    # Final converged properties for water surface\n    z0m_w = alpha * u_star_w**2 / g + beta * nu_a / u_star_w\n    C_D_w = (u_star_w / U_z)**2\n\n    z0t_w = r_t * z0m_w\n    ln_z_z0m_w = np.log(z / z0m_w)\n    ln_z_z0t_w = np.log(z / z0t_w)\n    C_H_w = kappa**2 / (ln_z_z0m_w * ln_z_z0t_w)\n    \n    delta_T_w = T_sw - T_a\n\n    # --- Part 3: Calculate Effective Properties for Each Test Case ---\n    results = []\n    for f_l in test_cases_fl:\n        # Calculate effective drag coefficient\n        C_D_eff = (1 - f_l) * C_D_i + f_l * C_D_w\n        \n        # Calculate effective momentum roughness length\n        sqrt_C_D_eff = np.sqrt(C_D_eff)\n        z0m_eff = z * np.exp(-kappa / sqrt_C_D_eff)\n        \n        # Calculate sensible heat flux enhancement factor\n        # This general formula correctly handles f_l=0 and f_l=1 cases.\n        E = (1 - f_l) + f_l * (C_H_w / C_H_i) * (delta_T_w / delta_T_i)\n        \n        results.append([round(z0m_eff, 8), round(E, 8)])\n\n    # --- Final Output Formatting ---\n    # Manually construct the string to match the required format `[[z0_1,E_1],[z0_2,E_2],...]`\n    # without spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}