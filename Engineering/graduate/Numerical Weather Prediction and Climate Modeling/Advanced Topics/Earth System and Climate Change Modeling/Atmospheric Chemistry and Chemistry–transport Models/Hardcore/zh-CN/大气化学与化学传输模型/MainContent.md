## 引言
大气化学与我们呼吸的空气、地球的气候以及生态系统的健康息息相关。为了理解和预测大气中数百种化学物质的时空分布及其复杂相互作用，科学家们开发了强大的计算工具——化学输送模型（Chemical Transport Model, CTM）。这些模型是连接排放源、大气过程与环境影响之间的桥梁，对于制定有效的空气质量管理政策和评估气候变化至关重要。然而，构建一个既能准确反映复杂[物理化学](@entry_id:145220)过程，又能在计算上可行的模型，是一项巨大的挑战。

本文旨在系统性地剖析[大气化学输送模型](@entry_id:1121184)的构建原理与前沿应用。我们将带领读者从基础出发，逐步深入这一复杂领域。在“原理与机制”一章中，我们将详细解读模型背后的核心控制方程，并深入探讨化学转化、源汇过程和输运等关键模块的物理机制与数值实现方法。接下来的“应用与交叉学科联系”一章将展示这些模型如何从理论走向实践，应用于空气质量预报、[气候变化反馈](@entry_id:190995)研究，甚至扩展到[行星科学](@entry_id:158926)等交叉学科领域。最后，在“动手实践”部分，我们提供了一系列精心设计的问题，帮助读者巩固理论知识，亲身体验模型构建中的核心挑战。

通过这三个章节的学习，您将建立起对[大气化学输送模型](@entry_id:1121184)的全面理解，不仅掌握其“如何工作”的内在机制，更能领会其“为何重要”的科学价值。让我们首先深入模型的核心，探索其构建所依赖的基本原理与机制。

## 原理与机制

化学输送模型（Chemical Transport Model, CTM）是理解和预测大气成分时空分布的核心工具。这些模型通过数值求解一套复杂的[偏微分](@entry_id:194612)方程来模拟大气中化学物质的演变。本章将深入探讨构建这些模型所依据的基本物理和化学原理，以及将这些原理转化为可计算形式的关键机制。我们将从控制方程出发，剖析其各个组成部分——包括化学转化、源汇过程以及输运——并最终探讨将这些过程耦合求解的数值策略。

### 支配方程：[平流-扩散-反应方程](@entry_id:156456)

任何CTM的核心都是质量守恒原理。对于大气中某种痕量物种（或称示踪物），其在任意[固定控制体](@entry_id:272149)积内的浓度变化，取决于通过该体积边界的通量以及体积内部的源和汇。这一原理可以数学化地表述为示踪剂[连续性方程](@entry_id:195013)。

假设 $c(\mathbf{x},t)$ 表示在位置 $\mathbf{x}$ 和时间 $t$ 的示踪剂浓度（单位体积的[物质的量](@entry_id:140225)）。其演变受到风场 $\mathbf{u}(\mathbf{x},t)$ 的输运（平流）、由涡动扩散系数 $K(\mathbf{x},t)$ 表征的湍流混合（扩散）、净化学反应生成率 $R(c)$ 以及外部源项（如排放）$S(\mathbf{x},t)$ 的共同影响。将质量守恒定律应用于一个固定的欧拉控制体积 $V$，便可导出该方程的局部微分形式，即**通量形式（flux-form）**或**[守恒形式](@entry_id:1122899)（conservative form）**：

$$
\frac{\partial c}{\partial t} + \nabla \cdot (c\mathbf{u}) = \nabla \cdot (K\nabla c) + R(c) + S
$$

这个方程的每一项都有明确的物理意义：
- $\frac{\partial c}{\partial t}$：浓度的[局部时](@entry_id:194383)间变化率。
- $\nabla \cdot (c\mathbf{u})$：由平均风场引起的平流通量的散度，代表物质进出该点的净速率。
- $\nabla \cdot (K\nabla c)$：由[湍流](@entry_id:151300)引起的扩散通量的散度。这里假设了Fick定律，即[扩散通量](@entry_id:748422)与浓度梯度成正比。
- $R(c)$：净[化学反应速率](@entry_id:147315)，即化学产物减去化学反应物。
- $S$：外部源项，如地表或高空排放。

通量形式之所以被称为“守恒形式”，是因为它直接源于积分守恒定律。对整个模型区域积分并应用散度定理，可以发现区域内示踪剂的总质量变化，完全由通过边界的通量和内部源汇决定。这一特性对于需要精确追踪物质收支的数值模型至关重要 。

通过对平流项应用向量微积分的[乘法法则](@entry_id:144424)，$\nabla \cdot (c\mathbf{u}) = \mathbf{u} \cdot \nabla c + c(\nabla \cdot \mathbf{u})$，我们可以将通量形式的方程转换为**平流形式（advective-form）**：

$$
\frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = -c(\nabla \cdot \mathbf{u}) + \nabla \cdot (K\nabla c) + R(c) + S
$$

这里，我们引入了**物质导数（material derivative）** $D c / D t \equiv \partial c / \partial t + \mathbf{u} \cdot \nabla c$，它代表了跟随流体微团移动时浓度的变化率。因此，方程可以写作：

$$
\frac{D c}{D t} = -c(\nabla \cdot \mathbf{u}) + \nabla \cdot (K\nabla c) + R(c) + S
$$

平流形式为我们提供了[拉格朗日视角](@entry_id:265471)，即一个流体微团内浓度的变化。值得注意的是，平流形式包含一个与风场散度 $\nabla \cdot \mathbf{u}$ 相关的项。在大气中，由于密度变化，流体是可压缩的，因此 $\nabla \cdot \mathbf{u} \neq 0$。这一项 $-c(\nabla \cdot \mathbf{u})$ 描述了由于流体微团体积的膨胀（$\nabla \cdot \mathbf{u} > 0$）或收缩（$\nabla \cdot \mathbf{u}  0$）导致的浓度变化。只有在[不可压缩流](@entry_id:140301)（$\nabla \cdot \mathbf{u} = 0$）的理想情况下，这一项才会消失，通量形式和平流形式才变得更加相似 。

在CTM中，选择哪种形式取决于数值方法的设计。守恒的[有限体积法](@entry_id:141374)通常建立在[通量形式](@entry_id:273811)之上，而半拉格朗日等方法则更自然地与平流形式相关。此外，方程中的变量 $c$ 是体积浓度。如果使用质量混合比（单位质量空气中示踪剂的质量）作为变量，那么控制方程的形式会因引入空气密度 $\rho$ 而改变，必须与空气质量的连续性方程耦合求解，这一点在模型开发中需特别注意。

### 方程的组成部分

为了求解上述控制方程，我们必须对其中的每一项——化学、源、汇和输运——进行精确的物理和数学描述。

#### 化学转化：模型的核心

化学转化项 $R(c)$ 是CTM中最复杂的部分，它描述了大气中数百种化学物质之间通过数千个化学反应发生的相互作用。

##### 基本反应动力学

[大气化学](@entry_id:198364)机制通常由一系列**[基元反应](@entry_id:177550)（elementary reactions）**构成。根据**[质量作用定律](@entry_id:916274)（law of mass action）**，基元反应的速率与反应物浓度的乘积成正比。反应的**分子数（molecularity）**决定了速率定律的形式 ：

- **[单分子反应](@entry_id:167301)（Unimolecular）**：如[光解](@entry_id:164141)或热分解反应 $\mathrm{A} \rightarrow \text{产物}$。其速率为[一级反应](@entry_id:136907)，形式为 $R = k[\mathrm{A}]$，[速率常数](@entry_id:140362) $k$ 的单位是 $\mathrm{s}^{-1}$。例如，平流层中氯硝酸盐的[热分解](@entry_id:202824) $\mathrm{ClONO}_2 \rightarrow \mathrm{ClO} + \mathrm{NO}_2$。

- **[双分子反应](@entry_id:165027)（Bimolecular）**：两个[分子碰撞](@entry_id:137334)并反应，如 $\mathrm{A} + \mathrm{B} \rightarrow \text{产物}$。其速率为[二级反应](@entry_id:139599)，形式为 $R = k[\mathrm{A}][\mathrm{B}]$，[速率常数](@entry_id:140362) $k$ 的单位通常是 $\mathrm{cm}^3\,\mathrm{molecule}^{-1}\,\mathrm{s}^{-1}$。一个经典的例子是催化臭氧消耗的反应 $\mathrm{NO} + \mathrm{O}_3 \rightarrow \mathrm{NO}_2 + \mathrm{O}_2$。

- **[三分子反应](@entry_id:198929)（Termolecular）**：三个分子同时碰撞，通常是一个结合反应，其中第三体 $\mathrm{M}$（通常是 $\mathrm{N}_2$ 或 $\mathrm{O}_2$）通过带走多余的能量来稳定新生成的分子，如 $\mathrm{A} + \mathrm{B} + \mathrm{M} \rightarrow \mathrm{AB} + \mathrm{M}$。其速率为三级反应，形式为 $R = k[\mathrm{A}][\mathrm{B}][\mathrm{M}]$，[速率常数](@entry_id:140362) $k$ 的单位是 $\mathrm{cm}^6\,\mathrm{molecule}^{-2}\,\mathrm{s}^{-1}$。臭氧的[生成反应](@entry_id:147837) $\mathrm{O} + \mathrm{O}_2 + \mathrm{M} \rightarrow \mathrm{O}_3 + \mathrm{M}$ 就是一个典型的例子。尽管第[三体](@entry_id:265960) $\mathrm{M}$ 在化学计量上没有净变化，但它在动力学上是必不可少的，必须出现在速率定律中。

[速率常数](@entry_id:140362) $k$ 本身不是一个真正的“常数”，它强烈依赖于温度 $T$。这种依赖性通常由**阿累尼乌斯方程（Arrhenius equation）**描述：

$$
k(T) = A \exp\left(-\frac{E_a}{R_g T}\right)
$$

其中 $A$ 是[指前因子](@entry_id:145277)， $E_a$ 是活化能， $R_g$ 是[普适气体常数](@entry_id:136843)。活化能 $E_a$ 代表了反应发生的能量壁垒。大多数反应的 $E_a > 0$，意味着温度升高，[反应速率](@entry_id:185114)加快。然而，某些大气反应（特别是无障碍的[自由基](@entry_id:188302)-[自由基反应](@entry_id:169919)）表现出负的活化能（$E_a  0$），这意味着随着温度升高，[反应速率](@entry_id:185114)反而会减慢 。

##### [光解作用](@entry_id:164141)

除了热反应，**[光解](@entry_id:164141)（photolysis）**是驱动大气化学的关键过程，尤其是在对流层和平流层的光化学中。[光解](@entry_id:164141)反应中，一个分子吸收一个光子后分解。其速率由一级反应[速率常数](@entry_id:140362) $J$（单位 $\mathrm{s}^{-1}$）描述，通常称为**光解[速率系数](@entry_id:183300)**或**J值（J-value）**。$J$ 值不是一个[基本常数](@entry_id:148774)，而是由环境[辐射场](@entry_id:164265)和分子的光谱特性共同决定的积分量 ：

$$
J = \int_{\lambda} \sigma(\lambda, T) \phi(\lambda, T) I(\lambda, z) \, d\lambda
$$

这个积分包含了三个关键部分：
1.  **吸收截面 $\sigma(\lambda, T)$**：分子在波长 $\lambda$ 和温度 $T$ 下吸收光子的能力，单位是面积（如 $\mathrm{cm}^2\,\mathrm{molecule}^{-1}$）。
2.  **[量子产率](@entry_id:148822) $\phi(\lambda, T)$**：分子吸收一个光子后发生特定分[解路径](@entry_id:755046)的概率，是无量纲的。
3.  **光化通量 $I(\lambda, z)$**：在高度 $z$ 和波长 $\lambda$ 处，来自所有方向的可用[光子通量](@entry_id:164816)，单位通常是 $\mathrm{photons}\,\mathrm{cm}^{-2}\,\mathrm{s}^{-1}\,\mathrm{nm}^{-1}$。

理解**光化通量（actinic flux）**与**辐照度（irradiance）**的区别至关重要。辐[照度](@entry_id:166905) $F$ 是通过一个水平单位面积的辐射能量或[光子通量](@entry_id:164816)，它通过对[辐射强度](@entry_id:150179) $L$ 按方向的余弦加权积分得到（$F = \int L \cos\theta \, d\Omega$）。而光化通量 $I$ 是对所有方向的[辐射强度](@entry_id:150179)进行无加权积分（$I = \int L \, d\Omega$），因为它代表了在一个点上从各个方向射来的总光子数，而分子吸收光子是各向同性的。因此，对于驱动化学反应而言，光化通量是更相关的物理量。例如，在一个仅有平行直射光的纯吸收大气中，光化通量 $I$ 大于向下辐照度 $F_\downarrow$（具体关系为 $I = F_\downarrow / \cos\theta_0$，其中 $\theta_0$ 是[太阳天顶角](@entry_id:1131912)）。CTM必须包含一个辐射传输模块，用于计算随高度和波长变化的光化通量场，以便准确计算J值。

##### 化学机制简化

完整的大气化学机制可能包含数千个反应和数百个物种，这对于三维全球模型来说计算成本过高。因此，**机制简化（mechanism reduction）**或**集总（lumping）**是必要的。集总是一种将具有相似化学性质的多种有机物（如不同种类的[烷烃](@entry_id:185193)或[烯烃](@entry_id:183502)）合并为一个或几个代理物种的策略。这个集总物种的反应速率常数和产物产率是其所代表的各物种的[加权平均值](@entry_id:894528)，权重通常基于它们在大气中的典型浓度或反应性来确定 。

例如，可以将两种挥发性有机物（VOC） $V_1$ 和 $V_2$ 集总成一个物种 $V_L = V_1 + V_2$。其有效的OH[反应速率常数](@entry_id:187887) $k_L$ 和HO$_2$[产率](@entry_id:141402) $y_L$ 可以根据一个参考混合物 $([V_1]_{\mathrm{ref}}, [V_2]_{\mathrm{ref}})$ 来定义，以确保在参考条件下，集总物种的总反应性和产物生成率与显式机制相匹配：

$$
k_L = \frac{k_1 [V_1]_{\mathrm{ref}} + k_2 [V_2]_{\mathrm{ref}}}{[V_1]_{\mathrm{ref}} + [V_2]_{\mathrm{ref}}}, \quad
y_L = \frac{y_1 k_1 [V_1]_{\mathrm{ref}} + y_2 k_2 [V_2]_{\mathrm{ref}}}{k_1 [V_1]_{\mathrm{ref}} + [V_2]_{\mathrm{ref}}}
$$

这种方法的优点是显著减少了需要求解的物种数量。然而，它也引入了误差。当实际大气中的VOC[混合比](@entry_id:1127970)例偏离用于定义[集总参数](@entry_id:274932)的参考混合物时，集总机制预测的化学转化率（如臭氧生成率）可能会与显式机制产生显著偏差 。评估和限制这种结构性误差是化学机制发展的核心挑战之一。

#### [源与汇](@entry_id:263105)：与地球系统的相互作用

大气成分的浓度不仅受内部化学转化的影响，还受到与地球表面的交换以及来自人为和自然源的直接注入的强烈控制。

##### 排放源

排放是大气示踪剂的主要来源，在CTM中体现为源项 $S$。排放清单通常将排放源分为三类 ：
- **面源（Area sources）**：在广阔区域内分布的源，如城市交通、农业活动或生物排放。在模型中，这些排放被分配到最底层的网格单元中，作为地表通量。
- **[点源](@entry_id:196698)（Point sources）**：集中的大型排放源，如发电厂或工厂的烟囱。这些排放物通常被注入到模型中较高的大气层，以模拟烟羽的抬升。
- **体源（Volume sources）**：在三维空间中分布的源，如飞机或闪电产生的排放。

排放清单提供的数据（如每年或每小时的总排放量）必须经过仔细处理，才能转化为模型所需的单位（如 $\mathrm{kg}\,\mathrm{m}^{-3}\,\mathrm{s}^{-1}$）。这个过程包括将总排放率分配到特定的网格单元，并根据时间剖面（如月、周、日的循环）将其分配到具体的模型时间步。例如，一个面源排放清单给出的日总排放量 $E_{\mathrm{area,day}}$（单位 $\mathrm{tonnes}\,\mathrm{day}^{-1}$）需要先转化为秒平均排放率，然后乘以相应的时间分配因子，再除以网格单元面积 $A_{\mathrm{cell}}$ 得到地表通量 $F_{\mathrm{emit}}$，最后除以底层模型层厚度 $h_1$ 得到体积源项 $S_{\mathrm{area}} = F_{\mathrm{emit}} / h_1$ 。

##### 干沉降

**干沉降（Dry deposition）**是气态物质和气溶胶从大气中去除的一个重要汇过程，它通过与地表（植被、土壤、水体等）的[湍流](@entry_id:151300)输送和吸收发生。这个过程通常通过**沉降速度（deposition velocity）** $v_d$ 来[参数化](@entry_id:265163)，其向下通量 $F_d$ 与参考高度处的浓度 $c$ 成正比：

$$
F_d = -v_d c
$$

这里的负号表示这是一个从大气到地表的汇（向下通量）。[沉降速度](@entry_id:1123566) $v_d$ 不是一个常数，而是由一系列阻碍物质从大气传输到最终吸收位置的“电阻”决定的。**电阻串联模型（resistance-in-series model）**是一个广泛使用的框架，它将总电阻视为三个主要部分之和 ：

$$
v_d = \frac{1}{R_{\text{total}}} = \frac{1}{R_a + R_b + R_c}
$$

这三个电阻分别代表了传输过程中的不同阶段：
1.  **空气动力学阻力 $R_a$**：描述了物质从大气中的某个参考高度通过[湍流](@entry_id:151300)输送到植被冠层顶部的效率。它与风速和大气稳定度有关，通常通过微[气象学](@entry_id:264031)理论（如Monin-Obukhov[相似理论](@entry_id:262184)）计算。
2.  **准[层流边界层](@entry_id:153016)阻力 $R_b$**：描述了物质穿过紧贴在叶片、树枝或地表等表面的薄层空气（准层流附面层）的效率。在这个薄层中，[湍流](@entry_id:151300)被抑制，[分子扩散](@entry_id:154595)成为主要的输送机制。
3.  **冠层/地表阻力 $R_c$**：代表了物质被地表本身吸收的效率。它不是一个输送阻力，而是一个吸收或反应阻力。对于植被，它通常包括通过气孔吸收的路径（[气孔阻力](@entry_id:1132453) $R_s$）、通过[角质层](@entry_id:917456)吸收的路径以及被土壤吸收的路径等。这些不同的吸收路径是并联的，因此它们的电导（电阻的倒数）可以相加。

这个电阻模型清晰地描绘了干沉降过程的物理图像：[湍流](@entry_id:151300)将物质带到地表附近，分子扩散使其接触表面，最后表面的物理、化学或[生物过程](@entry_id:164026)将其吸收。

##### 边界条件

排放和沉降这两个过程共同构成了CTM在近地表的**下边界条件**。在模型的最底层，向上的湍流扩散通量必须与地表的净通量相平衡。地表的净通量是向上的排放通量 $F_{\mathrm{emit}}$ 和向下的沉降通量 $F_{\mathrm{dep}} = -v_d c$ 的总和。因此，在 $z=0$ 处的边界条件可以写成 ：

$$
-K \frac{\partial c}{\partial z} \bigg|_{z=0} = F_{\mathrm{emit}}(t) - v_d c\big|_{z=0}
$$

这个Robin类型的[混合边界条件](@entry_id:176456)将模型的内部状态（近地表浓度 $c$ 及其梯度）与外部的源汇过程联系起来。

### 数值求解：构建模型

将上述所有物理和化学过程整合在一起，并通过数值方法求解，是CTM的核心挑战。由于不同过程的时间尺度和数学性质差异巨大（例如，平流是双曲型的，而化学反应通常是刚性的），直接求[解耦](@entry_id:160890)合的完整方程是不可行的。

#### [算子分裂](@entry_id:634210)：分而治之的策略

**算子分裂（Operator splitting）**是一种“分而治之”的策略，它将复杂的演化方程 $\partial_t y = (A + C)y$ （这里 $A$ 代表输运， $C$ 代表化学）分解为一系列更简单的子问题，然后依次求解。例如，可以先只考虑输运求解一步，再在输运后的场上只考虑化学求解一步 。

这种方法的数学基础源于矩阵指数的近似。完整演化一步的精确解算子是 $e^{\Delta t(A+C)}$。[算子分裂](@entry_id:634210)用子过程算子的乘积来近似它。最常见的两种分裂方法是：
- **Godunov或Lie-Trotter分裂（一阶）**：这是最简单的分裂方法，它采用非对称的顺序，如先输运后化学：$\Phi_{LT}(\Delta t) = e^{\Delta t A} e^{\Delta t C}$。这种方法的[局部截断误差](@entry_id:147703)为一阶，即 $\mathcal{O}(\Delta t^2)$，并且误差的[主导项](@entry_id:167418)与输运和化学算子的**[交换子](@entry_id:158878)** $[A,C] = AC - CA$ 成正比。只有当 $A$ 和 $C$ 可交换时（即 $[A,C]=0$），这种分裂才是精确的。
- **[Strang分裂](@entry_id:755497)（二阶）**：这种方法采用对称的顺序，如 $e^{\frac{\Delta t}{2} A} e^{\Delta t C} e^{\frac{\Delta t}{2} A}$。通过这种对称组合，一阶误差项（即与 $[A,C]$ 相关的项）被抵消，使得局部截断误差提高到二阶，即 $\mathcal{O}(\Delta t^3)$。这通常能以稍高的计算成本换来更高的精度。

在CTM中，通常采用Strang分裂，因为它在处理[非交换](@entry_id:136599)过程时提供了更高的准确性 。

#### 求解子问题

分裂之后，模型需要为每个子过程配备高效、准确的数值求解器。

##### 输运求解

输运子问题 $\partial_t y + \nabla \cdot (\mathbf{u}y) = 0$ 是一个[双曲守恒律](@entry_id:147752)方程。数值求解面临着在保证质量守恒、[计算效率](@entry_id:270255)和避免非物理振荡（保持单调性）之间的权衡 。两种主流方法是：
- **通量形式[有限体积法](@entry_id:141374)（Flux-form Finite-Volume, FV）**：该方法建立在控制方程的[通量形式](@entry_id:273811)之上，通过计算每个网格单元边界的通量来更新单元内的平均浓度。这种方法的优点是**内禀[质量守恒](@entry_id:204015)**。然而，简单的高阶格式（如二阶中心差）会在梯度大的地方产生非物理的过冲和下冲（振荡）。为了保持[单调性](@entry_id:143760)（即不产生新的[极值](@entry_id:145933)），必须使用**通量限制器（flux limiters）**，这使得算法变得[非线性](@entry_id:637147)且更复杂。简单的一阶迎风格式是单调的，但其固有的**[数值扩散](@entry_id:136300)**会严重平滑浓度场。
- **半拉格朗日法（Semi-Lagrangian, SL）**：该方法建立在控制方程的平流形式之上。它通过将每个网格点在时间上向后追溯一个时间步，找到其“出发点”，然后通过插值得到出发点的浓度值作为当前网格点的新值。SL方法的巨大优势是其**[无条件稳定](@entry_id:146281)**，即时间步长不受风速限制（不受CFL条件约束），允许使用比FV方法大得多的时间步。然而，标准的点值SL方法并**不保证[质量守恒](@entry_id:204015)**，因为插值过程不遵守积分守恒。此外，为了达到高精度，需要使用高阶插值，而高阶插值通常是非单调的。为了解决[质量守恒](@entry_id:204015)问题，发展出了更复杂的**守恒半拉格朗日（Conservative Semi-Lagrangian, CISL）**方案，它们通过输送单元格内的质量而非点值来强制守恒 。

##### 化学求解

化学子问题是在每个网格单元内求解一个常微分方程（ODE）系统：$d\mathbf{y}/dt = \mathbf{f}(\mathbf{y})$，其中 $\mathbf{y}$ 是该单元内所有物种的浓度向量，$\mathbf{f}(\mathbf{y})$ 是化学净生成速率。大气化学的一个决定性特征是其**刚性（stiffness）**：不同物种的化学寿命（[特征时间尺度](@entry_id:276738)）可能相差数十个数量级，从纳秒到数年。显式ODE求解器（如向前欧拉法）为了保持稳定，其时间步长必须由最快的反应（最小的寿命）决定，这使得计算成本高到无法接受。

因此，必须使用为刚性系统设计的**隐式ODE求解器**。这些求解器通过求解一个包含未来时刻状态的[代数方程](@entry_id:272665)来推进时间步，从而获得优越的稳定性。求解这个[代数方程](@entry_id:272665)通常需要**[化学雅可比矩阵](@entry_id:1122341)（chemistry Jacobian）** $\mathbf{J}$，其元素定义为 $J_{ij} = \partial f_i / \partial y_j$，表示物种 $i$ 的净生成速率对物种 $j$ 浓度的敏感性 。

[雅可比矩阵](@entry_id:178326)的结构反映了化学反应网络的拓扑结构。由于大多数反应只涉及少数几个物种，[雅可比矩阵](@entry_id:178326)是**稀疏**的——即大部分元素为零。然而，在快速相互转化的“化学族”（如HOx族：OH, HO$_2$；NOy族：NO, NO$_2$等）内部，物种之间存在密集的耦合，这会在[雅可比矩阵](@entry_id:178326)中形成密集的子块 。对于整个C[TM模](@entry_id:266144)型，由于每个网格的[化学计算](@entry_id:155220)是独立的（在算子分裂框架下），全局[化学雅可比矩阵](@entry_id:1122341)呈现出**块对角**结构，每个对角块对应一个网格单元的[雅可比矩阵](@entry_id:178326)。

两种在CTM中广泛使用的[刚性求解器](@entry_id:175343)家族是 ：
- **Gear方法（或[后向差分公式](@entry_id:175714)，BDF）**：这是一个[多步法](@entry_id:147097)，它通过一个包含过去多个时间步解的公式来近似当前时间步的导数，从而构造一个关于当前未知解 $y_{n+1}$ 的**非线性方程** $R(y_{n+1})=0$。这个[非线性方程](@entry_id:145852)通常使用**[牛顿法](@entry_id:140116)**迭代求解。每次牛顿迭代都需要求解一个[线性系统](@entry_id:147850)，其[系数矩阵](@entry_id:151473)为 $(I - h\beta\mathbf{J})$，其中 $\mathbf{J}$ 在迭代过程中可能需要更新。
- **Rosenbrock方法**：这是一个[单步法](@entry_id:164989)，可以看作是[隐式龙格-库塔方法](@entry_id:165104)的一种线性化形式。它通过一系列“阶段”来构造解，每个阶段都只涉及求解一个**线性方程系统**，其系数矩阵也是 $(I - h\gamma\mathbf{J})$ 的形式。与BDF不同，Rosenbrock方法避免了[求解非线性方程](@entry_id:177343)的内循环。通过精心[选择系数](@entry_id:155033)，可以使得所有阶段都使用同一个[雅可比矩阵](@entry_id:178326) $\mathbf{J}(y_n)$，从而只需进行一次矩阵[LU分解](@entry_id:144767)，大大提高了[计算效率](@entry_id:270255)。

总的来说，[BDF方法](@entry_id:176038)是“完全隐式”的，需要迭代[求解非线性系统](@entry_id:163616)；而Rosenbrock方法是“线性隐式”的，将问题转化为一系列[线性系统](@entry_id:147850)直接求解。两者都是处理[大气化学](@entry_id:198364)刚性问题的有效工具，其选择取决于具体的精度、稳定性和计算成本要求。