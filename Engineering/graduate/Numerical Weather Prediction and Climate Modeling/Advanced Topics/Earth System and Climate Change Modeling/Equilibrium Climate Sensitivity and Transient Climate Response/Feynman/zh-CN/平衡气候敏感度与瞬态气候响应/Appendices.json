{
    "hands_on_practices": [
        {
            "introduction": "要理解地球气候系统如何响应外部强迫，最基本的方法就是考察其能量平衡。这个练习将引导你从大气层顶的能量守恒出发，推导出平衡气候敏感度（ECS）的核心定义。通过这个练习，你将把ECS这个看似抽象的概念，与辐射强迫 $F_{2x}$ 和气候反馈参数 $\\lambda$ 这两个物理量直接联系起来。",
            "id": "4039740",
            "problem": "考虑一个由大气层顶 (TOA) 的能量守恒定律所支配的、全球平均的、零维的地球气候系统能量平衡模型。设由大气中二氧化碳 (CO$_2$) 浓度瞬时加倍引起的外部辐射强迫为一个常数 $F_{2x}$，并设系统的总气候反馈参数为 $\\lambda$，其定义为相对于参考气候，全球平均地表温度异常 $\\Delta T$ 每增加一个单位，大气层顶 (TOA) 的辐射损失增量。在平衡状态下，大气层顶的净辐射不平衡必须为零。\n\n从这些基本原理出发，仅使用能量守恒所蕴含的平衡条件，推导平衡态气候敏感度 (ECS) 的解析表达式。ECS 定义为响应阶跃强迫 $F_{2x}$ 时的平衡态全球平均地表温度变化 $\\Delta T_{\\mathrm{eq}}$，表达式需用 $F_{2x}$ 和 $\\lambda$ 表示。得到此表达式后，通过量纲分析验证其单位为温度。然后，使用 $F_{2x} = 3.7\\,\\mathrm{W\\,m^{-2}}$ 和 $\\lambda = 1.0\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，计算 ECS 的数值。将最终数值答案四舍五入至三位有效数字，并以开尔文为单位表示。",
            "solution": "问题陈述经评估有效。其科学基础是应用于气候科学的能量守恒原理，问题设定良好，提供了所有必要信息，并以客观、精确的语言表述。\n\n解答按要求分三部分进行：推导平衡态气候敏感度 (ECS) 的解析表达式，对表达式进行量纲分析，以及计算其数值。\n\n首先，我们建立零维能量平衡模型的控制方程。大气层顶 (TOA) 的净辐射不平衡（记为 $N$）是地球系统吸收的能量与辐射出去的能量之差。响应于一个扰动，这个不平衡可以表示为外部强迫和系统辐射响应之和。\n\n问题指定了一个由于大气 $\\text{CO}_2$ 浓度加倍而产生的外部辐射强迫 $F_{2x}$。这个强迫作用是增加系统中的能量。系统通过增加其出射长波辐射来响应由此产生的全球平均地表温度升高 $\\Delta T$。气候反馈参数 $\\lambda$ 量化了这一响应。它被定义为 $\\Delta T$ 每增加一个单位，大气层顶的辐射损失增量。因此，辐射响应（即反馈）是系统能量的损失，由项 $\\lambda \\Delta T$ 给出。\n\n大气层顶净辐射不平衡的方程为：\n$$N = F_{2x} - \\lambda \\Delta T$$\n在这里，$F_{2x}$ 是能量增益（正值），而 $\\lambda \\Delta T$ 是抵消强迫的能量损失（负号）。\n\n平衡态气候敏感度，记为 $\\Delta T_{\\mathrm{eq}}$，定义为在施加了强迫 $F_{2x}$ 后，系统达到新的平衡态时的全球平均地表温度变化。在平衡状态下，大气层顶的净辐射不平衡必须为零，即 $N=0$。在平衡条件下，将能量平衡方程中的 $\\Delta T$ 替换为 $\\Delta T_{\\mathrm{eq}}$，可得：\n$$0 = F_{2x} - \\lambda \\Delta T_{\\mathrm{eq}}$$\n我们现在可以求解 $\\Delta T_{\\mathrm{eq}}$ 以推导 ECS 的解析表达式：\n$$\\lambda \\Delta T_{\\mathrm{eq}} = F_{2x}$$\n$$\\Delta T_{\\mathrm{eq}} = \\frac{F_{2x}}{\\lambda}$$\n这就是以辐射强迫 $F_{2x}$ 和气候反馈参数 $\\lambda$ 表示的平衡态气候敏感度的解析表达式。\n\n其次，我们进行量纲分析，以验证推导出的表达式具有温度的单位。令 $[X]$ 表示量 $X$ 的物理单位。问题中给出的单位是：\n- 辐射强迫，$[F_{2x}] = \\mathrm{W}\\,\\mathrm{m}^{-2}$（瓦特每平方米）。\n- 气候反馈参数，$[\\lambda] = \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$（瓦特每平方米每开尔文）。\n\n因此，$\\Delta T_{\\mathrm{eq}}$ 的单位是：\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{[F_{2x}]}{[\\lambda]} = \\frac{\\mathrm{W}\\,\\mathrm{m}^{-2}}{\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\n分子和分母中的 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 单位相互抵消，剩下：\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{1}{\\mathrm{K}^{-1}} = \\mathrm{K}$$\n量纲分析证实，ECS 的表达式正确地得出了温度单位（开尔文），这在物理上是一致的。\n\n第三，我们使用给定的数据计算 ECS 的数值：\n$F_{2x} = 3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$\n$\\lambda = 1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n\n将这些值代入推导出的表达式中：\n$$\\Delta T_{\\mathrm{eq}} = \\frac{3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}}{1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\n$$\\Delta T_{\\mathrm{eq}} = 3.7\\,\\mathrm{K}$$\n问题要求将最终数值答案四舍五入至三位有效数字。因此，我们将结果表示为 $3.70$。",
            "answer": "$$\\boxed{3.70}$$"
        },
        {
            "introduction": "在现实世界中，气候系统并非瞬间达到平衡，海洋的巨大热惯性起着关键的延缓作用。这个练习在前一个模型的基础上引入了行星热量吸收项，以区分瞬态气候响应（TCR）和平衡气候敏感度（ECS）。通过这个练习，你将量化海洋热吸收如何影响地表变暖的速率，并理解为何在二氧化碳加倍的瞬间，我们观测到的升温（TCR）会小于最终的平衡升温（ECS）。",
            "id": "4039765",
            "problem": "考虑一个适用于气候建模的全球平均能量平衡框架，其中大气层顶（TOA）的净辐射不平衡表示为 $F(t) = \\lambda T(t) + N(t)$，其中 $F(t)$ 是外部施加的辐射强迫，$\\lambda$ 是气候反馈参数， $T(t)$ 是全球平均地表气温异常，而 $N(t)$ 是行星热量吸收。假设热量吸收 $N(t)$ 采用一个广泛使用的线性闭合关系 $N(t) = \\kappa T(t)$，其中 $\\kappa$ 代表有效海洋热吸收效率。将平衡气候敏感度（ECS）定义为，在因大气中二氧化碳（CO$_2$）瞬时加倍而产生的恒定强迫 $F_{2x}$ 作用下，达到平衡时的稳态温度变化。将瞬时气候响应（TCR）定义为，在二氧化碳（CO$_2$）以每年百分之一的复合增长率增加的情景下，当 $F(t)$ 达到 $F_{2x}$ 时，使用相同的大气层顶能量平衡和线性吸收闭合关系，在CO$_2$浓度加倍时刻计算出的全球平均温度变化。使用参数值 $F_{2x} = 3.7\\,\\mathrm{W\\,m^{-2}}$，$\\lambda = 1.0\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，以及 $\\kappa = 0.7\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，从所述的平衡关系中推导 ECS 和 TCR 的表达式，计算它们的数值，并解释它们之间的差异如何通过持续的行星热量吸收来量化热惯性。将报告的每个温度值四舍五入到三位有效数字，并以开尔文为单位表示。按 (ECS, TCR) 的顺序报告最终的数值答案。",
            "solution": "全球平均的大气层顶能量收支由 $F(t) = \\lambda T(t) + N(t)$ 给出，其中 $N(t)$ 是行星热量吸收。采用线性闭合关系 $N(t) = \\kappa T(t)$，该收支方程变为\n$$\nF(t) = \\lambda T(t) + \\kappa T(t) = \\left(\\lambda + \\kappa\\right) T(t).\n$$\n平衡气候敏感度（ECS）对应于施加恒定强迫 $F_{2x}$ 很长时间后达到的稳态，此时行星净热量吸收消失，即 $N = 0$。在平衡状态下，收支方程简化为\n$$\nF_{2x} = \\lambda \\cdot \\text{ECS},\n$$\n这意味着\n$$\n\\text{ECS} = \\frac{F_{2x}}{\\lambda}.\n$$\n瞬时气候响应（TCR）是在CO$_2$以每年百分之一复合增长率增加的情况下，在CO$_2$浓度加倍的瞬间定义的。在那个瞬间，强迫已达到 $F_{2x}$，但系统尚未平衡，因此 $N \\neq 0$。使用相同的大气层顶收支方程和线性闭合关系 $N = \\kappa T$，在加倍瞬间的瞬时平衡是\n$$\nF_{2x} = \\lambda \\cdot \\text{TCR} + \\kappa \\cdot \\text{TCR} = \\left(\\lambda + \\kappa\\right) \\text{TCR},\n$$\n这意味着\n$$\n\\text{TCR} = \\frac{F_{2x}}{\\lambda + \\kappa}.\n$$\n这些表达式突显了海洋热惯性的作用：对于固定的 $F_{2x}$ 和 $\\lambda$，较大的 $\\kappa$ 会相对于 $ECS$ 减小 $TCR$，因为更多的强迫被海洋以热量的形式吸收，从而延迟了地表变暖。\n\n现在代入给定的参数值 $F_{2x} = 3.7\\,\\mathrm{W\\,m^{-2}}$，$\\lambda = 1.0\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，以及 $\\kappa = 0.7\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n对于 $ECS$：\n$$\n\\text{ECS} = \\frac{3.7}{1.0} = 3.7 \\, \\text{K}.\n$$\n四舍五入到三位有效数字，结果是 $3.70$ K。\n\n对于 $TCR$：\n$$\n\\text{TCR} = \\frac{3.7}{1.0 + 0.7} = \\frac{3.7}{1.7} \\approx 2.176470588\\, \\text{K}.\n$$\n四舍五入到三位有效数字，结果是 $2.18$ K。\n\n为了将这一差异作为热惯性的量度进行定量解释，请注意，在加倍时刻未实现的增温是：\n$$\n\\Delta T_{\\text{inertia}} = \\text{ECS} - \\text{TCR} = \\frac{F_{2x}}{\\lambda} - \\frac{F_{2x}}{\\lambda + \\kappa} = F_{2x}\\,\\frac{\\kappa}{\\lambda\\left(\\lambda + \\kappa\\right)}.\n$$\n使用所提供的参数，其计算结果为：\n$$\n\\Delta T_{\\text{inertia}} = 3.7 \\times \\frac{0.7}{1.0 \\times 1.7} \\approx 1.523529412\\, \\text{K},\n$$\n这表明，与平衡状态相比，海洋的持续热量吸收使加倍时刻实现的增温减少了约 $1.52$ K。一个互补的无量纲度量是在加倍时刻实现的增温比例，\n$$\n\\frac{\\text{TCR}}{\\text{ECS}} = \\frac{\\lambda}{\\lambda + \\kappa},\n$$\n在此等于 $1.0 / 1.7 \\approx 0.588$，意味着在加倍时刻大约实现了平衡增温的 $0.59$，而剩余的 $0.41$ 则因与海洋热吸收相关的热惯性而被延迟。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.70 & 2.18 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理论模型为我们提供了清晰的框架，但在应用于观测数据时，分析方法的选择会显著影响最终结论。这项综合性编程练习将让你扮演气候科学家的角色，首先建立一个简化的气候模型来生成合成的“观测”数据。然后，你将亲手测试不同的分析策略——例如选择不同的基准期或如何处理火山爆发数据——如何影响你对气候反馈和ECS的估算结果。",
            "id": "4039728",
            "problem": "构建一个完整、可运行的程序，该程序需综合生成一个物理上一致的历史时间序列，然后量化方法论决策如何影响观测推断的气候反馈参数及由此隐含的平衡态气候敏感度（ECS）。您的程序必须仅从能量守恒和标准定义出发，实现以下内容，并为一个已定义的测试套件产生数值输出。\n\n基础和定义：\n- 使用行星能量平衡方程：在每个时间 $t$，行星热量吸收 $N(t)$ 满足 $N(t) = F(t) - \\lambda T(t)$，其中 $F(t)$ 是单位为 $\\mathrm{W\\,m^{-2}}$ 的净有效辐射强迫，$T(t)$ 是相对于基准线的全球平均地表温度异常（单位为 $\\mathrm{K}$），$\\lambda$ 是气候反馈参数（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）。\n- 在一个混合层热容量为 $C$（单位 $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$）的单箱能量平衡模型中，温度通过前向 Euler 更新以离散的年度时间步长 $\\Delta t = 1\\,\\mathrm{yr}$ 演变\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big),\n$$\n初始年份 $t_0$ 时，$T_{t_0} = 0$。\n- 在精确平衡状态下（无净热量吸收），$N = 0$，因此 $F = \\lambda T$。对于大气中二氧化碳加倍的情况，设辐射强迫为一个给定的常数 $F_{2\\times}$（单位 $\\mathrm{W\\,m^{-2}}$）。平衡态气候敏感度（ECS）是对 $F_{2\\times}$ 的平衡温度响应（单位 $\\mathrm{K}$）。\n\n综合数据规范：\n- 时间轴包含整数年份 $t \\in \\{1850,1851,\\dots,2020\\}$。\n- 将净有效辐射强迫 $F(t)$ 指定为三个分量的总和，所有分量的单位均为 $\\mathrm{W\\,m^{-2}}$：\n  1. 一个人为强迫斜坡 $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$，其中 $s_{\\mathrm{anth}} = 2.5 / 170$，使得 $F_{\\mathrm{anth}}(2020) = 2.5$。\n  2. 一个世纪中叶的气溶胶冷却异常 $F_{\\mathrm{aero}}(t) = -A \\exp\\!\\Big(-\\frac{(t-\\mu)^2}{2\\sigma^2}\\Big)$，其中 $A = 0.8$，$\\mu = 1960$，$\\sigma = 12$。\n  3. 火山强迫 $F_{\\mathrm{volc}}(t)$，由在年份 $t_i \\in \\{1883,1902,1963,1982,1991\\}$ 的负脉冲组成，其振幅为 $M_i \\in \\{-1.2,-1.0,-0.8,-1.0,-1.2\\}$，指数衰减时间尺度为 $\\tau_v = 1.5\\,\\mathrm{yr}$：\n  $$\n  F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp\\!\\Big(-\\frac{t-t_i}{\\tau_v}\\Big),\n  $$\n  其中 $\\mathbf{1}_{t \\ge t_i}$ 是指示函数。\n- 总强迫为 $F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$。\n- 选择真实的反馈参数 $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 和热容量 $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$。从 $t_0 = 1850$ 开始，使用上述离散更新来演变 $T(t)$，以获得无噪声的 $T_{\\mathrm{true}}(t)$。\n- 定义无噪声的行星热量吸收 $N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$。\n- 通过使用固定的随机种子抽取独立的零均值高斯扰动来添加观测噪声：温度噪声 $\\varepsilon_T \\sim \\mathcal{N}(0,\\sigma_T^2)$，其中 $\\sigma_T = 0.05\\,\\mathrm{K}$；热量吸收噪声 $\\varepsilon_N \\sim \\mathcal{N}(0,\\sigma_N^2)$，其中 $\\sigma_N = 0.10\\,\\mathrm{W\\,m^{-2}}$。设置固定种子等于 $42$。观测序列为 $T_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)$ 和 $N_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)$。在整个过程中，使用 $\\Delta t = 1\\,\\mathrm{yr}$。\n\n推断反馈和 ECS 的估计方法：\n- 构建单位为 $\\mathrm{W\\,m^{-2}}$ 的回归目标 $Y(t) = F(t) - N_{\\mathrm{obs}}(t)$。\n- 对于选定的基准期 $[b_0,b_1]$（含两端），计算基准期平均温度 $\\overline{T}_{\\mathrm{obs}} = \\frac{1}{n_b}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$，其中 $n_b$ 是该时期的年数。\n- 定义温度异常 $T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$。\n- 为模拟对高纬度区域的掩蔽效应，通过一个乘法因子 $s \\in (0,1]$ 对温度异常进行重新缩放，得到 $T_s(t) = s\\,T'(t)$。\n- 根据一个阈值 $\\tau$（单位 $\\mathrm{W\\,m^{-2}}$）排除火山年份，即移除所有满足 $\\lvert F_{\\mathrm{volc}}(t)\\rvert \\ge \\tau$ 的年份 $t$。使用所有剩余的年份 $t \\in \\{1850,\\dots,2020\\}$，对 $Y(t)$ 关于 $T_s(t)$ 进行过原点的线性回归，以获得一个估计值 $\\widehat{\\lambda}$，该值最小化 $\\sum_t \\big(Y(t) - \\widehat{\\lambda}\\,T_s(t)\\big)^2$。\n- 仅使用能量平衡的平衡条件，计算 CO$_2$ 加倍强迫 $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$ 所对应的 ECS，以 $\\mathrm{K}$ 为单位表示。\n\n单位和要求的输出：\n- 报告 $\\widehat{\\lambda}$（单位 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）和 ECS（单位 $\\mathrm{K}$）。在最终输出中，将两者都四舍五入到三位小数。\n- 您的程序必须打印单行内容，该行包含一个列表的列表，每个子列表对应一个测试用例，形式为 $[\\widehat{\\lambda}, \\mathrm{ECS}]$。打印的输出中不应出现单位，只应包含按规定四舍五入的数值。\n\n测试套件：\n对于以下每个参数四元组 $(b_0,b_1,\\tau,s)$，运行上述估计过程，并将 $[\\widehat{\\lambda}, \\mathrm{ECS}]$ 对附加到最终输出列表中。\n\n- 案例 A（理想路径，近前工业化基准，无掩蔽，排除大喷发）：$(1850,1869,0.8,1.0)$。\n- 案例 B（基准远离前工业化时期，包括所有火山年份）：$(1961,1990,10.0,1.0)$。\n- 案例 C（现代基准，严格的火山排除标准，显著的掩蔽）：$(1981,2010,0.3,0.85)$。\n- 案例 D（世纪中叶基准，中等火山排除标准，强掩蔽）：$(1931,1960,0.5,0.70)$。\n\n算法和数值要求：\n- 严格按照所述实现所有方程。不要使用任何外部数据。使用指定的随机种子以确保可复现性。\n- 在内部以指定的单位表示所有中间物理量。所有角度（如有）必须以弧度为单位，但本问题不涉及角度。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[[x_1,y_1],[x_2,y_2],\\dots]$，其中每个 $x_i$ 和 $y_i$ 是四舍五入到三位小数的浮点数。",
            "solution": "该问题要求构建一个程序，基于一个简单的能量平衡模型来综合生成一个合成的气候时间序列，然后从这些合成数据中估计气候反馈参数 $\\lambda$ 和平衡态气候敏感度（ECS）。任务的核心是量化分析中的不同方法论选择——具体而言，即基准期的选择、火山年份的排除标准以及为模拟空间掩蔽而对温度数据进行的缩放——如何影响 $\\lambda$ 和 ECS 的最终估计值。\n\n该解决方案分两个主要阶段实施：（1）生成合成的“真实值”和“观测”气候数据，以及（2）对每个测试用例应用指定的估计程序。\n\n**1. 合成数据生成**\n\n模型的基础是行星能量平衡，该平衡表明行星的热量吸收速率 $N(t)$ 是入射辐射强迫 $F(t)$ 与出射热辐射之间的差值，而出射热辐射被参数化为与全球平均地表温度异常 $T(t)$ 成正比。比例常数即为气候反馈参数 $\\lambda$。\n$$\nN(t) = F(t) - \\lambda T(t)\n$$\n所有量均在问题陈述中定义，$N$ 和 $F$ 的单位为 $\\mathrm{W\\,m^{-2}}$，$T$ 的单位为 $\\mathrm{K}$，$\\lambda$ 的单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n我们首先构建 $t \\in [1850, 2020]$ 年间的总辐射强迫 $F(t)$ 的时间序列。该强迫是三个不同分量的总和：\n- **人为强迫 $F_{\\mathrm{anth}}(t)$**：一个线性斜坡，代表温室气体影响的增长。其定义为 $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$，其中斜率 $s_{\\mathrm{anth}} = 2.5 / 170 \\,\\mathrm{W\\,m^{-2}\\,yr^{-1}}$ 确保强迫在 2020 年达到 $2.5\\,\\mathrm{W\\,m^{-2}}$。\n- **气溶胶强迫 $F_{\\mathrm{aero}}(t)$**：一个以 20 世纪中叶为中心的高斯形负强迫，代表工业气溶胶的冷却效应。其由 $F_{\\mathrm{aero}}(t) = -A \\exp(-\\frac{(t-\\mu)^2}{2\\sigma^2})$ 给出，振幅 $A=0.8\\,\\mathrm{W\\,m^{-2}}$，平均年份 $\\mu=1960$，标准差 $\\sigma=12\\,\\mathrm{yr}$。\n- **火山强迫 $F_{\\mathrm{volc}}(t)$**：一系列急剧的、指数衰减的负强迫脉冲，模拟主要火山喷发的影响。其公式为 $F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp(-\\frac{t-t_i}{\\tau_v})$，其中 $t_i$ 是喷发年份 $\\{1883, 1902, 1963, 1982, 1991\\}$，$M_i$ 是对应的振幅 $\\{-1.2, -1.0, -0.8, -1.0, -1.2\\}\\,\\mathrm{W\\,m^{-2}}$，$\\tau_v=1.5\\,\\mathrm{yr}$ 是衰减时间尺度。\n\n总强迫是三者之和：$F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$。\n\n接下来，我们通过对一个单箱能量平衡模型进行数值积分，生成“真实”的历史温度异常时间序列 $T_{\\mathrm{true}}(t)$。该模型的演变由一个年度时间步长 $\\Delta t = 1\\,\\mathrm{yr}$ 的前向 Euler 离散化描述：\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big)\n$$\n我们从初始条件 $T_{1850} = 0\\,\\mathrm{K}$ 开始，并使用给定的“真实”反馈参数 $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 和海洋混合层热容量 $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$。\n\n在 $F(t)$ 和 $T_{\\mathrm{true}}(t)$ 都确定后，从能量平衡方程计算“真实”的行星热量吸收 $N_{\\mathrm{true}}(t)$：$N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$。\n\n最后，为了模拟观测不确定性，我们向真实序列添加零均值高斯噪声。为了可复现性，我们使用固定的随机种子 42，生成噪声项 $\\varepsilon_T \\sim \\mathcal{N}(0, \\sigma_T^2)$（其中 $\\sigma_T=0.05\\,\\mathrm{K}$）和 $\\varepsilon_N \\sim \\mathcal{N}(0, \\sigma_N^2)$（其中 $\\sigma_N=0.10\\,\\mathrm{W\\,m^{-2}}$）。最终的“观测”时间序列是：\n$$\nT_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)\n$$\n$$\nN_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)\n$$\n\n**2. $\\lambda$ 和 ECS 的估计**\n\n第二阶段涉及根据每个测试用例不同的指定程序，从“观测”数据中推断反馈参数 $\\widehat{\\lambda}$ 和相应的 ECS。其基本原理是将能量平衡方程重排为适合线性回归的形式：$F(t) - N(t) = \\lambda T(t)$。\n\n对于由参数集 $(b_0, b_1, \\tau, s)$ 定义的每个测试用例：\n1.  构建回归目标变量：$Y(t) = F(t) - N_{\\mathrm{obs}}(t)$。从含噪声数据的角度来看，我们预期 $Y(t) \\approx \\lambda T_{\\mathrm{obs}}(t)$。\n2.  使用一个基准期 $[b_0, b_1]$ 来计算平均观测温度，$\\overline{T}_{\\mathrm{obs}} = \\frac{1}{b_1 - b_0 + 1}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$。\n3.  对于所有年份，将温度数据转换为相对于此基准的异常值：$T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$。\n4.  为模拟空间覆盖不完整（例如，掩蔽极地地区）的影响，将温度异常乘以一个因子 $s$ 进行缩放：$T_s(t) = s\\,T'(t)$。\n5.  从回归中排除与主要火山喷发对应的数据点。任何火山强迫大小 $|F_{\\mathrm{volc}}(t)|$ 大于或等于阈值 $\\tau$ 的年份 $t$ 都会从数据集中移除。\n6.  使用剩余的数据点，对 $Y(t)$ 关于 $T_s(t)$ 进行过原点的线性回归。估计的反馈参数 $\\widehat{\\lambda}$ 是回归线的斜率，它最小化了残差平方和 $\\sum_t (Y(t) - \\widehat{\\lambda}\\,T_s(t))^2$。其解析解为：\n    $$\n    \\widehat{\\lambda} = \\frac{\\sum_t Y(t) \\cdot T_s(t)}{\\sum_t T_s(t)^2}\n    $$\n    其中求和是对所有未被火山过滤器排除的年份进行的。\n7.  然后计算估计的平衡态气候敏感度（ECS）。ECS 是在持续强迫 $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$ 下的平衡温度变化。在平衡状态下，$N=0$，因此 $F_{2\\times} = \\widehat{\\lambda}\\,\\text{ECS}$。由此得出：\n    $$\n    \\mathrm{ECS} = \\frac{F_{2\\times}}{\\widehat{\\lambda}}\n    $$\n程序为所提供的四个测试用例中的每一个执行此完整过程，报告生成的 $[\\widehat{\\lambda}, \\mathrm{ECS}]$ 对，并四舍五入到三位小数。不同案例结果的变化将突显气候参数估计对常用方法论选择的敏感性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Synthesizes a climate time series and quantifies how methodological decisions \n    affect inferred climate feedback and ECS.\n    \"\"\"\n    \n    # --------------------------------------------------------------------------\n    # Foundational base and definitions\n    # --------------------------------------------------------------------------\n    lambda_true = 1.20  # W m^-2 K^-1\n    C = 8.0             # W yr m^-2 K^-1\n    F_2x = 3.71         # W m^-2\n    delta_t = 1.0       # yr\n    \n    # Time axis\n    t_start, t_end = 1850, 2020\n    t_years = np.arange(t_start, t_end + 1)\n    num_years = len(t_years)\n\n    # --------------------------------------------------------------------------\n    # Synthetic data specification\n    # --------------------------------------------------------------------------\n    \n    # Component 1: Anthropogenic forcing\n    s_anth = 2.5 / 170.0\n    F_anth = s_anth * (t_years - 1850)\n\n    # Component 2: Aerosol forcing\n    A, mu, sigma = 0.8, 1960.0, 12.0\n    F_aero = -A * np.exp(-((t_years - mu)**2) / (2 * sigma**2))\n\n    # Component 3: Volcanic forcing\n    t_volc_i = [1883, 1902, 1963, 1982, 1991]\n    M_i = [-1.2, -1.0, -0.8, -1.0, -1.2]\n    tau_v = 1.5  # yr\n    F_volc = np.zeros(num_years)\n    for t_erupt, M in zip(t_volc_i, M_i):\n        # Apply forcing from the eruption year onwards\n        indices = t_years >= t_erupt\n        time_since_eruption = t_years[indices] - t_erupt\n        F_volc[indices] += M * np.exp(-time_since_eruption / tau_v)\n\n    # Total forcing\n    F_total = F_anth + F_aero + F_volc\n    \n    # Evolve true temperature T_true(t)\n    T_true = np.zeros(num_years)\n    T_true[0] = 0.0 # T_1850 = 0\n    for i in range(num_years - 1):\n        T_true[i+1] = T_true[i] + (delta_t / C) * (F_total[i] - lambda_true * T_true[i])\n\n    # Calculate true heat uptake N_true(t)\n    N_true = F_total - lambda_true * T_true\n\n    # Add observational noise\n    seed = 42\n    rng = np.random.default_rng(seed)\n    sigma_T = 0.05  # K\n    sigma_N = 0.10  # W m^-2\n    eps_T = rng.normal(0, sigma_T, num_years)\n    eps_N = rng.normal(0, sigma_N, num_years)\n    \n    T_obs = T_true + eps_T\n    N_obs = N_true + eps_N\n    \n    # --------------------------------------------------------------------------\n    # Estimation method loop for test suite\n    # --------------------------------------------------------------------------\n    \n    test_cases = [\n        # (b0, b1, tau, s)\n        (1850, 1869, 0.8, 1.0),    # Case A\n        (1961, 1990, 10.0, 1.0),   # Case B\n        (1981, 2010, 0.3, 0.85),   # Case C\n        (1931, 1960, 0.5, 0.70)    # Case D\n    ]\n    \n    results = []\n    \n    # Form the regression target Y(t), which is common to all cases\n    Y = F_total - N_obs\n    \n    for b0, b1, tau, s in test_cases:\n        # Compute baseline mean temperature\n        baseline_mask = (t_years >= b0) & (t_years <= b1)\n        T_obs_mean = np.mean(T_obs[baseline_mask])\n        \n        # Define the anomaly and scale it\n        T_prime = T_obs - T_obs_mean\n        T_s = s * T_prime\n        \n        # Exclude volcanic years\n        regression_mask = np.abs(F_volc) < tau\n        \n        # Select data for regression\n        Y_reg = Y[regression_mask]\n        Ts_reg = T_s[regression_mask]\n        \n        # Perform linear regression through the origin\n        # lambda_hat = sum(x*y) / sum(x^2)\n        lambda_hat = np.sum(Y_reg * Ts_reg) / np.sum(Ts_reg**2)\n        \n        # Compute ECS\n        ecs_hat = F_2x / lambda_hat\n        \n        # Round and store results\n        results.append([round(lambda_hat, 3), round(ecs_hat, 3)])\n\n    # --------------------------------------------------------------------------\n    # Final output\n    # --------------------------------------------------------------------------\n    # Format the final list of lists into a string without spaces\n    output_str = '[' + ','.join([f\"[{l},{e}]\" for l, e in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}