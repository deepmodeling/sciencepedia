{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于气候科学的基石：地球的能量平衡。通过一个简化的零维模型，本练习 () 将引导您从能量守恒的第一性原理出发，推导出平衡态气候敏感度（ECS）的基本表达式。这个练习将帮助您理解，ECS 不仅仅是一个抽象参数，而是由系统达到新平衡态时辐射强迫与气候反馈之间相互作用所决定的。",
            "id": "4039740",
            "problem": "考虑一个由大气层顶（TOA）的能量守恒所支配的地球气候系统的全球平均零维能量平衡模型。设与大气二氧化碳（CO$_2$）浓度瞬时加倍相关的外部辐射强迫为一个常数 $F_{2x}$，并设系统的总体气候反馈参数为 $\\lambda$，其定义为相对于一个参考气候，全球平均地表温度异常 $\\Delta T$ 每增加一个单位，大气层顶（TOA）的辐射损失增量。在平衡状态下，TOA的净辐射不平衡必须为零。\n\n从这些基本原理出发，并仅利用能量守恒所蕴含的平衡条件，推导平衡气候敏感度（ECS）的解析表达式。ECS定义为响应阶跃强迫 $F_{2x}$ 时的平衡全球平均地表温度变化 $\\Delta T_{\\mathrm{eq}}$，并用 $F_{2x}$ 和 $\\lambda$ 来表示。在得到这个表达式之后，通过量纲分析验证其单位是温度。然后，使用 $F_{2x} = 3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ 和 $\\lambda = 1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$，计算ECS的数值。将最终数值答案四舍五入至三位有效数字，并以开尔文为单位表示。",
            "solution": "问题陈述经评估是有效的。它在科学上基于应用于气候科学的能量守恒原理，问题提法得当，提供了所有必要信息，并以客观、精确的语言表述。\n\n按要求，解答过程分为三个部分：推导平衡气候敏感度（ECS）的解析表达式，对该表达式进行量纲分析，以及其数值计算。\n\n首先，我们建立零维能量平衡模型的控制方程。大气层顶（TOA）的净辐射不平衡（记为 $N$）是地球系统吸收的能量与辐射出的能量之差。在响应扰动时，这种不平衡可以表示为外部强迫和系统辐射响应之和。\n\n问题指定了由于大气 $\\text{CO}_2$ 浓度加倍而产生的外部辐射强迫 $F_{2x}$。这个强迫作用是增加系统中的能量。系统通过增加其向外长波辐射来响应由此产生的全球平均地表温度升高 $\\Delta T$。气候反馈参数 $\\lambda$ 量化了这种响应。它被定义为 $\\Delta T$ 每增加一个单位所引起的TOA辐射损失增量。因此，辐射响应（即反馈）是系统能量的损失，由项 $\\lambda \\Delta T$ 给出。\n\nTOA净辐射不平衡的方程是：\n$$N = F_{2x} - \\lambda \\Delta T$$\n在这里，$F_{2x}$ 是能量增益（正值），而 $\\lambda \\Delta T$ 是抵消强迫的能量损失（负号）。\n\n平衡气候敏感度（记为 $\\Delta T_{\\mathrm{eq}}$）定义为在施加了强迫 $F_{2x}$ 后，系统达到新的平衡状态时的全球平均地表温度变化。在平衡状态下，TOA的净辐射不平衡必须为零，即 $N = 0$。在平衡条件下，将能量平衡方程中的 $\\Delta T$ 替换为 $\\Delta T_{\\mathrm{eq}}$，得到：\n$$0 = F_{2x} - \\lambda \\Delta T_{\\mathrm{eq}}$$\n我们现在可以解出 $\\Delta T_{\\mathrm{eq}}$ 来推导ECS的解析表达式：\n$$\\lambda \\Delta T_{\\mathrm{eq}} = F_{2x}$$\n$$\\Delta T_{\\mathrm{eq}} = \\frac{F_{2x}}{\\lambda}$$\n这就是用辐射强迫 $F_{2x}$ 和气候反馈参数 $\\lambda$ 表示的平衡气候敏感度的解析表达式。\n\n第二，我们进行量纲分析以验证所推导的表达式具有温度的单位。设 $[X]$ 表示物理量 $X$ 的单位。问题中给出的单位是：\n- 辐射强迫的单位为 $[F_{2x}] = \\mathrm{W}\\,\\mathrm{m}^{-2}$（瓦特每平方米）。\n- 气候反馈参数的单位为 $[\\lambda] = \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$（瓦特每平方米每开尔文）。\n\n因此，$\\Delta T_{\\mathrm{eq}}$ 的单位是：\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{[F_{2x}]}{[\\lambda]} = \\frac{\\mathrm{W}\\,\\mathrm{m}^{-2}}{\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\n分子和分母中的 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 单位相互抵消，剩下：\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{1}{\\mathrm{K}^{-1}} = \\mathrm{K}$$\n量纲分析证实，ECS的表达式正确地得出了温度单位（开尔文），这在物理上是一致的。\n\n第三，我们使用所提供的数据计算ECS的数值：\n$F_{2x} = 3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$\n$\\lambda = 1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n\n将这些值代入推导出的表达式中：\n$$\\Delta T_{\\mathrm{eq}} = \\frac{3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}}{1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\n$$\\Delta T_{\\mathrm{eq}} = 3.7\\,\\mathrm{K}$$\n问题要求将最终数值答案四舍五入到三位有效数字。因此，我们将结果表示为 $3.70$。",
            "answer": "$$\\boxed{3.70}$$"
        },
        {
            "introduction": "在认识了平衡态的概念之后，我们现在引入一个更接近现实的复杂因素：海洋的热惯性。地球气候系统不会对强迫立即作出完全响应，因为海洋吸收了大量的热量，从而延缓了地表变暖。本练习 () 通过引入一个简化的海洋吸热参数，帮助您区分瞬态气候响应（TCR）与平衡态气候敏感度（ECS），并定量理解它们之间的差异。",
            "id": "4039765",
            "problem": "考虑一个适用于气候模拟的全球平均能量平衡框架，其中大气层顶 (TOA) 的净辐射不平衡表示为 $F(t) = \\lambda\\,T(t) + N(t)$，其中 $F(t)$ 是外部施加的辐射强迫，$\\lambda$ 是气候反馈参数，$T(t)$ 是全球平均地表气温异常，$N(t)$ 是行星热吸收。假设对热吸收 $N(t) = \\kappa\\,T(t)$ 采用一个广泛使用的线性闭合，其中 $\\kappa$ 代表有效海洋热吸收效率。将平衡气候敏感度 (ECS) 定义为由于大气中二氧化碳 (CO$_2$) 浓度瞬时加倍而产生的恒定强迫 $F_{2x}$ 所平衡的稳态温度变化。将瞬时气候响应 (TCR) 定义为，在二氧化碳以每年百分之一复合增长的情景下，当 $F(t)$ 达到 $F_{2x}$ 时，使用相同的大气层顶能量平衡和线性热吸收闭合，在二氧化碳浓度加倍的瞬间所评估的全球平均温度变化。使用参数值 $F_{2x} = 3.7$ W m$^{-2}$，$\\lambda = 1.0$ W m$^{-2}$ K$^{-1}$ 和 $\\kappa = 0.7$ W m$^{-2}$ K$^{-1}$，从所述的平衡关系中推导出 $ECS$ 和 $TCR$ 的表达式，计算它们的数值，并解释它们之间的差异如何通过持续的行星热吸收来量化热惯性。将每个报告的温度四舍五入到三位有效数字，并以开尔文为单位表示。按 $(ECS, TCR)$ 的顺序报告最终的数值答案。",
            "solution": "全球平均的大气层顶能量收支由 $F(t) = \\lambda\\,T(t) + N(t)$ 给出，其中 $N(t)$ 是行星热吸收。使用线性闭合 $N(t) = \\kappa\\,T(t)$，能量收支变为\n$$\nF(t) = \\lambda\\,T(t) + \\kappa\\,T(t) = \\left(\\lambda + \\kappa\\right) T(t).\n$$\n平衡气候敏感度 (ECS) 对应于在施加恒定强迫 $F_{2x}$ 很长时间后达到的稳态，此时行星净热吸收为零，$N = 0$。在平衡状态下，能量收支简化为\n$$\nF_{2x} = \\lambda\\,\\text{ECS},\n$$\n这意味着\n$$\n\\text{ECS} = \\frac{F_{2x}}{\\lambda}.\n$$\n瞬时气候响应 (TCR) 定义于二氧化碳以每年百分之一复合增长并在浓度加倍的瞬间。在那个瞬间，强迫已达到 $F_{2x}$，但系统尚未平衡，因此 $N \\neq 0$。使用相同的大气层顶能量收支和线性闭合 $N = \\kappa\\,T$，在加倍瞬间的瞬时平衡是\n$$\nF_{2x} = \\lambda\\,\\text{TCR} + \\kappa\\,\\text{TCR} = \\left(\\lambda + \\kappa\\right) \\text{TCR},\n$$\n这意味着\n$$\n\\text{TCR} = \\frac{F_{2x}}{\\lambda + \\kappa}.\n$$\n这些表达式突显了海洋热惯性的作用：对于固定的 $F_{2x}$ 和 $\\lambda$，较大的 $\\kappa$ 会相对于 $ECS$ 减小 $TCR$，因为更多的强迫被海洋以热量的形式吸收，从而延迟了地表变暖。\n\n现在代入给定的参数值 $F_{2x} = 3.7$ W m$^{-2}$，$\\lambda = 1.0$ W m$^{-2}$ K$^{-1}$ 和 $\\kappa = 0.7$ W m$^{-2}$ K$^{-1}$。\n\n对于 $ECS$：\n$$\n\\text{ECS} = \\frac{3.7}{1.0} = 3.7 \\ \\text{K}.\n$$\n四舍五入到三位有效数字，结果是 $3.70$ K。\n\n对于 $TCR$：\n$$\n\\text{TCR} = \\frac{3.7}{1.0 + 0.7} = \\frac{3.7}{1.7} \\approx 2.176470588\\ \\text{K}.\n$$\n四舍五入到三位有效数字，结果是 $2.18$ K。\n\n为了将差异定量地解释为热惯性的度量，请注意，在加倍时的未实现增温是\n$$\n\\Delta T_{\\text{inertia}} = \\text{ECS} - \\text{TCR} = \\frac{F_{2x}}{\\lambda} - \\frac{F_{2x}}{\\lambda + \\kappa} = F_{2x}\\,\\frac{\\kappa}{\\lambda\\left(\\lambda + \\kappa\\right)}.\n$$\n使用所提供的参数，计算结果为\n$$\n\\Delta T_{\\text{inertia}} = 3.7 \\times \\frac{0.7}{1.0 \\times 1.7} \\approx 1.523529412\\ \\text{K},\n$$\n这表明，与平衡状态相比，海洋的持续热吸收使加倍时的已实现增温减少了约 $1.52$ K。一个互补的无量纲度量是在加倍时的已实现分数，\n$$\n\\frac{\\text{TCR}}{\\text{ECS}} = \\frac{\\lambda}{\\lambda + \\kappa},\n$$\n在这里等于 $1.0 / 1.7 \\approx 0.588$，意味着在加倍时大约实现了平衡增温的 $0.59$，而剩余的 $0.41$ 则因与海洋热吸收相关的热惯性而延迟。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.70 & 2.18 \\end{pmatrix}}$$"
        },
        {
            "introduction": "从理论推导转向计算实践，本练习 () 将带您体验气候科学家如何从数据中估算气候敏感度。您将通过编写程序，首先生成一段包含多种强迫和内部变率的“虚拟”气候历史，然后分析不同的数据处理方法——例如选择不同的基准期或如何处理火山爆发数据——如何影响您对气候反馈和 ECS 的估算结果。这项实践旨在揭示，现实世界中气候敏感度估算的不确定性不仅源于物理过程本身，也与研究方法密切相关。",
            "id": "4039728",
            "problem": "构建一个完整、可运行的程序，该程序能够合成一个物理上一致的历史时间序列，然后量化方法上的决策如何影响观测推断的气候反馈参数以及其隐含的平衡态气候敏感度 (ECS)。您的程序必须仅从能量守恒和标准定义出发，实现以下内容，并为一组定义的测试套件产生数值输出。\n\n基础和定义：\n- 使用行星能量平衡方程：在每个时间 $t$，行星热量吸收 $N(t)$ 满足 $N(t) = F(t) - \\lambda T(t)$，其中 $F(t)$ 是单位为 $\\mathrm{W\\,m^{-2}}$ 的净有效辐射强迫，$T(t)$ 是相对于一个基线、单位为 $\\mathrm{K}$ 的全球平均地表温度异常，而 $\\lambda$ 是单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 的气候反馈参数。\n- 在一个单箱能量平衡模型中，混合层热容量 $C$ 的单位为 $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$，温度以离散的年度时间步长 $\\Delta t = 1\\,\\mathrm{yr}$ 通过前向欧拉 (forward-Euler) 更新进行演变：\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big),\n$$\n在初始年份 $t_0$ 时 $T_{t_0} = 0$。\n- 在精确平衡状态下（无净热量吸收），$N = 0$，因此 $F = \\lambda T$。对于大气中二氧化碳浓度加倍的情况，设辐射强迫为一个给定的常数 $F_{2\\times}$，单位为 $\\mathrm{W\\,m^{-2}}$。平衡态气候敏感度 (ECS) 是对 $F_{2\\times}$ 的平衡温度响应，单位为 $\\mathrm{K}$。\n\n合成数据规格：\n- 时间轴包含整数年份 $t \\in \\{1850,1851,\\dots,2020\\}$。\n- 将净有效辐射强迫 $F(t)$ 规定为三个分量的总和，所有分量的单位均为 $\\mathrm{W\\,m^{-2}}$：\n  1. 一个人为强迫斜坡 $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$，其中 $s_{\\mathrm{anth}} = 2.5 / 170$，使得 $F_{\\mathrm{anth}}(2020) = 2.5$。\n  2. 一个世纪中叶的气溶胶冷却异常 $F_{\\mathrm{aero}}(t) = -A \\exp\\!\\Big(-\\frac{(t-\\mu)^2}{2\\sigma^2}\\Big)$，其中 $A = 0.8$，$\\mu = 1960$，$\\sigma = 12$。\n  3. 火山强迫 $F_{\\mathrm{volc}}(t)$，由在年份 $t_i \\in \\{1883,1902,1963,1982,1991\\}$ 的负脉冲组成，其振幅为 $M_i \\in \\{-1.2,-1.0,-0.8,-1.0,-1.2\\}$，指数衰减时间尺度为 $\\tau_v = 1.5\\,\\mathrm{yr}$：\n  $$\n  F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp\\!\\Big(-\\frac{t-t_i}{\\tau_v}\\Big),\n  $$\n  其中 $\\mathbf{1}_{t \\ge t_i}$ 是指示函数。\n- 总强迫为 $F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$。\n- 选择真实的反馈参数 $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 和热容量 $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$。从 $t_0 = 1850$ 开始，使用上述离散更新来演变 $T(t)$，以获得无噪声的 $T_{\\mathrm{true}}(t)$。\n- 定义无噪声的行星热量吸收 $N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$。\n- 通过从具有固定随机种子的独立零均值高斯扰动中抽样来添加观测噪声：温度噪声 $\\varepsilon_T \\sim \\mathcal{N}(0,\\sigma_T^2)$，其中 $\\sigma_T = 0.05\\,\\mathrm{K}$；热量吸收噪声 $\\varepsilon_N \\sim \\mathcal{N}(0,\\sigma_N^2)$，其中 $\\sigma_N = 0.10\\,\\mathrm{W\\,m^{-2}}$。将固定种子设置为 $42$。观测序列为 $T_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)$ 和 $N_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)$。在整个过程中，使用 $\\Delta t = 1\\,\\mathrm{yr}$。\n\n推断反馈和 ECS 的估计方法：\n- 构建单位为 $\\mathrm{W\\,m^{-2}}$ 的回归目标 $Y(t) = F(t) - N_{\\mathrm{obs}}(t)$。\n- 对于一个选定的基线期 $[b_0,b_1]$（含端点），计算基线平均温度 $\\overline{T}_{\\mathrm{obs}} = \\frac{1}{n_b}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$，其中 $n_b$ 是该时期的年数。\n- 定义异常值 $T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$。\n- 为模拟高纬度地区的掩蔽效应，通过一个乘法因子 $s \\in (0,1]$ 对温度异常进行重新缩放，得到 $T_s(t) = s\\,T'(t)$。\n- 根据单位为 $\\mathrm{W\\,m^{-2}}$ 的阈值 $\\tau$ 排除火山年份，即移除任何满足 $\\lvert F_{\\mathrm{volc}}(t)\\rvert \\ge \\tau$ 的年份 $t$。使用所有剩余的年份 $t \\in \\{1850,\\dots,2020\\}$，对 $Y(t)$ 关于 $T_s(t)$ 进行通过原点的线性回归，以获得一个估计值 $\\widehat{\\lambda}$，该值最小化 $\\sum_t \\big(Y(t) - \\widehat{\\lambda}\\,T_s(t)\\big)^2$。\n- 仅使用能量平衡中的平衡条件，计算对于 CO$_2$ 加倍强迫 $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$ 时的 ECS，单位为 $\\mathrm{K}$。\n\n单位和要求的输出：\n- 报告 $\\widehat{\\lambda}$（单位 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）和 ECS（单位 $\\mathrm{K}$）。在最终输出中将两者均四舍五入到三位小数。\n- 您的程序必须打印单行内容，其中包含一个列表的列表，每个测试用例对应一个内层列表，格式为 $[\\widehat{\\lambda}, \\mathrm{ECS}]$。打印的输出中不应出现单位，只应包含按规定四舍五入的数值。\n\n测试套件：\n对于以下每个参数四元组 $(b_0,b_1,\\tau,s)$，运行上述估算过程，并将 $[\\widehat{\\lambda}, \\mathrm{ECS}]$ 对附加到最终输出列表中。\n\n- 案例 A（理想情况，近前工业化基线，无掩蔽，排除大喷发）：$(1850,1869,0.8,1.0)$。\n- 案例 B（远离前工业化时期的基线，包括所有火山年份）：$(1961,1990,10.0,1.0)$。\n- 案例 C（现代基线，严格的火山排除标准，显著的掩蔽）：$(1981,2010,0.3,0.85)$。\n- 案例 D（世纪中叶基线，中等火山排除标准，强掩蔽）：$(1931,1960,0.5,0.70)$。\n\n算法和数值要求：\n- 完全按照所述实现所有方程。不要使用任何外部数据。使用指定的随机种子以确保可复现性。\n- 在内部以指定的单位表示所有中间物理量。所有角度（如果有）必须以弧度表示，但本问题不涉及角度。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 `[[x_1,y_1],[x_2,y_2],...]`，其中每个 $x_i$ 和 $y_i$ 是一个四舍五入到三位小数的浮点数。",
            "solution": "该问题要求构建一个程序，基于一个简单的能量平衡模型来合成一个合成的气候时间序列，然后从这个合成数据中估算气候反馈参数 $\\lambda$ 和平衡态气候敏感度 (ECS)。任务的核心是量化分析中的不同方法选择——具体而言，即基线期的选择、火山年份的排除标准以及为模拟空间掩蔽而对温度数据进行的缩放——如何影响 $\\lambda$ 和 ECS 的最终估算值。\n\n解决方案分两个主要阶段实施：(1) 生成合成的“地面真实”(ground truth)和“观测”气候数据，以及 (2) 对每个测试用例应用指定的估算程序。\n\n**1. 合成数据生成**\n\n该模型的基础是行星能量平衡，它指出行星吸收热量的速率 $N(t)$ 是入射辐射强迫 $F(t)$ 与出射热辐射之间的差值，而出射热辐射被参数化为与全球平均地表温度异常 $T(t)$ 成正比。比例常数就是气候反馈参数 $\\lambda$。\n$$\nN(t) = F(t) - \\lambda T(t)\n$$\n所有量均在问题陈述中定义，其中 $N$ 和 $F$ 的单位为 $\\mathrm{W\\,m^{-2}}$，$T$ 的单位为 $\\mathrm{K}$，$\\lambda$ 的单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n我们首先构建在年份 $t \\in [1850, 2020]$ 范围内的总辐射强迫 $F(t)$ 的时间序列。该强迫是三个不同分量的总和：\n- **人为强迫, $F_{\\mathrm{anth}}(t)$**: 一个线性斜坡，代表温室气体影响的增长。其定义为 $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$，其中斜率 $s_{\\mathrm{anth}} = 2.5 / 170 \\,\\mathrm{W\\,m^{-2}\\,yr^{-1}}$ 确保强迫在 2020 年达到 $2.5\\,\\mathrm{W\\,m^{-2}}$。\n- **气溶胶强迫, $F_{\\mathrm{aero}}(t)$**: 一个以 20 世纪中叶为中心的高斯形负强迫，用以代表工业气溶胶的冷却效应。其公式为 $F_{\\mathrm{aero}}(t) = -A \\exp(-\\frac{(t-\\mu)^2}{2\\sigma^2})$，振幅 $A=0.8\\,\\mathrm{W\\,m^{-2}}$，平均年份 $\\mu=1960$，标准差 $\\sigma=12\\,\\mathrm{yr}$。\n- **火山强迫, $F_{\\mathrm{volc}}(t)$**: 一系列急剧的、指数衰减的负强迫脉冲，模拟主要火山喷发的影响。其公式为 $F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp(-\\frac{t-t_i}{\\tau_v})$，其中 $t_i$ 是喷发年份 $\\{1883, 1902, 1963, 1982, 1991\\}$，$M_i$ 是对应的振幅 $\\{-1.2, -1.0, -0.8, -1.0, -1.2\\}\\,\\mathrm{W\\,m^{-2}}$，$\\tau_v=1.5\\,\\mathrm{yr}$ 是衰减时间尺度。\n\n总强迫是三者之和：$F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$。\n\n接下来，我们通过数值积分一个单箱能量平衡模型来生成“真实”的历史温度异常时间序列 $T_{\\mathrm{true}}(t)$。该模型的演变由一个年度时间步长 $\\Delta t = 1\\,\\mathrm{yr}$ 的前向欧拉（forward-Euler）离散化描述：\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big)\n$$\n我们从初始条件 $T_{1850} = 0\\,\\mathrm{K}$ 开始，并使用规定的“真实”反馈参数 $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 和海洋混合层热容量 $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$。\n\n在确定了 $F(t)$ 和 $T_{\\mathrm{true}}(t)$ 之后，“真实”的行星热量吸收 $N_{\\mathrm{true}}(t)$ 就通过能量平衡方程计算得出：$N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$。\n\n最后，为了模拟观测不确定性，我们向真实序列添加零均值高斯噪声。为了可复现性，我们使用固定的随机种子 42，生成噪声项 $\\varepsilon_T \\sim \\mathcal{N}(0, \\sigma_T^2)$（其中 $\\sigma_T=0.05\\,\\mathrm{K}$）和 $\\varepsilon_N \\sim \\mathcal{N}(0, \\sigma_N^2)$（其中 $\\sigma_N=0.10\\,\\mathrm{W\\,m^{-2}}$）。最终的“观测”时间序列是：\n$$\nT_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)\n$$\n$$\nN_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)\n$$\n\n**2. $\\lambda$ 和 ECS 的估算**\n\n第二阶段涉及从“观测”数据中推断反馈参数 $\\widehat{\\lambda}$ 及其对应的 ECS，此过程遵循为每个测试用例指定的、有所变化的程序。其基本原理是将能量平衡方程重排为适合线性回归的形式：$F(t) - N(t) = \\lambda T(t)$。\n\n对于由参数集 $(b_0, b_1, \\tau, s)$ 定义的每个测试用例：\n1.  构建回归目标变量：$Y(t) = F(t) - N_{\\mathrm{obs}}(t)$。从含噪声数据的角度来看，我们期望 $Y(t) \\approx \\lambda T_{\\mathrm{obs}}(t)$。\n2.  使用一个基线期 $[b_0, b_1]$ 来计算平均观测温度，$\\overline{T}_{\\mathrm{obs}} = \\frac{1}{b_1 - b_0 + 1}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$。\n3.  对所有年份，将温度数据转换为相对于该基线的异常值：$T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$。\n4.  为模拟空间覆盖不完全（例如，掩蔽极地地区）的影响，将温度异常乘以一个因子 $s$ 进行缩放：$T_s(t) = s\\,T'(t)$。\n5.  从回归中排除与主要火山喷发相对应的数据点。任何火山强迫幅度 $|F_{\\mathrm{volc}}(t)|$ 大于或等于阈值 $\\tau$ 的年份 $t$ 都将从数据集中移除。\n6.  使用剩余的数据点，对 $Y(t)$ 关于 $T_s(t)$ 进行通过原点的线性回归。估算出的反馈参数 $\\widehat{\\lambda}$ 是回归线的斜率，它最小化了残差平方和 $\\sum_t (Y(t) - \\widehat{\\lambda}\\,T_s(t))^2$。其解析解为：\n    $$\n    \\widehat{\\lambda} = \\frac{\\sum_t Y(t) \\cdot T_s(t)}{\\sum_t T_s(t)^2}\n    $$\n    其中求和是针对所有未被火山过滤器排除的年份。\n7.  然后计算估算的平衡态气候敏感度 (ECS)。ECS 是在持续强迫 $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$ 下的平衡温度变化。在平衡状态下，$N=0$，因此 $F_{2\\times} = \\widehat{\\lambda}\\,\\text{ECS}$。这得到：\n    $$\n    \\mathrm{ECS} = \\frac{F_{2\\times}}{\\widehat{\\lambda}}\n    $$\n程序为所提供的四个测试用例中的每一个执行这整个过程，并报告结果对 $[\\widehat{\\lambda}, \\mathrm{ECS}]$，四舍五入到三位小数。不同案例结果的变化将突显气候参数估算对常见方法选择的敏感性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Synthesizes a climate time series and quantifies how methodological decisions \n    affect inferred climate feedback and ECS.\n    \"\"\"\n    \n    # --------------------------------------------------------------------------\n    # Foundational base and definitions\n    # --------------------------------------------------------------------------\n    lambda_true = 1.20  # W m^-2 K^-1\n    C = 8.0             # W yr m^-2 K^-1\n    F_2x = 3.71         # W m^-2\n    delta_t = 1.0       # yr\n    \n    # Time axis\n    t_start, t_end = 1850, 2020\n    t_years = np.arange(t_start, t_end + 1)\n    num_years = len(t_years)\n\n    # --------------------------------------------------------------------------\n    # Synthetic data specification\n    # --------------------------------------------------------------------------\n    \n    # Component 1: Anthropogenic forcing\n    s_anth = 2.5 / 170.0\n    F_anth = s_anth * (t_years - 1850)\n\n    # Component 2: Aerosol forcing\n    A, mu, sigma = 0.8, 1960.0, 12.0\n    F_aero = -A * np.exp(-((t_years - mu)**2) / (2 * sigma**2))\n\n    # Component 3: Volcanic forcing\n    t_volc_i = [1883, 1902, 1963, 1982, 1991]\n    M_i = [-1.2, -1.0, -0.8, -1.0, -1.2]\n    tau_v = 1.5  # yr\n    F_volc = np.zeros(num_years)\n    for t_erupt, M in zip(t_volc_i, M_i):\n        # Apply forcing from the eruption year onwards\n        indices = t_years >= t_erupt\n        time_since_eruption = t_years[indices] - t_erupt\n        F_volc[indices] += M * np.exp(-time_since_eruption / tau_v)\n\n    # Total forcing\n    F_total = F_anth + F_aero + F_volc\n    \n    # Evolve true temperature T_true(t)\n    T_true = np.zeros(num_years)\n    T_true[0] = 0.0 # T_1850 = 0\n    for i in range(num_years - 1):\n        T_true[i+1] = T_true[i] + (delta_t / C) * (F_total[i] - lambda_true * T_true[i])\n\n    # Calculate true heat uptake N_true(t)\n    N_true = F_total - lambda_true * T_true\n\n    # Add observational noise\n    seed = 42\n    rng = np.random.default_rng(seed)\n    sigma_T = 0.05  # K\n    sigma_N = 0.10  # W m^-2\n    eps_T = rng.normal(0, sigma_T, num_years)\n    eps_N = rng.normal(0, sigma_N, num_years)\n    \n    T_obs = T_true + eps_T\n    N_obs = N_true + eps_N\n    \n    # --------------------------------------------------------------------------\n    # Estimation method loop for test suite\n    # --------------------------------------------------------------------------\n    \n    test_cases = [\n        # (b0, b1, tau, s)\n        (1850, 1869, 0.8, 1.0),    # Case A\n        (1961, 1990, 10.0, 1.0),   # Case B\n        (1981, 2010, 0.3, 0.85),   # Case C\n        (1931, 1960, 0.5, 0.70)    # Case D\n    ]\n    \n    results = []\n    \n    # Form the regression target Y(t), which is common to all cases\n    Y = F_total - N_obs\n    \n    for b0, b1, tau, s in test_cases:\n        # Compute baseline mean temperature\n        baseline_mask = (t_years >= b0)  (t_years = b1)\n        T_obs_mean = np.mean(T_obs[baseline_mask])\n        \n        # Define the anomaly and scale it\n        T_prime = T_obs - T_obs_mean\n        T_s = s * T_prime\n        \n        # Exclude volcanic years by creating a mask for years to KEEP\n        regression_mask = np.abs(F_volc)  tau\n        \n        # Select data for regression\n        Y_reg = Y[regression_mask]\n        Ts_reg = T_s[regression_mask]\n        \n        # Perform linear regression through the origin\n        # lambda_hat = sum(x*y) / sum(x^2)\n        lambda_hat = np.sum(Y_reg * Ts_reg) / np.sum(Ts_reg**2)\n        \n        # Compute ECS\n        ecs_hat = F_2x / lambda_hat\n        \n        # Round and store results\n        results.append([round(lambda_hat, 3), round(ecs_hat, 3)])\n\n    # --------------------------------------------------------------------------\n    # Final output\n    # --------------------------------------------------------------------------\n    # Format the final list of lists into a string without spaces\n    output_str = '[' + ','.join([f\"[{l},{e}]\" for l, e in results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}