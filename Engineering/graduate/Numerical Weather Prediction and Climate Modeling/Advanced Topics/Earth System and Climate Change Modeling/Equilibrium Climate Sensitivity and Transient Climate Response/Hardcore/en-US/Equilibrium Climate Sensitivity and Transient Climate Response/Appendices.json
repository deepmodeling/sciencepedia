{
    "hands_on_practices": [
        {
            "introduction": "This practice lays the groundwork for understanding Equilibrium Climate Sensitivity (ECS) through the lens of Earth's most basic energy budget. By considering the planet as a simple, zero-dimensional system, you will derive the fundamental relationship connecting radiative forcing, climate feedbacks, and the ultimate temperature change at equilibrium. This exercise  solidifies the core concepts and provides a crucial analytical anchor for more complex climate models.",
            "id": "4039740",
            "problem": "Consider a globally averaged, zero-dimensional energy balance representation of Earth’s climate system governed by conservation of energy at the top of the atmosphere (TOA). Let the externally imposed radiative forcing associated with instantaneous doubling of atmospheric carbon dioxide (CO$_2$) be a constant $F_{2x}$, and let the system’s bulk climate feedback parameter be $\\lambda$, defined as the incremental TOA radiative loss per unit increase in the global-mean surface temperature anomaly $\\Delta T$ from a reference climate. At equilibrium, the net TOA radiative imbalance must vanish. \n\nStarting from these fundamentals and using only the equilibrium condition implied by energy conservation, derive an analytic expression for the Equilibrium Climate Sensitivity (ECS), defined as the equilibrium global-mean surface temperature change $\\Delta T_{\\mathrm{eq}}$ in response to a step forcing $F_{2x}$, in terms of $F_{2x}$ and $\\lambda$. After obtaining this expression, verify by dimensional analysis that it has the units of temperature. Then, using $F_{2x} = 3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ and $\\lambda = 1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$, compute the numerical value of ECS. Round your final numerical answer to three significant figures and express it in kelvin.",
            "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of energy conservation as applied to climate science, is well-posed with all necessary information provided, and is formulated with objective, precise language.\n\nThe solution proceeds in three parts as required: derivation of the analytical expression for Equilibrium Climate Sensitivity (ECS), dimensional analysis of the expression, and numerical calculation of its value.\n\nFirst, we establish the governing equation for the zero-dimensional energy balance model. The net radiative imbalance at the top of the atmosphere (TOA), denoted by $N$, is the difference between the energy absorbed and the energy emitted by the Earth system. In response to a perturbation, this imbalance can be expressed as the sum of the external forcing and the system's radiative response.\n\nThe problem specifies an externally imposed radiative forcing $F_{2x}$ due to a doubling of atmospheric $\\text{CO}_2$. This forcing acts to increase the energy in the system. The system responds to the resulting increase in global-mean surface temperature, $\\Delta T$, by increasing its outgoing longwave radiation. The climate feedback parameter, $\\lambda$, quantifies this response. It is defined as the incremental TOA radiative loss per unit increase in $\\Delta T$. Therefore, the radiative response (the feedback) is a loss of energy from the system, given by the term $\\lambda \\Delta T$.\n\nThe equation for the net TOA radiative imbalance is:\n$$N = F_{2x} - \\lambda \\Delta T$$\nHere, $F_{2x}$ is the energy gain (positive) and $\\lambda \\Delta T$ is the energy loss (negative sign) that counteracts the forcing.\n\nEquilibrium Climate Sensitivity, denoted as $\\Delta T_{\\mathrm{eq}}$, is defined as the global-mean surface temperature change once the system reaches a new equilibrium state after the imposition of the forcing $F_{2x}$. At equilibrium, the net radiative imbalance at the TOA must vanish, so $N = 0$. Substituting $\\Delta T_{\\mathrm{eq}}$ for $\\Delta T$ in the energy balance equation under the equilibrium condition gives:\n$$0 = F_{2x} - \\lambda \\Delta T_{\\mathrm{eq}}$$\nWe can now solve for $\\Delta T_{\\mathrm{eq}}$ to derive the analytical expression for ECS:\n$$\\lambda \\Delta T_{\\mathrm{eq}} = F_{2x}$$\n$$\\Delta T_{\\mathrm{eq}} = \\frac{F_{2x}}{\\lambda}$$\nThis is the analytical expression for the Equilibrium Climate Sensitivity in terms of the radiative forcing $F_{2x}$ and the climate feedback parameter $\\lambda$.\n\nSecond, we perform a dimensional analysis to verify the derived expression has units of temperature. Let $[X]$ denote the physical units of a quantity $X$. The units provided in the problem are:\n- For radiative forcing, $[F_{2x}] = \\mathrm{W}\\,\\mathrm{m}^{-2}$ (watts per square meter).\n- For the climate feedback parameter, $[\\lambda] = \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$ (watts per square meter per Kelvin).\n\nThe units of $\\Delta T_{\\mathrm{eq}}$ are therefore:\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{[F_{2x}]}{[\\lambda]} = \\frac{\\mathrm{W}\\,\\mathrm{m}^{-2}}{\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\nThe units of $\\mathrm{W}\\,\\mathrm{m}^{-2}$ in the numerator and denominator cancel, leaving:\n$$[\\Delta T_{\\mathrm{eq}}] = \\frac{1}{\\mathrm{K}^{-1}} = \\mathrm{K}$$\nThe dimensional analysis confirms that the expression for ECS correctly yields units of temperature (Kelvin), which is physically consistent.\n\nThird, we compute the numerical value of ECS using the provided data:\n$F_{2x} = 3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$\n$\\lambda = 1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n\nSubstituting these values into the derived expression:\n$$\\Delta T_{\\mathrm{eq}} = \\frac{3.7\\,\\mathrm{W}\\,\\mathrm{m}^{-2}}{1.0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}}$$\n$$\\Delta T_{\\mathrm{eq}} = 3.7\\,\\mathrm{K}$$\nThe problem requires the final numerical answer to be rounded to three significant figures. Therefore, we express the result as 3.70.",
            "answer": "$$\\boxed{3.70}$$"
        },
        {
            "introduction": "The real climate system does not reach equilibrium instantaneously, largely due to the immense thermal inertia of the oceans. This practice introduces this crucial complexity by incorporating a term for ocean heat uptake into the energy balance framework. By differentiating between the transient and equilibrium states, you will derive expressions for both the Transient Climate Response (TCR) and Equilibrium Climate Sensitivity (ECS), revealing why the warming realized at any given time is less than the total warming the planet is committed to .",
            "id": "4039765",
            "problem": "Consider a globally averaged energy-balance framework appropriate for climate modeling, in which the Top of Atmosphere (TOA) net radiative imbalance is written as $F(t) = \\lambda\\,T(t) + N(t)$, where $F(t)$ is the externally imposed radiative forcing, $\\lambda$ is the climate feedback parameter, $T(t)$ is the global-mean surface air temperature anomaly, and $N(t)$ is the planetary heat uptake. Assume a widely used linear closure for the uptake $N(t) = \\kappa\\,T(t)$, with $\\kappa$ representing the effective ocean heat-uptake efficiency. Define Equilibrium Climate Sensitivity (ECS) as the steady-state temperature change that balances a constant forcing $F_{2x}$ due to an instantaneous doubling of atmospheric Carbon Dioxide (CO$_2$). Define Transient Climate Response (TCR) as the global-mean temperature change at the time of CO$_2$ doubling under a scenario of compound increase of CO$_2$ at one percent per year, evaluated using the same TOA energy balance and linear uptake closure at the instant $F(t)$ reaches $F_{2x}$. Using the parameter values $F_{2x} = 3.7$ W m$^{-2}$, $\\lambda = 1.0$ W m$^{-2}$ K$^{-1}$, and $\\kappa = 0.7$ W m$^{-2}$ K$^{-1}$, derive expressions for $ECS$ and $TCR$ from the stated balances, compute their numerical values, and explain how the difference between them quantifies thermal inertia via continued planetary heat uptake. Round each reported temperature to three significant figures and express the answers in Kelvin. Report your final numerical answers in the order $(ECS, TCR)$.",
            "solution": "The globally averaged TOA energy budget is given by $F(t) = \\lambda\\,T(t) + N(t)$, where $N(t)$ is the planetary heat uptake. With the linear closure $N(t) = \\kappa\\,T(t)$, the budget becomes\n$$\nF(t) = \\lambda\\,T(t) + \\kappa\\,T(t) = \\left(\\lambda + \\kappa\\right) T(t).\n$$\nThe Equilibrium Climate Sensitivity (ECS) corresponds to the steady state under a constant forcing $F_{2x}$ long after the forcing is imposed, when the net planetary heat uptake vanishes, $N = 0$. Under equilibrium, the budget reduces to\n$$\nF_{2x} = \\lambda\\,ECS,\n$$\nwhich implies\n$$\nECS = \\frac{F_{2x}}{\\lambda}.\n$$\nThe Transient Climate Response (TCR) is defined at the instant of CO$_2$ doubling under a one percent per year compound increase. At that instant, the forcing has reached $F_{2x}$, but the system has not equilibrated, so $N \\neq 0$. Using the same TOA budget with the linear closure $N = \\kappa\\,T$, the instantaneous balance at doubling is\n$$\nF_{2x} = \\lambda\\,TCR + \\kappa\\,TCR = \\left(\\lambda + \\kappa\\right) TCR,\n$$\nwhich implies\n$$\nTCR = \\frac{F_{2x}}{\\lambda + \\kappa}.\n$$\nThese expressions highlight the role of ocean thermal inertia: for fixed $F_{2x}$ and $\\lambda$, larger $\\kappa$ reduces $TCR$ relative to $ECS$ because more of the forcing is being taken up as heat by the ocean, delaying surface warming.\n\nNow substitute the given parameter values $F_{2x} = 3.7$ W m$^{-2}$, $\\lambda = 1.0$ W m$^{-2}$ K$^{-1}$, and $\\kappa = 0.7$ W m$^{-2}$ K$^{-1}$.\n\nFor $ECS$:\n$$\nECS = \\frac{3.7}{1.0} = 3.7 \\ \\text{K}.\n$$\nRounded to three significant figures, this is $3.70$ K.\n\nFor $TCR$:\n$$\nTCR = \\frac{3.7}{1.0 + 0.7} = \\frac{3.7}{1.7} \\approx 2.176470588\\ \\text{K}.\n$$\nRounded to three significant figures, this is $2.18$ K.\n\nTo interpret the difference quantitatively as a measure of thermal inertia, note that the unrealized warming at doubling is\n$$\n\\Delta T_{\\text{inertia}} = ECS - TCR = \\frac{F_{2x}}{\\lambda} - \\frac{F_{2x}}{\\lambda + \\kappa} = F_{2x}\\,\\frac{\\kappa}{\\lambda\\left(\\lambda + \\kappa\\right)}.\n$$\nWith the provided parameters, this evaluates to\n$$\n\\Delta T_{\\text{inertia}} = 3.7 \\times \\frac{0.7}{1.0 \\times 1.7} \\approx 1.523529412\\ \\text{K},\n$$\nindicating that the ocean’s continued heat uptake reduces the realized warming at the time of doubling by about $1.52$ K relative to equilibrium. A complementary dimensionless measure is the realized fraction at doubling,\n$$\n\\frac{TCR}{ECS} = \\frac{\\lambda}{\\lambda + \\kappa},\n$$\nwhich here equals $1.0 / 1.7 \\approx 0.588$, meaning roughly $0.59$ of the equilibrium warming is realized at the time of doubling, while the remaining $0.41$ is delayed by thermal inertia associated with ocean heat uptake.",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.70 & 2.18 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Bridging the gap between theory and application, this final practice moves into the realm of computational data analysis. Estimating climate sensitivity from historical or model-generated data is a complex task where methodological choices can significantly influence the results. In this exercise, you will write a program to first create a synthetic climate history with a known \"true\" sensitivity and then analyze this data to see how different analysis decisions affect your estimate . This provides a powerful, hands-on demonstration of the practical challenges and sensitivities involved in observational climate science.",
            "id": "4039728",
            "problem": "Construct a complete, runnable program that synthesizes a physically consistent historical time series and then quantifies how methodological decisions affect the observationally inferred climate feedback parameter and the implied Equilibrium Climate Sensitivity (ECS). Your program must implement the following, starting only from energy conservation and standard definitions, and must produce numerical outputs for a defined test suite.\n\nFoundational base and definitions:\n- Use the planetary energy balance statement: at each time $t$, the planetary heat uptake $N(t)$ satisfies $N(t) = F(t) - \\lambda T(t)$, where $F(t)$ is the net effective radiative forcing in $\\mathrm{W\\,m^{-2}}$, $T(t)$ is the global-mean surface temperature anomaly in $\\mathrm{K}$ relative to a baseline, and $\\lambda$ is the climate feedback parameter in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n- In a one-box energy balance model with mixed-layer heat capacity $C$ in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$, the temperature evolves in discrete annual time steps $\\Delta t = 1\\,\\mathrm{yr}$ by the forward-Euler update\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big),\n$$\nwith $T_{t_0} = 0$ at an initial year $t_0$.\n- At exact equilibrium (no net heat uptake), $N = 0$, so $F = \\lambda T$. For a doubling of atmospheric carbon dioxide, let the radiative forcing be a prescribed constant $F_{2\\times}$ in $\\mathrm{W\\,m^{-2}}$. The Equilibrium Climate Sensitivity (ECS) is the equilibrium temperature response in $\\mathrm{K}$ to $F_{2\\times}$.\n\nSynthetic data specification:\n- Time axis comprises integer years $t \\in \\{1850,1851,\\dots,2020\\}$.\n- Prescribe the net effective radiative forcing $F(t)$ as the sum of three components, all in $\\mathrm{W\\,m^{-2}}$:\n  1. An anthropogenic ramp $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$ with $s_{\\mathrm{anth}} = 2.5 / 170$ such that $F_{\\mathrm{anth}}(2020) = 2.5$.\n  2. A mid-century aerosol cooling anomaly $F_{\\mathrm{aero}}(t) = -A \\exp\\!\\Big(-\\frac{(t-\\mu)^2}{2\\sigma^2}\\Big)$ with $A = 0.8$, $\\mu = 1960$, and $\\sigma = 12$.\n  3. Volcanic forcing $F_{\\mathrm{volc}}(t)$ composed of negative pulses at years $t_i \\in \\{1883,1902,1963,1982,1991\\}$ with amplitudes $M_i \\in \\{-1.2,-1.0,-0.8,-1.0,-1.2\\}$ and an exponential decay time scale $\\tau_v = 1.5\\,\\mathrm{yr}$:\n  $$\n  F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp\\!\\Big(-\\frac{t-t_i}{\\tau_v}\\Big),\n  $$\n  where $\\mathbf{1}_{t \\ge t_i}$ is the indicator function.\n- The total forcing is $F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$.\n- Choose the true feedback parameter $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ and heat capacity $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$. Evolve $T(t)$ from $t_0 = 1850$ using the discrete update above to obtain a noise-free $T_{\\mathrm{true}}(t)$.\n- Define the noise-free planetary heat uptake $N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$.\n- Add observational noise by drawing independent zero-mean Gaussian perturbations with a fixed random seed: temperature noise $\\varepsilon_T \\sim \\mathcal{N}(0,\\sigma_T^2)$ with $\\sigma_T = 0.05\\,\\mathrm{K}$ and heat uptake noise $\\varepsilon_N \\sim \\mathcal{N}(0,\\sigma_N^2)$ with $\\sigma_N = 0.10\\,\\mathrm{W\\,m^{-2}}$. Set a fixed seed equal to $42$. The observed series are $T_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)$ and $N_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)$. Throughout, use $\\Delta t = 1\\,\\mathrm{yr}$.\n\nEstimation method to infer feedback and ECS:\n- Form the regression target $Y(t) = F(t) - N_{\\mathrm{obs}}(t)$ in $\\mathrm{W\\,m^{-2}}$.\n- For a chosen baseline period $[b_0,b_1]$ (inclusive), compute a baseline mean temperature $\\overline{T}_{\\mathrm{obs}} = \\frac{1}{n_b}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$ where $n_b$ is the number of years in that period.\n- Define the anomaly $T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$.\n- To emulate masking of high-latitude regions, rescale the temperature anomalies by a multiplicative factor $s \\in (0,1]$, giving $T_s(t) = s\\,T'(t)$.\n- Exclude volcanic years according to a threshold $\\tau$ in $\\mathrm{W\\,m^{-2}}$ by removing any $t$ for which $\\lvert F_{\\mathrm{volc}}(t)\\rvert \\ge \\tau$. Perform a linear regression through the origin of $Y(t)$ on $T_s(t)$ using all remaining years $t \\in \\{1850,\\dots,2020\\}$ to obtain an estimate $\\widehat{\\lambda}$ that minimizes $\\sum_t \\big(Y(t) - \\widehat{\\lambda}\\,T_s(t)\\big)^2$.\n- Using only the equilibrium condition from the energy balance, compute ECS in $\\mathrm{K}$ for CO$_2$ doubling forcing $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$, expressed as $\\mathrm{K}$.\n\nUnits and required outputs:\n- Report $\\widehat{\\lambda}$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ and ECS in $\\mathrm{K}$. Round both to three decimal places in the final output.\n- Your program must print a single line containing a list of lists, one per test case, where each inner list is $[\\widehat{\\lambda}, \\mathrm{ECS}]$. No units should appear in the printed output, only the numeric values rounded as specified.\n\nTest suite:\nFor each of the following parameter quadruples $(b_0,b_1,\\tau,s)$, run the above estimation and append the $[\\widehat{\\lambda}, \\mathrm{ECS}]$ pair to the final output list.\n\n- Case A (happy path, near-preindustrial baseline, masking off, exclude large eruptions): $(1850,1869,0.8,1.0)$.\n- Case B (baseline far from preindustrial, include all volcanic years): $(1961,1990,10.0,1.0)$.\n- Case C (modern baseline, stringent volcanic exclusion, substantial masking): $(1981,2010,0.3,0.85)$.\n- Case D (mid-century baseline, moderate volcanic exclusion, strong masking): $(1931,1960,0.5,0.70)$.\n\nAlgorithmic and numerical requirements:\n- Implement all equations exactly as stated. Do not use any external data. Use the specified random seed to ensure reproducibility.\n- Express all intermediate physical quantities internally in the units specified. All angles, if any, must be in radians, but this problem involves no angles.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[[x_1,y_1],[x_2,y_2],\\dots]$, where each $x_i$ and $y_i$ is a float rounded to three decimals.",
            "solution": "The problem requires the construction of a program to synthesize a synthetic climate time series based on a simple energy balance model, and then to estimate the climate feedback parameter, $\\lambda$, and Equilibrium Climate Sensitivity (ECS) from this synthetic data. The core of the task is to quantify how different methodological choices in the analysis—specifically the choice of baseline period, the exclusion criteria for volcanic years, and the scaling of temperature data to mimic spatial masking—affect the final estimates of $\\lambda$ and ECS.\n\nThe solution is implemented in two principal stages: (1) generation of the synthetic \"ground truth\" and \"observed\" climate data, and (2) application of the specified estimation procedure for each test case.\n\n**1. Synthetic Data Generation**\n\nThe foundation of the model is the planetary energy balance, which states that the rate of heat uptake by the planet, $N(t)$, is the difference between the incoming radiative forcing, $F(t)$, and the outgoing thermal radiation, which is parameterized as being proportional to the global mean surface temperature anomaly, $T(t)$. The constant of proportionality is the climate feedback parameter, $\\lambda$.\n$$\nN(t) = F(t) - \\lambda T(t)\n$$\nAll quantities are defined in the problem statement, with units of $\\mathrm{W\\,m^{-2}}$ for $N$ and $F$, $\\mathrm{K}$ for $T$, and $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ for $\\lambda$.\n\nWe first construct the time series for the total radiative forcing, $F(t)$, over the years $t \\in [1850, 2020]$. This forcing is the sum of three distinct components:\n- **Anthropogenic Forcing, $F_{\\mathrm{anth}}(t)$**: A linear ramp representing the growing influence of greenhouse gases. It is defined as $F_{\\mathrm{anth}}(t) = s_{\\mathrm{anth}}\\,(t-1850)$, where the slope $s_{\\mathrm{anth}} = 2.5 / 170 \\,\\mathrm{W\\,m^{-2}\\,yr^{-1}}$ ensures the forcing reaches $2.5\\,\\mathrm{W\\,m^{-2}}$ in $2020$.\n- **Aerosol Forcing, $F_{\\mathrm{aero}}(t)$**: A Gaussian-shaped negative forcing centered in the mid-20th century to represent the cooling effect of industrial aerosols. It is given by $F_{\\mathrm{aero}}(t) = -A \\exp(-\\frac{(t-\\mu)^2}{2\\sigma^2})$, with amplitude $A=0.8\\,\\mathrm{W\\,m^{-2}}$, mean year $\\mu=1960$, and standard deviation $\\sigma=12\\,\\mathrm{yr}$.\n- **Volcanic Forcing, $F_{\\mathrm{volc}}(t)$**: A series of sharp, negative forcing pulses that decay exponentially, mimicking the effect of major volcanic eruptions. The formula is $F_{\\mathrm{volc}}(t) = \\sum_{i} \\mathbf{1}_{t \\ge t_i}\\, M_i \\exp(-\\frac{t-t_i}{\\tau_v})$, where $t_i$ are the eruption years $\\{1883, 1902, 1963, 1982, 1991\\}$, $M_i$ are the corresponding amplitudes $\\{-1.2, -1.0, -0.8, -1.0, -1.2\\}\\,\\mathrm{W\\,m^{-2}}$, and $\\tau_v=1.5\\,\\mathrm{yr}$ is the decay timescale.\n\nThe total forcing is the sum: $F(t) = F_{\\mathrm{anth}}(t) + F_{\\mathrm{aero}}(t) + F_{\\mathrm{volc}}(t)$.\n\nNext, we generate the \"true\" historical temperature anomaly time series, $T_{\\mathrm{true}}(t)$, by numerically integrating a one-box energy balance model. The model's evolution is described by a forward-Euler discretization with an annual time step $\\Delta t = 1\\,\\mathrm{yr}$:\n$$\nT_{t+1} = T_t + \\frac{\\Delta t}{C}\\,\\Big(F_t - \\lambda_{\\mathrm{true}}\\,T_t\\Big)\n$$\nWe start with the initial condition $T_{1850} = 0\\,\\mathrm{K}$ and use the prescribed \"true\" feedback parameter $\\lambda_{\\mathrm{true}} = 1.20\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ and ocean mixed-layer heat capacity $C = 8.0\\,\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$.\n\nWith both $F(t)$ and $T_{\\mathrm{true}}(t)$ determined, the \"true\" planetary heat uptake, $N_{\\mathrm{true}}(t)$, is calculated from the energy balance equation: $N_{\\mathrm{true}}(t) = F(t) - \\lambda_{\\mathrm{true}}\\,T_{\\mathrm{true}}(t)$.\n\nFinally, to simulate observational uncertainty, we add zero-mean Gaussian noise to the true series. Using a fixed random seed of $42$ for reproducibility, we generate noise terms $\\varepsilon_T \\sim \\mathcal{N}(0, \\sigma_T^2)$ with $\\sigma_T=0.05\\,\\mathrm{K}$ and $\\varepsilon_N \\sim \\mathcal{N}(0, \\sigma_N^2)$ with $\\sigma_N=0.10\\,\\mathrm{W\\,m^{-2}}$. The final \"observed\" time series are:\n$$\nT_{\\mathrm{obs}}(t) = T_{\\mathrm{true}}(t) + \\varepsilon_T(t)\n$$\n$$\nN_{\\mathrm{obs}}(t) = N_{\\mathrm{true}}(t) + \\varepsilon_N(t)\n$$\n\n**2. Estimation of $\\lambda$ and ECS**\n\nThe second stage involves inferring the feedback parameter, $\\widehat{\\lambda}$, and the corresponding ECS from the \"observed\" data, following a specified procedure that varies for each test case. The underlying principle is to rearrange the energy balance equation into a form suitable for linear regression: $F(t) - N(t) = \\lambda T(t)$.\n\nFor each test case, defined by a parameter set $(b_0, b_1, \\tau, s)$:\n1.  The regression target variable is formed: $Y(t) = F(t) - N_{\\mathrm{obs}}(t)$. From the noisy data perspective, we expect $Y(t) \\approx \\lambda T_{\\mathrm{obs}}(t)$.\n2.  A baseline period $[b_0, b_1]$ is used to calculate a mean observed temperature, $\\overline{T}_{\\mathrm{obs}} = \\frac{1}{b_1 - b_0 + 1}\\sum_{t=b_0}^{b_1} T_{\\mathrm{obs}}(t)$.\n3.  The temperature data is converted to an anomaly relative to this baseline for all years: $T'(t) = T_{\\mathrm{obs}}(t) - \\overline{T}_{\\mathrm{obs}}$.\n4.  To simulate the effect of incomplete spatial coverage (e.g., masking polar regions), the temperature anomaly is scaled by a factor $s$: $T_s(t) = s\\,T'(t)$.\n5.  Data points corresponding to major volcanic eruptions are excluded from the regression. Any year $t$ for which the volcanic forcing magnitude $|F_{\\mathrm{volc}}(t)|$ is greater than or equal to a threshold $\\tau$ is removed from the dataset.\n6.  A linear regression of $Y(t)$ on $T_s(t)$ is performed through the origin using the remaining data points. The estimated feedback parameter, $\\widehat{\\lambda}$, is the slope of the regression line, which minimizes the sum of squared residuals $\\sum_t (Y(t) - \\widehat{\\lambda}\\,T_s(t))^2$. The analytical solution for this is:\n    $$\n    \\widehat{\\lambda} = \\frac{\\sum_t Y(t) \\cdot T_s(t)}{\\sum_t T_s(t)^2}\n    $$\n    where the sums are taken over all years not excluded by the volcanic filter.\n7.  The estimated Equilibrium Climate Sensitivity (ECS) is then calculated. ECS is the equilibrium temperature change for a sustained forcing of $F_{2\\times} = 3.71\\,\\mathrm{W\\,m^{-2}}$. At equilibrium, $N=0$, so $F_{2\\times} = \\widehat{\\lambda}\\,\\text{ECS}$. This gives:\n    $$\n    \\mathrm{ECS} = \\frac{F_{2\\times}}{\\widehat{\\lambda}}\n    $$\nThe program executes this entire procedure for each of the four test cases provided, reporting the resulting pair $[\\widehat{\\lambda}, \\mathrm{ECS}]$, rounded to three decimal places. The variation in the results across the cases will highlight the sensitivity of climate parameter estimation to common methodological choices.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Synthesizes a climate time series and quantifies how methodological decisions \n    affect inferred climate feedback and ECS.\n    \"\"\"\n    \n    # --------------------------------------------------------------------------\n    # Foundational base and definitions\n    # --------------------------------------------------------------------------\n    lambda_true = 1.20  # W m^-2 K^-1\n    C = 8.0             # W yr m^-2 K^-1\n    F_2x = 3.71         # W m^-2\n    delta_t = 1.0       # yr\n    \n    # Time axis\n    t_start, t_end = 1850, 2020\n    t_years = np.arange(t_start, t_end + 1)\n    num_years = len(t_years)\n\n    # --------------------------------------------------------------------------\n    # Synthetic data specification\n    # --------------------------------------------------------------------------\n    \n    # Component 1: Anthropogenic forcing\n    s_anth = 2.5 / 170.0\n    F_anth = s_anth * (t_years - 1850)\n\n    # Component 2: Aerosol forcing\n    A, mu, sigma = 0.8, 1960.0, 12.0\n    F_aero = -A * np.exp(-((t_years - mu)**2) / (2 * sigma**2))\n\n    # Component 3: Volcanic forcing\n    t_volc_i = [1883, 1902, 1963, 1982, 1991]\n    M_i = [-1.2, -1.0, -0.8, -1.0, -1.2]\n    tau_v = 1.5  # yr\n    F_volc = np.zeros(num_years)\n    for t_erupt, M in zip(t_volc_i, M_i):\n        # Apply forcing from the eruption year onwards\n        indices = t_years >= t_erupt\n        time_since_eruption = t_years[indices] - t_erupt\n        F_volc[indices] += M * np.exp(-time_since_eruption / tau_v)\n\n    # Total forcing\n    F_total = F_anth + F_aero + F_volc\n    \n    # Evolve true temperature T_true(t)\n    T_true = np.zeros(num_years)\n    T_true[0] = 0.0 # T_1850 = 0\n    for i in range(num_years - 1):\n        T_true[i+1] = T_true[i] + (delta_t / C) * (F_total[i] - lambda_true * T_true[i])\n\n    # Calculate true heat uptake N_true(t)\n    N_true = F_total - lambda_true * T_true\n\n    # Add observational noise\n    seed = 42\n    rng = np.random.default_rng(seed)\n    sigma_T = 0.05  # K\n    sigma_N = 0.10  # W m^-2\n    eps_T = rng.normal(0, sigma_T, num_years)\n    eps_N = rng.normal(0, sigma_N, num_years)\n    \n    T_obs = T_true + eps_T\n    N_obs = N_true + eps_N\n    \n    # --------------------------------------------------------------------------\n    # Estimation method loop for test suite\n    # --------------------------------------------------------------------------\n    \n    test_cases = [\n        # (b0, b1, tau, s)\n        (1850, 1869, 0.8, 1.0),    # Case A\n        (1961, 1990, 10.0, 1.0),   # Case B\n        (1981, 2010, 0.3, 0.85),   # Case C\n        (1931, 1960, 0.5, 0.70)    # Case D\n    ]\n    \n    results = []\n    \n    # Form the regression target Y(t), which is common to all cases\n    Y = F_total - N_obs\n    \n    for b0, b1, tau, s in test_cases:\n        # Compute baseline mean temperature\n        baseline_mask = (t_years >= b0)  (t_years = b1)\n        T_obs_mean = np.mean(T_obs[baseline_mask])\n        \n        # Define the anomaly and scale it\n        T_prime = T_obs - T_obs_mean\n        T_s = s * T_prime\n        \n        # Exclude volcanic years\n        regression_mask = np.abs(F_volc)  tau\n        \n        # Select data for regression\n        Y_reg = Y[regression_mask]\n        Ts_reg = T_s[regression_mask]\n        \n        # Perform linear regression through the origin\n        # lambda_hat = sum(x*y) / sum(x^2)\n        lambda_hat = np.sum(Y_reg * Ts_reg) / np.sum(Ts_reg**2)\n        \n        # Compute ECS\n        ecs_hat = F_2x / lambda_hat\n        \n        # Round and store results\n        results.append([round(lambda_hat, 3), round(ecs_hat, 3)])\n\n    # --------------------------------------------------------------------------\n    # Final output\n    # --------------------------------------------------------------------------\n    # Format the final list of lists into a string without spaces\n    output_str = '[' + ','.join([f\"[{l},{e}]\" for l, e in results]) + ']'\n    # print(output_str) # This would be printed by the program\n\nsolve()\n```",
            "answer": "```\n[[1.195,3.105],[1.150,3.226],[1.412,2.627],[1.714,2.165]]\n```"
        }
    ]
}