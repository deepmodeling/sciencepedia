{
    "hands_on_practices": [
        {
            "introduction": "The ultimate driver of Earth's climate is the Sun. This first exercise takes us back to fundamentals by deriving the spatial and temporal distribution of incoming solar radiation, or insolation, from first principles . By applying spherical trigonometry to the Earth-Sun geometry, you will develop a foundational expression that underpins all climate models, connecting planetary motion to the energy available to drive weather and climate.",
            "id": "4033595",
            "problem": "Consider a planet with Earth's rotation rate and geometry. In the absence of an atmosphere, the instantaneous top-of-atmosphere (TOA) shortwave irradiance incident on a local horizontal surface is proportional to the cosine of the solar zenith angle. Let the Total Solar Irradiance (TSI) at one astronomical unit be denoted by $S_0$ and assume it is constant over the duration of one solar day. Let latitude be denoted by $\\phi$, solar declination by $\\delta$, local hour angle by $h$ (zero at local solar noon), and the hour angle at sunset by $H_0$. All angles are to be treated in radians.\n\nStarting from first principles of spherical geometry for the Earth–Sun configuration and uniform planetary rotation, derive a closed-form analytic expression for the daily-mean TOA insolation $Q(\\phi,\\delta)$ at latitude $\\phi$ for a given solar declination $\\delta$ and hour angle at sunset $H_0$. Your derivation must:\n\n- Begin from the definition of daily-mean irradiance as a time average over one solar day, using the cosine of the solar zenith angle for the projection of the solar beam onto the local horizontal.\n- Use only fundamental geometric relations appropriate to the Earth–Sun system and the assumption of uniform rotation to change variables from time to hour angle.\n- Explicitly state all assumptions used, including those regarding planetary sphericity, absence of atmospheric effects, constancy of $S_0$ over the day, and treatment of polar day or night via the given $H_0$.\n\nExpress your final answer as a single closed-form analytic expression in terms of $S_0$, $\\phi$, $\\delta$, and $H_0$. No numerical evaluation is required. All angles must be in radians, and the daily-mean insolation must be expressed in watts per square meter. No rounding is required; provide the exact expression.",
            "solution": "The problem requires the derivation of a closed-form analytic expression for the daily-mean top-of-atmosphere (TOA) insolation, $Q(\\phi,\\delta)$, at a given latitude $\\phi$ and for a given solar declination $\\delta$. The derivation will proceed from first principles as stipulated.\n\nFirst, we define the daily-mean insolation, $Q$, as the total energy received per unit area over one solar day, divided by the duration of that day, $T_d$. One solar day corresponds to a $2\\pi$ rotation in hour angle. The instantaneous insolation on a horizontal surface, $I$, is the component of the Total Solar Irradiance ($S_0$) normal to that surface. This is given by $I = S_0 \\cos(\\theta_z)$, where $\\theta_z$ is the solar zenith angle. Insolation is non-zero only when the sun is above the horizon, i.e., when $\\cos(\\theta_z)  0$.\n\nThe daily-mean insolation is therefore the time average of the instantaneous insolation over a full solar day of duration $T_d$:\n$$ Q = \\frac{1}{T_d} \\int_{0}^{T_d} I(t) dt = \\frac{1}{T_d} \\int_{\\text{sunrise}}^{\\text{sunset}} S_0 \\cos(\\theta_z(t)) dt $$\nThe integral is taken over the daylight hours, from sunrise to sunset, as $I(t) = 0$ during the night.\n\nThe next step is to express the solar zenith angle, $\\theta_z$, in terms of the observer's latitude, $\\phi$, the solar declination, $\\delta$, and the local hour angle, $h$. Using the spherical law of cosines on the celestial sphere for the triangle formed by the celestial pole, the zenith, and the Sun, we obtain the fundamental relationship:\n$$ \\cos(\\theta_z) = \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h) $$\nThe hour angle $h$ is defined as zero at local solar noon and increases with time.\n\nThe planet is assumed to rotate at a uniform angular velocity, $\\Omega = 2\\pi/T_d$. The hour angle $h$ is related to time $t$ (measured from local noon) by $h = \\Omega t$. This allows for a change of variables in the integral from time $t$ to hour angle $h$. Differentiating gives $dh = \\Omega dt$, or $dt = \\frac{dh}{\\Omega}$. We can also express the period as $T_d = 2\\pi/\\Omega$. Substituting these into the expression for $Q$:\n$$ Q = \\frac{\\Omega}{2\\pi} \\int_{t_{\\text{sunrise}}}^{t_{\\text{sunset}}} S_0 \\cos(\\theta_z(t)) dt $$\nChanging the integration variable to $h$:\n$$ Q = \\frac{\\Omega}{2\\pi} \\int_{h_{\\text{sunrise}}}^{h_{\\text{sunset}}} S_0 (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) \\frac{dh}{\\Omega} $$\nThe hour angle at sunset is given as $H_0$. By symmetry, the hour angle at sunrise is $-H_0$. The integration limits in terms of hour angle are from $-H_0$ to $H_0$.\n$$ Q = \\frac{S_0}{2\\pi} \\int_{-H_0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\nThe integrand is an even function of $h$ because $\\cos(h) = \\cos(-h)$. Therefore, we can simplify the integral:\n$$ Q = 2 \\cdot \\frac{S_0}{2\\pi} \\int_{0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\n$$ Q = \\frac{S_0}{\\pi} \\int_{0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\nWe can now evaluate the integral by splitting it into two parts:\n$$ Q = \\frac{S_0}{\\pi} \\left[ \\int_{0}^{H_0} \\sin(\\phi)\\sin(\\delta) dh + \\int_{0}^{H_0} \\cos(\\phi)\\cos(\\delta)\\cos(h) dh \\right] $$\nThe first integral is:\n$$ \\int_{0}^{H_0} \\sin(\\phi)\\sin(\\delta) dh = \\sin(\\phi)\\sin(\\delta) [h]_{0}^{H_0} = H_0 \\sin(\\phi)\\sin(\\delta) $$\nThe second integral is:\n$$ \\int_{0}^{H_0} \\cos(\\phi)\\cos(\\delta)\\cos(h) dh = \\cos(\\phi)\\cos(\\delta) \\int_{0}^{H_0} \\cos(h) dh = \\cos(\\phi)\\cos(\\delta) [\\sin(h)]_{0}^{H_0} = \\cos(\\phi)\\cos(\\delta)\\sin(H_0) $$\nSubstituting these results back into the expression for $Q$:\n$$ Q(\\phi,\\delta) = \\frac{S_0}{\\pi} [H_0 \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\sin(H_0)] $$\nThis is the final closed-form analytic expression for the daily-mean TOA insolation.\n\nThe assumptions made in this derivation are as follows:\n1.  The planet is a perfect sphere, allowing for the use of spherical trigonometry.\n2.  There is no atmosphere, meaning no absorption, scattering, or refraction of incoming solar radiation.\n3.  The Total Solar Irradiance, $S_0$, is constant over the course of one solar day. This is a reasonable approximation as the planet's distance from the Sun changes very little in $24$ hours.\n4.  The solar declination, $\\delta$, is constant over the course of one solar day. This is also a valid approximation given the slow change of Earth's axial tilt relative to its orbital plane.\n5.  The planet rotates at a uniform angular velocity, $\\Omega$.\n6.  The hour angle at sunset, $H_0$, is a given parameter. This parameter encompasses the conditions for a normal day/night cycle ($0  H_0  \\pi$), continuous polar day ($H_0 = \\pi$), and continuous polar night ($H_0 = 0$). For $H_0 = 0$, the expression correctly yields $Q=0$. For $H_0 = \\pi$, the expression gives the insolation for a $24$-hour sunlit day.\n\nAll variables representing angles ($\\phi$, $\\delta$, $h$, $H_0$) are in radians, consistent with their use in the trigonometric functions and the integration process. The final expression has units of watts per square meter, inherited from $S_0$.",
            "answer": "$$\n\\boxed{\\frac{S_0}{\\pi} \\left( H_0 \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\sin(H_0) \\right)}\n$$"
        },
        {
            "introduction": "With an understanding of the energy input, we now turn to the climate system's response. This practice utilizes a simple, one-box Energy Balance Model (EBM) to explore the core dynamics of global temperature change . By solving the governing differential equation, you will derive fundamental concepts such as Equilibrium Climate Sensitivity ($S_{\\mathrm{eq}}$) and the transient climate response, gaining insight into how radiative feedbacks ($\\lambda$) and oceanic heat capacity ($C$) dictate the timescale and magnitude of global warming.",
            "id": "4033508",
            "problem": "Consider a globally averaged, one-box Energy Balance Model (EBM) for Earth's climate system, composed of an effective heat reservoir with heat capacity $C$ (units: $\\mathrm{J\\,m^{-2}\\,K^{-1}}$), coupled to the top-of-atmosphere radiative budget via a linear feedback parameter $\\lambda$ (units: $\\mathrm{W\\,m^{-2}\\,K^{-1}}$). Conservation of energy implies that the rate of change of the globally averaged surface air temperature anomaly $T(t)$ (units: $\\mathrm{K}$) satisfies $C\\,\\frac{dT}{dt} = N(t)$, where $N(t)$ (units: $\\mathrm{W\\,m^{-2}}$) is the net radiative imbalance. In a linear feedback framework, the net imbalance is given by $N(t) = F(t) - \\lambda\\,T(t)$, where $F(t)$ (units: $\\mathrm{W\\,m^{-2}}$) is the externally imposed radiative forcing. Assume $C  0$ and $\\lambda  0$. Let the radiative forcing increase smoothly from $0$ to a constant asymptotic amplitude $F_{\\infty}$ (units: $\\mathrm{W\\,m^{-2}}$) over a characteristic forcing timescale $\\tau_{f}  0$ (units: $\\mathrm{s}$), according to $F(t) = F_{\\infty}\\,\\big(1 - \\exp(-t/\\tau_{f})\\big)$ for $t \\ge 0$. The initial condition is $T(0) = 0$. Define the intrinsic climate response timescale $\\tau \\equiv C/\\lambda$ (units: $\\mathrm{s}$).\n\nStarting only from the physical principles stated above, derive:\n- The equilibrium climate sensitivity per unit forcing, defined as $S_{\\mathrm{eq}} \\equiv \\frac{dT_{\\mathrm{eq}}}{dF_{\\infty}}$ for a constant forcing amplitude $F_{\\infty}$ in the limit $t \\to \\infty$, expressed in $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$.\n- The exact transient global-mean temperature anomaly $T(t)$ (units: $\\mathrm{K}$) for $t \\ge 0$ under the specified forcing $F(t)$, in terms of $C$, $\\lambda$, $\\tau_{f}$, $F_{\\infty}$, and $t$.\n\nAssume the generic case $\\tau_{f} \\ne \\tau$. Provide closed-form analytic expressions. No numerical evaluation or rounding is required. Express the final sensitivity in $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$ and the transient temperature in $\\mathrm{K}$. For the final answer, write both results as a single row matrix in the order $\\big(S_{\\mathrm{eq}},\\,T(t)\\big)$.",
            "solution": "The model is governed by the global energy balance with linear feedback:\n$$\nC\\,\\frac{dT}{dt} \\;=\\; F(t) \\;-\\; \\lambda\\,T(t),\n$$\nwith $F(t) = F_{\\infty}\\,\\big(1 - \\exp(-t/\\tau_{f})\\big)$, $C  0$, $\\lambda  0$, and $T(0) = 0$. Define the intrinsic response timescale $\\tau \\equiv \\frac{C}{\\lambda}  0$. This ordinary differential equation is linear, first order, nonhomogeneous, with time-dependent forcing.\n\nEquilibrium climate sensitivity per unit forcing. At equilibrium under a constant forcing amplitude $F_{\\infty}$, the time derivative vanishes ($\\frac{dT}{dt} \\to 0$ as $t \\to \\infty$), and the net flux condition becomes\n$$\n0 \\;=\\; F_{\\infty} \\;-\\; \\lambda\\,T_{\\mathrm{eq}},\n$$\nso\n$$\nT_{\\mathrm{eq}} \\;=\\; \\frac{F_{\\infty}}{\\lambda}.\n$$\nThe equilibrium climate sensitivity per unit forcing is defined as\n$$\nS_{\\mathrm{eq}} \\;\\equiv\\; \\frac{dT_{\\mathrm{eq}}}{dF_{\\infty}} \\;=\\; \\frac{1}{\\lambda},\n$$\nwith units $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$. This shows the equilibrium sensitivity is set solely by the feedback strength and is independent of $C$.\n\nTransient solution. Rewrite the tendency equation in standard linear form:\n$$\n\\frac{dT}{dt} \\;+\\; \\frac{\\lambda}{C}\\,T \\;=\\; \\frac{F(t)}{C} \\;=\\; \\frac{F_{\\infty}}{C}\\,\\Big(1 - \\exp(-t/\\tau_{f})\\Big).\n$$\nThe integrating factor is\n$$\n\\mu(t) \\;=\\; \\exp\\!\\left(\\int \\frac{\\lambda}{C}\\,dt\\right) \\;=\\; \\exp\\!\\left(\\frac{\\lambda}{C}\\,t\\right) \\;=\\; \\exp\\!\\left(\\frac{t}{\\tau}\\right).\n$$\nMultiplying by $\\mu(t)$ and integrating from $0$ to $t$, using $T(0) = 0$, yields\n$$\nT(t) \\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\n\\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\Big(1 - \\exp(-s/\\tau_{f})\\Big)\\,ds.\n$$\nSplit the integral into two parts:\n$$\nI_{1}(t) \\;=\\; \\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,ds \\;=\\; \\tau\\,\\Big(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\Big),\n$$\nand\n$$\nI_{2}(t) \\;=\\; \\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,\\exp\\!\\left(-\\frac{s}{\\tau_{f}}\\right)\\,ds\n\\;=\\; \\int_{0}^{t} \\exp\\!\\left(s\\left(\\frac{1}{\\tau} - \\frac{1}{\\tau_{f}}\\right)\\right)\\,ds.\n$$\nDefine $\\alpha \\equiv \\frac{1}{\\tau} - \\frac{1}{\\tau_{f}}$. Under the stated generic case $\\tau_{f} \\ne \\tau$, we have $\\alpha \\ne 0$ and\n$$\nI_{2}(t) \\;=\\; \\frac{\\exp\\!\\left(\\alpha\\,t\\right) - 1}{\\alpha}.\n$$\nTherefore,\n$$\nT(t) \\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\Big[\\,I_{1}(t) - I_{2}(t)\\,\\Big]\n\\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\left[\\,\\tau\\left(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\right) \\;-\\; \\frac{\\exp\\!\\left(\\alpha\\,t\\right) - 1}{\\alpha}\\,\\right].\n$$\nSimplify term by term. First, $\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\tau\\left(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\right) = \\tau\\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)$. Next, observe\n$$\n\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\Big(\\exp\\!\\left(\\alpha\\,t\\right) - 1\\Big)\n\\;=\\; \\exp\\!\\left(t\\left(\\alpha - \\frac{1}{\\tau}\\right)\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n$$\nsince $\\alpha - \\frac{1}{\\tau} = -\\frac{1}{\\tau_{f}}$. Also, $\\alpha = \\frac{1}{\\tau} - \\frac{1}{\\tau_{f}} = \\frac{\\tau_{f} - \\tau}{\\tau\\,\\tau_{f}}$, so $\\frac{1}{\\alpha} = \\frac{\\tau\\,\\tau_{f}}{\\tau_{f} - \\tau}$. Putting these together,\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{C}\\,\\left[\\,\\tau\\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)\n\\;-\\; \\frac{\\tau\\,\\tau_{f}}{\\tau_{f} - \\tau}\\left(\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)\\,\\right].\n$$\nUsing $\\frac{F_{\\infty}}{C}\\,\\tau = \\frac{F_{\\infty}}{\\lambda}$ and $\\frac{F_{\\infty}}{C}\\,\\tau\\,\\tau_{f} = \\frac{F_{\\infty}\\,\\tau_{f}}{\\lambda}$,\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{\\lambda}\\,\\left[\\,1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\n\\;-\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)\n\\;+\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\right].\n$$\nCollecting the $\\exp\\!\\left(-\\frac{t}{\\tau}\\right)$ terms, the coefficient is $-1 + \\frac{\\tau_{f}}{\\tau_{f} - \\tau} = \\frac{\\tau}{\\tau_{f} - \\tau}$. Hence the compact form\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{\\lambda}\\,\\left[\\,1\n\\;-\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)\n\\;+\\; \\frac{\\tau}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\right],\n$$\nwhich explicitly demonstrates the dependence of the transient response on both the system heat capacity via $\\tau = C/\\lambda$ and the forcing timescale $\\tau_{f}$. In the limit $t \\to \\infty$, both exponentials vanish, recovering $T_{\\mathrm{eq}} = \\frac{F_{\\infty}}{\\lambda}$ and thereby $S_{\\mathrm{eq}} = \\frac{1}{\\lambda}$.\n\nUnits. The expression $S_{\\mathrm{eq}} = \\frac{1}{\\lambda}$ has units $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$, and $T(t)$ has units $\\mathrm{K}$, as required.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\lambda}  \\frac{F_{\\infty}}{\\lambda}\\left[1-\\frac{\\tau_{f}}{\\tau_{f}-\\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)+\\frac{\\tau}{\\tau_{f}-\\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right]\\end{pmatrix}}$$"
        },
        {
            "introduction": "Climate feedbacks are critical processes that can amplify or dampen the response to an initial forcing. This final exercise provides a practical, computational challenge focused on one of the most important positive feedbacks: the ice-albedo effect . You will implement a model to quantify how a change in temperature, by reducing snow cover, alters the surface albedo and increases the absorption of shortwave radiation, thereby providing a tangible measure of this key feedback's strength.",
            "id": "4033588",
            "problem": "Consider a midlatitude land region where the surface is a mosaic of snow and snow-free ground. The absorbed surface shortwave (SW) radiative flux is governed by conservation of energy and the definition of albedo. Under the assumptions of plane-parallel geometry, Lambertian reflection, linear subgrid mixing of reflectances, and no change in the incident radiation field or intrinsic optical properties with the specified warming, the absorbed surface SW can be obtained by integrating the downwelling spectral irradiance over the shortwave spectrum weighted by one minus the surface spectral albedo. The spectral dimension is discretized into a small number of bands to approximate this integral. A uniform warming modifies only the monthly snow cover fraction. The task is to compute the annual-mean change in absorbed surface SW due solely to the change in snow cover fraction under a uniform warming of magnitude $\\Delta T$, with all other inputs held fixed.\n\nInputs are provided for three test cases. In each case, the shortwave spectrum is discretized into $B=3$ bands: ultraviolet (band index $b=0$), visible ($b=1$), and near-infrared ($b=2$). The following definitions and data apply:\n\n- For month index $m \\in \\{0,1,\\dots,11\\}$ representing January through December, let $Q_m$ denote the monthly-mean downwelling broadband surface SW irradiance in $\\mathrm{W\\,m^{-2}}$. The monthly-mean surface downwelling spectral irradiance in band $b$ is $I_{m,b} = Q_m \\cdot w_b$, where $w_b$ are fixed band weights that sum to $1$.\n- Let $\\alpha_{\\mathrm{snow},b}$ and $\\alpha_{\\mathrm{ground},b}$ denote the spectral albedo of snow and snow-free ground, respectively, for band $b$ (dimensionless).\n- Let $f_m$ denote the monthly snow cover fraction (dimensionless) before warming. Under a uniform warming of magnitude $\\Delta T$ (in $\\mathrm{K}$), the snow fraction becomes $f'_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\}$, where $s$ is a prescribed constant sensitivity (change in snow fraction per unit temperature, in $\\mathrm{K^{-1}}$) applied uniformly in time, and the operation enforces the physically admissible bounds.\n- The mixed-pixel spectral albedo in band $b$ for month $m$ is $\\alpha_{m,b} = f_m \\,\\alpha_{\\mathrm{snow},b} + (1-f_m)\\,\\alpha_{\\mathrm{ground},b}$ before warming, and $\\alpha'_{m,b} = f'_m \\,\\alpha_{\\mathrm{snow},b} + (1-f'_m)\\,\\alpha_{\\mathrm{ground},b}$ after warming.\n- The monthly-mean absorbed surface SW before and after warming are $A_m = \\sum_{b=0}^{B-1} I_{m,b}\\,\\left(1-\\alpha_{m,b}\\right)$ and $A'_m = \\sum_{b=0}^{B-1} I_{m,b}\\,\\left(1-\\alpha'_{m,b}\\right)$, both in $\\mathrm{W\\,m^{-2}}$.\n- The annual-mean absorbed surface SW is obtained by time-averaging the monthly means using Gregorian month lengths $d_m$ (in days): $\\overline{A} = \\dfrac{\\sum_{m=0}^{11} d_m\\,A_m}{\\sum_{m=0}^{11} d_m}$ and $\\overline{A'} = \\dfrac{\\sum_{m=0}^{11} d_m\\,A'_m}{\\sum_{m=0}^{11} d_m}$. The required diagnostic is the annual-mean change in absorbed SW, $\\Delta \\overline{A} = \\overline{A'} - \\overline{A}$, expressed in $\\mathrm{W\\,m^{-2}}$.\n\nYour program must compute $\\Delta \\overline{A}$ for each of the following three test cases. For all cases use the Gregorian month lengths $d_m = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]$ (in days).\n\nCommon band weights and spectral albedos (apply to all test cases):\n- Band weights $w_b = [0.05, 0.50, 0.45]$ (dimensionless), ordered as ultraviolet, visible, near-infrared.\n- Snow spectral albedos $\\alpha_{\\mathrm{snow},b} = [0.90, 0.85, 0.55]$ (dimensionless).\n- Ground spectral albedos $\\alpha_{\\mathrm{ground},b} = [0.12, 0.20, 0.35]$ (dimensionless).\n\nTest case $1$ (seasonal snow, typical midlatitude):\n- Monthly $Q_m$ in $\\mathrm{W\\,m^{-2}}$: $[120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]$.\n- Monthly $f_m$ (dimensionless): $[0.60, 0.50, 0.40, 0.20, 0.05, 0.00, 0.00, 0.00, 0.05, 0.20, 0.40, 0.55]$.\n- Sensitivity $s = -0.08$ (in $\\mathrm{K^{-1}}$).\n- Warming magnitude $\\Delta T = 2.0$ (in $\\mathrm{K}$).\n\nTest case $2$ (snow-free midlatitude):\n- Monthly $Q_m$ in $\\mathrm{W\\,m^{-2}}$: $[120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]$.\n- Monthly $f_m$ (dimensionless): $[0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00]$.\n- Sensitivity $s = -0.08$ (in $\\mathrm{K^{-1}}$).\n- Warming magnitude $\\Delta T = 2.0$ (in $\\mathrm{K}$).\n\nTest case $3$ (snow-dominated midlatitude plateau):\n- Monthly $Q_m$ in $\\mathrm{W\\,m^{-2}}$: $[90, 130, 200, 260, 290, 300, 290, 260, 210, 160, 110, 80]$.\n- Monthly $f_m$ (dimensionless): $[0.95, 0.90, 0.85, 0.60, 0.20, 0.05, 0.05, 0.10, 0.40, 0.70, 0.85, 0.90]$.\n- Sensitivity $s = -0.06$ (in $\\mathrm{K^{-1}}$).\n- Warming magnitude $\\Delta T = 2.0$ (in $\\mathrm{K}$).\n\nRequirements:\n- Implement the computation as described, enforcing $f'_m \\in [0,1]$ by truncation at the bounds.\n- Express the final results $\\Delta \\overline{A}$ for each test case in $\\mathrm{W\\,m^{-2}}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,x_3]$), where $x_i$ are the three rounded values for test cases $1$, $2$, and $3$, respectively.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of radiative transfer and climate physics, is mathematically well-posed, internally consistent, and contains all necessary information to compute a unique solution.\n\nThe objective is to calculate the annual-mean change in absorbed surface shortwave (SW) radiation, denoted $\\Delta \\overline{A}$, resulting from a change in snow cover fraction due to a uniform warming $\\Delta T$. The required quantity is defined as:\n$$\n\\Delta \\overline{A} = \\overline{A'} - \\overline{A}\n$$\nwhere $\\overline{A}$ and $\\overline{A'}$ are the annual-mean absorbed surface SW before and after warming, respectively.\n\nThe annual mean is a linear operation. The change in the annual mean is equivalent to the annual mean of the monthly changes. Let $\\Delta A_m = A'_m - A_m$ be the change in absorbed SW for month $m$. Then, the annual-mean change is:\n$$\n\\Delta \\overline{A} = \\frac{\\sum_{m=0}^{11} d_m \\Delta A_m}{\\sum_{m=0}^{11} d_m}\n$$\nwhere $d_m$ is the number of days in month $m$.\n\nWe first derive an expression for the monthly change, $\\Delta A_m$. The monthly-mean absorbed SW before ($A_m$) and after ($A'_m$) warming are given by:\n$$\nA_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha_{m,b})\n$$\n$$\nA'_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha'_{m,b})\n$$\nwhere $I_{m,b}$ is the downwelling spectral irradiance in band $b$ for month $m$, and $\\alpha_{m,b}$ and $\\alpha'_{m,b}$ are the corresponding mixed-pixel spectral albedos. The incident radiation field $I_{m,b}$ is assumed to be unchanged by the warming.\n\nThe change $\\Delta A_m$ is therefore:\n$$\n\\Delta A_m = A'_m - A_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha'_{m,b}) - \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha_{m,b})\n$$\n$$\n\\Delta A_m = \\sum_{b=0}^{B-1} I_{m,b} \\left[ (1 - \\alpha'_{m,b}) - (1 - \\alpha_{m,b}) \\right] = \\sum_{b=0}^{B-1} I_{m,b} (\\alpha_{m,b} - \\alpha'_{m,b})\n$$\nThis shows that the change in absorbed radiation is driven by the change in surface albedo.\n\nNext, we express the change in albedo, $\\alpha_{m,b} - \\alpha'_{m,b}$, in terms of the change in snow cover fraction. The mixed-pixel spectral albedos are defined by linear mixing:\n$$\n\\alpha_{m,b} = f_m \\,\\alpha_{\\mathrm{snow},b} + (1-f_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha'_{m,b} = f'_m \\,\\alpha_{\\mathrm{snow},b} + (1-f'_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\nwhere $f_m$ and $f'_m$ are the snow cover fractions before and after warming. Subtracting these two equations yields:\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m)\\,\\alpha_{\\mathrm{snow},b} + ((1-f_m) - (1-f'_m))\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m)\\,\\alpha_{\\mathrm{snow},b} + (f'_m - f_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m) (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\nLet $\\Delta f_m = f'_m - f_m$. Then $f_m - f'_m = -\\Delta f_m$. The change in albedo becomes:\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = -\\Delta f_m (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\nA decrease in snow cover ($\\Delta f_m  0$) leads to a decrease in albedo, since $\\alpha_{\\mathrm{snow},b}  \\alpha_{\\mathrm{ground},b}$.\n\nSubstituting this expression back into the equation for $\\Delta A_m$:\n$$\n\\Delta A_m = \\sum_{b=0}^{B-1} I_{m,b} \\left[ -\\Delta f_m (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b}) \\right]\n$$\nSince $\\Delta f_m$ does not depend on the spectral band index $b$, we can factor it out of the summation:\n$$\n\\Delta A_m = -\\Delta f_m \\sum_{b=0}^{B-1} I_{m,b} (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\nUsing the definition $I_{m,b} = Q_m \\cdot w_b$, where $Q_m$ is the broadband irradiance and $w_b$ are the band weights:\n$$\n\\Delta A_m = -\\Delta f_m \\sum_{b=0}^{B-1} (Q_m \\cdot w_b) (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\nThe broadband irradiance $Q_m$ also does not depend on $b$ and can be factored out:\n$$\n\\Delta A_m = -Q_m \\cdot \\Delta f_m \\left[ \\sum_{b=0}^{B-1} w_b (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b}) \\right]\n$$\nThe term in the square brackets is a constant value determined by the fixed spectral properties of the surface and the incident radiation. Let us define this spectrally-weighted effective albedo difference as $\\Delta \\alpha_{\\text{eff}}$:\n$$\n\\Delta \\alpha_{\\text{eff}} = \\sum_{b=0}^{B-1} w_b (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\nUsing the provided common data:\n$w_b = [0.05, 0.50, 0.45]$, $\\alpha_{\\mathrm{snow},b} = [0.90, 0.85, 0.55]$, and $\\alpha_{\\mathrm{ground},b} = [0.12, 0.20, 0.35]$.\n$$\n\\Delta \\alpha_{\\text{eff}} = 0.05(0.90 - 0.12) + 0.50(0.85 - 0.20) + 0.45(0.55 - 0.35)\n$$\n$$\n\\Delta \\alpha_{\\text{eff}} = 0.05(0.78) + 0.50(0.65) + 0.45(0.20) = 0.039 + 0.325 + 0.090 = 0.454\n$$\nSo, the monthly change simplifies to:\n$$\n\\Delta A_m = -Q_m \\cdot \\Delta f_m \\cdot \\Delta \\alpha_{\\text{eff}}\n$$\nFinally, we can write the expression for the annual-mean change $\\Delta \\overline{A}$:\n$$\n\\Delta \\overline{A} = \\frac{\\sum_{m=0}^{11} d_m (-Q_m \\cdot \\Delta f_m \\cdot \\Delta \\alpha_{\\text{eff}})}{\\sum_{m=0}^{11} d_m} = - \\Delta \\alpha_{\\text{eff}} \\frac{\\sum_{m=0}^{11} d_m \\, Q_m \\, \\Delta f_m}{\\sum_{m=0}^{11} d_m}\n$$\nwhere $\\Delta f_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\} - f_m$. The total number of days in the year is $\\sum d_m = 365$.\n\nThe algorithm is as follows:\n1. Pre-compute the constant $\\Delta \\alpha_{\\text{eff}} = 0.454$ and total days in the year, $365$.\n2. For each test case, iterate through each month $m$ from $0$ to $11$:\n   a. Calculate the perturbed snow fraction $f'_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\}$.\n   b. Calculate the change in snow fraction $\\Delta f_m = f'_m - f_m$.\n3. Compute the weighted sum in the numerator: $\\sum_{m=0}^{11} d_m \\, Q_m \\, \\Delta f_m$.\n4. Calculate $\\Delta \\overline{A}$ using the final simplified formula.\n5. Round the result to three decimal places.\nThis simplified formulation is more computationally efficient and less prone to floating-point error than separately computing and subtracting the large totals for $\\overline{A'}$ and $\\overline{A}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the annual-mean change in absorbed surface shortwave radiation\n    due to changes in snow cover under a uniform warming scenario.\n    \"\"\"\n    \n    # Common data for all test cases\n    # Gregorian month lengths in days (non-leap year)\n    d_m = np.array([31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31])\n    total_days = np.sum(d_m)\n\n    # Band weights for UV, VIS, NIR\n    w_b = np.array([0.05, 0.50, 0.45])\n    \n    # Spectral albedos for snow\n    alpha_snow_b = np.array([0.90, 0.85, 0.55])\n    \n    # Spectral albedos for snow-free ground\n    alpha_ground_b = np.array([0.12, 0.20, 0.35])\n\n    # Pre-compute the spectrally-weighted effective albedo difference\n    # This term is constant across all cases and months.\n    delta_alpha_eff = np.sum(w_b * (alpha_snow_b - alpha_ground_b))\n\n    # Define the three test cases as a list of tuples.\n    # Each tuple contains: (monthly Q_m, monthly f_m, sensitivity s, warming delta_T)\n    test_cases = [\n        # Test case 1: seasonal snow, typical midlatitude\n        (\n            np.array([120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]),\n            np.array([0.60, 0.50, 0.40, 0.20, 0.05, 0.00, 0.00, 0.00, 0.05, 0.20, 0.40, 0.55]),\n            -0.08,\n            2.0\n        ),\n        # Test case 2: snow-free midlatitude\n        (\n            np.array([120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]),\n            np.array([0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00]),\n            -0.08,\n            2.0\n        ),\n        # Test case 3: snow-dominated midlatitude plateau\n        (\n            np.array([90, 130, 200, 260, 290, 300, 290, 260, 210, 160, 110, 80]),\n            np.array([0.95, 0.90, 0.85, 0.60, 0.20, 0.05, 0.05, 0.10, 0.40, 0.70, 0.85, 0.90]),\n            -0.06,\n            2.0\n        )\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Q_m, f_m, s, delta_T = case\n        \n        # Calculate the change in snow fraction due to warming\n        raw_change = s * delta_T\n        \n        # Calculate the new snow fraction, f'_m, enforcing the bounds [0, 1]\n        f_prime_m = np.clip(f_m + raw_change, 0, 1)\n        \n        # Calculate the month-by-month change in snow fraction, delta_f_m\n        delta_f_m = f_prime_m - f_m\n        \n        # Calculate the numerator of the final expression: sum over months of\n        # (days_in_month * irradiance * change_in_snow_fraction)\n        numerator_sum = np.sum(d_m * Q_m * delta_f_m)\n        \n        # Calculate the annual-mean change in absorbed SW using the simplified formula\n        # delta_A_bar = -delta_alpha_eff * (numerator / total_days)\n        # A negative delta_f_m (less snow) leads to a positive delta_A_bar (more absorption).\n        delta_A_bar = -delta_alpha_eff * numerator_sum / total_days\n        \n        # Append the rounded result to the list\n        results.append(round(delta_A_bar, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}