{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在探究平流层化学与气候之间的直接反馈。通过模拟极冠温度对臭氧恢复产生的非绝热加热的响应，学生将在一个简化但功能强大的情境中应用热力学能量方程。这项实践有助于学生建立对极地平流层中化学变化如何驱动温度动态的基础理解。",
            "id": "4076299",
            "problem": "在一个与数值天气预报和气候模拟相关的简化平流层极盖柱状模型中，考虑冬末时期动力学孤立的平流层低层极盖（$60^{\\circ}$–$90^{\\circ}\\mathrm{N}$）。假设春季臭氧恢复在极盖上产生一个量值为 $H=1.5\\ \\mathrm{K\\,day^{-1}}$ 的均匀非绝热加热异常，持续时间为 $t_{d}=5\\ \\mathrm{days}$。该柱对温度异常的净辐射响应由线性牛顿冷却表示，其辐射阻尼时间尺度为 $\\tau_{\\mathrm{rad}}=20\\ \\mathrm{days}$，作用于极盖平均温度异常。假设极盖平均异常在 $t=0$ 时初始为零，并且由于涡旋的孤立性，在此时间尺度上，水平平流和垂直运动趋势在极盖上平均为零，因此温度趋势由非绝热加热和线性辐射阻尼主导。\n\n从气压坐标系下干空气的热力学能量方程出发，并利用辐射通量散度相对于气候态的标准线性化，推导控制极盖平均温度异常 $T^{\\prime}(t)$ 的预报性常微分方程，并在给定的初始条件下求解。然后，计算在 $t=t_{d}$ 时产生的极盖平均温度变化。\n\n将您的最终答案表示为一个以开尔文为单位的实数，并将答案四舍五入到四位有效数字。在您的计算过程中使用单位 $\\mathrm{K}$，但在最终方框内的数值答案中不要包含单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 非绝热加热异常量值：$H=1.5\\ \\mathrm{K\\,day^{-1}}$。\n- 加热持续时间：$t_{d}=5\\ \\mathrm{days}$。\n- 极盖平均温度异常的辐射阻尼时间尺度：$\\tau_{\\mathrm{rad}}=20\\ \\mathrm{days}$。\n- 初始条件：极盖平均温度异常 $T^{\\prime}(t)$ 在时间 $t=0$ 时为零，即 $T^{\\prime}(0)=0$。\n- 控制动力学：所述的极盖平均温度异常的趋势由指定的非绝热加热和线性辐射阻尼主导，因为其他动力学效应（如水平平流和垂直运动趋势）在孤立的极盖上平均为零。\n\n**步骤 2：已知条件验证**\n- **科学依据**：该问题牢固地植根于大气热力学，并且是气候动力学中使用的标准简化。由于臭氧光化学引起的非绝热加热、作为辐射传输线性化的牛顿冷却以及极地涡旋的孤立性等概念都是平流层动力学中基本且科学合理的原理。所提供的 $H$ 和 $\\tau_{\\mathrm{rad}}$ 的数值在指定的平流层低层背景下是物理上合理的。\n- **适定性**：该问题在数学上是适定的。它要求对一个一阶线性常微分方程建立并求解一个初值问题。其结构保证了在给定条件下存在唯一且稳定的解。\n- **客观性**：问题陈述是精确、定量的，并且没有任何主观或模糊的语言。\n\n**步骤 3：结论**\n该问题被认为是科学上合理、一致且适定的。因此是**有效的**。现在开始求解过程。\n\n**控制方程的推导**\n\n气压坐标系下干空气的热力学能量方程描述了温度 $T$ 的变化率。根据问题陈述，在对极盖进行平均和简化后，动力输送项（水平平流和垂直运动）被假定平均为零。因此，极盖平均温度异常 $T^{\\prime}$ 的演变仅由指定的非绝热过程控制。\n\n温度异常的变化率 $\\frac{dT^{\\prime}}{dt}$ 是非绝热加热趋势和辐射冷却趋势之和。\n\n非绝热加热被给定为一个恒定强迫 $H$。\n辐射响应被描述为线性牛顿冷却，这意味着辐射阻尼率与温度异常本身成正比。因此，该冷却趋势由 $-\\frac{T^{\\prime}}{\\tau_{\\mathrm{rad}}}$ 给出。负号表示正（暖）异常会引起冷却。\n\n结合这些项，我们得到 $T^{\\prime}(t)$ 的预报性常微分方程（ODE）：\n$$ \\frac{dT^{\\prime}}{dt} = H - \\frac{T^{\\prime}}{\\tau_{\\mathrm{rad}}} $$\n该方程在 $0 \\le t \\le t_d$ 期间有效。\n\n**常微分方程的求解**\n\n为了求解这个ODE，我们将其整理成一阶线性微分方程的标准形式：\n$$ \\frac{dT^{\\prime}}{dt} + \\frac{1}{\\tau_{\\mathrm{rad}}}T^{\\prime} = H $$\n我们使用积分因子法来求解此方程。积分因子 $I(t)$ 由下式给出：\n$$ I(t) = \\exp\\left(\\int \\frac{1}{\\tau_{\\mathrm{rad}}} \\, dt\\right) = \\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) $$\n将ODE两边乘以 $I(t)$：\n$$ \\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right)\\frac{dT^{\\prime}}{dt} + \\frac{1}{\\tau_{\\mathrm{rad}}}\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right)T^{\\prime} = H\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) $$\n左边是乘积 $T^{\\prime}(t)I(t)$ 的导数：\n$$ \\frac{d}{dt}\\left(T^{\\prime}(t)\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right)\\right) = H\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) $$\n对两边关于 $t$ 积分：\n$$ \\int \\frac{d}{dt}\\left(T^{\\prime}(t)\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right)\\right) dt = \\int H\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) dt $$\n$$ T^{\\prime}(t)\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) = H\\tau_{\\mathrm{rad}}\\exp\\left(\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) + C $$\n其中 $C$ 是积分常数。求解 $T^{\\prime}(t)$ 得到通解：\n$$ T^{\\prime}(t) = H\\tau_{\\mathrm{rad}} + C\\exp\\left(-\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) $$\n我们通过应用初始条件 $T^{\\prime}(0) = 0$ 来确定常数 $C$：\n$$ 0 = H\\tau_{\\mathrm{rad}} + C\\exp(0) $$\n$$ 0 = H\\tau_{\\mathrm{rad}} + C $$\n$$ C = -H\\tau_{\\mathrm{rad}} $$\n将此代回通解，得到温度异常的特解：\n$$ T^{\\prime}(t) = H\\tau_{\\mathrm{rad}} - H\\tau_{\\mathrm{rad}}\\exp\\left(-\\frac{t}{\\tau_{\\mathrm{rad}}}\\right) $$\n这可以更紧凑地写为：\n$$ T^{\\prime}(t) = H\\tau_{\\mathrm{rad}}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{\\mathrm{rad}}}\\right)\\right) $$\n\n**最终温度异常的计算**\n\n我们被要求计算在时间 $t = t_d = 5\\ \\mathrm{days}$ 时的温度异常。我们将给定的值代入解中：\n$H = 1.5\\ \\mathrm{K\\,day^{-1}}$\n$\\tau_{\\mathrm{rad}} = 20\\ \\mathrm{days}$\n$t_d = 5\\ \\mathrm{days}$\n\n$$ T^{\\prime}(t_d) = (1.5) \\times (20) \\times \\left(1 - \\exp\\left(-\\frac{5}{20}\\right)\\right) $$\n正如预期的那样，单位是一致的（$\\mathrm{K\\,day^{-1}} \\times \\mathrm{days} = \\mathrm{K}$）。\n$$ T^{\\prime}(t_d) = 30 \\left(1 - \\exp\\left(-\\frac{1}{4}\\right)\\right) $$\n$$ T^{\\prime}(t_d) = 30 \\left(1 - \\exp(-0.25)\\right) $$\n现在，我们计算数值：\n$$ \\exp(-0.25) \\approx 0.77880078 $$\n$$ T^{\\prime}(t_d) \\approx 30 \\times (1 - 0.77880078) $$\n$$ T^{\\prime}(t_d) \\approx 30 \\times 0.22119922 $$\n$$ T^{\\prime}(t_d) \\approx 6.6359766\\ \\mathrm{K} $$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 $9$，所以我们将第四位向上取整。\n$$ T^{\\prime}(t_d) \\approx 6.636\\ \\mathrm{K} $$",
            "answer": "$$\\boxed{6.636}$$"
        },
        {
            "introduction": "有效的气候模拟需要理解不同物理过程的相对时间尺度。本练习引入了达姆科勒数（Damköhler number）这一关键的无量纲参数，用以比较化学反应与大气输送的速率。通过计算典型极地涡旋情景下的该数值，学生将深入了解在耦合快速化学过程与较慢动力学过程时出现的数值挑战，例如刚性问题。",
            "id": "4076306",
            "problem": "一个嵌入在全球数值天气预报（NWP）和气候框架中的平流层化学输送模型被用来模拟晚冬期间$50\\ \\mathrm{hPa}$高度上平流层极地涡旋（SPV）内的臭氧（$\\mathrm{O}_{3}$）。考虑一个被动反应示踪剂$\\chi$，其变化由示踪剂连续性方程控制，该方程包含大尺度平流和代表氯催化臭氧消耗的一阶化学损失：\n$$\n\\frac{\\partial \\chi}{\\partial t} + \\nabla \\cdot (\\chi \\mathbf{u}) = P - L,\n$$\n其中，在涡旋内部$P \\approx 0$，损失项$L = k \\chi$，这里$k$是一个与非均相活化和随后的光化学损失相关的正的一阶速率常数。设特征输送时间尺度为$\\tau_{\\mathrm{transport}}$，化学时间尺度为$\\tau_{\\mathrm{chem}}$，且$\\tau_{\\mathrm{chem}} = 1/k$。\n\n从示踪剂连续性方程和使用特征水平长度尺度$L_{\\mathrm{char}}$与速度尺度$U$的无量綱化概念出发，定义一个无量綱参数，用于衡量在$50\\ \\mathrm{hPa}$高度的SPV中输送与化学过程的相对主导地位，并用$\\tau_{\\mathrm{transport}}$和$\\tau_{\\mathrm{chem}}$表示它。此参数被称为Damköhler数（Da）。当$\\tau_{\\mathrm{transport}} = 10$天且$\\tau_{\\mathrm{chem}} = 1$小时，计算此参数的值，注意使用一致的单位。\n\n然后，基于耦合平流-反应系统中算子分裂（OS）的基本原理，讨论计算出的无量綱参数对典型气候模型时间步进中的数值刚性和分裂误差的影响，包括在模拟强涡旋限制下的极地臭氧损失时，化学过程是否应该进行子循环或隐式处理。\n\n将无量纲参数的数值报告为一个精确的整数，无需四舍五入。将该值表示为一个无量纲数。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **控制方程：** 被动反应示踪剂$\\chi$的示踪剂连续性方程为$\\frac{\\partial \\chi}{\\partial t} + \\nabla \\cdot (\\chi \\mathbf{u}) = P - L$。\n-   **源/汇项：** 在平流层极地涡旋（SPV）内部，生成项$P \\approx 0$。损失项是一阶化学过程，$L = k \\chi$，其中$k$是一个正的一阶速率常数。\n-   **特征时间尺度：** 特征输送时间尺度为$\\tau_{\\mathrm{transport}}$，化学时间尺度为$\\tau_{\\mathrm{chem}} = 1/k$。\n-   **无量纲化尺度：** 使用特征水平长度尺度$L_{\\mathrm{char}}$和特征速度尺度$U$。\n-   **数值：** $\\tau_{\\mathrm{transport}} = 10 \\ \\mathrm{days}$且$\\tau_{\\mathrm{chem}} = 1 \\ \\mathrm{hour}$。\n-   **任务：** 定义一个衡量输送与化学相对主导地位的无量纲参数（Damköhler数，Da），用$\\tau_{\\mathrm{transport}}$和$\\tau_{\\mathrm{chem}}$表示它，计算其数值，并讨论其对数值模拟的影响。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学基础（关键）：** 该问题在科学上是合理的。示踪剂连续性方程是流体动力学和大气科学的基本原理。一阶损失项$L = k\\chi$是某些化学反应（包括极地平流层臭氧损失的简化模型）的标准且物理上合理的参数化方法。输送和化学时间尺度、无量纲化以及Damköhler数的概念都是化学反应工程和地球物理流体动力学中的标准工具。在稳定极地涡旋内快速臭氧损失的情景是一个已被充分证实的现象。\n-   **良态性：** 该问题是良态的。它要求基于结果进行推导、计算和讨论。推导和计算所需的所有信息都已提供。讨论是数值模拟领域的标准分析任务。\n-   **客观性（关键）：** 该问题以精确、客观和技术性的语言陈述，没有任何主观性或偏见。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学依据、良态且客观。将提供一个解答。\n\n***\n\n解决方案分为三部分：首先，从控制方程推导Damköhler数；其次，进行数值计算；第三，讨论对数值模拟的影响。\n\n**第1部分：Damköhler数的推导**\n\n我们从问题陈述中给出的示踪剂连续性方程开始。将给定的生成 ($P \\approx 0$) 和损失 ($L = k\\chi$) 项代入，SPV内部示踪剂$\\chi$的方程变为：\n$$\n\\frac{\\partial \\chi}{\\partial t} + \\nabla \\cdot (\\chi \\mathbf{u}) = -k \\chi\n$$\n为了确定控制系统行为的无量纲参数，我们对此方程进行无量纲化。我们引入以下用撇号（$'$）表示的无量纲变量：\n-   时间：$t' = \\frac{t}{t_{\\mathrm{ref}}}$\n-   空间坐标：$\\mathbf{x}' = \\frac{\\mathbf{x}}{L_{\\mathrm{char}}}$\n-   速度场：$\\mathbf{u}' = \\frac{\\mathbf{u}}{U}$\n-   示踪剂浓度：$\\chi' = \\frac{\\chi}{\\chi_{\\mathrm{ref}}}$\n\n在这里，$L_{\\mathrm{char}}$是特征长度尺度，$U$是特征速度尺度，$\\chi_{\\mathrm{ref}}$是参考浓度。参考时间尺度$t_{\\mathrm{ref}}$应根据一个特征过程来选择。问题提到了一个特征输送时间尺度$\\tau_{\\mathrm{transport}}$，即流体质块被平流输送过特征长度尺度所需的时间。因此，我们定义$\\tau_{\\mathrm{transport}} \\equiv \\frac{L_{\\mathrm{char}}}{U}$并设置我们的参考时间尺度$t_{\\mathrm{ref}} = \\tau_{\\mathrm{transport}}$。\n\n我们现在变换控制方程中的导数和项：\n-   $\\frac{\\partial}{\\partial t} = \\frac{\\partial t'}{\\partial t} \\frac{\\partial}{\\partial t'} = \\frac{1}{\\tau_{\\mathrm{transport}}} \\frac{\\partial}{\\partial t'}$\n-   $\\nabla = \\frac{1}{L_{\\mathrm{char}}} \\nabla'$\n\n将这些代入连续性方程：\n$$\n\\frac{1}{\\tau_{\\mathrm{transport}}} \\frac{\\partial (\\chi_{\\mathrm{ref}} \\chi')}{\\partial t'} + \\frac{1}{L_{\\mathrm{char}}} \\nabla' \\cdot ((\\chi_{\\mathrm{ref}} \\chi') (U \\mathbf{u}')) = -k (\\chi_{\\mathrm{ref}} \\chi')\n$$\n假设$\\chi_{\\mathrm{ref}}$为常数，我们可以用它除以整个方程：\n$$\n\\frac{1}{\\tau_{\\mathrm{transport}}} \\frac{\\partial \\chi'}{\\partial t'} + \\frac{U}{L_{\\mathrm{char}}} \\nabla' \\cdot (\\chi' \\mathbf{u}') = -k \\chi'\n$$\n根据我们对输送时间尺度的定义，$\\frac{U}{L_{\\mathrm{char}}} = \\frac{1}{\\tau_{\\mathrm{transport}}}$。代入这个关系式得到：\n$$\n\\frac{1}{\\tau_{\\mathrm{transport}}} \\left( \\frac{\\partial \\chi'}{\\partial t'} + \\nabla' \\cdot (\\chi' \\mathbf{u}') \\right) = -k \\chi'\n$$\n为了使方程完全无量纲化，我们将所有项乘以$\\tau_{\\mathrm{transport}}$：\n$$\n\\frac{\\partial \\chi'}{\\partial t'} + \\nabla' \\cdot (\\chi' \\mathbf{u}') = -(k \\cdot \\tau_{\\mathrm{transport}}) \\chi'\n$$\n右侧的无量纲群$k \\cdot \\tau_{\\mathrm{transport}}$量化了化学损失相对于输送过程的强度。这就是Damköhler数，记为$Da$。\n问题还定义了化学时间尺度为$\\tau_{\\mathrm{chem}} = 1/k$。使用此定义，我们可以将Damköhler数表示为两个特征时间尺度的比率：\n$$\nDa = k \\cdot \\tau_{\\mathrm{transport}} = \\frac{\\tau_{\\mathrm{transport}}}{\\tau_{\\mathrm{chem}}}\n$$\n这个无量纲数代表输送速率与反应速率之比。如果$Da \\gg 1$，化学反应远快于输送，化学过程占主导地位。如果$Da \\ll 1$，输送远快于化学反应，输送动力学占主导地位。\n\n**第2部分：Damköhler数的数值计算**\n\n我们已知以下数值：\n-   $\\tau_{\\mathrm{transport}} = 10 \\ \\mathrm{days}$\n-   $\\tau_{\\mathrm{chem}} = 1 \\ \\mathrm{hour}$\n\n为了计算无量纲比率$Da$，两个时间尺度必须使用一致的单位。我们将天转换为小时，使用换算关系$1 \\ \\mathrm{day} = 24 \\ \\mathrm{hours}$。\n$$\n\\tau_{\\mathrm{transport}} = 10 \\ \\mathrm{days} \\times \\frac{24 \\ \\mathrm{hours}}{1 \\ \\mathrm{day}} = 240 \\ \\mathrm{hours}\n$$\n现在我们可以计算Damköhler数：\n$$\nDa = \\frac{\\tau_{\\mathrm{transport}}}{\\tau_{\\mathrm{chem}}} = \\frac{240 \\ \\mathrm{hours}}{1 \\ \\mathrm{hour}} = 240\n$$\nDamköhler数的数值为$240$。\n\n**第3部分：对数值模拟的影响**\n\n计算出的Damköhler数$Da = 240$是一个很大的数（$Da \\gg 1$）。这表明化学时间尺度（$\\tau_{\\mathrm{chem}} = 1 \\ \\mathrm{hour}$）远短于输送时间尺度（$\\tau_{\\mathrm{transport}} = 10 \\ \\mathrm{days}$）。这种时间尺度的深刻分离对控制方程的数值积分有关键影响，尤其是在算子分裂的背景下。\n\n1.  **数值刚性：** 一个以时间尺度差异巨大为特征的微分方程组被称为刚性系统。快速的化学损失在解中引入了一个快速衰减的模态。一个标准的显式时间步进格式（例如，前向欧拉法、龙格-库塔法）将被迫使用一个与最快时间尺度相当的时间步长$\\Delta t$（$\\Delta t \\ll \\tau_{\\mathrm{chem}}$）来维持数值稳定性。在气候模型中，动力核心（平流）通常使用由CFL条件决定的更长的时间步长$\\Delta t_{dyn}$（例如，$15-60$分钟）。对整个耦合系统使用非常小的$\\Delta t$在计算上是不可行的。$Da=240$这个值明确地将该问题归类为数值刚性问题。\n\n2.  **算子分裂（OS）误差：** 实践中，像这样的耦合系统通常使用算子分裂来求解，即在一个时间步长$\\Delta t$内顺序地积分平流和化学过程。\n    $$\n    \\frac{\\partial \\chi}{\\partial t} = \\mathcal{A}(\\chi) + \\mathcal{C}(\\chi)\n    $$\n    这里，$\\mathcal{A}$是平流算子，$\\mathcal{C}$是化学算子。分裂误差取决于这些算子的非对易性，即$[ \\mathcal{A}, \\mathcal{C} ] = \\mathcal{A}\\mathcal{C} - \\mathcal{C}\\mathcal{A}$。对于刚性系统（$Da \\gg 1$），示踪剂浓度$\\chi$在一个平流步长内可能因化学作用而发生显著变化。这使得算子高度非对易，可能导致巨大的分裂误差。被平流输送的状态与经历反应的状态显著不同，反之亦然，如果处理不当，会损害模拟的准确性。\n\n3.  **数值格式的选择：** 鉴于问题的刚性，如果模型时间步长$\\Delta t$与$\\tau_{\\mathrm{chem}}$相当或更大，那么对化学项进行显式处理是不明智的。处理这种刚性问题主要有两种策略：\n    -   **隐式处理：** 对于这种刚性损失项，最稳健且高效的方法是使用隐式或半隐式求解器来处理化学步骤。对于简单的一阶损失方程$\\frac{d\\chi}{dt} = -k\\chi$，后向欧拉格式给出$\\chi^{n+1} = \\chi^n / (1 + k \\Delta t)$。该格式对于任何$\\Delta t > 0$都是无条件稳定的。因此，隐式处理化学过程允许使用由平流决定的更大时间步长$\\Delta t_{dyn}$，而不会因快速化学反应而导致不稳定。这是现代化学-气候模型中处理刚性反应的标准方法。\n    -   **子循环：** 另一种方法是对化学算子进行子循环。在一个大的动力学时间步长$\\Delta t_{dyn}$内，化学方程以多个较小的时间步长$\\Delta t_{chem}$进行求解，使得$\\Delta t_{chem} \\ll \\tau_{\\mathrm{chem}}$。这允许为化学过程使用简单的显式求解器。然而，这增加了计算成本，并且如果与平流的耦合很强，仍可能存在不准确性。对于非常刚性的系统，隐式方法通常在稳定性和效率上都更优越。\n\n总之，在模拟$Da \\gg 1$的强涡旋限制下的极地臭氧损失时，必须将化学项识别为刚性项，并使用数值稳定的方法进行处理。基于基本原理的明确建议是在算子分裂框架内隐式求解化学过程，以确保在使用计算上可行的模型时间步长的同时，保证稳定性和准确性。",
            "answer": "$$\n\\boxed{240}\n$$"
        },
        {
            "introduction": "最后的这项实践将本章的概念综合到一个实际的编程练习中。学生将构建一个简化模型，利用合成数据模拟极地平流层云（PSC）和南极臭氧洞的季节性演变。这个动手任务将强化从低温到PSC形成再到随后的化学臭氧消耗这一因果链的理解，同时培养关键的计算和数据分析技能。",
            "id": "4076321",
            "problem": "构建一个程序，用于计算南极洲上空极地平流层云（PSC）体积的时间序列，及其与一个季节内臭氧洞面积在受控合成情景下的相关性。该程序必须使用下述定义和基本关系，实现以下功能。\n\n定义和域构建：\n- 极地平流层云（PSC）定义为温度低于三水合硝酸（NAT）阈值温度的平流层空气。使用一个简单的阈值标准：$T_{\\mathrm{NAT}} = 195$ 开尔文。\n- 南极域是指纬度低于 $-60$ 度的所有网格单元。\n- 使用球形地球，半径 $R = 6\\,371\\,000$ 米。\n- 通过纬度、经度和几何高度的单元边缘定义一个直线网格：\n  - 纬度边缘（度）：$\\{-90,-75,-60\\}$\n  - 经度边缘（度）：$\\{0,120,240,360\\}$\n  - 垂直边缘（米）：$\\{15000,20000,25000,30000\\}$\n  这将产生 $2$ 个纬度带、$3$ 个经度扇区和 $3$ 个垂直层，每层厚度为 $5\\,000$ 米。\n- 设季节有 $N_t = 8$ 个等间隔的时间步长，索引为 $t \\in \\{0,1,\\dots,7\\}$。\n\n基本依据和所需计算：\n1. 根据单元边缘计算球面单元面积：\n   - 设纬度边缘为 $\\varphi_1$ 和 $\\varphi_2$（以弧度为单位），经度边缘为 $\\lambda_1$ 和 $\\lambda_2$（以弧度为单位）。球体上一个纬度-经度单元的精确球面面积为\n     $$ A_{\\mathrm{cell}} = R^2 \\left|\\sin(\\varphi_2) - \\sin(\\varphi_1)\\right| \\left|\\lambda_2 - \\lambda_1\\right|. $$\n   - 三角函数的角度输入必须转换为弧度。\n2. 顶部为 $z_{k+1}$、底部为 $z_k$ 的层的网格单元几何体积为\n   $$ V_{\\mathrm{cell},k} = A_{\\mathrm{cell}} \\cdot (z_{k+1}-z_k). $$\n3. $t$ 时刻的 PSC 体积是离散和\n   $$ V_{\\mathrm{PSC}}(t) = \\sum_{i,j,k \\in \\mathcal{D}} \\mathbf{1}\\left(T(t,i,j,k)  T_{\\mathrm{NAT}}\\right) \\, V_{\\mathrm{cell},k}, $$\n   其中 $\\mathcal{D}$ 是所有纬度中心低于 $-60$ 度的网格单元集合，$\\mathbf{1}(\\cdot)$ 是指示函数。\n4. $t$ 时刻的臭氧洞面积是离散和\n   $$ A_{\\mathrm{O_3}}(t) = \\sum_{i,j \\in \\mathcal{D}_{2D}} \\mathbf{1}\\left(O_3(t,i,j)  O_{\\mathrm{th}}\\right) \\, A_{\\mathrm{cell}}, $$\n   其中 $\\mathcal{D}_{2D}$ 是纬度中心低于 $-60$ 度的水平单元，$O_3$ 是总臭氧柱浓度，单位为多布森单位（Dobson Unit (DU)），$O_{\\mathrm{th}} = 220$ DU 是臭氧洞阈值。\n5. 整个季节的相关性评估使用两个时间序列 $\\{V_{\\mathrm{PSC}}(t)\\}_{t=0}^{N_t-1}$ 和 $\\{A_{\\mathrm{O_3}}(t)\\}_{t=0}^{N_t-1}$ 之间的皮尔逊积矩相关系数：\n   $$ r = \\frac{\\mathrm{cov}(V_{\\mathrm{PSC}}, A_{\\mathrm{O_3}})}{\\sigma_{V} \\, \\sigma_{A}}, $$\n   其中 $\\mathrm{cov}$ 是跨时间的均值中心化协方差，$\\sigma_V$ 和 $\\sigma_A$ 是两个序列跨时间的标准差。如果 $\\sigma_V = 0$ 或 $\\sigma_A = 0$，根据本任务的约定，定义 $r = 0$。\n\n合成场和季节构建：\n- 设 $t \\in \\{0,\\dots,7\\}$，纬度中心 $\\phi_i$ 是纬度边缘的中点，经度中心 $\\lambda_j$ 是经度边缘的中点，垂直层由 $k \\in \\{0,1,2\\}$ 索引。\n- 将基准垂直温度剖面 $T_{0,k}$（开尔文）定义为 $T_{0,0} = 200$，$T_{0,1} = 197$，$T_{0,2} = 194$。\n- 定义一个与距 $-60$ 度极地距离成正比的经向冷却，系数为 $\\beta = 0.2$ 开尔文/度：\n  $$ \\Delta T_{\\phi}(i) = -\\beta \\left(|\\phi_i| - 60\\right). $$\n- 定义一个振幅为 $\\delta = 1$ 开尔文的弱经向定常波：\n  $$ \\Delta T_{\\lambda}(j) = \\delta \\cos\\left(\\lambda_j \\cdot \\frac{\\pi}{180}\\right). $$\n- 定义一个振幅为 $A$（开尔文）、周期为 $N_t$ 的季节性正弦波：\n  $$ \\Delta T_t(t) = -A \\sin\\left(2\\pi \\frac{t}{N_t}\\right). $$\n- 完整的温度场为\n  $$ T(t,i,j,k) = T_{0,k} + \\Delta T_{\\phi}(i) + \\Delta T_{\\lambda}(j) + \\Delta T_t(t). $$\n- 通过对三层冷偏差进行积分，定义每个水平位置和时间的“超冷代理”：\n  $$ X(t,i,j) = \\sum_{k=0}^{2} \\max\\left(0, T_{\\mathrm{NAT}} - T(t,i,j,k)\\right). $$\n- 将总臭氧柱浓度（多布森单位）定义为对“超冷代理”的线性化学响应，加上一个振幅为 $3$ 多布森单位的确定性时空扰动：\n  $$ O_3(t,i,j) = 260 - \\gamma \\, X(t,i,j) - 3 \\cos\\left(3 \\lambda_j \\cdot \\frac{\\pi}{180}\\right) \\cos\\left(2\\pi \\frac{t}{N_t}\\right). $$\n\n测试套件：\n- 程序必须评估以下三种情景，每种情景由一对参数 $(A,\\gamma)$ 定义：\n  1. $(A,\\gamma) = (7,25)$\n  2. $(A,\\gamma) = (3,4)$\n  3. $(A,\\gamma) = (0,25)$\n- 对于每种情景，计算在 $N_t = 8$ 个时间步长内 $\\{V_{\\mathrm{PSC}}(t)\\}$ 和 $\\{A_{\\mathrm{O_3}}(t)\\}$ 之间的皮尔逊相关系数 $r$，规则是如果任一序列的标准差为零，则报告 $r=0$。\n\n单位和数值要求：\n- 温度必须以开尔文为单位。\n- 几何高度必须以米为单位。\n- 地球半径必须以米为单位。\n- 面积必须以平方米累积，体积必须以立方米累积。\n- 三角函数的角度必须以弧度为单位。\n- 最终的相关系数是无量纲的，必须报告为四舍五入到三位小数的十进制浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个相关系数，按上述情景的顺序排列，形式为用方括号括起来的逗号分隔列表，例如：“[0.932,0.104,0.000]”。\n- 程序必须是自包含的，不需要任何输入，并且仅使用指定的运行时环境。\n\n交付物：\n- 按照规定实现完整的计算，并以精确的单行格式打印最终结果。",
            "solution": "该问题被认为是有效的，因为它以简化的地球物理学为科学基础，数学上是适定的，并为计算解决方案提供了一套完整且一致的定义和数据。\n\n解决方案通过实施指定的模型来进行。计算的结构是首先定义计算网格及其几何属性，然后为每个情景模拟合成的大气场随时间的变化，最后计算所需的诊断量及其统计相关性。为了提高效率，采用了使用 `numpy` 库的向量化方法。\n\n**1. 网格和常量定义**\n首先，我们按照规定定义所有物理和模型常量。\n- 地球半径：$R = 6\\,371\\,000$ 米。\n- 三水合硝酸（NAT）温度阈值：$T_{\\mathrm{NAT}} = 195$ 开尔文。\n- 臭氧洞柱密度阈值：$O_{\\mathrm{th}} = 220$ 多布森单位（DU）。\n- 时间步数：$N_t = 8$。\n- 时间步索引：$t \\in \\{0, 1, ..., 7\\}$。\n- 经向冷却系数：$\\beta = 0.2$ 开尔文/度。\n- 经向波振幅：$\\delta = 1$ 开尔文。\n\n计算网格由其边缘定义：\n- 纬度边缘（度）：$\\varphi_{\\mathrm{edges}} = \\{-90, -75, -60\\}$。\n- 经度边缘（度）：$\\lambda_{\\mathrm{edges}} = \\{0, 120, 240, 360\\}$。\n- 垂直边缘（米）：$z_{\\mathrm{edges}} = \\{15000, 20000, 25000, 30000\\}$。\n\n从这些边缘，我们导出用于场计算的单元中心。\n- 纬度中心（度）：$\\phi_i \\in \\{-82.5, -67.5\\}$。\n- 经度中心（度）：$\\lambda_j \\in \\{60, 180, 300\\}$。\n- 南极域定义为纬度低于 $-60$ 度的区域。中心在 $-82.5$ 度和 $-67.5$ 度的两个纬度带都满足此条件，因此所有网格单元都包含在计算中。\n\n**2. 网格单元的几何属性**\n每个水平网格单元的面积和每个三维单元的体积都预先计算好。\n由纬度 $\\varphi_1, \\varphi_2$ 和经度 $\\lambda_1, \\lambda_2$（均以弧度为单位）界定的单元面积由下式给出：\n$$ A_{\\mathrm{cell}} = R^2 \\left|\\sin(\\varphi_2) - \\sin(\\varphi_1)\\right| \\left|\\lambda_2 - \\lambda_1\\right| $$\n我们为每个纬度带 $i$ 和经度扇区 $j$ 计算一个单元面积数组 $A_{\\mathrm{cell}, ij}$。所有角度都从度转换为弧度，以便在三角函数中使用。\n\n垂直层 $k$ 中单元的体积是其水平面积乘以层厚度：\n$$ V_{\\mathrm{cell},k} = A_{\\mathrm{cell}} \\cdot (z_{k+1}-z_k) $$\n对于所有 $k$，层厚度是恒定的 $z_{k+1} - z_k = 5000$ 米。这使我们能够计算出单元体积的三维数组 $V_{\\mathrm{cell}, ijk}$。\n\n**3. 基于情景的场计算**\n程序遍历三个指定的情景，每个情景由一对参数 $(A, \\gamma)$ 定义：$(7, 25)$、$(3, 4)$ 和 $(0, 25)$。对于每个情景，我们执行以下随时间变化的计算。\n\n**3.1. 温度场构建**\n温度场 $T(t, i, j, k)$ 是由四个分量的总和构建的。这些分量是使用向量化操作为所有网格点和时间步计算的：\n- **基准垂直剖面**：$T_{0,k}$，对于层 $k \\in \\{0, 1, 2\\}$，其值为 $\\{200, 197, 194\\}$ K。\n- **经向冷却**：$\\Delta T_{\\phi}(i) = -\\beta (|\\phi_i| - 60)$，其中 $\\phi_i$ 以度为单位。\n- **经向定常波**：$\\Delta T_{\\lambda}(j) = \\delta \\cos(\\lambda_j \\cdot \\pi/180)$，其中 $\\lambda_j$ 以度为单位。\n- **季节性正弦波**：$\\Delta T_t(t) = -A \\sin(2\\pi \\frac{t}{N_t})$。\n\n完整的温度场是以下各项的总和：\n$$ T(t,i,j,k) = T_{0,k} + \\Delta T_{\\phi}(i) + \\Delta T_{\\lambda}(j) + \\Delta T_t(t) $$\n这将产生一个形状为 $(N_t, N_{\\text{lat}}, N_{\\text{lon}}, N_z)$ 的四维温度值数组。\n\n**3.2. PSC 体积计算**\n在每个时间步 $t$ 的极地平流层云（PSC）体积 $V_{\\mathrm{PSC}}(t)$，是温度低于 NAT 阈值 $T_{\\mathrm{NAT}} = 195$ K 的所有网格单元的总和。\n$$ V_{\\mathrm{PSC}}(t) = \\sum_{i,j,k} \\mathbf{1}\\left(T(t,i,j,k)  T_{\\mathrm{NAT}}\\right) \\, V_{\\mathrm{cell}, ijk} $$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数。这是通过创建一个布尔掩码（其中 $T  T_{\\mathrm{NAT}}$），并对预先计算的 $V_{\\mathrm{cell},ijk}$ 数组中相应的单元体积求和来计算的。这将产生一个时间序列 $\\{V_{\\mathrm{PSC}}(t)\\}_{t=0}^{N_t-1}$。\n\n**3.3. 臭氧场和臭氧洞面积计算**\n臭氧洞面积的计算首先需要计算总臭氧柱浓度场 $O_3(t, i, j)$。该场依赖于一个“超冷代理”$X(t, i, j)$，它在垂直柱上积分低于 $T_{\\mathrm{NAT}}$ 的温度偏差：\n$$ X(t,i,j) = \\sum_{k=0}^{2} \\max\\left(0, T_{\\mathrm{NAT}} - T(t,i,j,k)\\right) $$\n然后，总臭氧柱浓度被定义为对该代理的线性响应，加上一个时空扰动：\n$$ O_3(t,i,j) = 260 - \\gamma \\, X(t,i,j) - 3 \\cos\\left(3 \\lambda_j \\cdot \\frac{\\pi}{180}\\right) \\cos\\left(2\\pi \\frac{t}{N_t}\\right) $$\n计算出 $O_3(t, i, j)$ 场后，$t$ 时刻的臭氧洞面积 $A_{\\mathrm{O_3}}(t)$ 是所有总臭氧柱浓度低于阈值 $O_{\\mathrm{th}} = 220$ DU 的水平单元的面积之和：\n$$ A_{\\mathrm{O_3}}(t) = \\sum_{i,j} \\mathbf{1}\\left(O_3(t,i,j)  O_{\\mathrm{th}}\\right) \\, A_{\\mathrm{cell}, ij} $$\n这将产生一个时间序列 $\\{A_{\\mathrm{O_3}}(t)\\}_{t=0}^{N_t-1}$。\n\n**4. 相关性分析**\n对于每个情景，在生成 PSC 体积的时间序列 $\\{V_{\\mathrm{PSC}}(t)\\}$ 和臭氧洞面积的时间序列 $\\{A_{\\mathrm{O_3}}(t)\\}$ 后，我们计算皮尔逊积矩相关系数 $r$。\n$$ r = \\frac{\\mathrm{cov}(V_{\\mathrm{PSC}}, A_{\\mathrm{O_3}})}{\\sigma_{V} \\, \\sigma_{A}} $$\n其中 $\\sigma_V$ 和 $\\sigma_A$ 分别是各自时间序列的标准差。根据问题规范，如果任一标准差为零（即时间序列是常数），则相关系数 $r$ 定义为 $0$。在计算相关性之前执行此检查以避免除以零的错误。\n\n每个情景的最终结果是计算出的相关系数，四舍五入到三位小数。这些结果被收集并格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes PSC volume and ozone hole area correlation for synthetic scenarios.\n    \"\"\"\n    # 1. Grid and Constants Definition\n    R = 6371000.0  # meters\n    T_NAT = 195.0  # Kelvin\n    O_TH = 220.0   # Dobson Units\n    N_t = 8\n    \n    beta = 0.2  # K/degree\n    delta = 1.0   # K\n    \n    # Grid edges\n    lat_edges_deg = np.array([-90.0, -75.0, -60.0])\n    lon_edges_deg = np.array([0.0, 120.0, 240.0, 360.0])\n    z_edges_m = np.array([15000.0, 20000.0, 25000.0, 30000.0])\n\n    # Grid centers\n    lat_centers_deg = (lat_edges_deg[:-1] + lat_edges_deg[1:]) / 2.0\n    lon_centers_deg = (lon_edges_deg[:-1] + lon_edges_deg[1:]) / 2.0\n    \n    n_lat = len(lat_centers_deg)\n    n_lon = len(lon_centers_deg)\n    n_z = len(z_edges_m) - 1\n    \n    t_steps = np.arange(N_t)\n    \n    # Baseline vertical temperature profile\n    T0_k = np.array([200.0, 197.0, 194.0])\n\n    # Convert degrees to radians for geometric calculations\n    lat_edges_rad = np.deg2rad(lat_edges_deg)\n    lon_edges_rad = np.deg2rad(lon_edges_deg)\n\n    # 2. Geometric Properties of Grid Cells\n    dsinphi = np.abs(np.sin(lat_edges_rad[1:]) - np.sin(lat_edges_rad[:-1]))\n    dlambda = np.abs(lon_edges_rad[1:] - lon_edges_rad[:-1])\n\n    # Cell areas (n_lat, n_lon)\n    cell_areas = R**2 * np.outer(dsinphi, dlambda)\n\n    # Cell volumes (n_lat, n_lon, n_z)\n    dz = z_edges_m[1:] - z_edges_m[:-1]\n    cell_volumes = cell_areas[:, :, np.newaxis] * dz[np.newaxis, np.newaxis, :]\n\n    # 3. Scenario-Based Field Calculation\n    test_cases = [(7.0, 25.0), (3.0, 4.0), (0.0, 25.0)]\n    results = []\n\n    for A, gamma in test_cases:\n        # 3.1. Temperature Field Construction using broadcasting\n        # Reshape components for broadcasting to (t, lat, lon, z)\n        \n        # T0_k_bc: (1, 1, 1, n_z)\n        T0_k_bc = T0_k[np.newaxis, np.newaxis, np.newaxis, :]\n        \n        # dT_phi_bc: (1, n_lat, 1, 1)\n        dT_phi = -beta * (np.abs(lat_centers_deg) - 60.0)\n        dT_phi_bc = dT_phi[np.newaxis, :, np.newaxis, np.newaxis]\n        \n        # dT_lambda_bc: (1, 1, n_lon, 1)\n        dT_lambda = delta * np.cos(np.deg2rad(lon_centers_deg))\n        dT_lambda_bc = dT_lambda[np.newaxis, np.newaxis, :, np.newaxis]\n        \n        # dT_t_bc: (n_t, 1, 1, 1)\n        dT_t = -A * np.sin(2 * np.pi * t_steps / N_t)\n        dT_t_bc = dT_t[:, np.newaxis, np.newaxis, np.newaxis]\n        \n        T_field = T0_k_bc + dT_phi_bc + dT_lambda_bc + dT_t_bc\n\n        # 3.2. PSC Volume Calculation\n        is_psc = T_field  T_NAT\n        # Sum over spatial dimensions (1, 2, 3)\n        V_psc_series = np.sum(is_psc * cell_volumes[np.newaxis, :, :, :], axis=(1, 2, 3))\n\n        # 3.3. Ozone Field and Hole Area Calculation\n        # Cold excess proxy X(t, i, j) - shape (n_t, n_lat, n_lon)\n        cold_excess_proxy = np.sum(np.maximum(0, T_NAT - T_field), axis=3)\n        \n        # Ozone perturbation term - shape (n_t, 1, n_lon)\n        lon_term = 3.0 * np.cos(3 * np.deg2rad(lon_centers_deg))\n        time_term = np.cos(2 * np.pi * t_steps / N_t)\n        O3_pert = lon_term[np.newaxis, np.newaxis, :] * time_term[:, np.newaxis, np.newaxis]\n        \n        # Ozone field O3(t, i, j) - shape (n_t, n_lat, n_lon)\n        O3_field = 260.0 - gamma * cold_excess_proxy - O3_pert\n        \n        # Ozone hole area\n        is_o3_hole = O3_field  O_TH\n        # Sum over spatial dimensions (1, 2)\n        A_o3_series = np.sum(is_o3_hole * cell_areas[np.newaxis, :, :], axis=(1, 2))\n\n        # 4. Correlation Analysis\n        std_V = np.std(V_psc_series)\n        std_A = np.std(A_o3_series)\n        \n        if std_V == 0.0 or std_A == 0.0:\n            corr = 0.0\n        else:\n            # np.corrcoef returns a 2x2 matrix\n            corr_matrix = np.corrcoef(V_psc_series, A_o3_series)\n            corr = corr_matrix[0, 1]\n\n        results.append(corr)\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}