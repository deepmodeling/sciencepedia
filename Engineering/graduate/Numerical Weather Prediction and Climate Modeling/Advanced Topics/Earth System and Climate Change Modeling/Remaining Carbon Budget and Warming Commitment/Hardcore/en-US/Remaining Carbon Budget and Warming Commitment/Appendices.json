{
    "hands_on_practices": [
        {
            "introduction": "The concept of the Transient Climate Response to cumulative carbon Emissions (TCRE) provides a powerful, first-order link between total emitted $\\mathrm{CO_2}$ and peak warming. This exercise leverages this linear relationship to investigate a fundamental question in climate policy: how does the speed of decarbonization affect the eventual temperature outcome? By analyzing a simplified linear emission reduction pathway , you will analytically and quantitatively demonstrate the critical importance of achieving net-zero emissions as early as possible to limit peak global warming.",
            "id": "4081694",
            "problem": "Consider a globally aggregated climate system represented by a linear energy balance model, where the global mean surface air temperature (GMSAT) anomaly $T(t)$ responds to the total radiative forcing $F(t)$ through the equation $C\\,\\frac{dT}{dt} = F(t) - \\lambda\\,T(t)$, with $C$ the effective heat capacity and $\\lambda$ the climate feedback parameter. The total forcing decomposes into carbon dioxide ($\\mathrm{CO_2}$) and non-carbon dioxide (non-$\\mathrm{CO_2}$) components, $F(t) = F_{\\mathrm{CO_2}}(t) + F_{\\mathrm{nc}}(t)$. Assume that the non-$\\mathrm{CO_2}$ forcing is held constant in time, i.e., $F_{\\mathrm{nc}}(t) = F_{\\mathrm{nc},0}$.\n\nTake as a widely supported emergent property of comprehensive climate models the Transient Climate Response to cumulative carbon emissions (TCRE): the $\\mathrm{CO_2}$-induced warming can be approximated as $T_{\\mathrm{CO_2}}(t) \\approx \\beta\\,E_{\\mathrm{cum}}(t)$, where $E_{\\mathrm{cum}}(t)$ is the cumulative anthropogenic $\\mathrm{CO_2}$ emissions up to time $t$, and $\\beta$ is a constant. Further assume the Zero Emissions Commitment (ZEC) over multidecadal timescales is negligible, i.e., after net-zero $\\mathrm{CO_2}$ emissions, $T_{\\mathrm{CO_2}}(t)$ does not exhibit a systematic drift. Under these assumptions, the peak warming is reached at the time net-zero $\\mathrm{CO_2}$ emissions is achieved.\n\nSuppose present-day annual anthropogenic $\\mathrm{CO_2}$ emissions at $t_0 = 2025$ are $E_0 = 40$ $\\text{GtCO}_2 \\, \\text{yr}^{-1}$, and the emissions decline linearly from $t_0$ to reach net-zero at a specified year $Y$, so that $E(t)$ decreases linearly from $E_0$ at $t_0$ to $0$ at $Y$. Use the value $\\beta = 4.5 \\times 10^{-4}$ K per Gt$\\mathrm{CO_2}$ for the Transient Climate Response to cumulative carbon emissions.\n\nUsing the fundamental balance and the TCRE approximation described above, first justify analytically why an earlier net-zero date implies a lower peak warming under constant non-$\\mathrm{CO_2}$ forcing. Then, for net-zero in $Y = 2040$ versus $Y = 2050$, compute the quantitative difference in peak GMSAT anomaly due to $\\mathrm{CO_2}$ (the non-$\\mathrm{CO_2}$ contribution is the same in both scenarios), and report this difference as the final answer. Round your answer to four significant figures and express it in degrees Celsius.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   Energy balance model: $C\\,\\frac{dT}{dt} = F(t) - \\lambda\\,T(t)$\n-   $T(t)$: Global Mean Surface Air Temperature (GMSAT) anomaly\n-   $F(t)$: Total radiative forcing\n-   $C$: Effective heat capacity\n-   $\\lambda$: Climate feedback parameter\n-   Forcing decomposition: $F(t) = F_{\\mathrm{CO_2}}(t) + F_{\\mathrm{nc}}(t)$\n-   Non-$\\mathrm{CO_2}$ forcing: $F_{\\mathrm{nc}}(t) = F_{\\mathrm{nc},0}$ (constant)\n-   Transient Climate Response to cumulative carbon Emissions (TCRE): $T_{\\mathrm{CO_2}}(t) \\approx \\beta\\,E_{\\mathrm{cum}}(t)$\n-   $E_{\\mathrm{cum}}(t)$: Cumulative anthropogenic $\\mathrm{CO_2}$ emissions up to time $t$\n-   TCRE constant: $\\beta = 4.5 \\times 10^{-4}$ K per Gt$\\mathrm{CO_2}$\n-   Zero Emissions Commitment (ZEC): Negligible. Peak warming due to $\\mathrm{CO_2}$ is reached at the time of net-zero $\\mathrm{CO_2}$ emissions.\n-   Initial time: $t_0 = 2025$\n-   Initial annual emissions: $E_0 = 40$ $\\text{GtCO}_2 \\, \\text{yr}^{-1}$\n-   Emissions pathway: $E(t)$ decreases linearly from $E_0$ at $t_0$ to $0$ at year $Y$.\n-   Scenarios for net-zero year: $Y_1 = 2040$ and $Y_2 = 2050$.\n-   Task 1: Justify analytically why an earlier net-zero date $Y$ implies a lower peak warming.\n-   Task 2: Compute the difference in peak GMSAT anomaly due to $\\mathrm{CO_2}$ between the scenarios $Y=2050$ and $Y=2040$.\n-   Reporting requirement: Final answer rounded to four significant figures, in degrees Celsius.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on established concepts in climate science, including the linear energy balance model, radiative forcing, the TCRE approximation, and the ZEC. These are standard tools for simplified climate analysis. The provided numerical values are within realistic ranges.\n-   **Well-Posed**: The problem is clearly defined with a specific set of assumptions and a quantifiable question. The linear emissions pathway allows for a direct and unique calculation of cumulative emissions.\n-   **Objective**: The language is precise and quantitative, free from subjective claims.\n-   **Complete and Consistent**: All necessary information to solve the problem is provided. The use of the TCRE approximation $T_{\\mathrm{CO_2}}(t) \\approx \\beta\\,E_{\\mathrm{cum}}(t)$ circumvents the need for parameters of the full energy balance model ($C$, $\\lambda$, $F_{\\mathrm{nc},0}$), which is consistent and makes the problem self-contained for the question asked. The assumptions are internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically grounded, well-posed, and self-consistent. A solution will be provided.\n\nThe problem requires an analytical justification followed by a quantitative calculation.\n\n**Part 1: Analytical Justification**\n\nThe problem states that the peak warming due to $\\mathrm{CO_2}$ is reached at the time of net-zero emissions, denoted by the year $Y$. The relationship between the $\\mathrm{CO_2}$-induced warming, $T_{\\mathrm{CO_2}}(t)$, and the cumulative $\\mathrm{CO_2}$ emissions, $E_{\\mathrm{cum}}(t)$, is given by the TCRE approximation:\n$$T_{\\mathrm{CO_2}}(t) = \\beta\\,E_{\\mathrm{cum}}(t)$$\nThe peak warming due to $\\mathrm{CO_2}$, denoted $T_{\\mathrm{CO_2}, \\text{peak}}$, therefore occurs at $t=Y$ and is given by:\n$$T_{\\mathrm{CO_2}, \\text{peak}}(Y) = \\beta\\,E_{\\mathrm{cum}}(Y)$$\nThe total cumulative emissions at year $Y$, $E_{\\mathrm{cum}}(Y)$, is the sum of the cumulative emissions up to the present time $t_0$, denoted $E_{\\mathrm{cum}}(t_0)$, and the future emissions from $t_0$ to $Y$.\n$$E_{\\mathrm{cum}}(Y) = E_{\\mathrm{cum}}(t_0) + \\int_{t_0}^{Y} E(t)\\,dt$$\nThe annual emissions $E(t)$ are specified to decline linearly from an initial value $E_0$ at time $t_0$ to $0$ at time $Y$. The function describing this linear decline over the interval $[t_0, Y]$ is:\n$$E(t) = E_0 \\left( 1 - \\frac{t - t_0}{Y - t_0} \\right)$$\nThe integral of $E(t)$ from $t_0$ to $Y$ represents the area of a triangle with base $(Y - t_0)$ and height $E_0$:\n$$\\int_{t_0}^{Y} E(t)\\,dt = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} (Y - t_0) E_0$$\nSubstituting this into the expression for $E_{\\mathrm{cum}}(Y)$:\n$$E_{\\mathrm{cum}}(Y) = E_{\\mathrm{cum}}(t_0) + \\frac{1}{2} E_0 (Y - t_0)$$\nThe peak $\\mathrm{CO_2}$-induced warming as a function of the net-zero year $Y$ is therefore:\n$$T_{\\mathrm{CO_2}, \\text{peak}}(Y) = \\beta \\left( E_{\\mathrm{cum}}(t_0) + \\frac{1}{2} E_0 (Y - t_0) \\right)$$\nTo determine how the peak warming depends on the net-zero year $Y$, we can examine the derivative of $T_{\\mathrm{CO_2}, \\text{peak}}(Y)$ with respect to $Y$. The parameters $\\beta$, $E_{\\mathrm{cum}}(t_0)$, $E_0$, and $t_0$ are constants in this context.\n$$\\frac{d}{dY} T_{\\mathrm{CO_2}, \\text{peak}}(Y) = \\frac{d}{dY} \\left[ \\beta \\left( E_{\\mathrm{cum}}(t_0) + \\frac{1}{2} E_0 Y - \\frac{1}{2} E_0 t_0 \\right) \\right]$$\n$$\\frac{d T_{\\mathrm{CO_2}, \\text{peak}}}{dY} = \\beta \\left( 0 + \\frac{1}{2} E_0 - 0 \\right) = \\frac{1}{2} \\beta E_0$$\nGiven that the TCRE constant $\\beta$ and the initial emission rate $E_0$ are both positive ($\\beta = 4.5 \\times 10^{-4}$ $\\text{K}/\\text{GtCO}_2$ and $E_0 = 40$ $\\text{GtCO}_2 \\, \\text{yr}^{-1}$), the derivative is strictly positive:\n$$\\frac{d T_{\\mathrm{CO_2}, \\text{peak}}}{dY}  0$$\nThis demonstrates that $T_{\\mathrm{CO_2}, \\text{peak}}(Y)$ is a strictly increasing function of the net-zero year $Y$. Consequently, an earlier net-zero date (a smaller value of $Y$) implies a lower peak warming due to $\\mathrm{CO_2}$. The non-$\\mathrm{CO_2}$ forcing is constant, so its contribution to warming does not change between scenarios. Thus, the total peak warming is also lower for an earlier net-zero date. This completes the analytical justification.\n\n**Part 2: Quantitative Calculation**\n\nWe are asked to compute the difference in peak GMSAT anomaly due to $\\mathrm{CO_2}$ between two scenarios: net-zero in $Y_2 = 2050$ versus net-zero in $Y_1 = 2040$. This difference, $\\Delta T_{\\mathrm{CO_2}, \\text{peak}}$, is:\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = T_{\\mathrm{CO_2}, \\text{peak}}(Y_2) - T_{\\mathrm{CO_2}, \\text{peak}}(Y_1)$$\nUsing the expression derived above for $T_{\\mathrm{CO_2}, \\text{peak}}(Y)$:\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\left[ \\beta \\left( E_{\\mathrm{cum}}(t_0) + \\frac{1}{2} E_0 (Y_2 - t_0) \\right) \\right] - \\left[ \\beta \\left( E_{\\mathrm{cum}}(t_0) + \\frac{1}{2} E_0 (Y_1 - t_0) \\right) \\right]$$\nThe term $\\beta E_{\\mathrm{cum}}(t_0)$ cancels out:\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\frac{1}{2} \\beta E_0 (Y_2 - t_0) - \\frac{1}{2} \\beta E_0 (Y_1 - t_0)$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\frac{1}{2} \\beta E_0 ((Y_2 - t_0) - (Y_1 - t_0))$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\frac{1}{2} \\beta E_0 (Y_2 - Y_1)$$\nNow, we substitute the given numerical values:\n- $\\beta = 4.5 \\times 10^{-4}$ K per Gt$\\mathrm{CO_2}$. A temperature difference in Kelvin (K) is identical to a difference in degrees Celsius ($^{\\circ}$C).\n- $E_0 = 40$ $\\text{GtCO}_2 \\, \\text{yr}^{-1}$\n- $Y_1 = 2040$\n- $Y_2 = 2050$\nThe difference in net-zero years is $Y_2 - Y_1 = 2050 - 2040 = 10$ years.\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\frac{1}{2} \\times (4.5 \\times 10^{-4} \\,^{\\circ}\\text{C}/\\text{GtCO}_2) \\times (40 \\,\\text{GtCO}_2/\\text{yr}) \\times (10 \\,\\text{yr})$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = \\frac{1}{2} \\times (4.5 \\times 10^{-4}) \\times 400 \\,^{\\circ}\\text{C}$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = 200 \\times 4.5 \\times 10^{-4} \\,^{\\circ}\\text{C}$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = 900 \\times 10^{-4} \\,^{\\circ}\\text{C}$$\n$$\\Delta T_{\\mathrm{CO_2}, \\text{peak}} = 0.09 \\,^{\\circ}\\text{C}$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is exactly $0.09$. To express this with four significant figures, we must add trailing zeros after the decimal. The significant figures are the first non-zero digit and all digits that follow. Thus, the four significant figures are $9$, $0$, $0$, and $0$. The value is $0.09000$.",
            "answer": "$$\\boxed{0.09000}$$"
        },
        {
            "introduction": "While the TCRE is a useful simplification, a deeper understanding of warming commitment requires dynamic modeling. This practice guides you through the implementation of a numerical energy balance model to explore the complex role of aerosols, which currently 'mask' a portion of greenhouse gas-induced warming . By simulating the removal of aerosols with spatially varying efficacies, you will quantify the 'committed warming' that is not yet realized and compute the crucial difference between a naive, masked carbon budget and the true budget that accounts for this future unmasking.",
            "id": "4081665",
            "problem": "You are tasked with designing and implementing a complete numerical experiment to quantify how spatial heterogeneity in aerosol radiative forcing affects remaining carbon budget estimation and warming commitment in a simplified global climate model. Your program must simulate the global mean temperature response to regionally distributed aerosol forcing with differing efficacies, and then compute two estimates of the remaining carbon budget to a specified warming threshold. All answers must be expressed in the specified units and aggregated into a single output line as described below.\n\nBase your derivation and algorithm on the following fundamental laws and core definitions:\n\n1. Global-mean one-box energy balance model: the climate systemâ€™s global-mean temperature response to an externally imposed effective radiative forcing is governed by\n$$\nC \\frac{dT_a(t)}{dt} = R_{\\mathrm{eff}}(t) - \\lambda T_a(t),\n$$\nwhere $T_a(t)$ is the aerosol-induced global-mean temperature contribution in $\\mathrm{K}$, $C$ is the effective heat capacity in $\\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$, $\\lambda$ is the climate feedback parameter in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$, and $R_{\\mathrm{eff}}(t)$ is the global-mean effective radiative forcing in $\\mathrm{W \\, m^{-2}}$. Use a discrete-time approximation with annual time steps.\n\n2. Regional aerosol forcing and efficacy: consider a finite set of regions indexed by $r = 1, 2, \\dots, R$. Each region has an areal fraction $f_r$ with $\\sum_r f_r = 1$, an aerosol radiative forcing $F_r$ in $\\mathrm{W \\, m^{-2}}$ (negative values indicate cooling), and an efficacy $e_r$ (unitless) that scales the temperature effectiveness of $F_r$ relative to a reference forcing. The globally averaged effective forcing at time $t$ is\n$$\nR_{\\mathrm{eff}}(t) = \\sum_{r=1}^R f_r \\, e_r \\, F_r(t).\n$$\nAssume $F_r(t)$ is piecewise constant: $F_r(t) = F_r$ for $t  t_{\\mathrm{stop}}$ and $F_r(t) = 0$ for $t \\ge t_{\\mathrm{stop}}$ to represent aerosol phase-out.\n\n3. Transient Climate Response to cumulative carbon emissions (TCRE): the global-mean warming from carbon dioxide is approximately proportional to cumulative emissions,\n$$\n\\Delta T_{\\mathrm{CO_2}}(t) = \\beta E(t),\n$$\nwhere $\\beta$ is the TCRE in $\\mathrm{K / GtCO_2}$ and $E(t)$ is cumulative carbon dioxide emissions since preindustrial in $\\text{GtCO}_2$. Treat $\\Delta T_{\\mathrm{CO_2}}(t)$ as independent of aerosol forcing in this simplified framework.\n\nYour tasks:\n\n- Implement a discrete-time solver of the energy balance equation with an annual time step $\\Delta t = 1 \\, \\mathrm{yr}$ to compute $T_a(t)$ from $t=0$ to $t=t_{\\mathrm{eval}}$ using the given parameters. Initialize $T_a(0) = 0$.\n- Compute the aerosol-induced global mean temperature at the present time $t_0$ years after the aerosol era began, denoted $T_a(t_0)$ in $\\mathrm{K}$, and the temperature at an evaluation time $t_{\\mathrm{eval}}$ years when aerosols have been phased out (i.e., $t_{\\mathrm{eval}}  t_{\\mathrm{stop}}$), denoted $T_a(t_{\\mathrm{eval}})$ in $\\mathrm{K}$.\n- Let current cumulative carbon dioxide emissions be $E_0$ in $\\text{GtCO}_2$, so current carbon dioxide warming is $T_{\\mathrm{CO_2},0} = \\beta E_0$ in $\\mathrm{K}$. For a warming threshold $T^*$ in $\\mathrm{K}$, compute two estimates of the remaining carbon budget in $\\text{GtCO}_2$:\n    1. A masked instantaneous estimate that includes current aerosol cooling:\n    $$\n    B_{\\mathrm{masked}} = \\max\\left(0, \\frac{T^* - \\left(T_{\\mathrm{CO_2},0} + T_a(t_0)\\right)}{\\beta}\\right).\n    $$\n    2. A post-removal estimate that accounts for warming commitment after aerosol phase-out:\n    $$\n    B_{\\mathrm{true}} = \\max\\left(0, \\frac{T^* - \\left(T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}})\\right)}{\\beta}\\right).\n    $$\n\nPhysical units and angle specification:\n- Temperatures must be in $\\mathrm{K}$.\n- Radiative forcings must be in $\\mathrm{W \\, m^{-2}}$.\n- The climate feedback parameter must be in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$.\n- The effective heat capacity must be in $\\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$.\n- The TCRE must be in $\\mathrm{K / GtCO_2}$.\n- Emissions and budgets must be in $\\text{GtCO}_2$.\n- No angle quantities are involved.\n\nNumerical scheme requirement:\n- Use an annual forward-Euler discretization,\n$$\nT_a(t+\\Delta t) = T_a(t) + \\frac{\\Delta t}{C}\\left(R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\\right),\n$$\nwith $\\Delta t = 1 \\, \\mathrm{yr}$.\n\nTest suite:\nYour program must run the following set of four test cases. For each case, the parameters are given as tuples of lists and scalars in the order $(\\{f_r\\}, \\{F_r\\}, \\{e_r\\}, \\lambda, C, t_0, t_{\\mathrm{stop}}, t_{\\mathrm{eval}}, \\beta, E_0, T^*)$:\n\n1. Heterogeneous efficacies, mid-latitude and tropical regions:\n    - $\\{f_r\\} = [0.3, 0.7]$\n    - $\\{F_r\\} = [-0.6, -0.3] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.3, 0.8]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\beta = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\text{GtCO}_2$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n2. Homogeneous efficacies baseline:\n    - $\\{f_r\\} = [0.3, 0.7]$\n    - $\\{F_r\\} = [-0.6, -0.3] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.0, 1.0]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\beta = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\text{GtCO}_2$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n3. Strong heterogeneity with a small, high-efficacy region:\n    - $\\{f_r\\} = [0.1, 0.9]$\n    - $\\{F_r\\} = [-1.0, -0.2] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [2.0, 0.7]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\beta = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\text{GtCO}_2$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n4. No aerosols edge case:\n    - $\\{f_r\\} = [0.5, 0.5]$\n    - $\\{F_r\\} = [0.0, 0.0] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.5, 0.7]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\beta = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\text{GtCO}_2$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\nRequired final output format:\n- For each test case, compute the list $[T_a(t_0), T_a(t_{\\mathrm{eval}}), B_{\\mathrm{masked}}, B_{\\mathrm{true}}]$. Your program should produce a single line of output containing the results as a comma-separated list of these four-element lists, enclosed in square brackets. Temperatures must be in $\\mathrm{K}$ and budgets in $\\text{GtCO}_2$. Round each float to six decimal places. For example: \"[[val11,val12,val13,val14],[val21,val22,val23,val24],...]\".",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in established climate science principles (energy balance models, radiative forcing, and TCRE), is well-posed with a complete set of parameters and a clear objective, and is free of ambiguities or contradictions. We may therefore proceed with a solution.\n\nThe problem requires a numerical simulation to quantify the impact of spatially heterogeneous aerosol forcing on estimates of the remaining carbon budget. The solution is derived by first solving a time-dependent energy balance equation for the aerosol-induced temperature change and then using this result to calculate two different estimates of the carbon budget.\n\n**1. Governing Physical and Mathematical Principles**\n\nThe core of the simulation is the global-mean one-box energy balance model, which describes the evolution of the aerosol-induced global-mean surface temperature anomaly, $T_a(t)$, over time $t$:\n$$\nC \\frac{dT_a(t)}{dt} = R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\n$$\nHere, $C$ is the effective heat capacity of the climate system, $\\lambda$ is the climate feedback parameter, and $R_{\\mathrm{eff}}(t)$ is the global-mean effective radiative forcing from aerosols. The term $\\lambda T_a(t)$ represents the restorative energy flux to space as the planet warms, and $C \\frac{dT_a(t)}{dt}$ represents the net energy uptake by the system.\n\nThe effective radiative forcing, $R_{\\mathrm{eff}}(t)$, is not uniform. It is calculated as a weighted average over $R$ distinct geographical regions:\n$$\nR_{\\mathrm{eff}}(t) = \\sum_{r=1}^R f_r \\, e_r \\, F_r(t)\n$$\nwhere for each region $r$, $f_r$ is its fractional area of the globe ($\\sum_r f_r = 1$), $F_r(t)$ is the regional radiative forcing, and $e_r$ is the efficacy. Efficacy is a crucial dimensionless parameter that accounts for the fact that a forcing of a given magnitude (in $\\mathrm{W \\, m^{-2}}$) can produce a larger or smaller global temperature response depending on where it is applied.\n\nThe aerosol forcing is prescribed to be constant until a phase-out time, $t_{\\mathrm{stop}}$, after which it abruptly becomes zero:\n$$\nF_r(t) = \\begin{cases} F_r  \\text{for } t  t_{\\mathrm{stop}} \\\\ 0  \\text{for } t \\ge t_{\\mathrm{stop}} \\end{cases}\n$$\nThis models a scenario where aerosol pollution is entirely eliminated.\n\nThe warming due to carbon dioxide is modeled using the Transient Climate Response to cumulative carbon Emissions (TCRE), which posits a linear relationship between warming and total emitted carbon:\n$$\n\\Delta T_{\\mathrm{CO_2}}(t) = \\beta E(t)\n$$\nwhere $\\beta$ is the TCRE constant and $E(t)$ is the cumulative $\\mathrm{CO_2}$ emissions.\n\n**2. Numerical Discretization and Simulation Algorithm**\n\nThe differential equation for $T_a(t)$ must be solved numerically. The problem specifies a forward-Euler method with a discrete annual time step, $\\Delta t = 1 \\, \\mathrm{yr}$. Discretizing the derivative as $\\frac{dT_a}{dt} \\approx \\frac{T_a(t+\\Delta t) - T_a(t)}{\\Delta t}$, we can rearrange the energy balance equation to obtain an explicit update rule for the temperature at the next time step, $t+\\Delta t$, based on its value at the current time step, $t$:\n$$\nT_a(t+\\Delta t) = T_a(t) + \\frac{\\Delta t}{C}\\left(R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\\right)\n$$\nThis can be grouped into a more computationally convenient form:\n$$\nT_a(t+\\Delta t) = T_a(t) \\left(1 - \\frac{\\lambda \\Delta t}{C}\\right) + R_{\\mathrm{eff}}(t) \\frac{\\Delta t}{C}\n$$\nThe simulation proceeds as follows:\n1.  **Initialization**: Set the initial temperature anomaly to zero, $T_a(0) = 0$. An array is initialized to store the temperature values for each year from $t=0$ to $t=t_{\\mathrm{eval}}$.\n2.  **Forcing Calculation**: For a given test case, the constant effective radiative forcing during the aerosol era ($t  t_{\\mathrm{stop}}$) is pre-calculated: $R_{\\mathrm{eff,on}} = \\sum_{r=1}^R f_r e_r F_r$. For $t \\ge t_{\\mathrm{stop}}$, the forcing is $R_{\\mathrm{eff,off}} = 0$.\n3.  **Time-stepping Loop**: A loop iterates from $t = 0$ to $t = t_{\\mathrm{eval}} - 1$ in steps of $\\Delta t=1 \\, \\mathrm{yr}$. In each iteration:\n    a. The appropriate forcing $R_{\\mathrm{eff}}(t)$ is selected based on whether the current time $t$ is less than $t_{\\mathrm{stop}}$.\n    b. The forward-Euler update rule is applied to compute $T_a(t+\\Delta t)$ and store it.\n4.  **Result Extraction**: After the loop completes, the simulated temperature time series is fully populated. The required values, $T_a(t_0)$ and $T_a(t_{\\mathrm{eval}})$, are extracted from the stored array at the corresponding time indices.\n\n**3. Carbon Budget Calculation**\n\nWith the simulated aerosol-induced temperatures, the two remaining carbon budget estimates are calculated. First, the present-day warming from $\\mathrm{CO_2}$ is computed:\n$$\nT_{\\mathrm{CO_2},0} = \\beta E_0\n$$\nThe total present-day warming is the sum of the $\\mathrm{CO_2}$ and aerosol contributions: $T_{\\mathrm{total},0} = T_{\\mathrm{CO_2},0} + T_a(t_0)$. Note that since $T_a(t_0)$ is negative, it represents a cooling that \"masks\" some of the $\\mathrm{CO_2}$ warming.\n\nThe first budget estimate, $B_{\\mathrm{masked}}$, calculates the remaining allowable emissions assuming this masking effect persists indefinitely. The remaining warming \"headroom\" to the target $T^*$ is $T^* - T_{\\total,0}$. Using the TCRE relationship, this is converted to a\ncarbon budget:\n$$\nB_{\\mathrm{masked}} = \\max\\left(0, \\frac{T^* - (T_{\\mathrm{CO_2},0} + T_a(t_0))}{\\beta}\\right)\n$$\nThe second estimate, $B_{\\mathrm{true}}$, accounts for the \"committed warming\" that will be realized once aerosols are removed. At time $t_{\\mathrm{eval}}$, well after the aerosol phase-out at $t_{\\mathrm{stop}}$, the temperature $T_a(t_{\\mathrm{eval}})$ represents the residual (decaying) temperature effect from the past aerosol forcing. The total committed warming, from current $\\mathrm{CO_2}$ levels and past aerosol effects, is $T_{\\mathrm{commit}} = T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}})$. Note that $T_a(t_{\\mathrm{eval}})$ will be a smaller negative number than $T_a(t_0)$, or even close to zero, reflecting the unmasking of warming. The true remaining carbon budget is therefore:\n$$\nB_{\\mathrm{true}} = \\max\\left(0, \\frac{T^* - (T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}}))}{\\beta}\\right)\n$$\nThis procedure is applied to each of the four test cases to generate the final results. The comparison between $B_{\\mathrm{masked}}$ and $B_{\\mathrm{true}}$ directly quantifies the overestimation of the carbon budget that occurs if one neglects the future warming commitment from aerosol removal.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the climate modeling problem for all specified test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: Heterogeneous efficacies\n        ([0.3, 0.7], [-0.6, -0.3], [1.3, 0.8], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 2: Homogeneous efficacies baseline\n        ([0.3, 0.7], [-0.6, -0.3], [1.0, 1.0], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 3: Strong heterogeneity\n        ([0.1, 0.9], [-1.0, -0.2], [2.0, 0.7], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 4: No aerosols edge case\n        ([0.5, 0.5], [0.0, 0.0], [1.5, 0.7], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        f_r, F_r_vals, e_r, lambda_val, C, t0, t_stop, t_eval, beta, E0, T_star = case\n\n        # Convert lists to numpy arrays for vectorized operations\n        f_r = np.array(f_r)\n        F_r_vals = np.array(F_r_vals)\n        e_r = np.array(e_r)\n\n        # Calculate the constant effective radiative forcing for t  t_stop\n        R_eff_on = np.sum(f_r * e_r * F_r_vals)\n\n        # Numerical integration using Forward Euler\n        dt = 1.0  # Annual time step\n        \n        # Array to store temperature anomaly time series\n        # Size is t_eval + 1 to include t=0 through t=t_eval\n        Ta = np.zeros(t_eval + 1)\n        Ta[0] = 0.0 # Initial condition\n\n        # Time-stepping loop from t=0 to t=t_eval-1 to compute Ta[1] through Ta[t_eval]\n        for t in range(t_eval):\n            # Determine effective radiative forcing at time t\n            if t  t_stop:\n                R_eff_t = R_eff_on\n            else:\n                R_eff_t = 0.0\n\n            # Forward Euler update rule\n            Ta[t + 1] = Ta[t] + (dt / C) * (R_eff_t - lambda_val * Ta[t])\n\n        # Extract temperatures at required times\n        Ta_t0 = Ta[t0]\n        Ta_teval = Ta[t_eval]\n\n        # Calculate carbon budgets\n        T_co2_0 = beta * E0\n\n        # Masked budget (includes current aerosol cooling)\n        numerator_masked = T_star - (T_co2_0 + Ta_t0)\n        B_masked = max(0.0, numerator_masked / beta)\n\n        # True budget (accounts for warming after aerosol removal)\n        numerator_true = T_star - (T_co2_0 + Ta_teval)\n        B_true = max(0.0, numerator_true / beta)\n\n        # Collect and round results for the current case\n        case_results = [\n            round(Ta_t0, 6),\n            round(Ta_teval, 6),\n            round(B_masked, 6),\n            round(B_true, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified, without spaces\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Building on dynamic modeling, this final exercise introduces a critical layer of realism: non-linearity in Earth system feedbacks. You will implement a more sophisticated two-layer energy balance model coupled with a carbon cycle model to investigate how a state-dependent climate feedback parameter, $\\lambda(T)$, impacts the remaining carbon budget . This practice offers direct, hands-on experience with a frontier topic in climate science, demonstrating how feedbacks that weaken with rising temperatures can accelerate warming and substantially shrink the available budget for a given temperature target.",
            "id": "4081774",
            "problem": "You are asked to quantify how introducing state dependence in the climate feedback parameter affects the remaining carbon budget required to reach a given peak global-mean warming target, using a numerical Energy Balance Model (EBM) and a simple impulse-response carbon cycle. You must implement a program that integrates the coupled system forward in time and computes the cumulative future carbon dioxide emissions needed to first reach a specified temperature threshold, comparing the cases with and without state dependence.\n\nAssume the following physically based components:\n\n1) Two-layer Energy Balance Model (EBM):\n- Upper-layer temperature anomaly $T(t)$ and deep-ocean temperature anomaly $T_d(t)$ evolve as\n$$\nC_1 \\frac{dT}{dt} = F(t) - \\lambda(T)\\,T - \\kappa\\,(T - T_d), \\quad\nC_2 \\frac{dT_d}{dt} = \\kappa\\,(T - T_d),\n$$\nwhere $C_1$ and $C_2$ are effective heat capacities of the upper and deep layers, respectively, and $\\kappa$ is the ocean heat exchange parameter. The feedback parameter is state dependent:\n$$\n\\lambda(T) = \\lambda_0 \\bigl(1 - \\eta\\,T\\bigr),\n$$\nwith $\\eta$ a constant in $\\mathrm{K^{-1}}$. The baseline case corresponds to $\\eta = 0$ (state-independent feedback).\n\n2) Radiative forcing from carbon dioxide:\n- The radiative forcing from carbon dioxide is given by the standard logarithmic form\n$$\nF_{\\mathrm{CO_2}}(t) = \\beta \\ln\\!\\left(\\frac{C(t)}{C_0}\\right),\n$$\nwith $\\beta = 5.35$ in $\\mathrm{W\\,m^{-2}}$, reference preindustrial concentration $C_0$ in parts per million by volume (ppm), and $C(t)$ the atmospheric $\\mathrm{CO_2}$ concentration in ppm. Let $F_{\\mathrm{nonCO_2}}$ be an additive constant non-$\\mathrm{CO_2}$ forcing in $\\mathrm{W\\,m^{-2}}$, so that the total forcing is $F(t) = F_{\\mathrm{CO_2}}(t) + F_{\\mathrm{nonCO_2}}$.\n\n3) Simple impulse-response carbon cycle:\n- Represent the atmospheric excess carbon burden $A(t)$ in $\\mathrm{PgC}$ from future emissions $E(t)$ in $\\mathrm{PgC\\,yr^{-1}}$ using a four-term impulse response with one non-decaying fraction:\n$$\n\\frac{dB_0}{dt} = a_0 E(t), \\quad\n\\frac{dB_i}{dt} = a_i E(t) - \\frac{B_i}{\\tau_i} \\quad \\text{for } i \\in \\{1,2,3\\},\n$$\n$$\nA(t) = B_0(t) + B_1(t) + B_2(t) + B_3(t),\n$$\nwith coefficients $(a_0,a_1,a_2,a_3)$ and time scales $(\\tau_1,\\tau_2,\\tau_3)$. Convert the atmospheric excess carbon burden to a concentration increment using\n$$\n\\Delta C(t) = \\frac{A(t)}{\\xi},\n$$\nwith $\\xi = 2.12$ in $\\mathrm{PgC\\,ppm^{-1}}$. The total atmospheric concentration is $C(t) = C_{\\mathrm{init}} + \\Delta C(t)$, where $C_{\\mathrm{init}}$ is the concentration at $t=0$.\n\nDefinition of remaining carbon budget:\n- Let the target warming be $T^\\star$ in $\\mathrm{K}$. Starting from initial conditions at $t=0$, assume future emissions follow a constant-rate profile $E(t) = E_{\\mathrm{now}}$ for $t \\in [0,t_{\\mathrm{hit}})$ and $E(t)=0$ afterward. Define the remaining carbon budget $E_{\\mathrm{rem}}$ as\n$$\nE_{\\mathrm{rem}} = \\int_0^{t_{\\mathrm{hit}}} E_{\\mathrm{now}}\\,dt = E_{\\mathrm{now}}\\, t_{\\mathrm{hit}},\n$$\nwhere $t_{\\mathrm{hit}}$ is the first time at which $T(t)$ reaches $T^\\star$ from below. If $T(0) \\ge T^\\star$, then $E_{\\mathrm{rem}}=0$. If $T(t)$ never reaches $T^\\star$ within a finite horizon $t \\le t_{\\max}$ under the constant emissions assumption, report $E_{\\mathrm{rem}}$ as not-a-number. Express $E_{\\mathrm{rem}}$ in gigatonnes of carbon dioxide (GtCO$_2$), using $1\\,\\mathrm{PgC} = 3.667\\,\\mathrm{GtCO_2}$.\n\nNumerical requirements:\n- Integrate the coupled ordinary differential equations with a fixed time step $\\Delta t$ in years using a stable explicit scheme. Use a sufficiently small $\\Delta t$ to resolve the fast-decay carbon cycle mode and upper-ocean thermal adjustment. Use linear interpolation within the last time step to estimate the crossing time $t_{\\mathrm{hit}}$ and adjust the final budget accordingly.\n- Use the following physically plausible parameter values unless otherwise specified per test case: $\\beta = 5.35$ in $\\mathrm{W\\,m^{-2}}$, $(a_0,a_1,a_2,a_3) = (0.2173, 0.2240, 0.2824, 0.2763)$, $(\\tau_1,\\tau_2,\\tau_3) = (394.4, 36.54, 4.304)$ in years, $\\xi = 2.12$ in $\\mathrm{PgC\\,ppm^{-1}}$, $C_0 = 278$ in ppm.\n\nTasks:\n- For each test case below, compute three outputs: the remaining budget $E_{\\mathrm{rem}}$ with state-independent feedback ($\\eta=0$), the remaining budget with state-dependent feedback ($\\eta$ as specified in the test case definition), and their difference, all expressed in $\\mathrm{GtCO_2}$. The difference must be reported as the state-dependent budget minus the state-independent budget.\n\nTest suite:\n- Use the following four test cases. Each test case provides all parameters except $\\eta=0$, which you must compute additionally for comparison.\n\n1) General case (happy path) testing state dependence:\n  - $C_1 = 7.0$ in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$, $C_2 = 100.0$ in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$, $\\kappa = 0.7$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$,\n  - $\\lambda_0=1.2$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $\\eta=0.05$ in $\\mathrm{K^{-1}}$,\n  - $T(0)=1.2$ in $\\mathrm{K}$, $T_d(0)=0.8$ in $\\mathrm{K}$,\n  - $C_{\\mathrm{init}}=417.0$ in ppm, $C_0=278.0$ in ppm,\n  - $E_{\\mathrm{now}}=11.0$ in $\\mathrm{PgC\\,yr^{-1}}$, $F_{\\mathrm{nonCO_2}}=0.5$ in $\\mathrm{W\\,m^{-2}}$,\n  - $T^\\star=2.0$ in $\\mathrm{K}$,\n  - $\\Delta t=0.01$ in years, $t_{\\max}=2000.0$ in years.\n\n2) Boundary case where the target is already reached:\n  - Same as case $1$, except $T(0)=2.0$ in $\\mathrm{K}$.\n\n3) No future emissions (never reaches target within horizon):\n  - Same as case $1$, except $E_{\\mathrm{now}}=0.0$ in $\\mathrm{PgC\\,yr^{-1}}$.\n\n4) Stronger ocean heat uptake (slower approach):\n  - Same as case $1$, except $\\kappa=1.5$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, $C_2 = 150.0$ in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$.\n\nOutput specification:\n- Your program must output a single line containing a comma-separated Python-like list of four triplets, each triplet itself being a list of three numbers, in the order\n$$\n\\bigl[E_{\\mathrm{rem}}^{(\\eta=0)},\\ E_{\\mathrm{rem}}^{(\\eta)},\\ E_{\\mathrm{rem}}^{(\\eta)} - E_{\\mathrm{rem}}^{(\\eta=0)}\\bigr],\n$$\nwith all three entries in $\\mathrm{GtCO_2}$ for each test case, and the four triplets listed in the order of the test cases above. If a target is never reached within $t_{\\max}$, report the corresponding entry as a floating-point not-a-number. The entire output must be a single line string of the form\n\"[ [x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43] ]\" but without any spaces, for example: \"[[10.0,9.5,-0.5],[...],...]\".",
            "solution": "The user's problem statement is valid. It is scientifically grounded in established climate modeling principles, well-posed as an initial value problem for a system of ordinary differential equations (ODEs), and provides a complete and consistent set of parameters and conditions. The task is to quantify the impact of a state-dependent climate feedback parameter on the remaining carbon budget for a specified global warming target.\n\nThe solution involves numerically integrating a coupled system of equations for the climate and carbon cycle. This system is composed of a two-layer energy balance model (EBM) and a four-box impulse-response model for the carbon cycle. The state of the system is described by a vector $\\mathbf{y}(t) = [T(t), T_d(t), B_0(t), B_1(t), B_2(t), B_3(t)]^T$, where $T$ is the upper-ocean temperature anomaly, $T_d$ is the deep-ocean temperature anomaly, and $B_i$ are the atmospheric carbon burdens in different reservoirs.\n\nThe governing ODEs are:\n$$\n\\frac{dT}{dt} = \\frac{1}{C_1} \\left[ F(t) - \\lambda(T) T - \\kappa (T - T_d) \\right]\n$$\n$$\n\\frac{dT_d}{dt} = \\frac{\\kappa}{C_2} (T - T_d)\n$$\n$$\n\\frac{dB_0}{dt} = a_0 E(t)\n$$\n$$\n\\frac{dB_i}{dt} = a_i E(t) - \\frac{B_i}{\\tau_i} \\quad \\text{for } i \\in \\{1, 2, 3\\}\n$$\n\nThe terms within these equations are defined as follows:\n- The total radiative forcing is $F(t) = F_{\\mathrm{CO_2}}(t) + F_{\\mathrm{nonCO_2}}$, where $F_{\\mathrm{nonCO_2}}$ is a constant and $F_{\\mathrm{CO_2}}(t) = \\beta \\ln(C(t)/C_0)$.\n- The atmospheric $\\mathrm{CO_2}$ concentration is $C(t) = C_{\\mathrm{init}} + (B_0(t) + B_1(t) + B_2(t) + B_3(t)) / \\xi$.\n- The state-dependent climate feedback parameter is $\\lambda(T) = \\lambda_0(1 - \\eta T)$.\n- Future carbon emissions $E(t)$ are held constant at a rate $E_{\\mathrm{now}}$ until the warming target is reached.\n\nThe initial conditions are specified as $T(0)$, $T_d(0)$, and $C_{\\mathrm{init}}$. The carbon cycle is driven by future emissions, so the initial excess carbon burdens are zero: $B_i(0) = 0$ for all $i \\in \\{0, 1, 2, 3\\}$.\n\nTo solve this system numerically, we employ the explicit Forward Euler method, which is a stable and appropriate choice given the small required time step $\\Delta t = 0.01$ years. The stability of this scheme is ensured because $\\Delta t$ is much smaller than the fastest time scales in the system, namely the shortest carbon-cycle decay time $\\tau_3 = 4.304$ years and the upper-ocean thermal adjustment time $\\tau_T = C_1 / (\\lambda_0 + \\kappa) \\approx 3.68$ years.\n\nThe state vector at time step $n+1$ is updated from the state at step $n$ as:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n, t_n)\n$$\nwhere $t_n = n \\Delta t$ and $\\mathbf{f}$ is the vector of derivatives defined by the governing ODEs.\n\nThe primary objective is to find the remaining carbon budget, $E_{\\mathrm{rem}}$, which is the total amount of carbon that can be emitted until the upper-ocean temperature $T(t)$ first reaches a target warming level $T^\\star$. This is defined as $E_{\\mathrm{rem}} = E_{\\mathrm{now}} \\times t_{\\mathrm{hit}}$, where $t_{\\mathrm{hit}}$ is the time of crossing.\n\nThe computational procedure for each test case is as follows:\n1.  Initialize the state variables $T$, $T_d$, and all $B_i$ to their values at $t=0$.\n2.  Handle the boundary case: if $T(0) \\ge T^\\star$, the budget $E_{\\mathrm{rem}}$ is $0$ by definition, and the simulation terminates.\n3.  Iterate forward in time with a fixed step $\\Delta t$. In each step, calculate the derivatives of all state variables based on their current values and update them using the Forward Euler formula.\n4.  After each step, check if the temperature target has been crossed, i.e., if $T_{n+1} \\ge T^\\star$ while $T_n  T^\\star$.\n5.  If a crossing is detected between time $t_n$ and $t_{n+1}$, a more precise crossing time $t_{\\mathrm{hit}}$ is calculated using linear interpolation:\n    $$\n    t_{\\mathrm{hit}} = t_n + \\Delta t \\frac{T^\\star - T_n}{T_{n+1} - T_n}\n    $$\n6.  The remaining carbon budget in Petagrams of Carbon (PgC) is then $E_{\\mathrm{rem, PgC}} = E_{\\mathrm{now}} \\times t_{\\mathrm{hit}}$. This value is converted to Gigatonnes of Carbon Dioxide ($\\mathrm{GtCO_2}$) using the given conversion factor of $1 \\, \\mathrm{PgC} = 3.667 \\, \\mathrm{GtCO_2}$. The simulation for this set of parameters is then complete.\n7.  If the simulation reaches the maximum time $t_{\\max}$ without $T(t)$ ever reaching $T^\\star$, the budget is reported as not-a-number (NaN).\n8.  This entire procedure is performed twice for each test case: once with the specified state-dependence parameter $\\eta$, and once with $\\eta = 0$ for the baseline. The final output for each case is a triplet consisting of the baseline budget, the state-dependent budget, and their difference.\n\nA positive value for $\\eta$ implies that the climate feedback $\\lambda(T)$ weakens as the planet warms. This leads to accelerated warming, a shorter time to reach the target $T^\\star$, and consequently a smaller remaining carbon budget compared to the state-independent case ($\\eta=0$). Therefore, the expected difference, $E_{\\mathrm{rem}}^{(\\eta)} - E_{\\mathrm{rem}}^{(\\eta=0)}$, should be negative for cases where the budget is non-zero.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coupled EBM-carbon cycle model to find the remaining carbon budget.\n    \"\"\"\n\n    # Global constants from the problem description\n    BETA = 5.35  # W m^-2\n    A_COEFFS = np.array([0.2173, 0.2240, 0.2824, 0.2763])  # dimensionless\n    TAU_VALS = np.array([394.4, 36.54, 4.304])  # years; for B1, B2, B3\n    XI = 2.12  # PgC ppm^-1\n    PGC_TO_GTCO2 = 3.667  # GtCO2 / PgC\n\n    def run_simulation(C1, C2, kappa, lambda0, eta, T0, Td0, C_init, C0, E_now, F_nonCO2, T_star, dt, t_max):\n        \"\"\"\n        Integrates the model forward in time for a single set of parameters.\n        \"\"\"\n        # Initial state\n        T = T0\n        Td = Td0\n        B = np.zeros(4)  # B0, B1, B2, B3 in PgC\n\n        if T = T_star:\n            return 0.0\n\n        num_steps = int(t_max / dt)\n\n        for step in range(num_steps):\n            t_prev = step * dt\n            T_prev = T\n\n            # Calculate derivatives at the current state\n            A = np.sum(B)\n            C = C_init + A / XI\n            \n            # This check is for robustness; concentrations should not become non-positive.\n            if C = 0:\n                return np.nan \n            \n            F_co2 = BETA * np.log(C / C0)\n            F_total = F_co2 + F_nonCO2\n            \n            lambda_T = lambda0 * (1.0 - eta * T)\n            \n            dT_dt = (F_total - lambda_T * T - kappa * (T - Td)) / C1\n            dTd_dt = kappa * (T - Td) / C2\n            \n            dB_dt = np.zeros(4)\n            dB_dt[0] = A_COEFFS[0] * E_now\n            for i in range(1, 4):\n                dB_dt[i] = A_COEFFS[i] * E_now - B[i] / TAU_VALS[i-1]\n            \n            # Update state using Forward Euler\n            T += dT_dt * dt\n            Td += dTd_dt * dt\n            B += dB_dt * dt\n            \n            # Check for target crossing\n            if T = T_star:\n                t_curr = (step + 1) * dt\n                # Linearly interpolate to find the precise crossing time t_hit\n                if (T - T_prev) == 0:\n                    t_hit = t_curr\n                else:\n                    t_hit = t_prev + dt * (T_star - T_prev) / (T - T_prev)\n\n                E_rem_pgc = E_now * t_hit\n                E_rem_gtco2 = E_rem_pgc * PGC_TO_GTCO2\n                return E_rem_gtco2\n\n        # Target was not reached within the t_max horizon\n        return np.nan\n\n    # --- Test Suite Definition ---\n    base_case = {\n        \"C1\": 7.0, \"C2\": 100.0, \"kappa\": 0.7,\n        \"lambda0\": 1.2, \"eta\": 0.05,\n        \"T0\": 1.2, \"Td0\": 0.8,\n        \"C_init\": 417.0, \"C0\": 278.0,\n        \"E_now\": 11.0, \"F_nonCO2\": 0.5,\n        \"T_star\": 2.0,\n        \"dt\": 0.01, \"t_max\": 2000.0\n    }\n    \n    test_cases = [\n        # Case 1: General case\n        base_case.copy(),\n        # Case 2: Boundary case, target already reached\n        {**base_case, \"T0\": 2.0},\n        # Case 3: No future emissions\n        {**base_case, \"E_now\": 0.0},\n        # Case 4: Stronger ocean heat uptake\n        {**base_case, \"kappa\": 1.5, \"C2\": 150.0},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # State-independent run (eta = 0)\n        params_eta0 = (\n            case[\"C1\"], case[\"C2\"], case[\"kappa\"], case[\"lambda0\"], 0.0,\n            case[\"T0\"], case[\"Td0\"], case[\"C_init\"], case[\"C0\"],\n            case[\"E_now\"], case[\"F_nonCO2\"], case[\"T_star\"],\n            case[\"dt\"], case[\"t_max\"]\n        )\n        e_rem_eta0 = run_simulation(*params_eta0)\n        \n        # State-dependent run\n        params_eta = (\n            case[\"C1\"], case[\"C2\"], case[\"kappa\"], case[\"lambda0\"], case[\"eta\"],\n            case[\"T0\"], case[\"Td0\"], case[\"C_init\"], case[\"C0\"],\n            case[\"E_now\"], case[\"F_nonCO2\"], case[\"T_star\"],\n            case[\"dt\"], case[\"t_max\"]\n        )\n        e_rem_eta = run_simulation(*params_eta)\n\n        # Calculate difference, handling NaN propagation\n        if np.isnan(e_rem_eta) or np.isnan(e_rem_eta0):\n            diff = np.nan\n        else:\n            diff = e_rem_eta - e_rem_eta0\n            \n        all_results.append([e_rem_eta0, e_rem_eta, diff])\n\n    # Format the final output string exactly as specified\n    triplet_strings = []\n    for triplet in all_results:\n        # Use str() which correctly formats floats and 'nan' for np.nan\n        triplet_strings.append(f\"[{str(triplet[0])},{str(triplet[1])},{str(triplet[2])}]\")\n    \n    final_output_string = f\"[{','.join(triplet_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}