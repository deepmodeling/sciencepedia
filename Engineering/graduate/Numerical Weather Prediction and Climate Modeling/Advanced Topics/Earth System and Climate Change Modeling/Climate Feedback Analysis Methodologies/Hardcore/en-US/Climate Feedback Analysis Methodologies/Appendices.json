{
    "hands_on_practices": [
        {
            "introduction": "The surface albedo feedback is one of the most intuitive positive feedbacks in the climate system, where warming leads to melting ice and snow, reducing surface reflectivity and causing further absorption of solar radiation. This practice guides you through building a simplified climate model from first principles to quantify how changes in cryosphere extent alter the planetary energy balance . By deriving the feedback parameter from a set of physical assumptions, you will gain hands-on experience in translating a conceptual feedback loop into a quantitative, predictive tool.",
            "id": "4022287",
            "problem": "Consider a zonally aggregated energy-balance view of the climate system focusing on top-of-atmosphere (TOA) shortwave radiative processes that involve the cryosphere. The objective is to quantify the surface albedo feedback associated with snow and ice coverage changes under warming. Begin from the conservation of energy applied to the planetary radiation budget and the definition of planetary albedo, and treat all quantities as annual-mean values. Use the following modeling assumptions and definitions as the foundational base for your derivation and algorithmic formulation:\n\n1. The TOA net shortwave flux absorbed by the Earth system in a zone is $R_{\\mathrm{SW}} = S \\left(1 - \\alpha_{\\mathrm{p}}\\right)$, where $S$ is the incident shortwave radiation at TOA and $\\alpha_{\\mathrm{p}}$ is the planetary albedo.\n\n2. Partition the planetary albedo into a component due to clouds and atmosphere that is independent of surface properties and a component due to surface reflection that reaches TOA. Only the surface-reflected component is temperature dependent via cryospheric changes. For the surface-reflected component, model the atmospheric pathway using a single effective clear-sky shortwave transmissivity $t \\in [0,1]$ and a cloud fraction $c \\in [0,1]$ that occludes surface reflection in proportion to $(1-c)$. Ignore multiple scattering and any temperature dependence in $t$ and $c$.\n\n3. Represent the surface albedo as a mixture of ice/snow and background (ocean/land without seasonal snow) contributions. Let the surface albedo be $a_{\\mathrm{s}} = a_{\\mathrm{w}} + f \\left(a_{\\mathrm{i}} - a_{\\mathrm{w}}\\right)$, where $a_{\\mathrm{i}} \\in [0,1]$ is the ice/snow albedo, $a_{\\mathrm{w}} \\in [0,1]$ is the background albedo, and $f \\in [0,1]$ is the fractional cryosphere coverage in the zone.\n\n4. Model the fractional cryosphere coverage $f$ as a logistic function of the near-surface air temperature $T$ with respect to a melt threshold $T_0$: $f(T) = \\dfrac{1}{1 + \\exp\\left(\\beta \\left(T - T_0\\right)\\right)}$, where $\\beta > 0$ is a slope parameter that controls the sharpness of the transition. This functional form captures the smooth retreat of snow/ice with warming and is widely used in simple climate models.\n\n5. Define the surface albedo feedback parameter $\\lambda_{\\alpha}$ in the usual climate feedback framework as the negative of the sensitivity of the net TOA flux to temperature: $\\lambda_{\\alpha} = -\\dfrac{\\partial R}{\\partial T}$, and in this problem focus solely on the shortwave contribution due to the temperature dependence of $a_{\\mathrm{s}}$.\n\nYour task is to:\n- Derive, from the above base, an expression for the zonal contribution to $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$ as a function of $S$, $t$, $c$, $a_{\\mathrm{i}}$, $a_{\\mathrm{w}}$, $T$, $T_0$, and $\\beta$.\n- Aggregate a set of zones via area weights $w$ that sum to $1$ to obtain a multi-zone value of $\\lambda_{\\alpha}$ expressed in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$.\n- Implement a program that computes $\\lambda_{\\alpha}$ for each of the test cases below and produces the results as specified.\n\nAngles do not appear in this problem. All outputs must be expressed in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ as decimal floats rounded to six decimal places.\n\nTest Suite:\nEach test case consists of arrays of equal length $N$ for the zone parameters $S$, $t$, $c$, $T$, $T_0$, $\\beta$, $a_{\\mathrm{i}}$, $a_{\\mathrm{w}}$, with area weights $w$ such that $\\sum_{j=1}^{N} w_j = 1$. Compute a single aggregate $\\lambda_{\\alpha}$ per test case via the area-weighted sum of zonal contributions.\n\n- Test Case 1 (three-zone, cryosphere present in high latitudes, negligible in tropics):\n  - $S = [260, 340, 420]$ in $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.70, 0.78, 0.80]$\n  - $c = [0.55, 0.50, 0.60]$\n  - $T = [271, 285, 299]$ in $\\mathrm{K}$\n  - $T_0 = [273, 275, 273]$ in $\\mathrm{K}$\n  - $\\beta = [0.25, 0.08, 0.50]$ in $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.65, 0.50, 0.40]$\n  - $a_{\\mathrm{w}} = [0.15, 0.20, 0.06]$\n  - $w = [0.06, 0.34, 0.60]$\n\n- Test Case 2 (same as Test Case 1 but no albedo contrast, i.e., no cryosphere optical effect):\n  - $S = [260, 340, 420]$ in $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.70, 0.78, 0.80]$\n  - $c = [0.55, 0.50, 0.60]$\n  - $T = [271, 285, 299]$ in $\\mathrm{K}$\n  - $T_0 = [273, 275, 273]$ in $\\mathrm{K}$\n  - $\\beta = [0.25, 0.08, 0.50]$ in $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.15, 0.20, 0.06]$\n  - $a_{\\mathrm{w}} = [0.15, 0.20, 0.06]$\n  - $w = [0.06, 0.34, 0.60]$\n\n- Test Case 3 (two-zone, very cloudy polar zone suppresses kernel, clear midlatitudes near threshold dominate):\n  - $S = [240, 320]$ in $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.65, 0.85]$\n  - $c = [0.90, 0.20]$\n  - $T = [268, 278]$ in $\\mathrm{K}$\n  - $T_0 = [273, 275]$ in $\\mathrm{K}$\n  - $\\beta = [0.40, 0.20]$ in $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.70, 0.55]$\n  - $a_{\\mathrm{w}} = [0.20, 0.18]$\n  - $w = [0.08, 0.92]$\n\n- Test Case 4 (single-zone boundary with zero transmissivity, null kernel):\n  - $S = [340]$ in $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.00]$\n  - $c = [0.50]$\n  - $T = [270]$ in $\\mathrm{K}$\n  - $T_0 = [273]$ in $\\mathrm{K}$\n  - $\\beta = [0.30]$ in $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.70]$\n  - $a_{\\mathrm{w}} = [0.10]$\n  - $w = [1.00]$\n\nProgram Output Specification:\nYour program should produce a single line of output containing the aggregate results for the four test cases as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4]$, where each $x_i$ is the computed $\\lambda_{\\alpha}$ in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ rounded to six decimal places with standard rounding rules.",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded in the principles of climate energy balance, is mathematically well-posed, and uses objective, formal language. It presents a standard, albeit simplified, problem in climate feedback analysis that can be solved through direct derivation and computation.\n\nThe objective is to derive an expression for the surface albedo feedback parameter, $\\lambda_{\\alpha}$, and compute its value for several test cases. The feedback parameter is defined as $\\lambda_{\\alpha} = -\\dfrac{\\partial R}{\\partial T}$, where we focus on the shortwave radiation component, $R_{\\mathrm{SW}}$, and its dependence on temperature $T$ through surface albedo changes.\n\nThe derivation proceeds as follows.\n\n1.  **Formulate the Planetary Albedo, $\\alpha_{\\mathrm{p}}$**:\n    The problem asks to partition the planetary albedo, $\\alpha_{\\mathrm{p}}$, into two parts: a component independent of the surface, and a component due to surface reflection that reaches the top of the atmosphere (TOA). Let's model the fluxes. The total shortwave radiation reflected to space is $S \\alpha_{\\mathrm{p}}$. This is the sum of radiation reflected by the atmosphere and clouds, and radiation reflected from the surface that successfully travels back up to space.\n    Let $\\alpha_{\\mathrm{atm+cld}}$ be the albedo component from the atmosphere and clouds that is independent of surface properties.\n    The surface-reflected component is modulated by the atmosphere. Solar radiation must first pass down through the atmosphere, reflect, and then pass back up. The problem provides an effective clear-sky transmissivity $t$ and a cloud fraction $c$. Surface reflection is occluded by clouds, so it is only relevant for the clear-sky portion of the zone, which has a fractional area of $(1-c)$.\n    In this clear-sky fraction, radiation is transmitted downwards, reflects off the surface with albedo $a_{\\mathrm{s}}$, and is transmitted upwards. The two-way transmissivity for flux is $t^2$.\n    Thus, the portion of planetary albedo contributed by surface reflection is $(1-c) t^2 a_{\\mathrm{s}}$.\n    The total planetary albedo is the sum of the atmospheric/cloud contribution and the surface contribution:\n    $$ \\alpha_{\\mathrm{p}} = \\alpha_{\\mathrm{atm+cld}} + (1-c) t^2 a_{\\mathrm{s}} $$\n    Here, $\\alpha_{\\mathrm{atm+cld}}$, $c$, and $t$ are assumed to be independent of the near-surface air temperature $T$. The temperature dependence enters through the surface albedo, $a_{\\mathrm{s}}$.\n\n2.  **Formulate the Net Shortwave Flux, $R_{\\mathrm{SW}}$**:\n    The net shortwave flux absorbed by the system is given by definition $1$:\n    $$ R_{\\mathrm{SW}} = S (1 - \\alpha_{\\mathrm{p}}) $$\n    Substituting our expression for $\\alpha_{\\mathrm{p}}$:\n    $$ R_{\\mathrm{SW}} = S \\left(1 - \\left[\\alpha_{\\mathrm{atm+cld}} + (1-c) t^2 a_{\\mathrm{s}}\\right]\\right) = S(1 - \\alpha_{\\mathrm{atm+cld}}) - S(1-c)t^2 a_{\\mathrm{s}} $$\n\n3.  **Differentiate $R_{\\mathrm{SW}}$ with respect to Temperature $T$**:\n    We need to find $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$. All parameters except $a_{\\mathrm{s}}$ are treated as constants with respect to $T$.\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ S(1 - \\alpha_{\\mathrm{atm+cld}}) - S(1-c)t^2 a_{\\mathrm{s}}(T) \\right] $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = -S(1-c)t^2 \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} $$\n\n4.  **Differentiate Surface Albedo $a_{\\mathrm{s}}$ with respect to Temperature $T$**:\n    The surface albedo $a_{\\mathrm{s}}$ is given by definition $3$ as a linear mix based on cryosphere fraction $f$:\n    $$ a_{\\mathrm{s}} = a_{\\mathrm{w}} + f(T) (a_{\\mathrm{i}} - a_{\\mathrm{w}}) $$\n    The parameters $a_{\\mathrm{w}}$ and $a_{\\mathrm{i}}$ (background and ice albedos) are constant. Differentiating with respect to $T$ gives:\n    $$ \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} = (a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\frac{\\partial f}{\\partial T} $$\n\n5.  **Differentiate Cryosphere Fraction $f$ with respect to Temperature $T$**:\n    The cryosphere fraction $f$ is modeled as a logistic function of $T$, as per definition $4$:\n    $$ f(T) = \\frac{1}{1 + \\exp\\left(\\beta (T - T_0)\\right)} $$\n    To find the derivative $\\dfrac{\\partial f}{\\partial T}$, we use the chain rule. Let $u = \\beta(T-T_0)$, so $f(u) = (1+e^u)^{-1}$.\n    $$ \\frac{\\partial f}{\\partial T} = \\frac{df}{du} \\frac{du}{dT} $$\n    The derivatives are:\n    $$ \\frac{du}{dT} = \\beta $$\n    $$ \\frac{df}{du} = -(1+e^u)^{-2} e^u = -\\frac{1}{1+e^u} \\cdot \\frac{e^u}{1+e^u} $$\n    We can express this in terms of $f$. We know $f = \\dfrac{1}{1+e^u}$.\n    Also, $1-f = 1 - \\dfrac{1}{1+e^u} = \\dfrac{1+e^u-1}{1+e^u} = \\dfrac{e^u}{1+e^u}$.\n    Substituting these back into the expression for $\\dfrac{df}{du}$:\n    $$ \\frac{df}{du} = -f(1-f) $$\n    Therefore, the derivative with respect to temperature is:\n    $$ \\frac{\\partial f}{\\partial T} = -\\beta f(1-f) $$\n\n6.  **Assemble the Expression for $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$**:\n    We substitute the results from steps $4$ and $5$ back into the expression from step $3$.\n    $$ \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} = -(a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\beta f(1-f) $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = -S(1-c)t^2 \\left[ -(a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\beta f(1-f) \\right] $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = S t^2 (1-c) \\beta (a_{\\mathrm{i}} - a_{\\mathrm{w}}) f(1-f) $$\n    This expression represents the change in net TOA shortwave radiation for a unit change in surface temperature for a single zone. A positive value indicates that as temperature increases, more shortwave radiation is absorbed, which is characteristic of a positive feedback.\n\n7.  **Calculate the Aggregate Feedback Parameter $\\lambda_{\\alpha}$**:\n    The feedback parameter is defined as $\\lambda_{\\alpha} = -\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$. For a single zone $j$, this gives:\n    $$ \\lambda_{\\alpha,j} = -S_j t_j^2 (1-c_j) \\beta_j (a_{\\mathrm{i},j} - a_{\\mathrm{w},j}) f_j(1-f_j) $$\n    where $f_j = \\left(1 + \\exp\\left(\\beta_j (T_j - T_{0,j})\\right)\\right)^{-1}$.\n    The globally- or multi-zonally-aggregated feedback parameter is the area-weighted sum of the zonal contributions:\n    $$ \\lambda_{\\alpha} = \\sum_{j=1}^{N} w_j \\lambda_{\\alpha,j} $$\n    Substituting the expression for $\\lambda_{\\alpha,j}$:\n    $$ \\lambda_{\\alpha} = - \\sum_{j=1}^{N} w_j S_j t_j^2 (1-c_j) \\beta_j (a_{\\mathrm{i},j} - a_{\\mathrm{w},j}) f_j(1-f_j) $$\n    This is the final expression to be implemented. The units are determined by the units of $S$ ($\\mathrm{W \\, m^{-2}}$) and $\\beta$ ($\\mathrm{K^{-1}}$), resulting in $\\mathrm{W \\, m^{-2} \\, K^{-1}}$, as required. This formula will be used to compute the results for the given test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the aggregate surface albedo feedback parameter for multiple test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (\n            np.array([260., 340., 420.]),       # S\n            np.array([0.70, 0.78, 0.80]),       # t\n            np.array([0.55, 0.50, 0.60]),       # c\n            np.array([271., 285., 299.]),       # T\n            np.array([273., 275., 273.]),       # T0\n            np.array([0.25, 0.08, 0.50]),       # beta\n            np.array([0.65, 0.50, 0.40]),       # a_i\n            np.array([0.15, 0.20, 0.06]),       # a_w\n            np.array([0.06, 0.34, 0.60]),       # w\n        ),\n        # Test Case 2\n        (\n            np.array([260., 340., 420.]),       # S\n            np.array([0.70, 0.78, 0.80]),       # t\n            np.array([0.55, 0.50, 0.60]),       # c\n            np.array([271., 285., 299.]),       # T\n            np.array([273., 275., 273.]),       # T0\n            np.array([0.25, 0.08, 0.50]),       # beta\n            np.array([0.15, 0.20, 0.06]),       # a_i (same as a_w)\n            np.array([0.15, 0.20, 0.06]),       # a_w\n            np.array([0.06, 0.34, 0.60]),       # w\n        ),\n        # Test Case 3\n        (\n            np.array([240., 320.]),             # S\n            np.array([0.65, 0.85]),             # t\n            np.array([0.90, 0.20]),             # c\n            np.array([268., 278.]),             # T\n            np.array([273., 275.]),             # T0\n            np.array([0.40, 0.20]),             # beta\n            np.array([0.70, 0.55]),             # a_i\n            np.array([0.20, 0.18]),             # a_w\n            np.array([0.08, 0.92]),             # w\n        ),\n        # Test Case 4\n        (\n            np.array([340.]),                   # S\n            np.array([0.00]),                   # t\n            np.array([0.50]),                   # c\n            np.array([270.]),                   # T\n            np.array([273.]),                   # T0\n            np.array([0.30]),                   # beta\n            np.array([0.70]),                   # a_i\n            np.array([0.10]),                   # a_w\n            np.array([1.00]),                   # w\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        S, t, c, T, T0, beta, a_i, a_w, w = case\n\n        # Calculate fractional cryosphere coverage f for each zone\n        # f = 1 / (1 + exp(beta * (T - T0)))\n        f = 1.0 / (1.0 + np.exp(beta * (T - T0)))\n\n        # The derivative df/dT can be expressed as -beta * f * (1-f)\n        # The full expression for the zonal feedback is:\n        # lambda_alpha_j = -S_j * t_j^2 * (1-c_j) * beta_j * (a_i_j - a_w_j) * f_j * (1-f_j)\n        \n        # Calculate the zonal feedback values using vectorized operations\n        lambda_alpha_zonal = -S * t**2 * (1 - c) * beta * (a_i - a_w) * f * (1 - f)\n\n        # Calculate the aggregate feedback by taking the area-weighted sum\n        lambda_alpha_total = np.sum(w * lambda_alpha_zonal)\n\n        results.append(f\"{lambda_alpha_total:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In practice, different climate feedbacks do not operate in isolation; they are often coupled. This exercise introduces the powerful radiative kernel methodology, a standard research tool for separating and quantifying the radiative impacts of atmospheric changes. You will use this framework to explore the tight coupling between the water vapor feedback (a strong positive feedback) and the lapse-rate feedback (a negative feedback), and see how their combined effect varies dramatically under different atmospheric conditions . This practice is crucial for understanding the architecture of modern climate feedback analysis.",
            "id": "4022293",
            "problem": "Consider a vertically discretized atmospheric column used in numerical weather prediction and climate modeling. The goal is to quantify the coupling between water vapor and lapse-rate feedbacks using a linearized radiative kernel framework at the Top of Atmosphere (TOA). Starting from a physically grounded base, use the following principles:\n\n- The net TOA radiative perturbation $dR$ due to small changes in the atmospheric state can be linearized as a sum of contributions from temperature and water vapor:\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i),\n$$\nwhere $K_T(i)$ has units $\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $K_q(i)$ has units $\\mathrm{W \\, m^{-2} \\, (kg/kg)^{-1}}$, $dT(i)$ is the temperature change at level $i$ in $\\mathrm{K}$, and $dq(i)$ is the specific humidity change at level $i$ in $\\mathrm{kg/kg}$. The integer $N$ is the number of vertical levels.\n\n- Under fixed relative humidity, the Clausius–Clapeyron relation links the fractional change of saturation specific humidity $q_s$ to temperature via\n$$\n\\frac{d \\ln q_s}{dT} \\approx \\frac{L_v}{R_v \\, T^2},\n$$\nwhere $L_v$ is the latent heat of vaporization in $\\mathrm{J \\, kg^{-1}}$, $R_v$ is the gas constant for water vapor in $\\mathrm{J \\, kg^{-1} \\, K^{-1}}$, and $T$ is absolute temperature in $\\mathrm{K}$. With relative humidity held fixed, a small temperature change $dT(i)$ at level $i$ produces\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i),\n$$\nwhere $q(i)$ is the background specific humidity at level $i$.\n\n- A lapse-rate mediated coupling is represented by a level-dependent factor $\\gamma(i)$ such that the temperature change at level $i$ is linked to the surface temperature change $dT_s$ by\n$$\ndT(i) = \\gamma(i) \\, dT_s,\n$$\nwhere $\\gamma(i)$ is dimensionless and $dT_s$ is in $\\mathrm{K}$.\n\n- The effective climate feedback parameter is defined as\n$$\n\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s},\n$$\nwith units $\\mathrm{W \\, m^{-2} \\, K^{-1}}$. Positive $\\lambda_{\\mathrm{eff}}$ indicates a stabilizing response, while negative $\\lambda_{\\mathrm{eff}}$ indicates a destabilizing response under the adopted sign convention.\n\nYour task is to implement a program that computes $\\lambda_{\\mathrm{eff}}$ for a set of scientifically plausible test cases using the prescribed constants and vertical profiles. Assume $dT_s = 1.0 \\, \\mathrm{K}$ so that $\\lambda_{\\mathrm{eff}} = dR$ numerically. Use $L_v = 2500000 \\, \\mathrm{J \\, kg^{-1}}$ and $R_v = 461 \\, \\mathrm{J \\, kg^{-1} \\, K^{-1}}$. All temperature values are in $\\mathrm{K}$ and specific humidity values are in $\\mathrm{kg/kg}$.\n\nImplement the following test suite (each case provides arrays of length $N=6$ levels, ordered from near-surface to upper troposphere):\n\n- Case A (Tropics with strong upper-level warming coupling):\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [540.0, 450.0, 420.0, 360.0, 300.0, 240.0]$\n    - $\\gamma = [1.00, 1.20, 1.30, 1.50, 1.60, 1.70]$\n\n- Case B (Polar, colder and drier with uniform warming profile):\n    - $T = [270.0, 264.0, 255.0, 240.0, 220.0, 205.0]$\n    - $q = [0.0040, 0.0030, 0.0020, 0.0010, 0.0005, 0.0002]$\n    - $K_T = [-0.30, -0.25, -0.25, -0.30, -0.40, -0.50]$\n    - $K_q = [300.0, 240.0, 210.0, 180.0, 150.0, 120.0]$\n    - $\\gamma = [1.00, 1.00, 1.00, 1.00, 1.00, 1.00]$\n\n- Case C (Dry atmosphere limit, identical to Case A but with zero water vapor kernel):\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$\n    - $\\gamma = [1.00, 1.20, 1.30, 1.50, 1.60, 1.70]$\n\n- Case D (Weak lapse-rate coupling, uniform warming with tropical humidity and kernels):\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [540.0, 450.0, 420.0, 360.0, 300.0, 240.0]$\n    - $\\gamma = [1.00, 1.00, 1.00, 1.00, 1.00, 1.00]$\n\nAlgorithmic requirements:\n\n- For each case, compute $dT(i) = \\gamma(i) \\, dT_s$ with $dT_s = 1.0$.\n- Compute $dq(i) = q(i) \\, \\dfrac{L_v}{R_v \\, T(i)^2} \\, dT(i)$.\n- Compute $dR = \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i)$.\n- Return $\\lambda_{\\mathrm{eff}} = dR$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n\nRequired output:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$).\n- Express each $\\lambda_{\\mathrm{eff}}$ value as a float rounded to four decimal places, in units of $\\mathrm{W \\, m^{-2} \\, K^{-1}}$.\n\nDesign considerations and coverage:\n\n- The test suite spans a general tropical case with strong upper-level coupling (Case A), a colder and drier polar case with uniform warming (Case B), an edge-case dry limit with no water vapor kernel (Case C), and a weak lapse-rate coupling case where $\\gamma(i)$ is uniform (Case D).\n- All inputs are scientifically plausible and self-consistent, and the procedure is universally applicable within the linearized kernel methodology for climate feedback analysis.",
            "solution": "The problem statement is scientifically sound, well-posed, and provides all necessary information to compute a unique solution. It is a standard exercise in climate feedback analysis using the established radiative kernel methodology. The provided test cases are physically plausible representations of different atmospheric conditions. No invalidating flaws are identified.\n\nThe objective is to compute the effective climate feedback parameter, $\\lambda_{\\mathrm{eff}}$, which quantifies the net Top of Atmosphere (TOA) radiative response to a surface temperature perturbation. The calculation is based on a linearized model that separates the total radiative perturbation, $dR$, into contributions from temperature changes and specific humidity changes throughout a discretized atmospheric column.\n\nThe fundamental equation provided is:\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i)\n$$\nHere, $N$ is the number of vertical levels, $K_T(i)$ and $K_q(i)$ are the temperature and water vapor radiative kernels at level $i$, and $dT(i)$ and $dq(i)$ are the respective changes in temperature and specific humidity at that level.\n\nThe changes $dT(i)$ and $dq(i)$ are not independent. They are coupled to the surface temperature change, $dT_s$. The temperature change at level $i$ is related to $dT_s$ through a lapse-rate coupling factor, $\\gamma(i)$:\n$$\ndT(i) = \\gamma(i) \\, dT_s\n$$\nThe change in specific humidity, $dq(i)$, is governed by the Clausius–Clapeyron relation, under the assumption that relative humidity remains constant. This assumption links the humidity change to the local temperature change, $dT(i)$:\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i)\n$$\nwhere $T(i)$ and $q(i)$ are the background temperature and specific humidity at level $i$, $L_v$ is the latent heat of vaporization ($2,500,000 \\, \\mathrm{J\\,kg^{-1}}$), and $R_v$ is the gas constant for water vapor ($461 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$).\n\nBy substituting the expression for $dT(i)$ into the equation for $dq(i)$, we can express the humidity change directly in terms of the surface temperature change:\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\left(\\gamma(i) \\, dT_s\\right)\n$$\n\nNow, we substitute the expressions for both $dT(i)$ and $dq(i)$ back into the primary equation for $dR$:\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\left(\\gamma(i) \\, dT_s\\right) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\left(q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\gamma(i) \\, dT_s\\right)\n$$\nThe effective climate feedback parameter is defined as $\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s}$. Dividing the expression for $dR$ by $dT_s$ yields the final formula for $\\lambda_{\\mathrm{eff}}$:\n$$\n\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s} \\approx \\sum_{i=1}^{N} \\left[ K_T(i) \\, \\gamma(i) \\;+\\; K_q(i) \\, q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\gamma(i) \\right]\n$$\nThis can be rearranged for computational clarity:\n$$\n\\lambda_{\\mathrm{eff}} \\approx \\sum_{i=1}^{N} \\gamma(i) \\left[ K_T(i) \\;+\\; K_q(i) \\, q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\right]\n$$\nThe problem specifies using $dT_s = 1.0 \\, \\mathrm{K}$, which simplifies the calculation such that $\\lambda_{\\mathrm{eff}}$ is numerically equal to $dR$. The algorithmic procedure is a direct implementation of this calculation.\n\nFor each test case and each level $i$ from $1$ to $N=6$:\n1.  Calculate the temperature change: $dT(i) = \\gamma(i) \\cdot (1.0 \\, \\mathrm{K})$.\n2.  Calculate the specific humidity change: $dq(i) = q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i)$.\n3.  Calculate the total radiative perturbation by summing the contributions from all levels: $dR = \\sum_{i=1}^{N} \\left[ K_T(i) \\, dT(i) + K_q(i) \\, dq(i) \\right]$.\n4.  The result is $\\lambda_{\\mathrm{eff}} = dR$, with units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n\nThis procedure will be applied to the four provided test cases using array-based computations for efficiency. The results will be rounded to four decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective climate feedback parameter lambda_eff for a set of\n    test cases using a linearized radiative kernel framework.\n    \"\"\"\n    \n    # Define physical constants\n    L_v = 2_500_000.0  # Latent heat of vaporization in J/kg\n    R_v = 461.0        # Gas constant for water vapor in J/(kg*K)\n    dT_s = 1.0         # Surface temperature change in K\n\n    # Define the test suite\n    test_cases = {\n        'A': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([540.0, 450.0, 420.0, 360.0, 300.0, 240.0]),\n            'gamma': np.array([1.00, 1.20, 1.30, 1.50, 1.60, 1.70])\n        },\n        'B': {\n            'T': np.array([270.0, 264.0, 255.0, 240.0, 220.0, 205.0]),\n            'q': np.array([0.0040, 0.0030, 0.0020, 0.0010, 0.0005, 0.0002]),\n            'K_T': np.array([-0.30, -0.25, -0.25, -0.30, -0.40, -0.50]),\n            'K_q': np.array([300.0, 240.0, 210.0, 180.0, 150.0, 120.0]),\n            'gamma': np.array([1.00, 1.00, 1.00, 1.00, 1.00, 1.00])\n        },\n        'C': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),\n            'gamma': np.array([1.00, 1.20, 1.30, 1.50, 1.60, 1.70])\n        },\n        'D': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([540.0, 450.0, 420.0, 360.0, 300.0, 240.0]),\n            'gamma': np.array([1.00, 1.00, 1.00, 1.00, 1.00, 1.00])\n        }\n    }\n    \n    results = []\n    # Process test cases in specified order: A, B, C, D\n    for case_id in sorted(test_cases.keys()):\n        case_data = test_cases[case_id]\n        \n        # Extract data for the current case\n        T = case_data['T']\n        q = case_data['q']\n        K_T = case_data['K_T']\n        K_q = case_data['K_q']\n        gamma = case_data['gamma']\n        \n        # Step 1: Compute the temperature change at each level i\n        # dT(i) = gamma(i) * dT_s\n        dT = gamma * dT_s\n        \n        # Step 2: Compute the specific humidity change at each level i\n        # dq(i) = q(i) * (L_v / (R_v * T(i)^2)) * dT(i)\n        clausius_clapeyron_factor = L_v / (R_v * T**2)\n        dq = q * clausius_clapeyron_factor * dT\n        \n        # Step 3: Compute the total radiative perturbation dR\n        # dR = sum( K_T(i)*dT(i) ) + sum( K_q(i)*dq(i) )\n        dR_T = np.sum(K_T * dT)\n        dR_q = np.sum(K_q * dq)\n        dR = dR_T + dR_q\n        \n        # Step 4: The effective feedback parameter lambda_eff is dR since dT_s = 1.0\n        lambda_eff = dR\n        \n        results.append(lambda_eff)\n        \n    # Format the final output as a comma-separated list of floats\n    # rounded to four decimal places, enclosed in square brackets.\n    print(f\"[{','.join([f'{r:.4f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice moves to the frontier of climate science by challenging the simplifying assumption of a constant climate feedback parameter. You will engage with the advanced concepts of state-dependent feedbacks and spatial pattern effects, which propose that feedback strength can change as the climate warms or depending on the geographical pattern of that warming . By solving a non-linear equilibrium problem, you will see how these complexities can modulate the overall climate sensitivity, a key step toward understanding the uncertainties in long-term climate projections.",
            "id": "4022299",
            "problem": "You are tasked with implementing and analyzing a simplified methodology for quantifying pattern effects and state-dependent feedbacks in a global energy balance model relevant to numerical weather prediction and climate modeling. The aim is to compute the equilibrium warming under a specified radiative forcing when both pattern effects and state-dependent feedbacks modulate the effective climate feedback strength.\n\nBegin from the Top Of Atmosphere (TOA) energy balance, which states that at any time the net downward radiative flux at the TOA, denoted by $N$, is the difference between an externally imposed radiative forcing $F$ and the atmosphere’s radiative response $R$. At equilibrium, by definition, $N$ is zero. The radiative response is assumed to arise from two contributions:\n\n- A globally aggregated climate feedback that depends on the global-mean surface temperature anomaly $T$ through a state-dependent feedback parameter $\\lambda(T)$.\n- A spatial pattern effect term constructed from regional kernels applied to the regional temperature pattern.\n\nThe modeling assumptions to use are:\n\n- The radiative response $R$ is expressed as $R = \\lambda(T) \\, T + P(T, \\text{pattern})$, where $\\lambda(T) = \\lambda_0 + \\alpha \\, T$, with $\\lambda_0$ being the baseline feedback parameter and $\\alpha$ capturing its state dependence ($\\alpha$ can be positive or negative). Units for $\\lambda_0$ are $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ and for $\\alpha$ are $\\mathrm{W \\, m^{-2} \\, K^{-2}}$.\n- The pattern effect $P(T, \\text{pattern})$ is represented by a discrete regional sum $P = \\sum_{i=1}^{n} k_i \\, w_i \\, T_i$, where $k_i$ are region-specific kernels (units $\\mathrm{W \\, m^{-2} \\, K^{-1}}$), $w_i$ are nonnegative area weights satisfying $\\sum_i w_i = 1$, and $T_i$ are regional temperature anomalies. The regional anomalies are parameterized as $T_i = r_i \\, T$, where $r_i$ are dimensionless regional amplification ratios relative to the global mean.\n\nUnder these assumptions, the TOA balance at equilibrium is $0 = F - \\left[\\lambda(T) \\, T + \\sum_{i=1}^{n} k_i \\, w_i \\, r_i \\, T \\right]$. Your task is to compute the equilibrium global-mean temperature anomaly $T_{\\text{eq}}$ that satisfies the equilibrium condition for a given parameter set $\\left(F, \\lambda_0, \\alpha, \\{k_i\\}_{i=1}^n, \\{w_i\\}_{i=1}^n, \\{r_i\\}_{i=1}^n\\right)$. Express $T_{\\text{eq}}$ in $\\mathrm{K}$, rounded to $2$ decimals.\n\nDesign and implement a robust algorithm that:\n- Computes the aggregated pattern effect contribution $\\gamma = \\sum_{i=1}^{n} k_i \\, w_i \\, r_i$ (units $\\mathrm{W \\, m^{-2} \\, K^{-1}}$).\n- Solves the equilibrium condition for $T_{\\text{eq}}$ without assuming linear feedback a priori. Ensure numerical stability by correctly handling the special case $\\alpha \\approx 0$ (i.e., negligible state dependence) without division by zero.\n- Selects the physically relevant nonnegative solution for $T_{\\text{eq}}$.\n\nUse the following test suite of parameter sets, which exercise distinct scenarios. All kernels, weights, and ratios are provided as lists with length $n$ appropriate to each case. Each case is a tuple containing $\\left(F, \\lambda_0, \\alpha, k, w, r\\right)$ and is specified with units as indicated:\n\n- Case $1$ (general \"happy path\"): $F = 3.7~\\mathrm{W \\, m^{-2}}$, $\\lambda_0 = 1.2~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $\\alpha = 0.05~\\mathrm{W \\, m^{-2} \\, K^{-2}}$, $k = [-0.2, 0.1, 0.05, 0.0]~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $w = [0.4, 0.2, 0.25, 0.15]$ (dimensionless, summing to $1$), $r = [0.9, 1.3, 1.6, 1.0]$ (dimensionless).\n- Case $2$ (boundary: zero pattern and zero state dependence): $F = 3.7~\\mathrm{W \\, m^{-2}}$, $\\lambda_0 = 1.05~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $\\alpha = 0.0~\\mathrm{W \\, m^{-2} \\, K^{-2}}$, $k = [0.0, 0.0, 0.0]~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $w = [0.5, 0.3, 0.2]$, $r = [1.0, 1.0, 1.0]$.\n- Case $3$ (state dependence and negative kernels that reduce the effective feedback): $F = 3.7~\\mathrm{W \\, m^{-2}}$, $\\lambda_0 = 1.5~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $\\alpha = 0.08~\\mathrm{W \\, m^{-2} \\, K^{-2}}$, $k = [-0.3, -0.1, -0.05]~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $w = [0.5, 0.3, 0.2]$, $r = [1.4, 0.8, 1.2]$.\n- Case $4$ (mixed-sign kernels and small state dependence): $F = 3.7~\\mathrm{W \\, m^{-2}}$, $\\lambda_0 = 0.9~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $\\alpha = 0.02~\\mathrm{W \\, m^{-2} \\, K^{-2}}$, $k = [0.15, -0.25, 0.05, -0.1]~\\mathrm{W \\, m^{-2} \\, K^{-1}}$, $w = [0.3, 0.3, 0.2, 0.2]$, $r = [1.1, 1.3, 0.7, 1.8]$.\n\nYour program should produce a single line of output containing the equilibrium global-mean temperature anomalies for the $4$ test cases as a comma-separated list enclosed in square brackets, in kelvins and rounded to $2$ decimals, for example, $[T_1,T_2,T_3,T_4]$ where each $T_i$ is a float in $\\mathrm{K}$.",
            "solution": "The problem statement has been rigorously validated and is determined to be scientifically grounded, self-contained, and well-posed. It presents a simplified but standard formulation of a global energy balance model used in climate science, free from contradictions or ambiguities. All required parameters and conditions are explicitly provided.\n\nThe objective is to determine the equilibrium global-mean surface temperature anomaly, denoted as $T_{\\text{eq}}$, under a specified radiative forcing $F$. The model incorporates both a state-dependent climate feedback and a spatial pattern effect.\n\nThe analysis begins with the Top Of Atmosphere (TOA) energy balance equation at equilibrium, where the net downward radiative flux $N$ is zero:\n$$N = F - R = 0 \\implies F = R$$\nHere, $F$ is the external radiative forcing and $R$ is the outgoing radiative response of the climate system. The response $R$ is modeled as the sum of a globally aggregated feedback term and a spatial pattern effect term $P$:\n$$R = \\lambda(T) \\, T + P(T, \\text{pattern})$$\nThe climate feedback parameter $\\lambda(T)$ is state-dependent, given by the linear relationship:\n$$\\lambda(T) = \\lambda_0 + \\alpha \\, T$$\nwhere $\\lambda_0$ is the baseline feedback parameter, $\\alpha$ is the state-dependence coefficient, and $T$ is the global-mean temperature anomaly.\n\nThe pattern effect $P$ is parameterized as a sum over $n$ geographical regions:\n$$P = \\sum_{i=1}^{n} k_i \\, w_i \\, T_i$$\nwhere for each region $i$, $k_i$ is the radiative kernel, $w_i$ is the area weight, and $T_i$ is the regional temperature anomaly. The regional anomalies are related to the global-mean anomaly $T$ by amplification ratios $r_i$:\n$$T_i = r_i \\, T$$\nSubstituting this into the expression for $P$ allows it to be expressed as a function of $T$:\n$$P = \\sum_{i=1}^{n} k_i \\, w_i \\, (r_i \\, T) = \\left( \\sum_{i=1}^{n} k_i \\, w_i \\, r_i \\right) T$$\nFollowing the problem's directive, we define an aggregated pattern effect parameter $\\gamma$ as:\n$$\\gamma = \\sum_{i=1}^{n} k_i \\, w_i \\, r_i$$\nThe units of $\\gamma$ are $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, identical to a feedback parameter. Thus, the total radiative response can be written as:\n$$R = (\\lambda_0 + \\alpha T) T + \\gamma T$$\nSubstituting this expression for $R$ into the equilibrium condition $F = R$ yields:\n$$F = (\\lambda_0 + \\alpha T) T + \\gamma T$$\n$$F = \\lambda_0 T + \\alpha T^2 + \\gamma T$$\nRearranging this into the standard form of a quadratic equation, $a x^2 + b x + c = 0$, with $x = T_{\\text{eq}}$, we obtain:\n$$\\alpha T_{\\text{eq}}^2 + (\\lambda_0 + \\gamma) T_{\\text{eq}} - F = 0$$\nThe coefficients of this quadratic equation for $T_{\\text{eq}}$ are:\n$$a = \\alpha$$\n$$b = \\lambda_0 + \\gamma$$\n$$c = -F$$\nThe solution to this equation is contingent on the value of $\\alpha$.\n\nCase 1: No state dependence ($\\alpha = 0$)\nIf $\\alpha = 0$, the equation simplifies to a linear equation:\n$$(\\lambda_0 + \\gamma) T_{\\text{eq}} - F = 0$$\nThe solution for the equilibrium temperature anomaly is then:\n$$T_{\\text{eq}} = \\frac{F}{\\lambda_0 + \\gamma}$$\nThis corresponds to a model with a constant effective feedback parameter $\\lambda_{\\text{eff}} = \\lambda_0 + \\gamma$.\n\nCase 2: State dependence ($\\alpha \\neq 0$)\nIf $\\alpha \\neq 0$, we solve the quadratic equation. The standard quadratic formula gives two solutions:\n$$T_{\\text{eq}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\nSubstituting our coefficients:\n$$T_{\\text{eq}} = \\frac{-(\\lambda_0 + \\gamma) \\pm \\sqrt{(\\lambda_0 + \\gamma)^2 - 4(\\alpha)(-F)}}{2\\alpha} = \\frac{-(\\lambda_0 + \\gamma) \\pm \\sqrt{(\\lambda_0 + \\gamma)^2 + 4\\alpha F}}{2\\alpha}$$\nFor a physically meaningful solution to exist, the discriminant $\\Delta = (\\lambda_0 + \\gamma)^2 + 4\\alpha F$ must be non-negative. All test cases provided satisfy this, as $F > 0$ and $\\alpha \\ge 0$. We must select the physically relevant root, which for a positive forcing ($F > 0$) should yield a positive warming ($T_{\\text{eq}} > 0$).\n\nTo ensure numerical stability, particularly avoiding subtractive cancellation when $4\\alpha F$ is small, we utilize an alternative form of the quadratic formula for the desired root. The root that correctly converges to the linear solution as $\\alpha \\to 0$ is:\n$$T_{\\text{eq}} = \\frac{2c}{-b \\mp \\sqrt{b^2-4ac}}$$\nBy selecting the sign in the denominator to avoid cancellation (i.e., by adding two terms of the same sign), we arrive at the robust formula. Let $\\Lambda = \\lambda_0 + \\gamma$. Assuming $\\Lambda > 0$ (a stable climate), the numerically stable, physically correct solution is:\n$$T_{\\text{eq}} = \\frac{-2F}{-(\\Lambda) - \\sqrt{\\Lambda^2 + 4\\alpha F}} = \\frac{2F}{\\Lambda + \\sqrt{\\Lambda^2 + 4\\alpha F}}$$\nThis formula is well-behaved as $\\alpha \\to 0$, since $\\sqrt{\\Lambda^2 + 4\\alpha F} \\to \\Lambda$, yielding $T_{\\text{eq}} \\to \\frac{2F}{\\Lambda + \\Lambda} = \\frac{F}{\\Lambda}$, which is precisely the linear solution.\n\nThe algorithm proceeds by first calculating $\\gamma$ for each test case, then solving for $T_{\\text{eq}}$ using the appropriate linear or quadratic formula as determined by the value of $\\alpha$. The final result is rounded to two decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium warming for a series of climate model parameter sets.\n    The model includes state-dependent feedbacks and spatial pattern effects.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (F, lambda0, alpha, k, w, r)\n    test_cases = [\n        # Case 1\n        (3.7, 1.2, 0.05, [-0.2, 0.1, 0.05, 0.0], [0.4, 0.2, 0.25, 0.15], [0.9, 1.3, 1.6, 1.0]),\n        # Case 2\n        (3.7, 1.05, 0.0, [0.0, 0.0, 0.0], [0.5, 0.3, 0.2], [1.0, 1.0, 1.0]),\n        # Case 3\n        (3.7, 1.5, 0.08, [-0.3, -0.1, -0.05], [0.5, 0.3, 0.2], [1.4, 0.8, 1.2]),\n        # Case 4\n        (3.7, 0.9, 0.02, [0.15, -0.25, 0.05, -0.1], [0.3, 0.3, 0.2, 0.2], [1.1, 1.3, 0.7, 1.8]),\n    ]\n\n    results = []\n    for case in test_cases:\n        F, lambda0, alpha, k, w, r = case\n        \n        # Convert lists to numpy arrays for vectorized operations\n        k_arr = np.array(k)\n        w_arr = np.array(w)\n        r_arr = np.array(r)\n\n        # Step 1: Compute the aggregated pattern effect contribution gamma.\n        gamma = np.sum(k_arr * w_arr * r_arr)\n        \n        # Define the total linear part of the feedback\n        Lambda = lambda0 + gamma\n        \n        # Step 2: Solve the equilibrium condition for T_eq.\n        # This is a quadratic equation: alpha*T^2 + Lambda*T - F = 0\n        T_eq = 0.0\n\n        # Handle the special case of negligible state dependence (alpha is zero).\n        # In this case, the equation is linear: Lambda*T = F.\n        # A small tolerance is used for floating point comparison, although direct\n        # comparison works for the given test cases.\n        if np.isclose(alpha, 0.0):\n            # The denominator Lambda = lambda0 + gamma should be positive for a stable climate.\n            if Lambda > 0:\n                T_eq = F / Lambda\n        else:\n            # For the quadratic case, use the numerically stable formula for the\n            # physically relevant (positive) root.\n            # T_eq = (2*F) / (Lambda + sqrt(Lambda^2 + 4*alpha*F))\n            discriminant = Lambda**2 + 4 * alpha * F\n            \n            # For the given problem constraints (F>0, alpha>=0, stable base climate),\n            # the discriminant will be non-negative.\n            if discriminant >= 0:\n                T_eq = (2 * F) / (Lambda + np.sqrt(discriminant))\n\n        # Round the result to 2 decimal places and add to the list.\n        results.append(round(T_eq, 2))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}