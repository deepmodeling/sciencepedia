{
    "hands_on_practices": [
        {
            "introduction": "表面反照率反馈是气候系统中的一个关键正反馈机制，尤其是在冰冻圈的响应中。本练习将引导你从行星能量平衡的第一性原理出发，通过构建物理参数化方案，一步步推导并量化全球变暖导致的冰雪覆盖变化所产生的反馈强度。这有助于你掌握将物理概念转化为定量模型的基础技能。",
            "id": "4022287",
            "problem": "考虑一个气候系统的纬向平均能量平衡观点，重点关注涉及冰冻圈的大气层顶（TOA）短波辐射过程。目标是量化全球变暖下与冰雪覆盖变化相关的地表反照率反馈。从应用于行星辐射收支的能量守恒和行星反照率的定义出发，并将所有量视为年平均值。使用以下模型假设和定义作为您推导和算法制定的基础：\n\n1. 一个区域内地球系统吸收的TOA净短波通量为 $R_{\\mathrm{SW}} = S \\left(1 - \\alpha_{\\mathrm{p}}\\right)$，其中 $S$ 是TOA处的入射短波辐射，$\\alpha_{\\mathrm{p}}$ 是行星反照率。\n\n2. 将行星反照率划分为一个与地表属性无关的、由云和大气引起的分量，以及一个到达TOA的、由地表反射引起的分量。只有地表反射分量通过冰冻圈的变化而依赖于温度。对于地表反射分量，使用单一的有效晴空短波透射率 $t \\in [0,1]$ 和云量 $c \\in [0,1]$ 来模拟大气路径，云量以 $(1-c)$ 的比例遮蔽地表反射。忽略多次散射以及 $t$ 和 $c$ 中的任何温度依赖性。\n\n3. 将地表反照率表示为冰/雪和背景（无季节性积雪的海洋/陆地）贡献的混合。设地表反照率为 $a_{\\mathrm{s}} = a_{\\mathrm{w}} + f \\left(a_{\\mathrm{i}} - a_{\\mathrm{w}}\\right)$，其中 $a_{\\mathrm{i}} \\in [0,1]$ 是冰/雪反照率，$a_{\\mathrm{w}} \\in [0,1]$ 是背景反照率，$f \\in [0,1]$ 是该区域的冰冻圈覆盖分数。\n\n4. 将冰冻圈覆盖分数 $f$ 建模为近地表气温 $T$ 相对于融化阈值 $T_0$ 的逻辑斯谛函数：$f(T) = \\dfrac{1}{1 + \\exp\\left(\\beta \\left(T - T_0\\right)\\right)}$，其中 $\\beta > 0$ 是一个控制转变陡峭程度的斜率参数。这种函数形式捕捉了冰/雪随增温平滑退缩的特征，并被广泛用于简化气候模型中。\n\n5. 在常规的气候反馈框架中，将地表反照率反馈参数 $\\lambda_{\\alpha}$ 定义为净TOA通量对温度敏感度的负值：$\\lambda_{\\alpha} = -\\dfrac{\\partial R}{\\partial T}$，并且在本问题中，仅关注由 $a_{\\mathrm{s}}$ 的温度依赖性引起的短波贡献。\n\n您的任务是：\n- 基于上述基础，推导出一个关于 $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$ 的纬向贡献表达式，该表达式是 $S$, $t$, $c$, $a_{\\mathrm{i}}$, $a_{\\mathrm{w}}$, $T$, $T_0$ 和 $\\beta$ 的函数。\n- 通过总和为 $1$ 的面积权重 $w$ 聚合一组区域，以获得以 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ 表示的 $\\lambda_{\\alpha}$ 的多区域值。\n- 实现一个程序，为下面的每个测试用例计算 $\\lambda_{\\alpha}$，并按规定格式生成结果。\n\n本问题不涉及角度。所有输出必须以 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ 为单位，表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n每个测试用例包含长度为 $N$ 的等长数组，用于区域参数 $S$、$t$、$c$、$T$、$T_0$、$\\beta$、$a_{\\mathrm{i}}$、$a_{\\mathrm{w}}$，以及面积权重 $w$ 使得 $\\sum_{j=1}^{N} w_j = 1$。通过纬向贡献的面积加权和，为每个测试用例计算一个单一的聚合 $\\lambda_{\\alpha}$ 值。\n\n- 测试用例1（三区域，冰冻圈存在于高纬度地区，在热带可忽略不计）：\n  - $S = [260, 340, 420]$ 单位为 $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.70, 0.78, 0.80]$\n  - $c = [0.55, 0.50, 0.60]$\n  - $T = [271, 285, 299]$ 单位为 $\\mathrm{K}$\n  - $T_0 = [273, 275, 273]$ 单位为 $\\mathrm{K}$\n  - $\\beta = [0.25, 0.08, 0.50]$ 单位为 $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.65, 0.50, 0.40]$\n  - $a_{\\mathrm{w}} = [0.15, 0.20, 0.06]$\n  - $w = [0.06, 0.34, 0.60]$\n\n- 测试用例2（与测试用例1相同，但没有反照率对比，即没有冰冻圈光学效应）：\n  - $S = [260, 340, 420]$ 单位为 $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.70, 0.78, 0.80]$\n  - $c = [0.55, 0.50, 0.60]$\n  - $T = [271, 285, 299]$ 单位为 $\\mathrm{K}$\n  - $T_0 = [273, 275, 273]$ 单位为 $\\mathrm{K}$\n  - $\\beta = [0.25, 0.08, 0.50]$ 单位为 $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.15, 0.20, 0.06]$\n  - $a_{\\mathrm{w}} = [0.15, 0.20, 0.06]$\n  - $w = [0.06, 0.34, 0.60]$\n\n- 测试用例3（双区域，云量非常大的极地地区抑制了核函数，而接近阈值的晴朗中纬度地区占主导）：\n  - $S = [240, 320]$ 单位为 $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.65, 0.85]$\n  - $c = [0.90, 0.20]$\n  - $T = [268, 278]$ 单位为 $\\mathrm{K}$\n  - $T_0 = [273, 275]$ 单位为 $\\mathrm{K}$\n  - $\\beta = [0.40, 0.20]$ 单位为 $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.70, 0.55]$\n  - $a_{\\mathrm{w}} = [0.20, 0.18]$\n  - $w = [0.08, 0.92]$\n\n- 测试用例4（单区域边界，透射率为零，核函数为空）：\n  - $S = [340]$ 单位为 $\\mathrm{W \\, m^{-2}}$\n  - $t = [0.00]$\n  - $c = [0.50]$\n  - $T = [270]$ 单位为 $\\mathrm{K}$\n  - $T_0 = [273]$ 单位为 $\\mathrm{K}$\n  - $\\beta = [0.30]$ 单位为 $\\mathrm{K^{-1}}$\n  - $a_{\\mathrm{i}} = [0.70]$\n  - $a_{\\mathrm{w}} = [0.10]$\n  - $w = [1.00]$\n\n程序输出规范：\n您的程序应生成单行输出，其中包含四个测试用例的聚合结果，格式为方括号内以逗号分隔的列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是计算出的 $\\lambda_{\\alpha}$ 值（单位为 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$），并遵循标准舍入规则四舍五入到六位小数。",
            "solution": "用户提供的问题经评估有效，因为它在科学上基于气候能量平衡的原理，在数学上是适定的，并使用了客观、正式的语言。它提出了一个气候反馈分析中的标准问题（尽管经过简化），可以通过直接推导和计算来解决。\n\n目标是推导地表反照率反馈参数 $\\lambda_{\\alpha}$ 的表达式，并为几个测试用例计算其值。反馈参数定义为 $\\lambda_{\\alpha} = -\\dfrac{\\partial R}{\\partial T}$，我们关注的是短波辐射分量 $R_{\\mathrm{SW}}$ 及其通过地表反照率变化对温度 $T$ 的依赖性。\n\n推导过程如下。\n\n1.  **构建行星反照率 $\\alpha_{\\mathrm{p}}$**：\n    问题要求将行星反照率 $\\alpha_{\\mathrm{p}}$ 分为两部分：一个与地表无关的分量，和一个由地表反射到达大气层顶（TOA）的分量。我们来对通量进行建模。反射到太空的总短波辐射是 $S \\alpha_{\\mathrm{p}}$。这是由大气和云层反射的辐射，以及从地表反射并成功穿回太空的辐射之和。\n    设 $\\alpha_{\\mathrm{atm+cld}}$ 是来自大气和云层的、与地表属性无关的反照率分量。\n    地表反射分量受到大气的调制。太阳辐射必须首先向下穿过大气，发生反射，然后再向上穿过大气。问题提供了一个有效的晴空透射率 $t$ 和一个云量 $c$。地表反射被云层遮挡，因此只与区域的晴空部分相关，其面积分数为 $(1-c)$。\n    在这部分晴空区域，辐射向下透射，以反照率 $a_{\\mathrm{s}}$ 从地表反射，然后向上传输。通量的双向透射率为 $t^2$。\n    因此，由地表反射贡献的行星反照率部分为 $(1-c) t^2 a_{\\mathrm{s}}$。\n    总行星反照率是大气/云贡献和地表贡献之和：\n    $$ \\alpha_{\\mathrm{p}} = \\alpha_{\\mathrm{atm+cld}} + (1-c) t^2 a_{\\mathrm{s}} $$\n    在此，假设 $\\alpha_{\\mathrm{atm+cld}}$、$c$ 和 $t$ 与近地表气温 $T$ 无关。温度依赖性通过地表反照率 $a_{\\mathrm{s}}$ 引入。\n\n2.  **构建净短波通量 $R_{\\mathrm{SW}}$**：\n    根据定义1，系统吸收的净短波通量为：\n    $$ R_{\\mathrm{SW}} = S (1 - \\alpha_{\\mathrm{p}}) $$\n    代入我们的 $\\alpha_{\\mathrm{p}}$ 表达式：\n    $$ R_{\\mathrm{SW}} = S \\left(1 - \\left[\\alpha_{\\mathrm{atm+cld}} + (1-c) t^2 a_{\\mathrm{s}}\\right]\\right) = S(1 - \\alpha_{\\mathrm{atm+cld}}) - S(1-c)t^2 a_{\\mathrm{s}} $$\n\n3.  **对 $R_{\\mathrm{SW}}$ 求关于温度 $T$ 的导数**：\n    我们需要求 $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$。除 $a_{\\mathrm{s}}$ 外，所有参数相对于 $T$ 都被视作常数。\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ S(1 - \\alpha_{\\mathrm{atm+cld}}) - S(1-c)t^2 a_{\\mathrm{s}}(T) \\right] $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = -S(1-c)t^2 \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} $$\n\n4.  **对地表反照率 $a_{\\mathrm{s}}$ 求关于温度 $T$ 的导数**：\n    根据定义3，地表反照率 $a_{\\mathrm{s}}$ 是基于冰冻圈分数 $f$ 的线性混合：\n    $$ a_{\\mathrm{s}} = a_{\\mathrm{w}} + f(T) (a_{\\mathrm{i}} - a_{\\mathrm{w}}) $$\n    参数 $a_{\\mathrm{w}}$ 和 $a_{\\mathrm{i}}$（背景和冰反照率）是常数。对 $T$ 求导得出：\n    $$ \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} = (a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\frac{\\partial f}{\\partial T} $$\n\n5.  **对冰冻圈分数 $f$ 求关于温度 $T$ 的导数**：\n    根据定义4，冰冻圈分数 $f$ 被建模为 $T$ 的逻辑斯谛函数：\n    $$ f(T) = \\frac{1}{1 + \\exp\\left(\\beta (T - T_0)\\right)} $$\n    为求导数 $\\dfrac{\\partial f}{\\partial T}$，我们使用链式法则。令 $u = \\beta(T-T_0)$，则 $f(u) = (1+e^u)^{-1}$。\n    $$ \\frac{\\partial f}{\\partial T} = \\frac{df}{du} \\frac{du}{dT} $$\n    导数是：\n    $$ \\frac{du}{dT} = \\beta $$\n    $$ \\frac{df}{du} = -(1+e^u)^{-2} e^u = -\\frac{1}{1+e^u} \\cdot \\frac{e^u}{1+e^u} $$\n    我们可以用 $f$ 来表示这个结果。我们知道 $f = \\dfrac{1}{1+e^u}$。\n    并且，$1-f = 1 - \\dfrac{1}{1+e^u} = \\dfrac{1+e^u-1}{1+e^u} = \\dfrac{e^u}{1+e^u}$。\n    将这些代回到 $\\dfrac{df}{du}$ 的表达式中：\n    $$ \\frac{df}{du} = -f(1-f) $$\n    因此，关于温度的导数是：\n    $$ \\frac{\\partial f}{\\partial T} = -\\beta f(1-f) $$\n\n6.  **组合 $\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$ 的表达式**：\n    我们将步骤4和5的结果代回到步骤3的表达式中。\n    $$ \\frac{\\partial a_{\\mathrm{s}}}{\\partial T} = -(a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\beta f(1-f) $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = -S(1-c)t^2 \\left[ -(a_{\\mathrm{i}} - a_{\\mathrm{w}}) \\beta f(1-f) \\right] $$\n    $$ \\frac{\\partial R_{\\mathrm{SW}}}{\\partial T} = S t^2 (1-c) \\beta (a_{\\mathrm{i}} - a_{\\mathrm{w}}) f(1-f) $$\n    该表达式表示单个区域内地表温度单位变化所引起的净TOA短波辐射变化。正值表示随着温度升高，吸收的短波辐射增多，这是正反馈的特征。\n\n7.  **计算聚合反馈参数 $\\lambda_{\\alpha}$**：\n    反馈参数定义为 $\\lambda_{\\alpha} = -\\dfrac{\\partial R_{\\mathrm{SW}}}{\\partial T}$。对于单个区域 $j$，这得到：\n    $$ \\lambda_{\\alpha,j} = -S_j t_j^2 (1-c_j) \\beta_j (a_{\\mathrm{i},j} - a_{\\mathrm{w},j}) f_j(1-f_j) $$\n    其中 $f_j = \\left(1 + \\exp\\left(\\beta_j (T_j - T_{0,j})\\right)\\right)^{-1}$。\n    全球或多区域聚合的反馈参数是各区域贡献的面积加权和：\n    $$ \\lambda_{\\alpha} = \\sum_{j=1}^{N} w_j \\lambda_{\\alpha,j} $$\n    代入 $\\lambda_{\\alpha,j}$ 的表达式：\n    $$ \\lambda_{\\alpha} = - \\sum_{j=1}^{N} w_j S_j t_j^2 (1-c_j) \\beta_j (a_{\\mathrm{i},j} - a_{\\mathrm{w},j}) f_j(1-f_j) $$\n    这是需要实现的最终表达式。单位由 $S$（$\\mathrm{W \\, m^{-2}}$）和 $\\beta$（$\\mathrm{K^{-1}}$）的单位决定，结果为 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$，符合要求。此公式将用于计算给定测试用例的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the aggregate surface albedo feedback parameter for multiple test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (\n            np.array([260., 340., 420.]),       # S\n            np.array([0.70, 0.78, 0.80]),       # t\n            np.array([0.55, 0.50, 0.60]),       # c\n            np.array([271., 285., 299.]),       # T\n            np.array([273., 275., 273.]),       # T0\n            np.array([0.25, 0.08, 0.50]),       # beta\n            np.array([0.65, 0.50, 0.40]),       # a_i\n            np.array([0.15, 0.20, 0.06]),       # a_w\n            np.array([0.06, 0.34, 0.60]),       # w\n        ),\n        # Test Case 2\n        (\n            np.array([260., 340., 420.]),       # S\n            np.array([0.70, 0.78, 0.80]),       # t\n            np.array([0.55, 0.50, 0.60]),       # c\n            np.array([271., 285., 299.]),       # T\n            np.array([273., 275., 273.]),       # T0\n            np.array([0.25, 0.08, 0.50]),       # beta\n            np.array([0.15, 0.20, 0.06]),       # a_i (same as a_w)\n            np.array([0.15, 0.20, 0.06]),       # a_w\n            np.array([0.06, 0.34, 0.60]),       # w\n        ),\n        # Test Case 3\n        (\n            np.array([240., 320.]),             # S\n            np.array([0.65, 0.85]),             # t\n            np.array([0.90, 0.20]),             # c\n            np.array([268., 278.]),             # T\n            np.array([273., 275.]),             # T0\n            np.array([0.40, 0.20]),             # beta\n            np.array([0.70, 0.55]),             # a_i\n            np.array([0.20, 0.18]),             # a_w\n            np.array([0.08, 0.92]),             # w\n        ),\n        # Test Case 4\n        (\n            np.array([340.]),                   # S\n            np.array([0.00]),                   # t\n            np.array([0.50]),                   # c\n            np.array([270.]),                   # T\n            np.array([273.]),                   # T0\n            np.array([0.30]),                   # beta\n            np.array([0.70]),                   # a_i\n            np.array([0.10]),                   # a_w\n            np.array([1.00]),                   # w\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        S, t, c, T, T0, beta, a_i, a_w, w = case\n\n        # Calculate fractional cryosphere coverage f for each zone\n        # f = 1 / (1 + exp(beta * (T - T0)))\n        f = 1.0 / (1.0 + np.exp(beta * (T - T0)))\n\n        # The derivative df/dT can be expressed as -beta * f * (1-f)\n        # The full expression for the zonal feedback is:\n        # lambda_alpha_j = -S_j * t_j^2 * (1-c_j) * beta_j * (a_i_j - a_w_j) * f_j * (1-f_j)\n        \n        # Calculate the zonal feedback values using vectorized operations\n        lambda_alpha_zonal = -S * t**2 * (1 - c) * beta * (a_i - a_w) * f * (1 - f)\n\n        # Calculate the aggregate feedback by taking the area-weighted sum\n        lambda_alpha_total = np.sum(w * lambda_alpha_zonal)\n\n        results.append(f\"{lambda_alpha_total:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "水汽反馈和直减率反馈是气候系统中两个最强的反馈，且二者紧密耦合。本练习将向你介绍辐射核（radiative kernel）方法，这是一种用于在复杂模型中分解和诊断不同反馈效应的强大工具。通过将辐射核应用于给定的温湿变化廓线，你将学习如何量化水汽和直減率这两个相互交织的反馈过程对大气层顶（TOA）辐射收支的净影响。",
            "id": "4022293",
            "problem": "考虑一个用于数值天气预报和气候模拟的垂直离散大气柱。目标是使用线性化辐射核框架，在大气层顶（TOA）量化水汽和递减率反馈之间的耦合。从一个有物理基础的基准出发，使用以下原则：\n\n- 由于大气状态的微小变化，大气层顶的净辐射扰动 $dR$ 可以线性化为温度和水汽贡献的总和：\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i),\n$$\n其中，$K_T(i)$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$K_q(i)$ 的单位是 $\\mathrm{W\\,m^{-2}\\,(kg/kg)^{-1}}$，$dT(i)$ 是在层级 $i$ 的温度变化，单位是 $\\mathrm{K}$，而 $dq(i)$ 是在层级 $i$ 的比湿变化，单位是 $\\mathrm{kg/kg}$。整数 $N$ 是垂直层级的数量。\n\n- 在相对湿度固定的情况下，克劳修斯-克拉佩龙关系（Clausius–Clapeyron relation）通过以下方式将饱和比湿 $q_s$ 的分数变化与温度联系起来：\n$$\n\\frac{d \\ln q_s}{dT} \\approx \\frac{L_v}{R_v \\, T^2},\n$$\n其中，$L_v$ 是蒸发潜热，单位是 $\\mathrm{J\\,kg^{-1}}$，$R_v$ 是水汽的气体常数，单位是 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$T$ 是绝对温度，单位是 $\\mathrm{K}$。在相对湿度保持固定的情况下，层级 $i$ 的一个微小温度变化 $dT(i)$ 会产生：\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i),\n$$\n其中 $q(i)$ 是层级 $i$ 的背景比湿。\n\n- 一个由递减率介导的耦合由一个依赖于层级的因子 $\\gamma(i)$ 表示，使得层级 $i$ 的温度变化与地表温度变化 $dT_s$ 通过以下方式联系起来：\n$$\ndT(i) = \\gamma(i) \\, dT_s,\n$$\n其中 $\\gamma(i)$ 是无量纲的，$dT_s$ 的单位是 $\\mathrm{K}$。\n\n- 有效气候反馈参数定义为：\n$$\n\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s},\n$$\n单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。在所采用的符号约定下，正的 $\\lambda_{\\mathrm{eff}}$ 表示一个稳定响应，而负的 $\\lambda_{\\mathrm{eff}}$ 表示一个不稳定响应。\n\n您的任务是实现一个程序，使用规定的常数和垂直廓线，为一组科学上合理的测试案例计算 $\\lambda_{\\mathrm{eff}}$。假设 $dT_s = 1.0 \\, \\mathrm{K}$，因此在数值上 $\\lambda_{\\mathrm{eff}} = dR$。使用 $L_v = 2{,}500{,}000 \\, \\mathrm{J\\,kg^{-1}}$ 和 $R_v = 461 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$。所有温度值的单位是 $\\mathrm{K}$，比湿值的单位是 $\\mathrm{kg/kg}$。\n\n实现以下测试套件（每个案例提供长度为 $N=6$ 个层级的数组，从近地表到对流层上层排序）：\n\n- 案例A（热带地区，具有强高层增温耦合）：\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [540.0, 450.0, 420.0, 360.0, 300.0, 240.0]$\n    - $\\gamma = [1.00, 1.20, 1.30, 1.50, 1.60, 1.70]$\n\n- 案例B（极地地区，更冷、更干燥，具有均匀增温廓线）：\n    - $T = [270.0, 264.0, 255.0, 240.0, 220.0, 205.0]$\n    - $q = [0.0040, 0.0030, 0.0020, 0.0010, 0.0005, 0.0002]$\n    - $K_T = [-0.30, -0.25, -0.25, -0.30, -0.40, -0.50]$\n    - $K_q = [300.0, 240.0, 210.0, 180.0, 150.0, 120.0]$\n    - $\\gamma = [1.00, 1.00, 1.00, 1.00, 1.00, 1.00]$\n\n- 案例C（干大气极限，与案例A相同，但水汽核为零）：\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$\n    - $\\gamma = [1.00, 1.20, 1.30, 1.50, 1.60, 1.70]$\n\n- 案例D（弱递减率耦合，均匀增温，具有热带湿度和核）：\n    - $T = [300.0, 294.0, 285.0, 270.0, 250.0, 220.0]$\n    - $q = [0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]$\n    - $K_T = [-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]$\n    - $K_q = [540.0, 450.0, 420.0, 360.0, 300.0, 240.0]$\n    - $\\gamma = [1.00, 1.00, 1.00, 1.00, 1.00, 1.00]$\n\n算法要求：\n\n- 对于每个案例，计算 $dT(i) = \\gamma(i) \\, dT_s$，其中 $dT_s = 1.0$。\n- 计算 $dq(i) = q(i) \\, \\dfrac{L_v}{R_v \\, T(i)^2} \\, dT(i)$。\n- 计算 $dR = \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i)$。\n- 返回 $\\lambda_{\\mathrm{eff}} = dR$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n所需输出：\n\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[result_1,result_2,result_3,result_4]$）。\n- 将每个 $\\lambda_{\\mathrm{eff}}$ 值表示为浮点数，四舍五入到小数点后四位，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n设计考虑与覆盖范围：\n\n- 测试套件涵盖了一个具有强高层耦合的典型热带案例（案例A）、一个更冷更干燥且具有均匀增温的极地案例（案例B）、一个没有水汽核的边缘情况干极限案例（案例C），以及一个 $\\gamma(i)$ 均匀的弱递减率耦合案例（案例D）。\n- 所有输入在科学上都是合理的且自洽的，并且该程序在线性化核方法进行气候反馈分析的框架内是普适的。",
            "solution": "问题陈述在科学上是合理的、定义明确的，并提供了计算唯一解所需的所有信息。这是一个使用已建立的辐射核方法进行气候反馈分析的标准练习。所提供的测试案例是不同大气条件的物理上合理的表示。未发现使其无效的缺陷。\n\n目标是计算有效气候反馈参数 $\\lambda_{\\mathrm{eff}}$，该参数量化了大气层顶（TOA）对地表温度扰动的净辐射响应。该计算基于一个线性化模型，该模型将总辐射扰动 $dR$ 分解为整个离散大气柱中温度变化和比湿变化的贡献。\n\n提供的基本方程是：\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\, dT(i) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\, dq(i)\n$$\n在这里，$N$ 是垂直层级的数量，$K_T(i)$ 和 $K_q(i)$ 是层级 $i$ 的温度和水汽辐射核，$dT(i)$ 和 $dq(i)$ 分别是该层级的温度和比湿变化。\n\n变化量 $dT(i)$ 和 $dq(i)$ 不是独立的。它们与地表温度变化 $dT_s$ 耦合。层级 $i$ 的温度变化通过一个递减率耦合因子 $\\gamma(i)$ 与 $dT_s$ 相关联：\n$$\ndT(i) = \\gamma(i) \\, dT_s\n$$\n比湿的变化 $dq(i)$ 由克劳修斯-克拉佩龙关系（Clausius–Clapeyron relation）决定，前提是假设相对湿度保持不变。这个假设将湿度变化与局部温度变化 $dT(i)$ 联系起来：\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i)\n$$\n其中 $T(i)$ 和 $q(i)$ 是层级 $i$ 的背景温度和比湿，$L_v$ 是蒸发潜热（$2,500,000 \\, \\mathrm{J\\,kg^{-1}}$），$R_v$ 是水汽的气体常数（$461 \\, \\mathrm{J\\,kg^{-1}\\,K^{-1}}$）。\n\n通过将 $dT(i)$ 的表达式代入 $dq(i)$ 的方程，我们可以直接用表面温度变化来表示湿度变化：\n$$\ndq(i) \\approx q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\left(\\gamma(i) \\, dT_s\\right)\n$$\n\n现在，我们将 $dT(i)$ 和 $dq(i)$ 的表达式都代回到 $dR$ 的主方程中：\n$$\ndR \\approx \\sum_{i=1}^{N} K_T(i) \\left(\\gamma(i) \\, dT_s\\right) \\;+\\; \\sum_{i=1}^{N} K_q(i) \\left(q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\gamma(i) \\, dT_s\\right)\n$$\n有效气候反馈参数定义为 $\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s}$。将 $dR$ 的表达式除以 $dT_s$ 得到 $\\lambda_{\\mathrm{eff}}$ 的最终公式：\n$$\n\\lambda_{\\mathrm{eff}} = \\frac{dR}{dT_s} \\approx \\sum_{i=1}^{N} \\left[ K_T(i) \\, \\gamma(i) \\;+\\; K_q(i) \\, q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, \\gamma(i) \\right]\n$$\n为了计算上的清晰，可以将其重新排列为：\n$$\n\\lambda_{\\mathrm{eff}} \\approx \\sum_{i=1}^{N} \\gamma(i) \\left[ K_T(i) \\;+\\; K_q(i) \\, q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\right]\n$$\n问题指定使用 $dT_s = 1.0 \\, \\mathrm{K}$，这简化了计算，使得 $\\lambda_{\\mathrm{eff}}$ 在数值上等于 $dR$。算法过程是此计算的直接实现。\n\n对于每个测试案例和从 $1$ 到 $N=6$ 的每个层级 $i$：\n1.  计算温度变化：$dT(i) = \\gamma(i) \\cdot (1.0 \\, \\mathrm{K})$。\n2.  计算比湿变化：$dq(i) = q(i) \\, \\frac{L_v}{R_v \\, T(i)^2} \\, dT(i)$。\n3.  通过对所有层级的贡献求和来计算总辐射扰动：$dR = \\sum_{i=1}^{N} \\left[ K_T(i) \\, dT(i) + K_q(i) \\, dq(i) \\right]$。\n4.  结果是 $\\lambda_{\\mathrm{eff}} = dR$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n此过程将应用于四个提供的测试案例，为提高效率使用基于数组的计算。结果将按要求四舍五入到小数点后四位。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective climate feedback parameter lambda_eff for a set of\n    test cases using a linearized radiative kernel framework.\n    \"\"\"\n    \n    # Define physical constants\n    L_v = 2_500_000.0  # Latent heat of vaporization in J/kg\n    R_v = 461.0        # Gas constant for water vapor in J/(kg*K)\n    dT_s = 1.0         # Surface temperature change in K\n\n    # Define the test suite\n    test_cases = {\n        'A': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([540.0, 450.0, 420.0, 360.0, 300.0, 240.0]),\n            'gamma': np.array([1.00, 1.20, 1.30, 1.50, 1.60, 1.70])\n        },\n        'B': {\n            'T': np.array([270.0, 264.0, 255.0, 240.0, 220.0, 205.0]),\n            'q': np.array([0.0040, 0.0030, 0.0020, 0.0010, 0.0005, 0.0002]),\n            'K_T': np.array([-0.30, -0.25, -0.25, -0.30, -0.40, -0.50]),\n            'K_q': np.array([300.0, 240.0, 210.0, 180.0, 150.0, 120.0]),\n            'gamma': np.array([1.00, 1.00, 1.00, 1.00, 1.00, 1.00])\n        },\n        'C': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),\n            'gamma': np.array([1.00, 1.20, 1.30, 1.50, 1.60, 1.70])\n        },\n        'D': {\n            'T': np.array([300.0, 294.0, 285.0, 270.0, 250.0, 220.0]),\n            'q': np.array([0.0180, 0.0120, 0.0070, 0.0030, 0.0010, 0.0003]),\n            'K_T': np.array([-0.35, -0.25, -0.30, -0.40, -0.50, -0.60]),\n            'K_q': np.array([540.0, 450.0, 420.0, 360.0, 300.0, 240.0]),\n            'gamma': np.array([1.00, 1.00, 1.00, 1.00, 1.00, 1.00])\n        }\n    }\n    \n    results = []\n    # Process test cases in specified order: A, B, C, D\n    for case_id in sorted(test_cases.keys()):\n        case_data = test_cases[case_id]\n        \n        # Extract data for the current case\n        T = case_data['T']\n        q = case_data['q']\n        K_T = case_data['K_T']\n        K_q = case_data['K_q']\n        gamma = case_data['gamma']\n        \n        # Step 1: Compute the temperature change at each level i\n        # dT(i) = gamma(i) * dT_s\n        dT = gamma * dT_s\n        \n        # Step 2: Compute the specific humidity change at each level i\n        # dq(i) = q(i) * (L_v / (R_v * T(i)^2)) * dT(i)\n        clausius_clapeyron_factor = L_v / (R_v * T**2)\n        dq = q * clausius_clapeyron_factor * dT\n        \n        # Step 3: Compute the total radiative perturbation dR\n        # dR = sum( K_T(i)*dT(i) ) + sum( K_q(i)*dq(i) )\n        dR_T = np.sum(K_T * dT)\n        dR_q = np.sum(K_q * dq)\n        dR = dR_T + dR_q\n        \n        # Step 4: The effective feedback parameter lambda_eff is dR since dT_s = 1.0\n        lambda_eff = dR\n        \n        results.append(lambda_eff)\n        \n    # Format the final output as a comma-separated list of floats\n    # rounded to four decimal places, enclosed in square brackets.\n    print(f\"[{','.join([f'{r:.4f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将气候反馈参数视为一个常数是一种理想化的简化。实际上，反馈的强度可能依赖于气候的背景状态（状态依赖性），以及地表增温的空间分布模式（模态效应）。本项高级练习旨在探索这些前沿概念，你将构建一个包含状态依赖性和模态效应的能量平衡模型，并求解其非线性的平衡气候响应，从而揭示线性反馈分析框架的局限性。",
            "id": "4022299",
            "problem": "您的任务是实现并分析一种简化方法，用于在全球能量平衡模型中量化型态效应和状态依赖反馈。该模型与数值天气预报和气候模拟相关。目标是计算在特定的辐射强迫下，当型态效应和状态依赖反馈共同调节有效气候反馈强度时的平衡增温。\n\n从大气层顶（TOA）的能量平衡开始，该平衡指出，在任何时刻，TOA处的净向下辐射通量（记为 $N$）是外部施加的辐射强迫 $F$ 与大气辐射响应 $R$ 之间的差值。根据定义，在平衡状态下，$N$ 为零。辐射响应被假定源于两个部分的贡献：\n\n- 一个全球总合气候反馈，它通过一个状态依赖反馈参数 $\\lambda(T)$ 依赖于全球平均地表温度异常 $T$。\n- 一个空间型态效应项，由应用于区域温度型态的区域核函数构建而成。\n\n使用的建模假设如下：\n\n- 辐射响应 $R$ 表示为 $R = \\lambda(T) \\, T + P(T, \\text{pattern})$，其中 $\\lambda(T) = \\lambda_0 + \\alpha \\, T$。$\\lambda_0$ 是基线反馈参数，$\\alpha$ 捕捉其状态依赖性（$\\alpha$ 可为正或负）。$\\lambda_0$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\alpha$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-2}}$。\n- 型态效应 $P(T, \\text{pattern})$ 由离散区域总和 $P = \\sum_{i=1}^{n} k_i \\, w_i \\, T_i$ 表示，其中 $k_i$ 是特定区域的核函数（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$），$w_i$ 是满足 $\\sum_i w_i = 1$ 的非负面积权重，$T_i$ 是区域温度异常。区域异常被参数化为 $T_i = r_i \\, T$，其中 $r_i$ 是相对于全球平均值的无量纲区域放大比。\n\n在这些假设下，平衡状态下的TOA能量平衡为 $0 = F - \\left[\\lambda(T) \\, T + \\sum_{i=1}^{n} k_i \\, w_i \\, r_i \\, T \\right]$。您的任务是，对于给定的参数集 $\\left(F, \\lambda_0, \\alpha, \\{k_i\\}_{i=1}^n, \\{w_i\\}_{i=1}^n, \\{r_i\\}_{i=1}^n\\right)$，计算满足平衡条件的全球平均温度异常 $T_{\\text{eq}}$。将 $T_{\\text{eq}}$ 以 $\\mathrm{K}$ 为单位表示，并四舍五入到 $2$ 位小数。\n\n设计并实现一个鲁棒的算法，该算法能够：\n- 计算总合型态效应贡献 $\\gamma = \\sum_{i=1}^{n} k_i \\, w_i \\, r_i$（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）。\n- 在不预先假设线性反馈的情况下，求解 $T_{\\text{eq}}$ 的平衡条件。通过正确处理 $\\alpha \\approx 0$ 的特殊情况（即可忽略的状态依赖性），确保数值稳定性，避免除以零。\n- 为 $T_{\\text{eq}}$ 选择物理上相关的非负解。\n\n使用以下参数集测试套件，这些测试套件涵盖了不同的情景。所有核函数、权重和比率都以列表形式提供，其长度 $n$ 与各案例相适应。每个案例都是一个包含 $\\left(F, \\lambda_0, \\alpha, k, w, r\\right)$ 的元组，并按所示单位指定：\n\n- 案例 1（一般“正常路径”）：$F = 3.7~\\mathrm{W\\,m^{-2}}$，$\\lambda_0 = 1.2~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\alpha = 0.05~\\mathrm{W\\,m^{-2}\\,K^{-2}}$，$k = [-0.2, 0.1, 0.05, 0.0]~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$w = [0.4, 0.2, 0.25, 0.15]$（无量纲，总和为 $1$），$r = [0.9, 1.3, 1.6, 1.0]$（无量纲）。\n- 案例 2（边界情况：零型态和零状态依赖）：$F = 3.7~\\mathrm{W\\,m^{-2}}$，$\\lambda_0 = 1.05~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\alpha = 0.0~\\mathrm{W\\,m^{-2}\\,K^{-2}}$，$k = [0.0, 0.0, 0.0]~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$w = [0.5, 0.3, 0.2]$，$r = [1.0, 1.0, 1.0]$。\n- 案例 3（状态依赖和降低有效反馈的负核函数）：$F = 3.7~\\mathrm{W\\,m^{-2}}$，$\\lambda_0 = 1.5~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\alpha = 0.08~\\mathrm{W\\,m^{-2}\\,K^{-2}}$，$k = [-0.3, -0.1, -0.05]~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$w = [0.5, 0.3, 0.2]$，$r = [1.4, 0.8, 1.2]$。\n- 案例 4（混合符号核函数和微小的状态依赖）：$F = 3.7~\\mathrm{W\\,m^{-2}}$，$\\lambda_0 = 0.9~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\alpha = 0.02~\\mathrm{W\\,m^{-2}\\,K^{-2}}$，$k = [0.15, -0.25, 0.05, -0.1]~\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$w = [0.3, 0.3, 0.2, 0.2]$，$r = [1.1, 1.3, 0.7, 1.8]$。\n\n您的程序应产生单行输出，其中包含 $4$ 个测试案例的平衡全球平均温度异常。输出格式为方括号内以逗号分隔的列表，单位为开尔文，并四舍五入到 $2$ 位小数，例如 $[T_1,T_2,T_3,T_4]$，其中每个 $T_i$ 是一个单位为 $\\mathrm{K}$ 的浮点数。",
            "solution": "问题陈述经过了严格验证，被确定为具有科学依据、自洽且适定。它提出了一个简化但标准的气候科学中使用的全球能量平衡模型公式，没有矛盾或歧义。所有必需的参数和条件都已明确提供。\n\n目标是在指定的辐射强迫 $F$ 下，确定平衡时的全球平均地表温度异常，记为 $T_{\\text{eq}}$。该模型同时包含了状态依赖的气候反馈和空间型态效应。\n\n分析始于平衡状态下的大气层顶（TOA）能量平衡方程，其中净向下辐射通量 $N$ 为零：\n$$N = F - R = 0 \\implies F = R$$\n此处，$F$ 是外部辐射强迫，$R$ 是气候系统的出射辐射响应。响应 $R$ 被建模为全球总合反馈项和空间型态效应项 $P$ 的和：\n$$R = \\lambda(T) \\, T + P(T, \\text{pattern})$$\n气候反馈参数 $\\lambda(T)$ 是状态依赖的，由以下线性关系给出：\n$$\\lambda(T) = \\lambda_0 + \\alpha \\, T$$\n其中 $\\lambda_0$ 是基线反馈参数，$\\alpha$ 是状态依赖系数，$T$ 是全球平均温度异常。\n\n型态效应 $P$ 被参数化为对 $n$ 个地理区域的求和：\n$$P = \\sum_{i=1}^{n} k_i \\, w_i \\, T_i$$\n其中对于每个区域 $i$，$k_i$ 是辐射核函数，$w_i$ 是面积权重，$T_i$ 是区域温度异常。区域异常通过放大比 $r_i$ 与全球平均异常 $T$ 相关联：\n$$T_i = r_i \\, T$$\n将此代入 $P$ 的表达式中，可以将其表示为 $T$ 的函数：\n$$P = \\sum_{i=1}^{n} k_i \\, w_i \\, (r_i \\, T) = \\left( \\sum_{i=1}^{n} k_i \\, w_i \\, r_i \\right) T$$\n遵循问题的指令，我们定义一个总合型态效应参数 $\\gamma$ 为：\n$$\\gamma = \\sum_{i=1}^{n} k_i \\, w_i \\, r_i$$\n$\\gamma$ 的单位是 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，与反馈参数的单位相同。因此，总辐射响应可以写为：\n$$R = (\\lambda_0 + \\alpha T) T + \\gamma T$$\n将这个 $R$ 的表达式代入平衡条件 $F = R$ 中，得到：\n$$F = (\\lambda_0 + \\alpha T) T + \\gamma T$$\n$$F = \\lambda_0 T + \\alpha T^2 + \\gamma T$$\n将其整理成二次方程的标准形式 $a x^2 + b x + c = 0$，其中 $x = T_{\\text{eq}}$，我们得到：\n$$\\alpha T_{\\text{eq}}^2 + (\\lambda_0 + \\gamma) T_{\\text{eq}} - F = 0$$\n这个关于 $T_{\\text{eq}}$ 的二次方程的系数是：\n$$a = \\alpha$$\n$$b = \\lambda_0 + \\gamma$$\n$$c = -F$$\n该方程的解取决于 $\\alpha$ 的值。\n\n情况1：无状态依赖性（$\\alpha = 0$）\n如果 $\\alpha = 0$，方程简化为线性方程：\n$$(\\lambda_0 + \\gamma) T_{\\text{eq}} - F = 0$$\n那么平衡温度异常的解是：\n$$T_{\\text{eq}} = \\frac{F}{\\lambda_0 + \\gamma}$$\n这对应于一个具有恒定有效反馈参数 $\\lambda_{\\text{eff}} = \\lambda_0 + \\gamma$ 的模型。\n\n情况2：存在状态依赖性（$\\alpha \\neq 0$）\n如果 $\\alpha \\neq 0$，我们求解这个二次方程。标准二次公式给出两个解：\n$$T_{\\text{eq}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n代入我们的系数：\n$$T_{\\text{eq}} = \\frac{-(\\lambda_0 + \\gamma) \\pm \\sqrt{(\\lambda_0 + \\gamma)^2 - 4(\\alpha)(-F)}}{2\\alpha} = \\frac{-(\\lambda_0 + \\gamma) \\pm \\sqrt{(\\lambda_0 + \\gamma)^2 + 4\\alpha F}}{2\\alpha}$$\n为了存在物理上有意义的解，判别式 $\\Delta = (\\lambda_0 + \\gamma)^2 + 4\\alpha F$ 必须为非负。提供的所有测试案例都满足这一点，因为 $F > 0$ 且 $\\alpha \\ge 0$。我们必须选择物理上相关的根，对于正强迫（$F > 0$），该根应产生正增温（$T_{\\text{eq}} > 0$）。\n\n为确保数值稳定性，特别是当 $4\\alpha F$ 很小时避免相减抵消，我们对所求的根使用二次公式的另一种形式。当 $\\alpha \\to 0$ 时能正确收敛到线性解的根是：\n$$T_{\\text{eq}} = \\frac{2c}{-b \\mp \\sqrt{b^2-4ac}}$$\n通过在分母中选择能避免抵消的符号（即，将两个同号项相加），我们得到了鲁棒的公式。令 $\\Lambda = \\lambda_0 + \\gamma$。假设 $\\Lambda > 0$（一个稳定的气候），则数值上稳定且物理上正确的解是：\n$$T_{\\text{eq}} = \\frac{-2F}{-(\\Lambda) - \\sqrt{\\Lambda^2 + 4\\alpha F}} = \\frac{2F}{\\Lambda + \\sqrt{\\Lambda^2 + 4\\alpha F}}$$\n这个公式在 $\\alpha \\to 0$ 时是良态的，因为 $\\sqrt{\\Lambda^2 + 4\\alpha F} \\to \\Lambda$，从而得到 $T_{\\text{eq}} \\to \\frac{2F}{\\Lambda + \\Lambda} = \\frac{F}{\\Lambda}$，这正是线性解。\n\n算法的流程是，首先为每个测试案例计算 $\\gamma$，然后根据 $\\alpha$ 的值使用相应的线性或二次公式求解 $T_{\\text{eq}}$。最终结果按要求四舍五入到两位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium warming for a series of climate model parameter sets.\n    The model includes state-dependent feedbacks and spatial pattern effects.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (F, lambda0, alpha, k, w, r)\n    test_cases = [\n        # Case 1\n        (3.7, 1.2, 0.05, [-0.2, 0.1, 0.05, 0.0], [0.4, 0.2, 0.25, 0.15], [0.9, 1.3, 1.6, 1.0]),\n        # Case 2\n        (3.7, 1.05, 0.0, [0.0, 0.0, 0.0], [0.5, 0.3, 0.2], [1.0, 1.0, 1.0]),\n        # Case 3\n        (3.7, 1.5, 0.08, [-0.3, -0.1, -0.05], [0.5, 0.3, 0.2], [1.4, 0.8, 1.2]),\n        # Case 4\n        (3.7, 0.9, 0.02, [0.15, -0.25, 0.05, -0.1], [0.3, 0.3, 0.2, 0.2], [1.1, 1.3, 0.7, 1.8]),\n    ]\n\n    results = []\n    for case in test_cases:\n        F, lambda0, alpha, k, w, r = case\n        \n        # Convert lists to numpy arrays for vectorized operations\n        k_arr = np.array(k)\n        w_arr = np.array(w)\n        r_arr = np.array(r)\n\n        # Step 1: Compute the aggregated pattern effect contribution gamma.\n        gamma = np.sum(k_arr * w_arr * r_arr)\n        \n        # Define the total linear part of the feedback\n        Lambda = lambda0 + gamma\n        \n        # Step 2: Solve the equilibrium condition for T_eq.\n        # This is a quadratic equation: alpha*T^2 + Lambda*T - F = 0\n        T_eq = 0.0\n\n        # Handle the special case of negligible state dependence (alpha is zero).\n        # In this case, the equation is linear: Lambda*T = F.\n        # A small tolerance is used for floating point comparison, although direct\n        # comparison works for the given test cases.\n        if np.isclose(alpha, 0.0):\n            # The denominator Lambda = lambda0 + gamma should be positive for a stable climate.\n            if Lambda > 0:\n                T_eq = F / Lambda\n        else:\n            # For the quadratic case, use the numerically stable formula for the\n            # physically relevant (positive) root.\n            # T_eq = (2*F) / (Lambda + sqrt(Lambda^2 + 4*alpha*F))\n            discriminant = Lambda**2 + 4 * alpha * F\n            \n            # For the given problem constraints (F>0, alpha>=0, stable base climate),\n            # the discriminant will be non-negative.\n            if discriminant >= 0:\n                T_eq = (2 * F) / (Lambda + np.sqrt(discriminant))\n\n        # Round the result to 2 decimal places and add to the list.\n        results.append(round(T_eq, 2))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}