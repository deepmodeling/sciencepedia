{
    "hands_on_practices": [
        {
            "introduction": "韦伯斯特-杨指数（WYI）是衡量南亚季风大尺度垂直风切变的核心指标。这个风切变从根本上与经向温度梯度通过热成风关系联系在一起。本练习将指导您推导这一关系，并探讨模型的对流参数化方案（如对流矩量输送）如何改变这一基本平衡，这对于诊断模型为何会模拟出偏强或偏弱的季风环流至关重要。",
            "id": "4067435",
            "problem": "考虑韦伯斯特-杨指数（WYI），此处定义为南亚季风区对流层低层和高层之间纬向风的区域平均差异，$$\\mathrm{WYI} \\equiv \\overline{u}(p_{l}) - \\overline{u}(p_{u}),$$ 其中 $\\overline{u}$ 表示在指定区域内平均的纬向风，上划线表示区域平均，$p_{l} = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$，$p_{u} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$。假设大尺度气流满足静力平衡和近似地转平衡，并从热成风平衡作为基本出发点。推导 $\\mathrm{WYI}$ 与经向温度梯度的垂直积分之间的关系。然后，引入一个简单的对流-切变耦合表示，其中对流性动量输送 (CMT) 将有效垂直切变减小一个无量纲因子 $\\lambda$，使得模型的有效切变是热成风平衡值的 $(1 - \\lambda)$ 倍，其中 $\\lambda = 0.30$。\n\n给定一个在对数气压坐标下科学上合理的经向温度梯度廓线，\n$$\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right),$$\n其中 $g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$，$g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$，以及 $p_{0} = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。假设科里奥利参数 $f$ 在该层内垂直方向上是均匀的，并使用 $f = 2 \\Omega \\sin \\phi$ 在纬度 $\\phi = 15$ 度处计算，其中地球自转速率为 $\\Omega = 7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}$。使用干空气的理想气体常数 $R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$。\n\n1. 使用热成风平衡和给定的 $\\frac{\\partial T}{\\partial y}(p)$，推导热成风平衡的 WYI（记为 $\\mathrm{WYI}_{\\mathrm{TW}}$）的闭式表达式。\n2. 使用上述简单的对流-切变耦合，将模型的有效 $\\mathrm{WYI}$ 写成 $\\mathrm{WYI}_{\\mathrm{TW}}$ 和 $\\lambda$ 的函数，然后对所提供的参数进行数值计算。\n\n以 $\\mathrm{m} \\ \\mathrm{s}^{-1}$ 为单位表示 $\\mathrm{WYI}$ 的最终值，并将答案四舍五入到四位有效数字。三角函数中使用的角度应解释为度。",
            "solution": "用户要求我验证并解决一个关于韦伯斯特-杨指数（WYI）的问题，该指数是南亚季风的一个诊断量，基于热成风平衡和对流效应的参数化。\n\n### 第1步：问题验证\n我将首先提取给定信息并验证问题陈述。\n\n**给定条件：**\n-   韦伯斯特-杨指数（WYI）定义：$\\mathrm{WYI} \\equiv \\overline{u}(p_{l}) - \\overline{u}(p_{u})$，其中 $\\overline{u}$ 是区域平均纬向风。\n-   低气压层：$p_{l} = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$。\n-   高气压层：$p_{u} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$。\n-   假设：大尺度气流满足静力平衡和近似地转平衡。\n-   基本原理：热成风平衡。\n-   对流-切变耦合：模型的有效切变是热成风平衡切变的 $(1 - \\lambda)$ 倍，其中 $\\lambda = 0.30$。\n-   对数气压坐标下的经向温度梯度廓线：$\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right)$。\n-   梯度廓线的常数：$g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 和 $g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$。\n-   参考气压：$p_{0} = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。\n-   科里奥利参数 $f$ 假设为垂直均匀，并在纬度 $\\phi = 15$ 度处计算。\n-   科里奥利参数公式：$f = 2 \\Omega \\sin \\phi$。\n-   地球自转速率：$\\Omega = 7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}$。\n-   干空气的理想气体常数：$R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$。\n\n**验证：**\n1.  **科学依据：**该问题牢固地植根于大气动力学的基本原理，特别是地转平衡和静力平衡，这两者结合起来得到热成风方程。WYI 是季风研究中一个标准且完善的诊断量。将对流性动量输送参数化为切变的线性减小，是一个简化但具有物理动机的概念，在气候模拟中使用。所有常数和参数的数值对于地球大气和指定的地理背景都是物理上现实的。\n2.  **适定性：**该问题是适定的。它提供了所有必要的方程、常数和边界条件，以推导出唯一的解析表达式并计算出单一的数值。任务定义清晰且逻辑上是顺序的。\n3.  **客观性：**该问题以精确、定量和无偏见的科学语言陈述。\n\n**结论：**该问题科学上合理、适定且客观。可以进行求解。\n\n### 第2步：求解推导\n\n根据问题陈述的要求，求解过程分为两部分。\n\n**第1部分：热成风平衡 WYI ($\\mathrm{WYI}_{\\mathrm{TW}}$) 的推导**\n\n我们从气压坐标系中纬向风 $u$ 的热成风方程开始，该方程由地转平衡和静力平衡导出。对于近似地转的气流，我们可以用区域平均纬向风 $\\overline{u}$ 替换为地转纬向风 $u_g$。热成风方程的相关分量是：\n$$\n\\frac{\\partial u_g}{\\partial p} = \\frac{R}{fp} \\left(\\frac{\\partial T}{\\partial y}\\right)_p\n$$\n此处，$R$ 是比气体常数，$f$ 是科里奥利参数，$p$ 是气压，$\\left(\\frac{\\partial T}{\\partial y}\\right)_p$ 是等压面上的经向温度梯度。\n\n韦伯斯特-杨指数（WYI）定义为低气压层 $p_l$ 和高气压层 $p_u$ 之间的纬向风差异。这个差异代表了纬向风的垂直切变。我们可以通过将热成风方程对气压从 $p_u$ 积分到 $p_l$ 来找到这个差异：\n$$\n\\int_{p_u}^{p_l} \\frac{\\partial u_g}{\\partial p} dp = \\int_{p_u}^{p_l} \\frac{R}{fp} \\left(\\frac{\\partial T}{\\partial y}\\right)_p dp\n$$\n方程的左边计算结果为：\n$$\n\\int_{p_u}^{p_l} d u_g = u_g(p_l) - u_g(p_u)\n$$\n根据定义，这就是热成风平衡的 WYI，我们将其记为 $\\mathrm{WYI}_{\\mathrm{TW}}$：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = u_g(p_l) - u_g(p_u)\n$$\n因此，$\\mathrm{WYI}_{\\mathrm{TW}}$ 的表达式为：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\int_{p_u}^{p_l} \\frac{1}{p} \\left(\\frac{\\partial T}{\\partial y}\\right)_p dp\n$$\n问题给出了经向温度梯度的函数形式：\n$$\n\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right)\n$$\n我们将此表达式代入积分中：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\int_{p_u}^{p_l} \\frac{1}{p} \\left[ g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right) \\right] dp\n$$\n该积分可以分为两部分：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\left[ \\int_{p_u}^{p_l} \\frac{g_0}{p} dp + \\int_{p_u}^{p_l} \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp \\right]\n$$\n我们计算每个积分。第一个积分是：\n$$\n\\int_{p_u}^{p_l} \\frac{g_0}{p} dp = g_0 [\\ln(p)]_{p_u}^{p_l} = g_0 (\\ln(p_l) - \\ln(p_u)) = g_0 \\ln\\left(\\frac{p_l}{p_u}\\right)\n$$\n对于第二个积分，我们使用换元法，令 $x = \\ln(p/p_0)$，因此 $dx = (1/p)dp$。积分变成了一个简单的多项式积分：\n$$\n\\int \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp = g_1 \\int x dx = \\frac{g_1}{2} x^2 = \\frac{g_1}{2} \\left( \\ln\\left(\\frac{p}{p_{0}}\\right) \\right)^2\n$$\n计算定积分得到：\n$$\n\\int_{p_u}^{p_l} \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp = \\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p}{p_{0}}\\right) \\right)^2 \\right]_{p_u}^{p_l} = \\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right]\n$$\n结合这些结果，我们得到 $\\mathrm{WYI}_{\\mathrm{TW}}$ 的闭式表达式：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\left[ g_0 \\ln\\left(\\frac{p_l}{p_u}\\right) + \\frac{g_1}{2} \\left( \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right) \\right]\n$$\n这就完成了第一个任务。\n\n**第2部分：模型有效 WYI 的计算**\n\n问题陈述，对流性动量输送 (CMT) 将有效垂直切变减小一个无量纲因子 $\\lambda$。模型的有效切变是热成风平衡值的 $(1 - \\lambda)$ 倍。由于 $\\mathrm{WYI}$ 是垂直切变的度量，模型的有效 $\\mathrm{WYI}$ 由下式给出：\n$$\n\\mathrm{WYI} = (1 - \\lambda) \\mathrm{WYI}_{\\mathrm{TW}}\n$$\n这就是所要求的功能关系。现在我们必须对这个表达式进行数值计算。\n\n首先，我们计算纬度 $\\phi = 15$ 度处的科里奥利参数 $f$：\n$$\nf = 2 \\Omega \\sin \\phi = 2 \\times (7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}) \\times \\sin(15^{\\circ}) \\approx 2 \\times (7.292 \\times 10^{-5}) \\times 0.258819 \\ \\mathrm{s}^{-1} \\approx 3.77539 \\times 10^{-5} \\ \\mathrm{s}^{-1}\n$$\n接下来，我们使用给定的气压值计算对数项：$p_l = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$，$p_u = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$，$p_0 = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。\n$$\n\\ln\\left(\\frac{p_l}{p_u}\\right) = \\ln\\left(\\frac{8.5 \\times 10^{4}}{2.0 \\times 10^{4}}\\right) = \\ln(4.25) \\approx 1.446919\n$$\n$$\n\\ln\\left(\\frac{p_l}{p_{0}}\\right) = \\ln\\left(\\frac{8.5 \\times 10^{4}}{1.0 \\times 10^{5}}\\right) = \\ln(0.85) \\approx -0.162519\n$$\n$$\n\\ln\\left(\\frac{p_u}{p_{0}}\\right) = \\ln\\left(\\frac{2.0 \\times 10^{4}}{1.0 \\times 10^{5}}\\right) = \\ln(0.20) \\approx -1.609438\n$$\n现在，我们使用 $g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 和 $g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 来计算 $\\mathrm{WYI}_{\\mathrm{TW}}$ 表达式中方括号内的项：\n$$\ng_0 \\ln\\left(\\frac{p_l}{p_u}\\right) \\approx (2.0 \\times 10^{-6}) \\times 1.446919 = 2.893838 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n$$\n\\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right] \\approx \\frac{0.5 \\times 10^{-6}}{2} \\left[ (-0.162519)^2 - (-1.609438)^2 \\right]\n$$\n$$\n\\approx (0.25 \\times 10^{-6}) \\left[ 0.026412 - 2.59029 \\right] = (0.25 \\times 10^{-6}) \\times (-2.563878) \\approx -0.640970 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n括号内的和是：\n$$\n(2.893838 - 0.640970) \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1} = 2.252868 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n现在，我们使用 $R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$ 计算 $\\mathrm{WYI}_{\\mathrm{TW}}$：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\times (2.252868 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}) \\approx \\frac{287}{3.77539 \\times 10^{-5}} \\times (2.252868 \\times 10^{-6}) \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} \\approx (7.602008 \\times 10^{6}) \\times (2.252868 \\times 10^{-6}) \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\approx 17.1263 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n最后，我们应用对流-切变耦合因子 $(1 - \\lambda) = (1 - 0.30) = 0.70$：\n$$\n\\mathrm{WYI} = 0.70 \\times \\mathrm{WYI}_{\\mathrm{TW}} \\approx 0.70 \\times 17.1263 \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\approx 11.98841 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\mathrm{WYI} \\approx 11.99 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n正值表示低层纬向风比高层纬向风更偏西，这是南亚季风环流的特征（低层西风，高层东风急流）。其量级在物理上是合理的。",
            "answer": "$$\n\\boxed{11.99}\n$$"
        },
        {
            "introduction": "准确模拟季风降水是气候模型面临的一大挑战。本练习聚焦于整层水汽收支，这是分析降水的根本框架。您将通过一个简化的诊断模型来研究对流参数化中的一个关键参数——夹卷率——如何通过改变降水效率，并反馈到蒸发和水汽辐合上，从而影响总降水量。这项练习能让您直接体验模型敏感性分析的过程。",
            "id": "4067500",
            "problem": "需要实现一个简化的、有科学依据的诊断模型，以量化对流夹带率的变化如何影响两个地区——孟加拉湾和印度中部——在6月-7月-8月-9月（JJAS）的降雨。推导和计算必须从整层水汽收支恒等式开始，这是季风诊断中一个被广泛接受的基础。该恒等式为\n$$\nP - E = -\\nabla \\cdot (q \\mathbf{v}) - \\frac{\\partial W}{\\partial t},\n$$\n其中 $P$ 是降水，$E$ 是蒸发，$q$ 是比湿，$\\mathbf{v}$ 是风矢量，$W = \\int q \\rho \\, dz$ 是整层水汽含量（$\\rho$ 为密度，$z$ 为高度）。对于JJAS的季节平均值，储存项相对于平均通量很小，这一点已经得到了很好的验证，因此可以设定 $\\frac{\\partial W}{\\partial t} \\approx 0$。于是，季节平均的收支平衡变为\n$$\nP = E + C,\n$$\n其中 $C \\equiv -\\nabla \\cdot (q \\mathbf{v})$ 是总水汽辐合。在一个参数化的对流系统中，对流夹带通过将环境中的干空气混入上升气流，降低了对流云羽将湿空气流入转化为降水的效率。为了分析敏感性，定义一个无量纲的降水效率函数，该函数随一个标度化的夹带率单调递减。设 $\\varepsilon$ 为对流夹带率，单位为 $\\text{km}^{-1}$，并定义标度化夹带 $s = \\varepsilon / \\varepsilon_{\\mathrm{ref}}$，其中 $\\varepsilon_{\\mathrm{ref}}$ 是一个参考率。设降水效率为\n$$\n\\varphi(s) = \\frac{\\varphi_{\\max}}{1 + \\alpha s},\n$$\n其中 $\\varphi_{\\max}$ 是零夹带时的最大效率，$\\alpha$ 是一个正的敏感性系数。季节性蒸发和水汽辐合并非完全由外部强迫决定；它们会通过近地表湿度亏损和季风环流强度来适应对流强度。为了在一个与JJAS收支一致的线性化诊断闭合方案中从第一性原理表示这些调整，定义相对于基准夹带 $\\varepsilon_0$ 的变化，其效率为 $\\varphi_0 = \\varphi(\\varepsilon_0 / \\varepsilon_{\\mathrm{ref}})$。对于一个给定的区域，其基准蒸发为 $E_0$，基准辐合为 $C_0$，定义\n$$\nE(\\varepsilon) = E_0 \\left[1 - \\gamma \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right],\n$$\n$$\nC(\\varepsilon) = C_0 \\left[1 + \\chi \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right],\n$$\n其中 $\\gamma$ 和 $\\chi$ 是无量纲的敏感性系数：较大的 $\\varphi$ 会使边界层湿润，通常会减少 $E$（因此是负号），同时会加强季风环流并增加 $C$（正号）。那么，JJAS的降水为\n$$\nP(\\varepsilon) = E(\\varepsilon) + C(\\varepsilon),\n$$\n相对于基准的变化为 $\\Delta P = P(\\varepsilon) - P(\\varepsilon_0)$、$\\Delta E = E(\\varepsilon) - E(\\varepsilon_0)$ 和 $\\Delta C = C(\\varepsilon) - C(\\varepsilon_0)$。闭合残差定义为\n$$\nR(\\varepsilon) = P(\\varepsilon) - E(\\varepsilon) - C(\\varepsilon),\n$$\n在诊断公式下，其数值应为零。所有降水和通量都必须以 $\\text{mm day}^{-1}$ 为单位表示。\n\n使用以下在科学上合理且对JJAS平均值自洽的参数值来实现该模型：\n基准夹带 $\\varepsilon_0 = 1.0$（单位 $\\text{km}^{-1}$），参考值 $\\varepsilon_{\\mathrm{ref}} = 1.0$（单位 $\\text{km}^{-1}$），最大效率 $\\varphi_{\\max} = 0.9$，敏感性 $\\alpha = 0.5$，蒸发敏感性 $\\gamma = 0.15$，辐合敏感性 $\\chi = 0.25$。区域基准值：孟加拉湾的 $E_0 = 4.0$ $\\text{mm day}^{-1}$ 和 $C_0 = 8.0$ $\\text{mm day}^{-1}$；印度中部的 $E_0 = 3.0$ $\\text{mm day}^{-1}$ 和 $C_0 = 7.0$ $\\text{mm day}^{-1}$。\n\n您的程序必须为每个测试案例的夹带率计算列表 $[\\Delta P_{\\mathrm{BoB}}, \\Delta P_{\\mathrm{CI}}, \\Delta E_{\\mathrm{BoB}}, \\Delta E_{\\mathrm{CI}}, \\Delta C_{\\mathrm{BoB}}, \\Delta C_{\\mathrm{CI}}, B_{\\mathrm{BoB}}, B_{\\mathrm{CI}}]$，其中变化量 $\\Delta(\\cdot)$ 的单位是 $\\text{mm day}^{-1}$，$B_{\\mathrm{region}}$ 是一个布尔值，指示该区域是否满足 $|R(\\varepsilon)|  \\tau$，容差 $\\tau = 10^{-12}$ $\\text{mm day}^{-1}$。\n\n使用以下单位为 $\\text{km}^{-1}$ 的夹带率测试套件来探测不同的状况：$0.0$（无夹带，下界），$1.0$（基准，正常路径），$4.0$（高夹带，强混合），以及 $10.0$（极端夹带，边缘情况）。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试案例，并且本身是一个列表，其顺序与上述孟加拉湾和印度中部的描述完全一致。例如，一个有效的输出格式是 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，其中所有浮点数为 $\\text{mm day}^{-1}$ 单位的数值，布尔值为收支闭合标志。",
            "solution": "该问题具有科学依据、问题明确且客观。它基于大气整层水汽收支这一公认的原理，这是气候科学中诊断降水及其驱动因素的标准框架。对流效率及其对蒸发和水汽辐合的反馈的参数化方案，虽然经过简化，但在概念上是对物理过程的合理解释。所有必需的参数和初始条件都已提供，从而可以得到唯一且可计算的解。因此，该问题是有效的，并且可以推导出解决方案。\n\n该解决方案通过构建一个基于所提供方程的诊断模型来实现。问题的核心是计算由于对流夹带率 $\\varepsilon$ 的变化所导致的6月-7月-8月-9月（JJAS）季节平均降水的变化量 $\\Delta P$。\n\n出发点是季节平均的水汽收支方程：\n$$\nP = E + C\n$$\n其中 $P$ 是降水，$E$ 是蒸发，$C$ 是水汽辐合。所有量的单位均为 $\\text{mm day}^{-1}$。\n\n该模型将这些分量如何随对流夹带率 $\\varepsilon$（单位为 $\\text{km}^{-1}$）变化进行参数化。\n\n首先，定义了一个无量纲的降水效率 $\\varphi$，它是标度化夹带率 $s = \\varepsilon / \\varepsilon_{\\mathrm{ref}}$ 的函数：\n$$\n\\varphi(s) = \\frac{\\varphi_{\\max}}{1 + \\alpha s}\n$$\n这里，$\\varepsilon_{\\mathrm{ref}} = 1.0$ $\\text{km}^{-1}$ 是参考夹带率，$\\varphi_{\\max} = 0.9$ 是最大效率，$\\alpha = 0.5$ 是一个敏感性系数。\n\n模型计算相对于由基准夹带率 $\\varepsilon_0 = 1.0$ $\\text{km}^{-1}$ 定义的基准状态的变化。第一个计算步骤是确定基准降水效率 $\\varphi_0$：\n$$\ns_0 = \\frac{\\varepsilon_0}{\\varepsilon_{\\mathrm{ref}}} = \\frac{1.0}{1.0} = 1.0\n$$\n$$\n\\varphi_0 = \\varphi(s_0) = \\frac{\\varphi_{\\max}}{1 + \\alpha s_0} = \\frac{0.9}{1 + (0.5)(1.0)} = 0.6\n$$\n每个区域的基准降水 $P_0$ 是基准蒸发 $E_0$ 和基准辐合 $C_0$ 的和：\n-   对于孟加拉湾（BoB）：$P_{0, \\mathrm{BoB}} = E_{0, \\mathrm{BoB}} + C_{0, \\mathrm{BoB}} = 4.0 + 8.0 = 12.0$ $\\text{mm day}^{-1}$。\n-   对于印度中部（CI）：$P_{0, \\mathrm{CI}} = E_{0, \\mathrm{CI}} + C_{0, \\mathrm{CI}} = 3.0 + 7.0 = 10.0$ $\\text{mm day}^{-1}$。\n\n接下来，对于任何给定的测试夹带率 $\\varepsilon$，根据效率的变化量 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0$ 计算调整后的蒸发 $E(\\varepsilon)$ 和辐合 $C(\\varepsilon)$。调整方程为：\n$$\nE(\\varepsilon) = E_0 \\left[1 - \\gamma \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right]\n$$\n$$\nC(\\varepsilon) = C_0 \\left[1 + \\chi \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right]\n$$\n敏感性系数为 $\\gamma = 0.15$ 和 $\\chi = 0.25$。\n\n然后，通过将调整后的分量相加来计算给定 $\\varepsilon$ 下的总降水量：\n$$\nP(\\varepsilon) = E(\\varepsilon) + C(\\varepsilon)\n$$\n我们关心的量是相对于基准的变化量：\n$$\n\\Delta P = P(\\varepsilon) - P_0\n$$\n$$\n\\Delta E = E(\\varepsilon) - E_0\n$$\n$$\n\\Delta C = C(\\varepsilon) - C_0\n$$\n\n最后，计算收支闭合残差 $R(\\varepsilon)$。由于 $P(\\varepsilon)$ 被定义为 $E(\\varepsilon)$ 和 $C(\\varepsilon)$ 的和，该残差在解析上为零：\n$$\nR(\\varepsilon) = P(\\varepsilon) - E(\\varepsilon) - C(\\varepsilon) = (E(\\varepsilon) + C(\\varepsilon)) - (E(\\varepsilon) + C(\\varepsilon)) = 0\n$$\n使用一个小的容差 $\\tau = 10^{-12}$ 来检查 $|R(\\varepsilon)|  \\tau$ 是否成立，这是为了确保实现中的浮点数运算是一致的数值健全性检查。\n\n对每个测试案例 $\\varepsilon$ 的计算步骤如下：\n1.  计算当前的降水效率 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}})$。\n2.  对于每个区域（BoB 和 CI）：\n    a. 使用差值 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0$ 和区域基准值（$E_0, C_0$）来计算调整后的通量 $E(\\varepsilon)$ 和 $C(\\varepsilon)$。\n    b. 计算调整后的总降水量 $P(\\varepsilon)$。\n    c. 计算变化量 $\\Delta P$、$\\Delta E$ 和 $\\Delta C$。\n    d. 计算残差 $R(\\varepsilon)$ 并检查其绝对值是否小于容差 $\\tau$。\n3.  将两个区域的结果按指定顺序组合成一个列表：$[\\Delta P_{\\mathrm{BoB}}, \\Delta P_{\\mathrm{CI}}, \\Delta E_{\\mathrm{BoB}}, \\Delta E_{\\mathrm{CI}}, \\Delta C_{\\mathrm{BoB}}, \\Delta C_{\\mathrm{CI}}, B_{\\mathrm{BoB}}, B_{\\mathrm{CI}}]$。对测试套件中的所有夹带率重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes changes in JJAS rainfall based on a simplified diagnostic model\n    of convective entrainment's impact on precipitation efficiency, evaporation,\n    and moisture convergence.\n    \"\"\"\n\n    # --- Step 1: Define constants and regional baselines ---\n    \n    # Model parameters\n    epsilon_0 = 1.0  # Baseline entrainment rate (km^-1)\n    epsilon_ref = 1.0  # Reference entrainment rate (km^-1)\n    phi_max = 0.9      # Maximum precipitation efficiency (dimensionless)\n    alpha = 0.5        # Efficiency sensitivity coefficient (dimensionless)\n    gamma = 0.15       # Evaporation sensitivity coefficient (dimensionless)\n    chi = 0.25         # Convergence sensitivity coefficient (dimensionless)\n    tau = 1e-12        # Tolerance for budget closure check (mm day^-1)\n\n    # Regional baseline data\n    regions = {\n        \"BoB\": {\"E0\": 4.0, \"C0\": 8.0},  # Bay of Bengal\n        \"CI\": {\"E0\": 3.0, \"C0\": 7.0}   # Central India\n    }\n\n    # Test suite of entrainment rates (km^-1)\n    test_epsilons = [0.0, 1.0, 4.0, 10.0]\n\n    # --- Step 2: Define helper function and calculate baseline state ---\n\n    def calc_phi(epsilon, epsilon_ref, phi_max, alpha):\n        \"\"\"Calculates precipitation efficiency phi(s).\"\"\"\n        s = epsilon / epsilon_ref\n        return phi_max / (1.0 + alpha * s)\n\n    # Calculate baseline precipitation efficiency\n    phi_0 = calc_phi(epsilon_0, epsilon_ref, phi_max, alpha)\n\n    # Calculate baseline precipitation P0 for each region\n    for name, params in regions.items():\n        params[\"P0\"] = params[\"E0\"] + params[\"C0\"]\n\n    # --- Step 3: Iterate through test cases and compute results ---\n    \n    all_results = []\n    for epsilon in test_epsilons:\n        \n        # Calculate current precipitation efficiency\n        current_phi = calc_phi(epsilon, epsilon_ref, phi_max, alpha)\n        phi_diff = current_phi - phi_0\n        \n        case_results_dict = {}\n\n        # Perform calculations for each region\n        for name, params in regions.items():\n            E0 = params[\"E0\"]\n            C0 = params[\"C0\"]\n            P0 = params[\"P0\"]\n\n            # Calculate adjusted evaporation and convergence\n            E_eps = E0 * (1.0 - gamma * phi_diff)\n            C_eps = C0 * (1.0 + chi * phi_diff)\n            \n            # Calculate adjusted precipitation\n            P_eps = E_eps + C_eps\n            \n            # Calculate changes from baseline\n            delta_P = P_eps - P0\n            delta_E = E_eps - E0\n            delta_C = C_eps - C0\n            \n            # Calculate closure residual and check budget\n            R_eps = P_eps - (E_eps + C_eps)\n            B = abs(R_eps)  tau\n            \n            case_results_dict[name] = {\n                \"delta_P\": delta_P,\n                \"delta_E\": delta_E,\n                \"delta_C\": delta_C,\n                \"B\": B\n            }\n\n        # Assemble the results list in the specified order\n        result_list = [\n            case_results_dict[\"BoB\"][\"delta_P\"], case_results_dict[\"CI\"][\"delta_P\"],\n            case_results_dict[\"BoB\"][\"delta_E\"], case_results_dict[\"CI\"][\"delta_E\"],\n            case_results_dict[\"BoB\"][\"delta_C\"], case_results_dict[\"CI\"][\"delta_C\"],\n            case_results_dict[\"BoB\"][\"B\"], case_results_dict[\"CI\"][\"B\"]\n        ]\n        all_results.append(result_list)\n\n    # --- Step 4: Format and print final output ---\n    \n    # The required format is a string representation of a list of lists.\n    # Ex: [[...], [...], ...]\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "海洋在季风系统中扮演着主动的角色，尤其是在季节内时间尺度上。本练习将深入探讨孟加拉湾海洋混合层的热量收支。通过剖析地表通量（特别是与云有关的短波辐射）和海洋过程（如夹卷）的贡献，您将量化在季风活跃期和中断期海表温度发生变化的原因，这是驱动大气对流的关键因素。",
            "id": "4067439",
            "problem": "您接到一项建模任务，要求在给定的季风状况下，诊断六月份孟加拉湾海洋混合层的热收支。您的程序必须计算混合层温度倾向（单位：开尔文/天），并明确量化云对短波通量的衰减作用以及夹带冷却的作用。请严格依据下文概述的基本守恒定律和经过充分检验的参数化方案来构建您的解决方案，然后将其应用于本问题提供的测试集。您的最终程序必须生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n\n使用以下基本依据和定义：\n- 海洋混合层中的热量守恒：混合层热含量的变化率等于进入混合层的净非绝热表面热输入加上因夹带而在混合层底部交换的热通量。设混合层深度为 $h$（单位：$\\mathrm{m}$），海水密度为 $\\rho$（单位：$\\mathrm{kg\\,m^{-3}}$），定压比热容为 $c_p$（单位：$\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）。设混合层温度为 $T_m$（单位：$\\mathrm{K}$），混合层正下方的温度为 $T_b$（单位：$\\mathrm{K}$），夹带速度（向下为正，表示加深）为 $w_e$（单位：$\\mathrm{m\\,s^{-1}}$）。\n- 海洋中的短波辐射传输由 Beer-Lambert 衰减定律表示。如果 $Q_{sw,\\mathrm{clear}}$ 是晴空条件下到达海洋表面的下行短波辐射（单位：$\\mathrm{W\\,m^{-2}}$），则云量为 $C$（无单位，介于 $0$ 和 $1$ 之间的小数）的云的存在会使表面短波辐射衰减为 $Q_{sw,\\mathrm{sfc}} = (1 - \\gamma C)\\,Q_{sw,\\mathrm{clear}}$，其中 $\\gamma$（无单位）是一个云衰减效率参数。表面短波辐射的一部分（比例为 $r$，无单位）被海洋表面反射（海洋反照率），而垂直吸收遵循指数形式，其漫射衰减系数为 $k_d$（单位：$\\mathrm{m^{-1}}$）。\n- 深度为 $h$ 的混合层内吸收的 $Q_{sw,\\mathrm{sfc}}$ 比例为 $(1 - r)\\left(1 - e^{-k_d h}\\right)$。将混合层内吸收的短波辐射记为 $Q_{sw}^{ML}$（单位：$\\mathrm{W\\,m^{-2}}$）。\n- 非短波表面热通量（长波、感热、潜热）作为海表面的净通量，向下进入海洋为正。设 $Q_{lw}$、$Q_{s}$ 和 $Q_{l}$ 分别为净长波、感热和潜热通量（单位均为 $\\mathrm{W\\,m^{-2}}$）。在六月的孟加拉湾，典型的符号规定是 $Q_{l}$ 为负值（向上，表示冷却）。\n- 夹带对混合层温度倾向的贡献由混合层底部的水交换表示，其温跃为 $(T_b - T_m)$，并根据夹带速度和混合层厚度进行缩放。\n\n基于这些基本原理，推导混合层温度倾向 $dT_m/dt$（单位：$\\mathrm{K\\,s^{-1}}$）的表达式，该表达式应包含混合层内吸收的净短波能量、非短波通量以及夹带项。然后将所有结果乘以 $86400$，转换为 $\\mathrm{K\\,day^{-1}}$。\n\n对于每个测试用例，您的程序必须计算：\n- 总混合层温度倾向，单位为 $\\mathrm{K\\,day^{-1}}$，包括经云衰减的短波、长波、感热、潜热通量以及夹带项。\n- 云对短波通量衰减对温度倾向的贡献，单位为 $\\mathrm{K\\,day^{-1}}$，定义为有云和晴空条件下混合层内短波加热之差除以 $\\rho c_p h$。\n- 夹带温度倾向项，单位为 $\\mathrm{K\\,day^{-1}}$。\n\n所有输出必须四舍五入到小数点后 $5$ 位，并按下面“测试集和输出格式”部分指定的顺序打印为单个列表。\n\n物理和数值单位：\n- 所有倾向均以 $\\mathrm{K\\,day^{-1}}$ 为单位报告，并四舍五入到小数点后 $5$ 位。\n- 所有输入均采用国际单位制（SI）：通量单位为 $\\mathrm{W\\,m^{-2}}$，深度单位为 $\\mathrm{m}$，速度单位为 $\\mathrm{m\\,s^{-1}}$，温度单位为 $\\mathrm{K}$，衰减系数单位为 $\\mathrm{m^{-1}}$，无量纲系数无单位。\n\n测试集和参数：\n假设所有情况均使用以下常量：\n- 海水密度 $\\rho = 1025$ $\\mathrm{kg\\,m^{-3}}$。\n- 定压比热容 $c_p = 3985$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 海洋反照率 $r = 0.06$（无单位）。\n- 云衰减效率 $\\gamma = 0.62$（无单位）。\n\n测试集包含三组代表孟加拉湾六月状况的参数：\n- 案例 A（活跃季风期，云层深厚，强夹带）：\n  - 混合层深度 $h = 20$ $\\mathrm{m}$。\n  - 漫射衰减系数 $k_d = 0.06$ $\\mathrm{m^{-1}}$。\n  - 云量 $C = 0.85$（无单位小数）。\n  - 晴空表面短波辐射 $Q_{sw,\\mathrm{clear}} = 260$ $\\mathrm{W\\,m^{-2}}$。\n  - 净长波辐射 $Q_{lw} = -50$ $\\mathrm{W\\,m^{-2}}$。\n  - 感热通量 $Q_{s} = -10$ $\\mathrm{W\\,m^{-2}}$。\n  - 潜热通量 $Q_{l} = -120$ $\\mathrm{W\\,m^{-2}}$。\n  - 夹带速度 $w_e = 5\\times 10^{-5}$ $\\mathrm{m\\,s^{-1}}$。\n  - 混合层温度 $T_m = 300.65$ $\\mathrm{K}$。\n  - 亚混合层温度 $T_b = 299.15$ $\\mathrm{K}$。\n- 案例 B（季风中断期，云量较少，弱夹带）：\n  - 混合层深度 $h = 25$ $\\mathrm{m}$。\n  - 漫射衰减系数 $k_d = 0.06$ $\\mathrm{m^{-1}}$。\n  - 云量 $C = 0.20$（无单位小数）。\n  - 晴空表面短波辐射 $Q_{sw,\\mathrm{clear}} = 260$ $\\mathrm{W\\,m^{-2}}$。\n  - 净长波辐射 $Q_{lw} = -45$ $\\mathrm{W\\,m^{-2}}$。\n  - 感热通量 $Q_{s} = -8$ $\\mathrm{W\\,m^{-2}}$。\n  - 潜热通量 $Q_{l} = -100$ $\\mathrm{W\\,m^{-2}}$。\n  - 夹带速度 $w_e = 1\\times 10^{-5}$ $\\mathrm{m\\,s^{-1}}$。\n  - 混合层温度 $T_m = 301.15$ $\\mathrm{K}$。\n  - 亚混合层温度 $T_b = 300.45$ $\\mathrm{K}$。\n- 案例 C（边缘案例：完全阴天，混合层极浅，强夹带）：\n  - 混合层深度 $h = 10$ $\\mathrm{m}$。\n  - 漫射衰减系数 $k_d = 0.06$ $\\mathrm{m^{-1}}$。\n  - 云量 $C = 1.00$（无单位小数）。\n  - 晴空表面短波辐射 $Q_{sw,\\mathrm{clear}} = 240$ $\\mathrm{W\\,m^{-2}}$。\n  - 净长波辐射 $Q_{lw} = -60$ $\\mathrm{W\\,m^{-2}}$。\n  - 感热通量 $Q_{s} = -12$ $\\mathrm{W\\,m^{-2}}$。\n  - 潜热通量 $Q_{l} = -130$ $\\mathrm{W\\,m^{-2}}$。\n  - 夹带速度 $w_e = 4\\times 10^{-5}$ $\\mathrm{m\\,s^{-1}}$。\n  - 混合层温度 $T_m = 300.15$ $\\mathrm{K}$。\n  - 亚混合层温度 $T_b = 298.15$ $\\mathrm{K}$。\n\n每个案例所需的计算：\n- 使用 Beer-Lambert 衰减（在深度 $h$ 内）和表面反照率 $r$，计算有云和晴空条件下混合层内吸收的短波辐射，分别为 $Q_{sw}^{ML}(\\mathrm{cloudy})$ 和 $Q_{sw}^{ML}(\\mathrm{clear})$。\n- 计算净非短波表面热通量 $Q_{ns} = Q_{lw} + Q_{s} + Q_{l}$。\n- 计算有云条件下由表面通量引起的混合层温度倾向 $\\dot{T}_{\\mathrm{surf}}(\\mathrm{cloudy})$。\n- 计算夹带温度倾向 $\\dot{T}_{\\mathrm{ent}}$。\n- 计算总倾向 $\\dot{T}_{\\mathrm{tot}} = \\dot{T}_{\\mathrm{surf}}(\\mathrm{cloudy}) + \\dot{T}_{\\mathrm{ent}}$。\n- 计算云短波衰减对倾向的贡献 $\\dot{T}_{\\mathrm{cloud}} = \\left(Q_{sw}^{ML}(\\mathrm{cloudy}) - Q_{sw}^{ML}(\\mathrm{clear})\\right)/(\\rho c_p h)$。\n- 将所有倾向转换为 $\\mathrm{K\\,day^{-1}}$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，包含九个结果，顺序如下：\n  - $[\\dot{T}_{\\mathrm{tot}}^{A}, \\dot{T}_{\\mathrm{cloud}}^{A}, \\dot{T}_{\\mathrm{ent}}^{A}, \\dot{T}_{\\mathrm{tot}}^{B}, \\dot{T}_{\\mathrm{cloud}}^{B}, \\dot{T}_{\\mathrm{ent}}^{B}, \\dot{T}_{\\mathrm{tot}}^{C}, \\dot{T}_{\\mathrm{cloud}}^{C}, \\dot{T}_{\\mathrm{ent}}^{C}]$，\n  其中上标 $A$、$B$、$C$ 标识不同的案例。每个值必须四舍五入到小数点后 $5$ 位。例如，一个有效的输出格式是 $[0.12345,-0.23456,-0.34567,0.00000,-0.11111,-0.22222,-1.00000,-0.33333,-0.44444]$。",
            "solution": "我们从垂直均匀的海洋混合层中的热量守恒开始。单位面积混合层的热含量为 $\\rho c_p h T_m$，其中 $\\rho$ 是海水密度，$c_p$ 是定压比热容，$h$ 是混合层深度，$T_m$ 是混合层温度。假设在所关注的诊断尺度上水平平流可以忽略不计，混合层的能量守恒可以表述为\n$$\n\\frac{d}{dt}\\left(\\rho c_p h T_m\\right) \\;=\\; Q_{\\mathrm{net},\\mathrm{surf}}^{ML} \\;+\\; Q_{\\mathrm{ent}},\n$$\n其中 $Q_{\\mathrm{net},\\mathrm{surf}}^{ML}$ 是沉积在混合层内的来自表面的净非绝热热输入，$Q_{\\mathrm{ent}}$ 是由于夹带而穿过混合层底部的热通量。除以 $\\rho c_p h$ 得到混合层温度倾向，\n$$\n\\frac{dT_m}{dt} \\;=\\; \\frac{Q_{\\mathrm{net},\\mathrm{surf}}^{ML}}{\\rho c_p h} \\;+\\; \\frac{Q_{\\mathrm{ent}}}{\\rho c_p h}.\n$$\n\n我们将表面贡献分解为在混合层内吸收的短波辐射和其余的非短波分量，\n$$\nQ_{\\mathrm{net},\\mathrm{surf}}^{ML} \\;=\\; Q_{sw}^{ML} \\;+\\; Q_{lw} \\;+\\; Q_{s} \\;+\\; Q_{l},\n$$\n其中 $Q_{lw}$ 是净长波通量，$Q_{s}$ 是感热通量，$Q_{l}$ 是潜热通量，均以向下进入海洋为正。\n\n混合层内的短波分量由 Beer-Lambert 衰减和表面反射决定。设 $Q_{sw,\\mathrm{sfc}}$ 为到达海洋表面的下行短波辐射。一部分（比例为 $r$）被反射，水体内的垂直衰减遵循 $\\exp(-k_d z)$，其中 $k_d$ 是漫射衰减系数，$z$ 是深度。在区间 $z\\in[0,h]$ 内吸收的未被反射的表面短波辐射的比例是 $1 - \\exp(-k_d h)$。因此，混合层内吸收的短波辐射为\n$$\nQ_{sw}^{ML} \\;=\\; (1 - r)\\,Q_{sw,\\mathrm{sfc}}\\;\\left(1 - e^{-k_d h}\\right).\n$$\n云减少了表面短波辐射。一个标准的诊断参数化方案是\n$$\nQ_{sw,\\mathrm{sfc}} \\;=\\; (1 - \\gamma C)\\,Q_{sw,\\mathrm{clear}},\n$$\n其中 $Q_{sw,\\mathrm{clear}}$ 是晴空（无云）时表面的下行短波辐射，$C$ 是介于0和1之间的小数形式的云量，$\\gamma$ 是一个效率参数，表示单位云量的有效衰减。在此参数化方案下，有云和晴空条件下混合层内吸收的短波辐射分别为，\n$$\nQ_{sw}^{ML}(\\mathrm{cloudy}) \\;=\\; (1 - r)\\,(1 - \\gamma C)\\,Q_{sw,\\mathrm{clear}}\\;\\left(1 - e^{-k_d h}\\right),\n$$\n$$\nQ_{sw}^{ML}(\\mathrm{clear}) \\;=\\; (1 - r)\\,Q_{sw,\\mathrm{clear}}\\;\\left(1 - e^{-k_d h}\\right).\n$$\n它们的差值分离出了云对混合层短波加热的影响，\n$$\n\\Delta Q_{sw}^{ML} \\;\\equiv\\; Q_{sw}^{ML}(\\mathrm{cloudy}) - Q_{sw}^{ML}(\\mathrm{clear}) \\;=\\; -\\gamma C\\,(1 - r)\\,Q_{sw,\\mathrm{clear}}\\;\\left(1 - e^{-k_d h}\\right).\n$$\n由云衰减对混合层温度倾向的相应贡献是\n$$\n\\dot{T}_{\\mathrm{cloud}} \\;=\\; \\frac{\\Delta Q_{sw}^{ML}}{\\rho c_p h}.\n$$\n\n夹带项表示混合层以速度 $w_e$ 加深时，通过其底部的交换。温度为 $T_b$ 的水被夹带入温度为 $T_m$ 的混合层中，产生的倾向为\n$$\n\\dot{T}_{\\mathrm{ent}} \\;=\\; \\frac{w_e}{h}\\,(T_b - T_m).\n$$\n该表达式是通过注意到夹带以 $\\rho c_p w_e (T_b - T_m)$ 的速率改变混合层热含量，然后除以 $\\rho c_p h$ 将其转换为温度倾向而得到的。\n\n因此，包括有云条件下的表面非绝热通量和夹带在内的净混合层温度倾向为\n$$\n\\dot{T}_{\\mathrm{tot}} \\;=\\; \\frac{Q_{sw}^{ML}(\\mathrm{cloudy}) + Q_{lw} + Q_{s} + Q_{l}}{\\rho c_p h} \\;+\\; \\dot{T}_{\\mathrm{ent}}.\n$$\n上面计算的所有倾向单位均为 $\\mathrm{K\\,s^{-1}}$。要将结果表示为 $\\mathrm{K\\,day^{-1}}$，需将每项乘以 $86400$。\n\n程序的算法设计：\n- 对于每个案例，读取参数 $h$、$k_d$、$C$、$Q_{sw,\\mathrm{clear}}$、$Q_{lw}$、$Q_{s}$、$Q_{l}$、$w_e$、$T_m$、$T_b$ 以及常量 $\\rho$、$c_p$、$r$、$\\gamma$。\n- 计算吸收因子 $f_{\\mathrm{abs}} = (1 - r)\\left(1 - e^{-k_d h}\\right)$。\n- 计算 $Q_{sw}^{ML}(\\mathrm{cloudy}) = (1 - \\gamma C)\\,Q_{sw,\\mathrm{clear}}\\,f_{\\mathrm{abs}}$ 和 $Q_{sw}^{ML}(\\mathrm{clear}) = Q_{sw,\\mathrm{clear}}\\,f_{\\mathrm{abs}}$。\n- 计算非短波净通量 $Q_{ns} = Q_{lw} + Q_{s} + Q_{l}$。\n- 计算 $\\dot{T}_{\\mathrm{surf}}(\\mathrm{cloudy}) = \\left(Q_{sw}^{ML}(\\mathrm{cloudy}) + Q_{ns}\\right)/(\\rho c_p h)$。\n- 计算 $\\dot{T}_{\\mathrm{ent}} = (w_e/h)\\,(T_b - T_m)$。\n- 计算 $\\dot{T}_{\\mathrm{tot}} = \\dot{T}_{\\mathrm{surf}}(\\mathrm{cloudy}) + \\dot{T}_{\\mathrm{ent}}$。\n- 计算 $\\dot{T}_{\\mathrm{cloud}} = \\left(Q_{sw}^{ML}(\\mathrm{cloudy}) - Q_{sw}^{ML}(\\mathrm{clear})\\right)/(\\rho c_p h)$。\n- 将每个倾向乘以 $86400$ 转换为 $\\mathrm{K\\,day^{-1}}$，四舍五入到小数点后 $5$ 位，并按要求的顺序附加到输出中。\n\n科学真实性检查和边缘案例：\n- 确保 $h > 0$ 以避免除以零；所提供的测试集满足此条件。\n- 确保 $C \\in [0,1]$；所提供的测试集满足此条件，包括边缘情况 $C = 1$。\n- $(T_b - T_m)$ 的符号决定了夹带是冷却（负值）还是增温（正值）；在六月的孟加拉湾，层结通常导致 $T_b  T_m$，从而产生冷却，这在测试案例中得到了反映。\n\n最终输出是包含九个值 $[\\dot{T}_{\\mathrm{tot}}^{A}, \\dot{T}_{\\mathrm{cloud}}^{A}, \\dot{T}_{\\mathrm{ent}}^{A}, \\dot{T}_{\\mathrm{tot}}^{B}, \\dot{T}_{\\mathrm{cloud}}^{B}, \\dot{T}_{\\mathrm{ent}}^{B}, \\dot{T}_{\\mathrm{tot}}^{C}, \\dot{T}_{\\mathrm{cloud}}^{C}, \\dot{T}_{\\mathrm{ent}}^{C}]$ 的单行文本，每个值单位为 $\\mathrm{K\\,day^{-1}}$，并四舍五入到小数点后 $5$ 位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef mixed_layer_tendencies(case, rho, cp, r, gamma):\n    \"\"\"\n    Compute:\n    - total mixed-layer temperature tendency (K/day)\n    - cloud shortwave attenuation contribution to tendency (K/day)\n    - entrainment temperature tendency (K/day)\n    for a single test case.\n    \"\"\"\n    h = case[\"h\"]  # m\n    kd = case[\"kd\"]  # 1/m\n    C = case[\"C\"]  # unitless\n    Qsw_clear = case[\"Qsw_clear\"]  # W/m^2\n    Qlw = case[\"Qlw\"]  # W/m^2\n    Qs = case[\"Qs\"]  # W/m^2\n    Ql = case[\"Ql\"]  # W/m^2\n    we = case[\"we\"]  # m/s\n    Tm = case[\"Tm\"]  # K\n    Tb = case[\"Tb\"]  # K\n\n    # Absorption factor within the mixed layer\n    f_abs = (1.0 - r) * (1.0 - np.exp(-kd * h))\n\n    # Shortwave absorbed in the mixed layer under cloudy and clear conditions\n    Qsw_ML_cloudy = (1.0 - gamma * C) * Qsw_clear * f_abs\n    Qsw_ML_clear = Qsw_clear * f_abs\n\n    # Non-shortwave net surface flux\n    Qns = Qlw + Qs + Ql\n\n    # Surface-induced tendency under clouds (K/s)\n    dTdt_surf_cloudy = (Qsw_ML_cloudy + Qns) / (rho * cp * h)\n\n    # Entrainment tendency (K/s)\n    dTdt_ent = (we / h) * (Tb - Tm)\n\n    # Total tendency (K/s)\n    dTdt_tot = dTdt_surf_cloudy + dTdt_ent\n\n    # Cloud attenuation contribution (K/s)\n    dTdt_cloud = (Qsw_ML_cloudy - Qsw_ML_clear) / (rho * cp * h)\n\n    # Convert to K/day\n    sec_per_day = 86400.0\n    return (dTdt_tot * sec_per_day, dTdt_cloud * sec_per_day, dTdt_ent * sec_per_day)\n\ndef solve():\n    # Constants\n    rho = 1025.0       # kg/m^3\n    cp = 3985.0        # J/(kg K)\n    r = 0.06           # ocean albedo (unitless)\n    gamma = 0.62       # cloud attenuation efficiency (unitless)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Active monsoon\n        {\n            \"h\": 20.0,\n            \"kd\": 0.06,\n            \"C\": 0.85,\n            \"Qsw_clear\": 260.0,\n            \"Qlw\": -50.0,\n            \"Qs\": -10.0,\n            \"Ql\": -120.0,\n            \"we\": 5e-5,\n            \"Tm\": 300.65,\n            \"Tb\": 299.15,\n        },\n        # Case B: Break monsoon\n        {\n            \"h\": 25.0,\n            \"kd\": 0.06,\n            \"C\": 0.20,\n            \"Qsw_clear\": 260.0,\n            \"Qlw\": -45.0,\n            \"Qs\": -8.0,\n            \"Ql\": -100.0,\n            \"we\": 1e-5,\n            \"Tm\": 301.15,\n            \"Tb\": 300.45,\n        },\n        # Case C: Edge case, fully overcast, shallow ML\n        {\n            \"h\": 10.0,\n            \"kd\": 0.06,\n            \"C\": 1.00,\n            \"Qsw_clear\": 240.0,\n            \"Qlw\": -60.0,\n            \"Qs\": -12.0,\n            \"Ql\": -130.0,\n            \"we\": 4e-5,\n            \"Tm\": 300.15,\n            \"Tb\": 298.15,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        dT_tot_day, dT_cloud_day, dT_ent_day = mixed_layer_tendencies(case, rho, cp, r, gamma)\n        # Round to 5 decimal places as required\n        results.extend([\n            round(dT_tot_day, 5),\n            round(dT_cloud_day, 5),\n            round(dT_ent_day, 5),\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}