{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will construct a simplified but powerful model that connects tropospheric convective activity to the generation of the Quasi-Biennial Oscillation (QBO) in the stratosphere. This exercise illuminates the core physical mechanism of wave-mean flow interaction by showing how different vertical profiles of heating—a proxy for tropical convection—excite a specific spectrum of equatorial waves. By tracking how these waves propagate and deposit their momentum, you will build a foundational understanding of how the QBO is driven from below and how its amplitude is sensitive to the nature of the forcing .",
            "id": "4079911",
            "problem": "Consider a simplified, scientifically grounded linear wave–mean flow interaction framework to represent how equatorial wave forcing from tropospheric convection impacts the Quasi-Biennial Oscillation (QBO) amplitude in the stratosphere. The goal is to quantify how changing the depth of tropospheric convective heating shifts the vertical wavenumber spectrum of equatorial waves and alters the resulting QBO amplitude.\n\nAssume the following physically motivated components:\n\n1. Tropospheric heating and vertical modes:\n   - The troposphere has a top at height $H_t$.\n   - The convective heating profile is $Q(z) = Q_0$ for $0 \\le z \\le H$ and $Q(z) = 0$ for $H < z \\le H_t$, where $H$ is the heating depth and $Q_0$ is a constant amplitude.\n   - The vertical modes in the troposphere are represented by eigenfunctions $\\phi_n(z) = \\sin\\left(\\frac{n \\pi z}{H_t}\\right)$ for integers $n \\ge 1$.\n   - The modal projection coefficients $a_n$ of the heating onto the eigenfunctions are given by the fundamental definition\n     $$a_n = \\int_0^{H_t} Q(z)\\,\\phi_n(z)\\,dz = Q_0 \\int_0^{H} \\sin\\left(\\frac{n \\pi z}{H_t}\\right)\\,dz = Q_0 \\frac{H_t}{n \\pi}\\left[1 - \\cos\\left(\\frac{n \\pi H}{H_t}\\right)\\right].$$\n\n2. Vertical modal phase speeds and equivalent depths:\n   - For a stably stratified troposphere with approximately constant buoyancy frequency $N_t$, the baroclinic vertical mode phase speed is approximated by\n     $$c_n = \\frac{N_t H_t}{n \\pi}.$$\n   - The equivalent depth for mode $n$ is $h_n = \\frac{c_n^2}{g}$, where $g$ is gravitational acceleration.\n   - Consider two wave families:\n     - Equatorial Kelvin waves (eastward), with zonal phase speed $c_K = c_n$.\n     - Mixed Rossby–Gravity waves (westward), with zonal phase speed $c_W = \\gamma c_n$ for a fixed $0 < \\gamma < 1$.\n\n3. Stratospheric vertical wavenumber and propagation:\n   - In a hydrostatic, isothermal stratosphere of scale height $H_s$ and buoyancy frequency $N_s$, neglecting horizontal wavenumber effects, the vertical wavenumber for a vertically propagating mode is approximated by\n     $$m_{s,n}^2 = \\frac{N_s^2}{c_s^2} - \\frac{1}{4 H_s^2},$$\n     where $c_s$ is the appropriate zonal phase speed for the wave family ($c_K$ or $c_W$). If $m_{s,n}^2 \\le 0$, the mode is evanescent and does not contribute to stratospheric momentum flux deposition.\n\n4. Wave momentum flux and mean-flow forcing:\n   - The vertical momentum flux at the tropopause for family $s \\in \\{K,W\\}$ and mode $n$ is assumed proportional to the modal energy flux,\n     $$F_{s0,n} \\propto a_n^2 c_s.$$\n     Use a relative scaling factor $\\eta$ to represent the relative strength of Mixed Rossby–Gravity waves versus Kelvin waves, i.e., $F_{W0,n} = \\eta\\, a_n^2 c_W$ and $F_{K0,n} = a_n^2 c_K$.\n   - Vertical dissipation leads to exponential decay of the flux with height $z$, represented by\n     $$F_{s,n}(z) = F_{s0,n} \\exp(-\\lambda_{s,n} z), \\quad \\lambda_{s,n} = \\mu\\, m_{s,n},$$\n     with a non-dimensional constant $\\mu > 0$.\n   - The wave drag felt by the zonal mean flow at height $z$ is given by the divergence of the momentum flux,\n     $$D_{s,n}(z) = -\\frac{d F_{s,n}}{dz} = \\lambda_{s,n} F_{s0,n} \\exp(-\\lambda_{s,n} z).$$\n     The sign of $D_{s,n}$ reflects the direction of the momentum deposition; take Kelvin wave drag as eastward (positive) and Mixed Rossby–Gravity wave drag as westward (negative).\n\n5. QBO amplitude under Rayleigh drag:\n   - Let the zonal mean flow at height $z$ be subject to linear Rayleigh damping with rate $r$. In a steady oscillatory balance between alternating eastward and westward wave forcing phases, approximate the amplitude at $z = z^\\*$ by\n     $$U_{\\mathrm{raw}}(z^\\*) = \\frac{1}{r}\\left|\\sum_{n=1}^{N_{\\max}} \\left(D_{K,n}(z^\\*) + D_{W,n}(z^\\*)\\right)\\right|.$$\n   - To express results in physical units, calibrate an overall scaling multiplier $S$ by setting a reference heating depth $H_{\\mathrm{ref}}$ and a desired reference amplitude $U_{\\mathrm{ref}}$ at $z^\\*$, such that\n     $$S = \\frac{U_{\\mathrm{ref}}}{U_{\\mathrm{raw}}(H_{\\mathrm{ref}}, z^\\*)}, \\quad U(z^\\*) = S \\cdot U_{\\mathrm{raw}}(H, z^\\*).$$\n\n6. Vertical wavenumber spectrum characterization:\n   - Define a combined contribution weight per mode at $z^\\*$ by\n     $$W_n(z^\\*) = \\left|D_{K,n}(z^\\*)\\right| + \\left|D_{W,n}(z^\\*)\\right|.$$\n   - For each mode $n$, define an effective vertical wavenumber $m_{\\mathrm{eff},n}$ as the weighted average across wave families,\n     $$m_{\\mathrm{eff},n} = \\frac{\\left|D_{K,n}(z^\\*)\\right|\\, m_{K,n} + \\left|D_{W,n}(z^\\*)\\right|\\, m_{W,n}}{W_n(z^\\*)},$$\n     with the convention that if $W_n(z^\\*) = 0$ the mode is omitted from consideration.\n   - Let $m_{\\mathrm{peak}}$ be the $m_{\\mathrm{eff},n}$ for the mode $n$ that maximizes $W_n(z^\\*)$. Report the corresponding dominant vertical wavelength\n     $$\\lambda_{z,\\mathrm{peak}} = \\frac{2 \\pi}{m_{\\mathrm{peak}}},$$\n     expressed in kilometers.\n\nConstants and parameters:\n- Gravitational acceleration: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$.\n- Tropospheric top height: $H_t = 16{,}000\\,\\mathrm{m}$.\n- Tropospheric buoyancy frequency: $N_t = 0.011\\,\\mathrm{s^{-1}}$.\n- Stratospheric buoyancy frequency: $N_s = 0.020\\,\\mathrm{s^{-1}}$.\n- Stratospheric scale height: $H_s = 7{,}000\\,\\mathrm{m}$.\n- Relative speed factor for Mixed Rossby–Gravity waves: $\\gamma = 0.6$.\n- Relative flux scaling for Mixed Rossby–Gravity waves: $\\eta = 0.8$.\n- Dissipation constant: $\\mu = 0.25$.\n- Rayleigh damping rate: $r = 1/(30 \\times 86400)\\,\\mathrm{s^{-1}}$.\n- Heating amplitude: $Q_0 = 1$ (non-dimensional; absorbed into calibration).\n- Number of vertical modes included: $N_{\\max} = 10$.\n- Reference level: $z^\\* = 25{,}000\\,\\mathrm{m}$.\n- Reference heating depth and amplitude for calibration: $H_{\\mathrm{ref}} = 12{,}000\\,\\mathrm{m}$ and $U_{\\mathrm{ref}} = 20\\,\\mathrm{m/s}$.\n\nTasks:\n- Implement the above formulation to compute, for each test case heating depth $H$, the dominant vertical wavelength $\\lambda_{z,\\mathrm{peak}}$ in kilometers and the calibrated QBO amplitude $U(z^\\*)$ in meters per second.\n- If for a test case all contributing modes are evanescent or negligible so that no vertical propagation occurs, define $\\lambda_{z,\\mathrm{peak}} = 0$ and $U(z^\\*) = 0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must alternate the dominant vertical wavelength in kilometers and the calibrated QBO amplitude in meters per second for each test case, in the order given above. For example, the output format is\n  $$[\\lambda_{z,\\mathrm{peak}}(H_1), U(H_1), \\lambda_{z,\\mathrm{peak}}(H_2), U(H_2), \\dots].$$\n- Express $\\lambda_{z,\\mathrm{peak}}$ in $\\mathrm{km}$ to three decimal places and $U(z^\\*)$ in $\\mathrm{m/s}$ to three decimal places.",
            "solution": "The problem requires the development of a simplified, one-dimensional model to investigate the relationship between the depth of tropospheric convective heating and the properties of the stratospheric Quasi-Biennial Oscillation (QBO). Specifically, we must calculate the QBO amplitude and the dominant vertical wavelength of the wave forcing for a given set of heating depths. The model is based on linear wave theory and established principles of wave–mean flow interaction.\n\nThe validation process confirms that the problem is scientifically grounded, well-posed, and objective. It provides a complete set of equations, parameters, and test cases. A minor ambiguity exists in the definition of the vertical coordinate for wave dissipation. The problem states the decay term as $\\exp(-\\lambda_{s,n} z)$, where $z$ is height. A more standard physical formulation would use height above the tropopause, $z-H_t$. However, to adhere strictly to the provided formulation, we will interpret $z$ as the absolute height, $z = z^\\*$, as given in the problem statement.\n\nThe solution is constructed by implementing the following sequence of calculations for each specified heating depth $H$.\n\n1.  **Modal Projection of Heating ($a_n$)**:\n    The tropospheric heating profile $Q(z)$ is projected onto the vertical modes $\\phi_n(z) = \\sin\\left(\\frac{n \\pi z}{H_t}\\right)$. The projection coefficients $a_n$ represent the strength of the forcing for each vertical mode $n$. They are given by:\n    $$a_n = Q_0 \\frac{H_t}{n \\pi}\\left[1 - \\cos\\left(\\frac{n \\pi H}{H_t}\\right)\\right]$$\n    We will compute this for each mode from $n = 1$ to $N_{\\max} = 10$, using the given non-dimensional heating amplitude $Q_0 = 1$ and tropospheric top height $H_t = 16{,}000\\,\\mathrm{m}$.\n\n2.  **Wave Phase Speeds ($c_{s,n}$)**:\n    Each vertical mode $n$ is associated with a vertical mode phase speed $c_n$ in the troposphere. This maps to the horizontal zonal phase speeds of the equatorial waves launched into the stratosphere.\n    $$c_n = \\frac{N_t H_t}{n \\pi}$$\n    where $N_t = 0.011\\,\\mathrm{s^{-1}}$ is the tropospheric buoyancy frequency. The two wave families considered are:\n    -   Kelvin waves (eastward): $c_{K,n} = c_n$.\n    -   Mixed Rossby–Gravity (MRG) waves (westward): $c_{W,n} = \\gamma c_n$, with $\\gamma = 0.6$.\n\n3.  **Stratospheric Vertical Wavenumber ($m_{s,n}$)**:\n    For a wave to propagate vertically into the stratosphere, its vertical wavenumber must be real. The squared vertical wavenumber $m_{s,n}^2$ is determined by the wave's zonal phase speed $c_s$ and the stratospheric properties (buoyancy frequency $N_s = 0.020\\,\\mathrm{s^{-1}}$ and scale height $H_s = 7{,}000\\,\\mathrm{m}$).\n    $$m_{s,n}^2 = \\frac{N_s^2}{c_s^2} - \\frac{1}{4 H_s^2}$$\n    If $m_{s,n}^2 \\le 0$, the mode is evanescent and does not propagate, hence it does not contribute to momentum deposition in the stratosphere. For propagating modes ($m_{s,n}^2 > 0$), the vertical wavenumber is $m_{s,n} = \\sqrt{m_{s,n}^2}$.\n\n4.  **Wave-Driven Mean-Flow Forcing (Drag, $D_{s,n}$)**:\n    The momentum carried by the waves is deposited in the stratosphere, driving the mean flow. The vertical momentum flux at the tropopause, $F_{s0,n}$, is proportional to the modal energy.\n    $$F_{K0,n} = a_n^2 c_{K,n}$$\n    $$F_{W0,n} = \\eta\\, a_n^2 c_{W,n}$$\n    where $\\eta = 0.8$ accounts for the relative strength of MRG wave forcing. This flux decays exponentially with height due to dissipation. The dissipation rate is $\\lambda_{s,n} = \\mu\\, m_{s,n}$ with $\\mu = 0.25$. The flux at height $z$ is $F_{s,n}(z) = F_{s0,n} \\exp(-\\lambda_{s,n} z)$. The drag (momentum deposition per unit height) at the reference level $z^\\* = 25{,}000\\,\\mathrm{m}$ is the vertical divergence of the flux:\n    $$D_{s,n}(z^\\*) = -\\frac{d F_{s,n}}{dz}\\bigg|_{z=z^\\*} = \\lambda_{s,n} F_{s0,n} \\exp(-\\lambda_{s,n} z^\\*)$$\n    By convention, Kelvin waves deposit eastward (positive) momentum, and MRG waves deposit westward (negative) momentum. We apply this by taking $D_{K,n}$ as positive and defining the contribution from MRG waves as $-D_{W,n}$. For evanescent modes, $m_{s,n} = 0$, so $\\lambda_{s,n} = 0$, and the drag $D_{s,n}(z^\\*) = 0$.\n\n5.  **QBO Amplitude ($U(z^\\*)$)**:\n    The amplitude of the QBO is estimated by assuming a balance between the net wave forcing and a linear Rayleigh drag with rate $r = 1/(30 \\times 86400)\\,\\mathrm{s^{-1}}$. The raw amplitude is:\n    $$U_{\\mathrm{raw}}(H, z^\\*) = \\frac{1}{r}\\left|\\sum_{n=1}^{N_{\\max}} \\left(D_{K,n}(z^\\*) - D_{W,n}(z^\\*)\\right)\\right|$$\n    The model is calibrated using a reference case ($H_{\\mathrm{ref}} = 12{,}000\\,\\mathrm{m}$, $U_{\\mathrm{ref}} = 20\\,\\mathrm{m/s}$). The scaling factor is $S = U_{\\mathrm{ref}} / U_{\\mathrm{raw}}(H_{\\mathrm{ref}}, z^\\*)$. The calibrated amplitude for any heating depth $H$ is then:\n    $$U(z^\\*) = S \\cdot U_{\\mathrm{raw}}(H, z^\\*)$$\n\n6.  **Dominant Vertical Wavelength ($\\lambda_{z,\\mathrm{peak}}$)**:\n    To characterize the vertical scale of the wave forcing, we determine the dominant vertical wavelength. First, we find the contribution weight of each mode at $z^\\*$:\n    $$W_n(z^\\*) = |D_{K,n}(z^\\*)| + |D_{W,n}(z^\\*)| = D_{K,n}(z^\\*) + D_{W,n}(z^\\*)$$\n    The mode $n_{\\mathrm{peak}}$ is the one that maximizes $W_n(z^\\*)$. The effective vertical wavenumber for this peak mode is a weighted average of the Kelvin and MRG wavenumbers:\n    $$m_{\\mathrm{peak}} = m_{\\mathrm{eff},n_{\\mathrm{peak}}} = \\frac{D_{K,n_{\\mathrm{peak}}}(z^\\*) m_{K,n_{\\mathrm{peak}}} + D_{W,n_{\\mathrm{peak}}}(z^\\*) m_{W,n_{\\mathrm{peak}}}}{W_{n_{\\mathrm{peak}}}(z^\\*)}$$\n    The dominant vertical wavelength is then $\\lambda_{z,\\mathrm{peak}} = 2\\pi / m_{\\mathrm{peak}}$. If all modes are evanescent or their contribution is negligible, we set $\\lambda_{z,\\mathrm{peak}} = 0$ and $U(z^\\*) = 0$.\n\nThe computational procedure involves first calculating $U_{\\mathrm{raw}}$ for the reference case $H_{\\mathrm{ref}}$ to find the scaling factor $S$. Then, for each heating depth $H$ in the test suite, we compute $U_{\\mathrm{raw}}(H, z^\\*)$ and $\\lambda_{z,\\mathrm{peak}}(H, z^\\*)$, and finally apply the scaling $S$ to obtain the calibrated amplitude $U(H, z^\\*)$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating QBO amplitude and dominant vertical wavelength\n    based on a simplified wave-mean flow interaction model.\n    \"\"\"\n\n    # Constants and parameters from the problem statement\n    G = 9.81  # Gravitational acceleration, m/s^2\n    H_T = 16000.0  # Tropospheric top height, m\n    N_T = 0.011  # Tropospheric buoyancy frequency, s^-1\n    N_S = 0.020  # Stratospheric buoyancy frequency, s^-1\n    H_S = 7000.0  # Stratospheric scale height, m\n    GAMMA = 0.6  # Relative speed factor for MRG waves\n    ETA = 0.8  # Relative flux scaling for MRG waves\n    MU = 0.25  # Dissipation constant\n    R_DAMP = 1.0 / (30.0 * 86400.0)  # Rayleigh damping rate, s^-1\n    Q0 = 1.0  # Heating amplitude (non-dimensional)\n    N_MAX = 10  # Number of vertical modes\n    Z_STAR = 25000.0  # Reference level, m\n    H_REF = 12000.0  # Reference heating depth for calibration, m\n    U_REF = 20.0  # Reference QBO amplitude for calibration, m/s\n\n    # Test suite of heating depths\n    test_cases_H = [1000.0, 4000.0, 8000.0, 12000.0, 16000.0]\n\n    def compute_model_outputs(H):\n        \"\"\"\n        Computes the raw QBO amplitude and dominant vertical wavelength for a given heating depth H.\n        \"\"\"\n        n = np.arange(1, N_MAX + 1)\n        \n        # 1. Modal projection coefficients (a_n)\n        cos_term = np.cos(n * np.pi * H / H_T)\n        a_n = Q0 * (H_T / (n * np.pi)) * (1.0 - cos_term)\n\n        # 2. Wave phase speeds (c_n, c_K, c_W)\n        c_n = (N_T * H_T) / (n * np.pi)\n        c_k = c_n\n        c_w = GAMMA * c_n\n        \n        # 3. Stratospheric vertical wavenumbers (m_s,n)\n        m_sq_k = (N_S**2 / c_k**2) - (1.0 / (4.0 * H_S**2))\n        m_sq_w = (N_S**2 / c_w**2) - (1.0 / (4.0 * H_S**2))\n        \n        # Set m to 0 for evanescent modes (m_sq <= 0)\n        m_k = np.sqrt(np.maximum(0, m_sq_k))\n        m_w = np.sqrt(np.maximum(0, m_sq_w))\n\n        # 4. Wave drag (D_s,n)\n        # Tropopause flux\n        F0_k = a_n**2 * c_k\n        F0_w = ETA * a_n**2 * c_w\n        \n        # Dissipation rate\n        lambda_k = MU * m_k\n        lambda_w = MU * m_w\n\n        # Drag magnitudes\n        # Note: If m=0, then lambda=0, and D=0 automatically.\n        D_k = lambda_k * F0_k * np.exp(-lambda_k * Z_STAR)\n        D_w = lambda_w * F0_w * np.exp(-lambda_w * Z_STAR)\n        \n        # 5. Raw QBO amplitude (U_raw)\n        # Total drag sum: D_k is positive (eastward), D_w is negative (westward)\n        total_drag = np.sum(D_k - D_w)\n        U_raw = (1.0 / R_DAMP) * np.abs(total_drag)\n        \n        # 6. Dominant vertical wavelength (lambda_z,peak)\n        # Contribution weights\n        W_n = D_k + D_w # Since D_k and D_w are magnitudes of drag contributions\n        \n        if np.sum(W_n) == 0:\n            lambda_z_peak_km = 0.0\n        else:\n            n_peak_idx = np.argmax(W_n)\n            D_k_peak = D_k[n_peak_idx]\n            D_w_peak = D_w[n_peak_idx]\n            m_k_peak = m_k[n_peak_idx]\n            m_w_peak = m_w[n_peak_idx]\n            W_n_peak = W_n[n_peak_idx]\n            \n            # Effective vertical wavenumber for the peak mode\n            if W_n_peak > 0:\n                m_eff_peak = (D_k_peak * m_k_peak + D_w_peak * m_w_peak) / W_n_peak\n            else: # Should not happen if sum(W_n) > 0, but for safety\n                m_eff_peak = 0\n            \n            if m_eff_peak > 0:\n                lambda_z_peak = (2.0 * np.pi) / m_eff_peak\n                lambda_z_peak_km = lambda_z_peak / 1000.0  # Convert to km\n            else:\n                lambda_z_peak_km = 0.0\n\n        return U_raw, lambda_z_peak_km\n\n    # Calibration step\n    U_raw_ref, _ = compute_model_outputs(H_REF)\n    if U_raw_ref > 0:\n        S = U_REF / U_raw_ref\n    else:\n        # Handles case where reference calculation yields zero amplitude\n        S = 0.0 \n\n    results = []\n    for H in test_cases_H:\n        U_raw, lambda_z_peak_km = compute_model_outputs(H)\n        \n        # Apply calibration\n        U_calibrated = S * U_raw\n        \n        # Handle the edge case for both outputs\n        if U_calibrated == 0:\n            lambda_z_peak_km = 0.0\n\n        results.append(f\"{lambda_z_peak_km:.3f}\")\n        results.append(f\"{U_calibrated:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having modeled the physical system, we now confront the practical challenges of representing it within a numerical model. This practice focuses on a critical aspect of model fidelity: the impact of vertical grid resolution on the calculation of wave forcing, quantified by the Eliassen-Palm (EP) flux divergence. By comparing a numerical finite-difference approximation against a known analytic solution, you will gain direct, quantitative insight into concepts like numerical accuracy and truncation error, which are fundamental to developing and interpreting complex climate models .",
            "id": "4079907",
            "problem": "Consider a vertically varying, zonal-mean Eliassen-Palm (EP) flux quantity relevant to Quasi-Biennial Oscillation (QBO) representation and Sudden Stratospheric Warmings (SSW) in numerical weather prediction and climate modeling. The target diagnostic is the vertical EP flux divergence appearing in the transformed Eulerian mean zonal-mean acceleration, written here as the negative vertical derivative of the density-weighted momentum flux, $-\\partial_z\\!\\left(\\rho_0 \\,\\overline{u'w'}\\right)$, where $\\rho_0$ is the background density and $\\overline{u'w'}$ is the zonal-mean eddy momentum flux.\n\nYou will work with an idealized, analytic vertical profile constructed as follows over a domain $z \\in [0,H]$ with $H = 40000\\,\\mathrm{m}$. The background density is $\\rho_0(z) = \\rho_s \\exp(-z/H_s)$ with $\\rho_s = 1.2\\,\\mathrm{kg\\,m^{-3}}$ and $H_s = 7000\\,\\mathrm{m}$. The eddy momentum flux is given by the sum of two Gaussian components that mimic vertically localized gravity wave momentum flux deposition within the equatorial stratosphere: \n$$\\overline{u'w'}(z) = A_1 \\exp\\!\\left(-\\frac{(z-z_1)^2}{2\\sigma_1^2}\\right) - A_2 \\exp\\!\\left(-\\frac{(z-z_2)^2}{2\\sigma_2^2}\\right).$$\nDefine $F(z) = \\rho_0(z)\\,\\overline{u'w'}(z)$ and the true diagnostic $g(z) = -\\frac{dF}{dz}$. The sign choice is consistent with the conventional wave-mean flow interaction forcing term.\n\nYour task is to evaluate the sensitivity of the diagnosed $g(z)$ to vertical resolution by:\n- Constructing a high-resolution reference field $F(z)$ on a uniform grid with spacing $\\Delta z_{\\mathrm{hr}} = 100\\,\\mathrm{m}$ over $[0,H]$,\n- Coarsening $F(z)$ to a set of coarse grids with spacing $\\Delta z$ by computing layer-mean values of $F(z)$ within each coarse layer centered at coarse midpoints,\n- Applying centered differencing to the coarsened profile to approximate $g(z)$ at interior coarse midpoints,\n- Quantifying the truncation error of the centered difference operator via the leading-order Taylor series term for the derivative approximation, using the analytic third derivative of $F(z)$ evaluated at the coarse midpoints,\n- Reporting numerical errors against the analytic truth.\n\nFundamental base assumptions and facts to use:\n- The density profile $\\rho_0(z)$ is exponential with constant scale height, so its derivatives are analytic.\n- Each Gaussian component of $\\overline{u'w'}(z)$ has analytic derivatives of all orders.\n- A centered difference approximation of a first derivative for a sufficiently smooth function admits a second-order truncation error that can be obtained by a Taylor series expansion about the evaluation point.\n- Layer-mean coarsening is performed by averaging $F(z)$ over each coarse layer of thickness $\\Delta z$ centered at a coarse midpoint.\n\nImplement the following steps in a program:\n1. Generate the high-resolution grid $z_k = k\\,\\Delta z_{\\mathrm{hr}}$ for $k=0,1,\\dots,\\lfloor H/\\Delta z_{\\mathrm{hr}} \\rfloor$.\n2. Evaluate $F(z)$ analytically on the high-resolution grid.\n3. For a specified coarse spacing $\\Delta z$, construct coarse midpoints $z_i^{(c)} = \\Delta z/2 + i\\,\\Delta z$ for integer $i$ such that $z_i^{(c)} \\in [\\Delta z/2, H - \\Delta z/2]$, and compute the layer-mean $F_i^{(c)}$ by averaging $F(z)$ over the interval $[z_i^{(c)}-\\Delta z/2, z_i^{(c)}+\\Delta z/2]$ using the high-resolution samples.\n4. Compute the centered-difference approximation of $g(z)$ at interior coarse midpoints $z_i^{(c)}$ for $i=1,\\dots,N_c-2$ as \n$$g_{\\mathrm{cd}}(z_i^{(c)}) = -\\frac{F^{(c)}_{i+1} - F^{(c)}_{i-1}}{2\\,\\Delta z}.$$\n5. Evaluate the analytic truth $g_{\\mathrm{true}}(z_i^{(c)})$ by differentiating $F(z)$ analytically and evaluating at the same interior coarse midpoints.\n6. Evaluate the leading-order truncation term from the Taylor series expansion for the centered difference derivative of $F(z)$ at $z_i^{(c)}$ using the analytic third derivative of $F(z)$ and the coarse spacing $\\Delta z$; use this to compute the predicted truncation contribution to the error in $g_{\\mathrm{cd}}$ at each interior coarse midpoint.\n7. For each coarse spacing and parameter set, compute and report two floats:\n   - The root-mean-square (RMS) of the absolute difference $\\left|g_{\\mathrm{cd}} - g_{\\mathrm{true}}\\right|$ over interior coarse midpoints,\n   - The RMS of the absolute value of the leading-order truncation term over interior coarse midpoints.\n\nAll quantities involving forces must be expressed in $\\mathrm{N\\,m^{-3}}$ and distances in $\\mathrm{m}$. Angles are not involved. Report each RMS as a float. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[\\mathrm{RMS}_{\\mathrm{true}}, \\mathrm{RMS}_{\\mathrm{trunc}}]$.\n\nTest suite. Use the following four test cases, each specified by the tuple $(\\Delta z, A_1, z_1, \\sigma_1, A_2, z_2, \\sigma_2)$:\n- Case $1$: $(1000,\\,0.12,\\,20000,\\,4000,\\,0.09,\\,28000,\\,5000)$.\n- Case $2$: $(2000,\\,0.10,\\,18000,\\,2500,\\,0.08,\\,25000,\\,2000)$.\n- Case $3$: $(5000,\\,0.11,\\,22000,\\,4000,\\,0.07,\\,30000,\\,3000)$.\n- Case $4$: $(8000,\\,0.10,\\,21000,\\,1500,\\,0.09,\\,27000,\\,1200)$.\n\nYour program must implement the above steps, compute the two RMS metrics per case over all interior coarse midpoints, and print a single line output of the form \n$[[r_1,t_1],[r_2,t_2],[r_3,t_3],[r_4,t_4]]$ where each $r_i$ and $t_i$ are floats in $\\mathrm{N\\,m^{-3}}$.",
            "solution": "The problem statement has been critically validated and found to be self-contained, scientifically sound, and well-posed. The task is to analyze the error of a numerical approximation for the vertical divergence of the Eliassen-Palm (EP) flux, a key diagnostic in atmospheric dynamics for understanding wave-mean flow interaction. The problem provides an idealized analytical model for the vertical profile of the density-weighted momentum flux, $F(z)$, and asks for a comparison between a numerical approximation of its negative derivative, $g(z) = -dF/dz$, and the analytical truth. The error analysis involves a centered finite difference scheme applied to a layer-averaged field, and the computation of a theoretical truncation error term.\n\nThe solution proceeds by implementing the steps outlined in the problem statement. First, we establish the analytical forms for the function $F(z)$ and its relevant derivatives. The function $F(z)$ is defined as the product of an exponential density profile, $\\rho_0(z) = \\rho_s \\exp(-z/H_s)$, and an eddy momentum flux profile, $\\overline{u'w'}(z)$, which is the sum of two Gaussians.\n$$F(z) = \\rho_0(z) \\, \\overline{u'w'}(z) = \\rho_s e^{-z/H_s} \\left( A_1 e^{-\\frac{(z-z_1)^2}{2\\sigma_1^2}} - A_2 e^{-\\frac{(z-z_2)^2}{2\\sigma_2^2}} \\right)$$\n$F(z)$ is a linear combination of two terms of the form $P_j(z) = \\exp(-z/H_s) \\exp\\left(-\\frac{(z-z_j)^2}{2\\sigma_j^2}\\right)$. Let the argument of the exponential be $h_j(z) = -z/H_s - (z-z_j)^2/(2\\sigma_j^2)$. Then $P_j(z) = \\exp(h_j(z))$.\n\nThe primary diagnostic is the true forcing term $g_{\\mathrm{true}}(z) = -dF/dz = -F'(z)$. Using the chain rule, the derivatives of $P_j(z)$ can be computed systematically.\nThe first derivative of $h_j(z)$ with respect to $z$ is:\n$$h'_j(z) = \\frac{d}{dz}\\left(-\\frac{z}{H_s} - \\frac{(z-z_j)^2}{2\\sigma_j^2}\\right) = -\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}$$\nThus, the first derivative of $P_j(z)$ is $P'_j(z) = h'_j(z) P_j(z)$. The analytical diagnostic is then:\n$$g_{\\mathrm{true}}(z) = -F'(z) = -\\rho_s \\left( A_1 P'_1(z) - A_2 P'_2(z) \\right) = -\\rho_s \\left( A_1 h'_1(z) P_1(z) - A_2 h'_2(z) P_2(z) \\right)$$\n\nThe second task is to compute the leading-order truncation error term for the centered difference approximation of the first derivative. This term is given by $\\frac{(\\Delta z)^2}{6} F'''(z)$, where $\\Delta z$ is the coarse grid spacing. To evaluate this, we need the third derivative of $F(z)$. We again find the third derivative of the generic term $P_j(z)$. The derivatives of $h_j(z)$ are $h''_j(z) = -1/\\sigma_j^2$ and $h'''_j(z) = 0$.\nThe third derivative of a composite function $P(z) = \\exp(h(z))$ is given by:\n$$P'''(z) = \\left( h'''(z) + 3h'(z)h''(z) + (h'(z))^3 \\right) P(z)$$\nSubstituting the expressions for the derivatives of $h_j(z)$:\n$$P'''_j(z) = \\left( 3\\left(-\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}\\right)\\left(-\\frac{1}{\\sigma_j^2}\\right) + \\left(-\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}\\right)^3 \\right) P_j(z)$$\n$$P'''_j(z) = h'_j(z) \\left( (h'_j(z))^2 + 3h''_j(z) \\right) P_j(z)$$\nThe third derivative of $F(z)$ is then $F'''(z) = \\rho_s \\left( A_1 P'''_1(z) - A_2 P'''_2(z) \\right)$. The leading-order truncation term to be evaluated is $E_T(z) = \\frac{(\\Delta z)^2}{6}F'''(z)$.\n\nThe numerical implementation proceeds as follows:\n1. A high-resolution grid $z_{\\mathrm{hr}}$ is created over the domain $[0, H]$ with spacing $\\Delta z_{\\mathrm{hr}} = 100\\,\\mathrm{m}$. The analytical function $F(z)$ is evaluated on this grid, yielding a high-resolution profile $F_{\\mathrm{hr}}$.\n2. For each test case, a coarse grid with spacing $\\Delta z$ is defined. The coarse grid consists of cells of width $\\Delta z$, with midpoints $z_i^{(c)}$.\n3. The high-resolution profile $F_{\\mathrm{hr}}$ is coarsened by layer-averaging. Since $\\Delta z$ is an integer multiple of $\\Delta z_{\\mathrm{hr}}$ in all test cases, this can be done efficiently. We model the average value in a high-resolution cell $[z_k, z_{k+1}]$ as $(F(z_k) + F(z_{k+1}))/2$, which is equivalent to a trapezoidal integration rule. The mean value over a coarse cell is then the average of these mid-cell values. This yields the coarse-grid profile $F^{(c)}$.\n4. At interior points of the coarse grid, the numerical diagnostic $g_{\\mathrm{cd}}$ is calculated using the second-order centered finite difference formula: $g_{\\mathrm{cd}}(z_i^{(c)}) = -(F^{(c)}_{i+1} - F^{(c)}_{i-1})/(2\\Delta z)$.\n5. The analytical expressions for $g_{\\mathrm{true}}(z)$ and the truncation term $E_T(z)$ are evaluated at the same interior coarse grid points.\n6. Finally, two root-mean-square (RMS) metrics are computed over these interior points:\n   - $\\mathrm{RMS}_{\\mathrm{true}} = \\sqrt{\\frac{1}{N} \\sum_{i} (g_{\\mathrm{cd}}(z_i^{(c)}) - g_{\\mathrm{true}}(z_i^{(c)}))^2}$\n   - $\\mathrm{RMS}_{\\mathrm{trunc}} = \\sqrt{\\frac{1}{N} \\sum_{i} (E_T(z_i^{(c)}))^2}$\nThese two values are reported for each test case.\nThis procedure allows for a direct comparison of the actual numerical error with its leading-order theoretical estimate, highlighting the impact of grid resolution on the accuracy of a critical atmospheric diagnostic.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating the sensitivity of a diagnosed atmospheric forcing\n    to vertical grid resolution.\n    \"\"\"\n    \n    # Global constants\n    H = 40000.0  # Domain height in m\n    rho_s = 1.2  # Surface density in kg m^-3\n    H_s = 7000.0  # Density scale height in m\n    dz_hr = 100.0  # High-resolution grid spacing in m\n\n    # Test suite: (dz, A1, z1, sigma1, A2, z2, sigma2)\n    test_cases = [\n        (1000.0, 0.12, 20000.0, 4000.0, 0.09, 28000.0, 5000.0),\n        (2000.0, 0.10, 18000.0, 2500.0, 0.08, 25000.0, 2000.0),\n        (5000.0, 0.11, 22000.0, 4000.0, 0.07, 30000.0, 3000.0),\n        (8000.0, 0.10, 21000.0, 1500.0, 0.09, 27000.0, 1200.0),\n    ]\n\n    # --- high-resolution grid setup ---\n    num_pts_hr = int(H / dz_hr) + 1\n    z_hr = np.linspace(0.0, H, num_pts_hr)\n\n    def P_and_derivatives(z, z_j, sigma_j):\n        \"\"\"\n        Computes the combined exponential-Gaussian term P_j(z) and quantities\n        needed for its derivatives.\n        \"\"\"\n        P_j = np.exp(-z / H_s) * np.exp(-((z - z_j)**2) / (2 * sigma_j**2))\n        \n        # h'(z) term\n        h_prime_j = -1.0 / H_s - (z - z_j) / (sigma_j**2)\n        \n        # h''(z) term\n        h_double_prime_j = -1.0 / (sigma_j**2)\n        \n        return P_j, h_prime_j, h_double_prime_j\n\n    def F_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic function F(z).\"\"\"\n        P1, _, _ = P_and_derivatives(z, z1, sigma1)\n        P2, _, _ = P_and_derivatives(z, z2, sigma2)\n        return rho_s * (A1 * P1 - A2 * P2)\n\n    def g_true_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic diagnostic g_true(z) = -F'(z).\"\"\"\n        P1, h_prime_1, _ = P_and_derivatives(z, z1, sigma1)\n        P2, h_prime_2, _ = P_and_derivatives(z, z2, sigma2)\n        F_prime = rho_s * (A1 * h_prime_1 * P1 - A2 * h_prime_2 * P2)\n        return -F_prime\n\n    def F_triple_prime_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic third derivative F'''(z).\"\"\"\n        P1, h_prime_1, h_double_prime_1 = P_and_derivatives(z, z1, sigma1)\n        P2, h_prime_2, h_double_prime_2 = P_and_derivatives(z, z2, sigma2)\n        \n        P_triple_prime_1 = (h_prime_1**3 + 3 * h_prime_1 * h_double_prime_1) * P1\n        P_triple_prime_2 = (h_prime_2**3 + 3 * h_prime_2 * h_double_prime_2) * P2\n        \n        return rho_s * (A1 * P_triple_prime_1 - A2 * P_triple_prime_2)\n\n    results = []\n    for case in test_cases:\n        dz, A1, z1, sigma1, A2, z2, sigma2 = case\n\n        # --- Evaluate F on high-resolution grid ---\n        F_hr = F_analytic(z_hr, A1, z1, sigma1, A2, z2, sigma2)\n\n        # --- Coarsening by layer-averaging ---\n        num_coarse_cells = int(H / dz)\n        pts_per_cell = int(dz / dz_hr)\n        \n        # Use trapezoidal rule on high-res intervals for better accuracy\n        F_hr_mid = (F_hr[:-1] + F_hr[1:]) / 2.0\n        \n        # Reshape and average to get coarse-grained F\n        F_c = F_hr_mid.reshape(num_coarse_cells, pts_per_cell).mean(axis=1)\n\n        # --- Define coarse grid and interior points ---\n        z_c = np.arange(dz / 2.0, H, dz)\n        z_c_interior = z_c[1:-1]\n        \n        # --- Compute numerical derivative g_cd ---\n        g_cd = -(F_c[2:] - F_c[:-2]) / (2 * dz)\n\n        # --- Evaluate analytic truth and truncation term on interior coarse grid ---\n        g_true_on_c_interior = g_true_analytic(z_c_interior, A1, z1, sigma1, A2, z2, sigma2)\n        F_ppp_on_c_interior = F_triple_prime_analytic(z_c_interior, A1, z1, sigma1, A2, z2, sigma2)\n        \n        lead_trunc_term = (dz**2 / 6.0) * F_ppp_on_c_interior\n\n        # --- Compute RMS metrics ---\n        rms_true_error = np.sqrt(np.mean((g_cd - g_true_on_c_interior)**2))\n        rms_trunc_term = np.sqrt(np.mean(lead_trunc_term**2))\n        \n        results.append([rms_true_error, rms_trunc_term])\n\n    # --- Format and print final output ---\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Just as spatial resolution is crucial, the choice of a model's time step has profound implications for the accurate simulation of wave dynamics. This exercise explores the fundamental concept of temporal aliasing, a pitfall where high-frequency phenomena are incorrectly perceived as low-frequency signals by the model. You will investigate how a strong, high-frequency signal like the diurnal (daily) cycle of heating can contaminate the frequency band of the very Kelvin waves responsible for driving the QBO if the sampling interval is not chosen carefully, underscoring the importance of time-stepping choices for maintaining spectral fidelity .",
            "id": "4079929",
            "problem": "In a simplified framework for evaluating temporal sampling errors in numerical weather prediction, consider a continuous diurnal thermodynamic forcing that modulates convectively coupled equatorial Kelvin wave sources in a general circulation model. The quasi-biennial oscillation (QBO) is driven in part by vertically propagating equatorial Kelvin waves whose frequency content must be accurately represented. Assume the continuous diurnal forcing is a single sinusoid with frequency $f_{d}$ equal to one cycle per day. The numerical model time stepping imposes a discrete sampling interval $\\Delta t$ on the forcing tendency, which can introduce temporal aliasing into the resolved spectrum seen by the dynamical core.\n\nStarting from the definitions of sampling frequency, Nyquist frequency, and aliasing in discrete-time sampling of a continuous sinusoid, and without invoking any pre-memorized shortcut formulas beyond those definitions, derive the aliased frequency $f_{a}$ (in cycles per day) that would be resolved by the model for each of the following time steps: $\\Delta t = 30$ minutes, $\\Delta t = 60$ minutes, and $\\Delta t = 120$ minutes. Treat the resolved frequency as the unique value $f_{a}$ in the principal band $[0, f_{N}]$, where $f_{N}$ is the Nyquist frequency associated with $\\Delta t$. Provide the three values $f_{a}(\\Delta t)$ as a single row vector. Express all frequencies in cycles per day and round your final results to four significant figures.\n\nBriefly discuss, based on your derivation, whether the aliased diurnal forcing can contaminate the Kelvin wave frequency band most effective for QBO momentum fluxes, and explain why or why not, using only physically grounded reasoning. Your final numerical answer must be only the required row vector of the three aliased frequencies in cycles per day.",
            "solution": "The problem requires the derivation of the aliased frequency of a diurnal forcing cycle under different discrete sampling intervals used in a numerical model. The derivation must proceed from the fundamental definitions of sampling and aliasing.\n\n**1. Problem Validation**\n\nThe problem statement has been validated and is found to be scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. The context involves standard concepts from digital signal processing (aliasing, Nyquist frequency) applied to a physically realistic scenario in atmospheric dynamics (diurnal forcing, time stepping in general circulation models, and relevance to the Quasi-Biennial Oscillation). The premises are sound and the objective is clear. The problem is therefore deemed **valid**.\n\n**2. Derivation of Aliased Frequency**\n\nLet the continuous diurnal forcing be represented by a sinusoidal signal $x(t)$ with a frequency $f_{d}$.\nThe problem states that the forcing has a frequency of one cycle per day.\n$$f_{d} = 1 \\text{ cycle/day}$$\nThe signal can be expressed as $x(t) = A \\cos(2\\pi f_{d} t + \\phi)$, where $A$ is the amplitude and $\\phi$ is the phase.\n\nThe numerical model samples this continuous signal at discrete time intervals $\\Delta t$. The sequence of sampled values is given by $x[n] = x(n\\Delta t)$ for integer values of $n$.\n$$x[n] = A \\cos(2\\pi f_{d} n \\Delta t + \\phi)$$\n\nThe **sampling frequency**, $f_{s}$, is the rate at which the signal is sampled:\n$$f_{s} = \\frac{1}{\\Delta t}$$\n\nAccording to the Nyquist-Shannon sampling theorem, the highest frequency that can be uniquely represented by the sampled data is the **Nyquist frequency**, $f_{N}$, defined as half the sampling frequency:\n$$f_{N} = \\frac{f_{s}}{2} = \\frac{1}{2\\Delta t}$$\nThe range of uniquely resolvable frequencies is called the principal band, which for a real-valued signal is often taken as $[0, f_{N}]$.\n\n**Aliasing** occurs when the frequency of the continuous signal, $f_d$, exceeds the Nyquist frequency, $f_N$. However, the concept of aliasing is more general. Due to the periodic nature of discrete-time sinusoids, a sampled signal generated from a continuous frequency $f$ is indistinguishable from one generated from any frequency $f'$ of the form $f' = f + k \\cdot f_{s}$ for any integer $k$.\n\nThe frequency that the discrete system \"sees\", known as the aliased or resolved frequency $f_{a}$, is the unique frequency within the principal band $[0, f_{N}]$ that is equivalent to the original frequency $f_d$. To find $f_{a}$, we seek an integer $k$ such that the frequency $|f_d - k \\cdot f_s|$ falls within the principal band $[0, f_{N}]$.\n$$f_{a} = |f_{d} - k f_{s}|, \\quad \\text{where } k \\in \\mathbb{Z} \\text{ is chosen such that } 0 \\le f_a \\le f_N$$\n\nWe now apply this framework to the three given time steps. The input frequency is consistently $f_d = 1$ cycle/day. We must ensure all units are consistent; we convert $\\Delta t$ from minutes to days. There are $1440$ minutes in a day.\n\n**Case 1: $\\Delta t = 30$ minutes**\nFirst, convert the time step to days:\n$$\\Delta t = 30 \\text{ min} \\times \\frac{1 \\text{ day}}{1440 \\text{ min}} = \\frac{30}{1440} \\text{ days} = \\frac{1}{48} \\text{ days}$$\nThe sampling frequency is:\n$$f_{s} = \\frac{1}{\\Delta t} = 48 \\text{ cycles/day}$$\nThe Nyquist frequency is:\n$$f_{N} = \\frac{f_{s}}{2} = 24 \\text{ cycles/day}$$\nThe principal band is $[0, 24]$. The input frequency is $f_{d}=1$. Since $f_{d} < f_{N}$, we expect no aliasing. We find the integer $k$ for which $f_{a} = |1 - k \\cdot 48|$ is in $[0, 24]$.\n- For $k=0$: $f_{a} = |1 - 0| = 1$. This value is in the range $[0, 24]$.\n- For $k=1$: $f_{a} = |1 - 48| = 47$. This is outside the range.\n- For $k=-1$: $f_{a} = |1 - (-48)| = 49$. This is outside the range.\nThe only valid choice is $k=0$, which yields the resolved frequency:\n$$f_{a} = 1 \\text{ cycle/day}$$\n\n**Case 2: $\\Delta t = 60$ minutes**\nConvert the time step to days:\n$$\\Delta t = 60 \\text{ min} \\times \\frac{1 \\text{ day}}{1440 \\text{ min}} = \\frac{60}{1440} \\text{ days} = \\frac{1}{24} \\text{ days}$$\nThe sampling frequency is:\n$$f_{s} = \\frac{1}{\\Delta t} = 24 \\text{ cycles/day}$$\nThe Nyquist frequency is:\n$$f_{N} = \\frac{f_{s}}{2} = 12 \\text{ cycles/day}$$\nThe principal band is $[0, 12]$. The input frequency is $f_{d}=1$. Again, $f_{d} < f_{N}$. We find $k$ such that $f_{a} = |1 - k \\cdot 24|$ is in $[0, 12]$.\n- For $k=0$: $f_{a} = |1 - 0| = 1$. This value is in the range $[0, 12]$.\n- For $k=1$: $f_{a} = |1 - 24| = 23$. This is outside the range.\nThe unique solution is for $k=0$:\n$$f_{a} = 1 \\text{ cycle/day}$$\n\n**Case 3: $\\Delta t = 120$ minutes**\nConvert the time step to days:\n$$\\Delta t = 120 \\text{ min} \\times \\frac{1 \\text{ day}}{1440 \\text{ min}} = \\frac{120}{1440} \\text{ days} = \\frac{1}{12} \\text{ days}$$\nThe sampling frequency is:\n$$f_{s} = \\frac{1}{\\Delta t} = 12 \\text{ cycles/day}$$\nThe Nyquist frequency is:\n$$f_{N} = \\frac{f_{s}}{2} = 6 \\text{ cycles/day}$$\nThe principal band is $[0, 6]$. The input frequency is $f_{d}=1$. Once more, $f_{d} < f_{N}$. We find $k$ such that $f_{a} = |1 - k \\cdot 12|$ is in $[0, 6]$.\n- For $k=0$: $f_{a} = |1 - 0| = 1$. This value is in the range $[0, 6]$.\n- For $k=1$: $f_{a} = |1 - 12| = 11$. This is outside the range.\nThe unique solution is for $k=0$:\n$$f_{a} = 1 \\text{ cycle/day}$$\n\nThe aliased frequency for all three cases is $1$ cycle/day. Rounding to four significant figures, the values are $1.000$, $1.000$, and $1.000$.\n\n**3. Discussion on Contamination of the QBO Spectrum**\n\nThe quasi-biennial oscillation (QBO) is driven by momentum deposition from vertically propagating equatorial waves, primarily Kelvin waves. These waves must have specific characteristics to reach the stratosphere and influence the zonal flow. The Kelvin waves most effective for driving the QBO have relatively long periods, typically in the range of $5$ to $20$ days. This corresponds to a frequency band of approximately $f_{QBO} \\in [1/20, 1/5]$ cycles/day, or $f_{QBO} \\in [0.05, 0.2]$ cycles/day.\n\nOur derivation shows that for all three specified sampling intervals ($\\Delta t = 30$, $60$, and $120$ minutes), the diurnal forcing frequency ($f_d = 1$ cycle/day) is well below the corresponding Nyquist frequencies ($f_N = 24$, $12$, and $6$ cycles/day, respectively). As a result, the forcing is not aliased into a lower frequency. The model resolves this forcing at its true frequency, $f_{a} = 1$ cycle/day. This resolved frequency corresponds to a period of $1$ day, which is spectrally well-separated from the much lower frequencies (longer periods) of the QBO-driving Kelvin waves.\n\nTherefore, under these sampling conditions, the diurnal forcing does not contaminate the Kelvin wave frequency band relevant to the QBO *via temporal aliasing*. The resolved diurnal forcing signal at $1$ cycle/day is distinct from the low-frequency signals near $0.1$ cycles/day.\n\nIt is critical to note that this conclusion holds because the sampling is sufficiently rapid. If the model used a much larger time step (e.g., $\\Delta t > 12$ hours, or $f_s < 2$ cycles/day), the diurnal frequency $f_d=1$ cpd would indeed be aliased to a lower frequency. For instance, with $\\Delta t = 18$ hours ($0.75$ days), $f_s = 4/3$ cpd and $f_N = 2/3$ cpd. The diurnal frequency $f_d=1$ cpd would alias to $f_a = |1 - 1 \\cdot (4/3)| = 1/3$ cpd (a period of $3$ days). This frequency is much closer to, and could potentially contaminate, the spectrum of fast Kelvin waves involved in stratospheric momentum transport. Thus, the choice of a sufficiently small time step is crucial to prevent such spectral contamination.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 & 1.000 & 1.000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}