{
    "hands_on_practices": [
        {
            "introduction": "我们如何将卫星观测到的云顶辐射转化为降雨量估算？本练习通过一个简化的大气能量平衡模型，将逸出长波辐射（$OLR$）异常与降水异常直接联系起来，提供了一种一阶近似方法。掌握这种尺度分析有助于建立对深对流、云辐射效应和潜热加热之间关系的直观理解，这些都是MJO能量收支的核心 。",
            "id": "4101652",
            "problem": "考虑马登-朱利安振荡（MJO），一种行星尺度的有组织热带对流包，及其在模式中通过向外长波辐射（OLR）异常的表征。假设向外长波辐射（OLR）可由一个由云特性控制的简单灰体关系近似，云顶的辐射通量由斯蒂芬-玻尔兹曼定律 $F = \\epsilon \\sigma T^{4}$ 给出，其中 $\\epsilon$ 是发射率，$\\sigma$ 是斯蒂芬-玻尔兹曼常数，$T$ 是绝对温度。在深对流区域，假设云为光学厚的高云，因此 $\\epsilon \\approx 1$，并且季节内时间尺度上的OLR异常主要由云驱动的发射变化主导。此外，采用准平衡状态下的整层积分湿静力能量平衡，其中降水的潜热加热平衡了大气的净辐射冷却异常，并假设在所关心的时间尺度上，云的短波效应和地表通量异常在主导阶上可以忽略不计。\n\n利用这些假设和所提供的物理常数，推导一个从OLR异常 $\\Delta \\mathrm{OLR}$ 到降水异常 $\\Delta P$ 的线性转换关系，然后计算与典型的对流位相MJO OLR异常 $\\Delta \\mathrm{OLR} = -20\\,\\mathrm{W\\,m^{-2}}$ 相对应的降水异常。取汽化潜热为 $L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。将 $\\Delta P$ 以 $\\mathrm{mm\\,day^{-1}}$ 为单位表示，并将最终数值答案四舍五入至四位有效数字。在计算过程中明确说明异常值的符号。简要论证由发射率-云顶温度关系所引出的线性化的合理性，并讨论在MJO背景下这种线性转换的局限性，包括 $T^{4}$ 的非线性、发射率的变化以及被忽略的短波和地表通量项的作用。",
            "solution": "该问题要求基于马登-朱利安振荡（MJO）的简化模型，推导一个从向外长波辐射（OLR）异常 $\\Delta \\mathrm{OLR}$ 到降水异常 $\\Delta P$ 的线性转换关系。然后，我们将使用此转换关系计算 $\\Delta P$ 的具体值，并讨论所作的假设。\n\n首先，我们验证问题的陈述。\n已知条件：\n1.  云顶的辐射通量由斯蒂芬-玻尔兹曼定律 $F = \\epsilon \\sigma T^{4}$ 给出。\n2.  在深对流区域，发射率 $\\epsilon \\approx 1$。\n3.  季节内时间尺度上的OLR异常主要由云驱动的变化主导。\n4.  假设在准平衡状态下存在整层积分的湿静力能量（MSE）平衡，其中降水的潜热加热平衡了大气的净辐射冷却异常。\n5.  云的短波效应和地表通量异常在主导阶上可以忽略不计。\n6.  MJO对流位相的OLR异常为 $\\Delta \\mathrm{OLR} = -20\\,\\mathrm{W\\,m^{-2}}$。\n7.  汽化潜热为 $L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n\n验证：\n该问题在科学上基于大气热力学和辐射传输的原理，应用了热带气象学中常用的标准准平衡框架。这些假设虽然是简化的，但为进行主导阶分析而明确陈述，这是构建尺度关系的一种有效方法。问题提法得当，提供了推导唯一解所需的所有物理常数和关系。给定值对于MJO现象是物理上现实的。该问题没有明显缺陷，被认为是有效的。\n\n第1部分：$\\Delta \\mathrm{OLR}$ 到 $\\Delta P$ 转换关系的推导\n\n问题的核心在于对大气柱所假设的能量平衡。问题陈述“降水的潜热加热平衡了大气的净辐射冷却异常”。让我们将其形式化。\n\n由降水释放潜热输入到大气柱的能量由降水率 $P$ 和汽化潜热 $L_v$ 的乘积给出。该加热项的异常为 $L_v \\Delta P$。此项的单位是单位面积单位时间的能量，即 $\\mathrm{J\\,s^{-1}\\,m^{-2}}$，等同于 $\\mathrm{W\\,m^{-2}}$。\n\n问题将此加热异常等同于“大气的净辐射冷却异常”。我们将大气柱的净辐射冷却表示为 $Q_{rad}$。因此，异常的平衡可以表示为 $L_v \\Delta P = \\Delta Q_{rad}$。然而，我们必须注意其物理释义。降水增加（$\\Delta P  0$）与深对流和高而冷的云有关。这些云捕获了本应逃逸到太空的长波辐射，导致OLR减少（$\\Delta \\mathrm{OLR}  0$）。这种辐射的捕获代表了相对于晴空状态对大气柱的*加热*，这意味着大气柱的净辐射*冷却*减少了。因此，大气辐射加热异常 $\\Delta H_{rad}$ 为正，而冷却异常 $\\Delta Q_{rad}$ 为负。\n\n一个更一致的能量平衡表述是，异常热源必须平衡异常热汇（或冷源）。来自潜热释放的异常加热 $L_v \\Delta P$ 必须由大气柱的异常辐射能量收支来平衡。在给定的简化条件下（忽略短波和地表通量效应），主导的大气辐射异常是长波辐射的变化。负的OLR异常（$\\Delta \\mathrm{OLR}  0$）表示离开大气层顶的能量减少，这对地球-大气系统构成了净辐射加热。由于云-辐射相互作用，这种加热主要由大气柱本身感受到。因此，大气柱的异常辐射加热约等于OLR异常的负值：\n$$ \\Delta H_{rad} \\approx -\\Delta \\mathrm{OLR} $$\n因此，大气柱异常的准平衡能量平衡可以写成：\n$$ L_v \\Delta P \\approx \\Delta H_{rad} $$\n结合这些，我们得到降水异常和OLR异常之间的直接关系：\n$$ L_v \\Delta P \\approx -\\Delta \\mathrm{OLR} $$\n这就得出了所需的线性转换关系：\n$$ \\Delta P = -\\frac{1}{L_v} \\Delta \\mathrm{OLR} $$\n这个关系在物理上是一致的：一个负的OLR异常（表示深对流）对应一个正的降水异常。\n\n第2部分：降水异常的计算\n\n给定条件：\n$\\Delta \\mathrm{OLR} = -20\\,\\mathrm{W\\,m^{-2}} = -20\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}$\n$L_{v} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$\n\n将这些值代入我们推导的转换公式：\n$$ \\Delta P = -\\frac{1}{2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}} (-20\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}) $$\n$$ \\Delta P = \\frac{20}{2.5 \\times 10^{6}}\\,\\mathrm{kg\\,m^{-2}\\,s^{-1}} = 8 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-2}\\,s^{-1}} $$\n问题要求答案以 $\\mathrm{mm\\,day^{-1}}$ 为单位。转换需要两个步骤。\n首先，我们将水的质量通量转换为深度速率。液态水的密度 $\\rho_w$ 约为 $1000\\,\\mathrm{kg\\,m^{-3}}$。在 $1\\,\\mathrm{m^2}$ 的面积上累积 $1\\,\\mathrm{kg}$ 的降水对应于 $1/1000\\,\\mathrm{m^3}$ 的体积，即水深为 $10^{-3}\\,\\mathrm{m}$ 或 $1\\,\\mathrm{mm}$。因此，$1\\,\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ 的速率等效于 $1\\,\\mathrm{mm\\,s^{-1}}$。\n$$ \\Delta P = 8 \\times 10^{-6}\\,\\mathrm{mm\\,s^{-1}} $$\n其次，我们从秒转换为天。一天中的秒数为：\n$1\\,\\mathrm{day} = 24\\,\\mathrm{h} \\times 60\\,\\mathrm{min\\,h^{-1}} \\times 60\\,\\mathrm{s\\,min^{-1}} = 86400\\,\\mathrm{s}$\n所以，我们将以 $\\mathrm{mm\\,s^{-1}}$ 为单位的速率乘以 $86400\\,\\mathrm{s\\,day^{-1}}$：\n$$ \\Delta P = (8 \\times 10^{-6}\\,\\mathrm{mm\\,s^{-1}}) \\times (86400\\,\\mathrm{s\\,day^{-1}}) $$\n$$ \\Delta P = 8 \\times 8.64 \\times 10^{4} \\times 10^{-6}\\,\\mathrm{mm\\,day^{-1}} = 69.12 \\times 10^{-2}\\,\\mathrm{mm\\,day^{-1}} $$\n$$ \\Delta P = 0.6912\\,\\mathrm{mm\\,day^{-1}} $$\n按要求四舍五入到四位有效数字，值为 $0.6912$。\n\n第3部分：模型的合理性与局限性\n\n线性化的合理性：问题提到“由发射率-云顶温度关系所引出的线性化”。由于发射率 $\\epsilon$ 被假设为常数（$\\epsilon \\approx 1$），这很可能指的是斯蒂芬-玻尔兹曼定律 $F = \\sigma T^4$ 的线性化，该定律将OLR与云顶温度 $T$ 联系起来。设背景态的特征是温度 $T_0$ 和通量 $F_0 = \\epsilon \\sigma T_0^4$。一个小的温度异常 $\\Delta T = T - T_0$ 会导致一个通量异常 $\\Delta F$。使用一阶泰勒级数展开：\n$$ F(T) = F(T_0 + \\Delta T) \\approx F(T_0) + \\frac{dF}{dT}\\bigg|_{T_0} \\Delta T $$\n$$ \\Delta F = F - F_0 \\approx \\left(\\frac{d}{dT}(\\epsilon \\sigma T^4)\\right)_{T_0} \\Delta T = (4 \\epsilon \\sigma T_0^3) \\Delta T $$\n这表明对于小的 $\\Delta T$，OLR异常与温度异常成线性比例关系，即 $\\Delta F \\propto \\Delta T$。当 $\\Delta T \\ll T_0$ 时，此近似有效。对于与MJO相关的典型卷云砧顶，$T_0$ 约为 $220\\,\\mathrm{K}$。温度异常 $\\Delta T$ 的量级为几个开尔文（$1-5\\,\\mathrm{K}$）。因此，比率 $\\Delta T / T_0$ 很小（例如，$5/220 \\approx 2.3\\%$），这证明了将线性化作为合理的一阶近似是正当的。\n\n线性转换的局限性：\n1.  **$T^4$ 的非线性：** 虽然线性化是一个尚可的近似，但 $T^4$ 关系本质上是非线性的。对于更大的温度变化，或要求更高精度时，展开式中的高阶项变得不可忽略。与完整的非线性定律相比，线性近似会低估给定温度变化所对应的通量变化。\n2.  **发射率（$\\epsilon$）的变化：** 假设 $\\epsilon = 1$ 是一个很强的简化。真实的对流云，特别是与MJO相关的广阔的卷云砧，并非完美的黑体。它们的发射率取决于云的厚度、冰水路径和粒子尺度分布。发射率可以有显著变化，通常小于1。因此，OLR异常是温度和发射率异常的函数：$\\Delta F \\approx (4 \\epsilon \\sigma T_0^3) \\Delta T + (\\sigma T_0^4) \\Delta \\epsilon$。通过忽略 $\\Delta \\epsilon$ 项，该模型忽略了OLR异常的一个潜在重要贡献者，及其与底层对流过程和云微物理的联系。\n3.  **被忽略的短波（SW）和地表通量项：** 这可以说是最重要的局限性。\n    *   **短波效应：** 深对流云具有高反照率，反射大量的入射太阳辐射。这种在光谱短波部分的云辐射效应，其量级通常与长波效应相当。例如，一个 $+20\\,\\mathrm{W\\,m^{-2}}$ 的长波增温异常（来自 $\\Delta \\mathrm{OLR} = -20\\,\\mathrm{W\\,m^{-2}}$）可能伴随着一个 $-20\\,\\mathrm{W\\,m^{-2}}$ 或更大的大气层顶短波冷却异常。忽略短波分量意味着云的总净辐射效应被错误地表述，从而改变了降水必须满足的能量平衡。\n    *   **地表通量：** 忽略地表通量异常的假设与观测结果相反。MJO显著调节地表风速以及海-气温差和湿度差，这反过来又驱动了地表潜热通量（蒸发）和感热通量的巨大异常。这些通量是整层MSE收支的关键组成部分，并为MJO的传播和维持提供了必要的反馈。通过忽略它们，该模型移除了一个关键的物理机制，并过度简化了能量平衡，将潜热释放的全部补偿仅归因于辐射。实际上，收支是降水、辐射、地表通量和MSE水平平流之间更复杂的平衡。",
            "answer": "$$\n\\boxed{0.6912}\n$$"
        },
        {
            "introduction": "马登-朱利安振荡本质上是热带大气的一种不稳定性。本练习使用简化的“水汽模”模型，深入探讨了这种不稳定性的核心机制，在该模型中，水汽异常可以在特定的反馈条件下增长。通过推导增长率，您将看到MJO在模型中的存在如何取决于辐射和地表通量等不稳定反馈与大气能量输出和扩散等稳定效应之间的微妙平衡 。",
            "id": "4101627",
            "problem": "考虑一个简化的整层积分湿静力能距平 $m'(x,t)$，它描述了与马登-朱利安振荡 (MJO) 相关的大尺度热带扰动，该扰动在弱温度梯度 (WTG) 近似下被模拟为一个湿模式。假设对流准平衡 (CQE)，因此降水距平 $P'(x,t)$ 与 $m'(x,t)$ 线性成正比，具有有限的对流调整时间尺度 $\\tau$，即 $P'(x,t) = m'(x,t)/\\tau$。$m'(x,t)$ 的湿静力能 (MSE) 收支包含三个主要贡献项：\n- 长波云辐射反馈，由无量纲系数 $\\alpha  0$ 参数化，提供一个与 $P'(x,t)$ 成正比的整层积分加热倾向。\n- 风致表面热交换 (WISHE) 表面通量反馈，由无量纲系数 $\\gamma  0$ 参数化，提供一个与 $P'(x,t)$ 成正比的增湿/加热倾向。\n- 大尺度环流输出湿静力能，由（无量纲的）总湿稳定度 $\\Lambda  0$ 量化，该过程按与 $P'(x,t)$ 成正比的比例移除 MSE。\n\n假设 $m'$ 的侧向混合由一个扩散项表示，其扩散率为 $\\kappa  0$（单位为 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$），因此一维控制方程为\n$$\n\\frac{\\partial m'}{\\partial t} \\;=\\; \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} \\;+\\; \\kappa\\,\\frac{\\partial^{2} m'}{\\partial x^{2}}.\n$$\n寻找形式为 $m'(x,t) = \\hat{m}\\,\\exp\\!\\left(\\sigma\\,t + i k x\\right)$ 的简正模解，其中 $k$ 是纬向波数，$\\sigma$ 是复增长率。从湿静力能守恒和给定的参数化方案出发，推导实增长率 $\\sigma(k)$ 作为 $\\alpha$、$\\gamma$、$\\Lambda$、$\\tau$、$\\kappa$ 和 $k$ 的函数，并陈述在给定波数 $k$ 下，模态线性不稳定的 $\\alpha$ 和 $\\gamma$ 需满足的条件。最终的增长率以 $\\mathrm{s}^{-1}$ 为单位表示。没有提供数值；请以闭合形式的解析表达式给出结果。您的答案应为单个表达式。如果引入任何缩写，请在首次使用时定义它们。",
            "solution": "该问题要求我们推导一个大尺度热带扰动的实增长率，该扰动被模拟为马登-朱利安振荡 (MJO) 的一个湿模式。该模型基于整层积分湿静力能 (MSE) 的守恒，其动力学由一个给定的一维偏微分方程描述。\n\nMSE 距平 $m'(x,t)$ 的控制方程为：\n$$\n\\frac{\\partial m'}{\\partial t} \\;=\\; \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} \\;+\\; \\kappa\\,\\frac{\\partial^{2} m'}{\\partial x^{2}}\n$$\n此处，$m'(x,t)$ 是 MSE 距平，$t$ 是时间，$x$ 是空间坐标。所有参数均为正常数：$\\tau$ 是对流调整时间尺度，$\\alpha$ 是长波云辐射反馈的无量纲系数，$\\gamma$ 是风致表面热交换 (WISHE) 表面通量反馈的无量纲系数，$\\Lambda$ 是无量纲的总湿稳定度，$\\kappa$ 是扩散率。\n\n我们要寻找一个形式为如下的简正模解：\n$$\nm'(x,t) = \\hat{m}\\,\\exp(\\sigma t + i k x)\n$$\n在此表达式中，$\\hat{m}$ 是一个常数振幅，$k$ 是实值纬向波数，$\\sigma$ 是复增长率。$\\sigma$ 的实部决定了模态振幅的增长或衰减，虚部决定了其振荡频率或相速度。\n\n为了找到 $\\sigma$ 和 $k$ 之间的关系，即色散关系，我们将简正模解代入控制方程。首先，我们计算 $m'(x,t)$ 所需的偏导数：\n对时间 $t$ 的偏导数为：\n$$\n\\frac{\\partial m'}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = \\sigma \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = \\sigma m'\n$$\n对空间坐标 $x$ 的二阶偏导数为：\n$$\n\\frac{\\partial^{2} m'}{\\partial x^{2}} = \\frac{\\partial^{2}}{\\partial x^{2}} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = (i k)^{2} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = -k^2 m'\n$$\n现在，将这些导数代入控制方程得到：\n$$\n\\sigma m' = \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} + \\kappa(-k^2 m')\n$$\n为了存在非平凡解，我们必须有 $\\hat{m} \\neq 0$，这意味着 $m'(x,t)$ 不恒为零。因此，我们可以将整个方程除以 $m'$：\n$$\n\\sigma(k) = \\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2\n$$\n这就是该系统的色散关系。它将复增长率 $\\sigma$ 表示为波数 $k$ 和模型物理参数的函数。\n\n问题要求的是实增长率。复增长率通常表示为 $\\sigma = \\mathrm{Re}(\\sigma) + i\\,\\mathrm{Im}(\\sigma)$。由于推导出的 $\\sigma(k)$ 表达式中的所有参数——即 $\\alpha$、$\\gamma$、$\\Lambda$、$\\tau$、$\\kappa$——都是实常数，且波数 $k$ 也是实数，因此整个右侧都是实数。所以，复增长率 $\\sigma(k)$ 是纯实数，其虚部为零。\n$$\n\\mathrm{Re}(\\sigma(k)) = \\sigma(k) = \\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2\n$$\n$$\n\\mathrm{Im}(\\sigma(k)) = 0\n$$\n$\\mathrm{Im}(\\sigma(k)) = 0$ 这一事实意味着这些扰动是驻波；它们在原地增长或衰减，而没有传播。决定模态稳定性的实增长率就是 $\\sigma(k)$ 本身。$\\sigma(k)$ 的单位是时间的倒数（$\\mathrm{s}^{-1}$），符合增长率的要求。这可以通过量纲分析来验证：$\\alpha, \\gamma, \\Lambda$ 是无量纲的，$\\tau$ 的单位是 s，$\\kappa$ 的单位是 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$，$k$ 的单位是 $\\mathrm{m}^{-1}$。因此，$[\\tau^{-1}]=\\mathrm{s}^{-1}$ 且 $[\\kappa k^2] = (\\mathrm{m}^{2}\\,\\mathrm{s}^{-1})(\\mathrm{m}^{-1})^2 = \\mathrm{s}^{-1}$。\n\n最后，我们确定线性不稳定的条件。如果一个波数为 $k$ 的模态的振幅随时间指数增长，那么它被认为是线性不稳定的。这发生在实增长率为正时：\n$$\n\\sigma(k) > 0\n$$\n代入我们推导出的 $\\sigma(k)$ 表达式：\n$$\n\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2 > 0\n$$\n整理不等式，以找到对反馈参数 $\\alpha$ 和 $\\gamma$ 的条件：\n$$\n\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} > \\kappa k^2\n$$\n因为 $\\tau > 0$，我们可以用 $\\tau$ 乘以不等式两边而不改变不等号的方向：\n$$\n(\\alpha + \\gamma) - \\Lambda > \\tau \\kappa k^2\n$$\n$$\n\\alpha + \\gamma > \\Lambda + \\tau \\kappa k^2\n$$\n该条件表明，对于一个波数为 $k$ 的模态要变得不稳定，与云辐射反馈 ($\\alpha$) 和表面通量反馈 ($\\gamma$) 相关的致不稳定源项必须超过与大尺度环流的 MSE 输出 ($\\Lambda$) 和侧向扩散 ($\\kappa k^2 \\tau$) 相关的致稳定汇项。最长的波（最小的 $k$）是最不稳定的，因为它们受扩散的影响最小。\n要求的主要结果是实增长率 $\\sigma(k)$ 的表达式。",
            "answer": "$$\n\\boxed{\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^{2}}\n$$"
        },
        {
            "introduction": "虽然水汽是关键，但MJO的结构和传播源于对流与大尺度大气环流之间的耦合。本练习将我们的分析推进到一个代表水汽和风异常的耦合双变量系统，将动力学引入到水汽模框架中。通过数值求解该系统的特征值，您将定量地研究总湿稳定度和平均风等物理参数如何不仅控制MJO的增长率，还控制其标志性的向东传播速度 。",
            "id": "4101611",
            "problem": "要求您在一个常用于数值天气预报和气候模拟的线性湿模式框架内，为马登-朱利安振荡（Madden–Julian Oscillation, MJO）实现一个敏感性实验。请使用以下有科学依据的基础和闭合方案，推导出一个最小化的、自洽的线性模型，该模型的正规模态分析能够为给定的纬向波数得出复增长率和相关的相速度。\n\n基本依据：\n- 整层水汽异常的预报变量表示为 $q(x,t)$，第一斜压纬向风异常的预报变量表示为 $u(x,t)$。\n- 整层水汽收支由源和汇的标准分解构成：降水异常 $P'$、蒸发异常 $E'$，以及与总湿稳定度相关的环流引起的输出。采用以下线性闭合方案：\n  1. 降水异常与整层水汽异常成正比，比例系数为降水效率参数 $\\epsilon$，即 $P' = \\epsilon q$。\n  2. 蒸发异常与近地面风异常成正比，系数为 $\\beta$，即 $E' = \\beta u$。\n  3. 总湿稳定度（Gross Moist Stability, GMS），记为 $S$，参数化了单位对流加热的湿静力能净输出。其对水汽收支的影响表现为一个与加热成正比的额外汇，因此在水汽倾向中为 $-S P' = -S \\epsilon q$。\n- 背景平均纬向风 $U$ 平流输送水汽异常，对水汽倾向的贡献为 $-U \\partial_x q$。\n- 在弱温度梯度（Weak Temperature Gradient, WTG）近似和第一斜压赤道类开尔文响应下，纬向风异常由与水汽异常相关的加热的纬向梯度线性强迫。采用线性闭合方案 $u_t = -\\alpha \\partial_x q - \\mu u$，其中 $\\alpha$ 是一个耦合系数，通过气压梯度强迫将水汽异常的纬向梯度转换为风倾向，$\\mu$ 是一个线性摩擦率。\n\n基于这些基础，围绕空间均匀的平均态进行线性化，并考虑形如 $q(x,t), u(x,t) \\propto \\exp(i k x - i \\omega t)$ 的正规模态，其中 $k$ 是纬向波数（单位为 $\\text{m}^{-1}$），$\\omega$ 是角频率（单位为 $\\text{s}^{-1}$）。推导耦合 $(q,u)$ 系统的相关线性算子及其频散关系。根据该算子的特征值 $\\lambda$，通过 $\\lambda = \\sigma - i \\omega$ 确定复频率，其中 $\\sigma$ 是实部增长率（单位为 $\\text{s}^{-1}$），$\\omega$ 是实部角频率（单位为 $\\text{s}^{-1}$）。将相速度 $c_p$（单位为 $\\text{m}\\,\\text{s}^{-1}$）定义为 $c_p = \\omega/k$（对于 $k \\neq 0$）。对于 $k=0$ 的情况，根据非传播均匀模态的定义，设 $c_p = 0$。\n\n实现一个程序，该程序：\n1. 对于给定的参数 $(\\epsilon, S, k, U)$ 和固定的耦合/摩擦参数 $(\\alpha, \\beta, \\mu)$，构建线性算子。\n2. 计算所有特征值，并选择具有最大实部 $\\sigma$ 的特征值（最不稳定或阻尼最小的模态）。\n3. 报告根据该特征值计算出的增长率 $\\sigma$（单位为 $\\text{s}^{-1}$）和相速度 $c_p$（单位为 $\\text{m}\\,\\text{s}^{-1}$）。\n\n在所有测试中使用以下固定参数：\n- $\\alpha = 0.02$ (常数耦合系数),\n- $\\beta = 0.001$ (蒸发-风耦合),\n- $\\mu = 1.0 \\times 10^{-6}\\,\\text{s}^{-1}$ (线性摩擦率).\n\n使用以下案例构建测试套件，每个案例为一个元组 $(\\epsilon, S, k, U)$：\n- 案例 A (基准负总湿稳定度): $\\epsilon = 2.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -0.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$。\n- 案例 B (强阻尼): $\\epsilon = 5.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = 0.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$。\n- 案例 C (接近中性的净降水汇): $\\epsilon = 1.5 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -1.0$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$。\n- 案例 D (强负总湿稳定度伴有弱平均流): $\\epsilon = 1.2 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -2.0$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 1.0\\,\\text{m}\\,\\text{s}^{-1}$。\n- 案例 E (非传播边界情况): $\\epsilon = 2.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -0.5$, $k = 0.0\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$。\n- 案例 F (非常负的总湿稳定度，西向平均风): $\\epsilon = 1.8 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -2.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = -2.0\\,\\text{m}\\,\\text{s}^{-1}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的浮点数列表。对于每个测试案例，您首先输出增长率 $\\sigma$（单位为 $\\text{s}^{-1}$），然后输出相速度 $c_p$（单位为 $\\text{m}\\,\\text{s}^{-1}$）。结果必须按照测试套件的顺序展平：$[\\sigma_A, c_{p,A}, \\sigma_B, c_{p,B}, \\sigma_C, c_{p,C}, \\sigma_D, c_{p,D}, \\sigma_E, c_{p,E}, \\sigma_F, c_{p,F}]$。",
            "solution": "该问题要求推导并实现一个针对马登-朱利安振荡（MJO）的简化线性湿模式模型的解。该解决方案涉及为一组给定的物理参数，找出最不稳定正规模态的增长率和相速度。\n\n首先，我们根据所提供的物理闭合方案，建立线性偏微分方程组（PDEs）控制系统。预报变量是整层水汽异常 $q(x,t)$ 和第一斜压纬向风异常 $u(x,t)$。\n\n整层水汽收支方程由倾向项 $\\partial_t q$ 给出。源和汇包括：\n1.  蒸发异常，$E' = \\beta u$，这是一个源项。\n2.  降水异常，$P' = \\epsilon q$，这是一个汇项。\n3.  由总湿稳定度（$S$）引起的水汽汇，它与对流加热（因此也与降水）成正比：$-S P' = -S \\epsilon q$。注意，当 $S$ 为负时，此项变为源项，代表水汽再补给。\n4.  平均纬向风 $U$ 对水汽异常的平流输送：$-U \\partial_x q$。\n\n结合这些项，水汽方程为：\n$$ \\frac{\\partial q}{\\partial t} = \\beta u - \\epsilon q - S \\epsilon q - U \\frac{\\partial q}{\\partial x} = -\\epsilon(1+S) q - U \\frac{\\partial q}{\\partial x} + \\beta u $$\n\n纬向风倾向 $\\partial_t u$ 由以下各项控制：\n1.  来自纬向气压梯度的强迫，在弱温度梯度（WTG）近似下，它与潜热加热的梯度（也就是水汽的梯度）有关：$-\\alpha \\partial_x q$。\n2.  线性摩擦（或阻尼）项：$-\\mu u$。\n\n这给出了风场方程：\n$$ \\frac{\\partial u}{\\partial t} = -\\alpha \\frac{\\partial q}{\\partial x} - \\mu u $$\n\n现在我们得到了状态向量 $\\mathbf{v}(x,t) = \\begin{pmatrix} q(x,t) \\\\ u(x,t) \\end{pmatrix}$ 的耦合线性系统。为了分析其正规模态，我们假设解的形式为 $\\mathbf{v}(x,t) = \\hat{\\mathbf{v}} e^{\\lambda t + ikx}$，其中 $\\hat{\\mathbf{v}} = \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix}$ 是一个常复数向量，$k$ 是纬向波数，$\\lambda$ 是复增长率。这个拟设将时间和空间导数转换为 $\\partial_t \\to \\lambda$ 和 $\\partial_x \\to ik$。\n\n将这种形式代入偏微分方程组，得到一个线性代数方程组：\n$$ \\lambda \\hat{q} = -\\epsilon(1+S) \\hat{q} - U (ik) \\hat{q} + \\beta \\hat{u} $$\n$$ \\lambda \\hat{u} = -\\alpha (ik) \\hat{q} - \\mu \\hat{u} $$\n\n这可以写成标准的矩阵特征值问题形式 $\\lambda \\hat{\\mathbf{v}} = \\mathbf{L} \\hat{\\mathbf{v}}$：\n$$ \\lambda \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix} = \\begin{pmatrix} -\\epsilon(1+S) - iUk   \\beta \\\\ -i\\alpha k   -\\mu \\end{pmatrix} \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix} $$\n\n这个 $2 \\times 2$ 矩阵 $\\mathbf{L}$ 是该系统的线性算子：\n$$ \\mathbf{L} = \\begin{pmatrix} -\\epsilon(1+S) - iUk   \\beta \\\\ -i\\alpha k   -\\mu \\end{pmatrix} $$\n\n矩阵 $\\mathbf{L}$ 的特征值 $\\lambda$ 决定了模态的行为。对于每组参数 $(\\epsilon, S, k, U)$ 和固定常数 $(\\alpha, \\beta, \\mu)$，我们计算 $\\mathbf{L}$ 的两个特征值。问题指定选择具有最大实部的特征值，我们记为 $\\lambda_{max}$。这对应于最不稳定（或阻尼最小）的模态。\n\n问题将特征值 $\\lambda$ 与我们感兴趣的物理量——增长率 $\\sigma$ 和实部角频率 $\\omega$——之间的关系定义为 $\\lambda = \\sigma - i\\omega$。因此，一旦找到 $\\lambda_{max}$，我们就可以提取出：\n-   增长率：$\\sigma = \\Re(\\lambda_{max})$\n-   角频率：$\\omega = -\\Im(\\lambda_{max})$\n\n相速度 $c_p$ 是波峰传播的速度。它被定义为角频率与波数之比。对于非零波数 $k \\neq 0$，相速度为 $c_p = \\omega/k$。对于空间均匀模态的特殊情况，其中 $k=0$，该模态是非传播的，其相速度定义为 $c_p = 0$。\n\n计算步骤如下：\n1.  对于每个测试案例，使用给定的参数构建复数值矩阵 $\\mathbf{L}$。\n2.  使用数值库（例如 `numpy.linalg.eigvals`）计算 $\\mathbf{L}$ 的两个特征值。\n3.  确定具有最大实部的特征值 $\\lambda_{max}$。\n4.  计算 $\\sigma = \\Re(\\lambda_{max})$ 和 $\\omega = -\\Im(\\lambda_{max})$。\n5.  根据 $k$ 的值使用适当的定义计算 $c_p$。\n6.  为每个测试案例存储并格式化结果对 $(\\sigma, c_p)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the growth rate and phase speed for MJO moisture modes.\n    \"\"\"\n    \n    # Define fixed physical parameters as per the problem statement.\n    alpha = 0.02  # Coupling coefficient\n    beta = 0.001  # Evaporation-wind coupling\n    mu = 1.0e-6   # Linear friction rate [s^-1]\n\n    # Define the test cases, each a tuple of (epsilon, S, k, U).\n    # Units: epsilon [s^-1], S [dimensionless], k [m^-1], U [m/s].\n    k_val = 2 * np.pi / 15_000_000  # Zonal wavenumber for most cases\n\n    test_cases = [\n        # Case A: baseline negative Gross Moist Stability\n        (2.0e-6, -0.5, k_val, 0.0),\n        # Case B: strong damping\n        (5.0e-6, 0.5, k_val, 0.0),\n        # Case C: nearly neutral net precipitation sink\n        (1.5e-6, -1.0, k_val, 0.0),\n        # Case D: strongly negative GMS with weak mean flow\n        (1.2e-6, -2.0, k_val, 1.0),\n        # Case E: non-propagating boundary case\n        (2.0e-6, -0.5, 0.0, 0.0),\n        # Case F: very negative GMS, westward mean wind\n        (1.8e-6, -2.5, k_val, -2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilon, S, k, U = case\n\n        # Construct the 2x2 linear operator matrix L for the (q, u) system.\n        # The eigenvalue problem is L*v = lambda*v.\n        L11 = -epsilon * (1 + S) - 1j * U * k\n        L12 = beta\n        L21 = -1j * alpha * k\n        L22 = -mu\n        \n        L = np.array([[L11, L12], [L21, L22]], dtype=np.complex128)\n\n        # Compute the eigenvalues of the matrix L.\n        eigenvalues = np.linalg.eigvals(L)\n\n        # Select the eigenvalue with the largest real part (most unstable mode).\n        lambda_max = eigenvalues[np.argmax(np.real(eigenvalues))]\n\n        # Extract growth rate (sigma) and angular frequency (omega) from the\n        # definition provided: lambda = sigma - i*omega.\n        sigma = np.real(lambda_max)\n        omega = -np.imag(lambda_max)\n\n        # Calculate phase speed c_p, handling the k=0 case.\n        if k == 0:\n            c_p = 0.0\n        else:\n            c_p = omega / k\n            \n        results.extend([sigma, c_p])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}