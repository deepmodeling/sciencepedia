{
    "hands_on_practices": [
        {
            "introduction": "To design and interpret future climate scenarios, it is essential to first understand the fundamental dynamics of the climate system's response to radiative forcing. This practice problem revisits the one-box Energy Balance Model, a cornerstone of climate science, which simplifies the Earth's climate system to its core components. By analytically solving for the temperature evolution following an abrupt change in forcing, you will gain firsthand experience with the concepts of transient adjustment and equilibrium response, and derive the characteristic timescale, $\\tau$, that governs this process.",
            "id": "4047383",
            "problem": "A commonly used pedagogical and scenario-design tool in future climate projections is the globally averaged one-box energy balance model, which represents the conservation of energy for the mixed-layer ocean–atmosphere system. Let the globally averaged heat capacity be $C$ (in $\\mathrm{J}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$), the net climate feedback parameter be $\\lambda$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$), and the externally imposed radiative forcing be $F(t)$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}$). Energy conservation implies that the global-mean temperature anomaly $T(t)$ (in $\\mathrm{K}$) satisfies $C\\,\\frac{dT}{dt}=F(t)-\\lambda\\,T(t)$.\n\nConsider a scenario-design experiment in which an abrupt forcing step is applied at time $t=0$, representing an idealized transition to a new forcing level used to probe transient and equilibrium responses. Specifically, suppose $F(t)=F_{0}\\,H(t)$, where $F_{0}>0$ is a constant and $H(t)$ is the Heaviside step function. Assume the system is in equilibrium with vanishing anomaly before the step, i.e., $T(t)=0$ for $t\\leq 0$.\n\nStarting from the energy conservation statement above and without using any pre-derived solution formulas, analytically solve for $T(t)$ for $t\\geq 0$. Then define the intrinsic adjustment time scale $\\tau=C/\\lambda$ and compute $T(3\\tau)$. Express the final temperature change in $\\mathrm{K}$. If you choose to leave the final result in closed form, do not approximate it numerically.",
            "solution": "The problem will first be validated against the specified criteria.\n\n### Step 1: Extract Givens\nThe following information is provided in the problem statement:\n-   **Governing Equation**: The global-mean temperature anomaly $T(t)$ is governed by the energy conservation equation $C\\,\\frac{dT}{dt}=F(t)-\\lambda\\,T(t)$.\n-   **Constants and Variables**:\n    -   $C$: globally averaged heat capacity ($\\mathrm{J}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$).\n    -   $\\lambda$: net climate feedback parameter ($\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$).\n    -   $F(t)$: externally imposed radiative forcing ($\\mathrm{W}\\,\\mathrm{m}^{-2}$).\n    -   $T(t)$: global-mean temperature anomaly ($\\mathrm{K}$).\n-   **Forcing Scenario**: The radiative forcing is an abrupt step function, $F(t)=F_{0}\\,H(t)$, where $F_{0}>0$ is a constant and $H(t)$ is the Heaviside step function.\n-   **Initial Condition**: The system is in equilibrium with zero anomaly for $t \\le 0$, i.e., $T(t)=0$ for $t \\le 0$. This implies the specific initial condition $T(0)=0$.\n-   **Objective**:\n    1.  Analytically solve for $T(t)$ for $t\\geq 0$.\n    2.  Define the time scale $\\tau=C/\\lambda$.\n    3.  Compute the value of $T(3\\tau)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated for validity.\n\n-   **Scientifically Grounded**: The one-box energy balance model is a cornerstone of simplified climate dynamics. The equation $C\\,\\frac{dT}{dt}=F(t)-\\lambda\\,T(t)$ is a standard, physically-based formulation representing the balance between heat storage rate ($C\\,\\frac{dT}{dt}$), external energy input ($F(t)$), and radiative damping ($-\\lambda\\,T(t)$), which is a linearization of the Stefan-Boltzmann law. The model is scientifically sound for its intended pedagogical and conceptual purpose.\n-   **Well-Posed**: The problem specifies a first-order linear ordinary differential equation (ODE) with a given forcing function and a well-defined initial condition ($T(0)=0$). This constitutes a well-posed initial value problem, guaranteeing the existence of a unique and stable solution.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology.\n-   **Dimensional Consistency**: The units are consistent. The term $C\\,\\frac{dT}{dt}$ has units of $(\\mathrm{J}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}) \\cdot (\\mathrm{K}\\,\\mathrm{s}^{-1}) = \\mathrm{J}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} = \\mathrm{W}\\,\\mathrm{m}^{-2}$. The forcing term $F(t)$ and the feedback term $\\lambda\\,T(t)$ also have units of $\\mathrm{W}\\,\\mathrm{m}^{-2}$, as required by the equation.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically grounded, well-posed, objective, complete, and consistent.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full analytical solution will now be derived.\n\n### Solution Derivation\nThe governing differential equation is:\n$$C\\,\\frac{dT}{dt}=F(t)-\\lambda\\,T(t)$$\nFor $t \\geq 0$, the forcing is $F(t) = F_{0}\\,H(t) = F_{0}$, since $H(t)=1$ for $t>0$. The equation becomes:\n$$C\\,\\frac{dT}{dt} = F_{0} - \\lambda\\,T(t)$$\nThis is a first-order linear inhomogeneous ordinary differential equation. We can rearrange it into the standard form $\\frac{dy}{dx} + P(x)y = Q(x)$:\n$$\\frac{dT}{dt} + \\frac{\\lambda}{C}\\,T(t) = \\frac{F_{0}}{C}$$\nThis equation can be solved using the method of integrating factors. The integrating factor, $I(t)$, is given by:\n$$I(t) = \\exp\\left(\\int \\frac{\\lambda}{C} \\, dt\\right) = \\exp\\left(\\frac{\\lambda}{C}t\\right)$$\nMultiplying the standard form equation by the integrating factor $I(t)$ yields:\n$$\\exp\\left(\\frac{\\lambda}{C}t\\right)\\frac{dT}{dt} + \\frac{\\lambda}{C}\\exp\\left(\\frac{\\lambda}{C}t\\right)T(t) = \\frac{F_{0}}{C}\\exp\\left(\\frac{\\lambda}{C}t\\right)$$\nThe left-hand side is the derivative of the product $T(t)I(t)$:\n$$\\frac{d}{dt}\\left[T(t)\\exp\\left(\\frac{\\lambda}{C}t\\right)\\right] = \\frac{F_{0}}{C}\\exp\\left(\\frac{\\lambda}{C}t\\right)$$\nIntegrating both sides with respect to $t$:\n$$\\int \\frac{d}{dt}\\left[T(t)\\exp\\left(\\frac{\\lambda}{C}t\\right)\\right] dt = \\int \\frac{F_{0}}{C}\\exp\\left(\\frac{\\lambda}{C}t\\right) dt$$\n$$T(t)\\exp\\left(\\frac{\\lambda}{C}t\\right) = \\frac{F_{0}}{C} \\left(\\frac{C}{\\lambda}\\right) \\exp\\left(\\frac{\\lambda}{C}t\\right) + K$$\nwhere $K$ is the constant of integration.\n$$T(t)\\exp\\left(\\frac{\\lambda}{C}t\\right) = \\frac{F_{0}}{\\lambda}\\exp\\left(\\frac{\\lambda}{C}t\\right) + K$$\nSolving for $T(t)$ by multiplying by $\\exp\\left(-\\frac{\\lambda}{C}t\\right)$:\n$$T(t) = \\frac{F_{0}}{\\lambda} + K\\exp\\left(-\\frac{\\lambda}{C}t\\right)$$\nTo determine the constant $K$, we apply the initial condition $T(0)=0$.\n$$T(0) = 0 = \\frac{F_{0}}{\\lambda} + K\\exp(0)$$\n$$0 = \\frac{F_{0}}{\\lambda} + K \\implies K = -\\frac{F_{0}}{\\lambda}$$\nSubstituting this value of $K$ back into the general solution gives the particular solution for $T(t)$ for $t \\geq 0$:\n$$T(t) = \\frac{F_{0}}{\\lambda} - \\frac{F_{0}}{\\lambda}\\exp\\left(-\\frac{\\lambda}{C}t\\right)$$\n$$T(t) = \\frac{F_{0}}{\\lambda}\\left(1 - \\exp\\left(-\\frac{\\lambda}{C}t\\right)\\right)$$\nThis is the analytical solution for the temperature anomaly as a function of time.\n\nNext, we define the intrinsic adjustment time scale $\\tau = C/\\lambda$. We can substitute this into the solution for $T(t)$:\n$$T(t) = \\frac{F_{0}}{\\lambda}\\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)$$\nThe problem requires the computation of $T(3\\tau)$. We substitute $t=3\\tau$ into this expression:\n$$T(3\\tau) = \\frac{F_{0}}{\\lambda}\\left(1 - \\exp\\left(-\\frac{3\\tau}{\\tau}\\right)\\right)$$\n$$T(3\\tau) = \\frac{F_{0}}{\\lambda}\\left(1 - \\exp(-3)\\right)$$\nThis is the final analytical expression for the temperature anomaly at time $t=3\\tau$. The units are Kelvins ($\\mathrm{K}$), as specified for $T(t)$.",
            "answer": "$$\\boxed{\\frac{F_{0}}{\\lambda}\\left(1 - \\exp(-3)\\right)}$$"
        },
        {
            "introduction": "Projections of global mean temperature are a crucial first step, but the ultimate goal is often to understand their impacts on the Earth system, such as sea level rise. This exercise takes a given transient warming trajectory, $\\Delta T(t)$, and challenges you to construct a projection for total sea level change by combining two distinct physical processes: the thermal expansion of seawater and the melting of land glaciers. This practice introduces the use of linear response functions and convolution integrals, powerful methods for modeling how different components of the climate system react to change over time.",
            "id": "4047338",
            "problem": "Consider the problem of projecting global mean sea level change due to thermal expansion of seawater (steric contribution) and land glacier mass loss under a prescribed warming trajectory. Let the global mean surface air temperature anomaly relative to a preindustrial baseline be $\\Delta T(t)$, and suppose that under a chosen scenario design the climate response can be approximated as a single-exponential approach to a new equilibrium,\n$$\n\\Delta T(t)=\\Delta T_{\\infty}\\left(1-\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right)\\right),\n$$\nwith $\\Delta T_{\\infty}>0$ the long-term warming level and $\\tau_T>0$ the characteristic climate adjustment time. Assume the steric sea level contribution scales linearly with temperature anomaly via $\\Delta h_{\\text{steric}}(t)=\\gamma\\,\\Delta T(t)$ with $\\gamma>0$, and model the glacier contribution as a linear time-invariant response with impulse response (Green’s function)\n$$\nG_g(t)=\\frac{1}{\\tau_g}\\exp\\!\\left(-\\frac{t}{\\tau_g}\\right)\\,H(t),\n$$\nwhere $\\tau_g>0$ is the glacier response time and $H(t)$ is the Heaviside step function. Let the glacier height contribution be given by the convolution\n$$\n\\Delta h_{\\text{gl}}(t)=\\alpha\\int_{0}^{t}G_g(t-s)\\,\\Delta T(s)\\,\\mathrm{d}s,\n$$\nwith $\\alpha>0$ a sensitivity parameter. The total sea level change is the sum $\\Delta h(t)=\\Delta h_{\\text{steric}}(t)+\\Delta h_{\\text{gl}}(t)$.\n\nStarting from linear systems theory and conservation of mass and volume, and using only the definitions given above, derive a closed-form analytic expression for the combined projection $\\Delta h(t)$ valid for $\\tau_T\\neq \\tau_g$. Express your final answer as a single explicit function of $t$, $\\Delta T_{\\infty}$, $\\tau_T$, $\\tau_g$, $\\gamma$, and $\\alpha$. No numerical evaluation is required. Express $\\Delta h(t)$ in meters. No rounding is necessary.",
            "solution": "The total sea level change is the sum of the steric and glacier contributions:\n$$ \\Delta h(t) = \\Delta h_{\\text{steric}}(t) + \\Delta h_{\\text{gl}}(t) $$\nFirst, we write down the steric contribution using its definition and the given temperature trajectory:\n$$ \\Delta h_{\\text{steric}}(t) = \\gamma\\,\\Delta T(t) = \\gamma \\Delta T_{\\infty}\\left(1-\\exp\\left(-\\frac{t}{\\tau_T}\\right)\\right) $$\nNext, we calculate the glacier contribution by solving the convolution integral:\n$$ \\Delta h_{\\text{gl}}(t)=\\alpha\\int_{0}^{t}G_g(t-s)\\,\\Delta T(s)\\,\\mathrm{d}s $$\nSubstitute the given functions for the Green's function $G_g$ and the temperature anomaly $\\Delta T$:\n$$ \\Delta h_{\\text{gl}}(t) = \\alpha \\int_{0}^{t} \\left[ \\frac{1}{\\tau_g}\\exp\\left(-\\frac{t-s}{\\tau_g}\\right) \\right] \\left[ \\Delta T_{\\infty}\\left(1-\\exp\\left(-\\frac{s}{\\tau_T}\\right)\\right) \\right] \\mathrm{d}s $$\nWe can pull the constants and the term dependent on $t$ out of the integral:\n$$ \\Delta h_{\\text{gl}}(t) = \\frac{\\alpha \\Delta T_{\\infty}}{\\tau_g} \\exp\\left(-\\frac{t}{\\tau_g}\\right) \\int_{0}^{t} \\exp\\left(\\frac{s}{\\tau_g}\\right) \\left(1-\\exp\\left(-\\frac{s}{\\tau_T}\\right)\\right) \\mathrm{d}s $$\nExpand the integrand:\n$$ \\Delta h_{\\text{gl}}(t) = \\frac{\\alpha \\Delta T_{\\infty}}{\\tau_g} \\exp\\left(-\\frac{t}{\\tau_g}\\right) \\int_{0}^{t} \\left( \\exp\\left(\\frac{s}{\\tau_g}\\right) - \\exp\\left(s\\left(\\frac{1}{\\tau_g} - \\frac{1}{\\tau_T}\\right)\\right) \\right) \\mathrm{d}s $$\nPerform the integration with respect to $s$:\n$$ \\int_{0}^{t} \\exp\\left(\\frac{s}{\\tau_g}\\right) \\mathrm{d}s = \\left[ \\tau_g \\exp\\left(\\frac{s}{\\tau_g}\\right) \\right]_0^t = \\tau_g \\left( \\exp\\left(\\frac{t}{\\tau_g}\\right) - 1 \\right) $$\n$$ \\int_{0}^{t} \\exp\\left(s\\frac{\\tau_T - \\tau_g}{\\tau_g \\tau_T}\\right) \\mathrm{d}s = \\left[ \\frac{\\tau_g \\tau_T}{\\tau_T - \\tau_g} \\exp\\left(s\\frac{\\tau_T - \\tau_g}{\\tau_g \\tau_T}\\right) \\right]_0^t = \\frac{\\tau_g \\tau_T}{\\tau_T - \\tau_g} \\left( \\exp\\left(t\\left(\\frac{1}{\\tau_g}-\\frac{1}{\\tau_T}\\right)\\right) - 1 \\right) $$\nSubstitute these results back into the expression for $\\Delta h_{\\text{gl}}(t)$:\n$$ \\Delta h_{\\text{gl}}(t) = \\frac{\\alpha \\Delta T_{\\infty}}{\\tau_g} \\exp\\left(-\\frac{t}{\\tau_g}\\right) \\left[ \\tau_g\\left(\\exp\\left(\\frac{t}{\\tau_g}\\right)-1\\right) - \\frac{\\tau_g \\tau_T}{\\tau_T-\\tau_g}\\left(\\exp\\left(\\frac{t}{\\tau_g}\\right)\\exp\\left(-\\frac{t}{\\tau_T}\\right)-1\\right) \\right] $$\nDistribute the prefactors and simplify:\n$$ \\Delta h_{\\text{gl}}(t) = \\alpha \\Delta T_{\\infty} \\left[ \\left(1 - \\exp\\left(-\\frac{t}{\\tau_g}\\right)\\right) - \\frac{\\tau_T}{\\tau_T-\\tau_g}\\left(\\exp\\left(-\\frac{t}{\\tau_T}\\right) - \\exp\\left(-\\frac{t}{\\tau_g}\\right)\\right) \\right] $$\n$$ \\Delta h_{\\text{gl}}(t) = \\alpha \\Delta T_{\\infty} \\left[ 1 - \\exp\\left(-\\frac{t}{\\tau_g}\\right) - \\frac{\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right] $$\nCollect terms with the same exponential functions:\n$$ \\Delta h_{\\text{gl}}(t) = \\alpha \\Delta T_{\\infty} \\left[ 1 - \\frac{\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\left(\\frac{\\tau_T}{\\tau_T-\\tau_g}-1\\right)\\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right] $$\n$$ \\Delta h_{\\text{gl}}(t) = \\alpha \\Delta T_{\\infty} \\left[ 1 - \\frac{\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\tau_g}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right] $$\nNow, we add the steric and glacier contributions to find the total sea level change $\\Delta h(t)$:\n$$ \\Delta h(t) = \\gamma \\Delta T_{\\infty}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_T}\\right)\\right) + \\alpha \\Delta T_{\\infty} \\left( 1 - \\frac{\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\tau_g}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right) $$\nFinally, we group terms by constants and the exponential functions to obtain the closed-form expression:\n$$ \\Delta h(t) = \\Delta T_{\\infty} \\left[ (\\alpha+\\gamma) - \\gamma\\exp\\left(-\\frac{t}{\\tau_T}\\right) - \\frac{\\alpha\\tau_T}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\alpha\\tau_g}{\\tau_T-\\tau_g}\\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right] $$\n$$ \\Delta h(t) = \\Delta T_{\\infty} \\left( \\alpha+\\gamma - \\left( \\gamma + \\frac{\\alpha\\tau_T}{\\tau_T - \\tau_g} \\right) \\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\alpha\\tau_g}{\\tau_T - \\tau_g} \\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right) $$",
            "answer": "$$\n\\boxed{\\Delta T_{\\infty} \\left( \\alpha+\\gamma - \\left( \\gamma + \\frac{\\alpha\\tau_T}{\\tau_T - \\tau_g} \\right) \\exp\\left(-\\frac{t}{\\tau_T}\\right) + \\frac{\\alpha\\tau_g}{\\tau_T - \\tau_g} \\exp\\left(-\\frac{t}{\\tau_g}\\right) \\right)}\n$$"
        },
        {
            "introduction": "While simple models provide theoretical insight, much of modern climate science involves analyzing the output of complex General Circulation Models (GCMs). This practice simulates this process by providing synthetic data from a model experiment and asks you to play the role of a climate scientist diagnosing the model's fundamental properties. By applying a standard technique known as Gregory regression, you will estimate the model's effective radiative forcing and climate feedback parameter, $\\lambda$, and from them, derive the crucial metric of Equilibrium Climate Sensitivity (ECS) along with its statistical uncertainty.",
            "id": "4047350",
            "problem": "You are provided with synthetic global annual-mean time series for the top-of-atmosphere net radiative imbalance $N(t)$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}$) and global-mean surface temperature anomaly $T(t)$ (in $\\mathrm{K}$) from a set of abrupt forcing model experiments. Your task is to estimate the climate feedback parameter $\\lambda$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$) and the effective radiative forcing for a doubling of carbon dioxide $F_{2\\times \\mathrm{CO}_2}$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}$) using a Gregory regression, and to quantify uncertainty in the Equilibrium Climate Sensitivity (ECS), defined as the equilibrium temperature anomaly (in $\\mathrm{K}$) where the net radiative imbalance returns to zero under the imposed forcing.\n\nFundamental base:\n- Conservation of energy at the top of the atmosphere implies that the net radiative imbalance $N(t)$ is equal to the rate of change of planetary heat content, which is nonnegative when the system is gaining heat. Under an externally imposed step change in radiative forcing (such as a sudden doubling of carbon dioxide), widely used linear feedback approximations relate the externally imposed forcing to the radiative response to temperature.\n- In a one-box energy balance framework, the transient evolution of $T(t)$ following a step forcing is well-approximated by an exponential approach to an equilibrium value characterized by a single e-folding timescale.\n\nThe synthetic data are generated as follows for each test case $i$:\n- Parameters $(F_i, \\lambda_i, \\tau_i, n_i, \\sigma_{T,i}, \\sigma_{N,i}, s_i)$ are given, where $F_i$ is the imposed effective radiative forcing in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, $\\lambda_i$ is the climate feedback parameter in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$, $\\tau_i$ is the characteristic e-folding timescale in $\\mathrm{yr}$, $n_i$ is the number of years, $\\sigma_{T,i}$ is the standard deviation of internal variability noise in temperature in $\\mathrm{K}$, $\\sigma_{N,i}$ is the standard deviation of internal variability noise in net imbalance in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, and $s_i$ is a random seed for reproducibility.\n- Define $T_{\\mathrm{eq},i} = F_i / \\lambda_i$ (in $\\mathrm{K}$).\n- For integers $t = 1, 2, \\dots, n_i$ (in $\\mathrm{yr}$),\n  - Draw independent Gaussian noises $\\eta_t \\sim \\mathcal{N}(0, \\sigma_{T,i}^2)$ and $\\xi_t \\sim \\mathcal{N}(0, \\sigma_{N,i}^2)$ using the seed $s_i$ to initialize the random number generator.\n  - Set $T_i(t) = T_{\\mathrm{eq},i}\\left(1 - \\exp\\left(-t / \\tau_i\\right)\\right) + \\eta_t$ (in $\\mathrm{K}$).\n  - Set $N_i(t) = F_i - \\lambda_i T_i(t) + \\xi_t$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}$).\n\nTasks:\n1. For each test case, perform a Gregory regression by fitting a straight line to the scatter of $(T_i(t), N_i(t))$ via ordinary least squares, with $N_i(t)$ as the response and $T_i(t)$ as the predictor, using the model $N_i(t) = a_i + b_i T_i(t) + \\varepsilon_t$ where $\\varepsilon_t$ captures residual variability. From the fitted coefficients, interpret $\\hat{F}_i = a_i$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}$) and $\\hat{\\lambda}_i = -b_i$ (in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$).\n2. Estimate the Equilibrium Climate Sensitivity for each test case as $\\widehat{\\mathrm{ECS}}_i = \\hat{F}_i / \\hat{\\lambda}_i$ (in $\\mathrm{K}$). Quantify uncertainty in $\\widehat{\\mathrm{ECS}}_i$ by propagating the ordinary least squares parameter uncertainty of $(a_i, b_i)$ using the first-order (delta method) normal approximation to obtain a two-sided $95\\%$ confidence interval $[\\mathrm{ECS}^{\\mathrm{L}}_i, \\mathrm{ECS}^{\\mathrm{U}}_i]$ (in $\\mathrm{K}$). Express the lower and upper bounds as decimals.\n3. For each test case, report the five quantities $[\\hat{\\lambda}_i, \\hat{F}_i, \\widehat{\\mathrm{ECS}}_i, \\mathrm{ECS}^{\\mathrm{L}}_i, \\mathrm{ECS}^{\\mathrm{U}}_i]$ with each value rounded to three decimal places.\n\nTest suite:\n- Case $1$: $(F_1, \\lambda_1, \\tau_1, n_1, \\sigma_{T,1}, \\sigma_{N,1}, s_1) = (3.71, 1.00, 4.00, 60, 0.05, 0.15, 17)$.\n- Case $2$: $(F_2, \\lambda_2, \\tau_2, n_2, \\sigma_{T,2}, \\sigma_{N,2}, s_2) = (3.50, 1.20, 3.00, 50, 0.00, 0.00, 0)$.\n- Case $3$: $(F_3, \\lambda_3, \\tau_3, n_3, \\sigma_{T,3}, \\sigma_{N,3}, s_3) = (3.80, 0.90, 10.00, 15, 0.10, 0.30, 123)$.\n\nPhysical units:\n- Report $\\hat{\\lambda}_i$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$.\n- Report $\\hat{F}_i$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n- Report $\\widehat{\\mathrm{ECS}}_i$, $\\mathrm{ECS}^{\\mathrm{L}}_i$, and $\\mathrm{ECS}^{\\mathrm{U}}_i$ in $\\mathrm{K}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a bracketed list in the order $[\\hat{\\lambda}_i, \\hat{F}_i, \\widehat{\\mathrm{ECS}}_i, \\mathrm{ECS}^{\\mathrm{L}}_i, \\mathrm{ECS}^{\\mathrm{U}}_i]$. For example, the output should look like $[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],[z_1,z_2,z_3,z_4,z_5]]$ with each value rounded to three decimal places as specified.",
            "solution": "We base the analysis on planetary energy balance and linear radiative feedback concepts used in climate modeling. The top-of-atmosphere net radiative imbalance $N(t)$ represents the net energy flux into the Earth system at time $t$, and conservation of energy implies $N(t)$ equals the rate of change of heat content. Under an externally imposed step increase in radiative forcing, many comprehensive climate models and simple energy balance models exhibit an approximately linear relationship between the externally imposed forcing and the radiative response to surface temperature changes. This motivates treating the relation between $N(t)$ and $T(t)$ as approximately linear during the transient response.\n\nStarting point: Under a step forcing $F$ at $t = 0$, a one-box energy balance model with effective heat capacity $C$ and climate feedback parameter $\\lambda$ obeys\n$$\nC \\frac{dT}{dt} = F - \\lambda T.\n$$\nThis ordinary differential equation has the solution\n$$\nT(t) = T_{\\mathrm{eq}}\\left(1 - e^{-t/\\tau}\\right),\n$$\nwhere $T_{\\mathrm{eq}} = \\frac{F}{\\lambda}$ is the equilibrium temperature anomaly and $\\tau = \\frac{C}{\\lambda}$ is the characteristic e-folding timescale. During the transient adjustment, the net radiative imbalance can be decomposed into the externally imposed forcing minus the linearized feedback response proportional to the temperature anomaly. Accounting for internal variability as stochastic noise, we consider synthetic observables generated by\n$$\nT(t) = T_{\\mathrm{eq}}\\left(1 - e^{-t/\\tau}\\right) + \\eta_t,\\quad \\eta_t \\sim \\mathcal{N}(0,\\sigma_T^2),\n$$\n$$\nN(t) = F - \\lambda T(t) + \\xi_t,\\quad \\xi_t \\sim \\mathcal{N}(0,\\sigma_N^2),\n$$\nwith $\\eta_t$ and $\\xi_t$ independent. This construction ensures scientific realism by satisfying the energy balance structure and by approaching $N(t) \\to 0$ as $t \\to \\infty$ (in the absence of noise), while including plausible internal variability.\n\nGregory regression: The Gregory method regresses $N(t)$ against $T(t)$ to estimate the effective forcing and the feedback. We fit the linear model\n$$\nN(t) = a + b\\,T(t) + \\varepsilon_t,\n$$\nusing ordinary least squares, where $a$ is the intercept, $b$ is the slope, and $\\varepsilon_t$ is a residual term. Interpreting the physical parameters from the regression,\n$$\n\\hat{F} = a,\\quad \\hat{\\lambda} = -b,\n$$\nbecause the underlying physical relation is approximately $N \\approx F - \\lambda T$. The Equilibrium Climate Sensitivity, defined as the equilibrium temperature anomaly at which $N = 0$, is\n$$\n\\widehat{\\mathrm{ECS}} = \\frac{\\hat{F}}{\\hat{\\lambda}}.\n$$\n\nOrdinary least squares estimation: Let $y \\in \\mathbb{R}^n$ denote the vector of $N(t)$ and $x \\in \\mathbb{R}^n$ denote the vector of $T(t)$ over $n$ years. Define the design matrix\n$$\nX = \\begin{bmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_n \\end{bmatrix},\n$$\nthe parameter vector $\\beta = \\begin{bmatrix} a \\\\ b \\end{bmatrix}$, and model $y = X \\beta + \\varepsilon$. The ordinary least squares estimator is\n$$\n\\hat{\\beta} = (X^\\top X)^{-1} X^\\top y,\n$$\nyielding $\\hat{a}$ and $\\hat{b}$. The residuals are $r = y - X \\hat{\\beta}$, and the residual variance is estimated by\n$$\n\\hat{\\sigma}^2 = \\frac{r^\\top r}{n - p},\n$$\nwhere $p = 2$ is the number of parameters. The estimated covariance matrix of $\\hat{\\beta}$ is\n$$\n\\widehat{\\mathrm{Cov}}(\\hat{\\beta}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}.\n$$\n\nUncertainty quantification for $\\widehat{\\mathrm{ECS}}$: The ECS estimator is a smooth function of $(\\hat{a}, \\hat{b})$:\n$$\ng(\\hat{a}, \\hat{b}) = \\frac{\\hat{F}}{\\hat{\\lambda}} = \\frac{\\hat{a}}{-\\hat{b}} = -\\frac{\\hat{a}}{\\hat{b}}.\n$$\nBy the delta method (first-order Taylor approximation), the variance of $g(\\hat{a}, \\hat{b})$ is approximated by\n$$\n\\mathrm{Var}\\left(g(\\hat{a}, \\hat{b})\\right) \\approx \\nabla g^\\top \\, \\widehat{\\mathrm{Cov}}(\\hat{\\beta}) \\, \\nabla g,\n$$\nwhere the gradient is\n$$\n\\nabla g = \\begin{bmatrix} \\frac{\\partial g}{\\partial \\hat{a}} \\\\ \\frac{\\partial g}{\\partial \\hat{b}} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{\\hat{b}} \\\\ \\frac{\\hat{a}}{\\hat{b}^2} \\end{bmatrix}.\n$$\nThus,\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{\\mathrm{ECS}}) = \\sqrt{\\mathrm{Var}\\left(g(\\hat{a}, \\hat{b})\\right)}.\n$$\nAssuming asymptotic normality of $(\\hat{a}, \\hat{b})$, a two-sided $95\\%$ confidence interval for ECS is\n$$\n\\left[\\widehat{\\mathrm{ECS}} - 1.96\\,\\widehat{\\mathrm{SE}}(\\widehat{\\mathrm{ECS}}),\\ \\widehat{\\mathrm{ECS}} + 1.96\\,\\widehat{\\mathrm{SE}}(\\widehat{\\mathrm{ECS}})\\right].\n$$\n\nAlgorithmic steps for each test case:\n1. Generate $T(t)$ and $N(t)$ sequences using the provided $(F, \\lambda, \\tau, n, \\sigma_T, \\sigma_N, s)$ according to the equations above, ensuring independent Gaussian noise terms with the specified standard deviations and random seed.\n2. Construct $X$ and compute $\\hat{\\beta} = (\\hat{a}, \\hat{b})^\\top$ via ordinary least squares using the normal equations.\n3. Compute $\\hat{F} = \\hat{a}$ and $\\hat{\\lambda} = -\\hat{b}$.\n4. Compute $\\widehat{\\mathrm{ECS}} = \\hat{F} / \\hat{\\lambda}$.\n5. Compute $\\widehat{\\mathrm{Cov}}(\\hat{\\beta})$ from the residual variance and $(X^\\top X)^{-1}$.\n6. Compute the gradient $\\nabla g$ at $(\\hat{a}, \\hat{b})$, the standard error via the delta method, and the $95\\%$ confidence interval bounds.\n7. Round $\\hat{\\lambda}$, $\\hat{F}$, $\\widehat{\\mathrm{ECS}}$, and the lower and upper confidence bounds to three decimal places.\n8. Aggregate the results for all test cases into the single-line output format specified: a bracketed, comma-separated list of lists, one per test case, in the order $[\\hat{\\lambda}, \\hat{F}, \\widehat{\\mathrm{ECS}}, \\mathrm{ECS}^{\\mathrm{L}}, \\mathrm{ECS}^{\\mathrm{U}}]$.\n\nThis design cleanly integrates the physical basis (energy balance and linear feedback), the statistical estimator (ordinary least squares), and uncertainty quantification (delta method), producing scientifically interpretable estimates with quantified uncertainty for ECS from transient model experiment data.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_synthetic_data(F, lam, tau, n_years, sigma_T, sigma_N, seed):\n    \"\"\"\n    Generate synthetic annual mean time series T(t) [K] and N(t) [W/m^2]\n    following a one-box EBM transient with internal variability noise.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    t = np.arange(1, n_years + 1, dtype=float)  # years since forcing\n    T_eq = F / lam  # equilibrium temperature [K]\n    T_clean = T_eq * (1.0 - np.exp(-t / tau))\n    # Draw independent noise sequences\n    eta = rng.normal(0.0, sigma_T, size=n_years) if sigma_T > 0 else np.zeros(n_years)\n    xi = rng.normal(0.0, sigma_N, size=n_years) if sigma_N > 0 else np.zeros(n_years)\n    T = T_clean + eta\n    N = F - lam * T + xi\n    return T, N\n\ndef ols_regression_with_cov(x, y):\n    \"\"\"\n    Perform OLS regression of y on x with intercept: y = a + b x + eps.\n    Returns a_hat, b_hat, cov_beta (2x2 covariance matrix), residual variance.\n    \"\"\"\n    n = len(x)\n    X = np.column_stack([np.ones(n), x])\n    # OLS solution\n    XtX = X.T @ X\n    XtX_inv = np.linalg.inv(XtX)\n    beta_hat = XtX_inv @ (X.T @ y)\n    a_hat, b_hat = beta_hat[0], beta_hat[1]\n    # Residuals and variance estimate\n    residuals = y - X @ beta_hat\n    dof = n - 2  # two parameters\n    # If dof <= 0 (n < 2), avoid division by zero: set variance to NaN\n    if dof > 0:\n        sigma2_hat = (residuals @ residuals) / dof\n    else:\n        sigma2_hat = np.nan\n    cov_beta = sigma2_hat * XtX_inv\n    return a_hat, b_hat, cov_beta, sigma2_hat\n\ndef ecs_with_uncertainty(a_hat, b_hat, cov_beta):\n    \"\"\"\n    Compute ECS = -a_hat / b_hat and 95% CI using delta method.\n    cov_beta is 2x2 covariance matrix of [a, b].\n    Returns ECS_hat, ECS_lower, ECS_upper.\n    \"\"\"\n    # Map to physical parameters\n    F_hat = a_hat\n    lam_hat = -b_hat\n    # ECS estimate\n    ecs_hat = F_hat / lam_hat  # = -a_hat / b_hat\n    # Delta method: g(a,b) = -a/b\n    # gradient: [-1/b, a/b^2]\n    # Handle potential near-zero b_hat\n    if np.isfinite(cov_beta).all() and b_hat != 0.0:\n        grad = np.array([-1.0 / b_hat, a_hat / (b_hat ** 2)])\n        var_g = grad @ cov_beta @ grad\n        # Numerical safety: var_g should be non-negative\n        if var_g < 0:\n            # Clamp to zero if negative due to numerical round-off\n            var_g = 0.0\n        se_g = np.sqrt(var_g)\n        lower = ecs_hat - 1.96 * se_g\n        upper = ecs_hat + 1.96 * se_g\n    else:\n        # If covariance is invalid or slope is zero, return NaNs for CI\n        lower = np.nan\n        upper = np.nan\n    return ecs_hat, lower, upper\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (F [W/m^2], lambda [W/m^2/K], tau [yr], n_years, sigma_T [K], sigma_N [W/m^2], seed)\n    test_cases = [\n        (3.71, 1.00, 4.00, 60, 0.05, 0.15, 17),\n        (3.50, 1.20, 3.00, 50, 0.00, 0.00, 0),\n        (3.80, 0.90, 10.00, 15, 0.10, 0.30, 123),\n    ]\n\n    results = []\n    for F, lam, tau, n, sigma_T, sigma_N, seed in test_cases:\n        # Generate synthetic data for this case\n        T, N = generate_synthetic_data(F, lam, tau, n, sigma_T, sigma_N, seed)\n        # Perform OLS regression: N = a + b T\n        a_hat, b_hat, cov_beta, _ = ols_regression_with_cov(T, N)\n        # Map to physical parameters\n        F_hat = a_hat\n        lam_hat = -b_hat\n        # Compute ECS and uncertainty\n        ecs_hat, ecs_lower, ecs_upper = ecs_with_uncertainty(a_hat, b_hat, cov_beta)\n        # Round to three decimals as specified\n        vals = [\n            round(lam_hat, 3),\n            round(F_hat, 3),\n            round(ecs_hat, 3),\n            round(ecs_lower, 3) if np.isfinite(ecs_lower) else float('nan'),\n            round(ecs_upper, 3) if np.isfinite(ecs_upper) else float('nan'),\n        ]\n        results.append(vals)\n\n    # Final print statement in the exact required format.\n    # Produce a single line: a bracketed comma-separated list of lists.\n    def fmt_list(lst):\n        return \"[\" + \",\".join(map(lambda v: \"nan\" if (isinstance(v, float) and np.isnan(v)) else f\"{v}\", lst)) + \"]\"\n\n    print(\"[\" + \",\".join(fmt_list(res) for res in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}