{
    "hands_on_practices": [
        {
            "introduction": "This practice explores the fundamental reason for large-scale atmospheric and oceanic circulation: the differential heating of the planet by the sun. By calculating the top-of-atmosphere net radiation for an idealized aquaplanet, you will derive the implied meridional energy transport required to maintain equilibrium. This foundational exercise  hones skills in applying mathematical physics to understand the climate system's primary energetic driver.",
            "id": "4011855",
            "problem": "Consider an idealized aquaplanet in annual-mean radiative equilibrium with zonal symmetry. Let latitude be denoted by $\\phi$ (in radians), planetary radius by $a$, and planetary albedo by $A$ (assumed constant in latitude). The zonal-mean insolation at the top of the atmosphere is prescribed as\n$$\nS(\\phi) = S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right],\n$$\nwhere $S_{0}$ is the global-mean insolation, $s_{2}$ is a dimensionless amplitude parameter, and $P_{2}(x)$ is the second Legendre polynomial defined by $P_{2}(x) = \\frac{1}{2}\\left(3x^{2} - 1\\right)$. Assume that the atmosphere-surface system has a constant planetary albedo $A$, so the absorbed shortwave radiation is $(1 - A)\\,S(\\phi)$. Assume further that the Outgoing Longwave Radiation (OLR) is spatially uniform and equal to $O_{0}$, determined by the requirement of global-mean steady-state energy balance. Under the steady-state, zonally symmetric, vertically integrated moist static energy budget with negligible storage and surface heat uptake, the divergence of the meridional energy flux equals the top-of-atmosphere net radiation.\n\nUsing only these assumptions and definitions:\n- Compute the top-of-atmosphere net radiation $R_{\\mathrm{TOA}}(\\phi)$.\n- Derive the implied meridional energy flux divergence and the corresponding total northward meridional energy transport $H(\\phi)$ (in watts) across the latitude circle at $\\phi$.\n\nProvide the final answer as a single closed-form analytic expression for $H(\\phi)$ in terms of $a$, $A$, $S_{0}$, $s_{2}$, and $\\phi$. Angles must be treated in radians. Do not perform any numerical substitutions.",
            "solution": "The problem is valid as it represents a standard, well-posed problem in introductory climate dynamics based on established physical and mathematical principles. We will proceed with its solution.\n\nThe primary goal is to derive the total northward meridional energy transport, $H(\\phi)$. This requires first determining the top-of-atmosphere net radiation, $R_{\\mathrm{TOA}}(\\phi)$, which in turn requires determining the Outgoing Longwave Radiation, $O_{0}$.\n\n**Step 1: Determine the Outgoing Longwave Radiation, $O_{0}$**\n\nThe top-of-atmosphere net radiation $R_{\\mathrm{TOA}}(\\phi)$ is the difference between the absorbed shortwave radiation (ASR) and the outgoing longwave radiation (OLR).\nThe ASR is given by $(1 - A)S(\\phi)$, where $A$ is the albedo and $S(\\phi)$ is the insolation. The OLR is given as a constant, $O_{0}$.\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S(\\phi) - O_{0}\n$$\nThe problem states that $O_{0}$ is determined by the requirement of global-mean steady-state energy balance. This means the global average of $R_{\\mathrm{TOA}}(\\phi)$ must be zero. We denote the global average of a quantity $f(\\phi)$ by $\\langle f \\rangle$.\n$$\n\\langle R_{\\mathrm{TOA}}(\\phi) \\rangle = 0\n$$\nThe global average over a sphere for a zonally symmetric quantity $f(\\phi)$ is calculated as:\n$$\n\\langle f \\rangle = \\frac{\\int_{-\\pi/2}^{\\pi/2} f(\\phi) \\cos\\phi \\, d\\phi}{\\int_{-\\pi/2}^{\\pi/2} \\cos\\phi \\, d\\phi} = \\frac{1}{2} \\int_{-\\pi/2}^{\\pi/2} f(\\phi) \\cos\\phi \\, d\\phi\n$$\nApplying this to the energy balance equation:\n$$\n\\langle (1 - A)S(\\phi) - O_{0} \\rangle = (1-A)\\langle S(\\phi) \\rangle - \\langle O_{0} \\rangle = 0\n$$\nSince $O_{0}$ is a constant, its global average is simply $O_{0}$. Therefore:\n$$\nO_{0} = (1 - A)\\langle S(\\phi) \\rangle\n$$\nWe now compute $\\langle S(\\phi) \\rangle$ using the given expression $S(\\phi) = S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right]$:\n$$\n\\langle S(\\phi) \\rangle = \\left\\langle S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right] \\right\\rangle = S_{0} \\langle 1 \\rangle - S_{0}s_{2} \\langle P_{2}(\\sin\\phi) \\rangle\n$$\nThe average of a constant is the constant itself, so $\\langle 1 \\rangle = 1$. The average of the Legendre polynomial term is:\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = \\frac{1}{2} \\int_{-\\pi/2}^{\\pi/2} P_{2}(\\sin\\phi) \\cos\\phi \\, d\\phi\n$$\nLet $x = \\sin\\phi$. Then $dx = \\cos\\phi \\, d\\phi$. The limits of integration change from $\\phi \\in [-\\pi/2, \\pi/2]$ to $x \\in [-1, 1]$.\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = \\frac{1}{2} \\int_{-1}^{1} P_{2}(x) \\, dx\n$$\nLegendre polynomials $P_n(x)$ are orthogonal on the interval $[-1, 1]$ with respect to the weight function $1$. The orthogonality relation is $\\int_{-1}^{1} P_n(x)P_m(x) dx = \\frac{2}{2n+1}\\delta_{nm}$. We can write the integral as $\\int_{-1}^{1} P_{2}(x) P_{0}(x) dx$, since $P_{0}(x) = 1$. As $n=2$ and $m=0$ are not equal, the integral is zero.\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = 0\n$$\nThis simplifies the expression for the global-mean insolation to $\\langle S(\\phi) \\rangle = S_{0}$. This confirms that $S_{0}$ is indeed the global-mean insolation. Substituting this into the equation for $O_{0}$:\n$$\nO_{0} = (1 - A)S_{0}\n$$\n\n**Step 2: Compute the Top-of-Atmosphere Net Radiation, $R_{\\mathrm{TOA}}(\\phi)$**\n\nNow that we have $O_{0}$, we can write the full expression for $R_{\\mathrm{TOA}}(\\phi)$:\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S(\\phi) - O_{0} = (1 - A)S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right] - (1 - A)S_{0}\n$$\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S_{0} - (1 - A)S_{0}s_{2}P_{2}(\\sin\\phi) - (1 - A)S_{0}\n$$\n$$\nR_{\\mathrm{TOA}}(\\phi) = -(1 - A)S_{0}s_{2}P_{2}(\\sin\\phi)\n$$\n\n**Step 3: Derive the Northward Meridional Energy Transport, $H(\\phi)$**\n\nThe problem states that the divergence of the meridional energy flux equals the top-of-atmosphere net radiation. Let $H(\\phi)$ be the total northward transport of energy (in Watts) across the latitude circle at $\\phi$. The energy balance for a polar cap north of latitude $\\phi$ requires that the northward transport into the cap, $H(\\phi)$, must balance the net loss of energy to space from that cap. An equivalent statement relates the divergence of the transport to the local net radiation. For a zonal band of width $a\\,d\\phi$ and length $2\\pi a \\cos\\phi$, the divergence of flux is given by:\n$$\n\\frac{1}{2\\pi a^2 \\cos\\phi} \\frac{dH(\\phi)}{d\\phi} = R_{\\mathrm{TOA}}(\\phi)\n$$\nRearranging to solve for $H(\\phi)$ by integration:\n$$\n\\frac{dH(\\phi)}{d\\phi} = 2\\pi a^2 \\cos\\phi \\, R_{\\mathrm{TOA}}(\\phi)\n$$\nSubstituting the derived expression for $R_{\\mathrm{TOA}}(\\phi)$:\n$$\n\\frac{dH(\\phi)}{d\\phi} = -2\\pi a^2 (1 - A)S_{0}s_{2} \\cos\\phi \\, P_{2}(\\sin\\phi)\n$$\nTo find $H(\\phi)$, we integrate this expression with respect to latitude from the South Pole ($\\phi = -\\pi/2$) to a general latitude $\\phi$. The physical boundary condition is that there is no energy transport across the pole, so $H(-\\pi/2) = 0$.\n$$\nH(\\phi) = \\int_{-\\pi/2}^{\\phi} \\frac{dH(\\phi')}{d\\phi'} \\, d\\phi' = \\int_{-\\pi/2}^{\\phi} \\left( -2\\pi a^2 (1 - A)S_{0}s_{2} \\cos\\phi' \\, P_{2}(\\sin\\phi') \\right) d\\phi'\n$$\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\int_{-\\pi/2}^{\\phi} \\cos\\phi' \\, P_{2}(\\sin\\phi') \\, d\\phi'\n$$\nWe again use the substitution $x = \\sin\\phi'$, so $dx = \\cos\\phi' \\, d\\phi'$. The limits of integration become $x = \\sin(-\\pi/2) = -1$ and $x = \\sin\\phi$.\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\int_{-1}^{\\sin\\phi} P_{2}(x) \\, dx\n$$\nUsing the definition of the second Legendre polynomial, $P_{2}(x) = \\frac{1}{2}(3x^2 - 1)$:\n$$\n\\int P_{2}(x) dx = \\int \\frac{1}{2}(3x^2 - 1) dx = \\frac{1}{2}(x^3 - x) + C\n$$\nEvaluating the definite integral:\n$$\n\\int_{-1}^{\\sin\\phi} P_{2}(x) dx = \\left[\\frac{1}{2}(x^3 - x)\\right]_{-1}^{\\sin\\phi} = \\frac{1}{2}\\left(\\sin^3\\phi - \\sin\\phi\\right) - \\frac{1}{2}\\left((-1)^3 - (-1)\\right)\n$$\nThe second term evaluates to $\\frac{1}{2}(-1 + 1) = 0$. So the integral is:\n$$\n\\int_{-1}^{\\sin\\phi} P_{2}(x) dx = \\frac{1}{2}(\\sin^3\\phi - \\sin\\phi) = \\frac{1}{2}\\sin\\phi(\\sin^2\\phi - 1) = -\\frac{1}{2}\\sin\\phi\\cos^2\\phi\n$$\nSubstituting this result back into the expression for $H(\\phi)$:\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\left(-\\frac{1}{2}\\sin\\phi\\cos^2\\phi\\right)\n$$\nThis simplifies to the final expression for the total northward meridional energy transport:\n$$\nH(\\phi) = \\pi a^2 (1 - A)S_{0}s_{2} \\sin\\phi \\cos^2\\phi\n$$\nThis expression satisfies the boundary conditions $H(-\\pi/2)=0$ and $H(\\pi/2)=0$, indicating no transport across the poles, as required.",
            "answer": "$$ \\boxed{\\pi a^{2} (1 - A)S_{0}s_{2} \\sin\\phi \\cos^{2}\\phi} $$"
        },
        {
            "introduction": "This exercise demonstrates the crucial role of the ocean's mixed layer in modulating climate variability by acting as a thermal flywheel. You will develop a simple energy balance model to quantify how the ocean's heat capacity, parameterized by a mixed-layer depth $H_m$, damps the surface temperature response to periodic forcing. This hands-on coding problem  provides insight into why climate varies on different timescales and how this fundamental process is represented in models.",
            "id": "4011831",
            "problem": "You are tasked with formalizing and computing the sensitivity of an aquaplanet's surface temperature response to changes in ocean mixed-layer depth, from first principles. Consider an aquaplanet represented by a slab ocean of uniform mixed-layer depth $H_m$ that exchanges energy with the atmosphere. The planet has no orbital seasons (no obliquity and constant insolation), so any seasonal-like variability must arise from an imposed, idealized periodic forcing. Assume the following physical setup:\n\n- The surface mixed layer has heat capacity per unit area $C = \\rho_w c_p H_m$, where $\\rho_w$ is the seawater density, $c_p$ is the specific heat capacity of seawater at constant pressure, and $H_m$ is the mixed-layer depth.\n- The surface energy balance is a first-order linear system: the tendency of surface temperature $T(t)$ is controlled by external forcing and a linear radiative feedback. The external forcing can represent a hypothetical \"seasonal-like\" cycle or synoptic-scale variability, each idealized as a sinusoidal heat flux with angular frequency $\\omega$ and amplitude $F_0$. The radiative feedback is proportional to temperature with feedback parameter $\\lambda$.\n- The governing equation for the mixed-layer temperature follows energy conservation and linear feedback: the rate of change of mixed-layer energy equals the net surface flux minus the feedback term.\n\nUsing only these foundations, derive from first principles the normalized amplitude ratio of the surface temperature response to a sinusoidal heat-flux forcing relative to the zero-inertia limit. Then implement a program to evaluate this normalized ratio for specified test cases. The normalized ratio is defined as the ratio of the steady-state amplitude of $T(t)$ under finite $H_m$ to the amplitude under the limit $H_m \\to 0$. This ratio is unitless by construction.\n\nAdopt the following scientifically realistic parameter values:\n- Seawater density $\\rho_w = 1025\\,\\mathrm{kg\\,m^{-3}}$,\n- Seawater specific heat capacity $c_p = 3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- Climate feedback parameter $\\lambda = 1.2\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n\nDefine angular frequency in radians per second. If a period $P$ in days is specified, convert to seconds using $P_\\mathrm{s} = P \\times 86400$ and $\\omega = 2\\pi / P_\\mathrm{s}$.\n\nYour program must compute, for each test case, the normalized amplitude ratio of temperature response for two distinct forcings:\n- A synoptic-scale forcing with period $P_\\mathrm{syn} = 4$ days (central synoptic timescale),\n- A hypothetical seasonal-like forcing with period $P_\\mathrm{seas} = 365$ days (annual-like timescale), even though the aquaplanet has no orbital seasons. This quantifies the potential damping if such low-frequency forcing were applied.\n\nAdditionally, to probe a boundary condition, include a zero-frequency case $\\omega = 0$ for $H_m = 50\\,\\mathrm{m}$ and report its normalized ratio.\n\nUnits and formatting requirements:\n- All outputs are unitless normalized amplitude ratios.\n- Express the final numerical outputs as floats rounded to six decimal places.\n\nTest suite:\nCompute the normalized amplitude ratios for mixed-layer depths $H_m$ in meters: $10$, $25$, $50$, and $100$. For each $H_m$, compute two values in the following order: first for $P_\\mathrm{syn} = 4$ days, then for $P_\\mathrm{seas} = 365$ days. After those eight values, append the zero-frequency boundary case for $H_m = 50$ meters.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\"). The order must be:\n$[G_\\mathrm{syn}(10), G_\\mathrm{seas}(10), G_\\mathrm{syn}(25), G_\\mathrm{seas}(25), G_\\mathrm{syn}(50), G_\\mathrm{seas}(50), G_\\mathrm{syn}(100), G_\\mathrm{seas}(100), G_\\mathrm{zero}(50)]$,\nwhere each $G$ denotes the normalized amplitude ratio for the specified case.",
            "solution": "The user has provided a well-posed problem statement from the field of physical oceanography and climate dynamics. The problem is scientifically grounded in the first law of thermodynamics (energy conservation) and uses a standard idealization, the zero-dimensional energy balance model (EBM) for a slab ocean. All parameters are provided and are physically realistic. The problem is therefore valid.\n\nThe task is to derive the normalized amplitude ratio of the surface temperature response to a sinusoidal forcing. This ratio is defined as the amplitude for a finite mixed-layer depth $H_m$ divided by the amplitude in the zero-inertia limit ($H_m \\to 0$).\n\n**Step 1: Formulate the Governing Ordinary Differential Equation (ODE)**\n\nThe problem is governed by the principle of energy conservation for the ocean mixed layer. The rate of change of energy stored in the mixed layer per unit area is equal to the net energy flux into the surface.\n\nThe energy stored per unit area, $E$, is given by the product of the heat capacity per unit area, $C$, and the surface temperature, $T(t)$.\n$$E = C T(t)$$\nThe heat capacity per unit area $C$ is defined as:\n$$C = \\rho_w c_p H_m$$\nwhere $\\rho_w$ is the seawater density, $c_p$ is the specific heat capacity of seawater, and $H_m$ is the mixed-layer depth.\n\nThe rate of change of this energy is:\n$$\\frac{dE}{dt} = \\frac{d}{dt}(C T(t)) = C \\frac{dT}{dt} = \\rho_w c_p H_m \\frac{dT}{dt}$$\n\nThe net energy flux into the surface is the sum of the external forcing and the radiative feedback.\nThe external forcing is a sinusoidal heat flux, which we can represent in complex form as $F(t) = F_0 e^{i\\omega t}$, where $F_0$ is the real amplitude and $\\omega$ is the angular frequency.\nThe radiative feedback is a linear restoring term, representing outgoing longwave radiation. It is proportional to the surface temperature, $-\\lambda T(t)$, where $\\lambda$ is the climate feedback parameter. The negative sign indicates that a positive temperature anomaly leads to an energy loss from the system.\n\nEquating the rate of change of energy with the net flux, we obtain the governing ODE:\n$$\\rho_w c_p H_m \\frac{dT}{dt} = F_0 e^{i\\omega t} - \\lambda T(t)$$\nRearranging this into the standard form for a first-order linear ODE gives:\n$$\\rho_w c_p H_m \\frac{dT}{dt} + \\lambda T(t) = F_0 e^{i\\omega t}$$\n\n**Step 2: Solve for the Steady-State Amplitude**\n\nWe seek the steady-state (or particular) solution to this forced ODE. The transient (homogeneous) part of the solution decays over time. We assume a solution of the form $T(t) = \\hat{T} e^{i\\omega t}$, where $\\hat{T}$ is the complex amplitude of the temperature response.\n\nThe derivative is $\\frac{dT}{dt} = i\\omega \\hat{T} e^{i\\omega t}$. Substituting the assumed solution and its derivative into the ODE:\n$$\\rho_w c_p H_m (i\\omega \\hat{T} e^{i\\omega t}) + \\lambda (\\hat{T} e^{i\\omega t}) = F_0 e^{i\\omega t}$$\nWe can divide through by the time-dependent term $e^{i\\omega t}$:\n$$i\\omega \\rho_w c_p H_m \\hat{T} + \\lambda \\hat{T} = F_0$$\nNow, we solve for the complex amplitude $\\hat{T}$:\n$$\\hat{T} ( \\lambda + i\\omega \\rho_w c_p H_m ) = F_0$$\n$$\\hat{T} = \\frac{F_0}{\\lambda + i\\omega \\rho_w c_p H_m}$$\n\nThe physical amplitude of the temperature oscillation, denoted $A_T$, is the magnitude (or modulus) of the complex amplitude $\\hat{T}$:\n$$A_T = |\\hat{T}| = \\left| \\frac{F_0}{\\lambda + i\\omega \\rho_w c_p H_m} \\right| = \\frac{|F_0|}{|\\lambda + i\\omega \\rho_w c_p H_m|}$$\nSince $F_0$ is a real, positive amplitude, $|F_0| = F_0$. The magnitude of the complex denominator is $\\sqrt{(\\text{Re})^2 + (\\text{Im})^2}$.\n$$A_T(H_m, \\omega) = \\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\n\n**Step 3: Determine the Amplitude in the Zero-Inertia Limit**\n\nThe problem asks for normalization with respect to the \"zero-inertia limit,\" which corresponds to the mixed-layer depth approaching zero, $H_m \\to 0$. Let's denote the amplitude in this limit as $A_{T,0}$.\n$$A_{T,0}(\\omega) = \\lim_{H_m \\to 0} A_T(H_m, \\omega) = \\lim_{H_m \\to 0} \\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\nAs $H_m \\to 0$, the term $(\\omega \\rho_w c_p H_m)^2 \\to 0$. Therefore, the limit is:\n$$A_{T,0} = \\frac{F_0}{\\sqrt{\\lambda^2 + 0}} = \\frac{F_0}{\\lambda}$$\nThis result is physically intuitive: with zero thermal inertia, the surface temperature is in instantaneous equilibrium with the forcing, so the radiative feedback flux $\\lambda T$ must balance the forcing flux.\n\n**Step 4: Derive the Normalized Amplitude Ratio**\n\nThe normalized amplitude ratio, $G$, is defined as the ratio of the finite-depth amplitude $A_T$ to the zero-inertia amplitude $A_{T,0}$.\n$$G(H_m, \\omega) = \\frac{A_T(H_m, \\omega)}{A_{T,0}}$$\n$$G(H_m, \\omega) = \\frac{\\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}}{\\frac{F_0}{\\lambda}}$$\nThe forcing amplitude $F_0$ cancels out:\n$$G(H_m, \\omega) = \\frac{\\lambda}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\nThis expression can be simplified by factoring $\\lambda$ out of the square root:\n$$G(H_m, \\omega) = \\frac{\\lambda}{\\lambda \\sqrt{1 + \\frac{(\\omega \\rho_w c_p H_m)^2}{\\lambda^2}}} = \\frac{1}{\\sqrt{1 + \\left(\\frac{\\omega \\rho_w c_p H_m}{\\lambda}\\right)^2}}$$\nThis is the final formula for the normalized amplitude ratio. It describes the behavior of a low-pass filter, where the response is attenuated at higher frequencies $\\omega$ or for larger thermal inertia (proportional to $H_m$).\n\n**Step 5: Analyze the Zero-Frequency Case**\n\nFor the special case of zero frequency, $\\omega = 0$:\n$$G(H_m, 0) = \\frac{1}{\\sqrt{1 + \\left(\\frac{0 \\cdot \\rho_w c_p H_m}{\\lambda}\\right)^2}} = \\frac{1}{\\sqrt{1+0}} = 1$$\nThis means that for a constant forcing ($\\omega = 0$), the steady-state temperature response is independent of the mixed-layer heat capacity. The final equilibrium is determined solely by the feedback parameter $\\lambda$. Therefore, the normalized ratio is always $1$. The problem asks for this value for $H_m = 50\\,\\mathrm{m}$, which will be $1.0$.\n\n**Step 6: Implementation Plan**\n\nThe program will implement the derived formula $G(H_m, \\omega)$ using the provided physical constants and test cases.\n- Constants: $\\rho_w = 1025\\,\\mathrm{kg\\,m^{-3}}$, $c_p = 3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $\\lambda = 1.2\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n- Conversion from period $P$ in days to angular frequency $\\omega$: $\\omega = 2\\pi / (P \\times 86400)$.\n- The program will loop through the specified $H_m$ values ($10$, $25$, $50$, $100\\,\\mathrm{m}$) and calculate $G$ for $P_\\mathrm{syn} = 4\\,\\mathrm{days}$ and $P_\\mathrm{seas} = 365\\,\\mathrm{days}$.\n- Finally, it will append the result for the $\\omega = 0$ case for $H_m=50\\,\\mathrm{m}$, which is $1.0$.\n- All results will be formatted to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of an aquaplanet's surface temperature response\n    to changes in ocean mixed-layer depth.\n    \"\"\"\n\n    # --- Given Physical Parameters ---\n    # Seawater density in kg/m^3\n    RHO_W = 1025.0\n    # Seawater specific heat capacity in J/(kg*K)\n    C_P = 3990.0\n    # Climate feedback parameter in W/(m^2*K)\n    LAMBDA = 1.2\n\n    # --- Test Case Definitions ---\n    # Mixed-layer depths in meters\n    H_m_values = [10.0, 25.0, 50.0, 100.0]\n    # Forcing periods in days\n    P_syn = 4.0  # Synoptic-scale\n    P_seas = 365.0 # Seasonal-like\n\n    def calculate_normalized_ratio(Hm, P_days):\n        \"\"\"\n        Calculates the normalized amplitude ratio G(Hm, omega).\n\n        Args:\n            Hm (float): Mixed-layer depth in meters.\n            P_days (float): Forcing period in days. If 0, assumes zero frequency.\n\n        Returns:\n            float: The unitless normalized amplitude ratio.\n        \"\"\"\n        # Handle the zero-frequency case, where omega = 0\n        if P_days == 0:\n            return 1.0\n\n        # Convert period from days to seconds\n        P_seconds = P_days * 86400.0\n        # Calculate angular frequency in rad/s\n        omega = 2 * np.pi / P_seconds\n\n        # Calculate heat capacity per unit area in J/(m^2*K)\n        C = RHO_W * C_P * Hm\n\n        # The core argument inside the square root\n        arg = (omega * C) / LAMBDA\n\n        # Derived formula for the normalized amplitude ratio G\n        # G = 1 / sqrt(1 + (omega * C / lambda)^2)\n        ratio = 1.0 / np.sqrt(1.0 + arg**2)\n\n        return ratio\n\n    # List to store the results in the required order\n    results = []\n\n    # Iterate through each mixed-layer depth\n    for Hm in H_m_values:\n        # 1. Synoptic-scale forcing\n        g_syn = calculate_normalized_ratio(Hm, P_syn)\n        results.append(g_syn)\n\n        # 2. Seasonal-like forcing\n        g_seas = calculate_normalized_ratio(Hm, P_seas)\n        results.append(g_seas)\n\n    # 3. Append the special zero-frequency case for Hm = 50m\n    # As derived, the result for omega=0 is always 1, independent of Hm.\n    # We pass P_days=0 to the function to handle this case.\n    g_zero = calculate_normalized_ratio(50.0, 0)\n    results.append(g_zero)\n\n    # Format the results to six decimal places and create the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice integrates dynamics and thermodynamics to diagnose a key feature of the tropical climate: the Intertropical Convergence Zone (ITCZ). By implementing a column-integrated moisture budget, you will calculate precipitation from its fundamental sources (evaporation) and sinks (transport divergence). This computational exercise  offers direct experience in how scientists use budget analyses to understand and predict the behavior of emergent climate phenomena in response to surface warming patterns.",
            "id": "4011842",
            "problem": "Consider an idealized aquaplanet, that is, a planet completely covered by ocean with zonally uniform conditions, used to study large-scale atmospheric behavior in Numerical Weather Prediction (NWP) and climate modeling. The Intertropical Convergence Zone (ITCZ) location can be inferred from the latitude of maximum column-integrated precipitation. Your task is to derive, implement, and apply a diagnostic calculation of precipitation based on the column-integrated moisture budget and then infer the ITCZ latitude under imposed Sea Surface Temperature (SST) changes. Angles must be expressed in degrees, and any internal computation that uses trigonometric functions must convert to radians. The final program must produce a single line of output containing the inferred ITCZ latitudes for the provided test suite, in degrees, as a comma-separated list enclosed in square brackets. The program must be self-contained and must not read any external input.\n\nStart from a fundamental base: the conservation of water vapor mass under the hydrostatic and shallow-atmosphere approximations. Over a vertical column, the integral of water vapor mass per unit area, denoted by $W$, obeys a local conservation law with sources and sinks due to evaporation and precipitation and horizontal transport by the moisture flux. The column moisture flux vector is denoted by $\\mathbf{F}_q$. The diagnostic precipitation is computed by combining evaporation, storage tendency, and the spherical divergence of the column moisture flux. Derive the diagnostic expression for precipitation using this conservation principle, and then implement it numerically for zonally symmetric conditions on a sphere.\n\nAssumptions and definitions:\n- Define the Intertropical Convergence Zone (ITCZ) as the latitude $\\phi$ where the diagnosed precipitation attains its maximum value in the zonal mean.\n- Define the Sea Surface Temperature (SST). Let $T_s(\\phi)$ be the SST as a function of latitude $\\phi$.\n- Define Relative Humidity (RH). Let $RH_{10}(\\phi)$ be the near-surface relative humidity and $RH_c(\\phi)$ be the column relative humidity.\n- Let $p_s$ be the surface pressure, $g$ be gravitational acceleration, $a$ be the Earth radius, $R_d$ be the specific gas constant for dry air, $R_v$ be the specific gas constant for water vapor, $L_v$ be the latent heat of vaporization, and $C_E$ be the bulk transfer coefficient for evaporation.\n- Use the following saturation vapor pressure formulation: $$e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right),$$ where $e_0$ is the reference saturation vapor pressure at $T_0$.\n- The saturation specific humidity at the surface is $$q_s(T_s) = \\epsilon \\frac{e_s(T_s)}{p_s},$$ with $\\epsilon = R_d/R_v$.\n- Assume near-surface air temperature equals the SST, i.e., $T_a(\\phi) = T_s(\\phi)$, and near-surface air density is $$\\rho_a(\\phi) = \\frac{p_s}{R_d T_a(\\phi)}.$$\n- Parameterize column-integrated water vapor mass per unit area (precipitable water) by assuming vertically uniform specific humidity proportional to $RH_c$: $$W(\\phi) = RH_c(\\phi) q_s(T_s(\\phi)) \\frac{p_s}{g}.$$\n- Parameterize evaporation using a standard bulk aerodynamic formula: $$E(\\phi) = \\rho_a(\\phi) C_E U_{10}(\\phi) \\left(q_s(T_s(\\phi)) - q_a(\\phi)\\right),$$ with near-surface specific humidity $q_a(\\phi) = RH_{10}(\\phi) q_s(T_s(\\phi))$ and $U_{10}(\\phi)$ the $10$ meter wind speed magnitude.\n- Parameterize the column moisture flux as purely meridional due to zonal symmetry: $$\\mathbf{F}_q(\\phi) = \\left(0, F_\\phi(\\phi)\\right),\\quad F_\\phi(\\phi) = v(\\phi) W(\\phi),$$ where $v(\\phi)$ is the column-mean meridional wind speed.\n- On the sphere, the divergence of a purely meridional flux for zonal symmetry is $$\\nabla\\cdot\\mathbf{F}_q(\\phi) = \\frac{1}{a\\cos\\phi} \\frac{\\partial}{\\partial \\phi}\\big(F_\\phi(\\phi)\\cos\\phi\\big),$$ where $\\phi$ is expressed in radians in the derivative.\n\nGrid and units:\n- Use a latitude grid $\\phi_i$ from $-87.5$ degrees to $+87.5$ degrees inclusive, spaced by $5$ degrees (do not include the poles), i.e., $\\phi_i \\in \\{-87.5, -82.5, \\dots, 82.5, 87.5\\}$.\n- For internal computations involving trigonometric functions and spherical derivatives, convert degrees to radians.\n- The diagnosed precipitation should be internally computed in $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$ and then converted to $\\mathrm{mm/day}$ using the identity that $1$ $\\mathrm{kg\\, m^{-2}} = 1$ $\\mathrm{mm}$ of liquid water, so multiply by $86400$ to convert from $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$ to $\\mathrm{mm/day}$.\n- Angles must be reported in degrees. The final output requires latitudes in degrees.\n\nConstants:\n- Use $a = 6.371\\times 10^6$ meters, $g = 9.81$ $\\mathrm{m\\, s^{-2}}$, $p_s = 10^5$ $\\mathrm{Pa}$, $R_d = 287$ $\\mathrm{J\\, kg^{-1}\\, K^{-1}}$, $R_v = 461$ $\\mathrm{J\\, kg^{-1}\\, K^{-1}}$, $L_v = 2.5\\times 10^6$ $\\mathrm{J\\, kg^{-1}}$, $e_0 = 610.78$ $\\mathrm{Pa}$, $T_0 = 273.15$ $\\mathrm{K}$, $C_E = 1.2\\times 10^{-3}$ (dimensionless).\n\nNumerical method:\n- Implement the spherical divergence using a second-order centered finite difference for interior grid points and first-order one-sided finite differences at the domain boundaries. Let $\\Delta\\phi$ be the latitude spacing in radians. For interior points $i$, compute $$\\frac{\\partial}{\\partial \\phi}(F_\\phi\\cos\\phi)\\bigg|_i \\approx \\frac{(F_\\phi\\cos\\phi)_{i+1} - (F_\\phi\\cos\\phi)_{i-1}}{2\\,\\Delta \\phi}.$$ At the boundaries, use forward or backward differences.\n- Compute the diagnosed precipitation from the moisture budget and determine the latitude $\\phi$ where it is maximized.\n\nTest suite:\nProvide four cases to test the computation and ITCZ inference. In all cases, angles in trigonometric functions are handled in radians internally, but outputs must be latitudes in degrees.\n- Case $1$ (Control aquaplanet): \n  - $T_s(\\phi) = 300 - 20 \\sin^2\\phi$ (with $\\phi$ in radians in the sine), in $\\mathrm{K}$.\n  - $U_{10}(\\phi) = 8$ $\\mathrm{m\\, s^{-1}}$ (constant).\n  - $RH_{10}(\\phi) = 0.8$ (constant).\n  - $RH_c(\\phi) = \\min(\\max(0.6 + 0.2 \\cos\\phi, 0.3), 0.95)$ (clamped to the interval $[0.3, 0.95]$).\n  - $v(\\phi) = 2 \\sin(2\\phi)$ $\\mathrm{m\\, s^{-1}}$.\n  - $\\partial_t W(\\phi) = 0$ $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$.\n- Case $2$ (Northern Hemisphere warming): Same as Case $1$, except\n  - $T_s(\\phi) \\leftarrow T_s(\\phi) + \\Delta_H \\tanh(\\frac{\\phi}{\\phi_w})$,\n  - with $\\Delta_H = 2$ $\\mathrm{K}$ and $\\phi_w = 10$ degrees (convert $\\phi_w$ to radians for the $\\tanh$ argument).\n- Case $3$ (Southern Hemisphere warming and zero meridional transport): Same as Case $1$, except\n  - $T_s(\\phi) \\leftarrow T_s(\\phi) - \\Delta_H \\tanh(\\frac{\\phi}{\\phi_w})$,\n  - with $\\Delta_H = 2$ $\\mathrm{K}$ and $\\phi_w = 10$ degrees (convert to radians),\n  - and $v(\\phi) = 0$ $\\mathrm{m\\, s^{-1}}$ for all $\\phi$.\n- Case $4$ (Northern Hemisphere warming with transient moistening): Same as Case $2$, except\n  - $\\partial_t W(\\phi) = A \\exp(-(\\phi/\\sigma)^2)$ $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$,\n  - with $A = 1\\times 10^{-5}$ $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$ and $\\sigma = 15$ degrees (convert $\\sigma$ to radians in the exponent).\n\nRequired final output:\n- For each case, compute the diagnosed precipitation field in $\\mathrm{mm/day}$ and then determine the latitude of its global maximum (the ITCZ latitude). Report these four latitudes as floats in degrees.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$).\n\nScientific realism constraints:\n- All constants and parameterizations must be physically plausible.\n- The algorithm must correctly handle unit conversions and spherical geometry.\n- The discretization must be stable and appropriate for the given grid.\n\nNote: The final reported latitudes must be in degrees. The internal precipitation computation must use $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$ and then be converted to $\\mathrm{mm/day}$ for diagnostic purposes, but the only required output is the ITCZ latitudes in degrees for the four test cases.",
            "solution": "The problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in the principles of atmospheric physics, specifically the conservation of water vapor mass. The problem is well-posed, providing a complete and consistent set of definitions, constants, and parameterizations required to derive and implement a unique solution. The numerical methods and boundary conditions are explicitly specified, and the context of an idealized aquaplanet simulation is standard practice in climate science. The problem is a non-trivial but solvable exercise in computational atmospheric science.\n\nThe core task is to determine the latitude of the Intertropical Convergence Zone (ITCZ), defined as the latitude of maximum precipitation, under various climate scenarios on an aquaplanet. This requires deriving and numerically solving the column-integrated moisture budget equation for diagnostic precipitation.\n\nThe vertically integrated conservation law for water vapor mass $W$ (in units of $\\mathrm{kg\\, m^{-2}}$) is given by:\n$$\n\\frac{\\partial W}{\\partial t} + \\nabla \\cdot \\mathbf{F}_q = E - P\n$$\nwhere $\\frac{\\partial W}{\\partial t}$ is the storage tendency of water vapor, $\\nabla \\cdot \\mathbf{F}_q$ is the divergence of the vertically integrated moisture flux, $E$ is the surface evaporation rate, and $P$ is the precipitation rate. All terms are expressed in units of $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$.\n\nTo find the diagnostic precipitation $P$, we rearrange the equation:\n$$\nP(\\phi) = E(\\phi) - \\frac{\\partial W(\\phi)}{\\partial t} - \\nabla \\cdot \\mathbf{F}_q(\\phi)\n$$\nThe problem is zonally symmetric, so all quantities are functions of latitude $\\phi$ only. We must calculate each term on the right-hand side using the provided parameterizations.\n\nThe solution proceeds in the following steps:\n1.  **Grid Setup**: A latitude grid $\\phi_i$ is established from $-87.5^\\circ$ to $+87.5^\\circ$ with a spacing of $\\Delta\\phi = 5^\\circ$. For all calculations, this grid is converted to radians.\n\n2.  **Calculation of Thermodynamic Quantities**: We first compute several latitude-dependent thermodynamic variables that are prerequisites for the budget terms.\n    -   The Sea Surface Temperature $T_s(\\phi)$ is defined for each test case. Near-surface air temperature is assumed equal, $T_a(\\phi) = T_s(\\phi)$.\n    -   The saturation vapor pressure $e_s(T)$ at temperature $T$ is given by the Clausius-Clapeyron relation:\n        $$e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right)$$\n        where $e_0 = 610.78 \\, \\mathrm{Pa}$ is the reference saturation vapor pressure at $T_0 = 273.15 \\, \\mathrm{K}$. $L_v=2.5 \\times 10^6 \\, \\mathrm{J\\, kg^{-1}}$ is the latent heat of vaporization, and $R_v=461 \\, \\mathrm{J\\, kg^{-1}\\, K^{-1}}$ is the specific gas constant for water vapor.\n    -   The saturation specific humidity at the surface is then calculated as:\n        $$q_s(\\phi) = \\epsilon \\frac{e_s(T_s(\\phi))}{p_s}$$\n        where $\\epsilon = R_d/R_v \\approx 0.622$ is the ratio of gas constants for dry air ($R_d = 287 \\, \\mathrm{J\\, kg^{-1}\\, K^{-1}}$) and water vapor, and $p_s = 10^5 \\, \\mathrm{Pa}$ is the surface pressure.\n\n3.  **Calculation of Budget Terms**:\n    -   **Evaporation ($E$)**: The surface evaporation flux is parameterized using a bulk aerodynamic formula:\n        $$E(\\phi) = \\rho_a(\\phi)\\, C_E\\, U_{10}(\\phi)\\,\\left(q_s(\\phi) - q_a(\\phi)\\right)$$\n        Here, $C_E = 1.2 \\times 10^{-3}$ is the dimensionless bulk transfer coefficient, and $U_{10}(\\phi)$ is the prescribed near-surface wind speed. The near-surface air density is $\\rho_a(\\phi) = p_s / (R_d T_a(\\phi))$, and the near-surface specific humidity is $q_a(\\phi) = RH_{10}(\\phi)\\, q_s(\\phi)$, where $RH_{10}(\\phi)$ is the prescribed near-surface relative humidity.\n    -   **Storage Tendency ($\\partial_t W$)**: The term $\\frac{\\partial W}{\\partial t}$ is explicitly prescribed for each case. For the first $3$ cases, it is zero. For the fourth case, it is a non-zero function of latitude.\n    -   **Moisture Flux Divergence ($\\nabla \\cdot \\mathbf{F}_q$)**: This term requires several steps.\n        -   First, the column-integrated water vapor (precipitable water) $W$ is parameterized as:\n            $$W(\\phi) = RH_c(\\phi)\\, q_s(\\phi)\\, \\frac{p_s}{g}$$\n            where $RH_c(\\phi)$ is the prescribed column relative humidity and $g = 9.81 \\, \\mathrm{m\\, s^{-2}}$ is the acceleration due to gravity.\n        -   Due to zonal symmetry, the moisture flux is purely meridional, $\\mathbf{F}_q(\\phi) = (0, F_\\phi(\\phi))$, where the meridional component is:\n            $$F_\\phi(\\phi) = v(\\phi)\\, W(\\phi)$$\n            with $v(\\phi)$ being the prescribed column-mean meridional wind.\n        -   The divergence of this flux on a sphere is:\n            $$\\nabla\\cdot\\mathbf{F}_q(\\phi) = \\frac{1}{a\\cos\\phi}\\, \\frac{\\partial}{\\partial \\phi}\\left(F_\\phi(\\phi)\\cos\\phi\\right)$$\n            where $a = 6.371 \\times 10^6 \\, \\mathrm{m}$ is the Earth's radius and $\\phi$ is in radians.\n        -   The derivative $\\frac{\\partial}{\\partial \\phi}(F_\\phi\\cos\\phi)$ is computed numerically using finite differences on the discrete grid. Let $Y_i = (F_\\phi \\cos\\phi)_i$ at grid point $i$.\n            -   For interior points ($i=1, \\dots, N-2$): A $2^{nd}$-order centered difference is used:\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_i \\approx \\frac{Y_{i+1} - Y_{i-1}}{2\\,\\Delta \\phi}$$\n            -   For the southern boundary ($i=0$): A $1^{st}$-order forward difference is used:\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_0 \\approx \\frac{Y_1 - Y_0}{\\Delta \\phi}$$\n            -   For the northern boundary ($i=N-1$): A $1^{st}$-order backward difference is used:\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_{N-1} \\approx \\frac{Y_{N-1} - Y_{N-2}}{\\Delta \\phi}$$\n            The resulting vector of derivatives is then divided by $a\\cos\\phi_i$ to get the divergence.\n\n4.  **Final Precipitation and ITCZ Location**:\n    -   The precipitation $P(\\phi_i)$ is calculated at each grid point by substituting the computed terms $E(\\phi_i)$, $\\frac{\\partial W}{\\partial t}(\\phi_i)$, and $\\nabla \\cdot \\mathbf{F}_q(\\phi_i)$ into the budget equation.\n    -   The ITCZ latitude is identified by finding the grid point $i_{max}$ where $P(\\phi_{i_{max}})$ is the maximum value in the array $P$. The latitude in degrees corresponding to this index, $\\phi_{deg}[i_{max}]$, is the final result for that test case.\n\nThis procedure is applied to each of the $4$ test cases, which vary the functions for $T_s(\\phi)$, $v(\\phi)$, and $\\frac{\\partial W}{\\partial t}(\\phi)$ to simulate different climatic states.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a diagnostic calculation of precipitation to infer the \n    ITCZ latitude on an idealized aquaplanet for four test cases.\n    \"\"\"\n\n    # --- Constants ---\n    a = 6.371e6      # Earth radius (m)\n    g = 9.81         # Gravitational acceleration (m/s^2)\n    p_s = 1.0e5      # Surface pressure (Pa)\n    R_d = 287.0      # Specific gas constant for dry air (J/kg/K)\n    R_v = 461.0      # Specific gas constant for water vapor (J/kg/K)\n    L_v = 2.5e6      # Latent heat of vaporization (J/kg)\n    e_0 = 610.78     # Reference saturation vapor pressure (Pa)\n    T_0 = 273.15     # Reference temperature (K)\n    C_E = 1.2e-3     # Bulk transfer coefficient (dimensionless)\n    epsilon = R_d / R_v\n\n    # --- Grid Setup ---\n    phi_deg = np.arange(-87.5, 87.5 + 5.0, 5.0)\n    phi_rad = np.deg2rad(phi_deg)\n    delta_phi_rad = np.deg2rad(5.0)\n    num_points = len(phi_deg)\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case 1: Control aquaplanet\n        {\n            \"name\": \"Case 1: Control\",\n            \"Ts_func\": lambda p: 300.0 - 20.0 * np.sin(p)**2,\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 2: Northern Hemisphere warming\n        {\n            \"name\": \"Case 2: NH Warming\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) + 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 3: Southern Hemisphere warming, zero transport\n        {\n            \"name\": \"Case 3: SH Warming, No Transport\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) - 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: np.zeros_like(p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 4: NH warming, transient moistening\n        {\n            \"name\": \"Case 4: NH Warming, Transient\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) + 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: 1.0e-5 * np.exp(-(p / np.deg2rad(15.0))**2)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # --- Step 1: Calculate thermodynamic quantities ---\n        Ts = case[\"Ts_func\"](phi_rad)\n        es = e_0 * np.exp((L_v / R_v) * (1.0 / T_0 - 1.0 / Ts))\n        qs = epsilon * es / p_s\n        \n        # --- Step 2: Calculate budget terms ---\n        \n        # Evaporation (E)\n        rho_a = p_s / (R_d * Ts)\n        U10 = case[\"U10_func\"](phi_rad)\n        RH10 = case[\"RH10_func\"](phi_rad)\n        qa = RH10 * qs\n        E = rho_a * C_E * U10 * (qs - qa)\n\n        # Storage Tendency (dW/dt)\n        dWdt = case[\"dWdt_func\"](phi_rad)\n\n        # Moisture Flux Divergence (div F_q)\n        RHc = case[\"RHc_func\"](phi_rad)\n        W = RHc * qs * (p_s / g)\n        v = case[\"v_func\"](phi_rad)\n        F_phi = v * W\n        \n        Y = F_phi * np.cos(phi_rad)\n        dYdphi = np.zeros_like(phi_rad)\n        \n        # Interior points: 2nd-order centered difference\n        dYdphi[1:-1] = (Y[2:] - Y[:-2]) / (2.0 * delta_phi_rad)\n        \n        # Boundaries: 1st-order one-sided difference\n        dYdphi[0] = (Y[1] - Y[0]) / delta_phi_rad       # Forward difference\n        dYdphi[-1] = (Y[-1] - Y[-2]) / delta_phi_rad  # Backward difference\n        \n        # Add a small epsilon to avoid division by zero at poles, though not needed for this grid\n        cos_phi = np.cos(phi_rad)\n        \n        div_Fq = (1.0 / (a * cos_phi)) * dYdphi\n        \n        # --- Step 3: Calculate Precipitation and find ITCZ ---\n        # P = E - dW/dt - div(F_q) [kg m^-2 s^-1]\n        P = E - dWdt - div_Fq\n        \n        # Find the latitude of maximum precipitation\n        itcz_index = np.argmax(P)\n        itcz_latitude = phi_deg[itcz_index]\n        results.append(itcz_latitude)\n\n    # --- Final Output ---\n    # The format must be exactly a comma-separated list in brackets.\n    print(f\"[{','.join(f'{res:.1f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}