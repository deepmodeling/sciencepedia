{
    "hands_on_practices": [
        {
            "introduction": "At the heart of many storyline attribution studies for extreme precipitation is the isolation of thermodynamic effects from dynamic ones. This exercise provides a foundational calculation, guiding you to derive the expected increase in precipitation intensity based on the Clausius-Clapeyron (CC) relation, assuming the storm's dynamics remain unchanged. Mastering this derivation  provides a first-principles understanding of how warming directly amplifies the \"fuel\" for rainfall.",
            "id": "4095507",
            "problem": "Consider a storyline attribution framework in numerical weather prediction and climate modeling: an observed extreme precipitation event is conditioned on its synoptic dynamics remaining unchanged in a warmer climate state, and only thermodynamic variables respond to warming. Assume the following physically grounded base.\n\n- The column moisture budget in a quasi-steady extreme yields precipitation intensity proportional to the column condensation sink, which under nearly saturated ascent can be approximated as proportional to the product of a fixed kinematic-dynamic field and the saturation specific humidity. Specifically, let the precipitation intensity be represented as $P \\propto \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T(p))\\, dp$, where $F(p)$ is a stationary function encapsulating vertical motion and microphysical efficiency, held fixed under the storyline assumption (unchanged convergence and precipitation efficiency), $q_{s}$ is the saturation specific humidity, $T(p)$ is temperature, $p_{\\mathrm{top}}$ is the pressure at the top of the column, and $p_{\\mathrm{sfc}}$ is the surface pressure.\n- Under a uniform warming of the column by $\\Delta T$ (a standard idealization to isolate thermodynamic effects), $T(p)$ shifts to $T(p)+\\Delta T$, and the saturation specific humidity responds according to Clausius–Clapeyron scaling, expressed locally as the differential relation $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$, where $\\gamma$ is a positive constant over the relevant temperature range.\n\nStarting from these base statements and the Clausius–Clapeyron differential relation, derive the closed-form analytic expression for the fractional increase in extreme precipitation intensity under the storyline warming by $\\Delta T$ with unchanged $F(p)$, and then evaluate it numerically for $\\gamma=0.07\\,\\mathrm{K}^{-1}$ and $\\Delta T=3\\,\\mathrm{K}$. Express the final fractional increase as a decimal number, rounded to four significant figures. Do not use a percent sign in your answer.",
            "solution": "The user has submitted a problem for validation and solution.\n\n### Step 1: Extract Givens\n- **Framework**: Storyline attribution in numerical weather prediction and climate modeling.\n- **Condition**: Synoptic dynamics are fixed; only thermodynamic variables respond to warming.\n- **Precipitation Intensity Model**: $P \\propto \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T(p))\\, dp$.\n- **$F(p)$**: A stationary function (fixed vertical motion and microphysical efficiency).\n- **$q_{s}(T(p))$**: Saturation specific humidity as a function of the temperature profile $T(p)$.\n- **$p_{\\mathrm{sfc}}$, $p_{\\mathrm{top}}$**: Surface and top-of-column pressures.\n- **Perturbation**: A uniform warming of the atmospheric column by $\\Delta T$.\n- **Temperature Change**: The initial temperature profile $T(p)$ becomes $T(p)+\\Delta T$.\n- **Clausius-Clapeyron Relation**: The response of saturation specific humidity to temperature is given by the differential equation $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$.\n- **Constant**: $\\gamma$ is a positive constant over the relevant temperature range.\n- **Task 1**: Derive the closed-form analytic expression for the fractional increase in extreme precipitation intensity.\n- **Task 2**: Evaluate this expression for the numerical values $\\gamma=0.07\\,\\mathrm{K}^{-1}$ and $\\Delta T=3\\,\\mathrm{K}$.\n- **Task 3**: Express the final result as a decimal number rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n\n- **Scientifically Grounded**: The problem is rooted in fundamental principles of atmospheric thermodynamics (the Clausius–Clapeyron relation) and a recognized methodology in climate science (storyline attribution). The precipitation model, while simplified, is physically motivated. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear mathematical model, a defined perturbation, and a specific quantity to be derived. It provides all necessary information to find the fractional change, which makes the unknown proportionality constant and the specific form of $F(p)$ irrelevant to the final ratio. A unique, meaningful solution exists.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased scientific language.\n\nThe problem is free of the specified flaws (e.g., scientific unsoundness, incompleteness, ambiguity). The idealization of uniform warming is a standard technique in such analyses to isolate a specific physical effect.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process may proceed.\n\n### Solution Derivation\nThe objective is to derive the fractional increase in precipitation, which is defined as $\\frac{P_{1} - P_0}{P_0}$, where $P_0$ is the initial precipitation intensity and $P_1$ is the precipitation intensity after the warming of $\\Delta T$.\n\nLet the proportionality constant in the precipitation model be $k$. The initial precipitation intensity, $P_0$, corresponding to the initial temperature profile $T_0(p)$, is:\n$$P_0 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p))\\, dp$$\n\nAfter a uniform warming of $\\Delta T$, the new temperature profile is $T_1(p) = T_0(p) + \\Delta T$. The new precipitation intensity, $P_1$, is:\n$$P_1 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_1(p))\\, dp = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p) + \\Delta T)\\, dp$$\nThe storyline assumption dictates that $F(p)$ and the integration limits remain unchanged.\n\nTo proceed, we must find the functional form of $q_s(T)$ from the given differential relation: $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$. This is a separable first-order linear ordinary differential equation.\n$$\\frac{1}{q_{s}} dq_{s} = \\gamma dT$$\nIntegrating both sides gives:\n$$\\int \\frac{1}{q_{s}} dq_{s} = \\int \\gamma dT$$\n$$\\ln(q_{s}) = \\gamma T + C$$\nwhere $C$ is the constant of integration. Solving for $q_{s}(T)$ yields:\n$$q_{s}(T) = \\exp(\\gamma T + C) = A \\exp(\\gamma T)$$\nwhere $A = \\exp(C)$ is a constant.\n\nNow, we relate the saturation specific humidity in the warmed state, $q_s(T_1(p))$, to that in the initial state, $q_s(T_0(p))$.\n$$q_{s}(T_1(p)) = q_{s}(T_0(p) + \\Delta T) = A \\exp(\\gamma (T_0(p) + \\Delta T))$$\n$$q_{s}(T_1(p)) = A \\exp(\\gamma T_0(p)) \\exp(\\gamma \\Delta T)$$\nRecognizing that $A \\exp(\\gamma T_0(p)) = q_{s}(T_0(p))$, we find the relation:\n$$q_{s}(T_1(p)) = q_{s}(T_0(p)) \\exp(\\gamma \\Delta T)$$\nThis shows that for a uniform warming $\\Delta T$, the saturation specific humidity at every pressure level $p$ increases by a constant multiplicative factor $\\exp(\\gamma \\Delta T)$.\n\nSubstitute this result back into the expression for $P_1$:\n$$P_1 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, \\left( q_{s}(T_0(p)) \\exp(\\gamma \\Delta T) \\right) dp$$\nSince $\\exp(\\gamma \\Delta T)$ is a constant with respect to the integration variable $p$, it can be factored out of the integral:\n$$P_1 = \\exp(\\gamma \\Delta T) \\left( k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p))\\, dp \\right)$$\nThe term in the parentheses is precisely the initial precipitation intensity, $P_0$. Therefore:\n$$P_1 = P_0 \\exp(\\gamma \\Delta T)$$\n\nThe fractional increase in precipitation is then calculated as:\n$$\\text{Fractional Increase} = \\frac{P_1 - P_0}{P_0} = \\frac{P_0 \\exp(\\gamma \\Delta T) - P_0}{P_0}$$\n$$\\text{Fractional Increase} = \\frac{P_0 \\left( \\exp(\\gamma \\Delta T) - 1 \\right)}{P_0}$$\nThis simplifies to the final analytical expression:\n$$\\text{Fractional Increase} = \\exp(\\gamma \\Delta T) - 1$$\n\nNow, we evaluate this expression for the given numerical values: $\\gamma = 0.07\\,\\mathrm{K}^{-1}$ and $\\Delta T = 3\\,\\mathrm{K}$.\nThe product in the exponent is a dimensionless quantity, as required:\n$$\\gamma \\Delta T = (0.07\\,\\mathrm{K}^{-1}) \\times (3\\,\\mathrm{K}) = 0.21$$\nSubstituting this value into our derived expression:\n$$\\text{Fractional Increase} = \\exp(0.21) - 1$$\nCalculating the numerical value:\n$$\\exp(0.21) \\approx 1.23367809$$\n$$\\exp(0.21) - 1 \\approx 0.23367809$$\nThe problem requires rounding to four significant figures. The first four significant figures are $2$, $3$, $3$, $6$. The fifth digit is $7$, so we round up the fourth digit.\n$$\\text{Fractional Increase} \\approx 0.2337$$",
            "answer": "$$\\boxed{0.2337}$$"
        },
        {
            "introduction": "While precipitation events are governed by moisture budgets, heatwaves are fundamentally a matter of surface energy balance. This hands-on coding practice challenges you to build a simplified one-dimensional column model to simulate a heatwave, separating the influence of large-scale atmospheric patterns from local radiative and turbulent feedbacks. By implementing this model , you will gain practical insight into partitioning the drivers of a heatwave, a key task in constructing a compelling attribution storyline.",
            "id": "4095554",
            "problem": "Consider a one-dimensional mixed-layer column model used in numerical weather prediction and climate modeling to construct storyline-based attribution for a heatwave. The storyline approach prescribes observed or plausible large-scale advection and radiative anomalies while diagnosing the thermodynamic contribution from local feedbacks via column energy balance. Starting from the First Law of Thermodynamics (FLT) for a column with mixed-layer heat capacity $C$ (units $\\mathrm{J\\,m^{-2}\\,K^{-1}}$), the temperature anomaly $\\Delta T(t)$ evolves according to energy conservation for the mixed layer:\n$$\nC \\frac{d \\Delta T}{dt} = \\Delta R_n(t) - \\Delta H(t) - \\Delta LE(t) - \\Delta G(t) + A(t),\n$$\nwhere $\\Delta R_n(t)$ is the net surface radiative anomaly (units $\\mathrm{W\\,m^{-2}}$), $\\Delta H(t)$ is the anomalous sensible heat flux to the atmosphere (units $\\mathrm{W\\,m^{-2}}$), $\\Delta LE(t)$ is the anomalous latent heat flux (units $\\mathrm{W\\,m^{-2}}$), $\\Delta G(t)$ is the anomalous ground heat flux (units $\\mathrm{W\\,m^{-2}}$), and $A(t)$ is the externally prescribed large-scale advective heat input to the column (units $\\mathrm{W\\,m^{-2}}$). The Surface Energy Balance (SEB) residual is defined as\n$$\n\\Delta R_n(t) - \\Delta H(t) - \\Delta LE(t) - \\Delta G(t) = C \\frac{d \\Delta T}{dt},\n$$\nwhich is the storage term in the mixed layer. In a storyline separation, we decompose sources into radiative forcing and advection, and treat local feedbacks as linear functions of $\\Delta T$.\n\nAssume:\n- The radiative forcing $\\Delta F(t)$ is defined as the part of $\\Delta R_n(t)$ that is independent of $\\Delta T(t)$ and is given by\n$$\n\\Delta F(t) = \\Delta S_\\downarrow(t) \\left(1 - \\alpha\\right) + \\Delta L_\\downarrow(t),\n$$\nwhere $\\Delta S_\\downarrow(t)$ is the downwelling shortwave anomaly (units $\\mathrm{W\\,m^{-2}}$), $\\Delta L_\\downarrow(t)$ is the downwelling longwave anomaly (units $\\mathrm{W\\,m^{-2}}$), and $\\alpha$ is the surface albedo (unitless).\n- The local feedbacks are linearized about a baseline temperature $T_0$ via\n$$\n\\Delta L_\\uparrow(t) \\approx 4 \\varepsilon \\sigma T_0^3 \\Delta T(t),\n$$\nwhere $\\varepsilon$ is the longwave emissivity (unitless) and $\\sigma$ is the Stefan–Boltzmann constant (units $\\mathrm{W\\,m^{-2}\\,K^{-4}}$). The associated Planck feedback coefficient is\n$$\n\\lambda_P = 4 \\varepsilon \\sigma T_0^3 \\quad \\text{(units $\\mathrm{W\\,m^{-2}\\,K^{-1}}$)}.\n$$\n- Turbulent flux feedbacks are parameterized as\n$$\n\\Delta H(t) + \\Delta LE(t) \\approx \\lambda_{\\mathrm{turb}} \\Delta T(t),\n$$\nwith $\\lambda_{\\mathrm{turb}}$ (units $\\mathrm{W\\,m^{-2}\\,K^{-1}}$), and the ground heat flux anomaly is\n$$\n\\Delta G(t) \\approx \\lambda_g \\Delta T(t),\n$$\nwith $\\lambda_g$ (units $\\mathrm{W\\,m^{-2}\\,K^{-1}}$).\n\nUnder these assumptions, the evolution equation becomes the linear ordinary differential equation\n$$\nC \\frac{d \\Delta T}{dt} = \\Delta F(t) + A(t) - \\lambda \\Delta T(t),\n$$\nwhere $\\lambda = \\lambda_P + \\lambda_{\\mathrm{turb}} + \\lambda_g$ (units $\\mathrm{W\\,m^{-2}\\,K^{-1}}$). By linearity, the solution can be decomposed into a part driven by radiative forcing and a part driven by advection:\n$$\n\\Delta T_{\\mathrm{total}}(t) = \\Delta T_F(t) + \\Delta T_A(t),\n$$\nwhere $\\Delta T_F$ solves $C \\frac{d \\Delta T_F}{dt} = \\Delta F(t) - \\lambda \\Delta T_F(t)$ and $\\Delta T_A$ solves $C \\frac{d \\Delta T_A}{dt} = A(t) - \\lambda \\Delta T_A(t)$.\n\nYour task is to write a program that:\n1. Constructs time series for $\\Delta S_\\downarrow(t)$, $\\Delta L_\\downarrow(t)$, and $A(t)$ over $N$ time steps with time step $\\Delta t$ (units $\\mathrm{s}$) using the specified parameter values below.\n2. Computes $\\Delta F(t)$ using the definition above.\n3. Integrates the two linear ordinary differential equations for $\\Delta T_F(t)$ and $\\Delta T_A(t)$ using a forward Euler method, starting from $\\Delta T_F(0)=0$ and $\\Delta T_A(0)=0$, and forms $\\Delta T_{\\mathrm{total}}(t)$.\n4. Computes the SEB residual $\\Delta R_n(t) - \\Delta H(t) - \\Delta LE(t) - \\Delta G(t)$ from the storage term $C \\frac{d \\Delta T_{\\mathrm{total}}}{dt}$.\n5. Reports, for each test case:\n   - The maximum temperature anomaly $\\max_t \\Delta T_{\\mathrm{total}}(t)$ in $\\mathrm{K}$.\n   - The advective contribution fraction defined as $\\max_t \\Delta T_A(t) \\,\\big/\\, \\max_t \\Delta T_{\\mathrm{total}}(t)$ as a decimal number; if the denominator is zero, define the fraction as $0$.\n   - The final-time SEB residual $C \\frac{\\Delta T_{\\mathrm{total}}(t_{N-1}) - \\Delta T_{\\mathrm{total}}(t_{N-2})}{\\Delta t}$ in $\\mathrm{W\\,m^{-2}}$.\n   - The time-mean radiative forcing $\\frac{1}{N}\\sum_{n=0}^{N-1} \\Delta F(t_n)$ in $\\mathrm{W\\,m^{-2}}$.\n\nTime series construction details (angles inside trigonometric functions are in radians):\n- Let $t_n = n \\Delta t$ for $n=0,1,\\dots,N-1$, and define the hour-of-day $h_n = \\left( \\frac{t_n}{3600} \\right) \\bmod 24$.\n- Use a diurnal shape function $s(h_n) = \\max\\left(0, \\sin\\left(\\pi \\frac{h_n}{24}\\right)\\right)$.\n- Set $\\Delta S_\\downarrow(t_n) = S_{\\mathrm{amp}} \\, s(h_n)$.\n- Set $\\Delta L_\\downarrow(t_n) = L_{\\mathrm{amp}}$ (constant in time).\n- Set $A(t_n) = A_{\\mathrm{amp}} \\, s(h_n)$.\n\nConstants and parameters common to all test cases:\n- $\\sigma = 5.670374419 \\times 10^{-8}$ $\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- $\\varepsilon = 1.0$ (unitless).\n- $\\alpha = 0.20$ (unitless).\n- $T_0 = 300$ $\\mathrm{K}$.\n- Forward Euler time step $\\Delta t = 3600$ $\\mathrm{s}$.\n- Number of steps $N = 72$.\n- Mixed-layer heat capacity $C = 2.5 \\times 10^{6}$ $\\mathrm{J\\,m^{-2}\\,K^{-1}}$.\n\nEach test case specifies $(S_{\\mathrm{amp}}, L_{\\mathrm{amp}}, A_{\\mathrm{amp}}, \\lambda_{\\mathrm{turb}}, \\lambda_g)$:\n- Test case $1$ (happy path): $(100, 20, 30, 8, 2)$.\n- Test case $2$ (no advection edge case): $(100, 20, 0, 8, 2)$.\n- Test case $3$ (advection-only edge case): $(0, 0, 60, 8, 2)$.\n- Test case $4$ (strong damping boundary case): $(100, 15, 10, 20, 5)$.\n\nUnits and output requirements:\n- Express the maximum temperature anomaly in $\\mathrm{K}$.\n- Express the advective contribution fraction as a decimal number (no percent sign).\n- Express the SEB residual in $\\mathrm{W\\,m^{-2}}$.\n- Express the mean radiative forcing in $\\mathrm{W\\,m^{-2}}$.\n- Your program should produce a single line of output containing a comma-separated list of four-element lists (one per test case), enclosed in square brackets, for example: $[\\,[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],\\,[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],\\,[r_{3,1},r_{3,2},r_{3,3},r_{3,4}],\\,[r_{4,1},r_{4,2},r_{4,3},r_{4,4}]\\,]$, where each $r_{i,j}$ is a floating-point value computed as described above.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of thermodynamics as applied to climate modeling, is mathematically well-posed as an initial value problem for a linear ordinary differential equation, and is objective, complete, and internally consistent. All necessary parameters, constants, initial conditions, and numerical methods are provided to arrive at a unique solution.\n\nThe solution proceeds by implementing a numerical simulation of the provided one-dimensional mixed-layer column model for each of the specified test cases.\n\n**1. Physical and Numerical Model Setup**\n\nThe core of the problem is the linear ordinary differential equation for the temperature anomaly $\\Delta T(t)$:\n$$\nC \\frac{d \\Delta T}{dt} = \\Delta F(t) + A(t) - \\lambda \\Delta T(t)\n$$\nwhere $C$ is the mixed-layer heat capacity, $\\Delta F(t)$ is the radiative forcing, $A(t)$ is the advective heat input, and $\\lambda$ is the total linear feedback parameter. The initial condition is $\\Delta T(0) = 0$.\n\nDue to the linearity of the equation, the total temperature anomaly $\\Delta T_{\\mathrm{total}}(t)$ can be decomposed into a component driven by radiative forcing, $\\Delta T_F(t)$, and a component driven by advection, $\\Delta T_A(t)$:\n$$\n\\Delta T_{\\mathrm{total}}(t) = \\Delta T_F(t) + \\Delta T_A(t)\n$$\nThese components are governed by the separate equations:\n$$\nC \\frac{d \\Delta T_F}{dt} = \\Delta F(t) - \\lambda \\Delta T_F(t), \\quad \\Delta T_F(0)=0\n$$\n$$\nC \\frac{d \\Delta T_A}{dt} = A(t) - \\lambda \\Delta T_A(t), \\quad \\Delta T_A(0)=0\n$$\n\nThe numerical integration is performed using the forward Euler method over $N$ time steps of size $\\Delta t$. For a generic equation of the form $\\frac{dy}{dt} = f(t, y)$, the forward Euler update is $y(t_{n+1}) = y(t_n) + \\Delta t \\cdot f(t_n, y(t_n))$. Applying this to our equations yields the discrete update rules:\n$$\n\\Delta T_F(t_{n+1}) = \\Delta T_F(t_n) + \\frac{\\Delta t}{C} \\left( \\Delta F(t_n) - \\lambda \\Delta T_F(t_n) \\right)\n$$\n$$\n\\Delta T_A(t_{n+1}) = \\Delta T_A(t_n) + \\frac{\\Delta t}{C} \\left( A(t_n) - \\lambda \\Delta T_A(t_n) \\right)\n$$\nwhere $t_n = n \\Delta t$ for $n = 0, 1, \\dots, N-2$.\n\n**2. Calculation of Parameters and Forcings**\n\nFirst, for each test case, we compute the total feedback parameter $\\lambda$. It is the sum of the Planck feedback $\\lambda_P$, the turbulent flux feedback $\\lambda_{\\mathrm{turb}}$, and the ground heat flux feedback $\\lambda_g$.\n$$\n\\lambda = \\lambda_P + \\lambda_{\\mathrm{turb}} + \\lambda_g\n$$\nThe Planck feedback coefficient, $\\lambda_P$, is calculated from fundamental constants and the reference temperature $T_0$:\n$$\n\\lambda_P = 4 \\varepsilon \\sigma T_0^3\n$$\nThe parameters $\\lambda_{\\mathrm{turb}}$ and $\\lambda_g$ are provided for each test case.\n\nThe constants used are:\n- Stefan-Boltzmann constant: $\\sigma = 5.670374419 \\times 10^{-8} \\, \\mathrm{W\\,m^{-2}\\,K^{-4}}$\n- Emissivity: $\\varepsilon = 1.0$\n- Albedo: $\\alpha = 0.20$\n- Reference temperature: $T_0 = 300 \\, \\mathrm{K}$\n- Mixed-layer heat capacity: $C = 2.5 \\times 10^6 \\, \\mathrm{J\\,m^{-2}\\,K^{-1}}$\n- Time step: $\\Delta t = 3600 \\, \\mathrm{s}$\n- Number of steps: $N = 72$\n\nNext, we construct the time series for the external forcings over the discrete time grid $t_n = n \\Delta t$ for $n = 0, 1, \\dots, N-1$.\nThe hour-of-day is $h_n = (t_n / 3600) \\bmod 24$, which simplifies to $h_n = n \\bmod 24$ since $\\Delta t = 3600\\,\\mathrm{s}$. A diurnal shape function $s(h_n)$ is defined as:\n$$\ns(h_n) = \\max\\left(0, \\sin\\left(\\pi \\frac{h_n}{24}\\right)\\right)\n$$\nThe forcing time series are then defined using the amplitudes $(S_{\\mathrm{amp}}, L_{\\mathrm{amp}}, A_{\\mathrm{amp}})$ from each test case:\n- Anomalous downwelling shortwave radiation: $\\Delta S_\\downarrow(t_n) = S_{\\mathrm{amp}} \\, s(h_n)$\n- Anomalous downwelling longwave radiation: $\\Delta L_\\downarrow(t_n) = L_{\\mathrm{amp}}$\n- Advective heat input: $A(t_n) = A_{\\mathrm{amp}} \\, s(h_n)$\n\nFrom these, the total radiative forcing time series $\\Delta F(t)$ is computed:\n$$\n\\Delta F(t_n) = \\Delta S_\\downarrow(t_n) (1 - \\alpha) + \\Delta L_\\downarrow(t_n)\n$$\n\n**3. Numerical Integration and Output Calculation**\n\nFor each test case, the following procedure is executed:\n1.  Initialize time series arrays of length $N$ for $\\Delta T_F(t)$ and $\\Delta T_A(t)$ to zero.\n2.  Iterate from $n = 0$ to $N-2$, applying the forward Euler update rules to compute $\\Delta T_F(t_{n+1})$ and $\\Delta T_A(t_{n+1})$ from the values at time $t_n$ and the forcings $\\Delta F(t_n)$ and $A(t_n)$.\n3.  Compute the total temperature anomaly time series: $\\Delta T_{\\mathrm{total}}(t_n) = \\Delta T_F(t_n) + \\Delta T_A(t_n)$ for all $n$.\n4.  Calculate the four required output quantities:\n    a.  **Maximum temperature anomaly**: The maximum value in the $\\Delta T_{\\mathrm{total}}(t)$ array is found: $\\max_{n \\in [0, N-1]} \\Delta T_{\\mathrm{total}}(t_n)$.\n    b.  **Advective contribution fraction**: This is the ratio of the maximum advection-driven anomaly to the maximum total anomaly: $\\frac{\\max_n \\Delta T_A(t_n)}{\\max_n \\Delta T_{\\mathrm{total}}(t_n)}$. If the denominator is zero, the fraction is defined as $0$.\n    c.  **Final-time SEB residual**: This is computed using a finite difference approximation of the storage term at the final time step, as specified: $C \\frac{\\Delta T_{\\mathrm{total}}(t_{N-1}) - \\Delta T_{\\mathrm{total}}(t_{N-2})}{\\Delta t}$. This value represents the net energy flux into the mixed layer at the end of the simulation period.\n    d.  **Time-mean radiative forcing**: This is the arithmetic mean of the $\\Delta F(t_n)$ time series: $\\frac{1}{N} \\sum_{n=0}^{N-1} \\Delta F(t_n)$.\n\nThe results from each test case, consisting of these four floating-point values, are collected and formatted into the specified list structure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mixed-layer column model problem for multiple test cases.\n    \"\"\"\n    # Define constants common to all test cases\n    SIGMA = 5.670374419e-8  # W m^-2 K^-4\n    EPSILON = 1.0\n    ALPHA = 0.20\n    T0 = 300.0  # K\n    DT = 3600.0  # s\n    N = 72\n    C = 2.5e6  # J m^-2 K^-1\n\n    # Define test cases: (S_amp, L_amp, A_amp, lambda_turb, lambda_g)\n    test_cases = [\n        (100.0, 20.0, 30.0, 8.0, 2.0),   # Test case 1\n        (100.0, 20.0, 0.0, 8.0, 2.0),    # Test case 2\n        (0.0, 0.0, 60.0, 8.0, 2.0),      # Test case 3\n        (100.0, 15.0, 10.0, 20.0, 5.0)    # Test case 4\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        s_amp, l_amp, a_amp, lambda_turb, lambda_g = case\n\n        # 1. Calculate feedback parameter\n        lambda_p = 4 * EPSILON * SIGMA * (T0 ** 3)\n        lambda_total = lambda_p + lambda_turb + lambda_g\n\n        # 2. Construct time series for forcings\n        t = np.arange(N) * DT\n        h = (t / 3600.0) % 24  # Hour of day\n\n        # Diurnal shape function\n        s_h = np.maximum(0, np.sin(np.pi * h / 24.0))\n\n        delta_S_down = s_amp * s_h\n        delta_L_down = np.full(N, l_amp)\n        A_t = a_amp * s_h\n\n        # Radiative forcing\n        delta_F = delta_S_down * (1 - ALPHA) + delta_L_down\n\n        # 3. Integrate the ODEs using Forward Euler\n        delta_T_F = np.zeros(N)\n        delta_T_A = np.zeros(N)\n\n        for n in range(N - 1):\n            # Update for radiative forcing component\n            dTf_dt = (delta_F[n] - lambda_total * delta_T_F[n]) / C\n            delta_T_F[n + 1] = delta_T_F[n] + dTf_dt * DT\n\n            # Update for advective component\n            dTa_dt = (A_t[n] - lambda_total * delta_T_A[n]) / C\n            delta_T_A[n + 1] = delta_T_A[n] + dTa_dt * DT\n        \n        delta_T_total = delta_T_F + delta_T_A\n\n        # 4. Compute the required output quantities\n        \n        # Max temperature anomaly\n        max_delta_T_total = np.max(delta_T_total)\n\n        # Advective contribution fraction\n        max_delta_T_A = np.max(delta_T_A)\n        if max_delta_T_total == 0:\n            advective_fraction = 0.0\n        else:\n            advective_fraction = max_delta_T_A / max_delta_T_total\n        \n        # Final-time SEB residual\n        # C * (delta_T_total(t_{N-1}) - delta_T_total(t_{N-2})) / dt\n        final_seb_residual = C * (delta_T_total[N - 1] - delta_T_total[N - 2]) / DT\n        \n        # Time-mean radiative forcing\n        mean_radiative_forcing = np.mean(delta_F)\n\n        # Store results for this case\n        case_results = [\n            max_delta_T_total,\n            advective_fraction,\n            final_seb_residual,\n            mean_radiative_forcing\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Beyond the physical mechanisms, the narrative of a storyline attribution study is powerfully shaped by how we define the event itself. This practice explores the crucial distinction between defining an extreme event by an absolute, fixed threshold (e.g., temperature exceeding $40^{\\circ}\\mathrm{C}$) versus a statistical, percentile-based threshold anchored to a past climate. By comparing the outcomes of these two approaches , you will develop a more nuanced understanding of how framing the question alters the quantitative attribution statement and its interpretation.",
            "id": "4095509",
            "problem": "A regional summer daily maximum temperature process is modeled as a Gaussian random variable with a time-dependent mean due to anthropogenic warming under a storyline framework that conditions on unchanged large-scale circulation. Specifically, let the daily maximum temperature $T(t)$ at time index $t$ have distribution $T(t) \\sim \\mathcal{N}(\\mu(t), \\sigma^{2})$, where $\\mu(t) = \\mu_{0} + \\gamma t$, and $\\sigma$ is constant. Assume a baseline era at $t = 0$ with $\\mu_{0} = 30\\,^{\\circ}\\mathrm{C}$ and $\\sigma = 3\\,^{\\circ}\\mathrm{C}$, and a present-day era at $t = 1$ with $\\mu_{1} = 32\\,^{\\circ}\\mathrm{C}$ (so $\\gamma = 2\\,^{\\circ}\\mathrm{C}$ per unit time). Consider two event definitions relevant to attribution storylines under nonstationary climatology:\n\n1) An absolute-threshold extreme event: $E_{\\mathrm{abs}}$ defined by $T(t) \\ge \\tau_{\\mathrm{abs}}$ with $\\tau_{\\mathrm{abs}} = 40\\,^{\\circ}\\mathrm{C}$.\n\n2) A percentile-threshold extreme event anchored to the baseline era: $E_{p}$ defined by $T(t) \\ge \\tau_{p}$, where $\\tau_{p}$ is the $95\\%$ quantile of $T(0)$.\n\nFor each event definition, the base rate at time $t$ is the exceedance probability $p(t) = \\mathbb{P}[T(t) \\ge \\tau]$, with $\\tau$ the threshold in the definition. Using the fundamental definition of a quantile for a continuous distribution, the cumulative distribution function for the Gaussian distribution, and the notion of exceedance probability, compute the base rates $p_{0}$ and $p_{1}$ for both $E_{\\mathrm{abs}}$ and $E_{p}$. Then, based on these base rates, select the option that correctly characterizes how the choice between a percentile threshold (anchored to baseline) and an absolute threshold changes the base rate and the interpretation of anthropogenic influence within a storyline that holds circulation fixed while shifting the thermodynamic background.\n\nA) For the percentile-threshold event anchored to the baseline, $p_{0} = 0.05$ and $p_{1} \\approx 0.163$ (a factor of approximately $3.3$ increase), whereas for the absolute-threshold event, $p_{0} \\approx 4.3 \\times 10^{-4}$ and $p_{1} \\approx 3.8 \\times 10^{-3}$ (a factor of approximately $8.8$ increase). Thus, the percentile threshold highlights that what was rare in the baseline becomes much more common, while the absolute threshold highlights the emergence and strong relative amplification of fixed-physical extremes; these distinct base-rate changes lead to different storyline interpretations of anthropogenic influence.\n\nB) The percentile-threshold event has $p_{0} = 0.05$ and $p_{1} = 0.05$ because percentiles always preserve rarity across time, while the absolute-threshold event increases only by a factor of approximately $3$; therefore, anthropogenic influence is negligible for fixed thresholds but neutralized by percentile-based definitions.\n\nC) For the percentile-threshold event anchored to the baseline, $p_{0} = 0.05$ but $p_{1} < 0.05$ because the variance is unchanged, whereas for the absolute-threshold event, $p_{0} \\approx 0.01$ and $p_{1} \\approx 0.02$; hence, the threshold choice minimally affects the storyline interpretation.\n\nD) The absolute-threshold event has $p_{0} = p_{1}$ because a fixed threshold preserves the base rate under a location shift, whereas the percentile-threshold event anchored to the baseline has $p_{0} = 0.05$ and $p_{1} \\approx 0.05$; therefore, threshold choice does not alter the attribution storyline under nonstationarity.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and internally consistent. All necessary data are provided to solve the problem.\n\nThe problem asks us to compute and compare the change in base rates (probabilities) for two types of extreme events under a nonstationary climate model, and to assess the implications for attribution storylines. The temperature $T(t)$ at time $t$ is modeled as a Gaussian random variable $T(t) \\sim \\mathcal{N}(\\mu(t), \\sigma^2)$, with a mean that increases linearly with time, $\\mu(t) = \\mu_0 + \\gamma t$.\n\nThe given parameters are:\n-   Baseline climate ($t=0$): Mean $\\mu_0 = 30\\,^{\\circ}\\mathrm{C}$, Standard deviation $\\sigma = 3\\,^{\\circ}\\mathrm{C}$. So, $T(0) \\sim \\mathcal{N}(30, 3^2)$.\n-   Present-day climate ($t=1$): Mean $\\mu_1 = 32\\,^{\\circ}\\mathrm{C}$. So, $T(1) \\sim \\mathcal{N}(32, 3^2)$.\n-   The warming rate is $\\gamma = \\mu_1 - \\mu_0 = 2\\,^{\\circ}\\mathrm{C}$ per unit time.\n-   The standard normal random variable is denoted by $Z \\sim \\mathcal{N}(0, 1)$, and its cumulative distribution function (CDF) is $\\Phi(z) = \\mathbb{P}[Z \\le z]$. The exceedance probability is $1 - \\Phi(z)$.\n\nWe will analyze each event definition separately.\n\n### 1. Percentile-Threshold Event ($E_p$)\n\nThis event is defined as $T(t) \\ge \\tau_p$, where the threshold $\\tau_p$ is the $95\\%$ quantile of the baseline temperature distribution $T(0)$.\n\n**Base Rate at Baseline ($t=0$):**\nThe base rate is $p_0(E_p) = \\mathbb{P}[T(0) \\ge \\tau_p]$. By definition of $\\tau_p$ as the $95\\%$ quantile, we have $\\mathbb{P}[T(0) < \\tau_p] = 0.95$. For a continuous distribution, this implies $\\mathbb{P}[T(0) \\ge \\tau_p] = 1 - 0.95 = 0.05$.\nSo, the baseline probability is exactly:\n$$p_0(E_p) = 0.05$$\n\n**Base Rate in Present-Day ($t=1$):**\nFirst, we must find the numerical value of the threshold $\\tau_p$. We standardize the random variable $T(0)$:\n$$ \\mathbb{P}[T(0) \\le \\tau_p] = \\mathbb{P}\\left[ \\frac{T(0) - \\mu_0}{\\sigma} \\le \\frac{\\tau_p - \\mu_0}{\\sigma} \\right] = 0.95 $$\n$$ \\Phi\\left( \\frac{\\tau_p - 30}{3} \\right) = 0.95 $$\nThe argument of $\\Phi$ must be the $95\\%$ quantile of the standard normal distribution, $z_{0.95}$. From standard tables or a calculator, $z_{0.95} \\approx 1.645$.\n$$ \\frac{\\tau_p - 30}{3} = z_{0.95} \\approx 1.645 $$\n$$ \\tau_p \\approx 30 + 3 \\times 1.645 = 30 + 4.935 = 34.935\\,^{\\circ}\\mathrm{C} $$\nNow we compute the probability of exceeding this fixed threshold in the present-day climate, where $T(1) \\sim \\mathcal{N}(32, 3^2)$:\n$$ p_1(E_p) = \\mathbb{P}[T(1) \\ge \\tau_p] = \\mathbb{P}[T(1) \\ge 34.935] $$\nStandardizing with the present-day parameters:\n$$ p_1(E_p) = \\mathbb{P}\\left[ \\frac{T(1) - \\mu_1}{\\sigma} \\ge \\frac{34.935 - 32}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{2.935}{3} \\right] \\approx \\mathbb{P}[Z \\ge 0.9783] $$\n$$ p_1(E_p) = 1 - \\Phi(0.9783) \\approx 1 - 0.8361 = 0.1639 $$\nSo, $p_1(E_p) \\approx 0.164$. The factor of increase is $\\frac{p_1(E_p)}{p_0(E_p)} \\approx \\frac{0.1639}{0.05} \\approx 3.28$.\n\n### 2. Absolute-Threshold Event ($E_{\\mathrm{abs}}$)\n\nThis event is defined as $T(t) \\ge \\tau_{\\mathrm{abs}}$, with a fixed physical threshold $\\tau_{\\mathrm{abs}} = 40\\,^{\\circ}\\mathrm{C}$.\n\n**Base Rate at Baseline ($t=0$):**\nThe base rate is $p_0(E_{\\mathrm{abs}}) = \\mathbb{P}[T(0) \\ge 40]$. We standardize using the baseline parameters:\n$$ p_0(E_{\\mathrm{abs}}) = \\mathbb{P}\\left[ \\frac{T(0) - 30}{3} \\ge \\frac{40 - 30}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{10}{3} \\right] \\approx \\mathbb{P}[Z \\ge 3.333] $$\n$$ p_0(E_{\\mathrm{abs}}) = 1 - \\Phi(3.333) \\approx 1 - 0.99957 = 0.00043 = 4.3 \\times 10^{-4} $$\n\n**Base Rate in Present-Day ($t=1$):**\nThe base rate is $p_1(E_{\\mathrm{abs}}) = \\mathbb{P}[T(1) \\ge 40]$. We standardize using the present-day parameters:\n$$ p_1(E_{\\mathrm{abs}}) = \\mathbb{P}\\left[ \\frac{T(1) - 32}{3} \\ge \\frac{40 - 32}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{8}{3} \\right] \\approx \\mathbb{P}[Z \\ge 2.667] $$\n$$ p_1(E_{\\mathrm{abs}}) = 1 - \\Phi(2.667) \\approx 1 - 0.99617 = 0.00383 = 3.83 \\times 10^{-3} $$\nThe factor of increase is $\\frac{p_1(E_{\\mathrm{abs}})}{p_0(E_{\\mathrm{abs}})} \\approx \\frac{3.83 \\times 10^{-3}}{4.3 \\times 10^{-4}} \\approx 8.91$.\n\n### Summary and Evaluation of Options\n\n-   For $E_p$: $p_0 = 0.05$ and $p_1 \\approx 0.164$. Ratio $\\approx 3.3$.\n-   For $E_{\\mathrm{abs}}$: $p_0 \\approx 4.3 \\times 10^{-4}$ and $p_1 \\approx 3.8 \\times 10^{-3}$. Ratio $\\approx 8.9$.\n\nNow we evaluate each option:\n\n**A) For the percentile-threshold event anchored to the baseline, $p_{0} = 0.05$ and $p_{1} \\approx 0.163$ (a factor of approximately $3.3$ increase), whereas for the absolute-threshold event, $p_{0} \\approx 4.3 \\times 10^{-4}$ and $p_{1} \\approx 3.8 \\times 10^{-3}$ (a factor of approximately $8.8$ increase). Thus, the percentile threshold highlights that what was rare in the baseline becomes much more common, while the absolute threshold highlights the emergence and strong relative amplification of fixed-physical extremes; these distinct base-rate changes lead to different storyline interpretations of anthropogenic influence.**\n\n-   The numerical values are consistent with our calculations ($0.163$ vs. $0.164$, $8.8$ vs. $8.9$ are minor rounding differences). All other numbers match precisely.\n-   The interpretation is correct. The percentile event shows a formerly $1$-in-$20$ event becoming a $1$-in-$6$ event (more common), while the absolute event shows a physically extreme and very rare event ($1$-in-$2300$) becoming much more probable ($1$-in-$260$), representing a large *relative* amplification. These two perspectives (\"what was rare is now more common\" vs. \"what was almost impossible is now possible\") are indeed different but complementary storylines in attribution.\n-   Verdict: **Correct**.\n\n**B) The percentile-threshold event has $p_{0} = 0.05$ and $p_{1} = 0.05$ because percentiles always preserve rarity across time, while the absolute-threshold event increases only by a factor of approximately $3$; therefore, anthropogenic influence is negligible for fixed thresholds but neutralized by percentile-based definitions.**\n\n-   The claim that $p_1 = 0.05$ is incorrect. Our calculation shows $p_1 \\approx 0.164$. The reasoning is flawed; the threshold is anchored to the baseline, not re-calculated for the present day.\n-   The claim that the absolute-threshold event increases by a factor of $\\approx 3$ is incorrect. Our calculation shows a factor of $\\approx 8.9$.\n-   Verdict: **Incorrect**.\n\n**C) For the percentile-threshold event anchored to the baseline, $p_{0} = 0.05$ but $p_{1} < 0.05$ because the variance is unchanged, whereas for the absolute-threshold event, $p_{0} \\approx 0.01$ and $p_{1} \\approx 0.02$; hence, the threshold choice minimally affects the storyline interpretation.**\n\n-   The claim $p_1 < 0.05$ is incorrect. With a shift of the mean to a higher value, the probability of exceeding a fixed threshold must increase.\n-   The values $p_0 \\approx 0.01$ and $p_1 \\approx 0.02$ for the absolute event are incorrect. Our calculations gave $p_0 \\approx 4.3 \\times 10^{-4}$ and $p_1 \\approx 3.8 \\times 10^{-3}$.\n-   Verdict: **Incorrect**.\n\n**D) The absolute-threshold event has $p_{0} = p_{1}$ because a fixed threshold preserves the base rate under a location shift, whereas the percentile-threshold event anchored to the baseline has $p_{0} = 0.05$ and $p_{1} \\approx 0.05$; therefore, threshold choice does not alter the attribution storyline under nonstationarity.**\n\n-   The claim $p_0 = p_1$ for the absolute event is incorrect. Shifting the distribution's location (mean) while keeping the threshold fixed explicitly changes the exceedance probability.\n-   The claim $p_1 \\approx 0.05$ for the percentile event is incorrect. Our calculation shows the change is significant, from $0.05$ to $\\approx 0.164$.\n-   Verdict: **Incorrect**.\n\nBased on the detailed derivation, only option A provides both the correct calculations and the correct scientific interpretation.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}