{
    "hands_on_practices": [
        {
            "introduction": "辐射传输是气候系统的“引擎”，决定着地球的能量平衡。本练习将引导您从基本的辐射传输方程出发，推导出一个广泛使用的简化方案——双流近似，从而深入理解在气候模型中复杂物理过程是如何被简化的。通过为一个假设的大气廓线计算大气层顶的净通量，您将亲手实践每个气候模型辐射分量中的核心计算。",
            "id": "4025073",
            "problem": "您正在一个全球气候模式中，使用双流构架为平面平行大气实现辐射分量。目标是从第一性原理出发，获得半球解析的通量方程，然后针对特定的大气廓线计算一个大气层顶的诊断量。从灰色介质的辐射传输方程 (RTE) 开始，其基本表述为：对于方向余弦为 $\\mu$ 的强度 $I(\\tau,\\mu)$，RTE 为 $\\mu\\,\\frac{\\partial I}{\\partial \\tau} = I - S$，其中光学厚度 $\\tau$ 向下增加，源函数 $S$ 是热发射和散射贡献之和。定义单次散射反照率 $\\omega$ 为散射与消光之比，普朗克函数为 $B(T)$，并回顾向上半球通量和向下半球通量分别为 $F^{\\uparrow} = \\int_{0}^{2\\pi}\\int_{0}^{1} I(\\tau,\\mu)\\,\\mu\\,d\\mu\\,d\\phi$ 和 $F^{\\downarrow} = \\int_{0}^{2\\pi}\\int_{-1}^{0} I(\\tau,\\mu)\\,\\mu\\,d\\mu\\,d\\phi$。采用双流半球（Eddington）闭合，使得每个半球由单一的特征方向表示，并定义光学厚度标度，使得单位光学厚度的热发射对每个半球通量方程的贡献为 $\\pi B(T)$。\n\n任务1（推导）：在这些假设下，推导控制灰色大气中 $F^{\\uparrow}(\\tau)$ 和 $F^{\\downarrow}(\\tau)$ 的耦合一阶常微分方程。清晰地陈述 $\\omega$ 在一般形式中的作用，并展示当散射可忽略时（$\\omega = 0$）方程的简化形式。\n\n任务2（计算）：考虑热红外（长波）极限，此时散射可忽略，即 $\\omega = 0$。设一个总光学厚度为 $\\tau_{s}$、温度为 $T_{a}$ 的均匀等温大气层，位于温度为 $T_{s}$ 的黑体表面（表面发射率为1）之上。大气层顶 (TOA) 的边界条件是无来自太空的向下长波辐射，即 $F^{\\downarrow}(0) = 0$；下边界条件为 $F^{\\uparrow}(\\tau_{s}) = \\sigma T_{s}^{4}$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。使用您推导出的通量方程，为给定的廓线计算大气层顶净长波通量 $F_{\\text{net}}^{\\text{TOA}} \\equiv F^{\\downarrow}(0) - F^{\\uparrow}(0)$：\n- $T_{a} = 255\\,\\text{K}$,\n- $T_{s} = 288\\,\\text{K}$,\n- $\\tau_{s} = 2$,\n- $\\sigma = 5.670374419 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$.\n\n以瓦特每平方米为单位表示最终的净通量，并将答案四舍五入至四位有效数字。最终的方框答案中不要包含单位。",
            "solution": "经评估，该问题在科学上是成立的、适定的，并且为得出唯一解提供了充分的信息。其语言虽然在“光学厚度标度”方面包含一些特殊措辞，但在辐射传输理论的标准框架内可以得到一致的解释。因此，该问题是有效的。\n\n**任务1：双流通量方程的推导**\n\n我们从灰色、平面平行大气的辐射传输方程（RTE）开始，其形式如下：\n$$\n\\mu\\,\\frac{\\partial I(\\tau,\\mu)}{\\partial \\tau} = I(\\tau,\\mu) - S(\\tau)\n$$\n其中 $I$ 是强度，$\\tau$ 是向下增加的光学厚度，$\\mu$ 是天顶角的余弦，而 $S$ 是源函数。在这个灰色大气中，源函数包括热发射和各向同性散射：\n$$\nS(\\tau) = (1-\\omega)B(\\tau) + \\omega J(\\tau)\n$$\n这里，$\\omega$ 是单次散射反照率，$B(\\tau)$ 是普朗克函数（隐含为 $B(T(\\tau))$），$J(\\tau)$ 是平均强度，定义为 $J = \\frac{1}{4\\pi}\\int_{4\\pi} I d\\Omega$。\n\n双流近似通过将向上半球（$\\mu>0$）的强度表示为单个值 $I^+(\\tau)$ 和向下半球（$\\mu0$）的强度表示为单个值 $I^-(\\tau)$ 来简化辐射场。这等效于在两个特征方向余弦 $\\pm\\bar{\\mu}$ 处评估RTE，其中 $\\bar{\\mu} \\in (0, 1)$。\n因此，RTE 变成一个由两个常微分方程组成的系统：\n$$\n\\bar{\\mu} \\frac{dI^+}{d\\tau} = I^+ - S \\quad (\\text{for } \\mu = \\bar{\\mu})\n$$\n$$\n-\\bar{\\mu} \\frac{dI^-}{d\\tau} = I^- - S \\quad (\\text{for } \\mu = -\\bar{\\mu})\n$$\n半球通量定义为强度的积分。在双流假设下，它们变为：\n$$\nF^{\\uparrow}(\\tau) = \\int_{0}^{2\\pi}\\int_{0}^{1} I(\\tau,\\mu)\\,\\mu\\,d\\mu\\,d\\phi = \\int_{0}^{2\\pi}\\int_{0}^{1} I^+\\,\\mu\\,d\\mu\\,d\\phi = I^+ \\cdot 2\\pi \\cdot \\frac{1}{2} = \\pi I^+\n$$\n$$\nF^{\\downarrow}(\\tau) = \\int_{0}^{2\\pi}\\int_{-1}^{0} I(\\tau,\\mu)\\,\\mu\\,d\\mu\\,d\\phi = \\int_{0}^{2\\pi}\\int_{-1}^{0} I^-\\,\\mu\\,d\\mu\\,d\\phi = I^- \\cdot 2\\pi \\cdot \\left(-\\frac{1}{2}\\right) = -\\pi I^-\n$$\n由此，我们用通量来表示强度：$I^+ = F^{\\uparrow}/\\pi$ 和 $I^- = -F^{\\downarrow}/\\pi$。注意，根据此定义，$F^{\\uparrow} \\ge 0$ 且 $F^{\\downarrow} \\le 0$。\n\n现在可以用通量来表示平均强度 $J$。假设每个半球内的强度是各向同性的：\n$$\nJ = \\frac{1}{2}\\left( \\int_{0}^{1} I^+ d\\mu' + \\int_{-1}^{0} I^- d\\mu' \\right) = \\frac{1}{2}(I^+ + I^-) = \\frac{1}{2}\\left(\\frac{F^{\\uparrow}}{\\pi} - \\frac{F^{\\downarrow}}{\\pi}\\right) = \\frac{1}{2\\pi}(F^{\\uparrow} - F^{\\downarrow})\n$$\n将此代入源函数表达式中：\n$$\nS = (1-\\omega)B + \\frac{\\omega}{2\\pi}(F^{\\uparrow} - F^{\\downarrow})\n$$\n现在，我们将基于通量的 $I^+$、$I^-$ 和 $S$ 的表达式代入双流 RTE 中：\n$$\n\\bar{\\mu} \\frac{d}{d\\tau}\\left(\\frac{F^{\\uparrow}}{\\pi}\\right) = \\frac{F^{\\uparrow}}{\\pi} - \\left[(1-\\omega)B + \\frac{\\omega}{2\\pi}(F^{\\uparrow} - F^{\\downarrow})\\right]\n$$\n$$\n-\\bar{\\mu} \\frac{d}{d\\tau}\\left(\\frac{-F^{\\downarrow}}{\\pi}\\right) = \\frac{-F^{\\downarrow}}{\\pi} - \\left[(1-\\omega)B + \\frac{\\omega}{2\\pi}(F^{\\uparrow} - F^{\\downarrow})\\right]\n$$\n将两方程同乘以 $\\pi$ 并化简，得到：\n$$\n\\bar{\\mu} \\frac{dF^{\\uparrow}}{d\\tau} = F^{\\uparrow} - \\pi(1-\\omega)B - \\frac{\\omega}{2}(F^{\\uparrow} - F^{\\downarrow}) = \\left(1-\\frac{\\omega}{2}\\right)F^{\\uparrow} + \\frac{\\omega}{2}F^{\\downarrow} - \\pi(1-\\omega)B\n$$\n$$\n\\bar{\\mu} \\frac{dF^{\\downarrow}}{d\\tau} = -F^{\\downarrow} - \\pi(1-\\omega)B - \\frac{\\omega}{2}(F^{\\uparrow} - F^{\\downarrow}) = -\\frac{\\omega}{2}F^{\\uparrow} - \\left(1-\\frac{\\omega}{2}\\right)F^{\\downarrow} - \\pi(1-\\omega)B\n$$\n问题指明要“定义光学厚度标度”，以使方程呈现规范形式。这可以通过定义一个标度化光学厚度 $\\tau' = \\tau/\\bar{\\mu}$ 来实现。根据此定义，$d\\tau' = d\\tau/\\bar{\\mu}$，因此 $\\frac{d}{d\\tau} = \\frac{1}{\\bar{\\mu}}\\frac{d}{d\\tau'}$。将此代入方程并消去因子 $\\bar{\\mu}$（这等效于将方程除以 $\\bar{\\mu}$ 并将结果与关于 $\\tau'$ 的导数关联起来），我们得到最终的耦合常微分方程组。为清晰起见，我们去掉 $\\tau$ 上的撇号，但理解它代表的是标度化光学厚度：\n$$\n\\frac{dF^{\\uparrow}}{d\\tau} = \\left(1-\\frac{\\omega}{2}\\right)F^{\\uparrow} + \\frac{\\omega}{2}F^{\\downarrow} - \\pi(1-\\omega)B\n$$\n$$\n\\frac{dF^{\\downarrow}}{d\\tau} = -\\frac{\\omega}{2}F^{\\uparrow} - \\left(1-\\frac{\\omega}{2}\\right)F^{\\downarrow} - \\pi(1-\\omega)B\n$$\n这些方程显示了 $\\omega$ 的作用。与 $\\omega$ 成正比的项代表了从一个半球散射到另一个半球的通量，从而耦合了方程。因子 $(1-\\omega)$ 调节了热发射的强度。\n\n对于散射可忽略的情况（$\\omega = 0$），这些方程简化为：\n$$\n\\frac{dF^{\\uparrow}}{d\\tau} = F^{\\uparrow} - \\pi B\n$$\n$$\n\\frac{dF^{\\downarrow}}{d\\tau} = -F^{\\downarrow} - \\pi B\n$$\n在此极限下，两个通量方程是解耦的。\n\n**任务2：大气层顶净长波通量的计算**\n\n我们使用为无散射情况（$\\omega = 0$）推导出的方程。大气是温度为 $T_a$ 的等温层，因此普朗克函数 $B$ 是常数。源项 $\\pi B$ 由黑体的斯特藩-玻尔兹曼定律给出，$S_a = \\pi B(T_a) = \\sigma T_a^4$。控制性常微分方程变为：\n$$\n\\frac{dF^{\\uparrow}}{d\\tau} = F^{\\uparrow} - \\sigma T_a^4\n$$\n$$\n\\frac{dF^{\\downarrow}}{d\\tau} = -F^{\\downarrow} - \\sigma T_a^4\n$$\n这些是线性一阶非齐次常微分方程。$F^{\\uparrow}(\\tau)$ 的通解可以通过将方程改写为 $\\frac{dF^{\\uparrow}}{d\\tau} - F^{\\uparrow} = -\\sigma T_a^4$ 来求得。积分因子为 $\\exp(-\\tau)$，得到：\n$$\n\\frac{d}{d\\tau}(F^{\\uparrow}e^{-\\tau}) = -\\sigma T_a^4 e^{-\\tau} \\implies F^{\\uparrow}(\\tau)e^{-\\tau} = \\sigma T_a^4 e^{-\\tau} + C_1 \\implies F^{\\uparrow}(\\tau) = \\sigma T_a^4 + C_1 e^{\\tau}\n$$\n$F^{\\downarrow}(\\tau)$ 的通解从 $\\frac{dF^{\\downarrow}}{d\\tau} + F^{\\downarrow} = -\\sigma T_a^4$ 求得。积分因子为 $\\exp(\\tau)$，得到：\n$$\n\\frac{d}{d\\tau}(F^{\\downarrow}e^{\\tau}) = -\\sigma T_a^4 e^{\\tau} \\implies F^{\\downarrow}(\\tau)e^{\\tau} = -\\sigma T_a^4 e^{\\tau} + C_2 \\implies F^{\\downarrow}(\\tau) = -\\sigma T_a^4 + C_2 e^{-\\tau}\n$$\n常数 $C_1$ 和 $C_2$ 由边界条件确定。\n1.  大气层顶 (TOA) 处，$\\tau=0$：$F^{\\downarrow}(0) = 0$。\n    $F^{\\downarrow}(0) = -\\sigma T_a^4 + C_2 e^0 = 0 \\implies C_2 = \\sigma T_a^4$。\n    因此，向下通量为 $F^{\\downarrow}(\\tau) = -\\sigma T_a^4 + \\sigma T_a^4 e^{-\\tau} = \\sigma T_a^4 (e^{-\\tau}-1)$。\n2.  地表处，$\\tau=\\tau_s$：向上通量等于温度为 $T_s$ 的黑体表面的发射，因此 $F^{\\uparrow}(\\tau_s) = \\sigma T_s^4$。\n    $F^{\\uparrow}(\\tau_s) = \\sigma T_a^4 + C_1 e^{\\tau_s} = \\sigma T_s^4 \\implies C_1 = (\\sigma T_s^4 - \\sigma T_a^4)e^{-\\tau_s}$。\n    因此，向上通量为 $F^{\\uparrow}(\\tau) = \\sigma T_a^4 + (\\sigma T_s^4 - \\sigma T_a^4)e^{\\tau - \\tau_s}$。\n\n我们需要计算大气层顶净长波通量，$F_{\\text{net}}^{\\text{TOA}} = F^{\\downarrow}(0) - F^{\\uparrow}(0)$。\n根据边界条件，$F^{\\downarrow}(0) = 0$。\n大气层顶的向上通量为：\n$$\nF^{\\uparrow}(0) = \\sigma T_a^4 + (\\sigma T_s^4 - \\sigma T_a^4)e^{0 - \\tau_s} = \\sigma T_a^4 + (\\sigma T_s^4 - \\sigma T_a^4)e^{-\\tau_s}\n$$\n$$\nF^{\\uparrow}(0) = \\sigma T_a^4 (1 - e^{-\\tau_s}) + \\sigma T_s^4 e^{-\\tau_s}\n$$\n因此，净通量为：\n$$\nF_{\\text{net}}^{\\text{TOA}} = 0 - F^{\\uparrow}(0) = -[\\sigma T_a^4 (1 - e^{-\\tau_s}) + \\sigma T_s^4 e^{-\\tau_s}]\n$$\n现在，我们代入给定的数值：\n$T_a = 255\\,\\text{K}$\n$T_s = 288\\,\\text{K}$\n$\\tau_s = 2$\n$\\sigma = 5.670374419 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$\n\n首先，我们计算黑体发射项：\n$$\n\\sigma T_a^4 = (5.670374419 \\times 10^{-8}) \\cdot (255)^4 \\approx 239.9525\\,\\text{W}\\,\\text{m}^{-2}\n$$\n$$\n\\sigma T_s^4 = (5.670374419 \\times 10^{-8}) \\cdot (288)^4 \\approx 390.0965\\,\\text{W}\\,\\text{m}^{-2}\n$$\n大气透射率项为：\n$$\ne^{-\\tau_s} = e^{-2} \\approx 0.135335\n$$\n大气发射率项为：\n$$\n1 - e^{-\\tau_s} = 1 - e^{-2} \\approx 0.864665\n$$\n将这些值代入 $F^{\\uparrow}(0)$ 的表达式中：\n$$\nF^{\\uparrow}(0) \\approx (239.9525) \\cdot (0.864665) + (390.0965) \\cdot (0.135335)\n$$\n$$\nF^{\\uparrow}(0) \\approx 207.4699 + 52.8028 \\approx 260.2727\\,\\text{W}\\,\\text{m}^{-2}\n$$\n大气层顶净通量是该值的负数：\n$$\nF_{\\text{net}}^{\\text{TOA}} = -F^{\\uparrow}(0) \\approx -260.2727\\,\\text{W}\\,\\text{m}^{-2}\n$$\n四舍五入到四位有效数字，我们得到 $-260.3$。",
            "answer": "$$\\boxed{-260.3}$$"
        },
        {
            "introduction": "云和降水是气候系统中的关键环节，但其完整模拟在计算上极为昂贵。因此，模型依赖“微物理参数化”方案来表征这些过程，本练习将带您逐步完成一个典型的暖雨过程方案。您将计算在一个时间步长内水汽、云水和雨水混合比的变化，从而学习不同过程是如何按顺序组合，并通过潜热释放共同影响模型的热力状态。",
            "id": "4025117",
            "problem": "在一个大气数值模式中，一个单柱微物理模块使用分离物理架构和前向欧拉更新，在一个时间步长内推进水汽、云液水和雨水的预报混合比。该模式通过与相变相关的潜热加热和冷却来强制总水物质质量守恒和能量守恒。冰相过程不存在。在微物理子步中没有降水降落或沉降。该步长内热力学压力假定为常数，定压比热容也视为常数。\n\n在一个模式层上，时间 $t^{n}$ 的初始热力学和水凝物状态为：\n- 温度 $T^{n} = 285$ K，气压 $p = 90000$ Pa。\n- 水汽混合比 $q_{v}^{n} = 0.0100$ kg kg$^{-1}$。\n- 云液水混合比 $q_{c}^{n} = 0.001200$ kg kg$^{-1}$。\n- 雨水混合比 $q_{r}^{n} = 0.000600$ kg kg$^{-1}$。\n- 在 $(T^{n},p)$ 条件下液态水的饱和水汽混合比为 $q_{vs}(T^{n}) = 0.01150$ kg kg$^{-1}$。一个用于表示饱和度对温度敏感性的局部线性化系数可用，但仅在需要时使用：$\\gamma \\equiv \\left.\\frac{dq_{vs}}{dT}\\right|_{T^{n}} = 1.8 \\times 10^{-4}$ kg kg$^{-1}$ K$^{-1}$。\n\n每个时间步长 $\\Delta t = 300$ s 的微物理架构如下：\n1. 凝结的饱和度调整：如果空气相对于液态水过饱和（$q_{v}^{n}  q_{vs}(T^{n})$），则瞬时凝结足够的水汽以恢复饱和状态，同时在定压下保持湿焓守恒。如果空气未过饱和，则此步不发生凝结。\n2. 使用前向欧拉和在步长开始时评估的冻结系数进行的暖雨转化过程：\n   - 自动转化以速率 $R_{\\mathrm{auto}} = C_{a} \\max(q_{c} - q_{c0}, 0)$ 将云液水转化为雨水，其中 $C_{a} = 1.0 \\times 10^{-3}$ s$^{-1}$，阈值 $q_{c0} = 1.0 \\times 10^{-3}$ kg kg$^{-1}$。\n   - 碰并以速率 $R_{\\mathrm{accr}} = C_{k}\\, q_{c}\\, q_{r}$ 将云液水转化为雨水，其中 $C_{k} = 1.0$ s$^{-1}$。\n3. 使用前向欧拉和在步长开始时评估的冻结系数进行的雨滴蒸发：如果 $\\mathrm{RH}  1$，蒸发速率为 $R_{\\mathrm{evap}} = E_{0}\\, q_{r}\\, \\left(1 - \\mathrm{RH}\\right)$，否则 $R_{\\mathrm{evap}} = 0$。其中 $E_{0} = 2.0 \\times 10^{-3}$ s$^{-1}$，相对湿度 $\\mathrm{RH} = q_{v}/q_{vs}(T)$ 在 $(T^{n}, q_{v}^{n})$ 处评估。蒸发使 $q_{v}$ 增加，$q_{r}$ 减少，且改变量相等。\n\n用于潜热加热和感热的热力学常数为：\n- 蒸发潜热 $L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$。\n- 湿空气的定压比热容 $c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$。\n\n假设自动转化和碰并不直接影响温度（它们仅在水凝物种类之间重新分配液态水），而凝结和蒸发通过潜热加热或冷却来改变温度。忽略该步长内 $c_{p}$ 和 $L_{v}$ 的任何温度依赖性，并忽略动能变化。\n\n使用上述架构和参数，计算微物理步骤结束时的温度 $T^{n+1}$，确保根据湿空气在定压相变下的热力学第一定律，总水物质混合比和能量守恒。最终答案以K为单位表示，并四舍五入到四位有效数字。最终答案必须是单个实数。",
            "solution": "用户提供了一个来自大气科学领域的问题，具体涉及一个数值微物理方案。问题是在遵循一系列预定的物理过程参数化后，计算一个时间步长后的最终温度。\n\n**问题验证**\n\n首先，评估问题陈述的有效性。\n\n**步骤 1：提取已知条件**\n- 时间 $t^n$ 的初始状态：\n  - 温度: $T^{n} = 285$ K\n  - 气压: $p = 90000$ Pa\n  - 水汽混合比: $q_{v}^{n} = 0.0100$ kg kg$^{-1}$\n  - 云液水混合比: $q_{c}^{n} = 0.001200$ kg kg$^{-1}$\n  - 雨水混合比: $q_{r}^{n} = 0.000600$ kg kg$^{-1}$\n  - 在 $(T^{n},p)$ 下的饱和水汽混合比: $q_{vs}(T^{n}) = 0.01150$ kg kg$^{-1}$\n  - 饱和度的线性化系数: $\\gamma = 1.8 \\times 10^{-4}$ kg kg$^{-1}$ K$^{-1}$\n- 时间步长: $\\Delta t = 300$ s\n- 微物理过程和参数:\n  1. 凝结的饱和度调整。\n  2. 暖雨转化:\n     - 自动转化速率: $R_{\\mathrm{auto}} = C_{a} \\max(q_{c} - q_{c0}, 0)$，其中 $C_{a} = 1.0 \\times 10^{-3}$ s$^{-1}$ 且 $q_{c0} = 1.0 \\times 10^{-3}$ kg kg$^{-1}$。\n     - 碰并速率: $R_{\\mathrm{accr}} = C_{k}\\, q_{c}\\, q_{r}$，其中 $C_{k} = 1.0$ s$^{-1}$。\n  3. 雨滴蒸发:\n     - 蒸发速率: $R_{\\mathrm{evap}} = E_{0}\\, q_{r}\\, \\left(1 - \\mathrm{RH}\\right)$ (对于 $\\mathrm{RH}  1$)，其中 $E_{0} = 2.0 \\times 10^{-3}$ s$^{-1}$。\n     - 相对湿度 $\\mathrm{RH} = q_{v}/q_{vs}(T)$ 在 $(T^{n}, q_{v}^{n})$ 处评估。\n- 热力学常数:\n  - 蒸发潜热: $L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$。\n  - 定压比热容: $c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$。\n- 假设：采用顺序更新的分离物理方案，使用时间步开始时的冻结系数进行前向欧拉积分，质量和能量守恒。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题使用了标准的参数化方案（Kessler 型暖雨）、基本守恒定律（质量、能量）以及来自大气科学的真实物理常数和初始条件。它在科学上是合理的。\n- **适定性**：该问题提供了清晰的操作顺序和所有必要的数据。指令“分离物理架构”和“使用冻结系数的前向欧拉”定义了唯一的计算路径：过程是顺序应用的，但所有随时间变化过程的速率都是使用时间步开始时的状态（$t^n$）计算的。这是一种有效且常用的数值方法。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性。\n\n**步骤 3：结论与行动**\n该问题是有效的。将提供一个分步解答。\n\n**解答推导**\n\n计算过程是按照指定顺序执行三个微物理子步骤。“分离物理”架构意味着一个步骤的输出状态成为下一个步骤的输入状态。“冻结系数”规则规定所有过程速率（$R_{\\mathrm{auto}}$, $R_{\\mathrm{accr}}$, $R_{\\mathrm{evap}}$）都基于时间 $t^n$ 的初始状态计算。\n\n初始总水物质混合比为 $q_{t}^{n} = q_{v}^{n} + q_{c}^{n} + q_{r}^{n} = 0.0100 + 0.001200 + 0.000600 = 0.011800$ kg kg$^{-1}$。所有后续过程都是内部转换，因此该总量必须守恒。\n\n首先，我们使用 $t^n$ 时的初始状态计算随时间变化过程的速率：\n- **自动转化速率：**\n$R_{\\mathrm{auto}} = C_{a} \\max(q_{c}^{n} - q_{c0}, 0) = (1.0 \\times 10^{-3}) \\max(0.001200 - 1.0 \\times 10^{-3}, 0) = (1.0 \\times 10^{-3})(0.000200) = 2.0 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$。\n- **碰并速率：**\n$R_{\\mathrm{accr}} = C_{k}\\, q_{c}^{n}\\, q_{r}^{n} = (1.0)(0.001200)(0.000600) = 7.2 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$。\n- **蒸发速率：**\n首先，需要初始相对湿度 $\\mathrm{RH}^{n}$。\n$\\mathrm{RH}^{n} = \\frac{q_{v}^{n}}{q_{vs}(T^{n})} = \\frac{0.0100}{0.01150}$。\n由于 $\\mathrm{RH}^{n}  1$，蒸发发生。\n$R_{\\mathrm{evap}} = E_{0}\\, q_{r}^{n}\\, (1 - \\mathrm{RH}^{n}) = (2.0 \\times 10^{-3})(0.000600) \\left(1 - \\frac{0.0100}{0.01150}\\right)$\n$R_{\\mathrm{evap}} = (1.2 \\times 10^{-6}) \\left(\\frac{0.01150 - 0.0100}{0.01150}\\right) = (1.2 \\times 10^{-6}) \\left(\\frac{0.00150}{0.01150}\\right) \\approx 1.565217 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$。\n\n现在我们顺序应用这些过程。\n\n**步骤 1：饱和度调整**\n我们将初始水汽混合比 $q_{v}^{n}$ 与饱和值 $q_{vs}(T^{n})$ 进行比较。\n$q_{v}^{n} = 0.0100$ kg kg$^{-1}$ 且 $q_{vs}(T^{n}) = 0.01150$ kg kg$^{-1}$。\n由于 $q_{v}^{n}  q_{vs}(T^{n})$，空气是未饱和的。根据问题规则，不发生凝结。\n此步骤之后的状态 $(T_1, q_{v,1}, q_{c,1}, q_{r,1})$ 与初始状态相同：\n$T_1 = 285$ K\n$q_{v,1} = 0.0100$ kg kg$^{-1}$\n$q_{c,1} = 0.001200$ kg kg$^{-1}$\n$q_{r,1} = 0.000600$ kg kg$^{-1}$\n\n**步骤 2：暖雨转化过程（自动转化和碰并）**\n这些过程将云水转化为雨水。它们不影响温度或水汽。总质量变化应用于时间步长 $\\Delta t = 300$ s。\n总转化速率为 $R_{c \\to r} = R_{\\mathrm{auto}} + R_{\\mathrm{accr}} = 2.0 \\times 10^{-7} + 7.2 \\times 10^{-7} = 9.2 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$。\n转化为雨水的云水质量为 $\\Delta q_{c \\to r} = R_{c \\to r} \\times \\Delta t = (9.2 \\times 10^{-7})(300) = 2.76 \\times 10^{-4}$ kg kg$^{-1}$。\n此步骤之后的状态变量 $(T_2, q_{v,2}, q_{c,2}, q_{r,2})$ 为：\n$T_2 = T_1 = 285$ K\n$q_{v,2} = q_{v,1} = 0.0100$ kg kg$^{-1}$\n$q_{c,2} = q_{c,1} - \\Delta q_{c \\to r} = 0.001200 - 0.000276 = 0.000924$ kg kg$^{-1}$\n$q_{r,2} = q_{r,1} + \\Delta q_{c \\to r} = 0.000600 + 0.000276 = 0.000876$ kg kg$^{-1}$\n\n**步骤 3：雨滴蒸发**\n这个过程将雨水转化为水汽，引起潜热冷却。时间步长内蒸发的雨水质量为：\n$\\Delta q_{\\mathrm{evap}} = R_{\\mathrm{evap}} \\times \\Delta t \\approx (1.565217 \\times 10^{-7})(300) \\approx 4.695652 \\times 10^{-5}$ kg kg$^{-1}$。\n从状态 $(T_2, q_{v,2}, q_{c,2}, q_{r,2})$ 开始，该量从雨水中减去并加到水汽中。\n最终的混合比为：\n$q_{v}^{n+1} = q_{v,2} + \\Delta q_{\\mathrm{evap}} = 0.0100 + 4.695652 \\times 10^{-5} = 0.01004695652$ kg kg$^{-1}$\n$q_{c}^{n+1} = q_{c,2} = 0.000924$ kg kg$^{-1}$\n$q_{r}^{n+1} = q_{r,2} - \\Delta q_{\\mathrm{evap}} = 0.000876 - 4.695652 \\times 10^{-5} = 0.00082904348$ kg kg$^{-1}$\n\n温度变化由定压下湿空气块的热力学第一定律 $c_p dT = -L_v dq_v$ 得出。变化量 $\\Delta T$ 应用于前一步的温度 $T_2$。\n$\\Delta T = -\\frac{L_v}{c_p} \\Delta q_v = -\\frac{L_v}{c_p} \\Delta q_{\\mathrm{evap}}$\n$\\Delta T = -\\frac{2.5 \\times 10^{6}}{1004} \\times (4.695652 \\times 10^{-5}) \\approx - (2490.04) \\times (4.695652 \\times 10^{-5}) \\approx -0.116928$ K。\n\n最终温度 $T^{n+1}$ 是：\n$T^{n+1} = T_2 + \\Delta T = 285 - 0.116928 = 284.883072$ K。\n\n问题要求答案四舍五入到四位有效数字。\n$T^{n+1} \\approx 284.9$ K。",
            "answer": "$$\\boxed{284.9}$$"
        },
        {
            "introduction": "现代气候模型是由多个相互作用的组件（如大气和海洋）构成的复杂系统，而这些组件往往以不同的时间步长运行。本练习探讨了一个关键的架构挑战：如何确保在耦合界面上水量和能量等物理量的守恒。通过推导异步耦合方案中产生数值误差的根源，您将理解为何必须采用“通量订正”方法，并学会如何设计这种方法来维护整个模拟的物理一致性。",
            "id": "4025105",
            "problem": "考虑一个耦合的大气-海洋气候模型架构，其中大气分量和海洋分量通过表面质量通量在其共享界面上交换一个守恒标量（为具体起见，设为单位面积的水质量）。大气使用较短的时间步长进行子循环推进，而海洋则使用较长的时间步长推进。交换通量在每个分量内部通过其有限体积公式中的离散连续性方程来表示。\n\n设分量 $X \\in \\{A, O\\}$（大气 $A$，海洋 $O$）中的守恒标量场在体积为 $V_{X,i}$ 的单元 $i$ 中表示为 $q_{X,i}$。分量 $X$ 在其一个时间步长 $\\Delta t_{X}$ 内的离散连续性方程可以用有限体积形式写为\n$$\nq_{X,i}^{n+1} \\;=\\; q_{X,i}^{n} \\;-\\; \\frac{\\Delta t_{X}}{V_{X,i}} \\sum_{f \\in \\partial i} F_{X,i,f}^{n+\\frac{1}{2}} A_{X,i,f} \\;+\\; \\Delta t_{X}\\, S_{X,i}^{n+\\frac{1}{2}},\n$$\n其中 $F_{X,i,f}^{n+\\frac{1}{2}}$ 是穿过单元 $i$ 的面 $f$ 的向外法向通量，$A_{X,i,f}$ 是面 $f$ 的面积，$S_{X,i}^{n+\\frac{1}{2}}$ 是一个源项。在时间层 $n$，$q$ 在分量 $X$ 上的全局积分量为 $M_{X}^{n} = \\sum_{i} V_{X,i}\\, q_{X,i}^{n}$。\n\n从这个离散定律出发，推导在一个耦合时间步内总和 $M_{A} + M_{O}$ 的全局积分约束，其中大气推进 $N$ 个长度为 $\\Delta t_{A}$ 的子步，而海洋推进一个长度为 $\\Delta t_{O} = N\\, \\Delta t_{A}$ 的步长。假设：(i) 组合的大气-海洋系统的外部边界对交换的标量是封闭的，因此任何穿过大气-海洋界面 $\\Gamma$ 的通量对于组合系统来说纯粹是内部的，并且在两个分量中符号相反；(ii) 组合源为零，$S_{A} + S_{O} = 0$（除了界面交换外，该交换标量是严格守恒的）。\n\n在异步耦合中，海洋在其步长内使用一个随时间恒定的界面通量 $F_{O}$，而大气在其 $N$ 个子步内对 $k = 1, \\dots, N$ 使用分段恒定的子步界面通量 $F_{A,k}$。设界面面积为 $A_{\\Gamma}$，并假设两个分量使用相同的几何界面 $\\Gamma$，因此相同的 $A_{\\Gamma}$ 适用于两者，但通量符号相反。\n\n(a) 使用离散连续性方程，根据时间积分的界面通量推导 $M_{A}^{n+N} + M_{O}^{n+1}$ 的全局积分约束，并说明如果大气和海洋使用不同的界面通量时间表示法，会如何产生净不平衡。将一个海洋时间步长后的不平衡量 $\\Delta$ 表示为大气的累积界面输运量与海洋的界面输运量之差。\n\n(b) 提出一种标量通量校正策略，通过一个单一因子 $\\alpha$（在 $N$ 个子步中同样应用于每个 $F_{A,k}$）重新缩放大气子步通量，以在耦合步长内强制实现 $M_{A} + M_{O}$ 的精确守恒。根据 $F_{O}$、$\\{F_{A,k}\\}_{k=1}^{N}$、$\\Delta t_{A}$ 和 $\\Delta t_{O}$ 推导 $\\alpha$ 的封闭形式表达式。\n\n(c) 对于一个科学上实际的数值配置，$N = 5$，$\\Delta t_{A} = 180\\,\\text{s}$，$\\Delta t_{O} = 900\\,\\text{s}$，$A_{\\Gamma} = 3.6 \\times 10^{14}\\,\\text{m}^{2}$，海洋使用的界面通量 $F_{O} = 1.7 \\times 10^{-4}\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$，以及大气子步通量\n$$\nF_{A,1} = 1.6 \\times 10^{-4},\\quad F_{A,2} = 1.7 \\times 10^{-4},\\quad F_{A,3} = 1.9 \\times 10^{-4},\\quad F_{A,4} = 2.0 \\times 10^{-4},\\quad F_{A,5} = 1.8 \\times 10^{-4}\n$$\n单位均为 $\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$，计算恢复守恒的通量校正因子 $\\alpha$ 的数值。将答案四舍五入到六位有效数字。最终答案以单个实数形式给出。$\\alpha$ 无需单位。",
            "solution": "出发点是每个分量 $X \\in \\{A, O\\}$ 的有限体积离散连续性方程：\n$$\nq_{X,i}^{n+1} \\;=\\; q_{X,i}^{n} \\;-\\; \\frac{\\Delta t_{X}}{V_{X,i}} \\sum_{f \\in \\partial i} F_{X,i,f}^{n+\\frac{1}{2}} A_{X,i,f} \\;+\\; \\Delta t_{X}\\, S_{X,i}^{n+\\frac{1}{2}}.\n$$\n对分量 $X$ 中的所有单元 $i$ 求和，得到一个时间步长内全局质量（或守恒标量的积分）的变化：\n$$\nM_{X}^{n+1} - M_{X}^{n} \\;=\\; - \\Delta t_{X} \\sum_{i} \\sum_{f \\in \\partial i} F_{X,i,f}^{n+\\frac{1}{2}} A_{X,i,f} \\;+\\; \\Delta t_{X} \\sum_{i} V_{X,i}\\, S_{X,i}^{n+\\frac{1}{2}}.\n$$\n在对 $i$ 的双重求和中，分量 $X$ 内部的面 $f$ 会以相反的方向出现两次，并通过通量贡献的成对抵消而消去。唯一剩下的面是 $X$ 的外部边界，特别是大气和海洋之间的界面 $\\Gamma$。将分量 $X$ 穿过其外部边界的净向外通量表示为 $F_{X,\\Gamma}^{n+\\frac{1}{2}}$ 乘以界面面积 $A_{\\Gamma}$，我们写出\n$$\nM_{X}^{n+1} - M_{X}^{n} \\;=\\; - \\Delta t_{X}\\, F_{X,\\Gamma}^{n+\\frac{1}{2}}\\, A_{\\Gamma} \\;+\\; \\Delta t_{X} \\int_{\\Omega_{X}} S_{X}^{n+\\frac{1}{2}}\\, \\mathrm{d}V,\n$$\n其中 $\\Omega_{X}$ 是分量 $X$ 的域。对于耦合系统，我们假设交换标量的外部边界是封闭的，且组合源为零，$S_{A} + S_{O} = 0$。穿过界面 $\\Gamma$ 的通量对于组合系统是内部的，并且在分量之间符号相反：\n$$\nF_{A,\\Gamma}^{n+\\frac{1}{2}} \\;=\\; - F_{O,\\Gamma}^{n+\\frac{1}{2}}.\n$$\n因此，在一个共同的耦合区间上对大气和海洋的全局更新求和，得到组合守恒定律：\n$$\n\\left(M_{A}^{\\text{after}} - M_{A}^{\\text{before}}\\right) + \\left(M_{O}^{\\text{after}} - M_{O}^{\\text{before}}\\right) \\;=\\; - \\int_{t_{\\text{before}}}^{t_{\\text{after}}} \\left[F_{A,\\Gamma}(t) + F_{O,\\Gamma}(t)\\right] A_{\\Gamma}\\, \\mathrm{d}t \\;+\\; \\int_{t_{\\text{before}}}^{t_{\\text{after}}} \\int_{\\Omega_{A} \\cup \\Omega_{O}} \\left(S_{A} + S_{O}\\right) \\mathrm{d}V\\, \\mathrm{d}t.\n$$\n在 $S_{A} + S_{O} = 0$ 和 $F_{A,\\Gamma}(t) = - F_{O,\\Gamma}(t)$ 的条件下，在连续时间理想化中，右侧恒为零，从而得出精确守恒：\n$$\nM_{A}^{\\text{after}} + M_{O}^{\\text{after}} \\;=\\; M_{A}^{\\text{before}} + M_{O}^{\\text{before}}.\n$$\n\n在离散异步耦合中，海洋在 $(t^{n}, t^{n+1})$ 上使用一个随时间恒定的通量 $F_{O}$ 推进一个长度为 $\\Delta t_{O}$ 的步长，而大气在 $(t^{n+(k-1)}, t^{n+k})$ 上（对于 $k = 1, \\dots, N$）使用分段恒定的通量 $F_{A,k}$ 推进 $N$ 个长度为 $\\Delta t_{A}$ 的子步，其中 $t^{n+k} = t^{n} + k\\, \\Delta t_{A}$ 且 $\\Delta t_{O} = N\\, \\Delta t_{A}$。在整个海洋步长内，大气的离散界面输运量为\n$$\nT_{A} \\;=\\; \\sum_{k=1}^{N} F_{A,k}\\, A_{\\Gamma}\\, \\Delta t_{A},\n$$\n在同一区间内，海洋的离散界面输运量为\n$$\nT_{O} \\;=\\; F_{O}\\, A_{\\Gamma}\\, \\Delta t_{O}.\n$$\n对于组合系统，当源为零且外部边界封闭时，如果通量符号取得一致，则全局积分约束要求 $T_{A} + T_{O} = 0$。在实践中，由于两个分量采用相反的向外法线约定，精确守恒要求 $T_{A} = T_{O}$ 在量值上相等。如果由于不同的时间通量表示法导致 $T_{A} \\neq T_{O}$，则会产生净不平衡。将不平衡量 $\\Delta$ 定义为大气的累积界面输运量减去海洋的界面输运量，得到\n$$\n\\Delta \\;=\\; T_{A} - T_{O} \\;=\\; \\left(\\sum_{k=1}^{N} F_{A,k}\\, A_{\\Gamma}\\, \\Delta t_{A}\\right) \\;-\\; \\left(F_{O}\\, A_{\\Gamma}\\, \\Delta t_{O}\\right).\n$$\n非零的 $\\Delta$ 表明在离散格式中 $M_{A}^{\\text{after}} + M_{O}^{\\text{after}} \\neq M_{A}^{\\text{before}} + M_{O}^{\\text{before}}$。\n\n为了恢复守恒，我们建议通过一个单一因子 $\\alpha$ 来重新缩放大气子步通量，该因子同样应用于每个子步，从而产生校正后的通量 $\\alpha\\, F_{A,k}$。校正后的大气输运量变为\n$$\nT_{A}^{\\text{corr}} \\;=\\; \\sum_{k=1}^{N} \\alpha\\, F_{A,k}\\, A_{\\Gamma}\\, \\Delta t_{A} \\;=\\; \\alpha\\, A_{\\Gamma}\\, \\Delta t_{A}\\, \\sum_{k=1}^{N} F_{A,k}.\n$$\n通过使校正后的大气输运量与海洋的输运量 $T_{O}$ 在量值上匹配，来在离散意义上强制实现精确守恒，得到\n$$\n\\alpha\\, A_{\\Gamma}\\, \\Delta t_{A}\\, \\sum_{k=1}^{N} F_{A,k} \\;=\\; F_{O}\\, A_{\\Gamma}\\, \\Delta t_{O}.\n$$\n消去公共界面面积 $A_{\\Gamma}$ 并使用 $\\Delta t_{O} = N\\, \\Delta t_{A}$，得到标量校正因子的封闭形式表达式：\n$$\n\\alpha \\;=\\; \\frac{F_{O}\\, \\Delta t_{O}}{\\Delta t_{A}\\, \\sum_{k=1}^{N} F_{A,k}} \\;=\\; \\frac{F_{O}\\, N}{\\sum_{k=1}^{N} F_{A,k}}.\n$$\n该表达式仅依赖于海洋的恒定通量 $F_{O}$、大气子步通量集合 $\\{F_{A,k}\\}$ 以及时间步长比率 $N$；它与界面面积 $A_{\\Gamma}$ 无关。\n\n对于给定的数值配置，我们有 $N = 5$，$\\Delta t_{A} = 180\\,\\text{s}$，$\\Delta t_{O} = 900\\,\\text{s}$，$F_{O} = 1.7 \\times 10^{-4}\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$，以及\n$$\nF_{A,1} = 1.6 \\times 10^{-4},\\quad F_{A,2} = 1.7 \\times 10^{-4},\\quad F_{A,3} = 1.9 \\times 10^{-4},\\quad F_{A,4} = 2.0 \\times 10^{-4},\\quad F_{A,5} = 1.8 \\times 10^{-4}.\n$$\n计算大气子步通量之和：\n$$\n\\sum_{k=1}^{5} F_{A,k} \\;=\\; \\left(1.6 + 1.7 + 1.9 + 2.0 + 1.8\\right) \\times 10^{-4} \\;=\\; 9.0 \\times 10^{-4}.\n$$\n那么校正因子为\n$$\n\\alpha \\;=\\; \\frac{F_{O}\\, N}{\\sum_{k=1}^{N} F_{A,k}} \\;=\\; \\frac{\\left(1.7 \\times 10^{-4}\\right)\\, 5}{9.0 \\times 10^{-4}} \\;=\\; \\frac{8.5 \\times 10^{-4}}{9.0 \\times 10^{-4}} \\;=\\; \\frac{17}{18}.\n$$\n表示为四舍五入到六位有效数字的小数，这给出\n$$\n\\alpha \\;\\approx\\; 0.944444.\n$$\n在所述假设下，将此标量因子统一应用于每个大气子步通量 $F_{A,k}$，可以在耦合时间步长内恢复全局积分质量 $M_{A} + M_{O}$ 的精确离散守恒。",
            "answer": "$$\\boxed{0.944444}$$"
        }
    ]
}