{
    "hands_on_practices": [
        {
            "introduction": "在将守恒定律应用于实际的地球物理问题之前，我们必须首先理解连续介质系统在理想条件下的基本行为。本练习将引导我们思考一个封闭系统中全球质量守恒的宏观含义。通过分析一个简化的全球大气模型，我们将运用“无通量”边界条件来证明，在一个没有外部物质交换的系统中，总质量必然是守恒的，为我们后续的数值离散化工作奠定理论基础。",
            "id": "4043035",
            "problem": "考虑一个全球干空气大气，它被表示为一个环绕着半径为 $a$ 的行星的薄球壳，其垂直坐标 $z \\in [0, H]$ 从地表向上测量，经度 $\\lambda \\in [0, 2\\pi)$ (周期性)，纬度 $\\phi \\in [-\\pi/2, \\pi/2]$。设干空气密度为 $\\rho(\\lambda, \\phi, z, t)$，速度在东向、北向和垂直方向上的分量分别为 $\\mathbf{u}(\\lambda, \\phi, z, t) = (u, v, w)$。顶部 ($z=H$) 和底部 ($z=0$) 边界是不可渗透的，意味着在 $z=0$ 和 $z=H$ 处 $w = 0$。不存在干空气质量的内部源或汇。\n\n你使用有限体积法 (FVM) 在 $(\\lambda, \\phi, z)$ 的逻辑矩形网格上对区域进行离散化，网格指数为 $(i, j, k)$，间距为 $\\Delta \\lambda_i$、$\\Delta \\phi_j$ 和 $\\Delta z_k$。在薄壳近似下，网格 $(i, j, k)$ 的体积为 $V_{i,j,k} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j \\,\\Delta z_k$。将指向外的、面上积分的干空气质量通量表示为\n- $F^{\\lambda}_{i+1/2, j, k}(t) = \\int_{A^{\\lambda}_{i+1/2, j, k}} \\rho u \\, dA$，穿过位于 $\\lambda_{i+1/2}$、面积为 $A^{\\lambda}_{i+1/2, j, k} = a \\,\\Delta \\phi_j \\,\\Delta z_k$ 的经向面，\n- $F^{\\phi}_{i, j+1/2, k}(t) = \\int_{A^{\\phi}_{i, j+1/2, k}} \\rho v \\, dA$，穿过位于 $\\phi_{j+1/2}$、面积为 $A^{\\phi}_{i, j+1/2, k} = a \\cos\\phi_{j+1/2} \\,\\Delta \\lambda_i \\,\\Delta z_k$ 的纬向面，\n- $F^{z}_{i, j, k+1/2}(t) = \\int_{A^{z}_{i, j, k+1/2}} \\rho w \\, dA$，穿过位于 $z_{k+1/2}$、面积为 $A^{z}_{i, j, k+1/2} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j$ 的水平面。\n\n通量形式的局部干空气质量守恒定律是基本出发点：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\left(\\rho \\mathbf{u}\\right) = 0.\n$$\n\n定义在一个时间步长 $\\Delta t = t^{n+1} - t^{n}$ 内，通过球壳外部边界的全球积分、随时间累积的干空气质量通量为\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt,\n$$\n其中 $\\partial \\Omega$ 是区域的物理边界，$\\mathbf{n}$ 是向外的单位法向量。\n\n从局部通量形式的守恒定律出发，并仅使用所述的几何和边界假设（周期性经度、顶部和底部不可渗透），计算 $I$ 的值。你的答案必须是一个单一的数字或一个单一的闭式解析表达式。不需要四舍五入，最终的方框答案中不应报告单位。",
            "solution": "问题要求计算量 $I$ 的值，该量定义为通过区域外部边界的全球积分、随时间累积的干空气质量通量：\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt\n$$\n内部的积分 $\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS$ 表示在给定时刻，离开整个大气区域 $\\Omega$ 的净质量输送率。矢量 $\\rho \\mathbf{u}$ 是质量通量矢量。\n\n区域 $\\Omega$ 是一个由坐标范围定义的球壳：经度 $\\lambda \\in [0, 2\\pi)$，纬度 $\\phi \\in [-\\pi/2, \\pi/2]$，以及垂直坐标 $z \\in [0, H]$。该区域的物理边界 $\\partial \\Omega$ 由区域不连续或非周期性的表面组成。\n\n让我们确定这些边界面：\n1.  **经向边界：** 问题陈述了区域在经度 $\\lambda$ 上是周期性的。这意味着 $\\lambda=0$ 和 $\\lambda=2\\pi$ 处的表面是同一的。任何在 $\\lambda=2\\pi$ 离开区域的流动，都有一个相同的流动在 $\\lambda=0$ 进入。因此，这些边界对净通量没有贡献；它们不属于外部边界 $\\partial \\Omega$。\n2.  **纬向边界：** 区域从南极 ($\\phi = -\\pi/2$) 延伸到北极 ($\\phi = \\pi/2$)。两极是点（或在 $(\\lambda, \\phi, z)$ 空间中的线），而不是面。任何纬向面的面积随着 $\\phi \\to \\pm \\pi/2$ 而收缩至零。因此，两极处没有物理边界，也没有质量通量穿过它们。\n3.  **垂直边界：** 区域的下界是位于 $z=0$ 的行星表面，上界是位于 $z=H$ 的大气层顶部。这些是物理的、非周期性的边界。\n\n因此，外部边界 $\\partial \\Omega$ 由两个不同的表面组成：位于 $z=0$ 的底面 $S_{bottom}$ 和位于 $z=H$ 的顶面 $S_{top}$。面积分可以分解为两部分：\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{top}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS + \\int_{S_{bottom}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS\n$$\n我们现在分析每个表面上的被积函数 $\\rho\\,\\mathbf{u} \\cdot \\mathbf{n}$。\n\n-   **在顶面（$S_{top}$，此处 $z=H$）：** 向外的单位法向量 $\\mathbf{n}$ 指向正垂直方向。速度矢量为 $\\mathbf{u} = (u, v, w)$。点积 $\\mathbf{u} \\cdot \\mathbf{n}$ 分离出垂直于表面的速度分量，即垂直速度 $w$。问题陈述了顶部边界是不可渗透的，条件为在 $z=H$ 处 $w = 0$。因此，在该表面上，法向质量通量为 $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = \\rho w = \\rho(0) = 0$。因此，该表面上的积分为零：\n    $$\n    \\int_{S_{top}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{top}} \\rho w \\, dS = 0\n    $$\n\n-   **在底面（$S_{bottom}$，此处 $z=0$）：** 向外的单位法向量 $\\mathbf{n}$ 指向离开区域的方向，即指向负垂直方向。点积为 $\\mathbf{u} \\cdot \\mathbf{n} = -w$。问题陈述了底部边界也是不可渗透的，条件为在 $z=0$ 处 $w = 0$。因此，在该表面上，法向质量通量为 $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = -\\rho w = -\\rho(0) = 0$。该表面上的积分也为零：\n    $$\n    \\int_{S_{bottom}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{bottom}} (-\\rho w) \\, dS = 0\n    $$\n由于通过外部边界 $\\partial \\Omega$ 所有部分的通量均为零，所以在所有时刻，离开区域的总净质量通量均为零：\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 + 0 = 0 \\quad \\text{对于所有 } t \\in [t^n, t^{n+1}]\n$$\n这是“无通量”或“不可渗透”边界条件的直接结果，其物理意义是这是一个相对于与周围环境进行质量交换而言的封闭系统。\n\n问题要求计算 $I$ 的值，即该净通量的时间积分。由于被积函数恒为零，积分也为零：\n$$\nI = \\int_{t^n}^{t^{n+1}} (0) \\, dt = 0\n$$\n局部守恒定律 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 和散度定理证实了这一结果。将守恒定律在整个区域 $\\Omega$ 上积分得到：\n$$\n\\int_{\\Omega} \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_{\\Omega} \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0\n$$\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\rho \\, dV + \\oint_{\\partial \\Omega} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0\n$$\n该方程表明，区域内总质量的变化率 $\\frac{dM}{dt}$ 等于离开边界的净质量通量的负值。由于我们已经证明边界通量积分为零，这意味着 $\\frac{dM}{dt} = 0$。总质量是守恒的。问题要求的是在一个时间间隔内穿过边界的总质量，这必定为零。关于有限体积离散化的详细信息与此结论一致，但推导过程并不需要这些信息。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "从理论转向数值实现时，我们会遇到由离散化带来的新约束。本练习将探讨其中最基本的一个：Courant–Friedrichs–Lewy (CFL) 条件。CFL 条件保证了显式平流格式的数值稳定性，它要求在一个时间步内，信息传播的距离不能超过一个网格单元的宽度。掌握 CFL 条件的推导和应用，对于设计和运行任何稳定的数值天气或气候模型都至关重要。",
            "id": "4042968",
            "problem": "考虑由通量形式的守恒律控制的被动示踪场的线性平流，\n$$\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\left( \\boldsymbol{U}\\, q \\right) = 0,$$\n其中 $q$ 是单元平均的示踪剂混合比，$\\boldsymbol{U} = (u, v, w)$ 是一个给定的、不随时间变化的速度场。假设在笛卡尔网格上采用显式一阶迎风有限体积离散。时间积分采用前向 Euler 方法，通量根据面法向速度分量的符号使用迎风状态进行评估。Courant–Friedrichs–Lewy (CFL) 条件是一个约束条件，它通过确保新的单元平均值是现有单元平均值的凸组合来保证更新的稳定性和非负性。\n\n任务 A (一维推导)：将问题简化为一维空间，其中平流速度 $a$ 为常数，单元宽度 $\\Delta x_i$ 随空间变化。从控制体上的积分守恒律出发，使用显式迎风通量，推导时间步长 $\\Delta t$ 必须满足的稳定性约束，以确保更新是相邻单元平均值的凸组合，从而保持正定性和 $L^1$ 稳定性。用 $|a|$、$\\Delta x_i$ 和一个全域条件来表示该约束。\n\n任务 B (多维推广)：对于具有均匀间距 $\\Delta x$、$\\Delta y$、$\\Delta z$ 和恒定速度分量 $u$、$v$、$w$ 的三维情况，推导由采用一阶迎风通量的非分裂有限体积更新所施加的关于 $\\Delta t$ 的显式 CFL 约束。您的推导应从单个单元的有限体积通量平衡开始，并施加更新的凸性条件（所有权重非负且总和为一）。\n\n任务 C (数值计算)：使用您推导出的约束，计算以下两种配置的最大允许时间步长 $\\Delta t$：\n\n- 一维配置：四个单元，宽度分别为 $\\Delta x_1 = 20 \\text{ km}$、$\\Delta x_2 = 12 \\text{ km}$、$\\Delta x_3 = 8 \\text{ km}$、$\\Delta x_4 = 16 \\text{ km}$，平流速度为恒定的 $a = +35 \\text{ m s}^{-1}$。基于最严格的单元，以秒为单位报告全域的最大稳定 $\\Delta t$。\n\n- 三维配置：均匀间距 $\\Delta x = 12 \\text{ km}$、$\\Delta y = 15 \\text{ km}$、$\\Delta z = 500 \\text{ m}$，恒定速度 $u = 25 \\text{ m s}^{-1}$、$v = 15 \\text{ m s}^{-1}$、$w = 0.50 \\text{ m s}^{-1}$。以秒为单位报告您的三维 CFL 条件所暗示的最大稳定 $\\Delta t$。\n\n将您的两个数值答案四舍五入到四位有效数字，并以秒为单位表示。按（一维 $\\Delta t_{\\max}$，三维 $\\Delta t_{\\max}$）的顺序提供您的最终数值答案。",
            "solution": "### 任务 A：一维推导\n我们从一维守恒律开始：\n$$ \\frac{\\partial q}{\\partial t} + \\frac{\\partial (a q)}{\\partial x} = 0 $$\n为了获得有限体积离散格式，我们将此方程在一个控制体（单元 $i$）上进行积分，积分范围从其左侧面 $x_{i-1/2}$ 到右侧面 $x_{i+1/2}$，单元宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (aq)}{\\partial x} dx = 0 $$\n将单元平均量定义为 $q_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x, t) dx$ 并应用微积分基本定理，我们得到：\n$$ \\frac{d(\\Delta x_i q_i)}{dt} + (aq)_{i+1/2} - (aq)_{i-1/2} = 0 $$\n由于网格是静态的，$\\Delta x_i$ 不随时间变化。令通量为 $F = aq$。\n$$ \\Delta x_i \\frac{dq_i}{dt} + F_{i+1/2} - F_{i-1/2} = 0 $$\n使用前向 Euler 方法进行时间离散（上标 $n$ 表示时间层 $t_n$）：\n$$ \\Delta x_i \\frac{q_i^{n+1} - q_i^n}{\\Delta t} + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\n整理得到更新值 $q_i^{n+1}$：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(F_{i+1/2}^n - F_{i-1/2}^n\\right) $$\n一阶迎风格式根据速度 $a$ 的符号，基于“迎风”单元中的值来设定单元面上的通量。\n情况1：$a > 0$。流动方向为从左到右。在 $i-1/2$ 和 $i+1/2$ 面上的迎风值分别为 $q_{i-1}^n$ 和 $q_i^n$。\n$$ F_{i-1/2}^n = a q_{i-1}^n, \\quad F_{i+1/2}^n = a q_i^n $$\n代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(a q_i^n - a q_{i-1}^n\\right) = \\left(1 - \\frac{a \\Delta t}{\\Delta x_i}\\right) q_i^n + \\frac{a \\Delta t}{\\Delta x_i} q_{i-1}^n $$\n情况2：$a  0$。流动方向为从右到左。在 $i-1/2$ 和 $i+1/2$ 面上的迎风值分别为 $q_i^n$ 和 $q_{i+1}^n$。\n$$ F_{i-1/2}^n = a q_i^n, \\quad F_{i+1/2}^n = a q_{i+1}^n $$\n代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(a q_{i+1}^n - a q_i^n\\right) = \\left(1 + \\frac{a \\Delta t}{\\Delta x_i}\\right) q_i^n - \\frac{a \\Delta t}{\\Delta x_i} q_{i+1}^n $$\n对于这种情况，使用 $|a| = -a$，方程变为：\n$$ q_i^{n+1} = \\left(1 - \\frac{|a| \\Delta t}{\\Delta x_i}\\right) q_i^n + \\frac{|a| \\Delta t}{\\Delta x_i} q_{i+1}^n $$\n在这两种情况下，$q_i^{n+1}$都是 $q_i^n$ 及其迎风邻居的线性组合。要使其成为一个凸组合，系数必须为非负且总和为 1。系数的总和恒为 1。非负性约束要求所有系数都大于或等于 0。迎风邻居的系数 $\\frac{|a|\\Delta t}{\\Delta x_i}$ 总是非负的。因此，约束落在 $q_i^n$ 的系数上：\n$$ 1 - \\frac{|a| \\Delta t}{\\Delta x_i} \\ge 0 \\implies \\frac{|a| \\Delta t}{\\Delta x_i} \\le 1 $$\n这给出了单元 $i$ 的稳定性约束：\n$$ \\Delta t \\le \\frac{\\Delta x_i}{|a|} $$\n为保证整个计算域的稳定性，时间步长 $\\Delta t$ 必须对所有单元都满足此条件。这意味着它必须受到最严格情况的限制，即具有最小 $\\Delta x_i$ 的单元。\n$$ \\Delta t \\le \\min_i \\left( \\frac{\\Delta x_i}{|a|} \\right) = \\frac{\\min_i(\\Delta x_i)}{|a|} $$\n\n### 任务 B：三维推广\n三维守恒律为 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (\\boldsymbol{U} q) = 0$。在一个单元体积 $V_{ijk} = \\Delta x \\Delta y \\Delta z$ 上积分并应用散度定理，可得：\n$$ \\frac{d(V_{ijk} q_{ijk})}{d t} + \\oiint_{\\partial V_{ijk}} (\\boldsymbol{U}q) \\cdot \\boldsymbol{n} \\, dS = 0 $$\n其中 $q_{ijk}$ 是单元平均值。对于静态网格，这变为：\n$$ V_{ijk} \\frac{dq_{ijk}}{dt} + \\sum_{\\text{faces}} \\int_{\\text{face}} (\\boldsymbol{U}q) \\cdot \\boldsymbol{n} \\, dS = 0 $$\n在单元的六个面上离散通量积分并应用前向 Euler 时间步进后，我们得到：\n$$ q_{ijk}^{n+1} = q_{ijk}^n - \\frac{\\Delta t}{V_{ijk}} \\left[ (F_x)_{i+1/2} - (F_x)_{i-1/2} + (F_y)_{j+1/2} - (F_y)_{j-1/2} + (F_z)_{k+1/2} - (F_z)_{k-1/2} \\right]^n $$\n其中 $F_x, F_y, F_z$ 是通过垂直于 $x, y, z$ 轴的面的总通量。例如，$(F_x)_{i+1/2} = (uq)_{i+1/2} \\Delta y \\Delta z$。代入 $V_{ijk} = \\Delta x \\Delta y \\Delta z$ 并化简后，更新方程变为：\n$$ q_{ijk}^{n+1} = q_{ijk}^n - \\frac{\\Delta t}{\\Delta x} \\left[ (uq)_{i+1/2} - (uq)_{i-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta y} \\left[ (vq)_{j+1/2} - (vq)_{j-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta z} \\left[ (wq)_{k+1/2} - (wq)_{k-1/2} \\right]^n $$\n使用一阶迎风格式，每个通量项都由迎风单元的状态确定。例如，在x方向，通量差为 $(uq)_{i+1/2} - (uq)_{i-1/2}$。使用速度的正部 $u^+ = \\max(u, 0)$ 和负部 $u^- = \\min(u,0)$，迎风通量为 $(uq)_{i+1/2} = u^+ q_{ijk}^n + u^- q_{i+1,j,k}^n$ 和 $(uq)_{i-1/2} = u^+ q_{i-1,j,k}^n + u^- q_{ijk}^n$。将此代入更新方程，并对所有三个方向收集 $q_{ijk}^n$ 的系数，我们得到 $q_{ijk}^n$ 的总系数为：\n$$ 1 - \\frac{\\Delta t}{\\Delta x}(u^+ - u^-) - \\frac{\\Delta t}{\\Delta y}(v^+ - v^-) - \\frac{\\Delta t}{\\Delta z}(w^+ - w^-) $$\n由于 $|u| = u^+ - u^-$（以及v, w的类似关系），$q_{ijk}^{n+1}$ 的表达式可以写为：\n$$ q_{ijk}^{n+1} = \\left(1 - \\Delta t \\left(\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}\\right)\\right) q_{ijk}^n + (\\dots)q_{\\text{neighbors}}^n $$\n系数之和仍然为 1。为了构成凸组合，$q_{ijk}^n$ 的系数必须为非负：\n$$ 1 - \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z} \\right) \\ge 0 $$\n整理 $\\Delta t$ 可得 CFL 稳定性约束：\n$$ \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z} \\right) \\le 1 $$\n$$ \\Delta t \\le \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}} $$\n\n### 任务 C：数值计算\n为保持一致性，单位转换为国际单位制（米和秒）。\n\n- **一维配置**：\n给定条件为：\n$\\Delta x_1 = 20 \\text{ km} = 20000 \\text{ m}$\n$\\Delta x_2 = 12 \\text{ km} = 12000 \\text{ m}$\n$\\Delta x_3 = 8 \\text{ km} = 8000 \\text{ m}$\n$\\Delta x_4 = 16 \\text{ km} = 16000 \\text{ m}$\n$a = +35 \\text{ m s}^{-1}$，所以 $|a| = 35 \\text{ m s}^{-1}$。\n最小单元宽度为 $\\min_i(\\Delta x_i) = 8000 \\text{ m}$。\n使用任务 A 中的公式，最大允许时间步长为：\n$$ \\Delta t_{\\max} = \\frac{\\min_i(\\Delta x_i)}{|a|} = \\frac{8000 \\text{ m}}{35 \\text{ m s}^{-1}} = \\frac{1600}{7} \\text{ s} \\approx 228.5714 \\text{ s} $$\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 228.6 \\text{ s}$。\n\n- **三维配置**：\n给定条件为：\n$\\Delta x = 12 \\text{ km} = 12000 \\text{ m}$\n$\\Delta y = 15 \\text{ km} = 15000 \\text{ m}$\n$\\Delta z = 500 \\text{ m}$\n$u = 25 \\text{ m s}^{-1}$，所以 $|u| = 25 \\text{ m s}^{-1}$。\n$v = 15 \\text{ m s}^{-1}$，所以 $|v| = 15 \\text{ m s}^{-1}$。\n$w = 0.50 \\text{ m s}^{-1}$，所以 $|w| = 0.50 \\text{ m s}^{-1}$。\n使用任务 B 中的公式，最大允许时间步长为：\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}} $$\n我们计算分母中的各项：\n$$ \\frac{|u|}{\\Delta x} = \\frac{25}{12000} \\text{ s}^{-1} = \\frac{1}{480} \\text{ s}^{-1} $$\n$$ \\frac{|v|}{\\Delta y} = \\frac{15}{15000} \\text{ s}^{-1} = \\frac{1}{1000} \\text{ s}^{-1} $$\n$$ \\frac{|w|}{\\Delta z} = \\frac{0.50}{500} \\text{ s}^{-1} = \\frac{1}{1000} \\text{ s}^{-1} $$\n总和为：\n$$ \\frac{1}{480} + \\frac{1}{1000} + \\frac{1}{1000} = \\frac{1}{480} + \\frac{2}{1000} = \\frac{1}{480} + \\frac{1}{500} = \\frac{500+480}{480 \\times 500} = \\frac{980}{240000} = \\frac{49}{12000} \\text{ s}^{-1} $$\n因此，最大时间步长为：\n$$ \\Delta t_{\\max} = \\frac{1}{49/12000} = \\frac{12000}{49} \\text{ s} \\approx 244.8979 \\text{ s} $$\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 244.9 \\text{ s}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 228.6  244.9 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论上守恒的数值格式在实际应用中，由于计算精度和算法组合的复杂性，仍可能产生微小的误差，导致模拟量在长时间积分后出现“漂移”。本练习提供了一种诊断和量化这种数值误差的实用方法。通过推导并计算一个全球质量收支诊断量，我们可以检验数值模型在多大程度上维持了理想的守恒特性，这是模型开发、验证和评估中的一项关键技能。",
            "id": "4042959",
            "problem": "考虑一个使用有限体积法 (FVM) 进行输运和转化的全球大气示踪物。设预报变量为示踪物质质量密度 $q$，单位为 $\\mathrm{kg\\,m^{-3}}$，其受通量形式的守恒律 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S$ 控制，其中 $\\boldsymbol{F}$ 是 $q$ 的平流输运通量，$S$ 是单位体积的源减去汇，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。全球域是封闭的（与外界边界没有交换）。该模型将全球域离散化为 $N$ 个控制体积（网格单元）$V_i$，其体积为 $|V_i|$。用 $\\bar{q}_i^{n}$ 和 $\\bar{q}_i^{n+1}$ 分别表示单个时间步开始和结束时的网格单元平均质量密度，并定义 $\\Delta \\bar{q}_i = \\bar{q}_i^{n+1} - \\bar{q}_i^{n}$。源减汇项通过每个网格单元的体积分速率来实现，使得 $\\int_{t}^{t+\\Delta t} S_i \\, dV$（其中$S_i$是单元$i$中的源项）在单个时间步内的总和，表示为 $\\mathcal{S}_{i,\\Delta t}$，单位为 $\\mathrm{kg}$，并表示该网格单元在该时间步内时间积分的净产量。\n\n从通量形式的守恒律出发，使用控制体积积分，推导一个时间步内的全球质量收支，该收支将示踪物质总质量的变化与时间积分、体积积分的源项进行比较。利用此结果构建一个用于诊断单个时间步内全球质量漂移的量 $\\Delta M$，对于封闭域上的完全守恒离散化，该值应为零。然后，对于以下五个网格单元的全球网格，使用所提供的数据计算 $\\Delta M$。将非零值解释为由通量不匹配或时间步进而产生的数值不一致性。\n\n网格和数据如下：\n- $|V_1| = 9.5 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_2| = 1.3 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_3| = 8.0 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_4| = 1.1 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_5| = 9.0 \\times 10^{16}\\ \\mathrm{m^{3}}$。\n- $\\bar{q}_1^{n} = 7.50 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_1^{n+1} = 7.55 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$；$\\bar{q}_2^{n} = 6.80 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_2^{n+1} = 6.78 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$；$\\bar{q}_3^{n} = 8.10 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_3^{n+1} = 8.11 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$；$\\bar{q}_4^{n} = 7.20 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_4^{n+1} = 7.19 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$；$\\bar{q}_5^{n} = 6.90 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_5^{n+1} = 6.91 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$。\n- $\\mathcal{S}_{1,\\Delta t} = 2.50 \\times 10^{12}\\ \\mathrm{kg}$, $\\mathcal{S}_{2,\\Delta t} = 1.00 \\times 10^{11}\\ \\mathrm{kg}$, $\\mathcal{S}_{3,\\Delta t} = 5.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\mathcal{S}_{4,\\Delta t} = 6.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\mathcal{S}_{5,\\Delta t} = 3.00 \\times 10^{10}\\ \\mathrm{kg}$。\n\n计算此时间步的诊断量 $\\Delta M$，并以 $\\mathrm{kg}$ 为单位表示您的最终答案。将您的答案四舍五入到三位有效数字。",
            "solution": "全球质量收支的推导始于示踪物质质量密度 $q$ 的控制性通量形式守恒律：\n$$\n\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S\n$$\n在这里，$q$ 的单位是 $\\mathrm{kg\\,m^{-3}}$，$\\boldsymbol{F}$ 是平流通量矢量，$S$ 是单位体积的源减汇项，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。\n\n对于有限体积法 (FVM) 离散化，我们将此偏微分方程在域内的任意一个控制体积 $V_i$ 上积分：\n$$\n\\int_{V_i} \\frac{\\partial q}{\\partial t} \\, dV + \\int_{V_i} \\nabla \\cdot \\boldsymbol{F} \\, dV = \\int_{V_i} S \\, dV\n$$\n对第一项应用 Leibniz 积分法则（假设控制体积固定），对第二项应用散度定理，我们变换体积分：\n$$\n\\frac{d}{dt} \\int_{V_i} q \\, dV + \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\int_{V_i} S \\, dV\n$$\n其中 $\\partial V_i$ 是控制体积 $V_i$ 的边界面，$d\\boldsymbol{A}$ 是指向外的法向面元。\n\n我们将网格单元 $i$ 中的总质量定义为 $M_i(t) = \\int_{V_i} q \\, dV$，将体积分源速率定义为 $\\mathcal{S}_i(t) = \\int_{V_i} S \\, dV$。单个网格单元的方程变为：\n$$\n\\frac{dM_i}{dt} + \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\mathcal{S}_i(t)\n$$\n接下来，我们将此方程在一个从 $t = t^n$ 到 $t = t^{n+1}$（持续时间为 $\\Delta t = t^{n+1} - t^n$）的单个时间步上积分：\n$$\n\\int_{t^n}^{t^{n+1}} \\frac{dM_i}{dt} \\, dt + \\int_{t^n}^{t^{n+1}} \\left( \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} \\right) dt = \\int_{t^n}^{t^{n+1}} \\mathcal{S}_i(t) \\, dt\n$$\n第一项的计算结果是网格单元 $i$ 在该时间步内的质量变化：$M_i(t^{n+1}) - M_i(t^n)$。我们用 $\\mathcal{F}_{i, \\Delta t}$ 表示时间积分的流出网格单元 $i$ 的净通量，用 $\\mathcal{S}_{i, \\Delta t}$ 表示时间积分的源项。方程为：\n$$\nM_i^{n+1} - M_i^n + \\mathcal{F}_{i, \\Delta t} = \\mathcal{S}_{i, \\Delta t}\n$$\n为了获得全球质量收支，我们将此方程对域中所有 $N$ 个控制体积求和：\n$$\n\\sum_{i=1}^{N} (M_i^{n+1} - M_i^n) + \\sum_{i=1}^{N} \\mathcal{F}_{i, \\Delta t} = \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n第一项代表全球总质量的变化，$\\Delta M_{total} = M_{total}^{n+1} - M_{total}^n$。第二项是所有网格单元边界上所有时间积分通量的总和。在有限体积离散化中，对于两个相邻网格单元（例如 $j$ 和 $k$）共享的任何内界面，离开网格单元 $j$ 的通量与进入网格单元 $k$ 的通量大小相等，符号相反。因此，当在整个域上求和时，所有内部通量完全抵消。该和简化为穿过全球域外部边界的总通量。由于问题声明全球域是封闭的，这个外部通量为零。因此，对于一个完全守恒的数值格式，我们必须有：\n$$\n\\sum_{i=1}^{N} \\mathcal{F}_{i, \\Delta t} = 0\n$$\n因此，理想的全球质量收支为：\n$$\n\\Delta M_{total} = \\sum_{i=1}^{N} (M_i^{n+1} - M_i^n) = \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n该方程表明，示踪物质总质量的变化必须等于源项增加的总质量减去汇项移除的总质量。\n\n用于诊断全球质量漂移的量 $\\Delta M$ 可以通过比较数值计算出的总质量变化与总积分源项来构建。任何差异都源于输运格式的数值误差（例如，界面处不一致的通量计算或非守恒的时间积分）。我们将 $\\Delta M$ 定义为差值：\n$$\n\\Delta M = \\left( \\sum_{i=1}^{N} M_i^{n+1} - \\sum_{i=1}^{N} M_i^n \\right) - \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n使用提供的网格单元平均密度 $\\bar{q}_i$ 和网格单元体积 $|V_i|$，网格单元 $i$ 中的质量近似为 $M_i = \\bar{q}_i |V_i|$。项 $\\mathcal{S}_{i, \\Delta t}$ 对应于给定的量。因此，诊断量为：\n$$\n\\Delta M = \\sum_{i=1}^{N} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i| - \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n现在我们为给定的5网格单元网格计算 $\\Delta M$。首先，我们计算总质量变化 $\\Delta M_{computed} = \\sum_{i=1}^{5} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i|$：\n\\begin{itemize}\n    \\item 网格单元 $1$: $\\Delta M_1 = (7.55 \\times 10^{-3} - 7.50 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.5 \\times 10^{16} \\, \\mathrm{m^3}) = 4.75 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 $2$: $\\Delta M_2 = (6.78 \\times 10^{-3} - 6.80 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.3 \\times 10^{17} \\, \\mathrm{m^3}) = -2.6 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 $3$: $\\Delta M_3 = (8.11 \\times 10^{-3} - 8.10 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (8.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.8 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 $4$: $\\Delta M_4 = (7.19 \\times 10^{-3} - 7.20 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.1 \\times 10^{17} \\, \\mathrm{m^3}) = -1.1 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 $5$: $\\Delta M_5 = (6.91 \\times 10^{-3} - 6.90 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.9 \\times 10^{12} \\, \\mathrm{kg}$\n\\end{itemize}\n计算出的总质量变化为：\n$$\n\\Delta M_{computed} = (4.75 - 2.6 + 0.8 - 1.1 + 0.9) \\times 10^{12} \\, \\mathrm{kg} = 2.75 \\times 10^{12} \\, \\mathrm{kg}\n$$\n接下来，我们计算总积分源项 $\\mathcal{S}_{total} = \\sum_{i=1}^{5} \\mathcal{S}_{i, \\Delta t}$:\n$$\n\\mathcal{S}_{total} = (2.50 \\times 10^{12} + 1.00 \\times 10^{11} + 5.00 \\times 10^{10} + 6.00 \\times 10^{10} + 3.00 \\times 10^{10}) \\, \\mathrm{kg}\n$$\n$$\n\\mathcal{S}_{total} = (2.50 + 0.100 + 0.050 + 0.060 + 0.030) \\times 10^{12} \\, \\mathrm{kg} = 2.74 \\times 10^{12} \\, \\mathrm{kg}\n$$\n最后，全球质量漂移 $\\Delta M$ 是这两个量之间的差值：\n$$\n\\Delta M = \\Delta M_{computed} - \\mathcal{S}_{total} = 2.75 \\times 10^{12} \\, \\mathrm{kg} - 2.74 \\times 10^{12} \\, \\mathrm{kg} = 0.01 \\times 10^{12} \\, \\mathrm{kg}\n$$\n$$\n\\Delta M = 1 \\times 10^{10} \\, \\mathrm{kg}\n$$\n问题要求将答案四舍五入到三位有效数字。$\\Delta M$ 的非零值表明数值实现不是完全守恒的，导致在该时间步内产生了虚假的质量。\n\n$$\n\\Delta M = 1.00 \\times 10^{10} \\, \\mathrm{kg}\n$$",
            "answer": "$$\n\\boxed{1.00 \\times 10^{10}}\n$$"
        }
    ]
}