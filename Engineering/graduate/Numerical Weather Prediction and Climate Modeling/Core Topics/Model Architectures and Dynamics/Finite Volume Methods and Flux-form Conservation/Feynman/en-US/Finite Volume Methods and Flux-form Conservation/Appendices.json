{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the finite volume method is its adherence to conservation laws, a property inherited directly from the integral form of the governing equations. This exercise challenges you to apply this principle on a global scale, demonstrating how physical boundary conditions in a closed system, such as an atmosphere, mathematically enforce the global conservation of total air mass . Understanding this connection is fundamental to building trust in the physical realism of numerical models.",
            "id": "4043035",
            "problem": "Consider a global dry atmosphere represented as a thin spherical shell surrounding a planet of radius $a$, with vertical coordinate $z \\in [0, H]$ measured upward from the surface, longitude $\\lambda \\in [0, 2\\pi)$ (periodic), and latitude $\\phi \\in [-\\pi/2, \\pi/2]$. Let the dry-air density be $\\rho(\\lambda, \\phi, z, t)$ and the velocity be $\\mathbf{u}(\\lambda, \\phi, z, t) = (u, v, w)$ in the eastward, northward, and vertical directions, respectively. The top ($z=H$) and bottom ($z=0$) boundaries are impermeable, meaning $w = 0$ at $z=0$ and $z=H$. There are no internal sources or sinks of dry-air mass.\n\nYou discretize the domain using the Finite Volume Method (FVM) on a logically rectangular grid in $(\\lambda, \\phi, z)$ with cell indices $(i, j, k)$ and spacings $\\Delta \\lambda_i$, $\\Delta \\phi_j$, and $\\Delta z_k$. In the thin-shell approximation, the volume of cell $(i, j, k)$ is $V_{i,j,k} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j \\,\\Delta z_k$. Denote the outward face-normal, face-integrated dry-air mass fluxes by\n- $F^{\\lambda}_{i+1/2, j, k}(t) = \\int_{A^{\\lambda}_{i+1/2, j, k}} \\rho u \\, dA$ across the longitudinal face at $\\lambda_{i+1/2}$ with area $A^{\\lambda}_{i+1/2, j, k} = a \\,\\Delta \\phi_j \\,\\Delta z_k$,\n- $F^{\\phi}_{i, j+1/2, k}(t) = \\int_{A^{\\phi}_{i, j+1/2, k}} \\rho v \\, dA$ across the latitudinal face at $\\phi_{j+1/2}$ with area $A^{\\phi}_{i, j+1/2, k} = a \\cos\\phi_{j+1/2} \\,\\Delta \\lambda_i \\,\\Delta z_k$,\n- $F^{z}_{i, j, k+1/2}(t) = \\int_{A^{z}_{i, j, k+1/2}} \\rho w \\, dA$ across the horizontal face at $z_{k+1/2}$ with area $A^{z}_{i, j, k+1/2} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j$.\n\nThe local dry-air mass conservation law in flux form is the fundamental starting point:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\left(\\rho \\mathbf{u}\\right) = 0.\n$$\n\nDefine the globally integrated, time-accumulated dry-air mass flux through the external boundary of the spherical shell over one time step $\\Delta t = t^{n+1} - t^{n}$ by\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt,\n$$\nwhere $\\partial \\Omega$ is the physical boundary of the domain and $\\mathbf{n}$ is the outward unit normal.\n\nStarting from the local flux-form conservation law and using only the stated geometric and boundary assumptions (periodic longitude, impermeable top and bottom), compute the value of $I$. Your answer must be a single number or a single closed-form analytic expression. No rounding is required and no units should be reported in the final boxed answer.",
            "solution": "The problem asks for the value of the quantity $I$, defined as the globally integrated, time-accumulated dry-air mass flux through the external boundary of the domain:\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt\n$$\nThe inner integral, $\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS$, represents the net rate of mass transport out of the entire atmospheric domain $\\Omega$ at a given instant in time.\n\nThe domain $\\Omega$ is a spherical shell. The physical boundary of this domain, $\\partial \\Omega$, consists of surfaces where the domain is not continuous or periodic. We identify these boundary surfaces based on the given coordinate ranges:\n1.  **Longitudinal boundaries:** The domain is periodic in longitude $\\lambda \\in [0, 2\\pi)$. There is no net flux contribution from these boundaries, as they are not part of the external boundary.\n2.  **Latitudinal boundaries:** The domain extends from the south pole ($\\phi = -\\pi/2$) to the north pole ($\\phi = \\pi/2$). These are not boundary surfaces; the domain is closed at the poles.\n3.  **Vertical boundaries:** The domain is bounded below by the planet's surface at $z=0$ and above by the top of the atmosphere at $z=H$. These are the physical external boundaries.\n\nTherefore, the external boundary $\\partial \\Omega$ consists of two distinct surfaces: the bottom surface $S_{bottom}$ at $z=0$ and the top surface $S_{top}$ at $z=H$. The surface integral can be split into two parts:\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{top}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS + \\int_{S_{bottom}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS\n$$\nWe now analyze the integrand $\\rho\\,\\mathbf{u} \\cdot \\mathbf{n}$ on each of these surfaces.\n\n-   **At the top surface ($S_{top}$, where $z=H$):** The outward unit normal vector $\\mathbf{n}$ points in the positive vertical direction. The velocity vector is $\\mathbf{u} = (u, v, w)$. The dot product $\\mathbf{u} \\cdot \\mathbf{n}$ isolates the component of velocity normal to the surface, which is the vertical velocity $w$. The problem states that the top boundary is impermeable, with the condition $w = 0$ at $z=H$. Therefore, on this surface, the normal mass flux is $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = \\rho w = \\rho(0) = 0$. The integral over this surface is consequently zero.\n\n-   **At the bottom surface ($S_{bottom}$, where $z=0$):** The outward unit normal vector $\\mathbf{n}$ points away from the domain, which means it points in the negative vertical direction. The dot product is $\\mathbf{u} \\cdot \\mathbf{n} = -w$. The problem states that the bottom boundary is also impermeable, with the condition $w = 0$ at $z=0$. Therefore, on this surface, the normal mass flux is $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = -\\rho w = -\\rho(0) = 0$. The integral over this surface is also zero.\n\nSince the flux is zero across all parts of the external boundary $\\partial \\Omega$, the total net mass flux out of the domain is zero at all times:\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 + 0 = 0 \\quad \\text{for all } t\n$$\nThe problem asks for the value of $I$, which is the time integral of this net flux. Since the integrand is identically zero, the integral is also zero:\n$$\nI = \\int_{t^n}^{t^{n+1}} (0) \\, dt = 0\n$$\nThis result demonstrates that in a closed system with impermeable boundaries, the total mass is conserved, and the net transport across the boundary is zero by definition. The information regarding the finite volume discretization, while providing context, is not required for this particular calculation.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving from continuous theory to discrete implementation introduces the critical challenge of numerical stability. This practice guides you through the derivation of the Courant-Friedrichs-Lewy (CFL) condition for a simple advection scheme, a foundational concept for any explicit time-stepping method . By linking the time step, grid spacing, and physical wave speeds, you will gain practical insight into the constraints that govern the operational limits of numerical simulations.",
            "id": "4042968",
            "problem": "Consider the linear advection of a passive tracer field governed by the conservation law in flux form,\n$$\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\left( \\boldsymbol{U}\\, q \\right) = 0,$$\nwhere $q$ is the cell-averaged tracer mixing ratio and $\\boldsymbol{U} = (u, v, w)$ is a prescribed, time-independent velocity field. Assume an explicit first-order upwind finite volume discretization on a Cartesian grid. Time integration is by forward Euler, and fluxes are evaluated using upwind states based on the sign of the face-normal velocity component. The Courant–Friedrichs–Lewy (CFL) condition is the constraint that guarantees stability and nonnegativity of the update by ensuring that the new cell average is a convex combination of existing cell averages.\n\nTask A (one-dimensional derivation): Specialize to one spatial dimension with constant advection speed $a$ and spatially varying cell widths $\\Delta x_i$. Starting from the integral conservation law over a control volume and using the explicit upwind flux, derive the necessary stability constraint on the time step $\\Delta t$ that ensures the update is a convex combination of neighboring cell averages and thus preserves positivity and $L^1$ stability. Express the constraint in terms of $|a|$, $\\Delta x_i$, and a domain-wide condition.\n\nTask B (multi-dimensional generalization): For the three-dimensional case with uniform spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, and constant velocity components $u$, $v$, and $w$, derive the explicit CFL constraint on $\\Delta t$ imposed by the unsplit finite volume update with first-order upwind fluxes. Your derivation should start from the finite volume flux balance over a single cell and impose the convexity (all weights nonnegative and summing to one) of the update.\n\nTask C (numerical evaluation): Using your derived constraints, compute the maximum permissible $\\Delta t$ for the following two configurations:\n\n- One-dimensional configuration: four cells with widths $\\Delta x_1 = 20 \\text{ km}$, $\\Delta x_2 = 12 \\text{ km}$, $\\Delta x_3 = 8 \\text{ km}$, $\\Delta x_4 = 16 \\text{ km}$, with constant advection speed $a = +35 \\text{ m s}^{-1}$. Report the domain-wide maximum stable $\\Delta t$ in seconds based on the strictest cell.\n\n- Three-dimensional configuration: uniform spacings $\\Delta x = 12 \\text{ km}$, $\\Delta y = 15 \\text{ km}$, $\\Delta z = 500 \\text{ m}$ and constant velocities $u = 25 \\text{ m s}^{-1}$, $v = 15 \\text{ m s}^{-1}$, $w = 0.50 \\text{ m s}^{-1}$. Report the maximum stable $\\Delta t$ in seconds implied by your three-dimensional CFL condition.\n\nRound your two numerical answers to four significant figures and express them in seconds. Provide your final numerical answers in the order (one-dimensional $\\Delta t_{\\max}$, three-dimensional $\\Delta t_{\\max}$).",
            "solution": "### Solution\n\n#### Task A: One-Dimensional Derivation\nWe begin with the one-dimensional conservation law:\n$$ \\frac{\\partial q}{\\partial t} + \\frac{\\partial (a q)}{\\partial x} = 0 $$\nTo obtain the finite volume discretization, we integrate this equation over a control volume (cell $i$) of width $\\Delta x_i$.\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (aq)}{\\partial x} dx = 0 $$\nDefining the cell-average quantity as $q_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x, t) dx$ and applying the fundamental theorem of calculus, we get:\n$$ \\Delta x_i \\frac{dq_i}{dt} + (aq)_{i+1/2} - (aq)_{i-1/2} = 0 $$\nDiscretizing in time with the forward Euler method and letting $F=aq$ be the flux:\n$$ \\Delta x_i \\frac{q_i^{n+1} - q_i^n}{\\Delta t} + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\nRearranging for the updated value $q_i^{n+1}$:\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(F_{i+1/2}^n - F_{i-1/2}^n\\right) $$\nThe first-order upwind scheme sets the flux based on the upwind cell. Assuming $a > 0$, flow is from left to right, so $F_{i-1/2}^n = a q_{i-1}^n$ and $F_{i+1/2}^n = a q_i^n$.\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(a q_i^n - a q_{i-1}^n\\right) = \\left(1 - \\frac{a \\Delta t}{\\Delta x_i}\\right) q_i^n + \\frac{a \\Delta t}{\\Delta x_i} q_{i-1}^n $$\nA similar expression is found for $a  0$ using $|a|$. For this update to be a convex combination, the coefficients must be non-negative (they already sum to 1). The coefficient of the upwind neighbor, $\\frac{|a|\\Delta t}{\\Delta x_i}$, is non-negative. The constraint thus falls on the coefficient of $q_i^n$:\n$$ 1 - \\frac{|a| \\Delta t}{\\Delta x_i} \\ge 0 \\implies \\frac{|a| \\Delta t}{\\Delta x_i} \\le 1 $$\nThis gives the stability constraint for cell $i$:\n$$ \\Delta t \\le \\frac{\\Delta x_i}{|a|} $$\nFor stability across the entire domain, the time step $\\Delta t$ must satisfy this condition for the most restrictive case (the smallest $\\Delta x_i$):\n$$ \\Delta t \\le \\min_i \\left( \\frac{\\Delta x_i}{|a|} \\right) = \\frac{\\min_i(\\Delta x_i)}{|a|} $$\n\n#### Task B: Three-Dimensional Generalization\nThe three-dimensional conservation law integrated over a cell volume $V_{ijk} = \\Delta x \\Delta y \\Delta z$ and discretized with forward Euler gives the update:\n$$ q_{ijk}^{n+1} = q_{ijk}^n - \\frac{\\Delta t}{\\Delta x} \\left[ (uq)_{i+1/2} - (uq)_{i-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta y} \\left[ (vq)_{j+1/2} - (vq)_{j-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta z} \\left[ (wq)_{k+1/2} - (wq)_{k-1/2} \\right]^n $$\nUsing the first-order upwind scheme, each flux difference term contributes a term proportional to $q_{ijk}^n$ and one proportional to an upwind neighbor. For example, the $x$-direction flux balance is $\\frac{\\Delta t}{\\Delta x}(|u|q_{ijk}^n - u^+ q_{i-1,j,k}^n - u^- q_{i+1,j,k}^n)$. Collecting all coefficients of $q_{ijk}^n$ from the $x, y,$ and $z$ directions gives:\n$$ q_{ijk}^{n+1} = \\left(1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} - \\frac{|w|\\Delta t}{\\Delta z}\\right) q_{ijk}^n + (\\text{terms involving neighbors}) $$\nThe sum of coefficients is $1$. For a convex combination, the coefficient of $q_{ijk}^n$ must be non-negative:\n$$ 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} - \\frac{|w|\\Delta t}{\\Delta z} \\ge 0 $$\nRearranging for $\\Delta t$ gives the CFL stability constraint:\n$$ \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z} \\right) \\le 1 \\implies \\Delta t \\le \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}} $$\n\n#### Task C: Numerical Evaluation\nUnits are converted to SI (meters and seconds).\n\n- **One-dimensional configuration**:\n$\\Delta x = \\{20000, 12000, 8000, 16000\\}$ m.\n$|a| = 35 \\text{ m s}^{-1}$.\nThe minimum cell width is $\\min_i(\\Delta x_i) = 8000 \\text{ m}$.\nUsing the formula from Task A, the maximum permissible time step is:\n$$ \\Delta t_{\\max} = \\frac{\\min_i(\\Delta x_i)}{|a|} = \\frac{8000 \\text{ m}}{35 \\text{ m s}^{-1}} \\approx 228.5714 \\text{ s} $$\nRounding to four significant figures, $\\Delta t_{\\max} = 228.6 \\text{ s}$.\n\n- **Three-dimensional configuration**:\n$\\Delta x = 12000 \\text{ m}$, $\\Delta y = 15000 \\text{ m}$, $\\Delta z = 500 \\text{ m}$.\n$|u| = 25 \\text{ m s}^{-1}$, $|v| = 15 \\text{ m s}^{-1}$, $|w| = 0.50 \\text{ m s}^{-1}$.\nUsing the formula from Task B:\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{25}{12000} + \\frac{15}{15000} + \\frac{0.50}{500}} = \\frac{1}{\\frac{1}{480} + \\frac{1}{1000} + \\frac{1}{1000}} $$\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{1}{480} + \\frac{2}{1000}} = \\frac{1}{\\frac{1}{480} + \\frac{1}{500}} = \\frac{1}{\\frac{500+480}{480 \\times 500}} = \\frac{240000}{980} = \\frac{12000}{49} \\text{ s} \\approx 244.8979 \\text{ s} $$\nRounding to four significant figures, $\\Delta t_{\\max} = 244.9 \\text{ s}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 228.6  244.9 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A numerical scheme that is conservative in theory may still fail to be so in practice due to approximations or coding errors. This exercise provides a hands-on method for a vital skill in model development: verification . You will derive and apply a diagnostic to quantify the \"mass drift\" in a hypothetical model, learning how to distinguish between intended physical changes and spurious numerical artifacts.",
            "id": "4042959",
            "problem": "Consider a global atmospheric tracer transported and transformed using the Finite Volume Method (FVM). Let the prognostic variable be the tracer mass density $q$ with units $\\mathrm{kg\\,m^{-3}}$, governed by the flux-form conservation law $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S$, where $\\boldsymbol{F}$ is the advective flux of $q$ and $S$ is the source-minus-sink per unit volume with units $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$. The global domain is closed (no exchange across the external boundary). The model discretizes the global domain into $N$ control volumes (cells) $V_i$ with volumes $|V_i|$. Denote the cell-mean mass density at the beginning and end of a single time step by $\\bar{q}_i^{n}$ and $\\bar{q}_i^{n+1}$, respectively, and define $\\Delta \\bar{q}_i = \\bar{q}_i^{n+1} - \\bar{q}_i^{n}$. The source-minus-sink term is implemented through a volume-integrated rate for each cell, such that $\\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt$ has units of $\\mathrm{kg}$ and represents the cell’s time-integrated net production over the step.\n\nStarting from the flux-form conservation law and using control-volume integration, derive a global mass budget over one time step that compares the total change in tracer mass to the time-integrated, volume-integrated sources. Use this to construct a diagnostic for global mass drift over one time step, $\\Delta M$, which should vanish for a perfectly conservative discretization on a closed domain. Then, for the following five-cell global mesh, compute $\\Delta M$ using the provided data. Interpret a nonzero value as a numerical inconsistency arising from flux mismatch or time stepping.\n\nThe mesh and data are:\n- $|V_1| = 9.5 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_2| = 1.3 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_3| = 8.0 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_4| = 1.1 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_5| = 9.0 \\times 10^{16}\\ \\mathrm{m^{3}}$.\n- $\\bar{q}_1^{n} = 7.50 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_1^{n+1} = 7.55 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_2^{n} = 6.80 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_2^{n+1} = 6.78 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_3^{n} = 8.10 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_3^{n+1} = 8.11 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_4^{n} = 7.20 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_4^{n+1} = 7.19 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_5^{n} = 6.90 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_5^{n+1} = 6.91 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$.\n- $\\int_{t}^{t+\\Delta t} \\bar{S}_1 \\, dt = 2.50 \\times 10^{12}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_2 \\, dt = 1.00 \\times 10^{11}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_3 \\, dt = 5.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_4 \\, dt = 6.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_5 \\, dt = 3.00 \\times 10^{10}\\ \\mathrm{kg}$.\n\nCompute the diagnostic $\\Delta M$ for this time step and express your final answer in $\\mathrm{kg}$. Round your answer to three significant figures.",
            "solution": "The derivation of the global mass budget begins with the governing flux-form conservation law:\n$$\n\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S\n$$\nIntegrating over an arbitrary control volume $V_i$ and applying the divergence theorem gives:\n$$\n\\frac{d}{dt} \\int_{V_i} q \\, dV + \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\int_{V_i} S \\, dV\n$$\nSumming this equation over all $N$ control volumes in the global domain:\n$$\n\\sum_{i=1}^{N} \\frac{d}{dt} \\int_{V_i} q \\, dV + \\sum_{i=1}^{N} \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\sum_{i=1}^{N} \\int_{V_i} S \\, dV\n$$\nThe first term is the rate of change of the total global mass, $\\frac{dM_{total}}{dt}$. In a conservative finite volume method, the sum of fluxes over all internal cell boundaries cancels out (the telescoping sum property). Since the domain is closed, the flux across the external boundary is zero. Thus, the second term vanishes. This leaves:\n$$\n\\frac{dM_{total}}{dt} = \\int_{V_{total}} S \\, dV\n$$\nIntegrating this over one time step from $t^n$ to $t^{n+1}$ yields the ideal mass budget: the change in total mass must equal the total mass added by sources minus that removed by sinks.\n$$\nM_{total}^{n+1} - M_{total}^n = \\int_{t^n}^{t^{n+1}} \\left( \\int_{V_{total}} S \\, dV \\right) dt\n$$\nA diagnostic for the global mass drift, $\\Delta M$, is the difference between the numerically computed change in total mass and the expected change from the integrated sources. Any non-zero value indicates a numerical conservation error.\n$$\n\\Delta M = \\left( \\sum_{i=1}^{N} M_i^{n+1} - \\sum_{i=1}^{N} M_i^n \\right) - \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\nUsing the provided cell-mean densities $\\bar{q}_i$ and volumes $|V_i|$, the mass in cell $i$ is $M_i = \\bar{q}_i |V_i|$, and $\\mathcal{S}_{i, \\Delta t}$ is the given time-integrated source for cell $i$. The diagnostic is:\n$$\n\\Delta M = \\sum_{i=1}^{N} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i| - \\sum_{i=1}^{N} \\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt\n$$\nWe now compute $\\Delta M$ for the given $5$-cell mesh. First, we compute the total computed change in mass, $\\Delta M_{computed} = \\sum_{i=1}^{5} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i|$:\n- Cell 1: $\\Delta M_1 = (7.55 \\times 10^{-3} - 7.50 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.5 \\times 10^{16} \\, \\mathrm{m^3}) = 4.75 \\times 10^{12} \\, \\mathrm{kg}$\n- Cell 2: $\\Delta M_2 = (6.78 \\times 10^{-3} - 6.80 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.3 \\times 10^{17} \\, \\mathrm{m^3}) = -2.6 \\times 10^{12} \\, \\mathrm{kg}$\n- Cell 3: $\\Delta M_3 = (8.11 \\times 10^{-3} - 8.10 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (8.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.8 \\times 10^{12} \\, \\mathrm{kg}$\n- Cell 4: $\\Delta M_4 = (7.19 \\times 10^{-3} - 7.20 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.1 \\times 10^{17} \\, \\mathrm{m^3}) = -1.1 \\times 10^{12} \\, \\mathrm{kg}$\n- Cell 5: $\\Delta M_5 = (6.91 \\times 10^{-3} - 6.90 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.9 \\times 10^{12} \\, \\mathrm{kg}$\n\nThe total computed change in mass is:\n$$\n\\Delta M_{computed} = (4.75 - 2.6 + 0.8 - 1.1 + 0.9) \\times 10^{12} \\, \\mathrm{kg} = 2.75 \\times 10^{12} \\, \\mathrm{kg}\n$$\nNext, we compute the total integrated source, $\\mathcal{S}_{total} = \\sum_{i=1}^{5} \\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt$:\n$$\n\\mathcal{S}_{total} = (2.50 \\times 10^{12} + 1.00 \\times 10^{11} + 5.00 \\times 10^{10} + 6.00 \\times 10^{10} + 3.00 \\times 10^{10}) \\, \\mathrm{kg}\n$$\n$$\n\\mathcal{S}_{total} = (2.50 + 0.100 + 0.050 + 0.060 + 0.030) \\times 10^{12} \\, \\mathrm{kg} = 2.74 \\times 10^{12} \\, \\mathrm{kg}\n$$\nFinally, the global mass drift $\\Delta M$ is the difference between these two quantities:\n$$\n\\Delta M = \\Delta M_{computed} - \\mathcal{S}_{total} = 2.75 \\times 10^{12} \\, \\mathrm{kg} - 2.74 \\times 10^{12} \\, \\mathrm{kg} = 0.01 \\times 10^{12} \\, \\mathrm{kg}\n$$\n$$\n\\Delta M = 1 \\times 10^{10} \\, \\mathrm{kg}\n$$\nRounding to three significant figures:\n$$\n\\Delta M = 1.00 \\times 10^{10} \\, \\mathrm{kg}\n$$",
            "answer": "$$\n\\boxed{1.00 \\times 10^{10}}\n$$"
        }
    ]
}