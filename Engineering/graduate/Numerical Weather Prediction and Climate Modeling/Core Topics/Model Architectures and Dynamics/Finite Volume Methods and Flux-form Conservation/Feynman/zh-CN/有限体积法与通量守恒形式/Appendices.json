{
    "hands_on_practices": [
        {
            "introduction": "有限体积法的核心优势在于其固有的守恒性。本练习旨在从最基本的层面阐释这一原理：在一个封闭系统中的全局守恒。你将通过分析一个具有无通量边界条件的理想化大气模型，证明其总干空气质量必须守恒，这是通过论证跨越整个模型域外部边界的总质量通量为零来实现的。这项练习强化了边界条件在确保全局守恒定律中的关键作用。",
            "id": "4043035",
            "problem": "考虑一个全球干大气，它被表示为一个薄的球壳，包裹着一个半径为 $a$ 的行星。其垂直坐标为 $z \\in [0, H]$（从地表向上测量），经度为 $\\lambda \\in [0, 2\\pi)$（周期性），纬度为 $\\phi \\in [-\\pi/2, \\pi/2]$。设干空气密度为 $\\rho(\\lambda, \\phi, z, t)$，速度为 $\\mathbf{u}(\\lambda, \\phi, z, t) = (u, v, w)$，分别表示向东、向北和垂直方向的速度分量。顶部（$z=H$）和底部（$z=0$）边界是不可渗透的，意味着在 $z=0$ 和 $z=H$ 处，$w = 0$。干空气质量没有内部源或汇。\n\n我们使用有限体积法（FVM）在一个逻辑上为矩形的 $(\\lambda, \\phi, z)$ 网格上对该区域进行离散化，网格单元索引为 $(i, j, k)$，间距为 $\\Delta \\lambda_i$、$\\Delta \\phi_j$ 和 $\\Delta z_k$。在薄壳近似下，单元 $(i, j, k)$ 的体积为 $V_{i,j,k} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j \\,\\Delta z_k$。将通过各个面、沿面向外法线方向积分的干空气质量通量表示为\n- $F^{\\lambda}_{i+1/2, j, k}(t) = \\int_{A^{\\lambda}_{i+1/2, j, k}} \\rho u \\, dA$ 是穿过位于 $\\lambda_{i+1/2}$ 处经向面的通量，该面面积为 $A^{\\lambda}_{i+1/2, j, k} = a \\,\\Delta \\phi_j \\,\\Delta z_k$，\n- $F^{\\phi}_{i, j+1/2, k}(t) = \\int_{A^{\\phi}_{i, j+1/2, k}} \\rho v \\, dA$ 是穿过位于 $\\phi_{j+1/2}$ 处纬向面的通量，该面面积为 $A^{\\phi}_{i, j+1/2, k} = a \\cos\\phi_{j+1/2} \\,\\Delta \\lambda_i \\,\\Delta z_k$，\n- $F^{z}_{i, j, k+1/2}(t) = \\int_{A^{z}_{i, j, k+1/2}} \\rho w \\, dA$ 是穿过位于 $z_{k+1/2}$ 处水平面的通量，该面面积为 $A^{z}_{i, j, k+1/2} = a^{2} \\cos\\phi_j \\,\\Delta \\lambda_i \\,\\Delta \\phi_j$。\n\n通量形式的局地干空气质量守恒定律是基本的出发点：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\left(\\rho \\mathbf{u}\\right) = 0.\n$$\n\n定义在一个时间步长 $\\Delta t = t^{n+1} - t^{n}$ 内，通过球壳外部边界的全球积分、时间累积的干空气质量通量为\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt,\n$$\n其中 $\\partial \\Omega$ 是区域的物理边界，$\\mathbf{n}$ 是向外的单位法向量。\n\n从局地通量形式的守恒定律出发，并仅使用给定的几何和边界假设（周期性经度、不可渗透的顶部和底部），计算 $I$ 的值。你的答案必须是一个单一的数字或一个单一的封闭形式解析表达式。不需要四舍五入，最终的方框答案中不应报告单位。",
            "solution": "问题要求计算量 $I$ 的值，该量被定义为通过区域外部边界的全球积分、时间累积的干空气质量通量：\n$$\nI \\equiv \\int_{t^n}^{t^{n+1}} \\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS \\, dt\n$$\n内部的积分 $\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS$ 表示在给定时刻，离开整个大气区域 $\\Omega$ 的净质量输送率。向量 $\\rho \\mathbf{u}$ 是质量通量向量。\n\n区域 $\\Omega$ 是一个由坐标范围定义的球壳：经度 $\\lambda \\in [0, 2\\pi)$，纬度 $\\phi \\in [-\\pi/2, \\pi/2]$，以及垂直坐标 $z \\in [0, H]$。该区域的物理边界 $\\partial \\Omega$ 由区域不连续或非周期性的表面组成。\n\n我们来确定这些边界面：\n1.  **经向边界：** 问题指出该区域在经度 $\\lambda$ 上是周期性的。这意味着 $\\lambda=0$ 和 $\\lambda=2\\pi$ 处的表面是同一的。任何在 $\\lambda=2\\pi$ 处离开区域的流动，都会有相同的流动在 $\\lambda=0$ 处进入。因此，这些边界没有净通量贡献；它们不属于外部边界 $\\partial \\Omega$ 的一部分。\n2.  **纬向边界：** 区域从南极（$\\phi = -\\pi/2$）延伸到北极（$\\phi = \\pi/2$）。两极是点（或在 $(\\lambda, \\phi, z)$ 空间中的线），而不是面。任何纬向面的面积在 $\\phi \\to \\pm \\pi/2$ 时都收缩为零。因此，两极没有物理边界，也没有质量通量穿过它们。\n3.  **垂直边界：** 区域的下界是 $z=0$ 处的行星表面，上界是 $z=H$ 处的大气层顶部。这些是物理的、非周期性的边界。\n\n因此，外部边界 $\\partial \\Omega$ 由两个不同的表面组成：位于 $z=0$ 处的底面 $S_{bottom}$ 和位于 $z=H$ 处的顶面 $S_{top}$。面积分可以分解为两部分：\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{top}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS + \\int_{S_{bottom}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS\n$$\n我们现在分析在每个表面上的被积函数 $\\rho\\,\\mathbf{u} \\cdot \\mathbf{n}$。\n\n-   **在顶面（$S_{top}$，其中 $z=H$）：** 向外的单位法向量 $\\mathbf{n}$ 指向正垂直方向。速度向量为 $\\mathbf{u} = (u, v, w)$。点积 $\\mathbf{u} \\cdot \\mathbf{n}$ 分离出垂直于表面的速度分量，即垂直速度 $w$。问题指出顶部边界是不可渗透的，条件为在 $z=H$ 处 $w = 0$。因此，在该表面上，法向质量通量为 $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = \\rho w = \\rho(0) = 0$。所以，对该表面的积分为零：\n    $$\n    \\int_{S_{top}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{top}} \\rho w \\, dS = 0\n    $$\n\n-   **在底面（$S_{bottom}$，其中 $z=0$）：** 向外的单位法向量 $\\mathbf{n}$ 指向离开区域的方向，即指向负垂直方向。点积为 $\\mathbf{u} \\cdot \\mathbf{n} = -w$。问题指出底部边界也是不可渗透的，条件为在 $z=0$ 处 $w = 0$。因此，在该表面上，法向质量通量为 $\\rho (\\mathbf{u} \\cdot \\mathbf{n}) = -\\rho w = -\\rho(0) = 0$。所以，对该表面的积分也为零：\n    $$\n    \\int_{S_{bottom}} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{S_{bottom}} (-\\rho w) \\, dS = 0\n    $$\n由于穿过外部边界 $\\partial \\Omega$ 所有部分的通量均为零，因此在所有时刻离开该区域的总净质量通量都为零：\n$$\n\\oint_{\\partial \\Omega} \\rho \\,\\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 + 0 = 0 \\quad \\text{for all } t \\in [t^n, t^{n+1}]\n$$\n这是“无通量”或“不可渗透”边界条件的直接结果，其物理意义是这是一个与其周围环境没有质量交换的封闭系统。\n\n问题要求计算 $I$ 的值，它是这个净通量的时间积分。由于被积函数恒为零，所以积分也为零：\n$$\nI = \\int_{t^n}^{t^{n+1}} (0) \\, dt = 0\n$$\n局地守恒定律 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 和散度定理证实了这一结果。将守恒定律在整个区域 $\\Omega$ 上积分可得：\n$$\n\\int_{\\Omega} \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_{\\Omega} \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0\n$$\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\rho \\, dV + \\oint_{\\partial \\Omega} \\rho \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0\n$$\n该方程表明，区域内总质量的变化率 $\\frac{dM}{dt}$ 等于离开边界的净质量通量的负值。由于我们已经证明边界通量积分为零，这意味着 $\\frac{dM}{dt} = 0$。总质量是守恒的。问题要求的是在一个时间间隔内穿过边界的总质量，这必须为零。关于有限体积离散化的详细信息与此结论一致，但推导该结论并不需要这些信息。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在数值上实现守恒定律时，保证计算过程的稳定性是至关重要的一步。本练习聚焦于显式时间积分格式的一个关键约束：Courant-Friedrichs-Lewy (CFL) 条件。你将为一维和三维的平流问题推导出这一稳定性判据，它将时间步长$ \\Delta t $与网格大小和流速联系起来，从而确保数值解不会无限增长而变得无意义。",
            "id": "4042968",
            "problem": "考虑由通量形式的守恒律控制的被动示踪场的线性平流，\n$$\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\left( \\boldsymbol{U}\\, q \\right) = 0,$$\n其中 $q$ 是网格平均的示踪剂混合比，$\\boldsymbol{U} = (u, v, w)$ 是一个给定的、不随时间变化的速度场。假设在笛卡尔网格上采用显式一阶迎风有限体积离散化。时间积分采用前向欧拉法，通量根据面法向速度分量的符号使用迎风状态进行评估。Courant–Friedrichs–Lewy (CFL) 条件是一个约束条件，它通过确保新的网格平均值是现有网格平均值的凸组合，来保证更新的稳定性和非负性。\n\n任务 A（一维推导）：特化到一维空间，平流速度 $a$ 为常数，网格宽度 $\\Delta x_i$ 在空间上变化。从控制体积上的积分守恒律出发，使用显式迎风通量，推导时间步长 $\\Delta t$ 上必要的稳定性约束，该约束确保更新是相邻网格平均值的凸组合，从而保持正定性和 $L^1$ 稳定性。用 $|a|$、$\\Delta x_i$ 和一个全域条件来表示该约束。\n\n任务 B（多维推广）：对于三维情况，网格间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 均匀，速度分量 $u$、$v$ 和 $w$ 恒定，推导由带有一阶迎风通量的非分裂有限体积更新所施加在 $\\Delta t$ 上的显式 CFL 约束。您的推导应从单个网格上的有限体积通量平衡开始，并施加更新的凸性（所有权重非负且总和为一）。\n\n任务 C（数值计算）：使用您推导出的约束，计算以下两种配置的最大允许时间步长 $\\Delta t$：\n\n- 一维配置：四个网格，宽度分别为 $\\Delta x_1 = 20 \\text{ km}$、$\\Delta x_2 = 12 \\text{ km}$、$\\Delta x_3 = 8 \\text{ km}$、$\\Delta x_4 = 16 \\text{ km}$，平流速度恒为 $a = +35 \\text{ m s}^{-1}$。报告基于最严格网格的全域最大稳定时间步长 $\\Delta t$（单位：秒）。\n\n- 三维配置：均匀间距 $\\Delta x = 12 \\text{ km}$、$\\Delta y = 15 \\text{ km}$、$\\Delta z = 500 \\text{ m}$，恒定速度 $u = 25 \\text{ m s}^{-1}$、$v = 15 \\text{ m s}^{-1}$、$w = 0.50 \\text{ m s}^{-1}$。报告由您的三维 CFL 条件所蕴含的最大稳定时间步长 $\\Delta t$（单位：秒）。\n\n将您的两个数值答案四舍五入到四位有效数字，并以秒为单位表示。按顺序（一维 $\\Delta t_{\\max}$，三维 $\\Delta t_{\\max}$）提供您的最终数值答案。",
            "solution": "### 解答\n\n#### 任务 A：一维推导\n我们从一维守恒律开始：\n$$ \\frac{\\partial q}{\\partial t} + \\frac{\\partial (a q)}{\\partial x} = 0 $$\n为获得有限体积离散化，我们将此方程在一个控制体积（网格 $i$）上进行积分，从其左侧面 $x_{i-1/2}$ 到右侧面 $x_{i+1/2}$，网格宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial (aq)}{\\partial x} dx = 0 $$\n将网格平均量定义为 $q_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x, t) dx$ 并应用微积分基本定理，我们得到：\n$$ \\frac{d(\\Delta x_i q_i)}{dt} + (aq)_{i+1/2} - (aq)_{i-1/2} = 0 $$\n由于网格是静态的，$\\Delta x_i$ 不随时间变化。令 $F = aq$ 为通量。\n$$ \\Delta x_i \\frac{dq_i}{dt} + F_{i+1/2} - F_{i-1/2} = 0 $$\n使用前向欧拉法进行时间离散化（上标 $n$ 表示时间层 $t_n$）：\n$$ \\Delta x_i \\frac{q_i^{n+1} - q_i^n}{\\Delta t} + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\n为更新值 $q_i^{n+1}$ 重新整理方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(F_{i+1/2}^n - F_{i-1/2}^n\\right) $$\n一阶迎风格式根据速度 $a$ 的符号，基于“迎风”网格中的值来设定网格面上的通量。\n情况 1：$a  0$。流向为从左到右。在面 $i-1/2$ 和 $i+1/2$ 处的迎风值分别为 $q_{i-1}^n$ 和 $q_i^n$。\n$$ F_{i-1/2}^n = a q_{i-1}^n, \\quad F_{i+1/2}^n = a q_i^n $$\n代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(a q_i^n - a q_{i-1}^n\\right) = \\left(1 - \\frac{a \\Delta t}{\\Delta x_i}\\right) q_i^n + \\frac{a \\Delta t}{\\Delta x_i} q_{i-1}^n $$\n情况 2：$a  0$。流向为从右到左。在面 $i-1/2$ 和 $i+1/2$ 处的迎风值分别为 $q_i^n$ 和 $q_{i+1}^n$。\n$$ F_{i-1/2}^n = a q_i^n, \\quad F_{i+1/2}^n = a q_{i+1}^n $$\n代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x_i} \\left(a q_{i+1}^n - a q_i^n\\right) = \\left(1 + \\frac{a \\Delta t}{\\Delta x_i}\\right) q_i^n - \\frac{a \\Delta t}{\\Delta x_i} q_{i+1}^n $$\n在这种情况下使用 $|a| = -a$，方程变为：\n$$ q_i^{n+1} = \\left(1 - \\frac{|a| \\Delta t}{\\Delta x_i}\\right) q_i^n + \\frac{|a| \\Delta t}{\\Delta x_i} q_{i+1}^n $$\n在两种情况下，$q_i^{n+1}$ 都是 $q_i^n$ 及其迎风邻居的线性组合。要使其成为凸组合，系数必须非负且总和为 1。系数之和总是 1。非负性约束要求所有系数都大于或等于 0。迎风邻居的系数 $\\frac{|a|\\Delta t}{\\Delta x_i}$ 总是非负的。因此，约束落在 $q_i^n$ 的系数上：\n$$ 1 - \\frac{|a| \\Delta t}{\\Delta x_i} \\ge 0 \\implies \\frac{|a| \\Delta t}{\\Delta x_i} \\le 1 $$\n这给出了网格 $i$ 的稳定性约束：\n$$ \\Delta t \\le \\frac{\\Delta x_i}{|a|} $$\n为保证整个区域的稳定性，时间步长 $\\Delta t$ 必须对所有网格都满足此条件。这意味着它必须受到最严格情况的限制，即 $\\Delta x_i$ 最小的那个网格。\n$$ \\Delta t \\le \\min_i \\left( \\frac{\\Delta x_i}{|a|} \\right) = \\frac{\\min_i(\\Delta x_i)}{|a|} $$\n\n#### 任务 B：三维推广\n三维守恒律为 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (\\boldsymbol{U} q) = 0$。在一个网格体积 $V_{ijk} = \\Delta x \\Delta y \\Delta z$ 上积分并应用散度定理，得到：\n$$ \\frac{d(V_{ijk} q_{ijk})}{d t} + \\oiint_{\\partial V_{ijk}} (\\boldsymbol{U}q) \\cdot \\boldsymbol{n} \\, dS = 0 $$\n其中 $q_{ijk}$ 是网格平均值。对于静态网格，这变为：\n$$ V_{ijk} \\frac{dq_{ijk}}{dt} + \\sum_{\\text{faces}} \\int_{\\text{face}} (\\boldsymbol{U}q) \\cdot \\boldsymbol{n} \\, dS = 0 $$\n在对网格的六个面上的通量积分进行离散化并应用前向欧拉时间步进后，我们有：\n$$ q_{ijk}^{n+1} = q_{ijk}^n - \\frac{\\Delta t}{V_{ijk}} \\left[ (F_x)_{i+1/2} - (F_x)_{i-1/2} + (F_y)_{j+1/2} - (F_y)_{j-1/2} + (F_z)_{k+1/2} - (F_z)_{k-1/2} \\right]^n $$\n其中 $F_x, F_y, F_z$ 是通过垂直于 $x, y, z$ 轴的面的总通量。例如，$(F_x)_{i+1/2} = (uq)_{i+1/2} \\Delta y \\Delta z$。在代入 $V_{ijk} = \\Delta x \\Delta y \\Delta z$ 并化简后，更新方程变为：\n$$ q_{ijk}^{n+1} = q_{ijk}^n - \\frac{\\Delta t}{\\Delta x} \\left[ (uq)_{i+1/2} - (uq)_{i-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta y} \\left[ (vq)_{j+1/2} - (vq)_{j-1/2} \\right]^n - \\frac{\\Delta t}{\\Delta z} \\left[ (wq)_{k+1/2} - (wq)_{k-1/2} \\right]^n $$\n使用一阶迎风格式，每个通量项 $(uq)_{i+1/2}$、$(vq)_{j+1/2}$ 等由迎风网格中的状态决定。例如，如果 $u  0$，则 $(uq)_{i+1/2} = u q_{ijk}^n$ 且 $(uq)_{i-1/2} = u q_{i-1,j,k}^n$。考虑一般情况，我们可以使用速度的正部和负部来写通量，例如 $u = u^+ + u^-$，其中 $u^+ = \\max(u, 0)$ 且 $u^- = \\min(u,0)$。沿 x 方向穿过网格的净通量差为：\n$$ \\frac{u^+ (q_{ijk}^n - q_{i-1,j,k}^n)}{\\Delta x} + \\frac{u^- (q_{i+1,j,k}^n - q_{ijk}^n)}{\\Delta x} $$\n将所有三个维度的贡献项收集起来，并求解 $q_{ijk}^{n+1}$，得到 $q_{ijk}^n$ 的系数为：\n$$ \\left(1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} - \\frac{|w|\\Delta t}{\\Delta z}\\right) $$\n系数之和再次为 1。为了得到凸组合，$q_{ijk}^n$ 的系数必须为非负：\n$$ 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} - \\frac{|w|\\Delta t}{\\Delta z} \\ge 0 $$\n为 $\\Delta t$ 重新整理方程得到 CFL 稳定性约束：\n$$ \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z} \\right) \\le 1 $$\n$$ \\Delta t \\le \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}} $$\n\n#### 任务 C：数值计算\n为保持一致性，单位被转换为国际单位制（米和秒）。\n\n- **一维配置**：\n已知条件是：\n$\\Delta x_1 = 20 \\text{ km} = 20000 \\text{ m}$\n$\\Delta x_2 = 12 \\text{ km} = 12000 \\text{ m}$\n$\\Delta x_3 = 8 \\text{ km} = 8000 \\text{ m}$\n$\\Delta x_4 = 16 \\text{ km} = 16000 \\text{ m}$\n$a = +35 \\text{ m s}^{-1}$，所以 $|a| = 35 \\text{ m s}^{-1}$。\n最小网格宽度为 $\\min_i(\\Delta x_i) = 8000 \\text{ m}$。\n使用任务 A 中的公式，最大允许时间步长为：\n$$ \\Delta t_{\\max} = \\frac{\\min_i(\\Delta x_i)}{|a|} = \\frac{8000 \\text{ m}}{35 \\text{ m s}^{-1}} = \\frac{1600}{7} \\text{ s} \\approx 228.5714 \\text{ s} $$\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 228.6 \\text{ s}$。\n\n- **三维配置**：\n已知条件是：\n$\\Delta x = 12 \\text{ km} = 12000 \\text{ m}$\n$\\Delta y = 15 \\text{ km} = 15000 \\text{ m}$\n$\\Delta z = 500 \\text{ m}$\n$u = 25 \\text{ m s}^{-1}$，所以 $|u| = 25 \\text{ m s}^{-1}$。\n$v = 15 \\text{ m s}^{-1}$，所以 $|v| = 15 \\text{ m s}^{-1}$。\n$w = 0.50 \\text{ m s}^{-1}$，所以 $|w| = 0.50 \\text{ m s}^{-1}$。\n使用任务 B 中的公式，最大允许时间步长为：\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}} $$\n我们计算分母中的各项：\n$$ \\frac{|u|}{\\Delta x} = \\frac{25}{12000} \\text{ s}^{-1} = \\frac{1}{480} \\text{ s}^{-1} $$\n$$ \\frac{|v|}{\\Delta y} = \\frac{15}{15000} \\text{ s}^{-1} = \\frac{1}{1000} \\text{ s}^{-1} $$\n$$ \\frac{|w|}{\\Delta z} = \\frac{0.50}{500} \\text{ s}^{-1} = \\frac{1}{1000} \\text{ s}^{-1} $$\n总和是：\n$$ \\frac{1}{480} + \\frac{1}{1000} + \\frac{1}{1000} = \\frac{1}{480} + \\frac{2}{1000} = \\frac{1}{480} + \\frac{1}{500} = \\frac{500+480}{480 \\times 500} = \\frac{980}{240000} = \\frac{49}{12000} \\text{ s}^{-1} $$\n因此，最大时间步长为：\n$$ \\Delta t_{\\max} = \\frac{1}{49/12000} = \\frac{12000}{49} \\text{ s} \\approx 244.8979 \\text{ s} $$\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 244.9 \\text{ s}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 228.6  244.9 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论上的守恒方案在实际计算机代码中可能由于各种数值近似而产生微小的误差，导致“质量漂移”。本练习将理论与实践相结合，要求你设计并应用一种诊断工具来检验模型的质量守恒性。通过计算在一个时间步长内总质量的数值变化与已知的源汇项之差，你将能够量化这种数值漂移，并理解其作为评估模型保真度的重要指标。",
            "id": "4042959",
            "problem": "考虑一个使用有限体积法（FVM）进行输运和变换的全球大气示踪剂。设预报变量为示踪剂的质量密度 $q$，单位为 $\\mathrm{kg\\,m^{-3}}$，其受通量形式的守恒律 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S$ 控制，其中 $\\boldsymbol{F}$ 是 $q$ 的平流通量，$S$ 是单位体积的源项减去汇项，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。全球区域是封闭的（与外部边界没有交换）。模型将全球区域离散为 $N$ 个控制体积（网格单元）$V_i$，其体积为 $|V_i|$。将单个时间步开始和结束时的网格单元平均质量密度分别表示为 $\\bar{q}_i^{n}$ 和 $\\bar{q}_i^{n+1}$，并定义 $\\Delta \\bar{q}_i = \\bar{q}_i^{n+1} - \\bar{q}_i^{n}$。源项减去汇项通过每个网格单元的体积积分率来实现，使得 $\\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt$ 的单位为 $\\mathrm{kg}$，并表示该网格单元在该时间步内的经时间积分的净生成量。\n\n从通量形式的守恒律出发，使用控制体积积分，推导一个时间步内的全球质量收支，该收支将示踪剂总质量的变化与经时间积分和体积积分的源项进行比较。利用此结果构建一个时间步内的全球质量漂移诊断量 $\\Delta M$，对于封闭区域上的完全守恒离散格式，该诊断量应为零。然后，对于以下由五个网格单元组成的全球网格，使用所提供的数据计算 $\\Delta M$。将非零值解释为由通量不匹配或时间步进引起的数值不一致性。\n\n网格和数据如下：\n- $|V_1| = 9.5 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_2| = 1.3 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_3| = 8.0 \\times 10^{16}\\ \\mathrm{m^{3}}$, $|V_4| = 1.1 \\times 10^{17}\\ \\mathrm{m^{3}}$, $|V_5| = 9.0 \\times 10^{16}\\ \\mathrm{m^{3}}$。\n- $\\bar{q}_1^{n} = 7.50 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_1^{n+1} = 7.55 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_2^{n} = 6.80 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_2^{n+1} = 6.78 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_3^{n} = 8.10 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_3^{n+1} = 8.11 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_4^{n} = 7.20 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_4^{n+1} = 7.19 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$; $\\bar{q}_5^{n} = 6.90 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$, $\\bar{q}_5^{n+1} = 6.91 \\times 10^{-3}\\ \\mathrm{kg\\,m^{-3}}$。\n- $\\int_{t}^{t+\\Delta t} \\bar{S}_1 \\, dt = 2.50 \\times 10^{12}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_2 \\, dt = 1.00 \\times 10^{11}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_3 \\, dt = 5.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_4 \\, dt = 6.00 \\times 10^{10}\\ \\mathrm{kg}$, $\\int_{t}^{t+\\Delta t} \\bar{S}_5 \\, dt = 3.00 \\times 10^{10}\\ \\mathrm{kg}$。\n\n计算此时间步的诊断量 $\\Delta M$，并以 $\\mathrm{kg}$ 为单位表示您的最终答案。将您的答案四舍五入到三位有效数字。",
            "solution": "全球质量收支的推导始于示踪剂质量密度 $q$ 的控制方程，即通量形式的守恒律：\n$$\n\\frac{\\partial q}{\\partial t} + \\nabla \\cdot \\boldsymbol{F} = S\n$$\n此处，$q$ 的单位为 $\\mathrm{kg\\,m^{-3}}$，$\\boldsymbol{F}$ 是平流通量矢量，$S$ 是单位体积的源项减去汇项，单位为 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。\n\n对于有限体积法（FVM）离散格式，我们将此偏微分方程在一个任意的控制体积 $V_i$ 上进行积分：\n$$\n\\int_{V_i} \\frac{\\partial q}{\\partial t} \\, dV + \\int_{V_i} \\nabla \\cdot \\boldsymbol{F} \\, dV = \\int_{V_i} S \\, dV\n$$\n对第一项应用莱布尼茨积分法则（假设控制体积固定），对第二项应用散度定理，我们变换体积积分为：\n$$\n\\frac{d}{dt} \\int_{V_i} q \\, dV + \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\int_{V_i} S \\, dV\n$$\n其中 $\\partial V_i$ 是控制体积 $V_i$ 的边界面，$d\\boldsymbol{A}$ 是向外的法向面元。\n\n我们将网格单元 $i$ 中的总质量定义为 $M_i(t) = \\int_{V_i} q \\, dV$，将体积积分的源项率定义为 $\\mathcal{S}_i(t) = \\int_{V_i} S \\, dV$。单个网格单元的方程变为：\n$$\n\\frac{dM_i}{dt} + \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} = \\mathcal{S}_i(t)\n$$\n接下来，我们将此方程在一个从 $t = t^n$ 到 $t = t^{n+1}$ 的时间步上进行积分，时间步长为 $\\Delta t = t^{n+1} - t^n$：\n$$\n\\int_{t^n}^{t^{n+1}} \\frac{dM_i}{dt} \\, dt + \\int_{t^n}^{t^{n+1}} \\left( \\oint_{\\partial V_i} \\boldsymbol{F} \\cdot d\\boldsymbol{A} \\right) dt = \\int_{t^n}^{t^{n+1}} \\mathcal{S}_i(t) \\, dt\n$$\n第一项计算结果为网格单元 $i$ 在该时间步内的质量变化：$M_i(t^{n+1}) - M_i(t^n)$。我们将经时间积分的流出网格单元 $i$ 的净通量表示为 $\\mathcal{F}_{i, \\Delta t}$，将经时间积分的源项表示为 $\\mathcal{S}_{i, \\Delta t}$。方程为：\n$$\nM_i^{n+1} - M_i^n + \\mathcal{F}_{i, \\Delta t} = \\mathcal{S}_{i, \\Delta t}\n$$\n为了得到全球质量收支，我们将此方程对区域内所有 $N$ 个控制体积求和：\n$$\n\\sum_{i=1}^{N} (M_i^{n+1} - M_i^n) + \\sum_{i=1}^{N} \\mathcal{F}_{i, \\Delta t} = \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n第一项表示全球总质量的变化，$\\Delta M_{total} = M_{total}^{n+1} - M_{total}^n$。第二项是跨所有网格单元边界的全部时间积分通量之和。在有限体积离散格式中，对于任意两个相邻网格单元（例如 $j$ 和 $k$）共享的内部面，离开网格单元 $j$ 的通量与进入网格单元 $k$ 的通量大小相同，符号相反。因此，当在整个区域上求和时，所有内部通量完全抵消。总和简化为跨全球区域外部边界的总通量。由于问题声明全球区域是封闭的，这个外部通量为零。因此，对于一个完全守恒的数值方案，我们必须有：\n$$\n\\sum_{i=1}^{N} \\mathcal{F}_{i, \\Delta t} = 0\n$$\n因此，理想的全球质量收支为：\n$$\n\\Delta M_{total} = \\sum_{i=1}^{N} (M_i^{n+1} - M_i^n) = \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n此方程表明，示踪剂总质量的变化必须等于源项增加的总质量减去汇项移除的总质量。\n\n全球质量漂移的诊断量 $\\Delta M$ 可以通过比较数值计算出的总质量变化与总积分源项来构建。任何差异都源于输运方案中的数值误差（例如，界面处不一致的通量计算或非守恒的时间积分）。我们将 $\\Delta M$ 定义为差值：\n$$\n\\Delta M = \\left( \\sum_{i=1}^{N} M_i^{n+1} - \\sum_{i=1}^{N} M_i^n \\right) - \\sum_{i=1}^{N} \\mathcal{S}_{i, \\Delta t}\n$$\n使用所提供的网格单元平均密度 $\\bar{q}_i$ 和网格单元体积 $|V_i|$，网格单元 $i$ 中的质量近似为 $M_i = \\bar{q}_i |V_i|$。项 $\\mathcal{S}_{i, \\Delta t}$ 对应于给定的量 $\\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt$。因此，诊断量为：\n$$\n\\Delta M = \\sum_{i=1}^{N} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i| - \\sum_{i=1}^{N} \\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt\n$$\n我们现在为给定的 5 网格单元网格计算 $\\Delta M$。首先，我们计算总质量变化，$\\Delta M_{computed} = \\sum_{i=1}^{5} (\\bar{q}_i^{n+1} - \\bar{q}_i^{n}) |V_i|$：\n\\begin{itemize}\n    \\item 网格单元 1：$\\Delta M_1 = (7.55 \\times 10^{-3} - 7.50 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.5 \\times 10^{16} \\, \\mathrm{m^3}) = 4.75 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 2：$\\Delta M_2 = (6.78 \\times 10^{-3} - 6.80 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.3 \\times 10^{17} \\, \\mathrm{m^3}) = -2.6 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 3：$\\Delta M_3 = (8.11 \\times 10^{-3} - 8.10 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (8.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.8 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 4：$\\Delta M_4 = (7.19 \\times 10^{-3} - 7.20 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (1.1 \\times 10^{17} \\, \\mathrm{m^3}) = -1.1 \\times 10^{12} \\, \\mathrm{kg}$\n    \\item 网格单元 5：$\\Delta M_5 = (6.91 \\times 10^{-3} - 6.90 \\times 10^{-3}) \\, \\mathrm{kg\\,m^{-3}} \\times (9.0 \\times 10^{16} \\, \\mathrm{m^3}) = 0.9 \\times 10^{12} \\, \\mathrm{kg}$\n\\end{itemize}\n计算出的总质量变化为：\n$$\n\\Delta M_{computed} = (4.75 - 2.6 + 0.8 - 1.1 + 0.9) \\times 10^{12} \\, \\mathrm{kg} = 2.75 \\times 10^{12} \\, \\mathrm{kg}\n$$\n接下来，我们计算总积分源项，$\\mathcal{S}_{total} = \\sum_{i=1}^{5} \\int_{t}^{t+\\Delta t} \\bar{S}_i \\, dt$：\n$$\n\\mathcal{S}_{total} = (2.50 \\times 10^{12} + 1.00 \\times 10^{11} + 5.00 \\times 10^{10} + 6.00 \\times 10^{10} + 3.00 \\times 10^{10}) \\, \\mathrm{kg}\n$$\n$$\n\\mathcal{S}_{total} = (2.50 + 0.100 + 0.050 + 0.060 + 0.030) \\times 10^{12} \\, \\mathrm{kg} = 2.74 \\times 10^{12} \\, \\mathrm{kg}\n$$\n最后，全球质量漂移 $\\Delta M$ 是这两个量之差：\n$$\n\\Delta M = \\Delta M_{computed} - \\mathcal{S}_{total} = 2.75 \\times 10^{12} \\, \\mathrm{kg} - 2.74 \\times 10^{12} \\, \\mathrm{kg} = 0.01 \\times 10^{12} \\, \\mathrm{kg}\n$$\n$$\n\\Delta M = 1 \\times 10^{10} \\, \\mathrm{kg}\n$$\n问题要求答案四舍五入到三位有效数字。$\\Delta M$ 的非零值表明数值实现不是完全守恒的，导致在该时间步内产生了虚假的质量。\n\n$$\n\\Delta M = 1.00 \\times 10^{10} \\, \\mathrm{kg}\n$$",
            "answer": "$$\n\\boxed{1.00 \\times 10^{10}}\n$$"
        }
    ]
}