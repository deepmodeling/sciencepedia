{
    "hands_on_practices": [
        {
            "introduction": "To begin our exploration of numerical errors, we first analyze one of the simplest and most robust schemes for advection: the first-order upwind method. While the original partial differential equation contains only advection, its discrete approximation behaves differently. This practice uses Taylor series analysis to derive the *modified equation*, a powerful tool that reveals the continuous equation that the numerical scheme is *actually* solving. By performing this analysis, you will uncover the source of the scheme's well-known numerical diffusion, quantifying it as an effective diffusion coefficient, which is a critical first step in learning how to control such errors. ",
            "id": "4069602",
            "problem": "Consider the constant-coefficient linear advection equation, which is a standard building block for tracer transport in numerical weather prediction and climate modeling,\n$$\nu_{t} + c \\, u_{x} = 0,\n$$\nwith constant wave speed $c0$. On a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$, approximate $u(x,t)$ by $u_{i}^{n} \\approx u(x_{i}, t_{n})$ and advance in time with the explicit first-order upwind method (forward Euler in time and upwind in space for $c0$):\n$$\nu_{i}^{n+1} = u_{i}^{n} - C \\left(u_{i}^{n} - u_{i-1}^{n}\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number is $C = \\dfrac{c \\, \\Delta t}{\\Delta x}$. Assume $u$ is sufficiently smooth and that $C$ lies in the stable range $0  C \\leq 1$, as is typical for operational advection in atmospheric dynamical cores.\n\nUsing Taylor series about $(x_{i}, t_{n})$ and the governing partial differential equation to eliminate time derivatives in favor of spatial derivatives, derive the modified equation whose left-hand side matches the continuous advection operator and whose right-hand side captures the leading truncation effects up to and including terms of order $\\mathcal{O}(\\Delta x^{2})$. Write the modified equation in the canonical form\n$$\nu_{t} + c \\, u_{x} = \\nu_{\\text{eff}} \\, u_{xx} + \\text{higher-order terms},\n$$\nand identify the effective diffusion coefficient $\\nu_{\\text{eff}}$ as a function of $c$, $\\Delta x$, and $C$.\n\nProvide as your final answer only the closed-form analytical expression for $\\nu_{\\text{eff}}$. No rounding is required, and no units should be included in the final answer.",
            "solution": "The goal is to derive the modified equation, which is a continuous partial differential equation whose solution approximates the numerical solution of the discrete scheme to a specified order. We begin with the constant-coefficient linear advection equation\n$$\nu_{t} + c \\, u_{x} = 0, \\quad c0,\n$$\nand the first-order upwind scheme for $c0$,\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + c \\, \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = 0,\n$$\nwhich is algebraically equivalent to the update formula given.\n\nWe interpret $u_{i}^{n}$ as the exact solution sampled at $(x_{i}, t_{n})$ and expand the discrete operators in Taylor series about $(x_{i}, t_{n})$. For the forward time difference,\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2} \\, u_{tt} + \\frac{\\Delta t^{2}}{6} \\, u_{ttt} + \\mathcal{O}(\\Delta t^{3}).\n$$\nFor the backward spatial difference,\n$$\n\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2} \\, u_{xx} + \\frac{\\Delta x^{2}}{6} \\, u_{xxx} + \\mathcal{O}(\\Delta x^{3}).\n$$\nSubstituting these expansions into the discrete scheme yields\n$$\n\\left[u_{t} + \\frac{\\Delta t}{2} \\, u_{tt} + \\frac{\\Delta t^{2}}{6} \\, u_{ttt} + \\mathcal{O}(\\Delta t^{3})\\right]\n+ c \\left[u_{x} - \\frac{\\Delta x}{2} \\, u_{xx} + \\frac{\\Delta x^{2}}{6} \\, u_{xxx} + \\mathcal{O}(\\Delta x^{3})\\right] = 0.\n$$\nTo express the time derivatives in terms of spatial derivatives, we repeatedly differentiate the governing equation with respect to time and use commutation of partial derivatives. From $u_{t} + c \\, u_{x} = 0$ it follows that\n$$\nu_{t} = - c \\, u_{x}, \\quad\nu_{tt} = (u_{t})_{t} = - c \\, (u_{x})_{t} = - c \\, (u_{t})_{x} = - c \\, (- c \\, u_{x})_{x} = c^{2} \\, u_{xx},\n$$\nand similarly,\n$$\nu_{ttt} = (u_{tt})_{t} = \\left(c^{2} \\, u_{xx}\\right)_{t} = c^{2} \\, (u_{xx})_{t} = c^{2} \\, (u_{t})_{xx} = c^{2} \\, (- c \\, u_{x})_{xx} = - c^{3} \\, u_{xxx}.\n$$\nSubstituting these into the expanded scheme gives\n$$\nu_{t} + c \\, u_{x}\n+ \\left(\\frac{\\Delta t}{2} c^{2} - \\frac{c \\, \\Delta x}{2}\\right) u_{xx}\n+ \\left(- \\frac{\\Delta t^{2}}{6} c^{3} + \\frac{c \\, \\Delta x^{2}}{6}\\right) u_{xxx}\n+ \\text{higher-order terms} = 0.\n$$\nIntroduce the Courant–Friedrichs–Lewy (CFL) number $C = \\dfrac{c \\, \\Delta t}{\\Delta x}$ and note that $\\Delta t = \\dfrac{C \\, \\Delta x}{c}$ and $\\Delta t^{2} = \\dfrac{C^{2} \\, \\Delta x^{2}}{c^{2}}$. Then the coefficients simplify as\n$$\n\\frac{\\Delta t}{2} c^{2} - \\frac{c \\, \\Delta x}{2}\n= \\frac{c}{2} \\left(c \\, \\Delta t - \\Delta x\\right)\n= \\frac{c}{2} \\left(\\Delta x \\, C - \\Delta x\\right)\n= \\frac{c \\, \\Delta x}{2} (C - 1),\n$$\nand\n$$\n- \\frac{\\Delta t^{2}}{6} c^{3} + \\frac{c \\, \\Delta x^{2}}{6}\n= - \\frac{c}{6} \\left(\\frac{C^{2} \\, \\Delta x^{2}}{c^{2}}\\right) c^{2} + \\frac{c \\, \\Delta x^{2}}{6}\n= \\frac{c \\, \\Delta x^{2}}{6} (1 - C^{2}).\n$$\nTherefore, the modified equation, accurate through terms of order $\\mathcal{O}(\\Delta x^{2})$ when $C$ is treated as order $\\mathcal{O}(1)$, is\n$$\nu_{t} + c \\, u_{x}\n+ \\frac{c \\, \\Delta x}{2} (C - 1) \\, u_{xx}\n+ \\frac{c \\, \\Delta x^{2}}{6} (1 - C^{2}) \\, u_{xxx}\n= 0,\n$$\nwhich we can equivalently write as\n$$\nu_{t} + c \\, u_{x}\n= \\frac{c \\, \\Delta x}{2} (1 - C) \\, u_{xx}\n+ \\frac{c \\, \\Delta x^{2}}{6} (C^{2} - 1) \\, u_{xxx}\n+ \\text{higher-order terms}.\n$$\nComparing with the canonical form $u_{t} + c \\, u_{x} = \\nu_{\\text{eff}} \\, u_{xx} + \\text{higher-order terms}$, we identify the effective diffusion coefficient as\n$$\n\\nu_{\\text{eff}} = \\frac{c \\, \\Delta x}{2} (1 - C).\n$$\nFor $0  C \\leq 1$, this coefficient is nonnegative, reflecting the monotonicity-preserving, diffusive character of the first-order upwind scheme widely exploited to control spurious oscillations in tracer advection within atmospheric and oceanic models.",
            "answer": "$$\\boxed{\\frac{c\\,\\Delta x}{2}\\,(1-C)}$$"
        },
        {
            "introduction": "Having seen how numerical diffusion can arise, we now broaden our analysis to include numerical dispersion—errors in the phase speed of numerical waves. This practice employs Fourier analysis to compare the first-order upwind scheme with the second-order Lax-Wendroff scheme. By deriving and analyzing their respective amplification factors, you will quantitatively distinguish between the dissipative nature of the upwind scheme and the dispersive nature of the Lax-Wendroff scheme. This comparative analysis is fundamental to understanding the classic trade-off between numerical stability and accuracy in weather and climate models. ",
            "id": "4069593",
            "problem": "Consider one-dimensional passive tracer advection relevant to numerical weather prediction, governed by the linear advection equation $u_{t} + c\\,u_{x} = 0$ with constant wave speed $c  0$. Let the numerical grid have uniform spacing $\\Delta x$ and time step $\\Delta t$, and define the Courant-Friedrichs-Lewy (CFL) number $\\mu = c\\,\\Delta t / \\Delta x$. Two explicit finite-difference time-marching schemes are considered:\n\n1. The first-order upwind scheme: $u^{n+1}_{j} = u^{n}_{j} - \\mu \\left(u^{n}_{j} - u^{n}_{j-1}\\right)$.\n2. The Lax-Wendroff scheme: $u^{n+1}_{j} = u^{n}_{j} - \\frac{\\mu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\mu^{2}}{2}\\left(u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}\\right)$.\n\nPerform a Fourier or von Neumann analysis by inserting the discrete Fourier mode $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp\\!\\left(i j \\xi\\right)$, where $\\xi = k\\,\\Delta x$ is the nondimensional wavenumber in radians. Let $G(\\xi)$ denote the amplification factor so that $\\hat{u}^{\\,n+1} = G(\\xi)\\,\\hat{u}^{\\,n}$. For each scheme, obtain $G(\\xi)$ and then, for small $\\xi$, perform a Taylor expansion of $G(\\xi)$ in powers of $\\xi$ sufficient to separate dispersive and dissipative contributions by using the relation $G(\\xi) = \\exp\\!\\left(- i\\,\\omega(\\xi)\\,\\Delta t\\right)$, so that $\\omega(\\xi)\\,\\Delta t = i\\,\\ln G(\\xi)$.\n\nDefine the leading-order dispersive error coefficient for a scheme as the coefficient multiplying $\\xi^{3}$ in the real part of $\\omega(\\xi)\\,\\Delta t$. Using this definition, compute the ratio $R(\\mu)$ of the leading-order dispersive error coefficient of the upwind scheme to that of the Lax-Wendroff scheme, expressed as a closed-form function of $\\mu$. No rounding is required. Express your final answer as an analytic expression; do not include units in the final boxed expression. Angles are in radians.",
            "solution": "The user wants to find the ratio of the leading-order dispersive error coefficients for two finite-difference schemes used to solve the one-dimensional linear advection equation, $u_{t} + c\\,u_{x} = 0$. The coefficients are to be determined through a von Neumann stability analysis.\n\nThe analysis starts by substituting a single Fourier mode, $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp(i j \\xi)$, into the finite-difference scheme. Here, $j$ is the spatial index, $n$ is the temporal index, $\\xi = k\\,\\Delta x$ is the nondimensional wavenumber, and $\\hat{u}^{\\,n}$ is the amplitude of the mode at time step $n$. The amplification factor, $G(\\xi)$, is defined by the relation $\\hat{u}^{\\,n+1} = G(\\xi)\\,\\hat{u}^{\\,n}$.\n\nThe numerical frequency, $\\omega(\\xi)$, is related to the amplification factor by $G(\\xi) = \\exp(- i\\,\\omega(\\xi)\\,\\Delta t)$. This implies $\\omega(\\xi)\\,\\Delta t = i\\,\\ln G(\\xi)$. The exact solution to the advection equation has a dispersion relation $\\omega_{exact} = ck$, which gives $\\omega_{exact}\\,\\Delta t = ck\\,\\Delta t = (\\frac{\\xi}{\\Delta x}) c \\Delta t = \\mu\\xi$, where $\\mu = c\\Delta t/\\Delta x$ is the Courant number.\n\nThe dispersive error is the leading-order error term in the real part of the numerical frequency, $\\text{Re}(\\omega(\\xi)\\,\\Delta t)$, after subtracting the exact part, $\\mu\\xi$. As defined in the problem, the leading-order dispersive error coefficient is the coefficient of the $\\xi^{3}$ term in the Taylor expansion of $\\text{Re}(\\omega(\\xi)\\,\\Delta t)$.\n\n**1. First-Order Upwind Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = u^{n}_{j} - \\mu \\left(u^{n}_{j} - u^{n}_{j-1}\\right)$$\nSubstituting the Fourier mode $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp(i j \\xi)$:\n$$\\hat{u}^{\\,n+1} \\exp(i j \\xi) = \\hat{u}^{\\,n} \\exp(i j \\xi) - \\mu \\left(\\hat{u}^{\\,n} \\exp(i j \\xi) - \\hat{u}^{\\,n} \\exp(i (j-1) \\xi)\\right)$$\nDividing by $\\hat{u}^{\\,n}\\,\\exp(i j \\xi)$ gives the amplification factor $G_{up}(\\xi)$:\n$$G_{up}(\\xi) = 1 - \\mu \\left(1 - \\exp(-i\\xi)\\right) = 1 - \\mu + \\mu \\exp(-i\\xi)$$\nWe expand $G_{up}(\\xi)$ for small $\\xi$ using the Taylor series for $\\exp(-i\\xi) = 1 - i\\xi - \\frac{\\xi^2}{2} + i\\frac{\\xi^3}{6} + O(\\xi^4)$:\n$$G_{up}(\\xi) = 1 - \\mu + \\mu \\left(1 - i\\xi - \\frac{\\xi^2}{2} + i\\frac{\\xi^3}{6} + \\dots \\right)$$\n$$G_{up}(\\xi) = 1 - i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\nNow we compute $\\ln G_{up}(\\xi)$ using the Taylor series $\\ln(1+z) = z - \\frac{z^2}{2} + \\frac{z^3}{3} - \\dots$, where $z = G_{up}(\\xi) - 1$:\n$$z = -i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n$$z^2 = (-i\\mu\\xi)^2 + 2(-i\\mu\\xi)\\left(-\\frac{\\mu}{2}\\xi^2\\right) + \\dots = -\\mu^2\\xi^2 + i\\mu^2\\xi^3 + O(\\xi^4)$$\n$$z^3 = (-i\\mu\\xi)^3 + \\dots = i\\mu^3\\xi^3 + O(\\xi^4)$$\nSubstituting these into the series for $\\ln(1+z)$:\n$$\\ln G_{up}(\\xi) = \\left(-i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3\\right) - \\frac{1}{2}\\left(-\\mu^2\\xi^2 + i\\mu^2\\xi^3\\right) + \\frac{1}{3}\\left(i\\mu^3\\xi^3\\right) + O(\\xi^4)$$\n$$\\ln G_{up}(\\xi) = -i\\mu\\xi + \\left(-\\frac{\\mu}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 + i\\left(\\frac{\\mu}{6} - \\frac{\\mu^2}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\nThen, $\\omega_{up}(\\xi)\\,\\Delta t = i\\,\\ln G_{up}(\\xi)$:\n$$\\omega_{up}(\\xi)\\,\\Delta t = \\mu\\xi + i\\left(-\\frac{\\mu}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 - \\left(\\frac{\\mu}{6} - \\frac{\\mu^2}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\nThe real part is:\n$$\\text{Re}(\\omega_{up}(\\xi)\\,\\Delta t) = \\mu\\xi - \\left(\\frac{\\mu - 3\\mu^2 + 2\\mu^3}{6}\\right)\\xi^3 + O(\\xi^5)$$\nThe leading-order dispersive error coefficient, $C_{up}$, is the coefficient of $\\xi^3$:\n$$C_{up} = -\\frac{\\mu - 3\\mu^2 + 2\\mu^3}{6} = -\\frac{\\mu(1 - 3\\mu + 2\\mu^2)}{6} = -\\frac{\\mu(1-\\mu)(1-2\\mu)}{6}$$\n\n**2. Lax-Wendroff Scheme**\n\nThe scheme is given by:\n$$u^{n+1}_{j} = u^{n}_{j} - \\frac{\\mu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\mu^{2}}{2}\\left(u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}\\right)$$\nSubstituting the Fourier mode yields the amplification factor $G_{LW}(\\xi)$:\n$$G_{LW}(\\xi) = 1 - \\frac{\\mu}{2}\\left(\\exp(i\\xi) - \\exp(-i\\xi)\\right) + \\frac{\\mu^{2}}{2}\\left(\\exp(i\\xi) - 2 + \\exp(-i\\xi)\\right)$$\nUsing the identities $\\exp(i\\xi) - \\exp(-i\\xi) = 2i\\sin\\xi$ and $\\exp(i\\xi) + \\exp(-i\\xi) = 2\\cos\\xi$, this simplifies to:\n$$G_{LW}(\\xi) = 1 - i\\mu\\sin\\xi + \\mu^2(\\cos\\xi - 1)$$\nWe expand for small $\\xi$ using $\\sin\\xi = \\xi - \\frac{\\xi^3}{6} + O(\\xi^5)$ and $\\cos\\xi-1 = -\\frac{\\xi^2}{2} + \\frac{\\xi^4}{24} + O(\\xi^6)$:\n$$G_{LW}(\\xi) = 1 - i\\mu\\left(\\xi - \\frac{\\xi^3}{6} + \\dots\\right) + \\mu^2\\left(-\\frac{\\xi^2}{2} + \\dots\\right)$$\n$$G_{LW}(\\xi) = 1 - i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\nAs before, we compute $\\ln G_{LW}(\\xi)$ with $z = G_{LW}(\\xi) - 1$:\n$$z = -i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n$$z^2 = (-\\mu^2)\\xi^2 + i\\mu^3\\xi^3 + O(\\xi^4)$$\n$$z^3 = i\\mu^3\\xi^3 + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = \\left(-i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3\\right) - \\frac{1}{2}\\left(-\\mu^2\\xi^2 + i\\mu^3\\xi^3\\right) + \\frac{1}{3}\\left(i\\mu^3\\xi^3\\right) + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = -i\\mu\\xi + \\left(-\\frac{\\mu^2}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 + i\\left(\\frac{\\mu}{6} - \\frac{\\mu^3}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = -i\\mu\\xi + i\\left(\\frac{\\mu - 3\\mu^3 + 2\\mu^3}{6}\\right)\\xi^3 + O(\\xi^4) = -i\\mu\\xi + i\\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^4)$$\nThen, $\\omega_{LW}(\\xi)\\,\\Delta t = i\\,\\ln G_{LW}(\\xi)$:\n$$\\omega_{LW}(\\xi)\\,\\Delta t = \\mu\\xi - \\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^4)$$\nThe real part is:\n$$\\text{Re}(\\omega_{LW}(\\xi)\\,\\Delta t) = \\mu\\xi - \\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^5)$$\nThe leading-order dispersive error coefficient, $C_{LW}$, is the coefficient of $\\xi^3$:\n$$C_{LW} = -\\frac{\\mu(1-\\mu^2)}{6} = -\\frac{\\mu(1-\\mu)(1+\\mu)}{6}$$\n\n**3. Ratio of the Coefficients**\n\nThe ratio $R(\\mu)$ is given by $C_{up} / C_{LW}$:\n$$R(\\mu) = \\frac{C_{up}}{C_{LW}} = \\frac{-\\frac{\\mu(1-\\mu)(1-2\\mu)}{6}}{-\\frac{\\mu(1-\\mu)(1+\\mu)}{6}}$$\nFor $\\mu \\in (0, 1)$, we can cancel the common factors $\\mu$, $(1-\\mu)$, and the denominator $6$:\n$$R(\\mu) = \\frac{1-2\\mu}{1+\\mu}$$\nThis is the required closed-form function of $\\mu$.",
            "answer": "$$\\boxed{\\frac{1-2\\mu}{1+\\mu}}$$"
        },
        {
            "introduction": "Analysis of numerical errors is the first step; controlling them is the practical goal for model developers. This exercise moves from analysis to design, tasking you with creating a scale-selective filter to remove unwanted grid-scale noise—a common problem in numerical simulations. You will work with the Shapiro filter, a tool specifically designed to target and eliminate the shortest, unphysical waves ($2\\Delta x$ noise) while preserving the larger, dynamically important scales. By determining the minimum filter order that satisfies concrete design criteria, you will gain hands-on experience with the practical art of balancing numerical stability and physical fidelity. ",
            "id": "4069633",
            "problem": "Consider a one-dimensional, uniformly spaced, periodic grid with spacing $\\Delta x$ used in numerical weather prediction (NWP) and climate modeling, and a prognostic scalar field $q_i$ defined at grid points $x_i = i \\Delta x$. The field is contaminated by oscillations at the grid scale of $2 \\Delta x$ (the Nyquist wavenumber $k_{\\mathrm{N}} = \\pi/\\Delta x$), which must be suppressed without significantly affecting dynamically relevant longer waves.\n\nYou are tasked with designing a minimal sequence of Shapiro filter applications to reduce grid-scale noise while retaining high fidelity at a lower wavenumber. The Shapiro filter of even order $p$ is constructed from normalized, centered, even-order finite-difference operators so that, when applied once to a pure Fourier component $q_i = \\Re\\{\\hat{q}(k) \\exp(\\mathrm{i} k x_i)\\}$, its amplitude transfer function is\n$$\nH_p(k) = 1 - \\sin^{p}\\!\\left(\\frac{k \\Delta x}{2}\\right),\n$$\nwhere the normalization is chosen so that $\\sin^{p}(k \\Delta x/2) = 1$ at the Nyquist wavenumber $k_{\\mathrm{N}} = \\pi/\\Delta x$. This design guarantees complete removal of the $2 \\Delta x$ oscillation in a single application, while selectively attenuating shorter waves more than longer waves.\n\nSubject to this filter definition, determine the minimal even integer $p$ such that a single application (i.e., one filter pass) satisfies both of the following design goals:\n- Grid-scale suppression: the transfer function at $k = \\pi/\\Delta x$ yields zero amplitude, i.e., $H_p(\\pi/\\Delta x) = 0$.\n- Fidelity retention: the transfer function at $k = \\pi/(3 \\Delta x)$ preserves at least $99\\%$ of the amplitude, i.e., $H_p\\!\\left(\\frac{\\pi}{3\\Delta x}\\right) \\geq 0.99$.\n\nReport the minimal even integer $p$ that satisfies these constraints. The final answer must be a single integer with no units and no rounding instruction is needed.",
            "solution": "The problem requires finding the minimal even integer order $p$ for a Shapiro filter such that its application meets two specific design criteria. The amplitude transfer function for a Shapiro filter of order $p$ is given as:\n$$\nH_p(k) = 1 - \\sin^{p}\\!\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nwhere $k$ is the wavenumber and $\\Delta x$ is the grid spacing. The integer $p$ is specified to be even.\n\nThe two design constraints are:\n1.  Grid-scale suppression: $H_p(k) = 0$ at the Nyquist wavenumber $k = k_{\\mathrm{N}} = \\pi/\\Delta x$.\n2.  Fidelity retention: $H_p(k) \\geq 0.99$ at the wavenumber $k = \\pi/(3 \\Delta x)$.\n\nFirst, we validate the grid-scale suppression constraint. We substitute $k = \\pi/\\Delta x$ into the transfer function:\n$$\nH_p\\!\\left(\\frac{\\pi}{\\Delta x}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{(\\pi/\\Delta x) \\Delta x}{2}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{\\pi}{2}\\right)\n$$\nSince $\\sin(\\pi/2) = 1$, the expression becomes:\n$$\nH_p\\!\\left(\\frac{\\pi}{\\Delta x}\\right) = 1 - 1^p = 1 - 1 = 0\n$$\nThis condition is satisfied for any positive integer $p$, and therefore for any even integer $p$. This confirms that the filter, by its very definition, completely removes the $2 \\Delta x$ noise, and this constraint does not impose any further restriction on the value of $p$.\n\nNext, we analyze the fidelity retention constraint. We must have $H_p(k) \\geq 0.99$ for $k = \\pi/(3 \\Delta x)$. We substitute this wavenumber into the transfer function inequality:\n$$\nH_p\\!\\left(\\frac{\\pi}{3\\Delta x}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{(\\pi/(3\\Delta x)) \\Delta x}{2}\\right) \\geq 0.99\n$$\nSimplifying the argument of the sine function:\n$$\n\\frac{(\\pi/(3\\Delta x)) \\Delta x}{2} = \\frac{\\pi}{6}\n$$\nThe inequality becomes:\n$$\n1 - \\sin^{p}\\!\\left(\\frac{\\pi}{6}\\right) \\geq 0.99\n$$\nThe value of $\\sin(\\pi/6)$ is exactly $1/2$. Substituting this into the inequality gives:\n$$\n1 - \\left(\\frac{1}{2}\\right)^p \\geq 0.99\n$$\nWe now solve for $p$. Rearranging the inequality:\n$$\n1 - 0.99 \\geq \\left(\\frac{1}{2}\\right)^p\n$$\n$$\n0.01 \\geq \\left(\\frac{1}{2}\\right)^p\n$$\n$$\n\\frac{1}{100} \\geq \\frac{1}{2^p}\n$$\nSince both sides are positive, we can take the reciprocal of both sides, which reverses the inequality sign:\n$$\n100 \\leq 2^p\n$$\nTo find the smallest integer $p$ that satisfies this condition, we can take the base-$2$ logarithm of both sides:\n$$\n\\log_{2}(100) \\leq \\log_{2}(2^p)\n$$\n$$\n\\log_{2}(100) \\leq p\n$$\nWe can evaluate $\\log_{2}(100)$ by using the change of base formula, $\\log_b(x) = \\ln(x)/\\ln(b)$:\n$$\np \\geq \\frac{\\ln(100)}{\\ln(2)} = \\frac{\\ln(10^2)}{\\ln(2)} = \\frac{2 \\ln(10)}{\\ln(2)}\n$$\nUsing the approximate values $\\ln(10) \\approx 2.302585$ and $\\ln(2) \\approx 0.693147$, we get:\n$$\np \\geq \\frac{2 \\times 2.302585}{0.693147} \\approx \\frac{4.60517}{0.693147} \\approx 6.643856\n$$\nSo, $p$ must be an integer greater than or equal to $6.643856...$. The problem states that $p$ must be an even integer. The sequence of integers satisfying $p \\geq 6.643856...$ starts with $7, 8, 9, 10, \\dots$. The first even integer in this sequence is $8$.\n\nTo verify, let's test the even integers near this threshold:\n- If $p = 6$, then $2^6 = 64$. Since $64  100$, this value of $p$ is not sufficient.\n- If $p = 8$, then $2^8 = 256$. Since $256 \\geq 100$, this value of $p$ is sufficient.\n\nTherefore, the minimal even integer $p$ that satisfies both design constraints is $8$.",
            "answer": "$$\\boxed{8}$$"
        }
    ]
}