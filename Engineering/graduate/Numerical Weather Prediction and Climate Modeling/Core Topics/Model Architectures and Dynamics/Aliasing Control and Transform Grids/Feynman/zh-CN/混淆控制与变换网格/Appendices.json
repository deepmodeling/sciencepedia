{
    "hands_on_practices": [
        {
            "introduction": "要理解混叠效应，第一步是在一个可控的分析环境中观察它的发生。这项练习  提供了一个理想化的思想实验：当我们在一个分辨率不足的网格上计算一个简单的二次非线性项时，会发生什么？通过将离散网格计算得到的结果与精确的数学结果进行比较，我们可以精确地量化由混叠引入的误差，从而为选择变换网格建立基本直觉。",
            "id": "4011150",
            "problem": "考虑一个长度为 $2\\pi$ 的一维双周期域，该域用于数值天气预报和气候模拟中典型的谱变换模型。一个标量场 $u(x)$ 在总波数 $K$ 处进行三角截断的谱表示，非线性积在变换网格上计算，然后投影回谱空间。变换网格由 $N$ 个等距配置点 $x_{j} = \\frac{2\\pi j}{N}$ 组成，其中 $j = 0, 1, \\dots, N-1$。投影回波数空间的谱方法使用离散傅里叶变换 (DFT)，其正变换和逆变换定义如下\n$$\n\\hat{f}_{k} = \\frac{1}{N} \\sum_{j=0}^{N-1} f(x_{j}) \\exp(-\\mathrm{i} k x_{j}), \\quad f(x_{j}) = \\sum_{k=-\\frac{N}{2}}^{\\frac{N}{2}-1} \\hat{f}_{k} \\exp(\\mathrm{i} k x_{j}).\n$$\n假设截断波数为 $K = 10$，变换网格大小为 $N = 24$，因此 $K > \\frac{N}{3}$（对于二次积，配置点分辨率不足）。设解析场为单个保留的傅里叶模态\n$$\nu(x) = a \\cos(10 x),\n$$\n其中 $a \\in \\mathbb{R}$ 为实数振幅，并考虑二次积 $q(x) = u(x)^{2}$。乘积 $q(x)$ 在 $N$ 点网格上进行逐点计算，然后通过 DFT 投影回谱空间，最后截断至 $|k| \\le K$。将重构误差 $E$ 定义为 $q(x)$ 的投影-截断伪谱表示与 $q(x)$ 截断至 $|k| \\le K$ 的精确谱表示在物理空间中的均方差：\n$$\nE = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\left| q_{\\mathrm{ps}}(x) - q_{\\mathrm{ex}}(x) \\right|^{2} \\, dx,\n$$\n其中 $q_{\\mathrm{ps}}(x)$ 是通过在网格上计算 $u(x)^{2}$、通过 DFT 变换到谱空间并截断至 $|k| \\le K$ 得到的；而 $q_{\\mathrm{ex}}(x)$ 是通过对 $u(x)^{2}$ 进行连续谱卷积，然后截断至 $|k| \\le K$ 得到的。计算 $E$ 并将其表示为关于 $a$ 的闭式解析表达式，并解释在给定的 ($K$, $N$) 配置下，所得误差与二次相互作用的混叠有何关系。将你的最终答案表示为精确的解析表达式。无需四舍五入，也无需物理单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n#### 步骤1：提取给定条件\n-   域：一维、双周期，长度 $2\\pi$。\n-   场表示：在总波数 $K$ 处进行三角截断的谱变换模型。\n-   截断波数：$K = 10$。\n-   变换网格：$N$ 个等距配置点 $x_{j} = \\frac{2\\pi j}{N}$，其中 $j = 0, 1, \\dots, N-1$。\n-   网格大小：$N = 24$。\n-   约束条件：注意到 $K > \\frac{N}{3}$（具体为 $10 > \\frac{24}{3} = 8$）。\n-   正 DFT: $\\hat{f}_{k} = \\frac{1}{N} \\sum_{j=0}^{N-1} f(x_{j}) \\exp(-\\mathrm{i} k x_{j})$。\n-   逆 DFT: $f(x_{j}) = \\sum_{k=-\\frac{N}{2}}^{\\frac{N}{2}-1} \\hat{f}_{k} \\exp(\\mathrm{i} k x_{j})$。\n-   解析场：$u(x) = a \\cos(10 x)$，其中 $a \\in \\mathbb{R}$ 为实数振幅。\n-   非线性积：$q(x) = u(x)^{2}$。\n-   伪谱积 $q_{\\mathrm{ps}}(x)$：通过在网格上计算 $u(x)^{2}$、通过 DFT 变换并截断至 $|k| \\le K$ 得到。\n-   精确截断积 $q_{\\mathrm{ex}}(x)$：通过对 $u(x)^{2}$ 进行连续谱卷积并截断至 $|k| \\le K$ 得到。\n-   重构误差定义：$E = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\left| q_{\\mathrm{ps}}(x) - q_{\\mathrm{ex}}(x) \\right|^{2} \\, dx$。\n\n#### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，是适定的、客观的。\n1.  **科学性或事实性**：该问题是谱方法理论中的一个标准练习，谱方法是流体动力学和气候模拟数值分析的核心课题。混叠、谱截断和变换网格等概念是基础性的，并且表述正确。\n2.  **可形式化性与相关性**：该问题可以使用傅里叶分析和离散傅里叶变换理论直接、严谨地形式化。它与数值天气预报中混叠控制这一特定主题高度相关。\n3.  **完备性与一致性**：该问题是自洽的。所有必要的参数（$K$、$N$）、定义（DFT、误差 $E$）以及场 $u(x)$ 的函数形式都已给出。没有矛盾之处。条件 $K > N/3$ 是有意设置的，以确保发生混叠并污染解析谱，这是本练习的核心要点。\n4.  **现实性与可行性**：该设置是谱模型中如何处理非线性项的一个简化但概念上准确的表示。选择 $K$ 和 $N$ 的值是为了说明一种特定的数值伪影，这是一种标准的教学方法。\n5.  **适定性**：该问题是适定的，能够得到关于误差 $E$ 作为振幅 $a$ 的函数的唯一、稳定且有意义的解。\n6.  **平凡性/同义反复**：该问题并非微不足道；它需要逐步应用傅里叶分析，并理解伪谱方法中的混叠现象。\n\n#### 步骤3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n目标是计算重构误差 $E$，这需要求出精确截断积 $q_{\\mathrm{ex}}(x)$ 和伪谱积 $q_{\\mathrm{ps}}(x)$。\n\n**1. 确定精确截断积 $q_{\\mathrm{ex}}(x)$**\n\n标量场为 $u(x) = a \\cos(10x)$。精确的二次积为 $q(x) = u(x)^2$。\n使用三角恒等式 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$，我们得到：\n$$\nq(x) = (a \\cos(10x))^2 = a^2 \\cos^2(10x) = a^2 \\left( \\frac{1 + \\cos(20x)}{2} \\right) = \\frac{a^2}{2} + \\frac{a^2}{2} \\cos(20x).\n$$\n为了用其谱分量（连续傅里叶级数）表示，我们使用 $\\cos(\\theta) = \\frac{1}{2}(\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta))$：\n$$\nq(x) = \\frac{a^2}{2} + \\frac{a^2}{4} (\\exp(\\mathrm{i}20x) + \\exp(-\\mathrm{i}20x)).\n$$\n精确积 $q(x)$ 的谱表示在波数 $k=0$、$k=20$ 和 $k=-20$ 处有非零系数。\n函数 $q_{\\mathrm{ex}}(x)$ 定义为精确积 $q(x)$ 在谱空间中截断至 $|k| \\le K$。给定截断波数 $K=10$，我们必须丢弃所有 $|k|>10$ 的分量。因此，$k=\\pm 20$ 处的分量被移除。唯一剩下的分量是 $k=0$ 处的分量。\n因此，精确截断积为：\n$$\nq_{\\mathrm{ex}}(x) = \\frac{a^2}{2}.\n$$\n\n**2. 确定伪谱积 $q_{\\mathrm{ps}}(x)$**\n\n伪谱法在网格点 $x_j = \\frac{2\\pi j}{N}$（其中 $N=24$）上计算乘积 $q(x)=u(x)^2$。网格上的函数值为：\n$$\nq(x_j) = \\frac{a^2}{2} + \\frac{a^2}{2} \\cos(20x_j) = \\frac{a^2}{2} + \\frac{a^2}{2} \\cos\\left(20 \\frac{2\\pi j}{24}\\right).\n$$\n在 $N$ 个点的离散网格上，波数 $k$ 与任何波数 $k' = k + mN$（其中 $m$ 为任意整数）是无法区分的。这种现象称为混叠。在大小为 $N=24$ 的网格上进行 DFT 的主波数范围是 $k \\in [-12, 11]$。来自 $\\cos(20x)$ 项的波数 $k=20$ 超出此范围。它会混叠到此范围内的某个波数 $k'$。我们通过选择 $m=-1$ 来找到 $k'$：\n$$\nk' = 20 + (-1) \\times 24 = -4.\n$$\n因此，在网格上，分量 $\\cos(20x_j)$ 混叠为 $\\cos(-4x_j) = \\cos(4x_j)$。我们可以验证这一点：\n$$\n\\cos\\left(20 \\frac{2\\pi j}{24}\\right) = \\cos\\left((24-4) \\frac{2\\pi j}{24}\\right) = \\cos\\left(2\\pi j - 4 \\frac{2\\pi j}{24}\\right) = \\cos\\left(-4 \\frac{2\\pi j}{24}\\right) = \\cos(4x_j).\n$$\n所以，在网格上计算的函数实际上是：\n$$\nq(x_j) = \\frac{a^2}{2} + \\frac{a^2}{2} \\cos(4x_j).\n$$\n接下来，我们对 $q(x_j)$ 执行 DFT 以获得谱系数 $\\hat{q}_k$。根据离散傅里叶基的正交性和线性，系数为：\n-   对于常数项 $\\frac{a^2}{2}$，唯一的非零系数在 $k=0$ 处：$\\hat{q}_0 = \\frac{a^2}{2}$。\n-   对于项 $\\frac{a^2}{2} \\cos(4x_j) = \\frac{a^2}{4}(\\exp(\\mathrm{i}4x_j) + \\exp(-\\mathrm{i}4x_j))$，非零系数在 $k=4$ 和 $k=-4$ 处：$\\hat{q}_4 = \\frac{a^2}{4}$ 和 $\\hat{q}_{-4} = \\frac{a^2}{4}$。\n\n因此，网格点乘积的谱系数为 $\\hat{q}_0 = \\frac{a^2}{2}$，$\\hat{q}_4 = \\frac{a^2}{4}$，$\\hat{q}_{-4} = \\frac{a^2}{4}$，对于所有其他 $k$，$\\hat{q}_k=0$。\n函数 $q_{\\mathrm{ps}}(x)$ 是通过取这些系数，截断至 $|k| \\le K=10$，然后重构一个连续函数而形成的。由于非零系数位于 $k=0, \\pm 4$，所有这些都在截断带 $|k| \\le 10$ 内，因此没有系数被截断移除。\n重构的函数 $q_{\\mathrm{ps}}(x)$ 是：\n$$\nq_{\\mathrm{ps}}(x) = \\sum_{k=-10}^{10} \\hat{q}_k \\exp(\\mathrm{i}kx) = \\hat{q}_0 + \\hat{q}_4 \\exp(\\mathrm{i}4x) + \\hat{q}_{-4} \\exp(-\\mathrm{i}4x)\n$$\n$$\nq_{\\mathrm{ps}}(x) = \\frac{a^2}{2} + \\frac{a^2}{4} \\exp(\\mathrm{i}4x) + \\frac{a^2}{4} \\exp(-\\mathrm{i}4x) = \\frac{a^2}{2} + \\frac{a^2}{2} \\cos(4x).\n$$\n\n**3. 计算重构误差 $E$**\n\n误差 $E$ 是 $q_{\\mathrm{ps}}(x)$ 和 $q_{\\mathrm{ex}}(x)$ 之间的均方差：\n$$\nE = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\left| q_{\\mathrm{ps}}(x) - q_{\\mathrm{ex}}(x) \\right|^{2} \\, dx.\n$$\n差值为：\n$$\nq_{\\mathrm{ps}}(x) - q_{\\mathrm{ex}}(x) = \\left(\\frac{a^2}{2} + \\frac{a^2}{2} \\cos(4x)\\right) - \\frac{a^2}{2} = \\frac{a^2}{2} \\cos(4x).\n$$\n将此代入误差积分中：\n$$\nE = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\left| \\frac{a^2}{2} \\cos(4x) \\right|^{2} \\, dx = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\frac{a^4}{4} \\cos^2(4x) \\, dx = \\frac{a^4}{8\\pi} \\int_{0}^{2\\pi} \\cos^2(4x) \\, dx.\n$$\n对于任何非零整数 $k$，$\\cos^2(kx)$ 在一个 $2\\pi$ 周期上的积分是 $\\pi$。我们可以用 $\\cos^2(4x) = \\frac{1}{2}(1 + \\cos(8x))$ 来证明这一点：\n$$\n\\int_{0}^{2\\pi} \\cos^2(4x) \\, dx = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(8x)) \\, dx = \\left[ \\frac{x}{2} + \\frac{\\sin(8x)}{16} \\right]_{0}^{2\\pi} = \\left(\\frac{2\\pi}{2} + 0\\right) - (0+0) = \\pi.\n$$\n因此，误差 $E$ 为：\n$$\nE = \\frac{a^4}{8\\pi} (\\pi) = \\frac{a^4}{8}.\n$$\n\n**混叠现象解释**\n误差直接源于混叠。精确的二次积 $u(x)^2$ 产生了一个高波数分量 $\\cos(20x)$。具有 $N=24$ 个点的网格，其奈奎斯特波数值为 $N/2 = 12$。由于乘积的波数 $k=20$ 大于奈奎斯特波数 $k_{Nyquist}=12$，网格采样无法正确表示此分量。离散采样过程将 $\\cos(20x)$ 波错误地解释为一个低波数波 $\\cos(4x)$，因为 $20$ 混叠成了 $20-24=-4$。由此产生的虚假分量 $\\frac{a^2}{2}\\cos(4x)$ 的波数 $|k|=4$ 位于解析谱范围（$|k| \\le K=10$）内。因此，这个混叠项污染了谱截断的伪谱积 $q_{\\mathrm{ps}}(x)$。而精确的截断计算 $q_{\\mathrm{ex}}(x)$ 正确地丢弃了 $k=\\pm 20$ 的分量。误差 $E$ 正是污染了最终结果的混叠虚假分量的均方值。给定的条件 $K > N/3$（$10 > 8$）正确地预测了这种污染性混叠，因为避免二次积混叠的标准条件是 $N \\ge 3K+1$。",
            "answer": "$$\\boxed{\\frac{a^{4}}{8}}$$"
        },
        {
            "introduction": "在第一个练习的基础上，我们现在来深入研究混叠污染谱空间的具体机制。非线性相互作用通过现有波数的和与差来创造新的波数。此问题  模拟了两个高频波相互作用的场景，挑战在于要求我们精确预测，本应属于更高、不可分辨波数的能量，会错误地污染哪一个“错误”的（即混叠的）波数。这是诊断数值模拟中误差来源的一项核心技能。",
            "id": "3423339",
            "problem": "考虑一个在 $[0,2\\pi)$ 上的 $2\\pi$ 周期函数，使用 $N$ 个等距格点 $x_j = 2\\pi j/N$ 对其进行标准伪谱离散化，其中 $N$ 是一个偶数。在此网格上的离散傅里叶变换 (DFT) 表示傅里叶模态，其整数波数指数位于主集 $\\{-\\frac{N}{2}+1,\\ldots,-1,0,1,\\ldots,\\frac{N}{2}\\}$ 中，并且谱空间中的卷积使指数以 $N$ 为模进行环绕。设 $u(x)=\\sin(kx)$ 和 $v(x)=\\sin(\\ell x)$，其中 $k=\\frac{N}{2}-1$ 且 $\\ell=\\frac{N}{2}-2$。逐点乘积 $w(x)=u(x)v(x)$ 在物理网格上计算，然后变换回谱空间。\n\n从基本原理出发：\n- 三角函数的积化和差恒等式。\n- 将傅里叶乘法解释为模态系数的卷积。\n- DFT 卷积以 $N$ 为模的环绕效应，这会导致混叠现象，使波数进入主指数集。\n\n在二次项混叠控制的背景下回答以下问题。\n1) 如果乘积 $w(x)$ 在原始的 $N$ 点网格上计算，且没有任何补零，请确定在 $w(x)$ 中，与高频和频谐波对应的主集内的混叠波数指数。\n2) 如果改用“三分之二”去混叠规则（即，在谱空间中补零以扩展到大小为 $P=\\frac{3N}{2}$ 的网格，变换到物理空间，在 $P$ 点网格上计算乘积，再变换回来，然后截断到原始的 $N$ 模态带），请确定在截断之前和频谐波的未混叠高频波数指数（即，整数波数线上的真实和频谐波指数）。\n\n将你的最终答案表示为一个包含两个元素的行矩阵 $\\big(m_{\\text{alias}},\\,m_{\\text{true}}\\big)$，其中 $m_{\\text{alias}}$ 是在第 (1) 部分中找到的混叠指数，$m_{\\text{true}}$ 是在第 (2) 部分中找到的真实高频和频谐波指数。无需四舍五入。不要包含单位。",
            "solution": "该问题要求我们在伪谱方法的背景下分析混叠现象。给定两个正弦函数 $u(x)$ 和 $v(x)$，我们需要在两种不同的计算场景下，确定它们乘积 $w(x)=u(x)v(x)$ 中和频谐波的波数。\n\n函数由 $u(x) = \\sin(kx)$ 和 $v(x) = \\sin(\\ell x)$ 给出，其整数波数为 $k=\\frac{N}{2}-1$ 和 $\\ell=\\frac{N}{2}-2$。这里，$N$ 是区间 $[0, 2\\pi)$ 上等距格点的数量，是一个偶数。\n\n首先，我们使用三角函数的积化和差恒等式来确定乘积 $w(x)$ 的解析形式：\n$$ \\sin(A)\\sin(B) = \\frac{1}{2}\\left[\\cos(A-B) - \\cos(A+B)\\right] $$\n将此恒等式应用于 $w(x)=u(x)v(x)$，我们得到：\n$$ w(x) = \\sin(kx)\\sin(\\ell x) = \\frac{1}{2}\\left[\\cos((k-\\ell)x) - \\cos((k+\\ell)x)\\right] $$\n这表明乘积 $w(x)$ 是两个余弦波的叠加。这些分量的波数是差频谐波 $m_{\\text{diff}} = k-\\ell$ 和和频谐波 $m_{\\text{sum}} = k+\\ell$。\n\n代入 $k$ 和 $\\ell$ 的给定值：\n$$ m_{\\text{diff}} = k-\\ell = \\left(\\frac{N}{2}-1\\right) - \\left(\\frac{N}{2}-2\\right) = 1 $$\n$$ m_{\\text{sum}} = k+\\ell = \\left(\\frac{N}{2}-1\\right) + \\left(\\frac{N}{2}-2\\right) = N-3 $$\n所以，精确的解析乘积是 $w(x) = \\frac{1}{2}\\left[\\cos(x) - \\cos((N-3)x)\\right]$。高频和频谐波对应于项 $\\cos((N-3)x)$，它由波数为 $\\pm(N-3)$ 的复指数组成。\n\n**第 1 部分：$N$ 点网格上的混叠波数**\n\n一个 $N$ 点网格上的伪谱方法只能无歧义地表示有限的一组波数。问题将此集合，即主集，指定为 $\\{-\\frac{N}{2}+1, \\ldots, \\frac{N}{2}\\}$。任何在此集合之外的波数 $m$ 都会混叠到集合内的一个波数 $m_{\\text{alias}}$，其中 $m_{\\text{alias}}$ 与 $m$ 模 $N$ 同余。也就是说，$m_{\\text{alias}} = m + qN$，对于某个整数 $q$ 使得 $m_{\\text{alias}}$ 位于主集中。\n\n高频和频谐波的真实波数为 $m = N-3$。我们需要在主集中找到它的混叠波数。我们正在寻找一个整数 $q$ 使得 $-\\frac{N}{2}+1 \\le (N-3) + qN \\le \\frac{N}{2}$。\n选择 $q=-1$，我们得到：\n$$ m_{\\text{alias}} = (N-3) - N = -3 $$\n我们必须验证这个混叠波数位于主集 $\\{-\\frac{N}{2}+1, \\ldots, \\frac{N}{2}\\}$ 内。条件是 $-\\frac{N}{2}+1 \\le -3$。这可以化简为 $4 \\le \\frac{N}{2}$，或 $N \\ge 8$。该问题是为一般的偶数 $N$ 提出的，并且波数 $k$ 和 $\\ell$ 被选择得接近奈奎斯特频率 $\\frac{N}{2}$，这是混叠成为主要问题的典型场景。对于较小的 $N$（例如 $N=4$ 或 $N=6$），和频谐波 $N-3$ 可能落在主集内，这意味着该特定分量不会发生混叠。然而，由混叠控制规则的上下文所暗示的一般情况是，对于足够大的 $N$，和频谐波会落在可表示范围之外。因此，假设 $N \\ge 8$，由和频谐波 $k+\\ell=N-3$ 产生的混叠波数是 $m_{\\text{alias}} = -3$。\n\n**第 2 部分：使用“三分之二”规则的未混叠波数**\n\n问题的第二部分要求和频谐波的未混叠的真实波数。提供的背景是“三分之二”去混叠规则，这是一个旨在无混叠地计算非线性乘积的程序。该程序包括用零填充函数的谱表示以提高分辨率，在更精细的物理网格（$P=\\frac{3N}{2}$ 点）上执行乘积，然后进行逆变换。\n\n问题是：“确定在截断之前和频谐波的未混叠高频波数指数（即，整数波数线上的真实和频谐波指数）”。这个问题的括号部分明确定义了所求的量：它是在考虑任何离散网格效应（如混叠）之前，存在于解析乘积中的和频谐波分量的真实波数。这种去混叠程序是人们试图数值计算这个真实值时会使用的工具。该问题问的是此计算的理论目标。\n\n根据积化和差恒等式确定，真实的和频谐波是 $m_{\\text{sum}} = k+\\ell$。\n$$ m_{\\text{true}} = k+\\ell = \\left(\\frac{N}{2}-1\\right) + \\left(\\frac{N}{2}-2\\right) = N-3 $$\n这是精确解中高频分量的波数。去混叠规则的目的是精确地捕捉这个分量。虽然对于给定的特定高波数，如果 $N \\ge 12$（因为真实波数 $N-3$ 会超过补零网格的奈奎斯特极限 $P/2 = 3N/4$），$P=\\frac{3N}{2}$ 网格可能不足以防止混叠，但问题要求的是这个程序*意图*找到的值，也就是真实的解析波数。\n\n因此，真实的高频和频谐波指数是 $m_{\\text{true}} = N-3$。\n\n**结果总结**\n在 $N$ 点网格上的混叠波数指数是 $m_{\\text{alias}} = -3$。\n真实的高频和频谐波指数是 $m_{\\text{true}} = N-3$。\n\n最终答案要求以行矩阵 $\\begin{pmatrix} m_{\\text{alias}}  m_{\\text{true}} \\end{pmatrix}$ 的形式给出。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -3 & N-3 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在分析性地理解了混叠之后，最后一步是在实际的计算环境中解决它。这需要实施一种去混叠方案，例如广泛使用的“2/3规则”。这个编程练习  将指导你构建一个数值实验，你将分别计算带有和不带有去混叠的非线性项，并直接测量2/3规则成功消除的虚假能量。这项实践将理论知识与数值模型代码中的实际应用联系起来。",
            "id": "4011188",
            "problem": "构建一个完整、可运行的程序，该程序实现一个数值实验，以演示在一维周期性变换网格上二次非线性项中三波相互作用的混叠效应，并展示应用三分之二截断规则如何改变能量转移。该实验必须在一个周期性域上使用包含偶数个点 $N$ 的离散傅里叶变换 (DFT) 网格，并且必须从谱变换、卷积和采样的基本原理出发。\n\n从以下基本事实和定义开始：\n- 在一个包含 $N$ 个点的周期性网格上，离散傅里叶变换 (DFT) 支持整数傅里叶模式 $k$（满足 $|k| \\leq k_{\\max}$），其中对于偶数 $N$，奈奎斯特波数为 $k_{\\max} = N/2$。\n- 快速傅里叶变换 (FFT) 和快速傅里叶逆变换 (IFFT) 高效地实现了 DFT。在标准实践中，IFFT 包含一个因子 $1/N$。\n- 对于周期性网格上的一个实标量场 $u(x)$，像 $q(x) = u(x)^2$ 这样的二次非线性项会产生谱空间的三波相互作用：其傅里叶谱 $\\widehat{q}(k)$ 是 $\\widehat{u}(k)$ 与自身的离散卷积，生成波数和与波数差的分量，包括 $k = k_1 + k_2$ 和 $k = k_1 - k_2$。\n- 在一个截断的离散谱中，任何产生波数 $k$（满足 $|k| > k_{\\max}$）的相互作用都会通过模缠绕被混叠回可表示的范围内，这会污染较低的波数。对于和满足 $k_1 + k_2 \\leq N$ 的情况，当 $k_1 + k_2 > k_{\\max}$ 时，混叠后的波数大小可以表示为 $k_{\\text{alias}} = |(k_1 + k_2) - N|$，当 $k_1 + k_2 \\leq k_{\\max}$ 时，则为 $k_{\\text{alias}} = k_1 + k_2$。\n- 对于二次非线性项，三分之二截断规则（也称为 Orszag $2/3$ 规则）通过在物理空间中形成乘积前，将截止波数 $K_c \\approx (2/3)k_{\\max}$ 以上的傅里叶模式置零，然后在非线性操作后再次进行截断来消除混叠误差。为严格避免边界问题，请使用 $K_c = \\lfloor (2/3)k_{\\max} \\rfloor - 1$。\n\n程序规范：\n1. 使用一个包含 $N$ 个点的一维周期性网格。构建一个实值初始场 $u(x)$，该场由两个余弦傅里叶模式之和组成，它们的波数分别为 $k_1$ 和 $k_2$，振幅分别为 $A_1$ 和 $A_2$。通过显式构造傅里叶系数 $\\widehat{u}(k)$ 来实现 $u(x)$，使得逆变换在网格索引 $j$ 处得到 $u(x) = A_1 \\cos(2\\pi k_1 j/N) + A_2 \\cos(2\\pi k_2 j/N)$。\n2. 在物理空间中逐点计算 $q(x) = u(x)^2$，并使用 FFT 变换到谱空间 $\\widehat{q}(k)$ 以获得未去混叠的结果。令 $E_{\\text{naive}}$ 为在混叠波数大小 $k_{\\text{alias}}$ 处与三波和相关的谱能量，其定义为 $\\widehat{q}(k)$ 在对应于 $k_{\\text{alias}}$ 的正负索引处的模平方之和（对于 $k_{\\text{alias}} \\neq 0$），如果 $k_{\\text{alias}} = 0$，则为零索引处的模平方。\n3. 应用三分之二截断规则，在计算 $q(x)$ 之前将 $u$ 的所有满足 $|k| > K_c$ 的傅里叶系数置零，然后计算 $q(x) = u(x)^2$，变换到 $\\widehat{q}(k)$，并通过将 $\\widehat{q}(k)$ 中所有高于 $K_c$ 的模式置零来再次应用截断。令 $E_{2/3}$ 为去混叠谱在 $k_{\\text{alias}}$ 处的能量，其定义如步骤 2 所述。\n4. 对于每个测试用例，返回数对 $\\left[E_{\\text{naive}}, E_{2/3}\\right]$。\n\n您的程序必须硬编码并评估以下测试套件，该套件探讨了不同的方面，包括一个一般情况、一个边界情况和一个无混叠情况：\n- 测试用例 1：$N = 96$, $k_1 = 40$, $k_2 = 20$, $A_1 = 1.0$, $A_2 = 1.0$。\n- 测试用例 2：$N = 96$, $k_1 = 32$, $k_2 = 32$, $A_1 = 0.8$, $A_2 = 0.8$。\n- 测试用例 3：$N = 96$, $k_1 = 10$, $k_2 = 12$, $A_1 = 1.2$, $A_2 = 0.7$。\n- 测试用例 4：$N = 128$, $k_1 = 41$, $k_2 = 41$, $A_1 = 0.9$, $A_2 = 0.9$。\n\n最终输出要求：\n- 您的程序应产生单行输出，其中包含用方括号括起来的结果，格式为逗号分隔的数对列表，且不含空格。例如：$[[e_{1,\\text{naive}},e_{1,2/3}],[e_{2,\\text{naive}},e_{2,2/3}],\\dots]$。每个 $e$ 都必须是浮点数。\n\n所有量都是无量纲的；不要附加任何物理单位或角度单位。每个测试用例的答案必须是数值浮点数。程序必须完全自包含，不需要任何输入。",
            "solution": "问题陈述在科学上是合理的、适定的，并为数值实验提供了完整的规范。这是对非线性系统中谱方法混叠现象本质以及应用三分之二截断规则进行去混叠的有效探究。因此，我们可以着手解决。\n\n这个问题的核心在于理解离散傅里叶变换如何表示非线性相互作用，以及在可分辨范围 $|k| \\leq k_{\\max}$ 之外的波数如何被错误地表示为不同的、更低的波数——这种现象被称为混叠。我们将使用指定的数值实验来演示这种污染及其消除方法。\n\n**1. 理论基础**\n\n周期域上的一个实值函数 $u(x)$ 可以用傅里叶级数表示。在一个包含 $N$ 个点 $x_j=j\\Delta x$（$j=0, 1, \\dots, N-1$）的离散网格上，这变成了离散傅里叶变换 (DFT)。一个由余弦波组成的实函数 $u(x_j)$ 定义为：\n$$\nu(x_j) = A_1 \\cos\\left(\\frac{2\\pi k_1 j}{N}\\right) + A_2 \\cos\\left(\\frac{2\\pi k_2 j}{N}\\right)\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta})$，我们可以用复指数来表示 $u(x_j)$，复指数构成了 DFT 的基础。标准的正向和反向 DFT 对（如 `numpy` 中实现的）是：\n$$\n\\widehat{u}(k) = \\sum_{j=0}^{N-1} u(x_j) e^{-i 2\\pi kj/N} \\quad \\text{(FFT)}\n$$\n$$\nu(x_j) = \\frac{1}{N} \\sum_{k=0}^{N-1} \\widehat{u}(k) e^{i 2\\pi kj/N} \\quad \\text{(IFFT)}\n$$\n为了从其谱系数构造指定的 $u(x_j)$，我们必须设置系数 $\\widehat{u}(k)$，使得 IFFT 能够产生所需的函数。对于单个项 $A \\cos(2\\pi k_0 j/N)$，相应的非零谱系数是 $\\widehat{u}(k_0) = A N/2$ 和 $\\widehat{u}(-k_0) = A N/2$。在离散索引范围 $0, \\dots, N-1$ 中，波数 $-k_0$ 的系数存储在索引 $N-k_0$ 处。\n\n物理空间中的二次非线性项 $q(x) = u(x)^2$ 对应于傅里叶空间中谱与自身的卷积：\n$$\n\\widehat{q}(k) = (\\widehat{u} * \\widehat{u})(k) = \\sum_{k'=0}^{N-1} \\widehat{u}(k') \\widehat{u}(k-k')\n$$\n这个卷积在波数和与波数差处生成新的模式。对于一个具有模式 $k_1$ 和 $k_2$ 的初始场，乘积 $u(x)^2$ 将在 $2k_1$、$2k_2$、$k_1+k_2$ 和 $k_1-k_2$（以及它们的负值）处生成模式，并同时生成一个零频率分量（$k=0$）。\n\n**2. 混叠**\n\nDFT 网格只能表示有限范围的波数，最高到奈奎斯特极限 $k_{\\max} = N/2$。如果一个相互作用创建了一个大小超过 $k_{\\max}$ 的模式，例如 $k_{true} = k_1+k_2 > k_{\\max}$，这个模式会被错误地“混叠”到一个可表示的波数 $k_{alias}$ 上。对于 $k_1+k_2 \\leq N$ 的相互作用，问题中给出混叠波数为：如果 $k_1+k_2>k_{\\max}$，则 $k_{alias} = |(k_1+k_2) - N|$，否则 $k_{alias}=k_1+k_2$。这是离散指数基函数周期性 $e^{i 2\\pi k_{true} j/N} = e^{i 2\\pi (k_{true} \\pmod N) j/N}$ 的直接结果。本应在高波数模式 $k_{true}$ 中的能量污染了模式 $k_{alias}$。\n\n**3. 三分之二截断规则**\n\n为防止这种污染，应用了三分之二截断规则。其策略是在谱的上部创建一个“填充”区域。\n1. 将所有超过截断波数 $K_c$ 的傅里叶系数 $\\widehat{u}(k)$（即 $|k| > K_c$）设置为零。问题指定 $K_c = \\lfloor (2/3) k_{\\max} \\rfloor - 1$。\n2. 将这个截断后的谱 $\\widehat{u}_{\\text{trunc}}(k)$ 变换回物理空间，得到 $u_{\\text{trunc}}(x)$。\n3. 计算二次乘积 $q_{\\text{trunc}}(x) = u_{\\text{trunc}}(x)^2$。模式 $|k'|, |k''| \\le K_c$ 之间的相互作用最多能产生波数为 $|k'|+|k''| \\le 2K_c$ 的模式。\n4. 去混叠条件是，生成的最高波数 $2K_c$ 不应大到足以混叠回可信的谱区域 $[-K_c, K_c]$。这要求 $2K_c < N-K_c$，即 $K_c < N/3$。由于 $k_{\\max}=N/2$，这等价于 $K_c < (2/3)k_{\\max}$，我们选择的 $K_c$ 满足这个条件。\n5. 计算完 $q_{\\text{trunc}}(x)$ 后，将其变换回傅里叶空间得到 $\\widehat{q}_{\\text{trunc}}(k)$。关键的是，再次将所有 $|k|>K_c$ 的模式置零。这移除了任何合法的高波数功率，但更重要的是，它确保了没有混叠功率污染 $|k| \\le K_c$ 范围内的模式。\n\n**4. 实验步骤**\n\n对每个测试用例，我们执行两个并行的计算。\n\n**计算 A：朴素（混叠）情况**\n1. 构建包含模式 $\\pm k_1$ 和 $\\pm k_2$ 的完整谱表示 $\\widehat{u}(k)$。\n2. 计算 $u(x) = \\text{IFFT}[\\widehat{u}(k)]$。\n3. 计算 $q(x) = u(x)^2$。\n4. 计算 $\\widehat{q}_{\\text{naive}}(k) = \\text{FFT}[q(x)]$。\n5. 从 $k_1+k_2$ 确定目标波数 $k_{alias}$。\n6. 计算能量 $E_{\\text{naive}} = |\\widehat{q}_{\\text{naive}}(k_{alias})|^2 + |\\widehat{q}_{\\text{naive}}(-k_{alias})|^2$。\n\n**计算 B：去混叠（2/3 规则）情况**\n1. 如前所述，构建完整谱表示 $\\widehat{u}(k)$。\n2. 通过将所有 $|k| > K_c = \\lfloor (2/3)N/2 \\rfloor - 1$ 的系数置零，创建一个截断副本 $\\widehat{u}_{\\text{trunc}}(k)$。\n3. 计算 $u_{\\text{trunc}}(x) = \\text{IFFT}[\\widehat{u}_{\\text{trunc}}(k)]$。\n4. 计算 $q_{\\text{trunc}}(x) = u_{\\text{trunc}}(x)^2$。\n5. 计算 $\\widehat{q}_{\\text{trunc}}(k) = \\text{FFT}[q_{\\text{trunc}}(x)]$。\n6. 通过将 $\\widehat{q}_{\\text{trunc}}(k)$ 中所有 $|k| > K_c$ 的系数置零，创建最终的去混叠谱 $\\widehat{q}_{2/3}(k)$。\n7. 计算能量 $E_{2/3} = |\\widehat{q}_{2/3}(k_{alias})|^2 + |\\widehat{q}_{2/3}(-k_{alias})|^2$。\n\n这个过程将证明，在发生混叠的情况下（例如，测试用例 1、2、4），$E_{\\text{naive}}$ 是非零的，而 $E_{2/3}$ 是零，因为去混叠过程正确地移除了伪能量。在无混叠的情况下（测试用例 3），两者都将是非零的，并且应该相等，因为相互作用的模式及其乘积都落在截断区域 $|k| \\le K_c$ 内。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a numerical experiment to demonstrate aliasing in a quadratic\n    nonlinearity on a 1D periodic grid and its removal via the 2/3-rule.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, k1, k2, A1, A2)\n        (96, 40, 20, 1.0, 1.0),\n        (96, 32, 32, 0.8, 0.8),\n        (96, 10, 12, 1.2, 0.7),\n        (128, 41, 41, 0.9, 0.9),\n    ]\n\n    results = []\n    for N, k1, k2, A1, A2 in test_cases:\n        # --- Common setup for this test case ---\n        k_max = N // 2\n        \n        # Calculate target wavenumber k_alias from the sum k1+k2\n        k_sum = k1 + k2\n        if k_sum > k_max:\n            k_alias = abs(k_sum - N)\n        else:\n            k_alias = k_sum\n            \n        # Construct the initial field in spectral space\n        u_hat = np.zeros(N, dtype=np.complex128)\n        if k1 == k2:\n            # If wavenumbers are the same, sum their amplitudes\n            # Special cases k=0 or k=N/2 not needed for these test cases\n            if k1 > 0 and k1  k_max:\n                u_hat[k1] = (A1 + A2) * N / 2.0\n                u_hat[N - k1] = (A1 + A2) * N / 2.0\n        else:\n            # Different wavenumbers get their own coefficients\n            if k1 > 0 and k1  k_max:\n                u_hat[k1] = A1 * N / 2.0\n                u_hat[N - k1] = A1 * N / 2.0\n            if k2 > 0 and k2  k_max:\n                u_hat[k2] += A2 * N / 2.0\n                u_hat[N - k2] += A2 * N / 2.0\n\n        # --- 1. Naive (Aliased) Computation ---\n        # Transform to physical space\n        u_naive = np.fft.ifft(u_hat).real\n        \n        # Compute quadratic nonlinearity\n        q_naive = u_naive**2\n        \n        # Transform back to spectral space\n        q_hat_naive = np.fft.fft(q_naive)\n        \n        # Calculate energy at the aliased wavenumber\n        # The sum of squared magnitudes at +k_alias and -k_alias\n        # Note: k_alias=0 or k_alias=k_max are not hit by the tests\n        E_naive = np.abs(q_hat_naive[k_alias])**2 + np.abs(q_hat_naive[N - k_alias])**2\n\n        # --- 2. De-aliased Computation (2/3-Rule) ---\n        # Calculate the truncation wavenumber Kc\n        # Using the specified conservative definition\n        Kc = int(np.floor(2.0/3.0 * k_max)) - 1\n        \n        # Apply truncation to the initial field spectrum\n        u_hat_trunc = u_hat.copy()\n        u_hat_trunc[Kc + 1 : N - Kc] = 0\n        \n        # Transform truncated spectrum to physical space\n        u_trunc = np.fft.ifft(u_hat_trunc).real\n        \n        # Compute quadratic nonlinearity\n        q_trunc = u_trunc**2\n        \n        # Transform back to spectral space\n        q_hat_trunc = np.fft.fft(q_trunc)\n        \n        # Re-apply truncation to the resulting spectrum\n        q_hat_dealiased = q_hat_trunc.copy()\n        q_hat_dealiased[Kc + 1 : N - Kc] = 0\n        \n        # Calculate energy at the aliased wavenumber from the de-aliased spectrum\n        E_23 = np.abs(q_hat_dealiased[k_alias])**2 + np.abs(q_hat_dealiased[N - k_alias])**2\n\n        results.append(f\"[{E_naive},{E_23}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}