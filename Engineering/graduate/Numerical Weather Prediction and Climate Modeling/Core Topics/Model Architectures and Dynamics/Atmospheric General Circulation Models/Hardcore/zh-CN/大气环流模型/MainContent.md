## 引言
[大气环流](@entry_id:1125564)模式（Atmospheric General Circulation Models, AGCMs）是现代地球科学的基石，它们是驱动每日天气预报的引擎，也是我们理解和预测未来几十年乃至数百年气候变化的核心工具。这些复杂的数值模型将物理定律、流体动力学和计算科学融为一体，旨在模拟地球大气的完整行为。然而，其内部结构的复杂性和多样的应用场景，往往构成了一个知识上的挑战，即如何将抽象的控制方程与具体的模式输出和科学结论联系起来。

本文旨在系统地揭开AGCMs的神秘面纱，为读者构建一个从理论基础到前沿应用的完整知识框架。我们将深入探讨这些模型的内在逻辑，阐明它们的能力与固有的局限性。在接下来的内容中，您将学习到：

*   在**“原理与机制”**一章中，我们将解构AGCM的“骨架”与“血肉”。我们将从控制大气运动的原始方程出发，了解模式“动力核心”的构建方式，并探索如何表示那些尺度过小而无法被模式直接解析的关键物理过程，即“[参数化](@entry_id:265163)方案”。
*   在**“应用与跨学科联系”**一章中，我们将展示AGCMs如何作为强大的科学探究工具。您将看到它们如何应用于从理想化测试、业务化天气预报到[气候变化归因](@entry_id:1122438)和更广泛的[地球系统模拟](@entry_id:203226)等不同领域。
*   最后，在**“动手实践”**部分，您将有机会通过具体的计算和编程练习，将理论知识转化为实践技能，加深对核心概念的理解。

让我们从第一章开始，深入AGCMs的内部，探究其运转的“原理与机制”。

## 原理与机制

本章将深入探讨[大气环流](@entry_id:1125564)模式（AGCMs）的构成原理与核心机制。我们将从控制大气运动的基本物理定律出发，构建出模式的“动力核心”，并探讨如何用数值方法在球形地球上求解这些方程。随后，我们将转向那些无法被模式网格直接解析的[次网格尺度过程](@entry_id:1132602)，阐释用以代表它们的“[参数化](@entry_id:265163)”方案。最后，我们将讨论这些复杂的模型结构如何共同导致了预测中的不确定性。

### 动力核心：控制方程与离散化

AGCM 的核心是一组描述[旋转分层流体](@entry_id:199714)运动的[偏微分](@entry_id:194612)方程，我们称之为“[动力核心](@entry_id:1124042)”。[动力核心](@entry_id:1124042)的任务是解析由模式网格所能捕捉到的大尺度[大气环流](@entry_id:1125564)。

#### 控制方程：静力原始方程组

大气运动的根基是[经典物理学](@entry_id:150394)的基本守恒定律：牛顿第二定律（动量守恒）、[质量守恒定律](@entry_id:147377)和热力学第一定律（能量守恒）。对于在[旋转坐标系](@entry_id:170324)（例如地球）中的流体，其动量方程（即[纳维-斯托克斯方程](@entry_id:142275)）可以写为：
$$ \frac{D\mathbf{v}}{Dt} = -\frac{1}{\rho}\nabla p - \nabla\Phi - 2\boldsymbol{\Omega}\times\mathbf{v} + \mathbf{F} $$
其中，$\frac{D}{Dt}$ 是物质导数，$\mathbf{v}$ 是三维速度矢量，$\rho$ 是密度，$p$ 是压强，$\Phi$ 是包含重力势和[离心势](@entry_id:172447)的重力位势，$2\boldsymbol{\Omega}\times\mathbf{v}$ 是[科里奥利加速度](@entry_id:171639)项（$\boldsymbol{\Omega}$ 为[地球自转](@entry_id:166596)角速度矢量），$\mathbf{F}$ 代表摩擦力等次网格尺度作用力。

对于全球尺度的大气运动，其水平尺度（约 $10^6$ 米）远大于垂直尺度（约 $10^4$ 米）。通过[尺度分析](@entry_id:1131264)可以发现，垂直方向的动量方程中，[垂直气压梯度](@entry_id:1133794)力与重力（或重力位[势梯度](@entry_id:261486)）几乎完全平衡，而流体[质点](@entry_id:186768)的垂直加速度项则小了几个数量级。因此，我们可以做出**[静力平衡近似](@entry_id:1126281)**（Hydrostatic Balance Approximation），用一个诊断关系式取代完整的[垂直动量方程](@entry_id:1133792)：
$$ \frac{\partial p}{\partial z} = -\rho g $$
其中 $z$ 是垂直几何高度，$g$ 是重力加速度。这个近似的意义极为深远：它有效地滤除了在大气中[传播速度](@entry_id:189384)极快（约 $340 \, \mathrm{m/s}$）的垂直声波。由于数值模式的时间步长必须短到足以解析最快的波，滤掉声波使得 AGCMs 可以使用远大于非静力模式的时间步长（例如，从秒级增加到分钟级），从而大大提高了计算效率。

在静力平衡近似下，完整的控制方程组被称为**静力原始方程组**（Hydrostatic Primitive Equations）。一个典型的 AGCM 正是基于这组方程建立的。在这个框架下，模式需要预报（即随时间积分）的**预报变量**通常包括：两个水平风分量 $(u, v)$，一个[热力学变量](@entry_id:160587)（如温度 $T$ 或位温 $\theta$），一个代表整层大气质量的变量（如地表气压 $p_s$），以及各种示踪物（如水汽、云水等）的混合比 $q_i$。垂直速度 $w$ 不再是一个独立的预报变量，而是可以通过[质量守恒](@entry_id:204015)方程（连续性方程）从水平风场中诊断出来。这套方程组完整地描述了旋转、分层大气中的大尺度动力学，是天气预报和气候模拟的基石 。

#### [球面几何](@entry_id:268217)：在全球尺度上表示

由于 AGCMs 是全球模式，其控制方程必须在[球坐标系](@entry_id:167517)下求解。我们通常使用经度 $\lambda$、纬度 $\phi$ 和径向距离 $r$ 构成的坐标系。从[笛卡尔坐标](@entry_id:167698)到[球坐标](@entry_id:146054)的转换并非简单的[变量替换](@entry_id:141386)，它引入了与几何形状相关的**度规系数**（Metric Coefficients）。

空间中的微小线段长度平方 $ds^2$ 在[球坐标](@entry_id:146054)中可以表示为：
$$ ds^2 = dr^2 + r^2 d\phi^2 + r^2\cos^2\phi d\lambda^2 $$
与[正交曲线坐标](@entry_id:190233)系的一般形式 $ds^2 = h_r^2 dr^2 + h_\phi^2 d\phi^2 + h_\lambda^2 d\lambda^2$ 相比，我们可以得到径向、纬向和经向的度规系数分别为 $h_r=1$, $h_\phi=r$, 和 $h_\lambda=r\cos\phi$。

这些度规系数反映了[球面几何](@entry_id:268217)的特性，例如经线在向两极汇聚时，单位经度对应的实际距离 ($r\cos\phi d\lambda$) 会随纬度 $\phi$ 的增加而缩短。因此，所有空间微分算子（如梯度、散度和拉普拉斯算子）在[球坐标](@entry_id:146054)下的表达式都必须包含这些度规系数。例如，在行星表面（$r=a$），一个标量场 $f$ 的水平梯度和水平风场 $\mathbf{v} = u\hat{\boldsymbol{e}}_\lambda + v\hat{\boldsymbol{e}}_\phi$ 的水平散度分别为：
$$ \nabla_h f = \hat{\boldsymbol{e}}_\lambda \frac{1}{a\cos\phi}\frac{\partial f}{\partial \lambda} + \hat{\boldsymbol{e}}_\phi \frac{1}{a}\frac{\partial f}{\partial \phi} $$
$$ \nabla_h\cdot\mathbf{v} = \frac{1}{a\cos\phi}\left(\frac{\partial u}{\partial \lambda} + \frac{\partial}{\partial \phi}\left(v\cos\phi\right)\right) $$
在模式的动量方程和[连续性方程](@entry_id:195013)中正确地处理这些包含 $\cos\phi$ 的度规项，对于准确模拟全球大气运动至关重要 。

#### 水平离散化：谱方法与格点方法

要在计算机上求解原始方程组，必须对其进行[空间离散化](@entry_id:172158)。在水平方向上，主要有两种方法：谱方法和格点方法。

**谱变换方法**（Spectral Transform Method）将大气场（如温度、风场）不表示为一系列网格点上的值，而是展开为一组[正交基](@entry_id:264024)函数的线性组合。在全球模式中，最自然的基函数是**球谐函数** $Y_{\ell}^{m}(\phi,\lambda)$，因为它们是球面[拉普拉斯算子的特征函数](@entry_id:634586)。这意味着，对于一个复杂的算子（如扩散项 $\nabla^2 \psi$），其在[谱空间](@entry_id:1132107)中的作用变成了简单的代数乘法，这极大地提高了计算精度和效率。模式通常采用**[三角截断](@entry_id:1133430)** $T_N$，即只保留总波数 $\ell \le N$ 的所有模态，这种截断方式在所有方向上都具有相同的分辨率，保持了旋转各向同性。然而，对于方程中的[非线性](@entry_id:637147)项（如平流项），在[谱空间](@entry_id:1132107)中直接计算（卷积）的成本极高。因此，谱变换方法巧妙地结合了谱空间和物理空间（格点空间）：将[场变换](@entry_id:265108)到格点上，在格点上进行简单的逐点相乘，然后再将乘积变换回[谱空间](@entry_id:1132107)。这个过程需要一个足够精细的“高斯格网”以避免[非线性](@entry_id:637147)相互作用产生的高频波被错误地表示为低频波，这种现象称为“混淆误差” 。

与之相对的是**格点方法**（Grid-point Methods），如有限差分法或[有限体积法](@entry_id:141374)。这些方法将全球划分为一个经纬度网格（或其他类型的网格），并在每个格点或格块上直接近似[微分算子](@entry_id:140145)。例如，一个点的导数是用其近邻格点的值通过一个“计算模板”（stencil）来计算的。这种方法的优势在于其计算的局地性，适合[大规模并行计算](@entry_id:268183)。然而，其[微分算子](@entry_id:140145)的近似会引入数值频散和耗散误差，其性质与所选的差分格式密切相关，这与谱方法中主要由截断导致的误差有本质不同 。

#### [垂直离散化](@entry_id:1133789)：地形的处理

除了水平离散化，垂直方向的坐标选择同样至关重要，特别是考虑到地球表面复杂的地形。

一个早期的解决方案是**$\sigma$坐标**，它是一种地形追随坐标。它被定义为气压与地表气压的比值，$\sigma = p/p_s$。在这种坐标系中，地表总是一个常数$\sigma$面（$\sigma=1$），这极大地简化了下边界条件的处理。然而，$\sigma$坐标有一个致命的弱点。在一个静止的、等温的大气中，真实的气压[梯度力](@entry_id:166847)在水平方向上应处处为零。但在$\sigma$坐标下，计算水平气压[梯度力](@entry_id:166847)（PGF）的公式包含两个项，一个是在$\sigma$面上的位势梯度，另一个是与地表气压梯度成正比的项。在陡峭的地形上（如山脉），这两个项都会变得非常大，但符号相反。数值计算中，两个大数的相减会因为离散化带来的[截断误差](@entry_id:140949)而产生一个虚假的、不为零的余数，即虚假的气压[梯度力](@entry_id:166847)，导致模式产生不切实际的流动 。

为了解决这个问题，现代 AGCMs 普遍采用**混合（Hybrid）$\eta$坐标**。其定义为 $p = A(\eta) + B(\eta)p_s$，其中 $A(\eta)$ 和 $B(\eta)$ 是预设的函数。设计的关键在于，在近地面层，$B(\eta)$ 接近1而 $A(\eta)$ 接近0，使得$\eta$坐标近似为$\sigma$坐标，以贴合地形；而在高空，$B(\eta)$ 趋近于0而 $A(\eta)$ 成为主导，使得$\eta$坐标面趋近于纯粹的气压面，即水平面。通过这种平滑过渡，[混合坐标](@entry_id:1126228)既能很好地处理下垫面地形，又能在高空大大减小由地形引起的PGF计算误差，从而提高了模拟的准确性 。

#### 动力核心的守恒性

对于用于长期气候模拟的AGCMs，数值方案能否在离散层面精确地维持基本物理量的守恒性至关重要。一个不守恒的模式会产生虚假的质量源或能量源，导致气候态随时间漂移。

**质量守恒**是首要的。在**有限体积**方法中，通过确保计算连续性方程和示踪物[平流方程](@entry_id:144869)时使用完全相同的跨网格界面的质量通量，可以实现全球总干空气质量和总示踪物质量的机器精度守恒。反之，如果不同方程的通量计算不一致，就会成为非守恒性的一个常见来源。相比之下，经典的**半拉格朗日**平流方案由于其插值步骤的性质，本质上是不守恒的，需要额外的“质量订正”步骤 。

**能量守恒**同样关键。在静力模式中，总能量守恒的一个重要方面是动能和势能（位能+内能）之间的转换必须被精确地描述。这要求离散的水平气压[梯度力](@entry_id:166847)算子和离散的[静力平衡](@entry_id:163498)关系必须相互协调。设计不当的算子会导致虚假的能量产生或耗散。此外，动量平流项的数值格式也会影响能量。采用**斜对称**形式的平流项可以确保平流过程本身不产生或消耗动能，有助于模式整体的能量守恒 。

### [次网格尺度物理](@entry_id:1132594)过程：[参数化](@entry_id:265163)方案

[动力核心](@entry_id:1124042)只能模拟那些尺度大于模式网格的运动。然而，许多对天气和气候至关重要的过程，如云的形成、[湍流](@entry_id:151300)和辐射，都发生在远小于网格的尺度上。这些**[次网格尺度过程](@entry_id:1132602)**的集体效应必须通过**[参数化](@entry_id:265163)**（Parameterization）方案来表示。

#### 物理-动力耦合接口

在概念上，模式的完整时间[演化方程](@entry_id:268137)可以被分解为两个部分：
$$ \frac{d\boldsymbol{X}}{dt} = \mathcal{M}(\boldsymbol{X}) + \mathcal{P}(\boldsymbol{X}) $$
其中 $\boldsymbol{X}$ 是模式的预报[状态向量](@entry_id:154607)（包含风、温、压、示踪物等），$\mathcal{M}$ 是[动力核心](@entry_id:1124042)算子（描述大尺度平流、科里奥利力等），而 $\mathcal{P}$ 是物理过程算子，它提供了由次网格过程引起的倾向项（源或汇）。例如，辐射过程提供加热或冷却率（改变 $T$），湍流混合提供动量和热量通量，凝结过程则消耗水汽（改变 $q_v$）并释放潜热（改变 $T$）。

由于动力过程和物理过程的[特征时间尺度](@entry_id:276738)和数值属性截然不同，通常采用**算子分裂**（Operator Splitting）技术进行[时间积分](@entry_id:267413)。例如，在一个时间步内，可以先进行一步纯动力积分，然后将得到的中间状态作为输入，计算并叠加上物理过程的倾向。更精确的方案（如斯特朗分裂）会对称地处理这两个过程。在这个耦合接口上，维持守恒性至关重要。例如，物理过程中水汽凝结减少的质量必须精确等于云水增加的质量，同时释放的潜热也必须与凝结量相符。否则，就会在物理和动力过程之间产生虚假的质量或能量泄漏  。

#### 关键[参数化](@entry_id:265163)方案示例

下面我们介绍几个在 AGCMs 中至关重要的[参数化](@entry_id:265163)方案。

##### 辐射传输

辐射是驱动整个气候系统的根本能量来源（太阳短波辐射）和能量汇出途径（地球长波辐射）。精确计算大气中每一层的辐射加热或冷却是[参数化](@entry_id:265163)的核心任务。一个广泛使用的方法是**[双流近似](@entry_id:1133557)**（Two-stream Approximation），它将复杂的、全角度的辐射场简化为只有向上和向下两个方向的[辐射通量](@entry_id:151732)。

为了计算这些通量，我们需要描述大气成分（气体、云、气溶胶）与辐射的相互作用。这由三个关键的光学性质决定 ：
1.  **[光学厚度](@entry_id:150612)**（$\tau$）：无量纲量，描述辐射在路径上被介质衰减的程度。它是[消光系数](@entry_id:270201)沿路径的积分。
2.  **单次散射反照率**（$\omega_0$）：范围从0到1，表示光子与粒子相互作用后，被散射的概率（而非被吸收的概率）。$\omega_0=0$ 表示纯吸收，$\omega_0=1$ 表示纯散射。
3.  **非[对称因子](@entry_id:274828)**（$g$）：范围从-1到1，描述散射的方[向性](@entry_id:144651)。$g>0$ 表示散射主要集中在前向， $g<0$ 表示主要为后向散射，$g=0$ 为各向同性散射。

对于太阳短波辐射，模式需要计算直接来自太阳的平行光束以及被大气散射后形成的漫射光。而对于地球长波辐射，其源项是地球表面和大气本身根据其温度（通过普朗克函数 $B(T)$）发射的热辐射。最终，净[辐射通量](@entry_id:151732)在垂直方向上的辐合或辐散（$\frac{\partial F_{net}}{\partial p}$）决定了对大气的加热率或冷却率，从而驱动大气运动 。

##### 行星边界层[湍流](@entry_id:151300)

**[行星边界层](@entry_id:187799)**（PBL）是直接受地表影响的最低层大气（厚度从百米到几公里不等）。地表的摩擦力、加热和蒸发通过湍流混合过程影响着整个大气。由于湍涡的尺度远小于AGCM网格，其输运效应必须[参数化](@entry_id:265163)。

最简单的方案是**一阶闭合**（或K理论），它假设湍流通量与平均量的梯度成正比，类似于分子扩散：
$$ \overline{w' \phi'} = -K_\phi \frac{\partial \overline{\phi}}{\partial z} $$
其中 $\overline{w' \phi'}$ 是[湍流通量](@entry_id:1133513)，$K_\phi$ 是[湍流扩散系数](@entry_id:196515)。$K_\phi$ 的大小取决于流动的稳定度。在近地层，这通常通过**[莫宁-奥布霍夫相似性理论](@entry_id:1128126)**来描述。该理论引入了一个无量纲稳定度参数 $\zeta = z/L$（$L$为[莫宁-奥布霍夫长度](@entry_id:1128125)），并通过**稳定度函数** $\phi_m(\zeta)$ 和 $\phi_h(\zeta)$ 来调节动量和热量的混合效率。在不稳定条件下（如白天的对流边界层，$\zeta  0$），[湍流](@entry_id:151300)被[浮力](@entry_id:154088)加强，混合旺盛，$K$ 值增大；在稳定条件下（如夜间的[稳定边界层](@entry_id:1132265)，$\zeta  0$），[湍流](@entry_id:151300)被[浮力](@entry_id:154088)抑制，混合减弱，$K$ 值减小。

然而，一阶闭合是局地性的，无法描述在对流边界层中常见的非局地和反梯度输送。因此，更先进的**高阶闭合**方案被开发出来。例如，1.5阶闭合方案会引入一个关于**[湍流](@entry_id:151300)动能**（TKE）$e$ 的[预报方程](@entry_id:1130221)，从而让[湍流扩散系数](@entry_id:196515)依赖于TKE的大小。这使得模式能够“记忆”[湍流](@entry_id:151300)的历史状态，更好地模拟其产生、发展和耗散的过程 。

##### [湿对流](@entry_id:1128092)

[湿对流](@entry_id:1128092)（形成积云和雷暴的过程）是热带地区能量和水汽垂直输送的主要方式，但其尺度（几公里）远小于典型AGCM的网格尺度。**质量通量[参数化](@entry_id:265163)方案**是代表其效应的标准方法。

该方案的基本思想是，一个网格内的对流活动可以被看作是由若干个有组织的上升气流（updrafts）和下沉气流（downdrafts）以及它们周围的环境空气组成的。次网格的垂直输送通量可以表示为上升/下沉气流的质量通量（$M_u, M_d$）与其内部物理属性（如位温$\theta_u$）和环境空气属性（$\theta_e$）之差的乘积，例如 $F_\theta \approx M_u(\theta_u - \theta_e)$。

上升气流在上升过程中会与周围环境空气混合。**夹卷**（Entrainment）是环境空气被卷入上升气流的过程，会增加其质量通量并稀释其[浮力](@entry_id:154088)。**夹出**（Detrainment）则是上升气流中的空气被排入环境的过程，会减少其质量通量。这两个过程的相对大小决定了对流云能达到的高度。

对流[参数化](@entry_id:265163)方案通常区分为**深对流**和**[浅对流](@entry_id:1131529)**。
-   **深对流**：穿透整个对流层，通常伴随大量降水和潜热释放。其触发和强度（即云底质量通量）的判定（称为“闭合”）通常与大气中的**对流有效位能**（CAPE）的消耗有关。
-   **[浅对流](@entry_id:1131529)**：通常局限于[行星边界层](@entry_id:187799)顶部，不产生或只产生少量降水。其主要作用是混合边界层顶部的热量和水汽。其闭合机制通常与边界层的热力不平衡或湍流强度相关。
正确区分和表示这两种对流对于模拟全球能量平衡和水循环至关重要 。

### 模式不确定性：从结构到预测

我们已经看到，一个AGCM是由[动力核心](@entry_id:1124042)和一系列复杂的[参数化](@entry_id:265163)方案耦合而成的系统。在构建模型的每一个环节——从数值算法的选择到[参数化](@entry_id:265163)方案的具体形式——都存在多种可能性。每一种选择组合都构成了一个不同的**模式结构**。这种结构的多样性是模式不确定性的一个主要来源。

在评估模式预测时，区分两种基本的不确定性类型非常重要 ：
1.  **认知不确定性**（Epistemic Uncertainty）：也称为**结构不确定性**，源于我们对真实物理过程知识的不足。不同的[参数化](@entry_id:265163)方案都是对复杂现实的近似，它们之间的差异（例如，一个模式用一种对流方案，另一个模式用另一种）导致了模式平均气候态的差异。在统计上，这对应于不同模式（$\mathcal{M}$）的预测均值之间的方差，即 $\mathrm{Var}(\mathbb{E}[Y | \mathcal{M}])$。原则上，随着科学的进步和观测数据的增加，这种不确定性是可以被减小的。
2.  **[偶然不确定性](@entry_id:634772)**（Aleatory Uncertainty）：也称为**[内部变率](@entry_id:1126630)**，源于大气系统固有的混沌特性。即使我们拥有一个完美的模式，由于初值存在微小差异，多次模拟的结果也会不尽相同，围绕着模式的平均气候态随机波动。这对应于单个模式内部，由不同初值导致的预测方差，即 $\mathrm{Var}(Y | \mathcal{M})$。这种不确定性是系统内在的，无法消除。

在实践中，[气候学](@entry_id:1122484)家通过运行“[多模式集合](@entry_id:1128268)”（如CMIP计划）来探究和量化结构不确定性，而通过对单个模式进行“初值扰动集合”预报来量化[内部变率](@entry_id:1126630)。理解这两种不确定性的来源和特性，是进行模式评估、发展多模式集成预报（如[贝叶斯模型平均](@entry_id:168960)，BMA）以及最终做出可靠的[气候预测](@entry_id:184747)和预估的理论基础 。