## 引言
在构建能够精确预测天气和模拟气候的数值大气模型时，如何处理地球表面复杂多变的地形是一个根本性挑战。传统的[垂直坐标系](@entry_id:1133787)（如几何高度或气压）在遇到山脉等崎岖地形时会产生“阶梯状”网格，这不仅会引发数值不稳定性，还会严重扭曲近地表的物理过程。因此，开发能够贴合地形的坐标系成为现代大气建模的必然选择。本文正是为了解决这一知识缺口，系统地介绍和剖析了在[数值天气预报](@entry_id:191656)和气候模型中占据核心地位的Sigma坐标与混合Sigma-气压坐标。

本文将引导读者循序渐进地掌握这一关键技术。在“原理与机制”一章中，我们将首先阐明为何需要地形追随坐标，并介绍经典的Sigma坐标。随后，我们将深入探讨其致命缺陷——气压[梯度力](@entry_id:166847)误差，并详细解释混合Sigma-气压坐标是如何通过精巧的设计来克服这一难题的。接着，在“应用与跨学科联系”一章，我们将展示这些坐标系在实际模型中的广泛应用，探讨其如何与[地表过程](@entry_id:192310)、大气动力核心、化学输送以及资料同化等模块深度耦合，并揭示其在[行星科学](@entry_id:158926)等交叉学科中的重要性。最后，通过“动手实践”部分提供的编程练习，您将有机会亲手实现并验证这些坐标系的特性，从而将理论知识转化为实践能力。

## 原理与机制

本章旨在深入剖析数值大气模型中地形追随坐标系的构建原理、内在机制及其在实际应用中面临的挑战与解决方案。继前一章对背景的介绍之后，我们将从基本物理原理出发，系统地阐述为何需要地形追随坐标，它们如何工作，以及为了在离散化的数值模型中精确地模拟大气运动，必须采用何种精巧的数学与计算策略。

### 为何需要地形追随坐标系

在构建一个能够覆盖全球或区域的大气模型时，一个核心的几何问题是如何表示地球表面，尤其是其上复杂多变的地形。最直观的[垂直坐标系](@entry_id:1133787)选择，如几何高度（$z$坐标）或气压（$p$坐标），虽然在高空自由大气中表现良好，但在近地面区域却会遇到严峻的挑战。

在这些坐标系中，等坐标面是水平的（等几何高度面或等压面）。当这些水平面与崎岖的地形相交时，模型的底层网格单元会被地形“切割”或“遮蔽”，形成所谓的**“阶梯状”边界**。这种表示方法带来了两个主要问题 ：

1.  **数值不稳定性**：被切割的网格单元可能具有极小的垂直厚度和体积。对于依赖于[显式时间积分](@entry_id:165797)方案的模型，其时间步长受到Courant–Friedrichs–Lewy (CFL) 条件的严格限制。该条件要求时间步长 $\Delta t$ 必须小于某个与网格尺寸成正比的阈值。由于垂直方向的网格厚度 $\Delta z$ 可能趋近于零，CFL条件会迫使整个模型采用极小的时间步长，这在计算上是不可行的。

2.  **物理过程表示的困难**：大气与地表的相互作用，如摩擦、热量和[动量通量](@entry_id:199796)，是驱动大气边界层（Planetary Boundary Layer, PBL）演变的关键。这些物理过程的边界条件必须施加在真实的地表上。在阶梯状网格中，地表穿过了许多网格单元，这使得精确施加这些边界通量变得异常复杂和不准确。例如，基于梯[度理论](@entry_id:636058)的[湍流通量](@entry_id:1133513)（如 $\tau \propto \partial u / \partial \zeta$）在不规则的网格边界上难以计算，从而引入显著的[截断误差](@entry_id:140949)。

为了克服这些困难，数值天气预报（NWP）和气候模型引入了**地形追随坐标系（terrain-following coordinates）**。其核心思想是通过坐标变换，使得模型的最低层坐标面与真实的地形表面完全重合。最经典的地形追随坐标是 **Sigma ($\sigma$) 坐标**，由 Phillips (1957) 首次提出。其定义为：

$$
\sigma = \frac{p}{p_s}
$$

其中，$p$ 是气压，$p_s$ 是地表气压。在这个坐标系中，无论地形如何起伏，$p_s$ 都会随之变化，但地表本身始终是 $\sigma = 1$ 的坐标面。同样，模型顶部（通常假定为一个恒定的等压面 $p=p_t$）对应于一个固定的 $\sigma$ 值，如 $\sigma = p_t / p_s$。

这种设计巧妙地解决了阶梯状边界的问题。模型在每个水平位置都有一整列完整的垂直网格，避免了被切割的单元和相关的CFL问题。更重要的是，它极大地简化了下边界条件的应用 。例如，大气在固体地表上的运动必须满足运动学边界条件，即流体[质点](@entry_id:186768)不能穿过地表。在[笛卡尔坐标系](@entry_id:169789)中，这个条件表现为一个较为复杂的形式：$w = u (\partial h / \partial x) + v (\partial h / \partial y)$，其中 $w$ 是垂直速度，$u, v$ 是水平速度，$h(x, y)$ 是地形高度。然而，在任何一个地表本身就是坐标面（例如 $\sigma=1$）的坐标系中，这个条件被优雅地转化为一个极其简洁的形式：

$$
\dot{\sigma} \equiv \frac{D\sigma}{Dt} = 0 \quad (\text{at } \sigma = 1)
$$

其中 $\dot{\sigma}$ 是跟随流体[质点](@entry_id:186768)运动的 $\sigma$ 坐标的变化率。这个简洁的边界条件极大地简化了模型方程的构建和求解 。

### 气压[梯度力](@entry_id:166847)误差：一个严峻的挑战

然而，地形追随坐标在解决一个问题的同时，也引入了一个新的、更为棘手的难题，即**气压[梯度力](@entry_id:166847)（Pressure Gradient Force, PGF）误差**。PGF是驱动大气水平运动的主要动力，它在等压面坐标系中形式简单，但在地形追随坐标系中变得非常复杂。

在[静力平衡](@entry_id:163498)的大气中，水平PGF在 $z$ 坐标系下的 $x$ 分量为 $F_x = -(1/\rho)(\partial p/\partial x)_z$，其中下标 $z$ 表示在固定的几何高度上求导。为了在 $\sigma$ 坐标系中计算这一项，我们必须使用[链式法则](@entry_id:190743)进行坐标变换。经过推导，可以得到如下表达式 ：

$$
F_x = -\frac{1}{\rho}\left(\frac{\partial p}{\partial x}\right)_z = -g\left(\frac{\partial z}{\partial x}\right)_\sigma - \frac{1}{\rho}\left(\frac{\partial p}{\partial x}\right)_\sigma
$$

这个表达式揭示了一个深刻的问题。等式右边的两项，即沿 $\sigma$ 坐标面的位[势梯度](@entry_id:261486)项 $g(\partial z/\partial x)_\sigma$ 和气压梯度项 $(1/\rho)(\partial p/\partial x)_\sigma$，都与地形坡度密切相关。在陡峭地形区域，$\sigma$ 面倾斜剧烈，这两项都会变得非常大。在一个静止、水平均匀的大气中，真实的PGF应为零。在连续的数学形式中，上述两项会精确地相互抵消。

然而，在数值模型中，这些导数是通过有限差分在离散的、通常是交错的网格上计算的。由于插值和差分带来的[截断误差](@entry_id:140949)，对这两个大项的离散计算结果无法实现完美抵消。它们相减后会留下一个虚假的、非零的残差。这个残差就是所谓的PGF误差 。这个误差如同一个不存在的“幽灵”力，可以错误地驱动大气产生虚假的环流，尤其是在山区上空，严重污染模拟结果的准确性。

### 混合Sigma-气压坐标：一种精巧的融合

PGF误差是纯 $\sigma$ 坐标系的一个根本缺陷，它源于坐标面坡度从地表一直延伸到高空。为了解决这个问题，研究者们提出了一种更为先进的坐标系——**混合Sigma-气压坐标（Hybrid Sigma-pressure coordinate）** 。其核心思想是“扬长避短”：在需要精确描述地形的近地层，坐标系表现得像 $\sigma$ 坐标；而在PGF误差敏感的高空，坐标系平滑地过渡到纯粹的气压坐标。

一个通用的[混合坐标](@entry_id:1126228) $\eta$ 可以通过如下映射关系来定义气压 $p$ ：

$$
p(\eta, x, y, t) = A(\eta) + B(\eta) p_s(x, y, t)
$$

这里的 $A(\eta)$ 和 $B(\eta)$ 是只依赖于垂直坐标 $\eta$ 的平滑函数，它们精心设计以满足特定的边界条件：
- **在地表**（约定为 $\eta=1$），我们要求坐标面追随地形，即 $p=p_s$。为了让 $p_s = A(1) + B(1)p_s$ 对任意 $p_s$ 恒成立，必须有 $A(1)=0$ 和 $B(1)=1$。
- **在模型顶部**（约定为 $\eta=0$），我们希望坐标面是一个与地表气压 $p_s$ 无关的固定等压面 $p=p_t$。为了让 $p_t = A(0) + B(0)p_s$ 对任意 $p_s$ 恒成立，必须有 $A(0)=p_t$ 和 $B(0)=0$。

通过这样的设计，$B(\eta)$ 从地表的 $1$ 平滑过渡到模型顶部的 $0$。在近地层，$\eta \approx 1$，$B(\eta) \approx 1$，$A(\eta) \approx 0$，因此 $p \approx p_s$，坐标系表现为地形追随。在高空，$\eta \approx 0$，$B(\eta) \approx 0$，因此 $p \approx A(\eta)$。由于 $A(\eta)$ 只与 $\eta$ 有关，等 $\eta$ 面就变成了等压面。

这种设计的优越性可以通过分析PGF的表达式来精确揭示。在广义的 $\eta$ 坐标系中，水平PGF与真实（等压面）PGF之间的关系可以表示为 ：

$$
-\nabla_\eta \Phi = -\nabla_p \Phi + \alpha B(\eta) \nabla p_s
$$

其中 $\Phi$ 是位势，$\alpha$ 是比容，$\nabla_\eta$ 和 $\nabla_p$ 分别代表在等-$\eta$面和等压面上求水平梯度。这个公式清晰地表明，模型计算的PGF ($-\nabla_\eta \Phi$) 与真实PGF ($-\nabla_p \Phi$) 之间的误差项 $\alpha B(\eta) \nabla p_s$ 直接与 $B(\eta)$ 和地形引起的表面气压梯度 $\nabla p_s$ 成正比。

- 对于纯 $\sigma$ 坐标，可以看作是 $B(\eta) = \eta = p/p_s$ 的特例。即使在高空，$p$ 和 $p_s$ 都不为零，因此 $\eta$ 不为零，误差项持续存在。
- 对于[混合坐标](@entry_id:1126228)，由于高空 $B(\eta) \to 0$，误差项也随之趋于零。这意味着模型计算的PGF能够收敛到真实的PGF，从而在高空能够精确地维持地转平衡等关键动力过程，即使模型下方存在陡峭的山脉 。

### 数值实现中的关键考量

成功实现地形追随坐标系不仅需要巧妙的连续方程设计，更依赖于细致入微的离散化和数值实现策略。

#### 垂直[交错网格](@entry_id:1125805)与静力协调性

为了在离散网格上稳定地求解方程，变量通常被放置在不同的位置，即**交错网格（staggered grid）**。在垂直方向上，两种经典的配置是 **Lorenz 网格**和 **Charney-Phillips 网格**。
- **Lorenz 网格**：将所有[热力学变量](@entry_id:160587)（如温度 $T$）和动力学变量（如位势 $\Phi$）放置在同一层（例如，层中心）。
- **Charney-Phillips 网格**：将[热力学变量](@entry_id:160587)放置在层中心，而将动量和位势等变量放置在层与层的界面上。

研究表明，Lorenz 网格在垂直方向上容易激发一种虚假的**“棋盘”状计算模态**。这种模式表现为温度在相邻层之间交替出现正负扰动。由于计算位势梯度时需要对相邻层的温度进行平均，这种高频的棋盘模态恰好被平均过程滤掉，导致它对离散的[静力平衡](@entry_id:163498)方程“不可见”。这种虚假的温度扰动可以在不产生动力响应的情况下自由增长，与地形追随坐标的度规项相互作用时，会产生严重的数值噪音 。

相比之下，Charney-Phillips 网格的设计巧妙地避免了这个问题。因为它在计算位[势梯度](@entry_id:261486)时不需要对垂直方向的温度进行平均，棋盘状的温度扰动会直接转化为位[势场](@entry_id:143025)中的信号，进而通过PGF产生动力学反馈，有效抑制了这种计算模态的增长。因此，Charney-Phillips 网格具有更好的**静力协调性（hydrostatic consistency）**，在地形追随坐标模型中被广泛采用 。

更进一步，要从根本上消除PGF误差，数值方案必须确保离散的[静力平衡](@entry_id:163498)方程与离散的PGF表达式在代数上是完全一致的。这意味着用于诊断计算位势 $\Phi$ 的离散静力积分，与用于计算PGF中[热力学](@entry_id:172368)项的离散比容 $\alpha$ 必须源于同一个一致的物理假设和离散化表示。只有这样，才能在离散层面复现连续方程中那两个大项的精确抵消  。

#### 边界条件的应用

最后，模型的上下边界条件也需要妥善处理。

- **下边界**：如前所述，地形追随坐标的优越性之一就是将复杂的运动学边界条件简化为 $\dot{\eta} = 0$ （在 $\eta=1$ 处） 。

- **上边界**：大气是无界的，但数值模型必须有一个人工的顶部。通常，这个顶部被设定为一个恒定的等压面 $p=p_{top}$，并施加一个“刚盖（rigid-lid）”条件，即没有质量穿过这个边界。在气压坐标中，这意味着垂直速度 $\omega \equiv Dp/Dt = 0$。可以证明，在[混合坐标系](@entry_id:1126230)中，这也等价于 $\dot{\eta}=0$ （在 $\eta=0$ 处）。然而，刚盖边界会像一堵墙一样，完美地反射从下方传播上来的波动（如重力波），这些反射波会干扰整个模拟区域的解。为了防止这种虚假反射，模型通常在最顶部的若干层设置一个**“[海绵层](@entry_id:1132208)”（sponge layer）**或**“辐射[缓冲层](@entry_id:160164)”**。这是一个阻尼区域，通过在动量和[热力学](@entry_id:172368)方程中加入一个松弛项（例如，[瑞利阻尼](@entry_id:172362)项 $-\gamma(\eta)(q - q_{ref})$），将解逐渐地、平滑地“松弛”到一个预设的参考状态。这样，向上传播的波能在到达模型顶部之前被有效吸收，从而实现一个近似开放的、无反射的上边界 。

综上所述，从最初为解决地形表示问题而生的简单 $\sigma$ 坐标，到为克服PGF误差而设计的复杂混合坐标，再到为确保[数值稳定性](@entry_id:175146)和准确性而发展的各种离散化策略，地形追随坐标系的发展历程充分体现了[数值天气预报](@entry_id:191656)和气候模拟领域在理论、数学与计算实践之间不断寻求最佳平衡的探索精神。