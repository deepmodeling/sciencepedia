{
    "hands_on_practices": [
        {
            "introduction": "在深入研究可压缩流体方程的复杂离散化方案之前，我们必须首先掌握闭合该方程组所需的热力学关系。本练习旨在巩固理想气体的密度、压力、温度和内能之间的基本联系，这些是任何可压缩模型的基础构件。通过这个实践，您将验证理想气体状态下热力学变量之间的内在一致性，为后续更复杂的数值模拟奠定物理基础。",
            "id": "4046732",
            "problem": "在用于数值天气预报（NWP）的完全可压缩欧拉方程的守恒有限体积离散化中，考虑一个给定时间步长的单个控制体。网格平均密度为 $\\rho = 1.2\\ \\mathrm{kg\\,m^{-3}}$，网格平均温度为 $T = 290\\ \\mathrm{K}$。流体被建模为理想气体，其比气体常数 $R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，比热比 $\\gamma = 1.4$。仅使用理想气体的基本关系，即理想气体状态方程和理想气体内能密度的定义，按以下步骤进行：\n\n1. 从第一性原理出发，写出连接压强、密度、温度和比气体常数的理想气体关系式。用它来计算网格平均压强 $p$。\n2. 使用连接定容比热和比热比的理想气体热力学恒等式，用 $R$ 和 $\\gamma$ 表示定容比热 $c_v$。然后根据其涉及 $\\rho$、$c_v$ 和 $T$ 的基本定义，确定控制体中的内能密度 $e$。\n3. 证明对于理想气体，比值 $e/p$ 仅取决于 $\\gamma$，并对给定的 $\\gamma$ 值进行数值计算。\n\n请给出无量纲比值 $e/p$ 的单一数值作为最终答案。将最终数值表示为精确小数，无需四舍五入。",
            "solution": "问题陈述已经过严格审查，并被认定是有效的。它在科学上基于理想气体的热力学原理，问题设定良好，数据充分且一致，表述客观。现在我将按照指定的步骤进行完整解答。\n\n给定的参数如下：\n- 网格平均密度：$\\rho = 1.2\\ \\mathrm{kg\\,m^{-3}}$\n- 网格平均温度：$T = 290\\ \\mathrm{K}$\n- 比气体常数：$R = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- 比热比：$\\gamma = 1.4$\n\n流体被视为理想气体。\n\n**第1步：计算压强 ($p$)**\n\n从第一性原理出发，理想气体状态方程通过比气体常数 ($R$) 将压强 ($p$)、密度 ($\\rho$) 和温度 ($T$) 联系起来。该方程为：\n$$p = \\rho R T$$\n代入给定的数值：\n$$p = (1.2\\ \\mathrm{kg\\,m^{-3}}) \\times (287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}) \\times (290\\ \\mathrm{K})$$\n这些值的乘积给出了网格平均压强：\n$$p = 99912\\ \\mathrm{J\\,m^{-3}} = 99912\\ \\mathrm{Pa}$$\n\n**第2步：计算内能密度 ($e$)**\n\n首先，我们确定定容比热 $c_v$。对于量热完全理想气体，定压比热 ($c_p$) 和定容比热 ($c_v$) 通过 Mayer's relation (迈耶关系式) 与比气体常数 ($R$) 相关联：\n$$c_p - c_v = R$$\n比热比 $\\gamma$ 定义为：\n$$\\gamma = \\frac{c_p}{c_v}$$\n根据这个定义，我们可以将 $c_p$ 表示为 $c_p = \\gamma c_v$。将其代入 Mayer's relation 得到：\n$$\\gamma c_v - c_v = R$$\n提出 $c_v$：\n$$c_v(\\gamma - 1) = R$$\n求解 $c_v$，我们得到所需表达式：\n$$c_v = \\frac{R}{\\gamma - 1}$$\n现在，我们确定内能密度 $e$。对于理想气体，比内能（单位质量的内能）$u$ 由 $u = c_v T$ 给出。内能密度 $e$ 是单位体积的内能，通过将比内能乘以密度得到：\n$$e = \\rho u = \\rho c_v T$$\n代入我们推导出的 $c_v$ 表达式：\n$$e = \\rho \\left( \\frac{R}{\\gamma - 1} \\right) T$$\n使用给定数值首先计算 $c_v$：\n$$c_v = \\frac{287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}}{1.4 - 1} = \\frac{287}{0.4}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}} = 717.5\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$$\n现在，我们可以计算内能密度 $e$：\n$$e = (1.2\\ \\mathrm{kg\\,m^{-3}}) \\times (717.5\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}) \\times (290\\ \\mathrm{K})$$\n$$e = 249690\\ \\mathrm{J\\,m^{-3}}$$\n\n**第3步：推导和计算比值 $e/p$**\n\n问题要求证明比值 $e/p$ 仅取决于 $\\gamma$。我们使用前面步骤中推导出的 $p$ 和 $e$ 的符号表达式：\n$$p = \\rho R T$$\n$$e = \\frac{\\rho R T}{\\gamma - 1}$$\n现在，我们构建这两个量的比值：\n$$\\frac{e}{p} = \\frac{\\left( \\frac{\\rho R T}{\\gamma - 1} \\right)}{\\rho R T}$$\n项 $\\rho$、 $R$ 和 $T$ 同时出现在分子和分母中，并且由于 $\\rho \\neq 0$、$R \\neq 0$ 和 $T \\neq 0$，我们可以消去它们：\n$$\\frac{e}{p} = \\frac{1}{\\gamma - 1}$$\n这个结果证实，对于理想气体，内能密度与压强的比值仅是比热比 $\\gamma$ 的函数。\n\n最后，我们使用给定的 $\\gamma = 1.4$ 值来数值计算这个比值：\n$$\\frac{e}{p} = \\frac{1}{1.4 - 1} = \\frac{1}{0.4}$$\n最终的数值是一个精确小数：\n$$\\frac{e}{p} = 2.5$$\n作为一致性检验，我们也可以使用我们计算出的 $p$ 和 $e$ 的数值来计算该比值：\n$$\\frac{e}{p} = \\frac{249690\\ \\mathrm{J\\,m^{-3}}}{99912\\ \\mathrm{J\\,m^{-3}}} = 2.5$$\n结果是一致的。无量纲比值为 $2.5$。",
            "answer": "$$\\boxed{2.5}$$"
        },
        {
            "introduction": "守恒格式的数值模型，如大气和气候模型，直接求解的是“守恒变量”（如质量密度、动量密度和总能量密度），而非直接求解温度或压力。本练习将引导您完成一个至关重要的“反演”步骤：从给定的守恒状态变量中恢复出原始的物理变量（如压力 $p$ 和温度 $T$）。这个过程是数值模型在每个时间步中都必须执行的常规操作，对于诊断物理状态、计算通量以及施加边界条件至关重要。",
            "id": "4046690",
            "problem": "在一个存在重力的情况下，使用严格的质量、动量和能量守恒格式推进的完全可压缩大气模型中，考虑一个单一的有限体积单元。该模型存储了守恒变量：质量密度 $\\rho$、动量密度 $\\rho \\mathbf{u}$ 和总能量密度 $E$。重力由单位质量的引力势 $\\Phi = g z$ 表示，其中 $g$ 是重力加速度，$z$ 是位势高度。热力学闭合是针对干空气的理想气体模型，其比热比为 $\\gamma$，特定气体常数为 $R$。\n\n给定以下单元平均数据：\n- $\\rho = 1.18~\\mathrm{kg}\\,\\mathrm{m}^{-3}$，\n- $\\rho \\mathbf{u} = (5.0,\\,-2.0,\\,0.5)~\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- $E = 2.2987016 \\times 10^{5}~\\mathrm{J}\\,\\mathrm{m}^{-3}$，\n- $g = 9.80665~\\mathrm{m}\\,\\mathrm{s}^{-2}$，\n- $z = 1500~\\mathrm{m}$，\n- $\\gamma = 1.4$，\n- $R = 287~\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，\n\n计算该单元中的原始热力学状态 $(p, T)$，其中 $p$ 是压力，$T$ 是温度。将存储的能量密度 $E$ 视为单位体积的总能量，包括内能、动能和引力势能的贡献。然后通过验证正值条件 $p>0$ 和 $T>0$ 来评估其可实现性。\n\n将 $p$ 以帕斯卡表示，$T$ 以开尔文表示。将最终答案四舍五入到四位有效数字。以单行矩阵 $\\left(p ~\\~ T\\right)$ 的形式提供最终数值答案。",
            "solution": "问题陈述给出了一个完全可压缩大气模型中的一组单元平均守恒变量，并要求计算相应的原始热力学变量，即压力 $p$ 和温度 $T$。该问题是适定的、科学上合理的，并包含了唯一解所需的所有必要信息。\n\n在存在重力的情况下，总能量密度 $E$ 是内能密度 $\\rho e$、动能密度 $E_k$ 和引力势能密度 $E_p$ 的总和：\n$$E = \\rho e + E_k + E_p$$\n动能密度为 $E_k = \\frac{1}{2}\\rho |\\mathbf{u}|^2$，引力势能密度为 $E_p = \\rho \\Phi = \\rho g z$。将这些代入总能量方程，得到：\n$$E = \\rho e + \\frac{1}{2}\\rho |\\mathbf{u}|^2 + \\rho g z$$\n热力学状态由干空气的理想气体定律 $p = \\rho R T$ 描述，其中 $p$ 是压力，$\\rho$ 是质量密度，$R$ 是特定气体常数，$T$ 是温度。理想气体的比内能 $e$ 仅是温度的函数，由 $e = c_v T$ 给出，其中 $c_v$ 是定容比热。常数 $c_v$ 通过关系式 $c_v = \\frac{R}{\\gamma - 1}$ 与 $R$ 和比热比 $\\gamma$ 相关联。\n\n我们的目标是反演给定的守恒状态 $(\\rho, \\rho\\mathbf{u}, E)$ 以求得原始状态 $(p, T)$。\n\n首先，我们计算动能密度 $E_k$。它可以最直接地由给定的动量密度 $\\rho \\mathbf{u}$ 和质量密度 $\\rho$ 计算得出：\n$$E_k = \\frac{|\\rho \\mathbf{u}|^2}{2\\rho}$$\n给定 $\\rho \\mathbf{u} = (5.0, -2.0, 0.5)~\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，动量密度的模平方为：\n$$|\\rho \\mathbf{u}|^2 = (5.0)^2 + (-2.0)^2 + (0.5)^2 = 25.0 + 4.0 + 0.25 = 29.25~(\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1})^2$$\n在 $\\rho = 1.18~\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 的情况下，动能密度为：\n$$E_k = \\frac{29.25}{2 \\times 1.18} = \\frac{29.25}{2.36}~\\mathrm{J}\\,\\mathrm{m}^{-3} \\approx 12.394068~\\mathrm{J}\\,\\mathrm{m}^{-3}$$\n\n其次，我们计算引力势能密度 $E_p$：\n$$E_p = \\rho g z$$\n使用给定的值 $g = 9.80665~\\mathrm{m}\\,\\mathrm{s}^{-2}$ 和 $z = 1500~\\mathrm{m}$：\n$$E_p = 1.18~\\mathrm{kg}\\,\\mathrm{m}^{-3} \\times 9.80665~\\mathrm{m}\\,\\mathrm{s}^{-2} \\times 1500~\\mathrm{m} = 17357.7705~\\mathrm{J}\\,\\mathrm{m}^{-3}$$\n\n第三，我们通过重新排列总能量方程来分离出内能密度 $\\rho e$：\n$$\\rho e = E - E_k - E_p$$\n代入总能量值 $E = 2.2987016 \\times 10^{5}~\\mathrm{J}\\,\\mathrm{m}^{-3}$ 以及我们计算出的 $E_k$ 和 $E_p$ 的值：\n$$\\rho e = 229870.16 - 12.394068 - 17357.7705 \\approx 212499.995432~\\mathrm{J}\\,\\mathrm{m}^{-3}$$\n\n第四，我们确定温度 $T$。内能密度通过 $\\rho e = \\rho c_v T$ 与温度相关。首先，我们计算 $c_v$：\n$$c_v = \\frac{R}{\\gamma - 1} = \\frac{287~\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}}{1.4 - 1.0} = \\frac{287}{0.4} = 717.5~\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$$\n现在我们求解 $T$：\n$$T = \\frac{\\rho e}{\\rho c_v} = \\frac{212499.995432~\\mathrm{J}\\,\\mathrm{m}^{-3}}{1.18~\\mathrm{kg}\\,\\mathrm{m}^{-3} \\times 717.5~\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}} = \\frac{212499.995432}{846.65}~\\mathrm{K} \\approx 250.99757~\\mathrm{K}$$\n\n第五，我们使用理想气体定律计算压力 $p$：\n$$p = \\rho R T$$\n$$p = 1.18~\\mathrm{kg}\\,\\mathrm{m}^{-3} \\times 287~\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 250.99757~\\mathrm{K} \\approx 85003.58~\\mathrm{Pa}$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n压力：$p = 85003.58~\\mathrm{Pa} \\to 8.500 \\times 10^4~\\mathrm{Pa}$。\n温度：$T = 250.99757~\\mathrm{K} \\to 251.0~\\mathrm{K}$。\n\n最后，我们评估计算出的状态的物理可实现性。条件是 $p>0$ 和 $T>0$。我们的结果 $p \\approx 8.5 \\times 10^4~\\mathrm{Pa}$ 和 $T \\approx 251~\\mathrm{K}$ 均为正值，因此该状态是可实现的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.500 \\times 10^4  251.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习是一个高级应用，它揭示了在处理真实世界复杂性（如地形）时，朴素离散化方案的严重缺陷，并展示了为何需要更精巧的“良好平衡”（well-balanced）格式。在陡峭地形上准确计算水平气压梯度力，是大气建模中的一个经典难题；错误的计算会产生虚假的加速度，严重污染模拟结果。通过这个实践，您将亲手量化一个简单方法所产生的误差，并体会良好平衡方案带来的显著改进，从而深刻理解物理、坐标系和数值方法三者之间的精妙互动。",
            "id": "4046693",
            "problem": "考虑一个二维、干、完全可压缩的大气，它在由随水平位置变化的底部边界高程表示的地形上处于静力平衡状态。流体处于静止状态，静力平衡由基本定律 $dp/dz = - \\rho g$ 给出，其中 $p$ 是压强（单位为 $\\mathrm{Pa}$），$\\rho$ 是密度（单位为 $\\mathrm{kg\\,m^{-3}}$），$z$ 是几何高度（单位为 $\\mathrm{m}$），$g$ 是重力加速度（单位为 $\\mathrm{m\\,s^{-2}}$）。假设为等温理想气体，其温度 $T$ 和气体常数 $R$ 恒定，因此 $p(z) = p_0 \\exp(-z/H)$ 和 $\\rho(z) = \\rho_0 \\exp(-z/H)$，其中 $H = RT/g$ 是气压标高，$p_0$ 是海平面气压，$\\rho_0 = p_0/(RT)$ 是海平面密度。水平域在 $x$ 方向上是周期的，长度为 $L_x$。\n\n设地形追随垂直坐标由 $\\sigma \\in [0,1]$ 定义，其到几何高度的映射为\n$$\nz(x,\\sigma) = z_b(x) + \\sigma \\left( z_\\mathrm{top} - z_b(x) \\right),\n$$\n其中 $z_b(x)$ 是底部边界高程，$z_\\mathrm{top}$ 是恒定的顶部高度。底部由一个余弦山给出\n$$\nz_b(x) = A \\cos\\!\\left( \\frac{2\\pi x}{L_x} \\right),\n$$\n其振幅为 $A$（单位为 $\\mathrm{m}$）。计算网格由 $N_x$ 个均匀间隔的水平点 $x_i = i \\Delta x$（对于 $i \\in \\{0,\\dots,N_x-1\\}$，其中 $\\Delta x = L_x/N_x$）和 $N_z$ 个在 $\\sigma$ 中均匀间隔的整层 $\\sigma_j = (j + 1/2)/N_z$（对于 $j \\in \\{0,\\dots,N_z-1\\}$）组成。\n\n通过在网格点上对 $p$ 和 $\\rho$ 进行采样来定义离散静力基态：$p_{i,j} = p\\!\\left( z(x_i,\\sigma_j) \\right)$ 和 $\\rho_{i,j} = \\rho\\!\\left( z(x_i,\\sigma_j) \\right)$。考虑由气压梯度力 (PGF) 引起的离散水平加速度，在物理坐标中为 $a_x = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}$。\n\n您的任务是，对于以下每个测试用例，计算网格上两种不同离散格式的最大范数残余加速度 $R$（单位为 $\\mathrm{m\\,s^{-2}}$）：\n\n1. 一种朴素的、非良态平衡的格式，它使用中心有限差分在常数 $\\sigma$ 上近似 PGF，\n$$\na_{x,\\mathrm{naive}}(i,j) = -\\frac{1}{\\rho_{i,j}} \\cdot \\frac{p_{i+1,j} - p_{i-1,j}}{2\\Delta x},\n$$\n其中 $i$ 的索引是周期性的。残差 $R_\\mathrm{naive}$ 定义为\n$$\nR_\\mathrm{naive} = \\max_{i,j} \\left| a_{x,\\mathrm{naive}}(i,j) \\right|.\n$$\n\n2. 一种良态平衡的、高度插值的格式，它在恒定几何高度上近似 PGF。对于每个 $(i,j)$，令 $z_{i,j} = z(x_i,\\sigma_j)$。根据这些列的采样对 $\\{(z_{k}, p_{k})\\}$，在列 $i-1$ 和 $i+1$ 中构建 $p$ 作为 $z$ 函数的剖面的线性插值。在目标高度 $z_{i,j}$ 处评估这些插值，以获得 $p_{i-1 \\rightarrow i}(z_{i,j})$ 和 $p_{i+1 \\rightarrow i}(z_{i,j})$，即通过在 $z$ 方向上的线性插值，将列 $i-1$ 和 $i+1$ 中的压强映射到高度 $z_{i,j}$。当 $z_{i,j}$ 位于相邻列的采样范围之外时，允许线性外插。然后定义\n$$\na_{x,\\mathrm{wb}}(i,j) = -\\frac{1}{\\rho_{i,j}} \\cdot \\frac{p_{i+1 \\rightarrow i}(z_{i,j}) - p_{i-1 \\rightarrow i}(z_{i,j})}{2\\Delta x},\n$$\n和\n$$\nR_\\mathrm{wb} = \\max_{i,j} \\left| a_{x,\\mathrm{wb}}(i,j) \\right|.\n$$\n\n对于每个测试用例，计算误差缩减因子\n$$\n\\mathcal{Q} = \n\\begin{cases}\nR_\\mathrm{naive} / R_\\mathrm{wb},  \\text{if } R_\\mathrm{wb}  0,\\\\\n1.0,  \\text{if } R_\\mathrm{wb} = 0,\n\\end{cases}\n$$\n它是一个无量纲浮点数。\n\n所有物理常数和参数都必须使用国际单位制（SI单位）。使用 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$T = 280\\,\\mathrm{K}$，$p_0 = 10^5\\,\\mathrm{Pa}$。顶部位于 $z_\\mathrm{top} = 12000\\,\\mathrm{m}$。以下测试套件为四个案例指定了其余参数：\n- 案例1（平坦地形基准）：$L_x = 100000\\,\\mathrm{m}$，$N_x = 64$，$N_z = 40$，$A = 0\\,\\mathrm{m}$。\n- 案例2（中等坡度）：$L_x = 100000\\,\\mathrm{m}$，$N_x = 64$，$N_z = 40$，$A = 1000\\,\\mathrm{m}$。\n- 案例3（更陡峭的地形，更粗糙的垂直网格）：$L_x = 50000\\,\\mathrm{m}$，$N_x = 64$，$N_z = 20$，$A = 2000\\,\\mathrm{m}$。\n- 案例4（更陡峭的地形，更精细的垂直网格）：$L_x = 50000\\,\\mathrm{m}$，$N_x = 64$，$N_z = 80$，$A = 2000\\,\\mathrm{m}$。\n\n您的程序必须为每个案例计算三元组 $(R_\\mathrm{naive}, R_\\mathrm{wb}, \\mathcal{Q})$，其中 $R_\\mathrm{naive}$ 和 $R_\\mathrm{wb}$ 的单位为 $\\mathrm{m\\,s^{-2}}$，$\\mathcal{Q}$ 为无量纲。然后打印一行，其中包含所有十二个结果，形式为一个用方括号括起来的逗号分隔的浮点数列表，按案例排序，每个案例内按 $(R_\\mathrm{naive}, R_\\mathrm{wb}, \\mathcal{Q})$ 的顺序排列。每个浮点数必须四舍五入到六位有效数字。例如，输出格式必须是\n$[r_{1,\\mathrm{naive}},r_{1,\\mathrm{wb}},q_1,r_{2,\\mathrm{naive}},r_{2,\\mathrm{wb}},q_2,r_{3,\\mathrm{naive}},r_{3,\\mathrm{wb}},q_3,r_{4,\\mathrm{naive}},r_{4,\\mathrm{wb}},q_4]$,\n其中每个 $r$ 的单位为 $\\mathrm{m\\,s^{-2}}$，每个 $q$ 为无量纲，所有数值均为十进制浮点数。",
            "solution": "该问题的核心挑战是在地形追随坐标系中量化计算水平气压梯度力 (PGF) 时产生的数值误差，并展示一种良态平衡的离散化方案相对于朴素方案的优越准确性。物理情景是处于完美静力平衡的静止大气，其中真实的水平加速度完全为零。因此，任何由数值方案计算出的非零加速度都纯粹是离散化误差的结果。\n\n$x$ 方向上的连续水平 PGF 由下式给出\n$$\na_x = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\n$$\n在静止的静力大气中，压强 $p$ 仅是几何高度 $z$ 的函数，即 $p = p(z)$。因此，在恒定高度 $z$ 下，压强对水平坐标 $x$ 的偏导数为零：\n$$\n\\left( \\frac{\\partial p}{\\partial x} \\right)_z = 0\n$$\n这意味着真实的水平加速度 $a_x$ 处处恒等于零。因此，该问题要求计算虚假的、由数值方法产生的加速度。\n\n首先，我们建立计算域和物理状态。物理常数包括重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，干空气的比气体常数 $R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，恒定温度 $T = 280\\,\\mathrm{K}$，以及海平面气压 $p_0 = 10^5\\,\\mathrm{Pa}$。根据这些常数，我们推导出气压标高 $H = RT/g$ 和海平面密度 $\\rho_0 = p_0/(RT)$。静力压强和密度剖面由以下指数函数给出：\n$$\np(z) = p_0 \\exp(-z/H)\n$$\n$$\n\\rho(z) = \\rho_0 \\exp(-z/H)\n$$\n计算网格定义在一个长度为 $L_x$ 的水平域和一个延伸至高度 $z_\\mathrm{top} = 12000\\,\\mathrm{m}$ 的垂直域上。水平网格有 $N_x$ 个点 $x_i = i \\Delta x$，其中 $i \\in \\{0, \\dots, N_x-1\\}$，$\\Delta x = L_x/N_x$。垂直方向使用地形追随坐标 $\\sigma \\in [0,1]$ 进行离散化，有 $N_z$ 个层级，位于 $\\sigma_j = (j + 0.5)/N_z$，其中 $j \\in \\{0, \\dots, N_z-1\\}$。每个网格点 $(i,j)$ 处的几何高度 $z$ 由以下映射确定：\n$$\nz(x_i, \\sigma_j) = z_b(x_i) + \\sigma_j (z_\\mathrm{top} - z_b(x_i))\n$$\n其中地形高度 $z_b(x)$ 由一个振幅为 $A$ 的余弦山给出：\n$$\nz_b(x_i) = A \\cos\\left( \\frac{2\\pi x_i}{L_x} \\right)\n$$\n使用这个 $z_{i,j}$值的网格，我们对连续的压强和密度场进行采样，以获得离散的基态数组 $p_{i,j} = p(z_{i,j})$ 和 $\\rho_{i,j} = \\rho(z_{i,j})$。\n\n任务的核心是计算两种不同 PGF 格式的最大残余加速度。\n\n1.  **朴素的、非良态平衡的格式**\n    该方法在常数 $\\sigma$ 层上近似气压梯度。偏导数 $(\\partial p / \\partial x)$ 使用沿着常数 $j$ 网格线的中心有限差分进行近似：\n    $$\n    a_{x,\\mathrm{naive}}(i,j) = -\\frac{1}{\\rho_{i,j}} \\cdot \\frac{p_{i+1,j} - p_{i-1,j}}{2\\Delta x}\n    $$\n    水平索引 $i+1$ 和 $i-1$ 采用周期性处理。当地形不平坦时（$A > 0$），常数 $\\sigma_j$ 的表面不是一个常数几何高度 $z$ 的表面。因此，$z_{i+1,j} \\neq z_{i-1,j}$，导致 $p_{i+1,j} \\neq p_{i-1,j}$。这会导致一个非零的、虚假的气压梯度力，这是地形追随模型中一个众所周知的误差来源。残差是这个虚假加速度在整个网格上的最大绝对值：$R_\\mathrm{naive} = \\max_{i,j} |a_{x,\\mathrm{naive}}(i,j)|$。\n\n2.  **良态平衡的、高度插值的格式**\n    该方法被设计成“良态平衡”的，意味着它可以精确地或以高精度地平衡 PGF 和重力项，以维持静止状态。它在恒定几何高度表面上正确地近似 PGF，即 $(\\partial p / \\partial x)_z$。为了在网格点 $(i,j)$ 上做到这一点，我们必须估算相邻列 $i-1$ 和 $i+1$ 中，与点 $(i,j)$ 相同几何高度（即 $z_{i,j} = z(x_i, \\sigma_j)$）处的压强。\n    步骤如下：\n    -   对于每个网格点 $(i,j)$，确定目标高度 $z_{i,j}$。\n    -   在相邻的列 $i-1$ 和 $i+1$（使用周期性索引）中，我们有压强随高度变化的离散垂直剖面，即点对集合 $\\{ (z_{i-1,k}, p_{i-1,k}) \\}_{k=0}^{N_z-1}$ 和 $\\{ (z_{i+1,k}, p_{i+1,k}) \\}_{k=0}^{N_z-1}$。\n    -   我们为每个相邻列构建压强作为高度函数的线性插值。由于目标高度 $z_{i,j}$ 可能位于相邻列的高度范围之外（例如，一个高山旁深谷中的点），因此按规定允许进行线性外插。为此，我们使用 SciPy 的 `interp1d` 函数，并设置 `fill_value='extrapolate'`。\n    -   我们在目标高度 $z_{i,j}$ 处评估这两个插值，以获得水平映射的压强 $p_{i-1 \\rightarrow i}(z_{i,j})$ 和 $p_{i+1 \\rightarrow i}(z_{i,j})$。\n    -   然后，良态平衡的 PGF 计算如下：\n    $$\n    a_{x,\\mathrm{wb}}(i,j) = -\\frac{1}{\\rho_{i,j}} \\cdot \\frac{p_{i+1 \\rightarrow i}(z_{i,j}) - p_{i-1 \\rightarrow i}(z_{i,j})}{2\\Delta x}\n    $$\n    该方案的残余误差 $R_\\mathrm{wb} = \\max_{i,j} |a_{x,\\mathrm{wb}}(i,j)|$ 源于对指数压强剖面进行线性插值的不准确性。预计此误差将远小于朴素方案的误差。\n\n最后，对于每个测试用例，我们计算误差缩减因子 $\\mathcal{Q}$：\n$$\n\\mathcal{Q} = \n\\begin{cases}\nR_\\mathrm{naive} / R_\\mathrm{wb},  \\text{if } R_\\mathrm{wb}  0,\\\\\n1.0,  \\text{if } R_\\mathrm{wb} = 0,\n\\end{cases}\n$$\n该因子量化了使用良态平衡格式所带来的改进程度。整个过程针对四个指定的测试用例实施，并且结果被格式化为六位有效数字。",
            "answer": "$$\n\\boxed{\\texttt{[0.0,0.0,1.0,0.00977227,1.86532e-05,523.883,0.0815598,0.000305608,266.878,0.0815598,7.66989e-05,1063.38]}}\n$$"
        }
    ]
}