{
    "hands_on_practices": [
        {
            "introduction": "高阶超扩散是数值天气和气候模型中控制网格尺度噪音的关键工具。为了理解其工作原理，我们需要量化它对不同空间尺度的影响。本练习将通过傅里叶分析，指导你推导一个四阶超扩散滤波器的放大因子，并解释其结果如何体现“尺度选择性”这一重要特性。",
            "id": "4069912",
            "problem": "考虑一个一维均匀间隔的周期性网格，其上的点为 $x_i = i\\,\\Delta x$，其中 $i \\in \\{0,1,\\dots,N-1\\}$ 且 $N$ 为偶数。设 $u_i$ 是定义在该网格上的一个离散标量预报变量。一个四阶超扩散数值滤波器的单次显式应用定义为\n$$\nu_i^{(f)} \\;=\\; u_i \\;-\\; \\mu\\,\\Big(u_{i-2} \\;-\\; 4\\,u_{i-1} \\;+\\; 6\\,u_i \\;-\\; 4\\,u_{i+1} \\;+\\; u_{i+2}\\Big),\n$$\n其中常系数 $0  \\mu \\le \\frac{1}{16}$ 的选择是为了确保所有可分辨波数的衰减都是非负的。假设边界条件为周期性的，因此索引按模 $N$ 进行循环。此滤波器旨在表示数值天气预报和气候模拟中使用的尺度选择性超扩散，用于控制网格尺度的噪声，同时对动态上重要的长波影响最小。\n\n从线性时不变 (LTI) 离散算子的定义以及复傅里叶模态 $u_i = \\hat{u}\\,\\exp\\big(i\\,k\\,x_i\\big)$ 是任何 LTI 算子在均匀网格上的特征函数这一事实出发，推导出实数放大因子 $G(k)$，使得对于波数为 $k$ 的纯傅里叶模态，有 $u_i^{(f)} = G(k)\\,u_i$。用无量纲波数 $\\xi \\equiv k\\,\\Delta x$（以弧度为单位的角度）来表达你的推导过程。然后，对于特定的参数选择 $\\mu = \\frac{1}{32}$，计算在无量纲波数 $k\\,\\Delta x \\in \\left\\{\\frac{\\pi}{4},\\,\\frac{\\pi}{2},\\,\\frac{3\\pi}{4}\\right\\}$ 处 $G(k)$ 的数值，并将你的答案四舍五入到四位有效数字。最后，解释衰减如何随 $\\xi$ 变化，并说明这对于该滤波器与二阶（拉普拉斯）扩散相比的尺度选择性意味着什么。",
            "solution": "用户希望我分析一个四阶超扩散数值滤波器。\n\n**问题验证**\n\n该问题提供了一个在数值模拟中常见的、定义明确的四阶超扩散滤波器。它要求推导其放大因子，为特定参数计算其值，并解释其尺度选择性。所有的定义、常数和条件都已明确说明。该问题在偏微分方程数值分析领域有科学依据，是适定的、客观的，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的。\n\n**第一部分：推导放大因子 $G(k)$**\n\n四阶超扩散滤波器应用于离散变量 $u_i$ 的公式为：\n$$\nu_i^{(f)} = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\n我们被要求找到放大因子 $G(k)$，它对于一个纯傅里叶模态 $u_i = \\hat{u} \\exp(i k x_i)$ 满足 $u_i^{(f)} = G(k) u_i$。网格点定义为 $x_i = i \\Delta x$。\n\n将傅里叶模态代入 $u_i^{(f)}$ 的定义中：\n$$\nG(k) u_i = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\n两边同除以 $u_i$（对于一个非平凡模态，它不为零），我们得到 $G(k)$ 的表达式：\n$$\nG(k) = 1 - \\mu \\left( \\frac{u_{i-2}}{u_i} - 4\\frac{u_{i-1}}{u_i} + 6 - 4\\frac{u_{i+1}}{u_i} + \\frac{u_{i+2}}{u_i} \\right)\n$$\n对于一个傅里叶模态，变量在相隔 $m$ 个网格单元的两个网格点上的比值为：\n$$\n\\frac{u_{i+m}}{u_i} = \\frac{\\hat{u} \\exp(ikx_{i+m})}{\\hat{u} \\exp(ikx_{i})} = \\frac{\\exp(ik(i+m)\\Delta x)}{\\exp(ik i \\Delta x)} = \\exp(ikm\\Delta x)\n$$\n设无量纲波数为 $\\xi \\equiv k \\Delta x$。该比值变为 $\\exp(im\\xi)$。将其代入 $G(k)$ 的方程中：\n$$\nG(k) = 1 - \\mu \\left( \\exp(-2i\\xi) - 4\\exp(-i\\xi) + 6 - 4\\exp(i\\xi) + \\exp(2i\\xi) \\right)\n$$\n我们可以使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$ 将复指数项分组：\n$$\nG(k) = 1 - \\mu \\left[ (\\exp(2i\\xi) + \\exp(-2i\\xi)) - 4(\\exp(i\\xi) + \\exp(-i\\xi)) + 6 \\right]\n$$\n$$\nG(k) = 1 - \\mu \\left[ 2\\cos(2\\xi) - 8\\cos(\\xi) + 6 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ \\cos(2\\xi) - 4\\cos(\\xi) + 3 \\right]\n$$\n为了进一步简化，我们使用二倍角恒等式 $\\cos(2\\xi) = 2\\cos^2(\\xi) - 1$：\n$$\nG(k) = 1 - 2\\mu \\left[ (2\\cos^2(\\xi) - 1) - 4\\cos(\\xi) + 3 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ 2\\cos^2(\\xi) - 4\\cos(\\xi) + 2 \\right]\n$$\n$$\nG(k) = 1 - 4\\mu \\left[ \\cos^2(\\xi) - 2\\cos(\\xi) + 1 \\right]\n$$\n识别出括号中的项是一个完全平方 $(1 - \\cos(\\xi))^2$：\n$$\nG(k) = 1 - 4\\mu (1 - \\cos(\\xi))^2\n$$\n最后，使用半角恒等式 $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$：\n$$\nG(k) = 1 - 4\\mu \\left( 2\\sin^2\\left(\\frac{\\xi}{2}\\right) \\right)^2\n$$\n$$\nG(k) = 1 - 16\\mu \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n这就是以无量纲波数 $\\xi = k \\Delta x$ 表示的实数放大因子。作为 $\\xi$ 的函数，我们可以将其记为 $G(\\xi)$。\n\n**第二部分：数值计算**\n\n给定 $\\mu = \\frac{1}{32}$，要求我们计算 $\\xi = k\\Delta x \\in \\left\\{\\frac{\\pi}{4}, \\frac{\\pi}{2}, \\frac{3\\pi}{4}\\right\\}$ 时 $G(k)$ 的值。\n将 $\\mu = \\frac{1}{32}$ 代入 $G(\\xi)$ 的通用公式：\n$$\nG(\\xi) = 1 - 16\\left(\\frac{1}{32}\\right) \\sin^4\\left(\\frac{\\xi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n\n对于 $\\xi = \\frac{\\pi}{4}$：\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{8}\\right)\n$$\n我们使用恒等式 $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$。所以，$\\sin^2(\\frac{\\pi}{8}) = \\frac{1 - \\cos(\\frac{\\pi}{4})}{2} = \\frac{1 - \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 - \\sqrt{2}}{4}$。\n然后，$\\sin^4(\\frac{\\pi}{8}) = \\left(\\frac{2 - \\sqrt{2}}{4}\\right)^2 = \\frac{4 - 4\\sqrt{2} + 2}{16} = \\frac{6 - 4\\sqrt{2}}{16} = \\frac{3 - 2\\sqrt{2}}{8}$。\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 - 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 - 2\\sqrt{2}}{16} = \\frac{16 - 3 + 2\\sqrt{2}}{16} = \\frac{13 + 2\\sqrt{2}}{16}\n$$\n数值上，$G(\\frac{\\pi}{4}) \\approx \\frac{13 + 2(1.41421356)}{16} = \\frac{15.82842712}{16} \\approx 0.9892767$。四舍五入到四位有效数字，为 $0.9893$。\n\n对于 $\\xi = \\frac{\\pi}{2}$：\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{4}\\right)\n$$\n因为 $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$，我们有 $\\sin^4(\\frac{\\pi}{4}) = \\left(\\frac{\\sqrt{2}}{2}\\right)^4 = \\frac{4}{16} = \\frac{1}{4}$。\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = 1 - \\frac{1}{8} = \\frac{7}{8} = 0.875\n$$\n到四位有效数字，为 $0.8750$。\n\n对于 $\\xi = \\frac{3\\pi}{4}$：\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{3\\pi}{8}\\right)\n$$\n我们使用 $\\sin^2(\\frac{3\\pi}{8}) = \\frac{1 - \\cos(\\frac{3\\pi}{4})}{2} = \\frac{1 - (-\\frac{\\sqrt{2}}{2})}{2} = \\frac{1 + \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 + \\sqrt{2}}{4}$。\n然后，$\\sin^4(\\frac{3\\pi}{8}) = \\left(\\frac{2 + \\sqrt{2}}{4}\\right)^2 = \\frac{4 + 4\\sqrt{2} + 2}{16} = \\frac{6 + 4\\sqrt{2}}{16} = \\frac{3 + 2\\sqrt{2}}{8}$。\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 + 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 + 2\\sqrt{2}}{16} = \\frac{16 - 3 - 2\\sqrt{2}}{16} = \\frac{13 - 2\\sqrt{2}}{16}\n$$\n数值上，$G(\\frac{3\\pi}{4}) \\approx \\frac{13 - 2(1.41421356)}{16} = \\frac{10.17157288}{16} \\approx 0.6357233$。四舍五入到四位有效数字，为 $0.6357$。\n\n**第三部分：解释与比较**\n\n滤波器的衰减由 $A(\\xi) = 1 - G(\\xi) = 16\\mu \\sin^4(\\xi/2)$ 给出。无量纲波数 $\\xi = k \\Delta x$ 的范围从 $0$（对应无限长的波）到 $\\pi$（对应波长为 $2\\Delta x$ 的最短可分辨波，即奈奎斯特波长）。\n\n当 $\\xi$ 从 $0$ 增加到 $\\pi$ 时，$\\sin(\\xi/2)$ 从 $0$ 单调增加到 $1$。因此，衰减 $A(\\xi)$ 也单调增加。这意味着滤波器对短波（大 $\\xi$）的阻尼比长波（小 $\\xi$）更强。对于 $\\xi \\to 0$，$G(\\xi) \\to 1$ 且衰减 $A(\\xi) \\to 0$，因此非常长的波几乎不受影响。对于 $\\xi = \\pi$ 的最短波，衰减最大。这个性质被称为尺度选择性。数值结果证实了这一点：$G(\\frac{\\pi}{4})  G(\\frac{\\pi}{2})  G(\\frac{3\\pi}{4})$，意味着阻尼随波数增加而增加。\n\n为了与二阶（拉普拉斯）扩散滤波器进行比较，我们考虑一个形式为 $u_i^{(f)} = u_i + \\mu_2(u_{i-1} - 2u_i + u_{i+1})$ 的滤波器。其放大因子，我们称之为 $G_2(\\xi)$，可以类似地推导出：\n$$\nG_2(\\xi) = 1 + \\mu_2(\\exp(-i\\xi) - 2 + \\exp(i\\xi)) = 1 + \\mu_2(2\\cos(\\xi) - 2) = 1 - 2\\mu_2(1-\\cos(\\xi))\n$$\n使用半角恒等式，这变为：\n$$\nG_2(\\xi) = 1 - 4\\mu_2 \\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\n关键区别在于对于小 $\\xi$（长波）的行为。对于小的 $\\theta$，$\\sin(\\theta) \\approx \\theta$。\n二阶滤波器的衰减为 $A_2(\\xi) = 4\\mu_2 \\sin^2(\\xi/2) \\approx 4\\mu_2 (\\xi/2)^2 = \\mu_2 \\xi^2$。\n四阶滤波器的衰减为 $A_4(\\xi) = 16\\mu \\sin^4(\\xi/2) \\approx 16\\mu (\\xi/2)^4 = \\mu \\xi^4$。\n\n对于长波，四阶超扩散滤波器的衰减与 $\\xi^4$ 成正比，而二阶拉普拉斯滤波器的衰减与 $\\xi^2$ 成正比。由于对于小 $\\xi$，$\\xi^4 \\ll \\xi^2$，超扩散滤波器在保留动态上重要的长波的同时，去除短波长的数值噪声方面远为有效。这种卓越的尺度选择性是为什么在数值天气预报和气候模拟等应用中偏好使用高阶扩散的原因，因为在这些应用中，保留大尺度动力学至关重要。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.9893  0.8750  0.6357 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了分析现有的滤波器，我们常常需要根据特定的建模目标来设计新的滤波器。我们可以将期望的性质——例如保持总质量（即离散域平均值）不变以及衰减特定的高波数——转化为对滤波器系数的数学约束。这个实践将视角从分析转向综合，演示了如何从第一性原理出发，构建一个满足特定谱响应要求的滤波器。",
            "id": "4069869",
            "problem": "考虑一个一维周期性区域，有 $N$ 个偶数网格点，索引为 $i \\in \\{0,1,\\dots,N-1\\}$，网格间距为 $\\Delta x$。设 $q_i$ 是一个标量场，其离散域均值为 $M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$。一个线性的、稳态的、对称的数值滤波器通过一个 $5$ 点模板应用于 $q_i$，以生成一个滤波后的场 $\\tilde{q}_i$\n$$\n\\tilde{q}_i \\;=\\; w_0\\, q_i \\;+\\; w_1 \\left(q_{i-1} + q_{i+1}\\right) \\;+\\; w_2 \\left(q_{i-2} + q_{i+2}\\right),\n$$\n其中索引是周期性的。该滤波器旨在保持质量（即离散域均值），同时衰减那些会降低数值天气预报和气候模型保真度的高波数。\n\n从离散傅里叶变换（DFT）的定义和周期性网格上线性移不变算子的卷积定理出发，推导滤波器系数 $\\{w_0,w_1,w_2\\}$ 满足的条件，以保证对于任何输入场 $q_i$ 都能精确守恒离散均值。利用离散傅里叶变换表示，该滤波器的谱响应（傅里叶符号）可以写成无量纲波数 $\\theta \\in [0,\\pi]$ 的函数 $H(\\theta)$。通过要求以下谱约束来施加高波数衰减：\n- 在零波数处精确保持均值：$H(0) = 1$，\n- 完全移除奈奎斯特模式：$H(\\pi) = 0$，\n- 对半奈奎斯特模式进行适度衰减：$H\\!\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2}$。\n\n在这三个约束条件下，确定满足均值保持条件和指定高波数衰减的唯一系数 $w_0$、$w_1$ 和 $w_2$。将你的最终答案表示为包含三个系数的行向量，使用精确的分数形式。不需要四舍五入。",
            "solution": "所述问题是有效的。它在科学上基于数值分析和傅里叶理论的原理，并应用于计算流体动力学。该问题是适定的，为三个未知的滤波器系数提供了三个独立的约束条件，确保可以确定唯一的解。定义和目标都以数学精度陈述，没有歧义或矛盾。\n\n我们将分三部分进行求解。首先，我们将推导滤波器权重保持离散域均值的一般条件。其次，我们将推导滤波器的谱响应函数。第三，我们将应用指定的谱约束来构建一个线性方程组，并求解唯一的滤波器系数。\n\n滤波后的场 $\\tilde{q}_i$ 由线性的、稳态的、对称的 $5$ 点模板给出：\n$$\n\\tilde{q}_i = w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2})\n$$\n其中索引在 $N$ 个点的网格上是周期性的，$i \\in \\{0, 1, \\dots, N-1\\}$。\n\n第一步是建立精确守恒离散域均值的条件，$M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$。滤波后场的均值 $\\tilde{M}$ 是 $\\tilde{M} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\tilde{q}_i$。为了使均值得以守恒，我们必须有 $\\tilde{M} = M$，这意味着 $\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} q_i$。\n将 $\\tilde{q}_i$ 的定义代入求和中：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} \\left[ w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2}) \\right]\n$$\n根据求和的线性性质，我们可以分配求和：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = w_0 \\sum_{i=0}^{N-1} q_i + w_1 \\sum_{i=0}^{N-1} q_{i-1} + w_1 \\sum_{i=0}^{N-1} q_{i+1} + w_2 \\sum_{i=0}^{N-1} q_{i-2} + w_2 \\sum_{i=0}^{N-1} q_{i+2}\n$$\n由于区域的周期性，对移位索引的求和与对原始索引的求和是相同的。对于任何整数移位 $k$，$\\sum_{i=0}^{N-1} q_{i-k} = \\sum_{i=0}^{N-1} q_{i+k} = \\sum_{i=0}^{N-1} q_i$。\n因此，方程简化为：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = (w_0 + w_1 + w_1 + w_2 + w_2) \\sum_{i=0}^{N-1} q_i = (w_0 + 2w_1 + 2w_2) \\sum_{i=0}^{N-1} q_i\n$$\n为了使这个等式对任意场 $q_i$ 都成立，系数必须满足以下条件：\n$$\nw_0 + 2w_1 + 2w_2 = 1\n$$\n这是离散均值守恒的一般条件。\n\n接下来，我们推导滤波器的谱响应（或傅里叶符号）$H(\\theta)$。由于该滤波器是一个线性移不变算子，它对单个傅里叶模式 $q_i = \\exp(\\mathrm{j} k_{\\mathrm{phys}} x_i)$ 的作用是将其乘以一个复常数，即谱响应。这里，$x_i = i \\Delta x$，$k_{\\mathrm{phys}}$ 是物理波数，$\\mathrm{j}$ 是虚数单位。在一个包含 $N$ 个点的离散周期域中，我们可以将一个傅里叶模式写成 $q_i = \\exp(\\mathrm{j} \\frac{2\\pi m i}{N})$，其中 $m$ 是某个整数模数。无量纲波数由 $\\theta = \\frac{2\\pi m}{N}$ 给出，因此该模式为 $q_i = \\exp(\\mathrm{j} i \\theta)$。\n将滤波器应用于此模式：\n$$\n\\tilde{q}_i = w_0 \\exp(\\mathrm{j} i \\theta) + w_1 (\\exp(\\mathrm{j} (i-1) \\theta) + \\exp(\\mathrm{j} (i+1) \\theta)) + w_2 (\\exp(\\mathrm{j} (i-2) \\theta) + \\exp(\\mathrm{j} (i+2) \\theta))\n$$\n提出公因式 $\\exp(\\mathrm{j} i \\theta)$：\n$$\n\\tilde{q}_i = \\exp(\\mathrm{j} i \\theta) \\left[ w_0 + w_1 (\\exp(-\\mathrm{j} \\theta) + \\exp(\\mathrm{j} \\theta)) + w_2 (\\exp(-2\\mathrm{j} \\theta) + \\exp(2\\mathrm{j} \\theta)) \\right]\n$$\n使用欧拉公式 $\\cos(\\alpha) = \\frac{\\exp(\\mathrm{j}\\alpha) + \\exp(-\\mathrm{j}\\alpha)}{2}$，括号中的表达式得以简化。滤波后的模式为 $\\tilde{q}_i = H(\\theta) q_i$，其中谱响应 $H(\\theta)$ 为：\n$$\nH(\\theta) = w_0 + 2w_1 \\cos(\\theta) + 2w_2 \\cos(2\\theta)\n$$\n这个函数描述了滤波器如何放大或衰减具有无量纲波数 $\\theta$ 的傅里叶模式。\n\n我们现在施加问题陈述中给出的三个谱约束，以确定系数 $w_0$、$w_1$ 和 $w_2$。\n\n1.  **在零波数处精确保持均值：** $H(0) = 1$。零波数对应于 $\\theta = 0$。\n    $$\n    H(0) = w_0 + 2w_1 \\cos(0) + 2w_2 \\cos(0) = w_0 + 2w_1 + 2w_2\n    $$\n    因此，$w_0 + 2w_1 + 2w_2 = 1$。这与我们之前推导的均值保持条件相同，提供了一致性检验。\n\n2.  **完全移除奈奎斯特模式：** $H(\\pi) = 0$。奈奎斯特频率对应于最高可分辨波数，$\\theta = \\pi$。\n    $$\n    H(\\pi) = w_0 + 2w_1 \\cos(\\pi) + 2w_2 \\cos(2\\pi) = w_0 - 2w_1 + 2w_2\n    $$\n    因此，$w_0 - 2w_1 + 2w_2 = 0$。\n\n3.  **对半奈奎斯特模式进行适度衰减：** $H(\\frac{\\pi}{2}) = \\frac{1}{2}$。此模式位于 $\\theta = \\frac{\\pi}{2}$。\n    $$\n    H\\left(\\frac{\\pi}{2}\\right) = w_0 + 2w_1 \\cos\\left(\\frac{\\pi}{2}\\right) + 2w_2 \\cos\\left(2 \\cdot \\frac{\\pi}{2}\\right) = w_0 + 2w_1(0) + 2w_2(-1) = w_0 - 2w_2\n    $$\n    因此，$w_0 - 2w_2 = \\frac{1}{2}$。\n\n我们得到了一个关于三个未知数 $w_0, w_1, w_2$ 的三元线性方程组：\n\\begin{align*}\n(1) \\quad  w_0 + 2w_1 + 2w_2 = 1 \\\\\n(2) \\quad  w_0 - 2w_1 + 2w_2 = 0 \\\\\n(3) \\quad  w_0 \\qquad - 2w_2 = \\frac{1}{2}\n\\end{align*}\n我们可以解这个方程组。将方程 (2) 从方程 (1) 中减去：\n$$\n(w_0 + 2w_1 + 2w_2) - (w_0 - 2w_1 + 2w_2) = 1 - 0 \\implies 4w_1 = 1 \\implies w_1 = \\frac{1}{4}\n$$\n将方程 (1) 和方程 (2) 相加：\n$$\n(w_0 + 2w_1 + 2w_2) + (w_0 - 2w_1 + 2w_2) = 1 + 0 \\implies 2w_0 + 4w_2 = 1\n$$\n现在我们有一个关于 $w_0$ 和 $w_2$ 的更小的二元方程组：\n\\begin{align*}\n(A) \\quad  2w_0 + 4w_2 = 1 \\\\\n(B) \\quad  w_0 - 2w_2 = \\frac{1}{2}\n\\end{align*}\n将方程 (B) 乘以 $2$：\n$$\n2(w_0 - 2w_2) = 2\\left(\\frac{1}{2}\\right) \\implies 2w_0 - 4w_2 = 1\n$$\n现在将这个结果与方程 (A) 相加：\n$$\n(2w_0 + 4w_2) + (2w_0 - 4w_2) = 1 + 1 \\implies 4w_0 = 2 \\implies w_0 = \\frac{1}{2}\n$$\n最后，将 $w_0$ 的值代入方程 (3) 来求 $w_2$：\n$$\n\\frac{1}{2} - 2w_2 = \\frac{1}{2} \\implies -2w_2 = 0 \\implies w_2 = 0\n$$\n满足所有给定约束的唯一滤波器系数是 $w_0 = \\frac{1}{2}$，$w_1 = \\frac{1}{4}$ 和 $w_2 = 0$。$w_2 = 0$ 这一事实表明，一个 $3$ 点模板就足以满足这些特定的谱要求。得到的模板是 $\\tilde{q}_i = \\frac{1}{2}q_i + \\frac{1}{4}(q_{i-1} + q_{i+1})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实际模型中，滤波并非孤立存在，而是整个方程系统的一部分。数值方案的稳定性取决于所有项（包括平流、扩散和阻尼）之间的相互作用。冯·诺依曼稳定性分析是研究这种相互作用的经典工具。这个综合性练习将向你展示如何评估一个完整偏微分方程离散格式的数值稳定性，并推导出由物理和数值参数共同决定的时间步长约束。",
            "id": "4069876",
            "problem": "考虑一个关于守恒标量场 $u(x,t)$ 的一维线性常系数偏微分方程 (PDE)，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} \\;=\\; -\\,\\nu_{4}\\,\\frac{\\partial^{4} u}{\\partial x^{4}} \\;-\\; \\mu\\,u,\n$$\n该方程模拟了速度为 $c$ 的线性平流、系数为 $\\nu_{4} \\ge 0$ 的四阶超扩散，以及系数为 $\\mu \\ge 0$ 的均匀瑞利海绵（线性阻尼）。考虑一个间距为 $\\Delta x$ 的均匀网格，并采用时间步长为 $\\Delta t$ 的显式前向欧拉时间步进方法。将空间导数离散化如下：\n- 用二阶中心有限差分近似一阶导数，\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}.\n$$\n- 用标准的五点格式近似四阶导数，\n$$\n\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}.\n$$\n这得到以下显式格式\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{c\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u_{j+1}^{n} - u_{j-1}^{n}\\bigr) \\;-\\; \\frac{\\nu_{4}\\,\\Delta t}{\\Delta x^{4}}\\,\\bigl(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}\\bigr) \\;-\\; \\mu\\,\\Delta t\\,u_{j}^{n}.\n$$\n定义无量纲库朗数 $C = c\\,\\Delta t / \\Delta x$、无量纲超扩散数 $H = \\nu_{4}\\,\\Delta t / \\Delta x^{4}$ 和无量纲海绵强度 $R = \\mu\\,\\Delta t$。通过代入波数相位 $\\theta \\in [0,\\pi]$ 的 $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$，对此格式在周期性网格上进行冯·诺伊曼（傅里叶）稳定性分析，并推导放大因子 $G(\\theta)$ 以及对所有 $\\theta \\in [0,\\pi]$ 的稳定性条件 $|G(\\theta)| \\le 1$。使用此条件，通过获得最大允许库朗数 $C_{\\max}(H,R)$ 作为 $H$ 和 $R$ 的函数的闭式表达式，来确定用无量纲参数 $(C,H,R)$ 表示的精确稳定性区域。假设由实轴模态所要求的端点约束得到满足，即 $0 \\le R \\le 2$ 和 $R + 16\\,H \\le 2$。将您的最终答案表示为 $C_{\\max}(H,R)$ 的一个单一解析表达式，该表达式只包含初等函数，并且如果需要，可以包含对傅里叶相位的最小化。不需要进行数值计算，也不需要四舍五入。最终答案必须以不带单位的符号表达式形式给出。",
            "solution": "用户希望找到给定有限差分格式的稳定性条件。\n\n### 第 1 步：问题验证\n\n**1. 提取已知条件：**\n- **偏微分方程 (PDE)：** $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = -\\nu_{4}\\frac{\\partial^{4} u}{\\partial x^{4}} - \\mu u$\n- **空间网格间距：** $\\Delta x$\n- **时间步长：** $\\Delta t$ (前向欧拉)\n- **一阶导数离散化：** $\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x}$\n- **四阶导数离散化：** $\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}$\n- **完整离散格式：** $u_{j}^{n+1} = u_{j}^{n} - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^{n} - u_{j-1}^{n}) - \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - \\mu\\Delta t u_{j}^{n}$\n- **无量纲参数：**\n    - 库朗数：$C = \\frac{c\\Delta t}{\\Delta x}$\n    - 超扩散数：$H = \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}$\n    - 海绵强度：$R = \\mu\\Delta t$\n- **冯·诺伊曼分析 Ansatz：** $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(i j \\theta)$，其中波数相位 $\\theta \\in [0, \\pi]$。\n- **任务：** 推导放大因子 $G(\\theta)$ 并找到最大允许库朗数 $C_{\\max}(H,R)$ 的闭式表达式。\n- **约束条件：** $0 \\le R \\le 2$ 和 $R + 16H \\le 2$。\n\n**2. 使用提取的已知条件进行验证：**\n该问题是针对一个线性偏微分方程的有限差分格式的标准稳定性分析。这是数值分析、计算流体动力学和数值天气预报中的一个常见主题。\n- **科学上成立：** 该偏微分方程模拟了已被充分理解的物理过程（平流、扩散、阻尼）。所用的数值方法（前向欧拉、中心差分）是标准的。冯·诺伊曼分析是在周期性域上进行稳定性分析的合适工具。该问题在科学上和数学上都是合理的。\n- **适定性：** 该问题要求确定稳定性边界，这是一个定义明确的概念。所提供的信息足以推导出放大因子和稳定性条件。“如果需要，可以包含对傅里叶相位的最小化”这一措辞阐明了如何处理由此产生的优化问题，确保可以构建一个定义明确的答案。\n- **客观性：** 语言精确且数学化。所有术语都有定义。没有主观因素。\n- **完整性与一致性：** 该问题是自洽的。给定的关于 $R$ 和 $H$ 的约束条件与傅里叶域边界（$\\theta=0$ 和 $\\theta=\\pi$）处的稳定性要求一致，这将在解题过程中得到证明。\n\n**3. 结论与行动：**\n该问题是有效的。我将继续推导解答。\n\n### 第 2 步：推导解答\n\n首先，我们使用无量纲参数 $C$、$H$ 和 $R$ 重写有限差分格式：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}(u_{j+1}^{n} - u_{j-1}^{n}) - H(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - R u_{j}^{n}\n$$\n为了进行冯·诺伊曼稳定性分析，我们将傅里叶模态 Ansatz $u_{j}^{n} = G(\\theta)^n \\widehat{u}_0 \\exp(i j \\theta)$ 代入该格式。对于单个模态，放大因子为 $G(\\theta) = u_j^{n+1}/u_j^n$。\n代入 Ansatz 并除以 $G(\\theta)^n \\widehat{u}_0 \\exp(i j \\theta)$，我们得到 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = 1 - \\frac{C}{2}(\\exp(i\\theta) - \\exp(-i\\theta)) - H(\\exp(-2i\\theta) - 4\\exp(-i\\theta) + 6 - 4\\exp(i\\theta) + \\exp(2i\\theta)) - R\n$$\n使用欧拉恒等式 $\\exp(i\\phi) - \\exp(-i\\phi) = 2i\\sin(\\phi)$ 和 $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$，我们可以简化这些项。\n平流项变为：\n$$\n-\\frac{C}{2}(2i\\sin(\\theta)) = -iC\\sin(\\theta)\n$$\n超扩散项可以写为：\n$$\n-H[ (2\\cos(2\\theta)) - 4(2\\cos(\\theta)) + 6 ] = -2H[\\cos(2\\theta) - 4\\cos(\\theta) + 3]\n$$\n这可以进一步简化。一个更直接的方法是认识到格式系数 $(1, -4, 6, -4, 1)$ 是两次应用中心二阶差分算子的结果。四阶导数的五点格式的傅里叶符号是 $(2\\cos(\\theta)-2)^2 = 4(\\cos(\\theta)-1)^2$。\n使用半角恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，我们得到：\n$$\n4(\\cos(\\theta)-1)^2 = 4(-2\\sin^2(\\theta/2))^2 = 16\\sin^4(\\theta/2)\n$$\n因此，放大因子 $G(\\theta)$ 是：\n$$\nG(\\theta) = 1 - R - 16H\\sin^4(\\theta/2) - iC\\sin(\\theta)\n$$\n为使格式稳定，对于任何波数，放大因子的模都不能超过 1，即对所有 $\\theta \\in [0, \\pi]$，有 $|G(\\theta)| \\le 1$。\n$$\n|G(\\theta)|^2 = \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2 + (-C\\sin(\\theta))^2 \\le 1\n$$\n让我们分析这个不等式。\n$$\nC^2\\sin^2(\\theta) \\le 1 - \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2\n$$\n右侧的形式为 $1-(1-a)^2 = 2a-a^2=a(2-a)$，其中 $a = R + 16H\\sin^4(\\theta/2)$。\n$$\nC^2\\sin^2(\\theta) \\le \\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)\n$$\n为使此不等式对所有 $\\theta \\in [0, \\pi]$ 成立，库朗数 $C$ 必须有界。我们可以解出 $C^2$：\n$$\nC^2 \\le \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)}\n$$\n这必须对所有 $\\theta \\in (0, \\pi)$ 成立。由于分母为零，$\\theta=0$ 和 $\\theta=\\pi$ 的情况必须单独检查。\n- 在 $\\theta = 0$ 时：$\\sin(0)=0$ 和 $\\sin(0/2)=0$。$G(0) = 1 - R$。条件 $|G(0)| \\le 1$ 意味着 $|1-R| \\le 1$。由于 $R=\\mu\\Delta t \\ge 0$，这得到 $-1 \\le 1-R \\le 1$，简化为 $0 \\le R \\le 2$。这与给定的约束相符。\n- 在 $\\theta = \\pi$ 时：$\\sin(\\pi)=0$ 和 $\\sin(\\pi/2)=1$。$G(\\pi) = 1 - R - 16H$。条件 $|G(\\pi)| \\le 1$ 意味着 $|1-R-16H| \\le 1$。由于 $R \\ge 0$ 且 $H \\ge 0$，$1-R-16H \\le 1$ 总是成立。另一边，$-1 \\le 1-R-16H$，给出 $R+16H \\le 2$。这也与给定的约束相符。\n\n最大允许库朗数 $C_{\\max}$ 是使不等式对所有 $\\theta \\in (0, \\pi)$ 成立的 $C$ 的最大值。这意味着 $C^2$ 必须小于或等于右侧表达式的最小值。\n$$\nC_{\\max}^2 = \\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)} \\right]\n$$\n问题要求给出 $C_{\\max}(H,R)$ 的闭式表达式，并明确允许最终表达式包含对傅里叶相位的最小化。在 $H$ 和 $R$ 的初等函数方面找到该最小化问题的解析解将需要解一个高次多项式方程，这通常是难以处理的。因此，包含最小化算子的表达式即为所要求的最终形式。\n\n$C_{\\max}(H,R)$ 的最终答案是上述表达式的平方根。\n$$\nC_{\\max}(H,R) = \\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)} \\right]}\n$$\n该表达式是在问题约束条件下稳定性边界的最详细的闭式表示。",
            "answer": "$$\n\\boxed{\\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}}\n$$"
        }
    ]
}