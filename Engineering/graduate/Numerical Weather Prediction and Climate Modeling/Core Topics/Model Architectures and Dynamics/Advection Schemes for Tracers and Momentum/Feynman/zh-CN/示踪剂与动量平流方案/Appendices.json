{
    "hands_on_practices": [
        {
            "introduction": "这个实践探讨了二维平流问题中至关重要的数值稳定性概念。通过为一个非分裂的一阶迎风格式推导其稳定性约束，您将理解为什么多维流动对时间步长的限制比独立考虑每个方向时更为严格 。该分析是建立任何稳定的显式数值模型模拟的基础。",
            "id": "4009717",
            "problem": "考虑一个二维线性平流问题，其中被动示踪物在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀、各向异性矩形网格上以恒定速度 $u$ 和 $v$ 平流。示踪物浓度 $q(x,y,t)$ 满足守恒律 $\\partial_t q + \\partial_x(u q) + \\partial_y(v q) = 0$。假设采用一种欧拉、守恒、一阶迎风的有限体积格式，该格式利用由迎风状态确定的跨单元面的通量，将网格单元平均值 $q_{i,j}^{n}$ 更新至 $q_{i,j}^{n+1}$。\n\n从离散通量平衡以及数值格式必须保持单调性（不产生新的极值）和对任意非负初始数据保持非负性的要求出发，推导非分裂二维格式在对角平流（$u$ 和 $v$ 均不为零）情况下确保稳定性和单调性的必要约束条件，即对 Courant-Friedrichs-Lewy (CFL) 数的约束。利用此推导，求出在给定 $\\Delta x$、$\\Delta y$、$u$ 和 $v$ 的情况下的最大允许时间步长 $\\Delta t_{\\max}$，并将其与由各方向一维分析所建议的坐标方向上的界限进行概念性比较。\n\n然后，对于一个具有科学真实性的各向异性网格和风场：\n- $\\Delta x = 30\\,\\text{km}$，\n- $\\Delta y = 10\\,\\text{km}$，\n- $u = 50\\,\\text{m}\\,\\text{s}^{-1}$，\n- $v = 30\\,\\text{m}\\,\\text{s}^{-1}$，\n\n计算与上述推导的非分裂二维单调性和稳定性约束相符的最大时间步长 $\\Delta t_{\\max}$。最终数值答案以秒为单位表示，并四舍五入到 $4$ 位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n- **控制方程**：被动示踪物 $q(x,y,t)$ 的二维线性平流由守恒律 $\\partial_t q + \\partial_x(u q) + \\partial_y(v q) = 0$ 描述。\n- **网格和速度**：网格是间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀、各向异性矩形网格。平流速度 $u$ 和 $v$ 是恒定的。\n- **数值格式**：采用欧拉、守恒、一阶迎风的有限体积格式。它将网格单元平均值 $q_{i,j}^{n}$ 更新至 $q_{i,j}^{n+1}$。\n- **约束条件**：格式必须保持单调性（无新极值）并保持非负性。\n- **任务 1**：推导非分裂二维格式在对角平流（$u \\ne 0, v \\ne 0$）下确保稳定性和单调性对 Courant-Friedrichs-Lewy (CFL) 数的必要约束。\n- **任务 2**：使用推导出的约束找到最大允许时间步长 $\\Delta t_{\\max}$。\n- **任务 3**：从概念上将此 $\\Delta t_{\\max}$ 与一维分析得出的界限进行比较。\n- **任务 4**：计算特定情况下的 $\\Delta t_{\\max}$：\n  - $\\Delta x = 30\\,\\text{km}$\n  - $\\Delta y = 10\\,\\text{km}$\n  - $u = 50\\,\\text{m}\\,\\text{s}^{-1}$\n  - $v = 30\\,\\text{m}\\,\\text{s}^{-1}$\n- **最终答案格式**：$\\Delta t_{\\max}$ 的最终数值答案应以秒为单位，并四舍五入到 $4$ 位有效数字。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据验证标准评估问题。\n- **有科学依据**：该问题植根于应用于偏微分方程（特别是平流方程）的数值分析基本原理，这在流体动力学和输运现象中至关重要。一阶迎风格式是一种经典的、被广泛理解的数值方法。通过单调性进行稳定性分析是一种标准技术。所有方面都具有科学合理性。\n- **适定的**：问题定义明确。它要求推导一个标准的稳定性判据并将其应用于一个具体的数值案例。存在一个唯一的、有意义的解。\n- **客观的**：问题以精确、定量的术语陈述。没有主观、模糊或基于意见的陈述。\n- **完整性**：提供了所有必要信息（偏微分方程、格式类型、网格、速度和约束条件）。\n- **一致性与真实性**：所提供的网格间距和速度的数值对于大气或海洋模拟情境是现实的。没有内部矛盾。\n\n### 步骤 3：结论与行动\n问题是有效的。这是计算流体动力学领域一个标准且适定的练习。将提供完整解答。\n\n### 稳定性和单调性约束的推导\n\n我们从恒定速度场 $(u,v)$ 的控制守恒律开始：\n$$\n\\partial_t q + u \\partial_x q + v \\partial_y q = 0\n$$\n为使用有限体积法离散此方程，我们将其在一个控制体积（网格单元）$\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$ 和一个时间区间 $[t^n, t^{n+1}]$ 上积分。网格单元的尺寸为 $\\Delta x$ 和 $\\Delta y$。单元平均浓度定义为：\n$$\nq_{i,j}^n = \\frac{1}{\\Delta x \\Delta y} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,y,t^n) \\, dx \\, dy\n$$\n将偏微分方程在空间和时间上积分得到：\n$$\n\\int_{t^n}^{t^{n+1}} \\int_{\\Omega_{i,j}} (\\partial_t q + \\partial_x(uq) + \\partial_y(vq)) \\, dx \\, dy \\, dt = 0\n$$\n在空间上使用散度定理，在时间上使用微积分基本定理，并用简单的前向欧拉法离散时间积分，我们得到单元平均值的精确更新公式：\n$$\n\\Delta x \\Delta y (q_{i,j}^{n+1} - q_{i,j}^n) + \\Delta t \\left[ (F^x_{i+1/2,j} - F^x_{i-1/2,j})\\Delta y + (F^y_{i,j+1/2} - F^y_{i,j-1/2})\\Delta x \\right] = 0\n$$\n其中 $F^x$ 和 $F^y$ 是穿过单元面的数值通量，用以近似时间平均的精确通量。整理得到 $q_{i,j}^{n+1}$：\n$$\nq_{i,j}^{n+1} = q_{i,j}^n - \\frac{\\Delta t}{\\Delta x} (F^x_{i+1/2,j} - F^x_{i-1/2,j}) - \\frac{\\Delta t}{\\Delta y} (F^y_{i,j+1/2} - F^y_{i,j-1/2})\n$$\n一阶迎风格式根据“迎风”单元中的值来定义单元界面处的通量。为简单起见，我们首先假设 $u > 0$ 和 $v > 0$。风从左边和下方吹来。\n- 右侧面 ($i+1/2$) 的通量由其左侧单元 ($i,j$) 决定：$F^x_{i+1/2,j} = u q_{i,j}^n$。\n- 左侧面 ($i-1/2$) 的通量由其左侧单元 ($i-1,j$) 决定：$F^x_{i-1/2,j} = u q_{i-1,j}^n$。\n- 顶面 ($j+1/2$) 的通量由其下方单元 ($i,j$) 决定：$F^y_{i,j+1/2} = v q_{i,j}^n$。\n- 底面 ($j-1/2$) 的通量由其下方单元 ($i,j-1$) 决定：$F^y_{i,j-1/2} = v q_{i,j-1}^n$。\n\n将这些通量代入更新方程：\n$$\nq_{i,j}^{n+1} = q_{i,j}^n - \\frac{\\Delta t}{\\Delta x} (u q_{i,j}^n - u q_{i-1,j}^n) - \\frac{\\Delta t}{\\Delta y} (v q_{i,j}^n - v q_{i,j-1}^n)\n$$\n为了分析单调性，我们重新整理方程，将 $q_{i,j}^{n+1}$ 表示为 $t^n$ 时刻其邻居的线性组合：\n$$\nq_{i,j}^{n+1} = \\left(1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{v \\Delta t}{\\Delta y}\\right) q_{i,j}^n + \\left(\\frac{u \\Delta t}{\\Delta x}\\right) q_{i-1,j}^n + \\left(\\frac{v \\Delta t}{\\Delta y}\\right) q_{i,j-1}^n\n$$\n我们定义每个方向上的无量纲 Courant-Friedrichs-Lewy (CFL) 数：\n$$\nc_x = \\frac{u \\Delta t}{\\Delta x} \\quad \\text{和} \\quad c_y = \\frac{v \\Delta t}{\\Delta y}\n$$\n更新格式变为：\n$$\nq_{i,j}^{n+1} = (1 - c_x - c_y) q_{i,j}^n + c_x q_{i-1,j}^n + c_y q_{i,j-1}^n\n$$\n如果 $q_{i,j}^{n+1}$ 是 $t^n$ 时刻值的凸组合，则数值格式是单调的。这要求所有系数都为非负。\n1.  $c_x \\ge 0$：因为 $u > 0$，$\\Delta t > 0$ 和 $\\Delta x > 0$，此条件满足。\n2.  $c_y \\ge 0$：因为 $v > 0$，$\\Delta t > 0$ 和 $\\Delta y > 0$，此条件满足。\n3.  $1 - c_x - c_y \\ge 0$：这是关键的非平凡约束。它意味着 $c_x + c_y \\le 1$。\n\n如果我们考虑 $u$ 和 $v$ 的任意符号，迎风状态是从流动来源的方向选择的。CFL 数应使用绝对值正确定义：$c_x = \\frac{|u| \\Delta t}{\\Delta x}$ 和 $c_y = \\frac{|v| \\Delta t}{\\Delta y}$。同样的推导会得到 $q_{i,j}^n$ 的系数仍为 $(1 - c_x - c_y)$，而其他项则会根据流动方向涉及 $q_{i+1,j}^n$ 或 $q_{i,j+1}^n$ 等邻居。在所有情况下，为使格式保持单调，所有系数必须为非负。邻近单元的系数将是 $c_x$ 和 $c_y$，根据定义它们是非负的。起控制作用的约束始终是 $q_{i,j}^n$ 的系数保持非负。\n\n因此，非分裂二维一阶迎风格式的通用单调性和稳定性约束是：\n$$\n\\frac{|u| \\Delta t}{\\Delta x} + \\frac{|v| \\Delta t}{\\Delta y} \\le 1\n$$\n这个条件确保不产生新的极值，并且初始为非负的场保持非负。\n\n从这个约束中，我们可以通过取等号来找到最大允许时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} \\right) = 1\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}}\n$$\n\n### 概念性比较\n对于一维平流，一阶迎风格式的 CFL 稳定性条件是 $c = \\frac{|U| \\Delta t}{\\Delta L} \\le 1$，其中 $U$ 是速度，$\\Delta L$ 是网格间距。这意味着时间步长的上限是：$\\Delta t \\le \\frac{\\Delta L}{|U|}$。\n\n将此逻辑逐坐标地应用于我们的二维问题，会得到两个独立的约束：\n1.  在 $x$ 方向：$\\Delta t \\le \\frac{\\Delta x}{|u|}$\n2.  在 $y$ 方向：$\\Delta t \\le \\frac{\\Delta y}{|v|}$\n\n一种朴素的方法（常用于时间分裂格式）是通过取两个限制中的最小值来满足两者：$\\Delta t_{\\text{naive}} = \\min\\left(\\frac{\\Delta x}{|u|}, \\frac{\\Delta y}{|v|}\\right)$。\n\n让我们将其与为非分裂格式推导出的限制进行比较。令 $T_x = \\frac{\\Delta x}{|u|}$ 和 $T_y = \\frac{\\Delta y}{|v|}$。\n推导出的限制是 $\\Delta t_{\\max} = \\frac{1}{1/T_x + 1/T_y} = \\frac{T_x T_y}{T_x + T_y}$。\n朴素的限制是 $\\min(T_x, T_y)$。\n\n不失一般性，假设 $T_x \\le T_y$。那么 $\\min(T_x, T_y) = T_x$。\n我们比较 $\\frac{T_x T_y}{T_x + T_y}$ 与 $T_x$。\n因为 $T_x, T_y > 0$，我们有 $T_y  T_x + T_y$。\n两边同除以 $T_x + T_y$ 得到 $\\frac{T_y}{T_x + T_y}  1$。\n两边同乘以正量 $T_x$ 得到 $\\frac{T_x T_y}{T_x + T_y}  T_x$。\n\n这表明，只要 $T_x$ 和 $T_y$ 都是有限的（即 $u$ 和 $v$ 都不为零），就有 $\\Delta t_{\\max}  \\min(T_x, T_y)$。因此，非分裂二维格式的稳定性约束比取一维约束的最小值要严格得多。这在物理上是因为平流是对角穿过网格单元的，必须考虑相对于单元尺寸的总位移。$\\Delta t_{\\max}$ 表达式的分母将平流速率 $\\frac{|u|}{\\Delta x}$ 和 $\\frac{|v|}{\\Delta y}$ 相加，反映了这种综合效应。\n\n### 数值计算\n\n我们给定的数值如下：\n- $\\Delta x = 30\\,\\text{km} = 30 \\times 10^3\\,\\text{m}$\n- $\\Delta y = 10\\,\\text{km} = 10 \\times 10^3\\,\\text{m}$\n- $u = 50\\,\\text{m}\\,\\text{s}^{-1}$\n- $v = 30\\,\\text{m}\\,\\text{s}^{-1}$\n\n由于 $u$ 和 $v$ 均为正，$|u| = u$ 和 $|v| = v$。我们使用 $\\Delta t_{\\max}$ 的公式：\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{u}{\\Delta x} + \\frac{v}{\\Delta y}}\n$$\n首先，计算分母中的各项：\n$$\n\\frac{u}{\\Delta x} = \\frac{50\\,\\text{m}\\,\\text{s}^{-1}}{30 \\times 10^3\\,\\text{m}} = \\frac{5}{3 \\times 10^3}\\,\\text{s}^{-1} = \\frac{5}{3000}\\,\\text{s}^{-1}\n$$\n$$\n\\frac{v}{\\Delta y} = \\frac{30\\,\\text{m}\\,\\text{s}^{-1}}{10 \\times 10^3\\,\\text{m}} = \\frac{3}{10^3}\\,\\text{s}^{-1} = \\frac{3}{1000}\\,\\text{s}^{-1}\n$$\n现在，将这些项相加：\n$$\n\\frac{u}{\\Delta x} + \\frac{v}{\\Delta y} = \\frac{5}{3000} + \\frac{3}{1000} = \\frac{5}{3000} + \\frac{9}{3000} = \\frac{14}{3000}\\,\\text{s}^{-1}\n$$\n最后，通过取倒数计算 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{14}{3000}\\,\\text{s}^{-1}} = \\frac{3000}{14}\\,\\text{s} = \\frac{1500}{7}\\,\\text{s}\n$$\n现在我们计算数值：\n$$\n\\Delta t_{\\max} \\approx 214.285714... \\,\\text{s}\n$$\n问题要求答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $2$、$1$、$4$、$2$。第五位有效数字是 $8$，大于或等于 $5$，所以我们将第四位数字向上取整。\n$$\n\\Delta t_{\\max} \\approx 214.3\\,\\text{s}\n$$\n作为参考，单个一维限制将是：\n$T_x = \\frac{30000\\,\\text{m}}{50\\,\\text{m/s}} = 600\\,\\text{s}$\n$T_y = \\frac{10000\\,\\text{m}}{30\\,\\text{m/s}} = \\frac{1000}{3} \\approx 333.3\\,\\text{s}$\n朴素的限制将是 $\\min(600, 333.3) = 333.3\\,\\text{s}$。正如所推导的，我们得到的正确限制 $214.3\\,\\text{s}$ 要严格得多。",
            "answer": "$$\\boxed{214.3}$$"
        },
        {
            "introduction": "一个稳定的格式不一定精确；它可能会引入非物理的阻尼或相移。本练习使用冯·诺依曼分析方法来剖析经典的 Lax-Wendroff 格式的性能，让您能够推导出其放大因子和数值相速度 。通过量化主导阶的相位误差，您将深入了解数值波如何以不正确的速度传播，这是流体模拟中的一个关键挑战。",
            "id": "4009661",
            "problem": "考虑一维无源示踪剂线性平流，其受守恒律 $\\,\\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x = 0\\,$ 控制，其中速度 $\\,u0\\,$ 为常数，作用于间距为 $\\,\\Delta x\\,$、时间步长为 $\\,\\Delta t\\,$ 的均匀网格上。设 Courant-Friedrichs-Lewy (CFL) Courant 数定义为 $\\,C = u \\Delta t / \\Delta x\\,$. 该方程的 Lax–Wendroff 有限差分格式为\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\frac{C}{2} \\left( \\phi_{j+1}^{n} - \\phi_{j-1}^{n} \\right) + \\frac{C^{2}}{2} \\left( \\phi_{j+1}^{n} - 2 \\phi_{j}^{n} + \\phi_{j-1}^{n} \\right).\n$$\n使用 von Neumann 分析，并代入傅里叶模态 $\\,\\phi_{j}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$，执行以下操作：\n\n1. 推导放大因子 $\\,G(k)\\,$，使得 $\\,\\hat{\\phi}^{n+1} = G(k) \\, \\hat{\\phi}^{n}\\,$，并计算其模 $\\,|G(k)|\\,$，将其表示为无量纲波数 $\\,\\theta = k \\Delta x\\,$ 和 Courant 数 $\\,C\\,$ 的函数。\n\n2. 通过关系式 $\\,G(k) = \\exp\\!\\big( - i \\, \\omega_{\\text{num}}(k) \\, \\Delta t \\big)\\,$（其中 $\\,c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k\\,$），用 $\\,G(k)\\,$ 表示数值相速度 $\\,c_{\\text{num}}(k)\\,$，并将 $\\,c_{\\text{num}}(k)\\,$ 明确地写成 $\\,\\theta\\,$ 和 $\\,C\\,$ 的函数。指出并讨论幅值误差和相位误差如何依赖于 $\\,C\\,$。\n\n最后，在长波极限 $\\,\\theta \\ll 1\\,$ 下，将相对相速度展开为\n$$\n\\frac{c_{\\text{num}}(k)}{u} = 1 + \\alpha(C) \\, \\theta^{2} + \\mathcal{O}\\!\\left( \\theta^{4} \\right).\n$$\n确定系数 $\\,\\alpha(C)\\,$ 的闭式解析表达式。最终答案只提供 $\\,\\alpha(C)\\,$。无需进行数值四舍五入。最终答案必须是无单位的精确表达式。",
            "solution": "我们从线性平流方程 $\\,\\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x = 0\\,$ 和 Lax–Wendroff 离散格式开始\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\frac{C}{2} \\left( \\phi_{j+1}^{n} - \\phi_{j-1}^{n} \\right) + \\frac{C^{2}}{2} \\left( \\phi_{j+1}^{n} - 2 \\phi_{j}^{n} + \\phi_{j-1}^{n} \\right),\n$$\n其中 $\\,C = u \\Delta t / \\Delta x\\,$ 是 Courant 数。对于 von Neumann 分析，代入傅里叶模态 $\\,\\phi_{j}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$，其中 $\\,\\theta = k \\Delta x\\,$. 于是\n$$\n\\phi_{j \\pm 1}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k (j \\pm 1) \\Delta x \\right) = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right) \\exp\\!\\left( \\pm i \\theta \\right).\n$$\n将其代入格式中，两边同时除以 $\\,\\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$，得到放大因子 $\\,G(\\theta)\\,$：\n$$\nG(\\theta) = 1 - \\frac{C}{2} \\left( e^{i \\theta} - e^{- i \\theta} \\right) + \\frac{C^{2}}{2} \\left( e^{i \\theta} - 2 + e^{- i \\theta} \\right).\n$$\n使用 $\\,e^{i \\theta} - e^{- i \\theta} = 2 i \\sin \\theta\\,$ 和 $\\,e^{i \\theta} + e^{- i \\theta} = 2 \\cos \\theta\\,$，\n$$\nG(\\theta) = 1 - i C \\sin \\theta + C^{2} \\left( \\cos \\theta - 1 \\right).\n$$\n因此，实部和虚部分别为\n$$\n\\Re\\{G\\} = 1 + C^{2} \\left( \\cos \\theta - 1 \\right), \\quad \\Im\\{G\\} = - C \\sin \\theta.\n$$\n\n为了计算 $\\,|G(\\theta)|\\,$，注意\n$$\n|G|^{2} = \\left[ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) \\right]^{2} + \\left[ C \\sin \\theta \\right]^{2}.\n$$\n一种方便的形式是使用半角恒等式 $\\,\\cos \\theta - 1 = - 2 \\sin^{2}\\!\\left( \\theta/2 \\right)\\,$ 和 $\\,\\sin \\theta = 2 \\sin\\!\\left( \\theta/2 \\right) \\cos\\!\\left( \\theta/2 \\right)\\,$。令 $\\,s = \\sin\\!\\left( \\theta/2 \\right)\\,$ 和 $\\,c = \\cos\\!\\left( \\theta/2 \\right)\\,$；则\n$$\n\\Re\\{G\\} = 1 - 2 C^{2} s^{2}, \\quad \\Im\\{G\\} = - 2 C s c,\n$$\n和\n$$\n|G|^{2} = \\left( 1 - 2 C^{2} s^{2} \\right)^{2} + \\left( 2 C s c \\right)^{2} = 1 - 4 C^{2} \\left( 1 - C^{2} \\right) s^{4}.\n$$\n因此\n$$\n|G(\\theta)| = \\sqrt{ 1 - 4 C^{2} \\left( 1 - C^{2} \\right) \\sin^{4}\\!\\left( \\frac{\\theta}{2} \\right) }.\n$$\n对于 $\\,0  C  1\\,$，我们有 $\\,|G(\\theta)| \\le 1\\,$，等号仅在 $\\,\\theta \\to 0\\,$ 和 $\\,C = 1\\,$ 时成立，这表明存在耗散，且耗散随 $\\,C (1 - C)\\,$ 和波数的增加而增加。\n\n接下来，为了得到数值相速度，将 $\\,G(\\theta)\\,$ 写为 $\\,G(\\theta) = \\exp\\!\\left( - i \\, \\omega_{\\text{num}}(k) \\, \\Delta t \\right)\\,$，因此 $\\,\\omega_{\\text{num}}(k) \\Delta t = - \\arg G(\\theta)\\,$。使用复数的辐角，我们有\n$$\n\\arg G(\\theta) = \\arctan2\\!\\left( \\Im\\{G\\}, \\Re\\{G\\} \\right) = - \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right),\n$$\n对于足够小的 $\\,\\theta\\,$ 使得 $\\,\\Re\\{G\\}  0\\,$，对于一般的 $\\,\\theta\\,$，其多值行为通过连续性来处理。于是\n$$\n\\omega_{\\text{num}}(k) \\Delta t = \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right),\n$$\n因此\n$$\nc_{\\text{num}}(k) = \\frac{\\omega_{\\text{num}}(k)}{k} = \\frac{1}{k \\, \\Delta t} \\, \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right), \\quad \\theta = k \\Delta x.\n$$\n这个表达式显示了对 Courant 数 $\\,C\\,$ 的明确依赖性：当 $\\,C \\to 1\\,$ 时，该格式变为一个精确的平移，并且对于所有的 $\\,k\\,$，$\\,c_{\\text{num}}(k) \\to u\\,$，因为 $\\,G(\\theta) \\to \\exp(- i \\theta)\\,$。对于 $\\,0  C  1\\,$，相速度偏离 $\\,u\\,$ 并且幅值被衰减，两种误差都随着 $\\,| \\theta |\\,$ 的增大而增大。\n\n为了确定主阶相位误差及其对 Courant 数的依赖性，进行小 $\\,\\theta\\,$ 展开。使用 $\\,\\sin \\theta = \\theta - \\theta^{3}/6 + \\mathcal{O}(\\theta^{5})\\,$ 和 $\\,\\cos \\theta = 1 - \\theta^{2}/2 + \\mathcal{O}(\\theta^{4})\\,$，反正切函数内的比值为\n$$\nR(\\theta) = \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } = \\frac{ C \\left( \\theta - \\theta^{3}/6 + \\mathcal{O}(\\theta^{5}) \\right) }{ 1 - C^{2} \\theta^{2}/2 + \\mathcal{O}(\\theta^{4}) }.\n$$\n展开 $\\,1 / \\left( 1 - C^{2} \\theta^{2}/2 \\right) = 1 + C^{2} \\theta^{2}/2 + \\mathcal{O}(\\theta^{4})\\,$ 得到\n$$\nR(\\theta) = C \\theta \\left( 1 - \\frac{\\theta^{2}}{6} \\right) \\left( 1 + \\frac{C^{2} \\theta^{2}}{2} \\right) + \\mathcal{O}(\\theta^{5}) = C \\theta \\left[ 1 + \\theta^{2} \\left( \\frac{C^{2}}{2} - \\frac{1}{6} \\right) \\right] + \\mathcal{O}(\\theta^{5}).\n$$\n使用 $\\,\\arctan z = z - z^{3}/3 + \\mathcal{O}(z^{5})\\,$，其中 $\\,z = R(\\theta)\\,$，并保留至 $\\,\\mathcal{O}(\\theta^{3})\\,$ 阶项，\n$$\n\\omega_{\\text{num}}(k) \\Delta t = \\arctan R(\\theta) = C \\theta \\left[ 1 + \\theta^{2} \\left( \\frac{C^{2}}{2} - \\frac{1}{6} \\right) \\right] - \\frac{(C \\theta)^{3}}{3} + \\mathcal{O}(\\theta^{5}).\n$$\n合并 $\\,\\theta^{3}\\,$ 项，\n$$\n\\omega_{\\text{num}}(k) \\Delta t = C \\theta \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{5}).\n$$\n因此\n$$\nc_{\\text{num}}(k) = \\frac{ \\omega_{\\text{num}}(k) }{ k } = \\frac{1}{k \\Delta t} \\, C \\theta \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{4})\n= \\frac{C \\Delta x}{\\Delta t} \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{4}).\n$$\n由于 $\\,C \\Delta x / \\Delta t = u\\,$ 且 $\\,\\theta = k \\Delta x\\,$，我们得到长波展开式\n$$\n\\frac{c_{\\text{num}}(k)}{u} = 1 - \\frac{(1 - C^{2})}{6} \\, \\theta^{2} + \\mathcal{O}(\\theta^{4}).\n$$\n因此，在使用记号 $\\,c_{\\text{num}}(k)/u = 1 + \\alpha(C) \\, \\theta^{2} + \\mathcal{O}(\\theta^{4})\\,$ 的情况下，系数为\n$$\n\\alpha(C) = - \\frac{ 1 - C^{2} }{ 6 }.\n$$\n该表达式满足预期的极限：$\\,\\alpha(1) = 0\\,$，因为对于 $\\,C=1\\,$，该格式在网格上重现了精确的平移；对于 $\\,0",
            "answer": "$$\\boxed{-\\frac{1 - C^{2}}{6}}$$"
        },
        {
            "introduction": "为了在陡峭梯度附近同时实现精度和稳定性，现代平流格式采用了非线性限制器。这个动手练习将指导您完成一个二阶 TVD 有限体积格式的核心步骤，从计算受限斜率到重构界面值和计算通量 。完成此实践将揭示当今天气和气候模型中至关重要的高分辨率方法的内部工作原理。",
            "id": "4009665",
            "problem": "考虑二维空间中被动示踪物的保守平流，其受制于网格平均示踪物 $\\bar{q}$ 的局域守恒律：\n$$\\frac{\\partial \\bar{q}}{\\partial t} + \\nabla \\cdot \\left(\\boldsymbol{u}\\, \\bar{q}\\right) = 0,$$\n其中 $\\boldsymbol{u} = (u,v)$ 是速度场。使用有限体积方法，在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格上，通过对守恒律在网格单元上积分，并应用散度定理，将时间演化写为通过四个网格面的净通量，从而得到一个显式时间步长 $\\Delta t$ 内网格平均值的更新。\n\n你将使用 Godunov 方法构建数值通量，该方法采用迎风格式和对每个网格单元内的示踪物进行分段线性重构，并使用总变差递减（TVD）的 minmod 限制器。分量方向斜率的 minmod 限制器定义为\n$$\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min\\left(|a|,|b|\\right),  \\text{if } a\\,b  0,\\\\\n0,  \\text{otherwise.}\n\\end{cases}$$\n\n在一个由 $(i,j) \\in \\{0,1,2\\}\\times\\{0,1,2\\}$ 索引的 $3\\times 3$ 网格片上，考虑中心网格 $(i,j)=(1,1)$，其无量纲网格间距为 $\\Delta x = 1$ 和 $\\Delta y = 1$，时间步长为 $\\Delta t = 0.5$，以及以下无量纲示踪物网格平均值：\n$$\\bar{q}_{0,1} = 0.9,\\quad \\bar{q}_{1,1} = 1.1,\\quad \\bar{q}_{2,1} = 1.3,$$\n$$\\bar{q}_{1,0} = 1.2,\\quad \\bar{q}_{1,2} = 1.0.$$\n假设围绕 $(1,1)$ 的四个面上的面法向无量纲速度为\n$$u_{1+\\frac{1}{2},1} = 0.6,\\quad u_{1-\\frac{1}{2},1} = -0.2,\\quad v_{1,1+\\frac{1}{2}} = 0.3,\\quad v_{1,1-\\frac{1}{2}} = -0.5.$$\n请遵循以下步骤：\n- 使用单网格差分和 minmod 限制器计算中心网格 $(1,1)$ 在 $x$ 和 $y$ 方向的限制后斜率 $s_x$ 和 $s_y$：\n$$s_x(1,1) = \\operatorname{minmod}\\left(\\frac{\\bar{q}_{1,1}-\\bar{q}_{0,1}}{\\Delta x},\\frac{\\bar{q}_{2,1}-\\bar{q}_{1,1}}{\\Delta x}\\right),\\qquad\ns_y(1,1) = \\operatorname{minmod}\\left(\\frac{\\bar{q}_{1,1}-\\bar{q}_{1,0}}{\\Delta y},\\frac{\\bar{q}_{1,2}-\\bar{q}_{1,1}}{\\Delta y}\\right).$$\n- 沿面法向方向通过线性外插重构中心网格在其四个界面上的值：\n$$\\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta x\\, s_x(1,1),\\qquad\n\\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta x\\, s_x(1,1),$$\n$$\\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta y\\, s_y(1,1),\\qquad\n\\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta y\\, s_y(1,1).$$\n- 应用 Godunov 迎风格式，在每个面上根据面法向速度的符号选择迎风界面值。由于给定的面法向速度意味着在所有四个面上都从中心网格进行迎风选择，因此请使用上述重构值。\n- 将通过每个面的平流通量构造为面法向速度与相应迎风界面值的乘积，并对中心网格执行一个时间步长的有限体积更新：\n$$\\bar{q}_{1,1}^{n+1} = \\bar{q}_{1,1}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{1+\\frac{1}{2},1} - F_{1-\\frac{1}{2},1}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(G_{1,1+\\frac{1}{2}} - G_{1,1-\\frac{1}{2}}\\right),$$\n其中 $F$ 和 $G$ 分别是 $x$ 和 $y$ 方向的通量。\n\n严格遵循此程序计算更新后的中心网格示踪物 $\\bar{q}_{1,1}^{n+1}$。将您的最终答案表示为无量纲示踪物混合比，并四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是自洽的、科学上合理的和适定的。现在将严格遵循指定的步骤推导解答，以计算更新后的中心网格示踪物值 $\\bar{q}_{1,1}^{n+1}$。\n\n从时间步 $n$ 到 $n+1$，网格平均示踪物 $\\bar{q}_{1,1}$ 的有限体积更新由下式给出：\n$$\n\\bar{q}_{1,1}^{n+1} = \\bar{q}_{1,1}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{1+\\frac{1}{2},1} - F_{1-\\frac{1}{2},1}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(G_{1,1+\\frac{1}{2}} - G_{1,1-\\frac{1}{2}}\\right)\n$$\n其中 $F$ 和 $G$ 分别是 $x$ 和 $y$ 方向的数值通量。中心网格中的初始示踪物值为 $\\bar{q}_{1,1}^{n} = 1.1$。网格间距为 $\\Delta x = 1$ 和 $\\Delta y = 1$，时间步长为 $\\Delta t = 0.5$。\n\n该过程包括四个主要步骤：\n\n**1. 计算限制后的斜率**\n中心网格 $(1,1)$ 的斜率是使用单网格差分和 minmod 限制器计算的。\nminmod 函数定义为：\n$$\n\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min\\left(|a|,|b|\\right),  \\text{if } a\\,b  0,\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n\n对于 $x$ 方向的斜率 $s_x(1,1)$，我们计算两个参数：\n$$\na_x = \\frac{\\bar{q}_{1,1}-\\bar{q}_{0,1}}{\\Delta x} = \\frac{1.1 - 0.9}{1} = 0.2\n$$\n$$\nb_x = \\frac{\\bar{q}_{2,1}-\\bar{q}_{1,1}}{\\Delta x} = \\frac{1.3 - 1.1}{1} = 0.2\n$$\n由于 $a_x b_x = (0.2)(0.2) = 0.04  0$，斜率为：\n$$\ns_x(1,1) = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\cdot 0.2 = 0.2\n$$\n\n对于 $y$ 方向的斜率 $s_y(1,1)$，两个参数是：\n$$\na_y = \\frac{\\bar{q}_{1,1}-\\bar{q}_{1,0}}{\\Delta y} = \\frac{1.1 - 1.2}{1} = -0.1\n$$\n$$\nb_y = \\frac{\\bar{q}_{1,2}-\\bar{q}_{1,1}}{\\Delta y} = \\frac{1.0 - 1.1}{1} = -0.1\n$$\n由于 $a_y b_y = (-0.1)(-0.1) = 0.01  0$，斜率为：\n$$\ns_y(1,1) = \\operatorname{minmod}(-0.1, -0.1) = \\operatorname{sign}(-0.1) \\min(|-0.1|, |-0.1|) = -1 \\cdot 0.1 = -0.1\n$$\n\n**2. 重构界面值**\n使用计算出的斜率，我们通过从网格中心进行线性外插来重构网格 $(1,1)$ 四个面上的示踪物值。\n\n东界面 ($i=1+1/2$) 上的值：\n$$\n\\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta x\\, s_x(1,1) = 1.1 + \\frac{1}{2}(1)(0.2) = 1.1 + 0.1 = 1.2\n$$\n西界面 ($i=1-1/2$) 上的值：\n$$\n\\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta x\\, s_x(1,1) = 1.1 - \\frac{1}{2}(1)(0.2) = 1.1 - 0.1 = 1.0\n$$\n北界面 ($j=1+1/2$) 上的值：\n$$\n\\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta y\\, s_y(1,1) = 1.1 + \\frac{1}{2}(1)(-0.1) = 1.1 - 0.05 = 1.05\n$$\n南界面 ($j=1-1/2$) 上的值：\n$$\n\\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta y\\, s_y(1,1) = 1.1 - \\frac{1}{2}(1)(-0.1) = 1.1 + 0.05 = 1.15\n$$\n\n**3. 构成平流通量**\n通量是使用 Godunov 迎风方法构成的。问题陈述指出，在所有四个面上，流动都从中心网格向外，因此迎风值是网格 $(1,1)$ 内部的重构值。\n\n东界面通量 $F_{1+\\frac{1}{2},1}$：速度为 $u_{1+\\frac{1}{2},1} = 0.6 > 0$，所以流动来自网格 $(1,1)$。\n$$\nF_{1+\\frac{1}{2},1} = u_{1+\\frac{1}{2},1} \\cdot \\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = 0.6 \\times 1.2 = 0.72\n$$\n西界面通量 $F_{1-\\frac{1}{2},1}$：速度为 $u_{1-\\frac{1}{2},1} = -0.2  0$，所以流动来自网格 $(1,1)$。\n$$\nF_{1-\\frac{1}{2},1} = u_{1-\\frac{1}{2},1} \\cdot \\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = -0.2 \\times 1.0 = -0.20\n$$\n北界面通量 $G_{1,1+\\frac{1}{2}}$：速度为 $v_{1,1+\\frac{1}{2}} = 0.3 > 0$，所以流动来自网格 $(1,1)$。\n$$\nG_{1,1+\\frac{1}{2}} = v_{1,1+\\frac{1}{2}} \\cdot \\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = 0.3 \\times 1.05 = 0.315\n$$\n南界面通量 $G_{1,1-\\frac{1}{2}}$：速度为 $v_{1,1-\\frac{1}{2}} = -0.5  0$，所以流动来自网格 $(1,1)$。\n$$\nG_{1,1-\\frac{1}{2}} = v_{1,1-\\frac{1}{2}} \\cdot \\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = -0.5 \\times 1.15 = -0.575\n$$\n\n**4. 更新中心网格示踪物值**\n我们将通量代入有限体积更新方程：\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - \\frac{0.5}{1}\\left(0.72 - (-0.20)\\right) - \\frac{0.5}{1}\\left(0.315 - (-0.575)\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.5\\left(0.72 + 0.20\\right) - 0.5\\left(0.315 + 0.575\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.5\\left(0.92\\right) - 0.5\\left(0.89\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.46 - 0.445\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.905\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 0.195\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $0.195$ 变为 $0.1950$。",
            "answer": "$$\n\\boxed{0.1950}\n$$"
        }
    ]
}