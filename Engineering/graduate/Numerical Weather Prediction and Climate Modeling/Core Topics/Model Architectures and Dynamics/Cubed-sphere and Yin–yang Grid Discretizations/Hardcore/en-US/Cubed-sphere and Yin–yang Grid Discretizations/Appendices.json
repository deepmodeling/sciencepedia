{
    "hands_on_practices": [
        {
            "introduction": "The first step in building a numerical model on any grid is to understand its fundamental geometric properties. On a cubed-sphere grid, the projection from the flat faces of a cube onto the spherical surface inevitably introduces distortions in lengths and areas. This exercise  provides a direct, hands-on way to quantify this effect by deriving the physical distance, or arc length, between adjacent grid points. By calculating the components of the metric tensor induced by the mapping, you will connect the abstract mathematics of differential geometry to the practical reality of grid scale factors in a climate model.",
            "id": "4029356",
            "problem": "In a global atmospheric model employing an equiangular cubed-sphere grid, consider the mapping from panel coordinates $\\xi$ and $\\eta$ (in radians) on the $+x$ face to the sphere of radius $a$ given by the smooth embedding\n$$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}, \\qquad (\\xi,\\eta)\\in\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big)\\times\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big).\n$$\nUsing the induced metric on the sphere from this mapping, derive a closed-form analytical expression for the arc length between two adjacent grid points along a line of constant $\\eta$ that are separated by a small coordinate increment $\\Delta \\xi$. Assume $\\Delta \\xi$ is sufficiently small that the leading-order approximation based on the metric coefficient along $\\xi$ applies. Express your final result explicitly in terms of $a$, $\\xi$, $\\eta$, and $\\Delta \\xi$. Your answer must be a single analytical expression and you do not need to provide units.",
            "solution": "The user wants to find a closed-form analytical expression for the arc length between two adjacent grid points on a cubed-sphere grid. The provided mapping is from panel coordinates $(\\xi, \\eta)$ on the $+x$ face to a sphere of radius $a$.\n\n### Step 1: Problem Validation\n\n**1.1. Extracted Givens:**\n- **Geometry:** Sphere of radius $a$.\n- **Grid:** Equiangular cubed-sphere grid.\n- **Coordinates:** Panel coordinates $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$.\n- **Mapping Function:** The position vector $\\boldsymbol{r}(\\xi,\\eta)$ is given by $$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}.\n$$\n- **Task:** Find the arc length between two adjacent grid points along a line of constant $\\eta$, separated by a small coordinate increment $\\Delta \\xi$.\n- **Approximation:** Use the leading-order approximation based on the metric coefficient.\n- **Final Expression:** Must be in terms of $a$, $\\xi$, $\\eta$, and $\\Delta \\xi$.\n\n**1.2. Validation:**\n- **Scientific Grounding:** The problem is firmly rooted in differential geometry and its application to numerical grid generation for geophysical models. The cubed-sphere grid and the gnomonic projection used in the mapping are standard, well-established concepts in computational science and atmospheric modeling. The problem is scientifically and factually sound.\n- **Well-Posedness:** The problem provides a specific mapping function and a clear objective. The concept of arc length derived from an induced metric is well-defined. A unique analytical solution is expected to exist.\n- **Objectivity:** The problem is stated using precise, objective mathematical language, free from any subjective or ambiguous terminology.\n- **Completeness and Consistency:** All necessary information (mapping function, coordinate domain, desired quantity) is provided. There are no contradictions.\n\n**1.3. Verdict:**\nThe problem is valid. It is a well-posed and standard exercise in applied differential geometry.\n\n### Step 2: Derivation of the Solution\n\nThe arc length element $ds$ on a parameterized surface is given by the square root of the first fundamental form, $ds^2 = \\boldsymbol{dr} \\cdot \\boldsymbol{dr}$. For a surface parameterized by coordinates $(\\xi, \\eta)$, the differential position vector is $\\boldsymbol{dr} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} d\\eta$.\nThe squared arc length is then:\n$$\nds^2 = \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}\\right) d\\xi^2 + 2\\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\xi d\\eta + \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\eta^2.\n$$\nThis can be written in terms of the metric tensor components $g_{ij}$:\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 + 2g_{\\xi\\eta} d\\xi d\\eta + g_{\\eta\\eta} d\\eta^2.\n$$\nThe problem asks for the arc length along a line of constant $\\eta$, which means $d\\eta = 0$. The expression simplifies to:\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 \\implies ds = \\sqrt{g_{\\xi\\xi}} |d\\xi|.\n$$\nOur main task is to compute the metric coefficient $g_{\\xi\\xi} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$.\n\nLet's denote the position vector as $\\boldsymbol{r}(\\xi, \\eta) = a \\frac{\\boldsymbol{v}}{D}$, where $\\boldsymbol{v} = (1, \\tan\\xi, \\tan\\eta)$ and $D = \\sqrt{1 + \\tan^2\\xi + \\tan^2\\eta}$.\nWe first compute the tangent vector $\\boldsymbol{t}_\\xi = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$ using the vector quotient rule:\n$$\n\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} = a \\frac{D \\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} - \\boldsymbol{v} \\frac{\\partial D}{\\partial \\xi}}{D^2}.\n$$\nThe partial derivatives of the components are:\n$$\n\\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (1, \\tan\\xi, \\tan\\eta) = (0, \\sec^2\\xi, 0).\n$$\nTo find $\\frac{\\partial D}{\\partial \\xi}$, we first differentiate $D^2$:\n$$\nD^2 = 1 + \\tan^2\\xi + \\tan^2\\eta.\n$$\n$$\n\\frac{\\partial (D^2)}{\\partial \\xi} = 2D \\frac{\\partial D}{\\partial \\xi} = 2\\tan\\xi \\sec^2\\xi.\n$$\n$$\n\\frac{\\partial D}{\\partial \\xi} = \\frac{\\tan\\xi \\sec^2\\xi}{D}.\n$$\nSubstituting these into the expression for $\\boldsymbol{t}_\\xi$:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^2} \\left[ D(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\frac{\\tan\\xi \\sec^2\\xi}{D} \\right].\n$$\nTo simplify, multiply the numerator and denominator by $D$:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^3} \\left[ D^2(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\tan\\xi \\sec^2\\xi \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} \\left[ (0, D^2, 0) - (\\tan\\xi, \\tan^2\\xi, \\tan\\xi \\tan\\eta) \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, D^2 - \\tan^2\\xi, -\\tan\\xi \\tan\\eta).\n$$\nSubstitute $D^2 = 1 + \\tan^2\\xi + \\tan^2\\eta$ into the second component:\n$$\nD^2 - \\tan^2\\xi = (1 + \\tan^2\\xi + \\tan^2\\eta) - \\tan^2\\xi = 1 + \\tan^2\\eta = \\sec^2\\eta.\n$$\nSo the tangent vector is:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, \\sec^2\\eta, -\\tan\\xi \\tan\\eta).\n$$\nNow, we compute $g_{\\xi\\xi}$ by taking the dot product of $\\boldsymbol{t}_\\xi$ with itself:\n$$\ng_{\\xi\\xi} = \\boldsymbol{t}_\\xi \\cdot \\boldsymbol{t}_\\xi = \\left(\\frac{a \\sec^2\\xi}{D^3}\\right)^2 \\left( (-\\tan\\xi)^2 + (\\sec^2\\eta)^2 + (-\\tan\\xi \\tan\\eta)^2 \\right).\n$$\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} \\left( \\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta \\right).\n$$\nLet's simplify the term in parentheses. Using $1+\\tan^2\\eta = \\sec^2\\eta$:\n$$\n\\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta = \\tan^2\\xi (1 + \\tan^2\\eta) + \\sec^4\\eta = \\tan^2\\xi \\sec^2\\eta + \\sec^4\\eta.\n$$\nFactor out $\\sec^2\\eta$:\n$$\n= \\sec^2\\eta (\\tan^2\\xi + \\sec^2\\eta) = \\sec^2\\eta (\\tan^2\\xi + 1 + \\tan^2\\eta).\n$$\nThe term $\\tan^2\\xi + 1 + \\tan^2\\eta$ is equal to $D^2$. So the expression in parentheses simplifies to $\\sec^2\\eta \\, D^2$.\nSubstituting this back into the expression for $g_{\\xi\\xi}$:\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} (\\sec^2\\eta \\, D^2) = \\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}.\n$$\nNow we find the square root of $g_{\\xi\\xi}$:\n$$\n\\sqrt{g_{\\xi\\xi}} = \\sqrt{\\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}} = \\frac{|a| |\\sec^2\\xi| |\\sec\\eta|}{D^2}.\n$$\nGiven $a > 0$ and the coordinate range $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$, we have $\\sec\\xi > 0$ and $\\sec\\eta > 0$. We can drop the absolute value signs.\n$$\n\\sqrt{g_{\\xi\\xi}} = \\frac{a \\sec^2\\xi \\sec\\eta}{D^2} = \\frac{a \\sec^2\\xi \\sec\\eta}{1 + \\tan^2\\xi + \\tan^2\\eta}.\n$$\nThe arc length $\\Delta s$ for a small, finite increment $\\Delta \\xi$ along a line of constant $\\eta$ is given by the leading-order approximation:\n$$\n\\Delta s \\approx \\sqrt{g_{\\xi\\xi}} \\Delta\\xi.\n$$\nSubstituting the derived expression for $\\sqrt{g_{\\xi\\xi}}$ gives the final result. For clarity, we can use the identity $1+\\tan^2\\xi=\\sec^2\\xi$ to simplify the denominator:\n$$\n\\Delta s \\approx \\frac{a \\sec^2\\xi \\sec\\eta}{\\sec^2\\xi + \\tan^2\\eta} \\Delta\\xi.\n$$\nThis is the required closed-form analytical expression for the arc length.",
            "answer": "$$\n\\boxed{\\frac{a \\sec^{2}\\xi \\sec\\eta}{\\sec^{2}\\xi + \\tan^{2}\\eta} \\Delta\\xi}\n$$"
        },
        {
            "introduction": "Once we understand the geometry of the grid, we must be able to perform calculus upon it to express physical laws. Simply taking partial derivatives of vector components with respect to the grid coordinates is not sufficient on a curved surface, as this process ignores how the coordinate basis vectors themselves change from point to point. This practice  introduces the essential machinery of tensor calculus on a manifold: the Christoffel symbols. By deriving these symbols from the metric tensor, you will see how they provide the necessary correction terms to form the covariant derivative, enabling the correct representation of physical operators like divergence and gradient on the sphere.",
            "id": "4029380",
            "problem": "This problem uses standard spherical coordinates ($\\alpha$=longitude, $\\beta$=latitude) as a foundational exercise. This system is distinct from the gnomonic projection used for cubed-sphere grids. On a sphere of radius $a$, a patch is parameterized by the embedding\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\, \\big( \\cos\\alpha \\,\\cos\\beta,\\; \\sin\\alpha \\,\\cos\\beta,\\; \\sin\\beta \\big),\n$$\nwith $\\alpha \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$ and $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$. Use first principles from differential geometry of surfaces and the definition of covariant derivatives on Riemannian manifolds to address the following:\n\n- Starting from the fundamental definition of the surface metric induced by the embedding, derive the metric coefficients $g_{ij}$ in the local coordinates $(\\alpha,\\beta)$ and the inverse metric $g^{ij}$ on this face.\n- Using the definition of the Christoffel symbols $\\Gamma^{k}_{ij}$ in terms of $g_{ij}$, obtain the nonzero Christoffel symbols for this face and demonstrate that they are indeed nonzero functions of $(\\alpha,\\beta)$.\n- Using the definition of the covariant derivative of a contravariant vector field $v^{i}$ on the sphere, write the expression for $\\nabla_{\\alpha} v^{\\alpha}$ in these coordinates, explicitly showing the role of the Christoffel symbols in discretizing covariant derivatives on a spherical grid.\n\nFinally, provide the exact closed-form expression, in terms of $\\beta$, for the Christoffel symbol $\\Gamma^{\\alpha}_{\\alpha\\beta}$ on this face. Your final answer must be a single analytic expression. No numerical approximation or rounding is required, and no units should be included in the final expression.",
            "solution": "The problem is valid as it is scientifically grounded in differential geometry, well-posed, objective, and contains all necessary information for a unique solution. The procedures requested are standard in the analysis of curvilinear coordinate systems on manifolds, which is a fundamental aspect of numerical modeling on spherical domains.\n\nLet the local coordinates on the surface be denoted by $(u^1, u^2) = (\\alpha, \\beta)$. The position vector $\\mathbf{R}$ describing the surface of the sphere of radius $a$ is given by\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\begin{pmatrix} \\cos\\alpha \\cos\\beta \\\\ \\sin\\alpha \\cos\\beta \\\\ \\sin\\beta \\end{pmatrix}\n$$\n\nThe first step is to derive the metric tensor $g_{ij}$ and its inverse $g^{ij}$. The components of the metric tensor are defined by the inner product of the tangent basis vectors, $g_{ij} = \\mathbf{e}_i \\cdot \\mathbf{e}_j$, where $\\mathbf{e}_i = \\frac{\\partial \\mathbf{R}}{\\partial u^i}$.\n\nFirst, we compute the tangent basis vectors:\n$$\n\\mathbf{e}_{\\alpha} = \\frac{\\partial \\mathbf{R}}{\\partial \\alpha} = a \\begin{pmatrix} -\\sin\\alpha \\cos\\beta \\\\ \\cos\\alpha \\cos\\beta \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\beta} = \\frac{\\partial \\mathbf{R}}{\\partial \\beta} = a \\begin{pmatrix} -\\cos\\alpha \\sin\\beta \\\\ -\\sin\\alpha \\sin\\beta \\\\ \\cos\\beta \\end{pmatrix}\n$$\nNow, we compute the components of the metric tensor $g_{ij}$ by taking the dot products:\n$$\ng_{\\alpha\\alpha} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\alpha} = a^2 \\left( (-\\sin\\alpha \\cos\\beta)^2 + (\\cos\\alpha \\cos\\beta)^2 + 0^2 \\right) = a^2 \\cos^2\\beta (\\sin^2\\alpha + \\cos^2\\alpha) = a^2 \\cos^2\\beta\n$$\n$$\ng_{\\beta\\beta} = \\mathbf{e}_{\\beta} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\cos\\alpha \\sin\\beta)^2 + (-\\sin\\alpha \\sin\\beta)^2 + (\\cos\\beta)^2 \\right) = a^2 \\left( \\sin^2\\beta (\\cos^2\\alpha + \\sin^2\\alpha) + \\cos^2\\beta \\right) = a^2 (\\sin^2\\beta + \\cos^2\\beta) = a^2\n$$\n$$\ng_{\\alpha\\beta} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\sin\\alpha\\cos\\beta)(-\\cos\\alpha\\sin\\beta) + (\\cos\\alpha\\cos\\beta)(-\\sin\\alpha\\sin\\beta) + 0 \\right) = a^2(\\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta - \\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta) = 0\n$$\nSince $g_{\\alpha\\beta} = g_{\\beta\\alpha}$, the metric tensor is diagonal:\n$$\ng_{ij} = \\begin{pmatrix} g_{\\alpha\\alpha}  g_{\\alpha\\beta} \\\\ g_{\\beta\\alpha}  g_{\\beta\\beta} \\end{pmatrix} = \\begin{pmatrix} a^2 \\cos^2\\beta  0 \\\\ 0  a^2 \\end{pmatrix}\n$$\nThe inverse metric tensor $g^{ij}$ is the matrix inverse of $g_{ij}$. For a diagonal matrix, the inverse is found by taking the reciprocal of each diagonal element:\n$$\ng^{ij} = \\begin{pmatrix} \\frac{1}{g_{\\alpha\\alpha}}  0 \\\\ 0  \\frac{1}{g_{\\beta\\beta}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{a^2 \\cos^2\\beta}  0 \\\\ 0  \\frac{1}{a^2} \\end{pmatrix}\n$$\nThus, $g^{\\alpha\\alpha} = \\frac{1}{a^2 \\cos^2\\beta}$, $g^{\\beta\\beta} = \\frac{1}{a^2}$, and $g^{\\alpha\\beta} = g^{\\beta\\alpha} = 0$.\n\nNext, we calculate the Christoffel symbols of the second kind, $\\Gamma^k_{ij}$, using the formula:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{li}}{\\partial u^j} + \\frac{\\partial g_{lj}}{\\partial u^i} - \\frac{\\partial g_{ij}}{\\partial u^l} \\right)\n$$\nwhere a sum over the index $l \\in \\{\\alpha, \\beta\\}$ is implied. First, we need the partial derivatives of the metric components with respect to the coordinates $\\alpha$ and $\\beta$:\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\beta\\beta}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\alpha} = 0\n$$\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2 \\cos^2\\beta) = a^2 (2\\cos\\beta)(-\\sin\\beta) = -2a^2 \\sin\\beta \\cos\\beta\n$$\n$$\n\\frac{\\partial g_{\\beta\\beta}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2) = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\beta} = 0\n$$\nThe only non-zero partial derivative is $\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta}$. This greatly simplifies the calculations.\n\nLet's compute the non-zero Christoffel symbols:\n- $\\Gamma^k_{\\alpha\\alpha} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} + \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l} \\right) = -\\frac{1}{2} g^{kl} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l}$.\n  For $k=\\alpha$: $\\Gamma^{\\alpha}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\alpha\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left(g^{\\alpha\\alpha}(0) + 0 \\right) = 0$.\n  For $k=\\beta$: $\\Gamma^{\\beta}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\beta\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left( 0 + \\frac{1}{a^2} (-2a^2 \\sin\\beta \\cos\\beta) \\right) = \\sin\\beta \\cos\\beta$.\n\n- $\\Gamma^k_{\\beta\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\beta}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right) = \\frac{1}{2} g^{kl} \\left( 2\\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right)$.\n  Since $g_{l\\beta}$ is non-zero only for $l=\\beta$, and $\\frac{\\partial g_{\\beta\\beta}}{\\partial u^l}=0$ for all $l$, all terms are zero. So $\\Gamma^k_{\\beta\\beta} = 0$ for $k = \\alpha, \\beta$.\n\n- $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\beta}}{\\partial u^l} \\right)$. Since $g_{\\alpha\\beta}=0$ and $\\frac{\\partial g_{l\\beta}}{\\partial \\alpha}=0$ for all $l$, this simplifies to $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\frac{\\partial g_{l\\alpha}}{\\partial \\beta}$.\n  For $k=\\alpha$: $\\Gamma^{\\alpha}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\alpha\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{1}{2} \\left( \\frac{1}{a^2 \\cos^2\\beta} \\right) (-2a^2 \\sin\\beta \\cos\\beta) = -\\frac{\\sin\\beta \\cos\\beta}{\\cos^2\\beta} = -\\tan\\beta$.\n  For $k=\\beta$: $\\Gamma^{\\beta}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\beta\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} (0 + 0) = 0$.\n\nBy symmetry, $\\Gamma^k_{ji} = \\Gamma^k_{ij}$, so $\\Gamma^{\\alpha}_{\\beta\\alpha} = \\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta$.\nThe non-zero Christoffel symbols are:\n$$\n\\Gamma^{\\beta}_{\\alpha\\alpha} = \\sin\\beta \\cos\\beta\n$$\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = \\Gamma^{\\alpha}_{\\beta\\alpha} = -\\tan\\beta\n$$\nThese are functions of $\\beta$ and are non-zero for any $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$ except $\\beta=0$. This demonstrates that they are indeed non-zero functions on the patch.\n\nNow, we write the expression for the covariant derivative of a contravariant vector field $v^i$, $\\nabla_j v^i$. The general formula is:\n$$\n\\nabla_j v^i = \\frac{\\partial v^i}{\\partial u^j} + \\Gamma^i_{jk} v^k\n$$\nWe are asked for $\\nabla_{\\alpha} v^{\\alpha}$. In this case, $j=\\alpha$ and $i=\\alpha$. The expression becomes:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha k} v^k\n$$\nExpanding the sum over the index $k \\in \\{\\alpha, \\beta\\}$:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha\\alpha} v^{\\alpha} + \\Gamma^{\\alpha}_{\\alpha\\beta} v^{\\beta}\n$$\nSubstituting the Christoffel symbols we derived:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + (0) v^{\\alpha} + (-\\tan\\beta) v^{\\beta} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} - v^{\\beta} \\tan\\beta\n$$\nThis expression explicitly shows the role of the Christoffel symbols. The term $-v^{\\beta}\\tan\\beta$ is the correction to the partial derivative $\\frac{\\partial v^{\\alpha}}{\\partial \\alpha}$ that accounts for the curvature of the manifold and the non-orthonormal nature of the local coordinate system projection. In numerical discretizations, this \"fictitious force\" term is crucial for accurately representing particle or fluid motion on the curved surface.\n\nFinally, the problem asks for the exact closed-form expression for the Christoffel symbol $\\Gamma^{\\alpha}_{\\alpha\\beta}$. As derived above, this is:\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta\n$$",
            "answer": "$$\n\\boxed{-\\tan\\beta}\n$$"
        },
        {
            "introduction": "A successful numerical model must do more than just represent the geometry and calculus correctly; it must also uphold fundamental physical principles like the conservation of mass, energy, and momentum. In finite-volume methods, this is achieved by ensuring that the flux of a quantity out of one cell is exactly equal to the flux into its neighbor. This exercise  tackles a classic challenge in implementing conservative schemes on a cubed-sphere grid: how to handle fluxes at the corners where multiple grid panels meet. You will derive a systematic method for partitioning corner fluxes, ensuring local and global conservation while maintaining the formal accuracy of the numerical scheme.",
            "id": "4029407",
            "problem": "Consider a finite-volume discretization of a scalar tracer flux on the sphere used in Numerical Weather Prediction (NWP) and climate modeling, implemented on a cubed-sphere grid. At a cube corner mapped to the sphere, three panels meet at a common point. Denote the three panel-edge segments incident at this corner by indices $i \\in \\{1,2,3\\}$, with outward-pointing unit tangent directions along each edge and outward unit normals defined along the boundary orientation for each panel. Let the physical geodesic lengths of these edge segments be $\\ell_{i}$, computed from local curvilinear metrics and the grid spacings, specifically $\\ell_{i} = a\\,h_{\\text{edge},i}\\,\\Delta\\lambda_{i}$, where $a$ is Earth’s mean spherical radius, $h_{\\text{edge},i}$ is the line-element metric coefficient associated with the corresponding gnomonic (cubed-sphere) panel coordinate, and $\\Delta\\lambda_{i}$ is the corresponding computational grid spacing along the edge’s parameter.\n\nSuppose the boundary flux integral for each panel cell is approximated to second order using the composite trapezoidal rule along its edges. For the edge segments incident at the corner, this rule introduces endpoint contributions proportional to the corner flux density value $q_{C}$ (the scalar flux density evaluated at the corner). Because the corner is shared by three panels, naive summation of panel-local edge integrals leads to triple counting of the corner contribution. To prevent double or triple counting while maintaining second-order accuracy and global conservation, define panel-local corner allocations by introducing dimensionless weights $w_{i}$ that partition the unique corner contribution among the three incident edges. The weights must satisfy the following constraints:\n- The weights must form a partition of unity: $\\sum_{i=1}^{3} w_{i} = 1$.\n- The assembled boundary integral for the union of the three adjacent cells must be second-order accurate for any scalar flux density that is locally linear near the corner (that is, exact for functions of the form $q(s) = q_{C} + \\beta\\,s$ along each edge’s arclength $s$ measured from the corner).\n- The partition must be conservative and symmetric with respect to edge scaling implied by the curvilinear metrics (that is, it must not depend on arbitrary panel labeling and must vary smoothly as the edge lengths $\\ell_{i}$ vary).\n\nStarting from the surface divergence theorem and the definition of the composite trapezoidal rule, derive a second-order accurate edge-to-cell flux matching method at the corner that avoids double counting by partitioning the corner contribution using consistent weights. Express the weights $w_{i}$ in closed form in terms of the incident edge lengths $\\ell_{i}$ only.\n\nYour final answer must be a single closed-form analytical expression for the weights written as a $1\\times 3$ row matrix using the LaTeX `pmatrix` environment. No numerical rounding is required. Do not include units in your final boxed answer.",
            "solution": "The user wants to solve the problem by following these steps:\n1.  Validate the problem statement.\n2.  If valid, provide a reasoned solution.\n3.  Format the entire output following strict rules (XML tags, LaTeX, no Markdown headers).\n\n### Step 1: Extract Givens\n-   **System**: Finite-volume discretization of a scalar tracer flux on a cubed-sphere grid.\n-   **Geometry**: A corner where three panels meet, with three incident panel-edge segments indexed by $i \\in \\{1, 2, 3\\}$.\n-   **Edge Lengths**: Physical geodesic lengths $\\ell_i$.\n-   **Numerical Method**: Boundary flux integrals are approximated using the composite trapezoidal rule, which is described as being second-order accurate.\n-   **Flux at Corner**: The scalar flux density at the corner is denoted $q_C$.\n-   **Goal**: Derive dimensionless weights $w_i$ for partitioning the corner flux contribution.\n-   **Constraints on Weights $w_i$**:\n    1.  Partition of unity: $\\sum_{i=1}^{3} w_{i} = 1$.\n    2.  Second-order accuracy: The assembled numerical scheme must be exact for any scalar flux density $q(s)$ that is locally linear along each edge, i.e., $q(s) = q_C + \\beta s$, where $s$ is the arclength from the corner.\n    3.  Symmetry and Conservatism: The weights should depend symmetrically on the edge lengths $\\ell_i$ and be independent of arbitrary labeling.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is well-grounded in the field of numerical modeling for weather and climate, specifically concerning grid discretizations (cubed-sphere) and numerical methods (finite volume, trapezoidal rule). The challenges of flux calculations at grid corners are a standard topic in this domain.\n-   **Well-Posed**: The problem is well-posed. It asks for a specific set of functions (the weights $w_i$) based on a clear set of mathematical constraints. The constraints appear sufficient to determine a unique solution.\n-   **Objective**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. It describes a standard problem in designing high-order, conservative numerical schemes on complex grids. I will now proceed with the derivation.\n\n### Derivation of the Weights\n\nThe problem requires the derivation of weights $w_i$ to partition the contribution of the corner flux density $q_C$ to the boundary flux integrals of adjacent cells. The method must be conservative and second-order accurate, which is defined as being exact for locally linear flux distributions.\n\nLet us consider an edge segment $i$ of length $\\ell_i$ originating from the corner $C$ (where arclength $s=0$) and ending at a neighboring grid point $N_i$ (where $s=\\ell_i$). The flux integral along this edge is $I_i = \\int_0^{\\ell_i} q(s) ds$.\n\nThe problem states that a naive application of the trapezoidal rule leads to counting issues. To resolve this, we are to construct a method that partitions the \"unique corner contribution.\" We interpret this as follows: First, we define a total corner flux contribution, $Q_C$, based on the baseline trapezoidal rule. Second, we partition this total contribution among the three incident edges using the weights $w_i$.\n\nThe contribution of the corner point $C$ to the trapezoidal rule approximation of the flux on edge $i$ is $\\frac{1}{2}\\ell_i q_C$. The \"unique corner contribution\" to be partitioned, $Q_C$, can be defined as the sum of these contributions over all three incident edges:\n$$\nQ_C = \\sum_{j=1}^{3} \\frac{1}{2}\\ell_j q_C = \\frac{1}{2} (\\ell_1 + \\ell_2 + \\ell_3) q_C\n$$\nThe new method allocates a portion $w_i Q_C$ of this total contribution to the flux integral of edge $i$. The contribution from the other endpoint, $N_i$, remains as in the standard trapezoidal rule, which is $\\frac{1}{2}\\ell_i q_{N_i}$, where $q_{N_i} = q(\\ell_i)$.\n\nThus, the modified numerical flux integral for edge $i$, denoted $\\tilde{I}_i$, is given by:\n$$\n\\tilde{I}_i = w_i Q_C + \\frac{\\ell_i}{2} q_{N_i}\n$$\nSubstituting the expression for $Q_C$, we have:\n$$\n\\tilde{I}_i = w_i \\left( \\frac{1}{2} \\sum_{j=1}^{3} \\ell_j \\right) q_C + \\frac{\\ell_i}{2} q_{N_i}\n$$\nNow, we enforce the second-order accuracy constraint, which requires this rule to be exact for any locally linear flux density. Let the flux density along edge $i$ be $q(s) = q_C + \\beta_i s$ for some constant $\\beta_i$.\n\nThe exact integral $I_i$ is:\n$$\nI_i = \\int_0^{\\ell_i} (q_C + \\beta_i s) ds = q_C \\ell_i + \\frac{1}{2} \\beta_i \\ell_i^2\n$$\nThe value of the flux density at the endpoint $N_i$ is $q_{N_i} = q(\\ell_i) = q_C + \\beta_i \\ell_i$. Substituting this into our expression for the numerical flux $\\tilde{I}_i$:\n$$\n\\tilde{I}_i = w_i \\left( \\frac{1}{2} \\sum_{j=1}^{3} \\ell_j \\right) q_C + \\frac{\\ell_i}{2} (q_C + \\beta_i \\ell_i) = \\left[ w_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) + \\frac{\\ell_i}{2} \\right] q_C + \\frac{1}{2} \\beta_i \\ell_i^2\n$$\nFor the numerical method to be exact for this linear function, we must have $\\tilde{I}_i = I_i$. Comparing the expressions for $\\tilde{I}_i$ and $I_i$, the terms involving $\\beta_i$ already match. The equality must hold for any value of $q_C$, so the coefficients of $q_C$ must be equal:\n$$\nw_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) + \\frac{\\ell_i}{2} = \\ell_i\n$$\nWe solve this equation for the weight $w_i$:\n$$\nw_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) = \\ell_i - \\frac{\\ell_i}{2} = \\frac{\\ell_i}{2}\n$$\n$$\nw_i \\left(\\sum_{j=1}^{3} \\ell_j\\right) = \\ell_i\n$$\nThis gives the closed-form expression for the weights:\n$$\nw_i = \\frac{\\ell_i}{\\ell_1 + \\ell_2 + \\ell_3}\n$$\nWe check the other constraints.\n1.  **Partition of Unity**: The sum of the weights is $\\sum_{i=1}^{3} w_i = \\sum_{i=1}^{3} \\frac{\\ell_i}{\\ell_1 + \\ell_2 + \\ell_3} = \\frac{\\ell_1 + \\ell_2 + \\ell_3}{\\ell_1 + \\ell_2 + \\ell_3} = 1$. This constraint is satisfied.\n2.  **Symmetry and Conservatism**: The formula for $w_i$ depends symmetrically on the lengths of the other edges (via the sum in the denominator) and smoothly on all $\\ell_i$. It is expressed purely in terms of the physical edge lengths as required.\n\nThe weights represent the proportion of each edge's length relative to the total length of the three incident edges. The formulation provides a systematic way to justify the flux calculation that resolves the \"counting\" ambiguity mentioned in the problem, ensuring the resulting scheme is conservative and second-order accurate. An interesting consequence is that substituting these weights back into the proposed formula for $\\tilde{I}_i$ recovers the standard trapezoidal rule expression for the flux on edge $i$: $\\tilde{I}_i = \\frac{\\ell_i}{2} q_C + \\frac{\\ell_i}{2} q_{N_i}$. The derivation shows that this standard rule is the unique method within the proposed family of weighted partitioning schemes that satisfies the second-order accuracy requirement.\n\nThe final answer is the set of weights $\\{w_1, w_2, w_3\\}$ expressed as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\ell_1}{\\ell_1 + \\ell_2 + \\ell_3}  \\frac{\\ell_2}{\\ell_1 + \\ell_2 + \\ell_3}  \\frac{\\ell_3}{\\ell_1 + \\ell_2 + \\ell_3}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}