## 应用与跨学科联系

在前面的章节中，我们已经探讨了垂直[坐标变换](@entry_id:172727)的基本原理和机制。掌握了这些核心概念之后，我们现在将视野转向更广阔的应用领域，考察这些原理如何在多样化的真实世界和跨学科背景下发挥作用。本章的目的不是重复讲授核心原理，而是在一系列以应用为导向的情境中，展示这些原理的实用性、扩展性及其在不同领域的整合方式。

[垂直坐标系](@entry_id:1133787)的选择远非一个纯粹的数学练习；它构成了[数值天气预报](@entry_id:191656)（NWP）、气候模拟和[海洋环流](@entry_id:195237)模型设计的基石。每种坐标系都代表了一系列关于如何最好地表征物理过程、边界条件和[数值稳定性](@entry_id:175146)的权衡。本章将通过剖析这些权衡，揭示从基础的地形表示到高级的数据同化等一系列应用中垂直坐标变换的核心作用。

### 大气与海洋模型中的核心应用

垂直坐标变换最直接的应用体现在大气和[海洋环流](@entry_id:195237)模型（GCMs）的动力核心设计中。这些模型的性能和保真度在很大程度上取决于坐标系如何处理复杂的下垫面地形以及流体内部的稳定分层。

#### 地形、边界与[坐标几何](@entry_id:163179)

数值模型的一个基本挑战是如何在离散的网格上准确地表示地球表面复杂的山脉和海床地形。地形追随坐标系，尤其是经典的“sigma”（$\sigma$）坐标系，为此提供了一个优雅的解决方案。通过将随空间变化的物理域 $[p_t, p_s(x,y)]$（其中 $p_t$ 是模式顶气压，$p_s$ 是地表气压）映射到一个归一化的计算域（例如 $[0,1]$），模型可以自然地处理地形起伏。

在这种坐标系中，恒定的 $\sigma$ 坐标面在物理空间中的几何高度会随地形变化。例如，在一个追压 sigma 坐标系中，坐标面的气压 $p$ 是地表气压 $p_s$ 的函数，例如：
$$ p(x,y,z)|_{\sigma=\text{const}} = p_t + \sigma (p_s(x,y) - p_t) $$
根据[静力平衡](@entry_id:163498)关系，地表海拔更高的地方（如山顶），其上方的气柱较短，因此地表气压 $p_s$ 较低。相应地，一个恒定的 $\sigma$ 面在山顶上方的气压也较低，这意味着它的几何高度相对于周围地区会更高。因此，$\sigma$ 坐标面会随着下垫面地形的起伏而“隆起”或“下陷”，从而使模型能够平滑地模拟跨越山脉的气流 。

将这一概念扩展到[海洋学](@entry_id:149256)领域，垂直坐标的选择呈现出更为复杂的权衡。[海洋环流](@entry_id:195237)模型（OGCMs）面临着表征陡峭的海底山脉和维持海洋内部精细密度分层（温盐结构）的双重挑战。三种经典的坐标系代表了不同的设计哲学：

1.  **Z坐标（$z$-level）**：坐标面是固定的几何深度面（水平面）。其优点是水平压力[梯度力](@entry_id:166847)的计算非常简单直接。然而，它的主要缺点在于，倾斜的海底地形被表示为一系列不平滑的“阶梯”，这严重扭曲了近底边界层的流动模拟，并可能导致虚假的数值混合。

2.  **Sigma坐标（$\sigma$-coordinate）**：与大气模型类似，坐标面会从海面延伸至海底，精确地贴合地形。这使得它在解析近底边界层和斜坡流方面表现出色。然而，其致命弱点在于，当坐标面在陡峭地形上倾斜时，计算水平压力[梯度力](@entry_id:166847)会产生巨大的“压力[梯度力](@entry_id:166847)误差”（Pressure Gradient Force, PGF Error），我们将在稍后详细讨论。

3.  **Isopycnal坐标（等密度面坐标）**：坐标面是恒定密度（或位密）的面。由于海洋中的流动在很大程度上是沿着等密度面进行的，这种坐标系能极大地减少虚假的跨等密度面数值混合，从而在长期气候模拟中能更好地保持水团特性。然而，它的困难在于处理弱分层区域（如[海洋混合层](@entry_id:1129065)），在这些区域等密度面可能会变得垂直或“露头”于海面，导致数值困难。此外，由于等密度面与海底不重合，其对近底边界层的表征也存在问题 。

一个关于地形追随坐标系的微妙但重要的推论是，即使存在物理上的垂直运动，位于下边界（如海底）上的流体[质点](@entry_id:186768)在其自身坐标系中的垂直速度也为零。例如，在海洋的 $\sigma$ 坐标系中，底部边界被定义为 $\sigma = -1$。由于这是一个不透水的物质表面，流体质点不能穿越它，因此根据定义，其在 $\sigma$ 坐标系中的垂直速度 $\omega_b = d\sigma/dt|_{\sigma=-1}$ 必须为零。然而，这并不意味着物理垂直速度 $w$ 为零。当存在沿斜坡的流动时（例如，速度为 $u_b$ 的流体流过坡度为 $H_x$ 的海底），运动学边界条件要求物理垂直速度 $w_b = -u_b H_x$。坐标变换框架将这种物理上的垂直运动完全吸收到了度量项的计算中，从而在变换后的坐标系中得到一致的零垂直速度 。

#### 变量的变换与诊断

垂直坐标的变换不仅影响模型的几何结构，也深刻地改变了我们诊断和解释物理变量的方式，尤其是垂直速度。在大气科学中，我们通常区分两种垂直速度：几何垂直速度 $w = Dz/Dt$ (单位 $\mathrm{m\,s^{-1}}$) 和气压垂直速度 $\omega = Dp/Dt$ (单位 $\mathrm{Pa\,s^{-1}}$)。

在[静力平衡](@entry_id:163498)的大气中，这两者通过静力关系 $dp/dz = -\rho g$ 联系起来。可以推导出它们之间的近似关系：
$$ w \approx -\frac{\omega R_d T_v}{pg} $$
其中 $T_v$ 是[虚温](@entry_id:1133832)，$R_d$ 是干空气气体常数。这个关系式揭示了几个关键点。首先，由于气压随高度增加而减小，上升运动（$w > 0$）对应于气块移动到气压更低的区域，因此其气压随时间减小，即 $\omega  0$。反之，下沉运动对应 $\omega > 0$。

其次，两者之间的[转换因子](@entry_id:142644)不是常数，它依赖于当地的气压 $p$ 和温度 $T_v$。这一依赖性具有重要的物理含义。对于典型的天气尺度系统，如温带气旋中的大范围缓和上升运动，其中层的 $\omega$ 值可能在 $-0.1\,\mathrm{Pa\,s^{-1}}$ 左右，这对应于大约 $1-2\,\mathrm{cm\,s^{-1}}$ 的几何上升速度 。然而，在中小尺度的强对流系统（如雷暴）中，几何上升速度 $w$ 可达 $10-20\,\mathrm{m\,s^{-1}}$ 或更高。同样的 $w$ 值，在对流层低层（如 $p=900\,\mathrm{hPa}$）和高层（如 $p=200\,\mathrm{hPa}$）所对应的 $\omega$ 值会相差巨大。由于 $|\omega|$ 对 $p$ 的正比关系，一个在整个对流层中具有恒定几何上升速度的强上升气流，在气压坐标的诊断图上，其低层的 $\omega$ 值将远大于高层。因此，在解释和比较不同高度或不同动力过程的垂直运动时，必须仔细考虑这种依赖于状态的转换关系 。

#### 压力[梯度力](@entry_id:166847)误差的挑战

如前所述，地形追随坐标系虽然优雅地解决了地形表征问题，却引入了一个严重的数值顽疾——压力[梯度力](@entry_id:166847)（PGF）误差。在 $z$ 坐标系中，水平压力[梯度力](@entry_id:166847)被简单地计算为 $-\frac{1}{\rho}\nabla_z p$。但在变换到地形追随坐标系（如 $\sigma$）后，通过链式法则，这一项会分解为两个部分：
$$ -\frac{1}{\rho} \nabla_z p = -\frac{1}{\rho} \left( \nabla_\sigma p - \frac{\partial p}{\partial \sigma} \frac{1}{(\partial z / \partial \sigma)} \nabla_\sigma z \right) $$
在[静力平衡](@entry_id:163498)的条件下，这可以写成两个力项的加和。在陡峭地形区域，坐标面倾斜严重，导致这两个项都变得非常大，但它们的符号相反，其差值应该很小。在连续的数学推导中，这种抵消是精确的。然而，在离散的数值计算中，由于[截断误差](@entry_id:140949)、变量在网格上交错存储以及插值方案的不一致性，这两个大项的计算都存在误差。当两个大数相减以得到一个小数时，其计算结果中的[相对误差](@entry_id:147538)会被急剧放大。这种不完全的抵消导致了一个虚假的、不为零的残余力，即 PGF 误差 。

这种虚假的力可以在一个原本静止、水平分层的流体中凭空制造出环流，严重破坏模拟的准确性。我们可以通过一个数值实验来诊断这种误差：在一个具有地形但初始场为静止、等温（因此在 $z$ 坐标系中无水平压力梯度）的大气中运行模型。在理想情况下，大气应保持静止。然而，由于 PGF 误差的存在，模型会产生虚假的水平加速度，并随时间积分产生虚假的动能。通过监测这种虚假加速度的均方根和最大值，或者初始动能的增长率，可以定量评估不同垂直坐标方案产生 PGF 误差的严重程度 。

#### 高级坐标设计：缓解PGF误差

为了克服 PGF 误差，研究者们开发了更为复杂的[垂直坐标系](@entry_id:1133787)。

**[混合坐标系](@entry_id:1126230)（Hybrid Coordinates）** 是目前主流大气模型中广泛采用的方案。其核心思想是结合地形追随坐标和纯气压坐标的优点。坐标面在靠近地表的低层是地形追随的，以准确解析边界层过程，然后平滑地过渡到模式中高层的纯气压面。这种过渡是通过引入[混合系数](@entry_id:1127968)函数 $A(\eta)$ 和 $B(\eta)$ 来实现的，其压力定义为 $p(\eta) = A(\eta) + B(\eta)p_s$。通过精心设计 $A(\eta)$ 和 $B(\eta)$ 的形式（例如，在模式顶部 $B(0)=0$，在底部 $B(1)=1$），可以控制坐标面从地形追随到纯气压面的过渡行为。由于模式中高层的坐标面是水平的，PGF 计算中的两个大项之一（与坐标面坡度相关的项）趋于零，从而显著减小了 PGF 误差 。

**平滑层垂直坐标（SLEVE）** 则是一种更进一步的精细化设计。它认识到 PGF 误差主要由中小尺度的陡峭地形引起。SLEVE 坐标通过对地形进行尺度分解，将其分为大尺度分量 $h_1(x,y)$ 和小尺度分量 $h_2(x,y)$。然后，对这两个地形分量应用不同的、随高度变化的权重函数 $f_1(\eta)$ 和 $f_2(\eta)$。通常，小尺度地形的权重会随高度更快地衰减。其[坐标映射](@entry_id:747874)形式为
$$ z(x,y,\eta) = \eta H + h_1(x,y)f_1(\eta) + h_2(x,y)f_2(\eta) $$
这种设计使得坐标面的坡度，特别是受中小尺度地形影响的坡度，在离开地表后能迅速减小，从而更有效地抑制 PGF 误差 。定量分析表明，相较于传统的 $\sigma$ 坐标，SLEVE 坐标能够在同样的高度上，将由小尺度地形引起的坐标面坡度减小一个可观的量级，从而验证了其设计的有效性 。

### 与其他物理和数值原理的联系

[垂直坐标系](@entry_id:1133787)的选择并非孤立存在，它与模型中的其他核心组件，如物理过程[参数化](@entry_id:265163)、[时间积分](@entry_id:267413)方案和守恒定律的实现，紧密耦合。

#### [等熵坐标](@entry_id:1126753)：一种[拉格朗日视角](@entry_id:265471)

**[等熵坐标](@entry_id:1126753)（Isentropic Coordinates）**，即以位温 $\theta$ 作为垂直坐标，提供了一种与传统欧拉坐标系截然不同的视角。其最吸引人的特性是，在绝热无摩擦的流动中，等熵面是物质面。这意味着空气质块倾向于沿着恒定的 $\theta$ 面运动，而不会穿越它们。因此，在[等熵坐标](@entry_id:1126753)系中，垂直速度 $\dot{\theta} = D\theta/Dt$ 在[绝热过程](@entry_id:138150)中为零 。

这一特性为模拟大气中示踪物的输送带来了巨大优势。由于平流过程被限制在二维的等熵面上，极大地减少了因三维插值而产生的虚假数值扩散，从而能更准确地维持示踪物的梯度，这对于平流层化学和气候研究至关重要。此外，[等熵坐标](@entry_id:1126753)系能更自然地表征锋区等斜压结构，因为这些结构本质上是等熵面的密集区域。定量分析表明，在存在水平温度梯度的区域，由等熵面定义的层结厚度比由气压面定义的层结厚度表现出更小的水平变率，这反映了[等熵坐标](@entry_id:1126753)与大气的[热力学](@entry_id:172368)结构更为契合 。

然而，[等熵坐标](@entry_id:1126753)也面临着自身的挑战。首先，等熵面并不总是单调的，它们可能与地面相交（“露头”），特别是在冬季的锋区附近，这给边界条件的处理带来了复杂性。其次，非[绝热过程](@entry_id:138150)（如辐射加热、凝结潜热释放）在[等熵坐标](@entry_id:1126753)系中扮演了特殊的角色。根据[热力学第一定律](@entry_id:146485)，$\dot{\theta}$ 正比于[非绝热加热](@entry_id:1123650)率 $\dot{q}$。这意味着非绝热过程在[等熵坐标](@entry_id:1126753)的连续方程中表现为跨等熵面的质量通量——加热（冷却）相当于将质量从较低（较高）的 $\theta$ 层“泵”到较高（较低）的 $\theta$ 层。这与气压坐标系形成了鲜明对比，后者的连续方程中不显式包含非绝热项 。

#### 与时间积分方案和波动力学的相互作用

垂直坐标的选择对模型的动力核心，特别是时间积分方案的设计，有着深远的影响。大气中的声波和重力波[传播速度](@entry_id:189384)很快，对显式时间积分方案的稳定性构成了严格的CFL（[Courant-Friedrichs-Lewy](@entry_id:175598)）条件限制。

为了使用更大的时间步长，现代模型普遍采用半隐式或全[隐式时间积分](@entry_id:171761)方案，将与快波相关的线性项进行隐式处理。在这一背景下，**气压坐标（或[混合坐标](@entry_id:1126228)的高层部分）** 显示出巨大的计算优势。在[静力平衡](@entry_id:163498)假设下，气压坐标中的静力方程 $\partial \Phi / \partial p = -\alpha$ 是一个纯粹的垂直关系，不含水平度量项。这使得在求解半隐式方案所产生的椭圆型方程时，垂直方向的算子是列局地的（column-local）。这意味着整个三维问题可以分解为一系列水平方向的二维问题和大量独立的、一维的垂直问题。每个垂直问题通常表现为一个[三对角矩阵](@entry_id:138829)系统，可以被极其高效地求解。这种算子的可分离性是静力谱模式和许多静力格点模式高效运行的关键 。

相反，在地形追随的 $z$ 坐标系中，压力梯度和静力关系都包含了复杂的度量项，导致水平和垂直方向的算子紧密耦合，形成一个难以求解的三维隐式问题。此外，地形追随坐标系中倾斜的坐标面会耦合水平和垂直运动，可能增强数值刚度，从而对显式时间积分方案施加更严格的稳定性约束 。

另一个与波动力学相关的关键问题是虚假波反射。在模式顶部，需要设置一个吸收层或[辐射边界条件](@entry_id:1130494)来防止垂直传播的重力波在模式顶被反射回来，污染模式内部的解。[混合坐标系](@entry_id:1126230)的设计在这里也至关重要。从地形追随坐标到纯气压坐标的过渡必须足够平滑。如果[坐标映射](@entry_id:747874)的[雅可比矩阵](@entry_id:178326)（或其导数）在边界处存在不连续或急剧变化，就会造成[波阻抗](@entry_id:276571)的突变，从而导致强烈的虚假反射。因此，在设计混合坐标的[混合函数](@entry_id:746864) $S(\eta)$ 时，不仅要求 $S(0)=0, S(1)=1$，还常常要求其一阶甚至二阶导数在边界 $\eta=0$ 和 $\eta=1$ 处为零，以确保度量项的平滑过渡 。

#### [质量守恒](@entry_id:204015)与平流方案

质量守恒是气候模拟等长期积分中的一个基本要求。坐标变换本身并不破坏守恒性，但它与用于求解[物质输运](@entry_id:1132066)的平流方案相互作用，可能导致守恒问题。

半拉格朗日（Semi-Lagrangian, SL）平流方案因其允许使用大时间步长而不受CFL条件限制而被广泛使用。然而，标准的插值型SL方案本质上是不守恒的。为了在大范围模型中既利用SL方案的效率又确保[质量守恒](@entry_id:204015)，必须采用“守恒半拉格朗日”或“[通量形式](@entry_id:273811)半拉格朗日”方案。

在[混合坐标系](@entry_id:1126230)中，正确的做法是输运“层质量”这一量，即 $m = J \rho = -\frac{1}{g} \frac{\partial p}{\partial \eta}$。一个严格守恒的方案需要在[拉格朗日框架](@entry_id:751113)下重新构造通量。其核心思想是：对于每一个欧拉网格（到达网格），通过回溯计算找到其对应的、在上一时刻占据的流体区域（出发区域）。然后，通过积分计算出发区域内的总质量，并将这些质量重新分配（remap）到到达网格中。这一过程确保了在每一步输运中，总质量既不产生也不消失。最后，为了保持模型状态的[自洽性](@entry_id:160889)，必须根据更新后的全列[质量分布](@entry_id:158451)来诊断性地更新地表气压 $p_s$，因为全列总质量与地表气压通过静力关系 $(p_s - p_t)/g$ 严格绑定。这一过程完美地展示了垂直坐标、守恒定律和平流算法之间复杂的相互依赖关系 。

### 跨学科前沿：数据同化

垂直[坐标变换](@entry_id:172727)的应用并不仅限于模型自身的正向积分，它在数据同化领域同样扮演着至关重要的角色。数据同化是将[观测信息](@entry_id:165764)融合到数值模型中以产生对大气或海洋状态的最佳估计（分析场）的过程。

在同化卫星[辐射率](@entry_id:174256)等遥感数据时，一个关键步骤是构建所谓的“观测算子” $h_k$。这个算[子模](@entry_id:148922)拟了从模型状态变量 $x_k$ 到观测变量 $y_k$（例如，卫星传感器在不同通道测得的亮温）的完整物理和几何过程。模型[状态变量](@entry_id:138790)（如温度、湿度）通常定义在模型自身的[垂直坐标系](@entry_id:1133787)（如混合 $\eta$ 坐标）上。然而，用于计算[辐射率](@entry_id:174256)的[辐射传输模型](@entry_id:1130513)（RTM）通常需要输入大气廓线在纯气压坐标或光学深度坐标上。因此，观测算子 $h_k$ 的第一步必然是进行一次垂直[坐标变换](@entry_id:172727)：将模型格点上的变量插值到RTM所需的垂直坐标上。

在[变分同化](@entry_id:756436)（如4D-Var）或[集合卡尔曼滤波](@entry_id:166109)（EKF）等高级同化方法中，不仅需要[观测算子](@entry_id:752875) $h_k$ 本身，还需要它的线性化版本——[雅可比矩阵](@entry_id:178326)（或称切线性算子）$H_k$。这个矩阵 $H_k$ 描述了观测值对模型[状态变量](@entry_id:138790)微小变化的敏感度。因此，$H_k$ 必须包含坐标变换和插值过程的线性化。这个过程将模型原生坐标下的状态更新[信息传播](@entry_id:1126500)到观测所在的坐标系中，是实现模型与观测有效融合的关键环节。

此外，在评估观测误差协方差矩阵 $R_k$ 时，也必须考虑[坐标变换](@entry_id:172727)。所谓的“代表性误差”，即由于模型分辨率不足以解析卫星观测[视场](@entry_id:175690)内的次网格变率（如不均匀云层）所导致的误差，会通过辐射传输过程在不同通道间产生相关性。理解这些误差结构需要将模型和观测投影到一个共同的坐标框架（如气压坐标）下进行分析 。

### 结论

本章通过一系列应用案例，系统地展示了垂直[坐标变换](@entry_id:172727)在现代[地球系统模拟](@entry_id:203226)中的广度和深度。我们看到，从最基本的处理地形边界，到精确诊断物理变量，再到应对复杂的数值挑战如压力[梯度力](@entry_id:166847)误差和波反射，[垂直坐标系](@entry_id:1133787)的选择无处不在，并深刻影响着模型的行为。

我们进一步探讨了其与模型其他核心组件的跨领域联系，包括与海洋学中的坐标选择、与动力核心中时间积分方案的耦合、与输运方案中[质量守恒](@entry_id:204015)的实现，以及在数据同化中连接模型与观测的桥梁作用。

最终，本章揭示的核心思想是：不存在一个普适的“最佳”[垂直坐标系](@entry_id:1133787)。每一种选择都是在对物理过程的保真度、数值计算的准确性与效率、以及与其他模型组件的兼容性之间进行精心权衡的结果。理解这些权衡是高级数值建模和数据分析的关键能力，也是推动下一代[地球系统模型](@entry_id:1124096)发展的核心挑战之一。