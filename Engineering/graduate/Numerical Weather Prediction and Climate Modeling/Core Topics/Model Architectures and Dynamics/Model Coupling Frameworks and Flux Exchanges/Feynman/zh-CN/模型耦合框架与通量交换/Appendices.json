{
    "hands_on_practices": [
        {
            "introduction": "耦合器的核心功能是交换物理上有意义的量，例如动量、热量和质量通量。这个练习聚焦于海-气界面的动量通量，这是理解和模拟大气与海洋动态相互作用的基础。通过这个练习，我们将实践如何使用在气候模式中广泛应用的边界层参数化方案——块体动力学公式，来计算这一关键通量。",
            "id": "4064565",
            "problem": "考虑一个数值天气预报（NWP）系统中的耦合大气-海洋交换模块，其中大气分量提供参考风速，并通过耦合器从海洋表面接收由此产生的动量通量。在地表层中性大气稳定度下，水平均匀定常流满足雷诺平均动量平衡和莫宁-奥布霍夫相似理论（MOST）。MOST理论指出，平均风廓线遵循对数律，其粗糙度长度由海面性质决定。中性拖曳系数 $C_D$ 通过块体空气动力学公式将近地表风与界面应力联系起来，而界面动量通量（切向应力）$\\tau$ 则通过耦合器传递给大气的下边界条件。\n\n使用与对数律一致的中性地表层块体参数化方案，计算以下情景中的中性拖曳系数 $C_D$ 和动量通量 $\\tau$：\n- 参考高度 $z=10\\,\\mathrm{m}$，\n- 空气动力学粗糙度长度 $z_0=1.5\\times 10^{-4}\\,\\mathrm{m}$，\n- 冯·卡门常数 $\\kappa=0.4$，\n- 空气密度 $\\rho_a=1.2\\,\\mathrm{kg\\,m^{-3}}$，\n- $z$ 高度处的风速，$U=12\\,\\mathrm{m\\,s^{-1}}$。\n\n假设耦合器使用中性拖曳公式 $C_D=\\kappa^2/\\left(\\ln\\!\\left(z/z_0\\right)\\right)^2$，并且应力由块体关系 $\\tau=\\rho_a\\,C_D\\,U^2$ 给出。将您的答案四舍五入至四位有效数字。最终应力以 $\\mathrm{N\\,m^{-2}}$ 为单位表示。",
            "solution": "对问题陈述进行评估，认定其有效。它在科学上基于边界层气象学的原理，特别是针对中性大气地表层的莫宁-奥布霍夫相似理论（MOST）。该问题是适定的，为得到唯一解提供了所有必要的参数和公式。给定的数值在物理上是真实的，术语是精确和客观的。\n\n目标是使用所提供的公式和数据，计算中性拖曳系数 $C_D$ 和动量通量 $\\tau$。\n\n首先，我们计算中性拖曳系数 $C_D$。问题中提供了从中性条件下的对数风廓线推导出的公式：\n$$C_D = \\frac{\\kappa^2}{\\left(\\ln\\left(\\frac{z}{z_0}\\right)\\right)^2}$$\n给定的参数如下：\n- 冯·卡门常数，$\\kappa = 0.4$\n- 参考高度，$z = 10\\,\\mathrm{m}$\n- 空气动力学粗糙度长度，$z_0 = 1.5 \\times 10^{-4}\\,\\mathrm{m}$\n\n我们首先计算参考高度与粗糙度长度之比：\n$$\\frac{z}{z_0} = \\frac{10\\,\\mathrm{m}}{1.5 \\times 10^{-4}\\,\\mathrm{m}} = \\frac{10}{0.00015} \\approx 66666.67$$\n接下来，我们取该比值的自然对数：\n$$\\ln\\left(\\frac{z}{z_0}\\right) = \\ln\\left(\\frac{10}{1.5 \\times 10^{-4}}\\right) \\approx 11.107409$$\n现在，我们可以将 $\\kappa$ 和对数值代入 $C_D$ 的公式中：\n$$C_D = \\frac{(0.4)^2}{\\left(\\ln\\left(\\frac{10}{1.5 \\times 10^{-4}}\\right)\\right)^2} \\approx \\frac{0.16}{(11.107409)^2} \\approx \\frac{0.16}{123.37453}$$\n这给出了拖曳系数的值：\n$$C_D \\approx 0.00129686$$\n四舍五入到四位有效数字，我们得到：\n$$C_D \\approx 1.297 \\times 10^{-3}$$\n请注意，$C_D$ 是一个无量纲量。\n\n其次，我们计算动量通量，也称为地表应力，$\\tau$。问题中提供了块体空气动力学公式：\n$$\\tau = \\rho_a C_D U^2$$\n给定的参数如下：\n- 空气密度，$\\rho_a = 1.2\\,\\mathrm{kg\\,m^{-3}}$\n- $z$ 高度处的风速，$U = 12\\,\\mathrm{m\\,s^{-1}}$\n\n在中间步骤中使用未四舍五入的 $C_D$ 值以获得更高的精度，我们将这些值代入 $\\tau$ 的公式中：\n$$\\tau \\approx (1.2\\,\\mathrm{kg\\,m^{-3}}) \\times (0.00129686) \\times (12\\,\\mathrm{m\\,s^{-1}})^2$$\n$$\\tau \\approx 1.2 \\times 0.00129686 \\times 144 \\, \\mathrm{kg\\,m^{-1}\\,s^{-2}}$$\n$$\\tau \\approx 0.224115\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$$\n单位 $\\mathrm{kg\\,m^{-1}\\,s^{-2}}$ 等效于 $\\mathrm{N\\,m^{-2}}$（帕斯卡），这是应力或压力的标准单位。\n按照要求将最终结果四舍五入到四位有效数字：\n$$\\tau \\approx 0.2241\\,\\mathrm{N\\,m^{-2}}$$\n\n计算出的值为中性拖曳系数 $C_D \\approx 1.297 \\times 10^{-3}$ 和动量通量 $\\tau \\approx 0.2241\\,\\mathrm{N\\,m^{-2}}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.297 \\times 10^{-3} & 0.2241 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在一个耦合系统中，能量守恒是至高无上的原则。本练习将探讨地表能量收支残差的概念，这是评估耦合模型保真度的关键诊断工具。通过计算这个残差，我们可以判断交换的通量是否构成了一个封闭且物理上一致的系统，并识别出潜在的模型不自洽问题。",
            "id": "4064509",
            "problem": "考虑一个数值天气预报模型中的单向耦合的陆-气交换，其中陆面模型向大气模型提供感热和潜热的湍流热通量，而大气辐射方案向陆面提供辐射通量。这些模型通过一个守恒的通量交换进行耦合，使用了诸如 Ocean Atmosphere Sea Ice Soil (OASIS) 框架或 Earth System Modeling Framework (ESMF) 等软件耦合器，但由于内部时间步长不同，这些通量在耦合间隔内进行了时间平均。\n\n从陆-气界面的能量守恒出发，一个持续时间为 $\\Delta t$ 的耦合间隔内的能量收支可以写成净辐射和解析通量以及任何地表层能量趋势项之间的平衡。令 $R_n$ 表示地表净辐射（向下为正），$Q_H$ 表示感热通量（向上为正），$Q_E$ 表示潜热通量（向上为正），$G$ 表示地（土壤）热通量（向下为正），以及 $S$ 表示地表层中能量的有效储存或趋势项（当能量在该层中累积时为正）。基本的能量守恒声明意味着，在 $\\Delta t$ 上积分，当 $R_n - (Q_H + Q_E + G) - S = 0$ 时，能量收支闭合。在实际的耦合积分中，将残差 $R$ 定义为耦合间隔内的能量闭合误差，\n$$\nR \\equiv R_n - \\big(Q_H + Q_E + G\\big),\n$$\n在完美的核算和一致的符号约定下，该残差应等于 $S$。\n\n给定一个单一耦合间隔内的时间平均通量值为：$R_n = 250\\,\\mathrm{W\\,m^{-2}}$，$Q_H = 40\\,\\mathrm{W\\,m^{-2}}$，$Q_E = 180\\,\\mathrm{W\\,m^{-2}}$，以及 $G = 20\\,\\mathrm{W\\,m^{-2}}$。使用上述能量守恒框架，计算残差 $R$，然后根据其符号和大小，讨论应如何从模型耦合一致性和潜在误差来源（例如，异步平均、网格重映的非守恒性、符号约定不匹配或未表示的储存项）的角度解释 $R$。\n\n提供 $R$ 的最终数值，单位为 $\\mathrm{W\\,m^{-2}}$。给出精确值，无需四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于应用于数值模型中陆-气相互作用的能量守恒基本原理。该问题设定良好，提供了所有必要的定义、数据和明确的目标。术语和数值与数值天气预报和气候模拟领域的标准实践一致。\n\n问题的核心在于陆-气界面的能量守恒原理。在给定的时间间隔内，输入到地表的能量必须等于输出的能量加上地表储存能量的任何变化。问题定义了在一个持续时间为 $\\Delta t$ 的耦合间隔内的能量收支分量：\n- $R_n$：净辐射，代表到地表的主要能量输入（向下为正）。\n- $Q_H$：感热通量，代表向大气的湍流热量传输（向上为正，因此是地表的能量损失）。\n- $Q_E$：潜热通量，代表因蒸散而造成的能量损失（向上为正，是地表的能量损失）。\n- $G$：地热通量，代表传导到地下土壤层的热量（向下为正，对于被平衡的直接地表层是能量损失，但对于土壤柱是能量增益）。问题公式中的符号约定将其视为界面收支方程 $R_n - (Q_H + Q_E + G) - S = 0$ 中的一个输出通量。\n- $S$：储存项，代表地表层本身内部能量的变化率（例如，顶层土壤或植被冠层的变暖）。\n\n问题将能量闭合残差 $R$ 定义为：\n$$\nR \\equiv R_n - \\big(Q_H + Q_E + G\\big)\n$$\n该残差代表了净辐射能量输入中未被向大气的湍流通量（$Q_H$ 和 $Q_E$）和向地下的传导通量（$G$）所解释的部分。在一个所有项都被考虑到的完全守恒的系统中，该残差必须等于能量储存项 $S$。因此，$R = S$。\n\n问题为单个耦合间隔提供了以下时间平均通量值：\n- $R_n = 250\\,\\mathrm{W\\,m^{-2}}$\n- $Q_H = 40\\,\\mathrm{W\\,m^{-2}}$\n- $Q_E = 180\\,\\mathrm{W\\,m^{-2}}$\n- $G = 20\\,\\mathrm{W\\,m^{-2}}$\n\n我们需要计算残差 $R$。将给定值代入 $R$ 的定义方程：\n$$\nR = 250\\,\\mathrm{W\\,m^{-2}} - \\left( 40\\,\\mathrm{W\\,m^{-2}} + 180\\,\\mathrm{W\\,m^{-2}} + 20\\,\\mathrm{W\\,m^{-2}} \\right)\n$$\n首先，我们对输出通量项求和：\n$$\nQ_H + Q_E + G = 40 + 180 + 20 = 240\\,\\mathrm{W\\,m^{-2}}\n$$\n现在，我们可以计算残差 $R$：\n$$\nR = 250\\,\\mathrm{W\\,m^{-2}} - 240\\,\\mathrm{W\\,m^{-2}} = 10\\,\\mathrm{W\\,m^{-2}}\n$$\n计算出的残差为 $R = 10\\,\\mathrm{W\\,m^{-2}}$。\n\n任务的第二部分是讨论这一结果的解释。\n残差 $R$ 为正，大小为 $10\\,\\mathrm{W\\,m^{-2}}$。这表明输入到地表的能量（$R_n = 250\\,\\mathrm{W\\,m^{-2}}$）大于明确给出的输出通量之和（$Q_H + Q_E + G = 240\\,\\mathrm{W\\,m^{-2}}$）。\n\n在一个理想的、完全守恒的模型中，这个 $10\\,\\mathrm{W\\,m^{-2}}$ 的正残差不是一个“误差”，而是具有物理意义的能量储存率 $S$。这部分能量被地表本身吸收，导致其温度升高。在许多陆面模型中，存在一个关于非常薄的地表层（“表皮”层）温度的预报方程，而项 $S$ 对应于该层的热容量乘以其温度变化率。在这种解释下，能量收支是完美闭合的，$R$ 仅仅量化了未作为输入明确给出的储存项 $S$。\n\n然而，在实际的耦合建模中，非零残差也是诊断耦合系统中不一致性和错误的关键指标。数值 $R = 10\\,\\mathrm{W\\,m^{-2}}$ 应与陆面模型自身内部计算的储存项进行比较。$R$ 和模型的 $S$ 之间的任何差异都指向一个真实的能量不守恒问题。此类误差的潜在来源包括：\n1.  **异步时间平均**：陆面模型和大气模型在不同的内部时间步长上运行。如果通过耦合器传递的通量在耦合间隔 $\\Delta t$ 内没有以一致的方式进行平均，就可能产生人为的能量源或汇。例如，如果一个模型提供步长末的瞬时通量，而另一个模型提供真实的时间平均值，就会出现残差。\n2.  **非守恒的网格重映**：陆面模型和大气模型的空间网格通常是不同的。通量场必须从一个网格插值（重映）到另一个网格。常见的插值方案（如双线性插值）本身不是守恒的，这意味着它们不能保证传输的总能量得以保留。这会产生或消耗能量，从而对残差 $R$ 产生影响。\n3.  **未表示的物理过程**：地表能量收支可能不完整。诸如通过光合作用的能量转换，或储存在冠层空气空间中的能量等过程，可能在模型的 $Q_H$、$Q_E$ 或 $G$ 的公式中未被表示。这些缺失的项会在能量平衡计算中表现为残差。\n4.  **符号约定错误**：尽管此处说明了约定，但在复杂的耦合模型中，一个常见的实现错误是分量模型之间或耦合器内部的符号约定不匹配，导致通量被加而不是被减，反之亦然。在本例中，$R$ 的数值较小，表明这可能不是主要问题，因为这类错误通常会导致大得多的残差。\n\n总而言之，计算出的残差 $R = 10\\,\\mathrm{W\\,m^{-2}}$ 代表了可用于地表层储存的能量。虽然这可以是一个具有物理意义的量，但它的存在也作为一个关键标志，指示耦合实现中可能存在的数值误差。分析能量和水的守恒残差是验证耦合地球系统模型保真度的标准且必要的程序。",
            "answer": "$$\n\\boxed{10}\n$$"
        },
        {
            "introduction": "通量交换的理论框架必须通过精确的软件工程实现来保证。本练习模拟了一个常见但后果严重的错误——符号约定不匹配，以此说明这类问题如何破坏能量守恒。你将量化由此产生的伪能量，从而深刻理解在耦合建模中，稳健的元数据标准和严格的测试是何等重要。",
            "id": "4064529",
            "problem": "在一个双向耦合的大气-海洋实验中，界面感热通量通过一个使用气候与预报（CF）元数据约定的通用耦合器在不同分量之间交换。大气分量期望一个符合CF标准的变量，其物理意义是地表感热通量，定义为向上为正（从地表到大气），其CF属性为：standard_name 等于 \"surface_upward_sensible_heat_flux\"，units 等于 $\\mathrm{W \\ m^{-2}}$，以及一个 positive 属性等于 \"up\"。海洋分量内部将其感热通量变量定义为向下为正（进入海洋），单位相同。\n\n耦合器必须通过转换海洋提供的通量并附加一致的CF元数据来协调交换，以使大气接收到一个与其能量收支符号约定一致的向上为正的通量。请用文字设计此元数据转换，具体说明在将通量从海洋路由到大气时，耦合器必须应用的符号、standard_name 和单位的映射关系。\n\n现在考虑，由于一个配置错误，在连续 $N$ 个耦合时间间隔内，耦合器在将海洋提供的通量发送给大气时没有进行符号改变（即，它将海洋的向下为正的值当作向上为正的值处理）。在那 $N$ 个时间间隔内，海洋报告的感热通量在空间上均匀且在时间上恒定为 $Q_H^{\\mathrm{ocn}} = +15 \\ \\mathrm{W \\ m^{-2}}$（向下为正）。假设该通量作用于一个面积为 $A = 2.5 \\times 10^{12} \\ \\mathrm{m^{2}}$ 的水平区域，每个耦合时间间隔的持续时间为 $\\Delta t = 900 \\ \\mathrm{s}$。假设只有大气模型的趋势项使用了这个符号错误的通量，而海洋模型使用了其内部一致的符号。\n\n利用能量守恒以及通量作为单位面积单位时间的能量的定义，从第一性原理推导一个表达式，用于计算在那 $N$ 个时间间隔内仅由符号错误引起的大气能量的净伪变化，然后对 $N = 6$ 的情况进行数值计算。报告为恢复守恒而必须对大气应用的能量修正的量级，单位为焦耳。将你的答案四舍五入到四位有效数字。以 J 为单位表示最终能量。",
            "solution": "该问题被评估为有效，因为它科学上基于气候模型中使用的能量守恒原理和通量定义，是一个提供了所有必要数据的适定问题，并且用客观、明确的语言表达。\n\n问题包含两个部分。第一部分要求为在海洋和大气模型分量之间交换的感热通量变量设计一个元数据转换。第二部分要求计算在指定时期内，由于此通量交换中的一个符号错误而引入大气的总伪能量。\n\n首先，我们处理元数据转换。\n大气分量将感热通量（我们记为 $Q_H^{\\mathrm{atm}}$）定义为从地表指向上方进入大气时为正。其CF元数据包括 `standard_name: \"surface_upward_sensible_heat_flux\"` 和 `positive: \"up\"`。\n海洋分量将其感热通量 $Q_H^{\\mathrm{ocn}}$ 定义为从大气指向下方进入海洋时为正。\n一个指向海洋的通量在物理上等同于一个离开大气的通量。一个向上的通量（对大气为正）是大气的能量源，而一个向下的通量（对海洋为正）是海洋的能量源。因此，两个分量为同一物理过程定义的通量数值通过一个符号变化相关联：\n$$Q_H^{\\mathrm{atm}} = -Q_H^{\\mathrm{ocn}}$$\n耦合器在协调从海洋到大气的交换时，必须执行以下转换：\n1.  **符号：** 海洋模型提供的通量数值必须乘以 $-1$。\n2.  **`standard_name`：** `standard_name` 属性必须设置为 `\"surface_upward_sensible_heat_flux\"` 以符合大气的期望。\n3.  **`units`：** 两个分量的单位都给出为 $\\mathrm{W \\ m^{-2}}$，因此不需要转换。耦合器应验证并传递此属性。\n4.  **`positive`：** `positive` 属性（如果存在）必须设置为 `\"up\"`。\n\n接下来，我们计算大气中的伪能量变化。\n分析基于通量（$Q$）的定义，即单位面积（$A$）的能量传输率（$dE/dt$）：\n$$Q = \\frac{1}{A} \\frac{dE}{dt}$$\n重新整理得到能量变化率：\n$$\\frac{dE}{dt} = Q \\cdot A$$\n在一个有限的时间间隔 $\\Delta t$ 内，由于恒定通量 $Q$ 作用在面积 $A$ 上引起的能量变化 $\\Delta E$ 是：\n$$\\Delta E = Q \\cdot A \\cdot \\Delta t$$\n\n在指定时期内，海洋报告的感热通量为 $Q_H^{\\mathrm{ocn}} = +15 \\ \\mathrm{W \\ m^{-2}}$。因为海洋的约定是向下为正，这代表能量从大气传输到海洋。\n大气本应接收到的正确感热通量，遵循其向上为正的约定，是：\n$$Q_{H, \\text{correct}}^{\\mathrm{atm}} = -Q_H^{\\mathrm{ocn}} = -15 \\ \\mathrm{W \\ m^{-2}}$$\n这个负号正确地表示能量正在离开大气。\n\n由于配置错误，耦合器未能应用符号改变。因此，大气模型接收了来自海洋的通量值，并根据其自身的（向上为正）约定进行了解释。应用于大气的错误通量是：\n$$Q_{H, \\text{incorrect}}^{\\mathrm{atm}} = +Q_H^{\\mathrm{ocn}} = +15 \\ \\mathrm{W \\ m^{-2}}$$\n这错误地表示了能量 *进入* 大气。\n\n通量中的误差，或作用于大气的伪通量，是应用的错误通量与本应应用的正确通量之间的差值：\n$$\\Delta Q_H = Q_{H, \\text{incorrect}}^{\\mathrm{atm}} - Q_{H, \\text{correct}}^{\\mathrm{atm}} = (+15 \\ \\mathrm{W \\ m^{-2}}) - (-15 \\ \\mathrm{W \\ m^{-2}}) = 30 \\ \\mathrm{W \\ m^{-2}}$$\n这代表对大气的伪加热。\n\n大气中的总伪能量变化 $\\Delta E_{\\text{spurious}}$ 在 $N$ 个耦合时间间隔（每个持续时间为 $\\Delta t$）内累积。从第一性原理出发，总的伪能量增益是伪功率在总时间上的积分。由于所有量都是恒定的，这可以简化为：\n$$\\Delta E_{\\text{spurious}} = (\\Delta Q_H) \\cdot A \\cdot (N \\cdot \\Delta t)$$\n将 $\\Delta Q_H$ 的表达式用原始海洋通量代入：\n$$\\Delta E_{\\text{spurious}} = (Q_H^{\\mathrm{ocn}} - (-Q_H^{\\mathrm{ocn}})) \\cdot A \\cdot N \\cdot \\Delta t = 2 \\cdot Q_H^{\\mathrm{ocn}} \\cdot A \\cdot N \\cdot \\Delta t$$\n\n我们现在代入给定的数值：\n$Q_H^{\\mathrm{ocn}} = 15 \\ \\mathrm{W \\ m^{-2}}$\n$A = 2.5 \\times 10^{12} \\ \\mathrm{m^{2}}$\n$N = 6$\n$\\Delta t = 900 \\ \\mathrm{s}$\n\n$$\\Delta E_{\\text{spurious}} = 2 \\cdot (15 \\ \\mathrm{W \\ m^{-2}}) \\cdot (2.5 \\times 10^{12} \\ \\mathrm{m^{2}}) \\cdot 6 \\cdot (900 \\ \\mathrm{s})$$\n我们注意到单位是 $\\mathrm{(W \\ m^{-2}) \\cdot m^2 \\cdot s = W \\cdot s = (J \\ s^{-1}) \\cdot s = J}$，这对于能量单位是正确的。\n$$\\Delta E_{\\text{spurious}} = (30 \\ \\mathrm{W \\ m^{-2}}) \\cdot (2.5 \\times 10^{12} \\ \\mathrm{m^{2}}) \\cdot (5400 \\ \\mathrm{s})$$\n$$\\Delta E_{\\text{spurious}} = (7.5 \\times 10^{13} \\ \\mathrm{W}) \\cdot (5400 \\ \\mathrm{s})$$\n$$\\Delta E_{\\text{spurious}} = 40500 \\times 10^{13} \\ \\mathrm{J}$$\n$$\\Delta E_{\\text{spurious}} = 4.05 \\times 10^{4} \\times 10^{13} \\ \\mathrm{J} = 4.05 \\times 10^{17} \\ \\mathrm{J}$$\n\n这个正值代表大气获得的伪能量。为恢复守恒而必须对大气应用的能量修正是该值的负数，即 $-4.05 \\times 10^{17} \\ \\mathrm{J}$。问题要求这个修正的 *量级*，也就是绝对值：\n$$|\\text{Correction}| = |-4.05 \\times 10^{17} \\ \\mathrm{J}| = 4.05 \\times 10^{17} \\ \\mathrm{J}$$\n问题要求答案四舍五入到四位有效数字。\n$$4.05 \\times 10^{17} \\ \\mathrm{J} = 4.050 \\times 10^{17} \\ \\mathrm{J}$$",
            "answer": "$$\\boxed{4.050 \\times 10^{17}}$$"
        }
    ]
}