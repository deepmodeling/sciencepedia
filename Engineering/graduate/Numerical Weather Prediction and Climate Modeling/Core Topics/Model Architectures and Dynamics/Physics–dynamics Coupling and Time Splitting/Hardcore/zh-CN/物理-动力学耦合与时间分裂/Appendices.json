{
    "hands_on_practices": [
        {
            "introduction": "在数值天气预报和气候模型中，一个核心挑战是处理不同物理过程所具有的悬殊时间尺度。例如，声波的传播速度远快于平流过程。本练习将引导你探讨一种高效的解决方案——分裂显式（split-explicit）时间积分方案。通过计算满足声波CFL稳定性条件所需的最少声学子步数，并比较分裂与非分裂方案的计算成本，你将亲身体会到时间分裂方法在不牺牲稳定性的前提下，如何显著提升模型计算效率的。",
            "id": "4074861",
            "problem": "一个可压缩数值天气预报动力核心在快声波模态和较慢的平流-旋转动力学之间使用分裂显式耦合。大步长动力学和物理趋势项在每个持续时间为 $\\Delta t$ 的总时间步长内评估一次，而声波模态则以 $N_{\\text{ac}}$ 个持续时间为 $\\Delta t_{\\text{ac}} = \\Delta t / N_{\\text{ac}}$ 的子步长进行积分，以满足与声波传播相关的 Courant–Friedrichs–Lewy (CFL) 稳定性要求。\n\n假设一维空间中的声波模态可以由线性标量平流方程 $\\partial \\phi / \\partial t + c_{a} \\, \\partial \\phi / \\partial x = 0$ 作为主导项来表示，其中 $c_{a}$ 是声波相速度。声波更新在间距为 $\\Delta x$ 的均匀网格上，采用时间上向前欧拉格式和一阶迎风空间离散格式进行。期望的总步长为 $\\Delta t$。\n\n给定：\n- 声波相速度 $c_{a} = 320 \\,\\mathrm{m\\,s^{-1}}$，\n- 网格间距 $\\Delta x = 2.0 \\,\\mathrm{km}$，\n- 总时间步长 $\\Delta t = 60 \\,\\mathrm{s}$。\n\n在一个以每个网格列、每个总步长的浮点运算 (flop) 次数衡量的简单成本模型中：\n- 每个总步长的慢动力学成本为 $C_{\\text{slow}} = 2.0 \\times 10^{8}$，\n- 一个声波子步长的成本为 $C_{\\text{ac}} = 0.5 \\times 10^{8}$，\n- 每个总步长的物理参数化成本为 $C_{\\text{phys}} = 5.0 \\times 10^{8}$。\n\n设分裂显式方法每个总步长的计算成本为 $C_{\\text{split}} = C_{\\text{slow}} + C_{\\text{phys}} + N_{\\text{ac}} \\, C_{\\text{ac}}$。考虑一个非分裂显式方法作为基准，该方法将全局时间步长缩短至声波子步长以满足 CFL 要求，因此在每个 $\\Delta t$ 内执行 $N_{\\text{ac}}$ 个小步长，每个小步长中都执行慢动力学、声波更新和物理过程。其每个 $\\Delta t$ 的成本为 $C_{\\text{unsplit}} = N_{\\text{ac}} \\, (C_{\\text{slow}} + C_{\\text{ac}} + C_{\\text{phys}})$。\n\n任务：\n1. 从离散化的声波平流表示及其稳定性约束出发，确定所需的最小整数声波子步长数 $N_{\\text{ac}}$，以使声波 CFL 条件在持续时间为 $\\Delta t$ 的单个总步长内得到满足。\n2. 使用上述成本，计算比率 $R = C_{\\text{split}} / C_{\\text{unsplit}}$。\n\n将比率 $R$ 四舍五入到四位有效数字。将您的最终配对结果表示为排列在单行矩阵 $\\begin{pmatrix} N_{\\text{ac}}  R \\end{pmatrix}$ 中的两个数字，不带单位。",
            "solution": "该问题提法恰当且科学上合理，基于应用于大气建模的偏微分方程数值方法的基本原理。所有必要数据都已提供，可得唯一解。我们将继续完成所列出的两项任务。\n\n第一项任务是确定数值稳定性所需的最小声波子步长数 $N_{\\text{ac}}$。声波模态由一维线性标量平流方程建模：\n$$\n\\frac{\\partial \\phi}{\\partial t} + c_{a} \\frac{\\partial \\phi}{\\partial x} = 0\n$$\n其中 $\\phi$ 是一个状态变量，$t$ 是时间，$x$ 是空间坐标，$c_{a}$ 是声波相速度。\n\n该方程使用时间上向前欧拉格式和空间上一阶迎风格式进行离散化。设 $\\phi_j^n$ 表示在网格点 $j$ 和时间层 $n$ 处的 $\\phi$ 值。网格间距为 $\\Delta x$，声波时间步长为 $\\Delta t_{\\text{ac}}$。由于相速度 $c_{a}$ 为正，波在正 $x$ 方向上传播，因此网格点 $j$ 处的迎风空间导数使用来自网格点 $j-1$ 的信息。离散化的方程为：\n$$\n\\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t_{\\text{ac}}} + c_{a} \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} = 0\n$$\n为求解下一个时间步的解 $\\phi_j^{n+1}$，重新整理方程得到：\n$$\n\\phi_j^{n+1} = \\phi_j^n - \\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x} (\\phi_j^n - \\phi_{j-1}^n)\n$$\n让我们将声波子步长的库朗数 $\\nu_{\\text{ac}}$ 定义为：\n$$\n\\nu_{\\text{ac}} = \\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x}\n$$\n离散方程可以写为：\n$$\n\\phi_j^{n+1} = (1 - \\nu_{\\text{ac}})\\phi_j^n + \\nu_{\\text{ac}}\\phi_{j-1}^n\n$$\n为使此显式格式（时间向前，一阶迎风）稳定，右侧各项的系数必须为非负。由于 $\\nu_{\\text{ac}}$ 本身为正（$c_a > 0$, $\\Delta t_{\\text{ac}} > 0$, $\\Delta x > 0$），稳定性条件为 $1 - \\nu_{\\text{ac}} \\ge 0$，可简化为 Courant–Friedrichs–Lewy (CFL) 稳定性判据：\n$$\n\\nu_{\\text{ac}} \\le 1\n$$\n代入 $\\nu_{\\text{ac}}$ 的定义，我们得到：\n$$\n\\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x} \\le 1\n$$\n这意味着声波时间步长 $\\Delta t_{\\text{ac}}$ 必须满足：\n$$\n\\Delta t_{\\text{ac}} \\le \\frac{\\Delta x}{c_{a}}\n$$\n问题陈述声波模态在总时间步长 $\\Delta t$ 内以 $N_{\\text{ac}}$ 个持续时间为 $\\Delta t_{\\text{ac}}$ 的子步长进行积分，使得 $\\Delta t_{\\text{ac}} = \\Delta t / N_{\\text{ac}}$。将其代入稳定性条件得到：\n$$\n\\frac{\\Delta t}{N_{\\text{ac}}} \\le \\frac{\\Delta x}{c_{a}}\n$$\n我们需要找到满足此条件的 $N_{\\text{ac}}$ 的最小整数值。重新整理关于 $N_{\\text{ac}}$ 的不等式：\n$$\nN_{\\text{ac}} \\ge \\frac{c_{a} \\Delta t}{\\Delta x}\n$$\n现在，我们代入给定值：\n- $c_a = 320 \\,\\mathrm{m\\,s^{-1}}$\n- $\\Delta t = 60 \\,\\mathrm{s}$\n- $\\Delta x = 2.0 \\,\\mathrm{km} = 2.0 \\times 10^3 \\,\\mathrm{m}$\n\n$$\nN_{\\text{ac}} \\ge \\frac{(320 \\,\\mathrm{m\\,s^{-1}}) \\cdot (60 \\,\\mathrm{s})}{2.0 \\times 10^3 \\,\\mathrm{m}} = \\frac{19200}{2000} = 9.6\n$$\n由于 $N_{\\text{ac}}$ 必须是整数，因此稳定性所需的最小声波子步长数是大于或等于 $9.6$ 的最小整数。\n$$\nN_{\\text{ac, min}} = 10\n$$\n\n第二项任务是计算比率 $R = C_{\\text{split}} / C_{\\text{unsplit}}$。分裂显式方法和非分裂显式方法的成本由以下公式给出：\n$$\nC_{\\text{split}} = C_{\\text{slow}} + C_{\\text{phys}} + N_{\\text{ac}} \\, C_{\\text{ac}}\n$$\n$$\nC_{\\text{unsplit}} = N_{\\text{ac}} \\, (C_{\\text{slow}} + C_{\\text{ac}} + C_{\\text{phys}})\n$$\n给定每个网格列、每个总步长的成本值如下：\n- $C_{\\text{slow}} = 2.0 \\times 10^{8}$\n- $C_{\\text{ac}} = 0.5 \\times 10^{8}$\n- $C_{\\text{phys}} = 5.0 \\times 10^{8}$\n\n使用 $N_{\\text{ac}} = 10$，我们可以计算这两种成本。\n对于分裂显式方法：\n$$\nC_{\\text{split}} = (2.0 \\times 10^{8}) + (5.0 \\times 10^{8}) + 10 \\cdot (0.5 \\times 10^{8})\n$$\n$$\nC_{\\text{split}} = (2.0 + 5.0 + 5.0) \\times 10^{8} = 12.0 \\times 10^{8}\n$$\n对于非分裂显式方法：\n$$\nC_{\\text{unsplit}} = 10 \\cdot ((2.0 \\times 10^{8}) + (0.5 \\times 10^{8}) + (5.0 \\times 10^{8}))\n$$\n$$\nC_{\\text{unsplit}} = 10 \\cdot (2.0 + 0.5 + 5.0) \\times 10^{8} = 10 \\cdot (7.5) \\times 10^{8} = 75.0 \\times 10^{8}\n$$\n现在我们计算比率 $R$：\n$$\nR = \\frac{C_{\\text{split}}}{C_{\\text{unsplit}}} = \\frac{12.0 \\times 10^{8}}{75.0 \\times 10^{8}} = \\frac{12.0}{75.0} = \\frac{12}{75}\n$$\n化简分数：\n$$\nR = \\frac{4 \\times 3}{25 \\times 3} = \\frac{4}{25} = 0.16\n$$\n问题要求将此比率四舍五入到四位有效数字。\n$$\nR = 0.1600\n$$\n最终的配对结果是 $N_{\\text{ac}} = 10$ 和 $R = 0.1600$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 10  0.1600 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "时间分裂方法虽然高效，但它本质上是一种近似，会引入所谓的“分裂误差”。这个误差的大小取决于动力过程和物理过程算符的对易性。本练习将带你深入了解分裂误差的理论核心，即利用算符的李对易子（Lie commutator）来量化一阶分裂方案（Lie-Trotter splitting）的主导误差。通过一个具体的数值案例，你将学会如何估算分裂误差，并据此判断是否有必要采用更高阶的Strang分裂方案来满足精度要求。",
            "id": "4074816",
            "problem": "在一个用于数值天气预报（NWP）的大气模型的一个垂直气柱中，预报状态已使用标准参考尺度进行了无量纲化，因此欧几里得范数是其量值的合适度量。时间演化由分裂系统 $\\frac{d x}{d t} = A x + B x$ 建模，其中 $A$ 代表可分辨的动力学算子，$B$ 代表次网格物理算子。考虑一个时间步长，在此步长内，$A$ 和 $B$ 被假定为冻结的，并围绕当前状态 $x$ 进行线性化。给定当前状态下以下经过数值计算的算子作用：\n- 当前状态：$x = \\begin{pmatrix} 0.8 \\\\ -0.3 \\\\ 1.2 \\\\ 0.05 \\end{pmatrix}$。\n- 单次作用：$A x = \\begin{pmatrix} 0.12 \\\\ -0.08 \\\\ 0.35 \\\\ -0.01 \\end{pmatrix}$ 和 $B x = \\begin{pmatrix} 0.03 \\\\ 0.02 \\\\ -0.06 \\\\ 0.004 \\end{pmatrix}$。\n- 嵌套作用：$A(B x) = \\begin{pmatrix} 0.014 \\\\ -0.006 \\\\ 0.020 \\\\ -0.001 \\end{pmatrix}$ 和 $B(A x) = \\begin{pmatrix} 0.008 \\\\ -0.005 \\\\ 0.015 \\\\ -0.0005 \\end{pmatrix}$。\n\n使用 Baker–Campbell–Hausdorff 展开到所需的最小阶数，首先推导出一阶 Lie–Trotter 方法的局部格式分裂误差的主阶表达式，该表达式用作用于 $x$ 的李换位子 $[A,B]$ 和无量纲时间步长 $\\Delta \\hat{t}$ 表示。然后，利用给定的算子作用，构造一个作用于状态的换位子的有限差分近似，即 $[A,B]x$。定义一个无量纲局部误差比\n$$\nR \\equiv \\frac{1}{\\|x\\|_2}\\,\\frac{\\Delta \\hat{t}^{2}}{2}\\,\\bigl\\|[A,B]x\\bigr\\|_2,\n$$\n其中 $\\|\\cdot\\|_2$ 是欧几里得范数，无量纲时间步长为 $\\Delta \\hat{t} \\equiv \\Delta t / T_{\\mathrm{ref}}$，参考时间 $T_{\\mathrm{ref}} = 3600\\,\\mathrm{s}$。取物理时间步长为 $\\Delta t = 2400\\,\\mathrm{s}$。使用一个耦合容差 $\\tau = 1.0 \\times 10^{-3}$（无量纲）来判断一阶 Lie 分裂误差是否可接受；如果 $R > \\tau$，则对于这种耦合，有必要使用二阶 Strang 分裂。\n\n根据提供的数据计算 $R$，并根据容差判断是否有必要使用 Strang 分裂。最终答案只报告 $R$ 的值，四舍五入到四位有效数字，并表示为无量纲数。不要在最终答案框中包含单位或判断。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n-   控制方程为 $\\frac{d x}{d t} = A x + B x = (A+B)x$。\n-   当前状态：$x = \\begin{pmatrix} 0.8 \\\\ -0.3 \\\\ 1.2 \\\\ 0.05 \\end{pmatrix}$。\n-   算子作用 $A x$：$A x = \\begin{pmatrix} 0.12 \\\\ -0.08 \\\\ 0.35 \\\\ -0.01 \\end{pmatrix}$。\n-   算子作用 $B x$：$B x = \\begin{pmatrix} 0.03 \\\\ 0.02 \\\\ -0.06 \\\\ 0.004 \\end{pmatrix}$。\n-   嵌套算子作用 $A(B x)$：$A(B x) = \\begin{pmatrix} 0.014 \\\\ -0.006 \\\\ 0.020 \\\\ -0.001 \\end{pmatrix}$。\n-   嵌套算子作用 $B(A x)$：$B(A x) = \\begin{pmatrix} 0.008 \\\\ -0.005 \\\\ 0.015 \\\\ -0.0005 \\end{pmatrix}$。\n-   物理时间步长：$\\Delta t = 2400\\,\\mathrm{s}$。\n-   参考时间尺度：$T_{\\mathrm{ref}} = 3600\\,\\mathrm{s}$。\n-   无量纲时间步长：$\\Delta \\hat{t} \\equiv \\Delta t / T_{\\mathrm{ref}}$。\n-   无量纲局部误差比定义：$R \\equiv \\frac{1}{\\|x\\|_2}\\,\\frac{\\Delta \\hat{t}^{2}}{2}\\,\\bigl\\|[A,B]x\\bigr\\|_2$。\n-   耦合容差：$\\tau = 1.0 \\times 10^{-3}$。\n-   高阶分裂的条件：如果 $R > \\tau$，则有必要使用 Strang 分裂。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于求解微分方程组的数值方法中使用的算子分裂（特别是 Lie-Trotter 分裂）的标准实践，这是数值天气预报和气候建模中的常用技术。Baker-Campbell-Hausdorff 展开和李换位子是分析分裂误差的正确理论工具。\n-   **适定性**：问题已完全指定。提供了计算量 $R$ 所需的所有数值数据和定义。目标清晰明确。\n-   **客观性**：问题以精确的数学和数值术语陈述，没有主观语言。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n问题要求计算一个无量纲比率 $R$，该比率量化了一阶 Lie-Trotter 分裂格式的局部误差。首先，我们推导主阶分裂误差。在一个时间步长 $\\Delta t$ 内，$\\frac{d x}{d t} = (A+B)x$ 的精确解是 $x(\\Delta t) = \\exp((A+B)\\Delta t)x_0$，其中 $x_0$ 是 $t=0$ 时的状态。\n\n一阶 Lie-Trotter 分裂将此演化近似为 $x_{LT}(\\Delta t) = \\exp(B\\Delta t)\\exp(A\\Delta t)x_0$。局部截断误差是一步之后精确解与近似解之间的差。为找到此误差的主阶项，我们对指数算子使用泰勒级数展开。\n\n精确解算子为：\n$$\n\\exp((A+B)\\Delta t) = I + (A+B)\\Delta t + \\frac{1}{2}(A+B)^2 \\Delta t^2 + O(\\Delta t^3)\n$$\n展开二次项：\n$$\n\\exp((A+B)\\Delta t) = I + A\\Delta t + B\\Delta t + \\frac{1}{2}(A^2 + AB + BA + B^2)\\Delta t^2 + O(\\Delta t^3)\n$$\nLie-Trotter 近似算子为：\n$$\n\\exp(B\\Delta t)\\exp(A\\Delta t) = \\left(I + B\\Delta t + \\frac{1}{2}B^2\\Delta t^2 + \\dots\\right)\\left(I + A\\Delta t + \\frac{1}{2}A^2\\Delta t^2 + \\dots\\right)\n$$\n展开并保留到 $\\Delta t^2$ 阶的项：\n$$\n\\exp(B\\Delta t)\\exp(A\\Delta t) = I + A\\Delta t + B\\Delta t + BA\\Delta t^2 + \\frac{1}{2}A^2\\Delta t^2 + \\frac{1}{2}B^2\\Delta t^2 + O(\\Delta t^3)\n$$\n局部误差算子 $L_{err}$ 是精确算子和近似算子之间的差：\n$$\nL_{err} = \\exp((A+B)\\Delta t) - \\exp(B\\Delta t)\\exp(A\\Delta t)\n$$\n$$\nL_{err} = \\left[\\frac{1}{2}(A^2 + AB + BA + B^2) - \\left(BA + \\frac{1}{2}A^2 + \\frac{1}{2}B^2\\right)\\right]\\Delta t^2 + O(\\Delta t^3)\n$$\n$$\nL_{err} = \\frac{1}{2}(AB - BA)\\Delta t^2 + O(\\Delta t^3) = \\frac{1}{2}[A,B]\\Delta t^2 + O(\\Delta t^3)\n$$\n其中 $[A,B] = AB - BA$ 是算子 $A$ 和 $B$ 的李换位子。\n因此，作用于状态 $x$ 的主阶局部格式分裂误差为 $\\frac{1}{2}[A,B]x\\,\\Delta t^2$。\n使用无量纲时间步长 $\\Delta \\hat{t} = \\Delta t / T_{\\mathrm{ref}}$，误差为 $\\frac{1}{2}[A,B]x\\,(T_{\\mathrm{ref}}\\Delta \\hat{t})^2$。由于问题定义 $R$ 时没有 $T_{\\mathrm{ref}}$，它隐含地假设分析是在无量纲时间下进行的，因此误差表示为 $\\frac{1}{2}[A,B]x\\,\\Delta \\hat{t}^2$。量 $R$ 是此误差的范数，并按状态 $x$ 的范数进行缩放。\n\n下一步是计算 $R$ 的各分量。\n\n1.  **计算 $[A,B]x$**：换位子对状态 $x$ 的作用由 $[A,B]x = A(Bx) - B(Ax)$ 给出。使用提供的数值：\n    $$\n    [A,B]x = \\begin{pmatrix} 0.014 \\\\ -0.006 \\\\ 0.020 \\\\ -0.001 \\end{pmatrix} - \\begin{pmatrix} 0.008 \\\\ -0.005 \\\\ 0.015 \\\\ -0.0005 \\end{pmatrix} = \\begin{pmatrix} 0.014 - 0.008 \\\\ -0.006 - (-0.005) \\\\ 0.020 - 0.015 \\\\ -0.001 - (-0.0005) \\end{pmatrix} = \\begin{pmatrix} 0.006 \\\\ -0.001 \\\\ 0.005 \\\\ -0.0005 \\end{pmatrix}\n    $$\n2.  **计算欧几里得范数**：我们需要 $\\|x\\|_2$ 和 $\\|[A,B]x\\|_2$。\n    $$\n    \\|x\\|_2 = \\sqrt{(0.8)^2 + (-0.3)^2 + (1.2)^2 + (0.05)^2} = \\sqrt{0.64 + 0.09 + 1.44 + 0.0025} = \\sqrt{2.1725}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{(0.006)^2 + (-0.001)^2 + (0.005)^2 + (-0.0005)^2}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{3.6 \\times 10^{-5} + 1.0 \\times 10^{-6} + 2.5 \\times 10^{-5} + 0.25 \\times 10^{-6}}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{(36 + 1 + 25 + 0.25) \\times 10^{-6}} = \\sqrt{62.25 \\times 10^{-6}}\n    $$\n3.  **计算无量纲时间步长 $\\Delta \\hat{t}$**：\n    $$\n    \\Delta \\hat{t} = \\frac{\\Delta t}{T_{\\mathrm{ref}}} = \\frac{2400\\,\\mathrm{s}}{3600\\,\\mathrm{s}} = \\frac{24}{36} = \\frac{2}{3}\n    $$\n4.  **计算比率 $R$**：将计算出的值代入 $R$ 的定义中。\n    $$\n    R = \\frac{1}{\\|x\\|_2}\\,\\frac{\\Delta \\hat{t}^{2}}{2}\\,\\bigl\\|[A,B]x\\bigr\\|_2 = \\frac{1}{\\sqrt{2.1725}} \\frac{(2/3)^2}{2} \\sqrt{62.25 \\times 10^{-6}}\n    $$\n    $$\n    R = \\frac{1}{\\sqrt{2.1725}} \\frac{4/9}{2} \\sqrt{62.25} \\times 10^{-3} = \\frac{1}{\\sqrt{2.1725}} \\frac{2}{9} \\sqrt{62.25} \\times 10^{-3}\n    $$\n    $$\n    R = \\frac{2 \\sqrt{62.25}}{9 \\sqrt{2.1725}} \\times 10^{-3} \\approx \\frac{2 \\times 7.889867}{9 \\times 1.473940} \\times 10^{-3}\n    $$\n    $$\n    R \\approx \\frac{15.779734}{13.26546} \\times 10^{-3} \\approx 1.189532 \\times 10^{-3}\n    $$\n将结果四舍五入到四位有效数字，得到 $R \\approx 1.190 \\times 10^{-3}$。\n\n最后，我们将此值与容差 $\\tau = 1.0 \\times 10^{-3}$ 进行比较。\n由于 $R \\approx 1.190 \\times 10^{-3} > 1.0 \\times 10^{-3}$，我们有 $R > \\tau$。这表明对于此时间步长，一阶 Lie-Trotter 方法的局部格式分裂误差过大，因此有必要使用像 Strang 分裂这样的二阶方法。最终答案是 $R$ 的数值。",
            "answer": "$$\n\\boxed{1.190 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "除了数值精度，确保基本物理守恒律是耦合方案设计的另一个关键目标，尤其是在长期气候模拟中。本练习将你置于一个实际应用场景：检验一个对流参数化方案的能量守恒特性。你将通过计算一个大气柱中由对流过程引起的湿静力能（Moist Static Energy, MSE）的总变化，并将其与通过降水移除的潜热能量进行比较，来评估该方案的能量收支闭合程度。这项实践是验证和改进物理参数化方案的基石。",
            "id": "4074817",
            "problem": "使用算子分裂法进行物理-动力耦合，将一个单个热带大气柱在一个时长为 $\\Delta t = 1800$ s 的物理（参数化）时间子步长内进行推进。该大气柱是静力平衡的，地面气压 $p_{s} = 1000$ hPa，模式层顶气压 $p_{t} = 200$ hPa。在此子步长内，对流参数化方案产生了层平均的加热和增湿趋势，这些趋势在四个厚度均为 $\\Delta p = 200$ hPa 的气压层内被视为常数：$[1000,800]$ hPa、$[800,600]$ hPa、$[600,400]$ hPa 和 $[400,200]$ hPa。层平均的对流趋势为：\n- $Q_{c,1} = 2.0 \\times 10^{-4}$ K s$^{-1}$，$Q_{c,2} = 3.2 \\times 10^{-4}$ K s$^{-1}$，$Q_{c,3} = 2.5 \\times 10^{-4}$ K s$^{-1}$，$Q_{c,4} = 2.4 \\times 10^{-4}$ K s$^{-1}$，\n- $S_{q,1} = -1.00 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$，$S_{q,2} = -1.05 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$，$S_{q,3} = -1.02 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$，$S_{q,4} = -0.98 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$。\n\n假设质量加权的定压比热 $c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$、蒸发潜热 $L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$ 和重力加速度 $g = 9.81$ m s$^{-2}$ 均为常数。忽略在该子步长内位势项的变化（即，视 $g z$ 在 $\\Delta t$ 内不受对流趋势的影响而改变）。\n\n将由对流引起的层-气压坐标下整层积分的湿静力能（MSE）趋势定义为\n$$\\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{1}{g} \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp,$$\n相应的有限时间变化定义为\n$$\\Delta M = \\Delta t \\, \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}}.$$\n\n在子步长结束时，对流方案输出一个地面降水率 $R = 3$ mm h$^{-1}$，这对应于一个降水质量通量 $P$（kg m$^{-2}$ s$^{-1}$）。在没有辐射、地表通量和侧向输送的情况下，精确的湿静力能守恒要求 $c_{p}$ 加权的对流加热与 $L_{v}$ 加权的对流增湿/变干相平衡，并与降水造成的水物质移除相一致。\n\n根据给定的趋势计算 $\\Delta M$，然后通过计算无量纲残差\n$$\\varepsilon \\equiv \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t}.$$\n来量化相对于降水的守恒性检验。\n\n将 $\\varepsilon$ 表示为无单位的小数，并四舍五入到四位有效数字。使用上述单位，并在将 $R$ 转换为 $P$ 时，取液态水 $1$ mm $=$ $1$ kg m$^{-2}$。",
            "solution": "用户希望我解决以下问题。\n\n问题要求计算无量纲残差 $\\varepsilon$，它量化了对流参数化方案在单个时间子步长内的湿静力能（MSE）守恒误差。残差的公式为：\n$$ \\varepsilon \\equiv \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t} $$\n其中 $\\Delta M$ 是由对流引起的整层积分的 MSE 变化，$L_{v}$ 是蒸发潜热，$P$ 是降水质量通量，$\\Delta t$ 是子步长的时长。\n\n首先，我们必须计算分子 $\\Delta M$。它的定义是：\n$$ \\Delta M = \\Delta t \\, \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} $$\n其中整层积分的 MSE 趋势由下式给出：\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{1}{g} \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp $$\n问题陈述，对流趋势，即加热趋势 $Q_c(p)$ 和增湿趋势 $S_q(p)$，在四个等厚度的独立气压层内是常数。因此，该积分可以计算为这四个层的总和。每层的气压厚度为 $\\Delta p = 200$ hPa。为了计算，我们必须使用国际单位制（SI）单位，因此我们将百帕（hPa）转换为帕斯卡（Pa）：\n$$ \\Delta p = 200 \\text{ hPa} = 200 \\times 100 \\text{ Pa} = 2 \\times 10^4 \\text{ Pa} $$\n因此，积分被替换为一个总和乘以层厚度 $\\Delta p$：\n$$ \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp = \\Delta p \\sum_{k=1}^{4} \\left(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k} \\right) $$\n其中 $k$ 是层指数。我们已知以下常数和各层的特定趋势：\n$c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$\n$L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$\n$Q_{c,1} = 2.0 \\times 10^{-4}$ K s$^{-1}$，$S_{q,1} = -1.00 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,2} = 3.2 \\times 10^{-4}$ K s$^{-1}$，$S_{q,2} = -1.05 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,3} = 2.5 \\times 10^{-4}$ K s$^{-1}$，$S_{q,3} = -1.02 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,4} = 2.4 \\times 10^{-4}$ K s$^{-1}$，$S_{q,4} = -0.98 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n\n我们来计算每一层 $k$ 的项 $(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k})$：\n对于层 $k=1$：\n$ (1004) \\cdot (2.0 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.00 \\times 10^{-7}) = 0.2008 - 0.25 = -0.0492 $ J kg$^{-1}$ s$^{-1}$\n对于层 $k=2$：\n$ (1004) \\cdot (3.2 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.05 \\times 10^{-7}) = 0.32128 - 0.2625 = 0.05878 $ J kg$^{-1}$ s$^{-1}$\n对于层 $k=3$：\n$ (1004) \\cdot (2.5 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.02 \\times 10^{-7}) = 0.251 - 0.255 = -0.0040 $ J kg$^{-1}$ s$^{-1}$\n对于层 $k=4$：\n$ (1004) \\cdot (2.4 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-0.98 \\times 10^{-7}) = 0.24096 - 0.245 = -0.00404 $ J kg$^{-1}$ s$^{-1}$\n\n所有层的总和是：\n$$ \\sum_{k=1}^{4} \\left(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k} \\right) = -0.0492 + 0.05878 - 0.0040 - 0.00404 = 0.00154 \\text{ J kg}^{-1} \\text{s}^{-1} $$\n现在我们可以计算 MSE 趋势：\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{\\Delta p}{g} \\sum_{k=1}^{4} \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right) = \\frac{2 \\times 10^4 \\text{ Pa}}{9.81 \\text{ m s}^{-2}} \\times (0.00154 \\text{ J kg}^{-1} \\text{s}^{-1}) $$\n单位是 $(\\text{Pa}) \\cdot (\\text{J kg}^{-1} \\text{s}^{-1}) / (\\text{m s}^{-2}) = (\\text{kg m}^{-1} \\text{s}^{-2}) \\cdot (\\text{J kg}^{-1} \\text{s}^{-1}) / (\\text{m s}^{-2}) = \\text{J m}^{-2} \\text{s}^{-1}$，这是一个功率通量（W m$^{-2}$），与预期相符。\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{30.8}{9.81} \\text{ W m}^{-2} $$\n在子步长 $\\Delta t = 1800$ s 内的总变化 $\\Delta M$ 是：\n$$ \\Delta M = \\Delta t \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = 1800 \\text{ s} \\times \\frac{30.8}{9.81} \\text{ W m}^{-2} = \\frac{55440}{9.81} \\text{ J m}^{-2} $$\n\n接下来，我们计算分母 $L_{v} \\, P \\, \\Delta t$。\n我们已知地面降水率为 $R = 3$ mm h$^{-1}$。我们必须将其转换为国际单位制（SI）单位下的质量通量 $P$（kg m$^{-2}$ s$^{-1}$）。使用 $1$ mm 液态水深度等效于 $1$ kg m$^{-2}$ 质量的转换关系，并且知道 $1$ 小时是 $3600$ 秒：\n$$ P = 3 \\frac{\\text{mm}}{\\text{h}} \\times \\frac{1 \\text{ kg m}^{-2}}{1 \\text{ mm}} \\times \\frac{1 \\text{ h}}{3600 \\text{ s}} = \\frac{3}{3600} \\text{ kg m}^{-2} \\text{s}^{-1} = \\frac{1}{1200} \\text{ kg m}^{-2} \\text{s}^{-1} $$\n现在我们可以计算分母：\n$$ L_{v} P \\Delta t = (2.5 \\times 10^{6} \\text{ J kg}^{-1}) \\times (\\frac{1}{1200} \\text{ kg m}^{-2} \\text{s}^{-1}) \\times (1800 \\text{ s}) $$\n$$ L_{v} P \\Delta t = (2.5 \\times 10^{6}) \\times \\frac{1800}{1200} = (2.5 \\times 10^{6}) \\times 1.5 = 3.75 \\times 10^{6} \\text{ J m}^{-2} $$\n\n最后，我们计算无量纲残差 $\\varepsilon$：\n$$ \\varepsilon = \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t} = \\frac{55440 / 9.81}{3.75 \\times 10^{6}} = \\frac{55440}{9.81 \\times 3.75 \\times 10^{6}} $$\n$$ \\varepsilon = \\frac{55440}{36787500} \\approx 0.001507019...$$\n或者，我们可以在代入数值之前简化 $\\varepsilon$ 的表达式：\n$$ \\varepsilon = \\frac{\\Delta t \\, \\frac{\\Delta p}{g} \\sum \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right)}{L_{v} P \\Delta t} = \\frac{\\Delta p \\sum \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right)}{g L_{v} P} $$\n分子： $\\Delta p \\sum (\\dots) = (2 \\times 10^4) \\times (0.00154) = 30.8$\n分母： $g L_{v} P = (9.81) \\times (2.5 \\times 10^6) \\times (\\frac{1}{1200}) = \\frac{9.81 \\times 2.5 \\times 10^6}{1200} = 20437.5$\n$$ \\varepsilon = \\frac{30.8}{20437.5} = 0.001507019...$$\n问题要求答案四舍五入到四位有效数字。\n$$ \\varepsilon \\approx 0.001507 $$\n这个小的正值表明对流方案有轻微的人为能量产生，约等于与凝结降水相关能量的 $0.15\\%$。在没有地表通量和辐射的情况下，一个理想的能量守恒方案将会得到 $\\varepsilon = 0$。",
            "answer": "$$\\boxed{0.001507}$$"
        }
    ]
}