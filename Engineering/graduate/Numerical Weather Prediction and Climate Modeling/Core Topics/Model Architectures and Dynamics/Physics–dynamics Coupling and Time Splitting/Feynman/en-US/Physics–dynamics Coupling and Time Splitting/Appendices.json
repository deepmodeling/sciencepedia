{
    "hands_on_practices": [
        {
            "introduction": "Numerical models of the atmosphere must simulate processes that occur on vastly different timescales, from the slow advection of weather systems to the rapid propagation of sound and gravity waves. Using a single time step small enough to resolve the fastest waves would be computationally intractable for long-term forecasts or climate projections. This exercise explores the fundamental motivation for time splitting by analyzing a split-explicit scheme, where the \"slow\" dynamics are integrated with a large time step $\\Delta t$ and the \"fast\" acoustic waves are sub-cycled with a smaller step. You will apply the Courant–Friedrichs–Lewy (CFL) stability condition to determine the necessary number of sub-steps and quantify the immense computational advantage of this approach compared to a naive, unsplit method .",
            "id": "4074861",
            "problem": "A compressible numerical weather prediction dynamical core uses a split-explicit coupling between the fast acoustic mode and the slower advective–rotational dynamics. The large-step dynamics and physics tendencies are evaluated once per overall time step of duration $\\Delta t$, while the acoustic mode is integrated with $N_{\\text{ac}}$ substeps of duration $\\Delta t_{\\text{ac}} = \\Delta t / N_{\\text{ac}}$ to satisfy the Courant–Friedrichs–Lewy (CFL) stability requirement associated with the acoustic propagation.\n\nAssume the acoustic mode in one spatial dimension can be represented to leading order by the linear scalar advection equation $\\partial \\phi / \\partial t + c_{a} \\, \\partial \\phi / \\partial x = 0$, where $c_{a}$ is the acoustic phase speed. The acoustic update is performed with forward Euler in time and a first-order upwind spatial discretization on a uniform grid with spacing $\\Delta x$. The desired overall step is $\\Delta t$.\n\nYou are given:\n- Acoustic phase speed $c_{a} = 320 \\,\\mathrm{m\\,s^{-1}}$,\n- Grid spacing $\\Delta x = 2.0 \\,\\mathrm{km}$,\n- Overall time step $\\Delta t = 60 \\,\\mathrm{s}$.\n\nIn a simple cost model measured in floating-point operations (flop) per grid column per overall step:\n- The slow dynamics per overall step costs $C_{\\text{slow}} = 2.0 \\times 10^{8}$,\n- One acoustic substep costs $C_{\\text{ac}} = 0.5 \\times 10^{8}$,\n- The physics parameterizations per overall step cost $C_{\\text{phys}} = 5.0 \\times 10^{8}$.\n\nLet the computational cost of the split-explicit approach per overall step be $C_{\\text{split}} = C_{\\text{slow}} + C_{\\text{phys}} + N_{\\text{ac}} \\, C_{\\text{ac}}$. Consider as a baseline an unsplit explicit approach that reduces the global time step to the acoustic substep to satisfy the CFL requirement, thereby performing $N_{\\text{ac}}$ small steps per $\\Delta t$ in which slow dynamics, acoustic update, and physics are all executed each small step. Its per-$\\Delta t$ cost is $C_{\\text{unsplit}} = N_{\\text{ac}} \\, (C_{\\text{slow}} + C_{\\text{ac}} + C_{\\text{phys}})$.\n\nTasks:\n1. Starting from the discretized acoustic advection representation and its stability constraint, determine the minimum integer number of acoustic substeps $N_{\\text{ac}}$ required so that the acoustic CFL condition is satisfied over a single overall step of duration $\\Delta t$.\n2. Using the costs above, compute the ratio $R = C_{\\text{split}} / C_{\\text{unsplit}}$.\n\nRound the ratio $R$ to four significant figures. Express your final paired result as two numbers arranged in a single row matrix $\\begin{pmatrix} N_{\\text{ac}} & R \\end{pmatrix}$ without units.",
            "solution": "The problem is well-posed and scientifically sound, resting on fundamental principles of numerical methods for partial differential equations as applied in atmospheric modeling. All necessary data are provided for a unique solution. We will proceed with the two tasks outlined.\n\nThe first task is to determine the minimum number of acoustic substeps, $N_{\\text{ac}}$, required for numerical stability. The acoustic mode is modeled by the linear scalar advection equation in one dimension:\n$$\n\\frac{\\partial \\phi}{\\partial t} + c_{a} \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nwhere $\\phi$ is a state variable, $t$ is time, $x$ is the spatial coordinate, and $c_{a}$ is the acoustic phase speed.\n\nThis equation is discretized using a forward Euler scheme in time and a first-order upwind scheme in space. Let $\\phi_j^n$ represent the value of $\\phi$ at grid point $j$ and time level $n$. The grid spacing is $\\Delta x$ and the acoustic time step is $\\Delta t_{\\text{ac}}$. Since the phase speed $c_{a}$ is positive, the wave propagates in the positive $x$ direction, so the upwind spatial derivative at grid point $j$ uses information from grid point $j-1$. The discretized equation is:\n$$\n\\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t_{\\text{ac}}} + c_{a} \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} = 0\n$$\nRearranging for the solution at the next time step, $\\phi_j^{n+1}$, gives:\n$$\n\\phi_j^{n+1} = \\phi_j^n - \\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x} (\\phi_j^n - \\phi_{j-1}^n)\n$$\nLet's define the Courant number for the acoustic substep, $\\nu_{\\text{ac}}$, as:\n$$\n\\nu_{\\text{ac}} = \\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x}\n$$\nThe discretized equation can then be written as:\n$$\n\\phi_j^{n+1} = (1 - \\nu_{\\text{ac}})\\phi_j^n + \\nu_{\\text{ac}}\\phi_{j-1}^n\n$$\nFor this explicit scheme (forward-in-time, first-order-upwind) to be stable, the coefficients of the terms on the right-hand side must be non-negative. Since $\\nu_{\\text{ac}}$ is inherently positive ($c_a > 0$, $\\Delta t_{\\text{ac}} > 0$, $\\Delta x > 0$), the stability condition is $1 - \\nu_{\\text{ac}} \\ge 0$, which simplifies to the Courant–Friedrichs–Lewy (CFL) stability criterion:\n$$\n\\nu_{\\text{ac}} \\le 1\n$$\nSubstituting the definition of $\\nu_{\\text{ac}}$, we get:\n$$\n\\frac{c_{a} \\Delta t_{\\text{ac}}}{\\Delta x} \\le 1\n$$\nThis implies that the acoustic time step $\\Delta t_{\\text{ac}}$ must satisfy:\n$$\n\\Delta t_{\\text{ac}} \\le \\frac{\\Delta x}{c_{a}}\n$$\nThe problem states that the acoustic mode is integrated with $N_{\\text{ac}}$ substeps of duration $\\Delta t_{\\text{ac}}$ over an overall time step $\\Delta t$, such that $\\Delta t_{\\text{ac}} = \\Delta t / N_{\\text{ac}}$. Substituting this into the stability condition gives:\n$$\n\\frac{\\Delta t}{N_{\\text{ac}}} \\le \\frac{\\Delta x}{c_{a}}\n$$\nWe need to find the minimum integer value of $N_{\\text{ac}}$ that satisfies this condition. Rearranging the inequality for $N_{\\text{ac}}$:\n$$\nN_{\\text{ac}} \\ge \\frac{c_{a} \\Delta t}{\\Delta x}\n$$\nNow, we substitute the given values:\n- $c_a = 320 \\,\\mathrm{m\\,s^{-1}}$\n- $\\Delta t = 60 \\,\\mathrm{s}$\n- $\\Delta x = 2.0 \\,\\mathrm{km} = 2.0 \\times 10^3 \\,\\mathrm{m}$\n\n$$\nN_{\\text{ac}} \\ge \\frac{(320 \\,\\mathrm{m\\,s^{-1}}) \\cdot (60 \\,\\mathrm{s})}{2.0 \\times 10^3 \\,\\mathrm{m}} = \\frac{19200}{2000} = 9.6\n$$\nSince $N_{\\text{ac}}$ must be an integer, the minimum number of acoustic substeps required for stability is the smallest integer greater than or equal to $9.6$.\n$$\nN_{\\text{ac, min}} = 10\n$$\n\nThe second task is to compute the ratio $R = C_{\\text{split}} / C_{\\text{unsplit}}$. The costs for the split-explicit and unsplit explicit approaches are given by:\n$$\nC_{\\text{split}} = C_{\\text{slow}} + C_{\\text{phys}} + N_{\\text{ac}} \\, C_{\\text{ac}}\n$$\n$$\nC_{\\text{unsplit}} = N_{\\text{ac}} \\, (C_{\\text{slow}} + C_{\\text{ac}} + C_{\\text{phys}})\n$$\nWe are given the following cost values per grid column per overall step:\n- $C_{\\text{slow}} = 2.0 \\times 10^{8}$\n- $C_{\\text{ac}} = 0.5 \\times 10^{8}$\n- $C_{\\text{phys}} = 5.0 \\times 10^{8}$\n\nUsing $N_{\\text{ac}} = 10$, we can calculate the two costs.\nFor the split-explicit approach:\n$$\nC_{\\text{split}} = (2.0 \\times 10^{8}) + (5.0 \\times 10^{8}) + 10 \\cdot (0.5 \\times 10^{8})\n$$\n$$\nC_{\\text{split}} = (2.0 + 5.0 + 5.0) \\times 10^{8} = 12.0 \\times 10^{8}\n$$\nFor the unsplit explicit approach:\n$$\nC_{\\text{unsplit}} = 10 \\cdot ((2.0 \\times 10^{8}) + (0.5 \\times 10^{8}) + (5.0 \\times 10^{8}))\n$$\n$$\nC_{\\text{unsplit}} = 10 \\cdot (2.0 + 0.5 + 5.0) \\times 10^{8} = 10 \\cdot (7.5) \\times 10^{8} = 75.0 \\times 10^{8}\n$$\nNow we compute the ratio $R$:\n$$\nR = \\frac{C_{\\text{split}}}{C_{\\text{unsplit}}} = \\frac{12.0 \\times 10^{8}}{75.0 \\times 10^{8}} = \\frac{12.0}{75.0} = \\frac{12}{75}\n$$\nSimplifying the fraction:\n$$\nR = \\frac{4 \\times 3}{25 \\times 3} = \\frac{4}{25} = 0.16\n$$\nThe problem requires this ratio to be rounded to four significant figures.\n$$\nR = 0.1600\n$$\nThe final paired result is $N_{\\text{ac}} = 10$ and $R = 0.1600$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 10 & 0.1600 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While time-splitting techniques are computationally essential, they introduce an approximation error. This error arises because the mathematical operators representing distinct physical processes (like dynamics, $A$) and physical parameterizations (like radiation, $B$) do not generally commute; that is, the final state depends on the order in which they are applied ($AB \\neq BA$). This practice delves into the leading-order source of this splitting error, which is proportional to the Lie commutator $[A,B] = AB - BA$. By using numerically evaluated operator actions—a technique often employed in real model diagnostics—you will estimate the magnitude of the commutator's effect and use it to determine if the error from a simple first-order splitting is acceptable, or if a more accurate (and computationally expensive) second-order scheme is warranted .",
            "id": "4074816",
            "problem": "In a column of an atmospheric model used for Numerical Weather Prediction (NWP), the prognostic state has been nondimensionalized using standard reference scales so that the Euclidean norm is an appropriate measure of magnitude. The time evolution is modeled by the split system $\\frac{d x}{d t} = A x + B x$, where $A$ represents the resolved dynamics operator and $B$ represents the subgrid physics operator. Consider one time step over which $A$ and $B$ are assumed frozen and linearized about the current state $x$. You are given the following numerically evaluated operator actions at the current state:\n- Current state: $x = \\begin{pmatrix} 0.8 \\\\ -0.3 \\\\ 1.2 \\\\ 0.05 \\end{pmatrix}$.\n- Single applications: $A x = \\begin{pmatrix} 0.12 \\\\ -0.08 \\\\ 0.35 \\\\ -0.01 \\end{pmatrix}$ and $B x = \\begin{pmatrix} 0.03 \\\\ 0.02 \\\\ -0.06 \\\\ 0.004 \\end{pmatrix}$.\n- Nested applications: $A(B x) = \\begin{pmatrix} 0.014 \\\\ -0.006 \\\\ 0.020 \\\\ -0.001 \\end{pmatrix}$ and $B(A x) = \\begin{pmatrix} 0.008 \\\\ -0.005 \\\\ 0.015 \\\\ -0.0005 \\end{pmatrix}$.\n\nUsing the Baker–Campbell–Hausdorff expansion up to the minimal order necessary, first derive a leading-order expression for the local splitting error of the first-order Lie–Trotter method in terms of the Lie commutator $[A,B]$ applied to $x$ and a nondimensional time step $\\Delta \\hat{t}$. Then, using the given operator actions, construct a finite-difference approximation to the commutator applied to the state, $[A,B]x$. Define a dimensionless local-error ratio\n$$\nR \\equiv \\frac{1}{\\|x\\|_2}\\,\\frac{\\Delta \\hat{t}^{2}}{2}\\,\\bigl\\|[A,B]x\\bigr\\|_2,\n$$\nwith $\\|\\cdot\\|_2$ the Euclidean norm, and where the nondimensional time step is $\\Delta \\hat{t} \\equiv \\Delta t / T_{\\mathrm{ref}}$ with reference time $T_{\\mathrm{ref}} = 3600\\,\\mathrm{s}$. Take the physical time step to be $\\Delta t = 2400\\,\\mathrm{s}$. A coupling tolerance of $\\tau = 1.0 \\times 10^{-3}$ (dimensionless) is used to judge whether the first-order Lie splitting error is acceptable; if $R > \\tau$, then second-order Strang splitting is warranted for this coupling.\n\nCompute $R$ from the provided data and state whether Strang splitting is warranted, based on the tolerance. Report only the value of $R$ as the final answer, rounded to four significant figures, and expressed as a dimensionless number. Do not include the unit or the decision in the final answer box.",
            "solution": "The problem asks to compute a dimensionless ratio $R$ that quantifies the local error of a first-order Lie-Trotter splitting scheme. First, we derive the leading-order splitting error. The exact solution to $\\frac{d x}{d t} = (A+B)x$ over a time step $\\Delta t$ is $x(\\Delta t) = \\exp((A+B)\\Delta t)x_0$, where $x_0$ is the state at $t=0$.\n\nA first-order Lie-Trotter splitting approximates this evolution as $x_{LT}(\\Delta t) = \\exp(B\\Delta t)\\exp(A\\Delta t)x_0$. The local truncation error is the difference between the exact and approximate solutions after one step. To find the leading-order term of this error, we use a Taylor series expansion for the exponential operators.\n\nThe exact solution operator is:\n$$\n\\exp((A+B)\\Delta t) = I + (A+B)\\Delta t + \\frac{1}{2}(A+B)^2 \\Delta t^2 + O(\\Delta t^3)\n$$\nExpanding the quadratic term:\n$$\n\\exp((A+B)\\Delta t) = I + A\\Delta t + B\\Delta t + \\frac{1}{2}(A^2 + AB + BA + B^2)\\Delta t^2 + O(\\Delta t^3)\n$$\nThe Lie-Trotter approximate operator is:\n$$\n\\exp(B\\Delta t)\\exp(A\\Delta t) = \\left(I + B\\Delta t + \\frac{1}{2}B^2\\Delta t^2 + \\dots\\right)\\left(I + A\\Delta t + \\frac{1}{2}A^2\\Delta t^2 + \\dots\\right)\n$$\nExpanding and keeping terms up to order $\\Delta t^2$:\n$$\n\\exp(B\\Delta t)\\exp(A\\Delta t) = I + A\\Delta t + B\\Delta t + BA\\Delta t^2 + \\frac{1}{2}A^2\\Delta t^2 + \\frac{1}{2}B^2\\Delta t^2 + O(\\Delta t^3)\n$$\nThe local error operator, $L_{err}$, is the difference between the exact and approximate operators:\n$$\nL_{err} = \\exp((A+B)\\Delta t) - \\exp(B\\Delta t)\\exp(A\\Delta t)\n$$\n$$\nL_{err} = \\left[\\frac{1}{2}(A^2 + AB + BA + B^2) - \\left(BA + \\frac{1}{2}A^2 + \\frac{1}{2}B^2\\right)\\right]\\Delta t^2 + O(\\Delta t^3)\n$$\n$$\nL_{err} = \\frac{1}{2}(AB - BA)\\Delta t^2 + O(\\Delta t^3) = \\frac{1}{2}[A,B]\\Delta t^2 + O(\\Delta t^3)\n$$\nwhere $[A,B] = AB - BA$ is the Lie commutator of operators $A$ and $B$. The leading-order local splitting error applied to the state $x$ is therefore $\\frac{1}{2}[A,B]x\\,\\Delta t^2$. The ratio $R$ in the problem is the norm of this error expressed using the non-dimensional time step $\\Delta\\hat{t}$, scaled by the norm of the state $x$.\n\nThe next step is to compute the components of $R$.\n\n1.  **Compute $[A,B]x$**: The action of the commutator on the state $x$ is given by $[A,B]x = A(Bx) - B(Ax)$. Using the provided numerical values:\n    $$\n    [A,B]x = \\begin{pmatrix} 0.014 \\\\ -0.006 \\\\ 0.020 \\\\ -0.001 \\end{pmatrix} - \\begin{pmatrix} 0.008 \\\\ -0.005 \\\\ 0.015 \\\\ -0.0005 \\end{pmatrix} = \\begin{pmatrix} 0.014 - 0.008 \\\\ -0.006 - (-0.005) \\\\ 0.020 - 0.015 \\\\ -0.001 - (-0.0005) \\end{pmatrix} = \\begin{pmatrix} 0.006 \\\\ -0.001 \\\\ 0.005 \\\\ -0.0005 \\end{pmatrix}\n    $$\n2.  **Compute the Euclidean norms**: We need $\\|x\\|_2$ and $\\|[A,B]x\\|_2$.\n    $$\n    \\|x\\|_2 = \\sqrt{(0.8)^2 + (-0.3)^2 + (1.2)^2 + (0.05)^2} = \\sqrt{0.64 + 0.09 + 1.44 + 0.0025} = \\sqrt{2.1725}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{(0.006)^2 + (-0.001)^2 + (0.005)^2 + (-0.0005)^2}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{3.6 \\times 10^{-5} + 1.0 \\times 10^{-6} + 2.5 \\times 10^{-5} + 0.25 \\times 10^{-6}}\n    $$\n    $$\n    \\|[A,B]x\\|_2 = \\sqrt{(36 + 1 + 25 + 0.25) \\times 10^{-6}} = \\sqrt{62.25 \\times 10^{-6}}\n    $$\n3.  **Compute the nondimensional time step $\\Delta \\hat{t}$**:\n    $$\n    \\Delta \\hat{t} = \\frac{\\Delta t}{T_{\\mathrm{ref}}} = \\frac{2400\\,\\mathrm{s}}{3600\\,\\mathrm{s}} = \\frac{24}{36} = \\frac{2}{3}\n    $$\n4.  **Compute the ratio $R$**: Substitute the computed values into the definition of $R$.\n    $$\n    R = \\frac{1}{\\|x\\|_2}\\,\\frac{\\Delta \\hat{t}^{2}}{2}\\,\\bigl\\|[A,B]x\\bigr\\|_2 = \\frac{1}{\\sqrt{2.1725}} \\frac{(2/3)^2}{2} \\sqrt{62.25 \\times 10^{-6}}\n    $$\n    $$\n    R = \\frac{1}{\\sqrt{2.1725}} \\frac{4/9}{2} \\sqrt{62.25} \\times 10^{-3} = \\frac{1}{\\sqrt{2.1725}} \\frac{2}{9} \\sqrt{62.25} \\times 10^{-3}\n    $$\n    $$\n    R = \\frac{2 \\sqrt{62.25}}{9 \\sqrt{2.1725}} \\times 10^{-3} \\approx \\frac{2 \\times 7.889867}{9 \\times 1.473940} \\times 10^{-3}\n    $$\n    $$\n    R \\approx \\frac{15.779734}{13.26546} \\times 10^{-3} \\approx 1.189532 \\times 10^{-3}\n    $$\nRounding the result to four significant figures gives $R \\approx 1.190 \\times 10^{-3}$.\n\nFinally, we compare this value to the tolerance $\\tau = 1.0 \\times 10^{-3}$.\nSince $R \\approx 1.190 \\times 10^{-3} > 1.0 \\times 10^{-3}$, we have $R > \\tau$. This indicates that the local splitting error for the first-order Lie-Trotter method is unacceptably large for this time step, and therefore, the use of a second-order method like Strang splitting is warranted. The final answer is the numerical value of $R$.",
            "answer": "$$\n\\boxed{1.190 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "Beyond numerical stability and accuracy, a paramount concern in climate modeling is the conservation of fundamental physical quantities. A model that artificially creates or destroys energy or mass will produce unrealistic long-term simulations and climate drift. This hands-on problem provides a practical example of a conservation check, focusing on moist static energy (MSE) within a column model featuring a convective parameterization. You will perform a budget analysis by integrating the MSE changes due to convective heating and moistening and comparing this to the energy removed from the column via precipitation. This exercise  demonstrates a crucial diagnostic for assessing the physical integrity of a parameterization scheme and its coupling to the model's dynamics.",
            "id": "4074817",
            "problem": "A single tropical atmospheric column is advanced over a physics (parameterization) time substep of duration $\\Delta t = 1800$ s using operator splitting for physics–dynamics coupling. The column is hydrostatic with surface pressure $p_{s} = 1000$ hPa and model top $p_{t} = 200$ hPa. For this substep, the convective parameterization produces layer-mean heating and moistening tendencies that are treated as constant within four pressure layers of equal thickness $\\Delta p = 200$ hPa: $[1000,800]$ hPa, $[800,600]$ hPa, $[600,400]$ hPa, and $[400,200]$ hPa. The layer-mean convective tendencies are:\n- $Q_{c,1} = 2.0 \\times 10^{-4}$ K s$^{-1}$, $Q_{c,2} = 3.2 \\times 10^{-4}$ K s$^{-1}$, $Q_{c,3} = 2.5 \\times 10^{-4}$ K s$^{-1}$, $Q_{c,4} = 2.4 \\times 10^{-4}$ K s$^{-1}$,\n- $S_{q,1} = -1.00 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$, $S_{q,2} = -1.05 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$, $S_{q,3} = -1.02 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$, $S_{q,4} = -0.98 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$.\n\nAssume a constant mass-weighted specific heat at constant pressure $c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$, constant latent heat of vaporization $L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$, and gravitational acceleration $g = 9.81$ m s$^{-2}$. Neglect changes to the geopotential term over the substep (i.e., treat $g z$ as unchanged by the convective tendencies over $\\Delta t$).\n\nDefine the layer-pressure coordinate column-integrated moist static energy (MSE) tendency due to convection as\n$$\\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{1}{g} \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp,$$\nand the corresponding finite-time change\n$$\\Delta M = \\Delta t \\, \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}}.$$\n\nAt the end of the substep, the convective scheme outputs a surface precipitation rate $R = 3$ mm h$^{-1}$, which corresponds to a precipitation mass flux $P$ (kg m$^{-2}$ s$^{-1}$). In the absence of radiation, surface fluxes, and lateral transport, exact moist static energy conservation requires $c_{p}$-weighted convective heating to balance the $L_{v}$-weighted convective moistening/drying, with consistency relative to the precipitation removal of water substance.\n\nCompute $\\Delta M$ from the given tendencies and then quantify the conservation check relative to precipitation by evaluating the dimensionless residual\n$$\\varepsilon \\equiv \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t}.$$\n\nExpress $\\varepsilon$ as a unitless decimal fraction, rounded to four significant figures. Use the units indicated above and take $1$ mm $=$ $1$ kg m$^{-2}$ for liquid water when converting $R$ to $P$.",
            "solution": "The problem asks for the evaluation of a dimensionless residual $\\varepsilon$, which quantifies the moist static energy (MSE) conservation error of a convective parameterization scheme over a single time substep. The formula for the residual is given as:\n$$ \\varepsilon \\equiv \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t} $$\nwhere $\\Delta M$ is the column-integrated change in MSE due to convection, $L_{v}$ is the latent heat of vaporization, $P$ is the precipitation mass flux, and $\\Delta t$ is the duration of the substep.\n\nFirst, we must calculate the numerator, $\\Delta M$. It is defined as:\n$$ \\Delta M = \\Delta t \\, \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} $$\nwith the column-integrated MSE tendency given by:\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{1}{g} \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp $$\nThe problem states that the convective tendencies, $Q_c(p)$ for heating and $S_q(p)$ for moistening, are constant within four distinct pressure layers of equal thickness. Therefore, the integral can be computed as a sum over these four layers. The pressure thickness of each layer is $\\Delta p = 200$ hPa. For calculations, we must use SI units, so we convert hectopascals (hPa) to pascals (Pa):\n$$ \\Delta p = 200 \\text{ hPa} = 200 \\times 100 \\text{ Pa} = 2 \\times 10^4 \\text{ Pa} $$\nThe integral is thus replaced by a sum multiplied by the layer thickness $\\Delta p$:\n$$ \\int_{p_{t}}^{p_{s}} \\left(c_{p} \\, Q_{c}(p) + L_{v} \\, S_{q}(p) \\right) \\, dp = \\Delta p \\sum_{k=1}^{4} \\left(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k} \\right) $$\nwhere $k$ is the layer index. We are given the following constants and layer-specific tendencies:\n$c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$\n$L_{v} = 2.5 \\times 10^{6}$ J kg$^{-1}$\n$Q_{c,1} = 2.0 \\times 10^{-4}$ K s$^{-1}$, $S_{q,1} = -1.00 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,2} = 3.2 \\times 10^{-4}$ K s$^{-1}$, $S_{q,2} = -1.05 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,3} = 2.5 \\times 10^{-4}$ K s$^{-1}$, $S_{q,3} = -1.02 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n$Q_{c,4} = 2.4 \\times 10^{-4}$ K s$^{-1}$, $S_{q,4} = -0.98 \\times 10^{-7}$ kg kg$^{-1}$ s$^{-1}$\n\nLet us compute the term $(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k})$ for each layer $k$:\nFor layer $k=1$:\n$ (1004) \\cdot (2.0 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.00 \\times 10^{-7}) = 0.2008 - 0.25 = -0.0492 $ J kg$^{-1}$ s$^{-1}$\nFor layer $k=2$:\n$ (1004) \\cdot (3.2 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.05 \\times 10^{-7}) = 0.32128 - 0.2625 = 0.05878 $ J kg$^{-1}$ s$^{-1}$\nFor layer $k=3$:\n$ (1004) \\cdot (2.5 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-1.02 \\times 10^{-7}) = 0.251 - 0.255 = -0.0040 $ J kg$^{-1}$ s$^{-1}$\nFor layer $k=4$:\n$ (1004) \\cdot (2.4 \\times 10^{-4}) + (2.5 \\times 10^{6}) \\cdot (-0.98 \\times 10^{-7}) = 0.24096 - 0.245 = -0.00404 $ J kg$^{-1}$ s$^{-1}$\n\nThe sum over all layers is:\n$$ \\sum_{k=1}^{4} \\left(c_{p} \\, Q_{c,k} + L_{v} \\, S_{q,k} \\right) = -0.0492 + 0.05878 - 0.0040 - 0.00404 = 0.00154 \\text{ J kg}^{-1} \\text{s}^{-1} $$\nNow we can compute the MSE tendency:\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{\\Delta p}{g} \\sum_{k=1}^{4} \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right) = \\frac{2 \\times 10^4 \\text{ Pa}}{9.81 \\text{ m s}^{-2}} \\times (0.00154 \\text{ J kg}^{-1} \\text{s}^{-1}) $$\nThe units are $(\\text{Pa}) \\cdot (\\text{J kg}^{-1} \\text{s}^{-1}) / (\\text{m s}^{-2}) = (\\text{kg m}^{-1} \\text{s}^{-2}) \\cdot (\\text{J kg}^{-1} \\text{s}^{-1}) / (\\text{m s}^{-2}) = \\text{J m}^{-2} \\text{s}^{-1}$, which is a power flux (W m$^{-2}$), as expected.\n$$ \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = \\frac{30.8}{9.81} \\text{ W m}^{-2} $$\nThe total change $\\Delta M$ over the substep $\\Delta t = 1800$ s is:\n$$ \\Delta M = \\Delta t \\left.\\frac{\\partial M}{\\partial t}\\right|_{\\mathrm{conv}} = 1800 \\text{ s} \\times \\frac{30.8}{9.81} \\text{ W m}^{-2} = \\frac{55440}{9.81} \\text{ J m}^{-2} $$\n\nNext, we evaluate the denominator, $L_{v} \\, P \\, \\Delta t$.\nWe are given the surface precipitation rate $R = 3$ mm h$^{-1}$. We must convert this to a mass flux $P$ in SI units (kg m$^{-2}$ s$^{-1}$). Using the conversion $1$ mm of liquid water depth is equivalent to a mass of $1$ kg m$^{-2}$, and knowing that $1$ hour is $3600$ seconds:\n$$ P = 3 \\frac{\\text{mm}}{\\text{h}} \\times \\frac{1 \\text{ kg m}^{-2}}{1 \\text{ mm}} \\times \\frac{1 \\text{ h}}{3600 \\text{ s}} = \\frac{3}{3600} \\text{ kg m}^{-2} \\text{s}^{-1} = \\frac{1}{1200} \\text{ kg m}^{-2} \\text{s}^{-1} $$\nNow we can compute the denominator:\n$$ L_{v} P \\Delta t = (2.5 \\times 10^{6} \\text{ J kg}^{-1}) \\times (\\frac{1}{1200} \\text{ kg m}^{-2} \\text{s}^{-1}) \\times (1800 \\text{ s}) $$\n$$ L_{v} P \\Delta t = (2.5 \\times 10^{6}) \\times \\frac{1800}{1200} = (2.5 \\times 10^{6}) \\times 1.5 = 3.75 \\times 10^{6} \\text{ J m}^{-2} $$\n\nFinally, we compute the dimensionless residual $\\varepsilon$:\n$$ \\varepsilon = \\frac{\\Delta M}{L_{v} \\, P \\, \\Delta t} = \\frac{55440 / 9.81}{3.75 \\times 10^{6}} = \\frac{55440}{9.81 \\times 3.75 \\times 10^{6}} $$\n$$ \\varepsilon = \\frac{55440}{36787500} \\approx 0.001507019...$$\nAlternatively, we can simplify the expression for $\\varepsilon$ before plugging in numbers:\n$$ \\varepsilon = \\frac{\\Delta t \\, \\frac{\\Delta p}{g} \\sum \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right)}{L_{v} P \\Delta t} = \\frac{\\Delta p \\sum \\left(c_{p} Q_{c,k} + L_{v} S_{q,k}\\right)}{g L_{v} P} $$\nNumerator: $\\Delta p \\sum (\\dots) = (2 \\times 10^4) \\times (0.00154) = 30.8$\nDenominator: $g L_{v} P = (9.81) \\times (2.5 \\times 10^6) \\times (\\frac{1}{1200}) = \\frac{9.81 \\times 2.5 \\times 10^6}{1200} = 20437.5$\n$$ \\varepsilon = \\frac{30.8}{20437.5} = 0.001507019...$$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\varepsilon \\approx 0.001507 $$\nThis small positive value indicates a slight artificial creation of energy by the convective scheme, equal to about $0.15\\%$ of the energy associated with the condensed precipitation. An ideally energy-conserving scheme, in the absence of surface fluxes and radiation, would yield $\\varepsilon = 0$.",
            "answer": "$$\\boxed{0.001507}$$"
        }
    ]
}