{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立对K-廓线参数化（KPP）如何表征海洋表面边界层湍流效应的基本理解。通过对比一个简单的均匀混合情景和一个表面混合增强的情景，你将从第一性原理出发，推导出KPP方案如何有效地输运热量并减弱近表面层结。这是KPP方案在气候模式中提升上层海洋模拟真实性的核心机制之一。",
            "id": "4072900",
            "problem": "在一个深度为 $H$ 的一维垂直海洋水柱中，垂直坐标 $z$ 从表面向下为正（即表面处 $z=0$，底部 $z=H$），考虑温度 $T(z,t)$ 在垂直扩散作用下的演变。设原位海水密度为常数 $\\rho_{0}$，定压比热容为 $c_{p}$。在 $z=0$ 处施加一个给定的净表面热通量 $Q_{0}$（规定向下进入海洋为正）。假设水柱内没有内部热源或热汇。在底部，温度固定为 $T(H,t)=T_{b}$，其中 $T_{b}$ 是一个给定的常数。\n\n你需要仅从 (i) 控制体内的热量守恒和 (ii) Fickian 扩散热通量闭合出发，推导稳态温度剖面。不要先验地假设任何目标公式。\n\n(a) 对于在整个水柱中具有均匀背景垂直扩散率 $K_{v}(z)=K_{bg}$ 的情况，推导与表面通量和底部边界条件相符的稳态温度剖面 $T(z)$。\n\n(b) 现在考虑一个类似 K-Profile Parameterization (KPP) 的增强边界层混合，其模型为一个双层分段常数扩散率：\n$$\nK_{v}(z)=\n\\begin{cases}\nK_{bl},   0 \\le z \\le h_{b},\\\\\nK_{bg},   h_{b}  z \\le H,\n\\end{cases}\n$$\n满足 $0  h_b  H$ 且 $K_{bl}  K_{bg}$。推导稳态温度剖面 $T(z)$。\n\n(c) 计算表面（$z=0^+$）温度梯度量级在情况(b)与情况(a)下的比值 $R$。用 $K_{bg}$ 和 $K_{bl}$ 表示你的答案，并解释其物理意义，以及该原理在概念上与Gent-McWilliams参数化的相似之处。",
            "solution": "该问题要求从基本原理出发，推导在一维垂直海洋水柱中，不同垂直扩散率情景下的稳态温度剖面。\n\n首先，我们从热量守恒出发，建立温度 $T(z,t)$ 的控制方程。考虑一个位于深度 $z$ 和 $z+dz$ 之间，水平面积为 $A$、厚度为 $dz$ 的无穷小控制体。该体积内的总热含量为 $A \\cdot dz \\cdot \\rho_0 c_p T$。此热含量的变化率由下式给出：\n$$\n\\frac{d}{dt} (A \\cdot dz \\cdot \\rho_0 c_p T) = A \\rho_0 c_p \\frac{\\partial T}{\\partial t} dz\n$$\n这种变化是由进入该体积的净热通量引起的。令 $J(z,t)$ 为向下的垂直热通量（单位为 W/m$^2$）。在 $z$ 处进入顶面的热量是 $A \\cdot J(z,t)$，在 $z+dz$ 处离开底面的热量是 $A \\cdot J(z+dz,t)$。在没有内部源或汇的情况下，净热量增加率为：\n$$\nA J(z,t) - A J(z+dz,t) \\approx -A \\frac{\\partial J}{\\partial z} dz\n$$\n将热含量变化率与净热通量相等，我们得到：\n$$\nA \\rho_0 c_p \\frac{\\partial T}{\\partial t} dz = -A \\frac{\\partial J}{\\partial z} dz\n$$\n$$\n\\rho_0 c_p \\frac{\\partial T}{\\partial t} = -\\frac{\\partial J}{\\partial z}\n$$\n接下来，我们引用 Fickian 扩散热通量闭合，它将通量与温度梯度联系起来。通量 $J$ 与温度梯度的负值成正比：\n$$\nJ(z,t) = - \\rho_0 c_p K_v(z) \\frac{\\partial T}{\\partial z}\n$$\n此处，$K_v(z)$ 是垂直湍流扩散率。常数 $\\rho_0$ 和 $c_p$ 将运动学通量转换为热通量。负号确保热量沿梯度向下流动（从较暖区域到较冷区域）。\n将通量闭合代入守恒方程，得到一维热扩散方程：\n$$\n\\rho_0 c_p \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial z} \\left( \\rho_0 c_p K_v(z) \\frac{\\partial T}{\\partial z} \\right)\n$$\n由于 $\\rho_0$ 和 $c_p$ 是常数，它们可以被消去：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial z} \\left( K_v(z) \\frac{\\partial T}{\\partial z} \\right)\n$$\n对于稳态解，$\\frac{\\partial T}{\\partial t} = 0$，因此稳态温度剖面 $T(z)$ 的控制方程变为：\n$$\n\\frac{d}{dz} \\left( K_v(z) \\frac{dT}{dz} \\right) = 0\n$$\n将此方程对 $z$ 积分一次，得到：\n$$\nK_v(z) \\frac{dT}{dz} = C\n$$\n其中 $C$ 是一个积分常数。我们可以将其与热通量联系起来。根据 Fickian 闭合，稳态通量为 $J(z) = -\\rho_0 c_p K_v(z) \\frac{dT}{dz} = -\\rho_0 c_p C$。这意味着垂直热通量随深度不变，这在没有内部源的稳态中是预期的。这个恒定通量必须等于给定的表面热通量 $Q_0$。因此，对于所有 $z \\in [0, H]$，$J(z) = Q_0$。\n这给了我们核心的工作方程：\n$$\n-\\rho_0 c_p K_v(z) \\frac{dT}{dz} = Q_0 \\implies K_v(z) \\frac{dT}{dz} = -\\frac{Q_0}{\\rho_0 c_p}\n$$\n\n(a) 均匀背景垂直扩散率 $K_v(z) = K_{bg}$\n对于这种情况，控制方程为：\n$$\nK_{bg} \\frac{dT}{dz} = -\\frac{Q_0}{\\rho_0 c_p}\n$$\n温度梯度是恒定的：\n$$\n\\frac{dT}{dz} = -\\frac{Q_0}{\\rho_0 c_p K_{bg}}\n$$\n将此式对 $z$ 积分，得到温度剖面：\n$$\nT(z) = -\\frac{Q_0}{\\rho_0 c_p K_{bg}} z + C_1\n$$\n其中 $C_1$ 是一个积分常数。我们使用底部边界条件 $T(H) = T_b$ 来确定 $C_1$：\n$$\nT_b = -\\frac{Q_0 H}{\\rho_0 c_p K_{bg}} + C_1 \\implies C_1 = T_b + \\frac{Q_0 H}{\\rho_0 c_p K_{bg}}\n$$\n将 $C_1$ 代回，稳态温度剖面是：\n$$\nT(z) = T_b + \\frac{Q_0 H}{\\rho_0 c_p K_{bg}} - \\frac{Q_0 z}{\\rho_0 c_p K_{bg}} = T_b + \\frac{Q_0}{\\rho_0 c_p K_{bg}}(H-z)\n$$\n\n(b) 类 KPP 的双层扩散率\n扩散率由一个分段函数给出。我们在每一层中求解温度剖面，然后在界面 $z=h_b$ 处匹配解。向下的热通量 $Q_0$ 在整个水柱中是恒定的。\n对于上层（$0 \\le z \\le h_b$），$K_v(z) = K_{bl}$。令温度剖面为 $T_{upper}(z)$。\n$$\nK_{bl} \\frac{dT_{upper}}{dz} = -\\frac{Q_0}{\\rho_0 c_p} \\implies \\frac{dT_{upper}}{dz} = -\\frac{Q_0}{\\rho_0 c_p K_{bl}}\n$$\n积分得到：\n$$\nT_{upper}(z) = -\\frac{Q_0}{\\rho_0 c_p K_{bl}} z + C_2\n$$\n对于下层（$h_b  z \\le H$），$K_v(z) = K_{bg}$。令温度剖面为 $T_{lower}(z)$。\n$$\nK_{bg} \\frac{dT_{lower}}{dz} = -\\frac{Q_0}{\\rho_0 c_p} \\implies \\frac{dT_{lower}}{dz} = -\\frac{Q_0}{\\rho_0 c_p K_{bg}}\n$$\n积分得到：\n$$\nT_{lower}(z) = -\\frac{Q_0}{\\rho_0 c_p K_{bg}} z + C_3\n$$\n我们有两个常数 $C_2$ 和 $C_3$，需要根据边界条件和匹配条件来确定。\n首先，应用底部边界条件 $T(H) = T_b$，它适用于下层解：\n$$\nT_{lower}(H) = T_b \\implies T_b = -\\frac{Q_0 H}{\\rho_0 c_p K_{bg}} + C_3 \\implies C_3 = T_b + \\frac{Q_0 H}{\\rho_0 c_p K_{bg}}\n$$\n因此，下层的解是：\n$$\nT_{lower}(z) = T_b + \\frac{Q_0}{\\rho_0 c_p K_{bg}}(H-z)\n$$\n接下来，应用界面 $z=h_b$ 处的温度连续性条件：$T_{upper}(h_b) = T_{lower}(h_b)$。\n$$\n-\\frac{Q_0 h_b}{\\rho_0 c_p K_{bl}} + C_2 = T_b + \\frac{Q_0}{\\rho_0 c_p K_{bg}}(H-h_b)\n$$\n求解 $C_2$：\n$$\nC_2 = T_b + \\frac{Q_0(H-h_b)}{\\rho_0 c_p K_{bg}} + \\frac{Q_0 h_b}{\\rho_0 c_p K_{bl}} = T_b + \\frac{Q_0}{\\rho_0 c_p} \\left( \\frac{H-h_b}{K_{bg}} + \\frac{h_b}{K_{bl}} \\right)\n$$\n将 $C_2$ 代回上层解中：\n$$\nT_{upper}(z) = T_b + \\frac{Q_0}{\\rho_0 c_p} \\left( \\frac{H-h_b}{K_{bg}} + \\frac{h_b}{K_{bl}} \\right) - \\frac{Q_0 z}{\\rho_0 c_p K_{bl}} = T_b + \\frac{Q_0}{\\rho_0 c_p} \\left( \\frac{H-h_b}{K_{bg}} + \\frac{h_b-z}{K_{bl}} \\right)\n$$\n因此，完整的稳态温度剖面 $T(z)$ 是：\n$$\nT(z) = \\begin{cases} T_b + \\frac{Q_0}{\\rho_0 c_p} \\left( \\frac{H-h_b}{K_{bg}} + \\frac{h_b-z}{K_{bl}} \\right),  0 \\le z \\le h_b \\\\ T_b + \\frac{Q_0}{\\rho_0 c_p K_{bg}}(H-z),  h_b  z \\le H \\end{cases}\n$$\n恒定垂直热通量的条件在我们的推导中已经内在地满足了，因为它导致了一个分段常数梯度。\n\n(c) 梯度减小因子\n对于均匀背景情况(a)，温度梯度在整个水柱中是恒定的：\n$$\n\\frac{dT}{dz} = -\\frac{Q_0}{\\rho_0 c_p K_{bg}}\n$$\n这个梯度的量级是：\n$$\nG_{bg} = \\left| \\frac{dT}{dz} \\right| = \\frac{Q_0}{\\rho_0 c_p K_{bg}}\n$$\n我们假设 $Q_0, \\rho_0, c_p, K_{bg}$ 均为正值。\n\n对于增强混合情况(b)，表层温度梯度是上层的梯度，在 $0 \\le z \\le h_b$ 范围内是恒定的：\n$$\n\\frac{dT}{dz} = -\\frac{Q_0}{\\rho_0 c_p K_{bl}}\n$$\n表面（$z=0^+$）处的梯度量级是：\n$$\nG_{bl} = \\left| \\frac{\\partial T}{\\partial z} \\right|_{z=0^+} = \\frac{Q_0}{\\rho_0 c_p K_{bl}}\n$$\n\n梯度减小因子 $R$ 是这两个梯度量级的比值：\n$$\nR = \\frac{G_{bl}}{G_{bg}} = \\frac{\\frac{Q_0}{\\rho_0 c_p K_{bl}}}{\\frac{Q_0}{\\rho_0 c_p K_{bg}}} = \\frac{K_{bg}}{K_{bl}}\n$$\n按要求，该表达式是无量纲的。\n\n解释：K-Profile Parameterization（KPP）方案旨在表示海洋表层边界层中因风应力和表面浮力强迫而发生的增强垂直混合。我们的简化模型通过设置 $K_{bl}  K_{bg}$ 来捕捉这一点。结果 $R = K_{bg}/K_{bl}$ 表明，由于 $K_{bl}  K_{bg}$，我们有 $R  1$。这意味着近表面温度梯度的量级因增强的混合而减小。从物理上讲，为了维持一个固定的表面热通量 $Q_0$，一个更大的湍流扩散率 $K_v$ 允许一个更小的温度梯度 $|\\frac{dT}{dz}|$，如关系式 $| \\frac{dT}{dz} | = \\frac{Q_0}{\\rho_0 c_p K_v}$ 所示。增强的混合在向下输送热量方面更有效，从而使表层均匀化并削弱垂直温度分层。\n\n这一原理在概念上类似于 Gent–McWilliams（GM）参数化的效果。GM 解释了由中尺度涡旋引起的绝热搅动，这些涡旋在粗分辨率的气候模型中是无法解析的。这种涡旋引起的输运作用是使等密面（等密度面）变平。对于像温度这样的示踪物，这个过程通常被参数化为一种额外的“厚度扩散”或一种有效的垂直混合。就像 KPP 中的增强边界层混合一样，GM 中的涡旋诱导混合导致海洋内部热量和其他示踪物更有效的垂直输运。这种增强的输运减小了这些示踪物的大尺度垂直梯度，使模拟的分层更接近于在真实海洋中观测到的情况。因此，KPP 和 GM 尽管代表了不同尺度上的不同物理混合过程，但它们都具有通过参数化次网格尺度输运来减小平均垂直示踪物梯度的共同效果。",
            "answer": "$$\n\\boxed{\\frac{K_{bg}}{K_{bl}}}\n$$"
        },
        {
            "introduction": "气候模式使用了一整套参数化方案，理解这些方案的有效适用范围至关重要。本练习旨在挑战你区分中尺度涡和次中尺度涡，前者通常由Gent-McWilliams（GM）方案参数化，而后者GM方案则难以胜任。通过此分析，你将深化对支撑这些方案的物理假设（如罗斯贝数 $Ro$ 和非绝热效应）的理解。",
            "id": "4072888",
            "problem": "考虑深度为 $H$ 的上层海洋混合层，它位于中纬度地区，受表面的风应力和浮力通量驱动，科里奥利参数为 $f$。大尺度海洋在旋转坐标系中由 Boussinesq、静力原始方程控制，这些方程描述了速度 $\\boldsymbol{u} = (u,v)$、垂直速度 $w$ 和浮力 $b$：\n$$\n\\frac{D \\boldsymbol{u}}{D t} + f \\boldsymbol{k} \\times \\boldsymbol{u} = - \\nabla_h \\phi + \\boldsymbol{\\mathcal{F}}_h, \\quad\n\\frac{\\partial \\phi}{\\partial z} = b, \\quad\n\\frac{D b}{D t} = \\mathcal{B} + \\mathcal{M},\n$$\n其中 $D/Dt$ 是物质导数，$\\phi$ 是动力压强除以参考密度，$\\nabla_h$ 是水平梯度算子，$\\boldsymbol{\\mathcal{F}}_h$ 代表次网格水平动量混合，$\\mathcal{B}$ 代表非绝热浮力源（例如，表面冷却/加热），$\\mathcal{M}$ 代表未解析的混合效应。Ertel 位涡 $q$ 定义为 $q \\equiv \\boldsymbol{\\omega}_a \\cdot \\nabla b$，其中 $\\boldsymbol{\\omega}_a = \\nabla \\times \\boldsymbol{u} + f \\boldsymbol{k}$ 是绝对涡度。在绝热、无粘性的内部区域，$q$ 满足 $D q/D t = 0$。\n\n亚中尺度混合层涡在 $\\mathcal{O}(1)$ $\\mathrm{km}$ 到 $\\mathcal{O}(10)$ $\\mathrm{km}$ 的水平尺度上被观测到，其特征速度使得罗斯贝数 $Ro \\equiv U/(f L)$ 满足 $Ro \\sim \\mathcal{O}(1)$，并且它们在表面边界层中活动，其中非绝热项 $\\mathcal{B}$ 和垂直混合 $\\mathcal{M}$ 不可忽略。相比之下，中尺度内部涡通常具有 $L \\sim \\mathcal{O}(10^2)$ $\\mathrm{km}$ 和 $Ro \\ll 1$，并且在很大程度上是绝热的。Gent–McWilliams (GM) 参数化 (Gent–McWilliams) 旨在表示中尺度内部的绝热搅动，其形式为与等密度面对齐的涡致、无辐散团块输运和厚度扩散，其涡动扩散系数针对中尺度动力学进行了调整。\n\n假设混合层深度 $H = 50$ $\\mathrm{m}$，侧向浮力梯度大小 $M^2 \\equiv |\\nabla_h b| = 5 \\times 10^{-7}$ $\\mathrm{s}^{-2}\\ \\mathrm{m}^{-1}$，科里奥利参数 $f = 10^{-4}$ $\\mathrm{s}^{-1}$，特征水平尺度 $L = 5$ $\\mathrm{km}$，特征水平速度 $U = 0.5$ $\\mathrm{m}\\ \\mathrm{s}^{-1}$。混合层正下方的层结为 $N^2 = 5 \\times 10^{-5}$ $\\mathrm{s}^{-2}$，贯穿混合层的垂直切变为 $S = 5 \\times 10^{-3}$ $\\mathrm{s}^{-1}$。考虑以下基于控制方程和地球物理尺度分析的步骤：\n\n- 计算给定尺度下的罗斯贝数 $Ro$ 和梯度理查森数 $Ri \\equiv N^2/S^2$。\n- 利用绝热内部区域的 $D q/D t = 0$ 并认识到表面边界层中存在 $\\mathcal{B}$ 和 $\\mathcal{M}$，定性地论证亚中尺度混合层涡的再层结在本质上是绝热的还是非绝热的，以及一个与等密度面对齐的无辐散团块速度是否能产生净的混合层浮力趋势。\n- 基于尺度分析和 PV 约束，确定下面哪个陈述最能定义亚中尺度混合层涡，并从第一性原理出发，解释为什么为中尺度内部过程调整的 Gent–McWilliams 参数化不足以表示它们在混合层中的再层结效应。同时，指出 K-剖面参数化 (KPP; K-Profile Parameterization) 在正确表示混合层过程中的作用（如果有的话）。\n\n哪个选项与分析最一致？\n\nA. 亚中尺度混合层涡是非绝热表面边界层中尺度为 $\\mathcal{O}(1$–$10)$ $\\mathrm{km}$、$Ro \\sim \\mathcal{O}(1)$ 的特征，由锋生和非地转次级环流引起，导致等密度面塌陷并产生净的混合层浮力趋势（再层结）。由于 Gent–McWilliams 表示的是为 $Ro \\ll 1$ 调整的、具有无辐散、沿等密度面团块输运的中尺度内部绝热搅动，因此它在构造上无法在混合层中产生所需的非绝热再层结。正确的表示需要一个混合层涡再层结参数化与边界层垂直混合（例如，K-剖面参数化）配对，以处理非绝热效应。\n\nB. 亚中尺度混合层涡只是具有 $Ro \\ll 1$ 和绝热动力学的缩小版中尺度涡；Gent–McWilliams 可以通过充分增加等密度面扩散系数来捕捉再层结，而无需考虑边界层因素。\n\nC. Gent–McWilliams 不足的原因是它完全忽略了等密度面扩散；因此，在混合层中添加一个任意大小的等密度面扩散项将正确地产生再层结，而无需引用非绝热效应或非地转环流。\n\nD. K-剖面参数化本身就可以通过增强表面边界层中的垂直混合来完全表示再层结；侧向涡通量和非地转环流是不必要的，因此可以在混合层中省略 Gent–McWilliams 而不损失再层结物理过程。\n\nE. Gent–McWilliams 在混合层中失败的唯一原因是它忽略了对称不稳定性；在 Gent–McWilliams 中添加一个对称不稳定性项，同时保留其绝热、无辐散的团块输运，就足以重现再层结，而无需考虑罗斯贝数和非绝热表面通量。\n\n选择一个选项。",
            "solution": "首先通过提取给定条件并评估其科学合理性、一致性和完整性来验证问题陈述。\n\n### 步骤 1：提取给定条件\n\n- **控制方程**：大尺度海洋由 Boussinesq、静力原始方程控制：\n    - 动量：$\\frac{D \\boldsymbol{u}}{D t} + f \\boldsymbol{k} \\times \\boldsymbol{u} = - \\nabla_h \\phi + \\boldsymbol{\\mathcal{F}}_h$\n    - 静力平衡：$\\frac{\\partial \\phi}{\\partial z} = b$\n    - 浮力：$\\frac{D b}{D t} = \\mathcal{B} + \\mathcal{M}$\n- **定义**：\n    - $\\boldsymbol{u} = (u,v)$：水平速度矢量\n    - $w$：垂直速度\n    - $b$：浮力\n    - $f$：科里奥利参数\n    - $\\phi$：动力压强除以参考密度\n    - $\\nabla_h$：水平梯度算子\n    - $\\boldsymbol{\\mathcal{F}}_h$：次网格水平动量混合\n    - $\\mathcal{B}$：非绝热浮力源\n    - $\\mathcal{M}$：未解析的混合效应\n    - Ertel 位涡 (PV)：$q \\equiv \\boldsymbol{\\omega}_a \\cdot \\nabla b$，其中 $\\boldsymbol{\\omega}_a = \\nabla \\times \\boldsymbol{u} + f \\boldsymbol{k}$ 是绝对涡度。\n- **动力学机制**：\n    - **绝热、无粘性内部**：位涡的物质导数为零，$D q/D t = 0$。\n    - **亚中尺度混合层涡**：\n        - 水平尺度 $L \\sim \\mathcal{O}(1)$ 至 $\\mathcal{O}(10)$ $\\mathrm{km}$。\n        - 罗斯贝数 $Ro \\equiv U/(f L) \\sim \\mathcal{O}(1)$。\n        - 环境：表面边界层，其中 $\\mathcal{B}$ 和 $\\mathcal{M}$ 不可忽略。\n    - **中尺度内部涡**：\n        - 水平尺度 $L \\sim \\mathcal{O}(10^2)$ $\\mathrm{km}$。\n        - 罗斯贝数 $Ro \\ll 1$。\n        - 环境：很大程度上是绝热的。\n- **参数化方案**：\n    - **Gent–McWilliams (GM)**：通过一个涡致、无辐散的团块输运和与等密度面对齐的厚度扩散来表示中尺度内部的绝热搅动，为 $Ro \\ll 1$ 调整。\n    - **K-剖面参数化 (KPP)**：被提及为用于边界层垂直混合的参数化方案。\n- **数值**：\n    - 混合层深度：$H = 50$ $\\mathrm{m}$\n    - 侧向浮力梯度大小：$M^2 \\equiv |\\nabla_h b| = 5 \\times 10^{-7}$ $\\mathrm{s}^{-2}\\ \\mathrm{m}^{-1}$\n    - 科里奥利参数：$f = 10^{-4}$ $\\mathrm{s}^{-1}$\n    - 特征水平尺度：$L = 5$ $\\mathrm{km} = 5 \\times 10^3$ $\\mathrm{m}$\n    - 特征水平速度：$U = 0.5$ $\\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - 混合层下方的层结：$N^2 = 5 \\times 10^{-5}$ $\\mathrm{s}^{-2}$\n    - 贯穿混合层的垂直切变：$S = 5 \\times 10^{-3}$ $\\mathrm{s}^{-1}$\n\n### 步骤 2：使用提取的给定条件进行验证\n\n问题陈述在地球物理流体动力学的既定原理上具有坚实的科学基础。关于中尺度和亚中尺度动力学、位涡守恒以及 GM 和 KPP 参数化作用的描述是准确的，代表了物理海洋学和气候模拟领域的标准知识。控制方程是海洋模型中使用的标准原始方程。所有术语都有明确的定义。\n\n所提供的数值对于中纬度海洋锋区是物理上现实的。\n- $f = 10^{-4}$ $\\mathrm{s}^{-1}$ 对应于大约 $43^{\\circ}$ 的纬度。\n- $H=50$ $\\mathrm{m}$ 是一个典型的混合层深度。\n- $N^2 = 5 \\times 10^{-5}$ $\\mathrm{s}^{-2}$ 对于季节性温跃层是一个合理的值。\n- $U$、$L$ 和 $M^2$ 的值是高能亚中尺度特征的典型值。\n\n该问题是适定的，提供了足够的信息和明确的任务以得出合理的结论。没有内部矛盾、歧义或事实错误。\n\n### 步骤 3：结论和行动\n\n问题陈述是 **有效的**。可以继续进行分析。\n\n### 解答推导\n\n在评估选项之前，问题需要进行三部分分析。\n\n1.  **无量纲数的计算**：\n    - **罗斯贝数 ($Ro$)**：该数比较了动量方程中惯性加速度项 ($U^2/L$) 与科里奥利项 ($fU$) 的大小。其定义为 $Ro \\equiv U/(f L)$。\n      使用给定值：\n      $$ Ro = \\frac{U}{f L} = \\frac{0.5 \\ \\mathrm{m}\\ \\mathrm{s}^{-1}}{(10^{-4} \\ \\mathrm{s}^{-1}) (5 \\times 10^3 \\ \\mathrm{m})} = \\frac{0.5}{0.5} = 1 $$\n      罗斯贝数 $Ro = 1$ 证实了亚中尺度动力学特征为 $Ro \\sim \\mathcal{O}(1)$ 的说法。这表明流动是非地转的，意味着科里奥利力在平流加速度中不占主导地位，流动远离地转平衡。这与中尺度涡 ($Ro \\ll 1$) 形成鲜明对比。\n\n    - **梯度理查森数 ($Ri$)**：该数比较了层结的稳定效应 ($N^2$) 与垂直切变的不稳定效应 ($S^2$)。其定义为 $Ri \\equiv N^2/S^2$。层结是针对混合层正下方的区域给出的，而切变是贯穿混合层的，因此该计算评估的是混合层底部的稳定性。\n      使用给定值：\n      $$ S^2 = (5 \\times 10^{-3} \\ \\mathrm{s}^{-1})^2 = 25 \\times 10^{-6} \\ \\mathrm{s}^{-2} = 2.5 \\times 10^{-5} \\ \\mathrm{s}^{-2} $$\n      $$ Ri = \\frac{N^2}{S^2} = \\frac{5 \\times 10^{-5} \\ \\mathrm{s}^{-2}}{2.5 \\times 10^{-5} \\ \\mathrm{s}^{-2}} = 2 $$\n      $Ri > 1/4$ 的值表明对于开尔文-亥姆霍兹切变不稳定性是稳定的。然而，亚中尺度不稳定性通常具有斜压性质，由水平浮力梯度驱动，这与给定的较大 $M^2$ 值一致。\n\n2.  **关于再层结性质的定性论证**：\n    浮力方程为 $\\frac{D b}{D t} = \\mathcal{B} + \\mathcal{M}$。\n    - 在中尺度涡所在的 **绝热内部**，表面通量缺失 ($\\mathcal{B}=0$) 且未解析的混合很弱，导致近似为 $Db/Dt \\approx 0$。涡动是绝热的。\n    - 在亚中尺度涡所在的 **表面边界层**，表面通量 ($\\mathcal{B}$) 和垂直混合 ($\\mathcal{M}$) 根据定义都是不可忽略的。亚中尺度涡的生命周期与这些非绝热过程内在耦合。例如，由表面冷却 ($\\mathcal{B}  0$) 驱动的对流可以加深混合层并产生强的水平浮力梯度，然后变得不稳定，导致亚中尺度涡。这些涡使锋面塌陷，将较轻的水输送到较重的水之上，从而使混合层再层结。被带到表面的重水随后受到表面通量（例如加热）的影响，从而改变其浮力。这种对闭合绝热循环的打破意味着涡对混合层浮力收支的净效应是 **非绝热的**。\n    - Gent-McWilliams 参数化基于绝热搅动 ($Db/Dt=0$) 的前提。它以释放有效位能的方式表示等密度面的塌陷，但它是通过一个本质上是绝热的框架（变换欧拉平均）来实现的。它无法表示涡输运和表面通量相互作用所产生的混合层净浮力趋势。具体来说，GM 使用一个涡致团块速度 $\\boldsymbol{u}^*$，该速度是无辐散的 ($\\nabla \\cdot \\boldsymbol{u}^* = 0$) 并且其结构是为了沿流线守恒示踪物。这样的速度场可以重新分布浮力，但其本身无法在混合层的体积平均浮力中产生净变化，而这正是在非绝热背景下再层结所需要的。与亚中尺度涡相关的非地转次级环流在水平方向上不是无辐散的，它驱动垂直速度，将浮力输运穿过混合层底部，整个过程由非绝热表面通量闭合。\n\n3.  **GM 和 KPP 的作用**：\n    - **GM 的不足**：基于以上分析，GM 的不足主要有三个原因：(1) 它是为 $Ro \\ll 1$ 的动力学设计的，而不是亚中尺度的 $Ro \\sim \\mathcal{O}(1)$ 动力学。(2) 它是一个绝热参数化，不适用于非绝热的表面边界层。(3) 它的无辐散团块速度在结构上无法产生与亚中尺度再层结相关的净浮力趋势。\n    - **KPP 的作用**：KPP 是一个垂直边界层混合方案。其主要功能是参数化混合上层海洋的湍流，加深混合层并侵蚀层结。它的作用与再层结相反。因此，对混合层物理的完整表示必须既包括驱动均匀化的垂直混合（由像 KPP 这样的方案参数化），也包括侧向亚中尺度涡的再层结效应。KPP 本身不能产生再层结。这表明需要一个专门的亚中尺度涡参数化方案与像 KPP 这样的方案协同工作。\n\n### 逐项分析\n\n**A. 亚中尺度混合层涡是非绝热表面边界层中尺度为 $\\mathcal{O}(1$–$10)$ $\\mathrm{km}$、$Ro \\sim \\mathcal{O}(1)$ 的特征，由锋生和非地转次级环流引起，导致等密度面塌陷并产生净的混合层浮力趋势（再层结）。由于 Gent–McWilliams 表示的是为 $Ro \\ll 1$ 调整的、具有无辐散、沿等密度面团块输运的中尺度内部绝热搅动，因此它在构造上无法在混合层中产生所需的非绝热再层结。正确的表示需要一个混合层涡再层结参数化与边界层垂直混合（例如，K-剖面参数化）配对，以处理非绝热效应。**\n该选项准确地总结了我们分析得出的所有要点。它正确地指出了亚中尺度涡的尺度、动力学 ($Ro \\sim 1$)、位置（非绝热边界层）和机制（非地转环流）。它正确地指出了 GM 的根本局限性（中尺度、$Ro \\ll 1$、绝热），并正确地得出结论，即一个完整的模型需要一个垂直混合方案（如 KPP）和一个独立的亚中尺度再层结方案。\n**结论：正确。**\n\n**B. 亚中尺度混合层涡只是具有 $Ro \\ll 1$ 和绝热动力学的缩小版中尺度涡；Gent–McWilliams 可以通过充分增加等密度面扩散系数来捕捉再层结，而无需考虑边界层因素。**\n该选项是错误的。问题陈述和我们的计算表明，亚中尺度涡的 $Ro \\sim \\mathcal{O}(1)$，而不是 $Ro \\ll 1$。它们存在于非绝热边界层中，因此其动力学不是绝热的。简单地增加 GM 的扩散系数并不能改变该参数化的基本物理原理，而该原理不适用于这种动力学机制。\n**结论：错误。**\n\n**C. Gent–McWilliams 不足的原因是它完全忽略了等密度面扩散；因此，在混合层中添加一个任意大小的等密度面扩散项将正确地产生再层结，而无需引用非绝热效应或非地转环流。**\n该选项错误地描述了 GM。GM 方案*是*一种涡致输运的参数化，其结果是等密度面厚度的扩散；它并非“完全忽略等密度面扩散”。核心问题是 GM 框架的潜在物理假设（绝热、地转），而不仅仅是省略了一个扩散项。所需的物理过程涉及非地转和非绝热效应，而该选项错误地忽略了这些效应。\n**结论：错误。**\n\n**D. K-剖面参数化本身就可以通过增强表面边界层中的垂直混合来完全表示再层结；侧向涡通量和非地转环流是不必要的，因此可以在混合层中省略 Gent–McWilliams 而不损失再层结物理过程。**\n该选项从根本上误解了 KPP 的作用。KPP 是一种垂直混合方案，主要*破坏*混合层内的层结。再层结是通过侧向涡通量和相关的垂直环流实现的，这些过程不包含在 KPP 中。因此，KPP 本身不能表示再层结；它表示的是相反的过程。\n**结论：错误。**\n\n**E. Gent–McWilliams 在混合层中失败的唯一原因是它忽略了对称不稳定性；在 Gent–McWilliams 中添加一个对称不稳定性项，同时保留其绝热、无辐散的团块输运，就足以重现再层结，而无需考虑罗斯贝数和非绝热表面通量。**\n该选项过于狭隘且物理上不一致。虽然对称不稳定性是一种亚中尺度过程，但它不是唯一的，混合层斜压不稳定性也至关重要。更重要的是，GM 的根本缺陷是其绝热和 $Ro \\ll 1$ 的假设。在保留“绝热、无辐散团块输运”框架的同时，试图为一个内在的非地转、非绝热过程添加一个项，在逻辑上是不一致的。亚中尺度物理与 $Ro \\sim 1$ 和非绝热通量密不可分，而该选项错误地声称可以忽略这些因素。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "控制海洋混合的物理定律是连续的，但气候模式是离散的。最后的这个练习旨在通过探索垂直扩散方案（KPP的核心）的数值实现来弥合这一差距。你将分析一种常用数值格式的稳定性和准确性，从而揭示模式开发者在实现这些物理参数化方案时所面临的实际约束。",
            "id": "4072907",
            "problem": "考虑在大型数值天气预报和气候模型中使用的、深度为 $H$ 的海洋水柱中，被动示踪物 $T(z,t)$ 的一维垂直扩散。垂直湍流扩散系数 $K_{v}(z)$ 代表跨等密度面混合，在表层边界层中遵循K剖面参数化（KPP），而在其他地方，大尺度涡旋搅拌通过Gent–McWilliams参数化来表示；在此，我们仅关注垂直（跨等密度面）扩散分量。控制方程是菲克扩散下的示踪物守恒方程，\n$$\n\\frac{\\partial T}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial z}\\!\\left(K_{v}(z)\\,\\frac{\\partial T}{\\partial z}\\right),\n$$\n在 $\\,z=0\\,$（表面）和 $\\,z=H\\,$（底部）处具有零通量（诺伊曼）边界条件 $\\,\\frac{\\partial T}{\\partial z}=0\\,$。令垂直坐标 $z$ 向下增加。\n\n在均匀网格 $z_{i}=i\\,\\Delta z$（$i=0,1,\\dots,N$）上对水柱进行离散化，网格间距为 $\\Delta z=H/N$。记 $T_{i}^{n}\\approx T(z_{i},t^{n})$，并通过算术平均近似界面扩散系数 $\\,K_{i+\\frac{1}{2}}=\\frac{1}{2}(K_{i}+K_{i+1})$。考虑半隐式单参数 $\\theta$-格式：\n$$\n\\frac{T_{i}^{n+1}-T_{i}^{n}}{\\Delta t} \\;=\\; \\theta\\,\\mathcal{L}\\!\\left[T^{n+1}\\right]_{i} \\;+\\; (1-\\theta)\\,\\mathcal{L}\\!\\left[T^{n}\\right]_{i},\n$$\n其中离散扩散算子为\n$$\n\\mathcal{L}\\!\\left[T\\right]_{i} \\;=\\; \\frac{1}{\\Delta z^{2}}\\left[\\,K_{i+\\frac{1}{2}}\\left(T_{i+1}-T_{i}\\right) \\;-\\; K_{i-\\frac{1}{2}}\\left(T_{i}-T_{i-1}\\right)\\,\\right],\n$$\n适用于内部指数 $\\,i=1,\\dots,N-1\\,$，边界条件通过零通量一致地强制执行。\n\n任务：\n1. 推导关于未知数 $\\{T_{i}^{n+1}\\}_{i=0}^{N}$ 的三对角线性系统，将内部第 $i$ 行写成 $\\,a_{i}\\,T_{i-1}^{n+1}+b_{i}\\,T_{i}^{n+1}+c_{i}\\,T_{i+1}^{n+1}=r_{i}\\,$ 的形式，并用 $\\,\\theta$、$\\,\\Delta t$、$\\,\\Delta z$、$\\,K_{i\\pm\\frac{1}{2}}$ 和 $\\,T^{n}$ 明确给出 $a_{i}$、$b_{i}$、$c_{i}$ 和 $r_{i}$。说明系数的符号模式以及成为一个M-矩阵所需的行和性质。\n2. 使用第一性原理（质量守恒和菲克扩散的离散形式），给出系数矩阵是严格对角占优和一个M-矩阵（对角线为正，非对角线为非正）的充分条件，然后推导出一个关于 $\\Delta t$ 的充分界限，以确保对于 $\\,\\theta\\in[1/2,1]$，更新过程 $\\,T^{n}\\mapsto T^{n+1}\\,$ 保持单调性。\n3. 设扩散系数遵循类K剖面参数化（KPP）的垂直结构：在深度为 $\\,h=50\\,\\text{m}\\,$ 的表层边界层中，$K_{v}(z)=K_{0}$ 是常数，其下则指数地过渡到背景值 $K_{b}$，\n$$\nK_{v}(z) \\;=\\; \\begin{cases}\nK_{0},  0 \\le z \\le h, \\\\\nK_{b} + (K_{0}-K_{b})\\,\\exp\\!\\left(-\\frac{z-h}{z_{*}}\\right),  zh,\n\\end{cases}\n$$\n其中 $\\,K_{0}=1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，$\\,K_{b}=1.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，且 $\\,z_{*}=200\\,\\text{m}$。考虑一个深度为 $\\,H=1000\\,\\text{m}\\,$ 的水柱，均匀网格间距为 $\\,\\Delta z=10\\,\\text{m}\\,$，并选择 $\\,\\theta=0.7\\,$。使用你得出的充分条件，计算保证此半隐式格式对角占优和单调性保持的最大允许时间步长 $\\,\\Delta t_{\\max}\\,$。将 $\\,\\Delta t_{\\max}\\,$ 以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决一个关于一维扩散方程数值解的多部分问题，该方程常用于海洋建模。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程：** $\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(K_{v}(z)\\,\\frac{\\partial T}{\\partial z}\\right)$\n- **域：** 深度为 $H$ 的一维垂直水柱，坐标 $z$ 从 $z=0$（表面）到 $z=H$（底部）向下增加。\n- **边界条件（BCs）：** 在 $z=0$ 和 $z=H$ 处为零通量（诺伊曼）边界条件。在两个边界处均为 $\\frac{\\partial T}{\\partial z}=0$。\n- **离散化：**\n  - 均匀网格：$z_{i}=i\\,\\Delta z$，对于 $i=0,1,\\dots,N$，其中 $\\Delta z = H/N$。\n  - 示踪物值：$T_{i}^{n}\\approx T(z_{i},t^{n})$。\n  - 界面扩散系数：$K_{i+\\frac{1}{2}}=\\frac{1}{2}(K_{i}+K_{i+1})$，这里隐含 $K_i = K_v(z_i)$。\n- **数值格式：** 半隐式 $\\theta$-格式：$\\frac{T_{i}^{n+1}-T_{i}^{n}}{\\Delta t} = \\theta\\,\\mathcal{L}[T^{n+1}]_{i} + (1-\\theta)\\,\\mathcal{L}[T^{n}]_{i}$。\n- **离散算子：** $\\mathcal{L}[T]_{i} = \\frac{1}{\\Delta z^{2}}\\left[ K_{i+\\frac{1}{2}}(T_{i+1}-T_{i}) - K_{i-\\frac{1}{2}}(T_{i}-T_{i-1}) \\right]$，适用于内部指数 $i=1,\\dots,N-1$。\n- **扩散系数剖面（$K_v(z)$）：**\n  $$\n  K_{v}(z) = \\begin{cases}\n  K_{0},  0 \\le z \\le h \\\\\n  K_{b} + (K_{0}-K_{b})\\,\\exp\\left(-\\frac{z-h}{z_{*}}\\right),  zh\n  \\end{cases}\n  $$\n- **物理和数值参数：**\n  - $h = 50\\,\\text{m}$\n  - $K_{0} = 1.0\\times 10^{-2}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n  - $K_{b} = 1.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n  - $z_{*} = 200\\,\\text{m}$\n  - $H = 1000\\,\\text{m}$\n  - $\\Delta z = 10\\,\\text{m}$\n  - $\\theta = 0.7$\n- **任务：**\n  1. 推导三对角系统 $a_{i}\\,T_{i-1}^{n+1}+b_{i}\\,T_{i}^{n+1}+c_{i}\\,T_{i+1}^{n+1}=r_{i}$，并确定系数 $a_i, b_i, c_i, r_i$。陈述M-矩阵的符号模式和行和性质。\n  2. 为系数矩阵成为严格对角占优M-矩阵提供充分条件，并为 $\\theta \\in [1/2, 1]$ 时的单调性保持推导 $\\Delta t$ 的充分界限。\n  3. 根据给定参数计算最大允许时间步长 $\\Delta t_{\\max}$，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了菲克扩散，一个基本的物理过程。控制方程是标准的一维抛物型热/扩散方程。数值方法（$\\theta$-格式）是解决此类方程的标准、分析透彻的技术。K剖面参数化（KPP）是海洋学中广泛接受的表示垂直混合的方案。给定的 $K_v(z)$ 剖面是对覆盖在静止内部水体之上的湍流表层边界层的物理上合理的表示。该问题是科学合理的。\n- **适定性：** 所有必要的方程、边界条件、参数和离散化公式均已提供。任务具体，并能导出一个唯一的解析和数值答案。该问题是自洽且适定的。\n- **客观性：** 问题以精确的数学和物理语言陈述，没有歧义、主观性或观点。\n\n**步骤3：结论和行动**\n问题有效。它具有科学依据、适定且客观。我将继续进行解答。\n\n### 解答\n\n**任务1：推导三对角系统**\n\n半隐式格式由下式给出：\n$$ \\frac{T_{i}^{n+1}-T_{i}^{n}}{\\Delta t} = \\theta\\,\\mathcal{L}[T^{n+1}]_{i} + (1-\\theta)\\,\\mathcal{L}[T^{n}]_{i} $$\n为了获得未知向量 $T^{n+1}$ 的线性系统，我们重新排列方程，将所有涉及 $T^{n+1}$ 的项放在左侧（LHS），将所有已知项（涉及 $T^n$）放在右侧（RHS）。\n$$ T_{i}^{n+1} - \\theta\\,\\Delta t\\,\\mathcal{L}[T^{n+1}]_{i} = T_{i}^{n} + (1-\\theta)\\,\\Delta t\\,\\mathcal{L}[T^{n}]_{i} $$\n让我们代入离散算子 $\\mathcal{L}[\\cdot]_{i}$ 的定义：\n$$ T_{i}^{n+1} - \\theta\\,\\frac{\\Delta t}{\\Delta z^2} \\left[ K_{i+\\frac{1}{2}}(T_{i+1}^{n+1}-T_{i}^{n+1}) - K_{i-\\frac{1}{2}}(T_{i}^{n+1}-T_{i-1}^{n+1}) \\right] = \\text{RHS} $$\n将LHS上的项按其空间指数分组，得到：\n$$ \\left( -\\theta\\,\\frac{\\Delta t}{\\Delta z^2} K_{i-\\frac{1}{2}} \\right) T_{i-1}^{n+1} + \\left( 1 + \\theta\\,\\frac{\\Delta t}{\\Delta z^2} (K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}}) \\right) T_{i}^{n+1} + \\left( -\\theta\\,\\frac{\\Delta t}{\\Delta z^2} K_{i+\\frac{1}{2}} \\right) T_{i+1}^{n+1} = \\text{RHS} $$\n此方程符合所需形式 $a_{i}\\,T_{i-1}^{n+1}+b_{i}\\,T_{i}^{n+1}+c_{i}\\,T_{i+1}^{n+1}=r_{i}$。内部网格点（$i=1, \\dots, N-1$）的系数为：\n- $a_{i} = -\\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,K_{i-\\frac{1}{2}}$\n- $b_{i} = 1 + \\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}})$\n- $c_{i} = -\\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,K_{i+\\frac{1}{2}}$\n右侧项 $r_i$ 由所有在时间步 $n$ 计算的项组成：\n- $r_{i} = T_{i}^{n} + (1-\\theta)\\,\\Delta t\\,\\mathcal{L}[T^{n}]_{i} = T_{i}^{n} + (1-\\theta)\\frac{\\Delta t}{\\Delta z^2}\\left[ K_{i+\\frac{1}{2}}(T_{i+1}^{n}-T_{i}^{n}) - K_{i-\\frac{1}{2}}(T_{i}^{n}-T_{i-1}^{n}) \\right]$\n\n零通量边界条件通过将跨越物理边界的通量设置为零来强制执行。这相当于在表面（$i=0$）设置 $K_{-1/2}=0$ 并在底部（$i=N$）设置 $K_{N+1/2}=0$。\n\n要使LHS的系数矩阵成为一个M-矩阵，它必须是一个Z-矩阵（非正的非对角元素，$a_i \\le 0, c_i \\le 0$）且具有正的对角元素（$b_i  0$）。\n- **符号模式**：由于扩散系数 $K_v(z)0$，我们有 $K_{i\\pm\\frac{1}{2}}0$。给定 $\\theta0$ 和 $\\Delta t0$，系数的符号为：\n  - $a_i  0$\n  - $c_i  0$\n  - $b_i = 1 + (\\text{正项})  1  0$\n  这符合M-矩阵所需的符号模式（正对角线，非正非对角线）。\n\n- **行和性质**：Z-矩阵成为M-矩阵的一个充分条件是严格对角占优。此性质与矩阵的行和有关。对于内部第 $i$ 行，系数之和为：\n  $$ a_i + b_i + c_i = \\left(-\\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,K_{i-\\frac{1}{2}}\\right) + \\left(1 + \\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}})\\right) + \\left(-\\theta\\,\\frac{\\Delta t}{\\Delta z^2}\\,K_{i+\\frac{1}{2}}\\right) = 1 $$\n  由于行和为 $1  0$，且非对角元素 $a_i, c_i$ 为负，我们有 $b_i = 1-a_i-c_i = 1+|a_i|+|c_i|  |a_i|+|c_i|$。因此，该矩阵是严格对角占优的。在边界（$i=0, N$）处的类似分析也得到行和为 $1$。\n\n**任务2：单调性条件和时间步长界限**\n\n该线性系统可以写成矩阵形式 $A\\,T^{n+1} = B\\,T^n$，其中 $A = I - \\theta\\,\\Delta t\\,\\mathcal{L}$ 且 $B = I + (1-\\theta)\\,\\Delta t\\,\\mathcal{L}$。解的更新为 $T^{n+1} = A^{-1}B\\,T^n$。\n\n系数矩阵 $A$ 成为严格对角占优M-矩阵的一个充分条件是它是一个Z-矩阵且严格对角占优。正如任务1中所证，对于任何 $\\theta  0$ 和 $\\Delta t  0$，且给定 $K_v(z)  0$，矩阵 $A$ 具有正的对角元素和非正的非对角元素，并且是严格对角占优的。因此，在 $\\theta  0$ 这个非常普遍的条件下，$A$ 是一个M-矩阵，并且此性质不需要 $\\Delta t$ 有上界。M-矩阵的一个关键性质是其逆矩阵 $A^{-1}$ 的所有项都是非负的，即 $A^{-1} \\ge 0$。\n\n为了保持单调性，即确保不产生新的极值（例如，如果 $T^n \\ge 0$，则 $T^{n+1} \\ge 0$），更新矩阵 $A^{-1}B$ 的所有项必须都是非负的。由于我们已经确定 $A^{-1} \\ge 0$，因此保持单调性的一个充分条件是矩阵 $B$ 也具有所有非负项（$B \\ge 0$）。\n\n矩阵 $B$ 的项由 $r_i$ 的表达式导出：\n$r_i = \\underbrace{\\left((1-\\theta)\\frac{\\Delta t}{\\Delta z^2} K_{i-\\frac{1}{2}}\\right)}_{B_{i, i-1}} T_{i-1}^{n} + \\underbrace{\\left(1-(1-\\theta)\\frac{\\Delta t}{\\Delta z^2}(K_{i+\\frac{1}{2}}+K_{i-\\frac{1}{2}})\\right)}_{B_{i, i}} T_{i}^{n} + \\underbrace{\\left((1-\\theta)\\frac{\\Delta t}{\\Delta z^2} K_{i+\\frac{1}{2}}\\right)}_{B_{i, i+1}} T_{i+1}^{n}$。\n\n- **非对角元素：** 对于 $j \\ne i$ 的 $B_{i, j}$。它们的形式为 $(1-\\theta)\\frac{\\Delta t}{\\Delta z^2} K_{k}$。由于 $K_k0$，$\\Delta t0$，$\\Delta z^20$，这些元素非负的充要条件是 $1-\\theta \\ge 0$，即 $\\theta \\le 1$。\n\n- **对角元素：** $B_{i, i}$。我们要求 $B_{i,i} \\ge 0$。这导致条件：\n$$ 1 - (1-\\theta)\\frac{\\Delta t}{\\Delta z^2}(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}}) \\ge 0 $$\n这必须对所有内部点 $i=1, \\dots, N-1$ 成立。对于边界点 $i=0$ 和 $i=N$，各自的条件是 $1 - (1-\\theta)\\frac{\\Delta t}{\\Delta z^2}K_{1/2} \\ge 0$ 和 $1 - (1-\\theta)\\frac{\\Delta t}{\\Delta z^2}K_{N-1/2} \\ge 0$。由于 $K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}}  K_{1/2}$（对于 $i=1$），内部点的条件比边界处的条件更严格。\n\n对于 $\\theta \\in [1/2, 1)$，我们可以重新排列不等式以找到 $\\Delta t$ 的一个界限：\n$$ \\Delta t \\le \\frac{\\Delta z^2}{(1-\\theta)(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}})} $$\n这必须对所有 $i$ 成立。因此，我们必须满足最严格的情况，这对应于分母项的最大值：\n$$ \\Delta t \\le \\frac{\\Delta z^2}{(1-\\theta)\\,\\max_{i=1,\\dots,N-1}(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}})} $$\n如果 $\\theta=1$，格式是全隐式的。那么 $1-\\theta=0$，所以 $B=I$（单位矩阵），其元素显然是非负的。对于 $\\theta=1$，该格式是无条件单调的。推导出的界限是对于 $\\theta \\in [1/2, 1)$ 保持单调性的充分条件。\n\n**任务3：计算最大允许时间步长**\n\n为了计算 $\\Delta t_{\\max}$，我们使用推导出的界限：\n$$ \\Delta t_{\\max} = \\frac{\\Delta z^2}{(1-\\theta)\\,\\max_{i=1,\\dots,N-1}\\left(K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}}\\right)} $$\n我们需要找到项 $S_i = K_{i+\\frac{1}{2}} + K_{i-\\frac{1}{2}}$ 的最大值。回想 $K_{i+\\frac{1}{2}}=\\frac{1}{2}(K_i+K_{i+1})$，其中 $K_i=K_v(z_i)$，我们有 $S_i = \\frac{1}{2}(K_i+K_{i+1}) + \\frac{1}{2}(K_{i-1}+K_i) = \\frac{1}{2}K_{i-1} + K_i + \\frac{1}{2}K_{i+1}$。\n\n扩散系数剖面 $K_v(z)$ 在 $0 \\le z \\le h=50\\,\\text{m}$ 范围内为其最大值 $K_0$ 的常数，并在 $zh$ 时非增。网格间距为 $\\Delta z = 10\\,\\text{m}$，因此网格点 $z_0, z_1, z_2, z_3, z_4, z_5$ 分别位于深度 $0, 10, 20, 30, 40, 50\\,\\text{m}$ 处。对于所有这些点，$K_v(z_i) = K_0$。\n\n让我们为一个指数 $i$ 计算 $S_i$，其中 $z_{i-1}, z_i, z_{i+1}$ 均在表层内（即 $z_{i+1} \\le h$）。这对 $i=1, 2, 3, 4$ 成立。对于这些指数，$K_{i-1}=K_i=K_{i+1}=K_0$。\n那么 $K_{i-\\frac{1}{2}} = \\frac{1}{2}(K_{i-1}+K_i) = \\frac{1}{2}(K_0+K_0) = K_0$。且 $K_{i+\\frac{1}{2}} = \\frac{1}{2}(K_i+K_{i+1}) = \\frac{1}{2}(K_0+K_0) = K_0$。和为 $S_i = K_0 + K_0 = 2K_0$。\n\n对于任何 $i$，如果点 $z_{i-1}, z_i, z_{i+1}$ 中至少有一个位于混合层深度 $h$ 以下，则相应的 $K$ 值将小于或等于 $K_0$，且至少有一个值严格更小。这将导致和 $S_i  2K_0$。例如，在 $i=5$ 处，$z_4=40, z_5=50, z_6=60$。$K_4=K_5=K_0$ 但 $K_6K_0$。\n因此，$\\max_i (K_{i+1/2} + K_{i-1/2}) = 2K_0$。\n\n现在我们代入数值：\n$\\Delta z = 10\\,\\text{m}$\n$\\theta = 0.7$\n$K_0 = 1.0 \\times 10^{-2}\\,\\text{m}^2\\,\\text{s}^{-1}$\n\n$$ \\Delta t_{\\max} = \\frac{(\\Delta z)^2}{(1-\\theta)(2K_0)} = \\frac{(10\\,\\text{m})^2}{(1-0.7)(2 \\times 1.0 \\times 10^{-2}\\,\\text{m}^2\\,\\text{s}^{-1})} $$\n$$ \\Delta t_{\\max} = \\frac{100}{0.3 \\times 0.02} = \\frac{100}{0.006} = \\frac{100000}{6} = 16666.666\\dots\\,\\text{s} $$\n将结果四舍五入到四位有效数字：\n$16670\\,\\text{s}$。",
            "answer": "$$\\boxed{16670}$$"
        }
    ]
}