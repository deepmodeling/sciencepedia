{
    "hands_on_practices": [
        {
            "introduction": "理论的优雅之处在于其能够将复杂的关系提炼为简洁而强大的工具。本练习将指导您推导彭曼-蒙特斯（Penman-Monteith）方程，这是微气象学和水文学中最重要的方程之一。通过巧妙地结合能量平衡方程和体感输送公式，我们将消除难以直接测量的地表温度变量，从而创建一个实用的蒸散发诊断工具。这个练习不仅能加深您对地表能量分配物理机制的理解，还能展示如何通过理论推导解决实际问题。",
            "id": "4097617",
            "problem": "考虑一个水平均一的植被陆地表面，其在稳定的日间条件下被表示为一个单一、充分混合的“大叶”冠层。陆地表面能量收支遵循表面能量平衡原理，$$R = H + LE,$$ 其中 $R$ 是可用能量，由 $R = R_n - G$ 给出，$H$ 是感热通量，$LE$ 是与蒸发和蒸腾相关的潜热通量。感热通量通过整体空气动力学传输来描述，$$H = \\rho c_p g_a \\left( T_s - T_a \\right),$$ 其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热容，$g_a$ 是空气动力学导度，$T_s$ 是有效冠层表面温度，$T_a$ 是冠层上方的气温。潜热通量与通过水汽导度 $g_v$ 的水汽质量传输以及近地表比湿差有关，饱和水汽压在 $T_a$ 附近的线性化可得 $$e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a),$$ 其中 $e_s$ 是饱和水汽压，$\\Delta$ 是在空气温度下饱和水汽压曲线的斜率。干湿表常数定义为 $$\\gamma = \\frac{c_p P}{\\varepsilon \\lambda},$$ 其中 $P$ 是大气压，$\\varepsilon$ 是水汽与干空气的分子量之比，$\\lambda$ 是汽化潜热。饱和水汽压差 (VPD) 定义为 $$\\mathrm{VPD} = e_s(T_a) - e_a,$$ 其中 $e_a$ 是环境水汽压。\n\n仅使用上述原理和定义（不使用任何预先给定的目标公式），推导潜热通量 $LE$ 关于 $\\Delta$、$\\gamma$、$R$、$\\mathrm{VPD}$、$r_a$ 和 $r_s$ 的表达式，其中 $g_a = 1/r_a$ 且 $g_v = 1/(r_a + r_s)$，然后使用以下代表温带草原冠层正午条件的物理一致参数集对 $LE$ 进行数值计算：\n- 净辐射 $R_n = 550\\ \\mathrm{W\\ m^{-2}}$，\n- 地中热通量 $G = 50\\ \\mathrm{W\\ m^{-2}}$，\n- 饱和水汽压曲线斜率 $\\Delta = 200\\ \\mathrm{Pa\\ K^{-1}}$，\n- 干湿表常数 $\\gamma = 65\\ \\mathrm{Pa\\ K^{-1}}$，\n- 饱和水汽压差 $\\mathrm{VPD} = 2000\\ \\mathrm{Pa}$，\n- 空气动力学阻力 $r_a = 20\\ \\mathrm{s\\ m^{-1}}$，\n- 表面（气孔）阻力 $r_s = 100\\ \\mathrm{s\\ m^{-1}}$，\n- 空气密度 $\\rho = 1.2\\ \\mathrm{kg\\ m^{-3}}$，\n- 空气定压比热 $c_p = 1004\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$。\n\n通过对您推导出的 $LE$ 关于 $r_s$ 进行解析微分，然后构建 $LE$ 对 $r_s$ 的弹性，从而对 $r_s$ 进行敏感性分析，$$S_{r_s} = \\frac{\\partial \\ln LE}{\\partial \\ln r_s} = \\frac{r_s}{LE}\\,\\frac{\\partial LE}{\\partial r_s}。$$ 使用上述参数值计算 $S_{r_s}$，以量化通过 $r_s$ 对蒸腾作用的直接生理控制。将弹性作为您的最终答案。将最终答案四舍五入至四位有效数字。最终报告的量是无量纲的；最终答案不需要单位。如果您提供了任何中间数值（如 $LE$），请以 $\\mathrm{W\\ m^{-2}}$ 为单位表示。",
            "solution": "首先对问题进行验证，确认其科学依据充分、提法明确且客观。这是一个关于潜热通量的彭曼-蒙特斯方程推导和应用的微气象学标准问题。所有必要的原理和数据都已提供，足以进行完整的推导和数值评估。\n\n推导始于控制表面能量和质量传输的基本方程。表面能量平衡由以下公式给出：\n$$R = H + LE \\quad (1)$$\n其中 $R$ 是可用能量，$H$ 是感热通量，$LE$ 是潜热通量。可用能量为 $R = R_n - G$，其中 $R_n$ 是净辐射，$G$ 是地中热通量。\n\n感热通量 $H$ 由整体空气动力学公式定义：\n$$H = \\rho c_p g_a (T_s - T_a) \\quad (2)$$\n在此，$\\rho$ 是空气密度，$c_p$ 是空气比热，$g_a = 1/r_a$ 是空气动力学导度（$r_a$ 是空气动力学阻力），$T_s$ 是表面温度，$T_a$ 是气温。\n\n潜热通量 $LE$ 代表水汽通量 $E$ 的能量当量。通量 $E$ 与表面和空气之间的水汽压差以及水汽导度 $g_v = 1/(r_a+r_s)$ 成正比，其中 $r_s$ 是表面阻力。潜热通量由以下公式给出：\n$$LE = L \\cdot E = L \\frac{\\rho \\varepsilon}{P} g_v (e_s(T_s) - e_a)$$\n使用干湿表常数的定义 $\\gamma = \\frac{c_p P}{\\varepsilon \\lambda}$（根据题目符号，我们用 $\\lambda$ 表示汽化潜热 $L$），我们可以重排得到 $\\frac{\\varepsilon \\lambda}{P} = \\frac{c_p}{\\gamma}$。将此代入 $LE$ 的表达式，得到相应的潜热通量整体公式：\n$$LE = \\frac{\\rho c_p}{\\gamma} g_v (e_s(T_s) - e_a) \\quad (3)$$\n其中 $e_s(T_s)$ 是表面温度 $T_s$ 下的饱和水汽压，$e_a$ 是环境水汽压。\n\n使用方程 $(1)$、$(2)$ 和 $(3)$ 的主要困难在于未知表面温度 $T_s$ 的存在。为消除 $T_s$，我们使用题目中提供的饱和水汽压曲线在已知气温 $T_a$ 附近的线性化：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a) \\quad (4)$$\n其中 $\\Delta$ 是在 $T_a$ 下饱和水汽压曲线的斜率。\n\n首先，我们从感热通量方程 $(2)$ 中解出温差 $(T_s - T_a)$：\n$$T_s - T_a = \\frac{H}{\\rho c_p g_a}$$\n将此代入线性化的水汽压方程 $(4)$：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta \\frac{H}{\\rho c_p g_a}$$\n现在，将这个 $e_s(T_s)$ 的表达式代入潜热通量方程 $(3)$：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\left( e_s(T_a) + \\frac{\\Delta H}{\\rho c_p g_a} - e_a \\right)$$\n认识到饱和水汽压差为 $\\mathrm{VPD} = e_s(T_a) - e_a$，我们可以简化为：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\left( \\mathrm{VPD} + \\frac{\\Delta H}{\\rho c_p g_a} \\right)$$\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} H \\quad (5)$$\n我们现在有两个方程 $(1)$ 和 $(5)$，以及两个未知数 $H$ 和 $LE$。我们可以解这个方程组。从 $(1)$ 可得 $H = R - LE$。将此代入 $(5)$：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} (R - LE)$$\n我们现在求解 $LE$。首先，展开最后一项：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} R - \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} LE$$\n将所有含 $LE$ 的项移到左侧：\n$$LE \\left( 1 + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} \\right) = \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} R + \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD}$$\n为了分离出 $LE$，我们将两边同乘以 $\\frac{\\gamma g_a}{g_v}$：\n$$LE \\left( \\frac{\\gamma g_a}{g_v} + \\Delta \\right) = \\Delta R + \\rho c_p g_a \\mathrm{VPD}$$\n这就得出了潜热通量的最终推导表达式，通常称为彭曼-蒙特斯方程：\n$$LE = \\frac{\\Delta R + \\rho c_p g_a \\mathrm{VPD}}{\\Delta + \\gamma \\frac{g_a}{g_v}}$$\n用阻力替换导度，$g_a=1/r_a$ 和 $g_v=1/(r_a+r_s)$，我们得到 $g_a/g_v = (r_a+r_s)/r_a$。表达式变为：\n$$LE = \\frac{\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}}{\\Delta + \\gamma \\left( \\frac{r_a+r_s}{r_a} \\right)} \\quad (6)$$\n\n接下来，我们使用给定的参数对 $LE$ 进行数值计算。\n首先，计算可用能量 $R$：\n$R = R_n - G = 550\\ \\mathrm{W\\ m^{-2}} - 50\\ \\mathrm{W\\ m^{-2}} = 500\\ \\mathrm{W\\ m^{-2}}$。\n参数如下：\n$\\Delta = 200\\ \\mathrm{Pa\\ K^{-1}}$\n$\\gamma = 65\\ \\mathrm{Pa\\ K^{-1}}$\n$\\mathrm{VPD} = 2000\\ \\mathrm{Pa}$\n$r_a = 20\\ \\mathrm{s\\ m^{-1}}$\n$r_s = 100\\ \\mathrm{s\\ m^{-1}}$\n$\\rho = 1.2\\ \\mathrm{kg\\ m^{-3}}$\n$c_p = 1004\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$\n\n方程 $(6)$ 的分子：\n$\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD} = (200)(500) + \\frac{(1.2)(1004)}{20} (2000)$\n$= 100000 + (60.24)(2000) = 100000 + 120480 = 220480\\ \\mathrm{W\\ Pa\\ m^{-2}\\ K^{-1}}$\n\n方程 $(6)$ 的分母：\n$\\Delta + \\gamma \\left( \\frac{r_a+r_s}{r_a} \\right) = 200 + 65 \\left( \\frac{20+100}{20} \\right) = 200 + 65 \\left( \\frac{120}{20} \\right)$\n$= 200 + 65(6) = 200 + 390 = 590\\ \\mathrm{Pa\\ K^{-1}}$\n\n现在，计算 $LE$：\n$$LE = \\frac{220480}{590} \\approx 373.69\\ \\mathrm{W\\ m^{-2}}$$\n\n最后，我们通过计算 $LE$ 对 $r_s$ 的弹性来进行敏感性分析：\n$$S_{r_s} = \\frac{\\partial \\ln LE}{\\partial \\ln r_s} = \\frac{r_s}{LE} \\frac{\\partial LE}{\\partial r_s}$$\n为简化微分，我们将方程 $(6)$ 重写以明确显示其对 $r_s$ 的依赖关系：\n$$LE(r_s) = \\frac{\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} = \\frac{N}{D_1 + D_2 r_s}$$\n其中 $N = \\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}$，$D_1 = \\Delta + \\gamma$ 和 $D_2 = \\gamma/r_a$ 均与 $r_s$ 无关。\n对数导数更容易计算：\n$\\ln(LE) = \\ln(N) - \\ln(D_1 + D_2 r_s)$\n对 $r_s$ 求导：\n$$\\frac{\\partial \\ln(LE)}{\\partial r_s} = 0 - \\frac{1}{D_1 + D_2 r_s} \\cdot \\frac{\\partial}{\\partial r_s}(D_1 + D_2 r_s) = - \\frac{D_2}{D_1 + D_2 r_s}$$\n那么弹性就是：\n$$S_{r_s} = r_s \\frac{\\partial \\ln(LE)}{\\partial r_s} = -\\frac{D_2 r_s}{D_1 + D_2 r_s}$$\n将 $D_1$ 和 $D_2$ 的原始表达式代回：\n$$S_{r_s} = -\\frac{(\\gamma/r_a) r_s}{(\\Delta + \\gamma) + (\\gamma/r_a) r_s} = -\\frac{\\frac{\\gamma r_s}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} = \\frac{-\\frac{\\gamma r_s}{r_a}}{\\Delta + \\gamma \\left(\\frac{r_a+r_s}{r_a}\\right)}$$\n这就是弹性的解析表达式。\n现在，我们用给定的数值计算 $S_{r_s}$。\n分子：\n$-\\frac{\\gamma r_s}{r_a} = -\\frac{(65)(100)}{20} = -\\frac{6500}{20} = -325\\ \\mathrm{Pa\\ K^{-1}}$\n分母与 $LE$ 的分母相同：$590\\ \\mathrm{Pa\\ K^{-1}}$。\n$$S_{r_s} = \\frac{-325}{590} \\approx -0.55084745...$$\n四舍五入到四位有效数字，弹性为 $-0.5508$。这个无量纲的量表明，表面阻力 $r_s$ 增加 $1\\%$ 会导致潜热通量大约减少 $0.55\\%$，这量化了气孔对蒸腾作用的控制。",
            "answer": "$$\\boxed{-0.5508}$$"
        },
        {
            "introduction": "从理论走向实践，我们必须面对真实世界观测的复杂性。本练习将带您探讨一个在通量观测中普遍存在的核心问题：能量平衡不闭合。我们将重点分析在早晨和傍晚过渡期，因忽略冠层和空气中的能量储存项 $S$ 而导致的显热通量 $H$ 和潜热通量 $LE$ 的估算偏差 。通过这个练习，您将学会量化这种偏差，这是准确解译和使用涡度相关法等实测通量数据的关键技能。",
            "id": "4097710",
            "problem": "一个架设在温带、均质、阔叶冠层上的通量塔被用于诊断早晨和傍晚转换期的地表湍流通量，即感热通量 $H$ 和潜热通量 $LE$。从地表的局地能量守恒出发，该守恒定律将净辐射分配到湍流、传导和存储分量中。具体来说，使用以下基本陈述：地表净辐射 $R_n$ 与向上的湍流感热通量 $H$、向上的湍流潜热通量 $LE$、进入土壤的传导性土壤热通量 $G$ 以及一个净存储项 $S$ 的总和相平衡。净存储项 $S$ 集合了冠层热存储、测量高度以下气柱的存储、生物化学存储和光合作用能量存储，因此地表可用能量的残差由 $S$ 来解释。\n\n在该站点的涡度相关数据后处理中，质量控制过程中的一个常见做法是：忽略存储项 $S$，并将可用能量视为 $R_n - G$。然后，通过保持瞬时测量的鲍文比 $B(t)$（定义为 $B(t) = H(t)/LE(t)$）来进行 $H$ 和 $LE$ 的分配。鲍文比被假定为通过高频涡度相关测量已知，并被视为湍流通量比率的无偏估计。然而，在转换期间，$S(t)$ 是不可忽略的，当忽略 $S$ 时，这会导致推断出的 $H$ 和 $LE$ 产生偏差。\n\n现提供八个时刻的 $30$ 分钟值：一个早晨转换期（当地时间 $06{:}00$–$07{:}30$）和一个傍晚转换期（当地时间 $18{:}00$–$19{:}30$）。对于每个时刻 $t_i$，给定净辐射 $R_n(t_i)$、土壤热通量 $G(t_i)$、总存储量 $S(t_i)$ 和测量的鲍文比 $B(t_i)$：\n- $t_1 = 06{:}00$：$R_n = 50\\ \\mathrm{W\\,m^{-2}}$，$G = 5\\ \\mathrm{W\\,m^{-2}}$，$S = 25\\ \\mathrm{W\\,m^{-2}}$，$B = 0.30$。\n- $t_2 = 06{:}30$：$R_n = 150\\ \\mathrm{W\\,m^{-2}}$，$G = 20\\ \\mathrm{W\\,m^{-2}}$，$S = 60\\ \\mathrm{W\\,m^{-2}}$，$B = 0.40$。\n- $t_3 = 07{:}00$：$R_n = 280\\ \\mathrm{W\\,m^{-2}}$，$G = 40\\ \\mathrm{W\\,m^{-2}}$，$S = 75\\ \\mathrm{W\\,m^{-2}}$，$B = 0.55$。\n- $t_4 = 07{:}30$：$R_n = 380\\ \\mathrm{W\\,m^{-2}}$，$G = 60\\ \\mathrm{W\\,m^{-2}}$，$S = 65\\ \\mathrm{W\\,m^{-2}}$，$B = 0.60$。\n- $t_5 = 18{:}00$：$R_n = 150\\ \\mathrm{W\\,m^{-2}}$，$G = 10\\ \\mathrm{W\\,m^{-2}}$，$S = -35\\ \\mathrm{W\\,m^{-2}}$，$B = 0.70$。\n- $t_6 = 18{:}30$：$R_n = 80\\ \\mathrm{W\\,m^{-2}}$，$G = 5\\ \\mathrm{W\\,m^{-2}}$，$S = -30\\ \\mathrm{W\\,m^{-2}}$，$B = 0.55$。\n- $t_7 = 19{:}00$：$R_n = 30\\ \\mathrm{W\\,m^{-2}}$，$G = 2\\ \\mathrm{W\\,m^{-2}}$，$S = -18\\ \\mathrm{W\\,m^{-2}}$，$B = 0.45$。\n- $t_8 = 19{:}30$：$R_n = 10\\ \\mathrm{W\\,m^{-2}}$，$G = 1\\ \\mathrm{W\\,m^{-2}}$，$S = -8\\ \\mathrm{W\\,m^{-2}}$，$B = 0.40$。\n\n将每个时刻 $t_i$ 因忽略存储项而导致的推断通量偏差定义为：后处理估计值（通过在保持测量到的 $B(t_i)$ 的同时分配 $R_n - G$ 得到）与真实湍流通量（如果存储项 $S(t_i)$被正确地包含在地表能量平衡中将得到的值）之间的差值。计算早晨时间窗口（$t_1$–$t_4$）和傍晚时间窗口（$t_5$–$t_8$）内 $H$ 和 $LE$ 的算术平均偏差。\n\n以行矩阵的形式报告您的最终结果，其中包含四个条目，顺序如下：早晨 $H$ 偏差、早晨 $LE$ 偏差、傍晚 $H$ 偏差、傍晚 $LE$ 偏差。每个条目以 $\\mathrm{W\\,m^{-2}}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "该问题要求计算早晨和傍晚转换期间感热通量（$H$）和潜热通量（$LE$）的平均偏差，该偏差源于在地表能量平衡中忽略能量存储项（$S$）的常见做法。\n\n其基本原理是地表的局地能量守恒，由以下方程给出：\n$$R_n(t) = H(t) + LE(t) + G(t) + S(t)$$\n其中 $R_n$ 是净辐射，$H$ 是感热通量，$LE$ 是潜热通量，$G$ 是土壤热通量，$S$ 是净能量存储率。所有通量的单位都是 $\\mathrm{W\\,m^{-2}}$。\n\n我们将满足完整能量平衡方程的通量定义为真实通量，记为 $H_{true}$ 和 $LE_{true}$。因此，总湍流通量为：\n$$H_{true}(t) + LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n该总通量的分配由测量的鲍文比 $B(t)$ 决定，其定义为：\n$$B(t) = \\frac{H_{true}(t)}{LE_{true}(t)}$$\n根据此定义，我们有 $H_{true}(t) = B(t) \\cdot LE_{true}(t)$。将其代入湍流通量总和方程，得到：\n$$B(t) \\cdot LE_{true}(t) + LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n$$(1 + B(t)) LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n求解 $LE_{true}(t)$ 并随后求解 $H_{true}(t)$，我们得到真实通量的表达式：\n$$LE_{true}(t) = \\frac{R_n(t) - G(t) - S(t)}{1 + B(t)}$$\n$$H_{true}(t) = B(t) \\cdot LE_{true}(t) = \\frac{B(t) \\left( R_n(t) - G(t) - S(t) \\right)}{1 + B(t)}$$\n\n接下来，我们定义推断通量，记为 $H_{inf}$ 和 $LE_{inf}$，它们是在存储项为零（即 $S(t)=0$）的错误假设下计算的。在这种后处理方法中，可用能量被假定为 $R_n(t) - G(t)$，并且鲍文比 $B(t)$ 被保留。\n推断通量的能量平衡方程为：\n$$H_{inf}(t) + LE_{inf}(t) = R_n(t) - G(t)$$\n使用相同的鲍文比，$H_{inf}(t) = B(t) \\cdot LE_{inf}(t)$，我们可以解出推断通量：\n$$(1 + B(t)) LE_{inf}(t) = R_n(t) - G(t)$$\n$$LE_{inf}(t) = \\frac{R_n(t) - G(t)}{1 + B(t)}$$\n$$H_{inf}(t) = B(t) \\cdot LE_{inf}(t) = \\frac{B(t) \\left( R_n(t) - G(t) \\right)}{1 + B(t)}$$\n\n每个通量的偏差定义为推断通量减去真实通量。设 $\\Delta H(t)$ 为感热通量的偏差，$\\Delta LE(t)$ 为潜热通量的偏差。\n$$\\Delta H(t) = H_{inf}(t) - H_{true}(t)$$\n$$\\Delta LE(t) = LE_{inf}(t) - LE_{true}(t)$$\n代入推导出的表达式：\n$$\\Delta H(t) = \\frac{B(t) ( R_n(t) - G(t) )}{1 + B(t)} - \\frac{B(t) ( R_n(t) - G(t) - S(t) )}{1 + B(t)} = \\frac{B(t)}{1 + B(t)} [ (R_n(t) - G(t)) - (R_n(t) - G(t) - S(t)) ]$$\n$$\\Delta H(t) = \\frac{B(t) S(t)}{1 + B(t)}$$\n同样，对于潜热通量偏差：\n$$\\Delta LE(t) = \\frac{R_n(t) - G(t)}{1 + B(t)} - \\frac{R_n(t) - G(t) - S(t)}{1 + B(t)} = \\frac{1}{1 + B(t)} [ (R_n(t) - G(t)) - (R_n(t) - G(t) - S(t)) ]$$\n$$\\Delta LE(t) = \\frac{S(t)}{1 + B(t)}$$\n这些简洁的结果表明，湍流通量的偏差就是被忽略的存储项 $S(t)$，根据鲍文比 $B(t)$ 进行分配。\n\n现在我们计算每个给定时间点 $t_i$ 的偏差：\n\n**早晨转换期（$t_1$ 至 $t_4$）**\n对于 $t_1 = 06{:}00$，有 $S_1 = 25\\ \\mathrm{W\\,m^{-2}}$ 和 $B_1 = 0.30$：\n$\\Delta H_1 = \\frac{0.30 \\cdot 25}{1 + 0.30} = \\frac{7.5}{1.30} \\approx 5.769\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_1 = \\frac{25}{1 + 0.30} = \\frac{25}{1.30} \\approx 19.231\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_2 = 06{:}30$，有 $S_2 = 60\\ \\mathrm{W\\,m^{-2}}$ 和 $B_2 = 0.40$：\n$\\Delta H_2 = \\frac{0.40 \\cdot 60}{1 + 0.40} = \\frac{24}{1.40} \\approx 17.143\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_2 = \\frac{60}{1 + 0.40} = \\frac{60}{1.40} \\approx 42.857\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_3 = 07{:}00$，有 $S_3 = 75\\ \\mathrm{W\\,m^{-2}}$ 和 $B_3 = 0.55$：\n$\\Delta H_3 = \\frac{0.55 \\cdot 75}{1 + 0.55} = \\frac{41.25}{1.55} \\approx 26.613\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_3 = \\frac{75}{1 + 0.55} = \\frac{75}{1.55} \\approx 48.387\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_4 = 07{:}30$，有 $S_4 = 65\\ \\mathrm{W\\,m^{-2}}$ 和 $B_4 = 0.60$：\n$\\Delta H_4 = \\frac{0.60 \\cdot 65}{1 + 0.60} = \\frac{39}{1.60} = 24.375\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_4 = \\frac{65}{1 + 0.60} = \\frac{65}{1.60} = 40.625\\ \\mathrm{W\\,m^{-2}}$\n\n早晨时间窗口的算术平均偏差为：\n$\\overline{\\Delta H}_{morning} = \\frac{1}{4} \\sum_{i=1}^{4} \\Delta H_i = \\frac{1}{4} (5.769 + 17.143 + 26.613 + 24.375) = \\frac{73.900}{4} = 18.475\\ \\mathrm{W\\,m^{-2}}$\n$\\overline{\\Delta LE}_{morning} = \\frac{1}{4} \\sum_{i=1}^{4} \\Delta LE_i = \\frac{1}{4} (19.231 + 42.857 + 48.387 + 40.625) = \\frac{151.100}{4} = 37.775\\ \\mathrm{W\\,m^{-2}}$\n\n**傍晚转换期（$t_5$ 至 $t_8$）**\n对于 $t_5 = 18{:}00$，有 $S_5 = -35\\ \\mathrm{W\\,m^{-2}}$ 和 $B_5 = 0.70$：\n$\\Delta H_5 = \\frac{0.70 \\cdot (-35)}{1 + 0.70} = \\frac{-24.5}{1.70} \\approx -14.412\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_5 = \\frac{-35}{1 + 0.70} = \\frac{-35}{1.70} \\approx -20.588\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_6 = 18{:}30$，有 $S_6 = -30\\ \\mathrm{W\\,m^{-2}}$ 和 $B_6 = 0.55$：\n$\\Delta H_6 = \\frac{0.55 \\cdot (-30)}{1 + 0.55} = \\frac{-16.5}{1.55} \\approx -10.645\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_6 = \\frac{-30}{1 + 0.55} = \\frac{-30}{1.55} \\approx -19.355\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_7 = 19{:}00$，有 $S_7 = -18\\ \\mathrm{W\\,m^{-2}}$ 和 $B_7 = 0.45$：\n$\\Delta H_7 = \\frac{0.45 \\cdot (-18)}{1 + 0.45} = \\frac{-8.1}{1.45} \\approx -5.586\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_7 = \\frac{-18}{1 + 0.45} = \\frac{-18}{1.45} \\approx -12.414\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_8 = 19{:}30$，有 $S_8 = -8\\ \\mathrm{W\\,m^{-2}}$ 和 $B_8 = 0.40$：\n$\\Delta H_8 = \\frac{0.40 \\cdot (-8)}{1 + 0.40} = \\frac{-3.2}{1.40} \\approx -2.286\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_8 = \\frac{-8}{1 + 0.40} = \\frac{-8}{1.40} \\approx -5.714\\ \\mathrm{W\\,m^{-2}}$\n\n傍晚时间窗口的算术平均偏差为：\n$\\overline{\\Delta H}_{evening} = \\frac{1}{4} \\sum_{i=5}^{8} \\Delta H_i = \\frac{1}{4} (-14.412 - 10.645 - 5.586 - 2.286) = \\frac{-32.929}{4} = -8.23225\\ \\mathrm{W\\,m^{-2}}$\n$\\overline{\\Delta LE}_{evening} = \\frac{1}{4} \\sum_{i=5}^{8} \\Delta LE_i = \\frac{1}{4} (-20.588 - 19.355 - 12.414 - 5.714) = \\frac{-58.071}{4} = -14.51775\\ \\mathrm{W\\,m^{-2}}$\n\n最后，我们按照要求将这些平均偏差四舍五入到三位有效数字。\n早晨 $H$ 偏差：$\\overline{\\Delta H}_{morning} = 18.475 \\approx 18.5\\ \\mathrm{W\\,m^{-2}}$\n早晨 $LE$ 偏差：$\\overline{\\Delta LE}_{morning} = 37.775 \\approx 37.8\\ \\mathrm{W\\,m^{-2}}$\n傍晚 $H$ 偏差：$\\overline{\\Delta H}_{evening} = -8.23225 \\approx -8.23\\ \\mathrm{W\\,m^{-2}}$\n傍晚 $LE$ 偏差：$\\overline{\\Delta LE}_{evening} = -14.51775 \\approx -14.5\\ \\mathrm{W\\,m^{-2}}$\n\n这些结果量化了当忽略存储项 $S$ 时，早晨湍流通量的高估（正偏差）和傍晚的低估（负偏差），这是一个与物理规律一致的结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 18.5  37.8  -8.23  -14.5 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本章的终极实践是构建一个完整的地表能量平衡数值求解器，这正是陆面过程模型的核心。与诊断方程不同，预测模型必须通过求解一个非线性系统来预测地表状态，即找到那个能使所有能量通量（净辐射、感热、潜热和地表热通量）达到平衡的地表温度 $T_s$ 。这个编码练习将模拟这一过程，要求您运用牛顿法求解不同地表类型下的能量平衡方程，从而将所有学到的物理概念融会贯通，应用于一个完全耦合的预测框架中。",
            "id": "4097707",
            "problem": "您的任务是为多个预设情景实施一个物理上一致的午间地表能量平衡计算，并使用迭代牛顿法求解未知的地表温度。该计算必须基于基本的物理定律以及在数值天气预报和气候模型中广泛使用的参数化方案。\n\n从地表控制体积的能量守恒定律开始，该定律指出净辐射等于湍流感热通量和潜热通量以及传导性地表热通量之和：\n$$\nR_n = H + LE + G.\n$$\n目标是给定气象输入和地表参数，找到满足此平衡的地表温度 $T_s$。\n\n使用以下物理基础和参数化方案，除了这些基本原理外，不使用任何捷径：\n\n- 净辐射 $R_n$ 是净短波辐射和净长波辐射的总和：\n$$\nR_n(T_s) = (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4,\n$$\n其中 $\\alpha$ 是地表反照率，$S_{\\downarrow}$ 是向下短波辐照度，$L_{\\downarrow}$ 是向下长波辐照度，$\\epsilon$ 是地表发射率，$\\sigma$ 是 Stefan–Boltzmann 常数。\n\n- 湍流感热通量 $H$ 通过整体输送和中性 Monin–Obukhov 相似性理论进行参数化：\n$$\nH(T_s) = \\rho c_p \\frac{T_s - T_a}{r_{ah}},\n$$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热，$T_a$ 是气温，$r_{ah}$ 是中性稳定度下的热量空气动力学阻力。\n\n- 湍流潜热通量 $LE$ 使用包含空气动力学阻力和地表阻力的整体公式：\n$$\nLE(T_s) = \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s},\n$$\n其中 $L_v$ 是蒸发潜热，$q_{sat}(T_s)$ 是地表温度下的饱和比湿，$q_a$ 是空气比湿（从相对湿度诊断得出），$r_s$ 是地表（气孔）阻力。\n\n- 地表热通量 $G$ 通过傅里叶热传导定律近似计算，即热量穿过薄表层土壤：\n$$\nG(T_s) = \\frac{k_g}{d_g} (T_s - T_d),\n$$\n其中 $k_g$ 是土壤热导率，$d_g$ 是上层土壤的厚度，$T_d$ 是该层底部的温度。\n\n从基本定义推导所有必要的中间量：\n\n- 空气密度由理想气体定律得出：\n$$\n\\rho = \\frac{p}{R_d T_a},\n$$\n其中 $p$ 是气压，$R_d$ 是干空气的比气体常数。\n\n- 中性条件下的空气动力学阻力使用对数风廓线计算：\n$$\nr_{ah} = \\frac{\\ln\\left(\\frac{z_{ref} - d}{z_{0m}}\\right) \\cdot \\ln\\left(\\frac{z_{ref} - d}{z_{0h}}\\right)}{\\kappa^2 U},\n$$\n其中 $z_{ref}$ 是测量参考高度，$d$ 是零平面位移高度，$z_{0m}$ 和 $z_{0h}$ 分别是动量和热量的粗糙度长度，$\\kappa$ 是 von Kármán 常数，$U$ 是风速。\n\n- 水面饱和水汽压 $e_{sat}(T)$ 使用 Tetens 关系式计算，适用于摄氏温度：\n$$\ne_{sat}(T) = a \\exp\\left(\\frac{b \\, T_C}{c + T_C}\\right),\n$$\n其中 $T_C = T - 273.15$, $a = 611.2 \\,\\text{Pa}$, $b = 17.62$, $c = 243.12 \\,\\text{°C}$。\n\n- 比湿由水汽压计算得出：\n$$\nq = \\frac{\\epsilon_{mw} \\, e}{p - (1 - \\epsilon_{mw}) e},\n$$\n其中 $\\epsilon_{mw} = 0.622$ 是水和干空气的摩尔质量比，$e$ 是水汽压。通过 $e_a = \\mathrm{RH} \\cdot e_{sat}(T_a)$ 从相对湿度 $\\mathrm{RH}$ 计算空气比湿 $q_a$，然后将 $e_a$ 代入比湿公式。通过将 $e_{sat}(T_s)$ 代入同一公式来计算饱和比湿 $q_{sat}(T_s)$。\n\n您必须找到求解\n$$\nF(T_s) \\equiv R_n(T_s) - H(T_s) - LE(T_s) - G(T_s) = 0.\n$$\n的 $T_s$。\n为 $T_s$ 实现一个牛顿法，初始猜测为 $T_s^{(0)} = T_a$，最大迭代次数为 $N_{max} = 50$，停止标准要求通量残差的绝对值 $\\left|F(T_s)\\right|  \\tau_F$ 和温度增量的绝对值 $\\left|\\Delta T_s\\right|  \\tau_T$ 同时满足，其中 $\\tau_F = 10^{-2} \\text{ W}\\,\\text{m}^{-2}$ 且 $\\tau_T = 10^{-6} \\text{ K}$。如果原始牛顿步长过大，您可以对其进行阻尼，但必须保持在物理上合理的范围内。\n\n使用的常量：\n- Stefan–Boltzmann 常数 $\\sigma = 5.670374419 \\times 10^{-8}$ in $\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$，\n- 比热 $c_p = 1004$ in $\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，\n- 蒸发潜热 $L_v = 2.5 \\times 10^{6}$ in $\\text{J}\\,\\text{kg}^{-1}$，\n- 干空气气体常数 $R_d = 287$ in $\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，\n- von Kármán 常数 $\\kappa = 0.4$，\n- 分子量比 $\\epsilon_{mw} = 0.622$。\n\n单位和输出要求：\n- 所有通量 $R_n$、$H$、$LE$ 和 $G$ 必须以 $\\text{W}\\,\\text{m}^{-2}$ 为单位报告。\n- 地表温度 $T_s$ 必须以 $\\text{K}$ 为单位报告。\n- 报告的每个数值都需四舍五入到三位小数。\n- 不使用角度，因此不需要角度单位。\n- 相对湿度 $\\mathrm{RH}$ 必须作为无单位的小数处理。\n\n测试套件：\n使用以下预设案例。每个案例定义了 $(p, S_{\\downarrow}, L_{\\downarrow}, \\alpha, \\epsilon, T_a, \\mathrm{RH}, U, z_{ref}, d, z_{0m}, z_{0h}, r_s, T_d, k_g, d_g)$：\n\n- 案例A（植被农田，午间，中等风速，中纬度）：$\\left(101325, 800, 400, 0.20, 0.97, 300, 0.50, 3.0, 10.0, 0.536, 0.080, 0.008, 100, 298, 1.0, 0.10\\right)$。\n- 案例B（裸露干土，强日照，低湿度）：$\\left(101325, 1000, 350, 0.30, 0.95, 310, 0.20, 5.0, 2.0, 0.0, 0.010, 0.001, 500, 305, 0.8, 0.05\\right)$。\n- 案例C（积雪表面，高反照率，寒冷，高海拔）：$\\left(80000, 500, 250, 0.85, 0.99, 270, 0.90, 4.0, 2.0, 0.0, 0.001, 0.001, 0, 268, 0.5, 0.20\\right)$。\n- 案例D（湿润热带冠层，高粗糙度，极低风速）：$\\left(101325, 900, 450, 0.12, 0.98, 302, 0.80, 0.1, 30.0, 13.400, 2.000, 0.200, 50, 300, 1.5, 0.10\\right)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个类似JSON的嵌套列表，其中每个元素按A、B、C、D的顺序对应一个测试案例，每个案例的元素是列表 $[R_n, H, LE, G, T_s]$，所有值都四舍五入到三位小数，格式如下\n$$\n[[R_n^A, H^A, LE^A, G^A, T_s^A],[R_n^B, H^B, LE^B, G^B, T_s^B],[R_n^C, H^C, LE^C, G^C, T_s^C],[R_n^D, H^D, LE^D, G^D, T_s^D]].\n$$\n精确打印这一行，不含任何额外文本。",
            "solution": "该问题已经过验证，被确定是合理的。它在科学上基于陆地-大气相互作用的原理，问题设定清晰，目标明确，数据充分，并使用大气科学和数值天气预报中的标准参数化方案进行客观表述。所有提供的参数和常数在物理上都是真实且一致的。因此，将提供一个解决方案。\n\n问题的核心是找到满足地表能量平衡方程的地表温度 $T_s$：\n$$\nF(T_s) = R_n(T_s) - H(T_s) - LE(T_s) - G(T_s) = 0\n$$\n这是一个关于单变量 $T_s$ 的求根问题。我们被要求使用牛顿法，这是一个由以下更新规则定义的迭代方案：\n$$\nT_s^{(k+1)} = T_s^{(k)} - \\frac{F(T_s^{(k)})}{F'(T_s^{(k)})}\n$$\n其中 $T_s^{(k)}$ 是第 $k$ 次迭代时根的估计值，$F'(T_s)$ 是函数 $F(T_s)$ 相对于 $T_s$ 的一阶导数。\n\n求解过程包括以下步骤：\n1.  对于每个测试案例，计算所有不依赖于 $T_s$ 的量。\n2.  实现牛顿法迭代循环以求解 $T_s$。这需要对函数 $F(T_s)$ 及其导数 $F'(T_s)$ 进行解析推导。\n3.  一旦找到收敛的 $T_s$ 值，就用它来计算能量平衡各分量的最终值：$R_n$、$H$、$LE$ 和 $G$。\n\n让我们定义函数 $F(T_s)$ 及其导数 $F'(T_s)$。函数 $F(T_s)$ 由给定的参数化方案构建：\n$$\nF(T_s) = \\left( (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4 \\right) - \\left( \\rho c_p \\frac{T_s - T_a}{r_{ah}} \\right) - \\left( \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s} \\right) - \\left( \\frac{k_g}{d_g} (T_s - T_d) \\right) = 0\n$$\n\n为了求导数 $F'(T_s) = \\frac{dF}{dT_s}$，我们将每一项对 $T_s$ 求导：\n\n1.  **净辐射导数**：短波分量和向下长波辐射相对于 $T_s$ 是常数。只有向外长波辐射依赖于 $T_s$。\n    $$\n    \\frac{d R_n}{d T_s} = \\frac{d}{d T_s} \\left( (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4 \\right) = -4 \\epsilon \\sigma T_s^3\n    $$\n\n2.  **感热通量导数**：\n    $$\n    \\frac{d H}{d T_s} = \\frac{d}{d T_s} \\left( \\rho c_p \\frac{T_s - T_a}{r_{ah}} \\right) = \\frac{\\rho c_p}{r_{ah}}\n    $$\n\n3.  **地表热通量导数**：\n    $$\n    \\frac{d G}{d T_s} = \\frac{d}{d T_s} \\left( \\frac{k_g}{d_g} (T_s - T_d) \\right) = \\frac{k_g}{d_g}\n    $$\n\n4.  **潜热通量导数**：这是最复杂的一项，因为 $q_{sat}$ 是 $T_s$ 的一个非线性函数。\n    $$\n    \\frac{d (LE)}{d T_s} = \\frac{d}{d T_s} \\left( \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s} \\right) = \\frac{\\rho L_v}{r_{ah} + r_s} \\frac{d q_{sat}}{d T_s}\n    $$\n    我们必须使用链式法则求 $\\frac{d q_{sat}}{d T_s}$：$\\frac{d q_{sat}}{d T_s} = \\frac{\\partial q_{sat}}{\\partial e_{sat}} \\frac{d e_{sat}}{d T_s}$。\n\n    首先，我们从 Tetens 公式 $e_{sat}(T) = a \\exp\\left(\\frac{b T_C}{c + T_C}\\right)$ 求 $\\frac{d e_{sat}}{d T_s}$，其中 $T_C = T_s - 273.15$。\n    $$\n    \\frac{d e_{sat}}{d T_s} = a \\exp\\left(\\frac{b(T_s - 273.15)}{c + (T_s - 273.15)}\\right) \\cdot \\frac{d}{d T_s}\\left(\\frac{b(T_s - 273.15)}{c + (T_s - 273.15)}\\right)\n    $$\n    对指数项的导数应用商法则：\n    $$\n    \\frac{d e_{sat}}{d T_s} = e_{sat}(T_s) \\cdot \\frac{b c}{(c + (T_s - 273.15))^2}\n    $$\n\n    接下来，我们从比湿定义 $q = \\frac{\\epsilon_{mw} e}{p - (1-\\epsilon_{mw})e}$ 求 $\\frac{\\partial q_{sat}}{\\partial e_{sat}}$。\n    使用商法则：\n    $$\n    \\frac{\\partial q}{\\partial e} = \\frac{\\epsilon_{mw}(p - (1-\\epsilon_{mw})e) - \\epsilon_{mw}e(-(1-\\epsilon_{mw}))}{(p - (1-\\epsilon_{mw})e)^2} = \\frac{\\epsilon_{mw} p}{(p - (1-\\epsilon_{mw})e)^2}\n    $$\n    代入 $e = e_{sat}(T_s)$，我们得到 $\\frac{\\partial q_{sat}}{\\partial e_{sat}}$。\n\n    结合这些，潜热通量的导数是：\n    $$\n    \\frac{d (LE)}{d T_s} = \\frac{\\rho L_v}{r_{ah} + r_s} \\left( \\frac{\\epsilon_{mw} p}{(p - (1-\\epsilon_{mw})e_{sat}(T_s))^2} \\right) \\left( e_{sat}(T_s) \\frac{b c}{(c + (T_s - 273.15))^2} \\right)\n    $$\n\n最后，总导数 $F'(T_s) = \\frac{d R_n}{d T_s} - \\frac{d H}{d T_s} - \\frac{d (LE)}{d T_s} - \\frac{d G}{d T_s}$ 为：\n$$\nF'(T_s) = -4 \\epsilon \\sigma T_s^3 - \\frac{\\rho c_p}{r_{ah}} - \\frac{k_g}{d_g} - \\frac{d (LE)}{d T_s}\n$$\n$F'(T_s)$ 中的所有项都是负的（因为 $\\frac{d(LE)}{dT_s} > 0$），这确保了 $F(T_s)$ 是一个严格单调递减的函数。这保证了根的唯一性和牛顿法的稳定性。\n\n对于每个测试案例，算法按以下步骤进行：\n1.  定义所有物理常数和案例特定常数。给定的相对湿度 $\\mathrm{RH}$ 作为小数使用（例如，50% 用 0.50）。\n2.  计算常数参数：空气密度 $\\rho$ 和空气动力学阻力 $r_{ah}$。根据给定的 $T_a$ 和 $\\mathrm{RH}$ 计算空气比湿 $q_a$。\n3.  以 $T_s^{(0)} = T_a$ 初始化迭代。\n4.  循环最多 $N_{max}=50$ 次迭代：\n    a. 使用当前的 $T_s^{(k)}$ 计算 $F(T_s)$ 和 $F'(T_s)$ 的所有项。\n    b. 计算更新步长 $\\Delta T_s = -F(T_s^{(k)}) / F'(T_s^{(k)})$。\n    c. 为提高稳定性，如果步长过大，则进行阻尼：$\\Delta T_s \\leftarrow \\text{sign}(\\Delta T_s) \\cdot \\min(|\\Delta T_s|, 5.0\\,\\text{K})$。\n    d. 更新温度：$T_s^{(k+1)} = T_s^{(k)} + \\Delta T_s$。\n    e. 检查收敛性：如果 $|F(T_s^{(k+1)})|  \\tau_F$ 且 $|\\Delta T_s|  \\tau_T$，则终止循环。\n5.  循环终止后，使用最终的 $T_s$ 重新计算通量 $R_n$、$H$、$LE$ 和 $G$ 的最终值。\n6.  存储列表 $[R_n, H, LE, G, T_s]$，数值四舍五入到三位小数。\n7.  对所有测试案例重复以上步骤，并将结果格式化为所需的单行输出。",
            "answer": "[[592.569,183.189,389.502,19.878,301.988],[560.778,410.638,71.722,78.418,322.842],[70.158,52.376,14.629,3.153,271.153],[716.208,42.592,654.550,19.066,303.271]]"
        }
    ]
}