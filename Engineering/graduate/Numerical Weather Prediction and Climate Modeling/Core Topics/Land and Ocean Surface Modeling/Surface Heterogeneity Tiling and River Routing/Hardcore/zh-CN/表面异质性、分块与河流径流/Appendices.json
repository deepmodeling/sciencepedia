{
    "hands_on_practices": [
        {
            "introduction": "陆面水文学的一个基本任务是模拟非均匀地表上的降水如何转化为河流径流。本练习提供了一个动手实践的机会，让您构建一个捕捉此完整过程的简化模型。您将为不同的地表“图块”实施一个“水桶”模型，以模拟它们何时达到饱和并开始产生径流，然后通过一个线性水库对汇集的径流进行演算，以模拟河流流量，这是理解模型如何表示从陆地到河流路径的基础技能。",
            "id": "4098472",
            "problem": "考虑一个由 $N$ 个地块代表的非均质地表，每个地块由一个单桶水量平衡模型建模。对于地块 $i \\in \\{1,\\dots,N\\}$，其桶蓄水量 $S_i(t)$（单位：毫米水深）在恒定降水强迫 $P$（单位：毫米/小时）和恒定的地块特定蒸发 $E_i$（单位：毫米/小时）作用下，根据连续性方程演变：\n$$\n\\frac{dS_i}{dt} = P - E_i - Q_i(S_i),\n$$\n其中 $Q_i(S_i)$（单位：毫米/小时）是径流产流项。每个地块都有一个有限的蓄水容量 $S_i^{\\max}$（单位：毫米）和一个初始蓄水量 $S_{i0}$（单位：毫米），满足 $0 \\le S_{i0} \\le S_i^{\\max}$。在恒定强迫下，假设为蓄满产流：在达到饱和之前，没有径流产生；一旦饱和，额外的输入将作为径流流失，而蓄水量保持在容量水平，即：\n- 如果 $S_i(t)  S_i^{\\max}$，则 $Q_i(S_i(t)) = 0$，\n- 如果 $S_i(t) = S_i^{\\max}$ 且 $P > E_i$，则 $Q_i(S_i(t)) = P - E_i$，因此 $\\frac{dS_i}{dt} = 0$ 且 $S_i(t)$ 在产流开始后保持等于 $S_i^{\\max}$。\n\n设 $a_i$ 表示地块 $i$ 的面积比例，且 $\\sum_{i=1}^N a_i = 1$。流域出口由一个滞留时间为 $\\tau_r$（单位：小时）的单一线性水库 (LR) 表示，该水库对各地块径流的面积加权和进行汇流。设 $R(t)$（单位：毫米）表示水库蓄水量。线性水库的动态过程和流量 $D(t)$（单位：毫米/小时）由以下公式给出：\n$$\n\\frac{dR}{dt} = \\sum_{i=1}^N a_i \\, Q_i(t) - \\frac{R}{\\tau_r}, \\quad D(t) = \\frac{R(t)}{\\tau_r},\n$$\n且 $R(0) = 0$。\n\n任务：\n1. 对于每个地块 $i$，推导并计算蓄满产流 (SER) 的开始时间 $t_i^{\\text{sat}}$（单位：小时），定义为满足 $S_i(t) = S_i^{\\max}$ 的最早时间 $t \\ge 0$。如果 $P - E_i \\le 0$ 且 $S_{i0}  S_i^{\\max}$，则 SER 永不发生；在这种情况下，为 $t_i^{\\text{sat}}$ 返回 $-1.0$。如果 $S_{i0} = S_i^{\\max}$，则设 $t_i^{\\text{sat}} = 0$。\n2. 使用上述线性水库汇流模型，计算在给定的最终时间 $T_{\\text{end}}$（单位：小时）的出口流量，即 $D(T_{\\text{end}})$（单位：毫米/小时），假设在相应的 $t_i^{\\text{sat}}$ 之前径流输入为零，此后等于 $P - E_i$（仅适用于 $P - E_i  0$ 的地块）。\n\n所有答案的时间单位必须是小时，通量单位必须是毫米/小时，并以程序的默认浮点精度进行舍入（无需显式四舍五入）。\n\n你的程序必须实现以下确切的规范，并生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个列表，包含每个地块的 SER 开始时间，后跟在 $T_{\\text{end}}$ 时的出口流量，即 $[ [t_1^{\\text{sat}}, \\dots, t_N^{\\text{sat}}, D(T_{\\text{end}})], \\dots ]$。\n\n使用以下三个测试用例套件，旨在探究不同的行为：\n\n- 案例 A（非均质地块；一个地块在时间范围内饱和）：\n  - $N = 2$，$P = 5$ 毫米/小时，\n  - $E_1 = 1$ 毫米/小时，$E_2 = 2$ 毫米/小时，\n  - $S_1^{\\max} = 100$ 毫米，$S_2^{\\max} = 80$ 毫米，\n  - $S_{10} = 20$ 毫米，$S_{20} = 70$ 毫米，\n  - $a_1 = 0.6$，$a_2 = 0.4$，\n  - $\\tau_r = 2$ 小时，$T_{\\text{end}} = 10$ 小时。\n\n- 案例 B（在净负输入下不饱和）：\n  - $N = 2$，$P = 1$ 毫米/小时，\n  - $E_1 = 1.5$ 毫米/小时，$E_2 = 2.0$ 毫米/小时，\n  - $S_1^{\\max} = 80$ 毫米，$S_2^{\\max} = 90$ 毫米，\n  - $S_{10} = 10$ 毫米，$S_{20} = 20$ 毫米，\n  - $a_1 = 0.5$，$a_2 = 0.5$，\n  - $\\tau_r = 1$ 小时，$T_{\\text{end}} = 5$ 小时。\n\n- 案例 C（一个地块初始饱和；另一个稍后饱和）：\n  - $N = 2$，$P = 6$ 毫米/小时，\n  - $E_1 = 1$ 毫米/小时，$E_2 = 4$ 毫米/小时，\n  - $S_1^{\\max} = 50$ 毫米，$S_2^{\\max} = 40$ 毫米，\n  - $S_{10} = 50$ 毫米，$S_{20} = 30$ 毫米，\n  - $a_1 = 0.5$，$a_2 = 0.5$，\n  - $\\tau_r = 3$ 小时，$T_{\\text{end}} = 12$ 小时。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，`[[\\dots],[\\dots],[\\dots]]`），并遵循确切的格式：\n$[[t_1^{\\text{sat}},\\dots,t_N^{\\text{sat}},D(T_{\\text{end}})], [\\dots], [\\dots]]$。",
            "solution": "用户提供的问题已经过验证，被确定为流域水文学中一个适定的、有科学依据的问题。所有必要的参数和初始条件都已提供，模型组成部分——用于模拟土壤湿度的分块桶模型和用于汇流的线性水库——均为该领域的标准模型。该问题没有矛盾、歧义和事实错误。\n\n解决方案按要求分两部分进行：首先，推导每个地块的蓄满产流开始时间；其次，计算在指定最终时间的出口流量。\n\n### 第 1 部分：蓄满产流的开始时间 ($t_i^{\\text{sat}}$)\n\n对于每个地块 $i$，其蓄水量 $S_i(t)$ 根据连续性方程演变：\n$$\n\\frac{dS_i}{dt} = P - E_i - Q_i(S_i)\n$$\n其中 $P$ 是降水率，$E_i$ 是蒸发率，$Q_i(S_i)$ 是径流。问题指定了蓄满产流机制，只要地块蓄水量 $S_i(t)$ 低于其容量 $S_i^{\\max}$，径流 $Q_i(S_i) = 0$。\n\n在此条件下 ($S_i(t)  S_i^{\\max}$)，微分方程简化为：\n$$\n\\frac{dS_i}{dt} = P - E_i\n$$\n设地块 $i$ 的恒定净水分输入为 $I_i = P - E_i$。由于 $I_i$ 是常数，我们可以将这个一阶常微分方程从 $t=0$ 到 $t$ 对时间进行积分：\n$$\n\\int_{S_{i0}}^{S_i(t)} dS' = \\int_{0}^{t} I_i d\\tau\n$$\n这给出了饱和前蓄水量的演变过程：\n$$\nS_i(t) - S_{i0} = I_i t \\implies S_i(t) = S_{i0} + (P - E_i)t\n$$\n蓄满产流的开始时间 $t_i^{\\text{sat}}$ 定义为 $S_i(t)$ 首次达到 $S_i^{\\max}$ 的时间。设 $S_i(t_i^{\\text{sat}}) = S_i^{\\max}$：\n$$\nS_i^{\\max} = S_{i0} + (P - E_i) t_i^{\\text{sat}}\n$$\n解出 $t_i^{\\text{sat}}$ 得：\n$$\nt_i^{\\text{sat}} = \\frac{S_i^{\\max} - S_{i0}}{P - E_i}\n$$\n该公式在特定条件下有效：\n1.  如果净输入 $P - E_i  0$，蓄水量将增加，并最终发生饱和。上述公式直接适用。\n2.  如果地块初始饱和，$S_{i0} = S_i^{\\max}$，则分子为 $0$，因此按规定 $t_i^{\\text{sat}} = 0$。\n3.  如果净输入 $P - E_i \\le 0$ 且地块未初始饱和 ($S_{i0}  S_i^{\\max}$)，则蓄水量不会增加。永远不会达到饱和状态。在这种情况下，$t_i^{\\text{sat}}$ 设为 $-1.0$。\n\n### 第 2 部分：最终时间的出口流量 ($D(T_{\\text{end}})$)\n\n出口流量 $D(t)$ 由线性水库中的蓄水量 $R(t)$ 决定，其中 $D(t) = R(t)/\\tau_r$。水库蓄水量根据以下公式演变：\n$$\n\\frac{dR}{dt} = Q_{\\text{in}}(t) - \\frac{R(t)}{\\tau_r}\n$$\n初始条件为 $R(0) = 0$。总入流量 $Q_{\\text{in}}(t)$ 是所有地块径流的面积加权和：\n$$\nQ_{\\text{in}}(t) = \\sum_{i=1}^N a_i Q_i(t)\n$$\n其中每个地块的 $Q_i(t)$ 是一个阶跃函数：\n$$\nQ_i(t) = \\begin{cases} 0  \\text{如果 } t  t_i^{\\text{sat}} \\text{ 或 } P - E_i \\le 0 \\\\ P - E_i  \\text{如果 } t \\ge t_i^{\\text{sat}} \\text{ 且 } P - E_i  0 \\end{cases}\n$$\n因此，总入流量 $Q_{\\text{in}}(t)$ 是一个分段常数函数。$Q_{\\text{in}}(t)$ 的值仅在饱和开始时间 $t_i^{\\text{sat}}$ 发生变化。\n\n让我们定义一组事件时间 $\\{t_k\\}$，作为在 $T_{\\text{end}}$ 之前发生的、经过排序的、唯一的正饱和时间。将 $0$ 和 $T_{\\text{end}}$ 添加到这个集合中，我们得到一个有序的时间点序列 $0 = \\theta_0 \\le \\theta_1 \\le \\dots \\le \\theta_M = T_{\\text{end}}$。在任何区间 $[\\theta_j, \\theta_{j+1})$ 内，入流量 $Q_{\\text{in}}(t)$ 是一个常数，记为 $Q_j$。在此区间内，我们求解线性常微分方程：\n$$\n\\frac{dR}{dt} + \\frac{1}{\\tau_r} R = Q_j, \\quad \\text{对于 } t \\in [\\theta_j, \\theta_{j+1})\n$$\n在给定区间开始时的蓄水量 $R(\\theta_j)$ 的情况下，$R(t)$ 的解析解为：\n$$\nR(t) = \\left(R(\\theta_j) - Q_j \\tau_r\\right) e^{-(t-\\theta_j)/\\tau_r} + Q_j \\tau_r\n$$\n$Q_j$ 的值是 $\\sum_{i} a_i(P-E_i)$，其中求和遍及所有在时间 $\\theta_j$ 之前或之时已经饱和的地块 $i$（即 $t_i^{\\text{sat}} \\le \\theta_j$ 且 $P-E_i  0$）。\n\n计算算法如下：\n1.  计算所有地块 $i=1, \\dots, N$ 的 $t_i^{\\text{sat}}$。\n2.  取集合 $\\{0, T_{\\text{end}}\\} \\cup \\{t_i^{\\text{sat}} \\mid 0  t_i^{\\text{sat}}  T_{\\text{end}}\\}$ 并对其进行排序，构建一个时间点序列。\n3.  在 $t=0$ 时初始化水库蓄水量 $R = 0$。\n4.  遍历由排序后的时间点定义的时间区间。对于从 $t_{\\text{start}}$ 到 $t_{\\text{end}}$ 的每个区间：\n    a. 确定恒定的总入流量 $Q_{\\text{in}} = \\sum_{i | t_i^{\\text{sat}} \\le t_{\\text{start}}, P-E_i0} a_i(P-E_i)$。\n    b. 使用解析解更新区间末端的水库蓄水量：$R(t_{\\text{end}}) = (R(t_{\\text{start}}) - Q_{\\text{in}}\\tau_r) e^{-(t_{\\text{end}}-t_{\\text{start}})/\\tau_r} + Q_{\\text{in}}\\tau_r$。\n5.  处理完以 $T_{\\text{end}}$ 结束的最后一个区间后，得到的结果蓄水量为 $R(T_{\\text{end}})$。\n6.  最终流量为 $D(T_{\\text{end}}) = R(T_{\\text{end}}) / \\tau_r$。此方法无需数值积分即可得到精确解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the hydrology problem for the given test cases.\n    \"\"\"\n\n    def solve_case(params):\n        \"\"\"\n        Solves a single test case of the land surface hydrology problem.\n\n        Args:\n            params (tuple): A tuple containing all parameters for the case:\n                (N, P, E, S_max, S0, a, tau_r, T_end)\n\n        Returns:\n            list: A list containing the SER onset times for each tile followed\n                  by the outlet discharge at T_end, i.e.,\n                  [t_1^sat, ..., t_N^sat, D(T_end)].\n        \"\"\"\n        N, P, E, S_max, S0, a, tau_r, T_end = params\n\n        # Task 1: Compute the onset time of Saturation-Excess Runoff (SER), t_i^sat\n        t_sats = []\n        for i in range(N):\n            if S0[i] >= S_max[i]:\n                t_sat = 0.0\n            elif P - E[i] = 0:\n                t_sat = -1.0\n            else:\n                t_sat = (S_max[i] - S0[i]) / (P - E[i])\n            t_sats.append(t_sat)\n\n        # Task 2: Compute the outlet discharge D(T_end)\n        \n        # Define event times: 0, T_end, and all positive saturation times less than T_end.\n        # These are the points in time where the inflow Q_in to the reservoir changes.\n        event_times = {0.0, T_end}\n        for t_sat in t_sats:\n            if 0  t_sat  T_end:\n                event_times.add(t_sat)\n        \n        sorted_times = sorted(list(event_times))\n        \n        # Propagate reservoir storage through piecewise constant inflow intervals\n        R = 0.0  # Initial reservoir storage R(0) = 0\n        for i in range(len(sorted_times) - 1):\n            t_start = sorted_times[i]\n            t_end = sorted_times[i+1]\n            dt = t_end - t_start\n            \n            # Calculate total inflow Q_in for the interval [t_start, t_end)\n            # Q_in is constant over this interval.\n            Q_in = 0.0\n            for j in range(N):\n                net_input = P - E[j]\n                # A tile contributes runoff if it's saturated (t_sat >= 0), has\n                # positive net input, and its saturation time is before or at t_start.\n                if t_sats[j] >= 0 and net_input > 0 and t_sats[j] = t_start:\n                    Q_in += a[j] * net_input\n            \n            # Apply the analytical solution for the linear reservoir ODE\n            if tau_r > 0:\n                # R(t_end) = (R(t_start) - Q_in * tau_r) * exp(-dt / tau_r) + Q_in * tau_r\n                R_ss = Q_in * tau_r  # Steady-state storage for the constant inflow\n                R = R_ss + (R - R_ss) * np.exp(-dt / tau_r)\n            else: # Fallback for tau_r = 0 (instantaneous response)\n                R = 0 # Not physically meaningful in this context, but avoids errors.\n        \n        # Final discharge D(T_end) = R(T_end) / tau_r\n        D_Tend = R / tau_r if tau_r > 0 else 0.0\n        \n        # Assemble the results for this case\n        result = t_sats + [D_Tend]\n        return result\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (heterogeneous tiles; one saturates within horizon)\n        (\n            2, 5.0, [1.0, 2.0], [100.0, 80.0], [20.0, 70.0], [0.6, 0.4], 2.0, 10.0\n        ),\n        # Case B (no saturation under net-negative input)\n        (\n            2, 1.0, [1.5, 2.0], [80.0, 90.0], [10.0, 20.0], [0.5, 0.5], 1.0, 5.0\n        ),\n        # Case C (one tile initially saturated; another saturates later)\n        (\n            2, 6.0, [1.0, 4.0], [50.0, 40.0], [50.0, 30.0], [0.5, 0.5], 3.0, 12.0\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(solve_case(case))\n    \n    # Format the output string precisely as required: [[...],[...],[...]]\n    # No spaces within the inner or outer lists.\n    outer_list_str = []\n    for res_list in results:\n        # Using a general format specifier 'g' to handle floats cleanly.\n        inner_list_str = f\"[{','.join(f'{val:.15g}' for val in res_list)}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_output = f\"[{','.join(outer_list_str)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "真实的景观并非仅仅是独立地块的集合；水在到达河流之前会在它们之间流动。本练习超越了简单的径流汇集，探讨了如何根据相邻图块的水位和高程来模拟它们之间的侧向水交换。通过推导和分析一个耦合矩阵，您将深入了解网格单元的内部动态，以及水在亚网格尺度上重新分布的时间尺度。",
            "id": "4098409",
            "problem": "在数值天气预报 (NWP) 和气候模型中，一个陆面方案使用瓦片来表示亚网格地表非均质性。考虑由 $i \\in \\{1,2,3\\}$ 索引的三个瓦片，其平面面积为 $A_i$，基底高程为 $z_i$，水柱深度为 $w_i(t)$（相对于基底测量，因此瓦片 $i$ 上的总水头为 $h_i = w_i + z_i$）。瓦片间的水储量交换被建模为由水头差驱动的线性水力耦合：从瓦片 $i$到瓦片 $j$ 的体积通量为 $Q_{ij} = C_{ij}\\,(h_i - h_j)$，其中 $C_{ij} = C_{ji} \\ge 0$ 是对称传导系数，且 $C_{ii}=0$。瓦片 $i$ 上的储量为 $S_i = A_i w_i$，瓦片间的交换是唯一作用的过程（没有降水、蒸发、入渗或外部汇/源）。\n\n1. 从质量守恒出发，推导 $\\dot{\\boldsymbol{w}}$ 的常微分方程，其形式为 $\\dot{\\boldsymbol{w}} = -\\boldsymbol{L}\\,\\boldsymbol{w} + \\boldsymbol{r}$，其中 $\\boldsymbol{w} = (w_1,w_2,w_3)^{\\mathsf{T}}$，并写出耦合矩阵 $\\boldsymbol{L}$ 的元素 $L_{ij}$ 和分量 $r_i$ 的显式公式。证明由 $\\boldsymbol{L}$ 暗示的瓦片间交换在封闭的三瓦片系统中保持总水量守恒。\n\n2. 对于具有以下参数的特定三瓦片系统：\n- $A_1 = 2.0 \\times 10^{6}\\ \\mathrm{m}^2$, $A_2 = 3.0 \\times 10^{6}\\ \\mathrm{m}^2$, $A_3 = 1.0 \\times 10^{6}\\ \\mathrm{m}^2$,\n- $z_1 = 250\\ \\mathrm{m}$, $z_2 = 200\\ \\mathrm{m}$, $z_3 = 150\\ \\mathrm{m}$,\n- $C_{12} = 1.2 \\times 10^{6}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $C_{23} = 0.8 \\times 10^{6}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$, $C_{13} = 0.4 \\times 10^{6}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n\n组装数值矩阵 $\\boldsymbol{L}$ (单位为 $\\mathrm{s}^{-1}$) 并计算其特征值。最小的正特征值（代数连通度）决定了瓦片间再分布的最慢内在平衡速率。\n\n报告代数连通度（单位为 $\\mathrm{s}^{-1}$），并将答案四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它在科学上基于质量守恒和线性输运原理，问题提法明确且具有足够信息以获得唯一解，并且语言客观。该模型是陆面模拟中使用的标准简化表示。\n\n**第一部分：控制方程的推导与质量守恒证明**\n\n瓦片 $i$ 上的水储量变化率 $S_i = A_i w_i$ 由质量守恒原理控制。由于系统对外部源和汇是封闭的，储量的变化完全是由于与其他瓦片的水交换。进入瓦片 $i$ 的净体积通量是来自所有其他瓦片 $j$ 的通量之和。\n\n瓦片 $i$ 上储量的变化率为：\n$$ \\frac{dS_i}{dt} = \\sum_{j \\neq i} Q_{ji} $$\n已知 $S_i = A_i w_i$ 且 $A_i$ 是常数，我们有 $\\frac{dS_i}{dt} = A_i \\frac{dw_i}{dt} = A_i \\dot{w}_i$。通量由 $Q_{ji} = C_{ji}(h_j - h_i)$ 给出。利用对称性 $C_{ji}=C_{ij}$，瓦片 $i$ 的质量平衡方程变为：\n$$ A_i \\dot{w}_i = \\sum_{j \\neq i} C_{ij}(h_j - h_i) $$\n我们已知水头为 $h_k = w_k + z_k$。将其代入方程得到：\n$$ A_i \\dot{w}_i = \\sum_{j \\neq i} C_{ij}((w_j + z_j) - (w_i + z_i)) $$\n这些项可以分为依赖于水深 $w_k$ 的项和依赖于基底高程 $z_k$ 的项：\n$$ A_i \\dot{w}_i = \\sum_{j \\neq i} C_{ij}(w_j - w_i) + \\sum_{j \\neq i} C_{ij}(z_j - z_i) $$\n为了分离出 $\\dot{w}_i$，我们除以 $A_i$：\n$$ \\dot{w}_i = \\frac{1}{A_i} \\left( \\sum_{j \\neq i} C_{ij}w_j - w_i \\sum_{j \\neq i} C_{ij} \\right) + \\frac{1}{A_i} \\sum_{j \\neq i} C_{ij}(z_j - z_i) $$\n该方程必须与指定形式 $\\dot{\\boldsymbol{w}} = -\\boldsymbol{L}\\,\\boldsymbol{w} + \\boldsymbol{r}$ 相匹配，其分量形式为 $\\dot{w}_i = \\sum_{j=1}^{3} (-L_{ij}w_j) + r_i$。\n\n通过比较推导出的方程中 $w_j$ 的系数与矩阵形式，我们可以确定矩阵 $\\boldsymbol{L}$ 的元素和向量 $\\boldsymbol{r}$。\n\n当 $j=i$ 时，$w_i$ 的系数是 $-L_{ii}$。从我们推导的方程可知，该系数为 $-\\frac{1}{A_i}\\sum_{k \\neq i} C_{ik}$。因此：\n$$ L_{ii} = \\frac{1}{A_i} \\sum_{k \\neq i} C_{ik} $$\n当 $j \\neq i$ 时，$w_j$ 的系数是 $-L_{ij}$。从我们推导的方程可知，该系数是 $\\frac{C_{ij}}{A_i}$。因此：\n$$ L_{ij} = -\\frac{C_{ij}}{A_i} \\quad (i \\neq j) $$\n其余不依赖于 $\\boldsymbol{w}$ 的项构成了向量 $\\boldsymbol{r}$：\n$$ r_i = \\frac{1}{A_i} \\sum_{j \\neq i} C_{ij}(z_j - z_i) $$\n\n现在，为了证明总水量守恒，我们考察总储量的变化率，$S_{total} = \\sum_{i=1}^{3} S_i = \\sum_{i=1}^{3} A_i w_i$。\n$$ \\dot{S}_{total} = \\frac{d}{dt} \\sum_{i=1}^{3} A_i w_i = \\sum_{i=1}^{3} A_i \\dot{w}_i $$\n代入 $A_i \\dot{w}_i$ 的表达式：\n$$ \\dot{S}_{total} = \\sum_{i=1}^{3} \\left( \\sum_{j \\neq i} C_{ij}(h_j - h_i) \\right) $$\n让我们展开这个三瓦片系统的和：\n$$ \\dot{S}_{total} = \\left[ C_{12}(h_2 - h_1) + C_{13}(h_3 - h_1) \\right] + \\left[ C_{21}(h_1 - h_2) + C_{23}(h_3 - h_2) \\right] + \\left[ C_{31}(h_1 - h_3) + C_{32}(h_2 - h_3) \\right] $$\n利用对称性 $C_{ij}=C_{ji}$，我们可以将对应于同一对瓦片的项组合在一起：\n$$ \\dot{S}_{total} = [C_{12}(h_2 - h_1) + C_{12}(h_1 - h_2)] + [C_{13}(h_3 - h_1) + C_{13}(h_1 - h_3)] + [C_{23}(h_3 - h_2) + C_{23}(h_2 - h_3)] $$\n每个方括号中的项之和为零。例如，$C_{12}(h_2 - h_1) - C_{12}(h_2 - h_1) = 0$。\n因此，$\\dot{S}_{total} = 0$，这证明了封闭系统中的总水量（和储量）是守恒的。\n\n**第二部分：$\\boldsymbol{L}$ 的数值组装和特征值计算**\n\n我们给定以下数值：\n$A_1 = 2.0 \\times 10^{6}\\ \\text{m}^2$, $A_2 = 3.0 \\times 10^{6}\\ \\text{m}^2$, $A_3 = 1.0 \\times 10^{6}\\ \\text{m}^2$.\n$C_{12} = 1.2 \\times 10^{6}\\ \\text{m}^2\\text{s}^{-1}$, $C_{23} = 0.8 \\times 10^{6}\\ \\text{m}^2\\text{s}^{-1}$, $C_{13} = 0.4 \\times 10^{6}\\ \\text{m}^2\\text{s}^{-1}$。\n\n我们使用第一部分的公式组装矩阵 $\\boldsymbol{L}$。$L_{ij}$ 的单位将是 $(\\text{m}^2\\text{s}^{-1}) / \\text{m}^2 = \\text{s}^{-1}$。\n\n$L_{11} = \\frac{C_{12} + C_{13}}{A_1} = \\frac{(1.2 + 0.4) \\times 10^{6}}{2.0 \\times 10^{6}} = \\frac{1.6}{2.0} = 0.8\\ \\text{s}^{-1}$\n$L_{12} = -\\frac{C_{12}}{A_1} = -\\frac{1.2 \\times 10^{6}}{2.0 \\times 10^{6}} = -0.6\\ \\text{s}^{-1}$\n$L_{13} = -\\frac{C_{13}}{A_1} = -\\frac{0.4 \\times 10^{6}}{2.0 \\times 10^{6}} = -0.2\\ \\text{s}^{-1}$\n\n$L_{21} = -\\frac{C_{21}}{A_2} = -\\frac{1.2 \\times 10^{6}}{3.0 \\times 10^{6}} = -0.4\\ \\text{s}^{-1}$\n$L_{22} = \\frac{C_{21} + C_{23}}{A_2} = \\frac{(1.2 + 0.8) \\times 10^{6}}{3.0 \\times 10^{6}} = \\frac{2.0}{3.0} = \\frac{2}{3}\\ \\text{s}^{-1}$\n$L_{23} = -\\frac{C_{23}}{A_2} = -\\frac{0.8 \\times 10^{6}}{3.0 \\times 10^{6}} = -\\frac{0.8}{3.0} = -\\frac{4}{15}\\ \\text{s}^{-1}$\n\n$L_{31} = -\\frac{C_{31}}{A_3} = -\\frac{0.4 \\times 10^{6}}{1.0 \\times 10^{6}} = -0.4\\ \\text{s}^{-1}$\n$L_{32} = -\\frac{C_{32}}{A_3} = -\\frac{0.8 \\times 10^{6}}{1.0 \\times 10^{6}} = -0.8\\ \\text{s}^{-1}$\n$L_{33} = \\frac{C_{31} + C_{32}}{A_3} = \\frac{(0.4 + 0.8) \\times 10^{6}}{1.0 \\times 10^{6}} = 1.2\\ \\text{s}^{-1}$\n\n所以，矩阵 $\\boldsymbol{L}$ 是：\n$$ \\boldsymbol{L} = \\begin{pmatrix} 0.8   -0.6   -0.2 \\\\ -0.4   \\frac{2}{3}   -\\frac{4}{15} \\\\ -0.4   -0.8   1.2 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5}   -\\frac{3}{5}   -\\frac{1}{5} \\\\ -\\frac{2}{5}   \\frac{2}{3}   -\\frac{4}{15} \\\\ -\\frac{2}{5}   -\\frac{4}{5}   \\frac{6}{5} \\end{pmatrix} $$\n为了找到特征值 $\\lambda$，我们求解特征方程 $\\det(\\boldsymbol{L} - \\lambda \\boldsymbol{I}) = 0$。注意到 $\\boldsymbol{L}$ 的每一行之和为零。这意味着 $\\lambda_1 = 0$ 是一个特征值，其对应的特征向量为 $(1, 1, 1)^{\\mathsf{T}}$。\n特征多项式是 $P(\\lambda) = -\\lambda^3 + \\text{tr}(\\boldsymbol{L})\\lambda^2 - C_2\\lambda + \\det(\\boldsymbol{L})$。由于 $\\lambda_1=0$ 是一个特征值，所以 $\\det(\\boldsymbol{L})=0$。该多项式简化为 $-\\lambda(\\lambda^2 - \\text{tr}(\\boldsymbol{L})\\lambda + C_2) = 0$。非零特征值是二次方程 $\\lambda^2 - \\text{tr}(\\boldsymbol{L})\\lambda + C_2 = 0$ 的根。\n\n$\\boldsymbol{L}$ 的迹是：\n$$ \\text{tr}(\\boldsymbol{L}) = L_{11} + L_{22} + L_{33} = \\frac{4}{5} + \\frac{2}{3} + \\frac{6}{5} = \\frac{10}{5} + \\frac{2}{3} = 2 + \\frac{2}{3} = \\frac{8}{3} $$\n系数 $C_2$ 是 $\\boldsymbol{L}$ 的主子式之和：\n$ M_{11} = L_{22}L_{33} - L_{23}L_{32} = (\\frac{2}{3})(\\frac{6}{5}) - (-\\frac{4}{15})(-\\frac{4}{5}) = \\frac{12}{15} - \\frac{16}{75} = \\frac{60-16}{75} = \\frac{44}{75} $\n$ M_{22} = L_{11}L_{33} - L_{13}L_{31} = (\\frac{4}{5})(\\frac{6}{5}) - (-\\frac{1}{5})(-\\frac{2}{5}) = \\frac{24}{25} - \\frac{2}{25} = \\frac{22}{25} $\n$ M_{33} = L_{11}L_{22} - L_{12}L_{21} = (\\frac{4}{5})(\\frac{2}{3}) - (-\\frac{3}{5})(-\\frac{2}{5}) = \\frac{8}{15} - \\frac{6}{25} = \\frac{40-18}{75} = \\frac{22}{75} $\n对子式求和：\n$$ C_2 = M_{11} + M_{22} + M_{33} = \\frac{44}{75} + \\frac{22}{25} + \\frac{22}{75} = \\frac{44 + 66 + 22}{75} = \\frac{132}{75} = \\frac{44}{25} $$\n非零特征值的二次方程是：\n$$ \\lambda^2 - \\frac{8}{3}\\lambda + \\frac{44}{25} = 0 $$\n乘以 $75$ 以消去分母：\n$$ 75\\lambda^2 - 200\\lambda + 132 = 0 $$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$ \\lambda = \\frac{200 \\pm \\sqrt{(-200)^2 - 4(75)(132)}}{2(75)} = \\frac{200 \\pm \\sqrt{40000 - 39600}}{150} = \\frac{200 \\pm \\sqrt{400}}{150} = \\frac{200 \\pm 20}{150} $$\n两个非零特征值是：\n$$ \\lambda_2 = \\frac{200 + 20}{150} = \\frac{220}{150} = \\frac{22}{15} \\approx 1.4667\\ \\text{s}^{-1} $$\n$$ \\lambda_3 = \\frac{200 - 20}{150} = \\frac{180}{150} = \\frac{18}{15} = \\frac{6}{5} = 1.2\\ \\text{s}^{-1} $$\n$\\boldsymbol{L}$ 的特征值是 $\\{0, \\frac{6}{5}, \\frac{22}{15}\\}$。代数连通度是最小的正特征值，即 $\\lambda_3 = \\frac{6}{5} = 1.2$。\n问题要求答案四舍五入到四位有效数字。\n\n代数连通度 $= 1.200\\ \\text{s}^{-1}$。",
            "answer": "$$\\boxed{1.200}$$"
        },
        {
            "introduction": "在复杂的地球系统模型中，陆面和河流演算模块通常是独立开发的，这会导致实际应用中的不一致性。本练习探讨了一个关键的现实世界问题：由于模型间对湖泊和湿地的定义不匹配而导致的水量平衡误差。您将诊断这种“消失”的水的来源和量级，并设计一个校正方案，从而强化质量守恒在气候模拟中的至高重要性。",
            "id": "4098458",
            "problem": "在一个全球数值天气预报（NWP）和气候模拟系统中，单个网格单元在其陆面模型中使用地表非均质性分块方案，并使用一个独立的河道径流模型。陆面模型将地表划分为两个地块：一个植被地块和一个湖泊-湿地地块。在陆面模型中，湖泊-湿地地块占网格单元的比例为 $f_{L}^{\\mathrm{land}} = 0.30$，植被地塊的比例为 $f_{V} = 0.70$。河道径流模型使用其自身的水体掩膜，其中连通的湖泊-水库比例为 $f_{L}^{\\mathrm{route}} = 0.20$。差值 $f_{L}^{\\mathrm{land}} - f_{L}^{\\mathrm{route}}$ 代表了陆面模型识别出但在径流网络中未表示的湖泊和湿地。\n\n考虑一个为期一个月，长度为 $T = 30$ 天的时期。在植被地块上，月平均降水量、蒸发量和陆地水储量变化分别为 $P_{V} = 110\\ \\mathrm{mm}$、$E_{V} = 70\\ \\mathrm{mm}$ 和 $\\Delta S_{V} = +5\\ \\mathrm{mm}$。在湖泊-湿地地块上，相应的值为 $P_{L} = 90\\ \\mathrm{mm}$、$E_{L} = 85\\ \\mathrm{mm}$ 和 $\\Delta S_{L} = +1\\ \\mathrm{mm}$。假设陆面模型将每个地块的月度质量平衡余项作为侧向流出量（对于植被地块是径流加下渗，对于湖泊-湿地地块是净湖泊流出量）传递给径流模型，这与在整个月内积分的水量连续性方程 $dS/dt = P - E - Q_{\\mathrm{out}}$ 一致。假设水的密度为 $\\rho_{w} = 1000\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，并忽略该月内径流模型储量的任何变化。\n\n大气-陆地系统的网格单元水量平衡要求径流模型输出的网格积分流量等于陆面模型计算的网格平均侧向流出量。然而，由于掩膜不匹配，耦合器仅在径流模型的湖泊-水库比例 $f_{L}^{\\mathrm{route}}$ 上传输湖泊流出量，而丢弃在非重叠的湖泊-湿地区域 $f_{L}^{\\mathrm{land}} - f_{L}^{\\mathrm{route}}$ 上产生的湖泊流出量。植被径流被完全传输。\n\n从基本的水质量守恒原理和所描述的掩膜叠加出发，推导由掩膜不匹配引起的月度网格平均质量不闭合量。然后，提出一种最小的、物理上一致的源汇项订正方法，该方法通过在该月内向径流模型添加一个时间上恒定的网格平均源项 $S$ 来恢复精确的网格单元水量守恒。你的提议应从第一性原理出发进行论证，并且 $S$ 的大小应通过计算得出，以使其月度时间积分能精确补偿诊断出的质量不闭合量。将 $S$ 以 $\\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$ 为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "问题要求我们量化因陆面模型和河道径流模型对地表水体的表述不一致而导致的气候模型网格单元中的水质量不闭合量，然后设计一个订正方案。该分析基于质量守恒的基本原理，特别是水量平衡方程。\n\n首先，我们确定在这一个月的时期内，两个陆面地块（植被地块和湖泊-湿地地块）各自的侧向流出量。对于一个给定的地块，在时间段 $T$ 内积分的水量平衡由下式给出：\n$$ \\Delta S = P - E - Q_{\\mathrm{out}} $$\n其中 $\\Delta S$ 是水储量的变化，$P$ 是降水量，$E$ 是蒸发量，$Q_{\\mathrm{out}}$ 是总侧向流出量（例如，径流、下渗或湖泊流出量）。所有量都表示为在 $T = 30$ 天的总时段内地块面积上的水深（单位为 $\\mathrm{mm}$）。重新整理方程以求解侧向流出量，得到：\n$$ Q_{\\mathrm{out}} = P - E - \\Delta S $$\n\n对于植被地块（$V$），其 $P_{V} = 110\\ \\mathrm{mm}$、$E_{V} = 70\\ \\mathrm{mm}$ 和 $\\Delta S_{V} = 5\\ \\mathrm{mm}$，侧向流出量为：\n$$ Q_{\\mathrm{out}, V} = P_{V} - E_{V} - \\Delta S_{V} = 110\\ \\mathrm{mm} - 70\\ \\mathrm{mm} - 5\\ \\mathrm{mm} = 35\\ \\mathrm{mm} $$\n\n对于湖泊-湿地地块（$L$），其 $P_{L} = 90\\ \\mathrm{mm}$、$E_{L} = 85\\ \\mathrm{mm}$ 和 $\\Delta S_{L} = 1\\ \\mathrm{mm}$，侧向流出量为：\n$$ Q_{\\mathrm{out}, L} = P_{L} - E_{L} - \\Delta S_{L} = 90\\ \\mathrm{mm} - 85\\ \\mathrm{mm} - 1\\ \\mathrm{mm} = 4\\ \\mathrm{mm} $$\n\n接下来，我们计算陆面模型生成的总网格平均侧向流出量 $Q_{\\mathrm{gen}}$。这是使用陆面模型的地块比例 $f_{V} = 0.70$ 和 $f_{L}^{\\mathrm{land}} = 0.30$ 对各地块流出量进行的面积加权平均。\n$$ Q_{\\mathrm{gen}} = f_{V} Q_{\\mathrm{out}, V} + f_{L}^{\\mathrm{land}} Q_{\\mathrm{out}, L} $$\n$$ Q_{\\mathrm{gen}} = (0.70)(35\\ \\mathrm{mm}) + (0.30)(4\\ \\mathrm{mm}) = 24.5\\ \\mathrm{mm} + 1.2\\ \\mathrm{mm} = 25.7\\ \\mathrm{mm} $$\n这个值代表了为确保大气-陆地系统的水量守恒，应传输到河道径流模型中的单位网格单元面积上的总水量。\n\n然而，由于掩膜不匹配，耦合器传输的水量是不同的。植被径流被完全传输，但湖泊流出量仅在河道径流模型的湖泊比例 $f_{L}^{\\mathrm{route}} = 0.20$ 上进行传输。径流模型实际接收到的网格平均流出量 $Q_{\\mathrm{rec}}$ 为：\n$$ Q_{\\mathrm{rec}} = f_{V} Q_{\\mathrm{out}, V} + f_{L}^{\\mathrm{route}} Q_{\\mathrm{out}, L} $$\n$$ Q_{\\mathrm{rec}} = (0.70)(35\\ \\mathrm{mm}) + (0.20)(4\\ \\mathrm{mm}) = 24.5\\ \\mathrm{mm} + 0.8\\ \\mathrm{mm} = 25.3\\ \\mathrm{mm} $$\n\n以水深 $\\Delta H_{\\mathrm{loss}}$ 表示的网格平均水量损失，是陆面模型生成的水量与径流模型接收的水量之差：\n$$ \\Delta H_{\\mathrm{loss}} = Q_{\\mathrm{gen}} - Q_{\\mathrm{rec}} = 25.7\\ \\mathrm{mm} - 25.3\\ \\mathrm{mm} = 0.4\\ \\mathrm{mm} $$\n这个損失是由于在湖泊-湿地地块的非重叠部分（其面积比例为 $f_{L}^{\\mathrm{land}} - f_{L}^{\\mathrm{route}}$）上产生的湖泊流出量造成的。我们可以验证这一点：\n$$ \\Delta H_{\\mathrm{loss}} = (f_{L}^{\\mathrm{land}} - f_{L}^{\\mathrm{route}}) Q_{\\mathrm{out}, L} = (0.30 - 0.20)(4\\ \\mathrm{mm}) = (0.10)(4\\ \\mathrm{mm}) = 0.4\\ \\mathrm{mm} $$\n网格平均质量不闭合量 $\\Delta m_{\\mathrm{loss}}$ 是此水深乘以水的密度 $\\rho_{w} = 1000\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$。我们必须将水深转换为米：$\\Delta H_{\\mathrm{loss}} = 0.4\\ \\mathrm{mm} = 0.4 \\times 10^{-3}\\ \\mathrm{m}$。\n$$ \\Delta m_{\\mathrm{loss}} = \\rho_{w} \\Delta H_{\\mathrm{loss}} = (1000\\ \\mathrm{kg}\\ \\mathrm{m}^{-3})(0.4 \\times 10^{-3}\\ \\mathrm{m}) = 0.4\\ \\mathrm{kg}\\ \\mathrm{m}^{-2} $$\n这是在 $T = 30$ 天的周期内，网格单元每单位面积损失的总水质量。\n\n为了恢复水量平衡，我们提出一个将此损失质量重新引入径流模型的订正方案。一种最小的、物理上一致的方法是添加一个源项 $S$，该源项在时间上恒定且在网格单元上均匀分布，其在一个月内的积分恰好等于损失的质量。设网格单元的面积为 $A$。增加的总质量为 $S \\cdot A \\cdot T$。这必须等于损失的总质量，即 $\\Delta m_{\\mathrm{loss}} \\cdot A$。\n$$ S \\cdot A \\cdot T = \\Delta m_{\\mathrm{loss}} \\cdot A $$\n求解 $S$，面积 $A$ 被约去：\n$$ S = \\frac{\\Delta m_{\\mathrm{loss}}}{T} $$\n我们必须将时间段 $T$ 用秒来表示，以获得所需的单位 $\\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$。\n$$ T = 30\\ \\mathrm{days} \\times 24\\ \\frac{\\mathrm{hours}}{\\mathrm{day}} \\times 3600\\ \\frac{\\mathrm{s}}{\\mathrm{hour}} = 2,592,000\\ \\mathrm{s} $$\n现在，我们计算源项 $S$ 的大小：\n$$ S = \\frac{0.4\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}}{2,592,000\\ \\mathrm{s}} \\approx 1.54320987... \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} $$\n将此结果四舍五入到四位有效数字，得到：\n$$ S \\approx 1.543 \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1} $$\n当这个源项被添加到径流模型中时，它确保了在一个月内进入径流模型的总水质量等于陆面模型生成的总侧向流出量，从而闭合了网格单元的水收支。",
            "answer": "$$\n\\boxed{1.543 \\times 10^{-7}}\n$$"
        }
    ]
}