## 引言
随着全球城市化进程的加速，城市对局地乃至区域天气和气候的影响日益显著。在[数值天气预报](@entry_id:191656)（NWP）和气候模型中，准确地描述这些影响至关重要。然而，城市环境具有高度复杂的空间异质性，其尺度远小于典型模型的网格分辨率，这构成了模型发展的一大挑战。城市冠层[参数化](@entry_id:265163)（Urban Canopy Parameterization, UCP）正是为了解决这一知识鸿沟而发展起来的一套理论和方法，它旨在将复杂的城市次网格效应抽象为模型可以计算的物理过程。

本文将系统性地引导读者深入理解城市冠层[参数化](@entry_id:265163)的世界。在“原理与机制”一章中，我们将剖析[参数化](@entry_id:265163)的核心物理基础，从如何处理次网格异质性，到动量、辐射和热量交换的关键机制。接着，在“应用与跨学科联系”一章中，我们将展示这些原理如何应用于解释城市热岛、改善空气质量模拟，并与城市规划、环境科学等领域交叉融合。最后，通过一系列精心设计的“动手实践”，读者将有机会将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，本文旨在为读者构建一个关于城市冠层[参数化](@entry_id:265163)从理论到应用的完整知识体系。

## 原理与机制

在数值天气预报（NWP）和气候模型中，城市冠层[参数化](@entry_id:265163)旨在表示城市地区对大气动量、热量和水分通量的独特影响。由于城市环境的几何结构、物质构成和人类活动在空间上高度异质，且其尺度远小于典型的模型网格（通常为公里级），因此必须采用[参数化](@entry_id:265163)方案来捕捉这些次网格效应。本章将深入探讨城市冠层[参数化](@entry_id:265163)的核心原理与关键机制，阐明如何将复杂的城市形态和过程转化为模型能够理解和计算的物理定律。

### 次网格异质性问题：集块法与瓦片法

数值模型中的一个网格单元可能覆盖了包含建筑物、道路、公园和水体等多种地表类型的广大区域。一个核心挑战是如何计算整个网格单元的平均地表通量。一种简单的方法是先对所有地表参数（如[反照率](@entry_id:188373)、粗糙度长度）进行面积加权平均，得到一组“有效”参数，然后用这组有效参数计算一次通量。这种方法被称为**参数集块法（parameter aggregation）**。

然而，地表与大气之间的通量[交换关系](@entry_id:136780)通常是**[非线性](@entry_id:637147)的**。例如，[感热通量](@entry_id:1131473)不仅依赖于地气温差，还与风速和地表粗糙度等参数以复杂的方式相关。根据**[詹森不等式](@entry_id:144269)（Jensen's inequality）**，对于一个[非线性](@entry_id:637147)函数 $f(x)$，其输入的[期望值](@entry_id:150961)所对应的函数值，不等于其函数值的[期望值](@entry_id:150961)，即 $f(E[x]) \neq E[f(x)]$。这意味着，先平均参数再计算通量（$\text{Flux}(\overline{\text{parameters}})$），与先为每个地表类型计算通量再对通量进行面积加权平均（$\overline{\text{Flux}(\text{parameters})}$）所得到的结果通常是不同的。后者在物理上是正确的，因为它遵循了[能量和动量守恒](@entry_id:193044)，即网格总通量应等于各部分通量之和。

为了解决这个问题，现代[参数化](@entry_id:265163)方案普遍采用**瓦片法（tiling）**或**马赛克法（mosaic approach）**。该方法将一个网格单元的地表划分为多个“瓦片”，每个瓦片代表一种均质的地表类型（如屋顶、墙壁、道路、植被等）。模型会为每个瓦片独立求解其地表能量平衡和水[平衡方程](@entry_id:172166)，计算出各自的动量、[感热和潜热通量](@entry_id:1131472)。最后，将所有瓦片的通量根据其面积分数进行加权平均，得到整个网格单元的总通量，并以此作为与大气[模型耦合](@entry_id:1128028)的下边界条件。这种方法虽然计算成本更高，但它能够更准确地表达次网格异质性的物理效应，避免了参数集块化带来的系统性偏差 。

### 城市大气的垂直结构与混合层

为了对城市冠层内的过程进行[参数化](@entry_id:265163)，首先需要理解城市上空大气的垂直分层结构。这种结构由建筑物的存在及其对气流和能量交换的影响所决定。

- **城市冠层（Urban Canopy Layer, UCL）**：这是指从地面延伸到大约平均建筑物高度 $H$ 的空间。UCL 内部的气流极其复杂，受到街道峡谷、建筑物尾流和局部环流的强烈影响。这里的[湍流](@entry_id:151300)主要由建筑物等钝体障碍物产生的**形态阻力（form drag）**和尾流所激发，属于机械生成。白天的[浮力](@entry_id:154088)效应虽然存在，但通常不是主导。莫宁-奥布霍夫[相似理论](@entry_id:262184)（Monin–Obukhov Similarity Theory, MOST）在这一层完全失效。

- **粗糙度子层（Roughness Sub-Layer, RSL）**：位于UCL之上，从 $z \approx H$ 延伸至 $z \approx 2H$ 到 $5H$ 的高度。在这一层，来自单个建筑物的尾流开始合并，但气流在水平方向上仍然不均匀，受到下方城市形态的直接影响。平均风廓线不遵循经典的对数律，MOST 理论仍然不适用。

- **[大气近地面层](@entry_id:1121210)（Atmospheric Surface Layer, ASL）**：位于 RSL 之上，这里的气流已经适应了城市作为一个整体的“粗糙表面”，[湍流通量](@entry_id:1133513)（如动量通量和热通量）随高度的变化很小，近似为常数。MOST 理论在这一层开始适用，可以用它来描述平均风速和温度的廓线。在典型的不稳定条件下，[湍动能](@entry_id:262712)（TKE）的产生主要源于平均风的**切变生成**（$P_s \approx -\overline{u'w'}\,\partial \overline{U}/\partial z$）和**[浮力](@entry_id:154088)生成**（$B \propto \overline{w'\theta'}$）。

- **[城市边界层](@entry_id:1133641)（Urban Boundary Layer, UBL）**：这是受城市下垫面影响的整个[大气边界层](@entry_id:1121182)，从地面一直延伸到边界层顶部的[逆温](@entry_id:140086)层，其高度 $z_i$ 远大于建筑物高度 $H$。UBL 包含了 UCL、RSL 和 ASL。

在[参数化](@entry_id:265163)方案中，一个关键概念是**混合高度（blending height）** $z_b$。它定义了一个高度，在此之上，由不同地表斑块（如城市街区和相邻的公园）引起的水平不均匀性已被[湍流](@entry_id:151300)充分混合，使得更高处的大气视城市为一个水平均匀的下垫面。混合高度的尺度可以通过比较水平平流和垂直[湍流混合](@entry_id:202591)的时间尺度来估算。对于一个特征水平尺度为 $L_p$ 的不均匀区域，在 $z_b$ 高度处，空气团跨越该区域的时间 $t_{\text{adv}} \sim L_p / U(z_b)$ 应约等于[湍流](@entry_id:151300)将地表信息混合到该高度的时间 $t_{\text{mix}} \sim z_b^2 / K_m(z_b)$。在中性条件下，[湍流](@entry_id:151300)涡粘性系数 $K_m(z_b) \sim \kappa u_* z_b$，由此可得 $z_b$ 的一个隐式关系：$z_b \approx \kappa^2 L_p / \ln((z_b - d)/z_0)$，其中 $u_*$ 是[摩擦速度](@entry_id:267882)，$\kappa$ 是[冯·卡门常数](@entry_id:261117)，$d$ 是零平面位移，$z_0$ 是[空气动力学](@entry_id:193011)粗糙度长度。这个高度标志着模型中从需要考虑三维细节的冠层内部到可以用一维廓线描述的近地面层之间的过渡 。

### 几何形态[参数化](@entry_id:265163)

为了在模型中描述复杂的城市形态，需要引入一系列简化的几何参数，这些参数捕捉了建筑物群体对动量和辐射传输的关键影响。

- **平面[面积分](@entry_id:275394)数（plan area fraction, $\lambda_p$）**：定义为建筑物占用的水平投影面积与地块总面积之比。它是一个无量纲的、与风向无关的量，描述了城市的建筑密度。在能量平衡模型中，$\lambda_p$ 用于划分水平表面（屋顶与地面），因为屋顶和地面的[热力学](@entry_id:172368)和辐射特性截然不同。

- **[迎风面积指数](@entry_id:1125330)（frontal area index, $\lambda_f$）**：定义为单位地块面积上，建筑物在垂直于风向的平面上的总投影面积。这个参数直接依赖于风向，是量化城市冠层对气流产生**形态阻力**的关键。在动量方程中，由建筑物引起的动量汇项通常被[参数化](@entry_id:265163)为与 $\lambda_f$ 和风速的平方成正比。

- **天空视角因子（sky view factor, $\psi_{sky}$）**：对于城市峡谷内（如街道或墙壁上）的任意一点，$\psi_{sky}$ 定义了其上半球视野中被天空所占据的比例，取值在 $0$ 到 $1$ 之间。它是一个纯粹的几何量，决定了地表与天空之间的[辐射交换](@entry_id:150522)效率。一个较低的 $\psi_{sky}$（如在深窄的街道峡谷中）意味着地表发射的大部分长波辐射会被对面的墙壁截获，导致“辐射囚禁”效应和夜间降温减缓。同时，它也决定了地表能接收到多少来自天空的散射短波辐射 。

### 关键物理过程的[参数化](@entry_id:265163)

#### 动量交换

城市冠层对气流的主要作用是吸收动量，即产生阻力。总阻力可以分解为两个部分：

1.  **[压差阻力](@entry_id:269633)（Pressure Drag）**或**形态阻力（Form Drag）**：这是由气流绕过建筑物时，在迎风面形成高压区、在背风面因流动分离形成低压区而产生的压力差所导致的。对于像建筑物这样的钝体，在城市常见的[高雷诺数流](@entry_id:1126089)态下，形态阻力是动量吸收的主要形式。
2.  **粘性阻力（Viscous Drag）**或**表面摩擦（Skin Friction）**：这是由空气粘性在建筑物表面产生的切应力所导致的。

单位地块面积上的形态阻力汇项 $S_p$ 和表面摩擦汇项 $S_v$ 可以分别用[迎风面积指数](@entry_id:1125330) $\lambda_f$ 和总湿润面积指数 $\lambda_w$（单位地块面积上的总建筑表面积）来[参数化](@entry_id:265163)：
$$
S_p \sim \frac{1}{2} \rho C_d \lambda_f U^2
$$
$$
S_v \sim \frac{1}{2} \rho C_f \lambda_w U^2
$$
其中 $C_d$ 和 $C_f$ 分别是形态[阻力系数](@entry_id:276893)和[表面摩擦系数](@entry_id:155311)。对于典型的高雷诺数钝体绕流，$C_d$ 的量级为 $1$，而 $C_f$ 则远小于 $1$。例如，对于一个 $\lambda_f = 0.15$、$\lambda_w = 4.0$ 的典型城市街区，取 $C_d = 1.2$ 和 $C_f = 0.01$，两者之比 $S_p / S_v \approx (C_d \lambda_f) / (C_f \lambda_w) = (1.2 \times 0.15) / (0.01 \times 4.0) = 4.5$。这表明形态阻力在这种情况下是表面摩擦的数倍，构成了动量汇的主要部分 。

城市冠层的整体阻力效应最终体现在对上方[大气近地面层](@entry_id:1121210)平均风廓线的影响上。在粗糙度子层之上，风速廓线可以用修正的对数律来描述：
$$
U(z) = \frac{u_*}{\kappa} \ln\left(\frac{z-d}{z_0}\right)
$$
这个公式引入了两个关键的空气动力学参数：

- **零平面位移（displacement height, $d$）**：它代表了由于建筑物的存在，动量吸收的有效层面被向上抬升的高度。物理上，它可以被理解为冠层内动量汇垂直分布的[质心](@entry_id:138352)。对于密集的城市冠层，$d$ 可以达到平均建筑物高度的 $0.7$ 到 $0.9$ 倍。
- **空气动力学粗糙度长度（aerodynamic roughness length, $z_0$）**：它是一个长度尺度，量化了地表从气流中提取动量的效率，即地表的“粗糙”程度。$z_0$ 是一个积分常数，定义为对数廓线外插至风速为零的高度与零平面位移之差，即 $U(d + z_0) = 0$。它不是任何物理障碍物的实际高度，而是综合了形态阻力和表面摩擦效应的一个[等效长度](@entry_id:264233) 。

这两个参数（$d$ 和 $z_0$）将城市冠层复杂的微观动力学效应，总结为对宏观流场的两个等效边界参数，是连接冠层内部与上方大气模型的桥梁。

#### [辐射交换](@entry_id:150522)

城市峡谷的复杂三维结构极大地改变了地表的辐射收支。与平坦地表不同，城市峡谷内的[辐射交换](@entry_id:150522)涉及**阴影遮蔽**、**多次反射**和**长波[辐射交换](@entry_id:150522)**。

一个精确的辐射传输方案需要使用**[辐射度法](@entry_id:1130526)（radiosity method）**来求解一个[封闭系统](@entry_id:139565)内的辐射平衡。对于一个由墙壁、地面和天空开口组成的峡谷，每个表面 $i$ 的[辐射度](@entry_id:156534) $J_i$（离开该表面的总[辐射通量](@entry_id:151732)）取决于其自身发射的辐射和反射的来自所有其他表面 $j$ 的入射辐射。

- **短波辐射**：峡谷表面接收的短波辐射包括三部分：被太阳直接照射的部分（受阴影影响）、来自天空的[散射辐射](@entry_id:909192)、以及来自其他峡谷表面一次和多次反射的辐射。描述这一过程需要建立并求解一个[线性方程组](@entry_id:148943)，其形式为 $\mathbf{J}^{SW} = \boldsymbol{\alpha} (\mathbf{E}^{SW}_{\text{direct}} + \mathbf{F} \mathbf{J}^{SW} + \dots)$，其中 $\mathbf{J}^{SW}$ 是各表面的短波[辐射度](@entry_id:156534)向量，$\boldsymbol{\alpha}$ 是[反照率矩阵](@entry_id:1120918)，$\mathbf{E}^{SW}_{\text{direct}}$ 是直接[日照](@entry_id:181918)向量，$\mathbf{F}$ 是视角因子矩阵。
- **长波辐射**：每个表面 $i$ 根据其温度 $T_i$ 和发射率 $\varepsilon_i$ 发射长波辐射（$\varepsilon_i \sigma T_i^4$），同时也反射来自其他表面和天空的长波辐射。长波[辐射度](@entry_id:156534)的方程形式为 $\mathbf{J}^{LW} = \boldsymbol{\varepsilon} \sigma \mathbf{T}^4 + (\mathbf{I} - \boldsymbol{\varepsilon}) (\mathbf{F} \mathbf{J}^{LW} + \dots)$。

通过求解这些方程组，可以得到每个峡谷表面（墙壁、道路）精确的[净辐射](@entry_id:1128562)值，这是驱动地表能量平衡和计算地表温度的核心变量 。

#### 热量交换与储存

城市建筑材料（如混凝土、沥青）具有巨大的热容量，能够在白天储存大量热量，并在夜间释放，这是[城市热岛效应](@entry_id:169038)的一个关键驱动因素。这一过程由材料的热力学性质决定，主要包括：

- **[热导](@entry_id:189019)率（thermal conductivity, $k$）** [$\mathrm{W\,m^{-1}\,K^{-1}}$]：衡量物质传导热量的能力。$k$ 越大，热量越容易在材料内部传递。
- **体积热容（volumetric heat capacity, $C$）** [$\mathrm{J\,m^{-3}\,K^{-1}}$]：单位体积物质温度升高 $1$ 开尔文所需吸收的热量。$C$ 越大，物质储存热量的能力越强。
- **热扩散率（thermal diffusivity, $\alpha = k/C$）** [$\mathrm{m^2\,s^{-1}}$]：衡量温度波在材料中传播的速度。

在日变化的热力强迫下，地表[温度波](@entry_id:193534)会向材料内部传播。波的振幅随深度呈指数衰减，其特征衰减深度被称为**[热穿透深度](@entry_id:150743)（thermal penetration depth）**，$\delta = \sqrt{2\alpha/\omega}$，其中 $\omega$ 是日变化的角频率。$\alpha$ 较小的材料（如沥青）具有较小的[热穿透深度](@entry_id:150743)，意味着热量更多地集中在表层附近。

地表对辐射强迫的响应由**热惯量（thermal inertia）**，即 $\sqrt{kC}$ 决定。在相同的净[辐射强迫](@entry_id:155289)下，热惯量越大的材料，其地表温度的日振幅越小，因为它们能更有效地将热量传导至内部（高 $k$）并储存起来（高 $C$）。反之，热惯量小的材料（如干沙）表面温度变化剧烈。对于相同的表面热通量强迫，沥青的表面温度振幅通常会比混凝土更大，因为混凝土具有更高的热惯量 。

在城市冠层[参数化](@entry_id:265163)中，墙壁和道路通常被模型化为一维或多层[热传导](@entry_id:143509)平板，通过求解[热传导方程](@entry_id:194763)来预报其内部温度廓线和地表温度。

### 集成模型架构及其挑战

基于上述物理过程的[参数化](@entry_id:265163)，发展出了不同复杂度的[城市冠层模型](@entry_id:1133642)架构。

- **单层[城市冠层模型](@entry_id:1133642)（Single-Layer Urban Canopy Model, SLUCM）**：这是最常见的类型。它将城市冠层简化为一个具有代表性几何形状（如无限长的街道峡谷）的单层体。模型为峡谷内的屋顶、墙壁和道路等不同“瓦片”分别求解[能量平衡方程](@entry_id:191484)，但将冠层内的空气视为一个整体，不解析其垂直变化。
- **建筑物效应[参数化](@entry_id:265163)（Building Effect Parameterization, BEP）**：这是一种多层方案，它将冠层在垂直方向上划分为多个层次。模型在每个层次上都计算建筑物的拖曳阻力以及墙壁与大气之间的热量交换，从而能够更真实地模拟冠层内部风速和温度的垂直廓线。
- **BEP + 建筑物能耗模型（BEP+BEM）**：这是最复杂的架构。它在 BEP 的基础上，为每栋建筑（或每层）耦合了一个建筑物能耗模型（BEM）。BEM 预报室内温度，并根据设定的温控策略（如[恒温器](@entry_id:143395)设置）计算供暖、通风和空调（HVAC）系统的能耗。这些系统产生的废热（**[人为热](@entry_id:200323)**）会作为热源项反馈给室外大气，从而实现了室内外环境的双向耦合 。

尽管这些模型在物理上日趋完善，但在实际应用中仍面临巨大挑战，其中最主要的是**参数可识别性（parameter identifiability）**问题。[城市冠层模型](@entry_id:1133642)包含大量不确定性参数（如[反照率](@entry_id:188373)、发射率、热容、[人为热](@entry_id:200323)排放强度等）。**可识别性**指的是，能否仅通过有限的观测数据来唯一地确定这些参数的值。

在许多情况下，不同的参数组合可能产生非常相似甚至完全相同的模型输出（如[感热通量](@entry_id:1131473)），这种现象被称为**殊途同归（equifinality）**。这主要是因为：
1. **观测不足**：通常我们只能观测到少数几个变量（如一个点的感热通量），而需要估计的参数数量远多于此。从数学上看，这导致描述模型灵敏度的[雅可比矩阵](@entry_id:178326) $J(\boldsymbol{\theta}) = \partial F/\partial \boldsymbol{\theta}$ 是[秩亏](@entry_id:754065)的，存在非零的参数扰动方向，使得模型输出不变。
2. **参数补偿**：模型中不同参数的作用可能相互补偿。例如，较低的[反照率](@entry_id:188373)（吸收更多太阳辐射）导致的地表升温，可能被较高的热容（储存更多热量）所抵消，从而产生相同的[感热通量](@entry_id:1131473)输出。

要缓解这一问题，不能仅仅依赖于缩小参数的先验范围，而必须通过增加观测信息来更好地约束模型。例如，同时观测感热通量、潜热通量、[净辐射](@entry_id:1128562)和地表温度，并在多种天气条件下（如晴天、阴天、昼夜转换）进行观测，可以暴露不同参数在不同物理过程中的独特作用，从而提高[雅可比矩阵](@entry_id:178326)的秩，增强参数的可识别性 。