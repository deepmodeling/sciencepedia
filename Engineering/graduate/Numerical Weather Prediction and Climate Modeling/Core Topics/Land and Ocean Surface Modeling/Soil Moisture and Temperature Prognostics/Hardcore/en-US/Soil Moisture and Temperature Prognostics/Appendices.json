{
    "hands_on_practices": [
        {
            "introduction": "The phase change of soil water is a crucial process in land surface and climate dynamics, significantly impacting surface energy balance, hydrology, and ecosystem functions. This exercise provides a foundational, hands-on calculation of soil freezing within a simplified control volume . By applying the first law of thermodynamics, you will partition energy removal into sensible heat to cool the soil and latent heat to drive the phase change, reinforcing the core principles of energy conservation in soil thermal models.",
            "id": "4090036",
            "problem": "A vertically homogeneous soil layer of thickness $H$ is represented in a land surface component of a numerical weather prediction and climate modeling system by a single, well-mixed control volume for temperature and phase state. The layer initially has temperature $T_0$ and volumetric liquid water content $\\theta_w$, with negligible ice content. At time $t=0$, the surface is subjected to a constant, imposed net heat flux $F$ (positive downward), and the lower boundary of the layer is thermally insulating. Assume that the layer remains well-mixed during the time interval of interest and that supercooling is negligible, so the equilibrium freezing temperature is $T_f$.\n\nUse conservation of energy for the control volume and the definition of latent heat of fusion to determine the fraction of the initial liquid water that freezes during the interval $\\Delta t$, under the following physically plausible parameter values:\n- Layer thickness $H = 0.10\\,\\mathrm{m}$\n- Initial temperature $T_0 = 0.5\\,^\\circ\\mathrm{C}$, freezing temperature $T_f = 0.0\\,^\\circ\\mathrm{C}$\n- Volumetric liquid water content $\\theta_w = 0.30$\n- Dry soil bulk density $\\rho_s = 1600\\,\\mathrm{kg\\,m^{-3}}$, dry soil specific heat $c_s = 800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- Water density $\\rho_w = 1000\\,\\mathrm{kg\\,m^{-3}}$, liquid water specific heat $c_w = 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- Latent heat of fusion of water $L_f = 3.34 \\times 10^5\\,\\mathrm{J\\,kg^{-1}}$\n- Imposed net surface heat flux $F = -50\\,\\mathrm{W\\,m^{-2}}$ (negative means upward, removing energy from the layer), applied for $\\Delta t = 3\\,\\mathrm{h}$\n\nAssume no phase-dependent change in sensible heat capacity during the latent plateau at $T_f$ and ignore any unfrozen water retention below $T_f$. State any additional assumptions you make. Express the final result as the decimal fraction of the initial liquid water that freezes (dimensionless). Round your answer to four significant figures.",
            "solution": "The problem requires determining the fraction of initial liquid water in a soil layer that freezes over a given time interval, subject to a constant upward heat flux at the surface. The solution will be based on the principle of conservation of energy applied to the soil layer, which is treated as a single, well-mixed control volume.\n\nThe energy balance involves a two-stage process. First, sensible heat must be removed from the soil layer (both the soil matrix and the liquid water) to cool it from its initial temperature, $T_0$, down to the freezing temperature, $T_f$. Second, once the layer is at the freezing point, any further removal of energy will cause the liquid water to undergo a phase change to ice, releasing latent heat of fusion.\n\nLet us define the system on a per-unit-area basis. The control volume is a soil column of thickness $H$ and unit area ($1\\,\\mathrm{m^2}$).\n\nFirst, we calculate the total energy removed from the soil layer per unit area, $Q_{total}$, over the time interval $\\Delta t$. The surface heat flux $F$ is given as the rate of energy transfer per unit area. A negative value for $F$ indicates an upward flux, meaning energy is being removed from the system.\n$$\nQ_{total} = |F| \\Delta t\n$$\nThe given values are $F = -50\\,\\mathrm{W\\,m^{-2}}$ (so $|F| = 50\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}$) and $\\Delta t = 3\\,\\mathrm{h}$. We must convert the time interval to seconds:\n$$\n\\Delta t = 3\\,\\mathrm{h} \\times \\frac{3600\\,\\mathrm{s}}{1\\,\\mathrm{h}} = 10800\\,\\mathrm{s}\n$$\nSo, the total energy removed is:\n$$\nQ_{total} = (50\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}) \\times (10800\\,\\mathrm{s}) = 540000\\,\\mathrm{J\\,m^{-2}} = 5.4 \\times 10^5\\,\\mathrm{J\\,m^{-2}}\n$$\n\nNext, we calculate the energy required to cool the entire layer from $T_0$ to $T_f$. This is the sensible heat change, $Q_{sensible}$. To do this, we first need the volumetric heat capacity, $C_{vol}$, of the bulk soil. The problem provides the dry soil bulk density $\\rho_s$ (mass of soil solids per unit total volume) and the volumetric liquid water content $\\theta_w$ (volume of water per unit total volume). The volumetric heat capacity is the sum of the capacities of the components within a unit volume:\n$$\nC_{vol} = \\rho_s c_s + \\theta_w \\rho_w c_w\n$$\nUsing the provided values:\n$\\rho_s = 1600\\,\\mathrm{kg\\,m^{-3}}$, $c_s = 800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$\\theta_w = 0.30$, $\\rho_w = 1000\\,\\mathrm{kg\\,m^{-3}}$, $c_w = 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$$\nC_{vol} = (1600\\,\\mathrm{kg\\,m^{-3}} \\times 800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) + (0.30 \\times 1000\\,\\mathrm{kg\\,m^{-3}} \\times 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})\n$$\n$$\nC_{vol} = 1280000\\,\\mathrm{J\\,m^{-3}\\,K^{-1}} + 1255800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}} = 2535800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}\n$$\nThe total sensible heat that must be removed per unit area to cool the layer of thickness $H = 0.10\\,\\mathrm{m}$ from $T_0 = 0.5\\,^\\circ\\mathrm{C}$ to $T_f = 0.0\\,^\\circ\\mathrm{C}$ is:\n$$\nQ_{sensible} = C_{vol} H (T_0 - T_f)\n$$\nThe temperature difference is $(T_0 - T_f) = 0.5\\,^\\circ\\mathrm{C} - 0.0\\,^\\circ\\mathrm{C} = 0.5\\,\\mathrm{K}$.\n$$\nQ_{sensible} = (2535800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) \\times (0.10\\,\\mathrm{m}) \\times (0.5\\,\\mathrm{K}) = 126790\\,\\mathrm{J\\,m^{-2}}\n$$\n\nThe energy remaining to cause freezing, $Q_{latent}$, is the total energy removed minus the sensible heat removed:\n$$\nQ_{latent} = Q_{total} - Q_{sensible}\n$$\n$$\nQ_{latent} = 540000\\,\\mathrm{J\\,m^{-2}} - 126790\\,\\mathrm{J\\,m^{-2}} = 413210\\,\\mathrm{J\\,m^{-2}}\n$$\nSince $Q_{latent} > 0$, there is sufficient energy removed to initiate freezing after the layer reaches $T_f$.\n\nThis latent heat removal causes a mass of ice, $m_{ice}$, to form. The relationship is given by the latent heat of fusion, $L_f$:\n$$\nQ_{latent} = m_{ice} L_f\n$$\nSolving for the mass of ice formed per unit area:\n$$\nm_{ice} = \\frac{Q_{latent}}{L_f} = \\frac{413210\\,\\mathrm{J\\,m^{-2}}}{3.34 \\times 10^5\\,\\mathrm{J\\,kg^{-1}}} \\approx 1.237156\\,\\mathrm{kg\\,m^{-2}}\n$$\n\nTo find the fraction of water that freezes, we must compare this mass to the initial mass of liquid water in the layer per unit area, $m_{w,initial}$. The initial volume of water per unit area is $\\theta_w H$.\n$$\nm_{w,initial} = \\theta_w H \\rho_w = (0.30) \\times (0.10\\,\\mathrm{m}) \\times (1000\\,\\mathrm{kg\\,m^{-3}}) = 30\\,\\mathrm{kg\\,m^{-2}}\n$$\n\nFinally, the fraction of the initial liquid water that freezes, $f_{ice}$, is the ratio of the mass of ice formed to the initial mass of water:\n$$\nf_{ice} = \\frac{m_{ice}}{m_{w,initial}}\n$$\n$$\nf_{ice} = \\frac{1.237156\\,\\mathrm{kg\\,m^{-2}}}{30\\,\\mathrm{kg\\,m^{-2}}} \\approx 0.0412385\n$$\nThe problem asks for the result to be rounded to four significant figures.\n$$\nf_{ice} \\approx 0.04124\n$$\n\nThe steps can be summarized in a single symbolic expression:\n$$\nf_{ice} = \\frac{|F| \\Delta t - (\\rho_s c_s + \\theta_w \\rho_w c_w) H (T_0 - T_f)}{L_f \\theta_w H \\rho_w}\n$$\nPlugging in all the values confirms the result. It is noted that we assume the material properties ($\\rho_s, c_s, \\rho_w, c_w, L_f$) are constant, which is a standard assumption for such problems. The problem statement's instruction to \"assume no phase-dependent change in sensible heat capacity\" justifies using the same $C_{vol}$ for the entire cooling process down to $T_f$.",
            "answer": "$$\\boxed{0.04124}$$"
        },
        {
            "introduction": "Numerical models of the Earth system constantly navigate a trade-off between physical fidelity and computational efficiency, a choice embodied in soil thermal parameterizations. This practice challenges you to compare two widely used approaches: a physically detailed multilayer conduction scheme and a computationally inexpensive force-restore model . By analytically solving for the surface temperature response in both systems, you will gain critical insight into the accuracy, limitations, and underlying assumptions of simplified models used in operational weather prediction and climate simulations.",
            "id": "4090090",
            "problem": "A bare, homogeneous soil column is represented in one dimension with depth coordinate $z \\ge 0$. The soil has constant thermal conductivity $k$, mass density $\\rho$, and specific heat capacity $c$, so the volumetric heat capacity is $\\rho c$ and the thermal diffusivity is $\\alpha = k/(\\rho c)$. The upper boundary at $z=0$ is subjected to a strong day–night cycle in surface heat flux imposed by the atmosphere, idealized as a purely sinusoidal Neumann boundary condition $q_s(t) = q_{\\mathrm{amp}} \\cos(\\omega t)$ with angular frequency $\\omega$ corresponding to a $24$-hour period. The lower boundary is sufficiently deep that the soil can be treated as semi-infinite for the diurnal cycle. Consider two soil thermal parameterizations used in Numerical Weather Prediction (NWP) and climate models:\n\n1) A multilayer conduction scheme, which in the continuum limit is governed by the one-dimensional heat diffusion equation $\\partial T / \\partial t = \\alpha \\, \\partial^2 T / \\partial z^2$ with the given flux boundary condition at $z=0$ and no heat sources in the soil. \n\n2) A simplified force–restore scheme with two prognostic temperatures: a surface (skin) temperature $T_s(t)$ associated with a thin surface layer of thickness $z_s$ (areal heat capacity $C_s = \\rho c \\, z_s$), and a bulk ground temperature $T_g(t)$ associated with an underlying layer of thickness $z_g$ (areal heat capacity $C_g = \\rho c \\, z_g$). The conductive exchange between the two layers is parameterized as a flux $F = k \\, (T_s - T_g)/L$ across an effective coupling length $L$. The force–restore ordinary differential equations are\n$$\n\\frac{d T_s}{dt} = \\frac{q_s(t)}{C_s} - \\frac{F}{C_s}, \n\\qquad\n\\frac{d T_g}{dt} = \\frac{F}{C_g}.\n$$\n\nAssume the following parameter values representative of a mineral soil under strong diurnal forcing: $k = 1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\rho c = 1.5 \\times 10^6\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$ so that $\\alpha = 1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$, $q_{\\mathrm{amp}} = 200\\,\\mathrm{W\\,m^{-2}}$, $\\omega = 2\\pi / 86400\\,\\mathrm{s^{-1}}$, $z_s = 0.05\\,\\mathrm{m}$, $z_g = 0.50\\,\\mathrm{m}$. Set the effective coupling length $L$ equal to the diurnal thermal skin depth predicted by diffusion theory, $L = \\delta = \\sqrt{2\\alpha/\\omega}$. \n\nStarting from the governing laws stated above, determine the amplitude and phase (lag relative to $q_s$) of the surface temperature response $T_s(t)$ for both schemes under steady periodic forcing. Compare the two and identify how accurate the force–restore scheme is in this case. Then, based on first principles of heat conduction and energy conservation, discuss physically realistic conditions under which the simplified force–restore approach would break down for strong day–night cycles.\n\nChoose the single best option that correctly describes the quantitative comparison and the breakdown conditions.\n\nA. In this case, the force–restore method underestimates the surface temperature amplitude by roughly $10\\%$ to $20\\%$ and underestimates the phase lag by about $5^\\circ$ to $10^\\circ$ relative to the multilayer conduction scheme; it remains accurate under soil moisture variability because the coupling adapts automatically, and only breaks down when the thermal skin depth $\\delta$ is smaller than the surface layer thickness $z_s$.\n\nB. If the effective coupling length $L$ is set equal to the diurnal skin depth $\\delta$, the force–restore method exactly reproduces both the amplitude and phase of the multilayer conduction solution for any soil properties; it only fails under very weak diurnal forcing.\n\nC. Over wet soils with large heat capacity, the force–restore method in this case underestimates the amplitude by more than $50\\%$ and introduces a phase error exceeding $90^\\circ$; breakdown occurs only for periods longer than seasonal timescales.\n\nD. For the given parameters, the force–restore method overestimates the surface temperature amplitude by about $15\\%$ and yields a phase lag that is smaller in magnitude by approximately $7^\\circ$ compared to the multilayer conduction solution; it can break down when the lower boundary condition is at a finite depth comparable to $\\delta$, when transient infiltration or drainage advects heat and alters $\\alpha$ on diurnal timescales, or when strong vertical heterogeneity or freeze–thaw processes make $k$ and $\\rho c$ highly depth- and temperature-dependent during the cycle.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. All necessary parameters and governing equations for two standard soil thermal models are provided. The values are physically realistic, and the questions posed are answerable through direct derivation from the given information. The problem is valid.\n\nThe solution will be derived in three parts:\n1.  Solving for the surface temperature response in the multilayer conduction (diffusion) scheme.\n2.  Solving for the surface temperature response in the force-restore scheme.\n3.  Comparing the quantitative results and analyzing the physical limitations of the force-restore method to evaluate the given options.\n\n**1. Multilayer Conduction Scheme (Diffusion Equation)**\n\nThe governing partial differential equation (PDE) for one-dimensional heat conduction is:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial z^2} $$\nThe surface ($z=0$) boundary condition is a prescribed heat flux:\n$$ -k \\frac{\\partial T}{\\partial z}\\bigg|_{z=0} = q_s(t) = q_{\\mathrm{amp}} \\cos(\\omega t) $$\nThe domain is semi-infinite, so the temperature perturbation must vanish as $z \\to \\infty$.\n\nWe seek a steady periodic solution. Using complex notation, let the forcing be $q_s(t) = \\text{Re}\\{q_{\\mathrm{amp}} e^{i\\omega t}\\}$ and the temperature response (ignoring the time-mean) be $T(z, t) = \\text{Re}\\{\\tilde{T}(z) e^{i\\omega t}\\}$. Substituting into the PDE gives an ordinary differential equation (ODE) for the complex amplitude $\\tilde{T}(z)$:\n$$ i\\omega \\tilde{T} = \\alpha \\frac{d^2 \\tilde{T}}{dz^2} \\implies \\frac{d^2 \\tilde{T}}{dz^2} - \\frac{i\\omega}{\\alpha} \\tilde{T} = 0 $$\nThe solution is of the form $\\tilde{T}(z) = A e^{\\lambda z} + B e^{-\\lambda z}$ where $\\lambda = \\pm\\sqrt{i\\omega/\\alpha}$. Using $\\sqrt{i} = (1+i)/\\sqrt{2}$, we get:\n$$ \\lambda = \\pm \\sqrt{\\frac{\\omega}{2\\alpha}}(1+i) = \\pm \\frac{1+i}{\\delta} $$\nwhere $\\delta = \\sqrt{2\\alpha/\\omega}$ is the thermal skin depth for the diurnal cycle. To ensure the solution remains bounded as $z \\to \\infty$, we must choose the decaying exponential, so $\\tilde{T}(z) = \\tilde{T}_s e^{-(1+i)z/\\delta}$, where $\\tilde{T}_s = \\tilde{T}(0)$ is the complex amplitude of the surface temperature.\n\nApplying the flux boundary condition in complex form:\n$$ -k \\frac{d\\tilde{T}}{dz}\\bigg|_{z=0} = q_{\\mathrm{amp}} $$\n$$ -k \\left[ \\tilde{T}_s \\left(-\\frac{1+i}{\\delta}\\right) e^{-(1+i)z/\\delta} \\right]_{z=0} = q_{\\mathrm{amp}} $$\n$$ k \\tilde{T}_s \\frac{1+i}{\\delta} = q_{\\mathrm{amp}} \\implies \\tilde{T}_s = \\frac{q_{\\mathrm{amp}} \\delta}{k(1+i)} $$\nTo find the amplitude and phase, we manipulate the complex expression:\n$$ \\tilde{T}_s = \\frac{q_{\\mathrm{amp}} \\delta}{k} \\frac{1-i}{1^2+1^2} = \\frac{q_{\\mathrm{amp}} \\delta}{2k} (1-i) $$\nThe amplitude of the surface temperature oscillation, $A_{s,diff}$, is the magnitude of $\\tilde{T}_s$:\n$$ A_{s,diff} = |\\tilde{T}_s| = \\left| \\frac{q_{\\mathrm{amp}} \\delta}{2k} (1-i) \\right| = \\frac{q_{\\mathrm{amp}} \\delta}{2k} \\sqrt{1^2+(-1)^2} = \\frac{q_{\\mathrm{amp}} \\delta}{\\sqrt{2}k} $$\nThe phase of $\\tilde{T}_s$ is $\\arg(1-i) = -\\pi/4$ radians, or $-45^\\circ$. The temperature response $T_s(t) = A_{s,diff} \\cos(\\omega t - \\pi/4)$ therefore lags the heat flux forcing $q_s(t)=q_{\\mathrm{amp}}\\cos(\\omega t)$ by a phase of $\\phi_{lag,diff} = 45^\\circ$.\n\nNumerically:\n$\\omega = 2\\pi / 86400\\,\\mathrm{s^{-1}} \\approx 7.272 \\times 10^{-5}\\,\\mathrm{rad\\,s^{-1}}$\n$\\delta = \\sqrt{2\\alpha/\\omega} = \\sqrt{2 \\times (1.0 \\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}) / (7.272 \\times 10^{-5}\\,\\mathrm{s^{-1}})} \\approx 0.1658\\,\\mathrm{m}$\n$A_{s,diff} = \\frac{(200\\,\\mathrm{W\\,m^{-2}}) \\times (0.1658\\,\\mathrm{m})}{\\sqrt{2} \\times (1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})} \\approx \\frac{33.16}{2.121} \\approx 15.63\\,\\mathrm{K}$\n\n**2. Force-Restore Scheme**\n\nThe governing ODEs in complex form are:\n$$ i\\omega \\tilde{T}_s = \\frac{q_{\\mathrm{amp}}}{C_s} - \\frac{k}{L C_s}(\\tilde{T}_s - \\tilde{T}_g) $$\n$$ i\\omega \\tilde{T}_g = \\frac{k}{L C_g}(\\tilde{T}_s - \\tilde{T}_g) $$\nFrom the second equation, we solve for $\\tilde{T}_g$:\n$$ \\tilde{T}_g \\left( i\\omega + \\frac{k}{L C_g} \\right) = \\frac{k}{L C_g} \\tilde{T}_s \\implies \\tilde{T}_g = \\frac{1}{1 + i\\omega L C_g / k} \\tilde{T}_s $$\nSubstitute this into the first equation to solve for $\\tilde{T}_s$:\n$$ i\\omega \\tilde{T}_s = \\frac{q_{\\mathrm{amp}}}{C_s} - \\frac{k}{L C_s} \\tilde{T}_s \\left( 1 - \\frac{1}{1 + i\\omega L C_g / k} \\right) $$\n$$ \\tilde{T}_s \\left( i\\omega C_s + \\frac{k}{L} \\frac{i\\omega L C_g / k}{1 + i\\omega L C_g / k} \\right) = q_{\\mathrm{amp}} $$\nThe complex amplitude of the surface temperature is $\\tilde{T}_{s,FR} = q_{\\mathrm{amp}} / Y_{FR}$, where $Y_{FR}$ is the effective thermal admittance of the force-restore system:\n$$ Y_{FR} = i\\omega C_s + \\frac{i\\omega C_g}{1 + i\\omega L C_g / k} $$\nSeparating the real and imaginary parts of $Y_{FR}$:\n$$ Y_{FR} = i\\omega C_s + \\frac{i\\omega C_g (1 - i\\omega L C_g / k)}{1 + (\\omega L C_g / k)^2} = \\frac{\\omega^2 L C_g^2/k}{1 + (\\omega L C_g / k)^2} + i\\omega \\left( C_s + \\frac{C_g}{1 + (\\omega L C_g / k)^2} \\right) $$\n\nNumerically:\n$C_s = \\rho c \\, z_s = (1.5 \\times 10^6\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) \\times (0.05\\,\\mathrm{m}) = 7.5 \\times 10^4\\,\\mathrm{J\\,m^{-2}\\,K^{-1}}$\n$C_g = \\rho c \\, z_g = (1.5 \\times 10^6\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) \\times (0.50\\,\\mathrm{m}) = 7.5 \\times 10^5\\,\\mathrm{J\\,m^{-2}\\,K^{-1}}$\n$L = \\delta \\approx 0.1658\\,\\mathrm{m}$\nLet's compute the dimensionless group $\\gamma = \\omega L C_g / k$:\n$$ \\gamma = \\frac{(7.272 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times (0.1658\\,\\mathrm{m}) \\times (7.5 \\times 10^5\\,\\mathrm{J\\,m^{-2}\\,K^{-1}})}{1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} \\approx 6.033 $$\nNow compute the real and imaginary parts of $Y_{FR}$:\n$$ \\text{Re}(Y_{FR}) = \\frac{\\omega C_g \\gamma}{1+\\gamma^2} = \\frac{(7.272\\times 10^{-5})(7.5\\times 10^5)(6.033)}{1+6.033^2} \\approx \\frac{329.0}{37.4} \\approx 8.796\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\n$$ \\text{Im}(Y_{FR}) = \\omega C_s + \\frac{\\omega C_g}{1+\\gamma^2} = (7.272\\times 10^{-5})(7.5\\times 10^4) + \\frac{(7.272\\times 10^{-5})(7.5\\times 10^5)}{1+6.033^2} \\approx 5.454 + 1.458 \\approx 6.912\\,\\mathrm{W\\,m^{-2}\\,K^{-1}} $$\nSo, $Y_{FR} \\approx 8.796 + 6.912i$.\nThe amplitude $A_{s,FR} = |\\tilde{T}_{s,FR}|$ is:\n$$ A_{s,FR} = \\frac{q_{\\mathrm{amp}}}{|Y_{FR}|} = \\frac{200}{\\sqrt{8.796^2 + 6.912^2}} = \\frac{200}{\\sqrt{77.37 + 47.78}} = \\frac{200}{\\sqrt{125.15}} \\approx \\frac{200}{11.187} \\approx 17.88\\,\\mathrm{K} $$\nThe phase lag is given by the argument of $Y_{FR}$:\n$$ \\phi_{lag,FR} = \\arg(Y_{FR}) = \\arctan\\left(\\frac{\\text{Im}(Y_{FR})}{\\text{Re}(Y_{FR})}\\right) = \\arctan\\left(\\frac{6.912}{8.796}\\right) \\approx \\arctan(0.7858) \\approx 38.16^\\circ $$\n\n**3. Comparison and Analysis**\n\n| Scheme                  | Amplitude ($K$) | Phase Lag (degrees) |\n|-------------------------|-----------------|---------------------|\n| Multilayer (Diffusion)  | $15.63$         | $45.0^\\circ$         |\n| Force-Restore           | $17.88$         | $38.16^\\circ$       |\n\n- **Amplitude Comparison**: The force-restore method overestimates the amplitude. The relative error is $(17.88 - 15.63) / 15.63 \\approx 0.144$, or about a $14.4\\%$ overestimation. This is approximately $15\\%$.\n- **Phase Lag Comparison**: The force-restore method produces a smaller phase lag. The difference is $45^\\circ - 38.16^\\circ = 6.84^\\circ$. The phase lag is smaller by approximately $7^\\circ$.\n\nThe force-restore model is a significant simplification of the continuous physics of heat diffusion. Its accuracy breaks down under several physically realistic conditions not captured by its two-layer, constant-coefficient, conductive-only framework:\n1.  **Heterogeneity and Non-linearity**: Real soil properties ($k$, $\\rho c$) are not constant. They vary strongly with depth (due to texture and compaction changes) and with temperature, especially during **freeze-thaw cycles** where the large latent heat of fusion of water dramatically alters the apparent heat capacity. The force-restore model with constant parameters cannot represent such effects.\n2.  **Lower Boundary Effects**: The model's \"deep\" layer ($T_g$) is a crude representation of the semi-infinite medium. If the actual soil column has a finite depth (e.g., bedrock) comparable to the thermal skin depth $\\delta$, reflections of the thermal wave from this boundary will alter the surface temperature response in a way not captured by the force-restore parameterization.\n3.  **Advective and Transient Processes**: The model assumes heat transfer is by conduction only. However, **transient infiltration** of rainwater or drainage of soil moisture advects heat vertically, which can be a dominant short-term process. Furthermore, these moisture changes drastically alter the soil thermal properties ($k$ and $\\rho c$ both increase with moisture, changing $\\alpha$) on timescales comparable to the diurnal cycle, violating the constant-parameter assumption.\n\n**Evaluation of Options:**\n\n*   **A**: Incorrect. It claims the method *underestimates* the amplitude, which is contrary to our finding. It also makes the physically incorrect claim that the model adapts to soil moisture variability and gives an overly restrictive breakdown condition.\n*   **B**: Incorrect. It falsely claims the method \"exactly reproduces\" the diffusion solution. Our calculation shows significant differences in both amplitude and phase. The method's accuracy is parameter-dependent.\n*   **C**: Incorrect. It claims the method *underestimates* the amplitude by more than $50\\%$, and that the phase error exceeds $90^\\circ$. Both are contrary to our calculations.\n*   **D**: Correct. The quantitative comparisons match our results: an overestimation of the amplitude by \"about 15%\" (we found $14.4\\%$) and a phase lag that is \"smaller in magnitude by approximately 7°\" (we found $6.84^\\circ$). The listed breakdown conditions (finite depth, transient moisture/advection, and heterogeneity/freeze-thaw) are all physically valid and represent key limitations of the simplified force-restore approach.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "Moving from theory to practice, this exercise guides you through the process of building a simple numerical soil model from the ground up, a capstone skill for any modeler. You will discretize the coupled partial differential equations for heat and moisture transport using a finite-volume approach and implement a stable, implicit time-stepping scheme . This comprehensive practice synthesizes concepts of mass and energy conservation, numerical methods, and boundary conditions into a tangible, working code.",
            "id": "4090020",
            "problem": "A one-dimensional vertical soil column is considered for prognostic simulation of soil volumetric water content and temperature within the framework of Numerical Weather Prediction (NWP) and climate modeling. The vertical coordinate is denoted by $z$ and increases downward from the surface, with domain $z \\in [0,H]$. Let the column be discretized into $N$ uniformly spaced finite-volume cells of thickness $\\Delta z = H/N$, with cell-centered unknowns indexed by $i \\in \\{1,\\dots,N\\}$ located at depths $z_i = (i - 1/2)\\Delta z$. Time is discretized with uniform time step $\\Delta t$ and integer steps $n \\in \\{0,1,2,\\dots\\}$.\n\nThe prognostic variables are the volumetric soil water content $\\,\\theta(z,t)$ (dimensionless, $\\mathrm{m^3/m^3}$) and the soil temperature $\\,T(z,t)$ (Kelvin, $\\mathrm{K}$). The fundamental base for modeling consists of:\n- Mass conservation of water: for a control volume, the rate of change of $\\,\\theta$ equals the divergence of water fluxes.\n- Energy conservation: for a control volume, the rate of change of internal energy equals the divergence of heat fluxes.\n- Fick’s law of diffusion for water: the diffusive water flux is $\\,F_\\theta = -D\\,\\partial \\theta/\\partial z$, where $\\,D$ is an effective diffusivity (assumed constant and spatially uniform).\n- Fourier’s law of heat conduction: the conductive heat flux is $\\,F_T = -k\\,\\partial T/\\partial z$, where $\\,k$ is thermal conductivity.\n\nAssume the following boundary conditions at the surface $z=0$ and at the bottom $z=H$:\n- Water flux boundary conditions: at the surface, a specified infiltration (positive downward) or evaporation (negative upward) flux $\\,q_{\\text{in}}$ (units $\\mathrm{m\\,s^{-1}}$) is imposed, i.e., $\\,F_\\theta(0,t) = q_{\\text{in}}$; at the bottom, no water flux, i.e., $\\,F_\\theta(H,t) = 0$.\n- Heat flux boundary conditions: at the surface, a specified net downward heat flux $\\,Q_{\\text{surf}}$ (units $\\mathrm{W\\,m^{-2}}$) is imposed in the conductive boundary condition $\\,F_T(0,t) = Q_{\\text{surf}}$; at the bottom, insulated, i.e., $\\,F_T(H,t) = 0$.\n\nLet the volumetric heat capacity be constant $\\,c_v$ (units $\\mathrm{J\\,m^{-3}\\,K^{-1}}$). To include moisture dependence in thermal conduction without introducing nonlinearity, define the soil thermal conductivity during each time step to be spatially uniform and dependent on the column-mean water content at the new time, namely\n$$\nk^{n+1} = k_{\\text{dry}} + c_k\\,\\bar{\\theta}^{\\,n+1}, \\quad \\text{where} \\quad \\bar{\\theta}^{\\,n+1} = \\frac{1}{N}\\sum_{i=1}^N \\theta_i^{\\,n+1}.\n$$\n\nStarting from the above conservation statements and constitutive laws, derive a finite-volume spatial discretization with cell-centered unknowns and face-centered diffusive fluxes. Use backward (implicit) Euler time stepping. The discrete water content update in cell $i$ must follow the generic finite-volume balance\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left(F_{\\theta,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1}\\right),\n$$\nwhere internal diffusive fluxes use centered differences and boundary fluxes use the specified values. The discrete temperature update must follow\n$$\nc_v\\left(T_i^{\\,n+1} - T_i^{\\,n}\\right) = \\frac{\\Delta t}{\\Delta z}\\left(F_{T,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{T,\\,i+\\frac{1}{2}}^{\\,n+1}\\right),\n$$\nwhere internal heat fluxes use centered differences and boundary fluxes use the specified values, and $\\,k^{n+1}$ is computed from the updated water content field at time $n+1$.\n\nImplement operator splitting at each time step: first update $\\,\\theta^{\\,n+1}$ implicitly, then compute $\\,k^{\\,n+1}$ from the updated $\\,\\bar{\\theta}^{\\,n+1}$, and finally update $\\,T^{\\,n+1}$ implicitly using $\\,k^{\\,n+1}$ in that step.\n\nInitialization: set $\\,\\theta_i^{\\,0} = \\theta_0$ and $\\,T_i^{\\,0} = T_0$ for all cells $i$. All parameters are constant in time and uniform in space unless stated otherwise. Use the following test suite with $\\,H$, $\\,N$, $\\,\\Delta t$, number of time steps $\\,M$, $\\,D$, $\\,q_{\\text{in}}$, $\\,c_v$, $\\,k_{\\text{dry}}$, $\\,c_k$, $\\,Q_{\\text{surf}}$, $\\,\\theta_0$, and $\\,T_0$ specified. All quantities are in the International System of Units (SI), with $\\,\\theta$ expressed as $\\mathrm{m^3/m^3}$ and $\\,T$ expressed in $\\mathrm{K}$.\n\nTest suite parameters:\n- Case $\\,A$ (general scenario): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 10$, $\\,\\Delta t = 3600\\,\\mathrm{s}$, $\\,M = 24$, $\\,D = 1.0\\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = 1.0\\times 10^{-7}\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = 50.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.25\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 285.0\\,\\mathrm{K}$.\n- Case $\\,B$ (evaporation and cooling edge): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 8$, $\\,\\Delta t = 3600\\,\\mathrm{s}$, $\\,M = 48$, $\\,D = 1.0\\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = -5.0\\times 10^{-8}\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = -20.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.22\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 290.0\\,\\mathrm{K}$.\n- Case $\\,C$ (no-flux consistency check): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 20$, $\\,\\Delta t = 7200\\,\\mathrm{s}$, $\\,M = 12$, $\\,D = 5.0\\times 10^{-7}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = 0.0\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = 0.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.25\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 285.0\\,\\mathrm{K}$.\n\nFor each case, after evolving for $\\,M$ steps, report the following outputs:\n- The column-mean soil water content $\\,\\bar{\\theta}^{\\,M}$ (units $\\mathrm{m^3/m^3}$) as a float rounded to six decimal places.\n- The top-layer soil temperature $\\,T_1^{\\,M}$ (units $\\mathrm{K}$) as a float rounded to six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is itself a list of two floats in the order $[\\bar{\\theta}^{\\,M}, T_1^{\\,M}]$, for the three cases $A$, $B$, and $C$, respectively. For example, the output format must be exactly like $[[x_A,y_A],[x_B,y_B],[x_C,y_C]]$ with no spaces and with each float rounded to six decimal places. Ensure all computations internally respect SI units and that the reported outputs are in $\\mathrm{m^3/m^3}$ for $\\,\\bar{\\theta}^{\\,M}$ and $\\mathrm{K}$ for $\\,T_1^{\\,M}$.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of heat and mass transfer, mathematically well-posed, and described with objective, formal language. All necessary parameters and conditions for a unique numerical solution are provided. We proceed with the derivation and implementation of the numerical scheme.\n\nThe problem requires an operator-splitting approach where the soil volumetric water content, $\\theta$, and the soil temperature, $T$, are updated sequentially at each time step. Both updates involve solving a one-dimensional diffusion-type equation using a finite-volume method with an implicit (backward Euler) time-stepping scheme.\n\n### Part 1: Discretization of the Water Content Equation\n\nThe governing partial differential equation for water transport, combining mass conservation and Fick's law, is:\n$$\n\\frac{\\partial \\theta}{\\partial t} = -\\frac{\\partial F_\\theta}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(D \\frac{\\partial \\theta}{\\partial z}\\right)\n$$\nSince the diffusivity $D$ is constant, this simplifies to the standard diffusion equation:\n$$\n\\frac{\\partial \\theta}{\\partial t} = D \\frac{\\partial^2 \\theta}{\\partial z^2}\n$$\nThe problem specifies a finite-volume discretization for a cell $i$:\n$$\n\\frac{\\theta_i^{\\,n+1} - \\theta_i^{\\,n}}{\\Delta t} = \\frac{1}{\\Delta z}\\left(F_{\\theta,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1}\\right)\n$$\nwhere fluxes are evaluated at the new time step $n+1$ due to the implicit scheme. The internal fluxes are approximated using centered differences between adjacent cell centers:\n$$\nF_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1} = -D \\frac{\\theta_{i+1}^{n+1} - \\theta_i^{n+1}}{\\Delta z}\n$$\nSubstituting this into the finite-volume equation for an internal cell ($i \\in \\{2, \\dots, N-1\\}$) yields:\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( \\left(-D \\frac{\\theta_i^{n+1} - \\theta_{i-1}^{n+1}}{\\Delta z}\\right) - \\left(-D \\frac{\\theta_{i+1}^{n+1} - \\theta_i^{n+1}}{\\Delta z}\\right) \\right)\n$$\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{D \\Delta t}{(\\Delta z)^2} \\left( \\theta_{i-1}^{n+1} - 2\\theta_i^{n+1} + \\theta_{i+1}^{n+1} \\right)\n$$\nLet's define the dimensionless diffusion number for water content as $\\alpha_\\theta = \\frac{D \\Delta t}{(\\Delta z)^2}$. Rearranging the terms to place all unknowns at time $n+1$ on the left-hand side gives the equation for internal cells:\n$$\n-\\alpha_\\theta \\theta_{i-1}^{n+1} + (1 + 2\\alpha_\\theta)\\theta_i^{n+1} - \\alpha_\\theta \\theta_{i+1}^{n+1} = \\theta_i^n\n$$\nFor the boundary cells, we incorporate the specified fluxes:\nFor the top cell ($i=1$): The flux at face $i-\\frac{1}{2}=1/2$ is the specified surface flux, $F_{\\theta,\\,1/2}^{\\,n+1} = q_{\\text{in}}$.\n$$\n\\theta_1^{\\,n+1} - \\theta_1^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( q_{\\text{in}} - \\left(-D \\frac{\\theta_2^{n+1} - \\theta_1^{n+1}}{\\Delta z}\\right) \\right)\n$$\nRearranging gives:\n$$\n\\theta_1^{\\,n+1} - \\alpha_\\theta(\\theta_2^{n+1} - \\theta_1^{n+1}) = \\theta_1^n + \\frac{q_{\\text{in}} \\Delta t}{\\Delta z}\n$$\n$$\n(1 + \\alpha_\\theta)\\theta_1^{n+1} - \\alpha_\\theta \\theta_2^{n+1} = \\theta_1^n + \\frac{q_{\\text{in}} \\Delta t}{\\Delta z}\n$$\nFor the bottom cell ($i=N$): The flux at face $i+\\frac{1}{2}=N+1/2$ is specified as zero, $F_{\\theta,\\,N+1/2}^{\\,n+1} = 0$.\n$$\n\\theta_N^{\\,n+1} - \\theta_N^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( \\left(-D \\frac{\\theta_N^{n+1} - \\theta_{N-1}^{n+1}}{\\Delta z}\\right) - 0 \\right)\n$$\nRearranging gives:\n$$\n\\theta_N^{\\,n+1} + \\alpha_\\theta(\\theta_N^{n+1} - \\theta_{N-1}^{n+1}) = \\theta_N^n\n$$\n$$\n-\\alpha_\\theta \\theta_{N-1}^{n+1} + (1 + \\alpha_\\theta)\\theta_N^{n+1} = \\theta_N^n\n$$\nThese $N$ linear equations form a tridiagonal system $A_\\theta \\boldsymbol{\\theta}^{n+1} = \\mathbf{b}_\\theta$, which can be solved efficiently to find the updated water content profile $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]^T$.\n\n### Part 2: Update of Soil Thermal Conductivity\n\nFollowing the operator splitting procedure, once $\\boldsymbol{\\theta}^{n+1}$ is computed, the soil thermal conductivity for the current time step, $k^{n+1}$, is calculated. It depends on the column-mean water content at the new time step:\n$$\n\\bar{\\theta}^{\\,n+1} = \\frac{1}{N}\\sum_{i=1}^N \\theta_i^{\\,n+1}\n$$\n$$\nk^{n+1} = k_{\\text{dry}} + c_k\\,\\bar{\\theta}^{\\,n+1}\n$$\nThis value of $k^{n+1}$ is treated as a constant scalar for the subsequent temperature update.\n\n### Part 3: Discretization of the Temperature Equation\n\nThe governing equation for heat transfer, combining energy conservation and Fourier's law with constant volumetric heat capacity $c_v$, is:\n$$\nc_v \\frac{\\partial T}{\\partial t} = -\\frac{\\partial F_T}{\\partial z} = \\frac{\\partial}{\\partial z}\\left( k \\frac{\\partial T}{\\partial z} \\right)\n$$\nUsing the just-computed $k^{n+1}$ (constant in space for this step), we get:\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k^{n+1}}{c_v} \\frac{\\partial^2 T}{\\partial z^2}\n$$\nThe finite-volume discretization is analogous to that for water content:\n$$\nc_v(T_i^{\\,n+1} - T_i^{\\,n}) = \\frac{\\Delta t}{\\Delta z}\\left(F_{T,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{T,\\,i+\\frac{1}{2}}^{\\,n+1}\\right)\n$$\nThe structure is identical to the water equation, with thermal diffusivity $\\kappa^{n+1} = k^{n+1}/c_v$. We define a thermal diffusion number $\\alpha_T^{n+1} = \\frac{k^{n+1} \\Delta t}{c_v (\\Delta z)^2}$. The discrete equations are:\nFor internal cells ($i \\in \\{2, \\dots, N-1\\}$):\n$$\n-\\alpha_T^{n+1} T_{i-1}^{n+1} + (1 + 2\\alpha_T^{n+1})T_i^{n+1} - \\alpha_T^{n+1} T_{i+1}^{n+1} = T_i^n\n$$\nFor the top cell ($i=1$), with surface heat flux $F_{T,\\,1/2}^{\\,n+1} = Q_{\\text{surf}}$:\n$$\n(1 + \\alpha_T^{n+1})T_1^{n+1} - \\alpha_T^{n+1} T_2^{n+1} = T_1^n + \\frac{Q_{\\text{surf}} \\Delta t}{c_v \\Delta z}\n$$\nFor the bottom cell ($i=N$), with zero bottom heat flux:\n$$\n-\\alpha_T^{n+1} T_{N-1}^{n+1} + (1 + \\alpha_T^{n+1})T_N^{n+1} = T_N^n\n$$\nThis again forms a tridiagonal system $A_T \\mathbf{T}^{n+1} = \\mathbf{b}_T$, which is solved for the updated temperature profile $\\mathbf{T}^{n+1} = [T_1^{n+1}, \\dots, T_N^{n+1}]^T$.\n\n### Algorithm Summary\nFor each time step from $n=0$ to $M-1$:\n1.  **Water Content Update**:\n    a. Construct the tridiagonal matrix $A_\\theta$ and right-hand-side vector $\\mathbf{b}_\\theta$ using the values of $\\boldsymbol{\\theta}^n$ from the previous step.\n    b. Solve the linear system $A_\\theta \\boldsymbol{\\theta}^{n+1} = \\mathbf{b}_\\theta$ for $\\boldsymbol{\\theta}^{n+1}$.\n2.  **Thermal Conductivity Update**:\n    a. Compute the mean water content $\\bar{\\theta}^{n+1}$ from $\\boldsymbol{\\theta}^{n+1}$.\n    b. Compute the thermal conductivity $k^{n+1} = k_{\\text{dry}} + c_k \\bar{\\theta}^{n+1}$.\n3.  **Temperature Update**:\n    a. Construct the tridiagonal matrix $A_T$ and right-hand-side vector $\\mathbf{b}_T$ using the values of $\\mathbf{T}^n$ and the newly computed $k^{n+1}$.\n    b. Solve the linear system $A_T \\mathbf{T}^{n+1} = \\mathbf{b}_T$ for $\\mathbf{T}^{n+1}$.\n4.  Set $\\boldsymbol{\\theta}^n \\leftarrow \\boldsymbol{\\theta}^{n+1}$ and $\\mathbf{T}^n \\leftarrow \\mathbf{T}^{n+1}$ for the next iteration.\n\nThis procedure is repeated for $M$ time steps. The final required outputs are $\\bar{\\theta}^M$ and $T_1^M$. The implementation will use `scipy.linalg.solve_banded` for efficiently solving the tridiagonal systems.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the soil moisture and temperature prognostics problem for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'H': 1.0, 'N': 10, 'dt': 3600.0, 'M': 24, 'D': 1.0e-6, 'q_in': 1.0e-7,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': 50.0, 'theta0': 0.25, 'T0': 285.0},\n        # Case B\n        {'H': 1.0, 'N': 8, 'dt': 3600.0, 'M': 48, 'D': 1.0e-6, 'q_in': -5.0e-8,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': -20.0, 'theta0': 0.22, 'T0': 290.0},\n        # Case C\n        {'H': 1.0, 'N': 20, 'dt': 7200.0, 'M': 12, 'D': 5.0e-7, 'q_in': 0.0,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': 0.0, 'theta0': 0.25, 'T0': 285.0},\n    ]\n\n    final_results = []\n\n    for params in test_cases:\n        # Unpack parameters\n        H = params['H']\n        N = params['N']\n        dt = params['dt']\n        M = params['M']\n        D = params['D']\n        q_in = params['q_in']\n        c_v = params['c_v']\n        k_dry = params['k_dry']\n        c_k = params['c_k']\n        Q_surf = params['Q_surf']\n        theta0 = params['theta0']\n        T0 = params['T0']\n\n        # Discretization parameters\n        dz = H / N\n\n        # Initialize state vectors\n        theta = np.full(N, theta0)\n        T = np.full(N, T0)\n\n        # Pre-calculate alpha for water content (constant in time)\n        alpha_theta = D * dt / (dz**2)\n\n        # --- Time-stepping loop ---\n        for _ in range(M):\n            # === 1. Update water content theta ===\n            # Setup tridiagonal system for theta: A_theta * theta_new = b_theta\n            \n            # Banded matrix for A_theta (l=1, u=1)\n            # The format for solve_banded is a (l+u+1, N) array. Here (3, N)\n            \n            A_theta_banded = np.zeros((3, N))\n            # Main diagonal\n            A_theta_banded[1, :] = 1.0 + 2.0 * alpha_theta\n            A_theta_banded[1, 0] = 1.0 + alpha_theta\n            A_theta_banded[1, -1] = 1.0 + alpha_theta\n            # Upper diagonal\n            A_theta_banded[0, 1:] = -alpha_theta\n            # Lower diagonal\n            A_theta_banded[2, :-1] = -alpha_theta\n\n            # RHS vector b_theta\n            b_theta = np.copy(theta)\n            b_theta[0] += q_in * dt / dz\n\n            # Solve for new theta\n            theta = solve_banded((1, 1), A_theta_banded, b_theta)\n\n            # === 2. Update thermal conductivity k ===\n            theta_mean = np.mean(theta)\n            k_new = k_dry + c_k * theta_mean\n\n            # === 3. Update temperature T ===\n            # Calculate alpha for temperature (changes with k_new)\n            alpha_T = k_new * dt / (c_v * dz**2)\n\n            # Setup tridiagonal system for T: A_T * T_new = b_T\n            A_T_banded = np.zeros((3, N))\n            # Main diagonal\n            A_T_banded[1, :] = 1.0 + 2.0 * alpha_T\n            A_T_banded[1, 0] = 1.0 + alpha_T\n            A_T_banded[1, -1] = 1.0 + alpha_T\n            # Upper diagonal\n            A_T_banded[0, 1:] = -alpha_T\n            # Lower diagonal\n            A_T_banded[2, :-1] = -alpha_T\n\n            # RHS vector b_T\n            b_T = np.copy(T)\n            b_T[0] += Q_surf * dt / (c_v * dz)\n\n            # Solve for new T\n            T = solve_banded((1, 1), A_T_banded, b_T)\n\n        # Store final results for the case\n        final_theta_mean = np.mean(theta)\n        final_T1 = T[0]\n        final_results.append([round(final_theta_mean, 6), round(final_T1, 6)])\n\n    # Format the final output string exactly as required\n    output_str = f\"[[{final_results[0][0]:.6f},{final_results[0][1]:.6f}],[{final_results[1][0]:.6f},{final_results[1][1]:.6f}],[{final_results[2][0]:.6f},{final_results[2][1]:.6f}]]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}