## 引言
在数值天气预报和气候模拟领域，对模型输出进行严谨的评估是推动科学进步和提升业务预报能力的核心环节。其中，针对“是/否”型二元事件（如某地是否发生暴雨）的[预报检验](@entry_id:1125232)，即[分类检验](@entry_id:1122129)，是一套基础而强大的评估工具。然而，诸如“准确率”等简单指标在面对极端天气等稀有事件时，往往会产生误导性结论，无法真实反映模型预报我们最关心事件的实际技巧。这便凸显了发展和应用“公平”技巧评分的必要性，它能够有效区分出预报系统超越纯粹机遇的真实能力。

本文将系统性地引导您深入[分类检验](@entry_id:1122129)的世界，并以[公平威胁评分](@entry_id:1124616)（Equitable Threat Score, ETS）为核心，全面揭示其背后的统计学原理与实践价值。通过学习，您将能够：

在“原理与机制”一章中，从构建[2x2列联表](@entry_id:910604)开始，逐步掌握探测概率（POD）、频率偏差（Bias）等基础诊断工具，并深入理解ETS如何通过校正机遇命中来实现其“公平性”。

在“应用与跨学科联系”一章中，探索ETS在[数值天气预报](@entry_id:191656)（NWP）评估、[模型诊断](@entry_id:136895)与改进、连接概率预报与确定性决策，以及气候科学研究等真实场景中的广泛应用。

最后，在“动手实践”部分，通过具体问题演练，巩固您对ETS计算、比较和解读的能力。

现在，让我们从[分类检验](@entry_id:1122129)最基本的构建模块——[列联表](@entry_id:164487)出发，开启对预报技巧进行科学、客观度量的探索之旅。

## 原理与机制

在[数值天气预报](@entry_id:191656)和气候模型的评估中，对预报结果进行系统性的检验是至关重要的一步。本章将深入探讨二元事件（dichotomous event）的[分类检验](@entry_id:1122129)（categorical verification）方法。我们将从构建检验基础的[列联表](@entry_id:164487)开始，逐步引入一系列诊断评分，并重点阐述[公平威胁评分](@entry_id:1124616)（Equitable Threat Score, ETS）的原理、构建及其在评估模型表现时的优越性。我们的目标是不仅理解如何计算这些评分，更要深刻把握其背后的统计学原理和适用场景。

### [分类检验](@entry_id:1122129)的基础：[2x2列联表](@entry_id:910604)

当我们处理一个二元事件，即事件只有“发生”或“未发生”两种可能结果时（例如，某地日降水量是否超过50毫米），最基本的检验工具是 **[2x2列联表](@entry_id:910604)** (2x2 contingency table)。这个表格通过将预报结果与观测事实进行配对，将所有样本点归入四个[互斥](@entry_id:752349)的类别中。

假设我们有 $N$ 个独立的预报-观测配对，标准的[2x2列联表](@entry_id:910604)结构如下：

| | 观测发生 | 观测未发生 |
| :--- | :---: | :---: |
| **预报发生** | 命中 ($H$) | 空报 ($F$) |
| **预报未发生** | 漏报 ($M$) | 正确否定 ($C$) |

这四个基本计数定义如下 ：
- **命中 (Hits, $H$)**: 预报事件会发生，且事件确实发生了。
- **漏报 (Misses, $M$)**: 预报事件不会发生，但事件实际上发生了。
- **空报 (False Alarms, $F$)**: 预报事件会发生，但事件实际上并未发生。
- **正确否定 (Correct Negatives, $C$)**: 预报事件不会发生，且事件确实未发生。

这四个计数的总和等于总样本数：$N = H + M + F + C$。

从统计学的角度看，将所有样本聚合到这个单一的[列联表](@entry_id:164487)中，隐含了一个重要的假设：即这 $N$ 个预报-观测对是**[独立同分布](@entry_id:169067) (independent and identically distributed, IID)** 的。这意味着每个配对都来自一个固定的、不随时间或空间变化的四元[联合概率分布](@entry_id:171550)。在该假设下，$(H, M, F, C)$ 这组计数构成了对该联合概率分布的**充分统计量 (sufficient statistic)**。这意味着这四个数字包含了样本中关于估计任何基于该分布的检验评分（如ETS）的全部信息。反之，如果数据存在异质性（例如，在不同气候区域，事件的基础概率不同）或序列相关性，那么简单地将所有数据汇总到一张总表中可能会丢失关键信息，甚至导致误导性结论 。

### 基础诊断评分

基于[列联表](@entry_id:164487)，我们可以计算一系列基础评分，它们从不同侧面描述了预报系统的性能。

#### 探测概率 (Probability of Detection, POD)

**探测概率 (POD)**，也称为[命中率](@entry_id:903214) (Hit Rate)，其定义为：
$$ \mathrm{POD} = \frac{H}{H+M} $$
从[条件概率](@entry_id:151013)的角度看，POD等于“在事件确实发生的条件下，预报也成功的概率”，即 $P(\text{预报发生} | \text{观测发生})$ 。POD的取值范围为0到1，值越接近1，表明预报系统捕捉实际发生事件的能力越强。然而，POD有一个显著的弱点：它完全不考虑空报。一个极端倾向于预报事件发生的系统（例如，总是预报“发生”）可以轻易获得完美的POD（值为$1$），但这显然不是一个有技巧的预报，因为它会产生大量的空报。

#### 频率偏差 (Frequency Bias)

为了量化预报系统在预报事件频率上的系统性偏差，我们引入**频率偏差 (Frequency Bias)**，通常记为 $B$：
$$ B = \frac{H+F}{H+M} $$
这个比率代表了“预报事件的总次数”与“观测事件的总次数”之比。它也等于预报事件基础频率 $p_f = (H+F)/N$ 与观测事件基础频率 $p_o = (H+M)/N$ 之比 。
- $B > 1$ 表示系统倾向于**过度预报 (overforecasting)**，即预报事件的频率高于实际发生的频率。
- $B  1$ 表示系统倾向于**预报不足 (underforecasting)**。
- $B = 1$ 表示预报在频率上是**无偏的 (unbiased)**。

需要强调的是，$B=1$ 仅表示频率偏差为零，**不代表预报具有技巧**。一个预报可能恰好做出了与观测事件总数相同的预报次数，但这些预报可能与实际事件的发生时间和地点完全错配，导致命中次数很低。

### 技巧评分的必要性与对机遇的校正

简单的评分，如准确率（Accuracy, $ACC = (H+C)/N$），在某些情况下可能极具误导性，尤其是在处理**稀有事件 (rare events)** 时。例如，假设我们预报一个发生概率仅为1%的极端降水事件。一个“懒惰”的预报系统，无论何种情况都预报“事件不发生”，将获得99%的准确率，因为其正确否定 ($C$) 的数量极其庞大。然而，这个看似完美的准确率分数完全没有反映出该系统在预报我们真正关心的稀有事件上的[无能](@entry_id:201612)为力 。

为了克服这个问题，我们需要关注那些真正与事件发生相关的预报表现。**威胁评分 (Threat Score, TS)**，又称**[临界成功指数](@entry_id:1123210) (Critical Success Index, CSI)**，正是为此而生：
$$ \mathrm{CSI} = \frac{H}{H+M+F} $$
从[集合论](@entry_id:137783)的角度看，CSI可以解释为“预报事件”集合与“观测事件”集合的交集大小（$H$）与并集大小（$H+M+F$）之比 。通过从评估中排除数量庞大的正确否定项 $C$，CSI对稀有事件的预报技巧提供了比准确率更中肯的度量。

然而，即便是CSI也存在一个深层次的问题：即使是一个完全随机、毫无技巧的预报，也可能因为纯粹的机遇而获得一些命中。一个有意义的**技巧评分 (skill score)** 必须能够衡量预报表现超出这种机遇基线的程度。

#### 公平性原则与机遇命中数的推导

一个理想的技巧评分应遵循**公平性原则 (equitability principle)**。该原则指出，对于任何无[信息量](@entry_id:272315)的预报策略（例如，总是预报“发生”，或随机猜测），评分应该给出一个固定的“无技巧”分值（通常为0），并且这个分值不应随事件本身的基础频率（即气候态概率）而改变 。

为了实现这一点，我们首先需要量化“机遇”能带来多少命中。我们构建一个参照基线：一个随机预报系统，它与真实观测完全**统计独立**，但其预报事件的频率（$p_f$）与我们正在评估的系统相同。

- 观测事件的基础频率（气候态）为：$p_o = \frac{H+M}{N}$
- 预报事件的基础频率（偏差）为：$p_f = \frac{H+F}{N}$

在[统计独立性](@entry_id:150300)的假设下，一个“命中”（即预报发生且观测发生）的概率是两个[独立事件](@entry_id:275822)概率的乘积，即 $p_o \times p_f$。因此，在 $N$ 次试验中，由纯粹机遇导致的预期命中数，我们记为 $H_r$，可以推导得出  ：
$$ H_r = N \times p_o \times p_f = N \times \frac{H+M}{N} \times \frac{H+F}{N} = \frac{(H+M)(H+F)}{N} $$
这个 $H_r$ 就是我们需要从原始命中数中剔除的“机遇”成分。

### [公平威胁评分](@entry_id:1124616) (Equitable Threat Score, ETS)

**[公平威胁评分](@entry_id:1124616) (ETS)**，也称为 Gilbert Skill Score (GSS)，正是通过从CSI的结构中减去机遇命中数 $H_r$ 来构建的。其公式为  ：
$$ \mathrm{ETS} = \frac{H - H_r}{H + M + F - H_r} $$

这个公式的结构精妙地体现了技巧评分的核心思想：
- **分子 ($H - H_r$)**: 代表了预报系统获得的、**超越机遇水平的命中数**。这是预报真正“技巧”的体现。
- **分母 ($H + M + F - H_r$)**: 代表了在排除了机遇命中的影响后，所有被预报或观测到的事件的总数。这样的归一化确保了评分的恰当范围。

ETS具有以下关键性质：
1.  **无技巧预报得分为0**: 当实际命中数恰好等于机遇预期命中数时 ($H = H_r$)，ETS的分子为0，因此 $\mathrm{ETS} = 0$。这表明预报系统的表现与一个具有相同频率偏差的随机预报无异 。
2.  **完美预报得分为1**: 对于一个完美的预报，不存在漏报和空报（$M=0, F=0$）。在这种情况下，可以证明ETS的分母等于分子，因此 $\mathrm{ETS} = 1$。
3.  **满足公平性原则**: 对于“总是预报发生”（$p_f=1$）或“总是预报不发生”（$p_f=0$）这类无信息量的恒定预报策略，ETS的得分均为$0$，且此结果不依赖于事件的观测基础频率 $p_o$ 。

通过一个实例可以清晰地看到ETS相比于CSI的优势。假设在一个包含 $N=20000$ 个样本的验证研究中，我们得到 $H=150, M=250, F=5850$。该预报系统的频率偏差 $B = (150+5850)/(150+250) = 6000/400 = 15$，表明存在严重的过度预报。
- 其CSI评分为：$\mathrm{CSI} = 150 / (150+250+5850) = 150/6250 \approx 0.024$。
- 而其机遇命中数为：$H_r = (400 \times 6000) / 20000 = 120$。
- 其ETS评分为：$\mathrm{ETS} = (150 - 120) / (6250 - 120) = 30 / 6130 \approx 0.0049$。

ETS评分远低于CSI，因为它识别出150次命中中有120次可归因于该系统的高预报频率所带来的随机重叠，并对此进行了惩罚。CSI与ETS的差异程度主要取决于机遇命中数 $H_r$ 的大小。当事件频率高或[预报偏差](@entry_id:1125224)大时，$H_r$ 会显著增大，导致ETS远低于CSI 。

### 与其他技巧评分的比较分析

ETS是众多技巧评分中的一种。通过与其他常用评分进行比较，我们可以更深入地理解其特性和适用范围。

#### ETS 与 Heidke 技巧评分 (HSS)

**Heidke 技巧评分 (HSS)** 是另一个经典的公平评分，它基于总体准确率进行机遇校正：
$$ \mathrm{HSS} = \frac{(H+C) - E}{N - E} $$
其中，$E$ 是机遇预期的总正确预报数（包括命中和正确否定），$E = \frac{(H+M)(H+F) + (M+C)(F+C)}{N}$。

HSS与ETS的关键区别在于它们所关注的“正确性”的范畴。HSS将 $H$ 和 $C$ 都视为同等重要的正确预报，而ETS则完全忽略 $C$。在稀有事件检验中，这是一个至关重要的差异。由于稀有事件的 $C$ 值通常非常巨大，它会在HSS的计算中占据主导地位，可能导致评分虚高，掩盖了模型在预报稀有事件本身方面的不足。ETS通过专注于与事件相关的 $H, M, F$ 项，避免了被庞大的正确否定数所“膨胀”，因此被认为是评估稀有事件预报技巧时更为鲁棒和恰当的选择 。

#### ETS 与 Peirce 技巧评分 (PSS)

**Peirce 技巧评分 (PSS)**，也称为真技巧统计量 (True Skill Statistic, TSS)，其定义非常直观：
$$ \mathrm{PSS} = \mathrm{POD} - \mathrm{POFD} = \frac{H}{H+M} - \frac{F}{F+C} $$
其中 $\mathrm{POFD}$ 是空报概率 (Probability of False Detection)，即在事件未发生的条件下预报发生的概率。PSS衡量的是预报系统区分“事件发生”与“事件未发生”这两种情况的能力。

PSS与ETS在对待事件基础频率 $p_o$ 的方式上存在根本不同。从其定义可以看出，只要一个预报系统的内在判别能力（即POD和POFD）保持不变，**PSS的值就与事件的基础频率 $p_o$ 无关**。相比之下，**ETS的值则显著依赖于 $p_o$**。

我们可以设想一个思想实验：同一个预报系统被用于两个气候状况截然不同的区域。A区事件罕见（$p_o$ 很低），B区事件常见（$p_o$ 很高）。假设该系统在这两个区域的判别能力是相同的（即POD和POFD不变）。
- PSS评分在A区和B区将完全相同，因为它只反映了系统固有的区分能力。
- ETS评分在B区（事件常见区）会远高于A区（事件罕见区）。

这揭示了一个深刻的观点：在事件极其罕见时（$p_o \to 0$），即便一个预报系统有很强的判别能力（PSS值很高），其ETS评分也会趋向于0。这是因为ETS不仅评估判别能力，它还隐性地评估了在特定气候条件下获得有价值预报的**实际难度**。在极端稀有事件中，即使是最好的系统也很难获得大量超越机遇的命中，ETS如实地反映了这一挑战 。

### 总结与实践考量

本章系统地介绍了二元事件[分类检验](@entry_id:1122129)的核心原理。我们从基础的[列联表](@entry_id:164487)出发，探讨了POD、频率偏差等诊断工具，并着重阐述了从CSI到ETS的演进，其背后是对“机遇”进行校正的公平性原则。最后，通过与HSS和PSS的比较，我们进一步明确了不同技巧评分的侧重点和适用场景。

在实践中，必须认识到**没有单一的评分能够描绘预报质量的全貌**。一个全面的评估通常需要一整套评分：用频率偏差检查系统性倾向，用POD评估对事件的捕捉能力，用ETS或PSS等综合技巧评分来衡量超越机遇的预报技巧。特别地，对于稀有事件的检验，ETS因其对正确否定不敏感而被广泛认为是首选的技巧评分。理解每一种评分的内在机制、优点和局限性，是进行严谨、科学的[预报检验](@entry_id:1125232)工作的基石。