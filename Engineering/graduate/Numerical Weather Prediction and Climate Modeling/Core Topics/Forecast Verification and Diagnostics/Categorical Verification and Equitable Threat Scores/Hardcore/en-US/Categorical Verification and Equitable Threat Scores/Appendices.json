{
    "hands_on_practices": [
        {
            "introduction": "A skillful forecast must provide more information than a simple random guess. To quantify this, we first need a baseline for \"no skill,\" which is the performance we'd expect from chance alone. This exercise  builds this crucial intuition by analyzing trivial forecasting strategies, such as always predicting an event or never predicting it, and quantifying the \"hits\" they would achieve by pure coincidence.",
            "id": "4021501",
            "problem": "In a categorical verification setting for numerical weather prediction and climate modeling, consider a binary event (for example, occurrence of daily precipitation exceeding a given threshold). Let there be a sample of $N$ independent forecastâ€“observation pairs with observed-event base rate $p_o \\in (0,1)$ across the sample. Using the standard $2 \\times 2$ contingency table notation with hits $H$, misses $M$, false alarms $F$, and correct negatives $C$, so that $N = H + M + F + C$ and the total number of observed events is $H + M = N p_o$, analyze two degenerate forecasting strategies:\n- A constant-yes forecast that predicts the event for every case.\n- A constant-no forecast that predicts no event for every case.\n\nTasks:\n- For each of the two strategies, compute $(H,M,F,C)$ in terms of $N$ and $p_o$.\n- Starting from the independence assumption used in equitable categorical scoring, derive the expected number of random hits $H_r$ for each strategy in terms of $N$ and $p_o$ by expressing $H_r$ via the product of the marginal event and forecast-yes probabilities and the sample size $N$.\n- Let $\\Delta H_r$ denote the difference between the expected random hits of the constant-yes and constant-no strategies, $\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}}$. Provide a closed-form expression for $\\Delta H_r$ in terms of $N$ and $p_o$.\n\nYour final answer should be a single simplified analytic expression for $\\Delta H_r$. No rounding is required, and no units are needed.",
            "solution": "The problem statement is deemed valid as it is scientifically grounded in the principles of categorical forecast verification, is well-posed with a clear objective, and is free of ambiguities or contradictions.\n\nThe problem requires an analysis of two degenerate forecasting strategies within the framework of a $2 \\times 2$ contingency table for a binary event. The total sample size is $N$. The elements of the contingency table are hits ($H$), misses ($M$), false alarms ($F$), and correct negatives ($C$). The total size is $N = H + M + F + C$. The observed-event base rate is given as $p_o$. This implies that the total number of observed events in the sample is $H+M = Np_o$, and the total number of observed non-events is $F+C = N - Np_o = N(1-p_o)$.\n\nFirst, we determine the values of $(H, M, F, C)$ for each degenerate strategy.\n\n**Strategy 1: Constant-yes forecast**\nIn this strategy, the event is forecast for every one of the $N$ cases. This means the number of \"no event\" forecasts is zero, which implies $M=0$ and $C=0$.\nThe total number of observed events is $Np_o$. Since the forecast is always \"yes\" for these cases, they are all registered as hits.\n$$H = Np_o$$\nThe total number of observed non-events is $N(1-p_o)$. Since the forecast is always \"yes\" for these cases, they are all registered as false alarms.\n$$F = N(1-p_o)$$\nThus, for the constant-yes forecast, the contingency table counts are:\n$$(H, M, F, C) = (Np_o, 0, N(1-p_o), 0)$$\nWe can verify the totals: $H+M = Np_o$, $F+C = N(1-p_o)$, and $H+M+F+C = Np_o + 0 + N(1-p_o) + 0 = N$.\n\n**Strategy 2: Constant-no forecast**\nIn this strategy, no event is forecast for any of the $N$ cases. This means the number of \"yes event\" forecasts is zero, which implies $H=0$ and $F=0$.\nThe total number of observed events is $Np_o$. Since the forecast is always \"no\" for these cases, they are all registered as misses.\n$$M = Np_o$$\nThe total number of observed non-events is $N(1-p_o)$. Since the forecast is always \"no\" for these cases, they are all registered as correct negatives.\n$$C = N(1-p_o)$$\nThus, for the constant-no forecast, the contingency table counts are:\n$$(H, M, F, C) = (0, Np_o, 0, N(1-p_o))$$\nWe can verify the totals: $H+M=Np_o$, $F+C=N(1-p_o)$, and $H+M+F+C=0+Np_o+0+N(1-p_o)=N$.\n\nNext, we derive the expected number of random hits, $H_r$, for each strategy. The problem specifies that $H_r$ is based on the independence assumption, where the expected number of hits is the product of the sample size, the observed-event probability, and the forecast-event probability.\nThe observed-event probability is the base rate, $p_o = \\frac{H+M}{N}$.\nThe forecast-event probability, let's call it $p_f$, is the marginal frequency of \"yes\" forecasts, $p_f = \\frac{H+F}{N}$.\nThe expected number of hits for a forecast that is random with respect to the observations is given by:\n$$H_r = N \\cdot p_o \\cdot p_f = N \\left(\\frac{H+M}{N}\\right) \\left(\\frac{H+F}{N}\\right) = \\frac{(H+M)(H+F)}{N}$$\nSince $H+M = Np_o$, this can be written as:\n$$H_r = p_o (H+F)$$\n\nWe now apply this formula to each strategy.\n\nFor the constant-yes strategy, the total number of \"yes\" forecasts is $H+F = Np_o + N(1-p_o) = N$.\nThe expected number of random hits for this strategy, $H_r^{\\text{yes}}$, is:\n$$H_r^{\\text{yes}} = p_o (H+F) = p_o \\cdot N = Np_o$$\n\nFor the constant-no strategy, the total number of \"yes\" forecasts is $H+F = 0+0 = 0$.\nThe expected number of random hits for this strategy, $H_r^{\\text{no}}$, is:\n$$H_r^{\\text{no}} = p_o (H+F) = p_o \\cdot 0 = 0$$\n\nFinally, we compute the difference $\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}}$.\n$$\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}} = Np_o - 0 = Np_o$$\nThe difference in the expected number of random hits between a constant-yes and a constant-no forecast is equal to the total number of observed events in the sample. This is a key insight used in the formulation of equitable scores like the Peirce Skill Score or the Heidke Skill Score, which use $H_r$ as a reference to measure skill above random chance.",
            "answer": "$$\\boxed{Np_o}$$"
        },
        {
            "introduction": "With a baseline for random chance established, we can now construct a score that rewards only true forecasting skill. The Equitable Threat Score (ETS) achieves this by explicitly removing the number of hits expected by chance. This practice  guides you through the derivation of the ETS from first principles and then solidifies your understanding by applying it to a realistic forecast verification scenario.",
            "id": "4021502",
            "problem": "Consider binary event verification for a thresholded precipitation exceedance in numerical weather prediction and climate modeling, summarized by a contingency table with counts: hits $H$, misses $M$, false alarms $F$, and correct negatives $C$. Let the total number of forecast-observation pairs be $N$, so that $N = H + M + F + C$. The observed event frequency is the number of observed events $H + M$, and the forecast event frequency is the number of forecasted events $H + F$. The frequency bias is the ratio of forecast event frequency to observed event frequency. The Equitable Threat Score (ETS) is constructed from the idea that, under the independence assumption between forecasts and observations, an expected number of hits would occur purely by chance, and these random hits should be removed from both the numerator (to measure skillful hits) and the denominator (to maintain equitable penalties across different base rates).\n\nStarting only from these core definitions and principles:\n- Derive the necessary and sufficient condition on $(H, M, F, C)$ under which the frequency bias equals one.\n- Using the independence assumption as the foundational probabilistic model for chance coincidence, derive the expression for the Equitable Threat Score (ETS), and then simplify it under the condition that the forecast event frequency equals the observed event frequency.\n\nFinally, apply your results to the following scientifically realistic scenario: there are $N = 2500$ daily forecasts; the observed event base rate is $0.1$, so the number of observed events is $H + M = 250$; the forecast event frequency matches the observed event frequency, and the proportion of hits among observed events is $0.6$, so $H = 0.6(H + M)$. Compute the ETS numerically for this scenario. Round your answer to four significant figures. Express the final result as a pure number with no units.",
            "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and self-contained. All necessary information is provided, and the questions are specific and formalizable. The scenario is realistic within the context of numerical weather prediction. Therefore, the problem is valid, and a solution will be provided.\n\nThe analysis proceeds in three parts as requested by the problem statement:\n1.  Derivation of the condition for unit frequency bias.\n2.  Derivation and simplification of the Equitable Threat Score (ETS).\n3.  Numerical computation of the ETS for the given scenario.\n\nLet the four elements of the contingency table be defined as:\n- $H$: Hits (event forecast, event observed)\n- $M$: Misses (event not forecast, event observed)\n- $F$: False Alarms (event forecast, event not observed)\n- $C$: Correct Negatives (event not forecast, event not observed)\n\nThe total number of forecast-observation pairs is $N = H + M + F + C$.\n\n### Part 1: Condition for Unit Frequency Bias\n\nThe frequency bias, often denoted as $B$, is defined as the ratio of the forecast event frequency to the observed event frequency.\nThe number of times the event was forecast is the sum of hits and false alarms, $H + F$.\nThe number of times the event was observed is the sum of hits and misses, $H + M$.\n\nTherefore, the frequency bias is given by:\n$$\nB = \\frac{H + F}{H + M}\n$$\nThe problem asks for the necessary and sufficient condition under which the frequency bias equals one. Setting $B = 1$:\n$$\n\\frac{H + F}{H + M} = 1\n$$\nAssuming the number of observed events is non-zero (i.e., $H + M \\neq 0$, which is a practical necessity for the bias to be well-defined and meaningful), we can multiply both sides by $H + M$:\n$$\nH + F = H + M\n$$\nSubtracting $H$ from both sides yields:\n$$\nF = M\n$$\nThis is the necessary and sufficient condition. A frequency bias of $1$ implies that the number of false alarms is exactly equal to the number of misses. This condition is also referred to as \"unbiased\" in the sense of frequency, meaning the model forecasts the event with the same frequency as it is observed.\n\n### Part 2: Derivation and Simplification of the Equitable Threat Score (ETS)\n\nThe Equitable Threat Score (ETS) is designed to improve upon the Threat Score (TS), also known as the Critical Success Index (CSI), which is defined as $TS = \\frac{H}{H+M+F}$. The ETS accounts for hits that would be expected to occur purely by random chance, assuming the forecasts and observations are statistically independent.\n\nThe foundational probabilistic model for this chance coincidence is based on the independence of forecast and observed events.\nThe probability of a forecast event is $P(fcst) = \\frac{H + F}{N}$.\nThe probability of an observed event is $P(obs) = \\frac{H + M}{N}$.\n\nUnder the assumption of independence, the probability of a joint occurrence (a hit) is the product of the individual probabilities:\n$$\nP(hit_{random}) = P(fcst) \\times P(obs) = \\left(\\frac{H + F}{N}\\right) \\left(\\frac{H + M}{N}\\right)\n$$\nThe expected number of hits occurring by random chance, $H_{random}$, over a total of $N$ trials is:\n$$\nH_{random} = N \\times P(hit_{random}) = N \\times \\frac{(H + F)(H + M)}{N^2} = \\frac{(H + F)(H + M)}{N}\n$$\nThe ETS is constructed by removing these random hits from the count of actual hits to get the number of \"skillful\" hits. To maintain an equitable score, this random component is also removed from the denominator. The denominator of the TS, $H+M+F$, represents the total number of cases where the event was either forecast or observed (or both).\n$$\nETS = \\frac{\\text{Actual Hits} - \\text{Random Hits}}{\\text{Total Events} - \\text{Random Hits}} = \\frac{H - H_{random}}{H + M + F - H_{random}}\n$$\nSubstituting the expression for $H_{random}$, the general formula for the ETS is:\n$$\nETS = \\frac{H - \\frac{(H + F)(H + M)}{N}}{H + M + F - \\frac{(H + F)(H + M)}{N}}\n$$\nNow, we simplify this expression under the condition derived in Part 1, namely that the forecast event frequency equals the observed event frequency. This is the condition $H+F = H+M$.\nLet's denote the common frequency by $K$, such that $K = H+F = H+M$. As shown before, this implies $F=M$.\n\nUnder this condition, the expression for random hits simplifies to:\n$$\nH_{random} = \\frac{K \\cdot K}{N} = \\frac{(H + M)^2}{N} \\quad \\text{or equivalently} \\quad H_{random} = \\frac{(H + F)^2}{N}\n$$\nThe denominator of the ETS, $H+M+F$, can be rewritten using $F=M$:\n$$\nH + M + F = H + M + M = H + 2M\n$$\nAlternatively, $H+M+F = (H+M) + F = K+F$.\n\nSubstituting these into the ETS formula:\n$$\nETS = \\frac{H - \\frac{(H+M)^2}{N}}{H + M + F - \\frac{(H+M)^2}{N}}\n$$\nThis is the simplified expression for the ETS under the condition of unit frequency bias.\n\n### Part 3: Numerical Computation\n\nWe are given the following scenario:\n- Total forecasts: $N = 2500$\n- Observed event base rate: $0.1$. The number of observed events is $H + M = 0.1 \\times N = 0.1 \\times 2500 = 250$.\n- Forecast event frequency matches the observed event frequency. This means $H+F = H+M = 250$, which is the condition of unit bias ($F=M$).\n- The proportion of hits among observed events is $0.6$. This gives $H = 0.6 \\times (H+M)$.\n\nWe can now calculate the values of $H, M, F,$ and $C$.\n1.  Calculate Hits ($H$):\n    $$\n    H = 0.6 \\times (H+M) = 0.6 \\times 250 = 150\n    $$\n2.  Calculate Misses ($M$):\n    $$\n    M = (H+M) - H = 250 - 150 = 100\n    $$\n3.  Calculate False Alarms ($F$):\n    Since the frequency bias is unity, $F=M$.\n    $$\n    F = 100\n    $$\n    As a check: $H+F = 150+100=250$, which matches $H+M$.\n4.  Calculate Correct Negatives ($C$):\n    $$\n    C = N - (H+M+F) = 2500 - (150 + 100 + 100) = 2500 - 350 = 2150\n    $$\nNow, we compute the ETS. First, calculate the number of random hits, $H_{random}$:\n$$\nH_{random} = \\frac{(H + F)(H + M)}{N} = \\frac{250 \\times 250}{2500} = \\frac{62500}{2500} = 25\n$$\nFinally, calculate the ETS using the general formula:\n$$\nETS = \\frac{H - H_{random}}{H + M + F - H_{random}} = \\frac{150 - 25}{150 + 100 + 100 - 25}\n$$\n$$\nETS = \\frac{125}{350 - 25} = \\frac{125}{325}\n$$\nTo simplify the fraction, we can divide the numerator and denominator by their greatest common divisor, which is $25$:\n$$\nETS = \\frac{125 \\div 25}{325 \\div 25} = \\frac{5}{13}\n$$\nThe problem requires a numerical answer rounded to four significant figures.\n$$\nETS = \\frac{5}{13} \\approx 0.38461538...\n$$\nRounding to four significant figures, we get $0.3846$.",
            "answer": "$$\\boxed{0.3846}$$"
        },
        {
            "introduction": "The design of a skill score has important implications for how we evaluate and ultimately develop forecast models. This exercise  explores a key advantage of the ETS over the simpler Critical Success Index (CSI), especially when dealing with forecasts that tend to over-predict events. By analyzing the score's behavior in the limit of many false alarms, you will see why the ETS provides a more robust measure of skill by properly penalizing this common type of forecast bias.",
            "id": "4021638",
            "problem": "Consider categorical verification of a rare-event forecast in numerical weather prediction across $N$ spatiotemporal samples. Let the $2 \\times 2$ contingency table counts be: hits $H$, misses $M$, false alarms $F$, and correct negatives $C$, with $H  0$, $M \\geq 0$, $F \\geq 0$, and $C \\geq 0$. The observed-event count is $S_{o} = H + M$, the forecast-event count is $S_{f} = H + F$, and the sample size is $N = H + M + F + C$. The Critical Success Index (CSI) is defined as the intersection-over-union of events, namely $\\text{CSI} = H/(H + M + F)$. An equitable score is one that returns zero for forecasts that are statistically indistinguishable from random, given the observed and forecast event frequencies.\n\nAssume that under a random (independent) forecast with the same marginals, the expected number of hits equals the product of the observed-event and forecast-event frequencies, that is, the expected random hits $H_{r}$ satisfy $H_{r} = (S_{o}/N)(S_{f}/N)N = S_{o} S_{f}/N$. Starting from the requirement of equitability and the definition of $\\text{CSI}$ as an intersection-over-union measure on the event set, construct an equitable modification of $\\text{CSI}$ by subtracting $H_{r}$ from both the numerator and the denominator so that the resulting score is $1$ for a perfect forecast and $0$ for a random forecast with the same marginals. This construction is the Equitable Threat Score (ETS).\n\nNow consider a sequence of scenarios in which $H$ and $M$ are held fixed, $C$ is a fixed nonnegative constant, and $F \\to \\infty$, so that $N = H + M + F + C \\to \\infty$. Let $\\text{ETS}(F)$ and $\\text{CSI}(F)$ denote the Equitable Threat Score and the Critical Success Index as functions of $F$ under these constraints.\n\nDetermine, in closed form, the limit of the ratio $\\text{ETS}(F)/\\text{CSI}(F)$ as $F \\to \\infty$, expressed purely in terms of $H$ and $M$. Your final answer must be given as a single analytic expression with no units and no numerical evaluation or rounding.",
            "solution": "The problem statement is a valid, well-posed mathematical problem grounded in the principles of forecast verification statistics. All terms are clearly defined, and the premises are scientifically and mathematically sound. We may therefore proceed with the solution.\n\nThe problem requires us to determine the limit of the ratio of the Equitable Threat Score ($\\text{ETS}$) to the Critical Success Index ($\\text{CSI}$) under a specific asymptotic scenario. We begin by defining the relevant quantities as functions of the number of false alarms, $F$. The total number of observed events, $S_o$, is constant, as $H$ and $M$ are fixed:\n$$S_o = H + M$$\nThe total number of forecast events, $S_f$, depends on $F$:\n$$S_f(F) = H + F$$\nThe total sample size, $N$, also depends on $F$:\n$$N(F) = H + M + F + C$$\nThe Critical Success Index, $\\text{CSI}$, as a function of $F$ is given by:\n$$\\text{CSI}(F) = \\frac{H}{H + M + F}$$\nThe expected number of hits for a random forecast with the same marginal totals, $H_r$, is:\n$$H_r(F) = \\frac{S_o S_f(F)}{N(F)} = \\frac{(H+M)(H+F)}{H+M+F+C}$$\nThe Equitable Threat Score, $\\text{ETS}$, is constructed by removing the contribution from a random forecast, $H_r$, from both the hits ($H$) in the numerator and the total number of events in the union set ($H+M+F$) in the denominator of the $\\text{CSI}$ formula. Thus, $\\text{ETS}$ as a function of $F$ is:\n$$\\text{ETS}(F) = \\frac{H - H_r(F)}{H + M + F - H_r(F)}$$\nWe are asked to find the limit of the ratio $R(F) = \\frac{\\text{ETS}(F)}{\\text{CSI}(F)}$ as $F \\to \\infty$. Let us formulate this ratio:\n$$R(F) = \\frac{\\frac{H - H_r(F)}{H + M + F - H_r(F)}}{\\frac{H}{H + M + F}} = \\frac{H+M+F}{H} \\cdot \\frac{H-H_r(F)}{H+M+F-H_r(F)}$$\nThis expression is an indeterminate form of type $\\infty \\cdot 0$ as $F \\to \\infty$, since $H+M+F \\to \\infty$ and the second term tends to $0$. We must therefore perform a more detailed algebraic simplification before taking the limit.\n\nLet's express the terms involving $H_r(F)$ as rational functions of $F$.\nFirst, the numerator of the second fraction, $H-H_r(F)$:\n$$H - H_r(F) = H - \\frac{(H+M)(H+F)}{H+M+F+C} = \\frac{H(H+M+F+C) - (H+M)(H+F)}{H+M+F+C}$$\nExpanding the numerator of this expression:\n$$H(H+M+F+C) - (H+M)(H+F) = (H^2 + HM + HF + HC) - (H^2 + HF + MH + MF)$$\n$$= H^2 + HM + HF + HC - H^2 - HF - MH - MF = HC - MF$$\nSo, we have:\n$$H - H_r(F) = \\frac{HC - MF}{H+M+F+C}$$\nNext, the denominator of the second fraction, $H+M+F-H_r(F)$:\n$$H+M+F-H_r(F) = (H+M+F) - \\frac{(H+M)(H+F)}{H+M+F+C}$$\n$$= \\frac{(H+M+F)(H+M+F+C) - (H+M)(H+F)}{H+M+F+C}$$\nThe numerator of this expression is a quadratic polynomial in $F$. Let $A = H+M$. The term becomes:\n$$(A+F)(A+F+C) - A(H+F) = (A+F)^2 + C(A+F) - A(H+F)$$\n$$= A^2+2AF+F^2+AC+CF - AH-AF = F^2 + (A+C)F + (A^2+AC-AH)$$\n$$= F^2 + (H+M+C)F + (H+M)^2 + C(H+M) - H(H+M)$$\n$$= F^2 + (H+M+C)F + (H+M)(H+M+C-H) = F^2 + (H+M+C)F + (H+M)(M+C)$$\nSo, we have:\n$$H+M+F-H_r(F) = \\frac{F^2+(H+M+C)F+(H+M)(M+C)}{H+M+F+C}$$\nNow we substitute these expressions back into the ratio $R(F)$:\n$$R(F) = \\frac{H+M+F}{H} \\cdot \\frac{\\frac{HC - MF}{H+M+F+C}}{\\frac{F^2+(H+M+C)F+(H+M)(M+C)}{H+M+F+C}}$$\nThe common denominators of $\\frac{1}{H+M+F+C}$ cancel, leaving:\n$$R(F) = \\frac{H+M+F}{H} \\cdot \\frac{HC - MF}{F^2+(H+M+C)F+(H+M)(M+C)}$$\n$$R(F) = \\frac{(H+M+F)(HC - MF)}{H[F^2+(H+M+C)F+(H+M)(M+C)]}$$\nThis is a rational function of $F$. To find the limit as $F \\to \\infty$, we identify the highest power of $F$ in the numerator and the denominator.\nThe numerator is a polynomial in $F$:\n$$\\text{Numerator}(F) = (F+H+M)(-MF+HC) = -MF^2 + (HC-M(H+M))F + HC(H+M)$$\nThe term with the highest power of $F$ in the numerator is $-MF^2$.\nThe denominator is also a polynomial in $F$:\n$$\\text{Denominator}(F) = H[F^2+(H+M+C)F+(H+M)(M+C)] = HF^2 + H(H+M+C)F + H(H+M)(M+C)$$\nThe term with the highest power of $F$ in the denominator is $HF^2$.\n\nThe limit of a rational function as the variable approaches infinity is the ratio of the coefficients of the highest power terms, provided the degrees of the numerator and denominator are equal. Here, both are degree $2$.\n$$\\lim_{F \\to \\infty} R(F) = \\lim_{F \\to \\infty} \\frac{-MF^2 + \\dots}{HF^2 + \\dots} = \\frac{-M}{H}$$\nThe constants $H$, $M$, and $C$ are fixed, and $H0$ is given, so this limit is well-defined. The result depends only on $H$ and $M$ as required.",
            "answer": "$$\\boxed{\\frac{-M}{H}}$$"
        }
    ]
}