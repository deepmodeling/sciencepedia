{
    "hands_on_practices": [
        {
            "introduction": "理解预报误差是改进模型的第一步。该练习将指导您将总误差分解为两个基本组成部分：代表持续性模型倾向的系统性偏差，以及捕捉不可预测波动的随机误差。通过从第一性原理出发，您将推导出均方根误差（$RMSE$）的关键分解，并理解为何异常相关系数（Anomaly Correlation）对某些类型的误差不敏感，从而掌握区分和量化不同误差来源的核心技能。",
            "id": "4030916",
            "problem": "考虑一个确定性预报系统，它对某一物理量生成标量时间序列的预报 $f_t$ 和在时间 $t=1,\\dots,T$ 对应的验证观测 $o_t$。将预报误差定义为 $e_t = f_t - o_t$。假设存在典范分解 $e_t = b + \\eta_t$ 且 $E[\\eta_t] = 0$，其中 $b$ 是系统性分量（偏差），$\\eta_t$ 是零均值随机分量。从基本原理出发，以偏差、均方根误差和相对于气候态的距平的核心定义为起点：\n- 偏差定义为期望误差，$b = E[e_t]$。\n- 均方根误差定义为期望平方误差的平方根，$\\mathrm{RMSE} = \\sqrt{E[e_t^2]}$。\n- 给定气候态时间序列 $c_t$，对于一个序列 $x_t$（例如，$x_t \\in \\{f_t,o_t\\}$），将其距平定义为 $a_t^{(x)} = x_t - c_t$。距平相关定义为在 $t=1,\\dots,T$ 范围内的预报距平和观测距平之间的 Pearson 相关。\n\n任务 A（推导）：严格从上述定义以及 $e_t = b + \\eta_t$（其中 $E[\\eta_t]=0$）出发，推导出一个分解式，用 $b$ 和一个衡量随机分量 $\\eta_t$ 的指标来表示 $\\mathrm{RMSE}^2$。解释为什么当距平是相对于一个固定的气候态形成时，距平相关对一个加性常数偏差不敏感。\n\n任务 B（估计与计算）：设计一个估计流程，仅使用有限样本 $\\{(f_t,o_t,c_t)\\}_{t=1}^{T}$ 将系统性偏差与随机误差分离开来。您的估计必须基于以下原则：\n- 通过误差的样本均值来估计 $b$。\n- 通过从每个误差中移除估计的偏差来估计随机分量 $\\eta_t$。\n- 通过计算估计出的随机分量的均方根来量化随机分量，使用与 $\\mathrm{RMSE}$ 定义相同的归一化方法，以便进行直接的分解检验。\n- 将距平相关计算为预报距平和观测距平之间的 Pearson 相关。如果任一距平序列的样本方差为零，则将距平相关定义为 $0$。\n\n任务 C（实现）：实现一个程序，为每个提供的测试用例计算：\n1. 估计的偏差 $\\hat{b}$，单位为开尔文（K）。\n2. 估计的随机误差的均方根 $\\widehat{\\sigma_\\eta}$，单位为开尔文（K），其中 $\\widehat{\\sigma_\\eta}$ 定义为去偏差后误差的平方的样本均值的平方根。\n3. 估计的均方根误差 $\\widehat{\\mathrm{RMSE}}$，单位为开尔文（K）。\n4. 距平相关 $\\widehat{\\mathrm{AC}}$（无量纲），计算为 $a_t^{(f)}$ 和 $a_t^{(o)}$ 之间的 Pearson 相关。\n5. 一个布尔值，当且仅当 $\\left|\\widehat{\\mathrm{RMSE}}^2 - \\left(\\hat{b}^2 + \\widehat{\\sigma_\\eta}^2\\right)\\right| \\le \\tau$ 时为真，其中固定的容差 $\\tau$ 用于考虑浮点运算。\n\n物理单位：所有与温度相关的量都必须解释为开尔文（K）。不涉及角度。不涉及百分比；将所有输出以浮点数或布尔值的形式数值化表示，不带百分号。\n\n使用以下测试用例集，每个用例指定了 $t=1,\\dots,T$ 的 $(f_t,o_t,c_t)$：\n- 用例 1（$T=6$；带有随机扰动的系统性偏差）：\n  - 观测值 $o_t$：$(\\; $289.0$, $291.5$, $294.2$, $296.8$, $299.1$, $300.3$ \\;)$\n  - 预报值 $f_t$：$(\\; $290.3$, $293.1$, $295.1$, $298.6$, $300.6$, $302.2$ \\;)$\n  - 气候态 $c_t$：$(\\; $288.5$, $291.0$, $293.5$, $296.0$, $298.5$, $300.0$ \\;)$\n- 用例 2（$T=6$；仅有随机误差，偏差接近于零）：\n  - 观测值 $o_t$：$(\\; $280.0$, $282.0$, $284.0$, $286.0$, $288.0$, $290.0$ \\;)$\n  - 预报值 $f_t$：$(\\; $280.0$, $281.5$, $284.5$, $285.0$, $289.0$, $290.0$ \\;)$\n  - 气候态 $c_t$：$(\\; $279.0$, $281.0$, $283.0$, $285.0$, $287.0$, $289.0$ \\;)$\n- 用例 3（$T=6$；完美预报）：\n  - 观测值 $o_t$：$(\\; $295.0$, $296.0$, $297.0$, $298.0$, $299.0$, $300.0$ \\;)$\n  - 预报值 $f_t$：$(\\; $295.0$, $296.0$, $297.0$, $298.0$, $299.0$, $300.0$ \\;)$\n  - 气候态 $c_t$：$(\\; $294.5$, $295.5$, $296.5$, $297.5$, $298.5$, $299.5$ \\;)$\n- 用例 4（$T=6$；预报等于气候态，距平方差为零）：\n  - 观测值 $o_t$：$(\\; $285.0$, $287.0$, $290.0$, $292.0$, $289.0$, $286.0$ \\;)$\n  - 预报值 $f_t$：$(\\; $286.0$, $287.0$, $288.0$, $289.0$, $290.0$, $291.0$ \\;)$\n  - 气候态 $c_t$：$(\\; $286.0$, $287.0$, $288.0$, $289.0$, $290.0$, $291.0$ \\;)$\n\n答案规格：\n- 对分解检验使用 $\\tau = 10^{-10}$。\n- 对每个用例，生成一个形式为 $[\\hat{b}, \\widehat{\\sigma_\\eta}, \\widehat{\\mathrm{RMSE}}, \\widehat{\\mathrm{AC}}, \\text{check}]$ 的列表，其中前四项是浮点数，第五项是布尔值。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，每个用例按上述顺序表示为一个内部的方括号列表（例如，$[[\\dots],[\\dots],[\\dots],[\\dots]]$）。不应打印任何其他文本。",
            "solution": "该问题陈述是确定性预报检验中的一个有效练习。它在科学上基于统计学和大气科学的原理，其定义清晰、数据充分，表述客观，是一个适定的问题。解决该问题所需的所有必要组成部分均已提供，可得到唯一且有意义的解。我们将按要求进行推导和计算。\n\n分析分为两部分，对应于问题中列出的任务。\n\n### 任务 A：理论推导\n\n本节从基本原理出发，阐述所要求的推导。\n\n**1. 均方误差的分解**\n\n我们被要求推导均方根误差的平方 $\\mathrm{RMSE}^2$ 的分解式，用偏差 $b$ 和随机误差分量 $\\eta_t$ 来表示。\n\n提供的核心定义如下：\n- 预报误差：$e_t = f_t - o_t$\n- 误差分解：$e_t = b + \\eta_t$，其中 $b$ 是一个常数系统性偏差，$\\eta_t$ 是一个随机分量，其期望值 $E[\\eta_t] = 0$。\n- 偏差：$b = E[e_t]$\n- 均方根误差：$\\mathrm{RMSE} = \\sqrt{E[e_t^2]}$\n\n根据 $\\mathrm{RMSE}$ 的定义，我们有 $\\mathrm{RMSE}^2 = E[e_t^2]$。我们将误差分解式 $e_t = b + \\eta_t$ 代入此表达式中：\n$$\n\\mathrm{RMSE}^2 = E[(b + \\eta_t)^2]\n$$\n在期望算子内展开平方项：\n$$\n\\mathrm{RMSE}^2 = E[b^2 + 2b\\eta_t + \\eta_t^2]\n$$\n根据期望算子的线性性质，我们可以将各项分开：\n$$\n\\mathrm{RMSE}^2 = E[b^2] + E[2b\\eta_t] + E[\\eta_t^2]\n$$\n我们逐项分析：\n- 由于 $b$ 是一个常数（系统性偏差），其期望值是它本身，所以 $E[b^2] = b^2$。\n- 对于交叉项，我们可以提出常数 $2b$：$E[2b\\eta_t] = 2b E[\\eta_t]$。根据定义，随机分量 $\\eta_t$ 的均值为零，即 $E[\\eta_t] = 0$。因此，该项为 $2b \\cdot 0 = 0$。\n- 最后一项是 $E[\\eta_t^2]$。这是零均值随机误差分量的均方值。根据定义，该量即为 $\\eta_t$ 的方差，记作 $\\sigma_\\eta^2$。也就是说，$\\sigma_\\eta^2 = \\mathrm{Var}(\\eta_t) = E[(\\eta_t - E[\\eta_t])^2] = E[(\\eta_t - 0)^2] = E[\\eta_t^2]$。\n\n将这些结果代回方程，我们得到分解式：\n$$\n\\mathrm{RMSE}^2 = b^2 + \\sigma_\\eta^2\n$$\n这一基本结果表明，均方误差是偏差的平方与随机误差的方差之和。因此，衡量随机分量 $\\eta_t$ 的指标是其方差 $\\sigma_\\eta^2$。\n\n**2. 距平相关对加性偏差的不敏感性**\n\n我们必须解释为什么距平相关（$\\mathrm{AC}$）对预报中的加性常数偏差不敏感。\n\n设原始预报为 $f_t$。预报距平为 $a_t^{(f)} = f_t - c_t$，其中 $c_t$ 是气候态。\n现在，考虑一个有偏差的预报 $f'_t$，它相对于原始预报有一个常数加性偏差 $\\delta$：\n$$\nf'_t = f_t + \\delta\n$$\n新的预报距平 $a_t^{(f')}$ 为：\n$$\na_t^{(f')} = f'_t - c_t = (f_t + \\delta) - c_t = (f_t - c_t) + \\delta = a_t^{(f)} + \\delta\n$$\n观测距平 $a_t^{(o)} = o_t - c_t$ 不受影响。\n\n距平相关定义为预报和观测距平之间的 Pearson 相关系数。两个变量 $X$ 和 $Y$ 的 Pearson 相关系数定义为：\n$$\n\\rho_{X,Y} = \\frac{\\mathrm{Cov}(X,Y)}{\\sigma_X \\sigma_Y}\n$$\n其中 $\\mathrm{Cov}(X,Y)$ 是 $X$ 和 $Y$ 的协方差，$\\sigma_X$ 和 $\\sigma_Y$ 是它们各自的标准差。\n\nPearson 相关系数的一个关键特性是它在变量各自进行线性变换下的不变性。具体来说，对于常数 $k_1, m_1, k_2, m_2$ 且 $k_1 k_2  0$，有 $\\rho(k_1 X + m_1, k_2 Y + m_2) = \\rho(X, Y)$。这里，我们将 $a_t^{(f)}$ 变换为 $a_t^{(f')} = a_t^{(f)} + \\delta$，这是一个简单的平移（$k_1=1$, $m_1=\\delta$）。\n\n让我们从协方差和方差的定义来证明这一点：\n- **协方差：**\n  $$\n  \\mathrm{Cov}(a_t^{(f')}, a_t^{(o)}) = \\mathrm{Cov}(a_t^{(f)} + \\delta, a_t^{(o)}) = \\mathrm{Cov}(a_t^{(f)}, a_t^{(o)}) \n  $$\n  此式成立，因为给一个变量加上一个常数不会改变它与另一个变量的协方差，因为协方差是基于与均值的偏差计算的，而均值本身也被平移了相同的常数。\n- **方差：**\n  $$\n  \\mathrm{Var}(a_t^{(f')}) = \\mathrm{Var}(a_t^{(f)} + \\delta) = \\mathrm{Var}(a_t^{(f)})\n  $$\n  此式成立，因为方差是衡量离散程度的指标，它对数据的常数平移是不变的。标准差作为方差的平方根，同样保持不变：$\\sigma_{a^{(f')}} = \\sigma_{a^{(f)}}$。\n\n因此，新的距平相关为：\n$$\n\\mathrm{AC'} = \\rho(a_t^{(f')}, a_t^{(o)}) = \\frac{\\mathrm{Cov}(a_t^{(f')}, a_t^{(o)})}{\\sigma_{a^{(f')}} \\sigma_{a^{(o)}}} = \\frac{\\mathrm{Cov}(a_t^{(f)}, a_t^{(o)})}{\\sigma_{a^{(f)}} \\sigma_{a^{(o)}}} = \\rho(a_t^{(f)}, a_t^{(o)}) = \\mathrm{AC}\n$$\n因此，距平相关对预报中的常数加性偏差不敏感。\n\n### 任务 B 和 C：估计流程与实现\n\n该问题要求设计并实现一个流程，从有限样本 $\\{(f_t, o_t, c_t)\\}_{t=1}^{T}$ 中估计定义的各项指标。\n\n**1. 估计公式**\n\n总体期望 $E[\\cdot]$ 被长度为 $T$ 的时间序列上的样本均值所替代。\n\n- 首先为每个时间步 $t$ 计算预报误差序列：$e_t = f_t - o_t$。\n- **偏差估计 ($\\hat{b}$):** 偏差 $b = E[e_t]$ 通过误差的样本均值来估计：\n  $$ \\hat{b} = \\frac{1}{T} \\sum_{t=1}^{T} e_t $$\n- **估计的随机误差 ($\\hat{\\eta}_t$):** 每个时间步的随机误差分量通过从总误差中移除估计的偏差来估计：\n  $$ \\hat{\\eta}_t = e_t - \\hat{b} $$\n- **随机误差均方根估计 ($\\widehat{\\sigma_\\eta}$):** 随机分量的均方根 $\\sigma_\\eta = \\sqrt{E[\\eta_t^2]}$ 通过取估计的随机误差平方的样本均值的平方根来估计：\n  $$ \\widehat{\\sigma_\\eta} = \\sqrt{\\frac{1}{T} \\sum_{t=1}^{T} \\hat{\\eta}_t^2} $$\n- **RMSE 估计 ($\\widehat{\\mathrm{RMSE}}$):** $\\mathrm{RMSE} = \\sqrt{E[e_t^2]}$ 通过取误差平方的样本均值的平方根来估计：\n  $$ \\widehat{\\mathrm{RMSE}} = \\sqrt{\\frac{1}{T} \\sum_{t=1}^{T} e_t^2} $$\n- **分解检验:** 理论恒等式 $\\mathrm{RMSE}^2 = b^2 + \\sigma_\\eta^2$ 对于这些特定的估计量有一个直接的模拟：$\\widehat{\\mathrm{RMSE}}^2 = \\hat{b}^2 + \\widehat{\\sigma_\\eta}^2$。对于所定义的估计量，这是一个代数恒等式，在考虑浮点精度的情况下是精确成立的。该检验通过测试 $|\\widehat{\\mathrm{RMSE}}^2 - (\\hat{b}^2 + \\widehat{\\sigma_\\eta}^2)| \\le \\tau$ 是否成立来执行，其中给定的容差 $\\tau = 10^{-10}$。\n- **距平相关估计 ($\\widehat{\\mathrm{AC}}$):**\n  1. 计算距平序列：$a_t^{(f)} = f_t - c_t$ 和 $a_t^{(o)} = o_t - c_t$。\n  2. 计算 $\\{a_t^{(f)}\\}_{t=1}^T$ 和 $\\{a_t^{(o)}\\}_{t=1}^T$ 之间的样本 Pearson 相关系数。设 $\\overline{a^{(f)}}$ 和 $\\overline{a^{(o)}}$ 为距平序列的样本均值。\n     $$ \\widehat{\\mathrm{AC}} = \\frac{\\sum_{t=1}^{T} (a_t^{(f)} - \\overline{a^{(f)}}) (a_t^{(o)} - \\overline{a^{(o)}})}{\\sqrt{\\sum_{t=1}^{T} (a_t^{(f)} - \\overline{a^{(f)}})^2 \\sum_{t=1}^{T} (a_t^{(o)} - \\overline{a^{(o)}})^2}} $$\n  3. 根据问题规范，如果任一距平序列的样本方差为零（即分母为零），则 $\\widehat{\\mathrm{AC}}$ 定义为 $0$。\n\n**2. 实现方法**\n实现将通过使用 `numpy` 库进行高效的向量化计算，对每个测试用例应用这些估计公式来处理。一个函数将封装处理单个用例的逻辑，主脚本将遍历所有提供的测试用例，格式化结果，并按照指定的输出格式打印它们。",
            "answer": "```python\nimport numpy as np\n\ndef compute_metrics(f_ts, o_ts, c_ts, tolerance=1e-10):\n    \"\"\"\n    Computes forecast verification metrics for a given set of time series.\n\n    Args:\n        f_ts (list or np.ndarray): Time series of forecasts.\n        o_ts (list or np.ndarray): Time series of observations.\n        c_ts (list or np.ndarray): Time series of climatology.\n        tolerance (float): Tolerance for the decomposition check.\n\n    Returns:\n        list: A list containing [b_hat, sigma_eta_hat, rmse_hat, ac_hat, check].\n    \"\"\"\n    # Convert inputs to numpy arrays for vectorized operations\n    f = np.array(f_ts, dtype=float)\n    o = np.array(o_ts, dtype=float)\n    c = np.array(c_ts, dtype=float)\n\n    # 1. Compute error series\n    e = f - o\n\n    # 2. Estimate bias (b_hat)\n    b_hat = np.mean(e)\n\n    # 3. Estimate random error component (eta_hat)\n    eta_hat = e - b_hat\n\n    # 4. Estimate RMS of the random component (sigma_eta_hat)\n    # The problem defines this using the same normalization as RMSE\n    s_eta_sq = np.mean(np.square(eta_hat))\n    sigma_eta_hat = np.sqrt(s_eta_sq)\n\n    # 5. Estimate RMSE (rmse_hat)\n    rmse_sq = np.mean(np.square(e))\n    rmse_hat = np.sqrt(rmse_sq)\n\n    # 6. Perform decomposition check\n    # The identity rmse_hat^2 = b_hat^2 + sigma_eta_hat^2 is algebraic for these estimators.\n    # The check verifies this holds within floating-point tolerance.\n    check = abs(rmse_sq - (b_hat**2 + s_eta_sq)) = tolerance\n\n    # 7. Compute Anomaly Correlation (ac_hat)\n    a_f = f - c\n    a_o = o - c\n\n    # Check for zero variance as specified\n    if np.var(a_f) == 0 or np.var(a_o) == 0:\n        ac_hat = 0.0\n    else:\n        # np.corrcoef returns a correlation matrix. The value is at [0, 1] or [1, 0].\n        ac_hat = np.corrcoef(a_f, a_o)[0, 1]\n    \n    return [b_hat, sigma_eta_hat, rmse_hat, ac_hat, bool(check)]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"o_t\": [289.0, 291.5, 294.2, 296.8, 299.1, 300.3],\n            \"f_t\": [290.3, 293.1, 295.1, 298.6, 300.6, 302.2],\n            \"c_t\": [288.5, 291.0, 293.5, 296.0, 298.5, 300.0]\n        },\n        {\n            \"o_t\": [280.0, 282.0, 284.0, 286.0, 288.0, 290.0],\n            \"f_t\": [280.0, 281.5, 284.5, 285.0, 289.0, 290.0],\n            \"c_t\": [279.0, 281.0, 283.0, 285.0, 287.0, 289.0]\n        },\n        {\n            \"o_t\": [295.0, 296.0, 297.0, 298.0, 299.0, 300.0],\n            \"f_t\": [295.0, 296.0, 297.0, 298.0, 299.0, 300.0],\n            \"c_t\": [294.5, 295.5, 296.5, 297.5, 298.5, 299.5]\n        },\n        {\n            \"o_t\": [285.0, 287.0, 290.0, 292.0, 289.0, 286.0],\n            \"f_t\": [286.0, 287.0, 288.0, 289.0, 290.0, 291.0],\n            \"c_t\": [286.0, 287.0, 288.0, 289.0, 290.0, 291.0]\n        }\n    ]\n\n    results_as_strings = []\n    \n    def format_result(res_list):\n        \"\"\"Formats a single result list into the required string format.\"\"\"\n        # Convert floats to strings, and the boolean to lowercase string 'true'/'false'\n        str_items = [f\"{x:.15g}\" for x in res_list[:-1]]\n        str_items.append(str(res_list[-1]).lower())\n        return f\"[{','.join(str_items)}]\"\n\n    for case in test_cases:\n        result = compute_metrics(case[\"f_t\"], case[\"o_t\"], case[\"c_t\"])\n        results_as_strings.append(format_result(result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "不同的评估指标讲述了预报性能的不同故事。本练习通过一个思想实验，量化了均方根误差（$RMSE$）与平均绝对误差（$MAE$）对极端事件或“离群值”的截然不同的响应。通过推导这两种指标对单个大误差的渐近行为，您将深刻理解它们在惩罚误差方面的内在差异，这对选择合适的指标来评估高影响天气预报至关重要。",
            "id": "4030890",
            "problem": "考虑一个在 $20 \\times 20$ 点的矩形区域格点上的每日 $500$ hPa 位势高度的确定性预报，因此检验样本数为 $n = 400$。设这 $n$ 个样本的确定性预报误差为 $\\{e_i\\}_{i=1}^{n}$，其中 $e_i$ 是样本 $i$ 处预报与检验分析资料之间的差值。均方根误差 (RMSE) 和平均绝对误差 (MAE) 由以下基本聚合定义给出\n$$\\text{RMSE} = \\left(\\frac{1}{n}\\sum_{i=1}^{n} e_i^2\\right)^{1/2}, \\quad \\text{MAE} = \\frac{1}{n}\\sum_{i=1}^{n} |e_i|$$.\n假设在索引 $k$ 处通过单样本扰动引入一个极端离群值，将 $e_k$ 替换为 $e_k + D$，其中 $D$ 是一个标量扰动，其大小远大于所有现有误差，即 $|D| \\gg \\max_i |e_i|$。将由修改后的集合 $\\{e_1,\\dots,e_k + D,\\dots,e_n\\}$ 计算出的受扰后的度量记为 $\\text{RMSE}'$ 和 $\\text{MAE}'$。\n\n从上述定义出发，并且不借助任何预先推导的敏感性公式，推导当 $|D| \\to \\infty$ 时，由该单样本扰动产生的变化量 $\\Delta_{\\text{RMSE}} = \\text{RMSE}' - \\text{RMSE}$ 和 $\\Delta_{\\text{MAE}} = \\text{MAE}' - \\text{MAE}$ 的领头阶渐近表达式。然后，使用这些渐近表达式，确定用 $n$ 表示的渐近比率\n$$\\rho = \\lim_{|D| \\to \\infty} \\frac{\\Delta_{\\text{RMSE}}}{\\Delta_{\\text{MAE}}}$$\n最后，计算当 $n = 400$ 时该比率的值。以单个数字形式提供最终答案。无需四舍五入。",
            "solution": "该问题是适定的、有科学依据且自洽的。在数值天气预报检验的背景下，这是一个有效的应用数学问题。\n\n设初始预报误差集为 $\\{e_i\\}_{i=1}^{n}$。样本数给定为 $n = 20 \\times 20 = 400$。均方根误差 (RMSE) 和平均绝对误差 (MAE) 定义如下：\n$$ \\text{RMSE} = \\left(\\frac{1}{n}\\sum_{i=1}^{n} e_i^2\\right)^{1/2} $$\n$$ \\text{MAE} = \\frac{1}{n}\\sum_{i=1}^{n} |e_i| $$\n\n在索引 $k$ 处引入一个单样本扰动，使得新的误差为 $e_k' = e_k + D$。所有其他误差保持不变，即对于 $i \\neq k$，$e_i' = e_i$。扰动的大小很大，即 $|D| \\gg \\max_i |e_i|$。受扰后的度量记为 $\\text{RMSE}'$ 和 $\\text{MAE}'$。我们需要找到当 $|D| \\to \\infty$ 时，变化量 $\\Delta_{\\text{RMSE}} = \\text{RMSE}' - \\text{RMSE}$ 和 $\\Delta_{\\text{MAE}} = \\text{MAE}' - \\text{MAE}}$ 的领头阶渐近表达式。\n\n首先，我们分析 RMSE 的变化量 $\\Delta_{\\text{RMSE}}$。\n原始的平方和是 $S_2 = \\sum_{i=1}^{n} e_i^2 = n (\\text{RMSE})^2$。\n新的平方和 $S_2'$ 是：\n$$ S_2' = \\sum_{i \\neq k} e_i^2 + (e_k+D)^2 = \\left(\\sum_{i=1}^{n} e_i^2 - e_k^2\\right) + (e_k^2 + 2e_k D + D^2) $$\n$$ S_2' = \\sum_{i=1}^{n} e_i^2 + 2e_k D + D^2 = S_2 + 2e_k D + D^2 $$\n受扰后的 RMSE 是：\n$$ \\text{RMSE}' = \\left(\\frac{S_2'}{n}\\right)^{1/2} = \\left(\\frac{S_2 + 2e_k D + D^2}{n}\\right)^{1/2} $$\n为了找到 $|D|$ 很大时的渐近行为，我们提出因子 $D^2$：\n$$ \\text{RMSE}' = \\left(\\frac{D^2}{n} \\left(1 + \\frac{2e_k}{D} + \\frac{S_2}{D^2}\\right)\\right)^{1/2} = \\frac{|D|}{\\sqrt{n}} \\left(1 + \\frac{2e_k}{D} + \\frac{S_2}{D^2}\\right)^{1/2} $$\n我们对小的 $x$ 使用二项式展开 $(1+x)^{1/2} \\approx 1 + \\frac{1}{2}x$。这里，$x = \\frac{2e_k}{D} + \\frac{S_2}{D^2}$，当 $|D| \\to \\infty$ 时，它趋近于 $0$。\n$$ \\text{RMSE}' \\approx \\frac{|D|}{\\sqrt{n}} \\left(1 + \\frac{1}{2} \\left(\\frac{2e_k}{D} + \\frac{S_2}{D^2}\\right)\\right) = \\frac{|D|}{\\sqrt{n}} \\left(1 + \\frac{e_k}{D} + O\\left(\\frac{1}{D^2}\\right)\\right) $$\n$$ \\text{RMSE}' \\approx \\frac{|D|}{\\sqrt{n}} + \\frac{e_k |D|}{D\\sqrt{n}} = \\frac{|D|}{\\sqrt{n}} + \\frac{e_k \\text{sgn}(D)}{\\sqrt{n}} $$\nRMSE 的变化量是 $\\Delta_{\\text{RMSE}} = \\text{RMSE}' - \\text{RMSE}$。渐近地，\n$$ \\Delta_{\\text{RMSE}} \\approx \\frac{|D|}{\\sqrt{n}} + \\frac{e_k \\text{sgn}(D)}{\\sqrt{n}} - \\text{RMSE} $$\n领头阶项是随 $|D|$ 增长的项。因此，该变化量的领头阶渐近表达式为：\n$$ \\Delta_{\\text{RMSE}} \\sim \\frac{|D|}{\\sqrt{n}} \\quad \\text{as } |D| \\to \\infty $$\n\n接下来，我们分析 MAE 的变化量 $\\Delta_{\\text{MAE}}$。\n原始的绝对值之和是 $S_1 = \\sum_{i=1}^{n} |e_i| = n \\cdot \\text{MAE}$。\n新的绝对值之和 $S_1'$ 是：\n$$ S_1' = \\sum_{i \\neq k} |e_i| + |e_k+D| = \\left(\\sum_{i=1}^{n} |e_i| - |e_k|\\right) + |e_k+D| = S_1 - |e_k| + |e_k+D| $$\n受扰后的 MAE 是：\n$$ \\text{MAE}' = \\frac{S_1'}{n} = \\frac{S_1 - |e_k| + |e_k+D|}{n} $$\nMAE 的变化量是：\n$$ \\Delta_{\\text{MAE}} = \\text{MAE}' - \\text{MAE} = \\frac{S_1 - |e_k| + |e_k+D|}{n} - \\frac{S_1}{n} = \\frac{|e_k+D| - |e_k|}{n} $$\n对于 $|D| \\to \\infty$ 时的渐近行为，我们分析项 $|e_k+D|$。由于 $|D| \\gg |e_k|$，$e_k+D$ 的符号与 $D$ 的符号相同。因此，$\\text{sgn}(e_k+D) = \\text{sgn}(D)$。\n$$ |e_k+D| = (e_k+D)\\text{sgn}(e_k+D) = (e_k+D)\\text{sgn}(D) = e_k\\text{sgn}(D) + D\\text{sgn}(D) = e_k\\text{sgn}(D) + |D| $$\n将此代入 $\\Delta_{\\text{MAE}}$ 的表达式中：\n$$ \\Delta_{\\text{MAE}} = \\frac{1}{n} \\left( |D| + e_k\\text{sgn}(D) - |e_k| \\right) $$\n领头阶项是随 $|D|$ 增长的项。因此，该变化量的领头阶渐近表达式为：\n$$ \\Delta_{\\text{MAE}} \\sim \\frac{|D|}{n} \\quad \\text{as } |D| \\to \\infty $$\n\n现在，我们确定渐近比率 $\\rho$。\n$$ \\rho = \\lim_{|D| \\to \\infty} \\frac{\\Delta_{\\text{RMSE}}}{\\Delta_{\\text{MAE}}} $$\n使用上面推导出的领头阶渐近表达式：\n$$ \\rho = \\lim_{|D| \\to \\infty} \\frac{|D|/\\sqrt{n}}{|D|/n} = \\frac{1/\\sqrt{n}}{1/n} = \\frac{n}{\\sqrt{n}} = \\sqrt{n} $$\n这个结果可以通过对变化量的完整表达式取极限来证实：\n$$ \\rho = \\lim_{|D| \\to \\infty} \\frac{\\left(\\frac{S_2 + 2e_k D + D^2}{n}\\right)^{1/2} - \\text{RMSE}}{\\frac{|e_k+D| - |e_k|}{n}} $$\n将分子和分母同除以 $|D|$：\n$$ \\rho = \\lim_{|D| \\to \\infty} \\frac{\\frac{1}{|D|}\\left(\\frac{|D|}{\\sqrt{n}}\\left(1 + \\frac{2e_k}{D} + \\frac{S_2}{D^2}\\right)^{1/2} - \\text{RMSE}\\right)}{\\frac{1}{|D|}\\left(\\frac{|D| + e_k\\text{sgn}(D) - |e_k|}{n}\\right)} $$\n$$ \\rho = \\lim_{|D| \\to \\infty} \\frac{\\frac{1}{\\sqrt{n}}\\left(1 + \\frac{2e_k}{D} + \\frac{S_2}{D^2}\\right)^{1/2} - \\frac{\\text{RMSE}}{|D|}}{\\frac{1}{n}\\left(1 + \\frac{e_k\\text{sgn}(D)}{|D|} - \\frac{|e_k|}{|D|}\\right)} $$\n当 $|D| \\to \\infty$ 时，像 $1/D$ 和 $1/|D|$ 这样的项趋于 $0$。\n$$ \\rho = \\frac{\\frac{1}{\\sqrt{n}}(1)^{1/2} - 0}{\\frac{1}{n}(1 + 0 - 0)} = \\frac{1/\\sqrt{n}}{1/n} = \\sqrt{n} $$\n题目指明检验样本数为 $n = 400$。\n将该值代入 $\\rho$ 的表达式中：\n$$ \\rho = \\sqrt{400} = 20 $$",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "预报技巧并非一成不变，它会因大气的混沌特性而随预报时效的增加而衰减。本练习在混沌理论中的误差增长概念与预报检验指标（如$RMSE$和$ACC$）的实际演变之间建立了联系。您将基于一个理想化的指数误差增长模型，推导出这些关键指标如何随时间演化，从而从动力学角度理解可预报性的极限。",
            "id": "4030858",
            "problem": "考虑对一个大尺度大气异常的确定性预报，该预报在预报时效 $t$ 时表示为一个标量随机变量 $f(t)$，旨在预测大气的验证异常 $s(t)$。假设在一个混沌状态下，无穷小扰动以e折时间 $\\tau_{e}$ 指数增长，因此对于足够小的初始误差，预报误差振幅的增长与 $\\exp(t/\\tau_{e})$ 成正比。令预报误差为 $e(t) = f(t) - s(t)$，并假设在所关注的尺度上具有以下物理标准性质：误差是无偏的，$\\mathbb{E}[e(t)] = 0$；误差与真实异常不相关，$\\operatorname{cov}(e(t), s(t)) = 0$；真实异常的方差是平稳的，$\\operatorname{var}(s(t)) = \\sigma_{s}^{2}$；初始误差方差为 $\\operatorname{var}(e(0)) = \\sigma_{e0}^{2}$。在小误差指数增长的假设下，设 $\\operatorname{var}(e(t)) = \\sigma_{e0}^{2} \\exp\\!\\big(2 t/\\tau_{e}\\big)$。\n\n定义均方根误差 (RMSE) 为 $\\mathrm{RMSE}(t) = \\sqrt{\\mathbb{E}\\big[(f(t) - s(t))^{2}\\big]}$，异常相关系数 (ACC) 为 $\\mathrm{ACC}(t) = \\dfrac{\\operatorname{cov}\\big(f(t), s(t)\\big)}{\\sqrt{\\operatorname{var}\\big(f(t)\\big)\\,\\operatorname{var}\\big(s(t)\\big)}}$，其中异常是相对于气候态而言的（假设气候平均值为零，因此异常等于原始值）。从这些定义和误差指数增长的前提出发，推导增加预报时效 $t$ 如何降低 $\\mathrm{ACC}(t)$ 并增加 $\\mathrm{RMSE}(t)$，将两者都用 $\\sigma_{s}$、$\\sigma_{e0}$ 和 $\\tau_{e}$ 表示为闭合形式。\n\n然后，评估以下情景：设 $\\tau_{e} = 2$ 天，$\\sigma_{s} = 60$ 米，$\\sigma_{e0} = 6$ 米。计算当 $\\mathrm{ACC}(t)$ 下降到 $0.8$ 时的预报时效 $t$ 对应的 $\\mathrm{RMSE}(t)$ 值。将您的数值答案四舍五入到四位有效数字。以米为单位表示 $\\mathrm{RMSE}$。",
            "solution": "该问题提法恰当，其科学基础是大气可预报性原理和预报检验。所有必要的数据和定义都已提供，且没有矛盾。\n\n给定条件如下：\n- 预报异常：$f(t)$\n- 验证异常：$s(t)$\n- 预报误差：$e(t) = f(t) - s(t)$\n- 误差增长的e折时间：$\\tau_{e}$\n- 无偏误差：$\\mathbb{E}[e(t)] = 0$\n- 误差与真实异常不相关：$\\operatorname{cov}(e(t), s(t)) = 0$\n- 真实异常的平稳方差：$\\operatorname{var}(s(t)) = \\sigma_{s}^{2}$\n- 初始误差方差：$\\operatorname{var}(e(0)) = \\sigma_{e0}^{2}$\n- 误差方差的指数增长：$\\operatorname{var}(e(t)) = \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})$\n- 均方根误差定义：$\\mathrm{RMSE}(t) = \\sqrt{\\mathbb{E}\\big[(f(t) - s(t))^{2}\\big]}$\n- 异常相关系数定义：$\\mathrm{ACC}(t) = \\dfrac{\\operatorname{cov}\\big(f(t), s(t)\\big)}{\\sqrt{\\operatorname{var}\\big(f(t)\\big)\\,\\operatorname{var}\\big(s(t)\\big)}}$\n\n首先，我们推导均方根误差 $\\mathrm{RMSE}(t)$ 的闭合形式表达式。\n根据定义，$\\mathrm{RMSE}(t) = \\sqrt{\\mathbb{E}\\big[(f(t) - s(t))^{2}\\big]}$。\n期望内的项是预报误差的平方，$e(t)^{2}$。\n$$\n\\mathrm{RMSE}(t) = \\sqrt{\\mathbb{E}\\big[e(t)^{2}\\big]}\n$$\n误差的方差定义为 $\\operatorname{var}(e(t)) = \\mathbb{E}[e(t)^2] - (\\mathbb{E}[e(t)])^2$。\n给定误差是无偏的，即 $\\mathbb{E}[e(t)] = 0$。\n因此，误差的方差简化为 $\\operatorname{var}(e(t)) = \\mathbb{E}[e(t)^2]$。\n这使我们能够用误差方差来表示 $\\mathrm{RMSE}$：\n$$\n\\mathrm{RMSE}(t) = \\sqrt{\\operatorname{var}(e(t))}\n$$\n问题陈述误差方差呈指数增长：$\\operatorname{var}(e(t)) = \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})$。将此代入 $\\mathrm{RMSE}(t)$ 的表达式中：\n$$\n\\mathrm{RMSE}(t) = \\sqrt{\\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})} = \\sigma_{e0} \\exp(t/\\tau_{e})\n$$\n这是 $\\mathrm{RMSE}(t)$ 的闭合形式表达式。它表明 $\\mathrm{RMSE}$ 随预报时效 $t$ 指数增长。\n\n接下来，我们推导异常相关系数 $\\mathrm{ACC}(t)$ 的闭合形式表达式。\n其定义为 $\\mathrm{ACC}(t) = \\dfrac{\\operatorname{cov}\\big(f(t), s(t)\\big)}{\\sqrt{\\operatorname{var}\\big(f(t)\\big)\\,\\operatorname{var}\\big(s(t)\\big)}}$。\n我们需要找出该公式中三项的表达式。\n真实异常的方差给定为 $\\operatorname{var}(s(t)) = \\sigma_{s}^{2}$。\n\n让我们计算分子中的协方差 $\\operatorname{cov}(f(t), s(t))$。使用 $f(t) = s(t) + e(t)$：\n$$\n\\operatorname{cov}(f(t), s(t)) = \\operatorname{cov}(s(t) + e(t), s(t))\n$$\n利用协方差算子的线性性质：\n$$\n\\operatorname{cov}(s(t) + e(t), s(t)) = \\operatorname{cov}(s(t), s(t)) + \\operatorname{cov}(e(t), s(t))\n$$\n我们知道 $\\operatorname{cov}(s(t), s(t)) = \\operatorname{var}(s(t)) = \\sigma_{s}^{2}$。我们也被告知误差与真实异常不相关，所以 $\\operatorname{cov}(e(t), s(t)) = 0$。\n因此，分子是：\n$$\n\\operatorname{cov}(f(t), s(t)) = \\sigma_{s}^{2}\n$$\n\n现在，让我们计算分母中预报的方差 $\\operatorname{var}(f(t))$。使用 $f(t) = s(t) + e(t)$：\n$$\n\\operatorname{var}(f(t)) = \\operatorname{var}(s(t) + e(t))\n$$\n两个随机变量之和的方差由 $\\operatorname{var}(X+Y) = \\operatorname{var}(X) + \\operatorname{var}(Y) + 2\\operatorname{cov}(X,Y)$ 给出。\n$$\n\\operatorname{var}(s(t) + e(t)) = \\operatorname{var}(s(t)) + \\operatorname{var}(e(t)) + 2\\operatorname{cov}(s(t), e(t))\n$$\n代入已知量：$\\operatorname{var}(s(t)) = \\sigma_{s}^{2}$，$\\operatorname{var}(e(t)) = \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})$，以及 $\\operatorname{cov}(s(t), e(t)) = 0$。\n$$\n\\operatorname{var}(f(t)) = \\sigma_{s}^{2} + \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})\n$$\n\n现在我们组合出 $\\mathrm{ACC}(t)$ 的完整表达式：\n$$\n\\mathrm{ACC}(t) = \\frac{\\sigma_{s}^{2}}{\\sqrt{\\left(\\sigma_{s}^{2} + \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})\\right) \\sigma_{s}^{2}}}\n$$\n$$\n\\mathrm{ACC}(t) = \\frac{\\sigma_{s}^{2}}{\\sigma_{s} \\sqrt{\\sigma_{s}^{2} + \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})}} = \\frac{\\sigma_{s}}{\\sqrt{\\sigma_{s}^{2} + \\sigma_{e0}^{2} \\exp(2 t/\\tau_{e})}}\n$$\n通过将分子和平方根内的项除以 $\\sigma_{s}$，可以进一步简化此表达式：\n$$\n\\mathrm{ACC}(t) = \\frac{1}{\\sqrt{1 + \\frac{\\sigma_{e0}^{2}}{\\sigma_{s}^{2}} \\exp(2 t/\\tau_{e})}}\n$$\n这是 $\\mathrm{ACC}(t)$ 的闭合形式表达式。它表明 $\\mathrm{ACC}(t)$ 从 $t=0$ 时一个小于1的值（由于初始误差）开始，并随着预报时效 $t$ 的增加而趋向于0。\n\n最后，我们用给定的参数评估该情景：$\\tau_{e} = 2$ 天，$\\sigma_{s} = 60$ 米，以及 $\\sigma_{e0} = 6$ 米。我们需要找出当 $\\mathrm{ACC}(t) = 0.8$ 时，在预报时效 $t$ 对应的 $\\mathrm{RMSE}(t)$ 的值。\n\n首先，我们使用 $\\mathrm{ACC}(t)$ 的表达式求解预报时效 $t$：\n$$\n0.8 = \\frac{1}{\\sqrt{1 + \\left(\\frac{6}{60}\\right)^{2} \\exp\\left(\\frac{2t}{2}\\right)}}\n$$\n$$\n0.8 = \\frac{1}{\\sqrt{1 + (0.1)^{2} \\exp(t)}} = \\frac{1}{\\sqrt{1 + 0.01 \\exp(t)}}\n$$\n为了求解 $t$，我们重新整理方程：\n$$\n\\sqrt{1 + 0.01 \\exp(t)} = \\frac{1}{0.8} = 1.25\n$$\n两边平方：\n$$\n1 + 0.01 \\exp(t) = (1.25)^{2} = 1.5625\n$$\n$$\n0.01 \\exp(t) = 1.5625 - 1 = 0.5625\n$$\n$$\n\\exp(t) = \\frac{0.5625}{0.01} = 56.25\n$$\n这给出了在指定预报时效下 $\\exp(t)$ 的值。我们不需要显式地解出 $t$。\n\n现在，我们使用其推导出的公式计算在此预报时效下的 $\\mathrm{RMSE}(t)$：\n$$\n\\mathrm{RMSE}(t) = \\sigma_{e0} \\exp(t/\\tau_{e}) = 6 \\exp(t/2)\n$$\n我们可以将 $\\exp(t/2)$ 写成 $\\sqrt{\\exp(t)}$。因为我们已经求得 $\\exp(t) = 56.25$：\n$$\n\\exp(t/2) = \\sqrt{56.25} = 7.5\n$$\n将此代回 $\\mathrm{RMSE}(t)$ 的表达式中：\n$$\n\\mathrm{RMSE}(t) = 6 \\times 7.5 = 45\n$$\n在此预报时效下，$\\mathrm{RMSE}$ 的值恰好是 $45$ 米。问题要求答案四舍五入到四位有效数字，即 $45.00$。",
            "answer": "$$\n\\boxed{45.00}\n$$"
        }
    ]
}