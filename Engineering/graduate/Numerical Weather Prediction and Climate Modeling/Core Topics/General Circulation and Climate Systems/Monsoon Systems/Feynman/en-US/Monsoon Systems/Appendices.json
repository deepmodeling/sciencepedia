{
    "hands_on_practices": [
        {
            "introduction": "The Somali Jet is a powerful low-level wind current that is a defining feature of the South Asian summer monsoon. To understand its strength, we can simplify the complex atmospheric motion into a balance between the main forces at play: the pressure-gradient force, the Coriolis force, and friction. This exercise  allows you to derive the jet's speed from these first principles, providing a tangible application of the steady-state momentum equations that are fundamental to geophysical fluid dynamics.",
            "id": "4067863",
            "problem": "In the boreal summer, the low-level Somali Jet is a defining feature of the South Asian monsoon circulation. Consider a horizontally homogeneous, steady, near-surface flow representative of the Somali Jet at about $850\\,\\mathrm{hPa}$, idealized by the horizontal momentum balance\n$$\n\\mathbf{0} \\;=\\; -\\frac{1}{\\rho}\\,\\nabla p \\;-\\; f\\,\\mathbf{k}\\times\\mathbf{u} \\;-\\; C_{d}\\,|\\mathbf{u}|\\,\\mathbf{u},\n$$\nwhere $\\rho$ is air density, $\\nabla p$ is the horizontal pressure gradient, $f$ is the Coriolis parameter, $\\mathbf{k}$ is the upward unit vector, $\\mathbf{u}$ is the horizontal wind, and $C_{d}$ is an effective bulk quadratic drag coefficient representing the vertically integrated effect of surface friction over the planetary boundary layer.\n\nAssume the following scientifically plausible monsoon conditions:\n- A sea-level pressure drop of $\\Delta p = 6.0\\,\\mathrm{hPa}$ across a horizontal distance $L = 1{,}500\\,\\mathrm{km}$ directed due east (positive $x$), so that the pressure gradient vector has magnitude $|\\nabla p| = \\Delta p/L$ and points eastward.\n- Air density $\\rho = 1.0\\,\\mathrm{kg\\,m^{-3}}$ at $850\\,\\mathrm{hPa}$.\n- Latitude $\\varphi = 9^\\circ\\mathrm{N}$; Earth’s rotation rate $\\Omega = 7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$, so $f = 2\\,\\Omega\\,\\sin\\varphi$.\n- A neutral bulk drag coefficient $c_{d} = 1.5\\times 10^{-3}$ and a planetary boundary layer depth $H = 750\\,\\mathrm{m}$, giving $C_{d} = c_{d}/H$.\n\nUnder these assumptions, and taking the pressure-gradient force vector $-\\frac{1}{\\rho}\\nabla p$ to point due east, use the stated balance to derive from first principles an analytic expression for the wind speed magnitude $|\\mathbf{u}|$ and then evaluate it numerically. Round your final wind speed magnitude to three significant figures. Express the speed in $\\mathrm{m\\,s^{-1}}$.",
            "solution": "**Derivation**\n\nWe are asked to solve for the wind speed magnitude $|\\mathbf{u}|$ from the steady-state momentum balance equation:\n$$\n\\mathbf{0} \\;=\\; -\\frac{1}{\\rho}\\,\\nabla p \\;-\\; f\\,\\mathbf{k}\\times\\mathbf{u} \\;-\\; C_{d}\\,|\\mathbf{u}|\\,\\mathbf{u}\n$$\nLet's establish a Cartesian coordinate system where the $\\mathbf{i}$ vector points east (the direction of the pressure-gradient force) and the $\\mathbf{j}$ vector points north. The horizontal wind vector is $\\mathbf{u} = u\\,\\mathbf{i} + v\\,\\mathbf{j}$, and its magnitude is $|\\mathbf{u}|$. The upward unit vector is $\\mathbf{k}$.\n\nThe terms in the equation are:\n1.  Pressure-Gradient Force (PGF): The problem states the PGF vector, $-\\frac{1}{\\rho}\\nabla p$, points due east. Let its magnitude be $G$.\n    $$-\\frac{1}{\\rho}\\nabla p = G\\,\\mathbf{i}, \\quad \\text{where } G = \\frac{|\\nabla p|}{\\rho} = \\frac{\\Delta p/L}{\\rho}$$\n2.  Coriolis Force: The force is $-f\\,\\mathbf{k}\\times\\mathbf{u}$.\n    $$-f\\,\\mathbf{k}\\times(u\\,\\mathbf{i} + v\\,\\mathbf{j}) = -f(u(\\mathbf{k}\\times\\mathbf{i}) + v(\\mathbf{k}\\times\\mathbf{j})) = -f(u\\,\\mathbf{j} - v\\,\\mathbf{i}) = fv\\,\\mathbf{i} - fu\\,\\mathbf{j}$$\n3.  Drag Force: The force is $-C_d\\,|\\mathbf{u}|\\,\\mathbf{u}$.\n    $$-C_d\\,|\\mathbf{u}|(u\\,\\mathbf{i} + v\\,\\mathbf{j}) = -C_d\\,|\\mathbf{u}|u\\,\\mathbf{i} - C_d\\,|\\mathbf{u}|v\\,\\mathbf{j}$$\n\nSubstituting these into the momentum balance equation:\n$$\n\\mathbf{0} = (G\\,\\mathbf{i}) + (fv\\,\\mathbf{i} - fu\\,\\mathbf{j}) + (-C_d\\,|\\mathbf{u}|u\\,\\mathbf{i} - C_d\\,|\\mathbf{u}|v\\,\\mathbf{j})\n$$\nGrouping the $\\mathbf{i}$ and $\\mathbf{j}$ components:\n$$\n\\mathbf{0} = (G + fv - C_d\\,|\\mathbf{u}|u)\\,\\mathbf{i} + (-fu - C_d\\,|\\mathbf{u}|v)\\,\\mathbf{j}\n$$\nFor this vector equation to be true, both scalar components must be zero. This yields a system of two algebraic equations for the wind components $u$ and $v$:\n$$\n(1) \\quad G + fv - C_d\\,|\\mathbf{u}|u = 0 \\\\\n(2) \\quad -fu - C_d\\,|\\mathbf{u}|v = 0\n$$\nFrom equation (2), we can express $v$ in terms of $u$:\n$$\nv = -\\frac{fu}{C_d\\,|\\mathbf{u}|}\n$$\nSubstitute this expression for $v$ into equation (1):\n$$\nG + f\\left(-\\frac{fu}{C_d\\,|\\mathbf{u}|}\\right) - C_d\\,|\\mathbf{u}|u = 0\n$$\n$$\nG - \\frac{f^2 u}{C_d\\,|\\mathbf{u}|} - C_d\\,|\\mathbf{u}|u = 0\n$$\nSolving for $G$:\n$$\nG = u \\left(\\frac{f^2}{C_d\\,|\\mathbf{u}|} + C_d\\,|\\mathbf{u}|\\right) = u \\left(\\frac{f^2 + (C_d\\,|\\mathbf{u}|)^2}{C_d\\,|\\mathbf{u}|}\\right)\n$$\nWe now use the definition of the wind speed magnitude, $|\\mathbf{u}|^2 = u^2 + v^2$. Substitute the expression for $v$:\n$$\n|\\mathbf{u}|^2 = u^2 + \\left(-\\frac{fu}{C_d\\,|\\mathbf{u}|}\\right)^2 = u^2 + \\frac{f^2 u^2}{(C_d\\,|\\mathbf{u}|)^2} = u^2\\left(1 + \\frac{f^2}{(C_d\\,|\\mathbf{u}|)^2}\\right)\n$$\n$$\n|\\mathbf{u}|^2 = u^2\\left(\\frac{(C_d\\,|\\mathbf{u}|)^2 + f^2}{(C_d\\,|\\mathbf{u}|)^2}\\right)\n$$\nLet's now square the expression for $G$:\n$$\nG^2 = u^2 \\left(\\frac{f^2 + (C_d\\,|\\mathbf{u}|)^2}{C_d\\,|\\mathbf{u}|}\\right)^2 = u^2 \\frac{(f^2 + (C_d\\,|\\mathbf{u}|)^2)^2}{(C_d\\,|\\mathbf{u}|)^2}\n$$\nFrom the expression for $|\\mathbf{u}|^2$, we can write $u^2 = |\\mathbf{u}|^2 \\frac{(C_d\\,|\\mathbf{u}|)^2}{(C_d\\,|\\mathbf{u}|)^2 + f^2}$. Substituting this into the equation for $G^2$:\n$$\nG^2 = \\left(|\\mathbf{u}|^2 \\frac{(C_d\\,|\\mathbf{u}|)^2}{(C_d\\,|\\mathbf{u}|)^2 + f^2}\\right) \\frac{(f^2 + (C_d\\,|\\mathbf{u}|)^2)^2}{(C_d\\,|\\mathbf{u}|)^2}\n$$\n$$\nG^2 = |\\mathbf{u}|^2 (f^2 + (C_d\\,|\\mathbf{u}|)^2)\n$$\nLet $S = |\\mathbf{u}|$. The equation for the wind speed magnitude is:\n$$\nG^2 = S^2(f^2 + C_d^2 S^2)\n$$\nThis is a quartic equation for $S$, which can be rearranged into a quadratic equation for $S^2$:\n$$\nC_d^2 S^4 + f^2 S^2 - G^2 = 0\n$$\nLet $X = S^2$. The equation becomes:\n$$\nC_d^2 X^2 + f^2 X - G^2 = 0\n$$\nUsing the quadratic formula $X = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ with $a=C_d^2$, $b=f^2$, and $c=-G^2$:\n$$\nX = \\frac{-f^2 \\pm \\sqrt{(f^2)^2 - 4(C_d^2)(-G^2)}}{2C_d^2} = \\frac{-f^2 \\pm \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}\n$$\nSince $X = S^2$ must be a non-negative real number, we must take the positive root, as $\\sqrt{f^4 + 4C_d^2G^2} > \\sqrt{f^4} = f^2$.\n$$\nS^2 = \\frac{-f^2 + \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}\n$$\nThe analytic expression for the wind speed magnitude is:\n$$\n|\\mathbf{u}| = \\sqrt{\\frac{-f^2 + \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}}\n$$\nNow, we evaluate this expression numerically. First, calculate the parameters in SI units:\n- $\\Delta p = 6.0\\,\\mathrm{hPa} = 6.0 \\times 10^2\\,\\mathrm{Pa}$\n- $L = 1{,}500\\,\\mathrm{km} = 1.5 \\times 10^6\\,\\mathrm{m}$\n- $G = \\frac{\\Delta p / L}{\\rho} = \\frac{(6.0 \\times 10^2\\,\\mathrm{Pa}) / (1.5 \\times 10^6\\,\\mathrm{m})}{1.0\\,\\mathrm{kg\\,m^{-3}}} = \\frac{4.0 \\times 10^{-4}\\,\\mathrm{Pa\\,m^{-1}}}{1.0\\,\\mathrm{kg\\,m^{-3}}} = 4.0 \\times 10^{-4}\\,\\mathrm{m\\,s^{-2}}$\n- $f = 2\\Omega\\sin\\varphi = 2(7.292\\times 10^{-5}\\,\\mathrm{s^{-1}})\\sin(9^\\circ) \\approx 2(7.292\\times 10^{-5})(0.15643) \\approx 2.282 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n- $C_d = \\frac{c_d}{H} = \\frac{1.5\\times 10^{-3}}{750\\,\\mathrm{m}} = 2.0 \\times 10^{-6}\\,\\mathrm{m^{-1}}$\n\nNow we compute the terms needed for the solution:\n- $f^2 \\approx (2.282 \\times 10^{-5})^2 \\approx 5.2075 \\times 10^{-10}\\,\\mathrm{s^{-2}}$\n- $C_d^2 = (2.0 \\times 10^{-6})^2 = 4.0 \\times 10^{-12}\\,\\mathrm{m^{-2}}$\n- $G^2 = (4.0 \\times 10^{-4})^2 = 1.6 \\times 10^{-7}\\,(\\mathrm{m\\,s^{-2}})^2$\n- $f^4 \\approx (5.2075 \\times 10^{-10})^2 \\approx 2.712 \\times 10^{-19}\\,\\mathrm{s^{-4}}$\n- $4C_d^2G^2 = 4(4.0 \\times 10^{-12})(1.6 \\times 10^{-7}) = 2.56 \\times 10^{-18}\\,\\mathrm{s^{-4}}$\n\nSubstitute these into the expression for $S^2 = |\\mathbf{u}|^2$:\n$$\n|\\mathbf{u}|^2 = \\frac{-(5.2075 \\times 10^{-10}) + \\sqrt{(2.712 \\times 10^{-19}) + (2.56 \\times 10^{-18})}}{2(4.0 \\times 10^{-12})}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{-5.2075 \\times 10^{-10} + \\sqrt{2.8312 \\times 10^{-18}}}{8.0 \\times 10^{-12}}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{-5.2075 \\times 10^{-10} + 1.6826 \\times 10^{-9}}{8.0 \\times 10^{-12}}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{1.16185 \\times 10^{-9}}{8.0 \\times 10^{-12}} \\approx 145.23\\,\\mathrm{m^2\\,s^{-2}}\n$$\nFinally, take the square root to find the wind speed magnitude:\n$$\n|\\mathbf{u}| = \\sqrt{145.23} \\approx 12.051\\,\\mathrm{m\\,s^{-1}}\n$$\nRounding to three significant figures as requested, the wind speed is $12.1\\,\\mathrm{m\\,s^{-1}}$.",
            "answer": "$$\\boxed{12.1}$$"
        },
        {
            "introduction": "The lifeblood of the monsoon is its rainfall, which is controlled by the balance of moisture flowing into, out of, and within a region. This practice  introduces the crucial diagnostic technique of moisture budget analysis, governed by the column-integrated water vapor equation, $\\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P$. By quantifying the roles of moisture convergence and surface fluxes, you will learn to assess the physical mechanisms that sustain the monsoon's characteristic wet and dry spells.",
            "id": "4067876",
            "problem": "You are tasked with building a diagnostic program to quantify the role of boundary layer moisture convergence in sustaining intraseasonal wet anomalies of monsoon systems by closing a regional column-integrated humidity budget. The governing budget is the column-integrated water vapor continuity equation, expressed as $\\,\\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P\\,$, where $\\,W\\,$ is the column-integrated water mass per unit area (equivalently, water depth), $\\,\\mathbf{Q}\\,$ is the vertically integrated horizontal moisture flux, $\\,E\\,$ is evaporation, and $\\,P\\,$ is precipitation. All terms must be represented on a regional average basis over an area with negligible lateral flux across the top of the atmosphere and negligible net vertical moisture flux across the tropopause. Assume the intraseasonal anomaly filtering has already been performed, so that $\\,\\partial_t W\\,$ denotes the time tendency of the intraseasonal anomaly.\n\nStarting from the continuity of water substance and the definition of column integrals, the diagnostic relies on the following principles:\n- Column-integrated water $\\,W\\,$ is defined by $\\,W = \\int_{0}^{z_T} \\rho_v(z)\\,dz\\,$, where $\\,\\rho_v\\,$ is water vapor density and $\\,z_T\\,$ is the tropopause height.\n- The column-integrated horizontal moisture flux $\\,\\mathbf{Q}\\,$ is defined by $\\,\\mathbf{Q} = \\int_{0}^{z_T} \\rho_v(z)\\,\\mathbf{v}(z)\\,dz\\,$, where $\\,\\mathbf{v}\\,$ is horizontal wind.\n- Regional budget closure requires the residual $\\,R = \\partial_t W - \\left(-\\nabla\\cdot \\mathbf{Q} + E - P\\right)\\,$ to be small relative to physical variability.\n\nDefine the boundary layer fraction $\\,f_{\\mathrm{BL}}\\in[0,1]\\,$ as the fractional contribution of the boundary layer to the total column moisture convergence. The boundary layer contribution to convergence is $\\,C_{\\mathrm{BL}} = f_{\\mathrm{BL}}\\,C\\,$, where $\\,C = -\\nabla\\cdot \\mathbf{Q}\\,$ is the total column moisture convergence. You must assess whether boundary layer convergence is sustaining a wet intraseasonal anomaly according to the following criterion:\n- A case is classified as “sustained by boundary layer convergence” if $\\,\\partial_t W > 0\\,$, $\\,C_{\\mathrm{BL}} > 0\\,$, the fraction $\\,F = C_{\\mathrm{BL}}/\\partial_t W\\,$ satisfies $\\,F \\ge \\tau\\,$, and the absolute residual $\\,|R|\\,$ is less than or equal to a closure tolerance $\\,\\epsilon\\,$.\n\nAll physical rates must be provided and computed in millimeters per day (mm/day), which is equivalent to kilograms per square meter per day. Angles do not appear in this problem. You must output the following diagnostics for each test case:\n- The boundary layer convergence fraction $\\,F\\,$ as a dimensionless float rounded to three decimals.\n- The absolute budget closure residual $\\,|R|\\,$ in millimeters per day (mm/day), rounded to three decimals.\n- The boolean classification of whether the anomaly is sustained by boundary layer convergence as defined above.\n\nIf $\\,\\partial_t W \\le 0\\,$, define $\\,F = 0\\,$ by convention and classify the case as not sustained.\n\nUse the following thresholds for decision-making:\n- Fraction threshold $\\,\\tau = 0.5\\,$.\n- Closure tolerance $\\,\\epsilon = 0.5\\,$ mm/day.\n\nYour program must use the following test suite of regional intraseasonal anomaly cases, each specified by $\\,\\left(\\partial_t W,\\ \\nabla\\cdot \\mathbf{Q},\\ E,\\ P,\\ f_{\\mathrm{BL}}\\right)\\,$, all in mm/day except $\\,f_{\\mathrm{BL}}\\,$ which is dimensionless:\n- Case $\\,1:$ $\\,\\left(2,\\ -8,\\ 4,\\ 10,\\ 0.6\\right)\\,$.\n- Case $\\,2:$ $\\,\\left(-9,\\ 5,\\ 2,\\ 6,\\ 0.7\\right)\\,$.\n- Case $\\,3:$ $\\,\\left(0,\\ -3,\\ 3,\\ 6,\\ 0.5\\right)\\,$.\n- Case $\\,4:$ $\\,\\left(4,\\ -4,\\ 2,\\ 2,\\ 0.25\\right)\\,$.\n- Case $\\,5:$ $\\,\\left(1,\\ -0.8,\\ 0.6,\\ 0.4,\\ 0.9\\right)\\,$.\n\nFor each case, compute $\\,C = -\\nabla\\cdot \\mathbf{Q}\\,$, $\\,S = E - P\\,$, $\\,R = \\partial_t W - (C + S)\\,$, $\\,C_{\\mathrm{BL}} = f_{\\mathrm{BL}}\\,C\\,$, and $\\,F = C_{\\mathrm{BL}}/\\partial_t W\\,$ (with the convention above when $\\,\\partial_t W \\le 0\\,$). Then apply the sustainment criterion to produce the boolean classification. Express the fraction $\\,F\\,$ as a decimal rounded to three decimals, the absolute residual $\\,|R|\\,$ as a decimal rounded to three decimals in millimeters per day (mm/day), and the classification as a boolean.\n\nYour program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, where each case’s result is itself a list in the form $\\,\\left[F,\\ |R|,\\ \\text{boolean}\\right]\\,$. For example, a valid output format is $\\,\\left[\\left{0.750,0.125,\\text{True}\\right},\\ldots\\right]\\,$.",
            "solution": "The core of this problem is the application of the column-integrated water vapor continuity equation, a fundamental tool for diagnosing atmospheric moisture dynamics. This equation represents a budget for the total water vapor mass in a vertical column of the atmosphere over a given area. It is expressed as:\n$$ \\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P $$\nHere, each term represents a rate of change in units of mass per unit area per unit time, commonly expressed in millimeters per day ($ \\text{mm/day} $), where $1\\,\\text{mm}$ of water depth over a $1\\,\\text{m}^2$ area corresponds to $1\\,\\text{kg}$ of water mass.\n- $ \\partial_t W $: The time rate of change of column-integrated water vapor, also known as precipitable water. A positive value indicates that the atmospheric column is moistening.\n- $ -\\nabla\\cdot \\mathbf{Q} $: The moisture convergence term. It represents the net rate at which water vapor is transported horizontally into the atmospheric column. It is a primary driver of moistening that can lead to convection and precipitation. Here, $ \\mathbf{Q} $ is the vertically integrated horizontal moisture flux, $ \\mathbf{Q} = \\int_{0}^{z_T} \\rho_v(z)\\,\\mathbf{v}(z)\\,dz $, where $ \\rho_v $ is water vapor density, $ \\mathbf{v} $ is horizontal wind, and the integral is from the surface ($z=0$) to the tropopause ($z=z_T$). We define the total column moisture convergence as $ C = -\\nabla\\cdot \\mathbf{Q} $.\n- $ E $: The rate of evaporation from the surface (e.g., oceans, land) into the atmospheric column.\n- $ P $: The rate of precipitation (e.g., rain, snow) out of the atmospheric column. The term $ E - P $ represents the net surface moisture flux.\n\nFor diagnostic purposes, we can rearrange the equation to assess how well the physical forcing terms on the right-hand side explain the observed tendency on the left-hand side. The budget residual, $ R $, is defined as the difference between the observed tendency and the sum of the forcing terms:\n$$ R = \\partial_t W - (-\\nabla\\cdot \\mathbf{Q} + E - P) = \\partial_t W - (C + E - P) $$\nIn an ideal scenario with perfect measurements and model physics, $ R $ would be zero. In practice, a small residual ($ |R| \\le \\epsilon $) indicates that the budget is \"closed\" and our understanding of the dominant processes is robust. For this problem, the closure tolerance is $ \\epsilon = 0.5\\,\\text{mm/day} $.\n\nThe problem requires assessing the role of the atmospheric boundary layer (BL) in this budget. The boundary layer is the lowest part of the atmosphere, most directly influenced by the surface. The boundary layer contribution to moisture convergence, $ C_{\\mathrm{BL}} $, is given as a fraction $ f_{\\mathrm{BL}} $ of the total column convergence:\n$$ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C $$\nTo determine if a wet anomaly (a period of atmospheric moistening, $ \\partial_t W > 0 $) is \"sustained by boundary layer convergence,\" we evaluate a set of specific criteria. The central metric is the fraction $ F $, which quantifies the contribution of boundary layer convergence to the observed moistening:\n$$ F = \\frac{C_{\\mathrm{BL}}}{\\partial_t W} $$\nBy convention, if the atmosphere is not moistening ($ \\partial_t W \\le 0 $), this fraction is defined as $ F=0 $.\n\nThe full criterion for a case to be classified as \"sustained\" is a logical conjunction of four conditions:\n1.  The column must be moistening: $ \\partial_t W > 0 $.\n2.  The boundary layer must be contributing to moisture convergence: $ C_{\\mathrm{BL}} > 0 $.\n3.  The boundary layer convergence contribution must be significant, exceeding a threshold $ \\tau $: $ F \\ge \\tau $, where $ \\tau = 0.5 $.\n4.  The regional moisture budget must be well-closed: $ |R| \\le \\epsilon $, where $ \\epsilon = 0.5\\,\\text{mm/day} $.\n\nWe now apply this diagnostic procedure to each test case. The input data are provided as tuples of $ \\left(\\partial_t W,\\ \\nabla\\cdot \\mathbf{Q},\\ E,\\ P,\\ f_{\\mathrm{BL}}\\right) $.\n\n**Case 1:** $ \\left(2,\\ -8,\\ 4,\\ 10,\\ 0.6\\right) $\n- Total convergence: $ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-8) = 8\\,\\text{mm/day} $.\n- Budget residual: $ R = \\partial_t W - (C + E - P) = 2 - (8 + 4 - 10) = 2 - 2 = 0\\,\\text{mm/day} $. The absolute residual is $ |R| = 0.0\\,\\text{mm/day} $.\n- Boundary layer convergence: $ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.6 \\cdot 8 = 4.8\\,\\text{mm/day} $.\n- Contribution fraction: Since $ \\partial_t W = 2 > 0 $, $ F = C_{\\mathrm{BL}} / \\partial_t W = 4.8 / 2 = 2.4 $.\n- Classification:\n    1. $ \\partial_t W = 2 > 0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 4.8 > 0 $ (True)\n    3. $ F = 2.4 \\ge 0.5 $ (True)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- Result: All conditions are met. The classification is **True**. The output is $ [2.400, 0.000, \\text{True}] $.\n\n**Case 2:** $ \\left(-9,\\ 5,\\ 2,\\ 6,\\ 0.7\\right) $\n- Total convergence: $ C = -(\\nabla\\cdot \\mathbf{Q}) = -(5) = -5\\,\\text{mm/day} $.\n- Budget residual: $ R = \\partial_t W - (C + E - P) = -9 - (-5 + 2 - 6) = -9 - (-9) = 0\\,\\text{mm/day} $. The absolute residual is $ |R| = 0.0\\,\\text{mm/day} $.\n- Because $ \\partial_t W = -9 \\le 0 $, by convention, $ F=0 $. The first condition for sustainment ($ \\partial_t W > 0 $) is not met.\n- Result: The classification is **False**. The output is $ [0.000, 0.000, \\text{False}] $.\n\n**Case 3:** $ \\left(0,\\ -3,\\ 3,\\ 6,\\ 0.5\\right) $\n- Total convergence: $ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-3) = 3\\,\\text{mm/day} $.\n- Budget residual: $ R = \\partial_t W - (C + E - P) = 0 - (3 + 3 - 6) = 0 - 0 = 0\\,\\text{mm/day} $. The absolute residual is $ |R| = 0.0\\,\\text{mm/day} $.\n- Because $ \\partial_t W = 0 \\le 0 $, by convention, $ F=0 $. The first condition for sustainment ($ \\partial_t W > 0 $) is not met.\n- Result: The classification is **False**. The output is $ [0.000, 0.000, \\text{False}] $.\n\n**Case 4:** $ \\left(4,\\ -4,\\ 2,\\ 2,\\ 0.25\\right) $\n- Total convergence: $ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-4) = 4\\,\\text{mm/day} $.\n- Budget residual: $ R = \\partial_t W - (C + E - P) = 4 - (4 + 2 - 2) = 4 - 4 = 0\\,\\text{mm/day} $. The absolute residual is $ |R| = 0.0\\,\\text{mm/day} $.\n- Boundary layer convergence: $ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.25 \\cdot 4 = 1.0\\,\\text{mm/day} $.\n- Contribution fraction: Since $ \\partial_t W = 4 > 0 $, $ F = C_{\\mathrm{BL}} / \\partial_t W = 1.0 / 4 = 0.25 $.\n- Classification:\n    1. $ \\partial_t W = 4 > 0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 1.0 > 0 $ (True)\n    3. $ F = 0.25 \\ge 0.5 $ (False)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- Result: Condition 3 is not met. The classification is **False**. The output is $ [0.250, 0.000, \\text{False}] $.\n\n**Case 5:** $ \\left(1,\\ -0.8,\\ 0.6,\\ 0.4,\\ 0.9\\right) $\n- Total convergence: $ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-0.8) = 0.8\\,\\text{mm/day} $.\n- Budget residual: $ R = \\partial_t W - (C + E - P) = 1 - (0.8 + 0.6 - 0.4) = 1 - 1 = 0\\,\\text{mm/day} $. The absolute residual is $ |R| = 0.0\\,\\text{mm/day} $.\n- Boundary layer convergence: $ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.9 \\cdot 0.8 = 0.72\\,\\text{mm/day} $.\n- Contribution fraction: Since $ \\partial_t W = 1 > 0 $, $ F = C_{\\mathrm{BL}} / \\partial_t W = 0.72 / 1 = 0.72 $.\n- Classification:\n    1. $ \\partial_t W = 1 > 0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 0.72 > 0 $ (True)\n    3. $ F = 0.72 \\ge 0.5 $ (True)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- Result: All conditions are met. The classification is **True**. The output is $ [0.720, 0.000, \\text{True}] $.",
            "answer": "[[2.400,0.000,True],[0.000,0.000,False],[0.000,0.000,False],[0.250,0.000,False],[0.720,0.000,True]]"
        },
        {
            "introduction": "The ultimate test of our understanding of monsoon systems lies in our ability to predict them. This final practice  delves into the essential skill of forecast verification, teaching you how to quantitatively evaluate the performance of numerical weather and climate models. You will implement standard metrics for both deterministic and probabilistic skill to assess how well an ensemble forecast captures observed monsoon rainfall anomalies.",
            "id": "4067848",
            "problem": "You are given hindcast ensembles from a coupled atmosphere–ocean model and corresponding observed monsoon seasonal rainfall anomalies, all expressed as seasonal means in millimeters per day. Using first-principles statistical definitions, write a program that computes three skill metrics for each case: the Anomaly Correlation Coefficient (ACC), the Root Mean Square Error (RMSE), and the Continuous Ranked Probability Skill Score (CRPSS), with CRPSS defined relative to a prescribed climatological reference ensemble.\n\nDerivations must start from foundational definitions. Let $t \\in \\{1,\\dots,T\\}$ index seasons, $i \\in \\{1,\\dots,m_t\\}$ index ensemble members, $y_t$ be the observed anomaly for season $t$, and $x_{t,i}$ be the forecast anomaly from ensemble member $i$ for season $t$. Define the ensemble mean for season $t$ as $\\bar{x}_t = \\frac{1}{m_t}\\sum_{i=1}^{m_t} x_{t,i}$. The Anomaly Correlation Coefficient is the Pearson correlation between $\\{\\bar{x}_t\\}_{t=1}^T$ and $\\{y_t\\}_{t=1}^T$, the Root Mean Square Error is $\\sqrt{\\frac{1}{T}\\sum_{t=1}^T (\\bar{x}_t - y_t)^2}$ expressed in millimeters per day, and the Continuous Ranked Probability Score (CRPS) for a finite ensemble and a single observation is given by the identity\n$$\n\\text{CRPS}_t = \\mathbb{E}\\left[|X - y_t|\\right] - \\tfrac{1}{2}\\mathbb{E}\\left[|X - X'|\\right],\n$$\nwhere $X$ and $X'$ are independent draws from the predictive distribution. For a finite ensemble of size $m_t$ with members $\\{x_{t,i}\\}_{i=1}^{m_t}$, this reduces to the exact finite-sample formula\n$$\n\\text{CRPS}_t = \\frac{1}{m_t}\\sum_{i=1}^{m_t} |x_{t,i} - y_t| - \\frac{1}{2 m_t^2}\\sum_{i=1}^{m_t}\\sum_{j=1}^{m_t} |x_{t,i} - x_{t,j}|.\n$$\nDefine the mean CRPS across seasons as $\\overline{\\text{CRPS}} = \\frac{1}{T}\\sum_{t=1}^T \\text{CRPS}_t$. The Continuous Ranked Probability Skill Score relative to a reference forecast is\n$$\n\\text{CRPSS} = 1 - \\frac{\\overline{\\text{CRPS}}_{\\text{forecast}}}{\\overline{\\text{CRPS}}_{\\text{reference}}}.\n$$\n\nImplement these definitions without shortcuts and compute the metrics for each of the following test cases. In all cases, observed anomalies $y_t$ and ensemble members $x_{t,i}$ are seasonal means in millimeters per day. The reference forecast for CRPSS is provided as a fixed climatological ensemble sample for each season.\n\nTest Case $1$ (happy path, moderate skill, $T=4$, $m_t=5$):\n- Observed anomalies: $[\\,1.2,\\,-0.5,\\,0.8,\\,-1.1\\,]$ in millimeters per day.\n- Forecast ensemble per season:\n  - Season $1$: $[\\,1.1,\\,1.4,\\,0.9,\\,1.3,\\,1.0\\,]$\n  - Season $2$: $[\\,{-0.7},\\,{-0.6},\\,{-0.3},\\,{-0.4},\\,{-0.5}\\,]$\n  - Season $3$: $[\\,0.7,\\,1.2,\\,0.3,\\,0.8,\\,0.9\\,]$\n  - Season $4$: $[\\,{-1.2},\\,{-1.1},\\,{-0.8},\\,{-1.4},\\,{-0.9}\\,]$\n- Reference climatological ensemble (used identically for each season): $[\\,{-1.0},\\,{-0.6},\\,{-0.2},\\,0.0,\\,0.3,\\,0.5,\\,0.9,\\,1.1\\,]$\n\nTest Case $2$ (boundary case, perfect deterministic forecasts, $T=4$, $m_t=4$):\n- Observed anomalies: $[\\,0.8,\\,-1.2,\\,0.5,\\,1.0\\,]$ in millimeters per day.\n- Forecast ensemble per season (all members equal to the observation):\n  - Season $1$: $[\\,0.8,\\,0.8,\\,0.8,\\,0.8\\,]$\n  - Season $2$: $[\\,{-1.2},\\,{-1.2},\\,{-1.2},\\,{-1.2}\\,]$\n  - Season $3$: $[\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]$\n  - Season $4$: $[\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,]$\n- Reference climatological ensemble (used identically for each season): $[\\,{-1.0},\\,{-0.6},\\,{-0.2},\\,0.0,\\,0.3,\\,0.5,\\,0.9,\\,1.1\\,]$\n\nTest Case $3$ (edge case, low/no skill, weakly varying ensemble means, $T=5$, $m_t=5$):\n- Observed anomalies: $[\\,0.6,\\,-0.8,\\,1.4,\\,-0.2,\\,0.0\\,]$ in millimeters per day.\n- Forecast ensemble per season (means near zero and chosen to be uncorrelated with $y_t$):\n  - Season $1$: $[\\,{-0.1},\\,0.0,\\,0.3,\\,0.4,\\,{-0.2}\\,]$\n  - Season $2$: $[\\,0.2,\\,{-0.5},\\,0.1,\\,{-0.3},\\,0.0\\,]$\n  - Season $3$: $[\\,0.2,\\,{-0.1},\\,0.0,\\,0.3,\\,{-0.3}\\,]$\n  - Season $4$: $[\\,{-0.4},\\,0.1,\\,0.3,\\,{-0.1},\\,{-0.2}\\,]$\n  - Season $5$: $[\\,0.5,\\,{-0.6},\\,0.1,\\,0.0,\\,{-0.1}\\,]$\n- Reference climatological ensemble (used identically for each season): $[\\,{-1.0},\\,{-0.6},\\,{-0.2},\\,0.0,\\,0.3,\\,0.5,\\,0.9,\\,1.1\\,]$\n\nTest Case $4$ (edge case, single-member ensemble, $T=6$, $m_t=1$):\n- Observed anomalies: $[\\,0.4,\\,-0.9,\\,0.0,\\,1.2,\\,-0.3,\\,0.7\\,]$ in millimeters per day.\n- Forecast ensemble per season (one member each):\n  - Season $1$: $[\\,0.5\\,]$\n  - Season $2$: $[\\,{-0.7}\\,]$\n  - Season $3$: $[\\,{-0.1}\\,]$\n  - Season $4$: $[\\,1.0\\,]$\n  - Season $5$: $[\\,{-0.5}\\,]$\n  - Season $6$: $[\\,0.6\\,]$\n- Reference climatological ensemble (used identically for each season): $[\\,{-1.0},\\,{-0.6},\\,{-0.2},\\,0.0,\\,0.3,\\,0.5,\\,0.9,\\,1.1\\,]$\n\nComputational requirements:\n- Use only the definitions provided to compute each metric. For ACC, compute the Pearson correlation between $\\{\\bar{x}_t\\}$ and $\\{y_t\\}$ using the sample covariance and sample standard deviations. For RMSE, compute $\\sqrt{\\frac{1}{T}\\sum_{t=1}^T (\\bar{x}_t - y_t)^2}$ and express the output in millimeters per day. For CRPSS, compute $\\overline{\\text{CRPS}}$ for both the forecast ensemble and the reference ensemble using the exact finite-ensemble formula and then apply $\\text{CRPSS} = 1 - \\frac{\\overline{\\text{CRPS}}_{\\text{forecast}}}{\\overline{\\text{CRPS}}_{\\text{reference}}}$.\n- All arithmetic must be carried out in double precision. No external inputs are permitted.\n\nOutput specification:\n- For each test case, output a sublist $[\\,\\text{ACC},\\,\\text{RMSE},\\,\\text{CRPSS}\\,]$ where ACC and CRPSS are dimensionless and RMSE is in millimeters per day. Your program should produce a single line of output containing the results as a comma-separated list of these sublists, enclosed in square brackets, for example $[[\\,a_1, r_1, s_1\\,],[\\,a_2, r_2, s_2\\,],\\dots]$. Express all floating-point results with six digits after the decimal point.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\text{result}_1,\\text{result}_2,\\text{result}_3\\,]$), where each $\\text{result}_k$ is itself a sublist $[\\,\\text{ACC},\\,\\text{RMSE},\\,\\text{CRPSS}\\,]$ as specified above.",
            "solution": "The task is to compute three skill metrics from hindcast ensembles and observations of monsoon seasonal anomalies in millimeters per day, adhering to first-principles definitions. We frame the computations by seasons indexed as $t \\in \\{1,\\dots,T\\}$ and ensemble members indexed as $i \\in \\{1,\\dots,m_t\\}$ with observed anomaly $y_t$ and ensemble forecasts $x_{t,i}$, forming the ensemble mean $\\bar{x}_t = \\frac{1}{m_t}\\sum_{i=1}^{m_t} x_{t,i}$ for each season.\n\nAnomaly Correlation Coefficient (ACC):\nBy definition, the Pearson correlation between $\\{\\bar{x}_t\\}$ and $\\{y_t\\}$ is\n$$\n\\text{ACC} = \\frac{\\text{cov}(\\bar{x}, y)}{\\sigma_{\\bar{x}}\\ \\sigma_{y}},\n$$\nwhere $\\text{cov}(\\bar{x}, y)$ is the sample covariance and $\\sigma_{\\bar{x}}$ and $\\sigma_{y}$ are the sample standard deviations. The sample covariance is\n$$\n\\text{cov}(\\bar{x}, y) = \\frac{1}{T}\\sum_{t=1}^T\\left(\\bar{x}_t - \\mu_{\\bar{x}}\\right)\\left(y_t - \\mu_y\\right),\n$$\nwith sample means $\\mu_{\\bar{x}} = \\frac{1}{T}\\sum_{t=1}^T \\bar{x}_t$ and $\\mu_y = \\frac{1}{T}\\sum_{t=1}^T y_t$. The sample standard deviations are\n$$\n\\sigma_{\\bar{x}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^T\\left(\\bar{x}_t - \\mu_{\\bar{x}}\\right)^2},\\quad\n\\sigma_{y} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^T\\left(y_t - \\mu_{y}\\right)^2}.\n$$\nThese definitions correspond to the population version for the given finite $T$ and ensure a well-defined ACC except in degenerate cases where one series is constant (not present in our test suite).\n\nRoot Mean Square Error (RMSE):\nRMSE is defined as\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^T (\\bar{x}_t - y_t)^2},\n$$\nwhich directly quantifies the average magnitude of errors of the ensemble mean relative to observations. Since $y_t$ and $x_{t,i}$ are in millimeters per day, $\\text{RMSE}$ is also in millimeters per day.\n\nContinuous Ranked Probability Score (CRPS) and Continuous Ranked Probability Skill Score (CRPSS):\nThe CRPS for a probabilistic forecast distribution $F_t$ and observation $y_t$ can be defined in terms of integrals of cumulative distribution functions:\n$$\n\\text{CRPS}(F_t, y_t) = \\int_{-\\infty}^{\\infty} \\left(F_t(z) - \\mathbb{1}\\{z \\ge y_t\\}\\right)^2\\,dz,\n$$\nwhere $\\mathbb{1}\\{\\cdot\\}$ is the indicator function. An equivalent expectation identity expresses CRPS as\n$$\n\\text{CRPS}_t = \\mathbb{E}\\left[|X - y_t|\\right] - \\tfrac{1}{2}\\mathbb{E}\\left[|X - X'|\\right],\n$$\nfor independent $X$ and $X'$ drawn from $F_t$. For a finite ensemble of size $m_t$ with predictive sample $\\{x_{t,i}\\}_{i=1}^{m_t}$, the expectations evaluate to the empirical averages, yielding the exact finite-ensemble formula\n$$\n\\text{CRPS}_t = \\frac{1}{m_t}\\sum_{i=1}^{m_t} |x_{t,i} - y_t| - \\frac{1}{2 m_t^2}\\sum_{i=1}^{m_t}\\sum_{j=1}^{m_t} |x_{t,i} - x_{t,j}|.\n$$\nWe then average over seasons to obtain\n$$\n\\overline{\\text{CRPS}}_{\\text{forecast}} = \\frac{1}{T}\\sum_{t=1}^T \\text{CRPS}_t^{\\text{forecast}},\\quad\n\\overline{\\text{CRPS}}_{\\text{reference}} = \\frac{1}{T}\\sum_{t=1}^T \\text{CRPS}_t^{\\text{reference}}.\n$$\nThe skill score relative to the reference is\n$$\n\\text{CRPSS} = 1 - \\frac{\\overline{\\text{CRPS}}_{\\text{forecast}}}{\\overline{\\text{CRPS}}_{\\text{reference}}}.\n$$\nThis definition ensures $\\text{CRPSS} \\in (-\\infty, 1]$ with $\\text{CRPSS} = 1$ for perfect forecasts yielding $\\overline{\\text{CRPS}}_{\\text{forecast}} = 0$ and $\\text{CRPSS} \\approx 0$ when the forecast performs comparably to the reference.\n\nAlgorithmic steps for each test case:\n1. Construct the ensemble mean series $\\{\\bar{x}_t\\}_{t=1}^T$ from the provided ensembles $\\{x_{t,i}\\}$.\n2. Compute $\\text{ACC}$ using the sample covariance and standard deviations as defined above.\n3. Compute $\\text{RMSE}$ using the root mean square formula above, preserving units in millimeters per day.\n4. For each season $t$, compute $\\text{CRPS}_t^{\\text{forecast}}$ using the finite-ensemble formula; compute $\\text{CRPS}_t^{\\text{reference}}$ analogously using the provided reference ensemble for that season.\n5. Average over seasons to obtain $\\overline{\\text{CRPS}}_{\\text{forecast}}$ and $\\overline{\\text{CRPS}}_{\\text{reference}}$; compute $\\text{CRPSS}$ via $1 - \\frac{\\overline{\\text{CRPS}}_{\\text{forecast}}}{\\overline{\\text{CRPS}}_{\\text{reference}}}$.\n6. Format the output as $[[\\,\\text{ACC}_1,\\,\\text{RMSE}_1,\\,\\text{CRPSS}_1\\,],\\dots]$ with six digits after the decimal point for all floating-point values.\n\nScientific realism and consistency:\n- The ensembles are plausible seasonal hindcasts from a coupled atmosphere–ocean model over multiple monsoon seasons, with physically realistic anomaly magnitudes in millimeters per day.\n- The reference ensemble represents a fixed climatological distribution reused per season, appropriate for CRPSS.\n- The test suite covers a typical skill case, a perfect forecast boundary, a low/no skill case, and a single-member ensemble edge case, ensuring robustness of the implementation across diverse scenarios.\n\nThe final program adheres to these definitions, uses double-precision arithmetic through standard numerical arrays, and produces the specified single-line nested list output.",
            "answer": "[[0.999787,0.067823,0.722656],[1.000000,0.000000,1.000000],[-0.046580,0.692257,-0.252994],[0.915579,0.187083,0.730337]]"
        }
    ]
}