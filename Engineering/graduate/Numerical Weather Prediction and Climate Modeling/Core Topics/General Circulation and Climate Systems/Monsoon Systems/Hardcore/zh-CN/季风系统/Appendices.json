{
    "hands_on_practices": [
        {
            "introduction": "索马里急流是南亚季风环流的关键组成部分，它将大量水汽从南半球输送到亚洲大陆。本练习通过一个理想化的动量平衡模型来探究驱动这股强劲气流的核心物理机制。通过平衡压力梯度力、科里奥利力和摩擦力，您将推导出急流风速的表达式，从而加深对行星边界层动力学的理解 ()。",
            "id": "4067863",
            "problem": "在北半球夏季，低空索马里急流是南亚季风环流的一个决定性特征。考虑一个代表约 $850\\,\\mathrm{hPa}$ 索马里急流的水平均匀、稳定、近地表流动，其理想化的水平动量平衡方程为\n$$\n\\mathbf{0} \\;=\\; -\\frac{1}{\\rho}\\,\\nabla p \\;-\\; f\\,\\mathbf{k}\\times\\mathbf{u} \\;-\\; C_{d}\\,|\\mathbf{u}|\\,\\mathbf{u},\n$$\n其中 $\\rho$ 是空气密度，$\\nabla p$ 是水平气压梯度，$f$ 是科里奥利参数，$\\mathbf{k}$ 是向上的单位向量，$\\mathbf{u}$ 是水平风，$C_{d}$ 是一个有效的体积二次拖曳系数，代表表面摩擦在行星边界层上的垂直积分效应。\n\n假设以下科学上合理的季风条件：\n- 在 $L = 1{,}500\\,\\mathrm{km}$ 的水平距离上，气压下降 $\\Delta p = 6.0\\,\\mathrm{hPa}$，方向为正东（$x$ 轴正方向），因此气压梯度向量的大小为 $|\\nabla p| = \\Delta p/L$，方向向东。\n- 在 $850\\,\\mathrm{hPa}$ 处，空气密度 $\\rho = 1.0\\,\\mathrm{kg\\,m^{-3}}$。\n- 纬度 $\\varphi = 9^\\circ\\mathrm{N}$；地球自转速率 $\\Omega = 7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$，因此 $f = 2\\,\\Omega\\,\\sin\\varphi$。\n- 中性体积拖曳系数 $c_{d} = 1.5\\times 10^{-3}$，行星边界层深度 $H = 750\\,\\mathrm{m}$，得出 $C_{d} = c_{d}/H$。\n\n在这些假设下，并设气压梯度力向量 $-\\frac{1}{\\rho}\\nabla p$ 指向正东，请利用所述的平衡关系，从第一性原理推导出风速大小 $|\\mathbf{u}|$ 的解析表达式，然后进行数值计算。将最终的风速大小四舍五入到三位有效数字。以 $\\mathrm{m\\,s^{-1}}$ 为单位表示速度。",
            "solution": "该问题需进行验证。\n\n**步骤1：提取已知条件**\n- 水平动量平衡方程：$\\mathbf{0} \\;=\\; -\\frac{1}{\\rho}\\,\\nabla p \\;-\\; f\\,\\mathbf{k}\\times\\mathbf{u} \\;-\\; C_{d}\\,|\\mathbf{u}|\\,\\mathbf{u}$\n- $\\rho$：空气密度\n- $\\nabla p$：水平气压梯度\n- $f$：科里奥利参数\n- $\\mathbf{k}$：向上单位向量\n- $\\mathbf{u}$：水平风向量\n- $C_{d}$：有效体积二次拖曳系数\n- 气压降：$\\Delta p = 6.0\\,\\mathrm{hPa}$\n- 水平距离：$L = 1{,}500\\,\\mathrm{km}$\n- 气压梯度大小：$|\\nabla p| = \\Delta p/L$\n- 气压梯度方向：正东（x轴正方向）\n- 气压梯度力向量 $-\\frac{1}{\\rho}\\nabla p$ 指向正东。\n- 空气密度：$\\rho = 1.0\\,\\mathrm{kg\\,m^{-3}}$\n- 纬度：$\\varphi = 9^\\circ\\mathrm{N}$\n- 地球自转速率：$\\Omega = 7.292\\times 10^{-5}\\,\\mathrm{s^{-1}}$\n- 科里奥利参数公式：$f = 2\\,\\Omega\\,\\sin\\varphi$\n- 中性体积拖曳系数：$c_{d} = 1.5\\times 10^{-3}$\n- 行星边界层深度：$H = 750\\,\\mathrm{m}$\n- 有效拖曳系数公式：$C_{d} = c_{d}/H$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题描述了一个行星边界层中平衡流的标准教科书模型，其中气压梯度力、科里奥利力和摩擦拖曳力处于平衡状态。该模型在科学上是合理的，并且是地球物理流体动力学的基础。所提供的物理参数（$\\Delta p$、$L$、$\\rho$、$\\varphi$、$c_d$、$H$）对于印度洋上的季风条件是符合实际的。将拖曳项表述为二次方是一种常见且被接受的参数化方法。该问题是自洽的，提供了所有必要的信息。控制方程中所有项的单位都是一致的（加速度，$\\mathrm{m\\,s^{-2}}$），这证实了量纲的齐次性。该问题是适定的，可以导出一个关于风向量分量的可解方程组。\n\n**步骤3：结论与行动**\n该问题被确定为具有科学依据、适定且内部一致。因此，该问题是**有效的**。继续进行求解。\n\n**推导**\n\n我们被要求从稳态动量平衡方程中求解风速大小 $|\\mathbf{u}|$：\n$$\n\\mathbf{0} \\;=\\; -\\frac{1}{\\rho}\\,\\nabla p \\;-\\; f\\,\\mathbf{k}\\times\\mathbf{u} \\;-\\; C_{d}\\,|\\mathbf{u}|\\,\\mathbf{u}\n$$\n我们建立一个笛卡尔坐标系，其中 $\\mathbf{i}$ 向量指向东方（气压梯度力的方向），$\\mathbf{j}$ 向量指向北方。水平风向量为 $\\mathbf{u} = u\\,\\mathbf{i} + v\\,\\mathbf{j}$，其大小为 $|\\mathbf{u}|$。向上的单位向量为 $\\mathbf{k}$。\n\n方程中的各项为：\n1.  气压梯度力（PGF）：问题陈述 PGF 向量 $-\\frac{1}{\\rho}\\nabla p$ 指向正东。设其大小为 $G$。\n    $$-\\frac{1}{\\rho}\\nabla p = G\\,\\mathbf{i}, \\quad \\text{其中 } G = \\frac{|\\nabla p|}{\\rho} = \\frac{\\Delta p/L}{\\rho}$$\n2.  科里奥利力：该力为 $-f\\,\\mathbf{k}\\times\\mathbf{u}$。\n    $$-f\\,\\mathbf{k}\\times(u\\,\\mathbf{i} + v\\,\\mathbf{j}) = -f(u(\\mathbf{k}\\times\\mathbf{i}) + v(\\mathbf{k}\\times\\mathbf{j})) = -f(u\\,\\mathbf{j} - v\\,\\mathbf{i}) = fv\\,\\mathbf{i} - fu\\,\\mathbf{j}$$\n3.  拖曳力：该力为 $-C_d\\,|\\mathbf{u}|\\,\\mathbf{u}$。\n    $$-C_d\\,|\\mathbf{u}|(u\\,\\mathbf{i} + v\\,\\mathbf{j}) = -C_d\\,|\\mathbf{u}|u\\,\\mathbf{i} - C_d\\,|\\mathbf{u}|v\\,\\mathbf{j}$$\n\n将这些代入动量平衡方程：\n$$\n\\mathbf{0} = (G\\,\\mathbf{i}) + (fv\\,\\mathbf{i} - fu\\,\\mathbf{j}) + (-C_d\\,|\\mathbf{u}|u\\,\\mathbf{i} - C_d\\,|\\mathbf{u}|v\\,\\mathbf{j})\n$$\n对 $\\mathbf{i}$ 和 $\\mathbf{j}$ 分量进行分组：\n$$\n\\mathbf{0} = (G + fv - C_d\\,|\\mathbf{u}|u)\\,\\mathbf{i} + (-fu - C_d\\,|\\mathbf{u}|v)\\,\\mathbf{j}\n$$\n为使该向量方程成立，两个标量分量必须都为零。这产生了一个关于风分量 $u$ 和 $v$ 的两个代数方程组：\n$$\n(1) \\quad G + fv - C_d\\,|\\mathbf{u}|u = 0 \\\\\n(2) \\quad -fu - C_d\\,|\\mathbf{u}|v = 0\n$$\n从方程（2）中，我们可以用 $u$ 来表示 $v$：\n$$\nv = -\\frac{fu}{C_d\\,|\\mathbf{u}|}\n$$\n将这个 $v$ 的表达式代入方程（1）：\n$$\nG + f\\left(-\\frac{fu}{C_d\\,|\\mathbf{u}|}\\right) - C_d\\,|\\mathbf{u}|u = 0\n$$\n$$\nG - \\frac{f^2 u}{C_d\\,|\\mathbf{u}|} - C_d\\,|\\mathbf{u}|u = 0\n$$\n求解 $G$：\n$$\nG = u \\left(\\frac{f^2}{C_d\\,|\\mathbf{u}|} + C_d\\,|\\mathbf{u}|\\right) = u \\left(\\frac{f^2 + (C_d\\,|\\mathbf{u}|)^2}{C_d\\,|\\mathbf{u}|}\\right)\n$$\n现在我们使用风速大小的定义 $|\\mathbf{u}|^2 = u^2 + v^2$。代入 $v$ 的表达式：\n$$\n|\\mathbf{u}|^2 = u^2 + \\left(-\\frac{fu}{C_d\\,|\\mathbf{u}|}\\right)^2 = u^2 + \\frac{f^2 u^2}{(C_d\\,|\\mathbf{u}|)^2} = u^2\\left(1 + \\frac{f^2}{(C_d\\,|\\mathbf{u}|)^2}\\right)\n$$\n$$\n|\\mathbf{u}|^2 = u^2\\left(\\frac{(C_d\\,|\\mathbf{u}|)^2 + f^2}{(C_d\\,|\\mathbf{u}|)^2}\\right)\n$$\n现在我们将 $G$ 的表达式平方：\n$$\nG^2 = u^2 \\left(\\frac{f^2 + (C_d\\,|\\mathbf{u}|)^2}{C_d\\,|\\mathbf{u}|}\\right)^2 = u^2 \\frac{(f^2 + (C_d\\,|\\mathbf{u}|)^2)^2}{(C_d\\,|\\mathbf{u}|)^2}\n$$\n从 $|\\mathbf{u}|^2$ 的表达式中，我们可以写出 $u^2 = |\\mathbf{u}|^2 \\frac{(C_d\\,|\\mathbf{u}|)^2}{(C_d\\,|\\mathbf{u}|)^2 + f^2}$。将其代入 $G^2$ 的方程中：\n$$\nG^2 = \\left(|\\mathbf{u}|^2 \\frac{(C_d\\,|\\mathbf{u}|)^2}{(C_d\\,|\\mathbf{u}|)^2 + f^2}\\right) \\frac{(f^2 + (C_d\\,|\\mathbf{u}|)^2)^2}{(C_d\\,|\\mathbf{u}|)^2}\n$$\n$$\nG^2 = |\\mathbf{u}|^2 (f^2 + (C_d\\,|\\mathbf{u}|)^2)\n$$\n设 $S = |\\mathbf{u}|$。风速大小的方程为：\n$$\nG^2 = S^2(f^2 + C_d^2 S^2)\n$$\n这是一个关于 $S$ 的四次方程，可以重新排列成一个关于 $S^2$ 的二次方程：\n$$\nC_d^2 S^4 + f^2 S^2 - G^2 = 0\n$$\n设 $X = S^2$。方程变为：\n$$\nC_d^2 X^2 + f^2 X - G^2 = 0\n$$\n使用二次公式 $X = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a=C_d^2$，$b=f^2$，$c=-G^2$：\n$$\nX = \\frac{-f^2 \\pm \\sqrt{(f^2)^2 - 4(C_d^2)(-G^2)}}{2C_d^2} = \\frac{-f^2 \\pm \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}\n$$\n因为 $X = S^2$ 必须是一个非负实数，我们必须取正根，因为 $\\sqrt{f^4 + 4C_d^2G^2} > \\sqrt{f^4} = f^2$。\n$$\nS^2 = \\frac{-f^2 + \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}\n$$\n风速大小的解析表达式为：\n$$\n|\\mathbf{u}| = \\sqrt{\\frac{-f^2 + \\sqrt{f^4 + 4C_d^2G^2}}{2C_d^2}}\n$$\n现在，我们对这个表达式进行数值计算。首先，计算国际单位制（SI）下的参数：\n- $\\Delta p = 6.0\\,\\mathrm{hPa} = 6.0 \\times 10^2\\,\\mathrm{Pa}$\n- $L = 1{,}500\\,\\mathrm{km} = 1.5 \\times 10^6\\,\\mathrm{m}$\n- $G = \\frac{\\Delta p / L}{\\rho} = \\frac{(6.0 \\times 10^2\\,\\mathrm{Pa}) / (1.5 \\times 10^6\\,\\mathrm{m})}{1.0\\,\\mathrm{kg\\,m^{-3}}} = \\frac{4.0 \\times 10^{-4}\\,\\mathrm{Pa\\,m^{-1}}}{1.0\\,\\mathrm{kg\\,m^{-3}}} = 4.0 \\times 10^{-4}\\,\\mathrm{m\\,s^{-2}}$\n- $f = 2\\Omega\\sin\\varphi = 2(7.292\\times 10^{-5}\\,\\mathrm{s^{-1}})\\sin(9^\\circ) \\approx 2(7.292\\times 10^{-5})(0.15643) \\approx 2.282 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n- $C_d = \\frac{c_d}{H} = \\frac{1.5\\times 10^{-3}}{750\\,\\mathrm{m}} = 2.0 \\times 10^{-6}\\,\\mathrm{m^{-1}}$\n\n现在我们计算求解所需的各项：\n- $f^2 \\approx (2.282 \\times 10^{-5})^2 \\approx 5.2075 \\times 10^{-10}\\,\\mathrm{s^{-2}}$\n- $C_d^2 = (2.0 \\times 10^{-6})^2 = 4.0 \\times 10^{-12}\\,\\mathrm{m^{-2}}$\n- $G^2 = (4.0 \\times 10^{-4})^2 = 1.6 \\times 10^{-7}\\,(\\mathrm{m\\,s^{-2}})^2$\n- $f^4 \\approx (5.2075 \\times 10^{-10})^2 \\approx 2.712 \\times 10^{-19}\\,\\mathrm{s^{-4}}$\n- $4C_d^2G^2 = 4(4.0 \\times 10^{-12})(1.6 \\times 10^{-7}) = 2.56 \\times 10^{-18}\\,\\mathrm{s^{-4}}$\n\n将这些值代入 $S^2 = |\\mathbf{u}|^2$ 的表达式中：\n$$\n|\\mathbf{u}|^2 = \\frac{-(5.2075 \\times 10^{-10}) + \\sqrt{(2.712 \\times 10^{-19}) + (2.56 \\times 10^{-18})}}{2(4.0 \\times 10^{-12})}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{-5.2075 \\times 10^{-10} + \\sqrt{2.8312 \\times 10^{-18}}}{8.0 \\times 10^{-12}}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{-5.2075 \\times 10^{-10} + 1.6826 \\times 10^{-9}}{8.0 \\times 10^{-12}}\n$$\n$$\n|\\mathbf{u}|^2 = \\frac{1.16185 \\times 10^{-9}}{8.0 \\times 10^{-12}} \\approx 145.23\\,\\mathrm{m^2\\,s^{-2}}\n$$\n最后，取平方根求出风速大小：\n$$\n|\\mathbf{u}| = \\sqrt{145.23} \\approx 12.051\\,\\mathrm{m\\,s^{-1}}\n$$\n根据要求四舍五入到三位有效数字，风速为 $12.1\\,\\mathrm{m\\,s^{-1}}$。",
            "answer": "$$\\boxed{12.1}$$"
        },
        {
            "introduction": "当强大的季风气流遇到像喜马拉雅山脉这样的巨大地形时，会发生什么？这个问题的答案对于理解南亚区域气候至关重要。本练习将引导您运用稳定分层的概念，构建并计算一个关键的无量纲参数——弗劳德数 ($Fr$)，以判断气流是被地形阻挡还是能够越过山脉 ()。",
            "id": "4067823",
            "problem": "一股北半球夏季的南亚季风西南低空气流，冲击喜马拉雅山脉的一个二维跨山脉剖面。考虑平均海平面以上 $z=1 \\ \\text{km}$ 到 $z=3 \\ \\text{km}$ 之间的一个上游气层，其特征是平均位温 $\\theta_{0}=312 \\ \\text{K}$，以及均匀的垂直位温梯度 $\\frac{d\\theta}{dz}=3.2 \\ \\text{K km}^{-1}$。有效山脉高度（从上游逆温层底部到山顶测量）为 $H=4.0 \\ \\text{km}$，气层平均的跨山脉风速为 $U=14 \\ \\text{m s}^{-1}$。使用静力原始方程和稳定层结大气中布伦特-维萨拉频率 $N$ 的定义，从第一性原理出发，构建一个有物理意义的无量纲参数，用于比较高度为 $H$ 的层结季风气流越过山脉时的地形平流与浮力恢复力。使用给定数据（$g=9.81 \\ \\text{m s}^{-2}$）计算此参数的值，并将最终的无量纲答案四舍五入到三位有效数字。然后根据以下解释推断预期的流态：“阻塞”（如果参数小于 0.5），“部分阻塞”（如果参数在区间 $[0.5,1)$ 内），或“越过”（如果参数至少为 1）。最终答案只报告该参数的值（无单位）。",
            "solution": "用户要求推导和计算一个用于描述层结气流越过障碍物的无量纲参数。首先对问题进行验证。\n\n### 第1步：提取已知条件\n- 上游气层高度范围：$z=1 \\ \\text{km}$ 至 $z=3 \\ \\text{km}$\n- 平均位温：$\\theta_{0}=312 \\ \\text{K}$\n- 均匀垂直位温梯度：$\\frac{d\\theta}{dz}=3.2 \\ \\text{K km}^{-1}$\n- 有效山脉高度：$H=4.0 \\ \\text{km}$\n- 气层平均跨山脉风速：$U=14 \\ \\text{m s}^{-1}$\n- 重力加速度：$g=9.81 \\ \\text{m s}^{-2}$\n- 任务：构建一个比较平流与浮力的无量纲参数，计算其值，并四舍五入到三位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题是地球物理流体动力学在地形流中的一个经典应用。它使用了标准的物理量（$\\theta$, $g$, $U$, $H$）和概念（静力原始方程、布伦特-维萨拉频率、稳定层结）。所提供的值在季风背景下是物理上现实的。该问题在根本上是合理的。\n- **适定性**：构建和评估所需无量纲参数（弗劳德数的一种形式）的所有必要数据都已提供。要求是明确的。\n- **客观性**：问题以精确、客观、科学的语言陈述。\n\n### 第3步：结论与行动\n该问题具有科学依据、适定且客观。因此被判定为**有效**。将构建一个解答。\n\n任务是从第一性原理出发，构建一个无量纲参数，用以比较层结介质中气流的平流（或惯性）特性与浮力的恢复力。这个参数是弗劳德数的一种形式，专为层结流定制。\n\n首先，我们描述浮力恢复力的特征。在稳定层结的流体中，一个被垂直移动的气块会以一个特征频率振荡，这个频率被称为布伦特-维萨拉频率 $N$。我们从静力原始方程推导其表达式。考虑一个气块，其位温为 $\\theta(z)$，与环境处于平衡状态。如果它在不与周围环境交换热量（绝热地）的情况下被垂直移动了距离 $\\delta z$，其位温保持不变。在新的高度 $z+\\delta z$ 处，环境位温为 $\\theta(z) + \\frac{d\\theta}{dz}\\delta z$。作用在该气块上的单位质量浮力由 $F_b/m = g \\frac{\\theta_{parcel} - \\theta_{env}}{\\theta_{ref}}$ 给出。使用Boussinesq近似，恢复加速度为：\n$$\n\\frac{d^2(\\delta z)}{dt^2} = g \\frac{\\theta(z) - \\left( \\theta(z) + \\frac{d\\theta}{dz}\\delta z \\right)}{\\theta_0} = - \\left( \\frac{g}{\\theta_0}\\frac{d\\theta}{dz} \\right) \\delta z\n$$\n这是简谐振子的方程，$\\frac{d^2(\\delta z)}{dt^2} = -N^2 \\delta z$，其中 $N^2$ 是布伦特-维萨拉频率的平方。\n$$\nN^2 = \\frac{g}{\\theta_0}\\frac{d\\theta}{dz}\n$$\n在此，$\\theta_0$ 是一个参考位温，我们取其为给定的平均值。正的 $\\frac{d\\theta}{dz}$ 表示稳定层结，这导致频率 $N$ 为实数。\n\n接下来，我们通过比较气流的动能与克服浮力将气流抬升越过障碍物所需的势能来构建无量纲参数。\n入射气流的单位质量动能是：\n$$\nKE = \\frac{1}{2}U^2\n$$\n将一个气块克服浮力恢复力垂直抬升距离 $H$ 所做的单位质量的功（即获得的势能）可以通过对力在位移上积分得到：\n$$\nPE = \\int_0^H F_b/m \\, dz' = \\int_0^H N^2 z' \\, dz' = \\frac{1}{2}N^2 H^2\n$$\n这个无量纲参数，我们记为弗劳德数 $Fr$，是特征流速 $U$ 与内重力波的特征速度（与 $NH$ 成正比）之比。一个更直观的推导方法是取动能与势能之比的平方根：\n$$\n\\text{Parameter}^2 = \\frac{KE}{PE} = \\frac{\\frac{1}{2}U^2}{\\frac{1}{2}N^2 H^2} = \\frac{U^2}{N^2 H^2}\n$$\n取平方根得到直接比较速度尺度的有物理意义的参数：\n$$\nFr = \\frac{U}{NH}\n$$\n这个参数，即层结流的弗劳德数，比较了平流速度 $U$ 和速度 $NH$，后者代表了气流克服层结垂直传播的能力。如果 $Fr \\gg 1$，气流有足够的动能越过障碍物。如果 $Fr \\ll 1$，气流缺乏能量而被阻塞。\n\n现在，我们使用给定数据计算这个参数。\n给定的值为：\n$U = 14 \\ \\text{m s}^{-1}$\n$H = 4.0 \\ \\text{km} = 4000 \\ \\text{m}$\n$g = 9.81 \\ \\text{m s}^{-2}$\n$\\theta_0 = 312 \\ \\text{K}$\n$\\frac{d\\theta}{dz} = 3.2 \\ \\text{K km}^{-1}$\n\n首先，我们将位温梯度转换为国际单位制（SI）单位：\n$$\n\\frac{d\\theta}{dz} = 3.2 \\ \\frac{\\text{K}}{\\text{km}} \\times \\frac{1 \\ \\text{km}}{1000 \\ \\text{m}} = 0.0032 \\ \\text{K m}^{-1}\n$$\n接下来，我们计算布伦特-维萨拉频率的平方，$N^2$：\n$$\nN^2 = \\frac{g}{\\theta_0}\\frac{d\\theta}{dz} = \\frac{9.81 \\ \\text{m s}^{-2}}{312 \\ \\text{K}} \\times 0.0032 \\ \\text{K m}^{-1} \\approx 1.00615 \\times 10^{-4} \\ \\text{s}^{-2}\n$$\n然后，我们求出布伦特-维萨拉频率，$N$：\n$$\nN = \\sqrt{1.00615 \\times 10^{-4} \\ \\text{s}^{-2}} \\approx 0.0100307 \\ \\text{s}^{-1}\n$$\n现在，我们可以计算弗劳德数的分母，$NH$：\n$$\nNH = (0.0100307 \\ \\text{s}^{-1}) \\times (4000 \\ \\text{m}) \\approx 40.1228 \\ \\text{m s}^{-1}\n$$\n最后，我们计算弗劳德数 $Fr$：\n$$\nFr = \\frac{U}{NH} = \\frac{14 \\ \\text{m s}^{-1}}{40.1228 \\ \\text{m s}^{-1}} \\approx 0.34893\n$$\n将结果四舍五入到三位有效数字，我们得到 $0.349$。\n根据问题的解释方案，这个值（$0.349  0.5$）对应于“阻塞”流态，即低空流没有足够的动能来克服由地形尺度上的稳定层结所施加的势能垒。",
            "answer": "$$\n\\boxed{0.349}\n$$"
        },
        {
            "introduction": "季风降雨的维持和中断与大气中的水汽收支密切相关。通过诊断水汽收支，我们可以量化驱动季风季节内湿润异常的关键过程。本练习提供了一个实践性的方法，通过分析一个区域的水汽收支方程 ($ \\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P $) 来评估边界层水汽辐合在维持湿润异常中的作用，这是一项分析气候模型和再分析数据的核心技能 ()。",
            "id": "4067876",
            "problem": "您的任务是构建一个诊断程序，通过闭合区域整层积分湿度收支，来量化边界层水汽辐合在维持季风系统季节内湿异常中的作用。控制收支方程为整层积分水汽连续性方程，表示为 $\\,\\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P\\,$，其中 $\\,W\\,$ 是单位面积的整层积分水质量（等效于水深），$\\,\\mathbf{Q}\\,$ 是垂直积分的水平水汽通量，$\\,E\\,$ 是蒸发，$\\,P\\,$ 是降水。所有项都必须表示为区域平均值，该区域在大气层顶的侧向通量可忽略不计，且在对流层顶的净垂直水汽通量可忽略不计。假设季节内异常的滤波已经完成，因此 $\\,\\partial_t W\\,$ 表示季节内异常的时间倾向。\n\n从水物质的连续性和整层积分的定义出发，该诊断依赖于以下原则：\n- 整层积分水 $\\,W\\,$ 定义为 $\\,W = \\int_{0}^{z_T} \\rho_v(z)\\,dz\\,$，其中 $\\,\\rho_v\\,$ 是水汽密度，$\\,z_T\\,$ 是对流层顶高度。\n- 整层积分水平水汽通量 $\\,\\mathbf{Q}\\,$ 定义为 $\\,\\mathbf{Q} = \\int_{0}^{z_T} \\rho_v(z)\\,\\mathbf{v}(z)\\,dz\\,$，其中 $\\,\\mathbf{v}\\,$ 是水平风。\n- 区域收支闭合要求残差 $\\,R = \\partial_t W - \\left(-\\nabla\\cdot \\mathbf{Q} + E - P\\right)\\,$ 相对于物理变率要小。\n\n定义边界层分数 $\\,f_{\\mathrm{BL}}\\in[0,1]\\,$ 为边界层对整层水汽总辐合的贡献分数。边界层对辐合的贡献为 $\\,C_{\\mathrm{BL}} = f_{\\mathrm{BL}}\\,C\\,$，其中 $\\,C = -\\nabla\\cdot \\mathbf{Q}\\,$ 是整层水汽总辐合。您必须根据以下标准评估边界层辐合是否维持了季节内湿异常：\n- 如果 $\\,\\partial_t W  0\\,$、$\\,C_{\\mathrm{BL}}  0\\,$、分数 $\\,F = C_{\\mathrm{BL}}/\\partial_t W\\,$ 满足 $\\,F \\ge \\tau\\,$，且绝对残差 $\\,|R|\\,$ 小于或等于闭合容差 $\\,\\epsilon\\,$，则将一个案例分类为“由边界层辐合维持”。\n\n所有物理速率必须以毫米/天 (mm/day) 为单位提供和计算，这等同于千克/平方米/天。本问题不涉及角度。您必须为每个测试案例输出以下诊断信息：\n- 边界层辐合分数 $\\,F\\,$，作为一个无量纲浮点数，四舍五入到三位小数。\n- 绝对收支闭合残差 $\\,|R|\\,$，单位为毫米/天 (mm/day)，四舍五入到三位小数。\n- 关于异常是否由如上定义的边界层辐合所维持的布尔分类。\n\n如果 $\\,\\partial_t W \\le 0\\,$，则按惯例定义 $\\,F = 0\\,$ 并将案例分类为非维持。\n\n使用以下阈值进行决策：\n- 分数阈值 $\\,\\tau = 0.5\\,$。\n- 闭合容差 $\\,\\epsilon = 0.5\\,$ 毫米/天。\n\n您的程序必须使用以下区域季节内异常案例的测试套件，每个案例由 $\\,\\left(\\partial_t W,\\ \\nabla\\cdot \\mathbf{Q},\\ E,\\ P,\\ f_{\\mathrm{BL}}\\right)\\,$ 指定，除无量纲的 $\\,f_{\\mathrm{BL}}\\,$ 外，所有单位均为毫米/天：\n- 案例 $\\,1:$ $\\,\\left(2,\\ -8,\\ 4,\\ 10,\\ 0.6\\right)\\,$。\n- 案例 $\\,2:$ $\\,\\left(-9,\\ 5,\\ 2,\\ 6,\\ 0.7\\right)\\,$。\n- 案例 $\\,3:$ $\\,\\left(0,\\ -3,\\ 3,\\ 6,\\ 0.5\\right)\\,$。\n- 案例 $\\,4:$ $\\,\\left(4,\\ -4,\\ 2,\\ 2,\\ 0.25\\right)\\,$。\n- 案例 $\\,5:$ $\\,\\left(1,\\ -0.8,\\ 0.6,\\ 0.4,\\ 0.9\\right)\\,$。\n\n对于每个案例，计算 $\\,C = -\\nabla\\cdot \\mathbf{Q}\\,$、$\\,S = E - P\\,$、$\\,R = \\partial_t W - (C + S)\\,$、$\\,C_{\\mathrm{BL}} = f_{\\mathrm{BL}}\\,C\\,$ 和 $\\,F = C_{\\mathrm{BL}}/\\partial_t W\\,$（当 $\\,\\partial_t W \\le 0\\,$ 时使用上述惯例）。然后应用维持标准以产生布尔分类。将分数 $\\,F\\,$ 表示为四舍五入到三位小数的小数，将绝对残差 $\\,|R|\\,$ 表示为单位为毫米/天 (mm/day) 且四舍五入到三位小数的小数，并将分类表示为布尔值。\n\n您的程序应生成一行输出，其中包含所有案例的结果，形式为一个以逗号分隔的列表，并用方括号括起来，每个案例的结果本身是一个形如 $\\,\\left[F,\\ |R|,\\ \\text{boolean}\\right]\\,$ 的列表。例如，一个有效的输出格式是 $\\,\\left[\\left{0.750,0.125,\\text{True}\\right},\\ldots\\right]\\,$。",
            "solution": "该问题已经过验证，被认为是科学合理的、定义明确且客观的。它提出了一个基于大气物理学既定原则的清晰、可形式化的任务。所有必要的数据、定义和约束都已提供，从而可以得出一个唯一且有意义的解。\n\n这个问题的核心是应用整层积分水汽连续性方程，这是诊断大气湿度动态的基本工具。该方程表示在给定区域上空大气垂直柱中总水汽质量的收支。其表达式为：\n$$ \\partial_t W = -\\nabla\\cdot \\mathbf{Q} + E - P $$\n这里，每一项都代表单位面积单位时间内的质量变化率，通常以毫米/天 ($ \\text{mm/day} $) 表示，其中 $1\\,\\text{m}^2$ 区域上 $1\\,\\text{mm}$ 的水深对应 $1\\,\\text{kg}$ 的水质量。\n- $ \\partial_t W $: 整层积分水汽（也称为可降水量）的时间变化率。正值表示大气柱正在增湿。\n- $ -\\nabla\\cdot \\mathbf{Q} $: 水汽辐合项。它代表水汽水平输送到大气柱内的净速率。它是导致对流和降水的增湿主要驱动力。这里，$ \\mathbf{Q} $ 是垂直积分的水平水汽通量，$ \\mathbf{Q} = \\int_{0}^{z_T} \\rho_v(z)\\,\\mathbf{v}(z)\\,dz $，其中 $ \\rho_v $ 是水汽密度，$ \\mathbf{v} $ 是水平风，积分范围从地表（$z=0$）到对流层顶（$z=z_T$）。我们定义整层水汽总辐合为 $ C = -\\nabla\\cdot \\mathbf{Q} $。\n- $ E $: 从地表（如海洋、陆地）蒸发到大气柱的速率。\n- $ P $: 从大气柱中降水（如雨、雪）的速率。$ E - P $ 项代表净地表水汽通量。\n\n出于诊断目的，我们可以重新排列方程，以评估右侧的物理强迫项在多大程度上解释了左侧观测到的倾向。收支残差 $ R $ 定义为观测到的倾向与强迫项总和之间的差：\n$$ R = \\partial_t W - (-\\nabla\\cdot \\mathbf{Q} + E - P) = \\partial_t W - (C + E - P) $$\n在具有完美测量和模型物理的理想情况下，$ R $ 将为零。在实践中，一个小的残差（$ |R| \\le \\epsilon $）表明收支是“闭合的”，并且我们对主导过程的理解是稳健的。对于此问题，闭合容差为 $ \\epsilon = 0.5\\,\\text{mm/day} $。\n\n该问题要求评估大气边界层 (BL) 在此收支中的作用。边界层是大气中受地表直接影响的最低部分。边界层对水汽辐合的贡献 $ C_{\\mathrm{BL}} $ 是整层总辐合的一个分数 $ f_{\\mathrm{BL}} $：\n$$ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C $$\n为了确定一个湿异常（大气增湿期，$ \\partial_t W  0 $）是否“由边界层辐合维持”，我们评估一组特定标准。核心指标是分数 $ F $，它量化了边界层辐合对观测到的增湿的贡献：\n$$ F = \\frac{C_{\\mathrm{BL}}}{\\partial_t W} $$\n按照惯例，如果大气没有增湿（$ \\partial_t W \\le 0 $），则该分数定义为 $ F=0 $。\n\n一个案例被分类为“维持”的完整标准是四个条件的逻辑合取：\n1. 大气柱必须正在增湿：$ \\partial_t W  0 $。\n2. 边界层必须对水汽辐合有贡献：$ C_{\\mathrm{BL}}  0 $。\n3. 边界层辐合的贡献必须是显著的，超过一个阈值 $ \\tau $：$ F \\ge \\tau $，其中 $ \\tau = 0.5 $。\n4. 区域水汽收支必须良好闭合：$ |R| \\le \\epsilon $，其中 $ \\epsilon = 0.5\\,\\text{mm/day} $。\n\n现在我们将此诊断程序应用于每个测试案例。输入数据以 $ \\left(\\partial_t W,\\ \\nabla\\cdot \\mathbf{Q},\\ E,\\ P,\\ f_{\\mathrm{BL}}\\right) $ 元组的形式提供。\n\n**案例 1:** $ \\left(2,\\ -8,\\ 4,\\ 10,\\ 0.6\\right) $\n- 总辐合：$ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-8) = 8\\,\\text{mm/day} $。\n- 收支残差：$ R = \\partial_t W - (C + E - P) = 2 - (8 + 4 - 10) = 2 - 2 = 0\\,\\text{mm/day} $。绝对残差为 $ |R| = 0.0\\,\\text{mm/day} $。\n- 边界层辐合：$ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.6 \\cdot 8 = 4.8\\,\\text{mm/day} $。\n- 贡献分数：由于 $ \\partial_t W = 2  0 $，$ F = C_{\\mathrm{BL}} / \\partial_t W = 4.8 / 2 = 2.4 $。\n- 分类：\n    1. $ \\partial_t W = 2  0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 4.8  0 $ (True)\n    3. $ F = 2.4 \\ge 0.5 $ (True)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- 结果：所有条件均满足。分类为 **True**。输出为 $ [2.400, 0.000, \\text{True}] $。\n\n**案例 2:** $ \\left(-9,\\ 5,\\ 2,\\ 6,\\ 0.7\\right) $\n- 总辐合：$ C = -(\\nabla\\cdot \\mathbf{Q}) = -(5) = -5\\,\\text{mm/day} $。\n- 收支残差：$ R = \\partial_t W - (C + E - P) = -9 - (-5 + 2 - 6) = -9 - (-9) = 0\\,\\text{mm/day} $。绝对残差为 $ |R| = 0.0\\,\\text{mm/day} $。\n- 因为 $ \\partial_t W = -9 \\le 0 $，按惯例，$ F=0 $。维持的第一个条件（$ \\partial_t W  0 $）未满足。\n- 结果：分类为 **False**。输出为 $ [0.000, 0.000, \\text{False}] $。\n\n**案例 3:** $ \\left(0,\\ -3,\\ 3,\\ 6,\\ 0.5\\right) $\n- 总辐合：$ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-3) = 3\\,\\text{mm/day} $。\n- 收支残差：$ R = \\partial_t W - (C + E - P) = 0 - (3 + 3 - 6) = 0 - 0 = 0\\,\\text{mm/day} $。绝对残差为 $ |R| = 0.0\\,\\text{mm/day} $。\n- 因为 $ \\partial_t W = 0 \\le 0 $，按惯例，$ F=0 $。维持的第一个条件（$ \\partial_t W  0 $）未满足。\n- 结果：分类为 **False**。输出为 $ [0.000, 0.000, \\text{False}] $。\n\n**案例 4:** $ \\left(4,\\ -4,\\ 2,\\ 2,\\ 0.25\\right) $\n- 总辐合：$ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-4) = 4\\,\\text{mm/day} $。\n- 收支残差：$ R = \\partial_t W - (C + E - P) = 4 - (4 + 2 - 2) = 4 - 4 = 0\\,\\text{mm/day} $。绝对残差为 $ |R| = 0.0\\,\\text{mm/day} $。\n- 边界层辐合：$ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.25 \\cdot 4 = 1.0\\,\\text{mm/day} $。\n- 贡献分数：由于 $ \\partial_t W = 4  0 $，$ F = C_{\\mathrm{BL}} / \\partial_t W = 1.0 / 4 = 0.25 $。\n- 分类：\n    1. $ \\partial_t W = 4  0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 1.0  0 $ (True)\n    3. $ F = 0.25 \\ge 0.5 $ (False)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- 结果：条件3未满足。分类为 **False**。输出为 $ [0.250, 0.000, \\text{False}] $。\n\n**案例 5:** $ \\left(1,\\ -0.8,\\ 0.6,\\ 0.4,\\ 0.9\\right) $\n- 总辐合：$ C = -(\\nabla\\cdot \\mathbf{Q}) = -(-0.8) = 0.8\\,\\text{mm/day} $。\n- 收支残差：$ R = \\partial_t W - (C + E - P) = 1 - (0.8 + 0.6 - 0.4) = 1 - 1 = 0\\,\\text{mm/day} $。绝对残差为 $ |R| = 0.0\\,\\text{mm/day} $。\n- 边界层辐合：$ C_{\\mathrm{BL}} = f_{\\mathrm{BL}} \\cdot C = 0.9 \\cdot 0.8 = 0.72\\,\\text{mm/day} $。\n- 贡献分数：由于 $ \\partial_t W = 1  0 $，$ F = C_{\\mathrm{BL}} / \\partial_t W = 0.72 / 1 = 0.72 $。\n- 分类：\n    1. $ \\partial_t W = 1  0 $ (True)\n    2. $ C_{\\mathrm{BL}} = 0.72  0 $ (True)\n    3. $ F = 0.72 \\ge 0.5 $ (True)\n    4. $ |R| = 0 \\le 0.5 $ (True)\n- 结果：所有条件均满足。分类为 **True**。输出为 $ [0.720, 0.000, \\text{True}] $。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Computes diagnostics for a regional column-integrated humidity budget\n    to assess the role of boundary layer moisture convergence in sustaining\n    intraseasonal wet anomalies.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (∂tW, ∇·Q, E, P, f_BL)\n    # Units are mm/day, except for f_BL which is dimensionless.\n    test_cases = [\n        (2, -8, 4, 10, 0.6),    # Case 1\n        (-9, 5, 2, 6, 0.7),     # Case 2\n        (0, -3, 3, 6, 0.5),     # Case 3\n        (4, -4, 2, 2, 0.25),    # Case 4\n        (1, -0.8, 0.6, 0.4, 0.9) # Case 5\n    ]\n\n    # Define thresholds for decision-making\n    tau = 0.5  # Fraction threshold for sustainment\n    epsilon = 0.5  # Closure tolerance for the budget residual (mm/day)\n\n    # Store the results for all cases\n    final_results = []\n    \n    for case in test_cases:\n        # Unpack the parameters for the current case\n        dt_W, div_Q, E, P, f_BL = case\n\n        # 1. Calculate Total Column Moisture Convergence, C\n        # C = -∇·Q\n        C = -div_Q\n\n        # 2. Calculate the Budget Residual, R\n        # R = ∂tW - (-∇·Q + E - P) = ∂tW - (C + E - P)\n        R = dt_W - (C + E - P)\n        abs_R = abs(R)\n\n        # 3. Calculate Boundary Layer Moisture Convergence, C_BL\n        # C_BL = f_BL * C\n        C_BL = f_BL * C\n\n        # 4. Calculate Boundary Layer Contribution Fraction, F\n        # Convention: If ∂tW = 0, then F = 0\n        if dt_W > 0:\n            F = C_BL / dt_W\n        else:\n            F = 0.0\n\n        # 5. Apply the Sustainment Criterion\n        # A case is \"sustained\" if all four conditions below are met.\n        cond1 = dt_W > 0\n        cond2 = C_BL > 0\n        cond3 = F >= tau\n        cond4 = abs_R = epsilon\n\n        is_sustained = cond1 and cond2 and cond3 and cond4\n\n        # Append the formatted diagnostics [F, |R|, boolean] to the results list\n        final_results.append((F, abs_R, is_sustained))\n\n    # Format the final output string as specified\n    formatted_results_str = []\n    for F_val, abs_R_val, sustained_val in final_results:\n        # Format floats to three decimal places and create the sublist string\n        formatted_results_str.append(f\"[{F_val:.3f},{abs_R_val:.3f},{sustained_val}]\")\n    \n    # Final print statement in the exact required format.\n    # e.g., [[F1, |R1|, bool1],[F2, |R2|, bool2],...]\n    print(f\"[{','.join(formatted_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}