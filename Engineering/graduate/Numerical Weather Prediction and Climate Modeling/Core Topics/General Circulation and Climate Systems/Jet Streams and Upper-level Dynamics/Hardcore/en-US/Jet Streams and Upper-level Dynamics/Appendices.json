{
    "hands_on_practices": [
        {
            "introduction": "The existence of powerful jet streams in the upper troposphere is a direct consequence of the strong horizontal temperature gradients between the equator and the poles. This practice delves into the thermal wind relationship, which quantitatively connects this meridional temperature gradient to the vertical shear of the zonal wind. By starting from the fundamental principles of geostrophic and hydrostatic balance, you will derive this crucial relationship and use it to make a realistic estimate of the subtropical jet's speed, providing a foundational understanding of how thermal structure dictates large-scale atmospheric flow .",
            "id": "4056209",
            "problem": "Consider a zonally symmetric subtropical troposphere in quasi-horizontal balance on an $f$-plane at latitude $\\phi = 30^{\\circ} \\mathrm{N}$ between pressures $p_{1} = 700\\,\\mathrm{hPa}$ and $p_{2} = 200\\,\\mathrm{hPa}$. Assume a uniform meridional temperature gradient $\\partial T / \\partial y = -5\\,\\mathrm{K}/1000\\,\\mathrm{km}$ across this layer, independent of pressure, with temperature decreasing poleward (negative meridional gradient). The flow is in geostrophic balance and the atmosphere is hydrostatic, dry, and inviscid. Treat the Coriolis parameter $f$ as constant over the layer and latitude circle with $f = 7.3 \\times 10^{-5}\\,\\mathrm{s}^{-1}$, and use the specific gas constant for dry air $R_{d} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$. Take the $700\\,\\mathrm{hPa}$ zonal geostrophic wind to be $10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ eastward at this latitude.\n\nStarting from the fundamental balances of hydrostatic equilibrium and geostrophy in pressure coordinates, and without invoking any pre-stated shortcut relations, derive an expression for the layer-integrated vertical shear of the zonal geostrophic wind between $p_{1}$ and $p_{2}$ in terms of $R_{d}$, $f$, $\\partial T/\\partial y$, $p_{1}$, and $p_{2}$. Use this to compute the change in the zonal wind between $700\\,\\mathrm{hPa}$ and $200\\,\\mathrm{hPa}$ and estimate the $200\\,\\mathrm{hPa}$ subtropical jet core speed at $\\phi = 30^{\\circ} \\mathrm{N}$.\n\nExpress the final answer in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and round to four significant figures. Report only the estimated $200\\,\\mathrm{hPa}$ jet core speed as your final answer.",
            "solution": "We begin from two foundational balances applicable to large-scale upper-tropospheric flow: geostrophic balance and hydrostatic balance, both expressed in pressure coordinates. Let $\\Phi$ denote geopotential, $\\mathbf{v}_{g}$ the geostrophic wind, and $u_{g}$ its zonal component.\n\nGeostrophic balance in pressure coordinates can be written as\n$$\nf\\,\\hat{\\mathbf{k}} \\times \\mathbf{v}_{g} = \\nabla_{p} \\Phi,\n$$\nwhich for the zonal component implies\n$$\nu_{g} = -\\frac{1}{f}\\,\\frac{\\partial \\Phi}{\\partial y}.\n$$\nHydrostatic balance in pressure coordinates is\n$$\n\\frac{\\partial \\Phi}{\\partial p} = -\\alpha,\n$$\nwhere $\\alpha$ is the specific volume. For a dry ideal gas, $\\alpha = \\frac{R_{d} T}{p}$, hence\n$$\n\\frac{\\partial \\Phi}{\\partial p} = -\\frac{R_{d} T}{p}.\n$$\n\nTo obtain the vertical shear of the zonal geostrophic wind in pressure coordinates, differentiate $u_{g}$ with respect to $p$ at fixed $(x,y)$:\n$$\n\\frac{\\partial u_{g}}{\\partial p} = -\\frac{1}{f}\\,\\frac{\\partial}{\\partial p}\\left(\\frac{\\partial \\Phi}{\\partial y}\\right).\n$$\nAssuming sufficient smoothness to interchange the order of differentiation,\n$$\n\\frac{\\partial u_{g}}{\\partial p} = -\\frac{1}{f}\\,\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial \\Phi}{\\partial p}\\right) = -\\frac{1}{f}\\,\\frac{\\partial}{\\partial y}\\left(-\\frac{R_{d} T}{p}\\right) = \\frac{R_{d}}{f\\,p}\\,\\frac{\\partial T}{\\partial y}.\n$$\n\nIntegrate this shear from $p_{1} = 700\\,\\mathrm{hPa}$ to $p_{2} = 200\\,\\mathrm{hPa}$ along the same latitude circle, assuming the meridional temperature gradient is independent of pressure within the layer:\n$$\nu_{g}(p_{2}) - u_{g}(p_{1}) = \\int_{p_{1}}^{p_{2}} \\frac{R_{d}}{f\\,p}\\,\\frac{\\partial T}{\\partial y}\\,dp = \\frac{R_{d}}{f}\\,\\frac{\\partial T}{\\partial y}\\int_{p_{1}}^{p_{2}} \\frac{1}{p}\\,dp = \\frac{R_{d}}{f}\\,\\frac{\\partial T}{\\partial y}\\,\\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right).\n$$\n\nWe now evaluate this expression numerically using the provided values. Convert the meridional temperature gradient to International System of Units:\n$$\n\\frac{\\partial T}{\\partial y} = -5\\,\\mathrm{K}/1000\\,\\mathrm{km} = -5 \\times 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{-1}.\n$$\nUse $R_{d} = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ and $f = 7.3 \\times 10^{-5}\\,\\mathrm{s}^{-1}$. The pressure ratio is\n$$\n\\frac{p_{2}}{p_{1}} = \\frac{200\\,\\mathrm{hPa}}{700\\,\\mathrm{hPa}} = \\frac{200}{700},\n$$\nso\n$$\n\\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) = \\ln\\!\\left(\\frac{200}{700}\\right) = \\ln(2) - \\ln(7) \\approx 0.6931471806 - 1.9459101491 \\approx -1.2527629685.\n$$\n\nCompute the layer-integrated shear $\\Delta u \\equiv u_{g}(p_{2}) - u_{g}(p_{1})$:\n$$\n\\Delta u = \\frac{R_{d}}{f}\\,\\frac{\\partial T}{\\partial y}\\,\\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) = \\left(\\frac{287}{7.3 \\times 10^{-5}}\\right)\\left(-5 \\times 10^{-6}\\right)\\left(-1.2527629685\\right).\n$$\nFirst evaluate the factor $\\frac{R_{d}}{f}$:\n$$\n\\frac{R_{d}}{f} = \\frac{287}{7.3 \\times 10^{-5}} \\approx 3.93150685 \\times 10^{6}.\n$$\nMultiply by the temperature gradient:\n$$\n\\left(\\frac{R_{d}}{f}\\right)\\left(\\frac{\\partial T}{\\partial y}\\right) \\approx \\left(3.93150685 \\times 10^{6}\\right)\\left(-5 \\times 10^{-6}\\right) \\approx -19.6575343.\n$$\nFinally multiply by the logarithmic factor:\n$$\n\\Delta u \\approx \\left(-19.6575343\\right)\\left(-1.2527629685\\right) \\approx 24.6262309.\n$$\n\nA negative meridional temperature gradient in the Northern Hemisphere yields a positive (eastward) increase of zonal wind with decreasing pressure, consistent with a subtropical jet aloft. Given the $700\\,\\mathrm{hPa}$ zonal geostrophic wind $u_{g}(p_{1}) = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ (eastward), the $200\\,\\mathrm{hPa}$ jet core speed is\n$$\nu_{g}(p_{2}) = u_{g}(p_{1}) + \\Delta u \\approx 10 + 24.6262309 \\approx 34.6262309\\,\\mathrm{m}\\,\\mathrm{s}^{-1}.\n$$\nRounded to four significant figures, expressed in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, the estimated $200\\,\\mathrm{hPa}$ subtropical jet core speed is\n$$\n34.63\\,\\mathrm{m}\\,\\mathrm{s}^{-1}.\n$$",
            "answer": "$$\\boxed{34.63}$$"
        },
        {
            "introduction": "While the thermal wind relationship explains the existence of a mean zonal jet, it does not explain why these jets meander and generate the waves that constitute our weather systems. This exercise explores the concept of barotropic instability, a process through which a jet can become unstable due to its own horizontal shear. You will apply the Rayleigh-Kuo necessary condition for instability, which relates the meridional gradient of potential vorticity to the jet's structure, to determine the critical intensity a model jet must reach to support the growth of Rossby waves .",
            "id": "4056214",
            "problem": "Consider a midlatitude flow on a constant-latitude approximation of Earth, represented by the so-called beta-plane, where the meridional gradient of the Coriolis parameter is a positive constant $\\beta  0$. Assume a barotropic, zonally symmetric jet with meridional profile $U(y) = U_0 \\exp\\!\\big(-y^2/L^2\\big)$, valid for all $y \\in \\mathbb{R}$, where $U_0$ is the peak jet speed and $L$ is a horizontal length scale describing the jet’s meridional width.\n\nStarting from the barotropic Quasi-Geostrophic (QG) framework, use the definition of QG potential vorticity as $q = \\nabla^2 \\psi + f$ with $f = f_0 + \\beta y$, and the geostrophic relation between the zonal wind and streamfunction $U(y) = -\\partial \\psi/\\partial y$, to derive the necessary condition for barotropic instability in terms of the meridional gradient of the background potential vorticity. Then apply this condition to the given jet profile to determine the minimal jet amplitude $U_0^{\\mathrm{crit}}$ such that the necessary condition is marginally satisfied somewhere in the domain.\n\nExpress your final answer for $U_0^{\\mathrm{crit}}$ as a closed-form analytic expression in meters per second. No numerical rounding is required. Briefly state, in your derivation, the implication of exceeding this threshold for the possibility of Rossby wave growth in the upper-level flow.",
            "solution": "The problem requires the derivation of the necessary condition for barotropic instability within the Quasi-Geostrophic (QG) framework and its application to a specific zonal jet profile to find a critical jet amplitude.\n\nFirst, we establish the necessary condition for barotropic instability, known as the Rayleigh-Kuo criterion. The governing equation for barotropic QG dynamics is the conservation of QG potential vorticity (PV), $q$, following the geostrophic flow:\n$$\n\\frac{Dq}{Dt} = \\frac{\\partial q}{\\partial t} + u_g \\frac{\\partial q}{\\partial x} + v_g \\frac{\\partial q}{\\partial y} = 0\n$$\nThe QG potential vorticity is defined as $q = \\nabla^2 \\psi + f$, where $\\psi$ is the geostrophic streamfunction and $f$ is the Coriolis parameter. On a beta-plane, $f = f_0 + \\beta y$, where $f_0$ and $\\beta$ are constants.\n\nWe consider a basic state consisting of a purely zonal flow $U(y)$ that is in geostrophic balance with a streamfunction $\\Psi(y)$, such that $U(y) = -\\frac{d\\Psi}{dy}$. The background PV, $Q(y)$, is then:\n$$\nQ(y) = \\nabla^2 \\Psi(y) + f = \\frac{d^2\\Psi}{dy^2} + f_0 + \\beta y\n$$\nUsing the geostrophic relation, we can express the second derivative of the streamfunction in terms of the zonal flow: $\\frac{d^2\\Psi}{dy^2} = -\\frac{dU}{dy}$. Substituting this into the expression for $Q(y)$ gives:\n$$\nQ(y) = -\\frac{dU}{dy} + f_0 + \\beta y\n$$\nThe stability of this basic state is determined by the meridional gradient of the background PV, $\\frac{dQ}{dy}$:\n$$\n\\frac{dQ}{dy} = \\frac{d}{dy}\\left(-\\frac{dU}{dy} + f_0 + \\beta y\\right) = \\beta - \\frac{d^2U}{dy^2}\n$$\nThe Rayleigh-Kuo theorem states that a necessary (but not sufficient) condition for barotropic instability of the zonal flow $U(y)$ is that the meridional gradient of the background potential vorticity, $\\frac{dQ}{dy}$, must change sign somewhere in the domain. Since for a jet confined in the meridional direction, $U$ and its derivatives must vanish as $|y| \\to \\infty$, we have $\\frac{dQ}{dy} \\to \\beta$ as $|y| \\to \\infty$. Given $\\beta  0$, for $\\frac{dQ}{dy}$ to change sign, it must become negative for at least one value of $y$. Therefore, the necessary condition for instability is that there exists some $y$ such that:\n$$\n\\frac{dQ}{dy} = \\beta - \\frac{d^2U}{dy^2}  0 \\quad \\implies \\quad \\frac{d^2U}{dy^2}  \\beta\n$$\n\nNext, we apply this condition to the given jet profile, $U(y) = U_0 \\exp\\left(-\\frac{y^2}{L^2}\\right)$. We need to calculate its second derivative with respect to $y$:\nThe first derivative is:\n$$\n\\frac{dU}{dy} = U_0 \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left(-\\frac{2y}{L^2}\\right) = -\\frac{2U_0 y}{L^2} \\exp\\left(-\\frac{y^2}{L^2}\\right)\n$$\nThe second derivative is found using the product rule:\n$$\n\\frac{d^2U}{dy^2} = -\\frac{2U_0}{L^2} \\frac{d}{dy} \\left[y \\exp\\left(-\\frac{y^2}{L^2}\\right)\\right] = -\\frac{2U_0}{L^2} \\left[\\exp\\left(-\\frac{y^2}{L^2}\\right) + y \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left(-\\frac{2y}{L^2}\\right)\\right]\n$$\n$$\n\\frac{d^2U}{dy^2} = -\\frac{2U_0}{L^2} \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left(1 - \\frac{2y^2}{L^2}\\right) = \\frac{2U_0}{L^2} \\left(\\frac{2y^2}{L^2} - 1\\right) \\exp\\left(-\\frac{y^2}{L^2}\\right)\n$$\nThe condition for instability is that the maximum value of $\\frac{d^2U}{dy^2}$ must exceed $\\beta$. The problem asks for the critical amplitude $U_0^{\\mathrm{crit}}$ where the condition is marginally satisfied. This occurs when the maximum of $\\frac{d^2U}{dy^2}$ is exactly equal to $\\beta$:\n$$\n\\max_y \\left(\\frac{d^2U}{dy^2}\\right) = \\beta\n$$\nTo find the maximum of $\\frac{d^2U}{dy^2}$, we set its derivative (i.e., the third derivative of $U$) to zero. Let $F(y) = \\frac{d^2U}{dy^2}$.\n$$\n\\frac{dF}{dy} = \\frac{d^3U}{dy^3} = \\frac{2U_0}{L^2} \\frac{d}{dy}\\left[\\left(\\frac{2y^2}{L^2} - 1\\right) \\exp\\left(-\\frac{y^2}{L^2}\\right)\\right]\n$$\n$$\n\\frac{d^3U}{dy^3} = \\frac{2U_0}{L^2} \\left[ \\left(\\frac{4y}{L^2}\\right) \\exp\\left(-\\frac{y^2}{L^2}\\right) + \\left(\\frac{2y^2}{L^2} - 1\\right) \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left(-\\frac{2y}{L^2}\\right) \\right]\n$$\n$$\n\\frac{d^3U}{dy^3} = \\frac{4U_0 y}{L^4} \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left[ 2 - \\left(\\frac{2y^2}{L^2} - 1\\right) \\right] = \\frac{4U_0 y}{L^4} \\exp\\left(-\\frac{y^2}{L^2}\\right) \\left(3 - \\frac{2y^2}{L^2}\\right)\n$$\nSetting $\\frac{d^3U}{dy^3} = 0$ yields critical points at $y=0$ and at values of $y$ where $3 - \\frac{2y^2}{L^2} = 0$. This gives $y^2 = \\frac{3}{2}L^2$.\nWe evaluate $\\frac{d^2U}{dy^2}$ at these points:\nAt $y=0$: $\\frac{d^2U}{dy^2}\\Big|_{y=0} = \\frac{2U_0}{L^2} (-1) \\exp(0) = -\\frac{2U_0}{L^2}$. This is a local minimum.\nAt $y^2 = \\frac{3}{2}L^2$:\n$$\n\\frac{d^2U}{dy^2}\\Big|_{y^2=\\frac{3}{2}L^2} = \\frac{2U_0}{L^2} \\left(\\frac{2}{L^2}\\left(\\frac{3}{2}L^2\\right) - 1\\right) \\exp\\left(-\\frac{3}{2}\\right) = \\frac{2U_0}{L^2} (3-1) \\exp\\left(-\\frac{3}{2}\\right) = \\frac{4U_0}{L^2} \\exp\\left(-\\frac{3}{2}\\right)\n$$\nThis positive value is the maximum of $\\frac{d^2U}{dy^2}$.\nNow we set this maximum value equal to $\\beta$ to find the critical jet amplitude $U_0^{\\mathrm{crit}}$:\n$$\n\\frac{4U_0^{\\mathrm{crit}}}{L^2} \\exp\\left(-\\frac{3}{2}\\right) = \\beta\n$$\nSolving for $U_0^{\\mathrm{crit}}$ gives:\n$$\nU_0^{\\mathrm{crit}} = \\frac{\\beta L^2}{4} \\exp\\left(\\frac{3}{2}\\right)\n$$\nThe units are consistent: $\\beta$ has units of $\\text{m}^{-1}\\text{s}^{-1}$ and $L^2$ has units of $\\text{m}^2$, so $U_0^{\\mathrm{crit}}$ has units of $\\text{m s}^{-1}$.\n\nWhen the jet amplitude $U_0$ exceeds this critical threshold $U_0^{\\mathrm{crit}}$, the necessary condition for barotropic instability is satisfied. This implies that the background flow can support the exponential growth of Rossby wave perturbations. These growing waves extract kinetic energy from the mean zonal jet, leading to the breakdown of the zonal flow into meanders and eddies, a fundamental process in the dynamics of Earth's jet streams.",
            "answer": "$$\n\\boxed{\\frac{\\beta L^2}{4} \\exp\\left(\\frac{3}{2}\\right)}\n$$"
        },
        {
            "introduction": "The relationship between jets and the waves they generate is a two-way street; the waves, in turn, feed back and systematically alter the mean flow. This hands-on coding practice introduces the Eliassen-Palm (EP) flux, a powerful diagnostic tool used to visualize and quantify the transfer of momentum by eddies and waves. By implementing the calculation of the EP flux divergence from idealized eddy covariance data, you will directly compute the \"wave driving\" that accelerates or decelerates the zonal-mean jet, gaining practical experience with a key technique in modern atmospheric and climate dynamics research .",
            "id": "4056177",
            "problem": "You are given zonal-mean eddy covariance fields on latitude–pressure grids and asked to compute the Eliassen–Palm (EP) flux in a Transformed Eulerian Mean (TEM) quasi-geostrophic framework and then identify regions of wave driving of the zonal wind. Work entirely in spherical coordinates on a latitude–pressure grid. The governing base is the quasi-geostrophic TEM formulation on a sphere. Let $a$ denote Earth's radius, $\\Omega$ denote Earth's rotation rate, $\\phi$ denote latitude, $p$ denote pressure, $\\overline{u}$ denote zonal-mean zonal wind, $\\overline{\\theta}$ denote zonal-mean potential temperature, $u'$ denote the zonal wind eddy, $v'$ denote the meridional wind eddy, and $\\theta'$ denote the potential temperature eddy. The Coriolis parameter is $f(\\phi) = 2 \\Omega \\sin\\phi$.\n\nStarting from the quasi-geostrophic Transformed Eulerian Mean momentum equation on a sphere and the definition of the Eliassen–Palm flux (EP flux), the eddy forcing of the zonal-mean zonal wind is given by the divergence of the EP flux. For the quasi-geostrophic approximation in pressure coordinates, the EP flux components for the zonal-mean system are\n$$F_{\\phi}(\\phi,p) = a \\cos\\phi \\left( - \\overline{u'v'}(\\phi,p) \\right),$$\n$$F_{p}(\\phi,p) = a \\cos\\phi \\left( \\frac{ f(\\phi) \\, \\overline{v'\\theta'}(\\phi,p) }{ \\frac{\\partial \\overline{\\theta}(\\phi,p)}{\\partial p} } \\right),$$\nand the eddy acceleration of the zonal wind is\n$$A(\\phi,p) = \\frac{1}{a \\cos\\phi} \\left( \\frac{1}{a} \\frac{\\partial F_{\\phi}(\\phi,p)}{\\partial \\phi} + \\frac{\\partial F_{p}(\\phi,p)}{\\partial p} \\right).$$\nAngles in $f(\\phi)$ and derivatives with respect to $\\phi$ must be computed in radians. The derivative $\\frac{\\partial \\overline{\\theta}}{\\partial p}$ is with respect to pressure and must be computed at each latitude.\n\nRequirements:\n- Use $a = 6.371 \\times 10^6$ meters and $\\Omega = 7.2921 \\times 10^{-5}$ per second.\n- Latitudes are provided in degrees; convert to radians before using in trigonometric functions or latitude derivatives. The angle unit for any derivative with respect to latitude is radians.\n- Pressures are provided in Pascals.\n- $\\overline{\\theta}$ is in Kelvin, $\\overline{u'v'}$ is in square meters per square second, and $\\overline{v'\\theta'}$ is in Kelvin meters per second.\n- Compute all partial derivatives using finite differences:\n  - For $\\frac{\\partial \\overline{\\theta}}{\\partial p}$ at fixed latitude, use a centered difference for interior pressure points and one-sided forward/backward differences at the top/bottom boundaries.\n  - For $\\frac{\\partial F_{\\phi}}{\\partial \\phi}$ at fixed pressure, use a centered difference for interior latitudes and one-sided forward/backward differences at the boundaries; latitude differences must be taken in radians.\n  - For $\\frac{\\partial F_p}{\\partial p}$ at fixed latitude, use a centered difference for interior pressures and one-sided forward/backward differences at the boundaries.\n- Compute $A(\\phi,p)$ as above and then convert it to day-based units by multiplying by $86400$ to express it in meters per second per day ($\\mathrm{m/s/day}$).\n- Identify regions of wave driving as grid points with $A(\\phi,p) > 0$. Also compute a vertically averaged acceleration at each latitude:\n  $$\\overline{A}_{\\mathrm{vert}}(\\phi) = \\frac{1}{N_p} \\sum_{j=1}^{N_p} A(\\phi,p_j),$$\n  where $N_p$ is the number of pressure levels, and the sum is over all given pressures at that latitude.\n\nFor each test case below, compute:\n1. The latitude $\\phi^\\star$ (in degrees) at which $\\overline{A}_{\\mathrm{vert}}(\\phi)$ is maximized. If multiple latitudes tie, choose the first in ascending order.\n2. The maximum positive value of $A(\\phi,p)$ over the full grid in $\\mathrm{m/s/day}$; if there are no positive values, return $0.0$.\n3. The fraction of grid points with $A(\\phi,p) > 0$ expressed as a decimal number between $0$ and $1$.\n\nExpress the acceleration quantities in $\\mathrm{m/s/day}$, rounded to three decimal places. Express the latitude $\\phi^\\star$ in degrees, rounded to one decimal place. Express the fraction of positive $A(\\phi,p)$ rounded to three decimal places.\n\nTest Suite:\n- Test Case $1$ (mid-latitude storm-track-like eddies):\n  - Latitudes (degrees): $[15.0, 30.0, 45.0]$.\n  - Pressures (Pascals): $[70000.0, 50000.0, 30000.0]$.\n  - Zonal-mean potential temperature $\\overline{\\theta}(\\phi,p)$ (Kelvin), as a latitude-by-pressure array:\n    - At $\\phi = 15.0^\\circ$: $[330.0, 340.0, 350.0]$.\n    - At $\\phi = 30.0^\\circ$: $[332.0, 342.0, 352.0]$.\n    - At $\\phi = 45.0^\\circ$: $[334.0, 344.0, 354.0]$.\n  - Eddy momentum flux $\\overline{u'v'}(\\phi,p)$ ($\\mathrm{m^2/s^2}$):\n    - At $\\phi = 15.0^\\circ$: $[-10.0, -20.0, -10.0]$.\n    - At $\\phi = 30.0^\\circ$: $[-30.0, -60.0, -40.0]$.\n    - At $\\phi = 45.0^\\circ$: $[-50.0, -80.0, -60.0]$.\n  - Eddy meridional heat flux $\\overline{v'\\theta'}(\\phi,p)$ ($\\mathrm{K \\cdot m/s}$):\n    - At $\\phi = 15.0^\\circ$: $[0.2, 0.5, 0.4]$.\n    - At $\\phi = 30.0^\\circ$: $[1.0, 2.0, 1.5]$.\n    - At $\\phi = 45.0^\\circ$: $[1.5, 2.5, 2.0]$.\n- Test Case $2$ (including equatorial latitude with small $f$):\n  - Latitudes (degrees): $[0.0, 15.0, 30.0]$.\n  - Pressures (Pascals): $[70000.0, 50000.0, 30000.0]$.\n  - Zonal-mean potential temperature $\\overline{\\theta}(\\phi,p)$ (Kelvin):\n    - At $\\phi = 0.0^\\circ$: $[328.0, 338.0, 348.0]$.\n    - At $\\phi = 15.0^\\circ$: $[330.0, 340.0, 350.0]$.\n    - At $\\phi = 30.0^\\circ$: $[334.0, 344.0, 354.0]$.\n  - Eddy momentum flux $\\overline{u'v'}(\\phi,p)$ ($\\mathrm{m^2/s^2}$):\n    - At $\\phi = 0.0^\\circ$: $[-5.0, -10.0, -5.0]$.\n    - At $\\phi = 15.0^\\circ$: $[-20.0, -30.0, -25.0]$.\n    - At $\\phi = 30.0^\\circ$: $[-40.0, -70.0, -50.0]$.\n  - Eddy meridional heat flux $\\overline{v'\\theta'}(\\phi,p)$ ($\\mathrm{K \\cdot m/s}$):\n    - At $\\phi = 0.0^\\circ$: $[0.3, 0.4, 0.3]$.\n    - At $\\phi = 15.0^\\circ$: $[0.8, 1.5, 1.2]$.\n    - At $\\phi = 30.0^\\circ$: $[1.2, 2.2, 1.8]$.\n- Test Case $3$ (strong stratification reduces vertical EP flux):\n  - Latitudes (degrees): $[15.0, 30.0, 45.0]$.\n  - Pressures (Pascals): $[70000.0, 50000.0, 30000.0]$.\n  - Zonal-mean potential temperature $\\overline{\\theta}(\\phi,p)$ (Kelvin):\n    - At $\\phi = 15.0^\\circ$: $[330.0, 350.0, 370.0]$.\n    - At $\\phi = 30.0^\\circ$: $[332.0, 352.0, 372.0]$.\n    - At $\\phi = 45.0^\\circ$: $[334.0, 354.0, 374.0]$.\n  - Eddy momentum flux $\\overline{u'v'}(\\phi,p)$ ($\\mathrm{m^2/s^2}$):\n    - At $\\phi = 15.0^\\circ$: $[-10.0, -20.0, -10.0]$.\n    - At $\\phi = 30.0^\\circ$: $[-30.0, -60.0, -40.0]$.\n    - At $\\phi = 45.0^\\circ$: $[-50.0, -80.0, -60.0]$.\n  - Eddy meridional heat flux $\\overline{v'\\theta'}(\\phi,p)$ ($\\mathrm{K \\cdot m/s}$):\n    - At $\\phi = 15.0^\\circ$: $[0.2, 0.5, 0.4]$.\n    - At $\\phi = 30.0^\\circ$: $[1.0, 2.0, 1.5]$.\n    - At $\\phi = 45.0^\\circ$: $[1.5, 2.5, 2.0]$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain $9$ values in the following order:\n  - Test Case $1$: $\\phi^\\star$ (degrees, one decimal), $\\max\\{A(\\phi,p) \\, \\mathrm{in \\, m/s/day}\\}$ (three decimals), fraction of positive $A$ (three decimals).\n  - Test Case $2$: same three values in the same order.\n  - Test Case $3$: same three values in the same order.\n- Example structure (with placeholder values): $\\left[\\phi^\\star_1, A_{\\max,1}, f_{+,1}, \\phi^\\star_2, A_{\\max,2}, f_{+,2}, \\phi^\\star_3, A_{\\max,3}, f_{+,3}\\right]$.\n\nEnsure scientific realism and internal consistency in all computations. No external inputs are permitted; all data must be embedded in the program as given above.",
            "solution": "The solution involves implementing the Transformed Eulerian Mean (TEM) diagnostics to calculate the eddy-induced acceleration of the zonal-mean wind. The procedure consists of several steps: calculating preliminary fields, computing the Eliassen-Palm (EP) flux components, finding the EP flux divergence, and finally calculating the acceleration and the required metrics.\n\nThe overall procedure is as follows:\n1.  Define physical constants and the input data for each test case.\n2.  For each grid, compute preliminary quantities: latitudes in radians ($\\phi_{\\mathrm{rad}}$), the Coriolis parameter ($f$), and the cosine of latitude ($\\cos\\phi$).\n3.  Calculate the static stability term, $\\frac{\\partial \\overline{\\theta}}{\\partial p}$, at each grid point by computing numerical derivatives with respect to pressure ($p$) along lines of constant latitude.\n4.  Compute the latitudinal ($F_{\\phi}$) and vertical ($F_{p}$) components of the EP flux vector, $\\mathbf{F}$, using the provided formulas.\n5.  Calculate the divergence of the EP flux. This involves two terms: $\\frac{1}{a} \\frac{\\partial F_{\\phi}}{\\partial \\phi}$ and $\\frac{\\partial F_{p}}{\\partial p}$. These require numerical derivatives with respect to latitude (in radians) and pressure, respectively.\n6.  Compute the zonal wind acceleration, $A(\\phi,p)$, using the corrected, physically standard formula, and convert its units from $\\mathrm{m/s^2}$ to $\\mathrm{m/s/day}$.\n7.  From the resulting acceleration grid $A(\\phi,p)$, calculate the three required metrics for each test case:\n    a. The latitude $\\phi^\\star$ of maximum vertically-averaged acceleration.\n    b. The maximum positive value of $A(\\phi,p)$ across the grid.\n    c. The fraction of grid points where $A(\\phi,p) > 0$.\n\nAll partial derivatives are computed using finite differences as specified in the problem: centered for interior points and one-sided for boundaries.\n\n```python\nimport numpy as np\n\n# Physical constants\na = 6.371e6  # Earth's radius in meters\nOmega = 7.2921e-5  # Earth's rotation rate in rad/s\n\ndef solve_case(case_data):\n    \"\"\"\n    Processes a single test case to compute the required atmospheric dynamics metrics.\n    \n    This function implements the calculation of the Eliassen-Palm (EP) flux and its\n    divergence to find the eddy forcing on the zonal-mean wind.\n    \"\"\"\n    lats_deg = np.array(case_data['lats'])\n    pressures = np.array(case_data['p'])\n    theta_bar = np.array(case_data['theta_bar'])\n    uv_bar = np.array(case_data['uv_bar'])\n    vt_bar = np.array(case_data['vt_bar'])\n\n    n_phi, n_p = theta_bar.shape\n    \n    def deriv1d(y, x):\n        \"\"\"\n        Computes the 1D finite difference derivative of y with respect to x.\n        \"\"\"\n        res = np.zeros_like(y, dtype=float)\n        if len(y)  2:\n            return res\n        \n        # Forward difference at the start\n        res[0] = (y[1] - y[0]) / (x[1] - x[0])\n        # Backward difference at the end\n        res[-1] = (y[-1] - y[-2]) / (x[-1] - x[-2])\n        # Centered difference for interior points\n        if len(y) > 2:\n            res[1:-1] = (y[2:] - y[:-2]) / (x[2:] - x[:-2])\n        \n        return res\n\n    # --- Step 1: Preliminary calculations ---\n    lats_rad = np.deg2rad(lats_deg)\n    cos_phi = np.cos(lats_rad)\n    f = 2 * Omega * np.sin(lats_rad)\n    \n    # --- Step 2: Static stability d(theta_bar)/dp ---\n    dtheta_dp = np.apply_along_axis(deriv1d, 1, theta_bar, x=pressures)\n\n    # --- Step 3: EP Flux components F_phi and F_p ---\n    F_phi = a * cos_phi[:, np.newaxis] * (-uv_bar)\n    numerator_Fp = f[:, np.newaxis] * vt_bar\n    F_p = a * cos_phi[:, np.newaxis] * np.divide(numerator_Fp, dtheta_dp, where=dtheta_dp!=0)\n\n    # --- Step 4: EP Flux divergence terms ---\n    # Latitudinal derivative of F_phi w.r.t. angle (radians)\n    div_term_phi_angle = np.apply_along_axis(deriv1d, 0, F_phi, x=lats_rad)\n    # Vertical derivative of F_p\n    div_term_p = np.apply_along_axis(deriv1d, 1, F_p, x=pressures)\n    \n    # --- Step 5: Total divergence and acceleration A ---\n    # Total divergence on the meridional plane\n    divergence = (1/a) * div_term_phi_angle + div_term_p\n    \n    cos_phi_2d = cos_phi[:, np.newaxis]\n    A = np.divide(1.0, a * cos_phi_2d, where=cos_phi_2d!=0) * divergence\n    \n    # Convert from m/s^2 to m/s/day\n    A_daily = A * 86400.0\n\n    # --- Step 6: Compute final metrics ---\n    A_vert_avg = np.mean(A_daily, axis=1)\n    idx_max = np.argmax(A_vert_avg)\n    phi_star = lats_deg[idx_max]\n    \n    max_A = np.max(A_daily)\n    if max_A  0:\n        max_A = 0.0\n    \n    positive_count = np.sum(A_daily > 0)\n    total_points = n_phi * n_p\n    fraction_positive = positive_count / total_points if total_points > 0 else 0.0\n    \n    return phi_star, max_A, fraction_positive\n\ndef main():\n    test_cases = [\n        {\n            \"lats\": [15.0, 30.0, 45.0], \"p\": [70000.0, 50000.0, 30000.0],\n            \"theta_bar\": np.array([[330.0, 340.0, 350.0], [332.0, 342.0, 352.0], [334.0, 344.0, 354.0]]),\n            \"uv_bar\": np.array([[-10.0, -20.0, -10.0], [-30.0, -60.0, -40.0], [-50.0, -80.0, -60.0]]),\n            \"vt_bar\": np.array([[0.2, 0.5, 0.4], [1.0, 2.0, 1.5], [1.5, 2.5, 2.0]]),\n        },\n        {\n            \"lats\": [0.0, 15.0, 30.0], \"p\": [70000.0, 50000.0, 30000.0],\n            \"theta_bar\": np.array([[328.0, 338.0, 348.0], [330.0, 340.0, 350.0], [334.0, 344.0, 354.0]]),\n            \"uv_bar\": np.array([[-5.0, -10.0, -5.0], [-20.0, -30.0, -25.0], [-40.0, -70.0, -50.0]]),\n            \"vt_bar\": np.array([[0.3, 0.4, 0.3], [0.8, 1.5, 1.2], [1.2, 2.2, 1.8]]),\n        },\n        {\n            \"lats\": [15.0, 30.0, 45.0], \"p\": [70000.0, 50000.0, 30000.0],\n            \"theta_bar\": np.array([[330.0, 350.0, 370.0], [332.0, 352.0, 372.0], [334.0, 354.0, 374.0]]),\n            \"uv_bar\": np.array([[-10.0, -20.0, -10.0], [-30.0, -60.0, -40.0], [-50.0, -80.0, -60.0]]),\n            \"vt_bar\": np.array([[0.2, 0.5, 0.4], [1.0, 2.0, 1.5], [1.5, 2.5, 2.0]]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        phi_star, max_A, frac_pos = solve_case(case)\n        all_results.append(f\"{phi_star:.1f}\")\n        all_results.append(f\"{max_A:.3f}\")\n        all_results.append(f\"{frac_pos:.3f}\")\n    \n    # This part is just for generating the answer string and would not be part of an interactive session.\n    # The program would just print the final string.\n    # print(f\"[{','.join(all_results)}]\")\n\n# To run this, you would call main()\n# For the purpose of this solution, the Python code is provided as the implementation guide.\n```",
            "answer": "[45.0,0.198,0.444,30.0,0.297,0.444,45.0,0.076,0.444]"
        }
    ]
}