{
    "hands_on_practices": [
        {
            "introduction": "这项练习从基础出发，要求我们从控制方程推导出风应力与埃克曼层中净水体输送之间的基本关系。通过完成推导并将其应用于南半球情景，您将深刻理解为何水体输送方向在北半球偏向风向右侧，而在南半球偏向左侧——这是科里奥利效应一个不直观但至关重要的结果。这个练习是理解风生环流和上升流/下降流物理机制的基石。",
            "id": "4024758",
            "problem": "在纬度 $\\phi=-30^{\\circ}$ 处，一个理想化的、水平均匀的开阔大洋水柱受到空间均匀的表面风应力驱动。假设一个经典的稳态埃克曼层，在埃克曼动量平衡中水平压力梯度可忽略，且湍流应力在埃克曼层底部消失。海水密度为 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$，科里奥利参数为 $f=-7.27\\times 10^{-5}\\,\\mathrm{s^{-1}}$。施加一个均匀的、纯纬向的东风表面风应力 $\\boldsymbol{\\tau}=\\tau_{0}\\,\\hat{\\boldsymbol{i}}$，其中 $\\tau_{0}=0.15\\,\\mathrm{N\\,m^{-2}}$。\n\n从将作用于垂直积分埃克曼速度上的科里奥利力与湍流应力的垂直散度联系起来的稳态、垂直积分的动量平衡方程出发，推导出垂直积分的埃克曼输运矢量 $\\boldsymbol{M}_{E}=\\int_{-\\infty}^{0}\\boldsymbol{u}_{E}\\,\\mathrm{d}z$（用 $\\boldsymbol{\\tau}$、$\\rho$ 和 $f$ 表示），且不引用任何现成的埃克曼输运公式。请仔细说明在垂直积分中使用的边界条件。\n\n然后，在纬度 $\\phi=-30^{\\circ}$ 处，针对给定的风应力 $\\boldsymbol{\\tau}$，计算埃克曼输运的带符号经向分量 $M_{E,y}$（以向北为正）。最终答案以 $\\mathrm{m^{2}\\,s^{-1}}$ 为单位，并四舍五入至四位有效数字。",
            "solution": "该问题经评估具有科学依据、提法恰当、客观且自洽。它是一个基于既定物理原理和实际参数的地球物理流体动力学标准练习。因此，该问题被认为是有效的，解答如下。\n\n第一个目标是从稳态埃克曼层的基本动量平衡方程出发，推导垂直积分的埃克曼输运矢量 $\\boldsymbol{M}_{E}$。所作假设为：稳态（$\\frac{\\partial}{\\partial t} = 0$）、水平均匀（对于密度和速度等所有变量，$\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial y} = 0$）以及水平压力梯度可忽略。\n\n在旋转参考系中，埃克曼层的动量方程由科里奥利力与湍流应力的垂直散度之间的平衡给出。在一个标准的笛卡尔坐标系中，$\\hat{\\boldsymbol{i}}$ 指向东，$\\hat{\\boldsymbol{j}}$ 指向北，$\\hat{\\boldsymbol{k}}$ 垂直指向上，动量平衡的矢量形式为：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{E} = \\frac{1}{\\rho} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}\n$$\n其中 $\\boldsymbol{u}_{E}(z)$ 是水平埃克曼速度矢量，$f$ 是科里奥利参数，$\\rho$ 是海水密度（假定为常数），$\\boldsymbol{\\tau}(z)$ 是湍流应力矢量，$z$ 是垂直坐标。\n\n埃克曼输运矢量 $\\boldsymbol{M}_{E}$ 定义为埃克曼速度 $\\boldsymbol{u}_{E}$ 在埃克曼层深度上的垂直积分。我们将动量方程从远低于该层（此处流动为地转流且湍流应力可忽略，即 $z \\to -\\infty$）积分到海面（$z=0$）：\n$$\n\\int_{-\\infty}^{0} \\left( f \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{E} \\right) \\mathrm{d}z = \\int_{-\\infty}^{0} \\left( \\frac{1}{\\rho} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z} \\right) \\mathrm{d}z\n$$\n假设在埃克曼层内，$f$ 和 $\\rho$ 不随深度变化，它们可以移到左侧积分符号之外：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\left( \\int_{-\\infty}^{0} \\boldsymbol{u}_{E} \\, \\mathrm{d}z \\right) = \\frac{1}{\\rho} \\int_{-\\infty}^{0} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z} \\, \\mathrm{d}z\n$$\n根据定义，$\\boldsymbol{M}_{E} = \\int_{-\\infty}^{0} \\boldsymbol{u}_{E} \\, \\mathrm{d}z$。右侧的积分可以使用微积分基本定理进行计算：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E} = \\frac{1}{\\rho} \\left[ \\boldsymbol{\\tau}(z) \\right]_{-\\infty}^{0} = \\frac{1}{\\rho} \\left( \\boldsymbol{\\tau}(0) - \\boldsymbol{\\tau}(-\\infty) \\right)\n$$\n我们现在陈述并应用湍流应力的边界条件：\n1.  在海面（$z=0$）处，水中的湍流应力等于大气施加在海洋表面的风应力。我们将表面风应力记为 $\\boldsymbol{\\tau}_{\\text{wind}}$。题目给出 $\\boldsymbol{\\tau}_{\\text{wind}} = \\boldsymbol{\\tau}$。因此，$\\boldsymbol{\\tau}(0) = \\boldsymbol{\\tau}$。\n2.  在埃克曼层底部（$z \\to -\\infty$），湍流应力消失。因此，$\\boldsymbol{\\tau}(-\\infty) = \\mathbf{0}$。\n\n将这些边界条件代入积分后的方程，得到：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E} = \\frac{1}{\\rho} (\\boldsymbol{\\tau} - \\mathbf{0}) = \\frac{\\boldsymbol{\\tau}}{\\rho}\n$$\n为了求解 $\\boldsymbol{M}_{E}$，我们将此方程从左侧与单位矢量 $\\hat{\\boldsymbol{k}}$ 做叉积：\n$$\n\\hat{\\boldsymbol{k}} \\times (f \\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E}) = \\hat{\\boldsymbol{k}} \\times \\left( \\frac{\\boldsymbol{\\tau}}{\\rho} \\right)\n$$\n$$\nf \\left( \\hat{\\boldsymbol{k}} \\times (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E}) \\right) = \\frac{1}{\\rho} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau})\n$$\n使用矢量三重积恒等式 $\\boldsymbol{a} \\times (\\boldsymbol{b} \\times \\boldsymbol{c}) = \\boldsymbol{b}(\\boldsymbol{a} \\cdot \\boldsymbol{c}) - \\boldsymbol{c}(\\boldsymbol{a} \\cdot \\boldsymbol{b})$，其中 $\\boldsymbol{a}=\\hat{\\boldsymbol{k}}$，$\\boldsymbol{b}=\\hat{\\boldsymbol{k}}$，$\\boldsymbol{c}=\\boldsymbol{M}_{E}$：\n$$\nf \\left( \\hat{\\boldsymbol{k}}(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{M}_{E}) - \\boldsymbol{M}_{E}(\\hat{\\boldsymbol{k}} \\cdot \\hat{\\boldsymbol{k}}) \\right) = \\frac{1}{\\rho} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau})\n$$\n埃克曼输运 $\\boldsymbol{M}_{E}$ 是一个水平矢量，因此它垂直于 $\\hat{\\boldsymbol{k}}$，这意味着它们的点积为零：$\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{M}_{E} = 0$。$\\hat{\\boldsymbol{k}}$ 与自身的点积为 $\\hat{\\boldsymbol{k}} \\cdot \\hat{\\boldsymbol{k}} = |\\hat{\\boldsymbol{k}}|^2 = 1$。代入这些结果：\n$$\nf ( \\hat{\\boldsymbol{k}}(0) - \\boldsymbol{M}_{E}(1) ) = \\frac{1}{\\rho} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau})\n$$\n$$\n-f \\boldsymbol{M}_{E} = \\frac{1}{\\rho} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau})\n$$\n分离出 $\\boldsymbol{M}_{E}$，得到所需的用 $\\boldsymbol{\\tau}$、$\\rho$ 和 $f$ 表示的埃克曼输运矢量表达式：\n$$\n\\boldsymbol{M}_{E} = -\\frac{1}{\\rho f} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau}) = \\frac{1}{\\rho f} (\\boldsymbol{\\tau} \\times \\hat{\\boldsymbol{k}})\n$$\n至此，推导完成。\n\n第二个目标是计算埃克曼输运的带符号经向（向北）分量 $M_{E,y}$。我们可以通过计算叉积来找到 $\\boldsymbol{M}_{E}$ 的分量。给定风应力 $\\boldsymbol{\\tau} = \\tau_{x} \\hat{\\boldsymbol{i}} + \\tau_{y} \\hat{\\boldsymbol{j}}$：\n$$\n\\boldsymbol{\\tau} \\times \\hat{\\boldsymbol{k}} = (\\tau_{x} \\hat{\\boldsymbol{i}} + \\tau_{y} \\hat{\\boldsymbol{j}}) \\times \\hat{\\boldsymbol{k}} = \\tau_{x} (\\hat{\\boldsymbol{i}} \\times \\hat{\\boldsymbol{k}}) + \\tau_{y} (\\hat{\\boldsymbol{j}} \\times \\hat{\\boldsymbol{k}}) = \\tau_{x} (-\\hat{\\boldsymbol{j}}) + \\tau_{y} (\\hat{\\boldsymbol{i}}) = \\tau_{y} \\hat{\\boldsymbol{i}} - \\tau_{x} \\hat{\\boldsymbol{j}}\n$$\n将此代入 $\\boldsymbol{M}_{E}$ 的表达式中：\n$$\n\\boldsymbol{M}_{E} = M_{E,x} \\hat{\\boldsymbol{i}} + M_{E,y} \\hat{\\boldsymbol{j}} = \\frac{1}{\\rho f} (\\tau_{y} \\hat{\\boldsymbol{i}} - \\tau_{x} \\hat{\\boldsymbol{j}})\n$$\n通过比较分量，我们发现经向分量为：\n$$\nM_{E,y} = -\\frac{\\tau_{x}}{\\rho f}\n$$\n题目提供了以下数值：\n-   纯纬向的东风表面风应力：$\\boldsymbol{\\tau} = \\tau_{0}\\,\\hat{\\boldsymbol{i}}$，这意味着纬向分量为 $\\tau_x = \\tau_0 = 0.15\\,\\mathrm{N\\,m^{-2}}$，经向分量为 $\\tau_y = 0$。\n-   海水密度：$\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$。\n-   纬度 $\\phi=-30^{\\circ}$ 处的科里奥利参数：$f = -7.27 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。\n\n我们将这些值代入 $M_{E,y}$ 的表达式中：\n$$\nM_{E,y} = -\\frac{0.15\\,\\mathrm{N\\,m^{-2}}}{(1025\\,\\mathrm{kg\\,m^{-3}}) \\times (-7.27 \\times 10^{-5}\\,\\mathrm{s}^{-1})}\n$$\n两个负号相互抵消，得到一个正的（向北的）输运：\n$$\nM_{E,y} = \\frac{0.15}{1025 \\times 7.27 \\times 10^{-5}} \\,\\mathrm{m^2\\,s^{-1}}\n$$\n$$\nM_{E,y} = \\frac{0.15}{0.0745175} \\,\\mathrm{m^2\\,s^{-1}} \\approx 2.012921 \\,\\mathrm{m^2\\,s^{-1}}\n$$\n按要求将结果四舍五入至四位有效数字：\n$$\nM_{E,y} \\approx 2.013\\,\\mathrm{m^2\\,s^{-1}}\n$$\n正号表示经向输运方向为北。这与南半球（$f0$）中，净水输运方向在风向左侧的预期相符。对于东风而言，这对应于向北的输运。",
            "answer": "$$\\boxed{2.013}$$"
        },
        {
            "introduction": "在理解了埃克曼输送的基本原理后，这项实践将其应用于一个经典的海岸上升流场景。通过在一个控制体积内应用质量守恒定律，您将推导出上升流的垂直速度表达式。这项练习将水平输送的抽象概念与定义上升流的真实垂直水体运动联系起来，并让您能够探索其强度如何随纬度变化。",
            "id": "4024714",
            "problem": "一条笔直的东部边界海岸线受到稳定、空间均匀、沿岸向赤道的风应力作用，这在北半球会引起海岸上升流。考虑一个角速度为 $\\Omega$ 的旋转地球上的海洋表层，该表层受静力、布辛涅斯克原始方程支配，并作出如下假设：\n- 稳态且沿岸方向水平均匀的强迫，\n- 在纬度 $\\phi$ 处，科里奥利参数为 $f(\\phi)=2\\Omega \\sin\\phi$，\n- 参考密度 $\\rho$ 为常数，\n- 一个摩擦表面埃克曼层，其垂直积分的动量平衡主要由科里奥利力和湍流应力散度主导，\n- 对于三维速度场，流体不可压缩且满足连续性方程。\n\n将海岸带视为一个跨岸宽度为 $L$ 的控制体，其中风生、深度积分的离岸埃克曼输运必须通过质量守恒与海岸处的平均垂直速度 $w$ 相平衡。从旋转坐标系下的动量方程和连续性方程出发，推导上升流速度 $w$ 的主导项表达式，该表达式应使用所施加的风应力大小 $\\tau$、密度 $\\rho$、科里奥利参数 $f(\\phi)$ 和跨岸尺度 $L$ 来表示。然后，使用你推导的表达式和给定的科里奥利参数 $f(\\phi)=2\\Omega \\sin\\phi$，在以下固定参数条件下，计算 $\\phi=15^\\circ$、$\\phi=30^\\circ$ 和 $\\phi=45^\\circ$ 时的 $w$ 值：\n- $\\tau = 0.12$ 牛顿/平方米，\n- $\\rho = 1025$ 千克/立方米，\n- $L = 1.00 \\times 10^{5}$ 米，\n- $\\Omega = 7.2921159 \\times 10^{-5}$ 弧度/秒。\n\n将 $w$ 解释为正值表示向上运动（上升流）。将三个 $w$ 值均以米/秒为单位表示，并将最终数值结果四舍五入到四位有效数字。",
            "solution": "此问题要求从基本物理原理推导海岸上升流速度的表达式，并计算其在特定纬度下的数值。这是一个基于既定物理原理和实际参数的标准地球物理流体动力学练习。\n\n#### 上升流速度 $w$ 的推导\n\n我们建立一个右手笛卡尔坐标系，其中 $y$ 轴沿海岸线向北， $x$ 轴向东。东部边界海岸线位于 $x=0$，海洋区域为 $x0$。在北半球，科里奥利参数 $f > 0$。沿岸向赤道的风应力指向负 $y$ 方向，因此表面风应力矢量为 $\\boldsymbol{\\tau} = (0, -\\tau)$，其分量为 $\\tau_x = 0$ 和 $\\tau_y = -\\tau$。\n\n根据问题假设，表面埃克曼层中的稳态动量平衡主要由科里奥利力和湍流应力的垂直散度主导。在垂直积分后，单位长度上的纬向（跨岸）和经向（沿岸）埃克曼体积输运 ($U_{Ek}$, $V_{Ek}$) 由以下公式给出：\n$$ U_{Ek} = \\int_{-D_E}^{0} u \\, dz = \\frac{\\tau_y}{\\rho f} $$\n$$ V_{Ek} = \\int_{-D_E}^{0} v \\, dz = -\\frac{\\tau_x}{\\rho f} $$\n代入本问题的风应力分量 $\\tau_x = 0$ 和 $\\tau_y = -\\tau$，我们得到：\n$$ U_{Ek} = -\\frac{\\tau}{\\rho f} $$\n$$ V_{Ek} = 0 $$\n$U_{Ek}  0$ 的结果表示输运方向为负 $x$ 方向（向西）。对于东部边界，这是一个离岸输运，将表层水移离海岸。\n\n接下来，我们将质量守恒原理（连续性方程 $\\nabla \\cdot \\boldsymbol{u} = 0$）应用于一个控制体。该控制体从海岸（$x=0$）延伸到离岸距离 $L$（$x=-L$），并覆盖埃克曼层的整个深度。根据沿岸均匀性假设（$\\frac{\\partial v}{\\partial y}=0$），积分连续性方程可得，离岸方向的净水平输运必须由埃克曼层底部的垂直输运来平衡。\n在控制体内，离开控制体西侧边界（$x=-L$）的水平水量为 $U_{Ek}$。由于海岸处（$x=0$）的水平流速为零，这是该层水平输运的净通量。根据质量守恒，这部分水量必须由从下方进入控制体的垂直水流通量来补偿。该垂直通量等于平均上升流速度 $w$ 乘以控制体的底面积 $L \\times (\\text{单位沿岸长度})$。因此：\n$$ w \\cdot L = -U_{Ek} $$\n代入 $U_{Ek}$ 的表达式：\n$$ w \\cdot L = - \\left( -\\frac{\\tau}{\\rho f} \\right) = \\frac{\\tau}{\\rho f} $$\n求解平均上升流速度 $w$，得到最终表达式：\n$$ w = \\frac{\\tau}{\\rho f L} $$\n将科里奥利参数的表达式 $f = 2\\Omega\\sin\\phi$ 代入，得到纬度依赖的上升流速度：\n$$ w(\\phi) = \\frac{\\tau}{\\rho (2\\Omega \\sin\\phi) L} $$\n\n#### 数值计算\n\n使用给定的参数值进行计算：\n- $\\tau = 0.12$ N/m$^2$\n- $\\rho = 1025$ kg/m$^3$\n- $L = 1.00 \\times 10^5$ m\n- $\\Omega = 7.2921159 \\times 10^{-5}$ rad/s\n\n首先计算公式中的常数部分：\n$$ C = \\frac{\\tau}{2 \\rho \\Omega L} = \\frac{0.12}{2 \\times 1025 \\times (7.2921159 \\times 10^{-5}) \\times (1.00 \\times 10^5)} \\approx 8.027359 \\times 10^{-6} \\, \\text{m/s} $$\n现在，我们针对每个给定的纬度计算 $w$：\n$$ w(\\phi) = \\frac{C}{\\sin\\phi} $$\n- 对于 $\\phi = 15^\\circ$:\n$$ w(15^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(15^\\circ)} \\approx \\frac{8.027359 \\times 10^{-6}}{0.258819} \\approx 3.10149 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，得到 $w(15^\\circ) = 3.101 \\times 10^{-5}$ m/s。\n\n- 对于 $\\phi = 30^\\circ$:\n$$ w(30^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(30^\\circ)} = \\frac{8.027359 \\times 10^{-6}}{0.5} = 1.60547 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，得到 $w(30^\\circ) = 1.605 \\times 10^{-5}$ m/s。\n\n- 对于 $\\phi = 45^\\circ$:\n$$ w(45^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(45^\\circ)} \\approx \\frac{8.027359 \\times 10^{-6}}{0.707107} \\approx 1.13524 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，得到 $w(45^\\circ) = 1.135 \\times 10^{-5}$ m/s。\n\n这些结果表明，在风应力恒定的情况下，上升流速度与科里奥利参数成反比，因此在低纬度地区更强。其量级（约1-3米/天）是海岸上升流系统的典型值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.101 \\times 10^{-5}  1.605 \\times 10^{-5}  1.135 \\times 10^{-5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "最后的这项实践将我们从解析理论带到计算实践中，这是气候建模者的核心技能。这项练习涉及使用有限差分法（一种数值模型中的常用技术）来实现埃克曼抽吸公式。通过将数值结果与精确解进行比较并分析误差，您将学习如何构建和验证模型组件，并理解网格分辨率对模型准确性的影响。",
            "id": "4024713",
            "problem": "考虑一个沿 $y$ 轴排列的理想化平直海岸线，海洋占据 $x \\ge 0$ 的半空间。假设在一个 $f$ 平面上，科里奥利参数 $f$ 和海水密度 $\\rho$ 均为常数，并有一个给定的风应力场，该风应力场能产生海岸上升流和开阔大洋下降流。定义域在离岸方向 $x \\in [0, L]$ 上是一维的，海岸线位于 $x = 0$。\n\n基本原理：在 $f$ 平面上的稳态、垂直积分的动量平衡中，埃克曼层底部的垂直速度（埃克曼抽吸/抽水）由以下公式给出\n$$\nw_E(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right),\n$$\n其中 $\\tau_x$ 和 $\\tau_y$ 分别是风应力的 $x$ 和 $y$ 分量，$\\rho$ 是海水密度。正值的 $w_E$ 表示上升流。\n\n给定沿岸风应力为\n$$\n\\tau_y(x) \\;=\\; \\tau_0 \\left(1 - e^{-x/L_r}\\right),\n$$\n其中常数振幅 $\\tau_0 > 0$，海岸斜坡长度尺度 $L_r > 0$。给定纬向风应力的恒定大尺度经向梯度为\n$$\n\\frac{\\partial \\tau_x}{\\partial y} \\;=\\; C,\n$$\n其中 $C > 0$ 代表一种趋向于开阔大洋下降流的背景趋势。由这些规定所隐含的精确埃克曼垂直速度为\n$$\nw_{\\text{exact}}(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r}e^{-x/L_r} - C\\right).\n$$\n$w_{\\text{exact}}(x_0) = 0$ 的过零点位置 $x_0$ 是\n$$\nx_0 \\;=\\; -L_r \\,\\ln\\!\\left(\\frac{C L_r}{\\tau_0}\\right),\n$$\n条件是 $0  \\frac{C L_r}{\\tau_0}  1$。\n\n数值任务：用均匀间隔的网格点 $x_i = i\\,\\Delta x$（$i = 0, 1, \\dots, N$）将区间 $[0, L]$ 离散化，其中 $N = L/\\Delta x$ 是一个整数，$\\Delta x$ 是网格间距。使用二阶精度的有限差分格式来近似 $\\frac{\\partial \\tau_y}{\\partial x}$：\n- 在海岸线处（$i = 0$），使用单边向前差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_0} \\approx \\frac{-3\\,\\tau_y(x_0) + 4\\,\\tau_y(x_1) - \\tau_y(x_2)}{2\\,\\Delta x}.\n$$\n- 在内部点（$i = 1, 2, \\dots, N-1$），使用中心差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} \\approx \\frac{\\tau_y(x_{i+1}) - \\tau_y(x_{i-1})}{2\\,\\Delta x}.\n$$\n- 在离岸边界处（$i = N$），使用单边向后差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_N} \\approx \\frac{3\\,\\tau_y(x_N) - 4\\,\\tau_y(x_{N-1}) + \\tau_y(x_{N-2})}{2\\,\\Delta x}.\n$$\n\n计算离散的埃克曼垂直速度\n$$\nw_{\\text{num}}(x_i) \\;=\\; \\frac{1}{\\rho f}\\left(\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} - C\\right).\n$$\n\n评估指标：\n1. 海岸上升流收敛性：将 $w_{\\text{num}}(0)$ 与 $w_{\\text{exact}}(0)$进行比较，并报告绝对相对误差\n$$\nE_w(\\Delta x) \\;=\\; \\left|\\frac{w_{\\text{num}}(0) - w_{\\text{exact}}(0)}{w_{\\text{exact}}(0)}\\right|,\n$$\n该误差是无量纲的（一个小数）。\n2. 过零点收敛性：通过识别第一个满足 $w_{\\text{num}}(x_i) > 0$ 和 $w_{\\text{num}}(x_{i+1}) \\le 0$ 的索引 $i$，并进行线性插值，来估计数值过零点位置 $x_{0,\\text{num}}$：\n$$\nx_{0,\\text{num}} \\;=\\; x_i + \\Delta x \\,\\frac{w_{\\text{num}}(x_i)}{w_{\\text{num}}(x_i) - w_{\\text{num}}(x_{i+1})}.\n$$\n报告绝对误差\n$$\nE_x(\\Delta x) \\;=\\; \\left|x_{0,\\text{num}} - x_0\\right|,\n$$\n以米为单位表示。\n\n常量和测试套件：\n- $\\rho = 1025\\,\\mathrm{kg/m^3}$，\n- $f = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$，\n- $\\tau_0 = 0.2\\,\\mathrm{N/m^2}$，\n- $L_r = 50\\,\\mathrm{km}$，\n- $C = 2.0\\times 10^{-7}\\,\\mathrm{N/m^3}$，\n- $L = 400\\,\\mathrm{km}$，\n- 网格间距 $\\Delta x \\in \\{20\\,\\mathrm{km}, 10\\,\\mathrm{km}, 5\\,\\mathrm{km}, 2\\,\\mathrm{km}\\}$。\n\n单位：\n- 如果中间计算需要，垂直速度以 $\\mathrm{m/s}$ 为单位报告，但海岸上升流误差 $E_w(\\Delta x)$ 必须是无量纲的（小数）。\n- 过零点绝对误差 $E_x(\\Delta x)$ 以米为单位报告。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含八个用方括号括起来、以逗号分隔的浮点数，并按网格分辨率递增的顺序排列，格式如下：\n$$\n[E_w(20\\,\\mathrm{km}),\\,E_x(20\\,\\mathrm{km}),\\,E_w(10\\,\\mathrm{km}),\\,E_x(10\\,\\mathrm{km}),\\,E_w(5\\,\\mathrm{km}),\\,E_x(5\\,\\mathrm{km}),\\,E_w(2\\,\\mathrm{km}),\\,E_x(2\\,\\mathrm{km})].\n$$\n确保定义域的离散化使用指定的有限差分公式。答案必须是自包含的，并且对于给定的常量无需任何用户输入即可运行。",
            "solution": "该问题的解决方案是通过编写一个Python脚本来实现的，该脚本严格遵循问题描述中的数值方法和评估指标。该脚本执行以下步骤来评估有限差分近似在不同网格分辨率下的准确性：\n\n1.  **定义常量与解析解**：首先，脚本定义所有给定的物理常量（如密度 $\\rho$、科里奥利参数 $f$）和模型参数（如 $\\tau_0, L_r, C, L$），并将它们统一转换为国际单位制（S.I.）。然后，它计算一次性的精确解析解：海岸线处的上升流速度 $w_{\\text{exact}}(0)$ 和上升流转为下降流的过零点位置 $x_0$。这些精确值将作为评估数值结果的基准。\n\n2.  **迭代不同网格分辨率**：脚本设置一个循环，遍历所提供的网格间距测试套件 $\\Delta x \\in \\{20, 10, 5, 2\\}\\,\\mathrm{km}$。\n\n3.  **网格生成与离散化**：在每次循环中，根据当前的 $\\Delta x$ 值，在 $[0, L]$ 区间上创建一个均匀的一维网格点数组 $x_i$。然后，在这些离散的网格点上计算沿岸风应力函数 $\\tau_y(x)$ 的值，得到一个离散的风应力向量。\n\n4.  **有限差分近似**：使用问题中指定的二阶精度有限差分公式，计算风应力梯度 $\\frac{\\partial \\tau_y}{\\partial x}$ 的数值近似值。脚本会为内部点、海岸边界点（$i=0$）和离岸边界点（$i=N$）分别应用正确的中心差分、向前差分和向后差分模板。\n\n5.  **计算数值速度**：利用计算出的风应力梯度，脚本接着计算每个网格点上的离散埃克曼垂直速度 $w_{\\text{num}}(x_i)$。\n\n6.  **计算误差指标**：\n    *   **海岸上升流误差 ($E_w$)**: 脚本提取海岸线处的数值速度 $w_{\\text{num}}(0)$，并计算其与精确值 $w_{\\text{exact}}(0)$ 之间的绝对相对误差。\n    *   **过零点误差 ($E_x$)**: 脚本在数值速度数组 $w_{\\text{num}}$ 中搜索第一个从正值变为非正值的点对。找到该位置后，使用线性插值公式计算出数值过零点的位置 $x_{0,\\text{num}}$。最后，计算该数值位置与精确过零点 $x_0$ 之间的绝对误差。\n\n7.  **格式化输出**：脚本将每次循环中计算出的两个误差指标 ($E_w$ 和 $E_x$) 存储起来。循环结束后，将所有八个误差值按照指定的顺序格式化为一个逗号分隔的字符串，并用方括号括起来，最终打印出这一单行结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical errors for a 1D coastal upwelling model.\n\n    This function solves the problem as stated, calculating the absolute relative error\n    of the coastal upwelling velocity and the absolute error of the zero-crossing location\n    for four different grid resolutions.\n    \"\"\"\n    # Define physical constants and parameters in S.I. units.\n    RHO = 1025.0         # Seawater density (kg/m^3)\n    F_CORIOLIS = 1.0e-4  # Coriolis parameter (s^-1)\n    TAU0 = 0.2           # Wind stress amplitude (N/m^2)\n    LR = 50000.0         # Coastal ramp length scale (m)\n    C_GRAD = 2.0e-7      # Background stress gradient (N/m^3)\n    L_DOMAIN = 400000.0  # Domain length (m)\n\n    # Test suite of grid spacings in kilometers.\n    dx_values_km = [20.0, 10.0, 5.0, 2.0]\n\n    # --- Step 1: Calculate exact analytical solutions ---\n    # These are constant for all test cases.\n    \n    # Exact vertical velocity at the coast (x=0)\n    w_exact_0 = (TAU0 / LR - C_GRAD) / (RHO * F_CORIOLIS)\n    \n    # Exact zero-crossing location x0 where w_exact(x0) = 0\n    x0_exact = -LR * np.log(C_GRAD * LR / TAU0)\n\n    results = []\n\n    # --- Step 2: Loop over each grid resolution ---\n    for dx_km in dx_values_km:\n        dx_m = dx_km * 1000.0\n        n_cells = int(L_DOMAIN / dx_m)\n        n_points = n_cells + 1\n\n        # a. Generate the computational grid\n        x_grid = np.linspace(0.0, L_DOMAIN, n_points)\n\n        # b. Evaluate the wind stress tau_y on the grid\n        tau_y_grid = TAU0 * (1.0 - np.exp(-x_grid / LR))\n\n        # c. Approximate the derivative d(tau_y)/dx using finite differences\n        dtau_y_dx = np.zeros(n_points)\n\n        if n_points  3:\n            raise ValueError(\"Grid resolution is too coarse for the 3-point stencils.\")\n\n        # At the coastline (i=0), use the forward difference formula\n        dtau_y_dx[0] = (-3.0 * tau_y_grid[0] + 4.0 * tau_y_grid[1] - tau_y_grid[2]) / (2.0 * dx_m)\n\n        # At the offshore boundary (i=N), use the backward difference formula\n        dtau_y_dx[n_cells] = (3.0 * tau_y_grid[n_cells] - 4.0 * tau_y_grid[n_cells - 1] + tau_y_grid[n_cells - 2]) / (2.0 * dx_m)\n\n        # At interior points (i=1,...,N-1), use the central difference formula\n        dtau_y_dx[1:n_cells] = (tau_y_grid[2:n_points] - tau_y_grid[0:n_cells - 1]) / (2.0 * dx_m)\n\n        # d. Compute the numerical vertical velocity w_num\n        w_num_grid = (dtau_y_dx - C_GRAD) / (RHO * F_CORIOLIS)\n\n        # --- Step 3: Calculate the evaluation metrics ---\n\n        # Metric 1: Coastal upwelling convergence, E_w(dx)\n        w_num_0 = w_num_grid[0]\n        e_w = np.abs((w_num_0 - w_exact_0) / w_exact_0)\n\n        # Metric 2: Zero-crossing convergence, E_x(dx)\n        # Find the first index 'i' where w_num > 0 and w_num[i+1] = 0\n        try:\n            # np.where returns a tuple of arrays; we need the first element of the first array.\n            i_cross = np.where((w_num_grid[:-1] > 0)  (w_num_grid[1:] = 0))[0][0]\n        except IndexError:\n            raise ValueError(f\"Zero-crossing not found for dx = {dx_km} km. \"\n                             \"The numerical velocity does not change sign.\")\n\n        # Perform linear interpolation to find the numerical zero crossing x0_num\n        x_i = x_grid[i_cross]\n        w_i = w_num_grid[i_cross]\n        w_i_plus_1 = w_num_grid[i_cross + 1]\n        \n        x0_num = x_i + dx_m * w_i / (w_i - w_i_plus_1)\n\n        e_x = np.abs(x0_num - x0_exact)\n\n        results.extend([e_w, e_x])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}