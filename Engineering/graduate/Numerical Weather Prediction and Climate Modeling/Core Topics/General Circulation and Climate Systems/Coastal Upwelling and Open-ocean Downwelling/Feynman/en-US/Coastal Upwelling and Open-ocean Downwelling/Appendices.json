{
    "hands_on_practices": [
        {
            "introduction": "Understanding wind-driven ocean currents begins with the classic Ekman layer theory. This first practice grounds you in the fundamental physics by deriving the solution for the velocity profile, known as the Ekman spiral, from first principles. By working through this problem (), you will solidify your understanding of the balance between wind stress, the Coriolis effect, and turbulent friction, and learn to calculate key physical parameters like the Ekman depth and surface current speed.",
            "id": "4024750",
            "problem": "In a mid-latitude, horizontally homogeneous open-ocean column intended for coupling within a numerical weather prediction and climate modeling framework, consider a steady, incompressible Boussinesq ocean with constant vertical kinematic eddy viscosity $\\nu$ subject to the Coriolis force with constant Coriolis parameter $f$. Let the coordinate system be defined with $x$ pointing east, $y$ pointing north, and $z$ pointing upward, with the ocean occupying $z \\le 0$ and the free surface at $z=0$. Assume the hydrostatic approximation and neglect horizontal pressure gradients and horizontal viscosity within the surface boundary layer (Ekman layer). The momentum equations governing the Ekman boundary layer are, for steady state and horizontal homogeneity,\n$$-\\,f\\,v \\;=\\; \\nu\\,\\frac{d^{2}u}{dz^{2}}, \\qquad f\\,u \\;=\\; \\nu\\,\\frac{d^{2}v}{dz^{2}},$$\nwith boundary conditions $u(z),v(z)\\to 0$ as $z\\to -\\infty$ and the surface stress condition at $z=0$ given by\n$$\\rho\\,\\nu\\,\\frac{du}{dz}\\bigg|_{z=0} \\;=\\; \\tau_{x}, \\qquad \\rho\\,\\nu\\,\\frac{dv}{dz}\\bigg|_{z=0} \\;=\\; \\tau_{y},$$\nwhere $\\rho$ is the seawater density and $(\\tau_{x},\\tau_{y})$ are the components of the wind stress vector $\\boldsymbol{\\tau}$. Starting from these equations, derive the canonical Ekman boundary layer solution and use it to obtain the surface current vector $\\boldsymbol{U}_{s} = (u(0),v(0))$ and the characteristic Ekman depth $\\delta$ defined as the e-folding scale of the velocity amplitude in the Ekman spiral.\n\nGiven $\\tau_{x}=0$, $\\tau_{y}=-0.2\\,\\mathrm{N\\,m^{-2}}$, $\\nu=0.015\\,\\mathrm{m^{2}\\,s^{-1}}$, $f=10^{-4}\\,\\mathrm{s^{-1}}$, and $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$, compute:\n- the magnitude of the surface current $|\\boldsymbol{U}_{s}|$, expressed in $\\mathrm{m\\,s^{-1}}$,\n- the Ekman depth $\\delta$, expressed in $\\mathrm{m}$.\n\nRound both of your numerical results to four significant figures. Your final answer must be a calculation and presented as two numbers in a single row matrix, with the first entry being $|\\boldsymbol{U}_{s}|$ and the second entry being $\\delta$.",
            "solution": "We begin from the steady, horizontally homogeneous Boussinesq momentum equations under constant vertical kinematic eddy viscosity $\\nu$ and Coriolis parameter $f$:\n$$-\\,f\\,v \\;=\\; \\nu\\,\\frac{d^{2}u}{dz^{2}}, \\qquad f\\,u \\;=\\; \\nu\\,\\frac{d^{2}v}{dz^{2}},$$\nfor $z\\le 0$, with boundary conditions $u,v\\to 0$ as $z\\to -\\infty$ and surface stress conditions\n$$\\rho\\,\\nu\\,\\frac{du}{dz}\\bigg|_{z=0} \\;=\\; \\tau_{x}, \\qquad \\rho\\,\\nu\\,\\frac{dv}{dz}\\bigg|_{z=0} \\;=\\; \\tau_{y}.$$\n\nIt is convenient to introduce the complex velocity\n$$W(z) \\;=\\; u(z) \\;+\\; i\\,v(z).$$\nMultiplying the first momentum equation by $i$ and adding to the second, we obtain\n$$i\\,f\\,W \\;=\\; \\nu\\,\\frac{d^{2}W}{dz^{2}}.$$\nThis linear ordinary differential equation has solutions of the form\n$$W(z) \\;=\\; C\\,\\exp\\!\\left(\\lambda\\,z\\right),$$\nwhere $\\lambda$ satisfies $\\nu\\,\\lambda^{2} = i\\,f$. Choosing the branch that ensures decay as $z\\to -\\infty$, we write\n$$\\lambda \\;=\\; \\frac{1+i}{\\delta}, \\qquad \\delta \\;=\\; \\sqrt{\\frac{2\\,\\nu}{|f|}},$$\nso that $\\Re(\\lambda)=1/\\delta0$ and $\\exp(\\lambda z)$ decays for $z0$.\n\nThe general solution that satisfies decay is\n$$W(z) \\;=\\; C\\,\\exp\\!\\left(\\frac{1+i}{\\delta}\\,z\\right).$$\nThe surface stress boundary condition can be written in complex form using $\\tau_{c} = \\tau_{x} + i\\,\\tau_{y}$:\n$$\\rho\\,\\nu\\,\\frac{dW}{dz}\\bigg|_{z=0} \\;=\\; \\tau_{c}.$$\nSince $\\frac{dW}{dz} = C\\,\\frac{1+i}{\\delta}\\,\\exp\\!\\left(\\frac{1+i}{\\delta}\\,z\\right)$, at $z=0$ we have\n$$\\rho\\,\\nu\\,C\\,\\frac{1+i}{\\delta} \\;=\\; \\tau_{c}, \\qquad \\Rightarrow \\qquad C \\;=\\; \\frac{\\tau_{c}}{\\rho\\,\\nu}\\,\\frac{\\delta}{1+i}.$$\nTherefore, the surface complex velocity is\n$$W(0) \\;=\\; C \\;=\\; \\frac{\\tau_{c}}{\\rho\\,\\nu}\\,\\frac{\\delta}{1+i}.$$\nThe magnitude of the surface current $|\\boldsymbol{U}_{s}|$ is the modulus $|W(0)|$:\n$$|\\boldsymbol{U}_{s}| \\;=\\; \\left| \\frac{\\tau_{c}}{\\rho\\,\\nu}\\,\\frac{\\delta}{1+i} \\right| \\;=\\; \\frac{|\\tau_{c}|}{\\rho\\,\\nu}\\,\\frac{\\delta}{|1+i|}.$$\nUsing $|1+i| = \\sqrt{2}$ and substituting $\\delta = \\sqrt{2\\,\\nu/|f|}$, we obtain the compact expression\n$$|\\boldsymbol{U}_{s}| \\;=\\; \\frac{|\\tau_{c}|}{\\rho\\,\\nu}\\,\\frac{\\sqrt{2\\,\\nu/|f|}}{\\sqrt{2}} \\;=\\; \\frac{|\\tau_{c}|}{\\rho\\,\\sqrt{\\nu\\,|f|}}.$$\n\nThus, the two target quantities are\n$$\\delta \\;=\\; \\sqrt{\\frac{2\\,\\nu}{|f|}}, \\qquad |\\boldsymbol{U}_{s}| \\;=\\; \\frac{\\sqrt{\\tau_{x}^{2}+\\tau_{y}^{2}}}{\\rho\\,\\sqrt{\\nu\\,|f|}}.$$\n\nWe now evaluate these for the given parameters $\\tau_{x}=0$, $\\tau_{y}=-0.2\\,\\mathrm{N\\,m^{-2}}$, $\\nu=0.015\\,\\mathrm{m^{2}\\,s^{-1}}$, $f=10^{-4}\\,\\mathrm{s^{-1}}$, and $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$.\n\nFirst, compute the Ekman depth:\n$$\\delta \\;=\\; \\sqrt{\\frac{2\\,\\nu}{|f|}} \\;=\\; \\sqrt{\\frac{2 \\times 0.015}{10^{-4}}} \\;=\\; \\sqrt{\\frac{0.03}{10^{-4}}} \\;=\\; \\sqrt{300} \\approx 17.3205\\,\\text{m}.$$\nNext, compute the magnitude of the surface current. The wind stress magnitude is\n$$|\\tau_{c}| \\;=\\; \\sqrt{\\tau_{x}^{2}+\\tau_{y}^{2}} \\;=\\; \\sqrt{0^{2}+(-0.2)^{2}} \\;=\\; 0.2\\,\\text{N\\,m^{-2}}.$$\nThe factor in the denominator is\n$$\\rho\\,\\sqrt{\\nu\\,|f|} \\;=\\; 1025 \\times \\sqrt{0.015 \\times 10^{-4}} \\;=\\; 1025 \\times \\sqrt{1.5\\times 10^{-6}} \\;\\approx\\; 1.25536\\,\\text{kg\\,m^{-2}\\,s^{-1/2}}.$$\nTherefore,\n$$|\\boldsymbol{U}_{s}| \\;=\\; \\frac{0.2}{1.25536} \\;\\approx\\; 0.15931\\,\\text{m\\,s^{-1}}.$$\n\nFinally, rounding both results to four significant figures,\n$$\\delta \\;\\approx\\; 17.32\\,\\text{m}, \\qquad |\\boldsymbol{U}_{s}| \\;\\approx\\; 0.1593\\,\\text{m\\,s^{-1}}.$$\n\nWe report the answers in the order requested: first $|\\boldsymbol{U}_{s}|$ in $\\mathrm{m\\,s^{-1}}$ and second $\\delta$ in $\\mathrm{m}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.1593  17.32\\end{pmatrix}}$$"
        },
        {
            "introduction": "Having established the dynamics of the Ekman layer, we now apply this knowledge to one of its most important consequences: coastal upwelling. This exercise () guides you in constructing a simple model based on mass conservation, directly linking offshore Ekman transport to the vertical velocity at the coast. By calculating the upwelling velocity at different latitudes, you will gain a quantitative appreciation for how the Earth's rotation governs the intensity of these biologically crucial phenomena.",
            "id": "4024714",
            "problem": "A straight eastern boundary coastline is subjected to a steady, spatially uniform, equatorward alongshore wind stress that induces coastal upwelling in the Northern Hemisphere. Consider the ocean surface layer governed by the hydrostatic, Boussinesq primitive equations on a rotating Earth with angular velocity $\\Omega$, and assume:\n- Steady state and horizontally homogeneous forcing alongshore,\n- The Coriolis parameter $f(\\phi)=2\\Omega \\sin\\phi$ at latitude $\\phi$,\n- A constant reference density $\\rho$,\n- A frictional surface Ekman layer whose vertically integrated momentum balance is dominated by the Coriolis force and turbulent stress divergence,\n- Incompressibility with continuity for the three-dimensional velocity field.\n\nTreat the coastal zone as a control volume of cross-shore width $L$, in which the wind-driven, depth-integrated offshore Ekman transport must be balanced by a mean vertical velocity $w$ at the coast through mass conservation. Starting from the rotating-frame momentum equations and the continuity equation, derive a leading-order expression for the upwelling velocity $w$ in terms of the applied wind stress magnitude $\\tau$, the density $\\rho$, the Coriolis parameter $f(\\phi)$, and the cross-shore scale $L$. Then, using your derived expression and the given Coriolis parameter $f(\\phi)=2\\Omega \\sin\\phi$, compute $w$ at $\\phi=15^\\circ$, $\\phi=30^\\circ$, and $\\phi=45^\\circ$ for fixed parameters:\n- $\\tau = 0.12$ newton per square meter,\n- $\\rho = 1025$ kilogram per cubic meter,\n- $L = 1.00 \\times 10^{5}$ meters,\n- $\\Omega = 7.2921159 \\times 10^{-5}$ radians per second.\n\nInterpret $w$ as positive for upward motion (upwelling). Express each of the three values of $w$ in meters per second, and round your final numerical answers to four significant figures.",
            "solution": "To derive the expression for the mean upwelling velocity $w$, we apply the principle of mass conservation to a coastal control volume.\n\n1.  **Ekman Transport:** The steady, equatorward alongshore wind stress $\\vec{\\tau} = (0, -\\tau)$ in the Northern Hemisphere (where $f > 0$) drives a depth-integrated Ekman volume transport, $\\vec{M}_{Ek} = (U_{Ek}, V_{Ek})$. The components are given by $U_{Ek} = \\frac{\\tau_y}{\\rho f}$ and $V_{Ek} = -\\frac{\\tau_x}{\\rho f}$. With the given wind stress, this simplifies to:\n    $$ U_{Ek} = -\\frac{\\tau}{\\rho f}, \\qquad V_{Ek} = 0 $$\n    The negative sign for $U_{Ek}$ indicates transport in the negative $x$-direction (offshore for an eastern boundary). The total volume of water transported offshore per second per unit length of coastline is $|U_{Ek}| = \\frac{\\tau}{\\rho f}$.\n\n2.  **Mass Balance:** Consider a control volume extending from the coast to a distance $L$ offshore, with a unit length along the coast. The volume of water leaving this box per second due to Ekman transport is $|U_{Ek}| \\times 1 = \\frac{\\tau}{\\rho f}$. To conserve mass (assuming incompressibility), this offshore transport must be balanced by an upward flux of water from below into the base of the control volume.\n\n3.  **Upwelling Velocity:** If $w$ is the mean vertical velocity over the width $L$, the total upward volume flux into the box is $w \\times L \\times 1$. Equating the upward flux with the offshore flux:\n    $$ w \\cdot L = \\frac{\\tau}{\\rho f} $$\n    Solving for $w$, we obtain the desired expression:\n    $$ w = \\frac{\\tau}{\\rho f L} $$\n    Substituting the latitude-dependent Coriolis parameter, $f(\\phi) = 2\\Omega\\sin\\phi$, we get:\n    $$ w(\\phi) = \\frac{\\tau}{\\rho L (2\\Omega \\sin\\phi)} $$\n    \nNow, we plug in the given values to compute $w$ at the three specified latitudes. The constant part of the expression is:\n$$ \\frac{\\tau}{2 \\rho \\Omega L} = \\frac{0.12}{2 \\times 1025 \\times (7.2921159 \\times 10^{-5}) \\times 10^5} \\approx 8.02736 \\times 10^{-6} \\, \\text{m/s} $$\n- For $\\phi=15^\\circ$: $w = \\frac{8.02736 \\times 10^{-6}}{\\sin(15^\\circ)} \\approx 3.101 \\times 10^{-5} \\, \\text{m/s}$.\n- For $\\phi=30^\\circ$: $w = \\frac{8.02736 \\times 10^{-6}}{\\sin(30^\\circ)} = 1.605 \\times 10^{-5} \\, \\text{m/s}$.\n- For $\\phi=45^\\circ$: $w = \\frac{8.02736 \\times 10^{-6}}{\\sin(45^\\circ)} \\approx 1.135 \\times 10^{-5} \\, \\text{m/s}$.\n\nThe results show that for a constant wind stress, upwelling is stronger at lower latitudes where the Coriolis effect is weaker.",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.101 \\times 10^{-5}  1.605 \\times 10^{-5}  1.135 \\times 10^{-5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "The ultimate goal in numerical modeling is to accurately represent continuous physical laws on a discrete computational grid. This practice () provides hands-on experience in this translation, asking you to implement a finite-difference scheme to compute Ekman pumping and suction from a given wind stress field. By comparing your numerical results against an exact analytical solution and evaluating the error for different grid resolutions, you will directly engage with the fundamental concepts of numerical accuracy and convergence, which are vital for developing and validating reliable climate and weather models.",
            "id": "4024713",
            "problem": "Consider an idealized straight coastline aligned along the $y$-axis, with the ocean occupying the half-space $x \\ge 0$. Assume an $f$-plane with constant Coriolis parameter $f$, constant seawater density $\\rho$, and a prescribed wind stress field that generates coastal upwelling and open-ocean downwelling. The domain is one-dimensional in the cross-shore direction $x \\in [0, L]$, with coastline at $x = 0$.\n\nFundamental base: In steady, vertically integrated momentum balance on an $f$-plane, the vertical velocity at the base of the Ekman layer (Ekman pumping/suction) is given by\n$$\nw_E(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right),\n$$\nwhere $\\tau_x$ and $\\tau_y$ are the $x$- and $y$-components of the wind stress, respectively, and $\\rho$ is the seawater density. Positive $w_E$ denotes upwelling.\n\nPrescribe the alongshore wind stress as\n$$\n\\tau_y(x) \\;=\\; \\tau_0 \\left(1 - e^{-x/L_r}\\right),\n$$\nwith constant amplitude $\\tau_0  0$ and coastal ramp length scale $L_r  0$. Prescribe a constant large-scale meridional gradient of the zonal wind stress,\n$$\n\\frac{\\partial \\tau_x}{\\partial y} \\;=\\; C,\n$$\nwith $C  0$ representing a background tendency toward open-ocean downwelling. The exact Ekman vertical velocity implied by these prescriptions is\n$$\nw_{\\text{exact}}(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r}e^{-x/L_r} - C\\right).\n$$\nThe zero-crossing location $x_0$ where $w_{\\text{exact}}(x_0) = 0$ is\n$$\nx_0 \\;=\\; -L_r \\,\\ln\\!\\left(\\frac{C L_r}{\\tau_0}\\right),\n$$\nprovided $0  \\frac{C L_r}{\\tau_0}  1$.\n\nNumerical task: Discretize the interval $[0, L]$ with uniformly spaced grid points $x_i = i\\,\\Delta x$ for $i = 0, 1, \\dots, N$, where $N = L/\\Delta x$ is an integer and $\\Delta x$ is the grid spacing. Approximate $\\frac{\\partial \\tau_y}{\\partial x}$ using a second-order accurate finite-difference scheme:\n- At the coastline ($i = 0$), use the one-sided forward formula\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_0} \\approx \\frac{-3\\,\\tau_y(x_0) + 4\\,\\tau_y(x_1) - \\tau_y(x_2)}{2\\,\\Delta x}.\n$$\n- At interior points ($i = 1, 2, \\dots, N-1$), use the central formula\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} \\approx \\frac{\\tau_y(x_{i+1}) - \\tau_y(x_{i-1})}{2\\,\\Delta x}.\n$$\n- At the offshore boundary ($i = N$), use the one-sided backward formula\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_N} \\approx \\frac{3\\,\\tau_y(x_N) - 4\\,\\tau_y(x_{N-1}) + \\tau_y(x_{N-2})}{2\\,\\Delta x}.\n$$\n\nCompute the discrete Ekman vertical velocity\n$$\nw_{\\text{num}}(x_i) \\;=\\; \\frac{1}{\\rho f}\\left(\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} - C\\right).\n$$\n\nEvaluation metrics:\n1. Coastal upwelling convergence: Compare $w_{\\text{num}}(0)$ with $w_{\\text{exact}}(0)$ and report the absolute relative error\n$$\nE_w(\\Delta x) \\;=\\; \\left|\\frac{w_{\\text{num}}(0) - w_{\\text{exact}}(0)}{w_{\\text{exact}}(0)}\\right|,\n$$\nwhich is unitless (a decimal fraction).\n2. Zero-crossing convergence: Estimate the numerical zero-crossing location $x_{0,\\text{num}}$ by identifying the first index $i$ such that $w_{\\text{num}}(x_i)  0$ and $w_{\\text{num}}(x_{i+1})  0$ and performing linear interpolation:\n$$\nx_{0,\\text{num}} \\;=\\; x_i + \\Delta x \\,\\frac{w_{\\text{num}}(x_i)}{w_{\\text{num}}(x_i) - w_{\\text{num}}(x_{i+1})}.\n$$\nReport the absolute error\n$$\nE_x(\\Delta x) \\;=\\; \\left|x_{0,\\text{num}} - x_0\\right|,\n$$\nexpressed in meters.\n\nConstants and test suite:\n- $\\rho = 1025\\,\\mathrm{kg/m^3}$,\n- $f = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$,\n- $\\tau_0 = 0.2\\,\\mathrm{N/m^2}$,\n- $L_r = 50\\,\\mathrm{km}$,\n- $C = 2.0\\times 10^{-7}\\,\\mathrm{N/m^3}$,\n- $L = 400\\,\\mathrm{km}$,\n- Grid spacings $\\Delta x \\in \\{20\\,\\mathrm{km}, 10\\,\\mathrm{km}, 5\\,\\mathrm{km}, 2\\,\\mathrm{km}\\}$.\n\nUnits:\n- Report vertical velocities in $\\mathrm{m/s}$ if needed for intermediate calculations, but the coastal upwelling error $E_w(\\Delta x)$ must be unitless (decimal fraction).\n- Report zero-crossing absolute error $E_x(\\Delta x)$ in meters.\n\nFinal output format:\nYour program should produce a single line of output containing eight comma-separated floats enclosed in square brackets, ordered by increasing grid resolution as\n$$\n[E_w(20\\,\\mathrm{km}),\\,E_x(20\\,\\mathrm{km}),\\,E_w(10\\,\\mathrm{km}),\\,E_x(10\\,\\mathrm{km}),\\,E_w(5\\,\\mathrm{km}),\\,E_x(5\\,\\mathrm{km}),\\,E_w(2\\,\\mathrm{km}),\\,E_x(2\\,\\mathrm{km})].\n$$\nEnsure that the domain discretization uses the specified finite-difference formulas. The answer must be self-contained and runnable for the given constants without any user input.",
            "solution": "This solution implements the specified numerical scheme to calculate the Ekman vertical velocity and evaluate the accuracy of the approximation. The process is broken down into the following steps, which are executed for each grid spacing in the test suite.\n\n1.  **Calculate Exact Solutions:** First, we compute the analytical values for the two quantities of interest, which serve as the benchmark for our numerical results.\n    -   The exact coastal upwelling velocity at $x=0$ is:\n        $$ w_{\\text{exact}}(0) = \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r} - C\\right) $$\n    -   The exact location of the zero-crossing is:\n        $$ x_0 = -L_r \\ln\\left(\\frac{C L_r}{\\tau_0}\\right) $$\n\n2.  **Set Up Numerical Grid:** For a given grid spacing $\\Delta x$, we define a one-dimensional array of points $x_i = i\\,\\Delta x$ from $x=0$ to $x=L$.\n\n3.  **Discretize Wind Stress and Compute Derivative:** The wind stress function $\\tau_y(x)$ is evaluated at each grid point $x_i$. Then, its derivative, $\\frac{\\partial \\tau_y}{\\partial x}$, is approximated numerically using the three distinct second-order finite-difference formulas provided for the coastline, the interior points, and the offshore boundary.\n\n4.  **Compute Numerical Vertical Velocity:** The numerical Ekman velocity, $w_{\\text{num}}(x_i)$, is calculated at each grid point using the computed derivative:\n    $$ w_{\\text{num}}(x_i) = \\frac{1}{\\rho f}\\left(\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} - C\\right) $$\n\n5.  **Evaluate Error Metrics:**\n    -   **Coastal Upwelling Error ($E_w$):** The absolute relative error between the numerical velocity at the coast, $w_{\\text{num}}(0)$, and the exact value, $w_{\\text{exact}}(0)$, is computed.\n    -   **Zero-Crossing Error ($E_x$):** We search the $w_{\\text{num}}$ array to find the two adjacent grid points where the velocity changes sign from positive (upwelling) to negative (downwelling). The numerical zero-crossing location, $x_{0,\\text{num}}$, is then found by linear interpolation between these two points. The absolute error is the difference between this numerical estimate and the exact location, $|x_{0,\\text{num}} - x_0|$.\n\nThe Python code provided in the answer block executes these steps for each grid spacing ($\\Delta x = 20, 10, 5, 2$ km) and formats the resulting eight error values as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical errors for a 1D coastal upwelling model.\n\n    This function solves the problem as stated, calculating the absolute relative error\n    of the coastal upwelling velocity and the absolute error of the zero-crossing location\n    for four different grid resolutions.\n    \"\"\"\n    # Define physical constants and parameters in S.I. units.\n    RHO = 1025.0         # Seawater density (kg/m^3)\n    F_CORIOLIS = 1.0e-4  # Coriolis parameter (s^-1)\n    TAU0 = 0.2           # Wind stress amplitude (N/m^2)\n    LR = 50000.0         # Coastal ramp length scale (m)\n    C_GRAD = 2.0e-7      # Background stress gradient (N/m^3)\n    L_DOMAIN = 400000.0  # Domain length (m)\n\n    # Test suite of grid spacings in kilometers.\n    dx_values_km = [20.0, 10.0, 5.0, 2.0]\n\n    # --- Step 1: Calculate exact analytical solutions ---\n    # These are constant for all test cases.\n    \n    # Exact vertical velocity at the coast (x=0)\n    w_exact_0 = (TAU0 / LR - C_GRAD) / (RHO * F_CORIOLIS)\n    \n    # Exact zero-crossing location x0 where w_exact(x0) = 0\n    x0_exact = -LR * np.log(C_GRAD * LR / TAU0)\n\n    results = []\n\n    # --- Step 2: Loop over each grid resolution ---\n    for dx_km in dx_values_km:\n        dx_m = dx_km * 1000.0\n        n_cells = int(L_DOMAIN / dx_m)\n        n_points = n_cells + 1\n\n        # a. Generate the computational grid\n        x_grid = np.linspace(0.0, L_DOMAIN, n_points)\n\n        # b. Evaluate the wind stress tau_y on the grid\n        tau_y_grid = TAU0 * (1.0 - np.exp(-x_grid / LR))\n\n        # c. Approximate the derivative d(tau_y)/dx using finite differences\n        dtau_y_dx = np.zeros(n_points)\n\n        if n_points  3:\n            raise ValueError(\"Grid resolution is too coarse for the 3-point stencils.\")\n\n        # At the coastline (i=0), use the forward difference formula\n        dtau_y_dx[0] = (-3.0 * tau_y_grid[0] + 4.0 * tau_y_grid[1] - tau_y_grid[2]) / (2.0 * dx_m)\n\n        # At the offshore boundary (i=N), use the backward difference formula\n        dtau_y_dx[n_cells] = (3.0 * tau_y_grid[n_cells] - 4.0 * tau_y_grid[n_cells - 1] + tau_y_grid[n_cells - 2]) / (2.0 * dx_m)\n\n        # At interior points (i=1,...,N-1), use the central difference formula\n        dtau_y_dx[1:n_cells] = (tau_y_grid[2:n_points] - tau_y_grid[0:n_cells - 1]) / (2.0 * dx_m)\n\n        # d. Compute the numerical vertical velocity w_num\n        w_num_grid = (dtau_y_dx - C_GRAD) / (RHO * F_CORIOLIS)\n\n        # --- Step 3: Calculate the evaluation metrics ---\n\n        # Metric 1: Coastal upwelling convergence, E_w(dx)\n        w_num_0 = w_num_grid[0]\n        e_w = np.abs((w_num_0 - w_exact_0) / w_exact_0)\n\n        # Metric 2: Zero-crossing convergence, E_x(dx)\n        # Find the first index 'i' where w_num > 0 and w_num[i+1]  0\n        try:\n            # np.where returns a tuple of arrays; we need the first element of the first array.\n            i_cross = np.where((w_num_grid[:-1] > 0)  (w_num_grid[1:]  0))[0][0]\n        except IndexError:\n            raise ValueError(f\"Zero-crossing not found for dx = {dx_km} km. \"\n                             \"The numerical velocity does not change sign.\")\n\n        # Perform linear interpolation to find the numerical zero crossing x0_num\n        x_i = x_grid[i_cross]\n        w_i = w_num_grid[i_cross]\n        w_i_plus_1 = w_num_grid[i_cross + 1]\n        \n        x0_num = x_i + dx_m * w_i / (w_i - w_i_plus_1)\n\n        e_x = np.abs(x0_num - x0_exact)\n\n        results.extend([e_w, e_x])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}