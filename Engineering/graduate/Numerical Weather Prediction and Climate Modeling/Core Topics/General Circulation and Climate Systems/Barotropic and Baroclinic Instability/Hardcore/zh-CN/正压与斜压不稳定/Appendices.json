{
    "hands_on_practices": [
        {
            "introduction": "斜压不稳定性的驱动力来自于水平温度梯度中储存的有效位能。本练习将引导你动手推导热成风关系，这是将温度结构与地转风垂直切变联系起来的数学基石。通过计算这种切变，你将对如何定义斜压大气（即此类不稳定性发生的基本前提）获得一个具体的理解。",
            "id": "4015769",
            "problem": "考虑一个中纬度、天气尺度的气流，该气流近似处于地转平衡和静力平衡状态，并且可以很好地用理想气体定律来描述。从这些基本原理出发，通过结合地转平衡、静力平衡和理想气体定律，推导高度坐标系下的热成风关系。然后，利用该关系式，在给定均匀的经向温度梯度 $\\,\\partial T/\\partial y=-5\\,\\mathrm{K}/1000\\,\\mathrm{km}\\,$、代表性平均温度 $\\,T_0=280\\,\\mathrm{K}\\,$ 和恒定的中纬度科里奥利参数 $\\,f_0=10^{-4}\\,\\mathrm{s^{-1}}\\,$ 的条件下，计算纬向地转风的垂直切变 $\\,\\partial U/\\partial z\\,$。取重力加速度为 $\\,g=9.81\\,\\mathrm{m\\,s^{-2}}\\,$，干空气气体常数为 $\\,R_d=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}\\,$。在计算出 $\\,\\partial U/\\partial z\\,$ 后，根据切变的符号和水平温度梯度的存在，简要推断气流是斜压的还是正压的。将 $\\,\\partial U/\\partial z\\,$ 的最终数值答案以 $\\mathrm{s^{-1}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导高度坐标系中的热成风关系，并应用该关系计算纬向地转风的垂直切变。此外，还要求推断气流的性质（斜压或正压）。\n\n### 第1步：问题验证\n\n首先，我将验证问题陈述。\n\n**1.1. 提取给定条件：**\n-   气流特征：中纬度、天气尺度、近似处于地转平衡和静力平衡。\n-   状态方程：理想气体定律。\n-   任务1：推导高度坐标系中的热成风关系。\n-   任务2：计算纬向地转风的垂直切变，$\\frac{\\partial U}{\\partial z}$。\n-   计算的输入数据：\n    -   经向温度梯度：$\\frac{\\partial T}{\\partial y} = -5\\,\\mathrm{K}/1000\\,\\mathrm{km}$。\n    -   代表性平均温度：$T_0 = 280\\,\\mathrm{K}$。\n    -   科里奥利参数：$f_0 = 10^{-4}\\,\\mathrm{s^{-1}}$。\n    -   重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n    -   干空气气体常数：$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n-   任务3：推断气流是斜压还是正压。\n-   输出格式：$\\frac{\\partial U}{\\partial z}$ 的最终数值答案，单位为 $\\mathrm{s^{-1}}$，四舍五入到四位有效数字。\n\n**1.2. 使用提取的给定条件进行验证：**\n-   **科学依据：** 该问题基于大气动力学（地转平衡、静力平衡）和热力学（理想气体定律）的基本原理。热成风关系的推导是气象学中的标准程序。所提供的物理常数和参数对于地球中纬度地区是符合实际的。\n-   **适定性：** 该问题要求进行推导和具体计算。所提供的数据对于计算似乎是充分的，尽管如下文所示，为了得到一个单一的数值结果，需要一个标准的近似。这是该领域教科书问题的典型特征，并不意味着问题不适定，而是理想化的。\n-   **客观性：** 语言精确且无偏见。\n-   **完整性与一致性：** 问题是自洽的。没有矛盾之处。给定常数的单位是一致的。\n\n**1.3. 结论与行动：**\n该问题是有效的。它代表了大气动力学中一个理想化但标准的练习。我将继续进行解答。\n\n### 第2步：高度坐标系中热成风关系的推导\n\n推导从所提供的三个基本关系式开始：\n\n1.  **地转平衡（纬向分量）：** 地转风 $U_g$ 与恒定高度面上的经向气压梯度有关。\n    $$U_g = -\\frac{1}{f_0 \\rho} \\left(\\frac{\\partial p}{\\partial y}\\right)_z$$\n    此处，$\\rho$ 是空气密度，$p$ 是气压，$f_0$ 是科里奥利参数。下标 $z$ 表示偏导数是在恒定高度上求得的。为简便起见，由于我们是在高度坐标系中工作，此后将省略该下标。\n\n2.  **静力平衡：** 垂直气压梯度与重力相平衡。\n    $$\\frac{\\partial p}{\\partial z} = -\\rho g$$\n\n3.  **理想气体定律：**\n    $$p = \\rho R_d T$$\n    其中 $T$ 是温度，$R_d$ 是干空气的比气体常数。\n\n我们的目标是找到垂直风切变 $\\frac{\\partial U_g}{\\partial z}$ 的表达式。一个可靠的方法是从方程中消去气压和密度。\n\n首先，我们结合静力平衡和理想气体定律。由理想气体定律，$\\rho = \\frac{p}{R_d T}$。将其代入静力平衡方程，得到：\n$$\\frac{\\partial p}{\\partial z} = -\\frac{p g}{R_d T}$$\n这可以用气压的自然对数来表示：\n$$\\frac{1}{p}\\frac{\\partial p}{\\partial z} = \\frac{\\partial (\\ln p)}{\\partial z} = -\\frac{g}{R_d T}$$\n为了引入水平温度梯度，我们对此方程关于 $y$ 求偏导数，并假设偏导数的可交换性：\n$$\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial (\\ln p)}{\\partial z}\\right) = \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial (\\ln p)}{\\partial y}\\right) = \\frac{\\partial}{\\partial y}\\left(-\\frac{g}{R_d T}\\right) = \\frac{g}{R_d T^2}\\frac{\\partial T}{\\partial y}$$\n这提供了水平气压梯度的垂直变化与水平温度梯度之间的关键联系。\n\n接下来，我们使用理想气体定律重写地转风方程。从 $p = \\rho R_d T$，我们有 $\\frac{1}{\\rho} = \\frac{R_d T}{p}$。代入 $U_g$ 的方程：\n$$U_g = -\\frac{1}{f_0} \\left(\\frac{R_d T}{p}\\right) \\frac{\\partial p}{\\partial y} = -\\frac{R_d T}{f_0} \\frac{\\partial (\\ln p)}{\\partial y}$$\n现在，我们对这个 $U_g$ 的表达式关于 $z$ 求导，应用乘法法则：\n$$\\frac{\\partial U_g}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(-\\frac{R_d T}{f_0} \\frac{\\partial (\\ln p)}{\\partial y}\\right) = -\\frac{R_d}{f_0} \\left[ \\frac{\\partial T}{\\partial z}\\frac{\\partial (\\ln p)}{\\partial y} + T \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial (\\ln p)}{\\partial y}\\right) \\right]$$\n现在我们可以将先前推导出的表达式代入此方程。\n从 $U_g$ 方程，我们有 $\\frac{\\partial (\\ln p)}{\\partial y} = -\\frac{f_0 U_g}{R_d T}$。\n从静力关系，我们有 $\\frac{\\partial}{\\partial z}\\left(\\frac{\\partial (\\ln p)}{\\partial y}\\right) = \\frac{g}{R_d T^2}\\frac{\\partial T}{\\partial y}$。\n代入这些表达式得到：\n$$\\frac{\\partial U_g}{\\partial z} = -\\frac{R_d}{f_0} \\left[ \\frac{\\partial T}{\\partial z}\\left(-\\frac{f_0 U_g}{R_d T}\\right) + T\\left(\\frac{g}{R_d T^2}\\frac{\\partial T}{\\partial y}\\right) \\right]$$\n简化方括号中的项：\n$$\\frac{\\partial U_g}{\\partial z} = -\\frac{R_d}{f_0} \\left[ -\\frac{f_0 U_g}{R_d T}\\frac{\\partial T}{\\partial z} + \\frac{g}{R_d T}\\frac{\\partial T}{\\partial y} \\right]$$\n将 $-\\frac{R_d}{f_0}$ 项分配进去：\n$$\\frac{\\partial U_g}{\\partial z} = \\frac{U_g}{T}\\frac{\\partial T}{\\partial z} - \\frac{g}{f_0 T}\\frac{\\partial T}{\\partial y}$$\n这就是高度坐标系中纬向风的热成风关系。我们可以类似地写出完整的矢量关系：\n$$\\frac{\\partial \\vec{u}_g}{\\partial z} = \\frac{\\vec{u}_g}{T}\\frac{\\partial T}{\\partial z} - \\frac{g}{f_0 T} \\vec{k} \\times \\nabla_z T$$\n其中 $\\vec{k}$ 是垂直单位矢量，$\\nabla_z T$ 是水平温度梯度。\n\n### 第3步：垂直风切变的计算\n\n推导出的纬向风切变关系式为 $\\frac{\\partial U_g}{\\partial z} = \\frac{U_g}{T}\\frac{\\partial T}{\\partial z} - \\frac{g}{f_0 T}\\frac{\\partial T}{\\partial y}$。问题给出了 $\\frac{\\partial T}{\\partial y}$、$T_0$、$g$ 和 $f_0$ 的值，但没有给出地转风 $U_g$ 或垂直温度梯度 $\\frac{\\partial T}{\\partial z}$ 的值。这意味着题目意在进行一个标准的简化。在许多应用中，右侧的第一项比第二项小，或者该关系式在 $U_g=0$ 处求值。在入门教材中，一个常见的简化是忽略这一项，这相当于假设恒定气压面上的水平温度梯度约等于恒定高度面上的水平温度梯度。我们采用这个标准的近似：\n$$\\frac{\\partial U}{\\partial z} \\approx -\\frac{g}{f_0 T} \\left(\\frac{\\partial T}{\\partial y}\\right)$$\n我们将使用代表性平均温度 $T_0$ 来代替 $T$。\n\n现在，我们代入给定的数值。\n首先，将温度梯度转换为国际单位制（SI）单位：\n$$\\frac{\\partial T}{\\partial y} = -5\\,\\mathrm{K}/1000\\,\\mathrm{km} = \\frac{-5\\,\\mathrm{K}}{1000 \\times 1000\\,\\mathrm{m}} = -5 \\times 10^{-6}\\,\\mathrm{K\\,m^{-1}}$$\n其他参数为：\n-   $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n-   $f_0 = 10^{-4}\\,\\mathrm{s^{-1}}$\n-   $T_0 = 280\\,\\mathrm{K}$\n\n将这些值代入简化的热成风方程：\n$$\\frac{\\partial U}{\\partial z} = -\\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{(10^{-4}\\,\\mathrm{s^{-1}}) \\times (280\\,\\mathrm{K})} \\times (-5 \\times 10^{-6}\\,\\mathrm{K\\,m^{-1}})$$\n$$\\frac{\\partial U}{\\partial z} = \\frac{9.81 \\times 5 \\times 10^{-6}}{280 \\times 10^{-4}} \\,\\mathrm{s^{-1}}$$\n$$\\frac{\\partial U}{\\partial z} = \\frac{49.05 \\times 10^{-6}}{2.8 \\times 10^{-2}} \\,\\mathrm{s^{-1}} = \\frac{49.05}{2.8} \\times 10^{-4} \\,\\mathrm{s^{-1}}$$\n$$\\frac{\\partial U}{\\partial z} \\approx 17.517857... \\times 10^{-4} \\,\\mathrm{s^{-1}} = 1.7517857... \\times 10^{-3} \\,\\mathrm{s^{-1}}$$\n四舍五入到四位有效数字，我们得到：\n$$\\frac{\\partial U}{\\partial z} \\approx 1.752 \\times 10^{-3}\\,\\mathrm{s^{-1}}$$\n\n### 第4步：关于斜压与正压流的推断\n\n**正压**流体是指密度仅为气压的函数，即 $\\rho = \\rho(p)$ 的流体。这意味着等压面和等密度面是平行的。根据理想气体定律，这也意味着等温面与等压面平行。在处于地转平衡的正压大气中，地转风不随高度变化，即热成风切变为零。\n\n**斜压**流体是指密度是气压和温度的函数，即 $\\rho = \\rho(p, T)$ 的流体。在这种情况下，等压面和等密度面不平行；它们会相交。这要求在等压面上存在水平温度梯度。\n\n热成风关系式 $\\frac{\\partial U_g}{\\partial z} \\approx -\\frac{g}{f_0 T} \\frac{\\partial T}{\\partial y}$ 直接将地转风的垂直切变与水平温度梯度联系起来。在本问题中，我们给出了一个非零的水平温度梯度（$\\frac{\\partial T}{\\partial y} \\neq 0$），这导致了一个非零的垂直风切变（$\\frac{\\partial U}{\\partial z} \\neq 0$）。这种切变的存在是斜压大气的定义性特征。因此，该气流是**斜压**的。\n\n$\\frac{\\partial T}{\\partial y}$ 的负号（温度向北递减，是北半球的典型情况）与公式中的负号相结合，产生了一个正切变 $\\frac{\\partial U}{\\partial z}  0$。这表明纬向风（西风）随高度增加而增强，这是中纬度急流的一个标志性特征，也是一个经典的斜压现象。",
            "answer": "$$\\boxed{1.752 \\times 10^{-3}}$$"
        },
        {
            "introduction": "不稳定性导致位涡（PV）异常的增长，而这些异常反过来又组织起天气系统。位涡反演的概念使我们能够根据给定的位涡分布，诊断出与之平衡的风场和压力场。这个高阶练习探讨了反演准地转位涡的数学方法，帮助你深入理解一个局地位涡异常（例如由不稳定性产生的异常）如何能够诱导出一个大尺度的气旋性环流。",
            "id": "4015817",
            "problem": "考虑一个中纬度、稳定层结的Boussinesq流体，在准地转近似下位于一个$f$平面上，其中科里奥利参数$f_0$和Brunt–Väisälä频率$N$为常数。设地转流函数扰动为$\\psi'(x,y,z)$，准地转位涡（QGPV）扰动为$q'(x,y,z)$。假设在$(x,y)$方向上为水平双周期区域，周期分别为$L_x$和$L_y$，并在$z=H$处有刚盖上边界，在$z=0$处有刚盖下边界，同时在$z=H$和$z=0$处分别有给定的表面浮力扰动$b_t(x,y)$和$b_b(x,y)$。\n\n从地转平衡、静力平衡以及连续层结流体中QGPV的定义出发，可以证明QGPV扰动满足\n$$\nq'(x,y,z) \\;=\\; \\nabla_h^2 \\psi'(x,y,z) \\;+\\; \\frac{\\partial}{\\partial z}\\!\\left(\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}(x,y,z)\\right),\n$$\n其中$\\nabla_h^2 \\equiv \\partial^2/\\partial x^2 + \\partial^2/\\partial y^2$是水平拉普拉斯算子。位势与浮力之间的静力关系意味着$b'(x,y,z) = f_0\\,\\partial \\psi'/\\partial z$，而该椭圆算子的自然边界条件通过指定以下关系来施加\n$$\n\\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}\\right|_{z=H} \\;=\\; \\frac{f_0}{N^2}\\,b_t(x,y), \n\\qquad\n\\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}\\right|_{z=0} \\;=\\; \\frac{f_0}{N^2}\\,b_b(x,y).\n$$\n给定$q'(x,y,z)$以及两个边界面上的场$b_t(x,y)$和$b_b(x,y)$。位涡反演的任务是与所述的平衡关系和边界条件相一致地恢复$\\psi'(x,y,z)$。\n\n下列哪些程序和边界条件能够产生一个唯一的、物理上一致的$\\psi'(x,y,z)$，使其满足控制方程和相应的边界条件？选择所有适用的选项。\n\nA. 对控制方程进行水平傅里叶变换，从而对每个波数对$(k,\\ell)$，在$z$方向上得到一维边值问题，\n$$\n\\frac{\\partial}{\\partial z}\\!\\left(\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\widehat{\\psi'}(k,\\ell,z)}{\\partial z}\\right) \\;-\\; (k^2+\\ell^2)\\,\\widehat{\\psi'}(k,\\ell,z) \\;=\\; \\widehat{q'}(k,\\ell,z),\n$$\n其边界条件为\n$$\n\\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\widehat{\\psi'}(k,\\ell,z)}{\\partial z}\\right|_{z=H} \\;=\\; \\frac{f_0}{N^2}\\,\\widehat{b_t}(k,\\ell), \n\\qquad\n\\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\widehat{\\psi'}(k,\\ell,z)}{\\partial z}\\right|_{z=0} \\;=\\; \\frac{f_0}{N^2}\\,\\widehat{b_b}(k,\\ell).\n$$\n对每个$(k,\\ell)$求解这个Sturm–Liouville问题，通过$\\widehat{q'}$的垂直积分与边界数据的一致性，在$(k,\\ell)=(0,0)$模态下强制满足可解性条件，通过将$\\psi'$的区域平均值设为零来固定规范，然后进行逆变换以获得$\\psi'(x,y,z)$。\n\nB. 将$\\psi'(x,y,z)$展开为求解齐次Sturm–Liouville问题的垂直本征模\n$$\n-\\frac{\\partial}{\\partial z}\\!\\left(\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\phi_n}{\\partial z}\\right) \\;=\\; \\lambda_n\\,\\phi_n(z),\n$$\n在齐次边界条件$\\left.(\\frac{f_0^2}{N^2}\\,\\partial \\phi_n/\\partial z)\\right|_{z=0,H}=0$下，使得$\\psi'(x,y,z)=\\sum_{n=0}^\\infty a_n(x,y)\\,\\phi_n(z)$，其中$n=0$是正压模（$\\lambda_0=0$），$n\\ge 1$是斜压模（$\\lambda_n0$）。将$q'$投影到这些模态上，从而对每个$n$得到一个水平椭圆反演问题\n$$\n\\left(\\nabla_h^2 \\;-\\; \\lambda_n\\right)a_n(x,y) \\;=\\; q'_n(x,y) \\;+\\; \\text{边界诱导的强迫},\n$$\n其中“边界诱导的强迫”项通过一个加到齐次本征展开上的非齐次特解来解释非零的$b_t$和$b_b$。在谱空间中求解每个$a_n$，在正压分量中强制满足$(k,\\ell)=(0,0)$的可解性条件，并重构$\\psi'$。\n\nC. 通过忽略垂直伸缩项，将问题视为一个三维泊松方程，即在$(x,y,z)$中求解$\\nabla^2 \\psi' = q'$，并采用Dirichlet边界条件$\\psi'|_{z=0}=\\psi'|_{z=H}=0$和周期性侧边界，以获得$\\psi'$。\n\nD. 施加“自由滑”侧边界条件，并通过援引刚盖条件$w=0$将垂直导数$\\partial \\psi'/\\partial z$在$z=0$和$z=H$处设为零，然后在整个三维区域内数值反演$\\nabla^2 \\psi' = q'$以获得$\\psi'$。\n\n答案选项是独立的；选择所有正确的选项。",
            "solution": "问题陈述描述了准地转位涡（QGPV）的反演，这是地球物理流体动力学中的一个基本问题。任务是在给定QGPV扰动$q'(x,y,z)$以及顶、底边界上的浮力扰动$b_t(x,y)$和$b_b(x,y)$的情况下，求出地转流函数扰动$\\psi'(x,y,z)$。\n\n### 步骤1：提取已知条件\n\n-   **控制方程**：QGPV扰动$q'$和流函数扰动$\\psi'$之间的关系由以下椭圆型偏微分方程给出：\n    $$\n    q'(x,y,z) \\;=\\; \\nabla_h^2 \\psi'(x,y,z) \\;+\\; \\frac{\\partial}{\\partial z}\\!\\left(\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}(x,y,z)\\right)\n    $$\n    其中$\\nabla_h^2 = \\partial^2/\\partial x^2 + \\partial^2/\\partial y^2$。\n-   **区域**：一个三维区域$(x,y,z)$，在水平方向$(x,y)$上是双周期的，周期为$L_x$和$L_y$，在垂直方向上由位于$z=0$和$z=H$的刚盖所界定。\n-   **边界条件（BCs）**：垂直边界条件为Neumann类型，由静力关系$b' = f_0\\,\\partial \\psi'/\\partial z$和给定的表面浮力扰动导出：\n    $$\n    \\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}\\right|_{z=H} \\;=\\; \\frac{f_0}{N^2}\\,b_t(x,y)\n    $$\n    $$\n    \\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\psi'}{\\partial z}\\right|_{z=0} \\;=\\; \\frac{f_0}{N^2}\\,b_b(x,y)\n    $$\n-   **常数**：科里奥利参数$f_0$和Brunt–Väisälä频率$N$是常数。\n\n### 步骤2：使用提取的已知条件进行验证\n\n问题陈述在科学上是合理的、适定的和客观的。\n-   **科学依据**：这些方程和边界条件在准地转动力学理论中是标准的。QGPV反演问题是该领域的核心概念。\n-   **适定性**：该问题是一个线性椭圆边值问题。设算子为$L[\\psi'] = \\nabla_h^2 \\psi' + \\frac{\\partial}{\\partial z}(\\frac{f_0^2}{N^2} \\frac{\\partial \\psi'}{\\partial z})$。如果满足可解性条件，则解存在。将控制方程在整个区域体积$V$上积分，并应用散度定理以及周期和Neumann边界条件，我们发现：\n    $$\n    \\iiint_V q' \\,dV = \\iint dx\\,dy \\left[ \\frac{f_0^2}{N^2}\\frac{\\partial \\psi'}{\\partial z} \\right]_0^H = \\iint dx\\,dy \\left( \\frac{f_0}{N^2}b_t - \\frac{f_0}{N^2}b_b \\right)\n    $$\n    这个条件确保了PV的守恒，将内部PV源与边界浮力通量联系起来。$\\psi'$的解在相差一个任意加性常数的意义下是唯一的，因为算子$L$会使任何常数函数为零。这种“规范自由度”对于速度场（$\\mathbf{u}'_g = \\mathbf{k} \\times \\nabla_h \\psi'$）在物理上是无关紧要的，通常通过将$\\psi'$的区域平均值设为零来固定，即$\\iiint_V \\psi' \\,dV = 0$。通过这种规范固定，问题是适定的。\n-   **客观性**：问题使用了精确、标准的术语，没有歧义或主观因素。\n\n### 步骤3：判断与行动\n\n问题陈述是**有效的**。我们继续评估所提出的求解程序。\n\n### 逐项分析\n\n**A. 对水平方向进行傅里叶变换...**\n\n该选项建议在谱空间中求解水平维度的问题。\n1.  **傅里叶变换**：给定$x$和$y$方向的周期性边界条件，任何函数$f(x,y,z)$都可以用其傅里叶级数表示：$f(x,y,z) = \\sum_{k,\\ell} \\widehat{f}(k,\\ell,z) e^{i(kx+\\ell y)}$。水平拉普拉斯算子变换为$\\nabla_h^2 \\rightarrow -(k^2+\\ell^2)$。将此应用于控制方程，得到：\n    $$\n    \\widehat{q'}(k,\\ell,z) = -(k^2+\\ell^2)\\widehat{\\psi'}(k,\\ell,z) + \\frac{\\partial}{\\partial z}\\left(\\frac{f_0^2}{N^2}\\frac{\\partial \\widehat{\\psi'}}{\\partial z}\\right)\n    $$\n    重新整理得到每个波数对$(k,\\ell)$的常微分方程（ODE）：\n    $$\n    \\frac{\\partial}{\\partial z}\\left(\\frac{f_0^2}{N^2}\\frac{\\partial \\widehat{\\psi'}}{\\partial z}\\right) - (k^2+\\ell^2)\\widehat{\\psi'} = \\widehat{q'}\n    $$\n    这与选项中的方程相符。\n2.  **边界条件**：边界条件也进行变换，得到该ODE的Neumann条件：\n    $$\n    \\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\widehat{\\psi'}}{\\partial z}\\right|_{z=H} = \\frac{f_0}{N^2}\\,\\widehat{b_t}(k,\\ell), \\quad \\left.\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\widehat{\\psi'}}{\\partial z}\\right|_{z=0} = \\frac{f_0}{N^2}\\,\\widehat{b_b}(k,\\ell)\n    $$\n    这也与选项相符。\n3.  **可解性与唯一性**：对于任何非零波数（$(k,\\ell) \\neq (0,0)$），$k^2+\\ell^2  0$，这个带有Neumann边界条件的二阶ODE有唯一解。对于平均模态（$(k,\\ell)=(0,0)$），方程变为$\\frac{d}{dz}(\\frac{f_0^2}{N^2}\\frac{d \\widehat{\\psi'}}{dz}) = \\widehat{q'}$。从$z=0$到$z=H$积分并应用边界条件，得到可解性条件：\n    $$\n    \\int_0^H \\widehat{q'}(0,0,z) \\,dz = \\frac{f_0}{N^2}\\widehat{b_t}(0,0) - \\frac{f_0}{N^2}\\widehat{b_b}(0,0)\n    $$\n    这正是我们之前推导出的区域积分可解性条件。如果满足此条件，我们可以求解$\\widehat{\\psi'}(0,0,z)$，其解可相差一个积分常数。该选项正确地指出了需要强制满足此可解性条件。它还正确地说明了必须固定规范，通常是通过将$\\psi'$的区域平均值设为零，这决定了最终的常数。\n4.  **重构**：在求解出所有$(k,\\ell)$的$\\widehat{\\psi'}(k,\\ell,z)$后，通过傅里叶逆变换找到最终解$\\psi'(x,y,z)$。\n\n此程序是解决QGPV反演问题的标准、正确且完整的方法。\n\n**对A的结论**：**正确**。\n\n**B. 将$\\psi'(x,y,z)$展开为垂直本征模...**\n\n此选项提出了一种使用分离变量法和垂直模态展开的解法。\n1.  **垂直模态**：该程序将垂直模态$\\phi_n(z)$定义为具有齐次Neumann边界条件的垂直结构算子的本征函数：\n    $$\n    -\\frac{\\partial}{\\partial z}\\!\\left(\\frac{f_0^2}{N^2}\\,\\frac{\\partial \\phi_n}{\\partial z}\\right) \\;=\\; \\lambda_n\\,\\phi_n(z), \\quad \\text{with} \\quad \\left.\\frac{\\partial \\phi_n}{\\partial z}\\right|_{z=0,H}=0\n    $$\n    这是一个标准的Sturm-Liouville问题。它产生一个完备的正交函数基$\\{\\phi_n(z)\\}$。本征值$\\lambda_0=0$对应于正压模（$\\phi_0=\\text{常数}$），而$n \\ge 1$的本征值$\\lambda_n0$对应于斜压模。\n2.  **处理非齐次边界条件**：由于本征模是为齐次边界条件定义的，因此必须对具有非齐次边界条件的原始问题进行变换。一种标准方法是将解分解为$\\psi' = \\psi'_p + \\psi'_h$，其中$\\psi'_p$是满足非齐次边界条件的特解，而$\\psi'_h$满足一个带有齐次边界条件的调整后的偏微分方程。“边界诱导的强迫”一词抽象但正确地指代了由此过程产生的项（例如，$q' - L[\\psi'_p]$成为$\\psi'_h$问题的强迫项）。\n3.  **水平问题**：一旦问题在垂直方向上齐次化，解$\\psi'_h$就展开为$\\psi'_h(x,y,z) = \\sum_{n=0}^{\\infty} a_n(x,y) \\phi_n(z)$。将其代入修改后的偏微分方程并投影到每个模态$\\phi_n$上，可将问题解耦为一组水平Helmholtz方程：\n    $$\n    (\\nabla_h^2 - \\lambda_n) a_n(x,y) = \\text{Forcing}_n(x,y)\n    $$\n    其中$\\text{Forcing}_n$包括内部PV $q'$和边界诱导项的投影。\n4.  **可解性**：对于正压模（$n=0, \\lambda_0=0$），方程是一个泊松方程$\\nabla_h^2 a_0 = \\text{Forcing}_0$。在周期性水平区域上积分表明，只有当$\\text{Forcing}_0$的水平平均值为零时，$a_0$的解才存在。这是整体可解性条件在此模态框架下的体现。该选项正确地提到了这一点。\n\n此程序是另一种用于QGPV反演的标准、正确的方法。\n\n**对B的结论**：**正确**。\n\n**C. 将问题视为一个三维泊松方程...**\n\n该选项提出了几个不合理的简化。\n1.  **修改后的算子**：“忽略垂直伸缩项”以得到$\\nabla^2 \\psi'$是不正确的。实际的垂直项是$\\frac{\\partial}{\\partial z}(\\frac{f_0^2}{N^2} \\frac{\\partial \\psi'}{\\partial z})$。由于$N$和$f_0$是常数，该项为$\\frac{f_0^2}{N^2} \\frac{\\partial^2 \\psi'}{\\partial z^2}$。正确的算子是$\\nabla_h^2 + \\frac{f_0^2}{N^2} \\frac{\\partial^2}{\\partial z^2}$。用各向同性的拉普拉斯算子$\\nabla^2 = \\nabla_h^2 + \\frac{\\partial^2}{\\partial z^2}$来替换它，等同于在长度无量纲化时假设Burger数$S = (\\frac{N H}{f_0 L})^2 = 1$，这是一个强烈的、物理上任意的假设。它通过施加一个人为的宽高比从根本上改变了动力学。\n2.  **修改后的边界条件**：该选项建议用齐次Dirichlet边界条件$\\psi'|_{z=0}=\\psi'|_{z=H}=0$替换物理上导出的Neumann边界条件。这是一个严重的错误。指定的Neumann条件携带了关于表面浮力异常的关键信息，这些异常充当流动的源/汇。抛弃它们并施加$\\psi'=0$与问题设定在物理上不一致，并将导致一个完全不同的、不正确的解。\n\n此程序解决的不是给定的问题，而是一个完全不同且物理上不合理的另一个问题。\n\n**对C的结论**：**不正确**。\n\n**D. 施加“自由滑”侧边界条件并将垂直导数$\\partial \\psi'/\\partial z$设为零...**\n\n该选项也包含多个根本性错误。\n1.  **修改后的侧边界条件**：问题指定了一个水平双周期区域。该选项建议用“自由滑”侧边界条件替换它。这将区域的拓扑结构从环面改变为带壁的通道或盒子，这是一个不同的物理问题。\n2.  **修改后的垂直边界条件**：该选项建议在边界处设置$\\partial \\psi'/\\partial z = 0$，并以“援引刚盖条件$w=0$”作为理由。在$z=0,H$处的刚盖条件$w=0$通过准地转热力学方程意味着浮力的物质导数在边界处为零：$D_g b'/Dt = 0$。这是一个关于边界浮力演变的预报性陈述。它并*不*意味着浮力本身$b' = f_0 \\partial \\psi'/\\partial z$在所有时刻都为零。问题明确给出了非零的表面浮力场$b_t$和$b_b$，这与所提出的条件$\\partial \\psi'/\\partial z = 0$直接矛盾。\n3.  **修改后的算子**：与选项C一样，这建议使用$\\nabla^2 \\psi'$，根据上述原因，这是不正确的。\n\n此程序误解了物理条件，并施加了与问题陈述不一致的边界条件和算子。\n\n**对D的结论**：**不正确**。\n\n### 结论\n\n选项A和B都描述了用于解决所述QGPV反演问题的有效、标准且物理上一致的数学程序。选项C和D提出的方法在物理上和数学上都是有缺陷的，因为它们以与问题前提不一致的方式改变了控制方程和/或边界条件。",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}