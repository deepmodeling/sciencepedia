{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的海冰模型之前，我们首先从一个基本的热力学问题入手 。这个练习将引导你推导在一个简化的雪-冰柱中，稳定的温度是如何垂直分布的。通过求解傅里叶热传导定律，你将掌握分析多层介质中热量传输的基本方法，这是理解海冰热力学行为的基石。",
            "id": "4086020",
            "problem": "考虑一个处于静止大气和海洋中的一维垂直雪-海冰柱，该模型适用于数值天气预报和气候模拟中使用的纯热力学柱状模型。设垂直坐标 $z$ 向上增加，冰-海界面处 $z=0$，$0 \\le z \\le H_{i}$ 为厚度为 $H_{i}$ 的海冰层，而 $H_{i} \\le z \\le H_{i}+H_{s}$ 为厚度为 $H_{s}$ 的雪层。假设冰的热导率 $k_{i}$ 和雪的热导率 $k_{s}$ 均为常数，层内没有内部热源或热汇，且系统处于稳态（温度不随时间变化）。\n\n在顶部雪面 $z=H_{i}+H_{s}$ 处，进入大气的净向上表面热通量为一个给定的常数 $Q_{s}$（定义向上通量为正）。在底部冰-海界面 $z=0$ 处，海洋向冰层提供一个给定的常数向上基础热通量 $Q_{o}$。假设冰-海界面温度固定在（依赖于盐度的）海水冰点温度 $T_{f}$，并且没有界面相变（没有融化或冻结速率），因此传导热通量在整个柱体中是连续的。\n\n从 (i) 每层在稳态下的能量守恒和 (ii) 傅里叶热传导定律出发，推导每层中的垂直线性温度分布，并在雪-冰界面处施加温度和热通量的连续性条件。确定雪面温度 $T_{s} \\equiv T(H_{i}+H_{s})$ 的显式解析表达式，该表达式用 $T_{f}$、$H_{i}$、$H_{s}$、$k_{i}$、$k_{s}$、$Q_{s}$ 和 $Q_{o}$ 表示，并给出由稳态和所述假设所隐含的任何必要的一致性条件。\n\n最终温度以开尔文表示。不需要进行数值计算；请提供精确的符号表达式。最终答案必须是单一的闭式解析表达式。",
            "solution": "该问题被验证为具有科学依据、适定、客观和完整。它描述了一个通过双层复合板的标准一维稳态热传导问题，这是热力学及其在地球物理学应用中的一个基本模型。\n\n求解过程通过应用能量守恒原理和傅里叶热传导定律进行。\n\n首先，我们考虑热传递的控制方程。在一个没有内部热源或热汇的一维稳态系统中，能量守恒原理简化为热通量 $Q$ 相对于空间坐标 $z$ 必须为常数。问题在底部边界（$z=0$）指定了一个给定的向上热通量 $Q_{o}$，并在顶部边界（$z=H_{i}+H_{s}$）指定了一个给定的向上热通量 $Q_{s}$。为了存在一个物理上一致的稳态，热通量必须在整个柱体中是均匀的。这施加了一个必要的一致性条件：\n$$Q_{s} = Q_{o}$$\n让我们将此恒定的向上热通量记为 $Q$。因此，$Q = Q_s = Q_o$。\n\n热通量 $Q$ 和温度梯度 $\\frac{dT}{dz}$ 之间的关系由傅里叶热传导定律给出。在 $z$ 和 $Q$ 的向上方向都定义为正的情况下，该定律为：\n$$Q = -k \\frac{dT}{dz}$$\n其中 $k$ 是热导率。该方程在冰层和雪层中分别成立，使用各自的热导率 $k_i$ 和 $k_s$。\n\n由于在每层内 $k$ 是常数，控制方程 $\\frac{d}{dz}(-k \\frac{dT}{dz}) = \\frac{dQ}{dz} = 0$ 在每层中简化为 $\\frac{d^2T}{dz^2} = 0$。其通解在冰层和雪层中均为线性温度分布。\n\n对于冰层，$0 \\le z \\le H_{i}$：\n$$T_{i}(z) = A_{i}z + B_{i}$$\n对于雪层，$H_{i} \\le z \\le H_{i}+H_{s}$：\n$$T_{s}(z) = A_{s}z + B_{s}$$\n\n我们利用边界和界面条件来确定常数 $A_i$、$B_i$、$A_s$ 和 $B_s$。\n\n1.  **在 $z=0$ 处的底部边界条件**：温度固定在海水冰点 $T(0) = T_{f}$。\n    将此应用于冰的温度分布：\n    $$T_{i}(0) = A_{i}(0) + B_{i} = T_{f} \\implies B_{i} = T_{f}$$\n    冰的温度分布变为 $T_{i}(z) = A_{i}z + T_{f}$。\n\n2.  **通量条件**：恒定热通量 $Q$ 与温度梯度相关。\n    在冰层中：\n    $$Q = -k_{i} \\frac{dT_{i}}{dz} = -k_{i} A_{i} \\implies A_{i} = -\\frac{Q}{k_{i}}$$\n    所以，冰层中的温度分布被显式确定为：\n    $$T_{i}(z) = T_{f} - \\frac{Q}{k_{i}}z$$\n    在雪层中：\n    $$Q = -k_{s} \\frac{dT_{s}}{dz} = -k_{s} A_{s} \\implies A_{s} = -\\frac{Q}{k_{s}}$$\n    雪的温度分布为 $T_{s}(z) = -\\frac{Q}{k_{s}}z + B_{s}$。\n\n3.  **在 $z=H_{i}$ 处的界面条件**：在雪和冰的界面处，温度必须是连续的，即 $T_{i}(H_{i}) = T_{s}(H_{i})$。\n    $$T_f - \\frac{Q}{k_i}H_i = -\\frac{Q}{k_s}H_i + B_s$$\n    我们可以解出常数 $B_s$：\n    $$B_{s} = T_{f} - \\frac{Q}{k_{i}}H_{i} + \\frac{Q}{k_{s}}H_{i} = T_{f} + Q\\left(\\frac{H_{i}}{k_{s}} - \\frac{H_{i}}{k_{i}}\\right)$$\n\n这完全确定了雪层中的温度分布：\n$$T_{s}(z) = -\\frac{Q}{k_{s}}z + T_{f} + Q\\left(\\frac{H_{i}}{k_{s}} - \\frac{H_{i}}{k_{i}}\\right)$$\n\n最后，我们通过在顶部表面 $z = H_{i}+H_{s}$ 处计算雪的温度分布来确定雪面温度 $T_{s} \\equiv T(H_{i}+H_{s})$：\n$$T_{s} = T_{s}(H_{i}+H_{s}) = -\\frac{Q}{k_{s}}(H_{i}+H_{s}) + T_{f} + Q\\left(\\frac{H_{i}}{k_{s}} - \\frac{H_{i}}{k_{i}}\\right)$$\n\n让我们简化这个表达式：\n$$T_{s} = T_{f} - \\frac{Q H_{i}}{k_{s}} - \\frac{Q H_{s}}{k_{s}} + \\frac{Q H_{i}}{k_{s}} - \\frac{Q H_{i}}{k_{i}}$$\n$$T_{s} = T_{f} - \\frac{Q H_{s}}{k_{s}} - \\frac{Q H_{i}}{k_{i}}$$\n\n提出恒定通量 $Q$：\n$$T_{s} = T_{f} - Q\\left(\\frac{H_{i}}{k_{i}} + \\frac{H_{s}}{k_{s}}\\right)$$\n\n问题要求用最初给定的通量来表示该表达式。使用一致性条件 $Q = Q_{s} = Q_{o}$，我们可以用 $Q_{s}$ 或 $Q_{o}$ 来写最终表达式。我们选择 $Q_{s}$，因为它与表面有关。\n\n一致性条件是 $Q_{s} = Q_{o}$。\n雪面温度的显式解析表达式是：\n$$T_{s} = T_{f} - Q_{s}\\left(\\frac{H_{i}}{k_{i}} + \\frac{H_{s}}{k_{s}}\\right)$$\n这个结果在物理上是直观的。项 $(\\frac{H_{i}}{k_{i}} + \\frac{H_{s}}{k_{s}})$ 代表了冰-雪复合板的总热阻。整个板上的总温降 $T_{f} - T_{s}$ 等于热通量 $Q_{s}$ 乘以这个总热阻。该表达式以开尔文为单位给出温度，前提是 $T_{f}$ 也是以开尔文为单位。",
            "answer": "$$\\boxed{T_{f} - Q_{s}\\left(\\frac{H_{i}}{k_{i}} + \\frac{H_{s}}{k_{s}}\\right)}$$"
        },
        {
            "introduction": "掌握了热力学基础后，我们转向海冰动力学的核心问题：冰的运动 。此练习模拟了海冰在“自由漂移”状态下的行为，即忽略内部应力，仅考虑风、洋流和科里奥利力的平衡。通过建立并求解这个力学平衡系统，你将能从解析解中直观地理解地球自转（科里奥利效应）如何使冰的运动方向偏离风和洋流的方向。",
            "id": "3910635",
            "problem": "考虑一个水平均质的海冰盖，其速度为 $\\mathbf{u}=(u,v)$，在旋转地球上受风和洋流的共同作用而运动。假设处于稳定状态，忽略冰的惯性、冰的内应力和海面坡度（自由漂移）。设科里奥利参数为 $f$，向上的单位向量为 $\\hat{\\mathbf{k}}$。空气-冰和海洋-冰之间的动量交换通过线性拖曳定律建模：空气-冰应力为 $\\boldsymbol{\\tau}_{a}=\\rho_{a} C_{a} \\left(\\mathbf{U}_{a}-\\mathbf{u}\\right)$，海洋-冰应力为 $\\boldsymbol{\\tau}_{o}=\\rho_{w} C_{o} \\left(\\mathbf{U}_{o}-\\mathbf{u}\\right)$，其中 $\\rho_{a}$ 是空气密度，$\\rho_{w}$ 是水的密度， $C_{a}$ 和 $C_{o}$ 是整体拖曳系数，$\\mathbf{U}_{a}=(U_{a,x},U_{a,y})$ 和 $\\mathbf{U}_{o}=(U_{o,x},U_{o,y})$ 分别是给定的、空间上均匀的风速和洋流速度。在本练习中，将 $\\rho_{a} C_{a}$ 和 $\\rho_{w} C_{o}$ 理解为提供与相对速度成正比的加速度的有效耦合系数。\n\n从单位质量的动量平衡出发（在稳定状态下，科里奥利加速度与拖曳加速度之和为零），为未知数 $u$ 和 $v$ 构建线性系统，并用 $f$、$\\rho_{w} C_{o}$、$\\rho_{a} C_{a}$ 以及风速和洋流速度分量显式求解 $u$ 和 $v$。将您关于 $u$ 和 $v$ 的最终答案以米每秒为单位表示。不需要进行数值计算；请提供一个闭式解析表达式。",
            "solution": "首先根据指定标准验证问题。\n\n**第1步：提取已知条件**\n- 冰速：$\\mathbf{u}=(u,v)$。\n- 假设：稳定状态，忽略冰的惯性、冰的内应力和海面坡度（自由漂移），水平均质的海冰盖。\n- 科里奥利参数：$f$。\n- 向上单位向量：$\\hat{\\mathbf{k}}$。\n- 空气-冰应力模型：$\\boldsymbol{\\tau}_{a}=\\rho_{a} C_{a} \\left(\\mathbf{U}_{a}-\\mathbf{u}\\right)$。\n- 海洋-冰应力模型：$\\boldsymbol{\\tau}_{o}=\\rho_{w} C_{o} \\left(\\mathbf{U}_{o}-\\mathbf{u}\\right)$。\n- 定义：$\\rho_{a}$ 是空气密度，$\\rho_{w}$ 是水的密度， $C_{a}$ 和 $C_{o}$ 是整体拖曳系数。\n- 给定速度：$\\mathbf{U}_{a}=(U_{a,x},U_{a,y})$ (风速) 和 $\\mathbf{U}_{o}=(U_{o,x},U_{o,y})$ (洋流速度)。\n- 核心指令：“将 $\\rho_{a} C_{a}$ 和 $\\rho_{w} C_{o}$ 理解为提供与相对速度成正比的加速度的有效耦合系数。”\n- 控制原理：“科里奥利加速度与拖曳加速度之和为零”。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了一个简化但标准的海冰自由漂移模型。动量平衡包括科里奥利力和拖曳力，这些都是地球物理流体动力学中的基本概念。线性拖曳模型在某些情况下是有效的简化。该问题在科学上是合理的。\n- **适定性：** 该问题要求解一个包含两个未知数（$u, v$）的二元线性代数方程组。所有必要的参数都已定义，从而构成一个具有唯一解的适定问题，这将在解题过程中得到证明。\n- **客观性：** 该问题以精确的数学和物理术语陈述，没有歧义或主观论断。\n- **结论：** 该问题是有效的。将拖曳项解释为加速度的指令明确了预期的模型，从而创建了一个自洽且可解的物理问题。线性应力公式虽然与二次拖曳定律相比非标准，但已被明确定义，必须按给定的方式使用。\n\n**第3步：求解**\n问题要求解海冰层的稳态动量平衡。根据问题陈述，该平衡是按单位质量表示的，这意味着我们要求作用在冰上的加速度之和，对于稳态（$\\frac{d\\mathbf{u}}{dt}=0$）而言，该和必须为零。\n\n加速度包括：\n1. 科里奥利加速度：$\\mathbf{a}_{c} = -f \\hat{\\mathbf{k}} \\times \\mathbf{u}$，其中 $f$ 是科里奥利参数，$\\hat{\\mathbf{k}}$ 是向上的单位向量，$\\mathbf{u}=(u,v)$ 是冰速。\n2. 空气拖曳加速度：问题陈述要求将 $\\rho_{a} C_{a}$ 理解为提供与相对速度成正比的加速度的有效耦合系数。因此，空气拖曳加速度为 $\\mathbf{a}_{a} = K_{a}(\\mathbf{U}_{a} - \\mathbf{u})$，我们定义 $K_{a} = \\rho_{a} C_{a}$。\n3. 海洋拖曳加速度：类似地，海洋拖曳加速度为 $\\mathbf{a}_{o} = K_{o}(\\mathbf{U}_{o} - \\mathbf{u})$，其中 $K_{o} = \\rho_{w} C_{o}$。\n\n稳态动量平衡方程为 $\\mathbf{a}_{c} + \\mathbf{a}_{a} + \\mathbf{a}_{o} = \\mathbf{0}$。\n代入加速度的表达式：\n$$ -f \\hat{\\mathbf{k}} \\times \\mathbf{u} + K_{a}(\\mathbf{U}_{a} - \\mathbf{u}) + K_{o}(\\mathbf{U}_{o} - \\mathbf{u}) = \\mathbf{0} $$\n我们将此向量方程用其分量表示。在具有基向量 $(\\mathbf{i}, \\mathbf{j})$ 的二维水平面上，我们有 $\\mathbf{u} = u\\mathbf{i} + v\\mathbf{j}$，且 $\\hat{\\mathbf{k}}$ 垂直于该平面。叉积为：\n$$ \\hat{\\mathbf{k}} \\times \\mathbf{u} = \\hat{\\mathbf{k}} \\times (u\\mathbf{i} + v\\mathbf{j}) = u(\\hat{\\mathbf{k}} \\times \\mathbf{i}) + v(\\hat{\\mathbf{k}} \\times \\mathbf{j}) = u\\mathbf{j} - v\\mathbf{i} = -v\\mathbf{i} + u\\mathbf{j} $$\n因此，科里奥利加速度为 $-f \\hat{\\mathbf{k}} \\times \\mathbf{u} = fv\\mathbf{i} - fu\\mathbf{j}$。\n\n拖曳加速度的分量形式为：\n$$ \\mathbf{a}_{a} = K_{a}(U_{a,x}-u)\\mathbf{i} + K_{a}(U_{a,y}-v)\\mathbf{j} $$\n$$ \\mathbf{a}_{o} = K_{o}(U_{o,x}-u)\\mathbf{i} + K_{o}(U_{o,y}-v)\\mathbf{j} $$\n动量方程可以分为 x 和 y 分量。\n\n对于 x 分量（i 方向）：\n$$ fv + K_{a}(U_{a,x}-u) + K_{o}(U_{o,x}-u) = 0 $$\n$$ fv - (K_{a}+K_{o})u + K_{a}U_{a,x} + K_{o}U_{o,x} = 0 $$\n$$ -(K_{a}+K_{o})u + fv = - (K_{a}U_{a,x} + K_{o}U_{o,x}) $$\n\n对于 y 分量（j 方向）：\n$$ -fu + K_{a}(U_{a,y}-v) + K_{o}(U_{o,y}-v) = 0 $$\n$$ -fu - (K_{a}+K_{o})v + K_{a}U_{a,y} + K_{o}U_{o,y} = 0 $$\n$$ -fu - (K_{a}+K_{o})v = - (K_{a}U_{a,y} + K_{o}U_{o,y}) $$\n\n让我们定义总拖曳耦合系数 $K = K_{a} + K_{o} = \\rho_a C_a + \\rho_w C_o$。\n我们也定义有效强迫速度分量：\n$F_{x} = K_{a}U_{a,x} + K_{o}U_{o,x}$\n$F_{y} = K_{a}U_{a,y} + K_{o}U_{o,y}$\n\n关于 $u$ 和 $v$ 的线性方程组变为：\n1. $-Ku + fv = -F_{x}$\n2. $-fu - Kv = -F_{y}$\n\n该系统可以写成矩阵形式：\n$$ \\begin{pmatrix} -K  f \\\\ -f  -K \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} -F_{x} \\\\ -F_{y} \\end{pmatrix} $$\n为了求解 $(u, v)$，我们对矩阵求逆。系数矩阵的行列式为 $\\Delta = (-K)(-K) - (f)(-f) = K^2 + f^2$。由于密度和拖曳系数均为正，因此 $K > 0$，从而 $\\Delta > 0$，确保存在唯一解。\n矩阵的逆为：\n$$ \\frac{1}{K^2+f^2} \\begin{pmatrix} -K  -f \\\\ f  -K \\end{pmatrix} $$\n解向量通过将逆矩阵乘以强迫向量得到：\n$$ \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\frac{1}{K^2+f^2} \\begin{pmatrix} -K  -f \\\\ f  -K \\end{pmatrix} \\begin{pmatrix} -F_{x} \\\\ -F_{y} \\end{pmatrix} $$\n这就得出了 $u$ 和 $v$ 的表达式：\n$$ u = \\frac{1}{K^2+f^2} \\left( (-K)(-F_{x}) + (-f)(-F_{y}) \\right) = \\frac{K F_{x} + f F_{y}}{K^2+f^2} $$\n$$ v = \\frac{1}{K^2+f^2} \\left( (f)(-F_{x}) + (-K)(-F_{y}) \\right) = \\frac{-f F_{x} + K F_{y}}{K^2+f^2} $$\n将 $K$、$F_x$ 和 $F_y$ 的定义代回，得到用给定参数表示的 $u$ 和 $v$ 的最终表达式。\n设 $K = \\rho_{a} C_{a} + \\rho_{w} C_{o}$。\n$$ u = \\frac{(\\rho_{a} C_{a} + \\rho_{w} C_{o})(\\rho_{a} C_{a} U_{a,x} + \\rho_{w} C_{o} U_{o,x}) + f(\\rho_{a} C_{a} U_{a,y} + \\rho_{w} C_{o} U_{o,y})}{(\\rho_{a} C_{a} + \\rho_{w} C_{o})^2 + f^2} $$\n$$ v = \\frac{-f(\\rho_{a} C_{a} U_{a,x} + \\rho_{w} C_{o} U_{o,x}) + (\\rho_{a} C_{a} + \\rho_{w} C_{o})(\\rho_{a} C_{a} U_{a,y} + \\rho_{w} C_{o} U_{o,y})}{(\\rho_{a} C_{a} + \\rho_{w} C_{o})^2 + f^2} $$\n这些就是冰速向量 $\\mathbf{u}=(u,v)$ 各分量的闭式解析表达式。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\left(\\rho_{a} C_{a} + \\rho_{w} C_{o}\\right)\\left(\\rho_{a} C_{a} U_{a,x} + \\rho_{w} C_{o} U_{o,x}\\right) + f\\left(\\rho_{a} C_{a} U_{a,y} + \\rho_{w} C_{o} U_{o,y}\\right)}{\\left(\\rho_{a} C_{a} + \\rho_{w} C_{o}\\right)^{2} + f^{2}} & \\frac{-f\\left(\\rho_{a} C_{a} U_{a,x} + \\rho_{w} C_{o} U_{o,x}\\right) + \\left(\\rho_{a} C_{a} + \\rho_{w} C_{o}\\right)\\left(\\rho_{a} C_{a} U_{a,y} + \\rho_{w} C_{o} U_{o,y}\\right)}{\\left(\\rho_{a} C_{a} + \\rho_{w} C_{o}\\right)^{2} + f^{2}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "现实世界的海冰模型必须在每个时间步求解海冰表面的能量平衡，以确定其表面温度，这是连接大气和海洋的关键变量 。这个实践练习将让你亲手构建并求解这个非线性的能量平衡方程，其中包含了辐射、湍流热通量和冰内传导等多个复杂过程。通过应用牛顿法等数值技术，你将体验到现代气候模型中解决实际物理问题的核心计算挑战。",
            "id": "4086039",
            "problem": "在一个柱状模型中，一个海冰网格单元与大气和海洋交换能量。在稳定条件下并忽略水平平流，界面处的能量守恒要求辐射、湍流和传导通量之和达到平衡。考虑以下基于物理的组分。\n\n1. 辐射通量：\n   - 地表短波吸收为 $Q_{\\mathrm{SW}} = (1-\\alpha)\\,S_{\\downarrow}$，其中 $\\alpha$ 是反照率，$S_{\\downarrow}$ 是向下短波辐射。$\\alpha$ 和 $S_{\\downarrow}$ 均为指定的输入量。\n   - 长波交换包括向下长波辐射 $L_{\\downarrow}$ 和由地表发射的向上长波辐射。向上长波辐射由 Stefan–Boltzmann 定律给出：$L_{\\uparrow} = \\varepsilon\\,\\sigma\\,T_s^4$，其中 $\\varepsilon$ 是海冰的长波发射率，$\\sigma$ 是 Stefan–Boltzmann 常数，$T_s$ 是未知的地表皮温。\n\n2. 湍流通量（块体空气动力学公式）：\n   - 感热通量为 $H = \\rho_a\\,c_p\\,C_H\\,U\\,(T_s - T_a)$，其中 $\\rho_a$ 是空气密度，$c_p$ 是空气定压比热容，$C_H$ 是热量块体输送系数，$U$ 是风速，$T_a$ 是气温。\n   - 潜热通量（冰上升华）为 $\\mathrm{LE} = \\rho_a\\,L_s\\,C_E\\,U\\,(q_{si}(T_s) - q_a)$，其中 $L_s$ 是升华潜热，$C_E$ 是水汽块体输送系数，$q_{si}(T_s)$ 是地表温度 $T_s$ 下的冰面饱和比湿，$q_a$ 是环境比湿。\n\n   环境空气密度由理想气体定律计算得出：$\\rho_a = p/(R_d\\,T_a)$，其中 $p$ 是气压，$R_d$ 是干空气比气体常数。环境比湿为 $q_a = \\mathrm{RH}\\times q_{si}(T_a)$，其中 $\\mathrm{RH}$ 是以小数形式表示的相对湿度。\n\n   冰面饱和比湿 $q_{si}(T)$ 由冰面饱和水汽压 $e_{si}(T)$ 计算得出：$q_{si}(T) = \\dfrac{\\epsilon\\,e_{si}(T)}{p - (1-\\epsilon)\\,e_{si}(T)}$，其中 $\\epsilon = 0.622$ 是比气体常数之比。冰面饱和水汽压遵循 Clausius–Clapeyron 关系：$e_{si}(T) = e_0\\,\\exp\\!\\left(\\dfrac{L_s}{R_v}\\left(\\dfrac{1}{T_0} - \\dfrac{1}{T}\\right)\\right)$，其中 $e_0$ 是在温度 $T_0$ 下的冰面参考饱和水汽压，$R_v$ 是水汽比气体常数。\n\n3. 通过厚度为 $h$、热导率为 $k_i$、底部温度为指定值 $T_b$ 的均匀冰板的传导热通量为 $G = k_i\\,\\dfrac{T_s - T_b}{h}$，当 $T_s > T_b$ 时，方向朝下进入冰中，取正值。\n\n采用符号约定，向下辐射通量为正，当 $T_s > T_a$ 或 $q_{si}(T_s) > q_a$ 时，湍流通量 $H$ 和 $\\mathrm{LE}$ 分别向上为正。稳态地表能量平衡方程则为\n$$\n0 \\;=\\; (1-\\alpha)\\,S_{\\downarrow} \\;+\\; L_{\\downarrow} \\;-\\; \\varepsilon\\,\\sigma\\,T_s^4 \\;-\\; H(T_s) \\;-\\; \\mathrm{LE}(T_s) \\;-\\; G(T_s).\n$$\n\n你的任务是使用带有回溯线搜索的 Newton 法求解关于 $T_s$ 的非线性方程，从而计算出使该平衡闭合的地表皮温 $T_s$，以确保稳健性。你必须显式处理向上长波项 $T_s^4$ 和饱和湿度 $q_{si}(T_s)$ 中的非线性。从给定的基本定义出发，推导 Newton 法所需的解析导数，包括 $q_{si}(T)$ 对 $T$ 的导数。使用两个标准来评估收敛性：绝对残差容差和绝对温度增量容差。只有当两个标准在最大迭代次数内都满足时，才宣布收敛。\n\n待使用的常数（所有情况）：\n- Stefan–Boltzmann 常数 $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$，\n- 发射率 $\\varepsilon = 0.98$，\n- 空气比热 $c_p = 1004\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，\n- 升华潜热 $L_s = 2.834\\times 10^{6}\\ \\mathrm{J\\,kg^{-1}}$，\n- 比气体常数 $R_d = 287\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 和 $R_v = 461.5\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，\n- 冰面参考饱和水汽压 $e_0 = 611\\ \\mathrm{Pa}$，温度 $T_0 = 273.15\\ \\mathrm{K}$，\n- 输送系数 $C_H = 0.0012$, $C_E = 0.0012$，\n- 比湿定义中的比率 $\\epsilon = 0.622$。\n\n需执行的收敛控制（所有情况）：\n- 绝对残差容差 $\\tau_F = 10^{-2}\\ \\mathrm{W\\,m^{-2}}$，\n- 绝对温度增量容差 $\\tau_T = 10^{-4}\\ \\mathrm{K}$，\n- 最大迭代次数 $N_{\\max} = 50$，\n- 初始猜测值 $T_s^{(0)} = T_a$，\n- 带有乘法因子 $\\lambda \\in \\{1, \\tfrac{1}{2}, \\tfrac{1}{4}, \\dots\\}$ 的回溯线搜索，以确保每一步的绝对残差减小，\n- 在线搜索期间将试验温度限制在物理上合理的区间 $[200\\ \\mathrm{K}, 310\\ \\mathrm{K}]$。\n\n测试套件。对于每个测试，所有输入均采用国际单位制，不使用角度，相对湿度为小数形式。冰的热导率 $k_i$ 单位为 $\\mathrm{W\\,m^{-1}\\,K^{-1}}$，厚度 $h$ 单位为 $\\mathrm{m}$。\n\n- 测试 A（典型的寒冷、中等风速、相对高反照率）：\n  - $S_{\\downarrow} = 50$, $\\alpha = 0.85$, $L_{\\downarrow} = 180$, $T_a = 248$, $\\mathrm{RH} = 0.60$, $U = 5.0$, $h = 1.5$, $k_i = 2.2$, $T_b = 271.35$, $p = 101325$。\n\n- 测试 B（日照、薄冰、潮湿空气、较强风）：\n  - $S_{\\downarrow} = 300$, $\\alpha = 0.65$, $L_{\\downarrow} = 300$, $T_a = 270$, $\\mathrm{RH} = 0.90$, $U = 7.0$, $h = 0.5$, $k_i = 2.2$, $T_b = 271.35$, $p = 101325$。\n\n- 测试 C（无风、厚冰、偏干空气）：\n  - $S_{\\downarrow} = 80$, $\\alpha = 0.80$, $L_{\\downarrow} = 240$, $T_a = 255$, $\\mathrm{RH} = 0.50$, $U = 0.2$, $h = 3.0$, $k_i = 2.2$, $T_b = 271.35$, $p = 101325$。\n\n- 测试 D（黑暗、极寒、极干、强风）：\n  - $S_{\\downarrow} = 0$, $\\alpha = 0.85$, $L_{\\downarrow} = 150$, $T_a = 240$, $\\mathrm{RH} = 0.30$, $U = 15.0$, $h = 1.0$, $k_i = 2.2$, $T_b = 271.35$, $p = 101325$。\n\n所需输出。对于每个测试，计算：\n- 以 K 为单位的地表皮温 $T_s$，四舍五入到三位小数，\n- 执行的 Newton 迭代的整数次数，\n- 一个布尔值，指示是否满足收敛标准。\n\n最终输出格式。你的程序应生成单行输出，其中包含一个由每个测试的三元组组成的、用逗号分隔的列表。每个三元组的格式为 $[T_s,\\mathrm{iterations},\\mathrm{converged}]$，整个列表用方括号括起来，不含空格。例如：$[[271.234,6,\\mathrm{True}],[\\dots]]$。",
            "solution": "用户提供了一个关于海冰热力学的适定问题。任务是通过求解地表能量平衡方程来计算海冰板的稳态地表温度。该问题有科学依据，没有矛盾，并包含了进行求解所需的所有必要信息。\n\n### 基于原理的设计\n\n该问题的核心物理原理是海冰表面的能量守恒。在稳态条件下并忽略水平输送，所有进出地表的能量通量之和必须为零。地表能量平衡方程给出如下：\n$$\nF(T_s) = (1-\\alpha)\\,S_{\\downarrow} + L_{\\downarrow} - \\varepsilon\\,\\sigma\\,T_s^4 - H(T_s) - \\mathrm{LE}(T_s) - G(T_s) = 0\n$$\n其中 $T_s$ 是未知的地表温度。每一项代表一个特定的物理过程：\n-   **净短波辐射**：$(1-\\alpha)S_{\\downarrow}$ 是地表吸收的入射太阳辐射部分，其中 $\\alpha$ 是反照率，$S_{\\downarrow}$ 是向下短波通量。\n-   **向下长波辐射**：$L_{\\downarrow}$ 是由大气和云层向地表发射的热辐射。\n-   **向上长波辐射**：$\\varepsilon\\sigma T_s^4$ 是地表发射的热辐射，遵循 Stefan-Boltzmann 定律。此处，$\\varepsilon$ 是发射率，$\\sigma$ 是 Stefan-Boltzmann 常数。该项引入了强非线性。\n-   **感热通量**：$H(T_s) = \\rho_a c_p C_H U (T_s - T_a)$ 是由于地表与上方空气之间的温差引起的湍流热交换。\n-   **潜热通量**：$\\mathrm{LE}(T_s) = \\rho_a L_s C_E U (q_{si}(T_s) - q_a)$ 是由于地表升华（从冰到水汽的相变）引起的能量交换。该项是高度非线性的，因为地表的饱和比湿 $q_{si}(T_s)$ 是 $T_s$ 的指数函数。\n-   **传导热通量**：$G(T_s) = k_i (T_s - T_b) / h$ 是通过冰传导的热量，由地表和冰底温度 $T_b$ 之间的温差驱动。\n\n问题要求使用 Newton 法求解非线性方程 $F(T_s) = 0$ 以得到 $T_s$。这种迭代数值技术可以找到实值函数根的逐次更好的近似值。迭代更新规则为：\n$$\nT_s^{(k+1)} = T_s^{(k)} - \\frac{F(T_s^{(k)})}{F'(T_s^{(k)})}\n$$\n其中 $k$ 是迭代指数，$F'(T_s) = dF/dT_s$ 是能量平衡函数相对于地表温度的解析导数。\n\n一个关键步骤是推导 $F'(T_s)$。我们对 $F(T_s)$ 的每一项关于 $T_s$ 求导：\n$$\nF'(T_s) = \\frac{d}{dT_s} \\left( (1-\\alpha)S_{\\downarrow} + L_{\\downarrow} \\right) - \\frac{d}{dT_s}(\\varepsilon\\sigma T_s^4) - \\frac{d}{dT_s}(H(T_s)) - \\frac{d}{dT_s}(\\mathrm{LE}(T_s)) - \\frac{d}{dT_s}(G(T_s))\n$$\n各个通量分量的导数为：\n-   $\\frac{d}{dT_s}(\\varepsilon\\sigma T_s^4) = 4\\varepsilon\\sigma T_s^3$\n-   $\\frac{d}{dT_s}(H(T_s)) = \\frac{d}{dT_s}(\\rho_a c_p C_H U (T_s - T_a)) = \\rho_a c_p C_H U$\n-   $\\frac{d}{dT_s}(G(T_s)) = \\frac{d}{dT_s}(\\frac{k_i}{h}(T_s - T_b)) = \\frac{k_i}{h}$\n-   潜热通量的导数需要对 $\\frac{d}{dT_s}(q_{si}(T_s))$ 使用链式法则。饱和比湿 $q_{si}(T)$ 是冰面饱和水汽压 $e_{si}(T)$ 的函数，而后者又是 $T$ 的函数。\n    $$\n    e_{si}(T) = e_0 \\exp\\left(\\frac{L_s}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right) \\implies \\frac{de_{si}}{dT} = e_{si}(T) \\frac{L_s}{R_v T^2}\n    $$\n    $$\n    q_{si}(T) = \\frac{\\epsilon e_{si}(T)}{p - (1-\\epsilon)e_{si}(T)} \\implies \\frac{dq_{si}}{de_{si}} = \\frac{\\epsilon p}{(p - (1-\\epsilon)e_{si}(T))^2}\n    $$\n    应用链式法则，$\\frac{dq_{si}}{dT} = \\frac{dq_{si}}{de_{si}} \\frac{de_{si}}{dT}$：\n    $$\n    \\frac{dq_{si}}{dT} = \\frac{\\epsilon p}{(p - (1-\\epsilon)e_{si}(T))^2} \\left( e_{si}(T) \\frac{L_s}{R_v T^2} \\right)\n    $$\n    潜热通量的导数则为：\n    $$\n    \\frac{d}{dT_s}(\\mathrm{LE}(T_s)) = \\rho_a L_s C_E U \\frac{dq_{si}}{dT_s}\n    $$\n平衡函数的完整导数是这些负贡献项的总和：\n$$\nF'(T_s) = -4\\varepsilon\\sigma T_s^3 - \\rho_a c_p C_H U - \\rho_a L_s C_E U \\frac{dq_{si}}{dT_s} - \\frac{k_i}{h}\n$$\n\n算法实现遵循以下步骤：\n1.  **初始化**：将地表温度的初始猜测值设为气温，$T_s^{(0)} = T_a$。\n2.  **迭代**：对从 $0$ 到 $N_{\\max}-1$ 的每次迭代 $n$：\n    a.  计算残差 $F(T_s^{(n)})$ 及其导数 $F'(T_s^{(n)})$。\n    b.  计算 Newton 步长：$\\Delta T_s = -F(T_s^{(n)}) / F'(T_s^{(n)})$。\n    c.  **回溯线搜索**：为确保收敛，尤其是在远离根时，完整的 Newton 步长可能过大。因此采用回溯线搜索。从步长因子 $\\lambda=1$ 开始，计算试验温度 $T_{s, \\text{trial}} = T_s^{(n)} + \\lambda \\Delta T_s$。如果此试验温度下的绝对残差 $|F(T_{s, \\text{trial}})|$ 不小于当前残差 $|F(T_s^{(n)})|$，则说明步长过大。将因子 $\\lambda$ 减半，并重复此过程，直到获得更小的残差。试验温度也应被限制在物理上合理的范围 $[200\\ \\mathrm{K}, 310\\ \\mathrm{K}]$ 内。\n    d.  **更新**：将温度更新为可接受的试验值：$T_s^{(n+1)} = T_{s, \\text{trial}}$。\n    e.  **收敛检查**：更新后，使用两个标准评估收敛性：新温度下的残差绝对值必须低于容差 $\\tau_F$ (`abs(F(Ts_new))  tau_F`)，并且该步的温度变化幅度必须低于容差 $\\tau_T$ (`abs(Ts_new - Ts_old)  tau_T`)。如果两者都满足，则停止迭代。\n3.  **终止**：如果达到收敛或达到最大迭代次数 $N_{\\max}$，则过程终止。\n\n最终的 Python 实现将这些物理原理和数值方法封装到一个稳健的求解器中，用于处理所提供的测试用例。",
            "answer": "```python\nimport numpy as np\n\n# A meticulous and exacting professor in the STEM fields.\n\ndef solve():\n    \"\"\"\n    Main function to define constants, test cases, and run the solver.\n    \"\"\"\n    # Physical and mathematical constants in SI units.\n    CONSTANTS = {\n        'sigma': 5.670374419e-8,  # Stefan-Boltzmann constant (W m^-2 K^-4)\n        'epsilon_ice': 0.98,       # Longwave emissivity of sea ice\n        'cp_air': 1004.0,          # Specific heat of air at constant pressure (J kg^-1 K^-1)\n        'Ls_sub': 2.834e6,         # Latent heat of sublimation (J kg^-1)\n        'Rd_air': 287.0,           # Specific gas constant for dry air (J kg^-1 K^-1)\n        'Rv_vap': 461.5,           # Specific gas constant for water vapor (J kg^-1 K^-1)\n        'e0_ice': 611.0,           # Reference saturation vapor pressure over ice (Pa)\n        'T0_ref': 273.15,          # Reference temperature (K)\n        'CH_coeff': 0.0012,        # Bulk transfer coefficient for heat\n        'CE_coeff': 0.0012,        # Bulk transfer coefficient for moisture\n        'epsilon_q': 0.622,        # Ratio of gas constants (Rd/Rv) for specific humidity\n    }\n\n    # Solver control parameters.\n    CONTROLS = {\n        'tau_F': 1e-2,             # Absolute residual tolerance (W m^-2)\n        'tau_T': 1e-4,             # Absolute temperature increment tolerance (K)\n        'N_max': 50,               # Maximum number of iterations\n        'T_min': 200.0,            # Lower bound for Ts trial (K)\n        'T_max': 310.0,            # Upper bound for Ts trial (K)\n    }\n\n    # Test cases with input parameters.\n    test_cases = [\n        # Test A: S_down, alpha, L_down, Ta, RH, U, h, ki, Tb, p\n        (50.0, 0.85, 180.0, 248.0, 0.60, 5.0, 1.5, 2.2, 271.35, 101325.0),\n        # Test B\n        (300.0, 0.65, 300.0, 270.0, 0.90, 7.0, 0.5, 2.2, 271.35, 101325.0),\n        # Test C\n        (80.0, 0.80, 240.0, 255.0, 0.50, 0.2, 3.0, 2.2, 271.35, 101325.0),\n        # Test D\n        (0.0, 0.85, 150.0, 240.0, 0.30, 15.0, 1.0, 2.2, 271.35, 101325.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_newton_solver(params, CONSTANTS, CONTROLS)\n        results.append(result)\n\n    # Format the final output string as specified.\n    item_strings = [f\"[{T_s:.3f},{iters},{conv}]\" for T_s, iters, conv in results]\n    final_output = f\"[{','.join(item_strings)}]\"\n    print(final_output)\n\ndef e_si(T, Ls, Rv, e0, T0):\n    \"\"\"Calculates saturation vapor pressure over ice (Pa).\"\"\"\n    if T == 0: return 0.0 # Avoid division by zero for T=0\n    return e0 * np.exp((Ls / Rv) * (1.0 / T0 - 1.0 / T))\n\ndef q_si(T, p, consts):\n    \"\"\"Calculates saturation specific humidity over ice (kg/kg).\"\"\"\n    esi_T = e_si(T, consts['Ls_sub'], consts['Rv_vap'], consts['e0_ice'], consts['T0_ref'])\n    denominator = p - (1.0 - consts['epsilon_q']) * esi_T\n    if denominator == 0: return np.nan # Avoid division by zero or negative\n    return (consts['epsilon_q'] * esi_T) / denominator\n\ndef dq_si_dT(T, p, consts):\n    \"\"\"Calculates the derivative of saturation specific humidity w.r.t. temperature.\"\"\"\n    if T == 0: return 0.0\n    Ls = consts['Ls_sub']\n    Rv = consts['Rv_vap']\n    epsilon = consts['epsilon_q']\n\n    esi_T = e_si(T, Ls, Rv, consts['e0_ice'], consts['T0_ref'])\n    de_si_dT = esi_T * (Ls / (Rv * T**2))\n\n    numerator = epsilon * p\n    denominator = p - (1.0 - epsilon) * esi_T\n    if denominator == 0: return np.nan\n    dq_de = numerator / (denominator**2)\n    \n    return dq_de * de_si_dT\n\ndef run_newton_solver(params, consts, ctrls):\n    \"\"\"\n    Solves for surface temperature Ts using Newton's method with backtracking.\n    \"\"\"\n    S_down, alpha, L_down, Ta, RH, U, h, ki, Tb, p = params\n\n    # Pre-calculate constant quantities for the given atmospheric state.\n    if Ta == 0: rho_a = np.nan\n    else: rho_a = p / (consts['Rd_air'] * Ta)\n    \n    qa = RH * q_si(Ta, p, consts)\n    Q_sw_net = (1.0 - alpha) * S_down\n    \n    if np.isnan(rho_a) or np.isnan(qa):\n       return np.nan, 0, False # Invalid initial state\n\n    def F(Ts):\n        \"\"\"The surface energy balance function F(Ts) whose root is sought.\"\"\"\n        # Turbulent fluxes\n        H = rho_a * consts['cp_air'] * consts['CH_coeff'] * U * (Ts - Ta)\n        qsi_s = q_si(Ts, p, consts)\n        if np.isnan(qsi_s): return np.nan\n        LE = rho_a * consts['Ls_sub'] * consts['CE_coeff'] * U * (qsi_s - qa)\n        # Conductive flux\n        G = ki * (Ts - Tb) / h\n        # Upwelling longwave\n        L_up = consts['epsilon_ice'] * consts['sigma'] * Ts**4\n        return Q_sw_net + L_down - L_up - H - LE - G\n\n    def F_prime(Ts):\n        \"\"\"The analytical derivative dF/dTs.\"\"\"\n        # Derivatives of each flux component w.r.t Ts\n        dL_up_dTs = 4.0 * consts['epsilon_ice'] * consts['sigma'] * Ts**3\n        dH_dTs = rho_a * consts['cp_air'] * consts['CH_coeff'] * U\n        dqsi_dTs = dq_si_dT(Ts, p, consts)\n        if np.isnan(dqsi_dTs): return np.nan\n        dLE_dTs = rho_a * consts['Ls_sub'] * consts['CE_coeff'] * U * dqsi_dTs\n        dG_dTs = ki / h\n        return -dL_up_dTs - dH_dTs - dLE_dTs - dG_dTs\n\n    # --- Newton-Raphson Solver with Backtracking Line Search ---\n    Ts = Ta  # Initial guess\n    \n    for n in range(ctrls['N_max']):\n        F_val = F(Ts)\n        F_prime_val = F_prime(Ts)\n\n        if np.isnan(F_val) or np.isnan(F_prime_val) or abs(F_prime_val)  1e-9:\n            return round(Ts, 3), n, False # Failure case\n\n        delta_T = -F_val / F_prime_val\n        \n        # Backtracking line search to ensure residual reduction\n        lambda_step = 1.0\n        Ts_old = Ts\n        found_step = False\n        for _ in range(20): # Limit backtracking steps\n            Ts_trial = Ts_old + lambda_step * delta_T\n            Ts_trial = max(ctrls['T_min'], min(Ts_trial, ctrls['T_max'])) # Clamp\n            \n            F_trial = F(Ts_trial)\n            if np.isnan(F_trial):\n                lambda_step /= 2.0\n                continue\n\n            if abs(F_trial)  abs(F_val):\n                Ts = Ts_trial\n                found_step = True\n                break\n            \n            lambda_step /= 2.0\n        \n        if not found_step:\n            return round(Ts_old, 3), n, False # Line search failed\n\n        increment = Ts - Ts_old\n        \n        # Check convergence criteria\n        # The residual |F(Ts)| is checked at the *new* location Ts\n        if abs(F(Ts))  ctrls['tau_F'] and abs(increment)  ctrls['tau_T']:\n            return round(Ts, 3), n + 1, True\n\n    # If loop finishes, max iterations were reached without convergence\n    return round(Ts, 3), ctrls['N_max'], False\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}