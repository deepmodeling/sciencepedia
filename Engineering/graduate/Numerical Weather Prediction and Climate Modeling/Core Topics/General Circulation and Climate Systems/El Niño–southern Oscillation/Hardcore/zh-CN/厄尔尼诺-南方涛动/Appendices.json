{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在探索驱动ENSO现象的核心海洋动力学过程。理解赤道开尔文波和罗斯贝波的传播速度至关重要，因为它们穿越太平洋所需的时间决定了整个振荡的尺度，如同ENSO系统的“起搏器”。通过本练习，您将从第一性原理出发推导这些波速，并体会它们速度的巨大差异，这是“延迟振子”等ENSO理论的关键所在。",
            "id": "4035494",
            "problem": "在数值天气预报（NWP）和气候模拟的背景下，考虑与厄尔尼诺-南方涛动（ENSO）相关的赤道海洋动力学。该动力学由赤道β平面上的线性化单层浅水系统表示，其中第一斜压模的折合重力为$g'$，等效深度为$H$。从线性化的浅水动量和连续性方程以及赤道变形半径的定义出发，推导赤道开尔文模的长波相速度和第一经向模赤道罗斯贝波的长波相速度。然后，在假定沿赤道相速度均匀且忽略背景流的情况下，计算赤道开尔文波速，以及开尔文波和第一罗斯贝波穿越长度为$L=15{,}000\\ \\mathrm{km}$的太平洋海盆的穿越时间。\n\n使用$g'=0.03\\ \\mathrm{m\\,s^{-2}}$和$H=200\\ \\mathrm{m}$。取海盆长度为$L=1.5\\times 10^{7}\\ \\mathrm{m}$。对于速度，以$\\mathrm{m\\,s^{-1}}$为单位表示。对于时间，以天为单位表示。最终答案报告为第一罗斯贝波穿越海盆时间与开尔文波穿越海盆时间的无量纲比。将最终答案四舍五入至四位有效数字。",
            "solution": "用户希望我解决一个赤道海洋动力学问题。\n该问题要求推导赤道开尔文波和第一模罗斯贝波的相速度，计算它们穿越太平洋的穿越时间，并求出这些穿越时间的比率。\n\n**步骤1：问题验证**\n\n**1.1：提取已知条件**\n- 系统：赤道β平面上的线性化单层浅水系统。\n- 折合重力：$g' = 0.03\\ \\mathrm{m\\,s^{-2}}$。\n- 第一斜压模的等效深度：$H = 200\\ \\mathrm{m}$。\n- 太平洋海盆长度：$L = 15{,}000\\ \\mathrm{km}$，也即$L = 1.5 \\times 10^7\\ \\mathrm{m}$。\n- 假设：相速度均匀，忽略背景流。\n- 要求推导：赤道开尔文模的长波相速度和第一经向模赤道罗斯贝波的长波相速度。\n- 要求计算：赤道开尔文波速，以及开尔文波和第一罗斯贝波穿越海盆的穿越时间。\n- 最终答案：第一罗斯贝波穿越时间与开尔文波穿越时间的无量纲比，四舍五入至四位有效数字。\n\n**1.2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于成熟的赤道β平面浅水模型，这是热带海洋学和气候动力学（特别是解释厄尔尼诺-南方涛动（ENSO）的海洋部分）的基石。给定的物理参数（$g'$, $H$）对于热带太平洋的第一斜压模是现实的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它要求从基本方程推导标准的波动特性，并随后使用给定数据进行计算。给出的信息足以得出一个唯一解。\n- **客观性**：语言精确、量化，没有主观或偏颇的陈述。\n- **完整性和一致性**：问题是自洽的。给出的两个海盆长度值，$L = 15{,}000\\ \\mathrm{km}$和$L = 1.5 \\times 10^7\\ \\mathrm{m}$，是一致的（$15{,}000 \\times 10^3 = 1.5 \\times 10^7$）。虽然没有明确给出β参数（$\\beta$），但它是一个由地球自转和半径导出的行星动力学基本常数，其存在由“赤道β平面”框架所隐含。如下所示，其值对于最终的比率并非必需。\n- **现实性**：所做的假设（例如，忽略背景流、线性化）是理论模型中为分离出感兴趣的动力学而使用的标准简化。这些假设并未使问题在其背景下变得不切实际。\n\n**1.3：结论与行动**\n该问题是**有效的**，因为它在科学上合理、适定，并包含足够的信息以获得唯一解。我将继续进行详细解答。\n\n---\n\n**步骤2：解答**\n\n赤道被困波的动力学由赤道β平面（$f = \\beta y$）上的线性化浅水方程描述，其中$\\beta = \\frac{df}{dy}|_{y=0}$是赤道处科里奥利参数的恒定经向梯度。关于纬向速度$u$、经向速度$v$和温跃层深度异常$h$的控制方程为：\n\n$$ \\frac{\\partial u}{\\partial t} - \\beta y v = -g' \\frac{\\partial h}{\\partial x} \\quad (1) $$\n$$ \\frac{\\partial v}{\\partial t} + \\beta y u = -g' \\frac{\\partial h}{\\partial y} \\quad (2) $$\n$$ \\frac{\\partial h}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 \\quad (3) $$\n\n这里，$g'$是折合重力，$H$是上层海洋的等效深度。\n\n**赤道开尔文波相速度的推导**\n\n赤道开尔文波是一种以经向速度为零（$v=0$）为特征的特殊解。在此条件下，控制方程简化为：\n\n$$ \\frac{\\partial u}{\\partial t} = -g' \\frac{\\partial h}{\\partial x} \\quad (4) $$\n$$ \\beta y u = -g' \\frac{\\partial h}{\\partial y} \\quad (5) $$\n$$ \\frac{\\partial h}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0 \\quad (6) $$\n\n我们寻找形式为$f(x-ct, y)$的纬向传播类波解。对于此类解，偏导数之间存在关系$\\frac{\\partial}{\\partial t} = -c \\frac{\\partial}{\\partial x}$。将此应用于方程(4)和(6)：\n\n由(4)式：$-c \\frac{\\partial u}{\\partial x} = -g' \\frac{\\partial h}{\\partial x} \\implies c u = g' h$（假设积分为零）。\n由(6)式：$-c \\frac{\\partial h}{\\partial x} + H \\frac{\\partial u}{\\partial x} = 0 \\implies ch = H u$（假设积分为零）。\n\n对于非平凡解（$u, h \\neq 0$），我们可以将$u = (g'/c)h$代入第二个关系式：$c h = H (g'/c)h$。\n这简化为$c^2 = g'H$。\n因此，开尔文波的相速度$c_K$为：\n$$ c_K = \\sqrt{g'H} $$\n这些波向东传播（$c_K > 0$）。方程(5)决定了它们的经向结构。代入$u=(c_K/H)h$：$\\beta y (c_K/H)h = -g' \\partial h/\\partial y$。使用$c_K^2 = g'H$，这简化为$\\partial h/\\partial y = -(\\beta/c_K) y h$，其积分为高斯分布$h(y) \\propto \\exp(-\\beta y^2 / (2c_K))$，证实了该波被困于赤道。开尔文波是非频散的，因此该相速度适用于所有波长。\n\n**赤道罗斯贝波相速度的推导**\n\n对于$v \\neq 0$的一般情况，我们寻找形式为$f(y) e^{i(kx - \\omega t)}$的解，其中$k$是纬向波数，$\\omega$是角频率。通过系统地从方程(1)-(3)中消去$u$和$h$，可以推导出关于经向速度结构$\\hat{v}(y)$的单个方程：\n$$ \\frac{d^2 \\hat{v}}{dy^2} + \\left( \\frac{\\omega^2}{c_K^2} - k^2 - \\frac{k\\beta}{\\omega} - \\frac{\\beta^2 y^2}{c_K^2} \\right) \\hat{v} = 0 $$\n这里使用了$c_K^2 = g'H$。这是韦伯方程，也是量子谐振子的控制方程。对于物理上现实的解，速度振幅必须在$y \\to \\pm \\infty$时有界。这个量子化条件要求$\\hat{v}$的系数（不包括$y^2$项）必须是一个比例因子的奇数倍。具体来说，它产生频散关系：\n$$ \\frac{\\omega^2}{c_K^2} - k^2 - \\frac{k\\beta}{\\omega} = \\frac{\\beta}{c_K}(2n+1), \\quad n=0, 1, 2, ... $$\n整数$n$是经向模数。赤道罗斯贝波对应于$n \\ge 1$的模态。\n\n问题要求的是长波相速度，对应于小波数极限，$k \\to 0$。在此极限下，罗斯贝波的频率$\\omega$也变小。我们可以将频散关系重新整理成一个关于$\\omega$的三次方程：\n$$ \\omega^3 - (c_K^2 k^2 + (2n+1)\\beta c_K) \\omega - \\beta c_K^2 k = 0 $$\n对于小$k$，$\\omega^3$项是$k^3$量级，而其他项是$k$量级。忽略$\\omega^3$项得到低频（罗斯贝波）近似：\n$$ -((2n+1)\\beta c_K) \\omega - \\beta c_K^2 k \\approx 0 $$\n$$ \\omega \\approx -\\frac{\\beta c_K^2 k}{(2n+1)\\beta c_K} = -\\frac{c_K k}{2n+1} $$\n因此，长波极限下的相速度$c = \\omega/k$是：\n$$ c_R(n) = -\\frac{c_K}{2n+1} $$\n第一经向模罗斯贝波对应于$n=1$。其相速度$c_{R1}$是：\n$$ c_{R1} = -\\frac{c_K}{2(1)+1} = -\\frac{c_K}{3} $$\n负号表示向西传播。\n\n**穿越时间及其比率的计算**\n\n问题要求计算穿越时间的比率。我们首先定义开尔文波（$T_K$）和第一罗斯贝波（$T_{R1}$）穿越长度为$L$的海盆的穿越时间。\n开尔文波以速度$c_K$向东传播。其穿越时间是：\n$$ T_K = \\frac{L}{c_K} $$\n第一罗斯贝波以速度$|c_{R1}| = c_K/3$向西传播。其穿越时间是：\n$$ T_{R1} = \\frac{L}{|c_{R1}|} = \\frac{L}{c_K/3} = 3 \\frac{L}{c_K} $$\n第一罗斯贝波穿越时间与开尔文波穿越时间的无量纲比是：\n$$ \\frac{T_{R1}}{T_K} = \\frac{3 L/c_K}{L/c_K} = 3 $$\n这个结果是一个常数，与$g'$, $H$, 和$L$的具体值无关。\n\n为完整起见，我们可以使用给定值计算各自的速度和穿越时间：\n$g' = 0.03\\ \\mathrm{m\\,s^{-2}}$，$H = 200\\ \\mathrm{m}$，以及$L = 1.5 \\times 10^7\\ \\mathrm{m}$。\n\n开尔文波速：\n$$ c_K = \\sqrt{g'H} = \\sqrt{(0.03)(200)} = \\sqrt{6} \\approx 2.449\\ \\mathrm{m\\,s^{-1}} $$\n\n开尔文波穿越时间：\n$$ T_K = \\frac{1.5 \\times 10^7\\ \\mathrm{m}}{\\sqrt{6}\\ \\mathrm{m\\,s^{-1}}} \\approx 6.124 \\times 10^6\\ \\mathrm{s} \\times \\frac{1\\ \\mathrm{day}}{86400\\ \\mathrm{s}} \\approx 70.88\\ \\mathrm{days} $$\n\n第一罗斯贝波速（大小）：\n$$ |c_{R1}| = \\frac{c_K}{3} = \\frac{\\sqrt{6}}{3} \\approx 0.8165\\ \\mathrm{m\\,s^{-1}} $$\n\n第一罗斯贝波穿越时间：\n$$ T_{R1} = \\frac{L}{|c_{R1}|} = 3 T_K \\approx 3 \\times 70.88\\ \\mathrm{days} \\approx 212.6\\ \\mathrm{days} $$\n\n要求的最终答案是这些穿越时间的比率。如解析推导所示，这个比率恰好是$3$。问题要求将此结果报告为四位有效数字。",
            "answer": "$$\\boxed{3.000}$$"
        },
        {
            "introduction": "在掌握了波动动力学的基础上，本练习将深入ENSO的核心——海气耦合反馈机制。您将通过构建并分析一个简化的耦合模型，运用特征值分析来确定ENSO模态的稳定性和结构。这个数值实验让您能够亲手分离出著名的Bjerknes反馈，并量化云辐射反馈等其他过程如何改变ENSO的增长率和周期。",
            "id": "4035478",
            "problem": "要求您形式化并执行一个数值实验，以在一个厄尔尼诺-南方涛动（ENSO）的最小化中等耦合模型中分离 Bjerknes 反馈。Bjerknes 反馈是连接赤道东太平洋海表温度（SST）、赤道纬向风应力和温跃层深度异常的耦合正反馈回路：一个正的 SST 异常会引起西风应力异常，这会加深东部的温跃层，进而进一步使 SST 增暖。大气短波云反馈通过调节进入海洋的净短波辐射（作为 SST 异常的函数）为 SST 增加了一个额外的局地辐射反馈。为了分离 Bjerknes 反馈，我们将抑制大气短波云反馈，并量化由此导致的增长率和模态结构的变化。\n\n从以下原则和定义开始：\n\n- 设状态向量为 $\\mathbf{x} = [T, h, \\tau]^{\\top}$，其中 $T$ 是赤道东太平洋海表温度异常，单位为开尔文；$h$ 是赤道东太平洋温跃层深度异常，单位为米；$\\tau$ 是纬向风应力异常的无量纲代理。时间单位为月。\n- 线性化的混合层热收支、海洋调整和大气动量响应表示为一个线性时不变系统：\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\nT\\\\\nh\\\\\n\\tau\n\\end{bmatrix}\n=\n\\underbrace{\n\\begin{bmatrix}\n-(\\lambda_T - \\gamma_{\\mathrm{sw}})  \\alpha_h  \\alpha_{\\tau} \\\\\n0  -\\lambda_h  \\beta_{\\tau} \\\\\n\\beta_T  0  -\\lambda_{\\tau}\n\\end{bmatrix}\n}_{\\mathbf{A}}\n\\begin{bmatrix}\nT\\\\\nh\\\\\n\\tau\n\\end{bmatrix}.\n$$\n这里，$\\lambda_T$ 是 SST 的线性热阻尼率（单位为月$^{-1}$），$\\gamma_{\\mathrm{sw}}$ 是修改 SST 净辐射趋势的线性大气短波云反馈系数（单位为月$^{-1}$），$\\alpha_h$ 量化了 SST 趋势对温跃层深度异常的敏感性（单位为开尔文/米/月），$\\alpha_{\\tau}$ 量化了风应力对 SST 趋势的直接贡献（单位为开尔文/无量纲应力/月），$\\lambda_h$ 是温跃层深度异常的阻尼率（单位为月$^{-1}$），$\\beta_{\\tau}$ 是温跃层深度趋势对风应力的敏感性（单位为米/无量纲应力/月），$\\beta_T$ 是从 SST 到风应力趋势的大气耦合（单位为无量纲应力/开尔文/月），以及 $\\lambda_{\\tau}$ 是风应力异常的大气阻尼率（单位为月$^{-1}$）。Bjerknes 反馈是环路 $T \\rightarrow \\tau \\rightarrow h \\rightarrow T$，由非对角耦合项 $\\beta_T$、$\\beta_{\\tau}$ 和 $\\alpha_h$ 捕获。大气短波云反馈由 $\\gamma_{\\mathrm{sw}}$ 参数化，并局地作用于 $T$。\n- 主导耦合模态的增长率是矩阵 $\\mathbf{A}$ 具有最大实部的特征值的实部。将此特征值表示为 $\\lambda_{\\max} = \\sigma + i \\omega$，其中 $\\sigma = \\Re(\\lambda_{\\max})$ 且 $\\omega = \\Im(\\lambda_{\\max})$。如果 $|\\omega| \\neq 0$，振荡周期（单位为月）为 $2\\pi/|\\omega|$。模态结构由相应的特征向量 $\\mathbf{v} = [v_T, v_h, v_{\\tau}]^{\\top}$ 给出。通过 $v_T$ 进行归一化，并报告复数比 $v_h/v_T$ 和 $v_{\\tau}/v_T$ 的振幅和相位（辐角），单位为弧度。相位必须在区间 $[-\\pi, \\pi]$ 内。\n\n您的任务是实现一个程序，对于下面定义的每个测试用例，构建矩阵 $\\mathbf{A}$，计算其特征值和特征向量，选择具有最大实部的特征值，并报告：\n- 增长率 $\\sigma$（单位为月$^{-1}$），作为一个实数。\n- 振荡周期 $P$（单位为月），若 $|\\omega| > \\varepsilon$（其中 $\\varepsilon = 10^{-8}$）则计算为 $2\\pi/|\\omega|$，否则 $P = 0$。\n- $v_h/v_T$ 和 $v_{\\tau}/v_T$ 的振幅和相位（辐角），单位为弧度。相位必须在区间 $[-\\pi, \\pi]$ 内。\n- 所有角度量必须以弧度为单位。所有增长率必须以月$^{-1}$ 表示。所有周期必须以月表示。\n- 对于每个测试用- 例，您的程序应输出一个包含六个数字的列表：$[\\sigma, P, |v_h/v_T|, \\arg(v_h/v_T), |v_{\\tau}/v_T|, \\arg(v_{\\tau}/v_T)]$。\n\n通过比较大气短波云反馈活跃与被抑制时的主导模态，设计数值实验以分离 Bjerknes 反馈。使用以下参数测试套件，该套件探索了一个基准、抑制实验以及几个用于覆盖的边界情况。所有参数均使用上述指定的单位：\n\n- 情况 1（基准，大气短波云反馈活跃）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.06$。\n- 情况 2（抑制短波云反馈以分离 Bjerknes 反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 情况 3（通过移除 SST 到风的耦合来禁用 Bjerknes 环路，抑制短波云反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.00$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 情况 4（强局地热阻尼，抑制短波云反馈）：\n  - $\\lambda_T = 0.80$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 情况 5（中等强度的大气短波云反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.03$。\n\n算法要求：\n\n- 对于每种情况，完全按照指定的方式构建矩阵 $\\mathbf{A}$。\n- 计算 $\\mathbf{A}$ 的所有特征值和右特征向量。\n- 选择具有最大实部的特征值 $\\lambda_{\\max}$。如果多个特征值在数值容差内具有相同的实部，则选择具有最大虚部绝对值的那个。\n- 通过其温度分量 $v_T$ 归一化相应的特征向量 $\\mathbf{v}$；如果 $|v_T| < 10^{-12}$，则必须改为通过具有最大模的分量进行归一化，并且在形成所要求的比率 $v_h/v_T$ 和 $v_{\\tau}/v_T$ 时仍需使用一个小的复数扰动以避免除以零。在这种备用情况下，在形成比率前设置扰动为 $v_T \\leftarrow v_T + i \\cdot 10^{-12}$。\n- 报告每种情况下的六个所要求的量，均为浮点数。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身是按情况 1 到 5 的顺序排列的测试用例列表。例如，打印的行应类似于：“[[case1_values],[case2_values],...,[case5_values]]”。数字可以用标准十进制表示法打印。所有输出必须遵循指定的单位：增长率单位为月$^{-1}$，周期单位为月，角度单位为弧度。\n\n目标是量化在这一中等耦合框架内分离 Bjerknes 反馈时，抑制大气短波云反馈如何改变主导模态的增长率和模态结构。",
            "solution": "该问题要求对一个简化的、线性化的厄尔尼诺-南方涛动（ENSO）模型进行数值分析。该模型描述了赤道太平洋海表温度（$T$）、温跃层深度（$h$）和纬向风应力（$\\tau$）异常的耦合动力学。任务的核心是研究系统主导变率模态（称为主导耦合模态）在不同物理参数设置下的稳定性和结构。这涉及到对系统动力学矩阵 $\\mathbf{A}$ 进行特征值分解，以从大气短波云反馈中分离出 Bjerknes 反馈机制。\n\n该系统由一个线性时不变常微分方程控制：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{A} \\mathbf{x}\n$$\n其中状态向量为 $\\mathbf{x} = [T, h, \\tau]^{\\top}$。动力学矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-(\\lambda_T - \\gamma_{\\mathrm{sw}})  \\alpha_h  \\alpha_{\\tau} \\\\\n0  -\\lambda_h  \\beta_{\\tau} \\\\\n\\beta_T  0  -\\lambda_{\\tau}\n\\end{bmatrix}\n$$\n该矩阵中的参数代表了物理过程：$\\lambda_T$、$\\lambda_h$ 和 $\\lambda_{\\tau}$ 分别是 $T$、$h$ 和 $\\tau$ 的阻尼率。参数 $\\gamma_{\\mathrm{sw}}$ 代表云对 SST 的局地正反馈。非对角元素 $\\alpha_h$、$\\alpha_{\\tau}$、$\\beta_{\\tau}$ 和 $\\beta_T$ 代表状态变量之间的耦合。具体来说，敏感度 $\\beta_T$（SST 驱动风应力）、$\\beta_{\\tau}$（风应力驱动温跃层深度）和 $\\alpha_h$（温跃层深度驱动 SST）的乘积构成了被称为 Bjerknes 反馈的核心正反馈回路。\n\n这个线性系统的解具有 $\\mathbf{x}(t) = \\mathbf{v}e^{\\lambda t}$ 的形式，其中 $\\lambda$ 是 $\\mathbf{A}$ 的一个特征值，$\\mathbf{v}$ 是对应的特征向量。将这种形式代入微分方程，得到标准的特征值问题 $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$。\n\n每个模态的时间演化由其特征值 $\\lambda = \\sigma + i\\omega$ 决定。\n- 实部 $\\sigma = \\Re(\\lambda)$ 是模态的增长率。正增长率（$\\sigma > 0$）表示一个不稳定的增长模态，这是 ENSO 的特征。负增长率（$\\sigma < 0$）表示一个稳定的衰减模态。单位是月$^{-1}$。\n- 虚部 $\\omega = \\Im(\\lambda)$ 是振荡的角频率。对于 $\\omega \\neq 0$，振荡周期由 $P = 2\\pi/|\\omega|$ 给出。单位是月。\n\n问题要求识别“主导模态”，即最不稳定或最不稳定的模态。这对应于具有最大实部的特征值，记为 $\\lambda_{\\max}$。这个模态将随时间主导系统的行为。\n\n模态的结构由其对应的特征向量 $\\mathbf{v} = [v_T, v_h, v_{\\tau}]^{\\top}$ 描述。特征向量的分量通常是复数，编码了物理变量 $T$、$h$ 和 $\\tau$ 之间的相对振幅和相位关系。为了独立于模态的整体振幅（这是任意的）来分析这些关系，我们对特征向量进行归一化。问题指定通过 SST 分量 $v_T$ 进行归一化。得到的复数比 $r_h = v_h/v_T$ 和 $r_{\\tau} = v_{\\tau}/v_T$ 是关键的诊断量：\n- 模，例如 $|r_h| = |v_h/v_T|$，给出了相对于单位 SST 异常的温跃层深度异常的振幅。\n- 辐角（相位），例如 $\\arg(r_h) = \\arg(v_h/v_T)$，给出了温跃层异常相对于 SST 异常的相位，单位为弧度。正相位表示 $h$ 在振荡中领先于 $T$，而负相位表示 $h$ 落后于 $T$。\n\n每个测试用例的数值步骤如下：\n1.  使用指定的参数值构建矩阵 $\\mathbf{A}$。\n2.  计算 $\\mathbf{A}$ 的特征值和右特征向量。\n3.  将主导特征值 $\\lambda_{\\max}$ 识别为具有最大实部的那个。如果实部出现并列，则选择虚部绝对值最大的特征值。\n4.  提取相应的特征向量 $\\mathbf{v}$。\n5.  计算增长率 $\\sigma = \\Re(\\lambda_{\\max})$ 和周期 $P$。如果虚部的绝对值低于一个小阈值 $|\\omega| < \\varepsilon = 10^{-8}$，则周期设为 $0$。\n6.  计算复数比 $r_h = v_h/v_T$ 和 $r_{\\tau} = v_{\\tau}/v_T$。如果 SST 分量 $v_T$ 的绝对值非常小（小于 $10^{-12}$），则需要特殊处理。在这种边界情况下，为防止除以零或数值不稳定，在分母上添加一个小的虚数扰动：例如，比率变为 $v_h / (v_T + i \\cdot 10^{-12})$。\n7.  从复数比中提取振幅（$|r_h|$、$|r_{\\tau}|$）和相位（$\\arg(r_h)$、$\\arg(r_{\\tau})$），确保相位在区间 $[-\\pi, \\pi]$ 内。\n8.  收集每种情况下的六个结果值：$[\\sigma, P, |v_h/v_T|, \\arg(v_h/v_T), |v_{\\tau}/v_T|, \\arg(v_{\\tau}/v_T)]$。\n\n此过程应用于五个不同的情况。情况 1（$\\gamma_{\\mathrm{sw}} > 0$）和情况 2（$\\gamma_{\\mathrm{sw}} = 0$）之间的比较特别量化了大气短波云反馈对主导 ENSO 模态的影响。情况 3 中 Bjerknes 反馈被禁用（$\\beta_T = 0$），作为对照，以证明该反馈在产生不稳定性中的关键作用。其他情况进一步探索了参数空间。",
            "answer": "[[0.02322002596489467,37.13532890538059,10.14381023772863,-1.547192667104868,3.842777648325757,-1.026774659979313],[-0.03677997403510533,40.24584488390885,12.399587282855173,-1.5204439058721997,4.301328909477033,-0.9922096739775079],[-0.1,0.0,2.5,-3.141592653589793,0.0,0.0],[-0.038198751515234185,41.2269550304323,12.564998319688461,-1.517036423583592,4.341492211186716,-0.9880155551382405],[-0.006779974035105327,38.61803738096181,11.233543883194514,-1.534241031359675,4.062837265882662,-1.0099499119515638]]"
        },
        {
            "introduction": "最后的这项实践将理论与现实联系起来，通过分析里程碑式的1997-98年厄尔尼诺事件的热量收支。利用关键物理过程的诊断数据，您将计算海洋混合层的温度趋势，并将峰值增温归因于其主导驱动项——无论是表面热通量、海洋平流还是冷水卷夹。这项练习让您真切地理解，在一个有记录以来最强的气候事件中，抽象的反馈机制是如何具体表现的。",
            "id": "4035453",
            "problem": "考虑1997公历年期间，赤道和东太平洋，具体在纬度 $0^{\\circ}$、经度 $110^{\\circ}\\,\\mathrm{W}$ 处的厄尔尼诺-南方涛动 (ENSO) 混合层温度趋势。提供给您三个对混合层热量收支有贡献的项的诊断月平均异常值：净表面热通量、水平平流和卷夹冷却。目标是确定峰值增温趋势所在的月份，将该峰值归因于主要贡献项，并量化这三项对局部混合层温度趋势的分数贡献。\n\n使用以下基于物理的框架作为起点：海洋混合层中的能量守恒。局部混合层温度趋势源于表面通量、水平输运和垂直交换过程。假设混合层水平均匀、深度恒定，并且除了三个诊断项外没有其他内部源或汇。\n\n定义和单位：\n- 令 $Q_{net}$ 表示进入海洋混合层的净表面热通量异常，单位为 $\\mathrm{W\\,m^{-2}}$。\n- 令 $Q_{adv}$ 表示诊断出的水平平流贡献，以等效的 $\\mathrm{W\\,m^{-2}}$ 为单位。\n- 令 $Q_{ent}$ 表示诊断出的卷夹冷却贡献，以等效的 $\\mathrm{W\\,m^{-2}}$ 为单位（正值表示冷却减少或净增温，负值表示冷却增强）。\n- 令 $\\rho$ 表示海水密度，单位为 $\\mathrm{kg\\,m^{-3}}$。\n- 令 $c_p$ 表示海水的比热容，单位为 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 令 $h$ 表示混合层深度，单位为 $\\mathrm{m}$。\n- 令 $\\partial_t T$ 表示月温度趋势，单位为 $\\mathrm{K\\,month^{-1}}$。\n\n假设：\n- 使用 $\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$ 和 $c_p = 3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 假设每个月有 $30$ 天，每天有 $86400\\,\\mathrm{s}$。\n- 所有提供的异常值均为1997年每个公历月的月平均值。\n\n推导要求：\n- 从混合层的能量守恒出发，推导一个表达式，用于根据三个诊断异常值和混合层深度 $h$ 计算月温度趋势 $\\partial_t T$。您的推导必须从第一性原理出发，不得依赖任何非由守恒定律和量纲一致性直接蕴含的快捷公式。\n\n计算和归因要求：\n- 对于每个参数集，计算 $\\partial_t T$ 的月度序列，单位为 $\\mathrm{K\\,month^{-1}}$。\n- 确定 $\\partial_t T$ 达到其最大值（峰值增温趋势）的月份索引 $m^{\\ast}$（一个从1到12的整数）。\n- 在峰值月份 $m^{\\ast}$，将该月中 $\\{Q_{net}, Q_{adv}, Q_{ent}\\}$ 中具有最大正贡献的单个项定义为主要项。如果出现平局，请根据下面指定的映射选择最小的代码。\n- 计算峰值月份各项的分数贡献，即 $f_{net} = Q_{net}/S$，$f_{adv} = Q_{adv}/S$，以及 $f_{ent} = Q_{ent}/S$，其中 $S = Q_{net} + Q_{adv} + Q_{ent}$ 是峰值月份三个贡献的总和，单位为 $\\mathrm{W\\,m^{-2}}$。这些分数是无量纲的，如果某一项导致冷却而净趋势是增温，则该分数可以为负。如果峰值月份的 $S = 0$，则将所有分数设为 $0$。\n- 报告峰值月度趋势 $\\partial_t T$（单位为 $\\mathrm{K\\,month^{-1}}$），四舍五入到六位小数。\n- 报告分数贡献 $f_{net}$、$f_{adv}$ 和 $f_{ent}$，四舍五入到三位小数。\n- 将主要项映射到一个整数代码 $d$，如下所示：$Q_{net}$ 为 $0$，$Q_{adv}$ 为 $1$，$Q_{ent}$ 为 $2$。\n\n测试套件：\n为以下三个参数集计算输出。每个集合指定了混合层深度 $h$ 以及1997年1月至12月 $Q_{net}$、$Q_{adv}$ 和 $Q_{ent}$ 的12个月度异常值，单位为 $\\mathrm{W\\,m^{-2}}$：\n\n- 参数集 1：\n  - $h = 30$\n  - $Q_{net} = [\\,10,\\,15,\\,20,\\,35,\\,40,\\,30,\\,10,\\,-5,\\,-10,\\,-5,\\,0,\\,5\\,]$\n  - $Q_{adv} = [\\,-5,\\,0,\\,5,\\,15,\\,25,\\,20,\\,5,\\,-5,\\,-10,\\,-15,\\,-10,\\,-5\\,]$\n  - $Q_{ent} = [\\,5,\\,10,\\,20,\\,30,\\,35,\\,25,\\,10,\\,0,\\,-5,\\,-10,\\,-5,\\,0\\,]$\n- 参数集 2：\n  - $h = 20$\n  - $Q_{net} = [\\,0,\\,5,\\,10,\\,5,\\,0,\\,-5,\\,-10,\\,-5,\\,0,\\,5,\\,10,\\,5\\,]$\n  - $Q_{adv} = [\\,-10,\\,0,\\,20,\\,40,\\,30,\\,10,\\,0,\\,-10,\\,-20,\\,-10,\\,0,\\,10\\,]$\n  - $Q_{ent} = [\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5,\\,5\\,]$\n- 参数集 3：\n  - $h = 50$\n  - $Q_{net} = [\\,-20,\\,-15,\\,-10,\\,0,\\,5,\\,10,\\,5,\\,0,\\,-5,\\,-10,\\,-15,\\,-20\\,]$\n  - $Q_{adv} = [\\,10,\\,15,\\,20,\\,25,\\,20,\\,15,\\,10,\\,5,\\,0,\\,-5,\\,-10,\\,-15\\,]$\n  - $Q_{ent} = [\\,30,\\,25,\\,20,\\,15,\\,10,\\,5,\\,0,\\,-5,\\,-10,\\,-15,\\,-20,\\,-25\\,]$\n\n输出规范：\n- 对于每个参数集，生成一个包含六个元素的列表：$[\\,m^{\\ast},\\,d,\\,\\partial_t T\\ \\mathrm{(K\\,month^{-1})},\\,f_{net},\\,f_{adv},\\,f_{ent}\\,]$，其中 $m^{\\ast}$ 和 $d$ 是整数，$\\partial_t T$ 是一个四舍五入到六位小数的浮点数，而 $f_{net}$、$f_{adv}$、$f_{ent}$ 是四舍五入到三位小数的浮点数。\n- 您的程序应生成单行输出，其中包含结果，格式为一个用方括号括起来的逗号分隔列表，其中每个元素本身是对应参数集的六元素列表，并按顺序排列。例如，最终输出应如下所示：$[[\\dots],[\\dots],[\\dots]]$。",
            "solution": "该问题已经过验证，被确定为具有科学依据、问题良构且客观。它是在物理海洋学和气候科学中一项常见任务，即应用能量守恒原理于一个简化的海洋混合层模型的标准练习。所有必需的参数和数据都已提供，计算要求也已明确规定。\n\n解决方案分两个阶段进行：首先，从第一性原理推导温度趋势的控制方程；其次，将此方程应用于所提供的数据集以计算所需的量。\n\n**温度趋势方程的推导**\n\n基本原理是海洋混合层内一个控制体积的能量守恒。我们考虑一个垂直的海水柱，其水平横截面积 $A$ 和混合层深度 $h$ 均为常数。\n\n储存在此体积水中的总热能 $U$ 由下式给出：\n$$\nU = m c_p T\n$$\n其中 $m$ 是水的质量，$c_p$ 是海水的比热容，$T$ 是混合层的温度，假设其是均匀的。\n\n质量 $m$ 可以用海水密度 $\\rho$ 和水柱体积 $V = A \\cdot h$ 来表示：\n$$\nm = \\rho V = \\rho A h\n$$\n将此代入能量方程可得：\n$$\nU = (\\rho A h) c_p T\n$$\n局部温度趋势是温度随时间的变化率，即 $\\frac{dT}{dt}$。根据热力学第一定律，系统内能的变化率 $\\frac{dU}{dt}$ 等于向系统加热的净速率。问题指定了对热量收支的三个贡献，均以通量（单位面积的功率，单位为 $\\mathrm{W\\,m^{-2}}$ 或 $\\mathrm{J\\,s^{-1}\\,m^{-2}}$）的形式给出：净表面热通量异常（$Q_{net}$）、水平平流贡献（$Q_{adv}$）和卷夹贡献（$Q_{ent}$）。\n\n进入水柱的单位面积总热通量是这些贡献的总和：\n$$\nQ_{total} = Q_{net} + Q_{adv} + Q_{ent}\n$$\n进入该体积的总热能速率（功率，$P$）是此通量乘以面积 $A$：\n$$\nP = Q_{total} \\cdot A = (Q_{net} + Q_{adv} + Q_{ent}) A\n$$\n储存的热能的变化率通过对 $U$ 求时间导数得到：\n$$\n\\frac{dU}{dt} = \\frac{d}{dt} [(\\rho A h) c_p T]\n$$\n假设 $\\rho$、$A$、$h$ 和 $c_p$ 不随时间变化，我们可以写出：\n$$\n\\frac{dU}{dt} = \\rho A h c_p \\frac{dT}{dt}\n$$\n将供给的热量速率 $P$ 与内能的变化率 $\\frac{dU}{dt}$ 相等：\n$$\n\\rho A h c_p \\frac{dT}{dt} = (Q_{net} + Q_{adv} + Q_{ent}) A\n$$\n面积 $A$ 是两边的公因子，可以消去，这在处理局部一维模型时是符合预期的：\n$$\n\\rho h c_p \\frac{dT}{dt} = Q_{net} + Q_{adv} + Q_{ent}\n$$\n求解瞬时温度趋势 $\\frac{dT}{dt}$ 可得：\n$$\n\\frac{dT}{dt} = \\frac{Q_{net} + Q_{adv} + Q_{ent}}{\\rho c_p h}\n$$\n右侧的单位是 $\\frac{[\\mathrm{W\\,m^{-2}}]}{[\\mathrm{kg\\,m^{-3}}] [\\mathrm{J\\,kg^{-1}\\,K^{-1}}] [\\mathrm{m}]} = \\frac{[\\mathrm{J\\,s^{-1}\\,m^{-2}}]}{[\\mathrm{J\\,K^{-1}\\,m^{-2}}]} = [\\mathrm{K\\,s^{-1}}]$。\n\n问题要求的是月温度趋势，记为 $\\partial_t T$，单位为 $\\mathrm{K\\,month^{-1}}$。我们得到了一个转换系数，即每个月按 $30$ 天计算，每天有 $86400$ 秒。令 $\\tau$ 为这样一个月份的秒数：\n$$\n\\tau = 30\\, \\mathrm{days\\,month^{-1}} \\times 86400\\, \\mathrm{s\\,day^{-1}} = 2,592,000\\, \\mathrm{s\\,month^{-1}}\n$$\n要将趋势从 $\\mathrm{K\\,s^{-1}}$ 转换为 $\\mathrm{K\\,month^{-1}}$，我们乘以 $\\tau$：\n$$\n\\partial_t T \\, [\\mathrm{K\\,month^{-1}}] = \\frac{dT}{dt} \\, [\\mathrm{K\\,s^{-1}}] \\times \\tau \\, [\\mathrm{s\\,month^{-1}}]\n$$\n代入 $\\frac{dT}{dt}$ 的表达式，我们得到月温度趋势的最终公式：\n$$\n\\partial_t T = \\left( \\frac{Q_{net} + Q_{adv} + Q_{ent}}{\\rho c_p h} \\right) \\times (30 \\times 86400)\n$$\n\n**计算步骤**\n\n对于每个参数集，应用以下算法：\n1.  定义常数：$\\rho = 1025\\,\\mathrm{kg\\,m^{-3}}$，$c_p = 3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，以及 $\\tau = 2592000\\,\\mathrm{s\\,month^{-1}}$。\n2.  对于给定的混合层深度 $h$，计算转换因子 $C = \\frac{\\tau}{\\rho c_p h}$。\n3.  对于从一月（1）到十二月（12）的每个月，计算该月 $m$ 的总热通量异常 $S_m = Q_{net,m} + Q_{adv,m} + Q_{ent,m}$。\n4.  计算每个月的月温度趋势：$\\partial_t T_m = S_m \\times C$。\n5.  确定峰值增温月份 $m^{\\ast}$，即 $\\partial_t T_m$ 最大的月份索引。\n6.  在月份 $m^{\\ast}$，确定贡献项 $\\{Q_{net,m^{\\ast}}, Q_{adv,m^{\\ast}}, Q_{ent,m^{\\ast}}\\}$。主要项是具有最大正值的项。记录相应的整数代码 $d$（$Q_{net}$ 为 $0$，$Q_{adv}$ 为 $1$，$Q_{ent}$ 为 $2$）。如果出现平局，选择最小的代码。\n7.  在月份 $m^{\\ast}$，计算总通量 $S_{m^{\\ast}}$。分数贡献计算如下：$f_{net} = Q_{net,m^{\\ast}}/S_{m^{\\ast}}$，$f_{adv} = Q_{adv,m^{\\ast}}/S_{m^{\\ast}}$，以及 $f_{ent} = Q_{ent,m^{\\ast}}/S_{m^{\\ast}}$。如果 $S_{m^{\\ast}} = 0$，所有分数都设为 $0$。\n8.  将峰值趋势 $\\partial_t T_{m^{\\ast}}$ 四舍五入到六位小数，并将分数贡献四舍五入到三位小数。\n9.  该参数集的最终结果是列表 $[m^{\\ast}, d, \\partial_t T_{m^{\\ast}}, f_{net}, f_{adv}, f_{ent}]$。对所有三个参数集重复此过程。",
            "answer": "[[5,0,2.128362,0.4,0.25,0.35],[4,1,1.487805,0.083,0.667,0.083],[1,2,0.435421,-0.667,0.5,1.0]]"
        }
    ]
}