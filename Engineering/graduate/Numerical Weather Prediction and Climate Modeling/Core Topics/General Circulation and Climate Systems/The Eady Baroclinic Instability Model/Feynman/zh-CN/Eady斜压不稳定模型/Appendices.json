{
    "hands_on_practices": [
        {
            "introduction": "为了完全理解垂直切变在斜压不稳定中的作用，研究当切变不存在时的系统是很有启发性的。本练习将证明，在没有切变提供的有效势能的情况下，系统仅支持中性波，这强调了垂直切变是Eady不稳定的根本驱动力。",
            "id": "4099821",
            "problem": "考虑经典的 Eady 斜压不稳定模型，该模型在 $f$ 平面上，采用准地转 (QG) 和布辛涅斯克 (Boussinesq) 近似，并具有恒定的科里奥利参数 $f_0$ 和恒定的布伦特-维萨拉频率 $N$。流体在 $z=0$ 和 $z=H$ 处受刚性盖的约束。基本态水平流为 $\\bar{U}(z)=U_0+\\Lambda z$，其中 $U_0$ 和 $\\Lambda$ 是常数，并且除了热成风平衡所隐含的，不存在其他背景水平密度变化。小振幅扰动由地转流函数 $\\psi(x,y,z,t)$ 描述，其地转速度为 $u'=-\\partial \\psi/\\partial y$ 和 $v'=\\partial \\psi/\\partial x$，静力浮力扰动为 $b'=f_0\\,\\partial \\psi/\\partial z$，垂直速度 $w'$ 满足在 $z=0$ 和 $z=H$ 处的刚性盖条件 $w'=0$。\n\n仅使用：\n- 地转平衡和静力平衡将 $u'$、$v'$ 和 $b'$ 与 $\\psi$ 联系起来，\n- 线性化的浮力（热力学）方程，\n- 连接 $\\partial \\bar{U}/\\partial z$ 和平均经向浮力梯度的热成风关系，\n\n推导在 $z=0$ 和 $z=H$ 处，用 $\\psi$ 和基本态参数表示的 $\\partial \\psi/\\partial z$ 的边界演化方程，然后将其特化到 $\\Lambda=0$（即 $\\bar{U}(z)=U_0$）的情况。证明当 $\\Lambda=0$ 时，边界动力学简化为无指数增长的中性边界扰动，并通过寻找形式为 $\\psi(x,y,z,t)=\\Re\\{\\hat{\\psi}(z)\\exp[i(kx+\\ell y-\\omega t)]\\}$ 的简正模（其中 $k$ 和 $\\ell$ 为实水平波数）来确定相应的实位相速度 $c$。\n\n将最终答案表示为 $c$ 关于 $U_0$ 的单一闭合形式解析表达式。不要代入数值。无需四舍五入。将最终答案以符号形式表示为仅 $U_0$ 的函数（无单位）。",
            "solution": "该问题被验证为科学上成立、提法恰当且客观。它代表了 Eady 斜压不稳定模型背景下的一个标准推导。我们开始求解。\n\n目标是推导地转流函数扰动 $\\psi$ 的边界演化方程，然后分析背景切变为零（即 $\\Lambda = 0$）的特殊情况。\n\n分析从 $f$ 平面上的准地转 (QG) 近似下的线性化布辛涅斯克热力学（浮力）方程开始：\n$$\n\\frac{D_g b'}{Dt} + v' \\frac{\\partial \\bar{b}}{\\partial y} + w' N^2 = 0\n$$\n其中 $b'$ 是浮力扰动，$\\bar{b}$ 是背景浮力， $v'$ 是经向速度扰动， $w'$ 是垂直速度扰动， $N$ 是恒定的布伦特-维萨拉频率。算子 $\\frac{D_g}{Dt}$ 表示跟随基本态地转流的物质导数，对于纯纬向流 $\\bar{U}(z)$，其表达式为：\n$$\n\\frac{D_g}{Dt} = \\frac{\\partial}{\\partial t} + \\bar{U}(z) \\frac{\\partial}{\\partial x}\n$$\n\n问题给出了扰动场用地转流函数 $\\psi(x,y,z,t)$ 表示的关系：\n- 经向速度：$v' = \\frac{\\partial \\psi}{\\partial x}$\n- 浮力：$b' = f_0 \\frac{\\partial \\psi}{\\partial z}$，其中 $f_0$ 是恒定的科里奥利参数。\n\n问题还要求使用热成风关系，该关系将平均纬向流的垂直切变 $\\frac{\\partial \\bar{U}}{\\partial z}$ 与平均经向浮力梯度 $\\frac{\\partial \\bar{b}}{\\partial y}$ 联系起来。热成风关系为：\n$$\nf_0 \\frac{\\partial \\bar{U}}{\\partial z} = \\frac{\\partial \\bar{b}}{\\partial y}\n$$\n问题指定基本态流为 $\\bar{U}(z) = U_0 + \\Lambda z$，其中 $U_0$ 和 $\\Lambda$ 是常数。因此，$\\frac{\\partial \\bar{U}}{\\partial z} = \\Lambda$。热成风关系于是给出 $\\frac{\\partial \\bar{b}}{\\partial y} = f_0 \\Lambda$。\n\n将 $b'$、$v'$ 和 $\\frac{\\partial \\bar{b}}{\\partial y}$ 的这些表达式代入线性化浮力方程，得到：\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\bar{U}(z) \\frac{\\partial}{\\partial x}\\right)\\left(f_0 \\frac{\\partial \\psi}{\\partial z}\\right) + \\left(\\frac{\\partial \\psi}{\\partial x}\\right)(f_0 \\Lambda) + w' N^2 = 0\n$$\n由于 $f_0$ 是一个常数，我们可以将整个方程除以 $f_0$：\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\bar{U}(z) \\frac{\\partial}{\\partial x}\\right)\\frac{\\partial \\psi}{\\partial z} + \\Lambda \\frac{\\partial \\psi}{\\partial x} + \\frac{N^2}{f_0} w' = 0\n$$\n该方程描述了整个流体中浮力场的演化。问题指定在垂直边界 $z=0$ 和 $z=H$ 处有刚性平盖。在这些盖子上的运动学边界条件是垂直速度 $w'$ 必须为零。\n$$\nw' = 0 \\quad \\text{在} \\quad z=0 \\text{ 和 } z=H\n$$\n将此条件应用于浮力方程，得到 $\\frac{\\partial \\psi}{\\partial z}$ 的边界演化方程：\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\bar U(z) \\frac{\\partial}{\\partial x}\\right)\\frac{\\partial \\psi}{\\partial z} + \\Lambda \\frac{\\partial \\psi}{\\partial x} = 0 \\quad \\text{在} \\quad z=0, H\n$$\n这是 Eady 模型的一般边界条件。\n\n接下来，我们特化到垂直切变为零的情况，即 $\\Lambda = 0$。在这种情况下，基本态流随高度均匀：$\\bar{U}(z) = U_0$。边界演化方程显著简化为：\n$$\n\\left(\\frac{\\partial}{\\partial t} + U_0 \\frac{\\partial}{\\partial x}\\right)\\frac{\\partial \\psi}{\\partial z} = 0 \\quad \\text{在} \\quad z=0, H\n$$\n这是一个关于量 $\\frac{\\partial \\psi}{\\partial z}$（与边界浮力 $b'$ 成正比）的线性平流方程。它表明，在顶部和底部边界上的任何浮力模式都简单地以基本态流的恒定速度 $U_0$ 进行纬向平流。因为扰动的振幅不改变，只改变其位置，所以扰动是中性的（即，它不发生指数增长或衰减）。这表明边界动力学简化为中性扰动。\n\n为了确定相应的相速度 $c$，我们寻找形为如下的简正模解：\n$$\n\\psi(x,y,z,t) = \\Re\\left\\{\\hat{\\psi}(z)\\exp[i(kx+\\ell y-\\omega t)]\\right\\}\n$$\n其中 $k$ 和 $\\ell$ 是实水平波数，$\\omega$ 是频率。对于这样的解，关于时间 $t$ 和纬向坐标 $x$ 的偏导数变为乘法：\n$$\n\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega \\quad \\text{和} \\quad \\frac{\\partial}{\\partial x} \\rightarrow ik\n$$\n将这些代入简化后的边界方程，得到：\n$$\n(-i\\omega + U_0(ik))\\frac{d\\hat{\\psi}}{dz} = 0 \\quad \\text{在} \\quad z=0, H\n$$\n对于一个非平凡波解（即 $k \\ne 0$）和一个非平凡的垂直结构（即在边界处 $\\frac{d\\hat{\\psi}}{dz} \\neq 0$），括号中的项必须为零：\n$$\n-i\\omega + ikU_0 = 0\n$$\n$$\ni k (U_0 - \\omega/k) = 0\n$$\n$x$ 方向的相速度定义为 $c = \\omega/k$。方程变为：\n$$\ni k (U_0 - c) = 0\n$$\n由于 $k \\ne 0$，我们必有：\n$$\nU_0 - c = 0 \\implies c = U_0\n$$\n相速度 $c$ 是一个实数，等于均匀背景流的速度 $U_0$。实的相速度证实了波是中性的，因为解的时间部分 $\\exp(-i\\omega t) = \\exp(-ikct)$ 是纯振荡的，没有指数增长或衰减。\n因此，这些中性扰动的相速度是 $c=U_0$，这只是 $U_0$ 的函数，符合题目要求。",
            "answer": "$$\n\\boxed{U_0}\n$$"
        },
        {
            "introduction": "Eady模型的精妙之处在于它清晰地阐释了斜压不稳定的机制。本练习让您能够验证该模型的核心概念：不稳定源于垂直边界上的两个“边缘波”的相互作用，这两个波相对于局地气流向相反方向传播，从而能够锁相并增长。",
            "id": "4099850",
            "problem": "考虑一个 Eady 斜压不稳定模型，该模型位于 $f$ 平面上，具有恒定的科里奥利参数 $f_{0}$、恒定的布伦特-维萨拉频率 $N$ 以及具有均匀垂直切变的基本态纬向风。该区域的上下边界为刚性盖，分别位于 $z=0$（底部）和 $z=H$（顶部），其中 $H=1.0\\times 10^{4}\\ \\mathrm{m}$。基本态纬向风为 $U(z)=S\\,z$，其中 $S=\\partial U/\\partial z$ 是一个正常数。取 $S=1.0\\times 10^{-3}\\ \\mathrm{s}^{-1}$，因此 $U(0)=0$ 且 $U(H)=10\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。对于纬向波数 $k=1.6\\times 10^{-6}\\ \\mathrm{m}^{-1}$ 的正规模态分析得出一个复频率，其实部定义了一个实相速度 $c=5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。\n\n从相速度的基本定义和平均流平流的运动学效应出发，推导在移动介质中，观测到的相速度与扰动的内在相速度之间的关系。利用这个关系，根据给定的 $U(z)$ 和计算出的 $c$，确定顶部（$z=H$）和底部（$z=0$）边界上经多普勒频移的内在相速度。然后，验证 Eady 斜压不稳定性的反向传播条件是否满足，即两个边界上的内在相速度符号相反。\n\n以米/秒为单位表示这两个内在相速度，按“顶部，底部”的顺序排列，并将您的数值四舍五入到三位有效数字。",
            "solution": "该问题陈述被认为是有效的，因为它科学地基于地球物理流体动力学的原理，特别是 Eady 斜压不稳定模型。所提供的数据内部一致，对于地球大气层是物理上合理的，并且足以得到唯一解。该问题是适定的和客观的。\n\n主要任务是确定模型区域顶部和底部边界处斜压波的内在相速度，并验证 Eady 不稳定性所必需的反向传播条件。\n\n首先，我们建立波的观测相速度与其在移动介质中的内在相速度之间的基本关系。一个沿纬向（$x$ 方向）传播的波扰动，可以表示为与 $\\exp(i(kx - \\omega t))$ 成正比的形式，其中 $k$ 是纬向波数，$\\omega$ 是在静止参考系中观测到的角频率。波的相位是 $\\phi(x, t) = kx - \\omega t$。\n\n观测到的相速度 $c$ 是等相位点传播的速度。根据定义，这意味着 $\\frac{d\\phi}{dt} = 0$。跟随一个等相位点，我们有：\n$$ \\frac{d}{dt}(kx - \\omega t) = k \\frac{dx}{dt} - \\omega = 0 $$\n因此，观测到的相速度为 $c = \\frac{dx}{dt} = \\frac{\\omega}{k}$。\n\n现在，考虑这个波叠加在基本态纬向流 $U$ 上。一个以速度 $U$ 随流体运动的观察者会感知到波具有一个不同的频率，称为内在频率 $\\hat{\\omega}$。这个频率因介质的运动而发生多普勒频移。该关系通过考虑在随流体运动的参考系 $x' = x - Ut$ 中波的相位来推导。将 $x = x' + Ut$ 代入相位表达式，得到：\n$$ \\phi = k(x' + Ut) - \\omega t = kx' - (\\omega - kU)t $$\n在这个移动参考系中，相位是 $\\phi = kx' - \\hat{\\omega} t$，其中内在频率为：\n$$ \\hat{\\omega} = \\omega - kU $$\n在这个移动参考系中测量的相速度是内在相速度 $c_i$。其定义为：\n$$ c_i = \\frac{\\hat{\\omega}}{k} $$\n代入 $\\hat{\\omega}$ 的表达式，我们得到所需的关系：\n$$ c_i = \\frac{\\omega - kU}{k} = \\frac{\\omega}{k} - U = c - U $$\n这个方程表明，内在相速度是观测相速度相对于背景流速度的值。由于本问题中的背景流 $U(z)$ 是高度的函数，因此内在相速度 $c_i(z)$ 也是高度的函数。\n\n问题提供了以下信息：\n- 基本态纬向风: $U(z) = S\\,z$\n- 恒定垂直切变: $S = 1.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}$\n- 区域高度: $H = 1.0 \\times 10^{4}\\ \\mathrm{m}$\n- 观测相速度: $c = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n\n我们现在可以计算底部边界（$z=0$）和顶部边界（$z=H$）的内在相速度。\n\n在底部边界，$z=0$：\n基本态风速为 $U(0) = S \\times 0 = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。\n底部的内在相速度是：\n$$ c_i(0) = c - U(0) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} - 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1} = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n\n在顶部边界，$z=H$：\n基本态风速为 $U(H) = S \\times H$。\n$$ U(H) = (1.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}) \\times (1.0 \\times 10^{4}\\ \\mathrm{m}) = 10\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n顶部的内在相速度是：\n$$ c_i(H) = c - U(H) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} - 10\\ \\mathrm{m}\\ \\mathrm{s}^{-1} = -5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n\n最后一步是验证 Eady 斜压不稳定性的反向传播条件。这个条件要求顶部和底部边界的内在相速度符号相反，这使得边界波能够发生锁相和相互放大。\n我们已经求得：\n- $c_i(0) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ (正)\n- $c_i(H) = -5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ (负)\n\n由于 $\\text{sign}(c_i(H)) \\neq \\text{sign}(c_i(0))$，反向传播条件得到满足。这与波是不稳定的这一事实相符，正如在 Eady 模型框架下的问题设置所暗示的那样，其中观测相速度 $c$ 位于背景流的最小值和最大值之间，即 $U(0)  c  U(H)$。\n\n问题要求提供两个内在相速度，按“顶部，底部”的顺序排列。\n顶部的内在相速度，$z=H$：$-5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。\n底部的内在相速度，$z=0$：$5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -5.00  5.00 \\end{pmatrix} } $$"
        },
        {
            "introduction": "尽管解析模型提供了深刻的物理洞察，但现代大气科学依赖于数值模拟。这个实践问题将理论与实践联系起来，指导您确定精确捕捉Eady波垂直结构所需的数值网格分辨率，这是建立可靠模型的关键一步。",
            "id": "4099855",
            "problem": "考虑在 $f$ 平面上准地转动力学中的经典 Eady 斜压不稳定设置，其中流体层深度有限为 $H$，具有恒定的布伦特-维萨拉频率 $N$ 和均匀的垂直切变 $U(z)=\\Lambda z$。对于与 $\\exp\\{i(kx+ly-\\omega t)\\}$ 成正比的简正模扰动，其水平波数大小为 $K=\\sqrt{k^2+l^2}$，在准地转位涡方程中应用变量分离法，可得到关于垂直包络 $G(z)$ 的垂直结构方程，形式如下\n$$\n\\frac{d^2 G}{dz^2} - \\alpha^2 G = 0,\n$$\n其中 $\\alpha = \\frac{N}{f_0} K$，而 $f_0$ 是一个恒定的参考科里奥利参数。刚盖边界和线性化的浮力边界条件导出以下形式的 Robin 边界条件\n$$\n\\left.\\frac{dG}{dz}\\right|_{z=0} = \\beta\\, G(0), \\qquad \\left.\\frac{dG}{dz}\\right|_{z=H} = -\\beta\\, G(H),\n$$\n其中 $\\beta$ 是一个依赖于相速度和切变的实参数（不要先验地假设 $\\beta$ 的任何显式值）。\n\n你的任务是：\n\n1. 从上述控制常微分方程和边界条件出发，在均匀网格 $z_i = i\\,\\Delta z$（其中 $i=0, 1, \\dots, N_z$ 且 $H = N_z \\Delta z$）上设计一个关于垂直坐标 $z$ 的二阶有限差分格式，该格式能强制满足内部方程和两个 Robin 边界条件。内部点必须使用中心二阶导数，边界条件必须用协调的单边差分来近似。请用 $G_i \\approx G(z_i)$ 明确指定内部点和边界点处的离散方程。\n\n2. 为确保对于 $\\alpha H \\sim \\mathcal{O}(1)$ 的模态所解析的垂直结构具有数值精度，请基于离散二阶导数算子作用于代表性函数 $G(z) = e^{\\alpha z}$ 时的相对误差，推导一个关于 $\\Delta z$ 的分辨率判据。对于任意内部点处 $\\frac{d^2 G}{dz^2}$ 的中心二阶差分近似，定义相对误差\n$$\n\\mathcal{R}(a) = \\frac{\\left[\\frac{G(z+\\Delta z) - 2G(z) + G(z-\\Delta z)}{\\Delta z^2}\\right]}{\\left[\\frac{d^2 G}{dz^2}\\right]} - 1, \\quad \\text{其中 } a=\\alpha \\Delta z,\n$$\n并施加一个精度阈值 $\\varepsilon$ 使得 $|\\mathcal{R}(a)| \\le \\varepsilon$ 成立。使用此判据确定在指定容差 $\\varepsilon$ 下，精确捕捉具有给定 $\\alpha H$ 值的模态所需的最大网格间距 $\\Delta z$（单位为米）。\n\n3. 实现一个程序，根据任务2中的分辨率判据，为以下每个测试用例计算并返回临界垂直网格间距 $\\Delta z$（单位为米）。该程序无需解 $G(z)$ 的边值问题；但它必须根据推导出的误差判据正确计算 $\\Delta z$。所有最终答案都以米（m）为单位表示为浮点数。\n\n使用以下测试套件，该套件探讨了 $\\alpha H$ 的不同区间：\n\n- 测试用例1（典型的 $\\mathcal{O}(1)$ 模态）：$H = 10000$ 米，$\\alpha H = 1.0$，$\\varepsilon = 0.05$。\n- 测试用例2（弱变化的垂直结构）：$H = 10000$ 米，$\\alpha H = 0.3$，$\\varepsilon = 0.05$。\n- 测试用例3（强变化的垂直结构）：$H = 10000$ 米，$\\alpha H = 3.0$，$\\varepsilon = 0.05$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与上述测试用例一致（例如，“[$\\Delta z_1$, $\\Delta z_2$, $\\Delta z_3$]”）。输出必须是代表 $\\Delta z$（单位为米）的浮点数。\n\n在你的推导和格式设计中，你必须遵守以下基本原则，不得引入快捷公式：\n- 准地转位涡和静力平衡的定义，这些定义在均匀层结 $N$ 和切变 $U(z)$ 条件下导出可分离的垂直结构。\n- 在均匀网格上用于内部和边界导数的协调二阶精度有限差分。\n- 为设定分辨率要求而对指数剖面的离散二阶导数误差进行显式计算。\n\n无需外部数据。问题描述中的所有符号、变量、函数、算子和数字都必须使用 $...$（用于内联表达式）或 $$...$$（用于陈列方程）以 LaTeX 格式书写。所有数值输出均以米（m）为单位作答，不要使用百分号；容差请用小数指定。本问题中不需要角度单位。",
            "solution": "该问题被评估为有效，因为它在科学上基于准地转理论，是适定的，并为所有任务提供了一套完整且一致的定义和参数。\n\n### 任务1：有限差分格式设计\n\n目标是在一个均匀的垂直网格上离散化控制常微分方程（ODE）及其边界条件。该网格由点 $z_i = i\\,\\Delta z$（$i=0, 1, \\dots, N_z$）定义，其中 $\\Delta z = H/N_z$ 是网格间距。函数 $G(z)$ 在这些点上的离散近似表示为 $G_i \\equiv G(z_i)$。\n\n**内部点**\n对于内部网格点 $i = 1, 2, \\dots, N_z-1$，控制 ODE 为\n$$\n\\frac{d^2 G}{dz^2} - \\alpha^2 G = 0\n$$\n我们对二阶导数采用二阶精度的中心有限差分近似：\n$$\n\\left.\\frac{d^2 G}{dz^2}\\right|_{z_i} \\approx \\frac{G(z_i+\\Delta z) - 2G(z_i) + G(z_i-\\Delta z)}{\\Delta z^2} = \\frac{G_{i+1} - 2G_i + G_{i-1}}{\\Delta z^2}\n$$\n将此代入 ODE，得到内部点的离散方程：\n$$\n\\frac{G_{i+1} - 2G_i + G_{i-1}}{\\Delta z^2} - \\alpha^2 G_i = 0\n$$\n这可以重排为一个三点差分格式关系：\n$$\nG_{i+1} - \\left(2 + (\\alpha \\Delta z)^2\\right)G_i + G_{i-1} = 0, \\quad \\text{对于 } i = 1, \\dots, N_z-1\n$$\n\n**边界条件**\n问题在 $z=0$ 和 $z=H$ 处指定了 Robin 边界条件。这些条件必须使用与内部格式的二阶精度相协调的单边差分进行近似。我们对一阶导数使用二阶精度的单边有限差分。\n\n**在下边界，$z=0$ (i=0)：**\n边界条件是 $\\left.\\frac{dG}{dz}\\right|_{z=0} = \\beta\\, G(0)$。\n$z_0$ 处一阶导数的二阶前向差分近似为：\n$$\n\\left.\\frac{dG}{dz}\\right|_{z_0} \\approx \\frac{-3G(z_0) + 4G(z_1) - G(z_2)}{2\\Delta z} = \\frac{-3G_0 + 4G_1 - G_2}{2\\Delta z}\n$$\n将其与边界条件相等，得到 $i=0$ 处的离散方程：\n$$\n\\frac{-3G_0 + 4G_1 - G_2}{2\\Delta z} = \\beta G_0\n$$\n重排后得到：\n$$\n(-3 - 2\\beta\\Delta z)G_0 + 4G_1 - G_2 = 0\n$$\n\n**在上边界，$z=H$ (i=$N_z$)：**\n边界条件是 $\\left.\\frac{dG}{dz}\\right|_{z=H} = -\\beta\\, G(H)$。\n$z_{N_z}$ 处一阶导数的二阶后向差分近似为：\n$$\n\\left.\\frac{dG}{dz}\\right|_{z_{N_z}} \\approx \\frac{3G(z_{N_z}) - 4G(z_{N_z-1}) + G(z_{N_z-2})}{2\\Delta z} = \\frac{3G_{N_z} - 4G_{N_z-1} + G_{N_z-2}}{2\\Delta z}\n$$\n将其与边界条件相等，得到 $i=N_z$ 处的离散方程：\n$$\n\\frac{3G_{N_z} - 4G_{N_z-1} + G_{N_z-2}}{2\\Delta z} = -\\beta G_{N_z}\n$$\n重排后得到：\n$$\nG_{N_z-2} - 4G_{N_z-1} + (3 + 2\\beta\\Delta z)G_{N_z} = 0\n$$\n综合起来，这些针对 $i=0, \\dots, N_z$ 的方程构成了一个关于未知数 $G_0, \\dots, G_{N_z}$ 的包含 $N_z+1$ 个线性方程的完备系统。\n\n### 任务2：分辨率判据推导\n\n目标是为网格间距 $\\Delta z$ 建立一个判据，以确保二阶导数算子的数值误差保持在指定的容差 $\\varepsilon$ 以下。该分析基于代表性函数 $G(z) = e^{\\alpha z}$，它是控制 ODE 的一个解。\n\n相对误差 $\\mathcal{R}$ 定义为：\n$$\n\\mathcal{R}(a) = \\frac{\\left[\\text{离散 } \\frac{d^2G}{dz^2}\\right]}{\\left[\\text{精确 } \\frac{d^2G}{dz^2}\\right]} - 1, \\quad \\text{其中 } a = \\alpha \\Delta z\n$$\n首先，我们计算 $G(z) = e^{\\alpha z}$ 的精确二阶导数：\n$$\n\\frac{d^2 G}{dz^2} = \\alpha^2 e^{\\alpha z}\n$$\n接下来，我们将中心二阶差分算子应用于 $G(z)$：\n$$\n\\frac{G(z+\\Delta z) - 2G(z) + G(z-\\Delta z)}{\\Delta z^2} = \\frac{e^{\\alpha(z+\\Delta z)} - 2e^{\\alpha z} + e^{\\alpha(z-\\Delta z)}}{\\Delta z^2}\n$$\n提出因子 $e^{\\alpha z}$：\n$$\n= \\frac{e^{\\alpha z} \\left(e^{\\alpha \\Delta z} - 2 + e^{-\\alpha \\Delta z}\\right)}{\\Delta z^2}\n$$\n使用恒等式 $\\cosh(x) = \\frac{e^x+e^{-x}}{2}$，括号中的项变为 $2\\cosh(\\alpha \\Delta z) - 2$。\n$$\n= \\frac{2e^{\\alpha z} \\left(\\cosh(\\alpha \\Delta z) - 1\\right)}{\\Delta z^2}\n$$\n现在，我们将这些表达式代入相对误差的定义中：\n$$\n\\mathcal{R}(a) = \\frac{\\left[ \\frac{2e^{\\alpha z} (\\cosh(\\alpha \\Delta z) - 1)}{\\Delta z^2} \\right]}{\\alpha^2 e^{\\alpha z}} - 1\n$$\n$e^{\\alpha z}$ 项被消去，代入 $a = \\alpha\\Delta z$，我们得到一个仅依赖于无量纲参数 $a$ 的 $\\mathcal{R}$ 表达式：\n$$\n\\mathcal{R}(a) = \\frac{2(\\cosh(a) - 1)}{a^2} - 1\n$$\n精度要求是 $|\\mathcal{R}(a)| \\le \\varepsilon$。\n为了分析 $\\mathcal{R}(a)$，我们使用 $\\cosh(a)$ 在 $a$ 较小时的泰勒级数展开：\n$$\n\\cosh(a) = 1 + \\frac{a^2}{2!} + \\frac{a^4}{4!} + \\mathcal{O}(a^6)\n$$\n将此代入 $\\mathcal{R}(a)$ 的表达式中：\n$$\n\\mathcal{R}(a) = \\frac{2\\left( (1 + \\frac{a^2}{2} + \\frac{a^4}{24} + \\dots) - 1 \\right)}{a^2} - 1 = \\frac{a^2 + \\frac{a^4}{12} + \\dots}{a^2} - 1 = \\frac{a^2}{12} + \\frac{a^4}{360} + \\dots\n$$\n由于当 $a \\neq 0$ 时级数中的所有项都为正，因此 $\\mathcal{R}(a) > 0$。条件 $|\\mathcal{R}(a)| \\le \\varepsilon$ 简化为 $\\mathcal{R}(a) \\le \\varepsilon$：\n$$\n\\frac{2(\\cosh(a) - 1)}{a^2} - 1 \\le \\varepsilon\n$$\n这个不等式定义了 $a$ 的一个上界。设 $a_{\\text{crit}}$ 是满足等式的 $a>0$ 的值：\n$$\n\\frac{2(\\cosh(a_{\\text{crit}}) - 1)}{a_{\\text{crit}}^2} - 1 = \\varepsilon\n$$\n这是一个关于 $a_{\\text{crit}}$ 的超越方程，对于给定的 $\\varepsilon$ 必须进行数值求解。任何满足 $a \\le a_{\\text{crit}}$ 的值都将满足精度要求。\n因为 $a = \\alpha \\Delta z$，分辨率判据变为 $\\alpha \\Delta z \\le a_{\\text{crit}}$，这意味着：\n$$\n\\Delta z \\le \\frac{a_{\\text{crit}}}{\\alpha}\n$$\n这个不等式为达到期望精度提供了最大允许网格间距 $\\Delta z_{\\max}$。我们将计算这个临界值。使用给定的参数 $\\alpha H$ 和 $H$，我们得到 $\\alpha = (\\alpha H)/H$。因此，临界网格间距为：\n$$\n\\Delta z_{\\text{crit}} = \\frac{a_{\\text{crit}}}{\\alpha} = \\frac{a_{\\text{crit}}}{(\\alpha H)/H} = H \\frac{a_{\\text{crit}}}{\\alpha H}\n$$\n\n### 任务3：临界网格间距的计算\n\n计算每个测试用例的临界网格间距的步骤如下：\n1.  对于给定的容差 $\\varepsilon$，数值求解方程 $\\frac{2(\\cosh(a) - 1)}{a^2} - (1+\\varepsilon) = 0$ 以找到唯一的正根 $a_{\\text{crit}}$。由于所有测试用例的 $\\varepsilon$ 都是恒定的，此步骤只需执行一次。\n2.  对每个测试用例，使用其特定的 $H$ 和 $\\alpha H$ 值。\n3.  使用公式 $\\Delta z_{\\text{crit}} = H \\frac{a_{\\text{crit}}}{\\alpha H}$ 计算临界网格间距。\n\n对于 $\\varepsilon = 0.05$，我们求解 $a_{\\text{crit}}$：\n$$\n\\frac{2(\\cosh(a_{\\text{crit}}) - 1)}{a_{\\text{crit}}^2} = 1.05\n$$\n一个数值求根算法（例如 Brent 方法）得出 $a_{\\text{crit}} \\approx 0.77158793$。然后用这个值来计算每种情况所需的网格间距。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve_for_a_crit(epsilon: float) - float:\n    \"\"\"\n    Solves the transcendental equation for the critical non-dimensional grid spacing 'a'.\n\n    The equation arises from the relative error criterion for the finite difference\n    approximation of the second derivative of an exponential function.\n    The equation is R(a) = epsilon, where R(a) = 2*(cosh(a)-1)/a^2 - 1.\n\n    Args:\n        epsilon: The desired relative error tolerance.\n\n    Returns:\n        The critical value a_crit  0 such that R(a_crit) = epsilon.\n    \"\"\"\n    # Define the function whose root we want to find: f(a) = R(a) - epsilon = 0.\n    def f(a):\n        # To avoid division by zero and loss of precision for small 'a',\n        # we can use the Taylor series expansion.\n        # R(a) = a^2/12 + a^4/360 + ...\n        # f(a) = a^2/12 + a^4/360 + ... - epsilon\n        if np.abs(a)  1e-8:\n            return -epsilon\n        return 2 * (np.cosh(a) - 1) / a**2 - (1 + epsilon)\n\n    # We need to find a bracketing interval [x0, x1] for the root.\n    # For small 'a', R(a) is approx a^2/12. So a_crit is approx sqrt(12 * epsilon).\n    # For epsilon=0.05, a_crit is approx sqrt(0.6) ~= 0.77.\n    # Let's choose a bracket safely around this estimate, e.g., [0.1, 2.0].\n    # f(0.1) should be negative and f(2.0) should be positive for epsilon=0.05.\n    try:\n        # Use Brent's method for robust and fast root finding.\n        sol = root_scalar(f, bracket=[1e-6, 2.0], method='brentq')\n        if sol.converged:\n            return sol.root\n        else:\n            raise RuntimeError(\"Root-finding algorithm did not converge.\")\n    except ValueError:\n        # This might happen if the bracket is not valid (f(x0)*f(x1) > 0).\n        raise ValueError(\"The root is not bracketed. Adjust the bracket interval.\")\n\n\ndef solve():\n    \"\"\"\n    Main function to calculate the critical vertical grid spacing for the given\n    test cases based on the Eady model resolution criterion.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (H in meters, dimensionless alpha*H, tolerance epsilon)\n    test_cases = [\n        (10000.0, 1.0, 0.05),  # Test case 1\n        (10000.0, 0.3, 0.05),  # Test case 2\n        (10000.0, 3.0, 0.05),  # Test case 3\n    ]\n\n    results = []\n    \n    # Since epsilon is the same for all test cases, we calculate a_crit only once.\n    epsilon = test_cases[0][2]\n    a_crit = solve_for_a_crit(epsilon)\n\n    for case in test_cases:\n        H, alpha_H, _ = case\n        \n        # The derivation provides a maximum allowable grid spacing (dz_max or dz_crit)\n        # to satisfy the accuracy tolerance.\n        # The formula is dz_crit = H * a_crit / (alpha * H).\n        dz_crit = H * a_crit / alpha_H\n        results.append(dz_crit)\n\n    # Final print statement in the exact required format.\n    # Format the floats to provide sufficient precision.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}