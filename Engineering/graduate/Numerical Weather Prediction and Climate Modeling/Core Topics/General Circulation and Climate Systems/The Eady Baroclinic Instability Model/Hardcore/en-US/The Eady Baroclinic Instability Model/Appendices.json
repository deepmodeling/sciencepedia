{
    "hands_on_practices": [
        {
            "introduction": "To understand the growth of mid-latitude weather systems, we must first determine the mathematical form that perturbations can take. This foundational practice  guides you through solving the vertical structure equation that governs disturbances in the Eady model. By applying the physical constraints at the model's top and bottom boundaries, you will establish the fundamental relationship between the wave's vertical shape and the properties of the background flow, laying the groundwork for discovering the conditions for instability.",
            "id": "4099840",
            "problem": "Consider the Eady baroclinic instability model under the Quasi-Geostrophic (QG) and Boussinesq approximations with constant Brunt-Väisälä frequency $N$, constant Coriolis parameter $f_0$, and a background zonal flow with uniform vertical shear $U(z)=\\Lambda z$ in a stably stratified layer bounded by rigid lids at $z=0$ and $z=H$. Assume a normal-mode perturbation streamfunction of the form $\\psi(x,y,z,t)=\\Re\\{\\hat{\\psi}(z)\\exp[i(kx+ly-\\omega t)]\\}$, where the complex phase speed is $c=\\omega/k$ and the horizontal wavenumber magnitude is $\\sqrt{k^2+l^2}0$. Working in a nondimensionalization consistent with the QG interior potential vorticity equation such that the vertical structure $\\hat{\\psi}(z)$ satisfies the ordinary differential equation $\\hat{\\psi}''(z)-\\alpha^2\\hat{\\psi}(z)=0$ for a given positive constant $\\alpha$, and enforcing physically standard Eady thermal boundary conditions at the rigid lids arising from the linearized thermodynamic equation and no-normal-flow at $z=0$ and $z=H$, proceed as follows:\n\n- Derive the general solution for the vertical structure $\\hat{\\psi}(z)$.\n- Using the appropriate Eady boundary conditions at $z=0$ and $z=H$, deduce the linear constraints linking the coefficients in the general solution.\n- From the lower boundary condition at $z=0$, obtain a closed-form analytic expression for the ratio $B/A$ in terms of the parameters $\\alpha$, $\\Lambda$, and $c$.\n\nYour final answer must be a single closed-form analytic expression for the dimensionless quantity $B/A$. No rounding is required. Do not include units in your final boxed expression.",
            "solution": "The problem asks for the derivation of an expression for the ratio of coefficients $B/A$ in the general solution for the vertical structure of a normal-mode perturbation in the Eady baroclinic instability model. The derivation proceeds in three main steps: finding the general solution to the governing ODE, establishing the boundary conditions, and applying the lower boundary condition to find the desired ratio.\n\nFirst, we are given the governing ordinary differential equation (ODE) for the vertical structure of the streamfunction perturbation, $\\hat{\\psi}(z)$:\n$$\n\\frac{d^2\\hat{\\psi}}{dz^2}(z) - \\alpha^2 \\hat{\\psi}(z) = 0\n$$\nThis is a second-order linear homogeneous ODE with constant coefficients, where $\\alpha$ is a given positive constant. The characteristic equation is $r^2 - \\alpha^2 = 0$, which has two distinct real roots $r_1 = \\alpha$ and $r_2 = -\\alpha$. The general solution can be expressed as a linear combination of exponential functions, $e^{\\alpha z}$ and $e^{-\\alpha z}$, or equivalently, as a linear combination of hyperbolic functions. For problems with boundary conditions specified at $z=0$, the hyperbolic form is often more convenient. The general solution is thus written as:\n$$\n\\hat{\\psi}(z) = A \\cosh(\\alpha z) + B \\sinh(\\alpha z)\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nSecond, we must establish the boundary conditions. The problem states that we should use the \"physically standard Eady thermal boundary conditions at the rigid lids\" at $z=0$ and $z=H$. A rigid lid implies that the vertical velocity $w$ is zero at the boundary. The linearized thermodynamic equation under the Quasi-Geostrophic (QG) and Boussinesq approximations is:\n$$\n\\left(\\frac{\\partial}{\\partial t} + U\\frac{\\partial}{\\partial x}\\right)\\frac{\\partial\\psi}{\\partial z} - \\frac{\\partial U}{\\partial z}\\frac{\\partial\\psi}{\\partial x} + \\frac{N^2}{f_0}w = 0\n$$\nSetting $w=0$ at the boundaries $z=0$ and $z=H$, we obtain the boundary condition on $\\psi$:\n$$\n\\left(\\frac{\\partial}{\\partial t} + U\\frac{\\partial}{\\partial x}\\right)\\frac{\\partial\\psi}{\\partial z} - \\frac{\\partial U}{\\partial z}\\frac{\\partial\\psi}{\\partial x} = 0\n$$\nWe substitute the normal-mode form of the perturbation, $\\psi(x, y, z, t) = \\Re\\{\\hat{\\psi}(z)\\exp[i(kx+ly-\\omega t)]\\}$, into this boundary condition. The partial derivatives become:\n$$\n\\frac{\\partial}{\\partial t} \\to -i\\omega, \\quad \\frac{\\partial}{\\partial x} \\to ik, \\quad \\frac{\\partial\\psi}{\\partial z} \\to \\frac{d\\hat{\\psi}}{dz}\n$$\nThe boundary condition in terms of the complex amplitude $\\hat{\\psi}(z)$ is:\n$$\n(-i\\omega + ikU(z))\\frac{d\\hat{\\psi}}{dz}(z) - ik\\frac{dU}{dz}\\hat{\\psi}(z) = 0\n$$\nDividing by $ik$ (assuming $k \\neq 0$) and using the definition of the complex phase speed, $c = \\omega/k$, we get:\n$$\n(U(z) - c)\\frac{d\\hat{\\psi}}{dz}(z) - \\frac{dU}{dz}\\hat{\\psi}(z) = 0\n$$\nWe are given the background zonal flow $U(z) = \\Lambda z$, for which the uniform vertical shear is $\\frac{dU}{dz} = \\Lambda$. The boundary condition at $z=0$ and $z=H$ thus becomes:\n$$\n(\\Lambda z - c)\\frac{d\\hat{\\psi}}{dz}(z) - \\Lambda\\hat{\\psi}(z) = 0\n$$\n\nThird, the problem requires us to use the lower boundary condition at $z=0$ to find the ratio $B/A$. We apply the derived boundary condition at $z=0$:\n$$\n(\\Lambda \\cdot 0 - c)\\frac{d\\hat{\\psi}}{dz}(0) - \\Lambda\\hat{\\psi}(0) = 0\n$$\nwhich simplifies to:\n$$\n-c\\frac{d\\hat{\\psi}}{dz}(0) - \\Lambda\\hat{\\psi}(0) = 0\n$$\nTo proceed, we need the values of $\\hat{\\psi}(z)$ and its derivative $\\frac{d\\hat{\\psi}}{dz}(z)$ at $z=0$. From our general solution $\\hat{\\psi}(z) = A \\cosh(\\alpha z) + B \\sinh(\\alpha z)$, we find its derivative:\n$$\n\\frac{d\\hat{\\psi}}{dz}(z) = \\alpha A \\sinh(\\alpha z) + \\alpha B \\cosh(\\alpha z)\n$$\nNow, we evaluate both $\\hat{\\psi}$ and its derivative at $z=0$:\n$$\n\\hat{\\psi}(0) = A \\cosh(0) + B \\sinh(0) = A \\cdot 1 + B \\cdot 0 = A\n$$\n$$\n\\frac{d\\hat{\\psi}}{dz}(0) = \\alpha A \\sinh(0) + \\alpha B \\cosh(0) = \\alpha A \\cdot 0 + \\alpha B \\cdot 1 = \\alpha B\n$$\nSubstituting these expressions for $\\hat{\\psi}(0)$ and $\\frac{d\\hat{\\psi}}{dz}(0)$ into the boundary condition equation:\n$$\n-c(\\alpha B) - \\Lambda(A) = 0\n$$\nThis equation establishes a linear constraint between the coefficients $A$ and $B$. To find the ratio $B/A$, we rearrange the terms. Assuming a non-trivial solution exists (i.e., $A \\neq 0$ and $c \\neq 0$), we can write:\n$$\n-\\alpha c B = \\Lambda A\n$$\n$$\n\\frac{B}{A} = -\\frac{\\Lambda}{\\alpha c}\n$$\nThis is the final closed-form analytic expression for the ratio $B/A$ in terms of the given parameters $\\Lambda$ and $\\alpha$, and the phase speed $c$. This quantity is dimensionless, as the units of $\\Lambda$ ($T^{-1}$), $\\alpha$ ($L^{-1}$), and $c$ ($L T^{-1}$) combine to make the ratio dimensionless.",
            "answer": "$$\n\\boxed{-\\frac{\\Lambda}{\\alpha c}}\n$$"
        },
        {
            "introduction": "A mathematical solution reveals *that* a wave can grow, but the underlying physics tells us *why*. This exercise  illuminates the elegant physical mechanism at the heart of the Eady model of baroclinic instability. By calculating the wave's intrinsic phase speed—its speed relative to the moving background flow—you will verify the \"counter-propagating\" wave condition, which is essential for the phase-locking and mutual amplification that drives storm development.",
            "id": "4099850",
            "problem": "Consider the Eady baroclinic instability model on an $f$-plane with constant Coriolis parameter $f_{0}$, constant Brunt–Väisälä frequency $N$, and a basic-state zonal wind with uniform vertical shear. The domain is bounded by rigid lids at $z=0$ (bottom) and $z=H$ (top), with $H=1.0\\times 10^{4}\\ \\mathrm{m}$, and the basic-state zonal wind is $U(z)=S\\,z$, where $S=\\partial U/\\partial z$ is constant and positive. Take $S=1.0\\times 10^{-3}\\ \\mathrm{s}^{-1}$ so that $U(0)=0$ and $U(H)=10\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$. A normal-mode analysis for a zonal wavenumber $k=1.6\\times 10^{-6}\\ \\mathrm{m}^{-1}$ yields a complex frequency whose real part defines a real phase speed $c=5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\n\nStarting from the foundational definition of phase speed and the kinematic effect of advection by a mean flow, derive the relationship between the observed phase speed and the intrinsic phase speed of a disturbance in a moving medium. Using this relationship, determine the Doppler-shifted intrinsic phase speeds at the top ($z=H$) and bottom ($z=0$) boundaries for the given $U(z)$ and the computed $c$. Then, verify whether the counter-propagating condition for Eady baroclinic instability is satisfied, namely that the intrinsic phase speeds at the two boundaries have opposite signs.\n\nExpress the two intrinsic phase speeds in meters per second, ordered as “top, bottom,” and round your numerical values to three significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of geophysical fluid dynamics, specifically the Eady model of baroclinic instability. The provided data are internally consistent, physically plausible for Earth's atmosphere, and sufficient for a unique solution. The problem is well-posed and objective.\n\nThe primary task is to determine the intrinsic phase speeds of a baroclinic wave at the top and bottom boundaries of the model domain and to verify the counter-propagating condition necessary for Eady instability.\n\nFirst, we establish the fundamental relationship between the observed phase speed of a wave and its intrinsic phase speed in a moving medium. A wave disturbance propagating in the zonal direction, $x$, can be represented by a form proportional to $\\exp(i(kx - \\omega t))$, where $k$ is the zonal wavenumber and $\\omega$ is the angular frequency observed in a stationary frame of reference. The phase of the wave is $\\phi(x, t) = kx - \\omega t$.\n\nThe observed phase speed, $c$, is the speed at which a point of constant phase propagates. By definition, this means $\\frac{d\\phi}{dt} = 0$. Following a point of constant phase, we have:\n$$ \\frac{d}{dt}(kx - \\omega t) = k \\frac{dx}{dt} - \\omega = 0 $$\nThe observed phase speed is therefore $c = \\frac{dx}{dt} = \\frac{\\omega}{k}$.\n\nNow, consider this wave superimposed on a basic-state zonal flow $U$. An observer moving with the fluid at speed $U$ would perceive the wave with a different frequency, known as the intrinsic frequency, $\\hat{\\omega}$. This frequency is Doppler-shifted by the motion of the medium. The relationship is derived by considering the wave's phase in a frame of reference moving with the flow, $x' = x - Ut$. Substituting $x = x' + Ut$ into the phase expression gives:\n$$ \\phi = k(x' + Ut) - \\omega t = kx' - (\\omega - kU)t $$\nIn this moving frame, the phase is $\\phi = kx' - \\hat{\\omega} t$, where the intrinsic frequency is:\n$$ \\hat{\\omega} = \\omega - kU $$\nThe phase speed as measured in this moving frame is the intrinsic phase speed, $c_i$. It is defined as:\n$$ c_i = \\frac{\\hat{\\omega}}{k} $$\nSubstituting the expression for $\\hat{\\omega}$, we obtain the desired relationship:\n$$ c_i = \\frac{\\omega - kU}{k} = \\frac{\\omega}{k} - U = c - U $$\nThis equation states that the intrinsic phase speed is the observed phase speed relative to the speed of the background flow. Since the background flow in this problem, $U(z)$, is a function of height, the intrinsic phase speed $c_i(z)$ is also a function of height.\n\nThe problem provides the following:\n- Basic-state zonal wind: $U(z) = S\\,z$\n- Constant vertical shear: $S = 1.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}$\n- Domain height: $H = 1.0 \\times 10^{4}\\ \\mathrm{m}$\n- Observed phase speed: $c = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n\nWe can now compute the intrinsic phase speeds at the bottom boundary ($z=0$) and the top boundary ($z=H$).\n\nAt the bottom boundary, $z=0$:\nThe basic-state wind speed is $U(0) = S \\times 0 = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\nThe intrinsic phase speed at the bottom is:\n$$ c_i(0) = c - U(0) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} - 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1} = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n\nAt the top boundary, $z=H$:\nThe basic-state wind speed is $U(H) = S \\times H$.\n$$ U(H) = (1.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}) \\times (1.0 \\times 10^{4}\\ \\mathrm{m}) = 10\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nThe intrinsic phase speed at the top is:\n$$ c_i(H) = c - U(H) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} - 10\\ \\mathrm{m}\\ \\mathrm{s}^{-1} = -5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n\nThe final step is to verify the counter-propagating condition for Eady baroclinic instability. This condition requires that the intrinsic phase speeds at the top and bottom boundaries have opposite signs, which allows for the phase-locking and mutual amplification of the boundary waves.\nWe have found:\n- $c_i(0) = 5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ (positive)\n- $c_i(H) = -5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ (negative)\n\nSince $\\text{sign}(c_i(H)) \\neq \\text{sign}(c_i(0))$, the counter-propagating condition is satisfied. This is consistent with the fact that the wave is unstable, as implied by the problem setup within the Eady model framework where the observed phase speed $c$ lies between the minimum and maximum values of the background flow, i.e., $U(0)  c  U(H)$.\n\nThe problem asks for the two intrinsic phase speeds, ordered as \"top, bottom\".\nIntrinsic phase speed at the top, $z=H$: $-5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\nIntrinsic phase speed at the bottom, $z=0$: $5.00\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -5.00  5.00 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While analytical models provide profound insight, modern atmospheric science relies on numerical methods to simulate the complexities of weather and climate. This practical exercise  bridges the gap between theory and computation. You are tasked with designing a finite-difference scheme to solve the Eady model's vertical structure equation numerically and deriving a criterion for the grid resolution required to obtain an accurate result, a core consideration in the development of any numerical weather prediction model.",
            "id": "4099855",
            "problem": "Consider the classical Eady baroclinic instability setup in quasigeostrophic dynamics on an $f$-plane with constant Brunt-Väisälä frequency $N$ and uniform vertical shear $U(z)=\\Lambda z$ over a fluid layer of finite depth $H$. For normal-mode disturbances proportional to $\\exp\\{i(kx+ly-\\omega t)\\}$ with horizontal wavenumber magnitude $K=\\sqrt{k^2+l^2}$, separation of variables in the quasigeostrophic potential vorticity leads to a vertical structure equation for a vertical envelope $G(z)$ of the form\n$$\n\\frac{d^2 G}{dz^2} - \\alpha^2 G = 0,\n$$\nwhere $\\alpha = \\frac{N}{f_0} K$ and $f_0$ is a constant reference Coriolis parameter. Rigid-lid boundaries and linearized buoyancy boundary conditions lead to Robin boundary conditions of the form\n$$\n\\left.\\frac{dG}{dz}\\right|_{z=0} = \\beta\\, G(0), \\qquad \\left.\\frac{dG}{dz}\\right|_{z=H} = -\\beta\\, G(H),\n$$\nwhere $\\beta$ is a real parameter that depends on the phase speed and shear (do not assume any explicit value of $\\beta$ a priori).\n\nYour tasks are:\n\n1. Starting from the above governing ordinary differential equation and boundary conditions, design a second-order finite-difference scheme in the vertical coordinate $z$ on a uniform grid $z_i = i\\,\\Delta z$ for $i=0,1,\\dots,N_z$ with $H = N_z \\Delta z$, that enforces the interior equation and the two Robin boundary conditions. The interior points must use a centered second derivative, and the boundary conditions must be approximated with consistent one-sided differences. Clearly specify the discrete equations at interior and boundary points in terms of $G_i \\approx G(z_i)$.\n\n2. To ensure numerical accuracy of the resolved vertical structure for modes with $\\alpha H \\sim \\mathcal{O}(1)$, derive a resolution criterion for $\\Delta z$ based on the relative error of the discrete second derivative operator when acting on the representative function $G(z) = e^{\\alpha z}$. For the centered second-difference approximation of $\\frac{d^2 G}{dz^2}$ at any interior point, define the relative error\n$$\n\\mathcal{R}(a) = \\frac{\\left[\\frac{G(z+\\Delta z) - 2G(z) + G(z-\\Delta z)}{\\Delta z^2}\\right]}{\\left[\\frac{d^2 G}{dz^2}\\right]} - 1, \\quad \\text{with } a=\\alpha \\Delta z,\n$$\nand impose an accuracy threshold $\\varepsilon$ such that $|\\mathcal{R}(a)| \\le \\varepsilon$ holds. Use this criterion to determine the minimum grid spacing $\\Delta z_{\\min}$ in meters needed to accurately capture modes with a prescribed $\\alpha H$ at the specified tolerance $\\varepsilon$.\n\n3. Implement a program that, for each test case below, computes and returns the minimum vertical grid spacing $\\Delta z_{\\min}$ in meters based on the resolution criterion in Task 2. The program does not need to solve the boundary value problem for $G(z)$; however, it must correctly compute $\\Delta z_{\\min}$ from the derived error criterion. Express all final answers in meters (m) as floating-point numbers.\n\nUse the following test suite, which explores distinct regimes of $\\alpha H$:\n\n- Test case 1 (typical $\\mathcal{O}(1)$ mode): H = 10000 m, $\\alpha H = 1.0$, $\\varepsilon = 0.05$.\n- Test case 2 (weakly varying vertical structure): H = 10000 m, $\\alpha H = 0.3$, $\\varepsilon = 0.05$.\n- Test case 3 (strongly varying vertical structure): H = 10000 m, $\\alpha H = 3.0$, $\\varepsilon = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above test cases (e.g., [$\\Delta z_1$, $\\Delta z_2$, $\\Delta z_3$]). The outputs must be floats representing $\\Delta z_{\\min}$ in meters.\n\nIn your derivation and scheme design, you must adhere to the following foundational bases without introducing shortcut formulas:\n- Quasigeostrophic potential vorticity and hydrostatic balance definitions, leading to separable vertical structure under uniform stratification $N$ and shear $U(z)$.\n- Consistent second-order accurate finite differences for interior and boundary derivatives on a uniform grid.\n- Explicit computation of the discrete second derivative error for exponential profiles to set the resolution requirement.\n\nNo external data are required. All symbols, variables, functions, operators, and numbers in the problem description must be written in LaTeX using $...$ for inline expressions or $$...$$ for display equations. Answer all numerical outputs in meters (m) and do not use percentage signs; specify tolerances as decimals. The angle unit is not required in this problem.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in quasigeostrophic theory, well-posed, and provides a complete and consistent set of definitions and parameters for all tasks.\n\n### Task 1: Finite-Difference Scheme Design\n\nThe objective is to discretize the governing ordinary differential equation (ODE) and its boundary conditions on a uniform vertical grid. The grid is defined by points $z_i = i\\,\\Delta z$ for $i=0, 1, \\dots, N_z$, where $\\Delta z = H/N_z$ is the grid spacing. The discrete approximation of the function $G(z)$ at these points is denoted by $G_i \\equiv G(z_i)$.\n\n**Interior Points**\nFor the interior grid points, $i = 1, 2, \\dots, N_z-1$, the governing ODE is\n$$\n\\frac{d^2 G}{dz^2} - \\alpha^2 G = 0\n$$\nWe employ a second-order accurate centered finite-difference approximation for the second derivative:\n$$\n\\left.\\frac{d^2 G}{dz^2}\\right|_{z_i} \\approx \\frac{G(z_i+\\Delta z) - 2G(z_i) + G(z_i-\\Delta z)}{\\Delta z^2} = \\frac{G_{i+1} - 2G_i + G_{i-1}}{\\Delta z^2}\n$$\nSubstituting this into the ODE gives the discrete equation for the interior points:\n$$\n\\frac{G_{i+1} - 2G_i + G_{i-1}}{\\Delta z^2} - \\alpha^2 G_i = 0\n$$\nThis can be rearranged into a three-point stencil relation:\n$$\nG_{i+1} - \\left(2 + (\\alpha \\Delta z)^2\\right)G_i + G_{i-1} = 0, \\quad \\text{for } i = 1, \\dots, N_z-1\n$$\n\n**Boundary Conditions**\nThe problem specifies Robin boundary conditions at $z=0$ and $z=H$. These must be approximated using one-sided differences that are consistent with the second-order accuracy of the interior scheme. We use second-order accurate one-sided finite differences for the first derivative.\n\n**At the lower boundary, $z=0$ (i=0):**\nThe boundary condition is $\\left.\\frac{dG}{dz}\\right|_{z=0} = \\beta\\, G(0)$.\nThe second-order forward difference approximation for the first derivative at $z_0$ is:\n$$\n\\left.\\frac{dG}{dz}\\right|_{z_0} \\approx \\frac{-3G(z_0) + 4G(z_1) - G(z_2)}{2\\Delta z} = \\frac{-3G_0 + 4G_1 - G_2}{2\\Delta z}\n$$\nEquating this to the boundary condition gives the discrete equation at $i=0$:\n$$\n\\frac{-3G_0 + 4G_1 - G_2}{2\\Delta z} = \\beta G_0\n$$\nRearranging yields:\n$$\n(-3 - 2\\beta\\Delta z)G_0 + 4G_1 - G_2 = 0\n$$\n\n**At the upper boundary, $z=H$ (i=$N_z$):**\nThe boundary condition is $\\left.\\frac{dG}{dz}\\right|_{z=H} = -\\beta\\, G(H)$.\nThe second-order backward difference approximation for the first derivative at $z_{N_z}$ is:\n$$\n\\left.\\frac{dG}{dz}\\right|_{z_{N_z}} \\approx \\frac{3G(z_{N_z}) - 4G(z_{N_z-1}) + G(z_{N_z-2})}{2\\Delta z} = \\frac{3G_{N_z} - 4G_{N_z-1} + G_{N_z-2}}{2\\Delta z}\n$$\nEquating this to the boundary condition gives the discrete equation at $i=N_z$:\n$$\n\\frac{3G_{N_z} - 4G_{N_z-1} + G_{N_z-2}}{2\\Delta z} = -\\beta G_{N_z}\n$$\nRearranging yields:\n$$\nG_{N_z-2} - 4G_{N_z-1} + (3 + 2\\beta\\Delta z)G_{N_z} = 0\n$$\nTogether, these equations for $i=0, \\dots, N_z$ form a complete system of $N_z+1$ linear equations for the unknowns $G_0, \\dots, G_{N_z}$.\n\n### Task 2: Resolution Criterion Derivation\n\nThe goal is to establish a criterion for the grid spacing $\\Delta z$ that ensures the numerical error of the second derivative operator remains below a specified tolerance $\\varepsilon$. The analysis is based on the representative function $G(z) = e^{\\alpha z}$, which is a solution to the governing ODE.\n\nThe relative error $\\mathcal{R}$ is defined as:\n$$\n\\mathcal{R}(a) = \\frac{\\left[\\text{Discrete } \\frac{d^2G}{dz^2}\\right]}{\\left[\\text{Exact } \\frac{d^2G}{dz^2}\\right]} - 1, \\quad \\text{with } a = \\alpha \\Delta z\n$$\nFirst, we compute the exact second derivative of $G(z) = e^{\\alpha z}$:\n$$\n\\frac{d^2 G}{dz^2} = \\alpha^2 e^{\\alpha z}\n$$\nNext, we apply the centered second-difference operator to $G(z)$:\n$$\n\\frac{G(z+\\Delta z) - 2G(z) + G(z-\\Delta z)}{\\Delta z^2} = \\frac{e^{\\alpha(z+\\Delta z)} - 2e^{\\alpha z} + e^{\\alpha(z-\\Delta z)}}{\\Delta z^2}\n$$\nFactoring out $e^{\\alpha z}$:\n$$\n= \\frac{e^{\\alpha z} \\left(e^{\\alpha \\Delta z} - 2 + e^{-\\alpha \\Delta z}\\right)}{\\Delta z^2}\n$$\nUsing the identity $\\cosh(x) = \\frac{e^x+e^{-x}}{2}$, the term in the parentheses becomes $2\\cosh(\\alpha \\Delta z) - 2$.\n$$\n= \\frac{2e^{\\alpha z} \\left(\\cosh(\\alpha \\Delta z) - 1\\right)}{\\Delta z^2}\n$$\nNow, we substitute these expressions into the relative error definition:\n$$\n\\mathcal{R}(a) = \\frac{\\left[ \\frac{2e^{\\alpha z} (\\cosh(\\alpha \\Delta z) - 1)}{\\Delta z^2} \\right]}{\\alpha^2 e^{\\alpha z}} - 1\n$$\nThe $e^{\\alpha z}$ terms cancel, and substituting $a = \\alpha\\Delta z$, we obtain an expression for $\\mathcal{R}$ that depends only on the non-dimensional parameter $a$:\n$$\n\\mathcal{R}(a) = \\frac{2(\\cosh(a) - 1)}{a^2} - 1\n$$\nThe accuracy requirement is $|\\mathcal{R}(a)| \\le \\varepsilon$.\nTo analyze $\\mathcal{R}(a)$, we use the Taylor series expansion of $\\cosh(a)$ for small $a$:\n$$\n\\cosh(a) = 1 + \\frac{a^2}{2!} + \\frac{a^4}{4!} + \\mathcal{O}(a^6)\n$$\nSubstituting this into the expression for $\\mathcal{R}(a)$:\n$$\n\\mathcal{R}(a) = \\frac{2\\left( (1 + \\frac{a^2}{2} + \\frac{a^4}{24} + \\dots) - 1 \\right)}{a^2} - 1 = \\frac{a^2 + \\frac{a^4}{12} + \\dots}{a^2} - 1 = \\frac{a^2}{12} + \\frac{a^4}{360} + \\dots\n$$\nSince all terms in the series are positive for $a \\neq 0$, $\\mathcal{R}(a)  0$. The condition $|\\mathcal{R}(a)| \\le \\varepsilon$ simplifies to $\\mathcal{R}(a) \\le \\varepsilon$:\n$$\n\\frac{2(\\cosh(a) - 1)}{a^2} - 1 \\le \\varepsilon\n$$\nThis inequality defines an upper bound for $a$. Let $a_{\\text{crit}}$ be the value of $a0$ that satisfies the equality:\n$$\n\\frac{2(\\cosh(a_{\\text{crit}}) - 1)}{a_{\\text{crit}}^2} - 1 = \\varepsilon\n$$\nThis is a transcendental equation for $a_{\\text{crit}}$ that must be solved numerically for a given $\\varepsilon$. Any $a \\le a_{\\text{crit}}$ will satisfy the accuracy requirement.\nSince $a = \\alpha \\Delta z$, the resolution criterion becomes $\\alpha \\Delta z \\le a_{\\text{crit}}$, which implies:\n$$\n\\Delta z \\le \\frac{a_{\\text{crit}}}{\\alpha}\n$$\nThis inequality provides the maximum allowable grid spacing, $\\Delta z_{\\max}$, to achieve the desired accuracy. The problem statement refers to a \"minimum grid spacing $\\Delta z_{\\min}$\". This is interpreted as imprecise language for the coarsest possible grid, which corresponds to the maximum allowable grid spacing, $\\Delta z_{\\max}$. We will calculate this critical value. Using the given parameters $\\alpha H$ and $H$, we find $\\alpha = (\\alpha H)/H$. Thus, the critical grid spacing is:\n$$\n\\Delta z_{\\text{crit}} = \\frac{a_{\\text{crit}}}{\\alpha} = \\frac{a_{\\text{crit}}}{(\\alpha H)/H} = H \\frac{a_{\\text{crit}}}{\\alpha H}\n$$\n\n### Task 3: Computation of Critical Grid Spacing\n\nThe procedure to compute the critical grid spacing for each test case is as follows:\n1.  For the given tolerance $\\varepsilon$, numerically solve the equation $\\frac{2(\\cosh(a) - 1)}{a^2} - (1+\\varepsilon) = 0$ to find the single positive root $a_{\\text{crit}}$. This is done once as $\\varepsilon$ is constant for all test cases.\n2.  For each test case, use its specific values of $H$ and $\\alpha H$.\n3.  Calculate the critical grid spacing using the formula $\\Delta z_{\\text{crit}} = H \\frac{a_{\\text{crit}}}{\\alpha H}$.\n\nFor $\\varepsilon = 0.05$, we solve for $a_{\\text{crit}}$:\n$$\n\\frac{2(\\cosh(a_{\\text{crit}}) - 1)}{a_{\\text{crit}}^2} = 1.05\n$$\nA numerical root-finding algorithm (such as Brent's method) yields $a_{\\text{crit}} \\approx 0.77158793$. This value is then used to compute the required grid spacing for each case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve_for_a_crit(epsilon: float) - float:\n    \"\"\"\n    Solves the transcendental equation for the critical non-dimensional grid spacing 'a'.\n\n    The equation arises from the relative error criterion for the finite difference\n    approximation of the second derivative of an exponential function.\n    The equation is R(a) = epsilon, where R(a) = 2*(cosh(a)-1)/a^2 - 1.\n\n    Args:\n        epsilon: The desired relative error tolerance.\n\n    Returns:\n        The critical value a_crit  0 such that R(a_crit) = epsilon.\n    \"\"\"\n    # Define the function whose root we want to find: f(a) = R(a) - epsilon = 0.\n    def f(a):\n        # To avoid division by zero and loss of precision for small 'a',\n        # we can use the Taylor series expansion.\n        # R(a) = a^2/12 + a^4/360 + ...\n        # f(a) = a^2/12 + a^4/360 + ... - epsilon\n        if np.abs(a)  1e-8:\n            return -epsilon\n        return 2 * (np.cosh(a) - 1) / a**2 - (1 + epsilon)\n\n    # We need to find a bracketing interval [x0, x1] for the root.\n    # For small 'a', R(a) is approx a^2/12. So a_crit is approx sqrt(12 * epsilon).\n    # For epsilon=0.05, a_crit is approx sqrt(0.6) ~= 0.77.\n    # Let's choose a bracket safely around this estimate, e.g., [0.1, 2.0].\n    # f(0.1) should be negative and f(2.0) should be positive for epsilon=0.05.\n    try:\n        # Use Brent's method for robust and fast root finding.\n        sol = root_scalar(f, bracket=[1e-6, 2.0], method='brentq')\n        if sol.converged:\n            return sol.root\n        else:\n            raise RuntimeError(\"Root-finding algorithm did not converge.\")\n    except ValueError:\n        # This might happen if the bracket is not valid (f(x0)*f(x1)  0).\n        raise ValueError(\"The root is not bracketed. Adjust the bracket interval.\")\n\n\ndef solve():\n    \"\"\"\n    Main function to calculate the critical vertical grid spacing for the given\n    test cases based on the Eady model resolution criterion.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (H in meters, dimensionless alpha*H, tolerance epsilon)\n    test_cases = [\n        (10000.0, 1.0, 0.05),  # Test case 1\n        (10000.0, 0.3, 0.05),  # Test case 2\n        (10000.0, 3.0, 0.05),  # Test case 3\n    ]\n\n    results = []\n    \n    # Since epsilon is the same for all test cases, we calculate a_crit only once.\n    epsilon = test_cases[0][2]\n    a_crit = solve_for_a_crit(epsilon)\n\n    for case in test_cases:\n        H, alpha_H, _ = case\n        \n        # The derivation provides a maximum allowable grid spacing (dz_max or dz_crit)\n        # to satisfy the accuracy tolerance. The problem text refers to this as\n        # \"minimum grid spacing\", which is interpreted as the coarsest allowable grid.\n        # The formula is dz_crit = H * a_crit / (alpha * H).\n        dz_crit = H * a_crit / alpha_H\n        results.append(dz_crit)\n\n    # Final print statement in the exact required format.\n    # Format the floats to provide sufficient precision.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}