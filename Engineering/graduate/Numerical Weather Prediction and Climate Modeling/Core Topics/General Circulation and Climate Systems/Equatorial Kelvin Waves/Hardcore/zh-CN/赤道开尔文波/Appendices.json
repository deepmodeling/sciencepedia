{
    "hands_on_practices": [
        {
            "introduction": "赤道开尔文波的一个决定性特征是它被束缚在赤道附近。本练习将引导你从浅水方程出发，推导开尔文波的经向结构，揭示其能量为何集中在赤道附近 。掌握这一推导对于理解热带波导的动力学基础以及开尔文波在气候系统中的独特作用至关重要。",
            "id": "4039438",
            "problem": "在数值天气预报（NWP）和气候模拟的背景下，考虑赤道β平面上的线性化无粘性浅水方程（SWE），其中科里奥利参数近似为 $f(y) = \\beta y$。对于平均深度为 $H$ 的流体，纬向速度 $u$、经向速度 $v$ 和自由面高度 $\\eta$ 的扰动 $(u,v,\\eta)$ 所满足的线性化浅水方程为：\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0,\n$$\n其中 $f = \\beta y$， $g$ 为恒定的重力加速度。假设一个纬向传播的赤道开尔文波解，其特征为经向速度 $v=0$ 消失，并且在 $x$ 和 $t$ 方向上具有 $\\exp\\!\\left[i(k x - \\omega t)\\right]$ 形式的可分离简正模依赖性，同时允许经向结构随 $y$ 变化。\n\n仅从这些方程和假设出发，推导控制开尔文波高度场 $\\eta(y)$ 的经向包络的常微分方程，并证明其具有高斯形式，其特征经向尺度取决于相速 $c$ 和科里奥利参数的经向梯度 $\\beta$。将 e-折半衰减宽度 $y_{e}$ 定义为波幅相对于其赤道值减小 $\\exp(-1)$ 倍时，离赤道的正经向距离，并用 $c$ 和 $\\beta$ 表示 $y_{e}$。\n\n然后，对于 $c = 30\\ \\mathrm{m\\ s^{-1}}$ 和 $\\beta = 2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}$，计算 $y_{e}$ 的数值。将最终数值答案以千米为单位表示，并四舍五入到四位有效数字。此外，使用地球半径 $a = 6.371 \\times 10^{6}\\ \\mathrm{m}$，简要解释你的 $y_{e}$ 所隐含的陷获纬度范围，但请注意，最终答案只需要以千米为单位的e-折半衰减宽度。",
            "solution": "本问题要求从赤道β平面上的线性化浅水方程（SWE）出发，推导赤道开尔文波的经向结构。给定的方程是：\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y} \\quad (2)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0 \\quad (3)\n$$\n这里，$u$ 是纬向速度，$v$ 是经向速度，$\\eta$ 是自由面高度扰动，$g$ 是重力加速度，$H$ 是平均流体深度。科里奥利参数近似为 $f(y) = \\beta y$，其中 $\\beta$ 是赤道处科里奥利参数的恒定经向梯度，$y$ 是离赤道的经向距离。\n\n我们要寻找赤道开尔文波的解。该波的定义特征是经向速度消失（$v=0$）和纬向传播的波结构。我们假设解的形式为：\n$$\nu(x, y, t) = \\hat{u}(y) \\exp[i(kx - \\omega t)]\n$$\n$$\nv(x, y, t) = 0\n$$\n$$\n\\eta(x, y, t) = \\hat{\\eta}(y) \\exp[i(kx - \\omega t)]\n$$\n其中 $k$ 是纬向波数，$\\omega$ 是角频率。函数 $\\hat{u}(y)$ 和 $\\hat{\\eta}(y)$ 代表波的经向包络。\n\n将这些形式和条件 $v=0$ 代入浅水方程，得到一个简化的方程组。对 $t$ 和 $x$ 的偏导数分别变为乘以 $-i\\omega$ 和 $ik$。对 $y$ 的偏导数变为常导数 $\\frac{d}{dy}$。\n\n从纬向动量方程（1）可得：\n$$\n(-i\\omega) \\hat{u}(y) - (\\beta y)(0) = -g (ik) \\hat{\\eta}(y)\n$$\n$$\n-i\\omega \\hat{u} = -igk \\hat{\\eta}\n$$\n$$\n\\omega \\hat{u} = gk \\hat{\\eta} \\quad (4)\n$$\n从经向动量方程（2）可得：\n$$\n(-i\\omega)(0) + (\\beta y) \\hat{u}(y) = -g \\frac{d\\hat{\\eta}}{dy}\n$$\n$$\n\\beta y \\hat{u} = -g \\frac{d\\hat{\\eta}}{dy} \\quad (5)\n$$\n该方程表示经向的地转平衡，其中作用在纬向流上的科里奥利力与经向压力梯度相平衡。这是开尔文波的一个关键特征。\n\n从连续性方程（3）可得：\n$$\n(-i\\omega) \\hat{\\eta}(y) + H\\left( (ik) \\hat{u}(y) + \\frac{\\partial(0)}{\\partial y} \\right) = 0\n$$\n$$\n-i\\omega \\hat{\\eta} = -iHk \\hat{u}\n$$\n$$\n\\omega \\hat{\\eta} = Hk \\hat{u} \\quad (6)\n$$\n波的相速为 $c = \\omega/k$。从方程（4），我们可以写出 $\\hat{u} = (gk/\\omega)\\hat{\\eta} = (g/c)\\hat{\\eta}$。将此代入方程（6）得到 $\\omega \\hat{\\eta} = Hk (g/c)\\hat{\\eta}$，简化为 $\\omega = Hgk/c$。由于 $c=\\omega/k$，这变为 $c^2 = gH$。这证实了赤道开尔文波是以速度 $c = \\sqrt{gH}$ 传播的非频散重力波。\n\n现在，我们推导经向高度结构 $\\hat{\\eta}(y)$ 的常微分方程（ODE）。我们使用方程（4）和（5）。从（4）中，我们用 $\\hat{\\eta}$ 表示 $\\hat{u}$：\n$$\n\\hat{u} = \\frac{gk}{\\omega} \\hat{\\eta} = \\frac{g}{c} \\hat{\\eta}\n$$\n将 $\\hat{u}$ 的这个表达式代入经向动量平衡方程（5）：\n$$\n\\beta y \\left(\\frac{g}{c} \\hat{\\eta}\\right) = -g \\frac{d\\hat{\\eta}}{dy}\n$$\n两边的因子 $g$ 消去，得到：\n$$\n\\frac{\\beta y}{c} \\hat{\\eta} = - \\frac{d\\hat{\\eta}}{dy}\n$$\n整理后得到关于 $\\hat{\\eta}(y)$ 的一阶线性齐次常微分方程：\n$$\n\\frac{d\\hat{\\eta}}{dy} + \\frac{\\beta}{c} y \\hat{\\eta} = 0\n$$\n这个方程控制着波高场的经向包络。为求解该方程，我们可以分离变量：\n$$\n\\frac{d\\hat{\\eta}}{\\hat{\\eta}} = - \\frac{\\beta}{c} y dy\n$$\n对两边从 $0$ 到 $y$ 积分：\n$$\n\\int_{\\hat{\\eta}(0)}^{\\hat{\\eta}(y)} \\frac{d\\hat{\\eta}'}{\\hat{\\eta}'} = -\\int_0^y \\frac{\\beta}{c} y' dy'\n$$\n$$\n\\ln\\left(\\frac{\\hat{\\eta}(y)}{\\hat{\\eta}(0)}\\right) = - \\frac{\\beta}{2c} y^2\n$$\n对两边取指数，得到 $\\hat{\\eta}(y)$ 的解：\n$$\n\\hat{\\eta}(y) = \\hat{\\eta}(0) \\exp\\left(-\\frac{\\beta y^2}{2c}\\right)\n$$\n该解是一个以赤道（$y=0$）为中心的高斯函数，证实了所要求的形式。因此，波被“陷获”在赤道，其振幅随着离开 $y=0$ 的距离呈指数衰减。特征经向尺度明显取决于 $c$ 和 $\\beta$。\n\ne-折半衰减宽度 $y_e$ 定义为波幅 $\\hat{\\eta}(y)$ 相对于其在赤道的最大值 $\\hat{\\eta}(0)$ 减小 $\\exp(-1)$ 倍时的正经向距离 $y$。我们设：\n$$\n\\frac{\\hat{\\eta}(y_e)}{\\hat{\\eta}(0)} = \\exp(-1)\n$$\n使用我们的解：\n$$\n\\exp\\left(-\\frac{\\beta y_e^2}{2c}\\right) = \\exp(-1)\n$$\n对两边取自然对数，得到：\n$$\n\\frac{\\beta y_e^2}{2c} = 1\n$$\n求解 $y_e^2$：\n$$\ny_e^2 = \\frac{2c}{\\beta}\n$$\n取正平方根，得到e-折半衰减宽度的表达式：\n$$\ny_e = \\sqrt{\\frac{2c}{\\beta}}\n$$\n\n现在，我们使用给定的常数计算 $y_e$ 的数值：$c = 30\\ \\mathrm{m\\ s^{-1}}$ 和 $\\beta = 2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}$。\n$$\ny_e = \\sqrt{\\frac{2 \\times 30\\ \\mathrm{m\\ s^{-1}}}{2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}}} = \\sqrt{\\frac{60}{2.3 \\times 10^{-11}}}\\ \\mathrm{m}\n$$\n$$\ny_e = \\sqrt{2.60869565... \\times 10^{12}}\\ \\mathrm{m} \\approx 1.6151457 \\times 10^6\\ \\mathrm{m}\n$$\n为了以千米表示，我们除以 $1000$：\n$$\ny_e \\approx 1615.1457\\ \\mathrm{km}\n$$\n将答案四舍五入到四位有效数字，得到：\n$$\ny_e \\approx 1615\\ \\mathrm{km}\n$$\n\n为了解释，我们可以估计与此经向距离相对应的纬度。使用地球半径 $a = 6.371 \\times 10^6\\ \\mathrm{m}$ 和小角度近似 $y \\approx a\\phi$（其中 $\\phi$ 是以弧度为单位的纬度），e-折衰减纬度 $\\phi_e$ 为：\n$$\n\\phi_e = \\frac{y_e}{a} \\approx \\frac{1.615 \\times 10^6\\ \\mathrm{m}}{6.371 \\times 10^6\\ \\mathrm{m}} \\approx 0.2535\\ \\mathrm{rad}\n$$\n转换为度：\n$$\n\\phi_e \\approx 0.2535 \\times \\frac{180}{\\pi} \\approx 14.5^\\circ\n$$\n这个结果表明，赤道开尔文波被强烈地陷获在赤道南北约 $\\pm 14.5^\\circ$ 的范围内。在此纬度，其振幅衰减至其峰值的大约 $37\\%$，将其大部分能量限制在深热带地区。",
            "answer": "$$\\boxed{1615}$$"
        },
        {
            "introduction": "在真实大气和海洋中，波动会因摩擦和热力过程而衰减。本练习在理论模型中引入线性阻尼，探讨它如何影响赤道开尔文波的传播。通过计算e折衰减长度，你将能定量评估开尔文波在穿越整个洋盆时维持其信号强度的能力，这直接关系到其在数值天气预报和气候模型中的可预报性 。",
            "id": "4039414",
            "problem": "考虑在$\\beta$平面上的浅水框架下的线性赤道动力学，其中重力$g$为常数，等效深度$H$代表热带大气中的第一斜压模态。设$(u,v)$分别为纬向和经向速度，$h$为高度扰动（与整层大气质量或位势成正比）。假设线性阻尼以速率$\\mu$均匀地作用于动量场和质量场，其形式为瑞利摩擦和牛顿冷却的组合。控制的线性化方程组为\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y\\, v \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial x} \\;-\\; \\mu\\,u,\n$$\n$$\n\\frac{\\partial v}{\\partial t} + \\beta y\\, u \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial y} \\;-\\; \\mu\\,v,\n$$\n$$\n\\frac{\\partial h}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; -\\,\\mu\\,h.\n$$\n重点关注赤道开尔文波，其特征为经向速度在主阶上为零（$v=0$），并且在$y=0$附近约束向东传播。从这些方程和第一性原理出发，推导在所述阻尼作用下赤道开尔文波的复频散关系，并由此得到沿赤道的空间e-折衰减长度。然后，使用$g=9.81~\\mathrm{m~s^{-2}}$，$H=25~\\mathrm{m}$和$\\mu=2.0\\times 10^{-6}~\\mathrm{s^{-1}}$数值计算该衰减长度。将最终数值结果以公里为单位表示，并四舍五入至三位有效数字。此外，解释计算出的衰减长度对于数值天气预报（NWP）和气候模式分析中赤道开尔文波的可探测性和可预报性的观测意义。",
            "solution": "我们从赤道$\\beta$平面上带有线性阻尼（速率为$\\mu$）的线性化浅水方程开始：\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) u - \\beta y\\, v \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial x}\n$$\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) v + \\beta y\\, u \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial y}\n$$\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) h + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; 0\n$$\n赤道开尔文波由经向速度为零的条件定义，即$v=0$。将此条件应用于方程组可大大简化它们。经向动量方程不会消失，而是成为一个诊断关系，而纬向动量方程和连续性方程则为纬向速度$u$和高度扰动$h$构成一个封闭系统。\n\n当$v=0$时，系统变为：\n1. 纬向动量：$\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) u = -g \\frac{\\partial h}{\\partial x}$\n2. 经向动量（地转平衡）：$\\beta y u = -g \\frac{\\partial h}{\\partial y}$\n3. 连续性：$\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) h = -H \\frac{\\partial u}{\\partial x}$\n\n我们寻找沿纬向传播并被限制在赤道附近的波动解。我们假设解的形式为：\n$$\nu(x,y,t) = \\hat{u}(y) \\exp[i(kx - \\omega t)]\n$$\n$$\nh(x,y,t) = \\hat{h}(y) \\exp[i(kx - \\omega t)]\n$$\n这里，$\\omega$是实值的波频率，$k$是复值的纬向波数，$k = k_r + i k_i$。虚部$k_i$将表征波的空间衰减。将这些形式代入简化后的方程(1)和(3)，得到关于波振幅$\\hat{u}$和$\\hat{h}$的代数方程组：\n$$\n(-i\\omega + \\mu) \\hat{u} = -g(ik) \\hat{h}\n$$\n$$\n(-i\\omega + \\mu) \\hat{h} = -H(ik) \\hat{u}\n$$\n将这两个方程相乘得到：\n$$\n(-i\\omega + \\mu)^2 \\hat{u} \\hat{h} = (-g(ik))(-H(ik)) \\hat{u} \\hat{h}\n$$\n对于非平凡波（$\\hat{u}\\hat{h} \\neq 0$），我们可以除以$\\hat{u}\\hat{h}$来求得频散关系：\n$$\n(-i\\omega + \\mu)^2 = (ik)^2 gH = -k^2 gH\n$$\n我们定义浅水重力波速$c = \\sqrt{gH}$。方程变为：\n$$\n-k^2 c^2 = (-i\\omega + \\mu)^2 = (-(i\\omega - \\mu))^2 = (i\\omega - \\mu)^2\n$$\n$$\nk^2 c^2 = -(i\\omega - \\mu)^2 = -(-\\omega^2 - 2i\\omega\\mu + \\mu^2) = \\omega^2 + 2i\\omega\\mu - \\mu^2 = (\\omega + i\\mu)^2\n$$\n对两边取平方根，得到$k$的两种可能解：\n$$\nkc = \\pm(\\omega + i\\mu) \\implies k = \\pm \\frac{\\omega + i\\mu}{c}\n$$\n我们必须选择物理上合适的解。问题指定了向东传播的波。波数的实部是$k_r = \\text{Re}(k)$，相速度是$c_p = \\omega / k_r$。对于向东传播，我们需要$c_p > 0$，这意味着$k_r > 0$（对于$\\omega > 0$）。\n让我们检查这两个解：\n- 解1：$k = \\frac{\\omega + i\\mu}{c} = \\frac{\\omega}{c} + i\\frac{\\mu}{c}$。这里，$k_r = \\omega/c > 0$，给出向东的相速度$c_p = c$。虚部是$k_i = \\mu/c > 0$。波振幅的空间依赖性是$\\exp(-k_i x) = \\exp(-(\\mu/c)x)$，这描述了波在正$x$方向（向东）传播时衰减。对于在西部生成并向东传播的波，这是物理上正确的解。\n- 解2：$k = -\\frac{\\omega + i\\mu}{c} = -\\frac{\\omega}{c} - i\\frac{\\mu}{c}$。这里，$k_r = -\\omega/c  0$，对应于向西的相速度$c_p = -c$。这不是一个向东传播的开尔文波。\n\n因此，对于有阻尼的、向东传播的赤道开尔文波，其复频散关系为：\n$$\nk(\\omega) = \\frac{\\omega + i\\mu}{\\sqrt{gH}}\n$$\n波数的虚部是$k_i = \\text{Im}(k) = \\frac{\\mu}{\\sqrt{gH}}$。空间e-折衰减长度$L_d$是波的振幅减小到$1/e$倍所经过的距离。它由$k_i L_d = 1$定义。因此，衰减长度是：\n$$\nL_d = \\frac{1}{k_i} = \\frac{\\sqrt{gH}}{\\mu}\n$$\n这个表达式表明，衰减长度与波的内禀相速度$c=\\sqrt{gH}$成正比，与阻尼率$\\mu$成反比。\n\n为了确认解的一致性，我们检查经向动量平衡，即方程(2)。从简化的代数方程中，我们可以找到$\\hat{u}$和$\\hat{h}$之间的关系：$\\hat{u} = \\frac{ikg}{-i\\omega+\\mu}\\hat{h}$。使用频散关系$kc = \\omega+i\\mu$，我们有$ikc = i\\omega - \\mu$，所以$\\hat{u} = \\frac{ikg}{ikc}\\hat{h} = \\frac{g}{c}\\hat{h}$。将此代入方程(2)得到：\n$$\n\\beta y \\left(\\frac{g}{c}\\hat{h}\\right) = -g \\frac{d\\hat{h}}{dy} \\implies \\frac{d\\hat{h}}{\\hat{h}} = -\\frac{\\beta y}{c} dy\n$$\n积分得到$\\hat{h}(y) = \\hat{h}_0 \\exp\\left(-\\frac{\\beta y^2}{2c}\\right)$，这是一个高斯分布剖面，随着离开赤道（$y=0$）而衰减。这证实了波的赤道陷获特性，与开尔文波的结构一致。\n\n现在，我们用给定的参数数值计算衰减长度：$g=9.81~\\mathrm{m~s^{-2}}$，$H=25~\\mathrm{m}$，和$\\mu=2.0\\times 10^{-6}~\\mathrm{s^{-1}}$。\n首先，我们计算浅水波速$c$：\n$$\nc = \\sqrt{gH} = \\sqrt{(9.81~\\mathrm{m~s^{-2}})(25~\\mathrm{m})} = \\sqrt{245.25~\\mathrm{m^2~s^{-2}}} \\approx 15.66046~\\mathrm{m~s^{-1}}\n$$\n接下来，我们计算衰减长度$L_d$：\n$$\nL_d = \\frac{c}{\\mu} = \\frac{15.66046~\\mathrm{m~s^{-1}}}{2.0\\times 10^{-6}~\\mathrm{s^{-1}}} \\approx 7.83023 \\times 10^6~\\mathrm{m}\n$$\n问题要求结果以公里为单位，并四舍五入到三位有效数字。\n$$\nL_d = 7.83023 \\times 10^3~\\mathrm{km} \\approx 7830~\\mathrm{km}\n$$\n\n这个衰减长度的观测意义对气象学和气候科学非常重要。大约$7830~\\mathrm{km}$的衰减长度占地球赤道周长（约$40,075~\\mathrm{km}$）的很大一部分。这意味着赤道开尔文波可以传播几乎整个太平洋的宽度，同时保持其振幅的很大一部分。这种大尺度的相干性具有深远的影响：\n- **可探测性**：开尔文波在其生成地数千公里之外的观测数据（例如，卫星测量的海面高度或出射长波辐射）中很容易被探测到。当它们穿越整个洋盆时，其稳健的结构可以被追踪。\n- **可预报性**：长的衰减长度，加上其可预测的向东传播速度（$c \\approx 16~\\mathrm{m~s^{-1}}$），使开尔文波成为热带地区次季节时间尺度（例如10到30天）大气可预报性的主要来源。一个能准确捕捉开尔文波生成（例如，与印度洋或西太平洋的对流爆发相关）的模式，可以提前多天预报其对下游天气的影响，例如东太平洋和美洲的降水模式和风场转变。Madden-Julian振荡（MJO）是热带季节内变率最主要的模态，它有一个显著的赤道开尔文波分量，其可预报性与该波生命周期的正确表征紧密相关。\n- **模式验证**：数值天气预报（NWP）或气候模式再现观测到的开尔文波传播和衰减特征的能力，是衡量模式保真度的关键基准。模式中过度的数值耗散或参数化的物理阻尼（例如，对流、辐射）不准确，会导致衰减长度过短，从而损害模式捕捉大尺度热带遥相关和降低其预报技巧的能力。因此，如此处计算的理论估计值为模式开发者提供了一个重要的物理目标。",
            "answer": "$$\n\\boxed{7830}\n$$"
        },
        {
            "introduction": "理论模型为我们提供了开尔文波的理想结构，但在实际的观测或模型数据中，如何识别并量化其强度呢？本练习将通过一个编程实践来回答这个问题，你将学习使用投影技术，将一个任意的初始地球物理场分解到开尔文波基函数上 。这不仅是一项重要的计算技能，也是在气候数据分析和模型初始化中分离和研究特定波动模态的核心方法。",
            "id": "4039416",
            "problem": "考虑赤道 beta 平面上平均深度为 $H$、重力加速度为 $g$、行星涡度梯度为 $\\beta$ 的单层流体的线性化浅水方程：\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y v = -\\frac{\\partial \\phi}{\\partial x}, \\quad \\frac{\\partial v}{\\partial t} + \\beta y u = -\\frac{\\partial \\phi}{\\partial y}, \\quad \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = -\\frac{\\partial \\phi}{\\partial t}/c^2,\n$$\n其中 $u$ 和 $v$ 分别是纬向和经向速度，$\\phi$ 是位势高度扰动，而 $c = \\sqrt{gH}$ 是重力波速度。对于赤道 Kelvin 波，经向速度满足 $v = 0$，并且位势高度的可分离经向结构呈现高斯形式\n$$\n\\phi_K(y) = \\exp\\left(-\\frac{y^2}{2L^2}\\right),\n$$\n其中赤道变形半径为\n$$\nL = \\sqrt{\\frac{c}{\\beta}}.\n$$\n给定沿赤道的初始位势高度扰动 $\\phi(y)$，在经向坐标 $y$ 上的标准 $L^2$ 内积下，其在 Kelvin 模态上的投影系数定义为\n$$\na_K = \\frac{\\int_{-\\infty}^{\\infty} \\phi(y)\\,\\phi_K(y)\\,dy}{\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy}.\n$$\n在计算中，使用包含 $N_y$ 个点的均匀网格和梯形法则，在对称有限区间 $[-Y_{\\max},Y_{\\max}]$（其中 $Y_{\\max} = \\alpha L$）上近似计算积分。您的程序必须：\n- 根据给定的 $\\beta$ 和 $c$ 计算 $L = \\sqrt{c/\\beta}$。\n- 定义 $Y_{\\max} = \\alpha L$ 和一个跨越 $[-Y_{\\max},Y_{\\max}]$ 的均匀网格 $y_i$（$i = 1,\\dots,N_y$）。\n- 对每个测试用例，计算 $\\phi_K(y_i)$ 和给定的 $\\phi(y_i)$。\n- 计算分子和分母积分的梯形近似值，并构成 $a_K$。\n\n将每个投影系数 $a_K$ 以 $\\text{m}^2\\,\\text{s}^{-2}$ 为单位表示，并四舍五入到六位小数。\n\n使用以下测试套件，其中每个用例指定了 $(\\beta, c, \\alpha, N_y)$ 和一个由 $L$ 构造的初始条件 $\\phi(y)$：\n\n$1.$ 理想路径（匹配的 Kelvin 结构）：$\\beta = 2.3\\times 10^{-11}\\,\\text{s}^{-1}\\,\\text{m}^{-1}$，$c = \\sqrt{9.81\\times 250}\\,\\text{m}\\,\\text{s}^{-1}$，$\\alpha = 8$，$N_y = 60001$。初始条件 $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$，其中 $A = 1.0\\,\\text{m}^2\\,\\text{s}^{-2}$。\n\n$2.$ 正交性检查（奇模态）：与用例 1 相同的 $\\beta$、$c$、$\\alpha$、$N_y$。初始条件 $\\phi(y) = A\\,\\frac{y}{L}\\,\\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$，其中 $A = 1.0\\,\\text{m}^2\\,\\text{s}^{-2}$。\n\n$3.$ 混合偶结构：与用例 1 相同的 $\\beta$、$c$、$\\alpha$、$N_y$。初始条件\n$$\n\\phi(y) = \\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)\\left(A + B\\left(\\frac{y^2}{L^2} - 1\\right)\\right),\n$$\n其中 $A = 1.2\\,\\text{m}^2\\,\\text{s}^{-2}$ 且 $B = -0.4\\,\\text{m}^2\\,\\text{s}^{-2}$。\n\n$4.$ 宽度不匹配（窄高斯函数）：与用例 1 相同的 $\\beta$、$c$、$\\alpha$、$N_y$。令 $L' = rL$，其中 $r = 0.5$。初始条件 $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L'^2}\\right)$，其中 $A = 2.0\\,\\text{m}^2\\,\\text{s}^{-2}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[a_1,a_2,a_3,a_4]$），每个 $a_i$ 都四舍五入到六位小数，并以 $\\text{m}^2\\,\\text{s}^{-2}$ 为单位表示。",
            "solution": "我们从赤道 beta 平面上的线性化浅水方程开始。对于赤道 Kelvin 波，经向速度满足 $v=0$，其经向结构解耦为高斯形式。Kelvin 模态的位势高度扰动的已知可分离经向结构为\n$$\n\\phi_K(y) = \\exp\\left(-\\frac{y^2}{2L^2}\\right),\n$$\n其中赤道变形半径 $L$ 为\n$$\nL = \\sqrt{\\frac{c}{\\beta}}.\n$$\n$L$ 的值是通过平衡由行星涡度梯度 $\\beta$ 引起的经向捕获效应和速度为 $c$ 的重力波动力学得到的，这是通过在经向结构方程（线性化系统的量子谐振子模拟）中进行变量分离得出的。这个高斯解是 Kelvin 波特有的纬向偶对称、陷于赤道的结构。\n\n为了将初始条件投影到 Kelvin 模态上，我们使用经向坐标 $y$ 上的标准 $L^2$ 内积：\n$$\n\\langle f, g \\rangle = \\int_{-\\infty}^{\\infty} f(y)\\,g(y)\\,dy.\n$$\n由于上面的 $\\phi_K(y)$ 未被归一化为单位能量，对于单模态近似 $\\phi(y) \\approx a_K\\,\\phi_K(y)$，使均方误差最小化的投影系数 $a_K$ 由下式给出\n$$\na_K = \\frac{\\langle \\phi, \\phi_K \\rangle}{\\langle \\phi_K, \\phi_K \\rangle} = \\frac{\\int_{-\\infty}^{\\infty} \\phi(y)\\,\\phi_K(y)\\,dy}{\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy}.\n$$\n这个定义确保了 $a_K$ 与 $\\phi$（位势高度扰动）具有相同的物理单位，即 $\\text{m}^2\\,\\text{s}^{-2}$。\n\n为了进行数值计算，我们将无限域截断为一个对称的有限区间 $[-Y_{\\max},Y_{\\max}]$，其中\n$$\nY_{\\max} = \\alpha L,\n$$\n其中 $\\alpha$ 被选择得足够大（例如 $\\alpha=8$），以使高斯函数的尾部在此范围之外的贡献可以忽略不计。我们用 $N_y$ 个均匀间隔的点 $y_i$ 将 $[-Y_{\\max},Y_{\\max}]$ 离散化，并使用梯形法则来近似积分：\n$$\n\\int_{-Y_{\\max}}^{Y_{\\max}} h(y)\\,dy \\approx \\sum_{i=1}^{N_y-1} \\frac{h(y_i) + h(y_{i+1})}{2}\\,\\Delta y,\n$$\n其中 $\\Delta y$ 是均匀的网格间距，而 $h$ 表示乘积 $\\phi \\phi_K$ 或 $\\phi_K^2$。\n\n算法步骤：\n$1.$ 计算 $L = \\sqrt{c/\\beta}$。\n$2.$ 设置 $Y_{\\max} = \\alpha L$ 并在 $[-Y_{\\max},Y_{\\max}]$ 上构建一个包含 $N_y$ 个点的均匀网格 $y$。\n$3.$ 计算 $\\phi_K(y) = \\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$。\n$4.$ 对每个测试用例，根据指定的函数形式和参数在网格上计算 $\\phi(y)$。\n$5.$ 使用离散网格和梯形法则计算梯形积分 $I_{\\text{num}} = \\int \\phi(y)\\,\\phi_K(y)\\,dy$ 和 $I_{\\text{den}} = \\int \\phi_K^2(y)\\,dy$。\n$6.$ 构成 $a_K = I_{\\text{num}}/I_{\\text{den}}$。\n$7.$ 以 $\\text{m}^2\\,\\text{s}^{-2}$ 为单位报告 $a_K$，并四舍五入到六位小数。\n\n用于验证数值方法的解析检验：\n- 对于 $\\phi(y) = A\\,\\phi_K(y)$，我们有\n$$\na_K = \\frac{\\int A\\,\\phi_K^2\\,dy}{\\int \\phi_K^2\\,dy} = A,\n$$\n因此投影应恢复振幅 $A$。\n- 对于 $\\phi(y) = A\\,\\frac{y}{L}\\,\\phi_K(y)$，被积函数 $\\phi\\,\\phi_K = A\\,\\frac{y}{L}\\,\\phi_K^2$ 是关于 $y$ 的奇函数，因此\n$$\na_K = \\frac{\\int_{-\\infty}^{\\infty} A\\,\\frac{y}{L}\\,\\phi_K^2\\,dy}{\\int \\phi_K^2\\,dy} = 0.\n$$\n- 对于 $\\phi(y) = \\phi_K(y)\\left(A + B\\left(\\frac{y^2}{L^2}-1\\right)\\right)$，使用高斯积分，\n$$\n\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy = L\\sqrt{\\pi}, \\quad \\int_{-\\infty}^{\\infty} \\left(\\frac{y^2}{L^2}-1\\right)\\phi_K^2(y)\\,dy = -\\frac{L\\sqrt{\\pi}}{2},\n$$\n所以\n$$\na_K = \\frac{A\\,L\\sqrt{\\pi} - \\frac{B\\,L\\sqrt{\\pi}}{2}}{L\\sqrt{\\pi}} = A - \\frac{B}{2}.\n$$\n- 对于宽度不匹配的情况 $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L'^2}\\right)$，其中 $L' \\neq L$，令 $\\alpha_n = \\frac{1}{2}\\left(\\frac{1}{L'^2} + \\frac{1}{L^2}\\right)$ 和 $\\alpha_d = \\frac{1}{L^2}$；那么\n$$\na_K = A\\,\\frac{\\int e^{-\\alpha_n y^2}\\,dy}{\\int e^{-\\alpha_d y^2}\\,dy} = A\\,\\sqrt{\\frac{\\alpha_d}{\\alpha_n}} = A\\,\\sqrt{\\frac{2}{1 + \\frac{L^2}{L'^2}}}.\n$$\n这些闭合形式的结果为在有限 $Y_{\\max}$ 和离散求积下的数值精度提供了有用的基准。\n\n实现细节：\n- 使用 $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$ 和 $H = 250\\,\\text{m}$，所以 $c = \\sqrt{gH}$。\n- 使用 $\\beta = 2.3\\times 10^{-11}\\,\\text{s}^{-1}\\,\\text{m}^{-1}$。\n- 选择 $\\alpha = 8$ 和 $N_y = 60001$ 以确保足够的分辨率和域大小，从而实现精确的高斯积分。\n- 为保证对称性以及对奇函数的精确抵消，使用一个关于 $y=0$ 对称且包含奇数个点的网格。\n\n最终程序为四个指定的测试用例计算 $a_K$，并打印一行由方括号括起来的逗号分隔值，每个值都四舍五入到六位小数，单位为 $\\text{m}^2\\,\\text{s}^{-2}$。",
            "answer": "[1.000000, 0.000000, 1.400000, 1.264911]"
        }
    ]
}