{
    "hands_on_practices": [
        {
            "introduction": "A defining characteristic of equatorial Kelvin waves is their remarkable confinement near the equator, a property that allows them to act as an efficient waveguide for energy and momentum. This first exercise takes you back to first principles, using the linearized shallow-water equations on an equatorial beta-plane to derive this structure from scratch. By completing this practice, you will not only derive the wave's Gaussian meridional profile but also compute its e-folding half-width, a tangible scale that quantifies the degree of equatorial trapping and its dependence on the wave's phase speed. ",
            "id": "4039438",
            "problem": "In the context of Numerical Weather Prediction (NWP) and climate modeling, consider the linearized inviscid shallow-water equations (SWE) on an equatorial beta-plane, where the Coriolis parameter is approximated by $f(y) = \\beta y$. The linearized SWE for perturbations $(u,v,\\eta)$ in zonal velocity $u$, meridional velocity $v$, and free-surface height $\\eta$ on a mean depth $H$ are\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0,\n$$\nwith $f = \\beta y$ and constant gravity $g$. Assume a zonally propagating equatorial Kelvin wave solution characterized by vanishing meridional velocity $v = 0$ and a separable normal mode dependence in $x$ and $t$ of the form $\\exp\\!\\left[i(k x - \\omega t)\\right]$, while allowing the meridional structure to vary with $y$.\n\nStarting from these equations and assumptions alone, derive the ordinary differential equation governing the meridional envelope of the Kelvin wave’s height field $\\eta(y)$ and show that it has a Gaussian form with a characteristic meridional scale that depends on the phase speed $c$ and the meridional gradient of the Coriolis parameter $\\beta$. Define the e-folding half-width $y_{e}$ as the positive meridional distance from the equator at which the wave amplitude is reduced by a factor $\\exp(-1)$ relative to its equatorial value, and express $y_{e}$ in terms of $c$ and $\\beta$.\n\nThen, for $c = 30\\ \\mathrm{m\\ s^{-1}}$ and $\\beta = 2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}$, compute the numerical value of $y_{e}$. Express your final numerical answer in kilometers, and round your answer to four significant figures. Additionally, briefly interpret the latitude extent of trapping implied by your $y_{e}$ using an Earth radius $a = 6.371 \\times 10^{6}\\ \\mathrm{m}$, but note that only the e-folding half-width in kilometers is required for the final answer.",
            "solution": "The problem requires the derivation of the meridional structure of an equatorial Kelvin wave, starting from the linearized shallow-water equations (SWE) on an equatorial beta-plane. The given equations are:\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y} \\quad (2)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0 \\quad (3)\n$$\nHere, $u$ is the zonal velocity, $v$ is the meridional velocity, $\\eta$ is the free-surface height perturbation, $g$ is the acceleration due to gravity, and $H$ is the mean fluid depth. The Coriolis parameter is approximated as $f(y) = \\beta y$, where $\\beta$ is the constant meridional gradient of the Coriolis parameter at the equator and $y$ is the meridional distance from the equator.\n\nWe are to find a solution for an equatorial Kelvin wave. The defining characteristics of this wave are the vanishing meridional velocity, $v=0$, and a zonally propagating wave structure. We assume solutions of the form:\n$$\nu(x, y, t) = \\hat{u}(y) \\exp[i(kx - \\omega t)]\n$$\n$$\nv(x, y, t) = 0\n$$\n$$\n\\eta(x, y, t) = \\hat{\\eta}(y) \\exp[i(kx - \\omega t)]\n$$\nwhere $k$ is the zonal wavenumber and $\\omega$ is the angular frequency. The functions $\\hat{u}(y)$ and $\\hat{\\eta}(y)$ represent the meridional envelopes of the wave.\n\nSubstituting these forms and the condition $v=0$ into the SWE yields a simplified system of equations. The partial derivatives with respect to $t$ and $x$ become multiplications by $-i\\omega$ and $ik$, respectively. The partial derivative with respect to $y$ becomes an ordinary derivative, $\\frac{d}{dy}$.\n\nFrom the zonal momentum equation (1):\n$$\n(-i\\omega) \\hat{u}(y) - (\\beta y)(0) = -g (ik) \\hat{\\eta}(y)\n$$\n$$\n-i\\omega \\hat{u} = -igk \\hat{\\eta}\n$$\n$$\n\\omega \\hat{u} = gk \\hat{\\eta} \\quad (4)\n$$\nThis equation shows that the zonal velocity and height perturbations are in geostrophic balance in the zonal direction, which is not strictly true as we have an ageostrophic component, but it relates their amplitudes.\n\nFrom the meridional momentum equation (2):\n$$\n(-i\\omega)(0) + (\\beta y) \\hat{u}(y) = -g \\frac{d\\hat{\\eta}}{dy}\n$$\n$$\n\\beta y \\hat{u} = -g \\frac{d\\hat{\\eta}}{dy} \\quad (5)\n$$\nThis equation represents the geostrophic balance in the meridional direction, where the Coriolis force acting on the zonal flow balances the meridional pressure gradient. This is a crucial feature of the Kelvin wave.\n\nFrom the continuity equation (3):\n$$\n(-i\\omega) \\hat{\\eta}(y) + H\\left( (ik) \\hat{u}(y) + \\frac{\\partial(0)}{\\partial y} \\right) = 0\n$$\n$$\n-i\\omega \\hat{\\eta} = -iHk \\hat{u}\n$$\n$$\n\\omega \\hat{\\eta} = Hk \\hat{u} \\quad (6)\n$$\n\nThe wave has a phase speed $c = \\omega/k$. From equation (4), we can write $\\hat{u} = (gk/\\omega)\\hat{\\eta} = (g/c)\\hat{\\eta}$. Substituting this into equation (6) gives $\\omega \\hat{\\eta} = Hk (g/c)\\hat{\\eta}$, which simplifies to $\\omega = Hgk/c$. Since $c=\\omega/k$, this becomes $c^2 = gH$. This confirms that the equatorial Kelvin wave is a non-dispersive gravity wave propagating with speed $c = \\sqrt{gH}$.\n\nNow, we derive the ordinary differential equation (ODE) for the meridional height structure $\\hat{\\eta}(y)$. We use equations (4) and (5). From (4), we express $\\hat{u}$ in terms of $\\hat{\\eta}$:\n$$\n\\hat{u} = \\frac{gk}{\\omega} \\hat{\\eta} = \\frac{g}{c} \\hat{\\eta}\n$$\nSubstituting this expression for $\\hat{u}$ into the meridional momentum balance (5):\n$$\n\\beta y \\left(\\frac{g}{c} \\hat{\\eta}\\right) = -g \\frac{d\\hat{\\eta}}{dy}\n$$\nThe factor $g$ cancels from both sides, yielding:\n$$\n\\frac{\\beta y}{c} \\hat{\\eta} = - \\frac{d\\hat{\\eta}}{dy}\n$$\nRearranging this gives the first-order linear homogeneous ODE for $\\hat{\\eta}(y)$:\n$$\n\\frac{d\\hat{\\eta}}{dy} + \\frac{\\beta}{c} y \\hat{\\eta} = 0\n$$\nThis equation governs the meridional envelope of the wave's height field. To solve it, we can separate variables:\n$$\n\\frac{d\\hat{\\eta}}{\\hat{\\eta}} = - \\frac{\\beta}{c} y dy\n$$\nIntegrating both sides from $0$ to $y$:\n$$\n\\int_{\\hat{\\eta}(0)}^{\\hat{\\eta}(y)} \\frac{d\\hat{\\eta}'}{\\hat{\\eta}'} = -\\int_0^y \\frac{\\beta}{c} y' dy'\n$$\n$$\n\\ln\\left(\\frac{\\hat{\\eta}(y)}{\\hat{\\eta}(0)}\\right) = - \\frac{\\beta}{2c} y^2\n$$\nExponentiating both sides gives the solution for $\\hat{\\eta}(y)$:\n$$\n\\hat{\\eta}(y) = \\hat{\\eta}(0) \\exp\\left(-\\frac{\\beta y^2}{2c}\\right)\n$$\nThis solution is a Gaussian function, centered at the equator ($y=0$), confirming the required form. The wave is thus \"trapped\" at the equator, with its amplitude decaying exponentially away from $y=0$. The characteristic meridional scale clearly depends on $c$ and $\\beta$.\n\nThe e-folding half-width, $y_e$, is defined as the positive meridional distance $y$ at which the wave amplitude $\\hat{\\eta}(y)$ is reduced by a factor of $\\exp(-1)$ relative to its maximum value at the equator, $\\hat{\\eta}(0)$. We set:\n$$\n\\frac{\\hat{\\eta}(y_e)}{\\hat{\\eta}(0)} = \\exp(-1)\n$$\nUsing our solution:\n$$\n\\exp\\left(-\\frac{\\beta y_e^2}{2c}\\right) = \\exp(-1)\n$$\nTaking the natural logarithm of both sides gives:\n$$\n\\frac{\\beta y_e^2}{2c} = 1\n$$\nSolving for $y_e^2$:\n$$\ny_e^2 = \\frac{2c}{\\beta}\n$$\nTaking the positive square root gives the expression for the e-folding half-width:\n$$\ny_e = \\sqrt{\\frac{2c}{\\beta}}\n$$\n\nNow, we compute the numerical value of $y_e$ using the provided constants: $c = 30\\ \\mathrm{m\\ s^{-1}}$ and $\\beta = 2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}$.\n$$\ny_e = \\sqrt{\\frac{2 \\times 30\\ \\mathrm{m\\ s^{-1}}}{2.3 \\times 10^{-11}\\ \\mathrm{m^{-1}\\ s^{-1}}}} = \\sqrt{\\frac{60}{2.3 \\times 10^{-11}}}\\ \\mathrm{m}\n$$\n$$\ny_e = \\sqrt{2.60869565... \\times 10^{12}}\\ \\mathrm{m} \\approx 1.6151457 \\times 10^6\\ \\mathrm{m}\n$$\nTo express this in kilometers, we divide by $1000$:\n$$\ny_e \\approx 1615.1457\\ \\mathrm{km}\n$$\nRounding the answer to four significant figures gives:\n$$\ny_e \\approx 1615\\ \\mathrm{km}\n$$\n\nFor interpretation, we can estimate the latitude corresponding to this meridional distance. Using the Earth's radius $a = 6.371 \\times 10^6\\ \\mathrm{m}$ and the small-angle approximation $y \\approx a\\phi$ (where $\\phi$ is latitude in radians), the e-folding latitude $\\phi_e$ is:\n$$\n\\phi_e = \\frac{y_e}{a} \\approx \\frac{1.615 \\times 10^6\\ \\mathrm{m}}{6.371 \\times 10^6\\ \\mathrm{m}} \\approx 0.2535\\ \\mathrm{rad}\n$$\nConverting to degrees:\n$$\n\\phi_e \\approx 0.2535 \\times \\frac{180}{\\pi} \\approx 14.5^\\circ\n$$\nThis result indicates that the equatorial Kelvin wave is strongly trapped within approximately $\\pm 14.5^\\circ$ of the equator. Its amplitude decays to about $37\\%$ of its peak value at this latitude, confining most of its energy to the deep tropics.",
            "answer": "$$\\boxed{1615}$$"
        },
        {
            "introduction": "In the real atmosphere, waves do not propagate indefinitely without losing energy. This practice extends our understanding from the ideal, lossless case by incorporating a simple linear damping, which represents processes like friction and radiative cooling. By deriving the complex dispersion relation for a damped Kelvin wave, you will calculate its e-folding decay length—the characteristic distance over which its amplitude diminishes. This exercise provides critical insight into the large-scale coherence of Kelvin waves and explains why they are a key source of predictability on subseasonal timescales across entire ocean basins. ",
            "id": "4039414",
            "problem": "Consider linear equatorial dynamics in the shallow-water framework on a $\\beta$-plane with constant gravity $g$ and an equivalent depth $H$ representative of the first baroclinic mode in the tropical atmosphere. Let $(u,v)$ be the zonal and meridional velocities and $h$ the perturbation height (proportional to column mass or geopotential). Assume linear damping acts uniformly at rate $\\mu$ on both the momentum and mass fields, as a combination of Rayleigh friction and Newtonian cooling. The governing linearized equations are\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y\\, v \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial x} \\;-\\; \\mu\\,u,\n$$\n$$\n\\frac{\\partial v}{\\partial t} + \\beta y\\, u \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial y} \\;-\\; \\mu\\,v,\n$$\n$$\n\\frac{\\partial h}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; -\\,\\mu\\,h.\n$$\nFocus on the equatorial Kelvin wave, characterized by vanishing meridional velocity $v=0$ to leading order and an eastward propagation confined near $y=0$. Starting from these equations and first principles, derive the complex dispersion relation for the equatorial Kelvin wave under the stated damping, and from it obtain the spatial e-folding decay length along the equator. Then, evaluate this decay length numerically using $g=9.81~\\mathrm{m~s^{-2}}$, $H=25~\\mathrm{m}$, and $\\mu=2.0\\times 10^{-6}~\\mathrm{s^{-1}}$. Express your final numerical result in kilometers and round your answer to three significant figures. Additionally, explain the observational relevance of the computed decay length for the detectability and forecastability of equatorial Kelvin waves in Numerical Weather Prediction (NWP) and climate model analyses.",
            "solution": "We begin with the linearized shallow-water equations on an equatorial $\\beta$-plane with linear damping at a rate $\\mu$:\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y\\, v \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial x} \\;-\\; \\mu\\,u\n$$\n$$\n\\frac{\\partial v}{\\partial t} + \\beta y\\, u \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial y} \\;-\\; \\mu\\,v\n$$\n$$\n\\frac{\\partial h}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; -\\,\\mu\\,h\n$$\nThese can be rearranged by moving the damping terms to the left-hand side:\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) u - \\beta y\\, v \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial x}\n$$\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) v + \\beta y\\, u \\;=\\; -\\,g\\,\\frac{\\partial h}{\\partial y}\n$$\n$$\n\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) h + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; 0\n$$\nAn equatorial Kelvin wave is defined by the condition of having no meridional velocity, $v=0$. Applying this condition to the system of equations simplifies them considerably. The meridional momentum equation does not vanish and becomes a diagnostic relation, while the zonal momentum and continuity equations form a closed system for the zonal velocity $u$ and height perturbation $h$.\n\nWith $v=0$, the system becomes:\n1. Zonal momentum: $\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) u = -g \\frac{\\partial h}{\\partial x}$\n2. Meridional momentum (geostrophic balance): $\\beta y u = -g \\frac{\\partial h}{\\partial y}$\n3. Continuity: $\\left(\\frac{\\partial}{\\partial t} + \\mu\\right) h = -H \\frac{\\partial u}{\\partial x}$\n\nWe seek wave-like solutions that propagate zonally and are trapped at the equator. We posit solutions of the form:\n$$\nu(x,y,t) = \\hat{u}(y) \\exp[i(kx - \\omega t)]\n$$\n$$\nh(x,y,t) = \\hat{h}(y) \\exp[i(kx - \\omega t)]\n$$\nHere, $\\omega$ is the real-valued wave frequency and $k$ is the complex-valued zonal wavenumber, $k = k_r + i k_i$. The imaginary part $k_i$ will characterize the spatial decay of the wave. Substituting these forms into the simplified equations (1) and (3) yields a system of algebraic equations for the wave amplitudes $\\hat{u}$ and $\\hat{h}$:\n$$\n(-i\\omega + \\mu) \\hat{u} = -g(ik) \\hat{h}\n$$\n$$\n(-i\\omega + \\mu) \\hat{h} = -H(ik) \\hat{u}\n$$\nMultiplying these two equations gives:\n$$\n(-i\\omega + \\mu)^2 \\hat{u} \\hat{h} = (-g(ik))(-H(ik)) \\hat{u} \\hat{h}\n$$\nFor a non-trivial wave ($\\hat{u}\\hat{h} \\neq 0$), we can divide by $\\hat{u}\\hat{h}$ to find the dispersion relation:\n$$\n(-i\\omega + \\mu)^2 = (ik)^2 gH = -k^2 gH\n$$\nLet's define the shallow water gravity wave speed $c = \\sqrt{gH}$. The equation becomes:\n$$\n-k^2 c^2 = (-i\\omega + \\mu)^2 = (-(i\\omega - \\mu))^2 = (i\\omega - \\mu)^2\n$$\n$$\nk^2 c^2 = -(i\\omega - \\mu)^2 = -(-\\omega^2 - 2i\\omega\\mu + \\mu^2) = \\omega^2 + 2i\\omega\\mu - \\mu^2 = (\\omega + i\\mu)^2\n$$\nTaking the square root of both sides gives two possible solutions for $k$:\n$$\nkc = \\pm(\\omega + i\\mu) \\implies k = \\pm \\frac{\\omega + i\\mu}{c}\n$$\nWe must select the physically appropriate solution. The problem specifies an eastward-propagating wave. The real part of the wavenumber is $k_r = \\text{Re}(k)$, and the phase speed is $c_p = \\omega / k_r$. For eastward propagation, we require $c_p  0$, which means $k_r  0$ (for $\\omega  0$).\nLet's examine the two solutions:\n- Solution 1: $k = \\frac{\\omega + i\\mu}{c} = \\frac{\\omega}{c} + i\\frac{\\mu}{c}$. Here, $k_r = \\omega/c  0$, giving an eastward phase speed $c_p = c$. The imaginary part is $k_i = \\mu/c  0$. The spatial dependence of the wave amplitude is $\\exp(-k_i x) = \\exp(-(\\mu/c)x)$, which describes a wave decaying as it propagates in the positive $x$ (eastward) direction. This is the physically correct solution for a wave generated in the west and propagating east.\n- Solution 2: $k = -\\frac{\\omega + i\\mu}{c} = -\\frac{\\omega}{c} - i\\frac{\\mu}{c}$. Here, $k_r = -\\omega/c  0$, corresponding to a westward phase speed $c_p = -c$. This is not an eastward-propagating Kelvin wave.\n\nTherefore, the complex dispersion relation for the damped, eastward-propagating equatorial Kelvin wave is:\n$$\nk(\\omega) = \\frac{\\omega + i\\mu}{\\sqrt{gH}}\n$$\nThe imaginary part of the wavenumber is $k_i = \\text{Im}(k) = \\frac{\\mu}{\\sqrt{gH}}$. The spatial e-folding decay length, $L_d$, is the distance over which the wave's amplitude decreases by a factor of $1/e$. This is defined by $k_i L_d = 1$. Thus, the decay length is:\n$$\nL_d = \\frac{1}{k_i} = \\frac{\\sqrt{gH}}{\\mu}\n$$\nThis expression demonstrates that the decay length is proportional to the wave's intrinsic phase speed $c=\\sqrt{gH}$ and inversely proportional to the damping rate $\\mu$.\n\nTo confirm the consistency of the solution, we check the meridional momentum balance, equation (2). From the simplified algebraic equations, we can find the relationship between $\\hat{u}$ and $\\hat{h}$: $\\hat{u} = \\frac{ikg}{-i\\omega+\\mu}\\hat{h}$. Using the dispersion relation $kc = \\omega+i\\mu$, we have $ikc = i\\omega - \\mu$, so $\\hat{u} = \\frac{ikg}{ikc}\\hat{h} = \\frac{g}{c}\\hat{h}$. Substituting this into equation (2) gives:\n$$\n\\beta y \\left(\\frac{g}{c}\\hat{h}\\right) = -g \\frac{d\\hat{h}}{dy} \\implies \\frac{d\\hat{h}}{\\hat{h}} = -\\frac{\\beta y}{c} dy\n$$\nIntegrating yields $\\hat{h}(y) = \\hat{h}_0 \\exp\\left(-\\frac{\\beta y^2}{2c}\\right)$, a Gaussian profile that decays away from the equator ($y=0$). This confirms the equatorial trapping of the wave, consistent with the Kelvin wave structure.\n\nNow, we evaluate the decay length numerically with the given parameters: $g=9.81~\\mathrm{m~s^{-2}}$, $H=25~\\mathrm{m}$, and $\\mu=2.0\\times 10^{-6}~\\mathrm{s^{-1}}$.\nFirst, we calculate the shallow water wave speed $c$:\n$$\nc = \\sqrt{gH} = \\sqrt{(9.81~\\mathrm{m~s^{-2}})(25~\\mathrm{m})} = \\sqrt{245.25~\\mathrm{m^2~s^{-2}}} \\approx 15.66046~\\mathrm{m~s^{-1}}\n$$\nNext, we calculate the decay length $L_d$:\n$$\nL_d = \\frac{c}{\\mu} = \\frac{15.66046~\\mathrm{m~s^{-1}}}{2.0\\times 10^{-6}~\\mathrm{s^{-1}}} \\approx 7.83023 \\times 10^6~\\mathrm{m}\n$$\nThe problem requires the result in kilometers, rounded to three significant figures.\n$$\nL_d = 7.83023 \\times 10^3~\\mathrm{km} \\approx 7830~\\mathrm{km}\n$$\n\nThe observational relevance of this decay length is significant for meteorology and climate science. A decay length of approximately $7830~\\mathrm{km}$ is a substantial fraction of the Earth's equatorial circumference (about $40,075~\\mathrm{km}$). This means an equatorial Kelvin wave can propagate across nearly the entire width of the Pacific Ocean while retaining a significant portion of its amplitude. This large-scale coherence has profound implications:\n- **Detectability**: Kelvin waves are readily detectable in observational data (e.g., satellite measurements of sea surface height or outgoing longwave radiation) thousands of kilometers from where they are generated. Their robust structure can be tracked as they traverse entire ocean basins.\n- **Forecastability**: The long decay length, combined with their predictable eastward propagation speed ($c \\approx 16~\\mathrm{m~s^{-1}}$), makes Kelvin waves a primary source of atmospheric predictability in the tropics on subseasonal timescales (e.g., $10$ to $30$ days). A model that accurately captures the generation of a Kelvin wave (e.g., associated with a convective burst in the Indian Ocean or West Pacific) can forecast its downstream impacts on weather, such as rainfall patterns and wind shifts over the East Pacific and the Americas, many days in advance. The Madden-Julian Oscillation (MJO), the most dominant mode of tropical intraseasonal variability, has a prominent equatorial Kelvin wave component, and its forecastability is tied to the correct representation of this wave's life cycle.\n- **Model Validation**: The ability of a Numerical Weather Prediction (NWP) or climate model to reproduce the observed propagation and decay characteristics of Kelvin waves serves as a crucial benchmark for the model's fidelity. Excessive numerical diffusion or inaccuracies in parameterized physical damping (e.g., convection, radiation) in a model would lead to a decay length that is too short, thereby compromising the model's ability to capture large-scale tropical teleconnections and reducing its forecast skill. Therefore, theoretical estimates like the one calculated here provide an essential physical target for model developers.",
            "answer": "$$\n\\boxed{7830}\n$$"
        },
        {
            "introduction": "Theoretical knowledge of wave structures becomes most powerful when applied to complex, realistic data. This final hands-on practice transitions from theory to a practical computational skill: analyzing the composition of a given atmospheric state. You will write a program to project an arbitrary geopotential field onto the Kelvin wave's characteristic meridional structure, effectively measuring \"how much\" of the initial state is comprised of a Kelvin wave. This modal projection technique is fundamental for both initializing numerical models and for diagnosing the strength and evolution of equatorial waves in model output and observational datasets. ",
            "id": "4039416",
            "problem": "Consider the linearized shallow-water equations on the equatorial beta-plane for a single-layer fluid of mean depth $H$ and gravitational acceleration $g$, with planetary vorticity gradient $\\beta$:\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y v = -\\frac{\\partial \\phi}{\\partial x}, \\quad \\frac{\\partial v}{\\partial t} + \\beta y u = -\\frac{\\partial \\phi}{\\partial y}, \\quad \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = -\\frac{\\partial \\phi}{\\partial t}/c^2,\n$$\nwhere $u$ and $v$ are the zonal and meridional velocities, $\\phi$ is the geopotential height perturbation, and $c = \\sqrt{gH}$ is the gravity wave speed. For the equatorial Kelvin wave, the meridional velocity satisfies $v = 0$, and the separable meridional structure of the geopotential height takes the Gaussian form\n$$\n\\phi_K(y) = \\exp\\left(-\\frac{y^2}{2L^2}\\right),\n$$\nwith the equatorial deformation radius\n$$\nL = \\sqrt{\\frac{c}{\\beta}}.\n$$\nGiven an initial geopotential height perturbation $\\phi(y)$ along the equator, the projection coefficient onto the Kelvin mode under the standard $L^2$ inner product on the meridional coordinate $y$ is defined by\n$$\na_K = \\frac{\\int_{-\\infty}^{\\infty} \\phi(y)\\,\\phi_K(y)\\,dy}{\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy}.\n$$\nIn computation, approximate the integrals over a symmetric finite interval $[-Y_{\\max},Y_{\\max}]$ with $Y_{\\max} = \\alpha L$, using a uniform grid of $N_y$ points and the trapezoidal rule. Your program must:\n- Compute $L$ from given $\\beta$ and $c$ via $L = \\sqrt{c/\\beta}$.\n- Define $Y_{\\max} = \\alpha L$ and a uniform grid $y_i$ for $i = 1,\\dots,N_y$ spanning $[-Y_{\\max},Y_{\\max}]$.\n- Evaluate $\\phi_K(y_i)$ and the provided $\\phi(y_i)$ for each test case.\n- Compute the trapezoidal approximations to the numerator and denominator integrals and form $a_K$.\n\nExpress each projection coefficient $a_K$ in $\\text{m}^2\\,\\text{s}^{-2}$, rounded to six decimal places.\n\nUse the following test suite, where each case specifies $(\\beta, c, \\alpha, N_y)$ and an initial condition $\\phi(y)$ constructed from $L$:\n\n$1.$ Happy path (matched Kelvin structure): $\\beta = 2.3\\times 10^{-11}\\,\\text{s}^{-1}\\,\\text{m}^{-1}$, $c = \\sqrt{9.81\\times 250}\\,\\text{m}\\,\\text{s}^{-1}$, $\\alpha = 8$, $N_y = 60001$. Initial condition $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$ with $A = 1.0\\,\\text{m}^2\\,\\text{s}^{-2}$.\n\n$2.$ Orthogonality check (odd mode): same $\\beta$, $c$, $\\alpha$, $N_y$ as case $1$. Initial condition $\\phi(y) = A\\,\\frac{y}{L}\\,\\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$ with $A = 1.0\\,\\text{m}^2\\,\\text{s}^{-2}$.\n\n$3.$ Mixed even structure: same $\\beta$, $c$, $\\alpha$, $N_y$ as case $1$. Initial condition\n$$\n\\phi(y) = \\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)\\left(A + B\\left(\\frac{y^2}{L^2} - 1\\right)\\right),\n$$\nwith $A = 1.2\\,\\text{m}^2\\,\\text{s}^{-2}$ and $B = -0.4\\,\\text{m}^2\\,\\text{s}^{-2}$.\n\n$4.$ Width mismatch (narrow Gaussian): same $\\beta$, $c$, $\\alpha$, $N_y$ as case $1$. Let $L' = rL$ with $r = 0.5$. Initial condition $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L'^2}\\right)$ with $A = 2.0\\,\\text{m}^2\\,\\text{s}^{-2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[a_1,a_2,a_3,a_4]$), with each $a_i$ rounded to six decimal places and expressed in $\\text{m}^2\\,\\text{s}^{-2}$.",
            "solution": "We begin from the linearized shallow-water equations on the equatorial beta-plane. For equatorial Kelvin waves, the meridional velocity satisfies $v=0$, and the meridional structure decouples into a Gaussian form. The known separable meridional structure for the geopotential height perturbation for the Kelvin mode is\n$$\n\\phi_K(y) = \\exp\\left(-\\frac{y^2}{2L^2}\\right),\n$$\nwhere the equatorial deformation radius $L$ is\n$$\nL = \\sqrt{\\frac{c}{\\beta}}.\n$$\nThe value of $L$ follows from balancing the meridional trapping induced by the planetary vorticity gradient $\\beta$ and the gravity wave dynamics with speed $c$, obtained by separation of variables in the meridional structure equation (the quantum harmonic oscillator analog for the linearized system). This Gaussian solution is the even, trapped structure in latitude characteristic of Kelvin waves.\n\nTo project an initial condition onto the Kelvin mode, we use the standard $L^2$ inner product in the meridional coordinate $y$:\n$$\n\\langle f, g \\rangle = \\int_{-\\infty}^{\\infty} f(y)\\,g(y)\\,dy.\n$$\nSince $\\phi_K(y)$ above is not normalized to unit energy, the projection coefficient $a_K$ that minimizes the mean-square error for a single-mode approximation $\\phi(y) \\approx a_K\\,\\phi_K(y)$ is given by\n$$\na_K = \\frac{\\langle \\phi, \\phi_K \\rangle}{\\langle \\phi_K, \\phi_K \\rangle} = \\frac{\\int_{-\\infty}^{\\infty} \\phi(y)\\,\\phi_K(y)\\,dy}{\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy}.\n$$\nThis definition ensures that $a_K$ carries the same physical units as $\\phi$ (geopotential height perturbation), namely $\\text{m}^2\\,\\text{s}^{-2}$.\n\nFor numerical computation, we truncate the infinite domain to a symmetric finite interval $[-Y_{\\max},Y_{\\max}]$ with\n$$\nY_{\\max} = \\alpha L,\n$$\nwhere $\\alpha$ is chosen to be sufficiently large (for example, $\\alpha = 8$) so that the Gaussian tails contribute negligibly beyond this range. We discretize $[-Y_{\\max},Y_{\\max}]$ with $N_y$ uniformly spaced points $y_i$, and use the trapezoidal rule to approximate the integrals:\n$$\n\\int_{-Y_{\\max}}^{Y_{\\max}} h(y)\\,dy \\approx \\sum_{i=1}^{N_y-1} \\frac{h(y_i) + h(y_{i+1})}{2}\\,\\Delta y,\n$$\nwhere $\\Delta y$ is the uniform grid spacing and $h$ denotes either the product $\\phi \\phi_K$ or $\\phi_K^2$.\n\nAlgorithmic steps:\n$1.$ Compute $L = \\sqrt{c/\\beta}$.\n$2.$ Set $Y_{\\max} = \\alpha L$ and construct a uniform grid $y$ of $N_y$ points over $[-Y_{\\max},Y_{\\max}]$.\n$3.$ Evaluate $\\phi_K(y) = \\exp\\!\\left(-\\frac{y^2}{2L^2}\\right)$.\n$4.$ For each test case, evaluate $\\phi(y)$ on the grid according to the specified functional form and parameters.\n$5.$ Compute the trapezoidal integrals $I_{\\text{num}} = \\int \\phi(y)\\,\\phi_K(y)\\,dy$ and $I_{\\text{den}} = \\int \\phi_K^2(y)\\,dy$ using the discrete grid and the trapezoidal rule.\n$6.$ Form $a_K = I_{\\text{num}}/I_{\\text{den}}$.\n$7.$ Report $a_K$ in $\\text{m}^2\\,\\text{s}^{-2}$, rounded to six decimal places.\n\nAnalytical checks to validate the numerical approach:\n- For $\\phi(y) = A\\,\\phi_K(y)$, we have\n$$\na_K = \\frac{\\int A\\,\\phi_K^2\\,dy}{\\int \\phi_K^2\\,dy} = A,\n$$\nso the projection should recover the amplitude $A$.\n- For $\\phi(y) = A\\,\\frac{y}{L}\\,\\phi_K(y)$, the integrand $\\phi\\,\\phi_K = A\\,\\frac{y}{L}\\,\\phi_K^2$ is odd in $y$, hence\n$$\na_K = \\frac{\\int_{-\\infty}^{\\infty} A\\,\\frac{y}{L}\\,\\phi_K^2\\,dy}{\\int \\phi_K^2\\,dy} = 0.\n$$\n- For $\\phi(y) = \\phi_K(y)\\left(A + B\\left(\\frac{y^2}{L^2}-1\\right)\\right)$, using Gaussian integrals,\n$$\n\\int_{-\\infty}^{\\infty} \\phi_K^2(y)\\,dy = L\\sqrt{\\pi}, \\quad \\int_{-\\infty}^{\\infty} \\left(\\frac{y^2}{L^2}-1\\right)\\phi_K^2(y)\\,dy = -\\frac{L\\sqrt{\\pi}}{2},\n$$\nso\n$$\na_K = \\frac{A\\,L\\sqrt{\\pi} - \\frac{B\\,L\\sqrt{\\pi}}{2}}{L\\sqrt{\\pi}} = A - \\frac{B}{2}.\n$$\n- For width mismatch $\\phi(y) = A\\,\\exp\\!\\left(-\\frac{y^2}{2L'^2}\\right)$ with $L' \\neq L$, let $\\alpha_n = \\frac{1}{2}\\left(\\frac{1}{L'^2} + \\frac{1}{L^2}\\right)$ and $\\alpha_d = \\frac{1}{L^2}$; then\n$$\na_K = A\\,\\frac{\\int e^{-\\alpha_n y^2}\\,dy}{\\int e^{-\\alpha_d y^2}\\,dy} = A\\,\\sqrt{\\frac{\\alpha_d}{\\alpha_n}} = A\\,\\sqrt{\\frac{2}{1 + \\frac{L^2}{L'^2}}}.\n$$\nThese closed-form results provide useful benchmarks for numerical accuracy with finite $Y_{\\max}$ and discrete quadrature.\n\nImplementation details:\n- Use $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$ and $H = 250\\,\\text{m}$, so $c = \\sqrt{gH}$.\n- Use $\\beta = 2.3\\times 10^{-11}\\,\\text{s}^{-1}\\,\\text{m}^{-1}$.\n- Choose $\\alpha = 8$ and $N_y = 60001$ to ensure sufficient resolution and domain size for accurate Gaussian integration.\n- To guarantee symmetry and accurate cancellation for odd functions, use a grid symmetric about $y = 0$ with an odd number of points.\n\nThe final program computes $a_K$ for the four specified test cases and prints a single line of comma-separated values within square brackets, each rounded to six decimal places, in the units $\\text{m}^2\\,\\text{s}^{-2}$.",
            "answer": "[1.000000,0.000000,1.400000,1.264911]"
        }
    ]
}