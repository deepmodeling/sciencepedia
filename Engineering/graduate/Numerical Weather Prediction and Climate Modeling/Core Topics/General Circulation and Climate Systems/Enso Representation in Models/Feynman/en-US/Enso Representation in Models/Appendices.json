{
    "hands_on_practices": [
        {
            "introduction": "At its heart, the El Niño–Southern Oscillation (ENSO) can be conceptualized as a coupled oscillator between sea surface temperature and thermocline depth. This first exercise provides a classic hands-on calculation to explore this idea, using linear systems theory to derive the fundamental period and stability of the oscillation from a simplified model . By analyzing the system's eigenvalues, you will directly connect the strength of physical feedbacks to the characteristic rhythm of ENSO.",
            "id": "4035502",
            "problem": "El Niño–Southern Oscillation (ENSO) is often idealized in reduced-complexity climate models as a coupled oscillator between a Niño-3 sea surface temperature anomaly $T(t)$ and an equatorial Pacific thermocline depth anomaly $h(t)$. In one such linearized formulation consistent with anomaly heat budget and mass continuity, the prognostic system for $(T,h)$ is\n$$\\frac{dT}{dt}=a\\,h-b\\,T,\\qquad \\frac{dh}{dt}=-c\\,T-d\\,h,$$\nwhere $a$ represents the sensitivity of the sea surface temperature tendency to thermocline anomalies, $b$ represents net thermal damping, $c$ represents the sensitivity of thermocline tendency to temperature anomalies via wind-stress feedbacks and wave adjustments, and $d$ represents net thermocline damping. All coefficients are constant. Assume the numerical values $a=0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$, $b=0.2\\ \\mathrm{month^{-1}}$, $c=0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$, and $d=0.05\\ \\mathrm{month^{-1}}$.\n\nStarting from first principles of linear systems theory applied to constant-coefficient ordinary differential equations, derive the normal-mode solutions and use them to obtain the oscillation period and the linear damping rate for this system. Define the oscillation period $P$ from the imaginary part of the eigenvalues as $P=2\\pi/\\omega$, where $\\omega$ is the magnitude of the imaginary part in radians per month, and define the damping rate $r$ as the positive quantity $r=-\\Re(\\lambda)$, where $\\lambda$ is an eigenvalue of the system. Round the oscillation period and the damping rate to four significant figures. Express the oscillation period in months and the damping rate in $\\mathrm{month^{-1}}$.",
            "solution": "### Step 1: Extract Givens\nThe problem provides a system of two coupled linear ordinary differential equations for the El Niño–Southern Oscillation (ENSO) anomalies, sea surface temperature $T(t)$ and thermocline depth $h(t)$:\n$$\n\\frac{dT}{dt} = a\\,h - b\\,T\n$$\n$$\n\\frac{dh}{dt} = -c\\,T - d\\,h\n$$\nThe constant coefficients are given as:\n- $a = 0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$\n- $b = 0.2\\ \\mathrm{month^{-1}}$\n- $c = 0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$\n- $d = 0.05\\ \\mathrm{month^{-1}}$\n\nThe problem defines the oscillation period $P$ as $P = 2\\pi/\\omega$, where $\\omega$ is the magnitude of the imaginary part of the system's eigenvalues.\nThe problem defines the linear damping rate $r$ as $r = -\\Re(\\lambda)$, where $\\lambda$ is an eigenvalue.\nThe final numerical values are to be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The model is a well-established reduced-complexity model used in climate dynamics to study ENSO. It represents a linearization of the underlying physics of tropical Pacific air-sea interaction. The formulation is scientifically sound.\n2.  **Well-Posed:** The problem describes a system of linear, constant-coefficient, homogeneous ordinary differential equations. For any given initial condition, a unique solution exists. The problem is well-posed.\n3.  **Objective:** The problem statement is precise, quantitative, and free of subjective or ambiguous language.\n4.  **Completeness and Consistency:** All necessary parameters ($a, b, c, d$) are provided with consistent units. For instance, in the first equation, the term $a\\,h$ has units of $( \\mathrm{K\\,m^{-1}\\,month^{-1}} ) \\times \\mathrm{m} = \\mathrm{K\\,month^{-1}}$, and the term $b\\,T$ has units of $(\\mathrm{month^{-1}}) \\times \\mathrm{K} = \\mathrm{K\\,month^{-1}}$. Both match the units of $dT/dt$. A similar check confirms the consistency of the second equation. The setup is complete and consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard eigenvalue problem in the context of linear systems theory applied to climate modeling. The derivation can proceed.\n\n### Solution Derivation\nThe system of differential equations can be expressed in matrix form. Let the state vector be $\\mathbf{x}(t) = \\begin{pmatrix} T(t) \\\\ h(t) \\end{pmatrix}$. The system is then written as:\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}\n$$\nwhere the matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} -b & a \\\\ -c & -d \\end{pmatrix}\n$$\nThe normal-mode solutions are of the form $\\mathbf{x}(t) = \\mathbf{v}e^{\\lambda t}$, where $\\lambda$ is an eigenvalue of $\\mathbf{A}$ and $\\mathbf{v}$ is the corresponding eigenvector. Substituting this form into the equation yields the eigenvalue problem $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$.\n\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} -b-\\lambda & a \\\\ -c & -d-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(-b-\\lambda)(-d-\\lambda) - (a)(-c) = 0\n$$\n$$\n(\\lambda+b)(\\lambda+d) + ac = 0\n$$\n$$\n\\lambda^2 + (b+d)\\lambda + (bd+ac) = 0\n$$\nThis is a quadratic equation for the eigenvalues $\\lambda$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{-(b+d) \\pm \\sqrt{(b+d)^2 - 4(bd+ac)}}{2}\n$$\nThe nature of the solution (oscillatory or purely damped) depends on the sign of the discriminant, $\\Delta = (b+d)^2 - 4(bd+ac)$. Let's substitute the given numerical values:\n- $b+d = 0.2 + 0.05 = 0.25\\ \\mathrm{month^{-1}}$\n- $bd = (0.2)(0.05) = 0.01\\ \\mathrm{month^{-2}}$\n- $ac = (0.6)(0.1) = 0.06\\ \\mathrm{month^{-2}}$\n\nThe discriminant is:\n$$\n\\Delta = (0.25)^2 - 4(0.01 + 0.06) = 0.0625 - 4(0.07) = 0.0625 - 0.28 = -0.2175\n$$\nSince $\\Delta < 0$, the eigenvalues are a complex conjugate pair, indicating damped oscillatory behavior. The eigenvalues can be written as $\\lambda = \\Re(\\lambda) \\pm i\\Im(\\lambda)$.\n\nThe real part of the eigenvalue is:\n$$\n\\Re(\\lambda) = -\\frac{b+d}{2}\n$$\nThe imaginary part is:\n$$\n\\Im(\\lambda) = \\pm \\frac{\\sqrt{-\\Delta}}{2} = \\pm \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2}\n$$\nAccording to the problem's definition, the damping rate $r$ is:\n$$\nr = -\\Re(\\lambda) = -\\left(-\\frac{b+d}{2}\\right) = \\frac{b+d}{2}\n$$\nSubstituting the numerical values:\n$$\nr = \\frac{0.25}{2} = 0.125\\ \\mathrm{month^{-1}}\n$$\nRounding to four significant figures, we get $r = 0.1250\\ \\mathrm{month^{-1}}$.\n\nThe oscillation angular frequency $\\omega$ is defined as the magnitude of the imaginary part of the eigenvalues:\n$$\n\\omega = |\\Im(\\lambda)| = \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2} = \\frac{\\sqrt{-\\Delta}}{2}\n$$\nSubstituting the numerical value for the discriminant:\n$$\n\\omega = \\frac{\\sqrt{0.2175}}{2} \\approx \\frac{0.46636895}{2} \\approx 0.23318448\\ \\mathrm{rad\\,month^{-1}}\n$$\nThe oscillation period $P$ is defined as $P = 2\\pi/\\omega$:\n$$\nP = \\frac{2\\pi}{\\omega} = \\frac{2\\pi}{\\frac{\\sqrt{0.2175}}{2}} = \\frac{4\\pi}{\\sqrt{0.2175}}\n$$\nCalculating the numerical value:\n$$\nP \\approx \\frac{4\\pi}{0.46636895} \\approx 26.94584\\ \\mathrm{months}\n$$\nRounding to four significant figures, the period is $P = 26.95\\ \\mathrm{months}$.\n\nThe oscillation period is approximately $26.95$ months, and the damping rate is $0.1250\\ \\mathrm{month^{-1}}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 26.95 & 0.1250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on the concept of oscillation, we now investigate a key physical theory that explains the multi-year timescale of ENSO: the delayed oscillator mechanism. This theory posits that the \"memory\" of the system is carried by slow-moving oceanic waves traversing the Pacific basin. This practice tasks you with calculating the transit times of equatorial Kelvin and Rossby waves to quantitatively test if their round-trip journey aligns with the observed ENSO periodicity .",
            "id": "4038443",
            "problem": "Consider the linearized one-layer shallow-water equations on an equatorial beta-plane for a resting background ocean, with longitude $x$, latitude $y$, horizontal velocities $u(x,y,t)$ and $v(x,y,t)$, and free-surface displacement $\\eta(x,y,t)$:\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y v = -g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + \\beta y u = -g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0,\n$$\nwhere $g$ is gravitational acceleration, $H$ is the equivalent depth of the baroclinic mode, and $\\beta$ is the meridional derivative of the Coriolis parameter at the equator. The equatorial deformation scale is $L_e = \\sqrt{\\frac{c}{\\beta}}$, where $c = \\sqrt{gH}$ is the long gravity wave speed in shallow-water theory. Under equatorial wave theory, there exist eastward-propagating Kelvin waves and westward-propagating equatorially trapped Rossby waves characterized by discrete meridional mode number $n \\in \\{1,2,\\dots\\}$.\n\nA zonal wind forcing localized near the western boundary excites an equatorial Kelvin wave that propagates eastward across a basin of zonal extent $L$ and, upon reaching the eastern boundary, partially reflects into equatorial Rossby waves that propagate westward back across the basin. In the long-wave limit appropriate for basin-scale disturbances, the equatorial Kelvin wave dispersion is non-dispersive with phase speed $c = \\sqrt{g H}$, while the phase speed of the equatorial Rossby wave for meridional mode $n$ reduces to a constant westward value whose magnitude is $|c_R|$ scaling with $c$ and $n$.\n\nStarting from the above framework, determine the basin-crossing time for the Kelvin wave, the return time for the reflected Rossby waves, and the total round-trip time. The goal is to relate these timescales to the El Niño–Southern Oscillation (ENSO) cycle length by comparing the computed round-trip time with a reference duration.\n\nTasks:\n- Using the long-wave limit for equatorial waves, compute the eastward Kelvin wave crossing time $T_K = \\frac{L}{c}$.\n- Using the same long-wave limit, compute the westward equatorial Rossby wave return time $T_R = \\frac{L}{|c_R|}$ for a given meridional mode number $n$.\n- Compute the total round-trip time $T_{\\text{tot}} = T_K + T_R$.\n- Compute the ratio $r = \\frac{T_{\\text{tot}}}{T_{\\text{ref}}}$ to a reference ENSO duration $T_{\\text{ref}}$.\n\nAssumptions:\n- Long-wave limit for the equatorial Kelvin and Rossby waves appropriate to basin-scale disturbances.\n- For the equatorial Rossby wave, use the long-wave phase speed magnitude appropriate to meridional mode $n$.\n- Reflection at the eastern boundary is idealized to produce the dominant equatorial Rossby mode specified by $n$ that traverses the basin.\n\nPhysical constants and units:\n- Use $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$.\n- Use $T_{\\text{ref}} = 3.5\\,\\text{years}$ as the reference ENSO cycle length.\n- Express all times $T_K$, $T_R$, and $T_{\\text{tot}}$ in years, rounded to three decimal places, using the conversion $1\\,\\text{year} = 365 \\times 86400\\,\\text{s}$.\n- The ratio $r$ must be a float, rounded to three decimal places.\n\nTest suite:\nFor each of the following parameter sets $(L,H,n)$, compute `[T_K, T_R, T_tot, r, within]`, where `within` is a boolean that is `True` if $T_{\\text{tot}}$ lies between $2.0\\,\\text{years}$ and $7.0\\,\\text{years}$ inclusive, and `False` otherwise.\n- Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$.\n- Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$.\n- Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$.\n- Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$.\n- Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of lists, one per test case, with each inner list containing five values `[T_K, T_R, T_tot, r, within]` in the order described above. The outer list must be enclosed in square brackets and the inner lists must be enclosed in square brackets, with entries comma-separated, for example: $[[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The problem is assessed to be valid. All data and conditions required for a unique and meaningful solution are provided or are standard, well-established theoretical results within the specified field. The problem is scientifically grounded in the theory of equatorial ocean dynamics, is well-posed, and is formulated objectively.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equations**: Linearized one-layer shallow-water equations on an equatorial beta-plane for a resting background state:\n    $$\n    \\frac{\\partial u}{\\partial t} - \\beta y v = -g \\frac{\\partial \\eta}{\\partial x}\n    $$\n    $$\n    \\frac{\\partial v}{\\partial t} + \\beta y u = -g \\frac{\\partial \\eta}{\\partial y}\n    $$\n    $$\n    \\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0\n    $$\n*   **Variables**:\n    *   $u, v$: zonal and meridional velocities\n    *   $\\eta$: free-surface displacement\n    *   $x, y, t$: longitude, latitude, time\n*   **Constants and Parameters**:\n    *   $g$: gravitational acceleration, $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$\n    *   $H$: equivalent depth of the baroclinic mode\n    *   $\\beta$: meridional derivative of the Coriolis parameter at the equator\n    *   $L$: zonal extent of the basin\n    *   $n$: meridional mode number for Rossby waves, $n \\in \\{1,2,\\dots\\}$\n    *   $T_{\\text{ref}}$: reference ENSO duration, $T_{\\text{ref}} = 3.5\\,\\text{years}$\n*   **Definitions**:\n    *   Long gravity wave speed: $c = \\sqrt{g H}$\n    *   Kelvin wave crossing time: $T_K = L/c$\n    *   Rossby wave return time: $T_R = L/\\lvert c_R \\rvert$\n    *   Total round-trip time: $T_{\\text{tot}} = T_K + T_R$\n    *   Ratio: $r = T_{\\text{tot}}/T_{\\text{ref}}$\n*   **Assumptions**:\n    *   Long-wave limit for equatorial Kelvin and Rossby waves.\n    *   The phase speed of the Rossby wave for meridional mode $n$ reduces to a constant westward value $\\lvert c_R \\rvert$ that scales with $c$ and $n$.\n*   **Unit Conversion**: $1\\,\\text{year} = 365 \\times 86400\\,\\text{s}$\n*   **Output Requirements**:\n    *   Times $T_K$, $T_R$, and $T_{\\text{tot}}$ in years, rounded to three decimal places.\n    *   Ratio $r$ as a float, rounded to three decimal places.\n    *   `within`: a boolean, `True` if $2.0 \\le T_{\\text{tot}} \\le 7.0\\,\\text{years}$, `False` otherwise.\n*   **Test Suite**:\n    *   Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$.\n    *   Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$.\n    *   Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$.\n    *   Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$.\n    *   Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific or Factual Unsoundness**: The problem is based on the linearized shallow-water equations on an equatorial beta-plane, a canonical model in physical oceanography for describing large-scale equatorial phenomena like Kelvin and Rossby waves, which are central to theories of ENSO such as the delayed oscillator mechanism. The assumptions are standard. The problem is scientifically sound.\n2.  **Non-Formalizable or Irrelevant**: The problem is a direct application of equatorial wave theory to a quantitative question about climate dynamics. It is formalizable and relevant.\n3.  **Incomplete or Contradictory Setup**: The problem does not explicitly provide the formula for the Rossby wave phase speed magnitude, $\\lvert c_R \\rvert$. However, it states that it is the long-wave limit for meridional mode $n$. In standard equatorial wave theory, this limit is a well-known result derivable from the full dispersion relation. The phase speed for long-wavelength equatorial Rossby waves of meridional mode $n$ is $c_R = -\\frac{c}{2n+1}$. The magnitude is thus $\\lvert c_R \\rvert = \\frac{c}{2n+1}$. It is a reasonable expectation in this context that this standard formula should be known and applied. With this, the problem is complete.\n4.  **Unrealistic or Infeasible**: The physical constants and parameter ranges are realistic for Earth's oceans and climate system. For example, a basin width of $1.5 \\times 10^7\\,\\text{m}$ is approximately the width of the Pacific Ocean. The equivalent depths for the first few baroclinic modes are typically in the range of $0.1$ to $1.0\\,\\text{m}$. The problem is physically plausible.\n5.  **Ill-Posed or Poorly Structured**: The tasks are clearly defined, and the inputs for each test case lead to a unique set of outputs. The problem is well-posed.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires applying fundamental physical principles to a non-trivial calculation that connects wave dynamics to climate phenomena, representing a classic problem in geophysical fluid dynamics. It is not trivial or tautological.\n7.  **Outside Scientific Verifiability**: The calculations are entirely verifiable through standard mathematical and physical procedures.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\n\nThe solution involves calculating the propagation times for equatorial Kelvin and Rossby waves across a specified basin, summing them to find a total round-trip time, and comparing this to a reference period for the El Niño–Southern Oscillation (ENSO). This is a simplified model often referred to as a \"delayed oscillator\" mechanism for ENSO, where the periodicity is set by wave transit times across the Pacific basin.\n\nThe fundamental quantities are derived from the given parameters for each case.\n\n1.  **Kelvin Wave Speed ($c$) and Crossing Time ($T_K$)**\n\n    The phase speed of long (non-dispersive) equatorial Kelvin waves is identical to the shallow-water gravity wave speed, $c$. This is given by:\n    $$\n    c = \\sqrt{g H}\n    $$\n    The time, $T_K$, for the Kelvin wave to cross the basin of width $L$ is:\n    $$\n    T_K = \\frac{L}{c} = \\frac{L}{\\sqrt{g H}}\n    $$\n\n2.  **Rossby Wave Speed ($\\lvert c_R \\rvert$) and Return Time ($T_R$)**\n\n    In the long-wave limit (small zonal wavenumber $k$), the dispersion relation for equatorial Rossby waves of meridional mode number $n \\ge 1$ simplifies to $\\omega \\approx -\\frac{ck}{2n+1}$. The phase speed, $c_R = \\omega/k$, is thus:\n    $$\n    c_R = -\\frac{c}{2n+1}\n    $$\n    The negative sign indicates westward propagation. The magnitude of the speed is:\n    $$\n    \\lvert c_R \\rvert = \\frac{c}{2n+1}\n    $$\n    The time, $T_R$, for the reflected Rossby wave to return across the basin is:\n    $$\n    T_R = \\frac{L}{\\lvert c_R \\rvert} = \\frac{L}{c/(2n+1)} = (2n+1) \\frac{L}{c}\n    $$\n    Notably, this can be expressed in terms of the Kelvin wave crossing time:\n    $$\n    T_R = (2n+1) T_K\n    $$\n\n3.  **Total Round-Trip Time ($T_{\\text{tot}}$)**\n\n    The total time for the signal to cross as a Kelvin wave and return as a Rossby wave is the sum of the individual transit times:\n    $$\n    T_{\\text{tot}} = T_K + T_R = T_K + (2n+1)T_K = (2n+2)T_K = 2(n+1)T_K\n    $$\n\n4.  **Ratio ($r$) and `within` Condition**\n\n    The ratio of the calculated round-trip time to the reference ENSO period is:\n    $$\n    r = \\frac{T_{\\text{tot}}}{T_{\\text{ref}}}\n    $$\n    The boolean value `within` is determined by checking if $T_{\\text{tot}}$ falls within the range $[2.0, 7.0]$ years.\n\nWe use the following constants for calculation:\n*   Gravitational acceleration: $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$\n*   Seconds per year: $1\\,\\text{year} = 365 \\times 86400\\,\\text{s} = 31,536,000\\,\\text{s}$\n*   Reference ENSO duration: $T_{\\text{ref}} = 3.5\\,\\text{years}$\n\nThe calculations for each test case are as follows:\n\n**Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$**\n*   $c = \\sqrt{9.81 \\times 0.5} \\approx 2.2147\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (2.2147\\,\\text{m/s}) \\approx 6.7728 \\times 10^6\\,\\text{s} \\approx 0.215\\,\\text{years}$\n*   $T_R = (2 \\cdot 1 + 1) T_K = 3 \\times 0.215\\,\\text{years} = 0.645\\,\\text{years}$ (recalculating from unrounded $T_K$ gives $0.644$ years)\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.215 + 0.644 = 0.859\\,\\text{years}$\n*   $r = 0.859 / 3.5 \\approx 0.245$\n*   `within` is $2.0 \\le 0.859 \\le 7.0$, which is `False`.\n*   Result: `[0.215, 0.644, 0.859, 0.245, False]`\n\n**Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$**\n*   $c = \\sqrt{9.81 \\times 0.3} \\approx 1.7155\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (1.7155\\,\\text{m/s}) \\approx 8.7438 \\times 10^6\\,\\text{s} \\approx 0.277\\,\\text{years}$\n*   $T_R = (2 \\cdot 1 + 1) T_K = 3 \\times 0.277\\,\\text{years} = 0.831\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.277 + 0.831 = 1.108\\,\\text{years}$\n*   $r = 1.108 / 3.5 \\approx 0.317$\n*   `within` is $2.0 \\le 1.108 \\le 7.0$, which is `False`.\n*   Result: `[0.277, 0.831, 1.108, 0.317, False]`\n\n**Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$**\n*   $c = \\sqrt{9.81 \\times 1.0} \\approx 3.1321\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (3.1321\\,\\text{m/s}) \\approx 4.7891 \\times 10^6\\,\\text{s} \\approx 0.152\\,\\text{years}$\n*   $T_R = (2 \\cdot 2 + 1) T_K = 5 \\times 0.152\\,\\text{years} = 0.760\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.152 + 0.760 = 0.912\\,\\text{years}$\n*   $r = 0.912 / 3.5 \\approx 0.261$\n*   `within` is $2.0 \\le 0.912 \\le 7.0$, which is `False`.\n*   Result: `[0.152, 0.760, 0.912, 0.261, False]`\n\n**Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$**\n*   $c = \\sqrt{9.81 \\times 0.2} \\approx 1.4007\\,\\text{m/s}$\n*   $T_K = (1.0 \\times 10^7\\,\\text{m}) / (1.4007\\,\\text{m/s}) \\approx 7.1392 \\times 10^6\\,\\text{s} \\approx 0.226\\,\\text{years}$\n*   $T_R = (2 \\cdot 3 + 1) T_K = 7 \\times 0.226\\,\\text{years} = 1.582\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.226 + 1.582 = 1.808\\,\\text{years}$\n*   $r = 1.808 / 3.5 \\approx 0.517$\n*   `within` is $2.0 \\le 1.808 \\le 7.0$, which is `False`.\n*   Result: `[0.226, 1.584, 1.810, 0.517, False]` (Re-running with higher precision gives slightly different rounded values).\n\n**Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$**\n*   $c = \\sqrt{9.81 \\times 0.05} \\approx 0.7004\\,\\text{m/s}$\n*   $T_K = (1.7 \\times 10^7\\,\\text{m}) / (0.7004\\,\\text{m/s}) \\approx 2.4273 \\times 10^7\\,\\text{s} \\approx 0.770\\,\\text{years}$\n*   $T_R = (2 \\cdot 2 + 1) T_K = 5 \\times 0.770\\,\\text{years} = 3.850\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.770 + 3.850 = 4.620\\,\\text{years}$\n*   $r = 4.620 / 3.5 \\approx 1.320$\n*   `within` is $2.0 \\le 4.620 \\le 7.0$, which is `True`.\n*   Result: `[0.770, 3.849, 4.619, 1.320, True]` (Re-running with higher precision gives slightly different rounded values).\n\nThe code in the `<final_answer>` section will perform these calculations precisely and format the output as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes equatorial wave transit times and their relation to ENSO periodicity.\n    \"\"\"\n    # Physical constants and reference values\n    g = 9.81  # Gravitational acceleration, m/s^2\n    T_ref_years = 3.5  # Reference ENSO duration, years\n    seconds_per_year = 365 * 86400  # Conversion factor\n\n    # Test suite: (L, H, n)\n    test_cases = [\n        (1.5e7, 0.5, 1),   # Case A\n        (1.5e7, 0.3, 1),   # Case B\n        (1.5e7, 1.0, 2),   # Case C\n        (1.0e7, 0.2, 3),   # Case D\n        (1.7e7, 0.05, 2),  # Case E\n    ]\n\n    all_results = []\n    \n    for L, H, n in test_cases:\n        # Step 1: Calculate Kelvin wave speed and crossing time\n        # c = sqrt(g * H)\n        # T_K = L / c\n        c = np.sqrt(g * H)\n        T_K_seconds = L / c\n        T_K_years = T_K_seconds / seconds_per_year\n        \n        # Step 2: Calculate Rossby wave return time\n        # The phase speed of a long Rossby wave is c_R = c / (2n + 1).\n        # T_R = L / c_R = L / (c / (2n + 1)) = (2n + 1) * (L / c) = (2n + 1) * T_K\n        T_R_seconds = (2 * n + 1) * T_K_seconds\n        T_R_years = T_R_seconds / seconds_per_year\n\n        # Step 3: Calculate total round-trip time\n        T_tot_years = T_K_years + T_R_years\n\n        # Step 4: Calculate the ratio to the reference ENSO period\n        r = T_tot_years / T_ref_years\n\n        # Step 5: Check if the total time is within the typical ENSO range\n        is_within = 2.0 = T_tot_years = 7.0\n        \n        # Round results to three decimal places as required\n        T_K_rounded = round(T_K_years, 3)\n        T_R_rounded = round(T_R_years, 3)\n        T_tot_rounded = round(T_tot_years, 3)\n        r_rounded = round(r, 3)\n        \n        # Collect the results for this case\n        case_result = [T_K_rounded, T_R_rounded, T_tot_rounded, r_rounded, is_within]\n        all_results.append(case_result)\n\n    # Format the final output string exactly as required: [[...],[...],...]\n    inner_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Before we can evaluate a climate model's depiction of ENSO, we must first translate its raw output—like sea surface temperature—into standardized, meaningful indices. This practical exercise guides you through the essential data processing steps used by climate scientists to compute the Niño3.4 and Oceanic Niño Index (ONI) . You will discover how crucial methodological choices, such as the climatological base period and the treatment of long-term trends, can significantly influence our assessment of ENSO variability.",
            "id": "4038452",
            "problem": "Consider a one-dimensional, monthly, area-averaged sea surface temperature (SST) time series representative of the Niño3.4 region, intended to emulate El Niño–Southern Oscillation (ENSO) variability in a numerical climate model. The time series spans $N = 480$ consecutive months (i.e., $40$ years). Let the month index be $t \\in \\{0,1,2,\\dots,479\\}$, the corresponding year index be $y(t) = t/12$, and the calendar month index be $m(t) = t \\bmod 12$. The synthetic SST is defined by the deterministic signal\n$$\nS(t) = 27 + 0.02 \\, y(t) + 0.5 \\cos\\left(\\frac{2\\pi m(t)}{12}\\right) + 0.9 \\sin\\left(\\frac{2\\pi t}{48}\\right) + 0.3 \\sin\\left(\\frac{2\\pi t}{96}\\right),\n$$\nwhere all trigonometric arguments are in radians, and $S(t)$ is in degrees Celsius.\n\nYou are to compute, for various processing choices, two indices:\n- The Niño3.4 monthly anomaly index $A(t)$: defined as the SST anomaly relative to a base-period monthly climatology. For a chosen base period spanning inclusive integer years $Y_{\\min}$ to $Y_{\\max}$, the monthly climatology $C(j)$ for calendar month $j \\in \\{0,1,\\dots,11\\}$ is defined by\n$$\nC(j) = \\frac{1}{|\\mathcal{B}_j|} \\sum_{t \\in \\mathcal{B}_j} S^{\\ast}(t),\n\\quad \\text{where} \\quad\n\\mathcal{B}_j = \\{ t \\;|\\; Y_{\\min} \\le \\lfloor t/12 \\rfloor + 1 \\le Y_{\\max}, \\; t \\bmod 12 = j \\},\n$$\nand $S^{\\ast}(t)$ is either the original $S(t)$ or the linearly detrended version of $S(t)$ according to the detrending choice. The anomaly is then\n$$\nA(t) = S^{\\ast}(t) - C\\big(m(t)\\big).\n$$\n\n- The Oceanic Niño Index (ONI): defined here as the $3$-month centered running mean of the Niño3.4 anomaly,\n$$\n\\mathrm{ONI}(t) = \\frac{A(t-1) + A(t) + A(t+1)}{3},\n$$\nfor $t \\in \\{1, 2, \\dots, 478\\}$.\n\nThe linearly detrended series $S^{\\ast}(t)$ is constructed by removing the best-fit linear trend from $S(t)$ over the full time span, that is,\n$$\nS^{\\ast}(t) = S(t) - \\left(\\hat{\\alpha} + \\hat{\\beta} \\, t \\right),\n$$\nwhere $(\\hat{\\alpha}, \\hat{\\beta})$ are the ordinary least squares coefficients obtained by minimizing\n$$\n\\sum_{t=0}^{479} \\left[ S(t) - \\left(\\alpha + \\beta t \\right) \\right]^2.\n$$\n\nYour task is to implement these definitions and, for each specified test case, compute two quantitative diagnostics that measure the impact of the climatology period choice and detrending:\n- The root-mean-square (RMS) difference between two Niño3.4 anomaly series $A_1(t)$ and $A_2(t)$,\n$$\nD_{\\mathrm{N34}} = \\sqrt{\\frac{1}{N} \\sum_{t=0}^{N-1} \\left( A_1(t) - A_2(t) \\right)^2 }.\n$$\n- The root-mean-square (RMS) difference between the corresponding ONI series, defined over the valid interior months,\n$$\nD_{\\mathrm{ONI}} = \\sqrt{\\frac{1}{N-2} \\sum_{t=1}^{N-2} \\left( \\mathrm{ONI}_1(t) - \\mathrm{ONI}_2(t) \\right)^2 }.\n$$\n\nAll differences must be expressed in degrees Celsius and returned as decimal numbers.\n\nImplement the following test suite, where each test case specifies two processing configurations to be compared. Each configuration is a tuple (`Y_min`, `Y_max`, `detrend`), where `detrend` is a boolean indicating whether linear detrending is performed before computing the monthly climatology and anomalies:\n\n- Test case $1$ (general comparison across $30$-year periods without detrending):\n    - Configuration $A$: (1, 30, `False`)\n    - Configuration $B$: (11, 40, `False`)\n\n- Test case $2$ (general comparison across $30$-year periods with detrending):\n    - Configuration $A$: (1, 30, `True`)\n    - Configuration $B$: (11, 40, `True`)\n\n- Test case $3$ (boundary case comparing full-record climatology to a recent $30$-year period, no detrending):\n    - Configuration $A$: (1, 40, `False`)\n    - Configuration $B$: (11, 40, `False`)\n\n- Test case $4$ (edge case with short $3$-year base periods, no detrending):\n    - Configuration $A$: (1, 3, `False`)\n    - Configuration $B$: (11, 13, `False`)\n\n- Test case $5$ (sensitivity to reference years: two $10$-year windows shifted by $2$ years, with detrending):\n    - Configuration $A$: (16, 25, `True`)\n    - Configuration $B$: (18, 27, `True`)\n\nFor each test case, compute $D_{\\mathrm{N34}}$ and $D_{\\mathrm{ONI}}$ in degrees Celsius. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list $[D_{\\mathrm{N34}}, D_{\\mathrm{ONI}}]$ corresponding to a test case, for example, $[[d_{11}, d_{12}], [d_{21}, d_{22}], \\dots]$. Trigonometric functions must use radians. All outputs must be expressed in degrees Celsius as decimal numbers (no percentage signs). Angles must be treated in radians if used directly in any trigonometric computation.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and fully specified. It presents a stylized but realistic time series analysis task common in climate science, with all terms and procedures defined through precise mathematical formulas. The solution proceeds by implementing these definitions directly.\n\nThe overall algorithmic design follows a structured, multi-step process. First, the foundational synthetic sea surface temperature (SST) time series, $S(t)$, and its linearly detrended version are pre-computed. Then, for each specified test case, two sets of diagnostic indices are calculated based on two distinct processing configurations. Finally, the root-mean-square (RMS) differences between these sets of indices are computed and reported.\n\n_**1. Time Series Generation and Detrending**_\n\nThe analysis begins by generating the synthetic SST series $S(t)$ for a total of $N = 480$ months, indexed by $t \\in \\{0, 1, \\dots, 479\\}$. The series is defined by the formula:\n$$\nS(t) = 27 + 0.02 \\, y(t) + 0.5 \\cos\\left(\\frac{2\\pi m(t)}{12}\\right) + 0.9 \\sin\\left(\\frac{2\\pi t}{48}\\right) + 0.3 \\sin\\left(\\frac{2\\pi t}{96}\\right)\n$$\nwhere $y(t) = t/12$ is the year index as a continuous variable and $m(t) = t \\bmod 12$ is the calendar month index. This is implemented by creating a time vector for $t$ from $0$ to $479$ and applying the formula in a vectorized manner.\n\nNext, the linearly detrended series, $S^{\\ast}(t)$, is computed. This requires finding the ordinary least squares (OLS) coefficients $(\\hat{\\alpha}, \\hat{\\beta})$ that minimize the sum of squared residuals $\\sum_{t=0}^{N-1} [ S(t) - (\\alpha + \\beta t) ]^2$. This is a standard linear regression problem. The coefficients are determined by fitting a first-degree polynomial to the full $S(t)$ series over $t \\in \\{0, \\dots, 479\\}$. The resulting linear trend, $\\hat{L}(t) = \\hat{\\alpha} + \\hat{\\beta}t$, is then subtracted from the original series to yield the detrended series:\n$$\nS^{\\ast}(t) = S(t) - (\\hat{\\alpha} + \\hat{\\beta} t)\n$$\nThis detrended series is pre-computed and stored for use in test cases that require it.\n\n_**2. Anomaly and Oceanic Niño Index (ONI) Calculation**_\n\nFor each configuration $(Y_{\\min}, Y_{\\max}, \\mathrm{detrend})$ specified in a test case, the Niño3.4 anomaly series $A(t)$ and the Oceanic Niño Index (ONI) are computed. This process involves three sub-steps:\n\n-   **Series Selection**: Based on the boolean `detrend` flag, the appropriate time series is chosen for analysis. If `detrend` is true, the pre-computed detrended series $S^{\\ast}(t)$ is used. Otherwise, the original series $S(t)$ is used. Let's denote the chosen series as $S_{analysis}(t)$.\n\n-   **Climatology Calculation**: The monthly climatology, $C(j)$ for each calendar month $j \\in \\{0, \\dots, 11\\}$, is calculated over a specific base period defined by the start year $Y_{\\min}$ and end year $Y_{\\max}$. The year for a given month index $t$ is defined as $\\lfloor t/12 \\rfloor + 1$. The set of time indices $\\mathcal{B}_j$ used to compute the climatology for month $j$ consists of all $t$ such that $t \\bmod 12 = j$ and $\\lfloor t/12 \\rfloor + 1$ is within the range $[Y_{\\min}, Y_{\\max}]$. The climatology is the arithmetic mean of $S_{analysis}(t)$ for all $t \\in \\mathcal{B}_j$:\n    $$\n    C(j) = \\frac{1}{|\\mathcal{B}_j|} \\sum_{t \\in \\mathcal{B}_j} S_{analysis}(t)\n    $$\n    This is implemented by first creating a boolean mask to identify all time steps within the specified years, and then for each month $j$, taking the intersection with a mask for that month and computing the mean.\n\n-   **Anomaly and ONI Calculation**: The Niño3.4 monthly anomaly series $A(t)$ is computed by subtracting the corresponding monthly climatology from the analysis series:\n    $$\n    A(t) = S_{analysis}(t) - C\\big(m(t)\\big)\n    $$\n    The climatology vector $C(j)$ is effectively broadcast across the entire time series according to the calendar month $m(t)$ of each point. The ONI is then calculated as the $3$-month centered running mean of $A(t)$:\n    $$\n    \\mathrm{ONI}(t) = \\frac{A(t-1) + A(t) + A(t+1)}{3}, \\quad t \\in \\{1, \\dots, N-2\\}\n    $$\n    This operation is efficiently performed using a one-dimensional convolution with a kernel of $[\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}]$ and a 'valid' mode, which naturally handles the boundary conditions, producing a series of length $N-2$.\n\n_**3. RMS Difference Calculation**_\n\nFor each test case, the procedure above is executed twice: once for configuration $A$ to produce series $A_1(t)$ and $\\mathrm{ONI}_1(t)$, and once for configuration $B$ to produce $A_2(t)$ and $\\mathrm{ONI}_2(t)$. The final step is to quantify the difference between these two outcomes using two RMS metrics.\n\n-   The RMS difference for the Niño3.4 anomaly series, $D_{\\mathrm{N34}}$, is calculated over the full time span $N=480$:\n    $$\n    D_{\\mathrm{N34}} = \\sqrt{\\frac{1}{N} \\sum_{t=0}^{N-1} \\left( A_1(t) - A_2(t) \\right)^2 }\n    $$\n-   The RMS difference for the ONI series, $D_{\\mathrm{ONI}}$, is calculated over the $N-2$ valid interior months:\n    $$\n    D_{\\mathrm{ONI}} = \\sqrt{\\frac{1}{N-2} \\sum_{t=1}^{N-2} \\left( \\mathrm{ONI}_1(t) - \\mathrm{ONI}_2(t) \\right)^2 }\n    $$\nThese calculations are performed using vectorized operations for efficiency. The pair of results $[D_{\\mathrm{N34}}, D_{\\mathrm{ONI}}]$ for each test case is collected, formatted into a string representation of a list of lists without spaces, and printed as the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes diagnostics for synthetic ENSO time series analysis based on\n    different processing choices for climatology and detrending.\n    \"\"\"\n    # Define problem constants\n    N = 480\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: 30-year periods, no detrending\n        {'A': (1, 30, False), 'B': (11, 40, False)},\n        # Case 2: 30-year periods, with detrending\n        {'A': (1, 30, True),  'B': (11, 40, True)},\n        # Case 3: Full-record vs 30-year, no detrending\n        {'A': (1, 40, False), 'B': (11, 40, False)},\n        # Case 4: Short 3-year periods, no detrending\n        {'A': (1, 3, False),  'B': (11, 13, False)},\n        # Case 5: Shifted 10-year periods, with detrending\n        {'A': (16, 25, True), 'B': (18, 27, True)},\n    ]\n\n    # Pre-compute time vectors and indices\n    t_vec = np.arange(N, dtype=float)\n    y_vec = t_vec / 12.0\n    m_vec = (t_vec % 12).astype(int)\n    year_indices = np.floor(t_vec / 12) + 1\n\n    # Generate the synthetic SST time series S(t)\n    S_vec = (27.0 + \n             0.02 * y_vec + \n             0.5 * np.cos(2 * np.pi * m_vec / 12.0) + \n             0.9 * np.sin(2 * np.pi * t_vec / 48.0) +\n             0.3 * np.sin(2 * np.pi * t_vec / 96.0))\n\n    # Compute the single linearly detrended version of the series S*(t)\n    # The trend is removed over the full time span\n    beta_hat, alpha_hat = np.polyfit(t_vec, S_vec, 1)\n    trend = alpha_hat + beta_hat * t_vec\n    S_detrended_vec = S_vec - trend\n\n    def get_indices(config, S_original, S_detrended):\n        \"\"\"\n        Computes the Niño3.4 anomaly and ONI series for a given configuration.\n        \"\"\"\n        Y_min, Y_max, use_detrend = config\n        \n        # 1. Select the source SST series (original or detrended)\n        S_star = S_detrended if use_detrend else S_original\n\n        # 2. Compute the monthly climatology C(j) over the base period\n        base_period_mask = (year_indices >= Y_min)  (year_indices = Y_max)\n        climatology = np.zeros(12)\n        for j in range(12):\n            month_mask = (m_vec == j)\n            # Combine masks to find all time indices for this month in the base period\n            climatology_mask = base_period_mask  month_mask\n            if np.any(climatology_mask):\n                climatology[j] = np.mean(S_star[climatology_mask])\n            # else remains 0, though problem setup ensures this won't happen.\n\n        # 3. Compute the anomaly series A(t)\n        C_broadcasted = climatology[m_vec]\n        A_series = S_star - C_broadcasted\n\n        # 4. Compute the ONI series (3-month centered running mean of A(t))\n        # np.convolve with 'valid' mode correctly computes the running mean\n        # for interior points t=1..N-2.\n        ONI_series = np.convolve(A_series, np.ones(3) / 3.0, mode='valid')\n        \n        return A_series, ONI_series\n\n    all_results = []\n    for case in test_cases:\n        config_A = case['A']\n        config_B = case['B']\n\n        # Generate anomaly and ONI series for both configurations\n        A1, ONI1 = get_indices(config_A, S_vec, S_detrended_vec)\n        A2, ONI2 = get_indices(config_B, S_vec, S_detrended_vec)\n\n        # Compute D_N34: RMS difference between anomaly series\n        # np.mean correctly divides by N\n        D_N34 = np.sqrt(np.mean((A1 - A2)**2))\n\n        # Compute D_ONI: RMS difference between ONI series\n        # np.mean correctly divides by N-2, the length of the ONI series\n        D_ONI = np.sqrt(np.mean((ONI1 - ONI2)**2))\n\n        all_results.append([D_N34, D_ONI])\n\n    # Format the final output string exactly as specified: [[d1,d2],[d3,d4],...]\n    result_strings = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}