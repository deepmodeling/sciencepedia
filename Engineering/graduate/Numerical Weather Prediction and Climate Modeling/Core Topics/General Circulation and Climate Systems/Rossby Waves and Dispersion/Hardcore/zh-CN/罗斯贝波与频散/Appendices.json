{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习将探讨地球自转梯度（即 $\\beta$ 效应）的一个基本推论。通过推导一个孤立涡旋的漂移速度，你将揭示大尺度大气和海洋动力学中标志性的西向传播趋势。这个练习旨在加强你应用准地转位涡方程和积分守恒定律解决问题的能力。",
            "id": "4083972",
            "problem": "考虑一个由准地转 (QG) 位涡方程控制的二维、无界、中纬度 beta 平面。设扰动位涡 $q'(x,y,t)$ 和流函数 $\\psi(x,y,t)$ 满足以下演化定律\n$$\nq'_{t} + J(\\psi, q' + \\beta y) = 0,\n$$\n以及线性可逆关系\n$$\nq' = \\nabla^{2} \\psi - \\frac{\\psi}{R_{d}^{2}},\n$$\n其中 $\\beta  0$ 是科里奥利参数的经向梯度，$R_{d}  0$ 是（第一斜压模）变形半径，而 $J(a,b) = a_{x} b_{y} - a_{y} b_{x}$ 是雅可比行列式。\n\n假设一个局地单极异常初始给定为\n$$\nq'(x,y,0) = Q_{0} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{L^{2}}\\right),\n$$\n其中 $Q_{0}$ 为实数且 $L  0$。假设经过快速调整后，该异常以速度 $U$ 沿纬向方向稳定平移且形状不变，因此在随动坐标系中，各场在主导阶上是定常的。请仅从上述控制定律出发（不允许使用任何额外的简化公式），推导 $U$ 的可解性条件，并用它来获得纬向漂移速度 $U$ 关于 $\\beta$ 和 $R_{d}$ 的精确解析表达式。\n\n你的最终答案必须是单一的闭式解析表达式。不要在最终的方框答案中包含任何单位。",
            "solution": "该问题要求解在一个由准地转 (QG) 位涡方程控制的中纬度 beta 平面上，一个稳定平移的位涡异常的纬向漂移速度 $U$。\n\n### 步骤 1：问题验证\n问题陈述的验证如下：\n\n*   **逐字提取的已知条件：**\n    *   控制方程：$q'_{t} + J(\\psi, q' + \\beta y) = 0$\n    *   可逆关系：$q' = \\nabla^{2} \\psi - \\frac{\\psi}{R_{d}^{2}}$\n    *   参数：$\\beta  0$，$R_{d}  0$\n    *   雅可比行列式定义：$J(a,b) = a_{x} b_{y} - a_{y} b_{x}$\n    *   异常的初始条件：$q'(x,y,0) = Q_{0} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{L^{2}}\\right)$，其中 $Q_0$ 为实数且 $L0$。\n    *   假设：该异常以速度 $U$ 沿纬向方向稳定平移且形状不变。\n\n*   **使用提取的已知条件进行验证：**\n    1.  **科学依据：** 该问题使用 beta 平面上的标准 QG 位涡方程，这是动力气象学和海洋学中的一个基本模型。所有组成部分在该领域内都是公认的。\n    2.  **适定性：** 问题旨在求解一种特殊类型解（孤立波）的速度。对于给定的结构，这种速度的存在性和唯一性是一个适定的数学问题。\n    3.  **客观性：** 问题以精确的数学术语陈述，没有主观性。\n    4.  **完整性和一致性：** 问题是自洽的。稳定平移的假设与初始形状相结合，为确定速度 $U$ 提供了足够的约束条件。\n\n*   **结论：** 问题是有效的。我们可以继续进行求解。\n\n### 步骤 2：漂移速度的推导\n\n我们从 QG 位涡方程开始：\n$$\n\\frac{\\partial q'}{\\partial t} + J(\\psi, q' + \\beta y) = 0\n$$\n展开雅可比项，$J(\\psi, q' + \\beta y) = J(\\psi, q') + J(\\psi, \\beta y)$。第二部分是 $J(\\psi, \\beta y) = \\frac{\\partial \\psi}{\\partial x}\\frac{\\partial(\\beta y)}{\\partial y} - \\frac{\\partial \\psi}{\\partial y}\\frac{\\partial(\\beta y)}{\\partial x} = \\beta \\frac{\\partial \\psi}{\\partial x}$。方程变为：\n$$\n\\frac{\\partial q'}{\\partial t} + J(\\psi, q') + \\beta \\frac{\\partial \\psi}{\\partial x} = 0\n$$\n给定解以速度 $U$ 沿纬向稳定平移。这意味着场 $q'$ 和 $\\psi$ 是 $\\xi = x - Ut$ 和 $\\eta = y$ 的函数。所以，$q'(x,y,t) = q'(\\xi, \\eta)$ 且 $\\psi(x,y,t) = \\psi(\\xi, \\eta)$。链式法则给出了偏导数的变换关系：\n$\\frac{\\partial}{\\partial t} = -U \\frac{\\partial}{\\partial \\xi}$，$\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial \\xi}$，以及 $\\frac{\\partial}{\\partial y} = \\frac{\\partial}{\\partial \\eta}$。\n\n将这些代入 QG 方程，我们得到随动坐标系 $(\\xi, \\eta)$ 中的稳态方程：\n$$\n-U \\frac{\\partial q'}{\\partial \\xi} + J(\\psi, q') + \\beta \\frac{\\partial \\psi}{\\partial \\xi} = 0\n$$\n其中雅可比行列式现在是关于 $(\\xi, \\eta)$ 的：$J(\\psi, q') = \\frac{\\partial \\psi}{\\partial \\xi}\\frac{\\partial q'}{\\partial \\eta} - \\frac{\\partial \\psi}{\\partial \\eta}\\frac{\\partial q'}{\\partial \\xi}$。\n\n为了找到 $U$ 的可解性条件，我们推导一个积分约束。我们将稳态方程乘以 $\\xi$ 并在整个平面 $\\mathbb{R}^2$ 上积分：\n$$\n\\iint_{\\mathbb{R}^2} \\left( \\xi J(\\psi, q') + \\xi \\beta \\frac{\\partial \\psi}{\\partial \\xi} - \\xi U \\frac{\\partial q'}{\\partial \\xi} \\right) d\\xi d\\eta = 0\n$$\n我们分别分析每一项。对于一个局地异常，$\\psi$、$q'$ 及其导数在无穷远处消失。\n\n*   **第一项：** $\\iint \\xi J(\\psi, q') d\\xi d\\eta$。\n    对于在无穷远处衰减的函数，使用恒等式 $\\iint f J(g, h) d A = \\iint h J(f, g) d A$，我们令 $f=\\xi$，$g=\\psi$，$h=q'$。\n    $$\n    \\iint \\xi J(\\psi, q') d\\xi d\\eta = \\iint q' J(\\xi, \\psi) d\\xi d\\eta\n    $$\n    雅可比行列式 $J(\\xi, \\psi) = \\frac{\\partial \\xi}{\\partial \\xi}\\frac{\\partial \\psi}{\\partial \\eta} - \\frac{\\partial \\xi}{\\partial \\eta}\\frac{\\partial \\psi}{\\partial \\xi} = 1 \\cdot \\frac{\\partial \\psi}{\\partial \\eta} - 0 \\cdot \\frac{\\partial \\psi}{\\partial \\xi} = \\frac{\\partial \\psi}{\\partial \\eta}$。\n    所以，第一项是 $\\iint q' \\frac{\\partial \\psi}{\\partial \\eta} d\\xi d\\eta$。\n\n*   **第二项：** $\\beta \\iint \\xi \\frac{\\partial \\psi}{\\partial \\xi} d\\xi d\\eta$。\n    我们关于 $\\xi$ 进行分部积分：\n    $$\n    \\beta \\int_{-\\infty}^{\\infty} \\left( \\int_{-\\infty}^{\\infty} \\xi \\frac{\\partial \\psi}{\\partial \\xi} d\\xi \\right) d\\eta = \\beta \\int_{-\\infty}^{\\infty} \\left( [\\xi \\psi]_{\\xi=-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} \\psi d\\xi \\right) d\\eta\n    $$\n    由于 $\\psi \\to 0$ 在无穷远处，边界项 $[\\xi \\psi]$ 消失。该项变为 $-\\beta \\iint \\psi d\\xi d\\eta$。\n\n*   **第三项：** $-U \\iint \\xi \\frac{\\partial q'}{\\partial \\xi} d\\xi d\\eta$。\n    类似地，关于 $\\xi$ 进行分部积分得到 $U \\iint q' d\\xi d\\eta$。\n\n合并各项，积分约束为：\n$$\n\\iint q' \\frac{\\partial \\psi}{\\partial \\eta} d\\xi d\\eta - \\beta \\iint \\psi d\\xi d\\eta + U \\iint q' d\\xi d\\eta = 0\n$$\n现在，我们利用异常的结构。它最初是一个轴对称高斯函数，$q'(x,y,0) = Q_{0} \\exp(-(x^2+y^2)/L^2)$。由于它平移时形状不变，其在随动坐标系中的形式为 $q'(\\xi,\\eta) = Q_{0} \\exp(-(\\xi^2+\\eta^2)/L^2)$。此函数关于随动坐标系的原点是轴对称的。令 $\\rho = \\sqrt{\\xi^2+\\eta^2}$。则 $q' = q'(\\rho)$。\n\n可逆关系 $q' = \\nabla^2 \\psi - \\psi/R_d^2$ 是一个线性的、各向同性的微分方程（一个修正的亥姆霍兹方程）。一个轴对称强迫 $q'(\\rho)$ 将产生一个轴对称的流函数 $\\psi(\\rho)$。\n当 $\\psi = \\psi(\\rho)$ 时，关于 $\\eta$ 的导数是 $\\frac{\\partial \\psi}{\\partial \\eta} = \\frac{d\\psi}{d\\rho}\\frac{\\partial \\rho}{\\partial \\eta} = \\frac{d\\psi}{d\\rho}\\frac{\\eta}{\\rho}$。\n我们约束条件中的第一个积分变为：\n$$\n\\iint q'(\\rho) \\frac{d\\psi}{d\\rho}\\frac{\\eta}{\\rho} d\\xi d\\eta\n$$\n被积函数是 $\\eta$ 的奇函数，且积分域 $\\mathbb{R}^2$ 关于 $\\xi$ 轴对称。因此，这个积分为零。\n\n积分约束简化为：\n$$\n-\\beta \\iint \\psi d\\xi d\\eta + U \\iint q' d\\xi d\\eta = 0\n$$\n接下来，我们将 $\\psi$ 的积分与 $q'$ 的积分联系起来。我们在整个平面上对可逆关系进行积分：\n$$\n\\iint q' d\\xi d\\eta = \\iint \\left( \\nabla^2\\psi - \\frac{\\psi}{R_d^2} \\right) d\\xi d\\eta\n$$\n拉普拉斯项的积分可以使用散度定理转换为边界积分：$\\iint \\nabla^2\\psi d A = \\oint \\nabla\\psi \\cdot \\mathbf{n} ds$。由于 $\\psi$ 及其梯度在无穷远处消失，该积分为零。\n因此，我们有以下关系：\n$$\n\\iint q' d\\xi d\\eta = -\\frac{1}{R_d^2} \\iint \\psi d\\xi d\\eta \\quad \\implies \\quad \\iint \\psi d\\xi d\\eta = -R_d^2 \\iint q' d\\xi d\\eta\n$$\n令 $I_{q'} = \\iint q' d\\xi d\\eta$。由于初始异常是一个非平凡的高斯函数（$Q_0 \\ne 0$，$L0$），$I_{q'}$ 非零。具体来说，$I_{q'} = Q_0 \\pi L^2 \\ne 0$。\n将此关系代入简化的积分约束中，我们得到：\n$$\n-\\beta \\left(-R_d^2 \\iint q' d\\xi d\\eta\\right) + U \\iint q' d\\xi d\\eta = 0\n$$\n$$\n(\\beta R_d^2 + U) \\iint q' d\\xi d\\eta = 0\n$$\n这是 $U$ 的可解性条件。由于 $\\iint q' d\\xi d\\eta \\neq 0$，括号中的项必须为零：\n$$\n\\beta R_d^2 + U = 0\n$$\n解出 $U$，我们找到纬向漂移速度的精确表达式：\n$$\nU = -\\beta R_d^2\n$$\n这个结果表明，beta 平面上的一个局地的、轴对称的 QG 涡旋必须以等于线性罗斯贝波（Rossby waves）最大相速（即无限长波的速度）的速度向西漂移。这个特定的速度可以防止涡旋以罗斯贝波尾迹的形式辐射能量，从而使其能够保持其形状。",
            "answer": "$$\n\\boxed{-\\beta R_{d}^{2}}\n$$"
        },
        {
            "introduction": "在基本动力学的基础上，本问题研究罗斯贝波如何在背景属性（特别是科里奥利参数）随纬度变化的介质中传播。你将应用 Wentzel-Kramers-Brillouin (WKB) 近似这一强大工具来分析非均匀介质中的波，并确定波包在何处被反射。此练习阐释了行星尺度上的波折射和波导形成的概念。",
            "id": "4083957",
            "problem": "考虑在一个旋转球体上，由准地转（QG）位涡控制的小振幅正压扰动。设基本态为均匀的纬向平均流 $U$（向东且不随纬度变化），并在与球体相切的局部笛卡尔坐标系 $(x,y)$ 中进行计算，其中 $x$ 指向东，$y$ 指向北，且 $y = a \\,\\phi$，这里 $a$ 是行星半径，$\\phi$ 是纬度。科里奥利参数为 $f(\\phi) = 2 \\Omega \\sin \\phi$，其中 $\\Omega$ 是行星自转速率，因此行星涡度的经向梯度为 $\\beta(\\phi) = \\partial f/\\partial y = (2 \\Omega/a)\\cos \\phi$。假设 Wentzel–Kramers–Brillouin（WKB）近似成立：寻求形式为 $\\psi'(x,y,t) = \\Re\\{A(y)\\exp[i(k x + \\int^{y} \\ell(\\eta)\\,d\\eta - \\omega t)]\\}$ 的波场，其中振幅 $A(y)$ 和经向波数 $\\ell(y)$ 随 $y$ 缓慢变化，而纬向波数 $k$ 和频率 $\\omega$ 因背景场的纬向对称性和定常性而不随 $y$ 变化。\n\n仅从此缓慢变化的背景场上的线性化正压QG位涡方程和上述WKB拟设出发，推导 $\\omega$、$k$、$\\ell$ 和 $\\beta(\\phi)$ 之间的局地主阶关系，并用它来获得经向传播停止时的转向纬度 $\\phi_{t}$ 的条件（即经向波数满足 $\\ell^{2}(\\phi_{t})=0$ 的地方）。\n\n在地球上，取 $a = 6.371 \\times 10^{6}$，$\\Omega = 7.292115 \\times 10^{-5}$，以及均匀的基本纬向流 $U = 15$。在参考纬度 $\\phi_{0} = 30^{\\circ}$ 处，观测到一个波包的纬向波数为 $k = 2.0 \\times 10^{-6}$，经向波数大小为 $\\ell_{0} = 1.0 \\times 10^{-6}$。假设波频率 $\\omega$ 和纬向波数 $k$ 沿着经向射线保持不变，根据你推导出的条件确定北转向纬度 $\\phi_{t}$。\n\n用度数表示 $\\phi_{t}$ 的最终答案。将你的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于已建立的准地转动力学理论，问题提法良好，提供了足够的信息以获得唯一解，并且使用客观、正式的语言陈述。\n\n出发点是均匀纬向流 $U$ 上扰动的线性化正压准地转（QG）位涡（PV）方程。总流函数为 $\\Psi_{total} = -Uy + \\psi'(x,y,t)$。线性化 QG PV 方程为：\n$$\n\\left(\\frac{\\partial}{\\partial t} + U \\frac{\\partial}{\\partial x}\\right)\\nabla^{2}\\psi' + \\beta(y) \\frac{\\partial \\psi'}{\\partial x} = 0\n$$\n这里，$\\psi'(x,y,t)$ 是扰动流函数，$\\nabla^{2} = \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}$ 是拉普拉斯算子，$\\beta(y) = \\frac{df}{dy}$ 是科里奥利参数 $f$ 的经向梯度。对于球体，有 $y = a\\phi$，我们得到 $\\beta(\\phi) = \\frac{1}{a}\\frac{df}{d\\phi} = \\frac{1}{a}\\frac{d}{d\\phi}(2\\Omega\\sin\\phi) = \\frac{2\\Omega}{a}\\cos\\phi$。\n\n我们使用 Wentzel–Kramers–Brillouin（WKB）近似来寻求一个波解。扰动流函数的形式为：\n$$\n\\psi'(x,y,t) = \\Re\\left\\{A(y)\\exp\\left[i\\left(k x + \\int^{y} \\ell(\\eta)\\,d\\eta - \\omega t\\right)\\right]\\right\\}\n$$\n我们处理其复数形式 $\\Psi(y,t) = A(y)\\exp[i(k x + \\Theta(y) - \\omega t)]$，其中 $\\Theta(y) = \\int^{y} \\ell(\\eta)\\,d\\eta$。经向波数为 $\\ell(y) = \\frac{d\\Theta}{dy}$。WKB 近似假设振幅 $A(y)$ 和波数 $\\ell(y)$ 随 $y$ 缓慢变化。这意味着它们的导数与局地波尺度相比很小。\n\n我们计算 $\\Psi$ 的必要导数：\n$$\n\\frac{\\partial \\Psi}{\\partial t} = -i\\omega\\Psi\n$$\n$$\n\\frac{\\partial \\Psi}{\\partial x} = ik\\Psi\n$$\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial x^{2}} = -k^{2}\\Psi\n$$\n对于 $y$ 方向的导数：\n$$\n\\frac{\\partial \\Psi}{\\partial y} = \\frac{dA}{dy}\\exp[i(\\dots)] + A(y) (i \\ell(y)) \\exp[i(\\dots)] = \\left(\\frac{A'}{A} + i\\ell\\right)\\Psi\n$$\n其中 $A' = dA/dy$。二阶导数为：\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}\\left[\\left(\\frac{A'}{A} + i\\ell\\right)\\Psi\\right] = \\left[\\frac{d}{dy}\\left(\\frac{A'}{A} + i\\ell\\right) + \\left(\\frac{A'}{A} + i\\ell\\right)^{2}\\right]\\Psi\n$$\nWKB 近似的核心是 $\\ell$ 很大且变化缓慢，因此 $|\\ell| \\gg |A'/A|$、 $|\\ell'| \\ll \\ell^2$ 和 $|A''/A| \\ll \\ell^2$。只保留最高阶项，我们得到：\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial y^{2}} \\approx (i\\ell)^{2}\\Psi = -\\ell^{2}\\Psi\n$$\n因此，作用在 $\\Psi$ 上的拉普拉斯算子，在主阶上为：\n$$\n\\nabla^{2}\\Psi = \\left(\\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}\\right)\\Psi \\approx (-k^{2} - \\ell^{2})\\Psi\n$$\n将这些导数近似值代入线性化 QG PV 方程：\n$$\n(-i\\omega + iUk)(-k^{2} - \\ell^{2})\\Psi + \\beta(y)(ik)\\Psi = 0\n$$\n假设存在非平凡解（$\\Psi \\neq 0$）并除以 $i$：\n$$\n(-\\omega + Uk)(-k^{2} - \\ell^{2}) + \\beta k = 0\n$$\n$$\n(\\omega - Uk)(k^{2} + \\ell^{2}) + \\beta k = 0\n$$\n对频率 $\\omega$ 进行整理，得到罗斯贝波（Rossby waves）的局地频散关系：\n$$\n\\omega = Uk - \\frac{\\beta(y) k}{k^{2} + \\ell^{2}(y)}\n$$\n这就是所要求的主阶关系。它是局地的，因为 $\\beta$ 和 $\\ell$ 是经向坐标 $y$ 的函数。\n\n转向纬度 $\\phi_t$ 定义为经向传播停止的纬度。这发生在经向波数变为零的地方，即 $\\ell(\\phi_t) = 0$，这意味着 $\\ell^{2}(\\phi_t) = 0$。\n将 $\\ell=0$ 代入频散关系，得到转向纬度处的条件：\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t) k}{k^{2} + 0}\n$$\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t)}{k}\n$$\n这就是转向纬度的条件。\n\n为了求出 $\\phi_t$ 的数值，我们首先需要确定守恒的波频率 $\\omega$。由于背景态是定常且纬向均匀的，$\\omega$ 和 $k$ 沿着波的路径是守恒的。我们可以使用参考纬度 $\\phi_0 = 30^{\\circ}$ 处的给定参数来计算 $\\omega$。\n给定的数值是：\n$a = 6.371 \\times 10^{6}$ m\n$\\Omega = 7.292115 \\times 10^{-5}$ rad/s\n$U = 15$ m/s\n$k = 2.0 \\times 10^{-6}$ m$^{-1}$\n$\\phi_0 = 30^{\\circ}$\n$\\ell_0 = \\ell(\\phi_0) = 1.0 \\times 10^{-6}$ m$^{-1}$\n\n首先，我们计算参考纬度 $\\phi_0 = 30^{\\circ}$ 处的贝塔参数：\n$$\n\\beta_0 = \\beta(\\phi_0) = \\frac{2\\Omega}{a}\\cos(\\phi_0) = \\frac{2 \\times 7.292115 \\times 10^{-5}}{6.371 \\times 10^{6}} \\cos(30^{\\circ})\n$$\n$$\n\\beta_0 \\approx (2.28915 \\times 10^{-11}) \\times \\frac{\\sqrt{3}}{2} \\approx 1.98246 \\times 10^{-11} \\text{ m}^{-1}\\text{s}^{-1}\n$$\n现在我们使用完整的频散关系来求 $\\omega$：\n$$\nk^{2} = (2.0 \\times 10^{-6})^{2} = 4.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\n$$\n\\ell_0^{2} = (1.0 \\times 10^{-6})^{2} = 1.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\n$$\nk^{2} + \\ell_0^{2} = 5.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\n多普勒频移项为 $Uk = 15 \\times 2.0 \\times 10^{-6} = 3.0 \\times 10^{-5}$ s$^{-1}$。\n罗斯贝波频率项为：\n$$\n\\frac{\\beta_0 k}{k^{2} + \\ell_0^{2}} = \\frac{(1.98246 \\times 10^{-11}) \\times (2.0 \\times 10^{-6})}{5.0 \\times 10^{-12}} \\approx 7.92985 \\times 10^{-6} \\text{ s}^{-1}\n$$\n所以，波频率 $\\omega$ 为：\n$$\n\\omega = 3.0 \\times 10^{-5} - 7.92985 \\times 10^{-6} = 2.207015 \\times 10^{-5} \\text{ s}^{-1}\n$$\n现在我们使用这个守恒的 $\\omega$ 值代入转向纬度条件来求解 $\\beta(\\phi_t)$：\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t)}{k} \\implies \\beta(\\phi_t) = k(Uk - \\omega)\n$$\n$$\n\\beta(\\phi_t) = (2.0 \\times 10^{-6}) \\times (3.0 \\times 10^{-5} - 2.207015 \\times 10^{-5})\n$$\n$$\n\\beta(\\phi_t) = (2.0 \\times 10^{-6}) \\times (7.92985 \\times 10^{-6}) \\approx 1.58597 \\times 10^{-11} \\text{ m}^{-1}\\text{s}^{-1}\n$$\n最后，我们使用 $\\beta(\\phi)$ 的定义来求解 $\\phi_t$：\n$$\n\\beta(\\phi_t) = \\frac{2\\Omega}{a}\\cos(\\phi_t)\n$$\n$$\n\\cos(\\phi_t) = \\frac{\\beta(\\phi_t) a}{2\\Omega} = \\frac{1.58597 \\times 10^{-11}}{2.28915 \\times 10^{-11}} \\approx 0.692820\n$$\n$$\n\\phi_t = \\arccos(0.692820)\n$$\n将弧度转换为度：\n$$\n\\phi_t \\approx 46.1463^{\\circ}\n$$\n问题要求的是北转向纬度。由于波起源于 $\\phi_0 = 30^{\\circ}$，而此结果在其北方，因此这是正确的纬度。将结果四舍五入到四位有效数字，得到 $\\phi_t = 46.15^{\\circ}$。",
            "answer": "$$\n\\boxed{46.15}\n$$"
        },
        {
            "introduction": "最后一个实践练习将理论与数值模拟的实践领域联系起来，这是现代气候科学的一项关键技能。你将分析一个标准的有限差分格式如何改变罗斯贝波的基本属性，特别是其频散关系和相速度。这个练习揭示了数值频散的概念，并强调了在计算模拟和物理真实性之间不可避免的权衡。",
            "id": "4083977",
            "problem": "考虑中纬度 beta 平面上无辐散、无粘性流动的线性正压涡度方程，其正压流函数为 $\\psi(x,y,t)$，\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; 0,\n$$\n其中 $\\beta$ 是科里奥利参数的经向梯度。假设一个平面波解，形式为 $\\psi(x,y,t) = \\Re\\{\\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]\\}$，其中纬向和经向波数 $k$ 和 $\\ell$ 以及频率 $\\omega$ 均为实数。定义连续总波数 $K^{2} \\equiv k^{2} + \\ell^{2}$ 和连续相速度 $c_{p} \\equiv \\omega/k$。\n\n现在，使用以下二阶中心有限差分，在空间步长为 $\\Delta x$ 和 $\\Delta y$、时间步长为 $\\Delta t$ 的均匀、同位网格上对此方程进行近似：\n- 对 $\\zeta \\equiv \\nabla^{2}\\psi$ 应用蛙跳格式计算涡度的时间倾向项：$(\\zeta^{n+1}_{i,j} - \\zeta^{n-1}_{i,j})/(2\\Delta t)$。\n- 流函数的纬向导数为 $(\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j})/(2\\Delta x)$。\n- 对 $\\psi^{n}_{i,j}$ 应用标准五点格式计算拉普拉斯算子。\n\n假设一个离散正规模 $\\psi^{n}_{i,j} = \\Re\\{\\hat{\\psi}\\,\\exp[i(k\\,i\\Delta x + \\ell\\,j\\Delta y - \\omega\\,n\\Delta t)]\\}$，并在 $|k\\Delta x| \\ll 1$、$|\\ell\\Delta y| \\ll 1$ 和 $|\\omega \\Delta t| \\ll 1$ 的小参数假设下，重点关注数值频散关系的物理（非计算）分支。仅使用基本定义和离散算子的二阶泰勒展开，推导引导阶相对相速误差\n$$\nE \\;\\equiv\\; \\frac{c_{p}^{\\text{num}} - c_{p}}{c_{p}},\n$$\n其中 $c_{p}^{\\text{num}} \\equiv \\omega_{\\text{num}}/k$ 是由指定格式产生的数值相速度。保留截至并包括 $\\Delta x^{2}$、$\\Delta y^{2}$ 和 $\\Delta t^{2}$ 阶的项，并忽略所有混合高阶乘积项，如 $\\Delta x^{2}\\Delta t^{2}$。\n\n你的最终答案应该是关于 $E$ 的一个闭式解析表达式，用 $k$、$\\ell$、$\\beta$、$\\Delta x$、$\\Delta y$ 和 $\\Delta t$ 表示。不要代入数值。不要在最终的方框表达式中包含单位。",
            "solution": "用户希望推导求解线性正压涡度方程的数值格式的引导阶相对相速误差。\n\n首先，对问题进行验证。\n\n**步骤1：提取已知条件**\n- **控制方程**：中纬度 beta 平面上的线性正压涡度方程由 $\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} = 0$ 给出，其中流函数为 $\\psi(x,y,t)$。$\\beta$ 是一个常数。\n- **连续解形式**：假设一个平面波解 $\\psi(x,y,t) = \\Re\\{\\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]\\}$，其中波数 $k$ 和 $\\ell$ 以及频率 $\\omega$ 均为实数。\n- **连续定义**：总波数平方 $K^{2} \\equiv k^{2} + \\ell^{2}$ 和相速度 $c_{p} \\equiv \\omega/k$。\n- **数值离散化**：使用空间步长为 $\\Delta x$、$\\Delta y$ 和时间步长为 $\\Delta t$ 的均匀网格。\n    - 时间导数：蛙跳格式，对 $\\zeta \\equiv \\nabla^{2}\\psi$ 应用 $\\frac{\\zeta^{n+1}_{i,j} - \\zeta^{n-1}_{i,j}}{2\\Delta t}$。\n    - 纬向导数：二阶中心差分，$\\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x}$。\n    - 拉普拉斯算子：标准五点格式。\n- **离散解形式**：假设一个离散正规模 $\\psi^{n}_{i,j} = \\Re\\{\\hat{\\psi}\\,\\exp[i(k\\,i\\Delta x + \\ell\\,j\\Delta y - \\omega_{\\text{num}}\\,n\\Delta t)]\\}$。\n- **假设**：小参数假设 $|k\\Delta x| \\ll 1$、$|\\ell\\Delta y| \\ll 1$ 和 $|\\omega \\Delta t| \\ll 1$。我们分析频散关系的物理分支。\n- **目标**：推导引导阶相对相速误差 $E \\equiv \\frac{c_{p}^{\\text{num}} - c_{p}}{c_{p}}$，其中 $c_{p}^{\\text{num}} \\equiv \\omega_{\\text{num}}/k$。推导必须保留截至 $\\Delta x^{2}$、$\\Delta y^{2}$ 和 $\\Delta t^{2}$ 阶的项，并忽略混合高阶乘积。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。它涉及 Rossby 波数值频散的标准分析，这是地球物理流体动力学和数值模拟中的一个基本课题。所有必要信息均已提供，假设明确，目标精确。验证清单中列出的缺陷均不存在。\n\n**步骤3：结论与行动**\n问题**有效**。将提供完整解答。\n\n**解的推导**\n\n目标是求出相对误差 $E = (c_{p}^{\\text{num}} - c_{p}) / c_{p} = \\omega_{\\text{num}}/\\omega - 1$。这需要推导 $\\omega$ 的精确连续频散关系和 $\\omega_{\\text{num}}$ 的数值频散关系。\n\n**1. 连续频散关系**\n我们将连续平面波解 $\\psi(x,y,t) = \\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]$ 代入控制方程 $\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} = 0$。\n$\\psi$ 的导数为：\n$\\frac{\\partial \\psi}{\\partial x} = ik\\psi$\n$\\nabla^{2}\\psi = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac }^{\\partial^2 \\psi}{\\partial y^2} = (ik)^2\\psi + (i\\ell)^2\\psi = -(k^2+\\ell^2)\\psi = -K^2\\psi$\n$\\frac{\\partial}{\\partial t}(\\nabla^2\\psi) = -K^2 \\frac{\\partial \\psi}{\\partial t} = -K^2(-i\\omega\\psi) = i\\omega K^2\\psi$\n将这些代入控制方程得到：\n$$\ni\\omega K^2\\psi + \\beta(ik\\psi) = 0\n$$\n除以 $i\\psi$（非平凡），我们得到 Rossby 波的精确频散关系：\n$$\n\\omega K^2 + \\beta k = 0 \\quad \\implies \\quad \\omega = -\\frac{\\beta k}{K^2} = -\\frac{\\beta k}{k^2 + \\ell^2}\n$$\n因此，精确相速度 $c_{p}$ 为：\n$$\nc_{p} = \\frac{\\omega}{k} = -\\frac{\\beta}{K^2} = -\\frac{\\beta}{k^2 + \\ell^2}\n$$\n\n**2. 数值频散关系**\n接下来，我们离散化控制方程。令 $\\psi^n_{i,j}$ 表示在时间 $t_n=n\\Delta t$ 和网格点 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ 处的流函数。\n离散化方程为：\n$$\n\\frac{\\nabla_h^2\\psi^{n+1}_{i,j} - \\nabla_h^2\\psi^{n-1}_{i,j}}{2\\Delta t} + \\beta \\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x} = 0\n$$\n其中 $\\nabla_h^2$ 代表五点拉普拉斯格式：\n$$\n\\nabla_h^2\\psi_{i,j} = \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{(\\Delta x)^2} + \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{(\\Delta y)^2}\n$$\n我们将离散正规模解 $\\psi^{n}_{i,j} = \\hat{\\psi}\\,\\exp[i(k x_i + \\ell y_j - \\omega_{\\text{num}} t_n)]$ 代入离散方程。我们分析每个离散算子对该模态的作用。\n纬向平流项变为：\n$$\n\\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x} = \\frac{\\exp(ik\\Delta x) - \\exp(-ik\\Delta x)}{2\\Delta x} \\psi^n_{i,j} = \\frac{2i\\sin(k\\Delta x)}{2\\Delta x} \\psi^n_{i,j} = \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\psi^n_{i,j}\n$$\n应用于 $\\psi^n_{i,j}$ 的离散拉普拉斯算子得到：\n$$\n\\nabla_h^2\\psi^n_{i,j} = \\left[ \\frac{\\exp(ik\\Delta x) - 2 + \\exp(-ik\\Delta x)}{(\\Delta x)^2} + \\frac{\\exp(i\\ell\\Delta y) - 2 + \\exp(-i\\ell\\Delta y)}{(\\Delta y)^2} \\right] \\psi^n_{i,j}\n$$\n使用恒等式 $\\cos\\theta-1 = -2\\sin^2(\\theta/2)$，这可以简化为：\n$$\n\\nabla_h^2\\psi^n_{i,j} = \\left[ -\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} - \\frac{4\\sin^2(\\ell\\Delta y/2)}{(\\Delta y)^2} \\right] \\psi^n_{i,j} \\equiv -\\hat{K}^2 \\psi^n_{i,j}\n$$\n其中 $\\hat{K}^2$ 是数值总波数的平方。\n离散方程中的时间差分项涉及 $\\nabla_h^2\\psi^{n\\pm 1}_{i,j} = -\\hat{K}^2 \\psi^{n\\pm 1}_{i,j}$。时间位移为 $\\psi^{n\\pm 1}_{i,j} = \\exp(\\mp i\\omega_{\\text{num}}\\Delta t)\\psi^n_{i,j}$。所以该项变为：\n$$\n\\frac{\\nabla_h^2\\psi^{n+1}_{i,j} - \\nabla_h^2\\psi^{n-1}_{i,j}}{2\\Delta t} = \\frac{-\\hat{K}^2(\\exp(-i\\omega_{\\text{num}}\\Delta t) - \\exp(i\\omega_{\\text{num}}\\Delta t))}{2\\Delta t} \\psi^n_{i,j} = \\frac{-\\hat{K}^2(-2i\\sin(\\omega_{\\text{num}}\\Delta t))}{2\\Delta t} \\psi^n_{i,j} = \\frac{i\\hat{K}^2\\sin(\\omega_{\\text{num}}\\Delta t)}{\\Delta t} \\psi^n_{i,j}\n$$\n将这些表达式代回完整的离散方程得到：\n$$\n\\frac{i\\hat{K}^2\\sin(\\omega_{\\text{num}}\\Delta t)}{\\Delta t} \\psi^n_{i,j} + \\beta \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\psi^n_{i,j} = 0\n$$\n除以 $i\\psi^n_{i,j}$ 得到数值频散关系：\n$$\n\\sin(\\omega_{\\text{num}}\\Delta t) = - \\frac{\\beta \\Delta t}{\\hat{K}^2} \\frac{\\sin(k\\Delta x)}{\\Delta x}\n$$\n\n**3. 泰勒级数展开**\n我们现在应用小参数假设（$|k\\Delta x|\\ll 1$、$|\\ell\\Delta y|\\ll 1$、$|\\omega\\Delta t|\\ll 1$）来找到 $\\omega_{\\text{num}}$ 的近似值。我们使用泰勒级数 $\\sin(z) \\approx z - z^3/6$ 和 $\\arcsin(u) \\approx u + u^3/6$。\n首先，将离散空间算子展开到网格间距的二阶：\n$$\n\\frac{\\sin(k\\Delta x)}{\\Delta x} = \\frac{k\\Delta x - (k\\Delta x)^3/6 + \\mathcal{O}(\\Delta x^5)}{\\Delta x} = k\\left(1 - \\frac{k^2\\Delta x^2}{6}\\right)\n$$\n$$\n\\hat{K}^2 = \\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + \\frac{4\\sin^2(\\ell\\Delta y/2)}{(\\Delta y)^2}\n$$\n使用 $\\sin^2(z/2) = (z/2 - (z/2)^3/6 + \\dots)^2 = z^2/4 - z^4/48 + \\mathcal{O}(z^6)$：\n$$\n\\hat{K}^2 = \\frac{4}{(\\Delta x)^2}\\left(\\frac{(k\\Delta x)^2}{4} - \\frac{(k\\Delta x)^4}{48}\\right) + \\frac{4}{(\\Delta y)^2}\\left(\\frac{(\\ell\\Delta y)^2}{4} - \\frac{(\\ell\\Delta y)^4}{48}\\right) = \\left(k^2 - \\frac{k^4\\Delta x^2}{12}\\right) + \\left(\\ell^2 - \\frac{\\ell^4\\Delta y^2}{12}\\right)\n$$\n$$\n\\hat{K}^2 = (k^2+\\ell^2) - \\frac{1}{12}(k^4\\Delta x^2 + \\ell^4\\Delta y^2) = K^2\\left(1 - \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\n对于小的 $x$，使用 $(1-x)^{-1} \\approx 1+x$，我们求得其倒数：\n$$\n\\frac{1}{\\hat{K}^2} \\approx \\frac{1}{K^2}\\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\n现在我们组合数值频散关系的右侧（RHS）：\n$$\n\\text{RHS} = - \\beta \\Delta t \\left[k\\left(1 - \\frac{k^2\\Delta x^2}{6}\\right)\\right] \\left[\\frac{1}{K^2}\\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\\right]\n$$\n$$\n\\text{RHS} \\approx -\\frac{\\beta k \\Delta t}{K^2} \\left(1 - \\frac{k^2\\Delta x^2}{6}\\right) \\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\n由于 $\\omega = -\\beta k/K^2$，我们有 $\\text{RHS} \\approx \\omega\\Delta t(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2})$，其中我们忽略了 $\\Delta^2$ 项的乘积。\n\n**4. 求解数值频率和误差**\n我们有 $\\sin(\\omega_{\\text{num}}\\Delta t) \\approx \\text{RHS}$。对于物理模态，我们取反正弦函数的主值：\n$$\n\\omega_{\\text{num}}\\Delta t \\approx \\arcsin(\\text{RHS}) \\approx \\text{RHS} + \\frac{1}{6}(\\text{RHS})^3\n$$\n在所需阶数下，$(\\text{RHS})^3 \\approx (\\omega\\Delta t)^3$。\n$$\n\\omega_{\\text{num}}\\Delta t \\approx \\omega\\Delta t\\left(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right) + \\frac{(\\omega\\Delta t)^3}{6}\n$$\n除以 $\\Delta t$ 得到 $\\omega_{\\text{num}}$：\n$$\n\\omega_{\\text{num}} \\approx \\omega\\left(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right) + \\frac{\\omega^3\\Delta t^2}{6}\n$$\n频率的相对误差是 $\\omega_{\\text{num}}/\\omega - 1$：\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega} - 1 \\approx - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2} + \\frac{\\omega^2\\Delta t^2}{6}\n$$\n这等于相对相速误差 $E = (c_p^{\\text{num}}-c_p)/c_p = (\\omega_{\\text{num}}/k - \\omega/k)/(\\omega/k) = \\omega_{\\text{num}}/\\omega - 1$。\n最后，我们代入 $\\omega^2 = (\\frac{-\\beta k}{K^2})^2 = \\frac{\\beta^2k^2}{K^4}$ 和 $K^2 = k^2+\\ell^2$：\n$$\nE \\approx - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12(k^2+\\ell^2)} + \\frac{\\beta^2 k^2 \\Delta t^2}{6(k^2+\\ell^2)^2}\n$$\n我们可以合并与 $\\Delta x^{2}$ 成比例的项：\n$$\n\\left(-\\frac{k^2}{6} + \\frac{k^4}{12(k^2+\\ell^2)}\\right)\\Delta x^2 = \\frac{-2k^2(k^2+\\ell^2) + k^4}{12(k^2+\\ell^2)}\\Delta x^2 = \\frac{-k^4-2k^2\\ell^2}{12(k^2+\\ell^2)}\\Delta x^2 = -\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2\n$$\n因此，引导阶相对相速误差的最终表达式为：\n$$\nE \\approx -\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2 + \\frac{\\ell^4}{12(k^2+\\ell^2)}\\Delta y^2 + \\frac{\\beta^2 k^2}{6(k^2+\\ell^2)^2}\\Delta t^2\n$$",
            "answer": "$$\n\\boxed{-\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2 + \\frac{\\ell^4}{12(k^2+\\ell^2)}\\Delta y^2 + \\frac{\\beta^2 k^2}{6(k^2+\\ell^2)^2}\\Delta t^2}\n$$"
        }
    ]
}