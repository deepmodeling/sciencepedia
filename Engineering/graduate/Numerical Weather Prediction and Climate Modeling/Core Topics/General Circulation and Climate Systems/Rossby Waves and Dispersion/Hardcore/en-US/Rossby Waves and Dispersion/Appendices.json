{
    "hands_on_practices": [
        {
            "introduction": "The beta-effect not only enables Rossby waves but also governs the motion of coherent structures like atmospheric and oceanic vortices. This practice provides a first-principles derivation of the famous \"beta drift,\" a fundamental westward velocity component intrinsic to any large-scale vortex . By applying an integral constraint, you will uncover the elegant physical mechanism that links vortex motion to the suppression of Rossby wave radiation, a cornerstone concept in geophysical fluid dynamics.",
            "id": "4083972",
            "problem": "Consider a two-dimensional, unbounded, midlatitude beta-plane governed by the Quasi-Geostrophic (QG) potential vorticity equation. Let the perturbation potential vorticity $q'(x,y,t)$ and streamfunction $\\psi(x,y,t)$ satisfy the evolution law\n$$\nq'_{t} + J(\\psi, q' + \\beta y) = 0,\n$$\ntogether with the linear invertibility relation\n$$\nq' = \\nabla^{2} \\psi - \\frac{\\psi}{R_{d}^{2}},\n$$\nwhere $\\beta > 0$ is the meridional gradient of the Coriolis parameter, $R_{d} > 0$ is the (first baroclinic mode) deformation radius, and $J(a,b) = a_{x} b_{y} - a_{y} b_{x}$ is the Jacobian.\n\nAssume a localized monopolar anomaly initially given by\n$$\nq'(x,y,0) = Q_{0} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{L^{2}}\\right),\n$$\nwith $Q_{0}$ real and $L > 0$. Suppose that, after rapid adjustment, the anomaly translates steadily without change of shape in the zonal direction with speed $U$, so that in the co-moving frame the fields are steady to leading order. Starting only from the governing laws above (no additional shortcut formulas are allowed), derive a solvability condition for $U$ and use it to obtain the exact analytic expression for the zonal drift speed $U$ in terms of $\\beta$ and $R_{d}$.\n\nYour final answer must be a single closed-form analytic expression. Do not include any units in the final boxed answer.",
            "solution": "The problem asks for the zonal drift speed $U$ of a steadily translating potential vorticity anomaly on a midlatitude beta-plane, governed by the Quasi-Geostrophic (QG) potential vorticity equation.\n\n### Step 1: Problem Validation\nThe problem statement is validated as follows:\n\n*   **Givens Extracted Verbatim:**\n    *   Governing equation: $q'_{t} + J(\\psi, q' + \\beta y) = 0$\n    *   Invertibility relation: $q' = \\nabla^{2} \\psi - \\frac{\\psi}{R_{d}^{2}}$\n    *   Parameters: $\\beta > 0$, $R_{d} > 0$\n    *   Jacobian definition: $J(a,b) = a_{x} b_{y} - a_{y} b_{x}$\n    *   Initial condition for the anomaly: $q'(x,y,0) = Q_{0} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{L^{2}}\\right)$ with $Q_0$ real and $L>0$.\n    *   Assumption: The anomaly translates steadily without change of shape in the zonal direction with speed $U$.\n\n*   **Validation Using Extracted Givens:**\n    1.  **Scientifically Grounded:** The problem uses the standard QG potential vorticity equations on a beta-plane, a fundamental model in dynamical meteorology and oceanography. All components are well-established within the field.\n    2.  **Well-Posed:** The problem seeks the speed of a special type of solution (a solitary wave). The existence and uniqueness of such a speed for a given structure is a well-posed mathematical question.\n    3.  **Objective:** The problem is stated in precise mathematical terms, free of subjectivity.\n    4.  **Completeness and Consistency:** The problem is self-contained. The assumption of steady translation combined with the initial shape provides sufficient constraints to determine the speed $U$.\n\n*   **Verdict:** The problem is valid. We may proceed with the solution.\n\n### Step 2: Derivation of the Drift Speed\n\nWe begin with the QG potential vorticity equation:\n$$\n\\frac{\\partial q'}{\\partial t} + J(\\psi, q' + \\beta y) = 0\n$$\nExpanding the Jacobian term, $J(\\psi, q' + \\beta y) = J(\\psi, q') + J(\\psi, \\beta y)$. The second part is $J(\\psi, \\beta y) = \\frac{\\partial \\psi}{\\partial x}\\frac{\\partial(\\beta y)}{\\partial y} - \\frac{\\partial \\psi}{\\partial y}\\frac{\\partial(\\beta y)}{\\partial x} = \\beta \\frac{\\partial \\psi}{\\partial x}$. The equation becomes:\n$$\n\\frac{\\partial q'}{\\partial t} + J(\\psi, q') + \\beta \\frac{\\partial \\psi}{\\partial x} = 0\n$$\nWe are given that the solution translates steadily in the zonal direction with speed $U$. This means the fields $q'$ and $\\psi$ are functions of $\\xi = x - Ut$ and $\\eta = y$. So, $q'(x,y,t) = q'(\\xi, \\eta)$ and $\\psi(x,y,t) = \\psi(\\xi, \\eta)$. The chain rule gives the transformations for the partial derivatives:\n$\\frac{\\partial}{\\partial t} = -U \\frac{\\partial}{\\partial \\xi}$, $\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial \\xi}$, and $\\frac{\\partial}{\\partial y} = \\frac{\\partial}{\\partial \\eta}$.\n\nSubstituting these into the QG equation, we obtain the steady-state equation in the co-moving frame $(\\xi, \\eta)$:\n$$\n-U \\frac{\\partial q'}{\\partial \\xi} + J(\\psi, q') + \\beta \\frac{\\partial \\psi}{\\partial \\xi} = 0\n$$\nwhere the Jacobian is now taken with respect to $(\\xi, \\eta)$: $J(\\psi, q') = \\frac{\\partial \\psi}{\\partial \\xi}\\frac{\\partial q'}{\\partial \\eta} - \\frac{\\partial \\psi}{\\partial \\eta}\\frac{\\partial q'}{\\partial \\xi}$.\n\nTo find a solvability condition for $U$, we derive an integral constraint. We multiply the steady-state equation by $\\xi$ and integrate over the entire plane $\\mathbb{R}^2$:\n$$\n\\iint_{\\mathbb{R}^2} \\left( \\xi J(\\psi, q') + \\xi \\beta \\frac{\\partial \\psi}{\\partial \\xi} - \\xi U \\frac{\\partial q'}{\\partial \\xi} \\right) d\\xi d\\eta = 0\n$$\nWe analyze each term separately. For a localized anomaly, $\\psi$, $q'$, and their derivatives vanish at infinity.\n\n*   **Term 1:** $\\iint \\xi J(\\psi, q') d\\xi d\\eta$.\n    Using the identity $\\iint f J(g, h) d A = \\iint h J(f, g) d A$ for functions that decay at infinity, we set $f=\\xi$, $g=\\psi$, $h=q'$.\n    $$\n    \\iint \\xi J(\\psi, q') d\\xi d\\eta = \\iint q' J(\\xi, \\psi) d\\xi d\\eta\n    $$\n    The Jacobian $J(\\xi, \\psi) = \\frac{\\partial \\xi}{\\partial \\xi}\\frac{\\partial \\psi}{\\partial \\eta} - \\frac{\\partial \\xi}{\\partial \\eta}\\frac{\\partial \\psi}{\\partial \\xi} = 1 \\cdot \\frac{\\partial \\psi}{\\partial \\eta} - 0 \\cdot \\frac{\\partial \\psi}{\\partial \\xi} = \\frac{\\partial \\psi}{\\partial \\eta}$.\n    So, the first term is $\\iint q' \\frac{\\partial \\psi}{\\partial \\eta} d\\xi d\\eta$.\n\n*   **Term 2:** $\\beta \\iint \\xi \\frac{\\partial \\psi}{\\partial \\xi} d\\xi d\\eta$.\n    We integrate by parts with respect to $\\xi$:\n    $$\n    \\beta \\int_{-\\infty}^{\\infty} \\left( \\int_{-\\infty}^{\\infty} \\xi \\frac{\\partial \\psi}{\\partial \\xi} d\\xi \\right) d\\eta = \\beta \\int_{-\\infty}^{\\infty} \\left( [\\xi \\psi]_{\\xi=-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} \\psi d\\xi \\right) d\\eta\n    $$\n    Since $\\psi \\to 0$ at infinity, the boundary term $[\\xi \\psi]$ vanishes. The term becomes $-\\beta \\iint \\psi d\\xi d\\eta$.\n\n*   **Term 3:** $-U \\iint \\xi \\frac{\\partial q'}{\\partial \\xi} d\\xi d\\eta$.\n    Similarly, integrating by parts with respect to $\\xi$ yields $U \\iint q' d\\xi d\\eta$.\n\nCombining the terms, the integral constraint is:\n$$\n\\iint q' \\frac{\\partial \\psi}{\\partial \\eta} d\\xi d\\eta - \\beta \\iint \\psi d\\xi d\\eta + U \\iint q' d\\xi d\\eta = 0\n$$\nNow, we use the structure of the anomaly. It starts as an axisymmetric Gaussian, $q'(x,y,0) = Q_{0} \\exp(-(x^2+y^2)/L^2)$. Since it translates without change of shape, its form in the co-moving frame is $q'(\\xi,\\eta) = Q_{0} \\exp(-(\\xi^2+\\eta^2)/L^2)$. This function is axisymmetric with respect to the origin of the co-moving frame. Let $\\rho = \\sqrt{\\xi^2+\\eta^2}$. Then $q' = q'(\\rho)$.\n\nThe invertibility relation $q' = \\nabla^2 \\psi - \\psi/R_d^2$ is a linear, isotropic differential equation (a modified Helmholtz equation). An axisymmetric forcing $q'(\\rho)$ will produce an axisymmetric streamfunction $\\psi(\\rho)$.\nWith $\\psi = \\psi(\\rho)$, the derivative with respect to $\\eta$ is $\\frac{\\partial \\psi}{\\partial \\eta} = \\frac{d\\psi}{d\\rho}\\frac{\\partial \\rho}{\\partial \\eta} = \\frac{d\\psi}{d\\rho}\\frac{\\eta}{\\rho}$.\nThe first integral in our constraint becomes:\n$$\n\\iint q'(\\rho) \\frac{d\\psi}{d\\rho}\\frac{\\eta}{\\rho} d\\xi d\\eta\n$$\nThe integrand is an odd function of $\\eta$, and the domain of integration $\\mathbb{R}^2$ is symmetric with respect to the $\\xi$-axis. Therefore, this integral is zero.\n\nThe integral constraint simplifies to:\n$$\n-\\beta \\iint \\psi d\\xi d\\eta + U \\iint q' d\\xi d\\eta = 0\n$$\nNext, we relate the integral of $\\psi$ to the integral of $q'$. We integrate the invertibility relation over the plane:\n$$\n\\iint q' d\\xi d\\eta = \\iint \\left( \\nabla^2\\psi - \\frac{\\psi}{R_d^2} \\right) d\\xi d\\eta\n$$\nThe integral of the Laplacian term can be converted to a boundary integral using the Divergence Theorem: $\\iint \\nabla^2\\psi d A = \\oint \\nabla\\psi \\cdot \\mathbf{n} ds$. Since $\\psi$ and its gradients vanish at infinity, this integral is zero.\nThus, we have the relationship:\n$$\n\\iint q' d\\xi d\\eta = -\\frac{1}{R_d^2} \\iint \\psi d\\xi d\\eta \\quad \\implies \\quad \\iint \\psi d\\xi d\\eta = -R_d^2 \\iint q' d\\xi d\\eta\n$$\nLet $I_{q'} = \\iint q' d\\xi d\\eta$. Since the initial anomaly is a non-trivial Gaussian ($Q_0 \\ne 0$, $L>0$), $I_{q'}$ is non-zero. Specifically, $I_{q'} = Q_0 \\pi L^2 \\ne 0$.\nSubstituting this relationship into the simplified integral constraint, we get:\n$$\n-\\beta \\left(-R_d^2 \\iint q' d\\xi d\\eta\\right) + U \\iint q' d\\xi d\\eta = 0\n$$\n$$\n(\\beta R_d^2 + U) \\iint q' d\\xi d\\eta = 0\n$$\nThis is the solvability condition for $U$. Since $\\iint q' d\\xi d\\eta \\neq 0$, the term in the parenthesis must be zero:\n$$\n\\beta R_d^2 + U = 0\n$$\nSolving for $U$, we find the exact expression for the zonal drift speed:\n$$\nU = -\\beta R_d^2\n$$\nThis result indicates that a localized, axisymmetric QG vortex on a beta-plane must drift westward at a speed equal to the maximum phase speed of linear Rossby waves (i.e., the speed of infinitely long waves). This specific speed prevents the vortex from radiating energy in the form of a Rossby wave wake, allowing it to maintain its shape.",
            "answer": "$$\n\\boxed{-\\beta R_{d}^{2}}\n$$"
        },
        {
            "introduction": "Bridging the gap between continuous theory and computational practice is a critical skill for any modern dynamicist. This exercise delves into the analysis of numerical dispersion, a primary source of error in models where the simulated wave speed depends artificially on the wavelength and grid resolution . By deriving the leading-order phase speed error for a standard finite-difference scheme, you will develop a foundational understanding of how discretization choices impact the fidelity of a numerical weather or climate simulation.",
            "id": "4083957",
            "problem": "Consider the linear barotropic vorticity equation on a midlatitude beta-plane for a nondivergent, inviscid flow with barotropic streamfunction $\\psi(x,y,t)$,\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} \\;=\\; 0,\n$$\nwhere $\\beta$ is the meridional gradient of the Coriolis parameter. Assume a plane-wave solution of the form $\\psi(x,y,t) = \\Re\\{\\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]\\}$ with real zonal and meridional wavenumbers $k$ and $\\ell$, and real frequency $\\omega$. Define the continuous total wavenumber $K^{2} \\equiv k^{2} + \\ell^{2}$ and the continuous phase speed $c_{p} \\equiv \\omega/k$.\n\nNow approximate this equation on a uniform, collocated grid with spacings $\\Delta x$ and $\\Delta y$ in space and time step $\\Delta t$ using the following second-order centered finite differences:\n- Time tendency of vorticity by the leapfrog scheme applied to $\\zeta \\equiv \\nabla^{2}\\psi$: $(\\zeta^{n+1}_{i,j} - \\zeta^{n-1}_{i,j})/(2\\Delta t)$.\n- Zonal derivative of the streamfunction by $(\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j})/(2\\Delta x)$.\n- The Laplacian by the standard five-point stencil applied to $\\psi^{n}_{i,j}$.\n\nAssume a discrete normal mode $\\psi^{n}_{i,j} = \\Re\\{\\hat{\\psi}\\,\\exp[i(k\\,i\\Delta x + \\ell\\,j\\Delta y - \\omega\\,n\\Delta t)]\\}$ and focus on the physical (noncomputational) branch of the numerical dispersion relation under the small-parameter assumption that $|k\\Delta x| \\ll 1$, $|\\ell\\Delta y| \\ll 1$, and $|\\omega \\Delta t| \\ll 1$. Using only fundamental definitions and second-order Taylor expansions of the discrete operators, derive the leading-order relative phase speed error\n$$\nE \\;\\equiv\\; \\frac{c_{p}^{\\text{num}} - c_{p}}{c_{p}},\n$$\nwhere $c_{p}^{\\text{num}} \\equiv \\omega_{\\text{num}}/k$ is the numerical phase speed produced by the prescribed scheme. Retain terms up to and including order $\\Delta x^{2}$, $\\Delta y^{2}$, and $\\Delta t^{2}$, and neglect all mixed higher-order products such as $\\Delta x^{2}\\Delta t^{2}$.\n\nYour final answer should be a single closed-form analytic expression for $E$ in terms of $k$, $\\ell$, $\\beta$, $\\Delta x$, $\\Delta y$, and $\\Delta t$. Do not substitute numerical values. Do not include units in your final boxed expression.",
            "solution": "The user wants to derive the leading-order relative phase speed error for a numerical scheme solving the linear barotropic vorticity equation.\n\nFirst, the problem is validated.\n\n**Step 1: Extracted Givens**\n- **Governing Equation**: The linear barotropic vorticity equation on a midlatitude beta-plane is given by $\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} = 0$, for a streamfunction $\\psi(x,y,t)$. $\\beta$ is a constant.\n- **Continuous Solution Form**: A plane-wave solution is assumed, $\\psi(x,y,t) = \\Re\\{\\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]\\}$, with real wavenumbers $k$ and $\\ell$, and real frequency $\\omega$.\n- **Continuous Definitions**: Total wavenumber squared $K^{2} \\equiv k^{2} + \\ell^{2}$ and phase speed $c_{p} \\equiv \\omega/k$.\n- **Numerical Discretization**: A uniform grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta t$ is used.\n    - Time derivative: Leapfrog scheme, $\\frac{\\zeta^{n+1}_{i,j} - \\zeta^{n-1}_{i,j}}{2\\Delta t}$ for $\\zeta \\equiv \\nabla^{2}\\psi$.\n    - Zonal derivative: Second-order centered difference, $\\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x}$.\n    - Laplacian: Standard five-point stencil.\n- **Discrete Solution Form**: A discrete normal mode is assumed, $\\psi^{n}_{i,j} = \\Re\\{\\hat{\\psi}\\,\\exp[i(k\\,i\\Delta x + \\ell\\,j\\Delta y - \\omega_{\\text{num}}\\,n\\Delta t)]\\}$.\n- **Assumptions**: Small-parameter assumption $|k\\Delta x| \\ll 1$, $|\\ell\\Delta y| \\ll 1$, and $|\\omega \\Delta t| \\ll 1$. We analyze the physical branch of the dispersion relation.\n- **Objective**: Derive the leading-order relative phase speed error $E \\equiv \\frac{c_{p}^{\\text{num}} - c_{p}}{c_{p}}$, where $c_{p}^{\\text{num}} \\equiv \\omega_{\\text{num}}/k$. The derivation must retain terms up to order $\\Delta x^{2}$, $\\Delta y^{2}$, and $\\Delta t^{2}$, neglecting mixed higher-order products.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It concerns a standard analysis of numerical dispersion for Rossby waves, a fundamental topic in geophysical fluid dynamics and numerical modeling. All necessary information is provided, the assumptions are clearly stated, and the objective is precise. No flaws listed in the validation checklist are present.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n**Derivation of the Solution**\n\nThe objective is to find the relative error $E = (c_{p}^{\\text{num}} - c_{p}) / c_{p} = \\omega_{\\text{num}}/\\omega - 1$. This requires deriving the exact continuous dispersion relation for $\\omega$ and the numerical dispersion relation for $\\omega_{\\text{num}}$.\n\n**1. Continuous Dispersion Relation**\nWe substitute the continuous plane-wave solution $\\psi(x,y,t) = \\hat{\\psi}\\,\\exp[i(k x + \\ell y - \\omega t)]$ into the governing equation $\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\psi\\right) + \\beta\\,\\frac{\\partial \\psi}{\\partial x} = 0$.\nThe derivatives of $\\psi$ are:\n$\\frac{\\partial \\psi}{\\partial x} = ik\\psi$\n$\\nabla^{2}\\psi = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = (ik)^2\\psi + (i\\ell)^2\\psi = -(k^2+\\ell^2)\\psi = -K^2\\psi$\n$\\frac{\\partial}{\\partial t}(\\nabla^2\\psi) = -K^2 \\frac{\\partial \\psi}{\\partial t} = -K^2(-i\\omega\\psi) = i\\omega K^2\\psi$\nSubstituting these into the governing equation yields:\n$$\ni\\omega K^2\\psi + \\beta(ik\\psi) = 0\n$$\nDividing by $i\\psi$ (which is non-trivial), we obtain the exact dispersion relation for Rossby waves:\n$$\n\\omega K^2 + \\beta k = 0 \\quad \\implies \\quad \\omega = -\\frac{\\beta k}{K^2} = -\\frac{\\beta k}{k^2 + \\ell^2}\n$$\nThe exact phase speed $c_{p}$ is therefore:\n$$\nc_{p} = \\frac{\\omega}{k} = -\\frac{\\beta}{K^2} = -\\frac{\\beta}{k^2 + \\ell^2}\n$$\n\n**2. Numerical Dispersion Relation**\nNext, we discretize the governing equation. Let $\\psi^n_{i,j}$ denote the streamfunction at time $t_n=n\\Delta t$ and grid point $(x_i, y_j) = (i\\Delta x, j\\Delta y)$.\nThe discretized equation is:\n$$\n\\frac{\\nabla_h^2\\psi^{n+1}_{i,j} - \\nabla_h^2\\psi^{n-1}_{i,j}}{2\\Delta t} + \\beta \\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x} = 0\n$$\nwhere $\\nabla_h^2$ represents the five-point Laplacian stencil:\n$$\n\\nabla_h^2\\psi_{i,j} = \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{(\\Delta x)^2} + \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{(\\Delta y)^2}\n$$\nWe substitute the discrete normal mode solution $\\psi^{n}_{i,j} = \\hat{\\psi}\\,\\exp[i(k x_i + \\ell y_j - \\omega_{\\text{num}} t_n)]$ into the discrete equation. We analyze the effect of each discrete operator on this mode.\nThe zonal advection term becomes:\n$$\n\\frac{\\psi^{n}_{i+1,j} - \\psi^{n}_{i-1,j}}{2\\Delta x} = \\frac{\\exp(ik\\Delta x) - \\exp(-ik\\Delta x)}{2\\Delta x} \\psi^n_{i,j} = \\frac{2i\\sin(k\\Delta x)}{2\\Delta x} \\psi^n_{i,j} = \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\psi^n_{i,j}\n$$\nThe discrete Laplacian operator applied to $\\psi^n_{i,j}$ gives:\n$$\n\\nabla_h^2\\psi^n_{i,j} = \\left[ \\frac{\\exp(ik\\Delta x) - 2 + \\exp(-ik\\Delta x)}{(\\Delta x)^2} + \\frac{\\exp(i\\ell\\Delta y) - 2 + \\exp(-i\\ell\\Delta y)}{(\\Delta y)^2} \\right] \\psi^n_{i,j}\n$$\nUsing the identity $\\cos\\theta-1 = -2\\sin^2(\\theta/2)$, this simplifies to:\n$$\n\\nabla_h^2\\psi^n_{i,j} = \\left[ -\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} - \\frac{4\\sin^2(\\ell\\Delta y/2)}{(\\Delta y)^2} \\right] \\psi^n_{i,j} \\equiv -\\hat{K}^2 \\psi^n_{i,j}\n$$\nwhere $\\hat{K}^2$ is the squared numerical total wavenumber.\nThe time-differencing term in the discrete equation involves $\\nabla_h^2\\psi^{n\\pm 1}_{i,j} = -\\hat{K}^2 \\psi^{n\\pm 1}_{i,j}$. The time shifts are $\\psi^{n\\pm 1}_{i,j} = \\exp(\\mp i\\omega_{\\text{num}}\\Delta t)\\psi^n_{i,j}$. So the term becomes:\n$$\n\\frac{\\nabla_h^2\\psi^{n+1}_{i,j} - \\nabla_h^2\\psi^{n-1}_{i,j}}{2\\Delta t} = \\frac{-\\hat{K}^2(\\exp(-i\\omega_{\\text{num}}\\Delta t) - \\exp(i\\omega_{\\text{num}}\\Delta t))}{2\\Delta t} \\psi^n_{i,j} = \\frac{-\\hat{K}^2(-2i\\sin(\\omega_{\\text{num}}\\Delta t))}{2\\Delta t} \\psi^n_{i,j} = \\frac{i\\hat{K}^2\\sin(\\omega_{\\text{num}}\\Delta t)}{\\Delta t} \\psi^n_{i,j}\n$$\nSubstituting these expressions back into the full discrete equation gives:\n$$\n\\frac{i\\hat{K}^2\\sin(\\omega_{\\text{num}}\\Delta t)}{\\Delta t} \\psi^n_{i,j} + \\beta \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\psi^n_{i,j} = 0\n$$\nDividing by $i\\psi^n_{i,j}$ leads to the numerical dispersion relation:\n$$\n\\sin(\\omega_{\\text{num}}\\Delta t) = - \\frac{\\beta \\Delta t}{\\hat{K}^2} \\frac{\\sin(k\\Delta x)}{\\Delta x}\n$$\n\n**3. Taylor Series Expansions**\nWe now apply the small-parameter assumptions ($|k\\Delta x|\\ll 1$, $|\\ell\\Delta y|\\ll 1$, $|\\omega\\Delta t|\\ll 1$) to find an approximation for $\\omega_{\\text{num}}$. We use the Taylor series $\\sin(z) \\approx z - z^3/6$ and $\\arcsin(u) \\approx u + u^3/6$.\nFirst, expand the discrete spatial operators up to second order in grid spacing:\n$$\n\\frac{\\sin(k\\Delta x)}{\\Delta x} = \\frac{k\\Delta x - (k\\Delta x)^3/6 + \\mathcal{O}(\\Delta x^5)}{\\Delta x} = k\\left(1 - \\frac{k^2\\Delta x^2}{6}\\right)\n$$\n$$\n\\hat{K}^2 = \\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + \\frac{4\\sin^2(\\ell\\Delta y/2)}{(\\Delta y)^2}\n$$\nUsing $\\sin^2(z/2) = (z/2 - (z/2)^3/6 + \\dots)^2 = z^2/4 - z^4/48 + \\mathcal{O}(z^6)$:\n$$\n\\hat{K}^2 = \\frac{4}{(\\Delta x)^2}\\left(\\frac{(k\\Delta x)^2}{4} - \\frac{(k\\Delta x)^4}{48}\\right) + \\frac{4}{(\\Delta y)^2}\\left(\\frac{(\\ell\\Delta y)^2}{4} - \\frac{(\\ell\\Delta y)^4}{48}\\right) = \\left(k^2 - \\frac{k^4\\Delta x^2}{12}\\right) + \\left(\\ell^2 - \\frac{\\ell^4\\Delta y^2}{12}\\right)\n$$\n$$\n\\hat{K}^2 = (k^2+\\ell^2) - \\frac{1}{12}(k^4\\Delta x^2 + \\ell^4\\Delta y^2) = K^2\\left(1 - \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\nUsing $(1-x)^{-1} \\approx 1+x$ for small $x$, we find the inverse:\n$$\n\\frac{1}{\\hat{K}^2} \\approx \\frac{1}{K^2}\\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\nNow we assemble the right-hand side (RHS) of the numerical dispersion relation:\n$$\n\\text{RHS} = - \\beta \\Delta t \\left[k\\left(1 - \\frac{k^2\\Delta x^2}{6}\\right)\\right] \\left[\\frac{1}{K^2}\\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\\right]\n$$\n$$\n\\text{RHS} \\approx -\\frac{\\beta k \\Delta t}{K^2} \\left(1 - \\frac{k^2\\Delta x^2}{6}\\right) \\left(1 + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right)\n$$\nSince $\\omega = -\\beta k/K^2$, we have $\\text{RHS} \\approx \\omega\\Delta t(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2})$, where we have neglected products of $\\Delta^2$ terms.\n\n**4. Solving for Numerical Frequency and Error**\nWe have $\\sin(\\omega_{\\text{num}}\\Delta t) \\approx \\text{RHS}$. For the physical mode, we take the principal value of the arcsin:\n$$\n\\omega_{\\text{num}}\\Delta t \\approx \\arcsin(\\text{RHS}) \\approx \\text{RHS} + \\frac{1}{6}(\\text{RHS})^3\n$$\nTo the required order, $(\\text{RHS})^3 \\approx (\\omega\\Delta t)^3$.\n$$\n\\omega_{\\text{num}}\\Delta t \\approx \\omega\\Delta t\\left(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right) + \\frac{(\\omega\\Delta t)^3}{6}\n$$\nDividing by $\\Delta t$ gives $\\omega_{\\text{num}}$:\n$$\n\\omega_{\\text{num}} \\approx \\omega\\left(1 - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2}\\right) + \\frac{\\omega^3\\Delta t^2}{6}\n$$\nThe relative error in frequency is $\\omega_{\\text{num}}/\\omega - 1$:\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega} - 1 \\approx - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12K^2} + \\frac{\\omega^2\\Delta t^2}{6}\n$$\nThis is equal to the relative phase speed error $E = (c_p^{\\text{num}}-c_p)/c_p = (\\omega_{\\text{num}}/k - \\omega/k)/(\\omega/k) = \\omega_{\\text{num}}/\\omega - 1$.\nFinally, we substitute $\\omega^2 = (\\frac{-\\beta k}{K^2})^2 = \\frac{\\beta^2k^2}{K^4}$ and $K^2 = k^2+\\ell^2$:\n$$\nE \\approx - \\frac{k^2\\Delta x^2}{6} + \\frac{k^4\\Delta x^2 + \\ell^4\\Delta y^2}{12(k^2+\\ell^2)} + \\frac{\\beta^2 k^2 \\Delta t^2}{6(k^2+\\ell^2)^2}\n$$\nWe can combine the terms proportional to $\\Delta x^2$:\n$$\n\\left(-\\frac{k^2}{6} + \\frac{k^4}{12(k^2+\\ell^2)}\\right)\\Delta x^2 = \\frac{-2k^2(k^2+\\ell^2) + k^4}{12(k^2+\\ell^2)}\\Delta x^2 = \\frac{-k^4-2k^2\\ell^2}{12(k^2+\\ell^2)}\\Delta x^2 = -\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2\n$$\nThus, the final expression for the leading-order relative phase speed error is:\n$$\nE \\approx -\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2 + \\frac{\\ell^4}{12(k^2+\\ell^2)}\\Delta y^2 + \\frac{\\beta^2 k^2}{6(k^2+\\ell^2)^2}\\Delta t^2\n$$",
            "answer": "$$\n\\boxed{-\\frac{k^2(k^2+2\\ell^2)}{12(k^2+\\ell^2)}\\Delta x^2 + \\frac{\\ell^4}{12(k^2+\\ell^2)}\\Delta y^2 + \\frac{\\beta^2 k^2}{6(k^2+\\ell^2)^2}\\Delta t^2}\n$$"
        },
        {
            "introduction": "In Earth's atmosphere, the background state upon which waves propagate is non-uniform. This exercise introduces the powerful Wentzel–Kramers–Brillouin (WKB) approximation, an essential tool for analyzing wave behavior in slowly varying media . By deriving the local dispersion relation for Rossby waves and calculating a \"turning latitude,\" you will gain a tangible understanding of how the meridionally varying Coriolis parameter, $\\beta(\\phi)$, acts as a planetary waveguide.",
            "id": "4083977",
            "problem": "Consider small-amplitude barotropic perturbations governed by the Quasi-Geostrophic (QG) potential vorticity on a rotating sphere. Let the basic state be a uniform, zonal-mean flow $U$ (eastward and independent of latitude), and work in local Cartesian coordinates $(x,y)$ tangent to the sphere, with $x$ eastward, $y$ northward, and $y = a \\,\\phi$, where $a$ is the planetary radius and $\\phi$ is latitude. The Coriolis parameter is $f(\\phi) = 2 \\Omega \\sin \\phi$, where $\\Omega$ is the planetary rotation rate, so that the meridional gradient of planetary vorticity is $\\beta(\\phi) = \\partial f/\\partial y = (2 \\Omega/a)\\cos \\phi$. Assume the Wentzel–Kramers–Brillouin (WKB) approximation holds: seek a wavefield of the form $\\psi'(x,y,t) = \\Re\\{A(y)\\exp[i(k x + \\int^{y} \\ell(\\eta)\\,d\\eta - \\omega t)]\\}$ with slowly varying amplitude $A(y)$ and meridional wavenumber $\\ell(y)$, where the zonal wavenumber $k$ and the frequency $\\omega$ are independent of $y$ due to the zonal symmetry and stationarity of the background.\n\nStarting only from the linearized barotropic QG potential vorticity equation on this slowly varying background and the WKB ansatz above, derive the local leading-order relation between $\\omega$, $k$, $\\ell$, and $\\beta(\\phi)$, and use it to obtain a condition for the turning latitude $\\phi_{t}$ at which meridional propagation ceases (i.e., where the meridional wavenumber satisfies $\\ell^{2}(\\phi_{t})=0$).\n\nOn Earth, take $a = 6.371 \\times 10^{6}$, $\\Omega = 7.292115 \\times 10^{-5}$, and a uniform basic zonal flow $U = 15$. At the reference latitude $\\phi_{0} = 30^{\\circ}$, a wave packet is observed to have zonal wavenumber $k = 2.0 \\times 10^{-6}$ and meridional wavenumber magnitude $\\ell_{0} = 1.0 \\times 10^{-6}$. Assuming the wave frequency $\\omega$ and the zonal wavenumber $k$ remain constant along the meridional ray, determine the northern turning latitude $\\phi_{t}$ implied by your derived condition.\n\nExpress your final answer for $\\phi_{t}$ in degrees. Round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the established theory of quasi-geostrophic dynamics, is well-posed with sufficient information for a unique solution, and is stated using objective, formal language.\n\nThe starting point is the linearized barotropic Quasi-Geostrophic (QG) potential vorticity (PV) equation for perturbations on a uniform zonal flow $U$. The total streamfunction is $\\Psi_{total} = -Uy + \\psi'(x,y,t)$. The linearized QG PV equation is:\n$$\n\\left(\\frac{\\partial}{\\partial t} + U \\frac{\\partial}{\\partial x}\\right)\\nabla^{2}\\psi' + \\beta(y) \\frac{\\partial \\psi'}{\\partial x} = 0\n$$\nHere, $\\psi'(x,y,t)$ is the perturbation streamfunction, $\\nabla^{2} = \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}$ is the Laplacian operator, and $\\beta(y) = \\frac{df}{dy}$ is the meridional gradient of the Coriolis parameter $f$. For the sphere, with $y = a\\phi$, we have $\\beta(\\phi) = \\frac{1}{a}\\frac{df}{d\\phi} = \\frac{1}{a}\\frac{d}{d\\phi}(2\\Omega\\sin\\phi) = \\frac{2\\Omega}{a}\\cos\\phi$.\n\nWe seek a wave solution using the Wentzel–Kramers–Brillouin (WKB) approximation. The perturbation streamfunction is given in the form:\n$$\n\\psi'(x,y,t) = \\Re\\left\\{A(y)\\exp\\left[i\\left(k x + \\int^{y} \\ell(\\eta)\\,d\\eta - \\omega t\\right)\\right]\\right\\}\n$$\nLet's work with the complex counterpart $\\Psi(x,y,t) = A(y)\\exp[i(k x + \\Theta(y) - \\omega t)]$, where $\\Theta(y) = \\int^{y} \\ell(\\eta)\\,d\\eta$. The meridional wavenumber is $\\ell(y) = \\frac{d\\Theta}{dy}$. The WKB approximation assumes that the amplitude $A(y)$ and wavenumber $\\ell(y)$ vary slowly with $y$. This means their derivatives are small compared to the local wave scales.\n\nWe compute the necessary derivatives of $\\Psi$:\n$$\n\\frac{\\partial \\Psi}{\\partial t} = -i\\omega\\Psi\n$$\n$$\n\\frac{\\partial \\Psi}{\\partial x} = ik\\Psi\n$$\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial x^{2}} = -k^{2}\\Psi\n$$\nFor the $y$-derivative:\n$$\n\\frac{\\partial \\Psi}{\\partial y} = \\frac{dA}{dy}\\exp[i(\\dots)] + A(y) (i \\ell(y)) \\exp[i(\\dots)] = \\left(\\frac{A'}{A} + i\\ell\\right)\\Psi\n$$\nwhere $A' = dA/dy$. The second derivative is:\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}\\left[\\left(\\frac{A'}{A} + i\\ell\\right)\\Psi\\right] = \\left[\\frac{d}{dy}\\left(\\frac{A'}{A} + i\\ell\\right) + \\left(\\frac{A'}{A} + i\\ell\\right)^{2}\\right]\\Psi\n$$\nThe core WKB assumption is that $\\ell$ is large and changes slowly, so $|\\ell| \\gg |A'/A|$, $|\\ell'| \\ll \\ell^2$, and $|A''/A| \\ll \\ell^2$. Keeping only the highest-order terms, we have:\n$$\n\\frac{\\partial^{2} \\Psi}{\\partial y^{2}} \\approx (i\\ell)^{2}\\Psi = -\\ell^{2}\\Psi\n$$\nTherefore, the Laplacian acting on $\\Psi$ is, to leading order:\n$$\n\\nabla^{2}\\Psi = \\left(\\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}\\right)\\Psi \\approx (-k^{2} - \\ell^{2})\\Psi\n$$\nSubstituting these derivative approximations into the linearized QG PV equation:\n$$\n(-i\\omega + iUk)(-k^{2} - \\ell^{2})\\Psi + \\beta(y)(ik)\\Psi = 0\n$$\nAssuming a non-trivial solution ($\\Psi \\neq 0$) and dividing by $i$:\n$$\n(-\\omega + Uk)(-k^{2} - \\ell^{2}) + \\beta k = 0\n$$\n$$\n(\\omega - Uk)(k^{2} + \\ell^{2}) + \\beta k = 0\n$$\nRearranging for the frequency $\\omega$ gives the local dispersion relation for Rossby waves:\n$$\n\\omega = Uk - \\frac{\\beta(y) k}{k^{2} + \\ell^{2}(y)}\n$$\nThis is the required leading-order relation. It is local because $\\beta$ and $\\ell$ are functions of the meridional coordinate $y$.\n\nThe turning latitude, $\\phi_t$, is defined as the latitude where meridional propagation ceases. This occurs where the meridional wavenumber becomes zero, i.e., $\\ell(\\phi_t) = 0$, which implies $\\ell^{2}(\\phi_t) = 0$.\nSubstituting $\\ell=0$ into the dispersion relation gives the condition at the turning latitude:\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t) k}{k^{2} + 0}\n$$\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t)}{k}\n$$\nThis is the condition for the turning latitude.\n\nTo find the numerical value of $\\phi_t$, we first need to determine the conserved wave frequency $\\omega$. Since the background state is steady and zonally uniform, $\\omega$ and $k$ are conserved along the wave's path. We can calculate $\\omega$ using the given parameters at the reference latitude $\\phi_0 = 30^{\\circ}$.\nThe given values are:\n$a = 6.371 \\times 10^{6}$ m\n$\\Omega = 7.292115 \\times 10^{-5}$ rad/s\n$U = 15$ m/s\n$k = 2.0 \\times 10^{-6}$ m$^{-1}$\n$\\phi_0 = 30^{\\circ}$\n$\\ell_0 = \\ell(\\phi_0) = 1.0 \\times 10^{-6}$ m$^{-1}$\n\nFirst, we calculate the beta parameter at the reference latitude $\\phi_0 = 30^{\\circ}$:\n$$\n\\beta_0 = \\beta(\\phi_0) = \\frac{2\\Omega}{a}\\cos(\\phi_0) = \\frac{2 \\times 7.292115 \\times 10^{-5}}{6.371 \\times 10^{6}} \\cos(30^{\\circ})\n$$\n$$\n\\beta_0 \\approx (2.28915 \\times 10^{-11}) \\times \\frac{\\sqrt{3}}{2} \\approx 1.98246 \\times 10^{-11} \\text{ m}^{-1}\\text{s}^{-1}\n$$\nNow we use the full dispersion relation to find $\\omega$:\n$$\nk^{2} = (2.0 \\times 10^{-6})^{2} = 4.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\n$$\n\\ell_0^{2} = (1.0 \\times 10^{-6})^{2} = 1.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\n$$\nk^{2} + \\ell_0^{2} = 5.0 \\times 10^{-12} \\text{ m}^{-2}\n$$\nThe Doppler-shift term is $Uk = 15 \\times 2.0 \\times 10^{-6} = 3.0 \\times 10^{-5}$ s$^{-1}$.\nThe Rossby wave frequency term is:\n$$\n\\frac{\\beta_0 k}{k^{2} + \\ell_0^{2}} = \\frac{(1.98246 \\times 10^{-11}) \\times (2.0 \\times 10^{-6})}{5.0 \\times 10^{-12}} \\approx 7.92985 \\times 10^{-6} \\text{ s}^{-1}\n$$\nSo, the wave frequency $\\omega$ is:\n$$\n\\omega = 3.0 \\times 10^{-5} - 7.92985 \\times 10^{-6} = 2.207015 \\times 10^{-5} \\text{ s}^{-1}\n$$\nNow we use this conserved value of $\\omega$ in the turning latitude condition to solve for $\\beta(\\phi_t)$:\n$$\n\\omega = Uk - \\frac{\\beta(\\phi_t)}{k} \\implies \\beta(\\phi_t) = k(Uk - \\omega)\n$$\n$$\n\\beta(\\phi_t) = (2.0 \\times 10^{-6}) \\times (3.0 \\times 10^{-5} - 2.207015 \\times 10^{-5})\n$$\n$$\n\\beta(\\phi_t) = (2.0 \\times 10^{-6}) \\times (7.92985 \\times 10^{-6}) \\approx 1.58597 \\times 10^{-11} \\text{ m}^{-1}\\text{s}^{-1}\n$$\nFinally, we solve for $\\phi_t$ using the definition of $\\beta(\\phi)$:\n$$\n\\beta(\\phi_t) = \\frac{2\\Omega}{a}\\cos(\\phi_t)\n$$\n$$\n\\cos(\\phi_t) = \\frac{\\beta(\\phi_t) a}{2\\Omega} = \\frac{1.58597 \\times 10^{-11}}{2.28915 \\times 10^{-11}} \\approx 0.692820\n$$\n$$\n\\phi_t = \\arccos(0.692820)\n$$\nConverting radians to degrees:\n$$\n\\phi_t \\approx 46.1463^{\\circ}\n$$\nThe problem asks for the northern turning latitude. Since the wave originates at $\\phi_0 = 30^{\\circ}$ and this result is north of it, this is the correct latitude. Rounding the result to four significant figures gives $\\phi_t = 46.15^{\\circ}$.",
            "answer": "$$\n\\boxed{46.15}\n$$"
        }
    ]
}