{
    "hands_on_practices": [
        {
            "introduction": "Betts-Miller 方案通过将大气廓线松弛到一个稳定的参考状态来简化对流过程。但这种数学上的“松弛”与消耗对流能量的物理过程有何关联？本练习将指导您进行理论推导，将该方案的松弛时间尺度与对流有效位能（CAPE）的移除速率直接联系起来，从而揭示这种参数化方案的物理基础。",
            "id": "4016626",
            "problem": "考虑一个遵循Betts–Miller族方案的单柱对流调整，其中环境温度 $T_{e}(z)$ 和比湿 $q_{e}(z)$ 在时间尺度 $\\tau$ 内向预设的对流中性参考廓线 $T_{r}(z)$ 和 $q_{r}(z)$ 弛豫。在一个模式时间步长 $\\Delta t$ 内的弛豫表示为\n$$\nT_{e}^{\\text{new}}(z) \\;=\\; T_{e}^{\\text{old}}(z) \\;+\\; \\frac{\\Delta t}{\\tau}\\,\\bigl(T_{r}(z) - T_{e}^{\\text{old}}(z)\\bigr), \\qquad\nq_{e}^{\\text{new}}(z) \\;=\\; q_{e}^{\\text{old}}(z) \\;+\\; \\frac{\\Delta t}{\\tau}\\,\\bigl(q_{r}(z) - q_{e}^{\\text{old}}(z)\\bigr).\n$$\n假设静力平衡和理想气体定律，并使用虚温公式 $T_{v} = T \\bigl(1 + \\epsilon\\, q\\bigr)$，其中 $\\epsilon$ 是一个正常数，概括了小液态水近似下水汽的影响。对于对流有效位能 (CAPE)，从抬升凝结高度 (LCL) 处的环境状态抬升的气块按常规方式定义，其浮力由下式给出\n$$\nB(z) \\;=\\; g\\,\\frac{T_{vp}(z) - T_{ve}(z)}{T_{ve}(z)},\n$$\n其中 $g$ 是重力加速度，$T_{vp}(z)$ 是气块虚温，$T_{ve}(z)$ 是环境虚温。令 CAPE 为\n$$\nC \\;=\\; \\int_{z_{\\text{LFC}}}^{z_{\\text{EL}}} B(z)\\,dz,\n$$\n其中自由对流高度 (LFC) 和平衡高度 (EL) 按标准方式定义。假设参考廓线 $T_{r}(z)$ 和 $q_{r}(z)$ 的构建方式使得参考气块是中性浮力的，即参考态的CAPE为零，并且对于与参考态的微小偏差，$B(z)$ 通过 $T_{ve}$ 线性地依赖于 $T_{e}$ 和 $q_{e}$ 与 $T_{r}$ 和 $q_{r}$ 的偏差。\n\n从这些假设和定义出发，并将 $\\Delta t$ 内的弛豫效应视为环境偏差向参考态的线性收缩，推导一个时间步长后更新的CAPE的解析表达式，用初始CAPE $C_{0}$、时间步长 $\\Delta t$ 和弛豫时间尺度 $\\tau$ 表示。然后，通过显式欧拉离散化，将此离散更新与形式为 $\\frac{dC}{dt} = -\\frac{1}{\\tau_{c}}\\,C$ 的连续对流有效位能 (CAPE) 移除闭合方案联系起来，并用 $\\tau$ 确定闭合时间尺度 $\\tau_{c}$。\n\n将最终的CAPE以焦耳每千克 (J kg$^{-1}$) 表示，时间尺度以秒 (s) 表示。以单个解析表达式的形式提供您的最终答案，或者如果要求两个量，则以一个 $1\\times 2$ 行矩阵的形式提供，其中首先包含更新后的CAPE表达式，其次是闭合时间尺度。无需四舍五入。",
            "solution": "该问题的目标是推导 Betts-Miller 弛豫方案中 CAPE 的离散更新，并将其与一个连续的 CAPE 消耗模型联系起来。\n\n**第一部分：推导更新后的 CAPE**\n\n我们首先分析环境状态与参考态的偏差如何随时间演变。设任意变量 $\\phi$ 与其参考值 $\\phi_r$ 的偏差为 $\\delta\\phi = \\phi - \\phi_r$。给定的温度弛豫方程为：\n$$ T_{e}^{\\text{new}} = T_{e}^{\\text{old}} + \\frac{\\Delta t}{\\tau}(T_{r} - T_{e}^{\\text{old}}) $$\n从等式两边减去 $T_{r}$，可以得到温度偏差 $\\delta T_e = T_e - T_r$ 的演变关系：\n$$ T_{e}^{\\text{new}} - T_r = (T_{e}^{\\text{old}} - T_r) - \\frac{\\Delta t}{\\tau}(T_{e}^{\\text{old}} - T_r) $$\n$$ \\delta T_e^{\\text{new}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\delta T_e^{\\text{old}} $$\n同理，比湿偏差 $\\delta q_e$ 的演变也遵循相同的规律：\n$$ \\delta q_e^{\\text{new}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\delta q_e^{\\text{old}} $$\n这意味着环境廓线与参考廓线的偏差在每个时间步长后都以因子 $(1 - \\frac{\\Delta t}{\\tau})$ 进行收缩。\n\n接下来，我们考察浮力 $B(z)$ 的变化。问题假设，对于小偏差，浮力线性地依赖于环境虚温 $T_{ve}$ 的偏差。环境虚温 $T_{ve} = T_e(1 + \\epsilon q_e)$ 对参考态 $(T_r, q_r)$ 的线性化偏差为 $\\delta T_{ve} \\approx (1 + \\epsilon q_r)\\delta T_e + T_r \\epsilon \\delta q_e$。由于 $\\delta T_e$ 和 $\\delta q_e$ 都是线性收缩的，它们的线性组合 $\\delta T_{ve}$ 也必然以相同因子收缩：\n$$ \\delta T_{ve}^{\\text{new}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\delta T_{ve}^{\\text{old}} $$\n根据问题陈述，参考态是中性浮力的，即 $B_r(z) = 0$。浮力 $B(z)$ 可对参考态进行线性化，主要通过环境虚温的偏差 $\\delta T_{ve}$ 来表达。对于小偏差，可以得到 $B(z) \\propto -\\delta T_{ve}(z)$。因此，浮力廓线本身也以相同的因子进行收缩：\n$$ B^{\\text{new}}(z) = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) B^{\\text{old}}(z) $$\nCAPE 是浮力在自由对流高度 ($z_{\\text{LFC}}$) 和平衡高度 ($z_{\\text{EL}}$) 之间的积分。由于浮力廓线只是被一个常数因子缩放，其零点（即 $z_{\\text{LFC}}$ 和 $z_{\\text{EL}}$）保持不变。因此，更新后的 CAPE 为：\n$$ C^{\\text{new}} = \\int_{z_{\\text{LFC}}}^{z_{\\text{EL}}} B^{\\text{new}}(z) dz = \\int_{z_{\\text{LFC}}}^{z_{\\text{EL}}} \\left(1 - \\frac{\\Delta t}{\\tau}\\right) B^{\\text{old}}(z) dz $$\n将与积分变量无关的因子提出，我们得到：\n$$ C^{\\text{new}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) \\int_{z_{\\text{LFC}}}^{z_{\\text{EL}}} B^{\\text{old}}(z) dz = \\left(1 - \\frac{\\Delta t}{\\tau}\\right) C_0 $$\n其中 $C_0$ 是初始 CAPE。\n\n**第二部分：关联连续闭合模型**\n\n问题给出的连续 CAPE 消耗模型为 $\\frac{dC}{dt} = -\\frac{1}{\\tau_c} C$。我们使用显式（前向）欧拉方法对该常微分方程进行离散化：\n$$ \\frac{C^{\\text{new}} - C_0}{\\Delta t} = -\\frac{1}{\\tau_c} C_0 $$\n整理可得更新后的 CAPE 表达式：\n$$ C^{\\text{new}} = C_0 - \\frac{\\Delta t}{\\tau_c} C_0 = \\left(1 - \\frac{\\Delta t}{\\tau_c}\\right) C_0 $$\n将此结果与第一部分中从 Betts-Miller 方案推导出的表达式进行比较：\n$$ \\left(1 - \\frac{\\Delta t}{\\tau}\\right) C_0 = \\left(1 - \\frac{\\Delta t}{\\tau_c}\\right) C_0 $$\n为使此等式对任意非零 $C_0$ 成立，系数必须相等，即：\n$$ \\frac{\\Delta t}{\\tau} = \\frac{\\Delta t}{\\tau_c} \\implies \\tau_c = \\tau $$\n因此，CAPE 闭合方案中的消耗时间尺度 $\\tau_c$ 等于 Betts-Miller 方案中的弛豫时间尺度 $\\tau$。\n\n最终答案由更新后的 CAPE 表达式和闭合时间尺度 $\\tau_c$ 组成一个 $1\\times 2$ 行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(1 - \\frac{\\Delta t}{\\tau}\\right) C_{0}  \\tau\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从理论走向实践，实施像 Betts-Miller 这样的方案需要仔细的数值考量。如果约束不当，使用简单的前向欧拉时间步长法可能会引入不稳定性或非物理结果。本练习将让您推导出时间步长和松弛时间尺度必须满足的基本约束条件，以保证数值稳定性和温度、湿度的物理正定性。",
            "id": "4016571",
            "problem": "考虑一个遵循 Betts–Miller 族方案进行对流调整的单一大气模型层，其中预报温度 $T$ 和比湿 $q$ 在一个弛豫时间尺度 $\\tau$ 内向规定的参考廓线 $T^{\\ast}$ 和 $q^{\\ast}$ 弛豫。在连续时间内，假设弛豫定律为\n$$\\frac{dT}{dt}=-\\frac{1}{\\tau}\\left(T-T^{\\ast}\\right), \\qquad \\frac{dq}{dt}=-\\frac{1}{\\tau}\\left(q-q^{\\ast}\\right).$$\n使用前向欧拉（FE）方法取一个长度为 $\\Delta t$ 的时间步长。您将分析由此产生的离散更新，以推导确保数值稳定性和物理正定性的约束条件。\n\n从上述弛豫定律出发，并使用前向欧拉时间步进，推导出时间层 $n+1$ 上 $T$ 和 $q$ 的 FE 更新表达式，用时间层 $n$ 的值、参考值 $T^{\\ast}$、$q^{\\ast}$ 以及无量纲比率 $c=\\Delta t/\\tau$ 来表示。然后，从第一性原理出发：\n- 推导关于 $c$ 的条件，以保证线性稳定性，即在 FE 步长之后，$T$ 和 $q$ 与参考值的偏差在量级上不增长。\n- 推导关于 $c$ 的条件，以保证在已知 $T^{n}0$、$q^{n}\\ge 0$ 和物理上允许的参考值 $T^{\\ast}0$、$q^{\\ast}\\ge 0$ 的情况下，更新后的 $T^{n+1}$ 和 $q^{n+1}$ 保持正定性。将正定性约束表示为 $c$ 和参考偏差 $\\Delta T^{\\ast}=T^{\\ast}-T^{n}$ 与 $\\Delta q^{\\ast}=q^{\\ast}-q^{n}$ 的函数。\n\n最后，对以下物理上现实的单层状态和参考值评估这些约束：\n- $T^{n}=300\\,\\mathrm{K}$, $T^{\\ast}=296\\,\\mathrm{K}$,\n- $q^{n}=8\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$, $q^{\\ast}=1\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$.\n\n报告无量纲比率 $c=\\Delta t/\\tau$ 的最大允许值，该值在此情况下同时满足推导出的稳定性和正定性约束。将您的最终答案表示为一个精确的数字（无需四舍五入）。最终答案必须以纯数字形式提供，不带单位。",
            "solution": "我们分步解决这个问题：首先推导前向欧拉（FE）更新方程，然后分析其稳定性和正定性约束，最后将这些约束应用于给定的数值案例。\n\n**1. 前向欧拉（FE）更新方程**\n对于通用微分方程 $\\frac{dy}{dt}=f(y)$，FE 更新为 $y^{n+1} = y^n + \\Delta t f(y^n)$。将此应用于温度弛豫定律 $\\frac{dT}{dt}=-\\frac{1}{\\tau}(T-T^{\\ast})$：\n$$ T^{n+1} = T^n + \\Delta t \\left[ -\\frac{1}{\\tau} (T^n - T^{\\ast}) \\right] $$\n使用无量纲比率 $c = \\frac{\\Delta t}{\\tau}$，上式可写为：\n$$ T^{n+1} = T^n - c(T^n - T^{\\ast}) = (1-c)T^n + cT^{\\ast} $$\n同理，比湿 $q$ 的更新方程为：\n$$ q^{n+1} = (1-c)q^n + cq^{\\ast} $$\n\n**2. 线性稳定性约束**\n稳定性要求偏离平衡解 $T=T^{\\ast}$ 的扰动 $\\delta T = T - T^{\\ast}$ 不会随时间增长。扰动的 FE 更新方程为：\n$$ \\delta T^{n+1} = (1-c)\\delta T^n $$\n为保证稳定性，放大因子 $A = 1-c$ 的绝对值必须不大于1：\n$$ |1-c| \\le 1 \\implies -1 \\le 1-c \\le 1 $$\n这给出两个条件：$c \\le 2$ 和 $c \\ge 0$。由于 $\\Delta t$ 和 $\\tau$ 都是正物理量，所以 $c \\ge 0$ 自动满足。因此，线性稳定性约束为 $c \\le 2$。\n\n**3. 正定性约束**\n绝对温度 $T$ 必须为正 ($T>0$)，比湿 $q$ 必须为非负 ($q \\ge 0$)。\n\n对于温度，我们要求 $T^{n+1} > 0$。使用更新方程 $T^{n+1} = T^n + c(T^{\\ast} - T^n)$：\n- 如果 $T^{\\ast} \\ge T^n$（加热或平衡），由于 $T^n > 0$ 和 $c \\ge 0$，该条件自动满足。\n- 如果 $T^{\\ast}  T^n$（冷却），则必须满足 $T^n + c(T^{\\ast} - T^n) > 0$。这导致 $c(T^n - T^{\\ast})  T^n$，因此：\n  $$ c  \\frac{T^n}{T^n - T^{\\ast}} $$\n\n对于比湿，我们要求 $q^{n+1} \\ge 0$。使用更新方程 $q^{n+1} = q^n + c(q^{\\ast} - q^n)$：\n- 如果 $q^{\\ast} \\ge q^n$（增湿或平衡），由于 $q^n \\ge 0$ 和 $c \\ge 0$，该条件自动满足。\n- 如果 $q^{\\ast}  q^n$（干燥），则必须满足 $q^n + c(q^{\\ast} - q^n) \\ge 0$。这导致 $c(q^n - q^{\\ast}) \\le q^n$，因此：\n  $$ c \\le \\frac{q^n}{q^n - q^{\\ast}} $$\n\n**4. 应用于数值案例**\n给定参数值为：\n- $T^{n}=300\\,\\mathrm{K}$, $T^{\\ast}=296\\,\\mathrm{K}$\n- $q^{n}=8\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$, $q^{\\ast}=1\\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$\n\n我们现在评估对 $c$ 的三个约束：\n1.  **稳定性约束**：$c \\le 2$。\n\n2.  **温度正定性约束**：由于 $T^{\\ast}  T^n$（冷却），此约束激活：\n    $$ c  \\frac{300}{300 - 296} = \\frac{300}{4} = 75 $$\n\n3.  **湿度正定性约束**：由于 $q^{\\ast}  q^n$（干燥），此约束激活：\n    $$ c \\le \\frac{8\\times 10^{-4}}{8\\times 10^{-4} - 1\\times 10^{-4}} = \\frac{8\\times 10^{-4}}{7\\times 10^{-4}} = \\frac{8}{7} $$\n\n为了同时满足所有条件，$c$ 必须小于或等于所有上界的最小值：\n$$ c \\le \\min\\left(2, \\frac{8}{7}\\right) \\quad \\text{并且} \\quad c  75 $$\n由于 $\\frac{8}{7} \\approx 1.14$，$2 = \\frac{14}{7}$，最严格的约束是 $c \\le \\frac{8}{7}$。因此，$c$ 的最大允许值为 $\\frac{8}{7}$。",
            "answer": "$$\\boxed{\\frac{8}{7}}$$"
        },
        {
            "introduction": "一个稳健的数值方案不仅必须稳定，还必须遵守控制系统的物理定律。对湿度而言，这意味着要防止出现负值或超饱和等非物理状态。这项实践练习要求您为 Betts-Miller 湿调节方案设计并实现一个“限制器”，这是一个关键组件，它通过将方案的倾向项与克劳修斯-克拉佩龙关系联系起来，确保最终状态保持在物理允许的范围内。",
            "id": "4016635",
            "problem": "您的任务是为数值天气预报和气候模型中的 Betts–Miller 系列对流调整方案设计并实现一个数学上一致的对流湿度调整限制器。目标是确保调整步骤的应用不会在任何模型层级上产生超饱和或负湿度。您的实现必须基于第一性原理和经过充分检验的物理公式。\n\n请使用以下背景和要求：\n\n- Betts–Miller 对流调整在时间步长 $\\Delta t$ 内，根据比湿的预报源项，将比湿 $q$ 在弛豫时间尺度 $\\tau$ 上向参考廓线 $q_{\\mathrm{ref}}$ 弛豫：\n  $$ \\frac{dq}{dt} = \\frac{q_{\\mathrm{ref}} - q}{\\tau}. $$\n  若没有任何限制器，在一个时间步长内的前向更新将得到\n  $$ q_{\\mathrm{raw}} = q + \\Delta t \\frac{q_{\\mathrm{ref}} - q}{\\tau}. $$\n\n- 每个层级的比湿的物理允许集是\n  $$ 0 \\le q \\le q_s(T,p), $$\n  其中 $q_s(T,p)$ 是在温度 $T$ 和压力 $p$ 下液态水的饱和比湿。您必须使用 Clausius–Clapeyron 关系式计算饱和水汽压，并使用基于理想气体的比湿定义来计算 $q_s(T,p)$。请使用以下经过充分检验且被广泛接受的公式和常数：\n  - 液态水的饱和水汽压：\n    $$ e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right), $$\n    其中 $e_0 = 611.2\\,\\mathrm{Pa}$，$L_v = 2.5\\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，以及 $T_0 = 273.15\\,\\mathrm{K}$。\n  - 饱和比湿：\n    $$ q_s(T,p) = \\frac{\\varepsilon\\, e_s(T)}{p - \\left(1 - \\varepsilon\\right)\\, e_s(T)}, \\qquad \\varepsilon = \\frac{R_d}{R_v}, $$\n    其中 $R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n\n- 您的限制器必须作用于对流增量，使得最终更新的比湿 $q_{\\mathrm{new}}$ 在每个层级上都满足 $0 \\le q_{\\mathrm{new}} \\le q_s(T,p)$。该限制器必须被表述和实现为一个数学上定义明确的操作，该操作能保持更新的单调性并避免引入人为振荡。\n\n- 从预报源项和物理允许集出发，基于第一性原理设计该限制器。推导受限更新必须满足的条件，并构建一个稳健的算法来强制执行这些条件。\n\n- 单位和数值约束：\n  - 温度 $T$ 的单位必须是 $\\mathrm{K}$。\n  - 压力 $p$ 的单位必须是 $\\mathrm{Pa}$。\n  - 比湿 $q$ 和 $q_{\\mathrm{ref}}$ 的单位必须是 $\\mathrm{kg\\,kg^{-1}}$。\n  - 时间尺度 $\\tau$ 和时间步长 $\\Delta t$ 的单位必须是 $\\mathrm{s}$。\n  - 最终答案必须以 $\\mathrm{kg\\,kg^{-1}}$ 为单位报告。\n\n在一个程序中实现您的算法，该程序处理以下由六个独立的单层级案例组成的测试套件。每个案例是一个元组 $(T, p, q, q_{\\mathrm{ref}}, \\tau, \\Delta t)$，单位如上所述：\n\n- 案例 1：$(300, 90000, 0.012, 0.014, 1800, 600)$\n- 案例 2：$(300, 90000, 0.0249, 0.030, 900, 900)$\n- 案例 3：$(300, 90000, 0.0010, 0.0000, 600, 1200)$\n- 案例 4：$(290, 100000, 0.0100, 0.0100, 600, 600)$\n- 案例 5：$(300, 90000, 0.0260, 0.0240, 6000, 600)$\n- 案例 6：$(270, 80000, 0.0040, 0.0060, 600, 600)$\n\n对于每个案例，使用上述公式计算 $q_s(T,p)$，在 $\\Delta t$ 上应用 Betts–Miller 对流弛豫，并强制执行您的限制器，以使返回的 $q_{\\mathrm{new}}$ 满足允许的边界。程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个值四舍五入到六位小数，并以 $\\mathrm{kg\\,kg^{-1}}$ 为单位表示，例如：\n$$ [q_{\\mathrm{new},1}, q_{\\mathrm{new},2}, q_{\\mathrm{new},3}, q_{\\mathrm{new},4}, q_{\\mathrm{new},5}, q_{\\mathrm{new},6}] $$\n其中 $q_{\\mathrm{new},i}$ 对应于案例 $i$。",
            "solution": "此问题的核心是设计一个限制器，以确保更新后的比湿 $q_{\\mathrm{new}}$ 保持在物理允许的范围 $[0, q_s(T,p)]$ 内。一个数值上稳健且物理上一致的方法是限制作用于比湿的倾向项（或源项），而不是简单地在更新后裁剪结果。\n\n设比湿的倾向项为 $S = dq/dt$。使用前向欧拉方法，更新后的比湿为 $q_{\\mathrm{new}} = q + S \\Delta t$。\n为了满足物理边界 $0 \\le q_{\\mathrm{new}} \\le q_s$，倾向项 $S$ 必须满足以下条件：\n1.  $q + S \\Delta t \\ge 0 \\implies S \\ge -q / \\Delta t$\n2.  $q + S \\Delta t \\le q_s \\implies S \\le (q_s - q) / \\Delta t$\n\n这两个条件定义了倾向项的允许区间 $[S_{\\mathrm{min}}, S_{\\mathrm{max}}]$，其中：\n$$ S_{\\mathrm{min}} = -\\frac{q}{\\Delta t} $$\n$$ S_{\\mathrm{max}} = \\frac{q_s(T,p) - q}{\\Delta t} $$\n\nBetts-Miller 方案给出的原始倾向项为：\n$$ S_{\\mathrm{raw}} = \\frac{q_{\\mathrm{ref}} - q}{\\tau} $$\n\n限制器的作用就是将这个原始倾向项 $S_{\\mathrm{raw}}$ 投影到允许的区间 $[S_{\\mathrm{min}}, S_{\\mathrm{max}}]$ 内。因此，受限的倾向项 $S_{\\mathrm{lim}}$ 为：\n$$ S_{\\mathrm{lim}} = \\max(S_{\\mathrm{min}}, \\min(S_{\\mathrm{raw}}, S_{\\mathrm{max}})) $$\n这种方法确保如果原始倾向项已经位于物理边界内，则保持不变；如果超出边界，则被调整到最近的有效值。\n\n最终更新的比湿使用这个受限的倾向项计算：\n$$ q_{\\mathrm{new}} = q + \\Delta t S_{\\mathrm{lim}} $$\n根据构造，这个 $q_{\\mathrm{new}}$ 保证在 $[0, q_s(T,p)]$ 的范围内。\n\n**算法步骤**\n对于每个给定的案例 $(T, p, q, q_{\\mathrm{ref}}, \\tau, \\Delta t)$：\n1.  使用给定的公式和常数计算饱和比湿 $q_s(T,p)$。\n2.  计算原始倾向项 $S_{\\mathrm{raw}} = (q_{\\mathrm{ref}} - q)/\\tau$。\n3.  计算允许倾向项区间的边界 $S_{\\mathrm{min}} = -q/\\Delta t$ 和 $S_{\\mathrm{max}} = (q_s - q)/\\Delta t$。\n4.  计算受限的倾向项 $S_{\\mathrm{lim}} = \\max(S_{\\mathrm{min}}, \\min(S_{\\mathrm{raw}}, S_{\\mathrm{max}}))$。\n5.  计算最终的比湿 $q_{\\mathrm{new}} = q + \\Delta t S_{\\mathrm{lim}}$。\n\n将此算法应用于所有六个测试案例，并对结果进行四舍五入，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\text{[0.012667, 0.026048, 0.000000, 0.010000, 0.025800, 0.003713]}}\n$$"
        }
    ]
}