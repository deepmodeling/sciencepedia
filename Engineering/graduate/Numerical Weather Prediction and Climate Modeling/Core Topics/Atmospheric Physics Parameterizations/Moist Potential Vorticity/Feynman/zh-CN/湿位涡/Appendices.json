{
    "hands_on_practices": [
        {
            "introduction": "在深入研究湿位涡的复杂动态之前，首先建立对其物理本质的直观理解是至关重要的。这项练习通过量纲分析和尺度分析，将一个抽象的数学定义与大气的实际物理量联系起来，帮助您掌握湿位涡（MPV）的基本单位及其在真实天气系统中的典型量级 。这种基础性的实践对于培养物理直觉和验证数值模型输出的合理性至关重要。",
            "id": "4066898",
            "problem": "湿埃特尔位涡的一个干空气可逆类似物，其定义为将绝对涡度投影到物质守恒的湿位温梯度上，并用质量密度进行归一化。设该物质守恒标量为湿位温，记作 $\\theta_{m}$，并将标量 $q$ 定义为绝对涡度矢量在 $\\nabla \\theta_{m}$ 上的投影经密度归一化后得到的量。\n\n任务 1 (量纲)：仅使用基本量纲质量 $M$、长度 $L$、时间 $T$ 和热力学温度 $\\Theta$，确定 $q$ 的物理量纲。\n\n任务 2 (典型量级)：假设以下科学上合理的条件，并仅使用基本关系式，评估 $q$ 在自由对流层中的一个代表性中纬度量级：\n- 纬度 $\\phi = 45^\\circ$；地球自转速率 $\\Omega = 7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1}$；取绝对涡度的垂直分量由科里奥利参数 $f = 2 \\Omega \\sin \\phi$ 主导。\n- 静力稳定度由布伦特–维萨拉频率 (BVF) $N = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$ 和一个代表性的参考湿位温 $\\theta_{0} = 300\\ \\mathrm{K}$ 表征，因此在静力平衡、稳定分层条件下，垂直位温梯度满足 $N^{2} = \\frac{g}{\\theta_{0}} \\frac{\\partial \\theta_{m}}{\\partial z}$，其中引力加速度 $g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$。假设水平梯度相对于垂直梯度较小，因此 $|\\nabla \\theta_{m}| \\approx \\left|\\frac{\\partial \\theta_{m}}{\\partial z}\\right|$ 且垂直投影占主导地位。\n- 对流层中部的热力学状态代表为 $p = 700\\ \\mathrm{hPa}$ 和 $T = 270\\ \\mathrm{K}$；使用理想气体定律 $p = \\rho R_{d} T$（其中 $R_{d} = 287\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$）来确定密度 $\\rho$。\n\n在这些假设下，将 $q$ 的量级视为 $|q| \\approx \\frac{1}{\\rho}\\,|f|\\,\\left|\\frac{\\partial \\theta_{m}}{\\partial z}\\right|$。将最终的数值量级以位涡单位 (Potential Vorticity Unit, PVU) 表示，其中 $1\\ \\mathrm{PVU} = 10^{-6}\\ \\mathrm{K}\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-1}$。将数值量级四舍五入至三位有效数字。\n\n答案格式：以单行矩阵的形式返回您的最终答案，其中包含按此顺序排列的两个条目：\n1) 使用 $M$、$L$、$T$ 和 $\\Theta$ 书写的 $q$ 的基本量纲单项式；\n2) 以 PVU 为单位的数值量级。矩阵内不包含任何单位。角度如所述以度为单位。",
            "solution": "该问题经证实是自洽的、有科学依据且提法恰当。所描述的量是 Ertel 位涡 (PV) 的一个变体，是地球物理流体动力学中的一个基本概念。所有给定的常数和物理条件都是标准且合理的。计算按要求分两部分进行。\n\n### 任务 1：物理量纲的确定\n\n量 $q$ 定义为绝对涡度矢量 $\\vec{\\zeta}_a$ 在湿位温梯度 $\\nabla \\theta_m$ 上的投影，并用质量密度 $\\rho$ 进行归一化。其数学表达式为：\n$$\nq = \\frac{1}{\\rho} (\\vec{\\zeta}_a \\cdot \\nabla \\theta_m)\n$$\n为确定 $q$ 的物理量纲，我们使用质量 ($M$)、长度 ($L$)、时间 ($T$) 和热力学温度 ($\\Theta$) 这些基本量纲来分析每个分量的量纲。\n\n1.  **质量密度 ($\\rho$)**: 密度是单位体积的质量。其量纲为：\n    $$\n    [\\rho] = \\frac{M}{L^3} = M L^{-3}\n    $$\n\n2.  **绝对涡度 ($\\vec{\\zeta}_a$)**: 绝对涡度是相对涡度 ($\\nabla \\times \\vec{u}$) 和行星涡度 ($2\\vec{\\Omega}$) 的和。这两项都具有频率（时间的倒数）的量纲，因为速度 $\\vec{u}$ 的量纲是 $L T^{-1}$，梯度算子 $\\nabla$ 的量纲是 $L^{-1}$，这使得 $[\\nabla \\times \\vec{u}] = L^{-1} \\cdot L T^{-1} = T^{-1}$。地球自转速率 $\\vec{\\Omega}$ 也具有频率的量纲 $T^{-1}$。因此，绝对涡度的量纲是：\n    $$\n    [\\vec{\\zeta}_a] = T^{-1}\n    $$\n\n3.  **湿位温 ($\\theta_m$)**: 这是一个热力学温度量。其量纲是：\n    $$\n    [\\theta_m] = \\Theta\n    $$\n\n4.  **湿位温梯度 ($\\nabla \\theta_m$)**: 梯度算子 $\\nabla$ 具有长度倒数的量纲 $L^{-1}$。因此，$\\theta_m$ 的梯度的量纲是：\n    $$\n    [\\nabla \\theta_m] = [\\nabla] [\\theta_m] = L^{-1} \\Theta\n    $$\n\n综合这些，点积 $\\vec{\\zeta}_a \\cdot \\nabla \\theta_m$ 的量纲是这两个矢量量纲的乘积：\n$$\n[\\vec{\\zeta}_a \\cdot \\nabla \\theta_m] = [\\vec{\\zeta}_a] [\\nabla \\theta_m] = (T^{-1}) (L^{-1} \\Theta) = L^{-1} T^{-1} \\Theta\n$$\n\n最后，我们将上式除以密度的量纲，得到 $q$ 的量纲：\n$$\n[q] = \\frac{[\\vec{\\zeta}_a \\cdot \\nabla \\theta_m]}{[\\rho]} = \\frac{L^{-1} T^{-1} \\Theta}{M L^{-3}} = M^{-1} L^{2} T^{-1} \\Theta\n$$\n这个量纲形式对应于位涡的标准单位 $\\mathrm{K}\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-1}$。\n\n### 任务 2：代表性量级的评估\n\n该问题为典型中纬度条件下的 $q$ 的量级提供了一个近似表达式：\n$$\n|q| \\approx \\frac{1}{\\rho}\\,|f|\\,\\left|\\frac{\\partial \\theta_{m}}{\\partial z}\\right|\n$$\n我们将使用所提供的数据计算此表达式中的每一项，并确保所有单位都采用国际单位制 (SI)。\n\n1.  **科里奥利参数 ($f$)**: 科里奥利参数由 $f = 2 \\Omega \\sin \\phi$ 给出。\n    已知：$\\Omega = 7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1}$ 和 $\\phi = 45^\\circ$。\n    $$\n    f = 2 \\times (7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1}) \\times \\sin(45^\\circ) = 2 \\times (7.292 \\times 10^{-5}) \\times \\frac{\\sqrt{2}}{2} = \\sqrt{2} \\times 7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1} \\approx 1.03125 \\times 10^{-4}\\ \\mathrm{s}^{-1}\n    $$\n\n2.  **湿位温的垂直梯度 ($\\frac{\\partial \\theta_{m}}{\\partial z}$)**: 该项由布伦特–维萨拉频率的定义 $N^2 = \\frac{g}{\\theta_{0}} \\frac{\\partial \\theta_{m}}{\\partial z}$ 导出。\n    已知：$N = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$，$\\theta_0 = 300\\ \\mathrm{K}$，以及 $g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$。\n    重新整理以求解梯度可得：\n    $$\n    \\frac{\\partial \\theta_{m}}{\\partial z} = \\frac{N^2 \\theta_0}{g} = \\frac{(1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1})^2 \\times (300\\ \\mathrm{K})}{9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}} = \\frac{1.0 \\times 10^{-4}\\ \\mathrm{s}^{-2} \\times 300\\ \\mathrm{K}}{9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}} = \\frac{0.03}{9.81}\\ \\mathrm{K}\\ \\mathrm{m}^{-1} \\approx 0.0030581\\ \\mathrm{K}\\ \\mathrm{m}^{-1}\n    $$\n\n3.  **质量密度 ($\\rho$)**: 密度由理想气体定律 $p = \\rho R_{d} T$ 确定。\n    已知：$p = 700\\ \\mathrm{hPa} = 700 \\times 100\\ \\mathrm{Pa} = 7 \\times 10^{4}\\ \\mathrm{Pa}$，$T = 270\\ \\mathrm{K}$，以及 $R_d = 287\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$。注意 $1\\ \\mathrm{J} = 1\\ \\mathrm{N}\\ \\mathrm{m}$ 且 $1\\ \\mathrm{Pa} = 1\\ \\mathrm{N}\\ \\mathrm{m}^{-2}$，因此单位是一致的。\n    重新整理以求解密度可得：\n    $$\n    \\rho = \\frac{p}{R_d T} = \\frac{7 \\times 10^4\\ \\mathrm{Pa}}{(287\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}) \\times (270\\ \\mathrm{K})} = \\frac{70000}{77490}\\ \\mathrm{kg}\\ \\mathrm{m}^{-3} \\approx 0.90334\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}\n    $$\n\n现在，我们将这些值代入 $|q|$ 的表达式中：\n$$\n|q| \\approx \\frac{1}{0.90334\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}} \\times (1.03125 \\times 10^{-4}\\ \\mathrm{s}^{-1}) \\times (0.0030581\\ \\mathrm{K}\\ \\mathrm{m}^{-1})\n$$\n$$\n|q| \\approx (1.10699\\ \\mathrm{m}^3\\ \\mathrm{kg}^{-1}) \\times (1.03125 \\times 10^{-4}\\ \\mathrm{s}^{-1}) \\times (0.0030581\\ \\mathrm{K}\\ \\mathrm{m}^{-1})\n$$\n$$\n|q| \\approx 3.4926 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-1}\n$$\n\n最后，我们将此量级转换为位涡单位 (PVU)，其中 $1\\ \\mathrm{PVU} = 10^{-6}\\ \\mathrm{K}\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-1}$。\n$$\n|q|_{\\mathrm{PVU}} = \\frac{3.4926 \\times 10^{-7}}{10^{-6}} = 0.34926\n$$\n四舍五入到三位有效数字，量级为 $0.349$ PVU。\n\n最终答案要求一个包含任务1的量纲公式和任务2的数值结果的矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nM^{-1} L^{2} T^{-1} \\Theta  0.349\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "湿位涡的威力不仅在于其在绝热无摩擦过程中的守恒性，更在于非守恒过程如何生成或耗散它，从而驱动天气系统的发展。本练习将推导湿位涡倾向方程，并引导您通过尺度分析，量化和比较潜热释放（例如，在风暴中）与摩擦这两个关键过程对湿位涡变化的相对贡献 。理解这些源汇项是诊断气旋生成和预报恶劣天气的核心技能。",
            "id": "4066835",
            "problem": "在数值天气预报（NWP）和气候模拟的框架下，考虑一个中纬度的湿斜压区。设湿埃特尔位涡由相当位温定义为 $q_{m} = \\frac{1}{\\rho}\\,\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e}$，其中 $\\rho$ 是空气密度，$\\boldsymbol{\\omega}_{a}$ 是绝对涡度，$\\theta_{e}$ 是相当位温。从旋转、可压缩的纳维-斯托克斯动量方程（包含非保守比力 $\\boldsymbol{F}$）、质量连续性方程以及 $\\theta_{e}$ 的热力学能量方程出发，根据第一性原理推导 $q_{m}$ 的随体趋势形式，并清晰地指出与非绝热加热和摩擦相关的各自贡献。然后，在以下科学上一致的尺度假设下，量化非绝热与摩擦引起的 $q_{m}$ 趋势的相对量级，该相对量级定义为比率\n$$\nR \\equiv \\frac{\\text{magnitude of diabatic } \\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t}}{\\text{magnitude of frictional } \\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t}}.\n$$\n假设：\n- 空气密度为 $\\rho = 1.0~\\mathrm{kg\\,m^{-3}}$，绝对涡度矢量 $\\boldsymbol{\\omega}_{a}$ 以其垂直分量为主，其量级为 $|\\boldsymbol{\\omega}_{a}| = f + \\zeta$，其中科里奥利参数 $f = 1.0\\times 10^{-4}~\\mathrm{s^{-1}}$，相对涡度的垂直分量为 $\\zeta = 0.5\\times 10^{-4}~\\mathrm{s^{-1}}$。\n- 相当位温的垂直梯度为 $|\\partial \\theta_{e}/\\partial z| = 4.0~\\mathrm{K\\,km^{-1}}$，且该垂直梯度在 $|\\nabla\\theta_{e}|$ 中占主导地位。\n- 非绝热加热率廓线满足 $|\\partial \\dot{\\theta}_{e}/\\partial z| \\approx \\Delta\\dot{\\theta}_{e}/H$，其中加热率在一个厚度为 $H = 2.0~\\mathrm{km}$ 的加热层内，从底部的 $\\Delta\\dot{\\theta}_{e} = 3.0~\\mathrm{K\\,hour^{-1}}$ 递减到顶部的近似为零。\n- 近地面的摩擦比力量级为 $|\\boldsymbol{F}| \\approx \\tau/(\\rho h)$，其中地表应力 $\\tau = 0.3~\\mathrm{N\\,m^{-2}}$，边界层厚度 $h = 1.0~\\mathrm{km}$。其空间旋度在一个水平尺度 $L = 300~\\mathrm{km}$ 上估计为 $|\\nabla\\times\\boldsymbol{F}| \\approx |\\boldsymbol{F}|/L$。\n- 几何排列使得相关的点积通过投影到主导的垂直分量上而达到最大化（即，在进行量级估算时，取配对矢量之间夹角的余弦为1）。\n\n将最终比率 $R$ 表示为一个纯数。将您的答案四舍五入到三位有效数字。该比率不需要单位。",
            "solution": "该问题需要一个分为两部分的解答：首先，推导湿埃特尔位涡 $q_m$ 的随体趋势；其次，根据给定的尺度假设，量化非绝热趋势与摩擦趋势的比率。\n\n首先，我们推导湿位涡 $q_m$ 随体趋势的控制方程。湿埃特尔位涡定义为：\n$$\nq_{m} = \\frac{1}{\\rho}\\,\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e}\n$$\n其中 $\\rho$ 是空气密度，$\\boldsymbol{\\omega}_{a}$ 是三维绝对涡度矢量，$\\theta_{e}$ 是相当位温。\n\n为了求得随体趋势，我们对 $q_m$ 取随体导数 $\\frac{\\mathrm{D}}{\\mathrm{D}t} \\equiv \\frac{\\partial}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla$：\n$$\n\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t} = \\frac{\\mathrm{D}}{\\mathrm{D}t} \\left( \\frac{1}{\\rho}\\,\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e} \\right)\n$$\n使用乘法法则，我们将此表达式展开为三项：\n$$\n\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t} = \\frac{\\mathrm{D}(1/\\rho)}{\\mathrm{D}t} (\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e}) + \\frac{1}{\\rho}\\frac{\\mathrm{D}\\boldsymbol{\\omega}_{a}}{\\mathrm{D}t}\\cdot\\nabla\\theta_{e} + \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot\\frac{\\mathrm{D}(\\nabla\\theta_{e})}{\\mathrm{D}t}\n$$\n我们对每一项进行评估。\n\n第1项：根据质量连续性方程 $\\frac{\\mathrm{D}\\rho}{\\mathrm{D}t} + \\rho(\\nabla \\cdot \\boldsymbol{u}) = 0$，我们可以写出 $\\frac{\\mathrm{D}(1/\\rho)}{\\mathrm{D}t} = -\\frac{1}{\\rho^2}\\frac{\\mathrm{D}\\rho}{\\mathrm{D}t} = -\\frac{1}{\\rho^2}(-\\rho(\\nabla \\cdot \\boldsymbol{u})) = \\frac{1}{\\rho}(\\nabla \\cdot \\boldsymbol{u})$。\n\n第2项：绝对涡度 $\\boldsymbol{\\omega}_{a} = \\nabla\\times\\boldsymbol{u} + 2\\boldsymbol{\\Omega}$ 的演变由涡度方程描述，该方程是通过对纳维-斯托克斯动量方程 $\\frac{\\mathrm{D}\\boldsymbol{u}}{\\mathrm{D}t} + 2\\boldsymbol{\\Omega}\\times\\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p - \\nabla\\Phi + \\boldsymbol{F}$ 取旋度得到的。最终的涡度方程为：\n$$\n\\frac{\\mathrm{D}\\boldsymbol{\\omega}_{a}}{\\mathrm{D}t} = (\\boldsymbol{\\omega}_{a}\\cdot\\nabla)\\boldsymbol{u} - \\boldsymbol{\\omega}_{a}(\\nabla\\cdot\\boldsymbol{u}) + \\frac{1}{\\rho^2}(\\nabla\\rho \\times \\nabla p) + \\nabla\\times\\boldsymbol{F}\n$$\n这里，$(\\boldsymbol{\\omega}_{a}\\cdot\\nabla)\\boldsymbol{u}$ 是伸缩/倾斜项，$-\\boldsymbol{\\omega}_{a}(\\nabla\\cdot\\boldsymbol{u})$ 是辐散项，$\\frac{1}{\\rho^2}(\\nabla\\rho \\times \\nabla p)$ 是螺线管（斜压）项，$\\nabla\\times\\boldsymbol{F}$ 是摩擦项。\n\n第3项：标量 $\\theta_e$ 的梯度的随体导数由恒等式 $\\frac{\\mathrm{D}(\\nabla \\theta_e)}{\\mathrm{D}t} = \\nabla\\left(\\frac{\\mathrm{D}\\theta_{e}}{\\mathrm{D}t}\\right) - (\\nabla\\boldsymbol{u})^T \\cdot \\nabla\\theta_{e}$ 给出。令 $\\dot{\\theta}_{e} = \\frac{\\mathrm{D}\\theta_{e}}{\\mathrm{D}t}$ 为 $\\theta_e$ 的非绝热源项。则：\n$$\n\\frac{\\mathrm{D}(\\nabla\\theta_{e})}{\\mathrm{D}t} = \\nabla\\dot{\\theta}_{e} - (\\nabla\\boldsymbol{u})^T \\cdot \\nabla\\theta_{e}\n$$\n\n将这些表达式代回到 $\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t}$ 的方程中：\n$$\n\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t} = \\frac{1}{\\rho}(\\nabla \\cdot \\boldsymbol{u}) (\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e}) + \\frac{1}{\\rho}\\left[ (\\boldsymbol{\\omega}_{a}\\cdot\\nabla)\\boldsymbol{u} - \\boldsymbol{\\omega}_{a}(\\nabla\\cdot\\boldsymbol{u}) + \\frac{\\nabla\\rho \\times \\nabla p}{\\rho^2} + \\nabla\\times\\boldsymbol{F} \\right]\\cdot\\nabla\\theta_{e} + \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot\\left[\\nabla\\dot{\\theta}_{e} - (\\nabla\\boldsymbol{u})^T \\cdot \\nabla\\theta_{e} \\right]\n$$\n有几项会相互抵消。辐散项抵消：$\\frac{1}{\\rho}(\\nabla \\cdot \\boldsymbol{u}) (\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta_{e}) - \\frac{1}{\\rho}(\\boldsymbol{\\omega}_{a}(\\nabla\\cdot\\boldsymbol{u}))\\cdot\\nabla\\theta_{e} = 0$。涉及速度梯度张量 $\\nabla\\boldsymbol{u}$ 的项也抵消：$\\frac{1}{\\rho}((\\boldsymbol{\\omega}_{a}\\cdot\\nabla)\\boldsymbol{u})\\cdot\\nabla\\theta_{e} - \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot((\\nabla\\boldsymbol{u})^T \\cdot \\nabla\\theta_{e}) = 0$。如果压强只是密度和 $\\theta_e$ 的函数，即 $p=p(\\rho, \\theta_e)$（这是一个标准假设），那么螺线管项 $\\frac{1}{\\rho^3}(\\nabla\\rho \\times \\nabla p) \\cdot\\nabla\\theta_{e}$ 为零。这样就只剩下与非绝热加热（$\\dot{\\theta}_{e}$）和摩擦（$\\boldsymbol{F}$）相关的项。\n\n湿位涡趋势方程的最终形式是：\n$$\n\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t} = \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\dot{\\theta}_{e} + \\frac{1}{\\rho}(\\nabla\\times\\boldsymbol{F})\\cdot\\nabla\\theta_{e}\n$$\n右侧的第一项 $(\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t})_{\\text{dia}} = \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\dot{\\theta}_{e}$，表示由非绝热过程生成的 $q_m$。第二项 $(\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t})_{\\text{fric}} = \\frac{1}{\\rho}(\\nabla\\times\\boldsymbol{F})\\cdot\\nabla\\theta_{e}$，表示由摩擦生成/耗散的 $q_m$。\n\n接下来，我们量化这两项的量级之比 $R$：\n$$\nR = \\frac{\\left| \\left(\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t}\\right)_{\\text{dia}} \\right|}{\\left| \\left(\\frac{\\mathrm{D}q_{m}}{\\mathrm{D}t}\\right)_{\\text{fric}} \\right|} = \\frac{\\left| \\frac{1}{\\rho}\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\dot{\\theta}_{e} \\right|}{\\left| \\frac{1}{\\rho}(\\nabla\\times\\boldsymbol{F})\\cdot\\nabla\\theta_{e} \\right|} = \\frac{|\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\dot{\\theta}_{e}|}{|(\\nabla\\times\\boldsymbol{F})\\cdot\\nabla\\theta_{e}|}\n$$\n我们使用给定的尺度假设来估计分子和分母的量级。问题陈述，点积因主导垂直分量的对齐而最大化，因此我们可以用矢量量级的乘积来近似点积。\n\n分子：$|\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\dot{\\theta}_{e}| \\approx |\\boldsymbol{\\omega}_{a}||\\nabla\\dot{\\theta}_{e}|$\n-   绝对涡度量级：$|\\boldsymbol{\\omega}_{a}| = f + \\zeta = 1.0\\times 10^{-4}~\\mathrm{s^{-1}} + 0.5\\times 10^{-4}~\\mathrm{s^{-1}} = 1.5\\times 10^{-4}~\\mathrm{s^{-1}}$。\n-   非绝热加热梯度：$|\\nabla\\dot{\\theta}_{e}| \\approx |\\partial \\dot{\\theta}_{e}/\\partial z| \\approx \\Delta\\dot{\\theta}_{e}/H$。\n-   首先，将单位转换为国际单位制（SI）：\n    -   $\\Delta\\dot{\\theta}_{e} = 3.0~\\mathrm{K\\,hour^{-1}} = \\frac{3.0~\\mathrm{K}}{3600~\\mathrm{s}} = \\frac{1}{1200}~\\mathrm{K\\,s^{-1}}$。\n    -   $H = 2.0~\\mathrm{km} = 2000~\\mathrm{m}$。\n-   因此，$|\\nabla\\dot{\\theta}_{e}| \\approx \\frac{1/1200~\\mathrm{K\\,s^{-1}}}{2000~\\mathrm{m}} = \\frac{1}{2.4 \\times 10^6}~\\mathrm{K\\,m^{-1}\\,s^{-1}}$。\n-   分子量级 $\\approx (1.5\\times 10^{-4}~\\mathrm{s^{-1}}) \\times (\\frac{1}{2.4 \\times 10^6}~\\mathrm{K\\,m^{-1}\\,s^{-1}}) = \\frac{1.5}{2.4} \\times 10^{-10}~\\mathrm{K\\,m^{-1}\\,s^{-2}} = 6.25 \\times 10^{-11}~\\mathrm{K\\,m^{-1}\\,s^{-2}}$。\n\n分母：$|(\\nabla\\times\\boldsymbol{F})\\cdot\\nabla\\theta_{e}| \\approx |\\nabla\\times\\boldsymbol{F}||\\nabla\\theta_{e}|$\n-   相当位温梯度：$|\\nabla\\theta_{e}| \\approx |\\partial\\theta_{e}/\\partial z|$。\n    -   $|\\partial\\theta_{e}/\\partial z| = 4.0~\\mathrm{K\\,km^{-1}} = \\frac{4.0~\\mathrm{K}}{1000~\\mathrm{m}} = 4.0 \\times 10^{-3}~\\mathrm{K\\,m^{-1}}$。\n-   摩擦力旋度：$|\\nabla\\times\\boldsymbol{F}| \\approx |\\boldsymbol{F}|/L$。\n    -   摩擦力量级：$|\\boldsymbol{F}| \\approx \\tau/(\\rho h)$。\n    -   将单位转换为国际单位制（SI）：\n        -   $\\tau = 0.3~\\mathrm{N\\,m^{-2}} = 0.3~\\mathrm{kg\\,m^{-1}\\,s^{-2}}$。\n        -   $\\rho = 1.0~\\mathrm{kg\\,m^{-3}}$。\n        -   $h = 1.0~\\mathrm{km} = 1000~\\mathrm{m}$。\n    -   $|\\boldsymbol{F}| \\approx \\frac{0.3~\\mathrm{kg\\,m^{-1}\\,s^{-2}}}{(1.0~\\mathrm{kg\\,m^{-3}})(1000~\\mathrm{m})} = 3.0 \\times 10^{-4}~\\mathrm{m\\,s^{-2}}$。\n    -   现在，我们计算旋度的量级：\n        -   $L = 300~\\mathrm{km} = 3.0 \\times 10^5~\\mathrm{m}$。\n        -   $|\\nabla\\times\\boldsymbol{F}| \\approx \\frac{3.0 \\times 10^{-4}~\\mathrm{m\\,s^{-2}}}{3.0 \\times 10^5~\\mathrm{m}} = 1.0 \\times 10^{-9}~\\mathrm{s^{-2}}$。\n-   分母量级 $\\approx (1.0 \\times 10^{-9}~\\mathrm{s^{-2}}) \\times (4.0 \\times 10^{-3}~\\mathrm{K\\,m^{-1}}) = 4.0 \\times 10^{-12}~\\mathrm{K\\,m^{-1}\\,s^{-2}}$。\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{6.25 \\times 10^{-11}~\\mathrm{K\\,m^{-1}\\,s^{-2}}}{4.0 \\times 10^{-12}~\\mathrm{K\\,m^{-1}\\,s^{-2}}} = \\frac{6.25}{0.40} = 15.625\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\nR \\approx 15.6\n$$\n该结果表明，对于给定的典型中纬度风暴参数，在生成湿位涡异常方面，非绝热加热比边界层摩擦要重要一个数量级以上。",
            "answer": "$$\n\\boxed{15.6}\n$$"
        },
        {
            "introduction": "位涡反演是现代动力气象学的基石，它揭示了一个深刻的原理：在平衡假设下，只要知道位涡的分布，就可以反演出整个大气的风场和质量场。这项综合性练习将指导您通过求解一个椭圆方程，从一个局地的湿位涡异常反演出平衡的风场和高度场 。这个过程不仅展示了位涡作为一种强大诊断工具的实际应用，也为理解天气系统（如气旋）的结构提供了一个动态框架。",
            "id": "4066831",
            "problem": "考虑一个代表具有有效湿分层的中纬度对流层的二维水平周期性区域。您将得到一个记为 $q_m'$ 的局地湿位涡异常，并被要求在静力平衡和小罗斯贝数的假设下对其进行反演，以获得平衡的水平风场和质量场。该反演必须在具有恒定科里奥利参数的 $f$ 平面上构建，并以单垂直模态表示法执行，该表示法通过一个有效的湿变形半径来捕捉湿静力稳定度。\n\n从适用于数值天气预报（NWP）和气候模拟的第一性原理出发：静力原始方程、小罗斯贝数地转平衡、质量守恒、Ertel 湿位涡的定义，以及由湿静力稳定度所支持的单模态垂直简化。以此为基础，推导出将给定的 $q_m'$ 映射到一个与静力约束和地转约束一致的平衡流函数场 $\\psi$ 所需的椭圆反演，并用它来计算地转风和静力质量（高度）场。\n\n使用的定义和假设：\n- 静力平衡：$\\partial p/\\partial z = -\\rho g$，其中 $p$ 是气压，$\\rho$ 是密度，$g$ 是重力加速度。\n- 小罗斯贝数地转平衡：$f_0 \\boldsymbol{k} \\times \\boldsymbol{v}_g = -\\frac{1}{\\rho_0} \\nabla_h p$，其中 $f_0$ 是恒定科里奥利参数，$\\boldsymbol{v}_g$ 是地转风，$\\rho_0$ 是恒定参考密度，$\\nabla_h$ 是水平梯度算子。\n- 湿位涡定义 (Ertel 形式)：$q_m = \\frac{\\boldsymbol{\\omega}_a \\cdot \\nabla \\theta_e}{\\rho}$，其中 $\\boldsymbol{\\omega}_a$ 是绝对涡度，$\\theta_e$ 是相当位温 (EPT)，$\\rho$ 是密度。\n- 单垂直模态简化，湿静力稳定度由有效湿变形半径 $L_{dm}$ 概括。\n- 适用于小罗斯贝数的准地转尺度分析和线性化，通过一个由静力约束、地转约束和湿变形半径决定的椭圆算子，将湿位涡异常 $q_m'$ 映射到流函数场 $\\psi$。\n\n区域、常数和离散化：\n- 水平周期性方形区域，边长 $L_x = 2.0 \\times 10^6$ 米 和 $L_y = 2.0 \\times 10^6$ 米。\n- 网格分辨率 $N_x = 256$，$N_y = 256$，均匀间隔。\n- 科里奥利参数 $f_0 = 1.0 \\times 10^{-4}$ s$^{-1}$ (恒定)。\n- 重力加速度 $g = 9.81$ m s$^{-2}$ (恒定)。\n\n一个局地湿位涡异常被规定为高斯函数：\n$q_m'(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{2 \\sigma^2}\\right)$，\n其中 $A$ 是振幅，单位为 s$^{-1}$；$(x_0,y_0)$ 是中心位置，单位为米；$\\sigma$ 是水平尺度，单位为米。您必须假设水平周期性边界条件。\n\n您的任务：\n1. 使用静力原始方程、小罗斯贝数地转平衡、湿位涡定义和单垂直模态简化，为以 $L_{dm}$ 为特征的湿环境推导出将 $q_m'$ 映射到流函数 $\\psi$ 的平衡反演算子。\n2. 使用基于快速傅里叶变换 (FFT) 的谱方法，实现一个适用于周期性区域的反演算法，以求解得到的关于 $\\psi$ 的椭圆问题。\n3. 从 $\\psi$ 计算地转风分量 $(u_g, v_g)$，并在静力平衡下从 $\\psi$ 计算静力质量（高度）异常 $\\eta$。\n4. 对于下面的每个测试用例，计算最大水平风速 $U_{\\max} = \\max \\sqrt{u_g^2 + v_g^2}$（单位：米/秒）和最大绝对高度异常 $\\eta_{\\max} = \\max |\\eta|$（单位：米）。以 m/s 表示 $U_{\\max}$，以 m 表示 $\\eta_{\\max}$。将每个测试用例的结果报告为一对 $(U_{\\max}, \\eta_{\\max})$。\n\n测试套件（四个案例，涵盖一般情况、窄异常、弱稳定度和近边界局地化）：\n- 案例 1 (一般情况，湿中纬度)：$L_{dm} = 8.0 \\times 10^5$ m, $A = 2.0 \\times 10^{-6}$ s$^{-1}$, $\\sigma = 1.5 \\times 10^5$ m, $(x_0,y_0) = (L_x/2, L_y/2)$。\n- 案例 2 (窄异常，更强振幅)：$L_{dm} = 6.0 \\times 10^5$ m, $A = 5.0 \\times 10^{-6}$ s$^{-1}$, $\\sigma = 5.0 \\times 10^4$ m, $(x_0,y_0) = (0.6 L_x, 0.7 L_y)$。\n- 案例 3 (较弱的静力稳定度，较大的湿变形半径)：$L_{dm} = 1.5 \\times 10^6$ m, $A = 2.0 \\times 10^{-6}$ s$^{-1}$, $\\sigma = 2.0 \\times 10^5$ m, $(x_0,y_0) = (0.5 L_x, 0.2 L_y)$。\n- 案例 4 (近边界局地化，以测试周期性回绕)：$L_{dm} = 5.0 \\times 10^5$ m, $A = 3.0 \\times 10^{-6}$ s$^{-1}$, $\\sigma = 1.2 \\times 10^5$ m, $(x_0,y_0) = (0.95 L_x, 0.95 L_y)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含按顺序排列的八个计算出的浮点数 $[U_{\\max}^{(1)}, \\eta_{\\max}^{(1)}, U_{\\max}^{(2)}, \\eta_{\\max}^{(2)}, U_{\\max}^{(3)}, \\eta_{\\max}^{(3)}, U_{\\max}^{(4)}, \\eta_{\\max}^{(4)}]$，其中上标表示测试用例编号。将每个浮点数输出为十进制数，单位由上述定义隐含。不应打印任何额外文本。本问题不涉及角度。不使用百分比。程序必须是自包含的，并且仅依赖于给定的参数。",
            "solution": "本题的求解过程分为三个主要部分：首先，推导将湿位涡异常 $q_m'$ 映射到流函数 $\\psi$ 的反演算子；其次，利用谱方法求解得到的椭圆方程；最后，根据流函数计算风场和高度场。\n\n**1. 湿位涡反演算子的推导**\n\n目标是在指定的近似条件下，推导出湿位涡异常 $q_m'$ 与流函数 $\\psi$ 之间的关系。\n\n我们从 Ertel 湿位涡的准地转（QG）形式开始，该形式是围绕一个静止状态进行线性化的，这个静止状态具有相当位温的平均垂直廓线 $\\bar{\\theta}_e(z)$。QG 位涡异常 $q_m'$ 由下式给出：\n$$\nq_m' = \\nabla_h^2 \\psi + \\frac{\\partial}{\\partial z}\\left(\\frac{f_0^2}{N_m^2(z)} \\frac{\\partial \\psi}{\\partial z}\\right)\n$$\n其中 $\\psi(x,y,z)$ 是三维地转流函数，$\\nabla_h^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是水平拉普拉斯算子，$f_0$ 是恒定科里奥利参数，$N_m^2(z) = \\frac{g}{\\theta_{e0}} \\frac{d\\bar{\\theta}_e}{dz}$ 是湿 Brunt-Väisälä 频率的平方，它参数化了背景态的静力稳定度。\n\n问题指定了简化为单个垂直模态。这通过对流函数假设变量分离来实现：\n$$\n\\psi(x,y,z) = \\psi(x,y) F(z)\n$$\n这里，$\\psi(x,y)$ 代表了我们旨在求解的流函数的水平结构，而 $F(z)$ 是对应于单个主导垂直模态的垂直结构函数。垂直结构函数 $F(z)$ 是 PV 方程中垂直算子的一个特征函数：\n$$\n\\frac{d}{dz}\\left(\\frac{f_0^2}{N_m^2(z)} \\frac{dF}{dz}\\right) = -\\frac{1}{L_{dm}^2} F(z)\n$$\n其中 $L_{dm}$ 是该模态的有效湿罗斯贝变形半径，是问题中给定的一个参数。特征值 $-1/L_{dm}^2$ 的选择与最终得到的亥姆霍兹方程的标准形式一致。\n\n将分离变量的形式代回 PV 方程，并假设异常 $q_m'$ 投影到这同一个垂直模态上，我们得到了一个关于水平结构 $\\psi(x,y)$ 的二维方程：\n$$\n\\nabla_h^2 \\psi(x,y) - \\frac{1}{L_{dm}^2} \\psi(x,y) = q_m'(x,y)\n$$\n这是一个线性的二阶椭圆偏微分方程，属于亥姆霍兹类型。该方程代表了将给定的湿 PV 异常 $q_m'$ 映射到相应平衡流函数 $\\psi$ 的平衡反演算子。\n\n**2. 周期性区域上的谱方法解**\n\n该区域是水平周期性的，这使得基于傅里叶级数的谱方法非常高效和准确。我们用离散傅里叶变换来表示场 $\\psi(x,y)$ 和 $q_m'(x,y)$：\n$$\n\\psi(x,y) = \\sum_{k_x, k_y} \\hat{\\psi}(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\n$$\nq_m'(x,y) = \\sum_{k_x, k_y} \\hat{q}_m'(k_x, k_y) e^{i(k_x x + k_y y)}\n$$\n其中 $\\hat{\\psi}$ 和 $\\hat{q}_m'$ 是复傅里叶系数，$k_x$ 和 $k_y$ 分别是纬向和经向波数。波数由 $k_x = 2\\pi m/L_x$ 和 $k_y = 2\\pi n/L_y$ 给出，其中整数 $m \\in [-N_x/2, N_x/2-1]$ 和 $n \\in [-N_y/2, N_y/2-1]$。\n\n在傅里叶空间中，微分算子变为代数乘法。拉普拉斯算子 $\\nabla_h^2$ 变换为：\n$$\n\\mathcal{F}(\\nabla_h^2 \\psi) = ((ik_x)^2 + (ik_y)^2)\\hat{\\psi} = -(k_x^2 + k_y^2)\\hat{\\psi} = -K^2\\hat{\\psi}\n$$\n其中 $K^2 = k_x^2 + k_y^2$。对整个亥姆霍兹方程应用傅里叶变换，得到：\n$$\n-(k_x^2 + k_y^2)\\hat{\\psi}(k_x, k_y) - \\frac{1}{L_{dm}^2} \\hat{\\psi}(k_x, k_y) = \\hat{q}_m'(k_x, k_y)\n$$\n这是一个关于每个波数对 $(k_x, k_y)$ 的 $\\hat{\\psi}$ 的代数方程。求解 $\\hat{\\psi}$：\n$$\n\\hat{\\psi}(k_x, k_y) = \\frac{\\hat{q}_m'(k_x, k_y)}{-(k_x^2 + k_y^2) - \\frac{1}{L_{dm}^2}}\n$$\n反演算法如下：\n1. 在数值网格上计算 $q_m'(x,y)$ 场。\n2. 对 $q_m'(x,y)$ 应用二维快速傅里叶变换 (FFT)，获得其谱系数 $\\hat{q}_m'(k_x, k_y)$。\n3. 对每个波数对，将 $\\hat{q}_m'$ 除以亥姆霍兹算子的谱表示 $-(K^2 + L_{dm}^{-2})$，求得 $\\hat{\\psi}(k_x, k_y)$。分母永远不为零，因此问题对所有波数都是适定的。\n4. 对 $\\hat{\\psi}(k_x, k_y)$ 应用二维逆 FFT，恢复物理空间中的流函数场 $\\psi(x,y)$。\n\n**3. 风场和高度场的计算**\n\n一旦求得流函数 $\\psi$，就可以计算地转风分量 $(u_g, v_g)$ 和静力高度异常 $\\eta$。\n\n地转风通过以下关系与流函数相关联：\n$$\nu_g = -\\frac{\\partial \\psi}{\\partial y} \\quad , \\quad v_g = \\frac{\\partial \\psi}{\\partial x}\n$$\n这些导数在谱空间中计算最为精确：\n$$\n\\hat{u}_g(k_x, k_y) = -i k_y \\hat{\\psi}(k_x, k_y)\n$$\n$$\n\\hat{v}_g(k_x, k_y) = +i k_x \\hat{\\psi}(k_x, k_y)\n$$\n对 $\\hat{u}_g$ 和 $\\hat{v}_g$ 进行逆 FFT，得到物理空间中的风场 $u_g(x,y)$ 和 $v_g(x,y)$。最大水平风速则为 $U_{\\max} = \\max\\sqrt{u_g^2 + v_g^2}$，在整个区域上取最大值。\n\n在 QG 理论中，气压异常 $p'$ 与流函数的关系为 $p' = \\rho_0 f_0 \\psi$。高度异常 $\\eta$ 由 $\\eta = p'/(\\rho_0 g)$ 给出。因此：\n$$\n\\eta(x,y) = \\frac{f_0}{g} \\psi(x,y)\n$$\n最大绝对高度异常为 $\\eta_{\\max} = \\max|\\eta|$，在整个区域上取最大值。\n\n接下来的实现将遵循这些推导出的步骤。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the moist potential vorticity inversion problem for a series of test cases.\n    \"\"\"\n\n    # --- Global Parameters ---\n    Lx = 2.0e6  # Domain length in x-direction [m]\n    Ly = 2.0e6  # Domain length in y-direction [m]\n    Nx = 256    # Number of grid points in x\n    Ny = 256    # Number of grid points in y\n    f0 = 1.0e-4 # Coriolis parameter [s^-1]\n    g = 9.81    # Gravitational acceleration [m s^-2]\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case 1: General, moist midlatitude\n        {'Ldm': 8.0e5, 'A': 2.0e-6, 'sigma': 1.5e5, 'x0_frac': 0.5, 'y0_frac': 0.5},\n        # Case 2: Narrow anomaly, stronger amplitude\n        {'Ldm': 6.0e5, 'A': 5.0e-6, 'sigma': 5.0e4, 'x0_frac': 0.6, 'y0_frac': 0.7},\n        # Case 3: Weaker static stability\n        {'Ldm': 1.5e6, 'A': 2.0e-6, 'sigma': 2.0e5, 'x0_frac': 0.5, 'y0_frac': 0.2},\n        # Case 4: Near-boundary localization\n        {'Ldm': 5.0e5, 'A': 3.0e-6, 'sigma': 1.2e5, 'x0_frac': 0.95, 'y0_frac': 0.95}\n    ]\n\n    results = []\n    \n    # --- Grid and Wavenumber Setup ---\n    # Physical grid\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y, indexing='xy')\n\n    # Wavenumber grid\n    kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kxx, kyy = np.meshgrid(kx_vec, ky_vec, indexing='xy')\n    K2 = kxx**2 + kyy**2 # Squared total wavenumber\n\n    for case in test_cases:\n        # --- Unpack Case Parameters ---\n        Ldm = case['Ldm']\n        A = case['A']\n        sigma = case['sigma']\n        x0 = case['x0_frac'] * Lx\n        y0 = case['y0_frac'] * Ly\n\n        # --- 1. Define Moist PV Anomaly Field ---\n        # Gaussian anomaly q_m'\n        qm_prime = A * np.exp(-((xx - x0)**2 + (yy - y0)**2) / (2 * sigma**2))\n\n        # --- 2. Solve for Streamfunction (psi) using Spectral Method ---\n        # Fourier transform the PV anomaly\n        qm_hat = np.fft.fft2(qm_prime)\n\n        # Define the spectral inversion operator (denominator)\n        # Operator: -(K^2 + 1/Ldm^2)\n        helmholtz_operator_spectral = -K2 - (1 / Ldm**2)\n        \n        # Solve for psi in spectral space\n        # Note: No division by zero since Ldm  0\n        psi_hat = qm_hat / helmholtz_operator_spectral\n\n        # Inverse Fourier transform to get psi in physical space\n        # Take the real part to discard negligible imaginary components due to numerical error\n        psi = np.fft.ifft2(psi_hat).real\n\n        # --- 3. Compute Geostrophic Wind and Height Anomaly ---\n        # Compute wind components in spectral space for accuracy\n        # ug_hat = -i*ky*psi_hat\n        # vg_hat = i*kx*psi_hat\n        ug_hat = -1j * kyy * psi_hat\n        vg_hat = 1j * kxx * psi_hat\n\n        # Inverse transform to get wind fields in physical space\n        ug = np.fft.ifft2(ug_hat).real\n        vg = np.fft.ifft2(vg_hat).real\n\n        # Compute total horizontal wind speed\n        U = np.sqrt(ug**2 + vg**2)\n        \n        # Compute height anomaly eta = (f0/g) * psi\n        eta = (f0 / g) * psi\n\n        # --- 4. Calculate and Store Maximum Values ---\n        U_max = np.max(U)\n        eta_max = np.max(np.abs(eta))\n\n        results.append(U_max)\n        results.append(eta_max)\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}