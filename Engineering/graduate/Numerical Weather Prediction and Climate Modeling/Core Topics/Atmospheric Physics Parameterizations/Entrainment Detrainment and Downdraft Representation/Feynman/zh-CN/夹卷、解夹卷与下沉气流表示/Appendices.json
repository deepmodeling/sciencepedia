{
    "hands_on_practices": [
        {
            "introduction": "对流的触发过程是大气科学中的一个核心问题，它涉及到抑制对流的能量（CIN）与抬升机制之间的复杂博弈。卷入过程通过将较冷、较干燥的环境空气混合到上升气流中，从而削弱其浮力，这使得气块更难达到其自由对流高度（LFC）。本练习  旨在让学生定量地探讨这种平衡关系，通过计算一个“临界卷入率”，学生将能理解卷入、对流抑制以及诸如冷池阵风锋等边界层强迫之间的相互作用，如何共同决定了深对流能否被成功触发。",
            "id": "4038872",
            "problem": "一个垂直混合的边界层支撑着浅积云，其云底高度为 $z_{cb}$。气块浮力定义为 $B(z) = g \\,\\frac{T_{v,p}(z) - T_{v,e}(z)}{T_{v,e}(z)}$，其中 $T_{v,p}$ 是气块虚温，$T_{v,e}$ 是环境虚温。对流抑制 (CIN) 是指将一个气块抬升通过负浮力层所需的单位质量的功，定义为\n$$\\mathrm{CIN} = \\int_{z_1}^{z_2} \\left| B(z) \\right| \\,\\mathrm{d}z,$$\n积分区间为 $B(z)  0$ 的范围。考虑云底和自由对流高度 (LFC) 之间的负浮力层，其中未稀释气块浮力由线性函数表示\n$$B_0(z) = -\\beta + \\alpha \\left( z - z_{cb} \\right),$$\n其中 $\\beta > 0$ 和 $\\alpha > 0$ 是常数，且 $B_0(z_{cb}) = -\\beta$，$B_0(z_{LFC}) = 0$。\n\n在云底，瞬时夹卷将比例为 $\\eta$ 的环境空气混入气块，因此稀释后气块的属性是气块和环境属性的凸组合。假设这种混合产生了稀释后的浮力廓线\n$$B(z;\\eta) = (1-\\eta)\\,B_0(z),$$\n对于 $z \\ge z_{cb}$，并且 $B$ 的零点（自由对流高度）不因缩放而改变。\n\n云下的下沉气流产生的冷池在其阵风锋处产生机械抬升。将冷池模拟为深度为 $H$ 的 Boussinesq 密度流，其相对于虚温为 $T_{v,e}$ 的环境的虚温亏损为 $\\Delta T_v$。折减重力为 $g' = g \\,\\frac{\\Delta T_v}{T_{v,e}}$。根据浅水重力流理论，阵风锋速度满足 $U = \\sqrt{2 g' H}$，可以转化为气块抬升的单位质量的机械能为\n$$E_{\\mathrm{mech}} = \\frac{1}{2} U^2 = g' H = g H \\,\\frac{\\Delta T_v}{T_{v,e}}.$$\n\n给定以下科学上合理的参数：\n- $z_{cb}$ 是任意的，在计算中会抵消掉，\n- $\\beta = 0.14$ (单位 $\\mathrm{m}\\,\\mathrm{s}^{-2}$),\n- $\\alpha = 1.0 \\times 10^{-4}$ (单位 $\\mathrm{s}^{-2}$),\n- $H = 1000$ (单位 $\\mathrm{m}$),\n- $\\Delta T_v = 2$ (单位 $\\mathrm{K}$),\n- $T_{v,e} = 300$ (单位 $\\mathrm{K}$),\n- $g = 9.81$ (单位 $\\mathrm{m}\\,\\mathrm{s}^{-2}$),\n\n计算临界夹卷分数 $\\eta_{\\mathrm{crit}}$，使得 $E_{\\mathrm{mech}} = \\mathrm{CIN}(\\eta_{\\mathrm{crit}})$，其中 $\\mathrm{CIN}(\\eta)$ 是稀释后气块在 $z_{cb}$ 和 $z_{LFC}$ 之间的 CIN。将最终答案四舍五入到四位有效数字。以无单位的小数形式表示最终答案。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**第 1 步：提取已知条件**\n- 气块浮力定义：$B(z) = g \\,\\frac{T_{v,p}(z) - T_{v,e}(z)}{T_{v,e}(z)}$\n- 对流抑制 (CIN) 定义：$\\mathrm{CIN} = \\int_{z_1}^{z_2} \\left| B(z) \\right| \\,\\mathrm{d}z$，积分区间为 $B(z)  0$ 的范围。\n- 未稀释气块浮力廓线：$B_0(z) = -\\beta + \\alpha \\left( z - z_{cb} \\right)$，其中常数 $\\beta > 0$ 且 $\\alpha > 0$。\n- 关于 $B_0(z)$ 的条件：$B_0(z_{cb}) = -\\beta$ 且 $B_0(z_{LFC}) = 0$。\n- 稀释后气块浮力廓线：$B(z;\\eta) = (1-\\eta)\\,B_0(z)$，对于 $z \\ge z_{cb}$。\n- 假设：自由对流高度 ($z_{LFC}$) 不因稀释而改变。\n- 来自冷池的机械抬升能：$E_{\\mathrm{mech}} = g H \\,\\frac{\\Delta T_v}{T_{v,e}}$。\n- 目标是找到满足条件 $E_{\\mathrm{mech}} = \\mathrm{CIN}(\\eta_{\\mathrm{crit}})$ 的临界夹卷分数 $\\eta_{\\mathrm{crit}}$。\n- CIN 的计算范围是 $z_{cb}$ 和 $z_{LFC}$ 之间的层。\n- 数值参数：\n  - $\\beta = 0.14 \\, \\mathrm{m}\\,\\mathrm{s}^{-2}$\n  - $\\alpha = 1.0 \\times 10^{-4} \\, \\mathrm{s}^{-2}$\n  - $H = 1000 \\, \\mathrm{m}$\n  - $\\Delta T_v = 2 \\, \\mathrm{K}$\n  - $T_{v,e} = 300 \\, \\mathrm{K}$\n  - $g = 9.81 \\, \\mathrm{m}\\,\\mathrm{s}^{-2}$\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了大气科学中关于浮力、对流抑制、夹卷和密度流的标准模型和定义。所提供的参数在物理上是合理的且一致的。该问题是适定的，因为它建立了一个关于单个未知数 $\\eta_{\\mathrm{crit}}$ 的可解方程。语言客观，设置自洽，提供了所有必要的信息。推理不存在循环论证，且问题并非微不足道。未发现任何缺陷。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n**解答**\n该问题要求找到临界夹卷分数 $\\eta_{\\mathrm{crit}}$，使得冷池阵风锋提供的机械抬升能等于夹卷气块的对流抑制 (CIN)。控制方程为：\n$$E_{\\mathrm{mech}} = \\mathrm{CIN}(\\eta_{\\mathrm{crit}})$$\n\n首先，我们使用给定的公式和参数计算单位质量的机械能 $E_{\\mathrm{mech}}$。\n$$E_{\\mathrm{mech}} = g H \\frac{\\Delta T_v}{T_{v,e}}$$\n代入给定值：\n- $g = 9.81 \\, \\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $H = 1000 \\, \\mathrm{m}$\n- $\\Delta T_v = 2 \\, \\mathrm{K}$\n- $T_{v,e} = 300 \\, \\mathrm{K}$\n\n$$E_{\\mathrm{mech}} = (9.81 \\, \\mathrm{m}\\,\\mathrm{s}^{-2}) (1000 \\, \\mathrm{m}) \\left( \\frac{2 \\, \\mathrm{K}}{300 \\, \\mathrm{K}} \\right) = 9810 \\times \\frac{2}{300} \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2} = \\frac{19620}{300} \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2} = 65.4 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2}$$\n\n接下来，我们为稀释后气块的 CIN 构建表达式 $\\mathrm{CIN}(\\eta)$。CIN 定义为浮力绝对值在负浮力层上的积分，该层指定为从云底 $z_{cb}$ 到自由对流高度 $z_{LFC}$ 的层。\n$$\\mathrm{CIN}(\\eta) = \\int_{z_{cb}}^{z_{LFC}} |B(z;\\eta)| \\, \\mathrm{d}z$$\n稀释后的浮力由 $B(z;\\eta) = (1-\\eta)B_0(z)$ 给出。夹卷分数 $\\eta$ 满足 $0 \\le \\eta \\le 1$，所以 $(1-\\eta) \\ge 0$。未稀释的浮力 $B_0(z)$ 在区间 $(z_{cb}, z_{LFC})$ 内为负。因此，$B(z;\\eta)$ 在此区间内也为负。\n这使得我们可以写出：\n$$|B(z;\\eta)| = |(1-\\eta)B_0(z)| = (1-\\eta)|B_0(z)|$$\n因此，$\\mathrm{CIN}(\\eta)$ 可以用未稀释气块的 CIN，即 $\\mathrm{CIN}_0$，来表示：\n$$\\mathrm{CIN}(\\eta) = (1-\\eta) \\int_{z_{cb}}^{z_{LFC}} |B_0(z)| \\, \\mathrm{d}z = (1-\\eta)\\mathrm{CIN}_0$$\n其中 $\\mathrm{CIN}_0 = \\int_{z_{cb}}^{z_{LFC}} |B_0(z)| \\, \\mathrm{d}z$。\n\n现在，我们必须计算 $\\mathrm{CIN}_0$。未稀释的浮力廓线为 $B_0(z) = -\\beta + \\alpha(z-z_{cb})$。积分上限 $z_{LFC}$ 是 $B_0(z_{LFC}) = 0$ 的地方。\n$$-\\beta + \\alpha(z_{LFC} - z_{cb}) = 0 \\implies z_{LFC} - z_{cb} = \\frac{\\beta}{\\alpha}$$\n所以，$z_{LFC} = z_{cb} + \\frac{\\beta}{\\alpha}$。\n对于 $z \\in [z_{cb}, z_{LFC}]$，$B_0(z) \\le 0$，所以 $|B_0(z)| = -B_0(z) = -(-\\beta + \\alpha(z-z_{cb})) = \\beta - \\alpha(z-z_{cb})$。\n$\\mathrm{CIN}_0$ 的积分变为：\n$$\\mathrm{CIN}_0 = \\int_{z_{cb}}^{z_{cb} + \\beta/\\alpha} \\left( \\beta - \\alpha(z-z_{cb}) \\right) \\, \\mathrm{d}z$$\n为简化计算，令 $z' = z-z_{cb}$。那么 $\\mathrm{d}z' = \\mathrm{d}z$。积分限从 $z=z_{cb}$ 变为 $z'=0$，从 $z=z_{cb}+\\beta/\\alpha$ 变为 $z'=\\beta/\\alpha$。\n$$\\mathrm{CIN}_0 = \\int_{0}^{\\beta/\\alpha} (\\beta - \\alpha z') \\, \\mathrm{d}z' = \\left[ \\beta z' - \\frac{1}{2}\\alpha(z')^2 \\right]_{0}^{\\beta/\\alpha}$$\n$$\\mathrm{CIN}_0 = \\left( \\beta \\left(\\frac{\\beta}{\\alpha}\\right) - \\frac{1}{2}\\alpha\\left(\\frac{\\beta}{\\alpha}\\right)^2 \\right) - (0) = \\frac{\\beta^2}{\\alpha} - \\frac{1}{2}\\frac{\\beta^2}{\\alpha} = \\frac{\\beta^2}{2\\alpha}$$\n现在，我们代入 $\\beta$ 和 $\\alpha$ 的数值：\n- $\\beta = 0.14 \\, \\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\alpha = 1.0 \\times 10^{-4} \\, \\mathrm{s}^{-2}$\n\n$$\\mathrm{CIN}_0 = \\frac{(0.14 \\, \\mathrm{m}\\,\\mathrm{s}^{-2})^2}{2(1.0 \\times 10^{-4} \\, \\mathrm{s}^{-2})} = \\frac{0.0196 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-4}}{2.0 \\times 10^{-4} \\, \\mathrm{s}^{-2}} = 98 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2}$$\n\n我们现在回到主方程 $E_{\\mathrm{mech}} = \\mathrm{CIN}(\\eta_{\\mathrm{crit}})$，我们可以将其写为 $E_{\\mathrm{mech}} = (1-\\eta_{\\mathrm{crit}})\\mathrm{CIN}_0$。\n我们求解 $\\eta_{\\mathrm{crit}}$：\n$$1 - \\eta_{\\mathrm{crit}} = \\frac{E_{\\mathrm{mech}}}{\\mathrm{CIN}_0}$$\n$$\\eta_{\\mathrm{crit}} = 1 - \\frac{E_{\\mathrm{mech}}}{\\mathrm{CIN}_0}$$\n代入已计算出的 $E_{\\mathrm{mech}}$ 和 $\\mathrm{CIN}_0$ 的值：\n$$\\eta_{\\mathrm{crit}} = 1 - \\frac{65.4 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2}}{98 \\, \\mathrm{m}^2\\,\\mathrm{s}^{-2}} = 1 - \\frac{65.4}{98}$$\n$$\\eta_{\\mathrm{crit}} = 1 - 0.6673469... = 0.3326530...$$\n问题要求将答案四舍五入到四位有效数字。\n第五位有效数字是 $5$，所以我们将第四位有效数字向上取整。\n$$\\eta_{\\mathrm{crit}} \\approx 0.3327$$\n这个值是无单位的小数，符合要求。",
            "answer": "$$\\boxed{0.3327}$$"
        },
        {
            "introduction": "对流参数化方案必须对次网格尺度积云的结构做出简化假设，其中一个常见的选择是“高帽”廓线。然而，这种理想化的假设如何影响我们对混合过程的表征？本练习  挑战学生思考模型设计的这一核心问题，即卷入率通常被参数化为与积云羽流的周长与面积之比成正比，而不同的羽流形状具有不同的有效比率。通过推导简单高帽廓线与更平滑、更真实的“高斯”廓线在卷入系数上的比值，学生可以更深刻地体会到，模型设计中抽象的几何选择如何对模拟的物理过程产生具体而重要的影响。",
            "id": "4038795",
            "problem": "考虑一个在数值天气预报 (NWP) 和气候模型对流参数化方案中使用的轴对称对流上升气流核，其垂直速度 $w(r)$ 仅取决于距核心中心的径向距离 $r$。假设中心线速度为常数 $w_{c} \\equiv w(0)$。考虑两种理想化的 $w(r)$ 径向廓线：半径为 $R$ 的平顶廓线，当 $0 \\le r \\le R$ 时 $w(r) = w_{c}$，当 $r > R$ 时 $w(r) = 0$；以及高斯廓线 $w(r) = w_{c} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)$，适用于 $0 \\le r  \\infty$，其中 $\\sigma$ 是一个宽度参数。\n\n在夹卷-脱卷羽流公式中，夹卷率 $ \\varepsilon $ 通常被建模为与一个特征侧向交换速度乘以单位横截面积的有效界面长度成比例。受跨等$w$面的扩散性侧向混合的启发，定义通量加权的横截面积\n$$\nA_{f} \\equiv \\frac{1}{w_{c}} \\int_{0}^{\\infty} w(r)\\,2\\pi r \\, dr,\n$$\n和梯度加权的有效周长\n$$\nP_{\\text{eff}} \\equiv \\frac{1}{w_{c}} \\int_{0}^{\\infty} \\left|\\frac{\\partial w}{\\partial r}\\right| \\, 2\\pi r \\, dr,\n$$\n这样对于边缘陡峭的平顶廓线，这些定义恢复为 $A_{f} = \\pi R^{2}$ 和 $P_{\\text{eff}} = 2\\pi R$。假设对于一个固定的侧向交换速度尺度，夹卷系数满足 $\\varepsilon \\propto P_{\\text{eff}}/A_{f}$。\n\n对于高斯廓线，计算 $A_{f}$ 和 $P_{\\text{eff}}$，对于平顶廓线，使用 $A_{f} = \\pi R^{2}$ 和 $P_{\\text{eff}} = 2\\pi R$。施加高斯情况和平顶情况之间通量加权横截面积相等的约束。在此约束下，推导精确的无量纲比率\n$$\n\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}}\n$$\n作为一个闭式解析表达式。以无近似的精确表达式给出最终比率，并注意该比率为无量纲，因此最终答案中不需要单位。",
            "solution": "目标是计算无量纲比率 $\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}}$。问题陈述夹卷率 $\\varepsilon$ 与有效周长 $P_{\\text{eff}}$ 和通量加权横截面积 $A_f$ 的比率成正比。我们可以将其写为 $\\varepsilon = k \\frac{P_{\\text{eff}}}{A_f}$，其中 $k$ 是一个比例常数，代表一个特征侧向交换速度尺度。\n\n因此，该比率可以表示为：\n$$\n\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}} = \\frac{k \\frac{P_{\\text{eff, Gaussian}}}{A_{f, \\text{Gaussian}}}}{k \\frac{P_{\\text{eff, Top-hat}}}{A_{f, \\text{Top-hat}}}} = \\frac{P_{\\text{eff, Gaussian}}}{P_{\\text{eff, Top-hat}}} \\frac{A_{f, \\text{Top-hat}}}{A_{f, \\text{Gaussian}}}\n$$\n问题施加了通量加权横截面积相等的约束条件，$A_{f, \\text{Gaussian}} = A_{f, \\text{Top-hat}}$。在此约束下，该比率简化为：\n$$\n\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}} = \\frac{P_{\\text{eff, Gaussian}}}{P_{\\text{eff, Top-hat}}}\n$$\n为了解决这个问题，我们必须首先计算 $A_{f, \\text{Gaussian}}$ 和 $P_{\\text{eff, Gaussian}}$，然后应用面积约束来关联廓线参数，最后计算有效周长的比率。\n\n首先，我们分析高斯廓线，其垂直速度由 $w(r) = w_{c} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)$ 给出。\n\n通量加权横截面积 $A_{f, \\text{Gaussian}}$ 为：\n$$\nA_{f, \\text{Gaussian}} = \\frac{1}{w_{c}} \\int_{0}^{\\infty} w(r)\\,2\\pi r \\, dr = \\frac{1}{w_{c}} \\int_{0}^{\\infty} w_{c} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) 2\\pi r \\, dr = 2\\pi \\int_{0}^{\\infty} r \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) dr\n$$\n我们使用 $u = \\frac{r^2}{2\\sigma^2}$ 进行换元，这意味着 $du = \\frac{r}{\\sigma^2}dr$，或 $r\\,dr = \\sigma^2 du$。积分上下限仍为从 $0$ 到 $\\infty$。\n$$\nA_{f, \\text{Gaussian}} = 2\\pi \\int_{0}^{\\infty} \\exp(-u) \\sigma^2 du = 2\\pi\\sigma^2 \\left[-\\exp(-u)\\right]_{0}^{\\infty} = 2\\pi\\sigma^2 (-0 - (-1)) = 2\\pi\\sigma^2\n$$\n\n接下来，我们计算梯度加权的有效周长 $P_{\\text{eff, Gaussian}}$。我们首先需要 $w(r)$ 的导数：\n$$\n\\frac{\\partial w}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ w_{c} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) \\right] = w_{c} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) \\left(-\\frac{2r}{2\\sigma^2}\\right) = -w_{c} \\frac{r}{\\sigma^2} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\n$$\n对于 $r \\ge 0$，该表达式为非正数，因此其绝对值为：\n$$\n\\left|\\frac{\\partial w}{\\partial r}\\right| = w_{c} \\frac{r}{\\sigma^2} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\n$$\n现在我们计算 $P_{\\text{eff, Gaussian}}$：\n$$\nP_{\\text{eff, Gaussian}} = \\frac{1}{w_{c}} \\int_{0}^{\\infty} \\left|\\frac{\\partial w}{\\partial r}\\right| 2\\pi r \\, dr = \\frac{1}{w_{c}} \\int_{0}^{\\infty} \\left(w_{c} \\frac{r}{\\sigma^2} \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\\right) 2\\pi r \\, dr = \\frac{2\\pi}{\\sigma^2} \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) dr\n$$\n这是一个标准的高斯积分。我们可以使用已知结果 $\\int_{0}^{\\infty} x^2 \\exp(-ax^2)dx = \\frac{\\sqrt{\\pi}}{4a^{3/2}}$ 来计算它。这里，$a = \\frac{1}{2\\sigma^2}$。\n$$\n\\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) dr = \\frac{\\sqrt{\\pi}}{4\\left(\\frac{1}{2\\sigma^2}\\right)^{3/2}} = \\frac{\\sqrt{\\pi}}{4\\left(\\frac{1}{2\\sqrt{2}\\sigma^3}\\right)} = \\frac{2\\sqrt{2}\\pi^{1/2}\\sigma^3}{4} = \\frac{\\sqrt{2\\pi}\\sigma^3}{2}\n$$\n将此结果代回到 $P_{\\text{eff, Gaussian}}$ 的表达式中：\n$$\nP_{\\text{eff, Gaussian}} = \\frac{2\\pi}{\\sigma^2} \\left(\\frac{\\sqrt{2\\pi}\\sigma^3}{2}\\right) = \\pi\\sqrt{2\\pi}\\sigma\n$$\n\n对于平顶廓线，问题给出了 $A_{f, \\text{Top-hat}} = \\pi R^2$ 和 $P_{\\text{eff, Top-hat}} = 2\\pi R$。\n\n现在，我们应用通量加权面积相等的约束条件：\n$$\nA_{f, \\text{Gaussian}} = A_{f, \\text{Top-hat}} \\implies 2\\pi\\sigma^2 = \\pi R^2 \\implies R^2 = 2\\sigma^2\n$$\n由于 $R$ 和 $\\sigma$ 是长度尺度，它们必须为正，因此我们取正根：\n$$\nR = \\sqrt{2}\\sigma\n$$\n\n最后，我们使用前面推导的简化形式计算所需比率：\n$$\n\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}} = \\frac{P_{\\text{eff, Gaussian}}}{P_{\\text{eff, Top-hat}}} = \\frac{\\pi\\sqrt{2\\pi}\\sigma}{2\\pi R} = \\frac{\\sqrt{2\\pi}\\sigma}{2R}\n$$\n我们将来自约束条件的关系式 $R = \\sqrt{2}\\sigma$ 代入此表达式：\n$$\n\\frac{\\varepsilon_{\\text{Gaussian}}}{\\varepsilon_{\\text{Top-hat}}} = \\frac{\\sqrt{2\\pi}\\sigma}{2(\\sqrt{2}\\sigma)} = \\frac{\\sqrt{2}\\sqrt{\\pi}}{2\\sqrt{2}} = \\frac{\\sqrt{\\pi}}{2}\n$$\n这就是闭式解析表达式形式的精确无量纲比率。",
            "answer": "$$\\boxed{\\frac{\\sqrt{\\pi}}{2}}$$"
        },
        {
            "introduction": "在数值天气预报（NWP）模型中，我们模拟的“物理过程”是显式物理参数化与数值算法隐式效应的结合体。低阶平流方案，如一阶迎风格式，会引入数值扩散，这种数值误差可以人为地稀释示踪剂场，从而虚假地模仿了物理上的卷入过程。这项高级练习  引导学生通过修正方程分析来量化这种虚假的卷入效应。通过推导模型网格间距的约束条件，学生将掌握一项关键技能：如何分析和控制数值伪影，以确保模型模拟的是其预期的物理过程，而不是离散化本身带来的误差。",
            "id": "4038808",
            "problem": "在一个数值天气预报（NWP）模式中，使用一维有限体积平流方法来输运被动标量 $q$，该标量代表了以均匀速度 $u$ 穿过尺寸为 $\\Delta x$、时间步长为 $\\Delta t$ 的网格单元的对流羽流属性（例如，湿静力能量异常）。在真实大气中，羽流稀释是由物理夹卷造成的，其夹卷率为 $\\varepsilon_{\\mathrm{phys}}$ (单位为 $\\mathrm{s}^{-1}$)。在一个使用一阶迎风平流格式的离散有限体积模式中，数值扩散会引入虚假的稀释。为了避免对流参数化方案中使用的羽流-环境交换表示产生偏差，这种虚假稀释必须相对于物理夹卷保持在较小水平。\n\n从被动标量的守恒律和一阶迎风有限体积格式的定义出发，使用修正方程分析来确定其领先阶截断项，并将其识别为一个具有某个系数 $D_{\\mathrm{num}}$ 的等效扩散项。然后，通过将宽度为 $w$ 的帽形羽流异常用其主导傅里叶分量来表示，并将数值扩散引起的衰减率等同于一个等效夹卷率 $\\varepsilon_{\\mathrm{num}}$，推导出一个判据，以确保虚假的数值稀释最多为物理夹卷率的一小部分 $\\alpha$；即，强制执行 $\\varepsilon_{\\mathrm{num}} \\le \\alpha \\,\\varepsilon_{\\mathrm{phys}}$，并求解最大允许网格间距 $\\Delta x_{\\max}$，用 $u$、$\\Delta t$ 和 $w$ 表示。用平流库朗数 $C \\equiv u \\,\\Delta t / \\Delta x$ (无量纲) 来表示你的结果。\n\n最后，对于代表被模式流平流的深对流羽流的以下科学上合理的参数，计算 $\\Delta x_{\\max}$ 的值：$u = 15\\,\\mathrm{m\\,s}^{-1}$，$w = 5.0 \\times 10^{3}\\,\\mathrm{m}$，$\\varepsilon_{\\mathrm{phys}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.20$，以及库朗数 $C = 0.70$。报告 $\\Delta x_{\\max}$ 的数值，单位为米，并四舍五入到三位有效数字。",
            "solution": "用户希望解决一个流体动力学数值方法中的问题，具体涉及一阶迎风格式的数值扩散及其在模拟对流羽流中物理夹卷时的影响。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n-   一维有限体积平流，输运被动标量 $q$，速度为均匀的 $u$。\n-   网格单元尺寸：$\\Delta x$。\n-   时间步长：$\\Delta t$。\n-   物理夹卷率：$\\varepsilon_{\\mathrm{phys}}$ (单位为 $\\mathrm{s}^{-1}$)。\n-   数值格式：一阶迎风平流。\n-   待识别的截断项：作为等效扩散项的领先阶项，系数为 $D_{\\mathrm{num}}$。\n-   羽流表示：宽度为 $w$ 的帽形异常。\n-   建模假设：用其主导傅里叶分量表示羽流。\n-   等效数值夹卷率：$\\varepsilon_{\\mathrm{num}}$，通过等同于数值扩散引起的衰减率来定义。\n-   约束条件：$\\varepsilon_{\\mathrm{num}} \\le \\alpha \\,\\varepsilon_{\\mathrm{phys}}$。\n-   目标1：推导最大允许网格间距 $\\Delta x_{\\max}$，用 $u$、$\\Delta t$ 和 $w$ 表示，并使用库朗数 $C \\equiv u \\,\\Delta t / \\Delta x$ 进行表达。\n-   目标2：使用以下参数计算 $\\Delta x_{\\max}$ 的值：\n    -   $u = 15\\,\\mathrm{m\\,s}^{-1}$\n    -   $w = 5.0 \\times 10^{3}\\,\\mathrm{m}$\n    -   $\\varepsilon_{\\mathrm{phys}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}^{-1}$\n    -   $\\alpha = 0.20$\n    -   $C = 0.70$\n-   报告要求：报告 $\\Delta x_{\\max}$ 的数值，单位为米，并四舍五入到三位有效数字。\n\n**1.2. 使用提取的已知条件进行验证**\n-   **科学依据**：该问题是计算流体动力学中的一个标准练习，应用修正方程分析来量化一种常见平流格式的数值误差（扩散）。这是天气和气候数值模式开发和分析中的一个基本概念。对流羽流夹卷的背景是一个现实且重要的应用。该问题不含伪科学，基于已建立的数学和物理原理。\n-   **适定性**：该问题陈述清晰，提供了一个逻辑上连贯的任务序列：推导、分析和数值计算。通过对“主导傅里叶分量”进行标准解释，可以获得唯一解。\n-   **客观性**：该问题以精确、客观的技术语言表述。\n-   **完整性和一致性**：所有必需的变量、常数和条件都已提供。没有矛盾之处。要求用 $C$ 表示结果，然后为数值计算提供一个 $C$ 值，这表明 $C$ 应被视为数值设置的一个固定参数，这在数值天气预报建模中是常见情况。\n\n**1.3. 结论与行动**\n该问题有效。将提供完整解答。\n\n### 步骤2：推导与求解\n\n该问题分三部分解决：首先，使用修正方程分析推导数值扩散系数；其次，将其与等效数值夹卷率联系起来；第三，应用给定的约束条件来找到并计算最大网格间距。\n\n**第1部分：修正方程分析与数值扩散**\n\n由均匀速度 $u > 0$ 平流的被动标量 $q$ 的守恒律是一维线性平流方程：\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = 0\n$$\n对于宽度为 $\\Delta x$ 的网格单元 $i$（从 $x_{i-1/2}$ 到 $x_{i+1/2}$），一阶迎风有限体积格式由下式给出：\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}\n$$\n其中 $q_i^n$ 是在时间步 $n$ 时单元 $i$ 中 $q$ 的单元平均值。对于一阶迎风格式且 $u>0$，单元面 $i+1/2$ 处的通量由上风向单元（即单元 $i$）的值决定。因此，$F_{i+1/2} = u q_i^n$，类似地 $F_{i-1/2} = u q_{i-1}^n$。该格式变为：\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} = -u \\frac{q_i^n - q_{i-1}^n}{\\Delta x}\n$$\n为了找到修正方程，我们假设 $q$ 是一个光滑函数，并围绕点 $(x_i, t_n)$ 对每一项进行泰勒级数展开。\n$$\nq_i^{n+1} = q(x_i, t_n + \\Delta t) = q + \\Delta t \\frac{\\partial q}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 q}{\\partial t^2} + O((\\Delta t)^3)\n$$\n$$\nq_{i-1}^n = q(x_i - \\Delta x, t_n) = q - \\Delta x \\frac{\\partial q}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + O((\\Delta x)^3)\n$$\n其中所有偏导数均在 $(x_i, t_n)$ 处求值。将这些代入数值格式：\n$$\n\\frac{1}{\\Delta t} \\left( \\Delta t \\frac{\\partial q}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\dots \\right) = -\\frac{u}{\\Delta x} \\left( q - \\left( q - \\Delta x \\frac{\\partial q}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots \\right) \\right)\n$$\n简化两边：\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\dots = -\\frac{u}{\\Delta x} \\left( \\Delta x \\frac{\\partial q}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots \\right)\n$$\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\dots = -u \\frac{\\partial q}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots\n$$\n重新排列以匹配原始偏微分方程（PDE）加截断误差项的形式：\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\text{H.O.T.}\n$$\n为了获得领先阶截断误差，我们使用原始PDE替换时间导数 $\\frac{\\partial^2 q}{\\partial t^2}$。由 $\\frac{\\partial q}{\\partial t} \\approx -u \\frac{\\partial q}{\\partial x}$，我们微分得到 $\\frac{\\partial^2 q}{\\partial t^2} \\approx u^2 \\frac{\\partial^2 q}{\\partial x^2}$。将此代入重新排列的方程：\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{\\Delta t}{2} \\left( u^2 \\frac{\\partial^2 q}{\\partial x^2} \\right) + \\text{H.O.T.}\n$$\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) \\frac{\\partial^2 q}{\\partial x^2} + \\text{H.O.T.}\n$$\n这就是修正方程。领先阶误差项是一个扩散项 $\\frac{\\partial^2 q}{\\partial x^2}$，其数值扩散系数为 $D_{\\mathrm{num}}$：\n$$\nD_{\\mathrm{num}} = \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n使用库朗数 $C = \\frac{u \\Delta t}{\\Delta x}$ 的定义，数值扩散系数为：\n$$\nD_{\\mathrm{num}} = \\frac{u \\Delta x}{2} (1 - C)\n$$\n\n**第2部分：等效数值夹卷率**\n\n修正方程表明，该数值格式求解的是平流-扩散方程 $\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = D_{\\mathrm{num}} \\frac{\\partial^2 q}{\\partial x^2}$。右侧的扩散项导致陡峭梯度的衰减，这被解释为羽流的虚假稀释。我们可以为一个代表性的傅里叶模式量化这个衰减率。\n\n宽度为 $w$ 的帽形羽流，其主导（最低频率）傅里叶分量对应于波长 $\\lambda = 2w$。相关的波数 $k$ 是：\n$$\nk = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{2w} = \\frac{\\pi}{w}\n$$\n考虑在以速度 $u$ 移动的参考系中的单个傅里叶模式 $q(x,t) = \\hat{q}(t) e^{ikx}$。该模式的振幅 $\\hat{q}(t)$ 根据扩散方程 $\\frac{\\partial q}{\\partial t} = D_{\\mathrm{num}}\\frac{\\partial^2 q}{\\partial x^2}$ 衰减。代入该模式可得：\n$$\n\\frac{d\\hat{q}}{dt} e^{ikx} = D_{\\mathrm{num}} (ik)^2 \\hat{q} e^{ikx} = -k^2 D_{\\mathrm{num}} \\hat{q} e^{ikx}\n$$\n振幅呈指数衰减，$\\frac{d\\hat{q}}{dt} = - (k^2 D_{\\mathrm{num}}) \\hat{q}$。衰减率为 $k^2 D_{\\mathrm{num}}$。问题将此等同于一个等效数值夹卷率 $\\varepsilon_{\\mathrm{num}}$。\n$$\n\\varepsilon_{\\mathrm{num}} = k^2 D_{\\mathrm{num}} = \\left(\\frac{\\pi}{w}\\right)^2 \\left( \\frac{u \\Delta x}{2} (1 - C) \\right) = \\frac{\\pi^2 u \\Delta x (1-C)}{2 w^2}\n$$\n\n**第3部分：最大网格间距的判据与数值计算**\n\n问题要求这种虚假的数值夹卷不超过物理夹卷率 $\\varepsilon_{\\mathrm{phys}}$ 的一小部分 $\\alpha$：\n$$\n\\varepsilon_{\\mathrm{num}} \\le \\alpha \\varepsilon_{\\mathrm{phys}}\n$$\n代入我们关于 $\\varepsilon_{\\mathrm{num}}$ 的表达式：\n$$\n\\frac{\\pi^2 u \\Delta x (1-C)}{2 w^2} \\le \\alpha \\varepsilon_{\\mathrm{phys}}\n$$\n为了找到最大允许网格间距 $\\Delta x_{\\max}$，我们在等式成立的极限情况下求解 $\\Delta x$：\n$$\n\\Delta x \\le \\frac{2 w^2 \\alpha \\varepsilon_{\\mathrm{phys}}}{\\pi^2 u (1-C)}\n$$\n因此，最大允许网格间距为：\n$$\n\\Delta x_{\\max} = \\frac{2 w^2 \\alpha \\varepsilon_{\\mathrm{phys}}}{\\pi^2 u (1-C)}\n$$\n该表达式是参数 $w, \\alpha, \\varepsilon_{\\mathrm{phys}}, \\pi, u, C$ 的函数。\n\n最后，我们使用提供的数值计算 $\\Delta x_{\\max}$：\n-   $u = 15\\,\\mathrm{m\\,s}^{-1}$\n-   $w = 5.0 \\times 10^{3}\\,\\mathrm{m}$\n-   $\\varepsilon_{\\mathrm{phys}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}^{-1}$\n-   $\\alpha = 0.20$\n-   $C = 0.70$\n\n将这些值代入 $\\Delta x_{\\max}$ 的表达式中：\n$$\n\\Delta x_{\\max} = \\frac{2 (5.0 \\times 10^{3}\\,\\mathrm{m})^2 (0.20) (2.0 \\times 10^{-3}\\,\\mathrm{s}^{-1})}{\\pi^2 (15\\,\\mathrm{m\\,s}^{-1}) (1 - 0.70)}\n$$\n$$\n\\Delta x_{\\max} = \\frac{2 (2.5 \\times 10^7\\,\\mathrm{m}^2) (0.20) (2.0 \\times 10^{-3}\\,\\mathrm{s}^{-1})}{\\pi^2 (15\\,\\mathrm{m\\,s}^{-1}) (0.30)}\n$$\n$$\n\\Delta x_{\\max} = \\frac{(5.0 \\times 10^7) (4.0 \\times 10^{-4})\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}}{4.5 \\pi^2\\,\\mathrm{m\\,s}^{-1}}\n$$\n$$\n\\Delta x_{\\max} = \\frac{2.0 \\times 10^4\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}}{4.5 \\pi^2\\,\\mathrm{m\\,s}^{-1}}\n$$\n$$\n\\Delta x_{\\max} = \\frac{20000}{4.5 \\pi^2}\\,\\mathrm{m} \\approx \\frac{20000}{4.5 \\times 9.8696} \\,\\mathrm{m} \\approx \\frac{20000}{44.4132} \\,\\mathrm{m}\n$$\n$$\n\\Delta x_{\\max} \\approx 450.316\\,\\mathrm{m}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\n\\Delta x_{\\max} \\approx 450\\,\\mathrm{m}\n$$",
            "answer": "$$\\boxed{450}$$"
        }
    ]
}