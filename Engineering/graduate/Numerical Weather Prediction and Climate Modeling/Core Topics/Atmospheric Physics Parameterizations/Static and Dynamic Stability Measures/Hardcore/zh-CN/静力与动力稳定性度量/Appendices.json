{
    "hands_on_practices": [
        {
            "introduction": "理论知识的掌握最终需要通过解决实际问题来巩固。本节的第一个实践将理论与真实世界的大气探测数据联系起来。我们将模拟处理无线电探空仪（一种搭载在气象气球上的仪器）数据的核心过程，该过程对于日常天气预报至关重要。通过编写程序，您将学习如何将原始的压强-温度（$T(p)$）剖面数据，转换为基于高度的位温（$\\theta(z)$）剖面，从而能够直观地判断大气层的静态稳定性，这是评估对流活动潜力的基本步骤 。",
            "id": "4093194",
            "problem": "你必须编写一个完整的、可运行的程序。对于每一个以气压层和相应温度给出的无线电探空剖面，程序需要将温度剖面 $T(p)$ 转换为位温剖面 $\\theta(z)$。此过程首先利用由静力平衡和理想气体定律推导出的测高公式，将气压 $p$ 映射到几何高度 $z$，然后计算静力稳定度度量 $S(z)$，以将每个分层划分为静力稳定、中性或不稳定。推导必须基于以下基本出发点：静力平衡、理想气体定律和干绝热热力学。假设空气为干空气，因此虚温等于实际温度。位温计算使用一个固定的参考气压 $p_0$。使用分层离散化方法，该方法应符合典型对流层条件的科学真实性。\n\n您的程序必须遵守以下计算和输出规范：\n- 使用的物理常数：干空气气体常数 $R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，定压比热 $c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，重力加速度 $g = 9.80665\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，以及 $\\kappa = R_d/c_p$。位温参考气压为 $p_0 = 100000\\,\\mathrm{Pa}$。\n- 单位：气压单位必须为 $\\mathrm{Pa}$，温度为 $\\mathrm{K}$，几何高度为 $\\mathrm{m}$，位温为 $\\mathrm{K}$，静力稳定度度量 $S(z)$ 为 $\\mathrm{K}\\,\\mathrm{m}^{-1}$。报告的 $S(z)$ 值需四舍五入到六位小数。\n- 高度计算：将最低层的高度设置为 $z_1 = 0\\,\\mathrm{m}$，然后通过逐层应用测高关系，并使用每层的平均温度来计算后续层的高度。\n- 位温计算：根据各层的 $T$ 和 $p$ 计算 $\\theta$。\n- 层 $i$（位于层级 $i$ 和 $i+1$ 之间）的静力稳定度度量定义：$S_i = \\Delta\\theta/\\Delta z$，其中 $\\Delta\\theta = \\theta_{i+1} - \\theta_i$ 且 $\\Delta z = z_{i+1} - z_i$。为考虑数值和表示限制，使用分类容差 $\\varepsilon = 0.001\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$（即 $1\\,\\mathrm{K}\\,\\mathrm{km}^{-1}$）。根据以下规则对每个分层进行分类：如果 $S_i > \\varepsilon$ 则为稳定（输出整数 $1$），如果 $|S_i| \\le \\varepsilon$ 则为中性（输出整数 $0$），如果 $S_i  -\\varepsilon$ 则为不稳定（输出整数 $-1$）。\n- 角度单位不适用于此问题。\n\n测试套件（气压 $p$ 单位为 $\\mathrm{Pa}$，温度 $T$ 单位为 $\\mathrm{K}$）：\n1. 一般对流层情况（预期为普遍稳定）：\n   - $p = [100000, 90000, 80000, 70000]\\,\\mathrm{Pa}$，\n   - $T = [290.0, 283.0, 275.0, 268.0]\\,\\mathrm{K}$。\n2. 近中性干绝热情况（构造为使 $\\theta$ 近似恒定）：\n   - $p = [100000, 95000, 90000, 85000]\\,\\mathrm{Pa}$，\n   - $T = [300.000, 295.650, 291.105, 286.380]\\,\\mathrm{K}$。\n3. 基于地面的超绝热情况（预期在最低层为不稳定）：\n   - $p = [100000, 97500, 95000, 92500, 90000]\\,\\mathrm{Pa}$，\n   - $T = [305.000, 302.200, 297.900, 293.400, 291.000]\\,\\mathrm{K}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个包含两个列表的列表：第一个列表是该用例中所有分层的 $S_i$ 值列表（浮点数，四舍五入到六位小数，单位为 $\\mathrm{K}\\,\\mathrm{m}^{-1}$），第二个列表是使用上述规则对这些分层进行的相应整数分类列表。例如，总输出结构必须是 $[\\,[\\,[S_0,S_1,\\dots],[C_0,C_1,\\dots]\\,],\\,\\dots\\,]$ 的形式，每个测试用例对应一对这样的列表，所有结果聚合到一个外部列表中并打印在单行上。",
            "solution": "该问题是有效的，因为它科学地基于大气热力学的既定原理，定义良好，具有明确和完整的定义与约束，并以客观、正式的语言表述。其中没有矛盾、歧义或事实不准确之处。因此，我们可以着手解决。\n\n### 理论基础\n\n该解决方案源于三个基本原理：\n\n1.  **静力平衡：** 在静止流体中，向上的气压梯度力与作用在流体质点上的向下引力相平衡。这种关系表示为：\n    $$ \\frac{dp}{dz} = -\\rho g $$\n    其中 $p$ 是气压，$z$ 是几何高度，$\\rho$ 是空气密度，$g$ 是重力加速度。\n\n2.  **理想气体定律：** 对于干空气，气压、密度和温度之间的关系由下式给出：\n    $$ p = \\rho R_d T $$\n    其中 $R_d$ 是干空气的比气体常数，$T$ 是开尔文温度。我们可以将密度表示为 $\\rho = p / (R_d T)$。\n\n3.  **位温：** 位温 $\\theta$ 是指一个气块在绝热地移动到参考气压 $p_0$ 时所能达到的温度。对于干绝热过程，它是一个守恒量，定义为：\n    $$ \\theta = T \\left( \\frac{p_0}{p} \\right)^{\\kappa} $$\n    其中 $\\kappa = R_d/c_p$，$c_p$ 是干空气的定压比热。\n\n### 测高公式的推导\n\n为了将气压层与几何高度联系起来，我们结合静力平衡方程和理想气体定律。将理想气体定律中 $\\rho$ 的表达式代入静力平衡方程，得到：\n$$ \\frac{dp}{dz} = -\\frac{p g}{R_d T} $$\n分离变量以求解高度增量 $dz$：\n$$ dz = -\\frac{R_d T}{g} \\frac{dp}{p} $$\n为了找到两个高度层 $z_i$ 和 $z_{i+1}$（对应气压为 $p_i$ 和 $p_{i+1}$）之间大气层的厚度，我们对该表达式进行积分。假设温度 $T$ 可以用该层的平均温度 $\\bar{T}_i = (T_i + T_{i+1})/2$ 来近似：\n$$ \\int_{z_i}^{z_{i+1}} dz = -\\frac{R_d \\bar{T}_i}{g} \\int_{p_i}^{p_{i+1}} \\frac{dp}{p} $$\n$$ z_{i+1} - z_i = -\\frac{R_d \\bar{T}_i}{g} [\\ln p]_{p_i}^{p_{i+1}} = -\\frac{R_d \\bar{T}_i}{g} (\\ln p_{i+1} - \\ln p_i) $$\n因此，层厚度 $\\Delta z_i = z_{i+1} - z_i$ 由测高公式给出：\n$$ \\Delta z_i = \\frac{R_d \\bar{T}_i}{g} \\ln\\left(\\frac{p_i}{p_{i+1}}\\right) $$\n由于大气压力随高度降低，因此 $p_i > p_{i+1}$，这保证了 $\\ln(p_i/p_{i+1}) > 0$，从而 $\\Delta z_i > 0$。\n\n### 静力稳定性分析\n\n干大气层的静力稳定性由位温的垂直梯度 $d\\theta/dz$ 决定。\n-   **稳定：** $d\\theta/dz > 0$。一个垂直位移的气块会被迫返回其原始高度。\n-   **中性：** $d\\theta/dz = 0$。一个垂直位移的气块会停留在其新高度。\n-   **不稳定：** $d\\theta/dz  0$。一个垂直位移的气块会加速离开其原始高度。\n\n该问题要求使用梯度的有限差分近似进行逐层分析。对于层级 $i$ 和 $i+1$ 之间的分层，静力稳定度度量 $S_i$ 定义为：\n$$ S_i = \\frac{\\Delta\\theta_i}{\\Delta z_i} = \\frac{\\theta_{i+1} - \\theta_i}{z_{i+1} - z_i} $$\n其中 $\\theta_i$ 和 $\\theta_{i+1}$ 是在层级 $i$ 和 $i+1$ 的位温，$\\Delta z_i$ 是先前计算出的层厚度。\n\n### 计算算法\n\n对于每个给定的大气剖面（$p_{levels}, T_{levels}$）：\n\n1.  **常数和初始化：**\n    - 定义物理常数：$g = 9.80665\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，$R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$p_0 = 100000\\,\\mathrm{Pa}$。\n    - 计算 $\\kappa = R_d/c_p$。\n    - 设置分类容差 $\\varepsilon = 0.001\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$。\n    - 设 $N$ 为剖面中的层级数。初始化一个大小为 $N$ 的数组 `z_levels`，并设 $z_{levels}[0] = 0.0$。\n    - 初始化空列表 `s_values` 和 `classifications` 以存储各分层的结果。\n\n2.  **计算位温剖面：**\n    - 创建一个大小为 $N$ 的数组 `theta_levels`。\n    - 对于从 $0$ 到 $N-1$ 的每个层级 $i$，计算 $\\theta_i = T_{levels}[i] \\left( p_0 / p_{levels}[i] \\right)^{\\kappa}$ 并将其存储在 `theta_levels` 中。\n\n3.  **遍历各层：**\n    - 对从 $0$ 到 $N-2$ 的每个分层 $i$ 进行循环。\n    - **a. 计算层厚度 $\\Delta z_i$**：\n        - 计算该层的平均温度：$\\bar{T}_i = (T_{levels}[i] + T_{levels}[i+1]) / 2$。\n        - 计算 $\\Delta z_i = (R_d \\bar{T}_i / g) \\ln(p_{levels}[i] / p_{levels}[i+1])$。\n    - **b. 更新高度剖面**：\n        - 计算下一层级的高度：$z_{levels}[i+1] = z_{levels}[i] + \\Delta z_i$。\n    - **c. 计算稳定度度量 $S_i$**：\n        - 计算位温差：$\\Delta\\theta_i = \\theta_{levels}[i+1] - \\theta_{levels}[i]$。\n        - 计算 $S_i = \\Delta\\theta_i / \\Delta z_i$。\n        - 将四舍五入后的值 `round(S_i, 6)` 附加到 `s_values` 列表中。\n    - **d. 分类分层稳定性**：\n        - 如果 $S_i > \\varepsilon$，则将 $1$（稳定）附加到 `classifications`。\n        - 如果 $S_i  -\\varepsilon$，则将 $-1$（不稳定）附加到 `classifications`。\n        - 否则（$|S_i| \\le \\varepsilon$），将 $0$（中性）附加到 `classifications`。\n\n4.  **格式化输出：**\n    - 将 `s_values` 和 `classifications` 列表聚合为当前测试用例指定的嵌套列表结构。\n    - 对所有测试用例重复此过程，并按要求将最终结果格式化为单个输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and classifies static stability for given atmospheric profiles.\n    \"\"\"\n    # Physical constants\n    R_d = 287.0  # J kg^-1 K^-1\n    c_p = 1004.0 # J kg^-1 K^-1\n    g = 9.80665 # m s^-2\n    p_0 = 100000.0 # Pa\n    kappa = R_d / c_p\n    epsilon = 0.001 # K m^-1, classification tolerance\n\n    # Test suite\n    test_cases = [\n        # Case 1: General tropospheric case\n        (\n            np.array([100000.0, 90000.0, 80000.0, 70000.0]),\n            np.array([290.0, 283.0, 275.0, 268.0])\n        ),\n        # Case 2: Near-neutral dry-adiabatic case\n        (\n            np.array([100000.0, 95000.0, 90000.0, 85000.0]),\n            np.array([300.000, 295.650, 291.105, 286.380])\n        ),\n        # Case 3: Surface-based superadiabatic case\n        (\n            np.array([100000.0, 97500.0, 95000.0, 92500.0, 90000.0]),\n            np.array([305.000, 302.200, 297.900, 293.400, 291.000])\n        )\n    ]\n\n    all_results_str = []\n\n    for p_levels, t_levels in test_cases:\n        num_levels = len(p_levels)\n        s_values = []\n        classifications = []\n\n        # Step 1: Compute potential temperature at all levels\n        theta_levels = t_levels * (p_0 / p_levels)**kappa\n\n        # Step 2: Initialize height profile\n        z_levels = np.zeros(num_levels)\n        z_levels[0] = 0.0\n\n        # Step 3: Iterate through layers to compute heights, stability, and classify\n        for i in range(num_levels - 1):\n            # Get data for the layer between level i and i+1\n            p_i, p_i_plus_1 = p_levels[i], p_levels[i+1]\n            t_i, t_i_plus_1 = t_levels[i], t_levels[i+1]\n            theta_i, theta_i_plus_1 = theta_levels[i], theta_levels[i+1]\n            \n            # Compute layer thickness using the hypsometric equation\n            t_mean = (t_i + t_i_plus_1) / 2.0\n            delta_z = (R_d * t_mean / g) * np.log(p_i / p_i_plus_1)\n            \n            # Compute height of the next level\n            z_levels[i+1] = z_levels[i] + delta_z\n\n            # Compute static stability measure S_i for the layer\n            delta_theta = theta_i_plus_1 - theta_i\n            s_i = delta_theta / delta_z\n            s_values.append(s_i)\n\n            # Classify the layer\n            if s_i > epsilon:\n                classifications.append(1)  # Stable\n            elif s_i  -epsilon:\n                classifications.append(-1) # Unstable\n            else:\n                classifications.append(0)  # Neutral\n        \n        # Format the results for the current case\n        s_str = f\"[{','.join(f'{s:.6f}' for s in s_values)}]\"\n        c_str = f\"[{','.join(map(str, classifications))}]\"\n        case_result_str = f\"[{s_str},{c_str}]\"\n        all_results_str.append(case_result_str)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(all_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "静态稳定度只考虑了浮力，但大气的运动同样受到风切变（即风速随高度的变化）的强烈影响。当稳定的层结与强烈的风切变相遇时，二者会展开一场“拔河比赛”，决定湍流能否发展。理查森数（$Ri$）正是量化这场竞赛的关键无量纲参数。通过这个练习，您将为一个典型的夜间稳定边界层场景计算梯度理查森数（$Ri$）和块理查森数（$Ri_b$），从而学会评估湍流的产生与抑制条件，并理解局部与整层平均稳定度的差异 。",
            "id": "4093164",
            "problem": "在平坦地形上，地表与层顶高度 $100\\,\\mathrm{m}$ 之间观测到一个水平均匀的夜间边界层。湿度的影响可以忽略不计，位温等于虚位温。参考位温为 $\\theta_{0}=300\\,\\mathrm{K}$，重力加速度为 $g=9.81\\,\\mathrm{m\\,s^{-2}}$。在这 $100\\,\\mathrm{m}$ 的层中，位温增加了 $\\Delta \\theta = 3\\,\\mathrm{K}$，平均风速增加了 $\\Delta U = 8\\,\\mathrm{m\\,s^{-1}}$。在 $z=50\\,\\mathrm{m}$ 处，测得的局地流向切变为 $\\partial U/\\partial z = 0.02\\,\\mathrm{s^{-1}}$，横向切变可以忽略不计，因此 $\\partial V/\\partial z \\approx 0$。\n\n从 Boussinesq 近似下的湍流动能（TKE）收支方程和通过 Brunt–Väisälä 频率平方定义的静力稳定度出发，推导梯度理查森数 $Ri$ 和整体理查森数 $Ri_{b}$ 关于给定量的表达式。然后，使用推导出的表达式计算 $z=50\\,\\mathrm{m}$ 处的 $Ri$ 以及整个 $0$–$100\\,\\mathrm{m}$ 层的 $Ri_{b}$。在你的推理中，通过将计算值与大气流中用于判断切变驱动湍流是否被抑制的常用临界阈值进行比较，评估稳定度状况。\n\n将两个无量纲数 $Ri$ 和 $Ri_{b}$ 以小数形式报告，并各保留三位有效数字。最终报告的值不应包含单位。",
            "solution": "该问题被评估为有效的，因为它科学地基于大气流体动力学原理，给出了所有必要信息，问题设置良好，并且表述客观。\n\n第一步是推导梯度理查森数 $Ri$ 的表达式。该推导从湍流动能（TKE）$\\bar{e}$ 的收支方程开始，对于 Boussinesq 近似下的水平均匀流，该方程可写为：\n$$\n\\frac{D\\bar{e}}{Dt} = P + B - \\epsilon + T\n$$\n这里，$P$ 是切变产生率，$B$ 是浮力产生/耗散率，$\\epsilon$ 是粘性耗散率，$T$ 是输送项。与稳定度相关的两项是湍流的切变产生和浮力产生/耗散。\n\n切变产生项由 $P = -\\overline{u'w'}\\frac{\\partial U}{\\partial z} - \\overline{v'w'}\\frac{\\partial V}{\\partial z}$ 给出，其中 $(U, V)$ 是平均水平风分量，$(u', v', w')$ 是湍流速度脉动。浮力产生项为 $B = \\frac{g}{\\theta_0}\\overline{w'\\theta_v'}$，其中 $g$ 是重力加速度，$\\theta_0$ 是参考位温，$\\theta_v'$ 是虚位温的脉动。由于问题陈述湿度影响可以忽略，位温 $\\theta$ 等于虚位温 $\\theta_v$。在一个稳定分层的环境中，位温随高度增加，$\\overline{w'\\theta'}$ 为负（向上移动的气块较冷，向下移动的气块较暖），因此 $B$ 为负，表示对 TKE 的耗散。\n\n使用一阶闭合（K-理论），湍流通量参数化为：\n$$\n-\\overline{u'w'} = K_m \\frac{\\partial U}{\\partial z}\n$$\n$$\n-\\overline{v'w'} = K_m \\frac{\\partial V}{\\partial z}\n$$\n$$\n-\\overline{w'\\theta'} = K_h \\frac{\\partial \\theta}{\\partial z}\n$$\n其中 $K_m$ 和 $K_h$ 分别是涡动粘性系数和热的涡动扩散系数。\n\n将这些代入 $P$ 和 $B$ 的表达式中，得到：\n$$\nP = K_m \\left[ \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\right]\n$$\n$$\nB = -\\frac{g}{\\theta_0} K_h \\frac{\\partial \\theta}{\\partial z}\n$$\n梯度理查森数 $Ri$ 定义为 TKE 的浮力耗散与切变产生之比，假设湍流普朗特数 $Pr_t = K_m/K_h$ 等于 $1$。它是浮力稳定项与切变不稳定项之比。\n$$\nRi = \\frac{-B}{P} \\bigg|_{K_m=K_h} = \\frac{\\frac{g}{\\theta_0} K_h \\frac{\\partial \\theta}{\\partial z}}{K_m \\left[ \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\right]} = \\frac{\\frac{g}{\\theta_0} \\frac{\\partial \\theta}{\\partial z}}{\\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2}\n$$\n分子中的项是 Brunt–Väisälä 频率的平方，$N^2$，它是静力稳定度的主要度量：\n$$\nN^2 = \\frac{g}{\\theta_0} \\frac{\\partial \\theta}{\\partial z}\n$$\n分母中的项是垂直风切变大小的平方，$S^2 = \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2$。因此，梯度理查森数的表达式为：\n$$\nRi = \\frac{N^2}{S^2}\n$$\n为了计算 $z=50\\,\\mathrm{m}$ 处的 $Ri$，我们使用所提供的数据。我们假设位温梯度在整个层中是恒定的，因此 $\\frac{\\partial \\theta}{\\partial z} \\approx \\frac{\\Delta \\theta}{\\Delta z}$。\n给定：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\theta_0 = 300\\,\\mathrm{K}$，$\\Delta \\theta = 3\\,\\mathrm{K}$，层高为 $\\Delta z = 100\\,\\mathrm{m}$。\n首先，我们计算 $N^2$：\n$$\nN^2 \\approx \\frac{g}{\\theta_0} \\frac{\\Delta \\theta}{\\Delta z} = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{300\\,\\mathrm{K}} \\frac{3\\,\\mathrm{K}}{100\\,\\mathrm{m}} = 0.000981\\,\\mathrm{s^{-2}}\n$$\n在 $z=50\\,\\mathrm{m}$ 处，给定的切变分量为 $\\frac{\\partial U}{\\partial z} = 0.02\\,\\mathrm{s^{-1}}$ 和 $\\frac{\\partial V}{\\partial z} \\approx 0$。切变的平方是：\n$$\nS^2 = (0.02\\,\\mathrm{s^{-1}})^2 + (0)^2 = 0.0004\\,\\mathrm{s^{-2}}\n$$\n现在，我们可以计算梯度理查森数：\n$$\nRi = \\frac{N^2}{S^2} = \\frac{0.000981\\,\\mathrm{s^{-2}}}{0.0004\\,\\mathrm{s^{-2}}} = 2.4525\n$$\n四舍五入到三位有效数字，$Ri \\approx 2.45$。\n\n接下来，我们推导整体理查森数 $Ri_b$ 的表达式。这是梯度理查森数的有限差分形式，在一个离散层上进行评估。导数被替换为在层深 $\\Delta z$ 上的有限差分：\n$$\n\\frac{\\partial \\theta}{\\partial z} \\rightarrow \\frac{\\Delta \\theta}{\\Delta z}\n$$\n$$\n\\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\rightarrow \\frac{(\\Delta U)^2 + (\\Delta V)^2}{(\\Delta z)^2}\n$$\n将这些代入 $Ri$ 的表达式中，得到整体理查森数：\n$$\nRi_b = \\frac{\\frac{g}{\\theta_0}\\frac{\\Delta \\theta}{\\Delta z}}{\\frac{(\\Delta U)^2 + (\\Delta V)^2}{(\\Delta z)^2}} = \\frac{g}{\\theta_0}\\frac{\\Delta \\theta \\Delta z}{(\\Delta U)^2 + (\\Delta V)^2}\n$$\n为了计算 $0-100\\,\\mathrm{m}$ 层的 $Ri_b$，我们使用给定的整体量：$\\Delta \\theta = 3\\,\\mathrm{K}$，$\\Delta z = 100\\,\\mathrm{m}$，以及 $\\Delta U = 8\\,\\mathrm{m\\,s^{-1}}$。由于横向切变可以忽略不计，我们假设横向风分量的变化 $\\Delta V$ 为零。\n$$\nRi_b = \\frac{(9.81\\,\\mathrm{m\\,s^{-2}})(3\\,\\mathrm{K})(100\\,\\mathrm{m})}{(300\\,\\mathrm{K})((8\\,\\mathrm{m\\,s^{-1}})^2 + 0^2)} = \\frac{2943}{300 \\times 64} = \\frac{2943}{19200} \\approx 0.15328125\n$$\n四舍五入到三位有效数字，$Ri_b \\approx 0.153$。\n\n最后，我们评估稳定度状况。临界理查森数 $Ri_c = 0.25$ 通常被用作判断湍流是否存在的阈值。\n对于 $z=50\\,\\mathrm{m}$ 处的局地条件，计算出的梯度理查森数为 $Ri \\approx 2.45$。这个值显著大于 $Ri_c = 0.25$。当 $Ri > 0.25$ 时，稳定分层足够强以克服切变，导致湍流的抑制和衰减。$Ri > 1$ 的值通常被认为是绝对动力稳定性的条件，此时线性扰动无法增长。因此，$z=50\\,\\mathrm{m}$ 处的流动非常稳定，可能是层流。\n对于整个层，计算出的整体理查森数为 $Ri_b \\approx 0.153$。这个值小于 $Ri_c = 0.25$，表明整个层的总切变足以潜在地产生和维持湍流，以抵抗总体的分层作用。\n$Ri$ 和 $Ri_b$ 之间的差异表明，风切变和/或温度梯度在整个层内不是均匀的。尽管层的平均条件有利于湍流，但层内存在一些局地非常稳定的区域，例如在 $z=50\\,\\mathrm{m}$ 处。这是夜间稳定边界层的一个典型特征，其中即使其他区域是静止的，间歇性湍流也可能在局地 $Ri$ 较低的区域发生。\n\n所要求的两个无量纲数是 $Ri$ 和 $Ri_b$。\n$z=50\\,\\mathrm{m}$ 处的 $Ri$ 是 $2.45$。\n$0-100\\,\\mathrm{m}$ 层的 $Ri_b$ 是 $0.153$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.45  0.153\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现在，我们将视角从局地湍流提升到行星尺度，探讨驱动中纬度天气系统（如气旋和反气旋）生长的核心机制——斜压不稳定。高空急流的结构本身就蕴含着不稳定的“种子”。这个高级实践将带您使用准地转位涡（QG PV）这一强大理论工具，来诊断急流中哪些区域是这些“天气种子”的温床。通过实施Charney-Stern不稳定必要条件，您将把抽象的地球物理流体力学概念，应用于对大规模环流不稳定性的具体诊断，这是气候和天气建模中的一项关键技能 。",
            "id": "4093209",
            "problem": "在准地转（QG）理论框架下，给定一个β平面上的中纬度动力学的纬向对称、连续层结基本态。基本态纬向风由函数 $U(y,z)$ 指定，静力稳定度通过Brunt–Väisälä频率 $N(z)$ 指定。您的目标是推导、实现并评估平均QG位涡的经向梯度，并利用Charney–Stern必要条件识别易于发生斜压不稳定的区域。\n\n使用的基本原理：\n- 联系地转纬向风 $U$ 和地转流函数 $\\psi$ 的地转平衡：$U = -\\partial \\psi / \\partial y$。\n- 静力平衡和通过Brunt–Väisälä频率定义的静力稳定度：$N^2 = (g/\\theta)\\,\\partial \\theta/\\partial z$，其中 $g$ 是重力，$\\theta$ 是位温。\n- β平面上连续层结流体的QG平均态位涡：$q = \\nabla^2 \\psi + \\partial/\\partial z \\left( (f_0^2/N^2)\\, \\partial \\psi/\\partial z \\right) + \\beta\\, y$，其中 $f_0$ 是一个常数科里奥利参数，$\\beta$ 是行星涡度的经向梯度。\n\n任务：\n1. 从列出的基本原理出发，不使用任何简便公式，推导以基本态场 $U(y,z)$ 和 $N(z)$ 表示的平均QG位涡的经向梯度 $q_y$ 的表达式。\n2. 在一个矩形 $(y,z)$ 网格上，使用内部二阶精度中心差分（以及边界上一致的单边差分）实现一个数值算法，以计算 $q_y(y,z)$。\n3. 根据Charney–Stern必要条件识别易于发生斜压不稳定的区域。对于本问题，如果 $q_y(y,z) \\cdot \\beta  0$，且 $N^2(z) > 0$，则声明网格点 $(y,z)$ 为“易感”点。此外，如果区域内 $q_y$ 至少存在一次符号变化，即在 $(y,z)$ 网格上 $\\min(q_y)  0$ 且 $\\max(q_y) > 0$，则声明该必要条件“已满足”。\n4. 对于下面指定的每个测试用例，计算：\n   - 一个布尔值，指示Charney–Stern必要条件是否满足。\n   - 如上文所定义的“易感”网格点的比例，表示为 $[0,1]$ 范围内的十进制小数。\n\n网格、单位和数值：\n- 使用一个均匀的经向网格 $y \\in [-1.5\\times 10^6,\\, +1.5\\times 10^6]$，包含 $601$ 个点（单位：米）。\n- 使用一个均匀的垂直网格 $z \\in [0,\\, 1.5\\times 10^4]$，包含 $301$ 个点（单位：米）。\n- 所有风速 $U$ 的单位是米/秒，$N$ 的单位是秒的倒数，$f_0$ 的单位是秒的倒数，$\\beta$ 的单位是米·秒的倒数。计算出的 $q_y$ 的单位是米·秒的倒数。\n- 最终报告的比例是无单位的，必须打印为小数点后保留六位的小数。\n\n测试套件：\n对于每个案例，基本态场定义如下：\n- $U(y,z) = U_0 \\exp\\left(- (y/L_y)^2 \\right) + S_z\\, z + U_{\\mathrm{bar}}$，其中 $U_0$ 是急流峰值速度，$L_y$ 是急流半宽尺度，$S_z$ 是一个恒定的垂直切变（单位：秒的倒数），$U_{\\mathrm{bar}}$ 是一个恒定的背景流（单位：米/秒）。\n- $N(z) = N_0 + \\Delta N \\times \\left( \\tfrac{1}{2} \\right) \\left[ 1 + \\tanh\\left( (z - z_t)/H_t \\right) \\right]$，其中 $N_0$ 是对流层低层的值，$\\Delta N$ 设定了跨越以 $z_t$ 为中心的对流层顶的增量，其过渡半厚度为 $H_t$。\n\n使用以下四个测试用例：\n- 案例1（典型的中纬度急流，具有强垂直切变和显著的对流层顶过渡）：\n  - $U_0 = 40$，$L_y = 9\\times 10^5$，$S_z = -7\\times 10^{-4}$，$U_{\\mathrm{bar}} = 0$，$N_0 = 0.010$，$\\Delta N = 0.010$，$z_t = 1.1\\times 10^4$，$H_t = 2.0\\times 10^3$，$f_0 = 1.0\\times 10^{-4}$，$\\beta = 1.6\\times 10^{-11}$。\n- 案例2（较弱的急流和较弱的垂直切变，具有强静力稳定度）：\n  - $U_0 = 20$，$L_y = 9\\times 10^5$，$S_z = -1\\times 10^{-4}$，$U_{\\mathrm{bar}} = 0$，$N_0 = 0.015$，$\\Delta N = 0.015$，$z_t = 1.0\\times 10^4$，$H_t = 3.0\\times 10^3$，$f_0 = 1.0\\times 10^{-4}$，$\\beta = 1.8\\times 10^{-11}$。\n- 案例3（较小的 $\\beta$，代表近亚热带地区，具有中等垂直切变）：\n  - $U_0 = 35$，$L_y = 8\\times 10^5$，$S_z = -6\\times 10^{-4}$，$U_{\\mathrm{bar}} = 0$，$N_0 = 0.009$，$\\Delta N = 0.009$，$z_t = 1.2\\times 10^4$，$H_t = 2.5\\times 10^3$，$f_0 = 7.0\\times 10^{-5}$，$\\beta = 4.0\\times 10^{-12}$。\n- 案例4（近乎均匀的流和恒定的静力稳定度）：\n  - $U_0 = 30$，$L_y = 5.0\\times 10^6$，$S_z = 0$，$U_{\\mathrm{bar}} = 0$，$N_0 = 0.012$，$\\Delta N = 0.000$，$z_t = 1.0\\times 10^4$，$H_t = 3.0\\times 10^3$，$f_0 = 1.0\\times 10^{-4}$，$\\beta = 1.6\\times 10^{-11}$。\n\n程序输出规范：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按测试用例的顺序平铺，每个用例首先提供Charney–Stern条件的布尔值，然后是四舍五入到六位小数的易感比例。例如，四个用例的输出应如下所示：$[{\\mathrm{bool}_1},{\\mathrm{frac}_1},{\\mathrm{bool}_2},{\\mathrm{frac}_2},{\\mathrm{bool}_3},{\\mathrm{frac}_3},{\\mathrm{bool}_4},{\\mathrm{frac}_4}]$。",
            "solution": "用户提供了一个关于准地转（QG）框架内斜压不稳定的地球物理流体动力学问题，该问题提法恰当。问题具有科学依据，无矛盾之处，并包含了获得唯一解所需的所有必要信息。我将着手进行推导和数值实现。\n\n### 第1步：问题陈述的验证\n\n**已知条件提取：**\n-   **理论：** 中纬度β平面上的准地转（QG）理论，纬向对称，连续层结基本态。\n-   **基本态纬向风：** $U(y,z) = U_0 \\exp\\left(- (y/L_y)^2 \\right) + S_z\\, z + U_{\\mathrm{bar}}$。\n-   **Brunt–Väisälä频率：** $N(z) = N_0 + \\Delta N \\times \\left( \\tfrac{1}{2} \\right) \\left[ 1 + \\tanh\\left( (z - z_t)/H_t \\right) \\right]$。\n-   **QG位涡（PV）：** $q = \\nabla^2 \\psi + \\partial/\\partial z \\left( (f_0^2/N^2)\\, \\partial \\psi/\\partial z \\right) + \\beta\\, y$。\n-   **地转平衡：** $U = -\\partial \\psi / \\partial y$。\n-   **网格描述：**\n    -   经向：$y \\in [-1.5\\times 10^6, +1.5\\times 10^6]\\,$米， $601$ 个点。\n    -   垂直：$z \\in [0, 1.5\\times 10^4]\\,$米， $301$ 个点。\n-   **数值格式：** 内部为二阶精度中心差分，边界为一致的单边差分。\n-   **稳定性条件 (Charney–Stern)：**\n    -   “易感”点：$q_y(y,z) \\cdot \\beta  0$ 且 $N^2(z) > 0$。\n    -   条件“已满足”：$\\min(q_y)  0$ 且 $\\max(q_y) > 0$。\n-   **测试用例：** 提供了四组参数 $\\{U_0, L_y, S_z, U_{\\mathrm{bar}}, N_0, \\Delta N, z_t, H_t, f_0, \\beta\\}$。\n-   **输出要求：** 对每个用例，一个表示条件是否满足的布尔值，以及易感比例（四舍五入到6位小数）。\n\n**验证结论：**\n问题是**有效的**。它在已建立的准地转动力学理论中有科学依据。方程和定义都是标准的。问题提法恰当，有足够的信息来推导所需表达式并对指定的测试用例进行数值计算。所提供的参数在物理上是合理的，尽管某些参数（如负垂直切变）代表了不常见但物理上有效的场景，可以有力地测试稳定性判据。任务清晰、客观且具有一定难度。\n\n### 第2步：平均QG位涡的经向梯度推导\n\n目标是从给定的平均QG位涡 $q$ 的定义出发，推导 $q_y = \\partial q / \\partial y$ 的表达式。\n平均QG位涡为：\n$$q(y,z) = \\nabla^2 \\psi + \\frac{\\partial}{\\partial z} \\left( \\frac{f_0^2}{N^2} \\frac{\\partial \\psi}{\\partial z} \\right) + \\beta y$$\n对于纬向对称状态（$\\partial/\\partial x = 0$），拉普拉斯算子为 $\\nabla^2 = \\partial^2/\\partial y^2$。\n$$q(y,z) = \\frac{\\partial^2 \\psi}{\\partial y^2} + \\frac{\\partial}{\\partial z} \\left( \\frac{f_0^2}{N^2} \\frac{\\partial \\psi}{\\partial z} \\right) + \\beta y$$\n我们现在计算每一项的经向导数 $\\partial/\\partial y$。\n\n1.  **第一项：** $\\frac{\\partial}{\\partial y} \\left( \\frac{\\partial^2 \\psi}{\\partial y^2} \\right) = \\frac{\\partial^3 \\psi}{\\partial y^3}$。\n    使用地转风关系，$U = -\\partial \\psi / \\partial y$，我们可以用 $U$ 来表示这一项。\n    $$\\frac{\\partial^3 \\psi}{\\partial y^3} = \\frac{\\partial^2}{\\partial y^2} \\left(\\frac{\\partial \\psi}{\\partial y}\\right) = \\frac{\\partial^2}{\\partial y^2}(-U) = -\\frac{\\partial^2 U}{\\partial y^2}$$\n\n2.  **第二项：** $\\frac{\\partial}{\\partial y} \\left[ \\frac{\\partial}{\\partial z} \\left( \\frac{f_0^2}{N^2} \\frac{\\partial \\psi}{\\partial z} \\right) \\right]$。\n    由于 $y$ 和 $z$ 是独立坐标，且流函数 $\\psi$ 假定足够平滑，我们可以交换微分的顺序。\n    $$ \\frac{\\partial}{\\partial z} \\left[ \\frac{\\partial}{\\partial y} \\left( \\frac{f_0^2}{N^2} \\frac{\\partial \\psi}{\\partial z} \\right) \\right] $$\n    科里奥利参数 $f_0$ 是常数，静力稳定度 $N$ 仅是 $z$ 的函数，$N = N(z)$。因此，项 $f_0^2/N^2$ 可以移出 $\\partial/\\partial y$ 算子。\n    $$ \\frac{\\partial}{\\partial z} \\left[ \\frac{f_0^2}{N(z)^2} \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial \\psi}{\\partial z} \\right) \\right] $$\n    再次交换对 $\\psi$ 的微分顺序：\n    $$ \\frac{\\partial}{\\partial z} \\left[ \\frac{f_0^2}{N(z)^2} \\frac{\\partial}{\\partial z} \\left( \\frac{\\partial \\psi}{\\partial y} \\right) \\right] $$\n    代入 $\\partial \\psi / \\partial y = -U$：\n    $$ \\frac{\\partial}{\\partial z} \\left[ \\frac{f_0^2}{N(z)^2} \\frac{\\partial}{\\partial z} (-U) \\right] = - \\frac{\\partial}{\\partial z} \\left( \\frac{f_0^2}{N(z)^2} \\frac{\\partial U}{\\partial z} \\right) $$\n\n3.  **第三项：** $\\frac{\\partial}{\\partial y} (\\beta y)$。\n    行星涡度梯度 $\\beta$ 是一个常数。\n    $$\\frac{\\partial}{\\partial y}(\\beta y) = \\beta$$\n\n合并这三项，我们得到平均QG位涡经向梯度的最终表达式：\n$$q_y(y,z) = \\beta - \\frac{\\partial^2 U}{\\partial y^2} - \\frac{\\partial}{\\partial z} \\left( \\frac{f_0^2}{N(z)^2} \\frac{\\partial U}{\\partial z} \\right)$$\n\n### 第3步：数值实现和稳定性分析\n\n推导出的 $q_y$ 表达式将在指定的网格上进行数值评估。\n\n**数值离散化：**\n我们定义一个矩形网格 $(y_j, z_i)$，其中 $j=0, \\dots, N_y-1$，$i=0, \\dots, N_z-1$。网格间距为 $\\Delta y$ 和 $\\Delta z$。所有偏导数都使用有限差分进行近似。为符合二阶精度的要求，我们对内部点和边界点均采用二阶有限差分格式。\n\n定义在间距为 $\\Delta x$ 的均匀网格 $x_k$ 上的函数 $g(x)$，其一阶导数 $g'(x_k)$ 可近似为：\n-   **中心差分（内部点，$1 \\le k \\le N-2$）：**\n    $$ g'(x_k) \\approx \\frac{g(x_{k+1}) - g(x_{k-1})}{2\\Delta x} $$\n-   **向前差分（第一个点，$k=0$）：**\n    $$ g'(x_0) \\approx \\frac{-3g(x_0) + 4g(x_1) - g(x_2)}{2\\Delta x} $$\n-   **向后差分（最后一个点，$k=N-1$）：**\n    $$ g'(x_{N-1}) \\approx \\frac{3g(x_{N-1}) - 4g(x_{N-2}) + g(x_{N-3})}{2\\Delta x} $$\n\n项 $\\partial^2 U / \\partial y^2$ 通过两次应用此数值微分方案来计算。首先，我们计算整个网格上的 $U_y = \\partial U / \\partial y$，然后我们计算 $U_{yy} = \\partial U_y / \\partial y$。\n\n**算法：**\n1.  分别为 $y$ 和 $z$ 构造具有 $N_y=601$ 和 $N_z=301$ 个点的均匀网格。计算步长 $\\Delta y$ 和 $\\Delta z$。\n2.  对于每个测试用例，定义物理参数。\n3.  生成一个二维网格，并在此网格上评估基本态纬向风 $U(y,z)$。\n4.  在垂直网格上评估基本态Brunt-Väisälä频率 $N(z)$。\n5.  数值计算 $q_y$ 所需的偏导数：\n    a. 使用二阶精度格式沿 $z$ 轴计算 $U_z = \\partial U / \\partial z$。\n    b. 使用二阶精度格式沿 $y$ 轴计算 $U_y = \\partial U / \\partial y$。\n    c. 通过再次将该格式应用于 $U_y$ 沿 $y$ 轴来计算 $U_{yy} = \\partial U_y / \\partial y$。\n6.  构建中间场 $F(y, z) = \\frac{f_0^2}{N(z)^2} U_z(y, z)$。\n7.  使用二阶精度格式沿 $z$ 轴数值计算 $F_z = \\partial F / \\partial z$。\n8.  组合最终的PV梯度场：$q_y = \\beta - U_{yy} - F_z$。\n\n**稳定性分析：**\n一旦二维场 $q_y(y,z)$ 被计算出来，就评估Charney-Stern不稳定性必要条件。\n1.  **条件满足：** 如果 $q_y$ 在区域内任何地方改变符号，则条件满足。鉴于所有测试用例都使用正的 $\\beta$， $q_y$ 的主导值预计为正。符号变化意味着 $q_y$ 在某些区域变为负值。我们通过检查是否 $\\min(q_y)  0$ 和 $\\max(q_y) > 0$ 来测试这一点。\n2.  **易感比例：** 如果 $q_y(y,z) \\cdot \\beta  0$，则网格点 $(y,z)$ 被视为对斜压不稳定“易感”。由于所有测试用例的 $\\beta > 0$，这简化为寻找 $q_y(y,z)  0$ 的区域。条件 $N^2(z) > 0$ 也需要满足，但所提供的 $N(z)$ 公式及给定参数确保 $N(z)$ 严格为正，因此 $N^2(z)>0$ 总是满足的。该比例是易感点的总数除以网格点总数 $N_y \\times N_z$。\n\n然后对所有四个测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the baroclinic instability problem based on QG theory.\n    \"\"\"\n\n    def gradient_2nd_order(f, dx, axis):\n        \"\"\"\n        Computes the gradient of a 2D array using second-order accurate stencils\n        for both interior and boundary points.\n        \"\"\"\n        df = np.zeros_like(f)\n        if axis == 1:  # Derivative along y-axis\n            # Central difference for interior\n            df[:, 1:-1] = (f[:, 2:] - f[:, :-2]) / (2 * dx)\n            # Second-order forward difference for the first point\n            df[:, 0] = (-3 * f[:, 0] + 4 * f[:, 1] - f[:, 2]) / (2 * dx)\n            # Second-order backward difference for the last point\n            df[:, -1] = (3 * f[:, -1] - 4 * f[:, -2] + f[:, -3]) / (2 * dx)\n        elif axis == 0:  # Derivative along z-axis\n            # Central difference for interior\n            df[1:-1, :] = (f[2:, :] - f[:-2, :]) / (2 * dx)\n            # Second-order forward difference for the first point\n            df[0, :] = (-3 * f[0, :] + 4 * f[1, :] - f[2, :]) / (2 * dx)\n            # Second-order backward difference for the last point\n            df[-1, :] = (3 * f[-1, :] - 4 * f[-2, :] + f[-3, :]) / (2 * dx)\n        return df\n\n    # Grid definition\n    ny = 601\n    nz = 301\n    y_min, y_max = -1.5e6, 1.5e6\n    z_min, z_max = 0, 1.5e4\n\n    y = np.linspace(y_min, y_max, ny)\n    z = np.linspace(z_min, z_max, nz)\n    dy = y[1] - y[0]\n    dz = z[1] - z[0]\n\n    # `indexing='ij'` ensures z corresponds to axis 0 and y to axis 1\n    Z, Y = np.meshgrid(z, y, indexing='ij')\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {'U0': 40.0, 'Ly': 9e5, 'Sz': -7e-4, 'Ubar': 0.0, 'N0': 0.010,\n         'dN': 0.010, 'zt': 1.1e4, 'Ht': 2.0e3, 'f0': 1.0e-4, 'beta': 1.6e-11},\n        # Case 2\n        {'U0': 20.0, 'Ly': 9e5, 'Sz': -1e-4, 'Ubar': 0.0, 'N0': 0.015,\n         'dN': 0.015, 'zt': 1.0e4, 'Ht': 3.0e3, 'f0': 1.0e-4, 'beta': 1.8e-11},\n        # Case 3\n        {'U0': 35.0, 'Ly': 8e5, 'Sz': -6e-4, 'Ubar': 0.0, 'N0': 0.009,\n         'dN': 0.009, 'zt': 1.2e4, 'Ht': 2.5e3, 'f0': 7.0e-5, 'beta': 4.0e-12},\n        # Case 4\n        {'U0': 30.0, 'Ly': 5.0e6, 'Sz': 0.0, 'Ubar': 0.0, 'N0': 0.012,\n         'dN': 0.000, 'zt': 1.0e4, 'Ht': 3.0e3, 'f0': 1.0e-4, 'beta': 1.6e-11},\n    ]\n\n    results = []\n    for params in test_cases:\n        # Unpack parameters\n        U0 = params['U0']\n        Ly = params['Ly']\n        Sz = params['Sz']\n        Ubar = params['Ubar']\n        N0 = params['N0']\n        dN = params['dN']\n        zt = params['zt']\n        Ht = params['Ht']\n        f0 = params['f0']\n        beta = params['beta']\n\n        # Calculate basic-state fields U(y,z) and N(z)\n        U = U0 * np.exp(-(Y / Ly)**2) + Sz * Z + Ubar\n        N = N0 + dN * 0.5 * (1 + np.tanh((z - zt) / Ht))\n        N2 = N**2\n\n        # Calculate derivatives for q_y expression\n        # q_y = beta - U_yy - d/dz( (f0^2/N^2) * U_z )\n        \n        # U_z = dU/dz\n        Uz = gradient_2nd_order(U, dz, axis=0)\n        \n        # U_yy = d^2U/dy^2\n        Uy = gradient_2nd_order(U, dy, axis=1)\n        Uyy = gradient_2nd_order(Uy, dy, axis=1)\n        \n        # Intermediate term F = (f0^2/N^2) * U_z\n        # N2 is 1D, shape (nz,). U is 2D, shape (nz, ny). Use broadcasting.\n        F = (f0**2 / N2[:, np.newaxis]) * Uz\n        \n        # F_z = dF/dz\n        Fz = gradient_2nd_order(F, dz, axis=0)\n        \n        # Final meridional PV gradient q_y\n        qy = beta - Uyy - Fz\n        \n        # --- Stability Analysis ---\n        \n        # 1. Check if the Charney-Stern necessary condition is satisfied\n        # This requires a sign change in q_y.\n        is_satisfied = bool(qy.min()  0 and qy.max() > 0)\n        results.append(str(is_satisfied))\n\n        # 2. Calculate the fraction of \"susceptible\" points\n        # Susceptible if q_y * beta  0. Since beta > 0, this is q_y  0.\n        # The condition N^2 > 0 is always met by the provided parameters.\n        susceptible_count = np.sum(qy  0)\n        total_points = qy.size\n        susceptible_fraction = susceptible_count / total_points\n        \n        # Append rounded fraction\n        results.append(f\"{susceptible_fraction:.6f}\")\n\n    # Format and print the final output\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}