{
    "hands_on_practices": [
        {
            "introduction": "对于任何大气科学家来说，将原始的探空数据（如压力-温度廓线 $T(p)$）转换为位温随高度变化的廓线 $\\theta(z)$ 是一项基本技能。这个实践练习将引导你从第一性原理出发，通过编程实现这一转换过程，从而巩固你对静力平衡、位温以及静力稳定度定义的理解。通过处理典型的对流层、近中性层和超绝热层等不同情景，你将学会如何从离散数据中识别出稳定、中性和不稳定的大气层结。",
            "id": "4093194",
            "problem": "您必须编写一个完整、可运行的程序，该程序对于每个以压力层和相应温度给出的无线电探空剖面，将温度剖面 $T(p)$ 转换为位温剖面 $\\theta(z)$，首先通过使用由静力平衡和理想气体定律推导出的测高方程将压力 $p$ 映射到几何高度 $z$，然后计算一个静力稳定度度量 $S(z)$，以将每个层分类为静力稳定、中性或不稳定。推导必须基于以下基本出发点：静力平衡、理想气体定律和干绝热热力学。假设空气是干燥的，因此虚温等于实际温度。位温计算使用固定的参考压力 $p_0$。使用逐层离散化的方法，该方法应符合典型对流层条件的科学真实性。\n\n您的程序必须遵守以下计算和输出规范：\n- 使用的物理常数：干空气气体常数 $R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，定压比热 $c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，重力加速度 $g = 9.80665\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，以及 $\\kappa = R_d/c_p$。位温参考压力为 $p_0 = 100000\\,\\mathrm{Pa}$。\n- 单位：压力必须以 $\\mathrm{Pa}$ 为单位，温度以 $\\mathrm{K}$ 为单位，几何高度以 $\\mathrm{m}$ 为单位，位温以 $\\mathrm{K}$ 为单位，静力稳定度度量 $S(z)$ 以 $\\mathrm{K}\\,\\mathrm{m}^{-1}$ 为单位。报告 $S(z)$ 时四舍五入到六位小数。\n- 高度计算：将最低层的高度设置为 $z_1 = 0\\,\\mathrm{m}$，并通过逐层应用测高关系，使用每层的平均温度来计算后续高度。\n- 位温计算：在每个层级根据 $T$ 和 $p$ 计算 $\\theta$。\n- 对于层级 $i$ 和 $i+1$ 之间的第 $i$ 层的静力稳定度度量定义：$S_i = \\Delta\\theta/\\Delta z$，其中 $\\Delta\\theta = \\theta_{i+1} - \\theta_i$ 且 $\\Delta z = z_{i+1} - z_i$。使用分类容差 $\\varepsilon = 0.001\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$（即 $1\\,\\mathrm{K}\\,\\mathrm{km}^{-1}$）来考虑数值和表示上的限制。根据以下规则对每个层进行分类：如果 $S_i > \\varepsilon$，则为稳定（输出整数 $1$）；如果 $|S_i| \\le \\varepsilon$，则为中性（输出整数 $0$）；如果 $S_i  -\\varepsilon$，则为不稳定（输出整数 $-1$）。\n- 角度单位不适用于此问题。\n\n测试集（压力 $p$ 单位为 $\\mathrm{Pa}$，温度 $T$ 单位为 $\\mathrm{K}$）：\n1. 一般对流层情况（预期普遍稳定）：\n   - $p = [100000, 90000, 80000, 70000]\\,\\mathrm{Pa}$，\n   - $T = [290.0, 283.0, 275.0, 268.0]\\,\\mathrm{K}$。\n2. 近中性干绝热情况（构造使得 $\\theta$ 近似恒定）：\n   - $p = [100000, 95000, 90000, 85000]\\,\\mathrm{Pa}$，\n   - $T = [300.000, 295.650, 291.105, 286.380]\\,\\mathrm{K}$。\n3. 地面超绝热情况（预期最低层不稳定）：\n   - $p = [100000, 97500, 95000, 92500, 90000]\\,\\mathrm{Pa}$，\n   - $T = [305.000, 302.200, 297.900, 293.400, 291.000]\\,\\mathrm{K}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个包含两个列表的列表：第一个是该用例中所有层的 $S_i$ 值列表（浮点数，四舍五入到六位小数，单位为 $\\mathrm{K}\\,\\mathrm{m}^{-1}$），第二个是使用上述规则对这些层进行的相应整数分类列表。例如，总输出结构必须是 $[\\,[\\,[S_0,S_1,\\dots],[C_0,C_1,\\dots]\\,],\\,\\dots\\,]$ 的形式，每个测试用例对应一对这样的列表，并汇总到打印在单行上的一个外部列表中。",
            "solution": "该问题是有效的，因为它科学地基于大气热力学的既定原理，定义良好，具有明确和完整的定义与约束，并以客观、正式的语言表述。不存在矛盾、歧义或事实不准确之处。因此，我们可以着手解决。\n\n任务是根据压力和温度探空数据确定大气层的静力稳定度。这涉及一个多步骤过程：首先，推导每个压力层的几何高度；其次，计算每个层级的位温；最后，计算每个层的位温垂直梯度以对其稳定度进行分类。\n\n### 理论基础\n\n解决方案源于三个基本原理：\n\n1.  **静力平衡：** 在静止流体中，向上的压力梯度力与作用在流体微元上的向下引力相平衡。此关系表示为：\n    $$ \\frac{dp}{dz} = -\\rho g $$\n    其中 $p$ 是压力，$z$ 是几何高度，$\\rho$ 是空气密度，$g$ 是重力加速度。\n\n2.  **理想气体定律：** 对于干空气，压力、密度和温度之间的关系由下式给出：\n    $$ p = \\rho R_d T $$\n    其中 $R_d$ 是干空气的比气体常数，$T$ 是开尔文温度。我们可以将密度表示为 $\\rho = p / (R_d T)$。\n\n3.  **位温：** 位温 $\\theta$ 是指一个气块在绝热地移动到参考压力 $p_0$ 时所达到的温度。对于干绝热过程，它是一个守恒量，其定义为：\n    $$ \\theta = T \\left( \\frac{p_0}{p} \\right)^{\\kappa} $$\n    其中 $\\kappa = R_d/c_p$，$c_p$ 是干空气的定压比热。\n\n### 测高方程的推导\n\n为了将压力层与几何高度联系起来，我们结合静力平衡方程和理想气体定律。将理想气体定律中 $\\rho$ 的表达式代入静力平衡方程，得到：\n$$ \\frac{dp}{dz} = -\\frac{p g}{R_d T} $$\n分离变量以求解高度增量 $dz$：\n$$ dz = -\\frac{R_d T}{g} \\frac{dp}{p} $$\n为了求出两个层级 $z_i$ 和 $z_{i+1}$（对应压力为 $p_i$ 和 $p_{i+1}$）之间大气层的厚度，我们对这个表达式进行积分。假设温度 $T$ 可以用该层的平均温度 $\\bar{T}_i = (T_i + T_{i+1})/2$ 来近似：\n$$ \\int_{z_i}^{z_{i+1}} dz = -\\frac{R_d \\bar{T}_i}{g} \\int_{p_i}^{p_{i+1}} \\frac{dp}{p} $$\n$$ z_{i+1} - z_i = -\\frac{R_d \\bar{T}_i}{g} [\\ln p]_{p_i}^{p_{i+1}} = -\\frac{R_d \\bar{T}_i}{g} (\\ln p_{i+1} - \\ln p_i) $$\n因此，层厚 $\\Delta z_i = z_{i+1} - z_i$ 由测高方程给出：\n$$ \\Delta z_i = \\frac{R_d \\bar{T}_i}{g} \\ln\\left(\\frac{p_i}{p_{i+1}}\\right) $$\n由于大气压力随高度降低，因此 $p_i  p_{i+1}$，这保证了 $\\ln(p_i/p_{i+1})  0$，从而 $\\Delta z_i  0$。\n\n### 静力稳定度分析\n\n干大气层的静力稳定度由位温的垂直梯度 $d\\theta/dz$ 决定。\n-   **稳定：** $d\\theta/dz  0$。一个垂直位移的气块会被迫返回其原始高度。\n-   **中性：** $d\\theta/dz = 0$。一个垂直位移的气块会停留在其新高度。\n-   **不稳定：** $d\\theta/dz  0$。一个垂直位移的气块会加速离开其原始高度。\n\n问题要求使用有限差分近似梯度进行逐层分析。对于层级 $i$ 和 $i+1$ 之间的层，静力稳定度度量 $S_i$ 定义为：\n$$ S_i = \\frac{\\Delta\\theta_i}{\\Delta z_i} = \\frac{\\theta_{i+1} - \\theta_i}{z_{i+1} - z_i} $$\n其中 $\\theta_i$ 和 $\\theta_{i+1}$ 是层级 $i$ 和 $i+1$ 的位温，而 $\\Delta z_i$ 是先前计算的层厚。\n\n### 计算算法\n\n对于每个给定的气象剖面（$p_{levels}, T_{levels}$）：\n\n1.  **常数和初始化：**\n    - 定义物理常数：$g = 9.80665\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，$R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$p_0 = 100000\\,\\mathrm{Pa}$。\n    - 计算 $\\kappa = R_d/c_p$。\n    - 设置分类容差 $\\varepsilon = 0.001\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$。\n    - 令 $N$ 为剖面中的层级数。初始化一个大小为 $N$ 的数组 `z_levels`，其中 $z_{levels}[0] = 0.0$。\n    - 初始化空列表 `s_values` 和 `classifications` 以存储各层的结果。\n\n2.  **计算位温剖面：**\n    - 创建一个大小为 $N$ 的数组 `theta_levels`。\n    - 对于从 $0$ 到 $N-1$ 的每个层级 $i$，计算 $\\theta_i = T_{levels}[i] \\left( p_0 / p_{levels}[i] \\right)^{\\kappa}$ 并存入 `theta_levels`。\n\n3.  **遍历各层：**\n    - 对从 $0$ 到 $N-2$ 的每个层 $i$ 进行循环。\n    - **a. 计算层厚 $\\Delta z_i$**：\n        - 计算该层的平均温度：$\\bar{T}_i = (T_{levels}[i] + T_{levels}[i+1]) / 2$。\n        - 计算 $\\Delta z_i = (R_d \\bar{T}_i / g) \\ln(p_{levels}[i] / p_{levels}[i+1])$。\n    - **b. 更新高度剖面**：\n        - 计算下一个层级的高度：$z_{levels}[i+1] = z_{levels}[i] + \\Delta z_i$。\n    - **c. 计算稳定度度量 $S_i$**：\n        - 计算位温差：$\\Delta\\theta_i = \\theta_{levels}[i+1] - \\theta_{levels}[i]$。\n        - 计算 $S_i = \\Delta\\theta_i / \\Delta z_i$。\n        - 将四舍五入后的值 `round(S_i, 6)` 附加到 `s_values` 列表中。\n    - **d. 对层稳定度进行分类**：\n        - 如果 $S_i  \\varepsilon$，则将 $1$ (稳定) 附加到 `classifications`。\n        - 如果 $S_i  -\\varepsilon$，则将 $-1$ (不稳定) 附加到 `classifications`。\n        - 否则（$|S_i| \\le \\varepsilon$），将 $0$ (中性) 附加到 `classifications`。\n\n4.  **格式化输出：**\n    - 将 `s_values` 和 `classifications` 列表聚合成当前测试用例指定的嵌套列表结构。\n    - 对所有测试用例重复此过程，并按要求将最终结果格式化为单个输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and classifies static stability for given atmospheric profiles.\n    \"\"\"\n    # Physical constants\n    R_d = 287.0  # J kg^-1 K^-1\n    c_p = 1004.0 # J kg^-1 K^-1\n    g = 9.80665 # m s^-2\n    p_0 = 100000.0 # Pa\n    kappa = R_d / c_p\n    epsilon = 0.001 # K m^-1, classification tolerance\n\n    # Test suite\n    test_cases = [\n        # Case 1: General tropospheric case\n        (\n            np.array([100000.0, 90000.0, 80000.0, 70000.0]),\n            np.array([290.0, 283.0, 275.0, 268.0])\n        ),\n        # Case 2: Near-neutral dry-adiabatic case\n        (\n            np.array([100000.0, 95000.0, 90000.0, 85000.0]),\n            np.array([300.000, 295.650, 291.105, 286.380])\n        ),\n        # Case 3: Surface-based superadiabatic case\n        (\n            np.array([100000.0, 97500.0, 95000.0, 92500.0, 90000.0]),\n            np.array([305.000, 302.200, 297.900, 293.400, 291.000])\n        )\n    ]\n\n    all_results_str = []\n\n    for p_levels, t_levels in test_cases:\n        num_levels = len(p_levels)\n        s_values = []\n        classifications = []\n\n        # Step 1: Compute potential temperature at all levels\n        theta_levels = t_levels * (p_0 / p_levels)**kappa\n\n        # Step 2: Initialize height profile\n        z_levels = np.zeros(num_levels)\n        z_levels[0] = 0.0\n\n        # Step 3: Iterate through layers to compute heights, stability, and classify\n        for i in range(num_levels - 1):\n            # Get data for the layer between level i and i+1\n            p_i, p_i_plus_1 = p_levels[i], p_levels[i+1]\n            t_i, t_i_plus_1 = t_levels[i], t_levels[i+1]\n            theta_i, theta_i_plus_1 = theta_levels[i], theta_levels[i+1]\n            \n            # Compute layer thickness using the hypsometric equation\n            t_mean = (t_i + t_i_plus_1) / 2.0\n            delta_z = (R_d * t_mean / g) * np.log(p_i / p_i_plus_1)\n            \n            # Compute height of the next level\n            z_levels[i+1] = z_levels[i] + delta_z\n\n            # Compute static stability measure S_i for the layer\n            delta_theta = theta_i_plus_1 - theta_i\n            s_i = delta_theta / delta_z\n            s_values.append(s_i)\n\n            # Classify the layer\n            if s_i > epsilon:\n                classifications.append(1)  # Stable\n            elif s_i  -epsilon:\n                classifications.append(-1) # Unstable\n            else:\n                classifications.append(0)  # Neutral\n        \n        # Format the results for the current case\n        s_str = f\"[{','.join(f'{s:.6f}' for s in s_values)}]\"\n        c_str = f\"[{','.join(map(str, classifications))}]\"\n        case_result_str = f\"[{s_str},{c_str}]\"\n        all_results_str.append(case_result_str)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(all_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在真实大气中，尤其是在云层内部，空气密度（以及浮力）不仅受温度影响，还受到水汽和液态水含量的显著影响。本练习将引导你从简化的干空气模型过渡到更真实的湿空气模型，学习如何精确量化这些湿过程对布伦特-瓦萨拉频率 $N^2$（静力稳定度的核心度量）的修正。通过推导并计算由水汽和液态水梯度引起的稳定度变化，你将更深刻地理解在数值天气预报和气候模型中，为何必须使用虚位温 $\\theta_v$ 来进行准确的浮力评估。",
            "id": "4093189",
            "problem": "考虑一个数值天气预报和气候模拟框架中水平均匀的云层，该云层处于静力平衡状态，并对湿空气采用稀疏近似。Brunt–Väisälä 频率的平方 ($N^2$) 是控制小振幅垂直振荡的静力稳定度度量。虚位温 $\\theta_v$ 通过经过充分检验的湿空气近似 $\\theta_v=\\theta\\left(1+0.61\\,q-q_{l}\\right)$ 与干位温 $\\theta$ 相关联，其中 $q$ 是水汽比湿，$q_l$ 是液态水混合比。假设该云层具有以下基本态属性：\n- 水汽比湿 $q=0.01$ 和液态水混合比 $q_l=0.002$。\n- 垂直梯度 $\\frac{\\partial q}{\\partial z}=-3.0\\times 10^{-6}\\ \\text{m}^{-1}$ 和 $\\frac{\\partial q_{l}}{\\partial z}=-1.0\\times 10^{-6}\\ \\text{m}^{-1}$。\n- 干位温 $\\theta=300\\ \\text{K}$，其垂直梯度为 $\\frac{\\partial \\theta}{\\partial z}=0.003\\ \\text{K}\\ \\text{m}^{-1}$。\n- 重力加速度 $g=9.81\\ \\text{m}\\ \\text{s}^{-2}$。\n\n从浮力和静力稳定度的基本定义出发，推导当用 $\\theta_v$ 代替 $\\theta$ 时对 $N^2$ 产生的修正项的表达式，对指定的云层数值计算此修正项，并判断稳定度分类（稳定/中性/不稳定）是否会因此修正而改变。仅报告修正项 $\\Delta N^2$ 的数值，单位为 $\\text{s}^{-2}$，并四舍五入到三位有效数字。",
            "solution": "本题要求计算在一个云层中，由于水汽和液态水的存在，对 Brunt–Väisälä 频率平方 $N^{2}$ 产生的修正项的数值。我们将首先从基本原理出发推导该修正项的表达式，然后使用所提供的数据进行计算。\n\nBrunt–Väisälä 频率的平方 $N^{2}$ 是重力作用下流体静力稳定度的基本度量。它量化了一个从平衡位置位移的气块垂直振荡的角频率的平方。对于一个垂直位移了很小距离 $\\delta z$ 的气块，其恢复加速度由 $a = -N^{2} \\delta z$ 给出。稳定性要求存在恢复力，这意味着 $N^{2}  0$。\n\n恢复力是浮力，它与气块与其环境之间的密度差成正比。对于大气应用，使用位温更为方便，因为它在绝热位移过程中是守恒的。通常，浮力由虚位温 $\\theta_v$ 决定，因为它正比于一个气块被带到参考气压时所具有的温度，同时考虑了水汽对密度的影响。Brunt–Väisälä 频率平方的严格定义是：\n$$N^{2} = \\frac{g}{\\theta_v} \\frac{\\partial \\theta_v}{\\partial z}$$\n这里，$g$ 是重力加速度，$\\frac{\\partial \\theta_v}{\\partial z}$ 是环境虚位温的垂直梯度。这种一般形式，我们记为 $N_v^2$，正确地考虑了所有由温度和水汽引起的浮力效应。\n\n问题要求计算当使用 $\\theta_v$ 代替 $\\theta$ 时对 $N^{2}$ 产生的修正项。这意味着要比较完整的湿稳定度度量 $N_v^2$ 和忽略水汽效应计算出的稳定度度量，即干 Brunt–Väisälä 频率平方 $N_d^2$：\n$$N_d^2 = \\frac{g}{\\theta} \\frac{\\partial \\theta}{\\partial z}$$\n因此，我们记为 $\\Delta N^2$ 的修正项是湿稳定度参数和干稳定度参数之间的差值：\n$$\\Delta N^2 = N_v^2 - N_d^2$$\n\n为了推导 $\\Delta N^2$ 的表达式，我们从给定的虚位温近似公式开始：\n$$\\theta_{v} = \\theta\\left(1 + \\alpha q - q_{l}\\right)$$\n其中我们使用缩写 $\\alpha = 0.61$。我们需要使用乘法求导法则计算其垂直梯度 $\\frac{\\partial \\theta_v}{\\partial z}$：\n$$\\frac{\\partial \\theta_v}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ \\theta(1 + \\alpha q - q_{l}) \\right]$$\n$$\\frac{\\partial \\theta_v}{\\partial z} = \\frac{\\partial \\theta}{\\partial z} (1 + \\alpha q - q_{l}) + \\theta \\frac{\\partial}{\\partial z} (1 + \\alpha q - q_{l})$$\n$$\\frac{\\partial \\theta_v}{\\partial z} = \\frac{\\partial \\theta}{\\partial z} (1 + \\alpha q - q_{l}) + \\theta \\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right)$$\n现在我们将此式代入 $N_v^2$ 的表达式中：\n$$N_v^2 = \\frac{g}{\\theta_v} \\frac{\\partial \\theta_v}{\\partial z} = \\frac{g}{\\theta(1 + \\alpha q - q_{l})} \\left[ \\frac{\\partial \\theta}{\\partial z} (1 + \\alpha q - q_{l}) + \\theta \\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right) \\right]$$\n分离各项可得：\n$$N_v^2 = \\frac{g}{\\theta(1 + \\alpha q - q_{l})} \\frac{\\partial \\theta}{\\partial z} (1 + \\alpha q - q_{l}) + \\frac{g}{\\theta(1 + \\alpha q - q_{l})} \\theta \\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right)$$\n$$N_v^2 = \\frac{g}{\\theta} \\frac{\\partial \\theta}{\\partial z} + \\frac{g\\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right)}{1 + \\alpha q - q_{l}}$$\n第一项正是 $N_d^2$。因此，修正项 $\\Delta N^2$ 为：\n$$\\Delta N^2 = N_v^2 - N_d^2 = \\frac{g\\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right)}{1 + \\alpha q - q_{l}}$$\n这就是修正项的解析表达式。\n\n我们现在使用给定的数值来对此表达式进行计算：\n- $g = 9.81 \\, \\mathrm{m \\, s^{-2}}$\n- $\\alpha = 0.61$\n- $q = 0.01$\n- $q_{l} = 0.002$\n- $\\frac{\\partial q}{\\partial z} = -3.0 \\times 10^{-6} \\, \\mathrm{m}^{-1}$\n- $\\frac{\\partial q_{l}}{\\partial z} = -1.0 \\times 10^{-6} \\, \\mathrm{m}^{-1}$\n\n首先，我们计算分子：\n$$g\\left(\\alpha \\frac{\\partial q}{\\partial z} - \\frac{\\partial q_l}{\\partial z}\\right) = 9.81 \\left(0.61 \\times (-3.0 \\times 10^{-6}) - (-1.0 \\times 10^{-6})\\right)$$\n$$= 9.81 \\left(-1.83 \\times 10^{-6} + 1.0 \\times 10^{-6}\\right) \\, \\mathrm{s^{-2}}$$\n$$= 9.81 \\left(-0.83 \\times 10^{-6}\\right) \\, \\mathrm{s^{-2}}$$\n$$= -8.1423 \\times 10^{-6} \\, \\mathrm{s^{-2}}$$\n接下来，我们计算分母：\n$$1 + \\alpha q - q_{l} = 1 + 0.61 \\times 0.01 - 0.002$$\n$$= 1 + 0.0061 - 0.002$$\n$$= 1.0041$$\n最后，我们计算 $\\Delta N^2$：\n$$\\Delta N^2 = \\frac{-8.1423 \\times 10^{-6}}{1.0041} \\, \\mathrm{s^{-2}} \\approx -8.10905 \\times 10^{-6} \\, \\mathrm{s^{-2}}$$\n题目要求答案四舍五入到三位有效数字。\n$$\\Delta N^2 \\approx -8.11 \\times 10^{-6} \\, \\mathrm{s^{-2}}$$\n\n为了判断稳定度分类是否改变，我们必须比较 $N_d^2$ 和 $N_v^2 = N_d^2 + \\Delta N^2$ 的符号。我们先计算 $N_d^2$：\n$$N_d^2 = \\frac{g}{\\theta} \\frac{\\partial \\theta}{\\partial z} = \\frac{9.81 \\, \\mathrm{m \\, s^{-2}}}{300 \\, \\mathrm{K}} \\times (0.003 \\, \\mathrm{K \\, m^{-1}})$$\n$$N_d^2 = 9.81 \\times 10^{-5} \\, \\mathrm{s^{-2}}$$\n由于 $N_d^2  0$，如果忽略水汽效应，大气将被分类为静力稳定。\n完整的稳定度为：\n$$N_v^2 = N_d^2 + \\Delta N^2 = 9.81 \\times 10^{-5} + (-8.11 \\times 10^{-6}) = 9.81 \\times 10^{-5} - 0.811 \\times 10^{-5}$$\n$$N_v^2 = (9.81 - 0.811) \\times 10^{-5} \\, \\mathrm{s^{-2}} = 8.999 \\times 10^{-5} \\, \\mathrm{s^{-2}}$$\n由于 $N_v^2$ 也为正，该层仍然是静力稳定的。水汽梯度引入了一个不稳定效应（$\\Delta N^2  0$），但其强度不足以克服位温梯度提供的背景稳定度。因此，稳定度分类没有改变。\n\n最终要求的答案是修正项 $\\Delta N^2$ 的数值。",
            "answer": "$$\n\\boxed{-8.11 \\times 10^{-6}}\n$$"
        },
        {
            "introduction": "从静力稳定度到动力稳定度，我们需要考虑风切变的作用。大气湍流通常可以看作是稳定的浮力与不稳定的风切变之间的一场“博弈”。这个练习将介绍一个关键的无量纲参数——理查森数 ($Ri$)，它精确地量化了这种平衡关系。你将通过从湍流能量收支方程出发推导其表达式，并计算其局部（梯度）和整层平均（块）的形式，来评估湍流发生的可能性。",
            "id": "4093164",
            "problem": "在平坦地形上，从地表到 $100\\,\\mathrm{m}$ 的层顶高度之间，观测到一个水平均匀的夜间边界层。湿度效应可以忽略不计，位温等于虚位温。参考位温为 $\\theta_0=300\\,\\mathrm{K}$，重力加速度为 $g=9.81\\,\\mathrm{m\\,s^{-2}}$。在 $100\\,\\mathrm{m}$ 的层内，位温增加了 $\\Delta \\theta = 3\\,\\mathrm{K}$，平均风速增加了 $\\Delta U = 8\\,\\mathrm{m\\,s^{-1}}$。在 $z=50\\,\\mathrm{m}$ 处，测得局地流向切变为 $\\partial U/\\partial z = 0.02\\,\\mathrm{s^{-1}}$，横流向切变可以忽略不计，因此 $\\partial V/\\partial z \\approx 0$。\n\n从Boussinesq近似下的湍流总动能（TKE）收支方程和通过Brunt–Väisälä频率平方定义的静力稳定度出发，推导梯度理查森数 $Ri$ 和整体理查森数 $Ri_{b}$ 的表达式，使用给定物理量表示。然后，使用推导出的表达式计算 $z=50\\,\\mathrm{m}$ 处的 $Ri$ 和整个 $0$–$100\\,\\mathrm{m}$ 层的 $Ri_{b}$。在你的论证中，通过将计算值与大气流动中抑制切变驱动湍流的常用临界阈值进行比较，评估其稳定度状况。\n\n以小数形式报告两个无量纲数 $Ri$ 和 $Ri_{b}$，并将每个数值四舍五入至三位有效数字。最终报告的数值不应包含单位。",
            "solution": "此问题被评估为有效，因为它在科学上基于大气流体动力学原理，问题阐述清晰且提供了所有必要信息，并且其表述是客观的。\n\n第一步是推导梯度理查森数 $Ri$ 的表达式。该推导从湍流总动能（TKE）$\\bar{e}$ 的收支方程开始，对于Boussinesq近似下的水平均匀流，该方程可写为：\n$$\n\\frac{D\\bar{e}}{Dt} = P + B - \\epsilon + T\n$$\n此处，$P$ 是切变生成率，$B$ 是浮力生成/耗散率，$\\epsilon$ 是粘性耗散率，$T$ 是输送项。与稳定性相关的两项是湍流的切变生成和浮力生成/耗散。\n\n切变生成项由 $P = -\\overline{u'w'}\\frac{\\partial U}{\\partial z} - \\overline{v'w'}\\frac{\\partial V}{\\partial z}$ 给出，其中 $(U, V)$ 是平均水平风分量，$(u', v', w')$ 是湍流速度脉动。浮力生成项为 $B = \\frac{g}{\\theta_0}\\overline{w'\\theta_v'}$，其中 $g$ 是重力加速度，$\\theta_0$ 是参考位温，$\\theta_v'$ 是虚位温脉动。由于问题声明湿度效应可以忽略不计，位温 $\\theta$ 等于虚位温 $\\theta_v$。在稳定层结环境中，位温随高度增加，$\\overline{w'\\theta'}$ 为负值（向上移动的气块较冷，向下移动的气块较暖），因此 $B$ 为负，表示对TKE的耗散。\n\n使用一阶闭合（K-理论），湍流通量参数化为：\n$$\n-\\overline{u'w'} = K_m \\frac{\\partial U}{\\partial z}\n$$\n$$\n-\\overline{v'w'} = K_m \\frac{\\partial V}{\\partial z}\n$$\n$$\n-\\overline{w'\\theta'} = K_h \\frac{\\partial \\theta}{\\partial z}\n$$\n其中 $K_m$ 和 $K_h$ 分别是涡动粘性系数和热的涡动扩散系数。\n\n将这些代入 $P$ 和 $B$ 的表达式中，得到：\n$$\nP = K_m \\left[ \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\right]\n$$\n$$\nB = -\\frac{g}{\\theta_0} K_h \\frac{\\partial \\theta}{\\partial z}\n$$\n梯度理查森数 $Ri$ 定义为TKE的浮力耗散与切变生成之比，假设湍流普朗特数 $Pr_t = K_m/K_h$ 等于 $1$。它是浮力稳定项与切变不稳定项之比。\n$$\nRi = \\frac{-B}{P} \\bigg|_{K_m=K_h} = \\frac{\\frac{g}{\\theta_0} K_h \\frac{\\partial \\theta}{\\partial z}}{K_m \\left[ \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\right]} = \\frac{\\frac{g}{\\theta_0} \\frac{\\partial \\theta}{\\partial z}}{\\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2}\n$$\n分子中的项是Brunt–Väisälä频率的平方，$N^2$，这是静力稳定度的主要度量：\n$$\nN^2 = \\frac{g}{\\theta_0} \\frac{\\partial \\theta}{\\partial z}\n$$\n分母中的项是垂直风切变大小的平方，$S^2 = \\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2$。因此，梯度理查森数的表达式为：\n$$\nRi = \\frac{N^2}{S^2}\n$$\n为了计算 $z=50\\,\\mathrm{m}$ 处的 $Ri$，我们使用所提供的数据。我们假设位温梯度在整个层内是恒定的，所以 $\\frac{\\partial \\theta}{\\partial z} \\approx \\frac{\\Delta \\theta}{\\Delta z}$。\n已知：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\theta_0 = 300\\,\\mathrm{K}$，$\\Delta \\theta = 3\\,\\mathrm{K}$，层高为 $\\Delta z = 100\\,\\mathrm{m}$。\n首先，我们计算 $N^2$：\n$$\nN^2 \\approx \\frac{g}{\\theta_0} \\frac{\\Delta \\theta}{\\Delta z} = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{300\\,\\mathrm{K}} \\frac{3\\,\\mathrm{K}}{100\\,\\mathrm{m}} = 0.000981\\,\\mathrm{s^{-2}}\n$$\n在 $z=50\\,\\mathrm{m}$ 处，给出的切变分量为 $\\frac{\\partial U}{\\partial z} = 0.02\\,\\mathrm{s^{-1}}$ 和 $\\frac{\\partial V}{\\partial z} \\approx 0$。切变的平方是：\n$$\nS^2 = (0.02\\,\\mathrm{s^{-1}})^2 + (0)^2 = 0.0004\\,\\mathrm{s^{-2}}\n$$\n现在，我们可以计算梯度理查森数：\n$$\nRi = \\frac{N^2}{S^2} = \\frac{0.000981\\,\\mathrm{s^{-2}}}{0.0004\\,\\mathrm{s^{-2}}} = 2.4525\n$$\n四舍五入至三位有效数字，$Ri \\approx 2.45$。\n\n接下来，我们推导整体理查森数 $Ri_b$ 的表达式。这是梯度理查森数的一种有限差分形式，在一个离散层上进行评估。导数被层厚 $\\Delta z$ 上的有限差分所取代：\n$$\n\\frac{\\partial \\theta}{\\partial z} \\rightarrow \\frac{\\Delta \\theta}{\\Delta z}\n$$\n$$\n\\left(\\frac{\\partial U}{\\partial z}\\right)^2 + \\left(\\frac{\\partial V}{\\partial z}\\right)^2 \\rightarrow \\frac{(\\Delta U)^2 + (\\Delta V)^2}{(\\Delta z)^2}\n$$\n将这些代入 $Ri$ 的表达式，得到整体理查森数：\n$$\nRi_b = \\frac{\\frac{g}{\\theta_0}\\frac{\\Delta \\theta}{\\Delta z}}{\\frac{(\\Delta U)^2 + (\\Delta V)^2}{(\\Delta z)^2}} = \\frac{g}{\\theta_0}\\frac{\\Delta \\theta \\Delta z}{(\\Delta U)^2 + (\\Delta V)^2}\n$$\n为了计算 $0-100\\,\\mathrm{m}$ 层的 $Ri_b$，我们使用给定的整体物理量：$\\Delta \\theta = 3\\,\\mathrm{K}$，$\\Delta z = 100\\,\\mathrm{m}$，以及 $\\Delta U = 8\\,\\mathrm{m\\,s^{-1}}$。由于横流向切变可以忽略不计，我们假设横流向风分量的变化 $\\Delta V$ 为零。\n$$\nRi_b = \\frac{(9.81\\,\\mathrm{m\\,s^{-2}})(3\\,\\mathrm{K})(100\\,\\mathrm{m})}{(300\\,\\mathrm{K})((8\\,\\mathrm{m\\,s^{-1}})^2 + 0^2)} = \\frac{2943}{300 \\times 64} = \\frac{2943}{19200} \\approx 0.15328125\n$$\n四舍五入至三位有效数字，$Ri_b \\approx 0.153$。\n\n最后，我们评估稳定度状况。临界理查森数 $Ri_c = 0.25$ 通常用作湍流存在的阈值。\n对于 $z=50\\,\\mathrm{m}$ 处的局地条件，计算出的梯度理查森数为 $Ri \\approx 2.45$。该值显著大于 $Ri_c = 0.25$。当 $Ri  0.25$ 时，稳定层结足够强以克服切变，导致湍流被抑制和衰减。$Ri  1$ 的值通常被认为是绝对动力稳定性的条件，此时线性扰动无法增长。因此，$z=50\\,\\mathrm{m}$ 处的流动非常稳定，很可能是层流。\n对于整个层，计算出的整体理查森数是 $Ri_b \\approx 0.153$。该值小于 $Ri_c = 0.25$，表明该层上的总切变足以潜在地产生并维持湍流，以抵抗总体的层结作用。\n$Ri$ 和 $Ri_b$ 之间的差异表明，风切变和/或温度梯度在整个层内不是均匀的。虽然层的平均条件有利于湍流，但层内存在一些局地非常稳定的区域，例如在 $z=50\\,\\mathrm{m}$ 处。这是夜间稳定边界层的一个典型特征，其中即使其他区域是静止的，间歇性湍流也可能在局地 $Ri$ 值较低的区域发生。\n\n所要求的两个无量纲数是 $Ri$ 和 $Ri_b$。\n$z=50\\,\\mathrm{m}$ 处的 $Ri$ 是 $2.45$。\n$0-100\\,\\mathrm{m}$ 层的 $Ri_b$ 是 $0.153$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.45  0.153\n\\end{pmatrix}\n}\n$$"
        }
    ]
}