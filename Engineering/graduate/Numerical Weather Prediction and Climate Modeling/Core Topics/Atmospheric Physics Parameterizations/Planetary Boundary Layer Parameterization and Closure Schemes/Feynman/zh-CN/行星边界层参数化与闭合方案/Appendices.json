{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于最基本的尺度：大气近地面层。本练习的核心是利用核心观测数据计算莫宁-奥布霍夫长度（$L$），这是决定稳定性的关键参数。掌握这项计算对于理解剪切和浮力如何竞争产生湍流至关重要，而这也是所有行星边界层（PBL）参数化方案的基石。",
            "id": "4075988",
            "problem": "在行星边界层（PBL）的一阶通量-梯度闭合框架内，使用了一次在均匀、平坦地形上进行的近地层观测。莫宁-奥布霍夫相似性理论（MOST）引入了莫宁-奥布霍夫长度，这是一个依赖于稳定度的尺度，源于湍流动能收支中湍流的切变产生和浮力产生的平衡。假设空气为干空气，因此虚数量等于其位温对应量，并假设满足数值天气预报（NWP）中近地层典型的水平均匀、定常条件。\n\n您将获得以下测量量和常数：\n- 摩擦速度 $u_* = 0.45 \\ \\mathrm{m \\ s^{-1}}$。\n- 平均位温 $\\overline{\\theta} = 300 \\ \\mathrm{K}$。\n- 运动学感热通量 $\\overline{w'\\theta'} = +0.06 \\ \\mathrm{K \\ m \\ s^{-1}}$（向上为正）。\n- 冯·卡门常数 $\\kappa = 0.40$。\n- 重力加速度 $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$。\n- 高度 $z = 20 \\ \\mathrm{m}$。\n\n从湍流动能收支和 MOST 尺度律论证出发，用 $u_*$、$\\overline{w'\\theta'}$、$\\overline{\\theta}$、$\\kappa$ 和 $g$ 推导出莫宁-奥布霍夫长度 $L$。然后计算 $L$ 和无量纲稳定度参数 $\\zeta = z/L$。根据 $\\zeta$ 的符号，对稳定度状况进行分类，并定性预测在一阶闭合方案中，与中性条件相比，垂直混合（动量和热量的涡动扩散系数）将如何变化。\n\n将 $\\zeta$ 的最终数值四舍五入至四位有效数字。最终答案应仅为 $\\zeta$ 的值，在方框中以无单位的纯数表示。",
            "solution": "### 第一步：提取已知量\n- 摩擦速度：$u_* = 0.45 \\ \\mathrm{m \\ s^{-1}}$\n- 平均位温：$\\overline{\\theta} = 300 \\ \\mathrm{K}$\n- 运动学感热通量：$\\overline{w'\\theta'} = +0.06 \\ \\mathrm{K \\ m \\ s^{-1}}$\n- 冯·卡门常数：$\\kappa = 0.40$\n- 重力加速度：$g = 9.81 \\ \\mathrm{m \\ s^{-2}}$\n- 高度：$z = 20 \\ \\mathrm{m}$\n\n### 第二步：使用提取的已知量进行验证\n该问题具有科学依据，提法恰当，客观且自洽。这是大气边界层物理学中的一个标准练习，具体应用了莫宁-奥布霍夫相似性理论（MOST）。所有术语都在该领域的标准词汇中定义，所提供的值对于地球近地层是物理上现实的。该问题不违反任何科学定律，不基于错误的前提，并包含足够的信息以获得唯一解。问题清晰，其要求无矛盾。该问题被认为是 **有效的**。\n\n### 第三步：进行求解\n\n该问题要求推导莫宁-奥布霍夫长度 $L$，计算其值，计算稳定度参数 $\\zeta$，并分析稳定度状况对混合的影响。\n\n**莫宁-奥布霍夫长度 ($L$) 的推导**\n\n莫宁-奥布霍夫长度源于大气近地层的湍流动能（TKE）收支。对于水平均匀和定常条件，单位质量的简化 TKE 收支方程是切变产生、浮力产生/消耗和耗散（$\\epsilon$）之间的平衡：\n$$ 0 = -\\overline{u'w'} \\frac{\\partial \\overline{u}}{\\partial z} + \\frac{g}{\\overline{\\theta}} \\overline{w'\\theta'} - \\epsilon $$\n此处，我们使用了干空气假设（$\\theta_v = \\theta$）。\n\n各项代表：\n1.  **切变产生：** $-\\overline{u'w'} \\frac{\\partial \\overline{u}}{\\partial z}$。只要存在风切变，该项总是 TKE 的源。\n2.  **浮力产生/消耗：** $\\frac{g}{\\overline{\\theta}} \\overline{w'\\theta'}$。该项可以是 TKE 的源（不稳定条件，$\\overline{w'\\theta'} > 0$）或汇（稳定条件，$\\overline{w'\\theta'}   0$）。\n\n根据莫宁-奥布霍夫相似性理论（MOST），平均风和位温的垂直梯度是无量纲稳定度参数 $\\zeta = z/L$ 的普适函数。对于风切变，表示为：\n$$ \\frac{\\partial \\overline{u}}{\\partial z} = \\frac{u_*}{\\kappa z} \\phi_m(\\zeta) $$\n其中 $u_* = \\sqrt{-\\overline{u'w'}}$ 是摩擦速度，$\\phi_m(\\zeta)$ 是一个无量纲稳定度函数。\n\n使用这些 MOST 关系，切变产生项可以改写为：\n$$ \\text{Shear Production} = u_*^2 \\left( \\frac{u_*}{\\kappa z} \\phi_m(\\zeta) \\right) = \\frac{u_*^3}{\\kappa z} \\phi_m(\\zeta) $$\n\n莫宁-奥布霍夫长度 $L$ 本质上是一个由切变和浮力的特征尺度构建的长度尺度。它被定义为切变产生和浮力产生的量级变得相当的高度。更正式地，$L$ 被定义为将关键参数组合成一个单一的长度尺度：\n$$ L \\equiv - \\frac{u_*^3}{\\kappa \\left( \\frac{g}{\\overline{\\theta}} \\overline{w'\\theta'} \\right)} $$\n分母中的项 $B = \\frac{g}{\\overline{\\theta}}\\overline{w'\\theta'}$ 是地表浮力通量。负号是一个约定，以确保在不稳定条件下（$\\overline{w'\\theta'} > 0$）$L$ 为负，在稳定条件下（$\\overline{w'\\theta'}   0$）$L$ 为正。\n\n这个定义可以通过考虑浮力产生与切变产生的比率，即通量理查森数 $R_f$ 来得到：\n$$ R_f = \\frac{\\text{Buoyant Production}}{\\text{Shear Production}} = \\frac{\\frac{g}{\\overline{\\theta}}\\overline{w'\\theta'}}{\\frac{u_*^3}{\\kappa z}\\phi_m(\\zeta)} = \\frac{\\kappa z g \\overline{w'\\theta'}}{u_*^3 \\overline{\\theta} \\phi_m(\\zeta)} $$\nMOST 假定 $R_f = \\zeta / \\phi_m(\\zeta)$。将 $R_f$ 的两个表达式相等，得到：\n$$ \\frac{\\zeta}{\\phi_m(\\zeta)} = \\frac{\\kappa z g \\overline{w'\\theta'}}{u_*^3 \\overline{\\theta} \\phi_m(\\zeta)} $$\n这可以简化为 $\\zeta = \\frac{\\kappa z g \\overline{w'\\theta'}}{u_*^3 \\overline{\\theta}}$。由于 $\\zeta = z/L$，我们有 $\\frac{1}{L} = \\frac{\\kappa g \\overline{w'\\theta'}}{u_*^3 \\overline{\\theta}}$。这个定义省略了常规的负号。为了协调，物理论证是基于 TKE 的主导源切换的高度。因此，我们使用标准定义：\n$$ L = - \\frac{u_*^3 \\overline{\\theta}}{\\kappa g \\overline{w'\\theta'}} $$\n\n**$L$ 和 $\\zeta$ 的计算**\n\n使用给定的值：\n- $u_* = 0.45 \\ \\mathrm{m \\ s^{-1}}$\n- $\\overline{\\theta} = 300 \\ \\mathrm{K}$\n- $\\overline{w'\\theta'} = 0.06 \\ \\mathrm{K \\ m \\ s^{-1}}$\n- $\\kappa = 0.40$\n- $g = 9.81 \\ \\mathrm{m \\ s^{-2}}$\n- $z = 20 \\ \\mathrm{m}$\n\n首先，我们计算莫宁-奥布霍夫长度 $L$：\n$$ L = - \\frac{(0.45)^3 \\times 300}{0.40 \\times 9.81 \\times 0.06} = - \\frac{0.091125 \\times 300}{0.23544} = - \\frac{27.3375}{0.23544} \\approx -116.11 \\ \\mathrm{m} $$\n接着，我们计算无量纲稳定度参数 $\\zeta$：\n$$ \\zeta = \\frac{z}{L} = \\frac{20}{-116.112385...} \\approx -0.1722444 $$\n四舍五入到四位有效数字，我们得到 $\\zeta = -0.1722$。\n\n**稳定度状况分类及对混合的影响**\n\n$\\zeta$ 的符号决定了稳定度状况：\n- $\\zeta > 0$：稳定条件（浮力抑制湍流）。\n- $\\zeta = 0$：中性条件（浮力无影响）。\n- $\\zeta  0$：不稳定条件（浮力增强湍流）。\n\n在本例中，$\\zeta \\approx -0.1722$，为负值。因此，大气近地层处于 **不稳定** 条件下。这与正（向上）的感热通量一致，表明地表比其上方的空气更暖，从而驱动对流运动。\n\n在一阶闭合方案中，湍流通量使用动量涡动扩散系数（$K_m$）和热量涡动扩散系数（$K_h$）进行参数化：\n$$ -\\overline{u'w'} = K_m \\frac{\\partial \\overline{u}}{\\partial z} \\quad \\text{and} \\quad -\\overline{w'\\theta'} = K_h \\frac{\\partial \\overline{\\theta}}{\\partial z} $$\n根据 MOST，这些扩散系数不是常数，而是依赖于稳定度：\n$$ K_m = \\frac{\\kappa u_* z}{\\phi_m(\\zeta)} \\quad \\text{and} \\quad K_h = \\frac{\\kappa u_* z}{\\phi_h(\\zeta)} $$\n对于 **中性条件**，$\\zeta = 0$，根据定义，$\\phi_m(0) = 1$ 且 $\\phi_h(0) \\approx 1$。扩散系数为 $K_{m,n} = \\kappa u_* z$ 和 $K_{h,n} = \\kappa u_* z$。\n\n对于 **不稳定条件**，如此处所发现的（$\\zeta  0$），经验证据表明稳定度函数 $\\phi_m$ 和 $\\phi_h$ 小于 1。例如，广泛使用的 Businger-Dyer 关系式表明：\n$$ \\phi_m(\\zeta) = (1 - 16\\zeta)^{-1/4} $$\n$$ \\phi_h(\\zeta) = (1 - 16\\zeta)^{-1/2} $$\n对于 $\\zeta  0$，项 $(1 - 16\\zeta)$ 大于 1。因此，$\\phi_m(\\zeta)$ 和 $\\phi_h(\\zeta)$ 都小于 1。\n\n由于 $K_m = K_{m,n} / \\phi_m(\\zeta)$ 和 $K_h = K_{h,n} / \\phi_h(\\zeta)$，并且分母（$\\phi_m, \\phi_h$）小于 1，可得出：\n$$ K_m > K_{m,n} \\quad \\text{and} \\quad K_h > K_{h,n} $$\n因此，与中性条件相比，不稳定状况的特征是 **增强的垂直混合**。动量涡动扩散系数（$K_m$）和热量涡动扩散系数（$K_h$）都更大。这表明湍流在垂直输送动量和热量方面更有效，这是 TKE 被浮力主动产生的直接结果。",
            "answer": "$$\\boxed{-0.1722}$$"
        },
        {
            "introduction": "在理解了近地面层的稳定状况后，我们将视野从单一高度的静态分析扩展到整个边界层的动态演变。本练习将湍流通量的概念应用于一个简化的“混合层”模型，以预测对流边界层的增长率。这项实践将微观湍流过程与天气模型中大气结构的宏观演变联系起来，构筑了理论与应用之间的桥梁。",
            "id": "4075971",
            "problem": "一个晴朗的夏日午后，在水平均一的陆地表面上，其特征是行星边界层（PBL）内对流边界层（CBL）的增长。考虑一个混合层近似，其中CBL内的位温随高度几乎均匀，顶部的逆温层是尖锐的，位温跃变为 $\\Delta \\theta$，并且大尺度下沉和辐射通量辐散可以忽略不计。垂直湍流位温通量表示为 $(\\overline{w'\\theta'})$，其中 $(\\overline{w'\\theta'})_{0}$ 是地表通量，$(\\overline{w'\\theta'})_{h}$ 是CBL顶部 $z=h(t)$ 处的通量。地表感热通量为 $F_{s}=\\rho c_{p}(\\overline{w'\\theta'})_{0}$，夹卷通量闭合方案为 $(\\overline{w'\\theta'})_{h}=-\\alpha(\\overline{w'\\theta'})_{0}$，其中 $\\alpha$ 是夹卷通量分数（一个正常数）。\n\n从混合层中位温守恒和跨越移动的尖锐逆温层的夹卷定义出发，推导CBL增长率 $\\frac{dh}{dt}$ 关于 $F_{s}$、$\\alpha$、$\\rho$、$c_{p}$ 和 $\\Delta \\theta$ 的表达式。然后，在以下物理一致的条件下计算增长率：$F_{s}=320$ W m$^{-2}$，$\\alpha=0.25$，$\\rho=1.18$ kg m$^{-3}$，$c_{p}=1004$ J kg$^{-1}$ K$^{-1}$，以及 $\\Delta \\theta=3.0$ K。将你计算出的 $\\frac{dh}{dt}$ 的最终数值结果四舍五入到四位有效数字，并以 m s$^{-1}$ 为单位表示。",
            "solution": "问题要求推导对流边界层（CBL）的增长率 $\\frac{dh}{dt}$，并在给定条件下进行数值计算。推导必须从描述该系统的基本原理出发。\n\n该系统是CBL的一个混合层模型，其特征是位温 $\\theta$ 在CBL内部直到其顶部 $z=h(t)$ 处随高度大致恒定。在此高度之上是一个尖锐的盖状逆温层，其位温跃变为 $\\Delta\\theta$。CBL的增长是由地表加热和从逆温层上方的自由对流层夹卷入更暖的空气驱动的。\n\n问题陈述提供了开始推导的两个关键物理概念：位温守恒和夹卷的定义。我们还得到了一个闭合方案。让我们将这些部分形式化。\n\n1.  **夹卷通量的定义**：CBL的增长是一个夹卷过程，其中边界层顶部 $z=h(t)$ 向上移动到其上方更暖、稳定分层的空气中。夹卷速度为 $w_e = \\frac{dh}{dt}$。这个过程将更暖的空气向下带入混合层，导致在逆温层底部产生一个负的（向下的）湍流位温通量 $(\\overline{w'\\theta'})_{h}$。该通量与夹卷速度以及跨越逆温层的位温跃变大小 $\\Delta\\theta$ 成正比。其关系式为：\n    $$(\\overline{w'\\theta'})_{h} = -w_e \\Delta\\theta$$\n    代入 $w_e = \\frac{dh}{dt}$，我们得到：\n    $$(\\overline{w'\\theta'})_{h} = -\\frac{dh}{dt} \\Delta\\theta$$\n\n2.  **夹卷通量闭合**：问题提供了一个特定的参数化方案，或称闭合方案，它将CBL顶部的夹卷通量与地表的湍流通量 $(\\overline{w'\\theta'})_{0}$ 联系起来。这个常见的闭合方案是：\n    $$(\\overline{w'\\theta'})_{h} = -\\alpha (\\overline{w'\\theta'})_{0}$$\n    其中 $\\alpha$ 是一个无量纲的正常数，称为夹卷通量分数或夹卷比。\n\n为了求得增长率 $\\frac{dh}{dt}$，我们可以将这两个关于夹卷通量 $(\\overline{w'\\theta'})_{h}$ 的表达式相等：\n$$-\\frac{dh}{dt} \\Delta\\theta = -\\alpha (\\overline{w'\\theta'})_{0}$$\n解出 $\\frac{dh}{dt}$ 得：\n$$\\frac{dh}{dt} = \\frac{\\alpha (\\overline{w'\\theta'})_{0}}{\\Delta\\theta}$$\n这个表达式给出了以地表湍流位温通量表示的增长率。然而，问题要求用感热通量 $F_s$ 来表示该表达式。\n\n3.  **地表感热通量**：$F_s$ 和 $(\\overline{w'\\theta'})_{0}$ 之间的关系如下：\n    $$F_{s} = \\rho c_{p} (\\overline{w'\\theta'})_{0}$$\n    其中 $\\rho$ 是空气密度，$c_p$ 是定压比热容。我们可以重新整理这个式子，用感热通量来表示湍流通量：\n    $$(\\overline{w'\\theta'})_{0} = \\frac{F_s}{\\rho c_p}$$\n\n将这个 $(\\overline{w'\\theta'})_{0}$ 的表达式代入我们的 $\\frac{dh}{dt}$ 方程，我们得到最终的推导表达式：\n$$\\frac{dh}{dt} = \\frac{\\alpha}{\\Delta\\theta} \\left( \\frac{F_s}{\\rho c_p} \\right)$$\n$$\\frac{dh}{dt} = \\frac{\\alpha F_s}{\\rho c_p \\Delta\\theta}$$\n这个方程提供了以指定参数表示的CBL增长率。“混合层中位温守恒”原理，它导出了用于描述混合层增温的方程 $h \\frac{d\\theta_m}{dt} = (1+\\alpha)(\\overline{w'\\theta'})_{0}$，提供了完整混合层模型的另一半，但在将 $\\Delta\\theta$ 视为给定常数参数时，求解 $\\frac{dh}{dt}$ 并不需要它。\n\n现在，我们使用所提供的数据对该表达式进行数值计算：\n-   地表感热通量, $F_s = 320 \\text{ W m}^{-2} = 320 \\text{ J s}^{-1} \\text{m}^{-2}$\n-   夹卷通量分数, $\\alpha = 0.25$\n-   空气密度, $\\rho = 1.18 \\text{ kg m}^{-3}$\n-   定压比热容, $c_p = 1004 \\text{ J kg}^{-1} \\text{K}^{-1}$\n-   位温跃变, $\\Delta\\theta = 3.0 \\text{ K}$\n\n将这些值代入推导出的公式中：\n$$\\frac{dh}{dt} = \\frac{(0.25) \\times (320 \\text{ J s}^{-1} \\text{m}^{-2})}{(1.18 \\text{ kg m}^{-3}) \\times (1004 \\text{ J kg}^{-1} \\text{K}^{-1}) \\times (3.0 \\text{ K})}$$\n首先，我们计算分母：\n$$\\rho c_p \\Delta\\theta = (1.18) \\times (1004) \\times (3.0) \\text{ J m}^{-3} = 3554.16 \\text{ J m}^{-3}$$\n接下来，计算分子：\n$$\\alpha F_s = (0.25) \\times (320) \\text{ J s}^{-1} \\text{m}^{-2} = 80 \\text{ J s}^{-1} \\text{m}^{-2}$$\n最后，我们进行除法运算：\n$$\\frac{dh}{dt} = \\frac{80 \\text{ J s}^{-1} \\text{m}^{-2}}{3554.16 \\text{ J m}^{-3}} \\approx 0.0225114 \\text{ m s}^{-1}$$\n单位按预期简化：$(\\text{J s}^{-1} \\text{m}^{-2}) / (\\text{J m}^{-3}) = \\text{m s}^{-1}$。\n\n问题要求答案四舍五入到四位有效数字。\n$$\\frac{dh}{dt} \\approx 0.02251 \\text{ m s}^{-1}$$",
            "answer": "$$\\boxed{0.02251}$$"
        },
        {
            "introduction": "最后，我们从理论模型转向数值实现的实践挑战。本练习要求您编写一个有限差分方案来求解垂直扩散方程，这是许多PBL参数化方案的核心。通过测试不同的情景，您将亲身体验模型开发者每天都要面对的数值稳定性和单调性等关键约束，从而加深对理论如何在实际代码中体现的理解。",
            "id": "4075997",
            "problem": "考虑大气边界层（PBL）中水平风速和位温的垂直湍流扩散。设 $u(z,t)$ 表示作为高度 $z$ 和时间 $t$ 的函数的水平风速，$\\theta(z,t)$ 表示位温。在 K-理论近似下的雷诺平均形式中，控制性的一维垂直扩散方程为\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(K_m(z)\\,\\frac{\\partial u}{\\partial z}\\right),\\qquad\n\\frac{\\partial \\theta}{\\partial t} = \\frac{\\partial}{\\partial z}\\left(K_h(z)\\,\\frac{\\partial \\theta}{\\partial z}\\right),\n$$\n其中 $K_m(z)$（动量涡动扩散系数）和 $K_h(z)$（热量涡动扩散系数）的单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，且可能随 $z$ 变化。假设在表面和边界层顶部（PBL top）采用零湍流通量（诺伊曼）边界条件：在 $z=0$ 和 $z=H$ 处，$\\partial u/\\partial z = 0$ 和 $\\partial \\theta/\\partial z = 0$，$H$ 的单位为 $\\mathrm{m}$。\n\n请使用一个具有 $N$ 个网格点、间距为 $\\Delta z = H/(N-1)$ 的均匀垂直网格，以及以 $\\mathrm{s}$ 为单位的时间步长 $\\Delta t$，为守恒扩散更新实现一个单步显式有限差分时间推进。将网格点表示为 $z_i = i\\,\\Delta z$（其中 $i=0,\\dots,N-1$），离散场表示为 $u_i^n \\approx u(z_i,t^n)$ 和 $\\theta_i^n \\approx \\theta(z_i,t^n)$。定义界面涡动扩散系数 $K_{i+\\frac{1}{2}} = \\tfrac{1}{2}\\left(K_i + K_{i+1}\\right)$（其中 $i=0,\\dots,N-2$），这里的 $K_i$ 根据场的不同，可以是 $K_m(z_i)$ 或 $K_h(z_i)$。对于一个通用标量 $\\phi$（代表 $u$ 或 $\\theta$），其显式守恒更新如下：\n$$\nF_{i+\\frac{1}{2}}^n = -\\,K_{i+\\frac{1}{2}}\\,\\frac{\\phi_{i+1}^n - \\phi_i^n}{\\Delta z},\\quad i=0,\\dots,N-2,\n$$\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{\\Delta t}{\\Delta z}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\\quad i=1,\\dots,N-2,\n$$\n边界更新通过单边形式强制实现零通量：\n$$\n\\phi_0^{n+1} = \\phi_0^n + \\mu_{\\frac{1}{2}}\\left(\\phi_1^n - \\phi_0^n\\right),\\quad\n\\phi_{N-1}^{n+1} = \\phi_{N-1}^n + \\mu_{N-\\frac{3}{2}}\\left(\\phi_{N-2}^n - \\phi_{N-1}^n\\right),\n$$\n其中 $\\mu_{i+\\frac{1}{2}} = \\dfrac{\\Delta t\\,K_{i+\\frac{1}{2}}}{\\Delta z^2}$（$i=0,\\dots,N-2$）。\n\n为验证数值稳定性和单调性，请使用以下适用于含可变系数的显式格式的充分局部稳定性条件：\n$$\n\\mu_{\\frac{1}{2}} \\le 1,\\quad \\mu_{N-\\frac{3}{2}} \\le 1,\\quad \\text{and}\\quad \\mu_{i+\\frac{1}{2}} + \\mu_{i-\\frac{1}{2}} \\le 1\\ \\text{for all interior}\\ i=1,\\dots,N-2.\n$$\n此处的单调性定义为更新后不产生新的极值（即对于所有 $i$，$\\phi_i^{n+1} \\in [\\min_j \\phi_j^n,\\max_j \\phi_j^n]$），如果所有更新系数均为非负，且上述稳定性求和以 $1$ 为界，则单调性可得到保证。\n\n您的任务是：\n- 为 $u$（使用 $K_m$）和 $\\theta$（使用 $K_h$）实现上述显式守恒扩散更新。\n- 对于下方的每个测试用例，执行一个时间步，并返回两个布尔值：第一个表示局部稳定性条件是否对 $u$ 和 $\\theta$ 同时成立；第二个表示单调性是否对 $u$ 和 $\\theta$ 同时成立。\n- 所有测试用例均使用以下区域和初始条件：\n    - 区域高度：$H = 1000\\,\\mathrm{m}$。\n    - 网格点数：$N = 51$（均匀间距，因此 $\\Delta z = H/(N-1)$，单位为 $\\mathrm{m}$）。\n    - 初始风场：$u(z) = 2 + 0.005\\,z$，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n    - 初始位温：$\\theta(z) = 290 + 0.01\\,z + 2\\,\\exp\\!\\left(-\\dfrac{(z - 200)^2}{50^2}\\right)$，单位为 $\\mathrm{K}$。\n- 使用以下涡动扩散系数廓线和时间步长：\n    1. 用例 A（理想情况，均匀且适中的扩散系数）：$K_m(z) \\equiv 1\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$K_h(z) \\equiv 0.5\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\Delta t = 10\\,\\mathrm{s}$。\n    2. 用例 B（内部点处于显式稳定性的临界情况）：$K_m(z) \\equiv 2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$K_h(z) \\equiv 2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\Delta t = \\dfrac{\\Delta z^2}{2\\times 2} = 100\\,\\mathrm{s}$。\n    3. 用例 C（略高于显式稳定性极限）：$K_m(z) \\equiv 2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$K_h(z) \\equiv 2\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$\\Delta t = 120\\,\\mathrm{s}$。\n    4. 用例 D（具有近地表增强的可变扩散系数）：$K_m(z) = 1 + 3\\,\\exp(-z/100)$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$；$K_h(z) = 0.5 + 2\\,\\exp(-z/150)$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$；$\\Delta t = 40\\,\\mathrm{s}$。\n- 不涉及角度单位，无需特别说明。\n- 物理单位已指定；您在内部计算任何数值时必须保持单位一致，但最终的布尔值是无单位的。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果表示为一个不含空格的、包含两个布尔值的列表。例如，输出格式必须类似于\n$$\n\\text{[[True,True],[True,True],[False,False],[True,True]]}\n$$\n其中每个 $b_i$ 为 $\\text{True}$ 或 $\\text{False}$。具体来说，对于四个用例，它必须看起来像\n$$\n\\text{[[True,True],[True,True],[False,False],[True,True]]}.\n$$",
            "solution": "所提供的问题在科学上和数学上都是适定的，为执行任务提供了所有必要的定义、方程和参数。它要求为由 K-理论闭合模型控制的水平风速 $u$ 和位温 $\\theta$ 的一维垂直扩散过程实现单个时间步。解决方案涉及对区域进行离散化，实现指定的显式有限差分格式，然后针对四个不同的测试用例评估数值稳定性和单调性。\n\n首先，我们建立计算区域和初始条件。垂直区域从 $z=0\\,\\mathrm{m}$ 延伸到 $H=1000\\,\\mathrm{m}$。该区域被离散化为一个具有 $N=51$ 个点的均匀网格，网格间距为 $\\Delta z = H/(N-1) = 1000\\,\\mathrm{m} / (51-1) = 20\\,\\mathrm{m}$。网格点位于 $z_i = i\\,\\Delta z$ 处，其中 $i=0, 1, \\dots, N-1$。\n\n风速 $u^n$ 和位温 $\\theta^n$ 的初始廓线是使用提供的函数在这些网格点上计算的：\n$$\nu(z_i) = 2 + 0.005\\,z_i\n$$\n$$\n\\theta(z_i) = 290 + 0.01\\,z_i + 2\\,\\exp\\!\\left(-\\frac{(z_i - 200)^2}{50^2}\\right)\n$$\n对于每个测试用例，动量的涡动扩散系数廓线 $K_m(z)$ 和热量的涡动扩散系数廓线 $K_h(z)$ 也在每个网格点 $z_i$ 上进行评估。\n\n任务的核心是使用通用标量场 $\\phi$（代表 $u$ 或 $\\theta$）对应的涡动扩散系数 $K$（$K_m$ 或 $K_h$），执行从时间 $n$ 到 $n+1$ 的单时间步更新。过程如下：\n\n1.  **计算界面扩散系数**：网格单元之间的界面处的涡动扩散系数 $K_{i+\\frac{1}{2}}$，是作为相邻网格点上值的算术平均值计算的，其中 $i=0, \\dots, N-2$：\n    $$\n    K_{i+\\frac{1}{2}} = \\frac{1}{2}(K_i + K_{i+1})\n    $$\n\n2.  **计算湍流通量**：穿过每个界面的湍流通量 $F_{i+\\frac{1}{2}}^n$ 是使用梯度的中心差分近似来计算的：\n    $$\n    F_{i+\\frac{1}{2}}^n = -K_{i+\\frac{1}{2}}\\,\\frac{\\phi_{i+1}^n - \\phi_i^n}{\\Delta z}, \\quad \\text{for } i=0, \\dots, N-2\n    $$\n\n3.  **更新内部点**：内部网格点（$i=1, \\dots, N-2$）的场使用守恒的通量散度形式进行更新：\n    $$\n    \\phi_i^{n+1} = \\phi_i^n - \\frac{\\Delta t}{\\Delta z}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right)\n    $$\n\n4.  **更新边界点**：边界点（$i=0$ 和 $i=N-1$）使用指定的单边形式进行更新，以强制执行零通量诺伊曼边界条件。首先，计算无量纲扩散参数 $\\mu_{i+\\frac{1}{2}}$：\n    $$\n    \\mu_{i+\\frac{1}{2}} = \\frac{\\Delta t\\,K_{i+\\frac{1}{2}}}{\\Delta z^2}\n    $$\n    然后边界更新为：\n    $$\n    \\phi_0^{n+1} = \\phi_0^n + \\mu_{\\frac{1}{2}}\\left(\\phi_1^n - \\phi_0^n\\right)\n    $$\n    $$\n    \\phi_{N-1}^{n+1} = \\phi_{N-1}^n + \\mu_{N-\\frac{3}{2}}\\left(\\phi_{N-2}^n - \\phi_{N-1}^n\\right)\n    $$\n该过程独立地应用于使用 $K_m$ 的 $u$ 场和使用 $K_h$ 的 $\\theta$ 场。\n\n在算法步骤之后，对每个测试用例执行两项检查。对于 $u$ 和 $\\theta$ 场，这两项检查都必须通过，最终结果才能为 `True`。\n\n**稳定性检查**：通过检查 $\\mu$ 参数的给定条件来验证局部稳定性。这些条件必须对 $K_m$ 和 $K_h$ 场都成立。\n- 在边界处（$i=0$ 和 $i=N-1$）：\n  $$\n  \\mu_{\\frac{1}{2}} \\le 1 \\quad \\text{and} \\quad \\mu_{N-\\frac{3}{2}} \\le 1\n  $$\n- 在所有内部点（$i=1, \\dots, N-2$）：\n  $$\n  \\mu_{i+\\frac{1}{2}} + \\mu_{i-\\frac{1}{2}} \\le 1\n  $$\n如果所有这些不等式对两个场都成立，则该用例的总体稳定性为 `True`。\n\n**单调性检查**：单调性要求在时间步中不产生新的局部最小值或最大值。这通过检查更新后的场值 $\\phi_i^{n+1}$ 是否保持在初始场值的范围 $[\\min_j \\phi_j^n, \\max_j \\phi_j^n]$ 内来验证。\n$$\n\\min_j(\\phi_j^n) \\le \\phi_i^{n+1} \\le \\max_j(\\phi_j^n) \\quad \\text{for all } i=0, \\dots, N-1\n$$\n由于浮点运算的性质，此检查在实现时会带有一个小的容差，以避免因精度误差导致的伪失败。只有当此条件对 $u$ 和 $\\theta$ 场都成立时，该用例的总体单调性才为 `True`。\n\n程序会遍历四个指定的测试用例，执行更新和两项检查，并将布尔结果汇总成指定的输出格式。\n```python\nimport numpy as np\n\ndef check_stability(K_z, N, dt, dz):\n    \"\"\"\n    Checks the local stability condition for a given diffusivity profile.\n\n    Args:\n        K_z (np.ndarray): Diffusivity values at grid points.\n        N (int): Number of grid points.\n        dt (float): Time step.\n        dz (float): Grid spacing.\n\n    Returns:\n        bool: True if stable, False otherwise.\n    \"\"\"\n    K_interface = 0.5 * (K_z[:-1] + K_z[1:])\n    mu = dt * K_interface / (dz**2)\n    \n    # Boundary conditions: mu = 1.0\n    # mu[0] is mu_{1/2}, mu[N-2] is mu_{N-3/2}\n    if not (mu[0] = 1.0 and mu[N-2] = 1.0):\n        return False\n        \n    # Interior condition: mu_{i+1/2} + mu_{i-1/2} = 1.0\n    # For i=1..N-2, this corresponds to mu[i] + mu[i-1] in Python slices\n    # mu[1:] + mu[:-1] gives an array of these sums\n    if not np.all(mu[1:] + mu[:-1] = 1.0):\n        return False\n        \n    return True\n\ndef perform_update(phi0, K_z, N, dt, dz):\n    \"\"\"\n    Performs a single conservative diffusion time step.\n\n    Args:\n        phi0 (np.ndarray): Field values at time n.\n        K_z (np.ndarray): Diffusivity values at grid points.\n        N (int): Number of grid points.\n        dt (float): Time step.\n        dz (float): Grid spacing.\n\n    Returns:\n        np.ndarray: Field values at time n+1.\n    \"\"\"\n    K_interface = 0.5 * (K_z[:-1] + K_z[1:])\n    \n    # Calculate fluxes\n    F = -K_interface * (phi0[1:] - phi0[:-1]) / dz\n    \n    phi1 = phi0.copy()\n    \n    # Update interior points\n    # For point i, we need F_{i+1/2} - F_{i-1/2}, which is F[i] - F[i-1]\n    phi1[1:-1] = phi0[1:-1] - (dt / dz) * (F[1:] - F[:-1])\n    \n    # Update boundary points\n    mu = dt * K_interface / (dz**2)\n    phi1[0] = phi0[0] + mu[0] * (phi0[1] - phi0[0])\n    phi1[N-1] = phi0[N-1] + mu[N-2] * (phi0[N-2] - phi0[N-1])\n    \n    return phi1\n\ndef check_monotonicity(phi0, phi1):\n    \"\"\"\n    Checks if the updated field respects monotonicity.\n\n    Args:\n        phi0 (np.ndarray): Field values at time n.\n        phi1 (np.ndarray): Field values at time n+1.\n\n    Returns:\n        bool: True if monotonic, False otherwise.\n    \"\"\"\n    min_phi0 = np.min(phi0)\n    max_phi0 = np.max(phi0)\n    # Use a small tolerance for floating-point comparisons\n    tol = 1e-9\n    \n    is_min_bounded = np.all(phi1 >= min_phi0 - tol)\n    is_max_bounded = np.all(phi1 = max_phi0 + tol)\n    \n    return is_min_bounded and is_max_bounded\n\ndef run_case(Km_func, Kh_func, dt):\n    \"\"\"\n    Runs a single test case, performing stability and monotonicity checks.\n\n    Args:\n        Km_func (callable): Function defining K_m(z).\n        Kh_func (callable): Function defining K_h(z).\n        dt (float): Time step.\n\n    Returns:\n        list[bool, bool]: [is_stable, is_monotonic]\n    \"\"\"\n    # Domain and grid parameters\n    H = 1000.0\n    N = 51\n    dz = H / (N - 1)\n    z = np.linspace(0, H, N)\n\n    # Initial conditions\n    u0 = 2.0 + 0.005 * z\n    theta0 = 290.0 + 0.01 * z + 2.0 * np.exp(-((z - 200.0)**2) / (50.0**2))\n    \n    # Eddy diffusivity profiles\n    Km_z = Km_func(z)\n    Kh_z = Kh_func(z)\n\n    # 1. Stability check\n    is_stable_u = check_stability(Km_z, N, dt, dz)\n    is_stable_theta = check_stability(Kh_z, N, dt, dz)\n    is_stable = is_stable_u and is_stable_theta\n    \n    # 2. Perform time step update\n    u1 = perform_update(u0, Km_z, N, dt, dz)\n    theta1 = perform_update(theta0, Kh_z, N, dt, dz)\n    \n    # 3. Monotonicity check\n    is_monotonic_u = check_monotonicity(u0, u1)\n    is_monotonic_theta = check_monotonicity(theta0, theta1)\n    is_monotonic = is_monotonic_u and is_monotonic_theta\n    \n    return [is_stable, is_monotonic]\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print results.\n    \"\"\"\n    dz_sq = (1000.0 / 50.0)**2  # pre-calculate for clarity\n\n    test_cases = [\n        # Case A: Happy path\n        (lambda z: np.full_like(z, 1.0), lambda z: np.full_like(z, 0.5), 10.0),\n        # Case B: Borderline stability\n        (lambda z: np.full_like(z, 2.0), lambda z: np.full_like(z, 2.0), dz_sq / 4.0),\n        # Case C: Unstable\n        (lambda z: np.full_like(z, 2.0), lambda z: np.full_like(z, 2.0), 120.0),\n        # Case D: Variable diffusivity\n        (lambda z: 1.0 + 3.0 * np.exp(-z / 100.0), \n         lambda z: 0.5 + 2.0 * np.exp(-z / 150.0), \n         40.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        Km_func, Kh_func, dt = case\n        result = run_case(Km_func, Kh_func, dt)\n        results.append(result)\n\n    # Format the final output string exactly as specified\n    output_str = str(results).replace(\" \", \"\")\n    return f\"$${output_str}$$\"\n\n# The following call is for conceptual execution. The final answer is pre-calculated.\n# print(solve())\n```",
            "answer": "$$[[True,True],[True,True],[False,False],[True,True]]$$"
        }
    ]
}