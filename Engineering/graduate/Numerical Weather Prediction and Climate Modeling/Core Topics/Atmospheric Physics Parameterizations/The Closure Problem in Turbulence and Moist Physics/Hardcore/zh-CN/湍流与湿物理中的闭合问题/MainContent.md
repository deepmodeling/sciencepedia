## 引言
在[数值天气预报](@entry_id:191656)和气候建模领域，一个核心且持久的挑战是如何准确地在模型中表示那些尺度过小而无法被计算网格直接解析的物理过程。这些“次网格”过程，尤其是湍流混合与复杂的湿物理（如云的形成和降水），对大尺度天气系统和气候的演变具有决定性的影响。为了弥合模型可解析尺度与这些微观过程之间的鸿沟，科学家们必须发展出能够表达次网格过程对宏观流动净效应的数学表达式，这一过程被称为“[参数化](@entry_id:265163)”，而其背后的根本难题即为“[湍流](@entry_id:151300)与湿物理中的闭合问题”。

本文旨在系统地剖析这一关键问题。我们将从最基本的物理原理出发，逐步深入到复杂的应用场景。在“原理与机制”一章中，我们将揭示闭合问题的数学起源，探讨处理可压缩流动的法弗平均法，并梳理从简单到复杂的各类闭合方案的内在逻辑，如经典的K理论、更高级的湍动能闭合以及专门针对对流的质量通量方案。随后，在“应用与跨学科联系”一章中，我们会将这些理论应用于大气边界层、[湿对流](@entry_id:1128092)和云微物理等真实大气现象中，展示闭合思想如何解决实际问题，并探索其在[海洋学](@entry_id:149256)、工程学等其他学科中的类比与联系。最后，通过“动手实践”部分的引导，读者将有机会将理论知识应用于具体的计算问题，加深对核心概念的理解。通过这一结构化的学习路径，本文将为您构建一个关于闭合问题的全面而深入的知识框架。

## 原理与机制

在数值天气预报和气候模型中，控制方程描述了流体运动的宏观物理定律。然而，这些模型的分辨率有限，无法显式解析大气中所有尺度的运动，特别是小尺度的[湍流](@entry_id:151300)和湿物理过程。因此，必须将这些未解析的“次网格”过程对已解析的“网格”尺度流动的影响进行[参数化](@entry_id:265163)。这个过程被称为“闭合”，而由此产生的根本挑战即为“[湍流](@entry_id:151300)与湿物理中的闭合问题”。本章将深入探讨[湍流](@entry_id:151300)闭合的基本原理、关键机制以及在不同物理近似下的具体形式。

### 闭合问题的起源：平均化控制方程

闭合问题的根源在于我们需要从瞬时、全尺度的流体[运动方程](@entry_id:264286)中推导出描述模型可解析尺度运动的方程。这通过对控制方程应用一个滤波或[平均算子](@entry_id:746605)来实现，该算子将流场分离为已解析（或平均）部分和未解析（或脉动）部分。

对于[湍流](@entry_id:151300)研究，经典的雷诺平均（Reynolds averaging）通常采用[时间平均](@entry_id:267915)，这隐含了平均流场是统计平稳的假设。然而，在许多大气应用中，例如中尺度[气象学](@entry_id:264031)，流场本身是瞬态的，天气系统在数小时内演变和传播。在这种情况下，对一个足够长的、能够平滑[湍流](@entry_id:151300)脉动的时间窗口进行时间平均，会不可避免地模糊掉模型旨在预测的已解析尺度的演变特征。例如，在一个水平网格间距为 $\Delta = 10 \text{ km}$、平均风速为 $U = 10 \text{ m/s}$ 的中尺度模型中，平流特征时间尺度为 $T_a = \Delta/U = 1000 \text{ s}$。任何显著长于此的[时间平均](@entry_id:267915)都将“拖尾”已解析的特征 。因此，在这些[非定常流](@entry_id:269993)模拟中，更合适的做法是采用空间滤波，如[大涡模拟](@entry_id:153702)（Large Eddy Simulation, LES）中所做的那样。[空间滤波](@entry_id:202429)算子 $\overline{(\cdot)}$ 将瞬时场 $\psi$ 分解为已解析（或滤波）场 $\overline{\psi}$ 和次网格脉动场 $\psi'$。

为了使滤波后的方程保持良好特性，空间滤波核（例如，通过卷积定义）必须满足某些基本属性，例如归一化（以保持常数不变）和与空间导数的可交换性 。然而，至关重要的是，滤波算子通常与[非线性](@entry_id:637147)项（如平流项）不可交换，即 $\overline{\phi \chi} \neq \overline{\phi}\overline{\chi}$。正是这种不[可交换性](@entry_id:909050)产生了包含脉动量相关性的新项，例如[雷诺应力张量](@entry_id:270803)，这些项是未知的，必须通过“闭合”假设来对其进行建模。

在可压缩的大气流中，尤其是在包含湿物理过程时，情况变得更加复杂。控制方程（如质量和[动量守恒](@entry_id:149964)）的平流项通常以 $\rho \mathbf{u}$ 和 $\rho \mathbf{u} \phi$ 的形式出现，其中 $\rho$ 是密度，$\mathbf{u}$ 是速度，$\phi$ 是一个标量。如果对密度和速度都使用标准的[雷诺分解](@entry_id:267756)（$\rho = \overline{\rho} + \rho'$，$\mathbf{u} = \overline{\mathbf{u}} + \mathbf{u}'$），滤波后的平流项会变得非常复杂，例如 $\overline{\rho \mathbf{u}} = \overline{\rho}\overline{\mathbf{u}} + \overline{\rho' \mathbf{u}'}$。为了简化这些项，我们引入**密度加权平均**，也称为**法弗平均**（Favre averaging）。

对于任意变量 $\phi$，其法弗平均 $\tilde{\phi}$ 定义为：
$$
\tilde{\phi} \equiv \frac{\overline{\rho \phi}}{\overline{\rho}}
$$
[瞬时速度](@entry_id:167797) $u_i$ 因此被分解为法弗[平均速度](@entry_id:267649) $\tilde{u}_i$ 和法弗脉动 $u_i''$：
$$
u_i = \tilde{u}_i + u_i''
$$
这个定义的优美之处在于，根据定义，滤波后的质量通量 $\overline{\rho u_i}$ 可以简洁地写作 $\overline{\rho} \tilde{u}_i$。此外，法弗脉动的定义属性是其密度加权平均为零，即 $\overline{\rho u_i''} = 0$，这是通过其定义直接推导出来的。需要强调的是，法弗脉动的常规雷诺平均通常不为零（$\overline{u_i''} \neq 0$）。对于密度本身，我们仍然使用标准的[雷诺分解](@entry_id:267756)：$\rho = \overline{\rho} + \rho'$，其脉动满足 $\overline{\rho'} = 0$。这种组合分解（对密度使用雷诺平均，对速度和其它输送的标量使用法弗平均）是处理可压缩[湍流](@entry_id:151300)闭合问题的标准做法 。

### 动力学近似的层次结构及其对[闭合形式](@entry_id:271343)的影响

[湍流](@entry_id:151300)闭合的形式在很大程度上取决于模型所采用的基础动力学近似。不同的近似通过过滤某些类型的运动（如声波）并简化密度和压力的处理方式来改变控制方程的结构。让我们从最通用到最简化的层次结构来考察这一点 。

*   **完全可压缩系统 (Fully Compressible System)**：这是最普适的框架，保留了完整的[质量守恒](@entry_id:204015)方程 $\partial_t \rho + \nabla \cdot (\rho \mathbf{u}) = 0$。该系统支持声波的传播。如前所述，由于密度 $\rho$ 是一个完全的预报变量，[湍流](@entry_id:151300)闭合必须采用**法弗平均**来一致地处理密度变化，以避免在平均方程中出现大量难以处理的密度-速度相关项。闭合模型的目标是[参数化](@entry_id:265163)法弗平均框架下的次网格通量，如 $\overline{\rho u_i'' u_j''}$ 和 $\overline{\rho u_i'' \phi''}$。

*   **滞弹性近似 (Anelastic Approximation)**：此近似专为[深对流](@entry_id:1123472)等[低马赫数](@entry_id:1127478)但密度随高度显著变化的流动而设计。它通过在[连续性方程](@entry_id:195013)中忽略密度的局地时间变化来过滤声波，得到的约束条件为 $\nabla \cdot (\rho_0 \mathbf{u}) = 0$，其中 $\rho_0(z)$ 是随高度变化的[静力平衡](@entry_id:163498)参考密度剖面。虽然声波被滤除，但密度分层对[浮力](@entry_id:154088)的影响被保留。在[动量方程](@entry_id:197225)中，惯性项通常用参考密度 $\rho_0$ 近似。由于参考密度 $\rho_0(z)$ 依然是变量，[湍流](@entry_id:151300)闭合通常采用一种简化的质量加权形式，[参数化](@entry_id:265163)的目标是形如 $\overline{\rho_0 u_i' \phi'}$ 的通量。

*   **布辛涅斯克近似 (Boussinesq Approximation)**：这是更严格的近似，适用于垂直运动尺度远小于密度[标高](@entry_id:263754)的大气浅层。该近似假设密度变化很小，以至于可以在所有项中都被视为常数 $\rho_0$，除了在重力项中，密度的微小变化（$\rho' = \rho - \rho_0$）提供了[浮力](@entry_id:154088)。连续性方程简化为 $\nabla \cdot \mathbf{u} = 0$，即不可压缩条件，同样过滤了声波。由于密度在惯性项和通量项中被视为常数，我们不再需要法弗平均。闭合问题回归到标准的**雷诺平均**框架，[参数化](@entry_id:265163)的目标是[雷诺应力](@entry_id:263788) $\overline{u_i' u_j'}$ 和[标量通量](@entry_id:1131249) $\overline{u_i' \phi'}$。

### 一阶闭合：通量-梯度假说（[K理论](@entry_id:160831)）

最简单、最经典的闭合方法是一阶闭合，也称为**K理论**或**涡动扩散**（eddy-diffusivity）方法。其核心思想，即**通量-梯度假说**，是假设[湍流通量](@entry_id:1133513)总是沿着平均量的梯度方向“向下”输送，类似于[分子扩散](@entry_id:154595)。对于一个标量 $\phi$，其垂直湍流通量 $\overline{w' \phi'}$ 被建模为：
$$
\overline{w' \phi'} = -K_\phi \frac{\partial \overline{\phi}}{\partial z}
$$
其中 $K_\phi$ 是[涡动扩散系数](@entry_id:196515)，它本身必须通过其它方式[参数化](@entry_id:265163)，例如依赖于湍流强度和混合长。

这一理论在近地表的稳定或中性层结中非常成功，并构成了**[莫宁-奥布霍夫相似性理论](@entry_id:1128126)**（Monin-Obukhov Similarity Theory, MOST）的基础 。在考虑湿度的近地层中，[浮力](@entry_id:154088)由[虚位温](@entry_id:1133825)通量 $\overline{w' \theta_v'}$ 决定。MOST理论引入了一个关键的长度尺度，即**[莫宁-奥布霍夫长度](@entry_id:1128125)** $L$：
$$
L = - \frac{u_*^3 \bar{\theta_v}}{\kappa g \overline{w' \theta_v'}}
$$
其中 $u_*$ 是摩擦速度（动量通量的量度），$\kappa$ 是[冯·卡门常数](@entry_id:261117)，$g$ 是重力加速度。$|L|$ 的物理意义是剪切产生的[湍动能](@entry_id:262712)（TKE）与[浮力](@entry_id:154088)产生（或消耗）的TKE大致相等的那个高度。[无量纲参数](@entry_id:169335) $z/L$ 描述了稳定度：当 $L  0$ 时（对应 $\overline{w' \theta_v'} > 0$），大气不稳定；当 $L > 0$ 时（对应 $\overline{w' \theta_v'}  0$），大气稳定；当 $|L| \to \infty$ 时，为中性层结。MOST理论指出，无量纲的风切变和温、湿梯度是 $z/L$ 的普适函数。

然而，K理论有一个根本性的局限性：它是**局地**的。通量的大小完全由同一点的局地梯度决定。在某些重要的大气现象中，这个假设是错误的。最典型的例子是对流边界层 。在一个充分发展的、由地面加热驱动的混合层中，观测和模拟都显示出强烈的向上热量和[水汽输送](@entry_id:1128087)。然而，由于强烈的[湍流混合](@entry_id:202591)，位温和比湿的垂直廓线几乎是均匀的，即 $\partial \overline{\phi} / \partial z \approx 0$。在这种情况下，K理论会错误地预测湍流通量为零。这种“逆梯度输送”或“零梯度输送”是由从边界层底部一直延伸到顶部的相干热泡或上升气流结构造成的，它们是非局地输送的体现。

### 超越局地梯度：高阶与非局地闭合

为了克服[K理论](@entry_id:160831)的局限性，需要更复杂的闭合方案。

#### [湍动能](@entry_id:262712)（TKE）闭合

向更高阶闭合迈出的第一步是引入一个关于湍流强度本身的[预报方程](@entry_id:1130221)。最常见的是**湍动能**（TKE, $e = \frac{1}{2}\overline{u_i' u_i'}$）闭合，这被称为1.5阶闭合。在这种方案中，[涡动扩散系数](@entry_id:196515) $K$ 不再是简单指定的，而是被[参数化](@entry_id:265163)为TKE和一个[特征长度尺度](@entry_id:266383) $l_{mix}$ 的函数，例如 $K \propto l_{mix} \sqrt{e}$。TKE本身则通过求解其收支方程来预报。在一个潮湿的滞弹性框架下，单位体积的TKE（$\rho_0 e$）的收支方程可以写为 ：
$$
\frac{\partial(\rho_0 e)}{\partial t} + \frac{\partial(\rho_0 \bar{u}_j e)}{\partial x_j} = -\rho_0\overline{u_i' u_j'}\frac{\partial \bar{u}_i}{\partial x_j} + \rho_0 g \frac{\overline{w'\theta_v'}}{\bar{\theta_v}} - \frac{\partial}{\partial x_j}\left( \rho_0\overline{e'u_j'} + \overline{p'u_j'} \right) - \rho_0\epsilon
$$
该方程的右侧各项分别为：
1.  **剪切产生项** ($P_S$): [雷诺应力](@entry_id:263788)对平均流剪切做功，将平均动能转化为[湍动能](@entry_id:262712)。
2.  **[浮力](@entry_id:154088)产生/消耗项** ($P_B$): [湍流](@entry_id:151300)浮力通量做功。在不稳定层结中（$\overline{w'\theta_v'} > 0$），它是TKE的源；在稳定层结中，它是汇。注意，在湿空气中，必须使用[虚位温](@entry_id:1133825)通量来正确计算总[浮力](@entry_id:154088)。
3.  **输运项** ($T$): 由[湍流](@entry_id:151300)自身（三次矩）、压力脉动等引起的TKE空间再分配。
4.  **耗散项** ($\epsilon$): [湍动能](@entry_id:262712)通过分子粘性转化为内能的过程，它总是一个汇。

通过求解这个方程，模型可以更真实地预测[湍流](@entry_id:151300)的生消和时空演变。

#### 质量通量方案

为了直接解决对流边界层中的非局地输送问题，**质量通量**（mass-flux）方案被提出。这种方法从一个完全不同的视角出发，它不再将[湍流](@entry_id:151300)视为无序的涡动，而是将其概念化为有组织的上升气流（updrafts）和下沉气流（downdrafts）以及相对静止的环境（environment）的集合 。总的垂[直通](@entry_id:1131585)量 $\overline{w'\phi'}$ 不再与局地梯度关联，而是通过对这些相干结构的贡献进行加权平均来计算：
$$
\overline{w'\phi'} \approx a_u w_u (\phi_u - \overline{\phi}) + a_d w_d (\phi_d - \overline{\phi})
$$
其中 $a$ 是面积分数，$w$ 和 $\phi$ 分别是垂直速度和标量值，下标 $u$ 和 $d$ 分别代表上升和下沉气流。这些上升/下沉气流的性质（如速度、温度、湿度）通过一个“[羽流模型](@entry_id:1129836)”来描述，该模型考虑了它们与环境空气之间的夹卷（entrainment）和出卷（detrainment）。这种方法能够自然地产生逆梯度输送，因为即使在平均梯度为零的混合层中，只要从边界层底部升起的羽流（$\phi_u$）比环境（$\overline{\phi}$）更暖或更湿，就能产生正的向上通量。

#### [湿对流](@entry_id:1128092)的[能量约束](@entry_id:1124454)：[湿静力能](@entry_id:1128097)

在深对流[参数化](@entry_id:265163)中，质量通量方案的整体强度（例如，总的对流质量通量 $M_c$）需要一个闭合假设来确定。一个强大的物理约束来自于大尺度能量守恒。在没有降水落下的绝热湿过程中，**湿静力能**（Moist Static Energy, MSE）是一个[守恒量](@entry_id:161475) 。其定义为：
$$
h = c_p T + gz + L_v q_v
$$
其中 $c_p T$ 是焓，$gz$ 是位能，$L_v q_v$ 是潜热能。其守恒性可以通过热力学第一定律和[静力平衡](@entry_id:163498)关系推导得出。在一个大气柱中，地表通量和辐射冷却会改变整层的MSE。在**[准平衡](@entry_id:1130431)**（Quasi-Equilibrium, QE）闭合假设下，认为对流会非常高效地响应这些大尺度强迫，并调整其强度，使得对流引起的MSE垂直输送（即稳定化效应）恰好平衡由地表和辐射引起的不稳定化趋势。因此，可以通过诊断大尺度强迫来确定所需的对流质量通量，从而闭合整个[参数化](@entry_id:265163)方案。

### 湿物理过程的闭合：相变

除了[湍流](@entry_id:151300)输送，水相变化（凝结、蒸发）本身也发生在[次网格尺度](@entry_id:1132591)，需要[参数化](@entry_id:265163)。这里主要有两种策略 。

*   **[饱和度调整](@entry_id:1131227) (Saturation Adjustment)**：这是一种**[平衡态](@entry_id:270364)**闭合。它假设相变过程无限快，使得大气在任何时候都不会维持相对于水（或冰）的超饱和状态。在一个模型时间步内，如果一个网格单元的预报状态变为超饱和（$q_v > q_{sat}(T, p)$），该方案会“立即”将多余的水汽凝结成云水，直到水汽含量恰好等于该网格新的（因潜热释放而变暖的）温度下的饱和[比湿](@entry_id:1132076) $q_{sat}(T_{final}, p)$。在此过程中，总水物质（$q_t = q_v + q_c$）和湿焓（在[等压过程](@entry_id:140349)中，近似于[湿静力能](@entry_id:1128097)）是守恒的。这个过程需要求解一个关于最终温度和湿度的[非线性方程组](@entry_id:178110)。

*   **预报超饱和度 (Prognostic Supersaturation)**：这是一种更物理的**非[平衡态](@entry_id:270364)**方法。它承认凝结和蒸发需要有限的时间，并且超饱和是云滴增长的必要条件。在这种方案中，超饱和度 $S = q_v/q_{sat} - 1$ 可以是瞬时非零的。模型会包含一个明确的凝结/蒸发速率方程，该速率通常与超饱和度成正比，例如 $dq_c/dt \propto S$。[弛豫时间尺度](@entry_id:1130826)则由微物理过程决定。这种方法允许模型更真实地模拟云的形成和演变过程。

### 高级主题与现代挑战

#### [可实现性约束](@entry_id:1130703)

一个设计良好的闭合方案必须是**可实现的**（realizable），即它不能产生物理上不可能的结果 。例如，湍动能、[标量方差](@entry_id:1131255)等二阶矩必须是非负的。[雷诺应力张量](@entry_id:270803) $\overline{u_i' u_j'}$ 必须是半正定的（即，在任何方向上的法向应力都不能为负）。这些统计学上的约束对闭合模型中的系数施加了数学限制。例如，对于一个线性[涡粘性模型](@entry_id:1124145)，为了保证[雷诺应力张量](@entry_id:270803)的[可实现性](@entry_id:193701)，涡粘性系数 $\nu_t$ 必须满足一个与平均[应变率](@entry_id:154778)和TKE相关的上界。同样，对于多标量的涡扩散，扩散[系数矩阵](@entry_id:151473) $K$ 必须是半正定的，这不仅要求对角元素（自身扩散）非负，还对非对角元素（[交叉扩散](@entry_id:1123226)）的大小施加了约束（例如，$|K_{\theta q}| \le \sqrt{K_{\theta\theta} K_{qq}}$），这与[热力学](@entry_id:172368)第二定律的要求也是一致的。

#### “灰色地带”与尺度感知闭合

传统上，[参数化](@entry_id:265163)方案被设计用于两种极端情况：要么过程完全是次网格的（粗分辨率），要么过程完全被解析（高分辨率）。然而，随着模型分辨率的提高，我们进入了一个“灰色地带”，其中网格尺度 $\Delta$ 与[湍流](@entry_id:151300)或对流的主导能量尺度 $L_c$ 相当（$\Delta \sim L_c$）。在这种情况下，传统[参数化](@entry_id:265163)方案会失效，因为它们会“双重计算”：模型动力学部分解析了对流或大涡，而[参数化](@entry_id:265163)方案又试图对整个过程进行[参数化](@entry_id:265163)。

为了解决这个问题，现代闭合方案正在朝着**尺度感知**（scale-aware）的方向发展。一个尺度感知的[参数化](@entry_id:265163)方案必须能够：
1.  在分辨率变得非常高（$\Delta \to 0$）时，其贡献平滑地趋于零。
2.  在分辨率非常粗（$\Delta \to \infty$）时，其贡献恢复到传统的、全强度的[参数化](@entry_id:265163)。
3.  在灰色地带，其贡献仅代表流动的*未解析*部分。

实现这一点的一种方法是引入一个依赖于分辨率的混合函数。例如，一个对流质量通量[参数化](@entry_id:265163)可以乘以一个系数 $[1 - f_r(\Delta)]$，其中 $f_r(\Delta)$ 是在给定分辨率 $\Delta$ 下已解析的湍动能或方差的分数。这样，随着分辨率提高，$f_r \to 1$，[参数化](@entry_id:265163)作用减弱；随着分辨率降低，$f_r \to 0$，[参数化](@entry_id:265163)作用增强，从而在所有尺度上实现平滑过渡。