{
    "hands_on_practices": [
        {
            "introduction": "当大气柱中存在多个云层时，我们如何计算总的云覆盖量？这个基本问题是辐射传输计算和模式物理过程耦合的核心。本练习探讨了垂直云重叠的两种基本极限情况：随机重叠和最大重叠，将它们置于严谨的概率论框架中。通过掌握这些理想化的模型，您将为理解和实现天气和气候模式中更复杂的云重叠参数化方案奠定坚实的基础 。",
            "id": "4023766",
            "problem": "在数值天气预报（NWP）和气候模型中，考虑一个包含两个独立云层的单一大气柱。设低层云占据其所在层级水平分数的 $f_{1}$，高层云占据其所在层级水平分数的 $f_{2}$。在标准的 Kolmogorov 框架下，将水平云量分数解释为概率，将在层1中某一水平位置存在云的事件记为 $\\mathcal{A}_{1}$，其概率为 $P(\\mathcal{A}_{1})=f_{1}$；类似地，将在层2中存在云的事件记为 $\\mathcal{A}_{2}$，其概率为 $P(\\mathcal{A}_{2})=f_{2}$。总云柱云量分数 $C$ 是并集 $P(\\mathcal{A}_{1} \\cup \\mathcal{A}_{2})$ 的概率。\n\n从概率并集恒等式 $P(\\mathcal{A}_{1} \\cup \\mathcal{A}_{2})=P(\\mathcal{A}_{1})+P(\\mathcal{A}_{2})-P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})$ 出发，推导在以下假设下 $C$ 的表达式：\n- 随机重叠假设（$\\mathcal{A}_{1}$ 和 $\\mathcal{A}_{2}$ 统计独立），\n- 最大重叠假设（完全正相关导致最大空间重合），以及\n- 一种混合重叠，通过参数 $\\alpha \\in [0,1]$ 对这两个极限相交结构进行线性插值，该参数用于加权相交度量。\n\n然后，对于 $f_{1}=0.6$，$f_{2}=0.3$ 和 $\\alpha=0.5$，计算分别对应于随机重叠、最大重叠和混合重叠的三个 $C$ 值。将您的最终值表示为无量纲的小数分数，四舍五入到四位有效数字，并且不要使用百分号。按顺序将这三个值以单行矩阵 $\\bigl(C_{\\text{rand}},\\,C_{\\text{max}},\\,C_{\\text{blend}}\\bigr)$ 的形式提供。",
            "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 单一大气柱包含两个独立的云层。\n- 低层云量分数：$f_{1}$。\n- 高层云量分数：$f_{2}$。\n- 层1中存在云的事件：$\\mathcal{A}_{1}$，概率为 $P(\\mathcal{A}_{1})=f_{1}$。\n- 层2中存在云的事件：$\\mathcal{A}_{2}$，概率为 $P(\\mathcal{A}_{2})=f_{2}$。\n- 总云柱云量分数：$C = P(\\mathcal{A}_{1} \\cup \\mathcal{A}_{2})$。\n- 起始恒等式：$P(\\mathcal{A}_{1} \\cup \\mathcal{A}_{2})=P(\\mathcal{A}_{1})+P(\\mathcal{A}_{2})-P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})$。\n- 任务1：推导在随机重叠、最大重叠和混合重叠假设下 $C$ 的表达式。\n- 混合重叠：用参数 $\\alpha \\in [0,1]$ 在随机和最大相交结构之间进行线性插值。\n- 任务2：对于 $f_{1}=0.6$，$f_{2}=0.3$ 和 $\\alpha=0.5$，计算三个 $C$ 值（$C_{\\text{rand}}$，$C_{\\text{max}}$，$C_{\\text{blend}}$）。\n- 最终答案格式：无量纲小数分数，四舍五入到四位有效数字，形式为单行矩阵。\n\n根据指定标准对问题进行验证。\n- **科学依据**：该问题是大气模型中使用的云重叠参数化的标准、典型表示。随机重叠和最大重叠的概念是公认的极限情况。云量分数的概率解释是标准实践。该问题在科学上是合理的。\n- **适定性**：问题定义清晰，提供了所有必要的数据和定义，并要求推导具体的表达式和计算可计算的值。每个部分都存在唯一的解。\n- **客观性**：问题以概率论和大气科学的精确、形式化语言陈述，没有主观性或模糊性（除了关于 $\\alpha$ 加权方向的一个小问题，这在推导中得到了解决）。\n\n该问题被认为是有效的，因为它具有科学依据、适定性、客观性，并且没有违反任何指定的无效标准。我们可以继续进行解答。\n\n总云柱云量分数 $C$ 定义为两个云事件 $\\mathcal{A}_{1}$ 和 $\\mathcal{A}_{2}$ 并集的概率。使用提供的恒等式并代入各层的给定概率：\n$$C = P(\\mathcal{A}_{1} \\cup \\mathcal{A}_{2}) = P(\\mathcal{A}_{1}) + P(\\mathcal{A}_{2}) - P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})$$\n$$C = f_{1} + f_{2} - P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})$$\n因此，每种重叠假设的推导都归结为确定交集概率 $P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})$ 的形式。\n\n**1. 随机重叠假设**\n\n在随机重叠假设下，事件 $\\mathcal{A}_{1}$ 和 $\\mathcal{A}_{2}$ 被认为是统计独立的。根据统计独立的定义，它们交集的概率是它们各自概率的乘积：\n$$P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{rand}} = P(\\mathcal{A}_{1}) P(\\mathcal{A}_{2}) = f_{1} f_{2}$$\n将此代入 $C$ 的一般表达式，我们得到随机重叠的总云量分数 $C_{\\text{rand}}$：\n$$C_{\\text{rand}} = f_{1} + f_{2} - f_{1} f_{2}$$\n\n**2. 最大重叠假设**\n\n在最大重叠假设下，云的空间排列使其重叠区域最大化。两个集合的交集不能大于任何一个单独的集合。用概率术语表示，这由不等式 $P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2}) \\le P(\\mathcal{A}_{1})$ 和 $P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2}) \\le P(\\mathcal{A}_{2})$ 表达。为了最大化交集，它必须等于可能的最小上界：\n$$P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{max}} = \\min(P(\\mathcal{A}_{1}), P(\\mathcal{A}_{2})) = \\min(f_{1}, f_{2})$$\n将此代入 $C$ 的一般表达式，我们得到最大重叠的总云量分数 $C_{\\text{max}}$：\n$$C_{\\text{max}} = f_{1} + f_{2} - \\min(f_{1}, f_{2})$$\n这个表达式可以简化为 $\\max(f_{1}, f_{2})$。为了证明这一点，考虑两种情况：\n- 如果 $f_{1} \\ge f_{2}$，那么 $\\min(f_{1}, f_{2}) = f_{2}$。表达式变为 $C_{\\text{max}} = f_{1} + f_{2} - f_{2} = f_{1} = \\max(f_{1}, f_{2})$。\n- 如果 $f_{1}  f_{2}$，那么 $\\min(f_{1}, f_{2}) = f_{1}$。表达式变为 $C_{\\text{max}} = f_{1} + f_{2} - f_{1} = f_{2} = \\max(f_{1}, f_{2})$。\n因此，对于最大重叠，总云量分数就是两个云中较大者的分数：\n$$C_{\\text{max}} = \\max(f_{1}, f_{2})$$\n\n**3. 混合重叠**\n\n问题指定了一个混合模型，其中交集度量是随机重叠和最大重叠情况之间的线性插值，由参数 $\\alpha \\in [0,1]$ 加权。我们将采用这样的约定，即 $\\alpha$ 代表最大重叠结构的权重，使得 $\\alpha=1$ 对应于纯最大重叠，而 $\\alpha=0$ 对应于纯随机重叠。\n因此，混合情况下的交集概率是：\n$$P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{blend}} = \\alpha \\cdot P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{max}} + (1-\\alpha) \\cdot P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{rand}}$$\n代入最大和随机交集概率的表达式：\n$$P(\\mathcal{A}_{1} \\cap \\mathcal{A}_{2})_{\\text{blend}} = \\alpha \\min(f_{1}, f_{2}) + (1-\\alpha) f_{1} f_{2}$$\n现在，我们将这个混合交集代入 $C$ 的通用公式：\n$$C_{\\text{blend}} = f_{1} + f_{2} - \\left[ \\alpha \\min(f_{1}, f_{2}) + (1-\\alpha) f_{1} f_{2} \\right]$$\n这可以通过重新组合含 $\\alpha$ 的项来重新整理：\n$$C_{\\text{blend}} = f_{1} + f_{2} - \\alpha \\min(f_{1}, f_{2}) - f_{1} f_{2} + \\alpha f_{1} f_{2}$$\n$$C_{\\text{blend}} = \\alpha \\left( f_{1} + f_{2} - \\min(f_{1}, f_{2}) \\right) + (1-\\alpha) \\left( f_{1} + f_{2} - f_{1} f_{2} \\right)$$\n识别出括号中的项是 $C_{\\text{max}}$ 和 $C_{\\text{rand}}$ 的表达式：\n$$C_{\\text{blend}} = \\alpha C_{\\text{max}} + (1-\\alpha) C_{\\text{rand}}$$\n这表明对交集概率进行线性插值等同于对总云量分数进行线性插值。\n\n**数值计算**\n\n给定值为 $f_{1}=0.6$，$f_{2}=0.3$ 和 $\\alpha=0.5$。\n\n- 对于随机重叠：\n$$C_{\\text{rand}} = f_{1} + f_{2} - f_{1}f_{2} = 0.6 + 0.3 - (0.6)(0.3) = 0.9 - 0.18 = 0.72$$\n- 对于最大重叠：\n$$C_{\\text{max}} = \\max(f_{1}, f_{2}) = \\max(0.6, 0.3) = 0.6$$\n- 对于混合重叠：\n使用 $\\alpha=0.5$ 的简化表达式：\n$$C_{\\text{blend}} = (0.5) C_{\\text{max}} + (1-0.5) C_{\\text{rand}} = 0.5(0.6) + 0.5(0.72) = 0.3 + 0.36 = 0.66$$\n问题要求结果是无量纲小数分数，并四舍五入到四位有效数字。\n$C_{\\text{rand}} = 0.7200$\n$C_{\\text{max}} = 0.6000$\n$C_{\\text{blend}} = 0.6600$\n\n最终答案以行矩阵 $\\bigl(C_{\\text{rand}},\\,C_{\\text{max}},\\,C_{\\text{blend}}\\bigr)$ 的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7200  0.6000  0.6600\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在数值模式中，单个模式层的“云量”从何而来？它不是一个给定的数字，而是必须根据模式的物理状态计算得出。本练习展示了一种常用技术，即使用一个假设的次网格尺度水汽变化的概率密度函数 (PDF) 来参数化云量。通过这个练习，您可以将云量这一抽象概念与模式中可分辨的热力学场联系起来，揭示了未分辨的次网格过程是如何被统计表示的 。",
            "id": "4023772",
            "problem": "考虑一个数值天气预报（NWP）模式中的单个粗分辨率网格柱，其中总水混合比的水平次网格变率未被显式解析。设总水混合比由一个假设的概率密度函数（PDF）建模，此处取为均值为 $\\bar{q}$、方差为 $\\sigma_{q}^{2}$ 的高斯分布。当局部总水混合比 $q_{t}$ 超过饱和混合比 $q_{s}$ 时，云就存在。云量 $f_{c}$ 定义为在假设的PDF下，$q_{t} > q_{s}$ 的概率 $\\mathbb{P}(q_{t} > q_{s})$。\n\n从高斯PDF和正态随机变量的累积分布函数的定义出发，推导出一个用 $\\bar{q}$、$\\sigma_{q}$ 和 $q_{s}$ 表示 $f_{c}$ 的闭式表达式。接下来，为了模拟粗分辨率下未解析的水平非均匀性，将次网格方差扩大一个因子 $\\gamma > 1$，即设 $\\sigma_{q}' = \\gamma \\sigma_{q}$，并在相同的假设PDF框架下推导相应的云量 $f_{c}'$。\n\n最后，考虑一个气候模式中的双层气柱，其云层为随机重叠，这意味着总云覆盖率 $F$ 由 $F = 1 - (1 - f_{c,\\text{low}})(1 - f_{c,\\text{high}})$ 给出，其中 $f_{c,\\text{low}}$ 是低层云量，$f_{c,\\text{high}}$ 是高层云量。假设方差扩大前 $f_{c,\\text{low}} = f_{c}$，扩大后 $f_{c,\\text{low}} = f_{c}'$，而 $f_{c,\\text{high}}$ 保持不变。使用数值 $\\bar{q} = 0.010$ kg/kg, $\\sigma_{q} = 0.002$ kg/kg, $q_{s} = 0.012$ kg/kg, $\\gamma = 2$ 和 $f_{c,\\text{high}} = 0.35$，计算总云覆盖率的绝对增量 $\\Delta F = F' - F$。将最终答案四舍五入到四位有效数字，并以小数形式表示。",
            "solution": "首先将对问题陈述的科学合理性、清晰度和完整性进行验证。\n\n### 步骤 1：提取已知条件\n- 总水混合比 $q_t$ 由一个均值为 $\\bar{q}$、方差为 $\\sigma_{q}^{2}$ 的高斯概率密度函数（PDF）建模。\n- 当 $q_{t} > q_{s}$ 时云存在，其中 $q_s$ 是饱和混合比。\n- 云量 $f_{c}$ 定义为概率 $\\mathbb{P}(q_{t} > q_{s})$。\n- 次网格方差被一个因子 $\\gamma > 1$ 扩大，使得新的标准差为 $\\sigma_{q}' = \\gamma \\sigma_{q}$。相应的新云量为 $f_c'$。\n- 对于一个具有随机重叠的双层气柱，总云覆盖率 $F$ 由 $F = 1 - (1 - f_{c,\\text{low}})(1 - f_{c,\\text{high}})$ 给出。\n- 方差扩大前，$f_{c,\\text{low}} = f_{c}$。\n- 方差扩大后，$f'_{c,\\text{low}} = f_{c}'$。\n- 高层云量 $f_{c,\\text{high}}$ 保持不变。\n- 数值：$\\bar{q} = 0.010$ kg/kg, $\\sigma_{q} = 0.002$ kg/kg, $q_{s} = 0.012$ kg/kg, $\\gamma = 2$ 和 $f_{c,\\text{high}} = 0.35$。\n- 要求输出的是总云覆盖率的绝对增量 $\\Delta F = F' - F$，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。使用假设的PDF（特别是高斯分布）根据饱和阈值来参数化次网格尺度的云量，是数值天气预报和气候模拟中的一种标准且成熟的技术。定义精确且可以数学形式化。在随机重叠假设下计算总云覆盖率的公式也是一个标准模型。该问题是适定的，提供了所有必要的信息和数值以得出一个唯一解。所给数值对于大气条件是物理上合理的。该问题是客观的，不含任何非科学性论断。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解题推导\n总水混合比 $q_t$ 是一个正态分布的随机变量，$q_t \\sim \\mathcal{N}(\\bar{q}, \\sigma_q^2)$。其概率密度函数（PDF）由下式给出：\n$$p(q_t) = \\frac{1}{\\sigma_q \\sqrt{2\\pi}} \\exp\\left(-\\frac{(q_t - \\bar{q})^2}{2\\sigma_q^2}\\right)$$\n云量 $f_c$ 是 $q_t$ 超过饱和混合比 $q_s$ 的概率：\n$$f_c = \\mathbb{P}(q_t > q_s) = \\int_{q_s}^{\\infty} p(q_t) \\, dq_t = \\int_{q_s}^{\\infty} \\frac{1}{\\sigma_q \\sqrt{2\\pi}} \\exp\\left(-\\frac{(q_t - \\bar{q})^2}{2\\sigma_q^2}\\right) \\, dq_t$$\n为了计算这个积分，我们进行变量替换以标准化分布。令 $z = \\frac{q_t - \\bar{q}}{\\sigma_q}$。这意味着 $dq_t = \\sigma_q dz$。积分下限对于 $z$ 变为 $\\frac{q_s - \\bar{q}}{\\sigma_q}$。积分上限保持为 $\\infty$。\n$$f_c = \\int_{\\frac{q_s - \\bar{q}}{\\sigma_q}}^{\\infty} \\frac{1}{\\sigma_q \\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) (\\sigma_q dz) = \\int_{\\frac{q_s - \\bar{q}}{\\sigma_q}}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz$$\n这个积分是标准正态分布的尾概率。它与标准正态累积分布函数（CDF）$\\Phi(x) = \\int_{-\\infty}^{x} \\frac{1}{\\sqrt{2\\pi}} \\exp(-t^2/2) dt$ 和互补误差函数 $\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_{x}^{\\infty} \\exp(-t^2) dt$ 有关。它们之间的关系是 $1 - \\Phi(x) = \\frac{1}{2}\\text{erfc}(x/\\sqrt{2})$。\n因此，云量 $f_c$ 可以用一个闭式表达式表示：\n$$f_c = \\frac{1}{2} \\text{erfc}\\left(\\frac{q_s - \\bar{q}}{\\sqrt{2}\\sigma_q}\\right)$$\n这是第一个要求的表达式。\n\n接下来，我们考虑次网格方差被扩大的情况。新的标准差是 $\\sigma_q' = \\gamma \\sigma_q$。相应的云量 $f_c'$，可以通过在 $f_c$ 的表达式中用 $\\sigma_q'$ 替换 $\\sigma_q$ 得到：\n$$f_c' = \\frac{1}{2} \\text{erfc}\\left(\\frac{q_s - \\bar{q}}{\\sqrt{2}\\sigma_q'}\\right) = \\frac{1}{2} \\text{erfc}\\left(\\frac{q_s - \\bar{q}}{\\sqrt{2}\\gamma\\sigma_q}\\right)$$\n这是第二个要求的表达式。\n\n现在我们进行数值计算。问题陈述，方差扩大前的低层云量为 $f_{c,\\text{low}} = f_c$，扩大后为 $f'_{c,\\text{low}} = f_c'$。扩大前（$F$）和扩大后（$F'$）的总云覆盖率由随机重叠模型给出：\n$$F = 1 - (1 - f_{c,\\text{low}})(1 - f_{c,\\text{high}})$$\n$$F' = 1 - (1 - f'_{c,\\text{low}})(1 - f_{c,\\text{high}})$$\n绝对增量为 $\\Delta F = F' - F$。\n$$\\Delta F = \\left[1 - (1 - f'_{c,\\text{low}})(1 - f_{c,\\text{high}})\\right] - \\left[1 - (1 - f_{c,\\text{low}})(1 - f_{c,\\text{high}})\\right]$$\n$$\\Delta F = (1 - f_{c,\\text{low}})(1 - f_{c,\\text{high}}) - (1 - f'_{c,\\text{low}})(1 - f_{c,\\text{high}})$$\n$$\\Delta F = (1 - f_{c,\\text{high}}) \\left[(1 - f_{c,\\text{low}}) - (1 - f'_{c,\\text{low}})\\right]$$\n$$\\Delta F = (1 - f_{c,\\text{high}}) (f'_{c,\\text{low}} - f_{c,\\text{low}})$$\n我们定义归一化饱和阈值 $s = \\frac{q_s - \\bar{q}}{\\sigma_q}$。\n使用给定值：$\\bar{q} = 0.010$, $\\sigma_q = 0.002$, $q_s = 0.012$。\n$$s = \\frac{0.012 - 0.010}{0.002} = \\frac{0.002}{0.002} = 1$$\n现在我们可以计算 $f_c$ 和 $f_c'$：\n$$f_{c,\\text{low}} = f_c = \\frac{1}{2} \\text{erfc}\\left(\\frac{s}{\\sqrt{2}}\\right) = \\frac{1}{2} \\text{erfc}\\left(\\frac{1}{\\sqrt{2}}\\right)$$\n$$f'_{c,\\text{low}} = f_c' = \\frac{1}{2} \\text{erfc}\\left(\\frac{s}{\\sqrt{2}\\gamma}\\right) = \\frac{1}{2} \\text{erfc}\\left(\\frac{1}{\\sqrt{2} \\cdot 2}\\right) = \\frac{1}{2} \\text{erfc}\\left(\\frac{1}{2\\sqrt{2}}\\right)$$\n使用标准库函数计算互补误差函数（为避免中间舍入误差，保留较高精度）：\n$\\text{erfc}(1/\\sqrt{2}) \\approx \\text{erfc}(0.70710678) \\approx 0.31731051$\n$$f_{c,\\text{low}} \\approx \\frac{1}{2}(0.31731051) \\approx 0.15865525$$\n$\\text{erfc}(1/(2\\sqrt{2})) \\approx \\text{erfc}(0.35355339) \\approx 0.61707508$\n$$f'_{c,\\text{low}} \\approx \\frac{1}{2}(0.61707508) \\approx 0.30853754$$\n现在，我们使用 $f_{c,\\text{high}} = 0.35$ 计算总云覆盖率的增量 $\\Delta F$：\n$$\\Delta F = (1 - 0.35) (0.30853754 - 0.15865525)$$\n$$\\Delta F = (0.65) (0.14988229)$$\n$$\\Delta F \\approx 0.0974234885$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\\Delta F \\approx 0.09742$$\n这就是总云覆盖率的绝对增量，以小数形式表示。",
            "answer": "$$\\boxed{0.09742}$$"
        },
        {
            "introduction": "一旦我们有了描述云量如何随时间变化的方程，我们如何在模式中对其进行数值求解？这个问题探讨了预报云量方程的时间积分方案的数值稳定性。通过对比一个简单的显式方案和一个更稳健的隐式-显式 (IMEX) 方法，您将理解为什么谨慎选择数值方法对于在复杂模拟中防止出现非物理结果（例如云量变为负数或大于1）至关重要 。",
            "id": "4023811",
            "problem": "考虑数值天气预报（NWP）或气候模型中单个大气模型网格单元，其中预报的云量 $f_{c}(t)$ 因生成和清除过程而演变。假设物理上 $f_{c}(t)\\in[0,1]$，并且其在一个模型时间步长内的次网格尺度倾向可以用具有随时间变化但非负的速率的线性弛豫形式表示，\n$$\n\\frac{d f_{c}}{dt}=\\mathcal{P}(t)\\big(1-f_{c}\\big)-\\mathcal{L}(t)\\,f_{c},\n$$\n其中 $\\mathcal{P}(t)\\ge 0$ 表示凝结和湍流混合产生的净云量生成，而 $\\mathcal{L}(t)\\ge 0$ 表示蒸发和降水清除导致的净云量清除。在单个模型时间步长 $\\Delta t$ 内，假设 $\\mathcal{P}(t)$ 和 $\\mathcal{L}(t)$ 保持恒定，分别等于在该步长开始时评估的 $\\mathcal{P}^{n}$ 和 $\\mathcal{L}^{n}$，并令 $f_{c}^{n}\\in[0,1]$ 表示该步长开始时的云量。\n\n(a) 从上述微分方程出发，写出显式欧拉时间步进更新 $f_{c}^{n+1}=f_{c}^{n}+\\Delta t\\left[\\mathcal{P}^{n}(1-f_{c}^{n})-\\mathcal{L}^{n}f_{c}^{n}\\right]$。推导在给定 $f_{c}^{n}\\in[0,1]$ 和 $\\mathcal{P}^{n},\\mathcal{L}^{n}\\ge 0$ 的情况下，使得 $f_{c}^{n+1}\\in[0,1]$ 的时间步长 $\\Delta t$ 的充要条件。证明对于足够大的 $\\Delta t$ 或 $f_{c}^{n}$、$\\mathcal{P}^{n}$ 和 $\\mathcal{L}^{n}$ 的特定组合，这些条件可能被违反，这意味着显式欧拉更新可能产生 $f_{c}^{n+1}\\notin[0,1]$。\n\n(b) 提出并推导一个单步隐式-显式（IMEX）时间步进格式，该格式隐式处理 $f_{c}$ 中的线性阻尼项，同时显式处理不乘以 $f_{c}$ 的源项。从第一性原理和给定的微分方程出发，得到以 $f_{c}^{n}$、$\\Delta t$、$\\mathcal{P}^{n}$ 和 $\\mathcal{L}^{n}$ 表示的 $f_{c}^{n+1}$ 的闭式更新，并证明对于任何 $\\Delta t>0$，当 $\\mathcal{P}^{n},\\mathcal{L}^{n}\\ge 0$ 且 $f_{c}^{n}\\in[0,1]$ 时，该更新无条件地保持 $f_{c}^{n+1}\\in[0,1]$。\n\n你的最终答案必须是由有界隐式-显式格式产生的 $f_{c}^{n+1}$ 的单一解析表达式。无需四舍五入。最终答案以不带物理单位的形式表示。",
            "solution": "该问题要求分析应用于控制大气模型网格单元内云量 $f_c(t)$ 演化的微分方程的两种时间步进格式。控制方程为\n$$\n\\frac{d f_{c}}{dt}=\\mathcal{P}(t)\\big(1-f_{c}\\big)-\\mathcal{L}(t)\\,f_{c}\n$$\n其中 $\\mathcal{P}(t) \\ge 0$ 和 $\\mathcal{L}(t) \\ge 0$ 分别是生成率和清除率。对于单个时间步长 $\\Delta t$，这些速率是恒定的，即 $\\mathcal{P}^{n}$ 和 $\\mathcal{L}^{n}$。云量在物理上是有界的，$f_c(t) \\in [0, 1]$。我们首先分析显式欧拉格式，然后推导并分析一个保证遵守这些物理边界的隐式-显式（IMEX）格式。\n\n首先，我们可以通过合并乘以 $f_c$ 的项来重写该微分方程：\n$$\n\\frac{d f_{c}}{dt} = \\mathcal{P}^{n} - (\\mathcal{P}^{n} + \\mathcal{L}^{n})f_c\n$$\n这是一个在时间区间 $[t^n, t^{n+1}]$ 上关于 $f_c$ 的一阶线性常微分方程。\n\n(a) 显式欧拉格式分析\n\n显式欧拉时间步进更新给出如下：\n$$\nf_{c}^{n+1}=f_{c}^{n}+\\Delta t\\left[\\mathcal{P}^{n}(1-f_{c}^{n})-\\mathcal{L}^{n}f_{c}^{n}\\right]\n$$\n为了分析 $f_c^{n+1}$ 保持在物理区间 $[0, 1]$ 内的条件，我们重新整理表达式，将 $f_c^{n+1}$ 表示为 $f_c^n$ 的线性函数：\n$$\nf_{c}^{n+1} = f_{c}^{n} + \\Delta t \\mathcal{P}^{n} - \\Delta t \\mathcal{P}^{n} f_{c}^{n} - \\Delta t \\mathcal{L}^{n} f_{c}^{n}\n$$\n$$\nf_{c}^{n+1} = f_{c}^{n} \\left(1 - \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})\\right) + \\Delta t \\mathcal{P}^{n}\n$$\n给定 $f_c^n \\in [0, 1]$，$\\mathcal{P}^n \\ge 0$，$\\mathcal{L}^n \\ge 0$ 以及 $\\Delta t > 0$。我们需要找到使 $f_c^{n+1} \\in [0, 1]$ 的 $\\Delta t$ 条件。由于 $f_{c}^{n+1}$ 是 $f_{c}^{n}$ 的线性函数，其在区间 $[0, 1]$ 上的极值必定出现在端点 $f_{c}^{n}=0$ 和 $f_{c}^{n}=1$ 处。因此，我们只需要检查这两点的边界。\n\n条件 1：$f_c^{n+1} \\ge 0$。\n当 $f_c^n = 0$ 时：\n$$\nf_c^{n+1} = (0) \\left(1 - \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})\\right) + \\Delta t \\mathcal{P}^{n} = \\Delta t \\mathcal{P}^{n}\n$$\n由于 $\\Delta t > 0$ 且 $\\mathcal{P}^n \\ge 0$，该值总是非负的。\n当 $f_c^n = 1$ 时：\n$$\nf_c^{n+1} = (1) \\left(1 - \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})\\right) + \\Delta t \\mathcal{P}^{n} = 1 - \\Delta t \\mathcal{P}^{n} - \\Delta t \\mathcal{L}^{n} + \\Delta t \\mathcal{P}^{n} = 1 - \\Delta t \\mathcal{L}^{n}\n$$\n为使此值为非负，我们需要 $1 - \\Delta t \\mathcal{L}^{n} \\ge 0$，这意味着 $\\Delta t \\mathcal{L}^{n} \\le 1$。\n\n条件 2：$f_c^{n+1} \\le 1$。\n当 $f_c^n = 0$ 时：\n$$\nf_c^{n+1} = \\Delta t \\mathcal{P}^{n}\n$$\n为使此值小于或等于 1，我们需要 $\\Delta t \\mathcal{P}^{n} \\le 1$。\n当 $f_c^n = 1$ 时：\n$$\nf_c^{n+1} = 1 - \\Delta t \\mathcal{L}^{n}\n$$\n为使此值小于或等于 1，我们需要 $-\\Delta t \\mathcal{L}^{n} \\le 0$，这总是成立的，因为 $\\Delta t > 0$ 且 $\\mathcal{L}^n \\ge 0$。\n\n综合这些，使 $f_c^{n+1} \\in [0, 1]$ 的充要条件是\n$$\n\\Delta t \\mathcal{P}^{n} \\le 1 \\quad \\text{and} \\quad \\Delta t \\mathcal{L}^{n} \\le 1\n$$\n如果 $\\mathcal{P}^n > 0$ 且 $\\mathcal{L}^n > 0$，这等价于 $\\Delta t \\le \\min(1/\\mathcal{P}^n, 1/\\mathcal{L}^n)$。这些时间步长限制，通常称为类 CFL 条件，可能会被违反。对于任何固定的非零 $\\mathcal{P}^n$ 或 $\\mathcal{L}^n$，可以选择一个足够大的 $\\Delta t$ 来违反该条件。例如，如果我们从 $f_c^n = 0$ 开始并选择 $\\Delta t > 1/\\mathcal{P}^n$，该格式会产生 $f_c^{n+1} = \\Delta t \\mathcal{P}^n > 1$，这是不符合物理的。类似地，如果我们从 $f_c^n=1$ 开始并选择 $\\Delta t > 1/\\mathcal{L}^n$，该格式会产生 $f_c^{n+1} = 1 - \\Delta t \\mathcal{L}^n  0$，这也是不符合物理的。\n\n(b) IMEX 格式的推导与分析\n\n我们被要求推导一个 IMEX 格式，该格式隐式处理 $f_c$ 中的线性阻尼项，并显式处理不乘以 $f_c$ 的源项。从整理后的常微分方程 $\\frac{d f_{c}}{dt} = \\mathcal{P}^{n} - (\\mathcal{P}^{n} + \\mathcal{L}^{n})f_c$ 可知，项 $\\mathcal{P}^n$ 是显式源项，而项 $-(\\mathcal{P}^{n} + \\mathcal{L}^{n})f_c$ 构成隐式线性阻尼。\n用向前差分对时间导数进行离散化，我们在时间层 $n$ 评估显式项，在时间层 $n+1$ 评估隐式项：\n$$\n\\frac{f_{c}^{n+1} - f_{c}^{n}}{\\Delta t} = \\mathcal{P}^{n} - (\\mathcal{P}^{n} + \\mathcal{L}^{n}) f_{c}^{n+1}\n$$\n现在，我们求解 $f_{c}^{n+1}$。首先，我们将所有包含 $f_{c}^{n+1}$ 的项归到一边：\n$$\nf_{c}^{n+1} - f_{c}^{n} = \\Delta t \\mathcal{P}^{n} - \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n}) f_{c}^{n+1}\n$$\n$$\nf_{c}^{n+1} + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n}) f_{c}^{n+1} = f_{c}^{n} + \\Delta t \\mathcal{P}^{n}\n$$\n$$\nf_{c}^{n+1} \\left(1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})\\right) = f_{c}^{n} + \\Delta t \\mathcal{P}^{n}\n$$\n这就得到了 IMEX 格式的闭式更新：\n$$\nf_{c}^{n+1} = \\frac{f_{c}^{n} + \\Delta t \\mathcal{P}^{n}}{1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})}\n$$\n接下来，我们必须证明该格式在给定 $f_{c}^{n} \\in [0, 1]$、$\\mathcal{P}^{n} \\ge 0$ 和 $\\mathcal{L}^{n} \\ge 0$ 的情况下，对任何 $\\Delta t > 0$ 都无条件地保持边界 $f_{c}^{n+1} \\in [0, 1]$。\n\n证明 $f_{c}^{n+1} \\ge 0$：\n分子是 $f_{c}^{n} + \\Delta t \\mathcal{P}^{n}$。给定 $f_{c}^{n} \\ge 0$，$\\Delta t > 0$ 和 $\\mathcal{P}^{n} \\ge 0$，分子总是非负的。\n分母是 $1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})$。给定 $\\Delta t > 0$，$\\mathcal{P}^{n} \\ge 0$ 和 $\\mathcal{L}^{n} \\ge 0$，项 $\\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})$ 是非负的。因此，分母是严格正的（实际上 $\\ge 1$）。\n一个非负数与一个正数的比值是非负的。因此，$f_{c}^{n+1} \\ge 0$ 是无条件满足的。\n\n证明 $f_{c}^{n+1} \\le 1$：\n我们需要证明：\n$$\n\\frac{f_{c}^{n} + \\Delta t \\mathcal{P}^{n}}{1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})} \\le 1\n$$\n由于分母 $1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})$ 是正的，我们可以用它乘以不等式两边而不改变不等号的方向：\n$$\nf_{c}^{n} + \\Delta t \\mathcal{P}^{n} \\le 1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})\n$$\n$$\nf_{c}^{n} + \\Delta t \\mathcal{P}^{n} \\le 1 + \\Delta t \\mathcal{P}^{n} + \\Delta t \\mathcal{L}^{n}\n$$\n从两边减去 $\\Delta t \\mathcal{P}^{n}$ 得到：\n$$\nf_{c}^{n} \\le 1 + \\Delta t \\mathcal{L}^{n}\n$$\n我们已知 $f_{c}^{n} \\in [0, 1]$，所以 $f_{c}^{n} \\le 1$。我们也知道 $\\Delta t > 0$ 和 $\\mathcal{L}^{n} \\ge 0$，这意味着 $\\Delta t \\mathcal{L}^{n} \\ge 0$。因此，$1 \\le 1 + \\Delta t \\mathcal{L}^{n}$。\n结合这些，我们有 $f_{c}^{n} \\le 1 \\le 1 + \\Delta t \\mathcal{L}^{n}$，所以不等式 $f_{c}^{n} \\le 1 + \\Delta t \\mathcal{L}^{n}$ 总是成立的。\n因此，$f_c^{n+1} \\le 1$ 是无条件满足的。\n\n由于对于任何 $\\Delta t > 0$ 以及给定的非负速率和初始有界云量， $f_{c}^{n+1} \\ge 0$ 和 $f_{c}^{n+1} \\le 1$ 都成立，因此所提出的 IMEX 格式是无条件保界的。",
            "answer": "$$\n\\boxed{\\frac{f_{c}^{n} + \\Delta t \\mathcal{P}^{n}}{1 + \\Delta t (\\mathcal{P}^{n} + \\mathcal{L}^{n})}}\n$$"
        }
    ]
}