{
    "hands_on_practices": [
        {
            "introduction": "我们从最基本的模块——“灰气体”模型开始。虽然这是一种简化，但它使我们能够分离出辐射能量交换的核心物理过程。这个练习  要求您为一个简单的大气板层计算净通量和由此产生的加热率，将通量散度的抽象概念与大气加热或冷却这一具体过程联系起来。",
            "id": "4014053",
            "problem": "考虑一个在热红外（长波）波段呈灰色且无散射的平面平行等温大气层。该大气层位于气压 $p_{\\text{bottom}} = 80000$ Pa 和 $p_{\\text{top}} = 70000$ Pa 之间，温度为 $T_{\\text{a}} = 280$ K，其半球长波发射率为 $\\varepsilon = 0.6$（因此其半球透射率为 $\\tau = 1 - \\varepsilon$）。下方的表面是一个温度为 $T_{\\text{s}} = 300$ K 的黑体。上方的太空有效温度为 $0$ K。假设半球、漫射、朗伯发射符合基尔霍夫定律（吸收率等于发射率），且表面无反射。\n\n- 令净向上长波通量定义为 $F = F^{\\uparrow} - F^{\\downarrow}$，其中 $F^{\\uparrow}$ 和 $F^{\\downarrow}$ 分别是半球向上和向下的长波通量。\n- 使用斯特藩-玻尔兹曼常数 $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$，重力加速度 $g = 9.81$ m s$^{-2}$，以及干空气的定压比热 $c_p = 1004$ J kg$^{-1}$ K$^{-1}$。\n- 将压力方向的垂直导数处理为层平均有限差分，即 $\\partial F / \\partial p \\approx \\left[F(p_{\\text{top}}) - F(p_{\\text{bottom}})\\right] / \\left(p_{\\text{top}} - p_{\\text{bottom}}\\right)$。\n\n使用以上假设，并仅依据辐射传输的基本原理（能量守恒、灰色等温层的基尔霍夫定律以及半球黑体发射），计算该大气层的长波通量散度和相应的辐射加热率\n$$\nQ \\;=\\; \\frac{g}{c_p}\\,\\frac{\\partial F}{\\partial p}\n$$\n。将最终的加热率以 K day$^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望求解一个大气层的辐射加热率。\n\n### 步骤 1：提取已知条件\n- 大气层气压：$p_{\\text{bottom}} = 80000$ Pa, $p_{\\text{top}} = 70000$ Pa\n- 大气层温度：$T_{\\text{a}} = 280$ K\n- 大气层半球长波发射率：$\\varepsilon = 0.6$\n- 大气层半球长波透射率：$\\tau = 1 - \\varepsilon = 0.4$\n- 地表温度：$T_{\\text{s}} = 300$ K\n- 地表属性：黑体（发射率为 $1$）\n- 太空温度：$0$ K\n- 净向上长波通量定义：$F = F^{\\uparrow} - F^{\\downarrow}$\n- 斯特藩-玻尔兹曼常数：$\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$\n- 重力加速度：$g = 9.81$ m s$^{-2}$\n- 干空气的定压比热：$c_p = 1004$ J kg$^{-1}$ K$^{-1}$\n- 有限差分近似：$\\partial F / \\partial p \\approx \\left[F(p_{\\text{top}}) - F(p_{\\text{bottom}})\\right] / \\left(p_{\\text{top}} - p_{\\text{bottom}}\\right)$\n- 辐射加热率定义：$Q = \\frac{g}{c_p}\\,\\frac{\\partial F}{\\partial p}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于平面平行大气中辐射传输的基本原理。这是大气物理学中一个标准的简化问题。所有术语都有定义，并且提供了必要的物理常数和边界条件，使问题自成体系且适定。语言客观而精确。物理数值对于一个大气层是现实的。该设置没有内部矛盾、科学不准确性或验证标准中列出的其他缺陷。\n\n### 步骤 3：结论和行动\n问题有效。将制定一个合理的解决方案。\n\n### 解题方案\n目标是计算大气层的辐射加热率 $Q$，其定义为：\n$$\nQ = \\frac{g}{c_p} \\frac{\\partial F}{\\partial p}\n$$\n问题指定使用有限差分近似来计算通量相对于压力的散度：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{F(p_{\\text{top}}) - F(p_{\\text{bottom}})}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n这里，$F(p) = F^{\\uparrow}(p) - F^{\\downarrow}(p)$ 是在气压水平 $p$ 处的净向上长波通量。我们必须确定大气层顶部和底部的通量。\n\n**1. 大气层底部的通量 ($p_{\\text{bottom}}$):**\n大气层底部的向上通量 $F^{\\uparrow}(p_{\\text{bottom}})$ 是其下方黑体表面发出的辐射。该表面温度为 $T_{\\text{s}}$。\n$$\nF^{\\uparrow}(p_{\\text{bottom}}) = \\sigma T_{\\text{s}}^4\n$$\n大气层底部的向下通量 $F^{\\downarrow}(p_{\\text{bottom}})$ 是等温层本身向下发出的辐射。根据基尔霍夫定律，该层的吸收率等于其发射率 $\\varepsilon$。该层温度为 $T_{\\text{a}}$。来自上方太空的入射辐射为零，因此从上方透射的辐射也为零。\n$$\nF^{\\downarrow}(p_{\\text{bottom}}) = \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n因此，大气层底部的净向上通量为：\n$$\nF(p_{\\text{bottom}}) = F^{\\uparrow}(p_{\\text{bottom}}) - F^{\\downarrow}(p_{\\text{bottom}}) = \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n\n**2. 大气层顶部的通量 ($p_{\\text{top}}$):**\n大气层顶部的向上通量 $F^{\\uparrow}(p_{\\text{top}})$ 由两部分组成：穿过该层的地表辐射，以及该层本身向上发出的辐射。\n$$\nF^{\\uparrow}(p_{\\text{top}}) = \\tau (\\sigma T_{\\text{s}}^4) + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n由于 $\\tau = 1 - \\varepsilon$，这变为：\n$$\nF^{\\uparrow}(p_{\\text{top}}) = (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n大气层顶部的向下通量 $F^{\\downarrow}(p_{\\text{top}})$ 是来自太空的辐射。由于太空温度为 $0$ K，该通量为零。\n$$\nF^{\\downarrow}(p_{\\text{top}}) = \\sigma (0 \\text{ K})^4 = 0\n$$\n大气层顶部的净向上通量为：\n$$\nF(p_{\\text{top}}) = F^{\\uparrow}(p_{\\text{top}}) - F^{\\downarrow}(p_{\\text{top}}) = (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n\n**3. 通量散度：**\n现在，我们计算穿过该层的净通量差，$\\Delta F = F(p_{\\text{top}}) - F(p_{\\text{bottom}})$。\n$$\n\\Delta F = \\left[ (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4 \\right] - \\left[ \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{a}}^4 \\right]\n$$\n$$\n\\Delta F = \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4 - \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n$$\n\\Delta F = 2 \\varepsilon \\sigma T_{\\text{a}}^4 - \\varepsilon \\sigma T_{\\text{s}}^4 = \\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)\n$$\n气压差为 $\\Delta p = p_{\\text{top}} - p_{\\text{bottom}}$。\n通量散度项为：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{\\Delta F}{\\Delta p} = \\frac{\\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n\n**4. 辐射加热率：**\n将此表达式代入 $Q$ 的公式中：\n$$\nQ = \\frac{g}{c_p} \\frac{\\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n现在，我们代入数值：\n- $g = 9.81$ m s$^{-2}$\n- $c_p = 1004$ J kg$^{-1}$ K$^{-1}$\n- $\\varepsilon = 0.6$\n- $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$\n- $T_{\\text{a}} = 280$ K\n- $T_{\\text{s}} = 300$ K\n- $p_{\\text{top}} = 70000$ Pa\n- $p_{\\text{bottom}} = 80000$ Pa\n\n首先，计算温度项：\n$$\n2 T_{\\text{a}}^4 - T_{\\text{s}}^4 = 2 (280)^4 - (300)^4 = 2(6.14656 \\times 10^9) - 8.1 \\times 10^9 = 1.229312 \\times 10^{10} - 8.1 \\times 10^9 = 4.19312 \\times 10^9 \\text{ K}^4\n$$\n接下来，计算通量差 $\\Delta F$：\n$$\n\\Delta F = (0.6)(5.670374419 \\times 10^{-8} \\text{ W m}^{-2} \\text{K}^{-4})(4.19312 \\times 10^9 \\text{ K}^4) \\approx 142.673 \\text{ W m}^{-2}\n$$\n气压差为：\n$$\n\\Delta p = 70000 \\text{ Pa} - 80000 \\text{ Pa} = -10000 \\text{ Pa}\n$$\n通量散度为：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{142.673 \\text{ W m}^{-2}}{-10000 \\text{ Pa}} = -0.0142673 \\text{ W m}^{-2} \\text{Pa}^{-1}\n$$\n物理常数的比值为：\n$$\n\\frac{g}{c_p} = \\frac{9.81 \\text{ m s}^{-2}}{1004 \\text{ J kg}^{-1} \\text{K}^{-1}} \\approx 0.0097709 \\text{ m}^2 \\text{K J}^{-1}\n$$\n以 K s$^{-1}$ 为单位的加热率为：\n$$\nQ = \\left(\\frac{g}{c_p}\\right) \\left(\\frac{\\partial F}{\\partial p}\\right) \\approx (0.0097709 \\text{ m}^2 \\text{K J}^{-1})(-0.0142673 \\text{ W m}^{-2} \\text{Pa}^{-1}) \\approx -0.000139396 \\text{ K s}^{-1}\n$$\n（单位检查：$Q$ 的单位确实是 K s⁻¹）。\n\n为了以 K day$^{-1}$ 表示加热率，我们乘以一天中的秒数（$24 \\times 60 \\times 60 = 86400$ s/day）。\n$$\nQ_{\\text{day}} = (-0.000139396 \\text{ K s}^{-1}) \\times (86400 \\text{ s day}^{-1}) \\approx -12.0438 \\text{ K day}^{-1}\n$$\n四舍五入到四位有效数字，最终结果是 $-12.04$。负号表示辐射冷却。",
            "answer": "$$\n\\boxed{-12.04}\n$$"
        },
        {
            "introduction": "在现实中，大气吸收高度依赖于波长。相关k分布（correlated-k）方法是一种优雅且计算高效的技术，用于处理这种光谱复杂性，而无需执行成千上万次的逐线计算。这个实践  提供了该方法的直接应用，让您能够使用构成许多现代辐射编码核心的数值积分法来计算波段平均透过率。",
            "id": "4014096",
            "problem": "在数值天气预报和气候模拟中参数化大气吸收的背景下，考虑一个在指定光谱带内包含单一吸收气体的均匀等温层。设单色透过率遵循比尔-朗伯定律，其中单色吸收系数 $k(\\nu)$ 产生的单色透过率为 $T_{\\nu}=\\exp(-k(\\nu)\\,u)$，其中 $u$ 表示沿视线的吸收物质量路径。为在$k$分布（相关$k$）方法下获得波段平均透过率，将变量从波数 $\\nu$ 转换为带内 $k$ 在归一化加权下的累积概率变量 $g$，从而波段平均透过率可以表示为在 $g \\in [0,1]$ 上的积分。在标准假设（即由 $g$ 对 $k$ 的排序在整个层中近似保持不变）下，使用一个具有 $N$ 个节点的有限求积来近似该积分，这些节点由数对 $\\{(w_i,k_i)\\}_{i=1}^{N}$ 表征，其中 $w_i$ 是满足 $\\sum_{i=1}^{N} w_i=1$ 的求积权重，$k_i$ 是 $g$ 空间中节点处的代表性吸收系数。\n\n给定在层温度和压力下的一个中红外波段的六点求积，吸收物质量路径 $u=0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}$，以及以下节点，\n- 权重：$w_1=0.10$，$w_2=0.15$，$w_3=0.20$，$w_4=0.20$，$w_5=0.20$，$w_6=0.15$，\n- 吸收系数：$k_1=0.80\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，$k_2=2.50\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，$k_3=5.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，$k_4=8.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，$k_5=12.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，$k_6=20.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$，\n\n从第一性原理出发，推导在相关$k$近似下的波段平均层透过率，然后使用提供的求积法进行计算。将最终的透过率表示为一个无量纲数，并四舍五入到六位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确、客观，并包含了获得唯一解所需的所有信息。它描述了相关$k$方法的一个标准应用，该方法是大气模型中辐射传输参数化的基石。\n\n在光谱带 $\\Delta\\nu = [\\nu_a, \\nu_b]$ 上的波段平均透过率 $\\bar{T}$ 是光谱平均的单色透过率。为便于推导，假设采用简单的未加权平均，其定义为：\n$$\n\\bar{T} = \\frac{1}{\\Delta\\nu} \\int_{\\nu_a}^{\\nu_b} T_{\\nu} \\, d\\nu\n$$\n其中 $T_{\\nu}$ 是波数 $\\nu$ 处的单色透过率。\n\n对于均匀层，比尔-朗伯定律将 $T_{\\nu}$ 与单色吸收系数 $k(\\nu)$ 和吸收物质量路径 $u$ 联系起来：\n$$\nT_{\\nu} = \\exp(-k(\\nu)u)\n$$\n将此代入 $\\bar{T}$ 的定义中得到：\n$$\n\\bar{T} = \\frac{1}{\\Delta\\nu} \\int_{\\nu_a}^{\\nu_b} \\exp(-k(\\nu)u) \\, d\\nu\n$$\n由于 $k(\\nu)$ 的高度结构化和快速变化的特性，对波数 $\\nu$ 的积分通常很复杂。相关$k$（或简称$k$分布）方法通过重新排序积分来简化此过程。我们不对波数进行积分，而是对吸收系数 $k$ 的值进行积分。\n\n设 $f(k)$ 是光谱带 $\\Delta\\nu$ 内吸收系数 $k(\\nu)$ 的概率分布函数。此函数表示光谱带中吸收系数的值在 $k$ 和 $k+dk$ 之间的部分所占的比例。波段平均透过率可以表示为该分布下的期望值：\n$$\n\\bar{T} = \\int_0^\\infty \\exp(-ku) f(k) \\, dk\n$$\n下一步是引入一个新变量 $g$，即 $k$ 的累积分布函数（CDF）。变量 $g$ 定义为波段中吸收系数小于或等于给定值 $k$ 的部分所占的比例：\n$$\ng(k) = \\int_0^k f(k') \\, dk'\n$$\n根据定义，$g$ 是 $k$ 的单调递增函数，范围从 $k=0$ 时的 $g=0$ 到 $k \\to \\infty$ 时的 $g=1$。微分关系为 $dg = f(k)dk$。现在我们可以将积分变量从 $k$ 更改为 $g$。这得出了 $k$ 分布框架中波段平均透过率的基本表达式：\n$$\n\\bar{T} = \\int_0^1 \\exp(-k(g)u) \\, dg\n$$\n其中 $k(g)$ 是函数 $g(k)$ 的反函数，给出了作为累积概率变量 $g$ 的函数的吸收系数。这个积分比原来对 $\\nu$ 的积分平滑得多，更适合数值求积。“相关$k$”假设，即 $k$ 值的排序在整个非均匀大气柱中是相同的，这使得该方法可以扩展到多层；对于此处指定的单个均匀层，该方法就是简单的 $k$ 分布。\n\n问题要求使用一个具有 $N$ 个点的有限求积来近似该积分。该积分被一个加权和所取代：\n$$\n\\bar{T} = \\int_0^1 \\exp(-k(g)u) \\, dg \\approx \\sum_{i=1}^{N} w_i \\exp(-k_i u)\n$$\n这里，$\\{w_i\\}_{i=1}^{N}$ 是满足 $\\sum_{i=1}^{N} w_i = 1$ 的求积权重，$\\{k_i\\}_{i=1}^{N}$ 是求积节点处（对应于 $g$ 的特定值）的代表性吸收系数。\n\n问题为六点求积（$N=6$）提供了必要的数据。吸收物质量路径为 $u=0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}$。权重和吸收系数为：\n- $w_1=0.10$，$k_1=0.80\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n- $w_2=0.15$，$k_2=2.50\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n- $w_3=0.20$，$k_3=5.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n- $w_4=0.20$，$k_4=8.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n- $w_5=0.20$，$k_5=12.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n- $w_6=0.15$，$k_6=20.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1}$\n\n首先，我们计算每个节点的无量纲光学厚度 $\\tau_i = k_i u$：\n- $\\tau_1 = k_1 u = (0.80\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 0.20$\n- $\\tau_2 = k_2 u = (2.50\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 0.625$\n- $\\tau_3 = k_3 u = (5.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 1.25$\n- $\\tau_4 = k_4 u = (8.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 2.00$\n- $\\tau_5 = k_5 u = (12.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 3.00$\n- $\\tau_6 = k_6 u = (20.00\\,\\mathrm{m}^2\\,\\mathrm{kg}^{-1})(0.25\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}) = 5.00$\n\n现在，我们可以通过计算总和来求得波段平均透过率：\n$$\n\\bar{T} \\approx w_1 \\exp(-\\tau_1) + w_2 \\exp(-\\tau_2) + w_3 \\exp(-\\tau_3) + w_4 \\exp(-\\tau_4) + w_5 \\exp(-\\tau_5) + w_6 \\exp(-\\tau_6)\n$$\n代入数值：\n$$\n\\bar{T} \\approx 0.10 \\exp(-0.20) + 0.15 \\exp(-0.625) + 0.20 \\exp(-1.25) + 0.20 \\exp(-2.00) + 0.20 \\exp(-3.00) + 0.15 \\exp(-5.00)\n$$\n计算每一项：\n- $0.10 \\times \\exp(-0.20) \\approx 0.10 \\times 0.81873075 = 0.081873075$\n- $0.15 \\times \\exp(-0.625) \\approx 0.15 \\times 0.53526143 = 0.080289214$\n- $0.20 \\times \\exp(-1.25) \\approx 0.20 \\times 0.28650480 = 0.057300960$\n- $0.20 \\times \\exp(-2.00) \\approx 0.20 \\times 0.13533528 = 0.027067056$\n- $0.20 \\times \\exp(-3.00) \\approx 0.20 \\times 0.04978707 = 0.009957414$\n- $0.15 \\times \\exp(-5.00) \\approx 0.15 \\times 0.00673795 = 0.001010693$\n\n将这些值相加，得到波段平均透过率的最终近似值：\n$$\n\\bar{T} \\approx 0.081873075 + 0.080289214 + 0.057300960 + 0.027067056 + 0.009957414 + 0.001010693 = 0.257498412\n$$\n按照要求，将结果四舍五入到六位有效数字：\n$$\n\\bar{T} \\approx 0.257498\n$$\n这就是波段平均层透过率，一个无量纲的量。",
            "answer": "$$\n\\boxed{0.257498}\n$$"
        },
        {
            "introduction": "我们为什么需要像相关k分布这样复杂的方法？最后一个实践通过量化简单灰气体模型的缺点来回答这个问题。通过实现一个区分不透明区域和透明“窗区”的双波段模型，并将其输出与灰体模型进行比较，您将亲眼看到  光谱平均如何导致在如出射长波辐射（OLR）等关键气候指标上产生显著误差。",
            "id": "4014055",
            "problem": "考虑一个与数值天气预报和气候模拟相关的晴空、平面平行、一维大气柱，其中长波辐射被水汽吸收和发射，无散射过程。假设温度为 $T_{\\mathrm{atm}}$ 的等温大气覆盖在温度为 $T_{\\mathrm{sfc}}$ 的朗伯表面之上。目标是使用一种明确包含光谱窗和水汽连续谱的光谱分段表示，来参数化大气顶的长波辐射（OLR），并将其与单波段灰体气体参数化进行比较。\n\n使用以下基本原理：\n- 在无散射的吸收介质中，热辐射的 Schwarzschild 方程为 $\\dfrac{dI_{\\nu}}{d\\tau_{\\nu}} = I_{\\nu} - B_{\\nu}(T)$，其中 $I_{\\nu}$ 是单色强度，$\\tau_{\\nu}$ 是沿路径的单色光学厚度，$B_{\\nu}(T)$ 是温度为 $T$ 时的普朗克函数。\n- 用于计算透射率的 Beer–Lambert 定律，$\\mathcal{T}_{\\nu} = e^{-\\tau_{\\nu}/\\mu}$，适用于相对于天顶方向的方向余弦为 $\\mu$ 的光束。\n- 用于计算频率积分的黑体辐射的 Stefan–Boltzmann 定律，$F = \\sigma T^{4}$，其中 $\\sigma$ 是 Stefan–Boltzmann 常数。\n\n对长波光谱采用双波段近似：\n- 一个窗区波段，占据普朗克加权光谱的 $f_{w}$ 比例。\n- 一个不透明波段，占据互补的 $1 - f_{w}$ 比例。\n\n假设源函数 $B_{\\nu}(T)$ 在每个波段内进行光谱积分后，可以很好地由按波段比例加权的 $\\sigma T^{4}$ 表示。因此，波段 $i \\in \\{\\mathrm{w}, \\mathrm{o}\\}$ 内的波段积分黑体通量为 $w_{i} \\sigma T^{4}$，其中 $w_{\\mathrm{w}} = f_{w}$ 且 $w_{\\mathrm{o}} = 1 - f_{w}$。\n\n对于每个波段 $i$，使用以下公式将垂直方向的波段平均光学厚度建模为水汽路径 $W$（单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}$）的函数\n$$\n\\tau_{\\mathrm{o}} = k_{\\ell} W + \\alpha_{\\mathrm{o}} k_{c} W,\n\\qquad\n\\tau_{\\mathrm{w}} = \\alpha_{\\mathrm{w}} k_{c} W + \\tau_{\\min}\n$$\n其中 $k_{\\ell}$ 是线吸收系数（单位的选择使 $k_{\\ell} W$ 为无量纲），$k_{c}$ 是连续谱吸收系数（单位的选择使 $k_{c} W$ 为无量纲），$\\alpha_{\\mathrm{o}}$ 和 $\\alpha_{\\mathrm{w}}$ 是特定波段的连续谱缩放因子，反映了不同波段中连续谱强度的差异，$\\tau_{\\min}$ 是窗区波段的一个小的正基线光学厚度。光学厚度 $\\tau_{\\mathrm{o}}$ 和 $\\tau_{\\mathrm{w}}$ 是无量纲的。\n\n为了近似角度积分，使用一个固定的有效平均方向余弦 $\\bar{\\mu} = 1 / 1.66$（无量纲），这与平面平行大气中长波辐射传输的漫射近似一致。\n\n将双波段 OLR 定义为各波段贡献之和，并通过将光谱合并为等于两个波段的普朗克加权平均光学厚度的单一光学厚度 $\\tau_{\\mathrm{g}}$（即 $\\tau_{\\mathrm{g}} = w_{\\mathrm{w}} \\tau_{\\mathrm{w}} + w_{\\mathrm{o}} \\tau_{\\mathrm{o}}$）来定义灰体气体 OLR。使用差值和相对偏差来量化双波段 OLR 与灰体气体 OLR 之间的偏差，其中相对偏差定义为差值除以灰体气体 OLR。\n\n实现一个程序，从上述基本原理和假设出发，计算：\n- 双波段 OLR，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n- 灰体气体 OLR，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n- 相对偏差（无量纲），定义为双波段 OLR 减去灰体气体 OLR，再除以灰体气体 OLR。\n\n使用 Stefan–Boltzmann 常数 $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$，并确保所有温度 $T_{\\mathrm{sfc}}$ 和 $T_{\\mathrm{atm}}$ 均以 $\\mathrm{K}$ 为单位提供。你的程序应将两个 OLR 值四舍五入到 $3$ 位小数，将相对偏差四舍五入到 $6$ 位小数。\n\n测试集参数值：\n- 案例 1（具有中等连续谱的一般湿润情况）：$T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.015$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$。\n- 案例 2（无连续谱，突显窗区效应）：$T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.0$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$。\n- 案例 3（非常湿润且具有强连续谱，降低窗区透明度）：$T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 60$, $k_{\\ell} = 0.25$, $k_{c} = 0.03$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$。\n- 案例 4（干燥大气且窗区比例较大）：$T_{\\mathrm{sfc}} = 290$, $T_{\\mathrm{atm}} = 250$, $f_{w} = 0.3$, $W = 5$, $k_{\\ell} = 0.25$, $k_{c} = 0.01$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$。\n- 案例 5（地表与大气温度相等的边界情况）：$T_{\\mathrm{sfc}} = 280$, $T_{\\mathrm{atm}} = 280$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.015$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按案例排序，每个案例包含三个数字：$[\\text{OLR}_{\\text{bands},1}, \\text{OLR}_{\\text{grey},1}, r_{1}, \\text{OLR}_{\\text{bands},2}, \\text{OLR}_{\\text{grey},2}, r_{2}, \\ldots, \\text{OLR}_{\\text{bands},5}, \\text{OLR}_{\\text{grey},5}, r_{5}]$。两个 OLR 值必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位报告，四舍五入到 $3$ 位小数，相对偏差必须报告为四舍五入到 $6$ 位小数的小数。",
            "solution": "该问题是有效的，因为它科学地基于大气辐射传输的既定原则，提法恰当并提供了所有必要信息，且使用客观和正式的语言表述。我们开始进行求解。\n\n目标是为双波段光谱模型和单波段灰体气体模型推导大气顶长波辐射（OLR）的表达式，并对它们进行比较。大气被建模为一个温度为 $T_{\\mathrm{atm}}$ 的平面平行等温层，覆盖在温度为 $T_{\\mathrm{sfc}}$ 的朗伯表面之上。\n\n首先，我们推导单个光谱波段 $i$ 的向上长波通量的一般表达式。大气顶（TOA）的向上强度是穿过大气的地表透射辐射与大气自身积分辐射之和。对于等温大气，沿方向余弦为 $\\mu$（相对于天顶）的路径的向上强度 $I_i^{\\uparrow}$ 为：\n$$\nI_i^{\\uparrow}(\\mu) = (w_i B(T_{\\mathrm{sfc}})) e^{-\\tau_i/\\mu} + (w_i B(T_{\\mathrm{atm}})) (1 - e^{-\\tau_i/\\mu})\n$$\n其中 $w_i$ 是波段 $i$ 占据的普朗克函数光谱的比例，$B(T)$ 是光谱积分的普朗克函数，$\\tau_i$ 是波段 $i$ 中大气的垂直光学厚度，$e^{-\\tau_i/\\mu}$ 是沿斜路径的透射率。问题中指出，波段积分的黑体通量为 $w_i \\sigma T^4$，这对应于 $\\pi w_i B(T)$。\n\n向上通量（OLR）是强度垂直分量 $I_i^{\\uparrow}(\\mu)\\mu$ 在向上半球的积分。问题指定使用漫射近似，该近似用在单一有效平均方向余弦 $\\bar{\\mu} = 1/1.66$ 处的计算值来替代角度积分。这将通量透射率简化为 $\\mathcal{T}_i = e^{-\\tau_i / \\bar{\\mu}}$。因此，波段 $i$ 的向上通量为：\n$$\nF_i^{\\uparrow} = (w_i \\sigma T_{\\mathrm{sfc}}^4) e^{-\\tau_i / \\bar{\\mu}} + (w_i \\sigma T_{\\mathrm{atm}}^4) (1 - e^{-\\tau_i / \\bar{\\mu}})\n$$\n该方程可以重新整理为：\n$$\nF_i^{\\uparrow} = w_i \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_i / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_i / \\bar{\\mu}}) \\right]\n$$\n这是单个波段向上通量的基本表达式。\n\n不透明波段（$\\mathrm{o}$）和窗区波段（$\\mathrm{w}$）的光学厚度表示为水汽路径 $W$ 的函数：\n$$\n\\tau_{\\mathrm{o}} = k_{\\ell} W + \\alpha_{\\mathrm{o}} k_{c} W\n$$\n$$\n\\tau_{\\mathrm{w}} = \\alpha_{\\mathrm{w}} k_{c} W + \\tau_{\\min}\n$$\n\n各波段的光谱权重为 $w_{\\mathrm{w}} = f_w$ 和 $w_{\\mathrm{o}} = 1 - f_w$。\n\n双波段 OLR，记为 $OLR_{\\mathrm{bands}}$，是两个波段通量之和：\n$$\nOLR_{\\mathrm{bands}} = F_{\\mathrm{w}}^{\\uparrow} + F_{\\mathrm{o}}^{\\uparrow}\n$$\n代入每个波段的通量表达式：\n$$\nOLR_{\\mathrm{bands}} = w_{\\mathrm{w}} \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{w}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{w}} / \\bar{\\mu}}) \\right] + w_{\\mathrm{o}} \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{o}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{o}} / \\bar{\\mu}}) \\right]\n$$\n\n灰体气体 OLR，记为 $OLR_{\\mathrm{grey}}$，是通过将光谱合并为具有普朗克加权平均光学厚度 $\\tau_{\\mathrm{g}}$ 的单个波段（$w=1$）来构建的：\n$$\n\\tau_{\\mathrm{g}} = w_{\\mathrm{w}} \\tau_{\\mathrm{w}} + w_{\\mathrm{o}} \\tau_{\\mathrm{o}}\n$$\n在基本通量表达式中使用这个灰体光学厚度，我们得到：\n$$\nOLR_{\\mathrm{grey}} = \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{g}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{g}} / \\bar{\\mu}}) \\right]\n$$\n\n由于光学厚度与透射率之间的非线性关系，预计两个模型之间会存在偏差。透射率的普朗克加权平均值不等于普朗克加权平均光学厚度的透射率。根据 Jensen 不等式，由于函数 $f(x) = e^{-x}$ 是凸函数，函数值的加权平均大于或等于加权平均的函数值：\n$$\nw_{\\mathrm{w}} e^{-\\tau_{\\mathrm{w}}/\\bar{\\mu}} + w_{\\mathrm{o}} e^{-\\tau_{\\mathrm{o}}/\\bar{\\mu}} \\ge e^{-(w_{\\mathrm{w}}\\tau_{\\mathrm{w}} + w_{\\mathrm{o}}\\tau_{\\mathrm{o}})/\\bar{\\mu}}\n$$\n这意味着双波段模型的总透射率大于或等于灰体气体模型的总透射率。当 $T_{\\mathrm{sfc}} > T_{\\mathrm{atm}}$ 时，这导致 $OLR_{\\mathrm{bands}} \\ge OLR_{\\mathrm{grey}}$。灰体气体模型实际上将窗区的透明度“平摊”到整个光谱上，从而低估了向太空的辐射冷却。\n\n相对偏差 $r$ 定义为：\n$$\nr = \\frac{OLR_{\\mathrm{bands}} - OLR_{\\mathrm{grey}}}{OLR_{\\mathrm{grey}}}\n$$\n\n计算步骤如下：\n1. 对于每组输入参数，计算波段光学厚度 $\\tau_{\\mathrm{w}}$ 和 $\\tau_{\\mathrm{o}}$。\n2. 通过对每个波段的贡献求和，计算总的双波段 OLR，$OLR_{\\mathrm{bands}}$。\n3. 计算灰体气体光学厚度 $\\tau_{\\mathrm{g}}$ 和相应的灰体气体 OLR，$OLR_{\\mathrm{grey}}$。\n4. 计算相对偏差 $r$。\n5. 将值四舍五入到指定精度并格式化输出。",
            "answer": "[294.757,235.632,0.25092,301.278,212.83,0.415579,268.04,267.435,0.002262,311.967,282.805,0.10308,357.653,357.653,0.0]"
        }
    ]
}