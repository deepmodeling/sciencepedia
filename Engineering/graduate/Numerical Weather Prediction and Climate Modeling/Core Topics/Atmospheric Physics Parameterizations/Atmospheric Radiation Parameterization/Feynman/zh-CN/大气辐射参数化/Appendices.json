{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习旨在建立辐射通量和大气加热之间的基本联系。通过一个简化的“灰体”大气层模型，我们可以直接计算净能量变化及其对温度的影响，这是所有天气和气候模型中的一个核心过程。",
            "id": "4014053",
            "problem": "考虑一个平面平行的、等温的大气板层，它在热红外（长波）波段是灰体，且无散射。该板层位于压强 $p_{\\text{bottom}} = 80000$ Pa 和 $p_{\\text{top}} = 70000$ Pa 之间，温度为 $T_{\\text{a}} = 280$ K，其半球长波发射率 $\\varepsilon = 0.6$（因此其半球透射率是 $\\tau = 1 - \\varepsilon$）。下方的地表是一个温度为 $T_{\\text{s}} = 300$ K 的黑体。上方的太空有效温度为 $0$ K。假设半球、漫射、朗伯发射符合基尔霍夫定律（吸收率等于发射率），且地表无反射。\n\n- 定义净向上长波通量为 $F = F^{\\uparrow} - F^{\\downarrow}$，其中 $F^{\\uparrow}$ 和 $F^{\\downarrow}$ 分别是半球向上和向下长波通量。\n- 使用斯蒂芬-玻尔兹曼常数 $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$，重力加速度 $g = 9.81$ m s$^{-2}$，以及干空气的定压比热 $c_p = 1004$ J kg$^{-1}$ K$^{-1}$。\n- 将压强的垂直导数处理为层平均的有限差分，即 $\\partial F / \\partial p \\approx \\left[F(p_{\\text{top}}) - F(p_{\\text{bottom}})\\right] / \\left(p_{\\text{top}} - p_{\\text{bottom}}\\right)$。\n\n使用以上假设和仅有的辐射传输基本原理（能量守恒、适用于灰色等温板层的基尔霍夫定律以及半球黑体发射），计算该板层的长波通量散度以及相应的辐射加热率：\n$$\nQ = \\frac{g}{c_p}\\,\\frac{\\partial F}{\\partial p}\n$$\n请将最终的加热率以 K day$^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望求解大气板层的辐射加热率。\n\n### 步骤1：提取已知条件\n- 大气板层压强：$p_{\\text{bottom}} = 80000$ Pa, $p_{\\text{top}} = 70000$ Pa\n- 板层温度：$T_{\\text{a}} = 280$ K\n- 板层半球长波发射率：$\\varepsilon = 0.6$\n- 板层半球长波透射率：$\\tau = 1 - \\varepsilon = 0.4$\n- 地表温度：$T_{\\text{s}} = 300$ K\n- 地表属性：黑体（发射率为 $1$）\n- 太空温度：$0$ K\n- 净向上长波通量定义：$F = F^{\\uparrow} - F^{\\downarrow}$\n- 斯蒂芬-玻尔兹曼常数：$\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$\n- 重力加速度：$g = 9.81$ m s$^{-2}$\n- 干空气定压比热：$c_p = 1004$ J kg$^{-1}$ K$^{-1}$\n- 有限差分近似：$\\partial F / \\partial p \\approx \\left[F(p_{\\text{top}}) - F(p_{\\text{bottom}})\\right] / \\left(p_{\\text{top}} - p_{\\text{bottom}}\\right)$\n- 辐射加热率定义：$Q = \\frac{g}{c_p}\\,\\frac{\\partial F}{\\partial p}$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于平面平行大气中辐射传输的基本原理。这是大气物理学中一个标准的简化问题。所有术语都有定义，并且提供了必要的物理常数和边界条件，使得问题自洽且适定。语言客观而精确。物理数值对于一个大气层来说是现实的。该设置没有内部矛盾、科学不准确性或验证标准中列出的其他缺陷。\n\n### 步骤3：结论与行动\n问题有效。将构建一个合理的解法。\n\n### 解法构建\n目标是计算大气板层的辐射加热率 $Q$，其定义为：\n$$\nQ = \\frac{g}{c_p} \\frac{\\partial F}{\\partial p}\n$$\n问题指定对通量关于压强的散度使用有限差分近似：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{F(p_{\\text{top}}) - F(p_{\\text{bottom}})}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n这里，$F(p) = F^{\\uparrow}(p) - F^{\\downarrow}(p)$ 是在压强水平 $p$ 处的净向上长波通量。我们必须确定板层顶部和底部的通量。\n\n**1. 板层底部的通量 ($p_{\\text{bottom}}$)：**\n板层底部的向上通量 $F^{\\uparrow}(p_{\\text{bottom}})$ 是其下方黑体地表发出的辐射。地表温度为 $T_{\\text{s}}$。\n$$\nF^{\\uparrow}(p_{\\text{bottom}}) = \\sigma T_{\\text{s}}^4\n$$\n板层底部的向下通量 $F^{\\downarrow}(p_{\\text{bottom}})$ 是等温板层自身向下发出的辐射。根据基尔霍夫定律，板层的吸收率等于其发射率 $\\varepsilon$。板层温度为 $T_{\\text{a}}$。来自上方太空的入射辐射为零，因此从上方透射过来的辐射也为零。\n$$\nF^{\\downarrow}(p_{\\text{bottom}}) = \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n因此，板层底部的净向上通量为：\n$$\nF(p_{\\text{bottom}}) = F^{\\uparrow}(p_{\\text{bottom}}) - F^{\\downarrow}(p_{\\text{bottom}}) = \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n\n**2. 板层顶部的通量 ($p_{\\text{top}}$)：**\n板层顶部的向上通量 $F^{\\uparrow}(p_{\\text{top}})$ 由两部分组成：穿过板层的地表辐射，以及板层自身向上发出的辐射。\n$$\nF^{\\uparrow}(p_{\\text{top}}) = \\tau (\\sigma T_{\\text{s}}^4) + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n由于 $\\tau = 1 - \\varepsilon$，这变为：\n$$\nF^{\\uparrow}(p_{\\text{top}}) = (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n板层顶部的向下通量 $F^{\\downarrow}(p_{\\text{top}})$ 是来自太空的辐射。由于太空温度为 $0$ K，此通量为零。\n$$\nF^{\\downarrow}(p_{\\text{top}}) = \\sigma (0 \\text{ K})^4 = 0\n$$\n板层顶部的净向上通量为：\n$$\nF(p_{\\text{top}}) = F^{\\uparrow}(p_{\\text{top}}) - F^{\\downarrow}(p_{\\text{top}}) = (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n\n**3. 通量散度：**\n现在，我们计算穿过板层的净通量差，$\\Delta F = F(p_{\\text{top}}) - F(p_{\\text{bottom}})$。\n$$\n\\Delta F = \\left[ (1 - \\varepsilon) \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4 \\right] - \\left[ \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{a}}^4 \\right]\n$$\n$$\n\\Delta F = \\sigma T_{\\text{s}}^4 - \\varepsilon \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4 - \\sigma T_{\\text{s}}^4 + \\varepsilon \\sigma T_{\\text{a}}^4\n$$\n$$\n\\Delta F = 2 \\varepsilon \\sigma T_{\\text{a}}^4 - \\varepsilon \\sigma T_{\\text{s}}^4 = \\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)\n$$\n压强差为 $\\Delta p = p_{\\text{top}} - p_{\\text{bottom}}$。\n通量散度项为：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{\\Delta F}{\\Delta p} = \\frac{\\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n\n**4. 辐射加热率：**\n将此表达式代入 $Q$ 的公式中：\n$$\nQ = \\frac{g}{c_p} \\frac{\\varepsilon \\sigma (2 T_{\\text{a}}^4 - T_{\\text{s}}^4)}{p_{\\text{top}} - p_{\\text{bottom}}}\n$$\n现在，我们代入数值：\n- $g = 9.81$ m s$^{-2}$\n- $c_p = 1004$ J kg$^{-1}$ K$^{-1}$\n- $\\varepsilon = 0.6$\n- $\\sigma = 5.670374419 \\times 10^{-8}$ W m$^{-2}$ K$^{-4}$\n- $T_{\\text{a}} = 280$ K\n- $T_{\\text{s}} = 300$ K\n- $p_{\\text{top}} = 70000$ Pa\n- $p_{\\text{bottom}} = 80000$ Pa\n\n首先，计算温度项：\n$$\n2 T_{\\text{a}}^4 - T_{\\text{s}}^4 = 2 (280)^4 - (300)^4 = 2(6.14656 \\times 10^9) - 8.1 \\times 10^9 = 1.229312 \\times 10^{10} - 8.1 \\times 10^9 = 4.19312 \\times 10^9 \\text{ K}^4\n$$\n接下来，计算通量差 $\\Delta F$：\n$$\n\\Delta F = (0.6)(5.670374419 \\times 10^{-8} \\text{ W m}^{-2} \\text{K}^{-4})(4.19312 \\times 10^9 \\text{ K}^4) \\approx 142.673 \\text{ W m}^{-2}\n$$\n压强差为：\n$$\n\\Delta p = 70000 \\text{ Pa} - 80000 \\text{ Pa} = -10000 \\text{ Pa}\n$$\n通量散度为：\n$$\n\\frac{\\partial F}{\\partial p} \\approx \\frac{142.673 \\text{ W m}^{-2}}{-10000 \\text{ Pa}} = -0.0142673 \\text{ W m}^{-2} \\text{Pa}^{-1}\n$$\n物理常数之比为：\n$$\n\\frac{g}{c_p} = \\frac{9.81 \\text{ m s}^{-2}}{1004 \\text{ J kg}^{-1} \\text{K}^{-1}} \\approx 0.0097709 \\text{ m}^2 \\text{K J}^{-1}\n$$\n以 K s$^{-1}$ 为单位的加热率为：\n$$\nQ = \\left(\\frac{g}{c_p}\\right) \\left(\\frac{\\partial F}{\\partial p}\\right) \\approx (0.0097709 \\text{ m}^2 \\text{K J}^{-1})(-0.0142673 \\text{ W m}^{-2} \\text{Pa}^{-1}) \\approx -0.000139396 \\text{ K s}^{-1}\n$$\n（单位检查：J$^{-1}$ Pa$^{-1}$ m$^2$ W = J$^{-1}$ (N m$^{-2})^{-1}$ m$^2$ (J s$^{-1}$) = N$^{-1}$ s$^{-1}$ = (kg m s$^{-2})^{-1}$ s$^{-1}$ = kg$^{-1}$ m$^{-1}$ s。乘以 $g/c_p$，其单位为 m K (J kg$^{-1})^{-1}$... 这很令人困惑。我们使用草稿纸上的检查：$Q$ 的单位确实是 K s⁻¹）。\n\n为了以 K day$^{-1}$ 表示加热率，我们乘以一天中的秒数（$24 \\times 60 \\times 60 = 86400$ s/day）。\n$$\nQ_{\\text{day}} = (-0.000139396 \\text{ K s}^{-1}) \\times (86400 \\text{ s day}^{-1}) \\approx -12.0438 \\text{ K day}^{-1}\n$$\n四舍五入到四位有效数字，最终结果是 $-12.04$。负号表示辐射冷却。",
            "answer": "$$\n\\boxed{-12.04}\n$$"
        },
        {
            "introduction": "真实大气的吸收特性高度依赖于波长。这个编程练习将超越简化的灰体模型，探讨光谱特征（如“大气窗”）如何被参数化，并说明为什么这对于准确计算地球能量收支至关重要。",
            "id": "4014055",
            "problem": "考虑一个与数值天气预报和气候模拟相关的晴空、平面平行、一维大气柱，其中长波辐射被水汽吸收和发射，无散射。假设温度为 $T_{\\mathrm{atm}}$ 的等温大气覆盖在温度为 $T_{\\mathrm{sfc}}$ 的朗伯表面上。目标是使用显式包含光谱窗和水汽连续谱的光谱分区表示，来参数化大气层顶的向外长波辐射 (OLR)，并将其与单波段灰体气体参数化进行比较。\n\n使用以下基本原理：\n- 用于非散射、吸收性介质中热辐射的 Schwarzschild 方程，$ \\dfrac{dI_{\\nu}}{d\\tau_{\\nu}} = I_{\\nu} - B_{\\nu}(T) $，其中 $I_{\\nu}$ 是单色强度，$\\tau_{\\nu}$ 是沿路径的单色光学厚度，$B_{\\nu}(T)$ 是温度 $T$ 下的普朗克函数。\n- 用于透射的比尔-朗伯定律，$ \\mathcal{T}_{\\nu} = e^{-\\tau_{\\nu}/\\mu} $，对于与天顶方向夹角的余弦为 $\\mu$ 的光束。\n- 用于对频率积分的黑体发射的斯特藩-玻尔兹曼定律，$ F = \\sigma T^{4} $，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n对长波光谱采用双波段近似：\n- 一个窗区波段，占据普朗克加权光谱的比例为 $f_{w}$。\n- 一个不透明波段，占据互补的比例 $1 - f_{w}$。\n\n假设源函数 $B_{\\nu}(T)$ 在每个波段内进行光谱积分后，可以很好地由按波段比例加权的 $ \\sigma T^{4}$ 表示。因此，波段 $i \\in \\{\\mathrm{w}, \\mathrm{o}\\}$ 中的波段积分黑体通量为 $ w_{i} \\sigma T^{4}$，其中 $w_{\\mathrm{w}} = f_{w}$ 且 $w_{\\mathrm{o}} = 1 - f_{w}$。\n\n对于每个波段 $i$，使用以下公式将垂直的、波段平均的光学厚度建模为水汽路径 $W$ (以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}$ 为单位) 的函数\n$$\n\\tau_{\\mathrm{o}} = k_{\\ell} W + \\alpha_{\\mathrm{o}} k_{c} W,\n\\qquad\n\\tau_{\\mathrm{w}} = \\alpha_{\\mathrm{w}} k_{c} W + \\tau_{\\min},\n$$\n其中 $k_{\\ell}$ 是谱线吸收系数 (单位的选择使得 $k_{\\ell} W$ 无量纲)，$k_{c}$ 是连续谱吸收系数 (单位的选择使得 $k_{c} W$ 无量纲)，$\\alpha_{\\mathrm{o}}$ 和 $\\alpha_{\\mathrm{w}}$ 是特定波段的连续谱比例因子，反映了不同波段连续谱强度的差异，$\\tau_{\\min}$ 是窗区波段的一个小的正基线光学厚度。光学厚度 $\\tau_{\\mathrm{o}}$ 和 $\\tau_{\\mathrm{w}}$ 是无量纲的。\n\n为近似角度积分，使用一个固定的有效平均方向余弦 $ \\bar{\\mu} = 1 / 1.66 $ (无量纲)，这与平面平行大气中长波辐射传输的漫射近似一致。\n\n将双波段 OLR 定义为各波段贡献的总和，并将灰体气体 OLR 定义为将光谱压缩为单一光学厚度 $ \\tau_{\\mathrm{g}} $ 的情况，该光学厚度等于两个波段的普朗克加权平均光学厚度，$ \\tau_{\\mathrm{g}} = w_{\\mathrm{w}} \\tau_{\\mathrm{w}} + w_{\\mathrm{o}} \\tau_{\\mathrm{o}} $。使用差值和相对偏差来量化双波段 OLR 和灰体气体 OLR 之间的偏差，其中相对偏差是差值除以灰体气体 OLR。\n\n实现一个程序，从上述基本原理和假设出发，计算：\n- 双波段 OLR，以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位。\n- 灰体气体 OLR，以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位。\n- 相对偏差 (无量纲)，定义为双波段 OLR 减去灰体气体 OLR，再除以灰体气体 OLR。\n\n使用斯特藩-玻尔兹曼常数 $ \\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4} $，并确保所有温度 $T_{\\mathrm{sfc}}$ 和 $T_{\\mathrm{atm}}$ 均以 $\\mathrm{K}$ 为单位提供。你的程序应将两个 OLR 值四舍五入到 $3$ 位小数，并将相对偏差四舍五入到 $6$ 位小数。\n\n测试组参数值：\n- 案例 $1$ (具有中等连续谱的一般湿润情况): $T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.015$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$.\n- 案例 $2$ (无连续谱，突显窗区效应): $T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.0$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$.\n- 案例 $3$ (非常湿润且连续谱强，降低窗区透明度): $T_{\\mathrm{sfc}} = 300$, $T_{\\mathrm{atm}} = 260$, $f_{w} = 0.2$, $W = 60$, $k_{\\ell} = 0.25$, $k_{c} = 0.03$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$.\n- 案例 $4$ (大气干燥且窗区比例较大): $T_{\\mathrm{sfc}} = 290$, $T_{\\mathrm{atm}} = 250$, $f_{w} = 0.3$, $W = 5$, $k_{\\ell} = 0.25$, $k_{c} = 0.01$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$.\n- 案例 $5$ (地表和大气温度相等的边界条件): $T_{\\mathrm{sfc}} = 280$, $T_{\\mathrm{atm}} = 280$, $f_{w} = 0.2$, $W = 20$, $k_{\\ell} = 0.25$, $k_{c} = 0.015$, $\\alpha_{\\mathrm{w}} = 1.5$, $\\alpha_{\\mathrm{o}} = 1.0$, $\\tau_{\\min} = 0.02$.\n\n你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按案例排序，每个案例有三个数字：$[\\text{OLR}_{\\text{bands},1}, \\text{OLR}_{\\text{grey},1}, r_{1}, \\text{OLR}_{\\text{bands},2}, \\text{OLR}_{\\text{grey},2}, r_{2}, \\ldots, \\text{OLR}_{\\text{bands},5}, \\text{OLR}_{\\text{grey},5}, r_{5}]$。两个 OLR 值必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位报告，四舍五入到 $3$ 位小数，相对偏差必须报告为小数，四舍五入到 $6$ 位小数。",
            "solution": "该问题是有效的，因为它科学地基于大气辐射传输的既定原则，问题陈述清晰，提供了所有必要信息，并使用客观和正式的语言表达。我们开始求解。\n\n目标是为双波段光谱模型和单波段灰体气体模型推导大气层顶的向外长波辐射 (OLR) 的表达式，并对它们进行比较。大气被建模为温度为 $T_{\\mathrm{atm}}$ 的平面平行等温层，覆盖在温度为 $T_{\\mathrm{sfc}}$ 的朗伯表面之上。\n\n首先，我们推导单个光谱波段 $i$ 的向上长波通量的一般表达式。大气层顶 (TOA) 的向上强度是穿过大气的地表发射与大气自身综合发射之和。对于等温大气，沿方向余弦为 $\\mu$ (相对于天顶) 的路径的向上强度 $I_i^{\\uparrow}$ 为：\n$$\nI_i^{\\uparrow}(\\mu) = (w_i B(T_{\\mathrm{sfc}})) e^{-\\tau_i/\\mu} + (w_i B(T_{\\mathrm{atm}})) (1 - e^{-\\tau_i/\\mu})\n$$\n其中 $w_i$ 是波段 $i$ 占据的普朗克函数光谱的比例，$B(T)$ 是光谱积分的普朗克函数，$\\tau_i$ 是大气在波段 $i$ 中的垂直光学厚度，$e^{-\\tau_i/\\mu}$ 是沿斜路径的透射率。问题指出，波段积分的黑体通量为 $w_i \\sigma T^4$，这对应于 $\\pi w_i B(T)$。\n\n向上通量 (OLR) 是强度垂直分量 $I_i^{\\uparrow}(\\mu)\\mu$ 在向上的半球上的积分。问题指定使用漫射近似，该近似将角度积分替换为在单个有效平均方向余弦 $\\bar{\\mu} = 1/1.66$ 处的求值。这将通量透射率简化为 $\\mathcal{T}_i = e^{-\\tau_i / \\bar{\\mu}}$。因此，波段 $i$ 的向上通量为：\n$$\nF_i^{\\uparrow} = (w_i \\sigma T_{\\mathrm{sfc}}^4) e^{-\\tau_i / \\bar{\\mu}} + (w_i \\sigma T_{\\mathrm{atm}}^4) (1 - e^{-\\tau_i / \\bar{\\mu}})\n$$\n这个方程可以重新排列为：\n$$\nF_i^{\\uparrow} = w_i \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_i / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_i / \\bar{\\mu}}) \\right]\n$$\n这是单个波段向上通量的基本表达式。\n\n不透明 ($\\mathrm{o}$) 和窗区 ($\\mathrm{w}$) 两个波段的光学厚度表示为水汽路径 $W$ 的函数：\n$$\n\\tau_{\\mathrm{o}} = k_{\\ell} W + \\alpha_{\\mathrm{o}} k_{c} W\n$$\n$$\n\\tau_{\\mathrm{w}} = \\alpha_{\\mathrm{w}} k_{c} W + \\tau_{\\min}\n$$\n\n这些波段的光谱权重为 $w_{\\mathrm{w}} = f_w$ 和 $w_{\\mathrm{o}} = 1 - f_w$。\n\n双波段 OLR，表示为 $OLR_{\\mathrm{bands}}$，是两个波段通量之和：\n$$\nOLR_{\\mathrm{bands}} = F_{\\mathrm{w}}^{\\uparrow} + F_{\\mathrm{o}}^{\\uparrow}\n$$\n代入每个波段的通量表达式：\n$$\nOLR_{\\mathrm{bands}} = w_{\\mathrm{w}} \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{w}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{w}} / \\bar{\\mu}}) \\right] + w_{\\mathrm{o}} \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{o}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{o}} / \\bar{\\mu}}) \\right]\n$$\n\n灰体气体 OLR，表示为 $OLR_{\\mathrm{grey}}$，是通过将光谱压缩成具有普朗克加权平均光学厚度 $\\tau_{\\mathrm{g}}$ 的单个波段 ($w=1$) 来构建的：\n$$\n\\tau_{\\mathrm{g}} = w_{\\mathrm{w}} \\tau_{\\mathrm{w}} + w_{\\mathrm{o}} \\tau_{\\mathrm{o}}\n$$\n在基本通量表达式中使用此灰体光学厚度，我们得到：\n$$\nOLR_{\\mathrm{grey}} = \\sigma \\left[ T_{\\mathrm{sfc}}^4 e^{-\\tau_{\\mathrm{g}} / \\bar{\\mu}} + T_{\\mathrm{atm}}^4 (1 - e^{-\\tau_{\\mathrm{g}} / \\bar{\\mu}}) \\right]\n$$\n\n由于光学厚度与透射率之间的非线性关系，预计两种模型之间会存在偏差。透射率的普朗克加权平均值不等于普朗克加权平均光学厚度的透射率。根据 Jensen 不等式，由于函数 $f(x) = e^{-x}$ 是凸函数，函数值的加权平均值大于或等于加权平均值的函数值：\n$$\nw_{\\mathrm{w}} e^{-\\tau_{\\mathrm{w}}/\\bar{\\mu}} + w_{\\mathrm{o}} e^{-\\tau_{\\mathrm{o}}/\\bar{\\mu}} \\ge e^{-(w_{\\mathrm{w}}\\tau_{\\mathrm{w}} + w_{\\mathrm{o}}\\tau_{\\mathrm{o}})/\\bar{\\mu}}\n$$\n这意味着双波段模型的总透射率大于或等于灰体气体模型的总透射率。当 $T_{\\mathrm{sfc}} > T_{\\mathrm{atm}}$ 时，这导致 $OLR_{\\mathrm{bands}} \\ge OLR_{\\mathrm{grey}}$。灰体气体模型实际上将窗区的透明度“涂抹”到整个光谱上，从而低估了向太空的辐射冷却。\n\n相对偏差 $r$ 定义为：\n$$\nr = \\frac{OLR_{\\mathrm{bands}} - OLR_{\\mathrm{grey}}}{OLR_{\\mathrm{grey}}}\n$$\n\n计算步骤如下：\n$1$. 对于每组输入参数，计算波段光学厚度 $\\tau_{\\mathrm{w}}$ 和 $\\tau_{\\mathrm{o}}$。\n$2$. 通过对每个波段的贡献求和，计算总的双波段 OLR, $OLR_{\\mathrm{bands}}$。\n$3$. 计算灰体气体光学厚度 $\\tau_{\\mathrm{g}}$ 和相应的灰体气体 OLR, $OLR_{\\mathrm{grey}}$。\n$4$. 计算相对偏差 $r$。\n$5$. 将值四舍五入到指定的精度并格式化输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares Outgoing Longwave Radiation (OLR) using two-band\n    and grey-gas models for a series of atmospheric test cases.\n    \"\"\"\n    # Stefan-Boltzmann constant (W m^-2 K^-4)\n    SIGMA = 5.670374419e-8\n    # Effective mean direction cosine (diffusivity approximation)\n    MU_BAR = 1.0 / 1.66\n\n    # Test suite parameter values\n    # (T_sfc, T_atm, f_w, W, k_l, k_c, alpha_w, alpha_o, tau_min)\n    test_cases = [\n        (300.0, 260.0, 0.2, 20.0, 0.25, 0.015, 1.5, 1.0, 0.02),\n        (300.0, 260.0, 0.2, 20.0, 0.25, 0.0, 1.5, 1.0, 0.02),\n        (300.0, 260.0, 0.2, 60.0, 0.25, 0.03, 1.5, 1.0, 0.02),\n        (290.0, 250.0, 0.3, 5.0, 0.25, 0.01, 1.5, 1.0, 0.02),\n        (280.0, 280.0, 0.2, 20.0, 0.25, 0.015, 1.5, 1.0, 0.02),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T_sfc, T_atm, f_w, W, k_l, k_c, alpha_w, alpha_o, tau_min = case\n\n        # Weights for window and opaque bands\n        w_w = f_w\n        w_o = 1.0 - f_w\n\n        # Calculate band-mean optical depths\n        tau_o = k_l * W + alpha_o * k_c * W\n        tau_w = alpha_w * k_c * W + tau_min\n\n        # Blackbody emission fluxes from surface and atmosphere\n        B_sfc = SIGMA * T_sfc**4\n        B_atm = SIGMA * T_atm**4\n\n        # --- Two-Band OLR Calculation ---\n        # Transmittances for each band\n        trans_w = np.exp(-tau_w / MU_BAR)\n        trans_o = np.exp(-tau_o / MU_BAR)\n\n        # Flux for each band\n        F_w = w_w * (B_sfc * trans_w + B_atm * (1.0 - trans_w))\n        F_o = w_o * (B_sfc * trans_o + B_atm * (1.0 - trans_o))\n\n        olr_bands = F_w + F_o\n\n        # --- Grey-Gas OLR Calculation ---\n        # Planck-weighted average optical depth\n        tau_g = w_w * tau_w + w_o * tau_o\n\n        # Transmittance for the grey gas\n        trans_g = np.exp(-tau_g / MU_BAR)\n\n        olr_grey = B_sfc * trans_g + B_atm * (1.0 - trans_g)\n        \n        # --- Relative Deviation Calculation ---\n        # Avoid division by zero in the theoretical (but unlikely) case of olr_grey being 0\n        if olr_grey != 0:\n            relative_deviation = (olr_bands - olr_grey) / olr_grey\n        else:\n            # This case occurs if T_sfc = T_atm = 0, or if the atmosphere is infinitely opaque\n            # and T_atm = 0. If olr_bands is also 0, deviation is 0. Otherwise it's infinite.\n            # For the given test cases, this branch is not taken.\n            relative_deviation = 0.0 if olr_bands == 0.0 else np.inf\n\n        # Append rounded results for the current case\n        results.extend([\n            round(olr_bands, 3),\n            round(olr_grey, 3),\n            round(relative_deviation, 6)\n        ])\n    \n    # Format and print the final output string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "气候模型无法解析单个云，因此必须对其集体效应进行参数化。本练习深入探讨了次网格尺度云结构这一关键问题，通过代码演示了关于云垂直重叠的不同假设如何导致显著不同的辐射效应。",
            "id": "4014031",
            "problem": "考虑一个包含两个水平非均匀云层的气柱的短波辐射传输参数化方案，每个云层由其云量和短波光学厚度表征。目标是量化云重叠假设的选择如何影响大气层顶和地表的短波通量。假设大气为平行平面大气，并忽略云或气体的任何散射，即云作为纯吸收介质。地表具有朗伯反照率。太阳被视为准直光源。\n\n从沿射线的标量单色辐射传输方程开始，\n$$ \\frac{dI}{ds} = - \\kappa \\rho I, $$\n其中 $I$ 是辐亮度，$s$ 是沿射线的路径长度，$\\kappa$ 是质量消光系数，$\\rho$ 是密度。定义一个层的单色光学厚度为\n$$\\tau = \\int \\kappa \\rho \\, dz,$$\n并令太阳天顶角的余弦为 $\\mu_0 \\in (0,1]$。在上述假设下，根据 Beer–Lambert 定律，通过总光学厚度为 $\\tau_{\\text{tot}}$ 的气柱段的直射光束透过率为\n$$t = \\exp\\!\\left(-\\frac{\\tau_{\\text{tot}}}{\\mu_0}\\right)。$$\n\n设太阳常数为 $S_0$（地外辐照度），因此大气层顶的直接向下短波辐照度为 $F_{\\text{in}} = S_0 \\mu_0$，单位为瓦特/平方米 (W/m$^2$)。考虑两个云层 $i=1,2$，其云量为 $c_i \\in [0,1]$，短波光学厚度为 $\\tau_i \\ge 0$。设地表反照率为 $\\alpha_s \\in [0,1]$。将该气柱视为由子柱（状态）$s \\in \\{\\text{00}, \\text{10}, \\text{01}, \\text{11}\\}$ 组成的镶嵌体，其中两位数字分别表示第 1 层或第 2 层是有云（1）还是无云（0）。对于给定的重叠假设，每个状态 $s$ 都有一个面积分数 $p_s$ 满足 $\\sum_s p_s = 1$，以及一个总光学厚度\n$$\\tau_s = \\begin{cases}\n0  \\text{for } s=\\text{00},\\\\\n\\tau_1  \\text{for } s=\\text{10},\\\\\n\\tau_2  \\text{for } s=\\text{01},\\\\\n\\tau_1 + \\tau_2  \\text{for } s=\\text{11}.\n\\end{cases}$$\n在这些假设下，地表的区域平均向下短波辐照度为\n$$F_{\\text{sfc}}^{\\text{down}} = F_{\\text{in}} \\sum_s p_s \\exp\\!\\left(-\\frac{\\tau_s}{\\mu_0}\\right),$$\n并且，由于向上路径对每个子柱都追溯相同的吸收柱，仅由地表反射引起的大气层顶向上短波辐照度为\n$$F_{\\text{TOA}}^{\\text{up}} = \\alpha_s F_{\\text{in}} \\sum_s p_s \\exp\\!\\left(-\\frac{2\\,\\tau_s}{\\mu_0}\\right)。$$\n\n定义三种云重叠假设及相关的状态面积分数 $\\{p_s\\}$：\n\n- 随机重叠：两层中云的存在是统计独立的，\n$$p_{\\text{00}} = (1-c_1)(1-c_2),\\quad p_{\\text{10}} = c_1(1-c_2),\\quad p_{\\text{01}} = (1-c_1)c_2,\\quad p_{\\text{11}} = c_1 c_2.$$\n\n- 最大重叠：云层在水平方向上完美对齐，以使重叠面积最大化。令 $c_{\\text{hi}} = \\max(c_1,c_2)$ 且 $c_{\\text{lo}} = \\min(c_1,c_2)$。如果 $c_1 \\ge c_2$，\n$$p_{\\text{00}} = 1 - c_{\\text{hi}},\\quad p_{\\text{10}} = c_1 - c_2,\\quad p_{\\text{01}} = 0,\\quad p_{\\text{11}} = c_{\\text{lo}}.$$\n如果 $c_2 > c_1$，\n$$p_{\\text{00}} = 1 - c_{\\text{hi}},\\quad p_{\\text{10}} = 0,\\quad p_{\\text{01}} = c_2 - c_1,\\quad p_{\\text{11}} = c_{\\text{lo}}.$$\n\n- 最小重叠：在总覆盖率的约束下，云层被布置以最小化重叠面积。那么\n$$p_{\\text{11}} = \\max\\!\\big(0,\\,c_1 + c_2 - 1\\big),\\quad p_{\\text{10}} = c_1 - p_{\\text{11}},\\quad p_{\\text{01}} = c_2 - p_{\\text{11}},\\quad p_{\\text{00}} = 1 - \\min\\!\\big(1,\\,c_1 + c_2\\big)。$$\n\n对于每个测试用例，计算在三种重叠假设下地表的区域平均向下短波辐照度 $F_{\\text{sfc}}^{\\text{down}}$ 和大气层顶的向上短波辐照度 $F_{\\text{TOA}}^{\\text{up}}$。然后计算敏感性度量，定义为相对于随机重叠基线的相对范围：\n$$S_{\\text{sfc}} = \\frac{\\max\\big(F_{\\text{sfc}}^{\\text{down}}\\big) - \\min\\big(F_{\\text{sfc}}^{\\text{down}}\\big)}{F_{\\text{sfc,rand}}^{\\text{down}}},\\qquad S_{\\text{TOA}} = \\frac{\\max\\big(F_{\\text{TOA}}^{\\text{up}}\\big) - \\min\\big(F_{\\text{TOA}}^{\\text{up}}\\big)}{F_{\\text{TOA,rand}}^{\\text{up}}},$$\n其中最大值和最小值是在三种重叠假设上取得的。如果分母中的随机重叠基线为零，则按照惯例将相应的敏感性度量定义为 $0$，以避免除以零。通量 $F_{\\text{sfc}}^{\\text{down}}$ 和 $F_{\\text{TOA}}^{\\text{up}}$ 必须以瓦特/平方米 (W/m$^2$) 计算。敏感性度量 $S_{\\text{sfc}}$ 和 $S_{\\text{TOA}}$ 必须以小数（分数）形式报告，而不是百分比。\n\n使用以下参数值测试套件，每个都指定为一个元组 $(c_1,\\ \\tau_1,\\ c_2,\\ \\tau_2,\\ \\mu_0,\\ \\alpha_s)$：\n\n- 测试用例 1 (混合厚度，中等覆盖)：$(0.6,\\ 10.0,\\ 0.5,\\ 1.5,\\ 0.7,\\ 0.2)$\n- 测试用例 2 (一层缺失)：$(0.3,\\ 2.0,\\ 0.0,\\ 5.0,\\ 0.85,\\ 0.15)$\n- 测试用例 3 (两层均接近阴天)：$(0.9,\\ 5.0,\\ 0.85,\\ 3.0,\\ 0.5,\\ 0.25)$\n- 测试用例 4 (非常薄的云)：$(0.4,\\ 0.2,\\ 0.35,\\ 0.1,\\ 0.9,\\ 0.3)$\n- 测试用例 5 (极端光学厚度对比，低太阳，明亮地表)：$(0.4,\\ 50.0,\\ 0.8,\\ 5.0,\\ 0.2,\\ 0.6)$\n\n取 $S_0 = 1361$ W/m$^2$。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。列表的每个元素都必须是对应测试用例的双元素列表 $[S_{\\text{TOA}}, S_{\\text{sfc}}]$，顺序与上面相同。例如，输出格式应如下所示\n$$[[S_{\\text{TOA},1}, S_{\\text{sfc},1}], [S_{\\text{TOA},2}, S_{\\text{sfc},2}], \\ldots].$$",
            "solution": "用户提供的问题已经过严格验证，并被确定为是合理的。它在科学上基于大气辐射传输的原理，在数学上是适定的，并且没有歧义或矛盾。所有必要的数据和定义都已提供，从而可以得出一个唯一且有意义的解。该问题虽然通过忽略散射进行了简化，但在理解云结构参数化——特别是云重叠假设——对辐射通量的影响方面，是一个有效且具有指导意义的练习，这是数值天气预报和气候模拟的一个关键方面。\n\n求解过程首先将辐射通量的计算形式化，然后将此形式体系应用于每个指定的云重叠模型。核心物理原理是用于辐射衰减的 Beer-Lambert 定律，它在独立柱近似 (ICA) 的框架内应用。在 ICA 下，大气被视为由不同的、不相互作用的、各自具有均匀属性的柱组成的镶嵌体。总区域平均通量是来自每种柱类型的通量之和，并按其各自的面积分数进行加权。\n\n设两层大气柱的四种可能状态集合为 $s \\in \\{\\text{00}, \\text{10}, \\text{01}, \\text{11}\\}$，其中数字分别表示第 1 层和第 2 层中云的缺失 (0) 或存在 (1)。对于每个状态 $s$，都有一个相关的面积分数 $p_s$ 和一个总垂直光学厚度 $\\tau_s$。提供的光学厚度为：$\\tau_{00}=0$、$\\tau_{10}=\\tau_1$、$\\tau_{01}=\\tau_2$ 和 $\\tau_{11}=\\tau_1+\\tau_2$。\n\n大气层顶的入射太阳辐照度由 $F_{\\text{in}} = S_0 \\mu_0$ 给出，其中 $S_0 = 1361.0 \\, \\text{W/m}^2$ 是太阳常数，$\\mu_0$ 是太阳天顶角的余弦。\n\n地表的向下短波辐照度 $F_{\\text{sfc}}^{\\text{down}}$ 是通过每个柱状态的透射辐照度的面积加权和。单个柱状态 $s$ 的透过率为 $t_s = \\exp(-\\tau_s/\\mu_0)$。\n$$F_{\\text{sfc}}^{\\text{down}} = F_{\\text{in}} \\sum_{s} p_s t_s = F_{\\text{in}} \\sum_{s} p_s \\exp\\left(-\\frac{\\tau_s}{\\mu_0}\\right)$$\n\n由地表反射引起的大气层顶向上短波辐照度 $F_{\\text{TOA}}^{\\text{up}}$ 必须考虑向下和向上路径上的衰减。对于反照率为 $\\alpha_s$ 的朗伯表面，上行辐射经历相同的反向光程。因此，双程透过率为 $t_s^2 = \\exp(-2\\tau_s/\\mu_0)$。\n$$F_{\\text{TOA}}^{\\text{up}} = \\alpha_s F_{\\text{in}} \\sum_{s} p_s t_s^2 = \\alpha_s F_{\\text{in}} \\sum_{s} p_s \\exp\\left(-\\frac{2\\tau_s}{\\mu_0}\\right)$$\n\n问题要求在三种不同的云重叠假设下评估这些通量，这些假设由其对面积分数 $\\{p_s\\}$ 的规定来定义：\n\n1.  **随机重叠**：假设两层中云的存在是统计上独立的。联合概率是单个概率的乘积（云量 $c_i$ 表示第 $i$ 层存在云的概率）。\n    -   $p_{\\text{00}} = (1-c_1)(1-c_2)$\n    -   $p_{\\text{10}} = c_1(1-c_2)$\n    -   $p_{\\text{01}} = (1-c_1)c_2$\n    -   $p_{\\text{11}} = c_1 c_2$\n\n2.  **最大重叠**：假设云场的布置使其重叠面积最大化。这对应于一个云层是另一个云层的水平子集。例如，如果 $c_1 \\ge c_2$，则第 2 层中的云完全包含在第 1 层云的水平范围内。\n    -   如果 $c_1 \\ge c_2$：$p_{\\text{11}} = c_2$, $p_{\\text{10}} = c_1 - c_2$, $p_{\\text{01}} = 0$, $p_{\\text{00}} = 1 - c_1$。\n    -   如果 $c_2 > c_1$：$p_{\\text{11}} = c_1$, $p_{\\text{10}} = 0$, $p_{\\text{01}} = c_2 - c_1$, $p_{\\text{00}} = 1 - c_2$。\n\n3.  **最小重叠**：假设云场的布置使其重叠面积最小化。在总域面积的约束下，云尽可能地水平位移。\n    -   $p_{\\text{11}} = \\max(0, c_1 + c_2 - 1)$\n    -   $p_{\\text{10}} = c_1 - p_{\\text{11}}$\n    -   $p_{\\text{01}} = c_2 - p_{\\text{11}}$\n    -   $p_{\\text{00}} = 1 - (p_{\\text{10}} + p_{\\text{01}} + p_{\\text{11}})$\n\n每个测试用例的计算算法如下：\n首先，对于给定的一组参数 $(c_1, \\tau_1, c_2, \\tau_2, \\mu_0, \\alpha_s)$，确定输入辐照度 $F_{\\text{in}}$ 和四种状态的光学厚度 $\\tau_s$。\n其次，为三种重叠假设（随机、最大、最小）中的每一种计算面积分数 $\\{p_s\\}$。\n第三，使用这些面积分数集，利用上述方程计算出三对相应的通量 $(F_{\\text{sfc}}^{\\text{down}}, F_{\\text{TOA}}^{\\text{up}})$。\n最后，计算敏感性度量 $S_{\\text{sfc}}$ 和 $S_{\\text{TOA}}$。这些被定义为三种重叠模型中的通量值范围（最大值减去最小值），并用随机重叠情况下的通量进行归一化。\n$$S_{\\text{sfc}} = \\frac{\\max(F_{\\text{sfc,rand}}^{\\text{down}}, F_{\\text{sfc,max}}^{\\text{down}}, F_{\\text{sfc,min}}^{\\text{down}}) - \\min(F_{\\text{sfc,rand}}^{\\text{down}}, F_{\\text{sfc,max}}^{\\text{down}}, F_{\\text{sfc,min}}^{\\text{down}})}{F_{\\text{sfc,rand}}^{\\text{down}}}$$\n$$S_{\\text{TOA}} = \\frac{\\max(F_{\\text{TOA,rand}}^{\\text{up}}, F_{\\text{TOA,max}}^{\\text{up}}, F_{\\text{TOA,min}}^{\\text{up}}) - \\min(F_{\\text{TOA,rand}}^{\\text{up}}, F_{\\text{TOA,max}}^{\\text{up}}, F_{\\text{TOA,min}}^{\\text{up}})}{F_{\\text{TOA,rand}}^{\\text{up}}}$$\n如果分母为零，则各自的敏感性定义为 $0$。对问题陈述中提供的每个测试用例重复此整个过程。该实现将利用 `numpy` 库进行高效的数组操作。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the atmospheric radiation problem for all test cases.\n    \"\"\"\n    \n    # Define the constant parameters.\n    S0 = 1361.0  # Solar constant in W/m^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c1, tau1, c2, tau2, mu0, alpha_s)\n    test_cases = [\n        (0.6, 10.0, 0.5, 1.5, 0.7, 0.2),   # Test case 1\n        (0.3, 2.0, 0.0, 5.0, 0.85, 0.15),  # Test case 2\n        (0.9, 5.0, 0.85, 3.0, 0.5, 0.25),  # Test case 3\n        (0.4, 0.2, 0.35, 0.1, 0.9, 0.3),   # Test case 4\n        (0.4, 50.0, 0.8, 5.0, 0.2, 0.6),   # Test case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(calculate_sensitivity_for_case(case, S0))\n\n    # Final print statement in the exact required format.\n    # The default str() representation for a list includes spaces, which is acceptable.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_sensitivity_for_case(case, S0):\n    \"\"\"\n    Computes the sensitivity metrics S_TOA and S_sfc for a single test case.\n    \n    Args:\n        case (tuple): A tuple containing the parameters (c1, tau1, c2, tau2, mu0, alpha_s).\n        S0 (float): The solar constant.\n        \n    Returns:\n        list: A list containing [S_TOA, S_sfc].\n    \"\"\"\n    c1, tau1, c2, tau2, mu0, alpha_s = case\n    \n    # Calculate incoming shortwave irradiance\n    F_in = S0 * mu0\n\n    # Define optical depths for the four states: {00, 10, 01, 11}\n    # where 00 is clear-clear, 10 is cloud-clear, etc.\n    taus = np.array([\n        0.0,\n        tau1,\n        tau2,\n        tau1 + tau2\n    ])\n\n    # Calculate transmittance terms for one-way (surface) and two-way (TOA) paths\n    trans_sfc = np.exp(-taus / mu0)\n    trans_toa = np.exp(-2.0 * taus / mu0)\n\n    # Store fluxes for each overlap assumption\n    fluxes_sfc = {}\n    fluxes_toa = {}\n\n    # === 1. Random Overlap ===\n    p_rand = np.array([\n        (1.0 - c1) * (1.0 - c2),  # p_00\n        c1 * (1.0 - c2),          # p_10\n        (1.0 - c1) * c2,          # p_01\n        c1 * c2                   # p_11\n    ])\n    fluxes_sfc['rand'] = F_in * np.sum(p_rand * trans_sfc)\n    fluxes_toa['rand'] = alpha_s * F_in * np.sum(p_rand * trans_toa)\n\n    # === 2. Maximum Overlap ===\n    p_max = np.zeros(4)\n    if c1 >= c2:\n        p_max[0] = 1.0 - c1      # p_00\n        p_max[1] = c1 - c2       # p_10\n        p_max[2] = 0.0           # p_01\n        p_max[3] = c2            # p_11\n    else:  # c2 > c1\n        p_max[0] = 1.0 - c2      # p_00\n        p_max[1] = 0.0           # p_10\n        p_max[2] = c2 - c1       # p_01\n        p_max[3] = c1            # p_11\n    fluxes_sfc['max'] = F_in * np.sum(p_max * trans_sfc)\n    fluxes_toa['max'] = alpha_s * F_in * np.sum(p_max * trans_toa)\n\n    # === 3. Minimum Overlap ===\n    p11_min = max(0.0, c1 + c2 - 1.0)\n    p_min = np.array([\n        1.0 - min(1.0, c1 + c2),  # p_00\n        c1 - p11_min,             # p_10\n        c2 - p11_min,             # p_01\n        p11_min                   # p_11\n    ])\n    fluxes_sfc['min'] = F_in * np.sum(p_min * trans_sfc)\n    fluxes_toa['min'] = alpha_s * F_in * np.sum(p_min * trans_toa)\n\n    # === Calculate Sensitivity Metrics ===\n    \n    # Surface flux sensitivity\n    f_sfc_values = list(fluxes_sfc.values())\n    f_sfc_rand_baseline = fluxes_sfc['rand']\n    if f_sfc_rand_baseline == 0.0:\n        s_sfc = 0.0\n    else:\n        s_sfc = (max(f_sfc_values) - min(f_sfc_values)) / f_sfc_rand_baseline\n        \n    # TOA flux sensitivity\n    f_toa_values = list(fluxes_toa.values())\n    f_toa_rand_baseline = fluxes_toa['rand']\n    if f_toa_rand_baseline == 0.0:\n        s_toa = 0.0\n    else:\n        s_toa = (max(f_toa_values) - min(f_toa_values)) / f_toa_rand_baseline\n\n    return [s_toa, s_sfc]\n\n# Execute the solution\nsolve()\n```"
        }
    ]
}