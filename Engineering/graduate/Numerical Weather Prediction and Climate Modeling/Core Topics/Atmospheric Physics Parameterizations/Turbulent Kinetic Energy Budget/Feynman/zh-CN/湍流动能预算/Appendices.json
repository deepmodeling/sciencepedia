{
    "hands_on_practices": [
        {
            "introduction": "在分析完整的湍流动能 (TKE) 收支之前，我们必须首先掌握如何根据其基本定义来计算 TKE 本身。这个练习将帮助你巩固 TKE 的核心概念，即它由三个方向的速度脉动方差构成。通过这个实践，你将从给定的速度方差廓线推导出 TKE 的垂直分布，并探索其在大气边界层近地层中的标度行为，这对于理解湍流与地表的相互作用至关重要 。",
            "id": "4106464",
            "problem": "在数值天气预报和气候模拟中，大气表面层的参数化方案通常假设流动是水平均匀、定常、中性层结的，并且湍流动能收支在局部达到平衡。考虑这样一个表面层，其下方为粗糙表面，粗糙度长度为 $z_0$，摩擦速度 $u_*$ 由地表切应力定义。给定以下关于流向、展向和垂直速度方差随 $z$ 变化的理想化、基于经验的垂直廓线：\n$$\\overline{u'u'}(z) \\;=\\; a_u\\,u_*^2\\,\\frac{z/\\lambda}{1+z/\\lambda}, \\qquad \\overline{v'v'}(z) \\;=\\; a_v\\,u_*^2\\,\\frac{z/\\lambda}{1+z/\\lambda}, \\qquad \\overline{w'w'}(z) \\;=\\; a_w\\,u_*^2\\,\\frac{z/\\lambda}{1+z/\\lambda},$$\n其中 $a_u$、$a_v$ 和 $a_w$ 是正常数，$\\lambda$ 是与 $z_0$ 成正比的表面层过渡长度尺度。假设整个区域内为中性层结和水平均匀。设 $a_u=2.40$，$a_v=1.90$，$a_w=1.25$，$z_0=0.03\\,\\mathrm{m}$，以及 $\\lambda=30\\,z_0$。\n\n仅从单位质量湍流动能的基本定义和给定的方差廓线出发，推导垂直廓线 $k(z)$ 的显式表达式，并构建无量纲比率 $F(z) = k(z)/u_*^2$。然后，将惯性子层标度系数 $C_k$ 定义为渐近极限 $C_k = \\lim_{z/\\lambda \\to \\infty} F(z)$，该系数表征了近地表区域随摩擦速度 $u_*$ 的标度律。利用给定的常数，计算 $C_k$ 的数值。\n\n将最终的 $C_k$ 值四舍五入至四位有效数字。将最终系数表示为一个纯数（无量纲）。",
            "solution": "用户希望我解决一个问题，该问题要求基于中性层结大气表面层中给定的速度方差经验廓线，推导湍流动能（TKE）廓线 $k(z)$、其无量纲形式 $F(z) = k(z)/u_*^2$，以及其渐近极限 $C_k = \\lim_{z/\\lambda \\to \\infty} F(z)$ 的数值。\n\n### 步骤 1：问题验证\n\n首先，我必须根据指定的协议验证问题陈述。\n\n**1.1. 提取已知条件**\n- **系统**：一个水平均匀、定常、中性层结的大气表面层。\n- **表面属性**：粗糙度长度 $z_0$，摩擦速度 $u_*$。\n- **速度方差廓线**：\n  $$ \\overline{u'u'}(z) = a_u u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n  $$ \\overline{v'v'}(z) = a_v u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n  $$ \\overline{w'w'}(z) = a_w u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n- **常数**：\n  - $a_u = 2.40$ (无量纲)\n  - $a_v = 1.90$ (无量纲)\n  - $a_w = 1.25$ (无量纲)\n- **长度尺度**：\n  - $z_0 = 0.03\\,\\mathrm{m}$\n  - $\\lambda = 30 z_0$\n- **定义**：\n  - 单位质量的湍流动能：$k(z)$。\n  - 无量纲比率：$F(z) = k(z)/u_*^2$。\n  - 惯性子层标度系数：$C_k = \\lim_{z/\\lambda \\to \\infty} F(z)$。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地植根于大气边界层物理学和湍流理论领域。湍流动能、摩擦速度、粗糙度长度以及雷诺平均速度分量方差等概念是该领域的基础。所假设的方差函数形式，即从近地表的随高度线性变化过渡到更高处的恒定值，是表面层的标准经验模型。\n- **良定性**：该问题是良定的。它提供了所有必要的定义、方程和常数，以唯一地确定所要求的量。推导 $k(z)$、构建 $F(z)$ 以及计算渐近极限 $C_k$ 这些任务在数学上和物理上都是有意义的。\n- **客观性**：问题以精确、客观的语言陈述。没有主观或基于意见的陈述。\n- **完整性与一致性**：问题提供了所有必要信息，并且内部一致。参数 $z_0$ 和关系式 $\\lambda=30\\,z_0$ 为所涉及的长度尺度提供了背景，但对于计算渐近系数 $C_k$ 并非绝对必要，这与渐近极限的性质相符。\n\n**1.3. 结论与行动**\n该问题有效。它在科学上是合理的、良定的且完整的。我将继续进行求解。\n\n### 步骤 2：求解推导\n\n根据问题的要求，求解过程分为三个部分：推导 $k(z)$、构建 $F(z)$ 以及计算渐近系数 $C_k$。\n\n**第 1 部分：推导 TKE 廓线 $k(z)$**\n\n单位质量的湍流动能 $k$ 定义为雷诺应力张量迹的一半。对于速度分量为 $(u, v, w)$ 的三维流动，速度脉动为 $(u', v', w')$，TKE 由下式给出：\n$$ k(z) = \\frac{1}{2} \\left( \\overline{u'u'}(z) + \\overline{v'v'}(z) + \\overline{w'w'}(z) \\right) $$\n我们已知三个雷诺正应力（速度方差）的表达式：\n$$ \\overline{u'u'}(z) = a_u u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n$$ \\overline{v'v'}(z) = a_v u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n$$ \\overline{w'w'}(z) = a_w u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n将这些表达式代入 $k(z)$ 的定义中：\n$$ k(z) = \\frac{1}{2} \\left( a_u u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} + a_v u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} + a_w u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} \\right) $$\n我们可以提取公因式 $u_*^2$ 和 $\\frac{z/\\lambda}{1+z/\\lambda}$：\n$$ k(z) = \\frac{1}{2} (a_u + a_v + a_w) u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} $$\n这就是单位质量湍流动能垂直廓线 $k(z)$ 的显式表达式。\n\n**第 2 部分：构建无量纲比率 $F(z)$**\n\n问题将无量纲比率 $F(z)$ 定义为 $k(z)/u_*^2$。使用上面推导出的 $k(z)$ 表达式：\n$$ F(z) = \\frac{k(z)}{u_*^2} = \\frac{1}{u_*^2} \\left[ \\frac{1}{2} (a_u + a_v + a_w) u_*^2 \\frac{z/\\lambda}{1+z/\\lambda} \\right] $$\n摩擦速度项 $u_*^2$ 消去，得到无量纲廓线：\n$$ F(z) = \\frac{1}{2} (a_u + a_v + a_w) \\frac{z/\\lambda}{1+z/\\lambda} $$\n\n**第 3 部分：计算惯性子层标度系数 $C_k$**\n\n惯性子层标度系数 $C_k$ 定义为当 $z/\\lambda$ 很大时 $F(z)$ 的渐近极限：\n$$ C_k = \\lim_{z/\\lambda \\to \\infty} F(z) $$\n代入 $F(z)$ 的表达式：\n$$ C_k = \\lim_{z/\\lambda \\to \\infty} \\left[ \\frac{1}{2} (a_u + a_v + a_w) \\frac{z/\\lambda}{1+z/\\lambda} \\right] $$\n项 $\\frac{1}{2} (a_u + a_v + a_w)$ 是一个与极限无关的常数。因此，我们可以写成：\n$$ C_k = \\frac{1}{2} (a_u + a_v + a_w) \\lim_{z/\\lambda \\to \\infty} \\left( \\frac{z/\\lambda}{1+z/\\lambda} \\right) $$\n为了计算该极限，我们可以令 $\\zeta = z/\\lambda$。极限变为：\n$$ \\lim_{\\zeta \\to \\infty} \\frac{\\zeta}{1+\\zeta} $$\n分子和分母同时除以 $\\zeta$：\n$$ \\lim_{\\zeta \\to \\infty} \\frac{\\zeta/\\zeta}{(1/\\zeta)+(\\zeta/\\zeta)} = \\lim_{\\zeta \\to \\infty} \\frac{1}{(1/\\zeta)+1} $$\n当 $\\zeta \\to \\infty$ 时，项 $1/\\zeta \\to 0$。因此，极限为：\n$$ \\frac{1}{0+1} = 1 $$\n将此结果代回 $C_k$ 的表达式：\n$$ C_k = \\frac{1}{2} (a_u + a_v + a_w) \\times 1 = \\frac{1}{2} (a_u + a_v + a_w) $$\n这个结果表明，无量纲 TKE 的渐近值是无量纲方差渐近值之和的一半。\n\n**第 4 部分：数值计算**\n\n现在，我们代入常数 $a_u$、$a_v$ 和 $a_w$ 的给定数值：\n- $a_u = 2.40$\n- $a_v = 1.90$\n- $a_w = 1.25$\n$$ C_k = \\frac{1}{2} (2.40 + 1.90 + 1.25) $$\n$$ C_k = \\frac{1}{2} (5.55) $$\n$$ C_k = 2.775 $$\n问题要求最终答案保留四位有效数字。计算出的值 $2.775$ 已经有四位有效数字，因此无需进一步四舍五入。系数 $C_k$ 是无量纲的，符合要求。",
            "answer": "$$\\boxed{2.775}$$"
        },
        {
            "introduction": "TKE 收支方程包含了许多无法被模式直接解析的项，因此必须进行参数化。本练习聚焦于 TKE 垂直输运项，这是理解边界层内能量如何重新分布的关键过程。你将应用一个经典的“下梯度”扩散模型来估算该项对 TKE 局地变化的贡献，这是大气和气候模式中湍流闭合方案的基石 。",
            "id": "4106453",
            "problem": "考虑一个水平均匀、中性层结的大气边界层，其受 Boussinesq 近似下的雷诺平均纳维-斯托克斯 (RANS) 方程控制。湍流动能 (TKE) 定义为 $k = \\frac{1}{2}\\langle u_i' u_i' \\rangle$，其中 $\\langle \\cdot \\rangle$ 表示系综平均，$u_i'$ 是速度脉动。在一维（仅垂直方向）情况下，局地 TKE 收支包含一个垂直输送项，表示为 TKE 通量的散度，记为 $\\partial F_k / \\partial z$。给定一个观测到的 TKE 廓线的平滑拟合\n$$\nk(z) = k_0 \\exp\\!\\left(-\\frac{z}{H}\\right),\n$$\n其中 $k_0 = 0.5\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$ 且 $H = 150\\,\\mathrm{m}$，在 $z \\in [0, 500]\\,\\mathrm{m}$ 范围内有效。为闭合输送项，采用 TKE 通量的顺梯度模型，\n$$\nF_k = -K_k(z)\\,\\frac{\\partial k}{\\partial z},\n$$\n其中 TKE 的涡动扩散系数 $K_k(z)$ 由混合长度公式给出\n$$\nK_k(z) = c_k\\,\\kappa\\,z\\,\\sqrt{k(z)},\n$$\n其中 $c_k = 0.25$ 是一个无量纲常数，$\\kappa = 0.4$ 是 von Kármán 常数。使用这些输入，并从适用于 RANS TKE 收支的第一性原理出发，推导垂直输送对局地 TKE 趋势的贡献的表达式，即 $-\\partial F_k/\\partial z$，并在高度 $z_* = 60\\,\\mathrm{m}$ 处计算其值。报告在 $z_*$ 处 $-\\partial F_k/\\partial z$ 的最终数值，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$，并四舍五入到三位有效数字。",
            "solution": "目标是推导垂直输送对局地湍流动能 (TKE) 趋势的贡献表达式 $-\\frac{\\partial F_k}{\\partial z}$，并在特定高度 $z_*$ 处计算其值。题目提供了所有必要的定义和参数化方案。\n\nTKE 通量 $F_k$ 由顺梯度模型给出：\n$$F_k(z) = -K_k(z)\\,\\frac{\\partial k}{\\partial z}$$\n其中 $K_k(z)$ 是 TKE 的涡动扩散系数，$k(z)$ 是 TKE 廓线。我们感兴趣的量，即由垂直输送引起的 TKE 趋势，是该通量的负散度，在一维情况下为：\n$$-\\frac{\\partial F_k}{\\partial z} = -\\frac{\\partial}{\\partial z}\\left(-K_k(z)\\,\\frac{\\partial k}{\\partial z}\\right) = \\frac{\\partial}{\\partial z}\\left(K_k(z)\\,\\frac{\\partial k}{\\partial z}\\right)$$\n推导过程分步如下。\n\n首先，我们使用给定的廓线 $k(z) = k_0 \\exp(-z/H)$ 计算 TKE 的垂直梯度 $\\frac{\\partial k}{\\partial z}$：\n$$\\frac{\\partial k}{\\partial z} = \\frac{d}{dz}\\left(k_0 \\exp\\left(-\\frac{z}{H}\\right)\\right) = k_0 \\left(-\\frac{1}{H}\\right) \\exp\\left(-\\frac{z}{H}\\right) = -\\frac{k_0}{H} \\exp\\left(-\\frac{z}{H}\\right)$$\n这也可以用局地 TKE 表示为 $\\frac{\\partial k}{\\partial z} = -\\frac{k(z)}{H}$。\n\n其次，我们使用给定的混合长度公式并代入 TKE 廓线，写出涡动扩散系数 $K_k(z)$ 的表达式：\n$$K_k(z) = c_k\\,\\kappa\\,z\\,\\sqrt{k(z)}$$\n$$K_k(z) = c_k\\,\\kappa\\,z\\,\\sqrt{k_0 \\exp\\left(-\\frac{z}{H}\\right)} = c_k\\,\\kappa\\,z\\,\\sqrt{k_0} \\exp\\left(-\\frac{z}{2H}\\right)$$\n\n第三，我们构造乘积 $K_k(z) \\frac{\\partial k}{\\partial z}$，它代表 TKE 通量（符号除外）：\n$$K_k(z)\\,\\frac{\\partial k}{\\partial z} = \\left(c_k\\,\\kappa\\,z\\,\\sqrt{k_0} \\exp\\left(-\\frac{z}{2H}\\right)\\right) \\left(-\\frac{k_0}{H} \\exp\\left(-\\frac{z}{H}\\right)\\right)$$\n合并各项，我们得到：\n$$K_k(z)\\,\\frac{\\partial k}{\\partial z} = -\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H}\\,z\\,\\exp\\left(-\\frac{z}{2H} - \\frac{z}{H}\\right) = -\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H}\\,z\\,\\exp\\left(-\\frac{3z}{2H}\\right)$$\n\n第四，我们对该乘积关于 $z$ 求导以求得 TKE 趋势。这需要应用乘法求导法则 $\\frac{d}{dx}(uv) = u\\frac{dv}{dx} + v\\frac{du}{dx}$：\n$$-\\frac{\\partial F_k}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(-\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H}\\,z\\,\\exp\\left(-\\frac{3z}{2H}\\right)\\right)$$\n我们先单独处理常数系数：\n$$-\\frac{\\partial F_k}{\\partial z} = -\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H} \\left[ \\frac{d}{dz}(z) \\cdot \\exp\\left(-\\frac{3z}{2H}\\right) + z \\cdot \\frac{d}{dz}\\left(\\exp\\left(-\\frac{3z}{2H}\\right)\\right) \\right]$$\n$$-\\frac{\\partial F_k}{\\partial z} = -\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H} \\left[ (1) \\cdot \\exp\\left(-\\frac{3z}{2H}\\right) + z \\cdot \\left(-\\frac{3}{2H}\\right) \\exp\\left(-\\frac{3z}{2H}\\right) \\right]$$\n提取指数项，得到最终的解析表达式：\n$$-\\frac{\\partial F_k}{\\partial z} = -\\frac{c_k\\,\\kappa\\,k_0^{3/2}}{H} \\left(1 - \\frac{3z}{2H}\\right) \\exp\\left(-\\frac{3z}{2H}\\right)$$\n\n最后，我们使用给定的常数 $k_0 = 0.5\\,\\mathrm{m^2\\,s^{-2}}$、$H = 150\\,\\mathrm{m}$、$c_k = 0.25$ 和 $\\kappa = 0.4$，在高度 $z_* = 60\\,\\mathrm{m}$ 处计算该表达式的值。\n\n我们首先计算相关的无量纲群：\n闭合常数的乘积为 $c_k\\,\\kappa = 0.25 \\times 0.4 = 0.1$。\n无量纲高度群为 $\\frac{z_*}{H} = \\frac{60}{150} = 0.4$。\n括号中的项变为 $1 - \\frac{3z_*}{2H} = 1 - \\frac{3}{2}(0.4) = 1 - 0.6 = 0.4$。\n指数的参数为 $-\\frac{3z_*}{2H} = -\\frac{3}{2}(0.4) = -0.6$。\n\n将这些值代入推导出的表达式中：\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} = -\\frac{(0.1) \\cdot (0.5)^{3/2}}{150} \\cdot (0.4) \\cdot \\exp(-0.6)$$\n该量的单位是 $\\mathrm{m^2\\,s^{-3}}$。我们来计算其数值：\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} \\approx -\\frac{0.1 \\cdot 0.353553}{150} \\cdot 0.4 \\cdot 0.548812$$\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} \\approx -(2.35702 \\times 10^{-4}) \\cdot 0.4 \\cdot 0.548812$$\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} \\approx -(9.42809 \\times 10^{-5}) \\cdot 0.548812$$\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} \\approx -5.1746 \\times 10^{-5}$$\n按要求将结果四舍五入到三位有效数字：\n$$-\\frac{\\partial F_k}{\\partial z}\\bigg|_{z=z_*} \\approx -5.17 \\times 10^{-5}\\,\\mathrm{m^2\\,s^{-3}}$$",
            "answer": "$$\\boxed{-5.17 \\times 10^{-5}}$$"
        },
        {
            "introduction": "将连续的 TKE 方程转化为离散的数值算法会带来一系列挑战，特别是在处理源汇项时。这个练习探讨了与 TKE 收支中最强的汇项——耗散率 $\\epsilon$ ——相关的数值困难。通过分析不同的时间积分方案，你将理解为什么简单的显式格式可能会导致非物理的负 TKE 值，并认识到保证 TKE 正定性所需的特殊数值处理技术的重要性 。",
            "id": "4106429",
            "problem": "考虑一个在数值天气预报 (NWP) 和气候模拟中使用的湍流动能 (TKE) 收支的单柱模式实现。设湍流动能定义为 $k = \\tfrac{1}{2} \\overline{u_{i}^{\\prime} u_{i}^{\\prime}}$，由于其是方差，这强制了物理约束 $k \\ge 0$。用 $\\epsilon$ 表示耗散率，并考虑一个广泛使用的闭合方案 $\\epsilon = C_{\\epsilon} k^{3/2}/\\ell$，其中 $C_{\\epsilon} > 0$ 是一个常数，$\\ell > 0$ 是混合长。设 $k$ 的预报方程示意性地写作\n$$\n\\partial_{t} k = P - \\epsilon + \\nabla \\cdot \\left( K_{k} \\nabla k \\right) - \\nabla \\cdot \\left( \\boldsymbol{u} k \\right) ,\n$$\n其中 $P$ 集合了切变和浮力产生项，$K_{k} \\ge 0$ 是一个涡动扩散系数，$\\boldsymbol{u}$ 是解析流速。假设时间积分对 $P$ 和输运项使用单步显式处理，并考虑如何处理刚性汇项 $\\epsilon$ 的决策。在实践中，确保 $k \\ge 0$ 的两种常见策略是：隐式处理 $\\epsilon$（可能通过围绕已知状态进行线性化），或者当更新将导致 $k  0$ 时将 $k$ 裁剪到一个微小的正数下限。\n\n从 $k$ 作为方差的物理定义、上述示意性收支方程以及闭合方案 $\\epsilon = C_{\\epsilon} k^{3/2}/\\ell$ 出发，在一个时间步长内，对单个柱点上 $k$ 的离散时间行为进行推理。除了已声明的对 $P$ 和输运项的显式处理外，不假设任何特定的数值公式，利用闭合方案所隐含的湍流耗散时间尺度 $\\tau$ 满足 $\\tau \\sim \\ell / \\sqrt{k}$ 这一事实，可知当 $k$ 很小或 $\\ell$ 很小时，$\\epsilon$ 可能是刚性的。然后回答以下关于两种策略的正定性保持和数值伪影的多项选择题。\n\n下列哪个陈述是正确的？\n\nA. 在给定的柱点上，对汇项 $\\epsilon$ 进行时间前向显式处理时，存在某些状态，使得单个时间步长会产生 $k^{n+1}  0$，除非时间步长 $\\Delta t$ 受到涉及 $\\epsilon^{n}$ 的条件的限制，或者 $\\epsilon$ 被隐式处理；因此，保持正定性通常需要对 $\\epsilon$ 进行隐式处理或对 $k$ 进行裁剪。\n\nB. 隐式处理 $\\epsilon$ 会引入无条件阻尼，从而降低切变产生项 $P$ 的精度并延迟湍流的发生；然而，它保持了可微性和精确的能量核算，而裁剪则保持了离散系统的精度和可微性。\n\nC. 当预测到负更新时，将 $k$ 裁剪到一个微小的正数下限可以消除负值而不改变离散收支，因此它对伴随敏感性或参数估计的影响可以忽略不计。\n\nD. 如果 $\\epsilon$ 参数化为 $\\epsilon = C_{\\epsilon} k^{3/2}/\\ell$，一个将汇项替换为线性化项 $- \\alpha \\, k^{n+1}$（其中 $\\alpha \\ge 0$ 从已知场计算）的半隐式离散化方案能确保 $k^{n+1} \\ge 0$，并且可以看作是对一个线性化耗散算子应用的后向欧拉步。\n\nE. 在存在可压缩性和垂直扩散的情况下，使用单调平流-扩散格式能自动保证对任何时间步长都有 $k \\ge 0$，从而使得对 $\\epsilon$ 的特殊处理变得不必要。",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n-   湍流动能 (TKE): $k = \\tfrac{1}{2} \\overline{u_{i}^{\\prime} u_{i}^{\\prime}}$，具有物理约束 $k \\ge 0$。\n-   $k$ 的预报方程：$\\partial_{t} k = P - \\epsilon + \\nabla \\cdot \\left( K_{k} \\nabla k \\right) - \\nabla \\cdot \\left( \\boldsymbol{u} k \\right)$。\n-   $P$: 切变和浮力产生项。\n-   $\\epsilon$: 湍流耗散率，一个汇项。\n-   $\\nabla \\cdot (K_k \\nabla k)$: 涡动扩散，其中 $K_k \\ge 0$。\n-   $\\nabla \\cdot (\\boldsymbol{u} k)$: 由解析流 $\\boldsymbol{u}$ 引起的平流。\n-   耗散闭合方案：$\\epsilon = C_{\\epsilon} k^{3/2}/\\ell$，其中 $C_{\\epsilon}  0$ 且 $\\ell  0$。\n-   时间积分方法：产生项 ($P$) 和输运项 (平流和扩散) 使用单步显式方法处理。汇项 $\\epsilon$ 的处理是本题的主题。\n-   刚性：耗散时间尺度 $\\tau \\sim \\ell / \\sqrt{k}$ 意味着当 $k$ 很小或 $\\ell$ 很小时，汇项 $\\epsilon$ 是刚性的。\n-   保持正定性的策略：对 $\\epsilon$ 进行隐式处理或对 $k$ 进行裁剪。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。TKE 收支方程是计算流体力学中湍流模拟的基石，包括其在数值天气预报 (NWP) 和气候科学中的应用。所给出的方程示意形式、$k$ 的定义、广泛使用的耗散闭合方案 $k^{3/2}/\\ell$ 以及关于数值刚性的讨论都是标准的且事实上是正确的。\n\n该问题是适定且客观的。它针对一个刚性常微分方程的不同时间步进策略的数值性质，提出了一个清晰、可形式化的问题。语言精确，不包含主观或模糊的元素。问题设置是自洽的，并提供了分析所述数值行为所需的所有必要信息。\n\n### 步骤 3：结论和行动\n问题有效。我现在将进行完整的推导和分析。\n\n### 推导和逐项分析\n\n让我们分析在单个点上的 TKE 方程的时间离散化形式。该方程可以写成：\n$$ \\frac{dk}{dt} = F_{exp}(k) - \\epsilon(k) $$\n其中 $F_{exp}(k)$ 代表所有显式处理的项的集合，即产生项 $P$ 和离散化的输运算子。我们用 $k^n$ 表示当前时间步 $n$ 的值，用 $k^{n+1}$ 表示下一个时间步 $n+1$ 的值。时间步长为 $\\Delta t  0$。由于 $F_{exp}$ 是显式处理的，其对时间更新的贡献是 $\\Delta t F_{exp}(k^n)$。\n\n**选项 A 分析：**\n该选项考虑对汇项 $\\epsilon$ 进行完全显式（时间前向）处理。离散化方程为：\n$$ \\frac{k^{n+1} - k^n}{\\Delta t} = F_{exp}(k^n) - \\epsilon(k^n) $$\n$$ k^{n+1} = k^n + \\Delta t F_{exp}(k^n) - \\Delta t \\epsilon(k^n) $$\n为使 $k^{n+1}$ 非负，我们必须有 $k^n + \\Delta t F_{exp}(k^n) - \\Delta t \\epsilon(k^n) \\ge 0$。考虑一个产生项和输运项可忽略的状态，即 $F_{exp}(k^n) \\approx 0$。保持正定性的条件变为 $k^n - \\Delta t \\epsilon(k^n) \\ge 0$。代入 $\\epsilon$ 的闭合方案：\n$$ k^n \\ge \\Delta t \\frac{C_{\\epsilon} (k^n)^{3/2}}{\\ell} $$\n对于 $k^n  0$，我们可以重新整理得到关于时间步长 $\\Delta t$ 的一个条件：\n$$ \\Delta t \\le \\frac{\\ell}{C_{\\epsilon} \\sqrt{k^n}} $$\n右边的项与湍流耗散时间尺度 $\\tau$ 成正比。如问题所述，当 $k^n$ 很小时，这个时间尺度可能非常小，这使得系统变得刚性。如果违反了关于 $\\Delta t$ 的这个条件，显式步长可能导致 $k^{n+1}  0$。这是将显式方法应用于刚性方程时一个众所周知的稳定性约束。因此，为了在不受这个可能非常小的时间步长约束的情况下确保正定性，必须对 $\\epsilon$ 使用隐式方法，或采取像裁剪 $k$ 这样的修正措施。该陈述准确地描述了这一基本的数值问题及其在实践中的后果。\n结论：**正确**。\n\n**选项 B 分析：**\n该选项对隐式处理和裁剪作出了几个断言。\n1.  “隐式处理 $\\epsilon$ 会引入无条件阻尼，从而降低精度……并延迟湍流的发生”：对汇项进行隐式处理确实是无条件稳定的，并且内在地具有阻尼特性。例如，对 $\\partial_t k = -\\epsilon(k)$ 进行后向欧拉处理得到 $k^{n+1} = k^n - \\Delta t \\epsilon(k^{n+1})$，这意味着 $k^{n+1} \\le k^n$。对于给定的 $\\Delta t$，这种强阻尼可能不如一个更小的、稳定的显式步长准确，并且可能人为地抑制湍流的初始增长。这部分陈述是合理的。\n2.  “它保持了可微性和精确的能量核算”：一个隐式格式求解一个（可能是非线性的）方程组。解 $k^{n+1}$ 通常是模型在 $k^n$ 状态和模型参数的一个可微函数。这对于创建伴随模式至关重要。该格式满足其所源自的离散收支方程，因此从这个意义上说，它在离散层面上具有“精确的能量核算”。\n3.  “而裁剪则保持了离散系统的精度和可微性”：这是错误的。裁剪是操作 $k^{n+1} = \\max(k^{n+1}_{pred}, k_{floor})$。$\\max$ 函数是不可微的；它有一个“尖点”。这种不可微性对于伴随模式来说是极具问题的。此外，通过用一个正的下限值 $k_{floor}$ 替换一个负的预测值 $k^{n+1}_{pred}$，引入了一个人为的 TKE 源，这意味着离散能量收支被违反了。这从根本上破坏了系统的精度。\n由于该陈述的一个主要部分在事实上是错误的，因此整个陈述是错误的。\n结论：**不正确**。\n\n**选项 C 分析：**\n该选项声称裁剪具有可忽略的影响。\n1.  “不改变离散收支”：这是错误的。如果格式预测出 $k^{n+1}_{pred}  0$ 并且该值被重置为 $k_{floor}  0$，那么在一个时间步长内 $k$ 的变化就不再与离散收支方程中的倾向项（$P$, $\\epsilon$, 输运）一致。一个等于 $k_{floor} - k^{n+1}_{pred}$ 的 TKE 量被人为地创造了出来。收支被改变了。\n2.  “因此它对伴随敏感性或参数估计的影响可以忽略不计”：这也是错误的。裁剪操作的不可微性会破坏或使用于参数估计和数据同化（依赖于伴随敏感性）的基于梯度的优化算法停滞。裁剪引入的系统性的、非物理的能量源也可能导致模型状态出现偏差，从而导致不正确的参数估计。\n结论：**不正确**。\n\n**选项 D 分析：**\n该选项描述了一种半隐式格式。设汇项被一个线性化的隐式项 $-\\alpha k^{n+1}$ 替换。离散化方程变为：\n$$ \\frac{k^{n+1} - k^n}{\\Delta t} = F_{exp}(k^n) - \\alpha k^{n+1} $$\n解出 $k^{n+1}$:\n$$ k^{n+1}(1 + \\Delta t \\alpha) = k^n + \\Delta t F_{exp}(k^n) \\implies k^{n+1} = \\frac{k^n + \\Delta t F_{exp}(k^n)}{1 + \\Delta t \\alpha} $$\n项 $\\alpha$ 是“由已知场计算”，即从时间步 $n$ 的状态计算。一个常见的选择是 $\\alpha = \\epsilon(k^n)/k^n = C_{\\epsilon}\\sqrt{k^n}/\\ell$。对于这个选择，由于 $C_{\\epsilon}0$, $\\ell0$ 且 $k^n \\ge 0$，我们有 $\\alpha \\ge 0$。分母 $(1 + \\Delta t \\alpha)$ 总是 $\\ge 1$。\n该陈述声称该格式“确保 $k^{n+1} \\ge 0$”。$k^{n+1}$ 的非负性取决于分子 $k^n + \\Delta t F_{exp}(k^n)$，这是所有显式处理项的结果。如果这个显式更新产生一个非负值，那么针对汇项的半隐式格式将保持该非负性。在数值方法的背景下，这样的格式被称为保正格式，因为该格式对所讨论项的处理不会引入负值。因此，在标准解释下，这一说法是正确的。\n该陈述还声称这“可以看作是对一个线性化耗散算子应用的后向欧拉步”。仅考虑耗散部分的常微分方程是 $\\partial_t k = -\\epsilon(k)$。其线性化版本是 $\\partial_t k = -\\alpha k$。对这个线性化的常微分方程应用后向欧拉步得到 $\\frac{k^{n+1}-k^n}{\\Delta t} = -\\alpha k^{n+1}$。这恰好是上述半隐式格式的隐式部分。整个格式可以解释为算子分裂：首先，对源/输运项进行显式欧拉步，$k^* = k^n + \\Delta t F_{exp}(k^n)$，然后对线性化的汇项进行后向欧拉步，$k^{n+1} = k^*/(1 + \\Delta t \\alpha)$。该陈述的所有部分都是准确的。\n结论：**正确**。\n\n**选项 E 分析：**\n该选项表明，单调平流-扩散格式是解决正定性问题的完整方案。对于方程的输运部分 $\\partial_{t} k = \\nabla \\cdot (K_k \\nabla k) - \\nabla \\cdot (\\boldsymbol{u} k)$，一个单调（或保正）格式能确保如果 $k^n \\ge 0$，则输运更新保持非负性，但这通常受制于 CFL 条件。然而，这并没有解决刚性汇项 $\\epsilon$ 的问题。如果使用单调输运格式但对耗散使用显式格式，时间步进方程仍然是 $k^{n+1} = k^*_{transport} - \\Delta t \\epsilon(k^n)$，其中 $k^*_{transport}$ 是输运步骤得到的非负结果。如选项 A 的分析所示，如果 $\\Delta t$ 过大，项 $-\\Delta t \\epsilon(k^n)$ 仍然可能使 $k^{n+1}$ 变为负值。耗散项的刚性是一个局部的源项问题，与输运格式的属性无关。因此，为了使用一个合理大的时间步长，仍然需要对 $\\epsilon$ 进行特殊的（隐式）处理。\n结论：**不正确**。\n\n最终结论：陈述 A 和 D 是正确的。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}