## 引言
在数值天气预报和气候模拟的宏大框架中，云与降水的形成和演化是驱动[大气环流](@entry_id:1125564)和能量平衡的核心物理过程。然而，在模型的网格尺度上精确描述数以万亿计的云滴、冰晶和降水粒子的集体行为，构成了一项巨大的计算挑战。体积微物理方案（Bulk Microphysics Schemes）应运而生，它提供了一套高效的[参数化](@entry_id:265163)方法，使得在可接受的计算资源内捕捉这些复杂过程成为可能。本文旨在系统性地剖析体积微物理方案，填补从微观粒子物理到宏观模式应用的知识鸿沟。

本文分为三个核心章节。在“原理与机制”中，我们将深入探讨体积方案的数学基础，从粒子群[平衡方程](@entry_id:172166)出发，阐明[矩封闭问题](@entry_id:1128123)的本质，并详细介绍单矩、双矩及三矩方案的实现细节与关键物理过程的[参数化](@entry_id:265163)方法。接着，在“应用与交叉学科联系”中，我们将展示这些方案在实际天气与[气候预测](@entry_id:184747)中的核心作用，探讨其如何与大气动力学、辐射传输等其他物理过程耦合，并讨论其在[气溶胶-云相互作用](@entry_id:1120855)研究及跨尺度建模中的应用与挑战。最后，“动手实践”部分将提供一系列编程练习，旨在将理论知识转化为解决实际问题的能力。

通过本文的学习，读者将全面掌握体积微物理方案的理论精髓、实践应用及其在前沿科学问题中的角色，为更深入的研究和模型开发奠定坚实的基础。

## 原理与机制

本章旨在阐述体积微物理方案（Bulk Microphysics Schemes）的核心原理与关键机制。我们将从描述云与降水粒子群体的基本方程出发，探讨数值模式如何通过[参数化](@entry_id:265163)的方式，在可接受的计算成本下，捕捉复杂的微物理过程。我们将深入研究这些方案的数学基础、物理假设以及它们在实际应用中面临的数值挑战。

### 粒子群平衡与[矩封闭问题](@entry_id:1128123)

云的形成、演化和降水的产生，本质上是大量悬浮于空中的[水凝物](@entry_id:1126277)粒子（hydrometeor）群体行为的宏观体现。这些粒子——云滴、雨滴、冰晶、雪花等——尺寸、形状和相态各异。描述这一复杂系统的最基本框架是**粒子尺度[分布函数](@entry_id:145626)** (Particle Size Distribution, PSD)，通常记为 $n(r, \mathbf{x}, t)$。其中，$n(r, \mathbf{x}, t) dr$ 代表在时间 $t$、空间位置 $\mathbf{x}$ 处，单位体积空气中尺寸（如半径）在 $[r, r+dr]$ 区间内的粒子数量。

该分布函数的演化由一个**粒子群平衡方程** (Population Balance Equation) 控制 ，其形式如下：
$$
\frac{\partial n}{\partial t} + \nabla_{\mathbf{x}}\cdot\left(\mathbf{u}\,n\right) + \frac{\partial}{\partial r}\left(\dot{r}\,n\right) + \frac{\partial}{\partial z}\left(V_t(r)\,n\right) \;=\; \mathcal{C}[n] \;+\; \mathcal{S} \;-\; \mathcal{L}
$$
该方程的各项分别描述了：由风场 $\mathbf{u}$ 引起的平流输送、由凝结/蒸发引起的粒子在尺寸空间中的增长（增长率为 $\dot{r}$）、由重力引起的沉降（[终端速度](@entry_id:1132946)为 $V_t(r)$）、粒子间的碰撞-合并过程（由[非线性](@entry_id:637147)的[碰撞算子](@entry_id:1122657) $\mathcal{C}[n]$ 描述），以及其他的源汇项 $\mathcal{S}$ 和 $\mathcal{L}$（如成核、融化等）。

在[数值天气预报](@entry_id:191656)（NWP）或气候模式中，直接求解这个关于 $n(r, \mathbf{x}, t)$ 的[偏微分](@entry_id:194612)方程是极其昂贵的，因为它需要在每个网格点上解析整个连续的尺寸谱。这引出了[云微物理参数化](@entry_id:1122518)的核心挑战：**[矩封闭问题](@entry_id:1128123)** (moment-closure problem)。

为了简化问题，我们不直接预测整个 $n(r)$ 函数，而是预测它的一些积分特性，即**矩** (moments)。PSD 的 $k$ 阶矩定义为：
$$
M_k(\mathbf{x},t) \equiv \int_0^{\infty} r^k\,n(r,\mathbf{x},t)\\,dr
$$
这些矩具有明确的物理意义。例如，零阶矩 $M_0$ 是总**数浓度**（Number Concentration），即单位体积中的粒子总数。假设粒子为球形，其质量与 $D^3$（直径的三次方）成正比，因此总**质量混合比**（Mass Mixing Ratio）——单位质量湿空气中的[水凝物](@entry_id:1126277)质量——与三阶矩 $M_3$ 成正比 。类似地，天气雷达[反射率](@entry_id:172768)因子 $Z$ 与六阶矩 $M_6$ 成正比 。

对粒子群[平衡方程](@entry_id:172166)乘以 $r^k$ 并对整个尺寸谱积分，可以得到 $k$ 阶矩的[预报方程](@entry_id:1130221)。然而，我们会发现，预报 $M_k$ 的方程中往往会出现更高阶的矩（如 $M_{k+b}$），从而形成一个无限的方程链。例如，沉降通量项 $\int_0^{\infty} r^k V_t(r) n(r) dr$ 若 $V_t(r) \propto r^b$，则依赖于 $M_{k+b}$。为了截断这个链条，必须引入一个**[封闭假设](@entry_id:1122504)**。

不同的微物理方案采用了不同的方法来解决这个封闭问题 ：
1.  **分档（Bin）方案**：该方案直接将尺寸坐标 $r$ 离散化为一系列“档”（bins），并在每个档内预报粒子数。这相当于用[直方图](@entry_id:178776)来近似 $n(r)$，从而避免了对 PSD 函数形态的假设。其代价是需要求解大量（通常为数十个）的预报变量，计算成本高昂。
2.  **拉格朗日（超粒子）方案**：该方案使用大量携带权重的“超粒子”来模拟真实的粒子群体。每个超粒子代表大量具有相同属性的真实粒子。这些超粒子的增长和运动被确定性地追踪，而碰撞则通过随机配对的方式模拟。这种方法避免了欧拉方案在尺寸空间中的[数值扩散](@entry_id:136300)，但会引入[蒙特卡洛采样](@entry_id:752171)噪声。
3.  **体积（Bulk）方案**：这是在NWP和气候模式中应用最广泛的方案。它不预报 PSD 的形态，而是只预报少数几个低阶矩，如质量[混合比](@entry_id:1127970) $q_x$（与 $M_3$ 相关）和数浓度 $N_x$（即 $M_0$）。为了计算过程中所需的其他矩或积分量，体积方案**假设**了一个解析的 PSD 函数形式，最常用的是**广义伽马分布**。通过预报的矩来确定该分布的参数，进而可以诊断出任何其他[高阶矩](@entry_id:266936)，从而实现方程组的封闭。

本章的重点正是这种体积方案。

### 体积方案的等级与实现

体积方案的核心在于通过预报有限的几个矩来“约束”一个假定的PSD。方案的复杂性和保真度取决于预报的矩的数量，由此形成了不同的等级 。

- **单矩（1M）方案**：这是最简单的体积方案，对每种[水凝物](@entry_id:1126277)只预报一个矩，通常是**质量[混合比](@entry_id:1127970)** $q_x$。为了满足模式的能量和水分守恒，质量是必须预报的量。在这种方案中，数浓度 $N_x$ 必须通过诊断关系（例如，依赖于温度或 $q_x$ 本身的经验公式）或设为定值来获得。

- **双矩（2M）方案**：这种方案同时预报**质量混合比** $q_x$ 和**数浓度** $N_x$。增加数浓度作为预报量，极大地提升了方案的物理真实性。例如，它可以显式地模拟那些改变粒子平均尺寸的过程：凝结/蒸发主要改变质量，而数浓度变化不大；碰撞合并过程在保持总质量近似守恒的同时，会显著减少数浓度。

- **三矩（3M）方案**：在预报质量和数浓度的基础上，再增加一个预报矩。对于降水性粒子（如雨、雪、霰），第三个预报矩通常选择与**雷达[反射率](@entry_id:172768)因子** $Z_x$ 相关的六阶矩 $M_6$。预报三个矩可以更灵活地确定假定PSD的三个参数（例如，广义伽马分布的斜率、形状和截距），从而允许分布的宽度随时间演化。

#### 粒子尺度分布的数学描述

体积方案的基石是假定的PSD函数。一个最常用的形式是广义伽马分布，其归一化形式如下 ：
$$
n(D) = N \frac{\lambda^{\mu+1}}{\Gamma(\mu+1)} D^{\mu} e^{-\lambda D}
$$
其中，$D$ 是粒子直径，$\Gamma(\cdot)$ 是欧拉伽马函数。该分布由三个参数控制：总数浓度 $N$、无量纲的**[形状参数](@entry_id:270600)** $\mu$ 和具有长度倒数量纲的**斜[率参数](@entry_id:265473)** $\lambda$。

[形状参数](@entry_id:270600) $\mu$ 直接控制了谱的相对宽度。谱的相对宽度可以用变异系数 $c_v$（标准差与平均值的比值）来表征。对于伽马分布，可以推导出 $c_v = (\mu+1)^{-1/2}$。这意味着，$\mu$ 越大，分布相对于其平均值就越窄。当 $\mu \to \infty$ 时，分布趋向于单色谱（所有粒子尺寸相同）；当 $\mu=0$ 时，分布退化为[指数分布](@entry_id:273894)，[谱宽](@entry_id:176022)最宽。

该分布的 $k$ 阶矩 $M_k = \int_0^\infty D^k n(D) dD$ 有一个简洁的解析表达式：
$$
M_k = N \frac{\Gamma(\mu + k + 1)}{\Gamma(\mu + 1)} \lambda^{-k}
$$
这个关系式是实现[矩封闭](@entry_id:199308)的关键。在双矩（2M）方案中，模式预报了 $N_x = M_0$（即$N$）和 $q_x \propto M_3$。利用这两个已知的矩，可以求解出伽马分布的参数（通常 $\mu$ 会被预设或通过经验关系诊断，然后用 $M_0$ 和 $M_3$ 求解斜[率参数](@entry_id:265473) $\lambda$）。一旦分布参数确定，任何其他过程（如沉降、[碰并](@entry_id:1122642)）所需的任意阶矩都可以通过上式计算出来。

### 微物理过程的[参数化](@entry_id:265163)

体积方案将复杂的微物理过程转化为关于预报矩（$q_x, N_x$ 等）的变化率的数学表达式。以下是一些关键过程的例子。

#### 暖雨过程：自动转化与碰吸

- **[自动转化](@entry_id:1121257) (Autoconversion)**：这是云滴通过碰撞合并过程长成雨滴的初始阶段，标志着降水的形成。不同复杂度的方案对此有不同的描述 。
    - **Kessler (1969) 方案**：这是一种典型的用于 1M 方案的[参数化](@entry_id:265163)。它采用了一个简单的**阈值法**。只有当云水混合比 $q_c$ 超过一个临界阈值 $q_c^\star$ 时，自动转化才会发生，其速率与超出的部分 $(q_c - q_c^\star)$ 成正比。这种方法的优点是简单，但物理真实性有限，因为它不依赖于云滴的数浓度。
    - **Khairoutdinov-Kogan (2000) 方案**：这是一种基于大量[数值模拟](@entry_id:146043)结果的经验[参数化](@entry_id:265163)，常用于 2M 方案。其[自动转化](@entry_id:1121257)率被表达为 $q_c$ 和 $N_c$ 的幂律函数，形式为 $P_{AUT} \propto q_c^{\alpha} N_c^{\beta}$，其中 $\alpha > 0$ 且 $\beta  0$。这种形式在物理上更为合理：在 $q_c$ 相同的情况下，如果 $N_c$ 越大，意味着云滴平均尺寸越小，[碰撞效率](@entry_id:1122647)越低，因此自动转化率越小。这体现了 2M 方案相对于 1M 方案的优势。

- **碰吸 (Accretion)**：这是指下落的雨滴清除路径上的云滴，使其自身增长的过程。其速率的物理基础是**动力学[碰并](@entry_id:1122642)方程** 。两个粒子（例如，一个半径为 $R_r$ 的雨滴和一个半径为 $R_c$ 的云滴）的[碰撞核](@entry_id:1122656)函数 $K(D_r, D_c)$ 可以从第一性原理推导：
$$
K(D_r, D_c) = E_{rc}(D_r, D_c)\,\pi\,\left(\dfrac{D_r + D_c}{2}\right)^{2}\,\left|V_t(D_r) - V_t(D_c)\right|
$$
该核函数代表了雨滴相对于云滴的有效扫过体积率。它由三个物理量决定：
    1.  **几何[截面](@entry_id:154995)**：$\pi \left(\frac{D_r+D_c}{2}\right)^2$，即两个球体中心距小于半径之和时的[横截面](@entry_id:154995)积。
    2.  **相对速度**：$|V_t(D_r) - V_t(D_c)|$，主要由重力[沉降速度](@entry_id:1123566)差决定。
    3.  **[碰并](@entry_id:1122642)效率** $E_{rc}$：一个介于0和1之间的无量纲因子，描述了由于流[体力](@entry_id:174230)学效应（小滴绕过大滴）和表面张力效应（碰撞后不一定合并）导致的实际[碰撞概率](@entry_id:269652)低于几何碰撞概率的程度。

在体积方案中，总的碰吸率是通过将这个[碰撞核](@entry_id:1122656)函数与云滴和雨滴的PSD（由预报矩决定的伽马分布）进行积分得到的。

#### 冰相与冰水混合相过程

- **冰相粒子的定义**：与液态水滴不同，冰相粒子（冰晶、雪、霰、雹）的形态千差万别。为了描述这种复杂性，体积方案通常采用**质量-尺度关系** $m(D) = a D^b$ 来定义不同类别的冰粒子 。其中 $D$ 是粒子的最大尺度，$a$ 和 $b$ 是依赖于粒子类型的参数。
    - 这种关系隐含了粒子的**有效密度** $\rho_p(D) = m(D) / (\pi D^3 / 6) = \frac{6a}{\pi} D^{b-3}$。
    - 参数 $b$ 反映了粒子随尺寸增长的致密程度。对于结构疏松、多孔的雪花聚合体，其质量增长慢于[体积增长](@entry_id:274676)，通常 $b \approx 2$，这意味着其有效密度随尺寸增大而减小 ($\rho_p \propto D^{-1}$)。对于密实的霰或雹，其形态接近球体，质量与体积成正比，因此 $b$ 趋近于 $3$，有效密度几乎不随尺寸变化。
    - 参数 $a$ 则主要反映了粒子的固有密度。在相同尺寸和 $b$ 值下，$a$ 越大，[粒子质量](@entry_id:156313)越大，有效密度也越高。
    - 从蓬松的雪花到密实的霰的**凇化**（riming）过程，正是通过收集过冷水滴并冻结，填充了冰晶间的空隙。在[参数化](@entry_id:265163)中，这个过程表现为 $a$ 和 $b$ 的同时增大，且 $b$ 向 3 靠近。

- **冰的成核 (Ice Nucleation)**：这是大气中冰晶的初始来源，主要通过**非均质[核化](@entry_id:262547)**发生 。体积方案需要[参数化](@entry_id:265163)冰晶数浓度的源项 $S_{Ni}$。主要的[核化](@entry_id:262547)模式包括：
    1.  **凝华[核化](@entry_id:262547) (Deposition Nucleation)**：水汽直接在冰核（INP）上凝华成冰，要求环境相对于冰面[过饱和](@entry_id:200794)（$S_i > 0$）。
    2.  **凝结-冻结[核化](@entry_id:262547) (Condensation-Freezing)**：水汽先在冰核上凝结成过冷水滴，然后冻结，要求环境相对于液态水过饱和（$S_w > 0$）。
    3.  **浸润冻结[核化](@entry_id:262547) (Immersion Freezing)**：悬浮在[过冷水](@entry_id:1132639)滴内部的冰核引发冻结。
    4.  **接触冻结[核化](@entry_id:262547) (Contact Nucleation)**：冰核与过冷水滴外部接触时引发冻结。
    这些过程的速率都强烈依赖于温度（[过冷](@entry_id:162134)度越大，速率越高），并且前两种还依赖于水汽[过饱和](@entry_id:200794)度。一个典型的[参数化](@entry_id:265163)形式会将 $S_{Ni}$ 表达为温度和饱和度的函数，并使用 Heaviside [阶跃函数](@entry_id:159192)来激活满足触发条件的模式。

- **WBF 过程 (Wegener-Bergeron-Findeisen Process)**：在低于 $0^\circ\text{C}$ 的冰水混合云中，由于冰面的饱和水汽压低于同温度下[过冷水](@entry_id:1132639)面的饱和水汽压，水汽会从[过冷水](@entry_id:1132639)滴上蒸发，并凝华到冰晶上，导致冰晶快速增长而水滴消亡 。这是一个极其重要的冰晶增长机制。
    在[准稳态假设](@entry_id:273480)下（即水汽场快速调整以平衡对冰和水的通量），可以推导出从液相到冰相的净水汽质量转移率 $J^\star$：
    $$
    J^\star = \frac{4 \pi D_v (N_i r_i) (N_c r_l)}{N_i r_i + N_c r_l} (q_{s,l} - q_{s,i})
    $$
    其中，$D_v$ 是水汽[分子扩散系数](@entry_id:752110)，$N_i r_i$ 和 $N_c r_l$ 分别代表冰晶和云滴群体的“凝结能力”或“电容”，而 $(q_{s,l} - q_{s,i})$ 是[热力学驱动力](@entry_id:1133063)。这个过程导致冰水质量混合比增加 ($dq_i/dt = J^\star$)，云水质量混合比减少 ($dq_c/dt = -J^\star$)，而水汽混合比的变化在准[稳态](@entry_id:139253)下为零。

### 与模式动力学的耦合及数值挑战

微物理过程并非孤立存在，它通过潜热释放与模式的[热力学状态](@entry_id:755916)相互作用，并且其数值解法本身也充满了挑战。

#### [热力学耦合](@entry_id:170539)：潜热释放

水在不同相态间转换时会吸收或释放大量的热量，即**潜热**。这种加热或制冷效应对大气的温度结构和动力学演化至关重要。在[热力学](@entry_id:172368)方程中，微物理过程的贡献表现为一个源项 $S_L$ 。根据[热力学第一定律](@entry_id:146485)，可以严格推导出潜热加热率：
$$
S_L = L_v(\mathcal{C} - \mathcal{E}) + L_f(\mathcal{F} - \mathcal{M})
$$
其中，$L_v$ 和 $L_f$ 分别是[汽化潜热](@entry_id:142174)和融化潜热。$\mathcal{C}, \mathcal{E}, \mathcal{F}, \mathcal{M}$ 分别代表凝结、蒸发、冻结和融化的速率（均为非负值）。这个表达式清晰地表明：
- **凝结 ($\mathcal{C}$) 和冻结 ($\mathcal{F}$)** 是[放热过程](@entry_id:147168)，会加热大气 ($S_L > 0$)。
- **蒸发 ($\mathcal{E}$) 和融化 ($\mathcal{M}$)** 是[吸热过程](@entry_id:141358)，会冷却大气 ($S_L  0$)。

#### 数值挑战

微物理过程的[参数化](@entry_id:265163)方程组在数值求解时面临两大主要挑战：刚性和[正定性](@entry_id:149643)。

- **刚性 (Stiffness)**：微物理过程的时间尺度跨度极大 。例如，云滴的凝结/蒸发过程响应水汽[过饱和](@entry_id:200794)度的[弛豫时间尺度](@entry_id:1130826)通常只有几秒钟，而自动转化和沉降等过程的时间尺度则长达数十分钟到数小时。这种时间尺度的巨大差异，在数学上表现为描述该系统演化的[常微分方程](@entry_id:147024)（ODE）组的 Jacobian 矩阵，其特征值的实部大小悬殊。
    这种**刚性**对[数值积分方法](@entry_id:141406)提出了严峻的考验。对于显式时间积分方案（如[前向欧拉法](@entry_id:141238)），为了保证数值稳定性，时间步长 $\Delta t$ 必须由最快的过程（即绝对值最大的特征值）来决定。在微物理方案中，这通常是凝结过程，它会迫使 $\Delta t$ 取得非常小（例如，小于1秒），这对于需要模拟数小时乃至数天气候模式来说，计算成本是无法承受的。

- **正定性 (Positivity)**：质量混合比 $q_x$ 和数浓度 $N_x$ 等物理量在定义上是**非负**的。然而，一个简单的数值方案很容易产生无物理意义的负值 。
    考虑一个仅有汇项的过程，采用[前向欧拉法](@entry_id:141238)更新：$q_x^{n+1} = q_x^n - \Delta t \cdot \text{Sinks}_x$。这里的总汇项 $\text{Sinks}_x$ 是在时间步开始时，基于初始可用的质量 $q_x^n$ 计算的。如果存在多个汇项过程（例如，云水既通过[自动转化](@entry_id:1121257)变成雨，又通过碰吸被雨滴收集），一个“天真”的算法会分别计算每个过程的汇率，然后加总。这相当于假设每个过程都可以独立地消耗初始的全部云水 $q_x^n$。当时间步长 $\Delta t$ 较大或汇率较强时，总的计算消耗量 $\Delta t \cdot \text{Sinks}_x$ 很容易就超过了实际可用的 $q_x^n$，从而导致 $q_x^{n+1}$ 为负。
    这并非简单的[浮点误差](@entry_id:173912)，而是数值方法（[截断误差](@entry_id:140949)）的根本缺陷。为了确保**正定性**，必须采用特殊的数值技术，如使用限制器（limiter）确保消耗量不超过可用量，或采用隐式/半[隐式时间积分](@entry_id:171761)方案。同时，方案还应满足**单调性**（monotonicity），即净汇项不应导致物质增加，净源项不应导致物质减少。

综上所述，体积微物理方案通过基于物理的[参数化](@entry_id:265163)和严格的数学框架，为在宏观尺度模式中表示复杂的云和降水过程提供了一种高效且可行的途径。然而，其成功应用不仅依赖于[参数化](@entry_id:265163)本身的物理真实性，还高度依赖于稳健且高效的数值求解技术来应对其固有的刚性和[正定性](@entry_id:149643)挑战。