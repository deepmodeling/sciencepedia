## 引言
在数值天气预报和气候模拟的宏伟蓝图中，[参数化](@entry_id:265163)问题是连接理论与现实、宏观与微观的关键桥梁。这些复杂的模型旨在通过求解物理定律来预[测地球](@entry_id:201133)系统的未来状态，但它们面临着一个根本性的限制：有限的计算资源使得我们无法在每个原子或分子的尺度上进行计算。因此，模型不得不在离散的网格上运行，这自然地将物理过程分为了可被“解析”的大尺度运动和必须被“[参数化](@entry_id:265163)”的[次网格尺度过程](@entry_id:1132602)。如何准确地表示这些未被解析的过程——如湍流混合、云的形成和对流风暴——对大尺度环流的集体效应，正是[参数化](@entry_id:265163)所要解决的核心挑战，也是决定模型成败的关键所在。

本文旨在系统性地梳理[参数化](@entry_id:265163)问题的理论基础、关键技术及其在[地球系统科学](@entry_id:175035)中的广泛应用。我们将从第一性原理出发，带领读者深入理解这一问题的本质。
- 在“原理与机制”一章中，我们将探讨[参数化](@entry_id:265163)问题的数学起源，即滤波操作与闭合问题，并介绍从经典的[涡粘性模型](@entry_id:1124145)到先进的质量通量方案等核心机制。
- 接着，在“应用与跨学科联系”一章中，我们将展示这些理论如何在多样化的场景中发挥作用，从[大气边界层](@entry_id:1121182)和深海环流，到陆面过程和城市冠层，并探讨尺度自适应和机器学习等前沿方法。
- 最后，“动手实践”部分将提供具体的计算练习，让读者亲手实现和分析[参数化](@entry_id:265163)方案，将理论知识转化为实践能力。

通过这一系列的学习，读者将构建起对[次网格表示](@entry_id:1132598)问题的全面认识，为更高阶的研究和应用打下坚实的基础。

## 原理与机制

在[数值天气预报](@entry_id:191656)和气候模型中，物理过程的表示是其核心组成部分。由于计算资源的限制，模型无法在原子或分子尺度上求解流体的完整行为。相反，模型在一个离散的网格上求解经过修改的控制方程。这个过程不可避免地将某些物理过程的尺度“解析”出来，而将其他尺度更小的过程“次网格化”。[参数化](@entry_id:265163)问题正是源于这种尺度分离：我们如何用可解析的、大尺度的模型变量来表示那些无法解析的、小尺度过程的集体效应？本章将深入探讨[参数化](@entry_id:265163)问题的基本原理和实现机制。

### [参数化](@entry_id:265163)问题的起源：滤波、平均与闭合问题

为了从数学上理解次网格过程的起源，我们可以设想对流体力学（例如，[Navier-Stokes](@entry_id:276387)）的完整控制方程应用一个空间**滤波算子**。对于任何标量场 $\phi(\mathbf{x}, t)$（如温度或水汽[混合比](@entry_id:1127970)），我们可以定义一个解析尺度场 $\overline{\phi}$ 和一个[次网格尺度](@entry_id:1132591)场 $\phi'$，使得 $\phi = \overline{\phi} + \phi'$。当我们将这个滤波算子应用于一个包含[非线性](@entry_id:637147)项的守恒定律时，例如平流项 $\nabla \cdot (\mathbf{u}\phi)$，问题就出现了。

经过滤波的方程形式如下：
$$
\frac{\partial \overline{\phi}}{\partial t} + \nabla \cdot (\overline{\mathbf{u}}\,\overline{\phi}) = \mathcal{F}_\Delta[\mathcal{S}] - \nabla \cdot \boldsymbol{\tau}_\Delta
$$
其中，$\mathcal{F}_\Delta[\mathcal{S}]$ 是滤波后的源汇项，而一个新项 $\boldsymbol{\tau}_\Delta$ 出现了，它被称为**[次网格尺度](@entry_id:1132591)（SGS）通量**或相关项。它的定义是：
$$
\boldsymbol{\tau}_\Delta = \overline{\mathbf{u}\phi} - \overline{\mathbf{u}}\overline{\phi}
$$
这个项代表了次网格尺度的速度和标量波动之间的相关性对解析尺度场的净输送效应。由于模型只预报和存储解析尺度变量（如 $\overline{\phi}$ 和 $\overline{\mathbf{u}}$），而 $\boldsymbol{\tau}_\Delta$ 依赖于未知的次网格尺度波动，因此该项是“未闭合的”。用已知的解析尺度变量来表示这个未知项的问题，就是经典流[体力](@entry_id:174230)学中的**闭合问题** (closure problem)  。[参数化](@entry_id:265163)方案的本质，正是一个旨在解决闭合问题的“闭合模型”。

重要的是要将这个由滤波引起的物理建模问题与模型中的其他误差来源区分开来 ：
1.  **数值离散误差**：这是将解析尺度方程中的连续[微分算子](@entry_id:140145)（如 $\nabla \cdot$）替换为离散的代数表达式（如有限差分或[有限体积法](@entry_id:141374)）时产生的数学[截断误差](@entry_id:140949)。这种误差会随着网格间距 $\Delta x$ 和数值格式的阶数而变化，但即使在没有[次网格物理](@entry_id:755602)过程的方程中它也同样存在。
2.  **模型结构误差**：这是由于我们对物理过程的理解不完整或不正确而导致的误差。例如，一个化学[参数化](@entry_id:265163)方案可能遗漏了某个重要的反应，或者辐射传输方案中的函数形式不准确。

对于[可压缩流体](@entry_id:164617)（如地球大气），平均过程变得更加复杂。简单的雷诺平均会导致在平均后的连续性方程和[动量方程](@entry_id:197225)中出现诸如[湍流](@entry_id:151300)质量通量 $\overline{\rho' u_j'}$ 这样额外的未闭合项，这使得方程组的结构异常繁琐。为了简化这一问题，模型中广泛采用**密度加权平均**（或称**[Favre平均](@entry_id:198824)**）。对于任意变量 $\phi$，其[Favre平均](@entry_id:198824)定义为 $\tilde{\phi} = \overline{\rho \phi} / \overline{\rho}$。这种平均方法的高明之处在于，它使得平均后的连续性方程形式上与原始方程保持一致，并将所有与动量输送相关的次网格项合并为一个单一的、形式更简洁的可压缩雷诺应力张量 $\overline{\rho u_i'' u_j''}$ 。这极大地简化了闭合模型的构建。

### [湍流](@entry_id:151300)输送的表示：[涡粘性模型](@entry_id:1124145)

建立了闭合问题的概念后，最直观的闭合方法是将未知的次网格通量与已知的解析尺度场梯度联系起来。这就是**[Boussinesq假设](@entry_id:272519)**，它类比分子[粘性输运](@entry_id:157790)，假设次网格[湍流](@entry_id:151300)应力与解析尺度的[应变率张量](@entry_id:266108)成正比。这种类比引入了**涡粘性系数** ($\nu_t$) 。

必须强调，涡粘性系数 $\nu_t$ 与流体的物理属性**分子粘性系数** ($\nu$) 有着本质的区别。
*   **分子粘性** $\nu$ 是流体的固有属性，它通过分子间的动量交换来耗散动能。这一过程主要发生在极小的尺度上，即**Kolmogorov微尺度** $\eta$。在这个尺度上，局部雷诺数 $Re_\eta$ 约为1。对于典型的大气边界层流动，[Kolmogorov尺度](@entry_id:270763)大约在毫米量级。
*   **涡粘性** $\nu_t$ 则是一个依赖于流动状态和[模型分辨率](@entry_id:752082)的**模型参数**。它描述的是大量无序的、未被解析的湍[涡对](@entry_id:199153)动量的集体输送效应。在大气中，这些湍涡的尺度远大于[Kolmogorov尺度](@entry_id:270763)，而模型网格尺度 $\Delta$ 又远大于湍涡尺度。涡粘性系数 $\nu_t$ 的数值通常比分子粘性系数 $\nu$ 大好几个数量级。例如，在大气边界层中，$\nu \approx 1.5 \times 10^{-5} \, \mathrm{m^2 s^{-1}}$，而 $\nu_t$ 的典型值可达 $1 \text{–} 100 \, \mathrm{m^2 s^{-1}}$ 。

这种类比虽然简单有效，但也存在局限性。它假设[湍流](@entry_id:151300)总是将能量从大尺度输送到小尺度（顺梯度输送），这在许多情况下是成立的。然而，在某些大气现象（如斜压不稳定）中，能量也可以从[次网格尺度](@entry_id:1132591)向解析尺度传递，这一过程被称为**能量反尺度串级**（backscatter）。简单的[涡粘性模型](@entry_id:1124145)无法描述这种现象。

### [确定性与随机性](@entry_id:636235)[参数化](@entry_id:265163)

[涡粘性模型](@entry_id:1124145)是**确定性[参数化](@entry_id:265163)**的一个例子：对于给定的解析尺度状态，它总是给出唯一确定的次网格通量值。这相当于在建模次网格过程的[条件期望](@entry_id:159140)值 。

然而，真实的次网格[湍流](@entry_id:151300)是混沌和[间歇性](@entry_id:275330)的。对于同一个解析尺度状态（宏观状态），可能存在许多不同的次网格[湍流](@entry_id:151300)实现（微观状态），从而导致一个可能次网格倾向的分布。为了体现这种不确定性和变率，研究人员发展了**[随机参数化](@entry_id:1132435)** 。

[随机参数化](@entry_id:1132435)方案通常在一个确定性部分的基础上，增加一个依赖于解析尺度状态的随机扰动项。其目标不仅仅是表示平均效应，还要再现次网格过程的正确统计特性，如方差、间歇性和时间相关性。这种方法在理论上更完善，能够表示诸如能量反尺度串级等复杂现象，并且在集合预报等应用中能够提供更可靠的预报不确定性信息。

### 案例研究1：对流[参数化](@entry_id:265163)

从一般原理转向具体的物理过程，对流是[参数化](@entry_id:265163)中最具挑战性也最重要的领域之一。

*   **调整方案 (Adjustment Schemes)**：这是最早期和最简单的对流[参数化](@entry_id:265163)方法之一。这类方案并不显式地模拟对流过程。它只是诊断大气柱是否处于对流不稳定状态（例如，温度[递减率](@entry_id:1127070)超过某个阈值）。如果不稳定，方案会以一个[特征时间尺度](@entry_id:276738)将大气柱的平均[热力学](@entry_id:172368)廓线（如温度和湿度）“调整”或“松弛”到一个预设的稳定（或中性）参考廓线。整个过程受到整层大气柱的质量和能量守恒约束。这种方法虽然粗糙，但能有效防止模型产生不切实际的极端不稳定 。

*   **质量通量方案 (Mass-Flux Schemes)**：这是一种更为物理的对流[参数化](@entry_id:265163)框架。它将网格单元内的[区域划分](@entry_id:748628)为活跃的上升气流区（updraft）和相对平静的环境区（environment）。其核心概念包括 ：
    *   **上升气流质量通量 ($M$)**：定义为单位时间内通过单位水平面积向上流动的空气质量，即 $M(z) = \rho(z) a(z) w_u(z)$，其中 $a(z)$ 是上升气流所占的面积比例，$w_u(z)$ 是上升气流的平均垂直速度。
    *   **夹卷 ($\varepsilon$) 与夹出 ($\delta$)**：上升气流在上升过程中会与周围环境空气发生交换。**夹卷**是环境空气混入上升气流的过程，它会增加质量通量并稀释上升气流的[浮力](@entry_id:154088)。**夹出**则是上升气流中的空气流出到环境中。
    *   **质量通量[守恒方程](@entry_id:1122898)**：上升气流质量通量随高度的变化由夹卷和夹出的净效应决定：
        $$
        \frac{dM}{dz} = (\varepsilon(z) - \delta(z)) M(z)
        $$
    通过求解这个方程以及上升气流中热量、水分和动量的收支方程，质量通量方案可以计算出未被解析的对流对整个网格单元的垂直输送贡献。该方案的闭合问题在于如何确定对流触发条件、初始质量通量大小以及夹卷/夹出率，这些通常与大尺度环境条件（如对流有效位能CAPE）相关联。

### 案例研究2：次网格变率与[非线性](@entry_id:637147)过程的表示

许多关键的物理过程，尤其是云和降水的形成，具有高度的[非线性](@entry_id:637147)和阈值特性。例如，只有当水汽[混合比](@entry_id:1127970) $q$ 超[过饱和](@entry_id:200794)值 $q_s$ 时，凝结才会发生。如果一个网格单元的平均[混合比](@entry_id:1127970) $\overline{q}$ 略低于 $q_s$，但其内部存在次网格的波动，使得部分区域是过饱和的，而部分区域是未饱和的，那么使用网格平均值 $\overline{q}$ 来判断是否凝结就会得出错误的结论（即没有凝结）。

为了解决这个问题，**[假定概率密度函数](@entry_id:753720) (Assumed-PDF) 方法**被提了出来 。该方法不只是使用网格平均值 $\overline{q}$ 和方差 $\sigma_q^2$，而是更进一步，假定次网格尺度上变量 $q$ 的值遵循一个特定的概率密度函数 $p(q)$（如高斯分布或Beta分布），该函数的参数由 $\overline{q}$ 和 $\sigma_q^2$ 决定。

有了这个PDF，任何[非线性](@entry_id:637147)过程 $S(q)$ 的网格平均效应 $\overline{S(q)}$ 就可以通过对PDF积分来精确计算：
$$
\overline{S(q)} = \int_{-\infty}^{\infty} S(q) p(q) dq
$$
例如，对于凝结过程，即使 $\overline{q}  q_s$，只要 $p(q)$ 在 $q > q_s$ 的区域有值，积分结果就会得到一个非零的平均凝结率。这与简单的“全有或全无”的确定性阈值方法形成了鲜明对比。此外，该方法还能自然地计算次网格过程对[标量方差](@entry_id:1131255)的贡献，例如凝结会优先消耗网格内最湿润部分的水汽，从而减小水汽的方差 。

### 前沿挑战：尺度自适应[参数化](@entry_id:265163)

传统的[参数化](@entry_id:265163)方案通常基于一个核心假设：**尺度分离**，即模型的网格尺度 $\Delta$ 远大于被[参数化](@entry_id:265163)的物理过程的特征尺度 $L$（例如 $\Delta \gg L_c$，其中 $L_c$ 是对流单体的尺度）。然而，随着计算机性能的提升，模型的网格分辨率不断提高。当 $\Delta$ 进入到与 $L_c$ 可比拟的范围时，这个尺度分离的假设就不再成立。

这个中间分辨率范围被称为**对流“灰色地带” (convection grey zone)** 。在这个区域，对流既没有被完全解析，也不完全是次网格过程。它的一部分被模型的动力核心作为解析运动捕捉，而另一部分则仍然是次网格的。此时，如果继续使用传统的对流[参数化](@entry_id:265163)方案，就会导致对流输送的“双重计算”；而如果简单地关闭[参数化](@entry_id:265163)方案，则会遗漏掉仍然存在的次网格输送部分。

为了解决这个问题，**尺度自适应[参数化](@entry_id:265163) (scale-aware parameterization)** 的概念应运而生。其核心思想是让[参数化](@entry_id:265163)方案的强度能够“感知”并响应模型的分辨率。当模型分辨率很粗（$\Delta \gg L_c$）时，[参数化](@entry_id:265163)方案应完全开启；当分辨率很高（$\Delta \ll L_c$）时，[参数化](@entry_id:265163)方案应平滑地关闭；而在灰色地带，[参数化](@entry_id:265163)方案的贡献应根据解析动力学已经承担的部分进行相应地缩减 。

一种构建尺度自适应因子的方法是基于[谱理论](@entry_id:275351)。假设我们知道某物理过程的能量或方差谱 $E(k)$。那么，未被解析的方差就是从模型截断波数 $k_c = \pi/\Delta$ 到无穷大的积分。尺度自适应因子 $f(\Delta/L)$ 可以被定义为未解析方差与总方差的比值。对于一个形如 $E(k) \propto k^{-p}$ 的[幂律谱](@entry_id:186309)，这个因子可以被解析地推导出来，它将依赖于无量纲比率 $\Delta/L$ 和谱指数 $p$  。例如，一个典型的形式为：
$$
f(\Delta/L) = \begin{cases} 1,  \Delta \ge \Delta_{\text{crit}} \\ \left(\dfrac{\Delta}{\Delta_{\text{crit}}}\right)^{p-1},  \Delta  \Delta_{\text{crit}} \end{cases}
$$
其中 $\Delta_{\text{crit}}$ 是一个与物理特征尺度 $L$ 相关的临界分辨率。

### 首要原则：守恒性约束

最后，所有[参数化](@entry_id:265163)方案，无论其复杂程度如何，都必须服从一个至关重要的、不可违背的原则：**守恒性**。[参数化](@entry_id:265163)方案描述的是大气柱内部质量、能量、水分和动量的重新分配，它们自身不能成为这些[守恒量](@entry_id:161475)的净源或净汇 。

这意味着，对于任何一个[守恒量](@entry_id:161475)（如干空气质量、总水物质或湿静力能），所有[参数化](@entry_id:265163)过程产生的倾向项在整个大气柱上进行垂[直积](@entry_id:143046)分后，其结果必须精确地等于该物理量通过大气柱边界（即地表和大气层顶）的净物理通量。例如：

*   **总水物质守恒**：整层大气中由[参数化](@entry_id:265163)引起的水物质净变化率，必须等于地表蒸发（源）与降水（汇）之差。
*   **能量守恒**：整层大气中由[参数化](@entry_id:265163)引起的能量（包括感热、潜热和[动能耗散](@entry_id:751026)转换的热量）净变化率，必须等于进出大气柱的净[辐射通量](@entry_id:151732)、地表[感热和潜热通量](@entry_id:1131472)，以及由降水带走的焓。

在长期气候模拟中，对这些守恒律的严格遵守至关重要。即使是微小、系统的守恒性破坏，在长达数十年或数百年的积分过程中也会累积起来，导致灾难性的**气候漂移** (climate drift)，例如全球平均温度的无端上升或下降，或全球总降水量的系统性偏差 。因此，确保[参数化](@entry_id:265163)方案的守恒性是气候模型开发中的一个核心技术要求。