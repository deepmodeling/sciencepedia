{
    "hands_on_practices": [
        {
            "introduction": "In numerical modeling, our grid is not just a set of abstract points; it is a discrete representation of a physical space. To translate the abstract language of differential equations into concrete numerical algorithms, we must first master the geometry of our domain. This first exercise  grounds us in this fundamental reality by asking us to derive the physical distances corresponding to angular increments in latitude and longitude on a sphere, a crucial first step in building any geophysical model.",
            "id": "4108645",
            "problem": "On a rotating planet approximated as a perfect sphere of constant radius $a$, latitude–longitude grids used in numerical weather prediction and climate modeling require accurate geometric metrics to convert angular grid spacings into physical distances. Consider standard spherical coordinates $(r,\\theta,\\lambda)$, where $r$ is the radial distance, $\\theta$ is the colatitude measured from the North Pole, and $\\lambda$ is the longitude. Let the geographic latitude be $\\varphi$ so that $\\theta = \\frac{\\pi}{2} - \\varphi$. \n\nStarting only from the Cartesian embedding of the sphere and the Euclidean dot product, derive the induced surface line element on the sphere $r=a$ in terms of the differentials $d\\varphi$ and $d\\lambda$. Then, using that line element:\n- Determine the arc length along a latitude circle at fixed latitude $\\varphi$ for a small positive angular increment $\\Delta\\lambda$ in longitude.\n- Determine the arc length along a meridian (a line of constant longitude) for a small positive angular increment $\\Delta\\varphi$ in latitude.\n\nAssume all angles are measured in radians. Express the final result as a row matrix containing the two arc lengths $[L_{\\text{lat}}\\;\\;L_{\\text{mer}}]$, in terms of $a$, $\\varphi$, $\\Delta\\lambda$, and $\\Delta\\varphi$. No numerical evaluation is required, and no rounding is needed. Do not include units in the final boxed answer.",
            "solution": "The problem is well-posed, scientifically grounded, and contains sufficient information for a unique solution. We begin by deriving the surface line element on a sphere of radius $a$ and then use it to find the specified arc lengths.\n\nFirst, we establish the Cartesian embedding of the spherical surface. A point on the surface of a sphere of radius $a$ can be described by a position vector $\\vec{R}$ in a Cartesian coordinate system $(x, y, z)$. The standard parameterization using spherical coordinates $(r, \\theta, \\lambda)$ is:\n$x = r \\sin\\theta \\cos\\lambda$\n$y = r \\sin\\theta \\sin\\lambda$\n$z = r \\cos\\theta$\nwhere $r$ is the radial distance, $\\theta$ is the colatitude ($0 \\le \\theta \\le \\pi$), and $\\lambda$ is the longitude ($0 \\le \\lambda < 2\\pi$).\n\nThe problem requires using the geographic latitude $\\varphi$, which is related to the colatitude $\\theta$ by $\\varphi = \\frac{\\pi}{2} - \\theta$, or $\\theta = \\frac{\\pi}{2} - \\varphi$. The range for latitude is $-\\frac{\\pi}{2} \\le \\varphi \\le \\frac{\\pi}{2}$. We substitute this relationship into the trigonometric functions involving $\\theta$:\n$\\sin\\theta = \\sin\\left(\\frac{\\pi}{2} - \\varphi\\right) = \\cos\\varphi$\n$\\cos\\theta = \\cos\\left(\\frac{\\pi}{2} - \\varphi\\right) = \\sin\\varphi$\n\nOn the surface of the sphere, the radius is constant, $r=a$. The position vector $\\vec{R}(\\varphi, \\lambda)$ can now be written in terms of latitude $\\varphi$ and longitude $\\lambda$:\n$\\vec{R}(\\varphi, \\lambda) = (a \\cos\\varphi \\cos\\lambda) \\hat{i} + (a \\cos\\varphi \\sin\\lambda) \\hat{j} + (a \\sin\\varphi) \\hat{k}$\n\nThe infinitesimal displacement vector $d\\vec{R}$ on this surface is given by the total differential of $\\vec{R}$:\n$d\\vec{R} = \\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda$\n\nWe calculate the partial derivatives of $\\vec{R}$ with respect to $\\varphi$ and $\\lambda$:\n$\\frac{\\partial \\vec{R}}{\\partial \\varphi} = (-a \\sin\\varphi \\cos\\lambda) \\hat{i} + (-a \\sin\\varphi \\sin\\lambda) \\hat{j} + (a \\cos\\varphi) \\hat{k}$\n$\\frac{\\partial \\vec{R}}{\\partial \\lambda} = (-a \\cos\\varphi \\sin\\lambda) \\hat{i} + (a \\cos\\varphi \\cos\\lambda) \\hat{j} + (0) \\hat{k}$\n\nThe squared length of this displacement vector, $ds^2$, is the induced surface line element, which is obtained by taking the Euclidean dot product of $d\\vec{R}$ with itself:\n$ds^2 = d\\vec{R} \\cdot d\\vec{R} = \\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda\\right) \\cdot \\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda\\right)$\n$ds^2 = \\left|\\frac{\\partial \\vec{R}}{\\partial \\varphi}\\right|^2 (d\\varphi)^2 + 2\\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} \\cdot \\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right) d\\varphi d\\lambda + \\left|\\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right|^2 (d\\lambda)^2$\n\nLet's compute the dot products:\n$\\left|\\frac{\\partial \\vec{R}}{\\partial \\varphi}\\right|^2 = (-a \\sin\\varphi \\cos\\lambda)^2 + (-a \\sin\\varphi \\sin\\lambda)^2 + (a \\cos\\varphi)^2$\n$= a^2 \\sin^2\\varphi \\cos^2\\lambda + a^2 \\sin^2\\varphi \\sin^2\\lambda + a^2 \\cos^2\\varphi$\n$= a^2 \\sin^2\\varphi (\\cos^2\\lambda + \\sin^2\\lambda) + a^2 \\cos^2\\varphi$\n$= a^2 \\sin^2\\varphi + a^2 \\cos^2\\varphi = a^2(\\sin^2\\varphi + \\cos^2\\varphi) = a^2$\n\n$\\left|\\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right|^2 = (-a \\cos\\varphi \\sin\\lambda)^2 + (a \\cos\\varphi \\cos\\lambda)^2 + 0^2$\n$= a^2 \\cos^2\\varphi \\sin^2\\lambda + a^2 \\cos^2\\varphi \\cos^2\\lambda$\n$= a^2 \\cos^2\\varphi (\\sin^2\\lambda + \\cos^2\\lambda) = a^2 \\cos^2\\varphi$\n\n$\\frac{\\partial \\vec{R}}{\\partial \\varphi} \\cdot \\frac{\\partial \\vec{R}}{\\partial \\lambda} = (-a \\sin\\varphi \\cos\\lambda)(-a \\cos\\varphi \\sin\\lambda) + (-a \\sin\\varphi \\sin\\lambda)(a \\cos\\varphi \\cos\\lambda) + (a \\cos\\varphi)(0)$\n$= a^2 \\sin\\varphi \\cos\\varphi \\cos\\lambda \\sin\\lambda - a^2 \\sin\\varphi \\cos\\varphi \\sin\\lambda \\cos\\lambda = 0$\nThe zero value of the off-diagonal term confirms that the latitude and longitude coordinates are orthogonal on the sphere.\n\nSubstituting these results back into the expression for $ds^2$, we obtain the line element in terms of $d\\varphi$ and $d\\lambda$:\n$ds^2 = a^2 (d\\varphi)^2 + a^2 \\cos^2\\varphi (d\\lambda)^2$\n\nNow, we use this line element to determine the two required arc lengths.\n\n1.  **Arc length along a latitude circle, $L_{\\text{lat}}$**\nA latitude circle is defined by a constant latitude, $\\varphi = \\text{const}$. Along this path, the differential change in latitude is zero, i.e., $d\\varphi = 0$. The line element simplifies to:\n$ds^2 = a^2 \\cos^2\\varphi (d\\lambda)^2$\nThe infinitesimal arc length is $ds = \\sqrt{a^2 \\cos^2\\varphi (d\\lambda)^2} = |a \\cos\\varphi d\\lambda|$. Since $a > 0$ and for any latitude $\\varphi \\in [-\\pi/2, \\pi/2]$, $\\cos\\varphi \\ge 0$, we have $ds = a \\cos\\varphi d\\lambda$.\nThe arc length $L_{\\text{lat}}$ for a small positive angular increment $\\Delta\\lambda$ in longitude is found by integrating $ds$ from $\\lambda_0$ to $\\lambda_0 + \\Delta\\lambda$. Since $a$ and $\\varphi$ are constant along this path:\n$L_{\\text{lat}} = \\int_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} a \\cos\\varphi \\, d\\lambda = a \\cos\\varphi \\int_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} d\\lambda = a \\cos\\varphi [\\lambda]_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} = a \\cos\\varphi \\Delta\\lambda$\n\n2.  **Arc length along a meridian, $L_{\\text{mer}}$**\nA meridian is defined by a constant longitude, $\\lambda = \\text{const}$. Along this path, the differential change in longitude is zero, i.e., $d\\lambda = 0$. The line element simplifies to:\n$ds^2 = a^2 (d\\varphi)^2$\nThe infinitesimal arc length is $ds = \\sqrt{a^2 (d\\varphi)^2} = |a d\\varphi| = a|d\\varphi|$, since $a > 0$.\nThe problem specifies a small positive angular increment $\\Delta\\varphi$, so we can set $|d\\varphi| = d\\varphi$. The arc length $L_{\\text{mer}}$ is found by integrating $ds$ from $\\varphi_0$ to $\\varphi_0 + \\Delta\\varphi$:\n$L_{\\text{mer}} = \\int_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} a \\, d\\varphi = a \\int_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} d\\varphi = a [\\varphi]_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} = a \\Delta\\varphi$\n\nThe two requested arc lengths are $L_{\\text{lat}} = a \\cos\\varphi \\Delta\\lambda$ and $L_{\\text{mer}} = a \\Delta\\varphi$. The final result is requested as a row matrix $[L_{\\text{lat}}\\;\\;L_{\\text{mer}}]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na \\cos\\varphi \\Delta\\lambda & a \\Delta\\varphi\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While the spherical surface defines the geometry of our fluid motions, the wind itself is a vector quantity that can be described in different coordinate systems. It is often convenient to work with a fixed, global Cartesian frame, yet the physical experience and governing equations of wind are inherently local—oriented up, south, and east. This practice  bridges that gap, guiding you through the essential derivation of transforming wind vectors from a global Cartesian basis to the local spherical basis, a skill indispensable for both model development and data analysis.",
            "id": "4108650",
            "problem": "In global Numerical Weather Prediction (NWP) and climate General Circulation Models (GCMs), winds are frequently represented in Earth-centered Cartesian coordinates but prognostic equations and diagnostics are most naturally expressed on the sphere. Consider an Earth-centered Earth-fixed Cartesian frame with axes $\\hat{\\mathbf{i}}$ (pointing toward longitude $\\phi=0$ on the equator), $\\hat{\\mathbf{j}}$ (pointing toward longitude $\\phi=\\pi/2$ on the equator), and $\\hat{\\mathbf{k}}$ (aligned with the rotation axis and pointing toward the North Pole). Let spherical polar coordinates $(r,\\theta,\\phi)$ be defined by $x=r\\sin\\theta\\cos\\phi$, $y=r\\sin\\theta\\sin\\phi$, and $z=r\\cos\\theta$, where $\\theta$ is the colatitude (angle from the North Pole) and $\\phi$ is the eastward longitude. Angles are measured in radians.\n\nA local wind vector $\\mathbf{V}$ at a point $(r,\\theta,\\phi)$ is given in Cartesian components as $\\mathbf{V}=u\\,\\hat{\\mathbf{i}}+v\\,\\hat{\\mathbf{j}}+w\\,\\hat{\\mathbf{k}}$, where $u$, $v$, and $w$ are the east–Greenwich, north–equator, and up–polar components respectively in the Cartesian basis.\n\nStarting only from fundamental definitions of spherical coordinates, the orthonormal spherical basis vectors at $(r,\\theta,\\phi)$, and the projection of a vector onto a basis via the dot product, derive the transformation formulas that give the spherical components $(v_r,v_\\theta,v_\\phi)$ of $\\mathbf{V}$ in terms of $(u,v,w)$ and $(\\theta,\\phi)$. Then, explain the physical meaning of each spherical component on a rotating sphere in the context of large-scale atmospheric dynamics.\n\nYour final answer must be the single analytic expression of $(v_r,v_\\theta,v_\\phi)$ as a row matrix whose entries depend on $u$, $v$, $w$, $\\theta$, and $\\phi$. No rounding is required. Angles must be in radians and do not include any units in the final expression.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, self-contained, and requires a standard, verifiable derivation in vector calculus with a direct application to geophysical fluid dynamics.\n\nThe task is to derive the transformation for a vector $\\mathbf{V}$ from a global Cartesian basis to a local spherical basis and to interpret the physical meaning of the resulting components.\n\nLet the Earth-centered Earth-fixed Cartesian coordinates be $(x,y,z)$ with corresponding orthonormal basis vectors $(\\hat{\\mathbf{i}},\\hat{\\mathbf{j}},\\hat{\\mathbf{k}})$. The spherical polar coordinates are $(r,\\theta,\\phi)$, where $r$ is the radial distance from the origin, $\\theta$ is the colatitude (the polar angle measured from the positive $z$-axis), and $\\phi$ is the longitude (the azimuthal angle measured from the positive $x$-axis in the $xy$-plane). The relationship between the two coordinate systems is given by:\n$$x=r\\sin\\theta\\cos\\phi$$\n$$y=r\\sin\\theta\\sin\\phi$$\n$$z=r\\cos\\theta$$\n\nA position vector $\\mathbf{r}$ can be written in Cartesian coordinates as $\\mathbf{r} = x\\,\\hat{\\mathbf{i}} + y\\,\\hat{\\mathbf{j}} + z\\,\\hat{\\mathbf{k}}$. Substituting the spherical definitions, we have:\n$$\\mathbf{r}(r,\\theta,\\phi) = (r\\sin\\theta\\cos\\phi)\\,\\hat{\\mathbf{i}} + (r\\sin\\theta\\sin\\phi)\\,\\hat{\\mathbf{j}} + (r\\cos\\theta)\\,\\hat{\\mathbf{k}}$$\n\nTo find the local orthonormal basis vectors for the spherical coordinate system, $(\\hat{\\mathbf{e}}_r, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_\\phi)$, we take the partial derivatives of the position vector $\\mathbf{r}$ with respect to each coordinate and normalize the resulting vectors.\n\nThe radial basis vector $\\hat{\\mathbf{e}}_r$ points in the direction of increasing $r$:\n$$\\frac{\\partial\\mathbf{r}}{\\partial r} = \\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}}$$\nThe magnitude of this vector is:\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial r}\\right| = \\sqrt{(\\sin\\theta\\cos\\phi)^2 + (\\sin\\theta\\sin\\phi)^2 + (\\cos\\theta)^2} = \\sqrt{\\sin^2\\theta(\\cos^2\\phi+\\sin^2\\phi) + \\cos^2\\theta} = \\sqrt{\\sin^2\\theta + \\cos^2\\theta} = 1$$\nSince the vector is already a unit vector, we have:\n$$\\hat{\\mathbf{e}}_r = \\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}}$$\n\nThe colatitudinal basis vector $\\hat{\\mathbf{e}}_\\theta$ points in the direction of increasing $\\theta$:\n$$\\frac{\\partial\\mathbf{r}}{\\partial\\theta} = r\\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + r\\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - r\\sin\\theta\\,\\hat{\\mathbf{k}}$$\nThe magnitude of this vector is:\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial\\theta}\\right| = \\sqrt{(r\\cos\\theta\\cos\\phi)^2 + (r\\cos\\theta\\sin\\phi)^2 + (-r\\sin\\theta)^2} = \\sqrt{r^2\\cos^2\\theta(\\cos^2\\phi+\\sin^2\\phi) + r^2\\sin^2\\theta} = \\sqrt{r^2(\\cos^2\\theta + \\sin^2\\theta)} = r$$\nNormalizing by its magnitude gives the unit vector:\n$$\\hat{\\mathbf{e}}_\\theta = \\frac{1}{r}\\frac{\\partial\\mathbf{r}}{\\partial\\theta} = \\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - \\sin\\theta\\,\\hat{\\mathbf{k}}$$\n\nThe azimuthal basis vector $\\hat{\\mathbf{e}}_\\phi$ points in the direction of increasing $\\phi$:\n$$\\frac{\\partial\\mathbf{r}}{\\partial\\phi} = -r\\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{i}} + r\\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{j}}$$\nThe magnitude of this vector is:\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial\\phi}\\right| = \\sqrt{(-r\\sin\\theta\\sin\\phi)^2 + (r\\sin\\theta\\cos\\phi)^2} = \\sqrt{r^2\\sin^2\\theta(\\sin^2\\phi+\\cos^2\\phi)} = \\sqrt{r^2\\sin^2\\theta} = r\\sin\\theta$$ (for $\\theta \\in [0, \\pi]$).\nNormalizing gives the unit vector:\n$$\\hat{\\mathbf{e}}_\\phi = \\frac{1}{r\\sin\\theta}\\frac{\\partial\\mathbf{r}}{\\partial\\phi} = -\\sin\\phi\\,\\hat{\\mathbf{i}} + \\cos\\phi\\,\\hat{\\mathbf{j}}$$\n\nThe set $\\{\\hat{\\mathbf{e}}_r, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_\\phi\\}$ forms a right-handed orthonormal basis at each point $(r,\\theta,\\phi)$.\n\nThe wind vector $\\mathbf{V}$ is given in the Cartesian basis as $\\mathbf{V} = u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}$. We wish to express this vector in the local spherical basis as $\\mathbf{V} = v_r\\,\\hat{\\mathbf{e}}_r + v_\\theta\\,\\hat{\\mathbf{e}}_\\theta + v_\\phi\\,\\hat{\\mathbf{e}}_\\phi$. The components $(v_r, v_\\theta, v_\\phi)$ are found by projecting $\\mathbf{V}$ onto each of the spherical basis vectors using the dot product, as they form an orthonormal set.\n\nThe radial component, $v_r$:\n$$v_r = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_r = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (\\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}})$$\n$$v_r = u\\sin\\theta\\cos\\phi + v\\sin\\theta\\sin\\phi + w\\cos\\theta$$\n\nThe colatitudinal component, $v_\\theta$:\n$$v_\\theta = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_\\theta = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (\\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - \\sin\\theta\\,\\hat{\\mathbf{k}})$$\n$$v_\\theta = u\\cos\\theta\\cos\\phi + v\\cos\\theta\\sin\\phi - w\\sin\\theta$$\n\nThe azimuthal component, $v_\\phi$:\n$$v_\\phi = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_\\phi = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (-\\sin\\phi\\,\\hat{\\mathbf{i}} + \\cos\\phi\\,\\hat{\\mathbf{j}})$$\n$$v_\\phi = -u\\sin\\phi + v\\cos\\phi$$\n\nThese are the required transformation formulas.\n\nPhysical Meaning of the Spherical Components:\nIn the context of atmospheric dynamics, the wind vector $\\mathbf{V}$ represents the motion of air. The spherical components have direct physical interpretations for large-scale flow on a rotating sphere like the Earth.\n\n$1$. $v_r$: This is the radial component of velocity. On a sphere of radius $r$ representing the Earth, this component points directly away from the center of the Earth. It is therefore the **vertical velocity**. A positive $v_r$ indicates upward motion (ascent), while a negative $v_r$ indicates downward motion (subsidence). For large-scale (synoptic scale) atmospheric motions, $|v_r|$ is typically much smaller than the horizontal wind speeds, a fact that motivates the hydrostatic approximation in many NWP models. However, vertical motion is critically important for weather phenomena such as cloud formation, precipitation, and convection.\n\n$2$. $v_\\theta$: This is the component of velocity in the direction of increasing colatitude $\\theta$. Since $\\theta=0$ at the North Pole and $\\theta=\\pi$ at the South Pole, the direction of increasing $\\theta$ is southward. Thus, $v_\\theta$ represents the **southward velocity**. A positive $v_\\theta$ corresponds to a wind blowing towards the south, and a negative $v_\\theta$ corresponds to a wind blowing towards the north. This is the **meridional wind** component. Meridional winds are essential for the global energy balance, as they transport heat from the tropics towards the poles.\n\n$3$. $v_\\phi$: This is the component of velocity in the direction of increasing longitude $\\phi$. By convention, longitude increases towards the east. Therefore, $v_\\phi$ represents the **eastward velocity**. A positive $v_\\phi$ corresponds to a wind from the west (a westerly), and a negative $v_\\phi$ corresponds to a wind from the east (an easterly). This is the **zonal wind** component. Zonal winds are often the dominant component of large-scale atmospheric circulation, exemplified by the powerful jet streams in the mid-latitudes.",
            "answer": "$$\\boxed{\\begin{pmatrix} u\\sin\\theta\\cos\\phi + v\\sin\\theta\\sin\\phi + w\\cos\\theta & u\\cos\\theta\\cos\\phi + v\\cos\\theta\\sin\\phi - w\\sin\\theta & -u\\sin\\phi + v\\cos\\phi \\end{pmatrix}}$$"
        },
        {
            "introduction": "Having established the geometry of the sphere and the representation of vectors, we now confront a critical question at the heart of numerical modeling: how do we accurately compute derivatives on a curved surface? A naive application of finite differences that ignores the underlying geometry can lead to substantial, physically meaningless errors. This final exercise  serves as a vital case study, challenging you to quantify the error introduced by neglecting metric factors and thereby cementing the importance of geometric fidelity in numerical calculus.",
            "id": "4108641",
            "problem": "In global numerical weather prediction and climate modeling, the horizontal gradient operators are applied on a sphere of radius $a$, with position described by longitude $\\lambda$ and latitude $\\varphi$. Consider a scalar field $q(\\lambda,\\varphi)$ restricted to a latitude circle at fixed $\\varphi$. A common but flawed implementation in some preconditioning and diagnostics treats the zonal derivative as if the arc length per unit longitude were independent of latitude, effectively neglecting the latitude-dependent metric factor. This corresponds to replacing the correct physical derivative along the zonal direction by one that omits the factor $\\cos \\varphi$.\n\nStarting from first principles of spherical geometry for an Earth-like sphere of constant radius $a$ and the definition of the physical derivative as change per unit arc length along the latitude circle, derive an expression for the relative error (defined as the absolute error divided by the true magnitude) introduced by neglecting the metric factor $\\cos \\varphi$ in the zonal derivative. Your derivation must begin from the relationship between differential arc length and coordinate increments on the sphere and proceed to the chain rule linking derivatives with respect to arc length and coordinate derivatives.\n\nThen, evaluate the magnitude of this relative error for a representative midlatitude, $\\varphi_{0} = 45^\\circ$, assuming radian arguments for trigonometric functions. Express the final answer as a decimal fraction rounded to four significant figures. No physical units are required for the relative error.",
            "solution": "The problem requires the derivation of the relative error introduced by an incorrect simplification of the zonal derivative on a spherical surface. The derivation must start from first principles of spherical geometry and the definition of a physical derivative.\n\nFirst, we establish the coordinate system. On a sphere of constant radius $a$, a point is described by its longitude $\\lambda$ and latitude $\\varphi$. We are interested in the derivative of a scalar field $q(\\lambda, \\varphi)$ along a circle of constant latitude $\\varphi$. The radius of this latitude circle is $r_{\\text{lat}} = a \\cos\\varphi$.\n\nThe differential arc length, $ds_{\\lambda}$, along this circle corresponding to a differential change in longitude, $d\\lambda$, is given by the radius of the circle multiplied by the angle subtended. The angle must be in radians.\n$$\nds_{\\lambda} = (a \\cos\\varphi) \\, d\\lambda\n$$\nThis equation relates the physical distance along the zonal direction to the change in the longitude coordinate. The term $a \\cos\\varphi$ is the metric factor or scale factor for the $\\lambda$ coordinate.\n\nThe true physical derivative of the scalar field $q$ with respect to the arc length $s_{\\lambda}$ in the zonal direction is denoted by $D_{\\text{true}}$. Applying the chain rule for derivatives, we have:\n$$\nD_{\\text{true}} = \\frac{dq}{ds_{\\lambda}}\n$$\nSince $q$ is given as a function of the coordinates $\\lambda$ and $\\varphi$, and we are moving along a path of constant $\\varphi$, this becomes:\n$$\nD_{\\text{true}} = \\frac{\\partial q}{\\partial \\lambda} \\frac{d\\lambda}{ds_{\\lambda}}\n$$\nFrom the expression for the differential arc length, we find the relationship:\n$$\n\\frac{d\\lambda}{ds_{\\lambda}} = \\frac{1}{a \\cos\\varphi}\n$$\nSubstituting this into the expression for the true derivative yields:\n$$\nD_{\\text{true}} = \\frac{1}{a \\cos\\varphi} \\frac{\\partial q}{\\partial \\lambda}\n$$\n\nNext, we consider the flawed derivative described in the problem statement. The flaw consists of neglecting the latitude-dependent metric factor $\\cos\\varphi$. This is equivalent to assuming that the arc length per unit longitude, $\\frac{ds_{\\lambda}}{d\\lambda}$, is constant and equal to its value at the equator ($\\varphi=0$), which is $a$. This implies a flawed differential arc length, $ds'_{\\lambda}$, defined by:\n$$\nds'_{\\lambda} = a \\, d\\lambda\n$$\nThe corresponding flawed derivative, $D_{\\text{flawed}}$, is calculated using this incorrect arc length:\n$$\nD_{\\text{flawed}} = \\frac{dq}{ds'_{\\lambda}} = \\frac{\\partial q}{\\partial \\lambda} \\frac{d\\lambda}{ds'_{\\lambda}}\n$$\nUsing the flawed relationship $\\frac{d\\lambda}{ds'_{\\lambda}} = \\frac{1}{a}$, we get:\n$$\nD_{\\text{flawed}} = \\frac{1}{a} \\frac{\\partial q}{\\partial \\lambda}\n$$\n\nNow, we can compute the error. The absolute error, $E_{\\text{abs_val}}$, is the magnitude of the difference between the flawed and true derivatives:\n$$\nE_{\\text{abs_val}} = |D_{\\text{flawed}} - D_{\\text{true}}| = \\left| \\frac{1}{a} \\frac{\\partial q}{\\partial \\lambda} - \\frac{1}{a \\cos\\varphi} \\frac{\\partial q}{\\partial \\lambda} \\right|\n$$\nFactoring out common terms:\n$$\nE_{\\text{abs_val}} = \\left| \\frac{1}{a} \\left( 1 - \\frac{1}{\\cos\\varphi} \\right) \\frac{\\partial q}{\\partial \\lambda} \\right| = \\frac{1}{a} \\left| 1 - \\frac{1}{\\cos\\varphi} \\right| \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|\n$$\nFor typical latitudes $\\varphi \\in (-\\frac{\\pi}{2}, \\frac{\\pi}{2})$, we have $0 < \\cos\\varphi \\le 1$. Therefore, $\\frac{1}{\\cos\\varphi} \\ge 1$, which implies $1 - \\frac{1}{\\cos\\varphi} \\le 0$. Thus, the absolute value is:\n$$\nE_{\\text{abs_val}} = \\frac{1}{a} \\left( \\frac{1}{\\cos\\varphi} - 1 \\right) \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|\n$$\n\nThe relative error, $E_{\\text{rel}}$, is defined as the absolute error divided by the magnitude of the true value. We assume $\\frac{\\partial q}{\\partial \\lambda} \\neq 0$ to avoid a trivial case.\n$$\nE_{\\text{rel}} = \\frac{E_{\\text{abs_val}}}{|D_{\\text{true}}|} = \\frac{\\frac{1}{a} \\left( \\frac{1}{\\cos\\varphi} - 1 \\right) \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|}{\\left| \\frac{1}{a \\cos\\varphi} \\frac{\\partial q}{\\partial \\lambda} \\right|}\n$$\nThe magnitude of the true derivative is:\n$$\n|D_{\\text{true}}| = \\frac{1}{a \\cos\\varphi} \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|\n$$\nSubstituting this into the expression for relative error:\n$$\nE_{\\text{rel}} = \\frac{\\frac{1}{a} \\left( \\frac{1}{\\cos\\varphi} - 1 \\right) \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|}{\\frac{1}{a \\cos\\varphi} \\left| \\frac{\\partial q}{\\partial \\lambda} \\right|}\n$$\nThe terms $\\frac{1}{a}$ and $\\left| \\frac{\\partial q}{\\partial \\lambda} \\right|$ cancel out, provided the latter is non-zero.\n$$\nE_{\\text{rel}} = \\frac{\\frac{1}{\\cos\\varphi} - 1}{\\frac{1}{\\cos\\varphi}} = \\left( \\frac{1}{\\cos\\varphi} - 1 \\right) \\cos\\varphi\n$$\n$$\nE_{\\text{rel}} = 1 - \\cos\\varphi\n$$\nThis expression gives the relative error as a function of latitude $\\varphi$.\n\nFinally, we evaluate the magnitude of this relative error for the representative midlatitude $\\varphi_{0} = 45^\\circ$. In radians, this is $\\varphi_{0} = \\frac{\\pi}{4}$.\n$$\nE_{\\text{rel}}|_{\\varphi_0=45^\\circ} = 1 - \\cos(45^\\circ) = 1 - \\cos\\left(\\frac{\\pi}{4}\\right)\n$$\nThe exact value of $\\cos(45^\\circ)$ is $\\frac{\\sqrt{2}}{2}$.\n$$\nE_{\\text{rel}} = 1 - \\frac{\\sqrt{2}}{2}\n$$\nTo obtain a decimal fraction, we use the numerical value of $\\sqrt{2} \\approx 1.41421356...$.\n$$\nE_{\\text{rel}} \\approx 1 - \\frac{1.41421356}{2} = 1 - 0.70710678... = 0.29289322...\n$$\nRounding to four significant figures, the relative error is $0.2929$.",
            "answer": "$$\n\\boxed{0.2929}\n$$"
        }
    ]
}