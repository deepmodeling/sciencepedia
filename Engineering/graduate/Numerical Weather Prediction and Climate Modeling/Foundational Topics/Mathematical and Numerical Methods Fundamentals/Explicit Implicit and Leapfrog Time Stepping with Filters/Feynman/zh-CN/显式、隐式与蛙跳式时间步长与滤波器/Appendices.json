{
    "hands_on_practices": [
        {
            "introduction": "稳定性是数值模拟中的首要问题。对于显式时间步进格式，其稳定性受到 Courant-Friedrichs-Lewy (CFL) 条件的限制。本练习  将演示如何为一个高阶龙格-库塔格式确定此限制。通过推导稳定性多项式并分析其性质，你将深入理解时间积分方法和空间离散化的选择如何共同决定最大稳定时间步长，这是开发和使用数值模型的一项基本技能。",
            "id": "4041369",
            "problem": "考虑定义在间距为 $\\Delta x$ 的均匀周期性网格上的一维线性平流方程，\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\n其中 $a$ 是一个恒定的平流速度。在空间上使用二阶中心有限差分，网格点值 $u_j(t)$ 的半离散系统可以写为\n$$\n\\partial_t u_j(t) = -a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x},\n$$\n其形式为 $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$，其中 $\\mathbf{L}$ 是一个常数矩阵。对于这种带有周期性边界的空间离散化，傅里叶模 $e^{\\mathrm{i} k j \\Delta x}$ 是 $\\mathbf{L}$ 的特征向量，其对应的特征值为\n$$\n\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}.\n$$\n您将使用以 Shu–Osher 形式给出的三阶段三阶强保稳 Runge–Kutta 方法 (SSPRK(3,3)) 对此半离散系统进行时间步进，其阶段如下\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n,\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right),\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right).\n$$\n从以下基本事实出发：应用于 $\\partial_t \\mathbf{u} = \\mathbf{L}\\,\\mathbf{u}$ 的线性时间步进方法的稳定性由该方法的标量稳定性多项式 $R(z)$ 通过要求 $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ 对 $\\mathbf{L}$ 的所有特征值 $\\lambda_k$ 成立来决定，并且离散傅里叶分析刻画了周期性线性平流的 $\\mathbf{L}$ 的谱。请推导 SSPRK(3,3) 的稳定性多项式 $R(z)$，确定其沿虚轴的 $|\\cdot| \\leq 1$ 区域，并计算确保对于网格支持的所有波数 $k$ 都有 $|R(\\Delta t\\,\\lambda(k))| \\leq 1$ 成立的最大时间步长 $\\Delta t$。请用一个包含 $a$ 和 $\\Delta x$ 的闭式解析表达式来表示您的最终答案。以秒为单位表示最终允许的时间步长。无需四舍五入。",
            "solution": "本题要求在使用特定的空间离散化和时间积分格式求解线性平流方程时，所允许的最大时间步长 $\\Delta t$。此过程的稳定性由条件 $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ 对半离散算子 $\\mathbf{L}$ 的所有特征值 $\\lambda_k$ 成立来决定。求解过程需要三个主要步骤：首先，为给定的时间步进方法（SSPRK(3,3)）推导稳定性多项式 $R(z)$；其次，确定该多项式沿虚轴的稳定区域，因为特征值 $\\lambda_k$ 是纯虚数；第三，利用这个稳定区域来约束 $\\Delta t$。\n\n半离散系统由 $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$ 给出。SSPRK(3,3) 方法通过三个阶段将解从时间步 $n$推进到 $n+1$：\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right)\n$$\n为了找到稳定性多项式 $R(z)$，我们将 $\\mathbf{u}^{n+1}$ 完全用 $\\mathbf{u}^n$ 来表示。令 $z = \\Delta t\\,\\mathbf{L}$。该方法可以写成 $\\mathbf{u}^{n+1} = R(z)\\,\\mathbf{u}^n$。\n\n第一阶段：\n$$\n\\mathbf{u}^{(1)} = (\\mathbf{I} + z)\\,\\mathbf{u}^n\n$$\n第二阶段：将 $\\mathbf{u}^{(1)}$ 代入其定义。\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(1)}\\right) = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}(\\mathbf{I}+z)(\\mathbf{I}+z)\\,\\mathbf{u}^n = \\left(\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I}+z)^2\\right)\\,\\mathbf{u}^n\n$$\n展开关于 $z$ 的多项式：\n$$\n\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I} + 2z + z^2) = \\left(\\frac{3}{4}+\\frac{1}{4}\\right)\\mathbf{I} + \\frac{2}{4}z + \\frac{1}{4}z^2 = \\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\n$$\n所以，$\\mathbf{u}^{(2)} = \\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\mathbf{u}^n$。\n\n第三阶段：将 $\\mathbf{u}^{(2)}$ 代入 $\\mathbf{u}^{n+1}$ 的最终表达式。\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(2)}\\right) = \\left(\\frac{1}{3}\\mathbf{I} + \\frac{2}{3}(\\mathbf{I}+z)\\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\right)\\,\\mathbf{u}^n\n$$\n乘以 $\\mathbf{u}^n$ 的算子就是稳定性多项式 $R(z)$。\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\n$$\n我们展开乘积：\n$$\n(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right) = 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 + z + \\frac{1}{2}z^2 + \\frac{1}{4}z^3 = 1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\n$$\n将此代回 $R(z)$ 的表达式中：\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}\\left(1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\\right) = \\frac{1}{3} + \\frac{2}{3} + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\n因此，SSPRK(3,3) 的稳定性多项式为：\n$$\nR(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\n这是 $\\exp(z)$ 的三阶泰勒级数展开，与该方法的精度阶相符。\n\n接下来，我们分析 $R(z)$ 在虚轴上的稳定性。空间算子的特征值由 $\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}$ 给出，它们是纯虚数。因此，稳定性多项式的自变量 $z_k = \\Delta t\\,\\lambda(k)$ 也是纯虚数。我们令 $z = \\mathrm{i} y$，其中 $y$ 为实数，并找出使 $|R(\\mathrm{i} y)| \\leq 1$ 成立的 $y$ 的值。\n$$\nR(\\mathrm{i} y) = 1 + (\\mathrm{i} y) + \\frac{1}{2}(\\mathrm{i} y)^2 + \\frac{1}{6}(\\mathrm{i} y)^3 = 1 + \\mathrm{i} y - \\frac{1}{2}y^2 - \\frac{\\mathrm{i}}{6}y^3\n$$\n将实部和虚部分组：\n$$\nR(\\mathrm{i} y) = \\left(1 - \\frac{1}{2}y^2\\right) + \\mathrm{i}\\left(y - \\frac{1}{6}y^3\\right)\n$$\n模的平方为：\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + \\left(y - \\frac{1}{6}y^3\\right)^2\n$$\n展开各项：\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - y^2 + \\frac{1}{4}y^4\\right) + \\left(y^2 - \\frac{2}{6}y^4 + \\frac{1}{36}y^6\\right)\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 - y^2 + \\frac{1}{4}y^4 + y^2 - \\frac{1}{3}y^4 + \\frac{1}{36}y^6\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 + \\left(\\frac{1}{4} - \\frac{1}{3}\\right)y^4 + \\frac{1}{36}y^6 = 1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6\n$$\n稳定性条件 $|R(\\mathrm{i} y)|^2 \\leq 1$ 变为：\n$$\n1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6 \\leq 1\n$$\n$$\n\\frac{1}{36}y^6 - \\frac{1}{12}y^4 \\leq 0\n$$\n假设 $y \\neq 0$，我们可以除以正量 $\\frac{y^4}{36}$：\n$$\ny^2 - 3 \\leq 0 \\implies y^2 \\leq 3\n$$\n这意味着 $|y| \\leq \\sqrt{3}$。SSPRK(3,3) 方法沿虚轴的稳定区间是 $[-i\\sqrt{3}, i\\sqrt{3}]$。\n\n最后，我们将此约束应用于给定的问题。稳定性条件要求对于所有波数 $k$，值 $z_k = \\Delta t\\,\\lambda(k)$ 都必须位于此稳定区间内。\n$$\nz_k = \\Delta t \\left(\\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}\\right) = \\mathrm{i} \\left(\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right)\n$$\n其形式为 $\\mathrm{i} y_k$，其中 $y_k = \\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)$。稳定性条件 $|y_k| \\leq \\sqrt{3}$ 必须对所有 $k$ 成立。\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right| \\leq \\sqrt{3}\n$$\n因为 $\\Delta t > 0$ 且 $\\Delta x > 0$，这等价于：\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x}|\\sin(k\\,\\Delta x)| \\leq \\sqrt{3}\n$$\n为确保此不等式对网格支持的所有波数 $k$ 均成立，我们必须考虑最坏情况，即 $|\\sin(k\\,\\Delta x)|$ 达到其最大值时。$|\\sin(\\theta)|$ 的最大值为 $1$。因此，我们必须满足：\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x} \\cdot 1 \\leq \\sqrt{3}\n$$\n最大时间步长 $\\Delta t$ 可通过取等号得到：\n$$\n\\Delta t = \\frac{\\sqrt{3}\\,\\Delta x}{|a|}\n$$\n此表达式给出了确保对所有波数都数值稳定的最大允许时间步长 $\\Delta t$（单位为秒）。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{3} \\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "经典的蛙跳格式虽然计算效率高，但可能会表现出非物理行为。一个关键问题是它在处理正定物理量（如湿度或示踪剂浓度）时遇到的困难。本练习  将探讨蛙跳格式在何种条件下无法保持被平流物理量的非负性。通过研究一个“最坏情况”的场景，你将揭示标准蛙跳格式的一个根本性限制，并理解为何保证物理约束（如正定性）通常需要超越简单稳定性的更专门的数值技术。",
            "id": "4041408",
            "problem": "考虑一个守恒的、非反应性的水汽混合比 $q(x,t)$ 的一维线性平流，它由守恒律 $q_{t} + a\\,q_{x} = 0$ 在一个具有均匀网格间距 $\\Delta x$ 和恒定平流速度 $a \\in \\mathbb{R}$ 的周期性域上控制。令 $q_{j}^{n}$ 表示在空间指数 $j \\in \\mathbb{Z}$ 和离散时间层 $n \\in \\mathbb{Z}$ 处 $q$ 的离散近似，时间步长 $\\Delta t$ 是均匀的。时间蛙跳、空间中心的离散化定义为\n$$\n\\frac{q_{j}^{n+1} - q_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{q_{j+1}^{n} - q_{j-1}^{n}}{2\\,\\Delta x} \\;=\\; 0,\n$$\n可以写成\n$$\nq_{j}^{n+1} \\;=\\; q_{j}^{n-1} \\;-\\; \\lambda\\left(q_{j+1}^{n} - q_{j-1}^{n}\\right),\n$$\n其中库朗数 (Courant number) 为 $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。此外，假设在每次更新后应用一个系数为 $\\nu \\in [0,1)$ 的 Robert–Asselin (RA) 滤波器来抑制计算模态，其定义为\n$$\nq_{j}^{n} \\;\\leftarrow\\; q_{j}^{n} \\;+\\; \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right).\n$$\n假设进入更新的离散场对所有 $j$ 满足 $q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$，且对其空间分布没有进一步的限制。从守恒律和给定的离散化出发，推导库朗数 $\\lambda$ 的一个条件（表示为单个界限），在该条件下，蛙跳格式保持非负性，即只要对所有 $j$ 都有 $q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$，那么对所有 $j$ 都有 $q_{j}^{n+1} \\ge 0$。然后，分析在更新步骤 $n \\mapsto n+1$ 中，带有任意固定 $\\nu \\in [0,1)$ 的 RA 滤波器的存在是否可以放宽或修改此界限。请将您的最终条件以单个实数值或单个闭式表达式的形式给出，该表达式表示保证更新时非负性得以保持的最大允许库朗数 $\\lambda_{\\max}(\\nu)$。不需要四舍五入，且库朗数是无量纲的，因此不需要物理单位。",
            "solution": "该问题将首先被验证，如果有效，将按要求分两部分解决。首先，将推导未滤波的蛙跳格式保持非负性时对库朗数 $\\lambda$ 的条件。其次，将分析 Robert–Asselin (RA) 滤波器对此条件的影响。\n\n问题验证：\n步骤1：提取已知条件\n- 控制偏微分方程：$q_{t} + a\\,q_{x} = 0$。\n- 变量：$q(x,t)$ 是一个守恒的、非反应性的水汽混合比。\n- 平流速度：$a$ 是 $\\mathbb{R}$ 中的一个常数。\n- 离散化：$q_{j}^{n}$ 是在网格点 $j \\in \\mathbb{Z}$ 和时间层 $n \\in \\mathbb{Z}$ 处的近似值。网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 是均匀的。\n- 蛙跳格式：$\\frac{q_{j}^{n+1} - q_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{q_{j+1}^{n} - q_{j-1}^{n}}{2\\,\\Delta x} = 0$。\n- 蛙跳更新规则：$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$，其中 $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。\n- Robert–Asselin (RA) 滤波器：在每次更新后应用，定义为 $q_{j}^{n} \\leftarrow q_{j}^{n} + \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right)$。\n- 滤波器系数：$\\nu \\in [0,1)$。\n- 更新步骤的条件：进入更新的场 $q_{j}^{n-1}$ 和 $q_{j}^{n}$ 对所有 $j$ 都是非负的：$q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$。对其空间分布没有进一步的限制。\n- 目标：为未滤波的格式推导一个保证 $q_{j}^{n+1} \\ge 0$ 的关于 $\\lambda$ 的条件。然后，分析 RA 滤波器是否会修改此条件。最后，提供保证非负性得以保持的最大允许库朗数 $\\lambda_{\\max}(\\nu)$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它处理的是与数值天气预报相关的基本模型方程（线性平流）的标准数值方法（蛙跳格式、RA 滤波器）。它是适定的，提供了执行所需分析的所有必要定义和约束。语言客观、明确。所有术语在偏微分方程数值分析领域都是标准的。该问题不违反任何科学原理，不是不完整的，也不是不适定的。\n\n步骤3：结论与行动\n该问题被判定为 **有效**。将提供一个完整的、有理有据的解答。\n\n解答：\n第一部分：未滤波蛙跳格式的非负性\n\n时间蛙跳、空间中心的格式由以下更新规则给出：\n$$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$$\n给定在时间层 $n-1$ 和 $n$ 的场是非负的，即对于所有空间指数 $k \\in \\mathbb{Z}$，都有 $q_{k}^{n-1} \\ge 0$ 和 $q_{k}^{n} \\ge 0$。问题要求找到库朗数 $\\lambda$ 的条件，以保证对所有 $j$ 都有 $q_{j}^{n+1} \\ge 0$，前提是初始数据 $q^{n-1}$ 和 $q^{n}$ 可以是任何非负场，“且对其空间分布没有进一步的限制”。\n\n这要求以下不等式对任意选择的非负场 $q^{n-1}$ 和 $q^{n}$ 都成立：\n$$q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n}) \\ge 0$$\n为了找到一个普遍成立的关于 $\\lambda$ 的条件，我们必须考虑最有可能违反此不等式的“最坏情况”。这种情况会试图使左侧尽可能小（即，尽可能为负）。\n\n根据假设，项 $q_{j}^{n-1}$ 是非负的。为了最小化该表达式，我们可以选择一个非负场 $q^{n-1}$，其中 $q_j^{n-1}$ 取其可能的最小值，即 $0$。例如，我们可以选择对所有 $k$ 都有 $q_{k}^{n-1} = 0$ 的平凡场。根据问题陈述，这是一个有效的选择。\n\n当 $q_{j}^{n-1} = 0$ 时，不等式简化为：\n$$-\\lambda(q_{j+1}^{n} - q_{j-1}^{n}) \\ge 0$$\n这必须对任何非负场 $q^n$ 都成立。我们根据 $\\lambda$ 的符号对此进行分析。恒定平流速度 $a$ 可以是任意实数，所以 $\\lambda$ 可以是正数、负数或零。\n\n情况1：$\\lambda > 0$。\n条件变为 $q_{j+1}^{n} - q_{j-1}^{n} \\le 0$，或 $q_{j+1}^{n} \\le q_{j-1}^{n}$。这个不等式必须对所有 $j$ 和任何非负场 $q^n$ 都成立。这显然是错误的。我们可以自由选择一个违反此条件的非负场 $q^n$。对于一个特定的指数 $j$，考虑由下式定义的场：\n$$\nq_{k}^{n} = \\begin{cases} 1 & \\text{if } k = j+1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n该场是非负的。对于此选择，$q_{j+1}^{n} = 1$ 且 $q_{j-1}^{n} = 0$，所以 $q_{j+1}^{n} - q_{j-1}^{n} = 1 > 0$。条件被违反。在 $j$ 处的所得值为 $q_{j}^{n+1} = 0 - \\lambda(1 - 0) = -\\lambda$。由于 $\\lambda > 0$，所以 $q_{j}^{n+1}  0$。因此，没有 $\\lambda  0$ 可以保证非负性。\n\n情况2：$\\lambda  0$。\n条件变为 $q_{j+1}^{n} - q_{j-1}^{n} \\ge 0$，或 $q_{j+1}^{n} \\ge q_{j-1}^{n}$。同样，这必须对任何非负场 $q^n$ 都成立，而这并非事实。考虑以下反例场：\n$$\nq_{k}^{n} = \\begin{cases} 1  \\text{if } k = j-1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n该场是非负的。对于此选择，$q_{j+1}^{n} = 0$ 且 $q_{j-1}^{n} = 1$，所以 $q_{j+1}^{n} - q_{j-1}^{n} = -1  0$。条件被违反。在 $j$ 处的所得值为 $q_{j}^{n+1} = 0 - \\lambda(0 - 1) = \\lambda$。由于 $\\lambda  0$，所以 $q_{j}^{n+1}  0$。因此，没有 $\\lambda  0$ 可以保证非负性。\n\n情况3：$\\lambda = 0$。\n更新规则变为 $q_{j}^{n+1} = q_{j}^{n-1}$。由于我们假设 $q_{j}^{n-1} \\ge 0$，因此 $q_{j}^{n+1} \\ge 0$。此条件成立。\n\n根据此分析，对于任意非负输入场，未滤波的蛙跳格式保持非负性的唯一库朗数值是 $\\lambda = 0$。\n\n第二部分：Robert–Asselin 滤波器的影响\n\n该问题描述了每个时间更新的两步过程。首先，使用蛙跳格式计算下一个时间层 $n+1$ 的临时值。其次，应用一个滤波器。问题在于滤波器是否可以放宽对 $\\lambda$ 的非负性条件。\n\n步骤1：使用蛙跳规则计算 $q_j^{n+1}$：\n$$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$$\n步骤2：应用 RA 滤波器，该滤波器更新时间层 $n$ 的值：\n$$q_{j}^{n} \\leftarrow q_{j}^{n} + \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right)$$\n问题的第一个部分是找到保证 $q_{j}^{n+1} \\ge 0$ 的关于 $\\lambda$ 的条件。$q_j^{n+1}$ 的方程仅由步骤1确定。该方程不涉及滤波器参数 $\\nu$。滤波器是在计算出 $q_{j}^{n+1}$ *之后* 应用的，并使用此值来修改 $q_j^n$。根据定义，该滤波器在当前更新中不会改变 $q_{j}^{n+1}$ 的值。\n\n因此，保证 $q_{j}^{n+1} \\ge 0$ 的条件完全独立于参数为 $\\nu$ 的 RA 滤波器。第一部分的分析保持不变。引入 RA 滤波器不会放宽或修改对 $\\lambda$ 的界限。\n\n关于 $\\lambda_{\\max}(\\nu)$ 的结论：\n\n最大允许库朗数 $\\lambda_{\\max}$ 是保证非负性得以保持的 $|\\lambda|$ 值集合的上确界。根据我们的分析，满足条件的唯一 $\\lambda$ 值为 $\\lambda=0$。无论滤波器参数 $\\nu \\in [0,1)$ 的值如何，这都成立。因此，作为 $\\nu$ 函数的最大允许库朗数是一个常数函数。\n$$\\lambda_{\\max}(\\nu) = 0$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "蛙跳格式一个众所周知的问题是会引入一个可能污染解的虚假“计算模”。时间滤波器是解决这一问题常用且有效的方法。本练习  将从分析现有格式转向设计数值工具。你将设计一个定制的三层时间滤波器，并对其进行优化，以最大程度地抑制计算模，同时对物理模的影响降至最低。这个动手设计问题将通过平衡相互竞争的目标——抑制数值噪音与保持物理精度——来巩固你对滤波器工作原理的理解。你将构建并解决一个优化问题，以找到理想的滤波器系数，这项任务也反映了模型开发中的实际挑战。",
            "id": "4041376",
            "problem": "给定一个代表数值天气预报和气候模拟的离散时间线性波问题。考虑一个标量复振幅 $y(t)$，其由线性常微分方程 $dy/dt = i \\omega y$ 控制，其中 $\\omega$ 是一个实角频率。在均匀时间步长 $\\Delta t$ 上的离散时间步进格式由以下三种经典方法定义，其定性性质在文献中已有充分研究：\n\n- 显式（前向欧拉）：$y^{n+1} = y^n + i \\omega \\Delta t \\, y^n$。\n- 隐式（后向欧拉）：$y^{n+1} = y^n + i \\omega \\Delta t \\, y^{n+1}$。\n- 蛙跳：$y^{n+1} = y^{n-1} + 2 i \\omega \\Delta t \\, y^n$。\n\n显式和隐式单步方法不会引入时间解耦的计算模态。相比之下，两步蛙跳格式支持两种时间本征模：一种是物理模态，一种是计算模态，这是两步时间层耦合的结果。一种常见的补救方法是在每次蛙跳更新后应用一个线性时间滤波器，以抑制计算模态，同时尽可能保持物理模态的特性。\n\n设计一个作用于连续三个时间层的最小阶线性时间滤波器，\n$$\ny^n_{\\mathrm{filt}} = a \\, y^{n-1} + b \\, y^n + c \\, y^{n+1},\n$$\n须满足以下约束：\n- 常数保持：$a + b + c = 1$。\n- 物理模态的最小相位误差：强制对称性 $a = c$，以使物理模态经滤波器后产生零相移。\n- 滤波器权重的非负性：$a \\ge 0$, $b \\ge 0$, $c \\ge 0$。\n\n设离散振荡频率为 $\\theta = \\omega \\Delta t$，以弧度为单位。分析滤波器对两种模态时间序列的作用：\n- 物理模态序列：$y^n = e^{i n \\theta}$。\n- 计算模态序列：$y^n = (-1)^n e^{i n \\theta}$。\n\n使用时间上的傅里叶分析，推导滤波器的物理模态和计算模态放大因子，表示为 $a$、$b$、$c$ 和 $\\theta$ 的函数，并强制对称性 $a = c$。\n\n现在将设计构建为一个优化问题：对于给定的 $\\theta$ 和每次应用滤波器时允许的物理模态振幅损失的给定界限 $\\delta$，\n$$\n|1 - \\text{(physical-mode amplification)}| \\le \\delta,\n$$\n选择 $(a,b,c)$ 以最大程度地衰减计算模态（即，最小化其放大因子的绝对值），同时严格满足上述约束并保持物理模态的零相位误差。用一个辅助参数表示系数 $(a,b,c)$，并推导出作为 $\\theta$ 和 $\\delta$ 函数的闭式最优解。确保您的假设具有科学真实性和一致性。\n\n您的程序必须实现此设计，并为每个测试用例按此顺序计算以下输出：\n- 系数 $a$、$b$、$c$。\n- 物理模态振幅因子（一个实数）。\n- 物理模态相位误差（以弧度为单位，一个实数；当滤波器对称且振幅因子为非负时，使用 $0$）。\n- 计算模态振幅因子（一个实数）。\n\n所有角度输入均以弧度为单位。本问题中除角度外没有物理单位。\n\n测试套件：\n为以下 $(\\theta,\\delta)$ 对提供计算（其中 $\\theta$ 以弧度为单位，$\\delta$ 为无量纲的振幅损失界限）：\n1. $\\theta = 1.0$, $\\delta = 0.02$。\n2. $\\theta = 0.05$, $\\delta = 0.02$。\n3. $\\theta = 3.12$, $\\delta = 0.10$。\n4. $\\theta = 1.0$, $\\delta = 0.35$。\n5. $\\theta = 0.0$, $\\delta = 0.02$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身应是一个列表，顺序为\n$[a,b,c,\\text{phys\\_amp},\\text{phys\\_phase\\_error},\\text{comp\\_amp}]$。\n例如，整体打印输出必须如下所示\n$[[\\ldots],[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$。",
            "solution": "用户希望设计一个最优的三点对称时间滤波器，用于抑制蛙跳时间积分格式的计算模态。\n\n### 步骤 1：问题验证\n\n分析问题陈述，以确保其科学上合理、适定且完整。\n\n-   **逐字提取的已知条件：**\n    -   控制常微分方程：$dy/dt = i \\omega y$。\n    -   离散时间滤波器：$y^n_{\\mathrm{filt}} = a \\, y^{n-1} + b \\, y^n + c \\, y^{n+1}$。\n    -   约束 1 (常数保持)：$a + b + c = 1$。\n    -   约束 2 (零相位误差的对称性)：$a = c$。\n    -   约束 3 (非负性)：$a \\ge 0$, $b \\ge 0$, $c \\ge 0$。\n    -   离散振荡频率：$\\theta = \\omega \\Delta t$。\n    -   物理模态时间序列：$y^n = e^{i n \\theta}$。\n    -   计算模态时间序列：$y^n = (-1)^n e^{i n \\theta}$。\n    -   优化约束：$|1 - \\text{(physical-mode amplification)}| \\le \\delta$。\n    -   优化目标：最小化计算模态放大因子的绝对值。\n    -   测试套件：$(\\theta, \\delta)$ 对 $(1.0, 0.02)$, $(0.05, 0.02)$, $(3.12, 0.10)$, $(1.0, 0.35)$, $(0.0, 0.02)$。\n    -   要求输出：$[a, b, c, \\text{phys\\_amp}, \\text{phys\\_phase\\_error}, \\text{comp\\_amp}]$。\n\n-   **使用提取的已知条件进行验证：**\n    -   **科学依据：** 该问题是求解微分方程数值解中的一个经典课题，特别是在地球物理流体动力学领域。蛙跳格式、其计算模态以及时间滤波器（如此问题所推广的 Robert-Asselin 滤波器）的使用都是标准概念。该问题在数值分析中有坚实的基础。\n    -   **适定性：** 该问题建立了一个约束优化问题。变量、约束和目标函数都已明确定义。下面的推导将证实存在唯一、稳定且有意义的解。\n    -   **客观性：** 问题以精确、形式化的数学语言陈述，没有任何主观性。\n    -   **完整性：** 提供了推导滤波器系数并分析其性质所需的所有必要方程、约束和数据。\n    -   **可行性：** 测试套件中的参数值在物理上和数值上都是现实的。\n\n-   **结论：** 问题有效。\n\n### 步骤 2：滤波器属性推导\n\n滤波器定义为 $y^n_{\\mathrm{filt}} = a y^{n-1} + b y^n + c y^{n+1}$。约束 $a=c$ 和 $a+b+c=1$ 简化了滤波器系数。将 $c=a$ 代入第二个约束得到 $2a+b=1$，因此 $b=1-2a$。非负性约束 $a, c \\ge 0$ 和 $b \\ge 0$ 转化为 $a \\ge 0$ 和 $1-2a \\ge 0$，这将 $a$ 限制在范围 $0 \\le a \\le 1/2$ 内。因此，整个滤波器由单个参数 $a$ 定义。\n\n**放大因子分析**\n\n放大因子 $\\lambda$ 由关系式 $y^n_{\\mathrm{filt}} = \\lambda y^n$ 定义。我们将滤波器应用于每种模态。\n\n1.  **物理模态：** 设 $y^n = e^{i n \\theta}$。\n    $$\n    y^n_{\\mathrm{filt}} = a e^{i(n-1)\\theta} + b e^{in\\theta} + c e^{i(n+1)\\theta} = (a e^{-i\\theta} + b + c e^{i\\theta}) y^n\n    $$\n    物理模态放大因子为 $\\lambda_{\\text{phys}} = a e^{-i\\theta} + b + c e^{i\\theta}$。\n    使用 $a=c$ 和 $b=1-2a$：\n    $$\n    \\lambda_{\\text{phys}} = a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = 2a\\cos\\theta + 1 - 2a = 1 - 2a(1-\\cos\\theta)\n    $$\n    由于 $a$ 和 $\\theta$ 是实数，$\\lambda_{\\text{phys}}$ 也是实数。只要 $\\lambda_{\\text{phys}}$ 为非负，对称性约束 $a=c$ 就成功确保了零相移。物理模态振幅因子是 $|\\lambda_{\\text{phys}}|$。\n\n2.  **计算模态：** 设 $y^n = (-1)^n e^{i n \\theta}$。\n    $$\n    y^n_{\\mathrm{filt}} = a(-1)^{n-1}e^{i(n-1)\\theta} + b(-1)^n e^{in\\theta} + c(-1)^{n+1}e^{i(n+1)\\theta}\n    $$\n    除以 $y^n = (-1)^n e^{in\\theta}$ 得到放大因子：\n    $$\n    \\lambda_{\\text{comp}} = -a e^{-i\\theta} + b - c e^{i\\theta}\n    $$\n    使用 $a=c$ 和 $b=1-2a$：\n    $$\n    \\lambda_{\\text{comp}} = -a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = -2a\\cos\\theta + 1 - 2a = 1 - 2a(1+\\cos\\theta)\n    $$\n    $\\lambda_{\\text{comp}}$ 也是一个实数。计算模态振幅因子是 $|\\lambda_{\\text{comp}}|$。\n\n### 步骤 3：优化问题的构建与求解\n\n目标是选择 $a$ 以在满足所有约束的条件下最小化 $|\\lambda_{\\text{comp}}|$。\n\n-   **参数范围：** $0 \\le a \\le 1/2$。\n-   **物理模态约束：** $|1 - \\lambda_{\\text{phys}}| \\le \\delta$。\n    代入 $\\lambda_{\\text{phys}} = 1 - 2a(1-\\cos\\theta)$，我们得到：\n    $$\n    |1 - (1 - 2a(1-\\cos\\theta))| \\le \\delta \\implies |2a(1-\\cos\\theta)| \\le \\delta\n    $$\n    由于 $a \\ge 0$ 且 $1-\\cos\\theta \\ge 0$，这简化为 $2a(1-\\cos\\theta) \\le \\delta$。\n    如果 $1-\\cos\\theta  0$，这给出了 $a$ 的一个上界：$a \\le \\frac{\\delta}{2(1-\\cos\\theta)}$。\n    如果 $1-\\cos\\theta = 0$（即 $\\theta=2k\\pi$），约束为 $0 \\le \\delta$，这永远成立，并且不对 $a$ 提供任何界限。\n\n    结合所有约束，$a$ 的可行范围是 $0 \\le a \\le a_{\\max}$，其中：\n    -   如果 $\\cos\\theta=1$：$a_{\\max} = 1/2$。\n    -   如果 $\\cos\\theta \\ne 1$：$a_{\\max} = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}\\right)$。\n\n-   **目标函数：** 最小化 $|\\lambda_{\\text{comp}}| = |1 - 2a(1+\\cos\\theta)|$。\n    令 $f(a) = 1 - 2a(1+\\cos\\theta)$。我们希望在 $a \\in [0, a_{\\max}]$ 上最小化 $|f(a)|$。\n    $|f(a)|$ 的无约束最小值是 $0$，当 $f(a)=0$ 时出现，即在 $a = a^* = \\frac{1}{2(1+\\cos\\theta)}$ 处（对于 $\\cos\\theta \\ne -1$）。\n    函数 $|f(a)|$ 呈V形，中心在 $a^*$。在区间 $[0, a_{\\max}]$ 上 $|f(a)|$ 的最小值在区间内最接近 $a^*$ 的点达到。由于 $a^* \\ge 0$（对于 $\\cos\\theta \\ne -1$）且区间从 $0$ 开始，因此 $a$ 的最优选择是 $\\min(a_{\\max}, a^*)$。\n\n-   **$a$ 的闭式解：**\n    1.  **一般情况 ($\\cos\\theta \\ne \\pm 1$)：**\n        $$\n        a_{\\text{opt}} = \\min\\left( a_{\\max}, a^* \\right) = \\min\\left( \\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}, \\frac{1}{2(1+\\cos\\theta)} \\right)\n        $$\n    2.  **特殊情况 ($\\cos\\theta=1$，例如 $\\theta=0$)：**\n        物理模态约束 $a \\le \\frac{\\delta}{2(0)}$ 无关紧要。范围是 $a \\in [0, 1/2]$。$\\lambda_{\\text{comp}} = 1 - 4a$。为了在 $[0, 1/2]$ 上最小化 $|1-4a|$，我们选择 $a=1/4$。$a_{\\text{opt}} = 1/4$。\n    3.  **特殊情况 ($\\cos\\theta=-1$，例如 $\\theta=\\pi$)：**\n        计算模态的零点 $a^*$ 未定义。$\\lambda_{\\text{comp}} = 1 - 2a(1-1) = 1$，所以它不能被衰减。在这个意义上，任何有效的 $a$ 都是“最优”的。可行范围是 $a_{\\max} = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-(-1))}\\right) = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{4}\\right)$。我们选择可能的最大 $a$ 以最大化对其他模态的衰减，因此 $a_{\\text{opt}} = \\min(1/2, \\delta/4)$。\n\n### 步骤 4：最终计算\n对于每个测试用例 $(\\theta, \\delta)$，我们使用上述公式计算 $a_{\\text{opt}}$。然后：\n- $c = a_{\\text{opt}}$\n- $b = 1 - 2a_{\\text{opt}}$\n- $\\lambda_{\\text{phys}} = 1 - 2a_{\\text{opt}}(1-\\cos\\theta)$\n- $\\lambda_{\\text{comp}} = 1 - 2a_{\\text{opt}}(1+\\cos\\theta)$\n- 物理模态振幅因子是 $\\lambda_{\\text{phys}}$（可以证明 $1-\\delta \\le \\lambda_{\\text{phys}} \\le 1$，所以对于 $\\delta  1$ 它是正的）。\n- 物理模态相位误差为 $0$（因为 $\\lambda_{\\text{phys}}$ 是实数且为正）。\n- 计算模态振幅因子是 $|\\lambda_{\\text{comp}}|$。也可以证明，对于我们选择的 $a_{\\text{opt}}$，有 $0 \\le \\lambda_{\\text{comp}} \\le 1$。\n\n这个逻辑在 Python 代码中实现。",
            "answer": "```\n[[0.02175323984131551,0.956493520317369,0.02175323984131551,0.98,0.0,0.9138670966308076],[0.25,0.5,0.25,0.999375156217462,0.0,0.5000000000000001],[0.05047805260177726,0.8990438947964455,0.05047805260177726,0.8999999999999999,0.0,0.9983994354924151],[0.3262985976197327,0.3474028047605346,0.3262985976197327,0.6999999999999998,0.0,0.0],[0.25,0.5,0.25,1.0,0.0,0.5]]\n```"
        }
    ]
}