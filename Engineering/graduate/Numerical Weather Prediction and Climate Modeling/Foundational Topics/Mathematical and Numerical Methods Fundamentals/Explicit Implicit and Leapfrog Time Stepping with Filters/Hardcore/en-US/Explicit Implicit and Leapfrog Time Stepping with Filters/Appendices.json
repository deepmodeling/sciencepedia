{
    "hands_on_practices": [
        {
            "introduction": "The stability of explicit time-stepping schemes is a cornerstone of numerical modeling, dictating the maximum permissible time step. This exercise provides hands-on practice in performing a full stability analysis for a modern, third-order Runge-Kutta method. By deriving the method's stability polynomial and its stability region, you will determine the Courant-Friedrichs-Lewy (CFL) limit for the linear advection equation, a fundamental skill for ensuring robust numerical simulations. ",
            "id": "4041369",
            "problem": "Consider the one-dimensional linear advection equation on a uniform periodic grid with spacing $\\Delta x$,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\nwhere $a$ is a constant advection speed. Using second-order centered finite differences in space, the semi-discrete system for the grid point values $u_j(t)$ can be written as\n$$\n\\partial_t u_j(t) = -a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x},\n$$\nwhich is of the form $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$ with a constant matrix $\\mathbf{L}$. For this spatial discretization with periodic boundaries, the Fourier modes $e^{\\mathrm{i} k j \\Delta x}$ are eigenvectors of $\\mathbf{L}$ with corresponding eigenvalues\n$$\n\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}.\n$$\nYou will time step this semi-discrete system using the three-stage, third-order Strong Stability-Preserving Runge–Kutta method (SSPRK(3,3)), given in Shu–Osher form by the stages\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n,\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right),\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right).\n$$\nStarting from the foundational facts that stability of a linear time-stepping method applied to $\\partial_t \\mathbf{u} = \\mathbf{L}\\,\\mathbf{u}$ is governed by the method’s scalar stability polynomial $R(z)$ via the requirement $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ for all eigenvalues $\\lambda_k$ of $\\mathbf{L}$, and that discrete Fourier analysis characterizes the spectrum of $\\mathbf{L}$ for periodic linear advection, derive the stability polynomial $R(z)$ of SSPRK(3,3), determine its $|\\cdot| \\leq 1$ region along the imaginary axis, and compute the largest time step $\\Delta t$ that ensures $|R(\\Delta t\\,\\lambda(k))| \\leq 1$ for all wavenumbers $k$ supported by the grid. Express your final answer as a single closed-form analytic expression in terms of $a$ and $\\Delta x$. Express the final allowable time step in seconds. No rounding is required.",
            "solution": "The problem asks for the largest allowable time step, $\\Delta t$, for the numerical solution of the linear advection equation using a specific spatial discretization and time integration scheme. The stability of this process is governed by the condition $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ for all eigenvalues $\\lambda_k$ of the semi-discrete operator $\\mathbf{L}$. The solution requires three main steps: first, deriving the stability polynomial $R(z)$ for the given time-stepping method (SSPRK(3,3)); second, determining the stability region of this polynomial along the imaginary axis, as the eigenvalues $\\lambda_k$ are purely imaginary; and third, using this stability region to constrain $\\Delta t$.\n\nThe semi-discrete system is given by $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$. The SSPRK(3,3) method advances the solution from time step $n$ to $n+1$ via three stages:\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right)\n$$\nTo find the stability polynomial $R(z)$, we express $\\mathbf{u}^{n+1}$ solely in terms of $\\mathbf{u}^n$. Let $z = \\Delta t\\,\\mathbf{L}$. The method can be written as $\\mathbf{u}^{n+1} = R(z)\\,\\mathbf{u}^n$.\n\nFirst stage:\n$$\n\\mathbf{u}^{(1)} = (\\mathbf{I} + z)\\,\\mathbf{u}^n\n$$\nSecond stage: substitute $\\mathbf{u}^{(1)}$ into its definition.\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(1)}\\right) = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}(\\mathbf{I}+z)(\\mathbf{I}+z)\\,\\mathbf{u}^n = \\left(\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I}+z)^2\\right)\\,\\mathbf{u}^n\n$$\nExpanding the polynomial in $z$:\n$$\n\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I} + 2z + z^2) = \\left(\\frac{3}{4}+\\frac{1}{4}\\right)\\mathbf{I} + \\frac{2}{4}z + \\frac{1}{4}z^2 = \\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\n$$\nSo, $\\mathbf{u}^{(2)} = \\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\mathbf{u}^n$.\n\nThird stage: substitute $\\mathbf{u}^{(2)}$ into the final expression for $\\mathbf{u}^{n+1}$.\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(2)}\\right) = \\left(\\frac{1}{3}\\mathbf{I} + \\frac{2}{3}(\\mathbf{I}+z)\\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\right)\\,\\mathbf{u}^n\n$$\nThe operator multiplying $\\mathbf{u}^n$ is the stability polynomial $R(z)$.\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\n$$\nWe expand the product:\n$$\n(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right) = 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 + z + \\frac{1}{2}z^2 + \\frac{1}{4}z^3 = 1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\n$$\nSubstituting this back into the expression for $R(z)$:\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}\\left(1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\\right) = \\frac{1}{3} + \\frac{2}{3} + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\nThus, the stability polynomial for SSPRK(3,3) is:\n$$\nR(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\nThis is the third-order Taylor series expansion of $\\exp(z)$, consistent with the method's order of accuracy.\n\nNext, we analyze the stability of $R(z)$ on the imaginary axis. The eigenvalues of the spatial operator are given as $\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}$, which are purely imaginary. Therefore, the argument of the stability polynomial, $z_k = \\Delta t\\,\\lambda(k)$, is also purely imaginary. We set $z = \\mathrm{i} y$ for a real number $y$ and find the values of $y$ for which $|R(\\mathrm{i} y)| \\leq 1$.\n$$\nR(\\mathrm{i} y) = 1 + (\\mathrm{i} y) + \\frac{1}{2}(\\mathrm{i} y)^2 + \\frac{1}{6}(\\mathrm{i} y)^3 = 1 + \\mathrm{i} y - \\frac{1}{2}y^2 - \\frac{\\mathrm{i}}{6}y^3\n$$\nGrouping real and imaginary parts:\n$$\nR(\\mathrm{i} y) = \\left(1 - \\frac{1}{2}y^2\\right) + \\mathrm{i}\\left(y - \\frac{1}{6}y^3\\right)\n$$\nThe squared magnitude is:\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + \\left(y - \\frac{1}{6}y^3\\right)^2\n$$\nExpanding the terms:\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - y^2 + \\frac{1}{4}y^4\\right) + \\left(y^2 - \\frac{2}{6}y^4 + \\frac{1}{36}y^6\\right)\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 - y^2 + \\frac{1}{4}y^4 + y^2 - \\frac{1}{3}y^4 + \\frac{1}{36}y^6\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 + \\left(\\frac{1}{4} - \\frac{1}{3}\\right)y^4 + \\frac{1}{36}y^6 = 1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6\n$$\nThe stability condition $|R(\\mathrm{i} y)|^2 \\leq 1$ becomes:\n$$\n1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6 \\leq 1\n$$\n$$\n\\frac{1}{36}y^6 - \\frac{1}{12}y^4 \\leq 0\n$$\nAssuming $y \\neq 0$, we can divide by the positive quantity $\\frac{y^4}{36}$:\n$$\ny^2 - 3 \\leq 0 \\implies y^2 \\leq 3\n$$\nThis implies $|y| \\leq \\sqrt{3}$. The stability interval for the SSPRK(3,3) method along the imaginary axis is $[-i\\sqrt{3}, i\\sqrt{3}]$.\n\nFinally, we apply this constraint to the given problem. The stability condition requires that for all wavenumbers $k$, the value $z_k = \\Delta t\\,\\lambda(k)$ must lie within this stability interval.\n$$\nz_k = \\Delta t \\left(\\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}\\right) = \\mathrm{i} \\left(\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right)\n$$\nThis is of the form $\\mathrm{i} y_k$ with $y_k = \\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)$. The stability condition $|y_k| \\leq \\sqrt{3}$ must hold for all $k$.\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right| \\leq \\sqrt{3}\n$$\nSince $\\Delta t > 0$ and $\\Delta x > 0$, this is equivalent to:\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x}|\\sin(k\\,\\Delta x)| \\leq \\sqrt{3}\n$$\nTo ensure this inequality holds for all wavenumbers $k$ supported by the grid, we must consider the worst case, where $|\\sin(k\\,\\Delta x)|$ reaches its maximum value. The maximum value of $|\\sin(\\theta)|$ is $1$. Therefore, we must satisfy:\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x} \\cdot 1 \\leq \\sqrt{3}\n$$\nThe largest time step $\\Delta t$ is found by taking the equality:\n$$\n\\Delta t = \\frac{\\sqrt{3}\\,\\Delta x}{|a|}\n$$\nThis expression provides the maximum allowable time step $\\Delta t$ in seconds that ensures numerical stability for all wavenumbers.",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{3} \\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "While single-step methods are robust, multi-step schemes like Adams-Bashforth and leapfrog offer computational efficiency, but with important trade-offs in accuracy and stability. This practice guides you through a comparative analysis of these two classic methods, focusing on their phase error and stability properties for oscillatory problems. By deriving and contrasting their amplification factors, you will gain a deeper understanding of how different schemes can distort numerical solutions and why the leapfrog scheme, despite its neutrality, introduces a spurious computational mode. ",
            "id": "4041378",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + c\\,u_{x} = 0$ for a constant wave speed $c > 0$ on a periodic domain, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with time levels $t^{n} = n\\,\\Delta t$. Use the second-order centered finite-difference approximation for the spatial derivative, so that the semi-discrete system at grid point $j$ reads $u_{j}'(t) = -c\\,D_{x} u_{j}(t)$ with $D_{x} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$. Define the Courant–Friedrichs–Lewy (CFL) number $\\mu = \\frac{c\\,\\Delta t}{\\Delta x}$ and the nondimensional wavenumber $\\kappa = k\\,\\Delta x$ for Fourier mode $k$.\n\nStarting from the exact integral form $u(t^{n+1}) = u(t^{n}) + \\int_{t^{n}}^{t^{n+1}} f(u(t),t)\\,dt$ with $f(u,t) = -c\\,D_{x}u$, and using only fundamental polynomial interpolation of $f$ in time over the previous two levels $t^{n}$ and $t^{n-1}$, perform the following:\n\n- Derive the explicit second-order Adams–Bashforth two-step update for this semi-discrete advection system, expressed as an update for $u_{j}^{n+1}$ in terms of $u_{j}^{n}$, $u_{j}^{n-1}$, and spatial finite differences at those time levels.\n- Using Fourier mode analysis $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)$, derive the corresponding one-step amplification factor for the Adams–Bashforth two-step method, and for the leapfrog method $u_{j}^{n+1} = u_{j}^{n-1} - \\mu\\,(u_{j+1}^{n} - u_{j-1}^{n})$.\n- For each method, obtain the small-$\\xi$ asymptotic expansion of the numerical phase per step $\\phi(\\xi)$, where $\\alpha = \\lambda\\,\\Delta t$ is the nondimensional eigenvalue of the semi-discrete spatial operator, $\\lambda = -i\\,c\\,k_{d}$ with $k_{d} = \\frac{\\sin\\kappa}{\\Delta x}$, and $\\xi = \\mu\\,\\sin\\kappa$ so that $\\alpha = -i\\,\\xi$. Write $\\phi(\\xi)$ as the imaginary part of the logarithm of the amplification factor and expand up to and including terms of order $\\xi^{3}$.\n- Compare the stability regions along the imaginary axis $\\alpha = i\\,\\xi$: determine the condition on $\\xi$ for which leapfrog is neutrally stable, and determine whether the Adams–Bashforth two-step method admits any nonzero interval of neutral stability on the imaginary axis.\n- Finally, provide the single closed-form analytic expression for the leading-order difference between the phase errors (Adams–Bashforth two-step minus leapfrog) in terms of $\\mu$ and $\\kappa$, expressed using $\\mu$ and $\\kappa$ only.\n\nNote: In this context, if you discuss filters, define them, for example the Robert–Asselin (RA) filter, but do not rely on them to alter the primary derivations. The final answer must be a single closed-form analytic expression. No numerical rounding is required for the final expression, and no physical units are to be included in the answer.",
            "solution": "First, we derive the second-order Adams–Bashforth (AB2) scheme. The integral form of the ordinary differential equation $u' = f(u, t)$ is $u^{n+1} = u^{n} + \\int_{t^{n}}^{t^{n+1}} f(t) dt$. The AB2 method approximates the integrand $f(t)$ by a linear polynomial $P(t)$ that extrapolates from the values at times $t^{n}$ and $t^{n-1}$, where $f^k = f(u(t^k), t^k)$. The polynomial is given by $P(t) = f^{n} + \\frac{f^{n} - f^{n-1}}{\\Delta t}(t - t^{n})$. We integrate this polynomial from $t^n$ to $t^{n+1}$:\n$$ \\int_{t^n}^{t^{n+1}} P(t) dt = \\int_{t^n}^{t^{n+1}} \\left( f^{n} + \\frac{f^{n} - f^{n-1}}{\\Delta t}(t - t^{n}) \\right) dt = \\Delta t \\left( \\frac{3}{2}f^{n} - \\frac{1}{2}f^{n-1} \\right) $$\nThus, the AB2 update rule is $u^{n+1} = u^{n} + \\Delta t \\left( \\frac{3}{2}f^{n} - \\frac{1}{2}f^{n-1} \\right)$. For our specific semi-discrete system, $f_{j} = -c\\,D_{x}u_{j} = -c \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$. Substituting this into the AB2 formula yields the update for $u_{j}^{n+1}$:\n$$ u_{j}^{n+1} = u_{j}^{n} - \\frac{c\\Delta t}{2\\Delta x} \\left( \\frac{3}{2} (u_{j+1}^{n} - u_{j-1}^{n}) - \\frac{1}{2} (u_{j+1}^{n-1} - u_{j-1}^{n-1}) \\right) $$\n\nNext, we perform Fourier analysis. We substitute the ansatz $u_{j}^{n} = G^{n}\\hat{u}^{0}\\exp(ij\\kappa)$ into the schemes, where $G$ is the amplification factor. The Fourier symbol of the spatial operator is $\\frac{i\\sin\\kappa}{\\Delta x}$. The semi-discrete ODE for the Fourier amplitude $\\hat{u}$ is $\\frac{d\\hat{u}}{dt} = -c \\left(\\frac{i\\sin\\kappa}{\\Delta x}\\right)\\hat{u} = \\lambda\\hat{u}$. Let $\\alpha = \\lambda\\Delta t = -i\\frac{c\\Delta t}{\\Delta x}\\sin\\kappa = -i\\mu\\sin\\kappa$. With the problem's definition $\\xi = \\mu\\sin\\kappa$, we have $\\alpha = -i\\xi$.\n\nFor the AB2 scheme, the update for the Fourier amplitude is $\\hat{u}^{n+1} = \\hat{u}^{n} + \\alpha\\left(\\frac{3}{2}\\hat{u}^{n} - \\frac{1}{2}\\hat{u}^{n-1}\\right)$. Substituting $\\hat{u}^k = G^k \\hat{u}^0$ gives the characteristic polynomial for the amplification factor $G$:\n$$ G^2 - \\left(1 + \\frac{3}{2}\\alpha\\right)G + \\frac{1}{2}\\alpha = 0 $$\nFor the leapfrog scheme, $u_{j}^{n+1} = u_{j}^{n-1} - \\mu(u_{j+1}^{n} - u_{j-1}^{n})$, the update in Fourier space is $\\hat{u}^{n+1} = \\hat{u}^{n-1} + 2\\alpha \\hat{u}^n$, which gives the characteristic polynomial:\n$$ G^2 - 2\\alpha G - 1 = 0 $$\nThe principal root is $G_{LF} = \\alpha + \\sqrt{1+\\alpha^2}$.\n\nNow we find the asymptotic expansion of the numerical phase $\\phi(\\xi) = \\Im(\\ln G)$.\nFor the leapfrog method, with $\\alpha = -i\\xi$:\n$G_{LF} = -i\\xi + \\sqrt{1-\\xi^2}$. For $|\\xi| \\le 1$, we can write $G_{LF} = \\exp(i\\theta)$, where the phase is $\\phi_{LF}(\\xi) = \\arg(G_{LF}) = \\arcsin(-\\xi) = -\\arcsin(\\xi)$. The Taylor expansion is:\n$$ \\phi_{LF}(\\xi) = - \\left( \\xi + \\frac{1}{6}\\xi^3 \\right) + O(\\xi^5) $$\nFor the AB2 method, we expand the principal root of its characteristic polynomial for small $\\alpha = -i\\xi$. This gives $G_{AB2} \\approx 1 + \\alpha + \\frac{1}{2}\\alpha^2 + \\frac{1}{4}\\alpha^3$. Taking the logarithm, $\\ln(G_{AB2}) \\approx \\alpha - \\frac{1}{12}\\alpha^3$. Substituting $\\alpha=-i\\xi$:\n$$ \\ln(G_{AB2}) \\approx -i\\xi - \\frac{1}{12}(-i\\xi)^3 = -i\\xi - i\\frac{1}{12}\\xi^3 $$\nWait, this is incorrect. The correct expansion of $\\ln(G_{AB2})$ yields $\\ln(G_{AB2}) = -i\\xi - i\\frac{5}{12}\\xi^3 + O(\\xi^4)$.\nThe numerical phase is the imaginary part:\n$$ \\phi_{AB2}(\\xi) = -\\xi - \\frac{5}{12}\\xi^3 + O(\\xi^5) $$\n\nNext, we analyze stability on the imaginary axis ($\\alpha = -i\\xi$). For leapfrog, $|G_{LF}|^2 = |\\sqrt{1-\\xi^2} - i\\xi|^2 = 1$. This holds if $1-\\xi^2 \\ge 0$, or $|\\xi| \\le 1$. Thus, leapfrog is neutrally stable for $\\xi \\in [-1, 1]$. For AB2, it can be shown that the only point on the imaginary axis where $|G|=1$ is at the origin ($\\alpha=0$). Thus, the AB2 method does not admit any nonzero interval of neutral stability on the imaginary axis.\n\nFinally, we find the leading-order difference between the phase errors. The exact phase for the semi-discrete system is $\\phi_{exact} = \\arg(\\exp(\\alpha)) = \\arg(\\exp(-i\\xi)) = -\\xi$. The phase error is $E_{\\phi} = \\phi_{num} - \\phi_{exact} = \\phi_{num} + \\xi$.\nFor leapfrog, the leading-order phase error is $E_{\\phi,LF} = (-\\xi - \\frac{1}{6}\\xi^3) + \\xi = -\\frac{1}{6}\\xi^3$.\nFor AB2, the leading-order phase error is $E_{\\phi,AB2} = (-\\xi - \\frac{5}{12}\\xi^3) + \\xi = -\\frac{5}{12}\\xi^3$.\nThe difference in phase errors (AB2 minus LF) is:\n$$ E_{\\phi,AB2} - E_{\\phi,LF} = \\left(-\\frac{5}{12}\\xi^3\\right) - \\left(-\\frac{1}{6}\\xi^3\\right) = \\left(-\\frac{5}{12} + \\frac{2}{12}\\right)\\xi^3 = -\\frac{3}{12}\\xi^3 = -\\frac{1}{4}\\xi^3 $$\nSubstituting $\\xi = \\mu\\sin\\kappa$, the final expression is:\n$$ -\\frac{1}{4}(\\mu\\sin\\kappa)^3 = -\\frac{1}{4}\\mu^3\\sin^3\\kappa $$",
            "answer": "$$\n\\boxed{-\\frac{1}{4}\\mu^3\\sin^3\\kappa}\n$$"
        },
        {
            "introduction": "The leapfrog scheme's computational mode contamination requires a targeted solution, which is often a carefully designed time filter. This practice moves beyond analysis to the practical task of design, framing the creation of a time filter as a constrained optimization problem. You will derive the properties of a general three-point filter and then optimize its coefficients to maximally damp the computational mode while preserving the physical mode, translating theoretical numerical analysis into a practical, implementable tool. ",
            "id": "4041376",
            "problem": "You are given a discrete-time linear wave problem representative of numerical weather prediction and climate modeling. Consider a scalar complex amplitude $y(t)$ governed by the linear ordinary differential equation $dy/dt = i \\omega y$, where $\\omega$ is a real angular frequency. Discrete-time stepping schemes over a uniform time step $\\Delta t$ are defined by the following three canonical methods, whose qualitative properties are well-established in the literature:\n\n- Explicit (forward Euler): $y^{n+1} = y^n + i \\omega \\Delta t \\, y^n$.\n- Implicit (backward Euler): $y^{n+1} = y^n + i \\omega \\Delta t \\, y^{n+1}$.\n- Leapfrog: $y^{n+1} = y^{n-1} + 2 i \\omega \\Delta t \\, y^n$.\n\nThe explicit and implicit one-step methods do not introduce a time-decoupling computational mode. In contrast, the two-step leapfrog method supports two temporal eigenmodes: a physical mode and a computational mode, a consequence of the two-step time-level coupling. A common remedy is to apply a linear time filter after each leapfrog update to suppress the computational mode while preserving the physical mode properties as much as possible.\n\nDesign a minimal-order linear time filter acting on three consecutive time levels,\n$$\ny^n_{\\mathrm{filt}} = a \\, y^{n-1} + b \\, y^n + c \\, y^{n+1},\n$$\nsubject to the following constraints:\n- Constant preservation: $a + b + c = 1$.\n- Minimal phase error for the physical mode: enforce symmetry $a = c$ so that the physical mode incurs zero phase shift by the filter.\n- Nonnegativity of filter weights: $a \\ge 0$, $b \\ge 0$, $c \\ge 0$.\n\nLet the discrete oscillation frequency be $\\theta = \\omega \\Delta t$, specified in radians. Analyze the action of the filter on the two modal time sequences:\n- Physical mode sequence: $y^n = e^{i n \\theta}$.\n- Computational mode sequence: $y^n = (-1)^n e^{i n \\theta}$.\n\nUsing Fourier analysis in time, derive the physical-mode and computational-mode amplification factors of the filter, expressed as functions of $a$, $b$, $c$, and $\\theta$, and enforce the symmetry $a = c$.\n\nNow pose the design as an optimization problem: for a given $\\theta$ and a prescribed bound $\\delta$ on the allowable physical-mode amplitude loss per filter application,\n$$\n|1 - \\text{(physical-mode amplification)}| \\le \\delta,\n$$\nchoose $(a,b,c)$ that maximally damps the computational mode (i.e., minimizes the absolute value of its amplification factor) while strictly satisfying the constraints above and maintaining zero phase error on the physical mode. Express the coefficients $(a,b,c)$ in terms of an auxiliary parameter and derive the closed-form optimal choice as a function of $\\theta$ and $\\delta$. Ensure scientific realism and consistency of your assumptions.\n\nYour program must implement this design and compute, for each test case, the following outputs in this order:\n- The coefficients $a$, $b$, $c$.\n- The physical-mode amplitude factor (a real number).\n- The physical-mode phase error in radians (a real number; use $0$ when the filter is symmetric and the amplitude factor is nonnegative).\n- The computational-mode amplitude factor (a real number).\n\nAll angle inputs are in radians. There are no physical units beyond angles in this problem.\n\nTest Suite:\nProvide computations for the following $(\\theta,\\delta)$ pairs (with $\\theta$ in radians and $\\delta$ unitless amplitude-loss bound):\n1. $\\theta = 1.0$, $\\delta = 0.02$.\n2. $\\theta = 0.05$, $\\delta = 0.02$.\n3. $\\theta = 3.12$, $\\delta = 0.10$.\n4. $\\theta = 1.0$, $\\delta = 0.35$.\n5. $\\theta = 0.0$, $\\delta = 0.02$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result should itself be a list in the order\n$[a,b,c,\\text{phys\\_amp},\\text{phys\\_phase\\_error},\\text{comp\\_amp}]$.\nFor example, the overall printed output must look like\n$[[\\ldots],[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$.",
            "solution": "The problem is to design a symmetric three-point time filter $y^n_{\\mathrm{filt}} = a y^{n-1} + b y^n + c y^{n+1}$ that optimally suppresses the computational mode of a numerical scheme.\n\n**1. Filter Constraints and Parameterization**\nThe filter is subject to three constraints:\n- Constant preservation: $a + b + c = 1$.\n- Symmetry (for zero phase error): $a = c$.\n- Nonnegativity of weights: $a, b, c \\ge 0$.\n\nCombining the first two constraints gives $2a + b = 1$, so $b = 1 - 2a$. The nonnegativity constraint $b \\ge 0$ implies $1 - 2a \\ge 0$, which means $a \\le 1/2$. Thus, the filter is defined by a single parameter $a$ in the range $0 \\le a \\le 1/2$.\n\n**2. Amplification Factor Analysis**\nThe filter's effect on a mode is characterized by its amplification factor $\\lambda$, where $y^n_{\\mathrm{filt}} = \\lambda y^n$.\n\n- **Physical Mode ($y^n = e^{i n \\theta}$):**\nThe amplification factor is $\\lambda_{\\text{phys}} = a e^{-i\\theta} + b + c e^{i\\theta}$. Using the constraints ($a=c, b=1-2a$):\n$$ \\lambda_{\\text{phys}} = a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = 2a\\cos\\theta + 1 - 2a = 1 - 2a(1-\\cos\\theta) $$\nSince $\\lambda_{\\text{phys}}$ is real, the filter introduces zero phase shift, as required.\n\n- **Computational Mode ($y^n = (-1)^n e^{i n \\theta}$):**\nThe amplification factor is $\\lambda_{\\text{comp}} = -a e^{-i\\theta} + b - c e^{i\\theta}$. Using the constraints:\n$$ \\lambda_{\\text{comp}} = -a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = -2a\\cos\\theta + 1 - 2a = 1 - 2a(1+\\cos\\theta) $$\n\n**3. Constrained Optimization**\nThe design objective is to minimize $|\\lambda_{\\text{comp}}|$ subject to the physical-mode amplitude loss constraint, $|1 - \\lambda_{\\text{phys}}| \\le \\delta$.\n\n- **Feasible Range for $a$:**\nThe amplitude loss constraint becomes $|1 - (1 - 2a(1-\\cos\\theta))| \\le \\delta$, which simplifies to $2a(1-\\cos\\theta) \\le \\delta$ (since $a \\ge 0$ and $1-\\cos\\theta \\ge 0$).\nIf $\\cos\\theta \\ne 1$, this gives an upper bound $a \\le \\frac{\\delta}{2(1-\\cos\\theta)}$.\nCombining with $0 \\le a \\le 1/2$, the full feasible range for $a$ is $0 \\le a \\le a_{\\max}$, where $a_{\\max} = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}\\right)$. If $\\cos\\theta=1$, the constraint is trivial and $a_{\\max}=1/2$.\n\n- **Optimal Choice of $a$:**\nWe want to minimize $|\\lambda_{\\text{comp}}| = |1 - 2a(1+\\cos\\theta)|$ for $a \\in [0, a_{\\max}]$. The unconstrained minimum of this function occurs at $a^* = \\frac{1}{2(1+\\cos\\theta)}$ (for $\\cos\\theta \\ne -1$), where $\\lambda_{\\text{comp}}=0$. Since we are minimizing over the interval $[0, a_{\\max}]$, the optimal choice $a_{\\text{opt}}$ is the point in this interval closest to $a^*$. This is given by:\n$$ a_{\\text{opt}} = \\min(a_{\\max}, a^*) = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}, \\frac{1}{2(1+\\cos\\theta)}\\right) $$\nFor the special case $\\cos\\theta=1$, this simplifies to $a_{\\text{opt}}=1/4$. For $\\cos\\theta=-1$, $\\lambda_{\\text{comp}}=1$ and cannot be damped; any feasible $a$ is equally optimal, so we can choose the maximum allowed value, $a_{\\text{opt}} = \\min(1/2, \\delta/4)$.\n\nThis value of $a_{\\text{opt}}$ is computed for each test case, from which $b$ and $c$ and the amplification factors are determined.",
            "answer": "[[0.02175113353346369,0.9564977329330726,0.02175113353346369,0.98,0.0,0.9330452058661453],[0.2501563282245314,0.4996873435509372,0.2501563282245314,0.9993746092000578,0.0,0.0],[0.02500053334648833,0.9499989333070233,0.02500053334648833,0.9,0.0,0.9999989333070233],[0.32456584988019315,0.3508683002396137,0.32456584988019315,0.7018318182447334,0.0,0.0],[0.25,0.5,0.25,1.0,0.0,0.0]]"
        }
    ]
}