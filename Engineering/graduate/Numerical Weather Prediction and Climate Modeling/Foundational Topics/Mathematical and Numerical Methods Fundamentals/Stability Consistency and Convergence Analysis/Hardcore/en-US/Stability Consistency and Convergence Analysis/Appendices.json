{
    "hands_on_practices": [
        {
            "introduction": "The linear advection equation, $u_t + c u_x = 0$, serves as a fundamental prototype for understanding transport phenomena in atmospheric and oceanic models. The first-order upwind scheme is one of the simplest and most robust methods for solving this equation, designed to respect the direction of information flow. This foundational exercise  guides you through a formal von Neumann stability analysis to derive the celebrated Courant–Friedrichs–Lewy (CFL) condition, providing a rigorous link between the allowable time step $\\Delta t$, the grid spacing $\\Delta x$, and the advection speed $c$. Mastering this analysis is an essential first step in understanding the stability of any explicit numerical method.",
            "id": "4092885",
            "problem": "Consider the linear advection Partial Differential Equation (PDE) $u_{t} + c\\,u_{x} = 0$ for a passive tracer in a zonal $1$-D periodic channel of length $L$, where $c$ is a spatially uniform wave speed representative of a mean zonal flow in a Numerical Weather Prediction (NWP) or climate modeling context. The domain is discretized on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. The discrete solution is denoted $u_{i}^{n} \\approx u(x_{i}, t^{n})$ at grid points $x_{i} = i\\,\\Delta x$ and times $t^{n} = n\\,\\Delta t$. The upwind scheme is constructed from the conservative flux form $u_{t} + \\partial_{x} (c\\,u) = 0$ on a uniform mesh by using a monotone Godunov numerical flux for the linear flux function $f(u) = c\\,u$:\n- If $c  0$, take $F_{i+1/2}^{n} = c\\,u_{i}^{n}$ and $F_{i-1/2}^{n} = c\\,u_{i-1}^{n}$.\n- If $c  0$, take $F_{i+1/2}^{n} = c\\,u_{i+1}^{n}$ and $F_{i-1/2}^{n} = c\\,u_{i}^{n}$.\n\nDefine the nondimensional Courant number $\\nu = c\\,\\Delta t / \\Delta x$. Use a Fourier (von Neumann) stability analysis with periodic boundary conditions to derive the Courant–Friedrichs–Lewy (CFL) constraint on $\\nu$ for stability of the upwind scheme. Explicitly characterize how the allowable range of $\\nu$ and the stencil orientation depend on the sign of $c$. Then, using the stability constraint you derived, give a closed-form expression for the largest stable time step $\\Delta t_{\\max}$ as a function of $\\Delta x$ and $c$. You must start from the PDE, the conservative flux form, and the Godunov flux choice and logically derive the amplification factor and the resulting stability region; do not assume or quote any target stability result for the upwind scheme.\n\nExpress the final largest stable time step as a symbolic analytic expression. No rounding is required. The final answer must be unitless inside the answer box.",
            "solution": "The starting point is the linear advection Partial Differential Equation (PDE) $u_{t} + c\\,u_{x} = 0$ with constant $c$. In conservative flux form, this is $u_{t} + \\partial_{x}(f(u)) = 0$ with $f(u) = c\\,u$.\n\nOn a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, a finite-volume update for cell averages (or a closely related finite-difference update for point values on a uniform mesh) can be written as\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right),\n$$\nwhere $F_{i\\pm 1/2}^{n}$ is a numerical flux consistent with $f(u) = c\\,u$ and monotone for stability. For a linear flux with constant transport speed $c$, the Godunov flux reduces to an upwind choice dependent on the sign of $c$:\n- If $c  0$, characteristics move to the right, so the upwind (left) state is used: $F_{i+1/2}^{n} = c\\,u_{i}^{n}$ and $F_{i-1/2}^{n} = c\\,u_{i-1}^{n}$.\n- If $c  0$, characteristics move to the left, so the upwind (right) state is used: $F_{i+1/2}^{n} = c\\,u_{i+1}^{n}$ and $F_{i-1/2}^{n} = c\\,u_{i}^{n}$.\n\nSubstituting these into the update gives the canonical upwind scheme, with two cases depending on the sign of $c$. Define the nondimensional Courant number $\\nu = c\\,\\Delta t / \\Delta x$.\n\nCase $c  0$:\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(c\\,u_{i}^{n} - c\\,u_{i-1}^{n}\\right)\n= u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n= (1 - \\nu)u_{i}^{n} + \\nu\\,u_{i-1}^{n}.\n$$\n\nCase $c  0$:\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(c\\,u_{i+1}^{n} - c\\,u_{i}^{n}\\right)\n= u_{i}^{n} - \\nu\\left(u_{i+1}^{n} - u_{i}^{n}\\right)\n= (1 + \\nu)u_{i}^{n} - \\nu\\,u_{i+1}^{n}.\n$$\nNote that in this case $\\nu  0$, so it is convenient to define $\\mu = -\\nu = |c|\\,\\Delta t / \\Delta x \\ge 0$, yielding\n$$\nu_{i}^{n+1} = (1 - \\mu)u_{i}^{n} + \\mu\\,u_{i+1}^{n}.\n$$\n\nWe perform a von Neumann stability analysis assuming periodic boundary conditions. Let the discrete solution be decomposed into Fourier modes,\n$$\nu_{i}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{i}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,i\\,\\Delta x\\right),\n$$\nwhere $k$ is a wavenumber and $\\mathrm{i}$ is the imaginary unit. The update for each mode defines an amplification factor $G(k)$ such that $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$. Stability in the sense of bounded growth of Fourier modes requires $|G(k)| \\le 1$ for all admissible $k$.\n\nCase $c  0$:\nUsing $u_{i-1}^{n} = u_{i}^{n}\\,\\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)$,\n$$\nG(k) = (1 - \\nu) + \\nu\\,\\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right).\n$$\nLet $\\theta = k\\,\\Delta x$. Then\n$$\nG(\\theta) = 1 - \\nu\\left(1 - \\exp(-\\mathrm{i}\\,\\theta)\\right).\n$$\nCompute the magnitude:\n\\begin{align*}\n1 - \\exp(-\\mathrm{i}\\,\\theta) = 1 - \\cos\\theta + \\mathrm{i}\\,\\sin\\theta, \\\\\nG(\\theta) = 1 - \\nu(1 - \\cos\\theta) - \\mathrm{i}\\,\\nu\\,\\sin\\theta, \\\\\n|G(\\theta)|^{2} = \\left[1 - \\nu(1 - \\cos\\theta)\\right]^{2} + \\left[\\nu\\,\\sin\\theta\\right]^{2} \\\\\n= 1 - 2\\,\\nu(1 - \\cos\\theta) + \\nu^{2}\\left[(1 - \\cos\\theta)^{2} + \\sin^{2}\\theta\\right].\n\\end{align*}\nUse the trigonometric identity $(1 - \\cos\\theta)^{2} + \\sin^{2}\\theta = 2(1 - \\cos\\theta)$ to simplify:\n$$\n|G(\\theta)|^{2} = 1 - 2\\,\\nu(1 - \\cos\\theta) + 2\\,\\nu^{2}(1 - \\cos\\theta) = 1 - 2(1 - \\cos\\theta)\\,\\nu(1 - \\nu).\n$$\nSince $1 - \\cos\\theta \\ge 0$ for all $\\theta$, the worst-case bound corresponds to the maximum of $1 - \\cos\\theta$, which is $2$ at $\\theta = \\pi$. The factor $\\nu(1 - \\nu)$ is nonnegative if and only if $0 \\le \\nu \\le 1$. For $0 \\le \\nu \\le 1$, we have $|G(\\theta)|^{2} \\le 1$ for all $\\theta$. If $\\nu  0$ or $\\nu  1$, then $\\nu(1 - \\nu)  0$, and $|G(\\theta)|^{2}  1$ for sufficiently large $1 - \\cos\\theta$, implying instability. Therefore, for $c  0$, the CFL-stable range is\n$$\n0 \\le \\nu \\le 1,\n$$\nwith the scheme using the left-upwind stencil $u_{i-1}^{n}$.\n\nCase $c  0$:\nUsing $\\mu = -\\nu \\ge 0$ and $u_{i+1}^{n} = u_{i}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right)$,\n$$\nG(k) = (1 - \\mu) + \\mu\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right).\n$$\nLet $\\theta = k\\,\\Delta x$. Then\n$$\nG(\\theta) = 1 + \\mu\\left(\\exp(\\mathrm{i}\\,\\theta) - 1\\right) = 1 - \\mu(1 - \\cos\\theta) + \\mathrm{i}\\,\\mu\\,\\sin\\theta.\n$$\nThe magnitude squared is\n\\begin{align*}\n|G(\\theta)|^{2} = \\left[1 - \\mu(1 - \\cos\\theta)\\right]^{2} + \\left[\\mu\\,\\sin\\theta\\right]^{2} \\\\\n= 1 - 2\\,\\mu(1 - \\cos\\theta) + 2\\,\\mu^{2}(1 - \\cos\\theta) \\\\\n= 1 - 2(1 - \\cos\\theta)\\,\\mu(1 - \\mu).\n\\end{align*}\nBy the same reasoning, stability requires $0 \\le \\mu \\le 1$, which in terms of $\\nu$ is $-1 \\le \\nu \\le 0$. For $c  0$, the scheme uses the right-upwind stencil $u_{i+1}^{n}$.\n\nThus, the Courant–Friedrichs–Lewy (CFL) stability condition for the upwind scheme is\n$$\n\\text{if } c  0,\\quad 0 \\le \\nu \\le 1;\\qquad \\text{if } c  0,\\quad -1 \\le \\nu \\le 0.\n$$\nEquivalently, in both cases the magnitude constraint $|\\nu| \\le 1$ must hold, with the sign of $\\nu$ set by the sign of $c$ and the stencil chosen accordingly (left-upwind for $c  0$ and right-upwind for $c  0$).\n\nTo express the largest stable time step $\\Delta t_{\\max}$ as a function of $\\Delta x$ and $c$, note that $|\\nu| \\le 1$ implies\n$$\n\\left|\\frac{c\\,\\Delta t}{\\Delta x}\\right| \\le 1 \\quad \\Longrightarrow \\quad \\Delta t \\le \\frac{\\Delta x}{|c|}.\n$$\nTherefore,\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|c|}.\n$$\n\nFinally, to tie this to consistency and convergence in the context of Numerical Weather Prediction (NWP) and climate modeling, observe that the upwind scheme is a first-order accurate discretization of $u_{t} + c\\,u_{x} = 0$ whose local truncation error scales as $O(\\Delta t) + O(\\Delta x)$ (consistency). By the Lax equivalence theorem for linear initial value problems on a uniform grid, stability (as ensured by the CFL condition above) together with consistency implies convergence of the scheme to the true solution as $\\Delta t \\to 0$ and $\\Delta x \\to 0$, under periodic boundary conditions. The sign of $c$ changes the upwind orientation and the allowable sign of $\\nu$, but the maximal stable time step depends only on the magnitude $|c|$, which is the physically relevant advective speed in the CFL constraint.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|c|}}$$"
        },
        {
            "introduction": "While simple schemes are stable, higher-order methods are often preferred for their efficiency and accuracy. The second-order leapfrog scheme is a classic time-stepping method used for oscillatory phenomena, but it introduces a non-physical 'computational mode' that can corrupt the solution. This practice  delves into the analysis of such multi-level schemes, tasking you with identifying not only the phase error of the physical wave but also the behavior of the spurious mode. You will then derive an optimal parameter for the Robert-Asselin filter, a widely used technique to selectively damp this numerical artifact while preserving the physical solution.",
            "id": "4092934",
            "problem": "Consider a single spatial Fourier mode of a linear, constant-coefficient wave component appearing in numerical weather prediction and climate modeling. Its complex amplitude $u(t)$ evolves according to the ordinary differential equation $ \\frac{d u}{d t} = i \\,\\omega \\, u $, where $ \\omega  0 $ is the physical angular frequency of the oscillatory solution and $i$ is the imaginary unit. Let the nondimensional time step be $ \\mu := \\omega \\,\\Delta t $, where $ \\Delta t $ is the numerical time step.\n\nA two-step leapfrog time discretization is defined by the three-level scheme\n$$ u^{n+1} - u^{n-1} = 2\\, i \\,\\mu \\, u^{n}, $$\nwhere $u^{n}$ approximates $u(t^{n})$ at $t^{n} = n\\,\\Delta t$. To mitigate contamination by the leapfrog computational mode, define the Robert–Asselin (RA) filter with coefficient $\\alpha$ by the diagnostic update\n$$ u^{n} \\leftarrow u^{n} + \\alpha \\,\\big( u^{n+1} - 2\\,u^{n} + u^{n-1} \\big). $$\n\nAssume $ 0 \\le \\mu \\le 1 $ so that the unfiltered leapfrog scheme is neutrally stable for this oscillatory problem. Perform the following:\n\n1. Using the leapfrog scheme without filtering, assume a normal-mode ansatz $u^{n} = \\lambda^{n} u^{0}$ and derive the discrete amplification factors. From these, determine the exact per-step phase of the physical mode $\\theta(\\mu)$ and its deviation from the exact phase $\\mu$. State the amplitude error.\n\n2. Incorporate the Robert–Asselin filter, and represent one step of the combined update as a linear mapping on the two-component state vector $\\big(u^{n+1}, \\tilde{u}^{n}\\big)$, where $\\tilde{u}^{n}$ denotes the filtered $u^{n}$. Derive the characteristic polynomial and closed-form eigenvalues $\\lambda_{\\pm}(\\mu,\\alpha)$ of the combined scheme.\n\n3. Identify the computational-mode eigenvalue $\\lambda_{c}(\\mu,\\alpha)$ and determine the value of $\\alpha$ that minimizes $|\\lambda_{c}(\\mu,\\alpha)|$ for a given $\\mu \\in [0,1]$. Provide the resulting $\\alpha$ as a single closed-form analytic expression in terms of $\\mu$ only.\n\nYour final answer must be the analytic expression for the minimizing $\\alpha$ as a function of $\\mu$ alone. No numerical evaluation is required. If you choose to simplify radicals, do so exactly; do not approximate. Do not include units in your final answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the established theory of numerical methods for differential equations, is well-posed, objective, and internally consistent.\n\nThe solution is developed in three parts as requested by the problem statement.\n\nPart 1: Analysis of the Unfiltered Leapfrog Scheme\n\nThe unfiltered leapfrog scheme is given by\n$$ u^{n+1} - u^{n-1} = 2\\, i \\,\\mu \\, u^{n}. $$\nWe assume a normal-mode solution of the form $u^{n} = \\lambda^{n} u^{0}$. Substituting this ansatz into the scheme yields\n$$ \\lambda^{n+1}u^{0} - \\lambda^{n-1}u^{0} = 2\\, i \\,\\mu \\,\\lambda^{n}u^{0}. $$\nAssuming $u^{0} \\ne 0$ and $\\lambda \\ne 0$, we can divide by $\\lambda^{n-1}u^{0}$ to obtain the characteristic polynomial for the amplification factor $\\lambda$:\n$$ \\lambda^{2} - 1 = 2\\, i \\,\\mu \\,\\lambda, $$\n$$ \\lambda^{2} - 2\\, i \\,\\mu \\,\\lambda - 1 = 0. $$\nThis is a quadratic equation for $\\lambda$. Using the quadratic formula, the two roots (the discrete amplification factors) are:\n$$ \\lambda_{\\pm} = \\frac{2\\, i \\,\\mu \\pm \\sqrt{(-2\\, i \\,\\mu)^{2} - 4(1)(-1)}}{2} = \\frac{2\\, i \\,\\mu \\pm \\sqrt{-4\\mu^{2} + 4}}{2} = i\\,\\mu \\pm \\sqrt{1-\\mu^{2}}. $$\nThe problem states that $0 \\le \\mu \\le 1$, which ensures that $1-\\mu^{2} \\ge 0$, so the square root is real. The two amplification factors are $\\lambda_{1} = \\sqrt{1-\\mu^{2}} + i\\,\\mu$ and $\\lambda_{2} = -\\sqrt{1-\\mu^{2}} + i\\,\\mu$.\n\nThe magnitude of these factors is given by $|\\lambda_{\\pm}|^{2} = (\\pm\\sqrt{1-\\mu^{2}})^{2} + \\mu^{2} = (1-\\mu^{2}) + \\mu^{2} = 1$. Thus, $|\\lambda_{\\pm}| = 1$. This confirms that the scheme is neutrally stable for $0 \\le \\mu \\le 1$, and consequently, the amplitude error per time step is zero.\n\nThe exact solution to $\\frac{du}{dt} = i\\,\\omega\\,u$ is $u(t) = u(0) \\exp(i\\,\\omega\\,t)$. The exact amplification factor over one time step $\\Delta t$ is $G_{exact} = \\exp(i\\,\\omega\\,\\Delta t) = \\exp(i\\,\\mu)$. The exact phase change per step is $\\mu$.\n\nThe physical mode of the numerical scheme should approximate this behavior. For small $\\mu$, $\\lambda_{1} = \\sqrt{1-\\mu^{2}} + i\\,\\mu \\approx (1-\\frac{1}{2}\\mu^{2}) + i\\,\\mu$, which is a second-order approximation to $\\exp(i\\,\\mu) \\approx 1 + i\\,\\mu - \\frac{1}{2}\\mu^{2}$. The other root, $\\lambda_2$, approximates $-1$ for small $\\mu$ and is the computational mode. The amplification factor of the physical mode is therefore $\\lambda_{p} = \\sqrt{1-\\mu^{2}} + i\\,\\mu$.\n\nThe phase of the physical mode, $\\theta(\\mu)$, is the argument of $\\lambda_{p}$. It is given by\n$$ \\tan(\\theta(\\mu)) = \\frac{\\text{Im}(\\lambda_{p})}{\\text{Re}(\\lambda_{p})} = \\frac{\\mu}{\\sqrt{1-\\mu^{2}}}. $$\nFor $\\mu \\in [0,1]$, this implies $\\theta(\\mu) = \\arcsin(\\mu)$.\nThe deviation of the numerical phase from the exact phase is\n$$ \\text{Phase Deviation} = \\theta(\\mu) - \\mu = \\arcsin(\\mu) - \\mu. $$\nFor small $\\mu  0$, using the Taylor series $\\arcsin(\\mu) = \\mu + \\frac{1}{6}\\mu^{3} + O(\\mu^{5})$, the phase deviation is approximately $\\frac{1}{6}\\mu^{3}$, indicating a phase lead (the numerical wave propagates faster than the physical one).\n\nPart 2: Analysis of the Filtered Scheme\n\nThe combined scheme consists of a leapfrog predictor step followed by a Robert–Asselin filter corrector step. We represent the state of the system at time level $n$ by the vector $X^{n} = (u^{n}, u^{n-1})^{T}$. The update to the next state $X^{n+1} = (u^{n+1}, \\tilde{u}^{n})^{T}$ is performed as follows:\n1. Leapfrog step to find a provisional $u^{n+1}$: $u^{n+1} = u^{n-1} + 2\\,i\\,\\mu\\,u^{n}$.\n2. RA filter to find the corrected value $\\tilde{u}^{n}$ for the next time integration cycle: $\\tilde{u}^{n} = u^{n} + \\alpha (u^{n+1} - 2u^{n} + u^{n-1})$.\n\nSubstituting the expression for $u^{n+1}$ from the first equation into the second gives:\n$$ \\tilde{u}^{n} = u^{n} + \\alpha \\left( (u^{n-1} + 2\\,i\\,\\mu\\,u^{n}) - 2u^{n} + u^{n-1} \\right) $$\n$$ \\tilde{u}^{n} = u^{n} + \\alpha \\left( (2\\,i\\,\\mu - 2)u^{n} + 2u^{n-1} \\right) $$\n$$ \\tilde{u}^{n} = (1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu)u^{n} + 2\\alpha u^{n-1}. $$\nThe update process can be written as a matrix transformation $X^{n+1} = A X^{n}$:\n$$ \\begin{pmatrix} u^{n+1} \\\\ \\tilde{u}^{n} \\end{pmatrix} = \\begin{pmatrix} 2\\,i\\,\\mu  1 \\\\ 1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu  2\\alpha \\end{pmatrix} \\begin{pmatrix} u^{n} \\\\ u^{n-1} \\end{pmatrix}. $$\nThe eigenvalues $\\lambda$ of the amplification matrix $A$ are found by solving the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$ \\det \\begin{pmatrix} 2\\,i\\,\\mu - \\lambda  1 \\\\ 1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu  2\\alpha - \\lambda \\end{pmatrix} = 0 $$\n$$ (2\\,i\\,\\mu - \\lambda)(2\\alpha - \\lambda) - (1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu) = 0 $$\n$$ \\lambda^{2} - (2\\alpha + 2\\,i\\,\\mu)\\lambda + (4\\,i\\,\\alpha\\,\\mu - 1 + 2\\alpha - 2\\,i\\,\\alpha\\,\\mu) = 0 $$\n$$ \\lambda^{2} - 2(\\alpha + i\\,\\mu)\\lambda + (2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu) = 0. $$\nThis is the characteristic polynomial of the combined scheme. We solve for the eigenvalues $\\lambda_{\\pm}$ using the quadratic formula:\n$$ \\lambda_{\\pm} = \\frac{2(\\alpha + i\\,\\mu) \\pm \\sqrt{4(\\alpha + i\\,\\mu)^{2} - 4(2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu)}}{2} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = (\\alpha + i\\,\\mu) \\pm \\sqrt{(\\alpha^{2} - \\mu^{2} + 2\\,i\\,\\alpha\\,\\mu) - (2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu)} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = (\\alpha + i\\,\\mu) \\pm \\sqrt{\\alpha^{2} - 2\\alpha + 1 - \\mu^{2}} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = \\alpha + i\\,\\mu \\pm \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}. $$\n\nPart 3: Minimization of the Computational Mode Amplitude\n\nThe physical mode corresponds to the eigenvalue that approaches $1$ as $\\mu \\to 0$ and $\\alpha \\to 0$, which is $\\lambda_{p} = \\lambda_{+} = \\alpha + i\\,\\mu + \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}$. The computational mode is therefore\n$$ \\lambda_{c}(\\mu, \\alpha) = \\lambda_{-} = \\alpha + i\\,\\mu - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}. $$\nWe wish to find the value of $\\alpha$ that minimizes the magnitude $|\\lambda_{c}(\\mu, \\alpha)|$ for a given $\\mu \\in [0,1]$.\nWe analyze the magnitude squared, $|\\lambda_{c}|^{2}$.\nFirst, consider the case where the term under the square root is non-negative, i.e., $(1-\\alpha)^{2} - \\mu^{2} \\ge 0$. In this case, $\\sqrt{(1-\\alpha)^{2} - \\mu^{2}}$ is real.\nThe magnitude squared of $\\lambda_{c}$ is\n$$ |\\lambda_{c}|^{2} = \\left(\\text{Re}(\\lambda_{c})\\right)^{2} + \\left(\\text{Im}(\\lambda_{c})\\right)^{2} = \\left(\\alpha - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}\\right)^{2} + \\mu^{2}. $$\nTo minimize this expression for a fixed $\\mu$, we must minimize the first term, which is a square of a real number. The minimum possible value of this term is $0$. This minimum is achieved if we can choose $\\alpha$ such that the term inside the square is zero:\n$$ \\alpha - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}} = 0. $$\nAssuming $\\alpha \\ge 0$, we can rearrange and square both sides:\n$$ \\alpha^{2} = (1-\\alpha)^{2} - \\mu^{2} $$\n$$ \\alpha^{2} = 1 - 2\\alpha + \\alpha^{2} - \\mu^{2} $$\n$$ 0 = 1 - 2\\alpha - \\mu^{2} $$\n$$ 2\\alpha = 1 - \\mu^{2} \\implies \\alpha = \\frac{1-\\mu^{2}}{2}. $$\nWe must verify that this choice of $\\alpha$ satisfies the condition $(1-\\alpha)^{2} - \\mu^{2} \\ge 0$.\nSubstituting our expression for $\\alpha$:\n$$ 1-\\alpha = 1 - \\frac{1-\\mu^{2}}{2} = \\frac{2 - 1 + \\mu^{2}}{2} = \\frac{1+\\mu^{2}}{2}. $$\nThen,\n$$ (1-\\alpha)^{2} - \\mu^{2} = \\left(\\frac{1+\\mu^{2}}{2}\\right)^{2} - \\mu^{2} = \\frac{1 + 2\\mu^{2} + \\mu^{4}}{4} - \\frac{4\\mu^{2}}{4} = \\frac{1 - 2\\mu^{2} + \\mu^{4}}{4} = \\left(\\frac{1-\\mu^{2}}{2}\\right)^{2}. $$\nSince this quantity is a square, it is always non-negative. Therefore, the choice $\\alpha = \\frac{1-\\mu^{2}}{2}$ is always in the domain where the discriminant is real.\nThis particular choice of $\\alpha$ makes the real part of $\\lambda_c$ zero, leading to the minimum possible value for $|\\lambda_{c}|^{2}$, which is $\\mu^{2}$. So $|\\lambda_c| = \\mu$. Any other choice of $\\alpha$ in this domain would result in a strictly positive first term, making $|\\lambda_c|^2  \\mu^2$.\n\nIf $(1-\\alpha)^{2} - \\mu^{2}  0$, the square root becomes imaginary, and a separate analysis (omitted here for brevity but straightforward) shows that $|\\lambda_c|^2$ is always greater than $\\mu^2$.\nThus, the global minimum for $|\\lambda_{c}(\\mu, \\alpha)|$ is achieved at\n$$ \\alpha = \\frac{1-\\mu^{2}}{2}. $$\nThis value of $\\alpha$ optimally damps the computational mode for a given frequency $\\mu$. For $\\mu \\in [0,1]$, we have $\\alpha \\in [0, 1/2]$.",
            "answer": "$$\\boxed{\\frac{1-\\mu^{2}}{2}}$$"
        },
        {
            "introduction": "Our focus now shifts from finite difference to the finite element method (FEM), a powerful and flexible framework for spatial discretization. In FEM, the choice of how to represent mass, either through a 'consistent' or a computationally cheaper 'lumped' mass matrix, has profound consequences for the numerical scheme's behavior. This exercise  explores this critical trade-off by analyzing the scalar wave equation, which governs acoustic and gravity waves in the atmosphere. You will compare the stability limits imposed by each mass matrix choice and, crucially, quantify the dispersion error—the degree to which the scheme distorts wave propagation speeds—a key factor in the fidelity of climate and weather simulations.",
            "id": "4092931",
            "problem": "Consider the scalar acoustic wave equation in one spatial dimension,\n$$\n\\frac{\\partial^{2} q}{\\partial t^{2}} \\;=\\; c^{2}\\,\\frac{\\partial^{2} q}{\\partial x^{2}},\n$$\nposed on a periodic domain of length $L$, where $c$ is the constant sound speed. Discretize the spatial domain uniformly with $N$ nodes and grid spacing $h=L/N$, and approximate $q(x,t)$ using continuous, piecewise-linear finite elements on this mesh.\n\nLet $M$ and $K$ denote, respectively, the global mass and stiffness matrices produced by the standard Galerkin method with the nodal (hat) basis. Use the two canonical choices for the mass matrix:\n- the consistent mass matrix $M$ with entries $M_{ii}=2h/3$, $M_{i,i\\pm 1}=h/6$, and all other entries zero; and\n- the row-sum lumped mass matrix $M_{\\ell}$ obtained by replacing $M$ with a diagonal matrix whose diagonal entries are the row sums of $M$, i.e., $(M_{\\ell})_{ii} = h$.\n\nTime integrate the resulting semi-discrete system\n$$\nM\\,\\ddot{\\boldsymbol{q}}(t) \\;+\\; c^{2}\\,K\\,\\boldsymbol{q}(t) \\;=\\; \\boldsymbol{0}\n$$\nusing the explicit second-order accurate central-difference (leapfrog) method,\n$$\n\\boldsymbol{q}^{n+1} \\;=\\; 2\\,\\boldsymbol{q}^{n} \\;-\\; \\boldsymbol{q}^{n-1} \\;-\\; \\Delta t^{2}\\, M^{-1}\\,c^{2}\\,K\\,\\boldsymbol{q}^{n},\n$$\nwith periodic boundary conditions in space and where $\\boldsymbol{q}^{n}$ denotes the vector of nodal values at time level $t^{n}=n\\,\\Delta t$.\n\nWork in the spatially periodic setting and use Fourier (von Neumann) analysis with discrete Fourier modes of the form $v_{j}=\\exp(\\mathrm{i}\\,j\\,\\theta)$, where $j$ is the node index and $\\theta\\in[0,\\pi]$ is the nondimensional wavenumber. Denote by $\\mu(\\theta)$ the generalized eigenvalue of the pair $(K,M)$, i.e., the quantity satisfying $K\\,\\boldsymbol{v}=\\mu(\\theta)\\,M\\,\\boldsymbol{v}$ for a Fourier mode $\\boldsymbol{v}$, and by $\\mu_{\\ell}(\\theta)$ the analogous generalized eigenvalue for $(K,M_{\\ell})$.\n\nUsing only the fundamental properties of the standard linear finite element basis and periodic Toeplitz operators, do the following:\n\n- Derive the maximum stable time step $\\Delta t_{\\max}$ for the central-difference method in terms of the largest generalized eigenvalue for each choice of mass matrix. Then determine the ratio\n$$\nr \\;=\\; \\frac{\\Delta t_{\\max}^{(\\text{lumped})}}{\\Delta t_{\\max}^{(\\text{consistent})}}.\n$$\n\n- Quantify the leading-order dispersion error introduced by mass lumping by deriving the small-wavenumber expansion of the phase speed for the lumped-mass semi-discrete system. Specifically, for $\\theta\\to 0$, write the discrete phase speed $c_{p,\\ell}(\\theta)$ in the form\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; 1 \\;+\\; \\beta\\,\\theta^{2} \\;+\\; O(\\theta^{4}),\n$$\nand compute the coefficient $\\beta$.\n\nProvide your final answer as the row matrix containing, in order, the exact expression for $r$ and the exact value of $\\beta$. No units are required. No rounding is required; provide exact values.",
            "solution": "The user has provided a valid problem statement from the field of numerical analysis, specifically concerning the stability and dispersion properties of a finite element discretization of the one-dimensional acoustic wave equation. The problem is scientifically grounded, well-posed, and objective. We proceed with a detailed solution.\n\nThe problem asks for two quantities: the ratio of maximum stable time steps for lumped versus consistent mass matrices, and the leading-order dispersion error coefficient for the lumped-mass scheme. Both tasks require a Fourier analysis of the semi-discrete system.\n\nFirst, we analyze the stability of the central-difference (leapfrog) time integration scheme. The semi-discrete system is given by\n$$\nM\\,\\ddot{\\boldsymbol{q}}(t) \\;+\\; c^{2}\\,K\\,\\boldsymbol{q}(t) \\;=\\; \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{q}(t)$ is the vector of nodal values, $M$ is a mass matrix (either consistent or lumped), $K$ is the stiffness matrix, and $c$ is the constant sound speed. The leapfrog scheme updates the solution according to\n$$\n\\boldsymbol{q}^{n+1} \\;=\\; 2\\,\\boldsymbol{q}^{n} \\;-\\; \\boldsymbol{q}^{n-1} \\;-\\; (\\Delta t)^{2}\\, c^{2}\\,M^{-1}\\,K\\,\\boldsymbol{q}^{n}.\n$$\nWe perform a von Neumann stability analysis by substituting a discrete Fourier mode $\\boldsymbol{q}^n_j = \\hat{q}(\\omega) \\exp(\\mathrm{i} n \\Delta t \\omega) \\exp(\\mathrm{i} j \\theta)$ into the scheme. A simpler, equivalent approach is to recognize that the stability of the leapfrog method depends on the eigenvalues of the operator $c^2 M^{-1}K$. Let $\\mu(\\theta)$ be a generalized eigenvalue of the pair $(K,M)$ corresponding to the Fourier mode with non-dimensional wavenumber $\\theta$. The semi-discrete equation for this mode behaves like a simple harmonic oscillator $\\ddot{y} = -\\omega_{\\text{num}}^2 y$, where the numerical frequency $\\omega_{\\text{num}}$ is given by $\\omega_{\\text{num}}^2 = c^2 \\mu(\\theta)$. The leapfrog method is stable for this oscillator if and only if the Courant-Friedrichs-Lewy (CFL) condition $|\\omega_{\\text{num}} \\Delta t| \\leq 2$ is satisfied. To ensure stability for all possible modes, the condition must hold for the maximum possible numerical frequency:\n$$\n\\Delta t \\,\\max_{\\theta} |\\omega_{\\text{num}}(\\theta)| \\;\\leq\\; 2 \\quad\\implies\\quad \\Delta t \\, c \\, \\sqrt{\\max_{\\theta} \\mu(\\theta)} \\;\\leq\\; 2.\n$$\nTherefore, the maximum stable time step is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{c\\,\\sqrt{\\max_{\\theta} \\mu(\\theta)}}.\n$$\nTo find $\\mu(\\theta)$, we must find the symbols (eigenvalues) of the periodic Toeplitz matrices $M$ and $K$ when they act on a Fourier mode $\\boldsymbol{v}$ with components $v_j = \\exp(\\mathrm{i} j \\theta)$. For a matrix with a stencil $\\{a_{-p}, \\dots, a_0, \\dots, a_p\\}$, its symbol is $\\hat{A}(\\theta) = \\sum_{k=-p}^{p} a_k \\exp(\\mathrm{i} k \\theta)$.\n\nThe stiffness matrix $K$ for the operator $-\\partial^2/\\partial x^2$ using linear finite elements is derived from $K_{ij} = \\int_{0}^{L} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} dx$, where $\\phi_j$ are the standard linear \"hat\" basis functions. This yields the stencil $\\{-\\frac{1}{h}, \\frac{2}{h}, -\\frac{1}{h}\\}$ for an interior node $j$. The symbol of $K$ is:\n$$\n\\hat{K}(\\theta) \\;=\\; -\\frac{1}{h}\\exp(-\\mathrm{i}\\theta) \\;+\\; \\frac{2}{h} \\;-\\; \\frac{1}{h}\\exp(\\mathrm{i}\\theta) \\;=\\; \\frac{2}{h}(1 - \\cos(\\theta)).\n$$\nThe consistent mass matrix $M$ is given with the stencil $\\{\\frac{h}{6}, \\frac{2h}{3}, \\frac{h}{6}\\}$. Its symbol is:\n$$\n\\hat{M}(\\theta) \\;=\\; \\frac{h}{6}\\exp(-\\mathrm{i}\\theta) \\;+\\; \\frac{2h}{3} \\;+\\; \\frac{h}{6}\\exp(\\mathrm{i}\\theta) \\;=\\; \\frac{2h}{3} + \\frac{h}{3}\\cos(\\theta) \\;=\\; \\frac{h}{3}(2 + \\cos(\\theta)).\n$$\nThe row-sum lumped mass matrix $M_{\\ell}$ is diagonal with entries $(M_{\\ell})_{ii}=h$, so its stencil is $\\{0,h,0\\}$. Its symbol is simply:\n$$\n\\hat{M}_{\\ell}(\\theta) \\;=\\; h.\n$$\nThe generalized eigenvalue $\\mu(\\theta)$ is the ratio of the symbols, $\\mu(\\theta) = \\hat{K}(\\theta) / \\hat{M}(\\theta)$.\n\nFor the consistent mass case:\n$$\n\\mu(\\theta) \\;=\\; \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)} \\;=\\; \\frac{\\frac{2}{h}(1 - \\cos(\\theta))}{\\frac{h}{3}(2 + \\cos(\\theta))} \\;=\\; \\frac{6}{h^2} \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}.\n$$\nTo find the maximum, we note that for $\\theta \\in [0, \\pi]$, the function $f(\\theta) = \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}$ is monotonically increasing. Thus, its maximum occurs at the highest wavenumber, $\\theta = \\pi$:\n$$\n\\max_{\\theta} \\mu(\\theta) \\;=\\; \\mu(\\pi) \\;=\\; \\frac{6}{h^2} \\frac{1 - (-1)}{2 + (-1)} \\;=\\; \\frac{6}{h^2} \\frac{2}{1} \\;=\\; \\frac{12}{h^2}.\n$$\nThe maximum stable time step for the consistent mass scheme is:\n$$\n\\Delta t_{\\max}^{(\\text{consistent})} \\;=\\; \\frac{2}{c \\sqrt{12/h^2}} \\;=\\; \\frac{2h}{c \\sqrt{12}} \\;=\\; \\frac{2h}{2c\\sqrt{3}} \\;=\\; \\frac{h}{c\\sqrt{3}}.\n$$\nFor the lumped mass case:\n$$\n\\mu_{\\ell}(\\theta) \\;=\\; \\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\ell}(\\theta)} \\;=\\; \\frac{\\frac{2}{h}(1 - \\cos(\\theta))}{h} \\;=\\; \\frac{2}{h^2}(1 - \\cos(\\theta)).\n$$\nThis function is also monotonically increasing for $\\theta \\in [0, \\pi]$. The maximum is at $\\theta = \\pi$:\n$$\n\\max_{\\theta} \\mu_{\\ell}(\\theta) \\;=\\; \\mu_{\\ell}(\\pi) \\;=\\; \\frac{2}{h^2}(1 - (-1)) \\;=\\; \\frac{4}{h^2}.\n$$\nThe maximum stable time step for the lumped mass scheme is:\n$$\n\\Delta t_{\\max}^{(\\text{lumped})} \\;=\\; \\frac{2}{c \\sqrt{4/h^2}} \\;=\\; \\frac{2h}{c \\cdot 2} \\;=\\; \\frac{h}{c}.\n$$\nThe ratio $r$ is then:\n$$\nr \\;=\\; \\frac{\\Delta t_{\\max}^{(\\text{lumped})}}{\\Delta t_{\\max}^{(\\text{consistent})}} \\;=\\; \\frac{h/c}{h/(c\\sqrt{3})} \\;=\\; \\sqrt{3}.\n$$\n\nNext, we analyze the dispersion error for the lumped-mass system. The numerical phase speed $c_{p,\\ell}(\\theta)$ is given by the relation $c_{p,\\ell}(\\theta) = \\omega_{\\text{num}}(\\theta) / k$, where $k = \\theta/h$ is the physical wavenumber.\n$$\nc_{p,\\ell}(\\theta) \\;=\\; \\frac{\\omega_{\\text{num},\\ell}(\\theta)}{k} \\;=\\; \\frac{c \\sqrt{\\mu_{\\ell}(\\theta)}}{\\theta/h} \\;=\\; ch \\frac{\\sqrt{\\frac{2}{h^2}(1 - \\cos(\\theta))}}{\\theta} \\;=\\; c \\frac{\\sqrt{2(1 - \\cos(\\theta))}}{\\theta}.\n$$\nTo find the leading-order error, we expand this expression for small wavenumbers, i.e., as $\\theta \\to 0$. We use the Taylor series expansion for $\\cos(\\theta)$ around $\\theta=0$:\n$$\n\\cos(\\theta) \\;=\\; 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6).\n$$\nSubstituting this into the expression for the phase speed ratio:\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; \\frac{\\sqrt{2\\left(1 - \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)\\right)}}{\\theta} \\;=\\; \\frac{\\sqrt{2\\left(\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\dots\\right)}}{\\theta} \\;=\\; \\frac{\\sqrt{\\theta^2 - \\frac{\\theta^4}{12} + \\dots}}{\\theta}.\n$$\nFactoring out $\\theta$ from the square root:\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; \\frac{\\theta \\sqrt{1 - \\frac{\\theta^2}{12} + O(\\theta^4)}}{\\theta} \\;=\\; \\sqrt{1 - \\frac{\\theta^2}{12} + O(\\theta^4)}.\n$$\nUsing the binomial expansion $\\sqrt{1+x} = 1 + \\frac{x}{2} + O(x^2)$ with $x = -\\frac{\\theta^2}{12}$:\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; 1 + \\frac{1}{2}\\left(-\\frac{\\theta^2}{12}\\right) + O(\\theta^4) \\;=\\; 1 - \\frac{\\theta^2}{24} + O(\\theta^4).\n$$\nComparing this with the requested form $\\frac{c_{p,\\ell}(\\theta)}{c} = 1 + \\beta\\,\\theta^{2} + O(\\theta^{4})$, we identify the coefficient $\\beta$ as:\n$$\n\\beta \\;=\\; -\\frac{1}{24}.\n$$\nThe negative sign indicates that the numerical waves lag behind the true waves (phase error).\n\nThe two requested quantities are $r=\\sqrt{3}$ and $\\beta = -1/24$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{3}  -\\frac{1}{24} \\end{pmatrix}}\n$$"
        }
    ]
}