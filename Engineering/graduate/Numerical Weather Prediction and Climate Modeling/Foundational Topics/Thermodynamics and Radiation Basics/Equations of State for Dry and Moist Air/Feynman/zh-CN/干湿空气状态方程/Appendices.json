{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是掌握干燥空气状态方程。这个基本关系是所有大气模型的基础，它将宏观属性——压力（$p$）和温度（$T$）——与空气的质量密度（$\\rho$）联系起来。通过从基本物理原理推导并计算一个实际天气观测的密度，您将巩固对理想气体定律的理解，并学会如何评估模型数据与标准大气参考之间的一致性 。",
            "id": "4039095",
            "problem": "在数值天气预报（NWP）和气候模拟中，干空气的质量密度通过状态方程进入热力学闭合和输运方案。从联系压强、数密度和温度的气体动理论关系式以及干空气的比气体常数的定义出发，推导干空气质量密度 $\\rho$ 作为压强 $p$ 和温度 $T$ 函数的表达式。然后，根据一次天气观测数据 $p=850\\,\\mathrm{hPa}$ 和 $T=270\\,\\mathrm{K}$ 计算 $\\rho$，并通过计算比值 $r=\\rho/\\rho_{\\mathrm{std}}$ 来评估其与美国标准大气（USSA）的一致性，其中 $p=850\\,\\mathrm{hPa}$ 处的标准大气密度查表值为 $\\rho_{\\mathrm{std}}=1.062\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。使用普适气体常数 $R_{u}=8.314\\,462\\,618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和干空气的摩尔质量 $M_{d}=28.9647\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$。密度以 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$ 为单位表示。报告最终的比值 $r$，四舍五入至四位有效数字。",
            "solution": "该问题被认为是有效的，因为它科学上基于热力学原理，数据充分且一致，问题提法得当，并且陈述客观。\n\n目标是推导干空气质量密度 $\\rho$ 的表达式，然后针对给定条件进行计算。我们从理想气体定律开始，该定律通过普适气体常数 $R_u$ 将压强 $p$、体积 $V$、摩尔数 $N$ 和绝对温度 $T$ 联系起来。\n$$pV = N R_u T$$\n一种物质的摩尔数 $N$ 等于其总质量 $m$ 除以其摩尔质量 $M$。对于干空气，即 $N = \\frac{m}{M_d}$，其中 $M_d$ 是干空气的摩尔质量。将此代入理想气体定律可得：\n$$pV = \\left(\\frac{m}{M_d}\\right) R_u T$$\n质量密度 $\\rho$ 定义为单位体积的质量，即 $\\rho = \\frac{m}{V}$。为了得到包含 $\\rho$ 的表达式，我们可以将方程重新排列为：\n$$p = \\frac{m}{V} \\frac{R_u}{M_d} T$$\n代入密度的定义，我们得到了用质量密度表示的状态方程：\n$$p = \\rho \\frac{R_u}{M_d} T$$\n问题陈述中提到了干空气的比气体常数，记为 $R_d$。它定义为普适气体常数除以干空气的摩尔质量：\n$$R_d = \\frac{R_u}{M_d}$$\n使用这个定义，状态方程可以更紧凑地写为 $p = \\rho R_d T$。这是大气科学中使用的标准形式。\n\n为了求出质量密度 $\\rho$ 的表达式，我们求解此方程得到 $\\rho$：\n$$\\rho = \\frac{p}{R_d T}$$\n为了使用给定的常数 $R_u$ 和 $M_d$，我们将 $R_d$ 的定义代回此表达式中：\n$$\\rho = \\frac{p}{\\left(\\frac{R_u}{M_d}\\right) T}$$\n化简后得到最终推导出的表达式，即质量密度作为压强和温度的函数：\n$$\\rho = \\frac{p M_d}{R_u T}$$\n接下来，我们计算此表达式在给定天气观测条件下的值。给定的值为：\n压强, $p = 850\\,\\mathrm{hPa}$\n温度, $T = 270\\,\\mathrm{K}$\n普适气体常数, $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n干空气的摩尔质量, $M_d = 28.9647\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$\n\n为保证量纲一致，所有数值必须转换为国际单位制（SI）基本单位。\n以帕斯卡（$\\mathrm{Pa}$，或 $\\mathrm{N}\\,\\mathrm{m}^{-2}$）为单位的压强是：\n$$p = 850\\,\\mathrm{hPa} = 850 \\times 100\\,\\mathrm{Pa} = 85000\\,\\mathrm{Pa}$$\n以千克每摩尔（$\\mathrm{kg}\\,\\mathrm{mol}^{-1}$）为单位的摩尔质量是：\n$$M_d = 28.9647\\,\\mathrm{g}\\,\\mathrm{mol}^{-1} = 28.9647 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$$\n温度 $T$ 和普适气体常数 $R_u$ 已经使用了合适的国际单位制单位。\n\n我们将这些数值代入推导出的密度公式中：\n$$\\rho = \\frac{(85000\\,\\mathrm{Pa}) \\times (28.9647 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1})}{(8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (270\\,\\mathrm{K})}$$\n进行计算：\n$$\\rho = \\frac{2461.9995}{2244.90490686}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3} \\approx 1.09670\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$$\n单位分析证实了结果的单位是 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，因为 $(\\mathrm{Pa} \\cdot \\mathrm{kg} \\cdot \\mathrm{mol}^{-1}) / (\\mathrm{J} \\cdot \\mathrm{mol}^{-1} \\cdot \\mathrm{K}^{-1} \\cdot \\mathrm{K}) = (\\mathrm{N} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{kg}) / (\\mathrm{N} \\cdot \\mathrm{m}) = \\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n\n最后，我们通过计算比值 $r = \\rho/\\rho_{\\mathrm{std}}$ 来评估其与美国标准大气 (USSA) 的一致性。在 $p=850\\,\\mathrm{hPa}$ 处的标准大气密度给定为 $\\rho_{\\mathrm{std}} = 1.062\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n$$r = \\frac{\\rho}{\\rho_{\\mathrm{std}}} = \\frac{1.09670\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}{1.062\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}$$\n$$r \\approx 1.03267$$\n问题要求将此比值四舍五入至四位有效数字。\n$$r \\approx 1.033$$\n出现差异的原因是，给定天气观测的温度 $T=270\\,\\mathrm{K}$ 低于 $850\\,\\mathrm{hPa}$ 高度上的标准大气温度。在美国标准大气 (USSA) 中，$850\\,\\mathrm{hPa}$ 压强层上的温度约为 $277.8\\,\\mathrm{K}$。由于密度与温度成反比（$\\rho \\propto 1/T$），较低的温度会导致较高的密度，这与我们计算出的比值大于 1 的结果是一致的。",
            "answer": "$$\\boxed{1.033}$$"
        },
        {
            "introduction": "现实中的大气总是含有水汽，这会显著改变其热力学性质。此练习将干燥空气的框架扩展到湿润空气，引入了混合比（$r$）和道尔顿分压定律等关键概念。通过为一个湿润气块推导和计算一套完整的状态变量，您将深入理解水汽如何影响空气密度和有效气体常数，这是准确进行天气预报和气候模拟的核心技能 。",
            "id": "4039100",
            "problem": "一个大气模型网格单元的特征是测得的总压 $p = 1000\\,\\mathrm{hPa}$、绝对温度 $T = 298\\,\\mathrm{K}$ 和水汽混合比 $r = 0.02$（单位质量干空气所含的水汽质量）。假设干空气和水汽表现为理想气体，并形成一个不含液态水的理想混合物。从每个组分 $i$（干空气、水汽）的理想气体定律 $p_i = \\rho_i R_i T$、道尔顿分压定律以及混合比 $r$ 的定义出发，推导计算混合物比气体常数 $R_m$、水汽分压 $e$、干空气分压 $p_d$ 和总混合物密度 $\\rho$ 所需的表达式。使用干空气和水汽的标准比气体常数，$R_d = 287.05\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 和 $R_v = 461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。将 $R_m$ 以 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 表示，$e$ 和 $p_d$ 以 $\\mathrm{hPa}$ 表示，$\\rho$ 以 $\\mathrm{kg\\,m^{-3}}$ 表示。将每个最终量四舍五入到四位有效数字。为了计算 $\\rho$，需将压力转换为国际单位制（SI）基本单位 $\\mathrm{Pa}$，以与 $R_m$ 和 $T$ 保持一致。",
            "solution": "该问题陈述经核实具有科学依据、提法恰当且客观。它基于热力学的基本原理，提供了一套完整且一致的已知条件、假设和要求输出。因此，有必要提供完整的解答。\n\n该问题要求推导和计算湿空气块的四个量：混合物比气体常数 $R_m$、水汽分压 $e$、干空气分压 $p_d$ 和总混合物密度 $\\rho$。\n\n给定参数如下：\n总压, $p = 1000\\,\\mathrm{hPa}$\n绝对温度, $T = 298\\,\\mathrm{K}$\n水汽混合比, $r = 0.02$\n干空气比气体常数, $R_d = 287.05\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n水汽比气体常数, $R_v = 461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\n此问题的基础在于三个原理：各组分的理想气体定律、道尔顿分压定律和混合比的定义。\n\n干空气的理想气体定律为：\n$$p_d = \\rho_d R_d T$$\n其中 $p_d$ 是干空气的分压，$\\rho_d$ 是其密度。\n\n水汽的理想气体定律为：\n$$e = \\rho_v R_v T$$\n其中 $e$ 是水汽的分压（通常使用此符号代替 $p_v$），$\\rho_v$ 是其密度。\n\n道尔顿定律指出，总压是各分压之和：\n$$p = p_d + e$$\n\n混合比 $r$ 定义为在给定体积 $V$ 内，水汽质量 $m_v$ 与干空气质量 $m_d$ 之比。这等同于它们的密度之比：\n$$r = \\frac{m_v}{m_d} = \\frac{\\rho_v V}{\\rho_d V} = \\frac{\\rho_v}{\\rho_d}$$\n\n首先，我们推导分压 $p_d$ 和 $e$ 的表达式。我们可以从各自的气体定律中表达密度 $\\rho_d$ 和 $\\rho_v$：\n$$\\rho_d = \\frac{p_d}{R_d T} \\quad \\text{和} \\quad \\rho_v = \\frac{e}{R_v T}$$\n将这些代入混合比 $r$ 的定义中：\n$$r = \\frac{e / (R_v T)}{p_d / (R_d T)} = \\frac{e}{p_d} \\frac{R_d}{R_v}$$\n我们将气体常数之比定义为 $\\epsilon = \\frac{R_d}{R_v}$。这是一个无量纲常数。\n$$r = \\frac{e}{p_d} \\epsilon \\implies e = p_d \\frac{r}{\\epsilon}$$\n现在我们得到了一个关于两个未知数 $p_d$ 和 $e$ 的二元线性方程组：\n$$p = p_d + e$$\n$$e = p_d \\frac{r}{\\epsilon}$$\n将第二个方程代入第一个方程：\n$$p = p_d + p_d \\frac{r}{\\epsilon} = p_d \\left(1 + \\frac{r}{\\epsilon}\\right) = p_d \\left(\\frac{\\epsilon + r}{\\epsilon}\\right)$$\n求解 $p_d$：\n$$p_d = p \\left(\\frac{\\epsilon}{\\epsilon + r}\\right)$$\n现在，我们可以用 $e = p - p_d$ 求出 $e$：\n$$e = p - p \\left(\\frac{\\epsilon}{\\epsilon + r}\\right) = p \\left(1 - \\frac{\\epsilon}{\\epsilon + r}\\right) = p \\left(\\frac{\\epsilon + r - \\epsilon}{\\epsilon + r}\\right)$$\n$$e = p \\left(\\frac{r}{\\epsilon + r}\\right)$$\n\n接下来，我们推导混合物比气体常数 $R_m$ 的表达式。整个湿空气混合物的状态方程是 $p = \\rho R_m T$，其中 $\\rho = \\rho_d + \\rho_v$ 是总密度。常数 $R_m$ 是各气体常数的质量加权平均值：\n$$R_m = \\frac{m_d R_d + m_v R_v}{m_d + m_v}$$\n将分子和分母同时除以干空气的质量 $m_d$：\n$$R_m = \\frac{R_d + (m_v/m_d) R_v}{1 + m_v/m_d}$$\n代入混合比的定义 $r = m_v/m_d$：\n$$R_m = \\frac{R_d + r R_v}{1 + r}$$\n\n最后，混合物的总密度 $\\rho$ 直接从混合物的理想气体定律推导得出：\n$$p = \\rho R_m T \\implies \\rho = \\frac{p}{R_m T}$$\n\n现在我们可以计算数值了。\n首先，计算常数 $\\epsilon$：\n$$\\epsilon = \\frac{R_d}{R_v} = \\frac{287.05\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}}{461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}} \\approx 0.62200$$\n使用给定值 $p = 1000\\,\\mathrm{hPa}$ 和 $r = 0.02$：\n水汽分压 $e$ 为：\n$$e = (1000\\,\\mathrm{hPa}) \\left(\\frac{0.02}{0.62200 + 0.02}\\right) = (1000\\,\\mathrm{hPa}) \\left(\\frac{0.02}{0.64200}\\right) \\approx 31.1526\\,\\mathrm{hPa}$$\n四舍五入到四位有效数字，$e = 31.15\\,\\mathrm{hPa}$。\n\n干空气分压 $p_d$ 为：\n$$p_d = p - e = 1000\\,\\mathrm{hPa} - 31.1526\\,\\mathrm{hPa} = 968.8474\\,\\mathrm{hPa}$$\n四舍五入到四位有效数字，$p_d = 968.8\\,\\mathrm{hPa}$。\n\n混合物比气体常数 $R_m$ 为：\n$$R_m = \\frac{287.05\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} + (0.02)(461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})}{1 + 0.02} = \\frac{287.05 + 9.23}{1.02}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} = \\frac{296.28}{1.02}\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} \\approx 290.4706\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$$\n四舍五入到四位有效数字，$R_m = 290.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n\n总混合物密度 $\\rho$ 使用国际单位制基本单位计算。我们必须将压力从 hPa 转换为 Pa：$p = 1000\\,\\mathrm{hPa} = 1000 \\times 100\\,\\mathrm{Pa} = 100000\\,\\mathrm{Pa} = 10^5\\,\\mathrm{Pa}$。\n使用 $R_m$ 的未舍入值：\n$$\\rho = \\frac{100000\\,\\mathrm{Pa}}{(290.4706\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})(298\\,\\mathrm{K})} \\approx \\frac{100000}{86560.24}\\,\\mathrm{kg\\,m^{-3}} \\approx 1.15526\\,\\mathrm{kg\\,m^{-3}}$$\n四舍五入到四位有效数字，$\\rho = 1.155\\,\\mathrm{kg\\,m^{-3}}$。\n\n按要求顺序（$R_m$、$e$、$p_d$、$\\rho$）计算并四舍五入到四位有效数字的最终量为：$290.5$、$31.15$、$968.8$ 和 $1.155$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n290.5  31.15  968.8  1.155\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在复杂的数值天气预报和气候模型中，热力学方程不仅是理论概念，更是必须在不同模块（如动力学、微物理过程）之间精确且一致地实现的算法。本练习模拟了模型开发中的一个关键验证任务：设计一个测试套件，以确保状态变量（如压力、温度、密度和内能）之间的转换是闭环和自洽的。通过编写代码来量化数值误差，您将体会到在计算模型中保持热力学一致性的重要性 。",
            "id": "4039084",
            "problem": "设计并实现一个独立的程序，用于验证数值天气预报中代表热力学、微物理和动力学的抽象模型模块之间状态方程 (EOS) 的内部一致性。必须通过闭合状态变量——压强 $p$、温度 $T$、比湿 $q$（单位质量湿空气中水汽的质量）、密度 $\\rho$ 和比内能 $e$——之间的循环来检验这种一致性。假设以下基本框架，您必须在所有推导和计算中使用它：\n\n1. 湿空气的理想气体混合物模型：\n   - 干空气的比气体常数为 $R_d$，水汽的比气体常数为 $R_v$。\n   - 单位质量湿空气的混合物比气体常数为\n     $$R_m(q) = (1 - q) R_d + q R_v.$$\n   - 该混合物的理想气体定律为\n     $$p = \\rho \\, R_m(q) \\, T.$$\n\n2. 具有恒定、与温度无关的定容比热的双组分（干空气和水汽）理想气体混合物的比内能：\n   - 设 $c_{pd}$ 和 $c_{pv}$ 分别为干空气和水汽的定压比热。\n   - 定义 $c_{vd} = c_{pd} - R_d$ 和 $c_{vv} = c_{pv} - R_v$。\n   - 以 $T = 0$ K 时两种组分的内能为零点，混合物的比内能（单位质量湿空气）为\n     $$e(T, q) = \\big((1 - q) c_{vd} + q c_{vv}\\big) \\, T.$$\n   - 因此，其逆运算 $T(e, q)$ 为\n     $$T(e, q) = \\frac{e}{(1 - q) c_{vd} + q c_{vv}}.$$\n\n使用以下数值常量：\n- $R_d = 287.05$ J kg$^{-1}$ K$^{-1}$，\n- $R_v = 461.5$ J kg$^{-1}$ K$^{-1}$，\n- $c_{pd} = 1004.7$ J kg$^{-1}$ K$^{-1}$，\n- $c_{pv} = 1870.0$ J kg$^{-1}$ K$^{-1}$。\n\n所有物理量必须使用以下单位进行处理：\n- $p$ 以帕斯卡 (Pa) 为单位，\n- $T$ 以开尔文 (K) 为单位，\n- $q$ 以千克每千克 (kg kg$^{-1}$) 为单位，\n- $\\rho$ 以千克每立方米 (kg m$^{-3}$) 为单位，\n- $e$ 以焦耳每千克 (J kg$^{-1}$) 为单位。\n\n为每个测试用例实现的闭环一致性检查：\n- 循环 A（热力学-微物理）：$T \\rightarrow e \\rightarrow T$。根据 $T$ 和 $q$ 计算 $e$，然后进行逆运算以恢复 $T$，并报告相对误差\n  $$\\varepsilon_A = \\frac{|T_{\\text{out}} - T_{\\text{in}}|}{T_{\\text{in}}}.$$\n- 循环 B（动力学-EOS）：$(p, T, q) \\rightarrow \\rho \\rightarrow p$。使用理想气体定律根据 $p$、$T$、$q$ 计算 $\\rho$，然后根据 $\\rho$、$T$、$q$ 重新计算 $p$，并报告\n  $$\\varepsilon_B = \\frac{|p_{\\text{out}} - p_{\\text{in}}|}{p_{\\text{in}}}.$$\n- 循环 C（跨模块：热力学 + 动力学）：$(p, e, q) \\rightarrow T \\rightarrow \\rho \\rightarrow p$。根据 $e$、$q$ 计算 $T$，然后根据 $p$、$T$、$q$ 计算 $\\rho$，再根据 $\\rho$、$T$、$q$ 计算 $p$，并报告\n  $$\\varepsilon_C = \\frac{|p_{\\text{out}} - p_{\\text{in}}|}{p_{\\text{in}}}.$$\n- 循环 D（动力学-EOS 逆配对）：$(\\rho, T, q) \\rightarrow p \\rightarrow \\rho$。根据 $\\rho$、$T$、$q$ 计算 $p$，然后根据 $p$、$T$、$q$ 重新计算 $\\rho$，并报告\n  $$\\varepsilon_D = \\frac{|\\rho_{\\text{out}} - \\rho_{\\text{in}}|}{\\rho_{\\text{in}}}.$$\n- 循环 E（通过 $p$ 和 $e$ 的组合一致性）：$(p, \\rho, q) \\rightarrow T \\rightarrow e \\rightarrow T$。通过理想气体定律根据 $p$、$\\rho$、$q$ 计算 $T$，然后根据 $T$、$q$ 计算 $e$，再对 $e$ 和 $q$ 进行逆运算以恢复 $T$，并报告\n  $$\\varepsilon_E = \\frac{|T_{\\text{out}} - T_{\\text{in}}|}{T_{\\text{in}}}.$$\n\n对于每个测试用例，定义最大循环误差\n$$\\varepsilon_{\\max} = \\max\\{\\varepsilon_A, \\varepsilon_B, \\varepsilon_C, \\varepsilon_D, \\varepsilon_E\\}.$$\n\n您的程序必须为以下每个测试用例计算 $\\varepsilon_{\\max}$，这些用例涵盖了大气条件的典型范围和边界情况：\n- 用例 1：$(p, T, q) = (100000,\\; 300,\\; 0.01)$，\n- 用例 2：$(p, T, q) = (80000,\\; 250,\\; 0)$，\n- 用例 3：$(p, T, q) = (95000,\\; 305,\\; 0.03)$，\n- 用例 4：$(p, T, q) = (30000,\\; 220,\\; 0.001)$，\n- 用例 5：$(p, T, q) = (10000,\\; 260,\\; 0.02)$，\n- 用例 6：$(p, T, q) = (101325,\\; 273.15,\\; 0.0075)$。\n\n所有输入必须按照上述单位进行解释。输出是无量纲的相对误差。您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的浮点数列表，其顺序与上面列出的用例相同，例如：“[x1,x2,x3,x4,x5,x6]”。",
            "solution": "该问题要求设计并实现一个程序，以验证用于数值天气预报和气候模型的湿空气简化状态方程 (EOS) 的内部一致性。此验证通过在主要热力学状态变量之间执行一系列闭环计算并量化由此产生的数值误差来完成。该问题基于坚实的大气热力学原理，且定义明确，提供了所有必需的方程、常数和程序。\n\n首先，我们建立所提供的数学和物理框架。\n\n**控制方程和常数**\n湿空气的状态由压强 $p$、温度 $T$、密度 $\\rho$、比湿 $q$（水汽的质量分数）和比内能 $e$ 描述。这些变量之间的关系由理想气体混合物模型定义。\n\n湿空气混合物的比气体常数 $R_m$ 是干空气比气体常数 $R_d$ 和水汽比气体常数 $R_v$ 的质量加权平均值：\n$$R_m(q) = (1 - q) R_d + q R_v$$\n湿空气的理想气体定律连接了压强、密度和温度：\n$$p = \\rho \\, R_m(q) \\, T$$\n比内能 $e$ 是为具有恒定定容比热的理想气体混合物定义的。给定干空气的定压比热 $c_{pd}$ 和水汽的定压比热 $c_{pv}$，我们首先使用理想气体的迈耶关系式（Mayer's relation）推导出定容比热：\n$$c_{vd} = c_{pd} - R_d$$\n$$c_{vv} = c_{pv} - R_v$$\n相对于 $T=0$ K 的零点，混合物的比内能（单位质量湿空气）是各组分内能的质量加权平均值：\n$$e(T, q) = \\big((1 - q) c_{vd} + q c_{vv}\\big) \\, T$$\n该方程可以被逆转，以求出作为内能和比湿函数的温度：\n$$T(e, q) = \\frac{e}{(1 - q) c_{vd} + q c_{vv}}$$\n\n提供了物理常数的数值，并且必须在所有计算中使用：\n- $R_d = 287.05$ J kg$^{-1}$ K$^{-1}$\n- $R_v = 461.5$ J kg$^{-1}$ K$^{-1}$\n- $c_{pd} = 1004.7$ J kg$^{-1}$ K$^{-1}$\n- $c_{pv} = 1870.0$ J kg$^{-1}$ K$^{-1}$\n\n由此，我们计算出派生常数：\n- $c_{vd} = 1004.7 - 287.05 = 717.65$ J kg$^{-1}$ K$^{-1}$\n- $c_{vv} = 1870.0 - 461.5 = 1408.5$ J kg$^{-1}$ K$^{-1}$\n\n**闭环一致性分析**\n任务的核心是验证这些方程在数值上是否一致。这通过执行闭环计算来完成，在闭环计算中，最终计算出的变量理论上应与其初始值相同。任何偏差都是数值浮点误差的度量。对于由初始状态 $(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$ 定义的每个测试用例，我们评估五个这样的循环。一些循环需要初始变量，而这些变量并未在 $(p, T, q)$ 元组中直接提供；它们必须从初始状态计算得出。\n\n**循环 A: $T \\rightarrow e \\rightarrow T$**\n该循环检查温度和内能之间的正向和逆向关系。\n1. 给定初始温度 $T_{\\text{in}}$ 和比湿 $q_{\\text{in}}$。\n2. 计算比内能：$e_{\\text{out}} = \\big((1 - q_{\\text{in}}) c_{vd} + q_{\\text{in}} c_{vv}\\big) \\, T_{\\text{in}}$。\n3. 从该能量重新计算温度：$T_{\\text{out}} = \\frac{e_{\\text{out}}}{(1 - q_{\\text{in}}) c_{vd} + q_{\\text{in}} c_{vv}} = \\frac{\\big((1 - q_{\\text{in}}) c_{vd} + q_{\\text{in}} c_{vv}\\big) \\, T_{\\text{in}}}{(1 - q_{\\text{in}}) c_{vd} + q_{\\text{in}} c_{vv}} = T_{\\text{in}}$。\n代数上，$T_{\\text{out}} = T_{\\text{in}}$。相对误差为 $\\varepsilon_A = |T_{\\text{out}} - T_{\\text{in}}| / T_{\\text{in}}$。\n\n**循环 B: $(p, T, q) \\rightarrow \\rho \\rightarrow p$**\n该循环检查理想气体定律的一致性。\n1. 给定 $(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$。\n2. 计算密度：$\\rho_{\\text{out}} = \\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) \\, T_{\\text{in}}}$。\n3. 重新计算压强：$p_{\\text{out}} = \\rho_{\\text{out}} \\, R_m(q_{\\text{in}}) \\, T_{\\text{in}} = \\left(\\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) \\, T_{\\text{in}}}\\right) R_m(q_{\\text{in}}) \\, T_{\\text{in}} = p_{\\text{in}}$。\n代数上，$p_{\\text{out}} = p_{\\text{in}}$。相对误差为 $\\varepsilon_B = |p_{\\text{out}} - p_{\\text{in}}| / p_{\\text{in}}$。\n\n**循环 C: $(p, e, q) \\rightarrow T \\rightarrow \\rho \\rightarrow p$**\n该循环结合了热力学和动力学关系。测试用例提供了 $(p, T, q)$，因此我们必须首先计算初始能量 $e$。\n1. 给定状态 $(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$。\n2. 计算初始能量：$e_{\\text{loop}} = e(T_{\\text{in}}, q_{\\text{in}})$。\n3. 循环以 $(p_{\\text{in}}, e_{\\text{loop}}, q_{\\text{in}})$ 开始。\n4. 计算温度：$T_{\\text{out1}} = T(e_{\\text{loop}}, q_{\\text{in}}) = T(e(T_{\\text{in}}, q_{\\text{in}}), q_{\\text{in}}) = T_{\\text{in}}$。\n5. 计算密度：$\\rho_{\\text{out}} = \\rho(p_{\\text{in}}, T_{\\text{out1}}, q_{\\text{in}}) = \\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) T_{\\text{in}}}$。\n6. 重新计算压强：$p_{\\text{out}} = p(\\rho_{\\text{out}}, T_{\\text{out1}}, q_{\\text{in}}) = \\rho_{\\text{out}} R_m(q_{\\text{in}}) T_{\\text{in}} = p_{\\text{in}}$。\n代数上，$p_{\\text{out}} = p_{\\text{in}}$。相对误差为 $\\varepsilon_C = |p_{\\text{out}} - p_{\\text{in}}| / p_{\\text{in}}$。\n\n**循环 D: $(\\rho, T, q) \\rightarrow p \\rightarrow \\rho$**\n该循环是理想气体定律的另一项检查，从密度开始。\n1. 给定状态 $(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$。\n2. 计算初始密度：$\\rho_{\\text{in\\_loop}} = \\rho(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}}) = \\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) T_{\\text{in}}}$。\n3. 循环以 $(\\rho_{\\text{in\\_loop}}, T_{\\text{in}}, q_{\\text{in}})$ 开始。\n4. 计算压强：$p_{\\text{out1}} = p(\\rho_{\\text{in\\_loop}}, T_{\\text{in}}, q_{\\text{in}}) = \\rho_{\\text{in\\_loop}} R_m(q_{\\text{in}}) T_{\\text{in}} = p_{\\text{in}}$。\n5. 重新计算密度：$\\rho_{\\text{out}} = \\rho(p_{\\text{out1}}, T_{\\text{in}}, q_{\\text{in}}) = \\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) T_{\\text{in}}} = \\rho_{\\text{in\\_loop}}$。\n代数上，$\\rho_{\\text{out}} = \\rho_{\\text{in\\_loop}}$。相对误差为 $\\varepsilon_D = |\\rho_{\\text{out}} - \\rho_{\\text{in\\_loop}}| / \\rho_{\\text{in\\_loop}}$。\n\n**循环 E: $(p, \\rho, q) \\rightarrow T \\rightarrow e \\rightarrow T$**\n该循环提供了对所有状态变量的综合检查。\n1. 给定状态 $(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$。\n2. 计算初始密度：$\\rho_{\\text{in\\_loop}} = \\rho(p_{\\text{in}}, T_{\\text{in}}, q_{\\text{in}})$。\n3. 循环以 $(p_{\\text{in}}, \\rho_{\\text{in\\_loop}}, q_{\\text{in}})$ 开始。用于误差计算的参考温度是 $T_{\\text{in}}$。\n4. 计算温度：$T_{\\text{out1}} = T(p_{\\text{in}}, \\rho_{\\text{in\\_loop}}, q_{\\text{in}}) = \\frac{p_{\\text{in}}}{\\rho_{\\text{in\\_loop}} R_m(q_{\\text{in}})} = \\frac{p_{\\text{in}}}{(\\frac{p_{\\text{in}}}{R_m(q_{\\text{in}}) T_{\\text{in}}}) R_m(q_{\\text{in}})} = T_{\\text{in}}$。\n5. 计算能量：$e_{\\text{out}} = e(T_{\\text{out1}}, q_{\\text{in}}) = e(T_{\\text{in}}, q_{\\text{in}})$。\n6. 从能量重新计算温度：$T_{\\text{out}} = T(e_{\\text{out}}, q_{\\text{in}}) = T(e(T_{\\text{in}}, q_{\\text{in}}), q_{\\text{in}}) = T_{\\text{in}}$。\n代数上，$T_{\\text{out}} = T_{\\text{in}}$。相对误差为 $\\varepsilon_E = |T_{\\text{out}} - T_{\\text{in}}| / T_{\\text{in}}$。\n\n**实现计划**\n实现将精确遵循这些步骤。将构建一个 Python 程序以：\n1. 定义所有主要和派生的物理常数。\n2. 为每个物理方程创建一组函数，以提高清晰度和可重用性。例如，`get_e_from_T_q(T, q)`、`get_rho_from_p_T_q(p, T, q)` 等。\n3. 遍历所提供的六个测试用例中的每一个。\n4. 对每个用例，如上所述执行五个验证循环，计算相对误差 $\\varepsilon_A, \\varepsilon_B, \\varepsilon_C, \\varepsilon_D, \\varepsilon_E$。\n5. 确定该用例的最大误差 $\\varepsilon_{\\max} = \\max\\{\\varepsilon_A, \\varepsilon_B, \\varepsilon_C, \\varepsilon_D, \\varepsilon_E\\}$。由于使用标准的双精度浮点运算，这些误差预计在机器精度（$\\approx 10^{-16}$）的数量级。\n6. 收集所有用例的 $\\varepsilon_{\\max}$ 值，并以指定的逗号分隔格式打印它们。\n这种系统化的方法确保数值实现正确反映了代数模型，并为其自洽性提供了定量度量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum loop error for a set of test cases to validate\n    the internal consistency of an equation of state for moist air.\n    \"\"\"\n\n    # Define physical constants as per the problem statement.\n    # All units are SI.\n    R_d = 287.05  # J kg^-1 K^-1 (specific gas constant for dry air)\n    R_v = 461.5   # J kg^-1 K^-1 (specific gas constant for water vapor)\n    c_pd = 1004.7 # J kg^-1 K^-1 (specific heat at constant pressure for dry air)\n    c_pv = 1870.0 # J kg^-1 K^-1 (specific heat at constant pressure for water vapor)\n\n    # Derive specific heats at constant volume using Mayer's relation.\n    c_vd = c_pd - R_d\n    c_vv = c_pv - R_v\n\n    def get_Rm(q):\n        \"\"\"Computes mixture specific gas constant R_m.\"\"\"\n        return (1.0 - q) * R_d + q * R_v\n    \n    def get_cvm(q):\n        \"\"\"Computes mixture specific heat at constant volume c_vm.\"\"\"\n        return (1.0 - q) * c_vd + q * c_vv\n\n    # --- Core state functions derived from the EOS ---\n\n    def get_e_from_T_q(T, q):\n        \"\"\"Computes specific internal energy e from T and q.\"\"\"\n        return get_cvm(q) * T\n\n    def get_T_from_e_q(e, q):\n        \"\"\"Computes temperature T from e and q.\"\"\"\n        cvm = get_cvm(q)\n        # Avoid division by zero, though not expected for valid q.\n        if cvm == 0:\n            return 0.0\n        return e / cvm\n\n    def get_rho_from_p_T_q(p, T, q):\n        \"\"\"Computes density rho from p, T, and q.\"\"\"\n        Rm = get_Rm(q)\n        # Avoid division by zero for T or Rm.\n        if T == 0 or Rm == 0:\n            return np.inf\n        return p / (Rm * T)\n\n    def get_p_from_rho_T_q(rho, T, q):\n        \"\"\"Computes pressure p from rho, T, and q.\"\"\"\n        return rho * get_Rm(q) * T\n\n    def get_T_from_p_rho_q(p, rho, q):\n        \"\"\"Computes temperature T from p, rho, and q.\"\"\"\n        Rm = get_Rm(q)\n        # Avoid division by zero.\n        if rho == 0 or Rm == 0:\n            return np.inf\n        return p / (rho * Rm)\n\n    # --- Test Cases ---\n    test_cases = [\n        # (p in Pa, T in K, q in kg/kg)\n        (100000.0, 300.0, 0.01),\n        (80000.0, 250.0, 0.0),\n        (95000.0, 305.0, 0.03),\n        (30000.0, 220.0, 0.001),\n        (10000.0, 260.0, 0.02),\n        (101325.0, 273.15, 0.0075),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_in, T_in, q_in = case\n        \n        errors = []\n\n        # Loop A: T -> e -> T\n        e_tmp = get_e_from_T_q(T_in, q_in)\n        T_out_A = get_T_from_e_q(e_tmp, q_in)\n        err_A = abs(T_out_A - T_in) / T_in if T_in != 0 else 0.0\n        errors.append(err_A)\n\n        # Loop B: (p, T, q) -> rho -> p\n        rho_tmp = get_rho_from_p_T_q(p_in, T_in, q_in)\n        p_out_B = get_p_from_rho_T_q(rho_tmp, T_in, q_in)\n        err_B = abs(p_out_B - p_in) / p_in if p_in != 0 else 0.0\n        errors.append(err_B)\n\n        # Loop C: (p, e, q) -> T -> rho -> p\n        e_loop_in = get_e_from_T_q(T_in, q_in)\n        T_tmp_C = get_T_from_e_q(e_loop_in, q_in)\n        rho_tmp_C = get_rho_from_p_T_q(p_in, T_tmp_C, q_in)\n        p_out_C = get_p_from_rho_T_q(rho_tmp_C, T_tmp_C, q_in)\n        err_C = abs(p_out_C - p_in) / p_in if p_in != 0 else 0.0\n        errors.append(err_C)\n        \n        # Loop D: (rho, T, q) -> p -> rho\n        rho_in_loop = get_rho_from_p_T_q(p_in, T_in, q_in)\n        p_tmp_D = get_p_from_rho_T_q(rho_in_loop, T_in, q_in)\n        rho_out_D = get_rho_from_p_T_q(p_tmp_D, T_in, q_in)\n        err_D = abs(rho_out_D - rho_in_loop) / rho_in_loop if rho_in_loop != 0 else 0.0\n        errors.append(err_D)\n        \n        # Loop E: (p, rho, q) -> T -> e -> T\n        rho_in_loop_E = get_rho_from_p_T_q(p_in, T_in, q_in)\n        T_tmp1_E = get_T_from_p_rho_q(p_in, rho_in_loop_E, q_in)\n        e_tmp_E = get_e_from_T_q(T_tmp1_E, q_in)\n        T_out_E = get_T_from_e_q(e_tmp_E, q_in)\n        err_E = abs(T_out_E - T_in) / T_in if T_in != 0 else 0.0\n        errors.append(err_E)\n\n        # Find the maximum error for the current case\n        max_error = max(errors) if errors else 0.0\n        results.append(max_error)\n\n    # Format the final output string as required.\n    # The default string representation of floats is sufficient.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}