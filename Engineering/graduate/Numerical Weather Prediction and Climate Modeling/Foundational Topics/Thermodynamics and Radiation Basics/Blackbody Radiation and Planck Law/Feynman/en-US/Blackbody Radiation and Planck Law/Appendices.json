{
    "hands_on_practices": [
        {
            "introduction": "The mathematical description of blackbody radiation, Planck's law, can be expressed in terms of either wavelength ($\\lambda$) or frequency ($\\nu$). While these forms describe the same physical phenomenon, they are not mathematically identical. This exercise provides foundational practice in transforming between these representations, a crucial skill for comparing experimental data from different types of spectrometers or for working with radiative transfer equations formulated in different domains .",
            "id": "1982590",
            "problem": "An experimental physicist is studying the thermal radiation emitted from a nearly perfect blackbody cavity held at a constant absolute temperature $T$. A spectrometer is used to measure the spectral radiance, which is the power emitted per unit area, per unit solid angle, per unit wavelength. The theoretical model for this spectral radiance as a function of wavelength $\\lambda$ is given by Planck's law:\n$$B_\\lambda(\\lambda, T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right) - 1}$$\nwhere $h$ is Planck's constant, $c$ is the speed of light in vacuum, and $k_B$ is the Boltzmann constant.\n\nA colleague in a different lab is performing a similar experiment, but their equipment measures the spectral radiance per unit frequency, denoted as $B_\\nu(\\nu, T)$. To compare results, the physicist needs to convert the theoretical expression from the wavelength domain to the frequency domain. The two quantities are related by the fact that the energy radiated in an infinitesimal interval must be the same, regardless of whether it's described by wavelength or frequency. This means the spectral radiance over an infinitesimal wavelength interval $d\\lambda$ corresponds to the same energy as the spectral radiance over the equivalent frequency interval $d\\nu$.\n\nGiven the fundamental relationship between wavelength and frequency for electromagnetic radiation, $c = \\lambda\\nu$, derive the expression for the spectral radiance per unit frequency, $B_\\nu(\\nu, T)$. Your final answer should be an expression in terms of $\\nu$, $T$, and the relevant physical constants.",
            "solution": "We start from the physical requirement that the emitted power per unit area and per unit solid angle in corresponding infinitesimal intervals must be equal whether described in terms of wavelength or frequency. This conservation under a change of variables is expressed as\n$$\nB_{\\lambda}(\\lambda, T)\\, d\\lambda = B_{\\nu}(\\nu, T)\\, d\\nu.\n$$\nThe fundamental relation between wavelength and frequency is $c = \\lambda \\nu$, hence $\\nu = \\frac{c}{\\lambda}$. Differentiating with respect to $\\lambda$ gives\n$$\n\\frac{d\\nu}{d\\lambda} = -\\frac{c}{\\lambda^{2}}.\n$$\nTherefore,\n$$\n\\left|\\frac{d\\lambda}{d\\nu}\\right| = \\frac{\\lambda^{2}}{c} = \\frac{c}{\\nu^{2}},\n$$\nwhere we used $\\lambda = \\frac{c}{\\nu}$ to express the Jacobian in terms of $\\nu$. Because spectral radiance is a density and must remain nonnegative, we use the absolute value of the Jacobian. Thus,\n$$\nB_{\\nu}(\\nu, T) = B_{\\lambda}(\\lambda, T)\\, \\left|\\frac{d\\lambda}{d\\nu}\\right| \\quad \\text{with} \\quad \\lambda = \\frac{c}{\\nu}.\n$$\n\nSubstitute Planck’s law in the wavelength domain,\n$$\nB_{\\lambda}(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nand set $\\lambda = \\frac{c}{\\nu}$:\n$$\nB_{\\nu}(\\nu, T) = \\left[\\frac{2 h c^{2}}{\\left(\\frac{c}{\\nu}\\right)^{5}} \\frac{1}{\\exp\\left(\\frac{h c}{\\left(\\frac{c}{\\nu}\\right) k_{B} T}\\right) - 1}\\right] \\left(\\frac{c}{\\nu^{2}}\\right).\n$$\nSimplify each factor. First,\n$$\n\\frac{2 h c^{2}}{\\left(\\frac{c}{\\nu}\\right)^{5}} = \\frac{2 h c^{2}}{\\frac{c^{5}}{\\nu^{5}}} = \\frac{2 h \\nu^{5}}{c^{3}}.\n$$\nSecond, the exponential argument simplifies as\n$$\n\\frac{h c}{\\left(\\frac{c}{\\nu}\\right) k_{B} T} = \\frac{h \\nu}{k_{B} T}.\n$$\nTherefore,\n$$\nB_{\\nu}(\\nu, T) = \\left(\\frac{2 h \\nu^{5}}{c^{3}}\\right) \\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1} \\left(\\frac{c}{\\nu^{2}}\\right) = \\frac{2 h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}.\n$$\nThis is the desired expression for the spectral radiance per unit frequency obtained from Planck’s law via the change of variables from wavelength to frequency.",
            "answer": "$$\\boxed{\\frac{2 h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}}$$"
        },
        {
            "introduction": "While Planck's law provides a complete spectral description of blackbody emission, we often need to know the total energy radiated across all frequencies. This practice takes you through the fundamental derivation of the Stefan-Boltzmann law from Planck's law, showing how the total hemispheric flux is proportional to the fourth power of temperature ($T^4$). By performing the integration, you will not only derive the famous Stefan-Boltzmann constant, $\\sigma$, from first principles but also reinforce your understanding of how microscopic spectral details integrate into a powerful macroscopic law governing energy balance in climate models .",
            "id": "4017702",
            "problem": "In a General Circulation Model (GCM) used for Numerical Weather Prediction (NWP) and climate modeling, the upward longwave radiative flux from a horizontally homogeneous surface is computed by integrating the spectral radiance over all frequencies and over the upward hemisphere. Starting from Planck’s spectral radiance per unit frequency for a blackbody at temperature $T$,\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\!\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right),\n$$\nand assuming isotropic emission, derive from first principles the frequency-integrated, hemispheric radiative flux as a function of $T$ and fundamental constants. Identify the constant of proportionality multiplying $T^{4}$ and denote it by $\\sigma$. Express $\\sigma$ as a closed-form analytic expression in terms of $h$, $k_{B}$, $c$, and a dimensionless integral, and then evaluate that integral exactly. Using the following exact International System of Units (SI) values of the fundamental constants,\n$$\nh = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s},\\quad\nk_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}},\\quad\nc = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}},\n$$\ncompute the numerical value of $\\sigma$. Round your final numerical result to four significant figures and express it in $\\mathrm{W\\,m^{-2}\\,K^{-4}}$. Briefly articulate, based on your derivation, how the accuracy of $\\sigma$ affects surface energy budget closure in climate models, but ensure that your final reported answer is only the numerical value of $\\sigma$ as specified.",
            "solution": "The problem asks for the derivation of the frequency-integrated, hemispheric radiative flux from a blackbody surface, which is known as the Stefan-Boltzmann law. We begin with the given Planck's spectral radiance per unit frequency, $B_{\\nu}(T)$. This quantity represents the power emitted per unit area of the source, per unit solid angle, per unit frequency. Its units are $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,Hz^{-1}}$.\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right)\n$$\nHere, $h$ is the Planck constant, $k_B$ is the Boltzmann constant, $c$ is the speed of light in vacuum, $T$ is the absolute temperature of the blackbody, and $\\nu$ is the frequency of the radiation.\n\nThe spectral radiative flux, $F_{\\nu}(T)$, also known as spectral exitance, is the power per unit area per unit frequency emitted into the entire upward hemisphere. Assuming the emission is isotropic (i.e., the radiance $B_{\\nu}(T)$ is independent of direction), we can find the spectral flux by integrating the radiance over the hemisphere of solid angles. The contribution from a differential solid angle $d\\Omega$ is weighted by $\\cos\\theta$, where $\\theta$ is the zenith angle, to account for the projected area of emission (Lambert's cosine law).\n$$\nF_{\\nu}(T) = \\int_{\\Omega} B_{\\nu}(T) \\cos\\theta \\, d\\Omega\n$$\nIn spherical coordinates, the differential solid angle is $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$, where $\\phi$ is the azimuthal angle. The integral is over the upward hemisphere, so the limits are $\\theta \\in [0, \\pi/2]$ and $\\phi \\in [0, 2\\pi]$.\nSince $B_{\\nu}(T)$ is independent of direction, we can take it out of the integral:\n$$\nF_{\\nu}(T) = B_{\\nu}(T) \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi/2} \\cos\\theta \\sin\\theta \\, d\\theta\n$$\nThe integral over the azimuthal angle is $\\int_{0}^{2\\pi} d\\phi = 2\\pi$. The integral over the zenith angle can be solved by a substitution, such as $u = \\sin\\theta$, for which $du = \\cos\\theta \\, d\\theta$:\n$$\n\\int_{0}^{\\pi/2} \\cos\\theta \\sin\\theta \\, d\\theta = \\int_{0}^{1} u \\, du = \\left[ \\frac{u^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\nThus, the total angular integral is $2\\pi \\times \\frac{1}{2} = \\pi$. This yields the relationship between spectral flux and isotropic spectral radiance:\n$$\nF_{\\nu}(T) = \\pi B_{\\nu}(T) = \\frac{2 \\pi h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right)\n$$\nTo find the total hemispheric radiative flux, $F(T)$, we must integrate the spectral flux $F_{\\nu}(T)$ over all frequencies, from $\\nu = 0$ to $\\nu = \\infty$.\n$$\nF(T) = \\int_{0}^{\\infty} F_{\\nu}(T) \\, d\\nu = \\int_{0}^{\\infty} \\frac{2 \\pi h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1} \\, d\\nu\n$$\nWe can group the constants outside the integral:\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\int_{0}^{\\infty} \\frac{\\nu^{3}}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1} \\, d\\nu\n$$\nTo evaluate this integral, we perform a change of variables to a dimensionless quantity $x$:\n$$\nx = \\frac{h \\nu}{k_{B} T} \\implies \\nu = \\frac{k_{B} T}{h} x \\implies d\\nu = \\frac{k_{B} T}{h} dx\n$$\nSubstituting these into the integral expression:\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\int_{0}^{\\infty} \\frac{\\left(\\frac{k_{B} T}{h}x\\right)^{3}}{\\exp(x) - 1} \\left(\\frac{k_{B} T}{h} dx\\right)\n$$\nNow, we collect all terms involving the constants and the temperature $T$:\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\left(\\frac{k_{B} T}{h}\\right)^{4} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx\n$$\n$$\nF(T) = \\left( \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx \\right) T^{4}\n$$\nThis equation is of the form $F(T) = \\sigma T^{4}$, which is the Stefan-Boltzmann law. The constant of proportionality, $\\sigma$, is identified as:\n$$\n\\sigma = \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx\n$$\nThe remaining task is to evaluate the dimensionless integral, $I = \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx$. We can rewrite the integrand using a geometric series expansion:\n$$\n\\frac{1}{\\exp(x) - 1} = \\frac{\\exp(-x)}{1 - \\exp(-x)} = \\sum_{n=1}^{\\infty} \\exp(-nx)\n$$\nSubstituting this into the integral and interchanging the summation and integration, which is permissible due to uniform convergence:\n$$\nI = \\int_{0}^{\\infty} x^{3} \\sum_{n=1}^{\\infty} \\exp(-nx) \\, dx = \\sum_{n=1}^{\\infty} \\int_{0}^{\\infty} x^{3} \\exp(-nx) \\, dx\n$$\nThe integral inside the sum can be evaluated using the substitution $u = nx$, so $x = u/n$ and $dx = du/n$.\n$$\n\\int_{0}^{\\infty} x^{3} \\exp(-nx) \\, dx = \\int_{0}^{\\infty} \\left(\\frac{u}{n}\\right)^{3} \\exp(-u) \\left(\\frac{du}{n}\\right) = \\frac{1}{n^{4}} \\int_{0}^{\\infty} u^{3} \\exp(-u) \\, du\n$$\nThe integral $\\int_{0}^{\\infty} u^{3} \\exp(-u) \\, du$ is the definition of the Gamma function $\\Gamma(4)$. For integer arguments, $\\Gamma(z) = (z-1)!$, so $\\Gamma(4) = 3! = 6$.\nTherefore, the integral inside the sum is $\\frac{6}{n^{4}}$, and the dimensionless integral $I$ becomes:\n$$\nI = \\sum_{n=1}^{\\infty} \\frac{6}{n^{4}} = 6 \\sum_{n=1}^{\\infty} \\frac{1}{n^{4}}\n$$\nThe sum is the definition of the Riemann zeta function $\\zeta(4)$. The exact value is known to be $\\zeta(4) = \\frac{\\pi^{4}}{90}$.\n$$\nI = 6 \\left(\\frac{\\pi^{4}}{90}\\right) = \\frac{\\pi^{4}}{15}\n$$\nSubstituting this result back into the expression for $\\sigma$, we obtain its closed-form analytic expression in terms of fundamental constants:\n$$\n\\sigma = \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\left(\\frac{\\pi^{4}}{15}\\right) = \\frac{2 \\pi^{5} k_{B}^{4}}{15 c^{2} h^{3}}\n$$\nNow we compute the numerical value of $\\sigma$ using the provided exact SI values:\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n$c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$\nSubstituting these into the expression for $\\sigma$:\n$$\n\\sigma = \\frac{2 \\pi^{5} (1.380649 \\times 10^{-23})^{4}}{15 (2.99792458 \\times 10^{8})^{2} (6.62607015 \\times 10^{-34})^{3}}\n$$\nA high-precision calculation yields:\n$$\n\\sigma \\approx 5.670374419... \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}\n$$\nRounding this result to four significant figures as requested:\n$$\n\\sigma \\approx 5.670 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}\n$$\nRegarding the significance of $\\sigma$'s accuracy for climate models: The surface energy budget is a core component of any climate model, used to determine the surface temperature $T_s$. This budget balances incoming and outgoing energy fluxes. A critical term in this balance is the upward longwave radiation from the surface, given by $L_{\\uparrow} = \\epsilon \\sigma T_s^4$, where $\\epsilon$ is the surface emissivity. The calculated surface temperature, a key prognostic variable, is highly sensitive to this term, which has a strong $T_s^4$ dependence scaled by $\\sigma$. Any inaccuracy in the value of $\\sigma$ would introduce a systematic bias into the model's energy balance. An erroneously high $\\sigma$ would cause the model to overestimate radiative cooling, leading to an artificially low computed surface temperature, while a low $\\sigma$ would do the opposite. However, as demonstrated, $\\sigma$ is not an empirical parameter but a constant derived from fundamental constants $h$, $k_B$, and $c$. Following the 2019 redefinition of SI base units, these fundamental constants have exact, defined values. Consequently, $\\sigma$ is also an exactly known constant, and it is not a source of numerical uncertainty in modern, correctly implemented climate models. The accuracy challenge lies in other parts of the energy budget, such as the parameterizations for emissivity, clouds, and turbulent fluxes.",
            "answer": "$$\\boxed{5.670 \\times 10^{-8}}$$"
        },
        {
            "introduction": "The blackbody is a powerful idealization, but real-world surfaces like oceans, forests, and deserts have emissivities that vary with wavelength. This computational exercise moves from idealized theory to practical application, requiring you to calculate radiative fluxes from surfaces with realistic, spectrally-dependent emissivities. By implementing this model, you will gain hands-on experience with the numerical integration techniques used in weather and climate models to represent the Earth's surface energy budget accurately, highlighting the significant differences that arise when departing from the simple blackbody assumption .",
            "id": "4017764",
            "problem": "In numerical weather prediction and climate modeling, the surface upward longwave flux used as a lower boundary condition must account for spectrally varying surface emissivity rather than assuming ideal blackbody behavior. Consider a horizontally homogeneous, isotropic, Lambertian surface at thermodynamic equilibrium with temperature $T_s$ emitting thermal radiation. Let the wavelength be denoted by $\\lambda$ and expressed in micrometers ($\\mu\\mathrm{m}$) for all band specifications, while all physical laws are applied in SI units, with $\\lambda$ internally converted to meters for any calculation. The band-limited hemispheric emitted flux over a wavelength interval $[\\lambda_1,\\lambda_2]$ must be obtained by integrating the product of the spectral emissivity and the appropriate equilibrium spectral radiative quantity over $\\lambda$. For realistic surfaces, the spectral emissivity depends on $\\lambda$ and the material. Use the following spectrally varying emissivity functions, chosen to be physically plausible for desert and ocean surfaces in the thermal infrared:\n\n- Desert emissivity $\\epsilon_\\lambda(\\mathrm{desert})$ in $\\mu\\mathrm{m}$:\n$$\n\\epsilon_\\lambda(\\mathrm{desert}) \\;=\\; \\mathrm{clip}\\!\\left(0.975 \\;-\\; 0.080\\,\\exp\\!\\left(-\\dfrac{(\\lambda-9.0)^2}{2\\times 0.4^2}\\right) \\;-\\; 0.015\\,\\exp\\!\\left(-\\dfrac{(\\lambda-12.5)^2}{2\\times 0.9^2}\\right),\\; 0.85,\\; 0.99\\right),\n$$\nwhere $\\mathrm{clip}(x,a,b)$ restricts $x$ to the interval $[a,b]$.\n\n- Ocean emissivity $\\epsilon_\\lambda(\\mathrm{ocean})$ in $\\mu\\mathrm{m}$:\n$$\n\\epsilon_\\lambda(\\mathrm{ocean}) \\;=\\; \\mathrm{clip}\\!\\left(0.986 \\;-\\; 0.003\\,\\cos\\!\\left(\\dfrac{2\\pi(\\lambda-10)}{20}\\right) \\;-\\; 0.002\\,\\exp\\!\\left(-\\dfrac{(\\lambda-8.0)^2}{2\\times 0.6^2}\\right),\\; 0.97,\\; 0.995\\right).\n$$\n\nStarting from a valid thermodynamic-radiative equilibrium base, derive the band-limited hemispheric emitted flux for a Lambertian surface with spectrally varying emissivity over $[\\lambda_1,\\lambda_2]$, and the corresponding idealized blackbody band flux (the blackbody assumption corresponds to unit emissivity). Then implement a program that, for the test suite below, computes for each case the fractional difference between the emissivity-based band flux and the blackbody band flux, defined as\n$$\n\\delta \\;=\\; \\dfrac{F_{\\epsilon} - F_{\\mathrm{bb}}}{F_{\\mathrm{bb}}},\n$$\nwhich is dimensionless and should be reported as a decimal number (not using a percentage sign).\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\delta_1,\\delta_2,\\dots]$). The required test suite covers typical and edge conditions:\n\n- Case $1$: Desert surface, $T_s = 320\\,\\mathrm{K}$, band $[8,13]\\,\\mu\\mathrm{m}$.\n- Case $2$: Ocean surface, $T_s = 295\\,\\mathrm{K}$, band $[8,13]\\,\\mu\\mathrm{m}$.\n- Case $3$: Desert surface, $T_s = 320\\,\\mathrm{K}$, band $[4,50]\\,\\mu\\mathrm{m}$.\n- Case $4$: Ocean surface, $T_s = 295\\,\\mathrm{K}$, band $[4,50]\\,\\mu\\mathrm{m}$.\n- Case $5$: Ocean surface (cold), $T_s = 260\\,\\mathrm{K}$, band $[10,12]\\,\\mu\\mathrm{m}$.\n- Case $6$: Desert surface (narrow window around a known silicate feature), $T_s = 320\\,\\mathrm{K}$, band $[8.8,9.2]\\,\\mu\\mathrm{m}$.\n\nAll internal physical calculations that involve wavelength must use meters, and any fluxes are in watts per square meter ($\\mathrm{W}\\,\\mathrm{m}^{-2}$), but the final reported $\\delta$ values must be dimensionless decimals. Your implementation must be self-contained and runnable without user input, and it must adhere to the output format specified above.",
            "solution": "The physical principle governing the emission of thermal radiation from a body in thermodynamic equilibrium at a temperature $T$ is Planck's law. For a perfect blackbody, the law describes the spectral radiance $B_\\lambda(\\lambda, T)$, which is the power emitted per unit area, per unit solid angle, per unit wavelength, as a function of wavelength $\\lambda$ and temperature $T$. In SI units, its expression is:\n$$\nB_\\lambda(\\lambda, T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right) - 1} \\quad [\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}]\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light in a vacuum, and $k_B$ is the Boltzmann constant.\n\nThe problem specifies that the emitting surface is Lambertian, meaning it radiates isotropically (with the same radiance in all directions). For a Lambertian surface, the spectral hemispheric exitance, $E_\\lambda(\\lambda, T)$, which is the total power emitted per unit area per unit wavelength into the hemisphere above the surface, is related to the spectral radiance by $E_\\lambda = \\pi B_\\lambda$. A real surface is characterized by a spectral emissivity $\\epsilon_\\lambda(\\lambda)$, where $0 \\le \\epsilon_\\lambda \\le 1$, which is the ratio of its spectral exitance to that of a blackbody at the same temperature. Therefore, the spectral hemispheric exitance from a real Lambertian surface at temperature $T_s$ is:\n$$\nE_\\lambda(\\lambda, T_s) = \\epsilon_\\lambda(\\lambda) \\cdot \\pi B_\\lambda(\\lambda, T_s) = \\epsilon_\\lambda(\\lambda) \\cdot E_{\\mathrm{b}\\lambda}(\\lambda, T_s)\n$$\nwhere $E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$ is the spectral hemispheric exitance of a blackbody. It is often written using the first and second radiation constants, $c_1 = 2\\pi h c^2$ and $c_2 = hc/k_B$:\n$$\nE_{\\mathrm{b}\\lambda}(\\lambda, T_s) = \\frac{c_1}{\\lambda^5 \\left( \\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1 \\right)} \\quad [\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{m}^{-1}]\n$$\nThe problem requires the calculation of the band-limited hemispheric emitted flux, $F$, over a wavelength interval $[\\lambda_1, \\lambda_2]$. This is obtained by integrating the spectral hemispheric exitance over the specified wavelength band. For the surface with spectrally varying emissivity $\\epsilon_\\lambda(\\lambda)$, the flux $F_{\\epsilon}$ is:\n$$\nF_{\\epsilon}(T_s, \\lambda_1, \\lambda_2) = \\int_{\\lambda_1}^{\\lambda_2} E_\\lambda(\\lambda, T_s) \\, d\\lambda = \\int_{\\lambda_1}^{\\lambda_2} \\epsilon_\\lambda(\\lambda) E_{\\mathrm{b}\\lambda}(\\lambda, T_s) \\, d\\lambda\n$$\nFor the idealized case of a blackbody, the emissivity is unity, $\\epsilon_\\lambda(\\lambda) = 1$, for all wavelengths. The corresponding blackbody band flux $F_{\\mathrm{bb}}$ is:\n$$\nF_{\\mathrm{bb}}(T_s, \\lambda_1, \\lambda_2) = \\int_{\\lambda_1}^{\\lambda_2} E_{\\mathrm{b}\\lambda}(\\lambda, T_s) \\, d\\lambda\n$$\nThe target quantity is the fractional difference, $\\delta$, between the emissivity-based flux and the blackbody flux:\n$$\n\\delta = \\frac{F_{\\epsilon} - F_{\\mathrm{bb}}}{F_{\\mathrm{bb}}} = \\frac{F_{\\epsilon}}{F_{\\mathrm{bb}}} - 1\n$$\nThe integrals for $F_{\\epsilon}$ and $F_{\\mathrm{bb}}$ do not have general analytical solutions and must be computed using numerical quadrature. The implementation will define the given emissivity functions, $\\epsilon_\\lambda(\\mathrm{desert})$ and $\\epsilon_\\lambda(\\mathrm{ocean})$, and the Planck function $E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$. A critical detail is the handling of units: the emissivity functions are defined with wavelength $\\lambda$ in micrometers ($\\mu\\mathrm{m}$), whereas the physical constants and Planck's law are in SI units, requiring $\\lambda$ in meters ($m$). Therefore, a unit conversion from meters (the integration variable) to micrometers must be performed before evaluating the emissivity functions.\n\nThe algorithmic procedure for each test case is as follows:\n$1$. Identify the surface type (desert or ocean), surface temperature $T_s$, and wavelength band $[\\lambda_1, \\lambda_2]$.\n$2$. Define the two integrands for numerical integration: the first for the real surface, $I_{\\epsilon}(\\lambda) = \\epsilon_\\lambda(\\lambda) E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$, and the second for the blackbody, $I_{\\mathrm{bb}}(\\lambda) = E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$. The appropriate emissivity function $\\epsilon_\\lambda(\\lambda)$ is chosen based on the surface type. All calculations involving $\\lambda$ in the Planck function use meters. The emissivity functions must be evaluated with $\\lambda$ converted to micrometers.\n$3$. Numerically integrate $I_{\\epsilon}(\\lambda)$ from $\\lambda_1$ to $\\lambda_2$ to find $F_{\\epsilon}$. The integration limits, given in $\\mu\\mathrm{m}$, must first be converted to meters.\n$4$. Numerically integrate $I_{\\mathrm{bb}}(\\lambda)$ from $\\lambda_1$ to $\\lambda_2$ to find $F_{\\mathrm{bb}}$.\n$5$. Compute the fractional difference $\\delta = (F_{\\epsilon} - F_{\\mathrm{bb}}) / F_{\\mathrm{bb}}$.\n\nThis procedure will be repeated for all $6$ test cases provided in the problem statement. The final output will be a list of the computed $\\delta$ values. Since $\\epsilon_\\lambda(\\lambda) \\le 1$, it is expected that $F_{\\epsilon} \\le F_{\\mathrm{bb}}$, and thus all values of $\\delta$ will be less than or equal to $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Solves for the fractional difference in band-limited thermal flux between\n    a real surface and a blackbody for several test cases.\n    \"\"\"\n\n    # Physical constants from scipy.constants in SI units\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Derived radiation constants for Planck's law for hemispheric exitance\n    c1 = 2 * np.pi * h * c**2  # First radiation constant (W.m^2)\n    c2 = h * c / k              # Second radiation constant (m.K)\n\n    # Emissivity functions are defined with wavelength input in micrometers (um).\n    def epsilon_desert(lam_um: float) -> float:\n        \"\"\"\n        Calculates the spectral emissivity for a desert surface.\n        \n        Args:\n            lam_um: Wavelength in micrometers.\n        \n        Returns:\n            The dimensionless spectral emissivity.\n        \"\"\"\n        term1 = 0.080 * np.exp(-((lam_um - 9.0)**2) / (2 * 0.4**2))\n        term2 = 0.015 * np.exp(-((lam_um - 12.5)**2) / (2 * 0.9**2))\n        val = 0.975 - term1 - term2\n        return np.clip(val, 0.85, 0.99)\n\n    def epsilon_ocean(lam_um: float) -> float:\n        \"\"\"\n        Calculates the spectral emissivity for an ocean surface.\n        \n        Args:\n            lam_um: Wavelength in micrometers.\n        \n        Returns:\n            The dimensionless spectral emissivity.\n        \"\"\"\n        term1 = 0.003 * np.cos(2 * np.pi * (lam_um - 10.0) / 20.0)\n        term2 = 0.002 * np.exp(-((lam_um - 8.0)**2) / (2 * 0.6**2))\n        val = 0.986 - term1 - term2\n        return np.clip(val, 0.97, 0.995)\n\n    # Planck's law for spectral hemispheric exitance E_bλ (W/m^2/m).\n    # The function is defined with wavelength input in meters (m).\n    def planck_exitance(lam_m: float, T: float) -> float:\n        \"\"\"\n        Calculates blackbody spectral hemispheric exitance.\n        \n        Args:\n            lam_m: Wavelength in meters.\n            T: Temperature in Kelvin.\n        \n        Returns:\n            Spectral hemispheric exitance in W/m^3 (i.e., W/m^2 per m).\n        \"\"\"\n        # Avoid division by zero at lambda = 0\n        if lam_m <= 0:\n            return 0.0\n        \n        # Calculate the exponent term in Planck's law\n        exponent = c2 / (lam_m * T)\n        \n        # Avoid overflow for large exponents (exp(>~709) overflows float64)\n        if exponent > 690:\n            return 0.0\n        \n        return c1 / (lam_m**5 * (np.exp(exponent) - 1.0))\n\n    # Define the integrands for use with scipy.integrate.quad.\n    # The integration variable 'lam_m' is in meters.\n    def integrand_emissivity(lam_m: float, T: float, epsilon_func) -> float:\n        \"\"\"Integrand for real surface flux: ε(λ) * E_bλ(λ, T).\"\"\"\n        lam_um = lam_m * 1e6  # Convert wavelength to micrometers for emissivity function\n        epsilon = epsilon_func(lam_um)\n        return epsilon * planck_exitance(lam_m, T)\n\n    def integrand_blackbody(lam_m: float, T: float) -> float:\n        \"\"\"Integrand for blackbody flux: E_bλ(λ, T).\"\"\"\n        return planck_exitance(lam_m, T)\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {'type': 'desert', 'Ts': 320.0, 'band': (8.0, 13.0)},\n        {'type': 'ocean', 'Ts': 295.0, 'band': (8.0, 13.0)},\n        {'type': 'desert', 'Ts': 320.0, 'band': (4.0, 50.0)},\n        {'type': 'ocean', 'Ts': 295.0, 'band': (4.0, 50.0)},\n        {'type': 'ocean', 'Ts': 260.0, 'band': (10.0, 12.0)},\n        {'type': 'desert', 'Ts': 320.0, 'band': (8.8, 9.2)},\n    ]\n    \n    emissivity_map = {\n        'desert': epsilon_desert,\n        'ocean': epsilon_ocean\n    }\n\n    results = []\n    for case in test_cases:\n        surface_type = case['type']\n        Ts = case['Ts']\n        lam1_um, lam2_um = case['band']\n        epsilon_func = emissivity_map[surface_type]\n\n        # Convert wavelength band limits from micrometers to meters for integration\n        lam1_m = lam1_um * 1e-6\n        lam2_m = lam2_um * 1e-6\n\n        # Calculate F_epsilon (flux with spectrally varying emissivity)\n        F_eps, _ = integrate.quad(\n            integrand_emissivity, lam1_m, lam2_m, args=(Ts, epsilon_func)\n        )\n\n        # Calculate F_bb (ideal blackbody flux)\n        F_bb, _ = integrate.quad(\n            integrand_blackbody, lam1_m, lam2_m, args=(Ts,)\n        )\n        \n        # Calculate the fractional difference delta\n        # F_bb for these physical conditions will not be zero\n        delta = (F_eps - F_bb) / F_bb\n        \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    # Using .10f for sufficient precision.\n    print(f\"[{','.join([f'{r:.10f}' for r in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}