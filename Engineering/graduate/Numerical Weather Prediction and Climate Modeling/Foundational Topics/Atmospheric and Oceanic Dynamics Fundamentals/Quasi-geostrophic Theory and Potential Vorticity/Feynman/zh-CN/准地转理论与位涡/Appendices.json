{
    "hands_on_practices": [
        {
            "introduction": "本节练习将从准地转理论的基石——地转平衡和静力平衡出发。通过该练习，您将推导出热成风关系，这是一个关键的诊断工具，它将地转风的垂直切变与水平温度梯度联系起来。这个实践旨在巩固您对大气热力结构如何决定其大尺度流动的理解。",
            "id": "4080212",
            "problem": "考虑一个满足准地转 (QG) 近似的 $f$ 平面上的中纬度流，其科里奥利参数 $f_0$ 为常数。假设大气处于地转平衡和静力平衡状态，并遵循理想气体定律。位温 $\\theta$ 的定义为 $\\theta = T \\left( \\frac{p_0}{p} \\right)^{R/c_p}$，其中 $T$ 是温度，$p$ 是气压，$p_0$ 是一个固定的参考气压，$R$ 是干空气的比气体常数，$c_p$ 是定压比热。水平梯度算子为 $\\nabla_h$，$\\mathbf{k}$ 是垂直单位向量。\n\n从上述基本平衡和定义出发，推导在定压面上联系地转风垂直切变 $\\frac{\\partial \\mathbf{u}_g}{\\partial z}$ 与位温水平梯度 $\\nabla_h \\theta$ 之间的关系。然后，利用这个关系，根据以下给定值估算位温水平梯度的量级 $\\|\\nabla_h \\theta\\|$：\n- $f_0 = 10^{-4}\\,\\mathrm{s^{-1}}$,\n- $\\left\\|\\frac{\\partial \\mathbf{u}_g}{\\partial z}\\right\\| = 1.0 \\times 10^{-2}\\,\\mathrm{s^{-1}}$,\n- $\\theta_0 = 300\\,\\mathrm{K}$,\n- $g = 9.81\\,\\mathrm{m\\,s^{-2}}$,\n\n其中 $\\theta_0$ 是所关心气层的代表性平均位温，在估算量级时可以近似取 $\\theta \\approx \\theta_0$。将 $\\|\\nabla_h \\theta\\|$ 的最终答案以 $\\mathrm{K\\,m^{-1}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导用位温表示的热成风关系，并随后应用该关系来估算水平位温梯度。此推导将基于问题陈述中给出的地转平衡、静力平衡、理想气体定律和位温定义等基本原理。\n\n首先，在一个方便的坐标系中陈述基本方程。由于推导涉及定压面上的梯度，因此最自然的是在气压坐标系 $(x, y, p)$ 中进行。\n\n地转风 $\\mathbf{u}_g$ 由科里奥利力与气压梯度力之间的平衡定义。在气压坐标系中，这个关系用位势 $\\Phi = gz$ 来表示，其中 $g$ 是重力加速度，$z$ 是位势高度：\n$$ f_0 \\mathbf{k} \\times \\mathbf{u}_g = -\\nabla_p \\Phi $$\n这里，$f_0$ 是常数科里奥利参数，$\\mathbf{k}$ 是垂直单位向量，$\\nabla_p$ 是定压面上的水平梯度算子。\n\n静力平衡方程为 $\\frac{\\partial p}{\\partial z} = -\\rho g$，其中 $\\rho$ 是密度。在气压坐标系中，通过将位势的变化与气压的变化联系起来，可以更方便地表达这一点：\n$$ \\frac{\\partial \\Phi}{\\partial p} = \\frac{\\partial(gz)}{\\partial p} = g \\frac{\\partial z}{\\partial p} = g \\left( \\frac{\\partial p}{\\partial z} \\right)^{-1} = g \\left( -\\rho g \\right)^{-1} = -\\frac{1}{\\rho} $$\n\n理想气体定律由 $p = \\rho R T$ 给出，其中 $R$ 是比气体常数，$T$ 是温度。这可以写成 $\\frac{1}{\\rho} = \\frac{RT}{p}$。将其代入静力平衡方程得到：\n$$ \\frac{\\partial \\Phi}{\\partial p} = -\\frac{RT}{p} $$\n\n为了求地转风的垂直切变，我们将地转平衡方程对气压 $p$ 求导：\n$$ \\frac{\\partial}{\\partial p} (f_0 \\mathbf{k} \\times \\mathbf{u}_g) = -\\frac{\\partial}{\\partial p}(\\nabla_p \\Phi) $$\n由于 $f_0$ 是常数且微分算子可交换，这变成：\n$$ f_0 \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial p} = -\\nabla_p \\left( \\frac{\\partial \\Phi}{\\partial p} \\right) $$\n代入 $\\frac{\\partial \\Phi}{\\partial p}$ 的静力关系式：\n$$ f_0 \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial p} = -\\nabla_p \\left( -\\frac{RT}{p} \\right) = \\nabla_p \\left( \\frac{RT}{p} \\right) $$\n在定压面上，$p$ 相对于水平梯度算子 $\\nabla_p$ 是常数，所以：\n$$ f_0 \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial p} = \\frac{R}{p} \\nabla_p T $$\n这是用温度 $T$ 表示的热成风方程。题目要求用位温 $\\theta$ 来表示。\n\n位温 $\\theta$ 定义为 $\\theta = T \\left( \\frac{p_0}{p} \\right)^{\\kappa}$，其中 $\\kappa = R/c_p$。取自然对数得到 $\\ln \\theta = \\ln T - \\kappa \\ln p + \\kappa \\ln p_0$。对此表达式应用 $\\nabla_p$ 算子：\n$$ \\nabla_p(\\ln \\theta) = \\nabla_p(\\ln T) - \\nabla_p(\\kappa \\ln p) + \\nabla_p(\\kappa \\ln p_0) $$\n由于 $p$ 和 $p_0$ 相对于 $\\nabla_p$ 是常数，它们的梯度为零。因此，我们得到一个有用的关系：\n$$ \\frac{1}{\\theta} \\nabla_p \\theta = \\frac{1}{T} \\nabla_p T \\quad \\implies \\quad \\nabla_p T = \\frac{T}{\\theta} \\nabla_p \\theta $$\n将此代入用 $T$ 表示的热成风方程中：\n$$ f_0 \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial p} = \\frac{R}{p} \\left( \\frac{T}{\\theta} \\nabla_p \\theta \\right) = \\frac{RT}{p\\theta} \\nabla_p \\theta $$\n使用理想气体定律 $p = \\rho R T \\implies \\frac{RT}{p} = \\frac{1}{\\rho}$，我们可以简化表达式：\n$$ f_0 \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial p} = \\frac{1}{\\rho \\theta} \\nabla_p \\theta $$\n题目要求的是关于高度 $z$ 的垂直风切变 $\\frac{\\partial \\mathbf{u}_g}{\\partial z}$。我们使用链式法则和静力平衡方程将垂直导数从 $p$ 转换为 $z$：\n$$ \\frac{\\partial \\mathbf{u}_g}{\\partial p} = \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\frac{\\partial z}{\\partial p} = \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\left( -\\frac{1}{\\rho g} \\right) $$\n将此代入我们的方程中：\n$$ f_0 \\mathbf{k} \\times \\left( -\\frac{1}{\\rho g} \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\right) = \\frac{1}{\\rho \\theta} \\nabla_p \\theta $$\n密度 $\\rho$ 从两边消去：\n$$ -\\frac{f_0}{g} \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial z} = \\frac{1}{\\theta} \\nabla_p \\theta $$\n梯度 $\\nabla_p \\theta$ 是定压面上的水平梯度，在题目陈述中记为 $\\nabla_h \\theta$。为了解出 $\\frac{\\partial \\mathbf{u}_g}{\\partial z}$，我们首先乘以 $-\\frac{g}{f_0}$：\n$$ \\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial z} = -\\frac{g}{f_0 \\theta} \\nabla_h \\theta $$\n对两边与 $\\mathbf{k}$ 做叉积，并使用矢量恒等式 $\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{A}) = -\\mathbf{A}$（对于任意水平向量 $\\mathbf{A}$，而 $\\frac{\\partial \\mathbf{u}_g}{\\partial z}$ 正是水平向量）：\n$$ \\mathbf{k} \\times \\left(\\mathbf{k} \\times \\frac{\\partial \\mathbf{u}_g}{\\partial z}\\right) = -\\frac{g}{f_0 \\theta} (\\mathbf{k} \\times \\nabla_h \\theta) $$\n$$ -\\frac{\\partial \\mathbf{u}_g}{\\partial z} = -\\frac{g}{f_0 \\theta} \\mathbf{k} \\times \\nabla_h \\theta $$\n这就得到了最终推导出的关系式，即用位温表示的热成风方程：\n$$ \\frac{\\partial \\mathbf{u}_g}{\\partial z} = \\frac{g}{f_0 \\theta} \\mathbf{k} \\times \\nabla_h \\theta $$\n\n对于问题的第二部分，我们必须估算水平位温梯度的大小 $\\|\\nabla_h \\theta\\|$。我们对推导出的矢量方程两边取模：\n$$ \\left\\| \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\right\\| = \\left\\| \\frac{g}{f_0 \\theta} \\mathbf{k} \\times \\nabla_h \\theta \\right\\| $$\n由于 $g$、$f_0$ 和 $\\theta$ 都是正标量：\n$$ \\left\\| \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\right\\| = \\frac{g}{f_0 \\theta} \\| \\mathbf{k} \\times \\nabla_h \\theta \\| $$\n垂直单位向量 $\\mathbf{k}$ 和水平梯度向量 $\\nabla_h \\theta$ 的叉积的模为 $\\|\\mathbf{k}\\| \\|\\nabla_h \\theta\\| \\sin(\\frac{\\pi}{2}) = \\|\\nabla_h \\theta\\|$，因为它们是正交的。所以，方程变为：\n$$ \\left\\| \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\right\\| = \\frac{g}{f_0 \\theta} \\| \\nabla_h \\theta \\| $$\n题目要求我们使用近似 $\\theta \\approx \\theta_0$。整理方程求解 $\\|\\nabla_h \\theta\\|$：\n$$ \\| \\nabla_h \\theta \\| \\approx \\frac{f_0 \\theta_0}{g} \\left\\| \\frac{\\partial \\mathbf{u}_g}{\\partial z} \\right\\| $$\n代入给定的数值：$f_0 = 10^{-4}\\,\\mathrm{s^{-1}}$，$\\|\\frac{\\partial \\mathbf{u}_g}{\\partial z}\\| = 1.0 \\times 10^{-2}\\,\\mathrm{s^{-1}}$，$\\theta_0 = 300\\,\\mathrm{K}$，以及 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n$$ \\| \\nabla_h \\theta \\| \\approx \\frac{(10^{-4}) (300)}{9.81} (1.0 \\times 10^{-2}) $$\n$$ \\| \\nabla_h \\theta \\| \\approx \\frac{3 \\times 10^{-2}}{9.81} \\times 10^{-2} = \\frac{3}{9.81} \\times 10^{-4} $$\n$$ \\| \\nabla_h \\theta \\| \\approx 0.305810397... \\times 10^{-4} \\approx 3.05810397... \\times 10^{-5} $$\n单位为 $\\frac{(\\mathrm{s^{-1}})(\\mathrm{K})}{(\\mathrm{m\\,s^{-2}})} (\\mathrm{s^{-1}}) = \\mathrm{K\\,m^{-1}}$，符合要求。\n将结果四舍五入到四位有效数字，得到 $3.058 \\times 10^{-5}$。",
            "answer": "$$ \\boxed{3.058 \\times 10^{-5}} $$"
        },
        {
            "introduction": "在诊断关系的基础上，本节练习将转向流动的动力学过程。通过处理流函数 $\\psi$ 并计算相应的相对涡度 $\\zeta$，您将直接接触准地转理论中的关键预报变量。该练习的核心是研究涡度的非线性平流项 $J(\\psi, \\zeta)$，并揭示为何某些特定的流动型（如驻定Rossby波）是完整的非线性方程的精确解。",
            "id": "4080229",
            "problem": "考虑在一个二维（$2$-D）双周期域 $(x,y)$ 中，在 $f$ 平面（科里奥利参数为常数）上的正压准地转（QG）流。令无辐散地转速度由流函数 $\\psi(x,y)$ 通过标准定义 $\\mathbf{u} = (u,v) = \\left(-\\partial_{y}\\psi,\\ \\partial_{x}\\psi\\right)$ 表示。相对涡度定义为 $\\zeta = \\partial_{x}v - \\partial_{y}u$。非线性平流算子是雅可比算子 $J(A,B) = \\partial_{x}A\\,\\partial_{y}B - \\partial_{y}A\\,\\partial_{x}B$。假设一个可分离的正常模态流函数\n$$\n\\psi(x,y) = A \\cos(k x)\\cos(l y),\n$$\n其中 $A$、$k$ 和 $l$ 是实常数，并且该域是周期的，其波数 $k$ 和 $l$ 与域的大小相容。仅以上述定义为基本出发点，完成以下任务：\n- 计算与 $\\psi(x,y)$ 相关的相对涡度场 $\\zeta(x,y)$。\n- 直接根据定义验证该模态的非线性自平流项 $J(\\psi,\\zeta)$ 逐点为零，并结合正压准地转动力学的背景，简要解释其消失的结构性原因。\n\n以 $\\zeta(x,y)$ 的显式闭合形式表达式给出最终答案。无需进行数值计算。最终答案中不要包含单位。",
            "solution": "问题陈述经过严格验证，被认为是科学上可靠、适定、客观且自洽的。所提供的所有定义和关系，如流函数与速度的联系、相对涡度的定义以及雅可比算子，在地球物理流体动力学框架内都是标准且正确的。所选的流函数是 $f$ 平面上的一个经典的单驻定 Rossby 波模态。该问题是应用这些基本定义的一个有效练习。\n\n任务是根据给定的流函数 $\\psi(x,y)$ 计算相对涡度场 $\\zeta(x,y)$，然后验证涡度的非线性平流项 $J(\\psi,\\zeta)$ 逐点为零。\n\n首先，我们计算相对涡度 $\\zeta$。其定义为 $\\zeta = \\partial_{x}v - \\partial_{y}u$。速度分量 $(u,v)$ 由流函数 $\\psi$ 定义为 $u = -\\partial_{y}\\psi$ 和 $v = \\partial_{x}\\psi$。将这些代入 $\\zeta$ 的定义中：\n$$\n\\zeta = \\partial_{x}(\\partial_{x}\\psi) - \\partial_{y}(-\\partial_{y}\\psi) = \\partial_{x}^{2}\\psi + \\partial_{y}^{2}\\psi = \\nabla^{2}\\psi\n$$\n因此，相对涡度是流函数的拉普拉斯算子。给定流函数：\n$$\n\\psi(x,y) = A \\cos(k x)\\cos(l y)\n$$\n我们计算必要的二阶偏导数。一阶偏导数为：\n$$\n\\partial_{x}\\psi = -A k \\sin(k x)\\cos(l y)\n$$\n$$\n\\partial_{y}\\psi = -A l \\cos(k x)\\sin(l y)\n$$\n二阶偏导数为：\n$$\n\\partial_{x}^{2}\\psi = \\partial_{x}(-A k \\sin(k x)\\cos(l y)) = -A k^{2} \\cos(k x)\\cos(l y)\n$$\n$$\n\\partial_{y}^{2}\\psi = \\partial_{y}(-A l \\cos(k x)\\sin(l y)) = -A l^{2} \\cos(k x)\\cos(l y)\n$$\n将这些相加得到相对涡度 $\\zeta$：\n$$\n\\zeta(x,y) = \\partial_{x}^{2}\\psi + \\partial_{y}^{2}\\psi = -A k^{2} \\cos(k x)\\cos(l y) - A l^{2} \\cos(k x)\\cos(l y)\n$$\n提取公因式，我们得到相对涡度场的表达式：\n$$\n\\zeta(x,y) = -A(k^{2} + l^{2})\\cos(k x)\\cos(l y)\n$$\n\n接下来，我们验证非线性自平流项 $J(\\psi,\\zeta)$ 为零。雅可比算子定义为 $J(\\psi,\\zeta) = (\\partial_{x}\\psi)(\\partial_{y}\\zeta) - (\\partial_{y}\\psi)(\\partial_{x}\\zeta)$。我们需要 $\\zeta$ 的一阶偏导数：\n$$\n\\partial_{x}\\zeta = \\partial_{x}(-A(k^{2} + l^{2})\\cos(k x)\\cos(l y)) = A k (k^{2} + l^{2}) \\sin(k x)\\cos(l y)\n$$\n$$\n\\partial_{y}\\zeta = \\partial_{y}(-A(k^{2} + l^{2})\\cos(k x)\\cos(l y)) = A l (k^{2} + l^{2}) \\cos(k x)\\sin(l y)\n$$\n现在，我们将这四个偏导数代入雅可比表达式中：\n$$\nJ(\\psi,\\zeta) = \\underbrace{\\left(-A k \\sin(k x)\\cos(l y)\\right)}_{\\partial_{x}\\psi} \\underbrace{\\left(A l (k^{2} + l^{2}) \\cos(k x)\\sin(l y)\\right)}_{\\partial_{y}\\zeta} - \\underbrace{\\left(-A l \\cos(k x)\\sin(l y)\\right)}_{\\partial_{y}\\psi} \\underbrace{\\left(A k (k^{2} + l^{2}) \\sin(k x)\\cos(l y)\\right)}_{\\partial_{x}\\zeta}\n$$\n让我们简化每一项。\n第一项是：\n$$\n-A^{2} k l (k^{2} + l^{2}) \\sin(k x)\\cos(k x)\\cos(l y)\\sin(l y)\n$$\n第二项是：\n$$\n- \\left( -A^{2} k l (k^{2} + l^{2}) \\sin(k x)\\cos(k x)\\cos(l y)\\sin(l y) \\right) = +A^{2} k l (k^{2} + l^{2}) \\sin(k x)\\cos(k x)\\cos(l y)\\sin(l y)\n$$\n将两项相加：\n$$\nJ(\\psi,\\zeta) = -A^{2} k l (k^{2} + l^{2}) \\sin(k x)\\cos(k x)\\sin(l y)\\cos(l y) + A^{2} k l (k^{2} + l^{2}) \\sin(k x)\\cos(k x)\\sin(l y)\\cos(l y) = 0\n$$\n验证完成。非线性自平流项 $J(\\psi,\\zeta)$ 对所有 $(x,y)$ 恒为零。\n\n这种消失的结构性原因是场 $\\zeta$ 与场 $\\psi$ 是函数相关的。具体来说，$\\zeta$ 与 $\\psi$ 成正比。从我们对 $\\zeta$ 的计算中可以看出：\n$$\n\\zeta(x,y) = -(k^{2} + l^{2}) \\left( A \\cos(k x)\\cos(l y) \\right) = -(k^{2} + l^{2})\\psi(x,y)\n$$\n令 $C = -(k^{2} + l^{2})$ 为一个常数。则 $\\zeta = C\\psi$。两个函数相关场 $J(A, F(A))$ 的雅可比算子恒为零：\n$$\nJ(A, F(A)) = (\\partial_{x}A)(\\partial_{y}F(A)) - (\\partial_{y}A)(\\partial_{x}F(A))\n$$\n使用链式法则，$\\partial_{x}F(A) = F'(A)\\partial_{x}A$ 且 $\\partial_{y}F(A) = F'(A)\\partial_{y}A$。代入可得：\n$$\nJ(A, F(A)) = (\\partial_{x}A)(F'(A)\\partial_{y}A) - (\\partial_{y}A)(F'(A)\\partial_{x}A) = F'(A) \\left( (\\partial_{x}A)(\\partial_{y}A) - (\\partial_{y}A)(\\partial_{x}A) \\right) = 0\n$$\n在我们的例子中，$A = \\psi$ 且 $F(\\psi) = C\\psi$，所以 $J(\\psi, C\\psi) = 0$。\n\n物理上，项 $J(\\psi,\\zeta)$ 代表地转速度场 $\\mathbf{u}$ 对相对涡度 $\\zeta$ 的平流，因为 $J(\\psi,\\zeta) = \\mathbf{u} \\cdot \\nabla\\zeta$。流函数 $\\psi$ 的等值线是流线，流线处处与速度矢量 $\\mathbf{u}$ 平行。条件 $\\zeta = C\\psi$ 意味着等涡度线与流函数的等值线相同。因此，流动处处与等涡度线平行。平流只能通过将一个场输运过其自身的等值线来改变其值。由于流动与 $\\zeta$ 的等值线平行，它不能平流涡度，因此平流项为零。在 $f$ 平面上的正压涡度方程 $\\frac{\\partial\\zeta}{\\partial t} + J(\\psi,\\zeta) = 0$（对于无强迫、无粘性流）的背景下，因为 $J(\\psi,\\zeta)=0$，所以 $\\frac{\\partial\\zeta}{\\partial t}=0$。这意味着流场是静止的。给定的正常模态是该非线性运动方程的一个精确稳态解。",
            "answer": "$$\n\\boxed{-A(k^{2} + l^{2})\\cos(k x)\\cos(l y)}\n$$"
        },
        {
            "introduction": "位涡（PV）可逆性是现代动力气象学的核心思想。最后的这个练习将理论与应用联系起来，要求您编写代码来数值求解位涡反演方程，即从给定的位涡 $q$ 场反演流函数 $\\psi$ 场。通过实现谱方法和有限差分法这两种方法，您将亲身体验数值天气预报和气候模型中，如何从给定的位涡分布推断出整个流场。",
            "id": "4080242",
            "problem": "考虑一个中纬度 beta 平面上的单层正压准地转 (QG) 模型及其相关的位涡 (PV) 反演问题。令地转速度由流函数 $\\psi(x,y)$ 通过 $u_g(x,y) = -\\partial \\psi / \\partial y$ 和 $v_g(x,y) = \\partial \\psi / \\partial x$ 定义。相对涡度定义为 $\\zeta(x,y) = \\partial v_g / \\partial x - \\partial u_g / \\partial y$。准地转位涡异常通过相对涡度和一个由正压变形半径 $L_D$ (单位：米) 参数化的斜压贡献的组合与流场相关。从这些基本定义出发，结合静力平衡和质量守恒，推导连接给定 PV 异常场 $q(x,y)$ 与流函数 $\\psi(x,y)$ 的线性椭圆 PV 反演关系。\n\n然后，为此 PV 反演关系实现两种数值反演方法：\n\n1. 在双周期域上使用快速傅里叶变换 (FFT) 的谱反演，在 $x$ 和 $y$ 方向上均采用周期性边界条件，并使用适合长度为 $L_x$ 和 $L_y$ (单位：米) 计算域的傅里叶波数。\n2. 在有界矩形域上使用有限差分反演，在所有边界上采用齐次 Dirichlet 边界条件 $\\psi=0$，并在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上使用标准的五点差分格式对拉普拉斯算子进行离散化。\n\n对于下面的所有测试，您必须构建单位为 $\\mathrm{m^2/s}$ 的解析“真值”场 $\\psi_{\\text{true}}(x,y)$，使用推导出的反演关系计算单位为 $\\mathrm{s^{-1}}$ 的相应 PV 异常 $q(x,y)$，执行数值反演以获得 $\\psi_{\\text{num}}(x,y)$，并报告单位为 $\\mathrm{m^2/s}$ 的均方根误差 (RMSE) $E = \\sqrt{\\langle(\\psi_{\\text{num}} - \\psi_{\\text{true}})^2\\rangle}$，其中 $\\langle \\cdot \\rangle$ 表示对所有网格点的算术平均。对于周期域上的谱反演，请使用与计算域长度一致的傅里叶表示，并确保对零波数模式的处理在物理上是一致的。对于有界域上的有限差分反演，请使用科学上合适的数值线性代数方法，为齐次 Dirichlet 边界条件下的内部点组装并求解离散线性系统。\n\n您的程序必须在没有用户输入的情况下执行以下测试套件，并产生指定的输出：\n\n测试用例 $\\mathrm{T1}$ (谱方法，周期性 Helmholtz):\n- 计算域: $L_x = 10^6$ $\\mathrm{m}$, $L_y = 10^6$ $\\mathrm{m}$.\n- 网格: $N_x = 128$, $N_y = 128$ 个均匀分布的点。\n- 变形半径: $L_D = 2 \\times 10^5$ $\\mathrm{m}$.\n- 真值场: $\\psi_{\\text{true}}(x,y) = A \\cos\\left( 2\\pi n x / L_x \\right) \\cos\\left( 2\\pi m y / L_y \\right)$，其中 $A = 10^5$ $\\mathrm{m^2/s}$, $n = 3$, $m = 5$。\n- 根据推导的 PV 反演关系解析计算 $q(x,y)$，并进行谱反演以获得 $\\psi_{\\text{num}}$。报告以 $\\mathrm{m^2/s}$ 为单位的 RMSE $E_1$。\n\n测试用例 $\\mathrm{T2}$ (谱方法，周期性 Poisson 极限):\n- 计算域: $L_x = 10^6$ $\\mathrm{m}$, $L_y = 10^6$ $\\mathrm{m}$.\n- 网格: $N_x = 64$, $N_y = 64$ 个均匀分布的点。\n- 变形半径: $L_D \\rightarrow \\infty$ (即平方反比项可忽略不计)。\n- 真值场: $\\psi_{\\text{true}}(x,y) = A \\cos\\left( 2\\pi n x / L_x \\right) \\cos\\left( 2\\pi m y / L_y \\right)$，其中 $A = 2 \\times 10^5$ $\\mathrm{m^2/s}$, $n = 1$, $m = 2$。\n- 在 Poisson 极限下解析计算 $q(x,y)$，并进行谱反演以获得 $\\psi_{\\text{num}}$。报告以 $\\mathrm{m^2/s}$ 为单位的 RMSE $E_2$。\n\n测试用例 $\\mathrm{T3}$ (有限差分，有界 Helmholtz):\n- 计算域: $L_x = 10^6$ $\\mathrm{m}$, $L_y = 10^6$ $\\mathrm{m}$.\n- 网格: $N_x = 65$, $N_y = 65$ 个均匀分布的点 (包括边界)。\n- 变形半径: $L_D = 2 \\times 10^5$ $\\mathrm{m}$.\n- 边界条件: 所有边界上为齐次 Dirichlet 条件 $\\psi=0$。\n- 真值场: $\\psi_{\\text{true}}(x,y) = A \\sin\\left( \\pi x / L_x \\right) \\sin\\left( \\pi y / L_y \\right)$，其中 $A = 10^5$ $\\mathrm{m^2/s}$。\n- 根据推导的 PV 反演关系解析计算 $q(x,y)$，并使用五点差分格式进行反演以获得 $\\psi_{\\text{num}}$。报告以 $\\mathrm{m^2/s}$ 为单位的 RMSE $E_3$。\n\n测试用例 $\\mathrm{T4}$ (有限差分，有界 Poisson 极限):\n- 计算域: $L_x = 10^6$ $\\mathrm{m}$, $L_y = 10^6$ $\\mathrm{m}$.\n- 网格: $N_x = 65$, $N_y = 65$ 个均匀分布的点 (包括边界)。\n- 变形半径: $L_D \\rightarrow \\infty$ (即平方反比项可忽略不计)。\n- 边界条件: 所有边界上为齐次 Dirichlet 条件 $\\psi=0$。\n- 真值场: $\\psi_{\\text{true}}(x,y) = A \\sin\\left( \\pi x / L_x \\right) \\sin\\left( \\pi y / L_y \\right)$，其中 $A = 10^5$ $\\mathrm{m^2/s}$。\n- 在 Poisson 极限下解析计算 $q(x,y)$，并使用五点差分格式进行反演以获得 $\\psi_{\\text{num}}$。报告以 $\\mathrm{m^2/s}$ 为单位的 RMSE $E_4$。\n\n测试用例 $\\mathrm{T5}$ (在与两种边界类型兼容的函数上对周期性和有界 Helmholtz 问题进行比较):\n- 计算域: $L_x = 10^6$ $\\mathrm{m}$, $L_y = 10^6$ $\\mathrm{m}$.\n- 谱方法网格: $N_x^{(s)} = 128$, $N_y^{(s)} = 128$ 个均匀分布的点，周期性。\n- 有限差分网格: $N_x^{(f)} = 129$, $N_y^{(f)} = 129$ 个均匀分布的点 (包括边界)，有界且满足齐次 Dirichlet 条件。\n- 变形半径: $L_D = 3 \\times 10^5$ $\\mathrm{m}$.\n- 真值场: $\\psi_{\\text{true}}(x,y) = A \\sin\\left( 2\\pi x / L_x \\right) \\sin\\left( 2\\pi y / L_y \\right)$，其中 $A = 10^5$ $\\mathrm{m^2/s}$。\n- 解析计算 $q(x,y)$，在各自的网格上用两种方法进行反演，比较 RMSE 值 $E_s$ (谱方法) 和 $E_f$ (有限差分)，并报告比率 $R = E_s / E_f$ (一个无量纲浮点数)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序为 $[E_1, E_2, E_3, E_4, R]$，所有条目均为十进制浮点数。所有 RMSE 值必须以 $\\mathrm{m^2/s}$ 表示，比率 $R$ 必须是无量纲的。三角函数内的角度以弧度为单位。不应打印任何其他文本。",
            "solution": "该问题要求推导准地转位涡 (PV) 反演关系，并实现两种数值方法来求解该关系，最后通过一套测试用例进行验证。\n\n### 第一部分：PV 反演关系的推导\n\n问题将地转速度分量 $(u_g, v_g)$ 定义为流函数 $\\psi(x,y)$ 的函数：\n$$u_g(x,y) = -\\frac{\\partial \\psi}{\\partial y}$$\n$$v_g(x,y) = \\frac{\\partial \\psi}{\\partial x}$$\n相对涡度 $\\zeta$ 是速度场旋度的垂直分量：\n$$\\zeta(x,y) = \\frac{\\partial v_g}{\\partial x} - \\frac{\\partial u_g}{\\partial y}$$\n代入 $u_g$ 和 $v_g$ 的定义，得到相对涡度与流函数之间的直接关系：\n$$\\zeta = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial \\psi}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial \\psi}{\\partial y}\\right) = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = \\nabla^2 \\psi$$\n其中 $\\nabla^2$ 是水平拉普拉斯算子。\n\n对于单层（或折合重力，正压）模型，准地转位涡 (QG PV) 异常 $q$ 定义为相对涡度异常与涡旋伸缩项之和。该伸缩项与流体表面相对于其平均高度的偏差成正比，在地转和静力近似下，该偏差又与流函数 $\\psi$ 成正比。此关系由正压 Rossby 变形半径 $L_D$ 参数化。标准定义为：\n$$q(x,y) = \\zeta(x,y) - \\frac{1}{L_D^2} \\psi(x,y)$$\n结合这两个表达式，我们将 $\\zeta = \\nabla^2 \\psi$ 代入 $q$ 的定义中：\n$$q(x,y) = \\nabla^2 \\psi(x,y) - \\frac{1}{L_D^2} \\psi(x,y)$$\n这是一个连接 PV 异常场 $q$ 与流函数 $\\psi$ 的线性椭圆偏微分方程。它是一个 Helmholtz 方程。对于给定的 $q$ 寻找 $\\psi$ 的过程称为 PV 反演。\n\n在变形半径非常大（$L_D \\rightarrow \\infty$）的极限情况下，伸缩项消失。该极限对应于纯二维的无辐散流。方程简化为 Poisson 方程：\n$$q(x,y) = \\nabla^2 \\psi(x,y) \\quad (\\text{for } L_D \\rightarrow \\infty)$$\n\n### 第二部分：数值反演方法\n\n推导出的 PV 反演关系根据边界条件，采用两种不同的数值方法求解。\n\n#### 方法一：双周期域上的谱反演\n\n对于在 $x$ 和 $y$ 方向上均具有周期性且长度分别为 $L_x$ 和 $L_y$ 的区域，傅里叶方法非常高效和准确。我们用离散傅里叶级数来表示场 $\\psi(x,y)$ 和 $q(x,y)$：\n$$\\psi(x_j, y_k) = \\sum_{m,n} \\hat{\\psi}_{m,n} e^{i(k_m x_j + k_n y_k)}$$\n$$q(x_j, y_k) = \\sum_{m,n} \\hat{q}_{m,n} e^{i(k_m x_j + k_n y_k)}$$\n其中 $k_m = 2\\pi m / L_x$ 和 $k_n = 2\\pi n / L_y$ 是离散波数。傅里叶级数的关键特性是微分在谱空间中变为乘法。具体来说，拉普拉斯算子 $\\nabla^2$ 变换为乘以 $-(k_m^2 + k_n^2)$。\n\n对 PV 反演方程进行傅里叶变换得到：\n$$\\hat{q}_{m,n} = -(k_m^2 + k_n^2) \\hat{\\psi}_{m,n} - \\frac{1}{L_D^2} \\hat{\\psi}_{m,n} = -\\left(k_m^2 + k_n^2 + \\frac{1}{L_D^2}\\right) \\hat{\\psi}_{m,n}$$\n我们可以解出流函数的谱系数 $\\hat{\\psi}_{m,n}$：\n$$\\hat{\\psi}_{m,n} = -\\frac{\\hat{q}_{m,n}}{k_m^2 + k_n^2 + 1/L_D^2}$$\n对于零波数模式 ($m=0, n=0$)，物理流函数是任意的（它对应于一个不产生流动的空间恒定压力场）。我们可以设置 $\\hat{\\psi}_{0,0} = 0$。这要求对于 Poisson 情况（$L_D \\rightarrow \\infty$），区域平均的 PV 异常也必须为零，即 $\\hat{q}_{0,0}=0$，才能有解。所提供的带有周期函数的测试用例均值为零，满足此条件。\n\n数值算法如下：\n1.  对网格化的 PV 异常场 $q$ 进行二维快速傅里叶变换 (FFT) 以获得 $\\hat{q}$。\n2.  在波数网格 $(k_m, k_n)$ 上，使用上述代数关系计算谱系数 $\\hat{\\psi}$。通过设置 $\\hat{\\psi}_{0,0}=0$ 来避免在 Poisson 情况下对 $(0,0)$ 波数的除零错误。\n3.  对 $\\hat{\\psi}$ 进行二维傅里叶逆变换以恢复网格化的流函数场 $\\psi_{\\text{num}}$。\n\n#### 方法二：有界域上的有限差分反演\n\n对于具有指定边界条件的矩形域 $[0, L_x] \\times [0, L_y]$，我们使用有限差分法。该区域被离散化为一个包含 $N_x \\times N_y$ 个点的均匀网格，网格间距为 $\\Delta x = L_x / (N_x-1)$ 和 $\\Delta y = L_y / (N_y-1)$。令 $\\psi_{i,j}$ 表示在网格点 $(x_i, y_j)$ 处的 $\\psi$ 值。\n\n拉普拉斯算子使用二阶精度的五点差分格式进行近似：\n$$\\nabla^2\\psi \\bigg|_{(i,j)} \\approx \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{(\\Delta x)^2} + \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{(\\Delta y)^2}$$\n将此近似代入每个内部网格点（$1 \\le i \\le N_x-2$, $1 \\le j \\le N_y-2$）的 PV 反演方程，得到一个线性代数方程组：\n$$\\frac{\\psi_{i+1,j} + \\psi_{i-1,j}}{(\\Delta x)^2} + \\frac{\\psi_{i,j+1} + \\psi_{i,j-1}}{(\\Delta y)^2} - \\left(\\frac{2}{(\\Delta x)^2} + \\frac{2}{(\\Delta y)^2} + \\frac{1}{L_D^2}\\right)\\psi_{i,j} = q_{i,j}$$\n问题指定了齐次 Dirichlet 边界条件，即在所有边界上 $\\psi=0$。这意味着如果 $i=0, i=N_x-1, j=0,$ 或 $j=N_y-1$，则 $\\psi_{i,j}=0$。这些已知值被并入与边界相邻的内部点的方程中。\n\n这个包含 $(N_x-2) \\times (N_y-2)$ 个方程的系统可以写成矩阵形式 $A\\mathbf{x} = \\mathbf{b}$，其中：\n- $\\mathbf{x}$ 是未知内部值 $\\psi_{i,j}$ 的向量，展平成一个长度为 $(N_x-2)(N_y-2)$ 的一维数组。\n- $\\mathbf{b}$ 是已知内部值 $q_{i,j}$ 的向量，同样被展平。\n- $A$ 是一个表示离散化 Helmholtz 算子的大型稀疏块三对角矩阵。\n\n数值算法是：\n1.  为内部网格点构建表示有限差分算子的稀疏矩阵 $A$。\n2.  从 $q$ 场的内部值构建右侧向量 $\\mathbf{b}$。\n3.  使用高效的稀疏线性代数求解器求解线性系统 $A\\mathbf{x} = \\mathbf{b}$ 以得到 $\\mathbf{x}$。\n4.  将解向量 $\\mathbf{x}$ 重新塑形为内部 $\\psi$ 值的二维数组，并将其嵌入到一个带有零值边界的更大网格中，以形成完整的场 $\\psi_{\\text{num}}$。\n\n### 第三部分：验证与测试用例\n\n数值求解器使用制造解方法进行验证。对于每个测试用例，定义一个解析的“真值”场 $\\psi_{\\text{true}}$。通过应用连续算子 $q = (\\nabla^2 - 1/L_D^2)\\psi$ 来解析计算相应的 PV 异常场 $q_{\\text{true}}$。然后将这个 $q_{\\text{true}}$ 场用作数值反演器的输入以产生 $\\psi_{\\text{num}}$。数值方法的精度通过均方根误差 (RMSE) $E = \\sqrt{\\langle(\\psi_{\\text{num}} - \\psi_{\\text{true}})^2\\rangle}$ 来量化，其中平均值 $\\langle\\cdot\\rangle$ 是对所有网格点计算的。此过程分离出了反演过程本身的数值误差。所选的 $\\psi_{\\text{true}}$ 函数是相应算子和边界条件的本征函数，提供了理想的测试场景。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to execute all test cases for the QG PV inversion problem.\n    \"\"\"\n\n    def solve_spectral(q, Lx, Ly, LD):\n        \"\"\"\n        Solves the Helmholtz/Poisson equation on a doubly periodic domain\n        using the FFT-based spectral method.\n        \n        q = grad^2(psi) - (1/LD^2)*psi\n        \n        Args:\n            q (np.ndarray): 2D array of potential vorticity anomaly.\n            Lx (float): Domain size in x-direction.\n            Ly (float): Domain size in y-direction.\n            LD (float): Deformation radius. Use np.inf for the Poisson limit.\n            \n        Returns:\n            np.ndarray: 2D array of the solved streamfunction.\n        \"\"\"\n        Ny, Nx = q.shape\n        \n        # Wavenumbers\n        kx = 2 * np.pi * np.fft.fftfreq(Nx, d=Lx / Nx)\n        ky = 2 * np.pi * np.fft.fftfreq(Ny, d=Ly / Ny)\n        Kx, Ky = np.meshgrid(kx, ky, indexing='ij')\n        \n        K2 = Kx**2 + Ky**2\n        \n        # Fourier transform of PV\n        q_hat = np.fft.fft2(q)\n        \n        # Construct the denominator of the spectral operator\n        if np.isinf(LD):\n            denom = -K2\n        else:\n            denom = -(K2 + 1 / LD**2)\n        \n        # Solve for streamfunction in spectral space\n        psi_hat = np.zeros_like(q_hat, dtype=complex)\n        \n        # Avoid division by zero for the k=0 mode\n        # The mean streamfunction is arbitrary and set to 0.\n        non_zero_denom = denom != 0\n        psi_hat[non_zero_denom] = q_hat[non_zero_denom] / denom[non_zero_denom]\n        \n        # Inverse transform to get streamfunction in physical space\n        psi_num = np.fft.ifft2(psi_hat)\n        \n        return np.real(psi_num)\n\n    def solve_fd(q, Lx, Ly, LD):\n        \"\"\"\n        Solves the Helmholtz/Poisson equation on a bounded domain with\n        homogeneous Dirichlet boundary conditions using a 5-point\n        finite-difference stencil.\n\n        Args:\n            q (np.ndarray): 2D array of potential vorticity anomaly.\n            Lx (float): Domain size in x-direction.\n            Ly (float): Domain size in y-direction.\n            LD (float): Deformation radius. Use np.inf for the Poisson limit.\n\n        Returns:\n            np.ndarray: 2D array of the solved streamfunction.\n        \"\"\"\n        Ny, Nx = q.shape\n        dx = Lx / (Nx - 1)\n        dy = Ly / (Ny - 1)\n\n        # Number of interior points\n        Nx_int, Ny_int = Nx - 2, Ny - 2\n        N_int = Nx_int * Ny_int\n        \n        # Get the interior q values and flatten\n        q_interior = q[1:-1, 1:-1]\n        b = q_interior.flatten()\n        \n        # Construct the sparse matrix A for the linear system A*psi = b\n        # Main diagonal\n        if np.isinf(LD):\n            main_diag = -2 / dx**2 - 2 / dy**2\n        else:\n            main_diag = -2 / dx**2 - 2 / dy**2 - 1 / LD**2\n        \n        diagonals = [np.full(N_int, 1 / dy**2), \n                     np.full(N_int, 1 / dx**2), \n                     np.full(N_int, main_diag),\n                     np.full(N_int, 1 / dx**2),\n                     np.full(N_int, 1 / dy**2)]\n        \n        offsets = [-Nx_int, -1, 0, 1, Nx_int]\n        \n        A = sparse.diags(diagonals, offsets, shape=(N_int, N_int), format='csr')\n\n        # The term from dx^2 can wrap around blocks, so we need to zero it out\n        # for points at the right edge of each row in the flattened grid.\n        for i in range(1, Ny_int):\n            A[i * Nx_int - 1, i * Nx_int] = 0\n            A[i * Nx_int, i * Nx_int - 1] = 0\n\n        # Solve the sparse linear system\n        psi_flat = spsolve(A, b)\n        \n        # Reshape solution and place into a grid with zero boundaries\n        psi_num = np.zeros((Ny, Nx))\n        psi_num[1:-1, 1:-1] = psi_flat.reshape((Ny_int, Nx_int))\n        \n        return psi_num\n\n    def compute_rmse(psi_num, psi_true):\n        \"\"\"Calculates the Root-Mean-Square-Error.\"\"\"\n        return np.sqrt(np.mean((psi_num - psi_true)**2))\n\n    results = []\n\n    # Test Case T1: Spectral, periodic Helmholtz\n    Lx1, Ly1 = 1e6, 1e6\n    Nx1, Ny1 = 128, 128\n    LD1 = 2e5\n    A1, n1, m1 = 1e5, 3, 5\n    x1 = np.linspace(0, Lx1, Nx1, endpoint=False)\n    y1 = np.linspace(0, Ly1, Ny1, endpoint=False)\n    X1, Y1 = np.meshgrid(x1, y1, indexing='ij')\n    kx1, ky1 = 2 * np.pi * n1 / Lx1, 2 * np.pi * m1 / Ly1\n    psi_true1 = A1 * np.cos(kx1 * X1) * np.cos(ky1 * Y1)\n    q_true1 = -(kx1**2 + ky1**2 + 1/LD1**2) * psi_true1\n    psi_num1 = solve_spectral(q_true1, Lx1, Ly1, LD1)\n    E1 = compute_rmse(psi_num1, psi_true1)\n    results.append(E1)\n\n    # Test Case T2: Spectral, periodic Poisson limit\n    Lx2, Ly2 = 1e6, 1e6\n    Nx2, Ny2 = 64, 64\n    LD2 = np.inf\n    A2, n2, m2 = 2e5, 1, 2\n    x2 = np.linspace(0, Lx2, Nx2, endpoint=False)\n    y2 = np.linspace(0, Ly2, Ny2, endpoint=False)\n    X2, Y2 = np.meshgrid(x2, y2, indexing='ij')\n    kx2, ky2 = 2 * np.pi * n2 / Lx2, 2 * np.pi * m2 / Ly2\n    psi_true2 = A2 * np.cos(kx2 * X2) * np.cos(ky2 * Y2)\n    q_true2 = -(kx2**2 + ky2**2) * psi_true2\n    psi_num2 = solve_spectral(q_true2, Lx2, Ly2, LD2)\n    E2 = compute_rmse(psi_num2, psi_true2)\n    results.append(E2)\n\n    # Test Case T3: Finite difference, bounded Helmholtz\n    Lx3, Ly3 = 1e6, 1e6\n    Nx3, Ny3 = 65, 65\n    LD3 = 2e5\n    A3 = 1e5\n    x3 = np.linspace(0, Lx3, Nx3)\n    y3 = np.linspace(0, Ly3, Ny3)\n    X3, Y3 = np.meshgrid(x3, y3, indexing='ij')\n    kx3, ky3 = np.pi / Lx3, np.pi / Ly3\n    psi_true3 = A3 * np.sin(kx3 * X3) * np.sin(ky3 * Y3)\n    q_true3 = -(kx3**2 + ky3**2 + 1/LD3**2) * psi_true3\n    psi_num3 = solve_fd(q_true3, Lx3, Ly3, LD3)\n    E3 = compute_rmse(psi_num3, psi_true3)\n    results.append(E3)\n\n    # Test Case T4: Finite difference, bounded Poisson limit\n    Lx4, Ly4 = 1e6, 1e6\n    Nx4, Ny4 = 65, 65\n    LD4 = np.inf\n    A4 = 1e5\n    x4 = np.linspace(0, Lx4, Nx4)\n    y4 = np.linspace(0, Ly4, Ny4)\n    X4, Y4 = np.meshgrid(x4, y4, indexing='ij')\n    kx4, ky4 = np.pi / Lx4, np.pi / Ly4\n    psi_true4 = A4 * np.sin(kx4 * X4) * np.sin(ky4 * Y4)\n    q_true4 = -(kx4**2 + ky4**2) * psi_true4\n    psi_num4 = solve_fd(q_true4, Lx4, Ly4, LD4)\n    E4 = compute_rmse(psi_num4, psi_true4)\n    results.append(E4)\n\n    # Test Case T5: Comparative periodic-and-bounded Helmholtz\n    Lx5, Ly5 = 1e6, 1e6\n    LD5 = 3e5\n    A5 = 1e5\n    kx5, ky5 = 2 * np.pi / Lx5, 2 * np.pi / Ly5\n    \n    # Spectral part\n    Nxs, Nys = 128, 128\n    xs = np.linspace(0, Lx5, Nxs, endpoint=False)\n    ys = np.linspace(0, Ly5, Nys, endpoint=False)\n    Xs, Ys = np.meshgrid(xs, ys, indexing='ij')\n    psi_true_s = A5 * np.sin(kx5 * Xs) * np.sin(ky5 * Ys)\n    q_true_s = -(kx5**2 + ky5**2 + 1/LD5**2) * psi_true_s\n    psi_num_s = solve_spectral(q_true_s, Lx5, Ly5, LD5)\n    Es = compute_rmse(psi_num_s, psi_true_s)\n\n    # Finite-difference part\n    Nxf, Nyf = 129, 129\n    xf = np.linspace(0, Lx5, Nxf)\n    yf = np.linspace(0, Ly5, Nyf)\n    Xf, Yf = np.meshgrid(xf, yf, indexing='ij')\n    psi_true_f = A5 * np.sin(kx5 * Xf) * np.sin(ky5 * Yf)\n    q_true_f = -(kx5**2 + ky5**2 + 1/LD5**2) * psi_true_f\n    psi_num_f = solve_fd(q_true_f, Lx5, Ly5, LD5)\n    Ef = compute_rmse(psi_num_f, psi_true_f)\n    \n    # The ratio R. Handle potential division by zero if Ef is also zero.\n    R = Es / Ef if Ef != 0 else 0.0\n    results.append(R)\n\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}