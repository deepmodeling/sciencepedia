{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的动力学方程之前，物理学家和气象学家常常使用量级分析来快速估算物理量的大小。这个练习 () 将带你运用量级分析的方法，从基本的地转平衡关系出发，估算中纬度天气系统中的地转风速。通过这种“信封背面”式的计算，你将对大气运动的典型尺度建立起直观的认识。",
            "id": "3883006",
            "problem": "在 $500\\,\\mathrm{hPa}$ 等压面上观测到一股中纬度天气尺度气流。在经向方向上，水平距离 $L = 500\\,\\mathrm{km}$ 内，位势高度减少了 $\\Delta Z = 50\\,\\mathrm{m}$。科里奥利参数为 $f = 10^{-4}\\,\\mathrm{s^{-1}}$。假设流动处于静力平衡状态，摩擦可忽略不计，且为稳定的大尺度运动，使得主导的水平动量平衡是科里奥利加速度与气压梯度力之间的平衡。仅使用这些基本平衡和量纲分析，推导出特征水平风速大小 $U$ 的一个尺度，并利用所给数据估算其数值。最终答案以 $\\mathrm{m\\,s^{-1}}$ 为单位，并四舍五入到两位有效数字。您的最终答案必须是一个数字。",
            "solution": "该问题要求通过考虑基本力平衡和使用量纲分析，推导中纬度天气尺度气流的特征水平风速尺度 $U$。我们已知以下信息：\n1. 气流位于 $500\\,\\mathrm{hPa}$ 等压面上。\n2. 运动是稳定的、大尺度的，且摩擦可以忽略不计。\n3. 主导的水平动量平衡是科里奥利加速度和气压梯度力之间的平衡。这组假设定义了地转平衡。\n4. 在经向水平距离 $L = 500\\,\\mathrm{km}$ 上，位势高度 $Z$ 减小了 $\\Delta Z = 50\\,\\mathrm{m}$。\n5. 科里奥利参数为 $f = 10^{-4}\\,\\mathrm{s^{-1}}$。\n6. 气流处于静力平衡状态，这在使用等压面上的位势高度来表示气压梯度时已隐含。\n\n对于旋转行星上的稳定无摩擦流动，其水平动量方程即为地转平衡方程。在恒定气压（等压）面上，单位质量的气压梯度力 (PGF) 用位势 $\\Phi = gZ$ 的梯度来表示，其中 $g$ 是重力加速度，$Z$ 是位势高度。单位质量的 PGF 为 $-\\nabla_p \\Phi = -g \\nabla_p Z$，其中 $\\nabla_p$ 是等压面上的水平梯度算子。\n\n地转平衡方程为：\n$$ -f v_g = -g \\frac{\\partial Z}{\\partial x} $$\n$$ f u_g = -g \\frac{\\partial Z}{\\partial y} $$\n其中 $u_g$ 和 $v_g$ 分别是地转风矢量 $\\vec{v}_g$ 的纬向（东西向）和经向（南北向）分量。\n\n问题要求解的是水平风速大小的特征尺度，我们将其记为 $U$。我们可以通过对地转平衡方程进行尺度分析来得到这个尺度。让我们考虑第二个方程 $f u_g = -g \\frac{\\partial Z}{\\partial y}$ 中各项的尺度。\n\n风速 $u_g$ 的特征尺度是 $U$。\n科里奥利参数 $f$ 本身就是一个尺度。\n因此，科里奥利项 $f u_g$ 的特征尺度是 $fU$。\n\n水平导数 $\\frac{\\partial Z}{\\partial y}$ 的特征尺度由水平长度尺度 $L$ 上的位势高度变化 $\\Delta Z$ 给出。因此，位势高度梯度的尺度是 $\\frac{\\Delta Z}{L}$。\n项 $g$ 是重力加速度，一个常数。\n因此，气压梯度力项 $-g \\frac{\\partial Z}{\\partial y}$ 的特征尺度是 $g \\frac{\\Delta Z}{L}$。\n\n由于这两个力处于平衡状态，它们的特征尺度必须是同一数量级：\n$$ fU \\sim g \\frac{\\Delta Z}{L} $$\n\n从这个尺度关系中，我们可以推导出特征风速尺度 $U$ 的表达式：\n$$ U = \\frac{g}{f} \\frac{\\Delta Z}{L} $$\n这个表达式根据给定的参数提供了地转风的特征大小。\n\n现在我们可以代入给定的数值来估算 $U$。\n所给的数值是：\n- $L = 500\\,\\mathrm{km} = 500 \\times 10^3\\,\\mathrm{m} = 5 \\times 10^5\\,\\mathrm{m}$\n- $\\Delta Z = 50\\,\\mathrm{m}$\n- $f = 10^{-4}\\,\\mathrm{s^{-1}}$\n\n重力加速度 $g$ 没有明确给出，但它是将位势高度与气压梯度联系起来所需的一个基本常数。我们将使用标准值 $g \\approx 9.8\\,\\mathrm{m\\,s^{-2}}$。\n\n将这些值代入我们推导出的尺度定律中：\n$$ U = \\frac{9.8\\,\\mathrm{m\\,s^{-2}}}{10^{-4}\\,\\mathrm{s^{-1}}} \\frac{50\\,\\mathrm{m}}{5 \\times 10^5\\,\\mathrm{m}} $$\n首先，我们计算空间尺度的比率：\n$$ \\frac{\\Delta Z}{L} = \\frac{50\\,\\mathrm{m}}{5 \\times 10^5\\,\\mathrm{m}} = \\frac{5 \\times 10^1}{5 \\times 10^5} = 10^{-4} $$\n这个比率是无量纲的。\n\n现在，将这个结果代回到 $U$ 的表达式中：\n$$ U = \\frac{9.8\\,\\mathrm{m\\,s^{-2}}}{10^{-4}\\,\\mathrm{s^{-1}}} \\times 10^{-4} $$\n$$ U = 9.8\\,\\mathrm{m\\,s^{-1}} $$\n\n题目要求答案四舍五入到两位有效数字。我们计算出的值 $9.8\\,\\mathrm{m\\,s^{-1}}$ 已经有两位有效数字。因此，不需要进一步的四舍五入。特征水平风速大小为 $9.8\\,\\mathrm{m\\,s^{-1}}$。",
            "answer": "$$\\boxed{9.8}$$"
        },
        {
            "introduction": "地转风是直线等压线下的理想平衡，但真实大气中的气流往往是弯曲的。这个练习 () 将引导你探索梯度风平衡，它在地转平衡的基础上引入了离心力。通过推导和求解梯度风方程，你将揭示低压（气旋）和高压（反气旋）系统在动力学上的根本不对称性，并理解为何强大的高压系统在物理上会受到限制。",
            "id": "4048741",
            "problem": "考虑北半球纬度 $\\phi=45^\\circ$ 的一个恒定科里奥利参数平面（一个 $f$ 平面）上，存在一个水平无辐散、稳定、无粘性的流动，该流动围绕中心形成半径为 $r$ 的圆形等压线。设 $\\hat{n}$ 表示从等压线指向其中心的向内单位法向量，并定义 $\\partial p/\\partial n$ 为向内的径向气压导数。假设空气密度 $\\rho$ 为常数，且流动沿等压线切向进行，速度大小为 $V$。科里奥利参数为 $f=2\\Omega\\sin\\phi$，其中 $\\Omega$ 是地球的角速度。\n\n从旋转坐标系中的水平动量方程出发，在圆柱坐标系中表示径向力平衡，推导围绕圆形低压（气压向内减小，因此 $\\partial p/\\partial n  0$）和圆形高压（气压向内增加，因此 $\\partial p/\\partial n > 0$）的稳定梯度风平衡中 $V$ 的表达式，推导过程中不得引用任何预先给出的平衡关系。清楚地说明你的符号约定，并解释径向平衡中科里奥利项和离心项的物理方向。\n\n然后，使用你推导出的平衡关系：\n- 对低压和高压两种情况，求解 $V$ 关于 $f$、$r$、$\\rho$ 和 $\\partial p/\\partial n$ 的所有实数解。\n- 确定存在真实反气旋解的条件，并判断气旋情况是否存在类似的限制。\n- 将梯度风 $V$ 的大小与相应的地转风 $V_g$（通过忽略曲率获得）进行比较，并解释为何低压和高压之间允许的速度存在不对称性。\n\n最后，对以下科学上真实的参数进行数值求解：$\\rho=1.2\\,\\mathrm{kg\\,m^{-3}}$，$r=3.0\\times 10^{5}\\,\\mathrm{m}$，$\\phi=45^\\circ$ 因此 $f=2\\Omega\\sin\\phi$ 其中 $\\Omega=7.2921\\times 10^{-5}\\,\\mathrm{s^{-1}}$，以及 $|\\partial p/\\partial n|=1.5\\times 10^{-3}\\,\\mathrm{Pa\\,m^{-1}}$。计算该气压梯度大小对应的 $V_g$、低压情况下物理相关的 $V$，并评估高压情况下是否存在真实的反气旋 $V$；如果存在，请说明其大小；如果不存在，请说明存在解的 $(1/\\rho)|\\partial p/\\partial n|$ 的阈值以及相应的最大反气旋速度。\n\n哪个选项最能准确地描述正确的比较和不对称性，包括数值结果？\n\nA. 在北半球 $\\phi=45^\\circ$ 且给定参数下，低压存在一个物理相关的气旋解，其 $V \\approx 9.3\\,\\mathrm{m\\,s^{-1}}$ 且 $V  V_g$。高压情况下也存在一个超地转解，其 $V \\approx 15.6\\,\\mathrm{m\\,s^{-1}}$。\n\nB. 在北半球 $\\phi=45^\\circ$ 且给定参数下，低压存在一个物理相关的次地转解，其 $V \\approx 9.3\\,\\mathrm{m\\,s^{-1}}$。在高压情况下，不存在真实的梯度风解，因为给定的气压梯度对于维持稳定的反气旋流动过强。\n\nC. 在北半球 $\\phi=45^\\circ$ 且给定参数下，高压存在一个物理相关的超地转解，其 $V \\approx 15.6\\,\\mathrm{m\\,s^{-1}}$。在低压情况下，风也是超地转的。\n\nD. 在低压和高压情况下，梯度风速均等于地转风速 $V_g \\approx 12.1\\,\\mathrm{m\\,s^{-1}}$，因为曲率效应可以忽略不计。",
            "solution": "用户提供了一个关于梯度风平衡推导与分析的问题。我将首先验证问题陈述，然后进行完整的推导和选项评估。\n\n### 问题验证\n\n**步骤 1：提取给定条件**\n- 流动条件：水平无辐散、稳定、无粘性。\n- 参考系：北半球恒定科里奥利参数平面（$f$ 平面）。\n- 纬度：$\\phi=45^\\circ$。\n- 科里奥利参数：$f=2\\Omega\\sin\\phi$，其中 $\\Omega$ 是地球的角速度。\n- 几何形状：半径为 $r$ 的圆形等压线。\n- 符号：$\\hat{n}$ 是指向等压线中心的向内单位法向量。$\\partial p/\\partial n$ 是向内的径向气压导数。\n- 常数：空气密度 $\\rho$ 是常数。\n- 速度：沿等压线切向，速度大小为 $V$。\n- 情况：低压（$\\partial p/\\partial n  0$），高压（$\\partial p/\\partial n > 0$）。\n- 数值参数：$\\rho=1.2\\,\\mathrm{kg\\,m^{-3}}$，$r=3.0\\times 10^{5}\\,\\mathrm{m}$，$\\phi=45^\\circ$，$\\Omega=7.2921\\times 10^{-5}\\,\\mathrm{s^{-1}}$，$|\\partial p/\\partial n|=1.5\\times 10^{-3}\\,\\mathrm{Pa\\,m^{-1}}$。\n\n**步骤 2：使用提取的条件进行验证**\n- **科学依据**：该问题是地球物理流体动力学中的一个经典练习，推导和分析梯度风，这是大气流动的一个标准模型。它基于旋转球体上流体动力学的基本原理（非惯性系中的牛顿第二定律）。该问题在科学上是合理的。\n- **良态问题**：问题陈述足够精确，可以推导出所需的方程，解出风速，分析存在的条件，并进行数值计算。最后的问题是具体的，并且可以根据分析得到解答。这是一个良态问题。\n- **客观性**：问题使用了标准的科学术语，并提供了客观的物理条件和参数。它没有主观或含糊的语言。\n\n**步骤 3：结论与行动**\n问题陈述有效、科学合理、良态且客观。我将继续进行解答。\n\n### 推导与分析\n\n我们从旋转参考系中稳定、无粘性流动的水平动量方程开始：\n$$ (\\mathbf{v} \\cdot \\nabla)\\mathbf{v} = -f\\mathbf{k} \\times \\mathbf{v} - \\frac{1}{\\rho}\\nabla_H p $$\n其中 $\\mathbf{v}$ 是速度矢量，$f$ 是科里奥利参数，$\\mathbf{k}$ 是当地的垂直单位矢量，$\\rho$ 是密度，$\\nabla_H p$ 是水平气压梯度。\n\n我们采用一个圆柱坐标系 $(r, \\theta, z)$，其原点位于圆形等压线的中心。速度是纯切向的，$\\mathbf{v} = v_\\theta \\hat{\\theta}$，其中 $v_\\theta$ 是切向速度分量。按照北半球的惯例，$v_\\theta > 0$ 表示逆时针（气旋性）流动，$v_\\theta  0$ 表示顺时针（反气旋性）流动。风速为 $V = |v_\\theta|$。在这些条件下，圆柱坐标系中的平流加速度项 $(\\mathbf{v} \\cdot \\nabla)\\mathbf{v}$ 简化为 $-\\frac{v_\\theta^2}{r}\\hat{r}$。这是向心加速度，方向沿径向指向内。\n\n单位质量的科里奥利力是 $-f\\mathbf{k} \\times \\mathbf{v} = -f\\mathbf{k} \\times (v_\\theta \\hat{\\theta})$。由于 $\\mathbf{k} \\times \\hat{\\theta} = \\hat{r}$，科里奥利项是 $-fv_\\theta \\hat{r}$。对于气旋性流动（$v_\\theta>0$），该力指向外（正 $\\hat{r}$ 方向）；对于反气旋性流动（$v_\\theta0$），该力指向内（负 $\\hat{r}$ 方向）。\n\n单位质量的气压梯度力是 $-\\frac{1}{\\rho}\\nabla_H p = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\hat{r}$。问题将向内的径向气压导数定义为 $\\partial p/\\partial n$。在一个 $r$ 向外增加的坐标系中，向内的方向对应于 $r$ 的减小，因此 $\\partial/\\partial n = -\\partial/\\partial r$。于是，$\\frac{\\partial p}{\\partial r} = -\\frac{\\partial p}{\\partial n}$。单位质量的气压梯度力为 $\\frac{1}{\\rho}\\frac{\\partial p}{\\partial n}\\hat{r}$。\n\n将这些项代入动量方程的径向分量，得到力平衡关系：\n$$ -\\frac{v_\\theta^2}{r} = -fv_\\theta + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} $$\n使用 $\\frac{\\partial p}{\\partial r} = -\\frac{\\partial p}{\\partial n}$，我们得到：\n$$ -\\frac{v_\\theta^2}{r} = -fv_\\theta - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial n} $$\n这是梯度风平衡的一般方程。它可以重新整理成关于 $v_\\theta$ 的二次方程：\n$$ \\frac{v_\\theta^2}{r} + fv_\\theta + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial n} = 0 $$\n使用二次公式求解 $v_\\theta$：\n$$ v_\\theta = \\frac{-fr \\pm \\sqrt{(fr)^2 - 4(r) \\left(\\frac{r}{\\rho}\\frac{\\partial p}{\\partial n}\\right)}}{2r} = -\\frac{fr}{2} \\pm \\sqrt{\\left(\\frac{fr}{2}\\right)^2 - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial n}} $$\n风速为 $V=|v_\\theta|$。\n\n**地转风 ($V_g$)**\n地转风 $V_g$ 由科里奥利力与气压梯度力之间的平衡定义，忽略了曲率（向心加速度项）。\n$$ 0 = -fV_g - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial n} $$\n这里，我们考虑力的大小，所以对于低压，$fV_g = -(1/\\rho)(\\partial p/\\partial n) = |(1/\\rho)(\\partial p/\\partial n)|$；对于高压，$fV_g = (1/\\rho)(\\partial p/\\partial n) = |(1/\\rho)(\\partial p/\\partial n)|$。在两种情况下，地转风速都是：\n$$ V_g = \\frac{1}{\\rho f}\\left|\\frac{\\partial p}{\\partial n}\\right| > 0 $$\n\n现在，让我们分析梯度风的两种情况。\n\n**情况 1：低压中心（气旋性）**\n在低压中，气压向内减小，所以 $\\partial p/\\partial n  0$。平方根内的项是 $\\left(\\frac{fr}{2}\\right)^2 + \\frac{r}{\\rho}\\left|\\frac{\\partial p}{\\partial n}\\right|$。这个值总是正的，所以总存在两个关于 $v_\\theta$ 的实数解。\n$$ v_\\theta = -\\frac{fr}{2} \\pm \\sqrt{\\left(\\frac{fr}{2}\\right)^2 + \\frac{r}{\\rho}\\left|\\frac{\\partial p}{\\partial n}\\right|} $$\n因为 $f>0$ (北半球) 且 $r>0$，所以项 $\\sqrt{\\left(\\frac{fr}{2}\\right)^2 + \\frac{r}{\\rho}\\left|\\frac{\\partial p}{\\partial n}\\right|} > \\sqrt{\\left(\\frac{fr}{2}\\right)^2} = \\frac{fr}{2}$。\n- ‘$+$’ 解给出 $v_\\theta > 0$，对应于气旋性流动。这是低压的物理相关解。\n- ‘$-$' 解给出 $v_\\theta  0$，是围绕低压的反气旋性流动，这是动力学上不稳定且未被观测到的。\n气旋性梯度风速为 $V = -\\frac{fr}{2} + \\sqrt{\\left(\\frac{fr}{2}\\right)^2 + r f V_g}$。\n为了比较 $V$ 和 $V_g$，我们检查力平衡：向内的气压梯度力由向外的科里奥利力和向外的离心力平衡。\n$fV_g = fV + V^2/r$。因为 $V^2/r > 0$，所以必然有 $fV_g > fV$，这意味着 $V  V_g$。低压中的梯度风是**次地转的**。\n\n**情况 2：高压中心（反气旋性）**\n在高压中，气压向内增加，所以 $\\partial p/\\partial n > 0$。$v_\\theta$ 的方程是：\n$$ v_\\theta = -\\frac{fr}{2} \\pm \\sqrt{\\left(\\frac{fr}{2}\\right)^2 - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial n}} $$\n为了存在实数解，判别式必须为非负：\n$$ \\left(\\frac{fr}{2}\\right)^2 - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial n} \\ge 0 \\implies \\frac{1}{\\rho}\\frac{\\partial p}{\\partial n} \\le \\frac{f^2 r}{4} $$\n这个条件对高压中的气压梯度大小施加了上限。如果违反此条件，则不可能存在稳定的圆形流动。\n假设该条件成立，则存在两个负的实数解 $v_\\theta$（因为 $\\sqrt{\\dots} \\le fr/2$），两者都对应于反气旋性流动。在 $r$ 很大时能正确渐近到地转风的解是绝对值较小的那个，即‘$+$’根。\n反气旋性梯度风速为 $V = |v_\\theta| = \\left| -\\frac{fr}{2} + \\sqrt{\\left(\\frac{fr}{2}\\right)^2 - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial n}} \\right| = \\frac{fr}{2} - \\sqrt{\\left(\\frac{fr}{2}\\right)^2 - r f V_g}$。\n为了比较 $V$ 和 $V_g$，我们检查力平衡：向内的科里奥利力由向外的气压梯度力和向外的离心力平衡。\n$fV = fV_g + V^2/r$。因为 $V^2/r > 0$，所以必然有 $fV > fV_g$，这意味着 $V > V_g$。高压中的梯度风是**超地转的**。\n可能的最大反气旋速度出现在判别式为零时，即 $(1/\\rho)(\\partial p/\\partial n) = f^2 r / 4$。在此极限下，$V = fr/2$。因此，反气旋梯度风速是有界的：$V \\le fr/2$。\n\n**数值计算**\n- 给定参数：$\\rho=1.2\\,\\mathrm{kg\\,m^{-3}}$，$r=3.0\\times 10^{5}\\,\\mathrm{m}$，$\\phi=45^\\circ$，$\\Omega=7.2921\\times 10^{-5}\\,\\mathrm{s^{-1}}$，$|\\partial p/\\partial n|=1.5\\times 10^{-3}\\,\\mathrm{Pa\\,m^{-1}}$。\n- 科里奥利参数：$f = 2\\Omega\\sin(45^\\circ) = 2(7.2921\\times 10^{-5}\\,\\mathrm{s^{-1}})/\\sqrt{2} \\approx 1.03125 \\times 10^{-4}\\,\\mathrm{s^{-1}}$。\n- 地转风速：$V_g = \\frac{1}{\\rho f}|\\frac{\\partial p}{\\partial n}| = \\frac{1.5\\times 10^{-3}}{(1.2)(1.03125 \\times 10^{-4})} = \\frac{1.5\\times 10^{-3}}{1.2375 \\times 10^{-4}} \\approx 12.12\\,\\mathrm{m\\,s^{-1}}$。\n\n**低压情况评估：**\n- 梯度风速 $V_{low}$ 为：\n$$ V_{low} = -\\frac{fr}{2} + \\sqrt{\\left(\\frac{fr}{2}\\right)^2 + \\frac{r}{\\rho}\\left|\\frac{\\partial p}{\\partial n}\\right|} $$\n- $fr = (1.03125 \\times 10^{-4})(3.0 \\times 10^5) = 30.9375\\,\\mathrm{m\\,s^{-1}}$。\n- $\\frac{r}{\\rho}|\\frac{\\partial p}{\\partial n}| = \\frac{3.0\\times 10^5}{1.2}(1.5 \\times 10^{-3}) = 375\\,\\mathrm{m^2\\,s^{-2}}$。\n- $V_{low} = -\\frac{30.9375}{2} + \\sqrt{\\left(\\frac{30.9375}{2}\\right)^2 + 375} = -15.46875 + \\sqrt{239.283... + 375} = -15.46875 + \\sqrt{614.283...}$\n- $V_{low} \\approx -15.47 + 24.78 = 9.31\\,\\mathrm{m\\,s^{-1}}$。\n- 因此，$V_{low} \\approx 9.3\\,\\mathrm{m\\,s^{-1}}$。我们确认 $V_{low}  V_g$（$9.3  12.12$）。\n\n**高压情况评估：**\n- 我们必须检查存在条件：$(1/\\rho)|\\partial p/\\partial n| \\le f^2 r / 4$。\n- 左侧：$\\frac{1}{\\rho}|\\frac{\\partial p}{\\partial n}| = \\frac{1.5\\times 10^{-3}}{1.2} = 1.25\\times 10^{-3}\\,\\mathrm{m^2\\,s^{-2}}$。\n- 右侧（阈值）：$\\frac{f^2 r}{4} = \\frac{(1.03125\\times 10^{-4})^2(3.0\\times 10^5)}{4} \\approx \\frac{(1.0635\\times 10^{-8})(3.0\\times 10^5)}{4} \\approx \\frac{3.1905\\times 10^{-3}}{4} \\approx 0.7976\\times 10^{-3}\\,\\mathrm{m^2\\,s^{-2}}$。\n- 由于 $1.25\\times 10^{-3} > 0.7976\\times 10^{-3}$，该条件被违反。气压梯度过强。\n- 因此，对于给定的参数，不存在真实的反气旋梯度风解。\n\n### 逐项分析\n\n**A. 在北半球 $\\phi=45^\\circ$ 且给定参数下，低压存在一个物理相关的气旋解，其 $V\\approx 9.3\\,\\mathrm{m\\,s^{-1}}$ 且 $V  V_g$。高压情况下也存在一个超地转解，其 $V \\approx 15.6\\,\\mathrm{m\\,s^{-1}}$。**\n- **错误**。高压情况下不存在解。\n\n**B. 在北半球 $\\phi=45^\\circ$ 且给定参数下，低压存在一个物理相关的次地转解，其 $V \\approx 9.3\\,\\mathrm{m\\,s^{-1}}$。在高压情况下，不存在真实的梯度风解，因为给定的气压梯度对于维持稳定的反气旋流动过强。**\n- **正确**。这与我们的计算完全一致。\n\n**C. 在北半球 $\\phi=45^\\circ$ 且给定参数下，高压存在一个物理相关的超地转解，其 $V \\approx 15.6\\,\\mathrm{m\\,s^{-1}}$。在低压情况下，风也是超地转的。**\n- **错误**。高压情况下不存在解，且低压情况下的风是次地转的。\n\n**D. 在低压和高压情况下，梯度风速均等于地转风速 $V_g \\approx 12.1\\,\\mathrm{m\\,s^{-1}}$，因为曲率效应可以忽略不计。**\n- **错误**。曲率效应是问题的核心，并且在数值上是显著的。梯度风速不等于地转风速。\n\n因此，选项 **B** 是唯一正确的陈述。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "理论概念的最终检验在于其在实际数据中的应用。这个综合性练习 () 要求你将地转风的理论知识转化为一个计算程序，模拟现代天气预报和数据分析中的一个核心任务。你将学习如何在球坐标网格上处理位势高度场，通过有限差分计算风场，并处理赤道附近的奇点等实际问题，从而将理论与实践紧密结合。",
            "id": "3883018",
            "problem": "您的任务是设计并实现一个程序，该程序基于理想化地球上单个气压层、经纬度网格上的地球位势场，计算地转风矢量。您的实现必须基于基本原理，从旋转球体上的水平动量方程和地球位势的定义开始。您必须明确处理单位转换、球面上的度规因子，以及经纬度网格上水平梯度的有限差分近似。该程序还必须为指定的测试场生成解析参考解，并量化数值误差。\n\n使用的基本依据：\n- 旋转参考系中的Newton第二定律，以及在$f$平面上加速度和摩擦力可忽略时的无粘性、定常水平动量平衡，这导致了水平气压梯度力与科里奥利力之间的地转平衡。\n- 位势高度与地球位势之间的关系，即位势高度乘以标准重力等于地球位势。\n\n您的推导必须：\n- 从旋转球体上的定常、无粘性水平动量方程出发，简化为地转平衡，并获得地转风矢量与局地东-北坐标系中地球位势水平梯度之间的分量关系。\n- 使用依赖于纬度的球面度规因子，将关于经度和纬度的偏导数与局地笛卡尔分量联系起来。\n- 指明经纬度网格上偏导数的有限差分格式，包括经度的周期性处理和纬度的边界处理。\n- 如果输入场以位势高度形式提供，指明如何将其转换为地球位势，包括所使用的标准重力的数值。\n\n需实现的计算细节：\n- 使用地球半径 $a$ 等于 $6.371\\times 10^{6}$ 米，地球自转速率 $\\Omega$ 等于 $7.292115\\times 10^{-5}$ 每秒。\n- 当通过 $\\Phi = g_{0} Z$ 将位势高度 $Z$ 转换为地球位势 $\\Phi$ 时，使用标准重力 $g_{0}$ 等于 $9.80665$ 米每平方秒。\n- 科里奥利参数为 $f = 2 \\Omega \\sin(\\varphi)$，其中 $\\varphi$ 是以弧度为单位的纬度。\n- 网格在经度上从 $0^\\circ$ 到小于 $360^\\circ$ 以 $5^\\circ$ 为增量，纬度上从 $-80^\\circ$ 到 $+80^\\circ$ 以 $5^\\circ$ 为增量，均为均匀度数网格。您的程序必须在需要时内部将角度从度转换为弧度。\n- 使用关于经度和纬度（以弧度度量）的有限差分计算水平梯度。在内部区域使用中心差分格式。将经度视为周期性的，纬度视为非周期性的，在第一行和最后一行纬度上使用单侧二阶精度格式。\n- 使用球面度规因子，将经向和纬向导数映射到局地的东西向和南北向导数。\n- 计算地转风分量，并通过对 $|f|$ 施加最小量级阈值来处理赤道附近的奇点。具体来说，如果 $|f|  f_{\\min}$，其中 $f_{\\min} = 10^{-5}$ 每秒，则在该网格点将地转风视为未定义，并表示为“非数值”(Not-a-Number)。此约定必须在数值计算和解析参考评估中一致使用，并且在汇总误差统计时必须忽略。\n\n角度单位规范：\n- 所有输入的经度和纬度均以度为单位。所有内部的三角函数和微分运算必须使用弧度。\n\n物理单位规范：\n- 输入的地球位势 $\\Phi$ 单位必须是米平方每平方秒。如果输入场以位势高度 $Z$ (单位：米)提供，则在进行任何微分计算之前，使用指定的标准重力将其转换为地球位势 $\\Phi$ (单位：米平方每平方秒)。输出的地转风分量单位必须是米每秒，误差度量也必须以米每秒报告。\n\n测试套件：\n实现以下三个测试案例，每个案例都应产生一个二元组，包含根据相同基本定律推导出的数值计算与解析参考的地转风纬向和经向分量的均方根误差：\n\n- 案例 $1$ (仅经向变化，存在赤道奇点的理想情况)：输入场为地球位势 $\\Phi(\\lambda,\\varphi) = A \\sin(\\varphi)$，其中 $\\lambda$ 是经度，$\\varphi$ 是纬度，单位均为弧度。使用 $A = 5.0\\times 10^{3}$ 米平方每平方秒。此案例用于检验纬向梯度计算，并且根据对称性，其经向地转风分量为零。确保在误差汇总时排除 $|f|  f_{\\min}$ 的点。\n- 案例 $2$ (纬向-经向耦合变化，周期性经度检查)：输入场为地球位势 $\\Phi(\\lambda,\\varphi) = B \\cos(\\lambda)\\cos(\\varphi)$，其中 $B = 1.2\\times 10^{4}$ 米平方每平方秒。此案例用于检验纬向和经向梯度计算以及经度的周期性边界。\n- 案例 $3$ (波数为2的单位转换边缘情况)：输入场为位势高度 $Z(\\lambda,\\varphi) = C_{z} \\cos(2\\lambda) + D_{z} \\sin(2\\varphi)$，单位为米，其中 $C_{z} = 250$ 米，$D_{z} = 150$ 米。在计算梯度之前，使用 $\\Phi = g_{0} Z$ 将其转换为地球位势。此案例用于检验单位转换以及更高纬向和经向波数的情况。\n\n对于每个案例：\n- 在指定的网格上构建场。\n- 使用您的有限差分格式和球面度规因子计算数值地转风分量。\n- 根据连续场和相同的基本地转平衡，使用关于 $\\lambda$ 和 $\\varphi$ 的精确导数，独立推导解析地转风分量。\n- 在地转风有定义的所有网格点上，分别计算纬向分量和经向分量的均方根误差。从汇总中排除标记为“非数值”(Not-a-Number)的未定义点。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，格式为 $[E_{u,1},E_{v,1},E_{u,2},E_{v,2},E_{u,3},E_{v,3}]$，其中 $E_{u,i}$ 和 $E_{v,i}$ 分别是案例 $i$ 的纬向和经向分量的均方根误差（单位：米每秒）。例如，一个语法上有效的输出应类似于 $[0.0123,0.0456,0.0011,0.0022,0.0333,0.0444]$。",
            "solution": "该问题是有效的，因为它提出了一个在计算大气动力学领域中定义明确、有科学依据的任务。所有必要的常数、方程、边界条件和数值方法都已指明，从而可以得到一个唯一且可验证的解。该问题是自洽的，内部一致，没有歧义或事实错误。\n\n计算地转风的程序设计基于旋转球体上的流体动力学基本原理。推导和实现步骤概述如下。\n\n### 1. 基本控制方程\n出发点是旋转球体上流体的水平动量平衡。在没有摩擦并假设定常状态（$\\frac{D}{Dt}=0$）的情况下，考虑无粘性水平动量方程。对于大尺度大气运动，平流项和度规曲率项（例如 $\\frac{u^2 \\tan\\varphi}{a}$）与科里奥利力和气压梯度力相比很小。这导出了地转平衡，即科里奥利力与水平气压梯度力完全平衡。\n\n在局地笛卡尔坐标系中，其中 $x$ 指向东（纬向），$y$ 指向北（经向），该平衡表示为：\n$$ -f v_g = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $$\n$$ f u_g = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial y} $$\n这里，$u_g$ 是地转风的纬向分量，$v_g$ 是经向分量，$p$ 是气压，$\\rho$ 是密度，$f = 2\\Omega\\sin(\\varphi)$ 是科里奥利参数，其中 $\\Omega$ 是地球的自转速率，$\\varphi$ 是纬度。\n\n### 2. 地球位势表述\n在恒定气压表面（等压面）上，单位质量的水平气压梯度力 $-\\frac{1}{\\rho}\\nabla_h p$ 等于地球位势水平梯度的负值 $-\\nabla_h \\Phi$。地球位势 $\\Phi$ 定义为将单位质量从海平面提升到特定高度所需的功，并与位势高度 $Z$ 通过 $\\Phi = g_0 Z$ 相关联，其中 $g_0$ 是海平面的标准重力。\n\n在半径为 $a$ 的球体上，地球位势的水平梯度分量可以用关于经度 $\\lambda$ 和纬度 $\\varphi$ 的偏导数表示：\n$$ \\frac{\\partial \\Phi}{\\partial x} = \\frac{1}{a \\cos\\varphi} \\frac{\\partial \\Phi}{\\partial \\lambda} $$\n$$ \\frac{\\partial \\Phi}{\\partial y} = \\frac{1}{a} \\frac{\\partial \\Phi}{\\partial \\varphi} $$\n项 $\\frac{1}{a \\cos\\varphi}$ 和 $\\frac{1}{a}$ 是度规因子，分别将角位移（$d\\lambda, d\\varphi$）与东西方向和南北方向的物理距离联系起来。\n\n将地球位势梯度分量代入地转平衡方程得到：\n$$ -f v_g = -\\frac{1}{a \\cos\\varphi} \\frac{\\partial \\Phi}{\\partial \\lambda} $$\n$$ f u_g = -\\frac{1}{a} \\frac{\\partial \\Phi}{\\partial \\varphi} $$\n\n求解地转风分量，得到最终要实现的方程组：\n$$ u_g = -\\frac{1}{f a} \\frac{\\partial \\Phi}{\\partial \\varphi} $$\n$$ v_g = \\frac{1}{f a \\cos\\varphi} \\frac{\\partial \\Phi}{\\partial \\lambda} $$\n\n### 3. 经纬度网格上的数值离散化\n连续的地球位势场 $\\Phi(\\lambda, \\varphi)$ 是在离散网格上提供的。偏导数 $\\frac{\\partial \\Phi}{\\partial \\lambda}$ 和 $\\frac{\\partial \\Phi}{\\partial \\varphi}$ 必须使用有限差分进行近似。所有角度变量（$\\lambda, \\varphi$）及其增量（$d\\lambda, d\\varphi$）在计算时都从度转换为弧度。\n\n网格在经度和纬度上具有均匀间距。\n-   **纬向梯度 ($\\frac{\\partial \\Phi}{\\partial \\lambda}$)**：经度是周期性的。使用二阶中心差分格式，该格式通过在边界处“环绕”来自然地处理周期性。对于网格上的场 $\\Phi$，在经度索引 $i$ 处的导数近似为：\n    $$ \\left(\\frac{\\partial \\Phi}{\\partial \\lambda}\\right)_i \\approx \\frac{\\Phi_{i+1} - \\Phi_{i-1}}{2 d\\lambda} $$\n    其中索引对经度点数取模。这可以使用 `np.roll` 高效实现。\n\n-   **经向梯度 ($\\frac{\\partial \\Phi}{\\partial \\varphi}$)**：纬度不是周期性的。对内部点使用二阶中心差分。在最小和最大纬度边界处，需要使用二阶精度的单侧（分别为前向和后向）格式：\n    -   在第一行纬度（$j=0$）：$\\frac{-3\\Phi_0 + 4\\Phi_1 - \\Phi_2}{2 d\\varphi}$\n    -   在最后一行纬度（$j=N-1$）：$\\frac{3\\Phi_{N-1} - 4\\Phi_{N-2} + \\Phi_{N-3}}{2 d\\varphi}$\n    整个方案可以方便地使用 `numpy.gradient` 并附带 `edge_order=2` 选项来实现。\n\n### 4. 赤道奇点的处理\n$u_g$ 和 $v_g$ 的方程分母中包含科里奥利参数 $f$。由于 $f = 2\\Omega\\sin\\varphi$，它在赤道（$\\varphi=0$）处趋近于零，导致一个奇点。为在计算上处理此问题，建立了一个最小阈值 $f_{\\min} = 10^{-5} \\text{ s}^{-1}$。在任何 $|f|  f_{\\min}$ 的网格点，地转风被视为未定义。在实现中，这些值被设为“非数值”(`NaN`)。这种掩码处理同时应用于数值计算的风场和解析推导的参考风场。\n\n### 5. 解析参考与误差量化\n对于每个测试案例，所提供的地球位势 $\\Phi(\\lambda, \\varphi)$ 的连续函数允许精确计算偏导数 $\\frac{\\partial \\Phi}{\\partial \\lambda}$ 和 $\\frac{\\partial \\Phi}{\\partial \\varphi}$。然后将这些精确导数用于地转风方程，以计算解析（“真实”）风分量 $u_{g, \\text{analytic}}$ 和 $v_{g, \\text{analytic}}$。\n\n三个测试案例的解析解如下：\n-   **案例 1:** $\\Phi = A \\sin(\\varphi)$\n    $$ u_{g, \\text{analytic}} = -\\frac{A}{2 \\Omega a} \\cot(\\varphi) $$\n    $$ v_{g, \\text{analytic}} = 0 $$\n-   **案例 2:** $\\Phi = B \\cos(\\lambda)\\cos(\\varphi)$\n    $$ u_{g, \\text{analytic}} = \\frac{B \\cos(\\lambda)}{2 \\Omega a} $$\n    $$ v_{g, \\text{analytic}} = -\\frac{B \\sin(\\lambda)}{2 \\Omega a \\sin\\varphi} $$\n-   **案例 3:** $Z = C_{z} \\cos(2\\lambda) + D_{z} \\sin(2\\varphi)$, 且 $\\Phi = g_0 Z$\n    $$ u_{g, \\text{analytic}} = -\\frac{g_0 D_{z} \\cos(2\\varphi)}{\\Omega a \\sin\\varphi} $$\n    $$ v_{g, \\text{analytic}} = -\\frac{g_0 C_{z} \\sin(2\\lambda)}{\\Omega a \\sin\\varphi \\cos\\varphi} $$\n\n数值格式的精度通过数值风场与解析风场之间的均方根误差 (RMSE) 来量化。对于纬向分量，RMSE为：\n$$ E_u = \\sqrt{\\frac{\\sum (u_{g, \\text{numerical}} - u_{g, \\text{analytic}})^2}{N_{\\text{valid}}}} $$\n其中，求和遍历所有风场有定义（即非 `NaN`）的 $N_{\\text{valid}}$ 个网格点。经向分量 $E_v$ 也使用相应的表达式。为此使用了 `np.nanmean` 函数，因为它会自动忽略 `NaN` 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes geostrophic wind from geopotential fields, evaluates numerical error against \n    analytic solutions for three test cases, and prints the results.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    A_EARTH = 6.371e6  # Earth radius in meters\n    OMEGA = 7.292115e-5  # Earth rotation rate in per second\n    G0 = 9.80665  # Standard gravity in m/s^2\n    F_MIN = 1e-5  # Minimum Coriolis parameter magnitude in per second\n\n    def setup_grid():\n        \"\"\"\n        Initializes the latitude-longitude grid and related parameters.\n        \"\"\"\n        lons_deg = np.arange(0, 360, 5)\n        lons_rad = np.deg2rad(lons_deg)\n        d_lambda = np.deg2rad(5.0)\n\n        lats_deg = np.arange(-80, 80.1, 5)\n        lats_rad = np.deg2rad(lats_deg)\n        d_phi = np.deg2rad(5.0)\n\n        lambda_mesh, phi_mesh = np.meshgrid(lons_rad, lats_rad)\n        f_field = 2 * OMEGA * np.sin(phi_mesh)\n        \n        grid_params = {\n            \"lambda_mesh\": lambda_mesh,\n            \"phi_mesh\": phi_mesh,\n            \"d_lambda\": d_lambda,\n            \"d_phi\": d_phi,\n            \"f_field\": f_field,\n        }\n        return grid_params\n\n    def compute_numerical_derivatives(Phi_field, d_lambda, d_phi):\n        \"\"\"\n        Computes horizontal gradients of a field on the spherical grid \n        using finite differences.\n        \"\"\"\n        # Zonal derivative (d/d_lambda) with periodic boundary condition\n        dPhi_dlambda = (np.roll(Phi_field, -1, axis=1) - np.roll(Phi_field, 1, axis=1)) / (2 * d_lambda)\n        \n        # Meridional derivative (d/d_phi) with second-order one-sided boundaries\n        dPhi_dphi = np.gradient(Phi_field, d_phi, axis=0, edge_order=2)\n        \n        return dPhi_dlambda, dPhi_dphi\n\n    def compute_wind_components(dPhi_dlambda, dPhi_dphi, f_field, phi_mesh):\n        \"\"\"\n        Computes geostrophic wind components from geopotential gradients.\n        \"\"\"\n        # Create a mask for the near-equatorial singularity\n        mask = np.abs(f_field)  F_MIN\n\n        # Compute u_g = -(1 / (f * a)) * (dPhi / d_phi)\n        factor_u = np.full_like(f_field, np.nan)\n        np.divide(-1.0, f_field * A_EARTH, out=factor_u, where=~mask)\n        u_g = factor_u * dPhi_dphi\n\n        # Compute v_g = (1 / (f * a * cos(phi))) * (dPhi / d_lambda)\n        factor_v = np.full_like(f_field, np.nan)\n        denom_v = f_field * A_EARTH * np.cos(phi_mesh)\n        np.divide(1.0, denom_v, out=factor_v, where=~mask)\n        v_g = factor_v * dPhi_dlambda\n        \n        return u_g, v_g\n\n    def get_test_case_fields(case_id, grid, params):\n        \"\"\"\n        Generates the geopotential field and its analytical derivatives for a given test case.\n        \"\"\"\n        lambda_mesh, phi_mesh = grid[\"lambda_mesh\"], grid[\"phi_mesh\"]\n        \n        if case_id == 1:\n            A = params[0]\n            Phi = A * np.sin(phi_mesh)\n            dPhi_dlambda_an = np.zeros_like(lambda_mesh)\n            dPhi_dphi_an = A * np.cos(phi_mesh)\n        elif case_id == 2:\n            B = params[0]\n            Phi = B * np.cos(lambda_mesh) * np.cos(phi_mesh)\n            dPhi_dlambda_an = -B * np.sin(lambda_mesh) * np.cos(phi_mesh)\n            dPhi_dphi_an = -B * np.cos(lambda_mesh) * np.sin(phi_mesh)\n        elif case_id == 3:\n            Cz, Dz = params\n            Z = Cz * np.cos(2 * lambda_mesh) + Dz * np.sin(2 * phi_mesh)\n            Phi = G0 * Z\n            dPhi_dlambda_an = G0 * (-2 * Cz * np.sin(2 * lambda_mesh))\n            dPhi_dphi_an = G0 * (2 * Dz * np.cos(2 * phi_mesh))\n        else:\n            raise ValueError(\"Invalid case_id\")\n            \n        return Phi, dPhi_dlambda_an, dPhi_dphi_an\n\n    test_cases = [\n        # (case_id, (parameters...))\n        (1, (5.0e3,)),\n        (2, (1.2e4,)),\n        (3, (250.0, 150.0)),\n    ]\n\n    grid = setup_grid()\n    results = []\n\n    for case_id, params in test_cases:\n        # 1. Generate geopotential field and its analytical derivatives\n        Phi_field, dPhi_dlambda_an, dPhi_dphi_an = get_test_case_fields(case_id, grid, params)\n        \n        # 2. Compute numerical derivatives of the geopotential field\n        dPhi_dlambda_num, dPhi_dphi_num = compute_numerical_derivatives(\n            Phi_field, grid[\"d_lambda\"], grid[\"d_phi\"]\n        )\n        \n        # 3. Compute geostrophic wind from numerical derivatives\n        u_g_num, v_g_num = compute_wind_components(\n            dPhi_dlambda_num, dPhi_dphi_num, grid[\"f_field\"], grid[\"phi_mesh\"]\n        )\n        \n        # 4. Compute geostrophic wind from analytical derivatives (ground truth)\n        u_g_an, v_g_an = compute_wind_components(\n            dPhi_dlambda_an, dPhi_dphi_an, grid[\"f_field\"], grid[\"phi_mesh\"]\n        )\n        \n        # 5. Calculate Root-Mean-Square Error, ignoring NaN values\n        diff_u_sq = (u_g_num - u_g_an)**2\n        diff_v_sq = (v_g_num - v_g_an)**2\n        \n        rmse_u = np.sqrt(np.nanmean(diff_u_sq))\n        rmse_v = np.sqrt(np.nanmean(diff_v_sq))\n        \n        results.extend([rmse_u, rmse_v])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}