{
    "hands_on_practices": [
        {
            "introduction": "在验证复杂数值模型的准确性时，与已知的解析解进行比较是一种黄金标准。本练习将带您从第一性原理出发，推导一维声波方程的解析解，以一个高斯压力脉冲作为初始条件。通过这项实践，您将巩固对声波传播基本物理过程的理解，并掌握一个在实际模型验证中广泛使用的“真实”参考解 。",
            "id": "4008687",
            "problem": "考虑在数值天气预报（NWP）和气候环流模式（GCM）中对声波模式处理的验证。假设一个均匀、静止、可压缩的介质，其背景密度 $\\rho_0$ 和声速 $c$ 均为常数，并忽略浮力和平均流。将可压缩欧拉方程在静止状态附近进行线性化，得到一维空间 $x \\in \\mathbb{R}$ 的第一性原理声学系统：\n$$\n\\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} = 0, \\qquad \\frac{\\partial p'}{\\partial t} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0,\n$$\n其中 $p'(x,t)$ 是压强扰动，$u'(x,t)$ 是速度扰动。设初始压强扰动为一个振幅为 $p_a$、宽度为 $\\sigma$ 的高斯隆起，\n$$\np'(x,0) = p_a \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right),\n$$\n并选择初始速度为零，\n$$\nu'(x,0) = 0,\n$$\n在一个无界域上，且当 $|x|\\to\\infty$ 时满足消失条件。这定义了一个适合模型验证的初值问题。\n\n以此为基础，推导 $t \\ge 0$ 时 $p'(x,t)$ 和 $u'(x,t)$ 的解析解，并确定下列哪个表达式是正确的闭式解，可用于验证数值模型。\n\nA. \n$$\np'(x,t) = \\frac{p_a}{2}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right],\n$$\n$$\nu'(x,t) = \\frac{p_a}{2\\rho_0 c}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right].\n$$\n\nB.\n$$\np'(x,t) = p_a \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right), \\qquad u'(x,t) = 0.\n$$\n\nC.\n$$\np'(x,t) = \\frac{p_a}{2}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right],\n$$\n$$\nu'(x,t) = \\frac{p_a}{2\\rho_0 c}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right].\n$$\n\nD.\n$$\np'(x,t) = p_a \\exp\\!\\left(-\\frac{x^2 + c^2 t^2}{2\\sigma^2}\\right), \\qquad u'(x,t) = \\frac{p_a}{\\rho_0 c}\\exp\\!\\left(-\\frac{x^2 + c^2 t^2}{2\\sigma^2}\\right).\n$$",
            "solution": "### 问题验证\n\n首先，必须验证问题陈述的科学合理性、一致性和适定性。\n\n#### 步骤1：提取已知条件\n\n所提供的信息包括：\n1.  **控制方程**：一个用于一维（$x \\in \\mathbb{R}$）声学系统的两个一阶线性偏微分方程组：\n    $$\n    \\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} = 0\n    $$\n    $$\n    \\frac{\\partial p'}{\\partial t} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0\n    $$\n2.  **变量和常数**：\n    -   $p'(x,t)$：压强扰动。\n    -   $u'(x,t)$：速度扰动。\n    -   $\\rho_0$：恒定背景密度。\n    -   $c$：恒定声速。\n    -   $p_a$：初始压强扰动的振幅。\n    -   $\\sigma$：初始压强扰动的宽度。\n3.  **初始条件（在 $t=0$ 时）**：\n    -   压强：$p'(x,0) = p_a \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)$。\n    -   速度：$u'(x,0) = 0$。\n4.  **边界条件**：当 $|x| \\to \\infty$ 时，$p'$ 和 $u'$ 的消失条件。\n5.  **假设**：介质是均匀、静止、可压缩的。浮力和平均流被忽略。方程在静止状态附近进行了线性化。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据**：控制方程是标准的线性化一维可压缩欧拉方程，是静止流体中声学的基本模型。该设置是波传播理论中的一个经典教科书问题。该问题牢固地基于已确立的流体动力学和物理学原理。它是科学合理的。\n-   **适定性**：该问题是双曲型偏微分方程组的初值问题。在无界域上，对于良态初始条件（高斯函数是无穷次可微且快速衰减的），存在对所有 $t \\ge 0$ 都唯一且稳定的解。该问题是适定的。\n-   **客观性**：语言精确、数学化，不含任何主观或基于意见的内容。\n-   **完整性**：提供了推导唯一解析解所需的所有必要信息（控制方程、初始条件、常数和定义域）。该问题是自洽的。\n-   **一致性**：所提供的信息内部没有矛盾。\n\n#### 步骤3：结论与行动\n\n问题陈述是有效的。这是一个来自经典波动力学的适定且科学合理的问题。我将继续推导解答。\n\n### 解析解的推导\n\n问题是求解以下偏微分方程组：\n1.  $\\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} = 0$\n2.  $\\frac{\\partial p'}{\\partial t} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0$\n\n初始条件为：\n$p'(x,0) = p_a \\exp(-x^2 / (2\\sigma^2))$\n$u'(x,0) = 0$\n\n该方程组可以解耦为两个标准的一维波动方程。为了推导 $p'$ 的波动方程，我们将方程（1）对 $x$ 求导，方程（2）对 $t$ 求导：\n$\\frac{\\partial^2 u'}{\\partial t \\partial x} + \\frac{1}{\\rho_0}\\frac{\\partial^2 p'}{\\partial x^2} = 0$\n$\\frac{\\partial^2 p'}{\\partial t^2} + \\rho_0 c^2 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0$\n\n从第一个微分后的方程，我们得到 $\\frac{\\partial^2 u'}{\\partial t \\partial x} = -\\frac{1}{\\rho_0}\\frac{\\partial^2 p'}{\\partial x^2}$。将其代入第二个方程，得到：\n$\\frac{\\partial^2 p'}{\\partial t^2} + \\rho_0 c^2 \\left(-\\frac{1}{\\rho_0}\\frac{\\partial^2 p'}{\\partial x^2}\\right) = 0 \\implies \\frac{\\partial^2 p'}{\\partial t^2} = c^2 \\frac{\\partial^2 p'}{\\partial x^2}$\n\n类似地，可以证明 $u'$ 也满足波动方程：$\\frac{\\partial^2 u'}{\\partial t^2} = c^2 \\frac{\\partial^2 u'}{\\partial x^2}$。\n\n对于一维波动方程 $\\frac{\\partial^2 \\psi}{\\partial t^2} = c^2 \\frac{\\partial^2 \\psi}{\\partial x^2}$，在初始条件为 $\\psi(x,0) = f(x)$ 和 $\\frac{\\partial \\psi}{\\partial t}(x,0) = g(x)$ 的情况下，其通解由 d'Alembert 公式给出：\n$$\n\\psi(x,t) = \\frac{1}{2} [f(x-ct) + f(x+ct)] + \\frac{1}{2c} \\int_{x-ct}^{x+ct} g(\\xi) d\\xi\n$$\n\n**1. 压强扰动 $p'(x,t)$ 的解**\n\n压强的初始条件是 $p'(x,0) = p_a \\exp(-x^2 / (2\\sigma^2))$。\n我们需要初始时间导数 $\\frac{\\partial p'}{\\partial t}(x,0)$。根据控制方程（2）：\n$\\frac{\\partial p'}{\\partial t}(x,0) = -\\rho_0 c^2 \\frac{\\partial u'}{\\partial x}(x,0)$。\n由于对所有 $x$ 都有 $u'(x,0) = 0$，其空间导数也为零：$\\frac{\\partial u'}{\\partial x}(x,0) = 0$。\n因此，$\\frac{\\partial p'}{\\partial t}(x,0) = 0$。\n\n对 $p'(x,t)$ 应用 d'Alembert 公式，其中 $f(x) = p_a \\exp(-x^2 / (2\\sigma^2))$ 且 $g(x) = 0$：\n$$\np'(x,t) = \\frac{1}{2} \\left[ p_a \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + p_a \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) \\right] + \\frac{1}{2c} \\int_{x-ct}^{x+ct} 0 \\, d\\xi\n$$\n$$\np'(x,t) = \\frac{p_a}{2} \\left[ \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) \\right]\n$$\n该解描述了初始高斯脉冲分裂成两个振幅减半的相同脉冲，一个以速度 $c$ 向右传播，另一个以速度 $c$ 向左传播。\n\n**2. 速度扰动 $u'(x,t)$ 的解**\n\n速度的初始条件是 $u'(x,0) = 0$。\n我们需要初始时间导数 $\\frac{\\partial u'}{\\partial t}(x,0)$。根据控制方程（1）：\n$\\frac{\\partial u'}{\\partial t}(x,0) = -\\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x}(x,0)$。\n首先，我们计算初始压强的导数：\n$\\frac{\\partial p'}{\\partial x}(x,0) = \\frac{\\partial}{\\partial x} \\left[ p_a \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right) \\right] = p_a \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right) \\left(-\\frac{2x}{2\\sigma^2}\\right) = -\\frac{p_a x}{\\sigma^2} \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)$。\n所以，速度的初始时间导数是：\n$\\frac{\\partial u'}{\\partial t}(x,0) = -\\frac{1}{\\rho_0} \\left( -\\frac{p_a x}{\\sigma^2} \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right) \\right) = \\frac{p_a x}{\\rho_0 \\sigma^2} \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)$。\n\n对 $u'(x,t)$ 应用 d'Alembert 公式，其中 $f(x) = 0$ 且 $g(x) = \\frac{p_a x}{\\rho_0 \\sigma^2} \\exp(-x^2 / (2\\sigma^2))$：\n$$\nu'(x,t) = \\frac{1}{2} [0 + 0] + \\frac{1}{2c} \\int_{x-ct}^{x+ct} \\frac{p_a \\xi}{\\rho_0 \\sigma^2} \\exp\\!\\left(-\\frac{\\xi^2}{2\\sigma^2}\\right) d\\xi\n$$\n该积分可以通过认识到被积函数是一个高斯函数的导数来计算。令 $H(\\xi) = -\\frac{p_a}{\\rho_0} \\exp(-\\xi^2/(2\\sigma^2))$。那么 $\\frac{dH}{d\\xi} = -\\frac{p_a}{\\rho_0} \\exp(-\\xi^2/(2\\sigma^2)) \\cdot (-\\frac{2\\xi}{2\\sigma^2}) = \\frac{p_a \\xi}{\\rho_0 \\sigma^2} \\exp(-\\xi^2/(2\\sigma^2))$。\n所以，积分为：\n$$\n\\int_{x-ct}^{x+ct} g(\\xi) d\\xi = \\left[ -\\frac{p_a}{\\rho_0} \\exp\\!\\left(-\\frac{\\xi^2}{2\\sigma^2}\\right) \\right]_{x-ct}^{x+ct} = -\\frac{p_a}{\\rho_0} \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) - \\left( -\\frac{p_a}{\\rho_0} \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) \\right)\n$$\n$$\n= \\frac{p_a}{\\rho_0} \\left[ \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) \\right]\n$$\n将此代回 $u'(x,t)$ 的解中：\n$$\nu'(x,t) = \\frac{1}{2c} \\cdot \\frac{p_a}{\\rho_0} \\left[ \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) \\right]\n$$\n$$\nu'(x,t) = \\frac{p_a}{2\\rho_0 c} \\left[ \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right) \\right]\n$$\n该解表明，初始静止的介质被压强梯度驱动，从而产生了与两个分离的压强脉冲相关的两个相反的速度场。\n\n### 逐项分析\n\n现在我将把每个给定的选项与推导出的解进行对比评估。\n\n**A.**\n$$\np'(x,t) = \\frac{p_a}{2}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right],\n$$\n$$\nu'(x,t) = \\frac{p_a}{2\\rho_0 c}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right].\n$$\n该选项与从第一性原理推导出的压强解和速度解完全匹配。\n\n**结论：正确**\n\n**B.**\n$$\np'(x,t) = p_a \\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right), \\qquad u'(x,t) = 0.\n$$\n该选项表示一个没有相关速度场的、单一向右传播的压强波。\n我们来检查初始条件。在 $t=0$ 时：\n$p'(x,0) = p_a \\exp(-x^2/(2\\sigma^2))$。这与给定的压强初始条件匹配。\n$u'(x,0) = 0$。这与给定的速度初始条件匹配。\n现在，我们来检查控制方程。当 $u'(x,t)=0$ 时，第一个方程变为 $\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} = 0$，这意味着 $p'$ 不能依赖于 $x$。然而，所提出的 $p'$ 的解明显依赖于 $x$。因此，第一个偏微分方程被违背。第二个偏微分方程变为 $\\frac{\\partial p'}{\\partial t}=0$，这意味着 $p'$ 不能依赖于 $t$。这也与解矛盾。\n\n**结论：错误**\n\n**C.**\n$$\np'(x,t) = \\frac{p_a}{2}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right],\n$$\n$$\nu'(x,t) = \\frac{p_a}{2\\rho_0 c}\\left[\\exp\\!\\left(-\\frac{(x-ct)^2}{2\\sigma^2}\\right) + \\exp\\!\\left(-\\frac{(x+ct)^2}{2\\sigma^2}\\right)\\right].\n$$\n$p'(x,t)$ 的表达式是正确的。我们来检查 $u'(x,t)$ 的初始条件。在 $t=0$ 时：\n$u'(x,0) = \\frac{p_a}{2\\rho_0 c}\\left[\\exp(-x^2/(2\\sigma^2)) + \\exp(-x^2/(2\\sigma^2))\\right] = \\frac{p_a}{\\rho_0 c} \\exp(-x^2/(2\\sigma^2))$。\n这不等于所要求的初始条件 $u'(x,0) = 0$。\n\n**结论：错误**\n\n**D.**\n$$\np'(x,t) = p_a \\exp\\!\\left(-\\frac{x^2 + c^2 t^2}{2\\sigma^2}\\right), \\qquad u'(x,t) = \\frac{p_a}{\\rho_0 c}\\exp\\!\\left(-\\frac{x^2 + c^2 t^2}{2\\sigma^2}\\right).\n$$\n这个解代表一个驻波，而不是一个传播波。我们来检查速度的初始条件。在 $t=0$ 时：\n$u'(x,0) = \\frac{p_a}{\\rho_0 c}\\exp(-x^2/(2\\sigma^2))$。\n这不等于所要求的初始条件 $u'(x,0)=0$。\n\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理解了理想介质中的声波之后，我们必须考虑数值模型如何在离散的网格上表示它们。这项练习将连续的物理世界与离散的计算现实联系起来，要求您计算给定模型网格能够解析的最短波长和最高频率。掌握这项技能对于评估数值天气预报（NWP）模型的能力与局限性至关重要 。",
            "id": "4008729",
            "problem": "一个可压缩、非静力的数值天气预报 (NWP) 模型，用于解析在声速 $c$ 恒定的稳定分层、静止、均匀大气中的声波模态。考虑一个标量场 $p$ 所满足的线性声波方程 $\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\nabla^2 p$。该模型使用一个二维笛卡尔网格 $(x,z)$，其均匀间距为 $\\Delta x$ 和 $\\Delta z$。在空间上采用二阶中心差分，在时间上对内声学子步采用蛙跳格式，时间步长为 $\\Delta t_{a}$。假设边界为周期性边界，以便应用平面波分析。\n\n任务：\n1) 从线性声波方程和平面波拟设出发，建立声波的连续谱色散关系。然后，利用网格所隐含的采样约束，为模型的空间离散化能在此网格上表示的最短可解析声波波长 $\\lambda_{\\min}$ 推导一个解析表达式（仅用 $\\Delta x$ 和 $\\Delta z$ 表示）。您可以假设，可表示性要求每个分量波数都位于其一维 Shannon–Nyquist 区间内。\n\n2) 现取 $\\Delta x = 10\\,\\text{km}$，$\\Delta z = 0.25\\,\\text{km}$，$c = 340\\,\\text{m s}^{-1}$，以及 $\\Delta t_{a} = 0.50\\,\\text{s}$。使用您的结果，数值计算：\n- 最短可解析声波波长 $\\lambda_{\\min}$，以及\n- 最大可表示声学频率 $f_{\\max}$，其定义为空间奈奎斯特限制值和时间奈奎斯特值中的较小者。根据需要，使用角频率和波数之间的连续谱关系来连接频率和波长。将 $f_{\\max}$ 以赫兹(Hz)为单位表示。\n\n3) 根据您计算出的 $f_{\\max}$，简要评估此配置是否能够表示范围在 $0.01$–$20\\,\\text{Hz}$ 之间的典型次声信号。\n\n将 $f_{\\max}$ 的值（以赫兹(Hz)为单位，四舍五入到三位有效数字）作为您的最终方框答案。在中间步骤中，对任何角频率使用弧度，并确保所有中间符号步骤在最终数值评估前都将常数保持为符号形式。",
            "solution": "该问题陈述被评估为具有科学依据、自洽且良定的。为得出唯一且有意义的解所需的所有数据和定义均已提供。其背景是数值大气模拟中的一个标准（尽管是简化的）场景，基于波动力学和数值分析的基本原理。因此，该问题是有效的。\n\n**1) 连续谱色散关系和最短可解析波长 ($\\lambda_{\\min}$)**\n\n线性声波的控制方程如下：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\nabla^2 p\n$$\n在二维笛卡尔坐标系 $(x, z)$ 中，拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial z^2}$。方程变为：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = c^2 \\left( \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial z^2} \\right)\n$$\n我们假设解具有平面波拟设形式 $p(x, z, t) = p_0 \\exp(i(k_x x + k_z z - \\omega t))$，其中 $k_x$ 和 $k_z$ 分别是 $x$ 和 $z$ 方向的波数，$\\omega$ 是角频率。\n\n为求得连续谱色散关系，我们将拟设代入波动方程。首先，我们计算必要的偏导数：\n$$\n\\frac{\\partial^2 p}{\\partial t^2} = (-i\\omega)^2 p = -\\omega^2 p\n$$\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = (ik_x)^2 p = -k_x^2 p\n$$\n$$\n\\frac{\\partial^2 p}{\\partial z^2} = (ik_z)^2 p = -k_z^2 p\n$$\n将这些代入波动方程得到：\n$$\n-\\omega^2 p = c^2 (-k_x^2 p - k_z^2 p) = -c^2 (k_x^2 + k_z^2) p\n$$\n两边同除以 $-p$（因为 $p$ 不恒为零），我们得到连续谱色散关系：\n$$\n\\omega^2 = c^2 (k_x^2 + k_z^2)\n$$\n假设频率为非负，则 $\\omega = c \\sqrt{k_x^2 + k_z^2}$。总波矢的模为 $k = \\sqrt{k_x^2 + k_z^2}$，因此该关系可写为 $\\omega = c k$。\n\n接下来，我们确定最短可解析声波波长 $\\lambda_{\\min}$。根据 Shannon-Nyquist 采样定理，如果一个波的波数分量位于区间 $[-\\pi/\\Delta s, \\pi/\\Delta s]$ 内，则该波在间距为 $\\Delta s$ 的网格上是可解析的。最大可表示波数（即奈奎斯特波数）为 $k_N = \\pi/\\Delta s$，对应波长为 $2\\Delta s$。\n\n对于给定的间距为 $\\Delta x$ 和 $\\Delta z$ 的二维网格，最大可表示分量波数为：\n$$\n|k_x|_{\\max} = \\frac{\\pi}{\\Delta x}\n$$\n$$\n|k_z|_{\\max} = \\frac{\\pi}{\\Delta z}\n$$\n最短波长 $\\lambda_{\\min}$ 对应于总波矢的最大可能模 $k_{\\max}$。这种情况发生在波的分量波数都达到其最大值时：\n$$\nk_{\\max} = \\sqrt{(|k_x|_{\\max})^2 + (|k_z|_{\\max})^2} = \\sqrt{\\left(\\frac{\\pi}{\\Delta x}\\right)^2 + \\left(\\frac{\\pi}{\\Delta z}\\right)^2} = \\pi \\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta z)^2}}\n$$\n波长 $\\lambda$ 和波数 $k$ 之间的关系是 $\\lambda = 2\\pi/k$。因此，最短可解析波长为：\n$$\n\\lambda_{\\min} = \\frac{2\\pi}{k_{\\max}} = \\frac{2\\pi}{\\pi \\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta z)^2}}} = \\frac{2}{\\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta z)^2}}}\n$$\n这就是 $\\lambda_{\\min}$ 用 $\\Delta x$ 和 $\\Delta z$ 表示的解析表达式。\n\n**2) 数值计算**\n\n给定以下数值：\n$\\Delta x = 10\\,\\text{km} = 10000\\,\\text{m}$\n$\\Delta z = 0.25\\,\\text{km} = 250\\,\\text{m}$\n$c = 340\\,\\text{m s}^{-1}$\n$\\Delta t_{a} = 0.50\\,\\text{s}$\n\n首先，我们计算 $\\lambda_{\\min}$：\n$$\n\\lambda_{\\min} = \\frac{2}{\\sqrt{\\frac{1}{(10000\\,\\text{m})^2} + \\frac{1}{(250\\,\\text{m})^2}}} = \\frac{2}{\\sqrt{1 \\times 10^{-8}\\,\\text{m}^{-2} + 1.6 \\times 10^{-5}\\,\\text{m}^{-2}}}\n$$\n$$\n\\lambda_{\\min} = \\frac{2}{\\sqrt{1.601 \\times 10^{-5}\\,\\text{m}^{-2}}} \\approx \\frac{2}{0.00400125\\,\\text{m}^{-1}} \\approx 499.84\\,\\text{m}\n$$\n最短可解析声波波长约为 $499.84\\,\\text{m}$。\n\n接下来，我们计算最大可表示声学频率 $f_{\\max}$，其定义为空间奈奎斯特限制频率 ($f_{\\text{spatial}}$) 和时间奈奎斯特频率 ($f_{\\text{temporal}}$) 中的较小者。\n\n空间奈奎斯特限制频率是具有最短可解析波长 $\\lambda_{\\min}$ 的波的频率，由连续谱色散关系 $f = c/\\lambda$ 确定：\n$$\nf_{\\text{spatial}} = \\frac{c}{\\lambda_{\\min}} = \\frac{340\\,\\text{m s}^{-1}}{499.84\\,\\text{m}} \\approx 0.6802\\,\\text{Hz}\n$$\n时间奈奎斯特频率由时间步长 $\\Delta t_a$ 决定：\n$$\nf_{\\text{temporal}} = \\frac{1}{2\\Delta t_a} = \\frac{1}{2 \\times 0.50\\,\\text{s}} = \\frac{1}{1.0\\,\\text{s}} = 1.0\\,\\text{Hz}\n$$\n最大可表示频率是这两个值中的较小者：\n$$\nf_{\\max} = \\min(f_{\\text{spatial}}, f_{\\text{temporal}}) = \\min(0.6802\\,\\text{Hz}, 1.0\\,\\text{Hz}) = 0.6802\\,\\text{Hz}\n$$\n\n**3) 次声表示能力的评估**\n\n典型次声信号的指定范围是 $0.01$–$20\\,\\text{Hz}$。对于给定的模型配置，计算出的最大可解析频率为 $f_{\\max} \\approx 0.680\\,\\text{Hz}$。\n\n这表明该模型配置只能表示次声频谱的较低部分，具体来说是从 $0.01\\,\\text{Hz}$ 到约 $0.680\\,\\text{Hz}$ 的频率。它无法表示任何频率高于此限制的次声信号，而这包括了指定的 $0.01$–$20\\,\\text{Hz}$ 范围的大部分。空间分辨率，尤其是垂直方向（$\\Delta z$）的分辨率，是该模型解析高频声波能力的限制因素。\n\n最终要求的答案是将 $f_{\\max}$ 四舍五入到三位有效数字。\n$f_{\\max} \\approx 0.680\\,\\text{Hz}$。",
            "answer": "$$\\boxed{0.680}$$"
        },
        {
            "introduction": "由于声波传播速度极快，根据 Courant-Friedrichs-Lewy (CFL) 条件，其在数值模型中对时间步长有非常严格的限制，从而带来了巨大的计算挑战。这项高级练习将挑战您分析和比较不同时间积分方案（完全显式、分裂显式和半隐式）的计算成本与稳定性。掌握这种分析能力是理解现代大气模型设计选择及其计算性能的关键 。",
            "id": "4008686",
            "problem": "一个非静力、完全可压缩的区域数值天气预报（NWP）模式被配置在笛卡尔网格上，其水平间距为 $\\Delta x = 4000\\,\\mathrm{m}$ 和 $\\Delta y = 4000\\,\\mathrm{m}$，近地表垂直间距为 $\\Delta z = 200\\,\\mathrm{m}$。该流场的特征是最大水平风速 $U_{\\max} = 60\\,\\mathrm{m\\,s^{-1}}$ 和最大垂直风速 $W_{\\max} = 5\\,\\mathrm{m\\,s^{-1}}$。声速为 $c = 340\\,\\mathrm{m\\,s^{-1}}$。该模式使用三种时间积分方案之一来推进动力学过程，这些方案侧重于处理声波模式：完全显式、分裂显式和半隐式。\n\n假设快波更新在空间和时间上使用二阶中心有限差分。对于显式方案的稳定性，考虑三维声波方程的 Courant–Friedrichs–Lewy (CFL) 条件；对于以重力波为主导的外时间步，使用浅水理论和等效深度 $H_{\\mathrm{eff}} = 10000\\,\\mathrm{m}$ 来近似外部重力波速，得到 $c_g = \\sqrt{g H_{\\mathrm{eff}}}$，其中 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。在分裂显式方案中，声波项在一个推进慢项的外时间步内，通过 $n$ 个均匀的内子步进行积分。在半隐式方案中，声波项在外时间步中通过求解一个椭圆 Helmholtz 型问题来进行隐式处理。\n\n使用以下成本模型来比较在固定模拟时长 $T = 3600\\,\\mathrm{s}$ 内的计算成本：\n- 一个完全显式小步长的成本为 $1$ 个单位。\n- 在分裂显式中，一个声波内子步的成本为 $\\beta$ 个单位（其中 $0  \\beta \\le 1$），每个外时间步的外圈慢项更新成本为 $1$ 个单位。\n- 在半隐式中，一个外时间步（包括声波项的隐式求解）的成本为 $\\alpha$ 个单位（其中 $\\alpha  0$）。\n\n仅使用基于线性波动力学和给定稳定性约束的第一性原理推导，确定完全显式方法的声波时间步长限制，分裂显式和半隐式方案中受重力波限制的外时间步长，分裂显式方案中每个外时间步所需的声波内子步数 $n$，并推导出在此配置下，分裂显式和半隐式方案比完全显式方案计算成本更低的 $\\beta$ 和 $\\alpha$ 的阈值条件。然后，选择最能准确描述计算成本和稳定性余量的定量比较的选项。\n\nA. 完全显式方案产生一个声波限制的时间步长，约为 $\\Delta t_{\\mathrm{FE}} \\approx 0.59\\,\\mathrm{s}$。分裂显式和半隐式方案可以使用一个受外部重力波限制的外时间步长，约为 $\\Delta t_{\\mathrm{out}} \\approx 12.8\\,\\mathrm{s}$。每个外时间步的声波内子步数为 $n \\approx 22$。分裂显式方案比完全显式方案计算成本更低的充要条件是 $\\beta  1 - \\frac{1}{n} \\approx 0.955$，而半隐式方案比完全显式方案计算成本更低的充要条件是 $\\alpha  n \\approx 21.8$。半隐式方案对声波模式是无条件稳定的；完全显式方案有一个由三维 CFL 条件设定的狭窄的声波稳定性余量；分裂显式方案通过内循环的微步长来实现声波稳定性，同时允许使用更大的、受重力波限制的外时间步。\n\nB. 完全显式方案产生一个声波限制的时间步长，约为 $\\Delta t_{\\mathrm{FE}} \\approx 0.59\\,\\mathrm{s}$。分裂显式和半隐式方案可以使用一个纯粹受平流限制的外时间步长，约为 $\\Delta t_{\\mathrm{out}} \\approx 62.5\\,\\mathrm{s}$，得到 $n \\approx 106$。如果 $\\beta  0.99$，分裂显式方案比完全显式方案成本更低；如果 $\\alpha  106$，半隐式方案成本更低。所有三种方法具有相同的声波稳定性余量。\n\nC. 完全显式方案产生一个声波限制的时间步长，约为 $\\Delta t_{\\mathrm{FE}} \\approx 11.8\\,\\mathrm{s}$。分裂显式和半隐式方案的外时间步长约为 $\\Delta t_{\\mathrm{out}} \\approx 12.8\\,\\mathrm{s}$，其中 $n \\approx 1.08$。仅当 $\\beta  0.074$ 时，分裂显式方案才比完全显式方案成本更低；仅当 $\\alpha  1.08$ 时，半隐式方案才成本更低。半隐式方案对声波是有条件稳定的。\n\nD. 完全显式方案产生一个声波限制的时间步长，约为 $\\Delta t_{\\mathrm{FE}} \\approx 0.59\\,\\mathrm{s}$。分裂显式和半隐式方案的外时间步长约为 $\\Delta t_{\\mathrm{out}} \\approx 12.8\\,\\mathrm{s}$，其中 $n \\approx 22$。仅当 $\\beta  0.05$ 时，分裂显式方案才比完全显式方案成本更低；仅当 $\\alpha  5$ 时，半隐式方案才成本更低。完全显式和半隐式方案具有相似的声波稳定性余量。",
            "solution": "我们从在均匀静止状态附近线性化的可压缩欧拉方程开始。压力和速度扰动的线性化声波动力学可简化为关于一个合适的声学变量 $q$ 的三维波动方程：\n$$\n\\frac{\\partial^2 q}{\\partial t^2} = c^2 \\left( \\frac{\\partial^2 q}{\\partial x^2} + \\frac{\\partial^2 q}{\\partial y^2} + \\frac{\\partial^2 q}{\\partial z^2} \\right),\n$$\n其中 $c$ 是声速。对于空间和时间上的二阶中心有限差分，对显式方案进行标准的 von Neumann 稳定性分析，得出多维 Courant–Friedrichs–Lewy (CFL) 要求\n$$\n\\sigma_x^2 + \\sigma_y^2 + \\sigma_z^2 \\le 1, \\quad \\text{其中} \\quad \\sigma_x = \\frac{c \\Delta t}{\\Delta x}, \\quad \\sigma_y = \\frac{c \\Delta t}{\\Delta y}, \\quad \\sigma_z = \\frac{c \\Delta t}{\\Delta z}.\n$$\n这导致了显式声波时间步长限制\n$$\n\\Delta t_{\\mathrm{FE}} \\le \\frac{1}{c} \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} \\right)^{-1/2}.\n$$\n根据 $\\Delta x = 4000\\,\\mathrm{m}$，$\\Delta y = 4000\\,\\mathrm{m}$，$\\Delta z = 200\\,\\mathrm{m}$，以及 $c = 340\\,\\mathrm{m\\,s^{-1}}$，我们计算\n$$\n\\frac{1}{\\Delta x^2} = \\frac{1}{(4000\\,\\mathrm{m})^2} = 6.25\\times 10^{-8}\\,\\mathrm{m^{-2}}, \\quad \\frac{1}{\\Delta y^2} = 6.25\\times 10^{-8}\\,\\mathrm{m^{-2}}, \\quad \\frac{1}{\\Delta z^2} = \\frac{1}{(200\\,\\mathrm{m})^2} = 2.5\\times 10^{-5}\\,\\mathrm{m^{-2}}.\n$$\n因此\n$$\nS \\equiv \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} = 2.5\\times 10^{-5} + 1.25\\times 10^{-7} = 2.5125\\times 10^{-5}\\,\\mathrm{m^{-2}},\n$$\n且\n$$\n\\left( S \\right)^{-1/2} \\approx \\frac{1}{\\sqrt{2.5125\\times 10^{-5}}} \\approx 199.5\\,\\mathrm{m}.\n$$\n因此\n$$\n\\Delta t_{\\mathrm{FE}} \\approx \\frac{199.5\\,\\mathrm{m}}{340\\,\\mathrm{m\\,s^{-1}}} \\approx 0.587\\,\\mathrm{s}.\n$$\n\n对于分裂显式和半隐式方案中的外时间步，最具限制性的、显式处理的快速水平波通常源于外部重力波。用浅水理论近似外模重力波速，可得\n$$\nc_g = \\sqrt{g H_{\\mathrm{eff}}},\n$$\n其中 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$ 且 $H_{\\mathrm{eff}} = 10000\\,\\mathrm{m}$，得到\n$$\nc_g = \\sqrt{9.81\\,\\mathrm{m\\,s^{-2}} \\times 10000\\,\\mathrm{m}} = \\sqrt{98100}\\,\\mathrm{m\\,s^{-1}} \\approx 313\\,\\mathrm{m\\,s^{-1}}.\n$$\n对于沿一个坐标方向应用的一维显式稳定性约束，\n$$\n\\Delta t_{\\mathrm{out}} \\le \\frac{\\Delta x}{c_g} = \\frac{4000\\,\\mathrm{m}}{313\\,\\mathrm{m\\,s^{-1}}} \\approx 12.78\\,\\mathrm{s}.\n$$\n这个重力波限制远比平流限制 $\\Delta t \\le \\min\\{\\Delta x/U_{\\max}, \\Delta z/W_{\\max}\\} = \\min\\{4000/60, 200/5\\}\\,\\mathrm{s} = \\min\\{66.67, 40\\}\\,\\mathrm{s} = 40\\,\\mathrm{s}$ 更严格，因此在此配置中，是重力波而非平流决定了外时间步。\n\n在分裂显式方案中，每个外时间步的声波内子步数为\n$$\nn = \\left\\lceil \\frac{\\Delta t_{\\mathrm{out}}}{\\Delta t_{\\mathrm{FE}}} \\right\\rceil \\approx \\left\\lceil \\frac{12.78\\,\\mathrm{s}}{0.587\\,\\mathrm{s}} \\right\\rceil \\approx \\lceil 21.77 \\rceil = 22.\n$$\n为了在固定的模拟时长 $T = 3600\\,\\mathrm{s}$ 内比较成本，完全显式方案的步数为\n$$\nN_{\\mathrm{FE}} = \\frac{T}{\\Delta t_{\\mathrm{FE}}} \\approx \\frac{3600\\,\\mathrm{s}}{0.587\\,\\mathrm{s}} \\approx 6133,\n$$\n而分裂显式或半隐式方案的外时间步数为\n$$\nN_{\\mathrm{out}} = \\frac{T}{\\Delta t_{\\mathrm{out}}} \\approx \\frac{3600\\,\\mathrm{s}}{12.78\\,\\mathrm{s}} \\approx 282.\n$$\n完全显式方案的总成本为\n$$\nC_{\\mathrm{FE}} = N_{\\mathrm{FE}} \\times 1 \\approx 6133.\n$$\n分裂显式方案的总成本为\n$$\nC_{\\mathrm{SE}} = N_{\\mathrm{out}} \\left( 1 + \\beta n \\right),\n$$\n半隐式方案的总成本为\n$$\nC_{\\mathrm{SI}} = N_{\\mathrm{out}} \\alpha.\n$$\n分裂显式方案比完全显式方案成本更低的充要条件是 $C_{\\mathrm{SE}}  C_{\\mathrm{FE}}$，即\n$$\nN_{\\mathrm{out}} (1 + \\beta n)  N_{\\mathrm{FE}} \\quad \\Longleftrightarrow \\quad 1 + \\beta n  \\frac{N_{\\mathrm{FE}}}{N_{\\mathrm{out}}}.\n$$\n但 $\\frac{N_{\\mathrm{FE}}}{N_{\\mathrm{out}}} = \\frac{T/\\Delta t_{\\mathrm{FE}}}{T/\\Delta t_{\\mathrm{out}}} = \\frac{\\Delta t_{\\mathrm{out}}}{\\Delta t_{\\mathrm{FE}}} \\approx 21.77 \\approx n$ （取决于向上取整）。使用连续比率，\n$$\n1 + \\beta n  n \\quad \\Longleftrightarrow \\quad \\beta  1 - \\frac{1}{n}.\n$$\n当 $n \\approx 22$ 时，阈值为\n$$\n\\beta  1 - \\frac{1}{22} \\approx 0.955.\n$$\n因此，只要声波内子步的成本比一个完整的显式步长至少便宜百分之几（即 $\\beta \\lesssim 0.95$），对于当前参数，分裂显式方案就能相对于完全显式方案降低成本。\n\n半隐式方案比完全显式方案成本更低的充要条件是 $C_{\\mathrm{SI}}  C_{\\mathrm{FE}}$，即\n$$\nN_{\\mathrm{out}} \\alpha  N_{\\mathrm{FE}} \\quad \\Longleftrightarrow \\quad \\alpha  \\frac{N_{\\mathrm{FE}}}{N_{\\mathrm{out}}} \\approx \\frac{\\Delta t_{\\mathrm{out}}}{\\Delta t_{\\mathrm{FE}}} \\approx n \\approx 21.8.\n$$\n因此，只要每步隐式求解的成本低于大约 $n$ 个等效的显式步长，半隐式方案的计算成本就比完全显式方案低，这对于良好预条件的迭代求解器（例如，$\\alpha \\sim 5$–$10$）通常是满足的。关于稳定性余量，半隐式方案根据其构造对声波是无条件稳定的，完全显式方案受三维声波 CFL 条件的约束，导致了狭窄的时间步长 $\\Delta t_{\\mathrm{FE}} \\sim 0.6\\,\\mathrm{s}$，而分裂显式方案通过 $n$ 个微步长实现声波稳定性，同时允许使用更大的、受重力波限制的外时间步长 $\\Delta t_{\\mathrm{out}} \\sim 12.8\\,\\mathrm{s}$。\n\n逐项分析：\n- 选项A：陈述了 $\\Delta t_{\\mathrm{FE}} \\approx 0.59\\,\\mathrm{s}$，$\\Delta t_{\\mathrm{out}} \\approx 12.8\\,\\mathrm{s}$，$n \\approx 22$，分裂显式方案更便宜的阈值 $\\beta  1 - 1/n \\approx 0.955$，以及半隐式方案更便宜的阈值 $\\alpha  n \\approx 21.8$，并给出了正确的稳定性特征描述。所有这些都直接从上述推导中得出。结论：正确。\n\n- 选项B：声称 $\\Delta t_{\\mathrm{out}} \\approx 62.5\\,\\mathrm{s}$ 是基于平流而非重力波。然而，对于给定参数，外部重力波限制 $\\Delta t_{\\mathrm{out}} = \\Delta x / c_g \\approx 12.78\\,\\mathrm{s}$ 更为严格；因此 $n$ 和阈值被严重夸大，并且关于声波稳定性余量的说法不正确（这三种方法不具有相同的声波稳定性属性）。结论：不正确。\n\n- 选项C：声称 $\\Delta t_{\\mathrm{FE}} \\approx 11.8\\,\\mathrm{s}$，这与由精细的垂直间距主导的三维声波 CFL 推导出的限制 $\\Delta t_{\\mathrm{FE}} \\approx 0.587\\,\\mathrm{s}$ 相矛盾。因此，得出的 $n \\approx 1.08$ 和阈值条件是不正确的，并且半隐式方案对声波不是有条件稳定的。结论：不正确。\n\n- 选项D：报告了正确的 $\\Delta t_{\\mathrm{FE}}$、$\\Delta t_{\\mathrm{out}}$ 和 $n$，但给出了不正确的阈值 $\\beta  0.05$ 和 $\\alpha  5$，这些值并非从 $C_{\\mathrm{SE}}  C_{\\mathrm{FE}}$ 或 $C_{\\mathrm{SI}}  C_{\\mathrm{FE}}$ 推导而来；正确的阈值是 $\\beta  1 - 1/n \\approx 0.955$ 和 $\\alpha  n \\approx 21.8$。它还错误地断言完全显式和半隐式方案具有相似的声波稳定性余量。结论：不正确。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}