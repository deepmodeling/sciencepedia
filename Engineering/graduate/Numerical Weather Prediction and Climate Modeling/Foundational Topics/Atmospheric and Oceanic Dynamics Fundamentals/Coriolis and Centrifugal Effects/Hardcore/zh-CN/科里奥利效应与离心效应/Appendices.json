{
    "hands_on_practices": [
        {
            "introduction": "在大气动力学中，“平衡流”是一个关键概念，指的是作用在气块上的力几乎处于平衡状态。对于直线运动，这引出了地转风的概念。然而，对于具有显著曲率的流动，例如在气旋和反气旋中，向心加速度变得至关重要。本练习要求您从第一性原理出发，推导梯度风平衡，结合气压梯度力、科里奥利力和离心效应，来计算圆形低压系统中的实际风速。",
            "id": "4027697",
            "problem": "在数值天气预报 (NWP) 和气候模拟的背景下，考虑一个位于恒定科里奥利参数平面 (f平面) 上的理想化、轴对称的圆形低压系统，其摩擦可忽略不计。假设流动是稳定的、水平无辐散的切向流，且空气密度是均匀的。该系统的外部半径为 $R = 200\\,\\mathrm{km}$，中心气压比外部环境值低 $\\Delta p = 30\\,\\mathrm{hPa}$。空气密度为 $\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$，科里奥利参数为 $f = 10^{-4}\\,\\mathrm{s}^{-1}$。将中心与半径 $R$ 之间的径向气压廓线视为线性，因此在半径 $R$ 处的径向气压梯度大小可近似为 $\\partial p/\\partial r \\approx \\Delta p / R$。仅使用第一性原理（旋转参考系中的牛顿第二定律、气压梯度力和科里奥利力）以及匀速圆周运动中向心加速度的要求，推导出控制平衡关系，并计算半径 $R$ 处的物理梯度风速 $V$。\n\n以 $\\mathrm{m\\,s}^{-1}$ 为单位表示您的最终速度，并将答案四舍五入到三位有效数字。",
            "solution": "首先验证该问题，以确保其科学基础扎实、提法恰当，并提供了所有必要信息。\n\n给定条件如下：\n- 系统：理想化的轴对称圆形低压系统。\n- 参考系：恒定科里奥利参数平面 (f平面)。\n- 动力学：摩擦可忽略不计，稳定流 ($\\partial/\\partial t = 0$)，水平无辐散的切向流。\n- 外部半径：$R = 200\\,\\mathrm{km}$。\n- 气压降：$\\Delta p = 30\\,\\mathrm{hPa}$。\n- 空气密度：$\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$。\n- 科里奥利参数：$f = 10^{-4}\\,\\mathrm{s}^{-1}$。\n- 气压梯度近似：在半径 $R$ 处，其大小为 $\\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{R}$。\n\n该问题是有效的。它描述了动力气象学中的一个标准物理模型（梯度风），使用了物理上合理的值，并且是自洽和适定的。我们可以继续进行求解。\n\n大气中流体质点的运动遵循旋转参考系中的牛顿第二定律。对于水平运动，单位质量的运动方程为：\n$$ \\frac{d\\vec{u}}{dt} = -\\frac{1}{\\rho}\\nabla_h p - f\\hat{k} \\times \\vec{u} $$\n其中 $\\vec{u}$ 是水平速度矢量，$\\frac{d\\vec{u}}{dt}$ 是质点的加速度，$-\\frac{1}{\\rho}\\nabla_h p$ 是单位质量的水平气压梯度力 (PGF)，而 $-f\\hat{k} \\times \\vec{u}$ 是单位质量的科里奥利力。题目说明摩擦力可以忽略不计。\n\n题目指定了稳定的切向流，这在柱坐标系 $(r, \\theta, z)$ 中可以表示为 $\\vec{u} = V\\hat{\\theta}$，其中 $V$ 是切向风速，并且仅是半径 $r$ 的函数。对于做匀速圆周运动的质点，加速度项 $\\frac{d\\vec{u}}{dt}$ 是向心加速度 $\\vec{a}_c$，方向径向朝内：\n$$ \\vec{a}_c = -\\frac{V^2}{r}\\hat{r} $$\n对于轴对称系统，气压梯度是纯径向的，所以 $\\nabla_h p = \\frac{\\partial p}{\\partial r}\\hat{r}$。因此，气压梯度力 (PGF) 为：\n$$ -\\frac{1}{\\rho}\\nabla_h p = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\hat{r} $$\n对于低压系统，气压随半径增加，所以 $\\frac{\\partial p}{\\partial r} > 0$，气压梯度力方向径向朝内（在 $-\\hat{r}$ 方向）。\n\n科里奥利力项为：\n$$ -f\\hat{k} \\times \\vec{u} = -f\\hat{k} \\times (V\\hat{\\theta}) $$\n在柱坐标系中使用叉积的右手定则，$\\hat{k} \\times \\hat{\\theta} = -\\hat{r}$。因此，科里奥利力为：\n$$ -fV(-\\hat{r}) = fV\\hat{r} $$\n对于北半球的气旋性低压，我们假设 $f > 0$ 且流动是逆时针方向的，$V > 0$。科里奥利力方向径向朝外（在 $+\\hat{r}$ 方向）。\n\n将这些矢量分量代入运动方程：\n$$ -\\frac{V^2}{r}\\hat{r} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\hat{r} + fV\\hat{r} $$\n令径向 ($\\hat{r}$) 上的标量分量相等，得到气旋性流动的梯度风方程：\n$$ -\\frac{V^2}{r} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} + fV $$\n这个方程可以重新排列以显示力的平衡，其中向内的气压梯度力由向外的科里奥利力和离心力（在旋转坐标系中）之和来平衡：\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{V^2}{r} + fV $$\n我们需要求解半径 $r=R$ 处的风速 $V$。我们可以将该方程重写为关于 $V$ 的标准二次方程：\n$$ \\frac{1}{R}V^2 + fV - \\frac{1}{\\rho}\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R} = 0 $$\n题目提供了在 $r=R$ 处气压梯度大小的近似值：$\\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{R}$。将其代入方程：\n$$ \\frac{1}{R}V^2 + fV - \\frac{\\Delta p}{\\rho R} = 0 $$\n两边同乘以 $R$ 得：\n$$ V^2 + (fR)V - \\frac{\\Delta p}{\\rho} = 0 $$\n这是一个形式为 $a x^2 + b x + c = 0$ 的二次方程，其中 $x=V$，$a=1$，$b=fR$，$c = -\\frac{\\Delta p}{\\rho}$。解由二次方程求根公式给出：\n$$ V = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-fR \\pm \\sqrt{(fR)^2 - 4(1)(-\\frac{\\Delta p}{\\rho})}}{2} $$\n$$ V = \\frac{-fR \\pm \\sqrt{(fR)^2 + \\frac{4\\Delta p}{\\rho}}}{2} $$\n由于对于北半球的气旋系统，风速 $V$ 必须是一个正的物理量，我们必须选择正根，因为负根会得出 $V$ 的负值。\n$$ V = \\frac{-fR + \\sqrt{(fR)^2 + \\frac{4\\Delta p}{\\rho}}}{2} $$\n现在，我们代入给定的数值，确保所有单位都是国际单位制（SI）单位。\n$R = 200\\,\\mathrm{km} = 200 \\times 10^3\\,\\mathrm{m} = 2 \\times 10^5\\,\\mathrm{m}$。\n$\\Delta p = 30\\,\\mathrm{hPa} = 30 \\times 100\\,\\mathrm{Pa} = 3000\\,\\mathrm{Pa}$。\n$\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$。\n$f = 10^{-4}\\,\\mathrm{s}^{-1}$。\n\n首先，计算公式中的各项：\n项 $fR$：\n$$ fR = (10^{-4}\\,\\mathrm{s}^{-1}) \\times (2 \\times 10^5\\,\\mathrm{m}) = 20\\,\\mathrm{m\\,s}^{-1} $$\n项 $(fR)^2$：\n$$ (fR)^2 = (20\\,\\mathrm{m\\,s}^{-1})^2 = 400\\,\\mathrm{m^2\\,s^{-2}} $$\n项 $\\frac{4\\Delta p}{\\rho}$：\n$$ \\frac{4\\Delta p}{\\rho} = \\frac{4 \\times 3000\\,\\mathrm{Pa}}{1.2\\,\\mathrm{kg\\,m}^{-3}} = \\frac{12000}{1.2} \\,\\mathrm{m^2\\,s^{-2}} = 10000\\,\\mathrm{m^2\\,s^{-2}} $$\n现在，将这些值代回 $V$ 的表达式中：\n$$ V = \\frac{-20 + \\sqrt{400 + 10000}}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{-20 + \\sqrt{10400}}{2} \\,\\mathrm{m\\,s}^{-1} $$\n计算数值：\n$$ \\sqrt{10400} \\approx 101.98039\\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{-20 + 101.98039}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{81.98039}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V \\approx 40.9902\\,\\mathrm{m\\,s}^{-1} $$\n题目要求答案四舍五入到三位有效数字。\n$$ V \\approx 41.0\\,\\mathrm{m\\,s}^{-1} $$",
            "answer": "$$\\boxed{41.0}$$"
        },
        {
            "introduction": "近似在气象建模中至关重要，但理解其局限性也同样关键。本练习将通过一个具体案例，定量地展示在强热带气旋中误用忽略了曲率的地转近似会带来怎样的后果。通过为相同的强气压梯度计算梯度风和地转风，您将直接量化在高速急转的流动中忽略离心效应所产生的巨大误差，从而深刻理解其在此类天气系统中的重要性。",
            "id": "4027699",
            "problem": "一位数值天气预报 (NWP) 模型的开发者正在评估在一个强热带气旋的风眼墙中，忽略水平动量平衡中的离心曲率项所带来的后果。假设在纬度为 $\\phi$ 的 $f$-平面上，存在稳定、无粘性、水平、轴对称的流动，其等压线为圆形，具有代表性的曲率半径为 $R$。从均匀旋转参考系中的牛顿第二定律出发，推导围绕低压中心的气旋式流动的稳定梯度风速 $V_{\\text{grad}}$，用径向气压梯度和科里奥利参数表示。然后，推导忽略曲率项时得到的相应地转风速 $V_{\\text{geo}}$。最后，量化因忽略曲率而导致的百分比误差（表示为无单位的小数），定义为\n$$E \\equiv \\frac{|V_{\\text{geo}} - V_{\\text{grad}}|}{V_{\\text{grad}}}.$$\n使用以下代表强热带气旋风眼墙的科学上实际的参数，并视空气密度为常数：\n- 纬度 $\\phi = 20^{\\circ}$（角度以度为单位指定）。\n- 地球自转角速度 $\\Omega = 7.292 \\times 10^{-5}\\ \\text{s}^{-1}$。\n- 在 $\\Delta r = 3.0 \\times 10^{4}\\ \\text{m}$ 的距离上，向外的径向气压增加量为 $\\Delta p = 6.0 \\times 10^{3}\\ \\text{Pa}$，因此平均径向气压梯度大小为 $(\\partial p / \\partial r) \\approx \\Delta p / \\Delta r$。\n- 空气密度 $\\rho = 1.15\\ \\text{kg}\\ \\text{m}^{-3}$。\n- 代表性曲率半径 $R = 2.5 \\times 10^{4}\\ \\text{m}$。\n\n使用梯度风解的物理上合适的气旋分支来计算 $E$。将最终的百分比误差表示为无单位的小数。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，确认其在科学上成立、提法恰当、客观且内部一致。所提供的参数虽然代表了极端的气象事件，但在物理上是合理的。因此，我们可以进行推导和计算。\n\n在旋转参考系中，稳定、无粘性、轴对称流的水平动量平衡由牛顿第二定律描述。我们使用一个自然坐标系，其中径向坐标 $r$ 指向低压系统中心的外部。切向速度为 $V$。对于北半球（纬度 $\\phi > 0$）的气旋式流动，气流是逆时针方向的。\n\n径向运动方程平衡了气压梯度力 (PGF)、科里奥利力和气块的向心加速度。\n在径向上作用的单位质量力包括：\n1.  气压梯度力 (PGF)：$-\\frac{1}{\\rho} \\frac{\\partial p}{\\partial r}$。由于低压中心的气压向外增加，$\\frac{\\partial p}{\\partial r} > 0$，所以这个力指向内部（负 $r$ 方向）。\n2.  科里奥利力：$-f\\hat{k} \\times \\vec{v}$，其中 $f = 2\\Omega\\sin\\phi$ 是科里奥利参数，$\\hat{k}$ 是当地的垂直单位向量，$\\vec{v}$ 是水平速度向量。对于气旋式流动，$\\vec{v} = V\\hat{\\theta}$。科里奥利力为 $-fV(\\hat{k} \\times \\hat{\\theta}) = -fV(-\\hat{r}) = fV\\hat{r}$。这个力指向外部。\n\n气块的加速度是向心加速度，指向曲率中心。其大小为 $\\frac{V^2}{R}$，其中 $R$ 是曲率半径。在我们的坐标系中，这个加速度是 $-\\frac{V^2}{R}\\hat{r}$。\n\n在径向上应用牛顿第二定律（$\\sum \\vec{F}/m = \\vec{a}$）：\n$$ -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} + fV = -\\frac{V^2}{R} $$\n这个方程代表了梯度风平衡。整理后得到：\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = fV + \\frac{V^2}{R} $$\n为了求得梯度风速 $V_{\\text{grad}}$，我们求解以下二次方程：\n$$ \\frac{1}{R}V_{\\text{grad}}^2 + fV_{\\text{grad}} - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = 0 $$\n使用二次公式 $V_{\\text{grad}} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a = 1/R$，$b = f$，以及 $c = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}$：\n$$ V_{\\text{grad}} = \\frac{-f \\pm \\sqrt{f^2 - 4\\left(\\frac{1}{R}\\right)\\left(-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\right)}}{2/R} $$\n$$ V_{\\text{grad}} = -\\frac{fR}{2} \\pm \\sqrt{\\frac{f^2R^2}{4} + \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r}} $$\n为了得到物理上有意义的正风速（$V_{\\text{grad}} > 0$），我们必须选择正号，因为平方根下的项大于 $\\frac{fR}{2}$。这是解的气旋分支。\n$$ V_{\\text{grad}} = -\\frac{fR}{2} + \\sqrt{\\frac{f^2R^2}{4} + \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r}} $$\n接下来，我们推导地转风速 $V_{\\text{geo}}$。这是通过在动量平衡中忽略曲率（向心加速度）项 $\\frac{V^2}{R}$ 得到的。这个近似对于曲率小的大尺度流动是有效的，但在这里应用它是题目的一个要求步骤。\n$$ fV_{\\text{geo}} = \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} $$\n$$ V_{\\text{geo}} = \\frac{1}{\\rho f}\\frac{\\partial p}{\\partial r} $$\n现在我们计算数值。首先，我们根据给定的数据计算所需的物理参数：\n- 纬度 $\\phi = 20^{\\circ}$\n- 地球自转角速度 $\\Omega = 7.292 \\times 10^{-5}\\ \\text{s}^{-1}$\n- 在 $\\Delta r = 3.0 \\times 10^{4}\\ \\text{m}$ 的距离上，向外的径向气压增加量为 $\\Delta p = 6.0 \\times 10^{3}\\ \\text{Pa}$\n- 空气密度 $\\rho = 1.15\\ \\text{kg}\\ \\text{m}^{-3}$\n- 曲率半径 $R = 2.5 \\times 10^{4}\\ \\text{m}$\n\n科里奥利参数 $f$ 是：\n$$ f = 2\\Omega\\sin\\phi = 2(7.292 \\times 10^{-5}\\ \\text{s}^{-1})\\sin(20^{\\circ}) \\approx 4.9886 \\times 10^{-5}\\ \\text{s}^{-1} $$\n气压梯度的大小近似为：\n$$ \\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{\\Delta r} = \\frac{6.0 \\times 10^{3}\\ \\text{Pa}}{3.0 \\times 10^{4}\\ \\text{m}} = 0.2\\ \\text{Pa}\\ \\text{m}^{-1} $$\n单位质量的 PGF 项是：\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{0.2\\ \\text{Pa}\\ \\text{m}^{-1}}{1.15\\ \\text{kg}\\ \\text{m}^{-3}} \\approx 0.17391\\ \\text{m}\\ \\text{s}^{-2} $$\n现在我们计算地转风速 $V_{\\text{geo}}$：\n$$ V_{\\text{geo}} = \\frac{0.17391\\ \\text{m}\\ \\text{s}^{-2}}{4.9886 \\times 10^{-5}\\ \\text{s}^{-1}} \\approx 3486.44\\ \\text{m}\\ \\text{s}^{-1} $$\n这个极高且不符合物理实际的数值凸显了地转近似在像飓风风眼墙这样曲率大、强度高的气流中的不适用性。\n\n接下来，我们计算梯度风速 $V_{\\text{grad}}$。我们计算解中的各项：\n$$ \\frac{fR}{2} = \\frac{(4.9886 \\times 10^{-5}\\ \\text{s}^{-1})(2.5 \\times 10^{4}\\ \\text{m})}{2} \\approx 0.62358\\ \\text{m}\\ \\text{s}^{-1} $$\n$$ \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r} = (2.5 \\times 10^{4}\\ \\text{m})(0.17391\\ \\text{m}\\ \\text{s}^{-2}) \\approx 4347.83\\ \\text{m}^2\\ \\text{s}^{-2} $$\n$$ V_{\\text{grad}} = -0.62358 + \\sqrt{(0.62358)^2 + 4347.83} = -0.62358 + \\sqrt{0.38885 + 4347.83} $$\n$$ V_{\\text{grad}} = -0.62358 + \\sqrt{4348.22} \\approx -0.62358 + 65.9334 \\approx 65.310\\ \\text{m}\\ \\text{s}^{-1} $$\n这个值对于强热带气旋风眼墙中的风速是物理上现实的（大约 $235\\ \\text{km/h}$ 或 $146\\ \\text{mph}$）。\n\n最后，我们计算使用地转近似所产生的百分比误差，定义为 $E \\equiv \\frac{|V_{\\text{geo}} - V_{\\text{grad}}|}{V_{\\text{grad}}}$：\n$$ E = \\frac{|3486.44\\ \\text{m}\\ \\text{s}^{-1} - 65.310\\ \\text{m}\\ \\text{s}^{-1}|}{65.310\\ \\text{m}\\ \\text{s}^{-1}} = \\frac{3421.13}{65.310} \\approx 52.383 $$\n将结果四舍五入到四位有效数字，我们得到 $52.38$。",
            "answer": "$$\\boxed{5.238 \\times 10^1}$$"
        },
        {
            "introduction": "从解析方程到计算算法的过渡是数值天气预报的基石。这个动手编程练习专注于惯性振荡的数值积分，这是由科里奥利效应引起的最纯粹的流体运动。通过实现并测试不同的时间离散化方案，您将直接洞察数值方法的选择如何影响地球物理流体动力学模拟的准确性和稳定性，这是任何模型开发者都需具备的核心能力。",
            "id": "4027710",
            "problem": "考虑在均匀旋转参考系中，根据 Newton 第二定律推导出的，在无气压梯度和摩擦力情况下的恒定科里奥利参数平面（$f$平面）上控制惯性振荡的水平动量方程。使用东向速度 $u(t)$ 和北向速度 $v(t)$，以及一个恒定的科里奥利参数 $f$（物理单位为 $\\mathrm{s}^{-1}$），该控制方程组可以写成耦合常微分方程的形式。在这些假设下，运动是纯惯性的，并且存在一个已知的解析解，该解表现出速度矢量的周期性旋转，其角频率由 $f$ 决定。\n\n任务：\n1. 从 $f$平面上的水平动量方程出发，推导惯性振荡速度分量作为时间函数的解析解。所有角度以弧度表示，所有速度以米/秒（$\\mathrm{m\\,s}^{-1}$）表示。\n2. 为速度方程中的科里奥利项构建三种不同的时间离散化格式：\n   - 两层显式向前 Euler 方法。\n   - 三层蛙跳法（其第一步由向前 Euler 步初始化）。\n   - 两层隐式中点法（等同于 Crank-Nicolson 方法）。\n3. 对每种格式，实现一个数值时间积分，在均匀时间网格 $t_n = n\\,\\Delta t$（$n = 0, 1, \\ldots, N$）上推进解，其中 $\\Delta t$（单位：秒）是恒定的时间步长，$N$ 是步数。总积分时间为 $T = N\\,\\Delta t$（单位：秒）。\n4. 定义误差范数以根据解析解评估时间离散化的效果。令 $\\boldsymbol{w}(t) = (u(t), v(t))^\\top$ 表示精确的速度矢量，$\\boldsymbol{w}_n$ 表示在 $t_n$ 时刻通过数值积分得到的速度。对每个测试用例，计算以下时间离散误差度量：\n   - 时间离散 $L_2$ 范数：$$E_{L_2} = \\sqrt{\\frac{1}{N+1} \\sum_{n=0}^{N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2},$$ 以 $\\mathrm{m\\,s}^{-1}$ 表示。\n   - 时间离散 $L_\\infty$ 范数：$$E_{L_\\infty} = \\max_{0 \\leq n \\leq N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2,$$ 以 $\\mathrm{m\\,s}^{-1}$ 表示。\n   此处 $\\left\\lVert \\cdot \\right\\rVert_2$ 表示速度误差矢量的欧几里得范数，单位为 $\\mathrm{m\\,s}^{-1}$。\n5. 实现一个完整的、可运行的程序，对以下测试套件执行上述推导和计算。每个测试用例指定为一个元组 $(\\text{scheme}, f, u_0, v_0, \\Delta t, N)$，并标明了物理单位。所有角度必须解释为弧度，速度单位为 $\\mathrm{m\\,s}^{-1}$，时间单位为秒。\n   - 测试用例 1（理想情况，中等时间步长，显式向前 Euler）：$(\\text{\"FE\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 10\\ \\mathrm{m\\,s}^{-1}, 0\\ \\mathrm{m\\,s}^{-1}, 600\\ \\mathrm{s}, 120)$。\n   - 测试用例 2（隐式中点/Crank-Nicolson，粗略时间步长，多周期积分）：$(\\text{\"CN\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 7\\ \\mathrm{m\\,s}^{-1}, 5\\ \\mathrm{m\\,s}^{-1}, 3600\\ \\mathrm{s}, 200)$。\n   - 测试用例 3（蛙跳法，以向前 Euler 启动，长时间积分以揭示相位和计算模式行为）：$(\\text{\"LF\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, -3\\ \\mathrm{m\\,s}^{-1}, 8\\ \\mathrm{m\\,s}^{-1}, 1200\\ \\mathrm{s}, 1000)$。\n   - 测试用例 4（显式向前 Euler，大时间步长以探测稳定性限制）：$(\\text{\"FE\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 15\\ \\mathrm{m\\,s}^{-1}, -5\\ \\mathrm{m\\,s}^{-1}, 7200\\ \\mathrm{s}, 50)$。\n   - 测试用例 5（隐式中点/Crank-Nicolson，极小时间步长，近似连续行为）：$(\\text{\"CN\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 4\\ \\mathrm{m\\,s}^{-1}, -1\\ \\mathrm{m\\,s}^{-1}, 10\\ \\mathrm{s}, 10000)$。\n6. 你的程序必须生成单行输出，其中包含所有测试用例的误差范数，并合并到一个列表中。对于每个测试用例，先输出 $E_{L_2}$，然后输出 $E_{L_\\infty}$，两者均为十进制浮点数，单位为 $\\mathrm{m\\,s}^{-1}$。最终输出格式必须严格如下：\n   $$[\\text{E\\_L2\\_case1},\\text{E\\_Linf\\_case1},\\text{E\\_L2\\_case2},\\text{E\\_Linf\\_case2},\\ldots,\\text{E\\_L2\\_case5},\\text{E\\_Linf\\_case5}]$$\n不应打印任何额外文本，所有计算必须使用弧度作为角度单位，秒作为时间单位。",
            "solution": "本任务旨在分析惯性振荡的数值积分，该过程由恒定科里奥利参数平面（$f$平面）上的一组线性常微分方程（ODE）控制。分析内容包括推导解析解，实现三种不同的数值时间步进格式，并使用指定的误差范数根据解析解评估它们的准确性。\n\n**1. 解析解**\n\n在无气压梯度和摩擦力的情况下，控制水平动量方程为：\n$$\n\\frac{du}{dt} = f v \\quad (1)\n$$\n$$\n\\frac{dv}{dt} = -f u \\quad (2)\n$$\n此处，$u(t)$ 是东向速度，$v(t)$ 是北向速度，$f$ 是恒定的科里奥利参数。该方程组服从初始条件 $u(0)=u_0$ 和 $v(0)=v_0$。\n\n为求解该方程组，我们可以将方程 $(1)$ 对时间 $t$ 求导：\n$$\n\\frac{d^2u}{dt^2} = f \\frac{dv}{dt}\n$$\n将方程 $(2)$ 代入此结果，得到关于 $u(t)$ 的二阶齐次常微分方程：\n$$\n\\frac{d^2u}{dt^2} = f(-fu) = -f^2 u\n$$\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\n这是简谐振子方程。其通解为：\n$$\nu(t) = A \\cos(ft) + B \\sin(ft)\n$$\n其中 $A$ 和 $B$ 是由初始条件决定的常数。在 $t=0$ 时，我们有 $u(0) = u_0$，所以 $A = u_0$。因此：\n$$\nu(t) = u_0 \\cos(ft) + B \\sin(ft)\n$$\n为了求 $v(t)$，我们使用方程 $(1)$，$v = \\frac{1}{f} \\frac{du}{dt}$：\n$$\nv(t) = \\frac{1}{f} \\frac{d}{dt} \\left( u_0 \\cos(ft) + B \\sin(ft) \\right) = \\frac{1}{f} \\left( -u_0 f \\sin(ft) + B f \\cos(ft) \\right) = -u_0 \\sin(ft) + B \\cos(ft)\n$$\n在 $t=0$ 时应用初始条件 $v(0) = v_0$，我们得到 $B=v_0$。将 $B=v_0$ 代回 $u(t)$ 和 $v(t)$ 的表达式中，得到最终的解析解：\n$$\nu(t) = u_0 \\cos(ft) + v_0 \\sin(ft)\n$$\n$$\nv(t) = v_0 \\cos(ft) - u_0 \\sin(ft)\n$$\n该解描述了速度矢量 $(u,v)$ 以恒定速率 $\\sqrt{u_0^2 + v_0^2}$ 和角频率 $f$ 在一个圆上做顺时针旋转。\n\n**2. 数值离散化格式**\n\n我们将时间离散为 $t_n = n\\,\\Delta t$，$n=0, 1, \\ldots, N$。在时间 $t_n$ 的数值解记为 $(u_n, v_n)$。\n\n**2.1. 显式向前 Euler (FE) 格式**\n这种一阶显式格式使用向前差分来近似时间导数：\n$$\n\\frac{u_{n+1} - u_n}{\\Delta t} = f v_n \\implies u_{n+1} = u_n + f \\Delta t v_n\n$$\n$$\n\\frac{v_{n+1} - v_n}{\\Delta t} = -f u_n \\implies v_{n+1} = v_n - f \\Delta t u_n\n$$\n众所周知，该格式对于纯振荡系统是无条件不稳定的，因为数值能量在每个时间步都会被人为地增加。\n\n**2.2. 蛙跳 (LF) 格式**\n这是一种二阶、三层的显式格式，使用中心差分来处理时间导数：\n$$\n\\frac{u_{n+1} - u_{n-1}}{2 \\Delta t} = f v_n \\implies u_{n+1} = u_{n-1} + 2 f \\Delta t v_n\n$$\n$$\n\\frac{v_{n+1} - v_{n-1}}{2 \\Delta t} = -f u_n \\implies v_{n+1} = v_{n-1} - 2 f \\Delta t u_n\n$$\n作为一个三层格式，它需要一个启动步。我们使用一个向前 Euler 步从 $(u_0, v_0)$ 计算 $(u_1, v_1)$。该格式是条件稳定的，要求 $|f \\Delta t| \\leq 1$。\n\n**2.3. 隐式中点 (Crank-Nicolson, CN) 格式**\n这种二阶隐式格式在时间上使用中心差分，并将右侧项作为其在时间步 $n$ 和 $n+1$ 值的平均值进行评估：\n$$\n\\frac{u_{n+1} - u_n}{\\Delta t} = f \\left( \\frac{v_n + v_{n+1}}{2} \\right)\n$$\n$$\n\\frac{v_{n+1} - v_n}{\\Delta t} = -f \\left( \\frac{u_n + u_{n+1}}{2} \\right)\n$$\n为实现此方法，我们必须为 $(u_{n+1}, v_{n+1})$ 求解一个线性系统。令 $\\alpha = \\frac{f \\Delta t}{2}$。方程可重排为：\n$$\nu_{n+1} - \\alpha v_{n+1} = u_n + \\alpha v_n\n$$\n$$\n\\alpha u_{n+1} + v_{n+1} = v_n - \\alpha u_n\n$$\n求解这个关于 $(u_{n+1}, v_{n+1})$ 的 $2 \\times 2$ 系统，得到显式更新公式：\n$$\nu_{n+1} = \\frac{1}{1+\\alpha^2} \\left[ (1-\\alpha^2) u_n + 2\\alpha v_n \\right]\n$$\n$$\nv_{n+1} = \\frac{1}{1+\\alpha^2} \\left[ -2\\alpha u_n + (1-\\alpha^2) v_n \\right]\n$$\n该格式是无条件稳定的，并且能保持振荡的振幅，因此非常适合长时间积分。\n\n**3. 误差范数**\n\n每种数值格式的准确性通过在每个时间步 $t_n$ 比较数值解 $\\boldsymbol{w}_n = (u_n, v_n)^\\top$ 与解析解 $\\boldsymbol{w}(t_n) = (u(t_n), v(t_n))^\\top$ 来评估。\n\n时间离散 $L_2$ 范数，用于衡量整个积分过程中的均方根误差，定义为：\n$$\nE_{L_2} = \\sqrt{\\frac{1}{N+1} \\sum_{n=0}^{N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2}\n$$\n时间离散 $L_\\infty$ 范数，用于衡量任意时刻的最大误差，定义为：\n$$\nE_{L_\\infty} = \\max_{0 \\leq n \\leq N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2\n$$\n在这些定义中，$\\left\\lVert \\cdot \\right\\rVert_2$ 表示欧几里得矢量范数，因此 $\\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2 = (u_n - u(t_n))^2 + (v_n - v(t_n))^2$。\n\n该实现将通过首先根据所选格式生成数值解，然后将其与在相应时间点上求值的解析解进行比较，来为每个指定的测试用例计算这两种误差度量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically integrating inertial oscillations and calculating error norms.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (scheme, f, u0, v0, dt, N)\n    test_cases = [\n        (\"FE\", 1.0e-4, 10.0, 0.0, 600.0, 120),\n        (\"CN\", 1.0e-4, 7.0, 5.0, 3600.0, 200),\n        (\"LF\", 1.0e-4, -3.0, 8.0, 1200.0, 1000),\n        (\"FE\", 1.0e-4, 15.0, -5.0, 7200.0, 50),\n        (\"CN\", 1.0e-4, 4.0, -1.0, 10.0, 10000),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        scheme, f, u0, v0, dt, N = case\n\n        # Initialize arrays for the numerical solution\n        u_num = np.zeros(N + 1)\n        v_num = np.zeros(N + 1)\n        u_num[0], v_num[0] = u0, v0\n        \n        # --- Perform numerical integration based on the scheme ---\n        if scheme == \"FE\":\n            # Forward Euler\n            for n in range(N):\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = u_n + f * dt * v_n\n                v_num[n+1] = v_n - f * dt * u_n\n        \n        elif scheme == \"LF\":\n            # Leapfrog with a Forward Euler start step\n            # First step (n=0 to n=1) using FE\n            u_num[1] = u_num[0] + f * dt * v_num[0]\n            v_num[1] = v_num[0] - f * dt * u_num[0]\n            \n            # Main leapfrog loop (n=1 to N-1)\n            for n in range(1, N):\n                u_nm1, v_nm1 = u_num[n-1], v_num[n-1]\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = u_nm1 + 2 * f * dt * v_n\n                v_num[n+1] = v_nm1 - 2 * f * dt * u_n\n\n        elif scheme == \"CN\":\n            # Crank-Nicolson (Implicit Midpoint)\n            alpha = f * dt / 2.0\n            denom = 1.0 + alpha**2\n            c1 = (1.0 - alpha**2) / denom\n            c2 = (2.0 * alpha) / denom\n            \n            for n in range(N):\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = c1 * u_n + c2 * v_n\n                v_num[n+1] = -c2 * u_n + c1 * v_n\n\n        # --- Calculate Analytical Solution ---\n        t = np.arange(N + 1) * dt\n        cos_ft = np.cos(f * t)\n        sin_ft = np.sin(f * t)\n        \n        u_ana = u0 * cos_ft + v0 * sin_ft\n        v_ana = v0 * cos_ft - u0 * sin_ft\n\n        # --- Compute Error Norms ---\n        # Squared Euclidean norm of the error vector at each time step\n        # Note: np.nan_to_num handles potential overflows (e.g., in unstable FE case)\n        # by replacing inf with a very large number.\n        error_sq_norm = np.nan_to_num((u_num - u_ana)**2 + (v_num - v_ana)**2)\n        \n        # Time-discrete L2 norm\n        e_l2 = np.sqrt(np.mean(error_sq_norm))\n        \n        # Time-discrete L_infinity norm\n        e_linf = np.sqrt(np.max(error_sq_norm))\n        \n        results.extend([e_l2, e_linf])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}