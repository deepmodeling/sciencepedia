## 引言
[质量、动量和能量守恒](@entry_id:1122905)定律是经典物理学的基石，它们共同构成了描述大气和海洋等流体运动的完整框架。在[数值天气预报](@entry_id:191656)和气候模拟领域，这些普适的定律转化为具体的控制方程，成为我们理解和预测复杂地球系统的核心工具。然而，从抽象的物理原理到能够稳定运行并产出可靠预测的计算机模型，之间存在着深刻的理论与实践挑战。本文旨在填补这一鸿沟，系统性地阐释这些基本定律如何被应用于地球系统建模的各个层面。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。第一章“原理与机制”将深入探讨守恒定律的数学形式、物理内涵以及在大气科学中常见的关键近似。第二章“应用与跨学科联系”将展示这些定律如何解释从微观分子运动到全球气候能量平衡的广泛现象，并揭示其在多学科交叉领域的应用。最后，在“动手实践”部分，读者将有机会通过具体的编程练习，将理论知识转化为解决实际数值问题的能力。让我们首先从这些定律最基本的原理与机制开始，为构建复杂的大气模型奠定坚实的基础。

## 原理与机制

在上一章引言的基础上，本章深入探讨驱动大气运动的基本物理定律——质量、动量和能量守恒定律。我们将从这些定律最根本的积分形式出发，推导出适用于[流体动力学分析](@entry_id:268621)的[微分形式](@entry_id:146747)，并探讨它们在[旋转坐标系](@entry_id:170324)下的表达。此外，本章还将阐明在数值天气预报和气候模拟中至关重要的一些核心概念和近似，如流体连续性假设、[静力平衡近似](@entry_id:1126281)以及在简化模型中维持能量守恒的机制。理解这些原理与机制是构建和诠释复杂大气模型的基础。

### 大气连续介质模型的基础

大气本质上是由离散的分子组成的，但在我们关心的天气和气候尺度上，将其视为一个连续的、无间断的介质是极其有效且必要的。这一处理方式的理论基石是**连续介质假设**。该假设的有效性取决于我们所研究的特征尺度与[分子尺](@entry_id:166706)度的对比关系。

具体而言，连续介质假设要求我们定义的流体微元（例如，在数值模型中，一个网格单元）的特征长度尺度 $L$ 必须远大于气体分子的**平均自由程** $\lambda$。平均自由程指的是分子在与其他分子发生碰撞之前平均走过的距离。这个无量纲的比值被称为**克努森数**（Knudsen number），定义为 $Kn = \lambda / L$。当 $Kn \ll 1$ 时，流体微元内部包含了足够多的分子，使得分子间的频繁碰撞能够迅速将宏观属性（如密度、速度、温度）平均化，从而可以在空间和时间上定义这些属性的光滑变化的场。此时，用[偏微分](@entry_id:194612)方程来描述这些场的演化是合理的。

在大气科学中，我们可以定量地验证这一假设。在标准海平面条件下（压强 $p \approx 10^5 \ \mathrm{Pa}$），空气分子的平均自由程 $\lambda$ 约为 $7 \times 10^{-8} \ \mathrm{m}$。即便在高空，例如压强降至 $10^4 \ \mathrm{Pa}$ 的对流层上部，平均自由程也仅增大到约 $7 \times 10^{-7} \ \mathrm{m}$。相比之下，现代[数值天气预报](@entry_id:191656)（NWP）模型的水平分辨率 $L$ 通常在 $10^3 \ \mathrm{m}$ 到 $10^4 \ \mathrm{m}$ 的量级，垂直分辨率则在 $10^2 \ \mathrm{m}$ 的量级。因此，对于典型的NWP模型，克努森数 $Kn$ 的范围大约在 $10^{-11}$ 到 $10^{-8}$ 之间。这些值远小于 $1$，充分表明将大气处理为连续介质并应用质量、动量和能量守恒的[偏微分](@entry_id:194612)方程是完全成立的 。

### 控制体视角：积分形式的守恒定律

在建立流体运动的控制方程时，最基本、最物理的出发点是考察一个空间中固定的区域——**欧拉控制体**（Eulerian control volume）——内部物理量的变化。这种视角直接对应于数值模型中的[有限体积法](@entry_id:141374)，即通过[计算物质](@entry_id:185051)和能量跨越网格边界的通量来更新网格内的物理量状态。

#### [质量守恒](@entry_id:204015)

质量守恒原理的文字表述为：在一个固定的控制体 $V$ 内，质量随时间的变化率等于通过其边界 $S$ 的净质量通量与控制体内部质量源或汇的总和。

设 $\rho$ 为流体密度，$\mathbf{u}$ 为流速，$\mathbf{n}$ 为边界 $S$ 上指向外部的[单位法向量](@entry_id:178851)。单位时间内通过一小块面积 $dS$ 流出控制体的质量为 $\rho (\mathbf{u} \cdot \mathbf{n}) dS$。对整个边界面积分，就得到净流出质量率。若控制体内还存在一个单位体积、单位时间的质量源项 $q_m$（例如，飞机排放的水汽或[参数化](@entry_id:265163)过程引入的质量），则其对总体质量变化的贡献需要通过体积积分得到。

因此，[质量守恒的积分形式](@entry_id:750704)可以严谨地写为 ：
$$ \frac{d}{dt} \int_V \rho \, dV = -\oint_S \rho (\mathbf{u} \cdot \mathbf{n}) \, dS + \int_V q_m \, dV $$
等式左侧是控制体 $V$ 内总质量的时间变化率。右侧第一项是穿过边界 $S$ 的净质量**输运**项，负号表示向外的通量（$\mathbf{u} \cdot \mathbf{n} > 0$）会导致控制体内的质量减少。右侧第二项是体积**产生**项，代表了在控制体内部发生的质量增减。在绝大多数大气应用中，总质量是守恒的，因此 $q_m$ 通常被设为零。

#### [动量守恒](@entry_id:149964)

根据牛顿第二定律，控制体内[总动量](@entry_id:173071)的变化率等于作用在该控制体上的所有外力之和。这些力分为两类：作用于整个流体体积的**[体力](@entry_id:174230)**（如重力）和作用于其表面的**面力**（如压力和[粘性力](@entry_id:263294)）。

动量是矢量，[动量密度](@entry_id:271360)为 $\rho \mathbf{u}$。与[质量守恒](@entry_id:204015)类似，动量也可以通过平流输运（advection）的方式穿过控制体边界。此外，周围流体通过压力和[粘性应力](@entry_id:261328)作用在边界面上，也会改变控制体内的总动量。这种通过面力的[动量传递](@entry_id:147714)也是一种输运过程。

描述面力的关键物理量是**柯西应力张量** $\boldsymbol{\sigma}$。作用在具有单位外[法向量](@entry_id:264185) $\mathbf{n}$ 的表面上的力（或称牵[引力](@entry_id:189550)）为 $\boldsymbol{\sigma} \cdot \mathbf{n}$。重力等体力则表示为单位质量的[体力](@entry_id:174230) $\mathbf{g}$。因此，[动量守恒](@entry_id:149964)的积分形式为 ：
$$ \underbrace{\frac{d}{dt} \int_V \rho \mathbf{u} \, dV}_{\text{储存项}} = \underbrace{-\oint_S \rho \mathbf{u} (\mathbf{u} \cdot \mathbf{n}) \, dS + \oint_S \boldsymbol{\sigma} \cdot \mathbf{n} \, dS}_{\text{输运项}} + \underbrace{\int_V \rho \mathbf{g} \, dV}_{\text{产生项}} $$
这里，我们将各项进行了分类：
- **储存项**：控制体内总动量的时间变化率。
- **输运项**：所有跨越边界 $S$ 的[动量通量](@entry_id:199796)。这包括由流体宏观运动引起的**平流输运**（第一项），以及由[分子相互作用](@entry_id:263767)（压力和粘性）在微观层面传递动量而产生的**应力输运**（第二项）。
- **产生项**：作用于整个体积的体力，可视为动量的源。

值得一提的是，角动量守恒原理（在没有体力矩的经典连续介质中）要求柯西[应力张量](@entry_id:148973)必须是**对称**的，即 $\boldsymbol{\sigma} = \boldsymbol{\sigma}^T$ 。这是一个深刻的结论，它约束了流体的[本构关系](@entry_id:186508)。例如，对于[牛顿流体](@entry_id:263796)，[粘性应力](@entry_id:261328) $\boldsymbol{\tau}$ 是应变率张量 $\mathbf{D} = \frac{1}{2}[\nabla\mathbf{u} + (\nabla\mathbf{u})^T]$ 的线性函数，其对称性排除了应力对[速度梯度](@entry_id:261686)的反对称部分（即涡度）的依赖。

#### 能量守恒

能量守恒源于[热力学第一定律](@entry_id:146485)，即控制体内总能量的变化率等于进出控制体的能量通量与对控制体所做功的总和。这里的总能量 $E$ 包括单位质量的内能 $e$ 和动能 $\frac{1}{2}|\mathbf{u}|^2$。

能量跨越控制体边界 $S$ 的方式比质量和动量更为复杂 ：
1.  **能量的平流输运**：流体携带其自身的内能和动能穿过边界，通量为 $(\rho E) \mathbf{u}$。
2.  **压力做功**：边界上的压力 $p$ 对进出流体做功，其功率通量（即单位时间通过单位面积的能量）为 $p\mathbf{u}$。这个功改变了流体的内能。在[热力学](@entry_id:172368)中，内能和压力功项常常组合在一起，形成焓 ($h=e+p/\rho$) 的通量。
3.  **[粘性力](@entry_id:263294)做功**：柯西[应力张量](@entry_id:148973) $\boldsymbol{\sigma}$ 可以分解为压力和[粘性应力](@entry_id:261328)张量 $\boldsymbol{\tau}$，即 $\boldsymbol{\sigma} = -p\mathbf{I} + \boldsymbol{\tau}$。粘性应力 $\boldsymbol{\tau}$ 在边界上对流体做功，其功率通量为 $\boldsymbol{\tau}\cdot\mathbf{u}$。这部分功通常最终转化为内能（耗散）。
4.  **非平流热通量**：热量可以通过传导和辐射等方式跨越边界，这部分通量由热流矢量 $\mathbf{q}$ 描述。

此外，体积力（如重力）可以对流体做功，这是一个能量的体积源项，功率为 $\rho \mathbf{g} \cdot \mathbf{u}$。同时，还可能存在其他的体积加热源 $Q$（如辐射吸收或潜热释放）。

综合以上各项，总能量（此处不包含引力势能）的积分守恒方程为：
$$ \frac{d}{dt} \int_V \rho E \, dV = -\oint_S \left[ (\rho E + p)\mathbf{u} + \mathbf{q} - \boldsymbol{\tau}\cdot\mathbf{u} \right] \cdot \mathbf{n} \, dS + \int_V \rho (\mathbf{g} \cdot \mathbf{u}) \, dV + \int_V Q \, dV $$
这个方程精确地描述了在一个固定区域内，所有[能量转换](@entry_id:165656)和输运过程的收支平衡。

### 从积分到[微分](@entry_id:158422)：局地视角

虽然积分形式的守恒定律是数值计算的基础，但为了进行理论分析和理解流体在某一点的瞬时行为，我们需要将其转化为[微分形式](@entry_id:146747)。这个转化过程的数学工具是**[高斯散度定理](@entry_id:188065)**，它建立了[体积分](@entry_id:171119)和[面积分](@entry_id:275394)之间的联系：$\int_V (\nabla \cdot \mathbf{F}) dV = \oint_S (\mathbf{F} \cdot \mathbf{n}) dS$。

将[散度定理](@entry_id:143110)应用于守恒定律的通量项，并考虑到该定律对任意控制体 $V$ 都成立，我们可以得到守恒定律的局地（[微分](@entry_id:158422)）形式。例如，对于一个标量 $\phi$（单位质量），其[守恒方程](@entry_id:1122898)的微分形式为：
$$ \frac{\partial (\rho \phi)}{\partial t} + \nabla \cdot (\rho \phi \mathbf{u}) = \rho S $$
这里 $S$ 是单位质量的源项。这种形式被称为**守恒型**。

为了更好地理解物理过程，我们常常需要区分一个固定点上物理量的变化（**[欧拉观点](@entry_id:198701)**）和一个跟随流体微团运动的观察者所看到的变化（**[拉格朗日观点](@entry_id:1127015)**）。后者的变化率被称为**[物质导数](@entry_id:262900)**（或称随质导数、拉格朗日导数），记为 $D/Dt$。

[物质导数](@entry_id:262900)算符定义为 ：
$$ \frac{D}{Dt} \equiv \frac{\partial}{\partial t} + \mathbf{u} \cdot \nabla $$
对于任意标量场 $\phi(\mathbf{x}, t)$，其[物质导数](@entry_id:262900) $D\phi/Dt$ 代表了跟随流体微团运动时 $\phi$ 的总变化率。这个总变化率由两部分组成：
- **局地变化率**（Eulerian tendency）：$\partial \phi / \partial t$，即在空间固定点上 $\phi$ 随时间的变化。
- **平流变化率**（advective change）：$\mathbf{u} \cdot \nabla \phi$，即由于流体运动将不同值的 $\phi$ 带到该固定点所引起的变化。

通过对守恒型方程 $\partial_t(\rho\phi) + \nabla \cdot (\rho\phi\mathbf{u}) = \rho S$ 应用[乘积法则](@entry_id:158393)，并利用质量连续性方程 $\partial_t\rho + \nabla \cdot (\rho\mathbf{u}) = 0$，我们可以得到**非守恒型**方程：
$$ \rho \frac{D\phi}{Dt} = \rho S \quad \text{或} \quad \frac{D\phi}{Dt} = S $$
这个简洁的形式表明，跟随流体运动时，物理量 $\phi$ 的变化完全由其源汇项 $S$ 决定。这两种形式（守恒型和非守恒型）在数学上是等价的，但它们在物理诠释和数值处理上各有侧重。

### 大气模拟的控制方程

现在，我们将上述普适的守恒定律应用于地球大气这一特定系统。

#### [旋转坐标系](@entry_id:170324)下的动量方程

地球是一个旋转的球体，因此在NWP和气候模型中，我们通常在与地球固连的**[旋转坐标系](@entry_id:170324)**中描述大气运动。从[惯性系](@entry_id:266190)变换到[旋转坐标系](@entry_id:170324)，牛顿第二定律的形式会发生改变，出现两个视示力（apparent forces）。

完整的推导表明，在[角速度](@entry_id:192539)为 $\boldsymbol{\Omega}$ 的[旋转坐标系](@entry_id:170324)中，相对于旋转地球运动的空气所受的力需要增加**科里奥利力**和**[离心力](@entry_id:173726)**。最终的[动量方程](@entry_id:197225)（或称Navier-Stokes方程）的矢量形式为 ：
$$ \rho \frac{D\mathbf{u}}{Dt} = -\nabla p + \nabla \cdot \boldsymbol{\tau} + \rho \mathbf{g}^* - 2\rho (\boldsymbol{\Omega} \times \mathbf{u}) $$
这里，为简化起见，我们将[离心力](@entry_id:173726)与真实[引力](@entry_id:189550) $\mathbf{g}^*$ 合并定义为一个**有效重力** $\mathbf{g}$，其方向就是我们日常生活中铅垂线的方向。通过这个定义，动量方程可以被简化为：
$$ \rho \frac{D\mathbf{u}}{Dt} = -\nabla p + \rho\mathbf{g} - 2\rho (\boldsymbol{\Omega} \times \mathbf{u}) + \nabla \cdot \boldsymbol{\tau} $$
这个方程描述了大气微团的加速度由压力[梯度力](@entry_id:166847)、有效重力、科里奥利力以及粘性（或亚格子尺度）应力 $\boldsymbol{\tau}$ 的[合力](@entry_id:163825)驱动。这是现代大气模型动力核心的基础。

#### 数值离散中守恒形式的重要性

虽然守恒型和非守恒型[微分](@entry_id:158422)方程在解光滑时是等价的，但在数值计算中，尤其是在处理不连续或陡峭梯度（如锋面、激波）时，两者存在天壤之别。数值模型必须能够正确地处理这些不连续性，以保证物理量的全局守恒。

以一维[标量守恒律](@entry_id:754532) $u_t + (f(u))_x = 0$ 为例，其[非守恒形式](@entry_id:1128837)为 $u_t + f'(u)u_x=0$。考虑一个初始的不连续（阶跃），比如 $u_L=2$ 和 $u_R=0$ 的黎曼问题。物理上，这个[不连续面](@entry_id:180188)会以一个特定的速度 $s$ 传播，这个速度由**兰金-雨贡纽（Rankine-Hugoniot）跳跃关系**决定，该关系本质上是跨越[不连续面](@entry_id:180188)的积分守恒定律：$s = [f(u)]/[u] = (f(u_R)-f(u_L))/(u_R-u_L)$。对于 $f(u)=\frac{1}{2}u^2$ 的伯格斯方程，正确的激波速度是 $s=1$。

然而，如果我们对[非守恒形式](@entry_id:1128837) $u_t + u u_x = 0$ 进行离散化，例如使用一个简单的[迎风格式](@entry_id:756378)，计算结果可能会严重偏离物理现实。一个具体的例子表明，这样的非[守恒格式](@entry_id:747714)可能会预测激波速度为零，即激波静止不动 。这是因为非[守恒格式](@entry_id:747714)没有内在地强制物理量跨越网格边界的通量守恒，它只在每个网格点上试图满足[微分](@entry_id:158422)方程，而[微分](@entry_id:158422)方程在不连续点处本就是无定义的。

这个例子深刻地揭示了，为了确保数值解在存在不连续时能收敛到正确的物理解（即[弱解](@entry_id:161732)），数值格式必须基于守恒型方程进行构造。这类**[守恒格式](@entry_id:747714)**能够保证即使在粗糙的分辨率下，离散的总质量、动量和能量也能保持守恒。

### 近似与简化模型

求解完整的、可压缩的、非静力的[欧拉方程组](@entry_id:143098)在计算上非常昂贵，且其中包含了对许多大规模天气过程不重要的高频声波。因此，根据所研究现象的尺度，发展了多种近似方程组。

#### [静力平衡近似](@entry_id:1126281)

对于水平尺度远大于垂直尺度（即**[长宽比](@entry_id:177707)** $\alpha = H/L \ll 1$）的大尺度大气运动，垂直方向的[动量方程](@entry_id:197225)可以被大大简化。通过对[垂直动量方程](@entry_id:1133792)进行**[尺度分析](@entry_id:1131264)**，可以发现垂直方向的惯性力（即垂直加速度项 $\rho Dw/Dt$）与[垂直压力梯度](@entry_id:1133794)力和重力相比，要小好几个数量级 。

忽略这个微小的垂直加速度项，我们得到一个近似的平衡关系，即[垂直压力梯度](@entry_id:1133794)力与重力相抵消。这被称为**[静力平衡](@entry_id:163498)**（或静[水平衡](@entry_id:140465)）**近似**：
$$ \frac{\partial p}{\partial z} = -\rho g $$
这个近似极大地简化了控制方程，因为它将[垂直动量方程](@entry_id:1133792)从一个[预报方程](@entry_id:1130221)变成了一个诊断方程，从而过滤掉了[垂直传播](@entry_id:204688)的声波，并允许使用更长的时间步长。静力平衡近似的有效性可以通过一个[无量纲数](@entry_id:260863) $\varepsilon$ 来衡量，它正比于垂直惯性力与[浮力](@entry_id:154088)之比。这个数可以表示为 $\varepsilon = \alpha^2 \mathrm{Fr}_i^2$，其中 $\mathrm{Fr}_i = U/(NH)$ 是**内部[弗劳德数](@entry_id:271895)**（$N$ 为浮力频率）。当 $\varepsilon \ll 1$ 时，[静力平衡近似](@entry_id:1126281)是高度准确的，这正是全球模式和大部分区域模式所处的情形。

#### 声波过滤模型中的能量守恒

虽然完整的[可压缩欧拉方程](@entry_id:747588)组在绝热无粘的条件下可以精确地守恒总能量（动能+内能+势能），但旨在过滤声波的近似模型（如**Boussinesq模型**和**Anelastic模型**）在能量守恒方面面临挑战。因为这些模型通过修改[连续性方程](@entry_id:195013)来消除声波，从而破坏了压力功、内能和动能之间原有的精确转换关系。

为了在这些声波过滤模型中恢[复能量](@entry_id:263929)守恒，必须重新定义一个能够被守恒的能量形式 。
- 在**[Boussinesq近似](@entry_id:147239)**中，密度被视为常数，除非在[浮力](@entry_id:154088)项中。这种近似下的动能和一种新的能量形式——**有效位能**（Available Potential Energy, APE）——之和可以被构造成守恒的。APE与流体偏离其稳定层结状态的程度有关。例如，对于一个具有恒定[浮力频率](@entry_id:1121933) $N$ 的环境，APE密度可以被定义为 $\Phi_{\mathrm{ape}} = \rho_0 b^2 / (2N^2)$（其中 $b$ 为[浮力](@entry_id:154088)），使得APE的变化率恰好能平衡动能方程中的[浮力](@entry_id:154088)做功项。
- 在更精确的**Anelastic近似**中，允许背景密度随高度变化。标准的离散格式会因为非零的[速度散度](@entry_id:264117)（$\nabla \cdot \mathbf{u} \neq 0$）而引入一个虚假的能量源或汇。为了解决这个问题，必须对[动量方程](@entry_id:197225)中的压力梯度项进行精巧的重构，通常是引入一个基于艾克斯纳函数（Exner function）扰动的“折减压力”。这种重构能够保证压力做功项在整个积分区域内为零，从而允许定义一个由动能和恰当形式的APE组成的、严格守恒的加权总能量。

总之，虽然简化模型过滤了某些物理过程，但通过审慎的数学重构，我们依然可以构建出在数值上保持能量守恒的动力框架，这对于长期气候模拟的稳定性和物理保真度至关重要。