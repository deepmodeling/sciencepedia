{
    "hands_on_practices": [
        {
            "introduction": "此练习介绍尺度分析，这是一个强大的工具，通过识别主导的物理过程来简化复杂的方程。通过估算浅水动量方程中不同项的量级，您将推导出罗斯比数（Rossby number），并深入理解旋转效应（科里奥利力）何时主导流动。这对于理解大尺度大气和海洋动力学至关重要。",
            "id": "4103362",
            "problem": "考虑$f$平面上的旋转浅水方程（SWE），以此作为天气尺度大气动力学的原型。对于具有自由面位移 $\\eta(x,y,t)$ 和平均深度 $H$ 的单层浅流体，其水平速度场 $\\boldsymbol{u}(x,y,t)$ 的动量方程，可以通过引用流体质点的牛顿第二定律和静力平衡，写为\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta,\n$$\n其中 $f$ 是科里奥利参数，$g$ 是重力加速度，$\\hat{\\boldsymbol{k}}$ 是垂直方向的单位向量。使用基于上述动力学方程和天气尺度的中纬度值 $U\\sim 10\\,{\\rm m\\,s^{-1}}$、$L\\sim 10^{6}\\,{\\rm m}$、$f\\sim 10^{-4}\\,{\\rm s^{-1}}$ 和 $H\\sim 10^{4}\\,{\\rm m}$ 的尺度分析，从第一性原理推导非线性平流加速度 $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$ 与科里奥利加速度 $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 的领头阶无量纲比率。将你的最终答案表示为一个无量纲数。无需四舍五入。",
            "solution": "该问题要求计算非线性平流加速度与科里奥利加速度的领头阶无量纲比率。这两项可在给出的旋转浅水系统动量方程中找到：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta\n$$\n我们感兴趣的两项是：\n1.  非线性平流加速度：$(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$\n2.  科里奥利加速度：$f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$\n\n我们进行尺度分析来估计每一项的特征量级。问题提供了以下天气尺度：\n-   特征水平速度，$U \\sim 10\\,{\\rm m\\,s^{-1}}$\n-   特征水平长度尺度，$L \\sim 10^{6}\\,{\\rm m}$\n-   特征科里奥利参数，$f \\sim 10^{-4}\\,{\\rm s^{-1}}$\n\n像梯度 $\\nabla$ 这样的微分算子的尺度，是由它所作用的场发生显著变化的长度尺度决定的。在此背景下，该尺度为 $L$。因此，梯度算子的量级为 $L^{-1}$ 的量级。\n$$\n|\\nabla| \\sim \\frac{1}{L}\n$$\n类似地，水平速度场 $\\boldsymbol{u}$ 的特征量级为 $U$。\n$$\n|\\boldsymbol{u}| \\sim U\n$$\n现在，让我们估计非线性平流加速度项 $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$ 的量级。该项代表流体质点因穿过空间变化的速度场而产生的加速度。其量级可以通过其组成部分的尺度乘积来估算：\n$$\n|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}| \\sim |\\boldsymbol{u}| \\cdot |\\nabla| \\cdot |\\boldsymbol{u}| \\sim U \\cdot \\frac{1}{L} \\cdot U = \\frac{U^2}{L}\n$$\n接下来，我们估计科里奥利加速度项 $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 的量级。该项代表由于参考系旋转而产生的视加速度。向量 $\\hat{\\boldsymbol{k}}$ 是一个单位向量，叉积 $\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 产生一个水平向量，其大小为 $|\\boldsymbol{u}|\\sin\\theta$，其中 $\\theta$ 是 $\\hat{\\boldsymbol{k}}$ 和 $\\boldsymbol{u}$ 之间的夹角。由于 $\\boldsymbol{u}$ 在水平面内，它垂直于垂直向量 $\\hat{\\boldsymbol{k}}$，因此 $\\theta = \\pi/2$ 且 $\\sin\\theta = 1$。所以，叉积的量级就是 $|\\boldsymbol{u}|$。整个项的量级为：\n$$\n|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}| \\sim f \\cdot |\\boldsymbol{u}| \\sim fU\n$$\n非线性平流加速度与科里奥利加速度的无量纲比率是它们特征量级的比值。这个特定的比率在流体动力学中被称为罗斯贝数（Rossby number），记为 $Ro$。\n$$\nRo \\equiv \\frac{\\text{平流加速度的量级}}{\\text{科里奥利加速度的量级}} \\sim \\frac{|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}|}{|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}|} \\sim \\frac{U^2/L}{fU}\n$$\n简化罗斯贝数的表达式可得：\n$$\nRo \\sim \\frac{U}{fL}\n$$\n问题要求使用给定的值来计算这个比率。我们将给定的尺度代入罗斯贝数的表达式中：\n-   $U = 10\\,{\\rm m\\,s^{-1}}$\n-   $f = 10^{-4}\\,{\\rm s^{-1}}$\n-   $L = 10^{6}\\,{\\rm m}$\n\n计算如下：\n$$\nRo \\sim \\frac{10\\,{\\rm m\\,s^{-1}}}{(10^{-4}\\,{\\rm s^{-1}})(10^{6}\\,{\\rm m})} = \\frac{10}{10^{-4} \\cdot 10^{6}} = \\frac{10}{10^{2}} = \\frac{1}{10} = 0.1\n$$\n单位可以约去，正如无量纲数所预期的那样：$({\\rm m\\,s^{-1}}) \\cdot ({\\rm s}) \\cdot ({\\rm m^{-1}}) = 1$。数值 $0.1$ 表明，对于天气尺度运动，科里奥利加速度比平流加速度大一个数量级，这是地转平衡的基础。另一个提供的数据 $H\\sim 10^{4}\\,{\\rm m}$ 对于此特定计算不是必需的。",
            "answer": "$$\n\\boxed{0.1}\n$$"
        },
        {
            "introduction": "在理解了方程的物理意义后，本练习通过特征线分析深入探讨其数学结构，这对于理解信息如何以波的形式传播至关重要。您将确定这些波的速度，并用它们将流态分为亚临界（subcritical）或超临界（supercritical）。此分析直接关联到数值模拟中一个关键且实际的问题：如何为问题设定适定（well-posed）的边界条件。",
            "id": "4103318",
            "problem": "考虑一个水平底床上的一维、无粘、无摩擦的浅水系统，该系统在数值天气预报（NWP）和气候模拟中用作开放边界处理的原型。令 $x \\in [0,L]$ 表示流向坐标，其中 $x=0$ 为上游边界，$x=L$ 为下游边界。平均流是均匀的，其速率为 $U0$，平均深度为 $H0$，重力加速度 $g0$ 是常数。令 $\\eta(x,t)$ 为相对于平均值的自由表面位移，$u(x,t)$ 为相对于均匀平均流的扰动速度。从浅水的质量和动量守恒控制律出发，\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}\\big((H+\\eta)(U+u)\\big) = 0, \\qquad\n\\frac{\\partial u}{\\partial t} + (U+u)\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0,\n$$\n对均匀态 $(\\eta,u)=(0,0)$（其中 $(U,H)$ 为常数）进行线性化，推导特征波速，并引入无量纲弗劳德数 $\\mathrm{Fr}$，定义为平均流速与小振幅长重力波相速之比。使用特征分析，确定划分亚临界和超临界状态的临界值 $\\mathrm{Fr}_{c}$，并对于 $U0$ 的情况，根据每个边界上入射特征的数量，确定在每种状态下必须在 $x=0$（上游）和 $x=L$（下游）处施加多少个标量边界条件。\n\n将您的最终答案以行矩阵 $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$ 的形式报告，其中 $N_{\\text{up}}^{\\text{sub}}$ 和 $N_{\\text{down}}^{\\text{sub}}$ 分别是在亚临界状态下在上游和下游边界施加的标量边界条件的数量，而 $N_{\\text{up}}^{\\text{super}}$ 和 $N_{\\text{down}}^{\\text{super}}$ 是在超临界状态下的相应数量。无需四舍五入。最终答案必须是指定的单个行矩阵。",
            "solution": "### 第1步：线性化控制方程\n我们通过假设扰动 $\\eta$ 和 $u$ 分别与平均态变量 $H$ 和 $U$ 相比很小来对系统进行线性化。这意味着我们忽略小量的乘积，例如 $\\eta u$、$u^2$ 及其导数。\n\n质量守恒方程为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(HU + Hu + U\\eta + u\\eta) = 0\n$$\n忽略二阶小项 $u\\eta$ 并注意到 $HU$ 是常数，线性化的质量方程变为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + U\\frac{\\partial \\eta}{\\partial x} + H\\frac{\\partial u}{\\partial x} = 0\n$$\n\n动量守恒方程为：\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + u\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\n忽略非线性项 $u\\frac{\\partial u}{\\partial x}$，线性化的动量方程为：\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\n\n### 第2步：特征分析\n为了求特征波速，我们将线性化系统写成矩阵形式 $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$，其中 $\\mathbf{q} = \\begin{pmatrix} \\eta \\\\ u \\end{pmatrix}$。\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} + \\begin{pmatrix} U  H \\\\ g  U \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n矩阵 $\\mathbf{A}$ 是 $\\begin{pmatrix} U  H \\\\ g  U \\end{pmatrix}$。特征速度，用 $\\lambda$ 表示，是 $\\mathbf{A}$ 的特征值。我们通过求解特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 来求得它们。\n$$\n\\det\\begin{pmatrix} U-\\lambda  H \\\\ g  U-\\lambda \\end{pmatrix} = (U-\\lambda)^2 - gH = 0\n$$\n解出 $\\lambda$：\n$$\nU - \\lambda = \\pm\\sqrt{gH}\n$$\n$$\n\\lambda = U \\pm \\sqrt{gH}\n$$\n两个特征波速为 $\\lambda_1 = U + \\sqrt{gH}$ 和 $\\lambda_2 = U - \\sqrt{gH}$。\n\n### 第3步：弗劳德数和临界值\n问题将弗劳德数 $\\mathrm{Fr}$ 定义为平均流速 $U$ 与小振幅长重力波相速之比。这些波在静止流体（$U=0$）中的相速为 $c_0 = \\sqrt{gH}$。\n因此，弗劳德数为：\n$$\n\\mathrm{Fr} = \\frac{U}{c_0} = \\frac{U}{\\sqrt{gH}}\n$$\n流态（亚临界 vs. 超临界）由特征速度的符号决定。由于 $U > 0$ 且 $\\sqrt{gH} > 0$，速度 $\\lambda_1 = U + \\sqrt{gH}$ 总是正的。$\\lambda_2 = U - \\sqrt{gH}$ 的符号决定了流态。当 $\\lambda_2 = 0$ 时发生转变，这意味着 $U = \\sqrt{gH}$。用弗劳德数表示，该条件为 $\\frac{U}{\\sqrt{gH}} = 1$，即 $\\mathrm{Fr} = 1$。\n这个临界值 $\\mathrm{Fr}_{c}$ 区分了亚临界和超临界状态。\n$$\n\\mathrm{Fr}_{c} = 1\n$$\n-   **亚临界流**：当 $U  \\sqrt{gH}$，即 $\\mathrm{Fr}  1$。在这种情况下，$\\lambda_2  0$。\n-   **超临界流**：当 $U > \\sqrt{gH}$，即 $\\mathrm{Fr} > 1$。在这种情况下，$\\lambda_2 > 0$。\n\n### 第4步：边界条件\n在一个边界上所需的标量边界条件的数量等于在该边界处传入计算域的特征波的数量。\n-   在上游边界（$x=0$），入射特征具有正速度（$\\lambda > 0$）。\n-   在下游边界（$x=L$），入射特征具有负速度（$\\lambda  0$）。\n\n1.  **亚临界状态 ($\\mathrm{Fr}  1$)**\n    -   在此情况下，$U  \\sqrt{gH}$。\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$。这个特征在 $x=0$ 处是入射的。\n    -   $\\lambda_2 = U - \\sqrt{gH}  0$。这个特征在 $x=L$ 处是入射的。\n    -   上游（$x=0$）的条件数量：$N_{\\text{up}}^{\\text{sub}} = 1$。\n    -   下游（$x=L$）的条件数量：$N_{\\text{down}}^{\\text{sub}} = 1$。\n\n2.  **超临界状态 ($\\mathrm{Fr} > 1$)**\n    -   在此情况下，$U > \\sqrt{gH}$。\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$。这个特征在 $x=0$ 处是入射的。\n    -   $\\lambda_2 = U - \\sqrt{gH} > 0$。这个特征在 $x=0$ 处也是入射的。\n    -   上游（$x=0$）的条件数量：$N_{\\text{up}}^{\\text{super}} = 2$。\n    -   下游（$x=L$）的条件数量：没有特征的速度为负，因此在 $x=L$ 处没有入射特征。$N_{\\text{down}}^{\\text{super}} = 0$。\n\n### 第5步：最终答案组合\n问题要求以行矩阵 $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$ 的形式给出答案。\n-   $\\mathrm{Fr}_{c} = 1$\n-   $N_{\\text{up}}^{\\text{sub}} = 1$\n-   $N_{\\text{down}}^{\\text{sub}} = 1$\n-   $N_{\\text{up}}^{\\text{super}} = 2$\n-   $N_{\\text{down}}^{\\text{super}} = 0$\n\n最终结果是这五个数字的有序集合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  2  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的练习从连续方程转向数值计算的世界，探讨稳定性的核心概念。通过对一个简化的离散平流方程进行冯·诺依曼（von Neumann）分析，您将推导出著名的Courant-Friedrichs-Lewy (CFL) 条件。此练习提供了分析数值格式稳定性的实践经验，以确保数值模拟不会产生非物理性的爆炸性误差，这是计算流体动力学的基石之一。",
            "id": "4103368",
            "problem": "考虑浅水方程中自由表面高度的一维输运，在空间均匀、稳定的速度条件下，该过程可由连续性方程简化，并被建模为线性平流方程。从浅水层的质量守恒出发，连续性方程为 $$\\frac{\\partial h}{\\partial t} + \\frac{\\partial (h u)}{\\partial x} = 0,$$ 其中 $h$ 是水层厚度，$u$ 是水平速度。在给定一个空间均匀的平均速度 $U$ 且 $h$ 的微小扰动被动输运的情况下，该方程简化为线性平流方程 $$\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0,$$ 该方程定义在一个周期性域上。在均匀网格 $x_j = j\\,\\Delta x$ 上，使用显式向前欧拉时间步进 $t^n = n\\,\\Delta t$ 以及与 $U$ 符号一致的一阶迎风空间离散格式对此方程进行离散化。即，对于 $U0$，使用 $$h^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right),$$ 对于 $U0$，使用 $$h^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right),$$ 其中 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 是库朗数。假设周期性边界条件，并执行 von Neumann 分析（傅里叶模态分析）来确定离散勒贝格平方可积（L$^2$）稳定性条件，该条件在此定义为：对于任意初始数据，$h$ 的离散 L$^2$ 范数不随时间增长。\n\n通过计算放大因子并要求其模数对所有波数都小于等于 $1$ 来推导此稳定性条件。然后，给出保证该均匀网格上离散 L$^2$ 稳定性的最大允许时间步长，记为 $\\Delta t_{\\max}$。将最终答案表示为关于 $\\Delta x$ 和 $|U|$ 的单个闭式符号表达式。不应代入数值。如果之后计算数值，请以秒为单位表示时间。此问题中無需四舍五入。",
            "solution": "问题要求使用 von Neumann 分析方法，推导线性平流方程一阶迎风离散格式的离散 L$^2$ 稳定性条件。并根据此条件，确定最大允许时间步长 $\\Delta t_{\\max}$。\n\n控制偏微分方程为线性平流方程：\n$$\n\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0\n$$\n其中 $h$ 是流体深度，$t$ 是时间，$x$ 是空间坐标，$U$ 是一个恒定的均匀速度。\n\n该方程在均匀网格 $x_j = j\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$ 上进行离散化。数值格式为时间向前、空间一阶迎风法。该格式的具体形式取决于速度 $U$ 的符号。库朗数定义为 $C = \\frac{U\\,\\Delta t}{\\Delta x}$。\n\n为了进行 von Neumann 稳定性分析，我们考虑解在给定时间层 $n$ 的单个傅里叶模态：\n$$\nh^n_j = \\hat{h}^n(k) e^{i k x_j} = \\hat{h}^n(k) e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$i$ 是虚数单位。数值格式按以下方式在时间上传播此模态：\n$$\nh^{n+1}_j = G(k) h^n_j\n$$\n其中 $G(k)$ 是放大因子，它取决于波数 $k$ 和离散化参数。该格式在 L$^2$ 意义下是稳定的，当且仅当对于所有可能的波数，放大因子的模小于或等于1：\n$$\n|G(k)| \\le 1 \\quad \\forall k\n$$\n\n我们必须分析 $U$ 符号的两种情况。\n\n情况1：$U  0$\n对于正速度，迎风方向是从 $j-1$ 到 $j$。离散格式由下式给出：\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right)\n$$\n在这种情况下，由于 $U  0$，库朗数 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 也为正。\n将傅里叶模态代入格式中，得到：\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k j \\Delta x} - \\hat{h}^n(k) e^{i k (j-1) \\Delta x} \\right)\n$$\n除以 $\\hat{h}^n(k) e^{i k j \\Delta x}$ 得到放大因子：\n$$\nG(k) = 1 - C \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\n令 $\\theta = k \\Delta x$ 为无量纲波数。那么：\n$$\nG(\\theta) = 1 - C(1 - e^{-i\\theta}) = 1 - C(1 - (\\cos\\theta - i\\sin\\theta))\n$$\n$$\nG(\\theta) = (1 - C + C\\cos\\theta) + i(C\\sin\\theta)\n$$\n放大因子的模的平方是：\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 要求：\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\n因为对于所有实数 $\\theta$，$1 - \\cos\\theta \\ge 0$，该不等式简化为：\n$$\nC(1-C) \\ge 0\n$$\n由于 $U0$，我们有 $C  0$。因此，为使乘积为非负，必须有 $1-C \\ge 0$，这意味着 $C \\le 1$。$U0$ 时的稳定性条件是 $0  C \\le 1$。\n\n情况2：$U  0$\n对于负速度，迎风方向是从 $j+1$ 到 $j$。离散格式由下式给出：\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right)\n$$\n在这种情况下，由于 $U  0$，库朗数 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 为负。\n将傅里叶模态代入格式中，得到：\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k (j+1) \\Delta x} - \\hat{h}^n(k) e^{i k j \\Delta x} \\right)\n$$\n除以 $\\hat{h}^n(k) e^{i k j \\Delta x}$ 得到放大因子：\n$$\nG(k) = 1 - C \\left( e^{i k \\Delta x} - 1 \\right)\n$$\n同样，令 $\\theta = k \\Delta x$：\n$$\nG(\\theta) = 1 - C(e^{i\\theta} - 1) = 1 - C((\\cos\\theta - 1) + i\\sin\\theta)\n$$\n$$\nG(\\theta) = (1 - C(\\cos\\theta - 1)) - i(C\\sin\\theta)\n$$\n放大因子的模的平方是：\n$$\n|G(\\theta)|^2 = (1 + C - C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + C^2 - 2C(1+C)\\cos\\theta + C^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C(1+C) - 2C(1+C)\\cos\\theta = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 要求：\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\n由于 $1 - \\cos\\theta \\ge 0$，不等式简化为：\n$$\nC(1+C) \\le 0\n$$\n由于 $U  0$，我们有 $C  0$。因此，为使乘积为非正，必须有 $1+C \\ge 0$，这意味着 $C \\ge -1$。$U  0$ 时的稳定性条件是 $-1 \\le C  0$。\n\n综合两种情况：\n- 对于 $U  0$，我们有 $0  C \\le 1$，即 $0  \\frac{U \\Delta t}{\\Delta x} \\le 1$。由于 $U = |U|$，这便是 $\\frac{|U| \\Delta t}{\\Delta x} \\le 1$。\n- 对于 $U  0$，我们有 $-1 \\le C  0$，即 $-1 \\le \\frac{U \\Delta t}{\\Delta x}  0$。由于 $U = -|U|$，这便是 $-1 \\le \\frac{-|U| \\Delta t}{\\Delta x}  0$。两边乘以 $-1$ 反转不等号，得到 $1 \\ge \\frac{|U| \\Delta t}{\\Delta x} > 0$。\n\n两种情况都导出了相同的稳定性判据，即此格式的 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\frac{|U| \\Delta t}{\\Delta x} \\le 1\n$$\n此条件保证了数值解的 L$^2$ 范数不随时间增长。\n\n为求得最大允许时间步长 $\\Delta t_{\\max}$，我们在稳定性条件中取等号：\n$$\n\\frac{|U| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\n解出 $\\Delta t_{\\max}$ 得到：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|U|}\n$$\n此表达式假设 $U \\neq 0$，这在平流问题的上下文中是隐含的。",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|U|}}\n$$"
        }
    ]
}