{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing a complex physical system is often to determine the relative importance of its various forces. This practice introduces scale analysis, a powerful technique used throughout geophysical fluid dynamics. By applying it to the shallow water momentum equation, you will derive the Rossby number, $Ro$, and gain a quantitative understanding of why rotation is a dominant effect for large-scale weather systems. ",
            "id": "4103362",
            "problem": "Consider the rotating Shallow Water Equations (SWE) on an $f$-plane as a prototype for synoptic-scale atmospheric dynamics. The momentum equation for the horizontal velocity field $\\boldsymbol{u}(x,y,t)$ in a single-layer shallow fluid with free-surface displacement $\\eta(x,y,t)$ and mean depth $H$ can be written, by invoking Newtonâ€™s second law for a fluid parcel and the hydrostatic balance, as\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta,\n$$\nwhere $f$ is the Coriolis parameter, $g$ is the gravitational acceleration, and $\\hat{\\boldsymbol{k}}$ is the unit vector in the vertical direction. Using a scale analysis grounded in the above dynamical equation and the synoptic-scale midlatitude values $U\\sim 10\\,{\\rm m\\,s^{-1}}$, $L\\sim 10^{6}\\,{\\rm m}$, $f\\sim 10^{-4}\\,{\\rm s^{-1}}$, and $H\\sim 10^{4}\\,{\\rm m}$, derive from first principles the leading-order dimensionless ratio of the nonlinear advective acceleration $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$ to the Coriolis acceleration $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$. Express your final answer as a single dimensionless number. No rounding is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary information for the specified task is provided, the physical context is correct, and the question is unambiguous. The shallow water equations are a valid and fundamental model in geophysical fluid dynamics, and scale analysis is a standard technique for understanding the relative importance of different physical effects. The given characteristic scales are representative of synoptic-scale atmospheric phenomena in the midlatitudes.\n\nThe problem asks for the leading-order dimensionless ratio of the nonlinear advective acceleration to the Coriolis acceleration. These terms are found in the provided momentum equation for the rotating shallow water system:\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta\n$$\nThe two terms of interest are:\n1.  The nonlinear advective acceleration: $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$\n2.  The Coriolis acceleration: $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$\n\nWe perform a scale analysis to estimate the characteristic magnitude of each term. The problem provides the following synoptic scales:\n-   Characteristic horizontal velocity, $U \\sim 10\\,{\\rm m\\,s^{-1}}$\n-   Characteristic horizontal length scale, $L \\sim 10^{6}\\,{\\rm m}$\n-   Characteristic Coriolis parameter, $f \\sim 10^{-4}\\,{\\rm s^{-1}}$\n\nThe scale of a differential operator like the gradient, $\\nabla$, is determined by the length scale over which the fields it acts upon vary significantly. In this context, that scale is $L$. Therefore, the magnitude of the gradient operator is of the order of $L^{-1}$.\n$$\n|\\nabla| \\sim \\frac{1}{L}\n$$\nSimilarly, the horizontal velocity field $\\boldsymbol{u}$ has a characteristic magnitude of $U$.\n$$\n|\\boldsymbol{u}| \\sim U\n$$\nNow, let's estimate the magnitude of the nonlinear advective acceleration term, $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$. This term represents the acceleration of a fluid parcel due to its movement through a spatially varying velocity field. Its magnitude can be scaled by the product of the scales of its constituent parts:\n$$\n|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}| \\sim |\\boldsymbol{u}| \\cdot |\\nabla| \\cdot |\\boldsymbol{u}| \\sim U \\cdot \\frac{1}{L} \\cdot U = \\frac{U^2}{L}\n$$\nNext, we estimate the magnitude of the Coriolis acceleration term, $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$. This term represents the apparent acceleration due to the rotation of the reference frame. The vector $\\hat{\\boldsymbol{k}}$ is a unit vector, and the cross product $\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ results in a horizontal vector with magnitude $|\\boldsymbol{u}|\\sin\\theta$, where $\\theta$ is the angle between $\\hat{\\boldsymbol{k}}$ and $\\boldsymbol{u}$. Since $\\boldsymbol{u}$ is in the horizontal plane, it is perpendicular to the vertical vector $\\hat{\\boldsymbol{k}}$, so $\\theta = \\pi/2$ and $\\sin\\theta = 1$. Thus, the magnitude of the cross product is simply $|\\boldsymbol{u}|$. The magnitude of the entire term is:\n$$\n|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}| \\sim f \\cdot |\\boldsymbol{u}| \\sim fU\n$$\nThe dimensionless ratio of the nonlinear advective acceleration to the Coriolis acceleration is the ratio of their characteristic magnitudes. This specific ratio is known in fluid dynamics as the Rossby number, denoted $Ro$.\n$$\nRo \\equiv \\frac{\\text{Magnitude of advective acceleration}}{\\text{Magnitude of Coriolis acceleration}} \\sim \\frac{|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}|}{|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}|} \\sim \\frac{U^2/L}{fU}\n$$\nSimplifying the expression for the Rossby number yields:\n$$\nRo \\sim \\frac{U}{fL}\n$$\nThe problem requires this ratio to be calculated using the provided values. We substitute the given scales into the expression for the Rossby number:\n-   $U = 10\\,{\\rm m\\,s^{-1}}$\n-   $f = 10^{-4}\\,{\\rm s^{-1}}$\n-   $L = 10^{6}\\,{\\rm m}$\n\nThe calculation is as follows:\n$$\nRo \\sim \\frac{10\\,{\\rm m\\,s^{-1}}}{(10^{-4}\\,{\\rm s^{-1}})(10^{6}\\,{\\rm m})} = \\frac{10}{10^{-4} \\cdot 10^{6}} = \\frac{10}{10^{2}} = \\frac{1}{10} = 0.1\n$$\nThe units cancel out, as expected for a dimensionless number: $({\\rm m\\,s^{-1}}) \\cdot ({\\rm s}) \\cdot ({\\rm m^{-1}}) = 1$. The value $0.1$ indicates that for synoptic-scale motions, the Coriolis acceleration is an order of magnitude larger than the advective acceleration, which is the basis for geostrophic balance. The other provided data, $H\\sim 10^{4}\\,{\\rm m}$, are not required for this specific calculation.",
            "answer": "$$\n\\boxed{0.1}\n$$"
        },
        {
            "introduction": "Once we understand the dominant physical balance, we can analyze how disturbances propagate, which is key to predicting their evolution. This exercise delves into the characteristic analysis of hyperbolic systems, revealing how information travels as waves with speeds $\\lambda$. You will use this to define the Froude number, $Fr$, determine the conditions for subcritical and supercritical flow, and learn the fundamental rules for setting boundary conditions in a numerical model. ",
            "id": "4103318",
            "problem": "Consider the one-dimensional, inviscid, frictionless shallow water system on a horizontal bed, used as a prototype in Numerical Weather Prediction (NWP) and climate modeling for open-boundary treatment. Let $x \\in [0,L]$ denote the streamwise coordinate, with an upstream boundary at $x=0$ and a downstream boundary at $x=L$. The mean flow is uniform with speed $U>0$ and mean depth $H>0$, and gravitational acceleration $g>0$ is constant. Let $\\eta(x,t)$ be the free-surface displacement relative to the mean and $u(x,t)$ the perturbation velocity about the uniform mean. Starting from the governing laws of mass and momentum conservation for shallow water,\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}\\big((H+\\eta)(U+u)\\big) = 0, \\qquad\n\\frac{\\partial u}{\\partial t} + (U+u)\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0,\n$$\nperform a linearization about the uniform state $(\\eta,u)=(0,0)$ with constants $(U,H)$, derive the characteristic wave speeds, and introduce the dimensionless Froude number $\\mathrm{Fr}$ as the ratio of the mean flow speed to the phase speed of small-amplitude long gravity waves. Using the characteristic analysis, determine the critical value $\\mathrm{Fr}_{c}$ that separates subcritical and supercritical regimes, and, for $U>0$, determine how many scalar boundary conditions must be prescribed at $x=0$ (upstream) and at $x=L$ (downstream) in each regime based on the number of incoming characteristics at each boundary.\n\nReport your final answer as the row matrix $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$, where $N_{\\text{up}}^{\\text{sub}}$ and $N_{\\text{down}}^{\\text{sub}}$ are the numbers of scalar boundary conditions to impose at upstream and downstream boundaries in the subcritical regime, respectively, and $N_{\\text{up}}^{\\text{super}}$ and $N_{\\text{down}}^{\\text{super}}$ are the corresponding numbers in the supercritical regime. No rounding is required. The final answer must be a single row matrix as specified.",
            "solution": "The user has provided a problem statement regarding the one-dimensional shallow water equations, a topic of central importance in geophysical fluid dynamics and numerical modeling. The task is to perform a standard analysis involving linearization, characteristic speeds, and the specification of boundary conditions.\n\n### Step 1: Extract Givens\n-   **System**: One-dimensional, inviscid, frictionless shallow water system.\n-   **Domain**: $x \\in [0,L]$, with an upstream boundary at $x=0$ and a downstream boundary at $x=L$.\n-   **Mean State**: Uniform flow with speed $U>0$ and mean depth $H>0$.\n-   **Constant**: Gravitational acceleration $g>0$.\n-   **Variables**: Free-surface displacement $\\eta(x,t)$, perturbation velocity $u(x,t)$.\n-   **Governing Equations**:\n    $$\n    \\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}\\big((H+\\eta)(U+u)\\big) = 0\n    $$\n    $$\n    \\frac{\\partial u}{\\partial t} + (U+u)\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n    $$\n-   **Tasks**:\n    1.  Linearize the system about the state $(\\eta,u)=(0,0)$.\n    2.  Derive the characteristic wave speeds.\n    3.  Define the Froude number $\\mathrm{Fr}$ as the ratio of mean flow speed to the long gravity wave phase speed.\n    4.  Determine the critical Froude number $\\mathrm{Fr}_{c}$.\n    5.  For $U>0$, determine the number of required scalar boundary conditions at $x=0$ and $x=L$ for subcritical and supercritical regimes.\n-   **Final Output Format**: A row matrix $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard textbook problem in fluid dynamics and numerical methods for partial differential equations. The equations are the correct nonlinear shallow water equations. The tasks constitute a coherent and well-posed sequence of analysis for hyperbolic systems. The language is objective and precise. All necessary information is provided, and there are no contradictions. The problem is valid.\n\n### Step 3: Proceed with Solution\n\n**Linearization of the Governing Equations**\n\nWe linearize the system by assuming that the perturbations $\\eta$ and $u$ are small compared to the mean state variables $H$ and $U$, respectively. This means we neglect products of small quantities, such as $\\eta u$, $u^2$, and their derivatives.\n\nThe mass conservation equation is:\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(HU + Hu + U\\eta + u\\eta) = 0\n$$\nThe mean state $HU$ is constant, so its spatial derivative is zero. The term $u\\eta$ is a product of two small quantities and is neglected in the linearization. The linearized mass equation becomes:\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(Hu + U\\eta) = 0\n$$\nSince $U$ and $H$ are constants, this simplifies to:\n$$\n\\frac{\\partial \\eta}{\\partial t} + U\\frac{\\partial \\eta}{\\partial x} + H\\frac{\\partial u}{\\partial x} = 0\n$$\n\nThe momentum conservation equation is:\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + u\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\nThe term $u\\frac{\\partial u}{\\partial x}$ is nonlinear (quadratic in the perturbation) and is neglected. The linearized momentum equation is:\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\n\nThe linearized system of equations is:\n$$\n\\frac{\\partial \\eta}{\\partial t} + U\\frac{\\partial \\eta}{\\partial x} + H\\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g\\frac{\\partial \\eta}{\\partial x} + U\\frac{\\partial u}{\\partial x} = 0\n$$\n\n**Characteristic Analysis**\n\nTo find the characteristic wave speeds, we write the linearized system in matrix form, $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$, where $\\mathbf{q} = \\begin{pmatrix} \\eta \\\\ u \\end{pmatrix}$.\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} + \\begin{pmatrix} U & H \\\\ g & U \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThe matrix $\\mathbf{A}$ is $\\begin{pmatrix} U & H \\\\ g & U \\end{pmatrix}$. The characteristic speeds, denoted by $\\lambda$, are the eigenvalues of $\\mathbf{A}$. We find them by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$.\n$$\n\\det\\begin{pmatrix} U-\\lambda & H \\\\ g & U-\\lambda \\end{pmatrix} = (U-\\lambda)^2 - gH = 0\n$$\nSolving for $\\lambda$:\n$$\nU - \\lambda = \\pm\\sqrt{gH}\n$$\n$$\n\\lambda = U \\pm \\sqrt{gH}\n$$\nThe two characteristic wave speeds are $\\lambda_1 = U + \\sqrt{gH}$ and $\\lambda_2 = U - \\sqrt{gH}$.\n\n**Froude Number and Critical Value**\n\nThe problem defines the Froude number, $\\mathrm{Fr}$, as the ratio of the mean flow speed $U$ to the phase speed of small-amplitude long gravity waves. The phase speed of these waves in a quiescent fluid ($U=0$) is $c_0 = \\sqrt{gH}$.\nTherefore, the Froude number is:\n$$\n\\mathrm{Fr} = \\frac{U}{c_0} = \\frac{U}{\\sqrt{gH}}\n$$\nThe flow regime (subcritical vs. supercritical) is determined by the sign of the characteristic speeds. Since $U > 0$ and $\\sqrt{gH} > 0$, the speed $\\lambda_1 = U + \\sqrt{gH}$ is always positive. The sign of $\\lambda_2 = U - \\sqrt{gH}$ determines the regime.\nThe transition occurs when $\\lambda_2 = 0$, which means $U = \\sqrt{gH}$. In terms of the Froude number, this condition is $\\frac{U}{\\sqrt{gH}} = 1$, or $\\mathrm{Fr} = 1$.\nThis critical value, $\\mathrm{Fr}_{c}$, separates the subcritical and supercritical regimes.\n$$\n\\mathrm{Fr}_{c} = 1\n$$\n-   **Subcritical flow**: $U < \\sqrt{gH} \\implies \\mathrm{Fr} < 1$. In this case, $\\lambda_2 < 0$.\n-   **Supercritical flow**: $U > \\sqrt{gH} \\implies \\mathrm{Fr} > 1$. In this case, $\\lambda_2 > 0$.\n\n**Boundary Conditions**\n\nThe number of scalar boundary conditions required at a boundary is equal to the number of characteristic waves propagating into the computational domain at that boundary.\n-   At the upstream boundary ($x=0$), incoming characteristics have positive speeds ($\\lambda > 0$).\n-   At the downstream boundary ($x=L$), incoming characteristics have negative speeds ($\\lambda < 0$).\n\n1.  **Subcritical Regime ($\\mathrm{Fr} < 1$)**\n    -   Here, $U < \\sqrt{gH}$.\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$. This characteristic is incoming at $x=0$.\n    -   $\\lambda_2 = U - \\sqrt{gH} < 0$. This characteristic is incoming at $x=L$.\n    -   Number of conditions at upstream ($x=0$): $N_{\\text{up}}^{\\text{sub}} = 1$.\n    -   Number of conditions at downstream ($x=L$): $N_{\\text{down}}^{\\text{sub}} = 1$.\n\n2.  **Supercritical Regime ($\\mathrm{Fr} > 1$)**\n    -   Here, $U > \\sqrt{gH}$.\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$. This characteristic is incoming at $x=0$.\n    -   $\\lambda_2 = U - \\sqrt{gH} > 0$. This characteristic is also incoming at $x=0$.\n    -   Number of conditions at upstream ($x=0$): $N_{\\text{up}}^{\\text{super}} = 2$.\n    -   Number of conditions at downstream ($x=L$): a characteristic is incoming if its speed is negative. Since both $\\lambda_1$ and $\\lambda_2$ are positive, no characteristics are incoming at $x=L$. $N_{\\text{down}}^{\\text{super}} = 0$.\n\n**Final Answer Assembly**\n\nThe problem asks for the row matrix $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$.\n-   $\\mathrm{Fr}_{c} = 1$\n-   $N_{\\text{up}}^{\\text{sub}} = 1$\n-   $N_{\\text{down}}^{\\text{sub}} = 1$\n-   $N_{\\text{up}}^{\\text{super}} = 2$\n-   $N_{\\text{down}}^{\\text{super}} = 0$\n\nThe final result is the ordered collection of these five numbers.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1 & 2 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Translating physical equations into a stable numerical simulation requires careful consideration of the discretization parameters, such as the time step $\\Delta t$ and grid spacing $\\Delta x$. This practice guides you through a von Neumann stability analysis, a cornerstone technique for assessing numerical schemes. You will derive the celebrated Courant-Friedrichs-Lewy (CFL) condition for a simple advection problem, providing a concrete rule relating $\\Delta t$ and $\\Delta x$ to ensure a stable simulation. ",
            "id": "4103368",
            "problem": "Consider the one-dimensional transport of the free-surface height in the Shallow Water Equations, modeled as linear advection arising from the continuity equation under a spatially uniform, steady velocity. Starting from the conservation of mass for a shallow layer, the continuity equation is $$\\frac{\\partial h}{\\partial t} + \\frac{\\partial (h u)}{\\partial x} = 0,$$ where $h$ is the layer thickness and $u$ is the horizontal velocity. In a regime with a prescribed spatially uniform mean velocity $U$ and small departures in $h$ that are passively transported, this reduces to the linear advection equation $$\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0,$$ on a periodic domain. Discretize this equation on a uniform grid $x_j = j\\,\\Delta x$ with explicit forward Euler time stepping $t^n = n\\,\\Delta t$ and a first-order upwind spatial discretization consistent with the sign of $U$. That is, for $U>0$, use $$h^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right),$$ and for $U<0$, use $$h^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right),$$ where $C = \\frac{U\\,\\Delta t}{\\Delta x}$ is the Courant number. Assume periodic boundary conditions and perform a von Neumann analysis (Fourier mode analysis) to determine the discrete Lebesgue square-integrable ($L^2$) stability condition, defined here as the requirement that the discrete $L^2$ norm of $h$ does not grow in time for arbitrary initial data.\n\nDerive this stability condition by computing the amplification factor and imposing its modulus to be less than or equal to $1$ for all wavenumbers. Then, report the largest allowable time step, denoted $\\Delta t_{\\max}$, that guarantees discrete $L^2$ stability on this uniform grid. Express your final answer as a single closed-form symbolic expression in terms of $\\Delta x$ and $|U|$. You should not substitute numerical values. If you later evaluate a numerical value, express the time in seconds. No rounding is required in this problem.",
            "solution": "The problem requires the derivation of the discrete $L^2$ stability condition for a first-order upwind discretization of the linear advection equation, using von Neumann analysis. From this condition, the largest allowable time step, $\\Delta t_{\\max}$, must be determined.\n\nThe governing partial differential equation is the linear advection equation:\n$$\n\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0\n$$\nwhere $h$ is the fluid depth, $t$ is time, $x$ is the spatial coordinate, and $U$ is a constant, uniform velocity.\n\nThe equation is discretized on a uniform grid $x_j = j\\,\\Delta x$ and $t^n = n\\,\\Delta t$. The numerical scheme is the forward-in-time, first-order upwind-in-space method. The specific form of the scheme depends on the sign of the velocity $U$. The Courant number is defined as $C = \\frac{U\\,\\Delta t}{\\Delta x}$.\n\nTo perform a von Neumann stability analysis, we consider a single Fourier mode of the solution at a given time level $n$:\n$$\nh^n_j = \\hat{h}^n(k) e^{i k x_j} = \\hat{h}^n(k) e^{i k j \\Delta x}\n$$\nwhere $k$ is the wavenumber and $i$ is the imaginary unit. The numerical scheme propagates this mode in time according to:\n$$\nh^{n+1}_j = G(k) h^n_j\n$$\nwhere $G(k)$ is the amplification factor, which depends on the wavenumber $k$ and the discretization parameters. The scheme is stable in the $L^2$ sense if and only if the modulus of the amplification factor is less than or equal to one for all possible wavenumbers:\n$$\n|G(k)| \\le 1 \\quad \\forall k\n$$\n\nWe must analyze the two cases for the sign of $U$.\n\nCase 1: $U > 0$\nFor a positive velocity, the upwind direction is from $j-1$ to $j$. The discretization is given by:\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right)\n$$\nIn this case, since $U > 0$, the Courant number $C = \\frac{U\\,\\Delta t}{\\Delta x}$ is also positive.\nSubstituting the Fourier mode into the scheme gives:\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k j \\Delta x} - \\hat{h}^n(k) e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing by $\\hat{h}^n(k) e^{i k j \\Delta x}$ (which is non-zero) yields the amplification factor:\n$$\nG(k) = 1 - C \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\nLet $\\theta = k \\Delta x$ be the dimensionless wavenumber. Then:\n$$\nG(\\theta) = 1 - C(1 - e^{-i\\theta}) = 1 - C(1 - (\\cos\\theta - i\\sin\\theta))\n$$\n$$\nG(\\theta) = (1 - C + C\\cos\\theta) + i(C\\sin\\theta)\n$$\nThe squared modulus of the amplification factor is:\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ requires:\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\nSince $1 - \\cos\\theta \\ge 0$ for all real $\\theta$, the inequality simplifies to:\n$$\nC(1-C) \\ge 0\n$$\nAs $U>0$, we have $C > 0$. Therefore, for the product to be non-negative, we must have $1-C \\ge 0$, which implies $C \\le 1$. The stability condition for $U>0$ is $0 < C \\le 1$.\n\nCase 2: $U < 0$\nFor a negative velocity, the upwind direction is from $j+1$ to $j$. The discretization is given by:\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right)\n$$\nIn this case, since $U < 0$, the Courant number $C = \\frac{U\\,\\Delta t}{\\Delta x}$ is negative.\nSubstituting the Fourier mode into the scheme gives:\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k (j+1) \\Delta x} - \\hat{h}^n(k) e^{i k j \\Delta x} \\right)\n$$\nDividing by $\\hat{h}^n(k) e^{i k j \\Delta x}$ yields the amplification factor:\n$$\nG(k) = 1 - C \\left( e^{i k \\Delta x} - 1 \\right)\n$$\nAgain, let $\\theta = k \\Delta x$:\n$$\nG(\\theta) = 1 - C(e^{i\\theta} - 1) = 1 - C((\\cos\\theta - 1) + i\\sin\\theta)\n$$\n$$\nG(\\theta) = (1 - C(\\cos\\theta - 1)) - i(C\\sin\\theta)\n$$\nThe squared modulus of the amplification factor is:\n$$\n|G(\\theta)|^2 = (1 + C - C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + C^2 - 2C(1+C)\\cos\\theta + C^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C(1+C) - 2C(1+C)\\cos\\theta = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ requires:\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\nSince $1 - \\cos\\theta \\ge 0$, the inequality simplifies to:\n$$\nC(1+C) \\le 0\n$$\nAs $U < 0$, we have $C < 0$. Therefore, for the product to be non-positive, we must have $1+C \\ge 0$, which implies $C \\ge -1$. The stability condition for $U < 0$ is $-1 \\le C < 0$.\n\nCombining both cases:\n- For $U > 0$, we have $0 < C \\le 1$, which is $0 < \\frac{U \\Delta t}{\\Delta x} \\le 1$. Since $U = |U|$, this is $\\frac{|U| \\Delta t}{\\Delta x} \\le 1$.\n- For $U < 0$, we have $-1 \\le C < 0$, which is $-1 \\le \\frac{U \\Delta t}{\\Delta x} < 0$. Since $U = -|U|$, this is $-1 \\le \\frac{-|U| \\Delta t}{\\Delta x} < 0$. Multiplying by $-1$ reverses the inequalities, yielding $1 \\ge \\frac{|U| \\Delta t}{\\Delta x} > 0$.\n\nBoth cases lead to the identical stability criterion, known as the Courant-Friedrichs-Lewy (CFL) condition for this scheme:\n$$\n\\frac{|U| \\Delta t}{\\Delta x} \\le 1\n$$\nThis condition guarantees that the $L^2$ norm of the numerical solution does not grow in time.\n\nTo find the largest allowable time step, $\\Delta t_{\\max}$, we take the equality in the stability condition:\n$$\n\\frac{|U| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{\\max}$ yields:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|U|}\n$$\nThis expression assumes $U \\neq 0$, which is implicit in the context of an advection problem.",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|U|}}\n$$"
        }
    ]
}