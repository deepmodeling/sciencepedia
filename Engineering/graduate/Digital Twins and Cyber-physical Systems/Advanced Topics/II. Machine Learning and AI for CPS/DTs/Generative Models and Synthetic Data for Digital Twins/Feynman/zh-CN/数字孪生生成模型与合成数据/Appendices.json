{
    "hands_on_practices": [
        {
            "introduction": "当利用生成模型创建的合成数据来训练数字孪生时，一个核心挑战是合成数据分布与真实世界数据分布之间不可避免的差异。直接混合使用这些数据源可能会导致模型产生偏差。本实践将引导你推导一种名为重要性加权（importance weighting）的基本技术，通过为合成样本分配适当的权重，可以校正这种分布偏移，从而确保学习到的模型是无偏的。掌握这一方法对于构建精确可靠的数字孪生至关重要。",
            "id": "4224964",
            "problem": "考虑一个受控信息物理系统的数字孪生，其单步前向状态演化模型为 $x_{t+1} = f_{\\theta}(x_{t}, u_{t})$，其中 $x_{t} \\in \\mathbb{R}^{n}$ 且 $u_{t} \\in \\mathbb{R}^{m}$。令 $(x_{t}, u_{t}, x_{t+1})$ 为定义在公共可测空间 $(\\mathcal{Z}, \\mathcal{F})$ 上的随机变量，其目标真实世界联合分布为 $P_{r}$，由生成模型导出的合成联合分布为 $P_{s}$。假设在 $(\\mathcal{Z}, \\mathcal{F})$ 上，$P_{r}$ 关于 $P_{s}$ 是绝对连续的，并且两者都存在关于一个公共支配测度的密度函数 $p_{r}$ 和 $p_{s}$。\n\n您的目标是通过最小化真实世界分布下的期望风险来学习 $\\theta$：\n$$\nR(\\theta) = \\mathbb{E}_{(x_{t}, u_{t}, x_{t+1}) \\sim P_{r}}\\big[\\ell\\big(x_{t+1}, f_{\\theta}(x_{t}, u_{t})\\big)\\big],\n$$\n其中 $\\ell: \\mathbb{R}^{n} \\times \\mathbb{R}^{n} \\to \\mathbb{R}_{\\ge 0}$ 是一个可微的损失函数，满足交换微分和期望运算所需满足的正则性条件。\n\n由于真实世界的数据可能有限，您构建了一个混合真实数据和合成数据的联合目标函数：\n$$\nJ(\\theta; \\alpha, w_{s}) = (1 - \\alpha)\\,\\mathbb{E}_{P_{r}}\\big[\\ell\\big(x_{t+1}, f_{\\theta}(x_{t}, u_{t})\\big)\\big] + \\alpha\\,\\mathbb{E}_{P_{s}}\\big[w_{s}(x_{t}, u_{t}, x_{t+1})\\,\\ell\\big(x_{t+1}, f_{\\theta}(x_{t}, u_{t})\\big)\\big],\n$$\n其中混合系数 $\\alpha \\in (0, 1)$，非负权重函数 $w_{s}: \\mathcal{Z} \\to \\mathbb{R}_{\\ge 0}$ 有待确定。\n\n仅从期望、绝对连续性和测度变换的基本定义出发，推导出一个唯一的权重函数 $w_{s}^{\\star}(x_{t}, u_{t}, x_{t+1})$ 的闭式表达式。该函数能够消除目标函数 $J(\\theta; \\alpha, w_{s})$ 相对于 $\\theta$ 的梯度中由分布差异引起的偏差，即对于所有 $\\theta$ 和所有满足所述正则性条件的可微损失函数 $\\ell$，都满足 $\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}^{\\star}) = \\nabla_{\\theta} R(\\theta)$。请用密度函数 $p_{r}$ 和 $p_{s}$ 将您的最终答案表示为单个解析表达式。无需数值近似。",
            "solution": "所述问题在科学上是合理的、自洽的，并且在数学上是适定的。生成模型、数字孪生、风险最小化和重要性加权等概念是现代机器学习和控制理论中的标准内容。其依赖于测度论和微积分的数学框架是严谨的。因此，我将进行完整的解题推导。\n\n目标是找到唯一的权重函数 $w_{s}^{\\star}(x_{t}, u_{t}, x_{t+1})$，以确保对于所有有效的模型参数 $\\theta$ 和损失函数 $\\ell$，混合目标函数 $J(\\theta; \\alpha, w_{s})$ 的梯度与真实风险 $R(\\theta)$ 的梯度完全相同。该条件表示为：\n$$\n\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}^{\\star}) = \\nabla_{\\theta} R(\\theta)\n$$\n\n我们首先将风险 $R(\\theta)$ 和目标函数 $J(\\theta; \\alpha, w_{s})$ 表示为积分形式。令 $z$ 为随机变量三元组 $(x_{t}, u_{t}, x_{t+1})$ 的简写。定义域 $\\mathcal{Z}$ 是 $\\mathbb{R}^{n} \\times \\mathbb{R}^{m} \\times \\mathbb{R}^{n}$ 的一个子集。给定的密度函数是 $p_r(z)$ 和 $p_s(z)$，它们都关于一个公共支配测度 $\\mu$。对于模型 $f_\\theta$，在点 $z$ 处评估的损失函数为 $\\ell(x_{t+1}, f_{\\theta}(x_t, u_t))$，我们将其记为 $L(z, \\theta)$。\n\n在真实世界分布 $P_r$ 下的期望风险定义为：\n$$\nR(\\theta) = \\mathbb{E}_{P_{r}}[L(z, \\theta)] = \\int_{\\mathcal{Z}} L(z, \\theta) p_{r}(z) d\\mu(z)\n$$\n混合目标函数 $J(\\theta; \\alpha, w_{s})$ 由下式给出：\n$$\nJ(\\theta; \\alpha, w_{s}) = (1 - \\alpha) \\mathbb{E}_{P_{r}}[L(z, \\theta)] + \\alpha \\mathbb{E}_{P_{s}}[w_{s}(z) L(z, \\theta)]\n$$\n代入积分形式：\n$$\nJ(\\theta; \\alpha, w_{s}) = (1-\\alpha) R(\\theta) + \\alpha \\int_{\\mathcal{Z}} w_{s}(z) L(z, \\theta) p_{s}(z) d\\mu(z)\n$$\n问题要求我们找到 $w_s = w_s^{\\star}$，使得 $\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}^{\\star}) = \\nabla_{\\theta} R(\\theta)$。我们来计算 $J(\\theta; \\alpha, w_{s})$ 相对于 $\\theta$ 的梯度：\n$$\n\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}) = \\nabla_{\\theta} \\left( (1-\\alpha) R(\\theta) + \\alpha \\int_{\\mathcal{Z}} w_{s}(z) L(z, \\theta) p_{s}(z) d\\mu(z) \\right)\n$$\n根据梯度算子的线性性质：\n$$\n\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}) = (1-\\alpha) \\nabla_{\\theta} R(\\theta) + \\alpha \\nabla_{\\theta} \\left( \\int_{\\mathcal{Z}} w_{s}(z) L(z, \\theta) p_{s}(z) d\\mu(z) \\right)\n$$\n问题陈述，损失函数 $\\ell$ 和模型 $f_{\\theta}$ 满足允许微分和期望（积分）互换的正则性条件。将此条件应用于 $\\nabla_{\\theta}R(\\theta)$ 和第二项：\n$$\n\\nabla_{\\theta} R(\\theta) = \\int_{\\mathcal{Z}} \\nabla_{\\theta} L(z, \\theta) p_{r}(z) d\\mu(z)\n$$\n以及\n$$\n\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}) = (1-\\alpha) \\nabla_{\\theta} R(\\theta) + \\alpha \\int_{\\mathcal{Z}} w_{s}(z) (\\nabla_{\\theta} L(z, \\theta)) p_{s}(z) d\\mu(z)\n$$\n现在，我们强制施加条件 $\\nabla_{\\theta} J(\\theta; \\alpha, w_{s}^{\\star}) = \\nabla_{\\theta} R(\\theta)$：\n$$\n(1-\\alpha) \\nabla_{\\theta} R(\\theta) + \\alpha \\int_{\\mathcal{Z}} w_{s}^{\\star}(z) (\\nabla_{\\theta} L(z, \\theta)) p_{s}(z) d\\mu(z) = \\nabla_{\\theta} R(\\theta)\n$$\n从两边减去 $(1-\\alpha) \\nabla_{\\theta} R(\\theta)$ 得到：\n$$\n\\alpha \\int_{\\mathcal{Z}} w_{s}^{\\star}(z) (\\nabla_{\\theta} L(z, \\theta)) p_{s}(z) d\\mu(z) = \\alpha \\nabla_{\\theta} R(\\theta)\n$$\n因为 $\\alpha \\in (0, 1)$，所以 $\\alpha$ 非零，我们可以用它来除：\n$$\n\\int_{\\mathcal{Z}} w_{s}^{\\star}(z) (\\nabla_{\\theta} L(z, \\theta)) p_{s}(z) d\\mu(z) = \\nabla_{\\theta} R(\\theta)\n$$\n代入 $\\nabla_{\\theta} R(\\theta)$ 的积分表达式：\n$$\n\\int_{\\mathcal{Z}} w_{s}^{\\star}(z) (\\nabla_{\\theta} L(z, \\theta)) p_{s}(z) d\\mu(z) = \\int_{\\mathcal{Z}} (\\nabla_{\\theta} L(z, \\theta)) p_{r}(z) d\\mu(z)\n$$\n这个方程可以重排成一个单一积分：\n$$\n\\int_{\\mathcal{Z}} \\left[ w_{s}^{\\star}(z) p_{s}(z) - p_{r}(z) \\right] (\\nabla_{\\theta} L(z, \\theta)) d\\mu(z) = 0\n$$\n这个恒等式必须对所有参数 $\\theta$ 和所有满足指定条件的可微损失函数 $\\ell$ 成立。项 $\\nabla_{\\theta} L(z, \\theta)$ 代表了一个庞大的函数族。根据变分法基本引理，如果一个函数与一个足够丰富的类中的任意测试函数相乘后的积分为零，那么该函数本身必须几乎处处为零。因此，对于 $\\mu$-几乎所有的 $z \\in \\mathcal{Z}$，方括号中的项必须为零。\n$$\nw_{s}^{\\star}(z) p_{s}(z) - p_{r}(z) = 0\n$$\n这意味着 $w_{s}^{\\star}(z) p_{s}(z) = p_{r}(z)$。\n\n我们现在可以解出 $w_{s}^{\\star}(z)$。问题陈述，$P_r$ 关于 $P_s$ 是绝对连续的，这意味着对于任何可测集 $A \\subseteq \\mathcal{Z}$，如果 $P_s(A) = 0$，那么 $P_r(A) = 0$。用密度函数来说，这意味着对于几乎所有使得 $p_s(z) = 0$ 的 $z$，$p_r(z) = 0$。\n因此，对于所有 $p_s(z) \\neq 0$ 的 $z$，我们可以安全地除以 $p_s(z)$：\n$$\nw_{s}^{\\star}(z) = \\frac{p_{r}(z)}{p_{s}(z)}\n$$\n对于 $p_s(z) = 0$ 的零测度集， $w_s^{\\star}(z)$ 的值与定义关于 $P_s$ 的期望的积分无关。上述表达式是 $P_r$ 关于 $P_s$ 的拉东-尼科迪姆导数，记为 $\\frac{dP_r}{dP_s}(z)$，并且它在 $P_s$-几乎处处是唯一的。\n\n用原始变量 $(x_{t}, u_{t}, x_{t+1})$ 重新表示结果：\n$$\nw_{s}^{\\star}(x_{t}, u_{t}, x_{t+1}) = \\frac{p_{r}(x_{t}, u_{t}, x_{t+1})}{p_{s}(x_{t}, u_{t}, x_{t+1})}\n$$\n这就是消除目标函数梯度中分布偏差的唯一权重函数的闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{p_{r}(x_{t}, u_{t}, x_{t+1})}{p_{s}(x_{t}, u_{t}, x_{t+1})}}\n$$"
        },
        {
            "introduction": "数字孪生的一个强大功能是进行“假设”（what-if）分析，这本质上是因果问题，而非简单的关联性问题。本练习将深入探讨因果推断的核心，通过一个具体的结构因果模型，从数学上区分“观察到关联”（条件化）与“主动干预产生效果”（干预）之间的根本差异。理解这一区别对于利用数字孪生进行可靠的预测和决策至关重要。",
            "id": "4225068",
            "problem": "一个信息物理供暖、通风和空调系统的数字孪生，使用一个从观测数据中学习到的生成模型来模拟结果。该生成模型是一个基于二元变量的有向无环图 (DAG)，其结构如下：一个未观测到的上下文变量 $U$ 同时影响控制动作 $A$ 和结果 $Y$，而控制动作 $A$ 也影响结果 $Y$。因果图为 $U \\rightarrow A$、$U \\rightarrow Y$ 和 $A \\rightarrow Y$。假设一个结构因果模型 (SCM)，其观测联合分布根据该 DAG 分解为 $p(U)\\,p(A \\mid U)\\,p(Y \\mid A, U)$，并具有以下条件概率表：\n- $U \\sim \\text{Bernoulli}\\!\\left(\\frac{1}{2}\\right)$，因此 $p(U=1)=\\frac{1}{2}$ 且 $p(U=0)=\\frac{1}{2}$。\n- $p(A=1 \\mid U=1)=\\frac{4}{5}$ 且 $p(A=1 \\mid U=0)=\\frac{1}{5}$。\n- $p(Y=1 \\mid A=1, U=1)=\\frac{9}{10}$，$p(Y=1 \\mid A=1, U=0)=\\frac{3}{5}$，$p(Y=1 \\mid A=0, U=1)=\\frac{7}{10}$ 且 $p(Y=1 \\mid A=0, U=0)=\\frac{1}{10}$。\n\n在该数字孪生中，一个反事实策略规划查询需要区分“对观测到的动作施加条件”与“通过干预来设定动作”。仅从条件概率的核心定义和结构因果模型中的干预语义（即干预 $\\text{do}(A=a)$ 会替换 $A$ 的生成机制并切断所有指向 $A$ 的箭头）出发，推导该系统的观测量 $p(Y=1 \\mid A=1)$ 和干预量 $p\\!\\left(Y=1 \\mid \\text{do}(A=1)\\right)$。然后计算标量差\n$$\n\\Delta \\;=\\; p(Y=1 \\mid A=1)\\;-\\;p\\!\\left(Y=1 \\mid \\text{do}(A=1)\\right).\n$$\n将 $\\Delta$ 的精确值报告为单个数字，无需四舍五入。无需单位。",
            "solution": "问题要求计算标量差 $\\Delta$，其定义为 $\\Delta = p(Y=1 \\mid A=1) - p(Y=1 \\mid \\text{do}(A=1))$。这涉及到从给定的结构因果模型中推导出一个观测概率和一个干预概率。我们将分别计算每一项。\n\n首先，我们计算观测条件概率 $p(Y=1 \\mid A=1)$。根据条件概率的定义，它由以下公式给出：\n$$p(Y=1 \\mid A=1) = \\frac{p(Y=1, A=1)}{p(A=1)}$$\n为了求出分子和分母中的概率，我们必须对未观测到的上下文变量 $U$ 上的完全联合分布 $p(U, A, Y)$ 进行边缘化。问题指明，联合分布根据有向无环图分解为 $p(U, A, Y) = p(U)p(A \\mid U)p(Y \\mid A, U)$。\n\n让我们通过应用全概率定律来计算分母 $p(A=1)$：\n$$p(A=1) = \\sum_{u \\in \\{0, 1\\}} p(A=1, U=u) = \\sum_{u \\in \\{0, 1\\}} p(A=1 \\mid U=u) p(U=u)$$\n该表达式展开为：\n$$p(A=1) = p(A=1 \\mid U=1) p(U=1) + p(A=1 \\mid U=0) p(U=0)$$\n使用给定的值 $p(A=1 \\mid U=1)=\\frac{4}{5}$、$p(A=1 \\mid U=0)=\\frac{1}{5}$ 和 $p(U=1)=p(U=0)=\\frac{1}{2}$：\n$$p(A=1) = \\left(\\frac{4}{5}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{5}\\right)\\left(\\frac{1}{2}\\right) = \\frac{4}{10} + \\frac{1}{10} = \\frac{5}{10} = \\frac{1}{2}$$\n\n接下来，我们通过对 $U$ 进行边缘化来计算分子，即联合概率 $p(Y=1, A=1)$：\n$$p(Y=1, A=1) = \\sum_{u \\in \\{0, 1\\}} p(Y=1, A=1, U=u)$$\n基于模型的分解应用链式法则：\n$$p(Y=1, A=1) = p(Y=1 \\mid A=1, U=1) p(A=1 \\mid U=1) p(U=1) + p(Y=1 \\mid A=1, U=0) p(A=1 \\mid U=0) p(U=0)$$\n代入所有给定的概率值：\n$$p(Y=1, A=1) = \\left(\\frac{9}{10}\\right)\\left(\\frac{4}{5}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{3}{5}\\right)\\left(\\frac{1}{5}\\right)\\left(\\frac{1}{2}\\right)$$\n$$p(Y=1, A=1) = \\frac{36}{100} + \\frac{3}{50} = \\frac{36}{100} + \\frac{6}{100} = \\frac{42}{100} = \\frac{21}{50}$$\n现在我们可以计算观测概率：\n$$p(Y=1 \\mid A=1) = \\frac{p(Y=1, A=1)}{p(A=1)} = \\frac{21/50}{1/2} = \\frac{21 \\times 2}{50} = \\frac{42}{50} = \\frac{21}{25}$$\n\n第二，我们计算干预概率 $p(Y=1 \\mid \\text{do}(A=1))$。干预 $\\text{do}(A=1)$ 通过切断所有指向 $A$ 的箭头（在此例中为箭头 $U \\rightarrow A$）并把 $A$ 的值设为 1 来修改因果图。在这个被操纵的系统中，结果 $Y$ 的概率是通过对混杂变量 $U$ 进行调整来找到的，该变量位于“后门路径” $A \\leftarrow U \\rightarrow Y$ 上。用于此调整的公式是：\n$$p(Y=1 \\mid \\text{do}(A=1)) = \\sum_{u \\in \\{0, 1\\}} p(Y=1 \\mid A=1, U=u) p(U=u)$$\n该表达式表示 $A=1$ 对 $Y$ 的平均因果效应，由混杂变量 $U$ 的先验分布加权。展开求和：\n$$p(Y=1 \\mid \\text{do}(A=1)) = p(Y=1 \\mid A=1, U=1) p(U=1) + p(Y=1 \\mid A=1, U=0) p(U=0)$$\n代入已知值：\n$$p(Y=1 \\mid \\text{do}(A=1)) = \\left(\\frac{9}{10}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{3}{5}\\right)\\left(\\frac{1}{2}\\right) = \\frac{9}{20} + \\frac{3}{10} = \\frac{9}{20} + \\frac{6}{20} = \\frac{15}{20} = \\frac{3}{4}$$\n\n最后，我们计算所求的差 $\\Delta$：\n$$\\Delta = p(Y=1 \\mid A=1) - p(Y=1 \\mid \\text{do}(A=1))$$\n$$\\Delta = \\frac{21}{25} - \\frac{3}{4}$$\n为了进行分数减法，我们找到公分母 100：\n$$\\Delta = \\frac{21 \\times 4}{25 \\times 4} - \\frac{3 \\times 25}{4 \\times 25} = \\frac{84}{100} - \\frac{75}{100} = \\frac{9}{100}$$\n这个非零的差异代表了混杂偏倚，即 $A$ 和 $Y$ 之间的统计关联中，并非由 $A$ 到 $Y$ 的因果联系引起，而是由它们的共同原因 $U$ 所导致的部分。",
            "answer": "$$\\boxed{\\frac{9}{100}}$$"
        },
        {
            "introduction": "一个对安全性和可靠性分析有用的数字孪生，不仅要能模拟系统的典型行为，还必须能复现罕见但影响重大的极端事件。本实践将介绍一个强大的统计框架——极值理论（Extreme Value Theory），用于构建能够真实合成这些关键“尾部”事件的生成模型。这使得我们能够对网络物理系统进行稳健的虚拟压力测试，而无需等待真实世界中代价高昂的极端情况发生。",
            "id": "4224998",
            "problem": "一个信息物理系统 (CPS) 监测以千牛顿 (kN) 为单位的结构载荷。其数字孪生必须生成合成载荷数据，以真实地复制极端事件，用于下游的应力测试。为了纠正基线主体分布生成器对极端事件的代表性不足问题，您将通过超阈值峰值方法推导合适的尾部模型，然后使用从 CPS 观测到的超阈值统计数据对其进行校准。\n\n从以下基本出发点开始：如果一个母分布 $F$ 属于具有形状指数 $\\xi$ 的广义极值分布 (GEV) 的最大吸引域，那么其上尾分位数函数 $U(t) = F^{-1}(1 - 1/t)$ 表现出扩展的正则变差。此外，超阈值的分布可以通过条件化和适当的归一化用 $F$ 来表示。利用这些基本事实来：\n\n1. 通过分析当 $u$ 增加时 $P\\!\\left(\\frac{X - u}{\\beta(u)} \\leq y \\,\\middle|\\, X > u\\right)$ 的极限，推导在 $X > u$ 条件下，经过缩放的超阈值量 $X - u$ 的非退化极限族，其中 $\\beta(u) > 0$ 是一个合适的缩放函数。证明与阈值稳定性和扩展正则变差一致的唯一可能的连续极限族是广义帕累托族，其形状指数 $\\xi$ 与相关 GEV 的形状指数相匹配，其尺度渐近地与 $\\beta(u)$ 成正比。\n\n2. CPS 产生了一个大小为 $N = 10^{6}$ 的大样本。对于一个高阈值 $u = 110$ kN，超过该阈值的次数为 $n_{u} = 150$。超过 $u$ 的超阈值的经验均值为 $\\hat{m} = 8$ kN，经验方差为 $\\hat{v} = 144$ kN$^{2}$。使用矩估计法将广义帕累托尾部拟合到超阈值数据，以基于 $\\hat{m}$ 和 $\\hat{v}$ 获得估计值 $\\hat{\\xi}$ 和 $\\hat{\\beta}$。\n\n3. 将 $u$ 以上的尾部视为对基线生成器的拼接，将 $x \\geq u$ 的无条件生存函数建模为 $P(X > x) \\approx p_{u}\\,S_{\\text{GPD}}(x - u)$，其中 $p_{u} = P(X > u)$ 由 $n_{u}/N$ 估计，$S_{\\text{GPD}}$ 是参数为 $(\\hat{\\xi}, \\hat{\\beta})$ 的广义帕累托生存函数。使用此模型，计算 $p = 0.99995$ 的无条件 $p$-分位数。用千牛顿表示您的最终数值答案，并四舍五入到四位有效数字。\n\n仅报告 $0.99995$-分位数的值作为您的最终答案。",
            "solution": "该问题要求进行三部分分析，包括推导作为尾部模型的广义帕累托分布 (GPD)，使用矩估计法估计其参数，以及从所得模型中计算高分位数。该问题在科学上是合理的，提法明确，并包含所有必要信息。我们开始解题。\n\n### 第1部分：广义帕累托分布的推导\n我们的任务是推导在 $X > u$ 条件下，经过缩放的超阈值量 $X-u$ 的极限分布。设随机变量 $X$ 的母分布为 $F(x) = P(X \\leq x)$，其生存函数为 $S(x) = 1-F(x)$。在给定发生超阈值的情况下，超阈值量 $Y = X-u$ 超过阈值 $u$ 的条件分布函数为\n$$F_u(y) = P(X-u \\leq y \\,|\\, X > u) = \\frac{P(u  X \\leq u+y)}{P(X  u)} = \\frac{F(u+y) - F(u)}{1 - F(u)}$$\n问题考虑了对于某个缩放函数 $\\beta(u)  0$，经过缩放的超阈值量 $(X-u)/\\beta(u)$。这个缩放后超阈值量的累积分布函数 (CDF) 是\n$$P\\left(\\frac{X-u}{\\beta(u)} \\leq y \\,\\middle|\\, X  u\\right) = \\frac{F(u+y\\beta(u)) - F(u)}{1 - F(u)} = 1 - \\frac{1-F(u+y\\beta(u))}{1-F(u)} = 1 - \\frac{S(u+y\\beta(u))}{S(u)}$$\n前提是母分布 $F$ 属于具有形状参数 $\\xi$ 的广义极值分布 (GEV) 的最大吸引域。极值理论中的一个基本结果 (Pickands–Balkema–de Haan 定理) 指出，该条件等价于存在一个正的缩放函数 $\\sigma(u)$，使得对于右端点 $x_F = \\sup\\{x: F(x)1\\}$，以下极限成立：\n$$\\lim_{u \\to x_F} \\frac{S(u+y\\sigma(u))}{S(u)} = \\lim_{u \\to x_F} \\frac{1-F(u+y\\sigma(u))}{1-F(u)} = (1+\\xi y)^{-1/\\xi}$$\n对于所有满足 $1+\\xi y  0$ 的 $y$。此性质被称为阈值稳定性。\n\n为了找到缩放后超阈值量的极限分布，我们选择缩放函数 $\\beta(u)$ 就是这个函数 $\\sigma(u)$。当 $u \\to x_F$ 时取极限，我们得到：\n$$\\lim_{u \\to x_F} P\\left(\\frac{X-u}{\\sigma(u)} \\leq y \\,\\middle|\\, X  u\\right) = 1 - \\lim_{u \\to x_F} \\frac{S(u+y\\sigma(u))}{S(u)} = 1 - (1+\\xi y)^{-1/\\xi}$$\n这个极限累积分布函数 $H(y) = 1 - (1+\\xi y)^{-1/\\xi}$ 是具有形状参数 $\\xi$ 的标准广义帕累托分布 (GPD) 的 CDF。当 $\\xi \\geq 0$ 时，$y$ 的支撑集为 $y \\geq 0$；当 $\\xi  0$ 时，为 $0 \\leq y \\leq -1/\\xi$。在 $\\xi=0$ 的特殊情况下，取其极限，得到标准指数分布的 CDF，$H(y) = 1 - \\exp(-y)$。\n\n这个推导表明，对于一个足够高的阈值 $u$，超阈值量 $X-u$ 的分布可以由一个 GPD 来近似，其形状参数为 $\\xi$，尺度参数 $\\beta$ 由母分布尾部的行为决定，具体来说 $\\beta = \\sigma(u)$。对于一个超阈值量 $z$，这个非标准 GPD 的 CDF 由 $G_{\\xi, \\beta}(z) = 1 - (1+\\xi z/\\beta)^{-1/\\xi}$ 给出。这确立了在给定假设下，GPD 是超阈值的正确极限族。\n\n### 第2部分：通过矩估计法进行参数估计\n具有形状参数 $\\xi$ 和尺度参数 $\\beta$ 的广义帕累托分布具有以下均值和方差，前提是参数满足特定条件：\n$$E[Y] = \\frac{\\beta}{1-\\xi}, \\quad \\text{for } \\xi  1$$\n$$\\text{Var}(Y) = \\frac{\\beta^2}{(1-\\xi)^2(1-2\\xi)}, \\quad \\text{for } \\xi  \\frac{1}{2}$$\n矩估计法在于将这些理论矩与从数据中计算出的经验矩相等同。给定的数据是超阈值的经验均值 $\\hat{m} = 8$ 和超阈值的经验方差 $\\hat{v} = 144$。我们为估计值 $\\hat{\\xi}$ 和 $\\hat{\\beta}$ 建立方程组：\n$$ \\hat{m} = \\frac{\\hat{\\beta}}{1-\\hat{\\xi}} \\quad (1) $$\n$$ \\hat{v} = \\frac{\\hat{\\beta}^2}{(1-\\hat{\\xi})^2(1-2\\hat{\\xi})} \\quad (2) $$\n我们可以通过注意到 $\\text{Var}(Y) = (E[Y])^2 / (1-2\\xi)$ 来找到矩之间的关系。代入估计量：\n$$ \\hat{v} = \\frac{\\hat{m}^2}{1-2\\hat{\\xi}} $$\n我们求解 $\\hat{\\xi}$：\n$$ 1-2\\hat{\\xi} = \\frac{\\hat{m}^2}{\\hat{v}} \\implies 2\\hat{\\xi} = 1 - \\frac{\\hat{m}^2}{\\hat{v}} \\implies \\hat{\\xi} = \\frac{1}{2}\\left(1 - \\frac{\\hat{m}^2}{\\hat{v}}\\right) $$\n代入给定值 $\\hat{m}=8$ 和 $\\hat{v}=144$：\n$$ \\hat{\\xi} = \\frac{1}{2}\\left(1 - \\frac{8^2}{144}\\right) = \\frac{1}{2}\\left(1 - \\frac{64}{144}\\right) = \\frac{1}{2}\\left(1 - \\frac{4}{9}\\right) = \\frac{1}{2}\\left(\\frac{5}{9}\\right) = \\frac{5}{18} $$\n值 $\\hat{\\xi} = 5/18 \\approx 0.278$ 小于 $1/2$，因此有限方差的假设与估计值是一致的。现在，我们使用方程 (1) 来求解 $\\hat{\\beta}$：\n$$ \\hat{\\beta} = \\hat{m}(1-\\hat{\\xi}) $$\n代入 $\\hat{m}$ 和 $\\hat{\\xi}$ 的值：\n$$ \\hat{\\beta} = 8\\left(1 - \\frac{5}{18}\\right) = 8\\left(\\frac{13}{18}\\right) = \\frac{4 \\times 13}{9} = \\frac{52}{9} $$\n拟合超阈值数据的 GPD 的估计参数是 $\\hat{\\xi} = 5/18$ 和 $\\hat{\\beta} = 52/9$。\n\n### 第3部分：分位数计算\n问题要求计算无条件分布 $X$ 的 $p=0.99995$ 分位数，我们将其表示为 $x_p$。对于 $x \\geq u$ 的分布尾部被建模为一个拼接，其生存函数由下式给出：\n$$ S(x) = P(Xx) \\approx P(Xu) \\cdot P(Xx | Xu) \\approx p_u \\cdot S_{\\text{GPD}}(x-u; \\hat{\\xi}, \\hat{\\beta}) $$\n超过阈值 $u=110$ 的概率由样本数据估计得出：\n$$ \\hat{p}_u = \\frac{n_u}{N} = \\frac{150}{10^6} = 1.5 \\times 10^{-4} $$\n对于超阈值量 $y=x-u$，GPD 的生存函数是：\n$$ S_{\\text{GPD}}(y; \\xi, \\beta) = \\left(1 + \\frac{\\xi y}{\\beta}\\right)^{-1/\\xi} $$\n我们寻求 $x_p$ 使得 $P(X \\leq x_p) = p$，这等价于 $P(X  x_p) = 1-p$。令 $q = 1-p = 1 - 0.99995 = 5 \\times 10^{-5}$。\n由于 $q = 5 \\times 10^{-5}  \\hat{p}_u = 1.5 \\times 10^{-4}$，分位数 $x_p$ 必须大于阈值 $u$，这验证了尾部模型的使用是合理的。我们建立方程来求解 $x_p$：\n$$ q = \\hat{p}_u \\left(1 + \\frac{\\hat{\\xi}(x_p-u)}{\\hat{\\beta}}\\right)^{-1/\\hat{\\xi}} $$\n求解 $x_p$：\n$$ \\frac{q}{\\hat{p}_u} = \\left(1 + \\frac{\\hat{\\xi}(x_p-u)}{\\hat{\\beta}}\\right)^{-1/\\hat{\\xi}} $$\n$$ \\left(\\frac{q}{\\hat{p}_u}\\right)^{-\\hat{\\xi}} = 1 + \\frac{\\hat{\\xi}(x_p-u)}{\\hat{\\beta}} $$\n$$ x_p = u + \\frac{\\hat{\\beta}}{\\hat{\\xi}}\\left[ \\left(\\frac{q}{\\hat{p}_u}\\right)^{-\\hat{\\xi}} - 1 \\right] = u + \\frac{\\hat{\\beta}}{\\hat{\\xi}}\\left[ \\left(\\frac{\\hat{p}_u}{q}\\right)^{\\hat{\\xi}} - 1 \\right] $$\n现在，我们代入数值：$u = 110$，$\\hat{\\xi} = 5/18$，$\\hat{\\beta}=52/9$，$\\hat{p}_u = 1.5 \\times 10^{-4}$，以及 $q=5 \\times 10^{-5}$。\n概率之比为：\n$$ \\frac{\\hat{p}_u}{q} = \\frac{1.5 \\times 10^{-4}}{5 \\times 10^{-5}} = 3 $$\n参数之比为：\n$$ \\frac{\\hat{\\beta}}{\\hat{\\xi}} = \\frac{52/9}{5/18} = \\frac{52}{9} \\cdot \\frac{18}{5} = \\frac{52 \\cdot 2}{5} = \\frac{104}{5} = 20.8 $$\n将这些代入 $x_p$ 的表达式中：\n$$ x_p = 110 + 20.8 \\left[ 3^{5/18} - 1 \\right] $$\n我们计算数值：\n$$ 3^{5/18} \\approx 1.3569055 $$\n$$ x_p \\approx 110 + 20.8 \\times (1.3569055 - 1) = 110 + 20.8 \\times 0.3569055 $$\n$$ x_p \\approx 110 + 7.4236344 = 117.4236344 $$\n问题要求答案四舍五入到四位有效数字。数值 $117.4236344$ 四舍五入到四位有效数字是 $117.4$。单位是千牛顿 (kN)。",
            "answer": "$$ \\boxed{117.4} $$"
        }
    ]
}