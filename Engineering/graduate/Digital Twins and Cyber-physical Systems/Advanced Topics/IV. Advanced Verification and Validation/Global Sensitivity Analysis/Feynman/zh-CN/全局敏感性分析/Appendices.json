{
    "hands_on_practices": [
        {
            "introduction": "全局敏感度分析的核心在于将模型输出的总方差分解为由各个输入不确定性引起的贡献。本练习将通过一个简单的、可解析的非线性模型，指导您从基本概率论原理出发，亲手计算方差的分解过程 。通过这个实践，您将为理解敏感度指数如何量化非线性效应打下坚实的基础。",
            "id": "4225410",
            "problem": "在一个信息物理系统 (CPS) 的数字孪生中，考虑一个简化的不确定性传播模块，其中一个归一化性能指标被建模为一个控制偏差的非线性变换与一个外生归一化负载之和。设模型输出为 $Y = X_{1}^{2} + X_{2}$，其中输入是独立的，且分布为 $X_{1} \\sim \\mathrm{Unif}(0,1)$ 和 $X_{2} \\sim \\mathrm{Unif}(0,1)$。\n\n- 仅使用概率论的基本定义（期望、方差、独立性的定义以及基础积分学），推导 $\\operatorname{Var}(Y)$ 的精确解析表达式。\n- 然后，使用基于方差的全局敏感性分析 (GSA) 的基本定义，定性解释在 $X_1$ 存在非线性而 $X_2$ 存在线性的情况下，基于方差的分解如何归因敏感性，并解释为何这种分解非常适用于 CPS 数字孪生中使用的非线性模型。\n\n将最终答案表示为 $\\operatorname{Var}(Y)$ 的精确值，形式为单一的简化有理数。无需四舍五入。",
            "solution": "问题陈述经评估有效。其科学基础在于概率论和敏感性分析，提法恰当，为获得唯一解提供了所有必要信息，并以客观的数学语言表达。它代表了在指定领域中一个标准（尽管是简化的）的不确定性量化问题。\n\n按要求，该问题分两部分解决。首先，推导 $\\operatorname{Var}(Y)$ 的精确解析表达式。其次，对给定模型提供基于方差的全局敏感性分析 (GSA) 的定性解释。\n\n**第 1 部分：$\\operatorname{Var}(Y)$ 的推导**\n\n模型输出由方程 $Y = X_{1}^{2} + X_{2}$ 给出。输入 $X_{1}$ 和 $X_{2}$ 是独立的随机变量，两者都在区间 $[0, 1]$ 上均匀分布。\n$X_{1} \\sim \\mathrm{Unif}(0,1)$\n$X_{2} \\sim \\mathrm{Unif}(0,1)$\n\n对于一个随机变量 $X \\sim \\mathrm{Unif}(0,1)$，其概率密度函数 (PDF) 为：\n$$f(x) = \\begin{cases} 1  \\text{ for } 0 \\le x \\le 1 \\\\ 0  \\text{ otherwise} \\end{cases}$$\n\n$Y$ 的方差，记为 $\\operatorname{Var}(Y)$，可以使用独立随机变量和的方差性质来计算。由于 $X_{1}$ 和 $X_{2}$ 是独立的，所以 $X_{1}$ 的任何函数（例如 $X_{1}^{2}$）也独立于 $X_{2}$ 的任何函数（例如 $X_{2}$ 本身）。因此，随机变量 $X_{1}^{2}$ 和 $X_{2}$ 是独立的。\n\n对于两个独立的随机变量 $A$ 和 $B$，它们和的方差等于它们方差的和：$\\operatorname{Var}(A + B) = \\operatorname{Var}(A) + \\operatorname{Var}(B)$。\n将此应用于我们的模型：\n$$\\operatorname{Var}(Y) = \\operatorname{Var}(X_{1}^{2} + X_{2}) = \\operatorname{Var}(X_{1}^{2}) + \\operatorname{Var}(X_{2})$$\n\n现在我们将使用方差的基本定义 $\\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2$ 分别计算每一项，其中 $\\mathbb{E}[\\cdot]$ 表示期望算子。\n\n首先，我们计算 $\\operatorname{Var}(X_{2})$。\n$X_{2}$ 的期望是：\n$$\\mathbb{E}[X_{2}] = \\int_{-\\infty}^{\\infty} x_{2} f(x_{2}) \\,dx_{2} = \\int_{0}^{1} x_{2} \\cdot 1 \\,dx_{2} = \\left[ \\frac{x_{2}^{2}}{2} \\right]_{0}^{1} = \\frac{1}{2}$$\n$X_{2}^{2}$ 的期望是：\n$$\\mathbb{E}[X_{2}^{2}] = \\int_{0}^{1} x_{2}^{2} \\cdot 1 \\,dx_{2} = \\left[ \\frac{x_{2}^{3}}{3} \\right]_{0}^{1} = \\frac{1}{3}$$\n因此，$X_{2}$ 的方差是：\n$$\\operatorname{Var}(X_{2}) = \\mathbb{E}[X_{2}^{2}] - (\\mathbb{E}[X_{2}])^{2} = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12}$$\n\n接下来，我们计算 $\\operatorname{Var}(X_{1}^{2})$。令随机变量 $Z = X_{1}^{2}$。我们需要计算 $\\operatorname{Var}(Z) = \\mathbb{E}[Z^2] - (\\mathbb{E}[Z])^2 = \\mathbb{E}[(X_1^2)^2] - (\\mathbb{E}[X_1^2])^2 = \\mathbb{E}[X_1^4] - (\\mathbb{E}[X_1^2])^2$。\n$X_{1}^{2}$ 的期望是：\n$$\\mathbb{E}[X_{1}^{2}] = \\int_{0}^{1} x_{1}^{2} \\cdot 1 \\,dx_{1} = \\left[ \\frac{x_{1}^{3}}{3} \\right]_{0}^{1} = \\frac{1}{3}$$\n$X_{1}^{4}$ 的期望是：\n$$\\mathbb{E}[X_{1}^{4}] = \\int_{0}^{1} x_{1}^{4} \\cdot 1 \\,dx_{1} = \\left[ \\frac{x_{1}^{5}}{5} \\right]_{0}^{1} = \\frac{1}{5}$$\n因此，$X_{1}^{2}$ 的方差是：\n$$\\operatorname{Var}(X_{1}^{2}) = \\mathbb{E}[X_{1}^{4}] - (\\mathbb{E}[X_{1}^{2}])^{2} = \\frac{1}{5} - \\left(\\frac{1}{3}\\right)^{2} = \\frac{1}{5} - \\frac{1}{9} = \\frac{9-5}{45} = \\frac{4}{45}$$\n\n最后，我们将两个方差相加来求 $\\operatorname{Var}(Y)$：\n$$\\operatorname{Var}(Y) = \\operatorname{Var}(X_{1}^{2}) + \\operatorname{Var}(X_{2}) = \\frac{4}{45} + \\frac{1}{12}$$\n为了将这些分数相加，我们找到一个公分母，即 $45$ 和 $12$ 的最小公倍数。$45 = 3^2 \\cdot 5$ 且 $12 = 2^2 \\cdot 3$。最小公倍数 (LCM) 是 $2^2 \\cdot 3^2 \\cdot 5 = 4 \\cdot 9 \\cdot 5 = 180$。\n$$\\operatorname{Var}(Y) = \\frac{4 \\cdot 4}{45 \\cdot 4} + \\frac{1 \\cdot 15}{12 \\cdot 15} = \\frac{16}{180} + \\frac{15}{180} = \\frac{31}{180}$$\n\n**第 2 部分：基于方差的 GSA 的定性解释**\n\n基于方差的全局敏感性分析 (GSA)（通常称为 Sobol 方法）的基本原理是将模型输出的总方差 $\\operatorname{Var}(Y)$ 分解为来自每个输入因子及其交互作用的贡献。对于一个多输入模型 $Y=f(X_1, X_2, \\dots, X_d)$，其总方差可以根据 ANOVA-Hoeffding 分解被唯一地划分为：\n$$\\operatorname{Var}(Y) = \\sum_{i=1}^{d} V_i + \\sum_{1 \\le i  j \\le d} V_{ij} + \\dots + V_{12\\dots d}$$\n其中 $V_i$ 是由输入 $X_i$ 单独引起的方差（主效应），$V_{ij}$ 是由 $X_i$ 和 $X_j$ 之间的交互作用引起的方差，以此类推。\n\n在我们的模型 $Y = X_{1}^{2} + X_{2}$ 中，函数是加性可分的，即 $f(X_1, X_2) = g_1(X_1) + g_2(X_2)$，其中 $g_1(X_1)=X_1^2$ 且 $g_2(X_2)=X_2$。由于没有交互项（例如 $X_1 X_2$），所有高阶方差项 $V_{ij}, V_{ijk}, \\dots$ 均为零。因此，总方差就是各主效应方差之和：$\\operatorname{Var}(Y) = V_1 + V_2 = \\operatorname{Var}(X_1^2) + \\operatorname{Var}(X_2)$。\n\n这种分解清楚地揭示了GSA如何归因于不同性质的效应：\n- 来自 $X_1$ 的贡献 $\\operatorname{Var}(X_1^2) = 4/45 \\approx 0.089$ 是非线性的。\n- 来自 $X_2$ 的贡献 $\\operatorname{Var}(X_2) = 1/12 \\approx 0.083$ 是线性的。\n\n这个简单的例子说明了GSA的强大之处：它能公平地量化和比较线性和非线性效应对总输出不确定性的贡献。这对于分析复杂的CPS数字孪生模型至关重要，因为这些模型通常包含这两种效应以及它们之间复杂的交互作用，GSA能够帮助工程师识别出系统中最重要的不确定性来源。",
            "answer": "$$\\boxed{\\frac{31}{180}}$$"
        },
        {
            "introduction": "在计算方差贡献之后，更深层次的理解来自于探究模型本身的函数结构。本练习将引导您实践Hoeffding-Sobol分解，它将一个复杂的模型表示为主效应和交互效应等更简单函数的和 。通过为一个包含交互项的模型显式推导这些分量函数，您将对GSA如何从结构上分析输入-输出关系获得更深刻的认识。",
            "id": "3883382",
            "problem": "考虑一个环境地球系统模型中理想化的双参数分量，对其进行基于方差的全局敏感性分析 (GSA)。设模型输出为一个确定性函数 $Y=f(X_{1},X_{2})$，其输入 $X_{1},X_{2}\\sim\\mathrm{Unif}(0,1)$ 相互独立，服从 $[0,1]^{2}$ 上的乘积概率测度。函数方差分析 (ANOVA) 分解（也称为 Hoeffding–Sobol 分解）将 $f$ 表示为\n$$\nf(x_{1},x_{2}) \\;=\\; f_{0} \\;+\\; f_{1}(x_{1}) \\;+\\; f_{2}(x_{2}) \\;+\\; f_{12}(x_{1},x_{2}),\n$$\n其中分量函数满足锚定和正交条件\n$$\nf_{0} \\;=\\; \\mathbb{E}[f(X_{1},X_{2})],\\quad \\mathbb{E}[f_{1}(X_{1})] \\;=\\; 0,\\quad \\mathbb{E}[f_{2}(X_{2})] \\;=\\; 0,\n$$\n和\n$$\n\\mathbb{E}[f_{12}(X_{1},X_{2})\\,|\\,X_{1}] \\;=\\; 0,\\quad \\mathbb{E}[f_{12}(X_{1},X_{2})\\,|\\,X_{2}] \\;=\\; 0.\n$$\n从这些核心定义以及 $X_{1}$ 和 $X_{2}$ 的独立性出发，为模型\n$$\nf(X_{1},X_{2}) \\;=\\; X_{1} \\;+\\; X_{2} \\;+\\; X_{1}X_{2}.\n$$\n推导一阶效应函数 $f_{1}(x_{1})$、$f_{2}(x_{2})$ 和二阶交互效应 $f_{12}(x_{1},x_{2})$ 的显式解析表达式。以闭式符号表达式的形式给出最终答案。不需要进行数值四舍五入。",
            "solution": "在尝试求解之前，将首先根据指定标准对问题进行验证。\n\n已知条件逐字从问题陈述中提取如下：\n- 模型输出是一个确定性函数 $Y=f(X_{1},X_{2})$。\n- 模型输入 $X_{1}$ 和 $X_{2}$ 相互独立且服从均匀分布，$X_{1}, X_{2}\\sim\\mathrm{Unif}(0,1)$。\n- 概率空间是 $[0,1]^{2}$ 上的乘积概率测度。\n- 函数方差分析 (ANOVA) 或 Hoeffding–Sobol 分解为 $f(x_{1},x_{2}) = f_{0} + f_{1}(x_{1}) + f_{2}(x_{2}) + f_{12}(x_{1},x_{2})$。\n- 常数项定义为 $f_{0} = \\mathbb{E}[f(X_{1},X_{2})]$。\n- 一阶分量满足零均值条件：$\\mathbb{E}[f_{1}(X_{1})] = 0$ 和 $\\mathbb{E}[f_{2}(X_{2})] = 0$。\n- 二阶分量满足正交条件：$\\mathbb{E}[f_{12}(X_{1},X_{2})\\,|\\,X_{1}] = 0$ 和 $\\mathbb{E}[f_{12}(X_{1},X_{2})\\,|\\,X_{2}] = 0$。\n- 要分析的具体模型函数是 $f(X_{1},X_{2}) = X_{1} + X_{2} + X_{1}X_{2}$。\n- 任务是推导分量函数 $f_{1}(x_{1})$、$f_{2}(x_{2})$ 和 $f_{12}(x_{1},x_{2})$ 的显式解析表达式。\n\n问题现已通过验证。它具有科学依据，植根于基于方差的全局敏感性分析的既定数学理论。该问题是适定的，提供了一个特定的函数以及所有必要的定义和约束（输入分布、正交条件），以唯一确定各分量函数。其语言客观且数学上精确。该问题没有违反任何基本原则，不是不完整的、矛盾的或不适定的。因此，该问题是有效的。\n\n我们现在开始推导 $f(X_{1},X_{2}) = X_{1} + X_{2} + X_{1}X_{2}$ 的 ANOVA 分量函数。\n\n首先，我们计算常数项 $f_{0}$，即函数在输入空间上的期望值。对于输入 $X_{i} \\sim \\mathrm{Unif}(0,1)$，其期望为 $\\mathbb{E}[X_{i}] = \\int_{0}^{1} x \\,dx = \\frac{1}{2}$。\n$$\nf_{0} = \\mathbb{E}[f(X_{1},X_{2})] = \\mathbb{E}[X_{1} + X_{2} + X_{1}X_{2}]\n$$\n根据期望的线性性质，\n$$\nf_{0} = \\mathbb{E}[X_{1}] + \\mathbb{E}[X_{2}] + \\mathbb{E}[X_{1}X_{2}]\n$$\n由于 $X_{1}$ 和 $X_{2}$ 是独立的，$\\mathbb{E}[X_{1}X_{2}] = \\mathbb{E}[X_{1}]\\mathbb{E}[X_{2}]$。\n$$\nf_{0} = \\frac{1}{2} + \\frac{1}{2} + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1 + \\frac{1}{4} = \\frac{5}{4}\n$$\n\n接下来，我们推导一阶效应函数 $f_{1}(x_{1})$。从正交条件导出的 $f_1(x_1)$ 的定义关系是 $f_{1}(x_{1}) = \\mathbb{E}[f(X_{1},X_{2})\\,|\\,X_{1}=x_{1}] - f_0$。条件期望 $\\mathbb{E}[f(X_{1},X_{2})\\,|\\,X_{1}=x_{1}]$ 是通过对 $f(x_{1},x_{2})$ 关于 $X_2$ 的分布进行积分来计算的。\n$$\n\\mathbb{E}[f(X_{1},X_{2})\\,|\\,X_{1}=x_{1}] = \\mathbb{E}_{X_2}[f(x_{1},X_{2})] = \\int_{0}^{1} (x_{1} + x_{2} + x_{1}x_{2}) \\,dx_{2}\n$$\n$$\n= [x_{1}x_{2} + \\frac{x_{2}^{2}}{2} + x_{1}\\frac{x_{2}^{2}}{2}]_{0}^{1} = x_{1} + \\frac{1}{2} + \\frac{1}{2}x_{1} = \\frac{3}{2}x_{1} + \\frac{1}{2}\n$$\n现在我们通过减去 $f_0$ 来求得 $f_1(x_1)$：\n$$\nf_{1}(x_{1}) = \\left(\\frac{3}{2}x_{1} + \\frac{1}{2}\\right) - f_{0} = \\left(\\frac{3}{2}x_{1} + \\frac{1}{2}\\right) - \\frac{5}{4} = \\frac{3}{2}x_{1} - \\frac{3}{4}\n$$\n作为验证，我们检查 $\\mathbb{E}[f_1(X_1)] = 0$ 是否成立：\n$$\n\\mathbb{E}\\left[\\frac{3}{2}X_{1} - \\frac{3}{4}\\right] = \\frac{3}{2}\\mathbb{E}[X_{1}] - \\frac{3}{4} = \\frac{3}{2}\\left(\\frac{1}{2}\\right) - \\frac{3}{4} = \\frac{3}{4} - \\frac{3}{4} = 0\n$$\n该条件得到满足。由于函数 $f(X_{1},X_{2})$ 相对于 $X_{1}$ 和 $X_{2}$ 的对称性，函数 $f_{2}(x_{2})$ 必然具有与 $f_{1}(x_{1})$ 相同的形式。\n$$\nf_{2}(x_{2}) = \\frac{3}{2}x_{2} - \\frac{3}{4}\n$$\n\n最后，我们确定二阶交互项 $f_{12}(x_{1},x_{2})$。该项捕捉了函数变异性中无法由单个输入的加性效应解释的部分。它通过从总函数中减去所有低阶项得到：\n$$\nf_{12}(x_{1},x_{2}) = f(x_{1},x_{2}) - f_{0} - f_{1}(x_{1}) - f_{2}(x_{2})\n$$\n代入我们已推导出的表达式：\n$$\nf_{12}(x_{1},x_{2}) = (x_{1} + x_{2} + x_{1}x_{2}) - \\frac{5}{4} - \\left(\\frac{3}{2}x_{1} - \\frac{3}{4}\\right) - \\left(\\frac{3}{2}x_{2} - \\frac{3}{4}\\right)\n$$\n$$\n= x_{1} + x_{2} + x_{1}x_{2} - \\frac{5}{4} - \\frac{3}{2}x_{1} + \\frac{3}{4} - \\frac{3}{2}x_{2} + \\frac{3}{4}\n$$\n合并同类项：\n$$\nf_{12}(x_{1},x_{2}) = (1 - \\frac{3}{2})x_{1} + (1 - \\frac{3}{2})x_{2} + x_{1}x_{2} + \\left(-\\frac{5}{4} + \\frac{3}{4} + \\frac{3}{4}\\right)\n$$\n$$\n= -\\frac{1}{2}x_{1} - \\frac{1}{2}x_{2} + x_{1}x_{2} + \\frac{1}{4}\n$$\n这个表达式可以进行因式分解，从而更清晰地揭示其结构：\n$$\nf_{12}(x_{1},x_{2}) = x_{1}x_{2} - \\frac{1}{2}x_{1} - \\frac{1}{2}x_{2} + \\frac{1}{4} = (x_{1} - \\frac{1}{2})(x_{2} - \\frac{1}{2})\n$$\n我们验证 $f_{12}$ 是否满足正交条件。例如，$\\mathbb{E}[f_{12}(X_{1},X_{2})\\,|\\,X_{1}=x_{1}] = \\mathbb{E}_{X_2}[(x_1 - \\frac{1}{2})(X_2 - \\frac{1}{2})] = (x_1 - \\frac{1}{2})\\mathbb{E}[X_2 - \\frac{1}{2}] = (x_1 - \\frac{1}{2})(\\frac{1}{2} - \\frac{1}{2}) = 0$。根据对称性，另一个条件也成立。\n\n所需的 ANOVA 分量函数的解析表达式已成功推导。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2}x_1 - \\frac{3}{4}  \\frac{3}{2}x_2 - \\frac{3}{4}  \\left(x_1 - \\frac{1}{2}\\right)\\left(x_2 - \\frac{1}{2}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将理论应用于实践时，一个无法回避的关键问题是：“我的模型需要运行多少次？”。本练习将理论与实际应用相结合，聚焦于广泛使用的Saltelli采样方案的计算成本 。通过分析其采样结构，您将推导出计算总运行次数的公式，这是为复杂且计算成本高昂的模型设计任何GSA研究时都必须掌握的关键技能。",
            "id": "3883337",
            "problem": "考虑一个确定性环境模型，表示为 $Y = f(\\mathbf{X})$，其中 $\\mathbf{X} = (X_1, X_2, \\ldots, X_d)$ 是一个 $d$ 维的独立输入因子向量，每个 $X_j$ 的支持集为单位区间，$Y$ 是一个标量响应。基于方差的全局敏感性分析将输出方差分解，以归因于单个输入及其交互作用的贡献。因子 $X_j$ 的一阶 Sobol 指数定义为 $S_j = \\operatorname{Var}\\left(\\mathbb{E}[Y \\mid X_j]\\right) / \\operatorname{Var}(Y)$，而 $X_j$ 的全阶 Sobol 指数定义为 $T_j = 1 - \\operatorname{Var}\\left(\\mathbb{E}[Y \\mid \\mathbf{X}_{-j}]\\right) / \\operatorname{Var}(Y)$，其中 $\\mathbf{X}_{-j}$ 表示除 $X_j$ 之外的所有输入。这些定义源于在 $Y$ 独立且平方可积的条件下进行的方差分析（ANOVA）分解。\n\n由 Saltelli 提出的一种实用的蒙特卡洛或准蒙特卡洛（QMC）估计方案需要两个大小为 $N \\times d$ 的独立基础样本矩阵，记为 $A$ 和 $B$，通过在 $[0,1]$ 上对每一列独立抽样来构建。对于每个输入因子 $j \\in \\{1, \\ldots, d\\}$，通过将 $A$ 的第 $j$ 列替换为 $B$ 的第 $j$ 列，构建一个混合矩阵 $A^{(j)}_B$。然后对 $A$、$B$ 和每个 $A^{(j)}_B$ 的行进行模型评估，以同时提供所有一阶和全阶 Sobol 指数的一致估计量。\n\n任务：\n1. 仅从上述基于方差的定义和输入独立性出发，设计一个基于矩阵 $A$、$B$ 和 $A^{(j)}_B$ 的抽样计划，该计划能够联合估计所有一阶和全阶 Sobol 指数。清楚地说明对于给定的 $N$ 和 $d$，需要构建的所有矩阵的数量和大小。\n2. 推导该计划所需的模型运行总次数，作为 $N$ 和 $d$ 的函数，确保论证在模型和抽样假设下是有效的。仔细处理边界情况 $d = 0$，并提供一个逻辑上一致的计数。\n3. 实现一个程序，给定数对 $(N, d)$，返回您所推导的 Saltelli 方案所需的模型运行总次数。\n\n使用以下输入数对 $(N, d)$ 的测试套件：\n- 情况1：$N = 512$, $d = 6$。\n- 情况2：$N = 1$, $d = 3$。\n- 情况3：$N = 50$, $d = 0$。\n- 情况4：$N = 137$, $d = 7$。\n- 情况5：$N = 10000$, $d = 2$。\n- 情况6：$N = 256$, $d = 1$。\n\n你的程序应产生单行输出，包含用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,\\ldots,r_6]$），其中每个 $r_i$ 是一个整数，对应于相应测试用例所需的模型运行总次数。",
            "solution": "该问题要求分析 Saltelli 全局敏感性分析抽样方案的计算成本。模型评估的总次数由该过程中使用的样本矩阵的结构和维度决定。推导分三个阶段进行：首先，将所描述的抽样计划形式化；其次，推导模型运行次数作为基础样本大小 $N$ 和输入维度数 $d$ 的函数的通用公式；第三，验证该公式在边界情况 $d=0$ 下的正确性。\n\n用于估计所有一阶 $S_j$ 和全阶 $T_j$ Sobol 指数的抽样计划是使用三种类型的矩阵构建的。模型 $Y=f(\\mathbf{X})$ 必须对这些矩阵的每一行进行评估。\n\n1.  **基础样本矩阵**：该计划始于两个独立的样本矩阵 $A$ 和 $B$。两者的大小均为 $N \\times d$，其中 $N$ 是基础样本大小，$d$ 是输入因子的数量。每个矩阵通过从输入因子的独立分布（例如，在 $[0,1]$ 上的均匀分布）中抽取 $N \\times d$ 个点来生成。\n    -   矩阵 $A$ 有 $N$ 行。对 $A$ 的每一行评估模型需要 $N$ 次模型运行。\n    -   矩阵 $B$ 也有 $N$ 行。对 $B$ 的每一行评估模型需要额外的 $N$ 次模型运行。\n\n2.  **混合样本矩阵**：对于每个输入因子 $X_j$（其中 $j \\in \\{1, 2, \\ldots, d\\}$），构建一个“混合”矩阵 $A^{(j)}_B$。该矩阵与矩阵 $A$ 相同，只是其第 $j$ 列被替换为矩阵 $B$ 的第 $j$ 列。\n    -   有 $d$ 个输入因子，因此构建了 $d$ 个这样的矩阵：$A^{(1)}_B, A^{(2)}_B, \\ldots, A^{(d)}_B$。\n    -   每个矩阵 $A^{(j)}_B$ 的大小为 $N \\times d$，因此有 $N$ 行。\n    -   对所有这 $d$ 个矩阵的行评估模型需要 $d \\times N$ 次模型运行。\n\n模型运行的总次数是这些矩阵中每个矩阵所需运行次数的总和。假设所有构建的矩阵的行都是唯一的（对于连续抽样分布，这一点的概率为 1），那么所需的评估中没有重叠。\n\n我们记总运行次数为 $N_{total}$，它是矩阵 $A$、矩阵 $B$ 和 $d$ 个混合矩阵 $A^{(j)}_B$ 的运行次数之和。\n$$N_{total} = (\\text{A的运行次数}) + (\\text{B的运行次数}) + (\\text{所有} A^{(j)}_B \\text{的运行次数})$$\n$$N_{total} = N + N + \\sum_{j=1}^{d} N$$\n$$N_{total} = 2N + dN$$\n$$N_{total} = N(d+2)$$\n此公式给出了当 $d \\geq 1$ 时模型执行的总次数。\n\n问题要求特别考虑 $d=0$ 的边界情况。在这种情况下，模型 $Y=f()$ 没有输入因子。让我们算法化地应用所述的抽样计划：\n-   基础矩阵 $A$ 和 $B$ 的大小为 $N \\times d$，即变为 $N \\times 0$。每个矩阵由 $N$ 行组成，每行是一个空向量，代表零维输入空间中的一个点。对矩阵 $A$ 评估模型需要 $N$ 次运行，对矩阵 $B$ 需要另外 $N$ 次运行。\n-   混合矩阵 $A^{(j)}_B$ 的构建是为每个输入因子 $j \\in \\{1, \\ldots, d\\}$ 指定的。当 $d=0$ 时，该索引集为空。因此，不构建任何混合矩阵。\n-   因此，当 $d=0$ 时，总运行次数是 $A$ 和 $B$ 的运行次数之和，即 $N + N = 2N$。\n\n有必要检查我们的通用公式 $N_{total} = N(d+2)$ 是否与此结果一致。将 $d=0$ 代入公式可得：\n$$N_{total} = N(0+2) = 2N$$\n该公式对边界情况 $d=0$ 成立，为所有非负整数 $d$ 提供了一个逻辑上一致的表达式。\n\n因此，对于给定的基础样本大小 $N$ 和输入因子数量 $d$，Saltelli 方案所需的模型评估总次数为 $N(d+2)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the total number of model runs required by Saltelli's sampling\n    scheme for global sensitivity analysis based on a series of (N, d) pairs.\n    \"\"\"\n    \n    # Define the test cases from the problem statement as pairs of (N, d).\n    # N is the base sample size, d is the number of input dimensions.\n    test_cases = [\n        (512, 6),    # Case 1\n        (1, 3),      # Case 2\n        (50, 0),     # Case 3\n        (137, 7),    # Case 4\n        (10000, 2),  # Case 5\n        (256, 1),    # Case 6\n    ]\n\n    results = []\n    for case in test_cases:\n        N, d = case\n        \n        # The Saltelli sampling scheme requires N evaluations for a base matrix A,\n        # N evaluations for a second base matrix B, and N evaluations for each\n        # of the d mixed matrices A_B^(j).\n        # Total model runs = N (for A) + N (for B) + d * N (for d mixed matrices)\n        # This simplifies to the formula N * (d + 2).\n        # This formula is also valid for the boundary case d=0, where it\n        # correctly yields 2*N (as no mixed matrices are generated).\n        total_runs = N * (d + 2)\n        results.append(total_runs)\n\n    # Final print statement in the exact required format: [r_1,r_2,...,r_6]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}