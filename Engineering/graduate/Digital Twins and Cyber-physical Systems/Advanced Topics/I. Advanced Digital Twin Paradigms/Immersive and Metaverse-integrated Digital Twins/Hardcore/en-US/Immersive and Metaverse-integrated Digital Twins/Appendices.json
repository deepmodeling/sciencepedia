{
    "hands_on_practices": [
        {
            "introduction": "Motion-to-photon (MTP) latency is a critical metric for user comfort and a sense of presence in any immersive digital twin application. This exercise puts you in the role of a systems architect, tasking you with dissecting a full end-to-end processing pipeline, from motion sensing to display. By analyzing each stage's contribution, you will learn how to create a latency budget and make crucial design trade-offs, such as offloading computation to the edge, to meet a strict real-time performance target .",
            "id": "4227342",
            "problem": "A metaverse-integrated Digital Twin (DT) is visualized through a Virtual Reality (VR) headset. The control loop is closed through the VR user’s head motion, which is sensed, transmitted, simulated against the DT at the edge, rendered locally on the headset, and displayed on a sample-and-hold display. The system must meet a motion-to-photon (MTP) latency target strictly below $20\\,\\mathrm{ms}$. By MTP latency we mean the sum of the serial stage delays in the motion-to-photon pipeline. Assume the following scientifically grounded stage models based on core definitions of serial pipeline latency, sampling theory, and network delay composition:\n\n- Sensing: The headset’s inertial measurement unit samples at frequency $f_{s}=500\\,\\mathrm{Hz}$, so the sampling period is $T_{s}=1/f_{s}$. The expected sample-to-use delay is the average phase delay $T_{s}/2$. A sensor fusion pre-processing stage adds a fixed compute delay of $0.8\\,\\mathrm{ms}$.\n- Network uplink: A motion state packet of size $S_{\\mathrm{ul}}=12\\,\\mathrm{kB}$ is transmitted at rate $R_{\\mathrm{ul}}=200\\,\\mathrm{Mbit/s}$. The transmission time is $S_{\\mathrm{ul}}/R_{\\mathrm{ul}}$. The one-way propagation path to the edge is $d=5\\,\\mathrm{km}$ over fiber with propagation speed $v=2.0\\times 10^{8}\\,\\mathrm{m/s}$. The wireless last-hop access adds a fixed $0.6\\,\\mathrm{ms}$, and queuing adds $0.2\\,\\mathrm{ms}$.\n- Edge simulation: If simulation is offloaded, the DT physics and state-estimation compute on the edge require $2.2\\,\\mathrm{ms}$. If computed locally on the headset, this stage would require $7.5\\,\\mathrm{ms}$.\n- Network downlink: The updated state of size $S_{\\mathrm{dl}}=16\\,\\mathrm{kB}$ is transmitted at rate $R_{\\mathrm{dl}}=1.0\\,\\mathrm{Gbit/s}$, contributing $S_{\\mathrm{dl}}/R_{\\mathrm{dl}}$. The same one-way propagation, wireless access, and queuing delays as uplink apply.\n- Rendering: The shaded image is produced locally on the headset GPU, with rendering time $T_{\\mathrm{rend}}$ to be determined.\n- Display: The display refresh is $f_{\\mathrm{disp}}=120\\,\\mathrm{Hz}$. The expected v-sync quantization delay is $1/(2 f_{\\mathrm{disp}})$, and the pixel response time adds $0.8\\,\\mathrm{ms}$.\n\nAssume a serial pipeline where these stages add linearly to form the total MTP latency. Choose to offload only the simulation to the edge (not the rendering), and compute the maximum allowable rendering time $T_{\\mathrm{rend}}$ such that the total motion-to-photon latency is strictly below $20\\,\\mathrm{ms}$. Express your final numerical answer in milliseconds and round your answer to four significant figures.\n\nIn one or two sentences within your derivation, briefly justify which stage benefits most from edge offload in this configuration and why, but note that the graded final answer is only the rendering-time budget.",
            "solution": "The problem is to determine the maximum allowable rendering time, $T_{\\mathrm{rend}}$, such that the total motion-to-photon (MTP) latency, $L_{\\mathrm{MTP}}$, for a metaverse-integrated Digital Twin (DT) system is strictly below $20\\,\\mathrm{ms}$. The problem is valid as it is scientifically grounded in standard latency models for cyber-physical systems, is well-posed, and contains all necessary information for a unique solution.\n\nThe total MTP latency is the sum of the serial stage delays:\n$$L_{\\mathrm{MTP}} = L_{\\mathrm{sense}} + L_{\\mathrm{uplink}} + L_{\\mathrm{sim}} + L_{\\mathrm{downlink}} + L_{\\mathrm{render}} + L_{\\mathrm{display}}$$\nThe constraint is given as $L_{\\mathrm{MTP}} < 20\\,\\mathrm{ms}$. We will calculate the latency for each stage, converting all time units to milliseconds ($\\mathrm{ms}$).\n\n1.  **Sensing Latency ($L_{\\mathrm{sense}}$)**:\n    The sampling frequency is $f_{s} = 500\\,\\mathrm{Hz}$. The sampling period is $T_{s} = 1/f_{s}$. The average sample-to-use delay is $T_{s}/2$.\n    $$\n    T_{s} = \\frac{1}{500\\,\\mathrm{Hz}} = 0.002\\,\\mathrm{s} = 2\\,\\mathrm{ms}\n    $$\n    The average sampling latency is $\\frac{T_{s}}{2} = \\frac{2\\,\\mathrm{ms}}{2} = 1\\,\\mathrm{ms}$.\n    An additional sensor fusion pre-processing delay is $0.8\\,\\mathrm{ms}$.\n    $$\n    L_{\\mathrm{sense}} = 1\\,\\mathrm{ms} + 0.8\\,\\mathrm{ms} = 1.8\\,\\mathrm{ms}\n    $$\n\n2.  **Network Uplink Latency ($L_{\\mathrm{uplink}}$)**:\n    This consists of transmission time, propagation time, wireless access delay, and queuing delay.\n    Transmission time is $S_{\\mathrm{ul}}/R_{\\mathrm{ul}}$, where $S_{\\mathrm{ul}}=12\\,\\mathrm{kB}$ and $R_{\\mathrm{ul}}=200\\,\\mathrm{Mbit/s}$.\n    $$\n    S_{\\mathrm{ul}} = 12\\,\\mathrm{kB} = 12 \\times 10^{3}\\,\\mathrm{bytes} \\times 8\\,\\frac{\\mathrm{bits}}{\\mathrm{byte}} = 96000\\,\\mathrm{bits}\n    $$\n    $$\n    R_{\\mathrm{ul}} = 200\\,\\mathrm{Mbit/s} = 200 \\times 10^{6}\\,\\mathrm{bits/s}\n    $$\n    $$\n    T_{\\mathrm{tx,ul}} = \\frac{S_{\\mathrm{ul}}}{R_{\\mathrm{ul}}} = \\frac{96000\\,\\mathrm{bits}}{200 \\times 10^{6}\\,\\mathrm{bits/s}} = 0.00048\\,\\mathrm{s} = 0.48\\,\\mathrm{ms}\n    $$\n    Propagation time is $d/v$, where $d=5\\,\\mathrm{km}$ and $v=2.0\\times 10^{8}\\,\\mathrm{m/s}$.\n    $$\n    T_{\\mathrm{prop}} = \\frac{d}{v} = \\frac{5 \\times 10^{3}\\,\\mathrm{m}}{2.0 \\times 10^{8}\\,\\mathrm{m/s}} = 2.5 \\times 10^{-5}\\,\\mathrm{s} = 0.025\\,\\mathrm{ms}\n    $$\n    The fixed delays are $0.6\\,\\mathrm{ms}$ (wireless) and $0.2\\,\\mathrm{ms}$ (queuing).\n    $$\n    L_{\\mathrm{uplink}} = T_{\\mathrm{tx,ul}} + T_{\\mathrm{prop}} + 0.6\\,\\mathrm{ms} + 0.2\\,\\mathrm{ms} = 0.48\\,\\mathrm{ms} + 0.025\\,\\mathrm{ms} + 0.8\\,\\mathrm{ms} = 1.305\\,\\mathrm{ms}\n    $$\n\n3.  **Edge Simulation Latency ($L_{\\mathrm{sim}}$)**:\n    The problem specifies to offload the simulation to the edge.\n    $$\n    L_{\\mathrm{sim}} = 2.2\\,\\mathrm{ms}\n    $$\n\n4.  **Network Downlink Latency ($L_{\\mathrm{downlink}}$)**:\n    Similar to the uplink, this is the sum of transmission, propagation, and fixed delays.\n    Transmission time is $S_{\\mathrm{dl}}/R_{\\mathrm{dl}}$, where $S_{\\mathrm{dl}}=16\\,\\mathrm{kB}$ and $R_{\\mathrm{dl}}=1.0\\,\\mathrm{Gbit/s}$.\n    $$\n    S_{\\mathrm{dl}} = 16\\,\\mathrm{kB} = 16 \\times 10^{3}\\,\\mathrm{bytes} \\times 8\\,\\frac{\\mathrm{bits}}{\\mathrm{byte}} = 128000\\,\\mathrm{bits}\n    $$\n    $$\n    R_{\\mathrm{dl}} = 1.0\\,\\mathrm{Gbit/s} = 1 \\times 10^{9}\\,\\mathrm{bits/s}\n    $$\n    $$\n    T_{\\mathrm{tx,dl}} = \\frac{S_{\\mathrm{dl}}}{R_{\\mathrm{dl}}} = \\frac{128000\\,\\mathrm{bits}}{1 \\times 10^{9}\\,\\mathrm{bits/s}} = 0.000128\\,\\mathrm{s} = 0.128\\,\\mathrm{ms}\n    $$\n    Propagation and fixed delays are the same as for the uplink.\n    $$\n    L_{\\mathrm{downlink}} = T_{\\mathrm{tx,dl}} + T_{\\mathrm{prop}} + 0.6\\,\\mathrm{ms} + 0.2\\,\\mathrm{ms} = 0.128\\,\\mathrm{ms} + 0.025\\,\\mathrm{ms} + 0.8\\,\\mathrm{ms} = 0.953\\,\\mathrm{ms}\n    $$\n\n5.  **Rendering Latency ($L_{\\mathrm{render}}$)**:\n    This is the unknown quantity to be determined.\n    $$\n    L_{\\mathrm{render}} = T_{\\mathrm{rend}}\n    $$\n\n6.  **Display Latency ($L_{\\mathrm{display}}$)**:\n    This is the sum of the v-sync quantization delay and the pixel response time.\n    The v-sync delay is $1/(2 f_{\\mathrm{disp}})$ for $f_{\\mathrm{disp}}=120\\,\\mathrm{Hz}$.\n    $$\n    \\text{V-sync delay} = \\frac{1}{2 \\times 120\\,\\mathrm{Hz}} = \\frac{1}{240}\\,\\mathrm{s} = \\frac{1000}{240}\\,\\mathrm{ms} = \\frac{25}{6}\\,\\mathrm{ms}\n    $$\n    The pixel response time is $0.8\\,\\mathrm{ms}$.\n    $$\n    L_{\\mathrm{display}} = \\left(\\frac{25}{6} + 0.8\\right)\\,\\mathrm{ms}\n    $$\n\nNow, we sum the known latencies and solve for $T_{\\mathrm{rend}}$.\n$$\nL_{\\mathrm{sense}} + L_{\\mathrm{uplink}} + L_{\\mathrm{sim}} + L_{\\mathrm{downlink}} + T_{\\mathrm{rend}} + L_{\\mathrm{display}} < 20\\,\\mathrm{ms}\n$$\n$$\n1.8\\,\\mathrm{ms} + 1.305\\,\\mathrm{ms} + 2.2\\,\\mathrm{ms} + 0.953\\,\\mathrm{ms} + T_{\\mathrm{rend}} + \\left(\\frac{25}{6} + 0.8\\right)\\,\\mathrm{ms} < 20\\,\\mathrm{ms}\n$$\nSumming the known numerical terms:\n$$\n1.8 + 1.305 + 2.2 + 0.953 + 0.8 = 7.058\n$$\nThe inequality becomes:\n$$\n7.058\\,\\mathrm{ms} + \\frac{25}{6}\\,\\mathrm{ms} + T_{\\mathrm{rend}} < 20\\,\\mathrm{ms}\n$$\n$$\n7.058 + 4.1666... + T_{\\mathrm{rend}} < 20\n$$\n$$\n11.224666...\\,\\mathrm{ms} + T_{\\mathrm{rend}} < 20\\,\\mathrm{ms}\n$$\nTo find the maximum allowable rendering time, we solve for $T_{\\mathrm{rend}}$:\n$$\nT_{\\mathrm{rend}} < 20\\,\\mathrm{ms} - 11.224666...\\,\\mathrm{ms}\n$$\n$$\nT_{\\mathrm{rend}} < 8.775333...\\,\\mathrm{ms}\n$$\nThe maximum allowable value is the supremum of this range. In this context, it is the value $20\\,\\mathrm{ms} - (7.058 + \\frac{25}{6})\\,\\mathrm{ms} = \\frac{13163}{1500}\\,\\mathrm{ms} \\approx 8.775333...\\,\\mathrm{ms}$.\n\nThe simulation stage benefits most from the edge offload because its local compute time of $7.5\\,\\mathrm{ms}$ represents the single largest delay in the potential pipeline, and replacing it with the total offload path time ($L_{\\mathrm{uplink}} + L_{\\mathrm{sim}} + L_{\\mathrm{downlink}} = 1.305 + 2.2 + 0.953 = 4.458\\,\\mathrm{ms}$) yields a substantial net latency reduction of $7.5 - 4.458 = 3.042\\,\\mathrm{ms}$.\n\nRounding the maximum allowable rendering time to four significant figures:\n$$\nT_{\\mathrm{rend,max}} \\approx 8.775\\,\\mathrm{ms}\n$$",
            "answer": "$$\n\\boxed{8.775}\n$$"
        },
        {
            "introduction": "Many digital twins rely on real-time physics simulations to predict system behavior and drive immersive feedback, such as the spatialized audio in this problem. This practice explores a fundamental constraint of such simulations: numerical stability, which ensures the computation does not produce nonsensical, divergent results. You will derive the celebrated Courant-Friedrichs-Lewy (CFL) condition and see how this theoretical stability limit directly translates into a practical engineering requirement for the system's minimum operational frame rate .",
            "id": "4227334",
            "problem": "A metaverse-integrated digital twin of an industrial pipeline drives spatialized audio and haptic feedback in Virtual Reality (VR) by simulating one-dimensional acoustic waves along the pipe axis. The acoustic field is modeled by the one-dimensional linear wave equation, where the acoustic pressure field $u(x,t)$ satisfies $\\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}}$, with sound speed $c$. The simulation domain has length $L$ and is discretized uniformly into $N$ grid points, so the grid spacing is $\\Delta x = \\frac{L}{N-1}$. The solver uses a fully explicit, second-order accurate, centered finite-difference scheme in time and space. The metaverse rendering engine couples one simulation update per rendered frame, so the simulation time step equals the inter-frame interval, $\\Delta t = \\frac{1}{F}$, where $F$ is the render frame rate.\n\nUsing the wave equation as the fundamental model and performing a discrete stability analysis appropriate for explicit centered schemes (for example, a von Neumann analysis), derive the stability constraint on $\\Delta t$ in terms of $c$ and $\\Delta x$. Then translate this constraint into a requirement on $F$ that guarantees stability when one simulation step is taken per frame. Finally, for the following twin parameters, compute the minimum stable frame rate:\n- Speed of sound $c = 343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$,\n- Pipeline length $L = 30\\ \\mathrm{m}$,\n- Number of grid points $N = 11$.\n\nExpress your final frame rate in $\\mathrm{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "The user has provided a valid, well-posed problem statement that is scientifically grounded in the fields of computational physics and numerical analysis. I shall proceed with the derivation and solution.\n\nThe problem asks for the minimum stable frame rate for a numerical simulation of the one-dimensional linear wave equation, which is given as:\n$$ \\frac{\\partial^{2} u}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} u}{\\partial x^{2}} $$\nwhere $u(x,t)$ is the acoustic pressure field, and $c$ is the speed of sound.\n\nThe simulation employs a fully explicit, second-order accurate, centered finite-difference scheme in both time and space. Let the discrete grid be defined by points $(x_j, t_n)$ where $x_j = j \\Delta x$ and $t_n = n \\Delta t$, with $j$ and $n$ being integers. The numerical approximation of $u(x_j, t_n)$ is denoted by $u_j^n$.\n\nThe second partial derivative with respect to time, $\\frac{\\partial^{2} u}{\\partial t^{2}}$, is approximated by the centered difference:\n$$ \\frac{\\partial^{2} u}{\\partial t^{2}} \\approx \\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{(\\Delta t)^2} $$\nSimilarly, the second partial derivative with respect to space, $\\frac{\\partial^{2} u}{\\partial x^{2}}$, is approximated by:\n$$ \\frac{\\partial^{2} u}{\\partial x^{2}} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} $$\nSubstituting these approximations into the wave equation gives the discrete finite-difference equation:\n$$ \\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{(\\Delta t)^2} = c^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} $$\nTo find the update rule for $u_j^{n+1}$, we rearrange the terms:\n$$ u_j^{n+1} = 2u_j^n - u_j^{n-1} + \\frac{c^2 (\\Delta t)^2}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\nIt is standard to define the Courant number, $\\sigma$, as the dimensionless ratio:\n$$ \\sigma = \\frac{c \\Delta t}{\\Delta x} $$\nSubstituting $\\sigma$ into the update equation, we get:\n$$ u_j^{n+1} = 2u_j^n - u_j^{n-1} + \\sigma^2 (u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\n$$ u_j^{n+1} = 2(1 - \\sigma^2)u_j^n + \\sigma^2(u_{j+1}^n + u_{j-1}^n) - u_j^{n-1} $$\nTo determine the stability of this explicit scheme, we perform a von Neumann stability analysis. We consider the evolution of a single Fourier mode of the solution, represented as:\n$$ u_j^n = G^n e^{i k x_j} = G^n e^{i k j \\Delta x} $$\nwhere $k$ is the wavenumber and $G=G(k)$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber, i.e., $|G| \\leq 1$.\n\nSubstituting the trial solution into the finite-difference equation:\n$$ G^{n+1}e^{ikj\\Delta x} = 2(1 - \\sigma^2)G^n e^{ikj\\Delta x} + \\sigma^2(G^n e^{ik(j+1)\\Delta x} + G^n e^{ik(j-1)\\Delta x}) - G^{n-1}e^{ikj\\Delta x} $$\nDividing through by $G^{n-1}e^{ikj\\Delta x}$ yields a characteristic equation for $G$:\n$$ G^2 = 2(1 - \\sigma^2)G + \\sigma^2(G e^{ik\\Delta x} + G e^{-ik\\Delta x}) - 1 $$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, the expression simplifies to:\n$$ G^2 = 2G(1 - \\sigma^2) + 2G\\sigma^2 \\cos(k\\Delta x) - 1 $$\n$$ G^2 - 2G(1 - \\sigma^2 + \\sigma^2 \\cos(k\\Delta x)) + 1 = 0 $$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$, this becomes:\n$$ G^2 - 2G\\left(1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\\right) + 1 = 0 $$\nThis is a quadratic equation for $G$ of the form $aG^2+bG+c=0$. The roots are stable ($|G| \\leq 1$) if they are complex conjugates on the unit circle or real with magnitude at most $1$. This condition is met if the discriminant of the quadratic equation is non-positive, i.e., $b^2 - 4ac \\leq 0$.\n$$ \\left[-2\\left(1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\\right)\\right]^2 - 4(1)(1) \\leq 0 $$\n$$ 4\\left(1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\leq 4 $$\n$$ \\left(1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\\right)^2 \\leq 1 $$\nTaking the square root of both sides gives:\n$$ -1 \\leq 1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\leq 1 $$\nThe right side of the inequality, $1 - 2\\sigma^2 \\sin^2(\\frac{k\\Delta x}{2}) \\leq 1$, simplifies to $-2\\sigma^2 \\sin^2(\\frac{k\\Delta x}{2}) \\leq 0$, which is always true since $\\sigma^2 \\ge 0$ and $\\sin^2(\\cdot) \\ge 0$.\nThe left side provides the actual stability constraint:\n$$ -1 \\leq 1 - 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n$$ 2\\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\leq 2 $$\n$$ \\sigma^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\leq 1 $$\nThis inequality must hold for all possible wavenumbers $k$. The term $\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)$ has a maximum value of $1$. To ensure stability under the worst-case scenario, we set this term to its maximum:\n$$ \\sigma^2 \\leq 1 \\implies \\sigma \\leq 1 $$\nThis is the renowned Courant-Friedrichs-Lewy (CFL) stability condition for this scheme. Substituting the definition of $\\sigma$:\n$$ \\frac{c \\Delta t}{\\Delta x} \\leq 1 $$\nThe stability constraint on the time step $\\Delta t$ is therefore:\n$$ \\Delta t \\leq \\frac{\\Delta x}{c} $$\nThe problem states that the simulation time step $\\Delta t$ is tied to the render frame rate $F$ by the relation $\\Delta t = \\frac{1}{F}$. Substituting this into the stability constraint:\n$$ \\frac{1}{F} \\leq \\frac{\\Delta x}{c} $$\nSolving for the frame rate $F$, we find the requirement for stability:\n$$ F \\geq \\frac{c}{\\Delta x} $$\nThis means the minimum stable frame rate, $F_{min}$, is:\n$$ F_{min} = \\frac{c}{\\Delta x} $$\nNow, we compute the numerical value for $F_{min}$ using the given parameters. First, we calculate the grid spacing $\\Delta x$:\n- Pipeline length $L = 30\\ \\mathrm{m}$\n- Number of grid points $N = 11$\nThe grid spacing is $\\Delta x = \\frac{L}{N-1}$.\n$$ \\Delta x = \\frac{30\\ \\mathrm{m}}{11 - 1} = \\frac{30\\ \\mathrm{m}}{10} = 3\\ \\mathrm{m} $$\nNext, we use the speed of sound $c = 343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ to find the minimum stable frame rate:\n$$ F_{min} = \\frac{343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}}{3\\ \\mathrm{m}} = \\frac{343}{3}\\ \\mathrm{s}^{-1} $$\n$$ F_{min} \\approx 114.333...\\ \\mathrm{s}^{-1} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ F_{min} = 114.3\\ \\mathrm{s}^{-1} $$",
            "answer": "$$\\boxed{114.3}$$"
        },
        {
            "introduction": "A digital twin's core function is to accurately mirror its physical counterpart, a task complicated by inherent process variations and noisy sensor measurements. This exercise delves into the heart of state estimation by examining the performance of the Kalman filter, a cornerstone algorithm for fusing uncertain data. By deriving the steady-state error covariance, you will gain a foundational understanding of the ultimate tracking accuracy achievable by the twin and see how it depends on the physical system dynamics and sensor quality .",
            "id": "4227327",
            "problem": "A metaverse-integrated digital twin of a human-robot collaborative manipulator renders a haptic interaction in real time to an Extended Reality (XR) user. The virtual environment updates the twin’s end-effector offset along one Cartesian axis using inertial sensing and visual tracking. The scalar latent state $x_k$ denotes the offset between the physical end-effector and its rendered position at discrete time index $k$. The cyber-physical pipeline is modeled as a linear Gaussian system with discrete-time dynamics and sensing:\n$$\nx_{k+1} = f\\,x_k + w_k,\\quad z_k = x_k + v_k,\n$$\nwhere $w_k \\sim \\mathcal{N}(0,q)$ is the process noise due to actuation variability and rendering latency, and $v_k \\sim \\mathcal{N}(0,r)$ is the measurement noise due to visual tracking in the immersive environment. Assume $0 < f < 1$, $q > 0$, and $r > 0$ are constants, and that $x_k$ is estimated using the linear minimum-variance estimator commonly known as the Kalman Filter (KF), initialized with posterior covariance $P_0^{+} > 0$.\n\nPart 1 (covariance evolution). Starting from fundamental definitions of covariance propagation for linear time-invariant dynamics, derive a closed-form expression for the prediction covariance $P_k^{-}$ after $k$ steps using only the state transition coefficient $f$ and the process noise variance $q$. You may assume no measurements are incorporated during these $k$ steps.\n\nPart 2 (steady-state uncertainty under measurement noise). Using the same fundamental base for linear Gaussian estimation, derive and solve the fixed-point condition for the steady-state posterior covariance $P_{\\infty}^{+}$ of the KF in terms of $f$, $q$, and $r$. Explicitly express $P_{\\infty}^{+}$ as a single closed-form analytic expression in these parameters. Your final answer must be that single expression. No numerical evaluation is required, and no units are to be reported with the final expression.",
            "solution": "The user has provided a problem in two parts concerning the covariance evolution in a scalar linear Gaussian system estimated via a Kalman Filter. The problem has been validated and found to be scientifically grounded, well-posed, and objective.\n\nThe system is defined by the following discrete-time equations:\nState dynamics: $x_{k+1} = f x_k + w_k$, with process noise $w_k \\sim \\mathcal{N}(0, q)$.\nMeasurement model: $z_k = x_k + v_k$, with measurement noise $v_k \\sim \\mathcal{N}(0, r)$.\nThe parameters are constants satisfying $0 < f < 1$, $q > 0$, and $r > 0$.\n\nFor a scalar system, the Kalman Filter covariance equations are specializations of the general matrix forms. The state transition matrix is $F=f$, the observation matrix is $H=1$, the process noise covariance is $Q=q$, and the measurement noise covariance is $R=r$. The state covariance $P$ is a scalar.\n\nPart 1: Covariance Evolution (Prediction Only)\n\nThis part requires deriving the prediction covariance $P_k^{-}$ after $k$ steps, assuming no measurements are incorporated. The fundamental equation for covariance prediction is:\n$$ P_{k+1}^{-} = F P_k^{+} F^T + Q $$\nIn our scalar case, this becomes:\n$$ P_{k+1}^{-} = f P_k^{+} f + q = f^2 P_k^{+} + q $$\nwhere $P_k^{+}$ is the posterior (measurement-updated) covariance at step $k$, and $P_{k+1}^{-}$ is the prior (predicted) covariance at step $k+1$.\n\nThe condition \"no measurements are incorporated\" implies that the measurement update step of the filter is omitted for all steps. In this case, the posterior covariance at step $k$ is simply equal to the prior covariance at step $k$:\n$$ P_k^{+} = P_k^{-} $$\nSubstituting this into the prediction equation yields a recurrence relation for the prior covariance:\n$$ P_{k+1}^{-} = f^2 P_k^{-} + q $$\nTo solve this recurrence, we must establish an initial condition. The problem asks for the covariance \"after $k$ steps\", which implies tracking the accumulation of uncertainty from a starting point. A standard interpretation that makes the result independent of an arbitrary initial covariance (and dependent only on $f$ and $q$ as requested) is to assume that the initial state is known perfectly, i.e., the initial covariance is zero. We set $P_0^{-} = 0$.\n\nWe can now unroll the recurrence:\nFor $k=1$: $P_1^{-} = f^2 P_0^{-} + q = f^2(0) + q = q$.\nFor $k=2$: $P_2^{-} = f^2 P_1^{-} + q = f^2(q) + q$.\nFor $k=3$: $P_3^{-} = f^2 P_2^{-} + q = f^2(f^2 q + q) + q = f^4 q + f^2 q + q$.\n\nBy induction, the expression for $P_k^{-}$ is a sum:\n$$ P_k^{-} = q + f^2 q + f^4 q + \\dots + f^{2(k-1)} q = q \\sum_{i=0}^{k-1} (f^2)^i $$\nThis is a finite geometric series with first term $a=q$, ratio $r' = f^2$, and $k$ terms. The sum of a finite geometric series is $S_n = a \\frac{1 - (r')^n}{1 - r'}$. Applying this formula, we get the closed-form expression for $P_k^{-}$:\n$$ P_k^{-} = q \\frac{1 - (f^2)^k}{1 - f^2} = q \\frac{1 - f^{2k}}{1 - f^2} $$\nThis expression depends only on $f$ and $q$, as required. As $k \\to \\infty$, since $0 < f < 1$, we have $f^{2k} \\to 0$, and the covariance approaches the stationary process variance $P_{\\infty}^{-} = \\frac{q}{1-f^2}$.\n\nPart 2: Steady-State Posterior Covariance\n\nThis part requires deriving the steady-state posterior covariance, $P_{\\infty}^{+}$, for the full Kalman Filter. We use the complete set of covariance equations.\n\n1.  **Prediction:** The prior covariance at step $k$ is calculated from the posterior covariance at step $k-1$:\n    $$ P_k^{-} = f^2 P_{k-1}^{+} + q $$\n\n2.  **Kalman Gain:** The gain $K_k$ determines how much the measurement residual updates the state estimate:\n    $$ K_k = \\frac{P_k^{-} H^T}{H P_k^{-} H^T + R} = \\frac{P_k^{-}(1)}{(1)P_k^{-}(1) + r} = \\frac{P_k^{-}}{P_k^{-} + r} $$\n\n3.  **Update:** The posterior covariance at step $k$ is computed by correcting the prior covariance:\n    $$ P_k^{+} = (I - K_k H) P_k^{-} = (1 - K_k) P_k^{-} $$\n    Substituting the expression for $K_k$:\n    $$ P_k^{+} = \\left(1 - \\frac{P_k^{-}}{P_k^{-} + r}\\right) P_k^{-} = \\left(\\frac{P_k^{-} + r - P_k^{-}}{P_k^{-} + r}\\right) P_k^{-} = \\frac{r P_k^{-}}{P_k^{-} + r} $$\n\nNow, we combine these equations to form a single recurrence relation for the posterior covariance, $P_k^{+}$. Substitute the prediction equation into the update equation:\n$$ P_k^{+} = \\frac{r (f^2 P_{k-1}^{+} + q)}{ (f^2 P_{k-1}^{+} + q) + r } $$\nThis is the discrete-time Riccati equation for the scalar system.\n\nIn steady state, the covariance converges to a constant value, so $\\lim_{k \\to \\infty} P_k^{+} = P_{\\infty}^{+}$. At this fixed point, we have $P_k^{+} = P_{k-1}^{+} = P_{\\infty}^{+}$. Substituting $P_{\\infty}^{+}$ into the Riccati equation gives the Algebraic Riccati Equation (ARE):\n$$ P_{\\infty}^{+} = \\frac{r (f^2 P_{\\infty}^{+} + q)}{f^2 P_{\\infty}^{+} + q + r} $$\nTo solve for $P_{\\infty}^{+}$, we rearrange this into a quadratic equation. Let $P = P_{\\infty}^{+}$ for notational simplicity:\n$$ P (f^2 P + q + r) = r (f^2 P + q) $$\n$$ f^2 P^2 + (q+r)P = f^2 r P + qr $$\n$$ f^2 P^2 + (q+r - f^2 r)P - qr = 0 $$\n$$ f^2 P^2 + (q + r(1-f^2))P - qr = 0 $$\nThis is a quadratic equation of the form $aP^2+bP+c=0$ with coefficients:\n$a = f^2$\n$b = q + r(1-f^2)$\n$c = -qr$\n\nWe use the quadratic formula to find the roots:\n$$ P = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n$$ P = \\frac{-(q + r(1-f^2)) \\pm \\sqrt{(q + r(1-f^2))^2 - 4(f^2)(-qr)}}{2f^2} $$\n$$ P = \\frac{-(q + r(1-f^2)) \\pm \\sqrt{(q + r(1-f^2))^2 + 4f^2qr}}{2f^2} $$\nSince covariance must be a non-negative quantity ($P \\ge 0$), we must select the physically meaningful root. The parameters $f, q, r$ are all positive, and $0 < f < 1$ implies $1-f^2 > 0$. Therefore, the coefficient $b = q + r(1-f^2)$ is strictly positive. The term under the square root, $(q + r(1-f^2))^2 + 4f^2qr$, is also strictly positive.\nThe term $\\sqrt{b^2 + 4f^2qr}$ is strictly greater than $\\sqrt{b^2} = |b| = b$.\nConsequently, the root with the minus sign, $\\frac{-b - \\sqrt{b^2 + 4f^2qr}}{2a}$, will be negative because both terms in the numerator are negative and the denominator is positive.\nThe only physically valid solution is the positive root:\n$$ P_{\\infty}^{+} = \\frac{-(q + r(1-f^2)) + \\sqrt{(q + r(1-f^2))^2 + 4f^2qr}}{2f^2} $$\nThis is the closed-form analytic expression for the steady-state posterior covariance of the Kalman filter in terms of $f$, $q$, and $r$.",
            "answer": "$$ \\boxed{ \\frac{-(q + r(1-f^{2})) + \\sqrt{(q + r(1-f^{2}))^{2} + 4f^{2}qr}}{2f^{2}} } $$"
        }
    ]
}