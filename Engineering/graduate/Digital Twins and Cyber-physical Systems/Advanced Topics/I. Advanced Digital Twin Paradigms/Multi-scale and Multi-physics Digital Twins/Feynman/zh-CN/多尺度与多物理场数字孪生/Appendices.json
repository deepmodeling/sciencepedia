{
    "hands_on_practices": [
        {
            "introduction": "多尺度数字孪生必须有效地在宏观尺度上表示复杂的微观结构。这通过“均质化”（homogenization）来实现，该过程旨在推导出能够捕捉材料整体行为的等效属性。第一个练习将引导您推导一种简单层状复合材料的等效热导率，这是理解微观尺度细节如何影响宏观系统性能的基础性练习。",
            "id": "4232929",
            "problem": "一个信息物理热管理系统由一个多尺度数字孪生（DT）表示，该数字孪生必须对层状复合微观结构的热行为进行均质化，以驱动宏观尺度的预测。考虑一个代表性体积单元（RVE），它由两种各向同性材料的无限重复层压板组成，其热导率分别为 $k_{1}$ 和 $k_{2}$。该层压板沿堆叠方向呈周期性；在每个周期中，材料 $1$ 和材料 $2$ 占据的厚度分数分别为 $\\phi_{1}$ 和 $\\phi_{2}$，且 $\\phi_{1} + \\phi_{2} = 1$。假设稳态、一维热传导、无内部热源以及完美的界面结合。\n\n在宏观尺度上定义两种加载方向：\n- “并联”配置：宏观温度梯度平行于各层施加，因此热量通过RVE横截面，在材料 $1$ 的连续区域和材料 $2$ 的连续区域中并行流动。\n- “串联”配置：宏观温度梯度垂直于各层施加，因此热量在每个周期内沿堆叠方向串联穿过材料 $1$ 和材料 $2$ 的连续部分。\n\n仅从基本原理——Fourier热传导定律 $q = -k \\nabla T$、稳态能量守恒以及通过总热流率等效定义的有效属性——推导出RVE在“并联”和“串联”两种配置下的均质化有效热导率 $k_{\\text{eff}}$ 的闭式表达式，用 $k_{1}$、$k_{2}$、$\\phi_{1}$ 和 $\\phi_{2}$ 表示。\n\n你的最终答案必须以收集到单个行矩阵 $(\\text{parallel}, \\text{series})$ 中的两个符号表达式的形式给出。不需要进行数值代入，也无需报告单位。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，提法明确，客观，并包含推导唯一且有意义解所需的所有必要信息。该问题是复合材料均质化中的一个经典练习，这是多尺度建模中的一项基本技术，与高保真数字孪生的开发直接相关。\n\n我们将通过应用基本原理，推导两种指定配置的有效热导率 $k_{\\text{eff}}$。\n\n**1. 并联配置**\n\n在并联配置中，宏观温度梯度平行于材料层施加。我们建立一个坐标系，其中各层沿 $y$ 轴堆叠，热流沿 $x$ 轴方向。因此，宏观温度梯度 $\\nabla T$ 在 $x$ 方向上施加。对于一维稳态热流，这意味着温度 $T$ 仅是 $x$ 的函数，即 $T = T(x)$。\n\n这种设置的一个关键结果是，在任何给定的 $x$ 处，温度场是连续且单值的。这意味着温度梯度 $\\frac{dT}{dx}$ 在整个复合材料中是均匀的，并且在两种材料相中相等。\n$$\n\\nabla T_{1} = \\nabla T_{2} = \\nabla T_{\\text{macro}} \\equiv \\left( \\frac{dT}{dx}, 0, 0 \\right)\n$$\n让我们将沿流动方向的梯度大小表示为 $G_x = \\frac{dT}{dx}$。\n\n根据Fourier热传导定律，热通量 $q$（单位面积的热流率）由 $q = -k \\nabla T$ 给出。材料 $1$ 和材料 $2$ 中的热通量为：\n$$\nq_{1} = -k_{1} \\frac{dT}{dx}\n$$\n$$\nq_{2} = -k_{2} \\frac{dT}{dx}\n$$\n\n通过复合材料横截面的总热流率 $Q_{\\text{tot}}$，根据能量守恒定律，是流经每种组成材料的热流率之和。设 $A$ 为垂直于热流的总横截面积。材料 $1$ 和材料 $2$ 占据的面积分别为 $A_{1}$ 和 $A_{2}$。给定厚度分数 $\\phi_{1}$ 和 $\\phi_{2}$，这些面积为 $A_{1} = \\phi_{1} A$ 和 $A_{2} = \\phi_{2} A$。热流率为 $Q = qA$。\n$$\nQ_{\\text{tot}} = Q_{1} + Q_{2} = q_{1} A_{1} + q_{2} A_{2}\n$$\n\n均质化或有效属性 $k_{\\text{eff,p}}$（其中‘p’代表并联）的定义是，总热流率通过以下方式与宏观温度梯度相关联：\n$$\nQ_{\\text{tot}} = q_{\\text{eff}} A = \\left(-k_{\\text{eff,p}} \\frac{dT}{dx}\\right) A\n$$\n\n将 $Q_{\\text{tot}}$ 的两个表达式相等：\n$$\n\\left(-k_{\\text{eff,p}} \\frac{dT}{dx}\\right) A = \\left(-k_{1} \\frac{dT}{dx}\\right) A_{1} + \\left(-k_{2} \\frac{dT}{dx}\\right) A_{2}\n$$\n代入 $A_{1} = \\phi_{1} A$ 和 $A_{2} = \\phi_{2} A$：\n$$\n\\left(-k_{\\text{eff,p}} \\frac{dT}{dx}\\right) A = \\left(-k_{1} \\frac{dT}{dx}\\right) (\\phi_{1} A) + \\left(-k_{2} \\frac{dT}{dx}\\right) (\\phi_{2} A)\n$$\n假设温度梯度和横截面积非零，我们可以消去方程两边的公因子 $\\left(-\\frac{dT}{dx}\\right) A$。\n$$\nk_{\\text{eff,p}} = k_{1} \\phi_{1} + k_{2} \\phi_{2}\n$$\n该表达式是混合法则，表示各组分热导率的体积分数加权算术平均值。\n\n**2. 串联配置**\n\n在串联配置中，宏观温度梯度垂直于各层施加。设堆叠方向和热流方向均沿 $x$ 轴。RVE 的总厚度为 $L$，由厚度为 $L_{1} = \\phi_{1} L$ 的材料 $1$ 层和厚度为 $L_{2} = \\phi_{2} L$ 的材料 $2$ 层组成。\n\n对于没有内部热源的稳态一维热流，能量守恒原理规定热通量 $q$ 在整个复合材料中必须是恒定的。\n$$\nq_{1} = q_{2} = q_{\\text{eff}} \\equiv q\n$$\n\n跨越复合材料厚度 $L$ 的总温差 $\\Delta T_{\\text{tot}}$ 是跨越每个单独层的温差 $\\Delta T_{1}$ 和 $\\Delta T_{2}$ 的总和。\n$$\n\\Delta T_{\\text{tot}} = \\Delta T_{1} + \\Delta T_{2}\n$$\n\n根据Fourier定律 $q = -k \\frac{\\Delta T}{\\Delta x}$，我们可以表示每一层的温差：\n$$\n\\Delta T_{1} = -q \\frac{L_{1}}{k_{1}} = -q \\frac{\\phi_{1} L}{k_{1}}\n$$\n$$\n\\Delta T_{2} = -q \\frac{L_{2}}{k_{2}} = -q \\frac{\\phi_{2} L}{k_{2}}\n$$\n\n有效热导率 $k_{\\text{eff,s}}$（其中‘s’代表串联）将总温差 $\\Delta T_{\\text{tot}}$ 与恒定热通量 $q$ 和总厚度 $L$ 相关联：\n$$\n\\Delta T_{\\text{tot}} = -q \\frac{L}{k_{\\text{eff,s}}}\n$$\n\n将 $\\Delta T_{1}$ 和 $\\Delta T_{2}$ 的表达式代入 $\\Delta T_{\\text{tot}}$ 的求和式中：\n$$\n-q \\frac{L}{k_{\\text{eff,s}}} = \\left(-q \\frac{\\phi_{1} L}{k_{1}}\\right) + \\left(-q \\frac{\\phi_{2} L}{k_{2}}\\right)\n$$\n假设热通量和厚度非零，我们可以消去公因子 $-qL$。\n$$\n\\frac{1}{k_{\\text{eff,s}}} = \\frac{\\phi_{1}}{k_{1}} + \\frac{\\phi_{2}}{k_{2}}\n$$\n求解 $k_{\\text{eff,s}}$ 得到串联配置的最终表达式：\n$$\nk_{\\text{eff,s}} = \\left(\\frac{\\phi_{1}}{k_{1}} + \\frac{\\phi_{2}}{k_{2}}\\right)^{-1}\n$$\n这是各组分热导率的体积分数加权调和平均值。它也可以写成 $k_{\\text{eff,s}} = \\frac{k_{1}k_{2}}{k_{2}\\phi_{1} + k_{1}\\phi_{2}}$。\n\n这两个推导出的表达式为并联和串联热流配置提供了均质化热导率，这是多尺度数字孪生中宏观尺度模型的基本输入。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} k_{1}\\phi_{1} + k_{2}\\phi_{2}  \\left(\\frac{\\phi_{1}}{k_{1}} + \\frac{\\phi_{2}}{k_{2}}\\right)^{-1} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "创建高保真数字孪生的一个关键挑战是模拟不同物理现象之间的相互作用。本练习提供了一个具体的多物理场耦合示例，您将分析电磁力如何引起机械变形。通过推导载流导线在磁场中的偏转，您将实践如何连接不同的物理定律来预测耦合系统的行为。",
            "id": "4232876",
            "problem": "一根细长的棱柱状导线被建模为一根长度为 $L$ 的 Euler–Bernoulli 悬臂梁，其在 $x=0$ 处被夹持固定，在 $x=L$ 处为自由端。该导线承载着大小为 $I$ 的稳定直流电流，方向沿 $+x$ 轴。它被置于一个空间均匀、大小为 $B$ 的磁通量密度 $\\mathbf{B}$ 中，该磁场方向与电流方向正交，因此洛伦兹力密度纯粹沿 $+y$ 方向作用。假设挠度很小，材料呈线性弹性行为，且有效抗弯刚度 $K_b$（等于 $E I_{\\text{sec}}$，其中 $E$ 是杨氏模量，$I_{\\text{sec}}$ 是截面二次矩）沿梁的跨度保持恒定。忽略变形对电流分布的任何电磁反馈以及任何几何非线性。\n\n在一个通过洛伦兹力耦合电磁学和结构力学的多物理场数字孪生模型中，您的任务是推导静态尖端挠度 $y(L)$ 的精确闭式表达式，以用作观测模型。请从洛伦兹力密度定义和 Euler–Bernoulli 梁平衡关系式出发，并应用悬臂梁的适当边界条件。\n\n提供 $y(L)$ 的最终符号表达式，该表达式仅为 $I$、$B$、$L$ 和 $K_b$ 的函数。最终挠度以米为单位表示。最终答案必须是单一的闭式解析表达式，不含任何辅助定义。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于电磁学和结构力学的既定原理，提法得当，信息充分且一致，并以客观、正式的语言表述。所有必需的数据、边界条件和假设均已提供，以便推导出唯一且有意义的解。\n\n问题要求推导一根承受洛伦兹力的悬臂导线的静态尖端挠度 $y(L)$。该导线被建模为一根 Euler–Bernoulli 梁。\n\n首先，我们确定梁上的横向载荷。在磁场 $\\mathbf{B}$ 中，一段长度为 $d\\mathbf{l}$、承载电流 $I$ 的导线所受的洛伦兹力 $\\mathbf{F}$ 由 $d\\mathbf{F} = I (d\\mathbf{l} \\times \\mathbf{B})$ 给出。因此，单位长度上的力，即力密度 $q(x)$，为 $\\mathbf{q}(x) = I (\\hat{\\mathbf{u}} \\times \\mathbf{B})$，其中 $\\hat{\\mathbf{u}}$ 是电流方向的单位向量。\n\n问题陈述中指出电流 $I$ 沿 $+x$ 方向流动，因此 $\\hat{\\mathbf{u}} = \\hat{\\mathbf{i}}$。磁场 $\\mathbf{B}$ 的大小为均匀值 $B$，且方向与电流正交。电流方向与磁场之间的夹角为 $\\theta = \\frac{\\pi}{2}$。因此，力密度的大小沿梁的长度是恒定的：\n$$ q = | I (\\hat{\\mathbf{i}} \\times \\mathbf{B}) | = I |\\hat{\\mathbf{i}}| |\\mathbf{B}| \\sin\\left(\\frac{\\pi}{2}\\right) = IB $$\n问题指明该力密度纯粹沿 $+y$ 方向作用。因此，我们得到一个均匀分布的横向载荷 $q(x) = IB$。\n\nEuler–Bernoulli 梁的静态挠度 $y(x)$ 的控制方程为：\n$$ \\frac{d^2}{dx^2} \\left( K_b \\frac{d^2y}{dx^2} \\right) = q(x) $$\n其中 $K_b$ 是抗弯刚度，给定为常数。该方程简化为：\n$$ K_b \\frac{d^4y}{dx^4} = q(x) $$\n代入均布载荷 $q(x) = IB$，我们得到梁挠度的常微分方程：\n$$ K_b \\frac{d^4y}{dx^4} = IB $$\n我们通过对 $x$ 积分四次来求解该方程：\n$$ K_b \\frac{d^3y}{dx^3} = IBx + C_1 $$\n$$ K_b \\frac{d^2y}{dx^2} = \\frac{IB}{2}x^2 + C_1x + C_2 $$\n$$ K_b \\frac{dy}{dx} = \\frac{IB}{6}x^3 + \\frac{C_1}{2}x^2 + C_2x + C_3 $$\n$$ K_b y(x) = \\frac{IB}{24}x^4 + \\frac{C_1}{6}x^3 + \\frac{C_2}{2}x^2 + C_3x + C_4 $$\n积分常数 $C_1$、$C_2$、$C_3$ 和 $C_4$ 由在 $x=0$ 处固定、在 $x=L$ 处自由的悬臂梁的边界条件确定。\n\n边界条件为：\n1.  固定端 $x=0$：零挠度，$y(0) = 0$。\n2.  固定端 $x=0$：零转角，$\\frac{dy}{dx}(0) = 0$。\n3.  自由端 $x=L$：零弯矩，$M(L) = K_b \\frac{d^2y}{dx^2}(L) = 0$。\n4.  自由端 $x=L$：零剪力，$V(L) = K_b \\frac{d^3y}{dx^3}(L) = 0$。\n\n应用固定端 $x=0$ 处的条件：\n根据 $y(0) = 0$：\n$$ K_b y(0) = \\frac{IB}{24}(0)^4 + \\frac{C_1}{6}(0)^3 + \\frac{C_2}{2}(0)^2 + C_3(0) + C_4 = 0 \\implies C_4=0 $$\n根据 $\\frac{dy}{dx}(0) = 0$：\n$$ K_b \\frac{dy}{dx}(0) = \\frac{IB}{6}(0)^3 + \\frac{C_1}{2}(0)^2 + C_2(0) + C_3 = 0 \\implies C_3=0 $$\n现在，应用自由端 $x=L$ 处的条件：\n根据 $V(L) = 0$：\n$$ K_b \\frac{d^3y}{dx^3}(L) = IBL + C_1 = 0 \\implies C_1 = -IBL $$\n根据 $M(L) = 0$：\n$$ K_b \\frac{d^2y}{dx^2}(L) = \\frac{IB}{2}L^2 + C_1L + C_2 = 0 $$\n代入 $C_1$ 的值：\n$$ \\frac{IB}{2}L^2 + (-IBL)L + C_2 = 0 $$\n$$ \\frac{IBL^2}{2} - IBL^2 + C_2 = 0 $$\n$$ -\\frac{IBL^2}{2} + C_2 = 0 \\implies C_2 = \\frac{IBL^2}{2} $$\n找到了所有积分常数后，我们可以写出挠度曲线 $y(x)$ 的特解：\n$$ K_b y(x) = \\frac{IB}{24}x^4 + \\frac{(-IBL)}{6}x^3 + \\frac{(IBL^2/2)}{2}x^2 $$\n$$ K_b y(x) = \\frac{IB}{24}x^4 - \\frac{IBL}{6}x^3 + \\frac{IBL^2}{4}x^2 $$\n任意点 $x$ 处的挠度为：\n$$ y(x) = \\frac{IB}{K_b} \\left( \\frac{x^4}{24} - \\frac{Lx^3}{6} + \\frac{L^2x^2}{4} \\right) $$\n问题要求的是尖端挠度，即 $x=L$ 处的挠度。我们将 $x=L$ 代入 $y(x)$ 的表达式中：\n$$ y(L) = \\frac{IB}{K_b} \\left( \\frac{L^4}{24} - \\frac{L(L^3)}{6} + \\frac{L^2(L^2)}{4} \\right) $$\n$$ y(L) = \\frac{IBL^4}{K_b} \\left( \\frac{1}{24} - \\frac{1}{6} + \\frac{1}{4} \\right) $$\n为了合并分数，我们找到公分母，即 $24$：\n$$ y(L) = \\frac{IBL^4}{K_b} \\left( \\frac{1}{24} - \\frac{4}{24} + \\frac{6}{24} \\right) $$\n$$ y(L) = \\frac{IBL^4}{K_b} \\left( \\frac{1 - 4 + 6}{24} \\right) $$\n$$ y(L) = \\frac{IBL^4}{K_b} \\left( \\frac{3}{24} \\right) = \\frac{IBL^4}{K_b} \\left( \\frac{1}{8} \\right) $$\n静态尖端挠度的最终表达式为：\n$$ y(L) = \\frac{IBL^4}{8K_b} $$\n问题要求以米为单位表示挠度，这与所提供变量采用国际单位制（SI）在量纲上是一致的。\n$[I] = \\text{A}$, $[B] = \\text{T} = \\text{N}\\cdot\\text{A}^{-1}\\cdot\\text{m}^{-1}$, $[L] = \\text{m}$, $[K_b] = \\text{N}\\cdot\\text{m}^2$.\n$$ [y(L)] = \\frac{(\\text{A})(\\text{N}\\cdot\\text{A}^{-1}\\cdot\\text{m}^{-1})(\\text{m}^4)}{\\text{N}\\cdot\\text{m}^2} = \\frac{\\text{N}\\cdot\\text{m}^3}{\\text{N}\\cdot\\text{m}^2} = \\text{m} $$\n该表达式量纲正确。",
            "answer": "$$\n\\boxed{\\frac{IBL^{4}}{8K_{b}}}\n$$"
        },
        {
            "introduction": "数字孪生的真正威力在于它能够实时反映其物理实体的状态，而这依赖于精心设计的传感器网络。最后一个练习从模型创建转向应用，挑战您评估一个复杂热机系统的“可观测性”（observability）。通过计算经验可观测性格拉姆矩阵（Empirical Observability Gramian），您将获得确定给定传感器布局是否足以从其输出中唯一识别系统内部状态的实践经验。",
            "id": "4232843",
            "problem": "考虑一个用于数字孪生的四状态、耦合、多物理场和多尺度的信息物理系统。状态向量为 $x(t) = [T_M(t), T_m(t), u(t), v(t)]^\\top$，其中 $T_M$ 是宏观尺度温度（单位为 $\\mathrm{K}$），$T_m$ 是微观尺度温度（单位为 $\\mathrm{K}$），$u$ 是机械位移（单位为 $\\mathrm{m}$），$v$ 是机械速度（单位为 $\\mathrm{m/s}$）。宏观尺度热子系统与环境和微观尺度交换热量，机械子系统则承受阻尼、刚度、外力和热机耦合作用。其连续时间动力学由以下常微分方程组决定，这些方程基于牛顿第二定律和集总参数热平衡：\n$$\n\\frac{d}{dt}T_M(t) = -\\frac{g_{\\mathrm{env}}}{C_M}\\left(T_M(t) - T_{\\mathrm{env}}\\right) + \\frac{k_c}{C_M}\\left(T_m(t) - T_M(t)\\right) + \\frac{Q_0 \\sin(2\\pi f_h t)}{C_M},\n$$\n$$\n\\frac{d}{dt}T_m(t) = \\frac{k_c}{C_m}\\left(T_M(t) - T_m(t)\\right) + \\frac{\\eta\\,c\\,v(t)^2}{C_m},\n$$\n$$\n\\frac{d}{dt}u(t) = v(t),\n$$\n$$\n\\frac{d}{dt}v(t) = \\frac{1}{m}\\left[-c\\,v(t) - k\\,u(t) + \\gamma\\left(T_M(t) - T_{\\mathrm{ref}}\\right) - \\delta\\left(T_m(t) - T_{\\mathrm{ref}}\\right) + F_0\\cos(2\\pi f_m t)\\right].\n$$\n所有参数均为常数且具有实际物理意义。使用以下参数值：\n- $m = 1.5\\,\\mathrm{kg}$, $c = 0.8\\,\\mathrm{N\\,s/m}$, $k = 50\\,\\mathrm{N/m}$,\n- $C_M = 1000\\,\\mathrm{J/K}$, $C_m = 50\\,\\mathrm{J/K}$, $g_{\\mathrm{env}} = 8\\,\\mathrm{W/K}$, $k_c = 12\\,\\mathrm{W/K}$,\n- $T_{\\mathrm{env}} = 300\\,\\mathrm{K}$, $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$,\n- $Q_0 = 200\\,\\mathrm{W}$，加热频率 $f_h = 0.1\\,\\mathrm{Hz}$,\n- $F_0 = 5\\,\\mathrm{N}$，机械激励频率 $f_m = 0.5\\,\\mathrm{Hz}$,\n- $\\gamma = 2.0\\,\\mathrm{N/K}$, $\\delta = 1.2\\,\\mathrm{N/K}$, $\\eta = 0.7$ (无量纲).\n\n假设标称初始条件为 $x(0) = x_0 = [300, 300, 0, 0]^\\top$，并考虑对初始状态施加沿坐标轴方向的微小扰动，扰动大小为 $\\varepsilon = [\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]^\\top$，具体为\n- $\\varepsilon_1 = 0.5\\,\\mathrm{K}$,\n- $\\varepsilon_2 = 0.5\\,\\mathrm{K}$,\n- $\\varepsilon_3 = 10^{-3}\\,\\mathrm{m}$,\n- $\\varepsilon_4 = 10^{-3}\\,\\mathrm{m/s}$.\n\n您需要通过在扰动初始条件 $x_0 \\pm \\varepsilon_i e_i$（其中 $i \\in \\{1,2,3,4\\}$，$e_i$ 是第 $i$ 个标准基向量）下模拟系统，来近似计算该非线性系统在有限时间域 $[0,T]$ 上的经验可观测性格拉姆矩阵（EOG）。经验可观测性格拉姆矩阵由输出相对于初始状态扰动的灵敏度的内积对时间进行积分得到，该灵敏度可以通过对称有限差分和数值时间积分来近似计算。最终目标是计算 EOG 的数值秩，并评估所选的传感器布局是否能使系统可观测（即可观测性格拉姆矩阵为满秩，秩等于状态维度）。请使用数值稳定的奇异值分解方法，并设置合理的容差。\n\n根据所选的传感器布局定义输出 $y(t) = h(x(t))$。您必须考虑以下包含传感器布局、模拟时域和测量噪声水平的测试套件：\n- 测试用例 $1$：$T = 30\\,\\mathrm{s}$，布局 $h_1(x) = [u,\\,T_M]^\\top$，测量噪声标准差 $\\sigma = 0$（无噪声）。\n- 测试用例 $2$：$T = 30\\,\\mathrm{s}$，布局 $h_2(x) = [u,\\,v,\\,T_M]^\\top$，测量噪声标准差 $\\sigma = 0$。\n- 测试用例 $3$：$T = 30\\,\\mathrm{s}$，布局 $h_3(x) = [u,\\,v,\\,T_M,\\,T_m]^\\top$，测量噪声标准差 $\\sigma = 0$。\n- 测试用例 $4$：$T = 30\\,\\mathrm{s}$，布局 $h_4(x) = [u + 0.1\\,T_M,\\,v,\\,T_M - T_m]^\\top$，测量噪声标准差 $\\sigma = 10^{-3}$，每个传感器通道均加入独立的零均值高斯噪声。\n\n对于所有用例，在 $[0,T]$ 上使用包含 $N = 2000$ 个采样点的均匀时间网格，并通过以下步骤计算 EOG：\n- 对每个 $i \\in \\{1,2,3,4\\}$，从 $x_0 + \\varepsilon_i e_i$ 和 $x_0 - \\varepsilon_i e_i$ 开始模拟系统，\n- 计算对称扰动下的输出差异，\n- 通过对由扰动幅度归一化的输出内积进行时间积分，来构建格拉姆矩阵的元素。\n\n您的程序必须为每个测试用例完成以下任务：\n- 计算经验可观测性格拉姆矩阵，\n- 计算其数值秩（一个整数），\n- 以布尔值形式评估可观测性，当且仅当秩等于 $4$ 时为真。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的结果，格式为方括号内包含的逗号分隔列表。每个测试用例的结果必须是一个形式为 $[\\text{rank},\\text{observable}]$ 的双元素列表，其中 $\\text{rank}$ 是一个整数，$\\text{observable}$ 是一个布尔值。例如，输出应类似于 $[[4,\\mathrm{True}],[3,\\mathrm{False}],[4,\\mathrm{True}],[4,\\mathrm{True}]]$。输出中不需要物理单位。此问题不涉及角度。请在内部使用浮点运算表示任何小数。\n\n程序必须是自包含的，执行指定的模拟，并按描述实现计算。每个测试用例的唯一有效输出是布尔值和整数。单行输出必须以所述的精确格式汇总四个测试用例的结果。",
            "solution": "用户提供了一个问题，在着手解决之前需要对其前提进行验证。\n\n### 第 1 步：提取给定信息\n**系统状态向量：**\n$x(t) = [T_M(t), T_m(t), u(t), v(t)]^\\top$，其中 $T_M$ 是宏观尺度温度（$\\mathrm{K}$），$T_m$ 是微观尺度温度（$\\mathrm{K}$），$u$ 是机械位移（$\\mathrm{m}$），$v$ 是机械速度（$\\mathrm{m/s}$）。\n\n**系统动力学（常微分方程组）：**\n$$\n\\frac{d}{dt}T_M(t) = -\\frac{g_{\\mathrm{env}}}{C_M}\\left(T_M(t) - T_{\\mathrm{env}}\\right) + \\frac{k_c}{C_M}\\left(T_m(t) - T_M(t)\\right) + \\frac{Q_0 \\sin(2\\pi f_h t)}{C_M}\n$$\n$$\n\\frac{d}{dt}T_m(t) = \\frac{k_c}{C_m}\\left(T_M(t) - T_m(t)\\right) + \\frac{\\eta\\,c\\,v(t)^2}{C_m}\n$$\n$$\n\\frac{d}{dt}u(t) = v(t)\n$$\n$$\n\\frac{d}{dt}v(t) = \\frac{1}{m}\\left[-c\\,v(t) - k\\,u(t) + \\gamma\\left(T_M(t) - T_{\\mathrm{ref}}\\right) - \\delta\\left(T_m(t) - T_{\\mathrm{ref}}\\right) + F_0\\cos(2\\pi f_m t)\\right]\n$$\n\n**参数值：**\n- $m = 1.5\\,\\mathrm{kg}$\n- $c = 0.8\\,\\mathrm{N\\,s/m}$\n- $k = 50\\,\\mathrm{N/m}$\n- $C_M = 1000\\,\\mathrm{J/K}$\n- $C_m = 50\\,\\mathrm{J/K}$\n- $g_{\\mathrm{env}} = 8\\,\\mathrm{W/K}$\n- $k_c = 12\\,\\mathrm{W/K}$\n- $T_{\\mathrm{env}} = 300\\,\\mathrm{K}$\n- $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$\n- $Q_0 = 200\\,\\mathrm{W}$\n- $f_h = 0.1\\,\\mathrm{Hz}$\n- $F_0 = 5\\,\\mathrm{N}$\n- $f_m = 0.5\\,\\mathrm{Hz}$\n- $\\gamma = 2.0\\,\\mathrm{N/K}$\n- $\\delta = 1.2\\,\\mathrm{N/K}$\n- $\\eta = 0.7$ (无量纲)\n\n**初始条件和扰动：**\n- 标称初始条件：$x_0 = [300, 300, 0, 0]^\\top$\n- 扰动幅度：$\\varepsilon = [\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4]^\\top = [0.5\\,\\mathrm{K}, 0.5\\,\\mathrm{K}, 10^{-3}\\,\\mathrm{m}, 10^{-3}\\,\\mathrm{m/s}]^\\top$\n\n**任务：**\n为四个测试用例计算经验可观测性格拉姆矩阵（EOG），以评估可观测性。\n\n**数值方法：**\n- 从扰动初始条件 $x_0 \\pm \\varepsilon_i e_i$（$i \\in \\{1,2,3,4\\}$）开始模拟系统。\n- 在 $[0,T]$ 上使用包含 $N = 2000$ 个采样点的均匀时间网格。\n- 通过对称有限差分计算输出灵敏度。\n- 通过对灵敏度向量内积进行时间积分来构建格拉姆矩阵元素。\n- 通过奇异值分解（SVD）计算 EOG 的数值秩。\n- 评估可观测性：若秩等于状态维度（$4$）则为真，否则为假。\n\n**测试用例：**\n1.  $T = 30\\,\\mathrm{s}$，输出 $h_1(x) = [u, T_M]^\\top$，噪声 $\\sigma = 0$。\n2.  $T = 30\\,\\mathrm{s}$，输出 $h_2(x) = [u, v, T_M]^\\top$，噪声 $\\sigma = 0$。\n3.  $T = 30\\,\\mathrm{s}$，输出 $h_3(x) = [u, v, T_M, T_m]^\\top$，噪声 $\\sigma = 0$。\n4.  $T = 30\\,\\mathrm{s}$，输出 $h_4(x) = [u + 0.1\\,T_M, v, T_M - T_m]^\\top$，噪声 $\\sigma = 10^{-3}$。\n\n**输出格式：**\n一个列表的列表的单行字符串：`[[rank1,observable1],[rank2,observable2],...]`。\n\n### 第 2 步：使用提取的给定信息进行验证\n1.  **科学依据：**该问题描述了一个耦合的热力学系统。控制方程基于机械部分的牛顿第二定律和热部分的集总参数热平衡。这些是物理学和工程学中的标准和基本原理。参数具有实际物理意义的单位，对该方程组的量纲一致性检查证实了其有效性。项 $\\eta c v^2$ 正确表示了由粘性阻尼引起的功率耗散（热生成）。该模型在科学上是合理的。\n2.  **适定性：**该问题提供了一个具有指定初始条件的一阶常微分方程组。定义导数的函数是连续且表现良好的，这表明在有限时间范围内存在一个唯一的、稳定的解，可以使用标准数值求解器找到。计算经验可观测性格拉姆矩阵的任务是系统辨识和控制理论中一个明确定义的过程。\n3.  **客观性：**该问题使用精确的数学和工程术语陈述。所有参数、条件和任务都进行了定量定义。没有主观或基于意见的陈述。\n4.  **未检测到其他缺陷：**该问题并非不完整、矛盾、不切实际、不适定、微不足道或无法验证。它是信息物理系统和数字孪生领域一个标准的、尽管计算量较大的数值分析任务。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供完整的解决方案。\n\n### 解决方案\n\n该问题要求针对不同的传感器配置，评估一个非线性、耦合、四状态系统的可观测性。可观测性是系统的一种属性，它允许通过观察其外部输出来确定其内部状态。对于一个输出为 $y = h(x,t)$ 的非线性系统 $\\dot{x} = f(x,t)$，我们可以使用经验可观测性格拉姆矩阵（EOG），记为 $W_{EOG}$，来评估其局部可观测性。\n\n状态向量为 $x = [T_M, T_m, u, v]^\\top$。动力学由 $\\dot{x} = f(x,t)$ 给出，其中 $f(x,t)$ 是给定常微分方程组（ODEs）右侧的向量。\n\n$4 \\times 4$ EOG 矩阵的第 $(i,j)$ 个元素定义为：\n$$\n(W_{EOG})_{ij} = \\int_{0}^{T} \\left( \\frac{\\partial y(t)}{\\partial x_i(0)} \\right)^\\top \\left( \\frac{\\partial y(t)}{\\partial x_j(0)} \\right) dt\n$$\n其中 $y(t) = h(x(t))$ 是系统输出，$x_i(0)$ 是初始状态向量的第 $i$ 个分量，$T$ 是观测时域。灵敏度向量 $\\frac{\\partial y(t)}{\\partial x_i(0)}$ 量化了输出轨迹如何响应第 $i$ 个初始状态的无穷小变化。\n\n该问题指定使用对称有限差分格式对这些灵敏度进行数值近似。对于每个初始状态分量 $x_i(0)$，我们从两个扰动初始条件 $x_{0}^{+} = x_0 + \\varepsilon_i e_i$ 和 $x_{0}^{-} = x_0 - \\varepsilon_i e_i$ 开始模拟系统，其中 $x_0$ 是标称初始状态，$e_i$ 是第 $i$ 个标准基向量，$\\varepsilon_i$ 是扰动幅度。设得到的输出轨迹分别为 $y_i^+(t)$ 和 $y_i^-(t)$。然后，灵敏度向量 $S_i(t)$ 可近似为：\n$$\nS_i(t) \\approx \\frac{y_i^+(t) - y_i^-(t)}{2\\varepsilon_i}\n$$\n然后，通过对这些灵敏度向量的内积进行数值积分来计算 EOG 元素：\n$$\n(W_{EOG})_{ij} \\approx \\int_{0}^{T} S_i(t)^\\top S_j(t) dt\n$$\n该积分使用梯形法则在跨越区间 $[0, T]$ 的包含 $N=2000$ 个点的指定时间网格上进行数值计算。\n\n如果 EOG 是满秩的，即 $\\mathrm{rank}(W_{EOG}) = 4$（状态空间的维度），则该系统被认为是可观测的。一个满秩的格拉姆矩阵意味着任何初始状态分量的变化都会在输出空间中产生线性无关的响应，从而原则上允许从输出历史中唯一地重构初始状态。数值秩通过计算 $W_{EOG}$ 的奇异值分解（SVD）来确定。秩是明显大于零的奇异值的数量。一种常用且稳健的方法是计算满足 $\\sigma_k > \\tau$ 的奇异值 $\\sigma_k$ 的数量，其中 $\\tau$ 是一个容差阈值，通常相对于最大奇异值 $\\sigma_1$ 来设置。我们将使用 $\\tau = 10^{-12} \\sigma_1$ 的容差。\n\n对于四个测试用例中的每一个，我们将执行以下步骤：\n1.  定义模拟参数（$T, N$）、输出函数 $h(x)$ 和噪声水平 $\\sigma$。\n2.  对于每个状态变量 $i \\in \\{1,2,3,4\\}$：\n    a.  使用数值求解器（`scipy.integrate.solve_ivp`）对初始条件 $x_0 + \\varepsilon_i e_i$ 和 $x_0 - \\varepsilon_i e_i$ 进行两次常微分方程积分，以获得状态轨迹 $x_i^+(t)$ 和 $x_i^-(t)$。\n    b.  应用相应的输出函数 $h$ 得到输出轨迹 $y_i^+(t) = h(x_i^+(t))$ 和 $y_i^-(t) = h(x_i^-(t))$。\n    c.  对于测试用例 4，向 $y_i^+(t)$ 和 $y_i^-(t)$ 的每个通道添加标准差为 $\\sigma=10^{-3}$ 的独立零均值高斯噪声。将使用固定的随机种子以确保结果的确定性。\n    d.  计算并存储灵敏度向量 $S_i(t)$。\n3.  使用梯形法则（`numpy.trapz`）计算所有 $i,j \\in \\{1,2,3,4\\}$ 的 $(W_{EOG})_{ij}$，从而构建 $4 \\times 4$ 的 EOG 矩阵 $W_{EOG}$。\n4.  计算 $W_{EOG}$ 的 SVD 以找到其奇异值。\n5.  确定数值秩和相应的布尔可观测性状态。\n6.  收集所有四个用例的结果，并按指定格式进行格式化。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    # Define physical parameters\n    m = 1.5       # kg\n    c = 0.8       # Ns/m\n    k = 50.0      # N/m\n    C_M = 1000.0  # J/K\n    C_m = 50.0    # J/K\n    g_env = 8.0   # W/K\n    k_c = 12.0    # W/K\n    T_env = 300.0 # K\n    T_ref = 300.0 # K\n    Q_0 = 200.0   # W\n    f_h = 0.1     # Hz\n    F_0 = 5.0     # N\n    f_m = 0.5     # Hz\n    gamma = 2.0   # N/K\n    delta = 1.2   # N/K\n    eta = 0.7     # dimensionless\n\n    # Pack parameters for the ODE function\n    params = (m, c, k, C_M, C_m, g_env, k_c, T_env, T_ref,\n              Q_0, f_h, F_0, f_m, gamma, delta, eta)\n\n    # Define the system of ODEs\n    def ode_system(t, x, m, c, k, C_M, C_m, g_env, k_c, T_env, T_ref,\n                   Q_0, f_h, F_0, f_m, gamma, delta, eta):\n        T_M, T_m, u, v = x\n        \n        dT_M_dt = (-g_env / C_M * (T_M - T_env) +\n                   k_c / C_M * (T_m - T_M) +\n                   Q_0 * np.sin(2 * np.pi * f_h * t) / C_M)\n        \n        dT_m_dt = (k_c / C_m * (T_M - T_m) +\n                   eta * c * v**2 / C_m)\n        \n        du_dt = v\n        \n        dv_dt = (1 / m) * (-c * v - k * u +\n                           gamma * (T_M - T_ref) -\n                           delta * (T_m - T_ref) +\n                           F_0 * np.cos(2 * np.pi * f_m * t))\n        \n        return [dT_M_dt, dT_m_dt, du_dt, dv_dt]\n\n    # Nominal initial condition and perturbations\n    x0 = np.array([300.0, 300.0, 0.0, 0.0])\n    epsilons = np.array([0.5, 0.5, 1e-3, 1e-3])\n\n    # Sensor layout functions\n    def h1(x):  # x is shape (4, N)\n        u, T_M = x[2, :], x[0, :]\n        return np.vstack([u, T_M])\n\n    def h2(x):\n        u, v, T_M = x[2, :], x[3, :], x[0, :]\n        return np.vstack([u, v, T_M])\n\n    def h3(x):\n        return x  # All states are measured\n\n    def h4(x):\n        T_M, T_m, u, v = x[0, :], x[1, :], x[2, :], x[3, :]\n        y1 = u + 0.1 * T_M\n        y2 = v\n        y3 = T_M - T_m\n        return np.vstack([y1, y2, y3])\n    \n    # Define test cases\n    test_cases = [\n        {'T': 30.0, 'N': 2000, 'h': h1, 'sigma': 0.0},\n        {'T': 30.0, 'N': 2000, 'h': h2, 'sigma': 0.0},\n        {'T': 30.0, 'N': 2000, 'h': h3, 'sigma': 0.0},\n        {'T': 30.0, 'N': 2000, 'h': h4, 'sigma': 1e-3},\n    ]\n\n    results = []\n    # Use a fixed seed for reproducibility, especially for the case with noise\n    np.random.seed(0)\n\n    for case in test_cases:\n        T = case['T']\n        N = case['N']\n        h_func = case['h']\n        sigma = case['sigma']\n        \n        t_span = [0, T]\n        t_eval = np.linspace(0, T, N)\n        num_states = 4\n        \n        sensitivities = []\n        \n        for i in range(num_states):\n            pert = np.zeros(num_states)\n            pert[i] = epsilons[i]\n            x0_plus = x0 + pert\n            x0_minus = x0 - pert\n\n            # Simulate for positive perturbation\n            sol_plus = solve_ivp(ode_system, t_span, x0_plus, args=params, \n                                 t_eval=t_eval, method='RK45', rtol=1e-6, atol=1e-9)\n            y_plus = h_func(sol_plus.y)\n            \n            # Simulate for negative perturbation\n            sol_minus = solve_ivp(ode_system, t_span, x0_minus, args=params, \n                                  t_eval=t_eval, method='RK45', rtol=1e-6, atol=1e-9)\n            y_minus = h_func(sol_minus.y)\n\n            # Add noise if applicable\n            if sigma > 0:\n                noise_plus = np.random.normal(0, sigma, size=y_plus.shape)\n                noise_minus = np.random.normal(0, sigma, size=y_minus.shape)\n                y_plus += noise_plus\n                y_minus += noise_minus\n\n            # Compute sensitivity\n            S_i = (y_plus - y_minus) / (2 * epsilons[i])\n            sensitivities.append(S_i)\n        \n        # Compute the Empirical Observability Gramian W_eog\n        W_eog = np.zeros((num_states, num_states))\n        for i in range(num_states):\n            for j in range(i, num_states):\n                # Integrand is the dot product of sensitivity vectors S_i and S_j\n                integrand = np.sum(sensitivities[i] * sensitivities[j], axis=0)\n                integral = np.trapz(integrand, t_eval)\n                W_eog[i, j] = integral\n                if i != j:\n                    W_eog[j, i] = integral\n        \n        # Compute numerical rank via SVD\n        singular_values = np.linalg.svd(W_eog, compute_uv=False)\n        # Justifiable tolerance: relative to the largest singular value\n        # A value of 1e-12 is a common choice for assessing rank with double precision.\n        tolerance = singular_values[0] * 1e-12 if singular_values[0] > 0 else 1e-12\n        rank = np.sum(singular_values > tolerance)\n        \n        observable = (rank == num_states)\n        results.append([rank, observable])\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join(f\"[{r},{str(o)}]\" for r, o in results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}