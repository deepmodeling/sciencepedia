{
    "hands_on_practices": [
        {
            "introduction": "评估算法公平性的最直接方法之一是检查其在历史数据上的表现。混淆矩阵是总结分类器性能的基本工具，它为我们提供了真阳性、假阳性、真阴性和假阴性的具体计数。本练习将指导您如何从这些原始计数出发，计算不同群体的真阳性率（TPR）和假阳性率（FPR），并最终量化一个关键的公平性标准——“均等化赔率”（Equalized Odds）。",
            "id": "4205289",
            "problem": "一个信息物理系统（CPS）中的自主紧急干预模块被部署在一支车队中，并在一个高保真数字孪生环境中进行镜像。该模块是一个二元分类器，用于预测即将发生的高风险事件，其中阳性预测会触发预备性制动操作。为了进行部署后的算法偏见审计，开发团队使用与基准真相结果对齐的回放数字孪生日志，在两个由 $g \\in \\{0,1\\}$ 索引的不相交人口群体上评估该分类器。对于每个群体 $g$，混淆矩阵的条目被记录为真阳性 $\\text{TP}_g$、假阳性 $\\text{FP}_g$、假阴性 $\\text{FN}_g$ 和真阴性 $\\text{TN}_g$。观测到的计数如下：\n- 群体 $g=0$：$\\text{TP}_0=80$，$\\text{FP}_0=20$，$\\text{FN}_0=40$，$\\text{TN}_0=60$。\n- 群体 $g=1$：$\\text{TP}_1=50$，$\\text{FP}_1=10$，$\\text{FN}_1=50$，$\\text{TN}_1=90$。\n\n从二元分类器的真阳性率和假阳性率的基本概率定义出发，即 $\\text{TPR}_g = \\mathbb{P}(\\hat{Y}=1 \\mid Y=1, G=g)$ 和 $\\text{FPR}_g = \\mathbb{P}(\\hat{Y}=1 \\mid Y=0, G=g)$，并使用从混淆矩阵中得到的其经验估计量的标准识别方法，计算每个群体 $g \\in \\{0,1\\}$ 的 $\\text{TPR}_g$ 和 $\\text{FPR}_g$。然后，评估均等化赔率标准的违反情况，此处定义为单数值差距\n$$\nd_{\\text{EO}} \\;=\\; \\max\\!\\big(|\\text{TPR}_0-\\text{TPR}_1|,\\;|\\text{FPR}_0-\\text{FPR}_1|\\big).\n$$\n仅以小数形式报告 $d_{\\text{EO}}$ 的值。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求评估一个二元分类器在两个人口群体 $g \\in \\{0, 1\\}$ 上表现的均等化赔率公平性标准的违反情况，记为 $d_{\\text{EO}}$。解决过程首先计算每个群体的经验真阳性率（$\\text{TPR}_g$）和经验假阳性率（$\\text{FPR}_g$），然后计算这些率在群体间的最大绝对差。\n\n特定群体 $g$ 的真阳性率和假阳性率的基本概率定义如下：\n$$\n\\text{TPR}_g = \\mathbb{P}(\\hat{Y}=1 \\mid Y=1, G=g)\n$$\n$$\n\\text{FPR}_g = \\mathbb{P}(\\hat{Y}=1 \\mid Y=0, G=g)\n$$\n其中 $\\hat{Y}$ 是预测标签，$Y$ 是真实标签，$G$ 是群体标识符。\n\n这些概率的标准经验估计量是根据混淆矩阵的条目计算的：真阳性（$\\text{TP}_g$）、假阳性（$\\text{FP}_g$）、假阴性（$\\text{FN}_g$）和真阴性（$\\text{TN}_g$）。群体 $g$ 的实际阳性实例总数为 $P_g = \\text{TP}_g + \\text{FN}_g$。实际阴性实例总数为 $N_g = \\text{FP}_g + \\text{TN}_g$。\n\n因此，经验估计量为：\n$$\n\\text{TPR}_g = \\frac{\\text{TP}_g}{\\text{TP}_g + \\text{FN}_g}\n$$\n$$\n\\text{FPR}_g = \\frac{\\text{FP}_g}{\\text{FP}_g + \\text{TN}_g}\n$$\n\n我们已知两个群体的混淆矩阵计数。\n\n对于群体 $g=0$：\n$\\text{TP}_0=80$，$\\text{FP}_0=20$，$\\text{FN}_0=40$，$\\text{TN}_0=60$。\n\n首先，我们计算群体 $g=0$ 的实际阳性数和阴性数：\n实际阳性总数为 $P_0 = \\text{TP}_0 + \\text{FN}_0 = 80 + 40 = 120$。\n实际阴性总数为 $N_0 = \\text{FP}_0 + \\text{TN}_0 = 20 + 60 = 80$。\n\n现在，我们计算 $\\text{TPR}_0$ 和 $\\text{FPR}_0$：\n$$\n\\text{TPR}_0 = \\frac{\\text{TP}_0}{P_0} = \\frac{80}{120} = \\frac{2}{3}\n$$\n$$\n\\text{FPR}_0 = \\frac{\\text{FP}_0}{N_0} = \\frac{20}{80} = \\frac{1}{4} = 0.25\n$$\n\n对于群体 $g=1$：\n$\\text{TP}_1=50$，$\\text{FP}_1=10$，$\\text{FN}_1=50$，$\\text{TN}_1=90$。\n\n同样地，我们计算群体 $g=1$ 的实际阳性数和阴性数：\n实际阳性总数为 $P_1 = \\text{TP}_1 + \\text{FN}_1 = 50 + 50 = 100$。\n实际阴性总数为 $N_1 = \\text{FP}_1 + \\text{TN}_1 = 10 + 90 = 100$。\n\n现在，我们计算 $\\text{TPR}_1$ 和 $\\text{FPR}_1$：\n$$\n\\text{TPR}_1 = \\frac{\\text{TP}_1}{P_1} = \\frac{50}{100} = \\frac{1}{2} = 0.5\n$$\n$$\n\\text{FPR}_1 = \\frac{\\text{FP}_1}{N_1} = \\frac{10}{100} = \\frac{1}{10} = 0.1\n$$\n\n下一步是评估均等化赔率标准的违反情况，定义为 $d_{\\text{EO}} = \\max\\!\\big(|\\text{TPR}_0-\\text{TPR}_1|,\\;|\\text{FPR}_0-\\text{FPR}_1|\\big)$。\n\n我们计算绝对差：\n$$\n|\\text{TPR}_0-\\text{TPR}_1| = \\left|\\frac{2}{3} - \\frac{1}{2}\\right| = \\left|\\frac{4}{6} - \\frac{3}{6}\\right| = \\frac{1}{6}\n$$\n$$\n|\\text{FPR}_0-\\text{FPR}_1| = \\left|\\frac{1}{4} - \\frac{1}{10}\\right| = \\left|0.25 - 0.1\\right| = 0.15 = \\frac{15}{100} = \\frac{3}{20}\n$$\n\n为了找到最大值，我们比较这两个值。将它们表示为小数会很有帮助：\n$|\\text{TPR}_0-\\text{TPR}_1| = \\frac{1}{6} \\approx 0.1666...$\n$|\\text{FPR}_0-\\text{FPR}_1| = 0.15$\n\n比较这些值，我们发现 $\\frac{1}{6}$ 大于 $0.15$。\n因此，\n$$\nd_{\\text{EO}} = \\max\\left(\\frac{1}{6}, \\frac{3}{20}\\right) = \\frac{1}{6}\n$$\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$\nd_{\\text{EO}} = \\frac{1}{6} \\approx 0.166666...\n$$\n四舍五入到四位有效数字得到 $0.1667$。",
            "answer": "$$\n\\boxed{0.1667}\n$$"
        },
        {
            "introduction": "分类器通常输出连续的风险评分，而不仅仅是最终的二元决策。这使得我们可以在确定最终决策阈值之前，进行更细致的公平性分析。本练习设定了一个假设场景，其中两个群体的得分服从不同的正态分布，要求您计算特定阈值下的群体接受率，并评估“人口统计均等”（Demographic Parity）这一核心公平性指标。通过这种方式，您可以理解分类器内部评分机制如何导致不同群体间的结果差异。",
            "id": "4205262",
            "problem": "一个信息物理系统 (CPS) 中的自主资源分配控制器由一个数字孪生 (DT) 监控其公平性。该控制器使用一个连续风险评分 $S$，并在 $S \\geq t$ 时授予访问权限。设 $A \\in \\{0,1\\}$ 表示一个由 DT 观察到的二元敏感属性。DT 估计出条件评分分布为等方差的正态分布：$S \\mid A=0 \\sim \\mathcal{N}\\!\\left(0.6,\\,0.1^{2}\\right)$ 和 $S \\mid A=1 \\sim \\mathcal{N}\\!\\left(0.5,\\,0.1^{2}\\right)$。阈值为 $t = 0.55$。\n\n使用基本定义，计算每个群体高于阈值的尾部概率作为其接受率，并基于这些率推导出人口统计均等差距，其定义为\n$$\\Delta \\equiv \\mathbb{P}\\!\\left(S \\geq t \\mid A=0\\right) - \\mathbb{P}\\!\\left(S \\geq t \\mid A=1\\right).$$\n假设审计标准为人口统计均等的绝对差距版本，容差为 $\\varepsilon = 0.05$，即如果 $|\\Delta| > \\varepsilon$，则视为违规。\n\n报告人口统计均等差距 $\\Delta$ 的值，以小数形式表示，并四舍五入到四位有效数字。无需单位。",
            "solution": "数字孪生（DT）在控制器的决策规则 $S \\geq t$ 下监控接受率。对于每个群体 $A=a$，接受率从根本上定义为评分超过阈值的概率：\n$$\np_{a} \\equiv \\mathbb{P}\\!\\left(S \\geq t \\mid A=a\\right).\n$$\n已知 $S \\mid A=a \\sim \\mathcal{N}\\!\\left(\\mu_{a},\\,\\sigma^{2}\\right)$，其中 $\\mu_{0} = 0.6$，$\\mu_{1} = 0.5$，且 $\\sigma = 0.1$，我们使用\n$$\nZ \\equiv \\frac{S - \\mu_{a}}{\\sigma},\n$$\n将其标准化为标准正态变量 $Z \\sim \\mathcal{N}(0,1)$，接受概率变为一个标准正态尾部概率：\n$$\np_{a} = \\mathbb{P}\\!\\left(S \\geq t \\mid A=a\\right) = \\mathbb{P}\\!\\left(Z \\geq \\frac{t - \\mu_{a}}{\\sigma}\\right) = 1 - \\Phi\\!\\left(\\frac{t - \\mu_{a}}{\\sigma}\\right),\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n\n计算每个群体的标准化阈值：\n- 对于 $A=0$：\n$$\nz_{0} = \\frac{t - \\mu_{0}}{\\sigma} = \\frac{0.55 - 0.6}{0.1} = -0.5.\n$$\n因此，\n$$\np_{0} = 1 - \\Phi(-0.5).\n$$\n使用标准正态分布的对称性 $\\Phi(-z) = 1 - \\Phi(z)$，我们得到\n$$\np_{0} = 1 - \\left(1 - \\Phi(0.5)\\right) = \\Phi(0.5).\n$$\n\n- 对于 $A=1$：\n$$\nz_{1} = \\frac{t - \\mu_{1}}{\\sigma} = \\frac{0.55 - 0.5}{0.1} = 0.5,\n$$\n所以\n$$\np_{1} = 1 - \\Phi(0.5).\n$$\n\n因此，人口统计均等差距为\n$$\n\\Delta = p_{0} - p_{1} = \\Phi(0.5) - \\left(1 - \\Phi(0.5)\\right) = 2\\,\\Phi(0.5) - 1.\n$$\n\n为了得出数值，我们使用标准正态累积分布函数在 $0.5$ 处经过充分检验的值：\n$$\n\\Phi(0.5) \\approx 0.691462461274013.\n$$\n因此，\n$$\np_{0} \\approx 0.691462461274013,\\quad p_{1} \\approx 1 - 0.691462461274013 = 0.308537538725987,\n$$\n且\n$$\n\\Delta \\approx 0.691462461274013 - 0.308537538725987 = 0.382924922548026.\n$$\n\n相对于审计容差 $\\varepsilon = 0.05$ 的评估使用绝对差距标准：\n$$\n|\\Delta| \\approx 0.382924922548026 > 0.05,\n$$\n因此，根据所述标准，这构成了人口统计均等违规。\n\n根据指令，我们将人口统计均等差距四舍五入到四位有效数字进行报告：\n$$\n\\Delta \\approx 0.3829.\n$$",
            "answer": "$$\\boxed{0.3829}$$"
        },
        {
            "introduction": "现实世界的自主系统运行在复杂多变的环境中，并影响着具有多重交叉身份的群体。这个综合性实践将引导您构建一个数字孪生仿真场景，以模拟公平性指标在不同环境条件下的表现。您将探索对于交叉性群体（例如，由年龄、性别和种族共同定义的子群体），均等化赔率和人口统计均等指标如何随着环境变化而波动，这反映了在现代信息物理系统中进行公平性审计的真实挑战。",
            "id": "4205313",
            "problem": "考虑一个用于信息物理系统 (CPS) 中自主感知模块的数字孪生 (DT) 仿真。该模块必须根据带有噪声的传感器测量值来判断是否存在真实事件。真实事件指示符表示为 $y \\in \\{0,1\\}$，预测决策表示为 $\\hat{y} \\in \\{0,1\\}$。传感器产生一个标量测量值 $x \\in \\mathbb{R}$，该值在水平 $\\tau$ 处进行阈值处理，当且仅当 $x \\ge \\tau$ 时，$\\hat{y} = 1$。环境由一个无量纲的能见度指数 $c \\ge 0$ 来概括。\n\n交叉性受保护属性通过年龄 $A \\in \\{\\text{Y},\\text{S}\\}$、性别 $G \\in \\{\\text{F},\\text{M}\\}$ 和种族 $R \\in \\{\\text{R0},\\text{R1}\\}$ 的笛卡尔积来建模。每个交叉子群 $g = (A,G,R)$ 通过依赖于群组的参数影响信号和背景。DT 将条件测量分布指定为高斯分布：\n$$\nx \\mid (y=1, g, c) \\sim \\mathcal{N}\\!\\big(\\mu_g(c), \\sigma^2(c)\\big), \\quad\nx \\mid (y=0, g, c) \\sim \\mathcal{N}\\!\\big(\\nu_g(c), \\sigma^2(c)\\big),\n$$\n其中噪声标准差 $\\sigma(c) = \\frac{\\sigma_0}{c+\\epsilon}$ 依赖于能见度，$\\sigma_0 > 0$ 和 $\\epsilon > 0$ 为正常数，均值依赖于群组\n$$\n\\mu_g(c) = r_g \\, c, \\quad \\nu_g(c) = b_g \\, c,\n$$\n其中 $r_g$ 和 $b_g$ 是特定群组的响应系数。子群 $g$ 中真实事件的发生率为 $p_g = \\mathbb{P}(y=1 \\mid g)$。\n\n根据概率论和高斯累积分布函数 (CDF) $\\Phi(\\cdot)$，子群 $g$ 在能见度为 $c$ 时的真阳性率 (TPR) 和假阳性率 (FPR) 分别为\n$$\n\\mathrm{TPR}_g(c) = \\mathbb{P}(\\hat{y}=1 \\mid y=1,g,c) = 1 - \\Phi\\!\\left(\\frac{\\tau - \\mu_g(c)}{\\sigma(c)}\\right),\n$$\n$$\n\\mathrm{FPR}_g(c) = \\mathbb{P}(\\hat{y}=1 \\mid y=0,g,c) = 1 - \\Phi\\!\\left(\\frac{\\tau - \\nu_g(c)}{\\sigma(c)}\\right).\n$$\n子群 $g$ 的选择率为\n$$\ns_g(c) = \\mathbb{P}(\\hat{y}=1 \\mid g,c) = p_g \\,\\mathrm{TPR}_g(c) + (1-p_g)\\,\\mathrm{FPR}_g(c).\n$$\n\n跨交叉子群的公平性通过以下两个指标进行评估：\n1. 在能见度为 $c$ 时的均等化赔率 (EO) 违规度，定义为子群 TPR 和 FPR 范围的最大值：\n$$\n\\mathrm{EO}(c) = \\max\\!\\left\\{ \\big(\\max_g \\mathrm{TPR}_g(c) - \\min_g \\mathrm{TPR}_g(c)\\big), \\big(\\max_g \\mathrm{FPR}_g(c) - \\min_g \\mathrm{FPR}_g(c)\\big) \\right\\}.\n$$\n2. 在能见度为 $c$ 时的人口统计均等 (DP) 违规度，定义为子群选择率的范围：\n$$\n\\mathrm{DP}(c) = \\max_g s_g(c) - \\min_g s_g(c).\n$$\n\n您的任务是实现一个程序，该程序针对指定的能见度条件测试集和数字孪生参数，计算所有交叉子群的 $\\mathrm{EO}(c)$ 和 $\\mathrm{DP}(c)$。将每个指标作为浮点数返回，并四舍五入到六位小数。\n\n使用以下 DT 参数化：\n- 阈值：$\\tau = 1.0$。\n- 噪声参数：$\\sigma_0 = 0.5$，$\\epsilon = 0.1$。\n- 群组响应系数 $r_g$ 和 $b_g$ 在各属性上是可加的：\n  - 基础响应：$r_{\\text{base}} = 1.2$, $b_{\\text{base}} = 0.05$。\n  - 年龄贡献：$r_{\\text{Y}} = 0.00$, $r_{\\text{S}} = -0.10$; $b_{\\text{Y}} = 0.01$, $b_{\\text{S}} = 0.02$。\n  - 性别贡献：$r_{\\text{F}} = 0.00$, $r_{\\text{M}} = 0.00$; $b_{\\text{F}} = -0.005$, $b_{\\text{M}} = 0.00$。\n  - 种族贡献：$r_{\\text{R0}} = 0.00$, $r_{\\text{R1}} = -0.15$; $b_{\\text{R0}} = 0.00$, $b_{\\text{R1}} = 0.02$。\n  因此 $r_g = r_{\\text{base}} + r_A + r_G + r_R$ 且 $b_g = b_{\\text{base}} + b_A + b_G + b_R$。\n- 事件发生率是可加的，然后裁剪到 $[0,1]$ 范围内：\n  - 基础发生率：$p_{\\text{base}} = 0.20$。\n  - 年龄贡献：$p_{\\text{Y}} = -0.02$, $p_{\\text{S}} = +0.05$。\n  - 性别贡献：$p_{\\text{F}} = 0.00$, $p_{\\text{M}} = 0.00$。\n  - 种族贡献：$p_{\\text{R0}} = 0.00$, $p_{\\text{R1}} = 0.00$。\n  因此 $p_g = \\min\\{1,\\max\\{0, p_{\\text{base}} + p_A + p_G + p_R\\}\\}$。\n\n能见度指数测试集：\n- 能见度差：$c = 0.00$。\n- 有雾：$c = 0.20$。\n- 阴天：$c = 0.50$。\n- 晴朗：$c = 0.90$。\n- 能见度极佳：$c = 1.30$。\n\n您的程序应生成一行输出，其中包含一个方括号内的逗号分隔列表。该列表应按以下顺序包含：对于测试集中的每个能见度 $c$，先是均等化赔率违规度值 $\\mathrm{EO}(c)$，然后是人口统计均等违规度值 $\\mathrm{DP}(c)$，每个值都四舍五入到六位小数。例如，输出格式必须为 $[\\mathrm{EO}(c_1),\\mathrm{DP}(c_1),\\mathrm{EO}(c_2),\\mathrm{DP}(c_2),\\ldots,\\mathrm{EO}(c_5),\\mathrm{DP}(c_5)]$。",
            "solution": "该问题为评估自主感知模块中的算法偏见提供了一个完整且数学上一致的模型。验证过程确认了该问题是适定的、有科学依据的，并包含了获得唯一解所需的所有数据。因此，我们可以继续进行推导和计算。\n\n目标是为一组能见度条件计算均等化赔率 (EO) 和人口统计均等 (DP) 违规度指标。任务的核心是计算八个不同交叉子群的性能率，然后衡量这些子群之间的差异。\n\n首先，我们必须为每个交叉子群 $g=(A,G,R)$ 建立参数，其中属性为年龄 $A \\in \\{\\text{Y},\\text{S}\\}$、性别 $G \\in \\{\\text{F},\\text{M}\\}$ 和种族 $R \\in \\{\\text{R0},\\text{R1}\\}$。依赖于群组的响应系数 $r_g$ 和 $b_g$ 以及事件发生率 $p_g$ 由可加模型定义。\n\n响应系数 $r_g$ 由 $r_g = r_{\\text{base}} + r_A + r_G + r_R$ 给出。使用所提供的值：$r_{\\text{base}} = 1.2$, $r_{\\text{Y}} = 0.0$, $r_{\\text{S}} = -0.1$, $r_{\\text{F}} = 0.0$, $r_{\\text{M}} = 0.0$, $r_{\\text{R0}} = 0.0$, 和 $r_{\\text{R1}} = -0.15$。\n\n响应系数 $b_g$ 由 $b_g = b_{\\text{base}} + b_A + b_G + b_R$ 给出。使用所提供的值：$b_{\\text{base}} = 0.05$, $b_{\\text{Y}} = 0.01$, $b_{\\text{S}} = 0.02$, $b_{\\text{F}} = -0.005$, $b_{\\text{M}} = 0.0$, $b_{\\text{R0}} = 0.0$, 和 $b_{\\text{R1}} = 0.02$。\n\n事件发生率 $p_g$ 由 $p_g = \\min\\{1,\\max\\{0, p_{\\text{base}} + p_A + p_G + p_R\\}\\}$ 给出。使用所提供的值：$p_{\\text{base}} = 0.20$, $p_{\\text{Y}} = -0.02$, $p_{\\text{S}} = 0.05$，性别和种族的贡献为零。\n\n系统地为所有 $2 \\times 2 \\times 2 = 8$ 个子群计算这些值，得到以下参数表：\n| 子群 $g$  属性 (A,G,R) | $r_g$ | $b_g$  | $p_g$  |\n| :------------ | :----------------- | :----: | :----: | :----: |\n| $g_1$         | (Y, F, R0)         | $1.20$ | $0.055$ | $0.18$ |\n| $g_2$         | (Y, F, R1)         | $1.05$ | $0.075$ | $0.18$ |\n| $g_3$         | (Y, M, R0)         | $1.20$ | $0.060$ | $0.18$ |\n| $g_4$         | (Y, M, R1)         | $1.05$ | $0.080$ | $0.18$ |\n| $g_5$         | (S, F, R0)         | $1.10$ | $0.065$ | $0.25$ |\n| $g_6$         | (S, F, R1)         | $0.95$ | $0.085$ | $0.25$ |\n| $g_7$         | (S, M, R0)         | $1.10$ | $0.070$ | $0.25$ |\n| $g_8$         | (S, M, R1)         | $0.95$ | $0.090$ | $0.25$ |\n\n在这些特定群组的参数确定后，我们现在可以为测试集 $\\{0.00, 0.20, 0.50, 0.90, 1.30\\}$ 中的每个能见度指数 $c$ 评估公平性指标。对于每个 $c$，执行以下计算序列。\n\n依赖于能见度的噪声标准差为 $\\sigma(c) = \\frac{\\sigma_0}{c+\\epsilon} = \\frac{0.5}{c+0.1}$。\n信号 ($y=1$) 和背景 ($y=0$) 的依赖于群组和能见度的均值分别为 $\\mu_g(c) = r_g \\cdot c$ 和 $\\nu_g(c) = b_g \\cdot c$。\n\n子群 $g$ 的真阳性率 (TPR) 和假阳性率 (FPR) 由传感器测量值 $x$ 超过阈值 $\\tau=1.0$ 的概率决定。在给定高斯条件分布的情况下，这些值使用标准正态累积分布函数 (CDF) $\\Phi(\\cdot)$ 来计算。\n$\\mathrm{TPR}_g(c) = \\mathbb{P}(x \\ge \\tau \\mid y=1,g,c) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_g(c)}{\\sigma(c)}\\right)$。\n$\\mathrm{FPR}_g(c) = \\mathbb{P}(x \\ge \\tau \\mid y=0,g,c) = 1 - \\Phi\\left(\\frac{\\tau - \\nu_g(c)}{\\sigma(c)}\\right)$。\n一个有用的恒等式是 $1 - \\Phi(z) = \\Phi(-z)$。因此，我们可以写作：\n$\\mathrm{TPR}_g(c) = \\Phi\\left(\\frac{\\mu_g(c) - \\tau}{\\sigma(c)}\\right)$\n$\\mathrm{FPR}_g(c) = \\Phi\\left(\\frac{\\nu_g(c) - \\tau}{\\sigma(c)}\\right)$\n\n子群 $g$ 的选择率 $s_g(c)$ 是其 TPR 和 FPR 的加权平均，权重由事件发生率 $p_g$ 给出：\n$s_g(c) = p_g \\cdot \\mathrm{TPR}_g(c) + (1-p_g) \\cdot \\mathrm{FPR}_g(c)$。\n\n在为所有八个子群计算出 $\\mathrm{TPR}_g(c)$、$\\mathrm{FPR}_g(c)$ 和 $s_g(c)$ 后，计算公平性违规度指标。\n均等化赔率违规度 $\\mathrm{EO}(c)$ 是子群 TPR 和 FPR 范围的最大值：\n$\\mathrm{EO}(c) = \\max\\left\\{ \\left(\\max_g \\mathrm{TPR}_g(c) - \\min_g \\mathrm{TPR}_g(c)\\right), \\left(\\max_g \\mathrm{FPR}_g(c) - \\min_g \\mathrm{FPR}_g(c)\\right) \\right\\}$。\n人口统计均等违规度 $\\mathrm{DP}(c)$ 是子群选择率的范围：\n$\\mathrm{DP}(c) = \\max_g s_g(c) - \\min_g s_g(c)$。\n\n在 $c=0.0$ 时出现一个特殊情况。此时，对于所有群组 $g$，$\\mu_g(0) = 0$ 且 $\\nu_g(0) = 0$。标准差为 $\\sigma(0) = 0.5/0.1 = 5.0$。因此，$\\mathrm{TPR}_g(0) = \\Phi(-1.0/5.0)$ 和 $\\mathrm{FPR}_g(0) = \\Phi(-1.0/5.0)$ 对于所有子群都是相同的。这直接意味着它们的范围为零，所以 $\\mathrm{EO}(0)=0$。此外，由于 $s_g(0) = p_g \\mathrm{TPR}_g(0) + (1-p_g) \\mathrm{FPR}_g(0)$ 且 $\\mathrm{TPR}_g(0) = \\mathrm{FPR}_g(0)$，选择率简化为 $s_g(0) = \\mathrm{TPR}_g(0)$，这个值在所有群组中也是恒定的。因此，$\\mathrm{DP}(0)=0$ 也为0。\n\n对于所有其他 $c > 0$ 的值，依赖于群组的参数 $r_g$ 和 $b_g$ 会导致 $\\mu_g(c)$ 和 $\\nu_g(c)$ 的值不同，从而产生非零的公平性违规度。算法通过遍历每个 $c$ 值，计算所有八个子群的率，然后确定最大-最小差异以找到所需的指标。最终的数值结果按要求四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes Equalized Odds (EO) and Demographic Parity (DP) violation\n    metrics for a Digital Twin simulation of an autonomous perception module.\n    \"\"\"\n\n    # --- Problem Givens ---\n    tau = 1.0\n    sigma_0 = 0.5\n    epsilon = 0.1\n\n    # Group attribute definitions\n    attributes = {\n        'A': ['Y', 'S'],\n        'G': ['F', 'M'],\n        'R': ['R0', 'R1']\n    }\n\n    # Additive contributions for parameters\n    r_contrib = {'base': 1.2, 'Y': 0.00, 'S': -0.10, 'F': 0.00, 'M': 0.00, 'R0': 0.00, 'R1': -0.15}\n    b_contrib = {'base': 0.05, 'Y': 0.01, 'S': 0.02, 'F': -0.005, 'M': 0.00, 'R0': 0.00, 'R1': 0.02}\n    p_contrib = {'base': 0.20, 'Y': -0.02, 'S': 0.05, 'F': 0.00, 'M': 0.00, 'R0': 0.00, 'R1': 0.00}\n    \n    # Test suite of visibility indices\n    test_cases = [0.00, 0.20, 0.50, 0.90, 1.30]\n\n    # --- Subgroup Parameter Calculation ---\n    subgroups = []\n    for age in attributes['A']:\n        for gender in attributes['G']:\n            for race in attributes['R']:\n                subgroups.append((age, gender, race))\n\n    group_params = []\n    for group in subgroups:\n        age, gender, race = group\n        # Calculate r_g\n        r_g = r_contrib['base'] + r_contrib[age] + r_contrib[gender] + r_contrib[race]\n        # Calculate b_g\n        b_g = b_contrib['base'] + b_contrib[age] + b_contrib[gender] + b_contrib[race]\n        # Calculate p_g with clipping\n        p_raw = p_contrib['base'] + p_contrib[age] + p_contrib[gender] + p_contrib[race]\n        p_g = min(1.0, max(0.0, p_raw))\n        \n        group_params.append({'r': r_g, 'b': b_g, 'p': p_g})\n\n    # --- Main Calculation Loop ---\n    results = []\n    for c in test_cases:\n        tpr_g_list = []\n        fpr_g_list = []\n        s_g_list = []\n\n        sigma_c = sigma_0 / (c + epsilon)\n\n        for params in group_params:\n            r_g, b_g, p_g = params['r'], params['b'], params['p']\n\n            mu_g = r_g * c\n            nu_g = b_g * c\n\n            # TPR = P(x >= tau | y=1) = 1 - Phi((tau - mu)/sigma) = Phi((mu - tau)/sigma)\n            tpr = norm.cdf((mu_g - tau) / sigma_c)\n            tpr_g_list.append(tpr)\n\n            # FPR = P(x >= tau | y=0) = 1 - Phi((tau - nu)/sigma) = Phi((nu - tau)/sigma)\n            fpr = norm.cdf((nu_g - tau) / sigma_c)\n            fpr_g_list.append(fpr)\n\n            # Selection Rate s_g = p_g*TPR + (1-p_g)*FPR\n            s_g = p_g * tpr + (1.0 - p_g) * fpr\n            s_g_list.append(s_g)\n\n        # Calculate EO violation\n        tpr_range = max(tpr_g_list) - min(tpr_g_list)\n        fpr_range = max(fpr_g_list) - min(fpr_g_list)\n        eo_violation = max(tpr_range, fpr_range)\n\n        # Calculate DP violation\n        dp_violation = max(s_g_list) - min(s_g_list)\n\n        results.extend([round(eo_violation, 6), round(dp_violation, 6)])\n\n    # Format the output string as required\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}