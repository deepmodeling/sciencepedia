{
    "hands_on_practices": [
        {
            "introduction": "To master cyber-physical systems, one must first understand how to model and simulate their behavior under critical conditions. This practice provides a foundational experience in simulating a power grid's response to a significant disturbanceâ€”the sudden transition to an islanded mode of operation. By developing and solving the differential equations that govern the system's frequency dynamics, you will gain direct insight into the interplay between continuous physical laws and discrete operational events, and you will observe the crucial stabilizing role of primary droop control in real-time.",
            "id": "4211450",
            "problem": "Consider an aggregated area of a large-scale smart grid modeled as a hybrid cyber-physical system with two discrete modes: nominal operation (grid-connected) and islanded mode (after a line trip event). The system transitions from nominal to islanded mode at time $t = 1\\ \\text{s}$ due to an instantaneous loss of an intertie. The objective is to compute the post-event frequency trajectory under primary frequency droop control, using a principled continuous-time model based on foundational power system dynamics.\n\nStart from the swing equation for an equivalent generator representing the area. Use per-unit normalization on the area power base and incorporate frequency-dependent load damping. Let $H$ denote the inertia constant in seconds, $f_0$ the nominal frequency in hertz, and let $\\Delta f(t)$ be the frequency deviation in hertz. Let $\\Delta P_m(t)$ be the mechanical power deviation from pre-event equilibrium in per unit, and let $\\Delta P_e(t)$ be the electrical power deviation in per unit due to the disturbance and load-frequency effects. Assume load-frequency sensitivity is modeled by a linear damping coefficient $D$ (per unit power per per-unit frequency deviation). Assume primary control is realized by a first-order governor with droop coefficient $R$ (per-unit frequency per per-unit power) and a time constant $T_g$ (in seconds). Assume the aggregate electrical disturbance is a step increase in electrical power demand equal to the lost import $P_{\\text{step}}$ (in per unit) applied at $t = 1\\ \\text{s}$, i.e., $\\Delta P_e(t)$ includes a step of magnitude $P_{\\text{step}}$ at $t = 1\\ \\text{s}$ representing islanding.\n\nYou must derive, implement, and simulate the continuous dynamics that follow from:\n- The swing equation and power balance conservation, and\n- The governor droop law with a first-order actuator model.\n\nLet the hybrid switch be defined as follows:\n- For $0 \\le t < 1\\ \\text{s}$ (nominal operation mode), $\\Delta P_e(t) = 0$ and the system is at equilibrium with $\\Delta f(0) = 0$ and $\\Delta P_m(0) = 0$.\n- For $t \\ge 1\\ \\text{s}$ (islanded mode), $\\Delta P_e(t) = P_{\\text{step}}$, i.e., an increase in effective electrical power demand equal to the lost import.\n\nUsing only these foundational principles and definitions, formulate the minimal closed set of ordinary differential equations in continuous time for the states $\\Delta f(t)$ (in hertz) and $\\Delta P_m(t)$ (in per unit), valid for all $t \\ge 0$ with the hybrid forcing $\\Delta P_e(t)$ defined above. Numerically integrate the resulting system over a finite horizon $[0, T_{\\text{end}}]$ for each parameter set in the test suite below. The numerical integration method is not prescribed; you may use any standard method suitable for stiff or non-stiff systems. The discrete event at $t = 1\\ \\text{s}$ must be enforced exactly in the forcing term as a mode switch.\n\nFor each test case, compute the following two scalar performance metrics, expressed in hertz:\n1. The frequency nadir after the event, defined as $\\min_{t \\in [1\\ \\text{s}, T_{\\text{end}}]} \\left(f_0 + \\Delta f(t)\\right)$, in hertz, rounded to $6$ decimal places.\n2. The absolute frequency at time $t = 5\\ \\text{s}$, i.e., $f_0 + \\Delta f(5\\ \\text{s})$, in hertz, rounded to $6$ decimal places.\n\nAll physical quantities that appear in the final answers must be reported in hertz. Angles do not appear in this problem, so no angle unit is required. Percentages must not be used; all values are real numbers.\n\nTest suite parameters:\n- Case A (happy path, $50$ hertz system, moderate inertia and droop): $f_0 = 50\\ \\text{Hz}$, $H = 5$, $D = 1$, $R = 0.05$, $T_g = 0.5\\ \\text{s}$, $P_{\\text{step}} = 0.2$, $T_{\\text{end}} = 10\\ \\text{s}$.\n- Case B (different nominal frequency, low inertia, strong primary response): $f_0 = 60\\ \\text{Hz}$, $H = 2$, $D = 0.5$, $R = 0.04$, $T_g = 0.2\\ \\text{s}$, $P_{\\text{step}} = 0.1$, $T_{\\text{end}} = 8\\ \\text{s}$.\n- Case C (high inertia, weak droop, larger disturbance): $f_0 = 50\\ \\text{Hz}$, $H = 10$, $D = 2$, $R = 0.1$, $T_g = 1.0\\ \\text{s}$, $P_{\\text{step}} = 0.3$, $T_{\\text{end}} = 12\\ \\text{s}$.\n- Case D (edge case with negligible disturbance, no explicit load damping): $f_0 = 50\\ \\text{Hz}$, $H = 3$, $D = 0$, $R = 0.05$, $T_g = 0.05\\ \\text{s}$, $P_{\\text{step}} = 0.001$, $T_{\\text{end}} = 5.5\\ \\text{s}$.\n\nYour program must:\n- Implement the model derived from the fundamental principles to compute $\\Delta f(t)$ and $\\Delta P_m(t)$ for each test case with the hybrid switch at $t = 1\\ \\text{s}$.\n- For each test case, output the two hertz-valued metrics specified above, rounded to $6$ decimal places.\n- Aggregate all results for the four cases into a single line of output containing a comma-separated list enclosed in square brackets, ordered as $[\\text{nadir}_A,\\ f_5^{(A)},\\ \\text{nadir}_B,\\ f_5^{(B)},\\ \\text{nadir}_C,\\ f_5^{(C)},\\ \\text{nadir}_D,\\ f_5^{(D)}]$, where each entry is a float.\n\nThe final output must be exactly one line in the specified format, with no additional text.",
            "solution": "The problem requires the formulation and numerical solution of a continuous-time model for the primary frequency response of an islanded power system area. The model must be derived from first principles, specifically the swing equation and a first-order governor model. We will construct a state-space representation of the system dynamics. The state variables are the frequency deviation, $\\Delta f(t)$ in hertz, and the mechanical power deviation, $\\Delta P_m(t)$ in per unit (p.u.).\n\nThe system is defined by two interconnected physical principles: the conservation of energy (swing equation) and the primary control action (governor response).\n\nFirst, we establish the swing equation which governs the dynamics of the rotational speed of the equivalent generator representing the area. The linearized swing equation, relating the change in rotor speed to the power imbalance, is given by:\n$$\n\\frac{2H}{f_0} \\frac{d(\\Delta f)}{dt} = \\Delta P_m(t) - \\Delta P_{load}(t)\n$$\nHere, $H$ is the aggregate inertia constant in seconds, $f_0$ is the nominal system frequency in Hz, $\\Delta f(t)$ is the frequency deviation in Hz, and $\\Delta P_m(t)$ is the deviation in mechanical power input from its pre-event equilibrium value in p.u. The term $\\Delta P_{load}(t)$ represents the total deviation in electrical load in p.u. This total load deviation is composed of two parts: the external disturbance $\\Delta P_e(t)$ and the frequency-dependent load response (load damping).\n\nThe external disturbance $\\Delta P_e(t)$ is modeled as a step function due to the islanding event at $t=1\\,\\text{s}$:\n$$\n\\Delta P_e(t) = \\begin{cases} 0 & \\text{for } t < 1\\,\\text{s} \\\\ P_{\\text{step}} & \\text{for } t \\ge 1\\,\\text{s} \\end{cases}\n$$\nwhere $P_{\\text{step}}$ is the magnitude of the lost import power, which now must be supplied by the local generation, effectively acting as an instantaneous increase in local demand.\n\nThe load damping effect models the inherent tendency of many electrical loads to consume slightly less power when frequency drops. This is quantified by the damping coefficient $D$, defined in units of p.u. power per p.u. frequency deviation. The per-unit frequency deviation is $\\frac{\\Delta f(t)}{f_0}$. Thus, the change in load due to damping is $D \\frac{\\Delta f(t)}{f_0}$. This term acts to stabilize the system by counteracting frequency changes.\n\nThe total electrical load deviation is the sum of the disturbance and the damping effect:\n$$\n\\Delta P_{load}(t) = \\Delta P_e(t) + D \\frac{\\Delta f(t)}{f_0}\n$$\nSubstituting this into the swing equation gives:\n$$\n\\frac{2H}{f_0} \\frac{d(\\Delta f)}{dt} = \\Delta P_m(t) - \\left( \\Delta P_e(t) + D \\frac{\\Delta f(t)}{f_0} \\right)\n$$\nRearranging to isolate the derivative of the first state variable, $\\Delta f(t)$, we obtain the first ordinary differential equation (ODE):\n$$\n\\frac{d(\\Delta f)}{dt} = -\\frac{D}{2H} \\Delta f(t) + \\frac{f_0}{2H} \\Delta P_m(t) - \\frac{f_0}{2H} \\Delta P_e(t)\n$$\n\nSecond, we model the primary frequency control action, which is performed by the governor of the equivalent generator. The governor adjusts the mechanical power input $\\Delta P_m(t)$ in response to the frequency deviation $\\Delta f(t)$. The control law is based on a droop characteristic, where the desired steady-state mechanical power change is proportional to the frequency deviation. The droop coefficient $R$ is defined as the change in p.u. frequency required for a full p.u. power response. The target power reference for the governor, $\\Delta P_{ref}(t)$, is therefore:\n$$\n\\Delta P_{ref}(t) = -\\frac{1}{R} \\left( \\frac{\\Delta f(t)}{f_0} \\right)\n$$\nThe negative sign ensures that a frequency drop (negative $\\Delta f$) results in a command to increase mechanical power.\n\nThe problem specifies a first-order actuator model for the governor, with a time constant $T_g$. This means the actual mechanical power $\\Delta P_m(t)$ follows the reference $\\Delta P_{ref}(t)$ with a first-order lag:\n$$\nT_g \\frac{d(\\Delta P_m)}{dt} + \\Delta P_m(t) = \\Delta P_{ref}(t)\n$$\nSubstituting the expression for $\\Delta P_{ref}(t)$:\n$$\nT_g \\frac{d(\\Delta P_m)}{dt} + \\Delta P_m(t) = -\\frac{1}{R f_0} \\Delta f(t)\n$$\nRearranging to isolate the derivative of the second state variable, $\\Delta P_m(t)$, we get the second ODE:\n$$\n\\frac{d(\\Delta P_m)}{dt} = -\\frac{1}{R T_g f_0} \\Delta f(t) - \\frac{1}{T_g} \\Delta P_m(t)\n$$\n\nWe now have a complete system of two coupled, linear, first-order ordinary differential equations. Let the state vector be $x(t) = \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix}$. The system can be written in state-space form $\\dot{x}(t) = Ax(t) + Bu(t)$:\n$$\n\\frac{d}{dt} \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix} = \\begin{bmatrix} -\\frac{D}{2H} & \\frac{f_0}{2H} \\\\ -\\frac{1}{R T_g f_0} & -\\frac{1}{T_g} \\end{bmatrix} \\begin{bmatrix} \\Delta f(t) \\\\ \\Delta P_m(t) \\end{bmatrix} + \\begin{bmatrix} -\\frac{f_0}{2H} \\\\ 0 \\end{bmatrix} \\Delta P_e(t)\n$$\nThe system is at equilibrium before the event, so the initial conditions at $t=0$ are:\n$$\n\\Delta f(0) = 0 \\quad \\text{and} \\quad \\Delta P_m(0) = 0\n$$\nThis system of ODEs will be numerically integrated from $t=0$ to $t=T_{\\text{end}}$ for each set of parameters provided in the test suite. A standard numerical solver, such as a Runge-Kutta method, is suitable. The piecewise constant nature of the input $\\Delta P_e(t)$ is handled directly within the function defining the derivatives.\n\nFrom the resulting time-domain solution for $\\Delta f(t)$, we can calculate the required metrics:\n1.  The frequency nadir is found by computing $\\min_{t \\in [1, T_{\\text{end}}]} (f_0 + \\Delta f(t))$. This involves evaluating the solution over a fine time grid in the post-event interval.\n2.  The frequency at $t=5\\,\\text{s}$ is calculated directly as $f_0 + \\Delta f(5)$.\n\nThis completes the formulation of the problem. The implementation will involve translating this mathematical model into code and executing it for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the system of ODEs for primary frequency control\n    in a power system and computes specified performance metrics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path, 50 hertz system, moderate inertia and droop)\n        {'f0': 50.0, 'H': 5.0, 'D': 1.0, 'R': 0.05, 'Tg': 0.5, 'P_step': 0.2, 'T_end': 10.0},\n        # Case B (different nominal frequency, low inertia, strong primary response)\n        {'f0': 60.0, 'H': 2.0, 'D': 0.5, 'R': 0.04, 'Tg': 0.2, 'P_step': 0.1, 'T_end': 8.0},\n        # Case C (high inertia, weak droop, larger disturbance)\n        {'f0': 50.0, 'H': 10.0, 'D': 2.0, 'R': 0.1, 'Tg': 1.0, 'P_step': 0.3, 'T_end': 12.0},\n        # Case D (edge case with negligible disturbance, no explicit load damping)\n        {'f0': 50.0, 'H': 3.0, 'D': 0.0, 'R': 0.05, 'Tg': 0.05, 'P_step': 0.001, 'T_end': 5.5}\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        f0 = case['f0']\n        H = case['H']\n        D = case['D']\n        R = case['R']\n        Tg = case['Tg']\n        P_step = case['P_step']\n        T_end = case['T_end']\n\n        # Define the system of ordinary differential equations (ODEs).\n        # y[0] is delta_f (frequency deviation in Hz)\n        # y[1] is delta_Pm (mechanical power deviation in p.u.)\n        def system_dynamics(t, y):\n            delta_f, delta_Pm = y\n            \n            # Hybrid switch for the electrical disturbance at t=1s\n            delta_Pe = P_step if t >= 1.0 else 0.0\n            \n            # Equation for d(delta_f)/dt from the swing equation\n            # d(df)/dt = -(D/(2H))*df + (f0/(2H))*dPm - (f0/(2H))*dPe\n            d_delta_f_dt = (f0 / (2.0 * H)) * (delta_Pm - delta_Pe) - (D / (2.0 * H)) * delta_f\n            \n            # Equation for d(delta_Pm)/dt from the first-order governor model\n            # d(dPm)/dt = -(1/(R*Tg*f0))*df - (1/Tg)*dPm\n            d_delta_Pm_dt = (-1.0 / (R * Tg * f0)) * delta_f - (1.0 / Tg) * delta_Pm\n            \n            return [d_delta_f_dt, d_delta_Pm_dt]\n\n        # Set initial conditions: system at equilibrium\n        y0 = [0.0, 0.0]\n        \n        # Set the time span for integration\n        t_span = [0.0, T_end]\n        \n        # Numerically solve the ODE system.\n        # dense_output=True allows for evaluation at any point in the interval.\n        sol = solve_ivp(system_dynamics, t_span, y0, method='RK45', dense_output=True, rtol=1e-8, atol=1e-8)\n        \n        # --- Calculate and store the performance metrics ---\n        \n        # 1. Frequency nadir (minimum frequency) post-event\n        # The nadir occurs after the disturbance at t=1.0s.\n        # We evaluate the solution on a fine grid to find the minimum.\n        t_eval_nadir = np.linspace(1.0, T_end, 2000)\n        delta_f_values = sol.sol(t_eval_nadir)[0]\n        nadir = f0 + np.min(delta_f_values)\n        \n        # 2. Absolute frequency at t=5s\n        # All T_end values are >= 5.5s, so t=5s is a valid point.\n        delta_f_at_5s = sol.sol(5.0)[0]\n        f_at_5s = f0 + delta_f_at_5s\n\n        # Append the rounded results to the list\n        all_results.append(round(nadir, 6))\n        all_results.append(round(f_at_5s, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While primary control provides an essential first line of defense against frequency deviations, it inherently results in a steady-state error, as seen in the transient response to disturbances . This analytical exercise delves into the next layer of the control hierarchy: secondary control, or Automatic Generation Control (AGC). Using the powerful tools of Laplace transforms and linear control theory, you will derive the system's closed-loop behavior to prove a fundamental principle: the integral action of secondary control is what guarantees the system frequency is precisely restored to its nominal value after a disturbance, ensuring long-term grid reliability.",
            "id": "4211441",
            "problem": "A large-scale smart grid is modeled as a single-area aggregate in a cyber-physical system with a digital twin that estimates the system frequency deviation and dispatches control actions. The aggregate dynamics of the physical grid frequency are modeled by the swing equation and linearized primary and secondary controls. Assume the following standard elements:\n\n- The swing equation for the aggregate frequency deviation is $M \\frac{d \\Delta \\omega(t)}{dt} = \\Delta P_{m}(t) - \\Delta P_{L}(t) - D \\Delta \\omega(t)$, where $M$ is the equivalent inertia constant, $D$ is the equivalent damping coefficient representing load-frequency sensitivity, $\\Delta \\omega(t)$ is the angular frequency deviation in radians per second, $\\Delta P_{m}(t)$ is the mechanical power deviation, and $\\Delta P_{L}(t)$ is the load deviation.\n- Primary droop control uses droop coefficient $R$ such that the primary control gain is $K_{p} = \\frac{1}{R}$, and it contributes to mechanical power as $\\Delta P_{m,\\mathrm{pri}}(t) = - K_{p} \\Delta \\omega(t)$.\n- Secondary control (automatic generation control) uses integral action with gain $K_{i}$ acting on the measured frequency deviation, producing $\\Delta P_{\\mathrm{sec}}(t)$ with $\\frac{d}{dt}\\Delta P_{\\mathrm{sec}}(t) = - K_{i} \\Delta \\omega(t)$. The net mechanical power deviation is $\\Delta P_{m}(t) = \\Delta P_{m,\\mathrm{pri}}(t) + \\Delta P_{\\mathrm{sec}}(t)$.\n- The digital twin provides an accurate $\\Delta \\omega(t)$; all signal measurements and actuation are idealized (no deadbands, delays, or saturation).\n\nAt time $t = 0$, the area experiences a step increase in load of magnitude $\\Delta P_{L}(t) = \\Delta P_{0} u(t)$ with $\\Delta P_{0} = 100$ MW, where $u(t)$ is the unit step. Starting from the above definitions and fundamental laws, derive the closed-loop input-output relation from $\\Delta P_{L}(s)$ to $\\Delta \\omega(s)$, and use it to compute the steady-state frequency deviation $\\lim_{t \\to \\infty} \\Delta f(t)$, where $\\Delta f(t) = \\frac{\\Delta \\omega(t)}{2 \\pi}$. Express the final answer in Hertz. Do not round; provide the exact value as a single number.",
            "solution": "The problem requires the derivation of the closed-loop transfer function mapping a load disturbance to the system's frequency deviation and the subsequent calculation of the steady-state frequency deviation for a step-load disturbance. The analysis begins with the provided dynamic equations for the single-area smart grid model.\n\nThe governing equations are:\n1. Swing Equation: $M \\frac{d \\Delta \\omega(t)}{dt} = \\Delta P_{m}(t) - \\Delta P_{L}(t) - D \\Delta \\omega(t)$\n2. Net Mechanical Power: $\\Delta P_{m}(t) = \\Delta P_{m,\\mathrm{pri}}(t) + \\Delta P_{\\mathrm{sec}}(t)$\n3. Primary Control (Droop): $\\Delta P_{m,\\mathrm{pri}}(t) = - K_{p} \\Delta \\omega(t)$\n4. Secondary Control (Integral Action): $\\frac{d}{dt}\\Delta P_{\\mathrm{sec}}(t) = - K_{i} \\Delta \\omega(t)$\n\nTo derive the transfer function, we convert these time-domain equations to the Laplace domain. Assuming the system is at rest before $t=0$, all initial conditions are zero. The Laplace transforms of the equations are:\n\n1'. $M s \\Delta \\omega(s) = \\Delta P_{m}(s) - \\Delta P_{L}(s) - D \\Delta \\omega(s)$\n2'. $\\Delta P_{m}(s) = \\Delta P_{m,\\mathrm{pri}}(s) + \\Delta P_{\\mathrm{sec}}(s)$\n3'. $\\Delta P_{m,\\mathrm{pri}}(s) = - K_{p} \\Delta \\omega(s)$\n4'. $s \\Delta P_{\\mathrm{sec}}(s) = - K_{i} \\Delta \\omega(s)$, which implies $\\Delta P_{\\mathrm{sec}}(s) = -\\frac{K_{i}}{s} \\Delta \\omega(s)$\n\nWe combine these algebraic equations to find the relationship between the input, $\\Delta P_{L}(s)$, and the output, $\\Delta \\omega(s)$. First, substitute the expressions for $\\Delta P_{m,\\mathrm{pri}}(s)$ and $\\Delta P_{\\mathrm{sec}}(s)$ into the equation for the net mechanical power, $\\Delta P_{m}(s)$:\n$\\Delta P_{m}(s) = - K_{p} \\Delta \\omega(s) - \\frac{K_{i}}{s} \\Delta \\omega(s) = - \\left( K_{p} + \\frac{K_{i}}{s} \\right) \\Delta \\omega(s)$\n\nNext, substitute this expression for $\\Delta P_{m}(s)$ into the transformed swing equation (1'):\n$M s \\Delta \\omega(s) = - \\left( K_{p} + \\frac{K_{i}}{s} \\right) \\Delta \\omega(s) - \\Delta P_{L}(s) - D \\Delta \\omega(s)$\n\nTo solve for $\\Delta \\omega(s)$, we rearrange the equation by moving all terms containing $\\Delta \\omega(s)$ to the left-hand side:\n$M s \\Delta \\omega(s) + D \\Delta \\omega(s) + K_{p} \\Delta \\omega(s) + \\frac{K_{i}}{s} \\Delta \\omega(s) = - \\Delta P_{L}(s)$\n\nFactor out $\\Delta \\omega(s)$:\n$\\Delta \\omega(s) \\left( Ms + D + K_{p} + \\frac{K_{i}}{s} \\right) = - \\Delta P_{L}(s)$\n\nTo simplify the expression in the parentheses, we find a common denominator, $s$:\n$\\Delta \\omega(s) \\left( \\frac{Ms^{2} + (D + K_{p})s + K_{i}}{s} \\right) = - \\Delta P_{L}(s)$\n\nThe closed-loop input-output relation, which is the transfer function $G(s) = \\frac{\\Delta \\omega(s)}{\\Delta P_{L}(s)}$, is therefore:\n$$G(s) = \\frac{\\Delta \\omega(s)}{\\Delta P_{L}(s)} = \\frac{-s}{Ms^{2} + (D + K_{p})s + K_{i}}$$\n\nThis is the first required result. Now we proceed to compute the steady-state frequency deviation. The grid experiences a step increase in load of magnitude $\\Delta P_{0} = 100$ MW, such that $\\Delta P_{L}(t) = \\Delta P_{0} u(t)$. The Laplace transform of this input is:\n$\\Delta P_{L}(s) = \\mathcal{L}\\{\\Delta P_{0} u(t)\\} = \\frac{\\Delta P_{0}}{s}$\n\nThe angular frequency deviation in the Laplace domain, $\\Delta \\omega(s)$, is the product of the transfer function $G(s)$ and the input $\\Delta P_{L}(s)$:\n$\\Delta \\omega(s) = G(s) \\Delta P_{L}(s) = \\left( \\frac{-s}{Ms^{2} + (D + K_{p})s + K_{i}} \\right) \\left( \\frac{\\Delta P_{0}}{s} \\right)$\n$\\Delta \\omega(s) = \\frac{-\\Delta P_{0}}{Ms^{2} + (D + K_{p})s + K_{i}}$\n\nTo find the steady-state value of the angular frequency deviation, $\\Delta \\omega_{ss} = \\lim_{t \\to \\infty} \\Delta \\omega(t)$, we apply the Final Value Theorem (FVT) of Laplace transforms, which states that $\\lim_{t \\to \\infty} y(t) = \\lim_{s \\to 0} s Y(s)$, provided that all poles of $sY(s)$ are in the left half of the complex plane. The poles of the system are the roots of the characteristic equation $Ms^{2} + (D + K_{p})s + K_{i} = 0$. For a physically stable power system, the inertia $M$, damping $D$, primary control gain $K_p$, and secondary control gain $K_i$ are all positive constants. The coefficients of the second-order characteristic polynomial are $M > 0$, $(D + K_{p}) > 0$, and $K_{i} > 0$. According to the Routh-Hurwitz stability criterion, a second-order system is stable if and only if all coefficients have the same sign. Since all coefficients are positive, the system is stable, its poles lie in the left half-plane, and the FVT is applicable.\n\nApplying the FVT:\n$\\Delta \\omega_{ss} = \\lim_{s \\to 0} s \\Delta \\omega(s) = \\lim_{s \\to 0} s \\left( \\frac{-\\Delta P_{0}}{Ms^{2} + (D + K_{p})s + K_{i}} \\right)$\n$\\Delta \\omega_{ss} = \\lim_{s \\to 0} \\frac{-s \\Delta P_{0}}{Ms^{2} + (D + K_{p})s + K_{i}}$\n\nEvaluating the limit by substituting $s=0$:\n$\\Delta \\omega_{ss} = \\frac{-(0) \\Delta P_{0}}{M(0)^{2} + (D + K_{p})(0) + K_{i}} = \\frac{0}{K_{i}}$\nSince $K_i$ is a non-zero gain, the result is:\n$\\Delta \\omega_{ss} = 0$ rad/s\n\nThis result demonstrates a fundamental property of integral control: it drives the steady-state error to zero for a step input. The secondary control (AGC) ensures that the frequency returns to its nominal value after a load disturbance.\n\nThe problem asks for the steady-state frequency deviation in Hertz, $\\Delta f_{ss}$. The relationship between angular frequency deviation $\\Delta \\omega$ and frequency deviation $\\Delta f$ is $\\Delta f(t) = \\frac{\\Delta \\omega(t)}{2 \\pi}$.\nThus, the steady-state value is:\n$\\Delta f_{ss} = \\lim_{t \\to \\infty} \\Delta f(t) = \\frac{1}{2 \\pi} \\lim_{t \\to \\infty} \\Delta \\omega(t) = \\frac{\\Delta \\omega_{ss}}{2 \\pi} = \\frac{0}{2 \\pi} = 0$ Hz.\nThe steady-state frequency deviation is $0$ Hertz.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "The modern smart grid is characterized by the integration of renewable energy sources through power electronic inverters, which lack the natural inertia of traditional generators. This final practice challenges you to step into the role of a control designer for these modern assets. You will implement a Virtual Synchronous Machine (VSM) controller, a state-of-the-art technique that enables inverters to emulate the stabilizing dynamics of conventional machines. This exercise bridges abstract control theory with practical implementation, requiring you to tune controller parameters to meet specific performance targets for stability and transient response, a critical skill for engineering the resilient power systems of the future.",
            "id": "4211437",
            "problem": "Consider a single grid-forming inverter connected to a large-scale smart grid at a point of common coupling through an equivalent Thevenin reactance. The inverter is controlled by a Virtual Synchronous Machine (VSM) law that emulates the small-signal dynamics of a synchronous generator. The control objective is to choose the VSM parameters to achieve a target damping ratio for a specified short-circuit ratio. Work in per-unit normalization with base voltage equal to the nominal bus voltage and base power equal to the inverter rating. Assume a balanced, sinusoidal steady-state and small-angle deviations.\n\nFundamental base and modeling assumptions:\n- The alternating current active power transfer across a reactance obeys the power-angle relation $P = \\dfrac{V_1 V_2}{X} \\sin(\\delta)$, where $P$ is active power, $V_1$ and $V_2$ are bus voltage magnitudes, $X$ is the series reactance, and $\\delta$ is the electrical angle difference. For small deviations about an operating point with $V_1 \\approx V_2 \\approx 1$ per-unit and $\\delta \\approx 0$ radians, linearization yields $P \\approx K_s \\, \\delta$ with synchronizing stiffness $K_s = \\dfrac{V_1 V_2}{X} \\approx \\dfrac{1}{X}$.\n- The grid short-circuit ratio (SCR) at the point of common coupling is defined by $\\mathrm{SCR} = \\dfrac{S_{\\text{sc}}}{S_{\\text{base}}}$ and in per-unit at $V = 1$ satisfies $X_{\\text{th}} \\approx \\dfrac{1}{\\mathrm{SCR}}$. Hence, the small-signal synchronizing stiffness is $K_s \\approx \\mathrm{SCR}$.\n- The Virtual Synchronous Machine (VSM) frequency-angle dynamics are modeled as a second-order swing equation for the angle deviation $\\delta$: $$M \\, \\dfrac{d^2 \\delta}{dt^2} + D \\, \\dfrac{d \\delta}{dt} + K_s \\, \\delta = \\Delta P_m,$$ where $M$ is the virtual inertia coefficient, $D$ is the virtual damping coefficient, $K_s$ is the synchronizing stiffness, and $\\Delta P_m$ is the small-signal equivalent mechanical power input from the control loop. Angles are in radians, and angular frequency is in radians per second ($\\mathrm{rad/s}$). In canonical second-order form, dividing by $M$ yields $$\\dfrac{d^2 \\delta}{dt^2} + \\dfrac{D}{M} \\dfrac{d \\delta}{dt} + \\dfrac{K_s}{M} \\delta = \\dfrac{\\Delta P_m}{M}.$$ Comparing to the standard second-order form with natural frequency $\\omega_n$ and damping ratio $\\zeta$: $$\\dfrac{d^2 \\delta}{dt^2} + 2 \\zeta \\omega_n \\dfrac{d \\delta}{dt} + \\omega_n^2 \\delta = \\text{input},$$ gives the identifications $\\omega_n^2 = \\dfrac{K_s}{M}$ and $2 \\zeta \\omega_n = \\dfrac{D}{M}$.\n\nYour task:\n- Construct the controller parameterization by choosing $M$ and $D$ to achieve a specified target damping ratio $\\zeta_{\\text{target}}$ and target natural frequency $\\omega_{n,\\text{target}}$ for a given short-circuit ratio $\\mathrm{SCR}$. Use the fundamental relations to derive and implement formulas for $M$ and $D$ in terms of $K_s$, $\\zeta_{\\text{target}}$, and $\\omega_{n,\\text{target}}$.\n- For each test case, compute:\n  - The synchronizing stiffness $K_s$ from $\\mathrm{SCR}$ using $K_s = \\mathrm{SCR}$.\n  - The tuned parameters $M$ and $D$ that achieve the target $\\zeta_{\\text{target}}$ and $\\omega_{n,\\text{target}}$.\n  - The achieved damping ratio $\\zeta_{\\text{achieved}}$ and natural frequency $\\omega_{n,\\text{achieved}}$ from $M$, $D$, and $K_s$ using $\\zeta_{\\text{achieved}} = \\dfrac{D}{2 \\sqrt{M K_s}}$ and $\\omega_{n,\\text{achieved}} = \\sqrt{\\dfrac{K_s}{M}}$.\n  - The closed-loop poles of the homogeneous system and a boolean stability flag indicating whether all poles have strictly negative real parts (stability is expected when $M > 0$, $D > 0$, and $K_s > 0$). You do not need to output the poles themselves; only the boolean flag.\n  - The unit-step overshoot of the angle response (as a decimal, not a percentage symbol) under the standard second-order approximation. For $0 < \\zeta < 1$, use $$M_p = \\exp\\!\\left( -\\dfrac{\\zeta \\pi}{\\sqrt{1 - \\zeta^2}} \\right).$$ For $\\zeta \\ge 1$, set $M_p = 0$. Also produce a boolean indicating whether $M_p \\le 0.1$.\n\nReport and units:\n- Angles are in radians. The natural frequency $\\omega_n$ must be reported in $\\mathrm{rad/s}$. The damping ratio $\\zeta$ is dimensionless. The parameters $M$ and $D$ should be reported as dimensionless per-unit coefficients consistent with the normalized second-order form given above.\n- All numeric outputs must be floats except the boolean flags.\n- For each test case, output a list in the order $[M, D, \\zeta_{\\text{achieved}}, \\omega_{n,\\text{achieved}}, \\text{stable}, M_p, \\text{overshoot\\_ok}]$ where $\\text{stable}$ and $\\text{overshoot\\_ok}$ are booleans.\n\nTest suite:\nUse the following set of test cases, each specified as $(\\mathrm{SCR}, \\zeta_{\\text{target}}, \\omega_{n,\\text{target}})$ with $\\omega_{n,\\text{target}}$ in $\\mathrm{rad/s}$:\n- Case A (happy path): $(5.0, 0.7, 2 \\pi \\cdot 3)$.\n- Case B (weak grid edge): $(0.8, 0.05, 2 \\pi \\cdot 1)$.\n- Case C (strong grid): $(10.0, 0.9, 2 \\pi \\cdot 5)$.\n- Case D (critical damping boundary): $(3.0, 1.0, 2 \\pi \\cdot 2)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$). Each $result_i$ must be the list $[M, D, \\zeta_{\\text{achieved}}, \\omega_{n,\\text{achieved}}, \\text{stable}, M_p, \\text{overshoot\\_ok}]$ for the $i$-th test case in the order given above.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in established principles of power system dynamics and control theory, is well-posed with a clear and complete set of definitions and constraints, and is expressed in objective, formal language. There are no contradictions, ambiguities, or unsound premises. We may therefore proceed with a complete solution.\n\nThe core of the task is to design the parameters of a Virtual Synchronous Machine (VSM) controller to meet specified dynamic performance targets for a grid-forming inverter. The solution involves deriving the controller parameters from the fundamental equations of motion and then applying these to a set of test cases.\n\nFirst, we establish the theoretical foundation for the controller design. The problem provides the small-signal dynamics of the inverter's angle deviation, $\\delta$, governed by the second-order swing equation:\n$$M \\, \\dfrac{d^2 \\delta}{dt^2} + D \\, \\dfrac{d \\delta}{dt} + K_s \\, \\delta = \\Delta P_m$$\nHere, $M$ is the virtual inertia coefficient, $D$ is the virtual damping coefficient, and $K_s$ is the synchronizing stiffness coefficient, which represents the grid's ability to synchronize the inverter. The problem states that for small-signal analysis in per-unit, $K_s$ is approximately equal to the short-circuit ratio, $\\mathrm{SCR}$. Thus, $K_s = \\mathrm{SCR}$.\n\nTo systematically design the controller parameters $M$ and $D$, we compare this physical model to the canonical form of a second-order linear time-invariant system:\n$$\\dfrac{d^2 \\delta}{dt^2} + 2 \\zeta \\omega_n \\dfrac{d \\delta}{dt} + \\omega_n^2 \\delta = \\text{input}$$\nwhere $\\zeta$ is the damping ratio and $\\omega_n$ is the natural frequency of oscillation. By dividing the VSM equation by $M$, we obtain:\n$$\\dfrac{d^2 \\delta}{dt^2} + \\dfrac{D}{M} \\dfrac{d \\delta}{dt} + \\dfrac{K_s}{M} \\delta = \\dfrac{\\Delta P_m}{M}$$\nBy comparing the coefficients of the terms involving $\\delta$ and its derivatives, we establish the following key relationships between the physical parameters ($M, D, K_s$) and the performance metrics ($\\zeta, \\omega_n$):\n$$(1) \\quad \\omega_n^2 = \\dfrac{K_s}{M}$$\n$$(2) \\quad 2 \\zeta \\omega_n = \\dfrac{D}{M}$$\nOur objective is to determine $M$ and $D$ such that the system achieves a target natural frequency, $\\omega_{n,\\text{target}}$, and a target damping ratio, $\\zeta_{\\text{target}}$.\n\nFrom relationship $(1)$, we can solve for the virtual inertia $M$ required to achieve $\\omega_{n,\\text{target}}$:\n$$\\omega_{n,\\text{target}}^2 = \\dfrac{K_s}{M} \\implies M = \\dfrac{K_s}{\\omega_{n,\\text{target}}^2}$$\nThis equation shows that the required inertia is directly proportional to the grid stiffness $K_s$ and inversely proportional to the square of the desired natural frequency. A faster desired response (higher $\\omega_{n,\\text{target}}$) necessitates a smaller virtual inertia.\n\nNext, we use relationship $(2)$ to solve for the virtual damping $D$. It is computationally robust to express $D$ in terms of the input parameters rather than the intermediate parameter $M$. We can rearrange $(2)$ as $D = 2 \\zeta \\omega_n M$. Substituting our derived expression for $M$:\n$$D = 2 \\zeta_{\\text{target}} \\omega_{n,\\text{target}} \\left( \\dfrac{K_s}{\\omega_{n,\\text{target}}^2} \\right) \\implies D = \\dfrac{2 \\zeta_{\\text{target}} K_s}{\\omega_{n,\\text{target}}}$$\nThis equation specifies the damping coefficient required to achieve the target damping ratio $\\zeta_{\\text{target}}$. $D$ is proportional to both the target damping ratio and the grid stiffness, and inversely proportional to the target natural frequency.\n\nWith these two formulas, we can compute the required controller parameters for any given set of grid conditions and performance targets. The procedure for each test case is as follows:\n\n1.  **Calculate Synchronizing Stiffness**: Given the short-circuit ratio, $\\mathrm{SCR}$, we determine the stiffness using the provided approximation: $K_s = \\mathrm{SCR}$.\n\n2.  **Calculate Controller Parameters**: Using the target values $\\zeta_{\\text{target}}$ and $\\omega_{n,\\text{target}}$ and the calculated $K_s$, we compute the controller parameters:\n    - $M = \\dfrac{K_s}{\\omega_{n,\\text{target}}^2}$\n    - $D = \\dfrac{2 \\zeta_{\\text{target}} K_s}{\\omega_{n,\\text{target}}}$\n\n3.  **Verify Achieved Performance**: We use the provided verification formulas to confirm that our choices of $M$ and $D$ yield the desired performance.\n    - $\\omega_{n,\\text{achieved}} = \\sqrt{\\dfrac{K_s}{M}} = \\sqrt{\\dfrac{K_s}{K_s / \\omega_{n,\\text{target}}^2}} = \\omega_{n,\\text{target}}$\n    - $\\zeta_{\\text{achieved}} = \\dfrac{D}{2 \\sqrt{M K_s}} = \\dfrac{2 \\zeta_{\\text{target}} K_s / \\omega_{n,\\text{target}}}{2 \\sqrt{(K_s / \\omega_{n,\\text{target}}^2) K_s}} = \\dfrac{2 \\zeta_{\\text{target}} K_s / \\omega_{n,\\text{target}}}{2 (K_s / \\omega_{n,\\text{target}})} = \\zeta_{\\text{target}}$\n    As shown by the algebraic simplification, the achieved values will match the target values, subject to computational precision.\n\n4.  **Assess Stability**: The stability of the system is determined by the poles of its characteristic equation, $M s^2 + D s + K_s = 0$. The system is stable if and only if all coefficients ($M, D, K_s$) are positive, which ensures the poles have strictly negative real parts. For all test cases, SCR is positive, so $K_s > 0$. The targets $\\zeta_{\\text{target}}$ and $\\omega_{n,\\text{target}}$ are also positive. Consequently, our formulas for $M$ and $D$ will yield positive values, guaranteeing stability. The `stable` flag will be `True`.\n\n5.  **Calculate Overshoot**: The percentage overshoot, $M_p$, for the step response of a second-order system is calculated based on the damping ratio $\\zeta$.\n    - For an underdamped system ($0 < \\zeta < 1$): $M_p = \\exp\\!\\left( -\\dfrac{\\zeta \\pi}{\\sqrt{1 - \\zeta^2}} \\right)$.\n    - For critically damped or overdamped systems ($\\zeta \\ge 1$): The response has no overshoot, so $M_p = 0$.\n\n6.  **Evaluate Overshoot Constraint**: The calculated overshoot $M_p$ is compared against the specified threshold of $0.1$. The boolean flag `overshoot_ok` is set to `True` if $M_p \\le 0.1$ and `False` otherwise.\n\nFollowing this procedure for each test case, we will generate a list containing the computed values $[M, D, \\zeta_{\\text{achieved}}, \\omega_{n,\\text{achieved}}, \\text{stable}, M_p, \\text{overshoot\\_ok}]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes VSM controller parameters and performance metrics for given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (SCR, zeta_target, omega_n_target_Hz)\n    test_cases_hz = [\n        (5.0, 0.7, 3.0),   # Case A\n        (0.8, 0.05, 1.0),  # Case B\n        (10.0, 0.9, 5.0),  # Case C\n        (3.0, 1.0, 2.0)    # Case D\n    ]\n\n    # Convert Hz to rad/s for omega_n_target\n    test_cases = [\n        (scr, zeta_t, 2 * np.pi * w_n_t_hz)\n        for scr, zeta_t, w_n_t_hz in test_cases_hz\n    ]\n\n    results = []\n    for case in test_cases:\n        scr, zeta_target, omega_n_target = case\n\n        # Step 1: Calculate synchronizing stiffness Ks\n        # Ks is given as approximately equal to SCR in per-unit.\n        k_s = float(scr)\n\n        # Step 2: Calculate tuned parameters M and D\n        # M = Ks / omega_n_target^2\n        # D = 2 * zeta_target * Ks / omega_n_target\n        m = k_s / (omega_n_target**2)\n        d = (2 * zeta_target * k_s) / omega_n_target\n\n        # Step 3: Calculate achieved damping ratio and natural frequency\n        # These should match the targets due to the derivation.\n        # zeta_achieved = D / (2 * sqrt(M * Ks))\n        # omega_n_achieved = sqrt(Ks / M)\n        omega_n_achieved = np.sqrt(k_s / m)\n        zeta_achieved = d / (2 * np.sqrt(m * k_s))\n\n        # Step 4: Determine stability\n        # Stability is guaranteed if M, D, Ks are all positive.\n        # Given the inputs, Ks > 0, omega_n_target > 0, zeta_target > 0,\n        # which ensures M > 0 and D > 0.\n        stable = (m > 0 and d > 0 and k_s > 0)\n\n        # Step 5: Calculate unit-step overshoot Mp\n        # Mp = exp(-zeta*pi / sqrt(1 - zeta^2)) for 0  zeta  1\n        # Mp = 0 for zeta >= 1\n        if 0  zeta_achieved  1:\n            m_p = np.exp(-zeta_achieved * np.pi / np.sqrt(1 - zeta_achieved**2))\n        else: # zeta >= 1 (or zeta = 0, which is not expected here)\n            m_p = 0.0\n\n        # Step 6: Check if overshoot is acceptable (Mp = 0.1)\n        overshoot_ok = (m_p = 0.1)\n        \n        # Assemble the list of results for the current case\n        case_result = [\n            m,\n            d,\n            zeta_achieved,\n            omega_n_achieved,\n            stable,\n            m_p,\n            overshoot_ok\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}