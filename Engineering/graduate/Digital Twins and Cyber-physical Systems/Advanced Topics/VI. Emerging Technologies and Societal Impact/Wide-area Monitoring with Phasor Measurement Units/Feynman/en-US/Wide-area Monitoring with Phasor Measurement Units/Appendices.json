{
    "hands_on_practices": [
        {
            "introduction": "The defining feature of a synchrophasor is its common time reference, which allows for a direct \"snapshot\" of the power grid's state. This practice delves into the fundamental relationship between time synchronization accuracy and the resulting phasor angle error, a critical parameter for system observability. By deriving the stringent timing requirements for PMUs and exploring the behavior of oscillators during a loss of GPS signal, you will gain a hands-on appreciation for the engineering challenges that underpin all wide-area monitoring applications .",
            "id": "4254055",
            "problem": "A wide-area monitoring system for electric power grids uses Phasor Measurement Units (PMUs) to estimate voltage and current phasors referenced to Coordinated Universal Time (UTC), typically provided by a Global Positioning System (GPS)-disciplined oscillator (GPSDO). Consider a nominal grid frequency of $f = 60$ Hz. The digital twin of this cyber-physical system requires that the phasor angle error due to time-synchronization imperfections remain below $1^{\\circ}$ to preserve estimation fidelity and inter-area oscillation observability. Starting from the base sinusoidal signal representation $v(t) = V \\cos(\\omega t + \\phi)$ and the definition of a phasor as the complex representation of a sinusoid at angular frequency $\\omega = 2 \\pi f$, derive the relationship between a time-synchronization error $\\Delta t$ and the resulting phasor angle error. Use this to determine the maximum allowable $\\Delta t$ such that the phasor angle error magnitude is strictly less than $1^{\\circ}$ at $f = 60$ Hz. Round your numerical result to four significant figures and express the final time error in microseconds.\n\nThen, discuss the implications of this bound for Global Positioning System-disciplined oscillators (GPSDOs) and holdover strategies in the event of GPS signal loss. In particular, model a holdover oscillator with constant fractional frequency error $\\varepsilon$ (defined by $(f_{\\text{osc}} - f)/f = \\varepsilon$), and, using first principles, derive a symbolic expression for the maximum holdover duration $\\tau_{\\max}$ that maintains the phasor angle error below $1^{\\circ}$ at frequency $f$. In your discussion, explain qualitatively how oscillator stability, environmental factors, and disciplining loop design influence $\\varepsilon$ and thus $\\tau_{\\max}$. All angles must be treated in degrees, and time errors expressed in microseconds for the numerical part of the problem. The final answer must be only the numerical value of the maximum allowable $\\Delta t$ at $f = 60$ Hz, rounded to four significant figures in microseconds.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of signal processing and power system monitoring, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe problem asks for two main derivations and one numerical calculation, followed by a qualitative discussion.\n\nFirst, we derive the relationship between a time-synchronization error $\\Delta t$ and the resulting phasor angle error. A sinusoidal voltage signal is given by $v(t) = V \\cos(\\omega t + \\phi)$, where $V$ is the peak amplitude, $\\omega = 2 \\pi f$ is the angular frequency, $f$ is the nominal system frequency, and $\\phi$ is the phase angle. The argument of the cosine function, $\\theta(t) = \\omega t + \\phi$, represents the instantaneous phase of the signal at time $t$.\n\nA phasor is a complex number that represents the amplitude and phase angle of this sinusoid. The angle of the phasor corresponds to the phase of the sinusoid at a reference time, typically $t=0$. A time-synchronization error $\\Delta t$ means that a measurement expected at time $t$ is actually taken at time $t' = t + \\Delta t$. The measured voltage is therefore:\n$$v_{\\text{meas}}(t) = v(t + \\Delta t) = V \\cos(\\omega(t + \\Delta t) + \\phi) = V \\cos(\\omega t + \\phi + \\omega \\Delta t)$$\nThe true instantaneous phase at time $t$ is $\\theta_{\\text{true}}(t) = \\omega t + \\phi$. The measured instantaneous phase, incorrectly time-stamped as $t$, is $\\theta_{\\text{meas}}(t) = \\omega t + \\phi + \\omega \\Delta t$.\nThe resulting phasor angle error, $\\Delta \\phi_{\\text{err}}$, is the difference between the measured phase and the true phase:\n$$\\Delta \\phi_{\\text{err}} = \\theta_{\\text{meas}}(t) - \\theta_{\\text{true}}(t) = (\\omega t + \\phi + \\omega \\Delta t) - (\\omega t + \\phi) = \\omega \\Delta t$$\nSubstituting $\\omega = 2 \\pi f$, we get the relationship in radians:\n$$\\Delta \\phi_{\\text{err, rad}} = 2 \\pi f \\Delta t$$\nThe problem requires the angle error to be expressed in degrees. Since $2\\pi$ radians is equivalent to $360^{\\circ}$, we convert the angle error to degrees by multiplying by $\\frac{180^{\\circ}}{\\pi}$:\n$$\\Delta \\phi_{\\text{err, deg}} = (2 \\pi f \\Delta t) \\times \\frac{180^{\\circ}}{\\pi} = 360^{\\circ} f \\Delta t$$\nThis is the fundamental relationship between the time-synchronization error $\\Delta t$ and the phasor angle error in degrees.\n\nNext, we determine the maximum allowable time error, $|\\Delta t|_{\\text{max}}$, such that the magnitude of the phasor angle error is strictly less than $1^{\\circ}$ for a nominal frequency of $f = 60 \\text{ Hz}$. The condition is $|\\Delta \\phi_{\\text{err, deg}}| < 1^{\\circ}$. Using the derived relationship:\n$$|360^{\\circ} f \\Delta t| < 1^{\\circ}$$\nSolving for the maximum magnitude of the time error, $|\\Delta t|_{\\text{max}}$, which corresponds to the boundary case where the error equals $1^{\\circ}$:\n$$|\\Delta t|_{\\text{max}} = \\frac{1^{\\circ}}{360^{\\circ} f}$$\nSubstituting the given value $f = 60 \\text{ Hz}$:\n$$|\\Delta t|_{\\text{max}} = \\frac{1}{360 \\times 60} = \\frac{1}{21600} \\text{ s}$$\nTo express this value in microseconds ($\\text{μs}$) and round to four significant figures, we perform the calculation:\n$$|\\Delta t|_{\\text{max}} = \\frac{1}{21600} \\text{ s} \\approx 4.629629... \\times 10^{-5} \\text{ s}$$\n$$|\\Delta t|_{\\text{max}} \\approx (4.629629... \\times 10^{-5}) \\times 10^{6} \\text{ μs} = 46.29629... \\text{ μs}$$\nRounding to four significant figures, we get:\n$$|\\Delta t|_{\\text{max}} \\approx 46.30 \\text{ μs}$$\nTherefore, the time synchronization accuracy must be better than $46.30 \\text{ μs}$ to ensure the phasor angle error remains below $1^{\\circ}$.\n\nThe problem then asks for a discussion on holdover strategies and a derivation for the maximum holdover duration, $\\tau_{\\max}$. Holdover mode is activated when the GPS signal, which disciplines the local oscillator of the PMU, is lost. The local oscillator then begins to free-run, and its frequency $f_{\\text{osc}}$ drifts from the nominal frequency $f$. This drift is modeled by a constant fractional frequency error $\\varepsilon$, defined as:\n$$\\varepsilon = \\frac{f_{\\text{osc}} - f}{f}$$\nThis implies that the oscillator's frequency is $f_{\\text{osc}} = f(1 + \\varepsilon)$, and its angular frequency is $\\omega_{\\text{osc}} = \\omega(1+\\varepsilon)$.\nDuring a holdover period of duration $\\tau$, the total phase accumulated by the ideal reference signal would be $\\phi_{\\text{ideal}} = \\omega \\tau$. The total phase accumulated by the drifting local oscillator is $\\phi_{\\text{osc}} = \\omega_{\\text{osc}} \\tau$.\nThe angle error that accumulates over this duration $\\tau$ is the difference between these two phases:\n$$\\Delta \\phi_{\\text{acc}}(\\tau) = \\phi_{\\text{osc}} - \\phi_{\\text{ideal}} = \\omega_{\\text{osc}}\\tau - \\omega\\tau = \\omega(1+\\varepsilon)\\tau - \\omega\\tau = \\omega\\varepsilon\\tau$$\nThis accumulated error, $\\Delta \\phi_{\\text{acc}}(\\tau)$, is the new phasor angle error. In degrees, this is:\n$$\\Delta \\phi_{\\text{acc, deg}}(\\tau) = 360^{\\circ} f \\varepsilon \\tau$$\nThe maximum holdover duration, $\\tau_{\\max}$, is the time it takes for the magnitude of this accumulated error to reach the limit of $1^{\\circ}$. Setting $|\\Delta \\phi_{\\text{acc, deg}}(\\tau_{\\max})| = 1^{\\circ}$:\n$$|360^{\\circ} f \\varepsilon \\tau_{\\max}| = 1^{\\circ}$$\nSolving for $\\tau_{\\max}$, we obtain the symbolic expression for the maximum holdover duration:\n$$\\tau_{\\max} = \\frac{1^{\\circ}}{360^{\\circ} f |\\varepsilon|}$$\nThis expression shows that $\\tau_{\\max}$ is inversely proportional to both the nominal frequency $f$ and the magnitude of the fractional frequency error $|\\varepsilon|$.\n\nFinally, the implications for GPSDOs and the factors influencing $\\varepsilon$ and $\\tau_{\\max}$ are as follows. A smaller fractional frequency error $\\varepsilon$ allows for a longer holdover time $\\tau_{\\max}$. The value of $\\varepsilon$ is determined by several factors:\n1.  **Oscillator Stability:** The intrinsic quality of the local oscillator is the primary factor. High-stability oscillators, such as Oven-Controlled Crystal Oscillators (OCXOs) or Rubidium atomic clocks, have much lower drift rates (smaller $\\varepsilon$) compared to less stable Temperature-Compensated Crystal Oscillators (TCXOs).\n2.  **Environmental Factors:** The frequency of crystal oscillators is sensitive to ambient temperature. Even in an OCXO, changes in external temperature can cause slight variations in the internal oven temperature, leading to frequency drift. Other factors like atmospheric pressure changes and mechanical vibration can also contribute to $\\varepsilon$.\n3.  **Disciplining Loop Design:** A GPSDO uses a control loop (e.g., a Phase-Locked Loop) to steer the local oscillator's frequency based on the GPS reference. A well-designed loop can \"learn\" the oscillator's systematic drift characteristics, such as aging and temperature sensitivity. Upon loss of GPS, the control system can use this learned model to predict and partly compensate for the drift, resulting in a smaller effective $\\varepsilon$ and a longer $\\tau_{\\max}$ than an oscillator with no such predictive capability. Aging, the long-term drift in an oscillator's frequency, is one such characteristic that a smart disciplining algorithm can model and extrapolate during holdover.\n\nIn summary, maintaining the stringent $<1^{\\circ}$ angle error requirement during GPS outages necessitates the use of high-performance local oscillators within a sophisticated GPSDO that can effectively model and mitigate drift during the holdover period.",
            "answer": "$$\\boxed{46.30}$$"
        },
        {
            "introduction": "While individual PMU accuracy is crucial, the true power of WAMS lies in comparing measurements from different locations. This exercise builds upon the concept of timing error by examining its impact on a vital system-level metric: the phasor angle difference between two buses, which is directly related to power flow and grid stress. You will quantify how small, independent clock offsets at different PMUs can combine to create a significant error in the calculated angle difference, demonstrating the importance of system-wide calibration and error analysis in a digital twin .",
            "id": "4254178",
            "problem": "A Phasor Measurement Unit (PMU) in a Wide-Area Monitoring System (WAMS) reports the voltage angle of a sinusoidal power system waveform relative to a common time reference provided by the Global Positioning System (GPS). Consider a digital twin of a two-bus system where bus $A$ and bus $B$ have true bus voltage phasor angles $\\theta_{A}$ and $\\theta_{B}$ with a true angle difference $\\Delta\\theta_{\\text{true}} = \\theta_{B} - \\theta_{A}$. The system frequency is nominal and constant at $f = 50\\,\\text{Hz}$. Due to a firmware anomaly, the PMU at bus $A$ has a constant time-reference offset of $\\Delta t_{A} = +100\\,\\mu\\text{s}$ (its internal time reference lags the true GPS time by $100\\,\\mu\\text{s}$), and the PMU at bus $B$ has a constant time-reference offset of $\\Delta t_{B} = -100\\,\\mu\\text{s}$ (its internal time reference leads the true GPS time by $100\\,\\mu\\text{s}$). The true inter-area angle difference is $\\Delta\\theta_{\\text{true}} = 0.30\\,\\text{rad}$.\n\nStarting only from the sinusoidal waveform model of a bus voltage $v(t) = V\\cos(\\omega t + \\phi)$ and the definition of a phasor angle as the phase of this sinusoid referenced to the global time $t$, derive the expression for the PMU-reported phase bias induced by a constant time-reference offset. Then, compute the numeric value of the PMU-reported angle difference $\\Delta\\theta_{\\text{meas}}$ between bus $B$ and bus $A$ under the given offsets. Provide your final numeric answer in radians and round it to four significant figures.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of alternating current circuits and phasor measurement, well-posed with sufficient information for a unique solution, and stated objectively. We may proceed with the solution.\n\nThe problem asks for two things: first, to derive the expression for the phase bias in a Phasor Measurement Unit (PMU) caused by a constant time-reference offset; and second, to compute the measured angle difference between two buses given specific time offsets.\n\nLet us begin with the first part. The instantaneous voltage at a bus is given by the sinusoidal waveform model:\n$$v(t) = V\\cos(\\omega t + \\phi_{\\text{true}})$$\nwhere $V$ is the voltage magnitude, $\\omega$ is the angular frequency, $t$ is the common, absolute time reference (e.g., from GPS), and $\\phi_{\\text{true}}$ is the true phase angle of the waveform with respect to this time reference.\n\nA PMU with a time-reference offset, $\\Delta t$, does not use the true time $t$. Instead, it operates on its own local time, $t_{\\text{pmu}}$, which is offset from the true time. The problem defines $\\Delta t$ such that a positive value means the PMU's clock lags the true time. This relationship can be expressed as:\n$$t_{\\text{pmu}} = t - \\Delta t$$\nTo determine the phase angle measured by the PMU, we must express the true voltage waveform, $v(t)$, in terms of the PMU's local time reference, $t_{\\text{pmu}}$. From the relationship above, the true time $t$ can be written as $t = t_{\\text{pmu}} + \\Delta t$. Substituting this into the voltage equation:\n$$v(t) = V\\cos(\\omega (t_{\\text{pmu}} + \\Delta t) + \\phi_{\\text{true}})$$\nDistributing the angular frequency $\\omega$:\n$$v(t) = V\\cos(\\omega t_{\\text{pmu}} + \\omega \\Delta t + \\phi_{\\text{true}})$$\nThe PMU analyzes this signal based on its own time axis, $t_{\\text{pmu}}$. The standard form the PMU expects is $V_{\\text{meas}}\\cos(\\omega t_{\\text{pmu}} + \\phi_{\\text{meas}})$. By comparing this expected form with the re-expressed voltage signal, we can identify the measured phase angle, $\\phi_{\\text{meas}}$, as the total phase shift that is not dependent on $t_{\\text{pmu}}$:\n$$\\phi_{\\text{meas}} = \\phi_{\\text{true}} + \\omega \\Delta t$$\nThe phase bias, or phase error, $\\Delta \\phi_{\\text{error}}$, is the difference between the measured angle and the true angle:\n$$\\Delta \\phi_{\\text{error}} = \\phi_{\\text{meas}} - \\phi_{\\text{true}} = (\\phi_{\\text{true}} + \\omega \\Delta t) - \\phi_{\\text{true}}$$\n$$\\Delta \\phi_{\\text{error}} = \\omega \\Delta t$$\nSince the angular frequency $\\omega$ is related to the system frequency $f$ by $\\omega = 2\\pi f$, the expression for the phase bias is:\n$$\\Delta \\phi_{\\text{error}} = 2\\pi f \\Delta t$$\nThis completes the first part of the problem. A positive time offset $\\Delta t$ (lagging clock) results in a positive phase error, meaning the measured phasor appears advanced in phase. Conversely, a negative time offset (leading clock) results in a negative phase error, where the measured phasor appears retarded in phase.\n\nNow, we proceed to the second part: computing the numeric value of the PMU-reported angle difference, $\\Delta\\theta_{\\text{meas}}$, between bus $B$ and bus $A$.\n\nLet $\\theta_{A}$ and $\\theta_{B}$ be the true phasor angles at bus $A$ and bus $B$, respectively.\nThe measured angle at bus $A$, $\\theta_{A, \\text{meas}}$, is the true angle plus the bias caused by its time offset, $\\Delta t_{A}$:\n$$\\theta_{A, \\text{meas}} = \\theta_{A} + \\omega \\Delta t_{A}$$\nSimilarly, the measured angle at bus $B$, $\\theta_{B, \\text{meas}}$, is:\n$$\\theta_{B, \\text{meas}} = \\theta_{B} + \\omega \\Delta t_{B}$$\nThe reported angle difference, $\\Delta\\theta_{\\text{meas}}$, is the difference between the measured angles:\n$$\\Delta\\theta_{\\text{meas}} = \\theta_{B, \\text{meas}} - \\theta_{A, \\text{meas}}$$\nSubstituting the expressions for the measured angles:\n$$\\Delta\\theta_{\\text{meas}} = (\\theta_{B} + \\omega \\Delta t_{B}) - (\\theta_{A} + \\omega \\Delta t_{A})$$\nRearranging the terms, we group the true angles and the error terms:\n$$\\Delta\\theta_{\\text{meas}} = (\\theta_{B} - \\theta_{A}) + \\omega (\\Delta t_{B} - \\Delta t_{A})$$\nThe term $(\\theta_{B} - \\theta_{A})$ is the true angle difference, given as $\\Delta\\theta_{\\text{true}}$.\n$$\\Delta\\theta_{\\text{meas}} = \\Delta\\theta_{\\text{true}} + \\omega (\\Delta t_{B} - \\Delta t_{A})$$\nWe are given the following values:\nSystem frequency, $f = 50\\,\\text{Hz}$.\nTrue angle difference, $\\Delta\\theta_{\\text{true}} = 0.30\\,\\text{rad}$.\nTime offset at bus $A$, $\\Delta t_{A} = +100\\,\\mu\\text{s} = +100 \\times 10^{-6}\\,\\text{s}$.\nTime offset at bus $B$, $\\Delta t_{B} = -100\\,\\mu\\text{s} = -100 \\times 10^{-6}\\,\\text{s}$.\n\nFirst, calculate the angular frequency $\\omega$:\n$$\\omega = 2\\pi f = 2 \\pi (50) = 100\\pi\\,\\text{rad/s}$$\nNext, calculate the difference in time offsets:\n$$\\Delta t_{B} - \\Delta t_{A} = (-100 \\times 10^{-6}\\,\\text{s}) - (100 \\times 10^{-6}\\,\\text{s}) = -200 \\times 10^{-6}\\,\\text{s} = -2 \\times 10^{-4}\\,\\text{s}$$\nNow, we can compute the total phase error introduced into the angle difference calculation:\n$$\\omega (\\Delta t_{B} - \\Delta t_{A}) = (100\\pi\\,\\text{rad/s}) \\times (-2 \\times 10^{-4}\\,\\text{s}) = -200\\pi \\times 10^{-4}\\,\\text{rad} = -0.02\\pi\\,\\text{rad}$$\nFinally, we compute the measured angle difference $\\Delta\\theta_{\\text{meas}}$:\n$$\\Delta\\theta_{\\text{meas}} = \\Delta\\theta_{\\text{true}} + \\omega (\\Delta t_{B} - \\Delta t_{A}) = 0.30 - 0.02\\pi\\,\\text{rad}$$\nTo obtain the numeric value, we use the value of $\\pi \\approx 3.14159265$:\n$$\\Delta\\theta_{\\text{meas}} \\approx 0.30 - 0.02 \\times 3.14159265$$\n$$\\Delta\\theta_{\\text{meas}} \\approx 0.30 - 0.06283185$$\n$$\\Delta\\theta_{\\text{meas}} \\approx 0.23716815\\,\\text{rad}$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $2$, $3$, $7$, and $1$. The next digit is $6$, so we round up the last significant figure.\n$$\\Delta\\theta_{\\text{meas}} \\approx 0.2372\\,\\text{rad}$$",
            "answer": "$$\\boxed{0.2372}$$"
        },
        {
            "introduction": "Moving from the performance of individual units to the architecture of the entire network, this practice addresses a core economic and logistical challenge in deploying a WAMS. Since installing a PMU at every bus is often infeasible, we must strategically select locations to achieve full grid observability at minimum cost. This exercise introduces you to the optimal PMU placement problem, framing it as a classic graph theory challenge, and asks you to formulate it as a mixed-integer optimization problem—a powerful technique used in the design of large-scale cyber-physical systems .",
            "id": "4254183",
            "problem": "You are designing the sensing layer of a Digital Twin (DT) for a Cyber-Physical System (CPS) of an electric power transmission network with a Wide-Area Monitoring System (WAMS). The sensing devices are Phasor Measurement Units (PMU), which, when installed at a bus, measure the complex voltage phasor at that bus and the current phasors of all incident lines. Using Ohm’s law, the voltage phasors of directly connected neighboring buses can be inferred from these measurements when line parameters are known. Assume no special zero-injection deductions are employed and no measurement errors; observability is purely topological: a PMU at bus $i$ observes bus $i$ and all buses $j$ such that there exists an edge $(i,j)$.\n\nStarting from these foundational measurement principles, derive a mixed-integer optimization that minimizes the number of PMUs while guaranteeing full bus observability. Use the following definitions:\n- Let the network be an undirected graph $\\mathcal{G}=(\\mathcal{V},\\mathcal{E})$ with $|\\mathcal{V}|=n$, where buses are indexed by $i\\in\\{1,\\ldots,n\\}$.\n- Let $A\\in\\{0,1\\}^{n\\times n}$ be the symmetric adjacency matrix with $a_{ij}=1$ if $(i,j)\\in\\mathcal{E}$ and $a_{ij}=0$ otherwise, and $a_{ii}=0$ for all $i$.\n- Let $x_i\\in\\{0,1\\}$ be a binary decision variable indicating whether a PMU is installed at bus $i$.\n- Let $\\mathcal{N}[i]=\\{i\\}\\cup\\{j\\mid a_{ij}=1\\}$ denote the closed neighborhood of bus $i$.\n\nFormulate the optimization problem to minimize $\\sum_{i=1}^{n} x_i$ subject to full bus observability requirements derived from the measurement principles and graph topology. Then, compute the solution for the following $n=6$ bus test suite. Each test case is specified by its edge set and corresponding adjacency matrix $A$:\n\n- Case $1$ (path): $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,6)\\}$. This is a single path of length $5$.\n- Case $2$ (ring): $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$. This is a cycle of length $6$.\n- Case $3$ (disconnected star plus pair): $\\mathcal{E}=\\{(1,2),(1,3),(1,4),(5,6)\\}$. This is a $4$-bus star centered at bus $1$ and a separate $2$-bus component.\n\nFor each case, compute one optimal PMU placement set that achieves full observability while minimizing the total number of PMUs. There are no physical units to report. Angles are not directly computed; thus no angle unit is required. Express each test case’s answer as a list of bus indices (using $1$-based indexing) where PMUs are installed.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of bus indices for the corresponding test case, for example, $[[b_{1,1},b_{1,2}], [b_{2,1}], [b_{3,1},b_{3,2}]]$.\n\nThe required outputs for each test case must be a list of integers, and the aggregate output must be a list of these lists on a single line. Design your algorithm so that it is correct for general $n$ but demonstrate it on the provided $n=6$ cases. Ensure the solution is deterministic in case of ties by returning the lexicographically smallest placement among all optimal solutions.",
            "solution": "The problem statement is evaluated as valid. It presents a well-posed optimization problem grounded in a standard model used in power systems engineering for wide-area monitoring. The problem is self-contained, objective, and its components are formally defined. The task is to formulate the Phasor Measurement Unit (PMU) placement problem as a mixed-integer optimization and then solve it for three specific graph topologies. The problem is equivalent to finding a minimum dominating set on an undirected graph, a classic problem in graph theory and combinatorial optimization.\n\nThe problem can be formulated as a mixed-integer linear program (MILP). Let $\\mathcal{G}=(\\mathcal{V},\\mathcal{E})$ be the graph representing the power network, with $\\mathcal{V} = \\{1, 2, \\ldots, n\\}$ being the set of buses. Let $x_i$ be a binary decision variable such that $x_i=1$ if a PMU is installed at bus $i$, and $x_i=0$ otherwise.\n\nThe objective is to minimize the total number of installed PMUs. This is expressed as the objective function:\n$$\n\\text{Minimize} \\quad \\sum_{i=1}^{n} x_i\n$$\n\nThe core constraint is that every bus in the network must be observable. According to the problem statement, a PMU at bus $i$ makes bus $i$ and all its directly connected neighbors observable. The set of buses observed by a PMU at bus $i$ is its closed neighborhood, $\\mathcal{N}[i] = \\{i\\} \\cup \\{j \\mid (i,j) \\in \\mathcal{E}\\}$. For any given bus $j \\in \\mathcal{V}$ to be observable, at least one PMU must be placed in its closed neighborhood $\\mathcal{N}[j]$. This constraint can be written for each bus $j \\in \\mathcal{V}$ as:\n$$\n\\sum_{i \\in \\mathcal{N}[j]} x_i \\geq 1\n$$\n\nThe complete MILP formulation is therefore:\n$$\n\\begin{align*}\n\\text{Minimize} & \\quad Z = \\sum_{i=1}^{n} x_i \\\\\n\\text{subject to} & \\quad \\sum_{i \\in \\mathcal{N}[j]} x_i \\geq 1, \\quad \\forall j \\in \\{1, \\ldots, n\\} \\\\\n& \\quad x_i \\in \\{0, 1\\}, \\quad \\forall i \\in \\{1, \\ldots, n\\}\n\\end{align*}\n$$\nThis formulation correctly captures the requirements for finding a minimum dominating set.\n\nFor the small size of the test cases ($n=6$), solving this MILP can be accomplished by an exhaustive search. The algorithm proceeds by checking for a valid dominating set, starting with the smallest possible size. We iterate the size of the PMU placement set, $k$, from $1$ to $n$. For each $k$, we generate all possible combinations of $k$ buses. To satisfy the tie-breaking rule of selecting the lexicographically smallest solution, these combinations must be generated in lexicographical order. The first combination that is found to be a dominating set is guaranteed to be of minimum size and to be the lexicographically smallest among all solutions of that size. A set of PMU locations $S \\subseteq \\mathcal{V}$ is a dominating set if $\\bigcup_{i \\in S} \\mathcal{N}[i] = \\mathcal{V}$.\n\n**Case 1: Path Graph**\nThe graph has $n=6$ buses and edges $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,6)\\}$. We seek the minimum number of PMUs.\n- For $k=1$: No single PMU can observe all $6$ buses. For instance, a PMU at bus $3$ observes buses $\\{2,3,4\\}$, leaving $\\{1,5,6\\}$ unobserved.\n- For $k=2$: We check combinations of $2$ PMUs in lexicographical order.\n  - Placement $\\{1,2\\}$: Observes $\\mathcal{N}[1] \\cup \\mathcal{N}[2] = \\{1,2\\} \\cup \\{1,2,3\\} = \\{1,2,3\\}$. Fails.\n  - ...\n  - Placement $\\{2,5\\}$: Observes $\\mathcal{N}[2] \\cup \\mathcal{N}[5] = \\{1,2,3\\} \\cup \\{4,5,6\\} = \\{1,2,3,4,5,6\\}$. This is a valid dominating set.\nSince we started with the smallest possible size ($k=2$) and iterated through combinations lexicographically, $\\{2,5\\}$ is a minimal and lexicographically smallest solution.\nThe optimal placement is at buses $2$ and $5$.\n\n**Case 2: Ring Graph**\nThe graph has $n=6$ buses and edges $\\mathcal{E}=\\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$. A PMU at any bus $i$ observes a set of $3$ buses. To cover $6$ buses, a minimum of $\\lceil 6/3 \\rceil = 2$ PMUs are required.\n- For $k=1$: Fails, as any single PMU observes only $3$ buses.\n- For $k=2$: We check combinations of $2$ PMUs in lexicographical order.\n  - Placement $\\{1,2\\}$: Observes $\\mathcal{N}[1] \\cup \\mathcal{N}[2] = \\{6,1,2\\} \\cup \\{1,2,3\\} = \\{1,2,3,6\\}$. Fails.\n  - Placement $\\{1,3\\}$: Observes $\\mathcal{N}[1] \\cup \\mathcal{N}[3] = \\{6,1,2\\} \\cup \\{2,3,4\\} = \\{1,2,3,4,6\\}$. Fails.\n  - Placement $\\{1,4\\}$: Observes $\\mathcal{N}[1] \\cup \\mathcal{N}[4] = \\{6,1,2\\} \\cup \\{3,4,5\\} = \\{1,2,3,4,5,6\\}$. This is a valid dominating set.\nThis is the first valid solution found for $k=2$. Thus, the lexicographically smallest optimal placement is at buses $1$ and $4$. Other solutions of size $2$ exist, such as $\\{2,5\\}$ and $\\{3,6\\}$, but $\\{1,4\\}$ is lexicographically smallest.\n\n**Case 3: Disconnected Graph**\nThe graph has two connected components. The PMU placement problem can be solved for each component independently.\n- Component 1: A star graph on buses $\\{1,2,3,4\\}$ with center $1$.\n  - To observe this component, we can place one PMU at the center, bus $1$. This observes $\\mathcal{N}[1]=\\{1,2,3,4\\}$, covering the entire component. This is a minimal solution of size $1$ for this component.\n- Component 2: A path graph on buses $\\{5,6\\}$.\n  - To observe this component, we can place one PMU at either bus $5$ or bus $6$. Placing at $5$ observes $\\mathcal{N}[5]=\\{5,6\\}$. Placing at $6$ observes $\\mathcal{N}[6]=\\{5,6\\}$. Both are minimal solutions of size $1$.\nTo observe the entire graph, we combine the solutions. The minimum total number of PMUs is $1+1=2$.\nThe placement for Component 1 is $\\{1\\}$. The possible placements for Component 2 are $\\{5\\}$ or $\\{6\\}$.\nThis yields two possible optimal placements for the whole graph: $\\{1,5\\}$ and $\\{1,6\\}$.\nTo adhere to the tie-breaking rule, we must choose the lexicographically smallest set. Comparing $\\{1,5\\}$ and $\\{1,6\\}$, the set $\\{1,5\\}$ is lexicographically smaller.\nThe optimal placement is at buses $1$ and $5$.",
            "answer": "```python\nimport numpy as np\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Solves the PMU placement problem for a series of test cases.\n    The problem is equivalent to finding the minimum dominating set in a graph.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: Path graph\n        {'n': 6, 'edges': [(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)]},\n        # Case 2: Ring graph\n        {'n': 6, 'edges': [(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 1)]},\n        # Case 3: Disconnected star plus pair\n        {'n': 6, 'edges': [(1, 2), (1, 3), (1, 4), (5, 6)]}\n    ]\n\n    results = []\n    for case in test_cases:\n        n = case['n']\n        edges = case['edges']\n        solution = find_min_lex_dominating_set(n, edges)\n        results.append(solution)\n    \n    # The final output format requires lists of integers, which the default\n    # string representation of a list in Python provides.\n    # e.g., str([1, 4]) becomes '[1, 4]'\n    # The outer list is then joined by commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_min_lex_dominating_set(n, edges):\n    \"\"\"\n    Finds the lexicographically smallest minimum dominating set for a given graph.\n\n    Args:\n        n (int): The number of vertices (buses), indexed 1 to n.\n        edges (list of tuples): The set of edges in the graph.\n\n    Returns:\n        list: A sorted list of 1-based bus indices for the optimal PMU placement.\n    \"\"\"\n    # Internally, we use 0-based indexing for convenience (0 to n-1).\n    num_buses = n\n    all_buses = set(range(num_buses))\n\n    # Build adjacency list from edge set.\n    adj = [set() for _ in range(num_buses)]\n    for u, v in edges:\n        adj[u - 1].add(v - 1)\n        adj[v - 1].add(u - 1)\n\n    # Pre-calculate the set of buses observed by a PMU at each location.\n    # This is the closed neighborhood of each bus.\n    observed_by = []\n    for i in range(num_buses):\n        observed_by.append({i} | adj[i])\n\n    # Iterate through the number of PMUs, k, from 1 to n.\n    for k in range(1, num_buses + 1):\n        # Generate all combinations of k PMU placements.\n        # itertools.combinations generates tuples in lexicographical order.\n        for pmu_placement in combinations(range(num_buses), k):\n            observed_buses_union = set()\n            for pmu_index in pmu_placement:\n                observed_buses_union.update(observed_by[pmu_index])\n\n            # Check if this placement covers all buses.\n            if observed_buses_union == all_buses:\n                # Since we iterate on k and combinations are ordered,\n                # the first solution found is the minimal, lexicographically\n                # smallest one.\n                # Convert 0-based indices back to 1-based bus numbers for the output.\n                return [bus_idx + 1 for bus_idx in pmu_placement]\n    \n    # This part of the code should be unreachable for a valid graph.\n    return []\n\nsolve()\n```"
        }
    ]
}