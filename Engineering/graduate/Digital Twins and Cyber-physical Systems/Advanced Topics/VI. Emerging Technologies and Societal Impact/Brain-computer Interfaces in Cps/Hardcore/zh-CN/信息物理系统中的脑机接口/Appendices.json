{
    "hands_on_practices": [
        {
            "introduction": "任何成功的脑机接口（BCI）系统的基石都是高质量的信号采集。然而，在现实世界的应用中，诸如头部运动等物理伪影可能会严重污染脑电（EEG）信号，从而影响解码性能。这项练习引导我们通过一个实际模型，量化运动如何通过放大器偏置电流和变化的电极阻抗之间的相互作用转化为电气噪声，从而帮助我们理解硬件规格和实际操作的重要性 。",
            "id": "3966676",
            "problem": "一个使用脑电图（EEG）的脑机接口（BCI）系统记录了两个活动通道，这两个通道参考于一个单一的硬件参考电极。每个电极-皮肤界面被建模为一个戴维南源，该源由一个局部界面（半电池）电位 $E_{k}(t)$ 与一个接触阻抗 $Z_{k}(t)$ 串联组成，其中 $k \\in \\{a,r\\}$，$a$ 表示活动通道，$r$ 表示参考电极。仪表放大器具有非常高的输入阻抗，但会从每个输入端吸取一个大小为 $i_{b}$ 的恒定输入偏置电流。头部运动会在接触阻抗和参考半电池电位中引起微小的正弦调制。假设如下：\n\n- 放大器测量差分输入 $V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$，其中 $V_{k}(t)$ 是电极 $k$ 在放大器输入端的电极电位。\n- 放大器输入偏置电流的大小为 $i_{b}$，对于 $a$ 和 $r$ 两个电极，电流都从电极流入放大器输入端。\n- 基线阻抗为 $Z_{a,0}$ 和 $Z_{r,0}$，伴有由运动引起的微小变化 $\\delta Z_{a}(t)$ 和 $\\delta Z_{r}(t)$，使得 $Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$ 且 $|\\delta Z_{k}(t)| \\ll Z_{k,0}$。\n- 参考电极处的界面电位有一个运动引起的分量 $\\delta E_{r}(t)$；与 $\\delta E_{r}(t)$ 相比，$E_{a}(t)$ 中任何由运动引起的变化都可以忽略不计。\n- 仪表放大器的输入阻抗足够高，以至于与偏置电流相比，所有其他电流都可以忽略不计，并且头皮被视为驱动串联 $E_{k}(t)$ 和 $Z_{k}(t)$ 元件的局部节点。\n\n从基尔霍夫电流定律（KCL）和欧姆定律出发，推导由头部运动引起的差分伪影分量，并用给定物理量表示其在 $a$ 参考通道中的振幅。然后，使用下面给出的具体参数值，计算 $a$ 参考通道中污染的数值振幅：\n\n- $i_{b} = 220 \\,\\mathrm{pA}$，\n- $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$，其中 $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$，\n- $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$，其中 $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$，\n- $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$，其中 $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$，\n\n并忽略所有神经信号 $E_{a}(t)$ 和基线偏移。将正弦调制视为在角频率 $\\omega$ 处同相，并假设线性叠加成立。以微伏为单位表示最终的污染振幅，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其具有科学依据、问题明确且客观。\n\n### 步骤 1：提取已知条件\n-   系统：一个使用脑电图（EEG）的脑机接口（BCI）。\n-   测量配置：一个活动通道（$a$）和一个参考电极（$r$）。\n-   电极模型：每个电极 $k \\in \\{a,r\\}$ 的戴维南源，由一个半电池电位 $E_{k}(t)$ 与一个接触阻抗 $Z_{k}(t)$ 串联而成。\n-   放大器测量：$V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$，其中 $V_{k}(t)$ 是放大器输入端的电位。\n-   放大器输入偏置电流：大小为 $i_{b}$ 的恒定电流从每个电极流入相应的放大器输入端。\n-   阻抗模型：$Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$，其中 $Z_{k,0}$ 是基线阻抗，$\\delta Z_{k}(t)$ 是由运动引起的微小变化，满足 $|\\delta Z_{k}(t)| \\ll Z_{k,0}$。\n-   电位模型：$E_{a}(t)$ 中由运动引起的变化可以忽略不计。参考电位有一个运动引起的分量 $\\delta E_{r}(t)$。\n-   假设：\n    1.  仪表放大器输入阻抗实际上是无限大的。\n    2.  对于每个电极的戴维南模型，头皮是一个局部节点。\n    3.  忽略所有神经信号（$E_{a}(t)$）和基线电位偏移。\n    4.  线性叠加原理适用。\n-   任务：\n    1.  推导由头部运动引起的差分伪影分量。\n    2.  使用提供的参数计算此污染的数值振幅。\n-   参数值：\n    -   $i_{b} = 220 \\,\\mathrm{pA}$\n    -   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$，其中 $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$\n    -   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$，其中 $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$\n    -   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$，其中 $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$\n-   最终要求：以微伏为单位表示污染振幅，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：**该问题很好地基于生物电位测量和电气工程的原理。电极-皮肤界面的戴维南模型、放大器偏置电流的概念，以及运动伪影调制阻抗和电位，这些都是脑电图和脑机接口设计中的标准且现实的概念。\n-   **问题明确性：**该问题提供了一个清晰的物理模型，定义了所有变量，并指定了足够的假设和参数，以得出一个唯一的数值解。\n-   **客观性：**该问题以精确、客观和技术的术语陈述。\n-   **结论：**该问题被认为是有效的，因为它在科学上是合理的，内容是自洽的，并且问题是明确的。\n\n### 步骤 3：结论与行动\n问题有效。推导详细解法。\n\n### 推导\n每个电极在仪表放大器输入端的电位 $V_{k}(t)$ 可以通过将欧姆定律应用于电极-皮肤界面模型来确定。放大器从电极吸取偏置电流 $i_{b}$。根据问题描述，该电流从电极流入放大器。这意味着电流从生理源流出，经过串联阻抗 $Z_k(t)$，到达放大器输入端。因此，放大器输入端的电位 $V_k(t)$ 是源电位 $E_k(t)$ 减去阻抗 $Z_k(t)$ 上的电压降。\n\n对于活动电极（$k=a$）：\n$$V_{a}(t) = E_{a}(t) - i_{b} Z_{a}(t)$$\n对于参考电极（$k=r$）：\n$$V_{r}(t) = E_{r}(t) - i_{b} Z_{r}(t)$$\n\n仪表放大器测量差分电压 $V_{\\text{diff}}(t)$：\n$$V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$$\n代入 $V_{a}(t)$ 和 $V_{r}(t)$ 的表达式：\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - i_{b} Z_{a}(t) \\right) - \\left( E_{r}(t) - i_{b} Z_{r}(t) \\right)$$\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - E_{r}(t) \\right) - i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$$\n\n该表达式包含两个主要部分：真实的差分生理信号 $\\left( E_{a}(t) - E_{r}(t) \\right)$，以及一个伪影项 $-i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$，该伪影项是由偏置电流流经不匹配的阻抗引起的。\n\n我们被要求找出由头部运动引起的伪影分量，同时忽略神经信号和基线偏移。我们应用给定的假设：\n-   忽略活动电极的神经信号：$E_{a}(t) = 0$。\n-   参考电位仅包含运动引起的分量：$E_{r}(t) = \\delta E_{r}(t)$。\n-   阻抗由基线分量和运动引起的分量组成：$Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$。\n\n将这些代入 $V_{\\text{diff}}(t)$ 的表达式中：\n$$V_{\\text{diff}}(t) = (0 - \\delta E_{r}(t)) - i_{b} \\left( (Z_{a,0} + \\delta Z_{a}(t)) - (Z_{r,0} + \\delta Z_{r}(t)) \\right)$$\n$$V_{\\text{diff}}(t) = -\\delta E_{r}(t) - i_{b} \\left( Z_{a,0} - Z_{r,0} \\right) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\n\n项 $-i_{b}(Z_{a,0} - Z_{r,0})$ 是一个恒定的直流偏移伪影。问题要求的是*由头部运动引起的差分伪影分量*，这指的是时变分量。我们将此运动伪影表示为 $V_{\\text{artifact}}(t)$：\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\n这可以改写为：\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) + i_{b} \\left( \\delta Z_{r}(t) - \\delta Z_{a}(t) \\right)$$\n\n现在，我们代入给定的由运动引起的变化的正弦形式：\n-   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$\n-   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$\n-   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$\n\n$$V_{\\text{artifact}}(t) = -\\Delta E_{r} \\cos(\\omega t) + i_{b} \\left( \\Delta Z_{r} \\cos(\\omega t) - \\Delta Z_{a} \\cos(\\omega t) \\right)$$\n由于所有调制都是同相的，我们可以提出因子 $\\cos(\\omega t)$：\n$$V_{\\text{artifact}}(t) = \\left[ -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right] \\cos(\\omega t)$$\n\n这个正弦伪影的振幅，我们称之为 $A_{\\text{artifact}}$，是余弦项系数的绝对值：\n$$A_{\\text{artifact}} = \\left| -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right|$$\n\n现在，我们使用提供的参数计算数值。首先，我们将所有值转换为国际单位制（SI）基本单位（伏特、安培、欧姆）。\n-   $i_{b} = 220 \\,\\mathrm{pA} = 220 \\times 10^{-12} \\,\\mathrm{A}$\n-   $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega = 2.4 \\times 10^{3} \\,\\Omega$\n-   $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega = 3.7 \\times 10^{3} \\,\\Omega$\n-   $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V} = 7.6 \\times 10^{-6} \\,\\mathrm{V}$\n\n首先，计算与阻抗相关的电压项：\n$$\\Delta Z_{r} - \\Delta Z_{a} = (3.7 \\times 10^{3} - 2.4 \\times 10^{3}) \\,\\Omega = 1.3 \\times 10^{3} \\,\\Omega$$\n$$i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) = (220 \\times 10^{-12} \\,\\mathrm{A}) \\times (1.3 \\times 10^{3} \\,\\Omega) = 286 \\times 10^{-9} \\,\\mathrm{V} = 0.286 \\times 10^{-6} \\,\\mathrm{V}$$\n\n现在，将此代入振幅表达式：\n$$A_{\\text{artifact}} = \\left| -(7.6 \\times 10^{-6} \\,\\mathrm{V}) + (0.286 \\times 10^{-6} \\,\\mathrm{V}) \\right|$$\n$$A_{\\text{artifact}} = \\left| ( -7.6 + 0.286 ) \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = \\left| -7.314 \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = 7.314 \\times 10^{-6} \\,\\mathrm{V}$$\n\n问题要求答案以微伏（$\\mu\\mathrm{V}$）为单位。\n$$A_{\\text{artifact}} = 7.314 \\,\\mu\\mathrm{V}$$\n该值已经表示为四位有效数字。",
            "answer": "$$\\boxed{7.314}$$"
        },
        {
            "introduction": "许多非侵入式BCI系统依赖于解码大脑节律性活动（即神经振荡）中蕴含的信息。为了可靠地实现这一点，我们需要精确的数学工具来定义和测量这些振荡的特性，尤其是它们在不同大脑区域间的同步性。这项练习聚焦于通过希尔伯特变换构建解析信号，以定义瞬时振幅和相位，并辨析锁相值（PLV）和相干性这两种关键同步性度量之间的差异 。",
            "id": "3966633",
            "problem": "一个脑机接口（BCI）解码器被设计用于利用通过脑电图（EEG）记录的振荡性神经活动中的同步性。两个零均值、实值的皮层时间序列，表示为 $x_1(t)$ 和 $x_2(t)$，已经通过带通滤波以分离出感兴趣的窄带节律（例如，感觉运动μ节律）。该解码器必须为每个信号使用有原则的瞬时相位、振幅和频率的定义，并且必须选择一个合适的同步性度量指标。工程团队正在考虑两类同步性测量方法：一类是基于跨时间或试验的相位差的循环统计，另一类是基于频域中的交叉谱分析。\n\n选择唯一一个选项，该选项同时：从标准信号表示原理出发，为窄带实值神经振荡提供了瞬时相位、振幅和频率的正确且完整的定义；并且正确地区分了锁相值（PLV）和幅值平方相干性，阐明了它们各自量化什么以及振幅如何起作用。\n\nA. 对于一个实值窄带信号 $x(t)$，定义解析信号 $z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$，其中 $\\mathcal{H}\\{\\cdot\\}$ 表示希尔伯特变换。瞬时振幅是 $A(t) = |z(t)|$，瞬时相位是 $\\phi(t) = \\arg\\big(z(t)\\big)$，瞬时频率是 $f(t) = \\frac{1}{2\\pi}\\,\\frac{d\\phi(t)}{dt}$。具有相位 $\\phi_1(t)$ 和 $\\phi_2(t)$ 的两个信号之间的锁相值（PLV）是 $\\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$，它在时间或试验上计算，量化了相位一致性且与振幅无关。在频率 $f_0$ 处的幅值平方相干性是 $C_{12}(f_0) = \\frac{\\left|S_{12}(f_0)\\right|^2}{S_{11}(f_0)\\,S_{22}(f_0)}$，其中 $S_{12}(f)$ 是交叉谱密度，$S_{11}(f)$、$S_{22}(f)$ 是自谱密度；相干性反映了在 $f_0$ 处的线性耦合，包含振幅协变，并对容积传导敏感。\n\nB. 对于一个实值信号 $x(t)$，瞬时相位是 $\\phi(t) = \\arctan\\!\\left(\\frac{dx(t)/dt}{x(t)}\\right)$，瞬时振幅是 $A(t) = x(t)$，瞬时频率是 $f(t) = 2\\pi\\,\\phi(t)$。PLV 等于 $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$，而相干性等于两个带通滤波后的时间序列随时间变化的皮尔逊相关系数。\n\nC. 对于一个平稳振荡，相位 $\\phi(t)$ 取为傅里叶变换 $X(f)$ 在中心频率 $f_0$ 处的幅角乘以 $t$，振幅是 $A = \\sqrt{\\mathrm{PSD}(f_0)}$，瞬时频率是 $f(t) = \\frac{d}{dt}\\,|x(t)|$。对于足够窄带的信号，PLV 与相干性相同，因为两者都测量在 $f_0$ 处的同步性。\n\nD. 对于一个窄带信号 $x(t)$，振幅是 $A(t) = \\mathcal{H}\\{x(t)\\}$，相位是 $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$，瞬时频率是 $f(t) = \\frac{d\\phi(t)}{dt}$。PLV 忽略振幅，在相位差均匀分布时等于零，而相干性仅测量相位同步性，并且对振幅差异不敏感。\n\nE. 对于一个窄带信号 $x(t)$，定义复包络 $z(t) = x(t) + i\\,x(t)$，其振幅为 $A(t) = \\operatorname{Re}\\{z(t)\\}$，相位为 $\\phi(t) = \\operatorname{Im}\\{z(t)\\}$。瞬时频率是 $f(t) = \\frac{1}{2\\pi}\\,\\frac{dA(t)}{dt}$。PLV 是跨时间的 $\\left\\langle \\left|\\phi_1(t)-\\phi_2(t)\\right|\\right\\rangle$，而相干性是零延迟下的互相关，并用标准差的乘积进行归一化。",
            "solution": "该问题要求选择一个选项，该选项既能为瞬时信号参数（振幅、相位、频率）提供一组正确且完整的定义，又能正确地区分锁相值（PLV）与幅值平方相干性。对问题陈述的验证证实了其科学上的合理性和问题的适定性。现在我将对每个选项进行详细评估。\n\n为实值窄带信号 $x(t)$ 定义瞬时参数的标准且最符合原理的方法是通过构建解析信号。\n1. 计算信号 $x(t)$ 的希尔伯特变换，$\\mathcal{H}\\{x(t)\\}$。\n2. 形成解析信号 $z(t)$，它是一个复值时间序列：\n$$z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$$\n3. 这个复信号可以用极坐标表示为 $z(t) = A(t)e^{i\\phi(t)}$。\n4. 根据此表示，瞬时参数定义如下：\n   - 瞬时振幅: $A(t) = |z(t)| = \\sqrt{x(t)^2 + (\\mathcal{H}\\{x(t)\\})^2}$\n   - 瞬时相位: $\\phi(t) = \\arg(z(t))$\n   - 瞬时角频率: $\\omega(t) = \\frac{d\\phi(t)}{dt}$\n   - 瞬时频率: $f(t) = \\frac{1}{2\\pi}\\frac{d\\phi(t)}{dt}$\n\n接下来，我们必须考虑这两种同步性度量的定义和属性。\n- **锁相值 (PLV):** 对于具有瞬时相位 $\\phi_1(t)$ 和 $\\phi_2(t)$ 的两个信号，PLV 测量它们的相位差 $\\Delta\\phi(t) = \\phi_1(t) - \\phi_2(t)$ 在一组 $N$ 个观测（时间点或试验）上的一致性。它被定义为单位圆上相位差的平均合向量的模长：\n$$\\text{PLV} = \\left| \\frac{1}{N} \\sum_{k=1}^{N} e^{i\\Delta\\phi(t_k)} \\right| = \\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$$\nPLV 的范围从 $0$（对于均匀分布的相位差）到 $1$（对于恒定的相位差）。根据其使用单位向量 $e^{i\\Delta\\phi}$ 的定义，PLV 内在地与信号的振幅 $A_1(t)$ 和 $A_2(t)$ 无关。它是一个纯粹的相位同步性度量。\n\n- **幅值平方相干性 (MSC):** 这是一种频域中衡量两个信号之间线性关联的度量。它被定义为频率 $f$ 的函数：\n$$C_{12}(f) = \\frac{|S_{12}(f)|^2}{S_{11}(f)S_{22}(f)}$$\n其中 $S_{12}(f)$ 是信号之间的交叉谱密度，$S_{11}(f)$ 和 $S_{22}(f)$ 分别是它们的自谱密度（功率谱）。由于谱密度是根据信号的傅里叶变换计算的，而傅里叶变换包含振幅和相位信息，因此相干性对两者都敏感。具体来说，高的相干性值既需要一致的相位关系，也需要感兴趣频率上信号振幅（即功率）之间的一致关系。它量化了该频率下的线性相关程度。由于其对任何线性关系的敏感性，它会受到像脑电图（EEG）中容积传导这样的伪迹的强烈影响，容积传导会在邻近的传感器之间引入伪造的、零相位延迟的线性相关。\n\n在建立了这些原则之后，我们就可以评估各个选项了。\n\n**A. 对于一个实值窄带信号 $x(t)$，定义解析信号 $z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$，其中 $\\mathcal{H}\\{\\cdot\\}$ 表示希尔伯特变换。瞬时振幅是 $A(t) = |z(t)|$，瞬时相位是 $\\phi(t) = \\arg\\big(z(t)\\big)$，瞬时频率是 $f(t) = \\frac{1}{2\\pi}\\,\\frac{d\\phi(t)}{dt}$。具有相位 $\\phi_1(t)$ 和 $\\phi_2(t)$ 的两个信号之间的锁相值（PLV）是 $\\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$，它在时间或试验上计算，量化了相位一致性且与振幅无关。在频率 $f_0$ 处的幅值平方相干性是 $C_{12}(f_0) = \\frac{\\left|S_{12}(f_0)\\right|^2}{S_{11}(f_0)\\,S_{22}(f_0)}$，其中 $S_{12}(f)$ 是交叉谱密度，$S_{11}(f)$、$S_{22}(f)$ 是自谱密度；相干性反映了在 $f_0$ 处的线性耦合，包含振幅协变，并对容积传导敏感。**\n\n该选项与上述原则完全一致。\n- 解析信号以及由此产生的瞬时振幅、相位和频率的定义都是正确的，并且遵循了标准的、有原则的方法。\n- PLV 的定义是正确的。关于它量化什么（相位一致性）以及它与振幅无关的描述也是正确的。\n- 幅值平方相干性的定义是正确的。它作为一种依赖于振幅协变并对容积传导敏感的线性耦合度量的特征描述也是准确的。\n此选项正确且完整。\n**结论：正确**\n\n**B. 对于一个实值信号 $x(t)$，瞬时相位是 $\\phi(t) = \\arctan\\!\\left(\\frac{dx(t)/dt}{x(t)}\\right)$，瞬时振幅是 $A(t) = x(t)$，瞬时频率是 $f(t) = 2\\pi\\,\\phi(t)$。PLV 等于 $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$，而相干性等于两个带通滤波后的时间序列随时间变化的皮尔逊相关系数。**\n\n该选项包含多个基本错误。\n- 瞬时振幅 $A(t)$ 不能是信号 $x(t)$ 本身，因为 $x(t)$ 是一个取负值的振荡函数，而振幅是一个非负的包络。\n- 瞬时频率 $f(t)$ 与相位的時間导数 $\\frac{d\\phi(t)}{dt}$ 成正比，而不是相位 $\\phi(t)$ 本身。$2\\pi$ 因子也被放错了位置。\n- 将 PLV 定义为 $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$ 是一个近似值，仅在特定条件下（相位差在 0 附近呈窄分布）成立，并非通用定义。正式定义是 $\\left|\\left\\langle e^{i\\Delta\\phi}\\right\\rangle\\right| = \\sqrt{\\langle\\cos\\Delta\\phi\\rangle^2 + \\langle\\sin\\Delta\\phi\\rangle^2}$。\n- 将相干性等同于时间序列的皮尔逊相关系数是错误的。相干性是特定于频率的度量，而皮尔逊系数是时域度量，它整合了所有频率成分。\n**结论：不正确**\n\n**C. 对于一个平稳振荡，相位 $\\phi(t)$ 取为傅里叶变换 $X(f)$ 在中心频率 $f_0$ 处的幅角乘以 $t$，振幅是 $A = \\sqrt{\\mathrm{PSD}(f_0)}$，瞬时频率是 $f(t) = \\frac{d}{dt}\\,|x(t)|$。对于足够窄带的信号，PLV 与相干性相同，因为两者都测量在 $f_0$ 处的同步性。**\n\n该选项在其定义和比较中都存在缺陷。\n- 傅里叶变换为整个时间段提供一个单一的相位值，而不是随时间变化的瞬时相位 $\\phi(t)$。这个定义仅对纯粹的、永恒的正弦波有效，而不适用于真实的神经信号。\n- 振幅定义 $A = \\sqrt{\\mathrm{PSD}(f_0)}$ 给出了一个时间平均值，而不是瞬时的、随时间变化的振幅 $A(t)$。\n- 瞬时频率的定义 $f(t) = \\frac{d}{dt}\\,|x(t)|$ 是不正确的。频率与相位的导数有关，而不是与整流后信号的导数有关。\n- 声称对于窄带信号 PLV 与相干性相同是错误的。PLV 与振幅无关，而相干性从根本上依赖于振幅协变。它们测量的是信号关系的不同方面。\n**结论：不正确**\n\n**D. 对于一个窄带信号 $x(t)$，振幅是 $A(t) = \\mathcal{H}\\{x(t)\\}$，相位是 $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$，瞬时频率是 $f(t) = \\frac{d\\phi(t)}{dt}$。PLV 忽略振幅，在相位差均匀分布时等于零，而相干性仅测量相位同步性，并且对振幅差异不敏感。**\n\n该选项包含了不正确的定义和一个有严重缺陷的比较。\n- 振幅不是希尔伯特变换 $\\mathcal{H}\\{x(t)\\}$。振幅是解析信号的模，$A(t) = |x(t) + i\\mathcal{H}\\{x(t)\\}|$。\n- 相位定义 $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$ 与标准定义 $\\arctan\\!\\left(\\frac{\\operatorname{Im}\\{z\\}}{\\operatorname{Re}\\{z\\}}\\right) = \\arctan\\!\\left(\\frac{\\mathcal{H}\\{x(t)\\}}{x(t)}\\right)$ 相比，分子和分母颠倒了。\n- 瞬时频率缺少将 rad/s 转换为 Hz 的比例因子 $\\frac{1}{2\\pi}$。\n- 将相干性描述为测量“仅相位同步性”并且“对振幅差异不敏感”与事实完全相反。这是 PLV 的定义特征，而不是相干性的。\n**结论：不正确**\n\n**E. 对于一个窄带信号 $x(t)$，定义复包络 $z(t) = x(t) + i\\,x(t)$，其振幅为 $A(t) = \\operatorname{Re}\\{z(t)\\}$，相位为 $\\phi(t) = \\operatorname{Im}\\{z(t)\\}$。瞬时频率是 $f(t) = \\frac{1}{2\\pi}\\,\\frac{dA(t)}{dt}$。PLV 是跨时间的 $\\left\\langle \\left|\\phi_1(t)-\\phi_2(t)\\right|\\right\\rangle$，而相干性是零延迟下的互相关，并用标准差的乘积进行归一化。**\n\n这个选项几乎在所有方面都是错误的。\n- 复信号不是由 $z(t) = x(t) + i\\,x(t)$ 构成的。虚部必须是实部的希尔伯特变换。\n- 振幅是复信号的模，而不是它的实部。\n- 相位是复信号的幅角，而不是它的虚部。\n- 频率是相位的导数，而不是振幅的导数。\n- PLV 的定义是错误的；它被给出为平均绝对相位差，这是一个不同的统计量。\n- 相干性的定义是错误的；它被描述为皮尔逊相关系数，正如对选项 B 的解释中所述，这是不正确的。\n**结论：不正确**\n\n总而言之，只有选项 A 提供了一套完全正确并遵循信号处理和计算神经科学标准原则的定义和比较。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在从神经活动中提取出相关特征后，解码用户意图是BCI流程的最后一步。虽然一些简单的解码器（如群体向量）非常直观，但如果其所依赖的神经元群体的调谐特性不均匀，解码结果可能会出现系统性偏差。这项练习通过经典的群体向量解码器揭示了这一问题，引导你推导解码器偏差的数学表达式，并进一步构建一个基于加权最小二乘法（WLS）的更优估计器，为设计高性能解码器打下坚实的基础 。",
            "id": "3966623",
            "problem": "考虑一个脑机接口（BCI）解码任务，其目标是从一个具有余弦调谐特性的神经元群体中恢复一个二维运动方向。设真实的运动方向由单位向量 $\\mathbf{u}(\\theta) = [\\cos\\theta, \\sin\\theta]^{\\top}$ 表示，其中角度 $\\theta \\in [0, 2\\pi)$，上标 $\\top$ 表示转置。每个神经元 $i \\in \\{1, \\dots, N\\}$ 都有一个偏好方向（PD）$\\phi_i$ 和一个相关的单位向量 $\\mathbf{p}_i = [\\cos\\phi_i, \\sin\\phi_i]^{\\top}$。神经元 $i$ 的调谐模型由一个随机脉冲计数 $r_i$ 给出，在给定运动方向 $\\theta$ 的条件下，其条件期望为\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta),\n$$\n其中 $\\alpha_i > 0$ 是基线放电率，$\\beta_i \\ge 0$ 是调制增益。假设在给定 $\\theta$ 的条件下，$r_i$ 是条件独立的，并且噪声来自泊松脉冲过程，因此 $\\operatorname{Var}(r_i \\mid \\theta) = \\mathbb{E}[r_i \\mid \\theta]$。偏好方向角度的集合 $\\{\\phi_i\\}_{i=1}^{N}$ 在 $[0, 2\\pi)$ 上不是均匀分布的，并且基线放电率 $\\{\\alpha_i\\}$ 和增益 $\\{\\beta_i\\}$ 可能是异质的。定义朴素群体向量解码器\n$$\n\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i.\n$$\n设相对于真实方向的偏差向量为\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta).\n$$\n首先，计算 $\\mathbf{b}(\\theta)$ 关于 $\\{\\alpha_i\\}$、$\\{\\beta_i\\}$ 和 $\\{\\mathbf{p}_i\\}$ 的闭式解析表达式。接下来，通过将 $\\mathbf{u}(\\theta)$ 估计为下式的最小化子，推导一个基于加权最小二乘法（WLS）的校正：\n$$\n\\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2},\n$$\n其中 $w_i > 0$ 是用户指定的权重。提供 $\\mathbf{u}$ 的闭式 WLS 估计量，用 $\\{w_i\\}$、$\\{\\alpha_i\\}$、$\\{\\beta_i\\}$ 和 $\\{\\mathbf{p}_i\\}$ 表示。假设 $2 \\times 2$ 矩阵 $\\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是可逆的（例如，至少有两个具有正权重和增益的非共线偏好方向）。你的最终答案必须是一个单行矩阵，按顺序包含 $\\mathbf{b}(\\theta)$ 的解析表达式和 WLS 估计量 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$ 的解析表达式。无需进行数值计算。",
            "solution": "该问题要求推导与神经解码相关的两个量：一个朴素群体向量解码器的偏差，和一个运动方向的加权最小二乘（WLS）估计量。\n\n首先，我将推导偏差向量 $\\mathbf{b}(\\theta)$ 的表达式。偏差定义为估计量的期望值与被估计参数的真值之间的差。\n估计量是朴素群体向量解码器，由 $\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i$ 给出。真实参数是运动方向向量 $\\mathbf{u}(\\theta)$。\n因此，偏差向量为 $\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta)$。\n\n我们首先计算 $\\hat{\\mathbf{v}}$ 的条件期望：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\mathbb{E}\\left[\\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i \\mid \\theta\\right]\n$$\n根据期望的线性性质，并注意到偏好方向向量 $\\mathbf{p}_i$ 是固定参数：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\mathbb{E}[r_i \\mid \\theta] \\, \\mathbf{p}_i\n$$\n问题陈述了神经元 $i$ 的脉冲计数 $r_i$ 的条件均值为：\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\n$$\n将此表达式代入我们的期望群体向量方程中：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\left(\\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\, \\mathbf{p}_i\n$$\n我们可以分配求和：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i + \\sum_{i=1}^{N} \\beta_i \\left(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\mathbf{p}_i\n$$\n项 $\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)$ 是一个标量。我们可以将乘积 $(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)) \\mathbf{p}_i$ 重写为 $(\\mathbf{p}_i \\mathbf{p}_i^{\\top}) \\mathbf{u}(\\theta)$，其中 $\\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是一个 $2 \\times 2$ 矩阵（一个外积）。这使我们能够将 $\\mathbf{u}(\\theta)$ 因子提出来：\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta)\n$$\n现在，我们将此结果代入偏差向量的定义中：\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta) - \\mathbf{u}(\\theta)\n$$\n设 $\\mathbf{I}$ 为 $2 \\times 2$ 单位矩阵。我们可以从最后两项中提出因子 $\\mathbf{u}(\\theta)$：\n$$\n\\mathbf{b}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta)\n$$\n这是偏差向量的最终解析表达式。\n\n第二，我将推导 WLS 估计量 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$。该估计量是通过最小化以下关于向量 $\\mathbf{u}$ 的代价函数找到的：\n$$\nJ(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\n这是 $\\mathbf{u}$ 的一个二次函数，其最小值可以通过将其关于 $\\mathbf{u}$ 的梯度设置为零向量来找到。\n梯度是：\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\frac{\\partial}{\\partial \\mathbf{u}} \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\n使用链式法则 $\\nabla_{\\mathbf{x}} (f(\\mathbf{x}))^2 = 2f(\\mathbf{x}) \\nabla_{\\mathbf{x}}f(\\mathbf{x})$，并注意到 $\\nabla_{\\mathbf{u}}(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}) = -\\beta_i \\mathbf{p}_i$，我们得到：\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right) (-\\beta_i \\mathbf{p}_i)\n$$\n将梯度设置为零向量 $\\mathbf{0}$，以找到最优的 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) (-\\beta_i \\mathbf{p}_i) = \\mathbf{0}\n$$\n除以标量常数 $-2$：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\n我们在求和内分配各项：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i (r_i - \\alpha_i) - \\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(\\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\n重新整理以求解 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\sum_{i=1}^{N} w_i \\beta_i^2 \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\n从左侧的和中提出因子 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right) \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\n问题指明矩阵 $\\mathbf{Q} = \\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ 是可逆的。因此，我们可以通过在两边左乘 $\\mathbf{Q}^{-1}$ 来求解 $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$：\n$$\n\\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right)\n$$\n这是运动方向向量的 WLS 估计量的闭式表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta)  \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right) \\end{pmatrix}}\n$$"
        }
    ]
}