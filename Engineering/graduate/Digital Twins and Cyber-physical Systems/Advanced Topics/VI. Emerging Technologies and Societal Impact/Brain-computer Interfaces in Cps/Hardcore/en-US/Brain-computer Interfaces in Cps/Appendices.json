{
    "hands_on_practices": [
        {
            "introduction": "The performance of any non-invasive Brain-Computer Interface is fundamentally constrained by the quality of its input signals, where artifacts can easily overwhelm the neural information. This exercise models a common and challenging problem: motion artifacts arising from the physical interface between the electrode and the user . By deriving the artifactual voltage from first principles involving amplifier bias current and changing electrode impedances, you will gain a quantitative understanding of how mechanical instability translates into electrical noise, highlighting the importance of robust hardware design in cyber-physical systems.",
            "id": "3966676",
            "problem": "A Brain-Computer Interface (BCI) system using Electroencephalography (EEG) records two active channels referenced to a single hardware reference electrode. Each electrode-skin interface is modeled by a Thevenin source consisting of a local interface (half-cell) potential $E_{k}(t)$ in series with a contact impedance $Z_{k}(t)$ for $k \\in \\{a,r\\}$, where $a$ denotes the active channel and $r$ denotes the reference electrode. The instrumentation amplifier presents a very high input impedance but draws a constant input bias current of magnitude $i_{b}$ into each input. Head motion causes small sinusoidal modulations in the contact impedances and in the reference half-cell potential. Assume the following:\n\n- The amplifier measures the differential input $V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$, where $V_{k}(t)$ is the electrode potential at the amplifier input for electrode $k$.\n- The amplifier input bias current has magnitude $i_{b}$ and flows from the electrode into the amplifier input for both $a$ and $r$.\n- The baseline impedances are $Z_{a,0}$ and $Z_{r,0}$, with small motion-induced variations $\\delta Z_{a}(t)$ and $\\delta Z_{r}(t)$ such that $Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$ and $|\\delta Z_{k}(t)| \\ll Z_{k,0}$.\n- The interface potential at the reference has a motion-induced component $\\delta E_{r}(t)$; any motion-induced change in $E_{a}(t)$ is negligible compared to $\\delta E_{r}(t)$.\n- The instrumentation amplifier input impedance is sufficiently high that all other currents are negligible compared to the bias currents, and the scalp is treated as a local node driving the series $E_{k}(t)$ and $Z_{k}(t)$ elements.\n\nStarting from Kirchhoff’s Current Law (KCL) and Ohm’s law, derive the differential artifact component due to head motion and express its amplitude for the $a$-referenced channel in terms of the given quantities. Then, using the specific parameter values below, compute the numerical amplitude of the contamination in the $a$-referenced channel:\n\n- $i_{b} = 220 \\,\\mathrm{pA}$,\n- $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$ with $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$,\n- $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$ with $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$,\n- $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$ with $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$,\n\nand neglect all neural signals $E_{a}(t)$ and baseline offsets. Treat the sinusoidal modulations as in-phase at angular frequency $\\omega$ and assume linear superposition. Express the final contamination amplitude in microvolts and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   System: A Brain-Computer Interface (BCI) using Electroencephalography (EEG).\n-   Measurement configuration: An active channel ($a$) and a reference electrode ($r$).\n-   Electrode model: A Thevenin source for each electrode $k \\in \\{a,r\\}$, consisting of a half-cell potential $E_{k}(t)$ in series with a contact impedance $Z_{k}(t)$.\n-   Amplifier measurement: $V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$, where $V_{k}(t)$ is the potential at the amplifier input.\n-   Amplifier input bias current: A constant current of magnitude $i_{b}$ flows from each electrode into the corresponding amplifier input.\n-   Impedance model: $Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$, where $Z_{k,0}$ is the baseline impedance and $\\delta Z_{k}(t)$ is a small motion-induced variation such that $|\\delta Z_{k}(t)| \\ll Z_{k,0}$.\n-   Potential model: Motion-induced change in $E_{a}(t)$ is negligible. The reference potential has a motion-induced component $\\delta E_{r}(t)$.\n-   Assumptions:\n    1.  Instrumentation amplifier input impedance is effectively infinite.\n    2.  The scalp is a local node for each electrode's Thevenin model.\n    3.  Neglect all neural signals ($E_{a}(t)$) and baseline potential offsets.\n    4.  Linear superposition applies.\n-   Task:\n    1.  Derive the differential artifact component due to head motion.\n    2.  Compute the numerical amplitude of this contamination using the provided parameters.\n-   Parameter values:\n    -   $i_{b} = 220 \\,\\mathrm{pA}$\n    -   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$ with $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega$\n    -   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$ with $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega$\n    -   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$ with $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V}$\n-   Final requirement: Express the contamination amplitude in microvolts, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding:** The problem is well-grounded in the principles of biopotential measurements and electrical engineering. The Thevenin model for electrode-skin interfaces, the concept of amplifier bias current, and motion artifacts modulating impedance and potentials are standard and realistic concepts in EEG and BCI design.\n-   **Well-Posedness:** The problem provides a clear physical model, defines all variables, and specifies sufficient assumptions and parameters to arrive at a unique numerical solution.\n-   **Objectivity:** The problem is stated in precise, objective, and technical terms.\n-   **Conclusion:** The problem is deemed valid as it is scientifically sound, self-contained, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution is derived.\n\n### Derivation\nThe potential at the input of the instrumentation amplifier for each electrode, $V_{k}(t)$, can be determined by applying Ohm's law to the electrode-skin interface model. The amplifier draws a bias current $i_{b}$ from the electrode. According to the problem description, this current flows from the electrode into the amplifier. This means the current flows from the physiological source, through the series impedance $Z_k(t)$, to the amplifier input. The potential at the amplifier input $V_k(t)$ is therefore the source potential $E_k(t)$ minus the voltage drop across the impedance $Z_k(t)$.\n\nFor the active electrode ($k=a$):\n$$V_{a}(t) = E_{a}(t) - i_{b} Z_{a}(t)$$\nFor the reference electrode ($k=r$):\n$$V_{r}(t) = E_{r}(t) - i_{b} Z_{r}(t)$$\n\nThe instrumentation amplifier measures the differential voltage $V_{\\text{diff}}(t)$:\n$$V_{\\text{diff}}(t) = V_{a}(t) - V_{r}(t)$$\nSubstituting the expressions for $V_{a}(t)$ and $V_{r}(t)$:\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - i_{b} Z_{a}(t) \\right) - \\left( E_{r}(t) - i_{b} Z_{r}(t) \\right)$$\n$$V_{\\text{diff}}(t) = \\left( E_{a}(t) - E_{r}(t) \\right) - i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$$\n\nThis expression contains two main parts: the true differential physiological signal, $\\left( E_{a}(t) - E_{r}(t) \\right)$, and an artifact term, $-i_{b} \\left( Z_{a}(t) - Z_{r}(t) \\right)$, which arises from the bias current flowing through the mismatched impedances.\n\nWe are instructed to find the artifact component due to head motion, neglecting neural signals and baseline offsets. We apply the given assumptions:\n-   Neglect neural signal at the active electrode: $E_{a}(t) = 0$.\n-   The reference potential consists only of the motion-induced component: $E_{r}(t) = \\delta E_{r}(t)$.\n-   The impedances consist of baseline and motion-induced components: $Z_{k}(t) = Z_{k,0} + \\delta Z_{k}(t)$.\n\nSubstituting these into the expression for $V_{\\text{diff}}(t)$:\n$$V_{\\text{diff}}(t) = (0 - \\delta E_{r}(t)) - i_{b} \\left( (Z_{a,0} + \\delta Z_{a}(t)) - (Z_{r,0} + \\delta Z_{r}(t)) \\right)$$\n$$V_{\\text{diff}}(t) = -\\delta E_{r}(t) - i_{b} \\left( Z_{a,0} - Z_{r,0} \\right) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\n\nThe term $-i_{b}(Z_{a,0} - Z_{r,0})$ is a constant DC offset artifact. The problem asks for the *differential artifact component due to head motion*, which refers to the time-varying components. Let's denote this motion artifact as $V_{\\text{artifact}}(t)$:\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) - i_{b} \\left( \\delta Z_{a}(t) - \\delta Z_{r}(t) \\right)$$\nThis can be rewritten as:\n$$V_{\\text{artifact}}(t) = -\\delta E_{r}(t) + i_{b} \\left( \\delta Z_{r}(t) - \\delta Z_{a}(t) \\right)$$\n\nNow, we substitute the given sinusoidal forms for the motion-induced variations:\n-   $\\delta E_{r}(t) = \\Delta E_{r} \\cos(\\omega t)$\n-   $\\delta Z_{a}(t) = \\Delta Z_{a} \\cos(\\omega t)$\n-   $\\delta Z_{r}(t) = \\Delta Z_{r} \\cos(\\omega t)$\n\n$$V_{\\text{artifact}}(t) = -\\Delta E_{r} \\cos(\\omega t) + i_{b} \\left( \\Delta Z_{r} \\cos(\\omega t) - \\Delta Z_{a} \\cos(\\omega t) \\right)$$\nSince all modulations are in phase, we can factor out $\\cos(\\omega t)$:\n$$V_{\\text{artifact}}(t) = \\left[ -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right] \\cos(\\omega t)$$\n\nThe amplitude of this sinusoidal artifact, let's call it $A_{\\text{artifact}}$, is the absolute value of the coefficient of the cosine term:\n$$A_{\\text{artifact}} = \\left| -\\Delta E_{r} + i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) \\right|$$\n\nNow, we compute the numerical value using the provided parameters. First, we convert all values to base SI units (Volts, Amperes, Ohms).\n-   $i_{b} = 220 \\,\\mathrm{pA} = 220 \\times 10^{-12} \\,\\mathrm{A}$\n-   $\\Delta Z_{a} = 2.4 \\,\\mathrm{k}\\Omega = 2.4 \\times 10^{3} \\,\\Omega$\n-   $\\Delta Z_{r} = 3.7 \\,\\mathrm{k}\\Omega = 3.7 \\times 10^{3} \\,\\Omega$\n-   $\\Delta E_{r} = 7.6 \\,\\mu\\mathrm{V} = 7.6 \\times 10^{-6} \\,\\mathrm{V}$\n\nFirst, calculate the impedance-related voltage term:\n$$\\Delta Z_{r} - \\Delta Z_{a} = (3.7 \\times 10^{3} - 2.4 \\times 10^{3}) \\,\\Omega = 1.3 \\times 10^{3} \\,\\Omega$$\n$$i_{b} (\\Delta Z_{r} - \\Delta Z_{a}) = (220 \\times 10^{-12} \\,\\mathrm{A}) \\times (1.3 \\times 10^{3} \\,\\Omega) = 286 \\times 10^{-9} \\,\\mathrm{V} = 0.286 \\times 10^{-6} \\,\\mathrm{V}$$\n\nNow, substitute this into the amplitude expression:\n$$A_{\\text{artifact}} = \\left| -(7.6 \\times 10^{-6} \\,\\mathrm{V}) + (0.286 \\times 10^{-6} \\,\\mathrm{V}) \\right|$$\n$$A_{\\text{artifact}} = \\left| ( -7.6 + 0.286 ) \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = \\left| -7.314 \\times 10^{-6} \\,\\mathrm{V} \\right|$$\n$$A_{\\text{artifact}} = 7.314 \\times 10^{-6} \\,\\mathrm{V}$$\n\nThe problem requires the answer in microvolts ($\\mu\\mathrm{V}$).\n$$A_{\\text{artifact}} = 7.314 \\,\\mu\\mathrm{V}$$\nThis value is already expressed to four significant figures.",
            "answer": "$$\\boxed{7.314}$$"
        },
        {
            "introduction": "Once a signal is acquired, we must extract meaningful features that correlate with brain states or user intent. Many BCIs leverage the synchronization of neural oscillations, but \"synchrony\" can be quantified in multiple ways, each sensitive to different properties of the signals. This practice clarifies the fundamental signal processing concepts used to analyze neural rhythms, tasking you with defining instantaneous phase and amplitude and critically differentiating two key measures: the Phase-Locking Value (PLV) and magnitude-squared coherence . Mastering this distinction is vital for choosing appropriate features for a BCI decoder and correctly interpreting neurophysiological findings.",
            "id": "3966633",
            "problem": "A Brain-Computer Interface (BCI) decoder is designed to exploit synchrony in oscillatory neural activity recorded via electroencephalography (EEG). Two zero-mean, real-valued cortical time series, denoted by $x_1(t)$ and $x_2(t)$, have been bandpass filtered to isolate a narrowband rhythm of interest (for example, the sensorimotor $\\mu$ rhythm). The decoder must use principled definitions of instantaneous phase, amplitude, and frequency for each signal and must choose an appropriate synchrony metric. The engineering team is considering two families of synchrony measures: one based on circular statistics of phase differences across time or trials, and another based on cross-spectral analysis in the frequency domain.\n\nChoose the single option that simultaneously provides a correct and complete definition of instantaneous phase, amplitude, and frequency for a narrowband real-valued neural oscillation starting from standard signal representation principles, and correctly differentiates Phase-Locking Value (PLV) from magnitude-squared coherence in terms of what each quantifies and how amplitude contributes.\n\nA. For a real-valued narrowband signal $x(t)$, define the analytic signal $z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$, where $\\mathcal{H}\\{\\cdot\\}$ denotes the Hilbert transform. The instantaneous amplitude is $A(t) = |z(t)|$, the instantaneous phase is $\\phi(t) = \\arg\\big(z(t)\\big)$, and the instantaneous frequency is $f(t) = \\frac{1}{2\\pi}\\,\\frac{d\\phi(t)}{dt}$. The Phase-Locking Value (PLV) between two signals with phases $\\phi_1(t)$ and $\\phi_2(t)$ is $\\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$ computed across time or trials, which quantifies phase consistency and is independent of amplitude. Magnitude-squared coherence at frequency $f_0$ is $C_{12}(f_0) = \\frac{\\left|S_{12}(f_0)\\right|^2}{S_{11}(f_0)\\,S_{22}(f_0)}$, where $S_{12}(f)$ is the cross-spectral density and $S_{11}(f)$, $S_{22}(f)$ are autospectral densities; coherence reflects linear coupling at $f_0$, includes amplitude covariation, and is sensitive to volume conduction.\n\nB. For a real-valued signal $x(t)$, the instantaneous phase is $\\phi(t) = \\arctan\\!\\left(\\frac{dx(t)/dt}{x(t)}\\right)$, the instantaneous amplitude is $A(t) = x(t)$, and the instantaneous frequency is $f(t) = 2\\pi\\,\\phi(t)$. PLV equals $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$, while coherence equals the Pearson correlation coefficient between the two bandpass-filtered time series over time.\n\nC. For a stationary oscillation, the phase is $\\phi(t)$ taken as the argument of the Fourier transform $X(f)$ at the center frequency $f_0$ and multiplied by $t$, the amplitude is $A = \\sqrt{\\mathrm{PSD}(f_0)}$, and the instantaneous frequency is $f(t) = \\frac{d}{dt}\\,|x(t)|$. PLV is identical to coherence for sufficiently narrowband signals because both measure synchrony at $f_0$.\n\nD. For a narrowband signal $x(t)$, the amplitude is $A(t) = \\mathcal{H}\\{x(t)\\}$ and the phase is $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$, with instantaneous frequency $f(t) = \\frac{d\\phi(t)}{dt}$. PLV discards amplitude and equals zero when phase differences are uniformly distributed, whereas coherence measures only phase synchrony and is insensitive to amplitude differences.\n\nE. For a narrowband signal $x(t)$, define the complex envelope $z(t) = x(t) + i\\,x(t)$, with amplitude $A(t) = \\operatorname{Re}\\{z(t)\\}$ and phase $\\phi(t) = \\operatorname{Im}\\{z(t)\\}$. The instantaneous frequency is $f(t) = \\frac{1}{2\\pi}\\,\\frac{dA(t)}{dt}$. PLV is $\\left\\langle \\left|\\phi_1(t)-\\phi_2(t)\\right|\\right\\rangle$ across time, while coherence is the cross-correlation at zero lag normalized by the product of standard deviations.",
            "solution": "The problem requires selecting the option that provides both a correct and complete set of definitions for instantaneous signal parameters (amplitude, phase, frequency) and correctly differentiates the Phase-Locking Value (PLV) from magnitude-squared coherence. The validation of the problem statement confirms its scientific soundness and well-posed nature. I will now proceed to a detailed evaluation of each option.\n\nThe standard and most principled method for defining instantaneous parameters for a real-valued narrowband signal $x(t)$ is through the construction of the analytic signal.\n1. The Hilbert transform of the signal $x(t)$ is computed, $\\mathcal{H}\\{x(t)\\}$.\n2. The analytic signal $z(t)$ is formed, which is a complex-valued time series:\n$$z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$$\n3. This complex signal can be expressed in polar coordinates as $z(t) = A(t)e^{i\\phi(t)}$.\n4. From this representation, the instantaneous parameters are defined as:\n   - Instantaneous Amplitude: $A(t) = |z(t)| = \\sqrt{x(t)^2 + (\\mathcal{H}\\{x(t)\\})^2}$\n   - Instantaneous Phase: $\\phi(t) = \\arg(z(t))$\n   - Instantaneous Angular Frequency: $\\omega(t) = \\frac{d\\phi(t)}{dt}$\n   - Instantaneous Frequency: $f(t) = \\frac{1}{2\\pi}\\frac{d\\phi(t)}{dt}$\n\nNext, we must consider the definitions and properties of the two synchrony measures.\n- **Phase-Locking Value (PLV):** For two signals with instantaneous phases $\\phi_1(t)$ and $\\phi_2(t)$, the PLV measures the consistency of their phase difference $\\Delta\\phi(t) = \\phi_1(t) - \\phi_2(t)$ over a set of $N$ observations (time points or trials). It is defined as the magnitude of the mean resultant vector of the phase differences on the unit circle:\n$$\\text{PLV} = \\left| \\frac{1}{N} \\sum_{k=1}^{N} e^{i\\Delta\\phi(t_k)} \\right| = \\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$$\nPLV ranges from $0$ (for uniformly distributed phase differences) to $1$ (for a constant phase difference). By its definition, which uses unit vectors $e^{i\\Delta\\phi}$, PLV is inherently independent of the signals' amplitudes $A_1(t)$ and $A_2(t)$. It is a pure measure of phase synchrony.\n\n- **Magnitude-Squared Coherence (MSC):** This is a frequency-domain measure of linear association between two signals. It is defined as a function of frequency $f$:\n$$C_{12}(f) = \\frac{|S_{12}(f)|^2}{S_{11}(f)S_{22}(f)}$$\nwhere $S_{12}(f)$ is the cross-spectral density between the signals and $S_{11}(f)$ and $S_{22}(f)$ are their respective auto-spectral densities (power spectra). Since the spectral densities are computed from the Fourier transforms of the signals, which contain both amplitude and phase information, coherence is sensitive to both. Specifically, a high coherence value requires both a consistent phase relationship and a consistent relationship between the amplitudes (i.e., power) of the signals at the frequency of interest. It quantifies the degree of linear correlation at that frequency. Due to its sensitivity to any linear relationship, it is strongly affected by artifacts like volume conduction in EEG, which introduces a spurious linear, zero-phase-lag correlation between nearby sensors.\n\nWith these principles established, we can evaluate the options.\n\n**A. For a real-valued narrowband signal $x(t)$, define the analytic signal $z(t) = x(t) + i\\,\\mathcal{H}\\{x(t)\\}$, where $\\mathcal{H}\\{\\cdot\\}$ denotes the Hilbert transform. The instantaneous amplitude is $A(t) = |z(t)|$, the instantaneous phase is $\\phi(t) = \\arg\\big(z(t)\\big)$, and the instantaneous frequency is $f(t) = \\frac{1}{2\\pi}\\,\\frac{d\\phi(t)}{dt}$. The Phase-Locking Value (PLV) between two signals with phases $\\phi_1(t)$ and $\\phi_2(t)$ is $\\left|\\left\\langle e^{i\\left(\\phi_1(t)-\\phi_2(t)\\right)}\\right\\rangle\\right|$ computed across time or trials, which quantifies phase consistency and is independent of amplitude. Magnitude-squared coherence at frequency $f_0$ is $C_{12}(f_0) = \\frac{\\left|S_{12}(f_0)\\right|^2}{S_{11}(f_0)\\,S_{22}(f_0)}$, where $S_{12}(f)$ is the cross-spectral density and $S_{11}(f)$, $S_{22}(f)$ are autospectral densities; coherence reflects linear coupling at $f_0$, includes amplitude covariation, and is sensitive to volume conduction.**\n\nThis option is entirely consistent with the principles outlined above.\n- The definitions of the analytic signal and the resulting instantaneous amplitude, phase, and frequency are all correct and follow the standard, principled approach.\n- The definition of PLV is correct. The description of what it quantifies (phase consistency) and its independence from amplitude is also correct.\n- The definition of magnitude-squared coherence is correct. Its characterization as a measure of linear coupling that depends on amplitude covariation and is sensitive to volume conduction is also accurate.\nThis option is correct and complete.\n**Verdict: Correct**\n\n**B. For a real-valued signal $x(t)$, the instantaneous phase is $\\phi(t) = \\arctan\\!\\left(\\frac{dx(t)/dt}{x(t)}\\right)$, the instantaneous amplitude is $A(t) = x(t)$, and the instantaneous frequency is $f(t) = 2\\pi\\,\\phi(t)$. PLV equals $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$, while coherence equals the Pearson correlation coefficient between the two bandpass-filtered time series over time.**\n\nThis option contains multiple fundamental errors.\n- The instantaneous amplitude $A(t)$ cannot be the signal $x(t)$ itself, as $x(t)$ is an oscillating function that takes on negative values, whereas amplitude is a non-negative envelope.\n- The instantaneous frequency $f(t)$ is proportional to the time derivative of phase, $\\frac{d\\phi(t)}{dt}$, not the phase $\\phi(t)$ itself. The factor of $2\\pi$ is also misplaced.\n- The definition of PLV as $\\left\\langle \\cos\\big(\\phi_1(t)-\\phi_2(t)\\big)\\right\\rangle$ is an approximation that holds only under specific conditions (narrow distribution of phase differences around $0$), not the general definition. The formal definition is $\\left|\\left\\langle e^{i\\Delta\\phi}\\right\\rangle\\right| = \\sqrt{\\langle\\cos\\Delta\\phi\\rangle^2 + \\langle\\sin\\Delta\\phi\\rangle^2}$.\n- Equating coherence with the Pearson correlation coefficient of the time series is incorrect. Coherence is a frequency-specific measure, while the Pearson coefficient is a time-domain measure that integrates over all frequency content.\n**Verdict: Incorrect**\n\n**C. For a stationary oscillation, the phase is $\\phi(t)$ taken as the argument of the Fourier transform $X(f)$ at the center frequency $f_0$ and multiplied by $t$, the amplitude is $A = \\sqrt{\\mathrm{PSD}(f_0)}$, and the instantaneous frequency is $f(t) = \\frac{d}{dt}\\,|x(t)|$. PLV is identical to coherence for sufficiently narrowband signals because both measure synchrony at $f_0$.**\n\nThis option is flawed in its definitions and its comparison.\n- The Fourier transform provides a single phase value for an entire epoch, not a time-varying instantaneous phase $\\phi(t)$. This definition is only valid for a pure, eternal sinusoid, not for a real-world neural signal.\n- The amplitude definition $A = \\sqrt{\\mathrm{PSD}(f_0)}$ gives a time-averaged value, not an instantaneous, time-varying amplitude $A(t)$.\n- The instantaneous frequency definition $f(t) = \\frac{d}{dt}\\,|x(t)|$ is incorrect. Frequency is related to the derivative of phase, not the derivative of the rectified signal.\n- The claim that PLV is identical to coherence for narrowband signals is false. PLV is amplitude-independent, whereas coherence is fundamentally dependent on amplitude covariation. They measure different aspects of the signal relationship.\n**Verdict: Incorrect**\n\n**D. For a narrowband signal $x(t)$, the amplitude is $A(t) = \\mathcal{H}\\{x(t)\\}$ and the phase is $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$, with instantaneous frequency $f(t) = \\frac{d\\phi(t)}{dt}$. PLV discards amplitude and equals zero when phase differences are uniformly distributed, whereas coherence measures only phase synchrony and is insensitive to amplitude differences.**\n\nThis option contains incorrect definitions and a critically flawed comparison.\n- The amplitude is not the Hilbert transform $\\mathcal{H}\\{x(t)\\}$. The amplitude is the modulus of the analytic signal, $A(t) = |x(t) + i\\mathcal{H}\\{x(t)\\}|$.\n- The phase definition $\\phi(t) = \\arctan\\!\\left(\\frac{x(t)}{\\mathcal{H}\\{x(t)\\}}\\right)$ swaps the numerator and denominator compared to the standard definition $\\arctan\\!\\left(\\frac{\\operatorname{Im}\\{z\\}}{\\operatorname{Re}\\{z\\}}\\right) = \\arctan\\!\\left(\\frac{\\mathcal{H}\\{x(t)\\}}{x(t)}\\right)$.\n- The instantaneous frequency is missing the scaling factor of $\\frac{1}{2\\pi}$ to convert from rad/s to Hz.\n- The description of coherence as measuring \"only phase synchrony\" and being \"insensitive to amplitude differences\" is the exact opposite of the truth. This is the defining characteristic of PLV, not coherence.\n**Verdict: Incorrect**\n\n**E. For a narrowband signal $x(t)$, define the complex envelope $z(t) = x(t) + i\\,x(t)$, with amplitude $A(t) = \\operatorname{Re}\\{z(t)\\}$ and phase $\\phi(t) = \\operatorname{Im}\\{z(t)\\}$. The instantaneous frequency is $f(t) = \\frac{1}{2\\pi}\\,\\frac{dA(t)}{dt}$. PLV is $\\left\\langle \\left|\\phi_1(t)-\\phi_2(t)\\right|\\right\\rangle$ across time, while coherence is the cross-correlation at zero lag normalized by the product of standard deviations.**\n\nThis option is incorrect in virtually every aspect.\n- The complex signal is not formed by $z(t) = x(t) + i\\,x(t)$. The imaginary part must be the Hilbert transform of the real part.\n- The amplitude is the modulus of the complex signal, not its real part.\n- The phase is the argument of the complex signal, not its imaginary part.\n- The frequency is the derivative of phase, not amplitude.\n- The PLV definition is wrong; it is given as the mean absolute phase difference, which is a different statistical quantity.\n- The coherence definition is wrong; it is described as the Pearson correlation coefficient, which is incorrect as explained for option B.\n**Verdict: Incorrect**\n\nIn summary, only Option A provides a set of definitions and comparisons that are fully correct and adhere to the standard principles of signal processing and computational neuroscience.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The final stage of a BCI involves decoding the user's intent from the extracted neural features to control an external device. A classic and intuitive approach for decoding movement direction is the population vector algorithm, but its accuracy can be compromised by physiological realities, such as non-uniform neural tuning properties. This problem guides you through deriving the mathematical form of this decoder's bias, providing direct insight into why such errors occur . You will then develop a correction using a Weighted Least Squares (WLS) estimator, demonstrating a practical method for creating more accurate and reliable decoders for closed-loop control.",
            "id": "3966623",
            "problem": "Consider a Brain-Computer Interface (BCI) decoding task in which the goal is to recover a two-dimensional movement direction from a population of neurons with cosine tuning. Let the true movement direction be represented by the unit vector $\\mathbf{u}(\\theta) = [\\cos\\theta, \\sin\\theta]^{\\top}$ for some angle $\\theta \\in [0, 2\\pi)$, where the superscript $\\top$ denotes transpose. Each neuron $i \\in \\{1, \\dots, N\\}$ has a Preferred Direction (PD) $\\phi_i$ and an associated unit vector $\\mathbf{p}_i = [\\cos\\phi_i, \\sin\\phi_i]^{\\top}$. The tuning model for neuron $i$ is given by a random spike count $r_i$ whose conditional expectation under the movement direction $\\theta$ is\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta),\n$$\nwith $\\alpha_i > 0$ the baseline rate and $\\beta_i \\ge 0$ the modulation gain. Assume that $r_i$ are conditionally independent given $\\theta$ and that the noise arises from a Poisson spiking process, so that $\\operatorname{Var}(r_i \\mid \\theta) = \\mathbb{E}[r_i \\mid \\theta]$. The set of preferred direction angles $\\{\\phi_i\\}_{i=1}^{N}$ is not uniformly distributed on $[0, 2\\pi)$, and the baselines $\\{\\alpha_i\\}$ and gains $\\{\\beta_i\\}$ may be heterogeneous. Define the naive population vector decoder\n$$\n\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i.\n$$\nLet the bias vector with respect to the true direction be\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta).\n$$\nFirst, compute the closed-form analytic expression for $\\mathbf{b}(\\theta)$ in terms of $\\{\\alpha_i\\}$, $\\{\\beta_i\\}$, and $\\{\\mathbf{p}_i\\}$. Next, derive a correction based on Weighted Least Squares (WLS) by estimating $\\mathbf{u}(\\theta)$ as the minimizer of\n$$\n\\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2},\n$$\nwhere $w_i > 0$ are user-specified weights. Provide the closed-form WLS estimator of $\\mathbf{u}$ in terms of $\\{w_i\\}$, $\\{\\alpha_i\\}$, $\\{\\beta_i\\}$, and $\\{\\mathbf{p}_i\\}$. Assume the $2 \\times 2$ matrix $\\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ is invertible (for example, at least two non-collinear preferred directions with positive weights and gains). Your final answer must be a single row matrix containing, in order, the analytic expression for $\\mathbf{b}(\\theta)$ and the analytic expression for the WLS estimator $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of two quantities related to neural decoding: the bias of a naive population vector decoder and a Weighted Least Squares (WLS) estimator of the movement direction.\n\nFirst, I will derive the expression for the bias vector, $\\mathbf{b}(\\theta)$. The bias is defined as the difference between the expected value of the estimator and the true value of the parameter being estimated.\nThe estimator is the naive population vector decoder, given by $\\hat{\\mathbf{v}} = \\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i$. The true parameter is the movement direction vector $\\mathbf{u}(\\theta)$.\nThe bias vector is therefore $\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta)$.\n\nWe begin by computing the conditional expectation of $\\hat{\\mathbf{v}}$:\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\mathbb{E}\\left[\\sum_{i=1}^{N} r_i \\, \\mathbf{p}_i \\mid \\theta\\right]\n$$\nBy the linearity of expectation, and noting that the preferred direction vectors $\\mathbf{p}_i$ are fixed parameters:\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\mathbb{E}[r_i \\mid \\theta] \\, \\mathbf{p}_i\n$$\nThe problem states the conditional mean of the spike count $r_i$ for neuron $i$ is:\n$$\n\\mathbb{E}[r_i \\mid \\theta] = \\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\n$$\nSubstituting this expression into our equation for the expected population vector:\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\left(\\alpha_i + \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\, \\mathbf{p}_i\n$$\nWe can distribute the sum:\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i + \\sum_{i=1}^{N} \\beta_i \\left(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)\\right) \\mathbf{p}_i\n$$\nThe term $\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)$ is a scalar. We can rewrite the product $(\\mathbf{p}_i^{\\top} \\mathbf{u}(\\theta)) \\mathbf{p}_i$ as $(\\mathbf{p}_i \\mathbf{p}_i^{\\top}) \\mathbf{u}(\\theta)$, where $\\mathbf{p}_i \\mathbf{p}_i^{\\top}$ is a $2 \\times 2$ matrix (an outer product). This allows us to factor out $\\mathbf{u}(\\theta)$:\n$$\n\\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta)\n$$\nNow, we substitute this result into the definition of the bias vector:\n$$\n\\mathbf{b}(\\theta) = \\mathbb{E}[\\hat{\\mathbf{v}} \\mid \\theta] - \\mathbf{u}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) \\mathbf{u}(\\theta) - \\mathbf{u}(\\theta)\n$$\nLet $\\mathbf{I}$ be the $2 \\times 2$ identity matrix. We can factor out $\\mathbf{u}(\\theta)$ from the last two terms:\n$$\n\\mathbf{b}(\\theta) = \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta)\n$$\nThis is the final analytical expression for the bias vector.\n\nSecond, I will derive the WLS estimator, $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$. This estimator is found by minimizing the following cost function with respect to the vector $\\mathbf{u}$:\n$$\nJ(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\nThis is a quadratic function of $\\mathbf{u}$ and its minimum can be found by setting its gradient with respect to $\\mathbf{u}$ to the zero vector.\nThe gradient is:\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\frac{\\partial}{\\partial \\mathbf{u}} \\sum_{i=1}^{N} w_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right)^{2}\n$$\nUsing the chain rule, $\\nabla_{\\mathbf{x}} (f(\\mathbf{x}))^2 = 2f(\\mathbf{x}) \\nabla_{\\mathbf{x}}f(\\mathbf{x})$, and noting that $\\nabla_{\\mathbf{u}}(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}) = -\\beta_i \\mathbf{p}_i$, we get:\n$$\n\\nabla_{\\mathbf{u}} J(\\mathbf{u}) = \\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\mathbf{u}\\right) (-\\beta_i \\mathbf{p}_i)\n$$\nSetting the gradient to the zero vector, $\\mathbf{0}$, to find the optimal $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$:\n$$\n\\sum_{i=1}^{N} w_i \\cdot 2 \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) (-\\beta_i \\mathbf{p}_i) = \\mathbf{0}\n$$\nDividing by the scalar constant $-2$:\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(r_i - \\alpha_i - \\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\nWe distribute the terms within the summation:\n$$\n\\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i (r_i - \\alpha_i) - \\sum_{i=1}^{N} w_i \\beta_i \\mathbf{p}_i \\left(\\beta_i \\, \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}}\\right) = \\mathbf{0}\n$$\nRearranging to solve for $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$:\n$$\n\\sum_{i=1}^{N} w_i \\beta_i^2 \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\nFactoring $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$ out of the sum on the left-hand side:\n$$\n\\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right) \\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i\n$$\nThe problem specifies that the matrix $\\mathbf{Q} = \\sum_{i=1}^{N} w_i \\beta_i^{2} \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top}$ is invertible. We can therefore solve for $\\hat{\\mathbf{u}}_{\\mathrm{WLS}}$ by pre-multiplying both sides by $\\mathbf{Q}^{-1}$:\n$$\n\\hat{\\mathbf{u}}_{\\mathrm{WLS}} = \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right)\n$$\nThis is the closed-form expression for the WLS estimator of the movement direction vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(\\sum_{i=1}^{N} \\alpha_i \\mathbf{p}_i\\right) + \\left[ \\left(\\sum_{i=1}^{N} \\beta_i \\mathbf{p}_i \\mathbf{p}_i^{\\top}\\right) - \\mathbf{I} \\right] \\mathbf{u}(\\theta) & \\left( \\sum_{i=1}^{N} w_i \\beta_i^2 \\, \\mathbf{p}_i \\mathbf{p}_i^{\\top} \\right)^{-1} \\left( \\sum_{i=1}^{N} w_i \\beta_i (r_i - \\alpha_i) \\mathbf{p}_i \\right) \\end{pmatrix}}\n$$"
        }
    ]
}