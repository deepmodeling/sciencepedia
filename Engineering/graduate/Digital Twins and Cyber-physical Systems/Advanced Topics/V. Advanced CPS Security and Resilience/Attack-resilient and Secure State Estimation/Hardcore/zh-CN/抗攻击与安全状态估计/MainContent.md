## 引言
在日益互联的信息物理系统（CPS）和[数字孪生](@entry_id:171650)时代，确保系统状态的精确和可靠估计是实现安全、高效运行的基石。然而，随着系统网络化程度的加深，它们也日益暴露在恶意网络攻击的威胁之下，这些攻击能够注入虚假数据，误导系统决策，甚至导致灾难性后果。传统的估计算法，如卡尔曼滤波器，其设计初衷是处理随机噪声而非蓄意对抗，因此在面对智能攻击时往往会失效甚至发散，这构成了一个严峻的安全挑战和亟待填补的知识空白。

本文旨在系统性地介绍攻击弹性和[安全状态估计](@entry_id:1131370)的核心理论与方法。通过学习本文，读者将能够理解标准估计器在对抗环境下的脆弱性，并掌握构建新一代安全估计系统的关键技术。我们将分三个章节展开：

- **原理与机制**：本章将深入数学核心，建立包含恶意攻击的系统模型，剖析传统估计器失效的根本原因，并阐明实现弹性的基本条件（如鲁棒[可观测性](@entry_id:152062)）。此外，本章还将介绍多种先进的估计器设计机制，包括[鲁棒滤波](@entry_id:754387)和博弈论方法。
- **应用与跨学科联系**：本章将理论与实践相结合，展示这些安全估计原理在系统监控、主动防御、[非线性](@entry_id:637147)及[分布式系统](@entry_id:268208)中的具体应用。读者将看到该领域如何与控制理论、统计学、计算机科学等多个学科交叉融合，解决复杂的现实世界问题。
- **动手实践**：通过一系列精心设计的问题，本部分将帮助读者将理论知识转化为实践技能，亲手计算和设计以巩固对[可观测性](@entry_id:152062)、攻击影响和[隐蔽](@entry_id:196364)攻击设计的理解。

现在，让我们从建立一个能够清晰刻画攻击影响的系统模型开始，步入攻击弹性和[安全状态估计](@entry_id:1131370)的原理世界。

## 原理与机制

在“引言”章节中，我们明确了为[数字孪生](@entry_id:171650)确保准确、可靠的状态估计以应对恶意攻击的极端重要性。本章节将深入探讨实现攻击弹性和[安全状态估计](@entry_id:1131370)所需的核心原理和关键机制。我们将从建立一个能够同时容纳随机噪声和蓄意攻击的系统模型开始，揭示为何传统估计方法在这种对抗性环境下会失效，进而阐述确保[系统弹性](@entry_id:1132834)的基本条件，并最终介绍几种先进的估计器设计方法。

### 攻击下的信息物理系统建模

为了精确分析攻击的影响，我们首先需要一个能够清晰区分内生不确定性与外来恶意输入的数学模型。考虑一个离散时间[线性时不变](@entry_id:276287)（LTI）信息物理系统（CPS），其动态行为和测量过程可由以下[状态空间方程](@entry_id:266994)描述 ：
$$
x_{k+1}=A x_k + B u_k + b_k + w_k
$$
$$
y_k = C x_k + a_k + v_k
$$
其中，$x_k \in \mathbb{R}^n$ 是系统的状态向量，$u_k \in \mathbb{R}^m$ 是控制输入，$y_k \in \mathbb{R}^p$ 是传感器测量输出。矩阵 $A$、$B$ 和 $C$ 分别是已知的状态矩阵、输入矩阵和输出矩阵。

该模型的关键在于对四种外源信号的区分：$w_k$、$v_k$、$b_k$ 和 $a_k$。

- **随机噪声 ($w_k$ 和 $v_k$)**：$w_k \in \mathbb{R}^n$ 代表**[过程噪声](@entry_id:270644)**，源于[模型简化](@entry_id:171175)或未建模的动态；$v_k \in \mathbb{R}^p$ 代表**测量噪声**，源于传感器硬件的固有不精确性。在[随机控制](@entry_id:170804)和[估计理论](@entry_id:268624)中，这些信号通常被建模为具有良好统计特性的[随机过程](@entry_id:268487)。一个标准的假设是，它们是零均值、时间上不相关（即**[白噪声](@entry_id:145248)**）的随机序列，具有已知的[协方差矩阵](@entry_id:139155)（分别为 $Q \succeq 0$ 和 $R \succeq 0$）。此外，它们通常被假设为[相互独立](@entry_id:273670)，并且与系统的初始状态 $x_0$ 无关。这种概率性建模是卡尔曼滤波器等经典估计器设计的基础。

- **对抗性攻击 ($b_k$ 和 $a_k$)**：$b_k \in \mathbb{R}^n$ 代表对系统动态的攻击（或执行器攻击），而 $a_k \in \mathbb{R}^p$ 代表对传感器的攻击。与随机噪声不同，这些信号是由一个有智能的、可能了解系统动态的对手精心设计的。将它们用固定的概率分布来建模是天真且无效的，因为这无法捕捉其对抗性和适应性。例如，一个聪明的攻击者可能会根据过去的系统输出来调整当前的攻击信号 $a_k$ 。这种**因果自适应**的策略会使得攻击信号与其自身的历史以及系统的状态和噪声历史产生相关性，从而彻底违背了[白噪声](@entry_id:145248)的定义。因此，将攻击信号简单地归并到噪声项中（例如，定义新的噪声为 $v_k' = v_k+a_k$）在统计上是错误的，因为它会破坏噪声的零均值和[不相关性](@entry_id:917675)假设。

正确的建模方法是将攻击信号 $a_k$ 和 $b_k$ 视为任意的、未知的确定性序列。为了使问题能够求解，我们必须对这些攻击施加**结构性约束**，而非统计性假设。一个最常见且实用的约束是**稀疏性**（sparsity），即假设攻击者在任何时刻只能破坏一小部分执行器或传感器。例如，我们可能假设在任意时刻 $k$，攻击向量 $a_k$ 的非零元素个数（即其 $\ell_0$ 范数）不超过一个小的整数 $s$（$\|a_k\|_0 \le s$）。正是这种结构性假设，结合系统自身的冗余性，为我们从测量数据中分离攻击信号和恢复真实状态提供了可能 。

### 标准估计器的脆弱性

理解了攻击与噪声的本质区别后，我们便能揭示为何像卡尔曼滤波器这样的标准估计器在面对恶意攻击时会变得脆弱。

卡尔曼滤波器是在线性[高斯假设](@entry_id:170316)下最优的最小[均方误差](@entry_id:175403)（MMSE）估计器。其核心在于一个[预测-校正循环](@entry_id:270742)，利用一个名为**新息**（innovation）或残差（residual）的信号来更新状态估计。新息定义为实际测量值与预测测量值之差：$r_k = y_k - C \hat{x}_{k|k-1}$。在没有攻击的理想情况下（即 $a_k=0$），最优卡尔曼滤波器的一个基本性质是，其产生的[新息序列](@entry_id:181232) $\{r_k\}$ 是一个零均值、不相关的[白噪声](@entry_id:145248)序列。这个“新息白度”特性是滤波器最优性的直接体现，并构成了**[正交性原理](@entry_id:153755)**（orthogonality principle）的一部分，该原理指出最优估计误差应与所有历史测量数据正交 。

然而，当存在[传感器攻击](@entry_id:1131483) $a_k$ 时，估计器在不知情的情况下处理的是被污染的测量值 $y_k^{\mathrm{a}} = C x_k + v_k + a_k$。它计算出的新息变为：
$$
r_k^{\mathrm{a}} = y_k^{\mathrm{a}} - C \hat{x}_{k|k-1} = (C x_k + v_k + a_k) - C \hat{x}_{k|k-1} = r_k^{\text{nominal}} + a_k
$$
这里的 $r_k^{\text{nominal}}$ 是在无攻击情况下的新息。这个简单的公式揭示了灾难性的后果：
1.  **新息变得有偏**：新息的[期望值](@entry_id:150961)变为 $E[r_k^{\mathrm{a}}] = E[r_k^{\text{nominal}}] + E[a_k] = E[a_k]$。如果攻击具有非零均值（例如，一个恒定的偏置攻击），[新息序列](@entry_id:181232)也将是有偏的。
2.  **新息变得有色**：由于攻击信号 $a_k$ 可能是自适应的或具有时间结构的，[新息序列](@entry_id:181232) $r_k^{\mathrm{a}}$ 将不再是时间不相关的（即变为“有色”噪声）。

[新息序列](@entry_id:181232)的白度和零均值特性被破坏，意味着滤波器的[内部模型](@entry_id:923968)与现实不再匹配。它所使用的[卡尔曼增益](@entry_id:145800) $K_k$ 不再是最优的，估计结果也将偏离真实状态。这正是标准估计器失去最优性并变得脆弱的根本原因 。

一个常见的误解是，可以通过一些简单的“鲁棒化”措施来修复标准估计器。例如，有人可能认为，将[测量噪声](@entry_id:275238)的[协方差矩阵](@entry_id:139155) $R$ 人为地调大，就可以降低滤波器对异常测量的信任度。然而，这种**[协方差膨胀](@entry_id:635604)**（covariance inflation）的方法效果很差。它无法区分哪个传感器被攻击，而是同等地降低了对所有传感器的信任，导致大量有用信息的丢失和估计精度的显著下降，并且它本质上仍将攻击误认为是一种高斯噪声 。

另一个更深刻的层面是，仅仅确保估计误差动态的**稳定性**（stability）并不足以保证**弹性**（resilience）。考虑一个标准的龙贝格（Luenberger）观测器 ：
$$
\hat{x}_{k+1} = A \hat{x}_k + L (y_k - C \hat{x}_k)
$$
其[估计误差](@entry_id:263890) $e_k = x_k - \hat{x}_k$ 的动态（忽略噪声）为：
$$
e_{k+1} = (A - L C) e_k - L a_k
$$
通过选择合适的[观测器增益](@entry_id:267562) $L$，我们可以使得矩阵 $(A-LC)$ 的所有特征值都在单位圆内（即Schur稳定），这保证了在没有攻击（$a_k=0$）时，误差 $e_k$ 会收敛到零。这是[观测器设计](@entry_id:263404)的必要条件。然而，它远非充分条件。当攻击存在时，$a_k$ 通过 $-La_k$ 这一项作为外部输入驱动误差动态。即使 $(A-LC)$ 是稳定的，一个持续的、有界的攻击 $a_k$ 仍然可以导致[误差收敛](@entry_id:137755)到一个非零的[稳态](@entry_id:139253)偏置；一个无界的攻击则可以驱动误差发散。此外，选择一个高增益的 $L$ 虽然能加速误差的收敛，但也会放大攻击项 $-La_k$ 的影响，使得估计器对攻击更加敏感和脆弱。因此，真正的弹性需要超越传统的稳定性设计，采用能够主动识别和隔离攻击影响的机制 。

### 攻击弹性的基本条件：[可观测性](@entry_id:152062)的作用

要实现真正的攻击弹性，即让[数字孪生](@entry_id:171650)的估计状态 $\hat{x}_k$ 与物理系统的真实状态 $x_k$ 保持忠实同步，使得[估计误差](@entry_id:263890) $e_k$ 最终有界，且该界限仅与系统[固有噪声](@entry_id:261197)有关，而与任何满足[稀疏性](@entry_id:136793)约束的攻击序列无关 ，我们必须依赖于系统内在的**冗余**。在状态估计的语境下，这种冗余通过**[可观测性](@entry_id:152062)**（observability）的概念来形式化。

首先，我们回顾经典的[可观测性](@entry_id:152062)与[可检测性](@entry_id:265305)定义 ：
- **[可观测性](@entry_id:152062) (Observability)**：如果系统在没有噪声和攻击的情况下，仅通过有限时间内的输出序列 $\{y_k\}$ 就能唯一地确定其初始状态 $x_0$，则称系统是可观测的。这等价于系统的[可观测性矩阵](@entry_id:165052) $\mathcal{O} = [C^T, (CA)^T, \dots, (CA^{n-1})^T]^T$ 是列满秩的。
- **[可检测性](@entry_id:265305) (Detectability)**：这是一个比可观测性更弱的条件。它要求所有不可观测的状态模式都是[稳定收敛](@entry_id:199422)的。这意味着，即使状态的某些部分无法被测量到，这些部分也会自行衰减至零。[可检测性](@entry_id:265305)是确保[估计误差](@entry_id:263890)有界的最低要求。

经典的可观测性假设所有传感器都是可信的。但在面对稀疏攻击时，这个假设被打破。为了保证弹性，系统必须在部分传感器数据变得不可信后，依然能够重构状态。这就引出了**攻击鲁棒可观测性**（attack-robust observability）的概念。

设想攻击者在每个时刻最多能破坏 $s$ 个传感器。要唯一地确定状态，我们需要确保任何两个不同的初始状态 $x_0$ 和 $x_0'$，在任何两组可能的 $s$-稀疏攻击序列 $\{e_k\}$ 和 $\{e_k'\}$ 的作用下，不会产生完全相同的输出序列。如果它们产生了相同的输出，即 $CA^k x_0 + e_k = CA^k x_0' + e_k'$，那么 $CA^k(x_0-x_0') = e_k' - e_k$。令状态差 $\Delta x = x_0-x_0'$，攻击差 $\Delta e_k = e_k' - e_k$。由于 $\|e_k\|_0 \le s$ 且 $\|e_k'\|_0 \le s$，攻击差的稀疏度 $\|\Delta e_k\|_0 \le 2s$。因此，如果存在一个非零的 $\Delta x$，使得序列 $\{CA^k \Delta x\}$ 对于所有 $k$ 都是至多 $2s$-稀疏的，那么攻击者就可以通过构造合适的攻击来混淆状态，从而破坏状态的唯一可恢[复性](@entry_id:162752)。

为了防止这种情况，我们必须要求系统具有足够的冗余，以至于在“丢掉”任何 $2s$ 个传感器后，系统仍然是可观测的。这引出了一个核心的充分条件 [@problem_id:4206584, @problem_id:4206578]：
**$2s$-稀疏可观测性**：如果对于任意一个包含不超过 $2s$ 个传感器指标的集合 $\mathcal{S}$，通过从矩阵 $C$ 中移除与 $\mathcal{S}$ 对应的行得到的子系统 $(A, C_{\bar{\mathcal{S}}})$ 仍然是可观测的，则称原系统 $(A,C)$ 是 $2s$-稀疏可观测的。

这个条件是设计能抵抗 $s$-稀疏攻击的估计器的理论基石。它保证了我们有足够的“好”数据来对抗“坏”数据。

我们可以用一个更精炼的数学工具——**cospark**——来描述这个条件 。对于一个给定的矩阵 $H$，其cospark定义为非[零向量](@entry_id:156189) $v$ 通过该矩阵线性变换后，所得向量 $Hv$ 的最小可能非零元素个数，即 $\operatorname{cospark}(H) \triangleq \min_{v \neq 0} \|H v\|_{0}$。在状态估计问题中，$H$ 对应于从初始状态 $x_0$ 到整个观测时间窗内输出序列的映射。唯一可恢复性要求 $\operatorname{cospark}(H) > 2s$。这意味着任何非零的状态差异 $\Delta x$ 都会在输出序列中产生至少 $\operatorname{cospark}(H)$ 个非零项，如果这个数目大于攻击者所能伪造的非零项的最大数目（$2s$），那么状态就无法被混淆。因此，一个系统能容忍的最大攻击稀疏度 $s^\star$ 由下式决定：
$$
s^{\star} = \left\lceil \frac{\operatorname{cospark}(H)}{2} \right\rceil - 1
$$
这个公式为我们评估和设计具有可证明[安全保证](@entry_id:1131169)的传感架构提供了量化依据。

### 刻画攻击者能力：[隐蔽](@entry_id:196364)攻击

仅仅知道系统是否“可保卫”是不够的，我们还需要理解攻击者“如何进攻”。其中，最危险的攻击是**隐蔽攻击**（stealth attacks），即那些设计得难以被检测到的攻击。

许多攻击检测系统依赖于对测量残差（或新息）的监控。例如，一个**奇偶空间检测器**（parity-space detector）通过一个奇偶矩阵 $P$ 投射测量值来产生残差 $r_k=Py_k$，并检查其范数是否超出一个阈值。在加权最小二乘（WLS）估计的几何框架下，这个奇偶矩阵 $P$ 是一个将测量[向量投影](@entry_id:147046)到与状态矩阵 $C$ 的[列空间](@entry_id:156444) $\mathcal{R}(C)$ 正交的子空间上的[投影矩阵](@entry_id:154479)。

一个完美的隐蔽**[虚假数据注入](@entry_id:1124829)（FDI）攻击**，其目标就是不产生任何异常的残差。对于上述检测器，这意味着攻击向量 $a_k$ 在经过 $P$ 投影后为零，即 $Pa_k=0$。这等价于说，攻击向量 $a_k$ 必须位于[投影矩阵](@entry_id:154479) $P$ 的零空间 $\mathcal{N}(P)$ 中。在WLS的几何中，这个零空间恰好是状态矩阵 $C$ 的[列空间](@entry_id:156444) $\mathcal{R}(C)$ 。

这个结论意义重大：**如果一个攻击向量 $a_k$ 可以被表示为状态矩阵 $C$ 各[列的线性组合](@entry_id:150240)，即 $a_k = C d$（对于某个向量 $d$），那么这个攻击对于基于残差的检测器就是[隐蔽](@entry_id:196364)的**。这是因为从观测者的角度看，这样一个攻击向量与一个由真实状态变化 $d$ 所引起的测量变化 $Cd$ 是无法区分的。

攻击者可以利用这一点来精确地操纵状态估计。如果攻击者希望在不被发现的情况下，使状态估计产生一个特定的偏差 $\Delta \hat{x}_k = d$，他只需注入一个攻击向量 $a_k = C d$ 即可。计算表明，这恰好会导致估计偏差为 $d$。这揭示了[隐蔽](@entry_id:196364)攻击的强大威力：它们不仅能破坏估计的准确性，还能以一种可控的方式将其引向攻击者选择的任意错误状态 。

### [安全状态估计](@entry_id:1131370)的机制

基于以上原理，研究者们发展了多种机制来设计安全的估计器。这些方法通常可以分为几个不同的流派。

#### [鲁棒滤波](@entry_id:754387)方法：$H_{\infty}$估计

$H_{\infty}$ 滤波是一种经典的[鲁棒控制](@entry_id:260994)方法，其目标不是像卡尔曼滤波器那样在特定的噪声统计假设下最小化均方误差，而是在**最坏情况**下（worst-case）抑制扰动对[估计误差](@entry_id:263890)的影响。这里的“扰动”可以同时包括随机噪声和恶意攻击，而无需对它们的统计特性做过多假设，只需假设其能量有界。

$H_{\infty}$ 滤波器的设计目标是最小化从扰动输入 $u_k = [w_k^T, a_k^T]^T$ 到[估计误差](@entry_id:263890) $e_k$ 的**诱导$\ell_2$范数**，通常表示为 $\gamma$。这个值代表了系统在最坏情况下对扰动能量的放大倍数：
$$
\gamma = \sup_{\{u_{k}\} \neq 0} \left( \frac{\sum_{k=0}^{\infty} \|e_{k}\|^{2}}{\sum_{k=0}^{\infty} \|u_{k}\|^{2}} \right)^{\frac{1}{2}}
$$
对于一个给定的性能水平 $\gamma$，我们可以通过求解一个**Riccati类不等式**来确定是否存在一个能满足该性能的滤波器。这个不等式的存在性保证了[估计误差](@entry_id:263890)的能量不会超过扰动总能量的 $\gamma^2$ 倍 。通过优化增益来最小化 $\gamma$，我们可以设计出一个对未知有界扰动具有最强抑制能力的估计器。这种方法将攻击视为一种有界的能量扰动，为处理非随机性的对抗信号提供了一个强有力的数学框架。

#### 博弈论方法

另一种视角是将状态估计问题建模为估计器与攻击者之间的**[零和博弈](@entry_id:262375)**（zero-sum game）。在这个博弈中：
- **估计器**的目标是选择一个增益 $K$ 来最小化某个性能指标（例如，均方估计误差）。
- **攻击者**的目标是选择一个攻击信号 $a_k$ 来最大化同一个性能指标。攻击者自身的行动通常会带有成本，例如注入的攻击能量 $a_k^2$ 越大，被其他机制检测到的风险也越高，因此其[效用函数](@entry_id:137807)会包含一个惩罚项 $-\lambda a_k^2$。

博弈的解是一个**鞍点均衡** $(K^\star, a_k^\star)$，在该点，任何一方单方面偏离其策略都无法获得更好的结果。通过分析这个博弈，我们可以获得关于双方最优策略的深刻洞见。例如，在一个简单的标量系统中，可以证明，如果攻击成本系数 $\lambda$ 足够大（例如，$\lambda \ge 1$），那么攻击者在均衡点的最优策略是选择不攻击（$a_k^\star = 0$）。这是因为攻击带来的“收益”不足以抵消其成本。在这种情况下，估计器的最优策略则退化为经典的[维纳滤波器](@entry_id:264227)（Wiener filter）增益。这个结果表明，通过增加攻击者的成本（例如，部署更灵敏的异常检测器），可以威慑其发动攻击，从而使系统恢复到接近常规的最优估计状态 。

#### [完整性攻击](@entry_id:1126561)与可用性攻击的对比

最后，区分不同类型的网络攻击至关重要，因为它们对估计器的影响和应对策略截然不同。我们主要关注两类 ：
- **[完整性攻击](@entry_id:1126561) (Integrity Attacks)**：攻击者篡改、替换或注入虚假数据，如前文讨论的FDI攻击。这会向估计器提供误导性信息。
- **可用性攻击 (Availability Attacks)**：攻击者通过丢弃或延迟数据包来阻止信息到达估计器。这会导致信息缺失。

对于一个开环不稳定的系统（例如，系统矩阵 $A$ 的特征值模大于1），这两种攻击的影响有本质区别。
- 在**可用性攻击**（如随机[丢包](@entry_id:269936)）下，即使系统的[结构可观测性](@entry_id:755558)不变，估计器的性能也可能严重退化。对于一个不稳定的系统，卡尔曼滤波器的均方误差能否保持有界，取决于数据包的到达概率 $p$。存在一个**[临界概率](@entry_id:182169)** $p_c$（其值取决于系统不稳定的模式，例如 $p_c = 1 - 1/|a|^2$），只有当 $p>p_c$ 时，估计误差的期望协方差才能保持有界。如果数据包丢失率太高，以至于 $p \le p_c$，那么即使是理论上最优的估计器也无法阻止[估计误差](@entry_id:263890)的发散 。
- 相比之下，**[完整性攻击](@entry_id:1126561)**的威胁可能更大。如前所述，即使所有数据包都到达（$p=1$），一个精心设计的、无界的攻击序列 $\{a_k\}$ 也可以轻易地导致[估计误差](@entry_id:263890)无界。简单地调整滤波器增益无法解决这个问题，因为这涉及到与一个有智能的对手的对抗，而不是与一个[随机过程](@entry_id:268487)的博弈。

总而言之，可用性攻击挑战的是在信息不完整的情况下维持稳定性的能力，而[完整性攻击](@entry_id:1126561)则挑战的是在信息被污染的情况下辨别真伪的能力。这两种挑战需要不同的分析工具和[防御机制](@entry_id:897208)，前者通常涉及[随机稳定性](@entry_id:196796)理论，而后者则更多地依赖于[稀疏恢复](@entry_id:199430)、[鲁棒估计](@entry_id:261282)和博弈论等技术。