{
    "hands_on_practices": [
        {
            "introduction": "离散时间马尔可夫链 (DTMC) 是对网络物理系统状态演化进行建模的基础工具。通过将系统行为抽象为一组状态和转移概率，我们可以精确分析系统动态。本练习  将指导您如何为一个“到达-规避”事件（一种常见的系统失效形式）计算其发生概率，您将通过建立并求解一组从模型动态中导出的线性方程组来完成此任务。这项实践将抽象的时间逻辑规范与具体的概率计算联系起来，有助于加深对模型检测核心思想的理解。",
            "id": "4238425",
            "problem": "一个微电网信息物理系统（CPS）的数字孪生被用于评估在级联保护动作和故障传播下的韧性。其离散事件演化被建模为一个离散时间马尔可夫链（DTMC）。状态为 $\\{s_0, s_1, s_2, s_3, a, b\\}$，其中 $a$ 表示一次不可恢复的非安全停机，$b$ 表示成功恢复到标称操作。系统从 $s_0$ 开始。令 $A=\\{a\\}$ 且 $B=\\{b\\}$。转移概率如下（任何未明确列出的转移概率为 $0$）：\n- 从 $s_0$ 出发：以概率 $\\frac{1}{100}$ 转移到 $s_1$，以概率 $\\frac{99}{100}$ 转移到 $s_3$。\n- 从 $s_3$ 出发：以概率 $\\frac{9}{10}$ 转移到 $b$，以概率 $\\frac{1}{10}$ 转移到 $s_1$。\n- 从 $s_1$ 出发：以概率 $\\frac{1}{10}$ 转移到 $s_2$，以概率 $\\frac{9}{10}$ 转移到 $s_3$。\n- 从 $s_2$ 出发：以概率 $\\frac{1}{20}$ 转移到 $a$，以概率 $\\frac{19}{20}$ 转移到 $s_3$。\n- 状态 $a$ 和 $b$ 是吸收态。\n\n用于韧性分析的稀有事件是“在到达 $B$ 之前到达 $A$”，即系统在成功恢复之前进入非安全停机状态。使用马尔可夫过程的到达-规避概率的基本定义，并仅从马尔可夫性质和全概率定律出发，完成以下任务：\n1) 构造一个概率计算树逻辑（PCTL）中的概率时序逻辑规范，该规范编码了从初始状态开始“在到达 $B$ 之前到达 $A$”的事件。\n2) 推导、建立并求解一个最小非负线性方程组，该方程组给出从状态 $s$ 开始在到达 $B$ 之前到达 $A$ 的概率 $p(s)$，其中狄利克雷边界条件为 $p(a)=1$ 和 $p(b)=0$。然后计算在初始状态的值 $p(s_0)$。\n\n将 $p(s_0)$ 的最终数值答案表示为最简分数。不要使用百分号。无需四舍五入。",
            "solution": "该问题是有效的，因为它在科学上基于马尔可夫链理论，具有唯一可解结构的适定性，并使用客观、形式化的语言陈述。它是自洽且无矛盾的。\n\n该问题要求完成两项任务：构造一个概率计算树逻辑（PCTL）规范，以及求解一个关于到达-规避概率的线性方程组。\n\n### 第1部分：PCTL规范\n\n我们关注的事件是“在到达集合 $B$ 之前到达集合 $A$”。在时序逻辑的背景下，这是一个“到达-规避”属性。给定集合 $A = \\{a\\}$ 和 $B = \\{b\\}$。该属性要求，任何通过状态空间的有效路径最终必须到达状态 $a$，并且在到达 $a$ 之前沿此路径访问的所有状态都不能是状态 $b$。\n\n概率计算树逻辑（PCTL）是一种用于为马尔可夫链等概率系统形式化指定此类属性的逻辑。PCTL公式指定了从某个状态开始的路径属性。特定的“在到达 $A$ 之前到达 $B$”属性很自然地可以用“直到”运算符（表示为 $\\text{U}$）来表达。\n\n路径公式 $\\phi_1 \\text{ U } \\phi_2$ 断言在未来的某个时间步，属性 $\\phi_2$ 成立，并且在之前的所有时间步，属性 $\\phi_1$ 均成立。\n\n为了形式化我们的特定事件，我们定义原子命题。令命题 $a$ 为真当且仅当系统处于状态 $a$，令命题 $b$ 为真当且仅当系统处于状态 $b$。\n条件“规避 $B$”意味着不处于状态 $b$，这由逻辑公式 $\\neg b$ 表示。条件“到达 $A$”意味着到达状态 $a$，这由原子命题 $a$ 表示。\n\n因此，编码“在到达 $b$ 之前到达 $a$”的路径公式为：\n$$ (\\neg b) \\text{ U } a $$\n该公式指定了系统必须保持在非 $b$ 状态，*直到*最终到达状态 $a$。从初始状态 $s_0$ 找到该稀有事件概率的问题，对应于在状态 $s_0$ 评估 PCTL 查询 $P_{=?}[(\\neg b) \\text{ U } a]$。\n\n### 第2部分：方程组的推导与求解\n\n令 $p(s)$ 表示从状态 $s$ 开始“在到达 $A$ 之前到达 $B$”事件的概率。我们需要计算 $p(s_0)$。该分析依赖于全概率定律和马尔可夫性质。\n\n边界条件定义在吸收集 $A=\\{a\\}$ 和 $B=\\{b\\}$ 上。\n1. 如果系统从状态 $a \\in A$ 开始，它已经到达 $A$ 而没有经过 $B$。因此，概率为 $1$。所以，$p(a) = 1$。\n2. 如果系统从状态 $b \\in B$ 开始，它未能实现在到达 $B$ 之前到达 $A$。因此，概率为 $0$。所以，$p(b) = 0$。\n这些是指定的狄利克雷边界条件。\n\n对于任何非吸收（暂态）状态 $s \\notin A \\cup B$，我们可以通过对下一时间步的状态 $s'$ 进行条件化来表示 $p(s)$。令 $T(s, s')$ 为从状态 $s$ 到 $s'$ 的转移概率。根据全概率定律：\n$$ p(s) = \\sum_{s'} P(\\text{reach } A \\text{ before } B \\mid \\text{next is } s') \\cdot T(s,s') $$\n根据马尔可夫性质，从下一个状态 $s'$ 开始发生该事件的概率就是 $p(s')$。这就得出了核心的线性方程组：\n$$ p(s) = \\sum_{s'} T(s,s') \\cdot p(s') $$\n我们记 $p_i = p(s_i)$，其中 $i \\in \\{0, 1, 2, 3\\}$。现在我们可以利用给定的转移概率写出暂态 $s_0, s_1, s_2, s_3$ 的方程。\n\n对于状态 $s_0$：\n$p_0 = T(s_0, s_1)p(s_1) + T(s_0, s_3)p(s_3) = \\frac{1}{100}p_1 + \\frac{99}{100}p_3$\n\n对于状态 $s_1$：\n$p_1 = T(s_1, s_2)p(s_2) + T(s_1, s_3)p(s_3) = \\frac{1}{10}p_2 + \\frac{9}{10}p_3$\n\n对于状态 $s_2$：\n$p_2 = T(s_2, a)p(a) + T(s_2, s_3)p(s_3) = \\frac{1}{20}(1) + \\frac{19}{20}p_3$\n\n对于状态 $s_3$：\n$p_3 = T(s_3, b)p(b) + T(s_3, s_1)p(s_1) = \\frac{9}{10}(0) + \\frac{1}{10}p_1$\n\n这就构成了一个关于四个未知概率 $p_0, p_1, p_2, p_3$ 的四元线性方程组：\n1. $p_0 = \\frac{1}{100} p_1 + \\frac{99}{100} p_3$\n2. $p_1 = \\frac{1}{10} p_2 + \\frac{9}{10} p_3$\n3. $p_2 = \\frac{1}{20} + \\frac{19}{20} p_3$\n4. $p_3 = \\frac{1}{10} p_1$\n\n我们使用代入法求解该方程组。由方程（4）可得：\n$$ p_1 = 10 p_3 $$\n将这个 $p_1$ 的表达式代入方程（2）：\n$$ 10 p_3 = \\frac{1}{10} p_2 + \\frac{9}{10} p_3 $$\n两边乘以 $10$ 去分母：\n$$ 100 p_3 = p_2 + 9 p_3 $$\n$$ p_2 = 100 p_3 - 9 p_3 = 91 p_3 $$\n现在，将这个 $p_2$ 的表达式代入方程（3）：\n$$ 91 p_3 = \\frac{1}{20} + \\frac{19}{20} p_3 $$\n两边乘以 $20$：\n$$ 1820 p_3 = 1 + 19 p_3 $$\n$$ 1820 p_3 - 19 p_3 = 1 $$\n$$ 1801 p_3 = 1 $$\n$$ p_3 = \\frac{1}{1801} $$\n现在我们可以通过回代 $p_1$ 和 $p_3$ 的表达式来求出 $p_0$ 的值。由方程（1）：\n$$ p_0 = \\frac{1}{100} p_1 + \\frac{99}{100} p_3 $$\n代入 $p_1 = 10 p_3$：\n$$ p_0 = \\frac{1}{100} (10 p_3) + \\frac{99}{100} p_3 = \\frac{10 p_3 + 99 p_3}{100} = \\frac{109 p_3}{100} $$\n最后，代入 $p_3$ 的值：\n$$ p_0 = \\frac{109}{100} \\left(\\frac{1}{1801}\\right) = \\frac{109}{180100} $$\n数字 $109$ 是一个质数。要检查分数是否可以约分，我们必须检查 $180100$ 是否能被 $109$ 整除。由于 $180100 = 1801 \\times 100$，我们检查 $1801$ 是否能被 $109$ 整除。\n$$ \\frac{1801}{109} = 16.522... $$\n$1801$ 不能被 $109$ 整除。因此，分数 $\\frac{109}{180100}$ 是最简形式。\n\n所求的值是 $p(s_0) = \\frac{109}{180100}$。",
            "answer": "$$\\boxed{\\frac{109}{180100}}$$"
        },
        {
            "introduction": "现实世界的系统通常存在多种潜在的失效模式，而韧性分析则要求我们管理任一失效模式发生的总风险。本练习  探讨如何处理联合概率，以确保整个系统的安全性。它将演示如何利用容斥原理，与布尔不等式等简单方法相比，得出更紧的系统风险界限，从而实现更高效的安全预算分配。",
            "id": "4238436",
            "problem": "一个信息物理系统 (CPS) 在一个弹性微电网中协调三个耦合的安全机制：电压保护、频率调节和热管理。该微电网的数字孪生 (DT) 使用重要性采样 (IS) 运行稀有事件模拟，以监控和量化在 $10$ 分钟运行周期内发生安全违规的概率。令安全违规事件分别表示为 $A_{1}$ (电压违规)、$A_{2}$ (频率违规) 和 $A_{3}$ (热力违规)。\n\n为验证弹性，操作员施加了一个联合机会约束 $ \\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon $，目标风险预算为 $ \\varepsilon = 1.0 \\times 10^{-4} $。为简化策略设计，操作员为 $ i \\in \\{1,2,3\\} $ 分配了相等的边际风险预算 $ \\mathbb{P}(A_{i}) \\leq \\alpha $。\n\n该数字孪生的稀有事件模拟输出了针对两两交集的高置信度双侧置信区间 (CI)，以及针对三重交集的单侧界：\n- 关于 $ \\mathbb{P}(A_{i} \\cap A_{j}) $ 的置信下界 $ \\ell_{12} = 6.0 \\times 10^{-6} $, $ \\ell_{13} = 4.0 \\times 10^{-6} $, $ \\ell_{23} = 5.0 \\times 10^{-6} $，\n- 关于 $ \\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3}) $ 的置信上界 $ \\tau = 1.0 \\times 10^{-8} $。\n\n从概率公理出发，应用布尔不等式（并集界）将联合机会约束分解到三个安全约束上，然后利用容斥原理（邦费罗尼截断）设计一个更紧的保守近似，该近似利用了可用的交集界。在给定的数字孪生估计的界限下，从第一性原理推导能够保证 $ \\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon $ 的最大相等边际分配 $ \\alpha $。\n\n使用所提供的值数值计算此 $ \\alpha $。将最终答案表示为小数并四舍五入到四位有效数字。",
            "solution": "首先验证问题以确保其科学性、适定性、客观性和完整性。提取并检查所有给定条件。\n- 事件：$A_{1}$ (电压违规)、$A_{2}$ (频率违规)、$A_{3}$ (热力违规)。\n- 联合机会约束：$\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$。\n- 目标风险预算：$\\varepsilon = 1.0 \\times 10^{-4}$。\n- 边际风险预算约束：对于 $i \\in \\{1,2,3\\}$，$\\mathbb{P}(A_{i}) \\leq \\alpha$。\n- 两两交集的置信下界：$\\mathbb{P}(A_1 \\cap A_2) \\geq \\ell_{12} = 6.0 \\times 10^{-6}$，$\\mathbb{P}(A_1 \\cap A_3) \\geq \\ell_{13} = 4.0 \\times 10^{-6}$，$\\mathbb{P}(A_2 \\cap A_3) \\geq \\ell_{23} = 5.0 \\times 10^{-6}$。\n- 三重交集的置信上界：$\\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3}) \\leq \\tau = 1.0 \\times 10^{-8}$。\n\n该问题是概率论，特别是容斥原理，在工程弹性和风险分析领域的标准应用。术语精确，数据一致，目标明确。问题有效，我们可以继续进行求解。\n\n我们的目标是，在边际概率和交集概率的约束下，找到能够保证满足联合机会约束 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$ 的边际风险预算 $\\alpha$ 的最大值。\n\n问题要求我们从第一性原理出发。三个事件 $A_1$、$A_2$ 和 $A_3$ 的并集概率由容斥原理给出：\n$$\n\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) = \\sum_{i=1}^{3} \\mathbb{P}(A_{i}) - \\sum_{1 \\leq i  j \\leq 3} \\mathbb{P}(A_{i} \\cap A_{j}) + \\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3})\n$$\n该问题将布尔不等式（一个简单的并集界）与一个更紧的近似进行了对比。布尔不等式表明 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\sum_{i=1}^{3} \\mathbb{P}(A_{i})$。使用边际风险预算 $\\mathbb{P}(A_i) \\leq \\alpha$，可得 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq 3\\alpha$。这是一个忽略了事件交集信息的保守界。\n\n为了推导所要求的更紧的保守近似，我们必须使用所有可用信息来确定 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3})$ 的最严格上界。我们按如下方式对容斥公式中的每一项进行限定：\n1.  对于边际概率之和：问题陈述了对于 $i \\in \\{1,2,3\\}$ 有 $\\mathbb{P}(A_{i}) \\leq \\alpha$。因此，其和的上有界为：\n    $$ \\sum_{i=1}^{3} \\mathbb{P}(A_{i}) = \\mathbb{P}(A_{1}) + \\mathbb{P}(A_{2}) + \\mathbb{P}(A_{3}) \\leq \\alpha + \\alpha + \\alpha = 3\\alpha $$\n2.  对于两两交集概率之和：公式中的项为负，即 $- \\sum \\mathbb{P}(A_{i} \\cap A_{j})$。问题提供了这些概率的置信下界：$\\mathbb{P}(A_{i} \\cap A_{j}) \\geq \\ell_{ij}$。乘以 $-1$ 会反转不等式，从而得到负项的上界：$-\\mathbb{P}(A_{i} \\cap A_{j}) \\leq -\\ell_{ij}$。因此，其和的上有界为：\n    $$ - \\sum_{1 \\leq i  j \\leq 3} \\mathbb{P}(A_{i} \\cap A_{j}) \\leq -(\\ell_{12} + \\ell_{13} + \\ell_{23}) $$\n3.  对于三重交集概率：问题直接提供了一个置信上界：\n    $$ \\mathbb{P}(A_{1} \\cap A_{2} \\cap A_{3}) \\leq \\tau $$\n\n结合这些单独的上界，我们可以为并集概率构建一个总上界：\n$$\n\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq 3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau\n$$\n这就是代表更紧保守近似的邦费罗尼型不等式。为保证联合机会约束 $\\mathbb{P}(A_{1} \\cup A_{2} \\cup A_{3}) \\leq \\varepsilon$，我们必须确保我们推导出的上界本身小于或等于 $\\varepsilon$：\n$$\n3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau \\leq \\varepsilon\n$$\n我们被要求找到满足此条件的 $\\alpha$ 的最大可能值。当不等式变为等式时，可以达到这个最大值：\n$$\n3\\alpha - (\\ell_{12} + \\ell_{13} + \\ell_{23}) + \\tau = \\varepsilon\n$$\n求解 $\\alpha$，我们得到：\n$$\n3\\alpha = \\varepsilon + \\ell_{12} + \\ell_{13} + \\ell_{23} - \\tau\n$$\n$$\n\\alpha = \\frac{1}{3} (\\varepsilon + \\ell_{12} + \\ell_{13} + \\ell_{23} - \\tau)\n$$\n现在，我们将提供的数值代入此表达式：\n$\\varepsilon = 1.0 \\times 10^{-4}$\n$\\ell_{12} = 6.0 \\times 10^{-6}$\n$\\ell_{13} = 4.0 \\times 10^{-6}$\n$\\ell_{23} = 5.0 \\times 10^{-6}$\n$\\tau = 1.0 \\times 10^{-8}$\n\n首先，对两两交集的下界求和：\n$$\n\\ell_{12} + \\ell_{13} + \\ell_{23} = (6.0 + 4.0 + 5.0) \\times 10^{-6} = 15.0 \\times 10^{-6}\n$$\n现在将所有值代入 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\frac{1}{3} (1.0 \\times 10^{-4} + 15.0 \\times 10^{-6} - 1.0 \\times 10^{-8})\n$$\n为了进行算术运算，我们将所有数字表示为以 $10$ 为底的相同幂次，例如 $10^{-8}$：\n$1.0 \\times 10^{-4} = 10000 \\times 10^{-8}$\n$15.0 \\times 10^{-6} = 1500 \\times 10^{-8}$\n$1.0 \\times 10^{-8} = 1 \\times 10^{-8}$\n$$\n\\alpha = \\frac{1}{3} (10000 \\times 10^{-8} + 1500 \\times 10^{-8} - 1 \\times 10^{-8})\n$$\n$$\n\\alpha = \\frac{1}{3} (10000 + 1500 - 1) \\times 10^{-8}\n$$\n$$\n\\alpha = \\frac{11499}{3} \\times 10^{-8}\n$$\n$$\n\\alpha = 3833 \\times 10^{-8}\n$$\n按照要求，将其表示为标准科学记数法并四舍五入到四位有效数字：\n$$\n\\alpha = 3.833 \\times 10^{-5}\n$$\n这是在数字孪生模拟提供的保守界限下，保证满足联合机会约束的最大边际风险预算 $\\alpha$。",
            "answer": "$$ \\boxed{3.833 \\times 10^{-5}} $$"
        },
        {
            "introduction": "在实践中，我们面临的一大挑战是如何量化那些由于发生概率极低而未能在数据集中直接观测到的事件。本练习  引入了极值理论 (EVT) 中的强大工具——超阈值峰值 (POT) 方法和广义帕累托分布 (GPD)。通过这项实践，您将亲手操作，学习如何将 GPD 模型拟合到数据中，从而外推和估计极端、高影响事件的发生概率和量级。",
            "id": "4238483",
            "problem": "一个信息物理系统（CPS）的数字孪生在平稳条件下以固定的采样频率监控一个无量纲的弹性应力指标 $X$（单位，p.u.）。为了支持罕见事件模拟和弹性分析，采用了一种超阈峰值模型。设阈值为 $u$，并假设在 $X > u$ 条件下的超出量 $Y = X - u$ 服从广义帕累托分布（GPD, Generalized Pareto Distribution），其尺度参数为 $\\sigma > 0$，形状参数为 $\\xi \\in \\mathbb{R}$。对于 $\\xi \\neq 0$，GPD 的累积分布函数为\n$$\nH(y) \\;=\\; 1 - \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}, \\quad y \\ge 0,\n$$\n且对于 $x \\ge u$ 的相应尾部概率满足\n$$\nP(X > x) \\;=\\; P(X > u) \\, P(Y > x - u \\mid X > u).\n$$\n一项为期一年的罕见事件模拟产生了 $N$ 个样本，其中有 $k$ 个超出阈值 $u$ 的事件，得到的经验超出概率为 $p_u = P(X > u) \\approx k/N$。对超出量进行 GPD 的最大似然拟合，得到了参数估计值 $\\hat{\\sigma}$ 和 $\\hat{\\xi}$，以及在最大似然估计处关于 $(\\sigma, \\xi)$ 的观测 Fisher 信息矩阵 $I(\\hat{\\sigma}, \\hat{\\xi})$。\n\n给定以下科学上合理的量，其中 $X$ 和 $u$ 均以单位值（p.u.）表示：\n- 阈值 $u = 1.05$，\n- 样本量 $N = 5.0 \\times 10^{6}$，\n- 超出量数量 $k = 2500$，因此 $p_u = k/N = 5.0 \\times 10^{-4}$，\n- GPD 最大似然估计 $\\hat{\\sigma} = 0.06$ 和 $\\hat{\\xi} = 0.20$，\n- 在 $(\\hat{\\sigma}, \\hat{\\xi})$ 处的观测 Fisher 信息矩阵由下式给出\n$$\nI(\\hat{\\sigma}, \\hat{\\xi}) \\;=\\;\n\\begin{pmatrix}\n700000  -3000 \\\\\n-3000  12000\n\\end{pmatrix},\n$$\n以及一个目标极端尾部概率 $p = 1.0 \\times 10^{-6}$，\n\n基于以上基础，推导由 $P(X > q_p) = p$ 隐式定义的极端分位数 $q_p$ 的解析表达式，然后通过代入 $(u, p_u, p, \\hat{\\sigma}, \\hat{\\xi})$ 计算最大似然估计值 $\\hat{q}_p$。\n\n此外，解释如何使用关于标量兴趣参数 $q_p$ 的剖面似然来评估 $q_p$ 的不确定性，包括为消除讨厌参数所需的重参数化，以及在 $\\hat{q}_p$ 处剖面对数似然的曲率解释。使用提供的 $I(\\hat{\\sigma}, \\hat{\\xi})$，通过在最大似然估计处的剖面似然曲率计算 $\\hat{q}_p$ 的渐近标准误。\n\n你的最终数值报告应为单一值 $\\hat{q}_p$。将最终答案四舍五入至四位有效数字。以 p.u.（单位）表示最终分位数。",
            "solution": "该问题陈述经评估具有科学依据、提法恰当、客观且完整。它基于极值理论和统计推断的既定原则。所有必要数据均已提供，且无内部矛盾。因此，该问题被认为是有效的，并在此给出完整解答。\n\n解答分为两个主要部分。首先，我们推导极端分位数 $q_p$ 的解析表达式，并计算其最大似然估计值 $\\hat{q_p}$。其次，我们描述使用剖面似然进行不确定性评估的方法，并通过计算上等效的 Delta 方法计算 $\\hat{q}_p$ 的渐近标准误。\n\n**第一部分：极端分位数 $\\hat{q}_p$ 的推导与计算**\n\n极端分位数 $q_p$ 由方程 $P(X > q_p) = p$ 隐式定义，其中 $p$ 是目标极端尾部概率。问题提供了 $X$ 分布尾部的模型。对于高于阈值 $u$ 的点 $x$，尾部概率由下式给出：\n$$\nP(X > x) = P(X > u) \\, P(Y > x - u \\mid X > u)\n$$\n此处，$Y = X - u$ 表示超出阈值 $u$ 的量。概率 $P(X > u)$ 由 $p_u = k/N$ 估计。条件概率 $P(Y > y \\mid X > u)$ 对应于广义帕累托分布（GPD）的生存函数，我们记为 $\\bar{H}(y)$。对于 $\\xi \\neq 0$ 的 GPD 累积分布函数（CDF）给出如下：\n$$\nH(y) = 1 - \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}\n$$\n相应的生存函数为：\n$$\n\\bar{H}(y) = 1 - H(y) = \\left(1 + \\frac{\\xi y}{\\sigma}\\right)^{-1/\\xi}\n$$\n将这些代入尾部概率公式，令 $x = q_p$ 和 $y = q_p - u$，我们得到：\n$$\nP(X > q_p) = p_u \\, \\bar{H}(q_p - u)\n$$\n$$\np = p_u \\left(1 + \\frac{\\xi (q_p - u)}{\\sigma}\\right)^{-1/\\xi}\n$$\n我们现在解此方程以求得 $q_p$ 的解析表达式：\n$$\n\\frac{p}{p_u} = \\left(1 + \\frac{\\xi (q_p - u)}{\\sigma}\\right)^{-1/\\xi}\n$$\n将两边同时取 $-\\xi$ 次幂：\n$$\n\\left(\\frac{p}{p_u}\\right)^{-\\xi} = 1 + \\frac{\\xi (q_p - u)}{\\sigma}\n$$\n重新整理以分离出含 $q_p$ 的项：\n$$\n\\left(\\frac{p}{p_u}\\right)^{-\\xi} - 1 = \\frac{\\xi (q_p - u)}{\\sigma}\n$$\n最后，解出 $q_p$：\n$$\nq_p = u + \\frac{\\sigma}{\\xi} \\left[ \\left(\\frac{p}{p_u}\\right)^{-\\xi} - 1 \\right]\n$$\n这就是所需的极端分位数 $q_p$ 的解析表达式。\n\n为了计算最大似然估计值 $\\hat{q}_p$，我们将给定的数值和参数估计值代入此表达式：\n$u = 1.05$, $p_u = 5.0 \\times 10^{-4}$, $p = 1.0 \\times 10^{-6}$, $\\hat{\\sigma} = 0.06$, 和 $\\hat{\\xi} = 0.20$。\n\n概率之比为：\n$$\n\\frac{p}{p_u} = \\frac{1.0 \\times 10^{-6}}{5.0 \\times 10^{-4}} = \\frac{1}{500} = 0.002\n$$\n将这些值代入 $\\hat{q}_p$ 的表达式中：\n$$\n\\hat{q}_p = 1.05 + \\frac{0.06}{0.20} \\left[ \\left(0.002\\right)^{-0.20} - 1 \\right]\n$$\n$$\n\\hat{q}_p = 1.05 + 0.3 \\left[ \\left(500\\right)^{0.2} - 1 \\right]\n$$\n我们计算 $(500)^{0.2}$ 的值：\n$$\n(500)^{0.2} = (500)^{1/5} \\approx 3.4657359\n$$\n现在，将此值代回 $\\hat{q}_p$ 的表达式中：\n$$\n\\hat{q}_p = 1.05 + 0.3 (3.4657359 - 1) = 1.05 + 0.3(2.4657359)\n$$\n$$\n\\hat{q}_p = 1.05 + 0.73972077 = 1.78972077\n$$\n四舍五入到四位有效数字，我们得到 $\\hat{q}_p \\approx 1.790$。\n\n**第二部分：$\\hat{q}_p$ 的不确定性评估**\n\n估计值 $\\hat{q}_p$ 的不确定性源于最大似然估计值 $\\hat{\\sigma}$ 和 $\\hat{\\xi}$ 的统计不确定性。评估这种不确定性的标准方法是使用剖面似然。\n\n分位数 $q_p$ 是模型参数 $(\\sigma, \\xi)$ 的函数。我们的兴趣参数是 $\\psi_1 = q_p(\\sigma, \\xi)$，而另一个参数可被视为讨厌参数。为了使用剖面似然，我们将模型从 $(\\sigma, \\xi)$ 重参数化为一组新参数 $(\\psi_1, \\psi_2)$，其中 $\\psi_1=q_p$，$\\psi_2$ 是一个讨厌参数，方便起见选择为 $\\psi_2=\\xi$。我们可以用 $(q_p, \\xi)$ 来表示 $(\\sigma, \\xi)$：\n$$\n\\xi = \\psi_2\n$$\n$$\n\\sigma = \\frac{\\xi(q_p - u)}{\\left(p/p_u\\right)^{-\\xi} - 1} = \\frac{\\psi_2(q_p - u)}{\\left(p/p_u\\right)^{-\\psi_2} - 1}\n$$\n对数似然函数 $l(\\sigma, \\xi)$ 可以重写为 $l^*(q_p, \\xi)$。$q_p$ 的剖面对数似然函数则定义为：\n$$\nl_{\\text{prof}}(q_p) = \\max_{\\xi} l^*(q_p, \\xi)\n$$\n对于每个固定的 $q_p$ 值，我们找到使似然最大化的讨厌参数 $\\xi$ 的值。得到的函数 $l_{\\text{prof}}(q_p)$ 在最大似然估计（MLE） $\\hat{q}_p$ 处达到最大值。\n剖面对数似然函数在其峰值处的曲率提供了不确定性的估计。具体来说，$\\hat{q}_p$ 的渐近方差由在 $\\hat{q}_p$ 处求值的剖面对数似然的负二阶导数的倒数给出：\n$$\n\\text{Var}(\\hat{q}_p) \\approx \\left( - \\frac{d^2 l_{\\text{prof}}(q_p)}{dq_p^2} \\Big|_{q_p=\\hat{q}_p} \\right)^{-1}\n$$\n在计算上，使用 Delta 方法最方便地计算此方差，该方法提供相同的渐近结果。参数矢量 $\\theta$ 的函数 $g(\\theta)$ 的方差近似为 $\\text{Var}(g(\\hat{\\theta})) \\approx \\nabla g(\\hat{\\theta})^T \\text{Cov}(\\hat{\\theta}) \\nabla g(\\hat{\\theta})$。这里，$g$ 是 $q_p$ 的函数，$\\theta = (\\sigma, \\xi)$，协方差矩阵 $\\text{Cov}(\\hat{\\theta})$ 是观测 Fisher 信息矩阵的逆，即 $\\Sigma = I(\\hat{\\sigma}, \\hat{\\xi})^{-1}$。\n\n$\\hat{q}_p$ 的渐近标准误是 $\\text{SE}(\\hat{q}_p) = \\sqrt{\\text{Var}(\\hat{q}_p)}$。\n\n我们现在计算这个标准误。\n首先，我们求协方差矩阵 $\\Sigma = I^{-1}$：\n$$\nI = \\begin{pmatrix} 700000  -3000 \\\\ -3000  12000 \\end{pmatrix}\n$$\n行列式为 $\\det(I) = (700000)(12000) - (-3000)^2 = 8.4 \\times 10^9 - 9 \\times 10^6 = 8.391 \\times 10^9$。\n逆矩阵为：\n$$\n\\Sigma = I^{-1} = \\frac{1}{8.391 \\times 10^9} \\begin{pmatrix} 12000  3000 \\\\ 3000  700000 \\end{pmatrix} \\approx \\begin{pmatrix} 1.4301 \\times 10^{-6}  0.3575 \\times 10^{-6} \\\\ 0.3575 \\times 10^{-6}  8.3423 \\times 10^{-5} \\end{pmatrix}\n$$\n第二，我们计算梯度向量 $\\nabla q_p = (\\frac{\\partial q_p}{\\partial \\sigma}, \\frac{\\partial q_p}{\\partial \\xi})^T$ 并在 $(\\hat{\\sigma}, \\hat{\\xi})$ 处求值。\n设 $A = p/p_u = 0.002$。偏导数为：\n$$\n\\frac{\\partial q_p}{\\partial \\sigma} = \\frac{1}{\\xi} \\left[ A^{-\\xi} - 1 \\right]\n$$\n$$\n\\frac{\\partial q_p}{\\partial \\xi} = \\frac{\\sigma}{\\xi^2} \\left[ 1 - A^{-\\xi} \\right] - \\frac{\\sigma}{\\xi} \\ln(A) A^{-\\xi}\n$$\n在 $(\\hat{\\sigma}, \\hat{\\xi}) = (0.06, 0.20)$ 处求值：\n$$\n\\frac{\\partial q_p}{\\partial \\sigma} \\Big|_{MLE} = \\frac{1}{0.20} \\left[ (0.002)^{-0.20} - 1 \\right] = 5(3.4657359 - 1) = 12.32868\n$$\n$$\n\\frac{\\partial q_p}{\\partial \\xi} \\Big|_{MLE} = \\frac{0.06}{0.20^2} \\left[ 1 - (0.002)^{-0.20} \\right] - \\frac{0.06}{0.20} \\ln(0.002) (0.002)^{-0.20}\n$$\n$$\n= 1.5(1 - 3.4657359) - 0.3(-6.214608)(3.4657359)\n$$\n$$\n= 1.5(-2.4657359) + 6.46083 = -3.69860 + 6.46083 = 2.76223\n$$\n梯度向量为 $\\nabla \\hat{q}_p \\approx (12.32868, 2.76223)^T$。\n\n第三，我们计算方差：\n$$\n\\text{Var}(\\hat{q}_p) \\approx \\begin{pmatrix} 12.32868  2.76223 \\end{pmatrix} \\begin{pmatrix} 1.4301 \\times 10^{-6}  0.3575 \\times 10^{-6} \\\\ 0.3575 \\times 10^{-6}  8.3423 \\times 10^{-5} \\end{pmatrix} \\begin{pmatrix} 12.32868 \\\\ 2.76223 \\end{pmatrix}\n$$\n$\\text{Var}(\\hat{q}_p) \\approx (12.32868)^2(1.4301 \\times 10^{-6}) + (2.76223)^2(8.3423 \\times 10^{-5}) + 2(12.32868)(2.76223)(0.3575 \\times 10^{-6})$\n$\\text{Var}(\\hat{q}_p) \\approx (151.996)(1.4301 \\times 10^{-6}) + (7.6299)(8.3423 \\times 10^{-5}) + (68.125)(0.3575 \\times 10^{-6})$\n$\\text{Var}(\\hat{q}_p) \\approx 2.1737 \\times 10^{-4} + 6.3659 \\times 10^{-4} + 0.2435 \\times 10^{-4}$\n$\\text{Var}(\\hat{q}_p) \\approx 8.7831 \\times 10^{-4}$\n\n最后，标准误为：\n$$\n\\text{SE}(\\hat{q}_p) = \\sqrt{8.7831 \\times 10^{-4}} \\approx 0.02963\n$$\n这个值量化了估计值 $\\hat{q}_p = 1.790 \\text{ p.u.}$ 的不确定性。例如，一个近似的 $95\\%$ 置信区间将是 $\\hat{q}_p \\pm 1.96 \\times \\text{SE}(\\hat{q}_p)$。",
            "answer": "$$\n\\boxed{1.790}\n$$"
        }
    ]
}