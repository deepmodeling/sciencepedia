{
    "hands_on_practices": [
        {
            "introduction": "奇偶空间方法是一种强大的代数技术，用于生成与系统初始状态和控制输入解耦的残差，这使其在故障检测中极为有用。本练习  将指导你完成一个具体的、分步的计算过程：首先构造奇偶矩阵，然后计算残差，并最终利用预定义的故障特征向量来精确定位故障传感器的来源。这是基于模型的故障检测与诊断中的一项基本技能。",
            "id": "4221798",
            "problem": "一个离散时间线性时不变信息物理系统 (CPS) 在状态空间中建模为 $x_{k+1} = A x_{k} + B u_{k}$ 和 $y_{k} = C x_{k} + f b$，其中 $x_{k} \\in \\mathbb{R}^{n}$ 是状态，$u_{k} \\in \\mathbb{R}^{p}$ 是输入，$y_{k} \\in \\mathbb{R}^{m}$ 是传感器输出，$f \\in \\mathbb{R}^{m}$ 是一个未知的恒定传感器故障方向，如果第 $i$ 个传感器存在恒定偏差，则它等于一个规范基向量 $e_{i}$，$b \\in \\mathbb{R}$ 是（未知的）偏差大小。假设输入为零，$u_{k} = 0$，且初始条件 $x_{0}$ 未知。用于故障检测、隔离和诊断 (FDI) 的校验空间原理需要一个矩阵 $W$，使得 $W \\mathcal{O}_{L} = 0$，其中 $\\mathcal{O}_{L}$ 是在长度为 $L$ 的有限时域上的扩展可观测性矩阵。那么，校验残差 $r = W Y$ 对 $x_{0}$（以及当存在 $u_{k}$ 时对 $u_{k}$）不敏感，但对传感器故障敏感，其中 $Y$ 是该时域上的堆叠输出。\n\n考虑一个系统，其中 $n = 1$，$m = 2$，时域长度 $L = 2$，且\n$$\nA = [\\,0.6\\,], \\quad B = [\\,1\\,], \\quad C = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}.\n$$\n两步内的堆叠输出为 $Y = \\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix} \\in \\mathbb{R}^{4}$，扩展可观测性矩阵为\n$$\n\\mathcal{O}_{2} = \\begin{bmatrix} C \\\\ C A \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.6 \\\\ 1.2 \\end{bmatrix}.\n$$\n假设在该时域内恰好有一个传感器存在恒定偏差。测量的输出为\n$$\ny_{0} = \\begin{bmatrix} 1.9 \\\\ 3.0 \\end{bmatrix}, \\qquad y_{1} = \\begin{bmatrix} 1.3 \\\\ 1.8 \\end{bmatrix}.\n$$\n任务：\n1) 根据第一性原理，构造一个非平凡的校验矩阵 $W \\in \\mathbb{R}^{q \\times 4}$，其中 $q = 4 - 1 = 3$，使得 $W \\mathcal{O}_{2} = 0$。\n2) 使用校验残差的定义，计算 $r = W Y$。\n3) 为了进行隔离，定义校验空间中的故障特征向量 $s_{i} = W F_{L} e_{i}$，其中 $F_{L} = \\begin{bmatrix} I_{2} \\\\ I_{2} \\end{bmatrix}$ 且 $e_{i} \\in \\mathbb{R}^{2}$ 是第 $i$ 个规范基向量。设计一个决策规则，选择使归一化相关性\n$$\ng_{i} = \\frac{| \\langle r, s_{i} \\rangle |}{\\lVert r \\rVert \\, \\lVert s_{i} \\rVert},\n$$\n最大化的索引 $i$，并将其应用于给定数据。\n仅提供隔离出的传感器索引 $i$ 作为整数作为最终答案（使用从1开始的索引）。无需四舍五入，也无需单位。",
            "solution": "用户要求解答一个关于故障检测和隔离的问题。\n\n### 问题验证\n\n#### 第1步：提取已知条件\n\n系统模型是一个离散时间线性时不变 (LTI) 系统：\n- 状态方程：$x_{k+1} = A x_{k} + B u_{k}$\n- 输出方程：$y_{k} = C x_{k} + f b$\n\n参数和变量定义如下：\n- 状态：$x_{k} \\in \\mathbb{R}^{n}$\n- 输入：$u_{k} \\in \\mathbb{R}^{p}$\n- 输出：$y_{k} \\in \\mathbb{R}^{m}$\n- 未知的恒定传感器故障方向：$f \\in \\mathbb{R}^{m}$，其中对于传感器 $i$ 的故障，$f = e_{i}$。\n- 未知的偏差大小：$b \\in \\mathbb{R}$\n- 输入为零：$u_{k} = 0$\n- 初始条件 $x_{0}$ 未知。\n- 校验空间原理：找到矩阵 $W$ 使得 $W \\mathcal{O}_{L} = 0$，其中 $\\mathcal{O}_{L}$ 是在时域长度 $L$ 上的扩展可观测性矩阵。\n- 残差：$r = W Y$，其中 $Y$ 是堆叠输出向量。\n\n问题的具体数值：\n- 状态维度：$n = 1$\n- 输出维度：$m = 2$\n- 时域长度：$L = 2$\n- 系统矩阵：\n$$\nA = [\\,0.6\\,], \\quad B = [\\,1\\,], \\quad C = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\n- 堆叠输出向量：$Y = \\begin{bmatrix} y_{0} \\\\ y_{1} \\end{bmatrix} \\in \\mathbb{R}^{4}$\n- 扩展可观测性矩阵：\n$$\n\\mathcal{O}_{2} = \\begin{bmatrix} C \\\\ C A \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.6 \\\\ 1.2 \\end{bmatrix}\n$$\n- 测量的输出：\n$$\ny_{0} = \\begin{bmatrix} 1.9 \\\\ 3.0 \\end{bmatrix}, \\qquad y_{1} = \\begin{bmatrix} 1.3 \\\\ 1.8 \\end{bmatrix}\n$$\n- 故障条件：恰好有一个传感器存在恒定偏差。\n\n任务：\n1. 构造一个非平凡的校验矩阵 $W \\in \\mathbb{R}^{3 \\times 4}$，使得 $W \\mathcal{O}_{2} = 0$。\n2. 计算残差 $r = W Y$。\n3. 定义故障特征向量 $s_{i} = W F_{L} e_{i}$，其中 $F_{L} = \\begin{bmatrix} I_{2} \\\\ I_{2} \\end{bmatrix}$ 且 $e_{i} \\in \\mathbb{R}^{2}$ 为规范基向量。\n4. 设计并应用一个决策规则，通过最大化归一化相关性 $g_{i} = \\frac{| \\langle r, s_{i} \\rangle |}{\\lVert r \\rVert \\, \\lVert s_{i} \\rVert}$ 来隔离故障传感器的索引 $i$。\n\n#### 第2步：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题牢固地基于使用校验空间方法对LTI系统进行故障检测和隔离的既定理论。所有概念——状态空间模型、可观测性、校验残差和故障特征——都是控制工程和系统辨识中的标准概念。不存在科学或事实上的不健全之处。\n- **适定性：** 该问题提供了明确的目标和所有必要的数据（系统矩阵、测量值、定义），以完成所需的任务。其结构保证了故障隔离问题有唯一解。\n- **客观性：** 该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n该问题是在应用FDI原理方面的一个标准、定义明确的练习。它是有效的。\n\n### 解答\n\n解答过程通过处理问题陈述中指定的三个任务来进行。\n\n#### 任务1：构造校验矩阵 $W$\n\n校验矩阵 $W$ 必须满足条件 $W \\mathcal{O}_{2} = 0$。这意味着 $W$ 的行向量必须构成 $\\mathcal{O}_{2}$ 的左零空间的一组基。矩阵 $\\mathcal{O}_{2}$ 是一个 $4 \\times 1$ 的矩阵：\n$$\n\\mathcal{O}_{2} = \\begin{bmatrix} 1 \\\\ 2 \\\\ 0.6 \\\\ 1.2 \\end{bmatrix}\n$$\n$\\mathcal{O}_{2}$ 的秩为 $1$。$\\mathcal{O}_{2} \\in \\mathbb{R}^{4 \\times 1}$ 的左零空间的维度为 $4 - \\text{rank}(\\mathcal{O}_{2}) = 4 - 1 = 3$。这与 $W$ 所要求的行维度 $q=3$ 相匹配。设 $W$ 的一个行向量为 $w^{T} = \\begin{bmatrix} w_1  w_2  w_3  w_4 \\end{bmatrix}$。条件 $w^{T}\\mathcal{O}_{2} = 0$ 意味着标量方程：\n$$\n1 \\cdot w_1 + 2 \\cdot w_2 + 0.6 \\cdot w_3 + 1.2 \\cdot w_4 = 0\n$$\n我们需要找到三个满足此方程的线性无关的行向量。我们可以通过系统地将某些分量设置为零来构造它们。\n\n1.  选择 $w_{3,1} = 0, w_{4,1} = 0$。方程变为 $w_{1,1} + 2 w_{2,1} = 0$。一个简单的选择是 $w_{1,1} = 2, w_{2,1} = -1$。所以，第一行为 $w_1^T = \\begin{bmatrix} 2  -1  0  0 \\end{bmatrix}$。为了方便后续计算，我们使用它的相反数：$w_1^T = \\begin{bmatrix} -2  1  0  0 \\end{bmatrix}$。\n2.  选择 $w_{2,2} = 0, w_{4,2} = 0$。方程变为 $w_{1,2} + 0.6 w_{3,2} = 0$。一个简单的选择是 $w_{1,2} = 0.6, w_{3,2} = -1$。所以，第二行为 $w_2^T = \\begin{bmatrix} 0.6  0  -1  0 \\end{bmatrix}$。我们使用它的相反数：$w_2^T = \\begin{bmatrix} -0.6  0  1  0 \\end{bmatrix}$。\n3.  选择 $w_{2,3} = 0, w_{3,3} = 0$。方程变为 $w_{1,3} + 1.2 w_{4,3} = 0$。一个简单的选择是 $w_{1,3} = 1.2, w_{4,3} = -1$。所以，第三行为 $w_3^T = \\begin{bmatrix} 1.2  0  0  -1 \\end{bmatrix}$。我们使用它的相反数：$w_3^T = \\begin{bmatrix} -1.2  0  0  1 \\end{bmatrix}$。\n\n这三个向量是线性无关的。因此，一个有效的校验矩阵是：\n$$\nW = \\begin{bmatrix} -2  1  0  0 \\\\ -0.6  0  1  0 \\\\ -1.2  0  0  1 \\end{bmatrix}\n$$\n\n#### 任务2：计算残差 $r$\n\n残差定义为 $r = W Y$。首先，我们根据给定的测量值 $y_0$ 和 $y_1$ 构造堆叠输出向量 $Y$。\n$$\nY = \\begin{bmatrix} y_0 \\\\ y_1 \\end{bmatrix} = \\begin{bmatrix} 1.9 \\\\ 3.0 \\\\ 1.3 \\\\ 1.8 \\end{bmatrix}\n$$\n现在，我们计算乘积 $r = W Y$：\n$$\nr = \\begin{bmatrix} -2  1  0  0 \\\\ -0.6  0  1  0 \\\\ -1.2  0  0  1 \\end{bmatrix} \\begin{bmatrix} 1.9 \\\\ 3.0 \\\\ 1.3 \\\\ 1.8 \\end{bmatrix} = \\begin{bmatrix} (-2)(1.9) + (1)(3.0) \\\\ (-0.6)(1.9) + (1)(1.3) \\\\ (-1.2)(1.9) + (1)(1.8) \\end{bmatrix} = \\begin{bmatrix} -3.8 + 3.0 \\\\ -1.14 + 1.3 \\\\ -2.28 + 1.8 \\end{bmatrix} = \\begin{bmatrix} -0.8 \\\\ 0.16 \\\\ -0.48 \\end{bmatrix}\n$$\n\n#### 任务3：隔离故障\n\n首先，我们计算故障特征向量 $s_i = W F_L e_i$。矩阵 $F_L$ 是：\n$$\nF_{L} = \\begin{bmatrix} I_{2} \\\\ I_{2} \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  0 \\\\ 0  1 \\end{bmatrix}\n$$\n$\\mathbb{R}^2$ 中的规范基向量是 $e_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$ 和 $e_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n\n对于传感器 1 的故障 ($i=1$)：\n输出空间中的故障向量是 $F_L e_1$，即 $F_L$ 的第一列：\n$$\nF_L e_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix}\n$$\n特征 $s_1$ 是：\n$$\ns_1 = W (F_L e_1) = \\begin{bmatrix} -2  1  0  0 \\\\ -0.6  0  1  0 \\\\ -1.2  0  0  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} -2 \\\\ -0.6+1 \\\\ -1.2 \\end{bmatrix} = \\begin{bmatrix} -2 \\\\ 0.4 \\\\ -1.2 \\end{bmatrix}\n$$\n\n对于传感器 2 的故障 ($i=2$)：\n输出空间中的故障向量是 $F_L e_2$，即 $F_L$ 的第二列：\n$$\nF_L e_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n特征 $s_2$ 是：\n$$\ns_2 = W (F_L e_2) = \\begin{bmatrix} -2  1  0  0 \\\\ -0.6  0  1  0 \\\\ -1.2  0  0  1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\n\n接下来，我们通过计算每个可能故障的归一化相关性 $g_i$ 来应用决策规则。我们有 $r = \\begin{bmatrix} -0.8 \\\\ 0.16 \\\\ -0.48 \\end{bmatrix}$。\n\n计算 $g_1$：\n$$\n\\langle r, s_{1} \\rangle = (-0.8)(-2) + (0.16)(0.4) + (-0.48)(-1.2) = 1.6 + 0.064 + 0.576 = 2.24\n$$\n$$\n\\lVert r \\rVert^2 = (-0.8)^2 + (0.16)^2 + (-0.48)^2 = 0.64 + 0.0256 + 0.2304 = 0.896\n$$\n$$\n\\lVert s_1 \\rVert^2 = (-2)^2 + (0.4)^2 + (-1.2)^2 = 4 + 0.16 + 1.44 = 5.6\n$$\n$$\ng_1 = \\frac{| \\langle r, s_{1} \\rangle |}{\\lVert r \\rVert \\, \\lVert s_{1} \\rVert} = \\frac{|2.24|}{\\sqrt{0.896} \\sqrt{5.6}} = \\frac{2.24}{\\sqrt{0.896 \\times 5.6}} = \\frac{2.24}{\\sqrt{5.0176}}\n$$\n我们注意到 $2.24^2 = 5.0176$。因此，$\\sqrt{5.0176} = 2.24$。\n$$\ng_1 = \\frac{2.24}{2.24} = 1\n$$\n\n计算 $g_2$：\n$$\n\\langle r, s_{2} \\rangle = (-0.8)(1) + (0.16)(0) + (-0.48)(1) = -0.8 - 0.48 = -1.28\n$$\n$$\n\\lVert s_2 \\rVert^2 = 1^2 + 0^2 + 1^2 = 2\n$$\n$$\ng_2 = \\frac{| \\langle r, s_{2} \\rangle |}{\\lVert r \\rVert \\, \\lVert s_{2} \\rVert} = \\frac{|-1.28|}{\\sqrt{0.896} \\sqrt{2}} = \\frac{1.28}{\\sqrt{1.792}}\n$$\n由于 $\\sqrt{1.792} \\approx 1.3386$，所以 $g_2  1$。\n\n决策规则是选择使 $g_i$ 最大化的索引 $i$。\n我们得到 $g_1 = 1$ 和 $g_2  1$。最大值是 $g_1$。归一化相关性值为 1 表明残差向量 $r$ 与故障特征向量 $s_1$ 完全对齐（即成标量倍数关系）。这为故障发生在传感器 1 上提供了确凿的证据。\n关系为 $r = k \\cdot s_1$，其中 $k = \\frac{\\langle r, s_1 \\rangle}{\\lVert s_1 \\rVert^2} = \\frac{2.24}{5.6} = 0.4$。这个比例常数对应于偏差大小 $b=0.4$。\n\n隔离出的传感器索引是 $i=1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在掌握了代数方法的奇偶空间法后，我们转向随机框架下的卡尔曼滤波器，其新息序列天然地构成了可用于故障检测的残差。本练习  深入探讨了滤波器的核心，要求你推导其稳态增益。更重要的是，它揭示了一个关键的权衡：一个最优的状态估计器可能无意中“掩盖”故障的存在，而本练习将引导你定量地分析这种估计性能与故障检测灵敏度之间的权衡。",
            "id": "4221867",
            "problem": "考虑一个离散时间标量信息物理系统 (CPS) 及其数字孪生 (DT) 估计器。该对象依据以下线性时不变随机动态演化\n$$\nx_{k+1} = a\\,x_{k} + w_{k},\n$$\n其测量模型为\n$$\ny_{k} = x_{k} + v_{k} + f_{k}.\n$$\n假设过程噪声 $w_{k}$ 和测量噪声 $v_{k}$ 是相互独立的零均值高斯白噪声序列，其协方差分别为 $\\mathbb{E}[w_{k}^{2}] = Q  0$ 和 $\\mathbb{E}[v_{k}^{2}] = R  0$。标量参数 $a$ 满足 $|a|  1$。加性故障 $f_{k}$ 表示注入到测量通道中的一个未知偏置。数字孪生采用一个具有恒定增益 $K$ 的稳态卡尔曼滤波器 (KF)，其预测-校正递归形式如下：\n$$\n\\hat{x}_{k}^{-} = a\\,\\hat{x}_{k-1}, \\quad r_{k} = y_{k} - \\hat{x}_{k}^{-}, \\quad \\hat{x}_{k} = \\hat{x}_{k}^{-} + K\\,r_{k},\n$$\n其中 $r_{k}$ 是新息。定义先验估计误差为 $e_{k}^{-} = x_{k} - \\hat{x}_{k}^{-}$，其协方差为 $P_{k}^{-} = \\mathbb{E}[(e_{k}^{-})^{2}]$；定义后验估计误差为 $e_{k} = x_{k} - \\hat{x}_{k}$，其协方差为 $P_{k} = \\mathbb{E}[e_{k}^{2}]$。\n\n从上述基本定义和线性高斯估计的最小均方最优性原理出发，推导稳态卡尔曼增益 $K$ 关于 $a$、$Q$ 和 $R$ 的解析表达式。然后，使用新息表示法，通过表示稳态下的新息协方差 $S = \\mathbb{E}[(r_{k} - \\mathbb{E}[r_{k}])^{2}]$，分析 $K$ 如何影响故障敏感度，并讨论归一化故障效应 $F/\\sqrt{S}$（其中 $f_{k} \\equiv F$ 是一个恒定偏置）对 $K$、$Q$ 和 $R$ 的依赖关系。\n\n你的最终答案必须是稳态卡尔曼增益 $K$ 关于 $a$、$Q$ 和 $R$ 的解析表达式。无需进行数值计算。",
            "solution": "该问题陈述是关于稳态卡尔曼滤波和故障诊断的一个适定且有科学依据的练习，这是信息物理系统和数字孪生研究中的基础课题。所有提供的信息都是自洽、一致的，并遵循估计理论中的标准公式。因此，该问题是有效的。\n\n推导过程按要求分两部分进行：首先，推导稳态卡尔曼增益 $K$；其次，分析故障敏感度。\n\n### 第1部分：稳态卡尔曼增益 $K$ 的推导\n\n最优卡尔曼滤波器是基于系统和测量模型设计的，假设故障 $f_k$ 为零。滤波器的方程如下：\n预测器：$\\hat{x}_{k}^{-} = a\\,\\hat{x}_{k-1}$\n校正器：$\\hat{x}_{k} = \\hat{x}_{k}^{-} + K\\,r_{k}$，其中 $r_{k} = y_{k} - \\hat{x}_{k}^{-}$\n\n先验和后验估计误差动态推导如下。\n先验误差为 $e_{k}^{-} = x_{k} - \\hat{x}_{k}^{-}$。代入系统动态 $x_{k} = a\\,x_{k-1} + w_{k-1}$ 和预测方程，我们得到：\n$$e_{k}^{-} = (a\\,x_{k-1} + w_{k-1}) - (a\\,\\hat{x}_{k-1}) = a(x_{k-1} - \\hat{x}_{k-1}) + w_{k-1} = a\\,e_{k-1} + w_{k-1}$$\n其中 $e_{k-1} = x_{k-1} - \\hat{x}_{k-1}$ 是前一时间步的后验误差。\n\n后验误差为 $e_{k} = x_{k} - \\hat{x}_{k}$。对于滤波器设计（无故障情况，$f_k=0$），新息为 $r_k = (x_k + v_k) - \\hat{x}_k^{-} = e_k^{-} + v_k$。将其代入校正方程，得到：\n$$e_{k} = x_{k} - (\\hat{x}_{k}^{-} + K\\,r_{k}) = (x_{k} - \\hat{x}_{k}^{-}) - K(e_{k}^{-} + v_{k}) = e_{k}^{-} - K\\,e_{k}^{-} - K\\,v_{k} = (1-K)e_{k}^{-} - K\\,v_{k}$$\n\n接下来，我们传播误差协方差。先验误差协方差为 $P_k^{-} = \\mathbb{E}[(e_k^{-})^2]$，后验误差协方差为 $P_k = \\mathbb{E}[e_k^2]$。\n根据 $e_k^{-}$ 的动态，我们有：\n$$P_{k}^{-} = \\mathbb{E}[(a\\,e_{k-1} + w_{k-1})^2] = a^2\\mathbb{E}[e_{k-1}^2] + \\mathbb{E}[w_{k-1}^2] + 2a\\mathbb{E}[e_{k-1}w_{k-1}]$$\n误差 $e_{k-1}$ 取决于直到时间 $k-1$ 的噪声项，因此与噪声 $w_{k-1}$ 不相关。所以，$\\mathbb{E}[e_{k-1}w_{k-1}] = 0$。这就得到了协方差预测方程：\n$$P_{k}^{-} = a^2 P_{k-1} + Q$$\n\n根据 $e_k$ 的动态，并注意到 $e_k^-$ 与 $v_k$ 不相关：\n$$P_k = \\mathbb{E}[((1-K)e_k^{-} - K v_k)^2] = (1-K)^2 P_k^{-} + K^2 R$$\n选择最优卡尔曼增益 $K$ 以最小化后验误差方差 $P_k$。对 $K$ 求导并令其为零，得到著名的结果：\n$$K = \\frac{P_k^{-}}{P_k^{-} + R}$$\n将此最优增益代回 $P_k$ 的方程，得到协方差校正方程：\n$$P_k = (1-K)P_k^{-}$$\n\n在稳态下，协方差变为常数，即 $P_k^{-} = P_{k-1}^{-} = P^{-}$ 且 $P_k = P_{k-1} = P$。传播方程变为：\n1. $P^{-} = a^2 P + Q$\n2. $P = (1-K)P^{-}$\n3. $K = \\frac{P^{-}}{P^{-} + R}$\n\n我们可以为稳态增益 $K$ 推导出一个单一的方程。根据关系式 (3)，我们用 $K$ 表示 $P^{-}$：\n$$K(P^{-} + R) = P^{-} \\implies KP^{-} + KR = P^{-} \\implies KR = P^{-}(1-K) \\implies P^{-} = \\frac{KR}{1-K}$$\n根据关系式 (2)，我们用 $K$ 和 $P^{-}$ 表示 $P$：\n$$P = (1-K) \\left( \\frac{KR}{1-K} \\right) = KR$$\n现在，将 $P^{-}$ 和 $P$ 的这些表达式代入关系式 (1)：\n$$\\frac{KR}{1-K} = a^2(KR) + Q$$\n该方程只包含未知的稳态增益 $K$ 和已知的系统参数 $a$、$Q$ 和 $R$。我们将其整理成标准二次方程形式 $A K^2 + B K + C = 0$：\n$$KR = (a^2 KR + Q)(1-K)$$\n$$KR = a^2 KR - a^2 KR^2 + Q - QK$$\n$$a^2 R K^2 + (KR - a^2 KR + QK) - Q = 0$$\n$$a^2 R K^2 + (R(1-a^2) + Q)K - Q = 0$$\n\n这是一个关于 $K$ 的二次方程。系数为 $A_K = a^2 R$，$B_K = (1-a^2)R + Q$ 和 $C_K = -Q$。由于 $|a|1$，$Q>0$ 且 $R>0$，我们有 $A_K>0$，$B_K>0$ 和 $C_K  0$。解由二次公式给出：\n$$K = \\frac{-B_K \\pm \\sqrt{B_K^2 - 4A_K C_K}}{2A_K}$$\n$$K = \\frac{-((1-a^2)R + Q) \\pm \\sqrt{((1-a^2)R + Q)^2 - 4(a^2 R)(-Q)}}{2a^2 R}$$\n$$K = \\frac{-((1-a^2)R + Q) \\pm \\sqrt{((1-a^2)R + Q)^2 + 4a^2 QR}}{2a^2 R}$$\n卡尔曼增益必须具有物理意义。对于一个稳定的系统，当 $Q,R>0$ 时，稳态增益 $K$ 必须在 $(0, 1)$ 范围内。平方根下的项严格大于 $B_K^2$，因此 $\\sqrt{B_K^2 - 4A_K C_K} > B_K$。带有负号的解会得到一个负的 $K$ 值，这没有物理意义。因此，我们必须取正根。\n\n### 第2部分：故障敏感度分析\n\n现在我们分析在存在恒定加性故障 $f_k = F$ 的情况下滤波器的行为。新息为 $r_k = y_k - \\hat{x}_k^{-} = (x_k + v_k + F) - \\hat{x}_k^{-} = e_k^{-} + v_k + F$。\n故障在估计误差中引入了一个偏置。新息的期望值为：\n$$\\mathbb{E}[r_k] = \\mathbb{E}[e_k^{-}] + \\mathbb{E}[v_k] + F = \\mathbb{E}[e_k^{-}] + F$$\n偏置根据 $\\mathbb{E}[e_k] = (1-a(1-K))\\mathbb{E}[e_{k-1}] - KF$ 传播。在稳态下，$\\mathbb{E}[e_k] = \\mathbb{E}[e_{k-1}] = \\bar{e}$，这给出 $\\bar{e} = \\frac{-KF}{1-a+aK}$。\n先验误差的稳态均值为 $\\bar{e}^- = a\\bar{e} = \\frac{-aKF}{1-a+aK}$。\n因此，新息的稳态均值为：\n$$\\mathbb{E}[r_k] = \\frac{-aKF}{1-a+aK} + F = F\\left(\\frac{1-a+aK-aK}{1-a+aK}\\right) = \\frac{(1-a)F}{1-a+aK}$$\n新息协方差为 $S = \\mathbb{E}[(r_{k} - \\mathbb{E}[r_{k}])^{2}]$。\n$$r_{k} - \\mathbb{E}[r_{k}] = (e_k^{-} + v_k + F) - (\\mathbb{E}[e_k^{-}] + F) = (e_k^{-} - \\mathbb{E}[e_k^{-}]) + v_k$$\n协方差不受恒定偏置的影响，因此 $S = \\mathbb{E}[((e_k^{-} - \\mathbb{E}[e_k^{-}]) + v_k)^2] = P^{-} + R$。\n归一化故障效应给出为 $F/\\sqrt{S}$。使用 $S = P^{-} + R$ 和 $K = P^{-}/(P^{-}+R)$，我们可以用 $K$ 表示 $S$：\n$$S = \\frac{P^{-}}{K} \\quad \\text{且} \\quad P^{-} = \\frac{KR}{1-K} \\implies S = \\frac{R}{1-K}$$\n因此，归一化故障效应为：\n$$\\frac{F}{\\sqrt{S}} = \\frac{F}{\\sqrt{R/(1-K)}} = F\\sqrt{\\frac{1-K}{R}}$$\n这个表达式量化了故障的可检测性。值越大意味着敏感度越好。\n- 如果增益 $K$ 很高（接近 $1$），则 $\\sqrt{1-K}$ 项接近 $0$，故障变得不可检测。高增益是由低测量噪声 $R$ 或高过程噪声 $Q$ 引起的，这使得滤波器紧密跟踪测量值，从而有效地“学习”并掩盖了恒定偏置。\n- 如果增益 $K$ 很低（接近 $0$），则 $\\sqrt{1-K}$ 项接近 $1$，敏感度取决于 $1/\\sqrt{R}$。低增益是由高测量噪声 $R$ 或低过程噪声 $Q$ 引起的。滤波器更依赖其内部模型，测量中的持续差异（即故障）在新息序列中产生一个强的、可检测的信号。\n这揭示了最优状态估计（可能需要高增益）与故障检测敏感度（通过较低的增益得到增强）之间的基本权衡。\n\n所要求的最终答案是 $K$ 的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{-((1-a^{2})R + Q) + \\sqrt{((1-a^{2})R + Q)^{2} + 4a^{2}QR}}{2a^{2}R}}\n$$"
        }
    ]
}