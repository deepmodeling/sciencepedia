{
    "hands_on_practices": [
        {
            "introduction": "To design efficient and secure Cyber-Physical Systems, it is crucial to understand the fundamental computational costs of homomorphic operations. This first exercise focuses on the Brakerski–Fan–Vercauteren (BFV) scheme, a cornerstone for exact arithmetic on encrypted integers, to quantify the overhead associated with its core operations. By analyzing a simple arithmetic circuit, you will learn to identify the specific steps, like ciphertext multiplication and relinearization, that drive computational complexity in leveled homomorphic encryption .",
            "id": "4226129",
            "problem": "A Cyber-Physical System (CPS) digital twin must evaluate an encrypted state update over sensor streams using the Brakerski–Fan–Vercauteren (BFV) leveled homomorphic encryption scheme. The computation is expressed as an arithmetic circuit with $3$ multiplication gates and $10$ addition gates over ciphertext inputs, and its correctness will later be attested by a Zero-Knowledge Proof (ZKP) of computation without revealing plaintexts. Assume the following foundations of BFV homomorphic evaluation:\n\n- A BFV ciphertext is represented as a pair, and ciphertext-ciphertext addition produces a ciphertext whose representation length remains unchanged.\n- Ciphertext-ciphertext multiplication produces a ciphertext with an increased representation length that must be brought back down using relinearization with precomputed evaluation keys to continue evaluation in a leveled setting without bootstrapping.\n- No rescaling is used in BFV exact arithmetic.\n\nUnder these conditions, and assuming every multiplication gate in the circuit is a ciphertext-ciphertext multiplication and that relinearization is applied immediately after each such multiplication to maintain a constant ciphertext representation length throughout the evaluation, determine the total number of ciphertext-ciphertext multiplications and the total number of relinearizations required to evaluate the circuit. Provide your final answer as a row matrix in the order (total ciphertext-ciphertext multiplications, total relinearizations). No rounding is needed, and no units apply.",
            "solution": "The problem requires an analysis of the computational cost, specifically in terms of multiplication and relinearization operations, for evaluating an arithmetic circuit using the Brakerski–Fan–Vercauteren (BFV) homomorphic encryption scheme.\n\nFirst, a validation of the problem statement is in order.\n\n**Step 1: Extract Givens**\n- The computational model is an arithmetic circuit evaluated by a Cyber-Physical System (CPS) digital twin.\n- The encryption scheme is BFV leveled homomorphic encryption.\n- The circuit consists of $3$ multiplication gates and $10$ addition gates.\n- Inputs to the gates are ciphertexts.\n- The correctness of the computation is to be later verified by a Zero-Knowledge Proof (ZKP).\n- BFV ciphertext-ciphertext addition does not change the ciphertext representation length.\n- BFV ciphertext-ciphertext multiplication increases the ciphertext representation length.\n- Relinearization is a mandatory operation to reduce the ciphertext representation length after a multiplication.\n- Relinearization is applied immediately after each ciphertext-ciphertext multiplication.\n- Every multiplication gate is a ciphertext-ciphertext multiplication.\n- The evaluation is leveled and does not use bootstrapping.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The description of the BFV homomorphic encryption scheme's properties—specifically, the contrast between addition and multiplication—is accurate. Ciphertext addition in BFV is a component-wise operation on underlying polynomials, which preserves the ciphertext's form (a pair of polynomials). In contrast, ciphertext multiplication involves tensor products, increasing the ciphertext from a pair to a triplet (or from length $k+1$ to $2k+1$ in a general setting), which necessitates the relinearization procedure to return it to the standard pair format for subsequent operations. The problem's context of a digital twin in a CPS using secure computation is a valid and active area of research.\n\nThe problem is well-posed. It provides all necessary data and constraints to arrive at a deterministic answer. The question is precise and asks for two specific quantities. The assumptions are stated explicitly.\n\nThe problem is objective and free of any subjective or scientifically unsound claims. It is a formalizable problem within the field of applied cryptography.\n\n**Step 3: Verdict and Action**\nThe problem statement is deemed valid. A formal solution will now be derived.\n\nThe problem asks for two quantities: the total number of ciphertext-ciphertext multiplications and the total number of relinearizations.\n\nLet $N_{mult}$ be the total number of ciphertext-ciphertext multiplications and $N_{relin}$ be the total number of relinearizations.\n\nThe problem explicitly states that the arithmetic circuit comprises $3$ multiplication gates. It further specifies the assumption that \"every multiplication gate in the circuit is a ciphertext-ciphertext multiplication.\" This directly determines the value of $N_{mult}$.\n$$\nN_{mult} = 3\n$$\nThe number of addition gates, given as $10$, is extraneous information with respect to the question asked, as the problem states that ciphertext-ciphertext addition does not require any size-reducing maintenance operations like relinearization.\n\nNext, we determine the total number of relinearizations, $N_{relin}$. The problem provides a clear and unambiguous rule for the evaluation procedure: \"relinearization is applied immediately after each such multiplication to maintain a constant ciphertext representation length.\" This establishes a direct, one-to-one correspondence between a ciphertext-ciphertext multiplication operation and a relinearization operation. For every multiplication that occurs, a subsequent relinearization must be performed.\n\nGiven that there are $N_{mult} = 3$ ciphertext-ciphertext multiplications, it follows logically and directly from the stated procedure that there must be an equal number of relinearization operations.\n$$\nN_{relin} = N_{mult}\n$$\nSubstituting the value of $N_{mult}$:\n$$\nN_{relin} = 3\n$$\nTherefore, the evaluation of the specified arithmetic circuit requires $3$ ciphertext-ciphertext multiplications and $3$ relinearizations. The final answer should be presented as a row matrix containing these two values in the requested order.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from exact integer arithmetic to computations over real numbers requires a different approach, embodied by schemes like Cheon–Kim–Kim–Song (CKKS). This practice delves into the critical task of parameter selection for approximate homomorphic encryption, where one must balance the computational budget (modulus size), the depth of the algorithm, and the desired numerical precision. You will work through a realistic scenario of designing an encrypted controller, providing you with hands-on experience in sizing a CKKS system to meet the stringent performance and accuracy demands of a CPS application .",
            "id": "4226124",
            "problem": "A cyber-physical system (CPS) digital twin computes a nonlinear encrypted control law using the Cheon–Kim–Kim–Song (CKKS) approximate homomorphic encryption scheme. The control algorithm has a longest ciphertext–ciphertext multiplication chain depth of $D = 6$ per evaluation. The system designer specifies a desired output dynamic range bound $R_{\\text{out}} = 4$ (meaning the magnitude of the true plaintext output is bounded by $4$) and a target relative precision requirement $\\varepsilon = 1.5 \\times 10^{-11}$ at the final decrypted output.\n\nAssume the following well-tested CKKS properties and modeling assumptions:\n- CKKS encodes real values as fixed-point with a scale $\\Delta > 0$; the quantization resolution is on the order of $\\Delta^{-1}$.\n- Each ciphertext–ciphertext multiplication followed by rescaling to restore the scale consumes one prime in the modulus chain whose bit-size is approximately $\\log_{2}(\\Delta)$; the rescaling operation reduces the modulus by that prime’s bit-size.\n- The total absolute output error from fixed-point quantization and rescaling in this control evaluation can be upper bounded by $E \\leq \\kappa \\Delta^{-1}$ for a known algorithm-dependent constant $\\kappa$, derived from coefficient growth and operation counts (you may take $\\kappa = 100$ for this controller).\n- Multiplication by plaintext constants and additions do not consume levels and do not change the scale schedule for the purpose of this sizing calculation.\n\nDesign a uniform scale schedule that uses the same base scale $\\Delta$ at each level and determine the minimal modulus chain sizing required so that the final absolute output error bound $E$ is at most $\\varepsilon R_{\\text{out}}$. For sizing, include one initial prime to inject the base scale (so the chain must include $D+1$ primes, each of bit-size $\\log_{2}(\\Delta)$), and neglect any auxiliary primes for relinearization or key switching.\n\nCompute the minimal total modulus budget in bits, defined as $Q_{\\text{total}} = (D+1)\\log_{2}(\\Delta)$, that meets the dynamic range and precision requirements under these assumptions. Round your final numeric answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of approximate homomorphic encryption (specifically the CKKS scheme), is well-posed with a unique solution, and is expressed using objective and precise technical language. All necessary data and models are provided to solve for the requested quantity.\n\nThe objective is to compute the minimal total modulus budget, $Q_{\\text{total}}$, required for a homomorphic evaluation of a control law. The problem provides the formula for this budget:\n$$Q_{\\text{total}} = (D+1)\\log_{2}(\\Delta)$$\nwhere $D$ is the multiplicative depth and $\\Delta$ is the base scale factor. We are given $D=6$. The task reduces to finding the minimal required scale factor $\\Delta$ that satisfies the system's precision requirements.\n\nThe system requires a final relative precision of $\\varepsilon = 1.5 \\times 10^{-11}$. The output of the computation has a dynamic range bounded by $R_{\\text{out}} = 4$. The target relative precision can be converted to a target absolute error bound, $E_{\\text{target}}$, for the final output. The maximum allowable absolute error is the product of the relative precision and the maximum possible magnitude of the output:\n$$E_{\\text{target}} = \\varepsilon R_{\\text{out}}$$\n\nThe problem provides a model for the upper bound on the absolute error, $E$, introduced by the CKKS computation:\n$$E \\leq \\kappa \\Delta^{-1}$$\nwhere $\\kappa=100$ is a constant related to the specific algorithm.\n\nTo satisfy the precision requirement, the actual error bound from the computation must be no greater than the target absolute error bound. Therefore, we must enforce the condition:\n$$\\kappa \\Delta^{-1} \\leq E_{\\text{target}}$$\nSubstituting the expression for $E_{\\text{target}}$, we get:\n$$\\kappa \\Delta^{-1} \\leq \\varepsilon R_{\\text{out}}$$\nTo find the minimal total modulus budget, we must use the minimal scale factor $\\Delta$ that satisfies this condition. The minimal $\\Delta$ is found by solving the inequality for $\\Delta$:\n$$\\frac{\\kappa}{\\varepsilon R_{\\text{out}}} \\leq \\Delta$$\nThus, the minimal required scale factor, which we will denote $\\Delta_{\\min}$, is:\n$$\\Delta_{\\min} = \\frac{\\kappa}{\\varepsilon R_{\\text{out}}}$$\n\nNow, we can substitute the given numerical values: $D=6$, $\\kappa=100$, $\\varepsilon=1.5 \\times 10^{-11}$, and $R_{\\text{out}}=4$.\nFirst, we compute $\\Delta_{\\min}$:\n$$\\Delta_{\\min} = \\frac{100}{(1.5 \\times 10^{-11}) \\times 4} = \\frac{100}{6 \\times 10^{-11}} = \\frac{50}{3} \\times 10^{11}$$\n\nNext, we substitute this value of $\\Delta_{\\min}$ and the given value of $D$ into the formula for $Q_{\\text{total}}$:\n$$Q_{\\text{total}} = (6+1)\\log_{2}\\left(\\frac{50}{3} \\times 10^{11}\\right) = 7 \\log_{2}\\left(\\frac{50}{3} \\times 10^{11}\\right)$$\nTo compute the base-$2$ logarithm, we can use the change of base formula, $\\log_{2}(x) = \\frac{\\ln(x)}{\\ln(2)}$:\n$$Q_{\\text{total}} = 7 \\times \\frac{\\ln\\left(\\frac{50}{3} \\times 10^{11}\\right)}{\\ln(2)}$$\nCalculating the value of the argument of the logarithm:\n$$\\frac{50}{3} \\times 10^{11} \\approx 1.666... \\times 10^{12}$$\nNow, we compute the numerical value for $Q_{\\text{total}}$:\n$$Q_{\\text{total}} \\approx 7 \\times \\frac{\\ln(1.666... \\times 10^{12})}{\\ln(2)}$$\n$$Q_{\\text{total}} \\approx 7 \\times \\frac{28.1418468}{0.6931472}$$\n$$Q_{\\text{total}} \\approx 7 \\times 40.60018$$\n$$Q_{\\text{total}} \\approx 284.20126$$\n\nThe problem requires the final answer to be rounded to four significant figures. The first four significant figures of $284.20126$ are $2$, $8$, $4$, and $2$. The fifth significant figure is $0$, so we round down (i.e., we truncate).\n$$Q_{\\text{total}} \\approx 284.2$$\nThis represents the minimal total bit-size of the modulus chain required to meet the specified design constraints.",
            "answer": "$$\\boxed{284.2}$$"
        },
        {
            "introduction": "Choosing the right encryption scheme is a pivotal decision in secure system design. This final practice places you in the role of a system architect tasked with evaluating a nonlinear function, a common requirement in digital twins. You will conduct a rigorous trade-off analysis, comparing the error characteristics of the approximate CKKS scheme against a fixed-point implementation using the exact BFV scheme, thereby developing a quantitative framework for selecting the most suitable cryptographic tool based on the interplay between function approximation error and scheme-specific quantization noise .",
            "id": "4226158",
            "problem": "A cyber-physical system (CPS) digital twin must evaluate the nonlinear correction map $f(x) = \\exp(x)$ homomorphically for sensor residuals $x$ constrained to the interval $[-0.5, 0.5]$. To enable encrypted computation, $f$ is approximated by the third-degree Taylor polynomial about $x=0$, denoted $p_{3}(x)$, and evaluated using Horner’s method to minimize multiplicative depth.\n\nYou must assess the error trade-offs between two encryption schemes: the Cheon–Kim–Kim–Song (CKKS) approximate homomorphic encryption scheme and the Brakerski/Fan–Vercauteren (BFV) exact-integer homomorphic encryption scheme with fixed-point encoding.\n\nBased on the above, use only the following foundational facts and assumptions.\n\n1. Taylor approximation remainder for $f(x) = \\exp(x)$ on $[-0.5, 0.5]$: if $p_{3}(x)$ is the degree-$3$ Taylor polynomial at $x=0$, then the remainder satisfies the Lagrange bound\n$$\n|f(x) - p_{3}(x)| \\leq \\frac{M\\,|x|^{4}}{4!}, \\quad \\text{where } M = \\sup_{\\xi \\in [-0.5,0.5]} |\\exp(\\xi)| = \\exp(0.5).\n$$\n\n2. Lipschitz propagation via the mean value theorem: for any differentiable polynomial $q$, a perturbation $\\delta x$ in the input produces an output perturbation bounded by\n$$\n|q(x+\\delta x) - q(x)| \\leq \\left(\\sup_{y \\in [-0.5,0.5]} |q'(y)|\\right)\\,|\\delta x|.\n$$\nFor $p_{3}(x)$, assume the bound is taken over $[-0.5,0.5]$.\n\n3. CKKS rounding model: CKKS encodes real numbers at scale $\\Delta$, and each encoding or rescaling operation introduces a rounding error of at most $0.5$ at the current scale, corresponding to at most $0.5/\\Delta$ in the decoded real domain. When evaluating $p_{3}$ with Horner’s method, there are $3$ ciphertext multiplications and $1$ initial encoding, hence $4$ such rounding events. Each rounding disturbance can be conservatively propagated to the output using the same Lipschitz bound as in item $2$.\n\n4. BFV fixed-point model: BFV represents reals by fixed-point scaling with scale $S_{B}$, so the input quantization yields $|\\delta x| \\leq 0.5/S_{B}$. Assume coefficients of $p_{3}$ are represented exactly by an appropriate global scaling and that ciphertext noise is negligible relative to fixed-point quantization in this setting, so only input quantization contributes to the BFV output error, propagated via the Lipschitz bound in item $2$.\n\nParameters for this CPS workload are as follows:\n- Domain bound $x \\in [-0.5, 0.5]$.\n- CKKS scale $\\Delta = 2^{30}$.\n- BFV input scale $S_{B} = 2^{20}$.\n\nUsing the above information, first bound the polynomial approximation error for $p_{3}(x)$ on $[-0.5, 0.5]$. Then, bound the total quantization-induced output error for CKKS and for BFV using items $2$–$4$. Finally, compute the dimensionless ratio\n$$\nR \\equiv \\frac{\\text{CKKS quantization error bound}}{\\text{BFV quantization error bound}}.\n$$\nRound your answer to four significant figures. Express the final ratio $R$ as a pure number with no units.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on established principles of numerical analysis and applied cryptography concerning error propagation in homomorphic encryption schemes. All necessary data, models, and parameters are provided, and there are no internal contradictions or ambiguities. The problem is therefore valid, and a solution can be derived.\n\nThe task is to compute the ratio of quantization error bounds for the CKKS and BFV homomorphic encryption schemes when used to evaluate a polynomial approximation of $f(x) = \\exp(x)$. The analysis proceeds in several steps: first, determining the properties of the polynomial approximation; second, calculating the error bounds for each scheme based on their respective error models; and finally, computing the ratio.\n\nFirst, we identify the degree-$3$ Taylor polynomial of $f(x) = \\exp(x)$ expanded around $x=0$. The derivatives of $f(x)$ are $f^{(k)}(x) = \\exp(x)$ for all $k \\geq 0$. At $x=0$, we have $f^{(k)}(0) = \\exp(0) = 1$ for all $k$. The Taylor polynomial $p_3(x)$ is thus:\n$$\np_3(x) = \\sum_{k=0}^{3} \\frac{f^{(k)}(0)}{k!} x^k = \\frac{1}{0!}x^0 + \\frac{1}{1!}x^1 + \\frac{1}{2!}x^2 + \\frac{1}{3!}x^3\n$$\n$$\np_3(x) = 1 + x + \\frac{1}{2}x^2 + \\frac{1}{6}x^3\n$$\n\nThe polynomial approximation error for $x \\in [-0.5, 0.5]$ is bounded by the given Lagrange remainder formula:\n$$\n|f(x) - p_3(x)| \\leq \\frac{M |x|^4}{4!}\n$$\nwhere $M = \\sup_{\\xi \\in [-0.5, 0.5]} |\\exp(\\xi)| = \\exp(0.5)$. The maximum error occurs at the boundary of the interval, where $|x| = 0.5$.\n$$\nE_{approx, max} = \\frac{\\exp(0.5) (0.5)^4}{24} = \\frac{\\exp(0.5) \\cdot (1/16)}{24} = \\frac{\\exp(0.5)}{384}\n$$\nWhile this bound is calculated as requested, it does not factor into the final ratio of quantization errors.\n\nNext, we must determine the Lipschitz constant for the error propagation model, which is common to both schemes. The constant is defined as $L = \\sup_{y \\in [-0.5, 0.5]} |p_3'(y)|$. The derivative of $p_3(x)$ is:\n$$\np_3'(y) = \\frac{d}{dy}\\left(1 + y + \\frac{1}{2}y^2 + \\frac{1}{6}y^3\\right) = 1 + y + \\frac{1}{2}y^2\n$$\nThe second derivative is $p_3''(y) = 1 + y$, which is positive for all $y \\in [-0.5, 0.5]$. This indicates that $p_3'(y)$ is a convex function and strictly increasing on the interval. Therefore, its supremum on the interval occurs at the right endpoint, $y=0.5$.\n$$\nL = p_3'(0.5) = 1 + (0.5) + \\frac{1}{2}(0.5)^2 = 1.5 + \\frac{1}{2}(0.25) = 1.5 + 0.125 = 1.625\n$$\nFor precision, we express $L$ as an exact fraction:\n$$\nL = \\frac{13}{8}\n$$\n\nNow we compute the total quantization-induced output error bound for the CKKS scheme, denoted $E_{\\text{CKKS}}$. According to the model, there are $N_{\\text{CKKS}} = 4$ rounding events (one for encoding, three for multiplications in Horner's method). Each event introduces a rounding error of at most $0.5$ at scale $\\Delta$, which corresponds to a real-domain error of at most $\\delta_{op} = \\frac{0.5}{\\Delta}$. The total output error is the sum of the propagated errors from each event, which provides a conservative upper bound.\n$$\nE_{\\text{CKKS}} \\leq N_{\\text{CKKS}} \\cdot L \\cdot \\delta_{op} = 4 \\cdot \\frac{13}{8} \\cdot \\frac{0.5}{\\Delta}\n$$\nSubstituting $\\Delta = 2^{30}$ and $0.5 = 1/2$:\n$$\nE_{\\text{CKKS}} \\leq 4 \\cdot \\frac{13}{8} \\cdot \\frac{1}{2\\Delta} = \\frac{52}{16\\Delta} = \\frac{13}{4\\Delta} = \\frac{13}{4 \\cdot 2^{30}} = \\frac{13}{2^2 \\cdot 2^{30}} = \\frac{13}{2^{32}}\n$$\n\nNext, we compute the total quantization-induced output error bound for the BFV scheme, denoted $E_{\\text{BFV}}$. The model states that this error is dominated by the initial input quantization, where the error $|\\delta x|$ is bounded by $\\frac{0.5}{S_B}$. This single input error is propagated to the output.\n$$\nE_{\\text{BFV}} \\leq L \\cdot |\\delta x| \\leq \\frac{13}{8} \\cdot \\frac{0.5}{S_B}\n$$\nSubstituting $S_B = 2^{20}$ and $0.5 = 1/2$:\n$$\nE_{\\text{BFV}} \\leq \\frac{13}{8} \\cdot \\frac{1}{2S_B} = \\frac{13}{16 S_B} = \\frac{13}{16 \\cdot 2^{20}} = \\frac{13}{2^4 \\cdot 2^{20}} = \\frac{13}{2^{24}}\n$$\n\nFinally, we compute the dimensionless ratio $R$:\n$$\nR = \\frac{\\text{CKKS quantization error bound}}{\\text{BFV quantization error bound}} = \\frac{E_{\\text{CKKS}}}{E_{\\text{BFV}}}\n$$\nUsing the derived bounds:\n$$\nR = \\frac{13/2^{32}}{13/2^{24}} = \\frac{13}{2^{32}} \\cdot \\frac{2^{24}}{13} = \\frac{2^{24}}{2^{32}} = 2^{24-32} = 2^{-8}\n$$\nThe exact value of the ratio is:\n$$\nR = \\frac{1}{2^8} = \\frac{1}{256} = 0.00390625\n$$\nThe problem requires the answer to be rounded to four significant figures. The first significant figure is $3$. Counting four figures gives $0.003906$. The next digit is $2$, so we round down.\n$$\nR \\approx 0.003906\n$$",
            "answer": "$$\\boxed{0.003906}$$"
        }
    ]
}