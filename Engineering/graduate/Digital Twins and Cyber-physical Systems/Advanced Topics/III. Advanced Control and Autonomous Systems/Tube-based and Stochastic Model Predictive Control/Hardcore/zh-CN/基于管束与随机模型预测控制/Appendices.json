{
    "hands_on_practices": [
        {
            "introduction": "在设计鲁棒控制器时，首要步骤是理解不确定性如何随时间传播。本练习  旨在通过计算一个简单线性系统的正向可达集，来实践这一核心概念。该可达集构成了管MPC中“管”的基础，它直观地展示了由于持续的扰动，所有可能系统状态的集合是如何演变的。",
            "id": "4252575",
            "problem": "一个信息物理建筑能源管理系统内的双区热力子系统的数字孪生，根据一个受加性不确定性影响的线性时不变离散时间模型演化。真实系统状态 $x_{k} \\in \\mathbb{R}^{2}$ 的演化遵循 $x_{k+1} = A x_{k} + B u_{k} + w_{k}$，而在基于管的模型预测控制（MPC）设计中的标称模型，其演化将设定 $w_{k} = 0$ 并规划 $u_{k}$ 以跟踪设定点。在此场景中，考虑无驱动的开环设置，即对所有 $k$ 都有 $u_{k} = 0$，因此闭环动力学简化为 $x_{k+1} = A x_{k} + w_{k}$，其中加性扰动 $w_{k}$ 代表模型与系统之间的失配，并满足对所有 $k \\geq 0$ 都有 $w_{k} \\in \\mathcal{W}$。集合 $\\mathcal{W}$ 是一个紧凑、凸且中心对称的不确定性集合。在线性动力学和有界加性不确定性下，集合能达性的基本定义如下：从初始状态 $x_{0}$ 出发的 $k$步能达集，是在给定动力学和初始条件下，由所有容许的扰动序列 $\\{w_{0},\\dots,w_{k-1}\\}$（其中每个 $w_{i} \\in \\mathcal{W}$）可能产生的所有状态 $x_{k}$ 的集合。\n\n仅使用Minkowski和与线性集像的核心定义，以及加性有界扰动的能达性递归定义，推導从 $x_{0}$ 出发的 $N$步能達集的闭式表示，然后对以下数据进行显式计算：\n- $A = \\mathrm{diag}(0.8, 0.6)$，\n- 对所有 $k \\geq 0$，$u_{k} = 0$，\n- 初始条件 $x_{0} = \\begin{pmatrix} 2.5 \\\\ -1.25 \\end{pmatrix}$，\n- 扰动集 $\\mathcal{W} = \\{ w \\in \\mathbb{R}^{2} : \\|w\\|_{\\infty} \\leq 0.05 \\}$，\n- 时域 $N = 4$。\n\n将您的最终能达集表示为两个闭区间 $[a_{1}, b_{1}] \\times [a_{2}, b_{2}]$ 的笛卡尔积，并使用精确的小数值。无需四舍五入，且不涉及任何物理单位。最终答案必须是代表该集合的单一解析表达式。",
            "solution": "该问题被评估为有效。这是一个在控制理论和能达性分析领域内的良定问题，提供了所有必要的信息和定义，并且没有科学或逻辑上的缺陷。\n\n第一步是为给定的离散时间线性系统推导 $N$步能達集（记为 $\\mathcal{R}_{N}(x_{0})$）的一般闭式表示。系统动力学由以下公式给出：\n$$x_{k+1} = A x_{k} + w_{k}$$\n其中状态为 $x_{k} \\in \\mathbb{R}^{2}$，控制输入为 $u_{k}=0$，扰动 $w_{k}$ 被约束在一个紧凑、凸且中心对称的集合 $\\mathcal{W}$ 中，即对所有 $k \\geq 0$ 都有 $w_{k} \\in \\mathcal{W}$。\n\n在第 $k+1$ 步的能达集，记为 $\\mathcal{R}_{k+1}(x_{0})$，是在第 $k$ 步的状态 $x_{k}$ 属于 $k$步能达集 $\\mathcal{R}_{k}(x_{0})$ 的条件下，所有可能的状态 $x_{k+1}$ 的集合。这可以用集合论运算来表示。具体来说，我们取集合 $\\mathcal{R}_{k}(x_{0})$ 在变换 $A$ 下的线性像，并将其与扰动集 $\\mathcal{W}$ 进行Minkowski和运算。两个集合 $S_{1}$ 和 $S_{2}$ 的Minkowski和定义为 $S_{1} \\oplus S_{2} = \\{s_{1} + s_{2} \\mid s_{1} \\in S_{1}, s_{2} \\in S_{2}\\}$。\n\n能达集的递归定义是：\n$$\\mathcal{R}_{k+1}(x_{0}) = A \\mathcal{R}_{k}(x_{0}) \\oplus \\mathcal{W}$$\n递归从初始条件开始，初始条件是一个单点集：\n$$\\mathcal{R}_{0}(x_{0}) = \\{x_{0}\\}$$\n我们可以展开这个递归来找到 $\\mathcal{R}_{N}(x_{0})$ 的一般形式。\n\n对于 $k=1$：\n$$\\mathcal{R}_{1}(x_{0}) = A \\mathcal{R}_{0}(x_{0}) \\oplus \\mathcal{W} = A \\{x_{0}\\} \\oplus \\mathcal{W} = \\{A x_{0}\\} \\oplus \\mathcal{W}$$\n这表示对于所有 $w_0 \\in \\mathcal{W}$，所有可能的状态 $x_1 = A x_0 + w_0$。\n\n对于 $k=2$：\n$$\\mathcal{R}_{2}(x_{0}) = A \\mathcal{R}_{1}(x_{0}) \\oplus \\mathcal{W} = A (\\{A x_{0}\\} \\oplus \\mathcal{W}) \\oplus \\mathcal{W}$$\n使用线性映射对Minkowski和的分配律，$A(S_{1} \\oplus S_{2}) = A S_{1} \\oplus A S_{2}$，我们得到：\n$$\\mathcal{R}_{2}(x_{0}) = A\\{A x_{0}\\} \\oplus A\\mathcal{W} \\oplus \\mathcal{W} = \\{A^{2} x_{0}\\} \\oplus A\\mathcal{W} \\oplus \\mathcal{W}$$\n这表示对于所有 $w_0, w_1 \\in \\mathcal{W}$，所有可能的状态 $x_2 = A^2 x_0 + A w_0 + w_1$。\n\n通过归纳法，对于任意时域 $N$，状态 $x_{N}$ 通过迭代动力学给出：\n$$x_{N} = A x_{N-1} + w_{N-1} = A(A x_{N-2} + w_{N-2}) + w_{N-1} = \\dots = A^{N} x_{0} + \\sum_{i=0}^{N-1} A^{i} w_{N-1-i}$$\n更改求和索引 $j=N-1-i$，我们有：\n$$x_{N} = A^{N} x_{0} + \\sum_{j=0}^{N-1} A^{N-1-j} w_{j}$$\n这个单一轨迹 $x_{N}$ 的表达式对应于 $N$步能达集的以下集合论表示：\n$$\\mathcal{R}_{N}(x_{0}) = \\{A^{N} x_{0}\\} \\oplus \\bigoplus_{i=0}^{N-1} A^{i} \\mathcal{W}$$\n这就是所求的闭式表示。它表明，在第 $N$ 步的能达集是累积扰动集 $\\bigoplus_{i=0}^{N-1} A^{i} \\mathcal{W}$ 被标称状态轨迹终点 $A^{N} x_{0}$ 平移后得到的集合。\n\n现在我们将此公式应用于所提供的具体数据：\n- $A = \\mathrm{diag}(0.8, 0.6) = \\begin{pmatrix} 0.8  0 \\\\ 0  0.6 \\end{pmatrix}$\n- $x_{0} = \\begin{pmatrix} 2.5 \\\\ -1.25 \\end{pmatrix}$\n- $\\mathcal{W} = \\{ w \\in \\mathbb{R}^{2} : \\|w\\|_{\\infty} \\leq 0.05 \\}$。这是一个盒子（区间的笛卡尔积）：$\\mathcal{W} = [-0.05, 0.05] \\times [-0.05, 0.05]$。\n- $N = 4$\n\n目标集合是 $\\mathcal{R}_{4}(x_{0}) = \\{A^{4} x_{0}\\} \\oplus \\bigoplus_{i=0}^{3} A^{i} \\mathcal{W}$。\n\n首先，我们计算在 $k=4$ 时的标称状态，即 $A^{4} x_{0}$。\n由于 $A$ 是对角矩阵，所以 $A^{k} = \\begin{pmatrix} (0.8)^{k}  0 \\\\ 0  (0.6)^{k} \\end{pmatrix}$。\n$$A^{4} = \\begin{pmatrix} (0.8)^{4}  0 \\\\ 0  (0.6)^{4} \\end{pmatrix} = \\begin{pmatrix} 0.4096  0 \\\\ 0  0.1296 \\end{pmatrix}$$\n标称状态是：\n$$x_{4}^{\\text{nom}} = A^{4} x_{0} = \\begin{pmatrix} 0.4096  0 \\\\ 0  0.1296 \\end{pmatrix} \\begin{pmatrix} 2.5 \\\\ -1.25 \\end{pmatrix} = \\begin{pmatrix} 0.4096 \\times 2.5 \\\\ 0.1296 \\times (-1.25) \\end{pmatrix} = \\begin{pmatrix} 1.024 \\\\ -0.162 \\end{pmatrix}$$\n\n接下来，我们计算累积扰动集 $\\mathcal{S} = \\bigoplus_{i=0}^{3} A^{i} \\mathcal{W}$。\n集合 $\\mathcal{W}$ 是一个轴对齐的盒子。通过对角矩阵 $A^i$ 的线性变换会沿坐标轴缩放此盒子。轴对齐盒子的Minkowski和结果是另一个轴对齐的盒子。\n设 $\\mathcal{W} = [-d, d] \\times [-d, d]$，其中 $d=0.05$。\n集合 $A^{i}\\mathcal{W}$ 由下式给出：\n$$A^{i}\\mathcal{W} = [-(0.8)^{i}d, (0.8)^{i}d] \\times [-(0.6)^{i}d, (0.6)^{i}d]$$\nMinkowski和 $\\mathcal{S} = \\bigoplus_{i=0}^{3} A^{i}\\mathcal{W}$ 是一个盒子 $[-D_{1}, D_{1}] \\times [-D_{2}, D_{2}]$，其中半宽 $D_{1}$ 和 $D_{2}$ 是各分量集半宽之和。\n$$D_{1} = \\sum_{i=0}^{3} (0.8)^{i}d = d \\sum_{i=0}^{3} (0.8)^{i}$$\n$$D_{2} = \\sum_{i=0}^{3} (0.6)^{i}d = d \\sum_{i=0}^{3} (0.6)^{i}$$\n我们计算这个有限几何级数：\n$$\\sum_{i=0}^{3} (0.8)^{i} = \\frac{1 - (0.8)^{4}}{1 - 0.8} = \\frac{1 - 0.4096}{0.2} = \\frac{0.5904}{0.2} = 2.952$$\n$$\\sum_{i=0}^{3} (0.6)^{i} = \\frac{1 - (0.6)^{4}}{1 - 0.6} = \\frac{1 - 0.1296}{0.4} = \\frac{0.8704}{0.4} = 2.176$$\n现在我们求半宽：\n$$D_{1} = 0.05 \\times 2.952 = 0.1476$$\n$$D_{2} = 0.05 \\times 2.176 = 0.1088$$\n所以，累积扰动集为 $\\mathcal{S} = [-0.1476, 0.1476] \\times [-0.1088, 0.1088]$。\n\n最后，$4$步能達集 $\\mathcal{R}_{4}(x_{0})$ 是集合 $\\mathcal{S}$ 被向量 $x_{4}^{\\text{nom}}$ 平移后的结果：\n$$\\mathcal{R}_{4}(x_{0}) = \\{x_{4}^{\\text{nom}}\\} \\oplus \\mathcal{S} = \\left[ 1.024 - D_{1}, 1.024 + D_{1} \\right] \\times \\left[ -0.162 - D_{2}, -0.162 + D_{2} \\right]$$\n代入 $D_1$ 和 $D_2$ 的值：\n$$\\mathcal{R}_{4}(x_{0}) = [1.024 - 0.1476, 1.024 + 0.1476] \\times [-0.162 - 0.1088, -0.162 + 0.1088]$$\n$$\\mathcal{R}_{4}(x_{0}) = [0.8764, 1.1716] \\times [-0.2708, -0.0532]$$\n这是能达集的最终表达式，表示为两个具有精确小数值的闭区间的笛卡尔积。",
            "answer": "$$\\boxed{[0.8764, 1.1716] \\times [-0.2708, -0.0532]}$$"
        },
        {
            "introduction": "在量化了不确定性的影响后，我们必须确保系统在所有可能的扰动下都能保持在安全运行范围内。本练习  引入了约束收紧的关键技术。通过为名义系统设置更严格的约束，我们为状态误差创建了一个缓冲区域，从而保证了对原始状态约束的鲁棒满足。",
            "id": "4252593",
            "problem": "考虑一个由模型预测控制（MPC）控制的双状态信息物理系统（CPS）的数字孪生。在一种基于管道的设计中，实际状态分解为 $x_{k} = z_{k} + e_{k}$，其中 $z_{k}$ 是标称状态，$e_{k}$ 是通过辅助反馈维持在鲁棒不变集内的误差状态。容许的实际状态集为 $\\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid \\| x \\|_{\\infty} \\leq 1 \\}$，容许的误差集为 $\\mathcal{E} = \\{ e \\in \\mathbb{R}^{2} \\mid \\| e \\|_{\\infty} \\leq 0.2 \\}$。为确保在所有容许误差下对 $\\mathcal{X}$ 的鲁棒满足，所需的收紧的标称状态约束集定义为庞特里亚金差集 $\\mathcal{Z} = \\mathcal{X} \\ominus \\mathcal{E}$，其中 $\\ominus$ 表示集合间的庞特里亚金差集。从 $\\mathbb{R}^{2}$ 上的 $\\ell_{\\infty}$ 范数、集合的闵可夫斯基和以及庞特里亚金差集的核心定义出发，显式地推导出 $\\mathcal{Z}$。然后，验证候选标称状态 $z^{\\star} = \\begin{pmatrix} 0.75 \\\\ -0.65 \\end{pmatrix}$ 在收紧的约束下是否可行。作为您的最终答案，仅报告标量界 $r_{\\text{tight}}$，使得 $\\mathcal{Z} = \\{ z \\in \\mathbb{R}^{2} \\mid \\| z \\|_{\\infty} \\leq r_{\\text{tight}} \\}$。请提供精确值，不要进行四舍五入。",
            "solution": "该问题要求为一个基于管道的模型预测控制（MPC）方案推导收紧的标称状态约束集 $\\mathcal{Z}$，并验证一个候选标称状态。推导过程必须从第一性原理出发。\n\n首先，我们对给定的集合进行形式化描述。容许的实际状态集 $\\mathcal{X}$ 定义为：\n$$ \\mathcal{X} = \\{ x \\in \\mathbb{R}^{2} \\mid \\| x \\|_{\\infty} \\leq 1 \\} $$\n对于一个向量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} \\in \\mathbb{R}^{2}$，其 $\\ell_{\\infty}$-范数由 $\\|v\\|_{\\infty} = \\max(|v_1|, |v_2|)$ 给出。因此，$\\mathcal{X}$ 是 $\\mathbb{R}^{2}$ 中一个以原点为中心、顶点位于 $(\\pm 1, \\pm 1)$ 的闭合正方形。\n\n容许的误差集 $\\mathcal{E}$ 定义为：\n$$ \\mathcal{E} = \\{ e \\in \\mathbb{R}^{2} \\mid \\| e \\|_{\\infty} \\leq 0.2 \\} $$\n类似地，$\\mathcal{E}$ 是一个以原点为中心、顶点位于 $(\\pm 0.2, \\pm 0.2)$ 的闭合正方形。\n\n收紧的标称状态约束集 $\\mathcal{Z}$ 定义为 $\\mathcal{X}$ 和 $\\mathcal{E}$ 的庞特里亚金差集（或闵可夫斯基差集）：\n$$ \\mathcal{Z} = \\mathcal{X} \\ominus \\mathcal{E} $$\n庞特里亚金差集 $A \\ominus B$ 的定义是所有向量 $c$ 的集合，使得当 $c$ 被任何向量 $b \\in B$ 平移时，其结果仍保持在 $A$ 内部。形式上：\n$$ A \\ominus B = \\{ c \\mid c + b \\in A \\text{ for all } b \\in B \\} $$\n将此定义应用于我们的问题，一个标称状态 $z$ 是 $\\mathcal{Z}$ 的一个元素，当且仅当对于所有可能的误差 $e \\in \\mathcal{E}$，都有 $z+e \\in \\mathcal{X}$。\n$$ z \\in \\mathcal{Z} \\iff z + e \\in \\mathcal{X} \\quad \\forall e \\in \\mathcal{E} $$\n这个条件可以用 $\\mathcal{X}$ 的定义来表示：\n$$ \\| z + e \\|_{\\infty} \\leq 1 \\quad \\forall e \\in \\mathcal{E} $$\n这个不等式必须对所有 $e \\in \\mathcal{E}$ 成立，这意味着它必须对使范数 $\\| z + e \\|_{\\infty}$ 最大化的误差 $e$ 成立。这等价于陈述 $\\| z + e \\|_{\\infty}$ 在所有 $e \\in \\mathcal{E}$ 上的上确界必须小于或等于 $1$。\n$$ \\sup_{e \\in \\mathcal{E}} \\| z + e \\|_{\\infty} \\leq 1 $$\n我们来分析表达式 $\\sup_{e \\in \\mathcal{E}} \\| z + e \\|_{\\infty}$。设 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$ 且 $e = \\begin{pmatrix} e_1 \\\\ e_2 \\end{pmatrix}$。\n$$ \\| z + e \\|_{\\infty} = \\max(|z_1 + e_1|, |z_2 + e_2|) $$\n最大值的上确界是上确界的最大值：\n$$ \\sup_{e \\in \\mathcal{E}} \\| z + e \\|_{\\infty} = \\sup_{\\|e\\|_{\\infty} \\leq 0.2} \\max(|z_1 + e_1|, |z_2 + e_2|) = \\max \\left( \\sup_{|e_1| \\leq 0.2} |z_1 + e_1|, \\sup_{|e_2| \\leq 0.2} |z_2 + e_2| \\right) $$\n当 $e_1$ 与 $z_1$ 同号且取最大可能幅值（即 $|e_1|=0.2$）时，项 $|z_1 + e_1|$ 在区间 $e_1 \\in [-0.2, 0.2]$ 上被最大化。因此，根据三角不等式：\n$$ \\sup_{|e_1| \\leq 0.2} |z_1 + e_1| = |z_1| + 0.2 $$\n类似地，对于第二个分量：\n$$ \\sup_{|e_2| \\leq 0.2} |z_2 + e_2| = |z_2| + 0.2 $$\n将这些代回，我们得到：\n$$ \\sup_{e \\in \\mathcal{E}} \\| z + e \\|_{\\infty} = \\max(|z_1| + 0.2, |z_2| + 0.2) = \\max(|z_1|, |z_2|) + 0.2 = \\|z\\|_{\\infty} + 0.2 $$\n$z$ 属于 $\\mathcal{Z}$ 的条件变为：\n$$ \\|z\\|_{\\infty} + 0.2 \\leq 1 $$\n$$ \\|z\\|_{\\infty} \\leq 1 - 0.2 $$\n$$ \\|z\\|_{\\infty} \\leq 0.8 $$\n因此，收紧的标称状态约束集 $\\mathcal{Z}$ 显式地由以下公式给出：\n$$ \\mathcal{Z} = \\{ z \\in \\mathbb{R}^{2} \\mid \\| z \\|_{\\infty} \\leq 0.8 \\} $$\n将其与所要求的形式 $\\mathcal{Z} = \\{ z \\in \\mathbb{R}^{2} \\mid \\| z \\|_{\\infty} \\leq r_{\\text{tight}} \\}$ 进行比较，我们可以确定标量界 $r_{\\text{tight}}$。\n$$ r_{\\text{tight}} = 0.8 $$\n\n问题还要求验证候选标称状态 $z^{\\star} = \\begin{pmatrix} 0.75 \\\\ -0.65 \\end{pmatrix}$ 的可行性。如果一个状态属于收紧的约束集 $\\mathcal{Z}$，则该状态是可行的。我们检查是否满足 $\\|z^{\\star}\\|_{\\infty} \\leq r_{\\text{tight}}$。\n$$ \\|z^{\\star}\\|_{\\infty} = \\left\\| \\begin{pmatrix} 0.75 \\\\ -0.65 \\end{pmatrix} \\right\\|_{\\infty} = \\max(|0.75|, |-0.65|) = \\max(0.75, 0.65) = 0.75 $$\n由于 $0.75 \\leq 0.8$，该条件得到满足，因此候选状态 $z^{\\star}$ 确实是可行的。\n\n最终要求的答案仅是 $r_{\\text{tight}}$ 的值。",
            "answer": "$$\n\\boxed{0.8}\n$$"
        },
        {
            "introduction": "从最坏情况下的鲁棒方法转向可以降低保守性的概率性（随机）方法，是MPC领域的一个重要进展。本练习  探讨了SMPC的一种实用方法——基于场景的优化。在这里，一个概率性的机会约束被一组基于扰动采样的确定性约束所替代，核心任务是确定需要多少样本才能为系统安全性提供统计保证。",
            "id": "4252524",
            "problem": "一个信息物理系统 (CPS) 由一个离散时间线性时不变设备表示，该设备带有加性过程扰动，并通过数字孪生建模为数据驱动的随机过程。设备动态为\n$$\nx_{k+1} = A x_k + B u_k + w_k,\\quad y_k = C x_k,\n$$\n其中 $x_k \\in \\mathbb{R}^{n}$ 是状态，$u_k \\in \\mathbb{R}^{m}$ 是输入，$y_k \\in \\mathbb{R}^{p}$ 是输出，$w_k \\in \\mathbb{R}^{n}$ 是一个外源性扰动。考虑单步随机模型预测控制 (SMPC)，其中模型预测控制 (MPC) 使用一个基于管的策略，其预稳定反馈增益 $K \\in \\mathbb{R}^{m \\times n}$ 为 $u_k = v_k + K e_k$，标称状态 $z_k$ 根据\n$$\nz_{k+1} = A z_k + B v_k,\n$$\n演化，而误差 $e_k := x_k - z_k$ 根据\n$$\ne_{k+1} = (A + B K) e_k + w_k,\n$$\n演化，其中 $e_k$ 在当前时刻 $k$ 初始化为 $e_k = 0$。\n\n对调节输出的单步机会约束要求下一步输出以高概率满足线性安全限制：$\\mathbb{P}\\big(H y_{k+1} \\le h\\big) \\ge 1 - \\epsilon$，其中 $H \\in \\mathbb{R}^{r \\times p}$ 且 $h \\in \\mathbb{R}^{r}$。数字孪生可以在当前时刻 $k$ 提供独立同分布的扰动样本 $\\{w_k^{(j)}\\}_{j=1}^{N}$，这些样本代表了单步预测的不确定性。构建一个基于场景的随机模型预测控制 (SMPC) 优化问题，用这 $N$ 个采样的确定性约束替代概率性机会约束。使用一个决策向量 $\\theta := (v_k, \\alpha)$，其中 $v_k \\in \\mathbb{R}^{m}$ 是标称输入，$\\alpha \\in \\mathbb{R}_{\\ge 0}$ 是一个标量管半径，用于收紧标称输出约束。令标称下一步输出为 $y_{k+1}^{\\mathrm{nom}} = C(A z_k + B v_k)$，并使用收紧量 $H y_{k+1}^{\\mathrm{nom}} \\le h - \\Gamma \\alpha$（其中 $\\Gamma \\in \\mathbb{R}^{r}_{>0}$ 是一个已知向量），以及采样边界 $\\alpha \\ge \\|C w_k^{(j)}\\|_{\\infty}$（对所有 $j \\in \\{1,\\dots,N\\}$）。定义一个凸二次阶段目标函数\n$$\nJ(v_k,\\alpha) := \\big(A z_k + B v_k\\big)^{\\top} Q \\big(A z_k + B v_k\\big) + v_k^{\\top} R v_k + \\rho\\, \\alpha^{2},\n$$\n其中 $Q \\in \\mathbb{S}^{n}_{\\succeq 0}$，$R \\in \\mathbb{S}^{m}_{\\succ 0}$，且 $\\rho > 0$。\n\n在假设所得场景规划有唯一优化器，且其支持维度受决策维度 $d := \\dim(\\theta)$ 上界约束的条件下，从第一性原理推导基于场景的样本复杂度条件，该条件保证原始机会约束在违规水平 $\\epsilon$ 和置信水平 $1 - \\delta$ 下成立。然后，对于特定值 $\\epsilon = 0.1$，$\\delta = 1 \\times 10^{-4}$，和 $d = 2$，计算满足保证所需的最小整数样本量 $N$。请将您的最终答案以单个整数 $N$ 的形式给出。此问题无需舍入说明，因为答案是无物理单位的精确整数。",
            "solution": "用户提供了一个关于信息物理系统的随机模型预测控制领域的问题陈述。第一步是验证问题陈述。\n\n### 第一步：提取已知条件\n-   系统动态：$x_{k+1} = A x_k + B u_k + w_k$， $y_k = C x_k$。\n-   状态、输入、输出和扰动向量：$x_k \\in \\mathbb{R}^{n}$，$u_k \\in \\mathbb{R}^{m}$，$y_k \\in \\mathbb{R}^{p}$，$w_k \\in \\mathbb{R}^{n}$。\n-   扰动模型：$w_k$ 是一个数据驱动的随机过程；样本 $\\{w_k^{(j)}\\}_{j=1}^{N}$ 是独立同分布 (i.i.d.) 的。\n-   基于管的控制策略：$u_k = v_k + K e_k$，具有预稳定反馈增益 $K \\in \\mathbb{R}^{m \\times n}$。\n-   标称状态动态：$z_{k+1} = A z_k + B v_k$。\n-   误差动态：$e_{k+1} = (A + B K) e_k + w_k$，其中误差 $e_k = x_k - z_k$ 初始化为 $e_k = 0$。\n-   概率性机会约束：$\\mathbb{P}\\big(H y_{k+1} \\le h\\big) \\ge 1 - \\epsilon$，其中 $H \\in \\mathbb{R}^{r \\times p}$，$h \\in \\mathbb{R}^{r}$。\n-   基于场景的 SMPC 表述：\n    -   决策向量：$\\theta := (v_k, \\alpha)$，其中 $v_k \\in \\mathbb{R}^{m}$ 且 $\\alpha \\in \\mathbb{R}_{\\ge 0}$。\n    -   目标函数：$J(v_k,\\alpha) := \\big(A z_k + B v_k\\big)^{\\top} Q \\big(A z_k + B v_k\\big) + v_k^{\\top} R v_k + \\rho\\, \\alpha^{2}$，其中 $Q \\in \\mathbb{S}^{n}_{\\succeq 0}$，$R \\in \\mathbb{S}^{m}_{\\succ 0}$，且 $\\rho > 0$。\n    -   标称约束收紧：$H y_{k+1}^{\\mathrm{nom}} \\le h - \\Gamma \\alpha$，其中 $y_{k+1}^{\\mathrm{nom}} = C(A z_k + B v_k)$ 且 $\\Gamma \\in \\mathbb{R}^{r}_{>0}$。\n    -   采样约束：$\\alpha \\ge \\|C w_k^{(j)}\\|_{\\infty}$ 对所有 $j \\in \\{1,\\dots,N\\}$。\n-   假设：场景规划有唯一优化器，且其支持维度受决策维度 $d := \\dim(\\theta)$ 的上界约束。\n-   用于计算的特定值：违规水平 $\\epsilon = 0.1$，置信参数 $\\delta = 1 \\times 10^{-4}$，决策维度 $d = 2$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了基于管的随机模型预测控制的标准表述，使用了场景法，这是控制理论中一个成熟的方法。系统模型是一个带加性随机扰动的线性时不变系统，这是一个经典模型。使用二次成本函数和线性约束定义了一个凸优化问题，具体来说是一个凸二次规划 (QP)。\n\n该问题是适定的。它要求推导一个已知的理论结果（场景优化的样本复杂度），并应用该结果计算一个特定值。所提供的假设——凸性、独立同分布样本、唯一优化器以及支持维度的界限——正是应用标准场景优化理论所需的条件。所有必要的数值（$\\epsilon$、$\\delta$、$d$）均已为最终计算提供。\n\n该问题是客观的，并使用清晰、无歧义的数学语言。没有矛盾、信息缺失或科学上不合理的论断。该表述是自洽的，足以得到唯一解。\n\n### 第三步：结论与行动\n该问题被判定为**有效**。我们开始求解。\n\n### 求解推导\n该问题要求我们找到最小样本量 $N$，用于一个基于场景的优化问题，以保证在特定置信度下，一个机会约束得到满足。这是场景优化理论中的一个经典问题。\n\n整体优化问题是在一组约束条件下，最小化关于决策向量 $\\theta = (v_k, \\alpha)$ 的成本函数 $J(v_k, \\alpha)$。决策向量的维度为 $d = \\dim(v_k) + \\dim(\\alpha) = m+1$。成本函数 $J(v_k, \\alpha)$ 是凸的，因为 $Q \\succeq 0$，$R \\succ 0$，且 $\\rho > 0$。约束条件是：\n1.  $H C(A z_k + B v_k) + \\Gamma \\alpha - h \\le 0$。这些是关于 $v_k$ 和 $\\alpha$ 的线性不等式。\n2.  $\\|C w_k^{(j)}\\|_{\\infty} - \\alpha \\le 0$ 对 $j=1, \\dots, N$。这可以写成一组线性不等式：$C_i w_k^{(j)} - \\alpha \\le 0$ 和 $-C_i w_k^{(j)} - \\alpha \\le 0$，其中 $C_i$ 是 $C$ 的每一行。这些不等式在 $\\alpha$ 上是线性的。\n\n由于目标函数是凸的，且约束条件定义了一个凸集，因此所得的场景规划是一个凸优化问题。\n\n问题在于找到一个优化器 $\\theta_N^*=(v_k^*, \\alpha^*)$，该优化器求解\n$$ \\min_{\\theta} J(\\theta) \\quad \\text{s.t. 样本 } \\{w_k^{(j)}\\}_{j=1}^N \\text{ 的约束被满足。} $$\n这个解 $\\theta_N^*$ 是一个随机变量，因为它依赖于随机样本 $\\{w_k^{(j)}\\}_{j=1}^N$。基于场景的方法用有限数量的确定性约束替代了原始的概率约束 $\\mathbb{P}\\big(H y_{k+1} \\le h\\big) \\ge 1 - \\epsilon$。如思路中所述，只要向量 $\\Gamma$ 被适当地选择，要使原始约束 $H y_{k+1} \\le h$ 对于给定的扰动 $w$ 成立，一个充分条件是 $\\|Cw\\|_{\\infty} \\le \\alpha^*$。场景规划强制执行与此逻辑相关的约束。\n\n问题的核心在于由 Campi 和 Garatti 开创的场景优化一般理论。该理论为解 $\\theta_N^*$ 的质量提供了保证。质量由违规概率 $V(\\theta_N^*)$ 来衡量，它是指解 $\\theta_N^*$ 对于一个新的、未见的扰动样本 $w$ 是不可行的概率。\n\n根据该理论，对于一个具有 $N$ 个独立同分布样本的凸场景规划，其中解是唯一的，且支持约束的数量几乎必然受决策向量维度 $d$ 的限制，以下概率保证成立：\n$$ \\mathbb{P}_{\\{w_k^{(j)}\\}_{j=1}^N} \\Big( V(\\theta_N^*) > \\epsilon \\Big) \\le \\sum_{i=0}^{d-1} \\binom{N}{i} \\epsilon^i (1-\\epsilon)^{N-i} $$\n这里，$V(\\theta_N^*)$ 是违反底层机会约束的概率，$\\epsilon$ 是期望的违规水平，左侧的概率 $\\mathbb{P}$ 是在所有可能的 $N$ 个样本集空间上计算的。右侧是二项分布 $B(N, \\epsilon)$ 的累积分布函数。\n\n这个不等式提供了一个置信水平，即场景规划的解将“足够好”（即其违规概率不超过 $\\epsilon$）。问题要求这个置信水平至少为 $1 - \\delta$。因此，我们必须确保获得“坏”解（即 $V(\\theta_N^*) > \\epsilon$ 的解）的概率不超过 $\\delta$。这导出了样本复杂度条件：\n$$ \\sum_{i=0}^{d-1} \\binom{N}{i} \\epsilon^i (1-\\epsilon)^{N-i} \\le \\delta $$\n这就是从场景优化理论的第一性原理推导出的样本复杂度条件。\n\n### 样本量 N 的计算\n问题要求计算满足此条件并符合给定参数的最小整数样本量 $N$：\n-   违规水平：$\\epsilon = 0.1$\n-   置信参数：$\\delta = 1 \\times 10^{-4}$\n-   决策向量维度：$d = 2$\n\n将这些值代入不等式，我们得到：\n$$ \\sum_{i=0}^{2-1} \\binom{N}{i} (0.1)^i (1-0.1)^{N-i} \\le 1 \\times 10^{-4} $$\n$$ \\sum_{i=0}^{1} \\binom{N}{i} (0.1)^i (0.9)^{N-i} \\le 10^{-4} $$\n展开 $i=0$ 和 $i=1$ 的求和项：\n$$ \\binom{N}{0} (0.1)^0 (0.9)^N + \\binom{N}{1} (0.1)^1 (0.9)^{N-1} \\le 10^{-4} $$\n$$ (1)(1)(0.9)^N + (N)(0.1)(0.9)^{N-1} \\le 10^{-4} $$\n我们可以提出 $(0.9)^N$：\n$$ (0.9)^N + \\frac{N \\cdot 0.1}{0.9} (0.9)^N \\le 10^{-4} $$\n$$ (0.9)^N \\left(1 + \\frac{N}{9}\\right) \\le 10^{-4} $$\n我们必须找到满足这个超越不等式的最小整数 $N$。我们定义函数 $f(N) = (0.9)^N (1 + N/9)$ 并测试整数值 $N$。\n我们寻求使 $f(N) \\le 10^{-4}$ 成立的最小整数 $N$。\n\n我们来测试 $N$ 的值：\n对于 $N=112$：\n$$ f(112) = (0.9)^{112} \\left(1 + \\frac{112}{9}\\right) \\approx (7.822 \\times 10^{-6}) \\left(\\frac{9+112}{9}\\right) = (7.822 \\times 10^{-6}) \\left(\\frac{121}{9}\\right) $$\n$$ f(112) \\approx (7.822 \\times 10^{-6}) (13.444\\dots) \\approx 1.0519 \\times 10^{-4} $$\n由于 $1.0519 \\times 10^{-4} > 1 \\times 10^{-4}$，$N=112$ 是不够的。\n\n我们来测试 $N=113$：\n$$ f(113) = (0.9)^{113} \\left(1 + \\frac{113}{9}\\right) = (0.9) \\cdot (0.9)^{112} \\left(\\frac{9+113}{9}\\right) $$\n$$ f(113) \\approx (0.9) \\cdot (7.822 \\times 10^{-6}) \\left(\\frac{122}{9}\\right) = (7.0398 \\times 10^{-6}) (13.555\\dots) $$\n$$ f(113) \\approx 0.9543 \\times 10^{-4} $$\n由于 $0.9543 \\times 10^{-4}  1 \\times 10^{-4}$，$N=113$ 是足够的。\n\n因此，满足保证所需的最小整数样本量为 113。",
            "answer": "$$\\boxed{113}$$"
        }
    ]
}