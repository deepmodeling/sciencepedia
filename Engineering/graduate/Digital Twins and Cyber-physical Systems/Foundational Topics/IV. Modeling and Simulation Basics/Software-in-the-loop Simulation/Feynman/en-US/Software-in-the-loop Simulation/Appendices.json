{
    "hands_on_practices": [
        {
            "introduction": "A robust Software-in-the-Loop (SIL) simulation depends critically on the choice of numerical integrator and its time step. This is especially true for 'stiff' systems, common in engineering, which contain dynamics that evolve on vastly different time scales. This practice will guide you through analyzing the stability of numerical methods, helping you understand why an explicit method can fail and how to determine the maximum allowable step size for a stable simulation .",
            "id": "4246751",
            "problem": "A software-in-the-loop (SIL) experiment for a digital twin of a cyber-physical system employs a host-based numerical integrator to simulate a stiff continuous-time plant while executing the controller software in the loop. Near a nominal operating point, the plant is linearized to the time-invariant form $\\dot{x}(t) = A x(t)$, where $A \\in \\mathbb{R}^{n \\times n}$ is the Jacobian of the plant dynamics. The plant exhibits stiffness because the eigenvalues of $A$ have large negative real parts. At a particular operating point, numerical linear analysis yields three real eigenvalues $\\lambda_{1} = -2.0 \\times 10^{3}\\ \\text{s}^{-1}$, $\\lambda_{2} = -50\\ \\text{s}^{-1}$, and $\\lambda_{3} = -0.5\\ \\text{s}^{-1}$.\n\nIn this SIL setup, the plant is advanced in time using the explicit forward Euler method with a fixed step size $h > 0$, producing a discrete-time model $x_{k+1} = \\Phi(h)\\,x_{k}$ that is used to update the plant state once per step. Using only fundamental principles of linearization, modal decomposition, and the discrete-time stability criterion for linear time-invariant systems (all eigenvalues of the state transition matrix must lie strictly inside the unit disk), do the following:\n\n- Derive, from first principles, the region of absolute stability in terms of the step size $h$ that guarantees linear stability of each eigenmode when using explicit Euler on the linearized plant.\n- From this, derive the constraint on $h$ that guarantees linear stability of all three modes simultaneously, and compute the largest uniform step size $h$ admissible for the given eigenvalues.\n- For comparison, repeat the modal stability analysis for the implicit backward Euler method applied to the same linearized plant and identify whether any step size restriction is required to maintain linear stability for eigenvalues with strictly negative real parts. You must justify your conclusion from first principles, but you do not need to report it in your final numeric answer.\n\nExpress your final $h$ in seconds and round your answer to $3$ significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of numerical analysis and control theory, is well-posed, and is stated objectively. We may proceed with the solution.\n\nThe problem asks for an analysis of the numerical stability of a software-in-the-loop (SIL) simulation. The plant dynamics are linearized around an operating point, resulting in a linear time-invariant (LTI) system:\n$$\n\\dot{x}(t) = A x(t)\n$$\nwhere $x(t) \\in \\mathbb{R}^n$ is the state vector and $A \\in \\mathbb{R}^{n \\times n}$ is the system Jacobian. The system is characterized by three real eigenvalues: $\\lambda_{1} = -2.0 \\times 10^{3}\\ \\text{s}^{-1}$, $\\lambda_{2} = -50\\ \\text{s}^{-1}$, and $\\lambda_{3} = -0.5\\ \\text{s}^{-1}$.\n\nTo analyze the stability of a numerical method, we can decouple the system dynamics using a modal decomposition. Assuming the matrix $A$ is diagonalizable (which is guaranteed here as it has distinct real eigenvalues), there exists a transformation $x(t) = P z(t)$, where $P$ is the matrix of eigenvectors of $A$. Substituting this into the state equation yields:\n$$\nP \\dot{z}(t) = A P z(t)\n$$\n$$\n\\dot{z}(t) = P^{-1} A P z(t) = \\Lambda z(t)\n$$\nwhere $\\Lambda$ is the diagonal matrix of eigenvalues of $A$. This transformation decouples the $n$-dimensional system into $n$ independent scalar ordinary differential equations (ODEs), one for each mode $z_i(t)$:\n$$\n\\dot{z}_i(t) = \\lambda_i z_i(t) \\quad \\text{for } i = 1, 2, 3\n$$\nThe stability of the numerical method applied to the full system $\\dot{x}(t) = A x(t)$ is equivalent to its stability when applied to each of these scalar test equations.\n\n**Part 1: Stability Analysis of the Explicit Forward Euler Method**\n\nThe explicit forward Euler method approximates the derivative $\\dot{z}_i(t)$ using a forward difference formula with a fixed step size $h > 0$:\n$$\n\\dot{z}_i(t_k) \\approx \\frac{z_{i}(t_{k+1}) - z_{i}(t_k)}{h}\n$$\nwhere $t_k = kh$ and we use the notation $z_{i,k} \\equiv z_i(t_k)$. Applying this to the modal ODE $\\dot{z}_i(t) = \\lambda_i z_i(t)$ gives:\n$$\n\\frac{z_{i,k+1} - z_{i,k}}{h} = \\lambda_i z_{i,k}\n$$\nSolving for $z_{i,k+1}$ yields the discrete-time update rule for the $i$-th mode:\n$$\nz_{i,k+1} = z_{i,k} + h \\lambda_i z_{i,k} = (1 + h \\lambda_i) z_{i,k}\n$$\nFor the discrete-time system to be stable, the magnitude of the propagation factor (which is the eigenvalue of the single-mode discrete-time state transition matrix) must be strictly less than $1$. This is the unit disk criterion mentioned in the problem. Thus, for each mode $i$, we require:\n$$\n|1 + h \\lambda_i| < 1\n$$\nThis inequality defines the region of absolute stability for the forward Euler method. Since the given eigenvalues $\\lambda_i$ are real and negative, and the step size $h$ is real and positive, the term $h \\lambda_i$ is a negative real number. The absolute value inequality can be written as a pair of inequalities:\n$$\n-1 < 1 + h \\lambda_i < 1\n$$\nWe analyze each inequality separately:\n1.  The right-hand side: $1 + h \\lambda_i < 1 \\implies h \\lambda_i < 0$. Since $h > 0$ and all given $\\lambda_i < 0$, this condition is always satisfied.\n2.  The left-hand side: $-1 < 1 + h \\lambda_i \\implies -2 < h \\lambda_i$. Since $\\lambda_i$ is negative, dividing by it reverses the inequality sign:\n$$\nh < -\\frac{2}{\\lambda_i}\n$$\nThis is the constraint on the step size $h$ that guarantees the stability of the $i$-th mode. For the entire system to be stable, this constraint must be satisfied for all modes simultaneously. This means $h$ must be less than the minimum of the upper bounds determined by each eigenvalue.\n\n**Part 2: Calculation of the Maximum Admissible Step Size**\n\nWe apply the derived constraint $h < -2/\\lambda_i$ to each of the given eigenvalues:\n- For $\\lambda_1 = -2.0 \\times 10^3\\ \\text{s}^{-1}$:\n$$\nh < -\\frac{2}{-2.0 \\times 10^3} \\ \\text{s} = 1.0 \\times 10^{-3}\\ \\text{s}\n$$\n- For $\\lambda_2 = -50\\ \\text{s}^{-1}$:\n$$\nh < -\\frac{2}{-50} \\ \\text{s} = \\frac{1}{25}\\ \\text{s} = 0.04\\ \\text{s}\n$$\n- For $\\lambda_3 = -0.5\\ \\text{s}^{-1}$:\n$$\nh < -\\frac{2}{-0.5} \\ \\text{s} = 4\\ \\text{s}\n$$\nTo ensure stability for all three modes, the step size $h$ must satisfy all three inequalities. The most restrictive constraint is imposed by the eigenvalue with the largest magnitude, $\\lambda_1$, which corresponds to the fastest dynamic mode of the system. This is a characteristic feature of stiff differential equations.\n$$\nh < \\min(1.0 \\times 10^{-3}, 0.04, 4)\\ \\text{s}\n$$\n$$\nh < 1.0 \\times 10^{-3}\\ \\text{s}\n$$\nThe largest uniform step size $h$ that is admissible is therefore just below $1.0 \\times 10^{-3}\\ \\text{s}$. The problem asks for this value, which we report as $h = 1.0 \\times 10^{-3}\\ \\text{s}$. Rounding to $3$ significant figures gives $1.00 \\times 10^{-3}\\ \\text{s}$.\n\n**Part 3: Comparative Analysis for the Implicit Backward Euler Method**\n\nFor comparison, we analyze the stability of the implicit backward Euler method. The key difference is that the derivative is evaluated using the state at the next time step, $z_{i,k+1}$:\n$$\n\\frac{z_{i,k+1} - z_{i,k}}{h} = \\lambda_i z_{i,k+1}\n$$\nWe solve for $z_{i,k+1}$:\n$$\nz_{i,k+1} - h \\lambda_i z_{i,k+1} = z_{i,k}\n$$\n$$\nz_{i,k+1} (1 - h \\lambda_i) = z_{i,k}\n$$\n$$\nz_{i,k+1} = \\left( \\frac{1}{1 - h \\lambda_i} \\right) z_{i,k}\n$$\nThe stability criterion requires the magnitude of the propagation factor to be less than $1$:\n$$\n\\left| \\frac{1}{1 - h \\lambda_i} \\right| < 1 \\implies |1 - h \\lambda_i| > 1\n$$\nWe are given that the eigenvalues $\\lambda_i$ have strictly negative real parts. Let's analyze this for our real, negative eigenvalues. Let $\\lambda_i = -a_i$ where $a_i > 0$. The stability condition becomes:\n$$\n|1 - h(-a_i)| > 1 \\implies |1 + h a_i| > 1\n$$\nSince $h > 0$ and $a_i > 0$, the product $h a_i$ is a positive real number. Therefore, $1 + h a_i$ is a real number strictly greater than $1$. Its absolute value is itself, so the condition is:\n$$\n1 + h a_i > 1\n$$\nThis inequality is true for any $h > 0$ and any $a_i > 0$. This means the backward Euler method is stable for any positive step size $h$ when applied to a system whose eigenvalues have strictly negative real parts. Such a method is called A-stable. Consequently, for the given linearized plant, the implicit backward Euler method imposes no upper limit on the step size $h$ to maintain linear stability. This property makes it highly suitable for simulating stiff systems, as it allows for much larger time steps than conditionally stable methods like forward Euler, thereby reducing computational cost.\n\nThe final answer required is the largest admissible step size for the forward Euler method.\n$h = 1.0 \\times 10^{-3}\\ \\text{s}$, which rounded to $3$ significant figures is $1.00 \\times 10^{-3}\\ \\text{s}$.",
            "answer": "$$\n\\boxed{1.00 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "Seemingly minor errors at the interface between software components can lead to catastrophic system failure, a lesson learned from many real-world engineering projects. This exercise simulates a common SIL pitfall: a unit mismatch between the plant model and the controller. By working through this problem, you will learn to mathematically analyze the impact of such scaling errors on system stability and derive the necessary correction to restore the intended behavior .",
            "id": "4246810",
            "problem": "A cyber-physical system is represented by a digital twin that exchanges measurements with a controller implemented in Software-In-the-Loop (SIL). The physical plant is a translational mass-spring-damper with mass $m$, viscous damping $c$, and stiffness $k$, whose motion $y(t)$ obeys Newton’s second law $m \\ddot{y}(t) = \\sum F(t)$, where the forces are spring $-k y(t)$, damper $-c \\dot{y}(t)$, and actuator input $u(t)$. The controller is a continuous-time full state-feedback law designed under International System of Units (SI) and expects position in meters and velocity in meters per second. Measurements are communicated from the digital twin to the SIL controller through a software interface.\n\nConsider the following parameters and design:\n\n- Plant parameters: $m = 1\\,\\mathrm{kg}$, $c = 2\\,\\mathrm{N\\cdot s/m}$, $k = 5\\,\\mathrm{N/m}$.\n- State definition: $x(t) = \\begin{pmatrix} y(t) \\\\ \\dot{y}(t) \\end{pmatrix}$.\n- Continuous-time state-space model under SI units: $\\dot{x}(t) = A x(t) + B u(t)$ with $A = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{k}{m} & -\\frac{c}{m} \\end{pmatrix}$ and $B = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix}$.\n- State-feedback controller expecting SI units: $u(t) = -K x(t)$ with $K = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$ where $k_1 = 15\\,\\mathrm{N/m}$ and $k_2 = 8\\,\\mathrm{N\\cdot s/m}$.\n\nIn the SIL setup, the digital twin inadvertently sends position and velocity in millimeters and millimeters per second, respectively, rather than in meters and meters per second. Let the unit-mismatch scaling be represented as $S = \\operatorname{diag}(s, s)$ with $s = 1000$, so that the controller processes $\\tilde{x}(t) = S x(t)$ instead of $x(t)$, yielding the implemented control $u(t) = -K \\tilde{x}(t) = -K S x(t)$. This produces a closed-loop system matrix $A_{\\text{cl,mismatch}} = A - B K S$, whereas the original design yields $A_{\\text{cl,SI}} = A - B K$.\n\nTasks:\n1. Starting from Newton’s second law and the definitions of damping and stiffness forces, derive the state-space model $\\dot{x}(t) = A x(t) + B u(t)$ and express $A$ and $B$ in terms of $m$, $c$, and $k$. Then write the closed-loop system matrices $A_{\\text{cl,SI}}$ and $A_{\\text{cl,mismatch}}$ explicitly in terms of $A$, $B$, $K$, and $S$.\n2. Using fundamental control concepts, explain how the unit scaling $S$ modifies the effective feedback gain and discuss the qualitative consequences for closed-loop stability and dynamic response in continuous time and in sampled implementations (i.e., SIL), referencing the relationship between continuous-time poles and their sampled equivalents via exponentiation.\n3. Compute the scalar gain correction factor $\\gamma$ to pre-scale the measured $\\tilde{x}(t)$ in software before it enters the controller, i.e., implement $u(t) = -K \\left( \\gamma \\tilde{x}(t) \\right)$, so that the resulting closed-loop dynamics match the original SI-based design exactly. Provide $\\gamma$ as a single real-valued number. Round your answer to four significant figures. Because $\\gamma$ is dimensionless, no physical units are required for the final answer.",
            "solution": "The user has provided a problem concerning a unit mismatch in a Software-In-the-Loop (SIL) simulation of a mass-spring-damper system. First, the problem must be validated for scientific soundness, completeness, and objectivity.\n\n### Step 1: Extract Givens\n- **Physical System**: Translational mass-spring-damper.\n- **Equation of Motion**: $m \\ddot{y}(t) = \\sum F(t) = u(t) - k y(t) - c \\dot{y}(t)$.\n- **Parameters**: Mass $m = 1\\,\\mathrm{kg}$, damping coefficient $c = 2\\,\\mathrm{N\\cdot s/m}$, spring constant $k = 5\\,\\mathrm{N/m}$.\n- **State Vector**: $x(t) = \\begin{pmatrix} y(t) \\\\ \\dot{y}(t) \\end{pmatrix}$.\n- **State-Space Model**: $\\dot{x}(t) = A x(t) + B u(t)$, with matrices $A = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{k}{m} & -\\frac{c}{m} \\end{pmatrix}$ and $B = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix}$.\n- **Controller**: State-feedback law $u(t) = -K x(t)$.\n- **Feedback Gain Matrix**: $K = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$, with $k_1 = 15\\,\\mathrm{N/m}$ and $k_2 = 8\\,\\mathrm{N\\cdot s/m}$.\n- **Unit Mismatch**: The controller receives a scaled state vector $\\tilde{x}(t) = S x(t)$.\n- **Scaling Matrix**: $S = \\operatorname{diag}(s, s)$, where the scaling factor is $s = 1000$. This corresponds to measurements being in millimeters and millimeters/second instead of meters and meters/second.\n- **Implemented Control**: $u(t) = -K \\tilde{x}(t) = -K S x(t)$.\n- **Closed-Loop Matrices**: The intended system is $A_{\\text{cl,SI}} = A - B K$, and the actual mismatched system is $A_{\\text{cl,mismatch}} = A - B K S$.\n- **Tasks**:\n  1. Derive the state-space model and express the closed-loop matrices.\n  2. Explain the qualitative consequences of the scaling mismatch on stability and dynamics.\n  3. Compute a scalar correction factor $\\gamma$ for a modified control law $u(t) = -K ( \\gamma \\tilde{x}(t) )$ to restore the intended system dynamics. The final numerical answer for $\\gamma$ should be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is firmly rooted in classical mechanics (Newton's second law for a mass-spring-damper) and fundamental linear systems and control theory (state-space representation, state-feedback control). The scenario of a unit mismatch is a common and critical issue in the engineering practice of cyber-physical systems and SIL simulation. All parameters and units are consistent with the International System of Units (SI).\n- **Well-Posedness**: The problem is self-contained and provides all necessary information to solve the tasks. The definitions are clear, and the questions lead to unique, verifiable answers.\n- **Objectivity**: The problem is stated in precise, technical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and objective. There are no contradictions, missing data, or other flaws. A full solution will be provided.\n\n### Solution\n\nThe problem addresses the consequences of a unit-scaling error in a cyber-physical control system and the method to correct it. We will address the three tasks sequentially.\n\n**Task 1: Derivation of the State-Space Model and Closed-Loop Matrices**\n\nThe dynamics of the physical plant are described by Newton's second law for the translational mass-spring-damper system. The sum of forces acting on the mass $m$ is equal to the mass times its acceleration, $\\ddot{y}(t)$.\nThe forces are the external control input $u(t)$, the spring force $-k y(t)$, and the damping force $-c \\dot{y}(t)$.\nThe equation of motion is:\n$$m \\ddot{y}(t) = u(t) - c \\dot{y}(t) - k y(t)$$\nTo derive the state-space model, we first isolate the highest-order derivative, $\\ddot{y}(t)$:\n$$\\ddot{y}(t) = -\\frac{k}{m} y(t) - \\frac{c}{m} \\dot{y}(t) + \\frac{1}{m} u(t)$$\nThe state variables are defined as $x_1(t) = y(t)$ (position) and $x_2(t) = \\dot{y}(t)$ (velocity). The state vector is $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$.\nWe now write the first-order differential equations for the state variables:\nThe derivative of the first state variable is:\n$$\\dot{x}_1(t) = \\frac{d}{dt}(y(t)) = \\dot{y}(t) = x_2(t)$$\nThe derivative of the second state variable is:\n$$\\dot{x}_2(t) = \\frac{d}{dt}(\\dot{y}(t)) = \\ddot{y}(t) = -\\frac{k}{m} y(t) - \\frac{c}{m} \\dot{y}(t) + \\frac{1}{m} u(t) = -\\frac{k}{m} x_1(t) - \\frac{c}{m} x_2(t) + \\frac{1}{m} u(t)$$\nThese two equations can be written in matrix form, $\\dot{x}(t) = A x(t) + B u(t)$:\n$$\\begin{pmatrix} \\dot{x}_1(t) \\\\ \\dot{x}_2(t) \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{k}{m} & -\\frac{c}{m} \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix} u(t)$$\nBy inspection, the state-space matrices expressed in terms of the physical parameters are:\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{k}{m} & -\\frac{c}{m} \\end{pmatrix} \\quad \\text{and} \\quad B = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} \\end{pmatrix}$$\nThis completes the derivation as requested.\n\nNext, we write the closed-loop system matrices. The control law is $u(t) = -Kx(t)$. The closed-loop system dynamics are obtained by substituting the control law into the state equation: $\\dot{x}(t) = A x(t) + B(-Kx(t)) = (A - BK)x(t)$.\nThe correctly configured closed-loop system matrix, using SI units throughout, is:\n$$A_{\\text{cl,SI}} = A - B K$$\nIn the case of the unit mismatch, the controller receives the scaled state vector $\\tilde{x}(t) = S x(t)$, so the implemented control is $u(t) = -K\\tilde{x}(t) = -K S x(t)$. The closed-loop dynamics become $\\dot{x}(t) = A x(t) + B(-KSx(t)) = (A - BKS)x(t)$.\nThus, the closed-loop system matrix under the unit mismatch is:\n$$A_{\\text{cl,mismatch}} = A - B K S$$\n\n**Task 2: Qualitative Consequences of the Unit Mismatch**\n\nThe unit mismatch results in the controller operating on $\\tilde{x}(t) = S x(t)$ instead of $x(t)$. The scaling matrix is $S = sI$, where $I$ is the $2 \\times 2$ identity matrix and $s = 1000$. The implemented control law is $u(t) = -K\\tilde{x}(t) = -K(Sx(t))$. Since $S = sI$, this becomes $u(t) = -K(sI)x(t) = -sKx(t)$.\nThis means the effective feedback gain matrix is $K_{\\text{eff}} = sK$. With $s = 1000$, the feedback gains $k_1$ and $k_2$ are effectively amplified by a factor of $1000$. This has profound consequences for the system's behavior.\n\nThe closed-loop characteristic equation determines the system's poles, which govern stability and dynamic response. For the mismatch system, the equation is $\\det(\\lambda I - A_{\\text{cl,mismatch}}) = 0$.\n$$A_{\\text{cl,mismatch}} = A - B(sK) = \\begin{pmatrix} 0 & 1 \\\\ -k/m & -c/m \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1/m \\end{pmatrix} s\\begin{pmatrix} k_1 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -(k+sk_1)/m & -(c+sk_2)/m \\end{pmatrix}$$\nThe characteristic polynomial is:\n$$\\lambda \\left(\\lambda + \\frac{c+sk_2}{m}\\right) + \\frac{k+sk_1}{m} = 0 \\implies \\lambda^2 + \\left(\\frac{c+sk_2}{m}\\right)\\lambda + \\left(\\frac{k+sk_1}{m}\\right) = 0$$\nThis is the characteristic equation of a second-order system $\\lambda^2 + 2\\zeta\\omega_n\\lambda + \\omega_n^2 = 0$. The effective natural frequency $\\omega_{n,\\text{eff}}$ and damping ratio $\\zeta_{\\text{eff}}$ are determined by:\n$$\\omega_{n,\\text{eff}}^2 = \\frac{k+sk_1}{m} \\quad \\text{and} \\quad 2\\zeta_{\\text{eff}}\\omega_{n,\\text{eff}} = \\frac{c+sk_2}{m}$$\nSince $s = 1000$, both the effective closed-loop stiffness $(k+sk_1)$ and damping $(c+sk_2)$ are enormously increased compared to the intended design values $(k+k_1)$ and $(c+k_2)$. This dramatically increases the natural frequency, making the system respond extremely quickly.\nIn the continuous-time domain, because all parameters ($m, c, k, k_1, k_2, s$) are positive, the coefficients of the characteristic polynomial are positive. By the Routh-Hurwitz stability criterion, the system's poles will remain in the left half of the complex plane, so the system is technically stable. However, such high gains would lead to a severely overdamped or violently oscillatory response, actuator saturation, and excitation of high-frequency dynamics not included in the model, which in practice is a form of failure.\n\nIn a sampled implementation like an SIL, the consequences are even more dire. The stability of a discrete-time system depends on its poles being inside the unit circle in the z-plane. The relationship between a continuous-time pole $\\lambda_c$ and its discrete-time equivalent $\\lambda_d$ for a sampling period $T$ is $\\lambda_d = \\exp(\\lambda_c T)$. The extremely large magnitude of the continuous-time poles of $A_{\\text{cl,mismatch}}$ imposes a severe constraint on the sampling time $T$. For a simple Forward Euler approximation of the dynamics, the discrete system is stable only if all eigenvalues of $(I + T A_{\\text{cl,mismatch}})$ are within the unit circle. This leads to a stability condition of the form $|\\lambda_c| < \\alpha/T$ for some constant $\\alpha$ (e.g., $\\alpha=2$ for real poles). The massive gain $s$ makes $|\\lambda_c|$ extremely large, which can easily violate this condition for any practical $T$, causing the discrete simulation to become numerically unstable.\n\n**Task 3: Computation of the Correction Factor $\\gamma$**\n\nThe goal is to find a scalar correction factor $\\gamma$ such that the modified control law $u(t) = -K (\\gamma \\tilde{x}(t))$ restores the originally intended system behavior. The intended closed-loop dynamics are given by the state-space equation $\\dot{x}(t) = (A - BK)x(t)$.\nWith the proposed correction, the control law is $u(t) = -K \\gamma \\tilde{x}(t)$. Substituting the relation $\\tilde{x}(t) = Sx(t)$, we get:\n$$u(t) = -K \\gamma (S x(t)) = -(K \\gamma S) x(t)$$\nThe resulting closed-loop system dynamics are:\n$$\\dot{x}(t) = A x(t) + B u(t) = A x(t) - B(K \\gamma S)x(t) = (A - B K \\gamma S) x(t)$$\nFor these dynamics to be identical to the intended dynamics for any state $x(t)$, the closed-loop matrices must be equal:\n$$A - B K = A - B K \\gamma S$$\nThis equation simplifies to:\n$$B K = B K \\gamma S$$\nThe matrix $S$ is given as $S = \\operatorname{diag}(s, s)$, which can be written as $S = sI$, where $I$ is the identity matrix. Since $\\gamma$ and $s$ are scalars, they commute with all matrices.\n$$B K = B K \\gamma s I = \\gamma s (B K)$$\nThe matrix product $BK$ is:\n$$BK = \\begin{pmatrix} 0 \\\\ 1/m \\end{pmatrix} \\begin{pmatrix} k_1 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ k_1/m & k_2/m \\end{pmatrix}$$\nSince $m$, $k_1$, and $k_2$ are all non-zero, $BK$ is not a zero matrix. Therefore, we can validly conclude from the equation $BK = \\gamma s (BK)$ that:\n$$\\gamma s = 1$$\nSolving for the correction factor $\\gamma$:\n$$\\gamma = \\frac{1}{s}$$\nGiven the scaling factor $s = 1000$:\n$$\\gamma = \\frac{1}{1000} = 0.001$$\nThe problem requires the answer to be rounded to four significant figures. The exact value is $0.001$. To express this with four significant figures, we include trailing zeros.\n$$\\gamma = 0.001000$$\nThis factor $\\gamma$ effectively inverts the erroneous scaling introduced by the unit mismatch before the measurement is used by the controller, thus restoring the intended system behavior.",
            "answer": "$$\\boxed{0.001000}$$"
        },
        {
            "introduction": "When coupling system components in a simulation, circular dependencies known as 'algebraic loops' can arise, preventing the simulation from advancing. A common technique to resolve this is to insert a small delay, but this architectural change is not without consequences. This practice explores how introducing latency breaks an algebraic loop and transforms the problem into one of dynamic stability, requiring you to analyze the system's behavior in the discrete-time domain .",
            "id": "4246841",
            "problem": "A digital twin for a Cyber-Physical System (CPS) is evaluated using Software-In-the-Loop (SIL) simulation at sampling period $T_{s}$. The physical plant is modeled as a static gain, with output $y$ and input $u$ related by $y = G u$, where $G \\in \\mathbb{R}$ is the plant gain. The controller is also static and proportional: $u = K y$, where $K \\in \\mathbb{R}$ is the controller gain. In the SIL co-simulation, connecting $y = G u$ and $u = K y$ directly introduces an algebraic loop. To remove the algebraic loop and to emulate computation and communication scheduling, the SIL harness applies a latency insertion technique: the feedback signal is delayed by exactly one sampling period, that is, $T_{d} = T_{s}$, so that the controller uses the previous sampled output to compute the current input. Assume ideal sampling with Zero-Order Hold (ZOH) and that the delay is applied in the feedback path so that $u[k] = K y[k-1]$ while the plant remains $y[k] = G u[k]$ at each sample index $k \\in \\mathbb{Z}$.\n\nUsing only fundamental definitions of sampled-data systems and linear time-invariant (LTI) discrete-time stability, perform the following:\n- Derive the closed-loop algebraic equation implied by the direct continuous-time interconnection $y = G u$ and $u = K y$ before latency insertion.\n- Derive the discrete-time closed-loop equation after latency insertion with $T_{d} = T_{s}$, and express the corresponding characteristic equation in the $z$-domain.\n- From first principles, analyze the condition on $G$ and $K$ under which the latency insertion with $T_{d} = T_{s}$ stabilizes the loop.\n\nReport as your final answer the scalar closed-loop pole location in the $z$-plane after latency insertion, expressed as a single analytic expression in $G$ and $K$. No numerical evaluation is required, and no units are to be included in the final answer.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- System: Software-In-the-Loop (SIL) simulation for a Cyber-Physical System (CPS).\n- Sampling period: $T_{s}$.\n- Physical plant model: $y = G u$, where $G \\in \\mathbb{R}$ is the plant gain.\n- Controller model: $u = K y$, where $K \\in \\mathbb{R}$ is the controller gain.\n- Problem with direct connection: introduces an algebraic loop.\n- Latency insertion technique: feedback signal is delayed by $T_{d} = T_{s}$.\n- Discrete-time controller equation: $u[k] = K y[k-1]$ for sample index $k \\in \\mathbb{Z}$.\n- Discrete-time plant equation: $y[k] = G u[k]$.\n- Sampling assumption: Ideal sampling with Zero-Order Hold (ZOH).\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is based on fundamental concepts of control theory, specifically sampled-data systems, and their application in SIL co-simulation, which is a standard practice in digital twin and CPS development. The models for the plant and controller are static gains, which are the simplest form of linear time-invariant (LTI) systems. The concept of an algebraic loop and its resolution using a unit delay ($z^{-1}$) is a standard and correct topic in control and simulation theory.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary equations and parameters ($G$, $K$) to perform the required derivations. The tasks are specific: derive the algebraic loop equation, derive the discrete-time characteristic equation, and determine the stability condition. This structure leads to a unique and meaningful solution.\n- **Objective**: The problem is stated using precise, unambiguous technical language common in control engineering. There are no subjective or opinion-based elements.\n\nThe problem does not exhibit any of the invalidity flaws. It is a well-formulated, standard problem in elementary discrete-time control theory applied to a practical simulation context.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe solution proceeds by addressing the three tasks specified in the problem statement.\n\n**1. Derivation of the Closed-Loop Algebraic Equation (before latency insertion)**\n\nThe continuous-time interconnection is described by two simultaneous equations:\n$$y = G u$$\n$$u = K y$$\n\nTo find the closed-loop equation, we substitute one into the other. Substituting the expression for $u$ from the second equation into the first equation yields:\n$$y = G (K y)$$\n$$y = (GK) y$$\n\nRearranging this equation gives:\n$$y - GK y = 0$$\n$$(1 - GK) y = 0$$\n\nThis is the closed-loop algebraic equation. For a non-trivial solution ($y \\neq 0$) to exist, the condition $1 - GK = 0$ must be met. In a simulation environment, trying to compute $y$ requires a value for $u$, which in turn requires the value of $y$ at the same time instant. This circular dependency is known as an algebraic loop and cannot be resolved by a sequential execution engine without an iterative solver or the introduction of a delay.\n\n**2. Derivation of the Discrete-Time Closed-Loop Equation and Characteristic Equation (after latency insertion)**\n\nThe SIL harness introduces a delay of one sampling period, $T_{d} = T_{s}$, in the feedback path to break the algebraic loop. The system dynamics at each discrete sampling instant $k$ are described by:\nPlant: $y[k] = G u[k]$\nController: $u[k] = K y[k-1]$\n\nTo derive the discrete-time closed-loop equation, we substitute the controller's output $u[k]$ into the plant equation:\n$$y[k] = G (K y[k-1])$$\n$$y[k] = (GK) y[k-1]$$\n\nThis is a first-order linear homogeneous difference equation describing the evolution of the output $y$ over time. To find the characteristic equation, we apply the $z$-transform to this difference equation. Let $Y(z)$ be the $z$-transform of the sequence $y[k]$. Using the time-shifting property of the $z$-transform, $\\mathcal{Z}\\{y[k-1]\\} = z^{-1}Y(z)$, we get:\n$$Y(z) = G K (z^{-1} Y(z))$$\n\nTo find the characteristic equation, we gather all terms on one side:\n$$Y(z) - GK z^{-1} Y(z) = 0$$\n$$Y(z) (1 - GK z^{-1}) = 0$$\n\nFor a non-trivial solution ($Y(z) \\neq 0$), the term in the parenthesis must be zero. This gives a form of the characteristic equation:\n$$1 - GK z^{-1} = 0$$\n\nMultiplying by $z$ yields the characteristic equation in the standard polynomial form:\n$$z - GK = 0$$\n\n**3. Stability Analysis**\n\nAccording to the principles of LTI discrete-time systems, a system is asymptotically stable if and only if all the poles of its closed-loop transfer function (i.e., the roots of its characteristic equation) lie strictly inside the unit circle in the complex $z$-plane.\n\nFrom the characteristic equation $z - GK = 0$, we can directly identify the location of the single closed-loop pole:\n$$z = GK$$\n\nFor the system to be stable, the magnitude of this pole must be less than $1$:\n$$|z| < 1$$\n$$|GK| < 1$$\n\nTherefore, the latency insertion technique stabilizes the system if and only if the absolute value of the product of the plant and controller gains is less than one. If $|GK| = 1$, the system is marginally stable (the output will oscillate or remain constant). If $|GK| > 1$, the system is unstable (the output will grow without bound).\n\nThe problem asks for the scalar closed-loop pole location in the $z$-plane, which is the expression derived from the characteristic equation.\nThe pole is located at $z = GK$.",
            "answer": "$$\n\\boxed{GK}\n$$"
        }
    ]
}