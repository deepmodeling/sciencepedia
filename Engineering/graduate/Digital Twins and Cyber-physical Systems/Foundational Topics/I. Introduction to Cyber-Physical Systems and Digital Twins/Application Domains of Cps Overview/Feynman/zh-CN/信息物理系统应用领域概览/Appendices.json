{
    "hands_on_practices": [
        {
            "introduction": "在自动驾驶和高级驾驶员辅助系统等安全关键的汽车应用中，可预测的低延迟通信至关重要。本练习将探讨时间敏感网络（TSN）中的一个核心挑战：如何从基本原理出发，分析确定性控制流量的端到端最坏情况延迟。通过推导延迟公式，您将深入理解网络调度、保护带和序列化等因素如何共同决定实时通信性能。",
            "id": "4205555",
            "problem": "考虑在汽车领域中，一个 Cyber-Physical System (CPS) 的确定性控制流量通过一个带有 Time-Aware Shapers (IEEE 802.1Qbv) 的 Time-Sensitive Networking (TSN) Ethernet 传输。每个交换机执行一个周期性的门控列表 (Gate Control List, GCL)，在每个周期中为调度流量专门打开一个窗口。假设以下基本定义：\n- 大小为 $L_i$ 字节的帧在速率为 $C$ 比特/秒的链路上产生的序列化延迟为 $t_{\\mathrm{ser},i} = \\frac{8 L_i}{C}$。\n- 在调度窗口前配置了一个持续时间为 $t_{\\mathrm{gb}}$ 的保护带，以防止不可抢占的帧与调度窗口重叠。\n- 门控为调度流量每个周期打开一次，周期为 $T_{\\mathrm{cycle}}$，专属调度窗口长度为 $W$。如果一个调度帧在窗口关闭后立即到达，它必须等到下一个窗口开启。\n\n一个控制消息遍历 $N$ 个 Ethernet 跳（链路加网桥）。系统要求和网络参数如下：\n- 链路速率 $C = 1.0 \\times 10^{9}$ 比特/秒。\n- 每跳的每周期调度窗口长度 $W = 2.0 \\times 10^{-5}$ 秒，周期为 $T_{\\mathrm{cycle}} = 1.0 \\times 10^{-4}$ 秒。\n- 每跳的保护带持续时间 $t_{\\mathrm{gb}} = 1.2 \\times 10^{-5}$ 秒。\n- 控制帧大小在每一跳都相同，$L_i = 200$ 字节，对于所有 $i = 1, \\dots, N$。\n- 假设所有网桥同步到相同的周期，但具有独立的相位偏移，并且不保证跨跳的流水线对齐。\n\n任务：\n1. 从第一性原理出发，推导在上述 TSN 时间感知整形器配置下，跨越 $N$ 跳的最坏情况端到端延迟的封闭形式表达式，并明确说明每跳的最坏情况门控等待、保护带和序列化。\n2. 使用你的表达式，确定最大链长 $N_{\\max}$（跳数），使得最坏情况端到端延迟不超过该领域的控制截止时间 $T_{\\mathrm{deadline}} = 2.0 \\times 10^{-3}$ 秒。以整数跳数的形式提供最终答案。除了要求 $N_{\\max}$ 必须是整数外，没有其他取整指令。",
            "solution": "此问题被认为是有效的，因为它科学地基于 Time-Sensitive Networking (TSN) 的原理，问题陈述清晰，数据充分且一致，并且表述客观。我们可以进行推导和计算。\n\n第一个任务是推导一个控制消息遍历 $N$ 跳的最坏情况端到端延迟 $T_{\\text{E2E}}$ 的封闭形式表达式。问题指出，网络由 $N$ 跳组成，由于独立的相位偏移和缺乏流水线对齐，必须假设每一跳都出现最坏情况的延迟。因此，总的端到端延迟是 $N$ 跳中每一跳的最坏情况延迟之和。由于每一跳的所有网络参数都相同，总延迟是单跳最坏情况延迟 $d_{\\text{hop}}$ 的 $N$ 倍。\n\n$$T_{\\text{E2E}} = N \\cdot d_{\\text{hop}}$$\n\n单跳延迟 $d_{\\text{hop}}$ 包括问题中指定的几个组成部分：序列化延迟、最坏情况门控等待时间和保护带延迟。\n\n1.  **序列化延迟 ($t_{\\text{ser}}$)**：这是将帧的比特传输到物理链路所需的时间。问题提供了公式和参数。对于大小为 $L$ 字节的帧，在速率为 $C$ 比特/秒的链路上，序列化延迟为：\n    $$t_{\\text{ser}} = \\frac{8L}{C}$$\n    因子 $8$ 将帧大小从字节转换为比特。\n\n2.  **最坏情况门控等待时间 ($d_{\\text{wait,max}}$)**：Time-Aware Shaper (TAS) 机制在一个持续时间为 $T_{\\text{cycle}}$ 的周期性循环中运行。在每个周期内，一个长度为 $W$ 的特定时间窗口被专门为我们的控制消息所属的调度流量类别保留。一个帧在交换机出口队列的最坏到达情况是，它在为其调度的窗口关闭后的极短时间内到达。该帧必须等待当前周期的剩余时间，直到下一个周期门控打开。此等待时间的持续长度是周期时间减去窗口长度。\n    $$d_{\\text{wait,max}} = T_{\\text{cycle}} - W$$\n\n3.  **保护带延迟 ($t_{\\text{gb}}$)**：问题定义了每个调度窗口前有一个持续时间为 $t_{\\text{gb}}$ 的保护带。这是为了防止其他流量类别中不可抢占的帧“溢出”到调度窗口中。在最坏情况延迟分析中，这被建模为阻塞延迟。一个控制帧到达交换机时，可能会发现一个较低优先级（或其他类别）的帧刚刚开始传输。该控制帧必须等待此传输完成后，才能考虑其自身的排队和调度过程。问题将此阻塞的最大持续时间指定为一个固定值 $t_{\\text{gb}}$。因此，我们将此项添加到我们的单跳延迟计算中。\n\n结合这些组成部分，单跳的最坏情况延迟是由于保护带引起的阻塞延迟、最大门控等待时间和序列化延迟的总和。\n$$d_{\\text{hop}} = t_{\\text{gb}} + d_{\\text{wait,max}} + t_{\\text{ser}}$$\n代入每个分量的表达式，我们得到：\n$$d_{\\text{hop}} = t_{\\text{gb}} + (T_{\\text{cycle}} - W) + \\frac{8L}{C}$$\n\n因此，跨越 $N$ 跳的最坏情况端到端延迟的封闭形式表达式是：\n$$T_{\\text{E2E}}(N) = N \\left( t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C} \\right)$$\n第一个任务到此结束。\n\n第二个任务是找到最大跳数 $N_{\\max}$，使得端到端延迟不超过指定的截止时间 $T_{\\text{deadline}}$。我们建立以下不等式：\n$$T_{\\text{E2E}}(N) \\le T_{\\text{deadline}}$$\n代入我们推导出的 $T_{\\text{E2E}}(N)$ 表达式：\n$$N \\left( t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C} \\right) \\le T_{\\text{deadline}}$$\n求解 $N$：\n$$N \\le \\frac{T_{\\text{deadline}}}{t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C}}$$\n最大跳数 $N_{\\max}$ 必须是整数，所以我们取右侧表达式的向下取整函数（floor）。\n$$N_{\\max} = \\left\\lfloor \\frac{T_{\\text{deadline}}}{t_{\\text{gb}} + T_{\\text{cycle}} - W + \\frac{8L}{C}} \\right\\rfloor$$\n现在，我们代入给定的数值：\n-   $T_{\\text{deadline}} = 2.0 \\times 10^{-3}$ 秒\n-   $t_{\\text{gb}} = 1.2 \\times 10^{-5}$ 秒\n-   $T_{\\text{cycle}} = 1.0 \\times 10^{-4}$ 秒\n-   $W = 2.0 \\times 10^{-5}$ 秒\n-   $L = 200$ 字节\n-   $C = 1.0 \\times 10^{9}$ 比特/秒\n\n首先，我们计算序列化延迟 $t_{\\text{ser}}$：\n$$t_{\\text{ser}} = \\frac{8 \\times 200}{1.0 \\times 10^{9}} = \\frac{1600}{10^9} = 1.6 \\times 10^{-6} \\, \\text{s}$$\n接下来，我们计算总的单跳延迟 $d_{\\text{hop}}$：\n$$d_{\\text{hop}} = (1.2 \\times 10^{-5}) + (1.0 \\times 10^{-4} - 2.0 \\times 10^{-5}) + (1.6 \\times 10^{-6})$$\n$$d_{\\text{hop}} = 1.2 \\times 10^{-5} + 8.0 \\times 10^{-5} + 0.16 \\times 10^{-5}$$\n$$d_{\\text{hop}} = (1.2 + 8.0 + 0.16) \\times 10^{-5} = 9.36 \\times 10^{-5} \\, \\text{s}$$\n作为一种以微秒为单位的替代计算方法：\n$$d_{\\text{hop}} = 12.0 \\, \\mu\\text{s} + (100.0 \\, \\mu\\text{s} - 20.0 \\, \\mu\\text{s}) + 1.6 \\, \\mu\\text{s}$$\n$$d_{\\text{hop}} = 12.0 \\, \\mu\\text{s} + 80.0 \\, \\mu\\text{s} + 1.6 \\, \\mu\\text{s} = 93.6 \\, \\mu\\text{s} = 9.36 \\times 10^{-5} \\, \\text{s}$$\n\n最后，我们计算 $N_{\\max}$：\n$$N_{\\max} = \\left\\lfloor \\frac{2.0 \\times 10^{-3}}{9.36 \\times 10^{-5}} \\right\\rfloor = \\left\\lfloor \\frac{200 \\times 10^{-5}}{9.36 \\times 10^{-5}} \\right\\rfloor = \\left\\lfloor \\frac{200}{9.36} \\right\\rfloor$$\n$$N_{\\max} = \\lfloor 21.3675... \\rfloor$$\n由于 $N_{\\max}$ 必须是代表物理跳数的整数，我们对这个值向下取整。\n$$N_{\\max} = 21$$",
            "answer": "$$\\boxed{21}$$"
        },
        {
            "introduction": "信息物理系统在医疗保健领域发挥着日益重要的作用，人工胰腺等闭环系统直接关系到患者的生命安全。本练习将一个简化的葡萄糖-胰岛素动态模型作为数字孪生，要求您应用控制理论来确保系统的稳定性。通过分析系统的特征多项式并计算参数敏感性，您将掌握为安全关键型生物医学CPS设计和验证控制策略的基本方法。",
            "id": "4205546",
            "problem": "医院级人工胰腺信息物理系统 (CPS) 集成了感知、驱动、计算和通信功能，通过闭环胰岛素输送来管理血糖。考虑一个为患者设计的基于数字孪生的控制器，该患者的动态特性由一个在基础值附近小偏差下的最小葡萄糖-胰岛素模型来描述。令 $g(t)$ 表示血浆葡萄糖浓度相对于基础值的偏差，令 $x(t)$ 表示胰岛素作用状态，令 $i(t)$ 表示血浆胰岛素浓度相对于基础值的偏差。外部胰岛素输注率是控制输入 $u(t)$，由驱动器提供。膳食和其他外源性输入被建模为有界扰动 $d(t)$。\n\n假设以下与质量平衡和房室动力学一致的基础线性化最小模型：\n$$\\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) + d(t),$$\n$$\\frac{dx(t)}{dt} = -p_2\\, x(t) + p_3\\, i(t),$$\n$$\\frac{di(t)}{dt} = -n\\, i(t) + u(t),$$\n其中 $S_G > 0$ 是葡萄糖有效性，$p_2 > 0$ 是胰岛素作用衰减率，$p_3 > 0$ 是胰岛素作用增益，而 $n > 0$ 是胰岛素清除率。控制器通过连续葡萄糖监测获取 $g(t)$，并应用比例定律 $u(t) = -K\\, g(t)$，其中 $K > 0$。\n\n对于相对于葡萄糖和胰岛素作用动力学而言具有快速胰岛素动力学的输注途径和设备，假设在小信号操作下对 $i(t)$ 进行准稳态简化，即 $\\frac{di(t)}{dt} \\approx 0$，从而 $i(t) \\approx \\frac{1}{n}\\, u(t)$。在此近似下，闭环动力学简化为2状态系统\n$$\\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t), \\quad \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t), \\quad u(t) = -K\\, g(t)。$$\n\n任务：\n- 从给定的定义和简化假设出发，推导该2状态系统的闭环特征多项式，并确定在没有扰动 $d(t)$ 的情况下，保证平衡点 $g(t) = 0$, $x(t) = 0$ 渐近稳定的关于 $K$ 的条件。\n- 将最大稳定比例增益 $K_{\\text{max}}$ 定义为能保持渐近稳定性的最大 $K$ 值。使用线性系统稳定性的第一性原理，用 $S_G$、$p_2$、$p_3$ 和 $n$ 表示 $K_{\\text{max}}$。\n- 计算 $K_{\\text{max}}$ 关于胰岛素作用增益 $p_3$ 的归一化灵敏度，该灵敏度由对数灵敏度指数 $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$ 定义。将该灵敏度指数报告为单个实数。无需四舍五入，最终答案中不应包含单位。",
            "solution": "问题陈述首先经过严格的验证程序。\n\n### 第1步：提取已知条件\n- 状态变量：血浆葡萄糖浓度偏差 $g(t)$，胰岛素作用状态 $x(t)$，以及血浆胰岛素浓度偏差 $i(t)$。\n- 控制输入：外部胰岛素输注率 $u(t)$。\n- 扰动：有界外源性输入 $d(t)$。\n- 完整的三状态线性化模型：\n  $$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) + d(t) $$\n  $$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + p_3\\, i(t) $$\n  $$ \\frac{di(t)}{dt} = -n\\, i(t) + u(t) $$\n- 模型参数：葡萄糖有效性 $S_G > 0$，胰岛素作用衰减率 $p_2 > 0$，胰岛素作用增益 $p_3 > 0$，胰岛素清除率 $n > 0$。\n- 控制律：比例控制 $u(t) = -K\\, g(t)$，增益为 $K > 0$。\n- 模型简化假设：胰岛素动力学的准稳态，$\\frac{di(t)}{dt} \\approx 0$，这意味着 $i(t) \\approx \\frac{1}{n}\\, u(t)$。\n- 简化的二状态闭环系统动力学（在无扰动，$d(t)=0$ 的情况下）：\n  $$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) $$\n  $$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t) $$\n  $$ u(t) = -K\\, g(t) $$\n- 任务：\n  1. 为2状态系统推导闭环特征多项式，并找到保证渐近稳定的 $K$ 的条件。\n  2. 定义并求出最大稳定比例增益 $K_{\\text{max}}$，用 $S_G$、$p_2$、$p_3$ 和 $n$ 表示。\n  3. 计算归一化灵敏度指数 $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$。\n\n### 第2步：使用提取的已知条件进行验证\n这个问题有科学依据。所提出的模型是 Bergman 最小模型的一个标准线性化，该模型是葡萄糖-胰岛素动力学建模的基石。在控制工程中，使用比例控制器和准稳态假设是系统分析和设计的常用有效技术。这个问题是适定的；它要求对一个线性时不变（LTI）系统进行稳定性条件和灵敏度分析，这些是具有唯一解的标准、可形式化的任务。陈述是客观的，并使用了精确的术语。所有必要的参数和方程都已提供，并且约束条件（例如 $S_G > 0$）在物理上是一致的。该问题没有指定的使其无效的缺陷。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n目标是分析所提供的2状态系统的稳定性。首先，我们将闭环系统动力学表示为状态空间形式。为了进行稳定性分析，将扰动设为零，$d(t)=0$。\n\n简化后的系统由下式给出：\n$$ \\frac{dg(t)}{dt} = -S_G\\, g(t) - x(t) $$\n$$ \\frac{dx(t)}{dt} = -p_2\\, x(t) + \\frac{p_3}{n}\\, u(t) $$\n将比例控制律 $u(t) = -K\\, g(t)$ 代入第二个方程得到：\n$$ \\frac{dx(t)}{dt} = -p_2\\, x(t) - \\frac{p_3 K}{n}\\, g(t) $$\n我们可以将系统写成标准的状态空间形式 $\\dot{\\mathbf{z}}(t) = A\\, \\mathbf{z}(t)$，其中状态向量为 $\\mathbf{z}(t) = \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix}$。\n$$ \\frac{d}{dt} \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix} = \\begin{pmatrix} -S_G & -1 \\\\ -\\frac{p_3 K}{n} & -p_2 \\end{pmatrix} \\begin{pmatrix} g(t) \\\\ x(t) \\end{pmatrix} $$\n矩阵 $A$ 代表闭环系统动力学：\n$$ A = \\begin{pmatrix} -S_G & -1 \\\\ -\\frac{p_3 K}{n} & -p_2 \\end{pmatrix} $$\n\n**任务1：特征多项式和稳定性条件**\n\n这个LTI系统的稳定性由矩阵 $A$ 的特征值决定，特征值是特征多项式 $P(\\lambda) = \\det(\\lambda I - A) = 0$ 的根。\n$$ \\lambda I - A = \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{pmatrix} - \\begin{pmatrix} -S_G & -1 \\\\ -\\frac{p_3 K}{n} & -p_2 \\end{pmatrix} = \\begin{pmatrix} \\lambda + S_G & 1 \\\\ \\frac{p_3 K}{n} & \\lambda + p_2 \\end{pmatrix} $$\n特征多项式为：\n$$ P(\\lambda) = \\det(\\lambda I - A) = (\\lambda + S_G)(\\lambda + p_2) - (1) \\left(\\frac{p_3 K}{n}\\right) $$\n$$ P(\\lambda) = \\lambda^2 + (S_G + p_2)\\lambda + S_G p_2 - \\frac{p_3 K}{n} $$\n对于一个连续时间系统，要使其渐近稳定，其特征多项式的所有根的实部都必须为负。对于二阶多项式 $\\lambda^2 + a_1 \\lambda + a_0 = 0$，Routh-Hurwitz 稳定性判据要求所有系数都为正。\n1. $\\lambda^2$ 的系数是 $1$，为正。\n2. $\\lambda$ 的系数，$a_1 = S_G + p_2$，必须为正。鉴于 $S_G > 0$ 和 $p_2 > 0$，此条件总是满足的。\n3. 常数项，$a_0 = S_G p_2 - \\frac{p_3 K}{n}$，必须为正。\n$$ S_G p_2 - \\frac{p_3 K}{n} > 0 $$\n这个不等式给出了增益 $K$ 的条件。整理关于 $K$ 的不等式：\n$$ S_G p_2 > \\frac{p_3 K}{n} $$\n$$ K  \\frac{n S_G p_2}{p_3} $$\n由于问题指定 $K  0$，渐近稳定的条件是 $0  K  \\frac{n S_G p_2}{p_3}$。\n\n**任务2：最大稳定增益 $K_{\\text{max}}$**\n\n最大稳定比例增益 $K_{\\text{max}}$ 是使系统渐近稳定的所有增益 $K$ 的集合的上确界。这对应于稳定性边界，在该边界上特征多项式的常数项变为零。\n根据稳定性条件 $K  \\frac{n S_G p_2}{p_3}$，最大值是这个区间的上界。\n$$ K_{\\text{max}} = \\frac{n S_G p_2}{p_3} $$\n\n**任务3：$K_{\\text{max}}$ 的归一化灵敏度**\n\n我们被要求计算 $K_{\\text{max}}$ 关于参数 $p_3$ 的归一化灵敏度，定义为 $S_{p_3}(K_{\\text{max}}) = \\frac{\\partial \\ln K_{\\text{max}}}{\\partial \\ln p_3}$。这个对数导数用以量化 $p_3$ 的百分比变化所引起的 $K_{\\text{max}}$ 的百分比变化。\n\n首先，我们使用前一个任务中推导出的表达式来表示 $\\ln K_{\\text{max}}$：\n$$ K_{\\text{max}} = \\frac{n S_G p_2}{p_3} $$\n对两边取自然对数：\n$$ \\ln K_{\\text{max}} = \\ln \\left( \\frac{n S_G p_2}{p_3} \\right) $$\n使用对数的性质：\n$$ \\ln K_{\\text{max}} = \\ln(n S_G p_2) - \\ln(p_3) $$\n灵敏度指数是 $\\ln K_{\\text{max}}$ 关于 $\\ln p_3$ 的偏导数。我们定义一个变量 $z = \\ln p_3$。那么我们需要计算 $\\frac{\\partial}{\\partial z} (\\ln K_{\\text{max}})$。\n$$ \\frac{\\partial}{\\partial (\\ln p_3)} (\\ln K_{\\text{max}}) = \\frac{\\partial}{\\partial (\\ln p_3)} (\\ln(n S_G p_2) - \\ln(p_3)) $$\n项 $\\ln(n S_G p_2)$ 相对于 $p_3$ 是一个常数，所以它的导数是零。根据定义，$\\ln(p_3)$ 关于 $\\ln(p_3)$ 的导数是 $1$。\n$$ S_{p_3}(K_{\\text{max}}) = 0 - 1 = -1 $$\n灵敏度指数是一个常数值 $-1$。这表明胰岛素作用增益 $p_3$ 增加 $1\\%$ 会导致最大稳定控制增益 $K_{\\text{max}}$ 减少 $1\\%$。这种反比关系是符合预期的，因为较高的 $p_3$ 意味着胰岛素对葡萄糖的作用更强，因此需要较小的控制器增益来避免过度校正和不稳定性。\n最终结果是一个无量纲的实数。",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "智能电网等大规模信息物理系统依赖于从众多传感器收集的数据来实现态势感知和控制，但这些数据可能遭受恶意攻击。本练习旨在解决虚假数据注入（FDI）攻击下的安全状态估计问题，要求您推导一种稳健的估计算法。通过结合最大后验（MAP）估计和稀疏性先验，您将学习如何设计能够识别和抵御恶意数据操纵的CPS，并设定合理的警报阈值。",
            "id": "4205524",
            "problem": "智能电网中的一个用于广域监测与控制的信息物理系统（CPS）（例如，监控与数据采集（SCADA）状态估计）使用一个线性化的测量模型，该模型可能存在虚假数据注入（FDI）。测量向量建模为 $$\\mathbf{y} \\in \\mathbb{R}^{m},$$ 未知状态为 $$\\mathbf{x}^{\\star} \\in \\mathbb{R}^{n},$$ 已知测量矩阵为 $$\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$$（满列秩），对抗性攻击向量为 $$\\mathbf{a} \\in \\mathbb{R}^{m}$$（在规范基中是稀疏的），以及零均值高斯传感器噪声 $$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I}_{m}).$$ 模型为 $$\\mathbf{y}=\\mathbf{H}\\mathbf{x}^{\\star}+\\mathbf{a}+\\mathbf{w}.$$ 假设噪声分量独立。目标是仅使用以下基本依据，从第一性原理推导一种安全的状态估计算法和一个检测阈值：(i) 加性白噪声的高斯似然，(ii) 攻击向量稀疏性的拉普拉斯先验（独立同分布的坐标），以及 (iii) 凸优化和概率不等式的标准性质。\n\n任务：\n1. 使用形式为 $$p(\\mathbf{a}) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right)$$ 的拉普拉斯先验进行最大后验（MAP）估计，并将 $$\\mathbf{x}^{\\star}$$ 视为具有无信息先验的未知确定性参数，明确推导出联合 MAP 估计器所求解的、关于未知数 $$\\mathbf{x},\\mathbf{a}$$ 的优化程序。\n2. 在附加结构性假设 $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$ 下，推导对于固定 $$\\mathbf{x}$$ 的 $$\\mathbf{a}$$ 的闭式最小化器，以及对于固定 $$\\mathbf{a}$$ 的 $$\\mathbf{x}$$ 的闭式最小化器。清晰地指出出现的任何阈值化或投影操作及其以 $$\\beta$$ 和 $$\\sigma$$ 表示的参数。\n3. 考虑一个基于残差的检测器，在估计出 $$\\widehat{\\mathbf{x}}$$ 和 $$\\widehat{\\mathbf{a}}$$ 后，如果新息 $$\\mathbf{r}:=\\mathbf{y}-\\mathbf{H}\\widehat{\\mathbf{x}}$$ 的任何坐标的幅值超过一个阈值，则发出警报。在无攻击假设 $$\\mathbf{a}=\\mathbf{0}$$ 和理想建模（因此 $$\\mathbf{r}$$ 主要由传感器噪声主导）下，仅使用 $$w_{i}$$ 的独立性和高斯随机变量的标准指数尾部界，从第一性原理推导一个保守的族群伪警报阈值 $$\\tau$$，保证 $$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$$。用 $$\\sigma,$$ $$m,$$ 和 $$\\alpha$$ 的闭式形式表示 $$\\tau$$。\n4. 对于 $$m=50,$$ $$\\sigma=0.2,$$ 和 $$\\alpha=0.01,$$ 计算任务 $$3$$ 中得到的检测阈值 $$\\tau$$ 的数值。\n\n将 $$\\tau$$ 的数值作为你的最终答案。将答案四舍五入到四位有效数字。将最终阈值表示为一个无单位量。",
            "solution": "首先验证问题，以确保其具有科学依据、良定性及客观性。\n\n### 第1步：提取已知条件\n- 测量模型：$$\\mathbf{y}=\\mathbf{H}\\mathbf{x}^{\\star}+\\mathbf{a}+\\mathbf{w}$$\n- 测量向量：$$\\mathbf{y} \\in \\mathbb{R}^{m}$$\n- 未知状态：$$\\mathbf{x}^{\\star} \\in \\mathbb{R}^{n}$$\n- 测量矩阵：$$\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$$，满列秩。\n- 对抗性攻击向量：$$\\mathbf{a} \\in \\mathbb{R}^{m}$$，在规范基中是稀疏的。\n- 传感器噪声：$$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I}_{m})$$，各分量 $$w_i$$ 独立。\n- $$\\mathbf{a}$$ 的先验：$$p(\\mathbf{a}) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right)$$\n- $$\\mathbf{x}^{\\star}$$ 的先验：无信息（均匀）。\n- 任务2的附加假设：$$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$\n- 任务3的检测器属性：如果 $$\\max_{1\\leq i\\leq m}|r_{i}|  \\tau$$ 则发出警报，其中 $$\\mathbf{r}:=\\mathbf{y}-\\mathbf{H}\\widehat{\\mathbf{x}}$$。\n- 任务3中阈值推导的条件：在无攻击假设 $$\\mathbf{a}=\\mathbf{0}$$ 下，找到 $$\\tau$$ 以保证 $$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$$。\n- 任务4的数值：$$m=50$$，$$\\sigma=0.2$$，$$\\alpha=0.01$$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了信号处理和控制系统中的一个标准鲁棒估计问题（具体来说，是存在稀疏攻击情况下的状态估计）。所提出的方法（使用拉普拉斯先验的 MAP 估计）是一种成熟的技术，可引出 $$\\ell_1$$-范数正则化 (Lasso)。各项任务是良定的，每一项都在前一项的基础上逻辑地构建。诸如任务 $2$ 中的 $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$ 等假设是理论分析中的标准简化假设。任务 $3$ 中要求的推导依赖于基本的概率工具（并集界、高斯尾部界），是在控制伪警报的同时设置检测阈值的标准方法。该问题客观地陈述了所有必要的数据。\n\n### 第3步：结论与行动\n问题被认为是有效的。下面提供完整解答。\n\n### 任务1：MAP 优化程序的推导\n目标是在给定测量 $$\\mathbf{y}$$ 的条件下，找到未知参数 $$\\mathbf{x}$$ 和 $$\\mathbf{a}$$ 的最大后验（MAP）估计。后验概率密度函数由贝叶斯定理给出：\n$$p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) \\propto p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a}) p(\\mathbf{x}, \\mathbf{a})$$\n假设 $$\\mathbf{x}$$ 和 $$\\mathbf{a}$$ 的先验分布是独立的，因此 $$p(\\mathbf{x}, \\mathbf{a}) = p(\\mathbf{x})p(\\mathbf{a})$$。给定 $$\\mathbf{x}$$ 具有无信息（均匀）先验，这意味着 $$p(\\mathbf{x})$$ 是一个常数。$$\\mathbf{a}$$ 的先验是拉普拉斯分布：\n$$p(\\mathbf{a}) \\propto \\exp\\left(-\\beta \\sum_{i=1}^{m}|a_{i}|\\right) = \\exp(-\\beta \\|\\mathbf{a}\\|_{1})$$\n似然函数 $$p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a})$$ 由噪声模型决定。从系统模型可知，噪声向量为 $$\\mathbf{w} = \\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}$$。由于 $$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2\\mathbf{I}_m)$$，其概率密度函数为：\n$$p(\\mathbf{w}) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{\\|\\mathbf{w}\\|_{2}^2}{2\\sigma^2}\\right)$$\n代入 $$\\mathbf{w}$$，似然函数为：\n$$p(\\mathbf{y} | \\mathbf{x}, \\mathbf{a}) = \\frac{1}{(2\\pi\\sigma^2)^{m/2}} \\exp\\left(-\\frac{\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2}{2\\sigma^2}\\right)$$\n结合似然函数和先验，后验概率为：\n$$p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) \\propto \\exp\\left(-\\frac{\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2}{2\\sigma^2}\\right) \\exp(-\\beta \\|\\mathbf{a}\\|_{1})$$\n最大化后验概率等价于最小化其负对数：\n$$\\hat{\\mathbf{x}}, \\hat{\\mathbf{a}} = \\arg\\max_{\\mathbf{x}, \\mathbf{a}} p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y}) = \\arg\\min_{\\mathbf{x}, \\mathbf{a}} \\left[ -\\ln(p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y})) \\right]$$\n负对数后验为：\n$$-\\ln(p(\\mathbf{x}, \\mathbf{a} | \\mathbf{y})) = C + \\frac{1}{2\\sigma^2}\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\beta\\|\\mathbf{a}\\|_{1}$$\n其中 $$C$$ 是一个不依赖于 $$\\mathbf{x}$$ 或 $$\\mathbf{a}$$ 的常数。因此，MAP 估计问题就是求解以下优化程序：\n$$\\min_{\\mathbf{x}, \\mathbf{a}} \\left\\{ \\frac{1}{2\\sigma^2}\\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\beta\\|\\mathbf{a}\\|_{1} \\right\\}$$\n这可以通过将目标函数乘以正常数 $2\\sigma^2$ 来重写，这不会改变最小值的位置：\n$$\\min_{\\mathbf{x} \\in \\mathbb{R}^n, \\mathbf{a} \\in \\mathbb{R}^m} \\left\\{ \\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + 2\\sigma^2\\beta\\|\\mathbf{a}\\|_{1} \\right\\}$$\n\n### 任务2：闭式最小化器的推导\n在附加假设 $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$ 下，我们可以通过交替最小化的方法推导出 $$\\mathbf{x}$$ 和 $$\\mathbf{a}$$ 的闭式解。\n目标函数为 $J(\\mathbf{x}, \\mathbf{a}) = \\|\\mathbf{y} - \\mathbf{H}\\mathbf{x} - \\mathbf{a}\\|_{2}^2 + \\lambda\\|\\mathbf{a}\\|_{1}$，其中 $\\lambda = 2\\sigma^2\\beta$。\n\n**对于固定的 $$\\mathbf{a}$$，关于 $$\\mathbf{x}$$ 的最小化**：\n我们固定 $$\\mathbf{a}$$ 并求解 $$\\mathbf{x}$$。问题简化为一个标准的线性最小二乘问题：\n$$\\min_{\\mathbf{x}} \\|\\mathbf{z} - \\mathbf{H}\\mathbf{x}\\|_{2}^2 \\quad \\text{其中 } \\mathbf{z} = \\mathbf{y} - \\mathbf{a}$$\n为了找到最小化器，我们将关于 $$\\mathbf{x}$$ 的梯度设为零：\n$$\\nabla_{\\mathbf{x}} J(\\mathbf{x}, \\mathbf{a}) = \\nabla_{\\mathbf{x}} \\left( (\\mathbf{z} - \\mathbf{H}\\mathbf{x})^{\\top}(\\mathbf{z} - \\mathbf{H}\\mathbf{x}) \\right) = -2\\mathbf{H}^{\\top}(\\mathbf{z} - \\mathbf{H}\\mathbf{x}) = \\mathbf{0}$$\n$$\\mathbf{H}^{\\top}\\mathbf{H}\\mathbf{x} = \\mathbf{H}^{\\top}\\mathbf{z}$$\n使用假设 $$\\mathbf{H}^{\\top}\\mathbf{H}=\\mathbf{I}_{n}$$，$$\\mathbf{x}$$ 的解为：\n$$\\widehat{\\mathbf{x}} = \\mathbf{H}^{\\top}\\mathbf{z} = \\mathbf{H}^{\\top}(\\mathbf{y} - \\mathbf{a})$$\n这个操作表示将向量 $\\mathbf{y}-\\mathbf{a}$ 投影到由 $\\mathbf{H}$ 的正交归一列所张成的子空间上。\n\n**对于固定的 $$\\mathbf{x}$$，关于 $$\\mathbf{a}$$ 的最小化**：\n我们固定 $$\\mathbf{x}$$ 并求解 $$\\mathbf{a}$$。问题变为：\n$$\\min_{\\mathbf{a}} \\|\\mathbf{r} - \\mathbf{a}\\|_{2}^2 + \\lambda\\|\\mathbf{a}\\|_{1} \\quad \\text{其中 } \\mathbf{r} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}$$\n这个问题是可分的，意味着可以对每个分量 $a_i$ 独立求解：\n$$\\sum_{i=1}^{m} \\min_{a_i} \\left\\{ (r_i - a_i)^2 + \\lambda|a_i| \\right\\}$$\n我们求解标量问题 $ \\min_{u} (v - u)^2 + \\lambda|u| $。解由软阈值算子 $S_{\\lambda/2}(v)$ 给出。我们使用次梯度微积分从第一性原理推导这个结果。目标函数关于 $u$ 的次梯度是：\n$$\\partial_{u} \\left( (v-u)^2 + \\lambda|u| \\right) = -2(v-u) + \\lambda \\cdot \\partial|u|$$\n其中，如果 $u \\neq 0$，$\\partial|u| = \\text{sgn}(u)$；如果 $u=0$，$\\partial|u| \\in [-1, 1]$。\n令次梯度包含零：$2(u-v) + \\lambda s = 0$，对于某个 $s \\in \\partial|u|$。\n- 如果 $u > 0$, $s=1$: $2(u-v)+\\lambda=0 \\implies u = v - \\lambda/2$。 这在 $v - \\lambda/2 > 0$，即 $v > \\lambda/2$ 时有效。\n- 如果 $u  0$, $s=-1$: $2(u-v)-\\lambda=0 \\implies u = v + \\lambda/2$。 这在 $v + \\lambda/2  0$，即 $v  -\\lambda/2$ 时有效。\n- 如果 $u = 0$, $s\\in[-1, 1]$: $-2v + \\lambda s = 0 \\implies 2v = \\lambda s$。 这意味着 $|2v| \\le \\lambda$，或 $|v| \\le \\lambda/2$。\n结合这些情况，得到软阈值函数：\n$$u = S_{\\lambda/2}(v) = \\text{sgn}(v) \\max(|v| - \\lambda/2, 0)$$\n将此应用于我们的向量问题，最小化器 $\\widehat{\\mathbf{a}}$ 是：\n$$\\widehat{\\mathbf{a}} = S_{\\lambda/2}(\\mathbf{y} - \\mathbf{H}\\mathbf{x})$$\n阈值化参数是 $\\lambda/2 = (2\\sigma^2\\beta)/2 = \\sigma^2\\beta$。\n所以，最小化器是 $\\widehat{\\mathbf{a}} = S_{\\sigma^2\\beta}(\\mathbf{y} - \\mathbf{H}\\mathbf{x})$，这是一个阈值为 $\\sigma^2\\beta$ 的软阈值化操作。\n\n### 任务3：检测阈值 $$\\tau$$ 的推导\n目标是找到一个阈值 $$\\tau$$，保证族群伪警报率最多为 $$\\alpha$$。这表述为找到 $$\\tau$$ 使得 $$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right)\\leq \\alpha$$。噪声分量 $$w_i$$ 是独立同分布的，服从 $$\\mathcal{N}(0, \\sigma^2)$$。\n令 $$E_i$$ 为事件 $$|w_i|  \\tau$$。我们关心这些事件的并集的概率，$$\\mathbb{P}(\\cup_{i=1}^m E_i)$$。\n使用并集界（布尔不等式），我们可以写出：\n$$\\mathbb{P}\\!\\left(\\max_{1\\leq i\\leq m}|w_{i}|\\tau\\right) = \\mathbb{P}(\\cup_{i=1}^m E_i) \\leq \\sum_{i=1}^m \\mathbb{P}(E_i)$$\n由于 $$w_i$$ 是同分布的，对于所有 $$i$$，$$\\mathbb{P}(E_i) = \\mathbb{P}(|w_1|  \\tau)$$。因此：\n$$\\sum_{i=1}^m \\mathbb{P}(E_i) = m \\cdot \\mathbb{P}(|w_1|  \\tau)$$\n为了满足总体约束，我们需要 $$m \\cdot \\mathbb{P}(|w_1|  \\tau) \\le \\alpha$$，这可以简化为：\n$$\\mathbb{P}(|w_1|  \\tau) \\le \\frac{\\alpha}{m}$$\n概率 $$\\mathbb{P}(|w_1|  \\tau) = \\mathbb{P}(w_1  \\tau) + \\mathbb{P}(w_1  -\\tau)$$。根据零均值高斯分布的对称性，$$\\mathbb{P}(w_1  -\\tau) = \\mathbb{P}(w_1  \\tau)$$。\n所以，$$2 \\cdot \\mathbb{P}(w_1  \\tau) \\le \\frac{\\alpha}{m} \\implies \\mathbb{P}(w_1  \\tau) \\le \\frac{\\alpha}{2m}$$\n我们现在使用高斯随机变量 $$X \\sim \\mathcal{N}(0, \\sigma_X^2)$$ 的标准指数尾部界，即对于 $$t0$$，$$\\mathbb{P}(X  t) \\le \\exp(-t^2 / (2\\sigma_X^2))$$。对于 $$w_1 \\sim \\mathcal{N}(0, \\sigma^2)$$，这变为：\n$$\\mathbb{P}(w_1  \\tau) \\le \\exp\\left(-\\frac{\\tau^2}{2\\sigma^2}\\right)$$\n为了满足不等式 $$\\mathbb{P}(w_1  \\tau) \\le \\alpha/(2m)$$，我们可以将界设为期望的上限：\n$$\\exp\\left(-\\frac{\\tau^2}{2\\sigma^2}\\right) = \\frac{\\alpha}{2m}$$\n求解 $$\\tau$$：\n$$-\\frac{\\tau^2}{2\\sigma^2} = \\ln\\left(\\frac{\\alpha}{2m}\\right)$$\n$$\\frac{\\tau^2}{2\\sigma^2} = -\\ln\\left(\\frac{\\alpha}{2m}\\right) = \\ln\\left(\\left(\\frac{\\alpha}{2m}\\right)^{-1}\\right) = \\ln\\left(\\frac{2m}{\\alpha}\\right)$$\n$$\\tau^2 = 2\\sigma^2 \\ln\\left(\\frac{2m}{\\alpha}\\right)$$\n$$\\tau = \\sqrt{2\\sigma^2 \\ln\\left(\\frac{2m}{\\alpha}\\right)} = \\sigma \\sqrt{2 \\ln\\left(\\frac{2m}{\\alpha}\\right)}$$\n这提供了保守阈值 $$\\tau$$ 的一个关于 $$\\sigma$$、$$m$$ 和 $$\\alpha$$ 的闭式表达式。\n\n### 任务4：$$\\tau$$ 的数值计算\n给定值 $$m=50$$，$$\\sigma=0.2$$ 和 $$\\alpha=0.01$$，我们使用推导出的公式计算 $$\\tau$$：\n$$\\tau = \\sigma \\sqrt{2 \\ln\\left(\\frac{2m}{\\alpha}\\right)}$$\n首先，计算对数内的项：\n$$\\frac{2m}{\\alpha} = \\frac{2 \\times 50}{0.01} = \\frac{100}{0.01} = 10000$$\n现在，将此代入 $$\\tau$$ 的公式：\n$$\\tau = 0.2 \\sqrt{2 \\ln(10000)}$$\n使用自然对数：\n$$\\ln(10000) \\approx 9.21034037$$\n$$2 \\ln(10000) \\approx 18.42068074$$\n$$\\sqrt{2 \\ln(10000)} \\approx \\sqrt{18.42068074} \\approx 4.29193182$$\n最后，乘以 $$\\sigma$$：\n$$\\tau = 0.2 \\times 4.29193182 \\approx 0.85838636$$\n将结果四舍五入到四位有效数字，得到：\n$$\\tau \\approx 0.8584$$",
            "answer": "$$\\boxed{0.8584}$$"
        }
    ]
}