{
    "hands_on_practices": [
        {
            "introduction": "A digital twin's fidelity begins with the quality of its input signals. This first practice focuses on the critical, yet often overlooked, analog interface between a sensor and its amplifier. By modeling the sensor and amplifier with non-ideal impedances, you will explore the concept of \"loading error\" using a voltage divider model . This exercise is fundamental to understanding why high-impedance sensors require specialized buffer amplifiers and how to quantify the signal degradation that occurs at the very first stage of the measurement chain.",
            "id": "4245315",
            "problem": "A Digital Twin (DT) of a Cyber-Physical System (CPS) must faithfully simulate sensor-to-actuator signal pathways, including the interaction between a sensor’s source impedance and the front-end amplifier’s input impedance. Assume a sensor is modeled by a Thevenin voltage source with phasor amplitude $V_{s}(\\omega)$ in series with a frequency-dependent source impedance $Z_{s}(\\omega)$, and the amplifier is modeled by a finite input impedance $Z_{\\text{in}}(\\omega)$. The amplifier is intended to function as a buffer, but its input impedance is not infinite. Using foundational circuit laws, the DT needs to quantify loading error.\n\nTasks:\n1. Define impedance matching in the context of linear time-invariant circuits and explain, from first principles, why high source impedance sensors require buffering to minimize loading.\n2. For a sensor characterized by a series combination of a resistance $R_{s}$ and a capacitance $C_{s}$, and an amplifier input modeled as a parallel combination of a resistance $R_{\\text{in}}$ and a capacitance $C_{\\text{in}}$, derive a closed-form expression for the loading error magnitude at angular frequency $\\omega$, defined as $\\varepsilon(\\omega) = \\left|1 - \\frac{V_{\\text{in}}(\\omega)}{V_{s}(\\omega)}\\right|$, where $V_{\\text{in}}(\\omega)$ is the amplifier input voltage phasor.\n3. Evaluate $\\varepsilon(\\omega)$ numerically for the following parameters representative of a high-impedance sensor readout:\n- Sensor series resistance $R_{s} = 5.0 \\times 10^{6}\\ \\Omega$.\n- Sensor series capacitance $C_{s} = 100 \\times 10^{-12}\\ \\text{F}$.\n- Amplifier input resistance $R_{\\text{in}} = 100 \\times 10^{6}\\ \\Omega$.\n- Amplifier input capacitance $C_{\\textin} = 10 \\times 10^{-12}\\ \\text{F}$.\n- Frequency $f = 10\\ \\text{Hz}$, with $\\omega = 2\\pi f$.\nExpress the final loading error magnitude as a unitless decimal and round your answer to three significant figures.",
            "solution": "**1. Impedance Matching and Buffering**\n\nIn the context of signal transmission for sensing applications, the goal is maximum voltage transfer, not maximum power transfer. To achieve this, the voltage measured by an amplifier should be as close as possible to the sensor's source voltage.\n\nA sensor can be modeled as a Thevenin equivalent circuit: an ideal voltage source $V_s(\\omega)$ in series with a source impedance $Z_s(\\omega)$. When connected to an amplifier with input impedance $Z_{\\text{in}}(\\omega)$, they form a voltage divider. The voltage at the amplifier's input, $V_{\\text{in}}(\\omega)$, is:\n$$\nV_{\\text{in}}(\\omega) = V_{s}(\\omega) \\frac{Z_{\\text{in}}(\\omega)}{Z_{s}(\\omega) + Z_{\\text{in}}(\\omega)}\n$$\nThe ratio $\\frac{V_{\\text{in}}(\\omega)}{V_{s}(\\omega)}$ should be as close to 1 as possible. This is achieved when $|Z_{\\text{in}}(\\omega)| \\gg |Z_{s}(\\omega)|$. If the input impedance is not significantly larger than the source impedance, the sensor's signal is attenuated, a phenomenon known as \"loading.\"\n\nHigh source impedance sensors, by definition, have a large $|Z_s(\\omega)|$. Connecting them to a low or moderate impedance input would cause significant loading error. A buffer amplifier is designed with a very high input impedance (often G$\\Omega$ or T$\\Omega$) to draw negligible current from the sensor, thus ensuring $|Z_{\\text{in}}(\\omega)| \\gg |Z_s(\\omega)|$ and $V_{\\text{in}}(\\omega) \\approx V_s(\\omega)$.\n\n**2. Derivation of Loading Error Expression**\n\nThe loading error is defined as $\\varepsilon(\\omega) = \\left|1 - \\frac{V_{\\text{in}}(\\omega)}{V_{s}(\\omega)}\\right|$. Substituting the voltage divider expression:\n$$\n\\varepsilon(\\omega) = \\left|1 - \\frac{Z_{\\text{in}}(\\omega)}{Z_{s}(\\omega) + Z_{\\text{in}}(\\omega)}\\right| = \\left|\\frac{(Z_{s}(\\omega) + Z_{\\text{in}}(\\omega)) - Z_{\\text{in}}(\\omega)}{Z_{s}(\\omega) + Z_{\\text{in}}(\\omega)}\\right| = \\left|\\frac{Z_{s}(\\omega)}{Z_{s}(\\omega) + Z_{\\text{in}}(\\omega)}\\right|\n$$\nThe sensor impedance $Z_s(\\omega)$ is a series combination of $R_s$ and $C_s$:\n$$\nZ_s(\\omega) = R_s + \\frac{1}{j\\omega C_s} = R_s - j\\frac{1}{\\omega C_s}\n$$\nThe amplifier input impedance $Z_{\\text{in}}(\\omega)$ is a parallel combination of $R_{\\text{in}}$ and $C_{\\text{in}}$. Its admittance $Y_{\\text{in}}(\\omega)$ is:\n$$\nY_{\\text{in}}(\\omega) = \\frac{1}{Z_{\\text{in}}(\\omega)} = \\frac{1}{R_{\\text{in}}} + j\\omega C_{\\text{in}}\n$$\nSo the input impedance is:\n$$\nZ_{\\text{in}}(\\omega) = \\frac{1}{\\frac{1}{R_{\\text{in}}} + j\\omega C_{\\text{in}}} = \\frac{R_{\\text{in}}}{1 + j\\omega R_{\\text{in}} C_{\\text{in}}}\n$$\nThe sum of impedances is:\n$$\nZ_s(\\omega) + Z_{\\text{in}}(\\omega) = \\left(R_s - j\\frac{1}{\\omega C_s}\\right) + \\left(\\frac{R_{\\text{in}}}{1 + j\\omega R_{\\text{in}} C_{\\text{in}}}\\right)\n$$\nSeparating into real and imaginary parts:\n$$\n\\text{Re}[Z_s + Z_{\\text{in}}] = R_s + \\frac{R_{\\text{in}}}{1 + (\\omega R_{\\text{in}} C_{\\text{in}})^2}\n$$\n$$\n\\text{Im}[Z_s + Z_{\\text{in}}] = -\\frac{1}{\\omega C_s} - \\frac{\\omega R_{\\text{in}}^2 C_{\\text{in}}}{1 + (\\omega R_{\\text{in}} C_{\\text{in}})^2}\n$$\nThe closed-form expression for the loading error magnitude is the ratio of the magnitude of $Z_s(\\omega)$ to the magnitude of the sum $Z_s(\\omega) + Z_{\\text{in}}(\\omega)$:\n$$\n\\varepsilon(\\omega) = \\frac{\\sqrt{R_s^2 + \\left(\\frac{1}{\\omega C_s}\\right)^2}}{\\sqrt{\\left(R_s + \\frac{R_{\\text{in}}}{1 + (\\omega R_{\\text{in}} C_{\\text{in}})^2}\\right)^2 + \\left(-\\frac{1}{\\omega C_s} - \\frac{\\omega R_{\\text{in}}^2 C_{\\text{in}}}{1 + (\\omega R_{\\text{in}} C_{\\text{in}})^2}\\right)^2}}\n$$\n\n**3. Numerical Evaluation**\n\nGiven parameters:\n-   $R_{s} = 5.0 \\times 10^{6}\\ \\Omega$\n-   $C_{s} = 100 \\times 10^{-12}\\ \\text{F}$\n-   $R_{\\text{in}} = 100 \\times 10^{6}\\ \\Omega$\n-   $C_{\\text{in}} = 10 \\times 10^{-12}\\ \\text{F}$\n-   $f = 10\\ \\text{Hz} \\implies \\omega = 2\\pi f = 20\\pi$ rad/s\n\nFirst, calculate the complex impedances $Z_s(\\omega)$ and $Z_{\\text{in}}(\\omega)$.\n\nSensor impedance $Z_s$:\nThe capacitive reactance is $X_s = -\\frac{1}{\\omega C_s} = -\\frac{1}{(20\\pi)(100 \\times 10^{-12})} \\approx -1.59155 \\times 10^8\\ \\Omega$.\n$$\nZ_s = (5.0 \\times 10^6 - j1.59155 \\times 10^8)\\ \\Omega\n$$\n\nAmplifier input impedance $Z_{\\text{in}}$:\nThe term $\\omega R_{\\text{in}} C_{\\text{in}} = (20\\pi)(100 \\times 10^6)(10 \\times 10^{-12}) = 0.02\\pi \\approx 0.062832$.\n$$\nZ_{\\text{in}} = \\frac{100 \\times 10^6}{1 + j0.02\\pi} \\approx \\frac{10^8(1 - j0.062832)}{1 + (0.02\\pi)^2} \\approx (9.96068 \\times 10^7 - j6.25828 \\times 10^6)\\ \\Omega\n$$\n\nNext, sum the impedances $Z_s + Z_{\\text{in}}$:\n$$\n\\text{Re}[Z_s + Z_{\\text{in}}] \\approx (5.0 \\times 10^6) + (9.96068 \\times 10^7) = 1.046068 \\times 10^8\\ \\Omega\n$$\n$$\n\\text{Im}[Z_s + Z_{\\text{in}}] \\approx (-1.59155 \\times 10^8) - (6.25828 \\times 10^6) = -1.654133 \\times 10^8\\ \\Omega\n$$\n\nCalculate the required magnitudes:\n$$\n|Z_s| = \\sqrt{(5.0 \\times 10^6)^2 + (-1.59155 \\times 10^8)^2} \\approx 1.592336 \\times 10^8\\ \\Omega\n$$\n$$\n|Z_s + Z_{\\text{in}}| = \\sqrt{(1.046068 \\times 10^8)^2 + (-1.654133 \\times 10^8)^2} \\approx 1.957147 \\times 10^8\\ \\Omega\n$$\n\nFinally, compute the loading error $\\varepsilon(\\omega)$:\n$$\n\\varepsilon(20\\pi) = \\frac{|Z_s|}{|Z_s + Z_{\\text{in}}|} \\approx \\frac{1.592336 \\times 10^8}{1.957147 \\times 10^8} \\approx 0.81360\n$$\nRounding to three significant figures, the loading error is 0.814. This large error demonstrates the critical need for buffering when reading high-impedance sensors.",
            "answer": "$$\n\\boxed{0.814}\n$$"
        },
        {
            "introduction": "Once a signal is successfully captured by the analog front-end, it must be converted into a digital sequence through sampling. This practice addresses a fundamental and counter-intuitive consequence of this process: aliasing. By analyzing a simple scenario where a high-frequency signal is sampled below the rate dictated by the Nyquist-Shannon theorem, you will calculate the \"phantom\" low-frequency signal that a digital twin would erroneously observe . Mastering this concept is essential for designing anti-aliasing filters and correctly interpreting any spectral data from a sampled system.",
            "id": "4245334",
            "problem": "A Digital Twin of a rotating machine in a Cyber-Physical System (CPS) receives sensor data sampled uniformly in time. Consider an ideal pointwise sampler that samples a continuous-time sinusoidal vibration signal $x(t)$ of the form $x(t) = A \\cos(2 \\pi f t + \\phi)$, where $A$ is a real amplitude, $f$ is the continuous-time frequency, and $\\phi$ is a phase. The sampler operates at sampling frequency $f_{s}$, with sampling period $T_{s} = 1/f_{s}$, producing the discrete-time sequence $x[n] = x(n T_{s})$.\n\nAssume there is no anti-aliasing prefilter in the sensing chain, and the Digital Twin estimates spectral content purely from the sampled sequence. For a vibration at $f = 950\\,\\mathrm{Hz}$ and a sampling frequency $f_{s} = 1000\\,\\mathrm{Hz}$, use first principles of sampling and the periodicity of discrete-time sinusoids to determine the unique baseband frequency in $\\mathrm{Hz}$ that the Digital Twin will observe in the sampled sequence.\n\nExpress your final answer in $\\mathrm{Hz}$. No rounding is required.",
            "solution": "The starting point is the ideal uniform sampling of a continuous-time sinusoid. Given $x(t) = A \\cos(2 \\pi f t + \\phi)$ and sampling period $T_{s} = 1/f_{s}$, the sampled sequence is\n$$\nx[n] = x(n T_{s}) = A \\cos\\!\\big(2 \\pi f \\, n T_{s} + \\phi\\big) = A \\cos\\!\\big(2 \\pi n \\tfrac{f}{f_{s}} + \\phi\\big).\n$$\nDefine the discrete-time angular frequency $\\omega$ (in radians per sample) as\n$$\n\\omega = 2 \\pi \\tfrac{f}{f_{s}}.\n$$\nIt is a fundamental property of discrete-time sinusoids that $\\cos(\\omega n + \\phi)$ is indistinguishable from $\\cos((\\omega - 2 \\pi k) n + \\phi)$ for any integer $k$ due to the $2 \\pi$ periodicity of the complex exponential $\\exp(j\\omega n)$ and the cosine function. Therefore, the effective discrete-time frequency is determined modulo $2 \\pi$.\n\nTo represent the observed frequency in the standard baseband of the discrete-time spectrum, we select the equivalent frequency $\\omega'$ such that\n$$\n\\omega' = \\omega - 2 \\pi k,\n$$\nwith integer $k$ chosen so that $\\omega' \\in [0, \\pi]$ represents the unique baseband frequency magnitude, consistent with the one-sided Nyquist interval. The corresponding continuous-time frequency that the sampled sequence appears to have (the aliased frequency) is\n$$\nf_{\\mathrm{alias}} = \\tfrac{f_{s}}{2 \\pi} |\\omega'| = \\left| \\tfrac{f_{s}}{2 \\pi} \\left(\\omega - 2 \\pi k \\right) \\right| = \\left| f - k f_{s} \\right|.\n$$\nThis expression follows directly from substituting $\\omega = 2 \\pi f/f_{s}$ and using the linear scaling between continuous-time and discrete-time frequencies under sampling.\n\nWe select $k$ to minimize $|f - k f_{s}|$ and ensure the result lies in the baseband $[0, f_{s}/2]$, which corresponds to the unique observable sinusoidal frequency magnitude in the sampled sequence. For $f = 950\\,\\mathrm{Hz}$ and $f_{s} = 1000\\,\\mathrm{Hz}$, we have\n$$\n\\omega = 2 \\pi \\tfrac{950}{1000} = 1.9 \\pi.\n$$\nChoosing $k = 1$ yields\n$$\n\\omega' = \\omega - 2 \\pi k = 1.9 \\pi - 2 \\pi = -0.1 \\pi,\n$$\nwhose magnitude is $|\\omega'| = 0.1 \\pi \\in [0, \\pi]$. Converting back to Hertz,\n$$\nf_{\\mathrm{alias}} = \\tfrac{f_{s}}{2 \\pi} |\\omega'| = \\tfrac{1000}{2 \\pi} \\cdot 0.1 \\pi = 50.\n$$\nEquivalently, using $f_{\\mathrm{alias}} = |f - k f_{s}|$ with $k=1$,\n$$\nf_{\\mathrm{alias}} = |950 - 1 \\cdot 1000| = 50.\n$$\nTherefore, the aliased frequency observed in the sampled sequence is $50\\,\\mathrm{Hz}$.",
            "answer": "$$\\boxed{50}$$"
        },
        {
            "introduction": "The individual components of a cyber-physical system—sensors, processors, and actuators—do not operate in isolation. This final practice elevates our perspective to the system level, examining how physical and computational latencies create an aggregate \"transport delay\" in a closed-loop control system. You will determine the maximum tolerable delay before the system's stability, quantified by its phase margin, is compromised . This exercise bridges the gap between low-level signal chain characteristics and high-level system performance, a cornerstone of robust CPS design.",
            "id": "4245358",
            "problem": "A networked closed-loop cyber-physical system (CPS) is supervised by a high-fidelity Digital Twin (DT). The DT models the sensor and actuator pathways as introducing an aggregate transport delay $T$ seconds into the loop. The nominal open-loop transfer function without delay is\n$$\nL_{0}(s) \\;=\\; K \\,\\frac{1 + \\frac{s}{\\omega_{z}}}{s\\left(1 + \\frac{s}{\\omega_{p1}}\\right)\\left(1 + \\frac{s}{\\omega_{p2}}\\right)},\n$$\nwhere $K0$ is a constant controller gain, $\\omega_{z}$ is a real zero location, and $\\omega_{p1}, \\omega_{p2}$ are real pole locations. In nominal operation without delay, the DT has measured the gain crossover frequency to be $\\omega_{g0} = 10$ rad/s. The parameter values are $\\omega_{z} = 10$ rad/s, $\\omega_{p1} = 5$ rad/s, and $\\omega_{p2} = 30$ rad/s.\n\nWhen the delay is present, the loop transfer function becomes $L(s) = L_{0}(s)\\exp(-sT)$. Using only fundamental definitions for gain crossover and phase margin, determine the maximum allowable aggregate delay $T_{\\max}$ that ensures the phase margin (PM) remains at or above the specified requirement of $0.8$ radians.\n\nYour derivation must start from the definitions of gain crossover and phase margin, and account for the contribution of each factor in $L_{0}(s)$ and the transport delay to the loop’s phase at the nominal gain crossover frequency. Express the final $T_{\\max}$ in seconds, and round your answer to four significant figures. State all angles and intermediate computations in radians; do not use degrees in your working.",
            "solution": "The primary task is to determine the maximum transport delay $T_{\\max}$ that the system can tolerate while maintaining a phase margin (PM) of at least 0.8 radians.\n\nThe open-loop transfer function with delay is $L(s) = L_{0}(s)\\exp(-sT)$. We analyze the system in the frequency domain by setting $s = j\\omega$:\n$$\nL(j\\omega) = L_{0}(j\\omega)\\exp(-j\\omega T)\n$$\nThe gain crossover frequency, $\\omega_g$, is where the magnitude of the open-loop transfer function is unity: $|L(j\\omega_g)| = 1$. The delay term $\\exp(-j\\omega T)$ has a magnitude of 1, so $|L(j\\omega)| = |L_{0}(j\\omega)|$. This means the gain crossover frequency is unaffected by the delay. The problem states the nominal gain crossover frequency is $\\omega_{g0} = 10$ rad/s, so we use $\\omega_g = 10$ rad/s.\n\nThe phase margin (in radians) is defined as:\n$$\n\\text{PM} = \\pi + \\angle L(j\\omega_g)\n$$\nThe phase of the total system $\\angle L(j\\omega_g)$ is the sum of the phase of the nominal system and the phase from the delay:\n$$\n\\angle L(j\\omega_g) = \\angle L_{0}(j\\omega_g) + \\angle \\exp(-j\\omega_g T) = \\angle L_{0}(j\\omega_g) - \\omega_g T\n$$\nThe phase margin is therefore:\n$$\n\\text{PM} = \\pi + \\angle L_{0}(j\\omega_g) - \\omega_g T\n$$\nNext, we calculate the phase of the nominal system, $\\angle L_{0}(j\\omega_g)$, at $\\omega_g = 10$ rad/s. The phase of $L_{0}(j\\omega)$ is the sum of the phases of its factors:\n$$\n\\angle L_{0}(j\\omega_g) = \\angle\\left(1 + j\\frac{\\omega_g}{\\omega_{z}}\\right) - \\angle(j\\omega_g) - \\angle\\left(1 + j\\frac{\\omega_g}{\\omega_{p1}}\\right) - \\angle\\left(1 + j\\frac{\\omega_g}{\\omega_{p2}}\\right)\n$$\nSince $K>0$, its phase is 0. The phase of the integrator term $j\\omega_g$ is $\\pi/2$. For terms of the form $(1+jx)$, the phase is $\\arctan(x)$.\n$$\n\\angle L_{0}(j\\omega_g) = \\arctan\\left(\\frac{\\omega_g}{\\omega_{z}}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{\\omega_g}{\\omega_{p1}}\\right) - \\arctan\\left(\\frac{\\omega_g}{\\omega_{p2}}\\right)\n$$\nSubstituting the numerical values $\\omega_g = 10$ rad/s, $\\omega_z = 10$ rad/s, $\\omega_{p1} = 5$ rad/s, and $\\omega_{p2} = 30$ rad/s:\n$$\n\\angle L_{0}(j10) = \\arctan\\left(\\frac{10}{10}\\right) - \\frac{\\pi}{2} - \\arctan\\left(\\frac{10}{5}\\right) - \\arctan\\left(\\frac{10}{30}\\right)\n$$\n$$\n\\angle L_{0}(j10) = \\arctan(1) - \\frac{\\pi}{2} - \\arctan(2) - \\arctan\\left(\\frac{1}{3}\\right)\n$$\nUsing the values in radians:\n$$\n\\angle L_{0}(j10) \\approx 0.785398 - 1.570796 - 1.107149 - 0.321751 \\approx -2.214298 \\text{ rad}\n$$\nThe problem requires PM $\\ge 0.8$. We find the maximum delay $T_{\\max}$ at the boundary condition PM $= 0.8$:\n$$\n0.8 = \\pi + \\angle L_{0}(j10) - \\omega_g T_{\\max}\n$$\nSolving for $T_{\\max}$:\n$$\nT_{\\max} = \\frac{\\pi + \\angle L_{0}(j10) - 0.8}{\\omega_g}\n$$\nSubstituting the numerical values:\n$$\nT_{\\max} \\approx \\frac{3.141593 - 2.214298 - 0.8}{10} = \\frac{0.127295}{10} = 0.0127295\n$$\nRounding to four significant figures gives:\n$$\nT_{\\max} = 0.01273 \\text{ seconds}\n$$",
            "answer": "$$\n\\boxed{0.01273}\n$$"
        }
    ]
}