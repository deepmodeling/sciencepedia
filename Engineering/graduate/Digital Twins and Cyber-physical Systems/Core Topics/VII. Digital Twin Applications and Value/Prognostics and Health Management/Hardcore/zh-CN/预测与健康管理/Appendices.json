{
    "hands_on_practices": [
        {
            "introduction": "本练习将探讨平均剩余寿命（Mean Residual Life, MRL）的概念，这是预测与健康管理中的一个关键指标。我们将使用能够灵活描述元件失效过程的威布尔分布（Weibull distribution），来分析随着元件老化，其预期剩余寿命如何变化，以及这种变化如何关键地取决于失效机制。通过这个练习，您将掌握应用和解读参数化寿命模型的基础技能 。",
            "id": "4236521",
            "problem": "信息物理系统 (CPS) 中旋转机械部件的数字孪生 (DT) 使用预测与健康管理 (PHM) 来估计参数化寿命模型下的剩余使用寿命 (RUL)。假设该部件的故障时间 $T$ 由形状参数 $k0$ 和尺度参数 $\\lambda0$ 的威布尔分布建模，其概率密度函数 $f(t)$ 和生存函数 $S(t)$ 分别由下式给出\n$$\nf(t) \\;=\\; \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right), \\quad t \\ge 0,\n$$\n$$\nS(t) \\;=\\; \\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right), \\quad t \\ge 0.\n$$\n令 $h(t)$ 表示风险率，定义为 $h(t) = f(t)/S(t)$。在时间 $t$ 的平均剩余寿命 (MRL)，记为 $m(t)$，由条件期望 $m(t) = \\mathbb{E}[\\,T - t \\mid T  t\\,]$ 定义。从条件期望和生存函数的定义出发，推导出一个用 $k$、$\\lambda$ 和 $t$ 表示的 $m(t)$ 的闭式表达式。你可以使用上不完全伽马函数来表示你的最终结果，其定义如下：\n$$\n\\Gamma(\\alpha, x) \\;=\\; \\int_{x}^{\\infty} u^{\\alpha - 1}\\exp(-u)\\,\\mathrm{d}u, \\quad \\alpha0, \\; x \\ge 0.\n$$\n然后，利用风险率 $h(t)$ 和生存函数 $S(t)$ 的基本性质，定性地解释在 $k  1$、$k=1$ 和 $k1$ 的情况下，$m(t)$ 如何随 $t$ 变化。你的最终答案必须是 $m(t)$ 的闭式表达式，且不得包含任何解释。无需进行数值计算。",
            "solution": "该问题要求推导一个故障时间 $T$ 服从威布尔分布的部件的平均剩余寿命 (MRL)，记为 $m(t)$。此外，还要求对 $m(t)$ 的行为进行定性解释。\n\n首先，我们验证问题的陈述。问题为威布尔概率密度函数 $f(t)$、生存函数 $S(t)$、风险率 $h(t)$、平均剩余寿命 $m(t)$ 以及上不完全伽马函数 $\\Gamma(\\alpha, x)$ 提供了标准且正确的定义。其背景是预测与健康管理 (PHM)，这是一个成熟的工程学科，其中威布尔分布是一个基石模型。所有提供的信息都是自洽的、科学上合理的和数学上一致的。该问题是适定的，并要求进行可靠性理论中的标准推导。因此，该问题被认为是有效的。\n\n我们从平均剩余寿命 $m(t)$ 的定义开始推导，它是指在部件已存活到时间 $t$ 的条件下，其剩余寿命 $T - t$ 的条件期望：\n$$\nm(t) = \\mathbb{E}[\\,T - t \\mid T  t\\,]\n$$\n对于一个具有概率密度函数 $f(t)$ 和生存函数 $S(t) = \\mathbb{P}(T  t)$ 的连续随机变量 $T$，该条件期望可以写为：\n$$\nm(t) = \\frac{\\int_{t}^{\\infty} (x-t) f(x)\\,\\mathrm{d}x}{\\mathbb{P}(T  t)} = \\frac{1}{S(t)} \\int_{t}^{\\infty} (x-t) f(x)\\,\\mathrm{d}x\n$$\n通过对积分 $\\int_{t}^{\\infty} (x-t) f(x)\\,\\mathrm{d}x$ 应用分部积分法，可以推导出一个等价且通常更方便的 $m(t)$ 公式。令 $u = x-t$ 和 $\\mathrm{d}v = f(x)\\,\\mathrm{d}x$。那么 $\\mathrm{d}u = \\mathrm{d}x$ 且 $v = \\int f(x)\\,\\mathrm{d}x = -S(x)$。分部积分公式 $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$ 得出：\n$$\n\\int_{t}^{\\infty} (x-t) f(x)\\,\\mathrm{d}x = \\left[-(x-t)S(x)\\right]_{t}^{\\infty} - \\int_{t}^{\\infty} (-S(x))\\,\\mathrm{d}x = \\left[-(x-t)S(x)\\right]_{t}^{\\infty} + \\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x\n$$\n第一项在下限 $x=t$ 处的值为 $0$。在上限处，我们考虑 $\\lim_{x\\to\\infty} (x-t)S(x) = \\lim_{x\\to\\infty} (x-t)\\exp(-(x/\\lambda)^k)$。对于任何 $k0$，指数项趋于零的速度远快于线性项 $(x-t)$ 增长的速度，因此极限为 $0$。于是，积分简化为：\n$$\n\\int_{t}^{\\infty} (x-t) f(x)\\,\\mathrm{d}x = \\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x\n$$\n这就得到了平均剩余寿命的著名恒等式：\n$$\nm(t) = \\frac{1}{S(t)} \\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x\n$$\n现在，我们将威布尔生存函数 $S(x) = \\exp(-(x/\\lambda)^k)$ 代入此积分：\n$$\n\\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x = \\int_{t}^{\\infty} \\exp\\!\\left(-\\left(\\frac{x}{\\lambda}\\right)^{k}\\right)\\,\\mathrm{d}x\n$$\n为了计算这个积分，我们进行变量替换。令 $u = (x/\\lambda)^k$。则 $x = \\lambda u^{1/k}$，微分是 $\\mathrm{d}x = \\lambda \\frac{1}{k} u^{(1/k) - 1} \\,\\mathrm{d}u$。积分限变换如下：当 $x=t$ 时，$u = (t/\\lambda)^k$；当 $x \\to \\infty$ 时，$u \\to \\infty$。将这些代入积分中得到：\n$$\n\\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x = \\int_{(t/\\lambda)^k}^{\\infty} \\exp(-u) \\left(\\frac{\\lambda}{k} u^{(1/k) - 1}\\right) \\,\\mathrm{d}u = \\frac{\\lambda}{k} \\int_{(t/\\lambda)^k}^{\\infty} u^{\\frac{1}{k} - 1} \\exp(-u) \\,\\mathrm{d}u\n$$\n这个积分与上不完全伽马函数 $\\Gamma(\\alpha, z) = \\int_{z}^{\\infty} v^{\\alpha - 1}\\exp(-v)\\,\\mathrm{d}v$ 的定义完全吻合，其中 $\\alpha = 1/k$，下限为 $z = (t/\\lambda)^k$。因此，\n$$\n\\int_{t}^{\\infty} S(x)\\,\\mathrm{d}x = \\frac{\\lambda}{k} \\Gamma\\left(\\frac{1}{k}, \\left(\\frac{t}{\\lambda}\\right)^k\\right)\n$$\n最后，我们将此结果代回到 $m(t)$ 的表达式中：\n$$\nm(t) = \\frac{1}{S(t)} \\left[ \\frac{\\lambda}{k} \\Gamma\\left(\\frac{1}{k}, \\left(\\frac{t}{\\lambda}\\right)^k\\right) \\right]\n$$\n代入 $S(t) = \\exp(-(t/\\lambda)^k)$，我们得到平均剩余寿命的最终闭式表达式：\n$$\nm(t) = \\frac{1}{\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right)} \\frac{\\lambda}{k} \\Gamma\\left(\\frac{1}{k}, \\left(\\frac{t}{\\lambda}\\right)^k\\right) = \\frac{\\lambda}{k} \\exp\\!\\left(\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\Gamma\\left(\\frac{1}{k}, \\left(\\frac{t}{\\lambda}\\right)^k\\right)\n$$\n对于定性解释，我们分析风险率 $h(t) = f(t)/S(t)$ 的行为。对于威布尔分布，它为：\n$$\nh(t) = \\frac{\\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right)}{\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right)} = \\frac{k}{\\lambda^k} t^{k-1}\n$$\nMRL随时间的变化 $m'(t) = \\mathrm{d}m(t)/\\mathrm{d}t$ 与风险率通过一般方程 $m'(t) = h(t)m(t) - 1$ 相关。$m'(t)$ 的符号表示 $m(t)$ 是增加还是减少。\n- 情况 $k  1$：指数 $k-1$ 为负，因此 $h(t)$ 是 $t$ 的递减函数。这被称为递减故障率 (DFR)。它用于模拟“早期失效”现象，即存活过初始阶段的部件被认为更稳健。对于 DFR 分布，一个已知的性质是 $m(t)$ 是 $t$ 的递增函数。随着部件老化，预期剩余寿命会增加。\n- 情况 $k=1$：指数 $k-1$ 为零，因此 $h(t) = 1/\\lambda$ 是一个常数。这就是指数分布，它具有恒定故障率 (CFR) 并且是无记忆的。在这种情况下，$m(t) = \\lambda$，是一个常数。预期剩余寿命与部件的当前年龄无关。\n- 情况 $k1$：指数 $k-1$ 为正，因此 $h(t)$ 是 $t$ 的递增函数。这是一种递增故障率 (IFR)，用于模拟磨损失效现象。对于 IFR 分布，一个已知的性质是 $m(t)$ 是 $t$ 的递减函数。随着部件老化和磨损，预期剩余寿命会减少。",
            "answer": "$$\n\\boxed{\\frac{\\lambda}{k} \\exp\\left(\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\Gamma\\left(\\frac{1}{k}, \\left(\\frac{t}{\\lambda}\\right)^{k}\\right)}\n$$"
        },
        {
            "introduction": "在静态模型的基础上，本练习将深入探讨使用卡尔曼滤波器（Kalman filter）进行动态状态估计。我们将追踪一个随时间退化的假设性系统健康指标，学习如何将带噪声的传感器测量值与预测模型相融合，以获得对系统真实健康状态更精确的估计。这是数字孪生（Digital Twin）进行实时监控的一项核心技术 。",
            "id": "4236615",
            "problem": "一个用于信息物理系统 (CPS) 预测与健康管理 (PHM) 的数字孪生，追踪一个标量健康指标 $x_k$。该指标按随机游走演化，并通过加性噪声直接测量。其离散时间状态空间模型由过程方程 $x_k = A x_{k-1} + w_{k-1}$ 和测量方程 $y_k = C x_k + v_k$ 给出，其中 $w_{k-1} \\sim \\mathcal{N}(0,Q)$ 和 $v_k \\sim \\mathcal{N}(0,R)$ 是独立的零均值高斯噪声。在 $k=0$ 时的先验是均值为 $x_0$、方差为 $P_0$ 的高斯分布。在每一步，数字孪生执行一个单步预测和更新循环，以将测量值同化到其关于 $x_k$ 的置信分布中。\n\n假设为标量情况，其中 $A=\\begin{bmatrix}1\\end{bmatrix}$，$C=\\begin{bmatrix}1\\end{bmatrix}$，$Q=0.01$，$R=0.04$，先验均值 $x_0=0$，先验方差 $P_0=1$，以及两次序贯测量值 $y_1=0.2$ 和 $y_2=0.3$。从线性高斯模型的基本贝叶斯滤波框架出发，在每个时间步精确执行一次预测和一次更新，计算同化 $y_1$ 和 $y_2$ 后的后验状态估计（后验均值），分别记为 $x_1$ 和 $x_2$。\n\n将最终答案表示为精确的有理数，并以单行矩阵 $\\begin{pmatrix}x_1  x_2\\end{pmatrix}$ 的形式给出。无需四舍五入。在此场景中，$x_k$ 没有关联的物理单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它描述了卡尔曼滤波器的一个标准应用，卡尔曼滤波器是线性高斯状态空间模型的最优贝叶斯滤波器。所有必要的参数和条件都已提供，该问题具有科学依据、是适定且客观的。\n\n任务是计算同化两次序贯测量值后的后验状态估计，即后验置信分布的均值。这通过应用卡尔曼滤波器的预测-更新循环两个时间步来实现。该问题使用一个标量状态空间模型。\n\n状态空间模型由以下公式给出：\n过程模型：$x_k = A x_{k-1} + w_{k-1}$，其中 $w_{k-1} \\sim \\mathcal{N}(0, Q)$\n测量模型：$y_k = C x_k + v_k$，其中 $v_k \\sim \\mathcal{N}(0, R)$\n\n状态 $x_k$ 在给定截至时间 $k$ 的所有测量值 $y_{1:k}$ 条件下的后验概率分布，记为 $p(x_k | y_{1:k})$，是一个高斯分布 $\\mathcal{N}(\\hat{x}_{k|k}, P_{k|k})$。我们需要求解后验均值 $\\hat{x}_{1|1}$ 和 $\\hat{x}_{2|2}$，在最终答案中它们将记为 $x_1$ 和 $x_2$。\n\n给定参数为：\n$A = 1$\n$C = 1$\n$Q = 0.01 = \\frac{1}{100}$\n$R = 0.04 = \\frac{4}{100} = \\frac{1}{25}$\n\n在时间 $k=0$ 时的先验分布由其均值和方差给出：\n$\\hat{x}_{0|0} = 0$\n$P_{0|0} = 1$\n\n测量值为：\n$y_1 = 0.2 = \\frac{1}{5}$\n$y_2 = 0.3 = \\frac{3}{10}$\n\n标量系统的卡尔曼滤波器递推公式如下。\n\n**预测步骤：**\n从第 $k-1$ 步的后验预测第 $k$ 步的先验分布。\n预测状态均值：$\\hat{x}_{k|k-1} = A \\hat{x}_{k-1|k-1}$\n预测状态方差：$P_{k|k-1} = A^2 P_{k-1|k-1} + Q$\n\n**更新步骤：**\n使用测量值 $y_k$ 更新预测分布。\n新息（测量残差）：$\\tilde{y}_k = y_k - C \\hat{x}_{k|k-1}$\n新息方差：$S_k = C^2 P_{k|k-1} + R$\n卡尔曼增益：$K_k = \\frac{P_{k|k-1} C}{S_k} = \\frac{P_{k|k-1} C}{C^2 P_{k|k-1} + R}$\n更新后状态均值：$\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + K_k \\tilde{y}_k$\n更新后状态方差：$P_{k|k} = (1 - K_k C) P_{k|k-1}$\n\n现在我们将这些方程应用于 $k=1$ 和 $k=2$。\n\n**时间步 $k=1$**\n\n**预测：**\n使用 $k=0$ 时的先验（$\\hat{x}_{0|0}=0$, $P_{0|0}=1$）：\n$\\hat{x}_{1|0} = A \\hat{x}_{0|0} = 1 \\cdot 0 = 0$\n$P_{1|0} = A^2 P_{0|0} + Q = 1^2 \\cdot 1 + \\frac{1}{100} = 1 + \\frac{1}{100} = \\frac{101}{100}$\n\n**更新：**\n使用测量值 $y_1 = \\frac{1}{5}$：\n新息：$\\tilde{y}_1 = y_1 - C \\hat{x}_{1|0} = \\frac{1}{5} - 1 \\cdot 0 = \\frac{1}{5}$\n新息方差：$S_1 = C^2 P_{1|0} + R = 1^2 \\cdot \\frac{101}{100} + \\frac{1}{25} = \\frac{101}{100} + \\frac{4}{100} = \\frac{105}{100} = \\frac{21}{20}$\n卡尔曼增益：$K_1 = \\frac{P_{1|0} C}{S_1} = \\frac{\\frac{101}{100} \\cdot 1}{\\frac{21}{20}} = \\frac{101}{100} \\cdot \\frac{20}{21} = \\frac{101}{5 \\cdot 21} = \\frac{101}{105}$\n更新后状态均值（$k=1$ 时的后验均值）：\n$\\hat{x}_{1|1} = \\hat{x}_{1|0} + K_1 \\tilde{y}_1 = 0 + \\frac{101}{105} \\cdot \\frac{1}{5} = \\frac{101}{525}$\n\n我们还计算更新后的方差，它将作为下一步的先验：\n更新后状态方差：$P_{1|1} = (1 - K_1 C) P_{1|0} = (1 - \\frac{101}{105} \\cdot 1) \\frac{101}{100} = (\\frac{105 - 101}{105}) \\frac{101}{100} = \\frac{4}{105} \\cdot \\frac{101}{100} = \\frac{101}{105 \\cdot 25} = \\frac{101}{2625}$\n\n同化 $y_1$ 后的后验分布为 $\\mathcal{N}(\\frac{101}{525}, \\frac{101}{2625})$。\n\n**时间步 $k=2$**\n\n**预测：**\n使用 $k=1$ 时的后验（$\\hat{x}_{1|1}=\\frac{101}{525}$, $P_{1|1}=\\frac{101}{2625}$）：\n$\\hat{x}_{2|1} = A \\hat{x}_{1|1} = 1 \\cdot \\frac{101}{525} = \\frac{101}{525}$\n$P_{2|1} = A^2 P_{1|1} + Q = 1^2 \\cdot \\frac{101}{2625} + \\frac{1}{100} = \\frac{101 \\cdot 4}{10500} + \\frac{1 \\cdot 105}{10500} = \\frac{404 + 105}{10500} = \\frac{509}{10500}$\n\n**更新：**\n使用测量值 $y_2 = \\frac{3}{10}$：\n新息：$\\tilde{y}_2 = y_2 - C \\hat{x}_{2|1} = \\frac{3}{10} - 1 \\cdot \\frac{101}{525} = \\frac{3 \\cdot 105}{1050} - \\frac{101 \\cdot 2}{1050} = \\frac{315 - 202}{1050} = \\frac{113}{1050}$\n新息方差：$S_2 = C^2 P_{2|1} + R = 1^2 \\cdot \\frac{509}{10500} + \\frac{1}{25} = \\frac{509}{10500} + \\frac{420}{10500} = \\frac{929}{10500}$\n卡尔曼增益：$K_2 = \\frac{P_{2|1} C}{S_2} = \\frac{\\frac{509}{10500} \\cdot 1}{\\frac{929}{10500}} = \\frac{509}{929}$\n更新后状态均值（$k=2$ 时的后验均值）：\n$\\hat{x}_{2|2} = \\hat{x}_{2|1} + K_2 \\tilde{y}_2 = \\frac{101}{525} + \\frac{509}{929} \\cdot \\frac{113}{1050}$\n为了进行加法运算，我们找到一个公分母：\n$\\hat{x}_{2|2} = \\frac{101 \\cdot 2}{1050} + \\frac{509 \\cdot 113}{929 \\cdot 1050} = \\frac{202}{1050} + \\frac{57517}{975450} = \\frac{202 \\cdot 929 + 57517}{975450} = \\frac{187658 + 57517}{975450} = \\frac{245175}{975450}$\n这个分数可以化简。我们可以用分子和分母的最大公约数来除。\n$\\frac{245175}{975450} = \\frac{25 \\cdot 9807}{25 \\cdot 39018} = \\frac{9807}{39018} = \\frac{3 \\cdot 3269}{3 \\cdot 13006} = \\frac{3269}{13006} = \\frac{7 \\cdot 467}{7 \\cdot 1858} = \\frac{467}{1858}$\n\n后验状态估计为 $x_1 = \\hat{x}_{1|1} = \\frac{101}{525}$ 和 $x_2 = \\hat{x}_{2|2} = \\frac{467}{1858}$。\n最终答案按要求以行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{101}{525}  \\frac{467}{1858}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "预测与健康管理的最后一步是将预测转化为行动。本练习将演示如何通过平衡计划性维护的成本与在役失效的风险和成本，来制定最优的维护策略。通过推导一个简单而强大的决策阈值，您将学习如何利用预测模型输出的剩余使用寿命（RUL）概率分布，来做出经济上合理的管理决策 。",
            "id": "4236673",
            "problem": "一个信息物理系统（Cyber-Physical System, CPS）资产由一个执行预测与健康管理（Prognostics and Health Management, PHM）的数字孪生（Digital Twin）进行监控。该数字孪生维护了一个部件剩余使用寿命（Remaining Useful Life, RUL）$T$ 的后验概率分布，该分布以最新数据 $\\mathcal{D}$ 为条件。在以 $\\Delta t$ 小时为间隔的离散检查时间点，需要做出一个二元决策：是立即执行计划性维护，还是继续运行直到下一次检查。设计划性维护的成本为 $C_m$ 美元，如果在下次检查前发生故障所产生的成本为 $C_f$ 美元。\n\n从期望成本和不确定性下决策（贝叶斯风险最小化）的基本原则出发，推导一个基于阈值的停止规则。该规则仅依赖于在下次检查前发生故障的后验概率，即概率 $\\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$。实施此规则，为每个测试用例决定是立即停止进行维护（决策为真），还是继续运行一个时间间隔（决策为假）。使用指定后验分布的累积分布函数，显式计算后验概率 $\\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$。\n\n后验 $T \\mid \\mathcal{D}$ 被指定为以下两种分布之一：\n- 形状参数为 $k$、尺度参数为 $\\lambda$ 小时的 Weibull 分布；或\n- 参数为 $\\mu$（对数位置）和 $\\sigma$（对数尺度）的对数正态分布（Lognormal distribution），使得 $\\ln T \\sim \\mathcal{N}(\\mu, \\sigma^2)$。\n\n时间量单位必须是小时。成本单位为美元。输出的概率必须是无单位的，并四舍五入到六位小数。对于每个测试用例，您必须输出一个三元列表 $[d, p, \\tau]$，其中：\n- $d$ 是一个布尔值，指示停止（$\\text{True}$）或继续（$\\text{False}$）的决策，\n- $p$ 是计算出的概率 $\\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$，四舍五入到六位小数，\n- $\\tau$ 是从贝叶斯风险最小化推导出的关于 $\\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$ 的决策阈值，四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内无空格。每个元素对应一个测试用例，并且本身是如上所述的三元列表形式（例如，\"[[True,0.123456,0.200000],[False,0.050000,0.250000]]\"）。\n\n使用以下后验分布和决策参数的测试套件：\n- 测试用例 1：后验分布为 Weibull 分布，$k=2.0$，$\\lambda=100.0$ 小时；$\\Delta t=10.0$ 小时；$C_m=2000.0$ 美元；$C_f=10000.0$ 美元。\n- 测试用例 2：后验分布为对数正态分布，$\\mu=3.5$，$\\sigma=0.6$；$\\Delta t=24.0$ 小时；$C_m=500.0$ 美元；$C_f=2000.0$ 美元。\n- 测试用例 3（边界条件）：后验分布为 Weibull 分布，$k=2.0$，$\\lambda=21.18$ 小时；$\\Delta t=10.0$ 小时；$C_m=1000.0$ 美元；$C_f=5000.0$ 美元。\n- 测试用例 4（维护成本高的边缘情况）：后验分布为 Weibull 分布，$k=1.5$，$\\lambda=50.0$ 小时；$\\Delta t=15.0$ 小时；$C_m=15000.0$ 美元；$C_f=10000.0$ 美元。\n- 测试用例 5（故障成本极高的边缘情况）：后验分布为 Weibull 分布，$k=2.0$，$\\lambda=100.0$ 小时；$\\Delta t=10.0$ 小时；$C_m=500.0$ 美元；$C_f=100000.0$ 美元。\n\n最终输出格式必须为单行：\n- 一个单独的列表，其元素是每个测试用例的列表，整行无任何空格。\n- 每个浮点数四舍五入到六位小数。",
            "solution": "该问题要求推导并实现一个用于信息物理系统部件计划性维护的基于阈值的停止规则。该决策在不确定性下做出，遵循贝叶斯风险最小化原则，并使用部件剩余使用寿命（RUL）的后验概率分布。\n\n首先，我们将决策问题形式化。在给定的检查点，我们必须在两个行动中做出选择：\n1.  **停止**：立即执行计划性维护。\n2.  **继续**：推迟维护，并继续运行一个时长为 $\\Delta t$ 的时间间隔。\n\n决策将基于最小化下一个时间间隔 $[0, \\Delta t]$ 内的期望成本。设 $T$ 为代表 RUL 的随机变量，其后验概率分布以可用数据 $\\mathcal{D}$ 为条件。我们决策的关键量是下一个时间间隔内发生故障的概率，我们将其表示为 $p$：\n$$ p = \\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D}) $$\n\n接下来，我们定义与每个行动相关的成本。\n**停止**行动的成本，我们称之为 $J(\\text{Stop})$，是计划性维护的确定性成本 $C_m$。\n$$ J(\\text{Stop}) = C_m $$\n\n**继续**行动的成本是随机的。如果部件在该时间间隔内发生故障（即 $T \\le \\Delta t$），将产生 $C_f$ 的成本。如果部件在该时间间隔内未发生故障（即 $T  \\Delta t$），则在这个单步前瞻模型中不产生任何成本。**继续**行动的期望成本 $J(\\text{Continue})$ 是这些结果的概率加权和：\n$$ J(\\text{Continue}) = \\mathbb{E}[\\text{Cost} \\mid \\text{Continue}] = C_f \\cdot \\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D}) + 0 \\cdot \\mathbb{P}(T  \\Delta t \\mid \\mathcal{D}) $$\n代入 $p = \\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$，上式可简化为：\n$$ J(\\text{Continue}) = C_f \\cdot p $$\n\n根据贝叶斯风险最小化原则，我们应该选择期望成本较低的行动。如果停止的成本小于继续的期望成本，我们应决定**停止**：\n$$ J(\\text{Stop})  J(\\text{Continue}) $$\n$$ C_m  C_f \\cdot p $$\n\n通过重新整理这个不等式，我们可以用故障概率 $p$ 来表示决策规则：\n$$ p  \\frac{C_m}{C_f} $$\n\n这个不等式定义了基于阈值的停止规则。如果下一个时间间隔内的后验故障概率 $p$ 超过一个关键阈值 $\\tau$，我们将执行维护。该阈值是维护成本与故障成本的比率：\n$$ \\tau = \\frac{C_m}{C_f} $$\n因此，决策规则是：如果 $p  \\tau$，则**停止**；如果 $p \\le \\tau$，则**继续**。决策变量 $d$ 为 $\\text{True}$ 表示停止，所以 $d = (p  \\tau)$。\n\n为应用此规则，我们必须使用给定的 $T$ 的后验分布的累积分布函数（CDF），在 $T = \\Delta t$ 处求值，来计算概率 $p = \\mathbb{P}(T \\le \\Delta t \\mid \\mathcal{D})$。\n\n如果 $T$ 的后验分布是形状参数为 $k$、尺度参数为 $\\lambda$ 的 **Weibull 分布**，其 CDF 为：\n$$ F_T(t; k, \\lambda) = 1 - \\exp\\left(-\\left(\\frac{t}{\\lambda}\\right)^k\\right) \\quad \\text{for } t \\ge 0 $$\n故障概率为：\n$$ p = F_T(\\Delta t; k, \\lambda) = 1 - \\exp\\left(-\\left(\\frac{\\Delta t}{\\lambda}\\right)^k\\right) $$\n\n如果 $T$ 的后验分布是参数为 $\\mu$ 和 $\\sigma$ 的**对数正态分布**（使得 $\\ln T \\sim \\mathcal{N}(\\mu, \\sigma^2)$），其 CDF 通过标准正态 CDF $\\Phi(\\cdot)$ 给出：\n$$ F_T(t; \\mu, \\sigma) = \\Phi\\left(\\frac{\\ln(t) - \\mu}{\\sigma}\\right) $$\n故障概率为：\n$$ p = F_T(\\Delta t; \\mu, \\sigma) = \\Phi\\left(\\frac{\\ln(\\Delta t) - \\mu}{\\sigma}\\right) $$\n标准正态 CDF 可以使用误差函数 $\\text{erf}(\\cdot)$ 计算，即 $\\Phi(z) = \\frac{1}{2}\\left[1 + \\text{erf}\\left(\\frac{z}{\\sqrt{2}}\\right)\\right]$。\n\n利用这些公式，我们可以为每个测试用例计算 $p$ 和 $\\tau$，并确定最优的维护决策 $d$。",
            "answer": "[[False,0.009950,0.200000],[True,0.295774,0.250000],[True,0.200000,0.200000],[False,0.054359,1.500000],[True,0.009950,0.005000]]"
        }
    ]
}