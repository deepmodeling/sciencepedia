{
    "hands_on_practices": [
        {
            "introduction": "数字孪生的核心在于其忠实地反映物理实体。这一过程的起点是将来自物理世界的连续传感器信号转化为数字数据。本练习引导我们从第一性原理出发，推导奈奎斯特采样准则，这是确保无失真数字化的基石。通过这项实践，您将深刻理解采样频率与信号保真度之间的根本联系，并掌握为工业4.0应用中的高保真数据流设计数据采集系统的关键技能。",
            "id": "4217854",
            "problem": "在一个工业4.0信息物理系统中的智能铣削单元的数字孪生（DT）必须将来自物理机床的应变式力传感器信号流式传输到DT分析系统。为确保模型保真度并防止对刀具切入动态的错误解读，采样数据必须无混叠。从傅里叶变换的定义和理想时域采样表示为与狄拉克脉冲序列相乘出发，推导一个实值、基带、带限的传感器信号的采样频率与混叠之间的关系。你的推导必须仅依赖于以下基础：连续时间傅里叶变换、线性性质以及时域乘法与频域卷积之间的对偶性。请用采样频率和单边带宽明确陈述保证采样后频谱中不出现混叠的条件。然后，对于一个刀具负载传感器，其模拟前端抗混叠级产生一个单边带宽为 $B = 9.375\\,\\text{kHz}$ 的有效带限信号（即，对于 $|f| > B$，其幅度可忽略不计），确定满足奈奎斯特准则从而防止混叠的最低采样率。将你的答案四舍五入到 $4$ 位有效数字，并以 $\\text{kHz}$ 为单位表示采样率。最终答案必须是一个单个实数。",
            "solution": "该问题要求推导奈奎斯特采样准则，并将其应用于一个特定的传感器信号。推导必须从傅里叶变换的定义和理想采样模型（即与狄拉克脉冲序列相乘）出发。\n\n设来自应变式力传感器的连续时间模拟信号表示为 $x(t)$。其连续时间傅里叶变换（CTFT）定义为：\n$$X(f) = \\int_{-\\infty}^{\\infty} x(t) \\exp(-j 2 \\pi f t) dt$$\n问题指出，该信号是实值、基带且有效带限的，其单边带宽为 $B$。这意味着其傅里叶变换 $X(f)$ 在超出此带宽的频率上为零：\n$$X(f) = 0 \\quad \\text{for} \\quad |f| > B$$\n对于实值信号 $x(t)$，其频谱具有共轭对称性，即 $X(-f) = X^*(f)$。\n\n时域中的理想采样被建模为连续信号 $x(t)$ 与一个无限狄拉克δ脉冲序列 $p(t)$ 的乘积。该脉冲序列定义为：\n$$p(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\n其中 $T_s$ 是采样周期。得到的采样信号 $x_s(t)$ 为：\n$$x_s(t) = x(t) \\cdot p(t) = x(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\n利用狄拉克δ函数的筛选特性，即 $g(t)\\delta(t-t_0) = g(t_0)\\delta(t-t_0)$，采样信号的表达式变为：\n$$x_s(t) = \\sum_{n=-\\infty}^{\\infty} x(nT_s) \\delta(t - nT_s)$$\n这表示一个脉冲序列，脉冲位于采样周期 $nT_s$ 的整数倍处，每个脉冲的权重为相应的采样值 $x(nT_s)$。\n\n为了理解采样在频域中的影响，我们必须计算采样信号的傅里叶变换 $X_s(f) = \\mathcal{F}\\{x_s(t)\\}$。问题指定使用对偶性质，即时域中的乘法对应于频域中的卷积（反之亦然）。因此：\n$$X_s(f) = \\mathcal{F}\\{x(t) \\cdot p(t)\\} = X(f) * P(f)$$\n其中 $P(f) = \\mathcal{F}\\{p(t)\\}$，符号 $*$ 表示卷积运算。\n\n下一步是求脉冲序列的傅里叶变换 $P(f)$。脉冲序列 $p(t)$ 是一个周期为 $T_s$ 的周期函数。周期脉冲序列的傅里叶变换是频域中的另一个脉冲序列。具体来说：\n$$P(f) = \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)\\right\\} = \\frac{1}{T_s} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(f - \\frac{k}{T_s}\\right)$$\n代入采样频率 $f_s = 1/T_s$，我们得到：\n$$P(f) = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s)$$\n\n现在，我们可以计算卷积来求得 $X_s(f)$：\n$$X_s(f) = X(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right)$$\n利用卷积算子的线性性质，我们可以将求和符号和常数因子 $f_s$ 移到外面：\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} \\left( X(f) * \\delta(f - kf_s) \\right)$$\n任何函数与一个移位的狄拉克脉冲进行卷积，会得到该函数的移位版本，遵循性质 $g(f) * \\delta(f-f_0) = g(f-f_0)$。应用此性质可得：\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} X(f - kf_s)$$\n这个基本结果表明，采样信号的频谱 $X_s(f)$ 由原始信号频谱 $X(f)$ 的缩放副本组成，这些副本在采样频率 $f_s$ 的每个整数倍处重复出现。\n\n当这些频谱副本发生重叠时，就会出现混叠。对应于 $k=0$ 项的原始频谱是 $f_s X(f)$，占据频率区间 $[-B, B]$。对于 $k=1$ 和 $k=-1$ 的相邻副本，分别以 $f_s$ 和 $-f_s$ 为中心。以 $f_s$ 为中心的副本占据区间 $[f_s - B, f_s + B]$。\n\n为了防止原始频谱与相邻副本之间发生任何重叠，原始频谱的频率上限必须小于或等于在 $f_s$ 处的副本的频率下限。这给出了以下条件：\n$$B \\le f_s - B$$\n重新整理这个不等式，可得到无混叠采样的条件：\n$$f_s \\ge 2B$$\n这就是奈奎斯特准则。它规定，为了从样本中完美地重建一个带限信号，采样频率 $f_s$ 必须至少是信号中最高频率分量 $B$ 的两倍。最低采样率 $f_{s, \\text{min}} = 2B$ 被称为奈奎斯特率。\n\n对于给定的问题，传感器信号的单边带宽为 $B = 9.375\\,\\text{kHz}$。为防止混叠，采样率 $f_s$ 必须满足奈奎斯特准则。所需的最低采样率为：\n$$f_{s, \\text{min}} = 2B = 2 \\times 9.375\\,\\text{kHz} = 18.75\\,\\text{kHz}$$\n问题要求答案四舍五入到 $4$ 位有效数字并以 kHz 为单位表示。计算值 $18.75$ 已经有四位有效数字。因此，最低采样率为 $18.75\\,\\text{kHz}$。",
            "answer": "$$\\boxed{18.75}$$"
        },
        {
            "introduction": "在确保数据保真度之后，下一步是保证整个信息物理系统的端到端实时性能。本练习模拟了一个典型的智能制造场景，要求在一个严格的时间期限内完成感知-决策-执行的完整闭环。通过对传感、网络、计算和驱动等各个阶段的延迟进行精确建模和预算分配，您将学习到如何系统性地分析和优化一个复杂的数字孪生应用，以满足工业控制的严苛要求。",
            "id": "4217803",
            "problem": "一个智能制造信息物理系统（CPS）利用数字孪生（DT）来闭合一个快速反馈回路，以满足工业4.0（I4.0）要求下的在线质量控制。每个循环迭代都经过一个四阶段流水线：传感、网络传输、计算和执行。每次迭代的端到端截止时间为 $5$ 毫秒，且工厂稳定性裕度要求通过为每个阶段分配延迟预算来严格控制最坏情况下的实际循环时间。\n\n假设一次循环迭代的科学真实参数如下：\n- 传感：一个模数转换器（ADC）在前端建立时间 $\\tau_{\\mathrm{sens}} = 0.35$ 毫秒后，以 $R_{\\mathrm{adc}} = 1.28 \\times 10^{6}$ 样本/秒的持续吞吐量采集 $N_{s} = 1024$ 个样本。\n- 网络：一个大小为 $S = 16384$ 比特的数据包通过容量为 $C = 10 \\times 10^{6}$ 比特/秒的链路传输，光纤长度为 $d = 150$ 米，信号速度为 $v = 2.0 \\times 10^{8}$ 米/秒。数据包到达输出队列的过程服从泊松分布，到达率为 $\\lambda = 150$ 包/秒，链路以速率 $\\mu = C/S$ 包/秒为数据包提供服务，服务时间服从指数分布（即一个M/M/1排队）。\n- 计算：数字孪生推理和模型更新需要 $O = 10^{6}$ 次浮点运算，在时钟频率为 $f = 3.0 \\times 10^{9}$ 周期/秒的处理器上实现，每次操作需要 $c_{\\mathrm{op}} = 3$ 个周期。\n- 执行：一个数模转换器（DAC）以 $R_{\\mathrm{dac}} = 2.0 \\times 10^{6}$ 样本/秒的速率输出 $N_{a} = 300$ 个样本，随后是执行器建立时间 $\\tau_{\\mathrm{act}} = 0.25$ 毫秒。\n\n设每个阶段的主要随机抖动由独立的零均值亚高斯波动建模，其标准差分别为 $\\sigma_{\\mathrm{sens}} = 0.08$ 毫秒, $\\sigma_{\\mathrm{net}} = 0.15$ 毫秒, $\\sigma_{\\mathrm{comp}} = 0.04$ 毫秒, 和 $\\sigma_{\\mathrm{act}} = 0.02$ 毫秒。您的设计目标是选择各阶段的预算 $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, 和 $B_{\\mathrm{act}}$，使得：\n1. 预算总和等于端到端目标，$\\sum B_{i} = 5$ 毫秒。\n2. 每个预算 $B_{i}$ 由该阶段的确定性期望延迟加上一个用于吸收抖动的附加裕量 $s_{i}$ 组成，$B_{i} = t_{i} + s_{i}$。\n3. 裕量分配应最大化四个阶段中的最小标准化裕度 $\\min_{i} \\left( s_{i}/\\sigma_{i} \\right)$，以确保在与亚高斯噪声的单边 Chebyshev 不等式一致的尾部边界下具有平衡的鲁棒性。\n\n仅从基本的速率-时间定义（时间等于工作负载除以吞吐量）、物理传播关系以及经过充分检验的M/M/1排队系统结果出发，推导出确定性期望延迟 $t_{\\mathrm{sens}}$, $t_{\\mathrm{net}}$, $t_{\\mathrm{comp}}$, 和 $t_{\\mathrm{act}}$。然后，求解裕量优化问题，并报告满足 $5$ 毫秒目标和上述鲁棒性准则的最终预算 $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, 和 $B_{\\mathrm{act}}$。每个预算都以毫秒表示，并将最终数值四舍五入到四位有效数字。最终答案必须是一个按 $\\left( B_{\\mathrm{sens}}, B_{\\mathrm{net}}, B_{\\mathrm{comp}}, B_{\\mathrm{act}} \\right)$ 顺序排列的单行矩阵。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和完整的。所有参数在物理上都是现实的，在数学上是一致的。排队系统是稳定的，因为到达率 $\\lambda = 150$ 包/秒小于服务率 $\\mu$。因此，我们可以开始求解。\n\n该问题要求我们确定一个信息物理控制回路四个顺序阶段的时间预算，表示为 $B_{\\mathrm{sens}}$, $B_{\\mathrm{net}}$, $B_{\\mathrm{comp}}$, 和 $B_{\\mathrm{act}}$。总预算必须等于端到端截止时间 $T_{\\mathrm{total}} = 5$ 毫秒。每个阶段的预算 $B_i$ 由确定性期望延迟 $t_i$ 和一个裕量时间 $s_i$ 组成，即 $B_i = t_i + s_i$。分配裕量是为了提供对时间抖动的鲁棒性，每个阶段的时间抖动由标准差 $\\sigma_i$ 表征。分配必须最大化所有阶段中的最小标准化裕度 $\\min_{i} (s_i / \\sigma_i)$。\n\n求解过程分为三个部分：\n1.  计算四个阶段中每个阶段的确定性期望延迟 $t_i$。\n2.  裕量分配优化问题的公式化与求解。\n3.  计算最终的阶段预算 $B_i$。\n\n**第一部分：计算确定性延迟 ($t_i$)**\n\n我们根据给定的参数和基本原理计算每个阶段的确定性延迟。所有计算都将以国际单位制（SI units）进行（秒、米、比特等），最终结果在适当时会转换为毫秒（ms）。\n\n**1. 传感延迟 ($t_{\\mathrm{sens}}$)**\n总传感延迟是ADC采集时间与前端建立时间 $\\tau_{\\mathrm{sens}}$ 之和。采集时间是样本数 $N_s$ 除以采样率 $R_{\\mathrm{adc}}$。\n$$t_{\\mathrm{sens}} = \\frac{N_{s}}{R_{\\mathrm{adc}}} + \\tau_{\\mathrm{sens}}$$\n给定 $N_{s} = 1024$，$R_{\\mathrm{adc}} = 1.28 \\times 10^{6}$ 样本/秒，以及 $\\tau_{\\mathrm{sens}} = 0.35$ 毫秒 $= 0.35 \\times 10^{-3}$ 秒：\n$$t_{\\mathrm{sens}} = \\frac{1024}{1.28 \\times 10^{6} \\text{ s}^{-1}} + 0.35 \\times 10^{-3} \\text{ s} = 0.8 \\times 10^{-3} \\text{ s} + 0.35 \\times 10^{-3} \\text{ s} = 1.15 \\times 10^{-3} \\text{ s} = 1.15 \\text{ ms}$$\n\n**2. 网络延迟 ($t_{\\mathrm{net}}$)**\n网络延迟包括传播延迟和在M/M/1排队系统中花费的时间（排队延迟加服务时间）。\n传播延迟是光纤长度 $d$ 除以信号速度 $v$。\n$$t_{\\mathrm{prop}} = \\frac{d}{v} = \\frac{150 \\text{ m}}{2.0 \\times 10^{8} \\text{ m/s}} = 0.75 \\times 10^{-6} \\text{ s}$$\n该系统被建模为一个M/M/1排队，到达率为 $\\lambda = 150$ 包/秒。服务率 $\\mu$ 是链路容量 $C$ 除以数据包大小 $S$。\n$$\\mu = \\frac{C}{S} = \\frac{10 \\times 10^{6} \\text{ bits/s}}{16384 \\text{ bits/packet}} = \\frac{10000000}{16384} \\text{ s}^{-1} \\approx 610.35 \\text{ s}^{-1}$$\n在M/M/1系统中花费的期望时间（逗留时间）$W$，包括排队等待和服务时间，由以下公式给出：\n$$W = \\frac{1}{\\mu - \\lambda}$$\n总期望网络延迟 $t_{\\mathrm{net}}$ 是传播延迟和逗留时间之和。\n$$t_{\\mathrm{net}} = t_{\\mathrm{prop}} + W = \\frac{d}{v} + \\frac{1}{\\mu - \\lambda}$$\n代入数值：\n$$t_{\\mathrm{net}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{1}{\\frac{10 \\times 10^{6}}{16384} \\text{ s}^{-1} - 150 \\text{ s}^{-1}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{10 \\times 10^{6} - 150 \\times 16384} \\text{ s}$$\n$$t_{\\mathrm{net}} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{10000000 - 2457600} \\text{ s} = 0.75 \\times 10^{-6} \\text{ s} + \\frac{16384}{7542400} \\text{ s}$$\n$$t_{\\mathrm{net}} \\approx 0.00000075 \\text{ s} + 0.00217224 \\text{ s} \\approx 0.00217299 \\text{ s} = 2.17299 \\text{ ms}$$\n\n**3. 计算延迟 ($t_{\\mathrm{comp}}$)**\n计算延迟是所需处理器总周期数除以处理器时钟频率 $f$。总周期数是操作数 $O$ 乘以每次操作的周期数 $c_{\\mathrm{op}}$。\n$$t_{\\mathrm{comp}} = \\frac{O \\times c_{\\mathrm{op}}}{f}$$\n给定 $O = 10^{6}$ 次操作，$c_{\\mathrm{op}} = 3$ 周期/操作，以及 $f = 3.0 \\times 10^{9}$ 周期/秒：\n$$t_{\\mathrm{comp}} = \\frac{10^{6} \\times 3}{3.0 \\times 10^{9} \\text{ s}^{-1}} = \\frac{3 \\times 10^{6}}{3 \\times 10^{9}} \\text{ s} = 1.0 \\times 10^{-3} \\text{ s} = 1.00 \\text{ ms}$$\n\n**4. 执行延迟 ($t_{\\mathrm{act}}$)**\n执行延迟是DAC输出时间与执行器建立时间 $\\tau_{\\mathrm{act}}$ 之和。输出时间是样本数 $N_a$ 除以输出率 $R_{\\mathrm{dac}}$。\n$$t_{\\mathrm{act}} = \\frac{N_{a}}{R_{\\mathrm{dac}}} + \\tau_{\\mathrm{act}}$$\n给定 $N_{a} = 300$，$R_{\\mathrm{dac}} = 2.0 \\times 10^{6}$ 样本/秒，以及 $\\tau_{\\mathrm{act}} = 0.25$ 毫秒 $= 0.25 \\times 10^{-3}$ 秒：\n$$t_{\\mathrm{act}} = \\frac{300}{2.0 \\times 10^{6} \\text{ s}^{-1}} + 0.25 \\times 10^{-3} \\text{ s} = 0.15 \\times 10^{-3} \\text{ s} + 0.25 \\times 10^{-3} \\text{ s} = 0.40 \\times 10^{-3} \\text{ s} = 0.40 \\text{ ms}$$\n\n**第二部分：裕量分配优化**\n\n总确定性延迟是各个阶段延迟的总和：\n$$\\sum_{i} t_i = t_{\\mathrm{sens}} + t_{\\mathrm{net}} + t_{\\mathrm{comp}} + t_{\\mathrm{act}}$$\n$$\\sum_{i} t_i \\approx 1.15 + 2.17299 + 1.00 + 0.40 = 4.72299 \\text{ ms}$$\n所有阶段的总可用裕量 $S_{\\mathrm{total}}$ 是端到端截止时间与总确定性延迟之差：\n$$S_{\\mathrm{total}} = T_{\\mathrm{total}} - \\sum_{i} t_i = 5 \\text{ ms} - 4.72299 \\text{ ms} = 0.27701 \\text{ ms}$$\n目标是最大化 $k = \\min_{i} (s_i / \\sigma_i)$，其约束条件是裕量总和等于总可用裕量：$\\sum_{i} s_i = S_{\\mathrm{total}}$。\n为了最大化一组分子和为定值的非负比率中的最小值，最优解在所有比率相等时取得。因此，我们对所有 $i$ 设定 $s_i / \\sigma_i = k$。\n这意味着 $s_i = k \\sigma_i$。将其代入总和约束中：\n$$\\sum_{i} s_i = \\sum_{i} (k \\sigma_i) = k \\sum_{i} \\sigma_i = S_{\\mathrm{total}}$$\n我们可以解出最优标准化裕度 $k$：\n$$k = \\frac{S_{\\mathrm{total}}}{\\sum_{i} \\sigma_i}$$\n给定的标准差为 $\\sigma_{\\mathrm{sens}} = 0.08$ 毫秒, $\\sigma_{\\mathrm{net}} = 0.15$ 毫秒, $\\sigma_{\\mathrm{comp}} = 0.04$ 毫秒, 和 $\\sigma_{\\mathrm{act}} = 0.02$ 毫秒。它们的总和是：\n$$\\sum_{i} \\sigma_i = 0.08 + 0.15 + 0.04 + 0.02 = 0.29 \\text{ ms}$$\n现在，我们计算 $k$：\n$$k = \\frac{0.27701 \\text{ ms}}{0.29 \\text{ ms}} \\approx 0.955203586$$\n\n**第三部分：计算最终预算 ($B_i$)**\n\n每个阶段的预算为 $B_i = t_i + s_i = t_i + k \\sigma_i$。为了精确，我们使用 $t_i$ 的未舍入值和计算出的 $k$ 值。\n\n$$B_{\\mathrm{sens}} = t_{\\mathrm{sens}} + k \\sigma_{\\mathrm{sens}} \\approx 1.15 \\text{ ms} + (0.955203586 \\times 0.08 \\text{ ms}) \\approx 1.15 + 0.076416 = 1.226416 \\text{ ms}$$\n$$B_{\\mathrm{net}} = t_{\\mathrm{net}} + k \\sigma_{\\mathrm{net}} \\approx 2.17299 \\text{ ms} + (0.955203586 \\times 0.15 \\text{ ms}) \\approx 2.17299 + 0.143281 = 2.316271 \\text{ ms}$$\n$$B_{\\mathrm{comp}} = t_{\\mathrm{comp}} + k \\sigma_{\\mathrm{comp}} = 1.00 \\text{ ms} + (0.955203586 \\times 0.04 \\text{ ms}) \\approx 1.00 + 0.038208 = 1.038208 \\text{ ms}$$\n$$B_{\\mathrm{act}} = t_{\\mathrm{act}} + k \\sigma_{\\mathrm{act}} = 0.40 \\text{ ms} + (0.955203586 \\times 0.02 \\text{ ms}) \\approx 0.40 + 0.019104 = 0.419104 \\text{ ms}$$\n\n最后，我们按照要求将这些预算值四舍五入到四位有效数字。\n$B_{\\mathrm{sens}} \\approx 1.226$ ms\n$B_{\\mathrm{net}} \\approx 2.316$ ms\n$B_{\\mathrm{comp}} \\approx 1.038$ ms\n$B_{\\mathrm{act}} \\approx 0.4191$ ms\n\n最终答案是这些舍入后预算值的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.226 & 2.316 & 1.038 & 0.4191\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数字孪生的“智慧”体现在其能够融合动态模型预测与实时传感器数据，以精确追踪物理实体的状态。当系统模型具有非线性特征时，扩展卡尔曼滤波器（EKF）成为一种强大而常用的估计算法。本练习将带您深入EKF的核心，通过推导非线性动力学和测量方程的雅可比矩阵，为实现滤波器的数据融合步骤奠定数学基础，这是开发高级状态感知数字孪生的关键一步。",
            "id": "4217830",
            "problem": "工业$4.0$中智能制造主轴的数字孪生被建模为一个连续时间、非线性、随机状态空间系统。状态向量为 $x=\\begin{pmatrix}\\theta \\\\ \\omega\\end{pmatrix}$，其中 $\\theta$ 是主轴角位置，$\\omega$ 是角速度。执行器输入是施加的扭矩 $u$。该孪生体的动力学包括非线性负载扭矩和与速度相关的耗散，由下式给出：\n$$\n\\dot{x} = f(x,u) = \\begin{pmatrix}\n\\omega \\\\\n\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\n\\end{pmatrix} + \\begin{pmatrix}\n0 \\\\\nw\n\\end{pmatrix},\n$$\n其中 $J>0$ 是转动惯量，$k>0$ 是负载扭矩系数，$c>0$ 是耗散系数，$w$ 是零均值高斯过程噪声，其方差为 $\\sigma_w^2$，以加性方式进入第二个状态方程。测量函数是一个与振动幅值和编码器相位相关的标量非线性信号，\n$$\ny = h(x) + v = \\alpha\\,\\omega^{2} + \\beta\\,\\sin(\\theta) + v,\n$$\n其中 $\\alpha>0$ 和 $\\beta>0$ 是已知系数，$v$ 是零均值高斯测量噪声，其方差为 $\\sigma_v^2$。该信息物理系统的数字孪生使用扩展卡尔曼滤波器（EKF）将传感器信息与模型进行融合。\n\n从扩展卡尔曼滤波器（EKF）所使用的一阶泰勒线性化和高斯不确定性传播的第一性原理出发，完成以下任务：\n\n$1.$ 推导EKF线性化所需的连续时间雅可比矩阵 $F(x,u) = \\frac{\\partial f}{\\partial x}$ 和 $H(x) = \\frac{\\partial h}{\\partial x}$。仔细证明项 $\\omega\\,|\\omega|$ 的导数，并说明可微性所需的任何条件。\n\n$2.$ 假设 $\\bar{\\omega}\\neq 0$，在标称工作点 $(\\bar{\\theta},\\bar{\\omega})$ 和输入 $\\bar{u}$ 处计算这些雅可比矩阵。\n\n$3.$ 假设在工作点执行一次测量更新，先验状态协方差为\n$$\nP^{-}=\\begin{pmatrix}\np_{11}  p_{12} \\\\\np_{12}  p_{22}\n\\end{pmatrix}\n$$\n且测量噪声方差为 $R=\\sigma_v^2$。使用EKF新息模型，推导在工作点处的标量新息协方差 $S$，用 $(p_{11},p_{12},p_{22})$、$(\\bar{\\theta},\\bar{\\omega})$ 和 $(\\alpha,\\beta,\\sigma_v^2)$ 表示。\n\n您的最终答案必须是 $S$ 的闭式解析表达式。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n- 状态向量：$x=\\begin{pmatrix}\\theta \\\\ \\omega\\end{pmatrix}$，其中 $\\theta$ 是角位置，$\\omega$ 是角速度。\n- 输入：执行器扭矩 $u$。\n- 系统动力学：$\\dot{x} = f(x,u) = \\begin{pmatrix} \\omega \\\\ \\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ w \\end{pmatrix}$。\n- 系统参数：$J>0$（转动惯量），$k>0$（负载扭矩系数），$c>0$（耗散系数）。\n- 过程噪声：$w$ 是零均值高斯噪声，方差为 $\\sigma_w^2$。\n- 测量函数：$y = h(x) + v = \\alpha\\,\\omega^{2} + \\beta\\,\\sin(\\theta) + v$。\n- 测量参数：$\\alpha>0$，$\\beta>0$。\n- 测量噪声：$v$ 是零均值高斯噪声，方差为 $\\sigma_v^2$。\n- 估计方法：扩展卡尔曼滤波器（EKF）。\n- 任务1：推导雅可比矩阵 $F(x,u) = \\frac{\\partial f}{\\partial x}$ 和 $H(x) = \\frac{\\partial h}{\\partial x}$，并讨论 $\\omega\\,|\\omega|$ 的导数。\n- 任务2：在标称工作点 $(\\bar{\\theta},\\bar{\\omega})$ 和输入 $\\bar{u}$ 处计算雅可比矩阵，其中 $\\bar{\\omega}\\neq 0$。\n- 任务3：给定先验状态协方差 $P^{-}=\\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$ 和测量噪声方差 $R=\\sigma_v^2$，推导在工作点处的标量新息协方差 $S$。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学上成立：** 该状态空间模型代表一个标准的二阶旋转机械系统，受到正弦负载和非线性（二次）阻尼的影响。这是工程学中一个常见且物理上合理的模型。测量模型是状态变量的一个合理的非线性组合。对此类系统应用扩展卡尔曼滤波器进行状态估计是现代控制与估计理论的基石。\n- **适定的：** 问题提供了所有必要的数学定义和参数约束。任务具体、相互关联，并能导出一个唯一、可推导的解析表达式。提供了条件 $\\bar{\\omega} \\neq 0$，这与非线性阻尼项的线性化相关。\n- **客观的：** 问题以精确的数学语言陈述，没有主观性或歧义。\n\n### 步骤3：结论与行动\n问题是**有效的**，因为它在科学上成立、数学上适定且客观。将提供解答。\n\n### 求解推导\n\n根据题目要求，求解过程分为三个部分。\n\n#### 1. 雅可比矩阵 $F(x,u)$ 和 $H(x)$ 的推导\n\n状态向量为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} \\theta \\\\ \\omega \\end{pmatrix}$。\n\n非线性状态动力学函数为：\n$$\nf(x,u) = \\begin{pmatrix} f_1(x,u) \\\\ f_2(x,u) \\end{pmatrix} = \\begin{pmatrix}\nx_2 \\\\\n\\frac{1}{J}\\Big(u - k \\sin(x_1) - c\\,x_2\\,|x_2|\\Big)\n\\end{pmatrix}\n$$\n雅可比矩阵 $F(x,u)$ 定义为 $F = \\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1}  \\frac{\\partial f_1}{\\partial x_2} \\\\ \\frac{\\partial f_2}{\\partial x_1}  \\frac{\\partial f_2}{\\partial x_2} \\end{pmatrix}$。偏导数计算如下：\n- $\\frac{\\partial f_1}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}(\\omega) = 0$\n- $\\frac{\\partial f_1}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}(\\omega) = 1$\n- $\\frac{\\partial f_2}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}\\left(\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\\right) = -\\frac{k}{J}\\cos(\\theta)$\n- $\\frac{\\partial f_2}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}\\left(\\frac{1}{J}\\Big(u - k \\sin(\\theta) - c\\,\\omega\\,|\\omega|\\Big)\\right) = -\\frac{c}{J}\\frac{d}{d\\omega}(\\omega\\,|\\omega|)$\n\n为计算最后一个导数，我们分析 $\\omega\\,|\\omega|$ 项。该函数可以分段表示为：\n$$\ng(\\omega) = \\omega\\,|\\omega| = \\begin{cases} \\omega^2 & \\text{if } \\omega \\ge 0 \\\\ -\\omega^2 & \\text{if } \\omega  0 \\end{cases}\n$$\n关于 $\\omega$ 的导数为：\n$$\n\\frac{dg}{d\\omega} = \\begin{cases} 2\\omega  \\text{if } \\omega > 0 \\\\ -2\\omega  \\text{if } \\omega  0 \\end{cases}\n$$\n这可以紧凑地写为 $2|\\omega|$。在 $\\omega=0$ 处，右导数为 $\\lim_{h\\to 0^+} \\frac{(0+h)^2}{h} = 0$，左导数为 $\\lim_{h\\to 0^-} \\frac{-(0+h)^2}{h} = 0$。由于左右导数相等，该函数在 $\\omega=0$ 处可微，且导数为 $0$。因此，$\\frac{d}{d\\omega}(\\omega\\,|\\omega|) = 2|\\omega|$ 对所有 $\\omega \\in \\mathbb{R}$ 均有效。可微性不需要关于 $\\omega$ 的特殊条件。\n\n代入此结果，我们得到：\n$\\frac{\\partial f_2}{\\partial \\omega} = -\\frac{c}{J}(2|\\omega|) = -\\frac{2c|\\omega|}{J}$。\n\n组合成雅可比矩阵 $F(x,u)$：\n$$\nF(x,u) = \\begin{pmatrix}\n0  1 \\\\\n-\\frac{k}{J}\\cos(\\theta)  -\\frac{2c|\\omega|}{J}\n\\end{pmatrix}\n$$\n\n接下来，我们求测量函数的雅可比矩阵。标量测量函数为：\n$$\nh(x) = \\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta) = \\alpha\\,x_2^2 + \\beta\\,\\sin(x_1)\n$$\n测量雅可比矩阵 $H(x)$ 是一个行向量，定义为 $H = \\frac{\\partial h}{\\partial x} = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1}  \\frac{\\partial h}{\\partial x_2} \\end{pmatrix}$。偏导数为：\n- $\\frac{\\partial h}{\\partial x_1} = \\frac{\\partial}{\\partial \\theta}(\\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta)) = \\beta\\,\\cos(\\theta)$\n- $\\frac{\\partial h}{\\partial x_2} = \\frac{\\partial}{\\partial \\omega}(\\alpha\\,\\omega^2 + \\beta\\,\\sin(\\theta)) = 2\\alpha\\,\\omega$\n\n组合成测量雅可比矩阵 $H(x)$：\n$$\nH(x) = \\begin{pmatrix} \\beta\\,\\cos(\\theta)  2\\alpha\\,\\omega \\end{pmatrix}\n$$\n\n#### 2. 在标称工作点计算雅可比矩阵\n\n我们在标称工作点 $(\\bar{x}, \\bar{u})$ 处计算 $F(x,u)$ 和 $H(x)$，其中 $\\bar{x} = (\\bar{\\theta}, \\bar{\\omega})$，且满足条件 $\\bar{\\omega} \\neq 0$。将计算出的雅可比矩阵记为 $\\bar{F}$ 和 $\\bar{H}$。\n\n$$\n\\bar{F} = F(\\bar{x},\\bar{u}) = \\begin{pmatrix}\n0  1 \\\\\n-\\frac{k}{J}\\cos(\\bar{\\theta})  -\\frac{2c|\\bar{\\omega}|}{J}\n\\end{pmatrix}\n$$\n$$\n\\bar{H} = H(\\bar{x}) = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta})  2\\alpha\\,\\bar{\\omega} \\end{pmatrix}\n$$\n\n#### 3. 新息协方差 $S$ 的推导\n\nEKF的新息协方差 $S$ 在测量更新步骤中计算。它表示新息（或残差）的方差，即实际测量值与预测测量值之差。S 的计算公式为：\n$$\nS = H P^{-} H^T + R\n$$\n我们使用线性化的测量矩阵 $\\bar{H}$ 在工作点计算该值。\n- 线性化的测量雅可比矩阵为 $\\bar{H} = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta})  2\\alpha\\,\\bar{\\omega} \\end{pmatrix}$。\n- 先验状态协方差为 $P^{-} = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$。\n- 测量噪声协方差为标量 $R = \\sigma_v^2$。\n\n我们首先计算 $\\bar{H} P^{-} \\bar{H}^T$ 项。这是一个二次型。\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta})  2\\alpha\\,\\bar{\\omega} \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta}) \\\\ 2\\alpha\\,\\bar{\\omega} \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\bar{H} P^{-} = \\begin{pmatrix} \\beta\\,\\cos(\\bar{\\theta})p_{11} + 2\\alpha\\,\\bar{\\omega}p_{12}  \\beta\\,\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\,\\bar{\\omega}p_{22} \\end{pmatrix}\n$$\n乘以 $\\bar{H}^T$：\n$$\n\\bar{H} P^{-} \\bar{H}^T = (\\beta\\,\\cos(\\bar{\\theta})p_{11} + 2\\alpha\\,\\bar{\\omega}p_{12})(\\beta\\,\\cos(\\bar{\\theta})) + (\\beta\\,\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\,\\bar{\\omega}p_{22})(2\\alpha\\,\\bar{\\omega})\n$$\n展开各项：\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\beta^2\\cos^2(\\bar{\\theta})p_{11} + 2\\alpha\\beta\\,\\bar{\\omega}\\cos(\\bar{\\theta})p_{12} + 2\\alpha\\beta\\,\\bar{\\omega}\\cos(\\bar{\\theta})p_{12} + 4\\alpha^2\\bar{\\omega}^2p_{22}\n$$\n合并交叉项：\n$$\n\\bar{H} P^{-} \\bar{H}^T = \\beta^2 p_{11} \\cos^2(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^2 p_{22} \\bar{\\omega}^2\n$$\n最后，我们加上测量噪声方差 $R = \\sigma_v^2$ 得到新息协方差 $S$：\n$$\nS = \\beta^2 p_{11} \\cos^2(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^2 p_{22} \\bar{\\omega}^2 + \\sigma_v^2\n$$\n这就是在指定工作点处标量新息协方差 $S$ 的最终闭式表达式。",
            "answer": "$$\\boxed{\\beta^{2} p_{11} \\cos^{2}(\\bar{\\theta}) + 4\\alpha\\beta\\, p_{12} \\bar{\\omega}\\cos(\\bar{\\theta}) + 4\\alpha^{2} p_{22} \\bar{\\omega}^{2} + \\sigma_v^{2}}$$"
        }
    ]
}