{
    "hands_on_practices": [
        {
            "introduction": "Believable kinesthetic haptics begins with accurately simulating physical dynamics. This first exercise models a fundamental interaction—contact with a virtual surface—by applying the work-energy principle to a simplified impact scenario . Calculating the peak forces and displacements will build your intuition for how energy conservation dictates the perceived stiffness and stability of virtual objects in a Cyber-Physical System.",
            "id": "4225645",
            "problem": "A human operator interacts with a Cyber-Physical System (CPS) through a grounded haptic interface whose Digital Twin (DT) models contact with a virtual wall as a linear compliant element. The virtual contact model is defined by the constitutive relation $F=K x$, where $F$ is the contact force, $K$ is the stiffness, and $x$ is the penetration depth into the virtual wall. Consider an effective end-effector lumped mass $M$ approaching the wall with initial velocity $v$ and making first contact at $t=0$ with zero initial penetration. Assume the following idealizations: frictionless normal contact, no damping or time delay, rigid environment except the modeled compliance, and the haptic controller renders the virtual stiffness passively. The parameters are $M=0.1\\,\\mathrm{kg}$, $v=0.5\\,\\mathrm{m/s}$, and $K=10^{5}\\,\\mathrm{N/m}$.\n\nStarting from Newton’s second law and the work-energy principle, derive the motion of the mass during contact and determine the maximum penetration depth $x_{\\max}$ and the corresponding peak contact force $F_{\\max}$ for this interaction. Express the final numerical answers in meters for $x_{\\max}$ and Newtons for $F_{\\max}$, rounded to four significant figures. Report your final answer as two values in a single row matrix in the order $\\left(x_{\\max},\\,F_{\\max}\\right)$.",
            "solution": "The problem statement is first validated for scientific soundness, completeness, and objectivity.\n\n**Step 1: Extract Givens**\n- Constitutive relation for the virtual wall: $F = Kx$\n- $F$: contact force\n- $K$: stiffness, given as $K=10^{5}\\,\\mathrm{N/m}$\n- $x$: penetration depth\n- $M$: effective end-effector mass, given as $M=0.1\\,\\mathrm{kg}$\n- $v$: initial velocity of the mass at first contact, given as $v=0.5\\,\\mathrm{m/s}$\n- Initial conditions at time $t=0$: $x(0) = 0$ (zero initial penetration), $\\dot{x}(0) = v$ (initial velocity)\n- Idealizations: frictionless normal contact, no damping, no time delay, rigid environment except for the modeled compliance, passive haptic controller.\n- Objectives: Derive the motion, find the maximum penetration depth $x_{\\max}$ and the peak contact force $F_{\\max}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on fundamental principles of classical mechanics, specifically Newton's second law and the work-energy principle, applied to a simple harmonic oscillator. The model $F=Kx$ is Hooke's Law. This is a standard and valid representation for a compliant contact in physics and engineering.\n- **Well-Posed:** The problem is a well-posed initial value problem for a second-order linear ordinary differential equation. All necessary parameters ($M$, $K$, $v$) and initial conditions ($x(0)$, $\\dot{x}(0)$) are provided, ensuring a unique solution exists.\n- **Objective:** The problem is formulated with precise, objective language and established scientific terminology.\n- **Completeness and Consistency:** The problem is self-contained. The provided data are consistent with each other and are sufficient for finding a solution. The idealizations are explicitly stated and serve to define the boundaries of the physical model.\n- **Realism:** The numerical values for mass, velocity, and stiffness are physically plausible for a haptic interaction scenario.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid as it is scientifically sound, well-posed, and complete. A solution will be derived.\n\n**Derivation of the Equation of Motion**\nThe interaction is modeled as a mass moving against a linear spring. During contact, the only force acting on the mass $M$ is the restoring force from the virtual wall, which opposes the penetration. According to Newton's second law, the sum of forces equals mass times acceleration, $F_{net} = Ma$. The acceleration is the second time derivative of the penetration depth, $a = \\ddot{x}$. The restoring force is $F = -Kx$.\n\nTherefore, the equation of motion is:\n$$M\\ddot{x} = -Kx$$\nRearranging this gives the standard form of the equation for a simple harmonic oscillator:\n$$M\\ddot{x} + Kx = 0$$\nDividing by $M$, we get:\n$$\\ddot{x} + \\frac{K}{M}x = 0$$\nThis is often written as $\\ddot{x} + \\omega^2 x = 0$, where $\\omega$ is the natural angular frequency of the system, defined as:\n$$\\omega = \\sqrt{\\frac{K}{M}}$$\nThe general solution for this differential equation is of the form $x(t) = A \\cos(\\omega t) + B \\sin(\\omega t)$. To find the specific solution, we apply the initial conditions.\nAt $t=0$, the penetration is zero: $x(0)=0$.\n$$x(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A$$\nThus, $A=0$. The solution simplifies to $x(t) = B \\sin(\\omega t)$.\n\nNext, we use the initial velocity condition. The velocity is the first time derivative of position: $\\dot{x}(t) = B \\omega \\cos(\\omega t)$.\nAt $t=0$, the velocity is $v$: $\\dot{x}(0)=v$.\n$$\\dot{x}(0) = B \\omega \\cos(0) = B \\omega \\cdot 1 = B \\omega$$\nThus, $B \\omega = v$, which gives $B = \\frac{v}{\\omega}$.\nSubstituting $B$ back into the solution for $x(t)$, the motion of the mass during contact is described by:\n$$x(t) = \\frac{v}{\\omega} \\sin(\\omega t)$$\n\n**Determination of Maximum Penetration and Peak Force**\nThe problem requires the use of the work-energy principle. This principle provides a direct path to finding the maximum penetration $x_{\\max}$ without needing to solve the full time-dependent motion. The work-energy theorem states that the work done on an object is equal to the change in its kinetic energy. In this conservative system (no friction, no damping), this is equivalent to the principle of conservation of mechanical energy.\n\nTotal initial energy at $t=0$ (the moment of contact):\nThe kinetic energy is $E_{k,i} = \\frac{1}{2}Mv^2$.\nThe potential energy stored in the virtual spring is $E_{p,i} = \\frac{1}{2}Kx(0)^2 = \\frac{1}{2}K(0)^2 = 0$.\nSo, the total initial energy is $E_{total} = E_{k,i} + E_{p,i} = \\frac{1}{2}Mv^2$.\n\nTotal final energy at maximum penetration $x_{\\max}$:\nAt the point of maximum penetration, the mass momentarily comes to a stop before reversing direction. Therefore, its velocity is $0$, and its final kinetic energy is $E_{k,f} = 0$.\nAll the initial kinetic energy has been converted into potential energy stored in the virtual spring: $E_{p,f} = \\frac{1}{2}Kx_{\\max}^2$.\nThe total final energy is $E_{total} = E_{k,f} + E_{p,f} = \\frac{1}{2}Kx_{\\max}^2$.\n\nBy the principle of conservation of energy:\n$$E_{initial} = E_{final}$$\n$$\\frac{1}{2}Mv^2 = \\frac{1}{2}Kx_{\\max}^2$$\nSolving for $x_{\\max}$:\n$$Mv^2 = Kx_{\\max}^2$$\n$$x_{\\max}^2 = \\frac{Mv^2}{K}$$\n$$x_{\\max} = \\sqrt{\\frac{Mv^2}{K}} = v\\sqrt{\\frac{M}{K}}$$\n\nThe peak contact force, $F_{\\max}$, occurs at the maximum penetration depth, $x_{\\max}$, according to the constitutive relation $F=Kx$.\n$$F_{\\max} = Kx_{\\max}$$\nSubstituting the expression for $x_{\\max}$:\n$$F_{\\max} = K \\left( v\\sqrt{\\frac{M}{K}} \\right) = v\\sqrt{K^2 \\frac{M}{K}} = v\\sqrt{MK}$$\n\n**Numerical Calculation**\nThe given parameters are:\n- $M = 0.1\\,\\mathrm{kg}$\n- $v = 0.5\\,\\mathrm{m/s}$\n- $K = 10^{5}\\,\\mathrm{N/m}$\n\nFirst, we calculate the maximum penetration depth $x_{\\max}$:\n$$x_{\\max} = (0.5\\,\\mathrm{m/s}) \\sqrt{\\frac{0.1\\,\\mathrm{kg}}{10^{5}\\,\\mathrm{N/m}}} = 0.5 \\sqrt{\\frac{10^{-1}}{10^5}} = 0.5 \\sqrt{10^{-6}}\\,\\mathrm{m}$$\n$$x_{\\max} = 0.5 \\times 10^{-3}\\,\\mathrm{m} = 0.0005\\,\\mathrm{m}$$\nRounded to four significant figures, this is $5.000 \\times 10^{-4}\\,\\mathrm{m}$.\n\nNext, we calculate the peak contact force $F_{\\max}$:\n$$F_{\\max} = Kx_{\\max} = (10^{5}\\,\\mathrm{N/m})(0.0005\\,\\mathrm{m})$$\n$$F_{\\max} = 10^5 \\times 5 \\times 10^{-4}\\,\\mathrm{N} = 5 \\times 10^1\\,\\mathrm{N} = 50\\,\\mathrm{N}$$\nRounded to four significant figures, this is $50.00\\,\\mathrm{N}$.\n\nThe final answers are $x_{\\max} = 5.000 \\times 10^{-4}\\,\\mathrm{m}$ and $F_{\\max} = 50.00\\,\\mathrm{N}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.000 \\times 10^{-4} & 50.00 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While physical principles provide an ideal model, haptic rendering in a Cyber-Physical System is a digital process constrained by finite sampling rates. This practice delves into aliasing, a critical artifact where the discrete nature of the system can cause high-frequency signals to be perceived as incorrect, lower frequencies. By calculating the aliased frequency of a vibrotactile signal and mapping it to human perceptual channels , you will learn to predict how digital limitations can alter the user's sensory experience, a vital consideration for designing any high-fidelity haptic display.",
            "id": "4225609",
            "problem": "A human-in-the-loop Cyber-Physical System (CPS) with a Digital Twin rendering pipeline drives a vibrotactile actuator using sampled commands. The actuator is commanded to produce a continuous-time sinusoidal vibration of frequency $f_{0}$ that is sampled at a rate $f_{s}$ and reproduced by a standard zero-order hold at the same rate. In the absence of anti-alias filtering and under ideal sampling, the perceptually relevant component of a sampled sinusoid can be characterized by its discrete-time equivalence as an alias within the baseband $[0, f_{s}/2]$, due to the $2\\pi$-periodicity of the sampled phase.\n\nConsider $f_{0} = 600\\,\\mathrm{Hz}$ and $f_{s} = 1\\,\\mathrm{kHz}$. Starting from the definitions of sinusoidal sampling,\n$$x(t) = A \\cos(2\\pi f_{0} t), \\quad x[n] = x\\!\\left(\\frac{n}{f_{s}}\\right) = A \\cos\\!\\left(2\\pi \\frac{f_{0}}{f_{s}} n\\right),$$\ndetermine the aliased baseband frequency $f_{\\mathrm{alias}} \\in [0, f_{s}/2]$ that the human would perceive when the actuator is driven by the sampled signal.\n\nFor human mechanoreceptor channel classification, use the following well-established vibrotactile sensitivity bands for the glabrous skin of the fingerpad:\n- Rapidly Adapting type 1 (RA1) channel: $5\\,\\mathrm{Hz} \\leq f \\leq 40\\,\\mathrm{Hz}$,\n- Pacinian Corpuscle (PC) channel: $50\\,\\mathrm{Hz} \\leq f \\leq 800\\,\\mathrm{Hz}$.\nIf $f$ lies outside both bands, it is considered “neither.”\n\nReport your final answer as a row matrix containing two entries:\n1. the aliased frequency $f_{\\mathrm{alias}}$ in $\\mathrm{Hz}$, and\n2. a channel code defined as $1$ for RA1, $2$ for PC, and $0$ for neither.\n\nExpress the alias frequency in $\\mathrm{Hz}$. No rounding is required.",
            "solution": "The problem requires the determination of the perceived aliased frequency of a sampled sinusoidal signal and its classification into a human mechanoreceptor channel. This is a problem of signal sampling and aliasing, governed by the Nyquist-Shannon sampling theorem.\n\nThe problem begins with the definitions of a continuous-time sinusoidal signal, $x(t)$, and its sampled counterpart, $x[n]$:\n$$x(t) = A \\cos(2\\pi f_{0} t)$$\n$$x[n] = x\\left(\\frac{n}{f_{s}}\\right) = A \\cos\\left(2\\pi \\frac{f_{0}}{f_{s}} n\\right)$$\nwhere $f_0$ is the original signal frequency and $f_s$ is the sampling frequency. The expression for the sampled signal can be written in terms of the discrete-time angular frequency, $\\Omega_0$, as:\n$$x[n] = A \\cos(\\Omega_0 n), \\quad \\text{where} \\quad \\Omega_0 = 2\\pi \\frac{f_0}{f_s}$$\nThe problem states that the perceptually relevant frequency, $f_{\\mathrm{alias}}$, is the discrete-time equivalent of $f_0$ within the baseband $[0, f_s/2]$. This baseband in the physical frequency domain corresponds to a discrete-time angular frequency range of $[0, \\pi]$.\n\nFirst, we calculate the discrete-time angular frequency $\\Omega_0$ using the given values $f_0 = 600\\,\\mathrm{Hz}$ and $f_s = 1\\,\\mathrm{kHz} = 1000\\,\\mathrm{Hz}$.\n$$\\Omega_0 = 2\\pi \\frac{600}{1000} = 2\\pi (0.6) = 1.2\\pi \\text{ radians/sample}$$\nThe Nyquist frequency is $f_s/2 = 1000/2 = 500\\,\\mathrm{Hz}$. Since $f_0 = 600\\,\\mathrm{Hz}$ is greater than the Nyquist frequency, aliasing will occur.\n\nIn discrete-time systems, due to the periodic nature of the complex exponential basis functions (or sinusoidal functions), frequencies are only unique within an interval of length $2\\pi$. Any two angular frequencies $\\Omega_1$ and $\\Omega_2$ are considered equivalent if $\\Omega_1 = \\Omega_2 + 2\\pi k$ for any integer $k$. The standard interval for the principal alias is $(-\\pi, \\pi]$. Furthermore, for real-valued signals, the cosine function is even, meaning $\\cos(\\theta) = \\cos(-\\theta)$. Consequently, a negative frequency $-\\Omega$ is indistinguishable from its positive counterpart $\\Omega$. This is why the perceptual baseband is specified as $[0, f_s/2]$, which corresponds to the discrete-time angular frequency range of $[0, \\pi]$.\n\nOur calculated frequency $\\Omega_0 = 1.2\\pi$ lies outside the principal alias range $(-\\pi, \\pi]$. We find the equivalent frequency within this range by subtracting an integer multiple of $2\\pi$. For $k=1$:\n$$\\Omega' = \\Omega_0 - 2\\pi \\cdot 1 = 1.2\\pi - 2\\pi = -0.8\\pi$$\nThe sampled signal is thus indistinguishable from a signal with this new frequency:\n$$x[n] = A \\cos(1.2\\pi n) = A \\cos(-0.8\\pi n)$$\nUsing the even property of the cosine function:\n$$\\cos(-0.8\\pi n) = \\cos(0.8\\pi n)$$\nThe resulting equivalent positive angular frequency is $\\Omega_{\\mathrm{alias}} = 0.8\\pi$. This value lies within the desired range $[0, \\pi]$.\n\nTo find the physical frequency $f_{\\mathrm{alias}}$ in Hertz, we convert $\\Omega_{\\mathrm{alias}}$ back from the discrete-time domain:\n$$f_{\\mathrm{alias}} = \\frac{\\Omega_{\\mathrm{alias}}}{2\\pi} f_s$$\nSubstituting the values:\n$$f_{\\mathrm{alias}} = \\frac{0.8\\pi}{2\\pi} \\cdot 1000\\,\\mathrm{Hz} = 0.4 \\cdot 1000\\,\\mathrm{Hz} = 400\\,\\mathrm{Hz}$$\nThe aliased frequency that would be perceived by the human is $400\\,\\mathrm{Hz}$.\n\nThe second part of the task is to classify this frequency into one of the provided human mechanoreceptor channels. The sensitivity bands are:\n- Rapidly Adapting type 1 (RA1) channel: $5\\,\\mathrm{Hz} \\leq f \\leq 40\\,\\mathrm{Hz}$\n- Pacinian Corpuscle (PC) channel: $50\\,\\mathrm{Hz} \\leq f \\leq 800\\,\\mathrm{Hz}$\n\nWe test our result, $f_{\\mathrm{alias}} = 400\\,\\mathrm{Hz}$, against these bands.\n- For the RA1 channel: $5 \\leq 400 \\leq 40$ is false.\n- For the PC channel: $50 \\leq 400 \\leq 800$ is true.\n\nThe frequency $f_{\\mathrm{alias}} = 400\\,\\mathrm{Hz}$ falls within the PC channel sensitivity band. The problem defines the channel codes as $1$ for RA1, $2$ for PC, and $0$ for neither. Therefore, the channel code for this frequency is $2$.\n\nThe final answer is a row matrix containing the alias frequency $f_{\\mathrm{alias}}$ and the channel code. This gives the two entries as $400$ and $2$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 400 & 2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A powerful Digital Twin must be grounded in reality, often by learning environmental properties from measured data. This practice addresses the core engineering task of system identification, asking: how do we determine the parameters for our virtual models, such as the stiffness $K$? By applying the method of least squares to noisy force-displacement data , you will implement an algorithm to estimate this parameter, bridging the gap between empirical observation and the physics-based models that drive realistic haptic interaction.",
            "id": "4225627",
            "problem": "A human operator interacts with a virtual proxy of a haptic-enabled Cyber-Physical System (CPS) within a digital twin. The contact environment is well-approximated by a linear elastic model where the contact force is proportional to the penetration displacement. The fundamental base is Hooke’s law, which states that the elastic force is proportional to displacement: $$F = K x,$$ where $F$ is the force in Newtons, $x$ is the displacement in meters, and $K$ is the stiffness in Newtons per meter. Assume a measurement model with additive, zero-mean noise: $$F_k = K x_k + \\epsilon_k,$$ for samples indexed by $k$, where $\\epsilon_k$ are independent measurement disturbances with $\\mathbb{E}[\\epsilon_k] = 0$. Using Least Squares (LS), you must construct a parameter identification routine to estimate the environment stiffness $K$ from measured sample pairs $(x_k, F_k)$, producing an estimate $\\hat{K}$ that minimizes the sum of squared residuals between measured and predicted forces. Your derivation and algorithm must be based only on the stated fundamental base and measurement model. Your program must then compute $\\hat{K}$ for each dataset in the provided test suite.\n\nPhysical units and numerical requirements:\n- Report $\\hat{K}$ in Newtons per meter (N/m), rounded to $3$ decimal places.\n- Angles are not involved and need not be specified.\n- The final output must be a single line containing the results as a comma-separated list enclosed in square brackets (e.g., $[k_1,k_2,k_3]$), where each $k_i$ is a float.\n\nTest suite (each dataset contains $5$ sample pairs $(x_k, F_k)$ with $x_k$ in meters and $F_k$ in Newtons):\n- Dataset $1$ (typical interaction with moderate measurement noise):\n  - $x$: $[0.005, 0.010, 0.015, 0.020, 0.025]$\n  - $F$: $[7.7, 15.3, 22.3, 29.8, 38.1]$\n- Dataset $2$ (mixed-sign displacements including a zero sample):\n  - $x$: $[0.000, -0.020, 0.020, -0.010, 0.010]$\n  - $F$: $[0.2, -39.8, 40.4, -19.7, 19.9]$\n- Dataset $3$ (near-zero displacements with consistent proportionality):\n  - $x$: $[0.000001, -0.000002, 0.000003, -0.000004, 0.000005]$\n  - $F$: $[0.1, -0.2, 0.3, -0.4, 0.5]$\n- Dataset $4$ (outlier-dominated sample that stresses numerical weighting):\n  - $x$: $[0.010, 0.020, 0.030, 0.040, 0.500]$\n  - $F$: $[10.1, 19.6, 28.9, 39.7, 503.0]$\n- Dataset $5$ (sign-inverted force measurements leading to negative stiffness):\n  - $x$: $[0.010, 0.020, 0.030, 0.040, 0.050]$\n  - $F$: $[-10.5, -20.1, -29.8, -40.2, -50.3]$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[k_1,k_2,k_3,k_4,k_5]$), where each entry is $\\hat{K}$ for the corresponding dataset in N/m, rounded to $3$ decimal places. No additional text should be printed.",
            "solution": "The user-provided problem statement has been evaluated against the required validation criteria.\n\n### Step 1: Extract Givens\n- **Fundamental Base**: Hooke's law, $F = K x$, where $F$ is force (Newtons), $x$ is displacement (meters), and $K$ is stiffness (Newtons per meter).\n- **Measurement Model**: $F_k = K x_k + \\epsilon_k$, where $k$ is the sample index, $F_k$ is the measured force, $x_k$ is the measured displacement, and $\\epsilon_k$ is an independent measurement disturbance with zero mean, $\\mathbb{E}[\\epsilon_k] = 0$.\n- **Objective**: Use the method of Least Squares (LS) to construct a parameter identification routine to estimate the stiffness $K$, yielding an estimate $\\hat{K}$ that minimizes the sum of squared residuals.\n- **Output Requirement**: Report $\\hat{K}$ in N/m, rounded to $3$ decimal places, as a comma-separated list in square brackets.\n- **Test Suite**:\n  - Dataset $1$:\n    - $x = [0.005, 0.010, 0.015, 0.020, 0.025]$\n    - $F = [7.7, 15.3, 22.3, 29.8, 38.1]$\n  - Dataset $2$:\n    - $x = [0.000, -0.020, 0.020, -0.010, 0.010]$\n    - $F = [0.2, -39.8, 40.4, -19.7, 19.9]$\n  - Dataset $3$:\n    - $x = [0.000001, -0.000002, 0.000003, -0.000004, 0.000005]$\n    - $F = [0.1, -0.2, 0.3, -0.4, 0.5]$\n  - Dataset $4$:\n    - $x = [0.010, 0.020, 0.030, 0.040, 0.500]$\n    - $F = [10.1, 19.6, 28.9, 39.7, 503.0]$\n  - Dataset $5$:\n    - $x = [0.010, 0.020, 0.030, 0.040, 0.050]$\n    - $F = [-10.5, -20.1, -29.8, -40.2, -50.3]$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on Hooke's Law, a fundamental principle of linear elasticity, and the method of Least Squares, a standard and foundational technique in statistical estimation and system identification. These are cornerstones of physics and engineering. The problem is scientifically sound.\n- **Well-Posedness**: The problem asks for the estimation of a single parameter, $K$, from a set of data points by minimizing a well-defined cost function. This is a classic linear regression problem (through the origin). A unique solution for $\\hat{K}$ exists provided that not all $x_k$ values are zero, a condition which is met by every dataset in the test suite.\n- **Objectivity**: The problem is stated in precise mathematical terms, devoid of ambiguity, subjective claims, or opinions.\n- **Conclusion**: The problem does not violate any of the invalidity criteria. It is scientifically grounded, well-posed, objective, self-contained, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived and implemented.\n\n### Derivation of the Least Squares Estimator for Stiffness\nThe objective is to find the stiffness estimate, $\\hat{K}$, that minimizes the sum of squared residuals between the measured forces, $F_k$, and the forces predicted by the model, $\\hat{F}_k = \\hat{K} x_k$. We define a cost function, $J(\\hat{K})$, as the sum of squared residuals over $N$ data samples:\n$$J(\\hat{K}) = \\sum_{k=1}^{N} (F_k - \\hat{F}_k)^2 = \\sum_{k=1}^{N} (F_k - \\hat{K} x_k)^2$$\n\nTo find the minimum of this function, we must compute its derivative with respect to $\\hat{K}$ and set the result to zero. This is the necessary condition for an extremum.\n$$\\frac{dJ}{d\\hat{K}} = \\frac{d}{d\\hat{K}} \\left[ \\sum_{k=1}^{N} (F_k - \\hat{K} x_k)^2 \\right]$$\n\nApplying the chain rule for differentiation to each term in the sum:\n$$\\frac{dJ}{d\\hat{K}} = \\sum_{k=1}^{N} 2(F_k - \\hat{K} x_k) \\cdot \\frac{d}{d\\hat{K}}(F_k - \\hat{K} x_k)$$\n$$\\frac{dJ}{d\\hat{K}} = \\sum_{k=1}^{N} 2(F_k - \\hat{K} x_k) \\cdot (-x_k)$$\n$$\\frac{dJ}{d\\hat{K}} = -2 \\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2)$$\n\nSetting the derivative to zero to find the value of $\\hat{K}$ that minimizes $J$:\n$$-2 \\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2) = 0$$\n$$\\sum_{k=1}^{N} (F_k x_k - \\hat{K} x_k^2) = 0$$\n\nWe can separate the sums:\n$$\\sum_{k=1}^{N} F_k x_k - \\sum_{k=1}^{N} \\hat{K} x_k^2 = 0$$\n\nSince $\\hat{K}$ is a constant with respect to the summation index $k$, it can be factored out of the second sum:\n$$\\sum_{k=1}^{N} F_k x_k - \\hat{K} \\sum_{k=1}^{N} x_k^2 = 0$$\n\nSolving for $\\hat{K}$:\n$$\\hat{K} \\sum_{k=1}^{N} x_k^2 = \\sum_{k=1}^{N} F_k x_k$$\nThis yields the final expression for the Least Squares estimate of the stiffness:\n$$\\hat{K} = \\frac{\\sum_{k=1}^{N} F_k x_k}{\\sum_{k=1}^{N} x_k^2}$$\n\nThis formula is robust and directly implementable. It represents the optimal linear estimator in the least-squares sense for the given model. The second derivative, $\\frac{d^2J}{d\\hat{K}^2} = 2 \\sum_{k=1}^{N} x_k^2$, is positive as long as at least one $x_k$ is non-zero, confirming that this solution corresponds to a minimum.\n\nThe implementation will apply this formula to each dataset provided in the test suite. For numerical computation, the numerator is the dot product of the force and displacement vectors, and the denominator is the dot product of the displacement vector with itself.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stiffness K for multiple datasets using the Least Squares method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset 1\n        (np.array([0.005, 0.010, 0.015, 0.020, 0.025]), \n         np.array([7.7, 15.3, 22.3, 29.8, 38.1])),\n        # Dataset 2\n        (np.array([0.000, -0.020, 0.020, -0.010, 0.010]),\n         np.array([0.2, -39.8, 40.4, -19.7, 19.9])),\n        # Dataset 3\n        (np.array([0.000001, -0.000002, 0.000003, -0.000004, 0.000005]),\n         np.array([0.1, -0.2, 0.3, -0.4, 0.5])),\n        # Dataset 4\n        (np.array([0.010, 0.020, 0.030, 0.040, 0.500]),\n         np.array([10.1, 19.6, 28.9, 39.7, 503.0])),\n        # Dataset 5\n        (np.array([0.010, 0.020, 0.030, 0.040, 0.050]),\n         np.array([-10.5, -20.1, -29.8, -40.2, -50.3]))\n    ]\n\n    results = []\n    \n    def estimate_stiffness(x_samples, f_samples):\n        \"\"\"\n        Calculates the stiffness estimate K-hat using the derived LS formula.\n        K_hat = sum(F_k * x_k) / sum(x_k^2)\n        \n        Args:\n            x_samples (np.ndarray): Array of displacement measurements.\n            f_samples (np.ndarray): Array of force measurements.\n        \n        Returns:\n            float: The estimated stiffness K_hat.\n        \"\"\"\n        # The numerator of the LS formula is the dot product of F and x.\n        sum_fx = np.dot(f_samples, x_samples)\n        \n        # The denominator is the dot product of x with itself.\n        sum_x_squared = np.dot(x_samples, x_samples)\n        \n        # Avoid division by zero, although problem constraints ensure this won't happen.\n        if sum_x_squared == 0:\n            return 0.0\n\n        k_hat = sum_fx / sum_x_squared\n        return k_hat\n\n    for x_data, f_data in test_cases:\n        # Calculate the stiffness for the current dataset.\n        k_estimate = estimate_stiffness(x_data, f_data)\n        \n        # Round the result to 3 decimal places as required.\n        # The format string ensures correct representation of numbers like 2000.0\n        rounded_k = round(k_estimate, 3)\n        results.append(f\"{rounded_k:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}