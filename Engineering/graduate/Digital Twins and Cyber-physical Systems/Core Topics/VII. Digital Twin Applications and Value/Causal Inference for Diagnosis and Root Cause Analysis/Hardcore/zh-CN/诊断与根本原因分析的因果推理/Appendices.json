{
    "hands_on_practices": [
        {
            "introduction": "因果推断的基石是理解蕴含在因果图中的关系结构。这个练习  将让你实践 d-分离（d-separation）这一基本技能，它能将图形结构转化为可检验的统计独立性论断。掌握这一概念是区分真实因果联系和虚假相关的关键第一步。",
            "id": "4207427",
            "problem": "一个信息物理生产线的数字孪生被用于诊断振动异常并进行根本原因分析。该孪生的结构因果图是一个有向无环图，包含三个节点，形成一个单链：执行器指令 $A$（上游电机扭矩设定值）、内部动态状态 $B$（轴角加速度）和下游传感器 $C$（末端执行器振动幅度），箭头表示为 $A \\rightarrow B \\rightarrow C$。仅从有向无环图、d-分离和因果马尔可夫性质的定义出发，完成以下任务：\n- 枚举由d-分离所蕴含的 $\\{A,B,C\\}$ 之间所有不同的、非平凡的条件独立关系集合 $\\mathcal{S}$。“非平凡”意味着独立关系的任意一方都不包含另一方，条件集不包含被声明独立的变量，且该陈述不是重言式。\n- 设 $I(A;C \\mid B)$ 表示在任何相对于给定图是马尔可夫的联合分布 $p(A,B,C)$ 下，$A$ 和 $C$ 在给定 $B$ 的条件下的条件互信息（单位为奈特）。计算 $I(A;C \\mid B)$ 的精确值。\n\n将最终答案表示为一个实数。无需四舍五入。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n-   **系统**：一个由数字孪生表示的信息物理生产线。\n-   **因果结构**：一个有向无环图（DAG），包含三个节点：$A$（执行器指令）、$B$（内部动态状态）和 $C$（下游传感器）。\n-   **图拓扑**：一个单链结构：$A \\rightarrow B \\rightarrow C$。\n-   **假设**：解答必须从有向无环图（DAG）、d-分离和因果马尔可夫性质的定义出发。\n-   **任务 1**：枚举由d-分离所蕴含的 $\\{A,B,C\\}$ 之间所有不同的、非平凡的条件独立关系集合 $\\mathcal{S}$。\n-   **“非平凡”的定义**：\n    1.  独立关系的任意一方都不包含另一方。\n    2.  条件集不包含被声明独立的变量。\n    3.  该陈述不是重言式。\n-   **任务 2**：对于任何相对于给定图是马尔可夫的联合分布 $p(A,B,C)$，计算条件互信息 $I(A;C \\mid B)$ 的精确值（单位为奈特）。\n-   **任务 2 的输出要求**：一个实数。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于因果推断（结构因果模型、有向无环图、d-分离）和信息论（互信息）的既定数学形式。这些是统计学、计算机科学和工程学中用于分析数字孪生等系统的标准工具。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。因果图被明确定义（$A \\rightarrow B \\rightarrow C$）。任务陈述清晰，并依赖于标准的、无歧义的定义（d-分离、因果马尔可夫性质、条件互信息）。对“非平凡”关系的约束已提供，确保了第一个任务有唯一答案。第二个任务要求计算一个值，该值是前提条件的直接且必然的推论。存在一个唯一的、稳定的、有意义的解。\n-   **客观性**：语言正式、精确，没有任何主观或模糊的术语。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**，因为它具有科学依据、适定性和客观性。它不包含任何逻辑矛盾、缺失信息或其他致命缺陷。现在开始解答过程。\n\n### 解答推导\n\n按照要求，分两部分解决该问题。\n\n#### 第一部分：枚举条件独立关系\n\n给定的因果结构是一个有向无环图（DAG），表示为链 $A \\rightarrow B \\rightarrow C$。该图所蕴含的条件独立关系由d-分离准则确定。如果节点集 $X$ 中的一个节点与节点集 $Y$ 中的一个节点之间的每条路径都被节点集 $Z$ “阻断”，则称 $X$ 和 $Y$ 被 $Z$ d-分离（记为 $X \\perp_g Y \\mid Z$）。一条路径被阻断，如果它包含：\n1.  一个链 $I \\rightarrow M \\rightarrow J$ 或一个分叉 $I \\leftarrow M \\rightarrow J$，其中中间节点 $M$ 在条件集 $Z$ 中。\n2.  一个对撞结构 $I \\rightarrow M \\leftarrow J$，其中中间节点 $M$ 及其所有后代都**不**在条件集 $Z$ 中。\n\n我们必须测试集合 $\\{A, B, C\\}$ 中所有不同变量对之间的独立性。\n\n-   **变量对 $\\{A, B\\}$**：在 $A$ 和 $B$ 之间有一条路径，即直接边 $A \\rightarrow B$。直接边永远不能被任何不包含 $A$ 或 $B$ 的条件集 $Z$ 阻断。因此，$A$ 和 $B$ 永远不会d-分离。$A \\not\\perp_g B \\mid \\emptyset$ 且 $A \\not\\perp_g B \\mid C$。没有蕴含独立关系。\n\n-   **变量对 $\\{B, C\\}$**：与前一种情况类似，唯一路径是直接边 $B \\rightarrow C$。它不能被任何有效的条件集阻断。因此，$B$ 和 $C$ 永远不会d-分离。$B \\not\\perp_g C \\mid \\emptyset$ 且 $B \\not\\perp_g C \\mid A$。没有蕴含独立关系。\n\n-   **变量对 $\\{A, C\\}$**：在 $A$ 和 $C$ 之间有一条路径：$A \\rightarrow B \\rightarrow C$。这条路径是一个链，中间节点为 $B$。\n    -   **以空集 ($\\emptyset$) 为条件**：条件集为 $Z = \\emptyset$。中间节点 $B$ 不在 $Z$ 中。根据规则1，该路径未被阻断。因此，$A$ 和 $C$ **不**被空集d-分离：$A \\not\\perp_g C \\mid \\emptyset$。\n    -   **以节点 $B$ 为条件**：条件集为 $Z = \\{B\\}$。路径是 $A \\rightarrow B \\rightarrow C$。中间节点 $B$ 在条件集 $Z$ 中。根据规则1，该路径被阻断。由于这是 $A$ 和 $C$ 之间的唯一路径，我们得出结论：$A$ 和 $C$ 被 $B$ d-分离：$A \\perp_g C \\mid B$。\n\n我们找到了一个独立关系：$A \\perp_g C \\mid B$。现在我们根据给定标准检查它是否是“非平凡”的。\n1.  `独立关系的任意一方都不包含另一方`：这两个集合是 $\\{A\\}$ 和 $\\{C\\}$。此条件满足。\n2.  `条件集不包含被声明独立的变量`：条件集是 $\\{B\\}$，它既不包含 $A$ 也不包含 $C$。此条件满足。\n3.  `该陈述不是重言式`：该陈述断言了两个不同变量 $A$ 和 $C$ 之间的独立性，这是一个关于系统结构的非重言式声明。此条件满足。\n\n关系 $A \\perp C \\mid B$ 是该图蕴含的唯一非平凡独立关系。请注意，关系 $C \\perp A \\mid B$ 是相同的。因此，不同、非平凡的条件独立关系集合 $\\mathcal{S}$ 只包含一个元素。\n$\\mathcal{S} = \\{ (A \\perp C \\mid B) \\}$\n\n#### 第二部分：计算条件互信息\n\n第二个任务是计算条件互信息 $I(A; C \\mid B)$ 的值（单位为奈特）。这需要引用因果马尔可夫性质。\n\n**因果马尔可夫性质**指出，对于一个相对于有向无环图 $G$ 是马尔可夫的分布 $p$，如果在 $G$ 中两个节点 $X$ 和 $Y$ 被节点集 $Z$ d-分离（$X \\perp_g Y \\mid Z$），那么在分布 $p$ 中，$X$ 和 $Y$ 在给定 $Z$ 的条件下是条件独立的（$X \\perp_p Y \\mid Z$）。\n\n在第一部分中，我们建立了d-分离关系 $A \\perp_g C \\mid B$。由于给定的分布 $p(A,B,C)$ 相对于图 $A \\rightarrow B \\rightarrow C$ 是马尔可夫的，因果马尔可夫性质蕴含了统计上的条件独立性：\n$$A \\perp C \\mid B$$\n这种统计独立性意味着，在给定 $B$ 的情况下，$A$ 和 $C$ 的联合条件概率可以分解为各自条件概率的乘积：\n$$p(A, C \\mid B) = p(A \\mid B) p(C \\mid B)$$\n\n条件互信息 $I(A; C \\mid B)$ 被定义为联合条件分布 $p(A,C|B)$ 与边际条件分布的乘积 $p(A|B)p(C|B)$ 之间的库尔贝克-莱布勒散度。在连续情况下，其公式（单位为奈特）为：\n$$ I(A; C \\mid B) = \\int p(a,b,c) \\ln\\left( \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} \\right) da \\, db \\, dc $$\n或者，使用条件概率的定义 $p(a,b,c) = p(a,c|b)p(b)$：\n$$ I(A; C \\mid B) = \\int p(b) \\left[ \\int p(a,c|b) \\ln\\left( \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} \\right) da \\, dc \\right] db $$\n由于条件独立性 $A \\perp C \\mid B$，我们有 $p(a, c \\mid b) = p(a \\mid b) p(c \\mid b)$ 对所有值 $a, b, c$ 成立。将此代入对数内的分数得到：\n$$ \\frac{p(a, c \\mid b)}{p(a \\mid b) p(c \\mid b)} = \\frac{p(a \\mid b) p(c \\mid b)}{p(a \\mid b) p(c \\mid b)} = 1 $$\n$1$ 的自然对数为 $0$：\n$$ \\ln(1) = 0 $$\n因此，条件互信息的表达式变为：\n$$ I(A; C \\mid B) = \\int p(a,b,c) \\ln(1) da \\, db \\, dc = \\int p(a,b,c) \\cdot 0 \\, da \\, db \\, dc = 0 $$\n该结果对于任何相对于给定图是马尔可夫的分布 $p(A,B,C)$ 都成立，无论变量是离散的还是连续的，也无论具体的函数关系是什么。条件独立性本身就等价于条件互信息为零。\n\n$I(A; C \\mid B)$ 的精确值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "从理论走向实践，一个核心挑战是如何在存在混杂因素的情况下，利用观测数据计算因果效应。这个练习  提供了一个信息物理系统的具体情境，并指导你应用后门调整公式。这项实践对于量化干预的真实影响至关重要，是有效诊断和决策的基石。",
            "id": "4207465",
            "problem": "一个嵌入在信息物理系统（CPS）中的智能水泵的数字孪生监控着一个二进制执行器设置 $X \\in \\{0,1\\}$ 和一个二进制故障指示器 $Y \\in \\{0,1\\}$。环境条件 $Z$ 取三个离散水平 $Z \\in \\{z_0, z_1, z_2\\}$，代表影响所选执行器设置 $X$ 和故障可能性 $Y$ 的环境模式，这使得 $Z$ 成为 $X \\rightarrow Y$ 关系的一个混杂因子。其因果结构为 $Z$ 有指向 $X$ 和 $Y$ 的有向箭头，并且 $X$ 有指向 $Y$ 的有向箭头。假设相对于 $X$ 对 $Y$ 的因果效应，$Z$ 满足后门准则，并且干预 $do(X=1)$ 对应于将 $X$ 设置为 1，同时保持生成 $Z$ 的机制不变。\n\n在每个环境条件水平下，条件故障概率的观测模型由一个逻辑斯蒂链接指定：\n$$\nP(Y=1 \\mid X=x, Z=z_k) \\;=\\; \\sigma\\!\\left(\\alpha_k + \\beta_k x\\right),\n$$\n其中 $\\sigma(t) = \\frac{1}{1 + \\exp(-t)}$，参数为\n$$\n\\alpha_0 = -2, \\quad \\beta_0 = 0.5; \\qquad \\alpha_1 = -1.5, \\quad \\beta_1 = 0.8; \\qquad \\alpha_2 = -1.0, \\quad \\beta_2 = 0.2.\n$$\n环境条件分布为\n$$\nP(Z=z_0) = 0.2, \\qquad P(Z=z_1) = 0.5, \\qquad P(Z=z_2) = 0.3.\n$$\n\n使用因果推断中干预和后门准则的基本定义，从第一性原理推导出 $P(Y=1 \\mid do(X=1))$ 的表达式，并在给定模型下对其进行数值评估。将最终概率四舍五入至四位有效数字，并以小数形式表示。",
            "solution": "该问题要求计算干预概率 $P(Y=1 \\mid do(X=1))$，它表示如果强制将执行器设置设为 $X=1$ 时，系统发生故障（$Y=1$）的概率。这个量与观测条件概率 $P(Y=1 \\mid X=1)$ 不同，因为后者会受到混杂变量 $Z$（环境条件）的影响。问题陈述了因果结构为 $Z \\rightarrow X$、$Z \\rightarrow Y$ 和 $X \\rightarrow Y$，并且相对于 $X$ 对 $Y$ 的因果效应，$Z$ 满足后门准则。这使我们能够使用后门调整公式从观测数据中计算干预概率。\n\n我们从第一性原理推导这个公式。干预 $do(X=x)$ 对应于修改底层因果系统，即移除所有指向 $X$ 的箭头并将 $X$ 设置为常数值 $x$。在这个修改后的系统中，概率分布表示为 $P_{do(X=x)}(\\cdot)$。我们感兴趣的量是 $P(Y=1 \\mid do(X=1))$，其定义为 $P_{do(X=1)}(Y=1)$。\n\n为了计算这个值，我们可以对混杂变量 $Z$ 进行边缘化：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P_{do(X=x)}(Y=y, Z=z) $$\n根据概率的链式法则，这变成：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P_{do(X=x)}(Y=y \\mid Z=z) P_{do(X=x)}(Z=z) $$\n对 $X$ 的干预不影响生成 $Z$ 的因果机制，因为在因果图中 $Z$ 不是 $X$ 的后代。因此，$Z$ 的分布保持不变：\n$$ P_{do(X=x)}(Z=z) = P(Z=z) $$\n此外，干预 $do(X=x)$ 将 $X$ 的值设为 $x$。从其直接原因 $X$ 和 $Z$ 决定 $Y$ 的机制保持不变。因此，在干预和观测两种情况下，给定 $X$ 和 $Z$ 的条件下 $Y$ 的条件概率是相同的：\n$$ P_{do(X=x)}(Y=y \\mid Z=z) = P(Y=y \\mid X=x, Z=z) $$\n将这两个等价关系代入求和式，得到后门调整公式：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{z} P(Y=y \\mid X=x, Z=z) P(Z=z) $$\n该公式允许通过调整 $Z$ 的混杂效应来估计 $X$ 对 $Y$ 的因果效应。\n\n对于这个具体问题，我们被要求求解 $P(Y=1 \\mid do(X=1))$。我们将公式应用于 $y=1$ 和 $x=1$ 的情况，并对 $Z$ 的三个离散水平 $Z \\in \\{z_0, z_1, z_2\\}$ 进行求和：\n$$ P(Y=1 \\mid do(X=1)) = \\sum_{k=0}^{2} P(Y=1 \\mid X=1, Z=z_k) P(Z=z_k) $$\n展开求和式得到：\n\\begin{align*} P(Y=1 \\mid do(X=1)) =  P(Y=1 \\mid X=1, Z=z_0) P(Z=z_0) \\\\  + P(Y=1 \\mid X=1, Z=z_1) P(Z=z_1) \\\\  + P(Y=1 \\mid X=1, Z=z_2) P(Z=z_2) \\end{align*}\n问题提供了必要的模型组成部分：\n条件概率模型为 $P(Y=1 \\mid X=x, Z=z_k) = \\sigma(\\alpha_k + \\beta_k x)$，其中 $\\sigma(t) = \\frac{1}{1 + \\exp(-t)}$。\n参数为：\n- 对于 $z_0$：$\\alpha_0 = -2$, $\\beta_0 = 0.5$\n- 对于 $z_1$：$\\alpha_1 = -1.5$, $\\beta_1 = 0.8$\n- 对于 $z_2$：$\\alpha_2 = -1.0$, $\\beta_2 = 0.2$\nZ的分布为：\n- $P(Z=z_0) = 0.2$\n- $P(Z=z_1) = 0.5$\n- $P(Z=z_2) = 0.3$\n\n首先，我们计算 $X=1$ 时的条件概率：\n\\begin{itemize}\n    \\item 对于 $Z=z_0$：$P(Y=1 \\mid X=1, Z=z_0) = \\sigma(\\alpha_0 + \\beta_0 \\cdot 1) = \\sigma(-2 + 0.5) = \\sigma(-1.5)$\n    \\item 对于 $Z=z_1$：$P(Y=1 \\mid X=1, Z=z_1) = \\sigma(\\alpha_1 + \\beta_1 \\cdot 1) = \\sigma(-1.5 + 0.8) = \\sigma(-0.7)$\n    \\item 对于 $Z=z_2$：$P(Y=1 \\mid X=1, Z=z_2) = \\sigma(\\alpha_2 + \\beta_2 \\cdot 1) = \\sigma(-1.0 + 0.2) = \\sigma(-0.8)$\n\\end{itemize}\nSigmoid 函数值为：\n\\begin{itemize}\n    \\item $\\sigma(-1.5) = \\frac{1}{1 + \\exp(1.5)}$\n    \\item $\\sigma(-0.7) = \\frac{1}{1 + \\exp(0.7)}$\n    \\item $\\sigma(-0.8) = \\frac{1}{1 + \\exp(0.8)}$\n\\end{itemize}\n现在，我们将这些表达式和 $Z$ 的概率代入调整公式中：\n$$ P(Y=1 \\mid do(X=1)) = \\sigma(-1.5) P(Z=z_0) + \\sigma(-0.7) P(Z=z_1) + \\sigma(-0.8) P(Z=z_2) $$\n$$ P(Y=1 \\mid do(X=1)) = \\left(\\frac{1}{1 + \\exp(1.5)}\\right) (0.2) + \\left(\\frac{1}{1 + \\exp(0.7)}\\right) (0.5) + \\left(\\frac{1}{1 + \\exp(0.8)}\\right) (0.3) $$\n我们进行数值计算：\n\\begin{itemize}\n    \\item $\\exp(1.5) \\approx 4.481689$，所以 $\\sigma(-1.5) \\approx \\frac{1}{1 + 4.481689} \\approx 0.1824255$\n    \\item $\\exp(0.7) \\approx 2.013753$，所以 $\\sigma(-0.7) \\approx \\frac{1}{1 + 2.013753} \\approx 0.3318122$\n    \\item $\\exp(0.8) \\approx 2.225541$，所以 $\\sigma(-0.8) \\approx \\frac{1}{1 + 2.225541} \\approx 0.3099904$\n\\end{itemize}\n代入这些值：\n$$ P(Y=1 \\mid do(X=1)) \\approx (0.1824255)(0.2) + (0.3318122)(0.5) + (0.3099904)(0.3) $$\n$$ P(Y=1 \\mid do(X=1)) \\approx 0.0364851 + 0.1659061 + 0.09299712 $$\n$$ P(Y=1 \\mid do(X=1)) \\approx 0.29538832 $$\n根据要求将最终结果四舍五入到四位有效数字，得到 $0.2954$。",
            "answer": "$$ \\boxed{0.2954} $$"
        },
        {
            "introduction": "在动态系统中，区分预测能力和因果影响至关重要，而这一区别常常被混淆。这个高级练习  展示了一个经典场景：格兰杰因果检验（Granger causality testing）显示存在关联，但使用结构因果模型的严谨分析揭示，由于存在潜在混杂因素，真实的因果效应为零。这凸显了 $do$-算子框架在复杂时间序列数据中进行准确根本原因分析的独特威力。",
            "id": "4207416",
            "problem": "一个信息物理系统 (CPS) 的数字孪生监测两个可观测信号：控制侧测量值 $X_t$ 和性能侧测量值 $Y_t$。两者都受到一个未观测到的环境扰动 $U_t$ 的影响，该扰动演化为一个线性自回归 (AR) 过程。考虑以下平稳线性动态模型和噪声假设：\n- 潜在扰动演化为 $U_t = \\rho U_{t-1} + \\nu_t$，其中 $\\nu_t$ 是独立同分布、零均值、方差为 $\\sigma_{\\nu}^{2}$ 的高斯噪声，且 $|\\rho| < 1$。\n- 观测信号为 $X_t = \\alpha U_t + \\epsilon_t$ 和 $Y_t = \\beta U_t + \\eta_t$，其中 $\\epsilon_t$ 和 $\\eta_t$ 是独立的、零均值、方差分别为 $\\sigma_{X}^{2}$ 和 $\\sigma_{Y}^{2}$ 的高斯噪声。所有新息 $\\nu_t$、$\\epsilon_t$ 和 $\\eta_t$ 在时间上和彼此之间都是相互独立的。系统是平稳的。\n\n一个诊断团队应用格兰杰因果检验来评估 $X$ 是否格兰杰因果于 $Y$，方法是比较仅使用 $Y$ 的过去值和同时使用 $Y$ 和 $X$ 的滞后项来预测 $Y_t$ 时的均方预测误差。在线性高斯平稳性下，这简化为估计 $Y_t$ 基于 $(Y_{t-1}, X_{t-1})$ 的线性最小二乘预测器，并检验乘以 $X_{t-1}$ 的系数；将此系数记为 $\\phi_X$。另外，为了进行结构因果模型 (SCM) 意义上的根本原因分析，该团队使用 do 算子 $do(\\cdot)$ 研究干预响应，并将平均因果效应斜率定义为 $\\frac{d}{dx}\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)]$。\n\n仅从上述模型、平稳性假设以及线性最小二乘预测和 do 算子的基本定义出发，推导：\n1. 在 $Y_t$ 基于 $(Y_{t-1}, X_{t-1})$ 的最佳线性预测器中，乘以 $X_{t-1}$ 的格兰杰预测回归系数 $\\phi_X$ 的精确闭式表达式，用 $\\alpha$、$\\beta$、$\\rho$、$\\sigma_{\\nu}^{2}$、$\\sigma_{X}^{2}$ 和 $\\sigma_{Y}^{2}$ 表示。\n2. 干预平均因果效应斜率 $\\frac{d}{dx}\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)]$ 的精确值。\n\n将你的最终答案报告为一个包含两个条目的行矩阵，第一个是 $\\phi_X$，第二个是干预斜率。不需要数值四舍五入，也不需要单位。",
            "solution": "该问题要求从一个给定的平稳线性动态模型中推导两个不同的量：首先是格兰杰因果分析中的一个预测系数，其次是干预分析中的一个因果效应斜率。我们将依次处理每个部分。\n\n模型由以下方程定义：\n潜在扰动：$U_t = \\rho U_{t-1} + \\nu_t$，其中 $|\\rho|  1$。\n可观测信号：$X_t = \\alpha U_t + \\epsilon_t$ 和 $Y_t = \\beta U_t + \\eta_t$。\n噪声项 $\\nu_t$、$\\epsilon_t$、$\\eta_t$ 是相互独立的零均值高斯过程，其方差分别为 $\\sigma_{\\nu}^{2}$、$\\sigma_{X}^{2}$ 和 $\\sigma_{Y}^{2}$。所有过程都是平稳的且均值为零。\n\n首先，我们确定潜在过程 $U_t$ 的方差。根据平稳性条件，$\\text{Var}(U_t) = \\text{Var}(U_{t-1})$。我们将其表示为 $\\sigma_U^2$。\n从 $U_t$ 的方程，我们有：\n$$\n\\text{Var}(U_t) = \\text{Var}(\\rho U_{t-1} + \\nu_t)\n$$\n因为 $U_{t-1}$ 由 $\\nu$ 的过去值（即 $\\nu_{t-1}, \\nu_{t-2}, \\dots$）决定，所以它与 $\\nu_t$ 独立。因此：\n$$\n\\sigma_U^2 = \\rho^2 \\text{Var}(U_{t-1}) + \\text{Var}(\\nu_t) = \\rho^2 \\sigma_U^2 + \\sigma_{\\nu}^2\n$$\n求解 $\\sigma_U^2$：\n$$\n\\sigma_U^2(1-\\rho^2) = \\sigma_{\\nu}^2 \\implies \\sigma_U^2 = \\frac{\\sigma_{\\nu}^2}{1-\\rho^2}\n$$\n\n**第一部分：格兰杰预测系数 $\\phi_X$ 的推导**\n\n我们寻求 $Y_t$ 基于变量 $Y_{t-1}$ 和 $X_{t-1}$ 的最佳线性预测器中的系数 $\\phi_X$。线性模型为 $\\hat{Y}_t = \\mathbb{E}[Y_t | Y_{t-1}, X_{t-1}] = \\phi_Y Y_{t-1} + \\phi_X X_{t-1}$。系数 $(\\phi_Y, \\phi_X)$ 由正规方程组的解给出：\n$$\n\\begin{pmatrix} \\phi_Y \\\\ \\phi_X \\end{pmatrix} = \\begin{pmatrix} \\text{Var}(Y_{t-1})  \\text{Cov}(Y_{t-1}, X_{t-1}) \\\\ \\text{Cov}(X_{t-1}, Y_{t-1})  \\text{Var}(X_{t-1}) \\end{pmatrix}^{-1} \\begin{pmatrix} \\text{Cov}(Y_{t-1}, Y_t) \\\\ \\text{Cov}(X_{t-1}, Y_t) \\end{pmatrix}\n$$\n我们需要计算所涉及的方差和协方差。由于所有变量均值为零，$\\text{Cov}(A, B) = \\mathbb{E}[AB]$。\n\n1.  **时刻 $t-1$ 预测变量的方差**：\n    $\\text{Var}(X_{t-1}) = \\mathbb{E}[X_{t-1}^2] = \\mathbb{E}[(\\alpha U_{t-1} + \\epsilon_{t-1})^2] = \\alpha^2 \\mathbb{E}[U_{t-1}^2] + \\mathbb{E}[\\epsilon_{t-1}^2] = \\alpha^2 \\sigma_U^2 + \\sigma_X^2$。\n    $\\text{Var}(Y_{t-1}) = \\mathbb{E}[Y_{t-1}^2] = \\mathbb{E}[(\\beta U_{t-1} + \\eta_{t-1})^2] = \\beta^2 \\mathbb{E}[U_{t-1}^2] + \\mathbb{E}[\\eta_{t-1}^2] = \\beta^2 \\sigma_U^2 + \\sigma_Y^2$。\n\n2.  **时刻 $t-1$ 预测变量的协方差**：\n    $\\text{Cov}(X_{t-1}, Y_{t-1}) = \\mathbb{E}[X_{t-1}Y_{t-1}] = \\mathbb{E}[(\\alpha U_{t-1} + \\epsilon_{t-1})(\\beta U_{t-1} + \\eta_{t-1})]$。\n    由于 $U_{t-1}$、$\\epsilon_{t-1}$ 和 $\\eta_{t-1}$ 相互独立，这可以简化为：\n    $\\text{Cov}(X_{t-1}, Y_{t-1}) = \\alpha \\beta \\mathbb{E}[U_{t-1}^2] = \\alpha \\beta \\sigma_U^2$。\n\n3.  **预测变量与目标 $Y_t$ 之间的协方差**：\n    $\\text{Cov}(X_{t-1}, Y_t) = \\mathbb{E}[X_{t-1}Y_t] = \\mathbb{E}[(\\alpha U_{t-1} + \\epsilon_{t-1})(\\beta U_t + \\eta_t)]$。\n    代入 $U_t = \\rho U_{t-1} + \\nu_t$：\n    $= \\mathbb{E}[(\\alpha U_{t-1} + \\epsilon_{t-1})(\\beta(\\rho U_{t-1} + \\nu_t) + \\eta_t)]$。\n    展开并利用 $\\epsilon_{t-1}$、$\\eta_t$、$\\nu_t$ 彼此之间以及与 $U_{t-1}$ 的独立性：\n    $= \\mathbb{E}[\\alpha \\beta \\rho U_{t-1}^2] = \\alpha \\beta \\rho \\sigma_U^2$。\n\n    $\\text{Cov}(Y_{t-1}, Y_t) = \\mathbb{E}[Y_{t-1}Y_t] = \\mathbb{E}[(\\beta U_{t-1} + \\eta_{t-1})(\\beta U_t + \\eta_t)]$。\n    同样，这可以简化为：\n    $= \\mathbb{E}[\\beta^2 \\rho U_{t-1}^2] = \\beta^2 \\rho \\sigma_U^2$。\n\n现在，我们使用克莱姆法则对矩阵方程求解 $\\phi_X$：\n$$\n\\phi_X = \\frac{\\det \\begin{pmatrix} \\text{Var}(Y_{t-1})  \\text{Cov}(Y_{t-1}, Y_t) \\\\ \\text{Cov}(X_{t-1}, Y_{t-1})  \\text{Cov}(X_{t-1}, Y_t) \\end{pmatrix}}{\\det \\begin{pmatrix} \\text{Var}(Y_{t-1})  \\text{Cov}(X_{t-1}, Y_{t-1}) \\\\ \\text{Cov}(X_{t-1}, Y_{t-1})  \\text{Var}(X_{t-1}) \\end{pmatrix}}\n$$\n让我们计算分子和分母的行列式。\n分子 $N$：\n$N = \\text{Var}(Y_{t-1})\\text{Cov}(X_{t-1}, Y_t) - \\text{Cov}(Y_{t-1}, Y_t)\\text{Cov}(X_{t-1}, Y_{t-1})$\n$N = (\\beta^2 \\sigma_U^2 + \\sigma_Y^2)(\\alpha \\beta \\rho \\sigma_U^2) - (\\beta^2 \\rho \\sigma_U^2)(\\alpha \\beta \\sigma_U^2)$\n$N = \\alpha \\beta^3 \\rho (\\sigma_U^2)^2 + \\alpha \\beta \\rho \\sigma_U^2 \\sigma_Y^2 - \\alpha \\beta^3 \\rho (\\sigma_U^2)^2 = \\alpha \\beta \\rho \\sigma_U^2 \\sigma_Y^2$。\n\n分母 $D$：\n$D = \\text{Var}(Y_{t-1})\\text{Var}(X_{t-1}) - (\\text{Cov}(X_{t-1}, Y_{t-1}))^2$\n$D = (\\beta^2 \\sigma_U^2 + \\sigma_Y^2)(\\alpha^2 \\sigma_U^2 + \\sigma_X^2) - (\\alpha \\beta \\sigma_U^2)^2$\n$D = \\alpha^2 \\beta^2 (\\sigma_U^2)^2 + \\beta^2 \\sigma_U^2 \\sigma_X^2 + \\alpha^2 \\sigma_U^2 \\sigma_Y^2 + \\sigma_X^2 \\sigma_Y^2 - \\alpha^2 \\beta^2 (\\sigma_U^2)^2$\n$D = \\sigma_U^2(\\beta^2 \\sigma_X^2 + \\alpha^2 \\sigma_Y^2) + \\sigma_X^2 \\sigma_Y^2$。\n\n所以，$\\phi_X = \\frac{N}{D} = \\frac{\\alpha \\beta \\rho \\sigma_U^2 \\sigma_Y^2}{\\sigma_U^2(\\beta^2 \\sigma_X^2 + \\alpha^2 \\sigma_Y^2) + \\sigma_X^2 \\sigma_Y^2}$。\n代入 $\\sigma_U^2 = \\frac{\\sigma_{\\nu}^2}{1-\\rho^2}$：\n$$\n\\phi_X = \\frac{\\alpha \\beta \\rho \\left(\\frac{\\sigma_{\\nu}^2}{1-\\rho^2}\\right) \\sigma_Y^2}{\\left(\\frac{\\sigma_{\\nu}^2}{1-\\rho^2}\\right)(\\beta^2 \\sigma_X^2 + \\alpha^2 \\sigma_Y^2) + \\sigma_X^2 \\sigma_Y^2}\n$$\n为简化，分子和分母同乘以 $(1-\\rho^2)$：\n$$\n\\phi_X = \\frac{\\alpha \\beta \\rho \\sigma_{\\nu}^2 \\sigma_Y^2}{\\sigma_{\\nu}^2(\\beta^2 \\sigma_X^2 + \\alpha^2 \\sigma_Y^2) + (1-\\rho^2) \\sigma_X^2 \\sigma_Y^2}\n$$\n这是格兰杰预测系数的闭式表达式。如果 $\\alpha$、$\\beta$ 和 $\\rho$ 都不为零，则该系数非零，这表明 $X_{t-1}$ 对 $Y_t$ 具有预测能力，因为它提供了关于潜在状态 $U_{t-1}$ 的信息，而 $U_{t-1}$ 会影响未来状态 $U_t$ 并因此影响 $Y_t$。\n\n**第二部分：干预平均因果效应斜率的推导**\n\n我们需要计算量 $\\frac{d}{dx}\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)]$。do 算子 $do(V=v)$ 代表一种干预，它通过切断所有指向变量 $V$ 的因果箭头，将变量 $V$ 设定为值 $v$。\n\n原始结构因果模型 (SCM) 包含方程 $X_{t-1} = \\alpha U_{t-1} + \\epsilon_{t-1}$。干预 $do(X_{t-1}=x)$ 将该方程替换为 $X_{t-1}=x$。这切断了因果链 $U_{t-1} \\to X_{t-1}$。\n在此干预下，控制变量的修正方程组为：\n1.  $U_t = \\rho U_{t-1} + \\nu_t$\n2.  $X_{t-1} = x$\n3.  $Y_t = \\beta U_t + \\eta_t$\n\n其他变量，特别是 $U_{t-1}$，仍由其原始因果机制决定。在因果图中，$U_{t-1}$ 是 $X_{t-1}$ 的父节点。对一个变量进行干预不影响其父节点或其他祖先节点。因此，$U_{t-1}$ 的分布不受对 $X_{t-1}$ 的干预的影响。它仍由其无条件的平稳分布描述。\n\n我们现在计算在这个修正系统中 $Y_t$ 的期望：\n$$\n\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)] = \\mathbb{E}[\\beta U_t + \\eta_t \\mid do(X_{t-1}=x)]\n$$\n利用期望的线性性质：\n$$\n= \\beta \\mathbb{E}[U_t \\mid do(X_{t-1}=x)] + \\mathbb{E}[\\eta_t \\mid do(X_{t-1}=x)]\n$$\n噪声项 $\\eta_t$ 是外生的，且与所有其他变量以及在先前时间步的任何干预都独立。因此，$\\mathbb{E}[\\eta_t \\mid do(X_{t-1}=x)] = \\mathbb{E}[\\eta_t] = 0$。\n现在考虑 $\\mathbb{E}[U_t \\mid do(X_{t-1}=x)]$：\n$$\n\\mathbb{E}[U_t \\mid do(X_{t-1}=x)] = \\mathbb{E}[\\rho U_{t-1} + \\nu_t \\mid do(X_{t-1}=x)]\n$$\n$$\n= \\rho \\mathbb{E}[U_{t-1} \\mid do(X_{t-1}=x)] + \\mathbb{E}[\\nu_t \\mid do(X_{t-1}=x)]\n$$\n与 $\\eta_t$ 一样，$\\nu_t$ 是外生的，$\\mathbb{E}[\\nu_t \\mid do(X_{t-1}=x)] = \\mathbb{E}[\\nu_t] = 0$。\n如前所述，对 $X_{t-1}$ 的干预不影响其父节点 $U_{t-1}$。因此，$U_{t-1}$ 的期望是其无条件均值：\n$$\n\\mathbb{E}[U_{t-1} \\mid do(X_{t-1}=x)] = \\mathbb{E}[U_{t-1}]\n$$\n由于过程是平稳且零均值的，$\\mathbb{E}[U_{t-1}]=0$。\n综合所有部分：\n$$\n\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)] = \\beta (\\rho \\cdot 0 + 0) + 0 = 0\n$$\n在干预下，$Y_t$ 的期望值为 $0$，无论 $X_{t-1}$ 被设定的值 $x$ 是多少。干预期望是 $x$ 的常数函数。\n\n平均因果效应斜率是该期望对 $x$ 的导数：\n$$\n\\frac{d}{dx}\\mathbb{E}[Y_t \\mid do(X_{t-1}=x)] = \\frac{d}{dx}(0) = 0\n$$\n因果效应为零，因为从 $X_{t-1}$ 到 $Y_t$ 没有直接或间接的因果路径。格兰杰因果检验检测到的统计关联完全是由于混淆变量 $U_{t-1}$，它是 $X_{t-1}$ 和未来值 $Y_t$（通过 $U_t$）的共同原因。\n\n最终答案是 $\\phi_X$ 的表达式和干预斜率的值 $0$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha \\beta \\rho \\sigma_{\\nu}^2 \\sigma_Y^2}{\\sigma_{\\nu}^2(\\beta^2 \\sigma_X^2 + \\alpha^2 \\sigma_Y^2) + (1-\\rho^2) \\sigma_X^2 \\sigma_Y^2}  0 \\end{pmatrix}}\n$$"
        }
    ]
}