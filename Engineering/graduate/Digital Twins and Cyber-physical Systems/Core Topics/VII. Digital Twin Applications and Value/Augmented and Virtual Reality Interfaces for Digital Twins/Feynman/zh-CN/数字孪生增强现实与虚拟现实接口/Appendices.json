{
    "hands_on_practices": [
        {
            "introduction": "任何AR体验的第一步都是建立数字孪生与物理环境之间的初始空间关系。这个过程通常依赖于找到两组对应点之间的最佳刚体变换，例如将孪生模型的顶点与物理世界中可识别的基准点进行匹配。本练习将指导你从第一性原理出发，推导出一个经典的最小二乘估计器，以解决这一基础性的点集配准问题。",
            "id": "4206803",
            "problem": "在一个用于数字孪生的增强现实（AR）和虚拟现实（VR）界面中，头戴设备在世界坐标系 $\\mathcal{W}$ 中跟踪物理基准标记，并在孪生坐标系 $\\mathcal{T}$ 中渲染虚拟网格。为了将孪生体精确地叠加到物理场景上，需要估计一个刚体变换 $T_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$，该变换将点从 $\\mathcal{T}$ 映射到 $\\mathcal{W}$。假设给定 $n \\geq 3$ 个已知对应点 $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$，其中每个 $x_i^{\\mathcal{W}} \\in \\mathbb{R}^{3}$ 是在 $\\mathcal{W}$ 中测量的基准点位置，每个 $x_i^{\\mathcal{T}} \\in \\mathbb{R}^{3}$ 是孪生体网格中相应顶点在 $\\mathcal{T}$ 中的位置。测量模型为 $x_i^{\\mathcal{W}} = R x_i^{\\mathcal{T}} + t + \\varepsilon_i$，其中 $R \\in \\mathrm{SO}(3)$，$t \\in \\mathbb{R}^{3}$，且噪声 $\\varepsilon_i$ 为零均值、具有有限二阶矩，在 $i$ 上独立，并且独立于 $x_i^{\\mathcal{T}}$。可以假设对应关系是正确且固定的。\n\n从基于欧几里得范数和刚体约束的约束最小二乘公式出发，根据第一性原理，推导最小二乘估计量 $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ 关于给定对应点的闭式解析表达式。你必须：\n- 从刚体变换、欧几里得范数和基本矩阵恒等式的定义开始，通过逻辑上消除平移并将旋转子问题简化为可在 $\\mathrm{SO}(3)$ 上使用奇异值分解求解的优化问题。\n- 清晰地展示导出估计器最终解析形式的推导步骤。\n- 陈述解在 $\\mathrm{SE}(3)$ 中具有可辨识性和唯一性所需的最小假设。\n\n使用 $4 \\times 4$ 齐次坐标，将最终答案表示为 $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ 的单个闭式解析表达式。不需要进行数值舍入。",
            "solution": "该问题要求推导在两组 $n$ 个对应的三维点 $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$ 之间的刚体变换 $T_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$ 的闭式最小二乘估计量。该变换将点从孪生坐标系 $\\mathcal{T}$ 映射到世界坐标系 $\\mathcal{W}$。\n\n刚体变换由一个旋转 $R \\in \\mathrm{SO}(3)$ 和一个平移 $t \\in \\mathbb{R}^{3}$ 组成。一个点 $x^{\\mathcal{T}}$ 通过规则 $x^{\\mathcal{W}} = R x^{\\mathcal{T}} + t$ 映射到 $x^{\\mathcal{W}}$。给定测量模型 $x_i^{\\mathcal{W}} = R x_i^{\\mathcal{T}} + t + \\varepsilon_i$，最小二乘估计问题旨在找到使残差的欧几里得范数平方和最小化的变换 $(\\hat{R}, \\hat{t})$。目标函数 $E(R, t)$ 为：\n$$E(R, t) = \\sum_{i=1}^{n} \\| x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + t) \\|^2$$\n此优化受限于条件 $R$ 必须是一个真旋转矩阵，即 $R \\in \\mathrm{SO}(3)$，这意味着 $R^T R = I$ 且 $\\det(R) = +1$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n\n推导过程分为两个主要阶段：首先，我们求解平移 $t$，其次，我们求解旋转 $R$。\n\n首先，对于固定的 $R$，我们通过最小化 $E(R, t)$ 来找到最优平移 $\\hat{t}$。我们计算 $E(R, t)$ 关于 $t$ 的偏导数并将其设为零。\n$$ \\frac{\\partial E}{\\partial t} = \\frac{\\partial}{\\partial t} \\sum_{i=1}^{n} (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t)^T (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t) = 0 $$\n$$ \\sum_{i=1}^{n} -2(x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}} - t) = 0 $$\n$$ \\sum_{i=1}^{n} t = \\sum_{i=1}^{n} (x_i^{\\mathcal{W}} - R x_i^{\\mathcal{T}}) $$\n$$ n t = \\sum_{i=1}^{n} x_i^{\\mathcal{W}} - R \\sum_{i=1}^{n} x_i^{\\mathcal{T}} $$\n我们定义两个点集的质心为 $\\bar{x}^{\\mathcal{W}} = \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{W}}$ 和 $\\bar{x}^{\\mathcal{T}} = \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{T}}$。最优平移 $\\hat{t}$ 于是可以表示为旋转 $R$ 的函数：\n$$ \\hat{t} = \\bar{x}^{\\mathcal{W}} - R \\bar{x}^{\\mathcal{T}} $$\n这个结果表明，变换后的点 $R x_i^{\\mathcal{T}}$ 的质心加上平移必须与测量点 $x_i^{\\mathcal{W}}$ 的质心对齐。\n\n接下来，我们将 $\\hat{t}$ 的这个表达式代回目标函数，得到一个只依赖于 $R$ 的问题。\n$$ x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + \\hat{t}) = x_i^{\\mathcal{W}} - (R x_i^{\\mathcal{T}} + \\bar{x}^{\\mathcal{W}} - R \\bar{x}^{\\mathcal{T}}) $$\n$$ = (x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}}) - R(x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}) $$\n我们为每个点集定义中心化坐标：$y'_i = x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}}$ 和 $x'_i = x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}$。目标函数变为：\n$$ E(R) = \\sum_{i=1}^{n} \\| y'_i - R x'_i \\|^2 $$\n我们必须找到最小化这个新目标函数的旋转 $\\hat{R}$。让我们展开范数的平方：\n$$ E(R) = \\sum_{i=1}^{n} (y'_i - R x'_i)^T (y'_i - R x'_i) $$\n$$ = \\sum_{i=1}^{n} ((y'_i)^T y'_i - (y'_i)^T R x'_i - (R x'_i)^T y'_i + (R x'_i)^T R x'_i) $$\n由于 $(y'_i)^T R x'_i$ 是一个标量，它等于其转置 $(R x'_i)^T y'_i$。此外，由于 $R \\in \\mathrm{SO}(3)$，我们有 $R^T R = I$，所以 $(R x'_i)^T R x'_i = (x'_i)^T R^T R x'_i = (x'_i)^T I x'_i = (x'_i)^T x'_i$。该表达式简化为：\n$$ E(R) = \\sum_{i=1}^{n} (\\|y'_i\\|^2 + \\|x'_i\\|^2 - 2 (y'_i)^T R x'_i) $$\n项 $\\sum_{i=1}^{n} \\|y'_i\\|^2$ 和 $\\sum_{i=1}^{n} \\|x'_i\\|^2$ 不依赖于 $R$。因此，最小化 $E(R)$ 等价于最大化项 $\\sum_{i=1}^{n} (y'_i)^T R x'_i$。\n使用迹算子及其循环性质 $\\mathrm{Tr}(ABC) = \\mathrm{Tr}(BCA)$，我们可以重写目标。由于 $(y'_i)^T R x'_i$ 是一个标量（$1 \\times 1$ 矩阵），它等于其自身的迹。\n$$ \\sum_{i=1}^{n} (y'_i)^T R x'_i = \\sum_{i=1}^{n} \\mathrm{Tr}((y'_i)^T R x'_i) = \\sum_{i=1}^{n} \\mathrm{Tr}(R x'_i (y'_i)^T) $$\n根据迹的线性性质，这等于：\n$$ \\mathrm{Tr} \\left( R \\sum_{i=1}^{n} x'_i (y'_i)^T \\right) $$\n我们定义 $3 \\times 3$ 协方差矩阵 $H = \\sum_{i=1}^{n} x'_i (y'_i)^T$。旋转估计问题现在简化为：\n$$ \\hat{R} = \\arg\\max_{R \\in \\mathrm{SO}(3)} \\mathrm{Tr}(R H) $$\n为了解决这个最大化问题，我们使用 $H$ 的奇异值分解（SVD）。设 $H = U \\Sigma V^T$，其中 $U, V \\in \\mathrm{O}(3)$ 是正交矩阵，$\\Sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$ 是一个由非负奇异值组成的对角矩阵，按 $\\sigma_1 \\geq \\sigma_2 \\geq \\sigma_3 \\geq 0$ 排序。\n将 $H$ 的 SVD 代入迹表达式中：\n$$ \\mathrm{Tr}(R H) = \\mathrm{Tr}(R U \\Sigma V^T) $$\n再次使用迹的循环性质：\n$$ \\mathrm{Tr}(R U \\Sigma V^T) = \\mathrm{Tr}(\\Sigma V^T R U) $$\n设 $M = V^T R U$。由于 $V^T$、$R$ 和 $U$ 都是正交矩阵，它们的乘积 $M$ 也是一个正交矩阵（$M \\in \\mathrm{O}(3)$）。问题就变成了最大化 $\\mathrm{Tr}(\\Sigma M) = \\sum_{j=1}^{3} \\sigma_j M_{jj}$。因为 $M$ 是正交的，它的列向量是单位向量，这意味着它的元素满足 $|M_{jk}| \\leq 1$。为了在 $\\sigma_j$ 非负的情况下最大化这个和，我们需要使对角元素 $M_{jj}$ 尽可能大。每个 $M_{jj}$ 的最大可能值为 $1$，这在 $M$ 是单位矩阵 $M=I$ 时发生。\n如果 $M=I$，那么 $V^T \\hat{R} U = I$，这就给出了一个候选的旋转解：\n$$ \\hat{R} = V I U^T = V U^T $$\n但是，我们必须满足约束条件 $\\hat{R} \\in \\mathrm{SO}(3)$，这要求 $\\det(\\hat{R}) = +1$。SVD 矩阵 $U$ 和 $V$ 属于 $\\mathrm{O}(3)$，所以它们的行列式可以是 $+1$ 或 $-1$。\n我们有 $\\det(\\hat{R}) = \\det(V U^T) = \\det(V) \\det(U^T) = \\det(V) \\det(U)$。\n如果 $\\det(V)\\det(U) = +1$，那么 $\\hat{R} = V U^T$ 是一个有效的旋转，并且是最佳解。\n如果 $\\det(V)\\det(U) = -1$，那么 $\\det(\\hat{R}) = -1$。这个解代表一个反射，而不是一个真旋转。必须找到在 $\\mathrm{SO}(3)$ 上的真正最大值。在这种情况下，在 $\\det(M) = -1$ 的约束下，$\\mathrm{Tr}(\\Sigma M)$ 的最大值在 $M = \\mathrm{diag}(1, 1, -1)$ 时达到，这使得与最小奇异值 $\\sigma_3$ 相关的项变为负。迹变为 $\\sigma_1 + \\sigma_2 - \\sigma_3$，这是在反射约束下的最大可能值。\n这得到 $V^T \\hat{R} U = \\mathrm{diag}(1, 1, -1)$。修正后的旋转为：\n$$ \\hat{R} = V \\, \\mathrm{diag}(1, 1, -1) \\, U^T $$\n我们可以将两种情况统一为一个表达式。设 $S = \\mathrm{diag}(1, 1, \\det(V U^T))$。那么最优旋转总是由 $\\hat{R} = V S U^T$ 给出。\n\n解 $\\hat{T}_{\\mathcal{W}\\mathcal{T}} \\in \\mathrm{SE}(3)$ 具有可辨识性和唯一性的最小假设是：\n$1$。对应点的数量必须为 $n \\geq 3$。\n$2$。对应点 $\\{x_i^\\mathcal{T}\\}_{i=1}^n$ 必须不共线。如果它们共线，协方差矩阵 $H$ 的秩最多为 $1$，旋转无法唯一确定（存在围绕共线轴的旋转不确定性）。如果点不共线，则变换是唯一的。为了获得一个鲁棒的解，其中所有旋转自由度都受到数据的良好约束，这些点应该不共面，这确保了 $H$ 是满秩的（秩为 $3$）。\n\n总而言之，闭式解通过以下步骤找到：\n$1$。计算质心 $\\bar{x}^{\\mathcal{T}}$ 和 $\\bar{x}^{\\mathcal{W}}$。\n$2$。计算协方差矩阵 $H = \\sum_{i=1}^{n} (x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}})(x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}})^T$。\n$3$。对 $H$ 进行 SVD 分解得到 $H=U \\Sigma V^T$。\n$4$。计算最优旋转 $\\hat{R} = V \\, \\mathrm{diag}(1, 1, \\det(V U^T)) \\, U^T$。\n$5$。计算最优平移 $\\hat{t} = \\bar{x}^{\\mathcal{W}} - \\hat{R} \\bar{x}^{\\mathcal{T}}$。\n$6$。组装齐次变换矩阵 $\\hat{T}_{\\mathcal{W}\\mathcal{T}}$。\n\n$\\hat{T}_{\\mathcal{W}\\mathcal{T}}$ 的最终表达式结合了这些结果。根据输入的对应点 $\\{(x_i^{\\mathcal{W}}, x_i^{\\mathcal{T}})\\}_{i=1}^{n}$ 定义以下量：\n- 质心：$\\bar{x}^{\\mathcal{T}} = \\frac{1}{n} \\sum_{i=1}^{n} x_i^{\\mathcal{T}}$ 和 $\\bar{x}^{\\mathcal{W}} = \\frac{1}{n} \\sum_{i=1}^{n} x_i^{\\mathcal{W}}$。\n- 协方差矩阵：$H = \\sum_{i=1}^{n} (x_i^{\\mathcal{T}} - \\bar{x}^{\\mathcal{T}}) (x_i^{\\mathcal{W}} - \\bar{x}^{\\mathcal{W}})^T$。\n- $H$ 的 SVD 分解：$H = U \\Sigma V^T$。\n- 用于反射校正的矩阵：$S = \\mathrm{diag}(1, 1, \\det(V U^T))$。\n\n根据这些定义，最优旋转和平移分别由 $\\hat{R} = V S U^T$ 和 $\\hat{t} = \\bar{x}^{\\mathcal{W}} - \\hat{R} \\bar{x}^{\\mathcal{T}}$ 给出。\n最终的齐次坐标变换为：\n$$ \\hat{T}_{\\mathcal{W}\\mathcal{T}} = \\begin{pmatrix} \\hat{R} & \\hat{t} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix} = \\begin{pmatrix} V S U^T & \\bar{x}^{\\mathcal{W}} - (V S U^T) \\bar{x}^{\\mathcal{T}} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix} $$\n其中 $\\mathbf{0}^T$ 是一个 $1 \\times 3$ 的零行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} V \\mathrm{diag}(1, 1, \\det(V U^T)) U^T & \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{W}} - (V \\mathrm{diag}(1, 1, \\det(V U^T)) U^T) \\frac{1}{n}\\sum_{i=1}^{n} x_i^{\\mathcal{T}} \\\\ \\mathbf{0}^T & 1 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实现初始对齐后，AR系统需要通过连续跟踪用户的视角来维持对齐。然而，任何跟踪系统都存在微小的误差，这些三维空间中的姿态误差会直接影响屏幕上的二维视觉效果。本练习将让你深入分析这种敏感性，通过推导一个一阶模型来量化微小的相机旋转和平移误差如何转化为最终渲染图像上的像素级重投影误差。",
            "id": "4206845",
            "problem": "一个机械臂的数字孪生 (DT) 正通过一个使用已标定的针孔相机模型的增强现实 (AR) 和虚拟现实 (VR) 接口进行可视化。世界坐标系到相机坐标系的刚体变换由一个旋转矩阵 $R \\in \\mathrm{SO}(3)$ 和一个平移向量 $t \\in \\mathbb{R}^{3}$ 指定，相机内参由下式给出\n$$\nK \\;=\\; \\begin{pmatrix}\nf_{x} & 0 & c_{x}\\\\\n0 & f_{y} & c_{y}\\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\n其中焦距为 $f_{x}, f_{y}$，主点为 $(c_{x}, c_{y})$。一个在世界坐标系中的孪生顶点为 $\\mathbf{x}_{\\mathcal{W}} \\in \\mathbb{R}^{3}$，其相机坐标由刚体变换 $\\mathbf{x}_{\\mathcal{C}} = R\\,\\mathbf{x}_{\\mathcal{W}} + t$ 给出。针孔投影通过对 $\\mathbf{x}_{\\mathcal{C}} = (X, Y, Z)^{\\top}$ 进行归一化并应用内参来定义像素坐标 $(u,v)$：\n$$\nu \\;=\\; f_{x}\\,\\frac{X}{Z} + c_{x}, \\quad v \\;=\\; f_{y}\\,\\frac{Y}{Z} + c_{y}.\n$$\n在实践中，数字孪生与 AR/VR 相机之间配准时存在的微小位姿误差会导致未对准。将微小旋转误差建模为 $\\delta R \\approx \\exp\\!\\big([\\delta \\boldsymbol{\\theta}]_{\\times}\\big)$，其中 $\\delta \\boldsymbol{\\theta} \\in \\mathbb{R}^{3}$，$[\\cdot]_{\\times}$ 表示 $3 \\times 3$ 的斜对称矩阵，使得 $[\\mathbf{a}]_{\\times}\\,\\mathbf{b} = \\mathbf{a} \\times \\mathbf{b}$；并将微小平移误差建模为 $\\delta \\mathbf{t} \\in \\mathbb{R}^{3}$。假设旋转误差为右乘形式 $R' = R\\,\\delta R$，平移误差为加性形式 $t' = t + \\delta \\mathbf{t}$，因此受扰动的相机坐标为 $\\mathbf{x}_{\\mathcal{C}}' = R'\\,\\mathbf{x}_{\\mathcal{W}} + t'$。使用对微小 $\\delta \\boldsymbol{\\theta}$ 有效的一阶近似，从第一性原理出发，推导像素坐标的一阶扰动 $\\delta \\mathbf{p} = (\\delta u, \\delta v)^{\\top}$，该扰动应表示为 $R$, $\\mathbf{x}_{\\mathcal{W}}$, $t$, $\\delta \\boldsymbol{\\theta}$, $\\delta \\mathbf{t}$ 以及内参 $f_{x}, f_{y}$ 和标称相机坐标 $(X, Y, Z)$ 的函数。\n\n您的推导必须从刚体运动学和针孔相机归一化开始，然后对旋转误差使用指数映射的一阶线性化。将最终答案表示为仅依赖于上述定义量的 $\\delta \\mathbf{p}$ 的单个闭式解析表达式。无需进行数值计算或四舍五入。最终表达式中不应包含任何单位。",
            "solution": "该问题要求推导由相机位姿的微小误差引起的像素坐标的一阶扰动，记为 $\\delta \\mathbf{p} = (\\delta u, \\delta v)^{\\top}$。推导将从第一性原理出发，始于刚体变换的运动学和针孔投影模型。\n\n令 $\\mathbf{x}_{\\mathcal{W}} \\in \\mathbb{R}^{3}$ 为世界坐标系中的一个顶点。到相机坐标系的标称变换由旋转矩阵 $R \\in \\mathrm{SO}(3)$ 和平移向量 $t \\in \\mathbb{R}^{3}$ 给出。该点在相机坐标系中的标称坐标 $\\mathbf{x}_{\\mathcal{C}} = (X, Y, Z)^{\\top}$ 为：\n$$\n\\mathbf{x}_{\\mathcal{C}} = R\\,\\mathbf{x}_{\\mathcal{W}} + t\n$$\n\n针孔相机模型将 $\\mathbf{x}_{\\mathcal{C}}$ 投影到像平面上，生成像素坐标 $\\mathbf{p} = (u, v)^{\\top}$：\n$$\nu = f_{x}\\,\\frac{X}{Z} + c_{x}\n$$\n$$\nv = f_{y}\\,\\frac{Y}{Z} + c_{y}\n$$\n其中 $f_{x}$、$f_{y}$ 是焦距，$(c_{x}, c_{y})$ 是主点，均由相机内参矩阵 $K$ 给出。\n\n相机位姿存在微小误差。受扰动的旋转矩阵为 $R' = R\\,\\delta R$，受扰动的平移向量为 $t' = t + \\delta \\mathbf{t}$。微小旋转 $\\delta R$ 使用从李代数 $\\mathfrak{so}(3)$ 到李群 $\\mathrm{SO}(3)$ 的指数映射进行建模，其中 $\\delta \\boldsymbol{\\theta} \\in \\mathbb{R}^3$ 是一个微小旋转向量。其一阶近似为：\n$$\n\\delta R = \\exp([\\delta \\boldsymbol{\\theta}]_{\\times}) \\approx I + [\\delta \\boldsymbol{\\theta}]_{\\times}\n$$\n其中 $I$ 是 $3 \\times 3$ 单位矩阵，$[\\delta \\boldsymbol{\\theta}]_{\\times}$ 是对应于 $\\delta \\boldsymbol{\\theta}$ 的斜对称矩阵。\n\n第一步是求相机坐标的一阶扰动 $\\delta \\mathbf{x}_{\\mathcal{C}}$。受扰动的坐标 $\\mathbf{x}_{\\mathcal{C}}'$ 由下式给出：\n$$\n\\mathbf{x}_{\\mathcal{C}}' = R'\\,\\mathbf{x}_{\\mathcal{W}} + t' = (R\\,\\delta R)\\,\\mathbf{x}_{\\mathcal{W}} + (t + \\delta \\mathbf{t})\n$$\n代入 $\\delta R$ 的一阶近似：\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx R(I + [\\delta \\boldsymbol{\\theta}]_{\\times})\\,\\mathbf{x}_{\\mathcal{W}} + t + \\delta \\mathbf{t}\n$$\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx R\\,\\mathbf{x}_{\\mathcal{W}} + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + t + \\delta \\mathbf{t}\n$$\n通过对各项进行分组，我们可以识别出标称坐标 $\\mathbf{x}_{\\mathcal{C}}$：\n$$\n\\mathbf{x}_{\\mathcal{C}}' \\approx (R\\,\\mathbf{x}_{\\mathcal{W}} + t) + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} = \\mathbf{x}_{\\mathcal{C}} + R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t}\n$$\n扰动 $\\delta \\mathbf{x}_{\\mathcal{C}}$ 是差值 $\\mathbf{x}_{\\mathcal{C}}' - \\mathbf{x}_{\\mathcal{C}}$。其一阶近似为：\n$$\n\\delta \\mathbf{x}_{\\mathcal{C}} = \\mathbf{x}_{\\mathcal{C}}' - \\mathbf{x}_{\\mathcal{C}} \\approx R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t}\n$$\n令 $\\delta \\mathbf{x}_{\\mathcal{C}} = (\\delta X, \\delta Y, \\delta Z)^{\\top}$。\n\n第二步是将相机坐标的扰动 $\\delta \\mathbf{x}_{\\mathcal{C}}$ 与像素坐标的扰动 $\\delta \\mathbf{p}$ 联系起来。我们使用投影函数 $\\mathbf{p}(\\mathbf{x}_{\\mathcal{C}})$ 在标称点 $\\mathbf{x}_{\\mathcal{C}}$ 附近的一阶泰勒展开：\n$$\n\\delta \\mathbf{p} \\approx \\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{x}_{\\mathcal{C}}} \\delta \\mathbf{x}_{\\mathcal{C}}\n$$\n项 $\\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{x}_{\\mathcal{C}}}$ 是投影函数的雅可比矩阵，我们将其记为 $J_{proj}$。\n$$\nJ_{proj} = \\begin{pmatrix} \\frac{\\partial u}{\\partial X} & \\frac{\\partial u}{\\partial Y} & \\frac{\\partial u}{\\partial Z} \\\\ \\frac{\\partial v}{\\partial X} & \\frac{\\partial v}{\\partial Y} & \\frac{\\partial v}{\\partial Z} \\end{pmatrix}\n$$\n我们从投影方程计算偏导数：\n$$\n\\frac{\\partial u}{\\partial X} = \\frac{f_{x}}{Z} \\quad , \\quad \\frac{\\partial u}{\\partial Y} = 0 \\quad , \\quad \\frac{\\partial u}{\\partial Z} = -f_{x}\\frac{X}{Z^{2}}\n$$\n$$\n\\frac{\\partial v}{\\partial X} = 0 \\quad , \\quad \\frac{\\partial v}{\\partial Y} = \\frac{f_{y}}{Z} \\quad , \\quad \\frac{\\partial v}{\\partial Z} = -f_{y}\\frac{Y}{Z^{2}}\n$$\n将这些偏导数代入雅可比矩阵：\n$$\nJ_{proj} = \\begin{pmatrix}\n\\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\\n0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}}\n\\end{pmatrix}\n$$\n这可以更紧凑地重写为：\n$$\nJ_{proj} = \\begin{pmatrix} f_x & 0 \\\\ 0 & f_y \\end{pmatrix} \\begin{pmatrix} \\frac{1}{Z} & 0 & -\\frac{X}{Z^2} \\\\ 0 & \\frac{1}{Z} & -\\frac{Y}{Z^2} \\end{pmatrix}\n$$\n\n最后，我们结合结果来求 $\\delta \\mathbf{p}$ 的表达式。我们将 $J_{proj}$ 和 $\\delta \\mathbf{x}_{\\mathcal{C}}$ 的表达式代入泰勒展开 $\\delta \\mathbf{p} \\approx J_{proj} \\delta \\mathbf{x}_{\\mathcal{C}}$：\n$$\n\\delta \\mathbf{p} \\approx \\begin{pmatrix}\n\\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\\n0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}}\n\\end{pmatrix} \\left( R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} \\right)\n$$\n该表达式提供了像素坐标的一阶扰动 $\\delta \\mathbf{p}$，其是相机内参（$f_x, f_y$）、标称状态（通过 $X, Y, Z$ 表示的 $R, \\mathbf{x}_{\\mathcal{W}}, t$）和微小位姿误差（$\\delta \\boldsymbol{\\theta}, \\delta \\mathbf{t}$）的函数。这就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{f_{x}}{Z} & 0 & -f_{x}\\frac{X}{Z^{2}} \\\\ 0 & \\frac{f_{y}}{Z} & -f_{y}\\frac{Y}{Z^{2}} \\end{pmatrix} \\left( R[\\delta \\boldsymbol{\\theta}]_{\\times}\\,\\mathbf{x}_{\\mathcal{W}} + \\delta \\mathbf{t} \\right)}\n$$"
        },
        {
            "introduction": "除了瞬时跟踪误差外，长期的累积误差（如尺度漂移）对维持AR叠加的保真度构成了更大的挑战，尤其是在使用单目SLAM系统的头戴设备中。本练习模拟了一个真实场景，其中SLAM系统估计的尺度会随时间推移而偏离真实世界。你将学习如何利用数字孪生本身固有的精确度量信息作为“标尺”，来诊断并校正这种漂移，从而确保AR体验的长期稳定性。",
            "id": "4206827",
            "problem": "一个带有单目摄像头的增强现实头戴设备，用于将机器人单元的数字孪生叠加到物理环境中。该头戴设备运行一个单目即时定位与地图构建 (SLAM) 系统，该系统提供相机位姿和稀疏地图，二者都仅能确定到一个未知的全局相似性变换。数字孪生包含一个具有米制精确尺寸的计算机辅助设计 (CAD) 模型。叠加效果是通过将 SLAM 地图与 CAD 模型对齐来生成的。\n\n使用以下基本事实和定义：\n- 在投影相机模型中，世界点 $X$ 的图像坐标 $x$ 满足 $x \\sim K [R \\mid t] X$，其中 $K$ 是内参矩阵，$R \\in \\mathrm{SO}(3)$ 是一个旋转，$t \\in \\mathbb{R}^3$ 是一个平移。\n- 对于单目系统，从图像中恢复的结构和运动只能确定到一个未知的全局相似性变换，即一个三元组 $\\{ s, R_0, t_0 \\}$，其中 $s \\in \\mathbb{R}^+$，$R_0 \\in \\mathrm{SO}(3)$，$t_0 \\in \\mathbb{R}^3$；特别地，在没有米制先验的情况下，绝对米制尺度 $s$ 从单个单目序列中是不可观察的。\n- 尺度漂移指在单目 SLAM 流程中，由于估计噪声随时间累积，导致的全局尺度 $s$ 估计值的逐渐误差。\n\n假设该头戴设备必须在直径为 $D$ 米的工作空间内保持亚厘米级的叠加精度，并且 CAD 模型提供了可识别特征之间米制精确的基线。在某次会话中，SLAM 地图点和 CAD 特征之间匹配了 $M = 3$ 对特征，从而提供了来自 CAD 的米制基线以及它们在当前 SLAM 地图坐标系中的对应距离。已知的 CAD 基线长度（单位：米）为 $L_1 = 1.200$，$L_2 = 2.500$，$L_3 = 3.000$，而匹配的地图点之间在当前 SLAM 单位下的相应距离为 $\\hat{d}_1 = 1.18$，$\\hat{d}_2 = 2.42$，$\\hat{d}_3 = 2.87$。假设三次对应的置信度相等。此外，在叠加时，SLAM 轨迹相对于真实米制尺度的瞬时尺度因子已经漂移至 $s' = 0.96$（也就是说，真实的平移是 SLAM 平移的 $s$ 倍，但系统在映射到 CAD 坐标系时仍在使用等于 $1$ 的过时尺度）。\n\n哪个选项能从第一性原理出发，最好地解释为什么单目 SLAM 中的尺度漂移会损害数字孪生叠加的保真度，并利用 CAD 模型中已知的基线提出一种原则性的修正方法，包括根据给定基线对尺度进行正确的数值估计，以及如何将其应用于 SLAM 状态？此外，请说明在修正前，当 $s' = 0.96$ 时，距离原点 $R = 5.0$ 米的点上预期的位置叠加误差的大小。\n\nA. 因为单目重建只能确定到一个相似性变换，所以绝对尺度 $s$ 是不可观察的，并且可能发生漂移。当渲染时使用的 SLAM 地图与 CAD 模型之间的相似性变换不匹配时，就会产生叠加误差，该误差导致的定位错误会随场景范围近似线性增长。一种原则性的修正方法是，通过最小化缩放后的 SLAM 距离与米制 CAD 基线之间的残差平方和来估计全局尺度 $s$，即 $s^* = \\arg\\min_s \\sum_{m=1}^M ( s \\hat{d}_m - L_m )^2$，由此得出 $s^* = \\left( \\sum_m \\hat{d}_m L_m \\right) / \\left( \\sum_m \\hat{d}_m^2 \\right)$。对于所提供的数据，$s^* \\approx 1.038$。应用此修正时，将所有 SLAM 的平移和地图点位置乘以 $s^*$，同时保持 $\\mathrm{SO}(3)$ 上的旋转不变，并在位姿图中添加一个相似性边（尺度先验）以抑制未来的漂移。在 $s' = 0.96$ 的情况下，修正前在距离 $R$ 处的叠加位置误差约为 $|1 - s'| R \\approx 0.20$ 米。\n\nB. 如果相机内参 $K$ 已校准，则尺度漂移不影响叠加，因为 $K$ 固定了米制尺度。一种修正是调整视场以在每一帧都匹配 CAD 模型。尺度可以通过算术平均值 $s = \\frac{1}{M} \\sum_m \\frac{L_m}{\\hat{d}_m}$ 来估计，然后统一应用于平移和旋转，即设 $R' = s R$ 和 $t' = s t$。如果 $K$ 已知，则修正前的叠加误差为零。\n\nC. 如果渲染器使用当前位姿，则尺度漂移只改变内部地图，而不改变感知到的叠加效果；因此，不需要全局相似性变换。如果需要修正，可以沿相机光轴增加一个恒定的偏移量。尺度可以估计为 $s = \\frac{\\sum_m L_m}{\\sum_m \\hat{d}_m}$，并仅应用于相机平移，而不改变地图点。修正前的叠加位置误差约为 $0.04$ 米，与 $R$ 无关。\n\nD. 尺度漂移是由于不正确的像素到米制的转换造成的，因此应强制使两个匹配图像特征之间的像素距离等于 CAD 基线：从任意单张图像设置 $s = \\frac{L}{\\|\\hat{u}_i - \\hat{u}_j\\|}$，然后相应地更新焦距 $f$。为保持一致性，旋转必须按 $R' = s R$ 进行缩放。通过此更新，每帧的修正前叠加误差都会被消除。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知信息\n\n- **系统**：一个带有单目摄像头的增强现实头戴设备，使用一个单目即时定位与地图构建 (SLAM) 系统。\n- **应用**：叠加一个机器人单元的数字孪生 (DT)，其包含一个米制精确的计算机辅助设计 (CAD) 模型。\n- **相机模型**：投影相机，其中世界点 $X$ 的图像坐标 $x$ 满足 $x \\sim K [R \\mid t] X$，其中 $K$ 是内参矩阵，$R \\in \\mathrm{SO}(3)$ 是旋转，$t \\in \\mathbb{R}^3$ 是平移。\n- **SLAM 模糊性**：恢复的结构和运动只能确定到一个未知的全局相似性变换 $\\{ s, R_0, t_0 \\}$，其中 $s \\in \\mathbb{R}^+$ 是尺度，$R_0 \\in \\mathrm{SO}(3)$ 是全局旋转，$t_0 \\in \\mathbb{R}^3$ 是全局平移。在没有米制先验的情况下，绝对米制尺度 $s$ 从单个单目序列中是不可观察的。\n- **尺度漂移定义**：由于估计噪声随时间累积，导致的全局尺度 $s$ 估计值的逐渐误差。\n- **性能要求**：在直径为 $D$ 米的工作空间内保持亚厘米级的叠加精度。\n- **用于尺度估计的给定数据**：\n    - 匹配的特征对数量：$M = 3$。\n    - 已知的 CAD 基线长度（单位：米）：$L_1 = 1.200$，$L_2 = 2.500$，$L_3 = 3.000$。\n    - 对应的 SLAM 地图距离（单位：SLAM 单位）：$\\hat{d}_1 = 1.18$，$\\hat{d}_2 = 2.42$，$\\hat{d}_3 = 2.87$。\n    - 假设：三次对应的置信度相等。\n- **用于误差计算的场景**：\n    - 在叠加时，瞬时尺度因子已漂移至 $s' = 0.96$。这意味着真实的米制距离是 SLAM 地图单位中对应距离的 $s'$ 倍。\n    - 系统在映射到 CAD 坐标系时使用的是等于 $1$ 的过时尺度。\n    - 需要计算距离原点 $R = 5.0$ 米处某点的叠加误差。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n- **科学基础**：问题陈述牢固地植根于 3D 计算机视觉和机器人学的原理，特别是单目 SLAM。投影相机模型、单目重建的相似性模糊性（包括不可观察的尺度）、尺度漂移以及使用米制先验（CAD 基线）进行尺度校正等概念都是该领域中标准且成熟的。\n- **适定性**：该问题是适定的。它提供了足够的数值数据（$M=3$ 对对应距离）来唯一确定尺度因子 $s$ 的估计值。问题要求进行具体的推导、数值计算以及对给定场景的分析，所有这些都可以利用所提供的信息来解决。\n- **客观性**：问题以精确、客观和技术性的语言陈述。所有关键术语要么已定义，要么是该领域的标准术语。数据是定量的。没有主观或基于意见的陈述。\n\n该问题不存在任何无效性缺陷：\n1.  **科学不严谨性**：没有违反科学或数学原理。\n2.  **不相关性**：问题与指定主题直接相关。\n3.  **不完整性/矛盾性**：设置是自洽和一致的。提供用于估计尺度因子的数据和用于误差分析场景的独立漂移尺度因子是一种标准的问题结构，并非矛盾。\n4.  **不可行性**：所有数值对于典型的机器人工作单元都是物理上现实的。\n5.  **不适定性**：该问题允许一个唯一且有意义的解。\n6.  **琐碎性**：该问题需要对 SLAM 原理和最小二乘估计有实质性的了解。\n7.  **不可验证性**：所有主张和计算在数学上都是可验证的。\n\n### 步骤 3：结论与行动\n问题陈述是 **有效的**。现在开始求解过程。\n\n## 解题推导\n\n问题要求一个包含三部分的答案：\n1.  解释为什么尺度漂移会影响叠加保真度。\n2.  一种使用给定数据校正尺度的原则性方法，包括数值估计。\n3.  计算给定场景下修正前的叠加误差。\n\n### 第 1 部分：尺度漂移与叠加误差的解释\n\n单目 SLAM 的核心是从 2D 视频流中重建 3D 结构和相机运动。由于射影几何的性质，这种重建只能确定到一个未知的相似性变换。这意味着如果 $\\{ \\mathcal{P}, \\mathcal{T} \\}$ 是一个有效的三维地图（点集 $\\mathcal{P}$）和相机轨迹（位姿集 $\\mathcal{T}$），那么对于任何尺度 $s > 0$、旋转 $R_0 \\in \\mathrm{SO}(3)$ 和平移 $t_0 \\in \\mathbb{R}^3$，变换后的重建 $\\{ s R_0 \\mathcal{P} + t_0, (R_0 R_i, s R_0 t_i + t_0) \\in \\mathcal{T} \\}$ 也是一个有效的重建，它能产生完全相同的图像观测。仅凭单目视觉，尺度因子 $s$ 是不可观察的。\n\n数字孪生叠加需要将 SLAM 地图坐标系与由 CAD 模型代表的真实世界米制系统对齐。这是通过找到将 SLAM 坐标映射到 CAD 坐标的特定相似性变换 $\\{s, R_0, t_0\\}$ 来完成的。最初，这个变换可以被计算出来。然而，在实时 SLAM 系统中，帧间运动估计的微小误差会累积。这种累积导致相似性变换的参数随时间漂移。最显著的是，尺度 $s$ 可能发生漂移，这意味着真实世界的一米与 SLAM 地图单位之间的比率不是恒定的。\n\n设给定时间的真实尺度因子为 $s'$。世界中的一个真实距离 $L_{true}$ 在 SLAM 地图中表示为距离 $d_{slam}$，其中 $L_{true} = s' \\cdot d_{slam}$。AR 系统必须使用一个尺度因子，我们称之为 $s_{sys}$，来渲染数字孪生叠加层。如果 $s_{sys} \\neq s'$，就会发生错位。系统将一个 SLAM 点 $p_{slam}$ 的米制位置计算为 $p_{est} = s_{sys} \\cdot p_{slam}$。而真实的米制位置是 $p_{true} = s' \\cdot p_{slam}$。向量误差为 $e = p_{true} - p_{est} = (s' - s_{sys}) p_{slam}$。误差的大小与该点到 SLAM 坐标系原点的距离成正比，即 $\\|e\\| = |s' - s_{sys}| \\|p_{slam}\\|$。这表明由尺度漂移引起的叠加误差随与 SLAM 原点距离的增加而线性增长。\n\n### 第 2 部分：尺度校正与估计\n\n为了校正尺度，我们必须通过比较 SLAM 地图中的距离与来自 CAD 模型的已知米制距离来估计当前的真实尺度因子 $s'$。我们被给予了 $M=3$ 对距离：米制 CAD 基线 $\\{L_m\\}_{m=1}^3$ 和它们对应的 SLAM 地图对应物 $\\{\\hat{d}_m\\}_{m=1}^3$。理想关系是 $L_m = s \\cdot \\hat{d}_m$。由于 SLAM 位置的测量噪声，这不会是精确的。找到 $s$ 的最佳估计值的一种原则性方法是最小化已知米制基线与缩放后的 SLAM 距离之间的误差平方和。\n\n我们将目标函数 $E(s)$ 定义为残差平方和：\n$$ E(s) = \\sum_{m=1}^{M} (s \\hat{d}_m - L_m)^2 $$\n为了找到最小化该误差的最优尺度 $s^*$，我们对 $E(s)$ 关于 $s$ 求导并令其为零：\n$$ \\frac{dE}{ds} = \\sum_{m=1}^{M} \\frac{d}{ds} (s \\hat{d}_m - L_m)^2 = \\sum_{m=1}^{M} 2(s \\hat{d}_m - L_m)(\\hat{d}_m) = 0 $$\n$$ \\sum_{m=1}^{M} (s \\hat{d}_m^2 - L_m \\hat{d}_m) = 0 $$\n$$ s \\sum_{m=1}^{M} \\hat{d}_m^2 = \\sum_{m=1}^{M} L_m \\hat{d}_m $$\n这得出了尺度的最小二乘估计量：\n$$ s^* = \\frac{\\sum_{m=1}^{M} L_m \\hat{d}_m}{\\sum_{m=1}^{M} \\hat{d}_m^2} $$\n使用提供的数据：\n$L_1 = 1.200, L_2 = 2.500, L_3 = 3.000$\n$\\hat{d}_1 = 1.18, \\hat{d}_2 = 2.42, \\hat{d}_3 = 2.87$\n\n分子：\n$$ \\sum L_m \\hat{d}_m = (1.200)(1.18) + (2.500)(2.42) + (3.000)(2.87) = 1.416 + 6.050 + 8.610 = 16.076 $$\n分母：\n$$ \\sum \\hat{d}_m^2 = (1.18)^2 + (2.42)^2 + (2.87)^2 = 1.3924 + 5.8564 + 8.2369 = 15.4857 $$\n尺度估计：\n$$ s^* = \\frac{16.076}{15.4857} \\approx 1.038118 $$\n这个估计出的尺度 $s^* \\approx 1.038$ 应该被应用到 SLAM 地图上。校正过程涉及对地图的所有平移分量进行乘法缩放。这意味着每个地图点位置 $\\vec{p}$ 变为 $s^* \\vec{p}$，轨迹中的每个相机平移向量 $\\vec{t}$ 变为 $s^* \\vec{t}$。旋转矩阵 $R \\in \\mathrm{SO}(3)$ 必须保持不变，因为缩放会违反它们正交性的定义属性，从而破坏旋转几何结构。\n\n### 第 3 部分：修正前误差计算\n\n我们给定的场景是，真实的瞬时尺度因子已漂移至 $s' = 0.96$。一个点位于距离原点 $R = 5.0$ 米的真实米制距离处。\nSLAM 系统会以其自身的任意单位重建该点，其距离为 $d_{slam}$，其中 $R = s' \\cdot d_{slam}$。因此，$d_{slam} = R/s'$。\n$$ d_{slam} = \\frac{5.0}{0.96} \\approx 5.2083 \\text{ SLAM 单位} $$\n问题陈述指出，系统正在使用一个过时的尺度因子 $s_{sys} = 1$ 来将叠加层渲染到 CAD 坐标系上。因此，系统认为该点的米制距离是：\n$$ R_{est} = s_{sys} \\cdot d_{slam} = 1 \\cdot \\frac{5.0}{0.96} \\approx 5.2083 \\text{ 米} $$\n真实距离是 $R = 5.0$ 米。位置叠加误差的大小是真实米制距离和估计米制距离之间的差值：\n$$ \\text{Error} = |R - R_{est}| = \\left|5.0 - \\frac{5.0}{0.96}\\right| = 5.0 \\left|1 - \\frac{1}{0.96}\\right| = 5.0 \\left|\\frac{0.96 - 1}{0.96}\\right| = 5.0 \\left(\\frac{0.04}{0.96}\\right) = 5.0 \\cdot \\frac{1}{24} = \\frac{5}{24} \\approx 0.2083 \\text{ 米} $$\n当 $s' \\approx 1$ 时，对此误差的一个常用一阶近似是 $|1 - s'| R$。\n$$ |1 - s'| R = |1 - 0.96| \\times 5.0 = 0.04 \\times 5.0 = 0.20 \\text{ 米} $$\n这个近似值与精确值很接近。\n\n## 逐项分析\n\n- **A. 因为单目重建只能确定到一个相似性变换，所以绝对尺度 $s$ 是不可观察的，并且可能发生漂移。当渲染时使用的 SLAM 地图与 CAD 模型之间的相似性变换不匹配时，就会产生叠加误差，该误差导致的定位错误会随场景范围近似线性增长。一种原则性的修正方法是，通过最小化缩放后的 SLAM 距离与米制 CAD 基线之间的残差平方和来估计全局尺度 $s$，即 $s^* = \\arg\\min_s \\sum_{m=1}^M ( s \\hat{d}_m - L_m )^2$，由此得出 $s^* = \\left( \\sum_m \\hat{d}_m L_m \\right) / \\left( \\sum_m \\hat{d}_m^2 \\right)$。对于所提供的数据，$s^* \\approx 1.038$。应用此修正时，将所有 SLAM 的平移和地图点位置乘以 $s^*$，同时保持 $\\mathrm{SO}(3)$ 上的旋转不变，并在位姿图中添加一个相似性边（尺度先验）以抑制未来的漂移。在 $s' = 0.96$ 的情况下，修正前在距离 $R$ 处的叠加位置误差约为 $|1 - s'| R \\approx 0.20$ 米。**\n  - **结论：** **正确**。该选项提供了正确的理论解释。它使用了正确且原则性的最小二乘公式进行尺度估计。根据我的推导，数值计算 $s^* \\approx 1.038$ 是正确的。应用校正的方法（缩放平移和点，但不缩放旋转）是正确的。添加相似性边的建议是一种先进且正确的技术。最后，误差计算是一个有效且数值上接近的近似。\n\n- **B. 如果相机内参 $K$ 已校准，则尺度漂移不影响叠加，因为 $K$ 固定了米制尺度。一种修正是调整视场以在每一帧都匹配 CAD 模型。尺度可以通过算术平均值 $s = \\frac{1}{M} \\sum_m \\frac{L_m}{\\hat{d}_m}$ 来估计，然后统一应用于平移和旋转，即设 $R' = s R$ 和 $t' = s t$。如果 $K$ 已知，则修正前的叠加误差为零。**\n  - **结论：** **错误**。“校准的内参矩阵 $K$ 固定了米制尺度”这一前提在根本上是错误的。单目视觉的尺度模糊性是几何性质的，即使在已知 $K$ 的情况下也依然存在。将尺度因子应用于旋转矩阵（$R' = sR$）是一个无意义的操作，会使其脱离 $\\mathrm{SO}(3)$。\n\n- **C. 如果渲染器使用当前位姿，则尺度漂移只改变内部地图，而不改变感知到的叠加效果；因此，不需要全局相似性变换。如果需要修正，可以沿相机光轴增加一个恒定的偏移量。尺度可以估计为 $s = \\frac{\\sum_m L_m}{\\sum_m \\hat{d}_m}$，并仅应用于相机平移，而不改变地图点。修正前的叠加位置误差约为 $0.04$ 米，与 $R$ 无关。**\n  - **结论：** **错误**。尺度漂移绝对会影响感知到的叠加效果，因为“当前位姿”的平移分量被错误地缩放了。对于乘性尺度误差，使用恒定偏移量是错误的模型。只对平移进行尺度校正而不改变地图点会破坏地图的一致性。误差是恒定的且与范围 $R$ 无关的说法也从根本上是错误的；尺度误差是乘性的。\n\n- **D. 尺度漂移是由于不正确的像素到米制的转换造成的，因此应强制使两个匹配图像特征之间的像素距离等于 CAD 基线：从任意单张图像设置 $s = \\frac{L}{\\|\\hat{u}_i - \\hat{u}_j\\|}$，然后相应地更新焦距 $f$。为保持一致性，旋转必须按 $R' = s R$ 进行缩放。通过此更新，每帧的修正前叠加误差都会被消除。**\n  - **结论：** **错误**。该选项将 2D 图像空间的像素距离与 3D 世界空间的米制距离混为一谈，这是一个严重错误。它们之间的关系由射影几何决定，而非简单的比率。修改焦距 $f$ 来校正 3D 世界尺度漂移是错误的。与选项 B 一样，缩放旋转矩阵（$R' = sR$）是错误的。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}