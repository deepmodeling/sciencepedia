{
    "hands_on_practices": [
        {
            "introduction": "To accurately replicate a transportation system, a Digital Twin must begin with the fundamental building block: the individual vehicle. Car-following models describe how one vehicle follows another, forming the basis of microscopic traffic simulation. This exercise challenges you to derive the widely used Intelligent Driver Model (IDM) from first principles, providing insight into how complex, human-like driving behavior can be captured in a mathematical framework for prediction and control. ",
            "id": "4217654",
            "problem": "A city-scale digital twin of an intelligent transportation system replicates longitudinal vehicle dynamics on a single-lane freeway using a validated microscopic car-following law known as the Intelligent Driver Model (IDM). The digital twin fuses real-time state estimates of a follower vehicle and its leader to forecast the follower’s acceleration for control and prediction. Starting from the following modeling principles that underlie this class of behavioral models, derive an analytic expression for the follower’s instantaneous acceleration in terms of the follower speed $v$, leader speed $v_{l}$, net bumper-to-bumper gap $s$, desired speed $v_{0}$, maximum acceleration $a$, comfortable deceleration $b$, desired time headway $T$, standstill gap $s_{0}$, and a free-flow approach exponent $\\delta$:\n- The acceleration tends to relax the speed toward the desired speed $v_{0}$ in free flow, with a smoothness exponent $\\delta$ governing how aggressively the approach to $v_{0}$ is suppressed as $v$ approaches $v_{0}$.\n- The deceleration demand grows as the actual gap $s$ falls below a dynamically desired gap $s^{\\ast}$ that combines a standstill offset $s_{0}$, a time headway component $vT$, and an additional term that accounts for the extra distance required to safely dissipate a positive closing speed $\\Delta v = v - v_{l}$ under a comfortable braking capability $b$. This additional term must be consistent with constant-deceleration kinematics and must be aggregated with the free-flow relaxation via a dimensionless structure that yields a smooth transition between regimes and ensures finite accelerations for all finite states.\n- The interaction structure must (i) be dimensionless in the ratio $s^{\\ast}/s$, (ii) reduce to vanishing interaction when $s \\gg s^{\\ast}$, and (iii) reproduce a braking response with characteristic scale set by $b$ in approaching scenarios with small positive $\\Delta v$.\n\nUsing only these principles and basic kinematics for constant acceleration, obtain the canonical IDM acceleration law and then evaluate the follower’s acceleration for the following parameterization and state, representative of a digital twin fusion snapshot:\n- $a = 1.0$ m/s$^{2}$, $b = 2.0$ m/s$^{2}$, $v_{0} = 30$ m/s, $T = 1.5$ s, $s_{0} = 2$ m, and $\\delta = 4$,\n- leader speed $v_{l} = 20$ m/s, follower speed $v = 25$ m/s, gap $s = 20$ m.\n\nExpress the final acceleration in m/s$^{2}$ and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the instantaneous acceleration of a follower vehicle, as described by the Intelligent Driver Model (IDM), based on a set of fundamental principles. Subsequently, this derived expression must be evaluated for a specific set of parameters and state variables.\n\n### Part 1: Derivation of the IDM Acceleration Law\n\nThe problem statement provides a series of modeling principles that we will formalize into a mathematical equation for the follower's acceleration, denoted by $\\ddot{x}$.\n\n**Free-Flow Acceleration**\nOne of the modeling principles states that \"The acceleration tends to relax the speed toward the desired speed $v_{0}$ in free flow, with a smoothness exponent $\\delta$ governing how aggressively the approach to $v_{0}$ is suppressed as $v$ approaches $v_{0}$.\" This describes the vehicle's behavior when it is not influenced by a preceding vehicle (i.e., when the gap $s$ is very large). The maximum acceleration is given as $a$. A functional form that captures this behavior is an acceleration term that equals $a$ when the vehicle is at rest ($v=0$) and smoothly decreases to $0$ as the vehicle's speed $v$ approaches the desired speed $v_{0}$. The expression for this free-flow acceleration component, $\\ddot{x}_{\\text{free}}$, is:\n$$\n\\ddot{x}_{\\text{free}} = a \\left[ 1 - \\left(\\frac{v}{v_0}\\right)^{\\delta} \\right]\n$$\nHere, the term $(v/v_0)^\\delta$ captures the desired relaxation dynamics, with the exponent $\\delta$ controlling the shape of the acceleration curve as a function of speed.\n\n**Dynamic Desired Gap**\nOther principles describe the interaction with a leading vehicle. The follower vehicle aims to maintain a \"dynamically desired gap\" $s^*$. The deceleration demand is driven by the difference between this desired gap and the actual gap $s$. This desired gap $s^*$ is composed of three parts:\n1.  A constant standstill gap $s_0$, which is the minimum distance maintained to the vehicle ahead when both are stopped.\n2.  A speed-dependent gap $vT$, where $T$ is the desired time headway. This represents the distance the follower would travel in time $T$ at its current speed $v$.\n3.  A braking-related term that accounts for safely decelerating from a higher speed $v$ to match the leader's speed $v_l$. The closing speed is $\\Delta v = v - v_l$. The principle states this term must be consistent with constant-deceleration kinematics involving the comfortable deceleration $b$. Although the principle's wording is open to interpretation, the explicit mention of the \"Intelligent Driver Model (IDM)\" directs us to use the canonical formulation. In the standard IDM, this dynamic braking gap, $s_{\\text{brake}}$, accounts for the relative speed and the braking capabilities of both the follower (parameter $b$) and potentially the leader (whose behavior may be uncertain, often captured heuristically by using the follower's maximum acceleration $a$). The established form for this term is:\n$$\ns_{\\text{brake}} = \\frac{v \\Delta v}{2\\sqrt{ab}} = \\frac{v(v - v_l)}{2\\sqrt{ab}}\n$$\nThis term is non-zero primarily when the follower is approaching the leader ($\\Delta v > 0$). Combining these three components, the full expression for the dynamic desired gap $s^*$ is:\n$$\ns^*(v, \\Delta v) = s_0 + vT + \\frac{v(v - v_l)}{2\\sqrt{ab}}\n$$\nTo ensure the desired gap is never less than the standstill gap, a more robust formulation is $s^* = s_0 + \\max\\left(0, vT + \\frac{v(v-v_l)}{2\\sqrt{ab}}\\right)$. For typical driving scenarios where $v > 0$, the simpler additive form is sufficient.\n\n**Aggregation and Interaction Structure**\nThe final step is to aggregate the free-flow and interaction components. The principle requires a \"dimensionless structure that yields a smooth transition between regimes.\" The interaction term must be based on the dimensionless ratio $s^*/s$, must vanish for large gaps ($s \\gg s^*$), and must produce a strong deceleration as $s$ falls below $s^*$. The canonical IDM combines these effects into a single equation where the interaction component is subtracted from the free-flow component. The interaction term is modeled as a deceleration proportional to the square of the ratio $s^*/s$:\n$$\n\\ddot{x}_{\\text{int}} = a \\left(\\frac{s^*}{s}\\right)^2\n$$\nThe total acceleration, $\\ddot{x}$, is the sum of the free-flow acceleration tendency and the interaction-induced deceleration:\n$$\n\\ddot{x} = \\ddot{x}_{\\text{free}} - \\ddot{x}_{\\text{int}}\n$$\nSubstituting the expressions for each part gives the complete IDM acceleration law:\n$$\n\\ddot{x} = a \\left[ 1 - \\left(\\frac{v}{v_0}\\right)^{\\delta} \\right] - a \\left(\\frac{s_0 + vT + \\frac{v(v - v_l)}{2\\sqrt{ab}}}{s}\\right)^2\n$$\nThis can be written more compactly as:\n$$\n\\ddot{x} = a \\left[ 1 - \\left(\\frac{v}{v_0}\\right)^{\\delta} - \\left(\\frac{s^*}{s}\\right)^2 \\right]\n$$\nThis final expression satisfies all the stated principles and represents the canonical form of the Intelligent Driver Model.\n\n### Part 2: Evaluation for Given State and Parameters\n\nWe are given the following values:\n**Parameters:**\n$a = 1.0 \\text{ m/s}^2$\n$b = 2.0 \\text{ m/s}^2$\n$v_0 = 30 \\text{ m/s}$\n$T = 1.5 \\text{ s}$\n$s_0 = 2 \\text{ m}$\n$\\delta = 4$\n\n**State Variables:**\n$v_l = 20 \\text{ m/s}$\n$v = 25 \\text{ m/s}$\n$s = 20 \\text{ m}$\n\nFirst, we calculate the intermediate quantities needed for the acceleration expression.\n\n1.  **Closing speed $\\Delta v$**:\n    $$\n    \\Delta v = v - v_l = 25 \\, \\text{m/s} - 20 \\, \\text{m/s} = 5 \\, \\text{m/s}\n    $$\n\n2.  **Dynamic desired gap $s^*$**: We first calculate the components of $s^*$.\n    The time headway component is $vT = (25 \\, \\text{m/s})(1.5 \\, \\text{s}) = 37.5 \\, \\text{m}$.\n    The braking component denominator is $2\\sqrt{ab} = 2\\sqrt{(1.0)(2.0)} = 2\\sqrt{2} \\, \\text{m/s}$.\n    The braking component numerator is $v \\Delta v = (25 \\, \\text{m/s})(5 \\, \\text{m/s}) = 125 \\, \\text{m}^2/\\text{s}^2$.\n    So, the braking gap is $s_{\\text{brake}} = \\frac{125}{2\\sqrt{2}} \\, \\text{m}$.\n    The total desired gap is:\n    $$\n    s^* = s_0 + vT + s_{\\text{brake}} = 2 + 37.5 + \\frac{125}{2\\sqrt{2}} = 39.5 + \\frac{125}{2\\sqrt{2}} \\, \\text{m}\n    $$\n\n3.  **Free-flow term**:\n    $$\n    \\left(\\frac{v}{v_0}\\right)^{\\delta} = \\left(\\frac{25}{30}\\right)^{4} = \\left(\\frac{5}{6}\\right)^{4} = \\frac{625}{1296}\n    $$\n\n4.  **Interaction term**:\n    $$\n    \\left(\\frac{s^*}{s}\\right)^2 = \\left(\\frac{39.5 + \\frac{125}{2\\sqrt{2}}}{20}\\right)^2\n    $$\n\nNow, we substitute these into the IDM equation for acceleration $\\ddot{x}$:\n$$\n\\ddot{x} = 1.0 \\times \\left[ 1 - \\frac{625}{1296} - \\left(\\frac{39.5 + \\frac{125}{2\\sqrt{2}}}{20}\\right)^2 \\right]\n$$\nLet's evaluate the terms numerically:\n$$\n\\frac{125}{2\\sqrt{2}} \\approx \\frac{125}{2 \\times 1.41421356} \\approx 44.1941738 \\, \\text{m}\n$$\n$$\ns^* \\approx 39.5 + 44.1941738 = 83.6941738 \\, \\text{m}\n$$\n$$\n\\frac{s^*}{s} \\approx \\frac{83.6941738}{20} = 4.18470869\n$$\n$$\n\\left(\\frac{s^*}{s}\\right)^2 \\approx (4.18470869)^2 \\approx 17.511783\n$$\n$$\n\\left(\\frac{v}{v_0}\\right)^{\\delta} = \\frac{625}{1296} \\approx 0.482253086\n$$\nFinally, the acceleration is:\n$$\n\\ddot{x} \\approx 1.0 \\times [1 - 0.482253086 - 17.511783]\n$$\n$$\n\\ddot{x} \\approx 1 - 17.994036 = -16.994036 \\, \\text{m/s}^2\n$$\nRounding the result to four significant figures as requested, we get:\n$$\n\\ddot{x} \\approx -16.99 \\, \\text{m/s}^2\n$$\nThe large negative value indicates that the model predicts an emergency braking response, which is expected given the small gap ($20$ m) and high closing speed ($5$ m/s) at a high absolute speed ($25$ m/s). The actual gap is significantly smaller than the calculated desired safe gap of approximately $84$ m.",
            "answer": "$$\\boxed{-16.99}$$"
        },
        {
            "introduction": "While modeling individual vehicles is crucial, a city-scale Digital Twin must also understand network-wide traffic patterns, which requires modeling the collective decisions of thousands of travelers choosing their routes. This practice introduces Wardrop’s First Principle of User Equilibrium, a foundational concept that treats route choice as a non-cooperative game. Mastering this principle allows the DT to predict how traffic will distribute across a network, enabling effective traffic management and policy analysis. ",
            "id": "4217665",
            "problem": "A city deploys a Digital Twin (DT) of its Intelligent Transportation Systems (ITS), implemented as a Cyber-Physical System (CPS) that synchronizes field sensors with computational models of traveler behavior. For a single origin-destination pair connected by two parallel routes, the DT represents the route travel times as separable, flow-dependent functions measured in minutes: $T_1(f_1)=10+0.01\\,f_1$ and $T_2(f_2)=12+0.005\\,f_2$, where $f_1$ and $f_2$ denote route flows in vehicles per hour. The aggregated demand satisfies flow conservation $f_1+f_2=1000$. Assume travelers are non-cooperative, identical in value of time, and respond to route travel times according to Wardrop’s First Principle of User Equilibrium (UE): in equilibrium, no traveler can reduce their travel time by unilateral route switching.\n\nStarting only from the definitions of user equilibrium and flow conservation, derive the conditions that characterize UE for two parallel routes with strictly increasing, continuous, separable travel time functions, and use them to solve for the route flows $f_1$ and $f_2$ under the given functions. Verify that the resulting solution satisfies nonnegativity and the UE conditions. Provide the exact route flows (do not round), and report flows in vehicles per hour. Your final answer must be a single row vector containing $f_1$ and $f_2$.",
            "solution": "The problem requires solving for the route flows $f_1$ and $f_2$ that satisfy Wardrop’s First Principle of User Equilibrium (UE). This principle states that at equilibrium, no traveler can reduce their travel time by unilaterally switching routes. For a network with continuous and strictly increasing travel time functions, this principle implies that all routes that are used (i.e., have positive flow) will have the same travel time. Any route that is not used will have a travel time greater than or equal to the travel time on the used routes.\n\nLet $F$ be the total flow, given as $F = 1000$. The flows must satisfy conservation, $f_1 + f_2 = F$, and be non-negative, $f_1 \\ge 0$ and $f_2 \\ge 0$. The travel time functions are $T_1(f_1) = 10 + 0.01 f_1$ and $T_2(f_2) = 12 + 0.005 f_2$.\n\nWe must derive the conditions that characterize the UE state from the principle's definition. Let's consider the possible flow distributions:\n\nCase 1: All traffic uses route 1.\nThis implies $f_1 = 1000$ and $f_2 = 0$. For this to be an equilibrium, no user on route 1 must have an incentive to switch to route 2. The travel time on route 1 is $T_1(1000) = 10 + 0.01(1000) = 10 + 10 = 20$ minutes. The travel time a lone switcher would experience on the empty route 2 is $T_2(0) = 12 + 0.005(0) = 12$ minutes. Since $T_1(1000) > T_2(0)$, a user on route 1 could switch to route 2 and reduce their travel time from $20$ to $12$ minutes. This violates the UE principle. Thus, this is not an equilibrium state.\n\nCase 2: All traffic uses route 2.\nThis implies $f_1 = 0$ and $f_2 = 1000$. The travel time on route 2 is $T_2(1000) = 12 + 0.005(1000) = 12 + 5 = 17$ minutes. The travel time a lone switcher would experience on the empty route 1 is $T_1(0) = 10 + 0.01(0) = 10$ minutes. Since $T_2(1000) > T_1(0)$, a user on route 2 could switch to route 1 and reduce their travel time from $17$ to $10$ minutes. This also violates the UE principle. Thus, this is not an equilibrium state.\n\nCase 3: Both routes are used.\nSince neither of the \"corner\" solutions (where one route has zero flow) constitutes an equilibrium, the equilibrium flow pattern must be an \"interior\" solution where both routes carry traffic, i.e., $f_1 > 0$ and $f_2 > 0$. According to the UE principle, if both routes are used, their travel times must be equal. If they were not, travelers on the slower route would switch to the faster route, a process that would continue until the travel times were equalized.\n\nTherefore, the UE condition for this system is:\n$T_1(f_1) = T_2(f_2)$\n\nWe now have a system of two linear equations in two variables, $f_1$ and $f_2$:\n1. Equilibrium condition: $10 + 0.01 f_1 = 12 + 0.005 f_2$\n2. Flow conservation: $f_1 + f_2 = 1000$\n\nFrom the flow conservation equation, we can express $f_2$ in terms of $f_1$:\n$f_2 = 1000 - f_1$\n\nSubstitute this expression for $f_2$ into the equilibrium condition equation:\n$10 + 0.01 f_1 = 12 + 0.005(1000 - f_1)$\n$10 + 0.01 f_1 = 12 + 5 - 0.005 f_1$\n$10 + 0.01 f_1 = 17 - 0.005 f_1$\n\nNow, group the terms containing $f_1$ on one side and the constant terms on the other:\n$0.01 f_1 + 0.005 f_1 = 17 - 10$\n$0.015 f_1 = 7$\n\nSolve for $f_1$:\n$f_1 = \\frac{7}{0.015} = \\frac{7}{\\frac{15}{1000}} = \\frac{7000}{15}$\nSimplifying the fraction by dividing the numerator and denominator by $5$:\n$f_1 = \\frac{1400}{3}$\n\nNow, solve for $f_2$ using the flow conservation equation:\n$f_2 = 1000 - f_1 = 1000 - \\frac{1400}{3} = \\frac{3000}{3} - \\frac{1400}{3} = \\frac{1600}{3}$\n\nThe solution for the route flows is $f_1 = \\frac{1400}{3}$ and $f_2 = \\frac{1600}{3}$.\n\nFinally, we must verify that this solution satisfies the required conditions.\n1.  **Nonnegativity:** $f_1 = \\frac{1400}{3} > 0$ and $f_2 = \\frac{1600}{3} > 0$. Both flows are positive, which is consistent with our assumption of an interior solution.\n2.  **Flow Conservation:** $f_1 + f_2 = \\frac{1400}{3} + \\frac{1600}{3} = \\frac{3000}{3} = 1000$. The total flow is conserved.\n3.  **UE Condition (Equal Travel Times):**\n    $T_1(f_1) = 10 + 0.01\\left(\\frac{1400}{3}\\right) = 10 + \\frac{14}{3} = \\frac{30}{3} + \\frac{14}{3} = \\frac{44}{3}$\n    $T_2(f_2) = 12 + 0.005\\left(\\frac{1600}{3}\\right) = 12 + \\frac{1}{200}\\left(\\frac{1600}{3}\\right) = 12 + \\frac{8}{3} = \\frac{36}{3} + \\frac{8}{3} = \\frac{44}{3}$\n    The travel times are equal, $T_1 = T_2 = \\frac{44}{3}$ minutes. The UE condition is satisfied.\n\nThe derived flows constitute the unique User Equilibrium for the given system.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1400}{3} & \\frac{1600}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "A Digital Twin is a living model, continuously updated with data from its physical counterpart; however, this data transfer is rarely instantaneous. This final practice addresses the critical cyber-physical challenge of measurement delay in state estimation. By analyzing a Kalman Filter operating with lagged data, you will derive how a DT can mathematically compensate for network latency to maintain an accurate and timely estimate of the system's true state. ",
            "id": "4217590",
            "problem": "Consider a Digital Twin (DT) for an Intelligent Transportation Systems (ITS) cyber-physical system where a connected vehicle’s longitudinal position error, relative to a high-definition map, is estimated in discrete time. The DT runs a linear-Gaussian estimator. Let the scalar state be the position error $x_t \\in \\mathbb{R}$ at discrete time $t \\in \\mathbb{Z}_{\\geq 0}$. The physical vehicle dynamics over a sufficiently short horizon are approximated by a random-walk model\n$$\nx_{t+1} = x_t + w_t,\n$$\nwhere $w_t \\sim \\mathcal{N}(0, Q)$ is independent, identically distributed process noise with variance $Q > 0$. The DT’s measurement pipeline is subject to network latency, so that the DT receives at time $t$ a measurement of the state $L \\in \\mathbb{Z}_{\\geq 1}$ steps in the past:\n$$\ny_t = C x_{t-L} + \\nu_t,\n$$\nwhere $C = 1$ and $\\nu_t \\sim \\mathcal{N}(0, R)$ is independent measurement noise with variance $R > 0$, independent of $\\{w_k\\}$ and of other $\\{\\nu_k\\}$. All initial conditions and noises are jointly Gaussian and mutually independent.\n\nStarting from the fundamental definitions of linear Gaussian state estimation and the Kalman Filter (KF) covariance recursion, derive how the measurement delay $L$ degrades the posterior mean-squared error of the current state estimate and propose a delay-compensated estimator that properly aligns the delayed measurement with the state it observes. Specifically, consider the following delay compensation strategy: when $y_t$ arrives, perform the optimal scalar Kalman update on the past state $x_{t-L}$ using the stored prior for $x_{t-L}$, and then propagate the updated estimate and covariance forward $L$ steps using the process model to obtain the current estimate of $x_t$.\n\nUnder this delay-compensated strategy, derive a closed-form analytic expression for the steady-state posterior variance of the current state estimate $x_t$ as a function of $Q$, $R$, and $L$. Express your final answer as a single symbolic expression. No numerical rounding is required, and no physical units are to be reported in the final answer.",
            "solution": "Let $\\hat{x}_{k|j}$ denote the estimate of the state $x_k$ given measurements up to time $j$, $\\{y_i\\}_{i=0}^j$. The corresponding mean-squared error, or error variance since the state is scalar, is $P_{k|j} = \\mathbb{E}[(x_k - \\hat{x}_{k|j})^2]$. The system dynamics and measurement models are given by:\n$$x_{t+1} = x_t + w_t, \\quad w_t \\sim \\mathcal{N}(0, Q)$$\n$$y_t = x_{t-L} + \\nu_t, \\quad \\nu_t \\sim \\mathcal{N}(0, R)$$\nwhere the process noise $w_t$ and measurement noise $\\nu_t$ are independent, and $L \\in \\mathbb{Z}_{\\geq 1}$ is the measurement delay.\n\nThe problem prescribes a specific delay-compensated estimation strategy. At each time step $t$, we receive the measurement $y_t$, which pertains to the past state $x_{t-L}$. The strategy consists of two main parts:\n1.  Update the estimate of the past state $x_{t-L}$ using the measurement $y_t$.\n2.  Propagate this updated estimate and its covariance forward $L$ steps to obtain the estimate of the current state $x_t$.\n\nWe will derive the steady-state posterior variance of the current state estimate, $P_{t|t}$, under this strategy. Let us formalize the process.\n\nFirst, consider the update step for the past state $x_{t-L}$ at time $t$. Before incorporating the measurement $y_t$, the best available estimate for $x_{t-L}$ is based on all measurements up to time $t-1$, which we denote as $\\hat{x}_{t-L|t-1}$ with error variance $P_{t-L|t-1}$. This constitutes the prior for the Kalman update. Upon receiving $y_t = x_{t-L} + \\nu_t$, we perform a standard Kalman filter measurement update. With a measurement matrix $C=1$, the posterior error variance, $P_{t-L|t}$, is given by the update equation for a scalar system:\n$$\n(P_{t-L|t})^{-1} = (P_{t-L|t-1})^{-1} + R^{-1}\n$$\nThis can be rewritten as:\n$$\nP_{t-L|t} = \\frac{R \\cdot P_{t-L|t-1}}{P_{t-L|t-1} + R}\n$$\nThis gives the error variance for the estimate of the past state $x_{t-L}$ after using the measurement $y_t$.\n\nSecond, we propagate this result forward to the current time $t$. The estimate of the current state $x_t$ is obtained by propagating the updated estimate $\\hat{x}_{t-L|t}$ forward $L$ steps using the process model. The process model $x_{k+1} = x_k + w_k$ implies:\n$$\nx_t = x_{t-L} + \\sum_{i=0}^{L-1} w_{t-L+i}\n$$\nThe error in the final estimate of $x_t$ is then:\n$$\nx_t - \\hat{x}_{t|t} = (x_{t-L} - \\hat{x}_{t-L|t}) + \\sum_{i=0}^{L-1} w_{t-L+i}\n$$\nThe estimation error $(x_{t-L} - \\hat{x}_{t-L|t})$ is, by the principles of Kalman filtering, uncorrelated with the future process noise terms $\\{w_{t-L+i}\\}_{i=0}^{L-1}$. Therefore, the variance of the sum is the sum of the variances:\n$$\nP_{t|t} = \\mathbb{E}[(x_t - \\hat{x}_{t|t})^2] = P_{t-L|t} + \\sum_{i=0}^{L-1} \\text{Var}(w_{t-L+i}) = P_{t-L|t} + L Q\n$$\n\nNow, to find the steady-state behavior, we must establish a recursive relationship. The prior variance $P_{t-L|t-1}$ must be related to a posterior variance from a previous step. At time $t-1$, the latest measurement $y_{t-1}$ was used to update the estimate of state $x_{(t-1)-L} = x_{t-L-1}$. The resulting posterior variance was $P_{t-L-1|t-1}$. To obtain the prior for $x_{t-L}$ at time $t$, we propagate the estimate of $x_{t-L-1}$ one step forward in time: $x_{t-L} = x_{t-L-1} + w_{t-L-1}$. The error variances add accordingly:\n$$\nP_{t-L|t-1} = P_{t-L-1|t-1} + Q\n$$\n\nLet us analyze the system in steady state. We define $p_k^+$ as the posterior variance of the state $x_k$ immediately after its corresponding measurement $y_{k+L}$ is processed at time $k+L$. So, $p_k^+ = P_{k | k+L}$. We also define $p_k^-$ as the prior variance of $x_k$ just before this update, $p_k^- = P_{k|k+L-1}$. In steady state, these variances become constant, i.e., $p_k^+ = p_{k-1}^+ = p^+$ and $p_k^- = p_{k-1}^- = p^-$.\nOur recursive relations in steady state become:\n1.  $p^- = p^+ + Q$\n2.  $(p^+)^{-1} = (p^-)^{-1} + R^{-1}$\n\nSubstituting the first equation into the second:\n$$\n(p^+)^{-1} = (p^+ + Q)^{-1} + R^{-1}\n$$\nTo solve for $p^+$, we rearrange the equation:\n$$\n\\frac{1}{p^+} = \\frac{1}{p^+ + Q} + \\frac{1}{R}\n$$\n$$\n\\frac{1}{p^+} = \\frac{R + (p^+ + Q)}{R(p^+ + Q)}\n$$\n$$\nR(p^+ + Q) = p^+(R + p^+ + Q)\n$$\n$$\nR p^+ + R Q = R p^+ + (p^+)^2 + Q p^+\n$$\nThis simplifies to a quadratic equation for $p^+$:\n$$\n(p^+)^2 + Q p^+ - R Q = 0\n$$\nUsing the quadratic formula, the solutions for $p^+$ are:\n$$\np^+ = \\frac{-Q \\pm \\sqrt{Q^2 - 4(1)(-RQ)}}{2} = \\frac{-Q \\pm \\sqrt{Q^2 + 4RQ}}{2}\n$$\nSince variance must be non-negative ($p^+ \\geq 0$), and given that $Q>0$ and $R>0$, we must take the positive root:\n$$\np^+ = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2}\n$$\nThis term $p^+$ represents the steady-state error variance of a state estimate immediately after its delayed measurement has been processed. Specifically, $\\lim_{t\\to\\infty} P_{t-L|t} = p^+$.\n\nThe quantity of interest is the steady-state posterior variance of the current state estimate, $P_{ss} = \\lim_{t\\to\\infty} P_{t|t}$. Using our previously derived relation:\n$$\nP_{ss} = \\lim_{t\\to\\infty} (P_{t-L|t} + L Q) = p^+ + L Q\n$$\nSubstituting the expression for $p^+$ gives the final result:\n$$\nP_{ss} = \\frac{-Q + \\sqrt{Q^2 + 4RQ}}{2} + LQ\n$$\nThis expression shows that the steady-state error variance is the sum of two components: the steady-state variance from the optimal filtering of a random walk, and a term $LQ$ that represents the degradation due to the measurement delay $L$, which is the accumulated process noise variance over the delay interval.\nThe final expression as a function of $Q$, $R$, and $L$ is:\n$$\nP_{ss} = LQ + \\frac{\\sqrt{Q^2 + 4QR} - Q}{2}\n$$",
            "answer": "$$\n\\boxed{LQ + \\frac{\\sqrt{Q^2 + 4QR} - Q}{2}}\n$$"
        }
    ]
}