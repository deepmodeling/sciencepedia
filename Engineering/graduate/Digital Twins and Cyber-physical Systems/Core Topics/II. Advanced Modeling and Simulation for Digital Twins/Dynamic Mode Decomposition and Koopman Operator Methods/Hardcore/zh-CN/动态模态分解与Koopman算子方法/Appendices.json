{
    "hands_on_practices": [
        {
            "introduction": "探索动力系统的线性“指纹”，即库普曼算子的特征函数与特征值，是理解复杂行为的关键。本练习将引导我们为一个基础的旋转系统进行一次“第一性原理”推导，解析地揭示其完整的库普曼谱。这个过程不仅能加深我们对库普曼算子理论核心概念的理解，也为我们后续处理无法解析求解的复杂系统并使用DMD等数值方法进行谱分析奠定了坚实的理论基石。",
            "id": "4219100",
            "problem": "信息物理系统中的同步振荡器的数字孪生通过圆上的离散时间映射来表示振荡器的相位，该映射由 $x_{k+1} = x_{k} + \\omega \\; \\mathrm{mod}\\; 2\\pi$ 给出，其中 $x_{k} \\in [0,2\\pi)$ 是在离散时间 $k \\in \\mathbb{Z}_{\\ge 0}$ 的相位，$\\omega \\in \\mathbb{R}$ 是一个恒定的角增量。角度以弧度为单位。该数字孪生使用Koopman算子框架来传播相位的可观测量 $f$。Koopman算子 $\\mathcal{U}$ 通过与动力学复合作用于可观测量 $f$，即 $(\\mathcal{U}f)(x) = f(x+\\omega \\; \\mathrm{mod}\\; 2\\pi)$。考虑关于圆上归一化勒贝格（不变）测度的平方可积复值可观测量所构成的希尔伯特空间 $L^{2}([0,2\\pi),\\mathrm{d}x/(2\\pi))$。在实践中，动态模态分解（DMD）被用来从数据中估计 $\\mathcal{U}$ 的谱特性，但在这里，您需要从第一性原理出发进行分析。\n\n仅从Koopman算子的定义以及关于 $L^{2}$ 空间和傅里叶级数的标准事实出发，完成以下任务：\n\n- 在 $L^{2}([0,2\\pi))$ 中构建一套完备的Koopman特征函数，并推导出它们相关的特征值的闭式解，作为 $\\omega$ 的函数。\n- 根据圆上旋转的基本性质和复指数的正交性，解释这些特征函数如何张成 $L^{2}([0,2\\pi))$，以及为什么Koopman算子在此空间上是酉的。\n- 解释当 $\\omega/(2\\pi)$ 为有理数与无理数时Koopman谱的情况，论述点谱是有限的、可数的，以及是否在单位圆上是稠密的。简要地将谱的性质与理想化的、无噪声的动态模态分解（DMD）从沿轨道均匀采样的数据中恢复的结果联系起来。\n\n最后，设 $f_{n}(x) = \\exp(\\mathrm{i} n x)$，其中 $n \\in \\mathbb{Z}$ 是一个任意但固定的整数。作为最终答案，报告与 $f_{n}$ 相关的Koopman特征值 $\\lambda_{n}$，以 $n$ 和 $\\omega$ 的函数形式给出精确的符号表达式。不需要数值近似，最终答案中不包含单位。",
            "solution": "所提出的问题陈述是一个定义明确且具有科学依据的练习，旨在将Koopman算子理论应用于一个基本动力系统，即圆上的刚性旋转。这是一个用于介绍Koopman谱分析核心概念的标准模型。该问题自洽、数学上精确，并且没有任何事实或逻辑上的不一致。所有术语在动力系统和泛函分析领域都是标准的。因此，该问题是有效的，并将提供解答。\n\n系统动力学由映射 $T: [0, 2\\pi) \\to [0, 2\\pi)$ 给出，定义为 $T(x) = x + \\omega \\pmod{2\\pi}$。与此映射相关的Koopman算子 $\\mathcal{U}$ 通过与动力学复合作用于希尔伯特空间 $\\mathcal{H} = L^{2}([0,2\\pi), \\frac{\\mathrm{d}x}{2\\pi})$ 中的函数 $f$：$(\\mathcal{U}f)(x) = f(T(x)) = f(x+\\omega \\pmod{2\\pi})$。此空间上的内积为 $\\langle g, h \\rangle = \\int_0^{2\\pi} g(x) \\overline{h(x)} \\frac{\\mathrm{d}x}{2\\pi}$。\n\nKoopman算子的特征函数，也称为Koopman模态，是一个非零函数 $f \\in \\mathcal{H}$，它满足特征值方程：\n$$\n\\mathcal{U}f = \\lambda f\n$$\n其中复标量 $\\lambda$ 是对应的Koopman特征值。代入算子的定义，该方程变为：\n$$\nf(x+\\omega \\pmod{2\\pi}) = \\lambda f(x)\n$$\n\n为了找到特征函数和特征值，我们利用希尔伯特空间 $L^{2}([0,2\\pi))$ 的结构。傅里叶分析中的一个基本结果指出，复指数函数集合 $\\{ \\exp(\\mathrm{i} n x) \\}_{n \\in \\mathbb{Z}}$ 构成了此空间的一个完备正交基。我们测试这些基函数作为Koopman特征函数的候选者。\n\n我们定义 $f_n(x) = \\exp(\\mathrm{i} n x)$，对于任意整数 $n \\in \\mathbb{Z}$。这些函数是 $L^{2}([0,2\\pi))$ 的成员，因为它们的模的平方是 $|\\exp(\\mathrm{i} n x)|^2 = 1$，这在 $[0, 2\\pi)$ 上显然是可积的。现在我们将Koopman算子 $\\mathcal{U}$ 应用于 $f_n(x)$：\n$$\n(\\mathcal{U}f_n)(x) = f_n(x+\\omega \\pmod{2\\pi}) = \\exp(\\mathrm{i} n (x+\\omega \\pmod{2\\pi}))\n$$\n由于 $\\exp(\\mathrm{i} z)$ 在其自变量 $z$ 上是 $2\\pi$-周期的，且 $n$ 是整数，函数 $\\exp(\\mathrm{i} n z)$ 的周期为 $2\\pi/|n|$（如果 $n=0$ 则为常数）。这意味着对于任何整数 $k$，$\\exp(\\mathrm{i} n (z + 2\\pi k)) = \\exp(\\mathrm{i} n z)$。因为 $(x+\\omega \\pmod{2\\pi})$ 与 $(x+\\omega)$ 相差 $2\\pi$ 的整数倍，我们可以简化表达式：\n$$\n(\\mathcal{U}f_n)(x) = \\exp(\\mathrm{i} n (x+\\omega)) = \\exp(\\mathrm{i} n x) \\exp(\\mathrm{i} n \\omega)\n$$\n通过代回 $f_n(x) = \\exp(\\mathrm{i} n x)$，我们得到：\n$$\n(\\mathcal{U}f_n)(x) = (\\exp(\\mathrm{i} n \\omega)) f_n(x)\n$$\n这正是特征值方程 $\\mathcal{U}f_n = \\lambda_n f_n$，其中特征函数是 $f_n(x) = \\exp(\\mathrm{i} n x)$，相关的特征值是 $\\lambda_n = \\exp(\\mathrm{i} n \\omega)$。\n这对所有整数 $n \\in \\mathbb{Z}$ 都成立。因此，函数集合 $\\{ \\exp(\\mathrm{i} n x) \\}_{n \\in \\mathbb{Z}}$ 构成了一个完备的Koopman特征函数集。\n\n接下来，我们讨论张成性质和算子的酉性。\n这些特征函数 $\\{f_n(x)\\}_{n \\in \\mathbb{Z}}$ 张成空间 $L^{2}([0,2\\pi))$ 是傅里叶分析的基石（与Riesz-Fischer定理相关）。任何函数 $g \\in L^{2}([0,2\\pi))$ 都可以通过其傅里叶级数唯一表示，$g(x) = \\sum_{n \\in \\mathbb{Z}} c_n \\exp(\\mathrm{i} n x)$，其中等式在 $L^2$ 意义下成立。这证实了我们的特征函数集是完备的。对于 $n \\neq m$ 时，这些特征函数的正交性源于复指数的基本积分性质：\n$$\n\\langle f_n, f_m \\rangle = \\int_0^{2\\pi} \\exp(\\mathrm{i} n x) \\overline{\\exp(\\mathrm{i} m x)} \\frac{\\mathrm{d}x}{2\\pi} = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(\\mathrm{i} (n-m) x) \\mathrm{d}x = \\delta_{nm}\n$$\n其中 $\\delta_{nm}$ 是克罗内克δ函数。这表明它们构成了一个正交基。\n\nKoopman算子 $\\mathcal{U}$ 在此空间上是酉的。如果一个算子保持内积，则它是酉的。设 $g, h \\in L^{2}([0,2\\pi))$。我们计算它们在 $\\mathcal{U}$ 作用下的像的内积：\n$$\n\\langle \\mathcal{U}g, \\mathcal{U}h \\rangle = \\int_0^{2\\pi} (\\mathcal{U}g)(x) \\overline{(\\mathcal{U}h)(x)} \\frac{\\mathrm{d}x}{2\\pi} = \\int_0^{2\\pi} g(x+\\omega) \\overline{h(x+\\omega)} \\frac{\\mathrm{d}x}{2\\pi}\n$$\n进行变量替换 $y = x+\\omega$，我们有 $\\mathrm{d}y = \\mathrm{d}x$。积分区间 $[0, 2\\pi)$ 变为 $[\\omega, 2\\pi+\\omega)$。由于被积函数 $g(y)\\overline{h(y)}$ 是一个 $2\\pi$-周期函数（因为其组成部分是圆上的函数），在任何长度为 $2\\pi$ 的区间上积分都会得到相同的结果。\n$$\n\\langle \\mathcal{U}g, \\mathcal{U}h \\rangle = \\int_{\\omega}^{2\\pi+\\omega} g(y) \\overline{h(y)} \\frac{\\mathrm{d}y}{2\\pi} = \\int_{0}^{2\\pi} g(y) \\overline{h(y)} \\frac{\\mathrm{d}y}{2\\pi} = \\langle g, h \\rangle\n$$\n由于 $\\mathcal{U}$ 保持内积并且是满射的（其逆是逆映射 $T^{-1}(x) = x-\\omega$ 的Koopman算子），所以它是酉的。这一点也由其所有特征值 $\\lambda_n = \\exp(\\mathrm{i} n \\omega)$ 都位于复平面的单位圆上得到证实，因为对于实数 $n$ 和 $\\omega$，有 $|\\lambda_n| = |\\exp(\\mathrm{i} n \\omega)| = 1$。\n\n最后，我们解释谱。点谱是所有特征值的集合，即 $\\{\\lambda_n = \\exp(\\mathrm{i} n \\omega) \\mid n \\in \\mathbb{Z}\\}$。\n- 如果 $\\omega/(2\\pi)$ 是有理数，即 $\\omega/(2\\pi) = p/q$，其中 $p, q$ 是互质整数且 $q  0$，那么 $\\omega = 2\\pi p/q$。特征值为 $\\lambda_n = \\exp(\\mathrm{i} n (2\\pi p/q))$。这些值是 $q$ 次单位根，不同特征值的集合是 $\\{\\exp(2\\pi \\mathrm{i} k/q)\\}_{k=0}^{q-1}$。因此，点谱是**有限的**，由单位圆上的 $q$ 个点组成。动力学是周期的，周期为 $q$。\n- 如果 $\\omega/(2\\pi)$ 是无理数，那么对于任何两个不同的整数 $n \\neq m$，特征值 $\\lambda_n$ 和 $\\lambda_m$ 是不同的。如果它们不不同，则 $(n-m)\\omega$ 将是 $2\\pi$ 的倍数，这意味着 $\\omega/(2\\pi)$ 是有理数。因此，点谱是**可数无限的**。此外，根据关于丢番图逼近的Jacobi-Kronecker定理，点集 $\\{n\\omega \\pmod{2\\pi}\\}_{n \\in \\mathbb{Z}}$ 在 $[0, 2\\pi)$ 中是稠密的。这意味着特征值集合 $\\{\\lambda_n\\}_{n \\in \\mathbb{Z}}$ 在单位圆上是**稠密的**。动力学是准周期的。\n\n一个理想化的、无噪声的动态模态分解（DMD）算法，当应用于足够长的可观测量轨迹时，旨在近似Koopman算子的特征值和特征函数。\n- 在有理数情况下，系统的轨道是周期的，DMD会正确识别出与基频及其谐波相对应的有限的 $q$ 个特征值。\n- 在无理数情况下，轨道是准周期的，从不重复。应用于有限数据集的DMD只能产生有限数量的特征值。这些DMD特征值将近似真实稠密谱的一个子集，对应于数据中存在的最主要的频率（即，在被测可观测量的展开式中具有大系数的特征函数）。随着数据量的增加，DMD可以解析更多频率，并提供对稠密谱的更好近似。\n\n问题要求给出与特征函数 $f_n(x) = \\exp(\\mathrm{i} n x)$ 相关的特定特征值 $\\lambda_n$。根据我们的推导，这是：\n$\\lambda_n = \\exp(\\mathrm{i} n \\omega)$。",
            "answer": "$$\n\\boxed{\\exp(\\mathrm{i} n \\omega)}\n$$"
        },
        {
            "introduction": "在领略了线性系统的简洁之美后，我们必须面对非线性系统带来的核心挑战：库普曼算子的无穷维特性。本练习通过一个看似简单的二次映射，直观地揭示了这一挑战。通过计算算子对一个基本可观量的作用，你将亲眼见证动力学如何“创造”出新的、更高阶的函数，从而理解为何有限维的近似（如DMD）对于分析非线性系统是不可或缺的。",
            "id": "4219108",
            "problem": "考虑一个标量信息物理系统 (CPS) 的数字孪生，其离散时间状态 $x_{k} \\in \\mathbb{R}$ 根据确定性非线性映射 $f(x) = x^{2}$ 演化。可观测量是用于从状态中提取可测量量的函数 $g : \\mathbb{R} \\to \\mathbb{R}$。在与动态模态分解 (DMD) 相关的算子理论建模背景下，Koopman 算子作用于由系统动力学诱导的可观测量。对于特定可观测量 $g(x) = x$，计算 $(\\mathcal{K}g)(x)$ 的解析表达式。然后，仅使用离散时间动力系统和 Koopman 算子的基本定义，解释为什么这个计算结果意味着对于这个 $f$，多项式可观测量的空间在 $\\mathcal{K}$ 作用下不是有限维不变的。请给出您的推理过程，但将最终答案表示为 $(\\mathcal{K}g)(x)$ 的解析表达式。无需四舍五入。",
            "solution": "该问题陈述被评估为具有科学依据、适定且客观。它提供了一个离散时间动力系统，其演化映射为 $f(x) = x^2$，状态为 $x_k \\in \\mathbb{R}$，可观察函数为 $g(x) = x$。任务是计算 Koopman 算子对这个特定可观测量的作用，并利用该结果解释算子在多项式可观测量空间上作用的一个性质。所有定义和条件在动力系统和算子理论领域都是标准的。因此，该问题被认为是有效的。\n\n解答过程首先计算所需的表达式，然后提供后续的推理。\n\nKoopman 算子，记为 $\\mathcal{K}$，描述了定义在动力系统状态空间上的可观察函数的演化。对于一个由映射 $x_{k+1} = f(x_k)$ 控制的离散时间系统，Koopman 算子对可观察函数 $g$ 的作用定义为：\n$$(\\mathcal{K}g)(x) = g(f(x))$$\n\n在这个问题中，状态演化由非线性映射 $f(x) = x^2$ 给出。所考虑的特定可观测量是单位函数，$g(x) = x$。\n\n为了计算 $(\\mathcal{K}g)(x)$ 的解析表达式，我们将给定的函数 $f$ 和 $g$ 代入 Koopman 算子的定义中：\n$$(\\mathcal{K}g)(x) = g(f(x)) = g(x^2)$$\n\n由于函数 $g$ 对任何输入 $z$ 都定义为 $g(z) = z$，我们计算 $g(x^2)$ 如下：\n$$g(x^2) = x^2$$\n\n因此，Koopman 算子 $\\mathcal{K}$ 对可观测量 $g(x)=x$ 作用的解析表达式为：\n$$(\\mathcal{K}g)(x) = x^2$$\n\n接下来，我们必须解释为什么这个结果意味着对于给定的动力学 $f(x) = x^2$，多项式可观测量的空间在 $\\mathcal{K}$ 作用下不是一个有限维不变子空间。\n\n如果对于一个向量空间 $\\mathcal{V}$ 中的每一个向量 $v \\in \\mathcal{V}$，向量 $\\mathcal{L}v$ 也在 $\\mathcal{V}$ 中，那么称 $\\mathcal{V}$ 是线性算子 $\\mathcal{L}$ 下的一个不变子空间。在我们的情境中，向量是可观察函数，算子是 Koopman 算子 $\\mathcal{K}$。\n\n设 $\\mathcal{P}$ 是 $\\mathbb{R}$ 上所有多项式可观测量的空间。$\\mathcal{P}$ 中的一个函数 $p$ 可以写成 $p(x) = \\sum_{j=0}^{d} c_j x^j$ 的形式，其中 $d \\in \\mathbb{N}_0$ 是某个有限次数，$c_j \\in \\mathbb{R}$ 是系数。\n\n让我们分析 $\\mathcal{K}$ 对一个普通单项式可观测量 $h_n(x) = x^n$（其中 $n$ 为非负整数）的作用。\n$$(\\mathcal{K}h_n)(x) = h_n(f(x)) = h_n(x^2) = (x^2)^n = x^{2n}$$\n这表明该系统的 Koopman 算子将一个 $n$ 次单项式映射到一个 $2n$ 次单项式。\n\n现在，为进行反证，我们假设存在一个多项式的有限维子空间 $\\mathcal{G}$，它在 $\\mathcal{K}$ 作用下是不变的，并且是非平凡的（即，它不仅仅包含常数函数）。\n由于 $\\mathcal{G}$ 是一个有限维多项式空间，对于 $\\mathcal{G}$ 中的任何多项式，必然存在一个最大次数 $N$，其中 $N  0$。设 $p(x) \\in \\mathcal{G}$ 是这个最大次数为 $N$ 的多项式。我们可以写出 $p(x) = a_N x^N + \\dots + a_1 x + a_0$，其中 $a_N \\neq 0$。\n\n将 Koopman 算子作用于 $p(x)$：\n$$(\\mathcal{K}p)(x) = p(f(x)) = p(x^2) = a_N (x^2)^N + \\dots + a_1 (x^2) + a_0 = a_N x^{2N} + \\dots + a_1 x^2 + a_0$$\n得到的函数 $(\\mathcal{K}p)(x)$ 是一个多项式。其次数由 $x$ 的最高次幂决定，即 $2N$。\n由于我们假设 $N0$，因此 $2N  N$。\n\n要使 $\\mathcal{G}$ 成为一个不变子空间，函数 $(\\mathcal{K}p)(x)$ 也必须是 $\\mathcal{G}$ 的一个元素。然而，$(\\mathcal{K}p)(x)$ 的次数是 $2N$，这严格大于 $\\mathcal{G}$ 中任何多项式的最大次数 $N$。这意味着 $(\\mathcal{K}p)(x) \\notin \\mathcal{G}$，这与我们假设 $\\mathcal{G}$ 是一个不变子空间相矛盾。\n\n避免该矛盾的唯一方法是 $N \\le 0$。如果 $N=0$，该子空间仅由常数函数 $g(x)=c$ 组成。对于这样的函数，$(\\mathcal{K}g)(x) = g(x^2) = c$，它仍然是一个常数。因此，常数函数空间是一个平凡的一维不变子空间。然而，任何最大次数 $N  0$ 的有限维多项式空间都不可能是不变的。\n\n最初的计算 $(\\mathcal{K}\\{x\\})(x) = x^2$ 是这个论证的基础情形。它表明一个 1 次的可观测量被映射到一个 2 次的可观测量。重复应用该算子会生成一个次数无限增大的可观测量序列：\n$$g_0(x) = x$$\n$$(\\mathcal{K}g_0)(x) = x^2$$\n$$(\\mathcal{K}^2 g_0)(x) = \\mathcal{K}(x^2) = (x^2)^2 = x^4$$\n$$(\\mathcal{K}^n g_0)(x) = x^{2^n}$$\n任何有限维多项式空间都会有一个最大次数，对简单可观测量 $g(x)=x$ 应用足够多次 $\\mathcal{K}$ 将会产生一个次数超过此最大次数的多项式，从而离开该空间。因此，所有多项式可观测量的空间不能被此 Koopman 算子下的一个有限维不变子空间所表示。这就是为什么像 DMD 这样的有限维近似方法对于某些非线性系统可能具有挑战性的一个关键原因。",
            "answer": "$$\\boxed{x^2}$$"
        },
        {
            "introduction": "理论的优雅与现实的复杂在此交汇。既然我们已经认识到需要像DMD这样的方法来近似无穷维的库普曼算子，那么下一个关键问题便是：如何构建一个恰到好处的模型？本练习聚焦于DMD应用中最关键的决策——选择截断秩$r$。这不仅是一个技术选择，更是在模型偏差与方差之间寻求最佳平衡的艺术，它要求我们评估各种模型选择策略，以确保我们从含噪数据中构建的数字孪生具有对未来行为的可靠预测能力。",
            "id": "4219089",
            "problem": "使用动态模态分解 (DMD) 方法，根据状态快照的时间序列，为一个反馈稳定的信息物理系统 (CPS) 构建一个数字孪生。动态模态分解 (DMD) 旨在寻找一个低维线性模型，该模型能将快照在时间上向前推进，并可被解释为作用于选定观测量上的 Koopman 算子的有限维近似。标准流程是将奇异值分解 (SVD) 应用于快照矩阵，并在估计降维后的线性映射之前将其截断到秩 $r$。在实践中，截断秩 $r$ 控制着模型的复杂度：较大的 $r$ 允许模型拟合更精细的结构（包括噪声），而较小的 $r$ 则强制生成更平滑、方差更低的模型，但可能会错过重要的动态特性。假设数据受到具有近似高斯统计特性的传感器噪声的污染，且验证目标是在代表预期操作范围的预留轨迹上的多步预测误差。\n\n从第一性原理的角度来看，对 $r$ 的选择应该平衡偏差和方差，反映 CPS 的物理特性，并由泛化性能而非训练拟合度来证明其合理性。请考虑以下选择 $r$ 的候选方法：\n\nA. 选择 $r$ 作为最小的值，使得快照矩阵的前 $r$ 个奇异值所捕获的累积能量超过一个从传感器噪声水平估计中得出的阈值 $\\tau$，然后通过对预留数据进行多步预测误差的 $k$ 折交叉验证来确认 $r$。对于闭环稳定的 CPS，作为后处理稳定性滤波器，丢弃那些离散时间特征值模长超过 $1$ 的模态。\n\nB. 选择数据矩阵维度所允许的最大可能秩 $r$ 以最小化近似偏差，因为 DMD 模型是线性的，因此不太可能过拟合。\n\nC. 仅通过最小化训练快照上的一步重构误差来选择 $r$，当增加 $r$ 带来的误差边际减少量低于一个固定容差时（例如，相对减少量小于 $1\\%$）停止，不进行任何交叉验证或施加模型复杂度惩罚。\n\nD. 通过最小化一个最小描述长度 (MDL) 目标来选择 $r$。该目标在验证数据上进行评估，权衡了高斯噪声模型下的数据拟合编码长度与随秩 $r$ 引入的自由参数数量而增加的模型编码长度；然后，为减少估计量的方差，应用 1-标准误规则，选择其验证分数位于最优值的一个估计标准误差范围内的最小的 $r$。\n\n上述选项中，哪些是选择 DMD 截断秩 $r$ 的有原则的标准，这些标准显式或隐式地平衡了偏差和方差，同时尊重 CPS 的背景并旨在实现样本外预测性能？选择所有适用的选项。\n\n重要定义：奇异值分解 (SVD)；动态模态分解 (DMD)；最小描述长度 (MDL)；Koopman 算子；交叉验证 (CV)。",
            "solution": "该问题要求评估四种不同的方法，用于在一个反馈稳定的信息物理系统 (CPS) 的动态模态分解 (DMD) 模型中选择截断秩 $r$。模型的数据是带噪声的时间序列快照。既定目标是获得良好的泛化性能，通过在预留数据上的多步预测误差来衡量。这要求所选方法能恰当地平衡偏差-方差权衡。\n\n### 理论基础\n\n动态模态分解提供一个线性算子 $\\mathbf{A}$，该算子能最好地逼近状态快照 $\\mathbf{x}_k \\in \\mathbb{R}^n$ 的演化，使得 $\\mathbf{x}_{k+1} \\approx \\mathbf{A} \\mathbf{x}_k$。标准算法对两个由 $m$ 个快照堆叠而成的矩阵进行操作：\n$$\n\\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_{m-1}] \\quad \\text{和} \\quad \\mathbf{X}' = [\\mathbf{x}_2, \\mathbf{x}_3, \\ldots, \\mathbf{x}_m]\n$$\n目标是找到 $\\mathbf{A}$ 以最小化 $\\|\\mathbf{X}' - \\mathbf{A}\\mathbf{X}\\|_F$。为了使问题成为良态问题并降低模型复杂度，首先用数据矩阵 $\\mathbf{X}$ 的秩为 $r$ 的奇异值分解 (SVD) 来近似它，即 $\\mathbf{X} \\approx \\mathbf{U}_r \\mathbf{\\Sigma}_r \\mathbf{V}_r^*$。然后，在前 $r$ 个 POD (本征正交分解) 模态的降维空间中构造 DMD 算子，得到一个 $r \\times r$ 的矩阵 $\\tilde{\\mathbf{A}} = \\mathbf{U}_r^* \\mathbf{X}' \\mathbf{V}_r \\mathbf{\\Sigma}_r^{-1}$。\n\n截断秩 $r$ 的选择至关重要。\n- 较小的 $r$ 会导致低复杂度模型。这会带来高偏差（模型可能过于简单，无法捕捉真实的动态特性），但方差较低（模型对训练数据中的特定噪声实现不那么敏感）。\n- 较大的 $r$ 会导致高复杂度模型。这会带来低偏差（模型可以很好地拟合训练数据），但方差较高（模型很可能拟合了噪声，导致在新数据上表现不佳，即过拟合）。\n\n因此，一个选择 $r$ 的“有原则的标准”必须在这种权衡中进行抉择，以优化样本外性能，而不仅仅是样本内（训练）的拟合度。它还应结合关于数据（噪声特性）和系统（如稳定性等物理属性）的知识。\n\n### 候选方法评估\n\n**选项 A：选择 $r$ 作为最小的值，使得快照矩阵的前 $r$ 个奇异值所捕获的累积能量超过一个从传感器噪声水平估计中得出的阈值 $\\tau$，然后通过对预留数据进行多步预测误差的 $k$ 折交叉验证来确认 $r$。对于闭环稳定的 CPS，作为后处理稳定性滤波器，丢弃那些离散时间特征值模长超过 $1$ 的模态。**\n\n该方法由三个方法论上合理的步骤组成：\n1.  **基于噪声的阈值法：** 前提是数据被高斯噪声污染。随机矩阵理论提供了方法（例如，与 Marcenko-Pastur 分布相关的方法）来估计奇异值谱中可归因于噪声的部分。基于估计的噪声方差设置阈值 $\\tau$ 是对奇异值执行“最优硬阈值法”的一种有原则的方法。这直接解决了将信号与噪声分离的问题，旨在选择一个能保留动态上显著的模态，同时丢弃那些被噪声主导的模态的秩 $r$。这是一种直接的方差控制方法。\n2.  **交叉验证 (CV)：** $k$ 折交叉验证是估计模型泛化性能的一个稳健的、经验性的标准。通过在预留数据上评估多步预测误差，这一步骤直接解决了既定的验证目标。它提供了一个明确的检验，来判断秩 $r$（可能从第一步建议的一系列候选中选择）是否产生了一个能在未见过的数据上很好预测的模型。这是经验上管理偏差-方差权衡的典型方法。\n3.  **稳定性后处理：** 问题指出该 CPS 是反馈稳定的，这意味着其动态是稳定的。离散时间 DMD 模型中任何不稳定的特征值（模长 $ 1$）很可能是噪声和过拟合的产物。移除这些伪模态或将动态投影到稳定子空间，是将先验物理知识融入模型的一种有效且常见的技术，可以提高模型的长期预测精度和物理真实性。\n\n该选项结合了一种用于噪声去除的有理论基础的启发式方法、模型选择的经验黄金标准 (CV) 以及先验物理知识的运用。这种多管齐下的策略是非常有原则的。\n\n**结论：正确**\n\n**选项 B：选择数据矩阵维度所允许的最大可能秩 $r$ 以最小化近似偏差，因为 DMD 模型是线性的，因此不太可能过拟合。**\n\n该方法存在两个根本性缺陷：\n1.  **忽略方差：** 选择最大可能秩 $r$ 等同于最小化训练数据上的重构误差。这完全专注于最小化*相对于训练数据*（包括噪声）的偏差。它完全忽略了误差的方差部分。这样的模型将具有最大复杂度，几乎肯定会过拟合噪声，导致泛化性能不佳。\n2.  **不正确的理由：** 声称线性模型“不太可能过拟合”是错误的。具有大量参数的线性模型很容易过拟合。降维 DMD 算子 $\\tilde{\\mathbf{A}}$ 中的参数数量为 $r^2$。随着 $r$ 的增加，模型拟合噪声的能力呈平方级增长。动态 $\\mathbf{x}_{k+1} = \\mathbf{A} \\mathbf{x}_k$ 的线性性质绝不能阻止矩阵 $\\mathbf{A}$ 本身在估计阶段发生过拟合。\n\n这种方法违背了平衡偏差和方差的核心原则。\n\n**结论：不正确**\n\n**选项 C：仅通过最小化训练快照上的一步重构误差来选择 $r$，当增加 $r$ 带来的误差边际减少量低于一个固定容差时（例如，相对减少量小于 $1\\%$）停止，不进行任何交叉验证或施加模型复杂度惩罚。**\n\n该方法与选项 B 有相同的根本问题，尽管它看起来更微妙。\n1.  **专注于训练误差：** 该标准完全基于训练数据上的一步重构误差 ($\\|\\mathbf{X}' - \\mathbf{A}_r\\mathbf{X}\\|_F$)。这个误差度量是 $r$ 的单调递减函数。在该度量上表现良好的模型并不能保证泛化得好。\n2.  **启发式停止规则：** “肘部”法则（当性能的边际增益变小时停止）是一种常见但较弱的启发式方法。它没有强有力的理论依据来找到泛化的最佳权衡点。训练误差曲线变平的点可能在模型开始显著拟合噪声之后很久才出现。\n3.  **明确拒绝有原则的方法：** 该方法明确说明其执行时“不进行任何交叉验证或施加模型复杂度惩罚”。这凸显了其主要弱点：它缺乏估计或控制样本外误差的机制。\n\n这种方法倾向于选择一个过拟合训练数据的过于复杂的模型。\n\n**结论：不正确**\n\n**选项 D：通过最小化一个最小描述长度 (MDL) 目标来选择 $r$。该目标在验证数据上进行评估，权衡了高斯噪声模型下的数据拟合编码长度与随秩 $r$ 引入的自由参数数量而增加的模型编码长度；然后，为减少估计量的方差，应用 1-标准误规则，选择其验证分数位于最优值的一个估计标准误差范围内的最小的 $r$。**\n\n该方法描述了一种植根于信息论和统计学的、复杂且有原则的方法。\n1.  **最小描述长度 (MDL)：** MDL 是奥卡姆剃刀定律的一种形式化实现。它寻求能为数据提供最紧凑描述的模型。这涉及到最小化一个成本函数，该函数结合了编码模型预测误差的成本（数据拟合）和编码模型本身的成本（模型复杂度）。模型复杂度项充当了正则化惩罚项。由于 DMD 模型中的参数数量随 $r$ 变化（按 $r^2$ 比例），MDL 提供了一种理论上合理的方式来平衡模型拟合度与模型复杂度，从而直接解决偏差-方差权衡问题。在验证数据上进行评估进一步确保了重点在于泛化能力。\n2.  **1-标准误规则：** 这是一种标准且稳健的统计启发式方法，与交叉验证或验证集评估结合使用。在找到具有最小验证误差的模型（“最优”模型）后，该规则选择性能与最优模型在统计上无法区分（即，在最小误差的一个标准误差范围内）的最简单模型（最小的 $r$）。这明确地偏好更简单、方差更低的模型，并有助于防止在验证集中“追逐噪声”，从而实现更稳健的模型选择。\n\n该选项描述了一种用于管理偏差-方差权衡的形式化、有理论依据的方法，并辅以一个合理的统计规则以增强稳健性。\n\n**结论：正确**\n\n### 总结\n\n选项 A 和 D 都描述了选择 DMD 秩 $r$ 的有原则的、先进的方法。选项 A 是一种实用的、经验驱动的方法，结合了噪声估计、交叉验证和基于物理的约束。选项 D 是一种形式化的、信息论的方法，结合了稳健的统计选择规则。两者都正确地解决了平衡偏差和方差以优化样本外预测性能的需求。选项 B 和 C 是有缺陷的，因为它们专注于训练集性能，并且忽略或误解了过拟合问题。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}