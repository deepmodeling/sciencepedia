{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本练习开始，旨在加深对质量守恒这块流体力学基石的理解。本练习  要求从积分形式的质量守恒定律出发，推导出其微分形式——连续性方程。然后，您将把这个方程应用于一个给定的流场，以检验其是否满足不可压缩条件 $\\nabla \\cdot \\mathbf{u} = 0$，这对于将抽象物理原理与构成 CFD 代码基础的具体数学方程联系起来至关重要。",
            "id": "4209477",
            "problem": "一个信息物理系统（CPS）的数字孪生（DT）正在针对一个二维计算流体动力学（CFD）代理速度场进行质量守恒验证。考虑一个速度场 $\\mathbf{u}(x,y) = (a x,\\,-a y)$，其中 $a$ 是一个常数，单位为 $\\text{s}^{-1}$，流体密度 $\\rho$ 在空间上均匀且不随时间变化。从任意固定控制体的质量守恒积分表达式出发，推导连续性方程的局部微分形式。然后，计算 $\\nabla \\cdot \\mathbf{u}$，并利用你的推导来评估在给定条件下流动是否不可压缩。请给出计算出的 $\\nabla \\cdot \\mathbf{u}$ 的值，单位为 $\\text{s}^{-1}$。无需四舍五入，报告精确值。",
            "solution": "首先验证该问题，以确保其科学基础扎实、内容自洽且提法得当。\n\n**第一步：提取已知条件**\n- 速度场：$\\mathbf{u}(x,y) = (a x,\\,-a y)$\n- 常数：$a$，单位为 $\\text{s}^{-1}$\n- 流体密度：$\\rho$ 在空间上均匀且不随时间变化。\n- 任务1：从任意固定控制体的质量守恒积分表达式出发，推导连续性方程的局部微分形式。\n- 任务2：计算 $\\nabla \\cdot \\mathbf{u}$。\n- 任务3：利用推导结果评估流动是否不可压缩。\n- 任务4：给出 $\\nabla \\cdot \\mathbf{u}$ 的计算值。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于流体动力学中的质量守恒基本原理（连续性方程），并使用了一个标准的、物理上真实的的速度场（驻点流）。为数字孪生应用计算流体动力学的背景是恰当的。该问题具有科学合理性。\n- **适定性**：问题提供了执行所需推导和计算的全部必要信息。目标明确，且存在唯一有意义的解。\n- **客观性**：问题以精确、客观和技术性的语言陈述。\n\n**第三步：结论与行动**\n该问题被认定为有效。将提供完整解答。\n\n**连续性方程微分形式的推导**\n\n质量守恒原理指出，对于空间中固定的任意控制体 $V$，其边界为 $S$，体积内质量的增加率必须等于流入该体积的净质量流率。其积分形式表示为：\n$$\n\\frac{d}{dt} \\int_V \\rho \\, dV = - \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是速度场，$\\mathbf{n}$ 是指向外部的表面元 $dS$ 的单位法向量。整理后得到标准形式：\n$$\n\\frac{d}{dt} \\int_V \\rho \\, dV + \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS = 0\n$$\n\n第一项表示控制体内质量的变化率，第二项表示通过其表面 $S$ 流出控制体的净质量通量。\n\n由于控制体 $V$ 是固定的，时间导数可以移入积分内部，作用于密度场：\n$$\n\\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\oint_S \\rho (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS = 0\n$$\n\n接下来，我们将散度定理（或 Gauss's Theorem）应用于面积分。该定理指出，对于向量场 $\\mathbf{F}$，有 $\\oint_S \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\int_V \\nabla \\cdot \\mathbf{F} \\, dV$。在我们的情况中，向量场是质量通量密度，即 $\\mathbf{F} = \\rho \\mathbf{u}$。应用该定理将面积分转换为体积分：\n$$\n\\oint_S (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV\n$$\n\n将其代回守恒方程，得到：\n$$\n\\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0\n$$\n\n合并两个体积分，得到：\n$$\n\\int_V \\left( \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) \\right) \\, dV = 0\n$$\n\n该积分方程必须对任意控制体 $V$ 都成立。这只有在被积函数本身在空间中每一点都恒等于零时才可能成立。因此，我们得到了连续性方程的局部微分形式：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n\n**应用于不可压缩流**\n\n问题陈述流体密度 $\\rho$ 在空间上均匀且不随时间变化。\n- “不随时间变化”意味着密度对时间的偏导数为零：$\\frac{\\partial \\rho}{\\partial t} = 0$。\n- “空间上均匀”意味着密度不随位置变化，因此其梯度为零：$\\nabla \\rho = 0$。\n\n将 $\\frac{\\partial \\rho}{\\partial t} = 0$ 代入连续性方程，得到：\n$$\n\\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\n\n使用向量微积分恒等式 $\\nabla \\cdot (f\\mathbf{A}) = f(\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot (\\nabla f)$，其中 $f = \\rho$，$ \\mathbf{A} = \\mathbf{u}$，我们可以展开散度项：\n$$\n\\rho (\\nabla \\cdot \\mathbf{u}) + \\mathbf{u} \\cdot (\\nabla \\rho) = 0\n$$\n\n由于密度在空间上是均匀的，$\\nabla \\rho = 0$，第二项消失：\n$$\n\\rho (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n\n由于流体密度 $\\rho$ 是一个物理性质，必须为非零值（即 $\\rho \\neq 0$），因此该方程只有在速度场的散度为零时才能满足：\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\n\n这个条件，$\\nabla \\cdot \\mathbf{u} = 0$，是不可压缩流的数学定义。如果一个速度场的散度为零，则该速度场被认为是不可压缩的。\n\n**对给定速度场的计算**\n\n问题提供了二维速度场 $\\mathbf{u}(x,y) = (u,v)$，其分量为 $u = ax$ 和 $v = -ay$。我们现在来计算该场的散度。\n\n在二维笛卡尔坐标系中，散度算子由 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$ 给出。\n\n首先，我们计算速度的 $x$ 分量对 $x$ 的偏导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(ax) = a\n$$\n\n接下来，我们计算速度的 $y$ 分量对 $y$ 的偏导数：\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(-ay) = -a\n$$\n\n现在，我们将这些偏导数相加来求散度：\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = a + (-a) = 0\n$$\n\n**评估与最终值**\n\n计算出的速度场散度为 $\\nabla \\cdot \\mathbf{u} = 0$。根据我们的推导，这正是不可压缩流的条件。因此，给定的速度场 $\\mathbf{u}(x,y) = (ax, -ay)$ 代表了一个不可压缩流。\n\n问题要求计算 $\\nabla \\cdot \\mathbf{u}$ 的值。该值为 $0$。常数 $a$ 的单位是 $\\text{s}^{-1}$，因此导数 $\\frac{\\partial u}{\\partial x}$ 和 $\\frac{\\partial v}{\\partial y}$ 的单位也是 $\\text{s}^{-1}$。它们的和，即散度，因此单位也是 $\\text{s}^{-1}$。\n最终值为 $0 \\, \\text{s}^{-1}$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "只有当数值模拟是稳定的时候，它才是有用的。本练习  深入探讨了数值稳定性的关键概念，通过分析一个简单但基础的案例：由恒定流速引起的物质输运。您将使用冯·诺依曼稳定性分析方法，推导出著名的 Courant-Friedrichs-Lewy (CFL) 条件，它规定了显式数值格式所允许的最大时间步长 $\\Delta t$，这对于任何实时数字孪生应用都是一个至关重要的考量。",
            "id": "4209519",
            "problem": "一个长直管道的信息物理数字孪生 (DT) 使用线性平流方程 $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$ 来模拟被动标量场 $\\phi(x,t)$ 在恒定轴向速度 $a$ 下的输运。该DT通过显式前向欧拉时间积分器和与 $a$ 符号一致的一阶 ($1$) 迎风空间离散格式，在间距为 $\\Delta x$ 并具有周期性边界条件的均匀网格上推进场的状态。假设 $a \\ne 0$。为确保DT与其物理对应物之间的数值稳定同步，请确定保证离散格式所有傅里叶模式线性稳定性的最大允许时间步长。\n\n仅从给定的偏微分方程、所述的离散化选择和第一性原理（守恒性、一致性和模式放大有界性）出发，通过要求对所有波数，任何空间傅里叶模式的放大因子模长最多为 $1$ 来推导稳定性约束。然后从此约束中提取最大稳定时间步长，表示为 $a$ 和 $\\Delta x$ 的闭式表达式。\n\n请以 $a$ 和 $\\Delta x$ 的单个闭式符号表达式形式提供您的最终答案。不包含单位。无需进行数值四舍五入。",
            "solution": "首先验证问题陈述，以确保其具有科学依据、自洽且适定。\n\n### 步骤 1：提取已知条件\n- **偏微分方程 (PDE)**: 被动标量 $\\phi(x,t)$ 的线性平流方程为 $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$。\n- **平流速度**: $a$ 是一个常数且 $a \\ne 0$。\n- **数值网格**: 空间域在间距为 $\\Delta x$ 的均匀网格上进行离散化。\n- **边界条件**: 区域具有周期性边界条件。\n- **时间积分格式**: 使用显式前向欧拉方法。\n- **空间离散格式**: 使用一阶迎风格式，其方向根据 $a$ 的符号选择。\n- **稳定性判据**: 任何空间傅里叶模式的放大因子 $\\lambda$ 必须满足 $|\\lambda| \\le 1$。\n- **目标**: 推导稳定性约束，并确定最大允许时间步长 $\\Delta t_{max}$，表示为 $a$ 和 $\\Delta x$ 的闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是针对一个基本偏微分方程的有限差分格式进行 von Neumann 稳定性分析的经典练习。\n- **科学依据**: 线性平流方程是输运现象的基石。前向欧拉和一阶迎风方法是标准（尽管简单）的数值格式。Von Neumann 稳定性分析是在均匀网格和周期性边界条件下分析线性、常系数格式的典范方法。该问题牢固地植根于数值分析和计算流体动力学的原理之中。\n- **适定性**: 所有必要的组成部分都已提供：控制方程、时间和空间离散方法、网格结构以及边界条件。目标清晰明确。\n- **客观性**: 问题以精确、正式的语言陈述，没有任何主观性或歧义。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。它具有科学合理性、适定性，并且提供了唯一解所需的所有信息。我将继续进行推导。\n\n### 解题推导\n\n分析首先构建控制偏微分方程 $\\partial_{t}\\phi + a\\,\\partial_{x}\\phi = 0$ 的全离散形式。设 $\\phi_j^n$ 表示标量场 $\\phi$ 在空间网格点 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 的数值近似。\n\n时间导数使用显式前向欧拉格式进行离散化：\n$$ \\partial_{t}\\phi \\approx \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} $$\n\n空间导数使用一阶迎风格式进行离散化，这取决于速度 $a$ 的符号。“迎风”方向是信息流动的来源方向。\n\n**情况 1：$a > 0$**\n流动方向为正 $x$ 方向。网格点 $j$ 的信息从左侧（即点 $j-1$）传来。迎风空间导数是一个向后差分：\n$$ \\partial_{x}\\phi \\approx \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} $$\n将这些离散化代入偏微分方程得到：\n$$ \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + a \\left( \\frac{\\phi_j^n - \\phi_{j-1}^n}{\\Delta x} \\right) = 0 $$\n求解下一时间步的状态 $\\phi_j^{n+1}$：\n$$ \\phi_j^{n+1} = \\phi_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( \\phi_j^n - \\phi_{j-1}^n \\right) $$\n我们定义 Courant 数 $C$ 为 $C = \\frac{a \\Delta t}{\\Delta x}$。由于 $a > 0$，我们有 $C > 0$。方程变为：\n$$ \\phi_j^{n+1} = (1 - C) \\phi_j^n + C \\phi_{j-1}^n $$\n\n**情况 2：$a  0$**\n流动方向为负 $x$ 方向。网格点 $j$ 的信息从右侧（即点 $j+1$）传来。迎风空间导数是一个向前差分：\n$$ \\partial_{x}\\phi \\approx \\frac{\\phi_{j+1}^n - \\phi_j^n}{\\Delta x} $$\n代入偏微分方程：\n$$ \\frac{\\phi_j^{n+1} - \\phi_j^n}{\\Delta t} + a \\left( \\frac{\\phi_{j+1}^n - \\phi_j^n}{\\Delta x} \\right) = 0 $$\n求解 $\\phi_j^{n+1}$：\n$$ \\phi_j^{n+1} = \\phi_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( \\phi_{j+1}^n - \\phi_j^n \\right) $$\n使用 Courant 数的相同定义 $C = \\frac{a \\Delta t}{\\Delta x}$，此时为负值 ($C  0$)，我们得到：\n$$ \\phi_j^{n+1} = (1 + C) \\phi_j^n - C \\phi_{j+1}^n $$\n为统一分析，使用绝对 Courant 数 $C_{abs} = \\frac{|a| \\Delta t}{\\Delta x}$ 更为方便。注意 $C_{abs}$ 总是非负的。\n对于 $a>0$，$C = C_{abs}$。格式为 $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j-1}^n$。\n对于 $a0$，$C = -C_{abs}$。格式变为 $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j+1}^n$。\n\n现在我们进行 von Neumann 稳定性分析。解的单个傅里叶模式表示为：\n$$ \\phi_j^n = \\hat{\\phi}^n(k) e^{i k x_j} = \\hat{\\phi}^n(k) e^{i k j \\Delta x} $$\n其中 $k$ 是波数，$i = \\sqrt{-1}$。放大因子 $\\lambda(k)$ 关联了连续时间步长上模式的振幅：$\\hat{\\phi}^{n+1}(k) = \\lambda(k) \\hat{\\phi}^n(k)$。稳定性要求对所有波数 $k$，都有 $|\\lambda(k)| \\le 1$。\n\n我们分析 $a$ 的两种情况。\n\n**$a > 0$ 的稳定性分析：**\n将傅里叶模式代入离散方程 $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j-1}^n$ 中：\n$$ \\lambda(k) \\hat{\\phi}^n(k) e^{i k j \\Delta x} = (1 - C_{abs}) \\hat{\\phi}^n(k) e^{i k j \\Delta x} + C_{abs} \\hat{\\phi}^n(k) e^{i k (j-1) \\Delta x} $$\n两边同除以 $\\hat{\\phi}^n(k) e^{i k j \\Delta x}$ 得到放大因子：\n$$ \\lambda(k) = 1 - C_{abs} + C_{abs} e^{-i k \\Delta x} $$\n令 $\\theta = k \\Delta x$ 为无量纲相位角。\n$$ \\lambda(\\theta) = 1 - C_{abs} + C_{abs}(\\cos\\theta - i\\sin\\theta) = (1 - C_{abs} + C_{abs}\\cos\\theta) - i(C_{abs}\\sin\\theta) $$\n放大因子的模长平方为：\n$$ |\\lambda(\\theta)|^2 = (1 - C_{abs} + C_{abs}\\cos\\theta)^2 + (-C_{abs}\\sin\\theta)^2 $$\n$$ |\\lambda(\\theta)|^2 = (1-C_{abs})^2 + 2C_{abs}(1-C_{abs})\\cos\\theta + C_{abs}^2\\cos^2\\theta + C_{abs}^2\\sin^2\\theta $$\n$$ |\\lambda(\\theta)|^2 = (1-C_{abs})^2 + 2C_{abs}(1-C_{abs})\\cos\\theta + C_{abs}^2 $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs} + C_{abs}^2 + 2C_{abs}\\cos\\theta - 2C_{abs}^2\\cos\\theta + C_{abs}^2 $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - \\cos\\theta) + 2C_{abs}^2(1 - \\cos\\theta) $$\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) $$\n为保证稳定性，须有 $|\\lambda(\\theta)|^2 \\le 1$。\n$$ 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) \\le 1 $$\n$$ -2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) \\le 0 $$\n由于 $C_{abs} = \\frac{|a|\\Delta t}{\\Delta x} > 0$ 且项 $(1 - \\cos\\theta)$ 总是非负的（范围从 $0$ 到 $2$），该不等式成立的充分必要条件是：\n$$ 1 - C_{abs} \\ge 0 \\implies C_{abs} \\le 1 $$\n\n**$a  0$ 的稳定性分析：**\n将傅里叶模式代入离散方程 $\\phi_j^{n+1} = (1 - C_{abs}) \\phi_j^n + C_{abs} \\phi_{j+1}^n$ 中：\n$$ \\lambda(k) \\hat{\\phi}^n(k) e^{i k j \\Delta x} = (1 - C_{abs}) \\hat{\\phi}^n(k) e^{i k j \\Delta x} + C_{abs} \\hat{\\phi}^n(k) e^{i k (j+1) \\Delta x} $$\n两边同除以 $\\hat{\\phi}^n(k) e^{i k j \\Delta x}$：\n$$ \\lambda(k) = 1 - C_{abs} + C_{abs} e^{i k \\Delta x} $$\n$$ \\lambda(\\theta) = 1 - C_{abs} + C_{abs}(\\cos\\theta + i\\sin\\theta) = (1 - C_{abs} + C_{abs}\\cos\\theta) + i(C_{abs}\\sin\\theta) $$\n模长平方为：\n$$ |\\lambda(\\theta)|^2 = (1 - C_{abs} + C_{abs}\\cos\\theta)^2 + (C_{abs}\\sin\\theta)^2 $$\n结果与 $a > 0$ 的情况相同：\n$$ |\\lambda(\\theta)|^2 = 1 - 2C_{abs}(1 - C_{abs})(1 - \\cos\\theta) $$\n因此稳定性条件也相同：$C_{abs} \\le 1$。\n\n**关于稳定性的结论：**\n对于任何非零速度 $a$，数值格式稳定的充分必要条件是绝对 Courant 数小于或等于 $1$。\n$$ C_{abs} = \\frac{|a| \\Delta t}{\\Delta x} \\le 1 $$\n这就是该特定数值方法著名的 Courant-Friedrichs-Lewy (CFL) 条件。当此不等式取等号时，可找到最大允许时间步长 $\\Delta t_{max}$：\n$$ \\frac{|a| \\Delta t_{max}}{\\Delta x} = 1 $$\n求解 $\\Delta t_{max}$ 得到最终表达式：\n$$ \\Delta t_{max} = \\frac{\\Delta x}{|a|} $$",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|a|}}$$"
        },
        {
            "introduction": "由于速度和压力之间的紧密耦合，求解不可压缩流体问题带来了独特的挑战。本练习  将介绍投影法，这是一种在许多 CFD 求解器中用于强制执行无散度约束的优雅而强大的算法。通过完整地执行一个投影步骤，您将看到一个中间速度场 $\\mathbf{u}^*$ 是如何被“投影”到一个物理上真实的、不可压缩的解空间上的，从而突显出压力在此过程中的关键作用。",
            "id": "4209490",
            "problem": "一个信息物理系统（CPS）管道段内部流动的数字孪生（DT）是使用计算流体动力学（CFD）中用于不可压缩流的标准交错网格投影法来模拟的。考虑一个二维周期性域 $\\Omega = [0,2\\pi] \\times [0,2\\pi]$。流体密度为常数 $\\rho$，时间步长为 $\\Delta t$。在一个分步更新中，一个中间速度场 $\\mathbf{u}^{*}(x,y)$ 可从一个不包含压力的临时动量步中获得。为了在下一个时间步强制数字孪生中的不可压缩性，引入一个标量压力场 $p(x,y)$，它满足与周期性域上质量守恒一致的泊松方程。具体来说，$p$ 的确定方式是使得校正后的速度场 $\\mathbf{u}^{n+1}(x,y)$ 满足不可压缩性约束和周期性边界条件。\n\n给定中间速度场\n$$\n\\mathbf{u}^{*}(x,y) = \\begin{pmatrix}\n\\sin(x)\\cos(y) \\\\\n\\cos(x)\\sin(y)\n\\end{pmatrix},\n$$\n以及压力场 $p(x,y)$ 在 $\\Omega$ 上求解具有周期性边界条件和零均值条件的泊松方程，\n$$\n\\nabla^{2} p = \\frac{\\rho}{\\Delta t}\\,\\nabla \\cdot \\mathbf{u}^{*}, \\quad \\int_{\\Omega} p \\, dx\\,dy = 0.\n$$\n\n仅从校正后速度的不可压缩性约束 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ 和强制该约束的分步投影的定义出发，推导 $\\mathbf{u}^{n+1}$、$\\mathbf{u}^{*}$ 和 $p$ 之间的校正关系。然后，使用给定的 $\\mathbf{u}^{*}$ 和关于 $p$ 的周期性泊松方程，计算在 $\\Omega$ 上投影后的速度场 $\\mathbf{u}^{n+1}(x,y)$ 的闭式表达式。\n\n将最终答案表示为使用 $\\mathrm{pmatrix}$ 环境组合成行矩阵的两个分量的单个解析表达式。无需四舍五入。",
            "solution": "该问题要求我们首先推导不可压缩流的分步投影法中的校正关系，然后应用此框架，根据给定的特定中间速度场 $\\mathbf{u}^{*}$，求出最终的无散速度场 $\\mathbf{u}^{n+1}$。\n\n分步投影法将不可压缩Navier-Stokes方程的速度和压力更新解耦。从时间步 $n$ 到 $n+1$ 的更新分为两个概念阶段。\n\n首先，通过在时间上推进动量方程，但明确忽略压力梯度项，计算出一个临时或中间速度场，我们记为 $\\mathbf{u}^{*}$。此步骤通常考虑对流、扩散和体力。问题直接提供了这个中间场，所以我们无需关心其计算过程。\n\n其次，应用一个校正或投影步来强制不可压缩性约束 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。此步骤引入了压力场 $p$ 的影响。最终速度 $\\mathbf{u}^{n+1}$、中间速度 $\\mathbf{u}^{*}$ 和压力 $p$ 之间的关系是通过仅考虑压力梯度在时间步 $\\Delta t$ 内对动量变化的贡献来定义的。对动量方程的压力校正部分使用一阶时间离散，我们有：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^{*}}{\\Delta t} = -\\frac{1}{\\rho}\\nabla p\n$$\n该方程分离了压力梯度在校正速度场中的作用。重新整理此方程可得到所需的校正关系：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p\n$$\n这个关系将最终的无散速度场 $\\mathbf{u}^{n+1}$ 表示为中间场 $\\mathbf{u}^{*}$ 与一个和压力场梯度成正比的校正项之和。物理上，这种校正将中间速度场“投影”到无散矢量场的空间上。\n\n为了找到确保这一点的特定压力场 $p$，我们将不可压缩性约束 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ 应用于校正关系。对两边取散度，我们得到：\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = \\nabla \\cdot \\left( \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p \\right)\n$$\n设 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$ 并使用恒等式 $\\nabla \\cdot (\\nabla p) = \\nabla^2 p$，我们得到：\n$$\n0 = \\nabla \\cdot \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla^2 p\n$$\n对 $\\nabla^2 p$ 进行整理，得到压力泊松方程：\n$$\n\\nabla^2 p = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*}\n$$\n这证实了问题的结构与标准投影法是一致的。现在，我们使用给定的数据继续求解 $\\mathbf{u}^{n+1}$。\n\n**步骤 1：计算中间速度场 $\\mathbf{u}^{*}$ 的散度。**\n给定的中间速度场为：\n$$\n\\mathbf{u}^{*}(x,y) = \\begin{pmatrix} u^{*}(x,y)  v^{*}(x,y) \\end{pmatrix} = \\begin{pmatrix} \\sin(x)\\cos(y)  \\cos(x)\\sin(y) \\end{pmatrix}\n$$\n散度计算如下：\n$$\n\\nabla \\cdot \\mathbf{u}^{*} = \\frac{\\partial u^{*}}{\\partial x} + \\frac{\\partial v^{*}}{\\partial y} = \\frac{\\partial}{\\partial x}(\\sin(x)\\cos(y)) + \\frac{\\partial}{\\partial y}(\\cos(x)\\sin(y))\n$$\n$$\n\\nabla \\cdot \\mathbf{u}^{*} = \\cos(x)\\cos(y) + \\cos(x)\\cos(y) = 2\\cos(x)\\cos(y)\n$$\n\n**步骤 2：求解压力泊松方程。**\n将散度代入泊松方程，得到：\n$$\n\\nabla^2 p = \\frac{\\rho}{\\Delta t} (2\\cos(x)\\cos(y)) = \\frac{2\\rho}{\\Delta t} \\cos(x)\\cos(y)\n$$\n我们​​需要在周期性域 $\\Omega = [0,2\\pi] \\times [0,2\\pi]$ 上求解这个二阶偏微分方程，并满足约束条件 $\\int_{\\Omega} p \\, dx\\,dy = 0$。根据右侧项的形式，我们假设一个形式为 $p(x,y) = C \\cos(x)\\cos(y)$ 的解，其中 $C$ 是一个待定常数。我们计算这个试探解的拉普拉斯算子：\n$$\n\\frac{\\partial p}{\\partial x} = -C \\sin(x)\\cos(y) \\implies \\frac{\\partial^2 p}{\\partial x^2} = -C \\cos(x)\\cos(y)\n$$\n$$\n\\frac{\\partial p}{\\partial y} = -C \\cos(x)\\sin(y) \\implies \\frac{\\partial^2 p}{\\partial y^2} = -C \\cos(x)\\cos(y)\n$$\n$$\n\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -C \\cos(x)\\cos(y) - C \\cos(x)\\cos(y) = -2C \\cos(x)\\cos(y)\n$$\n将其与泊松方程的右侧项相等：\n$$\n-2C \\cos(x)\\cos(y) = \\frac{2\\rho}{\\Delta t} \\cos(x)\\cos(y)\n$$\n该等式必须对所有 $(x,y)$ 成立，所以我们可以令系数相等：\n$$\n-2C = \\frac{2\\rho}{\\Delta t} \\implies C = -\\frac{\\rho}{\\Delta t}\n$$\n因此，压力场为 $p(x,y) = -\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)$。该解满足周期性边界条件。我们验证零均值条件：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left(-\\frac{\\rho}{\\Delta t}\\cos(x)\\cos(y)\\right) dx\\,dy = -\\frac{\\rho}{\\Delta t} \\left(\\int_{0}^{2\\pi}\\cos(x)dx\\right) \\left(\\int_{0}^{2\\pi}\\cos(y)dy\\right) = -\\frac{\\rho}{\\Delta t} (0)(0) = 0\n$$\n该条件得到满足，因此这是压力的唯一解。\n\n**步骤 3：计算压力梯度 $\\nabla p$。**\n利用 $p(x,y)$ 的表达式，我们计算其梯度：\n$$\n\\nabla p = \\begin{pmatrix} \\frac{\\partial p}{\\partial x}  \\frac{\\partial p}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial x}\\left(-\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)\\right)  \\frac{\\partial}{\\partial y}\\left(-\\frac{\\rho}{\\Delta t} \\cos(x)\\cos(y)\\right) \\end{pmatrix}\n$$\n$$\n\\nabla p = \\begin{pmatrix} \\frac{\\rho}{\\Delta t} \\sin(x)\\cos(y)  \\frac{\\rho}{\\Delta t} \\cos(x)\\sin(y) \\end{pmatrix}\n$$\n提出常数项后，我们发现一个有趣的关系：\n$$\n\\nabla p = \\frac{\\rho}{\\Delta t} \\begin{pmatrix} \\sin(x)\\cos(y)  \\cos(x)\\sin(y) \\end{pmatrix} = \\frac{\\rho}{\\Delta t} \\mathbf{u}^{*}\n$$\n\n**步骤 4：计算最终校正后的速度场 $\\mathbf{u}^{n+1}$。**\n我们将计算出的压力梯度代回校正关系中：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p\n$$\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\left( \\frac{\\rho}{\\Delta t} \\mathbf{u}^{*} \\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\mathbf{u}^{*} = \\mathbf{0}\n$$\n因此，最终校正后的速度场是零矢量场：\n$$\n\\mathbf{u}^{n+1}(x,y) = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n这个结果是 Helmholtz-Hodge 分解的推论。投影法将 $\\mathbf{u}^{*}$ 分解为一个无散部分（旋转分量）和一个无旋部分（梯度分量）。最终速度 $\\mathbf{u}^{n+1}$ 是其无散部分。在这个具体问题中，中间场 $\\mathbf{u}^{*}$ 是一个纯粹的梯度场（即，它是无旋的，因为 $\\frac{\\partial v^*}{\\partial x} - \\frac{\\partial u^*}{\\partial y} = -\\sin(x)\\sin(y) - (-\\sin(x)\\sin(y)) = 0$），对应于无旋分量。投影操作正确地识别并移除了整个梯度分量，留下了零速度场作为无散部分。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}$$"
        }
    ]
}