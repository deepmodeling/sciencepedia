{
    "hands_on_practices": [
        {
            "introduction": "This exercise tackles a foundational challenge in any Hardware-in-the-Loop (HIL) setup: the interface between the digital and physical domains. Before complex control strategies can be tested, signals from the real-time simulator must be correctly scaled to match the voltage or current ranges expected by the physical hardware. This practice will guide you through using first principles of dimensional analysis to design the essential scaling factors that ensure seamless and accurate communication between the simulated model and the device under test .",
            "id": "3845342",
            "problem": "A digital real-time simulator (DRTS) is used for hardware-in-the-loop (HIL) testing of a current-controlled power converter. The simulated plant is modeled in International System of Units (SI), so the inductor current state variable is in amperes. The physical controller hardware expects an analog input voltage from the DRTS on a dedicated analog channel that represents the commanded inductor current. The analog input voltage range is from $0$ to $10$ volts, and the inductor current command range is from $0$ to $100$ amperes. The DRTS analog output stage is calibrated so that $0$ volts is produced when the output command is zero and the stage saturates at $10$ volts; offset and gain errors are negligible for the purpose of design.\n\nStarting from first principles of dimensional analysis and linear mappings between physical quantities, justify the use of an affine mapping between the simulated current and the output voltage that preserves the endpoints. Then, under the stated constraints that $0$ amperes must map to $0$ volts and $100$ amperes must map to $10$ volts, compute the scaling factor (gain) that multiplies the inductor current to produce the analog voltage. Express the scaling factor in $\\text{V/A}$. The final answer must be a single real number.",
            "solution": "The problem requires a formal justification for the use of a specific function to map a simulated physical quantity, inductor current $I$ (in amperes, $\\text{A}$), to an analog signal, voltage $V$ (in volts, $\\text{V}$). The function must satisfy specific boundary conditions. Following this justification, the scaling factor of this function must be computed.\n\nFirst, we justify the choice of the function $V = f(I)$. The simplest continuous function that maps one interval of real numbers to another is an affine transformation. This type of function is described by the general form:\n$$V = kI + V_0$$\nwhere $k$ is the scaling factor (or gain) and $V_0$ is the offset. This choice is supported by the principle of parsimony, as a more complex, non-linear function would require additional justification or constraints not provided in the problem statement.\n\nWe must verify that this functional form is dimensionally consistent. Let $[X]$ denote the physical dimension of a quantity $X$. The dimension of voltage is electric potential, and the dimension of current is electric current. For the equation to be valid, each term must have the dimension of electric potential.\n$$[V] = [k][I] + [V_0]$$\nThis implies that the dimension of the offset, $[V_0]$, must be the same as the dimension of voltage, $[V]$. It also implies that the dimension of the product $kI$, $[k][I]$, must be equal to $[V]$. Consequently, the dimension of the scaling factor $k$ must be:\n$$[k] = \\frac{[V]}{[I]}$$\nThis corresponds to units of volts per ampere ($\\text{V/A}$), which is dimensionally equivalent to electrical resistance. The affine mapping is, therefore, physically and dimensionally sound.\n\nThe problem specifies the domain and codomain for this mapping, as well as the behavior at the endpoints. The input current range is from $I_{min} = 0 \\text{ A}$ to $I_{max} = 100 \\text{ A}$. The output voltage range is from $V_{min} = 0 \\text{ V}$ to $V_{max} = 10 \\text{ V}$. The mapping must satisfy the following two conditions:\n$1$. $f(I_{min}) = V_{min} \\implies f(0 \\text{ A}) = 0 \\text{ V}$\n$2$. $f(I_{max}) = V_{max} \\implies f(100 \\text{ A}) = 10 \\text{ V}$\n\nWe can use these two conditions to determine the unknown parameters $k$ and $V_0$ by substituting them into the general affine equation $V = kI + V_0$.\n\nUsing the first condition:\n$$0 \\text{ V} = k \\cdot (0 \\text{ A}) + V_0$$\nThis equation immediately yields the value of the offset:\n$$V_0 = 0 \\text{ V}$$\nThe fact that the offset is zero indicates that the relationship is not just affine, but purely linear (a direct proportionality). This aligns perfectly with the problem stating that \"$0$ volts is produced when the output command is zero\" and \"offset and gain errors are negligible\". The mapping function simplifies to:\n$$V = kI$$\n\nNow, we apply the second condition to this simplified linear function:\n$$10 \\text{ V} = k \\cdot (100 \\text{ A})$$\nSolving for the scaling factor $k$:\n$$k = \\frac{10 \\text{ V}}{100 \\text{ A}}$$\n$$k = 0.1 \\text{ V/A}$$\n\nThe scaling factor, or gain, is therefore $0.1 \\text{ V/A}$. The use of an affine mapping is justified as it represents the simplest dimensionally consistent function whose two parameters are uniquely determined by the two physical constraints provided. The derived linear relationship $V = (0.1 \\text{ V/A}) \\cdot I$ correctly maps the entire current range $[0 \\text{ A}, 100 \\text{ A}]$ to the voltage range $[0 \\text{ V}, 10 \\text{ V}]$, preserving the endpoint relationships.",
            "answer": "$$\\boxed{0.1}$$"
        },
        {
            "introduction": "With the physical interface established, our focus shifts to the heart of the HIL system: the digital controller. Since the controller operates in discrete time while the plant exists in continuous time, we must carefully translate our control laws and understand the stability implications of this conversion. This problem explores the critical process of discretizing a continuous-time controller and analyzing how the choice of sampling time, $T_s$, directly impacts the stability of the entire closed-loop system .",
            "id": "4225889",
            "problem": "A Hardware-in-the-Loop (HIL) experiment couples a digital controller to a physical continuous-time plant. Consider a unity-feedback loop where the plant is modeled by the first-order transfer function $P(s) = \\frac{1}{s + 1}$ and the continuous-time controller is a pure integral controller $C(s) = \\frac{K_i}{s}$ with $K_i = 3\\,\\text{s}^{-1}$. The controller is implemented digitally and interacts with the continuous plant through sampling and holding. The plant input is held constant over each sampling interval by a Zero-Order Hold (ZOH). The controller is discretized via the Tustin transform (bilinear transform), which you must derive starting from the trapezoidal rule applied to the integrator dynamics.\n\nStarting from fundamental definitions and well-tested formulas, do the following:\n- Derive the discrete-time controller $C_d(z)$ from $C(s)$ using the trapezoidal rule interpretation of the Tustin transform, expressed as a function of the sampling time $T_s$.\n- Derive the exact ZOH-discretized pulse transfer function of the plant, $P_d(z)$, as a function of $T_s$.\n- Form the closed-loop characteristic polynomial in the $z$-domain for unity feedback and analyze its stability using a rigorous second-order Jury stability criterion.\n- Determine the largest sampling time $T_s$ (in seconds) that guarantees discrete-time closed-loop stability in the HIL setting.\n\nRound your final numerical answer to four significant figures. Express the final $T_s$ in seconds.",
            "solution": "The problem requires us to find the maximum sampling time $T_s$ for a digitally controlled system to remain stable. We will follow a four-step process: (1) discretize the continuous-time controller, (2) discretize the continuous-time plant, (3) find the closed-loop characteristic polynomial, and (4) apply a stability criterion to find the limit on $T_s$.\n\n**1. Discretize the Controller using the Tustin Transform**\n\nThe continuous-time integral controller is $C(s) = \\frac{U(s)}{E(s)} = \\frac{K_i}{s}$. In the time domain, this is $\\frac{du(t)}{dt} = K_i e(t)$. To discretize this, we integrate over one sampling period from $(k-1)T_s$ to $kT_s$:\n$$ u(kT_s) - u((k-1)T_s) = K_i \\int_{(k-1)T_s}^{kT_s} e(\\tau) d\\tau $$\nThe Tustin transform is based on approximating the integral using the trapezoidal rule:\n$$ u_k - u_{k-1} \\approx K_i \\frac{T_s}{2} [e_k + e_{k-1}] $$\nTaking the Z-transform of this difference equation gives:\n$$ U(z)(1 - z^{-1}) = \\frac{K_i T_s}{2} E(z)(1 + z^{-1}) $$\nThe discrete-time controller transfer function $C_d(z) = \\frac{U(z)}{E(z)}$ is therefore:\n$$ C_d(z) = \\frac{K_i T_s}{2} \\frac{1 + z^{-1}}{1 - z^{-1}} = \\frac{K_i T_s}{2} \\frac{z + 1}{z - 1} $$\nWith $K_i = 3\\,\\text{s}^{-1}$, we have:\n$$ C_d(z) = \\frac{3 T_s}{2} \\frac{z + 1}{z - 1} $$\n\n**2. Discretize the Plant using the Zero-Order Hold (ZOH) Method**\n\nThe pulse transfer function for a plant $P(s)$ with a ZOH is given by $P_d(z) = (1 - z^{-1}) \\mathcal{Z}\\left\\{ \\frac{P(s)}{s} \\right\\}$.\nFirst, we find the partial fraction expansion of $\\frac{P(s)}{s}$ for $P(s) = \\frac{1}{s+1}$:\n$$ \\frac{P(s)}{s} = \\frac{1}{s(s+1)} = \\frac{1}{s} - \\frac{1}{s+1} $$\nTaking the Z-transform using standard pairs:\n$$ \\mathcal{Z}\\left\\{ \\frac{P(s)}{s} \\right\\} = \\mathcal{Z}\\left\\{\\frac{1}{s}\\right\\} - \\mathcal{Z}\\left\\{\\frac{1}{s+1}\\right\\} = \\frac{z}{z-1} - \\frac{z}{z - e^{-T_s}} = \\frac{z(1 - e^{-T_s})}{(z-1)(z - e^{-T_s})} $$\nMultiplying by $(1 - z^{-1})$ yields the ZOH-equivalent plant model:\n$$ P_d(z) = \\frac{z-1}{z} \\cdot \\frac{z(1 - e^{-T_s})}{(z-1)(z - e^{-T_s})} = \\frac{1 - e^{-T_s}}{z - e^{-T_s}} $$\n\n**3. Form the Closed-Loop Characteristic Polynomial**\n\nFor a unity feedback system, the characteristic equation is $1 + C_d(z)P_d(z) = 0$.\n$$ 1 + \\left( \\frac{3 T_s}{2} \\frac{z + 1}{z - 1} \\right) \\left( \\frac{1 - e^{-T_s}}{z - e^{-T_s}} \\right) = 0 $$\nTo form the polynomial $Q(z)$, we clear the denominators:\n$$ (z - 1)(z - e^{-T_s}) + \\frac{3 T_s(1 - e^{-T_s})}{2} (z + 1) = 0 $$\nThis is the characteristic polynomial $Q(z)$.\n\n**4. Jury Stability Analysis**\n\nFor a second-order polynomial $Q(z) = z^2 + a_1 z + a_0$, stability requires three conditions to be met:\n1.  $Q(1) > 0$\n2.  $Q(-1) > 0$\n3.  $|a_0|  1$\n\nLet's test each condition:\n*   **Condition 1:** $Q(1) = (1-1)(1-e^{-T_s}) + \\frac{3 T_s(1 - e^{-T_s})}{2}(1+1) = 3 T_s(1 - e^{-T_s})$. Since $T_s > 0$, this term is always positive. This condition is always satisfied.\n*   **Condition 2:** $Q(-1) = (-1-1)(-1-e^{-T_s}) + 0 = (-2)(-1-e^{-T_s}) = 2(1 + e^{-T_s})$. Since $e^{-T_s} > 0$, this term is always positive. This condition is also always satisfied.\n*   **Condition 3:** We need $|a_0|  1$. The coefficient $a_0$ is found by setting $z=0$ in $Q(z)$: $a_0 = Q(0) = (-1)(-e^{-T_s}) + \\frac{3 T_s(1 - e^{-T_s})}{2}(1) = e^{-T_s} + \\frac{3 T_s(1 - e^{-T_s})}{2}$. For $T_s > 0$, both terms in $a_0$ are positive, so $a_0 > 0$. The condition simplifies to $a_0  1$.\n$$ e^{-T_s} + \\frac{3 T_s}{2} (1 - e^{-T_s})  1 $$\nRearranging the terms:\n$$ \\left( \\frac{3 T_s}{2} - 1 \\right) - e^{-T_s} \\left( \\frac{3 T_s}{2} - 1 \\right)  0 $$\nFactoring out the common term:\n$$ \\left( \\frac{3 T_s - 2}{2} \\right) (1 - e^{-T_s})  0 $$\nFor any $T_s > 0$, the term $(1 - e^{-T_s})$ is always positive. Therefore, for the product to be negative, the first term must be negative:\n$$ \\frac{3 T_s - 2}{2}  0 \\implies 3 T_s  2 \\implies T_s  \\frac{2}{3} $$\nThe system is stable for $0  T_s  2/3$. The largest sampling time that guarantees stability is $T_s = 2/3$ seconds.\n\nConverting to a decimal and rounding to four significant figures:\n$$ T_s = \\frac{2}{3} \\approx 0.666666... \\text{ s} \\approx 0.6667 \\text{ s} $$",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "A successful HIL simulation depends not only on correct models and control algorithms but also on the real-time processor's ability to execute all tasks before their deadlines. This exercise delves into the crucial domain of real-time scheduling, which governs how computational resources are allocated to different parts of the simulation, such as the plant model, sensor emulation, and control logic. By analyzing the schedulability of a set of tasks using the Earliest Deadline First (EDF) policy, you will determine the operational limits of the HIL testbed and understand the trade-off between model fidelity and computational feasibility .",
            "id": "4225896",
            "problem": "A real-time Hardware-In-the-Loop (HIL) digital twin testbed runs on a single preemptive processor and uses earliest deadline first (EDF) scheduling. In the HIL loop, four periodic tasks execute on the target: the plant integrator, sensor emulation, actuator driver, and network telemetry. Each job of a task is released at the start of its period and must complete by its relative deadline, which equals its period. The system is strictly single-core with no background tasks, and jobs may be preempted.\n\nTo increase model fidelity, the plant and signal processing operations are scaled by a dimensionless fidelity factor $s \\ge 0$, which increases their Worst-Case Execution Times (WCETs). The WCETs and periods are:\n- Plant integrator: period $T_{1} = 1\\,\\mathrm{ms}$, execution time $C_{1}(s) = 0.27\\,\\mathrm{ms} + 0.15\\,\\mathrm{ms} \\cdot s$.\n- Sensor emulation: period $T_{2} = 2\\,\\mathrm{ms}$, execution time $C_{2}(s) = 0.305\\,\\mathrm{ms} + 0.05\\,\\mathrm{ms} \\cdot s$.\n- Actuator driver: period $T_{3} = 5\\,\\mathrm{ms}$, execution time $C_{3}(s) = 0.21\\,\\mathrm{ms} + 0.02\\,\\mathrm{ms} \\cdot s^{2}$.\n- Network telemetry: period $T_{4} = 10\\,\\mathrm{ms}$, execution time $C_{4} = 0.62\\,\\mathrm{ms}$.\n\nDesign the EDF scheduling policy by specifying the relative deadlines for each task and the scheduling rule that determines job priorities at runtime. Starting from first principles of real-time feasibility under EDF for single-core preemptive systems with implicit deadlines (relative deadlines equal to periods), derive the schedulability criterion in terms of processor demand over any interval and show how it constrains the aggregate execution demand of these periodic tasks. Then, using that criterion, determine the maximum fidelity scaling factor $s_{\\max}$ such that the system remains schedulable.\n\nExpress your final answer as a pure number for $s_{\\max}$, rounded to four significant figures. No units are required for the final answer.",
            "solution": "The problem asks for the design of an Earliest Deadline First (EDF) scheduling policy and the calculation of the maximum fidelity scaling factor $s_{\\max}$ that ensures the schedulability of a set of four periodic tasks on a single-core preemptive processor.\n\nFirst, we address the design of the EDF scheduling policy. The policy consists of two main components: the assignment of deadlines and the runtime scheduling rule.\n\n$1$. **Deadline Assignment**: The problem specifies that for each task $\\tau_i$, its relative deadline $D_i$ is equal to its period $T_i$. This is known as an implicit deadline system. The given tasks are:\n- Task $\\tau_1$ (Plant integrator): $T_1 = 1\\,\\mathrm{ms}$, so its relative deadline is $D_1 = 1\\,\\mathrm{ms}$.\n- Task $\\tau_2$ (Sensor emulation): $T_2 = 2\\,\\mathrm{ms}$, so its relative deadline is $D_2 = 2\\,\\mathrm{ms}$.\n- Task $\\tau_3$ (Actuator driver): $T_3 = 5\\,\\mathrm{ms}$, so its relative deadline is $D_3 = 5\\,\\mathrm{ms}$.\n- Task $\\tau_4$ (Network telemetry): $T_4 = 10\\,\\mathrm{ms}$, so its relative deadline is $D_4 = 10\\,\\mathrm{ms}$.\n\n$2$. **Scheduling Rule**: EDF is a dynamic priority scheduling algorithm. The scheduling rule is as follows: At any given time, the ready job with the earliest absolute deadline is selected for execution. The absolute deadline of a job is calculated as its release time plus its relative deadline. If a new job is released that has an earlier absolute deadline than the currently executing job, the current job is preempted and the new job begins execution.\n\nNext, we derive the schedulability criterion. For a set of $n$ independent, preemptable, periodic tasks with implicit deadlines ($D_i = T_i$) running on a single processor, Liu and Layland proved a necessary and sufficient condition for schedulability based on total processor utilization. The utilization of a single task $\\tau_i$ is $U_i = C_i / T_i$, which represents the fraction of processor time consumed by that task. The total processor utilization $U$ is the sum of individual utilizations:\n$$U = \\sum_{i=1}^{n} U_i = \\sum_{i=1}^{n} \\frac{C_i}{T_i}$$\nThe necessary and sufficient condition for schedulability in this context is:\n$$U \\le 1$$\nThis condition is both necessary (if $U  1$, the tasks demand more processing time than is available in the long run) and sufficient (if $U \\le 1$, no deadlines will ever be missed).\n\nWe now apply this schedulability criterion to the given task set. The Worst-Case Execution Times (WCETs) $C_i$ are functions of the fidelity factor $s$. The total utilization $U(s)$ is therefore also a function of $s$.\nThe tasks are:\n- $\\tau_1$: $T_1 = 1\\,\\mathrm{ms}$, $C_1(s) = (0.27 + 0.15s)\\,\\mathrm{ms}$\n- $\\tau_2$: $T_2 = 2\\,\\mathrm{ms}$, $C_2(s) = (0.305 + 0.05s)\\,\\mathrm{ms}$\n- $\\tau_3$: $T_3 = 5\\,\\mathrm{ms}$, $C_3(s) = (0.21 + 0.02s^2)\\,\\mathrm{ms}$\n- $\\tau_4$: $T_4 = 10\\,\\mathrm{ms}$, $C_4 = 0.62\\,\\mathrm{ms}$\n\nThe total utilization $U(s)$ is:\n$$U(s) = \\frac{C_1(s)}{T_1} + \\frac{C_2(s)}{T_2} + \\frac{C_3(s)}{T_3} + \\frac{C_4}{T_4}$$\nSubstituting the given values (note that the units of milliseconds, $\\mathrm{ms}$, cancel in each term):\n$$U(s) = \\frac{0.27 + 0.15s}{1} + \\frac{0.305 + 0.05s}{2} + \\frac{0.21 + 0.02s^2}{5} + \\frac{0.62}{10}$$\nSimplifying each term:\n$$U(s) = (0.27 + 0.15s) + (0.1525 + 0.025s) + (0.042 + 0.004s^2) + 0.062$$\nCollecting terms by powers of $s$:\n$$U(s) = (0.004)s^2 + (0.15 + 0.025)s + (0.27 + 0.1525 + 0.042 + 0.062)$$\n$$U(s) = 0.004s^2 + 0.175s + 0.5265$$\nFor the system to be schedulable, we must satisfy the condition $U(s) \\le 1$:\n$$0.004s^2 + 0.175s + 0.5265 \\le 1$$\nWe rearrange this into a standard quadratic inequality form, $as^2 + bs + c \\le 0$:\n$$0.004s^2 + 0.175s - 0.4735 \\le 0$$\nTo find the values of $s$ for which this inequality holds, we first find the roots of the corresponding quadratic equation $0.004s^2 + 0.175s - 0.4735 = 0$. We use the quadratic formula $s = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ with $a=0.004$, $b=0.175$, and $c=-0.4735$.\n\nFirst, we compute the discriminant $\\Delta = b^2 - 4ac$:\n$$\\Delta = (0.175)^2 - 4(0.004)(-0.4735)$$\n$$\\Delta = 0.030625 + 0.007576 = 0.038201$$\nThe roots are:\n$$s = \\frac{-0.175 \\pm \\sqrt{0.038201}}{2(0.004)} = \\frac{-0.175 \\pm 0.19545076...}{0.008}$$\nThis gives two roots:\n$$s_1 = \\frac{-0.175 - 0.19545076...}{0.008} \\approx -46.3063$$\n$$s_2 = \\frac{-0.175 + 0.19545076...}{0.008} \\approx 2.556345$$\nThe quadratic function $f(s) = 0.004s^2 + 0.175s - 0.4735$ represents a parabola opening upwards. Therefore, the inequality $f(s) \\le 0$ is satisfied for values of $s$ between the two roots, i.e., $s_1 \\le s \\le s_2$.\n\nThe problem states that the fidelity factor $s$ must be non-negative, so $s \\ge 0$. Combining this physical constraint with the schedulability constraint, the permissible range for $s$ is $0 \\le s \\le s_2$.\nThe maximum value of the fidelity scaling factor, $s_{\\max}$, is therefore the positive root, $s_2$.\n$$s_{\\max} \\approx 2.556345$$\nThe problem requires the answer to be rounded to four significant figures.\n$$s_{\\max} \\approx 2.556$$",
            "answer": "$$\\boxed{2.556}$$"
        }
    ]
}