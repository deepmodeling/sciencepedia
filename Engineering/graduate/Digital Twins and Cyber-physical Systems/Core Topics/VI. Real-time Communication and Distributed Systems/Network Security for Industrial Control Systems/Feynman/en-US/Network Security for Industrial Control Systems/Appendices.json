{
    "hands_on_practices": [
        {
            "introduction": "Securing Industrial Control Systems often involves deploying cryptographic measures on resource-constrained devices like Programmable Logic Controllers (PLCs). This practice demonstrates how to quantify the computational burden of encryption, a critical step in ensuring that security enhancements do not overwhelm the PLC's processor and jeopardize its primary control tasks. By modeling the CPU load from first principles, you will learn to assess whether a proposed security solution fits within the strict real-time operational budget of a critical controller .",
            "id": "4233849",
            "problem": "A Programmable Logic Controller (PLC) in an Industrial Control System (ICS) must encrypt a continuous command stream from a Human-Machine Interface (HMI) using Advanced Encryption Standard in Galois/Counter Mode (AES-GCM). The PLC has a single-core processor of frequency $f$ cycles per second. The AES-GCM implementation incurs a per-byte cost of $c_b$ cycles per byte for the payload and a fixed per-packet setup cost of $c_o$ cycles per packet due to initialization (for example, initialization vector processing and hash subkey setup). The stream arrives as fixed-size packets of length $L$ bytes at an average arrival rate of $R$ bytes per second. The real-time scheduler allocates a fraction $B$ of the CPU to cryptographic tasks to ensure control-loop deadlines are met.\n\nStarting only from the definitions that a processor of frequency $f$ provides $f$ cycles per second, that utilization is the fraction of available cycles consumed, and that cycles per second consumed is the rate of events multiplied by cycles per event, derive an expression for the cryptographic CPU utilization $u$ and then evaluate it for the following parameters:\n- $R = 1.20 \\times 10^{7}$ bytes/s,\n- $L = 1000$ bytes,\n- $c_b = 30$ cycles/byte,\n- $c_o = 5000$ cycles/packet,\n- $f = 6.00 \\times 10^{8}$ cycles/s,\n- $B = 0.65$.\n\nThen determine, based on the derived utilization, whether the AES-GCM encryption fits within the PLC’s compute budget allocated to cryptographic tasks. Express the CPU utilization as a decimal fraction and round your answer to four significant figures. No units are required for the utilization.",
            "solution": "The objective is to derive an expression for the cryptographic CPU utilization, $u$, and then evaluate it to determine if it fits within the allocated computational budget. The derivation begins from the fundamental principles provided.\n\nThe total number of CPU cycles available per second is equal to the processor's frequency, $f$.\n$$ \\text{Available cycles per second} = f $$\nThe total number of cycles consumed per second by the cryptographic task, which we denote as $C_{crypto}$, must be calculated. The workload consists of two components: a fixed cost per packet and a variable cost per byte.\n\nFirst, we determine the rate at which packets arrive. Given a continuous stream arriving at an average rate of $R$ bytes per second, composed of packets of a fixed length $L$ bytes, the packet arrival rate, $R_p$, is:\n$$ R_p = \\frac{R}{L} $$\nThese packets are processed at a unit of packets per second.\n\nThe cryptographic workload consumes cycles from two distinct operations:\n1.  Per-packet setup cost: A fixed number of cycles, $c_o$, is consumed for each packet. The total cycles per second for this overhead is the packet rate $R_p$ multiplied by the cost per packet $c_o$.\n    $$ C_{setup} = R_p \\cdot c_o = \\left(\\frac{R}{L}\\right) c_o $$\n\n2.  Per-byte processing cost: A number of cycles, $c_b$, is consumed for each byte of the payload. The total cycles per second for payload processing is the byte rate $R$ multiplied by the cost per byte $c_b$.\n    $$ C_{payload} = R \\cdot c_b $$\n\nThe total cycles per second consumed by the AES-GCM encryption is the sum of the setup and payload processing costs:\n$$ C_{crypto} = C_{payload} + C_{setup} = R c_b + \\frac{R}{L} c_o $$\n\nCPU utilization, $u$, is defined as the fraction of available cycles consumed. It is the ratio of the total cycles consumed per second to the total cycles available per second.\n$$ u = \\frac{C_{crypto}}{f} $$\nSubstituting the expression for $C_{crypto}$ gives the general formula for the cryptographic CPU utilization:\n$$ u = \\frac{R c_b + \\frac{R}{L} c_o}{f} $$\nThis expression can be factored to a more convenient form:\n$$ u = \\frac{R}{f} \\left( c_b + \\frac{c_o}{L} \\right) $$\n\nNow, we evaluate this expression using the provided numerical parameters:\n- $R = 1.20 \\times 10^{7}$ bytes/s\n- $L = 1000$ bytes\n- $c_b = 30$ cycles/byte\n- $c_o = 5000$ cycles/packet\n- $f = 6.00 \\times 10^{8}$ cycles/s\n- $B = 0.65$\n\nSubstituting these values into the derived formula for $u$:\n$$ u = \\frac{1.20 \\times 10^{7}}{6.00 \\times 10^{8}} \\left( 30 + \\frac{5000}{1000} \\right) $$\nFirst, we evaluate the term representing the effective cycles per byte:\n$$ c_b' = c_b + \\frac{c_o}{L} = 30 + \\frac{5000}{1000} = 30 + 5 = 35 \\text{ cycles/byte} $$\nNext, we evaluate the pre-factor:\n$$ \\frac{R}{f} = \\frac{1.20 \\times 10^{7}}{6.00 \\times 10^{8}} = \\frac{1.20}{60.0} = 0.02 $$\nThe utilization $u$ is the product of these two results:\n$$ u = 0.02 \\times 35 = 0.7 $$\nThe problem requires the answer to be expressed as a decimal fraction rounded to four significant figures.\n$$ u = 0.7000 $$\n\nFinally, we must determine if this utilization fits within the PLC's compute budget, $B$, allocated to cryptographic tasks. The budget is given as $B = 0.65$. We compare the calculated utilization $u$ with the budget $B$:\n$$ u = 0.7000 $$\n$$ B = 0.65 $$\nSince $0.7000 > 0.65$, the required CPU utilization for the AES-GCM encryption exceeds the allocated budget. Therefore, the task does not fit within the PLC's compute budget.",
            "answer": "$$\\boxed{0.7000}$$"
        },
        {
            "introduction": "In a cyber-physical system, the \"cyber\" and \"physical\" components are inextricably linked; an action in one domain has direct consequences in the other. This exercise explores a crucial example of this interplay by modeling the communication latency introduced by security layers as a time delay in a control loop . By applying fundamental concepts from classical control theory, you will calculate stability margins to determine if the added delay jeopardizes the physical stability of the process, highlighting the critical need to co-design security measures and control strategies.",
            "id": "4233902",
            "problem": "An Industrial Control System (ICS) is operated over a secured network where inline cryptographic authentication and inspection layers, coordinated by a Digital Twin, introduce a constant computational latency in the control communication path. This latency is modeled as a pure time delay. Consider the closed-loop regulation of a level-like integrating process with the plant modeled as $G_{p}(s) = \\frac{1}{s}$ and a proportional-only controller with gain $K_{c}$. The open-loop transfer function becomes $L(s) = K_{c} \\, G_{p}(s) \\, \\exp(-s T_{s}) = \\frac{K_{c}}{s} \\exp(-s T_{s})$, where $T_{s} > 0$ is the constant delay contributed by the security processing and Digital Twin synchronization.\n\nUsing the standard definitions from the Nyquist stability criterion and frequency-response margins, compute the phase margin and gain margin of the delayed open loop for the specific parameters $K_{c} = 3$ and $T_{s} = 0.4\\,\\mathrm{s}$. The phase margin must be expressed in radians and the gain margin as a dimensionless ratio. Round both computed margins to four significant figures.\n\nAdditionally, this ICS employs a stability-preserving policy that mandates a phase margin of at least $0.5236\\,\\mathrm{rad}$ and a gain margin of at least $2$ for continued operation without retuning when security processing is active. Based on your computed margins, determine whether retuning is required to preserve stability in the presence of the added delay. Justify your decision in words.\n\nExpress the final numerical answer as a two-entry row matrix containing, in order, the phase margin (in radians) and the gain margin (dimensionless). No units should be included inside the final matrix.",
            "solution": "The primary task is to compute the phase margin and gain margin for the given open-loop system. The open-loop transfer function is given by:\n$$L(s) = \\frac{K_{c}}{s} \\exp(-s T_{s})$$\nWe are given the parameters $K_{c} = 3$ and $T_{s} = 0.4$.\n\nTo find the stability margins, we first determine the frequency response of the system by substituting $s = j\\omega$, where $\\omega$ is the angular frequency in radians per second.\n$$L(j\\omega) = \\frac{K_{c}}{j\\omega} \\exp(-j\\omega T_{s})$$\nThe magnitude $|L(j\\omega)|$ and phase angle $\\angle L(j\\omega)$ of the frequency response are found as follows.\nThe magnitude is:\n$$|L(j\\omega)| = \\left| \\frac{K_{c}}{j\\omega} \\right| \\left| \\exp(-j\\omega T_{s}) \\right| = \\frac{K_{c}}{\\omega} \\cdot 1 = \\frac{K_{c}}{\\omega}$$\nThe phase angle is the sum of the angles of the individual components:\n$$\\angle L(j\\omega) = \\angle(K_c) + \\angle\\left(\\frac{1}{j\\omega}\\right) + \\angle(\\exp(-j\\omega T_{s}))$$\nSince $K_c$ is a positive real number, its angle is $0$. The term $1/(j\\omega)$ is equivalent to $-j/\\omega$, which has a constant phase of $-\\frac{\\pi}{2}$ radians. The term $\\exp(-j\\omega T_{s})$ contributes a phase lag of $-\\omega T_{s}$ radians.\n$$\\angle L(j\\omega) = 0 - \\frac{\\pi}{2} - \\omega T_{s} = -\\frac{\\pi}{2} - \\omega T_{s}$$\n\n**Phase Margin Calculation**\nThe phase margin is determined at the gain crossover frequency, $\\omega_{gc}$, which is the frequency at which the magnitude of the open-loop gain is unity ($1$).\n$$|L(j\\omega_{gc})| = 1$$\n$$\\frac{K_{c}}{\\omega_{gc}} = 1 \\implies \\omega_{gc} = K_{c}$$\nWith $K_{c} = 3$, the gain crossover frequency is $\\omega_{gc} = 3\\,\\mathrm{rad/s}$.\n\nThe phase margin ($PM$) is the amount of additional phase lag required to bring the system to the stability limit at the gain crossover frequency. It is defined as:\n$$PM = \\pi + \\angle L(j\\omega_{gc})$$\nSubstituting the expression for the phase and the value of $\\omega_{gc}$:\n$$PM = \\pi + \\left( -\\frac{\\pi}{2} - \\omega_{gc} T_{s} \\right) = \\frac{\\pi}{2} - K_{c} T_{s}$$\nNow, we substitute the given numerical values, $K_{c} = 3$ and $T_{s} = 0.4$:\n$$PM = \\frac{\\pi}{2} - (3)(0.4) = \\frac{\\pi}{2} - 1.2$$\nNumerically, this is:\n$$PM \\approx 1.570796 - 1.2 = 0.370796\\,\\mathrm{rad}$$\nRounding to four significant figures, the phase margin is $0.3708\\,\\mathrm{rad}$.\n\n**Gain Margin Calculation**\nThe gain margin is determined at the phase crossover frequency, $\\omega_{pc}$, which is the frequency at which the phase angle is $-\\pi$ radians ($-180^\\circ$).\n$$\\angle L(j\\omega_{pc}) = -\\pi$$\n$$-\\frac{\\pi}{2} - \\omega_{pc} T_{s} = -\\pi$$\nSolving for $\\omega_{pc}$:\n$$\\omega_{pc} T_{s} = \\pi - \\frac{\\pi}{2} = \\frac{\\pi}{2}$$\n$$\\omega_{pc} = \\frac{\\pi}{2 T_{s}}$$\nWith $T_{s} = 0.4$, the phase crossover frequency is:\n$$\\omega_{pc} = \\frac{\\pi}{2(0.4)} = \\frac{\\pi}{0.8} = 1.25\\pi \\approx 3.92699\\,\\mathrm{rad/s}$$\nThe gain margin ($GM$) is the reciprocal of the magnitude of the open-loop transfer function at the phase crossover frequency.\n$$GM = \\frac{1}{|L(j\\omega_{pc})|}$$\nFirst, we find the magnitude at $\\omega_{pc}$:\n$$|L(j\\omega_{pc})| = \\frac{K_{c}}{\\omega_{pc}} = \\frac{K_{c}}{\\pi / (2T_{s})} = \\frac{2 K_{c} T_{s}}{\\pi}$$\nTherefore, the gain margin is:\n$$GM = \\frac{\\pi}{2 K_{c} T_{s}}$$\nSubstituting the numerical values:\n$$GM = \\frac{\\pi}{2(3)(0.4)} = \\frac{\\pi}{2.4}$$\nNumerically, this is:\n$$GM \\approx \\frac{3.14159265}{2.4} \\approx 1.308997$$\nRounding to four significant figures, the gain margin is $1.309$.\n\n**Stability Policy Evaluation**\nThe problem states that the ICS requires a phase margin of at least $0.5236\\,\\mathrm{rad}$ and a gain margin of at least $2$. Let's compare our computed values to these requirements.\n\n*   Phase Margin: The computed phase margin is $PM \\approx 0.3708\\,\\mathrm{rad}$. The requirement is $PM \\ge 0.5236\\,\\mathrm{rad}$. Since $0.3708  0.5236$, the phase margin requirement is **not met**.\n*   Gain Margin: The computed gain margin is $GM \\approx 1.309$. The requirement is $GM \\ge 2$. Since $1.309  2$, the gain margin requirement is **not met**.\n\nBoth the phase margin and the gain margin are below the minimum acceptable levels stipulated by the stability-preserving policy. The reduced stability margins are a direct consequence of the latency introduced by the security layers. To restore the system's robustness and comply with the operational policy, the controller must be retuned. A common approach would be to reduce the controller gain $K_c$, which would increase both the phase margin (since $PM = \\pi/2 - K_c T_s$) and the gain margin (since $GM = \\pi / (2 K_c T_s)$), at the expense of a slower system response. Therefore, **retuning is required**.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3708  1.309\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Effective ICS security relies on robust network architecture, often designed using segmentation principles like the Purdue Model's zones and conduits. This practice moves beyond qualitative architectural diagrams by modeling the network as a capacitated graph, allowing for a rigorous, quantitative assessment of its resilience . You will use the fundamental max-flow min-cut concept to determine the minimum number of network links an adversary must compromise to bridge security zones, providing a clear metric for identifying architectural weaknesses and prioritizing defensive investments.",
            "id": "4233882",
            "problem": "A plant operator uses a digital twin of an Industrial Control System (ICS) network, modeled as a directed graph, to reason about segmentation between Purdue Model Level $1$ (field devices) and Level $4$ (enterprise). Zones are vertices and conduits are directed edges. Each conduit has a capacity equal to the number of independent physical links bundled in that conduit. An adversary attempting data exfiltration from Level $1$ to Level $4$ is modeled as a flow from a source vertex to a sink vertex. The minimum number of links that must be removed to isolate Level $1$ from Level $4$ equals the value of a minimum $s$–$t$ cut in this capacitated graph.\n\nThe vertices are:\n- $s$: Level $1$ field devices aggregation,\n- $C_{1}$: Level $2$ Cell/Area Zone A,\n- $C_{2}$: Level $2$ Cell/Area Zone B,\n- $O$: Level $3$ Operations network,\n- $D$: Level $3.5$ Demilitarized Zone,\n- $t$: Level $4$ Enterprise.\n\nThe directed conduits and their capacities (number of parallel links) are:\n- $(s \\to C_{1})$ with capacity $2$,\n- $(s \\to C_{2})$ with capacity $2$,\n- $(C_{1} \\to O)$ with capacity $1$,\n- $(C_{2} \\to O)$ with capacity $1$,\n- $(C_{2} \\to D)$ with capacity $1$,\n- $(O \\to D)$ with capacity $2$,\n- $(O \\to t)$ with capacity $1$,\n- $(D \\to t)$ with capacity $2$.\n\nAssume all other pairs of vertices have no direct conduit. Starting from the core definition of an $s$–$t$ cut as a bipartition of vertices with $s$ on one side and $t$ on the other, and the cut capacity as the sum of capacities of directed edges from the $s$-side to the $t$-side, determine the minimum $s$–$t$ cut value between $s$ and $t$. Interpret this value as the minimum number of links that must be removed to isolate Level $1$ from Level $4$, and briefly explain the security implications of this number in terms of zone-and-conduit design decisions.\n\nExpress your final answer as a single number with no units. No rounding is required.",
            "solution": "The problem asks for the minimum number of links that must be removed to isolate Level $1$ (source $s$) from Level $4$ (sink $t$). This is equivalent to finding the capacity of the minimum $s$–$t$ cut in the given capacitated, directed graph. An $s$–$t$ cut is a partition of the set of vertices $V$ into two disjoint subsets, $S$ and $T$, such that the source vertex $s \\in S$ and the sink vertex $t \\in T$. The capacity of the cut $(S, T)$, denoted as $c(S,T)$, is the sum of the capacities of all edges $(u,v)$ where $u \\in S$ and $v \\in T$.\n\nThe vertices of the graph are $V = \\{s, C_{1}, C_{2}, O, D, t\\}$. The directed edges and their capacities are:\n$c(s, C_{1}) = 2$\n$c(s, C_{2}) = 2$\n$c(C_{1}, O) = 1$\n$c(C_{2}, O) = 1$\n$c(C_{2}, D) = 1$\n$c(O, D) = 2$\n$c(O, t) = 1$\n$c(D, t) = 2$\n\nTo find the minimum $s$–$t$ cut, we can either use the max-flow min-cut theorem (by finding the maximum flow from $s$ to $t$) or, for a graph of this small size, we can enumerate a few candidate cuts and identify the one with the minimum capacity. Let us analyze a few possible partitions $(S,T)$.\n\n1.  A trivial cut that isolates only the source $s$:\n    Let $S = \\{s\\}$ and $T = \\{C_{1}, C_{2}, O, D, t\\}$. The edges directed from $S$ to $T$ are $(s, C_{1})$ and $(s, C_{2})$.\n    The capacity of this cut is $c(S,T) = c(s, C_{1}) + c(s, C_{2}) = 2 + 2 = 4$.\n\n2.  A cut that separates Level $2$ zones from Level $3$ and higher:\n    Let $S = \\{s, C_{1}, C_{2}\\}$ and $T = \\{O, D, t\\}$. The edges directed from $S$ to $T$ are $(C_{1}, O)$, $(C_{2}, O)$, and $(C_{2}, D)$.\n    The capacity of this cut is $c(S,T) = c(C_{1}, O) + c(C_{2}, O) + c(C_{2}, D) = 1 + 1 + 1 = 3$.\n\n3.  A trivial cut that isolates only the sink $t$:\n    Let $S = \\{s, C_{1}, C_{2}, O, D\\}$ and $T = \\{t\\}$. The edges directed from $S$ to $T$ are $(O, t)$ and $(D, t)$.\n    The capacity of this cut is $c(S,T) = c(O, t) + c(D, t) = 1 + 2 = 3$.\n\n4.  Another possible cut:\n    Let $S = \\{s, C_{1}\\}$ and $T = \\{C_{2}, O, D, t\\}$. The edges directed from $S$ to $T$ are $(s, C_{2})$ and $(C_{1}, O)$.\n    The capacity of this cut is $c(S,T) = c(s, C_{2}) + c(C_{1}, O) = 2 + 1 = 3$.\n\nBy comparing the capacities of these cuts, we find a minimum value of $3$. According to the max-flow min-cut theorem, the maximum possible flow from $s$ to $t$ is equal to the capacity of the minimum $s$–$t$ cut. Since we have found cuts with a capacity of $3$, and a flow of $3$ can be demonstrated (e.g., a flow of $1$ along $s \\to C_1 \\to O \\to t$, a flow of $1$ along $s \\to C_2 \\to D \\to t$, and a flow of $1$ along $s \\to C_2 \\to O \\to D \\to t$, which saturates several edges and respects all capacities), the minimum cut value is indeed $3$.\n\nThis value has direct security implications. The minimum cut value of $3$ signifies that the network architecture has a resilience level of $3$ against data exfiltration from Level $1$ to Level $4$. This means an adversary must successfully compromise or disable at least $3$ independent physical links to guarantee a complete disruption of this exfiltration path. Conversely, from a defensive standpoint, severing just $3$ specific links is sufficient to isolate Level $1$ from Level $4$.\n\nThe existence of multiple distinct minimum cuts—such as the set of conduits between Level $2$ and Level $3$ (cut $2$) or the conduits leading into Level $4$ (cut $3$)—reveals different, equally \"weak\" points in the network topology. A low min-cut value like $3$ suggests a relatively brittle architecture. Effective zone-and-conduit design decisions aimed at hardening this network would focus on increasing this value. This is achieved not just by adding capacity to random conduits, but specifically by augmenting the capacity of edges that constitute the minimum cuts or by introducing new, diverse paths that are not easily cut. For instance, simply increasing the capacity of the $(O \\to t)$ link from $1$ to $2$ would not improve the overall security, as the cut $\\{(C_{1}, O), (C_{2}, O), (C_{2}, D)\\}$ would still have a capacity of $3$. A holistic analysis using the min-cut value is therefore essential for making informed, cost-effective security investments.",
            "answer": "$$\n\\boxed{3}\n$$"
        }
    ]
}