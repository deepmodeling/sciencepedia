{
    "hands_on_practices": [
        {
            "introduction": "This first practice grounds threat modeling in quantitative reality by analyzing a classic attack vector: brute-force credential guessing. You will derive the expected time-to-compromise for a Programmable Logic Controller (PLC), directly linking the information-theoretic strength of a password policy, measured by entropy, to a practical security metric. This exercise  is fundamental for evaluating the baseline security of components within a Cyber-Physical System.",
            "id": "4250648",
            "problem": "A cyber-physical system (CPS) operator uses a digital twin to assess the risk of brute-force credential attacks against a safety-critical Programmable Logic Controller (PLC). The PLC enforces no account lockout and accepts online authentication attempts at a measured steady rate of $r$ guesses per second, as determined from the digital twin’s network and protocol emulation. The operator’s credential policy yields passwords that are uniformly distributed over their space with Shannon entropy $H$ bits. Typical planned maintenance windows for the PLC are short, and from a threat modeling perspective, an attacker seeks to complete a brute-force compromise within a maintenance window to minimize operational observability.\n\nStarting only from the definitions of Shannon entropy and expectation over a finite uniform set, and assuming the attacker guesses without replacement in a uniformly random order over the password space, derive the expected time-to-compromise $t_{\\mathrm{exp}}$ as a function of $H$ and $r$. Then define a maintenance window of duration $T_{m}$ seconds. Form the dimensionless ratio $\\xi$ of the expected time-to-compromise to the maintenance window length, $\\xi = t_{\\mathrm{exp}} / T_{m}$, which directly encodes feasibility for an attacker relative to the window (values less than $1$ indicate that the expected time fits within the window).\n\nProvide as your final answer the closed-form symbolic expression for $\\xi$ in terms of $H$, $r$, and $T_{m}$. Do not substitute numerical values. No rounding is required. The final ratio is dimensionless; do not include units in your final answer.",
            "solution": "The problem statement is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n-   The system is a cyber-physical system (CPS) with a Programmable Logic Controller (PLC).\n-   The attack vector is brute-force credential authentication.\n-   The PLC has no account lockout policy.\n-   The rate of authentication attempts is a steady rate of $r$ guesses per second.\n-   The passwords follow a uniform distribution over the password space.\n-   The Shannon entropy of the password distribution is $H$ bits.\n-   The attacker guesses without replacement in a uniformly random order.\n-   The objective is to derive the expected time-to-compromise, $t_{\\mathrm{exp}}$, as a function of $H$ and $r$.\n-   A maintenance window of duration $T_{m}$ seconds is defined.\n-   A dimensionless ratio $\\xi$ is defined as $\\xi = t_{\\mathrm{exp}} / T_{m}$.\n-   The final requested quantity is the closed-form symbolic expression for $\\xi$ in terms of $H$, $r$, and $T_{m}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is grounded in established principles of information theory and computer security. The concepts of Shannon entropy, uniform probability distributions, expected value, and brute-force attack modeling are standard and scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary variables ($H$, $r$, $T_{m}$) and a clear set of assumptions (uniform distribution, no replacement) to derive a unique solution. The objective is explicitly stated.\n-   **Objective**: The language is technical and precise, free from subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem is self-contained. It explicitly asks for a derivation \"Starting only from the definitions of Shannon entropy and expectation,\" which provides a clear and complete basis for the solution. There are no contradictions in the givens.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and all necessary information for a rigorous derivation is provided. The solution process may proceed.\n\n### Derivation of the Expected Time-to-Compromise and the Ratio $\\xi$\n\nThe derivation proceeds in four steps:\n1.  Relate the Shannon entropy $H$ to the size of the password space $N$.\n2.  Calculate the expected number of guesses to find the correct password.\n3.  Calculate the expected time-to-compromise $t_{\\mathrm{exp}}$.\n4.  Form the dimensionless ratio $\\xi$.\n\n**Step 1: Relate Shannon Entropy to Password Space Size**\n\nThe Shannon entropy $H$ for a discrete random variable with $N$ possible outcomes, each with probability $p_i$, is defined as:\n$$H = -\\sum_{i=1}^{N} p_i \\log_2(p_i)$$\nThe problem states that the passwords are uniformly distributed over their space. For a uniform distribution over a space of size $N$, the probability of any single password being the correct one is $p_i = \\frac{1}{N}$ for all $i \\in \\{1, 2, \\dots, N\\}$.\n\nSubstituting this into the entropy formula:\n$$H = -\\sum_{i=1}^{N} \\frac{1}{N} \\log_2\\left(\\frac{1}{N}\\right)$$\nSince the term inside the summation is constant for all $i$, we can simplify the sum:\n$$H = -N \\left( \\frac{1}{N} \\log_2\\left(\\frac{1}{N}\\right) \\right) = -\\log_2\\left(\\frac{1}{N}\\right)$$\nUsing the properties of logarithms, $\\log_b(1/x) = -\\log_b(x)$:\n$$H = -(-\\log_2(N)) = \\log_2(N)$$\nFrom this relationship, we can express the total number of possible passwords, $N$, as a function of the entropy $H$:\n$$N = 2^H$$\n\n**Step 2: Calculate the Expected Number of Guesses**\n\nLet $K$ be the discrete random variable representing the number of guesses required to find the correct password. The attacker guesses passwords from the space of size $N$ without replacement and in a uniformly random order. This implies that the correct password is equally likely to be at any position in the sequence of guesses, from the $1^{\\text{st}}$ to the $N^{\\text{th}}$.\n\nTherefore, the probability of finding the password on the $k^{\\text{th}}$ guess is $P(K=k) = \\frac{1}{N}$ for any $k \\in \\{1, 2, \\dots, N\\}$.\n\nThe expected number of guesses, $E[K]$, is defined by the expectation formula for a discrete random variable:\n$$E[K] = \\sum_{k=1}^{N} k \\cdot P(K=k)$$\nSubstituting the probability $P(K=k)$:\n$$E[K] = \\sum_{k=1}^{N} k \\cdot \\frac{1}{N} = \\frac{1}{N} \\sum_{k=1}^{N} k$$\nThe sum of the first $N$ positive integers is given by the well-known formula $\\sum_{k=1}^{N} k = \\frac{N(N+1)}{2}$.\nSubstituting this sum into the expression for $E[K]$:\n$$E[K] = \\frac{1}{N} \\left( \\frac{N(N+1)}{2} \\right) = \\frac{N+1}{2}$$\nThis is the expected number of guesses required to find the correct password.\n\n**Step 3: Calculate the Expected Time-to-Compromise ($t_{\\mathrm{exp}}$)**\n\nThe attacker can make guesses at a steady rate of $r$ guesses per second. Therefore, the time required for a single guess is $\\frac{1}{r}$ seconds. The total time to compromise is the number of guesses multiplied by the time per guess. The expected time-to-compromise, $t_{\\mathrm{exp}}$, is the expected number of guesses, $E[K]$, multiplied by the time per guess:\n$$t_{\\mathrm{exp}} = E[K] \\cdot \\frac{1}{r} = \\left(\\frac{N+1}{2}\\right) \\frac{1}{r} = \\frac{N+1}{2r}$$\nNow, we substitute the expression for $N$ from Step 1, $N = 2^H$:\n$$t_{\\mathrm{exp}} = \\frac{2^H + 1}{2r}$$\nThis is the expected time-to-compromise as a function of entropy $H$ and guessing rate $r$.\n\n**Step 4: Form the Dimensionless Ratio ($\\xi$)**\n\nThe problem defines a dimensionless ratio $\\xi$ as the expected time-to-compromise divided by the duration of the maintenance window, $T_m$:\n$$\\xi = \\frac{t_{\\mathrm{exp}}}{T_{m}}$$\nSubstituting the derived expression for $t_{\\mathrm{exp}}$:\n$$\\xi = \\frac{\\left(\\frac{2^H + 1}{2r}\\right)}{T_{m}}$$\nSimplifying this compound fraction gives the final closed-form expression for $\\xi$:\n$$\\xi = \\frac{2^H + 1}{2rT_{m}}$$\nThis expression represents the ratio of the expected compromise time to the available maintenance window, providing a direct measure of attack feasibility.",
            "answer": "$$\\boxed{\\frac{2^{H} + 1}{2rT_{m}}}$$"
        },
        {
            "introduction": "Building on the theme of quantitative analysis, this practice explores a threat with direct physical consequences in distributed cyber-physical systems: the manipulation of time. You will model how small, adversarially-injected time offsets, combined with natural clock drift, can accumulate to cause critical control misalignment. This exercise  highlights the importance of modeling the physical dynamics of the system to understand the true impact of a cyber threat.",
            "id": "4250699",
            "problem": "A cyber-physical system (CPS) consists of a controller node acting as the time master and a sensor node acting as the time slave. The system uses either the Precision Time Protocol (PTP) or the Network Time Protocol (NTP) to maintain time synchronization between nodes. Assume that at synchronization instant $t=0$, the offset between the controller’s clock and the sensor’s clock has been corrected by the protocol’s servo to be zero. The sensor’s local clock has a fractional frequency error (clock drift) $\\delta$ relative to the controller’s ideal time, where $\\delta$ is small and constant over an interval. By definition, if $t$ denotes the true elapsed time since the last synchronization, the sensor’s clock reading evolves as $\\tau(t) = (1+\\delta)t$, so the time offset accumulates as $e(t) = \\tau(t) - t = \\delta t$. An adversary capable of forging a PTP or NTP message at $t=0$ can inject a constant time offset $e_{\\text{adv}}$ at the sensor node immediately after the servo correction, so the total offset becomes $e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$ until the next synchronization.\n\nThe controller executes a discrete-time control law with sampling period $T_{s}$, and correct sample alignment is guaranteed if $|e_{\\text{tot}}(t)|  T_{s}/2$. Misalignment occurs when $|e_{\\text{tot}}(t)| \\geq T_{s}/2$, which causes the controller to use the wrong sample index and induces an effective one-step delay error. Assume the following parameters:\n- Sampling period $T_{s} = 6\\,\\text{ms}$,\n- Resynchronization interval $T_{r} = 30\\,\\text{s}$,\n- Constant drift magnitude $\\delta = 15\\,\\text{ppm}$, where $\\text{ppm}$ means parts per million, so $\\delta = 15 \\times 10^{-6}$.\n\nUnder these assumptions, and starting from the fundamental definitions of clock drift and offset accumulation described above, compute the smallest adversarial offset $e_{\\text{adv}}$ that guarantees there exists a time $t \\in [0, T_{r}]$ for which the misalignment condition $|e_{\\text{tot}}(t)| \\geq T_{s}/2$ holds. Express your final answer in milliseconds, rounded to four significant figures.",
            "solution": "The user has asked me to validate and solve a problem concerning time synchronization in a cyber-physical system, following a strict set of formatting and procedural rules.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Total time offset: $e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$\n- Time interval for analysis: $t \\in [0, T_{r}]$\n- Misalignment condition: $|e_{\\text{tot}}(t)| \\geq T_{s}/2$\n- Sampling period: $T_{s} = 6\\,\\text{ms}$\n- Resynchronization interval: $T_{r} = 30\\,\\text{s}$\n- Constant drift magnitude: $\\delta = 15\\,\\text{ppm}$, defined as $\\delta = 15 \\times 10^{-6}$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on a standard linear model for clock drift, $e(t) = \\delta t$, which is a fundamental concept in the study of clock synchronization protocols like PTP and NTP. The parameters provided are realistic for industrial control systems. The problem is scientifically sound.\n- **Well-Posed:** The problem provides all necessary parameters ($T_s$, $T_r$, $\\delta$) and a clear objective: to compute the smallest adversarial offset $e_{\\text{adv}}$ that guarantees a specific condition is met within a defined interval. This is a well-defined mathematical problem that admits a unique solution under a reasonable interpretation of \"smallest.\"\n- **Objective:** The problem is stated using precise, formal language without subjective or ambiguous terms.\n- **Completeness and Consistency:** The problem is self-contained and free from internal contradictions.\n- **Realism:** The scenario and parameter values are plausible in the context of real-world cyber-physical systems.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid** based on the validation criteria. I will proceed with a full solution.\n\n### Solution\n\nThe objective is to find the smallest adversarial offset, $e_{\\text{adv}}$, that guarantees the occurrence of a misalignment within the time interval $t \\in [0, T_{r}]$. A misalignment occurs when the total time offset, $e_{\\text{tot}}(t)$, satisfies the condition $|e_{\\text{tot}}(t)| \\geq \\frac{T_{s}}{2}$.\n\nThe total offset is given by the linear function of time:\n$$e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$$\nwhere $e_{\\text{adv}}$ is the constant adversarial offset injected at $t=0$, and $\\delta t$ is the offset accumulated due to clock drift.\n\nThe condition for a misalignment to occur is that there exists at least one time instant $t$ in the interval $[0, T_{r}]$ such that:\n$$|e_{\\text{adv}} + \\delta t| \\geq \\frac{T_{s}}{2}$$\n\nConversely, for the system to remain correctly synchronized throughout the interval, the condition $|e_{\\text{adv}} + \\delta t|  \\frac{T_{s}}{2}$ must hold for all $t \\in [0, T_{r}]$. This can be written as:\n$$-\\frac{T_{s}}{2}  e_{\\text{adv}} + \\delta t  \\frac{T_{s}}{2}$$\n\nThe problem provides the drift parameter $\\delta = 15 \\times 10^{-6}$, which is a positive constant. Therefore, the function $e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$ is monotonically increasing with time. For a monotonic function on a closed interval, its minimum and maximum values occur at the endpoints of the interval.\n\nTo ensure that $e_{\\text{tot}}(t)$ remains within the safe bounds $(-\\frac{T_{s}}{2}, \\frac{T_{s}}{2})$ for the entire interval $t \\in [0, T_{r}]$, we only need to check the values at the endpoints, $t=0$ and $t=T_{r}$.\n\n1.  At $t=0$, we require:\n    $$-\\frac{T_{s}}{2}  e_{\\text{tot}}(0)  \\frac{T_{s}}{2} \\implies -\\frac{T_{s}}{2}  e_{\\text{adv}}  \\frac{T_{s}}{2}$$\n\n2.  At $t=T_{r}$, we require:\n    $$-\\frac{T_{s}}{2}  e_{\\text{tot}}(T_{r})  \\frac{T_{s}}{2} \\implies -\\frac{T_{s}}{2}  e_{\\text{adv}} + \\delta T_{r}  \\frac{T_{s}}{2}$$\n    This second inequality can be rearranged to find the constraint on $e_{\\text{adv}}$:\n    $$-\\frac{T_{s}}{2} - \\delta T_{r}  e_{\\text{adv}}  \\frac{T_{s}}{2} - \\delta T_{r}$$\n\nFor the system to be safe for all $t \\in [0, T_{r}]$, $e_{\\text{adv}}$ must satisfy both sets of inequalities. The required range for $e_{\\text{adv}}$ is the intersection of the two intervals:\n- Lower bound: $\\max(-\\frac{T_{s}}{2}, -\\frac{T_{s}}{2} - \\delta T_{r}) = -\\frac{T_{s}}{2}$ (since $\\delta T_{r} > 0$)\n- Upper bound: $\\min(\\frac{T_{s}}{2}, \\frac{T_{s}}{2} - \\delta T_{r}) = \\frac{T_{s}}{2} - \\delta T_{r}$ (since $\\delta T_{r} > 0$)\n\nThus, the range of \"safe\" adversarial offsets that do not guarantee a misalignment is:\n$$-\\frac{T_{s}}{2}  e_{\\text{adv}}  \\frac{T_{s}}{2} - \\delta T_{r}$$\n\nA misalignment is guaranteed if $e_{\\text{adv}}$ lies outside this open interval. The boundary values that will cause a misalignment are:\n$$e_{\\text{adv}} = -\\frac{T_{s}}{2} \\quad \\text{or} \\quad e_{\\text{adv}} = \\frac{T_{s}}{2} - \\delta T_{r}$$\n\nThe problem asks for the \"smallest adversarial offset $e_{\\text{adv}}$\". In the context of an attack, \"smallest\" typically refers to the value with the minimum magnitude, $|e_{\\text{adv}}|$, as this would represent the most subtle or efficient attack. We must therefore compare the absolute values of the two boundary offsets.\n\nLet's calculate the numerical values of these boundaries.\nThe given parameters are:\n- $T_{s} = 6\\,\\text{ms} = 6 \\times 10^{-3}\\,\\text{s}$\n- $T_{r} = 30\\,\\text{s}$\n- $\\delta = 15 \\times 10^{-6}$\n\nFirst, we calculate the threshold $\\frac{T_s}{2}$:\n$$\\frac{T_{s}}{2} = \\frac{6 \\times 10^{-3}\\,\\text{s}}{2} = 3 \\times 10^{-3}\\,\\text{s} = 3\\,\\text{ms}$$\nNext, we calculate the total accumulated drift over the interval $T_r$:\n$$\\delta T_{r} = (15 \\times 10^{-6}) \\times (30\\,\\text{s}) = 450 \\times 10^{-6}\\,\\text{s} = 0.45 \\times 10^{-3}\\,\\text{s} = 0.45\\,\\text{ms}$$\n\nNow we can determine the two boundary values for $e_{\\text{adv}}$:\n1.  The negative boundary is $e_{\\text{adv},1} = -\\frac{T_{s}}{2} = -3\\,\\text{ms}$.\n2.  The positive boundary is $e_{\\text{adv},2} = \\frac{T_{s}}{2} - \\delta T_{r} = 3\\,\\text{ms} - 0.45\\,\\text{ms} = 2.55\\,\\text{ms}$.\n\nTo find the smallest required offset, we compare the magnitudes of these two values:\n$$|e_{\\text{adv},1}| = |-3\\,\\text{ms}| = 3\\,\\text{ms}$$\n$$|e_{\\text{adv},2}| = |2.55\\,\\text{ms}| = 2.55\\,\\text{ms}$$\n\nThe minimum magnitude is $2.55\\,\\text{ms}$, which corresponds to the adversarial offset $e_{\\text{adv}} = 2.55\\,\\text{ms}$. This is the smallest offset an adversary can inject to guarantee a misalignment will occur (specifically, at $t=T_{r}$).\n\nThe problem requires the answer to be expressed in milliseconds, rounded to four significant figures. The calculated value $2.55\\,\\text{ms}$ is exact based on the given parameters. To express it with four significant figures, we write it as $2.550\\,\\text{ms}$.",
            "answer": "$$\\boxed{2.550}$$"
        },
        {
            "introduction": "Our final practice moves from analyzing fixed threats to modeling the strategic cat-and-mouse game between an attacker and a defender. Using a Stackelberg game model, you will determine the optimal allocation of limited defensive resources to minimize the potential damage from a rational attacker who observes your defenses. This advanced exercise  introduces the powerful tools of game theory and optimization for designing robust and intelligent security postures.",
            "id": "4250667",
            "problem": "A Digital Twin (DT) of a Cyber-Physical System (CPS) maintains real-time estimates of subsystem states and allocates computational monitoring resources to detect attacks across three subsystems: the actuator network ($i=1$), the sensor bus ($i=2$), and the control logic ($i=3$). Let the defender allocate a nonnegative monitoring intensity $x_i$ to subsystem $i$, incurring resource cost proportional to $x_i$. The defender has a total resource budget $b$ and must satisfy $\\sum_{i=1}^{3} c_i x_i \\leq b$ with $x_i \\geq 0$.\n\nAssume the following fundamental base:\n- The attacker moves after observing the defender’s allocation $(x_1,x_2,x_3)$, and chooses a single subsystem $i$ to attack.\n- For each subsystem $i$, the DT-induced detection probability under monitoring intensity $x_i$ obeys the standard saturating law $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$, where $\\alpha_i  0$ represents detection efficacy per unit resource.\n- If the attack on subsystem $i$ is not detected, the attacker gains expected payoff $D_i$ (the attacker’s benefit equals the defender’s loss). If the attack is detected, the attacker incurs a disutility $K  0$ (for example, resource expenditure failure, attribution risk, or counter-response), and gains no $D_i$. The attacker’s expected utility on subsystem $i$ is therefore the expected value under detection, $U_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K$.\n- The attacker best-responds by choosing subsystem $i$ maximizing $U_i(x_i)$. The defender is conservative and seeks to minimize the worst-case attacker utility across subsystems, i.e., minimize $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$ subject to the budget and nonnegativity constraints.\n\nTasks:\n1. Starting from the definitions above, formalize the bilevel Stackelberg attacker-defender model as a single-level optimization problem faced by the defender, expressing the objective solely in terms of $(x_1,x_2,x_3)$ and the given parameters.\n2. Derive, from first principles and without shortcut formulas, the optimality conditions characterizing an optimal allocation $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ under the case that all three subsystems receive positive allocation at optimum.\n3. For the parameter values $c_1 = c_2 = c_3 = 1$, $\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$, $K = 40$, $(D_1,D_2,D_3) = (60,80,100)$, and budget $b = 3 \\ln(2)$, compute the defender’s optimal allocation vector $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ in exact form (do not round). Express the allocation in dimensionless resource units. The final answer must be written as a single row vector using the $\\mathrm{pmatrix}$ environment.",
            "solution": "The user has provided a problem statement that successfully passes the validation protocol. It is scientifically grounded in game theory and optimization, well-posed, objective, and contains all necessary information for a rigorous solution. We may therefore proceed.\n\nThe problem describes a Stackelberg game where the defender (leader) allocates monitoring resources and the attacker (follower) chooses a subsystem to target. The defender's goal is to minimize the attacker's maximum possible utility. We will address the three tasks in order.\n\n### Task 1: Formalization of the Bilevel Model\n\nThe problem is a bilevel optimization problem, but since the follower's (attacker's) problem is simply to select the maximum of a set of values, it can be collapsed into a single-level minimax problem for the defender.\n\nFirst, we express the attacker's utility on subsystem $i$, $U_i(x_i)$, in terms of the defender's allocation $x_i$. The detection probability is given as $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$. The attacker's utility is $U_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K$.\nSubstituting the expression for $p_i(x_i)$:\n$$\nU_i(x_i) = \\Big(1 - \\big(1 - \\exp(-\\alpha_i x_i)\\big)\\Big) D_i - \\big(1 - \\exp(-\\alpha_i x_i)\\big) K\n$$\n$$\nU_i(x_i) = \\exp(-\\alpha_i x_i) D_i - K + K \\exp(-\\alpha_i x_i)\n$$\n$$\nU_i(x_i) = (D_i + K) \\exp(-\\alpha_i x_i) - K\n$$\nThe attacker, observing the defender's allocation $(x_1, x_2, x_3)$, will choose the subsystem $i$ that maximizes this utility. The attacker's best-response utility is therefore $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$.\n\nThe defender's objective is to choose the allocation $(x_1, x_2, x_3)$ to minimize this maximum utility, subject to budget and non-negativity constraints. The defender's optimization problem is:\n$$\n\\min_{x_1, x_2, x_3} \\left( \\max_{i \\in \\{1,2,3\\}} \\Big\\{ (D_i + K) \\exp(-\\alpha_i x_i) - K \\Big\\} \\right)\n$$\nsubject to:\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\nThis is the single-level formulation of the defender's problem. To make it more amenable to standard optimization techniques, we can convert this minimax problem into a constrained optimization problem using the epigraph formulation. We introduce an auxiliary variable $U$ which will represent the maximum utility.\nThe problem is equivalent to:\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\nsubject to:\n$$\nU_i(x_i) \\leq U \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\nSubstituting the expression for $U_i(x_i)$, the single-level optimization problem is:\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\nsubject to:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i) - K \\leq U \\quad \\text{for } i=1,2,3\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i - b \\leq 0\n$$\n$$\n-x_i \\leq 0 \\quad \\text{for } i=1,2,3\n$$\n\n### Task 2: Derivation of Optimality Conditions\n\nWe seek to derive the optimality conditions for the case where the optimal allocation is interior, i.e., $x_i^{\\star} > 0$ for all $i \\in \\{1,2,3\\}$. We use the Karush-Kuhn-Tucker (KKT) conditions for the constrained optimization problem formulated above.\n\nThe Lagrangian $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(x_1, x_2, x_3, U, \\lambda_1, \\lambda_2, \\lambda_3, \\mu, \\nu_1, \\nu_2, \\nu_3) = U + \\sum_{i=1}^{3} \\lambda_i \\left( (D_i + K) \\exp(-\\alpha_i x_i) - K - U \\right) + \\mu \\left( \\sum_{i=1}^{3} c_i x_i - b \\right) - \\sum_{i=1}^{3} \\nu_i x_i\n$$\nwhere $\\lambda_i, \\mu, \\nu_i$ are the non-negative Lagrange multipliers.\n\nThe KKT conditions for an optimal point $(x^\\star, U^\\star, \\lambda^\\star, \\mu^\\star, \\nu^\\star)$ are:\n1.  **Stationarity:** The gradient of the Lagrangian with respect to the primal variables must be zero.\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial U} = 1 - \\sum_{i=1}^{3} \\lambda_i = 0 \\implies \\sum_{i=1}^{3} \\lambda_i = 1$.\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial x_i} = \\lambda_i (D_i + K) (-\\alpha_i) \\exp(-\\alpha_i x_i) + \\mu c_i - \\nu_i = 0$ for $i=1,2,3$.\n\n2.  **Primal Feasibility:** The constraints must be satisfied.\n    -   $(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K \\leq U^{\\star}$ for $i=1,2,3$.\n    -   $\\sum_{i=1}^{3} c_i x_i^{\\star} \\leq b$.\n    -   $x_i^{\\star} \\geq 0$ for $i=1,2,3$.\n\n3.  **Dual Feasibility:** $\\lambda_i \\geq 0$, $\\mu \\geq 0$, $\\nu_i \\geq 0$ for $i=1,2,3$.\n\n4.  **Complementary Slackness:**\n    -   $\\lambda_i ((D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star}) = 0$ for $i=1,2,3$.\n    -   $\\mu (\\sum_{i=1}^{3} c_i x_i^{\\star} - b) = 0$.\n    -   $\\nu_i x_i^{\\star} = 0$ for $i=1,2,3$.\n\nWe are analyzing the case of an interior solution, where $x_i^{\\star} > 0$ for all $i$. By complementary slackness, this implies $\\nu_i = 0$ for all $i$. The stationarity condition for $x_i$ simplifies to:\n$$\n-\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) + \\mu c_i = 0\n$$\n$$\n\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = \\mu c_i\n$$\nSince $\\alpha_i > 0$, $D_i+K > 0$, $c_i > 0$, and $\\exp(-\\alpha_i x_i^{\\star}) > 0$, the right side, $\\mu c_i$, must be positive unless $\\lambda_i=0$. If $\\mu=0$, then $\\lambda_i=0$ for all $i$, which contradicts $\\sum \\lambda_i = 1$. Therefore, we must have $\\mu > 0$.\n\nSince $\\mu > 0$, complementary slackness for the budget constraint implies it must be active:\n$$\n\\sum_{i=1}^{3} c_i x_i^{\\star} = b\n$$\nFurthermore, since $\\mu > 0$ and $c_i > 0$, the term $\\mu c_i$ is strictly positive. This implies that for each $i$, $\\lambda_i$ must be strictly positive, $\\lambda_i > 0$. If $\\lambda_j = 0$ for some $j$, then $\\mu c_j=0$, which is a contradiction.\n\nSince $\\lambda_i > 0$ for all $i$, complementary slackness for the utility constraints implies they must all be active:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star} = 0 \\quad \\text{for } i=1,2,3\n$$\nThis means that at the optimum, the attacker's utility is the same for all three subsystems:\n$$\n(D_1 + K) \\exp(-\\alpha_1 x_1^{\\star}) - K = (D_2 + K) \\exp(-\\alpha_2 x_2^{\\star}) - K = (D_3 + K) \\exp(-\\alpha_3 x_3^{\\star}) - K\n$$\nThis is the \"equalized utility\" principle for this type of security game.\n\nThus, the optimality conditions characterizing an interior solution $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ are the following system of equations:\n1.  **Equal Attacker Utility:** $(D_1+K)\\exp(-\\alpha_1 x_1^{\\star}) = (D_2+K)\\exp(-\\alpha_2 x_2^{\\star}) = (D_3+K)\\exp(-\\alpha_3 x_3^{\\star})$.\n2.  **Active Budget Constraint:** $\\sum_{i=1}^{3} c_i x_i^{\\star} = b$.\n\nThese conditions form a system of equations that can be solved for $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$. Let the common value in the first condition be $C_U = U^{\\star}+K$. Then for each $i$:\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = C_U \\implies x_i^{\\star} = \\frac{1}{\\alpha_i} \\ln\\left(\\frac{D_i+K}{C_U}\\right)\n$$\nSubstituting these into the budget constraint allows for the determination of $C_U$.\n\n### Task 3: Computation of the Optimal Allocation\n\nWe are given the parameters: $c_1 = c_2 = c_3 = 1$, $\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$, $K = 40$, $(D_1,D_2,D_3) = (60,80,100)$, and budget $b = 3 \\ln(2)$.\n\nWe assume an interior solution and apply the optimality conditions derived above.\nThe parameters simplify the conditions:\n1.  $(D_1+K)\\exp(-x_1^{\\star}) = (D_2+K)\\exp(-x_2^{\\star}) = (D_3+K)\\exp(-x_3^{\\star})$.\n2.  $x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = b$.\n\nLet's compute the values of $D_i+K$:\n$D_1 + K = 60 + 40 = 100$\n$D_2 + K = 80 + 40 = 120$\n$D_3 + K = 100 + 40 = 140$\n\nLet $C_U_s = (D_i+K)\\exp(-x_i^{\\star})$ be the common value.\nFrom this, we can express each $x_i^{\\star}$ in terms of $C_U_s$:\n$x_1^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right)$\n$x_2^{\\star} = \\ln\\left(\\frac{120}{C_U_s}\\right)$\n$x_3^{\\star} = \\ln\\left(\\frac{140}{C_U_s}\\right)$\n\nSubstitute these into the budget constraint:\n$x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right) + \\ln\\left(\\frac{120}{C_U_s}\\right) + \\ln\\left(\\frac{140}{C_U_s}\\right) = b$\nUsing logarithm properties:\n$\\ln(100) - \\ln(C_U_s) + \\ln(120) - \\ln(C_U_s) + \\ln(140) - \\ln(C_U_s) = b$\n$\\ln(100 \\times 120 \\times 140) - 3\\ln(C_U_s) = b$\n$\\ln(1680000) - 3\\ln(C_U_s) = 3\\ln(2)$\n$3\\ln(C_U_s) = \\ln(1680000) - 3\\ln(2) = \\ln(1680000) - \\ln(2^3) = \\ln(1680000) - \\ln(8)$\n$3\\ln(C_U_s) = \\ln\\left(\\frac{1680000}{8}\\right) = \\ln(210000)$\n$\\ln(C_U_s) = \\frac{1}{3}\\ln(210000) = \\ln((210000)^{1/3})$\n$C_U_s = (210000)^{1/3}$\n\nNow we can compute the individual allocations $x_i^{\\star}$:\n$x_1^{\\star} = \\ln(100) - \\ln(C_U_s) = \\ln(100) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(100) - \\ln(210000)}{3} = \\frac{\\ln(100^3) - \\ln(210000)}{3}$\n$x_1^{\\star} = \\frac{\\ln(1000000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1000000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{100}{21}\\right)$\n\n$x_2^{\\star} = \\ln(120) - \\ln(C_U_s) = \\ln(120) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(120) - \\ln(210000)}{3} = \\frac{\\ln(120^3) - \\ln(210000)}{3}$\n$x_2^{\\star} = \\frac{\\ln(1728000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1728000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{1728}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{288}{35}\\right)$\n\n$x_3^{\\star} = \\ln(140) - \\ln(C_U_s) = \\ln(140) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(140) - \\ln(210000)}{3} = \\frac{\\ln(140^3) - \\ln(210000)}{3}$\n$x_3^{\\star} = \\frac{\\ln(2744000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{2744000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{2744}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{196}{15}\\right)$\n\nSince $\\frac{100}{21} > 1$, $\\frac{288}{35} > 1$, and $\\frac{196}{15} > 1$, all $x_i^{\\star}$ are positive, which confirms our working assumption of an interior solution. The optimal allocation is $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} \\ln\\left(\\frac{100}{21}\\right)  \\frac{1}{3} \\ln\\left(\\frac{288}{35}\\right)  \\frac{1}{3} \\ln\\left(\\frac{196}{15}\\right) \\end{pmatrix}}\n$$"
        }
    ]
}