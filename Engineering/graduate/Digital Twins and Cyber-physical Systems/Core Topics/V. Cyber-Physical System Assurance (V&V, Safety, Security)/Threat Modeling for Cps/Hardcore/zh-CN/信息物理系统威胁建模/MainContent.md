## 引言
信息物理系统（CPS）通过计算、网络与物理过程的深度融合，正在驱动从[智能制造](@entry_id:1131785)到自动驾驶等关键领域的变革。然而，这种深度融合也带来了前所未有的安全挑战：一个网络空间的漏洞可能被放大为现实世界中的物理危害。传统的、为纯信息技术（IT）系统设计的威胁建模方法，由于忽视了物理定律在决定最终后果中的核心作用，已不足以应对CPS的复杂性与风险。这一知识鸿沟使得许多关键系统面临着未被识别的、可能导致灾难性后果的威胁。

本文旨在填补这一空白，为CPS[威胁建模](@entry_id:924842)提供一个严谨、系统且可操作的框架。我们将超越传统的[网络安全](@entry_id:262820)范式，深入探讨信息、控制与物理动态三者之间的复杂相互作用。通过阅读本文，您将学习如何构建“感知物理”的威胁模型，量化分析攻击者行为，并在设计中系统性地权衡安防与安全。文章分为三个核心部分：

- 在“**原理与机制**”一章中，我们将从第一性原理出发，阐明为何必须将物理模型置于威胁分析的核心。我们将介绍结构化的建模方法，形式化定义攻击者，并揭示安防与安全之间微妙的相互作用。同时，您还将了解[数字孪生](@entry_id:171650)在异常检测和脆弱性分析中的革命性作用。

- “**应用与跨学科连接**”一章将理论付诸实践，展示这些原则如何应用于工业协议分析、[鲁棒控制设计](@entry_id:1131080)和实时系统等具体场景。本章将强调[CPS安全](@entry_id:1131376)是一个必须与控制理论、人因工程和[功能安全](@entry_id:1125387)等领域协同解决的整体性问题。

- 最后的“**动手实践**”部分提供了一系列精心设计的计算问题，让您能够亲手应用所学知识，量化分析时间同步攻击、评估安防措施对[系统稳定性](@entry_id:273248)的影响，并运用博弈论来优化防御策略。

通过这一结构化的学习路径，本文将为您装备必要的知识与工具，以应对下一代信息物理系统所面临的严峻安全挑战。

## 原理与机制

在上一章中，我们介绍了信息物理系统（CPS）及其[数字孪生](@entry_id:171650)的基本概念。本章将深入探讨CPS[威胁建模](@entry_id:924842)的核心原理与关键机制。我们将摒弃传统的、仅适用于纯信息技术（IT）系统的威胁建模方法，并构建一个专为CPS设计的严谨框架。该框架必须承认并整合一个基本事实：在CPS中，网络攻击的最终影响是由物理定律决定的。我们将从第一性原理出发，系统地阐述为何必须理解物理动态、如何形式化定义攻击者与攻击行为、安全与安防之间复杂的相互作用，以及如何利用先进的建模方法和数字孪生技术来识别和缓解风险。

### 威胁的物理维度：为何“感知物理”至关重要

传统的IT安全分析通常将物理世界视为一个外部环境，其行为独立于计算系统。然而，在CPS中，计算与物理过程通过反馈回路紧密耦合，形成一个统一的动态系统。忽视物理动态的[威胁建模](@entry_id:924842)不仅是不完整的，而且是危险的。一个看似无害的网络入侵，可能通过利用系统的物理特性而被放大为灾难性的物理后果。

为了具体说明这一点，我们考虑一个在工业CPS中常见的单自由度运动轴。其物理特性可以通过一个[二阶线性常微分方程](@entry_id:189146)来精确描述，该方程源于[牛顿第二定律](@entry_id:274217)。假设系统方程为：
$$
\ddot{x}(t) + 2 \zeta \omega_n \dot{x}(t) + \omega_n^2 x(t) = \omega_n^2 u(t)
$$
其中，$x(t)$ 是位移，$u(t)$ 是控制器发出的指令输入，$\omega_n$ 是系统的**固有频率 (natural frequency)**，$\zeta$ 是**[阻尼比](@entry_id:262264) (damping ratio)**。系统的安防要求是，在任何时候位移都不能超过一个安防阈值，即 $|x(t)| \le x_{\mathrm{safe}}$。

现在，假设一个威胁建模团队采用了一种**“物理不可知 (plant-agnostic)”**的方法。他们将执行器和物理过程视为一个静态的、增益为1的黑箱，即假设 $|x(t)| \approx |u(t)|$。如果攻击者能够注入一个振幅为 $u_0$ 的[正弦输入](@entry_id:269486)信号 $u(t) = u_0 \sin(\omega t)$，且 $u_0$ 远小于安防阈值 $x_{\mathrm{safe}}$（例如，$u_0 = 0.1$ 而 $x_{\mathrm{safe}} = 1.0$），那么这个“物理不可知”模型会得出结论：系统是安防的，因为 $0.1 \le 1.0$。

然而，这种结论是完全错误的。物理系统的真实响应取决于输入信号的频率 $\omega$。根据[线性系统理论](@entry_id:172825)，当输入频率接近系统的固有频率时，会发生**共振 (resonance)** 现象。在[稳态](@entry_id:139253)下，系统对[正弦输入](@entry_id:269486)的响应幅值 $X$ 由下式给出：
$$
X = u_0 |G(j\omega)| = u_0 \frac{\omega_n^2}{\sqrt{(\omega_n^2 - \omega^2)^2 + (2 \zeta \omega_n \omega)^2}}
$$
其中 $|G(j\omega)|$ 是系统的[频率响应](@entry_id:183149)幅值。如果攻击者精心选择攻击频率，使其等于系统的固有频率 $\omega = \omega_n$，那么响应的增益变为：
$$
|G(j\omega_n)| = \frac{1}{2\zeta}
$$
对于一个典型的、阻尼较小（例如 $\zeta = 0.05$）的机械系统，这个增益可以非常大，此处为 $1/(2 \times 0.05) = 10$。这意味着，一个振幅仅为 $u_0 = 0.1$ 米的微小输入，在物理系统内部会被放大10倍，导致输出振幅达到 $X = 10 \times 0.1 = 1.0$ 米。这个位移恰好达到了安防边界 $x_{\mathrm{safe}}$，构成了一个严重的安防隐患。

这个例子  戏剧性地说明了“物理不可知”[威胁建模](@entry_id:924842)的根本缺陷。它由于忽略了物理动态，未能识别出一个由小规模网络攻击引发的、可导致重大物理危害的真实威胁，从而违反了危害识别的**完备性 (completeness)** 原则。因此，任何严谨的CPS威胁建模都必须是**“感知物理的 (plant-aware)”**，即必须将物理过程的动态模型作为分析的核心组成部分。

### CPS威胁建模的结构化框架

认识到物理动态的核心作用后，我们需要一个能够系统性地整合这些知识的正式方法论。这就是**[结构化威胁建模](@entry_id:1132567) (Structured Threat Modeling, STM)** 的宗旨。与依赖直觉或临时检查表的非结构化方法不同，STM for CPS 是一种基于模型的安防分析方法，它要求我们首先为整个系统创建一个全面的、跨领域的模型 。

这个模型必须超越纯粹的IT架构图，它需要包含：
- **物理过程模型 (Plant Dynamics)**：描述系统物理行为的方程，例如 $\dot{x}(t)=f(x(t),u(t),w(t))$。
- **传感与测量模型 (Measurement Model)**：描述传感器如何将物理状态转化为数字信号，例如 $y(t)=h(x(t),v(t))$。
- **控制策略 (Controller Policy)**：描述控制器如何根据传感器数据和参考目标计算控制指令，例如 $u(t)=\pi(\hat{x}(t),r(t))$。
- **执行器、网络与时序特性**：包括执行器的物理限制、网络的延迟与[抖动](@entry_id:200248)，以及控制任务的执行时间等。
- **物理与控制不变量 (Invariants)**：定义系统安防运行必须遵守的物理定律或控制目标约束，例如能量守恒定律或状态必须保持在安防区域内的约束 $I(x,u)$。

基于这样一个综合模型，STM的过程包括：识别关键资产（包括物理资产和信息资产）、定义信任边界、识别跨越这些边界的攻击面（包括网络接口和物理接口），并系统性地推导可能导致安防不变量被违反的威胁场景。这种模型驱动的方法确保了分析的严谨性、[可重复性](@entry_id:194541)和更高的完备性，因为它将威胁直接与潜在的物理后果联系起来。

### 定义攻击者：从随机故障到[策略博弈](@entry_id:271880)

威胁建模不仅要定义被攻击的系统，还必须清晰地定义攻击者本身。在传统的安防工程中，[风险分析](@entry_id:140624)通常基于**[故障模型](@entry_id:1124860) (fault model)**，它假设系统组件会因老化、磨损或环境因素而发生随机、非恶意的失效。这类事件通常可以用概率分布来描述，例如，假设组件故障遵循一个泊松过程。

然而，在安防分析中，我们面对的是一个有智能、有目标的**攻击者 (adversary)**。这两者在评估系统风险时有着根本性的区别。我们可以通过一个例子来阐明这一点 。假设一个[数字孪生](@entry_id:171650)以固定的时间间隔 $\Delta$ 对系统进行采样，以检测异常事件。每次事件的损失与从事件发生到下一次采样之间的时间延迟成正比，比例系数为 $c$。

- 在**[故障模型](@entry_id:1124860)**下，假设故障事件遵循速率为 $\lambda$ 的泊松过程。由于泊松过程的随机性，故障发生在一个采样间隔内的任意时刻是等可能的。因此，平均检测延迟为 $\Delta/2$。在长达 $H$ 的时间范围内，预期的总损失为：
$$E[\text{Loss}_{\text{fault}}] = (\lambda H) \times c \times \frac{\Delta}{2} = c \lambda H \frac{\Delta}{2}$$

- 在**攻击者模型**下，我们假设攻击者是策略性的，他知道采样时间表，并希望最大化造成的损失。为了最大化单次攻击的检测延迟，攻击者会在每次采样刚刚结束后立即发动攻击。这样，检测延迟将趋近于完整的采样周期 $\Delta$。如果攻击者的资源预算允许他在时间 $H$ 内发动 $m$ 次攻击，其能够造成的最大总损失为：
$$\text{Loss}_{\text{adversary}} = m \times c \times \Delta$$

如果我们设定 $m = \lambda H$，即两种模型中的事件总数相同，攻击者造成的最大损失恰好是随机故障预期损失的两倍。这个差异的根源在于，风险评估的性质从对[随机过程](@entry_id:268487)的**平均化 (averaging)** 转变为与智能对手的**最优化博弈 (optimization)**。攻击者不是[随机变量](@entry_id:195330)，而是一个优化者。

因此，一个完整的攻击者模型需要形式化地描述其能力和意图。这通常通过定义以下几个关键参数来实现 ：
- **能力集 (Capability Set, $C_{\text{adv}}$)**：攻击者可以访问和操纵哪些系统组件或信道（例如，传感器、执行器、网络）。
- **资源预算 (Budget, $B$)**：攻击者可以投入的总资源，如时间、金钱或计算能力。这限制了攻击的规模或频率。
- **知识水平 (Knowledge, $K_{\text{adv}}$)**：攻击者对系统模型的了解程度。更精确的知识可以帮助攻击者设计更隐蔽、更有效的攻击（例如，通过降低检测算法的敏感度 $\alpha$）。
- **[隐蔽](@entry_id:196364)性约束 (Stealth Constraint, $\sigma$)**：攻击者为了避免被发现而必须遵守的限制。这通常表现为要求攻击产生的异常信号强度低于某个检测阈值。

通过这组参数，我们可以将攻击者的行为描述为一个约束优化问题：在能力、预算和[隐蔽](@entry_id:196364)性约束下，最大化对系统造成的物理损害。这种形式化定义是评估系统真实脆弱性的基础。

### 安防与安全的相互作用

在CPS中，**安防 (security)**（防护恶意攻击）和**安全 (safety)**（避免意外伤害）是两个紧密交织但又时常冲突的目标。一个设计上的变更如果只考虑其中一个目标，很可能会对另一个产生意想不到的负面影响。

#### 从安防漏洞到安全危害

网络攻击转化为物理危害是CPS最核心的风险。其因果链可以通过分析系统的[反馈控制](@entry_id:272052)回路来清晰地揭示。考虑一个简单的反馈系统，其物理过程由 $\dot{x}(t) = -\alpha x(t) + \beta u(t)$ 描述，其中 $x(t)$ 是一个需要被控制的物理状态（如温度），$u(t)$ 是控制输入（如加热功率）。控制器根据传感器测量的状态 $y_a(t)$ 来调节输入，即 $u(t) = K(r - y_a(t))$，目标是使状态 $x(t)$ 维持在设定值 $r$ 附近。系统的安全要求是 $x(t)$ 必须始终低于安全阈值 $\bar{x}$ 。

现在，假设攻击者入侵了传感器，并注入了一个负偏置 $a(t) = -\Delta$，使得控制器收到的测量值变为 $y_a(t) = x(t) - \Delta$。这个纯粹的**数据完整性攻击**会按以下因果链传播：
1.  **感知欺骗**：控制器错误地认为系统状态 $x(t)$ 比实际值低了 $\Delta$。
2.  **控制反应**：由于感知到的状态偏低，控制器会增加其输出 $u(t)$ 以“纠正”这个“偏差”。一个负的测量扰动，通过负反馈控制器，变成了一个正的控制输入扰动。
3.  **物理响应**：增加的控制输入 $u(t)$ 通过物理过程 $\dot{x} = -\alpha x + \beta u$ 驱动状态 $x(t)$ 上升。
4.  **危害发生**：系统最终将稳定在一个新的、更高的平衡点 $x^{\star}$。如果攻击偏置 $\Delta$ 足够大，这个新的平衡点 $x^{\star} = \frac{\beta K(r + \Delta)}{\alpha + \beta K}$ 就可能超过安全阈值 $\bar{x}$，从而导致物理危害（例如，设备过热）。

这个过程清晰地展示了网络空间的一个安防漏洞（传感器被入侵）如何通过系统的内在[反馈机制](@entry_id:269921)，一步步转化为物理空间的安全事故。

#### 从安防措施到安全风险

反之，为了增强安防而引入的措施，也可能无意中削弱系统的安全性，创造出“安全但不安防”或“安防但不安全”的矛盾局面。

以一辆自动叉车为例 。为了防止碰撞，它必须在距离障碍物 $d$ 米内停下。其停车距离由反应延迟 $\tau$ 和物理制动距离共同决定：$d_{\text{travel}}(\tau) = v\tau + \frac{v^2}{2a}$。假设在只有基础网络和计算延迟 $\tau_{\text{base}}$ 的情况下，系统是安全的，即 $d_{\text{travel}}(\tau_{\text{base}}) \le d$。

为了防止恶意或未经授权的急停操作（一种安防考虑），工程师决定增加一个多因素认证机制。这个安防措施虽然有效，但它也引入了额外的认证延迟 $\tau_{\text{auth}}$。现在，总延迟变为 $\tau = \tau_{\text{base}} + \tau_{\text{auth}}$。如果这个增加的延迟使得总停车距离 $d_{\text{travel}}(\tau)$ 超过了安全距离 $d$，那么这个旨在提升安防的设计反而创造了一个新的安全风险：在真实紧急情况下，叉车将无法及时刹车，导致碰撞。这是一个典型的“**安防但不安全 (secure but unsafe)**”的例子。

同样，一个“**安全但不安防 (safe but insecure)**”的系统也是可能的。例如，如果急停功能通过一个物理上隔离的、不受网络影响的专用通道实现，那么系统的安全性就得到了保障。但如果系统的其他部分，如用于维护的诊断接口，没有经过充分的认证和保护，那么系统在安防上就是脆弱的。尽管这个安防漏洞可能不会直接导致安全事故，但它仍然违反了安防策略，可能被用于其他恶意目的。

这些例子强调，在CPS的设计和分析中，必须将安防和安全作为一个整体进行协同考虑，识别并管理它们之间的权衡和冲突。

### 信息物理攻击[分类学](@entry_id:172984)

为了系统性地识别威胁，我们需要一个清晰的攻击分类框架。我们可以从两个互补的视角来构建这个框架：一个是以组件为中心的IT视角，另一个是更深入的、以控制理论为核心的物理视角。

#### 组件为中心的[STRIDE模型](@entry_id:1132528)

STRIDE是一个在IT领域广泛使用的威胁建模框架，它将威胁分为六类，分别对应安防属性的破坏：
- **Spoofing (仿冒)**：违反**身份验证 (Authentication)**
- **Tampering (篡改)**：违反**完整性 (Integrity)**
- **Repudiation (否认)**：违反**不可否认性 (Non-repudiation)**
- **Information Disclosure ([信息泄露](@entry_id:155485))**：违反**机密性 (Confidentiality)**
- **Denial of Service (拒绝服务)**：违反**可用性 (Availability)**
- **Elevation of Privilege ([权限提升](@entry_id:753756))**：违反**授权 (Authorization)**

我们可以将这个框架应用于CPS的典型组件：**传感器 (S)**、**执行器 (A)**、**控制器/数字孪生 (K)** 和 **网络 (N)** 。
- **仿冒**：攻击者可以仿冒一个传感器S向控制器K发送虚假数据，或者通过网络N仿冒控制器向执行器A发送恶意指令。
- **篡改**：数据在产生（S, K）、传输（N）和消费（A, K）的任何环节都可能被篡改。因此，篡改威胁遍及所有组件。
- **否认**：控制器K和网络设备N通常负责记录日志。攻击者可能试图修改或删除这些日志以否认其行为。
- **[信息泄露](@entry_id:155485)**：敏感的系统模型或历史数据通常存储在控制器/数字孪生K中，而实时数据则通过网络N传输。这两者都是[信息泄露](@entry_id:155485)的主要风险点。
- **[拒绝服务](@entry_id:748298)**：网络N是DoS攻击的常见目标（如流量拥塞），但物理层面的DoS攻击（如使用干扰器阻塞传感器S的信号）在CPS中同样重要。
- **[权限提升](@entry_id:753756)**：控制器K和网络设备N作为复杂的计算单元，通常具有多级权限系统。攻击者可能利用漏洞从低权限用户提升为管理员，从而完[全控制](@entry_id:275827)该组件。

#### 控制理论视角的攻击形式化

虽然STRIDE提供了一个很好的起点，但CPS的威胁分析需要更深入、更精确的控制理论语言。从这个角度，我们可以将攻击分为以下几类  ：

1.  **数据完整性攻击 (Data Integrity Attacks)**：这类攻击旨在修改传输中或存储的数据的值，但不阻止数据的传输。它们可以直接影响系统的感知和决策。在状态空间模型中，这通常被建模为对传感器测量或执行器指令的**加性扰动 (additive perturbations)**：
    $$
    y_k^{\star} = y_k + a_k^y \quad (\text{传感器攻击})
    $$
    $$
    u_k^{\star} = u_k + a_k^u \quad (\text{执行器攻击})
    $$
    其中 $a_k^y$ 和 $a_k^u$ 是攻击者注入的恶意信号。

2.  **可用性攻击 (Availability Attacks)**：这类攻击旨在阻止或延迟对数据或服务的访问。典型的例子是拒绝服务（DoS）攻击。在模型中，这通常表现为**乘性扰动 (multiplicative perturbations)** 或数据包丢失，即合法数据被完全丢弃：
    $$
    \tilde y_k = \gamma_k^y y_k \quad \text{with } \gamma_k^y \in \{0,1\} \quad (\text{Packet Drops})
    $$
    其中 $\gamma_k^y=0$ 表示数据包丢失。

3.  **时序信道攻击 (Timing Channel Attacks)**：这类攻击独特于CPS，它不改变数据包的内容，而是操纵其时间属性，如延迟、[抖动](@entry_id:200248)或采样时刻。由于CPS的正确运行严重依赖于精确的时序，这类攻击可以造成严重后果。例如，恶意改变[脉宽调制](@entry_id:262754)（PWM）信号的[占空比](@entry_id:199172)调度，或者攻击用于[时钟同步](@entry_id:270075)的精确时间协议（PTP），都可以破坏控制回路的稳定性或性能，而数据值本身看起来却是“正确”的。

4.  **控制逻辑攻击 (Control Logic Attacks)**：这类攻击最为[隐蔽](@entry_id:196364)和危险，它直接修改控制器或数字孪生内部的软件代码、模型参数或控制算法。它不是在信道上注入数据，而是改变系统处理数据的方式。这可以被建模为控制律函数 $\kappa(\cdot)$ 本身的变化：
    $$
    u_k = \tilde{\kappa}(\hat{x}_k), \quad \text{with } \tilde{\kappa} \neq \kappa
    $$
    这种攻击可以彻底改变系统的行为，例如，将一个稳定的控制器变成不稳定的。

这种基于控制理论的分类法提供了一种数学上严谨的方式来描述和分析攻击对系统动态的影响，是进行量化风险评估和设计防御策略的基础。

### 建模方法与[数字孪生](@entry_id:171650)的作用

有了对威胁本质和分类的理解，我们最后讨论如何实际执行威胁建模，以及数字孪生在其中扮演的关键角色。

#### 分析方法学：STPA-Sec 与攻击树

在CPS[威胁建模](@entry_id:924842)领域，两种主流方法学形成了有趣的对比：STPA-Sec和攻击树 。

- **攻击树 (Attack Trees)** 是一种**自底向上、以攻击者为中心**的方法。分析从一个明确的攻击者目标（例如，“导致储罐[溢出](@entry_id:172355)”）开始，然后通过逻辑与（AND）和或（OR）门，将这个顶层目标分解为一系列具体的、可执行的子任务（例如，“获取管理员凭据” AND “注入恶意代码”）。攻击树非常适合用于枚举具体的攻击路径和计算特定路径的成功概率。然而，它的视野局限于已知的、由攻击者驱动的威胁。

- **STPA-Sec (System-Theoretic Process Analysis for Security)** 则是一种**自顶向下、以系统为中心**的方法。它源于系统安全工程，其出发点不是攻击者，而是系统级的**损失 (Losses)** 和**危害 (Hazards)**。分析过程是：
    1.  识别不可接受的系统级损失（例如，人员伤亡、环境破坏）。
    2.  定义导致这些损失的系统危害（例如，储罐压力超过安全限值）。
    3.  从危害中推导出系统必须遵守的**安全约束 (Safety Constraints)**（例如，“当压力高于阈值时，进气阀必须关闭”）。
    4.  识别违反这些约束的**不安全控制动作 (Unsafe Control Actions, UCAs)**（例如，“在压力过高时，控制器发出了‘打开阀门’的指令”）。
    5.  最后，分析导致这些UCA的**因果场景 (Causal Scenarios)**。这些原因可以是外部攻击，也可以是系统内部的设计缺陷、组件故障或不正确的模型假设。

STPA-Sec的强大之处在于它能够揭示系统性的、涌现出的脆弱性，而无需预先假设所有可能的攻击手段。它能自然地整合恶意和非恶意的致因，尤其擅长发现由组件间复杂交互导致的问题，例如[数字孪生](@entry_id:171650)模型与物理现实不一致所引发的危险。

#### 数字孪生：安防的赋能者

[数字孪生](@entry_id:171650)作为物理系统的超高保真计算副本，正成为CPS安防领域一个强大的工具。它不仅仅是一个仿真模型，而是通过数据同化与物理实体持续同步，这使其在威胁建模与防御中扮演了三个关键角色 ：

1.  **异常检测**：一个与物理系统同步良好的[数字孪生](@entry_id:171650)（例如，基于卡尔曼滤波器的状态估计器），其内部产生的**[新息序列](@entry_id:181232) (innovation sequence)**（即真实测量值与模型预测值之差 $\boldsymbol{\nu}_{k} = \mathbf{y}_{k} - \mathbf{C}\widehat{\mathbf{x}}_{k \mid k-1}$）在正常情况下应表现为白噪声。任何偏离[白噪声](@entry_id:145248)特性的统计异常（例如，均值变化、自相关性出现）都标志着系统行为与模型预测不符，可能是攻击的迹象。通过对[新息序列](@entry_id:181232)进行$\chi^2$检验等统计检验，可以构建灵敏的[异常检测](@entry_id:635137)器。

2.  **攻击场景探索与脆弱性分析**：数字孪生提供了一个完美的“沙箱”，可以在不危及真实物理系统的情况下，探索最危险的攻击场景。分析师可以将寻找“最坏情况下的[隐蔽](@entry_id:196364)攻击”形式化为一个约束最优控制问题：在满足[隐蔽](@entry_id:196364)性约束（例如，$\chi^2$统计量低于检测阈值）的前提下，寻找一组攻击信号，使得某个物理损害指标最大化。通过求解这个问题，可以量化系统的脆弱性，识别最薄弱的环节，并指导防御资源的部署（如强化哪些传感器）。

3.  **主动防御与攻击溯源**：[数字孪生](@entry_id:171650)还支持**主动防御 (active defense)**策略，例如**物理水印 (physical watermarking)**。其思想是，系统操作员向[控制信号](@entry_id:747841)中故意注入一个微小的、秘密的随机激励信号（水印），并在[数字孪生](@entry_id:171650)中 mirroring 这个信号。由于攻击者不知道这个秘密水印，他们伪造的传感器数据或执行器篡改将无法与水印的预期物理效应相匹配。通过在数字孪生中监测水印[信号与系统](@entry_id:274453)响应之间的预期相关性是否被破坏，可以检测到包括[重放攻击](@entry_id:1130869)在内的许多高级隐蔽攻击。

总之，从理解物理动态的基础原理，到形式化定义攻击者和攻击行为，再到运用系统性方法和[数字孪生](@entry_id:171650)等先进工具，CPS威胁建模正在发展成为一门严谨、深刻且至关重要的工程学科。