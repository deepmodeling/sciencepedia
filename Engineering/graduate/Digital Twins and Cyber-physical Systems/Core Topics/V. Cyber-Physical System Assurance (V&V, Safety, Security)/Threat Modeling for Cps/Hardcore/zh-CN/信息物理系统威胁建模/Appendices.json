{
    "hands_on_practices": [
        {
            "introduction": "精确的时间同步是许多信息物理系统的基础，它确保了传感器读数和控制指令的正确对齐。本练习将探讨攻击者如何利用时间同步协议来引发物理层故障。通过计算导致控制失调所需的最小对抗性时间偏移，您将对网络攻击如何直接危及物理操作获得定量的理解。",
            "id": "4250699",
            "problem": "一个信息物理系统 (CPS) 由一个作为时间主站的控制器节点和一个作为时间从站的传感器节点组成。该系统使用精确时间协议 (PTP) 或网络时间协议 (NTP) 来维持节点间的时间同步。假设在同步瞬间 $t=0$ 时，控制器时钟与传感器时钟之间的偏移已被协议的伺服机制校正为零。传感器的本地时钟相对于控制器的理想时间存在一个分数频率误差（时钟漂移）$\\delta$，其中 $\\delta$ 在一个区间内是微小且恒定的。根据定义，如果 $t$ 表示自上次同步以来真实流逝的时间，则传感器的时钟读数演变为 $\\tau(t) = (1+\\delta)t$，因此时间偏移累积为 $e(t) = \\tau(t) - t = \\delta t$。一个能够在 $t=0$ 时伪造 PTP 或 NTP 报文的敌手，可以在伺服校正后立即向传感器节点注入一个恒定的时间偏移 $e_{\\text{adv}}$，因此总偏移在下一次同步前变为 $e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$。\n\n控制器以采样周期 $T_{s}$ 执行离散时间控制律，如果 $|e_{\\text{tot}}(t)|  T_{s}/2$，则保证正确的采样对齐。当 $|e_{\\text{tot}}(t)| \\geq T_{s}/2$ 时，会发生未对齐，这导致控制器使用错误的采样索引，并引发一个有效的单步延迟误差。假设以下参数：\n- 采样周期 $T_{s} = 6\\,\\text{ms}$，\n- 重新同步间隔 $T_{r} = 30\\,\\text{s}$，\n- 恒定漂移幅度 $\\delta = 15\\,\\text{ppm}$，其中 $\\text{ppm}$ 表示百万分率，因此 $\\delta = 15 \\times 10^{-6}$。\n\n在这些假设下，并从上述时钟漂移和偏移累积的基本定义出发，计算能保证在时间 $t \\in [0, T_{r}]$ 内存在某个时刻使未对齐条件 $|e_{\\text{tot}}(t)| \\geq T_{s}/2$ 成立的最小敌手偏移 $e_{\\text{adv}}$。以毫秒为单位表示您的最终答案，并四舍五入到四位有效数字。",
            "solution": "用户要求我根据一套严格的格式和程序规则，验证并解决一个关于信息物理系统中时间同步的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 总时间偏移：$e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$\n- 分析的时间间隔：$t \\in [0, T_{r}]$\n- 未对齐条件：$|e_{\\text{tot}}(t)| \\geq T_{s}/2$\n- 采样周期：$T_{s} = 6\\,\\text{ms}$\n- 重新同步间隔：$T_{r} = 30\\,\\text{s}$\n- 恒定漂移幅度：$\\delta = 15\\,\\text{ppm}$，定义为 $\\delta = 15 \\times 10^{-6}$\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于一个标准时钟漂移线性模型，$e(t) = \\delta t$，这是研究像 PTP 和 NTP 这样的时钟同步协议时的基本概念。所提供的参数对于工业控制系统是符合实际的。该问题在科学上是合理的。\n- **定义明确：** 该问题提供了所有必要的参数（$T_s$、$T_r$、$\\delta$）以及一个明确的目标：计算能保证在给定区间内满足特定条件的最小敌手偏移 $e_{\\text{adv}}$。这是一个定义明确的数学问题，在对“最小”进行合理解释的情况下，它有一个唯一的解。\n- **目标明确：** 该问题使用精确、正式的语言陈述，没有主观或模糊的术语。\n- **完整性与一致性：** 该问题是自洽的，没有内部矛盾。\n- **真实性：** 在真实世界的信息物理系统背景下，该场景和参数值是合理的。\n\n**步骤 3：结论与行动**\n根据验证标准，该问题被判定为 **有效**。我将继续提供完整解答。\n\n### 解答\n\n目标是找到最小的敌手偏移 $e_{\\text{adv}}$，该偏移能保证在时间间隔 $t \\in [0, T_{r}]$ 内发生未对齐。当总时间偏移 $e_{\\text{tot}}(t)$ 满足条件 $|e_{\\text{tot}}(t)| \\geq \\frac{T_{s}}{2}$ 时，即发生未对齐。\n\n总偏移由时间的线性函数给出：\n$$e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$$\n其中 $e_{\\text{adv}}$ 是在 $t=0$ 时注入的恒定敌手偏移，而 $\\delta t$ 是由于时钟漂移累积的偏移。\n\n发生未对齐的条件是，在区间 $[0, T_{r}]$ 中至少存在一个时间点 $t$ 使得：\n$$|e_{\\text{adv}} + \\delta t| \\geq \\frac{T_{s}}{2}$$\n\n反之，为了让系统在整个区间内保持正确同步，必须对所有 $t \\in [0, T_{r}]$ 满足条件 $|e_{\\text{adv}} + \\delta t|  \\frac{T_{s}}{2}$。这可以写成：\n$$-\\frac{T_{s}}{2}  e_{\\text{adv}} + \\delta t  \\frac{T_{s}}{2}$$\n\n问题给出的漂移参数 $\\delta = 15 \\times 10^{-6}$ 是一个正常数。因此，函数 $e_{\\text{tot}}(t) = e_{\\text{adv}} + \\delta t$ 随时间单调递增。对于闭区间上的单调函数，其最小值和最大值出现在区间的端点处。\n\n为确保 $e_{\\text{tot}}(t)$ 在整个区间 $t \\in [0, T_{r}]$ 内保持在安全边界 $(-\\frac{T_{s}}{2}, \\frac{T_{s}}{2})$ 内，我们只需要检查端点 $t=0$ 和 $t=T_{r}$ 处的值。\n\n1.  在 $t=0$ 时，我们要求：\n    $$-\\frac{T_{s}}{2}  e_{\\text{tot}}(0)  \\frac{T_{s}}{2} \\implies -\\frac{T_{s}}{2}  e_{\\text{adv}}  \\frac{T_{s}}{2}$$\n\n2.  在 $t=T_{r}$ 时，我们要求：\n    $$-\\frac{T_{s}}{2}  e_{\\text{tot}}(T_{r})  \\frac{T_{s}}{2} \\implies -\\frac{T_{s}}{2}  e_{\\text{adv}} + \\delta T_{r}  \\frac{T_{s}}{2}$$\n    第二个不等式可以重新整理，以找到对 $e_{\\text{adv}}$ 的约束：\n    $$-\\frac{T_{s}}{2} - \\delta T_{r}  e_{\\text{adv}}  \\frac{T_{s}}{2} - \\delta T_{r}$$\n\n为了使系统在所有 $t \\in [0, T_{r}]$ 时间内都是安全的，$e_{\\text{adv}}$ 必须同时满足这两组不等式。$e_{\\text{adv}}$ 所需的范围是这两个区间的交集：\n- 下界：$\\max(-\\frac{T_{s}}{2}, -\\frac{T_{s}}{2} - \\delta T_{r}) = -\\frac{T_{s}}{2}$ (因为 $\\delta T_{r} > 0$)\n- 上界：$\\min(\\frac{T_{s}}{2}, \\frac{T_{s}}{2} - \\delta T_{r}) = \\frac{T_{s}}{2} - \\delta T_{r}$ (因为 $\\delta T_{r} > 0$)\n\n因此，不保证发生未对齐的“安全”敌手偏移的范围是：\n$$-\\frac{T_{s}}{2}  e_{\\text{adv}}  \\frac{T_{s}}{2} - \\delta T_{r}$$\n\n如果 $e_{\\text{adv}}$ 位于此闭区间之外，即 $e_{\\text{adv}} \\geq \\frac{T_s}{2} - \\delta T_r$ 或 $e_{\\text{adv}} \\leq -\\frac{T_s}{2}$，则保证会发生未对齐。将导致未对齐的边界值为：\n$$e_{\\text{adv}} = -\\frac{T_{s}}{2} \\quad \\text{或} \\quad e_{\\text{adv}} = \\frac{T_{s}}{2} - \\delta T_{r}$$\n\n问题要求找到“最小的敌手偏移 $e_{\\text{adv}}$”。在攻击的背景下，“最小”通常指具有最小绝对值 $|e_{\\text{adv}}|$ 的值，因为这代表最隐蔽或最高效的攻击。因此，我们必须比较两个边界偏移的绝对值。\n\n让我们计算这些边界的数值。\n给定参数为：\n- $T_{s} = 6\\,\\text{ms} = 6 \\times 10^{-3}\\,\\text{s}$\n- $T_{r} = 30\\,\\text{s}$\n- $\\delta = 15 \\times 10^{-6}$\n\n首先，我们计算阈值 $\\frac{T_s}{2}$：\n$$\\frac{T_{s}}{2} = \\frac{6 \\times 10^{-3}\\,\\text{s}}{2} = 3 \\times 10^{-3}\\,\\text{s} = 3\\,\\text{ms}$$\n接下来，我们计算在区间 $T_r$ 内累积的总漂移：\n$$\\delta T_{r} = (15 \\times 10^{-6}) \\times (30\\,\\text{s}) = 450 \\times 10^{-6}\\,\\text{s} = 0.45 \\times 10^{-3}\\,\\text{s} = 0.45\\,\\text{ms}$$\n\n现在我们可以确定 $e_{\\text{adv}}$ 的两个边界值：\n1.  负边界是 $e_{\\text{adv},1} = -\\frac{T_{s}}{2} = -3\\,\\text{ms}$。\n2.  正边界是 $e_{\\text{adv},2} = \\frac{T_{s}}{2} - \\delta T_{r} = 3\\,\\text{ms} - 0.45\\,\\text{ms} = 2.55\\,\\text{ms}$。\n\n为了找到所需的最小偏移，我们比较这两个值的绝对值：\n$$|e_{\\text{adv},1}| = |-3\\,\\text{ms}| = 3\\,\\text{ms}$$\n$$|e_{\\text{adv},2}| = |2.55\\,\\text{ms}| = 2.55\\,\\text{ms}$$\n\n最小绝对值为 $2.55\\,\\text{ms}$，对应的敌手偏移为 $e_{\\text{adv}} = 2.55\\,\\text{ms}$。这是敌手为保证发生未对齐（特别是在 $t=T_{r}$ 时）而可以注入的最小偏移。\n\n问题要求答案以毫秒表示，并四舍五入到四位有效数字。根据给定参数计算出的值 $2.55\\,\\text{ms}$ 是精确的。为了用四位有效数字表示，我们将其写作 $2.550\\,\\text{ms}$。",
            "answer": "$$\\boxed{2.550}$$"
        },
        {
            "introduction": "保护信息物理系统通常涉及在安全性与性能之间进行权衡，本练习将深入探讨这一概念。增加如加密等密码学保护措施会引入通信延迟，这可能威胁到时间敏感型控制回路的稳定性。本练习将指导您计算总延迟开销，并运用控制理论原理来确定系统是否保持稳定，从而量化关键的“稳定性裕度”。",
            "id": "4250661",
            "problem": "一个网络化的信息物理系统 (CPS) 使用高级加密标准伽罗瓦/计数器模式 (AES-GCM) 进行安全保护，这在每个通信跳上引入了密码学处理延迟。一个数字孪生 (DT) 监控控制回路的性能，并且必须验证增加的密码学延迟是否保持闭环稳定性。被控对象被建模为一个连续时间线性时不变系统，其传递函数为 $G(s) = \\frac{1}{(s+1)(s+2)}$，控制器是一个比例-积分补偿器 $C(s) = K \\frac{s+3}{s}$，其中 $K = 1$。开环传递函数为 $L(s) = C(s)G(s)$。基线端到端延迟（不含密码学处理）包括传感器到控制器的网络传播延迟 $d_{1} = 12 \\text{ ms}$，控制器到执行器的网络传播延迟 $d_{2} = 8 \\text{ ms}$，调度器引起的排队/抖动 $d_{q} = 5 \\text{ ms}$，以及控制器计算时间 $d_{c} = 4 \\text{ ms}$。密码学开销来自于每个周期的两次加密和两次解密（传感器加密，控制器解密；控制器加密，执行器解密）。每次 AES-GCM 操作具有固定的每包开销 $\\alpha = 20 \\mu\\text{s}$ 和对于包长为 $n = 512 \\text{ bytes}$ 的每字节成本 $\\beta = 0.3125 \\mu\\text{s}/\\text{byte}$。所有角度必须以弧度为单位处理。\n\n任务：\n- 计算包含密码学开销的总端到端延迟，将每次 AES-GCM 操作视为一个串联的附加处理延迟。\n- 使用针对线性时不变回路中时间延迟的基本频域稳定性概念，计算时间延迟裕度，并评估增加的密码学延迟是否保持了闭环稳定性。\n- 报告稳定性裕量 $s = \\tau_{\\text{dm}} - \\tau_{\\text{total}}$，其中 $\\tau_{\\text{dm}}$ 是时间延迟裕度，$\\tau_{\\text{total}}$ 是包含密码学处理的总回路延迟。\n\n以 $\\text{ms}$ 为单位表示最终的稳定性裕量 $s$，并将您的答案四舍五入到四位有效数字。",
            "solution": "我们从线性时不变反馈系统的基本控制原理开始。开环传递函数为 $L(s) = C(s)G(s)$，频域稳定性裕度在由 $|L(j\\omega_{c})| = 1$ 定义的增益交越频率 $\\omega_{c}$ 处进行评估。回路中的纯时间延迟 $\\tau$ 在频率 $\\omega$ 处会产生一个 $-\\omega \\tau$ 的额外相位滞后。令 $\\phi_{m}$ 表示无延迟回路的相位裕度。奈奎斯特稳定性判据意味着，如果在 $\\omega_{c}$ 处的附加时间延迟没有耗尽相位裕度，则闭环稳定性得以保持，这得出了经过充分检验的延迟裕度关系\n$$\n\\tau_{\\text{dm}} = \\frac{\\phi_{m}}{\\omega_{c}},\n$$\n该关系通过要求附加相位滞后 $\\omega_{c}\\tau$ 严格小于 $\\phi_{m}$ 得到。我们从 $L(s)$ 计算 $\\omega_{c}$ 和 $\\phi_{m}$，然后将 $\\tau_{\\text{dm}}$ 与包含基线延迟和密码学处理的总回路延迟 $\\tau_{\\text{total}}$ 进行比较。\n\n步骤1：开环传递函数和增益交越频率。被控对象和控制器为\n$$\nG(s) = \\frac{1}{(s+1)(s+2)}, \\quad C(s) = K\\frac{s+3}{s}, \\quad K=1,\n$$\n因此\n$$\nL(s) = \\frac{s+3}{s(s+1)(s+2)}.\n$$\n在频率 $\\omega$ 处的幅值为\n$$\n|L(j\\omega)| = \\frac{|j\\omega+3|}{|j\\omega|\\,|j\\omega+1|\\,|j\\omega+2|} = \\frac{\\sqrt{\\omega^{2}+9}}{\\omega\\,\\sqrt{\\omega^{2}+1}\\,\\sqrt{\\omega^{2}+4}}.\n$$\n当 $\\omega = 1$ 时，我们有\n$$\n|L(j\\cdot 1)| = \\frac{\\sqrt{1+9}}{1\\cdot \\sqrt{1+1}\\cdot \\sqrt{1+4}} = \\frac{\\sqrt{10}}{\\sqrt{2}\\sqrt{5}} = \\frac{\\sqrt{10}}{\\sqrt{10}} = 1,\n$$\n因此增益交越频率为 $\\omega_{c} = 1$。\n\n步骤2：相位裕度。$L(j\\omega)$ 的相位为\n$$\n\\arg L(j\\omega) = \\arg(j\\omega+3) - \\arg(j\\omega) - \\arg(j\\omega+1) - \\arg(j\\omega+2).\n$$\n当 $\\omega = 1$ 时，上式变为\n$$\n\\arg L(j\\cdot 1) = \\arctan\\!\\left(\\frac{1}{3}\\right) - \\frac{\\pi}{2} - \\arctan(1) - \\arctan\\!\\left(\\frac{1}{2}\\right).\n$$\n因此相位裕度为\n$$\n\\phi_{m} = \\pi + \\arg L(j\\omega_{c}) = \\pi + \\left[\\arctan\\!\\left(\\frac{1}{3}\\right) - \\frac{\\pi}{2} - \\frac{\\pi}{4} - \\arctan\\!\\left(\\frac{1}{2}\\right)\\right].\n$$\n先符号计算后数值计算反正切项（在最终评估前保持常数为符号形式），\n$$\n\\arctan\\!\\left(\\frac{1}{3}\\right) \\approx 0.3217505543966422,\\quad \\arctan(1) = \\frac{\\pi}{4} \\approx 0.7853981633974483,\n$$\n$$\n\\arctan\\!\\left(\\frac{1}{2}\\right) \\approx 0.4636476090008061,\\quad \\frac{\\pi}{2} \\approx 1.5707963267948966,\\quad \\pi \\approx 3.141592653589793.\n$$\n因此，\n$$\n\\arg L(j\\cdot 1) \\approx 0.3217505543966422 - 1.5707963267948966 - 0.7853981633974483 - 0.4636476090008061 \\approx -2.4980915447965087,\n$$\n且\n$$\n\\phi_{m} \\approx 3.141592653589793 - 2.4980915447965087 \\approx 0.6435011087932844.\n$$\n因此延迟裕度为\n$$\n\\tau_{\\text{dm}} = \\frac{\\phi_{m}}{\\omega_{c}} = \\frac{0.6435011087932844}{1} \\approx 0.6435011087932844\\ \\text{s}.\n$$\n\n步骤3：包含密码学开销的总端到端延迟。基线延迟是以下各项之和\n$$\n\\tau_{\\text{base}} = d_{1} + d_{2} + d_{q} + d_{c} = 12\\ \\text{ms} + 8\\ \\text{ms} + 5\\ \\text{ms} + 4\\ \\text{ms} = 29\\ \\text{ms} = 0.029\\ \\text{s}.\n$$\n每次 AES-GCM 操作的处理时间为\n$$\nt_{\\text{proc}} = \\alpha + \\beta n = 20\\ \\mu\\text{s} + (0.3125\\ \\mu\\text{s}/\\text{byte})\\cdot 512\\ \\text{bytes} = 20\\ \\mu\\text{s} + 160\\ \\mu\\text{s} = 180\\ \\mu\\text{s} = 0.00018\\ \\text{s}.\n$$\n每个周期有四次操作（传感器加密，控制器解密，控制器加密，执行器解密），因此密码学总延迟为\n$$\n\\tau_{\\text{enc}} = 4\\,t_{\\text{proc}} = 4 \\cdot 0.00018\\ \\text{s} = 0.00072\\ \\text{s}.\n$$\n因此，包含密码学处理的总回路延迟为\n$$\n\\tau_{\\text{total}} = \\tau_{\\text{base}} + \\tau_{\\text{enc}} = 0.029\\ \\text{s} + 0.00072\\ \\text{s} = 0.02972\\ \\text{s}.\n$$\n\n步骤4：稳定性裕量和验证。稳定性裕量定义为\n$$\ns = \\tau_{\\text{dm}} - \\tau_{\\text{total}}.\n$$\n代入计算出的值，\n$$\ns \\approx 0.6435011087932844\\ \\text{s} - 0.02972\\ \\text{s} = 0.6137811087932844\\ \\text{s}.\n$$\n转换为毫秒，\n$$\ns \\approx 0.6137811087932844\\ \\text{s} \\times 1000\\ \\frac{\\text{ms}}{\\text{s}} = 613.7811087932844\\ \\text{ms}.\n$$\n四舍五入到四位有效数字，稳定性裕量为\n$$\ns \\approx 613.8\\ \\text{ms}.\n$$\n因为 $s > 0$，所以在时间延迟裕度分析下，增加的密码学延迟没有违反闭环稳定性判据。所要求的最终答案是四舍五入后以 $\\text{ms}$ 为单位的稳定性裕量。",
            "answer": "$$\\boxed{613.8}$$"
        },
        {
            "introduction": "对复杂系统进行有效防御需要战略性思维，尤其是在资源有限的情况下。最后一个练习引入了博弈论方法，来为信息物理系统防御者与理性攻击者之间的冲突建模。通过构建并求解一个斯塔克尔伯格博弈（Stackelberg game）模型，您将学习如何确定监控资源的最优分配，以最小化攻击所造成的最大潜在损失。",
            "id": "4250667",
            "problem": "一个信息物理系统 (CPS) 的数字孪生 (DT) 维护着子系统状态的实时估计，并分配计算监控资源以检测对三个子系统的攻击：执行器网络 ($i=1$)、传感器总线 ($i=2$) 和控制逻辑 ($i=3$)。设防御方为子系统 $i$ 分配一个非负的监控强度 $x_i$，产生的资源成本与 $x_i$ 成正比。防御方的总资源预算为 $b$，且必须满足 $\\sum_{i=1}^{3} c_i x_i \\leq b$ 和 $x_i \\geq 0$。\n\n假设以下基本前提：\n- 攻击方在观察到防御方的分配 $(x_1,x_2,x_3)$ 后行动，并选择一个子系统 $i$ 进行攻击。\n- 对于每个子系统 $i$，在监控强度 $x_i$ 下，由 DT 引发的检测概率服从标准饱和定律 $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$，其中 $\\alpha_i  0$ 表示每单位资源的检测效能。\n- 如果对子系统 $i$ 的攻击未被检测到，攻击方获得期望收益 $D_i$（攻击方的收益等于防御方的损失）。如果攻击被检测到，攻击方将遭受一个负效用 $K  0$（例如，资源消耗失败、归因风险或反制响应），并且不获得 $D_i$。因此，攻击方在子系统 $i$ 上的期望效用是在检测下的期望值，\n$$\nU_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K.\n$$\n- 攻击方通过选择使 $U_i(x_i)$ 最大化的子系统 $i$ 来做出最佳响应。防御方是保守的，寻求最小化所有子系统中最坏情况下的攻击方效用，即在预算和非负性约束条件下，最小化 $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$。\n\n任务：\n1. 从上述定义出发，将双层 Stackelberg 攻防模型形式化为防御方面临的单层优化问题，目标函数仅用 $(x_1,x_2,x_3)$ 和给定参数表示。\n2. 在最优解中所有三个子系统都获得正分配的情况下，从第一性原理出发，不使用简便公式，推导刻画最优分配 $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ 的最优性条件。\n3. 对于参数值 $c_1 = c_2 = c_3 = 1$，$\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$，$K = 40$，$(D_1,D_2,D_3) = (60,80,100)$ 和预算 $b = 3 \\ln(2)$，计算防御方的最优分配向量 $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ 的精确形式（不要四舍五入）。将分配表示为无量纲的资源单位。最终答案必须使用 $\\mathrm{pmatrix}$ 环境写成一个单行向量。",
            "solution": "用户提供的问题陈述成功通过了验证协议。它在博弈论和优化方面有科学依据，是适定的、客观的，并包含了严谨求解所需的所有必要信息。因此，我们可以继续。\n\n该问题描述了一个 Stackelberg 博弈，其中防御方（领导者）分配监控资源，攻击方（跟随者）选择一个子系统作为攻击目标。防御方的目标是最小化攻击方的最大可能效用。我们将按顺序完成这三个任务。\n\n### 任务 1：双层模型的形式化\n\n该问题是一个双层优化问题，但由于跟随者（攻击方）的问题只是从一组值中选择最大值，因此可以将其简化为防御方的单层极小化极大问题。\n\n首先，我们用防御方的分配 $x_i$ 来表示攻击方在子系统 $i$ 上的效用 $U_i(x_i)$。检测概率由 $p_i(x_i) = 1 - \\exp(-\\alpha_i x_i)$ 给出。攻击方的效用为 $U_i(x_i) = (1 - p_i(x_i)) D_i - p_i(x_i) K$。\n代入 $p_i(x_i)$ 的表达式：\n$$\nU_i(x_i) = \\Big(1 - \\big(1 - \\exp(-\\alpha_i x_i)\\big)\\Big) D_i - \\big(1 - \\exp(-\\alpha_i x_i)\\big) K\n$$\n$$\nU_i(x_i) = \\exp(-\\alpha_i x_i) D_i - K + K \\exp(-\\alpha_i x_i)\n$$\n$$\nU_i(x_i) = (D_i + K) \\exp(-\\alpha_i x_i) - K\n$$\n攻击方在观察到防御方的分配 $(x_1, x_2, x_3)$ 后，将选择使该效用最大化的子系统 $i$。因此，攻击方的最佳响应效用为 $\\max_{i \\in \\{1,2,3\\}} U_i(x_i)$。\n\n防御方的目标是选择分配 $(x_1, x_2, x_3)$ 来最小化这个最大效用，同时满足预算和非负性约束。防御方的优化问题是：\n$$\n\\min_{x_1, x_2, x_3} \\left( \\max_{i \\in \\{1,2,3\\}} \\Big\\{ (D_i + K) \\exp(-\\alpha_i x_i) - K \\Big\\} \\right)\n$$\n约束条件为：\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\n这是防御方问题的单层表述。为了使其更适用于标准优化技术，我们可以使用上镜图表述将这个极小化极大问题转化为一个约束优化问题。我们引入一个辅助变量 $U$，它将代表最大效用。\n该问题等价于：\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\n约束条件为：\n$$\nU_i(x_i) \\leq U \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i \\leq b\n$$\n$$\nx_i \\geq 0 \\quad \\text{for } i \\in \\{1,2,3\\}\n$$\n代入 $U_i(x_i)$ 的表达式，单层优化问题为：\n$$\n\\min_{x_1, x_2, x_3, U} U\n$$\n约束条件为：\n$$\n(D_i + K) \\exp(-\\alpha_i x_i) - K \\leq U \\quad \\text{for } i=1,2,3\n$$\n$$\n\\sum_{i=1}^{3} c_i x_i - b \\leq 0\n$$\n$$\n-x_i \\leq 0 \\quad \\text{for } i=1,2,3\n$$\n\n### 任务 2：最优性条件的推导\n\n我们寻求推导在最优分配为内点解（即对所有 $i \\in \\{1,2,3\\}$ 都有 $x_i^{\\star}  0$）情况下的最优性条件。我们使用上述约束优化问题的 Karush-Kuhn-Tucker (KKT) 条件。\n\n拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(x_1, x_2, x_3, U, \\lambda_1, \\lambda_2, \\lambda_3, \\mu, \\nu_1, \\nu_2, \\nu_3) = U + \\sum_{i=1}^{3} \\lambda_i \\left( (D_i + K) \\exp(-\\alpha_i x_i) - K - U \\right) + \\mu \\left( \\sum_{i=1}^{3} c_i x_i - b \\right) - \\sum_{i=1}^{3} \\nu_i x_i\n$$\n其中 $\\lambda_i, \\mu, \\nu_i$ 是非负的拉格朗日乘子。\n\n对于最优点 $(x^\\star, U^\\star, \\lambda^\\star, \\mu^\\star, \\nu^\\star)$ 的 KKT 条件是：\n1.  **驻定性：** 拉格朗日函数相对于原始变量的梯度必须为零。\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial U} = 1 - \\sum_{i=1}^{3} \\lambda_i = 0 \\implies \\sum_{i=1}^{3} \\lambda_i = 1$。\n    -   $\\frac{\\partial \\mathcal{L}}{\\partial x_i} = \\lambda_i (D_i + K) (-\\alpha_i) \\exp(-\\alpha_i x_i) + \\mu c_i - \\nu_i = 0$ 对 $i=1,2,3$ 成立。\n\n2.  **原始可行性：** 必须满足约束条件。\n    -   $(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K \\leq U^{\\star}$ 对 $i=1,2,3$ 成立。\n    -   $\\sum_{i=1}^{3} c_i x_i^{\\star} \\leq b$。\n    -   $x_i^{\\star} \\geq 0$ 对 $i=1,2,3$ 成立。\n\n3.  **对偶可行性：** $\\lambda_i \\geq 0$，$\\mu \\geq 0$，$\\nu_i \\geq 0$ 对 $i=1,2,3$ 成立。\n\n4.  **互补松弛性：**\n    -   $\\lambda_i ((D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star}) = 0$ 对 $i=1,2,3$ 成立。\n    -   $\\mu (\\sum_{i=1}^{3} c_i x_i^{\\star} - b) = 0$。\n    -   $\\nu_i x_i^{\\star} = 0$ 对 $i=1,2,3$ 成立。\n\n我们正在分析内点解的情况，即对所有 $i$ 都有 $x_i^{\\star}  0$。根据互补松弛性，这意味着对所有 $i$ 都有 $\\nu_i = 0$。$x_i$ 的驻定性条件简化为：\n$$\n-\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) + \\mu c_i = 0\n$$\n$$\n\\lambda_i \\alpha_i (D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = \\mu c_i\n$$\n由于 $\\alpha_i  0$，$D_i+K  0$，$c_i  0$ 且 $\\exp(-\\alpha_i x_i^{\\star})  0$，等式右侧的 $\\mu c_i$ 必须为正，除非 $\\lambda_i=0$。如果 $\\mu=0$，那么对所有 $i$ 都有 $\\lambda_i=0$，这与 $\\sum \\lambda_i = 1$ 相矛盾。因此，我们必须有 $\\mu  0$。\n\n由于 $\\mu  0$，预算约束的互补松弛性意味着该约束必须是紧的：\n$$\n\\sum_{i=1}^{3} c_i x_i^{\\star} = b\n$$\n此外，由于 $\\mu  0$ 且 $c_i  0$，项 $\\mu c_i$ 是严格为正的。这意味着对于每个 $i$，$\\lambda_i$ 也必须是严格为正的，即 $\\lambda_i  0$。如果对于某个 $j$ 有 $\\lambda_j = 0$，那么 $\\mu c_j=0$，这是一个矛盾。\n\n由于对所有 $i$ 都有 $\\lambda_i  0$，效用约束的互补松弛性意味着它们必须全部是紧的：\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) - K - U^{\\star} = 0 \\quad \\text{for } i=1,2,3\n$$\n这意味着在最优点，攻击方在所有三个子系统上的效用是相同的：\n$$\n(D_1 + K) \\exp(-\\alpha_1 x_1^{\\star}) - K = (D_2 + K) \\exp(-\\alpha_2 x_2^{\\star}) - K = (D_3 + K) \\exp(-\\alpha_3 x_3^{\\star}) - K\n$$\n这是此类安全博弈中的“效用均等”原则。\n\n因此，刻画内点解 $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ 的最优性条件是以下方程组：\n1.  **攻击方效用相等：** $(D_1+K)\\exp(-\\alpha_1 x_1^{\\star}) = (D_2+K)\\exp(-\\alpha_2 x_2^{\\star}) = (D_3+K)\\exp(-\\alpha_3 x_3^{\\star})$。\n2.  **预算约束紧束：** $\\sum_{i=1}^{3} c_i x_i^{\\star} = b$。\n\n这些条件构成了一个可以求解 $(x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$ 的方程组。设第一个条件中的公共值为 $C_U = U^{\\star}+K$。那么对于每个 $i$：\n$$\n(D_i + K) \\exp(-\\alpha_i x_i^{\\star}) = C_U \\implies x_i^{\\star} = \\frac{1}{\\alpha_i} \\ln\\left(\\frac{D_i+K}{C_U}\\right)\n$$\n将这些代入预算约束中可以确定 $C_U$。\n\n### 任务 3：最优分配的计算\n\n给定参数：$c_1 = c_2 = c_3 = 1$，$\\alpha_1 = \\alpha_2 = \\alpha_3 = 1$，$K = 40$，$(D_1,D_2,D_3) = (60,80,100)$，以及预算 $b = 3 \\ln(2)$。\n\n我们假设一个内点解，并应用上面推导出的最优性条件。\n这些参数简化了条件：\n1.  $(D_1+K)\\exp(-x_1^{\\star}) = (D_2+K)\\exp(-x_2^{\\star}) = (D_3+K)\\exp(-x_3^{\\star})$。\n2.  $x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = b$。\n\n我们来计算 $D_i+K$ 的值：\n$D_1 + K = 60 + 40 = 100$\n$D_2 + K = 80 + 40 = 120$\n$D_3 + K = 100 + 40 = 140$\n\n设 $C_U_s = (D_i+K)\\exp(-x_i^{\\star})$ 为公共值。\n由此，我们可以用 $C_U_s$ 表示每个 $x_i^{\\star}$：\n$x_1^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right)$\n$x_2^{\\star} = \\ln\\left(\\frac{120}{C_U_s}\\right)$\n$x_3^{\\star} = \\ln\\left(\\frac{140}{C_U_s}\\right)$\n\n将这些代入预算约束：\n$x_1^{\\star} + x_2^{\\star} + x_3^{\\star} = \\ln\\left(\\frac{100}{C_U_s}\\right) + \\ln\\left(\\frac{120}{C_U_s}\\right) + \\ln\\left(\\frac{140}{C_U_s}\\right) = b$\n使用对数性质：\n$\\ln(100) - \\ln(C_U_s) + \\ln(120) - \\ln(C_U_s) + \\ln(140) - \\ln(C_U_s) = b$\n$\\ln(100 \\times 120 \\times 140) - 3\\ln(C_U_s) = b$\n$\\ln(1680000) - 3\\ln(C_U_s) = 3\\ln(2)$\n$3\\ln(C_U_s) = \\ln(1680000) - 3\\ln(2) = \\ln(1680000) - \\ln(2^3) = \\ln(1680000) - \\ln(8)$\n$3\\ln(C_U_s) = \\ln\\left(\\frac{1680000}{8}\\right) = \\ln(210000)$\n$\\ln(C_U_s) = \\frac{1}{3}\\ln(210000) = \\ln((210000)^{1/3})$\n$C_U_s = (210000)^{1/3}$\n\n现在我们可以计算各个分配 $x_i^{\\star}$：\n$x_1^{\\star} = \\ln(100) - \\ln(C_U_s) = \\ln(100) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(100) - \\ln(210000)}{3} = \\frac{\\ln(100^3) - \\ln(210000)}{3}$\n$x_1^{\\star} = \\frac{\\ln(1000000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1000000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{100}{21}\\right)$\n\n$x_2^{\\star} = \\ln(120) - \\ln(C_U_s) = \\ln(120) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(120) - \\ln(210000)}{3} = \\frac{\\ln(120^3) - \\ln(210000)}{3}$\n$x_2^{\\star} = \\frac{\\ln(1728000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{1728000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{1728}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{288}{35}\\right)$\n\n$x_3^{\\star} = \\ln(140) - \\ln(C_U_s) = \\ln(140) - \\frac{1}{3}\\ln(210000) = \\frac{3\\ln(140) - \\ln(210000)}{3} = \\frac{\\ln(140^3) - \\ln(210000)}{3}$\n$x_3^{\\star} = \\frac{\\ln(2744000) - \\ln(210000)}{3} = \\frac{1}{3}\\ln\\left(\\frac{2744000}{210000}\\right) = \\frac{1}{3}\\ln\\left(\\frac{2744}{210}\\right) = \\frac{1}{3}\\ln\\left(\\frac{196}{15}\\right)$\n\n由于 $\\frac{100}{21} > 1$、$\\frac{288}{35} > 1$ 和 $\\frac{196}{15} > 1$，所有的 $x_i^{\\star}$ 都是正数，这证实了我们关于内点解的工作假设。最优分配为 $x^{\\star} = (x_1^{\\star}, x_2^{\\star}, x_3^{\\star})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} \\ln\\left(\\frac{100}{21}\\right)  \\frac{1}{3} \\ln\\left(\\frac{288}{35}\\right)  \\frac{1}{3} \\ln\\left(\\frac{196}{15}\\right) \\end{pmatrix}}\n$$"
        }
    ]
}