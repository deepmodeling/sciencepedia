{
    "hands_on_practices": [
        {
            "introduction": "How can we be sure that the code for a critical cyber-physical system has not been tampered with? One of the most fundamental controls in a secure software supply chain is the mandatory peer review of all changes. This exercise  moves beyond the qualitative benefit of \"more eyes\" on code and asks you to build a quantitative model. By applying basic probability theory, you will derive the exact relationship between the number of independent reviewers and the likelihood of catching a malicious modification, a vital skill for designing and justifying security processes.",
            "id": "4248745",
            "problem": "A manufacturer of cyber-physical systems maintains a digital twin of its software build and deployment pipeline to monitor for integrity violations in the hardware and software supply chain. Build scripts are treated as critical control artifacts. The organization mandates code reviews with $r$ distinct reviewers for every build script change. Due to training, tool support, and Separation of Duties (SoD), each reviewer independently detects a malicious modification with probability $q$. Using only the axioms of probability, the complement rule, and the definition of independence, derive an analytic expression for the probability $P_{\\text{detect}}$ that at least one reviewer detects a malicious change during a single review cycle. Then evaluate the expression for $q = 0.37$ and $r = 5$. Round your numerical answer to four significant figures and express it as a decimal without a percentage sign.",
            "solution": "The user has provided a problem to be solved. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- The number of distinct reviewers is $r$.\n- Each reviewer independently detects a malicious modification with probability $q$.\n- The goal is to derive an analytic expression for $P_{\\text{detect}}$, the probability that at least one reviewer detects a malicious change.\n- The derivation must use only the axioms of probability, the complement rule, and the definition of independence.\n- The expression is to be evaluated for $q = 0.37$ and $r = 5$.\n- The final numerical answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the established criteria.\n\n- **Scientifically Grounded**: The problem is a standard application of elementary probability theory. The context of supply chain security, code reviews, and reviewer-based detection is a realistic and established concept in cybersecurity and software engineering. The problem does not violate any scientific or mathematical principles. It is scientifically sound.\n- **Well-Posed**: The problem is clearly stated and provides all necessary variables ($r$, $q$) and constraints (use of an specific derivation path) to arrive at a unique solution. The objective is unambiguous.\n- **Objective**: The language is precise and free of subjective or opinion-based claims. All terms are defined within the context of probability theory.\n\n### Step 3: Verdict and Action\nThe problem is well-posed, scientifically grounded, and objective. It is deemed **valid**. I will proceed with the solution.\n\nThe problem requires the derivation of the probability $P_{\\text{detect}}$ that at least one reviewer detects a malicious change. Let us define the events for our analysis. Let $D_i$ be the event that reviewer $i$ detects the malicious change, for $i \\in \\{1, 2, \\dots, r\\}$.\n\nFrom the problem statement, we are given that the probability of any single reviewer detecting a change is $q$.\n$$\nP(D_i) = q \\quad \\forall i \\in \\{1, 2, \\dots, r\\}\n$$\nThe problem also states that the reviewers' detections are independent events.\n\nThe event that at least one reviewer detects the change is the union of the individual detection events:\n$$\nE_{\\text{detect}} = D_1 \\cup D_2 \\cup \\dots \\cup D_r\n$$\nThe probability we seek is $P_{\\text{detect}} = P(E_{\\text{detect}})$.\n\nThe problem explicitly instructs to use the complement rule. Let us define the complement event, $E_{\\text{detect}}^c$, which is the event that *no* reviewer detects the malicious change. According to the axioms of probability, the probability of an event and its complement sum to $1$.\n$$\nP(E_{\\text{detect}}) = 1 - P(E_{\\text{detect}}^c)\n$$\nThe event $E_{\\text{detect}}^c$ occurs if and only if reviewer $1$ does not detect the change, AND reviewer $2$ does not detect the change, ..., AND reviewer $r$ does not detect the change. This can be written as the intersection of the complement of each individual detection event, $D_i^c$.\n$$\nE_{\\text{detect}}^c = D_1^c \\cap D_2^c \\cap \\dots \\cap D_r^c\n$$\nUsing the complement rule for each individual event $D_i$, the probability that reviewer $i$ does *not* detect the change is:\n$$\nP(D_i^c) = 1 - P(D_i) = 1 - q\n$$\nSince the events $D_i$ are stipulated to be independent, their complements $D_i^c$ are also independent. By the definition of independence for multiple events, the probability of their intersection is the product of their individual probabilities:\n$$\nP(E_{\\text{detect}}^c) = P(D_1^c \\cap D_2^c \\cap \\dots \\cap D_r^c) = P(D_1^c) \\times P(D_2^c) \\times \\dots \\times P(D_r^c)\n$$\nSubstituting $P(D_i^c) = 1 - q$ for each of the $r$ terms in the product, we obtain:\n$$\nP(E_{\\text{detect}}^c) = (1 - q) \\times (1 - q) \\times \\dots \\times (1 - q) \\quad (r \\text{ times})\n$$\n$$\nP(E_{\\text{detect}}^c) = (1 - q)^r\n$$\nNow, we substitute this result back into the expression for $P_{\\text{detect}}$:\n$$\nP_{\\text{detect}} = 1 - P(E_{\\text{detect}}^c) = 1 - (1 - q)^r\n$$\nThis is the required analytic expression for the probability that at least one reviewer detects a malicious change.\n\nNext, we must evaluate this expression for the given values $q = 0.37$ and $r = 5$.\n$$\nP_{\\text{detect}} = 1 - (1 - 0.37)^5\n$$\nFirst, calculate the base of the exponent:\n$$\n1 - 0.37 = 0.63\n$$\nNow, substitute this value back into the expression:\n$$\nP_{\\text{detect}} = 1 - (0.63)^5\n$$\nWe calculate the value of $(0.63)^5$:\n$$\n(0.63)^5 = 0.63 \\times 0.63 \\times 0.63 \\times 0.63 \\times 0.63 \\approx 0.0992436543\n$$\nFinally, we calculate $P_{\\text{detect}}$:\n$$\nP_{\\text{detect}} = 1 - 0.0992436543 = 0.9007563457\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $9$, $0$, $0$, and $7$. The fifth significant figure is $5$, which requires rounding up the fourth digit.\n$$\nP_{\\text{detect}} \\approx 0.9008\n$$",
            "answer": "$$\\boxed{0.9008}$$"
        },
        {
            "introduction": "A system's security is only as strong as its foundation, which begins with the boot process. This exercise  challenges you to design a resilient secure boot chain that can withstand a compromise in its own sequence of operations. You will use first principles of fault tolerance to determine the minimum level of redundancy needed to guarantee both safety (preventing a malicious takeover) and liveness (ensuring the system can still start correctly) when faced with a Byzantine adversary, a classic problem at the heart of trustworthy computing.",
            "id": "4248767",
            "problem": "A cyber-physical system implements a secure multistage boot chain to mitigate supply chain threats against both hardware and software. Let there be $L$ sequential boot stages, indexed by $i \\in \\{0,1,\\dots,L-1\\}$, where stage $i$ authenticates and transfers control to stage $i+1$. To reduce the risk that a single stage compromised in the supply chain can subvert the chain, the system designers instrument each stage handoff with $N$ independent verification steps, each anchored in a disjoint trust root (for example, an immutable hardware root-of-trust, a discrete secure coprocessor, and a remote digital twin attestation service that verifies measurements). Each verification step independently returns an 'accept' or 'reject' decision on the candidate image of stage $i+1$. A fixed acceptance policy gates the handoff: the handoff proceeds if and only if at least $K$ out of $N$ independent verification steps return 'accept'.\n\nAdversary model: at most one stage in the entire chain can be compromised during manufacture or integration. A compromised stage behaves in a Byzantine manner with respect to verification, meaning it can arbitrarily attempt to force acceptance of a malicious image or to deny a legitimate image. All independent verification steps remain honest unless they are co-resident with the compromised stage; independence means that honest verification steps do not share keys, code, or measurement roots with any other step and cannot be caused to accept malicious code except by being directly compromised. Honest verification steps always reject malicious images and always accept legitimate images. Communication from a stage to independent verifiers is authenticated so that an honest verifier sees the image actually supplied; time-of-check to time-of-use races are mitigated by design.\n\nDefine safety as the property that no malicious image is ever accepted at any handoff. Define liveness as the property that a legitimate image is not rejected at any handoff in the presence of at most one compromised stage. Model each handoff as a parallel verification subsystem with a $K$-out-of-$N$ acceptance rule. Using fault tolerance reasoning from first principles and minimal cut-set analysis for series–parallel systems, derive the minimal $N$ such that there exists some $K$ for which both safety and liveness are guaranteed against the adversary described. Assume the same $N$ and $K$ are used at every handoff. Provide your final answer as the minimal integer $N_{\\min}$ required. No rounding is needed and no units are required.",
            "solution": "The problem asks for the minimal number of independent verification steps, $N$, required at each stage of a secure boot chain to guarantee both safety and liveness against a specific adversary model, given that the handoff acceptance policy requires at least $K$ out of $N$ verifications to pass.\n\nFirst, we formalize the system model and constraints based on the problem statement.\nLet there be $L$ boot stages, indexed $i \\in \\{0, 1, \\dots, L-1\\}$. The handoff from stage $i$ to stage $i+1$ is guarded by $N$ independent verification steps. A handoff is successful if and only if the number of 'accept' decisions is at least $K$.\n\nThe adversary model states that at most one stage in the entire chain can be compromised. A compromised stage is Byzantine, meaning it can take arbitrary actions to subvert the system's goals. Honest verification steps are infallible: they always accept legitimate images and always reject malicious images. The crucial link between a compromised stage and the verification process is the statement: \"All independent verification steps remain honest unless they are co-resident with the compromised stage.\" This implies that the compromise of a stage can, in the worst case, lead to the compromise of verifiers associated with that stage's handoff procedure. The problem's emphasis on \"disjoint trust root\" and \"independence\" suggests that a single compromised stage does not compromise all $N$ verifiers. A reasonable and standard interpretation in fault-tolerance modeling is that a single faulty component (the compromised stage) can cause a bounded number of faults in the verification subsystem. The most direct interpretation consistent with the adversary being \"at most one\" entity is that the compromise of a single stage can corrupt at most one of the $N$ verification steps at the handoff it controls. Let $f$ be the maximum number of Byzantine verifiers at any given handoff. Based on this interpretation, we have $f=1$.\n\nWe now analyze the conditions required for safety and liveness using this model where $f=1$.\n\nSafety Requirement: No malicious image is ever accepted.\nA malicious image for stage $i+1$ can only be introduced by a compromised stage $i$. This is the attacker's action. To achieve their goal of having this malicious image accepted, the attacker will use any compromised verifiers to vote 'accept'. In our model, the attacker controls $f=1$ verifier. This Byzantine verifier will vote 'accept'. The remaining $N-1$ verifiers are honest. Presented with a malicious image, they will all correctly vote 'reject'.\nThe total number of 'accept' votes for the malicious image is therefore $1$.\nThe acceptance policy is that the number of 'accepts' must be $\\ge K$.\nFor the malicious image to be accepted, it would require $1 \\ge K$.\nTo guarantee safety, we must ensure the malicious image is always rejected. This means the acceptance condition must fail. Therefore, we must enforce the condition $1 < K$. Since $K$ must be an integer, this is equivalent to:\n$$K \\ge 2$$\n\nLiveness Requirement: A legitimate image is not rejected in the presence of at most one compromised stage.\nThe adversary's goal is now to block the boot process by causing a legitimate image to be rejected. The worst-case scenario for liveness occurs when a compromised stage attempts to interfere with the verification of a legitimate image. This could be stage $i$ being compromised and disrupting the verification of the legitimate image for stage $i+1$. The compromised stage will use its controlled verifier to vote 'reject', despite the image being legitimate.\nThe attacker controls $f=1$ verifier, which is made to vote 'reject'.\nThe remaining $N-1$ verifiers are honest. Presented with a legitimate image, they will all correctly vote 'accept'.\nThe total number of 'accept' votes for the legitimate image is therefore $N-1$.\nThe acceptance policy is that the number of 'accepts' must be $\\ge K$.\nTo guarantee liveness, the legitimate image must be accepted. This means the acceptance condition must be met. Therefore, we must enforce the condition:\n$$N-1 \\ge K$$\n\nCombining Conditions for $N$ and $K$:\nFor the system to be both safe and live, there must exist an integer $K$ that satisfies both derived inequalities simultaneously:\n1. From Safety: $K \\ge 2$\n2. From Liveness: $K \\le N-1$\n\nCombining these, we get the compound inequality:\n$$2 \\le K \\le N-1$$\nFor a valid integer solution for $K$ to exist, the lower bound must be less than or equal to the upper bound. This gives us the necessary condition on $N$:\n$$2 \\le N-1$$\nSolving this inequality for $N$:\n$$N \\ge 3$$\n\nThe problem asks for the minimal integer value of $N$, which we denote $N_{\\min}$. Based on the inequality $N \\ge 3$, the minimal integer value is $3$.\nThus, $N_{\\min} = 3$.\n\nWith $N=3$, we can choose $K=2$. Let's verify this choice:\n- Safety: A malicious image gets $1$ 'accept' vote from the Byzantine verifier. The condition for acceptance is a vote count $\\ge K=2$. Since $1 < 2$, the image is rejected. Safety holds.\n- Liveness: A legitimate image gets $N-1 = 3-1 = 2$ 'accept' votes. The condition for acceptance is a vote count $\\ge K=2$. Since $2 \\ge 2$, the image is accepted. Liveness holds.\n\nIf $N < 3$, no such $K$ exists. For example, if $N=2$, the conditions would be $K \\ge 2$ and $K \\le 2-1 = 1$. It is impossible for any integer $K$ to satisfy both $K \\ge 2$ and $K \\le 1$. Therefore, $N=3$ is indeed the minimum required number of verification steps. This result, $N \\ge 2f+1$ for $f$ Byzantine faults, is a fundamental principle in fault-tolerant systems with authenticated messages.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Securing a complex supply chain involves making difficult trade-offs, as resources for audits and verification are always limited. This practice  places you in the role of a security manager using a digital twin to make data-driven investment decisions. You will frame the problem of selecting which dependencies to audit as a classic optimization problem, using a cost-effectiveness methodology to achieve a target level of risk reduction for the minimum possible cost, demonstrating how to strategically allocate a security budget for maximum impact.",
            "id": "4248734",
            "problem": "A manufacturer of Cyber-Physical Systems (CPS) operates a Digital Twin that continuously quantifies supply chain security risk across a set of software and hardware dependencies. For each dependency $i \\in \\{1,2,3,4,5,6\\}$, the Digital Twin estimates an expected annual risk contribution $r_i$ (in million United States dollars), and an audit effectiveness $a_i \\in [0,1]$ that represents the fraction of the risk that is removed if the dependency is audited. Auditing dependency $i$ incurs a monetary audit cost $c_i$ (in kilo-United States dollars).\n\nAssume additive expected loss under independence of failure modes across dependencies. If a dependency $i$ is audited, its residual risk contribution becomes $(1 - a_i) r_i$, and if it is not audited, its residual risk remains $r_i$. The total residual expected annual risk across all dependencies must be reduced below a threshold $\\epsilon$ (in million United States dollars).\n\nGiven the following parameters:\n- $r_1 = 2.5$, $r_2 = 1.8$, $r_3 = 3.0$, $r_4 = 0.9$, $r_5 = 2.2$, $r_6 = 1.6$,\n- $a_1 = 0.6$, $a_2 = 0.4$, $a_3 = 0.5$, $a_4 = 0.7$, $a_5 = 0.3$, $a_6 = 0.8$,\n- $c_1 = 120$, $c_2 = 80$, $c_3 = 140$, $c_4 = 60$, $c_5 = 100$, $c_6 = 130$,\n- $\\epsilon = 6.5$,\n\nFormulate from first principles a cost-minimization selection of audits so that the Digital Twin’s modeled residual expected annual risk is strictly less than $\\epsilon$. Treat each audit decision as binary. Compute the minimal total audit cost (in kilo-United States dollars) that achieves the threshold. Express your final answer as an exact integer number of kilo-United States dollars with no rounding. Also identify which dependencies are audited in your reasoning, but report only the minimal total audit cost in your final numeric answer.",
            "solution": "The problem is to determine the minimum total cost of audits required to reduce the total residual expected annual risk to a value strictly less than a given threshold. This is a classic optimization problem that can be modeled as a variation of the 0/1 knapsack problem.\n\nFirst, let us formalize the problem. Let $i \\in \\{1, 2, 3, 4, 5, 6\\}$ be the index for each dependency. We introduce a set of binary decision variables, $x_i$, for each dependency:\n$$\nx_i = \\begin{cases} 1 & \\text{if dependency } i \\text{ is audited} \\\\ 0 & \\text{if dependency } i \\text{ is not audited} \\end{cases}\n$$\nThe total cost of the audits, $C_{total}$, is the sum of the costs of the selected audits. This is the objective function we want to minimize:\n$$\n\\text{Minimize } C_{total} = \\sum_{i=1}^{6} c_i x_i\n$$\nwhere $c_i$ is the cost of auditing dependency $i$.\n\nThe total initial risk, without any audits, is the sum of the individual risk contributions:\n$$\nR_{initial} = \\sum_{i=1}^{6} r_i\n$$\nThe risk contribution of dependency $i$ after a decision is made is $r_i$ if not audited ($x_i=0$) and $(1-a_i)r_i$ if audited ($x_i=1$). This can be written as $r_i - x_i a_i r_i$. The total residual risk, $R_{final}$, is the sum of these contributions over all dependencies:\n$$\nR_{final} = \\sum_{i=1}^{6} (r_i - x_i a_i r_i) = \\left(\\sum_{i=1}^{6} r_i\\right) - \\left(\\sum_{i=1}^{6} x_i a_i r_i\\right) = R_{initial} - \\sum_{i=1}^{6} x_i a_i r_i\n$$\nThe problem states the constraint that the total residual risk must be strictly less than the threshold $\\epsilon$:\n$$\nR_{final} < \\epsilon\n$$\nSubstituting the expression for $R_{final}$:\n$$\nR_{initial} - \\sum_{i=1}^{6} x_i a_i r_i < \\epsilon\n$$\nRearranging this inequality, we find the constraint on the total risk reduction. Let $\\Delta R_{total} = \\sum_{i=1}^{6} x_i a_i r_i$ be the total risk reduction achieved by the selected audits. The constraint is:\n$$\n\\Delta R_{total} > R_{initial} - \\epsilon\n$$\nLet's calculate the numerical values for the initial risk and the required reduction. The risk values $r_i$ and the threshold $\\epsilon$ are in millions of USD.\n$r = [2.5, 1.8, 3.0, 0.9, 2.2, 1.6]$\n$$\nR_{initial} = 2.5 + 1.8 + 3.0 + 0.9 + 2.2 + 1.6 = 12.0 \\text{ million USD}\n$$\nGiven $\\epsilon = 6.5$ million USD, the required total risk reduction is:\n$$\n\\Delta R_{required} > 12.0 - 6.5 = 5.5 \\text{ million USD}\n$$\nThe problem is to choose a set of audits (values of $x_i$) that minimizes the total cost $\\sum c_i x_i$ while satisfying $\\sum x_i a_i r_i > 5.5$. This is a 0/1 knapsack-type problem where we want to select items (audits) to achieve a minimum total \"value\" (risk reduction) for the minimum total \"weight\" (cost).\n\nA common and effective heuristic for such problems is a greedy algorithm based on cost-effectiveness. We define the efficiency, $e_i$, of each audit as the ratio of the risk reduction it provides, $\\Delta r_i = a_i r_i$, to its cost, $c_i$.\n$$e_i = \\frac{\\Delta r_i}{c_i} = \\frac{a_i r_i}{c_i}$$\nWe will calculate $\\Delta r_i$ (in million USD), $c_i$ (in kilo-USD), and $e_i$ (in units of $1000 \\frac{\\text{USD risk reduction}}{\\text{USD cost}}$) for each dependency.\n\n| Dependency $i$ | $r_i$ (M USD) | $a_i$ | $\\Delta r_i = a_i r_i$ (M USD) | $c_i$ (k USD) | $e_i = \\frac{\\Delta r_i}{c_i}$ |\n| :---: | :---: | :---: | :---: | :---: | :---: |\n| $1$ | $2.5$ | $0.6$ | $1.50$ | $120$ | $0.01250$ |\n| $2$ | $1.8$ | $0.4$ | $0.72$ | $80$  | $0.00900$ |\n| $3$ | $3.0$ | $0.5$ | $1.50$ | $140$ | $\\approx 0.01071$ |\n| $4$ | $0.9$ | $0.7$ | $0.63$ | $60$  | $0.01050$ |\n| $5$ | $2.2$ | $0.3$ | $0.66$ | $100$ | $0.00660$ |\n| $6$ | $1.6$ | $0.8$ | $1.28$ | $130$ | $\\approx 0.00985$ |\n\nNext, we sort the dependencies in descending order of their efficiency $e_i$:\n$e_1 > e_3 > e_4 > e_6 > e_2 > e_5$.\nThe selection order is therefore: $1, 3, 4, 6, 2, 5$.\n\nWe now apply the greedy algorithm, selecting audits in this order until the cumulative risk reduction exceeds $5.5$ million USD.\n\n1.  **Select audit 1**:\n    *   Cumulative cost: $C = c_1 = 120$.\n    *   Cumulative risk reduction: $\\Delta R = \\Delta r_1 = 1.50$.\n    *   $1.50 \\ngtr 5.5$. We must continue.\n\n2.  **Select audit 3**:\n    *   Cumulative cost: $C = 120 + c_3 = 120 + 140 = 260$.\n    *   Cumulative risk reduction: $\\Delta R = 1.50 + \\Delta r_3 = 1.50 + 1.50 = 3.00$.\n    *   $3.00 \\ngtr 5.5$. We must continue.\n\n3.  **Select audit 4**:\n    *   Cumulative cost: $C = 260 + c_4 = 260 + 60 = 320$.\n    *   Cumulative risk reduction: $\\Delta R = 3.00 + \\Delta r_4 = 3.00 + 0.63 = 3.63$.\n    *   $3.63 \\ngtr 5.5$. We must continue.\n\n4.  **Select audit 6**:\n    *   Cumulative cost: $C = 320 + c_6 = 320 + 130 = 450$.\n    *   Cumulative risk reduction: $\\Delta R = 3.63 + \\Delta r_6 = 3.63 + 1.28 = 4.91$.\n    *   $4.91 \\ngtr 5.5$. We must continue.\n\n5.  **Select audit 2**:\n    *   Cumulative cost: $C = 450 + c_2 = 450 + 80 = 530$.\n    *   Cumulative risk reduction: $\\Delta R = 4.91 + \\Delta r_2 = 4.91 + 0.72 = 5.63$.\n    *   $5.63 > 5.5$. The condition is now satisfied.\n\nThe set of selected audits is $\\{1, 2, 3, 4, 6\\}$. The minimal total audit cost found by this method is $530$ kilo-USD. The total risk reduction achieved is $5.63$ million USD.\nLet's verify the final risk:\n$R_{final} = R_{initial} - \\Delta R_{total} = 12.0 - 5.63 = 6.37$ million USD.\nThe condition $R_{final} < \\epsilon$ is $6.37 < 6.5$, which is true.\n\nWhile the greedy algorithm is a heuristic for the 0/1 knapsack problem and not guaranteed to be optimal in general, we can verify its optimality for this small problem. The sum of all possible risk reductions is $\\sum \\Delta r_i = 6.29$ million USD. If we omit the most efficient audit (audit 1, reduction $1.50$), the maximum possible reduction from the remaining audits is $6.29 - 1.50 = 4.79$ million USD, which is less than the required reduction of $5.5$. Therefore, audit 1 must be part of any valid solution, and thus must be in the optimal solution. A similar analysis shows that audits 3 and 6 are also mandatory. Proceeding with this logic confirms that the greedy selection is indeed optimal for this specific set of parameters.\n\nThe set of dependencies to be audited is $\\{1, 2, 3, 4, 6\\}$. The minimal total audit cost is the sum of their individual costs:\n$$\nC_{minimal} = c_1 + c_2 + c_3 + c_4 + c_6 = 120 + 80 + 140 + 60 + 130 = 530\n$$\nThe cost is in kilo-United States dollars.",
            "answer": "$$\\boxed{530}$$"
        }
    ]
}