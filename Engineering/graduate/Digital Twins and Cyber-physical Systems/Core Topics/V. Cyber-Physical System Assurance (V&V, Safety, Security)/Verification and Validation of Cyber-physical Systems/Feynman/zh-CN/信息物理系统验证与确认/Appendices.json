{
    "hands_on_practices": [
        {
            "introduction": "验证系统轨迹是否满足形式化规约是信息物理系统（CPS）验证与确认（V&V）中的一项核心任务。本练习将介绍信号时序逻辑（Signal Temporal Logic, STL）及其量化语义（鲁棒性），这是一种强大的工具，不仅能让我们检查系统行为是否违规，还能量化其违规的严重程度或满足规约的裕度。",
            "id": "4253595",
            "problem": "某个自动驾驶地面车辆的数字孪生必须验证一项安全要求，即其纵向速度在固定的关注时间域内保持在阈值以下。考虑信号时序逻辑（STL）公式 $\\varphi = \\mathbf{G}_{[0,10]}(v  30)$，其中 $v(t)$ 是车辆的速度信号，单位为米/秒，$\\mathbf{G}$ 表示在时间区间 $[0,10]$ 上的全局（总是）算子。\n\n任务：\n1) 从信号时序逻辑（STL）的布尔和定量（鲁棒）语义的核心定义出发，为在时间 $t=0$ 处对连续时间信号 $v : \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}$ 求值的公式 $\\varphi$ 指定其形式化布尔语义和定量鲁棒性语义。\n\n2) 给定从数字孪生中测量出的一个带有时间戳的样本时间序列 $\\{(t_i, v_i)\\}_{i=0}^{6}$，其中 $t_0 = 0$，$t_6 = 10$，且时间是严格递增的：\n$(t_0, v_0) = (0, 28.2)$，\n$(t_1, v_1) = (1.7, 29.6)$，\n$(t_2, v_2) = (3.1, 30.9)$，\n$(t_3, v_3) = (5.0, 31.2)$，\n$(t_4, v_4) = (6.8, 29.7)$，\n$(t_5, v_5) = (8.9, 29.9)$，\n$(t_6, v_6) = (10.0, 27.5)$。\n假设在 $[0,10]$ 上的连续时间信号 $v(t)$ 是通过在连续样本之间进行连续分段线性插值得到的。使用第1部分中的语义，计算定量鲁棒性值 $\\rho_{\\varphi}(v,0)$。\n\n将最终的鲁棒性表示为一个单位为米/秒的实数。不需要四舍五入。如果值为负，请包含负号。不要在最终的方框答案中包含单位。",
            "solution": "该问题定义明确，并在应用于信息物理系统验证的信号时序逻辑（STL）形式化方法方面具有科学依据。所有必要的数据和定义均已提供。我们可以开始求解。\n\n该问题要求完成两项任务。首先，为给定的STL公式定义布尔和定量语义。其次，为给定的分段线性信号计算定量鲁棒性值。\n\n**第1部分：STL公式的形式化语义**\n\n给定的STL公式为 $\\varphi = \\mathbf{G}_{[0,10]}(v  30)$。设连续时间信号为 $v: \\mathbb{R}_{\\ge 0} \\to \\mathbb{R}$。该公式在时间 $t=0$ 处求值。公式 $\\varphi$ 的核心是原子谓词 $\\mu := (v  30)$。这个谓词是关于信号 $v$ 在某个单时间点上值的陈述。\n\n**布尔语义**\nSTL公式的布尔语义确定了在给定时间，对于给定信号，该公式是真（满足）还是假（违反）。\n\n1.  **原子谓词：** 原子谓词 $\\mu$ 对于信号 $v$ 在时间 $t'$ 的布尔语义定义为：\n    $$ (v, t') \\models \\mu \\iff v(t')  30 $$\n    这意味着信号 $v$ 在时间 $t'$ 满足 $\\mu$，当且仅当 $v$ 在 $t'$ 的值小于 $30$。\n\n2.  **全局算子：** 公式 $\\varphi$ 在时间区间 $I = [0,10]$ 上使用了“全局”或“总是”算子 $\\mathbf{G}$。对于在时间 $t$ 求值的 $\\varphi = \\mathbf{G}_{I} \\mu$ 的布尔语义为：\n    $$ (v, t) \\models \\mathbf{G}_{I} \\mu \\iff \\forall t' \\in t+I, (v, t') \\models \\mu $$\n    其中 $t+I = \\{t+\\tau \\mid \\tau \\in I\\}$。\n\n    对于我们的具体问题，我们在时间区间 $I=[0,10]$ 上对 $t=0$ 处的 $\\varphi$ 进行求值。因此，$t+I = [0,10]$。其布尔语义为：\n    $$ (v, 0) \\models \\varphi \\iff \\forall t' \\in [0,10], (v, t') \\models (v  30) $$\n    换句话说，信号 $v$ 在时间 $t=0$ 满足公式 $\\varphi$，当且仅当在区间 $[0, 10]$ 内的所有时间点 $t'$，速度 $v(t')$ 都小于 $30$。\n\n**定量（鲁棒性）语义**\n定量语义，也称为鲁棒性，衡量公式被满足或违反的程度。正的鲁棒性值表示满足，负值表示违反，值为 $0$ 表示在边界上满足。该值的绝对大小量化了满足或违反的裕度。\n\n1.  **原子谓词：** 形式为 $f(x) > c$ 的原子谓词的标准定量语义是 $\\rho = f(x) - c$。我们的谓词是 $v  30$，可以重写为 $30 - v > 0$。因此，谓词 $\\mu$ 对于信号 $v$ 在时间 $t'$ 的鲁棒性是：\n    $$ \\rho_{\\mu}(v, t') = 30 - v(t') $$\n    这个鲁棒性值的单位与 $v$ 的单位相同，即米/秒。\n\n2.  **全局算子：** 公式 $\\varphi = \\mathbf{G}_{I} \\mu$ 在时间 $t$ 求值的鲁棒性定义为在其指定时间区间内，其子公式 $\\mu$ 鲁棒性的下确界（最大下界）：\n    $$ \\rho_{\\mathbf{G}_{I} \\mu}(v, t) = \\inf_{t' \\in t+I} \\rho_{\\mu}(v, t') $$\n\n    对于我们的具体问题，在时间区间 $I=[0,10]$ 上对 $t=0$ 处的 $\\varphi$ 进行求值，得到：\n    $$ \\rho_{\\varphi}(v, 0) = \\inf_{t' \\in [0,10]} \\rho_{\\mu}(v, t') = \\inf_{t' \\in [0,10]} (30 - v(t')) $$\n    使用下确界的性质，这可以表示为：\n    $$ \\rho_{\\varphi}(v, 0) = 30 - \\sup_{t' \\in [0,10]} v(t') $$\n    这个表达式说明，“总是”属性的鲁棒性由信号轨迹中的“最薄弱环节”决定。这对应于速度 $v(t')$ 达到其最大值的时间点，因为这是约束 $v  30$ 最有可能被违反的地方。\n\n**第2部分：鲁棒性值的计算**\n\n我们的任务是为通过对给定样本点 $\\{(t_i, v_i)\\}_{i=0}^{6}$ 进行连续分段线性插值所构造的信号 $v(t)$ 计算 $\\rho_{\\varphi}(v,0)$：\n$(t_0, v_0) = (0, 28.2)$\n$(t_1, v_1) = (1.7, 29.6)$\n$(t_2, v_2) = (3.1, 30.9)$\n$(t_3, v_3) = (5.0, 31.2)$\n$(t_4, v_4) = (6.8, 29.7)$\n$(t_5, v_5) = (8.9, 29.9)$\n$(t_6, v_6) = (10.0, 27.5)$\n\n鲁棒性由第1部分中导出的公式给出：\n$$ \\rho_{\\varphi}(v, 0) = 30 - \\sup_{t' \\in [0,10]} v(t') $$\n\n对于在一组点上定义的连续分段线性函数，该函数在整个定义域上的上确界（或最大值）必定出现在给定的某个样本点上（样条的“节点”）。这是因为在任意两点 $(t_i, v_i)$ 和 $(t_{i+1}, v_{i+1})$ 之间的每个线性段上，函数是单调的。因此，该段上的最大值或最小值必定在其中一个端点 $v_i$ 或 $v_{i+1}$ 处取得。因此，整个区间 $[0,10]$ 上的全局最大值必须是样本值 $v_i$ 之一。\n\n我们需要在速度测量值集合 $\\{v_0, v_1, v_2, v_3, v_4, v_5, v_6\\}$ 中找到最大值。\n这些值为：\n$v_0 = 28.2$\n$v_1 = 29.6$\n$v_2 = 30.9$\n$v_3 = 31.2$\n$v_4 = 29.7$\n$v_5 = 29.9$\n$v_6 = 27.5$\n\n通过观察，最大值为 $v_3 = 31.2$。\n因此，\n$$ \\sup_{t' \\in [0,10]} v(t') = \\max_{i \\in \\{0, \\dots, 6\\}} \\{v_i\\} = v_3 = 31.2 $$\n\n现在，我们将此值代回鲁棒性公式：\n$$ \\rho_{\\varphi}(v, 0) = 30 - 31.2 $$\n$$ \\rho_{\\varphi}(v, 0) = -1.2 $$\n\n鲁棒性值为 -1.2 米/秒。负号表示信号 $v$ 违反了安全要求 $\\varphi$。其绝对值 1.2 表示在最差的点（在 $t_3=5.0$ 时），速度超过了 30 米/秒的阈值 1.2 米/秒。",
            "answer": "$$\n\\boxed{-1.2}\n$$"
        },
        {
            "introduction": "为了提供形式化的安全保证，我们必须分析系统所有可能的行为，而不仅仅是单个轨迹。本练习介绍的可达性分析是一种强大的形式化验证方法，它旨在计算系统在初始条件和输入存在不确定性的情况下可能到达的所有状态的集合。通过这个实践，你将掌握如何应用线性映射和闵可夫斯基和（Minkowski sum）等核心工具，对线性系统进行基于集合的计算，从而为系统的安全性提供严格的证明。",
            "id": "4253596",
            "problem": "一个线性时不变（LTI）信息物理系统由连续时间动态 $x'(t) = A x(t) + B u(t)$ 建模，其中 $x(t) \\in \\mathbb{R}^{2}$ 是状态， $u(t) \\in \\mathbb{R}^{2}$ 是受已知有界集约束的外部输入。在一个基于数字孪生的验证与确认工作流中，您的任务是通过使用线性映射和闵可夫斯基和进行基于集合的可达性分析，计算在固定时间 $T$ 时一个与安全相关的线性性能指标的紧界。给定以下数据：\n- $A = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}$，\n- $B = I_{2}$，\n- 初始集 $X_{0} = \\{ x \\in \\mathbb{R}^{2} \\mid x_{1} \\in [0,2],\\ x_{2} \\in [-1,1] \\}$，\n- 输入集 $U = \\{ u \\in \\mathbb{R}^{2} \\mid u_{1} \\in [-1,1],\\ u_{2} \\in [-2,2] \\}$，\n- 评估时间 $T = \\ln(3)$，\n- 方向向量 $c = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$。\n\n从第一性原理出发——即线性系统的常数变易公式、闵可夫斯基和的定义 $S \\oplus K = \\{ s + k \\mid s \\in S,\\ k \\in K \\}$ 以及支撑函数的定义 $h_{S}(c) = \\sup_{x \\in S} c^{\\top} x$——推导将 $X_{0}$ 和 $U$ 映射到时间 $T$ 时的可达集 $R(T)$ 的单步可达性构造，该构造通过线性像和闵可夫斯基和表示。然后，计算最大性能指标的精确值 $J^{\\star} = \\sup_{x \\in R(T)} c^{\\top} x$。\n\n将最终答案报告为单个实数。无需四舍五入。无需单位。",
            "solution": "用户希望通过可达性分析，求解一个连续时间线性系统的线性性能指标的最大值。\n\n### 第1步：提取已知条件\n- 系统动态：$x'(t) = A x(t) + B u(t)$，其中 $x(t) \\in \\mathbb{R}^{2}$ 且 $u(t) \\in \\mathbb{R}^{2}$。\n- 系统矩阵：$A = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}$。\n- 输入矩阵：$B = I_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n- 初始状态集：$X_{0} = \\{ x \\in \\mathbb{R}^{2} \\mid x_{1} \\in [0,2],\\ x_{2} \\in [-1,1] \\}$。\n- 允许输入集：$U = \\{ u \\in \\mathbb{R}^{2} \\mid u_{1} \\in [-1,1],\\ u_{2} \\in [-2,2] \\}$。\n- 时间范围：$T = \\ln(3)$。\n- 性能指标的方向向量：$c = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$。\n- 待最大化的性能指标：$J^{\\star} = \\sup_{x \\in R(T)} c^{\\top} x$，其中 $R(T)$ 是在时间 $T$ 的可达集。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，植根于标准控制理论和信息物理系统的验证。其表述涉及线性时不变系统、可达性分析、闵可夫斯基和以及支撑函数，这些都是该领域中成熟的数学概念。问题是适定的：所有必要的数据（矩阵、集合、时间范围和目标方向）都已提供并且相互一致。语言客观而精确。集合 $X_0$ 和 $U$ 是紧凸集（超矩形），且动态是线性的，这保证了可达集也是紧凸的，因此线性泛函的最大值存在。矩阵 $A$ 是稳定的（特征值为-1和-2），这具有物理意义。该问题是自洽的，并且可以使用题目中引用的原理解答。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 求解推导\n对于初始状态为 $x(0) = x_0$ 的线性时不变系统 $x'(t) = A x(t) + B u(t)$，其解由常数变易公式给出：\n$$\nx(t) = e^{At} x_0 + \\int_0^t e^{A(t-\\tau)} B u(\\tau) d\\tau\n$$\n在时间 $T$ 的可达集 $R(T)$ 是从任意 $x_0 \\in X_0$ 出发，并施加在 $\\tau \\in [0, T]$ 上的任意有效输入函数 $u(\\tau) \\in U$ 所能达到的所有可能状态 $x(T)$ 的集合。这可以用基于集合的运算表示为两个集合的闵可夫斯基和：\n$$\nR(T) = e^{AT} X_0 \\oplus \\int_0^T e^{A(T-\\tau)} B U d\\tau\n$$\n第一项 $e^{AT} X_0 = \\{ e^{AT} x_0 \\mid x_0 \\in X_0 \\}$ 表示初始集的演化。第二项，我们记为 $R_U(T) = \\int_0^T e^{A(T-\\tau)} B U d\\tau$，表示由于输入而从原点可达的状态集。\n\n目标是计算 $J^{\\star} = \\sup_{x \\in R(T)} c^{\\top} x$，这正是集合 $R(T)$ 在方向 $c$ 上的支撑函数的定义，记为 $h_{R(T)}(c)$。\n\n支撑函数对于闵可夫斯基和有一个有用的性质：$h_{S_1 \\oplus S_2}(l) = h_{S_1}(l) + h_{S_2}(l)$。应用此性质，我们得到：\n$$\nJ^{\\star} = h_{R(T)}(c) = h_{e^{AT} X_0}(c) + h_{R_U(T)}(c)\n$$\n我们分别计算每一项。\n\n**第1项：$h_{e^{AT} X_0}(c)$**\n对于一个线性变换 $\\mathcal{L}$，变换后集合的支撑函数为 $h_{\\mathcal{L}(S)}(l) = h_S(\\mathcal{L}^{\\top} l)$。在这里，线性映射是乘以矩阵 $e^{AT}$。\n$$\nh_{e^{AT} X_0}(c) = h_{X_0}((e^{AT})^{\\top} c)\n$$\n首先，我们计算状态转移矩阵 $e^{AT}$。由于 $A$ 是一个对角矩阵，$A = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}$，其矩阵指数为：\n$$\ne^{At} = \\begin{pmatrix} e^{-t}  0 \\\\ 0  e^{-2t} \\end{pmatrix}\n$$\n在时间 $T=\\ln(3)$ 时：\n$$\ne^{AT} = \\begin{pmatrix} e^{-\\ln(3)}  0 \\\\ 0  e^{-2\\ln(3)} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  0 \\\\ 0  \\frac{1}{9} \\end{pmatrix}\n$$\n由于 $e^{AT}$ 是对称矩阵，所以 $(e^{AT})^{\\top} = e^{AT}$。我们计算新的方向向量 $c' = e^{AT} c$：\n$$\nc' = \\begin{pmatrix} \\frac{1}{3}  0 \\\\ 0  \\frac{1}{9} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{4}{9} \\end{pmatrix}\n$$\n现在我们求 $X_0 = [0,2] \\times [-1,1]$ 在方向 $c'$ 上的支撑函数：\n$$\nh_{X_0}(c') = \\sup_{x \\in X_0} (c')^{\\top} x = \\sup_{x_1 \\in [0,2], x_2 \\in [-1,1]} \\left(1 \\cdot x_1 + \\frac{4}{9} \\cdot x_2\\right)\n$$\n由于目标函数是可分的，我们可以独立地最大化每一项：\n$$\nh_{X_0}(c') = \\left(\\sup_{x_1 \\in [0,2]} 1 \\cdot x_1\\right) + \\left(\\sup_{x_2 \\in [-1,1]} \\frac{4}{9} \\cdot x_2\\right) = (1 \\cdot 2) + \\left(\\frac{4}{9} \\cdot 1\\right) = 2 + \\frac{4}{9} = \\frac{22}{9}\n$$\n\n**第2项：$h_{R_U(T)}(c)$**\n第二项是一个集合积分的支撑函数。一个关键结论表明，我们可以交换积分和支撑函数运算：\n$$\nh_{R_U(T)}(c) = h_{\\int_0^T e^{A(T-\\tau)} B U d\\tau}(c) = \\int_0^T h_{e^{A(T-\\tau)} B U}(c) d\\tau\n$$\n再次使用线性变换的性质，设 $\\mathcal{L}_{\\tau} = e^{A(T-\\tau)}B$：\n$$\nh_{R_U(T)}(c) = \\int_0^T h_U((e^{A(T-\\tau)}B)^{\\top} c) d\\tau\n$$\n给定 $B=I_2$ 且 $A$ 是对称的，$(e^{A(T-\\tau)}B)^{\\top} = B^{\\top}(e^{A(T-\\tau)})^{\\top} = I_2 e^{A(T-\\tau)} = e^{A(T-\\tau)}$。在时间 $\\tau$ 时用于 $h_U$ 的方向向量是 $d(\\tau) = e^{A(T-\\tau)}c$：\n$$\nd(\\tau) = \\begin{pmatrix} e^{-(T-\\tau)}  0 \\\\ 0  e^{-2(T-\\tau)} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 3 e^{-(T-\\tau)} \\\\ 4 e^{-2(T-\\tau)} \\end{pmatrix}\n$$\n输入集 $U = [-1,1] \\times [-2,2]$ 在这个方向上的支撑函数是：\n$$\nh_U(d(\\tau)) = \\sup_{u \\in U} d(\\tau)^{\\top}u = \\sup_{u_1 \\in [-1,1], u_2 \\in [-2,2]} \\left( 3 e^{-(T-\\tau)}u_1 + 4 e^{-2(T-\\tau)}u_2 \\right)\n$$\n对于任意 $\\tau \\in [0,T]$，指数项都是正的。为了最大化该表达式，我们必须为 $u_1$ 和 $u_2$ 选择可能的最大值，分别为 1 和 2。\n$$\nh_U(d(\\tau)) = \\left( 3 e^{-(T-\\tau)} \\cdot 1 \\right) + \\left( 4 e^{-2(T-\\tau)} \\cdot 2 \\right) = 3 e^{-(T-\\tau)} + 8 e^{-2(T-\\tau)}\n$$\n现在我们将此表达式从 $\\tau=0$ 积分到 $\\tau=T$：\n$$\nh_{R_U(T)}(c) = \\int_0^T \\left( 3 e^{-(T-\\tau)} + 8 e^{-2(T-\\tau)} \\right) d\\tau\n$$\n我们使用换元法，令 $s=T-\\tau$，这意味着 $ds = -d\\tau$。积分限从 $\\tau=0$ 变为 $s=T$，从 $\\tau=T$ 变为 $s=0$：\n$$\nh_{R_U(T)}(c) = \\int_T^0 (3 e^{-s} + 8 e^{-2s})(-ds) = \\int_0^T (3 e^{-s} + 8 e^{-2s}) ds\n$$\n计算积分：\n$$\n\\int_0^T (3 e^{-s} + 8 e^{-2s}) ds = \\left[ -3 e^{-s} - \\frac{8}{2} e^{-2s} \\right]_0^T = \\left[ -3 e^{-s} - 4 e^{-2s} \\right]_0^T\n$$\n$$\n= (-3 e^{-T} - 4 e^{-2T}) - (-3 e^0 - 4 e^0) = (-3 e^{-T} - 4 e^{-2T}) - (-7) = 7 - 3 e^{-T} - 4 e^{-2T}\n$$\n代入 $T=\\ln(3)$，所以 $e^{-T}=1/3$ 且 $e^{-2T}=1/9$：\n$$\nh_{R_U(T)}(c) = 7 - 3\\left(\\frac{1}{3}\\right) - 4\\left(\\frac{1}{9}\\right) = 7 - 1 - \\frac{4}{9} = 6 - \\frac{4}{9} = \\frac{54-4}{9} = \\frac{50}{9}\n$$\n\n**最终计算**\n最后，我们将两项相加，求出性能指标的总值：\n$$\nJ^{\\star} = h_{e^{AT} X_0}(c) + h_{R_U(T)}(c) = \\frac{22}{9} + \\frac{50}{9} = \\frac{72}{9} = 8\n$$",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "现代信息物理系统越来越多地集成神经网络等基于学习的组件，确保其安全性成为一个严峻的挑战。本练习将展示如何将一个神经网络控制器的验证问题精确地转化为一个混合整数线性规划（Mixed-Integer Linear Program, MILP）问题。这种基于优化的方法能够对控制器的行为提供穷尽式的严格保证，让你能够确定在所有允许的输入范围内，控制器的输出是否始终处于安全边界之内。",
            "id": "4253557",
            "problem": "一个信息物理系统（CPS）的数字孪生包含一个基于神经网络的安全关键控制器，该控制器将一个测量的状态向量 $x \\in \\mathbb{R}^{2}$ 映射到一个标量控制动作 $u \\in \\mathbb{R}$。系统级安全要求规定，在已知输入多胞体内的所有容许状态 $x$ 下，控制器输出必须满足 $u \\in [u_{\\min}, u_{\\max}]$。\n\n考虑一个单隐藏层前馈网络，其隐藏层有 $2$ 个单元，使用整流线性单元（ReLU）。网络参数如下：隐藏层的预激活值为 $z = W_{1} x + b_{1}$，其中\n$$\nW_{1} = \n\\begin{pmatrix}\n1  -2 \\\\\n-3  1\n\\end{pmatrix},\n\\quad\nb_{1} = \n\\begin{pmatrix}\n0.5 \\\\\n-0.2\n\\end{pmatrix},\n$$\n隐藏层的输出为 $y = \\max(0, z)$，逐元素应用。标量输出为 $u = c^{\\top} y + d$，其中\n$$\nc = \n\\begin{pmatrix}\n2 \\\\\n-1\n\\end{pmatrix},\n\\quad\nd = 0.3.\n$$\n容许状态空间为多胞体\n$$\n\\{ x \\in \\mathbb{R}^{2} \\mid -1 \\le x_{1} \\le 2, \\; 0 \\le x_{2} \\le 1 \\},\n$$\n这可以等价地写成 $A x \\le b$ 的形式，其中 $A \\in \\mathbb{R}^{m \\times 2}$ 和 $b \\in \\mathbb{R}^{m}$ 是适当的矩阵和向量。\n\n你的任务是将精确验证问题“确保对于容许状态多胞体中的所有 $x$，都有 $u \\in [u_{\\min}, u_{\\max}]$”编码为一个混合整数线性规划（MILP），从基本定义（分段线性 ReLU 和多面体集）开始，不使用任何预先给定的编码捷径。具体来说：\n\n- 仅使用给定的 $W_{1}$、$b_{1}$ 和输入多胞体，为每个隐藏单元推导预激活边界，然后通过引入二进制变量和相对于这些边界是紧的“大M”常数来精确编码每个 ReLU。\n- 建立整体 MILP 模型，其目标是在输入多胞体上最大化控制器输出 $u$，受限于精确的 ReLU 编码约束和所有网络关系。\n- 基于你的 MILP 和推导出的边界，计算在容许多胞体上 $u$ 的最坏情况上界 $u_{\\max}^{\\star}$。将你的最终数值结果四舍五入到四位有效数字，并将其表示为无量纲量。\n- 简要讨论在此设置中的求解器保证，包括需要哪些条件才能声称基于 MILP 的验证相对于 ReLU 网络和给定的输入多胞体是可靠和完备的。\n\n设安全规范为 $u \\in [u_{\\min}, u_{\\max}]$，其中 $u_{\\min} = -4$ 且 $u_{\\max} = 5$。你的最终答案必须是 $u_{\\max}^{\\star}$ 的单个四舍五入后的值，遵循上述四舍五入指令。",
            "solution": "用户提供的问题已根据既定标准进行了严格验证。\n\n### 第 1 步：提取已知条件\n- **系统**：一个带有神经网络控制器信息物理系统（CPS）。\n- **控制器输入**：状态向量 $x \\in \\mathbb{R}^{2}$。\n- **控制器输出**：标量控制动作 $u \\in \\mathbb{R}$。\n- **安全要求**：在容许的输入状态多胞体上，$u \\in [u_{\\min}, u_{\\max}]$。\n- **网络架构**：具有 2 个 ReLU 单元的单隐藏层。\n- **隐藏层预激活**：$z = W_{1} x + b_{1}$，其中\n$$\nW_{1} = \n\\begin{pmatrix}\n1  -2 \\\\\n-3  1\n\\end{pmatrix},\n\\quad\nb_{1} = \n\\begin{pmatrix}\n0.5 \\\\\n-0.2\n\\end{pmatrix}\n$$\n- **隐藏层激活**：$y = \\max(0, z)$（逐元素 ReLU）。\n- **输出层**：$u = c^{\\top} y + d$，其中\n$$\nc = \n\\begin{pmatrix}\n2 \\\\\n-1\n\\end{pmatrix},\n\\quad\nd = 0.3\n$$\n- **容许状态空间（输入多胞体）**：$\\{ x \\in \\mathbb{R}^{2} \\mid -1 \\le x_{1} \\le 2, \\; 0 \\le x_{2} \\le 1 \\}$。\n- **安全规范**：$u_{\\min} = -4$，$u_{\\max} = 5$。\n- **任务**：\n  1. 将验证问题编码为混合整数线性规划（MILP）。\n  2. 推导紧的预激活边界，并将其用于大M编码。\n  3. 建立 MILP 模型以最大化 $u$。\n  4. 计算最坏情况下的上界 $u_{\\max}^{\\star}$ 并四舍五入到四位有效数字。\n  5. 讨论求解器在可靠性和完备性方面的保证。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题是使用混合整数线性规划进行神经网络验证的一个典型例子。这是信息物理系统形式化验证领域中一个成熟且科学可靠的方法。网络结构（带 ReLU 的前馈网络）和多面体输入集的使用是此类分析的标准配置。\n- **适定性**：该问题是适定的。待最大化的函数 $u(x)$ 是 $x$ 的一个连续分段线性函数。$x$ 的定义域是一个紧集（一个封闭且有界的多胞体）。根据极值定理，函数 $u(x)$ 必须在此定义域上达到其最大值和最小值。问题要求的是最大值，该值保证存在且唯一。\n- **目标明确**：问题使用精确的数学符号和术语陈述。没有主观或模棱两可的陈述。\n- **完整性和一致性**：神经网络的所有参数（$W_1, b_1, c, d$）和输入集的定义都已完全指定。所有矩阵和向量的维度对于有效的矩阵-向量运算都是一致的。例如，$W_1$ 是 $2 \\times 2$，$x$ 是 $2 \\times 1$，$b_1$ 是 $2 \\times 1$，所以 $z$ 是 $2 \\times 1$。$c^T$ 是 $1 \\times 2$，$y$ 是 $2 \\times 1$，所以 $c^T y$ 是一个标量。所有方面都是一致的。\n- **其他缺陷**：该问题不是琐碎、隐喻性或超出科学验证范围的。它代表了指定领域中一个相关问题的具体、可解的实例。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供一个严谨的解决方案。\n\n### 解题推导\n\n神经网络控制器由以下方程定义：\n$$ z = W_{1} x + b_{1} $$\n$$ y = \\text{ReLU}(z) = \\max(0, z) $$\n$$ u = c^{\\top} y + d $$\n\n令 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，$z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$，以及 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$。网络方程为：\n$$ z_1 = x_1 - 2x_2 + 0.5 $$\n$$ z_2 = -3x_1 + x_2 - 0.2 $$\n$$ y_1 = \\max(0, z_1) $$\n$$ y_2 = \\max(0, z_2) $$\n$$ u = 2y_1 - y_2 + 0.3 $$\n\n问题是找到在由 $-1 \\le x_1 \\le 2$ 和 $0 \\le x_2 \\le 1$ 定义的输入多胞体中所有 $x$ 对应的 $u$ 的最大值，记为 $u_{\\max}^{\\star}$。\n\n**1. 预激活边界的推导**\n为了建立 MILP 模型，我们首先需要为每个预激活变量 $z_j$ 在输入多胞体上找到下界和上界（$L_j, U_j$）。由于 $z_j$ 是 $x_1$ 和 $x_2$ 的线性函数，并且输入域是一个凸多胞体（一个矩形），极值将出现在定义域的顶点上：$(-1,0)$、$(2,0)$、$(-1,1)$ 和 $(2,1)$。\n\n对于 $z_1 = x_1 - 2x_2 + 0.5$：\n边界可以通过分别最小化和最大化各项来找到：\n$L_1 = (\\min x_1) - 2(\\max x_2) + 0.5 = (-1) - 2(1) + 0.5 = -2.5$。\n$U_1 = (\\max x_1) - 2(\\min x_2) + 0.5 = (2) - 2(0) + 0.5 = 2.5$。\n因此，$z_1 \\in [-2.5, 2.5]$。\n\n对于 $z_2 = -3x_1 + x_2 - 0.2$：\n$L_2 = -3(\\max x_1) + (\\min x_2) - 0.2 = -3(2) + 0 - 0.2 = -6.2$。\n$U_2 = -3(\\min x_1) + (\\max x_2) - 0.2 = -3(-1) + 1 - 0.2 = 3.8$。\n因此，$z_2 \\in [-6.2, 3.8]$。\n\n两个神经元都是“不稳定的”，因为它们的预激活边界都跨越了 $0$。这意味着它们可以是激活或非激活状态，具体取决于输入 $x$。\n\n**2. ReLU 的 MILP 公式化**\n每个 ReLU 神经元 $y_j = \\max(0, z_j)$，其预激活边界为 $[L_j, U_j]$，可以使用一个二进制变量 $\\delta_j \\in \\{0, 1\\}$ 和大M方法进行精确建模。最紧的大M常数是 $M_j^{\\text{upper}} = U_j$ 和 $M_j^{\\text{lower}} = L_j$。线性约束集为：\n\n1. $y_j \\ge z_j$\n2. $y_j \\ge 0$\n3. $z_j \\le U_j \\delta_j$\n4. $y_j \\le U_j \\delta_j$\n5. $y_j \\le z_j - L_j(1 - \\delta_j)$\n\n如果 $\\delta_j=1$，则 $z_j \\in (0, U_j]$，约束强制 $y_j = z_j$。如果 $\\delta_j=0$，则 $z_j \\in [L_j, 0]$，约束强制 $y_j = 0$。\n\n对于神经元 1（$L_1=-2.5, U_1=2.5$）：\n- $y_1 \\ge z_1$\n- $y_1 \\ge 0$\n- $z_1 \\le 2.5 \\delta_1$\n- $y_1 \\le 2.5 \\delta_1$\n- $y_1 \\le z_1 - (-2.5)(1-\\delta_1) \\Rightarrow y_1 \\le z_1 + 2.5(1-\\delta_1)$\n\n对于神经元 2（$L_2=-6.2, U_2=3.8$）：\n- $y_2 \\ge z_2$\n- $y_2 \\ge 0$\n- $z_2 \\le 3.8 \\delta_2$\n- $y_2 \\le 3.8 \\delta_2$\n- $y_2 \\le z_2 - (-6.2)(1-\\delta_2) \\Rightarrow y_2 \\le z_2 + 6.2(1-\\delta_2)$\n\n**3. 最大化 $u$ 的完整 MILP 公式化**\n寻找 $u_{\\max}^{\\star}$ 的整体问题表示为以下 MILP：\n- **目标函数**：最大化 $u = 2y_1 - y_2 + 0.3$。\n- **变量**：\n  - 连续变量：$x_1, x_2, z_1, z_2, y_1, y_2$\n  - 二进制变量：$\\delta_1, \\delta_2$\n- **约束**：\n  - 输入多胞体：\n    - $-1 \\le x_1 \\le 2$\n    - $0 \\le x_2 \\le 1$\n  - 网络定义：\n    - $z_1 = x_1 - 2x_2 + 0.5$\n    - $z_2 = -3x_1 + x_2 - 0.2$\n  - 神经元 1 的 ReLU 约束：\n    - $y_1 \\ge z_1$, $y_1 \\ge 0$, $z_1 \\le 2.5 \\delta_1$, $y_1 \\le 2.5 \\delta_1$, $y_1 \\le z_1 + 2.5(1-\\delta_1)$\n  - 神经元 2 的 ReLU 约束：\n    - $y_2 \\ge z_2$, $y_2 \\ge 0$, $z_2 \\le 3.8 \\delta_2$, $y_2 \\le 3.8 \\delta_2$, $y_2 \\le z_2 + 6.2(1-\\delta_2)$\n\n**4. $u_{\\max}^{\\star}$ 的计算**\n求解 MILP 等价于分析对应于四种离散激活模式 $(\\delta_1, \\delta_2) \\in \\{(0,0), (0,1), (1,0), (1,1)\\}$ 的 $2^2=4$ 个可能的线性规划（LP）。全局最大值是所有可行 LP 中的最大值。\n\n- **情况 1：$(\\delta_1, \\delta_2) = (0,0)$**\n  - 条件：$z_1 \\le 0, z_2 \\le 0$。\n  - 网络输出：$y_1 = 0, y_2 = 0$。因此，$u = 2(0) - 0 + 0.3 = 0.3$。\n  - 对于多胞体中的某些 $x$（例如，$x=(0.5, 0.5)$ 给出 $z_1=0, z_2=-1.2$），此激活模式是可行的。\n  - 该区域中的最大 $u$ 为 $u_{\\max}^{(1)} = 0.3$。\n\n- **情况 2：$(\\delta_1, \\delta_2) = (0,1)$**\n  - 条件：$z_1 \\le 0, z_2  0$。\n  - 网络输出：$y_1 = 0, y_2 = z_2 = -3x_1 + x_2 - 0.2$。\n  - $u = 2(0) - (-3x_1 + x_2 - 0.2) + 0.3 = 3x_1 - x_2 + 0.5$。\n  - 我们在区域 $\\{x \\mid -1\\le x_1 \\le 2, 0\\le x_2 \\le 1, x_1 - 2x_2 + 0.5 \\le 0, -3x_1 + x_2 - 0.2  0\\}$ 上最大化 $3x_1 - x_2 + 0.5$。\n  - 此线性目标的最大值在可行域的某个顶点找到。通过检视，该子多胞体的任何顶点都不会产生大于 $0.3$ 的 $u$ 值（例如，在 $x=(-1,1)$ 处，$u=-3.5$；在 $x=(0.8/3, 1)$ 处，$u=0.3$）。\n  - 该区域中的最大 $u$ 为 $u_{\\max}^{(2)} = 0.3$。\n\n- **情况 3：$(\\delta_1, \\delta_2) = (1,0)$**\n  - 条件：$z_1  0, z_2 \\le 0$。\n  - 网络输出：$y_1 = z_1 = x_1 - 2x_2 + 0.5$，且 $y_2 = 0$。\n  - $u = 2(x_1 - 2x_2 + 0.5) - 0 + 0.3 = 2x_1 - 4x_2 + 1.3$。\n  - 我们在区域 $\\{x \\mid -1\\le x_1 \\le 2, 0\\le x_2 \\le 1, x_1 - 2x_2 + 0.5  0, -3x_1 + x_2 - 0.2 \\le 0\\}$ 上最大化 $2x_1 - 4x_2 + 1.3$。\n  - 目标函数梯度 $(2, -4)$ 有利于大的 $x_1$ 和小的 $x_2$。我们测试输入盒的相应顶点 $x=(2,0)$。\n    - 对于 $x=(2,0)$：$z_1 = 2-0+0.5 = 2.5  0$。$z_2 = -3(2)+0-0.2 = -6.2 \\le 0$。\n  - 点 $(2,0)$ 在此情况下是可行的。由于目标是线性的，子多胞体上的最大值在其顶点之一处达到，而 $(2,0)$ 是该子多胞体的一个顶点，它也在整个输入盒上最大化了目标。因此，最大值在此处达到。\n  - $u(2,0) = 2(2) - 4(0) + 1.3 = 5.3$。\n  - 该区域中的最大 $u$ 为 $u_{\\max}^{(3)} = 5.3$。\n\n- **情况 4：$(\\delta_1, \\delta_2) = (1,1)$**\n  - 条件：$z_1  0, z_2  0$。\n  - 网络输出：$y_1 = z_1, y_2 = z_2$。\n  - $u = 2z_1 - z_2 + 0.3 = 2(x_1 - 2x_2 + 0.5) - (-3x_1 + x_2 - 0.2) + 0.3 = 5x_1 - 5x_2 + 1.5$。\n  - 我们在区域 $\\{x \\mid -1\\le x_1 \\le 2, 0\\le x_2 \\le 1, x_1 - 2x_2 + 0.5  0, -3x_1 + x_2 - 0.2  0\\}$ 上最大化 $5x_1 - 5x_2 + 1.5$。\n  - 目标函数梯度 $(5, -5)$ 有利于大的 $x_1$ 和小的 $x_2$。点 $(2,0)$ 不在该区域内（$z_2(2,0)  0$）。\n  - 可行域是一个以 $(-0.5, 0)$、$(-1/15, 0)$ 和 $(0.02, 0.26)$ 为顶点的三角形。\n  - 在这些顶点处计算 $u$ 的值：$u(-0.5, 0) = -1.0$，$u(-1/15, 0) \\approx 1.167$，$u(0.02, 0.26) = 0.3$。\n  - 该区域中的最大 $u$ 为 $u_{\\max}^{(4)} = 7/6 \\approx 1.167$。\n\n**关于 $u_{\\max}^{\\star}$ 的结论**\n全局最大输出是每种情况下找到的值的最大值：\n$u_{\\max}^{\\star} = \\max\\{0.3, 0.3, 5.3, 7/6\\} = 5.3$。\n四舍五入到四位有效数字得到 $5.300$。该值大于指定的安全限值 $u_{\\max}=5$，表明存在安全违规。\n\n**5. 求解器保证的讨论**\n基于 MILP 的验证方法在特定条件下提供了关于可靠性和完备性的强有力保证。\n- **可靠性（Soundness）**：如果 MILP 的任何可行解都对应于神经网络的一个真实行为，则编码是可靠的。ReLU 的大M公式化是一种精确表示，而非近似表示。因此，如果预激活边界 $[L_j, U_j]$ 计算正确（即，它们是有效的下界和上界，如此处所做），则 MILP 约束是网络在指定多胞体上输入-输出函数的完全忠实模型。求解器找到的任何最优解都对应于一个真实的输入 $x$ 和输出 $u$。\n- **完备性（Completeness）**：如果对于多胞体中的任何输入 $x$，在 MILP 中都有一个对应的可行解，则编码是完备的。由于约束精确地反映了网络对所有输入的数学定义，该性质成立。MILP 公式化覆盖了整个输入空间且没有间隙。\n- **求解器保证**：一个正确的 MILP 求解器（例如，使用分支定界算法）保证能找到全局最优解，前提是它能运行至完成。这意味着它返回的 $u_{\\max}^{\\star}$ 是网络输出在整个输入多胞体上的真实最大值。因此，该方法是穷尽的。\n\n总之，对于像 ReLU FNN 这样的分段线性网络和多面体输入集，基于 MILP 的验证是一种可靠且完备的验证方法。主要要求是正确推导预激活边界，并使用一个能运行至终止的正确求解器。",
            "answer": "$$\n\\boxed{5.300}\n$$"
        }
    ]
}