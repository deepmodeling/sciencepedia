{
    "hands_on_practices": [
        {
            "introduction": "可信执行环境 (TEE) 的使用并非没有代价，它会带来不可避免的资源开销。本练习将指导您计算其中一项基本开销：管理安全内存 (EPC) 所需的元数据 (EPCM) 的内存占用。这项计算是在资源受限的网络物理系统 (CPS) 设备上进行任何基于 TEE 的应用资源规划时至关重要的第一步，它将 TEE 的抽象概念与具体的硬件资源成本联系起来 。",
            "id": "4252373",
            "problem": "一个信息物理系统（CPS）边缘节点在可信执行环境（TEE）内部署了一个数字孪生，以保护状态估计和控制计算的完整性和机密性。该TEE使用一种安全飞地抽象，其包含一个用于存放飞地内代码和数据的飞地页面缓存（EPC），以及一个用于跟踪每个EPC页面所有权和访问属性的飞地页面缓存映射（EPCM）。EPC容量固定为 $128\\ \\mathrm{MiB}$，EPC页面大小为 $4\\ \\mathrm{KiB}$，并且EPCM为每个EPC页面存储 $64\\ \\mathrm{bytes}$ 的元数据。仅使用二进制单位的基本定义和基于页面的核算方法，推导出EPCM元数据占用空间（以 mebibyte 为单位）。\n\n假设和基本定义：\n- 一 mebibyte 等于 $1\\ \\mathrm{MiB} = 2^{20}\\ \\mathrm{bytes}$。\n- 一 kibibyte 等于 $1\\ \\mathrm{KiB} = 2^{10}\\ \\mathrm{bytes}$。\n- EPC页面的数量由EPC总容量除以页面大小得出。\n- EPCM占用空间等于EPC页面数量乘以每页的元数据大小。\n\n以 $\\mathrm{MiB}$ 为单位表示最终结果。无需四舍五入。此外，请从第一性原理出发，解释此元数据占用空间如何影响在TEE内部执行的内存受限的CPS工作负载，特别是对于那些必须完全放入固定的EPC中同时保持可预测延迟的硬实时任务；您的讨论应基于推导出的占用空间和内存密集型行为，不借助未经测试或专有的机制。",
            "solution": "问题陈述被评估为有效。其科学依据在于计算机体系结构和可信执行环境的原理，问题提法恰当，数据充分且一致，并且表述客观。\n\n解决方案分两部分进行：首先，推导飞地页面缓存映射（EPCM）的占用空间；其次，解释其对信息物理系统（CPS）工作负载的影响。\n\n**第一部分：EPCM元数据占用空间的推导**\n\n设 $C_{EPC}$ 表示飞地页面缓存（EPC）的总容量，$S_{page}$ 表示单个EPC页面的大小，$S_{meta}$ 表示EPCM为每个EPC页面存储的元数据的大小。\n\n给定值为：\n- $C_{EPC} = 128\\ \\mathrm{MiB}$\n- $S_{page} = 4\\ \\mathrm{KiB}$\n- $S_{meta} = 64\\ \\mathrm{bytes}$\n\n二进制单位的基本定义为：\n- $1\\ \\mathrm{MiB} = 2^{20}\\ \\mathrm{bytes}$\n- $1\\ \\mathrm{KiB} = 2^{10}\\ \\mathrm{bytes}$\n\n首先，我们必须将所有量表示为公共基本单位，即字节。\n\nEPC容量（以字节为单位）为：\n$$C_{EPC} = 128 \\times (1\\ \\mathrm{MiB}) = 2^{7} \\times 2^{20}\\ \\mathrm{bytes} = 2^{27}\\ \\mathrm{bytes}$$\n\nEPC页面大小（以字节为单位）为：\n$$S_{page} = 4 \\times (1\\ \\mathrm{KiB}) = 2^{2} \\times 2^{10}\\ \\mathrm{bytes} = 2^{12}\\ \\mathrm{bytes}$$\n\n每页的元数据大小已按字节给出：\n$$S_{meta} = 64\\ \\mathrm{bytes} = 2^{6}\\ \\mathrm{bytes}$$\n\nEPC页面的总数，记为 $N_{pages}$，由EPC总容量除以单个页面的大小确定，正如问题假设中所述。\n$$N_{pages} = \\frac{C_{EPC}}{S_{page}} = \\frac{2^{27}\\ \\mathrm{bytes}}{2^{12}\\ \\mathrm{bytes}} = 2^{(27-12)} = 2^{15}$$\n因此，EPC中有 $2^{15} = 32768$ 个页面。\n\nEPCM的总占用空间，记为 $F_{EPCM}$，是EPC页面数乘以每页元数据的大小。\n$$F_{EPCM} = N_{pages} \\times S_{meta} = 2^{15} \\times 2^{6}\\ \\mathrm{bytes} = 2^{(15+6)}\\ \\mathrm{bytes} = 2^{21}\\ \\mathrm{bytes}$$\n\n问题要求最终结果以 mebibyte（$\\mathrm{MiB}$）表示。要将EPCM占用空间从字节转换为 $\\mathrm{MiB}$，我们将其除以一 mebibyte 中的字节数。\n$$F_{EPCM\\ (\\mathrm{in\\ MiB})} = \\frac{F_{EPCM}}{1\\ \\mathrm{MiB}} = \\frac{2^{21}\\ \\mathrm{bytes}}{2^{20}\\ \\mathrm{bytes/MiB}} = 2^{(21-20)}\\ \\mathrm{MiB} = 2^{1}\\ \\mathrm{MiB} = 2\\ \\mathrm{MiB}$$\nEPCM元数据占用空间恰好为 $2\\ \\mathrm{MiB}$。\n\n**第二部分：对内存受限的CPS工作负载的影响**\n\n从第一性原理出发，推导出的 $2\\ \\mathrm{MiB}$ 的EPCM占用空间对内存受限的CPS工作负载有直接且显著的影响，特别是那些具有硬实时要求的工作负载。\n\n1.  **固定资源开销**：EPCM是一个由硬件管理的数据结构，位于处理器预留内存中，与EPC本身是分开的。推导出的 $2\\ \\mathrm{MiB}$ 占用空间代表了一种固定的、静态的内存开销。这部分内存被TEE基础设施消耗，飞地或系统上的任何其他软件都无法使用。为TEE机制保留的物理内存总量是EPC和EPCM容量的总和，在本例中为 $128\\ \\mathrm{MiB} + 2\\ \\mathrm{MiB} = 130\\ \\mathrm{MiB}$。虽然相对于 $128\\ \\mathrm{MiB}$ 的EPC，这 $2\\ \\mathrm{MiB}$ 的开销看似很小，但它是为提供安全保证而付出的不可协商的成本。\n\n2.  **有限的EPC瓶颈**：对于在TEE内部运行的硬实时任务，例如为关键控制回路执行状态估计的数字孪生，可预测的延迟至关重要。为实现这一点，任务的整个工作集（代码和数据）必须驻留在固定大小的EPC（$128\\ \\mathrm{MiB}$）内。这可以防止一类与内存访问相关的非确定性延迟。\n\n3.  **安全分页和延迟灾难**：如果工作负载是内存密集型的——即其内存需求超过了EPC容量——CPU必须借助一种称为安全分页（或交换）的机制。当飞地需要一个当前不在EPC中的页面时，必须将一个驻留页面驱逐到不受信任的主内存中。此过程涉及：\n    - CPU查询EPCM以识别要驱逐的候选页面。\n    - 在将页面内容写入主RAM之前，对其进行加密并生成完整性保护标签（例如，MAC）。\n    - 页面换出后，从主RAM加载所需的页面。\n    - 解密传入的页面并验证其完整性标签。\n    - 使用新页面的状态和位置更新EPCM。\n\n4.  **违反实时性保证**：每次安全页面换入/换出操作都涉及由处理器的微码或硬件逻辑执行的计算成本高昂的加密功能。这会给执行路径带来极高且至关重要的可变延迟。对于一个硬实时系统，其中控制决策必须在严格的截止时间（例如，毫秒级）内做出，这种不可预测的延迟是灾难性的。单次页面错误就可能导致错过截止时间，从而可能在CPS中导致系统不稳定或物理故障。\n\n总之，EPCM是实现对有限EPC进行管理的机制。其自身的 $2\\ \\mathrm{MiB}$ 占用空间量化了提供安全、隔离执行环境所需的部分静态资源成本。对于硬实时CPS工作负载而言，其根本限制是其整个内存工作集必须完全放入EPC中的严格要求，以避免安全分页带来的灾难性的、非确定性的延迟惩罚，而这种行为正是由CPU使用EPCM直接管理的。因此，EPC的有限大小是决定在TEE内部署给定实时任务可行性的主要约束。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "在理解了静态内存成本之后，我们转向动态性能成本。TEE 必须处理外部事件（如硬件中断），而每次中断都会强制执行一次异步 enclave 退出 (Asynchronous Enclave Exit, AEX)，这是一种会引入延迟的上下文切换。这个练习  建立了一个模型，用于计算由 AEX 引起的最坏情况下的延迟增加。对于必须满足严格实时期限的网络物理系统 (CPS) 而言，理解和量化这种开销是确保系统稳定性和安全性的关键。",
            "id": "4252420",
            "problem": "一个网络物理系统 (CPS) 数字孪生控制器在可信执行环境 (TEE) 中执行，例如英特尔软件防护扩展 (SGX)。在此环境中，任何外部中断都会导致异步飞地退出 (AEX)，之后控制器恢复执行。该控制器以长度为 $T_{p} = 10\\,\\text{ms}$ 的控制周期运行。中断过程是速率受限的：中断之间的最小到达间隔时间为 $1/\\lambda$，其中 $\\lambda$ 是最大中断速率。每次 AEX 处理都会在执行恢复前引入一个额外的延迟 $c$。\n\n假设如下：\n- 中断速率上限为 $\\lambda = 1\\,\\text{kHz}$，意味着最小到达间隔时间为 $1/\\lambda$。\n- 单次中断的 AEX 处理延迟预算为 $c = 8\\,\\mu\\text{s}$。\n- 用于计数中断的控制周期窗口是半开区间 $[0, T_{p})$，并且中断可能在此窗口内以对抗性方式对齐。\n\n从速率受限到达过程的定义和时间窗口计数论证出发，推导在窗口 $[0, T_{p})$ 内可能发生的最坏情况中断次数，并由此计算单个控制周期内仅由 AEX 处理引起的最坏情况附加延迟。请将您的最终答案表示为以微秒为单位的单个实数。不要四舍五入；请提供精确值。",
            "solution": "题目要求确定在单个控制周期内，由异步飞地退出 (AEX) 引起的最坏情况中断次数和由此产生的总附加延迟。\n\n首先，我们必须验证问题陈述。\n\n### 步骤1：提取已知条件\n-   控制周期：$T_{p} = 10\\,\\text{ms}$\n-   最大中断速率：$\\lambda = 1\\,\\text{kHz}$\n-   中断间的最小到达间隔时间：$1/\\lambda$\n-   单次中断的 AEX 处理延迟：$c = 8\\,\\mu\\text{s}$\n-   用于计数中断的控制周期窗口：$[0, T_{p})$\n-   中断可能在此窗口内以对抗性方式对齐。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在实时系统和计算机体系结构领域具有科学依据，特别与可信执行环境相关。控制周期、速率受限中断和事件处理延迟等概念都是标准概念。所提供的数值（$T_p = 10\\,\\text{ms}$，$\\lambda = 1\\,\\text{kHz}$，$c=8\\,\\mu\\text{s}$）在物理上是合理的，并与现代计算硬件一致。该问题是适定 (well-posed) 的，因为它要求基于一个明确定义的模型（半开时间区间内的速率受限到达）进行最坏情况分析，从而得出一个唯一的、可推导的解。其语言客观、精确。不存在科学、逻辑或事实上的矛盾。问题是完整且自洽的。\n\n### 步骤3：结论与行动\n问题有效。我们将继续进行求解。\n\n问题在于找出在持续时间为 $T_p$ 的时间窗口内可能发生的最坏情况中断次数，我们将其表示为 $N_{max}$。该窗口是半开区间 $[0, T_p)$。中断是一个速率受限到达过程的一部分，其中任意两个连续中断之间的最小时间为 $T_{min} = 1/\\lambda$。\n\n为了找到最坏情况下的中断次数，我们必须考虑在给定约束下中断的最密集排列。这种情况发生在第一个中断恰好在时间区间的起始时刻发生，并且后续中断以允许的最快速度到达，即间隔恰好为 $T_{min}$。这就是问题中提到的“对抗性对齐”。\n\n设中断的到达时间为 $t_0, t_1, t_2, \\dots$。在最坏情况下，我们将第一个中断置于最早的可能时刻，即 $t_0 = 0$。随后的中断将发生在 $t_1 = T_{min}$、$t_2 = 2T_{min}$，通常，第 $k$ 个中断（使用从0开始的索引）发生在时间 $t_k = k \\cdot T_{min}$。\n\n要使时间 $t_k$ 发生的中断被计数，它必须落在指定的区间 $[0, T_p)$ 内。这施加了以下条件：\n$$0 \\le t_k  T_p$$\n代入我们的 $t_k$ 表达式：\n$$k \\cdot T_{min}  T_p$$\n这等价于：\n$$k  \\frac{T_p}{T_{min}}$$\n由于 $k$ 必须是非负整数（$k=0, 1, 2, \\dots$），我们需要找到满足此不等式的非负整数的个数。这个计数将给出最大中断次数 $N_{max}$。满足 $k  X$ 的非负整数 $k$ 的个数是 $10$ 个 (从 $k=0$ 到 $k=9$) 。更一般地，这个数量可以用向上取整函数（天花板函数）$\\lceil X \\rceil$ 给出。因此，最大中断次数为：\n$$N_{max} = \\left\\lceil \\frac{T_p}{T_{min}} \\right\\rceil$$\n\n现在，我们代入给定值。控制周期为 $T_p = 10\\,\\text{ms} = 10 \\times 10^{-3}\\,\\text{s}$。\n最大中断速率为 $\\lambda = 1\\,\\text{kHz} = 1000\\,\\text{s}^{-1}$。\n最小到达间隔时间为 $T_{min} = 1/\\lambda = 1 / (1000\\,\\text{s}^{-1}) = 10^{-3}\\,\\text{s} = 1\\,\\text{ms}$。\n\n我们现在可以计算比率 $T_p/T_{min}$：\n$$\\frac{T_p}{T_{min}} = \\frac{10 \\times 10^{-3}\\,\\text{s}}{1 \\times 10^{-3}\\,\\text{s}} = 10$$\n使用这个值，我们求出最坏情况下的中断次数：\n$$N_{max} = \\lceil 10 \\rceil = 10$$\n为了验证这一点，对抗性中断时间将是 $0\\,\\text{ms}$, $1\\,\\text{ms}$, $2\\,\\text{ms}$, $\\dots$, $9\\,\\text{ms}$。下一次中断将发生在 $10\\,\\text{ms}$，这不在区间 $[0, 10\\,\\text{ms})$ 内。这证实了在最坏情况下恰好有 $10$ 次中断。\n\n接下来，问题要求计算单个控制周期内由于 AEX 处理所导致的最坏情况附加延迟。$N_{max}$ 次中断中的每一次都会引入 $c = 8\\,\\mu\\text{s}$ 的延迟。总的最坏情况延迟 $L_{max}$ 是中断次数与单次中断延迟的乘积。\n$$L_{max} = N_{max} \\cdot c$$\n代入我们已有的值：\n$$L_{max} = 10 \\cdot 8\\,\\mu\\text{s} = 80\\,\\mu\\text{s}$$\n最坏情况下的附加延迟为 $80$ 微秒。最终答案应表示为以微秒为单位的单个实数。",
            "answer": "$$\n\\boxed{80}\n$$"
        },
        {
            "introduction": "最后，我们将焦点从性能权衡转向 TEE 的核心承诺：安全性。即使有强大的硬件隔离，信息仍可能通过侧信道泄露。本练习  将信息论的基本原理应用于一个真实的攻击场景——Prime+Probe 缓存攻击，以量化秘密信息可能泄露的最大速率。通过这个计算，您将学会如何严格评估在 TEE 内部署敏感应用（即使在多租户环境中）所面临的残余安全风险。",
            "id": "4252419",
            "problem": "一个安全关键信息物理系统的云托管数字孪生在可信执行环境（TEE）内部执行其状态估计工作负载。一个位于 TEE 外部的同驻对手试图通过对共享的末级缓存（LLC）发起 Prime+Probe 缓存侧信道攻击来窃取机密模型参数。每次 Prime+Probe 迭代都会使用一次噪声隐蔽信道，该信道的行为在相关时间尺度上是平稳且无记忆的。攻击者的调度器维持着 $10\\,\\mathrm{kHz}$ 的稳定探测频率，并且受控的校准实验估计离散无记忆信道的容量为每次探测 $0.5$ 比特。\n\n仅使用信息论的基本原理——具体而言，信道容量是每次信道使用可可靠传输信息的上确界，而随时间可达的信息是通过按信道使用时长进行归一化得到的——确定在错误概率消失的情况下，使用足够长的编码，攻击者可以维持的最大渐近可达泄露率，假设除了达到容量的错误控制外，协议开销可以忽略不计。\n\n以比特/秒为单位，将你的答案表示为单个实数。无需四舍五入。",
            "solution": "首先，对问题陈述进行验证。问题在信息论和计算机安全领域具有科学依据，特别是关于侧信道攻击的定量分析。问题中的概念——探测频率、离散无记忆信道、信道容量——都是信息论中的标准术语。所给定的数值（$10\\,\\mathrm{kHz}$ 频率, $0.5$ 比特/次探测的容量）是现实场景中合理的估计值。问题定义明确，要求基于香农信道容量定理计算最大渐近泄露率。问题是完整、自洽且表述客观的。\n\n问题有效。我们将继续进行求解。\n\n**原理**\n\n根据克劳德·香农的信道编码定理，一个离散无记忆信道（Discrete Memoryless Channel, DMC）的信道容量 $C$ 定义了在该信道上可以以任意低的错误概率进行可靠通信的最大速率。该容量的单位是“比特/每次信道使用”（bits per channel use）。\n\n问题指出，攻击者通过 Prime+Probe 攻击建立了一个噪声隐蔽信道，其容量经校准确定为 $C = 0.5$ 比特/次探测。这里的“一次探测”就对应于“一次信道使用”。\n\n问题还指出，攻击者以稳定的探测频率 $f$ 进行攻击。这个频率代表了每秒钟信道被使用的次数。\n$f = 10\\,\\mathrm{kHz} = 10,000\\,\\text{次探测/秒}$\n\n最大渐近可达泄露率（以比特/秒为单位），我们记为 $R_{leak}$，可以通过将每次信道使用的最大信息传输量（即信道容量 $C$）乘以每秒的信道使用次数（即探测频率 $f$）来计算。这是因为问题假设允许使用足够长的编码来逼近香农极限，并且协议开销可以忽略。\n\n**计算**\n\n泄露率的计算公式为：\n$$R_{leak} = C \\times f$$\n\n代入给定值：\n- 信道容量 $C = 0.5\\,\\text{比特/次探测}$\n- 探测频率 $f = 10\\,\\mathrm{kHz} = 10,000\\,\\text{次探测/秒}$\n\n$$R_{leak} = (0.5\\,\\text{比特/次探测}) \\times (10,000\\,\\text{次探测/秒})$$\n$$R_{leak} = 5000\\,\\text{比特/秒}$$\n\n因此，攻击者可以维持的最大渐近可达泄露率为 $5000$ 比特/秒。这个速率代表了在理论上，攻击者通过该侧信道每秒可以窃取的信息量的上限。",
            "answer": "$$\\boxed{5000}$$"
        }
    ]
}