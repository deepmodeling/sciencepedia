{
    "hands_on_practices": [
        {
            "introduction": "第一个实践旨在建立信息物理系统中统计异常检测的基本原理。通过在无攻击假设下推导卡方检验统计量的分布，您将对如何设置检测阈值以及如何量化误报率有一个核心的理解。这项练习为评估攻击的隐蔽性奠定了基础 。",
            "id": "4247729",
            "problem": "考虑一个由数字孪生（DT）监控的赛博物理系统（CPS）的离散时间、线性、时不变模型，其状态演化和传感由以下公式给出\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad y_{k} = C x_{k} + v_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{n}$ 是系统状态，$y_{k} \\in \\mathbb{R}^{m}$ 是测量值，$w_{k} \\sim \\mathcal{N}(0,Q)$ 和 $v_{k} \\sim \\mathcal{N}(0,R)$ 是相互独立的零均值高斯噪声，其协方差分别为 $Q \\succ 0$ 和 $R \\succ 0$。数字孪生采用稳态卡尔曼滤波器，其误差协方差 $P \\succeq 0$ 是离散时间代数Riccati方程（DARE）的解。令新息过程定义为\n$$\nz_{k} = y_{k} - C \\hat{x}_{k|k-1},\n$$\n其中 $\\hat{x}_{k|k-1}$ 是卡尔曼滤波器产生的一步预测状态估计。\n\n在无攻击假设下，新息协方差为\n$$\nS = C P C^{\\top} + R.\n$$\n一个基于残差的检测器计算标量检验统计量\n$$\nT_{k} = z_{k}^{\\top} S^{-1} z_{k},\n$$\n并在时间 $k$ 时，如果 $T_{k} > \\gamma$，则发出警报，其中 $\\gamma > 0$ 是一个固定阈值。\n\n任务：\n- 从高斯随机向量、线性变换的基本定义，以及在DARE解 $P$ 下稳态卡尔曼滤波器新息的特征出发，推导为什么在无攻击假设下，$T_{k}$ 服从自由度为 $m$ 的卡方分布。在您的推导中，明确阐述 $P$ 在确定 $S = C P C^{\\top} + R$ 中的作用，并解释 $S$ 如何影响 $T_{k}$ 的分布。\n- 对于测量维度 $m = 2$ 且检测器阈值 $\\gamma = 4$ 的情况，计算误报概率\n$$\n\\alpha = \\mathbb{P}\\!\\left( T_{k} > \\gamma \\,\\middle|\\, \\text{no attack} \\right).\n$$\n将 $\\alpha$ 的最终数值表示为无量纲小数。将您的答案四舍五入到四位有效数字。",
            "solution": "该系统是离散时间的、线性的，并由高斯过程和测量噪声驱动。在 $Q \\succ 0$ 和 $R \\succ 0$ 的假设下，稳态卡尔曼滤波器提供了一个最优线性估计器，其误差协方差 $P \\succeq 0$ 满足离散时间代数Riccati方程（DARE）。新息过程定义为\n$$\nz_{k} = y_{k} - C \\hat{x}_{k|k-1},\n$$\n其中 $\\hat{x}_{k|k-1}$ 是在并入 $y_{k}$ 之前的一步预测估计。在无攻击假设下，标准的稳态卡尔曼滤波器理论确定 $z_{k}$ 是一个零均值高斯随机向量，其协方差为\n$$\nS = C P C^{\\top} + R.\n$$\n这一事实源于正交性原理和线性高斯结构：新息分离出了给定先验信息的测量中的不可预测部分。矩阵 $P$ 量化了状态预测的不确定性，因此项 $C P C^{\\top}$ 捕获了由于状态预测而传播到测量空间的不确定性，而 $R$ 则加入了测量噪声。因此，$S$ 封装了以过去测量为条件的 $y_{k}$ 中的总不确定性。\n\n定义白化新息向量\n$$\nu_{k} = S^{-1/2} z_{k},\n$$\n其中 $S^{1/2}$ 是 $S$ 的任意对称正定平方根，使得 $S^{1/2} S^{1/2} = S$。由于在无攻击假设下 $z_{k} \\sim \\mathcal{N}(0,S)$，并且 $S^{-1/2}$ 是一个确定性线性变换，根据高斯随机变量在线性变换下的性质，可以得出\n$$\nu_{k} \\sim \\mathcal{N}(0, I_{m}),\n$$\n其中 $I_{m}$ 是 $m \\times m$ 的单位矩阵。因此，$u_{k}$ 的分量是独立同分布的标准正态随机变量。检验统计量可以重写为\n$$\nT_{k} = z_{k}^{\\top} S^{-1} z_{k} = \\left( S^{-1/2} z_{k} \\right)^{\\top} \\left( S^{-1/2} z_{k} \\right) = \\| u_{k} \\|^{2}.\n$$\n由于 $\\| u_{k} \\|^{2}$ 是 $m$ 个独立标准正态随机变量的平方和，$T_{k}$ 服从自由度为 $m$ 的卡方分布，记作 $\\chi^{2}_{m}$：\n$$\nT_{k} \\sim \\chi^{2}_{m} \\quad \\text{在无攻击假设下}.\n$$\n$P$ 的作用通过 $S = C P C^{\\top} + R$ 明确体现：$P$ 决定了预测不确定性如何映射到测量空间，从而设定了正确的白化变换 $S^{-1/2}$ 以对新息进行归一化。检测阈值 $\\gamma$ 是根据 $T_{k}$ 的分布来选择的，以便对于期望的误报概率 $\\alpha$，可以通过 $\\chi^{2}_{m}$ 的逆累积分布函数来设置 $\\gamma$，或者反过来，在给定 $\\gamma$ 的情况下，将 $\\alpha$ 计算为 $\\chi^{2}_{m}$ 分布的尾部概率。\n\n对于数值计算，取 $m = 2$ 和 $\\gamma = 4$。自由度为 $m = 2$ 的卡方分布是一个伽马分布，其形状参数为 $k = m/2 = 1$，尺度参数为 $\\theta = 2$。等效地，它是一个速率为 $\\lambda = 1/\\theta = 1/2$ 的指数分布。因此，对于 $X \\sim \\chi^{2}_{2}$，其生存函数（尾部概率）为\n$$\n\\mathbb{P}(X > x) = \\exp\\!\\left( -\\frac{x}{2} \\right).\n$$\n因此，对于阈值 $\\gamma$，误报概率为\n$$\n\\alpha = \\mathbb{P}\\!\\left( T_{k} > \\gamma \\right) = \\exp\\!\\left( -\\frac{\\gamma}{2} \\right) = \\exp(-2).\n$$\n计算 $\\exp(-2)$ 并四舍五入到四位有效数字，得到\n$$\n\\alpha \\approx 0.1353.\n$$\n这个值是无量纲的，因为它是一个概率。",
            "answer": "$$\\boxed{0.1353}$$"
        },
        {
            "introduction": "在基准检测器的基础上，本练习引入了一个随机攻击模型，并要求您评估检测器在受攻击时的性能。您将推导在存在对手的情况下的检验统计量分布，并实现一个算法来计算检测概率。这项实践弥合了理论分析与检测器有效性的实际数值评估之间的差距 。",
            "id": "4247799",
            "problem": "考虑一个离散时间线性时不变 (LTI) 线性高斯信息物理系统 (CPS)，其状态估计器由卡尔曼滤波器 (KF) 实现。设时间索引 $k$ 处的测量值为 $y_k = H x_k + v_k + a_k$，其中 $x_k$ 是系统状态， $H$ 是已知的测量矩阵， $v_k$ 是协方差为 $R \\succ 0$ 的零均值高斯测量噪声， $a_k$ 是协方差为 $\\Sigma_a \\succeq 0$ 的零均值高斯攻击序列，且与其他所有信号统计独立。KF 生成新息序列 $\\nu_k = y_k - H \\hat{x}_{k|k-1}$，其标称（无攻击）新息协方差为 $S = H P^- H^\\top + R \\succ 0$，其中 $P^-$ 是 KF 的先验状态误差协方差。定义标称白化新息 $w_k = S^{-1/2} \\nu_k$，其中 $S^{-1/2}$ 表示满足 $S^{-1/2} S S^{-1/2} = I$ 的唯一对称正定平方根逆矩阵。\n\n一个滑动窗口二次能量检测器应用于白化新息：\n$$\nT_t = \\sum_{k=t-m+1}^{t} w_k^\\top w_k,\n$$\n其中整数窗口长度 $m \\ge 1$。假设 KF 处于稳态，并且新息序列在标称操作下是时间上不相关的。同时假设攻击过程 $\\{a_k\\}$ 是时间独立的，并且独立于 $\\{v_k\\}$ 和 KF 的预测误差。如果 $T_t \\ge \\gamma$，检测器在时间 $t$ 发出警报，其中 $\\gamma$ 是为达到指定的虚警概率 (PFA) 而选择的阈值。\n\n任务：\n1) 从 KF 的标准属性出发，即在标称操作（$a_k = 0$）下，新息 $\\nu_k$ 是协方差为 $S$ 的零均值高斯且时间白的，推导 $T_t$ 在标称操作下的分布。然后，对于给定的虚警水平 $\\alpha \\in (0,1)$，将阈值 $\\gamma$ 表示为 $\\alpha$ 和问题参数的函数。\n\n2) 在受攻击情况（$a_k \\sim \\mathcal{N}(0,\\Sigma_a)$，在 $k$上独立）下，首先刻画 $w_k$ 的协方差，然后将其对角化，从而推导出 $T_t$ 的精确分布。您的推导必须以用已知分布的基本随机变量来表示 $T_t$ 的分布作为结论。\n\n3) 设计一个算法，在给定 $(S,\\Sigma_a,m,\\alpha)$ 的情况下，使用您推导出的精确分布计算检测概率 (PD)，定义为 $\\mathbb{P}(T_t \\ge \\gamma \\mid \\text{受攻击})$。您的算法不得依赖于绕过推导的渐近近似；它应根据精确的有限样本分布计算尾概率。您可以使用适用于高斯随机变量二次型的数值稳定的积分表示。\n\n实现要求：\n- 您的程序必须实现该算法，并在以下测试套件上进行评估。对于每种情况，计算检测概率（以浮点数表示）。不涉及物理单位。\n- 使用标称新息协方差\n$$\nS = \\begin{bmatrix} 2.0 & 0.5 \\\\ 0.5 & 1.5 \\end{bmatrix}.\n$$\n- 测试套件参数集 $(\\Sigma_a, m, \\alpha)$：\n  - 情况 1：$\\Sigma_a = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$，$m = 10$，$\\alpha = 0.05$。\n  - 情况 2：$\\Sigma_a = 0.2 I_2$，$m = 10$，$\\alpha = 0.05$。\n  - 情况 3：$\\Sigma_a = \\begin{bmatrix} 0.5 & 0.3 \\\\ 0.3 & 0.5 \\end{bmatrix}$，$m = 10$，$\\alpha = 0.01$。\n  - 情况 4：$\\Sigma_a = 0.5 I_2$，$m = 1$，$\\alpha = 0.05$。\n  - 情况 5：$\\Sigma_a = 0.1 I_2$，$m = 30$，$\\alpha = 0.05$。\n\n输出规范：\n- 对于每种情况，以 $[0,1]$ 范围内的浮点数形式返回检测概率。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，并四舍五入到六位小数，按情况 1 到 5 的顺序排列（例如，“[0.050000,0.123456,0.987654,0.111111,0.222222]”）。",
            "solution": "该问题要求在一个信息物理系统中，针对隐蔽攻击下的二次检测器，推导和计算其检测概率。解决方案按问题陈述的要求分为三部分呈现。\n\n### 第 1 部分：标称分布和检测阈值\n\n在标称条件（假设 $H_0$）下，攻击序列 $a_k$ 为零，即 $a_k = 0$。卡尔曼滤波器 (KF) 的新息序列由 $\\nu_k = y_k - H \\hat{x}_{k|k-1}$ 给出。问题陈述指出，在 $H_0$ 下且 KF 处于稳态时，新息是一个协方差为 $S$ 的零均值高斯白噪声过程，因此 $\\nu_k \\sim \\mathcal{N}(0, S)$。\n\n标称白化新息为 $w_k = S^{-1/2} \\nu_k$，其中 $S^{-1/2}$ 是 $S$ 的对称正定平方根逆矩阵。由于 $\\nu_k$ 是一个高斯随机向量，因此 $w_k$ 也是高斯向量。其均值为 $\\mathbb{E}[w_k] = S^{-1/2} \\mathbb{E}[\\nu_k] = 0$。其协方差为：\n$$\n\\text{Cov}(w_k) = \\mathbb{E}[w_k w_k^\\top] = S^{-1/2} \\mathbb{E}[\\nu_k \\nu_k^\\top] (S^{-1/2})^\\top = S^{-1/2} S S^{-1/2} = I\n$$\n因此，在 $H_0$ 下，白化新息是标准正态向量，$w_k \\sim \\mathcal{N}(0, I_p)$，其中 $p$ 是测量向量 $y_k$ 的维度。根据给定的矩阵 $S$，我们有 $p=2$。\n\n检验统计量 $T_t$ 是这些向量的二次型之和：$T_t = \\sum_{k=t-m+1}^{t} w_k^\\top w_k$。每一项 $w_k^\\top w_k$ 是 $p$ 个独立标准正态随机变量的平方和。根据定义，这服从自由度为 $p$ 的卡方分布，即 $w_k^\\top w_k \\sim \\chi^2_p$。\n\n问题陈述指出，标称新息序列是时间上不相关的，这意味着序列 $\\{w_k\\}$ 也是时间上不相关的（并且由于是高斯过程，因此是独立的）。因此，$T_t$ 是 $m$ 个独立同分布 (i.i.d.) 随机变量的和，每个变量都服从 $\\chi^2_p$ 分布。独立卡方随机变量的和也是一个卡方随机变量，其自由度是个体自由度之和。因此，检验统计量在 $H_0$ 下的分布是：\n$$\nT_t \\mid H_0 \\sim \\chi^2_{mp}\n$$\n虚警概率 (PFA) 为 $\\alpha = \\mathbb{P}(T_t \\ge \\gamma \\mid H_0)$。因此，阈值 $\\gamma$ 被选为使 $\\chi^2_{mp}$ 分布的上尾概率等于 $\\alpha$ 的值。这可以用卡方分布的分位数函数（或逆累积分布函数）表示，记为 $F_{\\chi^2_{df}}^{-1}(\\cdot)$:\n$$\n\\gamma = F_{\\chi^2_{mp}}^{-1}(1-\\alpha)\n$$\n\n### 第 2 部分：受攻击时的分布\n\n在受攻击情况（假设 $H_1$）下，攻击序列 $a_k$ 是一个协方差为 $\\Sigma_a$ 的零均值高斯过程，即 $a_k \\sim \\mathcal{N}(0, \\Sigma_a)$。新息为 $\\nu_k = y_k - H \\hat{x}_{k|k-1} = (H x_k + v_k - H \\hat{x}_{k|k-1}) + a_k = \\nu_k^{\\text{nom}} + a_k$，其中 $\\nu_k^{\\text{nom}}$ 是标称新息。\n\n鉴于 $a_k$ 与所有其他信号独立，它也与 $\\nu_k^{\\text{nom}}$ 独立。由于两者均为零均值，受攻击的新息 $\\nu_k$ 也是零均值。其协方差是各自协方差之和：\n$$\n\\text{Cov}(\\nu_k \\mid H_1) = \\text{Cov}(\\nu_k^{\\text{nom}}) + \\text{Cov}(a_k) = S + \\Sigma_a\n$$\n在 $H_1$ 下，白化新息 $w_k = S^{-1/2} \\nu_k$ 是一个零均值高斯向量，其协方差为：\n$$\n\\Sigma_w = \\text{Cov}(w_k \\mid H_1) = S^{-1/2} (S + \\Sigma_a) S^{-1/2} = I + S^{-1/2} \\Sigma_a S^{-1/2}\n$$\n我们用 $C = I + S^{-1/2} \\Sigma_a S^{-1/2}$ 表示这个协方差矩阵。由于 $S$ 是正定的，$\\Sigma_a$ 是半正定的，所以 $C$ 是一个对称正定矩阵。\n\n项 $w_k^\\top w_k$ 是高斯向量 $w_k \\sim \\mathcal{N}(0, C)$ 的二次型。为了找到其分布，我们使用特征分解将 $C$ 对角化：$C = Q \\Lambda Q^\\top$，其中 $Q$ 是特征向量构成的正交矩阵，$\\Lambda = \\text{diag}(\\lambda_1, \\dots, \\lambda_p)$ 是相应特征值构成的对角矩阵。我们定义一个新的随机向量 $z_k = Q^\\top w_k$。$z_k$ 的协方差为 $\\text{Cov}(z_k) = Q^\\top C Q = Q^\\top (Q \\Lambda Q^\\top) Q = \\Lambda$。因此，$z_k \\sim \\mathcal{N}(0, \\Lambda)$，这意味着其分量 $z_{k,i}$ 是独立的，且 $z_{k,i} \\sim \\mathcal{N}(0, \\lambda_i)$ 的高斯随机变量。\n\n二次型现在可以表示为：\n$$\nw_k^\\top w_k = (Q z_k)^\\top (Q z_k) = z_k^\\top Q^\\top Q z_k = z_k^\\top z_k = \\sum_{i=1}^{p} z_{k,i}^2\n$$\n每一项 $z_{k,i}^2$ 是一个 $\\mathcal{N}(0, \\lambda_i)$ 变量的平方，其分布为一个自由度的卡方变量的 $\\lambda_i$ 倍，即 $z_{k,i}^2 \\sim \\lambda_i \\chi^2_1$。\n\n检验统计量 $T_t = \\sum_{k=t-m+1}^{t} w_k^\\top w_k$。由于攻击过程 $\\{a_k\\}$ 是时间独立的，受攻击的新息序列 $\\{\\nu_k\\}$ 也是时间独立的，$\\{w_k\\}$ 同样如此。因此，$T_t$ 是随机变量 $w_k^\\top w_k$ 的 $m$ 次独立同分布 (i.i.d.) 抽样之和。\n$$\nT_t = \\sum_{k=t-m+1}^{t} \\sum_{i=1}^{p} z_{k,i}^2 = \\sum_{i=1}^{p} \\sum_{k=t-m+1}^{t} z_{k,i}^2\n$$\n对于固定的索引 $i$，和 $\\sum_{k=t-m+1}^{t} z_{k,i}^2$ 是 $m$ 个独立同分布随机变量的和，每个变量都服从 $\\lambda_i \\chi^2_1$ 分布。这个和在分布上等价于 $\\lambda_i$ 乘以 $m$ 个独立同分布 $\\chi^2_1$ 变量之和，即一个 $\\chi^2_m$ 变量。令 $X_i = \\sum_{k=t-m+1}^{t} (z_{k,i}/\\sqrt{\\lambda_i})^2 \\sim \\chi^2_m$。变量 $\\{X_i\\}_{i=1}^p$ 是独立的。因此，$T_t$ 在受攻击情况下的分布是独立卡方变量的加权和（一个广义卡方分布）：\n$$\nT_t \\mid H_1 \\sim \\sum_{i=1}^{p} \\lambda_i X_i, \\quad \\text{其中 } X_i \\sim \\chi^2_m \\text{ 且相互独立}\n$$\n权重 $\\lambda_i$ 是矩阵 $C = I + S^{-1/2} \\Sigma_a S^{-1/2}$ 的特征值。\n\n### 第 3 部分：检测概率的算法\n\n检测概率 (PD) 为 $\\mathbb{P}(T_t \\ge \\gamma \\mid H_1)$。算法流程如下：\n1.  **计算阈值**：给定 $m$、$p$ 和 $\\alpha$，计算检测阈值 $\\gamma = F_{\\chi^2_{mp}}^{-1}(1-\\alpha)$。\n2.  **确定权重**：给定 $S$ 和 $\\Sigma_a$，计算矩阵 $C = I + S^{-1/2}\\Sigma_a S^{-1/2}$ 并求其特征值 $\\lambda_1, \\dots, \\lambda_p$。\n3.  **计算尾概率**：计算 $\\text{PD} = \\mathbb{P}(\\sum_{i=1}^p \\lambda_i X_i \\ge \\gamma)$。由于该分布没有闭式累积分布函数 (CDF)，我们使用一种基于特征函数 $\\phi_{T_t}(u) = \\mathbb{E}[e^{juT_t}]$ 反演的数值方法。$X_i \\sim \\chi^2_m$ 的特征函数为 $\\phi_{X_i}(u) = (1 - 2ju)^{-m/2}$。由于独立性，$T_t$ 的特征函数是每一项 $\\lambda_i X_i$ 特征函数的乘积：\n    $$\n    \\phi_{T_t}(u) = \\prod_{i=1}^{p} \\phi_{X_i}(\\lambda_i u) = \\prod_{i=1}^{p} (1 - 2ju\\lambda_i)^{-m/2}\n    $$\n    Gil-Pelaez 反演公式将 CDF $F_{T_t}(\\gamma)$ 与其特征函数联系起来：\n    $$\n    F_{T_t}(\\gamma) = \\frac{1}{2} - \\frac{1}{\\pi} \\int_0^\\infty \\text{Im}\\left[ \\frac{e^{-ju\\gamma}\\phi_{T_t}(u)}{u} \\right] du\n    $$\n    检测概率是互补累积分布函数，$\\text{PD} = 1 - F_{T_t}(\\gamma)$：\n    $$\n    \\text{PD} = \\frac{1}{2} + \\frac{1}{\\pi} \\int_0^\\infty \\text{Im}\\left[ \\frac{e^{-ju\\gamma}\\phi_{T_t}(u)}{u} \\right] du = \\frac{1}{2} + \\frac{1}{\\pi} \\int_0^\\infty \\frac{\\sin(\\theta(u) - u\\gamma)}{u} A(u) \\,du\n    $$\n    其中 $A(u) = |\\phi_{T_t}(u)| = \\prod_{i=1}^p (1 + 4u^2\\lambda_i^2)^{-m/4}$ 且 $\\theta(u) = \\arg(\\phi_{T_t}(u)) = \\sum_{i=1}^p \\frac{m}{2} \\arctan(2u\\lambda_i)$。该积分通过数值方法计算。算法涉及实现这些步骤，使用数值库找到分位数 $\\gamma$，进行矩阵运算和特征值计算，并执行最终的数值积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats, linalg, integrate\n\ndef solve():\n    \"\"\"\n    Computes the probability of detection for a quadratic energy detector\n    in a cyber-physical system under various attack scenarios.\n    \"\"\"\n    # Define the nominal innovation covariance matrix S\n    S = np.array([\n        [2.0, 0.5],\n        [0.5, 1.5]\n    ])\n\n    # Dimension of the measurement vector\n    p = S.shape[0]\n\n    # Test suite parameter sets (Sigma_a, m, alpha)\n    test_cases = [\n        (np.zeros((2, 2)), 10, 0.05),\n        (0.2 * np.eye(2), 10, 0.05),\n        (np.array([[0.5, 0.3], [0.3, 0.5]]), 10, 0.01),\n        (0.5 * np.eye(2), 1, 0.05),\n        (0.1 * np.eye(2), 30, 0.05)\n    ]\n\n    # Pre-compute S^(-1/2) as it is constant for all test cases.\n    # This is done via eigenvalue decomposition for numerical stability and correctness.\n    eigvals_S, eigvecs_S = linalg.eigh(S)\n    D_inv_sqrt = np.diag(1.0 / np.sqrt(eigvals_S))\n    S_inv_sqrt = eigvecs_S @ D_inv_sqrt @ eigvecs_S.T\n\n    results = []\n    for Sigma_a, m, alpha in test_cases:\n        # Part 1: Compute detection threshold gamma from the nominal distribution\n        df_nominal = m * p\n        gamma = stats.chi2.ppf(1 - alpha, df_nominal)\n\n        # Case 1 (no attack): The probability of detection (PD) is equal to the\n        # probability of false alarm (PFA) by definition.\n        if np.all(Sigma_a == 0):\n            results.append(alpha)\n            continue\n\n        # Part 2: Characterize attacked distribution by finding eigenvalues (weights)\n        # Compute covariance C = I + S^(-1/2) * Sigma_a * S^(-1/2)\n        C = np.eye(p) + S_inv_sqrt @ Sigma_a @ S_inv_sqrt\n        \n        # Eigenvalues of C are the weights of the generalized chi-squared distribution.\n        # Use eigvalsh for symmetric matrices.\n        lambdas = linalg.eigvalsh(C)\n\n        # Part 3: Compute Probability of Detection (PD) using Gil-Pelaez formula\n        # PD = P(T_t >= gamma | H1), where T_t follows a generalized chi-squared dist.\n        \n        # Characteristic function phi(u) = A(u) * exp(j * theta(u))\n        # The phase component\n        def theta(u):\n            return np.sum(0.5 * m * np.arctan(2 * u * lambdas))\n\n        # The magnitude component (calculated with logs for numerical stability)\n        def A(u):\n            log_A = np.sum(-0.25 * m * np.log1p(4 * (u**2) * (lambdas**2)))\n            return np.exp(log_A)\n\n        # Define the integrand for the Gil-Pelaez formula.\n        # The integrand is Im[exp(-ju*gamma)*phi(u)/u].\n        def integrand(u):\n            # Analytically determine the limit at u=0 to avoid division by zero.\n            # As u->0, sin(x) ~ x. The integrand approaches m*sum(lambdas) - gamma.\n            if u  1e-12:\n                return m * np.sum(lambdas) - gamma\n            \n            phase = theta(u) - u * gamma\n            magnitude = A(u) / u\n            return magnitude * np.sin(phase)\n\n        # Perform numerical integration from 0 to infinity.\n        # quad is a robust numerical integrator from SciPy.\n        integral_val, _ = integrate.quad(integrand, 0, np.inf, limit=200)\n\n        # Final PD calculation: PD = 0.5 + (1/pi) * integral\n        pd = 0.5 + integral_val / np.pi\n        \n        # Clamp PD to [0, 1] to handle any minor numerical inaccuracies.\n        pd = np.clip(pd, 0, 1)\n\n        results.append(pd)\n\n    # Format output as a single line with 6 decimal places per result.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的实践将视角从防御者转向攻击者，探讨一种利用系统物理定律知识的更复杂的攻击策略。您将分析攻击者如何协同操纵多个传感器，以对基于不变量的检测器保持完全隐蔽。该练习突出了理解系统结构在设计弹性防御和强大攻击中的关键重要性，揭示了监控系统的代数“盲点” 。",
            "id": "4247770",
            "problem": "一个信息物理系统 (CPS) 由一个数字孪生 (DT) 监控，该数字孪生对从 $n$ 个物理传感器聚合的测量向量 $\\mathbf{y} \\in \\mathbb{R}^{n}$ 强制执行线性不变量。在标称操作下，真实状态 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 遵循由约束矩阵 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ 表示的一组 $m$ 个线性不变量，因此有 $\\mathbf{A}\\mathbf{x} = \\mathbf{0}$。DT 使用统计量 $\\mathbf{r} = \\mathbf{A}\\mathbf{y}$ 执行基于残差的监控，其中 $\\mathbf{y} = \\mathbf{x} + \\mathbf{w}$ 且测量噪声 $\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$。检测是通过似然比检验 (LRT) 实现的，如果二次型 $J = \\mathbf{r}^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}\\mathbf{r}$ 超过一个阈值，则拒绝原假设。其中 $\\boldsymbol{\\Sigma}_{r} = \\sigma^{2}\\mathbf{A}\\mathbf{A}^{\\top}$ 是残差协方差。\n\n一个攻击者通过添加一个攻击向量 $\\mathbf{a} \\in \\mathbb{R}^{n}$ 发起了一次协同的多传感器操纵，该向量的支撑集为 $\\operatorname{supp}(\\mathbf{a}) \\subseteq \\{1,2,\\dots,n\\}$，从而产生被攻击的测量值 $\\mathbf{y}^{\\prime} = \\mathbf{x} + \\mathbf{w} + \\mathbf{a}$。攻击者的目标是在测量噪声下，在检测层面保持不变量，即在攻击下的检测统计量 $J$ 的分布与标称条件下的分布完全相同。\n\n1. 从高斯噪声模型和基于残差的LRT出发，推导攻击向量 $\\mathbf{a}$ 使得 $J$ 的分布不受攻击影响的充分必要条件。您的推导必须明确地将此条件与约束矩阵 $\\mathbf{A}$ 的线性代数结构联系起来。\n\n2. 考虑 $n = 5$ 个传感器和 $m = 2$ 个不变量，其约束矩阵如下\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1  1  0  2  1 \\\\\n0  1  1  1  2\n\\end{pmatrix}.\n$$\n在您于第1部分中推导出的条件下，确定要实现一个在测量噪声下保持检测层面不变量的非零攻击 $\\mathbf{a} \\neq \\mathbf{0}$，必须同时操纵的传感器的最小数量（即 $\\operatorname{supp}(\\mathbf{a})$ 的最小基数）。\n\n将您的最终答案表示为代表操纵集最小基数的单个整数。无需四舍五入，最终答案中不应包含单位。",
            "solution": "该问题要求两个主要结果：首先，推导攻击向量 $\\mathbf{a}$ 的条件，使得基于残差的检测统计量 $J$ 在攻击下的分布与在标称（无攻击）条件下的分布相同。其次，将此条件应用于特定系统，以找到实现非平凡隐蔽攻击所需的最少被操纵传感器数量。\n\n### 第1部分：隐蔽攻击条件的推导\n\n我们首先描述标称条件下检测统计量 $J$ 的特性。测量值由 $\\mathbf{y} = \\mathbf{x} + \\mathbf{w}$ 给出，其中 $\\mathbf{x}$ 是真实状态，$\\mathbf{w}$ 是测量噪声。假设噪声向量 $\\mathbf{w}$ 服从多元正态分布，$\\mathbf{w} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$。\n\n残差 $\\mathbf{r}$ 计算为 $\\mathbf{r} = \\mathbf{A}\\mathbf{y}$。代入 $\\mathbf{y}$ 的表达式并使用不变量性质 $\\mathbf{A}\\mathbf{x} = \\mathbf{0}$：\n$$\n\\mathbf{r} = \\mathbf{A}(\\mathbf{x} + \\mathbf{w}) = \\mathbf{A}\\mathbf{x} + \\mathbf{A}\\mathbf{w} = \\mathbf{0} + \\mathbf{A}\\mathbf{w} = \\mathbf{A}\\mathbf{w}\n$$\n由于 $\\mathbf{r}$ 是高斯随机向量 $\\mathbf{w}$ 的线性变换，因此 $\\mathbf{r}$ 也是一个高斯随机向量。其均值为：\n$$\nE[\\mathbf{r}] = E[\\mathbf{A}\\mathbf{w}] = \\mathbf{A}E[\\mathbf{w}] = \\mathbf{A}\\mathbf{0} = \\mathbf{0}\n$$\n其协方差矩阵，记为 $\\boldsymbol{\\Sigma}_{r}$，为：\n$$\n\\boldsymbol{\\Sigma}_{r} = \\operatorname{Cov}(\\mathbf{r}) = E[\\mathbf{r}\\mathbf{r}^{\\top}] - E[\\mathbf{r}]E[\\mathbf{r}]^{\\top} = E[(\\mathbf{A}\\mathbf{w})(\\mathbf{A}\\mathbf{w})^{\\top}] = E[\\mathbf{A}\\mathbf{w}\\mathbf{w}^{\\top}\\mathbf{A}^{\\top}]\n$$\n$$\n\\boldsymbol{\\Sigma}_{r} = \\mathbf{A}E[\\mathbf{w}\\mathbf{w}^{\\top}]\\mathbf{A}^{\\top} = \\mathbf{A}(\\sigma^{2}\\mathbf{I}_{n})\\mathbf{A}^{\\top} = \\sigma^{2}\\mathbf{A}\\mathbf{A}^{\\top}\n$$\n这与问题陈述中给出的定义相符。因此，在标称条件下，残差向量服从分布 $\\mathbf{r} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma}_{r})$。\n检测统计量为 $J = \\mathbf{r}^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}\\mathbf{r}$。这是一个零均值多元正态向量的二次型。$J$ 的分布是自由度为 $m$ 的中心卡方分布，其中 $m$ 是残差向量 $\\mathbf{r}$ 的维度。我们将其写作 $J \\sim \\chi_{m}^{2}$。\n\n现在，我们来分析受攻击下的系统。被攻击的测量向量为 $\\mathbf{y}^{\\prime} = \\mathbf{x} + \\mathbf{w} + \\mathbf{a}$。攻击下的残差 $\\mathbf{r}^{\\prime}$ 为：\n$$\n\\mathbf{r}^{\\prime} = \\mathbf{A}\\mathbf{y}^{\\prime} = \\mathbf{A}(\\mathbf{x} + \\mathbf{w} + \\mathbf{a}) = \\mathbf{A}\\mathbf{x} + \\mathbf{A}\\mathbf{w} + \\mathbf{A}\\mathbf{a} = \\mathbf{A}\\mathbf{w} + \\mathbf{A}\\mathbf{a}\n$$\n项 $\\mathbf{A}\\mathbf{a}$ 是一个常数向量。因此，$\\mathbf{r}^{\\prime}$ 的分布是 $\\mathbf{A}\\mathbf{w}$ 分布的平移版本。其均值为：\n$$\nE[\\mathbf{r}^{\\prime}] = E[\\mathbf{A}\\mathbf{w} + \\mathbf{A}\\mathbf{a}] = \\mathbf{A}E[\\mathbf{w}] + \\mathbf{A}\\mathbf{a} = \\mathbf{A}\\mathbf{a}\n$$\n$\\mathbf{r}^{\\prime}$ 的协方差不受常数平移的影响：\n$$\n\\operatorname{Cov}(\\mathbf{r}^{\\prime}) = \\operatorname{Cov}(\\mathbf{A}\\mathbf{w} + \\mathbf{A}\\mathbf{a}) = \\operatorname{Cov}(\\mathbf{A}\\mathbf{w}) = \\boldsymbol{\\Sigma}_{r}\n$$\n所以，在攻击下，残差向量服从分布 $\\mathbf{r}^{\\prime} \\sim \\mathcal{N}(\\mathbf{A}\\mathbf{a}, \\boldsymbol{\\Sigma}_{r})$。\n攻击下的检测统计量 $J^{\\prime}$ 为 $J^{\\prime} = (\\mathbf{r}^{\\prime})^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}(\\mathbf{r}^{\\prime})$。$J^{\\prime}$ 的分布是非中心卡方分布，$J^{\\prime} \\sim \\chi_{m}^{2}(\\lambda)$，其自由度为 $m$，非中心参数 $\\lambda$ 由下式给出：\n$$\n\\lambda = (E[\\mathbf{r}^{\\prime}])^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}(E[\\mathbf{r}^{\\prime}]) = (\\mathbf{A}\\mathbf{a})^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}(\\mathbf{A}\\mathbf{a})\n$$\n攻击者的目标是使攻击下的 $J$ 的分布与标称条件下的分布相同。这意味着 $\\chi_{m}^{2}(\\lambda)$ 必须与 $\\chi_{m}^{2}$ 相同。中心卡方分布是非中心卡方分布在非中心参数为零时的特例。因此，分布相同的条件是 $\\lambda = 0$。\n$$\n(\\mathbf{A}\\mathbf{a})^{\\top}\\boldsymbol{\\Sigma}_{r}^{-1}(\\mathbf{A}\\mathbf{a}) = 0\n$$\n协方差矩阵 $\\boldsymbol{\\Sigma}_{r} = \\sigma^{2}\\mathbf{A}\\mathbf{A}^{\\top}$ 是正定的，前提是矩阵 $\\mathbf{A}$ 具有满行秩（即其 $m$ 行线性无关），这是对一组良定义不变量的标准假设。如果 $\\boldsymbol{\\Sigma}_{r}$ 是正定的，其逆矩阵 $\\boldsymbol{\\Sigma}_{r}^{-1}$ 也是正定的。\n当 $\\mathbf{M}$ 是一个正定矩阵时，二次型 $\\mathbf{v}^{\\top}\\mathbf{M}\\mathbf{v}$ 等于零的充分必要条件是向量 $\\mathbf{v}$ 是零向量。在我们的例子中，$\\mathbf{v} = \\mathbf{A}\\mathbf{a}$ 且 $\\mathbf{M} = \\boldsymbol{\\Sigma}_{r}^{-1}$。\n因此，条件 $\\lambda = 0$ 等价于：\n$$\n\\mathbf{A}\\mathbf{a} = \\mathbf{0}\n$$\n这就是对攻击向量 $\\mathbf{a}$ 的充分必要条件。用线性代数的术语来说，攻击向量 $\\mathbf{a}$ 必须位于约束矩阵 $\\mathbf{A}$ 的零空间中，即 $\\mathbf{a} \\in \\operatorname{null}(\\mathbf{A})$。\n\n### 第2部分：最少被操纵传感器数量\n\n我们已知有 $n=5$ 个传感器，$m=2$ 个不变量，以及约束矩阵：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1  1  0  2  1 \\\\\n0  1  1  1  2\n\\end{pmatrix}\n$$\n我们寻找一个非零攻击向量 $\\mathbf{a} = (a_1, a_2, a_3, a_4, a_5)^{\\top}$，使得 $\\mathbf{A}\\mathbf{a} = \\mathbf{0}$，并且 $\\mathbf{a}$ 中非零分量的数量（其支撑集的基数 $|\\operatorname{supp}(\\mathbf{a})|$）最小化。这个最小数量被称为矩阵 $\\mathbf{A}$ 的 spark，记作 $\\operatorname{spark}(\\mathbf{A})$。它是 $\\mathbf{A}$ 的列向量中线性相关所需的最小列数。\n\n设 $\\mathbf{A}$ 的列向量为 $\\mathbf{c}_1, \\mathbf{c}_2, \\mathbf{c}_3, \\mathbf{c}_4, \\mathbf{c}_5$：\n$$\n\\mathbf{c}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\mathbf{c}_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\mathbf{c}_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\mathbf{c}_4 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\mathbf{c}_5 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n条件 $\\mathbf{A}\\mathbf{a} = \\mathbf{0}$ 可以写成列向量的线性组合：\n$$\na_1\\mathbf{c}_1 + a_2\\mathbf{c}_2 + a_3\\mathbf{c}_3 + a_4\\mathbf{c}_4 + a_5\\mathbf{c}_5 = \\mathbf{0}\n$$\n我们需要找到这个方程中非零系数 $a_i$ 的最小数量。\n\n- **最小基数为1：**\n对于只有一个被操纵传感器（比如 $a_i \\neq 0$）的非零攻击，需要满足 $a_i\\mathbf{c}_i = \\mathbf{0}$。这意味着 $\\mathbf{c}_i = \\mathbf{0}$。检查 $\\mathbf{A}$ 的各列，没有一个是零向量。因此，最小基数必须大于1。\n\n- **最小基数为2：**\n对于有两个被操纵传感器（比如 $a_i \\neq 0$ 和 $a_j \\neq 0$）的非零攻击，需要满足 $a_i\\mathbf{c}_i + a_j\\mathbf{c}_j = \\mathbf{0}$。这等价于 $\\mathbf{c}_i = -\\frac{a_j}{a_i}\\mathbf{c}_j$，意味着列向量 $\\mathbf{c}_i$ 和 $\\mathbf{c}_j$ 必须线性相关（共线）。我们可以检查所有列向量对。通过观察，没有哪一列是另一列的标量倍数。例如，对于 $\\mathbf{c}_1 = (1, 0)^{\\top}$，其任何标量倍数都是 $(k, 0)^{\\top}$ 的形式，与其他任何列都不匹配。对于 $\\mathbf{c}_2 = (1, 1)^{\\top}$，其倍数是 $(k, k)^{\\top}$ 的形式，也不匹配任何其他列。这个推理适用于所有列向量对。因此，最小基数必须大于2。\n\n- **最小基数为3：**\n对于有三个被操纵传感器（比如 $a_i, a_j, a_k \\neq 0$）的攻击，需要满足 $a_i\\mathbf{c}_i + a_j\\mathbf{c}_j + a_k\\mathbf{c}_k = \\mathbf{0}$。这意味着列向量集合 $\\{\\mathbf{c}_i, \\mathbf{c}_j, \\mathbf{c}_k\\}$ 必须是线性相关的。由于这些列向量是 $\\mathbb{R}^2$ 中的向量，任何三个向量的集合都必然是线性相关的。问题在于是否存在一个所有系数都非零的线性组合。我们来测试前三列：$\\{\\mathbf{c}_1, \\mathbf{c}_2, \\mathbf{c}_3\\}$。我们寻找非零标量 $k_1, k_2, k_3$ 使得 $k_1\\mathbf{c}_1 + k_2\\mathbf{c}_2 + k_3\\mathbf{c}_3 = \\mathbf{0}$。\n$$\nk_1\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + k_2\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + k_3\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了线性方程组：\n$$\n\\begin{cases} k_1 + k_2 = 0 \\\\ k_2 + k_3 = 0 \\end{cases}\n$$\n从这个方程组中，我们得到 $k_1 = -k_2$ 和 $k_3 = -k_2$。我们可以为 $k_2$ 选择一个非零值，例如 $k_2 = -1$。这得到 $k_1 = 1$ 和 $k_3 = 1$。所有三个系数都非零。\n这对应于攻击向量 $\\mathbf{a} = (k_1, k_2, k_3, 0, 0)^{\\top} = (1, -1, 1, 0, 0)^{\\top}$。\n这是一个非零攻击向量，$\\mathbf{a} \\neq \\mathbf{0}$。非零分量的数量是3。我们来验证它是否满足条件 $\\mathbf{A}\\mathbf{a} = \\mathbf{0}$：\n$$\n\\mathbf{A}\\mathbf{a} = \\begin{pmatrix}\n1  1  0  2  1 \\\\\n0  1  1  1  2\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n= \\begin{pmatrix}\n1(1) + 1(-1) + 0(1) \\\\\n0(1) + 1(-1) + 1(1)\n\\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n条件得到满足。既然我们已经证明了基数为1和2是不可能的，并且我们找到了一个基数为3的有效非零攻击向量，那么同时被操纵的传感器的最小数量就是3。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}