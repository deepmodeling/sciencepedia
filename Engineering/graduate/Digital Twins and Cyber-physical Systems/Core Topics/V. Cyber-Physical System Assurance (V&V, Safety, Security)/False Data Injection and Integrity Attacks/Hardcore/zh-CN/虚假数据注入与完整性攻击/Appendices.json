{
    "hands_on_practices": [
        {
            "introduction": "要真正理解虚假数据注入（FDI）攻击，最好的方法莫过于亲手构建一个。本练习将引导你完成这一基本过程。我们将从一个静态的加权最小二乘（WLS）状态估计器入手，揭示其代数结构中的脆弱性，即攻击向量如何通过藏身于测量矩阵 $H$ 的列空间中来保持“隐身”。通过本练习，你将学会如何精确地构造一个攻击向量，以改变特定的状态估计值，同时确保该攻击能够骗过标准的残差检测机制。",
            "id": "4221503",
            "problem": "考虑一个信息物理系统 (CPS) 的数字孪生 (DT)，该数字孪生使用线性加权最小二乘 (WLS) 方法进行状态估计。其测量模型为 $y = H x + \\varepsilon$，其中 $y \\in \\mathbb{R}^{m}$ 是测量向量，$x \\in \\mathbb{R}^{n}$ 是状态向量，$H \\in \\mathbb{R}^{m \\times n}$ 是测量矩阵，$\\varepsilon \\in \\mathbb{R}^{m}$ 是零均值测量噪声，其协方差矩阵 $R \\in \\mathbb{R}^{m \\times m}$ 是对称正定的。该 DT 的估计器通过最小化二次型 $(y - H x)^{\\top} R^{-1} (y - H x)$ 来进行估计，并且在整个运行过程中使用相同的 $H$ 和 $R$。\n\n一个攻击者通过向测量值中添加一个攻击向量 $a \\in \\mathbb{R}^{m}$ 来发起虚假数据注入 (FDI) 攻击，产生 $y' = y + a$。攻击者寻求一种隐蔽攻击，即根据 $y'$ 计算出的估计器残差与根据 $y$ 计算出的残差完全相同。从 WLS 公式和残差的定义出发，推导保证这种隐蔽性的对 $a$ 的约束条件。然后，在该隐蔽约束下，论证如何构造一个攻击，在不改变残差的情况下，将估计的状态移动一个选定的向量；并特别说明，如何精确地将状态向量的一个分量移动一个指定的量，而保持所有其他分量不变。\n\n现在，将问题具体化到以下实例，其中 $m = 5$ 且 $n = 3$。测量矩阵 $H \\in \\mathbb{R}^{5 \\times 3}$ 和噪声协方差 $R \\in \\mathbb{R}^{5 \\times 5}$ 为\n$$\nH = \\begin{pmatrix}\n1  2  0 \\\\\n0  3  1 \\\\\n0  0  4 \\\\\n5  0  0 \\\\\n0  6  7\n\\end{pmatrix}, \\quad\nR = \\operatorname{diag}(1, 2, 3, 4, 5).\n$$\n假设 $H$ 具有满列秩。攻击者希望将 DT 对第二个状态分量 $x_{2}$ 的估计值改变一个固定量 $\\Delta = 1$，同时保持所有其他估计的状态分量不变，并保持攻击的隐蔽性。在所有能实现此目标的隐蔽攻击向量中，确定攻击向量 $a$ 的最小 $\\ell_{0}$ 基数，其中 $\\ell_{0}$ 基数 $\\|a\\|_{0}$ 定义为 $a$ 中非零元素的数量。请将您的最终答案表示为单个整数。无需四舍五入，也无需单位。",
            "solution": "本题要求我们分析针对线性加权最小二乘 (WLS) 状态估计器的虚假数据注入 (FDI) 攻击。我们必须首先推导出一个能够操纵状态估计的隐蔽攻击的一般条件，然后将其应用于一个具体的数值案例，以找到所需攻击向量的最小稀疏性。\n\nWLS 状态估计值 $\\hat{x}$ 是使目标函数 $J(x) = (y - Hx)^{\\top} R^{-1} (y - Hx)$ 最小化的向量。为了找到最小值，我们将 $J(x)$ 对 $x$ 的梯度设为零。\n$$\n\\frac{dJ(x)}{dx} = -2H^{\\top} R^{-1} (y - Hx) = 0\n$$\n这导出了正规方程组：\n$$\nH^{\\top} R^{-1} H \\hat{x} = H^{\\top} R^{-1} y\n$$\n题目指出，测量矩阵 $H \\in \\mathbb{R}^{m \\times n}$ 具有满列秩（秩为 $n$），噪声协方差矩阵 $R \\in \\mathbb{R}^{m \\times m}$ 是对称正定的。由于 $R$ 是正定的，其逆矩阵 $R^{-1}$ 存在且也是正定的。矩阵 $G = H^{\\top} R^{-1} H$（称为格拉姆矩阵）是一个 $n \\times n$ 矩阵。因为 $H$ 具有满列秩且 $R^{-1}$ 是正定的，所以 $G$ 是可逆的。因此，状态估计 $\\hat{x}$ 存在唯一解：\n$$\n\\hat{x} = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} y\n$$\n攻击者注入一个虚假数据向量 $a \\in \\mathbb{R}^{m}$，导致测量向量被污染为 $y' = y + a$。估计器由于未察觉攻击，使用 $y'$ 计算出一个新的状态估计值 $\\hat{x}'$：\n$$\n\\hat{x}' = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} y' = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} (y+a)\n$$\n$$\n\\hat{x}' = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} y + (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} a\n$$\n因此，状态估计值的变化量 $\\Delta\\hat{x} = \\hat{x}' - \\hat{x}$ 为：\n$$\n\\Delta\\hat{x} = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} a\n$$\n题目将隐蔽攻击定义为估计器的残差保持不变的攻击。对应于原始测量值 $y$ 的残差向量是 $r = y - H\\hat{x}$。对应于受攻击的测量值 $y'$ 的残差是 $r' = y' - H\\hat{x}'$。隐蔽性条件是 $r' = r$。\n让我们用 $r$ 和 $a$ 来表示 $r'$：\n$$\nr' = y' - H\\hat{x}' = (y+a) - H(\\hat{x}+\\Delta\\hat{x}) = (y - H\\hat{x}) + (a - H\\Delta\\hat{x})\n$$\n$$\nr' = r + a - H(H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} a\n$$\n我们定义类投影矩阵 $\\Pi = H(H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1}$。那么 $r'$ 的表达式变为：\n$$\nr' = r + (I - \\Pi)a\n$$\n为了使残差不变 ($r' = r$)，我们必须有 $(I - \\Pi)a = 0$。这是完全隐蔽攻击的数学条件。该方程意味着 $a = \\Pi a$，即攻击向量 $a$ 必须位于矩阵 $\\Pi$ 的像空间中。$\\Pi$ 的像空间与 $H$ 的列空间（记为 $\\text{Im}(H)$）相同。因此，隐蔽攻击的条件是攻击向量 $a$ 必须是 $H$ 的列向量的线性组合。也就是说，必须存在一个向量 $c \\in \\mathbb{R}^n$ 使得：\n$$\na = Hc\n$$\n现在我们可以确定这种隐蔽攻击对状态估计的影响。将 $a = Hc$ 代入 $\\Delta\\hat{x}$ 的表达式中：\n$$\n\\Delta\\hat{x} = (H^{\\top} R^{-1} H)^{-1} H^{\\top} R^{-1} (Hc) = (H^{\\top} R^{-1} H)^{-1} (H^{\\top} R^{-1} H) c = I_n c = c\n$$\n这提供了一个深刻的见解：对于形式为 $a = Hc$ 的隐蔽攻击，其导致的状态估计的偏移量恰好是向量 $c$。因此，攻击者可以通过选择 $c = \\Delta x_c$ 并构造攻击向量 $a = H\\Delta x_c$，来策划一个特定的、期望的状态估计变化量 $\\Delta x_c$。这种攻击保证是隐蔽的。\n\n要将状态向量的某个分量（比如第 $k$ 个分量 $x_k$）精确地移动一个指定的量 $\\Delta$，同时保持所有其他分量不变，期望的状态偏移向量为 $\\Delta x_c = \\Delta \\cdot e_k$，其中 $e_k$ 是 $\\mathbb{R}^n$ 中的第 $k$ 个标准基向量。那么所需的隐蔽攻击向量为：\n$$\na = H(\\Delta \\cdot e_k) = \\Delta \\cdot (He_k)\n$$\n向量 $He_k$ 是矩阵 $H$ 的第 $k$ 列，我们将其记为 $h_k$。因此，实现这一特定状态修改的唯一隐蔽攻击向量是 $a = \\Delta \\cdot h_k$。\n\n我们现在将此应用于给定的具体实例。我们有 $m=5$ 和 $n=3$，其中\n$$\nH = \\begin{pmatrix} 1  2  0 \\\\ 0  3  1 \\\\ 0  0  4 \\\\ 5  0  0 \\\\ 0  6  7 \\end{pmatrix}\n$$\n攻击者的目标是将 DT 对第二个状态分量 $x_2$ 的估计值改变 $\\Delta = 1$，同时保持对 $x_1$ 和 $x_3$ 的估计不变。这对应于状态索引 $k=2$ 和偏移量 $\\Delta=1$。期望的状态偏移向量是：\n$$\n\\Delta x_c = 1 \\cdot e_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n根据我们的一般推导，存在一个唯一的隐蔽攻击向量 $a$ 可以实现这种状态修改。该向量由 $a = H\\Delta x_c$ 给出。\n$$\na = H e_2 = \\begin{pmatrix} 1  2  0 \\\\ 0  3  1 \\\\ 0  0  4 \\\\ 5  0  0 \\\\ 0  6  7 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 6 \\end{pmatrix}\n$$\n这个向量 $a$ 是 $H$ 的第二列。由于这是唯一同时满足隐蔽性和状态修改目标的向量，问题“确定最小 $\\ell_0$ 基数”实际上就是要求我们计算这个唯一向量的 $\\ell_0$ 基数。$\\ell_0$ 基数 $\\|a\\|_0$ 是向量 $a$ 中非零元素的数量。\n攻击向量的各分量为 $a_1=2$、$a_2=3$、$a_3=0$、$a_4=0$ 和 $a_5=6$。\n非零元素是 $a_1$、$a_2$ 和 $a_5$。计算可知，共有 $3$ 个非零元素。\n因此，所需攻击向量的最小 $\\ell_0$ 基数是 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "现实世界中的网络物理系统是动态的，其状态会随时间演化。因此，高明的攻击者不会只满足于对静态快照的操纵。本练习将挑战从静态模型升级到动态系统，其中数字孪生采用龙伯格观测器来跟踪系统状态。你的任务是设计一个跨越时间窗口的攻击序列，在有限的“能量”预算内，最大化其在特定时刻对系统状态估计造成的偏差，这将控制论中的可达性格拉姆矩阵等概念与攻击设计巧妙地结合起来。",
            "id": "4221472",
            "problem": "考虑一个离散时间线性时不变信息物理系统，该系统带有一个用于监控物理过程的数字孪生（DT）估计器。系统动态演化为 $x_{k+1} = A x_{k} + B u_{k}$，其测量值为 $y_{k} = C x_{k} + a_{k}$，其中 $x_{k} \\in \\mathbb{R}^{n}$ 是状态， $u_{k} \\in \\mathbb{R}^{m}$ 是已知控制输入， $y_{k} \\in \\mathbb{R}^{p}$ 是测量输出，而 $a_{k} \\in \\mathbb{R}^{p}$ 是一个对抗性虚假数据注入信号，代表对传感器测量的完整性攻击。该DT采用一个具有固定增益 $L \\in \\mathbb{R}^{n \\times p}$ 的 Luenberger 观测器（LO）：\n$$\n\\hat{x}_{k+1} = A \\hat{x}_{k} + B u_{k} + L \\left( y_{k} - C \\hat{x}_{k} \\right),\n$$\n其中 $\\hat{x}_{k} \\in \\mathbb{R}^{n}$ 是状态估计值。将估计误差定义为 $e_{k} = \\hat{x}_{k} - x_{k}$，并假设初始误差为零，即 $e_{0} = 0$。攻击者试图在给定的目标时域 $N \\in \\mathbb{N}$ 内，在注入信号序列的能量预算约束下，最大化估计误差的范数：\n$$\n\\sum_{k=0}^{N-1} \\| a_{k} \\|_{2}^{2} \\leq E,\n$$\n其中 $E > 0$。假设 $A \\in \\mathbb{R}^{n \\times n}$、$B \\in \\mathbb{R}^{n \\times m}$ 和 $C \\in \\mathbb{R}^{p \\times n}$ 是已知的，并且矩阵对 $(A, C)$ 是可检测的，从而所选的增益 $L$ 在正常工况下能产生稳定的观测器误差动态。利用离散时间线性系统、欧几里得范数和诱导算子范数的基本定义，从第一性原理出发，推导在上述约束下 $\\| e_{N} \\|_{2}$ 可达到的最大值的精确闭式表达式。您的答案必须以一个包含 $A$、$C$、$L$、$N$ 和 $E$ 的单一闭式解析表达式的形式给出。无需进行数值舍入，且不涉及物理单位。",
            "solution": "该问题要求推导一个由 Luenberger 观测器监控的离散时间线性系统，在有界能量预算的虚假数据注入攻击下，于时间域 $N$ 处可达到的最大估计误差范数 $\\| e_{N} \\|_{2}$。\n\n首先，我们必须验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 系统动态： $x_{k+1} = A x_{k} + B u_{k}$\n- 攻击下的传感器测量： $y_{k} = C x_{k} + a_{k}$\n- Luenberger 观测器（DT 估计器）：$\\hat{x}_{k+1} = A \\hat{x}_{k} + B u_{k} + L ( y_{k} - C \\hat{x}_{k} )$\n- 状态、输入、输出和攻击信号维度：$x_{k} \\in \\mathbb{R}^{n}$，$u_{k} \\in \\mathbb{R}^{m}$，$y_{k} \\in \\mathbb{R}^{p}$，$a_{k} \\in \\mathbb{R}^{p}$\n- 状态估计和观测器增益维度：$\\hat{x}_{k} \\in \\mathbb{R}^{n}$，$L \\in \\mathbb{R}^{n \\times p}$\n- 系统矩阵维度：$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$C \\in \\mathbb{R}^{p \\times n}$\n- 估计误差定义：$e_{k} = \\hat{x}_{k} - x_{k}$\n- 初始条件：$e_{0} = 0$\n- 目标时域：$N \\in \\mathbb{N}$\n- 攻击能量预算：$\\sum_{k=0}^{N-1} \\| a_{k} \\|_{2}^{2} \\leq E$，其中 $E > 0$\n- 假设：矩阵对 $(A, C)$ 是可检测的，且所选增益 $L$ 使得标称观测器误差动态是稳定的。\n- 目标：求 $\\| e_{N} \\|_{2}$ 的最大可达值。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在控制理论和信息物理系统安全领域具有科学依据。系统、观测器和攻击的模型都是标准且成熟的。该问题是适定的，提供了推导唯一解所需的所有必要定义、初始条件和约束。其语言客观且数学上精确。问题没有科学或事实上的不健全之处，没有缺失或矛盾的信息，并且其设置是用于分析完整性攻击影响的标准理论模型。该问题并非无足轻重，需要进行形式化推导。因此，该问题是有效的。\n\n### 步骤3：解的推导\n推导过程首先建立估计误差的动态方程，然后将时域 $N$ 处的误差表示为攻击序列的线性变换，最后求解由此产生的约束优化问题。\n\n首先，我们推导估计误差 $e_{k} = \\hat{x}_{k} - x_{k}$ 的递推关系。$k+1$ 步的误差为：\n$$\ne_{k+1} = \\hat{x}_{k+1} - x_{k+1}\n$$\n代入 $\\hat{x}_{k+1}$ 和 $x_{k+1}$ 的表达式：\n$$\ne_{k+1} = \\left( A \\hat{x}_{k} + B u_{k} + L ( y_{k} - C \\hat{x}_{k} ) \\right) - \\left( A x_{k} + B u_{k} \\right)\n$$\n包含 $B u_{k}$ 的项相互抵消。重新整理各项可得：\n$$\ne_{k+1} = A (\\hat{x}_{k} - x_{k}) + L y_{k} - L C \\hat{x}_{k}\n$$\n代入误差的定义 $e_{k} = \\hat{x}_{k} - x_{k}$ 和测量方程 $y_{k} = C x_{k} + a_{k}$：\n$$\ne_{k+1} = A e_{k} + L (C x_{k} + a_{k}) - L C \\hat{x}_{k}\n$$\n将 $L$ 分配进去并重新整理：\n$$\ne_{k+1} = A e_{k} + L C (x_{k} - \\hat{x}_{k}) + L a_{k}\n$$\n注意到 $x_{k} - \\hat{x}_{k} = -e_{k}$，我们得到：\n$$\ne_{k+1} = A e_{k} - L C e_{k} + L a_{k}\n$$\n我们定义观测器误差动态矩阵为 $A_{cl} = A - L C$。误差动态简化为一个由攻击信号 $a_k$ 驱动的线性系统：\n$$\ne_{k+1} = A_{cl} e_{k} + L a_{k}\n$$\n问题陈述中提到观测器是稳定的，这意味着 $A_{cl}$ 的所有特征值都位于复平面上的开放单位圆盘内。\n\n接下来，我们将此递推关系从初始条件 $e_0 = 0$ 展开到目标时域 $N$：\n当 $k=0$ 时： $e_1 = A_{cl} e_0 + L a_0 = L a_0$\n当 $k=1$ 时： $e_2 = A_{cl} e_1 + L a_1 = A_{cl} (L a_0) + L a_1$\n当 $k=2$ 时： $e_3 = A_{cl} e_2 + L a_2 = A_{cl} (A_{cl} L a_0 + L a_1) + L a_2 = A_{cl}^2 L a_0 + A_{cl} L a_1 + L a_2$\n\n通过归纳法，时域 $N$ 处的误差是所有过去攻击信号影响的总和：\n$$\ne_{N} = \\sum_{k=0}^{N-1} A_{cl}^{N-1-k} L a_{k}\n$$\n这个表达式代表了从攻击向量序列 $\\{a_0, a_1, \\dots, a_{N-1}\\}$ 到最终误差向量 $e_N$ 的一个线性映射。为了便于优化，我们可以将此映射表示为矩阵形式。我们为整个攻击序列定义一个分块“超向量”：\n$$\n\\mathbf{a} = \\begin{pmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_{N-1} \\end{pmatrix} \\in \\mathbb{R}^{Np}\n$$\n以及一个对应的分块矩阵算子 $\\mathcal{O} \\in \\mathbb{R}^{n \\times Np}$：\n$$\n\\mathcal{O} = \\begin{pmatrix} A_{cl}^{N-1} L  A_{cl}^{N-2} L  \\cdots  A_{cl}^{0} L \\end{pmatrix}\n$$\n其中 $A_{cl}^0 = I$，即 $n \\times n$ 的单位矩阵。使用这些定义，最终误差 $e_N$ 可以简洁地写为：\n$$\ne_N = \\mathcal{O} \\mathbf{a}\n$$\n攻击者的能量约束为 $\\sum_{k=0}^{N-1} \\| a_{k} \\|_{2}^{2} \\leq E$。用超向量 $\\mathbf{a}$ 表示，这等价于 $\\|\\mathbf{a}\\|_{2}^{2} \\leq E$，或 $\\|\\mathbf{a}\\|_{2} \\leq \\sqrt{E}$。\n\n攻击者的目标是在约束 $\\|\\mathbf{a}\\|_{2} \\leq \\sqrt{E}$ 下最大化 $\\|e_N\\|_2 = \\|\\mathcal{O} \\mathbf{a}\\|_2$。这是一个在给定有界输入范数的情况下，求线性算子最大输出范数的标准问题。解由算子 $\\mathcal{O}$ 的诱导2-范数（或谱范数）给出：\n$$\n\\max_{\\|\\mathbf{a}\\|_{2} \\leq \\sqrt{E}} \\|\\mathcal{O} \\mathbf{a}\\|_{2} = \\left( \\sup_{\\mathbf{a} \\neq 0} \\frac{\\|\\mathcal{O} \\mathbf{a}\\|_{2}}{\\|\\mathbf{a}\\|_{2}} \\right) \\cdot \\sqrt{E} = \\|\\mathcal{O}\\|_{2} \\sqrt{E}\n$$\n一个矩阵的诱导2-范数等于其最大奇异值 $\\sigma_{\\max}(\\mathcal{O})$。$\\mathcal{O}$ 的奇异值是矩阵 $\\mathcal{O} \\mathcal{O}^T$ 或 $\\mathcal{O}^T \\mathcal{O}$ 特征值的平方根。在计算上，处理较小的矩阵 $\\mathcal{O} \\mathcal{O}^T \\in \\mathbb{R}^{n \\times n}$ 更为方便。\n$$\n\\|\\mathcal{O}\\|_{2} = \\sigma_{\\max}(\\mathcal{O}) = \\sqrt{\\lambda_{\\max}(\\mathcal{O} \\mathcal{O}^T)}\n$$\n其中 $\\lambda_{\\max}(\\cdot)$ 表示矩阵的最大特征值。\n\n我们来计算乘积 $\\mathcal{O} \\mathcal{O}^T$：\n$$\n\\mathcal{O} \\mathcal{O}^T = \\begin{pmatrix} A_{cl}^{N-1} L  \\cdots  L \\end{pmatrix} \\begin{pmatrix} (A_{cl}^{N-1} L)^T \\\\ \\vdots \\\\ L^T \\end{pmatrix} = \\sum_{k=0}^{N-1} (A_{cl}^{N-1-k} L) (A_{cl}^{N-1-k} L)^T\n$$\n展开转置并通过令 $j = N-1-k$ 来改变求和索引（因此当 $k$ 从 $0$ 变为 $N-1$ 时，$j$ 从 $N-1$ 递减到 $0$），我们得到：\n$$\n\\mathcal{O} \\mathcal{O}^T = \\sum_{j=0}^{N-1} A_{cl}^{j} L L^T (A_{cl}^T)^{j}\n$$\n这个矩阵是系统 $(A_{cl}, L)$ 在时间域 $[0, N-1]$ 上的有限时域可达性格拉姆矩阵。我们将此矩阵表示为 $\\mathcal{G}_N$：\n$$\n\\mathcal{G}_N = \\sum_{k=0}^{N-1} (A-LC)^{k} L L^T ((A-LC)^T)^{k}\n$$\n将此代回我们关于最大误差范数的表达式中：\n$$\n\\max \\|e_N\\|_2 = \\|\\mathcal{O}\\|_{2} \\sqrt{E} = \\sqrt{\\lambda_{\\max}(\\mathcal{G}_N)} \\sqrt{E} = \\sqrt{E \\cdot \\lambda_{\\max}(\\mathcal{G}_N)}\n$$\n这就得到了在给定攻击信号能量约束下，最大可达估计误差范数的最终闭式表达式。当攻击者将其攻击序列（重塑为 $\\mathbf{a}$）与 $\\mathcal{O}$ 对应于 $\\sigma_{\\max}(\\mathcal{O})$ 的右奇异向量对齐，并使用全部能量预算 $E$ 时，达到最大值。",
            "answer": "$$\n\\boxed{\\sqrt{E \\cdot \\lambda_{\\max}\\left(\\sum_{k=0}^{N-1} (A-LC)^{k} L L^T ((A-LC)^T)^{k}\\right)}}\n$$"
        },
        {
            "introduction": "在了解了攻击者的策略之后，我们现在必须转换角色，从防御者的视角来思考问题。如何才能有效地检测出这些精心设计的隐蔽攻击呢？本练习将引导你设计一个基于统计学原理的攻击检测器。你将运用广义似然比检验（GLRT）这一强大的工具，为一类已知结构的攻击推导出一个决策规则，并进一步分析其性能，通过计算其在特定检测阈值下的虚警率来评估检测器的可靠性。",
            "id": "4221476",
            "problem": "一个网络化的信息物理系统（CPS）由一个数字孪生进行监控，该数字孪生在每个采样时刻提供一个物理一致的预测测量向量 $\\hat{y} \\in \\mathbb{R}^{m}$。实际的测量向量 $y \\in \\mathbb{R}^{m}$ 可能会受到虚假数据注入（FDI）完整性攻击 $a \\in \\mathbb{R}^{m}$ 和测量噪声 $w \\in \\mathbb{R}^{m}$ 的破坏，满足随机模型\n$$\ny = \\hat{y} + a + w,\n$$\n其中噪声 $w$ 是独立同分布的高斯噪声，满足 $w \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$，而攻击 $a$ 对防御方是未知的。根据系统架构和历史漏洞分析，已知攻击者的驱动被限制在一个由矩阵 $U \\in \\mathbb{R}^{m \\times r}$ 的列向量张成的 $r$ 维子空间 $\\mathcal{S} = \\mathrm{col}(U)$ 内，其中 $U^{\\top} U = I_{r}$ 且 $r \\leq m$。\n\n考虑二元假设检验问题\n$$\nH_{0}: a = 0 \\quad \\text{versus} \\quad H_{1}: a \\in \\mathcal{S} \\setminus \\{0\\}.\n$$\n从广义似然比检验（GLRT）的定义（该定义将备择假设下的最大似然与原假设下的似然进行比较）出发，推导针对此高斯设定的相应 GLRT 判决规则。您的推导必须基于高斯概率密度函数，并且不得假设任何预先推导出的检测统计量。\n\n设 GLRT 通过将一个标量检验统计量 $T(y)$ 与一个阈值 $\\gamma > 0$ 进行比较来实现。计算确切的虚警率，其定义为在 $H_{0}$ 成立的情况下判决为 $H_{1}$ 的概率，并将其表示为一个仅依赖于阈值 $\\gamma$ 和子空间维度 $r$ 的闭式解析表达式。您可以在最终表达式中使用标准的特殊函数。不需要进行数值近似。请将您的最终答案表示为单个符号表达式；不涉及单位。",
            "solution": "该问题要求推导用于检测结构化虚假数据注入攻击的广义似然比检验（GLRT），并计算相应的虚警率。\n\n首先，我们推导 GLRT 判决规则。测量向量 $y \\in \\mathbb{R}^{m}$ 的随机模型由下式给出\n$$\ny = \\hat{y} + a + w,\n$$\n其中 $\\hat{y}$ 是预测测量值，$a$ 是攻击向量，$w \\sim \\mathcal{N}(0, \\sigma^{2} I_{m})$ 是高斯噪声。该模型的随机分量是 $w$。我们可以将 $w$ 表示为 $w = y - \\hat{y} - a$。因此，给定 $a$ 时 $y$ 的概率密度函数（PDF）为\n$$\np(y|a) = \\frac{1}{(2\\pi \\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|y - \\hat{y} - a\\|^2\\right).\n$$\n问题是一个二元假设检验：\n$$\nH_{0}: a = 0 \\quad \\text{versus} \\quad H_{1}: a \\in \\mathcal{S} \\setminus \\{0\\},\n$$\n其中 $\\mathcal{S} = \\mathrm{col}(U)$ 是一个由 $U \\in \\mathbb{R}^{m \\times r}$（满足 $U^{\\top} U = I_{r}$）的列向量张成的 $r$ 维子空间。\n\nGLRT 统计量是 $H_{1}$ 下的最大似然与 $H_{0}$ 下的似然之比：\n$$\nL(y) = \\frac{\\sup_{a \\in \\mathcal{S} \\setminus \\{0\\}} p(y|a)}{p(y|H_0)}.\n$$\n在原假设 $H_{0}$ 下，攻击 $a=0$。似然函数为\n$$\np(y|H_0) = p(y|a=0) = \\frac{1}{(2\\pi \\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|y - \\hat{y}\\|^2\\right).\n$$\n在 $H_0$ 下没有未知参数，因此不需要最大化。\n\n在备择假设 $H_{1}$ 下，攻击向量 $a$ 未知，但位于子空间 $\\mathcal{S}$ 中。我们求 $a$ 的最大似然估计（MLE）。关于 $a \\in \\mathcal{S}$ 最大化 $p(y|a)$ 等价于最小化指数中的平方范数：\n$$\n\\hat{a}_{ML} = \\arg\\min_{a \\in \\mathcal{S}} \\|(y - \\hat{y}) - a\\|^2.\n$$\n这是一个标准的最小二乘问题，其解 $\\hat{a}_{ML}$ 是残差向量 $z = y - \\hat{y}$ 到子空间 $\\mathcal{S}$ 上的正交投影。到 $\\mathcal{S} = \\mathrm{col}(U)$ 的投影矩阵是 $P_{\\mathcal{S}} = U(U^{\\top}U)^{-1}U^{\\top}$。鉴于 $U^{\\top}U = I_r$，这简化为 $P_{\\mathcal{S}} = UU^{\\top}$。\n因此，$a$ 的 MLE 是\n$$\n\\hat{a}_{ML} = P_{\\mathcal{S}} (y - \\hat{y}) = UU^{\\top}(y - \\hat{y}).\n$$\n由于似然函数在 $a$ 上是连续的，且 $\\mathcal{S}$ 是一个闭集，因此在 $a \\in \\mathcal{S} \\setminus \\{0\\}$ 上的上确界与在 $a \\in \\mathcal{S}$ 上的上确界相同，除非最大值唯一出现在 $a=0$ 处。在这种情况下，似然比将为 $1$，对于任何合理的阈值都会导致判决为 $H_0$，因此我们可以通过在 $\\mathcal{S}$ 上最大化来继续。\n\n将 $\\hat{a}_{ML}$ 代入似然函数，得到 $H_1$ 下的最大似然：\n$$\n\\sup_{a \\in \\mathcal{S}} p(y|a) = \\frac{1}{(2\\pi \\sigma^2)^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^2} \\|(y - \\hat{y}) - UU^{\\top}(y - \\hat{y})\\|^2\\right).\n$$\n令 $z = y - \\hat{y}$。指数中的项是 $\\|(I_m - UU^{\\top})z\\|^2$。矩阵 $I_m - UU^{\\top}$ 是到 $\\mathcal{S}$ 的正交补空间上的投影。根据正交投影的勾股定理，$\\|z\\|^2 = \\|P_{\\mathcal{S}}z\\|^2 + \\|(I_m - P_{\\mathcal{S}})z\\|^2 = \\|UU^{\\top}z\\|^2 + \\|(I_m - UU^{\\top})z\\|^2$。\n因此，$\\|(I_m - UU^{\\top})z\\|^2 = \\|z\\|^2 - \\|UU^{\\top}z\\|^2$。\n\n于是，似然比 $L(y)$ 为\n$$\nL(y) = \\frac{\\exp\\left(-\\frac{1}{2\\sigma^2}(\\|y - \\hat{y}\\|^2 - \\|UU^{\\top}(y - \\hat{y})\\|^2)\\right)}{\\exp\\left(-\\frac{1}{2\\sigma^2} \\|y - \\hat{y}\\|^2\\right)} = \\exp\\left(\\frac{1}{2\\sigma^2} \\|UU^{\\top}(y - \\hat{y})\\|^2\\right).\n$$\nGLRT 在 $L(y) > \\gamma_L$ 时判决为 $H_1$，其中 $\\gamma_L > 1$ 是某个阈值。这等价于将对数似然比与一个阈值进行比较：\n$$\n\\ln(L(y)) = \\frac{1}{2\\sigma^2} \\|UU^{\\top}(y - \\hat{y})\\|^2 > \\ln(\\gamma_L).\n$$\n该统计量的任何单调函数都构成等价的检验。问题指定了一个检验统计量 $T(y)$ 和阈值 $\\gamma$，使得最终的虚警率仅依赖于 $\\gamma$ 和 $r$。这意味着讨厌参数 $\\sigma^2$ 必须在 $T(y)$ 于 $H_0$ 下的分布中被消除。因此，我们通过归一化指数中的项来定义检验统计量 $T(y)$：\n$$\nT(y) = \\frac{1}{\\sigma^2} \\|UU^{\\top}(y - \\hat{y})\\|^2.\n$$\nGLRT 判决规则是在 $T(y) > \\gamma$ 时判决为 $H_1$，其中 $\\gamma = 2\\ln(\\gamma_L)$。\n\n接下来，我们计算虚警率 $P_{FA}$。这是当 $H_0$ 为真时，判决为 $H_1$ 的概率。\n$$\nP_{FA} = P(T(y) > \\gamma | H_0).\n$$\n在 $H_0$ 下，$a=0$，所以 $y = \\hat{y} + w$。检验统计量变为\n$$\nT(y)|_{H_0} = \\frac{1}{\\sigma^2} \\|UU^{\\top}((\\hat{y} + w) - \\hat{y})\\|^2 = \\frac{1}{\\sigma^2} \\|UU^{\\top}w\\|^2.\n$$\n令 $w' = \\frac{1}{\\sigma}w$。由于 $w \\sim \\mathcal{N}(0, \\sigma^2 I_m)$，$w'$ 是一个标准正态随机向量，$w' \\sim \\mathcal{N}(0, I_m)$。将 $w = \\sigma w'$ 代入 $T(y)$ 的表达式，我们得到\n$$\nT(y)|_{H_0} = \\frac{1}{\\sigma^2} \\|UU^{\\top}(\\sigma w')\\|^2 = \\frac{\\sigma^2}{\\sigma^2} \\|UU^{\\top}w'\\|^2 = \\|UU^{\\top}w'\\|^2.\n$$\n这可以写成一个二次型 $w'^{\\top}(UU^{\\top})^{\\top}(UU^{\\top})w' = w'^{\\top}U(U^{\\top}U)U^{\\top}w' = w'^{\\top}(UU^{\\top})w'$。\n该统计量是标准正态向量 $w'$ 中的一个二次型，其矩阵为 $P_{\\mathcal{S}} = UU^{\\top}$。根据 Cochran 定理（或高斯向量二次型的一般理论），如果 $X \\sim \\mathcal{N}(0, I_m)$ 且 $A$ 是一个秩为 $\\mathrm{rank}(A) = k$ 的 $m \\times m$ 对称幂等矩阵，则随机变量 $X^{\\top}AX$ 服从自由度为 $k$ 的卡方分布，即 $\\chi^2_k$。\n\n矩阵 $P_{\\mathcal{S}} = UU^{\\top}$ 是：\n1.  对称的：$(UU^{\\top})^{\\top} = (U^{\\top})^{\\top}U^{\\top} = UU^{\\top}$。\n2.  幂等的：$(UU^{\\top})(UU^{\\top}) = U(U^{\\top}U)U^{\\top} = U I_r U^{\\top} = UU^{\\top}$。\n$P_{\\mathcal{S}}$ 的秩为 $\\mathrm{rank}(UU^{\\top}) = \\mathrm{tr}(UU^{\\top}) = \\mathrm{tr}(U^{\\top}U) = \\mathrm{tr}(I_r) = r$。\n\n因此，在 $H_0$ 下，检验统计量 $T(y)$ 服从自由度为 $r$ 的卡方分布：\n$$\nT(y)|_{H_0} \\sim \\chi^2_r.\n$$\n虚警率是这个服从 $\\chi^2_r$ 分布的随机变量超过阈值 $\\gamma$ 的概率：\n$$\nP_{FA} = P(\\chi^2_r > \\gamma).\n$$\n这是 $\\chi^2_r$ 分布的互补累积分布函数（CCDF）或生存函数在 $\\gamma$ 处的值。卡方随机变量的 CCDF 通常用正则化上不完全伽马函数 $Q(s,x)$ 表示，其定义为：\n$$\nQ(s, x) = \\frac{\\Gamma(s, x)}{\\Gamma(s)} = \\frac{1}{\\Gamma(s)} \\int_x^{\\infty} t^{s-1} e^{-t} dt,\n$$\n其中 $\\Gamma(s)$ 是伽马函数，$\\Gamma(s,x)$ 是上不完全伽马函数。\n对于一个 $\\chi^2_r$ 随机变量 $X$，概率 $P(X > x_0)$ 由 $Q(\\frac{r}{2}, \\frac{x_0}{2})$ 给出。\n在我们的情况下，自由度是 $r$，值 $x_0$ 是阈值 $\\gamma$。因此，虚警率为\n$$\nP_{FA} = Q\\left(\\frac{r}{2}, \\frac{\\gamma}{2}\\right).\n$$\n该表达式仅依赖于子空间维度 $r$ 和阈值 $\\gamma$，符合要求。",
            "answer": "$$\n\\boxed{Q\\left(\\frac{r}{2}, \\frac{\\gamma}{2}\\right)}\n$$"
        }
    ]
}