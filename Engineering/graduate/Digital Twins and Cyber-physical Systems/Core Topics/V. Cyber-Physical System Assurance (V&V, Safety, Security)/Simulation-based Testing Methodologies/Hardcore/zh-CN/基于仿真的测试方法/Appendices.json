{
    "hands_on_practices": [
        {
            "introduction": "在基于仿真的测试中，关键的第一步是量化模型的“保真度”——即其行为与真实物理系统的匹配程度。本练习  提供了一种实践方法，用于计算数字孪生与其物理对应物之间的时间平均误差度量。通过这个例子，您将具体理解如何衡量和评估模型的准确性，这是任何验证和确认工作的基本技能。",
            "id": "4246292",
            "problem": "一个温箱，被建模为一个一阶线性时不变系统，是某个信息物理系统 (CPS) 的一部分，该系统正在使用数字孪生进行基于仿真的测试。该温箱在时间 $t=0$ 时受到一个单位阶跃加热功率的激励，其输入为 $u(t)$，当 $t \\ge 0$ 时 $u(t)=1$，当 $t  0$ 时 $u(t)=0$。数字孪生使用一个标称能量平衡模型，其标量温度状态 $x(t)$ 满足常微分方程 $\\tau_{m}\\,\\dot{x}(t)+x(t)=u(t)$，初始条件为 $x(0)=0$，时间常数为 $\\tau_{m}=10$ 秒。物理温箱可以很好地由一个类似的一阶模型描述，但具有不同的增益和时间常数，$\\tau_{p}\\,\\dot{x}(t)+x(t)=G\\,u(t)$，初始条件为 $x(0)=0$，其中 $G=0.9$ 且 $\\tau_{p}=12$ 秒。因此，对于 $t\\ge 0$，仿真轨迹和测量序列分别由连续时间轨迹 $x_{\\text{twin}}(t)$ 和 $x_{\\text{physical}}(t)$ 表示。\n\n使用 $\\mathbb{R}$ 上的欧几里得范数（即绝对值），将瞬时保真度误差定义为 $e(t)=\\|x_{\\text{twin}}(t)-x_{\\text{physical}}(t)\\|$，并将有限时间域 $[0,T]$ 上的时间平均保真度度量定义为 $\\bar{e}=\\frac{1}{T}\\int_{0}^{T}e(t)\\,dt$。取 $T=60$ 秒，从控制微分方程及其阶跃响应开始计算 $\\bar{e}$。以开尔文 (K) 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望计算数字孪生与物理温箱之间的时间平均保真度误差 $\\bar{e}$，两者均建模为一阶线性时不变 (LTI) 系统。\n\n数字孪生温度状态 $x_{\\text{twin}}(t)$ 的控制常微分方程 (ODE) 由下式给出：\n$$ \\tau_{m}\\,\\dot{x}_{\\text{twin}}(t)+x_{\\text{twin}}(t)=u(t) $$\n初始条件为 $x_{\\text{twin}}(0)=0$，时间常数为 $\\tau_{m}=10$ 秒。\n\n物理温箱温度状态 $x_{\\text{physical}}(t)$ 的控制 ODE 由下式给出：\n$$ \\tau_{p}\\,\\dot{x}_{\\text{physical}}(t)+x_{\\text{physical}}(t)=G\\,u(t) $$\n初始条件为 $x_{\\text{physical}}(0)=0$，增益为 $G=0.9$，时间常数为 $\\tau_{p}=12$ 秒。\n\n输入 $u(t)$ 是一个单位阶跃函数，即当 $t \\ge 0$ 时 $u(t)=1$，当 $t  0$ 时 $u(t)=0$。因此，温度状态 $x_{\\text{twin}}(t)$ 和 $x_{\\text{physical}}(t)$ 的单位是开尔文 (K)，假设输入的单位是瓦特，增益的单位是 K/W。\n\n首先，我们求解每个系统在 $t \\ge 0$ 时的阶跃响应。对于 ODE $\\tau\\,\\dot{x}(t)+x(t)=K\\,u(t)$，在 $x(0)=0$ 和 $u(t)=1$ 条件下的通解是标准的一阶阶跃响应：\n$$ x(t) = K(1 - \\exp(-t/\\tau)) $$\n\n对于数字孪生，稳态增益为 $K=1$，时间常数为 $\\tau = \\tau_m$。解为：\n$$ x_{\\text{twin}}(t) = 1 - \\exp(-t/\\tau_m) $$\n\n对于物理温箱，稳态增益为 $K=G$，时间常数为 $\\tau = \\tau_p$。解为：\n$$ x_{\\text{physical}}(t) = G(1 - \\exp(-t/\\tau_p)) $$\n\n瞬时保真度误差定义为 $e(t)=|x_{\\text{twin}}(t)-x_{\\text{physical}}(t)|$。我们来计算绝对值内的差值：\n$$ x_{\\text{twin}}(t)-x_{\\text{physical}}(t) = \\left(1 - \\exp(-t/\\tau_m)\\right) - G\\left(1 - \\exp(-t/\\tau_p)\\right) $$\n$$ = 1 - \\exp(-t/\\tau_m) - G + G\\exp(-t/\\tau_p) $$\n$$ = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) $$\n我们定义函数 $f(t) = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p)$。我们需要确定 $f(t)$ 在 $t \\ge 0$ 时的符号以去掉绝对值。\n在 $t=0$ 时，$f(0) = (1-G) - \\exp(0) + G\\exp(0) = 1-G-1+G = 0$。\n当 $t \\to \\infty$ 时，$f(t) \\to (1-G) - 0 + 0 = 1-G$。当 $G=0.9$ 时，该极限为 $0.1$，是一个正值。\n我们来分析 $f(t)$ 的导数：\n$$ f'(t) = \\frac{d}{dt}\\left[ (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) \\right] = \\frac{1}{\\tau_m}\\exp(-t/\\tau_m) - \\frac{G}{\\tau_p}\\exp(-t/\\tau_p) $$\n代入给定值 $\\tau_m=10$，$\\tau_p=12$ 和 $G=0.9$：\n$$ f'(t) = \\frac{1}{10}\\exp(-t/10) - \\frac{0.9}{12}\\exp(-t/12) = 0.1\\exp(-t/10) - 0.075\\exp(-t/12) $$\n在 $t=0$ 时，$f'(0) = 0.1 - 0.075 = 0.025 > 0$。\n由于 $f(0)=0$ 且 $f'(t)$ 初始为正，函数 $f(t)$ 从 0 开始增加，并在较小的 $t > 0$ 时变为正值。该函数最终趋近于正极限 $1-G$。更详细的分析表明，$f(t)$ 有一个唯一的最大值，并且对于所有 $t \\ge 0$ 均保持非负。因此，我们可以去掉绝对值，所以 $e(t) = f(t)$。\n$$ e(t) = (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) $$\n\n接下来，我们计算在时间域 $[0, T]$ 上的时间平均保真度度量 $\\bar{e}$：\n$$ \\bar{e} = \\frac{1}{T}\\int_{0}^{T}e(t)\\,dt = \\frac{1}{T}\\int_{0}^{T} \\left[ (1-G) - \\exp(-t/\\tau_m) + G\\exp(-t/\\tau_p) \\right] dt $$\n我们逐项积分：\n$$ \\int_{0}^{T} (1-G)\\,dt = (1-G)T $$\n$$ \\int_{0}^{T} -\\exp(-t/\\tau_m)\\,dt = \\left[ \\tau_m \\exp(-t/\\tau_m) \\right]_{0}^{T} = \\tau_m(\\exp(-T/\\tau_m) - 1) = -\\tau_m(1 - \\exp(-T/\\tau_m)) $$\n$$ \\int_{0}^{T} G\\exp(-t/\\tau_p)\\,dt = \\left[ -G\\tau_p \\exp(-t/\\tau_p) \\right]_{0}^{T} = -G\\tau_p(\\exp(-T/\\tau_p) - 1) = G\\tau_p(1 - \\exp(-T/\\tau_p)) $$\n综合这些结果：\n$$ \\int_{0}^{T}e(t)\\,dt = (1-G)T - \\tau_m(1 - \\exp(-T/\\tau_m)) + G\\tau_p(1 - \\exp(-T/\\tau_p)) $$\n除以 $T$ 得到平均误差 $\\bar{e}$：\n$$ \\bar{e} = (1-G) - \\frac{\\tau_m}{T}(1 - \\exp(-T/\\tau_m)) + \\frac{G\\tau_p}{T}(1 - \\exp(-T/\\tau_p)) $$\n现在，我们代入数值：$G=0.9$，$\\tau_m=10$ s，$\\tau_p=12$ s，以及 $T=60$ s。\n$$ \\bar{e} = (1 - 0.9) - \\frac{10}{60}(1 - \\exp(-60/10)) + \\frac{0.9 \\times 12}{60}(1 - \\exp(-60/12)) $$\n$$ \\bar{e} = 0.1 - \\frac{1}{6}(1 - \\exp(-6)) + \\frac{10.8}{60}(1 - \\exp(-5)) $$\n$$ \\bar{e} = 0.1 - \\frac{1}{6}(1 - \\exp(-6)) + 0.18(1 - \\exp(-5)) $$\n使用计算器计算指数项：\n$$ \\exp(-6) \\approx 0.00247875 $$\n$$ \\exp(-5) \\approx 0.00673795 $$\n将这些值代入 $\\bar{e}$ 的表达式中：\n$$ \\bar{e} \\approx 0.1 - \\frac{1}{6}(1 - 0.00247875) + 0.18(1 - 0.00673795) $$\n$$ \\bar{e} \\approx 0.1 - \\frac{1}{6}(0.99752125) + 0.18(0.99326205) $$\n$$ \\bar{e} \\approx 0.1 - 0.16625354 + 0.17878717 $$\n$$ \\bar{e} \\approx -0.06625354 + 0.17878717 $$\n$$ \\bar{e} \\approx 0.11253363 $$\n题目要求答案四舍五入到四位有效数字。\n$$ \\bar{e} \\approx 0.1125 $$\n$\\bar{e}$ 的单位与 $x(t)$ 的单位相同，即开尔文 (K)。",
            "answer": "$$\\boxed{0.1125}$$"
        },
        {
            "introduction": "除了普适的保真度，我们常常需要验证系统是否满足特定的关键要求，例如车辆速度永远不超过安全限值。本练习  介绍信号时序逻辑（Signal Temporal Logic, STL）作为一种表达此类时序属性的强大语言。您将计算一个STL公式的“鲁棒性”，它定量地衡量了仿真轨迹在多大程度上满足或违反了给定的安全要求。",
            "id": "4246326",
            "problem": "信息物理系统（CPS）中地面车辆的数字孪生被用于基于仿真的测试，以检验其是否符合信号时序逻辑（STL）中规定的形式化安全需求。考虑STL公式 $\\varphi = \\mathbf{G}_{[0,10]}(v  30)$，该公式编码了在一个仿真运行的前10秒内，车辆速度必须严格保持在$30$以下的需求。仿真中的速度信号是连续时间的，由 $v(t) = 29 + \\frac{t}{2} - \\frac{t^{2}}{40}$ 给出（对于 $t \\in [0,10]$），其中 $t$ 是时间（单位：秒），$v$ 是速度（单位：$\\mathrm{m/s}$）。\n\n从信号时序逻辑（STL）中针对原子谓词和连续时间信号上的$\\mathbf{G}$（全局）算子的形式化鲁棒语义出发，推导公式 $\\varphi$ 在区间 $[0,10]$ 上相对于 $v(t)$ 的鲁棒性。然后，根据仿真是否满足需求的置信度来解释该值。最终的鲁棒性值以$\\mathrm{m/s}$为单位表示。请提供精确值，无需四舍五入。最终答案必须是单个实数值。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良构且客观。\n\n**步骤1：提取已知条件**\n- **系统**：信息物理系统（CPS）中的地面车辆数字孪生。\n- **任务**：针对形式化安全需求进行基于仿真的测试。\n- **形式化方法**：信号时序逻辑（STL）。\n- **STL公式**：$\\varphi = \\mathbf{G}_{[0,10]}(v  30)$。这要求在时间区间 $[0,10]$ 内的所有时刻 $t$，速度 $v$ 必须严格小于 $30$。\n- **信号**：连续时间的速度信号由函数 $v(t) = 29 + \\frac{t}{2} - \\frac{t^{2}}{40}$ 给出。\n- **时间区间**：关注的定义域是 $t \\in [0,10]$。\n- **单位**：时间 $t$ 的单位是秒（$\\mathrm{s}$），速度 $v$ 的单位是米/秒（$\\mathrm{m/s}$）。\n- **目标**：推导公式 $\\varphi$ 相对于信号 $v(t)$ 的定量鲁棒性，并解释其结果。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在信息物理系统的形式化方法和控制理论方面有坚实的基础。信号时序逻辑及其鲁棒语义是用于指定和验证实时系统属性的标准、定义明确的工具。\n- **良构性**：该问题是良构的。它提供了一个特定的STL公式、一个特定的信号函数和一个确定的时间区间。任务是使用标准定义，基于这些输入计算一个单一的、唯一确定的值（鲁棒性）。\n- **客观性和完整性**：问题陈述是客观的，并提供了继续进行所需的所有必要信息。它隐含地假设读者具备STL标准鲁棒语义的知识，这对于一个面向该领域熟悉受众的此类问题是合适的。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。我们可以继续进行求解。\n\n求解过程需要应用信号时序逻辑（STL）的形式化鲁棒语义。给定的STL公式为 $\\varphi = \\mathbf{G}_{[0,10]}(v  30)$。该公式由一个原子谓词 $\\mu \\equiv (v  30)$ 和一个时序算子 $\\mathbf{G}_{[0,10]}$（在区间 $[0,10]$ 上全局成立）组成。\n\n首先，我们定义原子谓词 $\\mu$ 的鲁棒性。对于时刻 $t$ 的信号值 $v(t)$，谓词 $(v  c)$ 的鲁棒性定义为 $v(t)$ 到边界 $v=c$ 的有向距离。其形式化定义如下：\n$$\n\\rho(\\mu, v, t) = c - v(t)\n$$\n在我们的问题中，$c=30$，所以原子谓词的鲁棒性函数为：\n$$\nr(t) = \\rho((v  30), v, t) = 30 - v(t)\n$$\n在给定的时间 $t$，$r(t)$ 的正值表示谓词得到满足，而负值表示谓词被违反。\n\n接下来，我们定义“全局”算子 $\\mathbf{G}_{[t_1, t_2]}$ 的鲁棒性。公式 $\\mathbf{G}_{[t_1, t_2]} \\mu$ 相对于信号 $v$ 的鲁棒性，是谓词 $\\mu$ 的鲁棒性在指定时间区间内的最小值（对于连续时间是下确界）。对于我们的公式 $\\varphi = \\mathbf{G}_{[0,10]}(v  30)$，其鲁棒性为：\n$$\n\\rho(\\varphi, v, 0) = \\inf_{t \\in [0,10]} r(t) = \\inf_{t \\in [0,10]} (30 - v(t))\n$$\n给定速度信号为 $v(t) = 29 + \\frac{t}{2} - \\frac{t^{2}}{40}$。我们将其代入 $r(t)$ 的表达式中：\n$$\nr(t) = 30 - \\left(29 + \\frac{t}{2} - \\frac{t^{2}}{40}\\right) = 1 - \\frac{t}{2} + \\frac{t^{2}}{40}\n$$\n为了找到 $r(t)$ 在闭区间 $[0,10]$ 上的下确界，我们必须找到该函数在此区间上的全局最小值。由于 $r(t)$ 是一个连续可微函数（一个二次多项式），其最小值将出现在区间内的临界点或区间的端点（$t=0$ 或 $t=10$）。\n\n我们通过求 $r(t)$ 对 $t$ 的导数并将其设为零来找到临界点：\n$$\n\\frac{dr}{dt} = \\frac{d}{dt} \\left(1 - \\frac{t}{2} + \\frac{t^{2}}{40}\\right) = -\\frac{1}{2} + \\frac{2t}{40} = \\frac{t}{20} - \\frac{1}{2}\n$$\n将导数设为零以找到临界点 $t_c$：\n$$\n\\frac{t_c}{20} - \\frac{1}{2} = 0 \\implies \\frac{t_c}{20} = \\frac{1}{2} \\implies t_c = 10\n$$\n唯一的临界点出现在 $t=10$，这是我们区间的一个端点。函数 $r(t)$ 是一个开口向上的抛物线（因为 $t^2$ 项的系数 $\\frac{1}{40}$ 是正的），所以其顶点位于这个临界点。这意味着在任何包含 $t=10$ 和小于 $10$ 的值的区间上，函数的最小值将在 $t=10$ 处取得。\n\n为了确认，我们可以分析导数在 $t \\in [0,10)$ 上的符号。在此区间上，$\\frac{dr}{dt} = \\frac{t-10}{20}$ 始终为负。因此，函数 $r(t)$ 在整个区间 $[0,10]$ 上是单调递减的。所以，$r(t)$ 在此区间上的最小值必然出现在右端点 $t=10$ 处。\n\n现在，我们计算 $r(t)$ 在这个最小点的数值：\n$$\n\\rho(\\varphi, v, 0) = r(10) = 1 - \\frac{10}{2} + \\frac{10^2}{40} = 1 - 5 + \\frac{100}{40} = 1 - 5 + \\frac{5}{2}\n$$\n$$\n\\rho(\\varphi, v, 0) = -4 + 2.5 = -1.5\n$$\n公式 $\\varphi$ 相对于信号 $v(t)$ 的鲁棒性是 $-1.5 \\, \\mathrm{m/s}$。\n\n对该值的解释如下：\n- 正的鲁棒性值表示规约得到满足。其大小代表了“安全裕度”。\n- 负的鲁棒性值表示规约被违反。其大小代表了“违规程度”。\n- 鲁棒性为零表示规约在边界上被精确满足。\n\n由于我们计算出的鲁棒性为 $-1.5$，规约 $\\mathbf{G}_{[0,10]}(v  30)$ 被违反。数值 $-1.5$ 意味着在区间 $[0,10]$ 内的最差时间点，条件 $v(t)  30$ 以 $1.5 \\, \\mathrm{m/s}$ 的裕度不满足。这种最坏情况下的违规发生在 $t=10 \\, \\mathrm{s}$。此时，速度为：\n$$\nv(10) = 29 + \\frac{10}{2} - \\frac{10^2}{40} = 29 + 5 - 2.5 = 31.5 \\, \\mathrm{m/s}\n$$\n此时的鲁棒性为 $30 - v(10) = 30 - 31.5 = -1.5 \\, \\mathrm{m/s}$，这证实了我们的结果。在基于仿真的测试背景下，此结果对应于对此特定测试用例的明确“失败”判定。",
            "answer": "$$\n\\boxed{-1.5}\n$$"
        },
        {
            "introduction": "在使用标准的蒙特卡洛方法时，估计诸如系统故障之类的罕见事件的概率可能需要海量的仿真次数。本练习  将演示方差缩减技术如何显著提高基于仿真的测试效率。通过将基准蒙特卡洛方法与分层抽样和对偶变量法进行比较，您将学习如何在相同的计算预算下获得更精确的估计值。",
            "id": "4246362",
            "problem": "用于自动驾驶地面车辆的信息物理系统 (CPS) 的数字孪生被用来估计一个可靠性指标：在扰动下，制动控制器未能在要求距离内停车的概率。基于仿真的测试将聚合的“扰动到失效”机制建模为一个由具有连续分布的单一潜在不确定性变量驱动的单调阈值事件。通过概率积分变换，不失一般性地假设模拟器将失效评估为事件 $\\{U > u_{0}\\}$ 的指示函数，其中 $U \\sim \\mathrm{Unif}(0,1)$ 且 $u_{0} \\in (0,1)$。在本次测试活动中，阈值为 $u_{0} = 0.9$，因此真实失效概率为 $p = \\mathbb{P}(U > 0.9)$。\n\n您将在 $N$ 次对模拟器的独立调用的相同仿真预算下，比较三种对 $p$ 的无偏估计量：\n- 基准蒙特卡洛，使用 $N$ 次独立抽样 $U_{1},\\dots,U_{N}$。\n- 在 $[0,1]$ 上进行双层分层抽样，层为 $[0,0.8)$ 和 $[0.8,1]$，按比例分配样本量 $n_{1} = 0.8N$ 和 $n_{2} = 0.2N$，并使用层内样本均值的标准加权平均。\n- 对偶变量，使用 $N/2$ 个独立配对 $(U_{i}, 1 - U_{i})$，每个配对产生一个平均失效指示函数。\n\n仅从期望、方差、独立性和条件概率的定义出发，且不假设任何预先推导的方差公式，完成以下任务：\n1. 推导基准估计量的方差，作为 $N$ 的函数。\n2. 使用上述指定的层和分配方式，推导双层分层估计量的方差，作为 $N$ 的函数。\n3. 使用配对构造，推导对偶估计量的方差，作为 $N$ 的函数。\n4. 将方差缩减因子 $R$ 定义为基准方差与在相同总预算 $N$ 下通过分层法和对偶变量法获得的两个方差中较小者的比率。计算在给定 $u_{0} = 0.9$ 和分层点为 $0.8$ 时的 $R$ 值。\n\n将您的最终答案 $R$ 四舍五入到四位有效数字。以无单位的纯数形式表示您的答案。",
            "solution": "该问题要求推导概率 $p$ 的三种不同估计量的方差，并计算一个方差缩减因子。整个推导过程将从期望、方差和概率的基本定义出发。\n\n设失效事件为 $F = \\{U > u_0\\}$，其中 $U \\sim \\mathrm{Unif}(0,1)$ 且 $u_0 = 0.9$。真实失效概率为 $p$。\n$$ p = \\mathbb{P}(F) = \\mathbb{P}(U > 0.9) = \\int_{0.9}^{1} 1 \\, du = 1 - 0.9 = 0.1 $$\n仿真结果由指示随机变量 $I = \\mathbf{1}_{F} = \\mathbf{1}_{\\{U > u_0\\}}$ 建模。由于 $I$ 是一个伯努利变量，其期望和方差由 $p$ 定义。\n$I$ 的期望为 $\\mathbb{E}[I] = 1 \\cdot \\mathbb{P}(I=1) + 0 \\cdot \\mathbb{P}(I=0) = p$。\n$I$ 的方差为 $\\mathrm{Var}(I) = \\mathbb{E}[I^2] - (\\mathbb{E}[I])^2$。由于对于指示变量有 $I^2 = I$，所以 $\\mathbb{E}[I^2] = \\mathbb{E}[I] = p$。因此：\n$$ \\mathrm{Var}(I) = p - p^2 = p(1-p) $$\n对于 $p=0.1$，单次试验的方差为 $\\mathrm{Var}(I) = 0.1(1-0.1) = 0.09$。\n\n**1. 基准蒙特卡洛估计量方差的推导**\n基准蒙特卡洛 (MC) 估计量 $\\hat{p}_{MC}$ 是 $N$ 个独立同分布 (i.i.d.) 随机变量 $I_j = \\mathbf{1}_{\\{U_j > u_0\\}}$ 的样本均值，其中每个 $U_j \\sim \\mathrm{Unif}(0,1)$。\n$$ \\hat{p}_{MC} = \\frac{1}{N} \\sum_{j=1}^{N} I_j $$\n该估计量是无偏的，因为 $\\mathbb{E}[\\hat{p}_{MC}] = \\frac{1}{N} \\sum_{j=1}^{N} \\mathbb{E}[I_j] = \\frac{1}{N}(Np) = p$。\n$\\hat{p}_{MC}$ 的方差是利用“对于独立变量，和的方差等于方差的和”这一性质推导出来的。\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{j=1}^{N} I_j\\right) = \\frac{1}{N^2} \\mathrm{Var}\\left(\\sum_{j=1}^{N} I_j\\right) = \\frac{1}{N^2} \\sum_{j=1}^{N} \\mathrm{Var}(I_j) $$\n由于每个 $I_j$ 的方差为 $p(1-p)$：\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\frac{1}{N^2} (N p(1-p)) = \\frac{p(1-p)}{N} $$\n代入 $p=0.1$：\n$$ \\mathrm{Var}(\\hat{p}_{MC}) = \\frac{0.1(0.9)}{N} = \\frac{0.09}{N} $$\n\n**2. 双层分层抽样估计量方差的推导**\n定义域 $[0,1]$ 被划分为两个层，$S_1 = [0, 0.8)$ 和 $S_2 = [0.8, 1]$。\n层的权重是它们的概率：$W_1 = \\mathbb{P}(U \\in S_1) = 0.8$ 和 $W_2 = \\mathbb{P}(U \\in S_2) = 0.2$。\n样本按比例分配：$n_1 = W_1 N = 0.8N$ 和 $n_2 = W_2 N = 0.2N$。\n分层抽样估计量为 $\\hat{p}_{SS} = W_1 \\hat{p}_1 + W_2 \\hat{p}_2$，其中 $\\hat{p}_k$ 是第 $k$ 层内指示函数的样本均值。\n首先，我们计算条件概率 $p_k = \\mathbb{P}(U > u_0 | U \\in S_k)$。\n对于 $S_1 = [0, 0.8)$ 和 $u_0=0.9$：\n$$ p_1 = \\frac{\\mathbb{P}(\\{U > 0.9\\} \\cap \\{U \\in [0, 0.8)\\})}{\\mathbb{P}(U \\in [0, 0.8))} = \\frac{\\mathbb{P}(\\emptyset)}{0.8} = 0 $$\n对于 $S_2 = [0.8, 1]$ 和 $u_0=0.9$：\n$$ p_2 = \\frac{\\mathbb{P}(\\{U > 0.9\\} \\cap \\{U \\in [0.8, 1]\\})}{\\mathbb{P}(U \\in [0.8, 1])} = \\frac{\\mathbb{P}(U > 0.9)}{0.2} = \\frac{0.1}{0.2} = 0.5 $$\n估计量 $\\hat{p}_k$ 是从第 $k$ 层内 $n_k$ 次抽样的样本均值。其方差为 $\\mathrm{Var}(\\hat{p}_k) = \\frac{p_k(1-p_k)}{n_k}$。\n由于不同层中的样本是独立抽取的，所以 $\\hat{p}_1$ 和 $\\hat{p}_2$ 是独立的。\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = \\mathrm{Var}(W_1 \\hat{p}_1 + W_2 \\hat{p}_2) = W_1^2 \\mathrm{Var}(\\hat{p}_1) + W_2^2 \\mathrm{Var}(\\hat{p}_2) $$\n代入方差的表达式：\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = W_1^2 \\frac{p_1(1-p_1)}{n_1} + W_2^2 \\frac{p_2(1-p_2)}{n_2} $$\n由于 $p_1=0$，第一项为零。\n对于第二项，$p_2(1-p_2) = 0.5(1-0.5)=0.25$。\n$$ \\mathrm{Var}(\\hat{p}_{SS}) = 0 + (0.2)^2 \\frac{0.25}{0.2N} = \\frac{0.04 \\times 0.25}{0.2N} = \\frac{0.01}{0.2N} = \\frac{0.05}{N} $$\n\n**3. 对偶变量估计量方差的推导**\n该方法使用 $M = N/2$ 个独立样本对 $(U_i, 1-U_i)$。对于每个配对，我们构造一个新的变量 $Y_i = \\frac{1}{2}(\\mathbf{1}_{\\{U_i  u_0\\}} + \\mathbf{1}_{\\{1-U_i  u_0\\}})$。估计量是样本均值 $\\hat{p}_{AV} = \\frac{1}{M} \\sum_{i=1}^{M} Y_i$。\n$Y_i$ 是独立同分布的随机变量。我们首先求 $Y_1$ 的期望和方差。设 $I_1 = \\mathbf{1}_{\\{U_1  u_0\\}}$ 和 $I'_1 = \\mathbf{1}_{\\{1-U_1  u_0\\}}$。\n$\\mathbb{E}[I_1] = \\mathbb{P}(U_1  u_0) = p$。\n$\\mathbb{E}[I'_1] = \\mathbb{P}(1-U_1  u_0) = \\mathbb{P}(U_1  1-u_0) = 1-u_0 = p$。\n$\\mathbb{E}[Y_1] = \\frac{1}{2}(\\mathbb{E}[I_1] + \\mathbb{E}[I'_1]) = \\frac{1}{2}(p+p)=p$。该估计量是无偏的。\n该估计量的方差为 $\\mathrm{Var}(\\hat{p}_{AV}) = \\frac{\\mathrm{Var}(Y_1)}{M} = \\frac{2\\mathrm{Var}(Y_1)}{N}$。\n$$ \\mathrm{Var}(Y_1) = \\mathrm{Var}\\left(\\frac{I_1 + I'_1}{2}\\right) = \\frac{1}{4}\\mathrm{Var}(I_1 + I'_1) = \\frac{1}{4}(\\mathrm{Var}(I_1) + \\mathrm{Var}(I'_1) + 2\\mathrm{Cov}(I_1, I'_1)) $$\n我们有 $\\mathrm{Var}(I_1) = p(1-p)$ 和 $\\mathrm{Var}(I'_1) = p(1-p)$。\n协方差为 $\\mathrm{Cov}(I_1, I'_1) = \\mathbb{E}[I_1 I'_1] - \\mathbb{E}[I_1]\\mathbb{E}[I'_1]$。\n$$ \\mathbb{E}[I_1 I'_1] = \\mathbb{E}[\\mathbf{1}_{\\{U_1  u_0 \\text{ and } 1-U_1  u_0\\}}] = \\mathbb{P}(U_1  u_0 \\text{ and } U_1  1-u_0) $$\n对于 $u_0=0.9$，我们需要计算 $\\mathbb{P}(U_1  0.9 \\text{ and } U_1  0.1)$。这些事件的交集是空集，因此概率为 $0$。\n$\\mathrm{Cov}(I_1, I'_1) = 0 - p \\cdot p = -p^2$。\n$$ \\mathrm{Var}(Y_1) = \\frac{1}{4}(p(1-p) + p(1-p) + 2(-p^2)) = \\frac{1}{4}(2p - 2p^2 - 2p^2) = \\frac{2p-4p^2}{4} = \\frac{p-2p^2}{2} $$\n估计量的方差为：\n$$ \\mathrm{Var}(\\hat{p}_{AV}) = \\frac{2}{N} \\mathrm{Var}(Y_1) = \\frac{2}{N}\\left(\\frac{p-2p^2}{2}\\right) = \\frac{p-2p^2}{N} $$\n代入 $p=0.1$：\n$$ \\mathrm{Var}(\\hat{p}_{AV}) = \\frac{0.1 - 2(0.1)^2}{N} = \\frac{0.1 - 0.02}{N} = \\frac{0.08}{N} $$\n\n**4. 方差缩减因子 R 的计算**\n我们得到以下方差：\n$\\mathrm{Var}(\\hat{p}_{MC}) = \\frac{0.09}{N}$\n$\\mathrm{Var}(\\hat{p}_{SS}) = \\frac{0.05}{N}$\n$\\mathrm{Var}(\\hat{p}_{AV}) = \\frac{0.08}{N}$\n\n两个改进后的方差中较小的一个是：\n$$ \\min(\\mathrm{Var}(\\hat{p}_{SS}), \\mathrm{Var}(\\hat{p}_{AV})) = \\min\\left(\\frac{0.05}{N}, \\frac{0.08}{N}\\right) = \\frac{0.05}{N} $$\n方差缩减因子 $R$ 是基准方差与该最小方差的比率：\n$$ R = \\frac{\\mathrm{Var}(\\hat{p}_{MC})}{\\min(\\mathrm{Var}(\\hat{p}_{SS}), \\mathrm{Var}(\\hat{p}_{AV}))} = \\frac{0.09/N}{0.05/N} = \\frac{0.09}{0.05} = 1.8 $$\n四舍五入到四位有效数字得到 $1.800$。",
            "answer": "$$\\boxed{1.800}$$"
        }
    ]
}