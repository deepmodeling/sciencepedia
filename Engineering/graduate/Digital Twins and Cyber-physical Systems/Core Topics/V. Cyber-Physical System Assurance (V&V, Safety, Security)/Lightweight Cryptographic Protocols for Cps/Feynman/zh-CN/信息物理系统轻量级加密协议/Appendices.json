{
    "hands_on_practices": [
        {
            "introduction": "轻量级密码专为资源受限的设备设计，其性能评估不仅关乎速度，也与能耗息息相关，后者对电池供电的设备尤为重要。本练习将指导您如何从基本的硬件参数推导并计算两个关键指标——吞吐量（速度）和每比特能耗（效率）。掌握这项技能是评估任何嵌入式平台密码实现方案的基础。",
            "id": "4229436",
            "problem": "一个信息物理系统（CPS）边缘节点使用带有80位密钥的轻量级分组密码（LBC）PRESENT来加密遥测数据，其数字孪生（DT）必须预测性能和能量成本，以评估协议用于实时通信的可行性。该节点构建于一个时钟频率为 $16 \\text{ MHz}$ 的 Texas Instruments MSP430 微控制器（MSP430）之上，并执行 PRESENT-80 的软件实现，每个64位数据块需要消耗 $2400$ 个中央处理器（CPU）周期。该设备在 $3.3 \\text{ V}$ 的电源电压下运行，加密期间消耗 $5 \\text{ mA}$ 的电流。假设系统处于稳态工况，其中CPU完全被加密任务占用，外部输入/输出开销可以忽略不计，所有数据块都连续处理，没有停顿，并且工作期间电源电流保持恒定。\n\n从时间、速率和能量的核心定义出发，推导该实现的吞吐量（单位：比特/秒）和每比特能量（单位：焦耳/比特）的表达式，然后使用给定的参数对它们进行数值计算。将吞吐量以比特/秒表示，每比特能量以纳焦耳/比特表示。将两个量都四舍五入到四位有效数字。",
            "solution": "该问题提法明确且具有科学依据，提供了推导和计算所需性能指标的所有必要参数。我们可以开始解题。\n\n该问题要求推导和计算嵌入式设备上密码学实现的两个关键性能指标：吞吐量和每比特能量。我们将从时间、速率、功率和能量的核心定义出发，并使用所提供的参数来推导所需的表达式。\n\n根据给定条件，定义以下参数：\n- 时钟频率：$f_{clk} = 16 \\text{ MHz} = 16 \\times 10^6 \\text{ s}^{-1}$\n- 每数据块的CPU周期数：$C_{block} = 2400$\n- 数据块大小：$B_{size} = 64 \\text{ bits}$\n- 电源电压：$V_{DD} = 3.3 \\text{ V}$\n- 电源电流：$I_{DD} = 5 \\text{ mA} = 5 \\times 10^{-3} \\text{ A}$\n\n首先，我们推导吞吐量（记为 $R$）的表达式。\n处理单个数据块所需的时间 $T_{block}$，由操作所需的CPU周期数 $C_{block}$ 和CPU的时钟频率 $f_{clk}$ 决定。其关系如下：\n$$T_{block} = \\frac{C_{block}}{f_{clk}}$$\n吞吐量 $R$ 定义为单位时间内处理的比特数。在连续、无间断处理数据块的假设下，吞吐量等于数据块大小（以比特计）$B_{size}$ 除以处理一个数据块的时间 $T_{block}$。\n$$R = \\frac{B_{size}}{T_{block}}$$\n代入 $T_{block}$ 的表达式，得到吞吐量的通用公式：\n$$R = \\frac{B_{size}}{\\left( \\frac{C_{block}}{f_{clk}} \\right)} = \\frac{B_{size} \\cdot f_{clk}}{C_{block}}$$\n接下来，我们推导每比特消耗的能量（记为 $E_{bit}$）的表达式。\n加密期间设备消耗的电功率 $P$ 是电源电压 $V_{DD}$ 和电源电流 $I_{DD}$ 的乘积。问题中说明了在此操作期间电流是恒定的。\n$$P = V_{DD} \\cdot I_{DD}$$\n加密单个数据块所消耗的能量 $E_{block}$ 是功率乘以操作的持续时间，即 $T_{block}$。\n$$E_{block} = P \\cdot T_{block} = (V_{DD} \\cdot I_{DD}) \\cdot \\left( \\frac{C_{block}}{f_{clk}} \\right)$$\n每比特能量 $E_{bit}$ 则是每数据块的能量除以一个数据块中的比特数 $B_{size}$。\n$$E_{bit} = \\frac{E_{block}}{B_{size}} = \\frac{V_{DD} \\cdot I_{DD} \\cdot C_{block}}{B_{size} \\cdot f_{clk}}$$\n这个 $E_{bit}$ 的表达式与将其作为功率与吞吐量之比的另一种推导方法（即 $E_{bit} = \\frac{P}{R}$）相符。\n\n现在，我们将给定的数值代入推导出的表达式中进行计算。\n对于吞吐量 $R$：\n$$R = \\frac{64 \\text{ bits} \\cdot (16 \\times 10^6 \\text{ s}^{-1})}{2400} = \\frac{1024 \\times 10^6}{2400} \\text{ bps} \\approx 426666.67 \\text{ bps}$$\n问题要求四舍五入到四位有效数字。\n$$R \\approx 4.267 \\times 10^5 \\text{ bps}$$\n\n对于每比特能量 $E_{bit}$：\n$$E_{bit} = \\frac{(3.3 \\text{ V}) \\cdot (5 \\times 10^{-3} \\text{ A}) \\cdot 2400}{64 \\cdot (16 \\times 10^6 \\text{ s}^{-1})}$$\n$$E_{bit} = \\frac{39.6 \\text{ J}}{1024 \\times 10^6 \\text{ bits}} \\approx 3.8671875 \\times 10^{-8} \\frac{\\text{J}}{\\text{bit}}$$\n问题要求答案以纳焦耳/比特（nJ/bit）为单位。由于 $1 \\text{ J} = 10^9 \\text{ nJ}$，我们转换单位：\n$$E_{bit} \\approx (3.8671875 \\times 10^{-8} \\frac{\\text{J}}{\\text{bit}}) \\cdot (10^9 \\frac{\\text{nJ}}{\\text{J}}) = 38.671875 \\frac{\\text{nJ}}{\\text{bit}}$$\n四舍五入到四位有效数字，每比特能量为：\n$$E_{bit} \\approx 38.67 \\frac{\\text{nJ}}{\\text{bit}}$$\n两个最终的数值是吞吐量（单位：比特/秒）和每比特能量（单位：纳焦耳/比特），均四舍五入到四位有效数字。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.267 \\times 10^5 & 38.67\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "信息物理系统通常涉及实时控制回路，例如比例-积分-微分（PID）控制器，其中加密处理并非后台任务，而是时间关键路径的一部分。本练习连接了密码学性能与控制理论，演示了如何将系统级需求（采样周期的一小部分）转化为具体的时钟周期预算 。通过这种方式，您可以确定所选的安全协议对于像执行器控制这样的时间敏感型应用是否可行，从而避免超出时间预算可能导致的系统失稳。",
            "id": "4229450",
            "problem": "一个信息物理系统 (CPS) 中的比例-积分-微分 (PID) 控制执行器以采样周期 $T_{s} = 2 \\text{ ms}$ 进行周期性采样。为保持闭环稳定性并限制抖动，用于消息认证的加密处理被限制在每个周期内消耗不超过采样周期的 $\\alpha = 0.10$ 的比例。该执行器由一个时钟频率为 $f_{\\text{MCU}} = 48 \\text{ MHz}$ 的微控制器单元 (MCU) 驱动。认证采用带有关联数据的认证加密 (AEAD) 实现，对于 $L = 64$ 字节的有效载荷，测得的成本为每字节 $c_{b} = 30$ 个时钟周期。假设加密成本与有效载荷大小成线性关系，并忽略恒定时间的初始化成本、直接内存访问 (DMA) 效应和内存等待状态，因此在 MCU 时钟下，时钟周期与执行时间成正比。\n\n从周期性实时调度的定义以及执行时间与时钟周期之间的关系出发，推导：\n\n1. 每个采样周期内可用于认证的最大时钟周期预算 $C_{\\max}$。\n2. 一个可行性指标 $\\varphi$，定义为：如果 AEAD 计算符合允许的预算（即所需时钟周期不超过 $C_{\\max}$），则 $\\varphi = 1$，否则 $\\varphi = 0$。\n\n请以行矩阵的形式提供您的最终答案，其中第一个条目等于 $C_{\\max}$，第二个条目等于 $\\varphi$。无需四舍五入，并根据需要以时钟周期和无单位指标表示所有中间和最终量。",
            "solution": "首先对问题进行验证，以确保其科学上合理、定义明确且客观。\n\n**步骤 1：提取已知条件**\n- 采样周期：$T_{s} = 2 \\text{ ms}$\n- 用于加密处理的采样周期比例：$\\alpha = 0.10$\n- 微控制器单元 (MCU) 时钟频率：$f_{\\text{MCU}} = 48 \\text{ MHz}$\n- 每字节的加密成本：$c_{b} = 30 \\text{ 时钟周期/字节}$\n- 有效载荷大小：$L = 64 \\text{ 字节}$\n- 假设：加密成本与有效载荷大小成线性关系；忽略初始化成本、DMA 效应和内存等待状态。\n- 要求输出：\n  1. 每个采样周期的最大时钟周期预算 $C_{\\max}$。\n  2. 可行性指标 $\\varphi$，其中如果计算可行则 $\\varphi = 1$，否则 $\\varphi = 0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题定义明确，并在科学上基于实时嵌入式系统和应用密码学的原理。所提供的参数（$T_s$, $f_{\\text{MCU}}$, $c_b$, $L$）对于现代信息物理系统 (CPS) 是切合实际的。问题陈述清晰明确、自成体系，且没有内部矛盾。它不违反任何基本原则，并且没有主观论断。因此，该问题被认为是有效的。\n\n**步骤 3：进行求解**\n\n求解过程需要推导两个量：最大可用时钟周期预算 $C_{\\max}$ 和可行性指标 $\\varphi$。\n\n**1. 最大时钟周期预算 ($C_{\\max}$) 的推导**\n\n给定的总采样周期为 $T_{s} = 2 \\text{ ms}$。这可以用国际单位制（SI）基本单位表示为：\n$$T_{s} = 2 \\times 10^{-3} \\text{ s}$$\n分配给加密处理的该周期比例为 $\\alpha = 0.10$。因此，认证的最大允许执行时间，记为 $T_{\\text{crypto,max}}$，为：\n$$T_{\\text{crypto,max}} = \\alpha \\times T_{s}$$\n代入给定值：\n$$T_{\\text{crypto,max}} = 0.10 \\times (2 \\times 10^{-3} \\text{ s}) = 2 \\times 10^{-4} \\text{ s}$$\n给定的 MCU 时钟频率为 $f_{\\text{MCU}} = 48 \\text{ MHz}$，即：\n$$f_{\\text{MCU}} = 48 \\times 10^6 \\text{ Hz} = 48 \\times 10^6 \\text{ cycles/s}$$\n执行时间 $t$、时钟周期数 $C$ 和时钟频率 $f$ 之间的关系由 $t = C/f$ 给出。因此，在时间预算 $T_{\\text{crypto,max}}$ 内可以执行的最大时钟周期数 $C_{\\max}$ 为：\n$$C_{\\max} = T_{\\text{crypto,max}} \\times f_{\\text{MCU}}$$\n代入推导出的和给定的值：\n$$C_{\\max} = (2 \\times 10^{-4} \\text{ s}) \\times (48 \\times 10^6 \\text{ cycles/s})$$\n$$C_{\\max} = (2 \\times 48) \\times 10^{-4} \\times 10^6 \\text{ cycles}$$\n$$C_{\\max} = 96 \\times 10^2 \\text{ cycles}$$\n$$C_{\\max} = 9600 \\text{ cycles}$$\n\n**2. 可行性指标 ($\\varphi$) 的推导**\n\n为了确定可行性，我们必须首先计算 AEAD 认证所需的时钟周期数，记为 $C_{\\text{req}}$。问题陈述指出，加密成本与有效载荷大小成线性关系，且初始化成本可以忽略不计。每字节的成本为 $c_{b} = 30 \\text{ 时钟周期/字节}$，有效载荷大小为 $L = 64 \\text{ 字节}$。\n因此，所需的时钟周期数为：\n$$C_{\\text{req}} = c_{b} \\times L$$\n代入给定值：\n$$C_{\\text{req}} = (30 \\text{ cycles/byte}) \\times (64 \\text{ bytes})$$\n$$C_{\\text{req}} = 1920 \\text{ cycles}$$\n可行性指标 $\\varphi$ 的定义基于所需时钟周期是否在最大允许预算之内：\n$$\\varphi = \\begin{cases} 1  \\text{如果 } C_{\\text{req}} \\le C_{\\max} \\\\ 0  \\text{如果 } C_{\\text{req}} > C_{\\max} \\end{cases}$$\n我们将计算出的所需时钟周期与最大时钟周期预算进行比较：\n$$1920 \\text{ cycles} \\le 9600 \\text{ cycles}$$\n条件 $C_{\\text{req}} \\le C_{\\max}$ 得到满足。因此，可行性指标为：\n$$\\varphi = 1$$\n\n最终答案要求一个包含 $C_{\\max}$ 和 $\\varphi$ 的行矩阵。\n计算出的值为 $C_{\\max} = 9600$ 和 $\\varphi = 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9600  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "许多安全协议依赖一次性数（nonce）来防止重放攻击，其安全性取决于不可预测性，这一特性可通过最小熵（min-entropy, $H_{\\infty}$）来量化。本项高级练习探讨了现实世界密码学中一个微妙但至关重要的失效模式 。通过分析因确定性随机位生成器（DRBG）熵不足而导致的碰撞风险，您将学会超越算法选择本身，审视密码学随机性的质量，这是稳健系统设计的关键环节。",
            "id": "4229427",
            "problem": "一个资源受限的信息物理系统 (CPS) 在物理设备与其数字孪生之间使用一种轻量级的认证握手。每次握手都包含一个由确定性随机位生成器 (DRBG) 生成的长度为 $96$ 位的 nonce。由于实现上的限制，DRBG 的每次输出的 nonce 只有 $80$ 位的最小熵。假设会话从该 DRBG 中提取独立的 nonce 输出。\n\n仅使用基本定义，推导由 $80$ 位最小熵所隐含的最坏情况下的成对碰撞概率，然后评估在 $n=10^6$ 个独立会话中至少发生一次碰撞的概率，每个会话消耗一个 nonce。如果您的推导能够证明碰撞事件是稀有事件，则可以如此处理。\n\n将您最终评估的风险表示为一个无单位小数，并四舍五入到四位有效数字。",
            "solution": "该问题定义明确，在科学上基于信息论和应用密码学的原理。它要求根据最小熵计算碰撞概率，这是一个标准但重要的分析。所有参数均已提供，问题有效，可以开始求解。\n\n**1. 最坏情况下的成对碰撞概率**\n最小熵（Min-entropy）$H_{\\infty}(X)$ 定义为 $H_{\\infty}(X) = -\\log_2(\\max_{x} P(X=x))$。它量化了分布中最可能结果的不可预测性。对于一个具有 $k$ 位最小熵的随机变量，其任何单个输出值的最大概率为 $p_{\\max} = 2^{-k}$。\n在本问题中，nonce 的最小熵为 $80$ 位，因此 $k=80$。\n两个从该分布中独立抽取的 nonce，$N_1$ 和 $N_2$，发生碰撞的概率 $P_{\\text{coll}} = \\sum_{x} p_x^2$。该概率的最坏情况上界为 $2^{-H_{\\infty}(X)}$。因此，任意两个独立生成的 nonce 之间发生碰撞的最坏情况概率为：\n$$P_{\\text{pair\\_coll}} = 2^{-80}$$\n\n**2. 评估 $n=10^6$ 个会话中的碰撞风险**\n这是一个广义的生日问题。在 $n = 10^6$ 个独立生成的 nonce 中，可以形成 $\\binom{n}{2}$ 个不同的 nonce 对。\n$$\\binom{n}{2} = \\frac{n(n-1)}{2} = \\frac{10^6(10^6 - 1)}{2} \\approx 5 \\times 10^{11}$$\n令 $P_C$ 为在 $n$ 个会话中至少发生一次碰撞的概率。由于碰撞是稀有事件，我们可以使用联合界（Union Bound）进行精确近似：\n$$P_C \\approx \\binom{n}{2} \\times P_{\\text{pair\\_coll}}$$\n代入数值：\n$$P_C \\approx \\frac{n(n-1)}{2} \\times 2^{-80}$$\n$$P_C \\approx \\frac{(10^6)(10^6-1)}{2} \\times 2^{-80} \\approx \\frac{10^{12}}{2} \\times 2^{-80}$$\n为了进行数值计算，我们使用 $2^{80} \\approx 1.2089258 \\times 10^{24}$ 进行计算：\n$$P_C \\approx \\frac{4.999995 \\times 10^{11}}{1.2089258 \\times 10^{24}} \\approx 4.1360 \\times 10^{-13}$$\n将结果四舍五入到四位有效数字：\n$$P_C = 4.136 \\times 10^{-13}$$\n这个结果与最终答案 $4.136 \\times 10^{-13}$ 一致，表明我们的推导是正确的。",
            "answer": "$$ \\boxed{4.136 \\times 10^{-13}} $$"
        }
    ]
}