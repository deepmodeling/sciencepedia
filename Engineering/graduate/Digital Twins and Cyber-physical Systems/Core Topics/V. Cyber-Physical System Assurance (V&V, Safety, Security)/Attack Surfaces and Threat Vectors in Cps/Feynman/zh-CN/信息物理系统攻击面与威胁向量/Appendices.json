{
    "hands_on_practices": [
        {
            "introduction": "为了构建有效的攻击，攻击者常常利用他们对物理系统动态的了解。本练习将引导您亲手实践这一理念，通过对一个热力学系统的建模，推导出实现传感器欺骗所需的精确攻击信号。这个过程将物理学和控制理论的基本原理与信息物理系统中的一个具体安全威胁——传感器欺骗攻击——联系起来，展示了攻击者如何利用暴露的传感器接口来操纵系统认知。",
            "id": "4206240",
            "problem": "在一个信息物理系统（CPS）中，一个加热室被建模为一个由温度传感器监控的集总热容体。数字孪生通过传感器通道接收温度流，该通道易受传感器欺骗攻击。攻击者旨在注入一个欺骗信号，利用传感器接口暴露的攻击面，使数字孪生接收到的温度轨迹在一个预热区间内匹配一个物理上合理的热升曲线。\n\n该加热室的质量为 $m$，比热为 $c_p$，环境温度为 $T_a$，总散热系数为 $k$（例如，对于面积为 $A$、对流系数为 $h$ 的对流，$k = hA$）。执行器施加一个恒定的加热功率 $P$（实际值），而要模仿的目标曲线对应于一个恒定的加热功率 $P^{\\star}$（目标值）。对于集总系统，热力学第一定律得出能量平衡方程\n$$\nm c_p \\frac{dT(t)}{dt} = P - k\\big(T(t) - T_a\\big),\n$$\n初始条件为 $T(0) = T_a$。定义热时间常数 $\\tau_{th} = \\frac{m c_p}{k}$。\n\n温度传感器被建模为一个一阶线性时不变传递函数，其增益为 $k_s$（伏特/开尔文），时间常数为 $\\tau_s$，在时域中由以下方程控制\n$$\n\\tau_s \\frac{dy(t)}{dt} + y(t) = k_s T(t),\n$$\n初始条件为 $y(0) = k_s T(0)$。数字孪生所消耗的数字信号为\n$$\nr(t) = y(t) + s(t),\n$$\n其中 $s(t)$ 是攻击者在传感器后注入的附加欺骗信号。\n\n攻击者的目标是选择 $s(t)$，使得对于所有 $t \\in [0, t_f]$（其中 $t_f > 0$ 是关注的持续时间），$r(t)$ 与物理加热室由 $P^{\\star}$ 而非 $P$ 加热时产生的传感器跟踪输出相匹配，且在绝对容差 $\\epsilon$ 之内。设 $T^{\\star}(t)$ 是使用 $P^{\\star}$ 和 $T^{\\star}(0) = T_a$ 求解能量平衡方程得到的解，并设 $y^{\\star}(t)$ 是以 $T^{\\star}(t)$ 为输入和 $y^{\\star}(0) = k_s T_a$ 为初始条件求解传感器动力学方程得到的解。假设 $\\tau_{th} \\neq \\tau_s$ 且 $t \\geq 0$。\n\n仅从上述能量平衡和传感器微分方程出发，通过精确跟踪（即选择 $r(t) \\equiv y^{\\star}(t)$）推导所需的欺骗信号 $s(t)$ 的闭式表达式，以实现对所有 $t \\in [0, t_f]$ 都有 $|r(t) - y^{\\star}(t)| \\leq \\epsilon$。将 $s(t)$ 的最终答案表示为以伏特为单位、关于时间 $t$（以秒为单位）的函数，并且不要进行任何数值舍入。",
            "solution": "用户要求我找出攻击者必须注入的所需欺骗信号 $s(t)$，以使接收到的温度信号 $r(t)$ 精确匹配目标轨迹 $y^{\\star}(t)$。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- **系统动力学（加热室）：** $m c_p \\frac{dT(t)}{dt} = P - k(T(t) - T_a)$\n- **初始条件（加热室）：** $T(0) = T_a$\n- **参数（加热室）：** 质量 $m$、比热 $c_p$、环境温度 $T_a$、散热系数 $k$、实际加热功率 $P$、目标加热功率 $P^{\\star}$。\n- **定义（热时间常数）：** $\\tau_{th} = \\frac{m c_p}{k}$\n- **系统动力学（传感器）：** $\\tau_s \\frac{dy(t)}{dt} + y(t) = k_s T(t)$\n- **初始条件（传感器）：** $y(0) = k_s T(0)$\n- **参数（传感器）：** 增益 $k_s$、时间常数 $\\tau_s$。\n- **信号模型：** $r(t) = y(t) + s(t)$，其中 $s(t)$ 是欺骗信号。\n- **攻击者目标：** 对 $t \\in [0, t_f]$ 实现 $|r(t) - y^{\\star}(t)| \\leq \\epsilon$。\n- **方法：** 精确跟踪，即 $r(t) = y^{\\star}(t)$。\n- **目标轨迹：** $y^{\\star}(t)$ 是加热室由 $P^{\\star}$ 而非 $P$ 加热时对应的传感器输出。具体来说，$T^{\\star}(t)$ 是功率为 $P^{\\star}$、初始条件为 $T^{\\star}(0) = T_a$ 时加热室动力学方程的解，而 $y^{\\star}(t)$ 是输入为 $T^{\\star}(t)$、初始条件为 $y^{\\star}(0) = k_s T_a$ 时传感器动力学方程的解。\n- **约束：** $\\tau_{th} \\neq \\tau_s$。\n- **目标：** 找到 $s(t)$ 的闭式表达式。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于热力学第一定律（集总电容模型）和用于传感器的一阶线性时不变（LTI）系统模型。这些是工程学和物理学中标准且成熟的模型。信息物理系统（CPS）中的传感器欺骗问题是网络安全领域一个现实且关键的研究领域。\n- **良构性：** 该问题是数学上良构的。它涉及求解一个具有指定初始条件的线性常微分方程（ODE）组。所有必要的参数和关系都已定义。目标陈述清晰，精确跟踪条件 $r(t) = y^{\\star}(t)$ 消除了任何模糊性，从而可以得到 $s(t)$ 的唯一解。明确给出了约束条件 $\\tau_{th} \\neq \\tau_s$，这对于避免解中出现不定形式是必要的，表明了问题的精心构造。\n- **客观性：** 该问题以精确、客观和数学化的语言陈述，没有任何主观或有偏见的论断。\n\n**1.3. 结论与行动**\n该问题是有效的。它在科学上是合理的、良构的、客观的和完整的。我将继续推导解决方案。\n\n### 步骤2：推导欺骗信号 $s(t)$\n\n目标是找到实现精确跟踪的欺骗信号 $s(t)$，即 $r(t) = y^{\\star}(t)$。根据接收信号的定义 $r(t) = y(t) + s(t)$，我们可以将所需的欺骗信号表示为：\n$$\ns(t) = y^{\\star}(t) - y(t)\n$$\n为了找到 $s(t)$，我们必须首先找到实际传感器输出 $y(t)$ 和目标传感器输出 $y^{\\star}(t)$ 的显式表达式。这需要先求解加热室温度的微分方程，然后再求解传感器的响应。\n\n**2.1. 求解加热室温度 $T(t)$**\n能量平衡方程为：\n$$\nm c_p \\frac{dT(t)}{dt} = P - k\\big(T(t) - T_a\\big)\n$$\n使用定义 $\\tau_{th} = \\frac{m c_p}{k}$，我们可以将方程改写为：\n$$\n\\tau_{th} \\frac{dT(t)}{dt} = \\frac{P}{k} - (T(t) - T_a)\n$$\n$$\n\\tau_{th} \\frac{dT(t)}{dt} + T(t) = \\frac{P}{k} + T_a\n$$\n这是一个标准的一阶线性常微分方程。其解由一个齐次部分和一个特解（稳态）部分组成。稳态温度 $T_{ss}$ 可通过设置 $\\frac{dT}{dt} = 0$ 求得，即 $T_{ss} = \\frac{P}{k} + T_a$。\n通解的形式为 $T(t) = T_{ss} + C \\exp(-t/\\tau_{th})$。我们使用初始条件 $T(0) = T_a$ 来求常数 $C$：\n$$\nT_a = \\left(\\frac{P}{k} + T_a\\right) + C \\exp(0) \\implies C = -\\frac{P}{k}\n$$\n因此，实际温度轨迹为：\n$$\nT(t) = \\left(\\frac{P}{k} + T_a\\right) - \\frac{P}{k} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right) = T_a + \\frac{P}{k}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\\right)\n$$\n通过直接类比，对应于加热功率 $P^{\\star}$ 的目标温度轨迹 $T^{\\star}(t)$ 为：\n$$\nT^{\\star}(t) = T_a + \\frac{P^{\\star}}{k}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\\right)\n$$\n\n**2.2. 求解传感器输出 $y(t)$**\n传感器动力学方程如下：\n$$\n\\tau_s \\frac{dy(t)}{dt} + y(t) = k_s T(t)\n$$\n初始条件为 $y(0) = k_s T(0) = k_s T_a$。强迫函数为 $k_s T(t) = k_s T_a + \\frac{k_s P}{k}\\left(1 - \\exp(-t/\\tau_{th})\\right)$。这是一个关于 $y(t)$ 的一阶线性常微分方程，其强迫项由一个常数和一个指数项组成。通解是齐次解 $y_h(t) = A \\exp(-t/\\tau_s)$ 和一个特解 $y_p(t)$ 之和。根据强迫项的形式，我们寻求一个形式为 $y_p(t) = B + C \\exp(-t/\\tau_{th})$ 的特解。将此代入 $y(t)$ 的常微分方程中：\n$$\n\\tau_s \\left(-\\frac{C}{\\tau_{th}} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\\right) + \\left(B + C \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\\right) = k_s T_a + \\frac{k_s P}{k} - \\frac{k_s P}{k} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n$$\nB + C\\left(1 - \\frac{\\tau_s}{\\tau_{th}}\\right)\\exp\\left(-\\frac{t}{\\tau_{th}}\\right) = \\left(k_s T_a + \\frac{k_s P}{k}\\right) - \\frac{k_s P}{k} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n通过令常数项和指数项的系数相等（由于 $\\tau_{th} \\neq \\tau_s$，此方法有效）：\n- 常数项： $B = k_s T_a + \\frac{k_s P}{k}$\n- 指数项： $C\\left(1 - \\frac{\\tau_s}{\\tau_{th}}\\right) = -\\frac{k_s P}{k} \\implies C = -\\frac{k_s P/k}{1 - \\tau_s/\\tau_{th}} = -\\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)}$\n\n$y(t)$ 的通解为：\n$$\ny(t) = A \\exp\\left(-\\frac{t}{\\tau_s}\\right) + k_s T_a + \\frac{k_s P}{k} - \\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n使用初始条件 $y(0) = k_s T_a$：\n$$\nk_s T_a = A + k_s T_a + \\frac{k_s P}{k} - \\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)}\n$$\n$$\nA = \\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)} - \\frac{k_s P}{k} = \\frac{k_s P}{k}\\left(\\frac{\\tau_{th}}{\\tau_{th} - \\tau_s} - 1\\right) = \\frac{k_s P}{k}\\left(\\frac{\\tau_{th} - (\\tau_{th} - \\tau_s)}{\\tau_{th} - \\tau_s}\\right) = \\frac{k_s P \\tau_s}{k(\\tau_{th} - \\tau_s)}\n$$\n将 $A$ 代回，得到实际传感器输出 $y(t)$ 的完整解为：\n$$\ny(t) = k_s T_a + \\frac{k_s P}{k} + \\frac{k_s P \\tau_s}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n目标传感器输出 $y^{\\star}(t)$ 的形式相同，只需将 $P$ 替换为 $P^{\\star}$：\n$$\ny^{\\star}(t) = k_s T_a + \\frac{k_s P^{\\star}}{k} + \\frac{k_s P^{\\star} \\tau_s}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\frac{k_s P^{\\star} \\tau_{th}}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n\n**2.3. 计算欺骗信号 $s(t)$**\n最后，我们计算 $s(t) = y^{\\star}(t) - y(t)$。从 $y^{\\star}(t)$ 的表达式中减去 $y(t)$ 的表达式，$k_s T_a$ 项相互抵消。我们可以从剩余的项中提出功率差 $(P^{\\star} - P)$：\n$$\ns(t) = \\left(\\frac{k_s P^{\\star}}{k} - \\frac{k_s P}{k}\\right) + \\left(\\frac{k_s P^{\\star} \\tau_s}{k(\\tau_{th} - \\tau_s)} - \\frac{k_s P \\tau_s}{k(\\tau_{th} - \\tau_s)}\\right) \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\left(\\frac{k_s P^{\\star} \\tau_{th}}{k(\\tau_{th} - \\tau_s)} - \\frac{k_s P \\tau_{th}}{k(\\tau_{th} - \\tau_s)}\\right) \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n提出公因子后，得到欺骗信号的最终表达式：\n$$\ns(t) = \\frac{k_s(P^{\\star} - P)}{k} + \\frac{k_s(P^{\\star} - P)\\tau_s}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\frac{k_s(P^{\\star} - P)\\tau_{th}}{k(\\tau_{th} - \\tau_s)} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right)\n$$\n通过提出稳态差值，可以更紧凑地写为：\n$$\ns(t) = \\frac{k_s (P^{\\star} - P)}{k} \\left[ 1 + \\frac{\\tau_s}{\\tau_{th} - \\tau_s} \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\frac{\\tau_{th}}{\\tau_{th} - \\tau_s} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right) \\right]\n$$\n该表达式表示攻击者必须添加到真实传感器输出上的信号（以伏特为单位），以便在数字孪生上完美地模仿目标轨迹。",
            "answer": "$$\\boxed{\\frac{k_s (P^{\\star} - P)}{k} \\left[ 1 + \\frac{\\tau_s}{\\tau_{th} - \\tau_s} \\exp\\left(-\\frac{t}{\\tau_s}\\right) - \\frac{\\tau_{th}}{\\tau_{th} - \\tau_s} \\exp\\left(-\\frac{t}{\\tau_{th}}\\right) \\right]}$$"
        },
        {
            "introduction": "在了解了如何构建攻击之后，我们自然会转向防御策略。奇偶空间方法是利用系统冗余信息来检测异常和攻击的经典而强大的工具。本练习将指导您构建一个基于奇偶空间的检测器，并分析其对攻击的敏感性。更重要的是，本练习揭示了这种检测方法的根本局限性，通过一个精心设计的“隐形”攻击，您将看到攻击者如何能使其攻击在检测器面前完全遁形。",
            "id": "4206276",
            "problem": "一个信息物理系统 (CPS) 由一个冗余传感器套件监控。在给定的采样时刻，测量值被建模为 $y \\in \\mathbb{R}^{m}$，其中 $y = H x + v + a$，$x \\in \\mathbb{R}^{n}$ 是系统状态，$H \\in \\mathbb{R}^{m \\times n}$ 是一个已知的测量灵敏度矩阵，$v \\in \\mathbb{R}^{m}$ 是均值为零、协方差为对称正定矩阵 $\\Sigma \\in \\mathbb{R}^{m \\times m}$ 的高斯噪声，$a \\in \\mathbb{R}^{m}$ 是测量通道中的一个对抗性传感器攻击向量。给定一个满行秩的校验矩阵 $P \\in \\mathbb{R}^{p \\times m}$，它满足零化属性 $P H = 0$。\n\n通过形成一个消除标称状态影响的残差来构造一个校验空间检测器，并基于噪声协方差，使用白化的残差能量来定义一个统计上合理的标量检测统计量。然后，考虑一个与校验零空间对齐的隐蔽威胁向量，具体为 $a = \\epsilon a_{0}$，其中 $\\epsilon \\in \\mathbb{R}$ 且 $a_{0} \\in \\mathcal{N}(P)$，$\\mathcal{N}(P)$ 表示 $P$ 的零空间。将检测器对此攻击方向的小信号灵敏度定义为\n$$\nS \\triangleq \\lim_{\\epsilon \\to 0} \\frac{\\mathbb{E}\\!\\left[J(\\epsilon)\\right] - \\mathbb{E}\\!\\left[J(0)\\right]}{\\epsilon^{2}},\n$$\n其中 $J(\\epsilon)$ 是攻击幅度为 $\\epsilon$ 时检测器的标量统计量，$\\mathbb{E}[\\cdot]$ 表示关于测量噪声的期望。\n\n从冗余测量集中的校验关系的核心定义以及高斯噪声和二次型的标准属性出发，推导出 $S$ 的闭式解析表达式，该表达式以 $P$、$\\Sigma$ 和 $a_{0}$ 表示。最终答案必须是单个实数或闭式表达式。不需要四舍五入。",
            "solution": "用户希望推导校验空间检测器对特定类型隐蔽攻击的小信号灵敏度 $S$。推导过程将分为四个主要步骤：1) 构造校验空间残差和检测统计量，2) 计算受攻击时统计量的期望值，3) 推导通用灵敏度表达式，4) 针对问题中定义的特定攻击评估此表达式。\n\n步骤 1：构造检测器\n信息物理系统 (CPS) 的测量模型由下式给出\n$$y = H x + v + a$$\n其中 $y \\in \\mathbb{R}^{m}$ 是测量向量，$x \\in \\mathbb{R}^{n}$ 是状态向量，$H \\in \\mathbb{R}^{m \\times n}$ 是测量矩阵，$v \\in \\mathbb{R}^{m}$ 是均值为零、协方差为 $\\Sigma = \\Sigma^T > 0$ 的高斯噪声，$a \\in \\mathbb{R}^{m}$ 是一个对抗性攻击向量。\n\n校验空间检测器使用一个具有 $P H = 0$ 属性的校验矩阵 $P \\in \\mathbb{R}^{p \\times m}$ 来构造。该属性确保了所得信号独立于系统状态 $x$。通过将测量值 $y$ 投影到校验空间，形成一个残差向量 $r \\in \\mathbb{R}^{p}$：\n$$r = P y = P(H x + v + a)$$\n利用 $P H = 0$ 这一属性，残差的表达式可简化为：\n$$r = P H x + P v + P a = 0 \\cdot x + P v + P a = P v + P a$$\n残差 $r$ 是一个随机向量，其统计特性取决于噪声 $v$ 和攻击 $a$。残差的均值为：\n$$\\mathbb{E}[r] = \\mathbb{E}[P v + P a] = P\\mathbb{E}[v] + P a = P \\cdot 0 + Pa = Pa$$\n残差的协方差，记为 $\\Sigma_r$，为：\n$$\\Sigma_r = \\text{Cov}(r) = \\mathbb{E}\\left[(r-\\mathbb{E}[r])(r-\\mathbb{E}[r])^T\\right] = \\mathbb{E}\\left[(Pv)(Pv)^T\\right] = P\\mathbb{E}[vv^T]P^T = P \\Sigma P^T$$\n由于 $P$ 是满行秩且 $\\Sigma$ 是对称正定的，因此 $\\Sigma_r = P\\Sigma P^T$ 是一个 $p \\times p$ 的对称正定矩阵，因而是可逆的。\n\n一个统计上合理的标量检测统计量 $J$ 被定义为残差的白化能量。这对应于残差向量的马氏距离的平方，由下式给出：\n$$J = r^T \\Sigma_r^{-1} r = (Pv + Pa)^T (P\\Sigma P^T)^{-1} (Pv + Pa)$$\n\n步骤 2：计算统计量的期望值\n问题将攻击定义为 $a = \\epsilon a_0$，其中 $\\epsilon \\in \\mathbb{R}$ 是攻击幅度，$a_0 \\in \\mathbb{R}^m$ 是攻击方向。作为 $\\epsilon$ 函数的检测统计量是：\n$$J(\\epsilon) = (Pv + \\epsilon Pa_0)^T (P\\Sigma P^T)^{-1} (Pv + \\epsilon Pa_0)$$\n为了分析灵敏度，我们首先求出 $J(\\epsilon)$ 关于噪声 $v$ 的期望值。让我们展开二次型：\n$$J(\\epsilon) = v^T P^T (P\\Sigma P^T)^{-1} P v + 2\\epsilon v^T P^T (P\\Sigma P^T)^{-1} P a_0 + \\epsilon^2 a_0^T P^T (P\\Sigma P^T)^{-1} P a_0$$\n对每一项取期望：\n$$\\mathbb{E}[J(\\epsilon)] = \\mathbb{E}\\left[v^T P^T (P\\Sigma P^T)^{-1} P v\\right] + 2\\epsilon \\mathbb{E}\\left[v^T\\right] P^T (P\\Sigma P^T)^{-1} P a_0 + \\epsilon^2 a_0^T P^T (P\\Sigma P^T)^{-1} P a_0$$\n由于噪声是零均值的，$\\mathbb{E}[v] = 0$，这意味着 $\\mathbb{E}[v^T] = 0^T = 0$。因此中间项为零。\n$$\\mathbb{E}[J(\\epsilon)] = \\mathbb{E}\\left[v^T P^T (P\\Sigma P^T)^{-1} P v\\right] + \\epsilon^2 a_0^T P^T (P\\Sigma P^T)^{-1} P a_0$$\n第一项是一个标量，所以我们可以对标量 $A$ 使用迹的性质 $\\text{tr}(A) = A$，以及期望和迹的线性性质 $\\mathbb{E}\\left[\\text{tr}(X)\\right] = \\text{tr}\\left(\\mathbb{E}[X]\\right)$。\n$$\\mathbb{E}\\left[v^T P^T (P\\Sigma P^T)^{-1} P v\\right] = \\mathbb{E}\\left[\\text{tr}\\left(v^T P^T (P\\Sigma P^T)^{-1} P v\\right)\\right] = \\mathbb{E}\\left[\\text{tr}\\left(P v v^T P^T (P\\Sigma P^T)^{-1}\\right)\\right]$$\n$$= \\text{tr}\\left(\\mathbb{E}\\left[P v v^T P^T (P\\Sigma P^T)^{-1}\\right]\\right) = \\text{tr}\\left(P \\mathbb{E}[v v^T] P^T (P\\Sigma P^T)^{-1}\\right)$$\n由于 $\\mathbb{E}[v v^T] = \\Sigma$，这变为：\n$$= \\text{tr}\\left(P \\Sigma P^T (P\\Sigma P^T)^{-1}\\right) = \\text{tr}(I_p) = p$$\n这里，$I_p$ 是 $p \\times p$ 的单位矩阵。这一项是在没有攻击的情况下统计量的期望值，即 $\\mathbb{E}[J(0)] = p$。\n\n将此代回，我们得到受攻击时统计量的期望值：\n$$\\mathbb{E}[J(\\epsilon)] = p + \\epsilon^2 (Pa_0)^T (P\\Sigma P^T)^{-1} (Pa_0)$$\n\n步骤 3：推导通用灵敏度表达式\n小信号灵敏度 $S$ 定义为：\n$$S \\triangleq \\lim_{\\epsilon \\to 0} \\frac{\\mathbb{E}\\!\\left[J(\\epsilon)\\right] - \\mathbb{E}\\!\\left[J(0)\\right]}{\\epsilon^{2}}$$\n代入 $\\mathbb{E}[J(\\epsilon)]$ 和 $\\mathbb{E}[J(0)]$ 的表达式：\n$$S = \\lim_{\\epsilon \\to 0} \\frac{\\left(p + \\epsilon^2 (Pa_0)^T (P\\Sigma P^T)^{-1} (Pa_0)\\right) - p}{\\epsilon^{2}}$$\n$$S = \\lim_{\\epsilon \\to 0} \\frac{\\epsilon^2 (Pa_0)^T (P\\Sigma P^T)^{-1} (Pa_0)}{\\epsilon^{2}}$$\n消去 $\\epsilon^2$ 项，我们得到对方向为 $a_0$ 的攻击的通用灵敏度表达式：\n$$S = (Pa_0)^T (P\\Sigma P^T)^{-1} (Pa_0)$$\n\n步骤 4：针对特定隐蔽攻击进行评估\n问题指定了一种特殊类型的隐蔽攻击，其中攻击方向 $a_0$ 位于校验矩阵 $P$ 的零空间中。这表示为 $a_0 \\in \\mathcal{N}(P)$。根据零空间的定义，对于任何向量 $z \\in \\mathcal{N}(P)$，乘积 $Pz$ 都是零向量。因此，对于给定的攻击方向 $a_0$：\n$$P a_0 = 0$$\n这个条件意味着攻击被设计成能被校验矩阵 $P$ 完全零化，使其在残差 $r=Pv+Pa_0\\epsilon = Pv$ 中不可见。\n\n将此条件代入灵敏度 $S$ 的通用表达式中：\n$$S = (0)^T (P\\Sigma P^T)^{-1} (0)$$\n零向量与任何矩阵的乘积结果为零向量或零标量。因此，\n$$S = 0$$\n检测器对与校验矩阵零空间对齐的攻击向量的灵敏度为零。这个结果在逻辑上是一致的，因为根据校验空间检测器的定义，这种攻击是完全隐蔽的，并且在残差中不会产生任何可检测的特征。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在信息物理系统中，即使拥有完善的加密和有效的异常检测，系统在语义层面仍然可能存在漏洞。本练习探讨了一个现实场景，其中一个经过加密验证的合法控制命令，由于上下文的改变而引发了灾难性的后果。通过分析这个重放攻击案例，您将深入理解为何控制数据不仅需要加密保护其完整性，还必须与其时间、模式和状态等语义信息进行绑定，以确保系统真正的安全。",
            "id": "4206219",
            "problem": "一个化学反应器信息物理系统 (CPS) 由一个连续搅拌釜反应器 (CSTR) 和一个通过具有确定性调度的工业以太网连接的监控控制器组成。该控制器以周期 $T_s$ 实现离散时间状态反馈，使用估计状态 $\\hat{x}_k \\in \\mathbb{R}^n$ 来计算用于试剂阀的执行器指令 $u_k \\in \\mathbb{R}^m$。该装置在互斥模式 $m_k \\in \\{\\text{purge}, \\text{run}, \\text{shutdown}\\}$（吹扫、运行、停机）下运行，这些模式会改变 $u_k$ 的语义（例如，在 $\\text{purge}$ 模式下安全的同一指令 $u_k$ 在 $\\text{run}$ 模式下可能是危险的）。一个数字孪生 (DT) 维护着对装置状态的同步预测 $\\tilde{x}_k$ 和预期模式 $m_k$，作为验证工作流的一部分。\n\n所有从控制器到执行器的控制数据包都使用关联数据的认证加密 (AEAD)。对于密钥 $K$ 和 nonce $n$，传输的密文为 $c = \\mathrm{AEAD}_K(n, m, \\alpha)$，其中 $m$ 是明文，$\\alpha$ 是关联数据。根据标准的密码学定义，只要密钥 $K$ 是保密的并且 nonce 被正确管理，AEAD 就能在选择密文攻击下保证 $m$ 的机密性和 $(m, \\alpha)$ 的完整性。\n\n一个在网络上具有中间人 (MITM) 攻击能力（但无法访问端点机密）的攻击者，在 $\\text{purge}$ 模式期间记录一个有效的控制数据包 $c_k$，并在稍后的时间 $k'$（此时装置处于 $\\text{run}$ 模式）原封不动地重放它，不修改任何比特。执行器接受了该数据包（因为它通过了 AEAD 验证，并且解密后的 $u_k$ 在额定范围内），并在时间 $k'$ 应用了 $u_k$。由于其语义随 $m_{k'}$ 发生了变化，重放的指令导致反应器液位飙升超过安全阈值，违反了一个物理不变量。假设闭环在零延迟下是稳定的，即对于 $(A,B)$ 和反馈增益 $K$，谱半径 $\\rho(A+BK)  1$，但在陈旧输入下会恶化：当延迟 $d > \\tau_{\\max}/T_s$ 时，注入 $u_{k-d}$ 会违反安全性，其中 $\\tau_{\\max}$ 是从物理约束中导出的最大可容忍执行陈旧度。\n\n仅使用基本原理，即 AEAD 的密码学定义（除了算法输入的完整性之外，没有内置的新鲜性或语义绑定）、CPS 的因果关系和截止时间概念（只接受有界延迟内的控制输入以维持不变量），以及模式依赖控制的语义（$u_k$ 必须相对于 $(k, m_k, \\tilde{x}_k)$ 进行解释），论证认证加密在何种情况下对 CPS 是不足的，并确定强制执行控制信号语义完整性所需的最小协议级增强。特别地，从第一性原理出发进行推理，说明时间偏移和上下文混淆威胁向量在 AEAD 下为何仍然可行，以及协议字段和接受检查必须如何将 $u_k$ 绑定到时间和上下文以关闭这些攻击面。\n\n在保持假设与情景一致的同时，哪个选项最好地陈述了一个正确且充分的增强措施，以防止认证重放或跨上下文替换攻击违反语义完整性？\n\nA. 确保在 AEAD 下每个数据包的 nonce $n$ 是唯一的。由于 nonce 是唯一的，重放的数据包将无法通过验证，因此仅凭唯一性就足以防止语义滥用。\n\nB. 通过将 $(k, m_k, \\mathrm{ID}, h_k)$ 放入关联数据 $\\alpha$ 中，将每个控制数据包以密码学方式绑定到其离散时间索引 $k$、当前模式 $m_k$、执行器标识符 $\\mathrm{ID}$ 以及数字孪生上下文摘要 $h_k = H(\\tilde{x}_k, m_k)$。并且仅当执行器验证了以下条件时才接受该数据包：(i) 截止时间合规性 $|t_{\\mathrm{recv}} - t_{\\mathrm{stamp}}(k)| \\le \\delta$，对于固定的 $\\delta \\le \\tau_{\\max}$；(ii) $\\mathrm{ID}$ 与本地执行器身份匹配；以及 (iii) 本地计算的 $H(\\tilde{x}_k, m_k)$ 等于 $h_k$。即使密文和标签通过了 AEAD 验证，这种方法也能拒绝陈旧或跨模式的消息。\n\nC. 将 AEAD 内的消息认证码 (MAC) 标签长度增加到 $256$ 位。更长的标签使得伪造的概率可以忽略不计，从而无需额外的时间或上下文绑定即可消除语义重放的风险。\n\nD. 在控制器和执行器之间使用具有相互认证的传输层安全性 (TLS)。TLS 信道安全确保了源认证和机密性，因此在 TLS 内部使用 AEAD 就足够了；确定性网络保证了有界延迟，使得进一步的时间或上下文绑定变得多余。\n\nE. 依赖网络确定性：调度一个有界延迟 $d$ 并保持 $\\rho(A+BK)  1$。由于延迟是有界的且环路在零延迟下是稳定的，AEAD 确保了完整性；延迟界限内的重放不会违反语义，因此绑定到时间或上下文是不必要的。\n\nF. 向控制数据包添加单调序列号 $s_k$，并在执行器处维护一个滑动抗重放窗口以拒绝重复项。仅凭序列号就足以防止跨模式滥用，因为即使装置模式发生变化，重复项也会被阻止。",
            "solution": "用户希望我分析一个关于信息物理系统 (CPS) 网络安全的问题，并从给定的选项中确定最佳的对策。\n\n### 步骤 1：提取已知条件\n- **系统**：一个由监控控制器控制的连续搅拌釜反应器 (CSTR) CPS。\n- **控制**：周期为 $T_s$ 的离散时间状态反馈，使用估计状态 $\\hat{x}_k$ 计算控制指令 $u_k$。\n- **网络**：具有确定性调度的工业以太网。\n- **操作模式**：系统在互斥模式 $m_k \\in \\{\\text{purge}, \\text{run}, \\text{shutdown}\\}$（吹扫、运行、停机）下运行。\n- **语义依赖**：控制指令 $u_k$ 的效果取决于当前模式 $m_k$。在一种模式下安全的指令在另一种模式下可能很危险。\n- **数字孪生 (DT)**：一个同步模型维护着预测的状态 $\\tilde{x}_k$ 和预期的模式 $m_k$。\n- **密码学**：所有控制数据包均使用关联数据的认证加密 (AEAD)，定义为 $c = \\mathrm{AEAD}_K(n, m, \\alpha)$，其中 $K$ 是密钥， $n$ 是 nonce， $m$ 是明文（控制指令 $u_k$），$\\alpha$ 是关联数据。\n- **AEAD 保证**：保证 $m$ 的机密性和 $(m, \\alpha)$ 的完整性。\n- **攻击者模型**：网络上的中间人 (MITM)，不知道密钥 $K$。\n- **攻击场景**：攻击者记录在“吹扫”模式下发送的有效数据包 $c_k$，并在稍后系统处于“运行”模式时原封不动地重放。\n- **攻击后果**：执行器接受了重放的数据包，因为它通过了 AEAD 验证。在错误的模式上下文（$m_{k'}=\\text{run}$）下应用解密后的指令 $u_k$ 会导致物理安全违规。\n- **系统稳定性/安全性**：标称闭环系统是稳定的，零延迟下谱半径 $\\rho(A+BK)  1$。陈旧的输入会违反安全性，特别是当延迟 $d$ 超过最大可容忍陈旧度 $\\tau_{\\max}/T_s$ 时。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题陈述进行验证。\n\n- **科学依据充分**：该问题在控制理论（离散时间系统、稳定性）、计算机安全（密码学、AEAD、MITM、重放攻击）和信息物理系统（基于模式的控制、实时约束、语义攻击）的既定原则中有充分的依据。该场景是工业控制系统中安全挑战的典型例子。\n- **提法明确**：问题结构清晰。它定义了一个系统、一个安全机制、一个特定的攻击向量（导致语义混淆的重放）、一个导致的故障，并要求一个最小且充分的协议级防御措施。目标定义明确。\n- **客观**：问题使用精确、技术性的语言，没有主观或含糊的陈述。\n- **完整性和一致性**：问题提供了足够的信息来推断基本 AEAD 的不足以及稳健解决方案的需求。陈述“nonces are managed correctly”（nonce 被正确管理）是标准的密码学术语，意为“对于相同的密钥，nonce 不会重复用于新的加密”，这与重放攻击（其中整个原始数据包，包括 nonce，被重新发送）并不矛盾。执行器接受重放数据包的事实意味着其验证逻辑缺乏抗重放措施，而这正是需要修复的漏洞。\n- **现实性**：该场景非常现实。重放攻击是一个基本威胁，而利用上下文变化（如操作模式）的语义攻击是复杂 CPS 中的一个主要问题。\n- **其他缺陷**：问题并非微不足道、提法不当或基于错误逻辑。它解决了一个细微但关键的区别：密码学完整性与系统级语义完整性之间的区别。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。它为分析所提出的解决方案提供了合理且严谨的基础。可以继续进行求解过程。\n\n### 基于原理的推导\n该漏洞的核心在于 AEAD 所保证的与 CPS 安全性所要求的之间的差距。\n\n$1$. **AEAD 保证**：函数 $\\mathrm{Verify}_K(n, c, \\alpha)$ 当且仅当 $c$ 是对应于某个明文 $m$、在密钥 $K$、nonce $n$ 和关联数据 $\\alpha$ 下生成的真实密文时，才返回 true。它保护其所获参数的完整性。它证明了消息是由持有密钥 $K$ 的实体创建的。\n\n$2$. **AEAD 的局限性**：根据其标准定义，AEAD 本身不提供：\n    - **新鲜性**：它无法区分一微秒前创建的消息和一年前创建的消息。\n    - **上下文唯一性**：它不能阻止一个为某个上下文（例如 `time_k`, `mode_purge`）准备的有效消息在另一个上下文（例如 `time_k'`, `mode_run`）中被传递。\n\n$3$. **CPS 对语义完整性的要求**：为了安全，执行器不仅必须接收到密码学上真实可信的指令，而且该指令还必须是语义上有效的。语义有效性要求指令是：\n    - **及时的**：指令必须与*当前*控制周期相关，而不是陈旧的。问题用最大可容忍陈旧度 $\\tau_{\\max}$ 来量化这一点。这可以对抗**时间偏移**威胁。\n    - **上下文感知的**：指令必须在其生成的上下文中进行解释。这包括正确的操作模式 $m_k$、正确的接收执行器 $\\mathrm{ID}$，以及与作出决策所依据的系统状态 $\\tilde{x}_k$ 的一致性。这可以对抗**上下文混淆**威胁。\n\n$4$. **综合一个充分的增强措施**：为了弥补这一差距，协议必须进行增强，以使语义上下文变得明确且可验证。代表此上下文的元数据本身必须受到完整性保护。AEAD 的关联数据（$\\alpha$）字段是实现此目的的完美机制。因此，一个最小且充分的解决方案必须：\n    - **绑定到时间**：将与时间相关的值（例如，时间戳或离散时间索引 $k$）嵌入到 $\\alpha$ 中。接收方必须强制执行新鲜度策略，拒绝比从 $\\tau_{\\max}$ 导出的截止时间更早的数据包。\n    - **绑定到上下文**：将上下文标识符（例如，模式 $m_k$、执行器 $\\mathrm{ID}$）嵌入到 $\\alpha$ 中。接收方必须验证此预期上下文是否与其当前的本地上下文匹配。\n    - **绑定到状态（高级）**：为了获得更强的保证，通过将状态的哈希值 $h_k = H(\\tilde{x}_k, m_k)$ 包含在 $\\alpha$ 中，将指令绑定到控制器对系统状态的视图 $\\tilde{x}_k$。与 DT 同步的接收方可以重新计算哈希值并进行验证。\n\n重放包含此增强元数据的数据包的攻击者将被检测到。虽然对重放数据包的 AEAD 密码学检查会通过，但接收方后续的语义检查（新鲜性、模式、ID、状态哈希）将会失败，从而导致数据包被拒绝。\n\n### 逐项分析\n\n**A. 确保在 AEAD 下每个数据包的 nonce $n$ 是唯一的。由于 nonce 是唯一的，重放的数据包将无法通过验证，因此仅凭唯一性就足以防止语义滥用。**\n- **分析**：这个说法根本上是错误的。Nonce 唯一性是*发送方*在多次加密中维持 AEAD 安全性的先决条件。重放攻击涉及攻击者重新发送一个*完整、未经修改*的数据包，包括原始的 nonce。AEAD 的密码学验证功能本身不检查历史 nonce 的重用；它只验证当前数据包的完整性。虽然执行器*可以*被编程为存储所有接收到的 nonce 并检查重复（一种抗重放机制），但该选项错误地声称基本的 AEAD 验证会失败。此外，即使有了基于 nonce 的抗重放缓存，这种机制本身也无法解决上下文混淆攻击，例如将一个新鲜的数据包转发到错误的执行器。\n- **结论**：错误。\n\n**B. 通过将 $(k, m_k, \\mathrm{ID}, h_k)$ 放入关联数据 $\\alpha$ 中，将每个控制数据包以密码学方式绑定到其离散时间索引 $k$、当前模式 $m_k$、执行器标识符 $\\mathrm{ID}$ 以及数字孪生上下文摘要 $h_k = H(\\tilde{x}_k, m_k)$。并且仅当执行器验证了以下条件时才接受该数据包：(i) 截止时间合规性 $|t_{\\mathrm{recv}} - t_{\\mathrm{stamp}}(k)| \\le \\delta$，对于固定的 $\\delta \\le \\tau_{\\max}$；(ii) $\\mathrm{ID}$ 与本地执行器身份匹配；以及 (iii) 本地计算的 $H(\\tilde{x}_k, m_k)$ 等于 $h_k$。即使密文和标签通过了 AEAD 验证，这种方法也能拒绝陈旧或跨模式的消息。**\n- **分析**：该选项描述了一个完整且稳健的解决方案，它精确地遵循了从第一性原理推导出的逻辑。它正确地使用关联数据字段 $\\alpha$ 将指令以密码学方式绑定到其完整的语义上下文：时间 ($k$)、模式 ($m_k$)、接收方 ($\\mathrm{ID}$) 和状态摘要 ($h_k$)。然后，它指定了在接收方处必要的验证步骤：基于系统物理截止时间 $\\tau_{\\max}$ 的新鲜度检查、接收方检查，以及使用 DT 的上下文/状态一致性检查。这种多层验证正确地关闭了问题中描述的时间偏移和上下文混淆攻击面。\n- **结论**：正确。\n\n**C. 将 AEAD 内的消息认证码 (MAC) 标签长度增加到 $256$ 位。更长的标签使得伪造的概率可以忽略不计，从而无需额外的时间或上下文绑定即可消除语义重放的风险。**\n- **分析**：该选项混淆了两种不同类型的攻击：伪造和重放。更长的 MAC 标签会指数级地降低攻击者成功*猜测*出他们创建或修改的消息的有效标签的概率（伪造攻击）。然而，所描述的攻击是*重放*攻击，攻击者重新发送一个先前合法数据包的逐比特相同的副本。这个重放数据包中的 MAC 标签根据定义是有效的。增加其长度对这种攻击没有提供任何防御。\n- **结论**：错误。\n\n**D. 在控制器和执行器之间使用具有相互认证的传输层安全性 (TLS)。TLS 信道安全确保了源认证和机密性，因此在 TLS 内部使用 AEAD 就足够了；确定性网络保证了有界延迟，使得进一步的时间或上下文绑定变得多余。**\n- **分析**：TLS 建立了一个安全信道，但它默认情况下并不能防止应用层的重放攻击。攻击者可以捕获一个加密的 TLS 记录并重放它。接收方的 TLS 协议栈会成功解密它，并将封装的应用数据（控制指令）传递给执行器应用程序，后者将面临与原始问题相同的陈旧、脱离上下文的指令。网络确定性只为*合法的、新传输的*数据包限制了延迟；它不能阻止攻击者以任意延迟捕获并重新注入一个数据包。因此，在应用层进行明确的时间和上下文绑定仍然是至关重要的。\n- **结论**：错误。\n\n**E. 依赖网络确定性：调度一个有界延迟 $d$ 并保持 $\\rho(A+BK)  1$。由于延迟是有界的且环路在零延迟下是稳定的，AEAD 确保了完整性；延迟界限内的重放不会违反语义，因此绑定到时间或上下文是不必要的。**\n- **分析**：这个选项提出了一个错误的论点。主要的漏洞是由于系统*模式*（上下文）的变化而引起的语义变化，而不仅仅是延迟。一次重放几乎可以是瞬时的（例如，从时间 $k$ 到 $k+1$），完全在任何网络延迟界限内，但如果模式在这些时间步之间发生了变化，语义违规仍然会发生。稳定性条件 $\\rho(A+BK)  1$ 和有界网络延迟 $d$ 描述的是*标称*系统的行为，而不是一个受到注入了看似有效但上下文错误的输入的恶意语义攻击的系统。\n- **结论**：错误。\n\n**F. 向控制数据包添加单调序列号 $s_k$，并在执行器处维护一个滑动抗重放窗口以拒绝重复项。仅凭序列号就足以防止跨模式滥用，因为即使装置模式发生变化，重复项也会被阻止。**\n- **分析**：这代表了一个部分的解决方案。使用序列号和抗重放窗口有效地缓解了直接的重放攻击（时间偏移向量）。然而，它并*不充分*以防止所有形式的跨模式滥用。例如，它不能阻止攻击者将一个发往某个执行器的数据包重定向到另一个处于不兼容模式的执行器。因为序列号没有与执行器的身份或特定模式绑定，它只证明了消息在序列上是“新鲜的”，而不是在上下文上是适当的。选项 B 更优，因为它将消息绑定到完整的上下文，包括接收方 ID 和模式。因此，仅凭序列号是*不充分*的。\n- **结论**：错误。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}