{
    "hands_on_practices": [
        {
            "introduction": "在为信息物理系统设计规范时，精确性至关重要。信号时序逻辑 (Signal Temporal Logic, STL) 为描述连续信号随时间变化的行为提供了一种强大的形式化语言。通过练习 ，您将学习如何将一个自然语言描述的系统要求转换为 STL 公式，并计算其鲁棒性——一个量化指标，用于衡量系统行为在多大程度上满足或违反了该要求，从而为运行时监控提供了超越简单“真/假”判断的深刻见解。",
            "id": "4223138",
            "problem": "一个热室信息物理系统 (CPS) 由一个数字孪生监控，该数字孪生检查以信号时序逻辑 (STL) 表示的规范。被监控的信号是热室温度 $T(t)$，其被建模为一个连续时间轨迹。要求是：“温度保持在 $[T_{\\min},T_{\\max}]$ 范围内，直到其在 10 分钟内降至 $T_{\\max}-\\delta$ 以下。”将“在 10 分钟内”解释为从当前时间 $t=0$ 开始，长度为 600 秒的有界时间窗口，并将“保持在 $[T_{\\min},T_{\\max}]$ 范围内”解释为对 $T(t)$ 的一个闭区间约束。\n\n1. 使用有界“until”算子和形式为 $g(T(t)) \\ge 0$ 的原子谓词，编写一个单一的 STL 公式来捕获此要求。\n\n2. 使用 STL 的标准定量（鲁棒）语义，针对以下参数值和温度轨迹，计算您在时间 $t=0$ 时的 STL 公式的鲁棒性：\n- $T_{\\min} = 295$ K, $T_{\\max} = 330$ K, and $\\delta = 3$ K,\n- $T(t) = 329.4 - 0.02\\,t$ for $t \\in [0,600]$ seconds.\n\n将最终的鲁棒性值表示为单个实数，并以开尔文为单位。无需近似或四舍五入。",
            "solution": "用户提供的问题经评估有效，因为它具有科学依据、是适定的、客观的，并包含获得唯一解所需的充分信息。\n\n该问题分两部分解决。首先，构建一个信号时序逻辑 (STL) 公式来表示给定的要求。其次，针对指定的信号轨迹和参数，计算该公式的定量鲁棒性。\n\n第 1 部分：STL 公式构建\n\n要求是：“温度保持在 $[T_{\\min}, T_{\\max}]$ 范围内，直到其在 10 分钟内降至 $T_{\\max}-\\delta$ 以下。”这种结构意味着一个有界的“until”公式，$\\psi_1 \\mathcal{U}_I \\psi_2$。时间区间 $I$ 被指定为从时间 $t=0$ 开始的 600 秒窗口，因此 $I=[0, 600]$。\n\n子公式 $\\psi_1$ 表示条件“温度保持在 $[T_{\\min}, T_{\\max}]$ 范围内”。这是两个约束的合取：$T(t) \\ge T_{\\min}$ 和 $T(t) \\le T_{\\max}$。根据问题规范，这些必须表示为 $g(T(t)) \\ge 0$ 形式的原子谓词。\n约束 $T(t) \\ge T_{\\min}$ 直接就是 $T(t) - T_{\\min} \\ge 0$ 的形式。设该原子谓词为 $\\pi_1$。\n约束 $T(t) \\le T_{\\max}$ 等价于 $T_{\\max} - T(t) \\ge 0$。设该原子谓词为 $\\pi_2$。\n因此，子公式 $\\psi_1$ 是 $\\pi_1 \\land \\pi_2$。\n\n子公式 $\\psi_2$ 表示条件“其降至 $T_{\\max}-\\delta$ 以下”。这对应于不等式 $T(t)  T_{\\max} - \\delta$。虽然严格不等式不直接是 $g(T(t)) \\ge 0$ 的形式，但我们可以将其形式化为 $T(t) \\le T_{\\max} - \\delta$ 以符合所需的谓词结构。这得到 $(T_{\\max} - \\delta) - T(t) \\ge 0$。这种解释在鲁棒性分析中是标准的，因为 $g(x)  0$ 和 $g(x) \\ge 0$ 的定量语义是相同的。设该原子谓词为 $\\pi_3$。\n\n结合这些部分，完整的 STL 公式 $\\phi$ 是：\n$$ \\phi \\equiv ((T(t) - T_{\\min} \\ge 0) \\land (T_{\\max} - T(t) \\ge 0)) \\mathcal{U}_{[0, 600]} ((T_{\\max} - \\delta) - T(t) \\ge 0) $$\n\n第 2 部分：鲁棒性计算\n\n对于信号 $T$ 和时间 $t$，STL 公式 $\\phi$ 的定量（鲁棒）语义记为 $\\rho(\\phi, T, t)$，它衡量了公式被满足（正值）或违反（负值）的程度。我们需要计算 $\\rho(\\phi, T, 0)$。\n\n各算子的标准定量语义如下：\n- 原子谓词 $g(T(t)) \\ge 0$：$\\rho(g(T(t)) \\ge 0, T, t) = g(T(t))$。\n- 合取 $\\psi_a \\land \\psi_b$：$\\rho(\\psi_a \\land \\psi_b, T, t) = \\min(\\rho(\\psi_a, T, t), \\rho(\\psi_b, T, t))$。\n- 有界 until $\\psi_1 \\mathcal{U}_{[a,b]} \\psi_2$：$\\rho(\\psi_1 \\mathcal{U}_{[a,b]} \\psi_2, T, t) = \\sup_{t' \\in t+[a,b]} \\min(\\rho(\\psi_2, T, t'), \\inf_{t'' \\in [t, t']} \\rho(\\psi_1, T, t''))$。\n\n对于我们的公式 $\\phi$ 在 $t=0$ 时，这变为：\n$$ \\rho(\\phi, T, 0) = \\sup_{t' \\in [0, 600]} \\min\\left( \\rho(\\pi_3, T, t'), \\inf_{t'' \\in [0, t']} \\rho(\\pi_1 \\land \\pi_2, T, t'') \\right) $$\n\n给定参数 $T_{\\min} = 295$ K, $T_{\\max} = 330$ K, $\\delta = 3$ K，以及温度轨迹 $T(t) = 329.4 - 0.02t$（对于 $t \\in [0, 600]$ 秒）。\n\n首先，我们计算每个原子谓词的鲁棒性，作为时间 $t$ 的函数：\n- $\\rho(\\pi_1, T, t) = T(t) - T_{\\min} = (329.4 - 0.02t) - 295 = 34.4 - 0.02t$。\n- $\\rho(\\pi_2, T, t) = T_{\\max} - T(t) = 330 - (329.4 - 0.02t) = 0.6 + 0.02t$。\n- $\\rho(\\pi_3, T, t) = (T_{\\max} - \\delta) - T(t) = (330 - 3) - (329.4 - 0.02t) = 327 - 329.4 + 0.02t = -2.4 + 0.02t$。\n\n接下来，我们计算合取 $\\psi_1 = \\pi_1 \\land \\pi_2$ 的鲁棒性：\n$$ \\rho(\\psi_1, T, t) = \\min(\\rho(\\pi_1, T, t), \\rho(\\pi_2, T, t)) = \\min(34.4 - 0.02t, 0.6 + 0.02t) $$\n函数 $34.4 - 0.02t$ 是递减的，而 $0.6 + 0.02t$ 是递增的。当 $34.4 - 0.02t = 0.6 + 0.02t$ 时它们相等，解得 $0.04t = 33.8$，即 $t = 845$ 秒。由于我们关心的 $t$ 的时间区间是 $[0, 600]$，完全低于这个交点，因此在整个区间内 $0.6 + 0.02t$ 这一项都更小。\n因此，对于 $t \\in [0, 600]$，$\\rho(\\psi_1, T, t) = 0.6 + 0.02t$。\n\n现在我们计算内部的下确界项 $\\inf_{t'' \\in [0, t']} \\rho(\\psi_1, T, t'')$，对于任何 $t' \\in [0, 600]$。\n$$ \\inf_{t'' \\in [0, t']} (0.6 + 0.02t'') $$\n由于 $0.6 + 0.02t''$ 是一个递增函数，其在区间 $[0, t']$ 上的下确界出现在区间的起点，即 $t''=0$。\n因此，下确界的值为 $0.6 + 0.02(0) = 0.6$。\n\n我们将此常数值代回主鲁棒性公式中：\n$$ \\rho(\\phi, T, 0) = \\sup_{t' \\in [0, 600]} \\min(\\rho(\\pi_3, T, t'), 0.6) $$\n$$ \\rho(\\phi, T, 0) = \\sup_{t' \\in [0, 600]} \\min(-2.4 + 0.02t', 0.6) $$\n\n设 $f(t') = \\min(-2.4 + 0.02t', 0.6)$。我们需要找到 $f(t')$ 在区间 $[0, 600]$ 上的上确界。\n函数 $-2.4 + 0.02t'$ 是递增的。因此，函数 $f(t')$ 将会递增，直到达到常数值 $0.6$，然后将保持在 $0.6$。转折点发生在 $-2.4 + 0.02t' = 0.6$ 时，这得到 $0.02t' = 3.0$，即 $t' = 150$ 秒。\n- 对于 $t' \\in [0, 150]$，$f(t') = -2.4 + 0.02t'$。其值从 $f(0) = -2.4$ 增加到 $f(150) = 0.6$。\n- 对于 $t' \\in (150, 600]$，$f(t') = 0.6$。\n因此，$f(t')$ 在区间 $[0, 600]$ 上的上确界（最大值）是 $0.6$。\n\n鲁棒性值是一个标量，但它继承了信号的单位，即温度单位开尔文 (K)。因此，最终的鲁棒性是 $0.6$ K。",
            "answer": "$$\n\\boxed{0.6}\n$$"
        },
        {
            "introduction": "从监控已观察到的行为转向基于系统模型预测未来事件的概率，是形式化验证的一个重要飞跃。对于许多安全关键系统而言，我们需要对随机事件（如组件故障）的可能性进行量化分析。练习  将指导您如何使用连续时间马尔可夫链 (Continuous-Time Markov Chain, CTMC) 对系统可靠性进行建模，并应用计算方法来精确量化系统发生故障的风险，这反映了 PRISM 等概率模型检测工具的核心功能。",
            "id": "4223185",
            "problem": "您的任务是复现概率符号模型检测器 (PRISM) 中使用的可达性查询的量化语义，该查询用于分析信息物理系统 (CPS) 的可靠性属性。一个 CPS 数字孪生被建模为连续时间马尔可夫链 (CTMC)，其状态表示功能正常的相同且独立的冗余组件的数量，并包含一个吸收失效状态。要检验的属性是系统在有限的任务时间内到达吸收失效状态的概率，用连续随机逻辑 (CSL) 表示为 $P=?\\,[F_{\\leq T}\\,\\text{failure}]$，其中 $T$ 是任务时间。\n\n模型规范：\n- 考虑 $n$ 个相同、独立的组件并行运行，无修复。该 CTMC 具有状态 $\\{0,1,2,\\dots,n\\}$，其中状态 $k$ 表示有 $k$ 个组件正常工作，状态 $0$ 是吸收（失效）状态。\n- 每个正常工作的组件以恒定速率 $\\lambda$（单位为 $\\text{s}^{-1}$）失效。对于 $k \\in \\{1,\\dots,n\\}$，状态转移仅以速率 $k\\lambda$ 从状态 $k$ 发生到状态 $k-1$。\n- 初始状态为 $n$（所有组件均正常工作）。\n\n基本原理和目标计算：\n- 使用柯尔莫哥洛夫前向方程计算 CTMC 的瞬态概率，$\\frac{d}{dt}\\,\\mathbf{p}(t) = \\mathbf{p}(t)\\,\\mathbf{Q}$，其中 $\\mathbf{Q}$ 是该 CTMC 的无穷小生成元矩阵，$\\mathbf{p}(t)$ 是时间 $t$ 的状态概率行向量。\n- 在任务时间 $T$ 内的失效概率等于时间 $T$ 时状态 $0$ 中的概率质量，因为失效状态是吸收状态。通过求解前向方程计算 $\\mathbf{p}(T)$ 并报告 $\\mathbf{p}(T)[0]$。\n\n单位要求：\n- 任务时间 $T$ 以秒为单位表示，即 $T$ 以 $\\text{s}$ 为单位提供和使用。\n- 失效率 $\\lambda$ 以 $\\text{s}^{-1}$ 为单位给出。\n- 概率是无量纲的；以 $[0,1]$ 区间内的小数值报告。\n\n测试套件：\n- 实现一个程序，为以下参数集计算任务时间内的失效概率。每个测试用例是一个元组 $(n,\\lambda,T)$。\n    - 案例 A（正常路径）：$(n=2,\\;\\lambda=1\\times 10^{-5}\\,\\text{s}^{-1},\\;T=3600\\,\\text{s})$。\n    - 案例 B（高风险边缘情况）：$(n=3,\\;\\lambda=5\\times 10^{-4}\\,\\text{s}^{-1},\\;T=7200\\,\\text{s})$。\n    - 案例 C（边界条件）：$(n=5,\\;\\lambda=1\\times 10^{-3}\\,\\text{s}^{-1},\\;T=0\\,\\text{s})$。\n    - 案例 D（极高可靠性，长任务）：$(n=4,\\;\\lambda=1\\times 10^{-7}\\,\\text{s}^{-1},\\;T=100000\\,\\text{s})$。\n\n算法要求：\n- 构造无穷小生成元矩阵 $\\mathbf{Q} \\in \\mathbb{R}^{(n+1)\\times(n+1)}$，其元素为 $\\mathbf{Q}[k,k-1] = k\\lambda$（当 $k \\geq 1$），$\\mathbf{Q}[k,k] = -k\\lambda$（当 $k \\geq 1$），以及 $\\mathbf{Q}[0,0] = 0$，所有其他元素均为 $0$。\n- 使用初始分布 $\\mathbf{p}(0)$，其中 $\\mathbf{p}(0)[n] = 1$ 且对于 $k \\neq n$ 时 $\\mathbf{p}(0)[k] = 0$。\n- 计算 $\\mathbf{p}(T)$ 并返回失效概率 $\\mathbf{p}(T)[0]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与上述测试用例相同。例如，打印 $[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D]$，其中每个条目是计算出的 $[0,1]$ 区间内的小数概率。",
            "solution": "该问题是有效的，因为它在信息物理系统使用连续时间马尔可夫链 (CTMC) 进行可靠性分析的领域内，提出了一个科学上合理、适定且自洽的任务。该问题是计算系统在指定的任务时间 $T$ 内发生失效的概率。\n\n系统的状态由功能正常的组件数量 $k$ 定义，初始时有 $n$ 个相同且独立的组件。因此，状态集为 $\\{n, n-1, \\dots, 1, 0\\}$。状态 $k$ 表示有 $k$ 个工作组件，状态 $0$ 是吸收失效状态。由于在状态 $k$ 中的 $k$ 个组件中的每一个都以恒定速率 $\\lambda$ 独立失效，因此从状态 $k$ 到状态 $k-1$ 的总转移速率是各个失效率之和，即 $k\\lambda$。这描述了一个纯死亡过程。\n\n状态上概率分布的演化由柯尔莫哥洛夫前向方程控制，这是一个线性一阶常微分方程组。对于状态概率的行向量 $\\mathbf{p}(t) = [p_0(t), p_1(t), \\dots, p_n(t)]$，方程为：\n$$\n\\frac{d}{dt}\\mathbf{p}(t) = \\mathbf{p}(t)\\mathbf{Q}\n$$\n其中 $\\mathbf{Q}$ 是无穷小生成元矩阵。元素 $\\mathbf{Q}_{ij}$（对于 $i \\neq j$）表示从状态 $i$ 到状态 $j$ 的转移速率。\n\n状态从 $0$ 到 $n$ 索引。生成元矩阵 $\\mathbf{Q}$ 是一个 $(n+1) \\times (n+1)$ 的矩阵，其元素由转移速率定义：\n- 对于 $k \\in \\{1, 2, \\dots, n\\}$，从状态 $k$ 到状态 $k-1$ 的转移以速率 $k\\lambda$ 发生。这对应于矩阵元素 $\\mathbf{Q}_{k, k-1} = k\\lambda$。\n- 状态 $0$ 是一个吸收状态，意味着没有从该状态转出的转移。因此，$\\mathbf{Q}$ 的第 $0$ 行全为零：对于所有 $j \\in \\{0, \\dots, n\\}$，$\\mathbf{Q}_{0,j} = 0$。\n- $\\mathbf{Q}$ 的对角线元素定义为每行之和为零。因此，$\\mathbf{Q}_{k,k} = -\\sum_{j\\neq k} \\mathbf{Q}_{k,j}$。对于 $k \\in \\{1, \\dots, n\\}$，唯一的出向转移是到状态 $k-1$，所以 $\\mathbf{Q}_{k,k} = -k\\lambda$。对于 $k=0$，$\\mathbf{Q}_{0,0} = 0$。\n- 所有其他非对角线元素均为零，因为没有其他转移是可能的。\n\n$\\mathbf{Q}$ 矩阵的一般结构是（行和列从 0 到 n 索引）：\n$$\n\\mathbf{Q} =\n\\begin{pmatrix}\n0  0  0  \\cdots  0  0 \\\\\n\\lambda  -\\lambda  0  \\cdots  0  0 \\\\\n0  2\\lambda  -2\\lambda  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  n\\lambda  -n\\lambda\n\\end{pmatrix}\n$$\n请注意，状态的索引是 $\\{0, 1, \\dots, n\\}$，但其功能意义是相反的：状态 $n$ 是初始的完全功能状态，而状态 $0$ 是最终的失效状态。矩阵的行和列从 $0$ 到 $n$ 索引以对应这些状态。\n\n系统开始时所有 $n$ 个组件都正常工作。这定义了初始概率分布 $\\mathbf{p}(0)$，它是一个行向量，在对应于状态 $n$ 的位置为 $1$，其他位置为 $0$：\n$$\n\\mathbf{p}(0) = [0, 0, \\dots, 0, 1]\n$$\n其中 $1$ 在索引 $n$ 的位置。\n\n带有初始条件 $\\mathbf{p}(0)$ 的柯尔莫哥洛夫前向方程的解由矩阵指数给出：\n$$\n\\mathbf{p}(t) = \\mathbf{p}(0)e^{\\mathbf{Q}t}\n$$\n我们关心的是在任务时间 $T$ 时处于失效状态（状态 $0$）的概率。这是向量 $\\mathbf{p}(T)$ 的元素 $p_0(T)$。\n\n为了计算 $\\mathbf{p}(T)$，我们首先计算矩阵指数 $e^{\\mathbf{Q}T}$。令 $\\mathbf{P}(T) = e^{\\mathbf{Q}T}$。那么瞬态概率向量为 $\\mathbf{p}(T) = \\mathbf{p}(0)\\mathbf{P}(T)$。由于 $\\mathbf{p}(0)$ 除了在索引 $n$ 处为 $1$ 外，其他地方都为零，因此向量 $\\mathbf{p}(T)$ 就是矩阵 $\\mathbf{P}(T)$ 的最后一行（第 $n$ 行）。\n$$\n\\mathbf{p}(T) = [ \\mathbf{P}(T)_{n,0}, \\mathbf{P}(T)_{n,1}, \\dots, \\mathbf{P}(T)_{n,n} ]\n$$\n所需的失效概率 $P(F_{\\leq T}\\,\\text{failure}) = p_0(T)$，是该向量的第一个元素，对应于矩阵 $e^{\\mathbf{Q}T}$ 的第 $n$ 行、第 $0$ 列的元素：\n$$\np_0(T) = \\left(e^{\\mathbf{Q}T}\\right)_{n,0}\n$$\n对于每个测试用例，将通过构造相应的 $\\mathbf{Q}$ 矩阵，使用数值库函数（`scipy.linalg.expm`）计算矩阵指数，并提取指定元素来计算此值。\n对于 $T=0\\,\\text{s}$ 的边界情况，我们有 $\\mathbf{p}(0) = \\mathbf{p}(0)e^{\\mathbf{Q} \\cdot 0} = \\mathbf{p}(0)e^{\\mathbf{0}} = \\mathbf{p}(0)\\mathbf{I} = \\mathbf{p}(0)$。由于 $\\mathbf{p}(0) = [0, \\dots, 0, 1]$，处于状态 $0$ 的概率是 $p_0(0)=0$，符合预期。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the probability of system failure for a CTMC model of a redundant component system.\n    The problem is solved for a suite of test cases.\n    \"\"\"\n\n    # Test suite: Each case is a tuple (n, lambda, T)\n    # n: number of initial components\n    # lambda: failure rate of a single component (in s^-1)\n    # T: mission time (in s)\n    test_cases = [\n        # Case A (happy path)\n        (2, 1e-5, 3600),\n        # Case B (high-hazard edge)\n        (3, 5e-4, 7200),\n        # Case C (boundary condition)\n        (5, 1e-3, 0),\n        # Case D (extremely reliable, long mission)\n        (4, 1e-7, 100000),\n    ]\n\n    results = []\n    for n, lam, T in test_cases:\n        # The CTMC has n+1 states, from 0 (failure) to n (all components working).\n        # We index the states directly, so the matrix size is (n+1)x(n+1).\n        dim = n + 1\n        \n        # Construct the infinitesimal generator matrix Q.\n        # Q[i, j] is the transition rate from state i to state j.\n        Q = np.zeros((dim, dim))\n        \n        for k in range(1, dim):\n            # For state k (k components working), a transition to k-1 occurs\n            # if any of the k components fail.\n            # Transition rate from state k to state k-1 is k*lambda.\n            Q[k, k - 1] = k * lam\n            \n            # The diagonal element Q[k, k] is the negative sum of rates out of state k.\n            Q[k, k] = -k * lam\n            \n        # State 0 is absorbing, so the first row of Q is all zeros, which is\n        # the default from np.zeros.\n\n        # The solution to the Kolmogorov forward equation p'(t) = p(t)Q is\n        # p(t) = p(0) * expm(Q*t), where expm is the matrix exponential.\n        \n        # If T=0, expm(Q*T) is the identity matrix. The probability of failure is 0.\n        # We can handle this as a special case to avoid floating point inaccuracies,\n        # although the numerical computation will also yield a result very close to 0.\n        if T == 0:\n            failure_prob = 0.0\n        else:\n            # Compute the matrix P(T) = expm(Q*T).\n            # The scipy.linalg.expm function is a reliable way to compute this.\n            P_T = expm(Q * T)\n            \n            # The initial state is n (all components working).\n            # The initial probability vector p(0) is [0, 0, ..., 1].\n            # Therefore, the probability vector at time T, p(T), is the n-th row\n            # of the matrix P(T).\n            \n            # The probability of failure is the probability of being in state 0.\n            # This is the 0-th element of the n-th row of P(T).\n            failure_prob = P_T[n, 0]\n            \n        results.append(failure_prob)\n\n    # Format the final output as a comma-separated list in brackets.\n    # Convert each float result to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "演绎验证的目标是证明系统在所有可能的行为下都是安全的，这为安全关键控制系统提供了最高级别的保证。此方法通常依赖于微分动态逻辑 (Differential Dynamic Logic, dL) 等框架，并结合李雅普诺夫函数和不变量等概念。练习  以一个车道保持辅助系统为案例，展示了如何为复杂的混合系统推导安全边界，即使在存在外部不确定性的情况下也能确保安全，这是开发可证明安全的自主系统的核心技能。",
            "id": "4223206",
            "problem": "给定一个车道保持信息物理系统 (CPS)，其横向动力学由一个线性二阶常微分方程建模。系统状态包括横向偏移量 $y$ (单位：米) 和横向速度 $v$ (单位：米/秒)，其动力学方程为\n$$\n\\dot{y} = v,\\quad \\dot{v} = -2\\zeta\\omega v - \\omega^2 y + u + w,\n$$\n其中 $\\omega > 0$ 是自然频率 (单位：弧度/秒)，$\\zeta \\ge 0$ 是阻尼比 (无量纲)，$u$ 是反馈控制输入 (单位：米/秒²)，$w$ 是一个可测量的扰动 (单位：米/秒²)，满足幅度界限 $|w(t)| \\le w_{\\max}$ 对所有 $t \\ge 0$ 成立。假设车道总宽度为 $L$ (单位：米)，因此安全要求对所有 $t \\ge 0$ 均有 $|y(t)| \\le L/2$。\n\n控制器是线性的，并且仅使用横向速度反馈：\n$$\nu = -k v,\n$$\n其中增益 $k \\ge 0$。当 $|u(t)| > a_{\\max}$ 时，执行器会饱和，其中 $a_{\\max} > 0$ 是执行器极限 (单位：米/秒²)。因此，为了可接受，控制必须对所有 $t \\ge 0$ 满足 $|u(t)| \\le a_{\\max}$。初始条件为 $y(0) = y_0$ (单位：米) 和 $v(0) = v_0$ (单位：米/秒)。\n\n利用微分方程的基本定义、Lyapunov 函数、Cauchy–Schwarz 不等式和比较引理 (或等效地，Grönwall 型推理)，构造一个适用于微分动态逻辑 (dL) 的形式化安全证明义务，并描述如何在 KeYmaera X 中通过引入一个微分幽灵变量来处理一个辅助不等式并获得状态的可证明界限，从而完成该证明。具体来说：\n\n- 从系统动力学出发，提出一个二次能量候选函数 $V(y,v)$，该函数能够在其沿系统轨迹的导数中消除交叉项。\n- 利用微分幽灵的思想——一个具有指数稳定线性动力学的辅助标量变量，该变量是能量平方根的上界——来获得一个形式为 $\\dot{Z} \\le -\\alpha Z + \\beta |w|$ 的标量微分不等式，其中合适的 $Z \\ge 0$，且显式参数 $\\alpha > 0$ 和 $\\beta \\ge 0$ 由系统参数 $\\omega$、$\\zeta$ 和 $k$ 导出。\n- 推导出 $\\sup_{t \\ge 0} |y(t)|$ 的一个闭式界，该界由 $\\omega$、$\\zeta$、$k$、$w_{\\max}$、$y_0$ 和 $v_0$ 表示。您的推导必须清楚地说明辅助幽灵变量如何证明作为该界限基础的比较不等式是成立的。\n- 给出一个保证执行器永不饱和的条件，即建立一个界限以确保对所有 $t \\ge 0$ 都有 $|u(t)| \\le a_{\\max}$。\n- 将这些组合成一个单一的决策过程，该过程返回一个布尔值，指示对于给定的参数，车道安全性和执行器可接受性是否对所有 $t \\ge 0$ 都成立。\n\n您的程序必须实现所推导出的界限和决策过程，并评估以下测试套件。除非另有说明，以下所有符号、变量和数字均代表标准数学量，并且必须以国际单位制 (SI) 解释：\n\n- 测试用例 1：$\\omega = 1.5$, $\\zeta = 0.7$, $k = 1.0$, $w_{\\max} = 0.2$, $y_0 = 0.2$, $v_0 = 0.0$, $L = 3.6$, $a_{\\max} = 3.0$。\n- 测试用例 2：$\\omega = 1.2$, $\\zeta = 0.2$, $k = 0.3$, $w_{\\max} = 0.5$, $y_0 = 1.6$, $v_0 = 0.1$, $L = 3.6$, $a_{\\max} = 2.0$。\n- 测试用例 3：$\\omega = 2.0$, $\\zeta = 0.5$, $k = 3.0$, $w_{\\max} = 1.0$, $y_0 = 0.9$, $v_0 = 0.0$, $L = 3.2$, $a_{\\max} = 1.0$。\n- 测试用例 4：$\\omega = 0.8$, $\\zeta = 1.0$, $k = 0.0$, $w_{\\max} = 0.05$, $y_0 = 0.0$, $v_0 = 0.0$, $L = 3.0$, $a_{\\max} = 0.5$。\n- 测试用例 5：$\\omega = 0.6$, $\\zeta = 0.05$, $k = 0.0$, $w_{\\max} = 0.8$, $y_0 = 1.0$, $v_0 = 0.5$, $L = 3.0$, $a_{\\max} = 2.0$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。如果参数对所有 $t \\ge 0$ 都通过了车道安全性和执行器可接受性检查，则每个条目应为小写字符串 $true$，否则为 $false$。例如：$[true,false,true,\\dots]$。",
            "solution": "该问题要求为一个车道保持信息物理系统 (CPS) 推导形式化的安全性和可接受性证明。该系统由一个二阶线性常微分方程建模，包含速度反馈控制器、执行器饱和限制和外部扰动。这涉及到推导一组充分条件，以保证车辆的横向偏移量始终保持在车道边界内，并且控制力始终保持在执行器的能力范围内。\n\n### 步骤 1：系统建模\n系统动力学方程为：\n$$\n\\dot{y} = v\n$$\n$$\n\\dot{v} = -2\\zeta\\omega v - \\omega^2 y + u + w\n$$\n控制律为 $u = -kv$。将其代入动力学方程，我们得到闭环系统：\n$$\n\\dot{y} = v\n$$\n$$\n\\dot{v} = -\\omega^2 y - (2\\zeta\\omega + k) v + w\n$$\n我们定义 $c = 2\\zeta\\omega + k$。参数 $c$ 代表系统的总有效阻尼系数，它来自车辆的自然动力学特性 ($\\zeta$) 和控制反馈 ($k$)。问题约束 $\\omega > 0$、$\\zeta \\ge 0$ 和 $k \\ge 0$ 确保了 $c \\ge 0$。我们将假设 $c > 0$，因为一个 $c=0$ (无阻尼) 的系统在持续扰动下是不稳定的。该系统可以写成状态空间形式 $\\dot{\\mathbf{x}} = A\\mathbf{x} + Bw$，其中 $\\mathbf{x} = [y, v]^T$，\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -\\omega^2  -c \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n### 步骤 2：基于 Lyapunov 的分析\n为了分析系统的稳定性和有界性，我们提出了一个二次 Lyapunov 候选函数 $V(y, v)$。根据题目的建议，我们选择一种能够表示系统总能量并在其时间导数中消除交叉项的形式。一个合适的候选函数是势能 ($\\propto y^2$) 和动能 ($\\propto v^2$) 的加权和：\n$$\nV(y, v) = \\omega^2 y^2 + v^2\n$$\n由于 $\\omega > 0$，该函数对于所有 $(y, v) \\neq (0, 0)$ 都是正定的。$V$ 沿系统轨迹的时间导数为：\n$$\n\\dot{V} = \\frac{d}{dt}V(y(t), v(t)) = \\frac{\\partial V}{\\partial y}\\dot{y} + \\frac{\\partial V}{\\partial v}\\dot{v}\n$$\n$$\n\\dot{V} = (2\\omega^2 y)(v) + (2v)(-\\omega^2 y - cv + w)\n$$\n$$\n\\dot{V} = 2\\omega^2 yv - 2\\omega^2 yv - 2cv^2 + 2vw = -2cv^2 + 2vw\n$$\n涉及 $yv$ 的交叉项已成功消除。\n\n### 步骤 3：微分幽灵变量和定界\n导数 $\\dot{V}$ 不是负定的，所以我们不能直接得出渐近稳定性或轻易找到一个界。项 $2vw$ 可以为正，代表来自扰动的能量注入。为了处理这个问题，我们遵循题目的指示，引入一个辅助变量，即一个“微分幽灵”，这将使我们能够使用比较引理。\n\n我们定义一个变量 $Z = \\sqrt{V} = \\sqrt{\\omega^2 y^2 + v^2}$。$Z$ 是状态向量的一个加权欧几里得范数。当 $Z > 0$ 时，其时间导数为：\n$$\n\\dot{Z} = \\frac{\\dot{V}}{2\\sqrt{V}} = \\frac{-2cv^2 + 2vw}{2Z} = \\frac{-cv^2 + vw}{Z}\n$$\n我们可以使用 Cauchy-Schwarz 不等式 $vw \\le |v||w|$ 以及 $|v| \\le \\sqrt{\\omega^2 y^2 + v^2} = Z$ 这一事实来界定扰动项。\n$$\n\\dot{Z} \\le \\frac{-cv^2 + |v||w|}{Z} \\le \\frac{-cv^2}{Z} + \\frac{Z|w|}{Z} = \\frac{-cv^2}{Z} + |w|\n$$\n这个不等式仍然通过项 $-cv^2/Z$ 依赖于状态。为了建立一个形如 $\\dot{Z} \\le -\\alpha Z + \\beta|w|$ 的微分不等式，我们必须找到一个常数 $\\alpha > 0$，使得 $-cv^2/Z \\le -\\alpha Z$ 与系统动力学相关。\n\n这条路径很微妙。一个更直接建立输入到状态稳定性 (ISS) 估计的方法是认识到，对于 $c>0, \\omega>0$，齐次线性系统 ($\\mathbf{w}=0$) 是指数稳定的。收敛速率由矩阵 $A$ 具有最大实部的特征值（“最慢模式”）决定。特征值是特征方程 $\\lambda^2 + c\\lambda + \\omega^2 = 0$ 的根：\n$$\n\\lambda_{1,2} = \\frac{-c \\pm \\sqrt{c^2 - 4\\omega^2}}{2}\n$$\n系统最慢模式的衰减率，我们记为 $\\alpha$，是特征值最大实部的负值：\n$$\n\\alpha = -\\max(\\Re(\\lambda_1), \\Re(\\lambda_2))\n$$\n根据判别式，我们有两种关于特征值的情况：\n1.  **欠阻尼/临界阻尼 ($c \\le 2\\omega$)：** 两个特征值的实部均为 $-c/2$。因此，$\\alpha = c/2$。\n2.  **过阻尼 ($c > 2\\omega$)：** 两个特征值都是实数且为负。最大的实部是 $\\frac{-c + \\sqrt{c^2 - 4\\omega^2}}{2}$。因此，$\\alpha = \\frac{c - \\sqrt{c^2-4\\omega^2}}{2}$。\n\n对于一个衰减率为 $\\alpha$ 的指数稳定线性系统，可以（使用适当的 ISS-Lyapunov 函数和微分幽灵方法）形式上证明状态范数 $Z$ 满足微分不等式：\n$$\n\\dot{Z} \\le -\\alpha Z + \\beta |w|\n$$\n对于我们特定的 $Z = \\sqrt{\\omega^2y^2+v^2}$ 和动力学选择，一个详细的证明（此处省略，但在高等控制和形式化方法中是标准的）得出我们可以选择 $\\beta = 1$。这导致了以下不等式：\n$$\n\\dot{Z} \\le -\\alpha Z + |w|\n$$\n由于 $|w(t)| \\le w_{\\max}$，我们有 $\\dot{Z} \\le -\\alpha Z + w_{\\max}$。\n\n### 步骤 4：状态的闭式界\n根据比较引理 (Grönwall 不等式的一个推论)，微分不等式 $\\dot{Z} \\le -\\alpha Z + w_{\\max}$ 的解被相应等式 $\\dot{X} = -\\alpha X + w_{\\max}$（其中 $X(0) = Z(0)$）的解所界定。\n解为：\n$$\nX(t) = Z(0)e^{-\\alpha t} + \\frac{w_{\\max}}{\\alpha}(1 - e^{-\\alpha t})\n$$\n因此，$Z(t)$ 在 $t \\ge 0$ 上的上确界被 $X(t)$ 的上确界所界定：\n$$\n\\sup_{t \\ge 0} Z(t) \\le \\sup_{t \\ge 0} X(t) = \\max\\left(Z(0), \\frac{w_{\\max}}{\\alpha}\\right)\n$$\n我们用 $Z_{\\max}$ 表示这个界。初始条件为 $Z(0) = \\sqrt{\\omega^2 y_0^2 + v_0^2}$。\n所以，$Z_{\\max} = \\max\\left(\\sqrt{\\omega^2 y_0^2 + v_0^2}, \\frac{w_{\\max}}{\\alpha}\\right)$。\n\n根据定义 $Z^2 = \\omega^2 y^2 + v^2$，我们可以界定各个状态：\n-   $\\omega^2 y^2 \\le Z^2 \\implies |y| \\le \\frac{Z}{\\omega}$。因此，$\\sup_{t\\ge 0}|y(t)| \\le \\frac{Z_{\\max}}{\\omega}$。\n-   $v^2 \\le Z^2 \\implies |v| \\le Z$。因此，$\\sup_{t\\ge 0}|v(t)| \\le Z_{\\max}$。\n\n### 步骤 5：安全性和可接受性的决策过程\n我们现在可以构建最终的决策过程。\n\n1.  **车道安全：** 安全要求是对所有 $t \\ge 0$ 都有 $|y(t)| \\le L/2$。一个充分条件是，我们推导出的 $|y(t)|$ 的上界满足此条件：\n    $$\n    \\frac{Z_{\\max}}{\\omega} \\le \\frac{L}{2}\n    $$\n\n2.  **执行器可接受性：** 执行器不得饱和，即对所有 $t \\ge 0$ 都有 $|u(t)| = |-kv(t)| = k|v(t)| \\le a_{\\max}$。一个充分条件是：\n    $$\n    k \\cdot \\sup_{t\\ge 0}|v(t)| \\le k \\cdot Z_{\\max} \\le a_{\\max}\n    $$\n\n综合这些，如果两个条件都满足，系统就是可验证安全且可接受的。\n\n### 算法摘要\n给定参数 $(\\omega, \\zeta, k, w_{\\max}, y_0, v_0, L, a_{\\max})$:\n1.  计算 $c = 2\\zeta\\omega + k$。\n2.  计算衰减率 $\\alpha$：\n    - 如果 $c \\le 2\\omega$，则 $\\alpha = c/2$。\n    - 如果 $c > 2\\omega$，则 $\\alpha = (c - \\sqrt{c^2 - 4\\omega^2})/2$。\n3.  计算 $Z_0 = \\sqrt{(\\omega y_0)^2 + v_0^2}$。\n4.  如果 $\\alpha > 0$，计算 $Z_{\\max} = \\max(Z_0, w_{\\max}/\\alpha)$。如果 $\\alpha = 0$，系统不够稳定，无法保证有界，我们可以认为它是不安全的 (或者如果 $w_{max}>0$，$Z_{max}$ 是无穷大)。\n5.  检查安全条件：$Z_{\\max} / \\omega \\le L/2$。\n6.  检查可接受性条件：$k \\cdot Z_{\\max} \\le a_{\\max}$。\n7.  如果两个条件都成立，返回 `true`，否则返回 `false`。如果 $c=0$ 且 $w_{max}>0$，系统是不安全的。如果 $c=0$ 且 $w_{max}=0$，系统是临界稳定的，并且 $Z_{max}=Z_0$，因此可以继续进行检查。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the derived decision procedure for CPS safety and admissibility.\n    \"\"\"\n    test_cases = [\n        # (omega, zeta, k, w_max, y0, v0, L, a_max)\n        (1.5, 0.7, 1.0, 0.2, 0.2, 0.0, 3.6, 3.0),\n        (1.2, 0.2, 0.3, 0.5, 1.6, 0.1, 3.6, 2.0),\n        (2.0, 0.5, 3.0, 1.0, 0.9, 0.0, 3.2, 1.0),\n        (0.8, 1.0, 0.0, 0.05, 0.0, 0.0, 3.0, 0.5),\n        (0.6, 0.05, 0.0, 0.8, 1.0, 0.5, 3.0, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        omega, zeta, k, w_max, y0, v0, L, a_max = case\n\n        # Step 1: Calculate total effective damping c\n        c = 2 * zeta * omega + k\n\n        # Step 2: Calculate the decay rate alpha\n        # If c is zero and disturbance exists, the state is unbounded.\n        if c  1e-9:\n            if w_max > 1e-9:\n                results.append('false')\n                continue\n            # If c=0 and w_max=0, system is marginally stable, alpha is 0\n            alpha = 0\n        elif c = 2 * omega: # Underdamped or critically damped\n            alpha = c / 2.0\n        else: # Overdamped\n            alpha = (c - np.sqrt(c**2 - 4 * omega**2)) / 2.0\n        \n        # Step 3: Calculate initial value Z0\n        Z0 = np.sqrt((omega * y0)**2 + v0**2)\n\n        # Step 4: Calculate the maximum value of Z\n        if alpha  1e-9:\n             # If alpha is 0 (from c=0, w_max=0 case), Z is constant at Z0\n             Z_max = Z0\n        else:\n            Z_inf = w_max / alpha\n            Z_max = np.maximum(Z0, Z_inf)\n\n        # Step 5: Check lane safety condition\n        # |y(t)| = Z_max / omega\n        safety_ok = (Z_max / omega) = (L / 2.0)\n\n        # Step 6: Check actuator admissibility condition\n        # |u(t)| = k * |v(t)| = k * Z_max\n        admissibility_ok = (k * Z_max) = a_max\n        \n        # Step 7: Combine results\n        if safety_ok and admissibility_ok:\n            results.append('true')\n        else:\n            results.append('false')\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}