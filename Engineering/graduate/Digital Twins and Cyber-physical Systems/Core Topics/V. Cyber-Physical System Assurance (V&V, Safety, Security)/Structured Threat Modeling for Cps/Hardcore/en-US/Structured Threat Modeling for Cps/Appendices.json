{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of structured threat modeling is the ability to quantify risk, and attack trees provide a powerful, intuitive method for this analysis. This practice challenges you to translate a logical attack tree for a hypothetical industrial system into a quantitative risk assessment, calculating the residual likelihood of an unauthorized action after accounting for defender controls . Mastering this technique is fundamental for prioritizing security investments and making data-driven decisions about which vulnerabilities pose the greatest threat.",
            "id": "4248547",
            "problem": "A remote-operated isolation valve is part of a Chemical Process System (CPS) that is mirrored by a Digital Twin, which reproduces the physical state and control logic of the valve for monitoring and predictive maintenance. The Industrial Control System (ICS) network includes a Programmable Logic Controller (PLC) and a Human-Machine Interface (HMI). Consider the top event \"unauthorized valve opening within a horizon of $T = 24$ hours.\" Model this top event with an attack tree whose internal nodes are logical AND and OR gates, and whose leaves represent atomic attack steps. Use the following scientifically plausible structure and parameters, and treat the attacker actions and defender controls as probabilistically independent unless conditionality is explicitly stated.\n\nTop event branches (all three branches are logically OR at the top event):\n- Branch $\\mathcal{B}_{1}$ (remote command injection) is a logical OR of two subpaths:\n  - Subpath $\\mathcal{B}_{1a}$ is a logical AND of leaf $L_{1}$ (compromise of operator credentials via phishing) and leaf $L_{2}$ (remote command acceptance due to missing authorization checks).\n  - Subpath $\\mathcal{B}_{1b}$ is a logical AND of leaf $L_{3}$ (firewall rule misconfiguration allowing command path) and leaf $L_{4}$ (PLC zero-day exploit enabling unauthorized command).\n- Branch $\\mathcal{B}_{2}$ (field tampering) is a logical AND of leaf $L_{5}$ (physical intrusion to controller enclosure) and leaf $L_{6}$ (manual override switch engaged and not noticed). The occurrence of $L_{6}$ is conditional on $L_{5}$ having occurred.\n- Branch $\\mathcal{B}_{3}$ (Digital Twin desynchronization) is a logical AND of leaf $L_{7}$ (twin data integrity compromise causing false \"closed\" state) and leaf $L_{8}$ (actuator command injection while twin misreports).\n\nFor each leaf $L_{i}$, you are given a baseline daily occurrence probability $p_{i}$ (the probability that the attacker’s action would succeed absent defender controls) and a defender control block probability $b_{i}$ (the probability that the defender control prevents the leaf). The parameters are:\n- $p_{1} = 3.0 \\times 10^{-3}$ with $b_{1} = 0.95$,\n- $p_{2} = 1.0 \\times 10^{-3}$ with $b_{2} = 0.80$,\n- $p_{3} = 5.0 \\times 10^{-3}$ with $b_{3} = 0.90$,\n- $p_{4} = 2.0 \\times 10^{-4}$ with $b_{4} = 0.50$,\n- $p_{5} = 4.0 \\times 10^{-3}$ with $b_{5} = 0.90$,\n- $p_{6} = 5.0 \\times 10^{-3}$ with $b_{6} = 0.60$,\n- $p_{7} = 1.5 \\times 10^{-3}$ with $b_{7} = 0.85$,\n- $p_{8} = 8.0 \\times 10^{-4}$ with $b_{8} = 0.75$.\n\nUsing the axioms of probability and the standard semantics of attack trees (logical AND corresponds to joint occurrence; logical OR corresponds to the occurrence of at least one subpath), and assuming independence across leaves except where conditionality is explicitly stated (as for $L_{6}$ given $L_{5}$), perform the following:\n1. Compute the residual likelihood of each leaf $L_{i}$ within $T$ when subject to its corresponding defender control.\n2. Aggregate along logical AND and OR as prescribed by the attack tree to obtain the overall scenario likelihood of the top event within $T$.\n\nExpress the final scenario likelihood as a decimal in scientific notation, rounded to four significant figures. No units are required and the answer must not be an inequality or an equation.",
            "solution": "The problem requires the calculation of the probability of a top event in an attack tree, given the logical structure of the tree and the probabilities of the atomic attack steps (leaves). The problem is well-posed and scientifically grounded in the principles of quantitative risk assessment and probabilistic modeling.\n\nFirst, we formalize the problem. Let $E_i$ be the event that the atomic attack corresponding to leaf $L_i$ is successful. The problem provides a baseline daily occurrence probability $p_i$ and a defender control block probability $b_i$ for each leaf. The success of an attack step $E_i$ requires that the baseline attack occurs and the corresponding defender control fails. Assuming the attack action and the defender control are independent events, the probability of the control failing is $(1 - b_i)$. Therefore, the residual likelihood of success for each leaf event $E_i$, which we denote as $\\mathcal{L}_i$, is given by:\n$$ \\mathcal{L}_i = P(E_i) = p_i (1 - b_i) $$\nThe time horizon is given as $T = 24$ hours, and the probabilities $p_i$ are given as \"daily occurrence\" probabilities, so they directly apply to this time horizon.\n\nWe compute the residual likelihood $\\mathcal{L}_i$ for each leaf $i=1, \\dots, 8$:\n- $\\mathcal{L}_1 = p_1(1-b_1) = (3.0 \\times 10^{-3})(1 - 0.95) = (3.0 \\times 10^{-3})(0.05) = 1.5 \\times 10^{-4}$\n- $\\mathcal{L}_2 = p_2(1-b_2) = (1.0 \\times 10^{-3})(1 - 0.80) = (1.0 \\times 10^{-3})(0.20) = 2.0 \\times 10^{-4}$\n- $\\mathcal{L}_3 = p_3(1-b_3) = (5.0 \\times 10^{-3})(1 - 0.90) = (5.0 \\times 10^{-3})(0.10) = 5.0 \\times 10^{-4}$\n- $\\mathcal{L}_4 = p_4(1-b_4) = (2.0 \\times 10^{-4})(1 - 0.50) = (2.0 \\times 10^{-4})(0.50) = 1.0 \\times 10^{-4}$\n- $\\mathcal{L}_5 = p_5(1-b_5) = (4.0 \\times 10^{-3})(1 - 0.90) = (4.0 \\times 10^{-3})(0.10) = 4.0 \\times 10^{-4}$\n- $\\mathcal{L}_6 = p_6(1-b_6) = (5.0 \\times 10^{-3})(1 - 0.60) = (5.0 \\times 10^{-3})(0.40) = 2.0 \\times 10^{-3}$\n- $\\mathcal{L}_7 = p_7(1-b_7) = (1.5 \\times 10^{-3})(1 - 0.85) = (1.5 \\times 10^{-3})(0.15) = 2.25 \\times 10^{-4}$\n- $\\mathcal{L}_8 = p_8(1-b_8) = (8.0 \\times 10^{-4})(1 - 0.75) = (8.0 \\times 10^{-4})(0.25) = 2.0 \\times 10^{-4}$\n\nNext, we aggregate these probabilities following the attack tree's structure.\nThe top event $TE$ is the union (logical OR) of three main branches: $TE = \\mathcal{B}_1 \\cup \\mathcal{B}_2 \\cup \\mathcal{B}_3$.\nThe branches are composed of events involving disjoint sets of leaves, so we can treat $\\mathcal{B}_1$, $\\mathcal{B}_2$, and $\\mathcal{B}_3$ as mutually independent events. The probability of their union is:\n$$ P(TE) = 1 - (1 - P(\\mathcal{B}_1))(1 - P(\\mathcal{B}_2))(1 - P(\\mathcal{B}_3)) $$\n\nWe compute the probability of each branch.\n**Branch $\\mathcal{B}_1$ (remote command injection):**\nThis branch is the union of two subpaths: $\\mathcal{B}_1 = \\mathcal{B}_{1a} \\cup \\mathcal{B}_{1b}$.\nSubpath $\\mathcal{B}_{1a}$ is the intersection (logical AND) of $E_1$ and $E_2$. Since $E_1$ and $E_2$ are independent:\n$$ P(\\mathcal{B}_{1a}) = P(E_1 \\cap E_2) = P(E_1)P(E_2) = \\mathcal{L}_1 \\mathcal{L}_2 = (1.5 \\times 10^{-4})(2.0 \\times 10^{-4}) = 3.0 \\times 10^{-8} $$\nSubpath $\\mathcal{B}_{1b}$ is the intersection of $E_3$ and $E_4$. Since $E_3$ and $E_4$ are independent:\n$$ P(\\mathcal{B}_{1b}) = P(E_3 \\cap E_4) = P(E_3)P(E_4) = \\mathcal{L}_3 \\mathcal{L}_4 = (5.0 \\times 10^{-4})(1.0 \\times 10^{-4}) = 5.0 \\times 10^{-8} $$\nThe subpaths $\\mathcal{B}_{1a}$ and $\\mathcal{B}_{1b}$ involve disjoint sets of leaves and are thus independent. The probability of their union is:\n$$ P(\\mathcal{B}_1) = P(\\mathcal{B}_{1a} \\cup \\mathcal{B}_{1b}) = P(\\mathcal{B}_{1a}) + P(\\mathcal{B}_{1b}) - P(\\mathcal{B}_{1a})P(\\mathcal{B}_{1b}) $$\n$$ P(\\mathcal{B}_1) = (3.0 \\times 10^{-8}) + (5.0 \\times 10^{-8}) - (3.0 \\times 10^{-8})(5.0 \\times 10^{-8}) $$\n$$ P(\\mathcal{B}_1) = 8.0 \\times 10^{-8} - 1.5 \\times 10^{-15} = 7.99999985 \\times 10^{-8} $$\n\n**Branch $\\mathcal{B}_2$ (field tampering):**\nThis branch is the intersection of $E_5$ and $E_6$. The problem states that the occurrence of $L_6$ is conditional on $L_5$. This confirms the AND logic, where the success of the branch requires both events to occur. The probability is $P(\\mathcal{B}_2) = P(E_5 \\cap E_6) = P(E_6|E_5)P(E_5)$. Given no other information, the provided probability $p_6$ is interpreted as relating to the conditional event. Thus, the residual likelihood $\\mathcal{L}_6$ represents $P(E_6|E_5 \\text{ attempt})$. Assuming the attempt on $E_6$ is only made if $E_5$ is successful, this leads to $P(\\mathcal{B}_2) = \\mathcal{L}_5 \\mathcal{L}_6$.\n$$ P(\\mathcal{B}_2) = \\mathcal{L}_5 \\mathcal{L}_6 = (4.0 \\times 10^{-4})(2.0 \\times 10^{-3}) = 8.0 \\times 10^{-7} $$\n\n**Branch $\\mathcal{B}_3$ (Digital Twin desynchronization):**\nThis branch is the intersection of $E_7$ and $E_8$. These events are independent.\n$$ P(\\mathcal{B}_3) = P(E_7 \\cap E_8) = \\mathcal{L}_7 \\mathcal{L}_8 = (2.25 \\times 10^{-4})(2.0 \\times 10^{-4}) = 4.5 \\times 10^{-8} $$\n\n**Top Event Likelihood:**\nNow we combine the probabilities of the three main branches.\n$P(\\mathcal{B}_1) = 7.99999985 \\times 10^{-8}$\n$P(\\mathcal{B}_2) = 8.0 \\times 10^{-7}$\n$P(\\mathcal{B}_3) = 4.5 \\times 10^{-8}$\nSince the probabilities are very small, the probability of the union is well-approximated by their sum:\n$P(TE) \\approx P(\\mathcalB_1) + P(\\mathcalB_2) + P(\\mathcalB_3) \\approx (8.0 \\times 10^{-8}) + (8.0 \\times 10^{-7}) + (4.5 \\times 10^{-8}) = 9.25 \\times 10^{-7}$.\nFor a more precise calculation, we use the formula for the union of independent events:\n$$ P(TE) = 1 - (1 - P(\\mathcal{B}_1))(1 - P(\\mathcal{B}_2))(1 - P(\\mathcal{B}_3)) $$\n$$ P(TE) = 1 - (1 - 7.99999985 \\times 10^{-8})(1 - 8.0 \\times 10^{-7})(1 - 4.5 \\times 10^{-8}) $$\n$$ P(TE) = 1 - (0.9999999200000015)(0.9999992)(0.999999955) $$\n$$ P(TE) = 1 - 0.999999075000105... $$\n$$ P(TE) = 9.249998949... \\times 10^{-7} $$\nThe problem requires the final answer to be rounded to four significant figures. The fourth significant figure in $9.2499...$ is $9$. The following digit is $9$, so we round up.\n$$ P(TE) \\approx 9.250 \\times 10^{-7} $$",
            "answer": "$$\\boxed{9.250 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Cyber-physical threats are often subtle, exploiting the tight coupling between computational processes and physical dynamics, a concept this exercise is designed to clarify. This practice provides a deep dive into such a threat, exploring how a small clock drift in a sensor can compromise the integrity of a Digital Twin's state estimation . By deriving the maximum allowable drift before a safety hazard is triggered, you will gain hands-on experience in modeling how a cyber perturbation propagates through a system's Kalman filter dynamics to its ultimate physical impact.",
            "id": "4248517",
            "problem": "A Digital Twin (DT) supervising a one-dimensional automated guided vehicle in a Cyber-Physical System (CPS) uses sensor fusion between a position sensor and a velocity sensor derived from an Inertial Measurement Unit (IMU). Time synchronization drift is modeled as $t' = t + \\delta t$, where $t'$ denotes the timestamp applied to the velocity measurement and $\\delta t$ is the clock drift. In the structured threat modeling assessment, clock drift is treated as an adversarial perturbation that can bias the fused state estimate and potentially push the system beyond a defined safety margin. The fusion is performed by a discrete-time linear Kalman filter based on a constant-velocity model. The state is $[x, v]^{\\top}$ with $x$ the position and $v$ the velocity. The filter performs a measurement update at time $t$ using position and velocity measurements, followed by a one-step prediction to $t + T_s$ using the kinematic relation $x_{k+1} = x_{k} + v_{k} T_s$, where $T_s$ is the sampling period. The velocity measurement at the kalman update time $t$ is mis-timed because of clock drift and is thus the physical velocity at $t' = t + \\delta t$. For small drift, use the first-order approximation $v(t') \\approx v(t) + a(t) \\delta t$, where $a(t)$ is the instantaneous acceleration.\n\nAssume the following are known and scientifically plausible:\n- The sampling period is $T_s = 0.1$ seconds.\n- The prior velocity estimate variance at the measurement update is $\\sigma_{v,p}^{2} = 0.19$ (in $\\text{m}^{2}/\\text{s}^{2}$), and the velocity measurement noise variance is $\\sigma_{v}^{2} = 0.01$ (in $\\text{m}^{2}/\\text{s}^{2}$).\n- The measurement matrix is the identity, so both position and velocity are directly measured by the sensors at the update time (with the velocity being mis-timed by $\\delta t$).\n- The hazard threshold for the absolute one-step-ahead position estimation bias is $H_x = 0.01$ meters: if the fused position estimate bias at time $t + T_s$ exceeds $H_x$, the safety analysis classifies the system as crossing the hazard threshold.\n- The acceleration magnitude satisfies $|a(t)| \\leq a_{\\max}$ for all $t$, with $a_{\\max} = 5$ $\\text{m}/\\text{s}^{2}$.\n\nDerive, from fundamental definitions of discrete-time kinematics, the Kalman filter update with biased measurements, and the first-order approximation of time-shifted signals, an analytic expression for the maximum allowable clock drift $\\delta t_{\\max}$ that guarantees the fused position estimate at $t + T_s$ remains within the hazard threshold for all accelerations with $|a(t)| \\leq a_{\\max}$. Then compute the numerical value of $\\delta t_{\\max}$ using the given parameters.\n\nRound your final numerical answer to four significant figures. Express the final drift in seconds.",
            "solution": "The problem statement is analyzed and found to be valid. It is scientifically grounded in control theory and Kalman filtering, is well-posed, and is expressed in objective, formal language. It provides sufficient, consistent information to derive a unique solution, contingent on a reasonable simplifying assumption that is justified by the context of threat modeling and the selective provision of parameters.\n\nThe objective is to determine the maximum allowable clock drift, $\\delta t_{\\max}$, such that the one-step-ahead position estimation bias, $b_{x, k+1|k}$, does not exceed the hazard threshold, $H_x$.\n\nThe state of the system at a discrete time step $k$ is the vector $s_k = [x_k, v_k]^{\\top}$. The measurement at time $t_k$ is $z_k = [z_{x,k}, z_{v,k}]^{\\top}$. The position measurement $z_{x,k}$ is assumed to be unbiased. The velocity measurement $z_{v,k}$ is taken at a mis-timed instant $t_k' = t_k + \\delta t$. Using the provided first-order approximation, the physical velocity at this time is $v(t_k') \\approx v(t_k) + a(t_k) \\delta t$, where $a(t_k)$ is the instantaneous acceleration.\n\nThe velocity measurement $z_{v,k}$ is thus modeled as:\n$$z_{v,k} = v(t_k') + n_{v,k} \\approx v_k + a(t_k) \\delta t + n_{v,k}$$\nwhere $v_k = v(t_k)$ is the true velocity at time $t_k$ and $n_{v,k}$ is zero-mean measurement noise with variance $\\sigma_v^2$. This measurement has a bias term $b_{v,\\text{meas}} = a(t_k) \\delta t$.\n\nThe Kalman filter performs a measurement update. We are concerned with the bias introduced into the state estimates. The analysis focuses on the effect of the new measurement bias at step $k$, assuming the filter state was unbiased prior to this step, i.e., the prior bias $b_{k|k-1} = 0$.\n\nThe Kalman gain for the velocity update is a scalar value, as only velocity-related variances are provided. This gain, which we denote $K_v$, determines how much the measurement residual updates the state. It is given by:\n$$K_v = \\frac{\\sigma_{v,p}^2}{\\sigma_{v,p}^2 + \\sigma_v^2}$$\nwhere $\\sigma_{v,p}^2$ is the prior velocity estimate variance and $\\sigma_v^2$ is the velocity measurement noise variance.\nSubstituting the given values: $\\sigma_{v,p}^2 = 0.19$ and $\\sigma_v^2 = 0.01$.\n$$K_v = \\frac{0.19}{0.19 + 0.01} = \\frac{0.19}{0.20} = 0.95$$\n\nThe updated (posterior) velocity estimate is $\\hat{v}_{k|k} = \\hat{v}_{k|k-1} + K_v(z_{v,k} - \\hat{v}_{k|k-1})$. The bias in this estimate, $b_{v,k|k} = E[v_k - \\hat{v}_{k|k}]$, is found by taking the expectation, assuming the prior estimate is unbiased ($E[v_k - \\hat{v}_{k|k-1}] = 0$) and the noise is zero-mean ($E[n_{v,k}]=0$):\n$$b_{v,k|k} = E[v_k - (\\hat{v}_{k|k-1} + K_v(v_k + b_{v,\\text{meas}} + n_{v,k} - \\hat{v}_{k|k-1}))]$$\n$$b_{v,k|k} = E[(I-K_v)(v_k - \\hat{v}_{k|k-1}) - K_v b_{v,\\text{meas}} - K_v n_{v,k}]$$\n$$b_{v,k|k} = -K_v b_{v,\\text{meas}} = -K_v a(t_k) \\delta t$$\n\nNext, we propagate this bias to the one-step-ahead position prediction. The filter's prediction model is given by:\n$$\\hat{x}_{k+1|k} = \\hat{x}_{k|k} + \\hat{v}_{k|k} T_s$$\nThe bias in this predicted position, $b_{x,k+1|k} = E[x_{k+1} - \\hat{x}_{k+1|k}]$, is given by the propagation of the posterior biases from step $k$:\n$$b_{x,k+1|k} = b_{x,k|k} + b_{v,k|k} T_s$$\nwhere $b_{x,k|k} = E[x_k - \\hat{x}_{k|k}]$ is the bias in the updated position estimate. A full Kalman filter analysis would show that $b_{x,k|k} = -K_{xv} b_{v,\\text{meas}}$, where $K_{xv}$ is an off-diagonal term in the Kalman gain matrix. However, the problem does not provide the parameters (e.g., position measurement variance $\\sigma_x^2$, or prior position covariance elements $P_{xx,p}, P_{xv,p}$) needed to compute $K_{xv}$. This implies a targeted analysis is intended, focusing solely on the direct propagation path from velocity error to position prediction error. We therefore make the standard simplifying assumption for this type of threat analysis: the position measurement is accurate enough that its update dominates the fused position estimate, making the bias contribution from the velocity measurement negligible, i.e., $b_{x,k|k} \\approx 0$.\n\nWith this assumption, the predicted position bias simplifies to:\n$$b_{x,k+1|k} \\approx b_{v,k|k} T_s$$\nSubstituting the expression for the velocity bias:\n$$b_{x,k+1|k} \\approx -K_v a(t_k) \\delta t T_s$$\n\nThe safety requirement is that the absolute value of this bias must not exceed the hazard threshold $H_x = 0.01$ m for any allowed acceleration, $|a(t)| \\leq a_{\\max}$.\n$$|b_{x,k+1|k}| \\leq H_x$$\n$$|-K_v a(t_k) \\delta t T_s| \\leq H_x$$\n$$K_v |a(t_k)| |\\delta t| T_s \\leq H_x$$\n\nTo guarantee this for all valid accelerations, we must consider the worst-case scenario, where the acceleration magnitude is at its maximum, $|a(t_k)| = a_{\\max} = 5 \\, \\text{m}/\\text{s}^2$. The maximum allowable clock drift $\\delta t_{\\max}$ is the value of $|\\delta t|$ that brings this expression to equality.\n$$K_v a_{\\max} \\delta t_{\\max} T_s = H_x$$\n\nSolving for $\\delta t_{\\max}$ yields the analytical expression:\n$$\\delta t_{\\max} = \\frac{H_x}{K_v a_{\\max} T_s}$$\n\nNow, we substitute the numerical values:\n$H_x = 0.01$\n$K_v = 0.95$\n$a_{\\max} = 5$\n$T_s = 0.1$\n\n$$\\delta t_{\\max} = \\frac{0.01}{(0.95)(5)(0.1)} = \\frac{0.01}{0.475}$$\n$$\\delta t_{\\max} \\approx 0.02105263 \\, \\text{s}$$\n\nRounding the result to four significant figures as requested gives:\n$$\\delta t_{\\max} \\approx 0.02105 \\, \\text{s}$$",
            "answer": "$$ \\boxed{0.02105} $$"
        },
        {
            "introduction": "Effective security is not just about reacting to threats, but also about proactively designing resilient system architectures. This exercise formalizes the challenge of trust zoning—a key security-by-design principle—as a constrained optimization problem, where the goal is to balance security objectives with operational needs . By working through this hypothetical scenario, you will learn to navigate the trade-offs between minimizing the exposed attack surface and maintaining essential control performance, a central challenge in real-world CPS security engineering.",
            "id": "4248537",
            "problem": "You are given a formalization of trust zoning for Cyber-Physical Systems (CPS) using graph partitioning under control-performance constraints. Consider a CPS modeled as a weighted, undirected graph $G = (V, E)$, where $V$ is the set of components (nodes) and $E$ is the set of bidirectional communication links (edges). Each edge $(u, v) \\in E$ carries a nonnegative weight $w_{uv}$ representing average traffic volume per unit time, treated as a proxy for exposure risk. A trust zoning is an assignment $z: V \\to \\{0, 1\\}$ to two zones that must be non-empty, i.e., there exist nodes $u$ and $v$ with $z(u) = 0$ and $z(v) = 1$. The objective is to minimize the inter-zone traffic while preserving control performance.\n\nDefine the inter-zone traffic (cut weight) of an assignment $z$ as\n$$\nW(z) = \\sum_{(u, v) \\in E} w_{uv} \\cdot \\mathbf{1}\\big[z(u) \\neq z(v)\\big],\n$$\nwhere $\\mathbf{1}[\\cdot]$ is the indicator function. Control performance is modeled by a set of closed-loop control paths. Each path $p$ is a simple cycle represented by an ordered list of distinct nodes $[v_0, v_1, \\dots, v_{m-1}]$, which implies a cycle with edges $(v_i, v_{i+1})$ for $i = 0, \\dots, m-2$ and $(v_{m-1}, v_0)$. Crossing a trust zone boundary introduces an additional latency penalty of $d_z$ seconds per boundary crossing due to security mediation. Each control path $p$ has a maximum allowable additional latency $L_p^{\\max}$ seconds. For a zoning assignment $z$, the number of zone boundary crossings on path $p$ is\n$$\nC_p(z) = \\sum_{i=0}^{m-1} \\mathbf{1}\\big[z(v_i) \\neq z(v_{(i+1) \\bmod m})\\big].\n$$\nThe control-performance constraint for each path $p$ is\n$$\nC_p(z) \\le \\left\\lfloor \\frac{L_p^{\\max}}{d_z} \\right\\rfloor,\n$$\nwhere $\\lfloor \\cdot \\rfloor$ denotes the floor function.\n\nDefine the baseline exposed surface $S_{\\text{base}}$ as the sum of weights over all edges,\n$$\nS_{\\text{base}} = \\sum_{(u, v) \\in E} w_{uv}.\n$$\nUnder a zoning assignment $z$, the exposed surface after zoning is the cut weight $S_{\\text{cut}} = W(z)$. The reduction in exposed surface is quantified as the fractional reduction\n$$\n\\rho = \\frac{S_{\\text{base}} - S_{\\text{cut}}}{S_{\\text{base}}},\n$$\nexpressed as a decimal rounded to four decimal places. If no nontrivial zoning assignment (both zones non-empty) satisfies the constraints, report $-1$ for the minimized inter-zone traffic and $-1.0$ for the reduction fraction.\n\nYour task is to implement a program that, for each test case below, enumerates all nontrivial two-zone assignments $z: V \\to \\{0, 1\\}$, checks control-performance constraints for each control path, and finds the assignment that minimizes $W(z)$ subject to the constraints. Use exhaustive enumeration by fixing one node in zone $0$ to avoid duplicate labels (this reduces symmetry). Report the minimized inter-zone traffic $W(z^\\star)$ and the reduction fraction $\\rho$ for the optimal valid assignment $z^\\star$. If there is no valid assignment with both zones non-empty, output $-1$ and $-1.0$ for that test case.\n\nAll latencies must be treated in seconds. All reduction fractions must be decimals rounded to four decimal places.\n\nTest suite:\n- Test case $1$:\n  - Nodes: $V = \\{0, 1, 2, 3, 4\\}$.\n  - Edges with weights: $(0,1)$ with $w_{01} = 5$, $(1,2)$ with $w_{12} = 4$, $(2,3)$ with $w_{23} = 3$, $(3,0)$ with $w_{30} = 2$, $(1,3)$ with $w_{13} = 1$, $(2,4)$ with $w_{24} = 2$, $(0,4)$ with $w_{04} = 1$.\n  - Single control path: $p_1 = [0, 1, 2, 3]$.\n  - Per-crossing latency penalty: $d_z = 0.02$ seconds.\n  - Maximum allowable additional latency: $L_{p_1}^{\\max} = 0.06$ seconds.\n- Test case $2$ (boundary condition where only one crossing is allowed):\n  - Nodes: $V = \\{0, 1, 2, 3\\}$.\n  - Edges with weights: $(0,1)$ with $w_{01} = 6$, $(1,2)$ with $w_{12} = 2$, $(2,3)$ with $w_{23} = 2$, $(3,0)$ with $w_{30} = 2$, $(0,2)$ with $w_{02} = 1$.\n  - Single control path: $p_1 = [0, 1, 2, 3]$.\n  - Per-crossing latency penalty: $d_z = 0.05$ seconds.\n  - Maximum allowable additional latency: $L_{p_1}^{\\max} = 0.05$ seconds.\n- Test case $3$ (multiple control loops with different budgets):\n  - Nodes: $V = \\{0, 1, 2, 3, 4\\}$.\n  - Edges with weights: $(0,1)$ with $w_{01} = 3$, $(1,2)$ with $w_{12} = 3$, $(2,0)$ with $w_{20} = 3$, $(2,3)$ with $w_{23} = 4$, $(3,4)$ with $w_{34} = 1$, $(4,2)$ with $w_{42} = 2$, $(1,3)$ with $w_{13} = 2$.\n  - Two control paths: $p_1 = [0, 1, 2]$, $p_2 = [2, 3, 4]$.\n  - Per-crossing latency penalty: $d_z = 0.01$ seconds.\n  - Maximum allowable additional latencies: $L_{p_1}^{\\max} = 0.02$ seconds, $L_{p_2}^{\\max} = 0.01$ seconds.\n- Test case $4$ (edge case where constraints may make nontrivial zoning infeasible):\n  - Nodes: $V = \\{0, 1, 2, 3\\}$.\n  - Edges with weights: $(0,1)$ with $w_{01} = 7$, $(1,2)$ with $w_{12} = 7$, $(2,3)$ with $w_{23} = 7$, $(3,0)$ with $w_{30} = 7$, $(0,2)$ with $w_{02} = 1$, $(1,3)$ with $w_{13} = 1$.\n  - Single control path: $p_1 = [0, 1, 2, 3]$.\n  - Per-crossing latency penalty: $d_z = 0.03$ seconds.\n  - Maximum allowable additional latency: $L_{p_1}^{\\max} = 0.00$ seconds.\n\nYour program should produce a single line of output containing the results for all test cases, formatted as a comma-separated list enclosed in square brackets. Each test case’s result must itself be a two-element list $[W(z^\\star), \\rho]$ with the reduction fraction rounded to four decimal places. For example, the overall output should look like $[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]]$, where each $a_i$ is an integer and each $b_i$ is a decimal rounded to four places.",
            "solution": "The problem asks us to find an optimal trust-zoning for a Cyber-Physical System (CPS) modeled as a weighted undirected graph $G = (V, E)$. The optimization goal is to partition the set of nodes $V$ into two non-empty zones, $\\{0, 1\\}$, such that the total weight of edges connecting nodes in different zones (the cut weight, $W(z)$) is minimized. This minimization is subject to a set of control-performance constraints, which limit the number of times any specified control path can cross the zone boundary.\n\nThe task is a constrained graph partitioning problem, a variant of the minimum cut problem. Given the small number of nodes in each test case (e.g., $|V| \\le 5$), an exact solution can be found by systematically enumerating and evaluating all possible partitions.\n\nThe overall approach is as follows:\n1.  **Enumerate Partitions**: We must consider all non-trivial bipartitions of the node set $V$. A bipartition is an assignment $z: V \\to \\{0, 1\\}$ where both zone sets, $V_0 = \\{v \\in V | z(v) = 0\\}$ and $V_1 = \\{v \\in V | z(v) = 1\\}$, are non-empty. The total number of assignments is $2^{|V|}$. Of these, two are trivial (all nodes in one zone). The remaining $2^{|V|} - 2$ assignments form $(2^{|V|} - 2) / 2 = 2^{|V|-1} - 1$ unique non-trivial partitions, since swapping the zone labels $0$ and $1$ results in the same partition. To systematically enumerate these unique partitions without duplication, we can fix the zone of one node. Let's fix node $0$ to be in Zone $0$, i.e., $z(0)=0$. We then iterate through all possible assignments for the remaining $|V|-1$ nodes. This yields $2^{|V|-1}$ assignments. The case where all other nodes are also assigned to Zone $0$ corresponds to a trivial partition and is excluded. This leaves $2^{|V|-1} - 1$ non-trivial partitions to check, covering the entire search space.\n\n2.  **Validate Constraints**: For each of the $2^{|V|-1} - 1$ candidate partitions, we must verify that it satisfies all control-performance constraints. For each control path $p$, the problem defines a maximum allowable number of boundary crossings, $C_p^{\\max}$, derived from the latency budget:\n    $$C_p^{\\max} = \\left\\lfloor \\frac{L_p^{\\max}}{d_z} \\right\\rfloor$$\n    For a given partition $z$, we calculate the actual number of crossings for path $p = [v_0, v_1, \\dots, v_{m-1}]$:\n    $$C_p(z) = \\sum_{i=0}^{m-1} \\mathbf{1}\\big[z(v_i) \\neq z(v_{(i+1) \\bmod m})\\big]$$\n    If $C_p(z) > C_p^{\\max}$ for any path $p$, the partition $z$ is invalid and is discarded. It is a known property of simple cycles on a partitioned plane that the number of crossings must be an even integer. This can further prune the search or simplify the constraints; for example, a constraint $C_p(z) \\le 1$ is equivalent to $C_p(z) = 0$.\n\n3.  **Evaluate Objective Function**: If a partition $z$ is valid (satisfies all constraints), we compute its cost, which is the inter-zone traffic or cut weight $W(z)$:\n    $$W(z) = \\sum_{(u, v) \\in E} w_{uv} \\cdot \\mathbf{1}\\big[z(u) \\neq z(v)\\big]$$\n    This is the sum of weights of all edges that connect a node in Zone $0$ to a node in Zone $1$.\n\n4.  **Find the Optimum**: We maintain a variable, $W_{min}$, initialized to infinity, to store the minimum cut weight found so far among valid partitions. Whenever a valid partition $z$ is found, its cut weight $W(z)$ is compared to $W_{min}$, and $W_{min}$ is updated if $W(z)$ is smaller.\n\n5.  **Calculate Final Metrics**: After iterating through all partitions, if no valid partition was found, we report $W(z^\\star) = -1$ and $\\rho = -1.0$ as per the problem specification. Otherwise, the final minimized cut weight is $W(z^\\star) = W_{min}$. The fractional reduction in exposed surface, $\\rho$, is then calculated. First, the baseline exposed surface $S_{\\text{base}}$ is the sum of all edge weights in the graph.\n    $$S_{\\text{base}} = \\sum_{(u, v) \\in E} w_{uv}$$\n    The reduction fraction is then:\n    $$\\rho = \\frac{S_{\\text{base}} - W(z^\\star)}{S_{\\text{base}}}$$\n    This value is rounded to four decimal places. This exhaustive search guarantees finding the global minimum cut weight that satisfies all specified constraints.",
            "answer": "[[6,0.6667],[7,0.4615],[3,0.8333],[-1,-1.0]]"
        }
    ]
}