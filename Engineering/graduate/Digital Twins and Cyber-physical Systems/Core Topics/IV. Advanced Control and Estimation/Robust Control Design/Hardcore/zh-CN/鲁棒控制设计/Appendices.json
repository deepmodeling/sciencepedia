{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立 $\\mathcal{H}_{\\infty}$ 范数的频域定义与其时域表征——即有界实引理（Bounded Real Lemma）所描述的线性矩阵不等式（LMI）之间的基础联系。通过处理一个简单的一阶系统，你将亲手实践从第一性原理进行解析计算和基于李雅普诺夫方法的验证，从而巩固你对鲁棒分析中这一核心概念的理解 。",
            "id": "4241440",
            "problem": "一个信息物理系统中的网络化传感器的数字孪生由一个单输入单输出（SISO）连续时间传递函数 $G(s) = \\dfrac{k}{s+a}$ 建模，其中 $a>0$ 且 $k \\in \\mathbb{R}$。鲁棒性要求在频域中提出：通信信道上的扰动衰减必须由 $G(s)$ 的 $\\mathcal{H}_{\\infty}$ 范数来验证。从 $\\mathcal{H}_{\\infty}$ 范数的定义出发，即 $G(j\\omega)$ 在所有实频率上的最大奇异值的上确界，解析地计算 $\\|G\\|_{\\infty}$，并用 $a$ 和 $k$ 表示。\n\n然后，将 $G(s)$ 建模为零前馈的最小状态空间形式，并使用鲁棒控制中的一个基本事实——连续时间有界实引理（BRL）。除了 BRL 表述本身，不使用任何预先推导的公式，通过构造一个合适的标量李雅普诺夫凭证，验证 BRL 不等式对于等于你所计算的 $\\mathcal{H}_{\\infty}$ 范数的精确 $\\gamma$ 值是满足的。\n\n将最终的 $\\mathcal{H}_{\\infty}$ 范数表示为关于 $a$ 和 $k$ 的单个闭式解析表达式。不需要数值近似。",
            "solution": "首先验证问题以确保其适定性、科学性和自包含性。在确认其有效性后，提供一个由两部分组成的解答。首先，根据定义解析地计算给定传递函数的 $\\mathcal{H}_{\\infty}$ 范数。其次，使用有界实引理验证此结果。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 系统传递函数：$G(s) = \\dfrac{k}{s+a}$\n- 系统类型：单输入单输出（SISO），连续时间。\n- 参数约束：$a > 0$ 且 $k \\in \\mathbb{R}$。\n- $\\mathcal{H}_{\\infty}$ 范数定义：$\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\sigma_{\\max}(G(j\\omega))$。\n- 任务 1：用 $a$ 和 $k$ 解析地计算 $\\|G\\|_{\\infty}$。\n- 任务 2：将 $G(s)$ 建模为零前馈（$D=0$）的最小状态空间形式。\n- 任务 3：通过构造一个合适的标量李雅普诺夫凭证，使用连续时间有界实引理（BRL）验证任务 1 的结果。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性**：该问题设置在鲁棒控制理论的背景下，这是工程学的一个核心学科。它使用了传递函数、状态空间模型、$\\mathcal{H}_{\\infty}$ 范数和有界实引理等标准概念，这些都是基础且成熟的。系统模型 $G(s)$ 代表一个稳定的一阶低通滤波器，这是一个物理上现实且常见的模型。\n- **适定性**：问题定义清晰。约束 $a>0$ 确保系统的极点位于左半复平面，使系统稳定。稳定的系统是拥有有限 $\\mathcal{H}_{\\infty}$ 范数的前提条件。目标是具体的，并导向一个唯一的解析解。\n- **客观性**：问题使用精确的数学语言陈述，不包含任何主观或模糊的术语。\n\n**步骤 3：结论与行动**\n问题是有效的。它具有科学性、适定性和客观性。将提供完整的解答。\n\n### 第一部分：$\\mathcal{H}_{\\infty}$ 范数的解析计算\n\n传递函数矩阵 $G(s)$ 的 $\\mathcal{H}_{\\infty}$ 范数定义为其在所有频率 $\\omega$ 上的最大奇异值的上确界。对于单输入单输出（SISO）系统，传递函数 $G(s)$ 是一个标量。标量的奇异值就是其幅值。因此，定义简化为：\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)|\n$$\n给定的传递函数是 $G(s) = \\dfrac{k}{s+a}$。为了求得频率响应，我们代入 $s=j\\omega$，其中 $j$ 是虚数单位，$\\omega$ 是角频率。\n$$\nG(j\\omega) = \\frac{k}{j\\omega + a} = \\frac{k}{a + j\\omega}\n$$\n这个复数的幅值为：\n$$\n|G(j\\omega)| = \\left| \\frac{k}{a + j\\omega} \\right| = \\frac{|k|}{|a + j\\omega|}\n$$\n分母的幅值为 $|a + j\\omega| = \\sqrt{a^2 + \\omega^2}$。因此，频率响应的幅值为：\n$$\n|G(j\\omega)| = \\frac{|k|}{\\sqrt{a^2 + \\omega^2}}\n$$\n我们需要找到该函数在 $\\omega \\in \\mathbb{R}$ 上的上确界。分子 $|k|$ 是一个非负常数。当分母 $\\sqrt{a^2 + \\omega^2}$ 最小时，函数 $|G(j\\omega)|$ 取得最大值。平方根内的项 $a^2 + \\omega^2$ 在 $\\omega^2$ 最小时最小化。由于 $\\omega \\in \\mathbb{R}$，$\\omega^2$ 的最小值为 $0$，这发生在 $\\omega=0$ 时。\n\n在 $\\omega=0$ 时，分母有其最小值：\n$$\n\\min_{\\omega \\in \\mathbb{R}} \\sqrt{a^2 + \\omega^2} = \\sqrt{a^2 + 0^2} = \\sqrt{a^2} = a\n$$\n我们使用 $a$ 而不是 $|a|$，因为问题中已说明 $a>0$。\n\n因此，$|G(j\\omega)|$ 的最大值为：\n$$\n\\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)| = \\frac{|k|}{a}\n$$\n因此，系统的 $\\mathcal{H}_{\\infty}$ 范数为：\n$$\n\\|G\\|_{\\infty} = \\frac{|k|}{a}\n$$\n\n### 第二部分：使用有界实引理进行验证\n\n首先，我们将 $G(s)$ 表示为零前馈（$\\mathbf{D}=0$）的最小状态空间形式 $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, \\mathbf{D})$。\n$$\n\\dot{\\mathbf{x}} = \\mathbf{A}\\mathbf{x} + \\mathbf{B}u\n$$\n$$\ny = \\mathbf{C}\\mathbf{x} + \\mathbf{D}u\n$$\n对于一阶系统 $G(s) = \\dfrac{k}{s+a}$，我们可以定义一个标量状态 $x(t)$，使其拉普拉斯变换 $X(s)$ 与输入 $U(s)$ 的关系为 $X(s) = \\frac{1}{s+a}U(s)$。这对应于微分方程 $\\dot{x}(t) + ax(t) = u(t)$。输出为 $Y(s) = kX(s)$，或 $y(t)=kx(t)$。这给出了以下状态空间实现：\n$$\n\\mathbf{A} = [-a], \\quad \\mathbf{B} = [1], \\quad \\mathbf{C} = [k], \\quad \\mathbf{D} = [0]\n$$\n这个实现是最小的，因为它既是可控的（可控性矩阵仅为 $\\mathbf{B}=[1]$，具有满秩），又是可观的（可观性矩阵仅为 $\\mathbf{C}=[k]$，假设 $k \\neq 0$ 也具有满秩。如果 $k=0$，则系统是平凡的，范数为 $0$）。\n\n连续时间有界实引理（非严格版本）指出，对于一个具有状态空间实现 $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, \\mathbf{D})$ 的稳定系统，其 $\\mathcal{H}_{\\infty}$ 范数满足 $\\|G\\|_{\\infty} \\le \\gamma$ 当且仅当存在一个对称半正定矩阵 $\\mathbf{P}$（$\\mathbf{P} = \\mathbf{P}^T \\ge 0$）满足以下线性矩阵不等式（LMI）：\n$$\n\\begin{pmatrix}\n\\mathbf{A}^T \\mathbf{P} + \\mathbf{P} \\mathbf{A} & \\mathbf{P} \\mathbf{B} & \\mathbf{C}^T \\\\\n\\mathbf{B}^T \\mathbf{P} & -\\gamma \\mathbf{I} & \\mathbf{D}^T \\\\\n\\mathbf{C} & \\mathbf{D} & -\\gamma \\mathbf{I}\n\\end{pmatrix} \\le 0\n$$\n我们需要验证该条件对于 $\\gamma = \\|G\\|_{\\infty} = \\frac{|k|}{a}$ 成立。由于系统是 SISO，李雅普诺夫凭证 $\\mathbf{P}$ 是一个标量，我们记为 $p$。对于一个非平凡的凭证，我们需要 $p>0$，这对应于 $\\mathbf{P}>0$。\n\n将状态空间矩阵和 $\\mathbf{D}=0$ 代入 LMI，我们得到：\n$$\n\\mathbf{M} = \\begin{pmatrix}\n(-a)p + p(-a) & p(1) & k \\\\\n(1)p & -\\gamma & 0 \\\\\nk & 0 & -\\gamma\n\\end{pmatrix} = \\begin{pmatrix}\n-2ap & p & k \\\\\np & -\\gamma & 0 \\\\\nk & 0 & -\\gamma\n\\end{pmatrix} \\le 0\n$$\n要使该矩阵 $\\mathbf{M}$ 为半负定，其所有 $m$ 阶主子式必须具有符号 $(-1)^m$ 或为零。\n1. 对角元素（1 阶主子式）必须为非正：\n   - $-2ap \\le 0$。由于 $a>0$ 且我们寻求 $p>0$，此条件满足。\n   - $-\\gamma \\le 0$。由于 $\\gamma = \\frac{|k|}{a}$，其中 $|k| \\ge 0$ 且 $a>0$，此条件也满足。\n\n2. 2 阶主子式必须为非负：\n   - $\\det \\begin{pmatrix} -2ap & p \\\\ p & -\\gamma \\end{pmatrix} = (-2ap)(-\\gamma) - p^2 = 2ap\\gamma - p^2 \\ge 0$。\n   - $\\det \\begin{pmatrix} -2ap & k \\\\ k & -\\gamma \\end{pmatrix} = (-2ap)(-\\gamma) - k^2 = 2ap\\gamma - k^2 \\ge 0$。\n   - $\\det \\begin{pmatrix} -\\gamma & 0 \\\\ 0 & -\\gamma \\end{pmatrix} = \\gamma^2 \\ge 0$。此条件恒成立。\n\n3. $\\mathbf{M}$ 的行列式（3 阶主子式）必须为非正：\n   $$\n   \\det(\\mathbf{M}) = -2ap(\\gamma^2) - p(-p\\gamma) + k(k\\gamma) = \\gamma(-2ap\\gamma + p^2 + k^2) \\le 0\n   $$\n由于 $\\gamma \\ge 0$，这要求 $p^2 - 2ap\\gamma + k^2 \\le 0$。\n\n现在，我们代入 $\\gamma = \\frac{|k|}{a}$ 并构造凭证 $p$。从行列式得到的条件变为：\n$$\np^2 - 2a\\left(\\frac{|k|}{a}\\right)p + k^2 \\le 0\n$$\n$$\np^2 - 2|k|p + k^2 \\le 0\n$$\n由于 $k^2 = |k|^2$，我们有：\n$$\np^2 - 2|k|p + |k|^2 \\le 0\n$$\n$$\n(p - |k|)^2 \\le 0\n$$\n一个实数的平方不可能是负数。这个不等式能够成立的唯一方式是该项恰好为零：\n$$\n(p - |k|)^2 = 0 \\implies p = |k|\n$$\n这给了我们标量李雅普诺夫凭证的候选值，$p = |k|$。如果 $k \\neq 0$，则 $p > 0$，符合要求。如果 $k=0$，则 $p=0$，LMI 作为零矩阵是平凡成立的。\n\n让我们检查 $p=|k|$ 是否满足从 2 阶主子式导出的其余条件，其中 $\\gamma = |k|/a$。\n- $2ap\\gamma - p^2 = 2a(|k|)\\left(\\frac{|k|}{a}\\right) - (|k|)^2 = 2|k|^2 - |k|^2 = |k|^2 \\ge 0$。此条件成立。\n- $2ap\\gamma - k^2 = 2a(|k|)\\left(\\frac{|k|}{a}\\right) - k^2 = 2|k|^2 - k^2 = 2|k|^2 - |k|^2 = |k|^2 \\ge 0$。此条件也成立。\n\n由于所有条件在选择 $p = |k|$ 时都得到满足，我们成功地构造了一个合适的李雅普诺夫凭证。这证实了对于 $\\gamma = \\frac{|k|}{a}$，BRL 不等式是满足的（作为等式，$\\det(\\mathbf{M})=0$），从而验证了 $\\mathcal{H}_{\\infty}$ 范数确实是 $\\frac{|k|}{a}$。",
            "answer": "$$\n\\boxed{\\frac{|k|}{a}}\n$$"
        },
        {
            "introduction": "高增益反馈常用于实现良好的参考跟踪和扰动抑制，但它也可能无意中使系统对未建模动态变得脆弱。本练习将通过分析一个标称稳定系统的灵敏度函数，来揭示这一关键的权衡关系，展示高环路增益如何产生巨大的“灵敏度峰值”并破坏鲁棒性保证。这项练习  突显了为什么标称性能并非全部，并为鲁棒控制设计的必要性提供了有力的佐证。",
            "id": "4241449",
            "problem": "一个信息物理伺服系统通过一个用于控制器整定的数字孪生（DT）模型进行操作。该数字孪生的标称对象是一个单位归一化的二阶柔性执行器，其模型为 $P_{0}(s) = \\frac{1}{s^{2} + 2 \\zeta s + 1}$，阻尼比 $\\zeta = 0.1$。为了实现高低频环路增益，部署了一个比例控制器 $K(s) = k$，其增益 $k = 20$。实际对象与 $P_{0}(s)$ 的区别在于一个加性不确定性 $\\Delta_{a}(s)$，该不确定性在哈代空间 $H_{\\infty}$ 意义上受常数权重 $W(s) = w_{0}$ 的限制，其中 $w_{0} = 0.1$，即对所有实数 $\\omega$ 都有 $|\\Delta_{a}(j\\omega)| \\leq w_{0}$。对于所选参数，使用数字孪生模型的闭环系统是标称稳定的。\n\n从环路传递函数 $L(s) = P_{0}(s) K(s)$ 和灵敏度函数 $S(s) = \\frac{1}{1 + L(s)}$ 的基本定义出发，利用第一性原理推导频率响应 $|S(j\\omega)|$ 并确定其在 $\\omega \\in [0,\\infty)$ 上的上确界。提供等于 $\\|S\\|_{\\infty} = \\sup_{\\omega \\geq 0} |S(j\\omega)|$ 的单个数值。将最终答案表示为无量纲标量，并四舍五入到四位有效数字。\n\n你的构建过程应展示一个标称稳定的高环路增益设计如何可能违反针对加性不确定性的小增益鲁棒稳定性界限，以及这种违背如何表现为灵敏度函数中的一个峰值。不允许使用任何快捷公式；你的推理必须基于核心定义和微积分。",
            "solution": "首先验证问题，以确保其具有科学依据、良构且客观。\n\n### 步骤 1：提取给定条件\n- 标称对象模型：$P_{0}(s) = \\frac{1}{s^{2} + 2 \\zeta s + 1}$\n- 阻尼比：$\\zeta = 0.1$\n- 控制器：$K(s) = k$\n- 控制器增益：$k = 20$\n- 加性不确定性界限：$|\\Delta_{a}(j\\omega)| \\leq |W(s)| = w_{0}$\n- 不确定性权重：$w_{0} = 0.1$\n- 环路传递函数定义：$L(s) = P_{0}(s) K(s)$\n- 灵敏度函数定义：$S(s) = \\frac{1}{1 + L(s)}$\n- 目标：确定 $\\|S\\|_{\\infty} = \\sup_{\\omega \\geq 0} |S(j\\omega)|$ 并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题基于线性控制理论的基本原理，特别是鲁棒控制。它使用了对象、控制器、环路传递函数、灵敏度函数和 $H_{\\infty}$ 范数的标准定义。所有参数均已提供，使得问题自洽且在数学上是良构的。语言精确且客观。这些数值对于一个伺服系统的模型来说在物理上是合理的。高增益控制器可能导致大的灵敏度峰值，从而表明鲁棒性差，这一前提是控制设计中的一个基石概念。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题有效，将提供完整解答。\n\n### 解答推导\n\n标称对象由 $P_{0}(s) = \\frac{1}{s^{2} + 2 \\zeta s + 1}$ 给出，阻尼比 $\\zeta = 0.1$。比例控制器为 $K(s) = k = 20$。\n\n环路传递函数 $L(s)$ 是控制器和标称对象的乘积：\n$$L(s) = K(s) P_{0}(s) = 20 \\cdot \\frac{1}{s^{2} + 2(0.1)s + 1} = \\frac{20}{s^{2} + 0.2s + 1}$$\n\n灵敏度函数 $S(s)$ 定义为：\n$$S(s) = \\frac{1}{1 + L(s)}$$\n代入 $L(s)$ 的表达式：\n$$S(s) = \\frac{1}{1 + \\frac{20}{s^{2} + 0.2s + 1}} = \\frac{s^{2} + 0.2s + 1}{(s^{2} + 0.2s + 1) + 20} = \\frac{s^{2} + 0.2s + 1}{s^{2} + 0.2s + 21}$$\n为了求出 $H_{\\infty}$ 范数，我们分析频率响应的幅值 $|S(j\\omega)|$。我们代入 $s = j\\omega$：\n$$S(j\\omega) = \\frac{(j\\omega)^{2} + 0.2(j\\omega) + 1}{(j\\omega)^{2} + 0.2(j\\omega) + 21} = \\frac{-\\omega^{2} + 0.2j\\omega + 1}{-\\omega^{2} + 0.2j\\omega + 21} = \\frac{(1 - \\omega^{2}) + j(0.2\\omega)}{(21 - \\omega^{2}) + j(0.2\\omega)}$$\n频率响应的幅值平方为：\n$$|S(j\\omega)|^{2} = \\frac{|(1 - \\omega^{2}) + j(0.2\\omega)|^{2}}{|(21 - \\omega^{2}) + j(0.2\\omega)|^{2}} = \\frac{(1 - \\omega^{2})^{2} + (0.2\\omega)^{2}}{(21 - \\omega^{2})^{2} + (0.2\\omega)^{2}}$$\n展开各项：\n$$|S(j\\omega)|^{2} = \\frac{1 - 2\\omega^{2} + \\omega^{4} + 0.04\\omega^{2}}{441 - 42\\omega^{2} + \\omega^{4} + 0.04\\omega^{2}} = \\frac{\\omega^{4} - 1.96\\omega^{2} + 1}{\\omega^{4} - 41.96\\omega^{2} + 441}$$\n我们寻求此函数在 $\\omega \\in [0, \\infty)$ 上的最大值。这等效于关于 $\\omega^{2}$ 最大化该函数。设 $x = \\omega^{2}$，其中 $x \\geq 0$。我们定义函数 $f(x)$：\n$$f(x) = \\frac{x^{2} - 1.96x + 1}{x^{2} - 41.96x + 441}$$\n为求极值，我们计算导数 $f'(x)$ 并将其设为零。使用商法则 $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^{2}}$，其中 $u(x) = x^{2} - 1.96x + 1$ 且 $v(x) = x^{2} - 41.96x + 441$：\n$$u'(x) = 2x - 1.96$$\n$$v'(x) = 2x - 41.96$$\n将导数的分子设为零：\n$$u'v - uv' = (2x - 1.96)(x^{2} - 41.96x + 441) - (x^{2} - 1.96x + 1)(2x - 41.96) = 0$$\n展开乘积：\n$$(2x^3 - 83.92x^2 + 882x - 1.96x^2 + 82.2416x - 864.36) - (2x^3 - 41.96x^2 - 3.92x^2 + 82.2416x + 2x - 41.96) = 0$$\n$$(2x^3 - 85.88x^2 + 964.2416x - 864.36) - (2x^3 - 45.88x^2 + 84.2416x - 41.96) = 0$$\n合并同类项：\n$$(-85.88 + 45.88)x^2 + (964.2416 - 84.2416)x + (-864.36 + 41.96) = 0$$\n$$-40x^{2} + 880x - 822.4 = 0$$\n两边同除以 $-40$：\n$$x^{2} - 22x + 20.56 = 0$$\n我们使用二次方程求根公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解这个关于 $x$ 的二次方程：\n$$x = \\frac{22 \\pm \\sqrt{(-22)^{2} - 4(1)(20.56)}}{2(1)} = \\frac{22 \\pm \\sqrt{484 - 82.24}}{2} = \\frac{22 \\pm \\sqrt{401.76}}{2}$$\n$x = \\omega^{2}$ 的两个解是：\n$$x_{1} = \\frac{22 - \\sqrt{401.76}}{2} \\approx \\frac{22 - 20.04395}{2} \\approx 0.978025$$\n$$x_{2} = \\frac{22 + \\sqrt{401.76}}{2} \\approx \\frac{22 + 20.04395}{2} \\approx 21.021975$$\n我们必须确定这些临界点中哪一个对应于最大值。我们检查在端点（$x=0$ 和 $x \\to \\infty$）以及在临界点处的函数值。\n- 在 $x=0$ ($\\omega=0$) 处：$f(0) = \\frac{1}{441} \\approx 0.00227$。\n- 当 $x \\to \\infty$ ($\\omega \\to \\infty$) 时：$\\lim_{x \\to \\infty} f(x) = 1$。\n- 在 $x_{1} \\approx 0.978025$ 处：$f(0.978025) \\approx \\frac{(0.978025)^2 - 1.96(0.978025) + 1}{(0.978025)^2 - 41.96(0.978025) + 441} \\approx \\frac{0.0396}{400.9} \\approx 9.88 \\times 10^{-5}$。这是一个最小值。\n- 在 $x_{2} \\approx 21.021975$ 处：\n$$f(21.021975) \\approx \\frac{(21.021975)^{2} - 1.96(21.021975) + 1}{(21.021975)^{2} - 41.96(21.021975) + 441}$$\n$$f(21.021975) \\approx \\frac{441.9234 - 41.2031 + 1}{441.9234 - 882.0421 + 441} = \\frac{401.7203}{0.8813} \\approx 455.85$$\n该值为 $f(x)$ 的最大值。因此，灵敏度函数的幅值平方峰值为 $\\|S\\|_{\\infty}^{2} \\approx 455.85$。\n$H_{\\infty}$ 范数是幅值的上确界，即该值的平方根：\n$$\\|S\\|_{\\infty} = \\sup_{\\omega \\geq 0} |S(j\\omega)| = \\sqrt{f(x_{2})} \\approx \\sqrt{455.85} \\approx 21.3506$$\n加性不确定性的鲁棒稳定性条件为 $|k|\\|S\\|_{\\infty} < 1/w_0$。使用给定值，这变为 $20 \\cdot \\|S\\|_{\\infty} < 1/0.1=10$，即 $\\|S\\|_{\\infty} < 0.5$。我们计算出的峰值约为 $21.35$，这严重违反了此条件，表明高增益设计如何导致系统对此类不确定性的鲁棒性非常差。\n\n将结果四舍五入到四位有效数字，得到 $21.35$。",
            "answer": "$$\\boxed{21.35}$$"
        },
        {
            "introduction": "现实世界系统的参数通常具有不确定性，但已知其在特定范围内变化，这种情况可以很好地用多胞不确定性来建模。本练习要求你从分析转向综合，设计一个单一的、固定的状态反馈控制器，来保证整个系统族的稳定性。你将把二次稳定性的理论条件转化为一个计算搜索算法，从而跨越抽象的矩阵不等式理论与基于代码的控制器综合实践之间的鸿沟 。",
            "id": "4241443",
            "problem": "考虑一个连续时间线性时不变信息物理系统，该系统在数字孪生中被建模为一个不确定对象，其状态空间矩阵在一个凸多胞体内仿射变化。不确定性集合由一个有限的顶点集 $\\{(A_i,B_i)\\}_{i=1}^{N}$ 表示，其中 $A_i \\in \\mathbb{R}^{n \\times n}$ 且 $B_i \\in \\mathbb{R}^{n \\times m}$。实际的对象矩阵 $(A(\\theta),B(\\theta))$ 是这些顶点的任意凸组合，即 $A(\\theta) = \\sum_{i=1}^{N} \\theta_i A_i$，$B(\\theta) = \\sum_{i=1}^{N} \\theta_i B_i$，其中 $\\theta_i \\ge 0$ 且 $\\sum_{i=1}^{N} \\theta_i = 1$。您的任务是使用静态状态反馈 $u(t) = K x(t)$ 来确保鲁棒镇定，该镇定对所有顶点的凸组合均有效。请从线性系统的基本 Lyapunov 稳定性原理和凸性定义出发，推导保证存在一个公共对称正定矩阵 $P \\succ 0$ 的条件，该矩阵能够在一个单一恒定反馈矩阵 $K$ 的作用下，同时为所有顶点证明鲁棒指数稳定性。这些条件必须能够以恰当选择的决策变量表示为线性矩阵不等式，推导过程不应假设使用任何专门的求解器。\n\n然后，设计一个算法，为给定的顶点集搜索满足这些条件的可行对 $(K,P)$。您的算法必须是正确的，即如果它找到了一个证明 $(K,P)$，那么推导出的不等式对于所有给定的顶点都成立。为保证数值鲁棒性，要求采用严格不等式，即在每个顶点 $i$ 处强制裕度 $S_i \\preceq -\\varepsilon I_n$，其中 $\\varepsilon > 0$ 是一个固定的小常数，$S_i$ 是您推导的条件中指定的对称部分，$I_n$ 是维度为 $n$ 的单位矩阵。您的算法可以对受限的矩阵 $P$ 和增益 $K$ 族进行结构化搜索，但必须明确陈述并证明此限制的合理性；它必须对每个候选解精确地检查所推导出的不等式。\n\n您的程序必须实现该算法并评估以下测试套件，其中包括一个一般情况、一个不需要控制作用的边界情况以及一个不可行的情况：\n\n- 测试用例1（具有刚度不确定性的鲁棒可镇定质量-弹簧-阻尼器数字孪生）：\n  - 维度：$n=2$, $m=1$。\n  - 顶点：$A_1 = \\begin{bmatrix} 0 & 1 \\\\ -1.0 & -0.4 \\end{bmatrix}$，$A_2 = \\begin{bmatrix} 0 & 1 \\\\ -2.0 & -0.4 \\end{bmatrix}$，以及 $B_1 = B_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- 测试用例2（开环稳定的多胞形对象；反馈 $K=0$ 即满足要求）：\n  - 维度：$n=2$, $m=1$。\n  - 顶点：$A_1 = \\begin{bmatrix} -1.0 & 0 \\\\ 0 & -2.0 \\end{bmatrix}$，$A_2 = \\begin{bmatrix} -1.5 & 0 \\\\ 0 & -1.0 \\end{bmatrix}$，以及 $B_1 = B_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- 测试用例3（因存在不可控的不稳定顶点而不可行）：\n  - 维度：$n=2$, $m=1$。\n  - 顶点：$(A_1,B_1)$ 其中 $A_1 = \\begin{bmatrix} 0 & 1 \\\\ 0 & 0 \\end{bmatrix}$ 且 $B_1 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，以及 $(A_2,B_2)$ 其中 $A_2 = \\begin{bmatrix} -1 & 1 \\\\ -1 & -1 \\end{bmatrix}$ 且 $B_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n\n实现要求：\n- 在检查不等式中的严格负定性时，使用固定裕度 $\\varepsilon = 10^{-5}$。\n- 将 Lyapunov 矩阵限制为对角矩阵，即 $P = \\mathrm{diag}(p_1,\\dots,p_n)$，其中 $p_j > 0$，并在一个有限的正值集合中搜索每个 $p_j$。将反馈限制为静态状态反馈 $K \\in \\mathbb{R}^{m \\times n}$，并在一个有限网格上搜索其元素。\n- 对于每个候选对 $(K,P)$，在每个顶点 $i$ 处构造由您推导的条件所蕴含的对称矩阵 $S_i$，并且当且仅当所有 $S_i \\preceq -\\varepsilon I_n$ 都成立时，才接受 $(K,P)$。\n- 对于以上述顺序列出的每个测试用例，如果找到了这样的对 $(K,P)$，程序应返回布尔值 $\\mathrm{True}$，否则返回 $\\mathrm{False}$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的、用方括号括起来的 Python 风格布尔值列表（例如，“[True,False,True]”）作为结果。本问题不涉及任何物理单位、角度或百分比。所有数值均为实数，并采用标准浮点解释。",
            "solution": "该问题要求为多胞形不确定系统推导稳定性条件，并实现一个搜索算法来寻找鲁棒的静态状态反馈控制器。\n\n### 步骤 1：鲁棒稳定性条件的推导\n\n所考虑的系统是一个连续时间线性时不变 (LTI) 对象，由以下状态空间方程描述：\n$$ \\dot{x}(t) = A(\\theta)x(t) + B(\\theta)u(t) $$\n其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$u(t) \\in \\mathbb{R}^m$ 是控制输入。系统矩阵 $(A(\\theta), B(\\theta))$ 是不确定的，并且属于一个由 $N$ 个顶点 $\\{(A_i, B_i)\\}_{i=1}^{N}$ 的有限集合定义的凸多胞体。任何对象实现都是这些顶点的凸组合：\n$$ A(\\theta) = \\sum_{i=1}^{N} \\theta_i A_i, \\quad B(\\theta) = \\sum_{i=1}^{N} \\theta_i B_i $$\n其中参数 $\\theta_i \\ge 0$ 且 $\\sum_{i=1}^{N} \\theta_i = 1$。\n\n我们需要设计一个静态状态反馈控制器 $u(t) = K x(t)$，其中 $K \\in \\mathbb{R}^{m \\times n}$ 是一个常数增益矩阵。得到的闭环系统为：\n$$ \\dot{x}(t) = (A(\\theta) + B(\\theta)K)x(t) $$\n\n根据线性系统的 Lyapunov 稳定性理论，闭环系统是指数稳定的，当且仅当存在一个对称正定矩阵 $P \\succ 0$（即 $P=P^T$ 且对所有 $x \\neq 0$ 都有 $x^T P x > 0$），使得以下不等式成立：\n$$ (A(\\theta) + B(\\theta)K)^T P + P (A(\\theta) + B(\\theta)K) \\prec 0 $$\n这个不等式被称为 Lyapunov 不等式。\n\n为了确保多胞体内所有可能的对象实现的鲁棒稳定性，我们必须找到一个单一的、*公共的* Lyapunov 矩阵 $P \\succ 0$ 和一个单一的增益矩阵 $K$，使得 Lyapunov 不等式对所有允许的 $\\theta$ 都成立。\n\n将 $A(\\theta)$ 和 $B(\\theta)$ 的多胞体定义代入不等式：\n$$ \\left(\\sum_{i=1}^{N} \\theta_i A_i + \\left(\\sum_{i=1}^{N} \\theta_i B_i\\right)K\\right)^T P + P \\left(\\sum_{i=1}^{N} \\theta_i A_i + \\left(\\sum_{i=1}^{N} \\theta_i B_i\\right)K\\right) \\prec 0 $$\n利用矩阵运算的线性性质，可以将其重写为：\n$$ \\sum_{i=1}^{N} \\theta_i \\left[ (A_i + B_i K)^T P + P (A_i + B_i K) \\right] \\prec 0 $$\n我们定义矩阵 $S_i(P, K) = (A_i + B_i K)^T P + P (A_i + B_i K)$。条件变为：\n$$ \\sum_{i=1}^{N} \\theta_i S_i(P, K) \\prec 0 $$\n该表达式表示矩阵 $S_i$ 的一个凸组合。凸集的一个关键性质是，如果一个条件对所有顶点都成立，那么它对其凸包内的任何点都成立。因此，如果我们能保证对于每个顶点 $i=1, \\dots, N$ 都有 $S_i(P, K) \\prec 0$，那么其和作为负定矩阵的凸组合（其中 $\\theta_i \\ge 0$ 且不全为零），也必定是负定的。\n\n因此，鲁棒稳定性的条件简化为找到一个公共对称矩阵 $P \\succ 0$ 和一个增益矩阵 $K$，使得以下矩阵不等式集合对所有顶点 $i = 1, \\dots, N$ 同时成立：\n$$ (A_i + B_i K)^T P + P (A_i + B_i K) \\prec 0 $$\n这些不等式在决策变量 $P$ 和 $K$ 上不是线性的（它们是双线性的），但可以通过变量代换转化为线性矩阵不等式（LMI）。然而，本问题指定了对 $(K, P)$ 进行直接搜索。\n\n### 步骤 2：算法设计\n\n问题要求我们设计一个算法，在特定限制下搜索一个可行的 $(K,P)$ 对。\n\n1.  **定义搜索空间**：\n    *   Lyapunov 矩阵 $P$ 被限制为对角矩阵：$P = \\mathrm{diag}(p_1, \\dots, p_n)$，其中 $p_j > 0$。我们将在一个预定义的有限正值集合中搜索每个 $p_j$。\n    *   反馈增益矩阵 $K \\in \\mathbb{R}^{m \\times n}$ 的元素在一个预定义的有限实数网格上进行搜索。\n\n2.  **迭代搜索**：\n    该算法对 $P$ 和 $K$ 的离散候选集执行系统的、暴力搜索。\n    *   一个外层循环遍历其定义的搜索空间中所有可能的对角矩阵 $P$。根据构造，这些候选矩阵是对称且正定的。\n    *   一个内层循环遍历其定义的网格中所有可能的增益矩阵 $K$。\n\n3.  **验证**：\n    对于每个候选对 $(P, K)$，算法会验证它是否构成了鲁棒稳定性的有效证明。\n    *   对于每个顶点 $i = 1, \\dots, N$，计算矩阵 $S_i = (A_i + B_i K)^T P + P (A_i + B_i K)$。\n    *   为保证数值鲁棒性，我们必须以 $\\varepsilon = 10^{-5}$ 的裕度检查严格负定性。需要验证的条件是 $S_i \\preceq -\\varepsilon I_n$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n    *   一个对称矩阵 $M$ 满足 $M \\preceq c I$ 当且仅当其最大特征值 $\\lambda_{\\max}(M)$ 满足 $\\lambda_{\\max}(M) \\le c$。因此，该检查等价于验证对所有 $i=1, \\dots, N$ 都有 $\\lambda_{\\max}(S_i) \\le -\\varepsilon$。\n    *   如果对于任何顶点 $i$，此条件被违反，则丢弃当前的 $(P, K)$ 对，并继续搜索。\n\n4.  **终止**：\n    *   如果找到一个同时满足所有顶点不等式的 $(P, K)$ 对，则算法找到了一个有效的证明。对于相应的测试用例，结果为 `True`，该用例的搜索终止。\n    *   如果循环完成而没有找到任何这样的对，则表示搜索空间已被穷尽。算法断定在给定限制下未找到解，该测试用例的结果为 `False`。\n\n必须注意，该算法的成功与否取决于为 $P$ 和 $K$ 选择的搜索空间以及 $P$ 必须为对角矩阵的限制。`False` 的结果表明在此受限搜索中未找到解，但并不一定意味着系统不存在鲁棒镇定控制器（例如，可能需要非对角的 Lyapunov 矩阵 $P$）。例如，对于测试用例1这类处于可控标准型的系统，使用对角 $P$ 矩阵会导致 Lyapunov 不等式中的 (1,1) 元素始终为零，从而无法满足严格负定性的条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import product\n\ndef find_stabilizer(case_data):\n    \"\"\"\n    Searches for a robustly stabilizing state-feedback controller K and\n    a diagonal Lyapunov matrix P for a given polytopic uncertain system.\n    \"\"\"\n    A_verts, B_verts, n, m, epsilon = case_data\n\n    # Define a discrete search space for the diagonal entries of P.\n    # P must be positive definite, so we choose positive values.\n    p_values = [0.1, 0.5, 1.0, 5.0, 10.0]\n\n    # Define a discrete grid for the entries of the feedback gain matrix K.\n    # The range is chosen to be reasonably broad.\n    k_values = np.linspace(-10.0, 10.0, num=9)  # 9 values from -10 to 10\n\n    # Iterate through all candidate P matrices (diagonal)\n    p_diagonals = product(p_values, repeat=n)\n    for p_diag_tuple in p_diagonals:\n        P = np.diag(p_diag_tuple)\n        \n        # Iterate through all candidate K matrices\n        k_entries = product(k_values, repeat=m * n)\n        for k_flat_tuple in k_entries:\n            K = np.array(k_flat_tuple).reshape((m, n))\n            \n            # For the current (P, K) pair, check the stability condition at each vertex.\n            is_pair_valid = True\n            for i in range(len(A_verts)):\n                Ai = A_verts[i]\n                Bi = B_verts[i]\n                \n                # Closed-loop matrix for vertex i\n                A_cl = Ai + Bi @ K\n                \n                # Form the matrix S_i from the Lyapunov inequality\n                S_i = A_cl.T @ P + P @ A_cl\n                \n                # Check for strict negative definiteness: S_i = -epsilon * I\n                # This is equivalent to max(eigenvalues(S_i)) = -epsilon.\n                # Use eigvalsh for symmetric matrices for numerical stability and efficiency.\n                try:\n                    eigenvalues = np.linalg.eigvalsh(S_i)\n                    if np.max(eigenvalues) > -epsilon:\n                        is_pair_valid = False\n                        break  # This (P, K) pair is invalid, try next one.\n                except np.linalg.LinAlgError:\n                    # If eigenvalue computation fails, the matrix is likely ill-conditioned.\n                    # We treat this as a failure for this candidate pair.\n                    is_pair_valid = False\n                    break\n\n            if is_pair_valid:\n                # A valid (P, K) certificate was found for all vertices.\n                return True\n\n    # If the loops complete, no suitable (P, K) was found in the search space.\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the search algorithm.\n    \"\"\"\n    epsilon = 1e-5\n\n    # Test Case 1: Robustly stabilizable mass-spring-damper, but not with a diagonal P.\n    case1_A1 = np.array([[0.0, 1.0], [-1.0, -0.4]])\n    case1_A2 = np.array([[0.0, 1.0], [-2.0, -0.4]])\n    case1_B = np.array([[0.0], [1.0]])\n    case1 = ([case1_A1, case1_A2], [case1_B, case1_B], 2, 1, epsilon)\n\n    # Test Case 2: Open-loop stable system where K=0 is a valid solution.\n    case2_A1 = np.array([[-1.0, 0.0], [0.0, -2.0]])\n    case2_A2 = np.array([[-1.5, 0.0], [0.0, -1.0]])\n    case2_B = np.array([[0.0], [1.0]])\n    case2 = ([case2_A1, case2_A2], [case2_B, case2_B], 2, 1, epsilon)\n\n    # Test Case 3: Infeasible due to an uncontrollable unstable vertex.\n    case3_A1 = np.array([[0.0, 1.0], [0.0, 0.0]])\n    case3_B1 = np.array([[0.0], [0.0]])\n    case3_A2 = np.array([[-1.0, 1.0], [-1.0, -1.0]])\n    case3_B2 = np.array([[0.0], [1.0]])\n    case3 = ([case3_A1, case3_A2], [case3_B1, case3_B2], 2, 1, epsilon)\n    \n    test_cases = [\n        case1,\n        case2,\n        case3,\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_stabilizer(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}