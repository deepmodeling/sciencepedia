{
    "hands_on_practices": [
        {
            "introduction": "设计扰动观测器（DOB）的核心在于$Q$滤波器的选择，其带宽决定了一个关键的权衡。此练习旨在通过量化扰动跟踪误差与噪声放大之间的关系，来指导$Q$滤波器的优化设计。通过求解一个基于功率谱密度（PSD）的均方误差最小化问题，您将亲手确定在给定扰动和噪声特性下的最优滤波器带宽。",
            "id": "4218779",
            "problem": "一个信息物理系统由一个数字孪生（DT）进行监控，该数字孪生实现了一个扰动观测器（DO）来估计一个附加的输出扰动。物理装置是线性时不变（LTI）的，并且在工作区域内，DT提供了一个精确的标称模型，因此实际装置等于标称装置。标称装置由 $P_{n}(s)=\\frac{1}{s+1}$ 给出。DO 使用标准残差 $y(s)-P_{n}(s)u(s)$，其中 $y(s)$ 是测量输出，$u(s)$ 是控制输入，且测量值受到附加传感器噪声的干扰。DO 的估计值是通过一个一阶低通 $Q$ 滤波器 $Q(s)=\\frac{\\omega_{c}}{s+\\omega_{c}}$ 对此残差进行滤波而形成的，其中 $\\omega_{c}>0$ 是待选的截止角频率。\n\n假设信号结构和模型如下：\n- 真实输出为 $y(s)=P_{n}(s)u(s)+d(s)+n(s)$，其中 $d(s)$ 是附加输出扰动，$n(s)$ 是附加传感器噪声。\n- 由于 DT 提供了精确的标称匹配，$P(s)=P_{n}(s)$，因此不存在模型失配项。\n- 附加扰动 $d(t)$ 是一个广义平稳过程，其单边功率谱密度（PSD）$S_{d}(\\omega)$ 在 $0\\leq \\omega\\leq \\omega_{d}$ 上为常数 $S_{d0}$，在 $\\omega>\\omega_{d}$ 时为零。\n- 传感器噪声 $n(t)$ 是白噪声，其单边 PSD 在所有 $\\omega\\geq 0$ 上为 $S_{n}(\\omega)=S_{n0}$。\n- 所有过程相互不相关。\n\n从频域中的基本 LTI 输入输出关系和通过单边 PSD 定义的均方误差出发，推导由 $d(t)$ 和 $n(t)$ 引起的对 DO 估计 $\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$ 的频域扰动估计误差。然后，通过对误差谱进行频率积分，得到一个标量代价 $J(\\omega_{c})$，其等于作为 $\\omega_{c}$ 函数的单边均方估计误差。最后，对于数值 $S_{d0}=2\\pi$、$S_{n0}=\\pi-2$ 和 $\\omega_{d}=10$，确定最小化 $J(\\omega_{c})$ 的截止角频率 $\\omega_{c}^{\\star}$。\n\n以弧度/秒为单位表示最终的最优截止角频率。无需四舍五入；请提供精确值。",
            "solution": "首先验证问题，以确保其科学基础扎实、适定且客观。\n\n### 步骤 1：提取已知条件\n- **标称装置模型**：$P_{n}(s)=\\frac{1}{s+1}$。\n- **装置-模型关系**：标称模型是精确的，$P(s)=P_{n}(s)$。\n- **输出方程**：$y(s)=P_{n}(s)u(s)+d(s)+n(s)$，其中 $d(s)$ 是扰动，$n(s)$ 是传感器噪声。\n- **扰动观测器（DO）估计**：$\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$。\n- **Q 滤波器**：$Q(s)=\\frac{\\omega_{c}}{s+\\omega_{c}}$，其中 $\\omega_{c}>0$。\n- **扰动 PSD**：$d(t)$ 的单边功率谱密度（PSD）在 $0\\leq \\omega\\leq \\omega_{d}$ 上为 $S_{d}(\\omega) = S_{d0}$，在 $\\omega>\\omega_{d}$ 时为 $S_{d}(\\omega)=0$。\n- **噪声 PSD**：$n(t)$ 的单边 PSD 在所有 $\\omega\\geq 0$ 上为 $S_{n}(\\omega)=S_{n0}$。\n- **信号属性**：过程 $d(t)$ 和 $n(t)$ 是广义平稳且相互不相关的。\n- **数值**：$S_{d0}=2\\pi$，$S_{n0}=\\pi-2$ 和 $\\omega_{d}=10$。\n- **目标**：找到最小化均方估计误差 $J(\\omega_c)$ 的最优截止角频率 $\\omega_c^{\\star}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础扎实**：该问题在控制理论和扰动观测器设计的既定领域内，使用了线性时不变（LTI）系统、随机过程（PSD）和优化的标准原理。所有概念都是有效的。\n- **适定性**：问题是完全指定的。所有必要的模型、信号特性和数值都已提供，以构建和解决优化问题。给出了物理约束 $\\omega_c>0$。PSD 值 $S_{d0}=2\\pi > 0$ 和 $S_{n0}=\\pi-2 > 0$ 在物理上是有意义的。\n- **客观性**：问题陈述是精确的、定量的，并且没有主观因素。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整的解答。\n\n### 均方估计误差的推导\n\nLaplace 域中的扰动估计误差为 $\\tilde{d}(s) = d(s) - \\hat{d}(s)$。\n扰动估计由 $\\hat{d}(s)=Q(s)\\big(y(s)-P_{n}(s)u(s)\\big)$ 给出。\n代入输出 $y(s)$ 的表达式，我们得到：\n$$y(s)-P_{n}(s)u(s) = \\big(P_{n}(s)u(s)+d(s)+n(s)\\big) - P_{n}(s)u(s) = d(s) + n(s)$$\n因此，扰动估计为 $\\hat{d}(s) = Q(s) \\big(d(s) + n(s)\\big)$。\n那么估计误差为：\n$$\\tilde{d}(s) = d(s) - Q(s)\\big(d(s) + n(s)\\big) = \\big(1 - Q(s)\\big)d(s) - Q(s)n(s)$$\n误差信号 $\\tilde{d}(t)$ 是一个具有两个输入 $d(t)$ 和 $n(t)$ 的 LTI 系统的输出。从 $d(t)$到 $\\tilde{d}(t)$ 的传递函数是 $T_{d\\tilde{d}}(s) = 1 - Q(s)$，从 $n(t)$ 到 $\\tilde{d}(t)$ 的传递函数是 $T_{n\\tilde{d}}(s) = -Q(s)$。\n由于 $d(t)$ 和 $n(t)$ 不相关，估计误差的单边 PSD $S_{\\tilde{d}}(\\omega)$ 是各单个输出 PSD 的和：\n$$S_{\\tilde{d}}(\\omega) = |T_{d\\tilde{d}}(j\\omega)|^2 S_{d}(\\omega) + |T_{n\\tilde{d}}(j\\omega)|^2 S_{n}(\\omega) = |1 - Q(j\\omega)|^2 S_{d}(\\omega) + |Q(j\\omega)|^2 S_{n}(\\omega)$$\n我们计算给定 $Q$ 滤波器 $Q(s) = \\frac{\\omega_c}{s+\\omega_c}$ 的频率响应幅值：\n$$Q(j\\omega) = \\frac{\\omega_c}{j\\omega + \\omega_c} \\implies |Q(j\\omega)|^2 = Q(j\\omega)Q(-j\\omega) = \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2}$$\n$$1 - Q(j\\omega) = 1 - \\frac{\\omega_c}{j\\omega + \\omega_c} = \\frac{j\\omega}{j\\omega + \\omega_c} \\implies |1 - Q(j\\omega)|^2 = \\frac{\\omega^2}{\\omega^2 + \\omega_c^2}$$\n将这些代入 $S_{\\tilde{d}}(\\omega)$ 的表达式中：\n$$S_{\\tilde{d}}(\\omega) = \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} S_{d}(\\omega) + \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2} S_{n}(\\omega)$$\n标量代价 $J(\\omega_c)$ 是均方估计误差，通过对所有频率上的单边误差 PSD 进行积分得到：\n$$J(\\omega_c) = E[\\tilde{d}^2(t)] = \\frac{1}{2\\pi} \\int_0^\\infty S_{\\tilde{d}}(\\omega) d\\omega$$\n我们可以将代价分为由扰动引起的分量 $J_d(\\omega_c)$ 和由噪声引起的分量 $J_n(\\omega_c)$。\n$$J(\\omega_c) = J_d(\\omega_c) + J_n(\\omega_c)$$\n使用给定的扰动 PSD，第一个分量是：\n$$J_d(\\omega_c) = \\frac{1}{2\\pi} \\int_0^\\infty \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} S_{d}(\\omega) d\\omega = \\frac{S_{d0}}{2\\pi} \\int_0^{\\omega_d} \\frac{\\omega^2}{\\omega^2 + \\omega_c^2} d\\omega$$\n$$J_d(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\int_0^{\\omega_d} \\left(1 - \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2}\\right) d\\omega = \\frac{S_{d0}}{2\\pi} \\left[ \\omega - \\omega_c \\arctan\\left(\\frac{\\omega}{\\omega_c}\\right) \\right]_0^{\\omega_d}$$\n$$J_d(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right)$$\n使用给定的噪声 PSD，第二个分量是：\n$$J_n(\\omega_c) = \\frac{1}{2\\pi} \\int_0^\\infty \\frac{\\omega_c^2}{\\omega^2 + \\omega_c^2} S_{n}(\\omega) d\\omega = \\frac{S_{n0}\\omega_c^2}{2\\pi} \\int_0^\\infty \\frac{1}{\\omega^2 + \\omega_c^2} d\\omega$$\n该积分的计算结果为 $\\int_0^\\infty \\frac{1}{\\omega^2 + \\omega_c^2} d\\omega = \\left[ \\frac{1}{\\omega_c} \\arctan\\left(\\frac{\\omega}{\\omega_c}\\right) \\right]_0^\\infty = \\frac{1}{\\omega_c}\\left(\\frac{\\pi}{2} - 0\\right) = \\frac{\\pi}{2\\omega_c}$。\n$$J_n(\\omega_c) = \\frac{S_{n0}\\omega_c^2}{2\\pi} \\left( \\frac{\\pi}{2\\omega_c} \\right) = \\frac{S_{n0}\\omega_c}{4}$$\n总代价函数为：\n$$J(\\omega_c) = \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) + \\frac{S_{n0}\\omega_c}{4}$$\n\n### 截止频率的优化\n\n为了找到最小化 $J(\\omega_c)$ 的最优截止频率 $\\omega_c^{\\star}$，我们将其关于 $\\omega_c$ 的导数设为零。\n$$\\frac{dJ}{d\\omega_c} = \\frac{d}{d\\omega_c} \\left[ \\frac{S_{d0}}{2\\pi} \\left( \\omega_d - \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) + \\frac{S_{n0}\\omega_c}{4} \\right] = 0$$\n我们来计算各项的导数：\n$$\\frac{d}{d\\omega_c} \\left( \\frac{S_{n0}\\omega_c}{4} \\right) = \\frac{S_{n0}}{4}$$\n$$\\frac{d}{d\\omega_c} \\left( \\omega_c \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) \\right) = \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) + \\omega_c \\left( \\frac{1}{1+(\\omega_d/\\omega_c)^2} \\cdot \\left(-\\frac{\\omega_d}{\\omega_c^2}\\right) \\right) = \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2}$$\n所以，总导数为：\n$$\\frac{dJ}{d\\omega_c} = \\frac{S_{d0}}{2\\pi} \\left( -\\left[ \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2} \\right] \\right) + \\frac{S_{n0}}{4} = 0$$\n整理各项得到最优性条件：\n$$\\frac{S_{n0}}{4} = \\frac{S_{d0}}{2\\pi} \\left( \\arctan\\left(\\frac{\\omega_d}{\\omega_c}\\right) - \\frac{\\omega_c\\omega_d}{\\omega_c^2 + \\omega_d^2} \\right)$$\n现在我们代入给定的数值：$S_{d0}=2\\pi$，$S_{n0}=\\pi-2$ 和 $\\omega_d=10$。\n$$\\frac{\\pi-2}{4} = \\frac{2\\pi}{2\\pi} \\left( \\arctan\\left(\\frac{10}{\\omega_c}\\right) - \\frac{10\\omega_c}{\\omega_c^2 + 10^2} \\right)$$\n$$\\frac{\\pi-2}{4} = \\arctan\\left(\\frac{10}{\\omega_c}\\right) - \\frac{10\\omega_c}{\\omega_c^2 + 100}$$\n我们需要解这个关于 $\\omega_c$ 的超越方程。让我们测试一个可能的解 $\\omega_c = \\omega_d = 10$。\n将 $\\omega_c=10$ 代入方程的右侧：\n$$\\text{右侧} = \\arctan\\left(\\frac{10}{10}\\right) - \\frac{10(10)}{10^2 + 100} = \\arctan(1) - \\frac{100}{200} = \\frac{\\pi}{4} - \\frac{1}{2}$$\n化简右侧得到：\n$$\\frac{\\pi}{4} - \\frac{2}{4} = \\frac{\\pi-2}{4}$$\n这与方程的左侧完全相同。因此，$\\omega_c^{\\star} = 10$ 是满足最优性条件的解。$J(\\omega_c)$ 的二阶导数可以证明为正，从而确认该驻点是一个最小值点。\n最优截止角频率为 $10$ 弧度/秒。",
            "answer": "$$\n\\boxed{10}\n$$"
        },
        {
            "introduction": "尽管高带宽$Q$滤波器有利于扰动抑制，但在实际应用中，我们必须考虑模型不确定性的影响。此练习将引导您运用小增益定理，推导在存在乘性不确定性（特别是轻阻尼柔性模式）时保证扰动观测器鲁棒稳定性的条件。通过这个反例，您将深刻理解为何过于激进的观测器带宽会损害系统稳定性，从而学会在性能和鲁棒性之间做出明智的折衷。",
            "id": "4218791",
            "problem": "考虑一个线性时不变信息物理系统，该系统配备一个用于通过扰动观测器（DOB）进行扰动补偿的数字孪生模型。设拉普拉斯域中真实对象的输入输出关系为 $Y(s) = P(s) U(s) + D(s)$，其中 $P(s)$ 是真实对象，$U(s)$ 是指令输入，$D(s)$ 是外部扰动。数字孪生使用一个标称模型 $P_n(s)$，并通过一个稳定的、严格正常的低通滤波器 $Q(s)$ 和标称逆模型 $P_n^{-1}(s)$ 来形成扰动估计，这是标准DOB架构的一部分。假设存在乘性模型不确定性，记作 $P(s) = P_n(s) \\left( 1 + W_m(s) \\Delta(s) \\right)$，其中 $W_m(s)$ 是一个已知的频率相关权重，用于捕捉不确定性（具有弱阻尼柔性模态行为），而 $\\Delta(s)$ 是任何满足 $\\left\\| \\Delta(j\\omega) \\right\\|_\\infty \\leq 1$ 的稳定有界扰动。频率单位必须为弧度/秒。\n\n仅从线性时不变系统、卷积、拉普拉斯变换以及反馈互联的小增益定理的定义出发，推导一个在存在乘性不确定性时保证DOB补偿内部稳定性的数学上严格的条件。您的推导必须明确阐述DOB内环中不确定性输入和输出之间的反馈互联映射，并且必须量化$Q(s)$滤波器的带宽如何影响此互联的鲁棒性。然后，利用不确定性权重中的弱阻尼柔性模态构建一个反例，并提供一个逻辑上合理的论证，解释为什么将$Q(s)$带宽设置得过于激进会降低鲁棒性。\n\n为确保具体性和数值验证，请对低通滤波器和乘性不确定性权重使用以下参数化：\n- $Q(s) = \\dfrac{\\omega_q}{s + \\omega_q}$，带宽参数 $\\omega_q > 0$，单位为弧度/秒。\n- $W_m(s) = k_w \\dfrac{\\omega_f^2}{s^2 + 2 \\zeta_f \\omega_f s + \\omega_f^2}$，其中 $\\omega_f > 0$ 是柔性模态的自然频率，单位为弧度/秒，$\\zeta_f \\in (0, 1)$ 是其阻尼比，$k_w > 0$ 是一个无量纲的不确定性尺度因子。\n\n在推导出条件后，实现一个程序，对于任何给定的参数集 $(\\omega_q,\\omega_f,\\zeta_f,k_w)$，该程序能在频率 $\\omega \\in [10^{-1}, 10^{4}]$ 弧度/秒范围内，数值计算您推导出的DOB内环中从不确定性到其自身的环路增益幅值的上确界。基于此上确界，返回一个布尔值，指示在乘性不确定性模型下，对于所有容许的 $\\Delta(s)$，鲁棒稳定性是否得到保证。程序必须将角度视为弧度，频率视为弧度/秒。输出中不需要其他物理单位。\n\n测试套件：\n使用以下四个参数集来展示覆盖范围，包括一个一般情况、一个破坏鲁棒性的激进带宽情况、一个增加阻尼以恢复鲁棒性的情况，以及一个接近失去鲁棒性的边界情况：\n1. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (30,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n2. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (400,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n3. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (400,\\ 200,\\ 0.10,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n4. $(\\omega_q,\\omega_f,\\zeta_f,k_w) = (90,\\ 200,\\ 0.02,\\ 0.1)$，其中 $\\omega_q$ 和 $\\omega_f$ 的单位为弧度/秒。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含鲁棒性结果，形式为用方括号括起来的、以逗号分隔的布尔值列表（例如，$[result_1,result_2,result_3,result_4]$）。如果对于第$i$个测试用例，您推导的条件保证了鲁棒稳定性，则 $result_i$ 为 $True$，否则为 $False$。",
            "solution": "根据指定的验证程序对问题陈述进行严格评估。\n\n### 第1步：提取已知条件\n- 对象输入输出关系：$Y(s) = P(s) U(s) + D(s)$，其中$Y(s)$是输出，$P(s)$是真实对象，$U(s)$是指令输入，$D(s)$是外部扰动。\n- 标称对象模型：$P_n(s)$。\n- 扰动观测器滤波器：$Q(s)$，一个稳定的、严格正常的低通滤波器。\n- 标称对象逆模型：$P_n^{-1}(s)$。\n- 乘性不确定性模型：$P(s) = P_n(s) \\left( 1 + W_m(s) \\Delta(s) \\right)$。\n- 不确定性权重函数：$W_m(s)$。\n- 扰动块：$\\Delta(s)$，任何满足 $\\left\\| \\Delta(j\\omega) \\right\\|_\\infty \\leq 1$ 的稳定系统。\n- 频率单位：弧度/秒。\n- $Q$滤波器参数化：$Q(s) = \\dfrac{\\omega_q}{s + \\omega_q}$，带宽 $\\omega_q > 0$。\n- 不确定性权重参数化：$W_m(s) = k_w \\dfrac{\\omega_f^2}{s^2 + 2 \\zeta_f \\omega_f s + \\omega_f^2}$，柔性模态频率 $\\omega_f > 0$，阻尼比 $\\zeta_f \\in (0, 1)$，不确定性尺度因子 $k_w > 0$。\n- 数值评估范围：$\\omega \\in [10^{-1}, 10^{4}]$ 弧度/秒。\n- 测试用例：\n  1. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (30, 200, 0.02, 0.1)$\n  2. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (400, 200, 0.02, 0.1)$\n  3. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (400, 200, 0.10, 0.1)$\n  4. $(\\omega_q, \\omega_f, \\zeta_f, k_w) = (90, 200, 0.02, 0.1)$\n\n### 第2步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题牢固地植根于现代控制理论的原理，特别是鲁棒控制和观测器设计。扰动观测器（DOB）、乘性不确定性建模、小增益定理和频域分析等概念在该学科中都是经典内容。该设定在科学和数学上是合理的。\n- **适定性：** 该问题是适定的。它要求在给定特定参数化的情况下，推导标准的鲁棒稳定性条件并进行数值评估。所要求的输出由所提供的数据和既定理论唯一确定。\n- **客观性：** 问题陈述以精确、正式和客观的语言编写，没有歧义或主观论断。\n- **完整性和一致性：** 该问题提供了推导条件和执行数值计算所需的所有定义、模型和参数。内部没有矛盾。\n- **现实性：** 滤波器和不确定性权重的模型，特别是弱阻尼柔性模态的表示，在控制机械系统的背景下是标准且现实的，这是信息物理系统和数字孪生的常见应用。\n\n### 第3步：结论与行动\n该问题有效。下面提供完整的解决方案。\n\n### 基于原理的设计与推导\n\n主要目标是为由对象和扰动观测器（DOB）构成的闭环系统推导一个内部稳定性条件。我们首先将所描述的DOB结构形式化。一个标准的DOB估计一个集总扰动，并将一个补偿信号注入到控制输入中。该估计是通过比较对象输出与标称模型的输出来形成的。\n\n设 $U_r(s)$ 为外部参考指令。对象的实际输入 $U(s)$ 是该参考指令与一个抵消信号 $U_{comp}(s)$ 的和。所描述的DOB公式意味着抵消信号是输入端的扰动估计。我们如下构造该估计。\n\n一个中间信号，我们可称之为“测量扰动”$d_m(s)$，是通过对象输入$U(s)$与在对象为标称模型时产生输出$Y(s)$所需的输入（即$P_n^{-1}(s)Y(s)$）之间的差值形成的。\n$$d_m(s) = P_n^{-1}(s)Y(s) - U(s)$$\n该信号随后通过低通滤波器$Q(s)$生成估计的扰动，该扰动作为补偿信号：\n$$U_{comp}(s) = -Q(s)d_m(s)$$\n负号表示该信号从参考指令中减去。因此，对象的总输入为：\n$$U(s) = U_r(s) + U_{comp}(s) = U_r(s) - Q(s)d_m(s)$$\n代入$d_m(s)$的表达式：\n$$U(s) = U_r(s) - Q(s) \\left( P_n^{-1}(s)Y(s) - U(s) \\right)$$\n为了分析DOB内环的稳定性，我们必须理解它如何与模型不确定性相互作用。我们将对象和不确定性模型，$Y(s) = P(s)U(s) + D(s)$ 和 $P(s) = P_n(s)(1+W_m(s)\\Delta(s))$，代入$U(s)$的方程中。\n$$U(s) = U_r(s) - Q(s) \\left( P_n^{-1}(s)\\left[ P_n(s)(1+W_m(s)\\Delta(s))U(s) + D(s) \\right] - U(s) \\right)$$\n简化括号内的项：\n$$P_n^{-1}(s)P_n(s)(1+W_m(s)\\Delta(s))U(s) - U(s) = (1+W_m(s)\\Delta(s))U(s) - U(s) = W_m(s)\\Delta(s)U(s)$$\n因此，$U(s)$的方程变为：\n$$U(s) = U_r(s) - Q(s) \\left( W_m(s)\\Delta(s)U(s) + P_n^{-1}(s)D(s) \\right)$$\n为了分析内部稳定性，我们考虑齐次系统，将所有外部输入设置为零，即$U_r(s) = 0$和$D(s) = 0$。\n$$U(s) = -Q(s)W_m(s)\\Delta(s)U(s)$$\n这个方程揭示了决定内部稳定性的反馈结构。我们可以将其重新整理为：\n$$U(s) + Q(s)W_m(s)\\Delta(s)U(s) = 0$$\n$$\\left[ 1 + Q(s)W_m(s)\\Delta(s) \\right] U(s) = 0$$\n对于一个非平凡解$U(s) \\neq 0$，该环路的特征方程为 $1 + Q(s)W_m(s)\\Delta(s) = 0$。当且仅当对于所有容许的扰动$\\Delta(s)$，此方程在复平面的闭右半平面没有根时，系统是内部稳定的。\n\n反馈互联现在是明确的。我们可以将系统建模为一个负反馈环路，其中前向路径是$\\Delta(s)$，反馈路径是$M(s) = Q(s)W_m(s)$。对于这类具有一系列不确定但稳定的模块$\\Delta(s)$的连接，其稳定性由小增益定理保证。\n\n小增益定理指出，两个稳定系统$M$和$\\Delta$的反馈互联是稳定的，如果它们增益的乘积小于1。增益定义为$H_\\infty$范数，即 $\\|G\\|_\\infty = \\sup_{\\omega} |G(j\\omega)|$。\n鲁棒稳定性的条件是：\n$$\\| M(s) \\|_\\infty \\cdot \\| \\Delta(s) \\|_\\infty < 1$$\n我们已知$\\Delta(s)$是任何满足 $\\| \\Delta(s) \\|_\\infty \\leq 1$ 的稳定传递函数。为了保证在最坏情况下的$\\Delta(s)$（其范数为1）的稳定性，我们必须对我们的标称系统施加以下严格条件：\n$$\\| M(s) \\|_\\infty < 1$$\n代入$M(s) = Q(s)W_m(s)$，鲁棒内部稳定性的严格条件是：\n$$\\| Q(s)W_m(s) \\|_\\infty < 1$$\n这等价于：\n$$\\sup_{\\omega \\ge 0} \\left| Q(j\\omega)W_m(j\\omega) \\right| < 1$$\n\n现在，我们将分析$Q(s)$滤波器的带宽$\\omega_q$如何影响鲁棒性，并构建一个反例。不确定性权重$W_m(s)$代表一个弱阻尼的柔性模态。其幅值响应 $|W_m(j\\omega)| = \\left| k_w \\frac{\\omega_f^2}{-\\omega^2 + 2j\\zeta_f \\omega_f \\omega + \\omega_f^2} \\right|$，在自然频率$\\omega \\approx \\omega_f$处表现出一个尖锐的谐振峰。其峰值幅值近似为 $|W_m(j\\omega_f)| \\approx \\frac{k_w}{2\\zeta_f}$。对于小阻尼$\\zeta_f$，这个峰值可能远大于1。\n\n滤波器$Q(s)$的幅值响应 $|Q(j\\omega)| = \\frac{\\omega_q}{\\sqrt{\\omega^2 + \\omega_q^2}}$，这是一阶低通滤波器的典型特征。对于频率$\\omega \\ll \\omega_q$，其增益近似为1；对于频率$\\omega \\gg \\omega_q$，其增益衰减。\n\n鲁棒稳定性条件 $\\sup_{\\omega} |Q(j\\omega)W_m(j\\omega)| < 1$ 必须对所有频率都成立。最具挑战性的频率在$W_m(s)$的谐振峰附近，即$\\omega \\approx \\omega_f$。在此频率下，我们必须满足 $|Q(j\\omega_f)||W_m(j\\omega_f)| < 1$。由于$|W_m(j\\omega_f)|$很大，这要求$|Q(j\\omega_f)|$必须足够小。为了使$|Q(j\\omega_f)| = \\frac{\\omega_q}{\\sqrt{\\omega_f^2 + \\omega_q^2}}$很小，滤波器带宽$\\omega_q$必须选择得远小于柔性模态频率$\\omega_f$。\n\n这说明了DOB设计中的一个基本权衡。高带宽滤波器（大的$\\omega_q$）对于抑制宽范围的扰动是理想的。然而，过于激进（高）的带宽将DOB的作用扩展到高频区域，而在这些区域模型是不准确的，这由$W_m(s)$的大幅值所体现。这可能导致DOB放大测量噪声，更严重的是，通过正反馈到未建模动态中而使系统失稳。\n\n通过比较两种情况来构建一个反例。\n1. 一个保守的设计，其中 $\\omega_q \\ll \\omega_f$（例如，测试用例1，$\\omega_q=30$, $\\omega_f=200$）。在这里，当$\\omega_f=200$时，$Q$滤波器会大幅衰减信号，从而确保 $|Q(j\\omega_f)W_m(j\\omega_f)| < 1$。\n2. 一个激进的设计，其中 $\\omega_q \\ge \\omega_f$（例如，测试用例2，$\\omega_q=400$, $\\omega_f=200$）。在这里，当$\\omega_f=200$时，$Q$滤波器的增益接近1。乘积 $|Q(j\\omega_f)W_m(j\\omega_f)|$ 将近似为 $|W_m(j\\omega_f)| \\approx \\frac{k_w}{2\\zeta_f}$，这很容易超过1，从而违反稳定性条件。\n\n数值实现将为每个参数集评估 $\\sup_{\\omega \\in [10^{-1}, 10^{4}]} |Q(j\\omega)W_m(j\\omega)|$，如果该上确界小于1，则返回`True`，否则返回`False`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically validates the robust stability condition for a\n    Disturbance Observer (DOB) in the presence of multiplicative uncertainty.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (omega_q, omega_f, zeta_f, k_w)\n    test_cases = [\n        (30.0, 200.0, 0.02, 0.1),\n        (400.0, 200.0, 0.02, 0.1),\n        (400.0, 200.0, 0.10, 0.1),\n        (90.0, 200.0, 0.02, 0.1),\n    ]\n\n    results = []\n\n    # Define the frequency range for numerical evaluation of the H-infinity norm.\n    # A logarithmic space is used to cover the wide range efficiently.\n    # 20000 points ensure an accurate capture of the resonant peak.\n    omega = np.logspace(-1, 4, 20000) # Frequencies in rad/s\n\n    for case in test_cases:\n        omega_q, omega_f, zeta_f, k_w = case\n\n        # The complex frequency variable s = j*omega\n        s = 1j * omega\n\n        # Calculate the frequency response of the Q(s) filter.\n        # Q(s) = omega_q / (s + omega_q)\n        q_s_freq_response = omega_q / (s + omega_q)\n\n        # Calculate the frequency response of the uncertainty weighting W_m(s).\n        # W_m(s) = k_w * omega_f^2 / (s^2 + 2*zeta_f*omega_f*s + omega_f^2)\n        wm_s_freq_response = (k_w * omega_f**2) / (s**2 + 2 * zeta_f * omega_f * s + omega_f**2)\n\n        # The transfer function from the uncertainty output to its input is M(s) = Q(s) * W_m(s).\n        m_s_freq_response = q_s_freq_response * wm_s_freq_response\n\n        # According to the small-gain theorem, for robust stability, the H_infinity norm\n        # of M(s) must be less than 1. The H_infinity norm is the supremum of the\n        # magnitude of the frequency response.\n        h_inf_norm_approx = np.max(np.abs(m_s_freq_response))\n\n        # Check the robust stability condition. The strict inequality  1 is used.\n        is_robustly_stable = h_inf_norm_approx  1.0\n        results.append(is_robustly_stable)\n\n    # Final print statement in the exact required format.\n    # The output is a list of booleans indicating robust stability for each case.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将连续时间理论转化为数字孪生或赛博物理系统中的离散实现是工程设计的最后一步，但这一步同样充满挑战。此练习将引导您使用双线性变换法，将连续$Q$滤波器离散化，并量化该过程对系统稳定裕度的影响。通过计算离散化引入的相位滞后及其对相角裕度的侵蚀，您将掌握评估和补偿数字实现中性能退化的关键技能。",
            "id": "4218811",
            "problem": "扰动观测器通常在数字孪生和赛博物理系统中通过嵌入一个低通滤波器来实现，该滤波器常被称为 $Q$ 滤波器，用于对被控对象求逆进行正则化并衰减高频噪声。其目标是构建一个可实现的离散时间 $Q$ 滤波器 $Q(z)$，该滤波器近似一个截止频率为 $ \\omega_c $ 的一阶连续时间低通滤波器，并量化当它在设计穿越频率处与标称开环系统相乘时，其对相位滞后和稳定裕度的影响。从以下基本原理出发：线性时不变系统、因果性与有界输入有界输出（BIBO）稳定性、通过在单位圆 $z = e^{j\\Omega}$ 上求值定义的频率响应，以及将连续时间 $s$ 域映射到采样周期为 $T_s$ 的离散时间 $z$ 域的双线性变换（也称为Tustin方法）。\n\n您必须实现以下内容：\n\n- 从期望的连续时间传递函数 $Q_c(s) = \\frac{\\omega_c}{s + \\omega_c}$ 出发，推导一个可实现且因果的离散时间滤波器 $Q(z)$。使用采样周期为 $T_s$ 的双线性变换将 $s$ 映射到 $z$。将 $Q(z)$ 表示为规范有理形式 $Q(z) = \\frac{b_0 + b_1 z^{-1}}{1 - a_1 z^{-1}}$，并用 $ \\omega_c $ 和 $ T_s $ 表示 $b_0$、$b_1$ 和 $a_1$。不要不经推导直接给出简化结果；从第一性原理构建滤波器。\n\n- 考虑一个标称一阶被控对象 $P_c(s) = \\frac{1}{s + a}$，其中 $a  0$。使用相同的双线性变换将其离散化，得到 $P(z)$，确保其可实现性和稳定性。\n\n- 通过双线性映射，使用与连续截止频率 $ \\omega_c $ 对应的离散时间频率。具体来说，计算离散频率 $ \\Omega_c = 2 \\arctan\\left(\\frac{\\omega_c T_s}{2}\\right) $（单位：弧度/采样点），并计算 $Q(e^{j\\Omega_c})$ 和 $P(e^{j\\Omega_c})$ 的值。\n\n- 选择一个比例控制器增益 $k$，使得在 $ \\Omega_c $ 处的标称开环幅值为 $1$。即，通过 $|k P(e^{j\\Omega_c})| = 1$ 来设定 $k$。\n\n- 量化 $Q$ 滤波器在 $ \\Omega_c $ 处引入的相位滞后，其值为 $-\\arg\\left(Q(e^{j\\Omega_c})\\right)$，以弧度表示的浮点数形式给出。\n\n- 计算标称开环系统 $L_0(z) = k P(z)$ 在 $ \\Omega_c $ 处的原始相位裕度 $\\mathrm{PM}_0$，公式为 $ \\mathrm{PM}_0 = \\pi + \\arg\\left(L_0(e^{j\\Omega_c})\\right) $，以弧度表示的浮点数形式给出。然后，计算乘性引入 $Q$ 滤波器后的新相位裕度，其中 $L(z) = L_0(z) Q(z)$，公式为 $ \\mathrm{PM} = \\pi + \\arg\\left(L(e^{j\\Omega_c})\\right) $，以弧度表示的浮点数形式给出。\n\n- 报告一个稳定性的布尔值，如果 $ \\mathrm{PM}  0 $ 则为真，否则为假。将 $ \\mathrm{PM}  0 $ 解释为在穿越频率处具有正的相位裕度，这是线性时不变单输入单输出系统设计中鲁棒性的一个标准充分条件。\n\n单位和输出要求：\n\n- 使用 $ \\omega_c $ 的单位为弧度/秒，$ T_s $ 的单位为秒，$ a $ 的单位为弧度/秒，离散时间频率 $ \\Omega_c $ 的单位为弧度/采样点，角度单位为弧度。以十进制浮点数形式输出角度（除默认浮点数行为外无舍入要求）。\n\n- 您的程序必须严格按照规定实现构建和评估过程，无外部输入。\n\n- 测试套件参数如下，构成四个不同案例：\n    1. $ T_s = 0.01 $，$ \\omega_c = 10 $，$ a = 5 $。\n    2. $ T_s = 0.01 $，$ \\omega_c = 200 $，$ a = 5 $。\n    3. $ T_s = 0.05 $，$ \\omega_c = 1 $，$ a = 5 $。\n    4. $ T_s = 0.2 $，$ \\omega_c = 8 $，$ a = 50 $。\n\n- 对于每个测试案例，生成一个形式为 $[\\text{phase\\_lag}, \\text{new\\_phase\\_margin}, \\text{stable}]$ 的结果，其中 $ \\text{phase\\_lag} $ 和 $ \\text{new\\_phase\\_margin} $ 是以弧度为单位的浮点数，而 $ \\text{stable} $ 是一个布尔值。\n\n- 最终输出格式：您的程序应生成单行输出，包含一个由逗号分隔的列表，列表被方括号括起，每个测试案例对应一个列表，例如 $[[r_1],[r_2],[r_3],[r_4]]$，其中每个 $[r_i]$ 都遵循指定的结果格式。",
            "solution": "该问题要求推导和分析一个离散时间扰动观测器 $Q$ 滤波器，其对闭环系统稳定裕度的影响，以及针对特定参数集的计算实现。解决方案遵循数字控制理论的第一性原理进行。\n\n### 第1步：离散时间 $Q$ 滤波器的推导\n\n我们从指定的一阶连续时间低通滤波器开始：\n$$\nQ_c(s) = \\frac{\\omega_c}{s + \\omega_c}\n$$\n其中 $\\omega_c$ 是截止频率，单位为弧度/秒。\n\n为了获得一个可实现且因果的离散时间滤波器 $Q(z)$，我们采用采样周期为 $T_s$ 的双线性变换。该变换将连续时间拉普拉斯变量 $s$ 映射到离散时间 $z$ 域变量 $z$，如下所示：\n$$\ns = \\frac{2}{T_s} \\frac{z-1}{z+1}\n$$\n将此代入 $Q_c(s)$ 得到 $Q(z)$：\n$$\nQ(z) = \\left. Q_c(s) \\right|_{s = \\frac{2}{T_s} \\frac{z-1}{z+1}} = \\frac{\\omega_c}{\\left(\\frac{2}{T_s} \\frac{z-1}{z+1}\\right) + \\omega_c}\n$$\n为简化此表达式，我们将分子和分母同乘以 $T_s(z+1)$：\n$$\nQ(z) = \\frac{\\omega_c T_s (z+1)}{2(z-1) + \\omega_c T_s (z+1)}\n$$\n展开分母得到：\n$$\nQ(z) = \\frac{\\omega_c T_s z + \\omega_c T_s}{2z - 2 + \\omega_c T_s z + \\omega_c T_s}\n$$\n我们按 $z$ 的幂次对分母中的项进行分组：\n$$\nQ(z) = \\frac{\\omega_c T_s (z+1)}{(2 + \\omega_c T_s)z - (2 - \\omega_c T_s)}\n$$\n为了将其表示为包含 $z$ 的负幂次的规范形式，我们将分子和分母同除以 $z \\cdot (2 + \\omega_c T_s)$：\n$$\nQ(z) = \\frac{\\frac{\\omega_c T_s (1+z^{-1})}{2 + \\omega_c T_s}}{1 - \\frac{2 - \\omega_c T_s}{2 + \\omega_c T_s} z^{-1}}\n$$\n这与所要求的形式 $Q(z) = \\frac{b_0 + b_1 z^{-1}}{1 - a_1 z^{-1}}$ 相匹配，其中系数为：\n$$\nb_0 = \\frac{\\omega_c T_s}{2 + \\omega_c T_s}\n$$\n$$\nb_1 = \\frac{\\omega_c T_s}{2 + \\omega_c T_s}\n$$\n$$\na_1 = \\frac{2 - \\omega_c T_s}{2 + \\omega_c T_s}\n$$\n为使滤波器 BIBO 稳定，其极点 $z=a_1$ 必须位于单位圆内，即 $|a_1|  1$。鉴于 $\\omega_c  0$ 且 $T_s  0$，分母 $2 + \\omega_c T_s$ 始终为正。分子为 $2 - \\omega_c T_s$。其幅值为 $|a_1| = \\left|\\frac{2 - \\omega_c T_s}{2 + \\omega_c T_s}\\right|$。由于 $2 + \\omega_c T_s  |2 - \\omega_c T_s|$，条件 $|a_1|1$ 总是满足的，从而确保了稳定性。\n\n### 第2步：被控对象的离散化\n\n连续时间被控对象由下式给出：\n$$\nP_c(s) = \\frac{1}{s + a}, \\quad a  0\n$$\n应用相同的双线性变换得到离散时间被控对象 $P(z)$：\n$$\nP(z) = \\frac{1}{\\left(\\frac{2}{T_s} \\frac{z-1}{z+1}\\right) + a}\n$$\n将分子和分母同乘以 $T_s(z+1)$：\n$$\nP(z) = \\frac{T_s (z+1)}{2(z-1) + a T_s (z+1)} = \\frac{T_s(z+1)}{(2+aT_s)z - (2-aT_s)}\n$$\n将分子和分母同除以 $z \\cdot (2+aT_s)$ 以获得用 $z^{-1}$ 表示的形式：\n$$\nP(z) = \\frac{\\frac{T_s}{2+aT_s}(1+z^{-1})}{1 - \\frac{2-aT_s}{2+aT_s}z^{-1}}\n$$\n由于 $a0$ 且 $T_s0$，根据应用于 $Q$ 滤波器的相同推理，该被控对象也是 BIBO 稳定的。\n\n### 第3步：频率响应分析\n\n双线性变换将 $s$ 平面的虚轴 $s=j\\omega$ 映射到 $z$ 平面的单位圆 $z=e^{j\\Omega}$，其中 $\\omega$ 是连续时间频率，$\\Omega$ 是离散时间频率。它们之间的关系是 $\\omega = \\frac{2}{T_s} \\tan(\\frac{\\Omega}{2})$。这被称为频率畸变。\n\n问题指定了在离散频率 $\\Omega_c$ 处对系统进行评估，该频率通过此映射对应于连续截止频率 $\\omega_c$：\n$$\n\\Omega_c = 2 \\arctan\\left(\\frac{\\omega_c T_s}{2}\\right)\n$$\n选择此 $\\Omega_c$ 意味着 $\\tan(\\frac{\\Omega_c}{2}) = \\frac{\\omega_c T_s}{2}$，因此 $\\omega_c = \\frac{2}{T_s} \\tan(\\frac{\\Omega_c}{2})$。\n\n当我们在 $z = e^{j\\Omega}$ 处评估经过双线性变换的系统 $H(z)$ 的频率响应时，这等同于在 $s = j \\frac{2}{T_s} \\tan(\\frac{\\Omega}{2})$ 处评估原始连续时间系统 $H_c(s)$。\n因此，在 $z=e^{j\\Omega_c}$ 处评估 $Q(z)$ 等同于在 $s=j\\omega_c$ 处评估 $Q_c(s)$：\n$$\nQ(e^{j\\Omega_c}) = Q_c(j\\omega_c) = \\frac{\\omega_c}{j\\omega_c + \\omega_c} = \\frac{1}{1+j} = \\frac{1-j}{2}\n$$\n$Q(e^{j\\Omega_c})$ 的辐角（相位）是 $\\arg(\\frac{1}{2} - j\\frac{1}{2}) = \\arctan\\left(\\frac{-1/2}{1/2}\\right) = \\arctan(-1) = -\\frac{\\pi}{4}$ 弧度。\n所要求的相位滞后是 $-\\arg(Q(e^{j\\Omega_c})) = -(-\\frac{\\pi}{4}) = \\frac{\\pi}{4}$ 弧度。\n\n同样地，在 $z=e^{j\\Omega_c}$ 处评估被控对象 $P(z)$ 等同于在 $s=j\\omega_c$ 处评估 $P_c(s)$：\n$$\nP(e^{j\\Omega_c}) = P_c(j\\omega_c) = \\frac{1}{j\\omega_c + a}\n$$\n\n### 第4步：控制器增益和相位裕度计算\n\n比例控制器增益 $k$ 的设置使得在 $\\Omega_c$ 处的标称开环幅值为单位1：$|k P(e^{j\\Omega_c})| = 1$。由于 $k$ 是一个正实数增益：\n$$\nk = \\frac{1}{|P(e^{j\\Omega_c})|} = \\frac{1}{|P_c(j\\omega_c)|} = \\left|\\frac{1}{a + j\\omega_c}\\right|^{-1} = |a + j\\omega_c| = \\sqrt{a^2 + \\omega_c^2}\n$$\n标称开环传递函数是 $L_0(z) = k P(z)$。相位裕度通常在增益穿越频率处评估，根据我们对 $k$ 的选择，该频率恰好是 $\\Omega_c$。原始相位裕度 $\\mathrm{PM}_0$ 为：\n$$\n\\mathrm{PM}_0 = \\pi + \\arg(L_0(e^{j\\Omega_c})) = \\pi + \\arg(k P(e^{j\\Omega_c}))\n$$\n由于 $k0$，$\\arg(k)=0$，所以 $\\mathrm{PM}_0 = \\pi + \\arg(P(e^{j\\Omega_c})) = \\pi + \\arg\\left(\\frac{1}{a+j\\omega_c}\\right) = \\pi - \\arg(a+j\\omega_c) = \\pi - \\arctan(\\frac{\\omega_c}{a})$。\n\n包含 $Q$ 滤波器的新开环传递函数是 $L(z) = L_0(z) Q(z) = k P(z) Q(z)$。问题定义了在相同频率 $\\Omega_c$ 下评估的新相位裕度 $\\mathrm{PM}$：\n$$\n\\mathrm{PM} = \\pi + \\arg(L(e^{j\\Omega_c})) = \\pi + \\arg(k P(e^{j\\Omega_c}) Q(e^{j\\Omega_c}))\n$$\n利用乘积的辐角是各辐角之和的性质：\n$$\n\\mathrm{PM} = \\pi + \\arg(k) + \\arg(P(e^{j\\Omega_c})) + \\arg(Q(e^{j\\Omega_c}))\n$$\n代入已知值：\n$$\n\\mathrm{PM} = \\pi + 0 + \\left(-\\arctan\\left(\\frac{\\omega_c}{a}\\right)\\right) + \\left(-\\frac{\\pi}{4}\\right)\n$$\n$$\n\\mathrm{PM} = \\frac{3\\pi}{4} - \\arctan\\left(\\frac{\\omega_c}{a}\\right)\n$$\n这个结果也可以看作是原始相位裕度减去Q滤波器的相位滞后：$\\mathrm{PM} = \\mathrm{PM}_0 - \\frac{\\pi}{4}$。\n\n### 第5步：稳定性条件\n\n如果新的相位裕度为正，即 $\\mathrm{PM}  0$，则系统被认为是稳定的。\n$$\n\\frac{3\\pi}{4} - \\arctan\\left(\\frac{\\omega_c}{a}\\right)  0\n$$\n由于 $\\omega_c  0$ 且 $a  0$，$\\arctan(\\frac{\\omega_c}{a})$ 的值在 $(0, \\frac{\\pi}{2})$ 范围内。$\\frac{3\\pi}{4}$ 的值大于 $\\frac{\\pi}{2}$，因此对于所有有效输入，此条件都将成立。如果 $\\mathrm{PM}  0$，布尔值 `stable` 将为真。\n\n每个测试案例需要计算的最终量为：\n1.  相位滞后：$\\phi_{\\text{lag}} = \\frac{\\pi}{4}$\n2.  新相位裕度：$\\mathrm{PM} = \\frac{3\\pi}{4} - \\arctan\\left(\\frac{\\omega_c}{a}\\right)$\n3.  稳定性：$\\mathrm{PM}  0$ 的布尔结果",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the phase lag, new phase margin, and stability for a control system\n    with a Q-filter for several test cases.\n    \"\"\"\n    # Test suite parameters are as follows, forming four distinct cases:\n    # (Ts, omega_c, a)\n    test_cases = [\n        (0.01, 10.0, 5.0),\n        (0.01, 200.0, 5.0),\n        (0.05, 1.0, 5.0),\n        (0.2, 8.0, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Ts, omega_c, a = case\n\n        # 1. Quantify the phase lag introduced by the Q-filter.\n        # As derived, at the critical frequency corresponding to omega_c, the\n        # frequency response of the bilinearly transformed Q-filter is 1/(1+j).\n        # The phase is arg(1/(1+j)) = -pi/4.\n        # Phase lag is defined as -arg(Q(z)), so it is pi/4.\n        phase_lag = np.pi / 4.0\n\n        # 2. Compute the new phase margin with the Q-filter.\n        # The derivation yields PM = 3*pi/4 - arctan(omega_c / a).\n        new_phase_margin = (3.0 * np.pi / 4.0) - np.arctan(omega_c / a)\n\n        # 3. Report a stability boolean.\n        # The system is considered stable if the phase margin is positive.\n        stable = new_phase_margin  0.0\n\n        # Assemble the results for this case.\n        # The output format is [phase_lag, new_phase_margin, stable].\n        case_result = [phase_lag, new_phase_margin, stable]\n        results.append(case_result)\n\n    # Format the final output string as a list of lists.\n    # e.g., [[val1, val2, val3],[val4, val5, val6]]\n    output_str_parts = []\n    for res in results:\n        # Convert each item in the sublist to its string representation.\n        # The boolean needs to be lowercase 'true' or 'false'.\n        str_res = [f\"{res[0]}\", f\"{res[1]}\", str(res[2]).lower()]\n        output_str_parts.append(f\"[{','.join(str_res)}]\")\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}