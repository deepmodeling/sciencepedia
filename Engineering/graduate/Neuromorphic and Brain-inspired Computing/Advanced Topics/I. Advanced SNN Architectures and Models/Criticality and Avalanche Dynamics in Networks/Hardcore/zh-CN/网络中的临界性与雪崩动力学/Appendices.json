{
    "hands_on_practices": [
        {
            "introduction": "理论的基石是简洁而强大的模型。盖尔顿-沃森分支过程（Galton-Watson branching process）为理解雪崩动力学提供了一个核心数学框架。这项练习将通过推导在亚临界状态（subcritical regime）下预期的雪崩规模，来帮助你建立关于分支比 $\\sigma$ 如何控制系统行为的直观理解，并揭示为何 $\\sigma=1$ 成为一个特殊的临界点 。",
            "id": "4041825",
            "problem": "将神经雪崩看作一个由单个活跃神经元在大型稀疏网络中引发的级联过程。将此级联过程建模为一个 Galton–Watson 分支过程，其中每个活跃神经元在下一个时间步独立地激活随机数量的下游神经元。假设子代数量服从均值为分支比 $\\sigma$ 的泊松分布，即每个活跃神经元引起的下游激活数 $K$ 满足 $K \\sim \\text{Poisson}(\\sigma)$，并且在神经元之间和时间步之间是独立的。设雪崩规模 $S$ 定义为级联中激活的神经元总数，包括初始神经元。仅使用 Galton–Watson 过程的基本性质，即子分支的独立性和期望的线性性，推导在亚临界状态 $\\sigma \\in (0,1)$ 下，期望雪崩规模 $\\mathbb{E}[S]$ 作为 $\\sigma$ 函数的精确闭式表达式。然后，计算当 $\\sigma = 0.95$ 时的期望规模，并从数学上解释当 $\\sigma \\to 1^{-}$ 时 $\\mathbb{E}[S]$ 如何发散。将 $\\sigma = 0.95$ 的数值计算结果用四位有效数字的科学记数法表示，并提供最终数值答案，不带单位。",
            "solution": "用户需要一个关于神经雪崩问题的解答。我将首先验证问题陈述。\n\n### 步骤 1：提取给定信息\n-   **模型**：神经雪崩作为 Galton–Watson 分支过程。\n-   **起始**：级联由单个活跃神经元开始。\n-   **网络**：大型、稀疏。\n-   **子代分布**：每个活跃神经元的下游激活数 $K$ 服从均值为分支比 $\\sigma$ 的泊松分布，即 $K \\sim \\text{Poisson}(\\sigma)$。\n-   **独立性**：子代数量在神经元之间和时间步之间是独立的。\n-   **定义**：雪崩规模 $S$ 是级联中激活的神经元总数，包括初始神经元。\n-   **约束**：仅使用基本性质：子分支的独立性和期望的线性性。\n-   **状态**：亚临界，$\\sigma \\in (0,1)$。\n-   **任务**：\n    1.  推导期望雪崩规模 $\\mathbb{E}[S]$ 作为 $\\sigma$ 函数的精确闭式表达式。\n    2.  计算 $\\sigma = 0.95$ 时的 $\\mathbb{E}[S]$。\n    3.  从数学上解释当 $\\sigma \\to 1^{-}$ 时 $\\mathbb{E}[S]$ 如何发散。\n-   **格式要求**：将 $\\sigma = 0.95$ 的数值计算结果用四位有效数字的科学记数法表示。\n\n### 步骤 2：使用提取的给定信息进行验证\n1.  **科学依据**：该问题有充分的科学依据。Galton–Watson 过程是模拟分支现象的标准数学框架，其在神经雪崩中的应用是理论神经科学和复杂性科学的基石。在此背景下，泊松分布是子代分布的一个常见且合适的选择。\n2.  **适定性**：该问题是适定的。它要求的是分支过程理论中的一个标准结果（亚临界过程的 $\\mathbb{E}[S]$），存在唯一且有意义的解。\n3.  **客观性**：语言精确、量化，没有主观或模糊的术语。\n4.  **完整性与一致性**：问题提供了所有必要的信息（模型类型、子代分布、规模定义、参数范围），并且没有内部矛盾。\n5.  **可行性**：条件是此类模型的标准条件，不涉及任何物理或数学上的不可能性。\n6.  **非平凡性**：问题并非不重要；它需要基于递归分解和全期望定律的特定、非显而易见的推理路线才能得出解。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行解答。\n\n问题要求在 Galton-Watson 分支过程中推导期望雪崩规模 $\\mathbb{E}[S]$。该过程始于第 $g=0$ 代的单个初始神经元。设 $S$ 为雪崩的总规模。该初始神经元在下一代激活 $K$ 个神经元，其中 $K$ 是一个随机变量，服从均值为 $\\sigma$ 的泊松分布，即 $K \\sim \\text{Poisson}(\\sigma)$。\n\n总雪崩规模 $S$ 可以表示为初始神经元（1个）与由其 $K$ 个直接子代各自引发的子雪崩规模之和。设 $S_i$ 是由第 $i$ 个子代（$i=1, 2, \\dots, K$）引发的子雪崩的总规模。\n我们可以为随机变量 $S$ 写出一个递归表达式：\n$$S = 1 + \\sum_{i=1}^{K} S_i$$\n如果 $K=0$，则求和为空，其值为 $0$，因此 $S=1$。这是正确的，因为没有子代的雪崩总规模为 $1$（即初始神经元本身）。\n\n根据 Galton-Watson 过程的性质，每个由子代开始的子雪崩都是一个独立的过程，其统计特性与原始过程相同。因此，每个随机变量 $S_i$ 的概率分布与 $S$ 相同，因此具有相同的期望值：$\\mathbb{E}[S_i] = \\mathbb{E}[S]$。\n\n我们想求 $\\mathbb{E}[S]$。我们对 $S$ 的递归方程取期望：\n$$\\mathbb{E}[S] = \\mathbb{E}\\left[1 + \\sum_{i=1}^{K} S_i\\right]$$\n使用期望的线性性，我们得到：\n$$\\mathbb{E}[S] = \\mathbb{E}[1] + \\mathbb{E}\\left[\\sum_{i=1}^{K} S_i\\right] = 1 + \\mathbb{E}\\left[\\sum_{i=1}^{K} S_i\\right]$$\n项 $\\mathbb{E}\\left[\\sum_{i=1}^{K} S_i\\right]$ 是一个随机数量的随机变量之和的期望。为了计算它，我们使用全期望定律（在此情境下也称为 Wald 恒等式），以子代数量 $K$为条件：\n$$\\mathbb{E}\\left[\\sum_{i=1}^{K} S_i\\right] = \\mathbb{E}\\left[\\mathbb{E}\\left[\\sum_{i=1}^{K} S_i \\Bigg| K\\right]\\right]$$\n我们首先计算内部的期望，以 $K=k$（对于某个整数 $k \\ge 0$）为条件：\n$$\\mathbb{E}\\left[\\sum_{i=1}^{k} S_i \\Bigg| K=k\\right]$$\n由于子雪崩的规模 $S_i$ 独立于子代数量 $K$，并且它们是独立同分布的，所以条件期望为：\n$$\\sum_{i=1}^{k} \\mathbb{E}[S_i] = \\sum_{i=1}^{k} \\mathbb{E}[S] = k \\mathbb{E}[S]$$\n因此，我们有 $\\mathbb{E}\\left[\\sum_{i=1}^{K} S_i \\Bigg| K\\right] = K \\mathbb{E}[S]$。现在我们将其代回全期望定律：\n$$\\mathbb{E}\\left[\\sum_{i=1}^{K} S_i\\right] = \\mathbb{E}[K \\mathbb{E}[S]]$$\n由于 $\\mathbb{E}[S]$ 是一个常数（我们试图确定的值），我们可以将其从期望中提出来：\n$$\\mathbb{E}[K \\mathbb{E}[S]] = \\mathbb{E}[S] \\mathbb{E}[K]$$\n问题陈述中指出 $K$ 服从均值为 $\\sigma$ 的泊松分布。因此，$\\mathbb{E}[K] = \\sigma$。\n将此结果代回我们关于 $\\mathbb{E}[S]$ 的主方程：\n$$\\mathbb{E}[S] = 1 + \\sigma \\mathbb{E}[S]$$\n我们现在可以解出 $\\mathbb{E}[S]$。这个推导仅在 $\\mathbb{E}[S]$ 为有限时有效，这在亚临界状态 $\\sigma  1$ 时是成立的。\n$$\\mathbb{E}[S] - \\sigma \\mathbb{E}[S] = 1$$\n$$\\mathbb{E}[S] (1 - \\sigma) = 1$$\n这得到了在亚临界状态 $\\sigma \\in (0,1)$ 下期望雪崩规模的闭式表达式：\n$$\\mathbb{E}[S] = \\frac{1}{1 - \\sigma}$$\n接下来，我们计算当 $\\sigma = 0.95$ 时此表达式的值：\n$$\\mathbb{E}[S] = \\frac{1}{1 - 0.95} = \\frac{1}{0.05} = 20$$\n用四位有效数字的科学记数法表示，这是 $2.000 \\times 10^1$。\n\n最后，我们解释当 $\\sigma \\to 1^{-}$ 时的发散行为。期望规模的表达式为 $\\mathbb{E}[S] = \\frac{1}{1 - \\sigma}$。为了分析当分支比 $\\sigma$ 从下方趋近于临界值 $1$ 时的行为，我们取极限：\n$$\\lim_{\\sigma \\to 1^{-}} \\mathbb{E}[S] = \\lim_{\\sigma \\to 1^{-}} \\frac{1}{1 - \\sigma}$$\n当 $\\sigma$ 从小于 $1$ 的值趋近于 $1$ 时，分母 $(1 - \\sigma)$ 从正方向趋近于 $0$。因此，该分数发散到正无穷大：\n$$\\lim_{\\sigma \\to 1^{-}} \\mathbb{E}[S] = +\\infty$$\n这种数学上的发散标志着一个相变。值 $\\sigma = 1$ 是系统的临界点。对于 $\\sigma  1$（亚临界），雪崩保证会终止，并具有有限的期望规模。在 $\\sigma = 1$（临界）时，雪崩的期望规模变为无穷大。这并不意味着每个雪崩都无限大；而是雪崩规模的概率分布呈现出“重尾”特性（具体来说是幂律分布），使得系统规模的级联能够以足够的概率发生，从而使平均规模发散。这种临界状态是理解复杂系统的关键概念，因为它允许信息在所有尺度上传播。对于 $\\sigma > 1$（超临界），灭绝的概率小于 $1$，雪崩可以指数级增长，导致期望规模为无穷大。",
            "answer": "$$\\boxed{2.000 \\times 10^{1}}$$"
        },
        {
            "introduction": "从理论模型到实验数据分析是至关重要的一步。在分析雪崩的统计特性（如其规模分布）之前，我们必须首先从原始的神经放电记录中精确地识别出这些雪崩事件。这项练习提供了一个机会，让你亲手实现一个基于平均事件间隔（Mean Inter-Event Interval）的标准化雪崩检测算法，这是将原始尖峰栅格数据（spike raster）转化为有意义的雪崩事件序列的关键实践步骤 。",
            "id": "4041876",
            "problem": "考虑一个离散时间脉冲栅格，表示为二进制矩阵 $R \\in \\{0,1\\}^{N \\times T}$，其中 $N$ 是通道数，$T$ 是时间步数。每个条目 $R_{n,t} = 1$ 表示在时间索引 $t$ 时通道 $n$ 上有一个脉冲，而 $R_{n,t} = 0$ 表示没有脉冲。假设基本时间步长为 $\\Delta t = 1$ 任意时间单位。\n\n从神经雪崩分析的基本定义和经过充分检验的观测方法出发，实现以下基于平均事件间间隔 (MEI) 分箱的精确雪崩检测规则：\n\n- 定义事件时间序列 $\\{t_i\\}$，方法是收集所有满足 $R_{n,t} = 1$（对于任何通道 $n$）的时间索引 $t$，并考虑在同一时间索引上不同通道同时发生脉冲的重数。将 $\\{t_i\\}$ 按非递减顺序排序。\n- 定义事件间间隔 $\\Delta_i = t_{i+1} - t_{i}$，适用于序列中存在 $i+1$ 的所有索引 $i$。定义平均事件间间隔 (MEI) 为 $\\bar{\\Delta} = \\frac{1}{M-1} \\sum_{i=1}^{M-1} \\Delta_i$，其中 $M$ 是 $\\{t_i\\}$ 中的事件总数。如果 $M  2$，则按照惯例定义 $\\bar{\\Delta} := 1$。\n- 通过对 $\\bar{\\Delta}$ 进行四舍五入到最近的整数来定义整数箱宽 $w$，即 $w := \\max\\left(1, \\operatorname{round}(\\bar{\\Delta})\\right)$，小数部分为一半时向上取整到下一个整数。\n- 将时间轴划分为宽度为 $w$ 的连续不重叠的箱 $B_k$，从时间索引 $t=0$ 开始，使得 $B_k$ 包含满足 $kw \\le t \\le \\min((k+1)w - 1, T-1)$ 的时间索引 $t$，其中 $k = 0, 1, \\dots, K-1$ 且 $K = \\left\\lceil \\frac{T}{w} \\right\\rceil$。\n- 定义箱活动 $a_k = \\sum_{n=1}^{N} \\sum_{t \\in B_k} R_{n,t}$，如果 $a_k > 0$ 则称 $B_k$ 为“活跃的”，否则为“沉默的”。\n- 定义雪崩为任意两侧由沉默箱界定的最大连续活跃箱序列。将边界 $k = -1$ 和 $k = K$ 视作沉默的。雪崩大小 $s$ 是该序列中所有箱内脉冲的总数，即序列中所有箱的 $a_k$ 之和。\n\n你的任务是实现一个程序，为下方的每个测试用例计算雪崩大小的分布。该分布必须以列表 $[c_1, c_2, \\dots, c_{s_{\\max}}]$ 的形式报告，其中 $c_s$ 是大小为 $s$ 的雪崩的数量，$s_{\\max}$ 是在测试用例中观测到的最大雪崩大小。如果未检测到雪崩，则返回空列表 $[]$。程序必须严格遵守上述检测规则。\n\n测试套件（每个栅格被指定为行的列表，每行是一个包含 $T$ 个条目且值在 $\\{0,1\\}$ 中的列表）：\n\n- 测试用例 1（一般多通道情况）。参数：$N = 3$，$T = 18$。栅格 $R$：\n  - 通道 0: $[0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0]$\n  - 通道 1: $[0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0]$\n  - 通道 2: $[0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0]$\n- 测试用例 2（无脉冲的边界情况）。参数：$N = 2$，$T = 10$。栅格 $R$：\n  - 通道 0: $[0,0,0,0,0,0,0,0,0,0]$\n  - 通道 1: $[0,0,0,0,0,0,0,0,0,0]$\n- 测试用例 3（全时活跃的单通道，最小的 MEI）。参数：$N = 1$，$T = 8$。栅格 $R$：\n  - 通道 0: $[1,1,1,1,1,1,1,1]$\n- 测试用例 4（需要四舍五入的非整数 MEI）。参数：$N = 2$，$T = 12$。栅格 $R$：\n  - 通道 0: $[0,1,0,0,1,0,0,1,0,0,0,0]$\n  - 通道 1: $[0,0,1,0,0,1,0,0,0,1,0,0]$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素对应一个测试用例的分布列表，顺序与上文一致。例如，格式为 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，逗号之间没有空格。最终输出值必须是整数列表，并允许出现空列表。",
            "solution": "问题陈述是一个定义明确且有科学依据的流程，用于在离散脉冲栅格 $R \\in \\{0,1\\}^{N \\times T}$ 中进行神经雪崩检测。该方法论基于计算神经科学中用于研究神经系统临界性的标准观测技术。所有参数和规则都得到了明确无误的规定。因此，该问题是有效的。\n\n雪崩分析的核心原则是识别神经活动中存在因果关联的集群。神经雪崩被概念化为在网络中传播的级联脉冲活动。此处规定的方法使用平均事件间间隔 (MEI) 来定义系统动力学的一个特征时间尺度。这个时间尺度记为 $\\bar{\\Delta}$，表示所有通道上连续脉冲之间的平均时长。通过将时间轴划分为宽度为 $w$（由 $\\bar{\\Delta}$ 导出）的箱，我们可以对脉冲序列进行粗粒化。包含任意数量脉冲的箱被视为“活跃的”，而包含零个脉冲的箱则为“沉默的”。雪崩随即被定义为一个连续的活跃箱序列，在时间上由沉默箱界定。这个操作性定义旨在将时间上聚集的脉冲组合成内聚的事件，这些事件之间由长于特征时间尺度的静默期隔开。雪崩的大小 $s$ 是其包含的脉冲总数，这是其量级的一个主要度量。\n\n解决方案通过为每个测试用例精心实现指定的算法步骤来推进。\n\n**步骤 1：提取事件时间并计算平均事件间间隔 (MEI)**\n\n首先，我们整理出事件时间序列 $\\{t_i\\}$，该序列由栅格 $R$ 中每一个脉冲的时间索引组成。如果在同一时间索引 $t$ 上有多个通道产生脉冲，则该索引 $t$ 会在序列中为每个脉冲出现一次。然后将该序列按非递减顺序排序。令 $M$ 为脉冲总数（即 $\\{t_i\\}$ 的长度）。\n\n事件间间隔为 $\\Delta_i = t_{i+1} - t_i$。MEI $\\bar{\\Delta}$ 是它们的平均值。\n$$ \\bar{\\Delta} = \\frac{1}{M-1} \\sum_{i=1}^{M-1} \\Delta_i = \\frac{1}{M-1} \\sum_{i=1}^{M-1} (t_{i+1} - t_i) $$\n这个和是一个伸缩级数，可以简化为：\n$$ \\bar{\\Delta} = \\frac{t_M - t_1}{M-1} $$\n其中 $t_1$ 和 $t_M$ 分别是排序后序列中第一个和最后一个脉冲的时间。如果 $M  2$，我们采用惯例 $\\bar{\\Delta} := 1$。\n\n**步骤 2：确定箱宽**\n\n整数箱宽 $w$ 是通过将 MEI 四舍五入到最近的整数来确定的，并带有约束 $w \\ge 1$。问题规定，当小数部分为一半时（例如 2.5），向上取整到下一个整数。这对应于操作 $w := \\max\\left(1, \\lfloor \\bar{\\Delta} + 0.5 \\rfloor\\right)$。\n\n**步骤 3：对脉冲数据分箱并计算活动**\n\n总时长 $T$ 被划分为 $K = \\lceil T/w \\rceil$ 个连续的箱。每个箱 $B_k$（其中 $k \\in \\{0, 1, \\dots, K-1\\}$）的活动 $a_k$ 是时间索引 $t$ 满足 $kw \\le t  (k+1)w$ 的脉冲总数。如果 $a_k > 0$，箱是“活跃的”；如果 $a_k = 0$，箱是“沉默的”。\n\n**步骤 4：识别雪崩及其大小**\n\n雪崩是一个最大的连续活跃箱序列。我们通过扫描箱活动 $\\{a_k\\}_{k=0}^{K-1}$ 来识别这些序列。当在一个沉默箱之后（$k=-1$ 处的隐式边界被认为是沉默的）遇到一个活跃箱时，一个新的雪崩开始。只要后续的箱是活跃的，雪崩就继续。当遇到一个沉默箱时，雪崩终止。雪崩的大小 $s$ 是该序列中所有箱的活动 $a_k$ 的总和。\n\n**步骤 5：计算雪崩大小分布**\n\n在识别出所有雪崩并计算其大小后，我们将结果汇编成一个频率分布。对于每个测试用例，我们计算一个列表 $[c_1, c_2, \\dots, c_{s_{\\max}}]$，其中 $c_s$ 是观测到的大小为 $s$ 的雪崩数量，$s_{\\max}$ 是找到的最大雪崩大小。如果没有检测到雪崩，结果为空列表。\n\n现在我们将此流程应用于每个测试用例。\n\n**测试用例 1: $N=3, T=18$**\n- **事件时间:** 脉冲发生在以下时间（含重数）：$[1, 1, 2, 5, 6, 7, 13, 13, 13, 15]$。脉冲总数 $M=10$。\n- **MEI:** $\\bar{\\Delta} = \\frac{t_{10} - t_1}{10-1} = \\frac{15 - 1}{9} = \\frac{14}{9} \\approx 1.556$。\n- **箱宽:** $w = \\max(1, \\lfloor 1.556 + 0.5 \\rfloor) = \\max(1, \\lfloor 2.056 \\rfloor) = 2$。\n- **分箱 ($w=2, T=18, K=9$):**\n  - 每个时间步的总活动：$S_t = [0, 2, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 3, 0, 1, 0, 0]$。\n  - 箱活动 $a_k$：$[2, 1, 1, 2, 0, 0, 3, 1, 0]$。\n- **雪崩:**\n  - 箱 $0-3$ 是活跃的：大小 $s_1 = 2+1+1+2 = 6$。\n  - 箱 $4,5$ 是沉默的。\n  - 箱 $6-7$ 是活跃的：大小 $s_2 = 3+1 = 4$。\n  - 箱 $8$ 是沉默的。\n  - 雪崩大小为 $[6, 4]$。\n- **分布:** $s_{\\max}=6$。有一个大小为 4 的雪崩和一个大小为 6 的雪崩。分布为 $[c_1, \\dots, c_6] = [0, 0, 0, 1, 0, 1]$。\n\n**测试用例 2: $N=2, T=10$**\n- **事件时间:** 没有脉冲。$M=0$。\n- **MEI:** 根据惯例，当 $M2$ 时，$\\bar{\\Delta}=1$。\n- **箱宽:** $w = \\max(1, \\lfloor 1 + 0.5 \\rfloor) = 1$。\n- **分箱 ($w=1$):** 所有箱的活动均为 $0$。\n- **雪崩:** 没有活跃的箱，因此没有雪崩。\n- **分布:** 结果是空列表 $[]$。\n\n**测试用例 3: $N=1, T=8$**\n- **事件时间:** 每个时间步都有脉冲：$[0, 1, 2, 3, 4, 5, 6, 7]$。$M=8$。\n- **MEI:** $\\bar{\\Delta} = \\frac{7 - 0}{8-1} = \\frac{7}{7} = 1$。\n- **箱宽:** $w = \\max(1, \\lfloor 1 + 0.5 \\rfloor) = 1$。\n- **分箱 ($w=1$):** 所有 $8$ 个箱都是活跃的，活动 $a_k=1$。\n- **雪崩:** 一个雪崩贯穿所有箱。其大小为 $s = 8 \\times 1 = 8$。\n- **分布:** $s_{\\max}=8$。一个大小为 8 的雪崩。分布为 $[0, 0, 0, 0, 0, 0, 0, 1]$。\n\n**测试用例 4: $N=2, T=12$**\n- **事件时间:** 脉冲发生在 $[1, 2, 4, 5, 7, 9]$。$M=6$。\n- **MEI:** $\\bar{\\Delta} = \\frac{9 - 1}{6-1} = \\frac{8}{5} = 1.6$。\n- **箱宽:** $w = \\max(1, \\lfloor 1.6 + 0.5 \\rfloor) = \\max(1, \\lfloor 2.1 \\rfloor) = 2$。\n- **分箱 ($w=2, T=12, K=6$):**\n  - 每个时间步的总活动：$S_t = [0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0]$。\n  - 箱活动 $a_k$：$[1, 1, 2, 1, 1, 0]$。\n- **雪崩:** 箱 $0-4$ 是活跃的，后面跟着一个沉默的箱。一个大小为 $s = 1+1+2+1+1 = 6$ 的雪崩。\n- **分布:** $s_{\\max}=6$。一个大小为 6 的雪崩。分布为 $[0, 0, 0, 0, 0, 1]$。",
            "answer": "[[0,0,0,1,0,1],[],[0,0,0,0,0,0,0,1],[0,0,0,0,0,1]]"
        },
        {
            "introduction": "实验观察到的现象并非总是底层真实过程的完美反映，尤其是在神经科学中，子采样（subsampling）是一个普遍存在的挑战。我们记录到的神经活动通常只是网络全部活动的一小部分，这会如何影响我们对雪崩动力学的推断？这项练习通过一个严谨的数学推导，将子采样建模为一个稀疏化过程（thinning process），以揭示它如何系统性地改变观测到的雪崩规模分布，特别是对幂律指数和指数截断的影响 。",
            "id": "4041811",
            "problem": "考虑一个大型、稀疏的循环神经网络，它运行在活动级联（雪崩）发生的机制下。将雪崩定义为连续的脉冲爆发，其始于先前不活跃的网络发出一个脉冲，止于网络恢复不活跃状态。经验上，在许多接近临界状态的类脑系统中，雪崩大小 $S \\in \\{1,2,3,\\dots\\}$ （其中 $S$ 是雪崩中的总脉冲数）的分布，其尾部可以很好地由一个重尾定律来描述，该定律由于有限尺寸和有限时间的约束而带有一个指数截断：对于较大的 $S$，\n$$\nP_{\\mathrm{true}}(S) \\propto S^{-\\tau} \\exp\\!\\left(-\\frac{S}{S_{c}}\\right),\n$$ \n其中 $\\tau > 1$ 是雪崩大小指数，$S_{c} > 0$ 是截断参数。\n\n在实验记录和神经形态测量中，由于只有一部分脉冲被检测到，因此会发生子采样。将子采样建模为独立稀疏化：以潜在的雪崩大小 $S$ 为条件， $S$ 个脉冲中的每一个都以概率 $q \\in (0,1)$ 被独立检测到。观测到的雪崩大小 $s \\in \\{0,1,\\dots,S\\}$ 是那次雪崩中检测到的脉冲总数。假设稀疏化独立地影响脉冲，并且除了通过检测外，不改变雪崩的起始、终止或形状。\n\n仅从上述定义和概率论中广为接受的事实出发，包括独立伯努利试验的性质和中心极限定理（CLT），推导观测大小分布 $P_{\\mathrm{obs}}(s)$ 在大 $s$ 范围内的首项渐近表达式，该表达式要能捕捉到子采样所引起的幂律标度和指数截断。你的最终答案需用 $s$、$\\tau$、$S_{c}$、$q$ 和一个比例常数 $C$ 表示成单个闭合形式的解析表达式，使得对于大的 $S$ 有 $P_{\\mathrm{true}}(S) \\sim C S^{-\\tau} \\exp(-S/S_{c})$。不要假设任何具体的数值。不需要四舍五入，也不涉及物理单位。你的表达式必须在尾部对首项有效，并清楚地显示子采样如何改变观测分布中表现出的指数和截断行为。",
            "solution": "所述问题具有科学依据，提法恰当，客观且内部一致。它提出了一个复杂系统统计物理学中的标准可解问题，具体涉及子采样对临界现象的影响，这是神经形态和类脑计算系统分析中的一个关键课题。所有必需信息均已提供，问题没有说明中列出的使之无效的缺陷。因此，将推导出一个解。\n\n目标是推导观测到的雪崩大小分布 $P_{\\mathrm{obs}}(s)$ 在 $s$ 很大时的渐近形式。观测大小 $s$ 是对真实大小为 $S$ 的雪崩进行子采样过程的结果。通过全概率定律，可以将观测大小的分布与真实大小的分布 $P_{\\mathrm{true}}(S)$ 联系起来。我们对所有可能产生观测大小 $s$ 的真实大小 $S$ 进行边缘化。由于要观测到 $s$ 个脉冲，必须至少发生 $s$ 个真实脉冲，因此对 $S$ 的求和从 $s$ 开始。\n\n$$\nP_{\\mathrm{obs}}(s) = \\sum_{S=s}^{\\infty} P(s|S) P_{\\mathrm{true}}(S)\n$$\n\n被加项中的两个分布是已知的或可以从问题陈述中推导出来：\n1.  $P_{\\mathrm{true}}(S)$ 是真实雪崩大小的分布，对于大的 $S$，其形式为 $P_{\\mathrm{true}}(S) \\sim C S^{-\\tau} \\exp(-S/S_c)$，其中 $C$ 是一个比例常数。由于我们关心的是大 $s$ 时的行为，求和的主要贡献将来自大的 $S$，因此我们可以使用这个渐近形式：\n    $$\n    P_{\\mathrm{true}}(S) \\approx C S^{-\\tau} \\exp\\left(-\\frac{S}{S_{c}}\\right)\n    $$\n2.  $P(s|S)$ 是在给定真实雪崩大小为 $S$ 的条件下观测到 $s$ 个脉冲的条件概率。根据问题描述， $S$ 个脉冲中的每一个都以概率 $q$ 被独立检测到。这是一个经典的 $S$ 次伯努利试验序列，因此观测到的脉冲数 $s$ 服从二项分布：\n    $$\n    P(s|S) = \\binom{S}{s} q^s (1-q)^{S-s}\n    $$\n\n将这些代入 $P_{\\mathrm{obs}}(s)$ 的求和式中：\n$$\nP_{\\mathrm{obs}}(s) \\approx \\sum_{S=s}^{\\infty} \\left[ \\binom{S}{s} q^s (1-q)^{S-s} \\right] \\left[ C S^{-\\tau} \\exp\\left(-\\frac{S}{S_c}\\right) \\right]\n$$\n\n我们需要在大 $s$ 的极限下计算这个和。关键的洞见是分析被加项中两项作为 $S$ 的函数的行为。\n第一项 $P(s|S)$，当固定一个大的 $s$ 并将其视为 $S$ 的函数时，是急剧峰化的。峰值出现在 $\\frac{d}{dS}P(s|S) \\approx 0$ 的地方。使用斯特林公式或双伽玛函数来近似二项式系数中的阶乘，可以表明峰值位于 $S^* \\approx s/q$。中心极限定理（CLT）为这种尖锐性提供了背景：对于大量的试验，二项分布近似于高斯分布，因此高度集中在其均值周围。在这里，分布 $P(s|S)$ 与负二项分布有关，当 $s$ 很大时，它也变得急剧峰化。\n\n第二项 $P_{\\mathrm{true}}(S)$ 是一个带有指数截断的幂律。对于大的 $S$，这个函数比急剧峰化的 $P(s|S)$ 项变化得慢得多，尤其是在峰值 $S^* \\approx s/q$ 附近。\n\n这种尺度分离允许对此类求和（或积分）进行标准近似：我们可以将缓慢变化的函数 $P_{\\mathrm{true}}(S)$ 从求和中提出来，并在急剧变化的函数峰值位置 $S^* = s/q$ 处对其进行求值。\n$$\nP_{\\mathrm{obs}}(s) \\approx C \\left( \\frac{s}{q} \\right)^{-\\tau} \\exp\\left(-\\frac{s/q}{S_c}\\right) \\sum_{S=s}^{\\infty} \\binom{S}{s} q^s (1-q)^{S-s}\n$$\n对于大的 $s$，这个近似在首项上是有效的。现在我们必须计算剩余的和。\n$$\n\\text{Sum} = \\sum_{S=s}^{\\infty} \\binom{S}{s} q^s (1-q)^{S-s} = q^s \\sum_{S=s}^{\\infty} \\binom{S}{s} (1-q)^{S-s}\n$$\n设新的求和指数为 $k = S-s$。当 $S=s$ 时，$k=0$。求和式变为：\n$$\n\\text{Sum} = q^s \\sum_{k=0}^{\\infty} \\binom{s+k}{s} (1-q)^{k} = q^s \\sum_{k=0}^{\\infty} \\binom{s+k}{k} (1-q)^{k}\n$$\n这个求和是一个已知的恒等式，与广义二项式定理有关，特别是对于负指数的情况。回忆 $(1-x)^{-n}$ 的级数展开：\n$$\n(1-x)^{-n} = \\sum_{k=0}^{\\infty} \\binom{n+k-1}{k} x^k\n$$\n在我们的例子中，我们确定 $n = s+1$ 和 $x = 1-q$。\n$$\n\\sum_{k=0}^{\\infty} \\binom{(s+1)+k-1}{k} (1-q)^k = \\sum_{k=0}^{\\infty} \\binom{s+k}{k} (1-q)^k = (1-(1-q))^{-(s+1)} = (q)^{-(s+1)}\n$$\n因此，和的值是：\n$$\n\\text{Sum} = q^s \\cdot q^{-(s+1)} = q^{-1} = \\frac{1}{q}\n$$\n这个结果也可以从负二项分布的角度来理解：对所有可能的总试验次数 $S+1$ 进行求和 $\\sum_{S=s}^{\\infty} \\binom{S}{s} q^{s+1} (1-q)^{S-s}$ 以获得 $s+1$ 次成功，其结果必须为 1。我们的和与之相差一个因子 $q$。\n\n将此结果代回到我们对 $P_{\\mathrm{obs}}(s)$ 的表达式中：\n$$\nP_{\\mathrm{obs}}(s) \\approx \\left[ C \\left( \\frac{s}{q} \\right)^{-\\tau} \\exp\\left(-\\frac{s}{qS_c}\\right) \\right] \\cdot \\frac{1}{q}\n$$\n现在，我们简化表达式：\n$$\nP_{\\mathrm{obs}}(s) \\approx C \\frac{s^{-\\tau}}{q^{-\\tau}} \\exp\\left(-\\frac{s}{qS_c}\\right) \\frac{1}{q}\n$$\n$$\nP_{\\mathrm{obs}}(s) \\approx C q^{\\tau} s^{-\\tau} q^{-1} \\exp\\left(-\\frac{s}{qS_c}\\right)\n$$\n$$\nP_{\\mathrm{obs}}(s) \\approx C q^{\\tau-1} s^{-\\tau} \\exp\\left(-\\frac{s}{qS_c}\\right)\n$$\n这就是观测雪崩大小分布 $P_{\\mathrm{obs}}(s)$ 在大 $s$ 时的首项渐近表达式。它揭示了子采样有两个主要影响：\n1.  幂律指数 $\\tau$ 在子采样下是不变的。观测到的分布仍然按 $s^{-\\tau}$ 标度。\n2.  指数截断被修改。新的有效截断大小是 $s_{c, \\text{obs}} = q S_c$，这意味着截断发生在更小的雪崩大小处，其大小按采样概率 $q$ 进行了缩放。\n分布的整体幅度也通过因子 $q^{\\tau-1}$ 进行了重新缩放。",
            "answer": "$$\n\\boxed{C q^{\\tau-1} s^{-\\tau} \\exp\\left(-\\frac{s}{qS_{c}}\\right)}\n$$"
        }
    ]
}