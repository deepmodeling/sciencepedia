{
    "hands_on_practices": [
        {
            "introduction": "The first step in how a Hierarchical Temporal Memory (HTM) system processes information is pattern recognition at the level of its mini-columns. This is achieved through a mechanism known as the Spatial Pooler. This exercise will guide you through the fundamental calculation of a column's 'overlap' with an input pattern, which quantifies how well the column is matched to the current input. You will also apply a 'boosting' factor, a critical homeostatic mechanism that ensures all columns contribute to the learning process over time, preventing any single column from dominating the representation .",
            "id": "4047287",
            "problem": "Consider a system following the principles of Hierarchical Temporal Memory (HTM), where each minicolumn has proximal synapses onto a binary input space that is modeled as a Sparse Distributed Representation (SDR). For a given column indexed by $i$, let the binary input be $x \\in \\{0,1\\}^{N}$ with components $x_{j}$, and let the permanence of the proximal synapse from input bit $j$ to column $i$ be $p_{ij} \\in [0,1]$. A synapse is considered connected if its permanence meets or exceeds a fixed threshold $p_{\\text{th}}$. The overlap for a column is defined operationally as the number of connected synapses that receive active input, and a positive multiplicative boosting factor $b_{i}$ is used to scale the overlap before local inhibition (competition) is applied.\n\nStarting from these core definitions and without assuming any pre-derived formula, perform the following:\n\n1. Derive a symbolic expression for the unboosted overlap of column $i$ that depends only on the binary input $x_{j}$ and the connectedness criterion in terms of $p_{ij}$ and $p_{\\text{th}}$. Then, using first principles, justify how a multiplicative boosting factor affects the overlap during competition.\n\n2. For a concrete configuration with $N=12$, let the input $x$ be specified by $x_{j} = 1$ for $j \\in \\{1,3,4,7,9,12\\}$ and $x_{j} = 0$ otherwise. The permanence threshold is $p_{\\text{th}} = 0.25$. There are three columns, indexed $i \\in \\{1,2,3\\}$, with permanences given by:\n- For column $i=1$: $p_{1,1} = 0.30$, $p_{1,3} = 0.20$, $p_{1,4} = 0.28$, $p_{1,8} = 0.10$, $p_{1,9} = 0.40$, $p_{1,12} = 0.24$, and $p_{1,j} = 0$ for all other $j$.\n- For column $i=2$: $p_{2,1} = 0.27$, $p_{2,3} = 0.26$, $p_{2,7} = 0.29$, $p_{2,9} = 0.18$, $p_{2,10} = 0.50$, $p_{2,12} = 0.31$, and $p_{2,j} = 0$ for all other $j$.\n- For column $i=3$: $p_{3,2} = 0.90$, $p_{3,4} = 0.26$, $p_{3,5} = 0.22$, $p_{3,7} = 0.23$, $p_{3,9} = 0.27$, $p_{3,11} = 0.30$, $p_{3,12} = 0.26$, and $p_{3,j} = 0$ for all other $j$.\n\nLet the boosting factors be $b_{1} = 1.2$, $b_{2} = 0.9$, and $b_{3} = 1.5$. Consider a local inhibition neighborhood that consists of these three columns and selects the top $k=1$ column by the boosted overlap. Compute the boosted overlap of the single winning column in this neighborhood. Express the final answer as a real number. No rounding is required.",
            "solution": "### Part 1: Symbolic Derivation and Justification\n\nThe unboosted overlap for a column $i$, denoted $O_i$, is defined as the number of its connected synapses that are receiving an active input. Let's formalize this.\n\nA synapse from input bit $j$ to column $i$ is connected if its permanence $p_{ij}$ meets or exceeds the threshold $p_{\\text{th}}$. We can represent this condition with an indicator function $\\mathbf{1}(\\cdot)$, where $\\mathbf{1}(\\text{condition})=1$ if the condition is true and $0$ otherwise. Let $C_{ij}$ be an indicator variable for connection:\n$$C_{ij} = \\mathbf{1}(p_{ij} \\ge p_{\\text{th}})$$\n$C_{ij}$ is $1$ if the synapse is connected and $0$ otherwise.\n\nThe input bit $x_j$ is either $1$ (active) or $0$ (inactive). A synapse $(i,j)$ contributes to the overlap count only if it is both connected ($C_{ij}=1$) and receives active input ($x_j=1$). The contribution of a single synapse is the product $C_{ij} \\cdot x_j$.\n\nThe total unboosted overlap $O_i$ is the sum of these contributions over all $N$ input bits:\n$$O_i = \\sum_{j=1}^{N} C_{ij} \\cdot x_j = \\sum_{j=1}^{N} \\mathbf{1}(p_{ij} \\ge p_{\\text{th}}) x_j$$\nThis is the symbolic expression for the unboosted overlap.\n\nThe multiplicative boosting factor $b_i$ is applied to this unboosted overlap to determine the column's final score for the competitive process. The boosted overlap, $O'_{i}$, is given by:\n$$O'_{i} = b_{i} \\cdot O_{i}$$\nThe local inhibition mechanism then selects one or more columns to become active based on these boosted scores. In a \"k-winners-take-all\" scheme, the $k$ columns with the highest boosted overlaps in a local neighborhood become active.\n\nThe justification for this mechanism is homeostatic. It ensures that all columns in a region are utilized over time. If a column has a low activation frequency (i.e., it has not won the competition recently), its boosting factor $b_i$ is increased. This gives the column a competitive advantage, making it more likely to win in the future even if its raw pattern match (the unboosted overlap $O_i$) is not the highest. Conversely, a column that wins too frequently has its boosting factor decreased, making it less likely to win. This prevents a small subset of columns from dominating the representation of all patterns and ensures that the representational capacity of the entire column population is used, which is critical for robust and distributed learning.\n\n### Part 2: Numerical Calculation\n\nWe are given the active input bits $j \\in \\{1,3,4,7,9,12\\}$, the permanence threshold $p_{\\text{th}} = 0.25$, and the permanences and boosting factors for three columns. We will calculate the unboosted overlap $O_i$ and then the boosted overlap $O'_i$ for each column. The winner is the column with the highest boosted overlap.\n\n**Calculation for Column 1 ($i=1$):**\nThe unboosted overlap $O_1$ is the count of connected synapses for active inputs. We only need to check the permanences at indices $j \\in \\{1,3,4,7,9,12\\}$.\n- $j=1$: $p_{1,1} = 0.30 \\ge 0.25$. Connected.\n- $j=3$: $p_{1,3} = 0.20 < 0.25$. Not connected.\n- $j=4$: $p_{1,4} = 0.28 \\ge 0.25$. Connected.\n- $j=7$: $p_{1,7}=0 < 0.25$. Not connected.\n- $j=9$: $p_{1,9} = 0.40 \\ge 0.25$. Connected.\n- $j=12$: $p_{1,12} = 0.24 < 0.25$. Not connected.\n\nThe number of connected synapses for active inputs is $3$.\nSo, the unboosted overlap is $O_1 = 3$.\nThe boosting factor is $b_1 = 1.2$.\nThe boosted overlap is $O'_1 = b_1 \\cdot O_1 = 1.2 \\times 3 = 3.6$.\n\n**Calculation for Column 2 ($i=2$):**\nWe check permanences for $j \\in \\{1,3,4,7,9,12\\}$.\n- $j=1$: $p_{2,1} = 0.27 \\ge 0.25$. Connected.\n- $j=3$: $p_{2,3} = 0.26 \\ge 0.25$. Connected.\n- $j=4$: $p_{2,4}=0 < 0.25$. Not connected.\n- $j=7$: $p_{2,7} = 0.29 \\ge 0.25$. Connected.\n- $j=9$: $p_{2,9} = 0.18 < 0.25$. Not connected.\n- $j=12$: $p_{2,12} = 0.31 \\ge 0.25$. Connected.\n\nThe number of connected synapses for active inputs is $4$.\nSo, the unboosted overlap is $O_2 = 4$.\nThe boosting factor is $b_2 = 0.9$.\nThe boosted overlap is $O'_2 = b_2 \\cdot O_2 = 0.9 \\times 4 = 3.6$.\n\n**Calculation for Column 3 ($i=3$):**\nWe check permanences for $j \\in \\{1,3,4,7,9,12\\}$.\n- $j=1$: $p_{3,1}=0 < 0.25$. Not connected.\n- $j=3$: $p_{3,3}=0 < 0.25$. Not connected.\n- $j=4$: $p_{3,4} = 0.26 \\ge 0.25$. Connected.\n- $j=7$: $p_{3,7} = 0.23 < 0.25$. Not connected.\n- $j=9$: $p_{3,9} = 0.27 \\ge 0.25$. Connected.\n- $j=12$: $p_{3,12} = 0.26 \\ge 0.25$. Connected.\n\nThe number of connected synapses for active inputs is $3$.\nSo, the unboosted overlap is $O_3 = 3$.\nThe boosting factor is $b_3 = 1.5$.\nThe boosted overlap is $O'_3 = b_3 \\cdot O_3 = 1.5 \\times 3 = 4.5$.\n\n**Determine the Winner:**\nWe compare the boosted overlaps:\n- $O'_1 = 3.6$\n- $O'_2 = 3.6$\n- $O'_3 = 4.5$\n\nThe maximum boosted overlap is $4.5$, which belongs to column $3$. Therefore, column $3$ is the winning column. The problem asks for the boosted overlap of this winning column.\n\nThe boosted overlap of the winning column is $4.5$.",
            "answer": "$$\\boxed{4.5}$$"
        },
        {
            "introduction": "After columns compute their overlap scores, they must compete to form a sparse distributed representation (SDR) of the input. This is accomplished through 'local inhibition', where columns inhibit their neighbors, and only a small fraction become active. This hands-on practice asks you to implement this critical k-winners-take-all competition, exploring how neighborhood definitions and tie-breaking rules determine the final set of active columns and how physical boundaries in the cortical sheet can influence the outcome .",
            "id": "4047281",
            "problem": "Consider a two-dimensional grid of columns, as used in the Spatial Pooler of Hierarchical Temporal Memory (HTM). Each column at position $(i,j)$ has a scalar overlap $o_{i,j} \\in \\mathbb{R}_{\\ge 0}$. Local inhibition is defined over neighborhoods determined by a fixed radius $r$, using the Chebyshev metric. Specifically, for a given column $(i,j)$ in an $N \\times M$ grid, its neighborhood is $\\mathcal{N}_r(i,j) = \\{(p,q) \\mid \\max(|p - i|, |q - j|) \\le r,\\ 0 \\le p < N,\\ 0 \\le q < M\\}$. The desired local sparsity is specified by $\\rho \\in (0,1)$, and the number of winners in a neighborhood is $k(i,j) = \\max(1, \\lceil \\rho \\cdot |\\mathcal{N}_r(i,j)| \\rceil)$.\n\nA column $(i,j)$ is a local winner if it belongs to the top $k(i,j)$ columns within its neighborhood $\\mathcal{N}_r(i,j)$, when neighbors are ordered by decreasing overlap, and ties are broken by ascending row-major index $I(p,q) = p \\cdot M + q$. Define a border column as one with $i \\in \\{0, N-1\\}$ or $j \\in \\{0, M-1\\}$, and an interior column otherwise.\n\nGiven $r = 2$ and $\\rho = 0.02$, implement the local inhibition rule and compute the total number of winners, the number of border winners, and the number of interior winners for each test case below. Show how border effects (i.e., smaller neighborhoods near the boundaries and the specified tie-breaking) influence selection.\n\nUse the following test suite of overlap configurations:\n\n- Test case A: A $6 \\times 6$ grid with overlaps\n$$\n\\begin{bmatrix}\n10 & 3 & 2 & 1 & 1 & 1 \\\\\n3 & 2 & 2 & 2 & 1 & 1 \\\\\n2 & 2 & 4 & 2 & 2 & 1 \\\\\n1 & 2 & 2 & 9 & 2 & 2 \\\\\n1 & 1 & 2 & 2 & 4 & 2 \\\\\n1 & 1 & 1 & 2 & 2 & 8\n\\end{bmatrix}\n$$\nwhere each entry is $o_{i,j}$ with indices $i$ and $j$ starting at $0$.\n\n- Test case B: A $3 \\times 3$ grid with overlaps\n$$\n\\begin{bmatrix}\n1 & 2 & 1 \\\\\n2 & 5 & 2 \\\\\n1 & 2 & 1\n\\end{bmatrix}\n$$\n\n- Test case C: A $5 \\times 5$ grid with uniform overlaps\n$$\n\\begin{bmatrix}\n1 & 1 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 1 & 1\n\\end{bmatrix}\n$$\n\nYour program must compute, for each test case, the tuple $[T,B,I]$ where $T$ is the total number of winners, $B$ is the number of border winners, and $I$ is the number of interior winners. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[T,B,I]$ for a test case, in the order A, B, C. For example, the required output format is $[[T_A,B_A,I_A],[T_B,B_B,I_B],[T_C,B_C,I_C]]$. No physical units or angle units are involved; all outputs are integers.",
            "solution": "The problem asks for the implementation and analysis of a local inhibition algorithm, a key component of the Spatial Pooler in Hierarchical Temporal Memory (HTM). We are given a two-dimensional grid of columns, an overlap value for each column, a neighborhood definition, a desired sparsity, and a tie-breaking rule. The objective is to identify which columns become \"winners\" and to quantify them based on their position (border vs. interior) for three specific test cases.\n\nFirst, we formalize the definitions provided. A column is located at position $(i,j)$ in an $N \\times M$ grid, where $0 \\le i < N$ and $0 \\le j < M$. Each column has a non-negative real-valued overlap $o_{i,j}$. The neighborhood $\\mathcal{N}_r(i,j)$ of a column $(i,j)$ is defined by the Chebyshev distance with radius $r$:\n$$\n\\mathcal{N}_r(i,j) = \\{(p,q) \\mid \\max(|p - i|, |q - j|) \\le r,\\ 0 \\le p < N,\\ 0 \\le q < M\\}\n$$\nThis defines a square region of side length up to $2r+1$ centered at $(i,j)$, clipped to the grid boundaries.\n\nThe number of winners to be selected within this neighborhood, $k(i,j)$, is determined by the local sparsity $\\rho$:\n$$\nk(i,j) = \\max(1, \\lceil \\rho \\cdot |\\mathcal{N}_r(i,j)| \\rceil)\n$$\nwhere $|\\mathcal{N}_r(i,j)|$ is the number of columns in the neighborhood.\nThe problem specifies $r=2$ and $\\rho=0.02$. The largest possible neighborhood occurs for an interior column, far from the borders, and its size is $(2r+1)^2 = (2 \\cdot 2 + 1)^2 = 25$. For this maximum size, $k = \\max(1, \\lceil 0.02 \\cdot 25 \\rceil) = \\max(1, \\lceil 0.5 \\rceil) = \\max(1, 1) = 1$. For any smaller neighborhood (i.e., for a border or corner column), the size $|\\mathcal{N}_r(i,j)|$ will be less than $25$, and thus the product $\\rho \\cdot |\\mathcal{N}_r(i,j)|$ will be less than $0.5$. The ceiling will still be $1$. Therefore, for the given parameters $r=2$ and $\\rho=0.02$, $k(i,j)$ is always equal to $1$ for any column $(i,j)$.\n\nA column $(i,j)$ is declared a winner if it ranks among the top $k(i,j)$ columns within its own neighborhood $\\mathcal{N}_r(i,j)$. Since we have established that $k(i,j) = 1$ for all $(i,j)$, this simplifies the condition: a column $(i,j)$ is a winner if and only if it is the single top-ranked column in its neighborhood $\\mathcal{N}_r(i,j)$.\n\nThe ranking is determined by a two-level sort:\n1.  Primary key: Overlap value $o_{p,q}$, in descending order.\n2.  Secondary key (for ties in overlap): Row-major index $I(p,q) = p \\cdot M + q$, in ascending order.\n\nThis means a column $(i,j)$ is a winner if and only if, for all other columns $(p,q)$ in its neighborhood $\\mathcal{N}_r(i,j)$ (where $(p,q) \\ne (i,j)$), one of the following is true:\n-   $o_{i,j} > o_{p,q}$\n-   $o_{i,j} = o_{p,q}$ and $I(i,j) < I(p,q)$\n\nFinally, winners are classified. A column $(i,j)$ is a border column if $i \\in \\{0, N-1\\}$ or $j \\in \\{0, M-1\\}$. Otherwise, it is an interior column. We need to compute the total winners ($T$), border winners ($B$), and interior winners ($I$) for each test case.\n\n**Test Case A: $6 \\times 6$ Grid, $r=2$**\nThe overlap matrix is given as:\n$$\nO = \\begin{bmatrix}\n10 & 3 & 2 & 1 & 1 & 1 \\\\\n3 & 2 & 2 & 2 & 1 & 1 \\\\\n2 & 2 & 4 & 2 & 2 & 1 \\\\\n1 & 2 & 2 & 9 & 2 & 2 \\\\\n1 & 1 & 2 & 2 & 4 & 2 \\\\\n1 & 1 & 1 & 2 & 2 & 8\n\\end{bmatrix}\n$$\nWe check each column to see if it's the winner in its own neighborhood.\n-   Column $(0,0)$, $o_{0,0}=10$: Its neighborhood $\\mathcal{N}_2(0,0)$ is the $3 \\times 3$ top-left subgrid. The maximum overlap in this region is $10$ at $(0,0)$ itself. There are no ties. Thus, $(0,0)$ is a winner. It is a border column ($i=0$).\n-   Column $(3,3)$, $o_{3,3}=9$: Its neighborhood $\\mathcal{N}_2(3,3)$ is the $5 \\times 5$ subgrid with its top-left corner at $(1,1)$. The maximum overlap in this region is $9$ at $(3,3)$ itself. There are no ties. Thus, $(3,3)$ is a winner. It is an interior column ($i,j \\in \\{1,2,3,4\\}$ for a $6 \\times 6$ grid).\n-   Column $(5,5)$, $o_{5,5}=8$: Its neighborhood $\\mathcal{N}_2(5,5)$ is the $3 \\times 3$ bottom-right subgrid. Within this neighborhood, column $(3,3)$ has an overlap of $o_{3,3}=9$. Since $8 < 9$, $(5,5)$ is not the maximum and thus not a winner.\n-   Any other column $(i,j)$ has an overlap value that is lower than a value present in its neighborhood. For example, the neighborhood of $(2,2)$ (overlap $4$) contains $(0,0)$ (overlap $10$), and the neighborhood of $(4,4)$ (overlap $4$) contains $(3,3)$ (overlap $9$).\nTherefore, only two columns win.\nTotal winners $T=2$.\nBorder winners $B=1$ (from column $(0,0)$).\nInterior winners $I=1$ (from column $(3,3)$).\nResult: $[2, 1, 1]$.\n\n**Test Case B: $3 \\times 3$ Grid, $r=2$**\nThe overlap matrix is:\n$$\nO = \\begin{bmatrix}\n1 & 2 & 1 \\\\\n2 & 5 & 2 \\\\\n1 & 2 & 1\n\\end{bmatrix}\n$$\nWith $N=3, M=3$ and $r=2$, the neighborhood for any column $(i,j)$ is the entire $3 \\times 3$ grid, since $\\max(|p-i|,|q-j|) \\le 2$ holds for all $i,j,p,q \\in \\{0,1,2\\}$. Thus, every column is evaluated against the same global set of competitors. The maximum overlap in the grid is $o_{1,1}=5$.\n-   Column $(1,1)$, $o_{1,1}=5$: This is the unique maximum overlap. It is the winner in its neighborhood (the whole grid).\n-   Any other column $(i,j)$ has $o_{i,j} < 5$, so it cannot be a winner.\nThere is only one winner, $(1,1)$. In a $3 \\times 3$ grid, border columns have indices in $\\{0,2\\}$. Column $(1,1)$ is therefore an interior column.\nTotal winners $T=1$.\nBorder winners $B=0$.\nInterior winners $I=1$.\nResult: $[1, 0, 1]$.\n\n**Test Case C: $5 \\times 5$ Grid, $r=2$, uniform overlaps**\nThe overlap matrix is a $5 \\times 5$ grid where $o_{i,j}=1$ for all $(i,j)$.\nSince all overlaps are identical, the tie-breaking rule is the sole determinant of winner selection. A column $(i,j)$ wins if it has the minimum row-major index, $I(p,q) = p \\cdot M + q$, within its own neighborhood $\\mathcal{N}_2(i,j)$.\nFor $(i,j)$ to win, it must satisfy $I(i,j) \\le I(p,q)$ for all $(p,q) \\in \\mathcal{N}_2(i,j)$. This is equivalent to requiring $(i,j)$ to be the coordinate pair with the lexicographically smallest value in its neighborhood. The cell with the minimum row-major index in any rectangular region is always its top-left corner.\nThe top-left corner of the neighborhood $\\mathcal{N}_r(i,j)$ is given by $(p_{min}, q_{min}) = (\\max(0, i-r), \\max(0, j-r))$.\nThus, a column $(i,j)$ is a winner if and only if it is the top-left corner of its own neighborhood:\n$(i,j) = (\\max(0, i-r), \\max(0, j-r))$.\nThis separates into two conditions:\n1.  $i = \\max(0, i-r) \\implies i-r \\le 0 \\implies i \\le r$.\n2.  $j = \\max(0, j-r) \\implies j-r \\le 0 \\implies j \\le r$.\nGiven $r=2$, the winning columns are all $(i,j)$ such that $0 \\le i \\le 2$ and $0 \\le j \\le 2$. This forms a $3 \\times 3$ block of winners in the top-left of the $5 \\times 5$ grid.\nThe number of winners is $T = 3 \\times 3 = 9$.\nWe now classify these 9 winners. The grid size is $N=5, M=5$. Border columns have $i \\in \\{0,4\\}$ or $j \\in \\{0,4\\}$.\n-   Winners with $i=0$: $(0,0), (0,1), (0,2)$ (3 columns).\n-   Winners with $j=0$ (and $i \\ne 0$): $(1,0), (2,0)$ (2 columns).\n-   There are no winners with $i=4$ or $j=4$.\nTotal border winners $B = 3 + 2 = 5$.\nThe remaining winners are interior: $I = T - B = 9 - 5 = 4$. These are $(1,1), (1,2), (2,1), (2,2)$.\nResult: $[9, 5, 4]$.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the HTM local inhibition problem for a suite of test cases.\n    \"\"\"\n\n    def compute_winners(overlaps, r, rho):\n        \"\"\"\n        Computes the total, border, and interior winners for a given grid.\n\n        Args:\n            overlaps (np.ndarray): A 2D numpy array of overlap values.\n            r (int): The Chebyshev distance radius for the neighborhood.\n            rho (float): The desired local sparsity.\n\n        Returns:\n            list: A list containing [Total winners, Border winners, Interior winners].\n        \"\"\"\n        N, M = overlaps.shape\n        winners = set()\n\n        for i in range(N):\n            for j in range(M):\n                # 1. Determine the neighborhood\n                p_min = max(0, i - r)\n                p_max = min(N - 1, i + r)\n                q_min = max(0, j - r)\n                q_max = min(M - 1, j + r)\n\n                neighborhood_coords = []\n                for p in range(p_min, p_max + 1):\n                    for q in range(q_min, q_max + 1):\n                        neighborhood_coords.append((p, q))\n                \n                # 2. Calculate k, the number of winners for this neighborhood\n                neighborhood_size = len(neighborhood_coords)\n                k = max(1, math.ceil(rho * neighborhood_size))\n\n                # 3. Get all columns in the neighborhood with their properties\n                # for sorting. The properties are (overlap, row-major index, coordinates).\n                competitors = []\n                for p, q in neighborhood_coords:\n                    overlap_val = overlaps[p, q]\n                    row_major_idx = p * M + q\n                    competitors.append((overlap_val, row_major_idx, (p, q)))\n\n                # 4. Sort competitors: descending by overlap, ascending by row-major index\n                competitors.sort(key=lambda x: (-x[0], x[1]))\n\n                # 5. Check if the current column (i,j) is a winner\n                # A column (i,j) wins if it's in the top k of its own neighborhood's\n                # sorted list.\n                current_col_row_major_idx = i * M + j\n                for rank in range(k):\n                    if competitors[rank][1] == current_col_row_major_idx:\n                        winners.add((i, j))\n                        break\n        \n        # 6. Classify winners as border or interior\n        total_winners = len(winners)\n        border_winners = 0\n        for i_win, j_win in winners:\n            if i_win == 0 or i_win == N - 1 or j_win == 0 or j_win == M - 1:\n                border_winners += 1\n        \n        interior_winners = total_winners - border_winners\n        \n        return [total_winners, border_winners, interior_winners]\n\n    # Parameters from the problem statement\n    r = 2\n    rho = 0.02\n\n    # Test Case A\n    overlaps_A = np.array([\n        [10, 3, 2, 1, 1, 1],\n        [3, 2, 2, 2, 1, 1],\n        [2, 2, 4, 2, 2, 1],\n        [1, 2, 2, 9, 2, 2],\n        [1, 1, 2, 2, 4, 2],\n        [1, 1, 1, 2, 2, 8]\n    ])\n\n    # Test Case B\n    overlaps_B = np.array([\n        [1, 2, 1],\n        [2, 5, 2],\n        [1, 2, 1]\n    ])\n\n    # Test Case C\n    overlaps_C = np.ones((5, 5), dtype=int)\n\n    test_cases = [overlaps_A, overlaps_B, overlaps_C]\n    \n    results = []\n    for overlaps_grid in test_cases:\n        result = compute_winners(overlaps_grid, r, rho)\n        results.append(result)\n\n    # Format the final output string\n    # e.g., [[2,1,1],[1,0,1],[9,5,4]]\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Once the Spatial Pooler selects a set of active columns, the Temporal Memory component takes over to analyze the input in its temporal context. This exercise moves from the column level to the cellular level, demonstrating how HTM disambiguates sequences and makes predictions. You will apply the rules that determine which specific cells within the active columns become active, based on whether they were in a 'predictive state' from the previous time step, thereby forming a representation that is not only sparse but also rich with temporal meaning .",
            "id": "4047239",
            "problem": "A single region of a Hierarchical Temporal Memory (HTM) temporal memory is organized into $N$ columns, each containing $M$ cells. At each discrete time step $t$, a subset of columns becomes active due to feedforward input. The temporal memory maintains, for each cell, a set of distal dendrite segments, each of which comprises potential synapses to other cells. A potential synapse is considered connected if its permanence is at least a fixed connection threshold $p_c$. A segment on a cell is considered active if the number of its connected synapses whose presynaptic cells were active at time $t-1$ is at least a fixed activation threshold $\\theta$. A cell is in predictive state at time $t$ if any of its segments is active at time $t$.\n\nWhen the feedforward input at time $t$ activates a set of columns, the next active cell set at time $t$ is determined as follows:\n- For each active column, if one or more cells in that column are in predictive state at time $t$, then exactly those predicted cells in the column become active.\n- Otherwise (no predicted cell in that active column), the column is in a bursting condition that is here resolved by selecting a single winner cell. The winner cell in a bursting column is taken to be the cell whose best distal segment achieves the largest matching score with the previous active cell set, where the matching score of a segment is the number of its connected synapses whose presynaptic cells were active at time $t-1$. If there is a tie in matching score, break ties by selecting the cell with the largest sum of permanences among those matched connected synapses; if the tie persists, select the cell of smallest cell index within the column. Only that winner cell becomes active in the column.\n\nConsider an HTM module with $N = 6$ columns indexed by $j \\in \\{0,1,2,3,4,5\\}$ and $M = 4$ cells per column indexed by $i \\in \\{0,1,2,3\\}$. Denote a cell by an ordered pair $(j,i)$. The connection threshold is $p_c = 0.20$, and the activation threshold is $\\theta = 2$. The set of cells that were active at the previous time step is\n$$\nS_{t-1} = \\{(0,2),(2,1),(2,3),(4,2),(5,1),(5,3)\\}.\n$$\nAt the current time $t$, before considering the new feedforward input, the predicted cell set is given by\n$$\nP = \\{(0,1),(0,3),(2,0),(4,2),(5,2)\\}.\n$$\nThe feedforward input at time $t$ activates the columns\n$$\nA = \\{0,1,3,5\\}.\n$$\n\nFor the purpose of winner-cell selection in bursting columns, the distal segment structure and synapse permanences are specified only for cells in columns $1$ and $3$ (all other segment details may be ignored). Each of these cells has a single distal segment with the following potential synapses and permanences:\n- Column $1$:\n  - Cell $(1,0)$: potential synapses to $(0,2)$ with permanence $0.18$, to $(2,1)$ with permanence $0.25$, and to $(3,2)$ with permanence $0.30$.\n  - Cell $(1,1)$: potential synapses to $(4,2)$ with permanence $0.19$ and to $(5,1)$ with permanence $0.35$.\n  - Cell $(1,2)$: potential synapses to $(2,3)$ with permanence $0.15$ and to $(5,3)$ with permanence $0.21$.\n  - Cell $(1,3)$: a potential synapse to $(0,2)$ with permanence $0.22$.\n- Column $3$:\n  - Cell $(3,0)$: potential synapses to $(2,1)$ with permanence $0.19$ and to $(4,2)$ with permanence $0.21$.\n  - Cell $(3,1)$: a potential synapse to $(5,3)$ with permanence $0.20$.\n  - Cell $(3,2)$: a potential synapse to $(0,2)$ with permanence $0.19$.\n  - Cell $(3,3)$: potential synapses to $(2,3)$ with permanence $0.22$ and to $(5,1)$ with permanence $0.18$.\n\nUsing only the definitions above and the provided data, determine the total number of cells that will be active at time $t$ after applying the HTM temporal memory selection rule described. Give your answer as an integer (no units).",
            "solution": "The problem asks for the total number of cells that will be active at time step $t$ in a specified Hierarchical Temporal Memory (HTM) region. The solution requires applying a set of rules to determine the active cells within a given set of active columns.\n\nFirst, we establish the given data:\n- Number of columns $N = 6$, indexed by $j \\in \\{0,1,2,3,4,5\\}$.\n- Number of cells per column $M = 4$, indexed by $i \\in \\{0,1,2,3\\}$.\n- Connection threshold $p_c = 0.20$.\n- Activation threshold $\\theta = 2$.\n- The set of cells active at the previous time step, $t-1$:\n$$S_{t-1} = \\{(0,2),(2,1),(2,3),(4,2),(5,1),(5,3)\\}$$\n- The set of cells in a predictive state at the current time step, $t$:\n$$P = \\{(0,1),(0,3),(2,0),(4,2),(5,2)\\}$$\n- The set of columns activated by feedforward input at time $t$:\n$$A = \\{0,1,3,5\\}$$\n- The distal segment synapse permanences for cells in columns $j=1$ and $j=3$ are provided.\n\nThe process to determine the active cells at time $t$, denoted $S_t$, is to examine each column $j$ in the active set $A$. For each such column, we determine which of its cells, if any, will become active.\n\nThe rules are as follows:\n1.  If an active column $j \\in A$ has one or more cells in the predictive set $P$, then those predicted cells become active.\n2.  If an active column $j \\in A$ has no cells in the predictive set $P$, the column is \"bursting\". A single \"winner cell\" is chosen to become active. The winner is the cell with the highest \"matching score\".\n    - A synapse is \"connected\" if its permanence is greater than or equal to $p_c$.\n    - The \"matching score\" of a segment is the number of its connected synapses whose presynaptic cells were in $S_{t-1}$.\n    - Tie-breaking rules for the highest matching score: first, by the largest sum of permanences of the matched connected synapses; second, by the smallest cell index $i$.\n\nWe will now apply these rules to each column in the active set $A = \\{0,1,3,5\\}$.\n\n**Column $j = 0$:**\nThis column is in the active set $A$. We check for predicted cells in this column by intersecting the set of cells in column $0$, i.e., $\\{(0,i) \\mid i \\in \\{0,1,2,3\\}\\}$, with the predictive set $P$.\nThe cells in $P$ that are in column $0$ are $(0,1)$ and $(0,3)$.\nSince there are predicted cells in this column, RULE 1 applies. The predicted cells $(0,1)$ and $(0,3)$ become active.\nNumber of active cells from column $0$: $2$.\n\n**Column $j = 1$:**\nThis column is in the active set $A$. We check for predicted cells in this column. There are no cells of the form $(1,i)$ in the predictive set $P$.\nThus, column $1$ is bursting, and RULE 2 applies. We must find the winner cell by calculating the matching score for each cell in column $1$. A synapse is connected if its permanence $p \\ge p_c = 0.20$. The matching score is the number of connected synapses whose presynaptic cells are in $S_{t-1}$.\n- **Cell (1,0):** Potential synapses to $(0,2)$ ($p=0.18$), $(2,1)$ ($p=0.25$), $(3,2)$ ($p=0.30$).\n  - Connected synapses ($p \\ge 0.20$): to $(2,1)$ and $(3,2)$.\n  - Presynaptic cells in $S_{t-1}$: $(2,1) \\in S_{t-1}$, but $(3,2) \\notin S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.25$.\n- **Cell (1,1):** Potential synapses to $(4,2)$ ($p=0.19$), $(5,1)$ ($p=0.35$).\n  - Connected synapse ($p \\ge 0.20$): to $(5,1)$.\n  - Presynaptic cell in $S_{t-1}$: $(5,1) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.35$.\n- **Cell (1,2):** Potential synapses to $(2,3)$ ($p=0.15$), $(5,3)$ ($p=0.21$).\n  - Connected synapse ($p \\ge 0.20$): to $(5,3)$.\n  - Presynaptic cell in $S_{t-1}$: $(5,3) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.21$.\n- **Cell (1,3):** Potential synapse to $(0,2)$ ($p=0.22$).\n  - Connected synapse ($p \\ge 0.20$): to $(0,2)$.\n  - Presynaptic cell in $S_{t-1}$: $(0,2) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.22$.\n\nAll four cells have a matching score of $1$. We use the first tie-breaking rule: select the cell with the largest sum of permanences of matched synapses.\n- (1,0): Sum = $0.25$\n- (1,1): Sum = $0.35$\n- (1,2): Sum = $0.21$\n- (1,3): Sum = $0.22$\nThe maximum sum is $0.35$, corresponding to cell $(1,1)$. Therefore, cell $(1,1)$ is the winner.\nNumber of active cells from column $1$: $1$.\n\n**Column $j = 3$:**\nThis column is in the active set $A$. We check for predicted cells. There are no cells of the form $(3,i)$ in the predictive set $P$.\nThus, column $3$ is bursting, and RULE 2 applies. We calculate matching scores for each cell in column $3$.\n- **Cell (3,0):** Potential synapses to $(2,1)$ ($p=0.19$), $(4,2)$ ($p=0.21$).\n  - Connected synapse ($p \\ge 0.20$): to $(4,2)$.\n  - Presynaptic cell in $S_{t-1}$: $(4,2) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.21$.\n- **Cell (3,1):** Potential synapse to $(5,3)$ ($p=0.20$).\n  - Connected synapse ($p \\ge 0.20$): to $(5,3)$ because $0.20 \\ge p_c$.\n  - Presynaptic cell in $S_{t-1}$: $(5,3) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.20$.\n- **Cell (3,2):** Potential synapse to $(0,2)$ ($p=0.19$).\n  - Connected synapses ($p \\ge 0.20$): None.\n  - Matching score = $0$.\n- **Cell (3,3):** Potential synapses to $(2,3)$ ($p=0.22$), $(5,1)$ ($p=0.18$).\n  - Connected synapse ($p \\ge 0.20$): to $(2,3)$.\n  - Presynaptic cell in $S_{t-1}$: $(2,3) \\in S_{t-1}$.\n  - Matching score = $1$.\n  - Sum of permanences of matched connected synapses = $0.22$.\n\nCells $(3,0)$, $(3,1)$, and $(3,3)$ have the highest matching score of $1$. We use the first tie-breaking rule:\n- (3,0): Sum = $0.21$\n- (3,1): Sum = $0.20$\n- (3,3): Sum = $0.22$\nThe maximum sum is $0.22$, corresponding to cell $(3,3)$. Therefore, cell $(3,3)$ is the winner.\nNumber of active cells from column $3$: $1$.\n\n**Column $j = 5$:**\nThis column is in the active set $A$. We check for predicted cells. The cell $(5,2)$ is in the predictive set $P$.\nSince there is a predicted cell in this column, RULE 1 applies. The predicted cell $(5,2)$ becomes active.\nNumber of active cells from column $5$: $1$.\n\n**Total Number of Active Cells:**\nTo find the total number of cells active at time $t$, we sum the number of active cells from each column in $A$:\n- From column $0$: $2$ cells ($(0,1)$ and $(0,3)$)\n- From column $1$: $1$ cell ($(1,1)$)\n- From column $3$: $1$ cell ($(3,3)$)\n- From column $5$: $1$ cell ($(5,2)$)\n\nTotal active cells = $2 + 1 + 1 + 1 = 5$.\nThe set of active cells at time $t$ is $S_t = \\{(0,1), (0,3), (1,1), (3,3), (5,2)\\}$. The size of this set is $5$.\nThe activation threshold $\\theta=2$ was given but not used in the calculation, as the predictive cell set $P$ was provided directly. The information was part of the general description of HTM but not needed for this specific computation.",
            "answer": "$$\\boxed{5}$$"
        }
    ]
}