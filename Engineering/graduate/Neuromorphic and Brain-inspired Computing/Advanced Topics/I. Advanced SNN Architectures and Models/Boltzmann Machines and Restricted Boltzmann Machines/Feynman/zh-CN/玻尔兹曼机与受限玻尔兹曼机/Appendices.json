{
    "hands_on_practices": [
        {
            "introduction": "理解一个模型的参数是掌握它的第一步。这个练习深入探讨了通用玻尔兹曼机（Boltzmann Machine）的参数化问题。通过这个练习，你将从第一性原理出发，理解为什么对称权重矩阵和零对角线是该模型的标准约定，这不仅简化了模型，而且不损失其表达能力，这是理解模型可辨识性的一个关键洞见 。",
            "id": "4038503",
            "problem": "考虑一个具有$n$个二元单元$x_{i} \\in \\{0,1\\}$的全连接玻尔兹曼机，其成对相互作用权重由一个实矩阵$W \\in \\mathbb{R}^{n \\times n}$表示，偏置由一个向量$b \\in \\mathbb{R}^{n}$表示。一个状态$x \\in \\{0,1\\}^{n}$的概率由玻尔兹曼分布$p(x) \\propto \\exp\\!\\big(-E(x)\\big)$给出，其中$E(x)$是从成对相互作用和偏置导出的能量函数。假设只存在成对相互作用和单元偏置（没有更高阶的项）。施加物理一致性要求，即成对耦合能量在单元索引重新标记下保持不变，并且从状态空间中无法识别的自相互作用项被排除。\n\n仅使用这些基本假设，确定当强制$W$为对称且对角线为零时，模型中独立参数的数量。明确计算独立的相互作用权重和独立的偏置数量，并给出一个关于$n$的单一闭式表达式，表示独立参数的总数。在你的推理中，解释为什么施加$W = W^{\\top}$和$\\operatorname{diag}(W)=0$的约束，相对于允许任意实数$W$和$b$，不会减少模型的表达族。\n\n以一个关于$n$的单一闭式解析表达式的形式提供你的最终答案。不需要进行数值代入，也不需要四舍五入。",
            "solution": "问题要求在一个具有$n$个二元单元的全连接玻尔兹曼机中，在权重矩阵$W$是对称且对角线为零的约束下，计算独立参数的总数。同时，也要求解释为什么这些约束不会降低模型的表达能力。\n\n设系统的状态为一个向量$x \\in \\{0, 1\\}^n$，其中每个单元$x_i$（对于$i \\in \\{1, 2, \\dots, n\\}$）是一个二元变量，即$x_i \\in \\{0, 1\\}$。对于一个只有成对相互作用和单元偏置的模型，其最一般的能量函数$E'(x)$可以使用一个通用的实值权重矩阵$W' \\in \\mathbb{R}^{n \\times n}$和一个偏置向量$b' \\in \\mathbb{R}^n$来表示。该能量由下式给出：\n$$E'(x) = - \\sum_{i=1}^n \\sum_{j=1}^n x_i W'_{ij} x_j - \\sum_{i=1}^n b'_i x_i$$\n一个状态$x$的概率由玻尔兹曼分布$p(x) = \\frac{1}{Z} \\exp(-E(x))$给出，其中$Z$是配分函数。由于$p(x)$仅通过指数函数依赖于$E(x)$，任何两个能量函数，如果它们对于所有状态$x$都只相差一个常数，那么它们将产生相同的概率分布。此外，能量函数中任何可以被组合或消除而不改变任何状态$x$的能量值的参数都不是独立的。我们现在将证明，一个由$(W', b')$定义的任意模型可以被重新参数化为一个等价的模型$(W, b)$，其中$W$是对称的（$W=W^\\top$）并且具有零对角线（$\\operatorname{diag}(W)=0$），而不会损失任何表达能力。\n\n首先，我们来分析权重矩阵$W'$的对角线项。我们可以将能量函数中的双重求和分为对角线部分和非对角线部分：\n$$\\sum_{i=1}^n \\sum_{j=1}^n x_i W'_{ij} x_j = \\sum_{i \\neq j} x_i W'_{ij} x_j + \\sum_{i=1}^n x_i W'_{ii} x_i$$\n二元单元$x_i \\in \\{0, 1\\}$的一个关键性质是$x_i^2 = x_i$。将此性质应用于对角线求和，我们得到：\n$$\\sum_{i=1}^n x_i W'_{ii} x_i = \\sum_{i=1}^n W'_{ii} x_i^2 = \\sum_{i=1}^n W'_{ii} x_i$$\n将此代回$E'(x)$的表达式中：\n$$E'(x) = - \\sum_{i \\neq j} x_i W'_{ij} x_j - \\sum_{i=1}^n W'_{ii} x_i - \\sum_{i=1}^n b'_i x_i$$\n我们可以合并这两个线性项：\n$$E'(x) = - \\sum_{i \\neq j} x_i W'_{ij} x_j - \\sum_{i=1}^n (b'_i + W'_{ii}) x_i$$\n这表明对角线权重$W'_{ii}$的影响与偏置$b'_i$的影响是无法区分的。这些项不是可单独识别的。因此，我们可以定义一组新的参数：一个对角线为零的权重矩阵$W''$，和一个新的偏置向量$b$。令$W''_{ij} = W'_{ij}$（当$i \\neq j$），$W''_{ii} = 0$，以及$b_i = b'_i + W'_{ii}$。对于每个状态$x$，能量函数保持不变：\n$$E(x) = - \\sum_{i \\neq j} x_i W''_{ij} x_j - \\sum_{i=1}^n b_i x_i$$\n因此，我们可以强制施加约束$\\operatorname{diag}(W) = 0$而不会损失任何通用性或降低模型的表达能力。这对应于问题中陈述的要求，即排除“从状态空间中无法识别的自相互作用项”。\n\n接下来，我们处理权重矩阵的对称性问题。考虑非对角线求和项$\\sum_{i \\neq j} x_i W''_{ij} x_j$。由于索引$i$和$j$在乘积$x_i x_j$中是对称的（即$x_i x_j = x_j x_i$），我们可以将每对索引$(i, j)$（其中$i \\neq j$）的项组合起来：\n$$x_i W''_{ij} x_j + x_j W''_{ji} x_i = (W''_{ij} + W''_{ji}) x_i x_j$$\n这表明能量函数仅依赖于和$W''_{ij} + W''_{ji}$，而不依赖于$W''_{ij}$和$W''_{ji}$的各自的值。我们可以通过将新矩阵$W$的元素设置为$W''$及其转置中相应元素的平均值来定义一个新的对称权重矩阵$W$：\n$$W_{ij} = \\frac{W''_{ij} + W''_{ji}}{2}$$\n对于这个新矩阵$W$，我们有$W_{ij} = W_{ji}$，所以它是对称的。此外，由于$W''_{ii} = 0$，可以得出$W_{ii} = \\frac{W''_{ii} + W''_{ii}}{2} = 0$，所以$W$的对角线也为零。使用新矩阵$W$时，对$(i, j)$的能量分量是：\n$$\\sum_{k,l \\in \\{i,j\\}, k \\neq l} x_k W_{kl} x_l = x_i W_{ij} x_j + x_j W_{ji} x_i = 2 W_{ij} x_i x_j = (W''_{ij} + W''_{ji}) x_i x_j$$\n这与原始的贡献完全相同。因此，用对称矩阵$W$替换可能非对称的矩阵$W''$不会改变任何状态$x$的能量函数。这证明了强制施加约束$W = W^\\top$的合理性。这与物理直觉相符，即两个单元之间的耦合能量应该由单个参数描述。\n\n既然我们已经确定了对称权重矩阵和零对角线的约束不会减少可表示的概率分布族，我们现在可以计算这种模型中独立参数的数量。\n\n1.  **独立的相互作用权重：** 参数是$n \\times n$矩阵$W$的元素。约束$\\operatorname{diag}(W) = 0$意味着所有$n$个对角线元素都固定为0，不是自由参数。对称性约束$W = W^\\top$意味着对于所有的$i, j$，都有$W_{ij} = W_{ji}$。因此，我们只需要指定矩阵上三角（或下三角）的元素，因为其他元素随之确定。严格上三角（即$i  j$）中的元素数量对应于从$n$个索引集合中选择2个不同索引的方式数，这由二项式系数$\\binom{n}{2}$给出。\n    独立权重数 = $\\binom{n}{2} = \\frac{n(n-1)}{2}$。\n\n2.  **独立的偏置：** 偏置参数是向量$b \\in \\mathbb{R}^n$的分量。对于$n$个单元中的每一个，都有一个偏置参数$b_i$。这些都是独立的。\n    独立偏置数 = $n$。\n\n3.  **独立参数总数：** 模型中独立参数的总数是独立权重数和独立偏置数的和。\n    总参数 = (独立权重数) + (独立偏置数)\n    $$N_{\\text{params}} = \\frac{n(n-1)}{2} + n$$\n    化简这个表达式：\n    $$N_{\\text{params}} = \\frac{n^2 - n}{2} + \\frac{2n}{2} = \\frac{n^2 - n + 2n}{2} = \\frac{n^2 + n}{2}$$\n    这可以写成更紧凑的闭式形式：\n    $$N_{\\text{params}} = \\frac{n(n+1)}{2}$$\n\n这个表达式表示了指定一个具有$n$个二元单元和成对相互作用的通用玻尔兹曼机所需的自由参数总数。",
            "answer": "$$\n\\boxed{\\frac{n(n+1)}{2}}\n$$"
        },
        {
            "introduction": "在掌握了通用玻尔兹曼机的基础之后，我们将注意力转向其更具实践意义的变体——受限玻尔兹曼机（RBM）。RBM 的核心特征是其二分图结构，这一结构带来了至关重要的条件独立性。这个动手练习旨在通过为一个小型 RBM 具体计算条件概率，并验证其可分解为独立伯努利分布的乘积，从而将抽象的条件独立性概念变得具体化 。",
            "id": "4038508",
            "problem": "考虑一个二值受限玻尔兹曼机 (RBM)，它有 $n_v=2$ 个可见单元和 $n_h=2$ 个隐藏单元。可见单元为 $v=(v_1,v_2)\\in\\{0,1\\}^2$，隐藏单元为 $h=(h_1,h_2)\\in\\{0,1\\}^2$，能量函数定义为\n$$\nE(v,h)=-\\sum_{i=1}^{2} a_i v_i-\\sum_{j=1}^{2} b_j h_j-\\sum_{i=1}^{2}\\sum_{j=1}^{2} v_i W_{ij} h_j.\n$$\n$(v,h)$ 上的联合分布由玻尔兹曼分布 $P(v,h)=\\exp(-E(v,h))/Z$ 给出，其中 $Z$ 是配分函数。\n\n设参数为\n$$\na=\\begin{pmatrix}0.3\\\\-0.1\\end{pmatrix},\\quad b=\\begin{pmatrix}0.2\\\\0.4\\end{pmatrix},\\quad W=\\begin{pmatrix}0.7  -0.5\\\\ -0.3  0.6\\end{pmatrix}.\n$$\n\n任务：\n1. 从玻尔兹曼分布和给定的能量函数出发，为任意 $v\\in\\{0,1\\}^2$ 推导出条件分布 $P(h\\mid v)$ 的显式表达式，且不作任何先验的特殊因式分解假设。\n2. 仅利用能量函数中编码的二分图结构，从第一性原理证明，在给定 $v$ 的条件下，隐藏单元是条件独立的，并确定由此产生的伯努利乘积形式的参数化。\n3. 枚举所有 $16$ 种配置 $(v,h)\\in\\{0,1\\}^2\\times\\{0,1\\}^2$，并计算相应的能量 $E(v,h)$ 和未归一化的权重 $\\exp(-E(v,h))$。对于每个固定的 $v$，对四个隐藏状态 $h$ 进行显式归一化以得到 $P(h\\mid v)$，并验证其结果与任务 2 中得到的伯努利乘积形式相等。\n4. 对于特定的可见配置 $v=(1,0)$，计算 $P(h_1=1\\mid v)$ 的精确值。\n\n将 $P(h_1=1\\mid v=(1,0))$ 的精确表达式作为最终答案报告，用指数函数表示。请勿进行数值近似。不需要单位。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n**问题验证**\n\n1.  **提取已知条件**：\n    -   一个受限玻尔兹曼机 (RBM)，有 $n_v=2$ 个可见单元 $v=(v_1,v_2)\\in\\{0,1\\}^2$ 和 $n_h=2$ 个隐藏单元 $h=(h_1,h_2)\\in\\{0,1\\}^2$。\n    -   能量函数：$E(v,h)=-\\sum_{i=1}^{2} a_i v_i-\\sum_{j=1}^{2} b_j h_j-\\sum_{i=1}^{2}\\sum_{j=1}^{2} v_i W_{ij} h_j$。\n    -   联合分布：$P(v,h)=\\exp(-E(v,h))/Z$。\n    -   参数：$a=\\begin{pmatrix}0.3\\\\-0.1\\end{pmatrix}$，$b=\\begin{pmatrix}0.2\\\\0.4\\end{pmatrix}$，$W=\\begin{pmatrix}0.7  -0.5\\\\ -0.3  0.6\\end{pmatrix}$。\n    -   任务是推导 $P(h\\mid v)$，证明隐藏单元的条件独立性，通过枚举所有 16 个状态来验证此性质，并计算一个特定的条件概率。\n\n2.  **使用提取的已知条件进行验证**：\n    -   **科学依据**：该问题是 RBM 理论中的一个标准练习，RBM 理论是机器学习和计算神经科学的核心主题。其定义和模型都是标准的。\n    -   **良定义**：问题被完全指定，包含所有必需的参数和定义。每个任务都陈述清晰，并导向一个唯一的、可验证的解。\n    -   **客观性**：问题使用精确的数学语言表述，不含任何主观或模棱两可的陈述。\n    -   一个有效问题的所有其他标准都已满足。没有矛盾、缺失数据或不切实际的假设。\n\n3.  **结论与行动**：问题被判定为有效。将提供完整的解答。\n\n**解答**\n\n**任务 1：推导条件分布 $P(h\\mid v)$**\n\n条件分布 $P(h\\mid v)$ 定义为 $P(h\\mid v) = \\frac{P(v,h)}{P(v)}$。联合概率为 $P(v,h) = \\frac{1}{Z}\\exp(-E(v,h))$，可见单元的边缘概率为 $P(v) = \\sum_{h'} P(v,h') = \\frac{1}{Z}\\sum_{h'} \\exp(-E(v,h'))$。\n将这些代入定义中得到：\n$$\nP(h\\mid v) = \\frac{\\frac{1}{Z}\\exp(-E(v,h))}{\\frac{1}{Z}\\sum_{h'} \\exp(-E(v,h'))} = \\frac{\\exp(-E(v,h))}{\\sum_{h'} \\exp(-E(v,h'))}\n$$\n能量函数为 $E(v,h) = -\\sum_{i} a_i v_i - \\sum_{j} b_j h_j - \\sum_{i,j} v_i W_{ij} h_j$。我们可以将其写为 $E(v,h) = E_v(v) + E_h(h) + E_{vh}(v,h)$，其中各项分别只依赖于 $v$、只依赖于 $h$、以及同时依赖于两者。然而，对于此计算，一个更有用的划分是区分依赖于 $h$ 的项和不依赖于 $h$ 的项。\n让我们将能量函数代入 $P(h\\mid v)$ 的表达式中：\n$$\nP(h\\mid v) = \\frac{\\exp\\left(\\sum_{i} a_i v_i + \\sum_{j} b_j h_j + \\sum_{i,j} v_i W_{ij} h_j\\right)}{\\sum_{h'} \\exp\\left(\\sum_{i} a_i v_i + \\sum_{j} b_j h'_j + \\sum_{i,j} v_i W_{ij} h'_j\\right)}\n$$\n项 $\\exp(\\sum_{i} a_i v_i)$ 相对于分母中的求和变量 $h'$ 是一个常数。因此，它可以从分子和分母中被因子提出并消去：\n$$\nP(h\\mid v) = \\frac{\\exp(\\sum_{i} a_i v_i) \\exp\\left(\\sum_{j} b_j h_j + \\sum_{i,j} v_i W_{ij} h_j\\right)}{\\exp(\\sum_{i} a_i v_i) \\sum_{h'} \\exp\\left(\\sum_{j} b_j h'_j + \\sum_{i,j} v_i W_{ij} h'_j\\right)}\n$$\n这简化为条件分布的最终表达式：\n$$\nP(h\\mid v) = \\frac{\\exp\\left(\\sum_{j} b_j h_j + \\sum_{j} \\left(\\sum_{i} v_i W_{ij}\\right) h_j\\right)}{\\sum_{h'} \\exp\\left(\\sum_{j} b_j h'_j + \\sum_{j} \\left(\\sum_{i} v_i W_{ij}\\right) h'_j\\right)}\n$$\n\n**任务 2：证明隐藏单元的条件独立性**\n\n能量函数的结构是关键。它没有任何 $j \\neq k$ 时 $h_j h_k$ 形式的项，这代表了 RBM 的二分图结构。我们可以利用这一点来证明条件独立性。从任务 1 的结果出发，我们来分析分子中的指数：\n$$\n\\sum_{j} b_j h_j + \\sum_{j} \\left(\\sum_{i} v_i W_{ij}\\right) h_j = \\sum_{j} \\left(b_j + \\sum_{i} v_i W_{ij}\\right) h_j\n$$\n这个表达式是关于隐藏单元 $j$ 的总和，其中每一项只涉及单个 $h_j$。我们为每个隐藏单元 $j$ 定义一个有效偏置，它依赖于可见层 $v$ 的状态：\n$$\n\\theta_j(v) = b_j + \\sum_{i=1}^{2} v_i W_{ij}\n$$\n指数中的表达式变为 $\\sum_{j=1}^{2} \\theta_j(v) h_j$。条件分布为：\n$$\nP(h\\mid v) = \\frac{\\exp\\left(\\sum_{j=1}^{2} \\theta_j(v) h_j\\right)}{\\sum_{h' \\in \\{0,1\\}^2} \\exp\\left(\\sum_{j=1}^{2} \\theta_j(v) h'_j\\right)}\n$$\n分子可以分解为关于 $j$ 的乘积：$\\exp\\left(\\sum_{j} \\theta_j(v) h_j\\right) = \\prod_{j} \\exp(\\theta_j(v) h_j)$。\n分母是关于 $h'=(h'_1, h'_2)$ 的所有 $2^2=4$ 个状态的总和。这个和也可以被因式分解：\n$$\n\\sum_{h'_1 \\in \\{0,1\\}} \\sum_{h'_2 \\in \\{0,1\\}} \\exp(\\theta_1(v) h'_1 + \\theta_2(v) h'_2) = \\sum_{h'_1, h'_2} \\exp(\\theta_1(v) h'_1) \\exp(\\theta_2(v) h'_2)\n$$\n$$\n= \\left( \\sum_{h'_1 \\in \\{0,1\\}} \\exp(\\theta_1(v) h'_1) \\right) \\left( \\sum_{h'_2 \\in \\{0,1\\}} \\exp(\\theta_2(v) h'_2) \\right) = \\prod_{j=1}^{2} \\left(\\sum_{h'_j \\in \\{0,1\\}} \\exp(\\theta_j(v) h'_j)\\right)\n$$\n这个乘积中的每一项是 $\\exp(\\theta_j(v) \\cdot 0) + \\exp(\\theta_j(v) \\cdot 1) = 1 + \\exp(\\theta_j(v))$。\n所以分母是 $\\prod_{j=1}^{2} (1 + \\exp(\\theta_j(v)))$。\n结合因式分解后的分子和分母：\n$$\nP(h\\mid v) = \\frac{\\prod_{j=1}^{2} \\exp(\\theta_j(v) h_j)}{\\prod_{j=1}^{2} (1 + \\exp(\\theta_j(v)))} = \\prod_{j=1}^{2} \\frac{\\exp(\\theta_j(v) h_j)}{1 + \\exp(\\theta_j(v))}\n$$\n这表明 $P(h\\mid v)$ 是每个隐藏单元分布的乘积，即 $P(h\\mid v) = P(h_1\\mid v) P(h_2\\mid v)$。这就是条件独立性的定义。\n对于单个隐藏单元 $h_j$ 的项是：\n$$\nP(h_j\\mid v) = \\frac{\\exp(\\theta_j(v) h_j)}{1 + \\exp(\\theta_j(v))}\n$$\n当 $h_j=1$ 时，我们得到 $P(h_j=1\\mid v) = \\frac{\\exp(\\theta_j(v))}{1 + \\exp(\\theta_j(v))} = \\frac{1}{1 + \\exp(-\\theta_j(v))}$，这就是 logistic sigmoid 函数 $\\sigma(\\theta_j(v))$。\n当 $h_j=0$ 时，我们得到 $P(h_j=0\\mid v) = \\frac{1}{1 + \\exp(\\theta_j(v))} = 1 - \\sigma(\\theta_j(v))$。\n因此，每个隐藏单元 $h_j$ 服从参数为 $p_j = \\sigma(\\theta_j(v))$ 的伯努利分布。分布 $P(h\\mid v)$ 是这些伯努利分布的乘积。其参数化由 $p_j = \\sigma(b_j + \\sum_i v_i W_{ij})$ 给出，其中 $j=1,2$。\n\n**任务 3：枚举和验证**\n\n我们计算所有 16 种 $(v,h)$ 配置下的能量 $E(v,h) = -(a_1 v_1 + a_2 v_2) - (b_1 h_1 + b_2 h_2) - (v_1W_{11}h_1 + v_1W_{12}h_2 + v_2W_{21}h_1 + v_2W_{22}h_2)$ 和未归一化的概率质量 $\\exp(-E(v,h))$。\n\n首先，我们计算每个 $v$ 的有效偏置 $\\theta_j(v) = b_j + v_1 W_{1j} + v_2 W_{2j}$。\n-   $v=(0,0)$: $\\theta_1=b_1=0.2$, $\\theta_2=b_2=0.4$。\n-   $v=(0,1)$: $\\theta_1=b_1+W_{21}=0.2-0.3=-0.1$, $\\theta_2=b_2+W_{22}=0.4+0.6=1.0$。\n-   $v=(1,0)$: $\\theta_1=b_1+W_{11}=0.2+0.7=0.9$, $\\theta_2=b_2+W_{12}=0.4-0.5=-0.1$。\n-   $v=(1,1)$: $\\theta_1=b_1+W_{11}+W_{21}=0.2+0.7-0.3=0.6$, $\\theta_2=b_2+W_{12}+W_{22}=0.4-0.5+0.6=0.5$。\n\n现在，我们枚举所有 16 个状态。项 $-E(v,h)$ 等于 $a^T v + \\theta_1(v) h_1 + \\theta_2(v) h_2$。\n\n| $v_1$ | $v_2$ | $h_1$ | $h_2$ | $a^Tv$ | $\\theta_1 h_1+\\theta_2 h_2$ | $-E(v,h)$ | $E(v,h)$ | $\\exp(-E(v,h))$ |\n|---|---|---|---|---|---|---|---|---|\n| $0$ | $0$ | $0$ | $0$ | $0.0$ | $0.0$ | $0.0$ | $0.0$ | $\\exp(0.0) = 1$ |\n| $0$ | $0$ | $0$ | $1$ | $0.0$ | $0.4$ | $0.4$ | $-0.4$ | $\\exp(0.4)$ |\n| $0$ | $0$ | $1$ | $0$ | $0.0$ | $0.2$ | $0.2$ | $-0.2$ | $\\exp(0.2)$ |\n| $0$ | $0$ | $1$ | $1$ | $0.0$ | $0.6$ | $0.6$ | $-0.6$ | $\\exp(0.6)$ |\n| $0$ | $1$ | $0$ | $0$ | $-0.1$ | $0.0$ | $-0.1$ | $0.1$ | $\\exp(-0.1)$ |\n| $0$ | $1$ | $0$ | $1$ | $-0.1$ | $1.0$ | $0.9$ | $-0.9$ | $\\exp(0.9)$ |\n| $0$ | $1$ | $1$ | $0$ | $-0.1$ | $-0.1$ | $-0.2$ | $0.2$ | $\\exp(-0.2)$ |\n| $0$ | $1$ | $1$ | $1$ | $-0.1$ | $0.9$ | $0.8$ | $-0.8$ | $\\exp(0.8)$ |\n| $1$ | $0$ | $0$ | $0$ | $0.3$ | $0.0$ | $0.3$ | $-0.3$ | $\\exp(0.3)$ |\n| $1$ | $0$ | $0$ | $1$ | $0.3$ | $-0.1$ | $0.2$ | $-0.2$ | $\\exp(0.2)$ |\n| $1$ | $0$ | $1$ | $0$ | $0.3$ | $0.9$ | $1.2$ | $-1.2$ | $\\exp(1.2)$ |\n| $1$ | $0$ | $1$ | $1$ | $0.3$ | $0.8$ | $1.1$ | $-1.1$ | $\\exp(1.1)$ |\n| $1$ | $1$ | $0$ | $0$ | $0.2$ | $0.0$ | $0.2$ | $-0.2$ | $\\exp(0.2)$ |\n| $1$ | $1$ | $0$ | $1$ | $0.2$ | $0.5$ | $0.7$ | $-0.7$ | $\\exp(0.7)$ |\n| $1$ | $1$ | $1$ | $0$ | $0.2$ | $0.6$ | $0.8$ | $-0.8$ | $\\exp(0.8)$ |\n| $1$ | $1$ | $1$ | $1$ | $0.2$ | $1.1$ | $1.3$ | $-1.3$ | $\\exp(1.3)$ |\n\n对每个固定的 $v$ 进行验证：\n对于固定的 $v$，$P(h\\mid v) = \\frac{\\exp(-E(v,h))}{\\sum_{h'}\\exp(-E(v,h'))}$。我们来验证 $v=(1,0)$ 的情况。\n从表中可知，对于 $v=(1,0)$，未归一化的概率为 $\\exp(0.3)$、$\\exp(0.2)$、$\\exp(1.2)$、$\\exp(1.1)$。\n归一化常数为 $Z_{(1,0)} = \\exp(0.3) + \\exp(0.2) + \\exp(1.2) + \\exp(1.1)$。\n$P(h=(1,1)\\mid v=(1,0)) = \\frac{\\exp(1.1)}{\\exp(0.3) + \\exp(0.2) + \\exp(1.2) + \\exp(1.1)}$。\n根据任务 2，$P(h\\mid v) = P(h_1\\mid v)P(h_2\\mid v)$，其中 $P(h_j=1\\mid v) = \\sigma(\\theta_j(v))$。对于 $v=(1,0)$，$\\theta_1=0.9, \\theta_2=-0.1$。\n所以，$P(h_1=1\\mid v)=\\sigma(0.9)$，$P(h_2=1\\mid v)=\\sigma(-0.1)$。\n$P(h_1=0\\mid v)=1-\\sigma(0.9)$，$P(h_2=0\\mid v)=1-\\sigma(-0.1)$。\n$P(h=(1,1)\\mid v=(1,0)) = \\sigma(0.9)\\sigma(-0.1) = \\left(\\frac{\\exp(0.9)}{1+\\exp(0.9)}\\right)\\left(\\frac{\\exp(-0.1)}{1+\\exp(-0.1)}\\right) = \\frac{\\exp(0.8)}{(1+\\exp(0.9))(1+\\exp(-0.1))}$。\n来自显式求和的分母是 $Z_{(1,0)} = \\exp(0.3)[1 + \\exp(-0.1) + \\exp(0.9) + \\exp(0.8)] = \\exp(0.3)[(1+\\exp(0.9))(1+\\exp(-0.1))]$。\n分子是 $\\exp(1.1) = \\exp(0.3)\\exp(0.8)$。\n所以，$P(h=(1,1)\\mid v=(1,0)) = \\frac{\\exp(0.3)\\exp(0.8)}{\\exp(0.3)(1+\\exp(0.9))(1+\\exp(-0.1))} = \\frac{\\exp(0.8)}{(1+\\exp(0.9))(1+\\exp(-0.1))}$。\n结果吻合。通过类似的计算，验证对所有其他的 $(v,h)$ 组合都成立，从而证实了伯努利乘积形式。\n\n**任务 4：计算 $P(h_1=1\\mid v=(1,0))$**\n\n我们需要为特定的可见配置 $v=(1,0)$ 计算 $P(h_1=1\\mid v)$。\n使用任务 2 中推导出的公式：\n$$\nP(h_1=1\\mid v) = \\sigma\\left(b_1 + \\sum_{i=1}^{2} v_i W_{i1}\\right)\n$$\n对于 $v=(1,0)$，我们有 $v_1=1$ 和 $v_2=0$。\nsigmoid 函数的自变量是：\n$$\n\\theta_1(1,0) = b_1 + v_1 W_{11} + v_2 W_{21} = 0.2 + (1)(0.7) + (0)(-0.3) = 0.2 + 0.7 = 0.9\n$$\n将此值代入 sigmoid 函数：\n$$\nP(h_1=1\\mid v=(1,0)) = \\sigma(0.9) = \\frac{1}{1 + \\exp(-0.9)}\n$$\n这就是最终的精确表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{1 + \\exp(-0.9)}}\n$$"
        }
    ]
}