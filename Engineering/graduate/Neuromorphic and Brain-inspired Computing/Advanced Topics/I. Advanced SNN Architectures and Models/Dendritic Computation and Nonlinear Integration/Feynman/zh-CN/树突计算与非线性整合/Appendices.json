{
    "hands_on_practices": [
        {
            "introduction": "要理解树突复杂的计算能力，我们必须首先掌握无源信号传播的基础。无源电缆模型为我们提供了一个基本框架，用以理解在没有主动通道的情况下电压如何传播和衰减。这项练习  要求您推导简化树突中的稳态电压分布，从而巩固您对长度常数（$ \\lambda $）和输入电阻（$ R_{\\infty} $）等关键参数的理解。",
            "id": "4042593",
            "problem": "考虑一个被建模为一维半无限长电缆的无源树突段，其占据 $x \\ge 0$ 的空间，具有恒定的单位长度轴向电阻 $r_i$ 和单位长度膜电阻 $r_m$，两者均为正且有限。电缆在其周向上是等电位的，轴向电流仅沿 $x$ 轴流动。假设在稳态下，膜表现为线性漏电，没有主动电导，并且电缆的属性在空间上是均匀的。\n\n在边界 $x=0$ 处，一个恒定的直流电流 $I_0$ 被注入到电缆内部。电缆延伸至无穷远，因此当 $x \\to \\infty$ 时，电压保持有界。轴向电流通过欧姆定律与轴向电压梯度相关联，并且电流守恒在电缆上局部适用。将电缆长度常数和特性阻抗定义为\n$$\\lambda = \\sqrt{\\frac{r_m}{r_i}}, \\qquad Z_0 = \\sqrt{r_m r_i}.$$\n\n仅使用这些定义以及支配电阻电路和电流守恒的基本定律，推导 $x \\ge 0$ 的稳态电压分布 $V(x)$，并仅用 $I_0$、$\\lambda$ 和 $Z_0$ 表示您的最终答案。您的答案必须是 $V(x)$ 的单个闭合形式解析表达式。不需要四舍五入，并且您的最终表达式中不应包含单位。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 步骤1：提取已知条件\n- **模型**：一个无源树突段。\n- **几何**：一个占据域 $x \\ge 0$ 的一维半无限长电缆。\n- **物理属性**：\n    - 恒定的单位长度轴向电阻：$r_i$。\n    - 恒定的单位长度膜电阻：$r_m$。\n    - $r_i$ 和 $r_m$ 均为正且有限。\n- **假设**：\n    - 电缆在其周向上是等电位的。\n    - 轴向电流仅沿 $x$ 轴流动。\n    - 在稳态下，膜表现为线性漏电。\n    - 不存在主动电导。\n    - 电缆属性在空间上是均匀的。\n- **边界条件**：\n    - 在 $x=0$ 处，注入一个恒定的直流电流 $I_0$。\n    - 当 $x \\to \\infty$ 时，电压 $V(x)$ 保持有界。\n- **支配定律**：\n    - 轴向电流通过欧姆定律与轴向电压梯度相关联。\n    - 电流守恒在电缆上局部适用。\n- **定义**：\n    - 电缆长度常数：$\\lambda = \\sqrt{\\frac{r_m}{r_i}}$。\n    - 特性阻抗：$Z_0 = \\sqrt{r_m r_i}$。\n- **目标**：推导 $x \\ge 0$ 的稳态电压分布 $V(x)$，并仅用 $I_0$、$\\lambda$ 和 $Z_0$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了标准的无源电缆模型，这是计算神经科学和生物物理学中的一个基本概念，源于电学原理（欧姆定律、基尔霍夫定律）。该模型在科学上是合理的。\n2.  **适定性**：该问题提供了一个二阶线性常微分方程（将要推导得出），并附有两个边界条件（$x=0$ 处的电流注入条件和 $x \\to \\infty$ 处的有界性条件）。这足以确定一个唯一且稳定的解。\n3.  **目标**：问题使用精确、无歧义的技术语言陈述。\n4.  **缺陷检查清单**：该问题未违反任何无效性标准。它在科学上是合理的，可形式化的，完整的，在其模型假设下是物理上可信的，并且是适定的。\n\n### 步骤3：结论与行动\n问题有效。将继续求解过程。\n\n我们首先建立支配电缆上稳态电压 $V(x)$ 的微分方程。考虑在位置 $x$ 处电缆的一个长度为 $dx$ 的无穷小段。\n\n设 $V(x)$ 为位置 $x$ 处的胞内电压，相对于电缆外的接地电位。设 $I_{ax}(x)$ 为电缆内部沿正 $x$ 方向流动的轴向电流。\n\n根据欧姆定律，通过该段轴向电阻（即 $r_i dx$）的电压降 $dV$ 由下式给出：\n$$dV = -I_{ax}(x) (r_i dx)$$\n用微分形式，这表示了轴向电流和电压梯度之间的关系：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\frac{dV}{dx} \\quad (1)$$\n\n接下来，我们将电流守恒原理应用于这个无穷小段。在长度 $dx$ 上的轴向电流变化，即 $dI_{ax} = I_{ax}(x+dx) - I_{ax}(x)$，必须等于通过该段膜漏出的电流。膜电流用 $I_m$ 表示。\n通过该段膜流出的电流由欧姆定律给出，其中跨膜电压为 $V(x)$，该膜段的电阻为 $r_m/dx$。因此，流出的电流为 $I_m = \\frac{V(x)}{r_m/dx} = \\frac{V(x)}{r_m} dx$。\n根据电流守恒，进入 $x$ 处该段的电流必须等于在 $x+dx$ 处流出的电流与通过膜漏出的电流之和：\n$$I_{ax}(x) = I_{ax}(x+dx) + \\frac{V(x)}{r_m}dx$$\n重新整理并取 $dx \\to 0$ 的极限，我们得到：\n$$-\\frac{I_{ax}(x+dx) - I_{ax}(x)}{dx} = \\frac{V(x)}{r_m}$$\n这得到了第二个微分关系：\n$$-\\frac{dI_{ax}}{dx} = \\frac{V(x)}{r_m} \\quad (2)$$\n\n为了得到一个关于 $V(x)$ 的单一方程，我们对等式 (1) 关于 $x$ 求导：\n$$\\frac{dI_{ax}}{dx} = -\\frac{1}{r_i}\\frac{d^2V}{dx^2}$$\n将此代入等式 (2) 得到：\n$$- \\left(-\\frac{1}{r_i}\\frac{d^2V}{dx^2}\\right) = \\frac{V(x)}{r_m}$$\n$$\\frac{1}{r_i}\\frac{d^2V}{dx^2} = \\frac{V(x)}{r_m}$$\n重新整理此方程得到稳态电缆方程：\n$$\\frac{d^2V}{dx^2} - \\frac{r_i}{r_m}V(x) = 0$$\n使用所给的长度常数定义 $\\lambda = \\sqrt{r_m/r_i}$，我们有 $\\frac{1}{\\lambda^2} = \\frac{r_i}{r_m}$。方程变为：\n$$\\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2}V(x) = 0$$\n这是一个二阶线性齐次常微分方程。其特征方程为 $k^2 - \\frac{1}{\\lambda^2} = 0$，根为 $k = \\pm \\frac{1}{\\lambda}$。因此，通解为：\n$$V(x) = A \\exp\\left(\\frac{x}{\\lambda}\\right) + B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n第一个边界条件是当 $x \\to \\infty$ 时电压保持有界。项 $A \\exp\\left(\\frac{x}{\\lambda}\\right)$ 随着 $x \\to \\infty$ 无界增长（因为 $\\lambda > 0$）。为满足边界条件，其系数必须为零，即 $A=0$。解简化为：\n$$V(x) = B \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n\n第二个边界条件是在 $x=0$ 处注入电流 $I_0$。此注入电流必须等于离开注入点的轴向电流，即 $I_{ax}(0) = I_0$。我们使用等式 (1) 将 $I_{ax}$ 与 $V(x)$ 相关联：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\frac{dV}{dx}$$\n首先，我们计算 $V(x)$ 简化解的导数：\n$$\\frac{dV}{dx} = \\frac{d}{dx}\\left[B \\exp\\left(-\\frac{x}{\\lambda}\\right)\\right] = -\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n将此代入 $I_{ax}(x)$ 的表达式中：\n$$I_{ax}(x) = -\\frac{1}{r_i}\\left(-\\frac{B}{\\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)\\right) = \\frac{B}{r_i \\lambda}\\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n现在我们应用在 $x=0$ 处的边界条件：\n$$I_0 = I_{ax}(0) = \\frac{B}{r_i \\lambda}\\exp(0) = \\frac{B}{r_i \\lambda}$$\n我们现在可以解出常数 $B$：\n$$B = I_0 r_i \\lambda$$\n\n将 $B$ 的这个表达式代回 $V(x)$ 的解中：\n$$V(x) = (I_0 r_i \\lambda) \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n最后一步是仅使用给定的参数 $I_0$、$\\lambda$ 和 $Z_0$ 来表示这个结果。我们有定义 $\\lambda = \\sqrt{r_m/r_i}$ 和 $Z_0 = \\sqrt{r_m r_i}$。我们来考察项 $r_i \\lambda$：\n$$r_i \\lambda = r_i \\sqrt{\\frac{r_m}{r_i}} = \\sqrt{r_i^2 \\frac{r_m}{r_i}} = \\sqrt{r_i r_m}$$\n这与特性阻抗 $Z_0$ 的定义完全相同。因此，$r_i \\lambda = Z_0$。\n\n将 $r_i \\lambda$ 替换为 $Z_0$ 代入我们 $V(x)$ 的表达式中，得到最终答案：\n$$V(x) = I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)$$\n这个稳态电压分布 $V(x)$ 的表达式仅用指定的量 $I_0$、$Z_0$ 和 $\\lambda$ 表示。",
            "answer": "$$\\boxed{I_0 Z_0 \\exp\\left(-\\frac{x}{\\lambda}\\right)}$$"
        },
        {
            "introduction": "树突远不止是无源的电线；它们是主动的计算单元。引入电压依赖性通道（例如NMDA受体）会产生丰富的非线性动力学。这项练习  探讨了NMDA电流的正反馈如何在树突隔室中产生双稳态，从而有效地将其转变为一个局部记忆开关。通过分析系统的定点及其稳定性，您将揭示实现这种基本形式的树突计算所需的精确条件。",
            "id": "4042571",
            "problem": "考虑一个接收谷氨酸能输入的单个等电位树突微区，该输入激活N-甲基-D-天冬氨酸（NMDA）受体。局部膜电压 $V$ 遵循一个电流平衡方程，该方程包含一个被动漏电流和一个NMDA介导的电流，后者的电压依赖性源于镁离子阻断的解除。在相关的操作范围内，将这种电压依赖性近似为指数形式，得到以下一维动力学系统：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}},\n$$\n其中 $C$ 是膜电容，$g_{L}$ 是漏电导，$E_{L}$ 是漏电逆转电位，$g_{N}$ 是最大NMDA电导，$s \\in (0,1]$ 是NMDA受体开放概率的谷氨酸门控因子，$\\lambda>0$ 是参数化镁离子解除阻断所致电压依赖性的参数，$E_{N}$ 是NMDA逆转电位，$I_{\\mathrm{ext}}$ 是外部注入电流。\n\n从不动点及其线性稳定性的定义出发，并且不使用任何快捷公式，执行以下操作：\n\n1. 通过将方程右侧设为零来推导不动点条件，并根据右侧对 $V$ 的导数得到稳定性判据。证明双稳态的起始是通过鞍结分岔发生的，此时存在一个电压 $V^{\\star}$，使得不动点条件及其对 $V$ 的导数同时为零。引入 $x \\equiv E_{N} - V$ 和 $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$，并证明鞍结条件简化为一个关于 $x$ 的二次方程，其判别式要求 $B \\geq 4/\\lambda$ 作为双稳态的不等式条件。\n\n2. 使用鞍结条件，推导在尖点边界（两个鞍结点合并之处）的临界NMDA最大电导 $g_{N}^{\\star}$ 的闭式表达式，该表达式仅用生物物理参数 $g_{L}$、$s$、$\\lambda$ 和 $E_{N}$ 表示。\n\n3. 使用以下参数值计算您的 $g_{N}^{\\star}$ 表达式：$g_{L} = 0.1\\,\\mu\\mathrm{S}$，$E_{L} = -65\\,\\mathrm{mV}$，$E_{N} = 0\\,\\mathrm{mV}$，$s = 0.3$，以及 $\\lambda = 0.062\\,\\mathrm{mV}^{-1}$。假设外部电流被精确设置在使双稳态阈值最小化的尖点值。将您的最终 $g_{N}^{\\star}$ 数值结果四舍五入到四位有效数字。最终电导以 $\\mu\\mathrm{S}$ 为单位表示。",
            "solution": "该问题要求分析一个由以下膜电压 $V$ 的常微分方程所描述的单个等电位树突微区模型的双稳态性：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\n我们定义函数 $f(V)$ 为方程的右侧，代表跨膜的总电流：\n$$\nf(V) = -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;+\\; g_{N}\\,s\\,\\exp\\!\\big(\\lambda V\\big)\\,\\big(E_{N} - V\\big) \\;+\\; I_{\\mathrm{ext}}\n$$\n因此，该动力学系统为 $\\frac{dV}{dt} = \\frac{1}{C}f(V)$。\n\n**1. 不动点、稳定性与鞍结分岔**\n\n系统的一个不动点（或稳态）是电压 $V_{fp}$，在该点净电流为零，意味着电压不随时间变化。这由条件 $\\frac{dV}{dt} = 0$ 给出，等价于 $f(V_{fp}) = 0$。\n\n不动点 $V_{fp}$ 的线性稳定性由 $f(V)$ 在该点的导数 $f'(V_{fp})$ 的符号决定。如果 $f'(V_{fp})  0$，则不动点是稳定的；如果 $f'(V_{fp})  0$，则不动点是不稳定的。$f(V)$ 对 $V$ 的导数是：\n$$\nf'(V) = \\frac{df}{dV} = \\frac{d}{dV} \\left[ -g_{L}V + g_{L}E_{L} + g_{N}s\\exp(\\lambda V)(E_{N} - V) + I_{\\mathrm{ext}} \\right]\n$$\n对NMDA电流项使用乘积法则：\n$$\nf'(V) = -g_{L} + g_{N}s \\left[ \\left( \\lambda \\exp(\\lambda V) \\right) (E_{N} - V) + \\exp(\\lambda V) (-1) \\right]\n$$\n$$\nf'(V) = -g_{L} - g_{N}s\\exp(\\lambda V) \\left[ 1 - \\lambda(E_{N} - V) \\right]\n$$\n双稳态的起始是通过鞍结分岔发生的。在这样的分岔点，一个稳定不动点和一个不稳定不动点合并并消失。在数学上，这对应于 $f(V)$ 的曲线在某个电压 $V^{\\star}$ 处与电压轴相切。该切点同时满足作为不动点的条件和稳定与不稳定之间转换的条件（$f'(V^{\\star}) = 0$）。因此，鞍结分岔的两个条件是：\n1. $f(V^{\\star}) = 0$\n2. $f'(V^{\\star}) = 0$\n\n现在我们按规定引入变量替换：$x \\equiv E_{N} - V$ 和 $B \\equiv (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$。根据第一个定义，我们有 $V = E_{N} - x$。让我们用这些新变量重写这两个鞍结条件。\n\n第一个条件，$f(V^{\\star}) = 0$，是：\n$$\n-g_{L}(V^{\\star} - E_{L}) + g_{N}s\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) + I_{\\mathrm{ext}} = 0\n$$\n整理并除以 $g_{L}$ 得到：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda V^{\\star})(E_{N} - V^{\\star}) = (V^{\\star} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\n代入 $V^{\\star} = E_{N} - x$ 和 $E_{N} - V^{\\star} = x$：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda (E_{N} - x))x = (E_{N} - x - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}}\n$$\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = \\left[ (E_{N} - E_{L}) - \\frac{I_{\\mathrm{ext}}}{g_{L}} \\right] - x\n$$\n使用 $B$ 的定义，我们得到：\n$$\n\\frac{g_{N}s}{g_{L}}\\exp(\\lambda(E_{N}-x))x = B - x\n$$\n\n第二个条件，$f'(V^{\\star}) = 0$，是：\n$$\n-g_{L} - g_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\n$$\ng_{N}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = -g_{L}\n$$\n代入 $V^{\\star} = E_{N} - x$ 和 $E_{N} - V^{\\star} = x$：\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x))[1 - \\lambda x] = -g_{L}\n$$\n假设 $1 - \\lambda x \\neq 0$，我们可以写出：\n$$\ng_{N}s\\exp(\\lambda(E_{N}-x)) = -\\frac{g_{L}}{1 - \\lambda x}\n$$\n现在，将此表达式代入变换后的第一个条件：\n$$\n\\left( -\\frac{g_{L}}{g_{L}(1 - \\lambda x)} \\right) x = B - x\n$$\n$$\n-\\frac{x}{1 - \\lambda x} = B - x\n$$\n两边乘以 $(1 - \\lambda x)$ 以消去分母：\n$$\n-x = (B - x)(1 - \\lambda x)\n$$\n$$\n-x = B - B\\lambda x - x + \\lambda x^2\n$$\n$$\n0 = B - B\\lambda x + \\lambda x^2\n$$\n整理后得到所需的关于 $x$ 的二次方程：\n$$\n\\lambda x^2 - B\\lambda x + B = 0\n$$\n为了使这个二次方程有关于 $x$ 的实数解（这些解对应于可能发生鞍结分岔的电压），其判别式 $\\Delta$ 必须为非负数。\n$$\n\\Delta = (-B\\lambda)^2 - 4(\\lambda)(B) = B^2\\lambda^2 - 4\\lambda B \\geq 0\n$$\n因为 $\\lambda  0$，我们可以除以 $\\lambda$：\n$$\nB^2\\lambda - 4B \\geq 0 \\implies B(B\\lambda - 4) \\geq 0\n$$\n在促进双稳态的生理学背景下，参数 $B = (E_{N} - E_{L}) - I_{\\mathrm{ext}}/g_{L}$ 通常为正（$E_{N}  E_{L}$ 且 $I_{\\mathrm{ext}}$ 不是强超极化电流）。假设 $B  0$，该不等式成立当且仅当：\n$$\nB\\lambda - 4 \\geq 0 \\implies B \\geq \\frac{4}{\\lambda}\n$$\n这个不等式是关于组合的外部和突触驱动的条件，以使双稳态成为可能。\n\n**2. 尖点处的临界电导**\n\n尖点边界代表了双稳态所需的最低条件。它是两个不同的鞍结分岔点合并为一个点的地方。这发生在关于 $x$ 的二次方程的判别式恰好为零时，即 $\\Delta = 0$。\n$$\nB(B\\lambda - 4) = 0\n$$\n由于 $B=0$ 不是一个能导致双稳态的有生物物理意义的解（它会导致 $x=0$，这意味着 $g_L=0$ 或其他退化情况），我们必须有：\n$$\nB\\lambda - 4 = 0 \\implies B = \\frac{4}{\\lambda}\n$$\n在这个尖点，关于 $x$ 的二次方程有一个唯一的重根，由以下公式给出：\n$$\nx^{\\star} = \\frac{-(-B\\lambda)}{2\\lambda} = \\frac{B\\lambda}{2\\lambda} = \\frac{B}{2}\n$$\n代入 $B = 4/\\lambda$，我们找到在尖点处的 $x$ 值：\n$$\nx^{\\star} = \\frac{1}{2} \\left( \\frac{4}{\\lambda} \\right) = \\frac{2}{\\lambda}\n$$\n这个 $x$ 的值对应于电压 $V^{\\star} = E_N - x^{\\star} = E_N - 2/\\lambda$。为了找到在这个尖点处的临界NMDA电导 $g_{N}^{\\star}$，我们回到第二个鞍结条件：\n$$\n-g_{L} - g_{N}^{\\star}s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})] = 0\n$$\n解出 $g_{N}^{\\star}$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda V^{\\star})[1 - \\lambda(E_{N} - V^{\\star})]}\n$$\n代入 $V^{\\star} = E_N - x^{\\star}$ 和 $E_{N} - V^{\\star} = x^{\\star}$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda (E_N - x^{\\star}))[1 - \\lambda x^{\\star}]}\n$$\n现在，我们代入尖点值 $x^{\\star} = 2/\\lambda$：\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp\\left(\\lambda \\left(E_N - \\frac{2}{\\lambda}\\right)\\right)\\left[1 - \\lambda \\left(\\frac{2}{\\lambda}\\right)\\right]}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(1 - 2)}\n$$\n$$\ng_{N}^{\\star} = \\frac{-g_{L}}{s\\exp(\\lambda E_N - 2)(-1)}\n$$\n$$\ng_{N}^{\\star} = \\frac{g_{L}}{s\\exp(\\lambda E_N - 2)} = \\frac{g_{L}}{s}\\exp(2 - \\lambda E_N)\n$$\n这是在尖点处的临界电导 $g_{N}^{\\star}$ 的闭式表达式。\n\n**3. 数值计算**\n\n我们给定了以下参数值：\n$g_{L} = 0.1\\,\\mu\\mathrm{S}$\n$s = 0.3$\n$\\lambda = 0.062\\,\\mathrm{mV}^{-1}$\n$E_{N} = 0\\,\\mathrm{mV}$\n\n将这些值代入 $g_{N}^{\\star}$ 的表达式：\n$$\ng_{N}^{\\star} = \\frac{0.1\\,\\mu\\mathrm{S}}{0.3}\\exp(2 - (0.062\\,\\mathrm{mV}^{-1})(0\\,\\mathrm{mV}))\n$$\n$$\ng_{N}^{\\star} = \\frac{0.1}{0.3}\\exp(2)\\,\\mu\\mathrm{S} = \\frac{1}{3}\\exp(2)\\,\\mu\\mathrm{S}\n$$\n现在我们计算数值：\n$$\n\\exp(2) \\approx 7.3890560989...\n$$\n$$\ng_{N}^{\\star} \\approx \\frac{1}{3} \\times 7.3890560989...\\,\\mu\\mathrm{S} \\approx 2.4630186996...\\,\\mu\\mathrm{S}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\ng_{N}^{\\star} \\approx 2.463\\,\\mu\\mathrm{S}\n$$",
            "answer": "$$\\boxed{2.463}$$"
        },
        {
            "introduction": "真实的树突计算通常涉及信号在空间和时间上的相互作用。这项练习  将无源电缆特性与空间变化的活动电导相结合，以模拟一个关键的神经生物学现象：动作电位的反向传播（bAP）。您将实现一个模型来计算bAP沿树突传播时的衰减程度，并判断其与突触输入的同步到达是否足以触发局部NMDA发放。这项实践将生物物理原理与重合检测及突触可塑性的机制直接联系起来。",
            "id": "4042533",
            "problem": "一个柱状树突分支支持一个从胞体反向传播至远端位置的动作电位 (bAP)。考虑一个一维电缆模型，其中空间坐标 $x$（单位为米）沿着总长度为 $L$、直径为 $d$ 的树突分布。轴向电阻率为 $R_a$（单位 $\\Omega \\cdot \\mathrm{m}$），膜的漏电导密度为 $g_L$（单位 $\\mathrm{S}/\\mathrm{m}^2$）。分支上存在主动电导并沿其变化：钠电导密度 $g_{Na}(x)$ 朝着远端减小，而钾电导密度 $g_{K}(x)$ 朝着远端增大。假设单位面积电导的梯度参数化如下：\n- $g_{Na}(x) = g_{Na}^0 \\exp(-\\gamma x)$，\n- $g_{K}(x) = g_{K}^0 \\exp(\\kappa x)$，\n其中 $g_{Na}^0$ 和 $g_{K}^0$ 是近端（靠近胞体）的电导密度（单位 $\\mathrm{S}/\\mathrm{m}^2$），$\\gamma$ 和 $\\kappa$ 是空间尺度参数（单位 $\\mathrm{m}^{-1}$）。为模拟 bAP 是一个主动但短暂的波形这一事实，使用固定比例 $p_{Na}$ 和 $p_{K}$ 来近似这些电导对线性化膜电导的有效小信号贡献，从而总膜电导密度为 $g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x)$。\n\n从电缆方程、单位面积膜电阻的标准定义以及均匀柱状电缆的空间常数出发，推导并实现一个有原则的方法，用于计算 bAP 振幅从胞体到远端的衰减。仅使用以下基础依据：\n- 被动、线性化树突的电缆方程，以及均匀柱体的空间常数定义，\n- 单位面积膜电阻与电导密度之间的关系，\n- 用于沿电缆空间变化参数的慢变近似。\n\n将衰减因子 $\\mathcal{A}$ 定义为远端 bAP 振幅与胞体处振幅的比值，并假设振幅包络服从由空间变化的空间常数决定的局部指数衰减。那么，给定一个胞体 bAP 振幅 $A_{bAP}$（单位 $\\mathrm{mV}$），远端 bAP 振幅为 $A_{bAP}^{dist} = \\mathcal{A}\\,A_{bAP}$。考虑一个在远端位置产生的局部兴奋性突触后电位 (EPSP)，其振幅为 $A_{EPSP}$（单位 $\\mathrm{mV}$）。设静息电位为 $V_{rest}$（单位 $\\mathrm{mV}$），触发一个局部 N-甲基-D-天冬氨酸 (NMDA) 峰电位的经验阈值为 $V_{th}$（单位 $\\mathrm{mV}$）。假设时间对齐（bAP-EPSP 配对），并定义一个用于预测 NMDA 峰电位触发的二元规则：如果 $V_{rest} + A_{EPSP} + A_{bAP}^{dist} \\ge V_{th}$，则预测将触发一个局部 NMDA 峰电位。\n\n实现一个完整的程序，针对下面的每个测试用例，计算：\n- 衰减因子 $\\mathcal{A}$（浮点数），\n- 一个布尔值，指示在 bAP-EPSP 配对条件下是否预测会触发局部 NMDA 峰电位。\n\n必须显式处理物理单位。直径 $d$ 和长度 $L$ 以微米为单位提供，在计算前必须转换为米。电导单位为 $\\mathrm{S}/\\mathrm{m}^2$，电阻率单位为 $\\Omega \\cdot \\mathrm{m}$，电压单位为 $\\mathrm{mV}$。本问题不涉及角度。每个测试用例的结果必须是一个包含两个元素的列表：一个浮点数和一个布尔值。\n\n使用以下测试套件，其中包括一个一般情况、一个边界情况和多个边缘情况：\n- 情况 1：一般情况：$d = 1\\,\\mu\\mathrm{m}$, $L = 300\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 5000\\,\\mathrm{m}^{-1}$, $\\kappa = 3000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.02$, $p_{K} = 0.2$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 7\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -30\\,\\mathrm{mV}$。\n- 情况 2（边界长度）：$d = 1\\,\\mu\\mathrm{m}$, $L = 0\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 300\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 150\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 5000\\,\\mathrm{m}^{-1}$, $\\kappa = 3000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.02$, $p_{K} = 0.2$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 7\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -30\\,\\mathrm{mV}$。\n- 情况 3（细、长、强 $g_{K}$ 增长）：$d = 0.4\\,\\mu\\mathrm{m}$, $L = 400\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 1\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 250\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 200\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 4000\\,\\mathrm{m}^{-1}$, $\\kappa = 8000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.015$, $p_{K} = 0.25$, $A_{bAP} = 80\\,\\mathrm{mV}$, $A_{EPSP} = 10\\,\\mathrm{mV}$, $V_{rest} = -65\\,\\mathrm{mV}$, $V_{th} = -35\\,\\mathrm{mV}$。\n- 情况 4（粗、短、高近端 $g_{Na}$ 和缓衰减）：$d = 2.0\\,\\mu\\mathrm{m}$, $L = 200\\,\\mu\\mathrm{m}$, $R_a = 1.5\\,\\Omega\\cdot\\mathrm{m}$, $g_L = 0.8\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{Na}^0 = 500\\,\\mathrm{S}/\\mathrm{m}^2$, $g_{K}^0 = 120\\,\\mathrm{S}/\\mathrm{m}^2$, $\\gamma = 500\\,\\mathrm{m}^{-1}$, $\\kappa = 2000\\,\\mathrm{m}^{-1}$, $p_{Na} = 0.05$, $p_{K} = 0.15$, $A_{bAP} = 85\\,\\mathrm{mV}$, $A_{EPSP} = 25\\,\\mathrm{mV}$, $V_{rest} = -63\\,\\mathrm{mV}$, $V_{th} = -35\\,\\mathrm{mV}$。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且本身必须是一个双元素列表：浮点数衰减因子 $\\mathcal{A}$ 和布尔值 NMDA 峰电位预测。例如，输出格式必须类似于 $[\\,[\\mathcal{A}_1,\\mathrm{bool}_1],[\\mathcal{A}_2,\\mathrm{bool}_2],\\dots\\,]$，且无附加文本。",
            "solution": "该问题要求推导并实现一个方法，用以计算反向传播动作电位 (bAP) 沿非均匀树突电缆的衰减，并预测局部 NMDA 峰电位的触发。该解决方案按照要求从第一性原理推导得出。\n\n### **1. 基础：被动电缆理论**\n\n在被动、均匀的柱状树突中，电压传播由稳态电缆方程描述：\n$$ \\lambda^2 \\frac{d^2V}{dx^2} - V = 0 $$\n其中 $V$ 是相对于静息状态的膜电位，$x$ 是沿电缆的空间坐标，$\\lambda$ 是空间常数。对于无限长的电缆，描述从源点 $x=0$ 开始的电压衰减的解为 $V(x) = V_0 \\exp(-x/\\lambda)$。\n\n空间常数 $\\lambda$ 定义为：\n$$ \\lambda = \\sqrt{\\frac{r_m}{r_i}} $$\n其中 $r_m$ 是单位长度的膜电阻（单位 $\\Omega \\cdot \\mathrm{m}$），$r_i$ 是单位长度的轴向电阻（单位 $\\Omega/\\mathrm{m}$）。这些参数与树突的内在属性相关：\n*   单位长度轴向电阻，$r_i$：\n    $$ r_i = \\frac{R_a}{A_{cross}} = \\frac{R_a}{\\pi (d/2)^2} = \\frac{4 R_a}{\\pi d^2} $$\n    此处，$R_a$ 是轴向电阻率（单位 $\\Omega \\cdot \\mathrm{m}$），$d$ 是柱状树突的直径（单位 $\\mathrm{m}$）。\n*   单位长度膜电阻，$r_m$：\n    $$ r_m = \\frac{R_m}{\\pi d} $$\n    此处，$R_m$ 是单位面积的膜电阻（单位 $\\Omega \\cdot \\mathrm{m}^2$）。$R_m$ 是膜电导密度 $g_m$（单位 $\\mathrm{S}/\\mathrm{m}^2$）的倒数：\n    $$ R_m = \\frac{1}{g_m} $$\n\n综合以上各式，均匀电缆的空间常数可表示为：\n$$ \\lambda^2 = \\frac{r_m}{r_i} = \\frac{1/(\\pi d g_m)}{4 R_a/(\\pi d^2)} = \\frac{d}{4 R_a g_m} \\implies \\lambda = \\sqrt{\\frac{d}{4 R_a g_m}} $$\n\n### **2. 推广至非均匀电缆**\n\n问题陈述主动电导随位置 $x$ 变化，使得总有效膜电导密度 $g_m$ 成为 $x$ 的函数：\n$$ g_m(x) = g_L + p_{Na}\\,g_{Na}(x) + p_{K}\\,g_{K}(x) $$\n代入给定的 $g_{Na}(x)$ 和 $g_{K}(x)$ 的指数形式：\n$$ g_m(x) = g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x) $$\n其中 $g_L$、$p_{Na}$、$g_{Na}^0$、$\\gamma$、$p_{K}$、$g_{K}^0$ 和 $\\kappa$ 是给定参数。\n\n由于 $g_m$ 随 $x$ 变化，空间常数也成为一个空间变化的函数 $\\lambda(x)$：\n$$ \\lambda(x) = \\sqrt{\\frac{d}{4 R_a g_m(x)}} $$\n\n### **3. 从慢变近似推导衰减因子**\n\n问题要求使用“慢变近似”，即假设 bAP 振幅包络 $A(x)$ 服从由局部空间常数 $\\lambda(x)$ 决定的局部指数衰减。这可以表示为关于振幅的微分方程：\n$$ \\frac{dA(x)}{dx} = -\\frac{A(x)}{\\lambda(x)} $$\n这是一个一阶可分离常微分方程。我们可以通过积分求解在给定胞体（$x=0$）处振幅 $A(0)$ 的情况下，远端（$x=L$）处的振幅 $A(L)$：\n$$ \\int_{A(0)}^{A(L)} \\frac{dA}{A} = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln(A(L)) - \\ln(A(0)) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n$$ \\ln\\left(\\frac{A(L)}{A(0)}\\right) = -\\int_{0}^{L} \\frac{dx}{\\lambda(x)} $$\n衰减因子 $\\mathcal{A}$ 定义为比值 $\\mathcal{A} = A(L)/A(0)$。对两边取指数，得到 $\\mathcal{A}$ 的表达式：\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\frac{dx}{\\lambda(x)}\\right) $$\n\n### **4. 用于计算的最终表达式**\n\n将 $\\lambda(x)$ 的表达式代入 $\\mathcal{A}$ 的公式中：\n$$ \\mathcal{A} = \\exp\\left(-\\int_{0}^{L} \\sqrt{\\frac{4 R_a g_m(x)}{d}} \\, dx\\right) $$\n常数项可以从积分中提出：\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_m(x)} \\, dx\\right) $$\n代入 $g_m(x)$ 的完整表达式：\n$$ \\mathcal{A} = \\exp\\left(-\\sqrt{\\frac{4 R_a}{d}} \\int_{0}^{L} \\sqrt{g_L + p_{Na} g_{Na}^0 \\exp(-\\gamma x) + p_{K} g_K^0 \\exp(\\kappa x)} \\, dx\\right) $$\n该积分没有通用的解析解，必须进行数值计算。所提供的长度 $L$ 和直径 $d$ 的参数单位为微米（$\\mu\\mathrm{m}$），必须乘以 $10^{-6}$ 转换为米（$\\mathrm{m}$），以保持国际单位制 (SI) 的一致性。\n\n对于长度 $L=0$ 的边界情况，从 0 到 0 的积分为 0。因此，指数为 0，$\\mathcal{A} = \\exp(0) = 1$，表明没有衰减，这与预期相符。\n\n### **5. NMDA 峰电位预测规则**\n\n在远端位置（$x=L$）预测局部 NMDA 峰电位是基于一个简单的阈值规则。衰减后的 bAP 和局部 EPSP 同时到达所产生的峰值膜电位 $V_{peak}$，是它们各自的振幅在静息电位之上的线性叠加：\n$$ A_{bAP}^{dist} = \\mathcal{A} \\cdot A_{bAP} $$\n$$ V_{peak} = V_{rest} + A_{EPSP} + A_{bAP}^{dist} $$\n如果这个峰值电位达到或超过阈值电压 $V_{th}$，则预测会产生一个 NMDA 峰电位：\n$$ V_{peak} \\ge V_{th} $$\n这为每个测试用例产生一个布尔值（真/假）结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the bAP attenuation factor and predicts NMDA spike initiation.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each tuple contains:\n    # (d, L, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n    #  A_bAP, A_EPSP, V_rest, V_th)\n    test_cases = [\n        # Case 1: General case\n        (1.0, 300.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 2: Boundary length\n        (1.0, 0.0, 1.5, 1.0, 300.0, 150.0, 5000.0, 3000.0, 0.02, 0.2,\n         80.0, 7.0, -65.0, -30.0),\n        # Case 3: Thin, long, strong g_K growth\n        (0.4, 400.0, 1.5, 1.0, 250.0, 200.0, 4000.0, 8000.0, 0.015, 0.25,\n         80.0, 10.0, -65.0, -35.0),\n        # Case 4: Thicker, shorter, high proximal g_Na\n        (2.0, 200.0, 1.5, 0.8, 500.0, 120.0, 500.0, 2000.0, 0.05, 0.15,\n         85.0, 25.0, -63.0, -35.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_model(*case)\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    # Using str() on a list adds spaces, e.g., '[0.5, True]',\n    # which is then joined by commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_model(d_um, L_um, R_a, g_L, g_Na0, g_K0, gamma, kappa, p_Na, p_K,\n                  A_bAP, A_EPSP, V_rest, V_th):\n    \"\"\"\n    Computes the attenuation factor and NMDA spike prediction for a single case.\n\n    Args:\n        d_um (float): Diameter in micrometers.\n        L_um (float): Length in micrometers.\n        R_a (float): Axial resistivity in Ohm*m.\n        g_L (float): Leak conductance density in S/m^2.\n        g_Na0 (float): Proximal Na+ conductance density in S/m^2.\n        g_K0 (float): Proximal K+ conductance density in S/m^2.\n        gamma (float): Spatial scale for Na+ conductance in 1/m.\n        kappa (float): Spatial scale for K+ conductance in 1/m.\n        p_Na (float): Effective fraction for Na+ conductance.\n        p_K (float): Effective fraction for K+ conductance.\n        A_bAP (float): Somatic bAP amplitude in mV.\n        A_EPSP (float): Distal EPSP amplitude in mV.\n        V_rest (float): Resting potential in mV.\n        V_th (float): NMDA spike threshold in mV.\n\n    Returns:\n        list: A list containing [attenuation_factor, spike_prediction_bool].\n    \"\"\"\n    # 1. Unit conversion from micrometers to meters.\n    d = d_um * 1e-6\n    L = L_um * 1e-6\n\n    # 2. Handle the boundary case L=0.\n    if L == 0:\n        attenuation_factor = 1.0\n    else:\n        # 3. Define the integrand for the attenuation calculation.\n        # The integrand is sqrt(g_m(x)).\n        def integrand(x):\n            g_m_x = g_L + p_Na * g_Na0 * np.exp(-gamma * x) + p_K * g_K0 * np.exp(kappa * x)\n            return np.sqrt(g_m_x)\n\n        # 4. Numerically integrate from x=0 to x=L.\n        integral_val, _ = integrate.quad(integrand, 0, L)\n\n        # 5. Calculate the attenuation factor.\n        prefactor = np.sqrt(4 * R_a / d)\n        exponent = -prefactor * integral_val\n        attenuation_factor = np.exp(exponent)\n\n    # 6. Predict NMDA spike initiation.\n    # Calculate distal bAP amplitude.\n    A_bAP_dist = attenuation_factor * A_bAP\n\n    # Calculate peak voltage at distal site.\n    V_peak = V_rest + A_EPSP + A_bAP_dist\n\n    # Apply the threshold rule.\n    spike_predicted = V_peak >= V_th\n    \n    # 7. Return the results as a two-element list.\n    return [attenuation_factor, spike_predicted]\n\n# Run the simulation.\nsolve()\n```"
        }
    ]
}