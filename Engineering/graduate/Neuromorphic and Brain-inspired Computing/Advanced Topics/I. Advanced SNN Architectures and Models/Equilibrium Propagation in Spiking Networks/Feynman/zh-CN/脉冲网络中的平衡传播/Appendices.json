{
    "hands_on_practices": [
        {
            "introduction": "平衡传播（Equilibrium Propagation, EP）的理论框架建立在能量函数的概念之上。网络的“自由阶段”动力学被建模为在能量景观上的梯度下降过程。这个实践问题邀请您从第一性原理出发，为一个简单的脉冲网络推导这个能量函数，从而强化对称突触连接与势函数存在性之间的关键联系。",
            "id": "4043234",
            "problem": "考虑一个双神经元脉冲网络，该网络处于平均场滤波脉冲近似下，其中连续时间发放率向量 $x \\in \\mathbb{R}^{2}$ 服从泄漏整合发放（LIF）动力学，其时间常数为 $\\tau$，对称突触耦合矩阵为 $W \\in \\mathbb{R}^{2 \\times 2}$，并由外部输入 $I \\in \\mathbb{R}^{2}$ 驱动。以LIF神经元的一阶线性发放率动力学作为基本出发点，\n$$\n\\tau \\frac{d x}{d t} = - x + W x + I,\n$$\n以及基于能量的平衡传播（EP）要求，即存在一个标量能量函数 $E(x,w)$，使得自主松弛动力学是一个梯度流，\n$$\n\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w).\n$$\n假设 $W$ 是对称的，$W = W^{\\top}$，并且在 $x$ 中是平滑的。仅使用这些基本事实，推导出一个与上述动力学一致的有效能量函数 $E(x,w)$（可相差一个任意的加性常数）。然后，对于一个具体的双神经元网络，其非对角突触为 $w_{12} = w_{21} = 0.4$，自耦合为零 $w_{11} = w_{22} = 0$，泄漏时间常数为 $\\tau = 10\\,\\mathrm{ms}$，滤波脉冲为 $x = (0.3,\\,0.6)$，输入为 $I = (0.1,\\,0)$，评估 $E(x,w)$ 并计算在 $x$ 处的梯度分量 $\\frac{\\partial E}{\\partial x_{1}}$ 和 $\\frac{\\partial E}{\\partial x_{2}}$。最后，根据您计算的梯度，验证 $\\nabla_{x} E$ 是否在 $x$ 处为零。将您的最终答案表示为一个行矩阵 $\\big(E(x,w),\\,\\frac{\\partial E}{\\partial x_{1}},\\,\\frac{\\partial E}{\\partial x_{2}}\\big)$。数值不需要四舍五入，能量值也不需要包含物理单位。",
            "solution": "用户希望我解决一个关于脉冲网络中平衡传播的问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   **步骤1：提取已知条件。** 我将列出问题描述中提供的所有方程、变量和数值。\n    *   **步骤2：验证。** 我将根据我的验证标准（科学依据、适定性、客观性等）检查提取的已知条件。\n        *   该问题描述了一个简化的神经动力学模型（平均场近似下的LIF神经元）。这是计算神经科学中一个标准且被广泛接受的模型。\n        *   动力学由一个一阶线性常微分方程给出：$\\tau \\frac{d x}{d t} = - x + W x + I$。\n        *   介绍了平衡传播（EP）的核心概念：动力学必须是能量函数上的梯度流，$\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w)$。\n        *   问题要求我通过令两个动力学表达式相等来推导这个能量函数 $E(x,w)$。\n        *   突触矩阵 $W$ 被假定为对称的，这是存在这样一个标量能量函数的关键要求。如果 $Wx$ 是一个梯度，它的雅可比矩阵（即 $W$）必须是对稱的。这是相符的。\n        *   推导 $E(x,w)$ 的要求似乎是适定的。我可以令动力学向量的分量相等，然后积分来找到势函数 $E$。\n        *   问题接着为参数提供了具体的数值：$W$, $\\tau$, $x$ 和 $I$。\n        *   它要求我评估 $E(x,w)$ 及其在给定点 $x$ 的梯度。\n        *   最后，它要求我检查在该点梯度是否为零，这是一个平衡测试。\n        *   问题似乎是自包含的，科学上基于计算神经科学理论，客观且适定。没有明显的缺陷。关于矩阵 W 的“在x中平滑”的措辞有点不寻常，因为W通常是参数的常数矩阵，而不是x的函数。然而，在给定动力学的背景下，$Wx$ 是一个项，而需要成为函数梯度的项是 $-x+Wx+I$。让我们仔细重读：“假设 $W$ 是对称的，$W = W^{\\top}$，并且在 $x$ 中是平滑的。” 这似乎是一个轻微的错误陈述。*向量场* $F(x) = -x + Wx + I$ 必须是某个势的梯度。一个向量场 $F$ 是梯度场，如果它的雅可比矩阵是对称的。$F(x)$ 的雅可比矩阵是 $J_{ij} = \\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} (-x_i + \\sum_k W_{ik} x_k + I_i) = - \\delta_{ij} + W_{ij}$。因此，要使向量场 $F(x)$ 成为梯度场，其雅可比矩阵 $J = -I_{d} + W$ 必须是对称的。由于单位矩阵 $I_{d}$ 是对称的，这要求 $W$ 是对称的，这在问题陈述中已经给出 ($W = W^{\\top}$)。“在x中平滑”这部分可能是一个轻微的冗余，或者是一种拙劣的说法，意指向量场是平滑的，而它确实是平滑的，因为它是线性的。鉴于问题为数值计算部分提供了一个常数矩阵 $W$，我将把这解释为不是一个关键缺陷，而只是措辞上的轻微不精确。核心逻辑成立，因为 $W$ 是对称的。\n    *   **步骤3：结论。** 问题是有效的。我可以开始求解了。\n\n2.  **解决问题。**\n    *   **第一部分：推导能量函数 $E(x,w)$。**\n        *   从给定的两个动力学方程开始：\n            1.  $\\tau \\frac{d x}{d t} = - x + W x + I$\n            2.  $\\tau \\frac{d x}{d t} = - \\nabla_{x} E(x,w)$\n        *   令等式右边相等：\n            $\\nabla_{x} E(x,w) = x - W x - I$。\n        *   这意味着 $\\frac{\\partial E}{\\partial x_i} = x_i - \\sum_j W_{ij} x_j - I_i$。\n        *   为了找到 $E(x,w)$，我需要对这个偏微分方程组进行积分。\n        *   让我们对 $\\frac{\\partial E}{\\partial x_i}$ 关于 $x_i$ 积分：\n            $E(x,w) = \\int (x_i - \\sum_j W_{ij} x_j - I_i) dx_i + C(x_1, ..., x_{i-1}, x_{i+1}, ...)$\n            $E(x,w) = \\frac{1}{2} x_i^2 - \\sum_j W_{ij} x_j x_i - I_i x_i + C(...)$。这不是正确的方法。\n        *   对于一个向量场 $F = \\nabla E$，更好的方法是使用二次势的一般形式。该向量场在 $x$ 中是线性的。\n            让我们尝试一个一般的二次型：\n            $E(x) = \\frac{1}{2} x^\\top A x - b^\\top x + C_0$。\n            梯度是 $\\nabla_x E = A x - b$。\n            将其与 $\\nabla_x E = (I_d - W)x - I$ 比较，我们可以确定：\n            $A = I_d - W$ and $b = I$。\n            所以，$E(x,w) = \\frac{1}{2} x^\\top (I_d - W) x - I^\\top x + C_0$。\n            让我们验证一下。对于对称矩阵 $A$，$\\nabla_x (\\frac{1}{2} x^\\top A x) = Ax$。矩阵 $A = I_d - W$ 是对称的，因为 $I_d$ 是对称的，且给定的 $W$ 也是对称的。所以这是可行的。\n            让我们用索引符号写出来：\n            $E(x, w) = \\frac{1}{2} \\sum_{i,j} x_i (I_d - W)_{ij} x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} \\sum_{i,j} x_i (\\delta_{ij} - W_{ij}) x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} \\sum_i x_i^2 - \\frac{1}{2} \\sum_{i,j} x_i W_{ij} x_j - \\sum_i I_i x_i + C_0$\n            $E(x, w) = \\frac{1}{2} x^\\top x - \\frac{1}{2} x^\\top W x - I^\\top x + C_0$。\n            问题要求 $E(x,w)$ 可相差一个任意的加性常数，所以我可以设 $C_0=0$。\n            $E(x,w) = \\frac{1}{2} x^\\top x - \\frac{1}{2} x^\\top W x - I^\\top x$。这就是能量函数。\n\n    *   **第二部分：根据给定的数值计算 $E(x,w)$。**\n        *   已知条件：\n            *   $x = \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix}$\n            *   $W = \\begin{pmatrix} 0  0.4 \\\\ 0.4  0 \\end{pmatrix}$\n            *   $I = \\begin{pmatrix} 0.1 \\\\ 0 \\end{pmatrix}$\n            *   $\\tau = 10$ （这对于 E 的静态评估不是必需的，仅用于动力学）。\n        *   计算 $E(x,w)$ 中的各项：\n            *   $x^\\top x = x_1^2 + x_2^2 = (0.3)^2 + (0.6)^2 = 0.09 + 0.36 = 0.45$。\n            *   $x^\\top W x = \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0  0.4 \\\\ 0.4  0 \\end{pmatrix} \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix}$\n                $= \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0 \\cdot 0.3 + 0.4 \\cdot 0.6 \\\\ 0.4 \\cdot 0.3 + 0 \\cdot 0.6 \\end{pmatrix}$\n                $= \\begin{pmatrix} 0.3  0.6 \\end{pmatrix} \\begin{pmatrix} 0.24 \\\\ 0.12 \\end{pmatrix}$\n                $= 0.3 \\cdot 0.24 + 0.6 \\cdot 0.12 = 0.072 + 0.072 = 0.144$。\n                或者，使用索引符号：$\\sum_{i,j} W_{ij} x_i x_j = W_{11}x_1^2 + W_{12}x_1x_2 + W_{21}x_2x_1 + W_{22}x_2^2 = 0 + 0.4(0.3)(0.6) + 0.4(0.6)(0.3) + 0 = 2 \\cdot 0.4 \\cdot 0.18 = 0.8 \\cdot 0.18 = 0.144$。正确。\n            *   $I^\\top x = I_1 x_1 + I_2 x_2 = 0.1 \\cdot 0.3 + 0 \\cdot 0.6 = 0.03$。\n        *   现在，将这些代入 E 的表达式中：\n            $E(x,w) = \\frac{1}{2} (0.45) - \\frac{1}{2} (0.144) - (0.03)$\n            $E(x,w) = 0.225 - 0.072 - 0.03$\n            $E(x,w) = 0.153 - 0.03 = 0.123$。\n\n    *   **第三部分：计算在 $x$ 处的梯度分量 $\\frac{\\partial E}{\\partial x_1}$ 和 $\\frac{\\partial E}{\\partial x_2}$。**\n        *   梯度是 $\\nabla_{x} E(x,w) = (I_d - W)x - I$。\n        *   我们来计算 $(I_d - W)$：\n            $I_d - W = \\begin{pmatrix} 1  -0.4 \\\\ -0.4  1 \\end{pmatrix}$。\n        *   现在计算 $(I_d - W)x$：\n            $(I_d - W)x = \\begin{pmatrix} 1  -0.4 \\\\ -0.4  1 \\end{pmatrix} \\begin{pmatrix} 0.3 \\\\ 0.6 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 0.3 - 0.4 \\cdot 0.6 \\\\ -0.4 \\cdot 0.3 + 1 \\cdot 0.6 \\end{pmatrix}$\n            $= \\begin{pmatrix} 0.3 - 0.24 \\\\ -0.12 + 0.6 \\end{pmatrix} = \\begin{pmatrix} 0.06 \\\\ 0.48 \\end{pmatrix}$。\n        *   最后，减去 $I$：\n            $\\nabla_{x} E = \\begin{pmatrix} 0.06 \\\\ 0.48 \\end{pmatrix} - \\begin{pmatrix} 0.1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix}$。\n        *   所以，$\\frac{\\partial E}{\\partial x_1} = -0.04$ 且 $\\frac{\\partial E}{\\partial x_2} = 0.48$。\n\n    *   **第四部分：验证 $\\nabla_x E$ 是否为零。**\n        *   计算出的梯度是 $\\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix}$。\n        *   这个向量不是零向量。因此，梯度在给定点 $x$ 不为零。\n        *   这意味着点 $x = (0.3, 0.6)$ 对于给定的动力学和输入 $I$ 不是一个平衡点。在该点，系统不是静止的；其状态将根据 $\\tau \\frac{dx}{dt} = - \\nabla_x E = - \\begin{pmatrix} -0.04 \\\\ 0.48 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ -0.48 \\end{pmatrix}$ 改变。\n\n    *   **第五部分：整理最终答案。**\n        *   问题要求一个行矩阵 $\\big(E(x,w),\\,\\frac{\\partial E}{\\partial x_{1}},\\,\\frac{\\partial E}{\\partial x_{2}}\\big)$。\n        *   根据我的计算：\n            *   $E(x,w) = 0.123$\n            *   $\\frac{\\partial E}{\\partial x_1} = -0.04$\n            *   $\\frac{\\partial E}{\\partial x_2} = 0.48$\n        *   最终答案是 $(0.123, -0.04, 0.48)$。\n        *   我将把它格式化为一个 LaTeX `pmatrix`。\n\n3.  **审查与格式化。**\n    *   我需要清晰地、一步步地写出解答过程，所有数学实体都使用 LaTeX。\n    *   $E(x,w)$ 的推导必须清晰且有理有据。\n    *   必须展示数值计算过程。\n    *   对梯度是否为零的最终检查只是一个观察，但它是指令的一部分。我应该清楚地陈述结论。\n    *   最终答案只需要数值，而不需要这个验证结果。\n    *   最终答案必须使用 `pmatrix` 并采用指定的 `\\boxed{...}` 格式。\n    *   这看起来完整且正确。我将确保所有数字都用 LaTeX 格式化，例如 `$0.3$`, `$0.6$`, `$10$`, `$\\mathbb{R}^{2}$` 等。关于W的“在x中平滑”的措辞是唯一有点奇怪的部分，但正如所分析的，它并没有使问题失效，因为提供的W是常数且对称的，这才是关键属性。该问题可以解释为向量场是平滑的，这是正确的。推导二次能量函数的逻辑依赖于力场雅可比矩阵的对称性，这一点是满足的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.123  -0.04  0.48 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "EP 的第二个“微扰阶段”是学习发生的地方，它通过温和地引导网络朝向期望状态来实现。这是通过施加一个源于损失函数的微小“微扰”电流来完成的。本练习提供了一个具体例子，展示了如何将一个高层目标（如目标脉冲计数）转化为一个物理上可实现的输入电流，从而将抽象的学习理论与神经元的具体动力学联系起来。",
            "id": "4043232",
            "problem": "考虑一个脉冲网络中的单输出神经元，在由 $t \\in \\{1,2,\\dots,T\\}$ 索引的离散时间窗口内进行观察，其脉冲序列为 $s_k(t) \\in \\{0,1\\}$。定义一个基于速率的线性读出 $y_k$ 为\n$$\ny_k \\;=\\; \\sum_{t=1}^{T} \\kappa(t)\\, s_k(t),\n$$\n其中使用矩形归一化核 $\\kappa(t) = \\frac{1}{T}$，适用于所有 $t \\in \\{1,\\dots,T\\}$。针对目标脉冲计数 $\\hat{n}_k$ 的脉冲计数损失为\n$$\n\\mathcal{L}_k \\;=\\; \\big(T\\,y_k - \\hat{n}_k\\big)^{2}.\n$$\n在平衡传播 (EP) 中，第二阶段是通过向与损失直接相关的变量添加小的微调电流来实现的，以便系统探索一个轻微扰动的稳态。仅从EP的核心原理（即微调作用是一种与损失函数相对于被微调变量的负梯度成正比的小外部影响）出发，推导施加于输出神经元 $k$ 相关联的读出变量上的微调电流，并将其表示为包含 $T$、$y_k$、$\\hat{n}_k$ 和小的正微调强度 $\\beta$ 的闭式解析表达式。然后，对于以下具体样本计算其值：$(\\hat{n}_k, T) = (10, 100)$，在时间点 $t \\in \\{5, 20, 35, 50, 65, 80, 95\\}$ 观察到脉冲（因此在这些索引处 $s_k(t) = 1$，否则 $s_k(t) = 0$），以及 $\\beta = 0.01$。将最终的电流幅值表示为一个不带单位的实数，且不要四舍五入。",
            "solution": "该问题要求在平衡传播 (EP) 的背景下推导一个微调电流，并随后针对一个具体的数值例子进行计算。\n\n首先，我们建立理论框架。问题陈述，微调电流（我们记为 $I_k^{\\text{nudge}}$）是一种小的外部影响，它与损失函数 $\\mathcal{L}_k$ 相对于被微调的变量（即读出变量 $y_k$）的负梯度成正比。比例常数是给定的小的正微调强度 $\\beta$。这个关系可形式化表示为：\n$$\nI_k^{\\text{nudge}} = -\\beta \\frac{\\partial \\mathcal{L}_k}{\\partial y_k}\n$$\n损失函数由以下公式给出：\n$$\n\\mathcal{L}_k = (T y_k - \\hat{n}_k)^2\n$$\n为了求得微调电流，我们必须计算 $\\mathcal{L}_k$ 关于 $y_k$ 的偏导数。使用微分的链式法则，我们得到：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = \\frac{\\partial}{\\partial y_k} \\left[ (T y_k - \\hat{n}_k)^2 \\right]\n$$\n令 $u = T y_k - \\hat{n}_k$，则表达式变为 $\\mathcal{L}_k = u^2$。根据链式法则可得：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = \\frac{d\\mathcal{L}_k}{du} \\frac{\\partial u}{\\partial y_k} = 2u \\cdot \\frac{\\partial}{\\partial y_k}(T y_k - \\hat{n}_k)\n$$\n将 $u$ 代回并对 $y_k$ 求导（将 $T$ 和 $\\hat{n}_k$ 视为常数），得到：\n$$\n\\frac{\\partial \\mathcal{L}_k}{\\partial y_k} = 2(T y_k - \\hat{n}_k) \\cdot T = 2T(T y_k - \\hat{n}_k)\n$$\n现在，我们将此梯度表达式代回微调电流的公式中：\n$$\nI_k^{\\text{nudge}} = -\\beta \\left[ 2T(T y_k - \\hat{n}_k) \\right] = -2\\beta T(T y_k - \\hat{n}_k)\n$$\n这就是用给定变量 $T$、$y_k$、$\\hat{n}_k$ 和 $\\beta$ 表示的微调电流的闭式解析表达式。\n\n为了更深入地理解，我们可以分析 $T y_k$ 这一项。读出值 $y_k$ 被定义为 $y_k = \\sum_{t=1}^{T} \\kappa(t) s_k(t)$，其中核函数为 $\\kappa(t) = \\frac{1}{T}$。将其代入可得：\n$$\nT y_k = T \\left( \\sum_{t=1}^{T} \\frac{1}{T} s_k(t) \\right) = \\sum_{t=1}^{T} s_k(t)\n$$\n由于 $s_k(t)$ 的取值为 $0$ 或 $1$，所以和 $\\sum_{t=1}^{T} s_k(t)$ 是在时间窗口 $\\{1, \\dots, T\\}$ 内观察到的总脉冲数。我们把这个总脉冲数记为 $n_k$。因此，$T y_k = n_k$。量 $(T y_k - \\hat{n}_k)$ 就是观测到的脉冲数 $n_k$ 和目标脉冲数 $\\hat{n}_k$ 之间的误差。微调电流也可以写成 $I_k^{\\text{nudge}} = -2\\beta T(n_k - \\hat{n}_k)$。\n\n接下来，我们为给定的样本计算数值：\n- 目标脉冲数：$\\hat{n}_k = 10$。\n- 时间窗口长度：$T = 100$。\n- 微调强度：$\\beta = 0.01$。\n- 脉冲时间：$t \\in \\{5, 20, 35, 50, 65, 80, 95\\}$。\n\n首先，我们确定观测到的总脉冲数 $n_k$。给定的脉冲时间集合包含 $7$ 个元素，所以神经元发放了 $7$ 次脉冲。\n$$\nn_k = \\sum_{t=1}^{100} s_k(t) = 7\n$$\n现在我们可以计算读出变量 $y_k$ 的值：\n$$\ny_k = \\frac{n_k}{T} = \\frac{7}{100} = 0.07\n$$\n最后，我们将所有数值代入我们推导出的微调电流表达式中：\n$$\nI_k^{\\text{nudge}} = -2\\beta T(T y_k - \\hat{n}_k)\n$$\n$$\nI_k^{\\text{nudge}} = -2(0.01)(100) \\left( (100)(0.07) - 10 \\right)\n$$\n$$\nI_k^{\\text{nudge}} = -2(1) \\left( 7 - 10 \\right)\n$$\n$$\nI_k^{\\text{nudge}} = -2(-3)\n$$\n$$\nI_k^{\\text{nudge}} = 6\n$$\n施加于读出变量的微调电流的值为 $6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "在脉冲网络中，我们只能观察到离散的脉冲事件，而无法直接获取 EP 算法所需的连续内部状态变量。因此，我们必须对这些变量进行估计，通常是通过对脉冲序列进行滤波来实现。这个高级实践探讨了这种估计所带来的后果，引导您推导由有限时间测量和滤波器动态引入的偏差，这是理解 EP 在实际场景中性能与局限性的关键一步。",
            "id": "4043214",
            "problem": "考虑一个在平衡传播下运行的脉冲网络中的单个神经元，它有两个阶段：由 $0$ 索引的自由相和由 $\\beta$ 索引的微扰相。在每个阶段，该神经元发出的脉冲序列被建模为一个平稳非齐次点过程的实现，其条件强度在测量窗口内是分段常数。具体来说，在自由相期间，条件强度为 $r^{0}$，在微扰相期间为 $r^{\\beta}$，其中 $r^{0}$ 和 $r^{\\beta}$ 是非负常数。为了从脉冲中测量活动，使用一个时间常数为 $\\tau_{f}  0$ 的一阶指数低通滤波器应用于脉冲序列。滤波器输出 $y(t)$ 被定义为线性时不变 (LTI) 微分方程\n$$\n\\frac{d y(t)}{d t} = -\\frac{1}{\\tau_{f}} y(t) + \\frac{1}{\\tau_{f}} s(t),\n$$\n的解，初始条件为 $y(0) = 0$，其中 $s(t)$ 是脉冲序列，表示为位于脉冲时间的狄拉克δ函数的和。在每个阶段，滤波后的活动在持续时间为 $T  0$ 的有限测量窗口上进行平均，以构成估计量\n$$\n\\hat{x} = \\frac{1}{T} \\int_{0}^{T} y(t) \\, d t.\n$$\n定义一个平衡传播梯度替代量的实用估计量为\n$$\n\\hat{g} \\equiv \\frac{1}{\\beta} \\left( \\hat{x}^{\\beta} - \\hat{x}^{0} \\right),\n$$\n其中上标表示在相应阶段计算的量，每个阶段的滤波器都初始化为 $y(0) = 0$。目标量是无限时间平衡差\n$$\ng_{\\mathrm{true}} \\equiv \\frac{1}{\\beta} \\left( x^{\\beta} - x^{0} \\right),\n$$\n其中对于阶段 $p \\in \\{0, \\beta\\}$，$x^{p} \\equiv \\lim_{t \\to \\infty} y^{p}(t)$。\n\n从点过程的LTI滤波和条件强度的定义等第一性原理出发，推导由于有限时间采样和滤波器瞬态引起的估计量 $\\hat{g}$ 的期望偏差的闭式表达式，其定义为\n$$\n\\mathrm{Bias} \\equiv \\mathbb{E}[\\hat{g}] - g_{\\mathrm{true}},\n$$\n用 $\\beta$、$\\tau_{f}$、$T$、$r^{\\beta}$ 和 $r^{0}$ 表示。假设在每个测量窗口内具有平稳性，两个阶段的脉冲序列之间相互独立，并且条件强度 $r^{0}$ 和 $r^{\\beta}$ 是有限的、严格非负的常数。将最终结果表示为单个闭式解析表达式。不需要进行数值舍入，最终答案中不应包含任何单位。",
            "solution": "问题陈述被认为是有效的，因为它科学地基于计算神经科学的原理，是适定的、客观的且自洽的。它描述了一个用于分析脉冲神经网络中估计量的标准理论模型，没有明显的矛盾、不成立的前提或含糊之处。因此，我们可以继续进行推导。\n\n目标是计算估计量 $\\hat{g}$ 的偏差，定义为 $\\mathrm{Bias} \\equiv \\mathbb{E}[\\hat{g}] - g_{\\mathrm{true}}$。这需要推导估计量的期望值 $\\mathbb{E}[\\hat{g}]$ 和真实目标量 $g_{\\mathrm{true}}$ 的表达式。我们将分几个步骤来进行。\n\n首先，我们确定低通滤波器对脉冲序列的期望响应。对于任何给定的阶段（自由相 $p=0$ 或微扰相 $p=\\beta$），滤波器输出 $y^p(t)$ 由线性时不变 (LTI) 微分方程决定：\n$$\n\\frac{d y^p(t)}{d t} + \\frac{1}{\\tau_{f}} y^p(t) = \\frac{1}{\\tau_{f}} s^p(t)\n$$\n初始条件为 $y^p(0) = 0$。输入 $s^p(t)$ 是一个脉冲序列，建模为具有恒定速率 $r^p$ 的平稳泊松过程的实现。\n\n该微分方程的解可以通过将输入 $s^p(t)$ 与系统的脉冲响应 $h(t)$ 进行卷积来找到。脉冲响应是方程 $\\frac{d h(t)}{d t} + \\frac{1}{\\tau_{f}} h(t) = \\frac{1}{\\tau_{f}} \\delta(t)$ 在 $t0$ 时 $h(t)=0$ 条件下的解，即对于 $t \\ge 0$，$h(t) = \\frac{1}{\\tau_{f}} \\exp(-t/\\tau_{f})$。\n给定初始条件 $y^p(0)=0$，输出由卷积分给出：\n$$\ny^p(t) = \\int_{0}^{t} h(t-\\tau) s^p(\\tau) \\, d\\tau = \\int_{0}^{t} \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{t-\\tau}{\\tau_{f}}\\right) s^p(\\tau) \\, d\\tau\n$$\n为了求输出的期望值，我们对上述表达式取期望。根据期望的线性和富比尼定理，我们可以将期望算子移到积分内部。平稳泊松过程 $s^p(t)$ 的期望是其速率，$\\mathbb{E}[s^p(t)] = r^p$。\n$$\n\\mathbb{E}[y^p(t)] = \\int_{0}^{t} \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{t-\\tau}{\\tau_{f}}\\right) \\mathbb{E}[s^p(\\tau)] \\, d\\tau = \\int_{0}^{t} \\frac{1}{\\tau_{f}} \\exp\\left(-\\frac{t-\\tau}{\\tau_{f}}\\right) r^p \\, d\\tau\n$$\n我们来计算这个积分。令 $u = t - \\tau$，则 $du = -d\\tau$。积分限从 $\\tau=0$ 变为 $u=t$，从 $\\tau=t$ 变为 $u=0$。\n$$\n\\mathbb{E}[y^p(t)] = \\frac{r^p}{\\tau_f} \\int_{t}^{0} \\exp(-u/\\tau_f) (-du) = \\frac{r^p}{\\tau_f} \\int_{0}^{t} \\exp(-u/\\tau_f) \\, du\n$$\n$$\n\\mathbb{E}[y^p(t)] = \\frac{r^p}{\\tau_f} \\left[ -\\tau_f \\exp(-u/\\tau_f) \\right]_{0}^{t} = -r^p \\left[ \\exp(-t/\\tau_f) - \\exp(0) \\right]\n$$\n$$\n\\mathbb{E}[y^p(t)] = r^p \\left(1 - \\exp(-t/\\tau_f)\\right)\n$$\n这个表达式给出了从零初始条件开始，在时间 $t$ 的期望滤波器输出。\n\n接下来，我们计算估计量 $\\hat{x}^p$ 的期望值，它是 $y^p(t)$ 在区间 $[0, T]$ 上的时间平均。\n$$\n\\mathbb{E}[\\hat{x}^p] = \\mathbb{E}\\left[\\frac{1}{T} \\int_{0}^{T} y^p(t) \\, dt\\right] = \\frac{1}{T} \\int_{0}^{T} \\mathbb{E}[y^p(t)] \\, dt\n$$\n代入 $\\mathbb{E}[y^p(t)]$ 的表达式：\n$$\n\\mathbb{E}[\\hat{x}^p] = \\frac{1}{T} \\int_{0}^{T} r^p \\left(1 - \\exp(-t/\\tau_f)\\right) \\, dt = \\frac{r^p}{T} \\left[ t + \\tau_f \\exp(-t/\\tau_f) \\right]_{0}^{T}\n$$\n$$\n\\mathbb{E}[\\hat{x}^p] = \\frac{r^p}{T} \\left( \\left(T + \\tau_f \\exp(-T/\\tau_f)\\right) - \\left(0 + \\tau_f \\exp(0)\\right) \\right)\n$$\n$$\n\\mathbb{E}[\\hat{x}^p] = \\frac{r^p}{T} \\left( T - \\tau_f + \\tau_f \\exp(-T/\\tau_f) \\right) = r^p \\left( 1 - \\frac{\\tau_f}{T} \\left(1 - \\exp(-T/\\tau_f)\\right) \\right)\n$$\n这些项的另一种排列方式是：\n$$\n\\mathbb{E}[\\hat{x}^p] = r^p \\left( 1 + \\frac{\\tau_f}{T} \\left(\\exp(-T/\\tau_f) - 1\\right) \\right)\n$$\n\n现在我们可以计算梯度替代估计量的期望值 $\\mathbb{E}[\\hat{g}]$。\n$$\n\\mathbb{E}[\\hat{g}] = \\mathbb{E}\\left[\\frac{1}{\\beta} \\left( \\hat{x}^{\\beta} - \\hat{x}^{0} \\right)\\right] = \\frac{1}{\\beta} \\left( \\mathbb{E}[\\hat{x}^{\\beta}] - \\mathbb{E}[\\hat{x}^{0}] \\right)\n$$\n对两个阶段都使用 $\\mathbb{E}[\\hat{x}^p]$ 的表达式：\n$$\n\\mathbb{E}[\\hat{g}] = \\frac{1}{\\beta} \\left[ r^{\\beta} \\left( 1 + \\frac{\\tau_f}{T} (\\exp(-T/\\tau_f) - 1) \\right) - r^{0} \\left( 1 + \\frac{\\tau_f}{T} (\\exp(-T/\\tau_f) - 1) \\right) \\right]\n$$\n提出公因子：\n$$\n\\mathbb{E}[\\hat{g}] = \\frac{r^{\\beta} - r^{0}}{\\beta} \\left( 1 + \\frac{\\tau_f}{T} \\left(\\exp(-T/\\tau_f) - 1\\right) \\right)\n$$\n\n下一步是确定真实目标量 $g_{\\mathrm{true}}$。它由无限时间平衡活动定义，$x^p \\equiv \\lim_{t \\to \\infty} y^p(t)$。对于一个随机过程，这个极限被恰当地解释为稳态均值。\n$$\nx^p = \\lim_{t \\to \\infty} \\mathbb{E}[y^p(t)] = \\lim_{t \\to \\infty} r^p \\left(1 - \\exp(-t/\\tau_f)\\right) = r^p\n$$\n因此，真实的梯度是：\n$$\ng_{\\mathrm{true}} = \\frac{1}{\\beta} \\left( x^{\\beta} - x^{0} \\right) = \\frac{r^{\\beta} - r^{0}}{\\beta}\n$$\n\n最后，我们通过从 $\\mathbb{E}[\\hat{g}]$ 中减去 $g_{\\mathrm{true}}$ 来计算偏差。\n$$\n\\mathrm{Bias} = \\mathbb{E}[\\hat{g}] - g_{\\mathrm{true}} = \\frac{r^{\\beta} - r^{0}}{\\beta} \\left( 1 + \\frac{\\tau_f}{T} \\left(\\exp(-T/\\tau_f) - 1\\right) \\right) - \\frac{r^{\\beta} - r^{0}}{\\beta}\n$$\n$$\n\\mathrm{Bias} = \\frac{r^{\\beta} - r^{0}}{\\beta} \\left[ \\left( 1 + \\frac{\\tau_f}{T} \\left(\\exp(-T/\\tau_f) - 1\\right) \\right) - 1 \\right]\n$$\n$$\n\\mathrm{Bias} = \\frac{r^{\\beta} - r^{0}}{\\beta} \\left[ \\frac{\\tau_f}{T} \\left(\\exp(-T/\\tau_f) - 1\\right) \\right]\n$$\n这就得到了偏差的最终闭式表达式。它源于滤波器瞬态响应和有限平均窗口的共同作用，这两者都阻止了估计量收敛到真实的渐近值。\n我们可以为最终答案稍微重新整理一下表达式。\n$$\n\\mathrm{Bias} = \\frac{(r^{\\beta} - r^{0})\\tau_{f}}{\\beta T} \\left( \\exp\\left(-\\frac{T}{\\tau_{f}}\\right) - 1 \\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{(r^{\\beta} - r^{0})\\tau_{f}}{\\beta T} \\left( \\exp\\left(-\\frac{T}{\\tau_{f}}\\right) - 1 \\right)}\n$$"
        }
    ]
}