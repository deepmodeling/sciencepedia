{
    "hands_on_practices": [
        {
            "introduction": "神经形态阵列的性能在很大程度上受到器件差异性的限制。这种差异性源于不同层面：器件与器件之间存在固有的物理差异（即器件间差异性），而单个器件在每次编程后的状态也存在轻微波动（即周期性差异性）。\n\n为了有效缓解这些非理想效应，我们必须首先对其进行精确量化。本实践将指导您设计一个实验，并应用分层统计模型来分离和估计这两个基本的差异性来源，这对于理解和优化测量资源分配（例如，在有限预算下选择测试更多器件还是对每个器件进行更多次编程）至关重要。",
            "id": "4053973",
            "problem": "诸如相变存储器（PCM）和阻变随机存取存储器（RRAM）之类的新兴存储器件被用作神经形态和类脑计算系统中的模拟突触。非理想性源于多尺度下的变异性：器件间变异性和周期性变异性。考虑在一次标准化的写入操作后，测量以西门子（S）为单位的编程电导。一项平衡实验会选择一定数量的器件和每个器件的编程周期数，然后在每个周期记录一次电导读数。假设测量噪声的标准差是已知的，并由仪器设备控制。\n\n假设记录的电导 $y_{d,c}$（器件 $d$ 在周期 $c$）服从一个分层高斯模型：\n$$\ny_{d,c} = \\mu + u_d + v_{d,c} + \\epsilon_{d,c},\n$$\n其中 $u_d \\sim \\mathcal{N}(0,\\sigma_D^2)$ 捕捉器件间的变异性，$v_{d,c} \\sim \\mathcal{N}(0,\\sigma_C^2)$ 捕捉单个器件内的周期性变异性，而 $\\epsilon_{d,c} \\sim \\mathcal{N}(0,\\sigma_M^2)$ 模拟测量噪声，其方差 $\\sigma_M^2$ 已知。所有随机变量相互独立。实验是平衡的，有 $D$ 个器件，每个器件 $C$ 个周期，总共产生 $N = D \\cdot C$ 次测量。\n\n从正态分布的基本性质以及无偏样本均值和方差的定义出发，完成以下任务：\n1. 为每个器件定义无偏器件内样本方差，并为所有器件的器件均值定义无偏样本方差。根据它们在分层高斯模型下的期望，推导出 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的无偏矩估计量。\n2. 利用以下经过充分检验的事实：对于独立同分布的高斯样本，无偏样本方差服从缩放卡方分布，且样本均值和样本方差是独立的。基于此，推导出 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的无偏矩估计量方差的闭式表达式，该表达式是 $D$、$C$、$\\sigma_D^2$、$\\sigma_C^2$ 和 $\\sigma_M^2$ 的函数。\n3. 对于给定的总测量预算 $N$，在平衡设计约束 $D \\cdot C = N$（其中 $D \\ge 2$ 且 $C \\ge 2$）下，选择整数 $D$ 和 $C$ 以最小化方差估计量的相对标准误差平方和，定义为\n$$\nJ(D,C) = \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_D^2}]}{\\sigma_D^2}\\right)^2 + \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_C^2}]}{\\sigma_C^2}\\right)^2,\n$$\n其中 $\\mathrm{SE}[\\cdot]$ 表示标准误差（方差的平方根）。如果 $J(D,C)$ 的值在数值精度范围内出现并列，则优先选择具有较大 $D$ 的设计。\n4. 指定最终输出格式并实现计算。\n\n所有与电导相关的量必须以西门子（S）表示，所有方差和标准误差必须以平方西门子（$\\mathrm{S}^2$）表示。角度不属于此问题。你的程序的最终输出必须是单行，包含一个逗号分隔的列表的列表，其中每个内部列表的格式为 $[D,C,\\mathrm{SE}[\\widehat{\\sigma_D^2}],\\mathrm{SE}[\\widehat{\\sigma_C^2}]]$，且无空格。\n\n测试套件和答案规范：\n- 使用以下参数集，每个参数集以 $(N,\\sigma_D,\\sigma_C,\\sigma_M)$ 的形式给出，所有 $\\sigma$ 值单位为西门子（S）。\n    1. $(48, 3.0\\times 10^{-7}, 2.0\\times 10^{-7}, 5.0\\times 10^{-8})$。\n    2. $(36, 1.0\\times 10^{-7}, 5.0\\times 10^{-8}, 2.0\\times 10^{-7})$。\n    3. $(8, 5.0\\times 10^{-7}, 1.0\\times 10^{-8}, 1.0\\times 10^{-8})$。\n- 对于每个参数集，搜索 $N$ 的所有满足 $D \\ge 2$ 和 $C \\ge 2$ 的整数因式分解 $D \\cdot C$，以根据上述标准找到最优的 $(D,C)$。计算所选 $(D,C)$ 对应的标准误差 $\\mathrm{SE}[\\widehat{\\sigma_D^2}]$ 和 $\\mathrm{SE}[\\widehat{\\sigma_C^2}]$，并以浮点数形式报告，单位为 $\\mathrm{S}^2$。\n- 你的程序应生成单行输出，包含一个逗号分隔的内部列表的列表，不带空格，例如：$[[D_1,C_1,SE_{D,1},SE_{C,1}],[D_2,C_2,SE_{D,2},SE_{C,2}],[D_3,C_3,SE_{D,3},SE_{C,3}]]$。",
            "solution": "该问题要求在一个分层高斯模型中推导方差分量的估计量，计算这些估计量的方差，并将这些结果应用于最优实验设计问题。解决方案将从基本原理出发，分步进行推导。\n\n器件 $d$ 在周期 $c$ 的测量电导 $y_{d,c}$ 的分层模型由下式给出：\n$$\ny_{d,c} = \\mu + u_d + v_{d,c} + \\epsilon_{d,c}\n$$\n其中 $\\mu$ 是全局平均电导，$u_d \\sim \\mathcal{N}(0, \\sigma_D^2)$ 表示器件间的变异性，$v_{d,c} \\sim \\mathcal{N}(0, \\sigma_C^2)$ 表示周期性的变异性，$\\epsilon_{d,c} \\sim \\mathcal{N}(0, \\sigma_M^2)$ 是测量噪声。所有随机变量相互独立。实验设计是平衡的，有 $D$ 个器件，每个器件 $C$ 个周期。测量噪声方差 $\\sigma_M^2$ 是已知的。\n\n首先，我们定义两个关键的样本统计量。每个器件 $d$ 的样本均值为：\n$$\n\\bar{y}_{d \\cdot} = \\frac{1}{C} \\sum_{c=1}^{C} y_{d,c}\n$$\n总样本均值为：\n$$\n\\bar{y}_{\\cdot \\cdot} = \\frac{1}{D} \\sum_{d=1}^{D} \\bar{y}_{d \\cdot} = \\frac{1}{DC} \\sum_{d=1}^{D} \\sum_{c=1}^{C} y_{d,c}\n$$\n\n将模型代入器件均值表达式，我们得到：\n$$\n\\bar{y}_{d \\cdot} = \\frac{1}{C} \\sum_{c=1}^{C} (\\mu + u_d + v_{d,c} + \\epsilon_{d,c}) = \\mu + u_d + \\bar{v}_{d \\cdot} + \\bar{\\epsilon}_{d \\cdot}\n$$\n其中 $\\bar{v}_{d \\cdot} = \\frac{1}{C}\\sum_c v_{d,c}$ 且 $\\bar{\\epsilon}_{d \\cdot} = \\frac{1}{C}\\sum_c \\epsilon_{d,c}$。根据正态分布的性质，$\\bar{v}_{d \\cdot} \\sim \\mathcal{N}(0, \\sigma_C^2/C)$ 且 $\\bar{\\epsilon}_{d \\cdot} \\sim \\mathcal{N}(0, \\sigma_M^2/C)$。对于 $d=1,\\dots,D$，$\\bar{y}_{d \\cdot}$ 是独立同分布（i.i.d.）的正态随机变量，其均值为 $\\mathrm{E}[\\bar{y}_{d \\cdot}] = \\mu$，方差为：\n$$\n\\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\mathrm{Var}[u_d] + \\mathrm{Var}[\\bar{v}_{d \\cdot}] + \\mathrm{Var}[\\bar{\\epsilon}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2}{C} + \\frac{\\sigma_M^2}{C} = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\n$$\n\n矩估计量的推导\n\n我们继续推导方差分量 $\\sigma_C^2$ 和 $\\sigma_D^2$ 的估计量。\n\n每个器件 $d$ 的无偏器件内样本方差定义为：\n$$\nS_{W,d}^2 = \\frac{1}{C-1} \\sum_{c=1}^{C} (y_{d,c} - \\bar{y}_{d \\cdot})^2\n$$\n对于一个固定的器件 $d$，随机变量 $y_{d,c}$（对于 $c=1,\\dots,C$）可以看作是来自正态分布 $\\mathcal{N}(\\mu+u_d, \\sigma_C^2 + \\sigma_M^2)$ 的样本。这是因为，对于给定的 $u_d$，项 $y_{d,c} - (\\mu+u_d) = v_{d,c} + \\epsilon_{d,c}$ 是两个独立的、零均值正态变量之和，因此 $v_{d,c} + \\epsilon_{d,c} \\sim \\mathcal{N}(0, \\sigma_C^2 + \\sigma_M^2)$。无偏样本方差的期望是总体的真实方差。因此：\n$$\n\\mathrm{E}[S_{W,d}^2] = \\sigma_C^2 + \\sigma_M^2\n$$\n我们可以将这些方差在所有器件上求平均，以获得一个更稳定的统计量，即器件内均方误差：\n$$\nS_W^2 = \\frac{1}{D} \\sum_{d=1}^{D} S_{W,d}^2 = \\frac{1}{D(C-1)} \\sum_{d=1}^{D} \\sum_{c=1}^{C} (y_{d,c} - \\bar{y}_{d \\cdot})^2\n$$\n根据期望的线性性质，$\\mathrm{E}[S_W^2] = \\sigma_C^2 + \\sigma_M^2$。由于 $\\sigma_M^2$ 已知，我们可以构造 $\\sigma_C^2$ 的一个无偏估计量：\n$$\n\\widehat{\\sigma_C^2} = S_W^2 - \\sigma_M^2\n$$\n其期望为 $\\mathrm{E}[\\widehat{\\sigma_C^2}] = \\mathrm{E}[S_W^2] - \\sigma_M^2 = (\\sigma_C^2 + \\sigma_M^2) - \\sigma_M^2 = \\sigma_C^2$。\n\n接下来，我们定义器件均值的无偏样本方差：\n$$\nS_B^2 = \\frac{1}{D-1} \\sum_{d=1}^{D} (\\bar{y}_{d \\cdot} - \\bar{y}_{\\cdot \\cdot})^2\n$$\n项 $\\bar{y}_{d \\cdot}$ 是来自方差为 $\\mathrm{Var}[\\bar{y}_{d \\cdot}]$ 的分布的 $D$ 个独立同分布样本。$S_B^2$ 的期望就是这个方差：\n$$\n\\mathrm{E}[S_B^2] = \\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\n$$\n使用矩量法，我们用样本对应物替换期望值。我们用 $S_B^2$ 替换 $\\mathrm{E}[S_B^2]$，用其无偏估计量 $S_W^2$ 替换 $(\\sigma_C^2 + \\sigma_M^2)$。\n$$\nS_B^2 \\approx \\sigma_D^2 + \\frac{S_W^2}{C}\n$$\n这表明 $\\sigma_D^2$ 的无偏估计量如下：\n$$\n\\widehat{\\sigma_D^2} = S_B^2 - \\frac{S_W^2}{C}\n$$\n其期望为 $\\mathrm{E}[\\widehat{\\sigma_D^2}] = \\mathrm{E}[S_B^2] - \\frac{\\mathrm{E}[S_W^2]}{C} = (\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}) - \\frac{\\sigma_C^2 + \\sigma_M^2}{C} = \\sigma_D^2$。\n\n估计量方差的推导\n\n为了推导 $\\widehat{\\sigma_C^2}$ 和 $\\widehat{\\sigma_D^2}$ 的方差，我们利用这样一个性质：对于来自 $\\mathcal{N}(\\mu, \\sigma^2)$ 的 $n$ 个独立同分布样本，无偏样本方差 $s^2$ 的分布与卡方分布有关：$\\frac{(n-1)s^2}{\\sigma^2} \\sim \\chi^2_{n-1}$。一个 $\\chi^2_k$ 分布的方差是 $2k$，所以 $\\mathrm{Var}[s^2] = \\frac{2\\sigma^4}{n-1}$。\n\n对于估计量 $\\widehat{\\sigma_C^2}$：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_C^2}] = \\mathrm{Var}[S_W^2 - \\sigma_M^2] = \\mathrm{Var}[S_W^2]\n$$\n$S_W^2 = \\frac{1}{D}\\sum_{d=1}^D S_{W,d}^2$。$S_{W,d}^2$ 项在不同器件 $d$ 之间是独立的。\n$$\n\\mathrm{Var}[S_W^2] = \\frac{1}{D^2} \\sum_{d=1}^D \\mathrm{Var}[S_{W,d}^2]\n$$\n每个 $S_{W,d}^2$ 是来自方差为 $\\sigma_C^2 + \\sigma_M^2$ 的总体的 $C$ 个样本的样本方差。因此，使用 $n=C$ 和 $\\sigma^2 = \\sigma_C^2 + \\sigma_M^2$ 的公式：\n$$\n\\mathrm{Var}[S_{W,d}^2] = \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{C-1}\n$$\n将此代回，我们得到：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_C^2}] = \\mathrm{Var}[S_W^2] = \\frac{1}{D^2} \\cdot D \\cdot \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{C-1} = \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{D(C-1)}\n$$\n\n对于估计量 $\\widehat{\\sigma_D^2}$：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\mathrm{Var}\\left[S_B^2 - \\frac{S_W^2}{C}\\right]\n$$\n在一个平衡的单向随机效应模型中，组间平方和（与 $S_B^2$ 相关）和组内平方和（与 $S_W^2$ 相关）是独立的。因此，$S_B^2$ 和 $S_W^2$ 是独立的，它们的协方差为零。\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\mathrm{Var}[S_B^2] + \\mathrm{Var}\\left[\\frac{S_W^2}{C}\\right] = \\mathrm{Var}[S_B^2] + \\frac{1}{C^2}\\mathrm{Var}[S_W^2]\n$$\n$S_B^2$ 是来自方差为 $\\mathrm{Var}[\\bar{y}_{d \\cdot}] = \\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}$ 的总体的 $D$ 个独立同分布样本 $\\bar{y}_{d \\cdot}$ 的样本方差。应用样本方差公式，其中 $n=D$ 且 $\\sigma^2 = \\mathrm{Var}[\\bar{y}_{d \\cdot}]$：\n$$\n\\mathrm{Var}[S_B^2] = \\frac{2(\\mathrm{Var}[\\bar{y}_{d \\cdot}])^2}{D-1} = \\frac{2}{D-1}\\left(\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\\right)^2\n$$\n代入 $\\mathrm{Var}[S_B^2]$ 和 $\\mathrm{Var}[S_W^2]$ 的表达式：\n$$\n\\mathrm{Var}[\\widehat{\\sigma_D^2}] = \\frac{2}{D-1}\\left(\\sigma_D^2 + \\frac{\\sigma_C^2 + \\sigma_M^2}{C}\\right)^2 + \\frac{1}{C^2} \\frac{2(\\sigma_C^2 + \\sigma_M^2)^2}{D(C-1)}\n$$\n\n最优实验设计\n\n目标是最小化方差估计量的相对标准误差平方和：\n$$\nJ(D,C) = \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_D^2}]}{\\sigma_D^2}\\right)^2 + \\left(\\frac{\\mathrm{SE}[\\widehat{\\sigma_C^2}]}{\\sigma_C^2}\\right)^2 = \\frac{\\mathrm{Var}[\\widehat{\\sigma_D^2}]}{(\\sigma_D^2)^2} + \\frac{\\mathrm{Var}[\\widehat{\\sigma_C^2}]}{(\\sigma_C^2)^2}\n$$\n最小化受约束条件 $D \\cdot C = N$ 和 $D, C$ 是 $\\ge 2$ 的整数。对于每个测试案例 $(N, \\sigma_D, \\sigma_C, \\sigma_M)$，我们枚举 $N$ 的所有有效的整数因子对 $(D, C)$。对每一对，我们使用推导出的方差表达式计算 $J(D,C)$。最优对 $(D^*, C^*)$ 是产生最小 $J(D,C)$ 值的那一对。如果出现并列，则选择具有较大 $D$ 值的设计。\n\n最后，对于最优对 $(D^*, C^*)$，计算并报告相应的标准误差 $\\mathrm{SE}[\\widehat{\\sigma_D^2}] = \\sqrt{\\mathrm{Var}[\\widehat{\\sigma_D^2}]}$ 和 $\\mathrm{SE}[\\widehat{\\sigma_C^2}] = \\sqrt{\\mathrm{Var}[\\widehat{\\sigma_C^2}]}$。方差是使用最优的 $(D^*, C^*)$ 和给定的真实方差分量来评估的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the optimal experimental design problem for estimating variance components\n    in a hierarchical Gaussian model for emerging memory devices.\n    \"\"\"\n    # Test cases: (N, sigma_D, sigma_C, sigma_M)\n    test_cases = [\n        (48, 3.0e-7, 2.0e-7, 5.0e-8),\n        (36, 1.0e-7, 5.0e-8, 2.0e-7),\n        (8, 5.0e-7, 1.0e-8, 1.0e-8),\n    ]\n\n    results = []\n    for N, sigma_D, sigma_C, sigma_M in test_cases:\n        result = find_optimal_design(N, sigma_D, sigma_C, sigma_M)\n        results.append(result)\n\n    # Format the output string as per the requirements.\n    # The string representation of each inner list must not contain spaces.\n    results_str = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\ndef find_optimal_design(N, sigma_D, sigma_C, sigma_M):\n    \"\"\"\n    Finds the optimal (D, C) pair for a given set of parameters.\n\n    Args:\n        N (int): Total number of measurements.\n        sigma_D (float): Standard deviation for device-to-device variability.\n        sigma_C (float): Standard deviation for cycle-to-cycle variability.\n        sigma_M (float): Standard deviation for measurement noise.\n\n    Returns:\n        list: A list containing [D_opt, C_opt, SE_D_opt, SE_C_opt].\n    \"\"\"\n    K_D = sigma_D**2\n    K_C = sigma_C**2\n    K_M = sigma_M**2\n\n    # Generate all valid integer factor pairs (D, C) of N, with D, C >= 2.\n    factors = []\n    for d_cand in range(2, int(N / 2) + 1):\n        if N % d_cand == 0:\n            c_cand = N // d_cand\n            if c_cand >= 2:\n                factors.append((d_cand, c_cand))\n    \n    # Add perfect square case if missed.\n    sqrt_N = int(np.sqrt(N))\n    if sqrt_N * sqrt_N == N and sqrt_N >= 2:\n      if (sqrt_N, sqrt_N) not in factors:\n        factors.append((sqrt_N, sqrt_N))\n\n    # Sort by D descending to handle the tie-breaking rule efficiently.\n    # The first pair found to minimize J will have the largest D among any ties.\n    factors.sort(key=lambda x: x[0], reverse=True)\n\n    min_J = float('inf')\n    optimal_pair = None\n\n    for D, C in factors:\n        var_K_D, var_K_C = calculate_estimator_variances(D, C, K_D, K_C, K_M)\n        \n        # The problem statement's parameters ensure K_D and K_C are non-zero.\n        J = (var_K_D / (K_D**2)) + (var_K_C / (K_C**2))\n        \n        if J  min_J:\n            min_J = J\n            optimal_pair = (D, C)\n    \n    if optimal_pair is None:\n        # This case should not be reached with the given test cases.\n        raise ValueError(f\"No valid (D, C) factorization found for N={N} with D, C = 2.\")\n        \n    D_opt, C_opt = optimal_pair\n    var_K_D_opt, var_K_C_opt = calculate_estimator_variances(D_opt, C_opt, K_D, K_C, K_M)\n    \n    se_K_D = np.sqrt(var_K_D_opt)\n    se_K_C = np.sqrt(var_K_C_opt)\n    \n    return [D_opt, C_opt, se_K_D, se_K_C]\n\ndef calculate_estimator_variances(D, C, K_D, K_C, K_M):\n    \"\"\"\n    Calculates the theoretical variances of the variance component estimators.\n    K_D, K_C, K_M are the variances (sigma^2).\n    \"\"\"\n    if D = 1 or C = 1:\n        return float('inf'), float('inf')\n\n    K_CM = K_C + K_M\n\n    # Variance of the cycle-to-cycle variance estimator\n    var_K_C = (2 * (K_CM**2)) / (D * (C - 1))\n\n    # Variance of the device-to-device variance estimator\n    term1_var_K_D = (2 / (D - 1)) * (K_D + K_CM / C)**2\n    term2_var_K_D = (2 * (K_CM**2)) / (D * (C**2) * (C - 1))\n    var_K_D = term1_var_K_D + term2_var_K_D\n\n    return var_K_D, var_K_C\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "除了编程周期之间的静态差异外，单个存储器件的电导也会随时间波动，这种现象被称为噪声。在这些新兴存储器中，两种常见的噪声类型是闪烁噪声（$1/f$ 噪声）和随机电报噪声（Random Telegraph Noise, RTN），它们源于不同的物理机制。\n\n本练习将挑战您设计一个测量协议，通过在时域和频域中分析器件行为，从而可靠地区分这两种噪声源。成功地分离噪声成分对于建立精确的器件模型和理解其不穩定性的物理根源至关重要。",
            "id": "4053935",
            "problem": "一个用作神经形态阵列中突触元件的电阻式随机存取存储器（RRAM）器件，表现出闪烁噪声（通常称为 $1/f$ 噪声）和随机电报噪声（RTN）。您希望设计一个测量协议，通过在频域和时域中进行联合分析，在单个静态偏置条件下可靠地分离这两种噪声机制。您的测量将使用采样频率为 $f_{s}$ 的数字转换器，在恒定偏置下采集器件电流 $I(t)$，进行一次持续时间为 $T_{\\text{obs}}$ 的单次连续观测。\n\n在频域中，您将使用一致性估计量（例如Welch方法）来估计功率谱密度（PSD），并评估频谱是否可以表示为闪烁项 $S_{1/f}(f)$ 和RTN项 $S_{\\text{RTN}}(f)$ 的和。在时域中，您将分析 $I(t)$ 的幅度直方图，以确定双电平RTN的双峰特性，并提取每个状态下的驻留时间统计数据，以检验是否存在无记忆跃迁。\n\n假设RTN源于一个双态连续时间马尔可夫过程，其跃迁率分别为 $\\lambda_{1}$（状态1到2）和 $\\lambda_{2}$（状态2到1）。平均驻留时间为 $\\tau_{1} = 1/\\lambda_{1}$ 和 $\\tau_{2} = 1/\\lambda_{2}$，该双态过程的相关时间为 $\\tau_{c} = 1/(\\lambda_{1} + \\lambda_{2}) = \\frac{\\tau_{1}\\,\\tau_{2}}{\\tau_{1} + \\tau_{2}}$。众所周知，理想双态RTN过程的PSD是洛伦兹型的，其角频率为 $f_{c} = 1/(2\\pi \\tau_{c})$，而闪烁噪声在相关频带内表现为 $S_{1/f}(f) \\propto 1/f$。\n\n为确保可靠地分离 $1/f$ 和RTN的贡献：\n\n- 在频域中，要求频率分辨率 $\\Delta f \\approx 1/T_{\\text{obs}}$ 是RTN角频率的一个分数 $\\eta$，即 $1/T_{\\text{obs}} \\leq \\eta f_{c}$，以便能够相对于 $1/f$ 背景定位洛伦兹角点。\n- 在时域中，要求每个状态下估计的平均驻留时间的相对标准差不大于目标值 $\\varepsilon$。对于平均值为 $\\tau$ 的指数驻留时间统计，来自 $N$ 次独立驻留测量的样本均值的标准差为 $\\tau/\\sqrt{N}$，因此相对标准差为 $1/\\sqrt{N}$。对每个状态施加 $1/\\sqrt{N} \\leq \\varepsilon$ 的约束，并利用以下事实：在长时间观测中，每个状态的预期驻留区间数近似为 $N \\approx T_{\\text{obs}}/(\\tau_{1} + \\tau_{2})$。\n\n在这些要求下，推导满足频域和时域约束的最小观测时间 $T_{\\text{obs}}$。然后，使用器件参数 $\\tau_{1} = 8~\\text{ms}$、$\\tau_{2} = 12~\\text{ms}$、分辨率分数 $\\eta = 0.05$ 和目标相对标准差 $\\varepsilon = 0.10$ 计算其数值。最终答案以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "所述问题在科学上是合理的、自洽的且表述清晰。它提出了一个在表征新兴存储器件噪声方面的现实场景，对一个关键实验参数——观测时间 $T_{\\text{obs}}$——建立了两个独立的约束条件，并要求找出满足这两个条件的最小值。所提供的物理模型和数学关系是电子噪声分析领域的标准内容。因此，我们可以进行推导。\n\n目标是找到能够同时满足频域约束和时域约束的最小观测时间 $T_{\\text{obs}}$，以可靠地分离闪烁噪声和随机电报噪声（RTN）。\n\n让我们分别分析每个约束，以确定 $T_{\\text{obs}}$ 的下界。\n\n首先，我们考虑频域约束。该约束确保功率谱密度（PSD）估计的频率分辨率 $\\Delta f$ 足够精细，以分辨RTN谱在其角频率 $f_c$ 附近的洛伦兹形状。频率分辨率从根本上受总观测时间的限制，有 $\\Delta f \\approx 1/T_{\\text{obs}}$。问题要求此分辨率为角频率的一个分数 $\\eta$：\n$$\n\\frac{1}{T_{\\text{obs}}} \\leq \\eta f_c\n$$\n这个不等式可以重新整理，以求出 $T_{\\text{obs}}$ 的下界：\n$$\nT_{\\text{obs}} \\geq \\frac{1}{\\eta f_c}\n$$\n角频率 $f_c$ 与双态RTN过程的相关时间 $\\tau_c$ 的关系为 $f_c = 1/(2\\pi\\tau_c)$。相关时间又是两个状态下平均驻留时间 $\\tau_1$ 和 $\\tau_2$ 的函数：\n$$\n\\tau_c = \\frac{1}{\\lambda_1 + \\lambda_2} = \\frac{1}{1/\\tau_1 + 1/\\tau_2} = \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}\n$$\n将这些表达式代入 $T_{\\text{obs}}$ 的不等式，得到第一个约束，我们将其表示为 $T_{\\text{obs, freq}}$：\n$$\nT_{\\text{obs}} \\geq \\frac{1}{\\eta \\left( \\frac{1}{2\\pi\\tau_c} \\right)} = \\frac{2\\pi\\tau_c}{\\eta} = \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}\n$$\n所以，频域约束所要求的最小时间是 $T_{\\text{obs, freq}} = \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}$。\n\n其次，我们考虑时域约束。该约束要求每个状态下估计的平均驻留时间的相对标准差不大于值 $\\varepsilon$。对于一个呈指数分布的随机变量的 $N$ 次独立测量，样本均值的相对标准差为 $1/\\sqrt{N}$。因此，对每个状态 $i$ 的约束是：\n$$\n\\frac{1}{\\sqrt{N_i}} \\leq \\varepsilon\n$$\n其中 $N_i$ 是观测到的状态 $i$ 的驻留区间数。这个不等式必须对 $i=1$ 和 $i=2$ 都成立。\n\n问题给出了一个近似关系，即对于长观测时间 $T_{\\text{obs}}$，每个状态的驻留次数为 $N \\approx T_{\\text{obs}}/(\\tau_1 + \\tau_2)$。这个关系是正确的。对于一个稳态双态马尔可夫过程，从状态 $i$ 跃出的速率等于跃入状态 $i$ 的速率。在时间 $T_{\\text{obs}}$ 内从状态1跃出的次数近似为 $N_1$。在状态1中花费的总时间是 $P_1 T_{\\text{obs}}$，其中 $P_1 = \\tau_1 / (\\tau_1 + \\tau_2)$ 是处于状态1的稳态概率。驻留次数是该状态下的总时间除以每次驻留的平均时间，即 $N_1 = (P_1 T_{\\text{obs}}) / \\tau_1 = (\\frac{\\tau_1}{\\tau_1+\\tau_2} T_{\\text{obs}}) / \\tau_1 = \\frac{T_{\\text{obs}}}{\\tau_1+\\tau_2}$。一个对称的论证得出 $N_2 = \\frac{T_{\\text{obs}}}{\\tau_1+\\tau_2}$。由于两个状态观测到的驻留次数相同，我们只需要对单个值 $N$ 满足约束：\n$$\nN = \\frac{T_{\\text{obs}}}{\\tau_1 + \\tau_2}\n$$\n将此代入约束 $1/\\sqrt{N} \\leq \\varepsilon$，我们得到：\n$$\n\\frac{1}{\\sqrt{\\frac{T_{\\text{obs}}}{\\tau_1 + \\tau_2}}} \\leq \\varepsilon\n$$\n两边平方得到：\n$$\n\\frac{\\tau_1 + \\tau_2}{T_{\\text{obs}}} \\leq \\varepsilon^2\n$$\n对 $T_{\\text{obs}}$ 重新整理，得到第二个下界，我们将其表示为 $T_{\\text{obs, time}}$：\n$$\nT_{\\text{obs}} \\geq \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2}\n$$\n所以，时域约束所要求的最小时间是 $T_{\\text{obs, time}} = \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2}$。\n\n为了同时满足频域和时域约束，总观测时间 $T_{\\text{obs}}$ 必须大于或等于这两个下界。因此，最小观测时间是两者的最大值：\n$$\nT_{\\text{obs, min}} = \\max\\left( T_{\\text{obs, freq}}, T_{\\text{obs, time}} \\right) = \\max\\left( \\frac{2\\pi}{\\eta} \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2}, \\frac{\\tau_1 + \\tau_2}{\\varepsilon^2} \\right)\n$$\n现在，我们代入给定的数值：\n$\\tau_1 = 8~\\text{ms} = 8 \\times 10^{-3}~\\text{s}$\n$\\tau_2 = 12~\\text{ms} = 12 \\times 10^{-3}~\\text{s}$\n$\\eta = 0.05$\n$\\varepsilon = 0.10$\n\n我们来计算这两个下界。\n\n对于频域界限, $T_{\\text{obs, freq}}$:\n$$\n\\tau_1 + \\tau_2 = (8 + 12) \\times 10^{-3}~\\text{s} = 20 \\times 10^{-3}~\\text{s} = 0.02~\\text{s}\n$$\n$$\n\\tau_1 \\tau_2 = (8 \\times 10^{-3}~\\text{s}) \\times (12 \\times 10^{-3}~\\text{s}) = 96 \\times 10^{-6}~\\text{s}^2\n$$\n$$\nT_{\\text{obs, freq}} = \\frac{2\\pi}{0.05} \\frac{96 \\times 10^{-6}~\\text{s}^2}{20 \\times 10^{-3}~\\text{s}} = 40\\pi \\times (4.8 \\times 10^{-3}~\\text{s}) = 0.192\\pi~\\text{s} \\approx 0.6031857...~\\text{s}\n$$\n对于时域界限, $T_{\\text{obs, time}}$:\n$$\n\\varepsilon^2 = (0.10)^2 = 0.01\n$$\n$$\nT_{\\text{obs, time}} = \\frac{0.02~\\text{s}}{0.01} = 2~\\text{s}\n$$\n我们现在求这两个值的最大值：\n$$\nT_{\\text{obs, min}} = \\max(0.6031857...~\\text{s}, 2~\\text{s}) = 2~\\text{s}\n$$\n所需的最小观测时间由时域约束决定。问题要求答案以秒为单位，并四舍五入到四位有效数字。\n\n$T_{\\text{obs, min}} = 2.000~\\text{s}$。",
            "answer": "$$\n\\boxed{2.000}\n$$"
        },
        {
            "introduction": "考虑到显著的器件间差异性，对于高精度计算任务而言，将神经形态阵列中的所有突触器件视为完全相同是不可行的。一个实用的解决方案是进行原位校准（in-situ calibration），以表征每个器件独特的响应特性。\n\n这项动手实践要求您设计一个闭环校准程序，以高效地估计单个器件的局部更新增益和偏置。您将需要确定达到目标精度所需的测量次数，这是为大规模神经形态系统设计高效校准协议的一项基本任务。",
            "id": "4053981",
            "problem": "考虑一个由新兴存储器件组成的神经形态突触阵列，其对小电压脉冲的电导响应表现出与器件相关的非理想性。每次校准测量都会施加一个小的写入电压 $v_i \\in \\mathbb{R}$，并观察到一个电导增量变化 $y_i \\in \\mathbb{R}$。假设在选定的工作点周围存在一个局部线性响应模型，该模型由偏置 $\\alpha$（单位：西门子）和局部更新增益 $\\beta = \\partial G / \\partial V$（单位：西门子/伏特）定义，因此测量模型为\n$$\ny_i = \\alpha + \\beta v_i + \\eta_i,\n$$\n其中 $\\eta_i$ 是独立的噪声项，满足高斯模型 $\\eta_i \\sim \\mathcal{N}(0,\\sigma^2)$，其已知标准差 $\\sigma$（单位：西门子）聚合了读取噪声和周期到周期的编程变异性。您将设计一个闭环校准程序，该程序重复施加写入电压以估计 $\\alpha$ 和 $\\beta$，然后推导出为保证两个参数达到规定的置信区间半宽所需的测量次数。\n\n闭环校准程序规范：\n- 在迭代 $i$ 时，选择一个固定幅值 $A  0$（单位：伏特）的电压 $v_i \\in \\{+A, -A\\}$。\n- 该选择是闭环的，旨在保持设计均衡，通过根据运行中的估计自适应地交替符号来强制 $\\sum_{i=1}^n v_i = 0$，以最小化估计量耦合。这确保了 $\\bar{v} = \\frac{1}{n}\\sum_i v_i = 0$ 和 $\\sum_i v_i^2 = nA^2$。\n- 进行 $n$ 次测量后，使用普通最小二乘（OLS）回归估计 $(\\alpha,\\beta)$，其设计矩阵的列为 $[1, v_i]$。\n\n利用均衡设计的特性，OLS 估计量协方差由以下基本结果确定\n$$\n\\operatorname{Cov}\\begin{pmatrix}\\hat{\\alpha} \\\\ \\hat{\\beta}\\end{pmatrix}\n= \\sigma^2 \\left(X^\\top X\\right)^{-1},\n$$\n并且在 $\\bar{v}=0$ 和对所有 $i$ 都有 $v_i^2=A^2$ 的条件下，边际方差满足\n$$\n\\operatorname{Var}(\\hat{\\alpha}) = \\frac{\\sigma^2}{n}, \\quad\n\\operatorname{Var}(\\hat{\\beta}) = \\frac{\\sigma^2}{nA^2}.\n$$\n假设噪声为高斯分布且参数未知，标准化的 OLS 估计量的抽样分布遵循具有 $n-2$ 个自由度的学生 t 分布。因此，$\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 的双侧 $(1-\\delta)$ 置信区间半宽为\n$$\nh_\\alpha(n) = t_{1-\\delta/2}(n-2)\\sqrt{\\frac{\\sigma^2}{n}}, \\quad\nh_\\beta(n) = t_{1-\\delta/2}(n-2)\\sqrt{\\frac{\\sigma^2}{nA^2}},\n$$\n其中 $t_{1-\\delta/2}(n-2)$ 表示具有 $n-2$ 个自由度的学生 t 分布的 $(1-\\delta/2)$ 分位数。校准目标是选择最小的偶数整数 $n \\geq 4$，使得 $h_\\alpha(n) \\le \\varepsilon_\\alpha$ 和 $h_\\beta(n) \\le \\varepsilon_\\beta$ 同时成立，其中 $\\varepsilon_\\alpha$（单位：西门子）和 $\\varepsilon_\\beta$（单位：西门子/伏特）是规定的半宽容差。\n\n任务：\n- 实现一个程序，给定 $(\\sigma, A, \\varepsilon_\\alpha, \\varepsilon_\\beta, \\delta)$，计算满足上述两个不等式的最小偶数整数 $n \\ge 4$。如果 $\\sigma = 0$，则返回 $n=4$。\n- 使用一个对偶数 $n$ 的搜索过程，该过程计算 $t_{1-\\delta/2}(n-2)$ 和半宽，直到两个约束都得到满足。\n\n物理单位：\n- 电导偏置 $\\alpha$ 必须以西门子（$\\mathrm{S}$）为单位。\n- 局部更新增益 $\\beta$ 必须以西门子/伏特（$\\mathrm{S}/\\mathrm{V}$）为单位。\n- 电压幅值 $A$ 必须以伏特（$\\mathrm{V}$）为单位。\n- 噪声标准差 $\\sigma$ 必须以西门子（$\\mathrm{S}$）为单位。\n\n角度单位不适用。所有分数或比率输出必须以小数形式表示。\n\n测试套件：\n为以下参数集提供结果，单位如上所述：\n1. $\\sigma = 5\\times 10^{-6}$, $A = 0.2$, $\\varepsilon_\\alpha = 5\\times 10^{-6}$, $\\varepsilon_\\beta = 1\\times 10^{-5}$, $\\delta = 0.05$.\n2. $\\sigma = 1\\times 10^{-6}$, $A = 0.3$, $\\varepsilon_\\alpha = 2\\times 10^{-6}$, $\\varepsilon_\\beta = 5\\times 10^{-6}$, $\\delta = 0.10$.\n3. $\\sigma = 5\\times 10^{-6}$, $A = 0.05$, $\\varepsilon_\\alpha = 5\\times 10^{-6}$, $\\varepsilon_\\beta = 5\\times 10^{-6}$, $\\delta = 0.01$.\n4. $\\sigma = 0$, $A = 0.1$, $\\varepsilon_\\alpha = 1\\times 10^{-6}$, $\\varepsilon_\\beta = 1\\times 10^{-6}$, $\\delta = 0.05$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所得的测量次数，形式为逗号分隔的整数列表，并用方括号括起来，例如，“[n1,n2,n3,n4]”。",
            "solution": "我们从这样一个原理出发：围绕一个工作点的局部线性响应模型可以通过对电导更新相对于施加电压的一阶泰勒展开来证明其合理性。将观察到的电导增量变化表示为 $y_i$，施加的电压脉冲表示为 $v_i$。局部模型为\n$$\ny_i = \\alpha + \\beta v_i + \\eta_i,\n$$\n其中 $\\alpha$ 是局部偏置，单位为西门子，$\\beta = \\partial G/\\partial V$ 是局部更新增益，单位为西门子/伏特。噪声项 $\\eta_i$ 捕捉了器件的非理想性，包括读取噪声和周期到周期的变异性，并被建模为均值为零、方差为 $\\sigma^2$ 的独立高斯噪声。\n\n闭环校准设计选择 $v_i \\in \\{+A,-A\\}$，并通过根据当前估计或运行残差自适应地交替符号来强制实现平衡 $\\sum_i v_i = 0$，从而为施加的电压保持零均值。这种平衡很重要，因为它最小化了估计量的协方差，并简化了普通最小二乘（OLS）估计量的方差。设 $X$ 为 $n \\times 2$ 的设计矩阵，其第一列全为1，第二列为 $v_i$。OLS 估计量由下式给出\n$$\n\\begin{pmatrix}\\hat{\\alpha} \\\\ \\hat{\\beta}\\end{pmatrix}\n= \\left(X^\\top X\\right)^{-1} X^\\top \\mathbf{y},\n$$\n其中 $\\mathbf{y} = (y_1,\\dots,y_n)^\\top$。\n\n在均衡设计下，我们有 $\\bar{v} = \\frac{1}{n}\\sum_{i=1}^n v_i = 0$ 和 $\\sum_{i=1}^n v_i^2 = nA^2$。在同方差高斯模型中，OLS 估计量协方差的经过充分检验的公式是\n$$\n\\operatorname{Cov}\\left(\\begin{pmatrix}\\hat{\\alpha} \\\\ \\hat{\\beta}\\end{pmatrix}\\right)\n= \\sigma^2 \\left(X^\\top X\\right)^{-1}.\n$$\n利用以下结构\n$$\nX^\\top X = \\begin{pmatrix}\nn  \\sum_i v_i \\\\\n\\sum_i v_i  \\sum_i v_i^2\n\\end{pmatrix}\n= \\begin{pmatrix}\nn  0 \\\\\n0  nA^2\n\\end{pmatrix},\n$$\n我们得到\n$$\n\\left(X^\\top X\\right)^{-1}\n= \\begin{pmatrix}\n\\frac{1}{n}  0 \\\\\n0  \\frac{1}{nA^2}\n\\end{pmatrix},\n$$\n这直接导出了边际方差\n$$\n\\operatorname{Var}(\\hat{\\alpha}) = \\frac{\\sigma^2}{n}, \\quad\n\\operatorname{Var}(\\hat{\\beta}) = \\frac{\\sigma^2}{nA^2}.\n$$\n\n当 $\\sigma^2$ 未知但高斯假设成立时，由于使用了无偏方差估计并且估计了两个参数，标准化的估计量遵循具有 $n-2$ 个自由度的学生 t 分布。于是，$(1-\\delta)$ 双侧置信区间的半宽形式为\n$$\nh_\\alpha(n) = t_{1-\\delta/2}(n-2)\\sqrt{\\frac{\\sigma^2}{n}}, \\quad\nh_\\beta(n) = t_{1-\\delta/2}(n-2)\\sqrt{\\frac{\\sigma^2}{nA^2}},\n$$\n其中 $t_{1-\\delta/2}(n-2)$ 是具有 $n-2$ 个自由度的学生 t 分布的 $(1-\\delta/2)$ 分位数。\n\n校准要求是对于给定的容差 $\\varepsilon_\\alpha$ 和 $\\varepsilon_\\beta$，满足 $h_\\alpha(n) \\le \\varepsilon_\\alpha$ 和 $h_\\beta(n) \\le \\varepsilon_\\beta$。代入公式得到两个不等式：\n$$\nt_{1-\\delta/2}(n-2)\\frac{\\sigma}{\\sqrt{n}} \\le \\varepsilon_\\alpha, \\quad\nt_{1-\\delta/2}(n-2)\\frac{\\sigma}{\\sqrt{n}A} \\le \\varepsilon_\\beta.\n$$\n因为 $t_{1-\\delta/2}(n-2)$ 依赖于 $n$，所以不存在 $n$ 的闭式解。然而，不等式两边相对于 $n$ 的单调性允许对偶数整数 $n \\ge 4$（以保持设计完全均衡）进行简单搜索，直到两个约束都满足为止。\n\n程序中使用的算法步骤：\n1. 对于每个测试用例，如果 $\\sigma = 0$，则返回 $n=4$，因为无噪声测量会使置信区间塌陷为零，而最小的偶数 $n$ 且自由度至少为 $n-2  0$（即$n2$）是 $4$。\n2. 否则，初始化 $n=4$，并以 2 为步长迭代增加 $n$。\n3. 在每个 $n$ 值，从学生 t 分布计算分位数 $q = t_{1-\\delta/2}(n-2)$。\n4. 计算 $h_\\alpha(n) = q \\,\\sigma / \\sqrt{n}$ 和 $h_\\beta(n) = q \\,\\sigma / (\\sqrt{n}A)$。\n5. 如果 $h_\\alpha(n) \\le \\varepsilon_\\alpha$ 和 $h_\\beta(n) \\le \\varepsilon_\\beta$ 同时满足，停止并返回 $n$；否则增加 $n$ 并继续。\n\n此过程确保找到满足两个置信区间约束的最小偶数 $n$。测试套件的参数以明确的单位给出，程序以指定的单行格式输出所需测量次数的列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import t\n\ndef required_measurements(sigma, A, eps_alpha, eps_beta, delta, max_n=1000000):\n    \"\"\"\n    Compute the smallest even integer n = 4 such that:\n      t_{1-delta/2}(n-2) * sigma / sqrt(n)      = eps_alpha\n      t_{1-delta/2}(n-2) * sigma / (sqrt(n)*A)  = eps_beta\n    If sigma == 0, return 4.\n    \"\"\"\n    # Handle noiseless case: minimal balanced design with df = n-2 = 2 - n = 4\n    if sigma == 0.0:\n        return 4\n\n    # Start from the smallest even n with df = 2\n    n = 4\n    # Sanity checks for parameters\n    if A = 0 or eps_alpha = 0 or eps_beta = 0 or not (0  delta  1):\n        # Invalid parameters; in a robust system we might raise an error.\n        # Here, return -1 to indicate failure.\n        return -1\n\n    while n = max_n:\n        df = n - 2\n        # Compute the t quantile for two-sided (1 - delta) CI\n        q = t.ppf(1 - delta / 2.0, df)\n        # Half-widths for alpha and beta\n        h_alpha = q * sigma / np.sqrt(n)\n        h_beta = q * sigma / (np.sqrt(n) * A)\n        if (h_alpha = eps_alpha) and (h_beta = eps_beta):\n            return n\n        n += 2  # maintain even n for balanced design\n\n    # If not found within max_n, indicate failure\n    return -1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (sigma [S], A [V], eps_alpha [S], eps_beta [S/V], delta)\n    test_cases = [\n        (5e-6, 0.2, 5e-6, 1e-5, 0.05),\n        (1e-6, 0.3, 2e-6, 5e-6, 0.10),\n        (5e-6, 0.05, 5e-6, 5e-6, 0.01),\n        (0.0, 0.1, 1e-6, 1e-6, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma, A, eps_alpha, eps_beta, delta = case\n        n = required_measurements(sigma, A, eps_alpha, eps_beta, delta)\n        results.append(n)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}