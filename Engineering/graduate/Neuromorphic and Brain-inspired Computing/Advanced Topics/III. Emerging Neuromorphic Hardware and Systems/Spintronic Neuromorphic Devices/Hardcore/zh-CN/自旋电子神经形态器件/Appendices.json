{
    "hands_on_practices": [
        {
            "introduction": "任何自旋电子学器件的设计都始于对自旋流基本物理原理的深刻理解。本练习旨在为您的学习奠定坚实的基础，通过从第一性原理出发，将电子的量子力学特性（自旋）与宏观的输运现象（电荷流和自旋流）联系起来。通过完成这项实践，您将推导出描述自旋极化电流如何携带自旋角动量的关键方程，这是分析所有自旋扭矩效应的核心。",
            "id": "4060763",
            "problem": "一根铁磁纳米线被用作神经形态交叉阵列中的可编程突触。当自旋极化电荷电流密度 $J$ 沿纳米线流动时，自旋角动量输运到下游功能区会调制局部磁序，从而实现突触权重的更新。假设有以下物理上标准的定义：\n- 电荷电流密度 $J$ 与载流子数通量密度通过 $J = q \\Phi$ 相关，其中 $q$ 是基本电荷量值，$\\Phi$ 是总电子数通量密度（单位面积单位时间内的数量）。\n- 沿磁化轴的自旋极化率 $P$ 定义为 $P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi_{\\uparrow} + \\Phi_{\\downarrow}}$，其中 $\\Phi_{\\uparrow}$ 和 $\\Phi_{\\downarrow}$ 分别是与磁化方向平行和反平行对齐的自旋分辨数通量密度。\n- 每个电子沿量子化轴携带的自旋角动量投影大小为 $\\hbar/2$，其中 $\\hbar$ 是约化普朗克常数。\n\n仅从这些定义和基本常数出发，推导出自旋角动量通量密度大小（沿磁化轴单位面积单位时间内输运的净自旋角动量）的表达式，该表达式应以 $P$、$J$、$\\hbar$ 和 $e$（基本电荷）表示。然后，对于输运自旋极化率 $P = 0.72$ 和电荷电流密度 $J = 2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$，对其进行数值计算。\n\n使用国际单位制（SI）定义的精确值 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$ 和 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$，并取 $\\hbar = \\frac{h}{2\\pi}$。将最终数值结果四舍五入到四位有效数字。以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示最终的自旋角动量通量密度大小。",
            "solution": "该问题已经过验证，被认为是具有科学依据、良定且客观的。其中不包含不一致或含糊之处。因此，我们可以开始解答。\n\n问题要求推导自旋角动量通量密度大小的表达式，我们将其记为 $J_S$。这个量表示单位面积单位时间内输运的净自旋角动量。该输运由自旋极化电子介导。\n\n设 $\\Phi_{\\uparrow}$ 为自旋与磁化轴对齐（自旋向上）的电子的数通量密度，$\\Phi_{\\downarrow}$ 为自旋与磁化轴反向对齐（自旋向下）的电子的数通量密度。每个自旋向上的电子携带 $+\\frac{\\hbar}{2}$ 的自旋角动量，每个自旋向下的电子携带 $-\\frac{\\hbar}{2}$ 的自旋角动量，其中 $\\hbar$ 是约化普朗克常数。\n\n来自自旋向上电子的自旋角动量通量密度是其数通量密度与每个电子角动量的乘积：$J_{S,\\uparrow} = \\Phi_{\\uparrow} \\left(\\frac{\\hbar}{2}\\right)$。\n类似地，来自自旋向下电子的通量密度为 $J_{S,\\downarrow} = \\Phi_{\\downarrow} \\left(-\\frac{\\hbar}{2}\\right)$。\n\n净自旋角动量通量密度 $J_S$ 是这两个贡献之和：\n$$J_S = J_{S,\\uparrow} + J_{S,\\downarrow} = \\Phi_{\\uparrow} \\left(\\frac{\\hbar}{2}\\right) - \\Phi_{\\downarrow} \\left(\\frac{\\hbar}{2}\\right)$$\n$$J_S = \\frac{\\hbar}{2} (\\Phi_{\\uparrow} - \\Phi_{\\downarrow})$$\n\n我们现在必须用给定的量 $P$、$J$ 和 $e$ 来表示 $(\\Phi_{\\uparrow} - \\Phi_{\\downarrow})$。问题给出了自旋极化率 $P$ 的定义：\n$$P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi_{\\uparrow} + \\Phi_{\\downarrow}}$$\n分母 $\\Phi_{\\uparrow} + \\Phi_{\\downarrow}$ 是总电子数通量密度，我们用 $\\Phi$ 表示。所以，$\\Phi = \\Phi_{\\uparrow} + \\Phi_{\\downarrow}$。\n将 $\\Phi$ 代入 $P$ 的表达式中，我们得到：\n$$P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi}$$\n由此，我们可以将自旋分辨通量之差表示为：\n$$\\Phi_{\\uparrow} - \\Phi_{\\downarrow} = P \\Phi$$\n\n将此结果代入我们关于 $J_S$ 的方程中：\n$$J_S = \\frac{\\hbar}{2} (P \\Phi) = \\frac{P \\hbar \\Phi}{2}$$\n\n最后一步是将总电子数通量密度 $\\Phi$ 与电荷电流密度 $J$ 联系起来。问题指出 $J = q \\Phi$，其中 $q$ 是基本电荷量值。问题也给出了基本电荷的符号 $e$。因此，我们有 $q = e$。\n$$J = e \\Phi$$\n解出 $\\Phi$ 得到：\n$$\\Phi = \\frac{J}{e}$$\n\n现在我们将这个 $\\Phi$ 的表达式代入我们关于 $J_S$ 的方程中：\n$$J_S = \\frac{P \\hbar}{2} \\left(\\frac{J}{e}\\right)$$\n$$J_S = \\frac{P \\hbar J}{2e}$$\n这就是最终推导出的自旋角动量通量密度大小的表达式。\n\n接下来，我们必须对这个表达式进行数值计算。给定的值为：\n- 自旋极化率 $P = 0.72$\n- 电荷电流密度 $J = 2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$\n- 约化普朗克常数定义为 $\\hbar = \\frac{h}{2\\pi}$。\n\n让我们将这些值代入推导出的公式中：\n$$J_S = \\frac{(0.72) \\left(\\frac{6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}}{2\\pi}\\right) (2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2})}{2 (1.602176634 \\times 10^{-19}\\ \\mathrm{C})}$$\n单位可以验证是正确的。由于 $1\\ \\mathrm{A} = 1\\ \\mathrm{C}/\\mathrm{s}$，单位变为：\n$$\\frac{(\\mathrm{J}\\,\\mathrm{s}) (\\mathrm{C}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2})}{(\\mathrm{C})} = \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n这与最终答案所需的单位相匹配。\n\n现在我们进行计算：\n首先，我们计算约化普朗克常数 $\\hbar$：\n$$\\hbar = \\frac{6.62607015 \\times 10^{-34}}{2\\pi} \\approx 1.054571817 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$$\n然后，我们计算 $J_S$：\n$$J_S = \\frac{(0.72) \\times (1.054571817 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}) \\times (2.50 \\times 10^{10}\\ \\mathrm{s}^{-1}\\,\\mathrm{m}^{-2} \\cdot e)}{2e}$$\n这里的电荷单位 $e$ 是符号性的，让我们使用数值：\n$$J_S = \\frac{(0.72) \\times (1.054571817 \\times 10^{-34}) \\times (2.50 \\times 10^{10})}{2 \\times (1.602176634 \\times 10^{-19})}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n$$J_S = \\frac{1.89822927 \\times 10^{-24}}{3.204353268 \\times 10^{-19}}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n$$J_S \\approx 5.923983 \\times 10^{-6}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n问题要求将最终数值结果四舍五入到四位有效数字。\n$$J_S \\approx 5.924 \\times 10^{-6}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$",
            "answer": "$$\\boxed{5.924 \\times 10^{-6}}$$"
        },
        {
            "introduction": "在掌握了理想器件的物理原理之后，下一步是应对在现实世界中制造这些器件所带来的挑战。纳米级器件的制造过程不可避免地会引入物理尺寸上的差异，这对器件性能和整个系统的成品率有着深远的影响。本练习将引导您探讨一个关键问题：自由层厚度的微小变化如何通过统计模型影响器件的开关电流分布，并最终决定可接受器件的成品率，从而将器件物理学与大规模集成所面临的工程现实联系起来。",
            "id": "4060772",
            "problem": "考虑一个使用自旋转移矩磁性随机存取存储器（STT-MRAM）实现的自旋电子突触设备。在固定的磁性材料参数和固定的柱面积下，众所周知，零温临界翻转电流与自由层厚度成线性比例关系，这是因为自旋转移矩与磁体积成正比。设翻转电流的模型为 $I_{\\text{sw}}(t) = \\kappa \\, t$，其中 $t$ 是自由层的厚度（单位为米），$\\kappa$ 是一个与设备相关的比例常数（单位为安培/米）。\n\n由于制造工艺的可变性，自由层厚度 $T$ 被建模为一个对数正态随机变量，其在自然对数域中的参数为 $\\mu_t$ 和 $\\sigma_t$，因此 $\\ln T \\sim \\mathcal{N}(\\mu_t, \\sigma_t^2)$ 且 $T = \\exp(X)$，其中 $X \\sim \\mathcal{N}(\\mu_t, \\sigma_t^2)$。设计意图将厚度中位数设定为目标厚度 $t_{\\text{design}}$，这意味着 $\\mu_t = \\ln(t_{\\text{design}})$。\n\n定义标称电流为 $I_{\\text{nom}} = \\kappa \\, t_{\\text{design}}$。如果一个器件的翻转电流位于对称容差窗口 $[I_{\\text{low}}, I_{\\text{high}}]$ 内，则认为该器件是可接受的，其中 $I_{\\text{low}} = I_{\\text{nom}} \\, (1 - \\delta)$ 且 $I_{\\text{high}} = I_{\\text{nom}} \\, (1 + \\delta)$，而 $\\delta \\in (0,1)$ 是分数容差。良率是概率 $Y = \\mathbb{P}\\left(I_{\\text{low}} \\le I_{\\text{sw}}(T) \\le I_{\\text{high}}\\right)$，以小数形式表示（而非百分比）。\n\n从以下事实出发：(i) 翻转电流与厚度成线性比例，(ii) 对数正态分布在正向缩放下是封闭的，推导 $I_{\\text{sw}}(T)$ 的分布，计算其均值和标准差，并对指定的参数集评估良率 $Y$。使用标准正态累积分布函数 $\\Phi(x)$ 来评估对数正态累积分布函数，其中 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$，$\\operatorname{erf}(\\cdot)$ 表示高斯误差函数。\n\n您的程序必须：\n- 对于每个测试用例，计算翻转电流分布的均值和标准差（单位为毫安，mA）以及良率（以小数形式表示）。均值和标准差必须以表示 mA 值的浮点数形式返回，良率必须以区间 $[0,1]$ 内的浮点数形式返回。输出中不应包含任何单位符号。\n- 使用 $\\mu_t = \\ln(t_{\\text{design}})$（单位为米）和给定的 $\\sigma_t$。\n- 使用 $I_{\\text{sw}}(t) = \\kappa \\, t$，其中 $\\kappa$ 以安培/米为单位提供。\n- 计算 $I_{\\text{nom}} = \\kappa \\, t_{\\text{design}}$、$I_{\\text{low}} = I_{\\text{nom}} (1 - \\delta)$ 和 $I_{\\text{high}} = I_{\\text{nom}} (1 + \\delta)$。\n- 在解析评估中，当 $\\sigma_t = 0$ 时，将分布视为在 $I_{\\text{nom}}$ 处的退化分布，并相应地计算良率。\n\n使用以下测试套件，其中每个测试用例为 $(t_{\\text{design}} \\text{ 单位 nm}, \\kappa \\text{ 单位 A/m}, \\sigma_t, \\delta)$：\n1. $(1.2, 6 \\times 10^{4}, 0.1, 0.2)$ 作为具有中等可变性和宽窗口的一般情况。\n2. $(1.1, 6 \\times 10^{4}, 0.02, 0.05)$ 作为具有紧密窗口的近理想制造情况。\n3. $(1.3, 6 \\times 10^{4}, 0.3, 0.1)$ 作为具有中等窗口的高可变性情况。\n4. $(1.2, 6 \\times 10^{4}, 0.0, 0.1)$ 作为零可变性的边界情况。\n\n将均值和标准差以毫安（mA）表示，计算时均四舍五入到六位小数；将良率以小数形式表示，计算时四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例 $i$，按顺序附加三元组 $[\\text{mean}_i, \\text{std}_i, \\text{yield}_i]$，并将其平展成单个列表，即最终输出必须为 $[\\text{mean}_1,\\text{std}_1,\\text{yield}_1,\\text{mean}_2,\\text{std}_2,\\text{yield}_2,\\text{mean}_3,\\text{std}_3,\\text{yield}_3,\\text{mean}_4,\\text{std}_4,\\text{yield}_4]$ 的形式。",
            "solution": "该问题提法清晰，具有科学依据，并提供了推导唯一解所需的所有信息。我们首先进行解析推导，然后进行数值实现。\n\n### 步骤 1：翻转电流 $I_{\\text{sw}}(T)$ 的分布\n\n问题陈述翻转电流 $I_{\\text{sw}}$ 是自由层厚度 $t$ 的线性函数：\n$$\nI_{\\text{sw}}(t) = \\kappa \\, t\n$$\n其中 $\\kappa$ 是一个常数。厚度 $T$ 是一个随机变量，被建模为对数正态分布，因此其自然对数 $\\ln T$ 服从正态分布 $\\mathcal{N}(\\mu_t, \\sigma_t^2)$。\n\n给定厚度分布的中位数是设计目标 $t_{\\text{design}}$。对于对数正态分布，中位数为 $\\exp(\\mu_t)$。因此，我们有 $\\exp(\\mu_t) = t_{\\text{design}}$，这意味着 $\\mu_t = \\ln(t_{\\text{design}})$。\n\n为了找到翻转电流 $I_{\\text{sw}}(T)$ 的分布，我们对 $I_{\\text{sw}}(T)$ 的表达式取自然对数：\n$$\n\\ln(I_{\\text{sw}}(T)) = \\ln(\\kappa \\, T) = \\ln(\\kappa) + \\ln(T)\n$$\n由于 $\\ln(T)$ 是一个服从正态分布 $\\mathcal{N}(\\mu_t, \\sigma_t^2)$ 的随机变量，而 $\\ln(\\kappa)$ 是一个常数，它们的和 $\\ln(I_{\\text{sw}}(T))$ 也是一个服从正态分布的随机变量。我们将这个新正态分布的参数表示为 $\\mu_I$ 和 $\\sigma_I^2$。\n\n$\\ln(I_{\\text{sw}}(T))$ 的均值是：\n$$\n\\mu_I = \\mathbb{E}[\\ln(I_{\\text{sw}}(T))] = \\mathbb{E}[\\ln(\\kappa) + \\ln(T)] = \\ln(\\kappa) + \\mathbb{E}[\\ln(T)] = \\ln(\\kappa) + \\mu_t\n$$\n代入 $\\mu_t = \\ln(t_{\\text{design}})$：\n$$\n\\mu_I = \\ln(\\kappa) + \\ln(t_{\\text{design}}) = \\ln(\\kappa \\, t_{\\text{design}})\n$$\n我们识别出项 $\\kappa \\, t_{\\text{design}}$ 是标称电流 $I_{\\text{nom}}$。因此，$\\mu_I = \\ln(I_{\\text{nom}})$。\n\n$\\ln(I_{\\text{sw}}(T))$ 的方差是：\n$$\n\\sigma_I^2 = \\operatorname{Var}(\\ln(I_{\\text{sw}}(T))) = \\operatorname{Var}(\\ln(\\kappa) + \\ln(T)) = \\operatorname{Var}(\\ln(T)) = \\sigma_t^2\n$$\n所以，$\\sigma_I = \\sigma_t$。\n\n这个结果表明，翻转电流 $I_{\\text{sw}}(T)$ 也是一个对数正态分布的随机变量，其对数 $\\ln(I_{\\text{sw}}(T))$ 服从正态分布 $\\mathcal{N}(\\ln(I_{\\text{nom}}), \\sigma_t^2)$。\n\n### 步骤 2：$I_{\\text{sw}}(T)$ 的均值和标准差\n\n对于一个对数正态随机变量 $Z$，其中 $\\ln(Z) \\sim \\mathcal{N}(\\mu_z, \\sigma_z^2)$，其均值和方差由以下公式给出：\n$$\n\\mathbb{E}[Z] = \\exp\\left(\\mu_z + \\frac{\\sigma_z^2}{2}\\right)\n$$\n$$\n\\operatorname{Var}(Z) = \\left[\\exp(\\sigma_z^2) - 1\\right] \\exp(2\\mu_z + \\sigma_z^2)\n$$\n将这些公式应用于 $I_{\\text{sw}}(T)$，参数为 $\\mu_I = \\ln(I_{\\text{nom}})$ 和 $\\sigma_I = \\sigma_t$，我们得到：\n\n翻转电流的均值是：\n$$\n\\mathbb{E}[I_{\\text{sw}}(T)] = \\exp\\left(\\ln(I_{\\text{nom}}) + \\frac{\\sigma_t^2}{2}\\right) = \\exp(\\ln(I_{\\text{nom}})) \\exp\\left(\\frac{\\sigma_t^2}{2}\\right) = I_{\\text{nom}} \\exp\\left(\\frac{\\sigma_t^2}{2}\\right)\n$$\n\n翻转电流的方差是：\n$$\n\\operatorname{Var}(I_{\\text{sw}}(T)) = \\left[\\exp(\\sigma_t^2) - 1\\right] \\exp(2\\ln(I_{\\text{nom}}) + \\sigma_t^2) = \\left[\\exp(\\sigma_t^2) - 1\\right] (\\exp(\\ln(I_{\\text{nom}})))^2 \\exp(\\sigma_t^2) = I_{\\text{nom}}^2 (\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)\n$$\n标准差是方差的平方根：\n$$\n\\text{StdDev}[I_{\\text{sw}}(T)] = \\sqrt{\\operatorname{Var}(I_{\\text{sw}}(T))} = I_{\\text{nom}} \\sqrt{(\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)}\n$$\n\n### 步骤 3：良率计算\n\n良率 $Y$ 是翻转电流 $I_{\\text{sw}}(T)$ 落在可接受范围 $[I_{\\text{low}}, I_{\\text{high}}]$ 内的概率：\n$$\nY = \\mathbb{P}(I_{\\text{low}} \\le I_{\\text{sw}}(T) \\le I_{\\text{high}}) = F_I(I_{\\text{high}}) - F_I(I_{\\text{low}})\n$$\n其中 $F_I(x)$ 是 $I_{\\text{sw}}(T)$ 的累积分布函数 (CDF)。\n\n对数正态变量 $Z$（参数为 $\\mu_z, \\sigma_z$）的 CDF 由 $F_Z(x) = \\Phi\\left(\\frac{\\ln(x) - \\mu_z}{\\sigma_z}\\right)$ 给出，其中 $\\Phi$ 是标准正态分布的 CDF。对于 $I_{\\text{sw}}(T)$，我们使用其参数 $\\mu_I = \\ln(I_{\\text{nom}})$ 和 $\\sigma_I = \\sigma_t$：\n$$\nY = \\Phi\\left(\\frac{\\ln(I_{\\text{high}}) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(I_{\\text{low}}) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right)\n$$\n代入 $I_{\\text{high}} = I_{\\text{nom}}(1 + \\delta)$ 和 $I_{\\text{low}} = I_{\\text{nom}}(1 - \\delta)$：\n$$\nY = \\Phi\\left(\\frac{\\ln(I_{\\text{nom}}(1 + \\delta)) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(I_{\\text{nom}}(1 - \\delta)) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right)\n$$\n使用属性 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们简化参数：\n$$\nY = \\Phi\\left(\\frac{\\ln(1 + \\delta)}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(1 - \\delta)}{\\sigma_t}\\right)\n$$\n问题提供了用于数值评估的关系式 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$。\n\n### 步骤 4：$\\sigma_t = 0$ 的特殊情况\n\n当 $\\sigma_t = 0$ 时，制造过程没有可变性。厚度分布变为退化分布，意味着厚度 $T$ 是一个等于其中位数（也是均值）$t_{\\text{design}}$ 的常数。\n$$\nT = t_{\\text{design}} \\quad \\text{概率为 } 1\n$$\n因此，翻转电流也是确定性的：\n$$\nI_{\\text{sw}} = \\kappa \\, t_{\\text{design}} = I_{\\text{nom}}\n$$\n$I_{\\text{sw}}$ 的分布是一个以 $I_{\\text{nom}}$ 为中心的狄拉克δ函数。均值为 $I_{\\text{nom}}$，标准差为 $0$。\n\n良率是这个确定性值落在容差窗口内的概率：\n$$\nY = \\mathbb{P}(I_{\\text{nom}}(1-\\delta) \\le I_{\\text{nom}} \\le I_{\\text{nom}}(1+\\delta))\n$$\n因为 $\\delta \\in (0, 1)$，所以 $1-\\delta  1$ 和 $1+\\delta > 1$ 恒成立。由于 $I_{\\text{nom}} > 0$，不等式 $I_{\\text{nom}}(1-\\delta) \\le I_{\\text{nom}} \\le I_{\\text{nom}}(1+\\delta)$ 成立。因此，概率为 1，良率 $Y=1$。\n\n### 实现公式摘要\n对于给定的测试用例 $(t_{\\text{design}}, \\kappa, \\sigma_t, \\delta)$：\n1. 将 $t_{\\text{design}}$ 从纳米转换为米：$t_{\\text{design, m}} = t_{\\text{design, nm}} \\times 10^{-9}$。\n2. 计算标称电流：$I_{\\text{nom}} = \\kappa \\, t_{\\text{design, m}}$（单位为安培）。\n3. 如果 $\\sigma_t = 0$：\n    - 均值电流：$I_{\\text{nom}}$。\n    - 标准差：$0$。\n    - 良率：$1$。\n4. 如果 $\\sigma_t > 0$：\n    - 均值电流：$I_{\\text{nom}} \\exp(\\sigma_t^2 / 2)$。\n    - 标准差：$I_{\\text{nom}} \\sqrt{(\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)}$。\n    - 良率：$\\Phi\\left(\\frac{\\ln(1 + \\delta)}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(1 - \\delta)}{\\sigma_t}\\right)$，使用 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$。\n5. 将最终的均值和标准差从安培转换为毫安（mA），方法是乘以 $1000$。\n6. 将所有三个最终值（均值（mA）、标准差（mA）、良率）四舍五入到六位小数。\n\n这就完成了解决该问题所需的解析推导。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the spintronic device yield problem based on the provided parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is (t_design in nm, kappa in A/m, sigma_t, delta)\n    test_cases = [\n        (1.2, 6e4, 0.1, 0.2),\n        (1.1, 6e4, 0.02, 0.05),\n        (1.3, 6e4, 0.3, 0.1),\n        (1.2, 6e4, 0.0, 0.1)\n    ]\n\n    results = []\n\n    def std_norm_cdf(x):\n        \"\"\"\n        Computes the standard normal cumulative distribution function (CDF), Phi(x),\n        using the Gauss error function as specified.\n        \"\"\"\n        return 0.5 * (1.0 + erf(x / np.sqrt(2.0)))\n\n    for t_design_nm, kappa, sigma_t, delta in test_cases:\n        # Convert thickness from nanometers to meters for calculations.\n        t_design_m = t_design_nm * 1e-9\n\n        # Calculate nominal current in Amperes.\n        I_nom_A = kappa * t_design_m\n\n        if sigma_t == 0.0:\n            # Handle the deterministic case with zero variability.\n            mean_I_A = I_nom_A\n            std_I_A = 0.0\n            yield_val = 1.0\n        else:\n            # General case with non-zero variability.\n            \n            # Calculate mean of the log-normal current distribution in Amperes.\n            mean_I_A = I_nom_A * np.exp(sigma_t**2 / 2.0)\n            \n            # Calculate standard deviation of the log-normal current distribution in Amperes.\n            variance_term = (np.exp(sigma_t**2) - 1.0) * np.exp(sigma_t**2)\n            std_I_A = I_nom_A * np.sqrt(variance_term)\n\n            # Calculate the yield probability.\n            z_high = np.log(1.0 + delta) / sigma_t\n            z_low = np.log(1.0 - delta) / sigma_t\n            yield_val = std_norm_cdf(z_high) - std_norm_cdf(z_low)\n\n        # Convert current statistics from Amperes to milliamperes (mA).\n        mean_I_mA = mean_I_A * 1000.0\n        std_I_mA = std_I_A * 1000.0\n\n        # Append the rounded results to the list.\n        results.extend([\n            round(mean_I_mA, 6),\n            round(std_I_mA, 6),\n            round(yield_val, 6)\n        ])\n\n    # Format the final output as a single-line comma-separated list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了静态的制造差异，神经形态器件的长期可靠性和计算精度也至关重要，因为突触在其生命周期内可能需要经历数十亿次的更新。本练习模拟了自旋电子突触在长期运行中由于随机开关和材料弛豫而产生的误差累积，并考虑了器件的耐久性极限。通过分析这些动态过程，您将学习如何设计校准策略来有效控制误差，确保神经形态计算系统的长期稳定性和准确性。",
            "id": "4060749",
            "problem": "考虑一个由单个磁隧道结 (MTJ) 器件实现的自旋电子突触，在重复激励下以概率性增量更新机制运行。每次更新施加一个写入脉冲，试图将突触权重改变一个固定的增量。由于热激活和器件间的差异，每个脉冲会产生随机的结果。此外，材料弛豫会在脉冲之间产生权重的缓慢漂移。\n\n按如下方式对每次更新的误差进行建模。设理想控制策略期望的每脉冲平均增量等于标称开关概率乘以步长。用伯努利随机变量 $B_i \\in \\{0,1\\}$ 表示，其成功概率为 $p$，标称步长为 $\\Delta w$。每个脉冲的预期平均增量为 $p \\Delta w$，而实现的增量为 $B_i \\Delta w$。设每次更新的漂移建模为一个恒定偏置 $d$ 加上方差为 $\\sigma_d^2$ 的零均值高斯噪声 $\\xi_i$。因此，每次更新的误差 $e_i$（相对于预期平均值）是随机偏差与漂移之和：\n$$\ne_i = (B_i - p)\\Delta w + d + \\xi_i,\n$$\n其中 $B_i$ 在各次更新之间是独立的，且与 $\\xi_i$ 相互独立，并且 $\\xi_i \\sim \\mathcal{N}(0,\\sigma_d^2)$。\n\n耐久性采用 Weibull 可靠性定律对脉冲间的耗损失效进行建模。设更新次数为 $N$，Weibull 尺度参数（以更新次数为单位）为 $\\eta$，Weibull 形状参数为 $\\beta$。生存概率（到 $N$ 次更新时未发生故障）由一个可靠性函数建模，该函数随累积应力而衰减并捕捉耗损。\n\n基于上述建模假设和以下经过充分检验的事实：\n- 参数为 $p$ 的伯努利随机变量 $B$ 的期望和方差分别为 $\\mathbb{E}[B]=p$ 和 $\\mathrm{Var}(B)=p(1-p)$。\n- 独立随机变量之和的期望是各期望之和，方差是各方差之和。\n- 中心极限定理指出，独立且具有有限方差的随机变量之和趋近于正态分布，这使得形式为 $|\\mu| + k \\sigma$ 的 $k$-sigma 界定规则得以应用。\n\n你的任务是：\n1. 推导在无校准情况下，经过 $N$ 次更新后累积误差的均值、方差和均方根 (RMS)，以权重单位（无量纲）表示。\n2. 在所述的 Weibull 可靠性模型下，推导经过 $N$ 次更新后的生存概率。\n3. 提出了一个整数校准间隔 $N_{\\mathrm{cal}}$（以更新次数为单位），如果突触每 $N_{\\mathrm{cal}}$ 次更新进行周期性校准以将误差重置为零，那么两次校准之间累积的绝对误差将通过一个 $k$-sigma 规则被一个指定的最大允许误差 $\\varepsilon_{\\max}$（以权重单位表示）所限制。使用三角不等式和一个关于绝对误差的 $k$-sigma 界限来设计 $N_{\\mathrm{cal}}$，使其在一个间隔内的最坏情况下满足该界限。如果有多个 $N_{\\mathrm{cal}}$ 满足该界限，选择能保证满足界限的最大整数。如果该界限永远不会被违反，则设置 $N_{\\mathrm{cal}}=N$。\n\n实现一个程序，为每个测试用例计算：\n- 经过 $N$ 次更新后的生存概率，以浮点数形式表示。\n- 在无校准情况下，经过 $N$ 次更新后的累积 RMS 误差，以浮点数形式表示（以权重单位，无量纲）。\n- 建议的校准间隔 $N_{\\mathrm{cal}}$，以整数更新次数表示。\n\n使用以下测试套件（每个元组列出了 $(N, p, \\Delta w, d, \\sigma_d, \\eta, \\beta, \\varepsilon_{\\max}, k)$）：\n- 用例 A（理想路径）：$(N=10^9,\\, p=0.95,\\, \\Delta w=10^{-4},\\, d=10^{-9},\\, \\sigma_d=5\\times 10^{-7},\\, \\eta=5\\times 10^{10},\\, \\beta=2.5,\\, \\varepsilon_{\\max}=5\\times 10^{-1},\\, k=3)$。\n- 用例 B（接近耐久性边界，更高漂移）：$(N=10^9,\\, p=0.90,\\, \\Delta w=10^{-4},\\, d=5\\times 10^{-9},\\, \\sigma_d=10^{-6},\\, \\eta=2\\times 10^{9},\\, \\beta=1.5,\\, \\varepsilon_{\\max}=3\\times 10^{-1},\\, k=3)$。\n- 用例 C（高随机性，最小漂移）：$(N=10^9,\\, p=0.50,\\, \\Delta w=5\\times 10^{-5},\\, d=0,\\, \\sigma_d=2\\times 10^{-6},\\, \\eta=10^{12},\\, \\beta=3,\\, \\varepsilon_{\\max}=2\\times 10^{-1},\\, k=3)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个 $[\\text{生存概率}, \\text{最终RMS误差}, \\text{建议校准间隔}]$ 形式的列表。例如，输出应类似于 $[[\\dots],[\\dots],[\\dots]]$。所有误差量均以权重单位（无量纲）表示。除了无量纲的权重单位外，没有出现其他物理单位，因此不需要单位转换。",
            "solution": "该问题被评估为有效，因为它在科学上基于已建立的器件物理与可靠性模型，在数学上是适定的，并以客观和精确的语言呈现。为获得唯一解所需的所有参数和模型都已提供。因此，我们可以继续进行推导和求解。\n\n该问题要求针对一个自旋电子突触模型推导和计算三个量：经过 $N$ 次更新后的生存概率、在无校准情况下经过 $N$ 次更新后的均方根 (RMS) 累积误差，以及一个用于限制误差的合适的校准间隔 $N_{\\mathrm{cal}}$。\n\n### 1. $N$ 次更新后的累积误差统计\n\n相对于预期平均增量的每次更新误差 $e_i$ 由下式给出：\n$$\ne_i = (B_i - p)\\Delta w + d + \\xi_i\n$$\n其中 $B_i$ 是参数为 $p$ 的伯努利随机变量，$\\Delta w$ 是步长，$d$ 是恒定漂移偏置，$\\xi_i \\sim \\mathcal{N}(0, \\sigma_d^2)$ 是高斯噪声。变量 $B_i$ 和 $\\xi_i$ 对所有 $i$ 都是独立的，并且所有 $e_i$ 都是独立同分布 (i.i.d.) 的。\n\n首先，我们确定单次更新误差 $e_i$ 的均值和方差。\n\n**每次更新误差的均值, $\\mu_e$**：\n利用期望算子 $\\mathbb{E}[\\cdot]$ 的线性性质：\n$$\n\\mu_e = \\mathbb{E}[e_i] = \\mathbb{E}[(B_i - p)\\Delta w + d + \\xi_i] = \\mathbb{E}[(B_i - p)\\Delta w] + \\mathbb{E}[d] + \\mathbb{E}[\\xi_i]\n$$\n已知 $\\mathbb{E}[B_i] = p$ 且 $\\mathbb{E}[\\xi_i] = 0$：\n$$\n\\mu_e = (\\mathbb{E}[B_i] - p)\\Delta w + d + 0 = (p - p)\\Delta w + d = d\n$$\n每次更新的平均误差就是漂移偏置 $d$。\n\n**每次更新误差的方差, $\\sigma_e^2$**：\n对于独立随机变量之和，方差是它们方差的和。常数 $d$ 对方差没有贡献。\n$$\n\\sigma_e^2 = \\mathrm{Var}(e_i) = \\mathrm{Var}((B_i - p)\\Delta w + \\xi_i) = \\mathrm{Var}((B_i - p)\\Delta w) + \\mathrm{Var}(\\xi_i)\n$$\n使用方差属性 $\\mathrm{Var}(aX) = a^2\\mathrm{Var}(X)$ 以及 $\\mathrm{Var}(B_i - p) = \\mathrm{Var}(B_i) = p(1-p)$ 这一事实：\n$$\n\\sigma_e^2 = (\\Delta w)^2 \\mathrm{Var}(B_i) + \\sigma_d^2 = (\\Delta w)^2 p(1-p) + \\sigma_d^2\n$$\n\n现在，我们考虑 $N$ 次更新后的累积误差 $E_N = \\sum_{i=1}^N e_i$。\n\n**累积误差的均值, $\\mu_{E_N}$**：\n由于 $e_i$ 是独立同分布的，和的均值等于均值的和：\n$$\n\\mu_{E_N} = \\mathbb{E}[E_N] = \\sum_{i=1}^N \\mathbb{E}[e_i] = N \\mu_e = Nd\n$$\n\n**累积误差的方差, $\\sigma_{E_N}^2$**：\n类似地，对于独立变量，和的方差等于方差的和：\n$$\n\\sigma_{E_N}^2 = \\mathrm{Var}(E_N) = \\sum_{i=1}^N \\mathrm{Var}(e_i) = N \\sigma_e^2 = N ((\\Delta w)^2 p(1-p) + \\sigma_d^2)\n$$\n\n**累积误差的均方根 (RMS)**：\n随机变量 $X$ 的 RMS 定义为 $\\sqrt{\\mathbb{E}[X^2]}$。我们使用关系式 $\\mathbb{E}[X^2] = \\mathrm{Var}(X) + (\\mathbb{E}[X])^2$。\n对于累积误差 $E_N$：\n$$\n\\mathrm{RMS}(E_N) = \\sqrt{\\mathbb{E}[E_N^2]} = \\sqrt{\\sigma_{E_N}^2 + \\mu_{E_N}^2}\n$$\n代入推导出的均值和方差表达式：\n$$\n\\mathrm{RMS}(E_N) = \\sqrt{N ((\\Delta w)^2 p(1-p) + \\sigma_d^2) + (Nd)^2}\n$$\n\n### 2. $N$ 次更新后的生存概率\n\n问题指出耐久性遵循 Weibull 可靠性定律。给出在时间 $t$ 的生存概率的 Weibull 可靠性函数 $R(t)$ 是：\n$$\nR(t) = \\exp\\left( - \\left(\\frac{t}{\\eta}\\right)^\\beta \\right)\n$$\n在此背景下，“时间”是更新的次数。因此，代入 $t=N$，经过 $N$ 次更新后的生存概率是：\n$$\nR(N) = \\exp\\left( - \\left(\\frac{N}{\\eta}\\right)^\\beta \\right)\n$$\n其中 $\\eta$ 是尺度参数，$\\beta$ 是形状参数。\n\n### 3. 校准间隔 $N_{\\mathrm{cal}}$\n\n我们必须找到最大的整数校准间隔 $N_{\\mathrm{cal}}$，使得在该间隔内的绝对累积误差 $|E_{N_{\\mathrm{cal}}}|$ 受限于一个最大允许误差 $\\varepsilon_{\\max}$。问题指定使用基于三角不等式的 $k$-sigma 界定规则：\n$$\n|E_{N_{\\mathrm{cal}}}| \\le |\\mu_{E_{N_{\\mathrm{cal}}}}| + k \\sigma_{E_{N_{\\mathrm{cal}}}}\n$$\n我们要求这个界限小于或等于 $\\varepsilon_{\\max}$：\n$$\n|\\mu_{E_{N_{\\mathrm{cal}}}}| + k \\sigma_{E_{N_{\\mathrm{cal}}}} \\le \\varepsilon_{\\max}\n$$\n设 $n = N_{\\mathrm{cal}}$。在长度为 $n$ 的间隔内累积的误差的均值和标准差分别为 $\\mu_{E_n} = nd$ 和 $\\sigma_{E_n} = \\sqrt{n}\\sigma_e$。将这些代入不等式：\n$$\n|nd| + k \\sqrt{n}\\sigma_e \\le \\varepsilon_{\\max}\n$$\n其中 $\\sigma_e = \\sqrt{(\\Delta w)^2 p(1-p) + \\sigma_d^2}$。由于 $n$ 必须为正，因此可得：\n$$\nn|d| + k\\sigma_e\\sqrt{n} - \\varepsilon_{\\max} \\le 0\n$$\n为了找到满足此式的最大 $n$，我们可以先解出 $x = \\sqrt{n}$。设 $A = |d|$ 和 $B = k\\sigma_e$。该不等式是关于 $x$ 的一个二次不等式：\n$$\nA x^2 + B x - \\varepsilon_{\\max} \\le 0\n$$\n**情况 1: $d \\ne 0$ (因此 $A  0$)**\n$Ax^2 + Bx - \\varepsilon_{\\max} = 0$ 的根由二次求根公式给出：\n$$\nx = \\frac{-B \\pm \\sqrt{B^2 + 4A\\varepsilon_{\\max}}}{2A}\n$$\n由于 $x = \\sqrt{n}$ 必须是非负的，我们取正根：\n$$\nx_{\\text{root}} = \\frac{-B + \\sqrt{B^2 + 4A\\varepsilon_{\\max}}}{2A}\n$$\n该二次函数是一个开口向上的抛物线，因此不等式在 $0 \\le x \\le x_{\\text{root}}$ 时成立。这意味着 $0 \\le \\sqrt{n} \\le x_{\\text{root}}$。因此，$n$ 的最大值为 $n_{\\max} = x_{\\text{root}}^2$。\n$$\nn_{\\max} = \\left( \\frac{-k\\sigma_e + \\sqrt{(k\\sigma_e)^2 + 4|d|\\varepsilon_{\\max}}}{2|d|} \\right)^2\n$$\n**情况 2: $d = 0$ (因此 $A = 0$)**\n不等式简化为：\n$$\nB\\sqrt{n} - \\varepsilon_{\\max} \\le 0 \\implies k\\sigma_e\\sqrt{n} \\le \\varepsilon_{\\max}\n$$\n解出 $n$ 可得：\n$$\nn \\le \\left(\\frac{\\varepsilon_{\\max}}{k\\sigma_e}\\right)^2\n$$\n所以，$n_{\\max} = \\left(\\frac{\\varepsilon_{\\max}}{k\\sigma_e}\\right)^2$。\n\n问题陈述中提到：“如果该界限永远不会被违反，则设置 $N_{\\mathrm{cal}}=N$。”这意味着我们必须检查在没有任何校准的情况下，整个工作寿命 $N$ 内误差界限是否得到满足。如果 $|N d| + k \\sqrt{N}\\sigma_e \\le \\varepsilon_{\\max}$，那么在器件寿命内校准并非绝对必要，最大有效间隔就是 $N$ 本身。否则，最大间隔是不超过 $n_{\\max}$ 的最大整数。\n因此，建议的校准间隔 $N_{\\mathrm{cal}}$ 计算如下：\n1. 首先，使用情况1或情况2的相应公式计算最大可能间隔 $n_{\\max}$。\n2. 如果 $N \\le n_{\\max}$（这意味着在整个持续时间 $N$ 内都满足误差条件），则 $N_{\\mathrm{cal}} = N$。\n3. 否则，保证满足界限的最大整数间隔是 $N_{\\mathrm{cal}} = \\lfloor n_{\\max} \\rfloor$。\n这个逻辑可以简洁地表示为 $N_{\\mathrm{cal}} = \\min(N, \\lfloor n_{\\max} \\rfloor)$，我们必须将其实现为整数。\n\n这些推导出的公式将被实现，用于计算每个测试用例所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spintronic synapse problem for the given test cases.\n    \"\"\"\n    # Each tuple lists (N, p, delta_w, d, sigma_d, eta, beta, epsilon_max, k)\n    test_cases = [\n        # Case A (happy path)\n        (10**9, 0.95, 1e-4, 1e-9, 5e-7, 5e10, 2.5, 5e-1, 3),\n        # Case B (near endurance boundary, higher drift)\n        (10**9, 0.90, 1e-4, 5e-9, 1e-6, 2e9, 1.5, 3e-1, 3),\n        # Case C (high stochasticity, minimal drift)\n        (10**9, 0.50, 5e-5, 0, 2e-6, 1e12, 3, 2e-1, 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, p, delta_w, d, sigma_d, eta, beta, epsilon_max, k = case\n\n        # 1. Survival Probability after N updates\n        if N == 0 or eta == 0:\n            survival_prob = 1.0 if N == 0 else 0.0\n        else:\n            survival_prob = np.exp(-((N / eta)**beta))\n\n        # 2. Cumulative RMS Error after N updates without calibration\n        var_e = (delta_w**2) * p * (1 - p) + sigma_d**2\n        mu_EN = N * d\n        var_EN = N * var_e\n        final_rms_error = np.sqrt(var_EN + mu_EN**2)\n\n        # 3. Proposed Calibration Interval N_cal\n        sigma_e = np.sqrt(var_e)\n        \n        # Check if calibration is needed at all within the device lifetime N.\n        bound_at_N = N * np.abs(d) + k * np.sqrt(N) * sigma_e\n        \n        if bound_at_N = epsilon_max:\n            n_cal = int(N)\n        else:\n            # If d is non-zero, solve the quadratic equation for sqrt(n)\n            if d != 0:\n                abs_d = np.abs(d)\n                A = abs_d\n                B = k * sigma_e\n                C = epsilon_max\n                \n                discriminant = B**2 + 4 * A * C\n                sqrt_n_max = (-B + np.sqrt(discriminant)) / (2 * A)\n                n_cal_max_bound = sqrt_n_max**2\n            # If d is zero, the inequality simplifies\n            else:\n                if k * sigma_e > 0:\n                    n_cal_max_bound = (epsilon_max / (k * sigma_e))**2\n                else:\n                    n_cal_max_bound = float('inf')\n\n            # The calibration interval is the largest integer that satisfies the bound.\n            if n_cal_max_bound  1:\n                n_cal = 0\n            else:\n                n_cal = int(np.floor(n_cal_max_bound))\n\n\n        results.append([survival_prob, final_rms_error, n_cal])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}