{
    "hands_on_practices": [
        {
            "introduction": "在设计和理解自旋电子神经形态器件时，核心在于掌握如何利用电荷来控制自旋。本练习从基本定义出发，推导了自旋极化电荷电流如何产生自旋角动量流，即所谓的“自旋流”。通过这个从第一性原理出发的计算，您将加深对自旋转移力矩等关键现象物理基础的理解。",
            "id": "4060763",
            "problem": "一根铁磁纳米线被用作神经形态交叉阵列中的可编程突触。当自旋极化电荷电流密度 $J$ 沿纳米线流动时，自旋角动量输运到下游功能区，从而调制局部磁序并实现突触权重更新。假设以下物理上标准的定义：\n- 电荷电流密度 $J$ 通过 $J = q \\Phi$ 与载流子数通量密度相关，其中 $q$ 是元电荷大小，$\\Phi$ 是总电子数通量密度（单位面积单位时间内的数量）。\n- 沿磁化轴的自旋极化率 $P$ 定义为 $P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi_{\\uparrow} + \\Phi_{\\downarrow}}$，其中 $\\Phi_{\\uparrow}$ 和 $\\Phi_{\\downarrow}$ 分别是与磁化方向平行和反平行的自旋分辨数通量密度。\n- 每个电子沿量子化轴携带的自旋角动量投影大小为 $\\hbar/2$，其中 $\\hbar$ 是约化普朗克常数。\n\n仅从这些定义和基本常数出发，推导出自旋角动量通量密度大小（沿磁化轴单位面积单位时间内输运的净自旋角动量）的表达式，用 $P$、$J$、$\\hbar$ 和 $e$（元电荷）表示。然后，对于输运自旋极化率 $P = 0.72$ 和电荷电流密度 $J = 2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$，对其进行数值计算。\n\n使用国际单位制（SI）定义的精确值 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$ 和 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$，并取 $\\hbar = \\frac{h}{2\\pi}$。将最终数值结果四舍五入到四位有效数字。以 $\\mathrm{J}\\,\\mathrm{m}^{-2}$ 为单位表示最终的自旋角动量通量密度大小。",
            "solution": "该问题已经过验证，被认为是具有科学依据、良定且客观的。它不包含任何不一致或模糊之处。因此，我们可以开始求解。\n\n问题要求推导自旋角动量通量密度大小的表达式，我们将其表示为 $J_S$。这个量代表单位面积单位时间内输运的净自旋角动量。该输运由自旋极化电子介导。\n\n令 $\\Phi_{\\uparrow}$ 为自旋与磁化轴平行（自旋向上）的电子的数通量密度，$\\Phi_{\\downarrow}$ 为自旋与磁化轴反平行（自旋向下）的电子的数通量密度。每个自旋向上的电子携带 $+\\frac{\\hbar}{2}$ 的自旋角动量，每个自旋向下的电子携带 $-\\frac{\\hbar}{2}$ 的自旋角动量，其中 $\\hbar$ 是约化普朗克常数。\n\n来自自旋向上电子的自旋角动量通量密度是它们的数通量密度与每个电子的角动量的乘积：$J_{S,\\uparrow} = \\Phi_{\\uparrow} \\left(\\frac{\\hbar}{2}\\right)$。\n类似地，来自自旋向下电子的通量密度为 $J_{S,\\downarrow} = \\Phi_{\\downarrow} \\left(-\\frac{\\hbar}{2}\\right)$。\n\n净自旋角动量通量密度 $J_S$ 是这两个贡献之和：\n$$J_S = J_{S,\\uparrow} + J_{S,\\downarrow} = \\Phi_{\\uparrow} \\left(\\frac{\\hbar}{2}\\right) - \\Phi_{\\downarrow} \\left(\\frac{\\hbar}{2}\\right)$$\n$$J_S = \\frac{\\hbar}{2} (\\Phi_{\\uparrow} - \\Phi_{\\downarrow})$$\n\n我们现在必须用给定的量 $P$、$J$ 和 $e$ 来表示 $(\\Phi_{\\uparrow} - \\Phi_{\\downarrow})$。问题提供了自旋极化率 $P$ 的定义：\n$$P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi_{\\uparrow} + \\Phi_{\\downarrow}}$$\n分母 $\\Phi_{\\uparrow} + \\Phi_{\\downarrow}$ 是总电子数通量密度，我们用 $\\Phi$ 表示。所以，$\\Phi = \\Phi_{\\uparrow} + \\Phi_{\\downarrow}$。\n将 $\\Phi$ 代入 $P$ 的表达式中，我们得到：\n$$P = \\frac{\\Phi_{\\uparrow} - \\Phi_{\\downarrow}}{\\Phi}$$\n由此，我们可以将自旋分辨通量之差表示为：\n$$\\Phi_{\\uparrow} - \\Phi_{\\downarrow} = P \\Phi$$\n\n将此结果代入我们关于 $J_S$ 的方程中：\n$$J_S = \\frac{\\hbar}{2} (P \\Phi) = \\frac{P \\hbar \\Phi}{2}$$\n\n最后一步是将总电子数通量密度 $\\Phi$ 与电荷电流密度 $J$ 联系起来。问题指出 $J = q \\Phi$，其中 $q$ 是元电荷大小。问题还为元电荷提供了符号 $e$。因此，我们有 $q = e$。\n$$J = e \\Phi$$\n解出 $\\Phi$ 可得：\n$$\\Phi = \\frac{J}{e}$$\n\n现在我们将这个 $\\Phi$ 的表达式代入我们关于 $J_S$ 的方程中：\n$$J_S = \\frac{P \\hbar}{2} \\left(\\frac{J}{e}\\right)$$\n$$J_S = \\frac{P \\hbar J}{2e}$$\n这就是自旋角动量通量密度大小的最终推导表达式。\n\n接下来，我们必须对这个表达式进行数值计算。给定的值为：\n- 自旋极化率 $P = 0.72$\n- 电荷电流密度 $J = 2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n- 元电荷 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$\n- 约化普朗克常数定义为 $\\hbar = \\frac{h}{2\\pi}$。\n\n让我们将这些值代入推导出的公式中：\n$$J_S = \\frac{(0.72) \\left(\\frac{6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}}{2\\pi}\\right) (2.50 \\times 10^{10}\\ \\mathrm{A}\\,\\mathrm{m}^{-2})}{2 (1.602176634 \\times 10^{-19}\\ \\mathrm{C})}$$\n单位可以验证是正确的。由于 $1\\ \\mathrm{A} = 1\\ \\mathrm{C}/\\mathrm{s}$，单位变为：\n$$\\frac{(\\mathrm{J}\\,\\mathrm{s}) (\\mathrm{C}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2})}{(\\mathrm{C})} = \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n这与最终答案所需的单位相符。\n\n现在我们进行计算：\n首先，我们计算约化普朗克常数 $\\hbar$：\n$$\\hbar = \\frac{6.62607015 \\times 10^{-34}}{2\\pi} \\approx 1.054571817 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$$\n然后，我们计算 $J_S$：\n$$J_S = \\frac{(0.72) \\times (1.054571817 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}) \\times (2.50 \\times 10^{10}\\ \\mathrm{s}^{-1}\\,\\mathrm{m}^{-2} \\cdot e)}{2e}$$\n此处的电荷单位 $e$ 只是一个符号，我们代入数值进行计算：\n$$J_S = \\frac{(0.72) \\times (1.054571817 \\times 10^{-34}) \\times (2.50 \\times 10^{10})}{2 \\times (1.602176634 \\times 10^{-19})}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n$$J_S = \\frac{1.89822927 \\times 10^{-24}}{3.204353268 \\times 10^{-19}}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n$$J_S \\approx 5.923983 \\times 10^{-6}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$\n问题要求最终数值结果四舍五入到四位有效数字。\n$$J_S \\approx 5.924 \\times 10^{-6}\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$$",
            "answer": "$$\\boxed{5.924 \\times 10^{-6}}$$"
        },
        {
            "introduction": "磁隧道结 (MTJ) 是许多自旋电子存储器和神经形态器件的核心构建模块，其性能由穿过绝缘势垒的量子隧穿效应决定。本练习将指导您使用非平衡格林函数 (NEGF) 这一强大的理论工具，从头开始建立一个MTJ的输运模型，并编写程序计算其电流-电压特性。掌握这项技能使您能够从微观参数出发预测器件的关键性能，如隧穿磁阻效应，从而连接起材料、物理与器件工程。",
            "id": "4060757",
            "problem": "您的任务是推导并实现一个非平衡格林函数 (NEGF) 模型，用于计算自旋电子学神经形态器件的核心构建模块——自旋电子学磁性隧道结中，通过氧化镁 (MgO) 势垒的隧穿电流。该势垒使用一个简单的一维单轨道紧束缚哈密顿量进行建模，该模型包含最近邻跃迁和偏压下的线性静电势降。您必须从第一性原理出发推导电流，实现得到的模型，并计算指定势垒参数下的电流-电压特性。\n\n推导要求：从 Landauer 形式和 NEGF 定义出发，推导出隧穿电流表达式。使用以下基于第一性原理的基础：\n- 相干输运的 Landauer-Büttiker 电流公式：$$I(V) = \\frac{q}{h} \\int T(E,V)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,dE,$$ 其中 $q$ 是元电荷，$h$ 是普朗克常数，$T(E,V)$ 是透射概率，$f(E,\\mu) = \\frac{1}{1+\\exp((E-\\mu)/(k_B T))}$ 是费米-狄拉克分布，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\mu_L$ 和 $\\mu_R$ 分别是左、右电极的电化学势。\n- 在宽带极限 (WBL) 下，有限尺寸器件区域的推迟格林函数定义：$$G^r(E) = \\big[E + i\\eta - H(V) - \\Sigma_L - \\Sigma_R\\big]^{-1},$$ 其中 $\\eta$ 是一个正无穷小量，$H(V)$ 是偏压下的紧束缚哈密顿量，$\\Sigma_{L,R}$ 是考虑与电极耦合的自能矩阵。\n- 以 NEGF 量表示的透射率：$$T(E,V) = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right],$$ 其中 $G^a = (G^r)^\\dagger$ 且 $\\Gamma_{L,R} = i\\left(\\Sigma_{L,R} - \\Sigma_{L,R}^\\dagger\\right)$。\n- 假设存在两个独立的自旋通道（自旋向上和自旋向下），接触展宽具有自旋相关性，从而实现自旋分辨输运。总透射率是各自信旋通道透射率之和。\n\n器件模型细节：\n- 器件区域是一个代表 MgO 势垒的 $N$ 个格点的一维紧束缚链。哈密顿量具有在位能和最近邻跃迁：\n  $$H_{i,i}(V) = E_0 + \\phi_i(V), \\quad H_{i,i+1} = H_{i+1,i} = -t,$$\n  其中 $i = 1,\\dots,N-1$。在偏压 $V$ 下，跨势垒的静电势降被建模为线性：\n  $$\\phi_i(V) = -V\\left(\\frac{i-1}{N-1} - \\frac{1}{2}\\right) \\quad \\text{对于 } N \\ge 2, \\quad \\phi_1(V) = 0 \\text{ 如果 } N=1.$$\n  这里 $V$ 的单位是伏特，对于以电子伏特为单位的电子能量，器件中的静电能量位移根据恒等式 $1\\,\\mathrm{V} = 1\\,\\mathrm{eV}/q$ 等于以电子伏特为单位的施加电压。\n- 电极通过仅作用于器件端点的 WBL 自能并入：\n  $$\\Sigma_L = -\\frac{i}{2}\\Gamma_L | 1\\rangle\\langle 1|, \\quad \\Sigma_R = -\\frac{i}{2}\\Gamma_R | N\\rangle\\langle N|.$$\n- 自旋相关性通过自旋极化的电极展宽引入，极化参数为 $P \\in [0,1]$，基线耦合为 $\\Gamma_0$：\n  - 平行排列 (P)：$$\\Gamma_{L,\\uparrow} = \\Gamma_0(1+P),\\ \\Gamma_{L,\\downarrow} = \\Gamma_0(1-P),\\ \\Gamma_{R,\\uparrow} = \\Gamma_0(1+P),\\ \\Gamma_{R,\\downarrow} = \\Gamma_0(1-P).$$\n  - 反平行排列 (AP)：$$\\Gamma_{L,\\uparrow} = \\Gamma_0(1+P),\\ \\Gamma_{L,\\downarrow} = \\Gamma_0(1-P),\\ \\Gamma_{R,\\uparrow} = \\Gamma_0(1-P),\\ \\Gamma_{R,\\downarrow} = \\Gamma_0(1+P).$$\n- 费米能为 $E_F = 0\\,\\mathrm{eV}$；偏压下电极的电化学势为 $$\\mu_L = E_F + \\frac{V}{2}, \\quad \\mu_R = E_F - \\frac{V}{2}.$$\n- 在端点处的 WBL 下，自旋分辨的透射率简化为 $$T_\\sigma(E,V) = \\Gamma_{L,\\sigma}\\,\\Gamma_{R,\\sigma}\\,\\left|G^r_{1N, \\sigma}(E,V)\\right|^2,$$ 总透射率为 $$T(E,V) = T_\\uparrow(E,V)+T_\\downarrow(E,V).$$\n\n数值实现细节：\n- 能量积分是对以电子伏特为单位的电子能量进行的。电流应计算为 $$I(V) = \\frac{q^2}{h} \\int T(E,V)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,dE_{\\mathrm{eV}},$$ 为保证数值稳定性，使用单位为 $\\mathrm{eV}/\\mathrm{K}$ 的 $k_B$。这里 $dE_{\\mathrm{eV}}$ 是对以电子伏特为单位的能量进行积分，前置因子 $q^2/h$ 用于恢复国际单位制（安培）。\n- 使用足够宽且密集的能量网格，例如 $E \\in [-5,5]\\,\\mathrm{eV}$ 并采用均匀离散化。在矩阵求逆中使用一个小的正数 $\\eta$ 以确保数值稳定性。\n- 使用以开尔文为单位的温度 $T$。\n\n任务：\n1. 给定上述模型，推导 $I(V)$ 的 NEGF 表达式，展示自旋分辨展宽如何进入透射率，以及在偏压下如何构建紧束缚哈密顿量。\n2. 实现一个程序，对于下面的每个测试用例，计算偏压 $V \\in \\{0.0, 0.1, 0.5\\}\\,\\mathrm{V}$ 时的电流，以安培为单位表示，并按要求格式输出。\n\n物理单位和输出规范：\n- 所有计算出的电流均以安培 (A) 表示。\n- 最终程序输出必须是单行文本，包含一个用方括号括起来的逗号分隔列表，顺序由测试套件和电压定义。对于每个测试用例，先列出 $V=0.0\\,\\mathrm{V}$ 时的电流，然后是 $V=0.1\\,\\mathrm{V}$，再然后是 $V=0.5\\,\\mathrm{V}$，接着再处理下一个测试用例。\n- 角度不属于此任务的一部分。\n- 百分比以小数形式表示，不带百分号。\n\n测试套件：\n计算以下四个测试用例的电流。每个测试用例指定 $(N, a, E_0, t, \\Gamma_0, P, \\text{alignment}, T)$:\n- 用例 1：$N = 5$, $a = 0.21\\,\\mathrm{nm}$, $E_0 = 3.5\\,\\mathrm{eV}$, $t = 0.8\\,\\mathrm{eV}$, $\\Gamma_0 = 0.5\\,\\mathrm{eV}$, $P = 0.6$, alignment = parallel, $T = 300\\,\\mathrm{K}$。\n- 用例 2：$N = 1$, $a = 0.21\\,\\mathrm{nm}$, $E_0 = 1.5\\,\\mathrm{eV}$, $t = 1.0\\,\\mathrm{eV}$, $\\Gamma_0 = 0.5\\,\\mathrm{eV}$, $P = 0.6$, alignment = parallel, $T = 300\\,\\mathrm{K}$。\n- 用例 3：$N = 10$, $a = 0.21\\,\\mathrm{nm}$, $E_0 = 3.5\\,\\mathrm{eV}$, $t = 0.8\\,\\mathrm{eV}$, $\\Gamma_0 = 0.5\\,\\mathrm{eV}$, $P = 0.6$, alignment = antiparallel, $T = 300\\,\\mathrm{K}$。\n- 用例 4：$N = 5$, $a = 0.21\\,\\mathrm{nm}$, $E_0 = 3.5\\,\\mathrm{eV}$, $t = 0.8\\,\\mathrm{eV}$, $\\Gamma_0 = 0.5\\,\\mathrm{eV}$, $P = 0.0$, alignment = parallel, $T = 300\\,\\mathrm{K}$。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$），顺序为 $\\left[ I_{1}(0.0), I_{1}(0.1), I_{1}(0.5), I_{2}(0.0), I_{2}(0.1), I_{2}(0.5), I_{3}(0.0), I_{3}(0.1), I_{3}(0.5), I_{4}(0.0), I_{4}(0.1), I_{4}(0.5) \\right]$，其中 $I_{k}(V)$ 表示用例 $k$ 在偏压 $V$ 下以安培为单位的电流。",
            "solution": "该问题要求推导并实现一个非平衡格林函数 (NEGF) 模型，以计算通过磁性隧道结 (MTJ) 的隧穿电流。解决方案首先从给定的原理推导出解析表达式，然后详细说明用于计算的数值算法。\n\n### 前言：问题陈述的验证\n问题陈述已根据所需标准进行了验证。\n1.  **已知条件提取**：所有物理量、方程、模型参数和测试用例均已逐字提取。参数 $a$，即格点间距，虽然已提供，但并未进入紧束缚模型方程中，其中跃迁参数 $t$ 才是相关量。这是此类模型中的一种常见简化，不构成矛盾。类似地，对于 $N=1$ 的情况，跃迁参数 $t$ 已给出但未使用，因为单格点系统没有跃迁。这些并不使问题无效。\n2.  **验证**：\n    *   **科学依据**：该问题在介观系统量子输运的标准理论框架中具有坚实的科学基础，特别是 Landauer-Büttiker 形式与 NEGF 的结合。紧束缚近似、宽带极限 (WBL) 和线性势降是此类问题的标准且有效的简化方法。\n    *   **适定性与一致性**：问题是自洽的，所有必要的方程和参数都已指定。不存在矛盾。可以计算出唯一的、稳定的数值解。\n    *   **客观性**：问题以精确、客观的科学语言陈述。\n因此，该问题被认定为**有效**。\n\n### 第 1 部分：隧穿电流表达式的推导\n\n目标是计算电流 $I$ 作为外加偏压 $V$ 的函数。我们从给定的 Landauer-Büttiker 公式开始，该公式用透射概率 $T(E, V)$ 和接触电极的费米-狄拉克分布来表示电流。\n\n电流由以下公式给出：\n$$I(V) = \\frac{q}{h} \\int_{-\\infty}^{\\infty} T(E,V)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,dE$$\n其中 $q$ 是元电荷，$h$ 是普朗克常数，$E$ 是电子能量，$f(E,\\mu)$ 是费米-狄拉克分布。\n左 (L) 和右 (R) 电极的电化学势在费米能 $E_F = 0\\,\\mathrm{eV}$ 周围对称地施加偏压：\n$$\\mu_L = E_F + \\frac{V}{2} = \\frac{V}{2} \\quad \\text{和} \\quad \\mu_R = E_F - \\frac{V}{2} = -\\frac{V}{2}$$\n费米-狄拉克分布为 $f(E,\\mu) = \\frac{1}{1+\\exp((E-\\mu)/(k_B T))}$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度。\n\n问题指定了自旋分辨输运，其中总透射率 $T(E,V)$ 是通过自旋向上 ($\\uparrow$) 和自旋向下 ($\\downarrow$) 通道的透射率之和：\n$$T(E,V) = T_\\uparrow(E,V) + T_\\downarrow(E,V)$$\n每个自旋通道 $\\sigma \\in \\{\\uparrow, \\downarrow\\}$ 的透射率用 NEGF 量表示。对于指定的模型，其中电极仅耦合到一维链的端点（格点 $1$ 和 $N$），这简化为：\n$$T_\\sigma(E,V) = \\Gamma_{L,\\sigma}\\,\\Gamma_{R,\\sigma}\\,\\left|G^r_{1N,\\sigma}(E,V)\\right|^2$$\n这里，$\\Gamma_{L,\\sigma}$ 和 $\\Gamma_{R,\\sigma}$ 分别是自旋 $\\sigma$ 进入左、右电极的展宽函数（逃逸率）。$G^r_{1N,\\sigma}(E,V)$ 是自旋通道 $\\sigma$ 的推迟格林函数矩阵的 $(1,N)$ 元素。\n\n自旋相关的展宽由极化率 $P$ 和基线耦合强度 $\\Gamma_0$ 定义。\n对于**平行 (P) 排列**：\n$$\\Gamma_{L,\\uparrow} = \\Gamma_{R,\\uparrow} = \\Gamma_0(1+P) \\quad \\text{和} \\quad \\Gamma_{L,\\downarrow} = \\Gamma_{R,\\downarrow} = \\Gamma_0(1-P)$$\n对于**反平行 (AP) 排列**：\n$$\\Gamma_{L,\\uparrow} = \\Gamma_0(1+P), \\quad \\Gamma_{L,\\downarrow} = \\Gamma_0(1-P)$$\n$$\\Gamma_{R,\\uparrow} = \\Gamma_0(1-P), \\quad \\Gamma_{R,\\downarrow} = \\Gamma_0(1+P)$$\n\n每个自旋通道的推迟格林函数 $G^r_{\\sigma}$ 通过矩阵求逆获得：\n$$G^r_{\\sigma}(E,V) = \\Big[ (E + i\\eta)\\mathbb{I} - H(V) - \\Sigma_{L,\\sigma} - \\Sigma_{R,\\sigma} \\Big]^{-1}$$\n其中 $\\eta$ 是一个正无穷小量，$\\mathbb{I}$ 是单位矩阵，$H(V)$ 是器件哈密顿量，$\\Sigma_{L/R,\\sigma}$ 是描述与电极耦合的自能矩阵。在此模型中，哈密顿量 $H(V)$ 被假定为与自旋无关。\n\n$N \\times N$ 的紧束缚哈密顿矩阵 $H(V)$ 是三对角的：\n-   在位能（对角元素）：$H_{ii}(V) = E_0 + \\phi_i(V)$\n-   最近邻跃迁（非对角元素）：$H_{i,i+1} = H_{i+1,i} = -t$\n\n静电势 $\\phi_i(V)$ 在 $N$ 个格点上线性变化：\n-   对于 $N \\ge 2$：$\\phi_i(V) = -V\\left(\\frac{i-1}{N-1} - \\frac{1}{2}\\right)$\n-   对于 $N=1$：$\\phi_1(V) = 0$\n\n在宽带极限 (WBL) 下，自能是纯虚数且局域的：\n$$\\Sigma_{L,\\sigma} = -\\frac{i}{2}\\Gamma_{L,\\sigma} | 1\\rangle\\langle 1| \\quad \\text{和} \\quad \\Sigma_{R,\\sigma} = -\\frac{i}{2}\\Gamma_{R,\\sigma} | N\\rangle\\langle N|$$\n这些矩阵除了 $(1,1)$ 和 $(N,N)$ 元素外，其余元素均为零。因此，自能仅修改待求逆的完整矩阵的对角元素。\n\n令 $M_\\sigma(E,V) = (E + i\\eta)\\mathbb{I} - H(V) - \\Sigma_{L,\\sigma} - \\Sigma_{R,\\sigma}$。这个 $N\\times N$ 矩阵的元素为：\n-   对角元素：\n    $$M_{\\sigma, ii} = E - E_0 - \\phi_i(V) + i\\eta, \\quad \\text{对于 } i \\in \\{2, \\dots, N-1\\}$$\n    $$M_{\\sigma, 11} = E - E_0 - \\phi_1(V) + i\\eta + \\frac{i}{2}\\Gamma_{L,\\sigma}$$\n    $$M_{\\sigma, NN} = E - E_0 - \\phi_N(V) + i\\eta + \\frac{i}{2}\\Gamma_{R,\\sigma}$$\n    注意，对于 $N=1$，这两个端点修正项合并到单个对角元素上。\n-   非对角元素：\n    $$M_{\\sigma, i,i+1} = M_{\\sigma, i+1,i} = -(-t) = t$$\n-   所有其他元素为零。\n\n计算过程是构建并求逆这个复数值三对角矩阵 $M_\\sigma(E,V)$，以找到 $G^r_\\sigma(E,V) = M_\\sigma(E,V)^{-1}$。然后，提取元素 $G^r_{1N,\\sigma}$ 来计算 $T_\\sigma(E,V)$。\n\n对于数值实现，能量单位是电子伏特 (eV)。电流公式必须考虑积分变量从焦耳变为 eV。由于 $dE\\,[\\mathrm{J}] = q \\cdot dE_{\\mathrm{eV}}\\,[\\mathrm{eV}]$，积分变为：\n$$I(V) = \\frac{q}{h} \\int T(E,V)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,(q \\cdot dE_{\\mathrm{eV}}) = \\frac{q^2}{h} \\int T(E,V)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,dE_{\\mathrm{eV}}$$\n这与为数值实现指定的公式相匹配，其中前置因子 $q^2/h$ 的单位是安培/伏特，积分的单位是 eV，最终得到以安培为单位的电流。\n\n### 第 2 部分：数值算法\n对于给定的一组参数 $(N, E_0, t, \\Gamma_0, P, \\text{alignment}, T)$ 和一个电压 $V$，计算电流的算法如下：\n\n1.  **常数和网格**：定义物理常数 $q, h, k_B$ 和数值前置因子 $G_0 = q^2/h$。在合适的范围（例如 $[-5, 5]\\,\\mathrm{eV}$）内设置一个均匀的能量网格 $E$，并设置一个无穷小量 $\\eta$（例如 $10^{-9}\\,\\mathrm{eV}$）。\n2.  **外层循环（电压）**：对于每个所需的电压 $V$，执行以下步骤。\n3.  **计算电势和费米函数**：计算 $\\mu_L = V/2$, $\\mu_R = -V/2$。对网格上的所有能量，计算费米-狄拉克分布之差 $f(E, \\mu_L) - f(E, \\mu_R)$。\n4.  **自旋循环**：初始化一个总透射率数组 $T_{total}(E)$ 为零。遍历两个自旋通道 $\\sigma \\in \\{\\uparrow, \\downarrow\\}$。\n    a. **展宽**：根据磁性排列确定 $\\Gamma_{L,\\sigma}$ 和 $\\Gamma_{R,\\sigma}$。\n    b. **能量循环**：对于网格中的每个能量 $E_j$：\n        i. **构建矩阵 $M_\\sigma$**：按照推导中的详细说明，构建 $N \\times N$ 矩阵 $M_\\sigma(E_j, V)$。该矩阵是复数三对角矩阵。\n        ii. **矩阵求逆**：计算逆矩阵 $G^r_\\sigma(E_j, V) = M_\\sigma(E_j, V)^{-1}$。\n        iii. **提取元素**：获取元素 $G^r_{1N,\\sigma} = (G^r_\\sigma)_{1,N}$。\n        iv. **计算透射率**：计算 $T_\\sigma(E_j,V) = \\Gamma_{L,\\sigma}\\Gamma_{R,\\sigma}|G^r_{1N,\\sigma}|^2$。\n    c. **累加透射率**：将计算出的透射率数组 $T_\\sigma(E)$ 加到总透射率数组 $T_{total}(E)$ 上。\n5.  **积分**：在能量网格上对总透射率和费米函数差的乘积进行数值积分。梯形法则适用于此：\n    $$ \\text{integral} = \\int T_{total}(E)\\,\\big[f(E,\\mu_L) - f(E,\\mu_R)\\big]\\,dE_{\\mathrm{eV}} \\approx \\sum_j \\frac{T_{total,j+1}\\Delta f_{j+1} + T_{total,j}\\Delta f_j}{2} \\Delta E $$\n6.  **最终电流**：将积分结果乘以预因子 $G_0$，得到以安培为单位的电流 $I(V)$。\n\n对所有测试用例和指定电压重复此过程，以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and voltages.\n    It computes the tunneling current using the NEGF formalism and prints\n    the results in the specified format.\n    \"\"\"\n\n    # Physical constants\n    Q_E = 1.602176634e-19  # Elementary charge in Coulombs\n    H_PLANCK = 6.62607015e-34  # Planck's constant in J*s\n    K_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    # Prefactor for current calculation (q^2/h) in A/eV\n    # Note: The derivation shows I = (q^2/h) * integral_eV.\n    # The prefactor (q^2/h) is in A/V. The integral is over energy in eV, which has units of V (potential).\n    # Final result I is in Amperes.\n    PREFACTOR_G = Q_E**2 / H_PLANCK\n\n    test_cases = [\n        # Case 1: (N, a, E0, t, Gamma0, P, alignment, T)\n        {'N': 5, 'a': 0.21, 'E0': 3.5, 't': 0.8, 'Gamma0': 0.5, 'P': 0.6, 'alignment': 'parallel', 'T': 300},\n        # Case 2:\n        {'N': 1, 'a': 0.21, 'E0': 1.5, 't': 1.0, 'Gamma0': 0.5, 'P': 0.6, 'alignment': 'parallel', 'T': 300},\n        # Case 3:\n        {'N': 10, 'a': 0.21, 'E0': 3.5, 't': 0.8, 'Gamma0': 0.5, 'P': 0.6, 'alignment': 'antiparallel', 'T': 300},\n        # Case 4:\n        {'N': 5, 'a': 0.21, 'E0': 3.5, 't': 0.8, 'Gamma0': 0.5, 'P': 0.0, 'alignment': 'parallel', 'T': 300},\n    ]\n\n    voltages_V = [0.0, 0.1, 0.5]\n    \n    # Numerical parameters for integration\n    E_min, E_max, n_E = -5.0, 5.0, 4001 # Energy grid in eV\n    E_grid = np.linspace(E_min, E_max, n_E)\n    eta = 1e-9j  # Infinitesimal for Green's function\n\n    results = []\n    \n    for case in test_cases:\n        for V in voltages_V:\n            current = compute_current(case, V, E_grid, eta, PREFACTOR_G, K_B)\n            results.append(f\"{current:.6e}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef fermi_dirac(E, mu, T, k_B):\n    \"\"\"Calculates the Fermi-Dirac distribution.\"\"\"\n    if T == 0:\n        return np.where(E = mu, 1.0, 0.0)\n    # Avoid overflow for large positive exponents\n    x = (E - mu) / (k_B * T)\n    return 1.0 / (1.0 + np.exp(np.clip(x, -700, 700)))\n\ndef compute_current(params, V, E_grid, eta, prefactor, k_B):\n    \"\"\"\n    Computes the current for a given set of device parameters and bias voltage.\n    \"\"\"\n    N = params['N']\n    E0 = params['E0']\n    t = params['t']\n    Gamma0 = params['Gamma0']\n    P = params['P']\n    alignment = params['alignment']\n    T = params['T']\n\n    mu_L = V / 2.0\n    mu_R = -V / 2.0\n\n    fd_L = fermi_dirac(E_grid, mu_L, T, k_B)\n    fd_R = fermi_dirac(E_grid, mu_R, T, k_B)\n    fd_diff = fd_L - fd_R\n\n    # If V=0, fL=fR, so current is 0. Avoids numerical integration of zero.\n    if V == 0.0:\n        return 0.0\n        \n    # Calculate spin-dependent broadenings\n    Gammas_sigma = {}\n    if alignment == 'parallel':\n        Gammas_sigma['up'] = (Gamma0 * (1 + P), Gamma0 * (1 + P))\n        Gammas_sigma['down'] = (Gamma0 * (1 - P), Gamma0 * (1 - P))\n    else:  # antiparallel\n        Gammas_sigma['up'] = (Gamma0 * (1 + P), Gamma0 * (1 - P))\n        Gammas_sigma['down'] = (Gamma0 * (1 - P), Gamma0 * (1 + P))\n\n    #\n    # Construct base Hamiltonian (independent of E and spin)\n    #\n    H_device = np.zeros((N, N), dtype=float)\n    \n    # On-site potential\n    if N >= 2:\n        indices = np.arange(N)\n        phi = -V * (indices / (N - 1) - 0.5)\n        np.fill_diagonal(H_device, E0 + phi)\n    else: # N = 1\n        H_device[0, 0] = E0 # phi_1(V) = 0 as per problem\n\n    # Hopping terms\n    if N > 1:\n        off_diag_val = -t\n        indices = np.arange(N - 1)\n        H_device[indices, indices + 1] = off_diag_val\n        H_device[indices + 1, indices] = off_diag_val\n\n    total_transmission = np.zeros_like(E_grid)\n\n    for spin in ['up', 'down']:\n        Gamma_L_s, Gamma_R_s = Gammas_sigma[spin]\n        \n        spin_transmission = np.zeros_like(E_grid)\n        \n        # Self-energies (imaginary parts)\n        Sigma_L_im = -0.5 * Gamma_L_s\n        Sigma_R_im = -0.5 * Gamma_R_s\n        \n        for i, E in enumerate(E_grid):\n            # M = E*I - H - Sigma_L - Sigma_R\n            M = (E + eta) * np.identity(N) - H_device\n            M[0, 0] -= 1j * Sigma_L_im\n            if N > 0: # This is for N=1 case where N-1=0\n                M[N-1, N-1] -= 1j * Sigma_R_im\n\n            # Invert M to get G^r\n            try:\n                G_r = np.linalg.inv(M)\n                G_r_1N = G_r[0, -1]\n                T_E = Gamma_L_s * Gamma_R_s * np.abs(G_r_1N)**2\n                spin_transmission[i] = T_E\n            except np.linalg.LinAlgError:\n                # If matrix is singular, transmission is zero\n                spin_transmission[i] = 0.0\n\n        total_transmission += spin_transmission\n\n    # Integrate over energy using trapezoidal rule\n    integrand = total_transmission * fd_diff\n    integral_val = np.trapz(integrand, E_grid)\n    \n    current = prefactor * integral_val\n    return current\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型通常假设器件是完美的，但在实际制造中，工艺偏差是不可避免的，这会直接影响器件的性能和可靠性。本练习旨在连接理论与现实，通过对STT-MRAM器件中自由层厚度的随机变化进行建模，来分析其对关键性能参数——翻转电流——的影响。通过这项实践，您将学会如何运用统计学方法量化工艺变化对器件性能分布的影响，并计算成品率，这是评估技术是否具备商业化潜力的关键一步。",
            "id": "4060772",
            "problem": "考虑一个使用自旋转移矩磁性随机存取存储器（STT-MRAM）实现的自旋电子突触器件。在固定的磁性材料参数和固定的柱状面积下，众所周知，零温临界翻转电流由于自旋转移矩与磁性体积成正比，而与自由层厚度呈线性关系。设翻转电流建模为 $I_{\\text{sw}}(t) = \\kappa \\, t$，其中 $t$ 是自由层的厚度（单位为米），$\\kappa$ 是一个特定于器件的比例常数（单位为安培/米）。\n\n由于制造工艺的可变性，自由层厚度 $T$ 被建模为一个对数正态随机变量，其自然对数域中的参数为 $\\mu_t$ 和 $\\sigma_t$，因此 $\\ln T \\sim \\mathcal{N}(\\mu_t, \\sigma_t^2)$ 且 $T = \\exp(X)$，其中 $X \\sim \\mathcal{N}(\\mu_t, \\sigma_t^2)$。设计意图将厚度中值设定为等于目标厚度 $t_{\\text{design}}$，这意味着 $\\mu_t = \\ln(t_{\\text{design}})$。\n\n将标称电流定义为 $I_{\\text{nom}} = \\kappa \\, t_{\\text{design}}$。如果一个器件的翻转电流位于对称容差窗口 $[I_{\\text{low}}, I_{\\text{high}}]$ 内，则该器件被认为是可接受的，其中 $I_{\\text{low}} = I_{\\text{nom}} \\, (1 - \\delta)$ 和 $I_{\\text{high}} = I_{\\text{nom}} \\, (1 + \\delta)$，而 $\\delta \\in (0,1)$ 是分数容差。良率是概率 $Y = \\mathbb{P}\\left(I_{\\text{low}} \\le I_{\\text{sw}}(T) \\le I_{\\text{high}}\\right)$，以小数形式表示（而非百分比）。\n\n从以下事实出发：（i）翻转电流与厚度呈线性关系，以及（ii）对数正态分布在正向缩放操作下是封闭的，推导 $I_{\\text{sw}}(T)$ 的分布，计算其均值和标准差，并为指定的参数集评估良率 $Y$。使用标准正态累积分布函数 $\\Phi(x)$ 来评估对数正态累积分布函数，其中 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$，而 $\\operatorname{erf}(\\cdot)$ 表示高斯误差函数。\n\n你的程序必须：\n- 对于每个测试用例，计算翻转电流分布的均值和标准差（单位为毫安，mA）以及良率（以小数表示）。均值和标准差必须作为浮点数返回，表示以mA为单位的值，良率必须作为区间 $[0,1]$ 内的浮点数返回。输出中不应包含任何单位符号。\n- 使用 $\\mu_t = \\ln(t_{\\text{design}})$（单位为米）和给定的 $\\sigma_t$。\n- 使用 $I_{\\text{sw}}(t) = \\kappa \\, t$，其中 $\\kappa$ 的单位为安培/米。\n- 计算 $I_{\\text{nom}} = \\kappa \\, t_{\\text{design}}$，$I_{\\text{low}} = I_{\\text{nom}} (1 - \\delta)$ 和 $I_{\\text{high}} = I_{\\text{nom}} (1 + \\delta)$。\n- 在解析评估中，当 $\\sigma_t = 0$ 时，将分布视为在 $I_{\\text{nom}}$ 处的退化分布，并相应地计算良率。\n\n使用以下测试套件，其中每个测试用例为 $(t_{\\text{design}} \\text{ in nm}, \\kappa \\text{ in A/m}, \\sigma_t, \\delta)$：\n1. $(1.2, 6 \\times 10^{4}, 0.1, 0.2)$ 作为一个具有中等可变性和宽窗口的一般情况。\n2. $(1.1, 6 \\times 10^{4}, 0.02, 0.05)$ 作为一个具有紧密窗口的近乎理想的制造情况。\n3. $(1.3, 6 \\times 10^{4}, 0.3, 0.1)$ 作为一个具有中等窗口的高可变性情况。\n4. $(1.2, 6 \\times 10^{4}, 0.0, 0.1)$ 作为一个零可变性的边界情况。\n\n将均值和标准差表示为毫安（mA），计算时均四舍五入到六位小数，良率表示为小数，计算时四舍五入到六位小数。\n\n你的程序应该生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例 $i$，按顺序附加三元组 $[\\text{mean}_i, \\text{std}_i, \\text{yield}_i]$，并将其扁平化为一个列表，即最终输出必须是 $[\\text{mean}_1,\\text{std}_1,\\text{yield}_1,\\text{mean}_2,\\text{std}_2,\\text{yield}_2,\\text{mean}_3,\\text{std}_3,\\text{yield}_3,\\text{mean}_4,\\text{std}_4,\\text{yield}_4]$ 的形式。",
            "solution": "该问题定义明确，具有科学依据，并提供了推导唯一解所需的所有信息。我们首先进行解析推导，然后进行数值实现。\n\n### 步骤1：翻转电流 $I_{\\text{sw}}(T)$ 的分布\n\n问题陈述翻转电流 $I_{\\text{sw}}$ 是自由层厚度 $t$ 的线性函数：\n$$\nI_{\\text{sw}}(t) = \\kappa \\, t\n$$\n其中 $\\kappa$ 是一个常数。厚度 $T$ 是一个随机变量，被建模为对数正态分布，其自然对数 $\\ln T$ 服从正态分布 $\\mathcal{N}(\\mu_t, \\sigma_t^2)$。\n\n我们已知厚度分布的中值是设计目标 $t_{\\text{design}}$。对于对数正态分布，中值为 $\\exp(\\mu_t)$。因此，我们有 $\\exp(\\mu_t) = t_{\\text{design}}$，这意味着 $\\mu_t = \\ln(t_{\\text{design}})$。\n\n为了找到翻转电流 $I_{\\text{sw}}(T)$ 的分布，我们对 $I_{\\text{sw}}(T)$ 的表达式取自然对数：\n$$\n\\ln(I_{\\text{sw}}(T)) = \\ln(\\kappa \\, T) = \\ln(\\kappa) + \\ln(T)\n$$\n由于 $\\ln(T)$ 是一个服从正态分布 $\\mathcal{N}(\\mu_t, \\sigma_t^2)$ 的随机变量，而 $\\ln(\\kappa)$ 是一个常数，它们的和 $\\ln(I_{\\text{sw}}(T))$ 也是一个服从正态分布的随机变量。我们将这个新正态分布的参数记为 $\\mu_I$ 和 $\\sigma_I^2$。\n\n$\\ln(I_{\\text{sw}}(T))$ 的均值为：\n$$\n\\mu_I = \\mathbb{E}[\\ln(I_{\\text{sw}}(T))] = \\mathbb{E}[\\ln(\\kappa) + \\ln(T)] = \\ln(\\kappa) + \\mathbb{E}[\\ln(T)] = \\ln(\\kappa) + \\mu_t\n$$\n代入 $\\mu_t = \\ln(t_{\\text{design}})$：\n$$\n\\mu_I = \\ln(\\kappa) + \\ln(t_{\\text{design}}) = \\ln(\\kappa \\, t_{\\text{design}})\n$$\n我们认识到项 $\\kappa \\, t_{\\text{design}}$ 是标称电流 $I_{\\text{nom}}$。因此，$\\mu_I = \\ln(I_{\\text{nom}})$。\n\n$\\ln(I_{\\text{sw}}(T))$ 的方差为：\n$$\n\\sigma_I^2 = \\operatorname{Var}(\\ln(I_{\\text{sw}}(T))) = \\operatorname{Var}(\\ln(\\kappa) + \\ln(T)) = \\operatorname{Var}(\\ln(T)) = \\sigma_t^2\n$$\n所以，$\\sigma_I = \\sigma_t$。\n\n这个结果表明，翻转电流 $I_{\\text{sw}}(T)$ 也是一个对数正态分布的随机变量，其对数 $\\ln(I_{\\text{sw}}(T))$ 服从正态分布 $\\mathcal{N}(\\ln(I_{\\text{nom}}), \\sigma_t^2)$。\n\n### 步骤2：$I_{\\text{sw}}(T)$ 的均值和标准差\n\n对于对数正态随机变量 $Z$，其中 $\\ln(Z) \\sim \\mathcal{N}(\\mu_z, \\sigma_z^2)$，其均值和方差由以下公式给出：\n$$\n\\mathbb{E}[Z] = \\exp\\left(\\mu_z + \\frac{\\sigma_z^2}{2}\\right)\n$$\n$$\n\\operatorname{Var}(Z) = \\left[\\exp(\\sigma_z^2) - 1\\right] \\exp(2\\mu_z + \\sigma_z^2)\n$$\n将这些公式应用于 $I_{\\text{sw}}(T)$，参数为 $\\mu_I = \\ln(I_{\\text{nom}})$ 和 $\\sigma_I = \\sigma_t$，我们得到：\n\n翻转电流的均值为：\n$$\n\\mathbb{E}[I_{\\text{sw}}(T)] = \\exp\\left(\\ln(I_{\\text{nom}}) + \\frac{\\sigma_t^2}{2}\\right) = \\exp(\\ln(I_{\\text{nom}})) \\exp\\left(\\frac{\\sigma_t^2}{2}\\right) = I_{\\text{nom}} \\exp\\left(\\frac{\\sigma_t^2}{2}\\right)\n$$\n\n翻转电流的方差为：\n$$\n\\operatorname{Var}(I_{\\text{sw}}(T)) = \\left[\\exp(\\sigma_t^2) - 1\\right] \\exp(2\\ln(I_{\\text{nom}}) + \\sigma_t^2) = \\left[\\exp(\\sigma_t^2) - 1\\right] (\\exp(\\ln(I_{\\text{nom}})))^2 \\exp(\\sigma_t^2) = I_{\\text{nom}}^2 (\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)\n$$\n标准差是方差的平方根：\n$$\n\\text{StdDev}[I_{\\text{sw}}(T)] = \\sqrt{\\operatorname{Var}(I_{\\text{sw}}(T))} = I_{\\text{nom}} \\sqrt{(\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)}\n$$\n\n### 步骤3：良率计算\n\n良率 $Y$ 是翻转电流 $I_{\\text{sw}}(T)$ 落在可接受范围 $[I_{\\text{low}}, I_{\\text{high}}]$ 内的概率：\n$$\nY = \\mathbb{P}(I_{\\text{low}} \\le I_{\\text{sw}}(T) \\le I_{\\text{high}}) = F_I(I_{\\text{high}}) - F_I(I_{\\text{low}})\n$$\n其中 $F_I(x)$ 是 $I_{\\text{sw}}(T)$ 的累积分布函数（CDF）。\n\n对数正态变量 $Z$（参数为 $\\mu_z, \\sigma_z$）的CDF由 $F_Z(x) = \\Phi\\left(\\frac{\\ln(x) - \\mu_z}{\\sigma_z}\\right)$ 给出，其中 $\\Phi$ 是标准正态分布的CDF。对于 $I_{\\text{sw}}(T)$，我们使用其参数 $\\mu_I = \\ln(I_{\\text{nom}})$ 和 $\\sigma_I = \\sigma_t$：\n$$\nY = \\Phi\\left(\\frac{\\ln(I_{\\text{high}}) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(I_{\\text{low}}) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right)\n$$\n代入 $I_{\\text{high}} = I_{\\text{nom}}(1 + \\delta)$ 和 $I_{\\text{low}} = I_{\\text{nom}}(1 - \\delta)$：\n$$\nY = \\Phi\\left(\\frac{\\ln(I_{\\text{nom}}(1 + \\delta)) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(I_{\\text{nom}}(1 - \\delta)) - \\ln(I_{\\text{nom}})}{\\sigma_t}\\right)\n$$\n使用属性 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们简化参数：\n$$\nY = \\Phi\\left(\\frac{\\ln(1 + \\delta)}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(1 - \\delta)}{\\sigma_t}\\right)\n$$\n问题提供了关系式 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$ 用于数值评估。\n\n### 步骤4：$\\sigma_t = 0$ 的特殊情况\n\n当 $\\sigma_t = 0$ 时，制造过程没有可变性。厚度分布变为退化分布，意味着厚度 $T$ 是一个等于其中值（和均值）$t_{\\text{design}}$ 的常数。\n$$\nT = t_{\\text{design}} \\quad \\text{概率为 } 1\n$$\n因此，翻转电流也是确定性的：\n$$\nI_{\\text{sw}} = \\kappa \\, t_{\\text{design}} = I_{\\text{nom}}\n$$\n$I_{\\text{sw}}$ 的分布是一个以 $I_{\\text{nom}}$ 为中心的狄拉克δ函数。均值为 $I_{\\text{nom}}$，标准差为 0。\n\n良率是这个确定性值落在容差窗口内的概率：\n$$\nY = \\mathbb{P}(I_{\\text{nom}}(1-\\delta) \\le I_{\\text{nom}} \\le I_{\\text{nom}}(1+\\delta))\n$$\n由于 $\\delta \\in (0, 1)$，所以 $1-\\delta  1$ 和 $1+\\delta > 1$ 总是成立的。由于 $I_{\\text{nom}} > 0$，不等式 $I_{\\text{nom}}(1-\\delta) \\le I_{\\text{nom}} \\le I_{\\text{nom}}(1+\\delta)$ 成立。因此，概率为 1，良率 $Y=1$。\n\n### 实现用公式总结\n对于给定的测试用例 $(t_{\\text{design}}, \\kappa, \\sigma_t, \\delta)$：\n1.  将 $t_{\\text{design}}$ 从纳米转换为米：$t_{\\text{design, m}} = t_{\\text{design, nm}} \\times 10^{-9}$。\n2.  计算标称电流：$I_{\\text{nom}} = \\kappa \\, t_{\\text{design, m}}$（单位为安培）。\n3.  如果 $\\sigma_t = 0$：\n    - 均值电流：$I_{\\text{nom}}$。\n    - 标准差：$0$。\n    - 良率：$1$。\n4.  如果 $\\sigma_t > 0$：\n    - 均值电流：$I_{\\text{nom}} \\exp(\\sigma_t^2 / 2)$。\n    - 标准差：$I_{\\text{nom}} \\sqrt{(\\exp(\\sigma_t^2) - 1) \\exp(\\sigma_t^2)}$。\n    - 良率：$\\Phi\\left(\\frac{\\ln(1 + \\delta)}{\\sigma_t}\\right) - \\Phi\\left(\\frac{\\ln(1 - \\delta)}{\\sigma_t}\\right)$，使用 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$。\n5.  将最终的均值和标准差从安培转换为毫安（mA），方法是乘以 $1000$。\n6.  将所有三个最终值（均值（mA），标准差（mA），良率）四舍五入到六位小数。\n\n至此，解决该问题所需的解析推导完成。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the spintronic device yield problem based on the provided parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is (t_design in nm, kappa in A/m, sigma_t, delta)\n    test_cases = [\n        (1.2, 6e4, 0.1, 0.2),\n        (1.1, 6e4, 0.02, 0.05),\n        (1.3, 6e4, 0.3, 0.1),\n        (1.2, 6e4, 0.0, 0.1)\n    ]\n\n    results = []\n\n    def std_norm_cdf(x):\n        \"\"\"\n        Computes the standard normal cumulative distribution function (CDF), Phi(x),\n        using the Gauss error function as specified.\n        \"\"\"\n        return 0.5 * (1.0 + erf(x / np.sqrt(2.0)))\n\n    for t_design_nm, kappa, sigma_t, delta in test_cases:\n        # Convert thickness from nanometers to meters for calculations.\n        t_design_m = t_design_nm * 1e-9\n\n        # Calculate nominal current in Amperes.\n        I_nom_A = kappa * t_design_m\n\n        if sigma_t == 0.0:\n            # Handle the deterministic case with zero variability.\n            mean_I_A = I_nom_A\n            std_I_A = 0.0\n            yield_val = 1.0\n        else:\n            # General case with non-zero variability.\n            \n            # Calculate mean of the log-normal current distribution in Amperes.\n            mean_I_A = I_nom_A * np.exp(sigma_t**2 / 2.0)\n            \n            # Calculate standard deviation of the log-normal current distribution in Amperes.\n            variance_term = (np.exp(sigma_t**2) - 1.0) * np.exp(sigma_t**2)\n            std_I_A = I_nom_A * np.sqrt(variance_term)\n\n            # Calculate the yield probability.\n            z_high = np.log(1.0 + delta) / sigma_t\n            z_low = np.log(1.0 - delta) / sigma_t\n            yield_val = std_norm_cdf(z_high) - std_norm_cdf(z_low)\n\n        # Convert current statistics from Amperes to milliamperes (mA).\n        mean_I_mA = mean_I_A * 1000.0\n        std_I_mA = std_I_A * 1000.0\n\n        # Append the rounded results to the list.\n        results.extend([\n            round(mean_I_mA, 6),\n            round(std_I_mA, 6),\n            round(yield_val, 6)\n        ])\n\n    # Format the final output as a single-line comma-separated list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}