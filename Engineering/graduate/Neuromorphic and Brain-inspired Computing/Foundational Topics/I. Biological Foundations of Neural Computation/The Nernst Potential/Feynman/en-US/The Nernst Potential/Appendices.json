{
    "hands_on_practices": [
        {
            "introduction": "The Nernst potential is the foundational concept linking an ion's concentration gradient across a membrane to the electrical potential that balances it. This first practice exercise solidifies that foundation by guiding you to derive the Nernst equation from the principle of electrochemical equilibrium. By calculating the reversal potential for chloride ions ($Cl^-$), you will gain direct experience with the core formula and the crucial role that ionic valence ($z$) plays in determining the potential's sign .",
            "id": "3938291",
            "problem": "A single-compartment neuronal membrane is permeable predominantly to chloride ions. Let $\\phi_i$ and $\\phi_o$ denote the intracellular and extracellular electric potentials, respectively, and let $E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$ be the transmembrane potential difference that sets the net flux of chloride to zero. At equilibrium for a permeant ion, the electrochemical potential is equal on both sides of the membrane. Assume ideal dilute solutions so that the chemical activity equals the molar concentration. The intracellular and extracellular chloride concentrations are given by $[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$ and $[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$. The absolute temperature is $T = 310\\,\\mathrm{K}$ and the valence of chloride is $z = -1$. Use the gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and the Faraday constant $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$. \n\nStarting from the definition of chemical potential and the condition of electrochemical equilibrium, derive the expression for $E_{\\mathrm{Cl}^-}$ in terms of the given quantities and evaluate its numerical value for the data provided. Express your final answer in millivolts and round to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and complete. It presents a standard exercise in biophysical chemistry, requiring the derivation and calculation of the Nernst potential for chloride ions. All necessary data and constants are provided, and the conditions are physically and biologically realistic.\n\nThe fundamental principle governing the equilibrium distribution of a permeant ion across a membrane is the equality of its electrochemical potential on both sides. The electrochemical potential, $\\tilde{\\mu}_j$, for an ionic species $j$ in a solution is given by the sum of its chemical potential and its electrical potential energy per mole:\n$$ \\tilde{\\mu}_j = \\mu_j^0 + RT \\ln(a_j) + z_j F \\phi $$\nwhere $\\mu_j^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, $a_j$ is the chemical activity of the ion, $z_j$ is its valence (charge number), $F$ is the Faraday constant, and $\\phi$ is the local electric potential.\n\nThe problem specifies that the system is at equilibrium for chloride ions ($\\mathrm{Cl}^-$). Therefore, the electrochemical potential for chloride on the intracellular side ($i$) must be equal to its electrochemical potential on the extracellular side ($o$):\n$$ \\tilde{\\mu}_{\\mathrm{Cl}^-, i} = \\tilde{\\mu}_{\\mathrm{Cl}^-, o} $$\nSubstituting the expression for electrochemical potential for both sides gives:\n$$ \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = \\mu_{\\mathrm{Cl}^-}^0 + RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\nThe standard chemical potential, $\\mu_{\\mathrm{Cl}^-}^0$, is an intrinsic property of the ion in a given solvent and temperature, so it is identical on both sides and cancels out:\n$$ RT \\ln(a_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln(a_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\nThe problem states to assume ideal dilute solutions, which means the chemical activity, $a_j$, can be approximated by the molar concentration, $[\\mathrm{Cl}^-]_j$. Thus, $a_i = [\\mathrm{Cl}^-]_i$ and $a_o = [\\mathrm{Cl}^-]_o$. The equation becomes:\n$$ RT \\ln([\\mathrm{Cl}^-]_i) + z_{\\mathrm{Cl}^-} F \\phi_i = RT \\ln([\\mathrm{Cl}^-]_o) + z_{\\mathrm{Cl}^-} F \\phi_o $$\nWe are asked to find the Nernst potential for chloride, $E_{\\mathrm{Cl}^-}$, which is defined as the transmembrane potential difference at equilibrium, $E_{\\mathrm{Cl}^-} \\equiv \\phi_i - \\phi_o$. Rearranging the equation to solve for this difference:\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln([\\mathrm{Cl}^-]_o) - RT \\ln([\\mathrm{Cl}^-]_i) $$\nUsing the properties of logarithms, $\\ln(x) - \\ln(y) = \\ln(x/y)$:\n$$ z_{\\mathrm{Cl}^-} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\nIsolating the potential difference $\\phi_i - \\phi_o$ yields the Nernst equation for chloride:\n$$ E_{\\mathrm{Cl}^-} = \\phi_i - \\phi_o = \\frac{RT}{z_{\\mathrm{Cl}^-} F} \\ln\\left(\\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i}\\right) $$\nNow, we substitute the given numerical values into this derived expression:\nIntracellular chloride concentration, $[\\mathrm{Cl}^-]_i = 5\\,\\mathrm{mM}$.\nExtracellular chloride concentration, $[\\mathrm{Cl}^-]_o = 120\\,\\mathrm{mM}$.\nAbsolute temperature, $T = 310\\,\\mathrm{K}$.\nValence of chloride, $z = z_{\\mathrm{Cl}^-} = -1$.\nGas constant, $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\nFaraday constant, $F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$.\n\nThe concentration ratio is a dimensionless quantity:\n$$ \\frac{[\\mathrm{Cl}^-]_o}{[\\mathrm{Cl}^-]_i} = \\frac{120\\,\\mathrm{mM}}{5\\,\\mathrm{mM}} = 24 $$\nSubstituting all values into the Nernst equation:\n$$ E_{\\mathrm{Cl}^-} = \\frac{(8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(-1) \\times (96485.33212\\,\\mathrm{C\\,mol^{-1}})} \\ln(24) $$\nThe units $\\mathrm{J\\,C^{-1}}$ are equivalent to Volts ($\\mathrm{V}$). Let's compute the numerical value:\n$$ E_{\\mathrm{Cl}^-} = -\\frac{2577.48341158}{96485.33212} \\times \\ln(24) \\,\\mathrm{V} $$\n$$ E_{\\mathrm{Cl}^-} \\approx -(0.0267140866\\,\\mathrm{V}) \\times (3.17805383) $$\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386\\,\\mathrm{V} $$\nThe problem requires the answer to be in millivolts ($\\mathrm{mV}$) and rounded to four significant figures. To convert from volts to millivolts, we multiply by $1000$:\n$$ E_{\\mathrm{Cl}^-} \\approx -0.084918386 \\times 1000\\,\\mathrm{mV} = -84.918386\\,\\mathrm{mV} $$\nRounding to four significant figures, we get:\n$$ E_{\\mathrm{Cl}^-} \\approx -84.92\\,\\mathrm{mV} $$\nThis negative value indicates that, at equilibrium, the inside of the cell is electrically negative relative to the outside, which is required to counteract the chemical gradient that favors the influx of chloride ions from the higher extracellular concentration to the lower intracellular concentration.",
            "answer": "$$\n\\boxed{-84.92}\n$$"
        },
        {
            "introduction": "Real biological systems add layers of complexity to idealized models, and this exercise introduces two critical factors: ionic activity and ion buffering. This is especially important for signaling ions like calcium ($Ca^{2+}$), whose free concentration is tightly regulated and differs significantly from its total concentration. By working through this problem , you will learn to apply the Nernst equation to the physiologically relevant free ion activity, a vital skill for accurate biological and neuromorphic modeling.",
            "id": "3938258",
            "problem": "A single-compartment neuronal preparation is bathed in an extracellular solution containing calcium ions and no chelator, while the cytosol contains a fast calcium buffer with one-to-one binding stoichiometry. The membrane is assumed perfectly selective to calcium ions. The extracellular solution has no calcium chelator and a calcium concentration of $[{\\text{Ca}^{2+}}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$. The intracellular solution contains a total chelator concentration $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$ and a total calcium concentration $[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$. The buffer reaction is\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B,\n$$\nwith activity-based dissociation constant $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$, defined by\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}},\n$$\nwhere $a_{i}$ denotes the activity of species $i$.\n\nAssume the following:\n- The activities are related to concentrations by $a_{i} = \\gamma_{i} [i]$, where $\\gamma_{i}$ is the activity coefficient of species $i$.\n- Intracellular activity coefficients satisfy $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$, $\\gamma_{B,\\text{in}} = 1$, and $\\gamma_{\\text{Ca}B,\\text{in}} = 1$.\n- Extracellular calcium has activity coefficient $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$.\n- Ignore protonation or competing binding of the chelator and any other ion interactions; treat the buffer as rapid and at equilibrium.\n\nUsing the equality of electrochemical potentials for calcium across the membrane at equilibrium, derive and compute the equilibrium membrane potential for calcium, $E_{\\text{Ca}^{2+}}$, using the free calcium activities on each side (not the totals). Use gas constant $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$, absolute temperature $T = 310 \\ \\text{K}$, Faraday constant $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$, and valence $z = 2$ for calcium. Express your final answer in millivolts and round your answer to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information to compute the equilibrium membrane potential for calcium. The premise is based on fundamental principles of electrochemistry and biophysics, namely the Nernst equation and buffer equilibrium. The provided values are physically realistic for a neurophysiological experiment. Therefore, the problem is valid, and a solution can be determined.\n\nThe equilibrium membrane potential for an ion, also known as the Nernst potential, is determined by the balance of the electrical and chemical potential gradients across the membrane. When the electrochemical potential for an ion is equal on both sides of the membrane, there is no net flux of that ion. For calcium ions (${\\text{Ca}^{2+}}$), this equilibrium is described by the Nernst equation, which, using activities as stipulated, is:\n$$\nE_{\\text{Ca}^{2+}} = \\frac{RT}{zF} \\ln\\left(\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}}\\right)\n$$\nHere, $R$ is the ideal gas constant, $T$ is the absolute temperature, $z$ is the valence of the calcium ion ($z=2$), $F$ is the Faraday constant, $a_{\\text{Ca}^{2+},\\text{out}}$ is the activity of calcium in the extracellular solution, and $a_{\\text{Ca}^{2+},\\text{in}}$ is the activity of free calcium in the intracellular solution (cytosol).\n\nThe solution requires a two-step process: first, determine the activities of free calcium on both sides of the membrane, and second, substitute these values into the Nernst equation.\n\n**1. Calculation of Calcium Activities**\n\n**a. Extracellular Calcium Activity ($a_{\\text{Ca}^{2+},\\text{out}}$)**\nThe activity is related to the concentration by $a_i = \\gamma_i [i]$.\nGiven:\n- Extracellular calcium concentration: $[{\\text{Ca}^{2+}}]_{\\text{out}} = 1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- Extracellular activity coefficient for calcium: $\\gamma_{\\text{Ca}^{2+},\\text{out}} = 0.25$\n\nThe extracellular activity is calculated as:\n$$\na_{\\text{Ca}^{2+},\\text{out}} = \\gamma_{\\text{Ca}^{2+},\\text{out}} [{\\text{Ca}^{2+}}]_{\\text{out}} = (0.25) \\times (1.2 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}) = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**b. Intracellular Calcium Activity ($a_{\\text{Ca}^{2+},\\text{in}}$)**\nThe intracellular activity depends on the concentration of *free* calcium ions, $[{\\text{Ca}^{2+}}]_{\\text{in,free}}$. This concentration is determined by the equilibrium of the calcium buffer reaction:\n$$\n\\text{Ca}^{2+} + B \\rightleftharpoons \\text{Ca}B\n$$\nWe need to solve for $[{\\text{Ca}^{2+}}]_{\\text{in,free}}$ using the given total concentrations and the dissociation constant. Let's denote the free concentrations of intracellular calcium, buffer, and complex as $[{\\text{Ca}^{2+}}]$, $[B]$, and $[{\\text{Ca}}B]$, respectively.\n\nThe conservation equations are:\n$$\n[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = [{\\text{Ca}^{2+}}] + [{\\text{Ca}}B]\n$$\n$$\n[B]_{\\text{tot,in}} = [B] + [{\\text{Ca}}B]\n$$\nThe activity-based dissociation constant is:\n$$\nK_{d} = \\frac{a_{\\text{Ca}^{2+}} \\, a_{B}}{a_{\\text{Ca}B}} = \\frac{(\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}]) \\, (\\gamma_{B,\\text{in}} [B])}{\\gamma_{\\text{Ca}B,\\text{in}} [{\\text{Ca}}B]}\n$$\nGiven $\\gamma_{B,\\text{in}} = 1$ and $\\gamma_{\\text{Ca}B,\\text{in}} = 1$, the equation simplifies to:\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}] [B]}{[{\\text{Ca}}B]}\n$$\nFrom the conservation equations, we express $[{\\text{Ca}}B]$ and $[B]$ in terms of $[{\\text{Ca}^{2+}}]$:\n$$\n[{\\text{Ca}}B] = [{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]\n$$\n$$\n[B] = [B]_{\\text{tot,in}} - [{\\text{Ca}}B] = [B]_{\\text{tot,in}} - ([{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}])\n$$\nSubstituting these into the dissociation constant equation:\n$$\nK_{d} = \\frac{\\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}] \\left( [B]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]_{\\text{tot,in}} + [{\\text{Ca}^{2+}}] \\right)}{[{\\text{Ca}^{2+}}]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]}\n$$\nRearranging this yields a quadratic equation for $[{\\text{Ca}^{2+}}]$ of the form $ax^2+bx+c=0$, where $x = [{\\text{Ca}^{2+}}]$:\n$$\n(\\gamma_{\\text{Ca}^{2+},\\text{in}}) [{\\text{Ca}^{2+}}]^2 + (\\gamma_{\\text{Ca}^{2+},\\text{in}}([B]_{\\text{tot,in}} - [{\\text{Ca}^{2+}}]_{\\text{tot,in}}) + K_{d}) [{\\text{Ca}^{2+}}] - K_{d}[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 0\n$$\nLet's substitute the given values to find the coefficients $a$, $b$, and $c$:\n- $[{\\text{Ca}^{2+}}]_{\\text{tot,in}} = 1.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $[B]_{\\text{tot,in}} = 1.0 \\times 10^{-3} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $K_{d} = 1.5 \\times 10^{-7} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $\\gamma_{\\text{Ca}^{2+},\\text{in}} = 0.35$\n\nThe coefficients are:\n$$\na = 0.35\n$$\n$$\nb = 0.35 \\times (1.0 \\times 10^{-3} - 1.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 0.35 \\times (9.0 \\times 10^{-4}) + 1.5 \\times 10^{-7} = 3.15 \\times 10^{-4} + 1.5 \\times 10^{-7} = 3.1515 \\times 10^{-4}\n$$\n$$\nc = -(1.5 \\times 10^{-7}) \\times (1.0 \\times 10^{-4}) = -1.5 \\times 10^{-11}\n$$\nSolving the quadratic equation $ax^2+bx+c=0$ for the physically meaningful positive root $x = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$:\n$$\nb^2 - 4ac = (3.1515 \\times 10^{-4})^2 - 4(0.35)(-1.5 \\times 10^{-11}) \\approx 9.93195 \\times 10^{-8} + 2.1 \\times 10^{-11} \\approx 9.93405 \\times 10^{-8}\n$$\n$$\n\\sqrt{b^2 - 4ac} \\approx \\sqrt{9.93405 \\times 10^{-8}} \\approx 3.15183 \\times 10^{-4}\n$$\n$$\n[{\\text{Ca}^{2+}}] = \\frac{-3.1515 \\times 10^{-4} + 3.15183 \\times 10^{-4}}{2 \\times 0.35} \\approx \\frac{3.3 \\times 10^{-8}}{0.7} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\nSo, the free intracellular calcium concentration is $[{\\text{Ca}^{2+}}]_{\\text{in,free}} \\approx 4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$.\n\nNow we can find the intracellular activity:\n$$\na_{\\text{Ca}^{2+},\\text{in}} = \\gamma_{\\text{Ca}^{2+},\\text{in}} [{\\text{Ca}^{2+}}]_{\\text{in,free}} = 0.35 \\times (4.7594 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}) \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}\n$$\n\n**2. Calculation of the Nernst Potential ($E_{\\text{Ca}^{2+}}$)**\n\nNow we substitute the activities and constants into the Nerrnst equation:\n- $R = 8.314462618 \\ \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n- $T = 310 \\ \\text{K}$\n- $z = 2$\n- $F = 96485.33212 \\ \\text{C} \\cdot \\text{mol}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{out}} = 3.0 \\times 10^{-4} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n- $a_{\\text{Ca}^{2+},\\text{in}} \\approx 1.6658 \\times 10^{-8} \\ \\text{mol} \\cdot \\text{L}^{-1}$\n\nLet's first compute the pre-factor $\\frac{RT}{zF}$:\n$$\n\\frac{RT}{zF} = \\frac{(8.314462618)(310)}{2 \\times 96485.33212} \\ \\text{V} \\approx 0.013357 \\ \\text{V}\n$$\nNext, the ratio of activities:\n$$\n\\frac{a_{\\text{Ca}^{2+},\\text{out}}}{a_{\\text{Ca}^{2+},\\text{in}}} = \\frac{3.0 \\times 10^{-4}}{1.6658 \\times 10^{-8}} \\approx 18009.6\n$$\nNow, calculate the Nernst potential:\n$$\nE_{\\text{Ca}^{2+}} = (0.013357 \\ \\text{V}) \\times \\ln(18009.6) \\approx (0.013357 \\ \\text{V}) \\times (9.7987) \\approx 0.13088 \\ \\text{V}\n$$\nThe problem asks for the answer in millivolts ($mV$).\n$$\nE_{\\text{Ca}^{2+}} = 0.13088 \\ \\text{V} \\times 1000 \\ \\frac{\\text{mV}}{\\text{V}} = 130.88 \\ \\text{mV}\n$$\nRounding to four significant figures, the final result is $130.9 \\ \\text{mV}$.",
            "answer": "$$\\boxed{130.9}$$"
        },
        {
            "introduction": "The Nernst potential is not a static constant but a dynamic variable dependent on its environment, particularly temperature ($T$). This final practice moves beyond static equilibrium to explore how the reversal potential, and consequently ionic currents, respond to time-varying changes in temperature. This exercise  provides hands-on experience in analyzing the dynamic behavior of ion channels, a fundamental task in both computational neuroscience and the design of adaptive neuromorphic systems.",
            "id": "4065599",
            "problem": "A neuromorphic ion channel is modeled as a passive conductance that instantaneously follows the electrochemical driving force. Consider a single ionic species with valence $z$, intracellular concentration $c_{\\mathrm{in}}$, extracellular concentration $c_{\\mathrm{out}}$, and a constant membrane potential $V_m$. Let the absolute temperature be time-varying $T(t)$. The ionic current is modeled as $I(t) = g \\left( V_m - E(t) \\right)$, where $g$ is the channel conductance and $E(t)$ is the reversal potential of the ionic species. Use the following fundamental base for the derivation: the electrochemical potential per mole of an ion is $\\mu = \\mu^0 + RT \\ln c + z F \\phi$, where $R$ is the gas constant, $F$ is the Faraday constant, $c$ is concentration, and $\\phi$ is the electric potential. At equilibrium (no net flux), the electrochemical potentials inside and outside are equal. Starting from these facts, derive from first principles what $E(t)$ must be in terms of $T(t)$, $z$, $c_{\\mathrm{in}}$, and $c_{\\mathrm{out}}$, without using any pre-quoted reversal potential formulas.\n\nThe temperature is driven by a transient:\n$$\nT(t) =\n\\begin{cases}\nT_0, & t < t_{\\mathrm{start}}, \\\\\nT_0 + \\Delta T \\, e^{-\\frac{t - t_{\\mathrm{start}}}{\\tau_T}}, & t \\ge t_{\\mathrm{start}} ,\n\\end{cases}\n$$\nwhere $T_0$ is the baseline temperature, $\\Delta T$ is the instantaneous increase at time $t_{\\mathrm{start}}$, and $\\tau_T$ is the decay time constant.\n\nYour tasks are:\n- From the fundamental base, derive $E(t)$.\n- For each test case, compute the baseline reversal potential $E_0 = E(t)$ at $T(t) = T_0$ in volts, compute the peak reversal potential $E_{\\mathrm{peak}} = E(t_{\\mathrm{start}}^+)$ in volts (i.e., immediately after the transient onset when $T = T_0 + \\Delta T$), and determine whether the current direction flips at any time during the transient. A flip is defined as the sign of $I(t)$ changing from its sign at baseline; formally, if $\\mathrm{sgn}\\!\\left(I(0^-)\\right)$ is nonzero, a flip occurs if there exists a time $t$ with $\\mathrm{sgn}\\!\\left(I(t)\\right) = -\\mathrm{sgn}\\!\\left(I(0^-)\\right)$. If $\\mathrm{sgn}\\!\\left(I(0^-)\\right) = 0$, define a flip to occur only if there exist times $t_1$ and $t_2$ such that $\\mathrm{sgn}\\!\\left(I(t_1)\\right) = +1$ and $\\mathrm{sgn}\\!\\left(I(t_2)\\right) = -1$.\n- Express all potentials in volts and the current in amperes; time is in seconds and temperature in kelvin. In the final output, round all voltages to six decimal places and report the flip decision as a boolean.\n\nUse the constants $R = 8.314462618$ (joules per mole per kelvin) and $F = 96485.33212$ (coulombs per mole). Concentrations $c_{\\mathrm{in}}$ and $c_{\\mathrm{out}}$ are provided in $\\mathrm{mol}/\\mathrm{m}^3$. The test suite and parameters are:\n\n- Case $1$ (monovalent cation): $z = 1$, $c_{\\mathrm{out}} = 5$, $c_{\\mathrm{in}} = 140$, $V_m = -0.065$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, simulate on $[0, 0.2]$ with time step $\\Delta t = 0.0001$.\n- Case $2$ (monovalent anion): $z = -1$, $c_{\\mathrm{out}} = 110$, $c_{\\mathrm{in}} = 10$, $V_m = -0.067$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, simulate on $[0, 0.2]$ with time step $\\Delta t = 0.0001$.\n- Case $3$ (divalent cation): $z = 2$, $c_{\\mathrm{out}} = 2000$, $c_{\\mathrm{in}} = 0.1$, $V_m = 0.135$, $g = 5\\times 10^{-10}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, simulate on $[0, 0.2]$ with time step $\\Delta t = 0.0001$.\n- Case $4$ (boundary concentrations): $z = 1$, $c_{\\mathrm{out}} = 100$, $c_{\\mathrm{in}} = 100$, $V_m = 0$, $g = 1\\times 10^{-9}$, $T_0 = 310$, $\\Delta T = 30$, $t_{\\mathrm{start}} = 0.05$, $\\tau_T = 0.05$, simulate on $[0, 0.2]$ with time step $\\Delta t = 0.0001$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the form $[E_0, E_{\\mathrm{peak}}, \\text{flip}]$, for example, $[[0.001234,0.001567,True],[\\dots]]$. All voltages must be rounded to six decimal places, and the boolean must be either $True$ or $False$.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, and objective. It is based on fundamental principles of electrochemistry and biophysics, provides all necessary data and constraints for a unique solution, and is free of ambiguity or subjective claims. The problem is therefore deemed **valid**.\n\nThe task is to derive the reversal potential $E(t)$ from first principles and then use it to analyze the behavior of an ion channel under a temperature transient.\n\n**Part 1: Derivation of the Reversal Potential $E(t)$**\n\nThe derivation begins with the provided expression for the electrochemical potential, $\\mu$, for a single ionic species:\n$$\n\\mu = \\mu^0 + RT \\ln c + z F \\phi\n$$\nHere, $\\mu^0$ is the standard chemical potential, $R$ is the universal gas constant, $T$ is the absolute temperature, $c$ is the molar concentration of the ion, $z$ is the valence of the ion, $F$ is the Faraday constant, and $\\phi$ is the electric potential.\n\nThe reversal potential, $E(t)$, is defined as the membrane potential at which there is no net flow of the ion across the membrane. This state of zero net flux corresponds to thermodynamic equilibrium. The condition for equilibrium is that the electrochemical potential of the ion inside the cell, $\\mu_{\\mathrm{in}}$, is equal to its electrochemical potential outside the cell, $\\mu_{\\mathrm{out}}$.\n\n$$\n\\mu_{\\mathrm{in}} = \\mu_{\\mathrm{out}}\n$$\nWe can write this equality in terms of the full expression for electrochemical potential. Let $c_{\\mathrm{in}}$ and $\\phi_{\\mathrm{in}}$ be the concentration and electric potential inside the cell, and $c_{\\mathrm{out}}$ and $\\phi_{\\mathrm{out}}$ be the corresponding quantities outside the cell. The temperature, $T(t)$, is assumed to be uniform across the membrane at any given time $t$.\n\n$$\n\\mu^0 + R T(t) \\ln c_{\\mathrm{in}} + z F \\phi_{\\mathrm{in}} = \\mu^0 + R T(t) \\ln c_{\\mathrm{out}} + z F \\phi_{\\mathrm{out}}\n$$\n\nThe standard chemical potential term, $\\mu^0$, is identical on both sides and cancels out.\n$$\nR T(t) \\ln c_{\\mathrm{in}} + z F \\phi_{\\mathrm{in}} = R T(t) \\ln c_{\\mathrm{out}} + z F \\phi_{\\mathrm{out}}\n$$\n\nWe rearrange the equation to solve for the electric potential difference across the membrane, $\\Delta\\phi = \\phi_{\\mathrm{in}} - \\phi_{\\mathrm{out}}$. By definition, this potential difference at equilibrium is the reversal potential, $E(t)$.\n$$\nz F \\phi_{\\mathrm{in}} - z F \\phi_{\\mathrm{out}} = R T(t) \\ln c_{\\mathrm{out}} - R T(t) \\ln c_{\\mathrm{in}}\n$$\n$$\nz F (\\phi_{\\mathrm{in}} - \\phi_{\\mathrm{out}}) = R T(t) (\\ln c_{\\mathrm{out}} - \\ln c_{\\mathrm{in}})\n$$\nUsing the property of logarithms, $\\ln a - \\ln b = \\ln(a/b)$, we have:\n$$\nz F E(t) = R T(t) \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n$$\nSolving for $E(t)$ yields the time-dependent Nernst equation:\n$$\nE(t) = \\frac{R T(t)}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n$$\nThis equation establishes the reversal potential as a direct function of the time-varying temperature $T(t)$, the fixed ionic concentrations $c_{\\mathrm{in}}$ and $c_{\\mathrm{out}}$, and the valency $z$.\n\n**Part 2: Analysis of the System Dynamics**\n\nThe problem requires the calculation of three quantities for each test case:\n1.  **Baseline Reversal Potential, $E_0$**: This is the potential at the baseline temperature $T_0$, which occurs for any time $t < t_{\\mathrm{start}}$.\n    $$\n    E_0 = E(t < t_{\\mathrm{start}}) = \\frac{R T_0}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n    $$\n2.  **Peak Reversal Potential, $E_{\\mathrm{peak}}$**: This is the potential immediately after the onset of the temperature transient at $t = t_{\\mathrm{start}}^+$. At this instant, the temperature is $T(t_{\\mathrm{start}}^+) = T_0 + \\Delta T e^0 = T_0 + \\Delta T$.\n    $$\n    E_{\\mathrm{peak}} = E(t_{\\mathrm{start}}^+) = \\frac{R (T_0 + \\Delta T)}{z F} \\ln \\frac{c_{\\mathrm{out}}}{c_{\\mathrm{in}}}\n    $$\n3.  **Current Flip Determination**: The ionic current is given by $I(t) = g(V_m - E(t))$. Since the conductance $g$ is a positive constant, the sign of the current, $\\mathrm{sgn}(I(t))$, is determined solely by the sign of the driving force, $V_m - E(t)$. A current flip occurs if the sign of the driving force changes from its baseline value.\n    The baseline driving force sign is $\\mathrm{sgn}(V_m - E_0)$. For a flip to occur, there must exist a time $t \\ge t_{\\mathrm{start}}$ such that $\\mathrm{sgn}(V_m - E(t))$ is the opposite of $\\mathrm{sgn}(V_m - E_0)$.\n    The temperature $T(t)$ for $t \\ge t_{\\mathrm{start}}$ starts at $T_0 + \\Delta T$ and monotonically decays towards $T_0$. Consequently, the reversal potential $E(t)$ starts at $E_{\\mathrm{peak}}$ and monotonically moves towards $E_0$. The set of values adopted by $E(t)$ during the transient is the closed interval between $E_0$ and $E_{\\mathrm{peak}}$.\n    The driving force $V_m - E(t)$ will change sign if and only if the constant membrane potential $V_m$ lies strictly between the initial and final values of the reversal potential during the transient. That is, a flip occurs if $V_m$ is strictly between $E_0$ and $E_{\\mathrm{peak}}$. This condition can be expressed mathematically as:\n    $$\n    (V_m - E_0)(V_m - E_{\\mathrm{peak}}) < 0\n    $$\n    This inequality serves as a direct test for the occurrence of a current flip, obviating the need for a full time-domain simulation.\n\nThe special case where the baseline current is zero ($V_m = E_0$) is handled by this condition as well. In this scenario, $(V_m - E_0)$ is zero, so the product is zero, not negative. Therefore, no flip is registered. This aligns with the problem's definition for a flip when starting at zero current, which requires the current to take on both positive and negative values. As $E(t)$ will be entirely on one side of $E_0=V_m$ during the transient (assuming $E_0 \\neq E_{peak}$), the current $I(t)$ will be non-zero but will not change its sign. If $E_0 = E_{peak}$ (as in the case $c_{in} = c_{out}$), the current remains zero throughout.\n\nThe calculations for each case will proceed based on these derived formulas.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neuromorphic ion channel problem by deriving and calculating\n    key potential values and determining if a current flip occurs.\n    \"\"\"\n    # Define physical constants\n    R = 8.314462618  # J / (mol * K)\n    F = 96485.33212  # C / mol\n\n    # Define the test cases from the problem statement.\n    # Format: (z, c_out, c_in, V_m, g, T0, delta_T, t_start, tau_T)\n    test_cases = [\n        # Case 1 (monovalent cation)\n        (1, 5.0, 140.0, -0.065, 1e-9, 310.0, 30.0, 0.05, 0.05),\n        # Case 2 (monovalent anion)\n        (-1, 110.0, 10.0, -0.067, 1e-9, 310.0, 30.0, 0.05, 0.05),\n        # Case 3 (divalent cation)\n        (2, 2000.0, 0.1, 0.135, 5e-10, 310.0, 30.0, 0.05, 0.05),\n        # Case 4 (boundary concentrations)\n        (1, 100.0, 100.0, 0.0, 1e-9, 310.0, 30.0, 0.05, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        z, c_out, c_in, V_m, g, T0, delta_T, t_start, tau_T = case\n\n        # The term R/F has units of Volts / K\n        # The term ln(c_out / c_in) is dimensionless\n        \n        # Calculate ln(c_out / c_in)\n        # Check for c_in = c_out to avoid potential floating point issues,\n        # although np.log(1.0) is exactly 0.0.\n        if c_out == c_in:\n            log_c_ratio = 0.0\n        else:\n            log_c_ratio = np.log(c_out / c_in)\n\n        # Prefactor for Nernst potential calculation\n        # E(T) = (RT/zF) * log_c_ratio = (R/F) * (T/z) * log_c_ratio\n        if z == 0:\n            # Handle non-ionic species, though not in test cases\n            # If z=0, the electric potential term in the electrochemical potential\n            # is zero. Equilibrium is only possible if concentrations are equal\n            # (log_c_ratio=0). In this case, E is undefined but the driving force\n            # is independent of V_m, and no current flows unless other forces exist.\n            # For this problem, we can assume z is non-zero.\n            pass\n        \n        # Calculate baseline reversal potential E0 at temperature T0\n        E0 = (R * T0 / (z * F)) * log_c_ratio\n\n        # Calculate peak temperature and peak reversal potential E_peak\n        T_peak = T0 + delta_T\n        E_peak = (R * T_peak / (z * F)) * log_c_ratio\n        \n        # Determine if a current flip occurs.\n        # A flip occurs if V_m lies strictly between E0 and E_peak.\n        # This can be tested by checking if (V_m - E0) and (V_m - E_peak)\n        # have opposite signs, which means their product is negative.\n        # If V_m is equal to E0 or E_peak, the product is 0, no flip.\n        # If V_m is outside the range [E0, E_peak], the product is positive, no flip.\n        flip = (V_m - E0) * (V_m - E_peak) < 0\n        \n        results.append([E0, E_peak, flip])\n\n    # Format the final output string exactly as required.\n    # Voltages are rounded to six decimal places, and booleans are 'True' or 'False'.\n    output_parts = []\n    for result in results:\n        e0_val, epeak_val, flip_val = result\n        # Round the numerical values\n        e0_rounded = round(e0_val, 6)\n        epeak_rounded = round(epeak_val, 6)\n        # Format the sublist string\n        output_parts.append(f\"[{e0_rounded:.6f},{epeak_rounded:.6f},{flip_val}]\")\n    \n    # Join all sublist strings into the final output format\n    final_output = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}