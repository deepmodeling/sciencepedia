{
    "hands_on_practices": [
        {
            "introduction": "Neuronal refractoriness is not an abstract concept but a direct result of intricate biophysical machinery at the level of ion channels. This practice invites you to explore the dynamics of the sodium channel inactivation gate, a key player in the refractory period, using the celebrated Hodgkin-Huxley formalism . By deriving the recovery time constant $\\tau_h(V)$ and examining its voltage dependence, you will gain a concrete understanding of how a neuron's membrane potential governs its readiness to fire a subsequent action potential.",
            "id": "4053164",
            "problem": "A neuromorphic sodium inactivation gate is modeled by the Hodgkin–Huxley (HH) formalism, where the inactivation variable $h(t)$ evolves under a voltage clamp at fixed membrane potential $V$ according to the kinetic equation\n$$\n\\frac{dh}{dt}=\\alpha_{h}(V)\\big(1-h\\big)-\\beta_{h}(V)\\,h,\n$$\nwith voltage-dependent rates $\\alpha_{h}(V)$ and $\\beta_{h}(V)$ that are nonnegative and bounded on any finite voltage interval. In neuromorphic and brain-inspired computing, the refractory recovery of sodium channels after a spike is governed by the relaxation dynamics of $h(t)$ back to its steady state $h_{\\infty}(V)$ when the membrane is held at a given $V$. The recovery time constant $\\tau_{h}(V)$ is defined as the characteristic time scale of the exponential approach of $h(t)$ to $h_{\\infty}(V)$ after a voltage step, assuming $V$ is held constant and $h$ is initially displaced from $h_{\\infty}(V)$.\n\n1. Starting from the kinetic equation above and the definition of exponential relaxation to steady state for a linear first-order system at fixed $V$, derive an expression for the recovery time constant $\\tau_{h}(V)$ in terms of $\\alpha_{h}(V)$ and $\\beta_{h}(V)$, without invoking any prederived gating formulas.\n\n2. To quantify the effect of hyperpolarization on recovery in a canonical HH-based neuromorphic design, use the classical rate functions\n$$\n\\alpha_{h}(V)=0.07\\,\\exp\\!\\left(-\\frac{V+65}{20}\\right),\\qquad\n\\beta_{h}(V)=\\frac{1}{\\exp\\!\\left(-\\frac{V+35}{10}\\right)+1},\n$$\nwhere $V$ is in millivolts and time is in milliseconds. Compute the ratio\n$$\nR=\\frac{\\tau_{h}(-95\\ \\text{mV})}{\\tau_{h}(-65\\ \\text{mV})}\n$$\nto demonstrate how hyperpolarization influences recovery speed. Express the final ratio as a pure number (unitless) and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the Hodgkin-Huxley formalism, well-posed, and objective. All necessary information is provided, and the task involves a standard derivation and calculation within computational neuroscience.\n\n**Part 1: Derivation of the Recovery Time Constant $\\tau_{h}(V)$**\n\nWe begin with the kinetic equation for the sodium inactivation variable $h(t)$ at a fixed membrane potential $V$:\n$$\n\\frac{dh}{dt}=\\alpha_{h}(V)\\big(1-h\\big)-\\beta_{h}(V)\\,h\n$$\nSince the voltage $V$ is held constant (voltage clamp), the rate functions $\\alpha_{h}(V)$ and $\\beta_{h}(V)$ are constants with respect to time $t$. For notational simplicity during the derivation, let us denote them as $\\alpha_h$ and $\\beta_h$. We can expand and rearrange the differential equation:\n$$\n\\frac{dh}{dt} = \\alpha_h - \\alpha_h h - \\beta_h h\n$$\n$$\n\\frac{dh}{dt} = \\alpha_h - (\\alpha_h + \\beta_h)h\n$$\nThis is a first-order linear ordinary differential equation. To find the time constant, we can arrange it into the standard form $\\tau \\frac{dy}{dt} + y = y_{\\infty}$, where $\\tau$ is the time constant and $y_{\\infty}$ is the steady-state value.\n$$\n\\frac{dh}{dt} + (\\alpha_h + \\beta_h)h = \\alpha_h\n$$\nTo match the standard form, we divide the entire equation by the term $(\\alpha_h + \\beta_h)$:\n$$\n\\frac{1}{\\alpha_h + \\beta_h} \\frac{dh}{dt} + h = \\frac{\\alpha_h}{\\alpha_h + \\beta_h}\n$$\nThe steady-state value of $h$, denoted $h_{\\infty}$, is reached when the system is at equilibrium, i.e., when $\\frac{dh}{dt} = 0$. From the original rearranged equation:\n$$\n0 = \\alpha_h - (\\alpha_h + \\beta_h)h_{\\infty}\n$$\nSolving for $h_{\\infty}$ gives:\n$$\nh_{\\infty} = \\frac{\\alpha_h}{\\alpha_h + \\beta_h}\n$$\nSubstituting this back into our rearranged ODE, we get:\n$$\n\\frac{1}{\\alpha_h + \\beta_h} \\frac{dh}{dt} + h = h_{\\infty}\n$$\nBy comparing this to the canonical form $\\tau_h \\frac{dh}{dt} + h = h_{\\infty}$, we can directly identify the time constant $\\tau_h$. Reintroducing the explicit dependence on voltage $V$, we find:\n$$\n\\tau_h(V) = \\frac{1}{\\alpha_{h}(V) + \\beta_{h}(V)}\n$$\nThis is the expression for the recovery time constant.\n\n**Part 2: Calculation of the Ratio $R$**\n\nWe are asked to compute the ratio $R = \\frac{\\tau_{h}(-95\\ \\text{mV})}{\\tau_{h}(-65\\ \\text{mV})}$. Using the expression for $\\tau_h(V)$ derived in Part 1, we can write the ratio as:\n$$\nR = \\frac{\\frac{1}{\\alpha_{h}(-95) + \\beta_{h}(-95)}}{\\frac{1}{\\alpha_{h}(-65) + \\beta_{h}(-65)}} = \\frac{\\alpha_{h}(-65) + \\beta_{h}(-65)}{\\alpha_{h}(-95) + \\beta_{h}(-95)}\n$$\nThe given rate functions are:\n$$\n\\alpha_{h}(V)=0.07\\,\\exp\\!\\left(-\\frac{V+65}{20}\\right)\n$$\n$$\n\\beta_{h}(V)=\\frac{1}{\\exp\\!\\left(-\\frac{V+35}{10}\\right)+1}\n$$\nFirst, we evaluate the rates at $V = -65\\ \\text{mV}$:\n$$\n\\alpha_{h}(-65) = 0.07\\,\\exp\\!\\left(-\\frac{-65+65}{20}\\right) = 0.07\\,\\exp(0) = 0.07\n$$\n$$\n\\beta_{h}(-65) = \\frac{1}{\\exp\\!\\left(-\\frac{-65+35}{10}\\right)+1} = \\frac{1}{\\exp\\!\\left(-\\frac{-30}{10}\\right)+1} = \\frac{1}{\\exp(3)+1}\n$$\nThe sum in the numerator of $R$ is:\n$$\n\\alpha_{h}(-65) + \\beta_{h}(-65) = 0.07 + \\frac{1}{\\exp(3)+1}\n$$\nNext, we evaluate the rates at $V = -95\\ \\text{mV}$:\n$$\n\\alpha_{h}(-95) = 0.07\\,\\exp\\!\\left(-\\frac{-95+65}{20}\\right) = 0.07\\,\\exp\\!\\left(-\\frac{-30}{20}\\right) = 0.07\\,\\exp(1.5)\n$$\n$$\n\\beta_{h}(-95) = \\frac{1}{\\exp\\!\\left(-\\frac{-95+35}{10}\\right)+1} = \\frac{1}{\\exp\\!\\left(-\\frac{-60}{10}\\right)+1} = \\frac{1}{\\exp(6)+1}\n$$\nThe sum in the denominator of $R$ is:\n$$\n\\alpha_{h}(-95) + \\beta_{h}(-95) = 0.07\\,\\exp(1.5) + \\frac{1}{\\exp(6)+1}\n$$\nNow, we compute the numerical values.\nThe numerator is:\n$$\n0.07 + \\frac{1}{\\exp(3)+1} \\approx 0.07 + \\frac{1}{20.085537+1} = 0.07 + \\frac{1}{21.085537} \\approx 0.07 + 0.047426 = 0.117426\n$$\nThe denominator is:\n$$\n0.07\\,\\exp(1.5) + \\frac{1}{\\exp(6)+1} \\approx 0.07 \\times 4.481689 + \\frac{1}{403.428793+1} \\approx 0.313718 + \\frac{1}{404.428793} \\approx 0.313718 + 0.002473 = 0.316191\n$$\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{0.117426}{0.316191} \\approx 0.37137508\n$$\nRounding the result to four significant figures, we get:\n$$\nR \\approx 0.3714\n$$\nThis result, being less than $1$, indicates that the recovery time constant is smaller at the hyperpolarized potential ($-95\\ \\text{mV}$) than at the reference potential ($-65\\ \\text{mV}$), meaning recovery from inactivation is faster.",
            "answer": "$$\\boxed{0.3714}$$"
        },
        {
            "introduction": "While biophysical models provide detailed accuracy, simplified abstract models often yield deeper insights into a system's core principles. In this exercise, we will model a neuron as a stochastic \"point process\" emitter that includes a simple but crucial rule: an absolute refractory period or \"dead-time\" $\\Delta$ after each spike . Your task is to derive the steady-state firing rate of this neuron, revealing the fundamental relationship between the intrinsic drive $\\lambda$ and the refractory constraint, and discovering the ultimate speed limit it imposes on neural firing.",
            "id": "4053200",
            "problem": "In a neuromorphic spike generator emulating neuronal refractoriness, the output spike train is modeled as a renewal process driven by a constant hazard that is state dependent: after each output spike, the system enters an absolute refractory state of fixed duration $ \\Delta > 0 $ during which no spikes can be emitted, and immediately upon leaving this state the system behaves as a memoryless emitter with constant hazard (instantaneous spike probability rate) $ \\lambda > 0 $ as long as it is not refractory. Assume that the refractory state is non-paralyzable, meaning putative input events during the refractory interval do not extend its duration, and that the drive is stationary and constant in time so that stationarity of the output renewal process can be assumed.\n\nFrom first principles appropriate to renewal processes and point processes with state-dependent hazard, derive the steady-state firing rate $ \\nu $ of the output spike train under this constant drive. Your derivation should explicitly identify the interspike interval distribution implied by the specified state-dependent hazard, compute its mean, and invoke only foundational renewal arguments to connect this mean to the steady-state firing rate. Then, interpret the limiting behavior of $ \\nu $ as $ \\lambda \\to \\infty $ in terms of the refractory parameter $ \\Delta $ and the neuromorphic spiking mechanism described.\n\nProvide the final answer as a single closed-form analytic expression for $ \\nu $ in terms of $ \\lambda $ and $ \\Delta $. Do not include units in the final expression. You may discuss the limiting interpretation in your solution, but it must not alter the required form of the final answer.",
            "solution": "The problem asks for the steady-state firing rate, $\\nu$, of a spike generator that operates as a renewal process. A key property of a stationary renewal process is that its long-term average rate is the reciprocal of the mean interspike interval (ISI). Let $T$ be the random variable representing the duration of an ISI. The steady-state firing rate is then given by the elementary renewal theorem:\n$$ \\nu = \\frac{1}{\\mathbb{E}[T]} $$\nwhere $\\mathbb{E}[T]$ is the mean of the ISI distribution. Our first task is to determine the probability distribution of $T$.\n\nThe process of generating an interval $T$ is described in two stages:\n1. An absolute refractory period of fixed duration $\\Delta$. During this time, the probability of firing is zero.\n2. After this period, the system becomes a memoryless emitter with a constant hazard rate $\\lambda$.\n\nLet's formalize this. The interspike interval $T$ can be expressed as the sum of the deterministic refractory duration $\\Delta$ and a random variable, let's call it $T_{wait}$, which represents the waiting time for a spike *after* the refractory period has ended.\n$$ T = \\Delta + T_{wait} $$\nThe problem states that after time $\\Delta$, the system has a constant hazard rate $\\lambda$. A process with a constant hazard rate is a Poisson process. The waiting time for the next event in a Poisson process with rate $\\lambda$ follows an exponential distribution with the same rate parameter.\nThus, the random variable $T_{wait}$ is exponentially distributed with rate $\\lambda$. The probability density function (PDF) of $T_{wait}$, let's denote it as $f_{T_{wait}}(t')$, is given by:\n$$ f_{T_{wait}}(t') = \\lambda \\exp(-\\lambda t') \\quad \\text{for } t' \\ge 0 $$\nand $f_{T_{wait}}(t') = 0$ for $t' < 0$.\n\nNow we can find the PDF of the total interspike interval $T$. Let this PDF be $p(t)$.\nSince no spike can occur before the refractory period is over, $p(t) = 0$ for $t < \\Delta$.\nFor $t \\ge \\Delta$, an interval of duration $t$ occurs if the waiting time after the refractory period, $T_{wait}$, is exactly $t - \\Delta$. Therefore, the probability density $p(t)$ is given by the density of $T_{wait}$ evaluated at $t' = t - \\Delta$:\n$$ p(t) = f_{T_{wait}}(t - \\Delta) = \\lambda \\exp(-\\lambda (t - \\Delta)) \\quad \\text{for } t \\ge \\Delta $$\nThis distribution is a shifted exponential distribution.\n\nThe next step is to compute the mean interspike interval, $\\mathbb{E}[T]$. We can use the linearity of expectation:\n$$ \\mathbb{E}[T] = \\mathbb{E}[\\Delta + T_{wait}] = \\mathbb{E}[\\Delta] + \\mathbb{E}[T_{wait}] $$\nSince $\\Delta$ is a constant, its expectation is simply $\\Delta$. The mean of an exponential distribution with rate parameter $\\lambda$ is $\\frac{1}{\\lambda}$. Therefore:\n$$ \\mathbb{E}[T_{wait}] = \\frac{1}{\\lambda} $$\nSubstituting these into the expression for $\\mathbb{E}[T]$:\n$$ \\mathbb{E}[T] = \\Delta + \\frac{1}{\\lambda} $$\nThis is the mean interspike interval.\n\nFinally, we use the renewal theorem to find the steady-state firing rate $\\nu$:\n$$ \\nu = \\frac{1}{\\mathbb{E}[T]} = \\frac{1}{\\Delta + \\frac{1}{\\lambda}} $$\nTo obtain a single closed-form expression, we can simplify this fraction:\n$$ \\nu = \\frac{1}{\\frac{\\lambda\\Delta + 1}{\\lambda}} = \\frac{\\lambda}{1 + \\lambda\\Delta} $$\nThis is the derived steady-state firing rate.\n\nThe problem also asks for an interpretation of the limiting behavior as $\\lambda \\to \\infty$. Let's examine the limit of our expression for $\\nu$:\n$$ \\lim_{\\lambda \\to \\infty} \\nu = \\lim_{\\lambda \\to \\infty} \\frac{\\lambda}{1 + \\lambda\\Delta} $$\nTo evaluate this limit, we can divide the numerator and the denominator by $\\lambda$:\n$$ \\lim_{\\lambda \\to \\infty} \\frac{1}{\\frac{1}{\\lambda} + \\Delta} $$\nAs $\\lambda \\to \\infty$, the term $\\frac{1}{\\lambda} \\to 0$. The limit then becomes:\n$$ \\lim_{\\lambda \\to \\infty} \\nu = \\frac{1}{0 + \\Delta} = \\frac{1}{\\Delta} $$\nThis limiting behavior has a clear physical interpretation. As the intrinsic hazard rate $\\lambda$ becomes infinitely large, the waiting time for a spike after the refractory period, $T_{wait}$, approaches zero in expectation ($\\mathbb{E}[T_{wait}] = \\frac{1}{\\lambda} \\to 0$). This means that a new spike is guaranteed to occur almost instantaneously after the refractory period $\\Delta$ concludes. In this limit, the interspike intervals are no longer random but become fixed at the duration of the absolute refractory period, $\\Delta$. The spike train becomes perfectly periodic with period $\\Delta$. The firing rate of such a deterministic, periodic process is simply the reciprocal of its period, which is $\\frac{1}{\\Delta}$. This confirms that the maximum possible firing rate of this neuromorphic spike generator is fundamentally constrained by its refractory mechanism. No matter how strong the input drive (represented by $\\lambda$), the neuron cannot fire faster than $\\frac{1}{\\Delta}$.",
            "answer": "$$\\boxed{\\frac{\\lambda}{1 + \\lambda \\Delta}}$$"
        },
        {
            "introduction": "The ultimate test of any scientific model lies in its ability to explain experimental observations. This computational practice bridges the gap between the theoretical models of refractoriness and real-world neural data analysis . Using a simulated spike train, you will apply the powerful technique of Maximum Likelihood Estimation (MLE) to infer the absolute refractory period, and then use the time-rescaling theorem—a cornerstone of modern point process theory—to rigorously assess the goodness-of-fit of your model.",
            "id": "4053268",
            "problem": "You are given spike trains modeled as a renewal process with an absolute refractory period. The absolute refractory period is the minimal elapsed time after a spike during which the neuron cannot fire. After this dead-time, spikes are assumed to occur with a constant hazard rate, rendering the process memoryless beyond the dead-time. The modeling objective is to estimate the absolute refractory period parameter and validate the model via time-rescaling based goodness-of-fit tests.\n\nFundamental base:\n- A renewal process with absolute dead-time has an inter-spike interval modeled as $s = \\Delta + x$, where $\\Delta$ is the absolute refractory period and $x$ is an exponential random variable with rate $\\lambda$ ($x \\sim \\text{Exp}(\\lambda)$). For a non-adapted neuron, the hazard function is $h(\\tau) = 0$ for $0 \\le \\tau < \\Delta$ and $h(\\tau) = \\lambda$ for $\\tau \\ge \\Delta$.\n- The likelihood of observed inter-spike intervals under a renewal model is the product of the individual densities conditioned on renewal structure.\n- The time-rescaling theorem states that for a point process with conditional hazard $h(\\tau)$, the transformed variables $u_i = \\int_{0}^{s_i} h(\\tau)\\, d\\tau$ are independent and identically distributed exponential random variables with unit mean if the model is correct. Equivalently, the variables $v_i = 1 - e^{-u_i}$ are independent and identically distributed uniform random variables on the interval $(0,1)$.\n\nTask:\n- Given observed inter-spike intervals $\\{s_i\\}_{i=1}^{n}$ for each test case, estimate the absolute refractory period parameter $\\Delta$ and the post-dead-time constant rate $\\lambda$ by maximizing the likelihood of the dead-time renewal model based on the foundational facts above. The estimate of $\\Delta$ must be expressed in seconds and the estimate of $\\lambda$ must be expressed in Hertz. No user input is required; the program must internally generate the spike trains specified below.\n- Using the time-rescaling theorem, compute $u_i = \\int_{0}^{s_i} h(\\tau)\\, d\\tau$ under the fitted model. For the dead-time renewal model, $u_i = \\lambda \\max(s_i - \\Delta, 0)$. Transform to $v_i = 1 - e^{-u_i}$ and perform a Kolmogorov-Smirnov (KS) goodness-of-fit test against the $\\text{Uniform}(0,1)$ distribution. Report the KS test p-value as a float. Decide model adequacy at significance level $\\alpha = 0.05$ (expressed as a decimal), and report a boolean indicating whether the fitted model passes the uniformity test ($\\text{p-value} \\ge \\alpha$).\n- Your program should output, for each test case, the estimated $\\Delta$ in seconds, the estimated $\\lambda$ in Hertz, the KS p-value, and the boolean decision. Aggregate all test cases’ results into a single line containing a comma-separated list enclosed in square brackets. The required final output format is a single flat list in the order: $[\\Delta_{\\text{hat}}^{(1)}, \\lambda_{\\text{hat}}^{(1)}, \\text{p}^{(1)}, \\text{pass}^{(1)}, \\Delta_{\\text{hat}}^{(2)}, \\lambda_{\\text{hat}}^{(2)}, \\text{p}^{(2)}, \\text{pass}^{(2)}, \\dots]$.\n- All angles, if any, are in radians. There are no angles in this specific task.\n\nTest suite:\n- Case $1$ (happy path, moderate rate): Generate $n = 1500$ spikes from the dead-time renewal model with parameters $\\Delta = 0.005$ seconds and $\\lambda = 50$ Hertz. Use random seed $11$.\n- Case $2$ (happy path, lower rate): Generate $n = 2000$ spikes from the dead-time renewal model with parameters $\\Delta = 0.002$ seconds and $\\lambda = 20$ Hertz. Use random seed $222$.\n- Case $3$ (edge case, high rate close to dead-time): Generate $n = 1000$ spikes from the dead-time renewal model with parameters $\\Delta = 0.010$ seconds and $\\lambda = 200$ Hertz. Use random seed $333$.\n- Case $4$ (model mismatch due to spike-frequency adaptation): Generate $n = 2000$ spikes from a slowly adapting dead-time model where each inter-spike interval is $s_i = \\Delta + x_i$ with $\\Delta = 0.005$ seconds and $x_i \\sim \\text{Exp}(\\lambda_i)$, where $\\lambda_i = \\lambda_0 / (1 + \\gamma i)$, $\\lambda_0 = 100$ Hertz, and $\\gamma = 0.005$. Use random seed $444$. This case violates the constant-hazard assumption and should challenge the goodness-of-fit.\n\nAnswer specification:\n- For each test case, compute and report:\n    - Estimated $\\Delta$ in seconds as a float.\n    - Estimated $\\lambda$ in Hertz as a float.\n    - KS test p-value against $\\text{Uniform}(0,1)$ as a float.\n    - Boolean decision at $\\alpha = 0.05$ whether the model passes ($\\text{p-value} \\ge 0.05$).\n- Your program should produce a single line of output containing these results as a comma-separated list enclosed in square brackets, with items appearing in the exact order of the test suite.",
            "solution": "We model neuronal refractoriness and memoryless spiking beyond the dead-time via a renewal process with absolute dead-time $\\Delta$ and constant hazard $\\lambda$ after the dead-time. Each inter-spike interval is $s_i = \\Delta + x_i$, where $x_i \\sim \\text{Exp}(\\lambda)$ are independent and identically distributed exponential random variables. The hazard function is $h(\\tau) = 0$ for $0 \\le \\tau < \\Delta$, and $h(\\tau) = \\lambda$ for $\\tau \\ge \\Delta$. This follows the core definitions of renewal processes and the well-tested memoryless property of the exponential distribution.\n\nLikelihood and maximum likelihood estimation:\n- The probability density function (PDF) for a single inter-spike interval under the dead-time renewal model is $f(s \\mid \\Delta, \\lambda) = \\lambda \\exp(-\\lambda (s - \\Delta))$ for $s \\ge \\Delta$, and $f(s \\mid \\Delta, \\lambda) = 0$ for $s < \\Delta$.\n- Assuming observed inter-spike intervals $\\{s_i\\}_{i=1}^{n}$ are generated by this model, the likelihood is\n$$\nL(\\Delta, \\lambda) = \\prod_{i=1}^{n} \\lambda \\exp(-\\lambda (s_i - \\Delta)) \\cdot \\mathbf{1}\\{s_i \\ge \\Delta\\}.\n$$\n- The log-likelihood is\n$$\n\\ell(\\Delta, \\lambda) = n \\log \\lambda - \\lambda \\sum_{i=1}^{n} (s_i - \\Delta) + \\sum_{i=1}^{n} \\log \\mathbf{1}\\{s_i \\ge \\Delta\\}.\n$$\nSince $\\Delta$ must satisfy $\\Delta \\le \\min_i s_i$ for the likelihood to be nonzero, we restrict to $\\Delta \\in (-\\infty, \\min_i s_i]$. For fixed $\\Delta$, differentiating with respect to $\\lambda$ gives\n$$\n\\frac{\\partial \\ell}{\\partial \\lambda} = \\frac{n}{\\lambda} - \\sum_{i=1}^{n} (s_i - \\Delta),\n$$\nwhich yields the maximizing value\n$$\n\\widehat{\\lambda}(\\Delta) = \\frac{n}{\\sum_{i=1}^{n} (s_i - \\Delta)}.\n$$\nSubstituting $\\widehat{\\lambda}(\\Delta)$ into the log-likelihood gives the profile log-likelihood\n$$\n\\ell(\\Delta, \\widehat{\\lambda}(\\Delta)) = n \\log n - n \\log\\!\\left(\\sum_{i=1}^{n} (s_i - \\Delta)\\right) - n,\n$$\nwhose derivative with respect to $\\Delta$ is\n$$\n\\frac{d}{d\\Delta}\\ell(\\Delta, \\widehat{\\lambda}(\\Delta)) = -n \\cdot \\frac{-n}{\\sum_{i=1}^{n} (s_i - \\Delta)} = \\frac{n^{2}}{\\sum_{i=1}^{n} (s_i - \\Delta)} > 0,\n$$\nfor all $\\Delta < \\min_i s_i$. Therefore, the profile log-likelihood is strictly increasing in $\\Delta$ over the admissible interval, and the maximum is attained at the boundary $\\Delta = \\min_i s_i$. Consequently, the maximum likelihood estimators are\n$$\n\\widehat{\\Delta} = \\min_{i} s_i, \\quad \\widehat{\\lambda} = \\frac{n}{\\sum_{i=1}^{n} (s_i - \\widehat{\\Delta})}.\n$$\n\nGoodness-of-fit via time-rescaling:\n- The time-rescaling theorem states that for a point process with conditional hazard $h(\\tau)$, the transformed variables\n$$\nu_i = \\int_{0}^{s_i} h(\\tau) \\, d\\tau\n$$\nare independent and identically distributed as exponential random variables with mean $1$ if the model is correct. Equivalently,\n$$\nv_i = 1 - e^{-u_i}\n$$\nare independent and identically distributed $\\text{Uniform}(0,1)$ random variables.\n- For the dead-time renewal model with fitted parameters $(\\widehat{\\Delta}, \\widehat{\\lambda})$, the hazard is $h(\\tau) = 0$ for $0 \\le \\tau < \\widehat{\\Delta}$ and $h(\\tau) = \\widehat{\\lambda}$ for $\\tau \\ge \\widehat{\\Delta}$. Thus,\n$$\nu_i = \\int_{0}^{s_i} h(\\tau)\\, d\\tau = \\widehat{\\lambda} \\cdot \\max(s_i - \\widehat{\\Delta}, 0).\n$$\n- We compute $v_i = 1 - e^{-u_i}$ and then perform a Kolmogorov-Smirnov (KS) goodness-of-fit test for $\\text{Uniform}(0,1)$ on the sequence $\\{v_i\\}$. The Kolmogorov-Smirnov (KS) test compares the empirical cumulative distribution function (CDF) to the theoretical CDF and returns a p-value. At significance level $\\alpha = 0.05$ (expressed as a decimal), we accept the model if the p-value is greater than or equal to $\\alpha$.\n\nAlgorithmic design:\n- For each test case, we simulate inter-spike intervals according to the specified generative mechanism:\n    - For non-adaptive cases, we draw $x_i \\sim \\text{Exp}(\\lambda)$ and set $s_i = \\Delta + x_i$.\n    - For the adaptive case, we set $\\lambda_i = \\lambda_0 / (1 + \\gamma i)$ and draw $x_i \\sim \\text{Exp}(\\lambda_i)$, then $s_i = \\Delta + x_i$.\n- We estimate $\\widehat{\\Delta}$ as the minimum observed inter-spike interval and $\\widehat{\\lambda}$ by the formula above.\n- We compute $u_i$ and then $v_i$, perform the KS test against $\\text{Uniform}(0,1)$, and evaluate the pass/fail decision at $\\alpha = 0.05$.\n- We output a single flat list across all test cases in the required format, with each test contributing $\\widehat{\\Delta}$ in seconds, $\\widehat{\\lambda}$ in Hertz, the KS p-value, and the boolean decision.\n\nScientific realism and edge cases:\n- The parameter selections are plausible in the context of neuronal refractoriness, measured in seconds, and rates in Hertz.\n- Case $3$ explores the boundary where many intervals are close to the dead-time. The maximum likelihood estimation remains well-defined for continuous data, and the KS test assesses the uniformity of rescaled intervals.\n- Case $4$ explicitly violates the constant-hazard assumption through spike-frequency adaptation, and the time-rescaling KS test is expected to reflect a poorer fit.\n\nFinal output format:\n- A single line containing a comma-separated list enclosed in square brackets, with items ordered as specified by the test suite. For each test case, the four items are $\\widehat{\\Delta}$ (seconds), $\\widehat{\\lambda}$ (Hertz), p-value (float), and the boolean decision at $\\alpha = 0.05$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import kstest\n\ndef simulate_dead_time_spike_train(delta_s: float, rate_hz: float, n_spikes: int, seed: int):\n    \"\"\"\n    Simulate inter-spike intervals for a dead-time renewal model:\n    s_i = delta + Exp(rate), i = 1..n_spikes\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    # Exponential scale parameter is 1 / rate\n    exp_samples = rng.exponential(scale=1.0 / rate_hz, size=n_spikes)\n    isis = delta_s + exp_samples\n    return isis\n\ndef simulate_adaptive_dead_time(delta_s: float, rate0_hz: float, gamma: float, n_spikes: int, seed: int):\n    \"\"\"\n    Simulate inter-spike intervals for an adapting rate model:\n    s_i = delta + Exp(rate_i), where rate_i = rate0 / (1 + gamma * i), i starting from 1.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    isis = np.empty(n_spikes, dtype=float)\n    for i in range(n_spikes):\n        rate_i = rate0_hz / (1.0 + gamma * (i + 1))\n        # Ensure rate_i stays positive\n        if rate_i <= 0:\n            rate_i = 1e-12\n        isis[i] = delta_s + rng.exponential(scale=1.0 / rate_i)\n    return isis\n\ndef mle_dead_time_shifted_exponential(isis: np.ndarray):\n    \"\"\"\n    Maximum likelihood estimates for shifted exponential:\n    delta_hat = min(isis)\n    lambda_hat = n / sum(isis - delta_hat)\n    \"\"\"\n    n = isis.size\n    delta_hat = float(np.min(isis))\n    denom = float(np.sum(isis - delta_hat))\n    # Handle degenerate case where denom <= 0\n    if denom <= 0.0:\n        # This is extremely unlikely for continuous data unless all ISIs equal delta_hat.\n        # Assign a very large rate to avoid division by zero; the KS test will likely fail.\n        lambda_hat = float('inf')\n    else:\n        lambda_hat = n / denom\n    return delta_hat, lambda_hat\n\ndef time_rescaling_uniform_pvalue(isis: np.ndarray, delta_hat: float, lambda_hat: float):\n    \"\"\"\n    Compute time-rescaled variables and KS test p-value against Uniform(0,1).\n    u_i = lambda_hat * max(isis[i] - delta_hat, 0)\n    v_i = 1 - exp(-u_i)\n    \"\"\"\n    # If lambda_hat is infinite or extremely large, handle numerically\n    if not np.isfinite(lambda_hat):\n        # With infinite rate, u_i for any positive residual blows up; v_i -> 1\n        # Construct v_i as nearly one where residual positive, zero where residual zero\n        residuals = isis - delta_hat\n        v = np.where(residuals > 0, 1.0, 0.0)\n    else:\n        u = lambda_hat * np.maximum(isis - delta_hat, 0.0)\n        # Numerical stability: cap u to avoid exp(-u) underflow to exactly zero\n        u = np.clip(u, 0.0, 1e6)\n        v = 1.0 - np.exp(-u)\n    # KS test against Uniform(0,1)\n    stat, pval = kstest(v, 'uniform')\n    return pval\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (case_type, parameters_dict)\n        (\"dead_time\", {\"delta_s\": 0.005, \"rate_hz\": 50.0, \"n_spikes\": 1500, \"seed\": 11}),\n        (\"dead_time\", {\"delta_s\": 0.002, \"rate_hz\": 20.0, \"n_spikes\": 2000, \"seed\": 222}),\n        (\"dead_time\", {\"delta_s\": 0.010, \"rate_hz\": 200.0, \"n_spikes\": 1000, \"seed\": 333}),\n        (\"adaptive\",  {\"delta_s\": 0.005, \"rate0_hz\": 100.0, \"gamma\": 0.005, \"n_spikes\": 2000, \"seed\": 444}),\n    ]\n\n    alpha = 0.05  # significance level (decimal)\n\n    results = []\n    for case_type, params in test_cases:\n        if case_type == \"dead_time\":\n            isis = simulate_dead_time_spike_train(\n                delta_s=params[\"delta_s\"],\n                rate_hz=params[\"rate_hz\"],\n                n_spikes=params[\"n_spikes\"],\n                seed=params[\"seed\"]\n            )\n        elif case_type == \"adaptive\":\n            isis = simulate_adaptive_dead_time(\n                delta_s=params[\"delta_s\"],\n                rate0_hz=params[\"rate0_hz\"],\n                gamma=params[\"gamma\"],\n                n_spikes=params[\"n_spikes\"],\n                seed=params[\"seed\"]\n            )\n        else:\n            # Should not happen\n            isis = np.array([], dtype=float)\n\n        # Maximum likelihood estimation\n        delta_hat, lambda_hat = mle_dead_time_shifted_exponential(isis)\n\n        # Time-rescaling KS test p-value\n        pval = time_rescaling_uniform_pvalue(isis, delta_hat, lambda_hat)\n\n        # Decision at alpha\n        decision = bool(pval >= alpha)\n\n        # Append results: delta_hat (s), lambda_hat (Hz), p-value (float), decision (bool)\n        results.append(delta_hat)\n        results.append(lambda_hat)\n        results.append(pval)\n        results.append(decision)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}