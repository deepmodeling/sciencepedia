{
    "hands_on_practices": [
        {
            "introduction": "Understanding synaptic integration begins with modeling how a single synaptic current input generates a postsynaptic potential (PSP). This fundamental practice models the neuron's membrane as a passive resistor-capacitor (RC) circuit and challenges you to derive the voltage response from first principles . By solving the governing differential equation, you will gain a deep appreciation for how the interplay between the membrane time constant and the synaptic current's time course shapes the amplitude and duration of the PSP, a cornerstone of temporal summation.",
            "id": "4039276",
            "problem": "In a neuromorphic, brain-inspired point-neuron model, assume the somatic membrane is an isopotential, passive, linear resistor-capacitor element obeying Kirchhoff’s current law and standard linear circuit theory. A chemical synapse delivers a postsynaptic current described by the causal exponential waveform $I(t) = I_{0}\\exp(-t/\\tau)$ for $t \\ge 0$, with $I_{0} = 100\\,\\mathrm{pA}$ and $\\tau = 5\\,\\mathrm{ms}$. The neuron’s input resistance is $R_{\\mathrm{in}} = 100\\,\\mathrm{M}\\Omega$, and its membrane capacitance is $C_{m} = 200\\,\\mathrm{pF}$. The initial membrane potential deviation is zero at $t=0^{-}$.\n\nStarting from the fundamental linear resistor-capacitor membrane dynamics and without invoking any shortcut formulas, derive the time course of the postsynaptic potential change $\\Delta V(t)$ at the soma in response to this synaptic current. Then determine the peak amplitude $\\Delta V_{\\mathrm{peak}}$ of $\\Delta V(t)$. Briefly explain, in terms of the membrane and synaptic time constants, which time constant dominates the late-time decay of $\\Delta V(t)$.\n\nExpress the final numerical value of the peak amplitude $\\Delta V_{\\mathrm{peak}}$ in $\\mathrm{mV}$ and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in standard linear circuit theory applied to a simplified neuronal model, is well-posed with sufficient information for a unique solution, and is stated in objective, formal language.\n\nThe somatic membrane is modeled as a parallel resistor-capacitor (RC) circuit. According to Kirchhoff’s current law, the total synaptic current $I(t)$ flowing into the neuron must equal the sum of the current flowing through the membrane resistance, $I_{R}(t)$, and the current flowing through the membrane capacitance, $I_{C}(t)$.\n$$I(t) = I_{R}(t) + I_{C}(t)$$\nLet $\\Delta V(t)$ be the deviation of the membrane potential from its resting value. The currents through the resistor and capacitor are given by Ohm's law and the definition of capacitance, respectively:\n$$I_{R}(t) = \\frac{\\Delta V(t)}{R_{\\mathrm{in}}}$$\n$$I_{C}(t) = C_{m} \\frac{d(\\Delta V(t))}{dt}$$\nThe input synaptic current is given as $I(t) = I_{0}\\exp(-t/\\tau)$ for $t \\ge 0$. Substituting these expressions into Kirchhoff's law gives the governing first-order linear ordinary differential equation (ODE) for the postsynaptic potential change $\\Delta V(t)$:\n$$I_{0}\\exp(-t/\\tau) = \\frac{\\Delta V(t)}{R_{\\mathrm{in}}} + C_{m} \\frac{d(\\Delta V(t))}{dt}$$\nWe can rearrange this equation into the standard form:\n$$\\frac{d(\\Delta V)}{dt} + \\frac{1}{R_{\\mathrm{in}}C_{m}}\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(-t/\\tau)$$\nLet us define the membrane time constant $\\tau_{m} = R_{\\mathrm{in}}C_{m}$. First, we calculate its value:\n$$\\tau_{m} = (100 \\times 10^{6}\\,\\Omega) \\times (200 \\times 10^{-12}\\,\\mathrm{F}) = 20000 \\times 10^{-6}\\,\\mathrm{s} = 20 \\times 10^{-3}\\,\\mathrm{s} = 20\\,\\mathrm{ms}$$\nThe synaptic time constant is given as $\\tau = 5\\,\\mathrm{ms}$. Since $\\tau_{m} \\neq \\tau$, the ODE is:\n$$\\frac{d(\\Delta V)}{dt} + \\frac{1}{\\tau_{m}}\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(-t/\\tau)$$\nThis ODE can be solved using the method of integrating factors. The integrating factor $\\mu(t)$ is:\n$$\\mu(t) = \\exp\\left(\\int \\frac{1}{\\tau_{m}} dt\\right) = \\exp(t/\\tau_{m})$$\nMultiplying the ODE by $\\mu(t)$:\n$$\\exp(t/\\tau_{m})\\frac{d(\\Delta V)}{dt} + \\frac{1}{\\tau_{m}}\\exp(t/\\tau_{m})\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(t/\\tau_{m})\\exp(-t/\\tau)$$\nThe left side is the derivative of the product $\\Delta V(t)\\mu(t)$:\n$$\\frac{d}{dt}\\left(\\Delta V(t)\\exp(t/\\tau_{m})\\right) = \\frac{I_{0}}{C_{m}}\\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right)$$\nIntegrating both sides with respect to $t$:\n$$\\Delta V(t)\\exp(t/\\tau_{m}) = \\int \\frac{I_{0}}{C_{m}}\\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right) dt$$\n$$\\Delta V(t)\\exp(t/\\tau_{m}) = \\frac{I_{0}}{C_{m}} \\frac{1}{\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}} \\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right) + K$$\nwhere $K$ is the constant of integration. Simplifying the coefficient:\n$$\\frac{1}{\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}} = \\frac{1}{\\frac{\\tau - \\tau_{m}}{\\tau_{m}\\tau}} = \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}}$$\nSubstituting this back and isolating $\\Delta V(t)$:\n$$\\Delta V(t) = \\frac{I_{0}}{C_{m}} \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m})$$\nUsing $C_{m} = \\tau_{m}/R_{\\mathrm{in}}$, we get:\n$$\\Delta V(t) = \\frac{I_{0}}{(\\tau_{m}/R_{\\mathrm{in}})} \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m}) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m})$$\nThe initial condition is $\\Delta V(t=0^{-})=0$, which implies $\\Delta V(t=0)=0$. Applying this condition:\n$$0 = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(0) + K\\exp(0) \\implies K = -\\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}$$\nSubstituting $K$ back into the solution for $\\Delta V(t)$:\n$$\\Delta V(t) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}\\exp(-t/\\tau) - \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}\\exp(-t/\\tau_{m})$$\n$$\\Delta V(t) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(\\exp(-t/\\tau) - \\exp(-t/\\tau_{m})\\right)$$\nTo find the peak amplitude $\\Delta V_{\\mathrm{peak}}$, we must find the time $t_{\\mathrm{peak}}$ at which the potential is maximum. This occurs when the derivative of $\\Delta V(t)$ with respect to $t$ is zero:\n$$\\frac{d(\\Delta V)}{dt} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(-\\frac{1}{\\tau}\\exp(-t/\\tau) + \\frac{1}{\\tau_{m}}\\exp(-t/\\tau_{m})\\right) = 0$$\nThis requires the term in the parentheses to be zero:\n$$\\frac{1}{\\tau_{m}}\\exp(-t_{\\mathrm{peak}}/\\tau_{m}) = \\frac{1}{\\tau}\\exp(-t_{\\mathrm{peak}}/\\tau)$$\n$$\\frac{\\exp(-t_{\\mathrm{peak}}/\\tau_{m})}{\\exp(-t_{\\mathrm{peak}}/\\tau)} = \\frac{\\tau_{m}}{\\tau} \\implies \\exp\\left(t_{\\mathrm{peak}}\\left(\\frac{1}{\\tau} - \\frac{1}{\\tau_{m}}\\right)\\right) = \\frac{\\tau_{m}}{\\tau}$$\nTaking the natural logarithm of both sides and solving for $t_{\\mathrm{peak}}$:\n$$t_{\\mathrm{peak}}\\left(\\frac{\\tau_{m} - \\tau}{\\tau\\tau_{m}}\\right) = \\ln\\left(\\frac{\\tau_{m}}{\\tau}\\right) \\implies t_{\\mathrm{peak}} = \\frac{\\tau\\tau_{m}}{\\tau_{m} - \\tau}\\ln\\left(\\frac{\\tau_{m}}{\\tau}\\right)$$\nNow we substitute $t_{\\mathrm{peak}}$ into the expression for $\\Delta V(t)$ to find $\\Delta V_{\\mathrm{peak}}$. We use the relation $\\exp(-t_{\\mathrm{peak}}/\\tau) = \\frac{\\tau}{\\tau_m}\\exp(-t_{\\mathrm{peak}}/\\tau_m)$ derived from setting the derivative to zero.\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(\\exp(-t_{\\mathrm{peak}}/\\tau) - \\exp(-t_{\\mathrm{peak}}/\\tau_{m})\\right) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(\\frac{\\tau}{\\tau_m}\\exp(-t_{\\mathrm{peak}}/\\tau_m) - \\exp(-t_{\\mathrm{peak}}/\\tau_m)\\right)$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(-t_{\\mathrm{peak}}/\\tau_m) \\left(\\frac{\\tau}{\\tau_m} - 1\\right) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(-t_{\\mathrm{peak}}/\\tau_m) \\left(\\frac{\\tau - \\tau_{m}}{\\tau_m}\\right)$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_{m}}\\exp(-t_{\\mathrm{peak}}/\\tau_{m})$$\nFrom the expression for $t_{\\mathrm{peak}}$, we have:\n$$-\\frac{t_{\\mathrm{peak}}}{\\tau_{m}} = -\\frac{\\tau}{\\tau_m - \\tau}\\ln\\left(\\frac{\\tau_m}{\\tau}\\right) = \\ln\\left[\\left(\\frac{\\tau_m}{\\tau}\\right)^{-\\frac{\\tau}{\\tau_m-\\tau}}\\right]$$\nSo, $\\exp(-t_{\\mathrm{peak}}/\\tau_{m}) = \\left(\\frac{\\tau_m}{\\tau}\\right)^{-\\frac{\\tau}{\\tau_m-\\tau}}$.\nSubstituting values: $\\tau_{m}=20\\,\\mathrm{ms}$, $\\tau=5\\,\\mathrm{ms}$, $I_{0}=100\\,\\mathrm{pA}$, $R_{\\mathrm{in}}=100\\,\\mathrm{M}\\Omega$.\nThe pre-factor $I_{0}R_{\\mathrm{in}} = (100 \\times 10^{-12}\\,\\mathrm{A})(100 \\times 10^{6}\\,\\Omega) = 10^{-2}\\,\\mathrm{V} = 10\\,\\mathrm{mV}$.\n$$\\Delta V_{\\mathrm{peak}} = \\frac{(10\\,\\mathrm{mV})(5\\,\\mathrm{ms})}{20\\,\\mathrm{ms}} \\left(\\frac{20\\,\\mathrm{ms}}{5\\,\\mathrm{ms}}\\right)^{-\\frac{5\\,\\mathrm{ms}}{20\\,\\mathrm{ms}-5\\,\\mathrm{ms}}}$$\n$$\\Delta V_{\\mathrm{peak}} = 2.5\\,\\mathrm{mV} \\times (4)^{-5/15} = 2.5\\,\\mathrm{mV} \\times (4)^{-1/3}$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{2.5}{4^{1/3}}\\,\\mathrm{mV} \\approx \\frac{2.5}{1.587401}\\,\\mathrm{mV} \\approx 1.574902\\,\\mathrm{mV}$$\nRounding to four significant figures, we get $\\Delta V_{\\mathrm{peak}} = 1.575\\,\\mathrm{mV}$.\n\nFor the late-time decay, we examine the solution $\\Delta V(t) \\propto (\\exp(-t/\\tau) - \\exp(-t/\\tau_{m}))$. The decay is governed by the two time constants $\\tau_{m} = 20\\,\\mathrm{ms}$ and $\\tau = 5\\,\\mathrm{ms}$. The term with the larger time constant decays more slowly. Since $\\tau_{m} > \\tau$, the term $\\exp(-t/\\tau_{m})$ decays more slowly than $\\exp(-t/\\tau)$. For large $t$ (i.e., $t \\gg \\tau$), the term $\\exp(-t/\\tau)$ becomes negligible much faster than $\\exp(-t/\\tau_{m})$. Therefore, the late-time decay of $\\Delta V(t)$ is dominated by the membrane time constant, $\\tau_{m}$. This physically means that after the relatively fast synaptic current has finished, the membrane potential decays back to rest by discharging the membrane capacitor through the membrane resistance, a process governed by $\\tau_m$.",
            "answer": "$$\\boxed{1.575}$$"
        },
        {
            "introduction": "While chemical synapses provide directed communication, electrical synapses, or gap junctions, create direct and often bidirectional electrical pathways between neurons. This exercise guides you through modeling a pair of neurons coupled by a gap junction, using fundamental circuit laws to derive the system's coupled dynamics . Analyzing the system's eigenmodes reveals how electrical coupling gives rise to distinct synchronous and asynchronous patterns of activity, providing a foundation for understanding network-level synchronization.",
            "id": "4039228",
            "problem": "Consider two isopotential neuron somata coupled by an electrical synapse (gap junction) and receiving externally injected currents. Model each soma as a Resistive-Capacitive (RC) membrane with membrane capacitance $C_{i}$, passive leak conductance $g_{L,i}$, and leak reversal potential $E_{L,i}$, for $i \\in \\{1,2\\}$. The gap junction is modeled as a purely ohmic conductance $g_{gj}$ connecting the two somata. The injected currents are $I_{1}(t)$ and $I_{2}(t)$, defined as currents entering the cells. Assume all parameters are constant in time and the somata are the only compartments.\n\nUse Kirchhoff’s Current Law (KCL) and Ohm’s law to:\n\n- Construct the equivalent circuit at the level of membrane currents and write down the coupled ordinary differential equations (ODEs) governing the membrane potentials $V_{1}(t)$ and $V_{2}(t)$ from first principles, accounting explicitly for the capacitive, leak, and gap-junction currents with correct signs.\n- Express the resulting system in the form $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$ where $\\mathbf{V} = \\begin{pmatrix} V_{1} \\\\ V_{2} \\end{pmatrix}$, and identify the system matrix $\\mathbf{A}$ and the affine term $\\mathbf{b}$ in terms of $C_{i}$, $g_{L,i}$, $E_{L,i}$, $g_{gj}$, and $I_{i}(t)$.\n- Specialize to the autonomous case with constant inputs $I_{1}(t) \\equiv I_{1,0}$ and $I_{2}(t) \\equiv I_{2,0}$. For the homogeneous dynamics of deviations from equilibrium, determine the eigenmodes and eigenvalues of the linear system in the identical-neuron case: $C_{1} = C_{2} = C$, $g_{L,1} = g_{L,2} = g_{L}$, $E_{L,1} = E_{L,2} = E_{L}$, and $I_{1,0} = I_{2,0} = I_{0}$.\n\nAnswer specification:\n- Provide a single closed-form analytic expression for the characteristic time constant of the antisymmetric (difference) mode of the homogeneous dynamics in the identical-neuron case, as a function of $C$, $g_{L}$, and $g_{gj}$.\n- Do not include units in your final boxed expression. No numerical evaluation or rounding is required.",
            "solution": "The problem is assessed as valid. It is scientifically grounded in the principles of electrical circuit theory (Kirchhoff's and Ohm's laws) applied to a standard biophysical model of neurons (the passive RC membrane). The problem is well-posed, with all necessary parameters and conditions defined, allowing for the derivation of a unique mathematical solution. The language is objective and precise.\n\nThe first step is to construct the equivalent circuit and derive the governing differential equations using Kirchhoff's Current Law (KCL). KCL states that for any node in an electrical circuit, the algebraic sum of currents entering the node is zero. By convention, we consider currents leaving a soma to be positive.\n\nFor soma $1$, with membrane potential $V_{1}(t)$, the currents are:\n1.  Capacitive current, $I_{C,1} = C_{1} \\frac{dV_{1}}{dt}$. This is the current charging the membrane capacitor.\n2.  Leak current, $I_{L,1} = g_{L,1}(V_{1} - E_{L,1})$. This is the ionic current flowing out of the cell through passive leak channels, driven by the difference between the membrane potential and the leak reversal potential.\n3.  Gap-junction current, $I_{gj,1 \\to 2} = g_{gj}(V_{1} - V_{2})$. This is the current flowing from soma $1$ to soma $2$ through the gap junction.\n4.  External injected current, $I_{1}(t)$. This is defined as a current entering the cell, so it is an inward current.\n\nApplying KCL to soma $1$ (sum of outward currents equals sum of inward currents):\n$$C_{1} \\frac{dV_{1}}{dt} + g_{L,1}(V_{1} - E_{L,1}) + g_{gj}(V_{1} - V_{2}) = I_{1}(t)$$\nRearranging this equation:\n$$C_{1} \\frac{dV_{1}}{dt} = -(g_{L,1} + g_{gj})V_{1} + g_{gj}V_{2} + g_{L,1}E_{L,1} + I_{1}(t)$$\n\nSimilarly, for soma $2$, with membrane potential $V_{2}(t)$, the currents are:\n1.  Capacitive current, $I_{C,2} = C_{2} \\frac{dV_{2}}{dt}$.\n2.  Leak current, $I_{L,2} = g_{L,2}(V_{2} - E_{L,2})$.\n3.  Gap-junction current, $I_{gj,2 \\to 1} = g_{gj}(V_{2} - V_{1})$. This is the current flowing from soma $2$ to soma $1$.\n4.  External injected current, $I_{2}(t)$.\n\nApplying KCL to soma $2$:\n$$C_{2} \\frac{dV_{2}}{dt} + g_{L,2}(V_{2} - E_{L,2}) + g_{gj}(V_{2} - V_{1}) = I_{2}(t)$$\nRearranging this equation:\n$$C_{2} \\frac{dV_{2}}{dt} = g_{gj}V_{1} - (g_{L,2} + g_{gj})V_{2} + g_{L,2}E_{L,2} + I_{2}(t)$$\n\nThe second task is to express this system in the form $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$. We isolate the derivatives $\\frac{dV_{1}}{dt}$ and $\\frac{dV_{2}}{dt}$:\n$$\\frac{dV_{1}}{dt} = -\\frac{g_{L,1} + g_{gj}}{C_{1}}V_{1} + \\frac{g_{gj}}{C_{1}}V_{2} + \\frac{g_{L,1}E_{L,1} + I_{1}(t)}{C_{1}}$$\n$$\\frac{dV_{2}}{dt} = \\frac{g_{gj}}{C_{2}}V_{1} - \\frac{g_{L,2} + g_{gj}}{C_{2}}V_{2} + \\frac{g_{L,2}E_{L,2} + I_{2}(t)}{C_{2}}$$\nIn matrix form, with $\\mathbf{V} = \\begin{pmatrix} V_{1} \\\\ V_{2} \\end{pmatrix}$, this is $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$, where the system matrix $\\mathbf{A}$ and the affine term $\\mathbf{b}$ are:\n$$\\mathbf{A} = \\begin{pmatrix} -\\frac{g_{L,1} + g_{gj}}{C_{1}} & \\frac{g_{gj}}{C_{1}} \\\\ \\frac{g_{gj}}{C_{2}} & -\\frac{g_{L,2} + g_{gj}}{C_{2}} \\end{pmatrix}$$\n$$\\mathbf{b} = \\begin{pmatrix} \\frac{g_{L,1}E_{L,1} + I_{1}(t)}{C_{1}} \\\\ \\frac{g_{L,2}E_{L,2} + I_{2}(t)}{C_{2}} \\end{pmatrix}$$\n\nThe third task is to analyze the autonomous, identical-neuron case. The conditions are: $I_{1}(t) \\equiv I_{1,0}$, $I_{2}(t) \\equiv I_{2,0}$, $C_{1} = C_{2} = C$, $g_{L,1} = g_{L,2} = g_{L}$, $E_{L,1} = E_{L,2} = E_{L}$, and $I_{1,0} = I_{2,0} = I_{0}$.\nUnder these conditions, the system matrix $\\mathbf{A}$ simplifies to:\n$$\\mathbf{A}_{\\text{symm}} = \\begin{pmatrix} -\\frac{g_{L} + g_{gj}}{C} & \\frac{g_{gj}}{C} \\\\ \\frac{g_{gj}}{C} & -\\frac{g_{L} + g_{gj}}{C} \\end{pmatrix} = \\frac{1}{C}\\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix}$$\nThe dynamics of deviations $\\mathbf{v}(t) = \\mathbf{V}(t) - \\mathbf{V}_{\\text{eq}}$ from the equilibrium state $\\mathbf{V}_{\\text{eq}}$ are governed by the homogeneous linear system $\\dot{\\mathbf{v}} = \\mathbf{A}_{\\text{symm}}\\mathbf{v}$. The solutions to this system are determined by the eigenvalues and eigenvectors (eigenmodes) of $\\mathbf{A}_{\\text{symm}}$.\n\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(\\mathbf{A}_{\\text{symm}} - \\lambda \\mathbf{I}) = 0$. It is simpler to find the eigenvalues $\\mu$ of the matrix $C \\mathbf{A}_{\\text{symm}}$ first, where $\\lambda = \\mu/C$.\n$$\\det \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - \\begin{pmatrix} \\mu & 0 \\\\ 0 & \\mu \\end{pmatrix} \\right) = 0$$\n$$\\begin{vmatrix} -(g_{L} + g_{gj}) - \\mu & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) - \\mu \\end{vmatrix} = 0$$\n$$(-(g_{L} + g_{gj}) - \\mu)^{2} - g_{gj}^{2} = 0$$\n$$(g_{L} + g_{gj} + \\mu)^{2} = g_{gj}^{2}$$\nTaking the square root of both sides gives two possibilities:\n1. $g_{L} + g_{gj} + \\mu_{1} = g_{gj} \\implies \\mu_{1} = -g_{L}$\n2. $g_{L} + g_{gj} + \\mu_{2} = -g_{gj} \\implies \\mu_{2} = -(g_{L} + 2g_{gj})$\n\nThe corresponding eigenvalues of $\\mathbf{A}_{\\text{symm}}$ are $\\lambda_{1} = \\frac{\\mu_{1}}{C} = -\\frac{g_{L}}{C}$ and $\\lambda_{2} = \\frac{\\mu_{2}}{C} = -\\frac{g_{L} + 2g_{gj}}{C}$.\n\nNow we find the eigenvectors.\nFor $\\lambda_{1} = -g_{L}/C$ (i.e., $\\mu_{1} = -g_L$):\n$$ \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - (-g_{L}) \\mathbf{I} \\right) \\mathbf{u}_{1} = \\begin{pmatrix} -g_{gj} & g_{gj} \\\\ g_{gj} & -g_{gj} \\end{pmatrix} \\begin{pmatrix} u_{11} \\\\ u_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThis implies $-g_{gj} u_{11} + g_{gj} u_{12} = 0$, so $u_{11} = u_{12}$. The eigenvector is any multiple of $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. This is the symmetric or common mode, where $V_{1}$ and $V_{2}$ change in unison.\n\nFor $\\lambda_{2} = -(g_{L} + 2g_{gj})/C$ (i.e., $\\mu_{2} = -(g_L + 2g_{gj})$):\n$$ \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - (-(g_{L} + 2g_{gj})) \\mathbf{I} \\right) \\mathbf{u}_{2} = \\begin{pmatrix} g_{gj} & g_{gj} \\\\ g_{gj} & g_{gj} \\end{pmatrix} \\begin{pmatrix} u_{21} \\\\ u_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThis implies $g_{gj} u_{21} + g_{gj} u_{22} = 0$, so $u_{21} = -u_{22}$. The eigenvector is any multiple of $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$. This is the antisymmetric or difference mode, where $V_{1}$ and $V_{2}$ change in opposition.\n\nThe final step is to determine the characteristic time constant, $\\tau$, for the antisymmetric mode. The dynamics of each eigenmode evolve as $\\exp(\\lambda t) = \\exp(-t/\\tau)$. The time constant is thus given by $\\tau = -1/\\lambda$. For the antisymmetric mode, the eigenvalue is $\\lambda_{2}$:\n$$\\tau_{\\text{anti}} = -\\frac{1}{\\lambda_{2}} = -\\frac{1}{-\\frac{g_{L} + 2g_{gj}}{C}} = \\frac{C}{g_{L} + 2g_{gj}}$$\n\nThis expression shows that the decay of the voltage difference is faster (smaller time constant) than the decay of an isolated neuron ($\\tau = C/g_{L}$) because the gap junction provides an additional pathway for current to flow and equilibrate potential differences. Specifically, the effective conductance for the difference mode is $g_{L} + 2g_{gj}$.",
            "answer": "$$\\boxed{\\frac{C}{g_{L} + 2g_{gj}}}$$"
        },
        {
            "introduction": "Real chemical synapses are not static; their efficacy changes dynamically based on recent presynaptic activity, a phenomenon known as short-term plasticity (STP). This advanced practice introduces the canonical Tsodyks-Markram model to capture the interplay between synaptic facilitation and depression . By deriving the steady-state synaptic efficacy for a periodic spike train, you will discover how STP endows synapses with frequency-dependent filtering capabilities, a crucial computational element in brain-inspired systems.",
            "id": "4039233",
            "problem": "Consider a periodically stimulated chemical synapse modeled by Short-Term Plasticity (STP) using the Tsodyks–Markram formalism. Let the synapse have two state variables: the utilization of synaptic efficacy $u(t)$ and the fraction of available synaptic resources $x(t)$. Between presynaptic spikes, the state variables recover exponentially according to the well-tested continuous-time equations\n$$\\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}}, \\quad \\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}},$$\nwhere $U$ is the baseline utilization, $\\tau_{fac}$ is the facilitation time constant, and $\\tau_{rec}$ is the recovery (depression) time constant. At each presynaptic spike time $t_n$, facilitation and depression occur instantaneously in the following order: first,\n$$u(t_n^+) = u(t_n^-) + U\\left(1 - u(t_n^-)\\right),$$\nthen\n$$x(t_n^+) = x(t_n^-)\\left(1 - u(t_n^+)\\right).$$\nThe efficacy (released fraction per spike) is defined as\n$$y_n = u(t_n^+) \\, x(t_n^-).$$\nAssume a strictly periodic spike train with frequency $f$ and interspike interval $\\Delta t = 1/f$ (in seconds). Under such periodic stimulation, the system converges to a steady state in which the pre-spike values $u(t_n^-)$ and $x(t_n^-)$ are constant across spikes. Starting from the above definitions and laws, derive the steady-state efficacy $y_{ss}(f)$ as a function of $f$ and the synaptic parameters, by analyzing the spike-to-spike map induced by exponential recovery between spikes and the instantaneous updates at spikes. You must express $y_{ss}(f)$ in terms of $U$, $\\tau_{fac}$, $\\tau_{rec}$, and $f$ only, and compute it numerically for the test suite below.\n\nImportant constraints and instructions:\n- All time constants $\\tau_{rec}$ and $\\tau_{fac}$ are provided in milliseconds and must be converted to seconds before use.\n- The spike frequency $f$ is in Hertz, so the interspike interval is $\\Delta t = 1/f$ in seconds.\n- The final outputs are dimensionless synaptic efficacies per spike. Express each as a decimal number rounded to six digits after the decimal point. No units must be printed.\n- Although electrical synapses (gap junctions) are part of the broader context, this problem concerns chemical synapses modeled by Short-Term Plasticity. Electrical synapses do not exhibit vesicle depletion or facilitation and are not part of the computations requested here.\n\nTest suite:\n1. Baseline case: $U = 0.2$, $\\tau_{rec} = 800\\,\\mathrm{ms}$, $\\tau_{fac} = 300\\,\\mathrm{ms}$, $f = 20\\,\\mathrm{Hz}$.\n2. Low frequency: same $U$, $\\tau_{rec}$, $\\tau_{fac}$ as in test $1$, but $f = 0.1\\,\\mathrm{Hz}$.\n3. High frequency: same $U$, $\\tau_{rec}$, $\\tau_{fac}$ as in test $1$, but $f = 200\\,\\mathrm{Hz}$.\n4. Facilitating regime: $U = 0.05$, $\\tau_{rec} = 2000\\,\\mathrm{ms}$, $\\tau_{fac} = 1000\\,\\mathrm{ms}$, $f = 20\\,\\mathrm{Hz}$.\n5. Depressing regime: $U = 0.5$, $\\tau_{rec} = 100\\,\\mathrm{ms}$, $\\tau_{fac} = 50\\,\\mathrm{ms}$, $f = 20\\,\\mathrm{Hz}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each \"result\" corresponds to $y_{ss}(f)$ for the respective test case, rounded to six digits after the decimal point.",
            "solution": "The problem requires the derivation of the steady-state synaptic efficacy, $y_{ss}(f)$, for a chemical synapse described by the Tsodyks-Markram model of short-term plasticity (STP), under periodic stimulation with frequency $f$. The derivation involves finding the fixed point of the spike-to-spike dynamics of the state variables $u(t)$ and $x(t)$.\n\nThe state variables are the utilization of synaptic efficacy, $u(t)$, and the fraction of available synaptic resources, $x(t)$. Their dynamics are governed by two processes: exponential recovery between spikes and instantaneous updates at the time of each spike.\n\nFirst, we analyze the recovery phase between two consecutive spikes, occurring at times $t_n$ and $t_{n+1}$. The interspike interval is $\\Delta t = t_{n+1} - t_n = 1/f$. The recovery dynamics are given by the first-order linear ordinary differential equations:\n$$ \\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}} $$\n$$ \\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}} $$\nwhere $U$ is the baseline utilization, $\\tau_{fac}$ is the facilitation time constant, and $\\tau_{rec}$ is the recovery (depression) time constant.\n\nLet's denote the values of the variables just before a spike at $t_n$ as $u(t_n^-)$ and $x(t_n^-)$, and just after the spike as $u(t_n^+)$ and $x(t_n^+)$. Integrating the differential equations over the interspike interval from $t_n^+$ to $t_{n+1}^-$, we obtain the values just before the next spike:\n$$ u(t_{n+1}^-) = U + (u(t_n^+) - U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n$$ x(t_{n+1}^-) = 1 + (x(t_n^+) - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\n\nNext, we incorporate the instantaneous updates that occur at each spike time $t_n$. The rules are applied sequentially:\n1. Facilitation of $u$:\n$$ u(t_n^+) = u(t_n^-) + U(1 - u(t_n^-)) = U + u(t_n^-)(1-U) $$\n2. Depression of $x$:\n$$ x(t_n^+) = x(t_n^-)(1 - u(t_n^+)) $$\n\nNow we can construct the full spike-to-spike map, which describes how the pre-spike values $(u(t_n^-), x(t_n^-))$ evolve to the next pre-spike values $(u(t_{n+1}^-), x(t_{n+1}^-))$. For simplicity in notation, let $u_n^- = u(t_n^-)$, $u_n^+ = u(t_n^+)$, $x_n^- = x(t_n^-)$, and $x_n^+ = x(t_n^+)$.\n\nThe dynamics of $u$ are independent of $x$. We can create a map for $u_{n+1}^-$ in terms of $u_n^-$:\n$$ u_{n+1}^- = U + (u_n^+ - U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\nSubstitute the expression for $u_n^+$:\n$$ u_{n+1}^- = U + \\left( (U + u_n^-(1-U)) - U \\right) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n$$ u_{n+1}^- = U + u_n^-(1-U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n\nAt steady state, the system reaches a fixed point where the pre-spike values are constant, i.e., $u_{n+1}^- = u_n^- = u_{ss}^-$. Let $E_{fac} = \\exp(-\\Delta t / \\tau_{fac})$. The steady-state equation for $u_{ss}^-$ is:\n$$ u_{ss}^- = U + u_{ss}^-(1-U)E_{fac} $$\nSolving for $u_{ss}^-$:\n$$ u_{ss}^- \\left(1 - (1-U)E_{fac}\\right) = U $$\n$$ u_{ss}^- = \\frac{U}{1 - (1-U)E_{fac}} $$\n\nWith the steady-state pre-spike value $u_{ss}^-$, we can find the steady-state post-spike value $u_{ss}^+$:\n$$ u_{ss}^+ = U + u_{ss}^-(1-U) $$\n\nNow we derive the steady-state value for $x$. The map for $x_n^-$ is:\n$$ x_{n+1}^- = 1 + (x_n^+ - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\nSubstitute the expression for $x_n^+$:\n$$ x_{n+1}^- = 1 + (x_n^-(1 - u_n^+) - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\nAt steady state, $x_{n+1}^- = x_n^- = x_{ss}^-$ and $u_n^+ = u_{ss}^+$. Let $E_{rec} = \\exp(-\\Delta t / \\tau_{rec})$. The fixed-point equation is:\n$$ x_{ss}^- = 1 + (x_{ss}^-(1 - u_{ss}^+) - 1)E_{rec} $$\nSolving for $x_{ss}^-$:\n$$ x_{ss}^- = 1 - E_{rec} + x_{ss}^-(1 - u_{ss}^+)E_{rec} $$\n$$ x_{ss}^- \\left(1 - (1 - u_{ss}^+)E_{rec}\\right) = 1 - E_{rec} $$\n$$ x_{ss}^- = \\frac{1 - E_{rec}}{1 - (1 - u_{ss}^+)E_{rec}} $$\n\nFinally, the steady-state synaptic efficacy, $y_{ss}$, is defined as $y_n = u_n^+ x_n^-$ evaluated at the fixed point:\n$$ y_{ss}(f) = u_{ss}^+ \\cdot x_{ss}^- $$\n\nTo summarize the calculation procedure for a given set of parameters $\\{U, \\tau_{fac}, \\tau_{rec}, f\\}$:\n1. Convert time constants from milliseconds ($ms$) to seconds ($s$): $\\tau_{fac, s} = \\tau_{fac, ms} / 1000$, $\\tau_{rec, s} = \\tau_{rec, ms} / 1000$.\n2. Calculate the interspike interval: $\\Delta t = 1/f$.\n3. Compute the exponential decay factors: $E_{fac} = \\exp(-\\Delta t / \\tau_{fac, s})$ and $E_{rec} = \\exp(-\\Delta t / \\tau_{rec, s})$.\n4. Calculate the steady-state pre-spike utilization: $u_{ss}^- = \\frac{U}{1 - (1-U)E_{fac}}$.\n5. Calculate the steady-state post-spike utilization: $u_{ss}^+ = U + u_{ss}^-(1-U)$.\n6. Calculate the steady-state pre-spike resource fraction: $x_{ss}^- = \\frac{1 - E_{rec}}{1 - (1 - u_{ss}^+)E_{rec}}$.\n7. Calculate the final steady-state efficacy: $y_{ss} = u_{ss}^+ \\cdot x_{ss}^-$.\nThis procedure yields $y_{ss}(f)$ as a function of the given parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the steady-state synaptic efficacy for a set of test cases\n    based on the Tsodyks-Markram model of short-term plasticity.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (U, tau_rec_ms, tau_fac_ms, f_hz)\n    test_cases = [\n        (0.2, 800.0, 300.0, 20.0),  # 1. Baseline case\n        (0.2, 800.0, 300.0, 0.1),   # 2. Low frequency\n        (0.2, 800.0, 300.0, 200.0), # 3. High frequency\n        (0.05, 2000.0, 1000.0, 20.0),# 4. Facilitating regime\n        (0.5, 100.0, 50.0, 20.0),    # 5. Depressing regime\n    ]\n\n    results = []\n    for case in test_cases:\n        y_ss = calculate_yss(*case)\n        results.append(y_ss)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef calculate_yss(U, tau_rec_ms, tau_fac_ms, f):\n    \"\"\"\n    Computes the steady-state efficacy y_ss(f) based on the derived formulas.\n\n    Args:\n        U (float): Baseline utilization.\n        tau_rec_ms (float): Recovery time constant in milliseconds.\n        tau_fac_ms (float): Facilitation time constant in milliseconds.\n        f (float): Spike frequency in Hertz.\n\n    Returns:\n        float: The steady-state synaptic efficacy, rounded to 6 decimal places.\n    \"\"\"\n    # 1. Convert time constants to seconds.\n    tau_rec = tau_rec_ms / 1000.0\n    tau_fac = tau_fac_ms / 1000.0\n\n    # 2. Calculate interspike interval.\n    # Handle the case of f=0 to avoid division by zero, though not in the test suite.\n    if f == 0:\n        return 0.0\n    delta_t = 1.0 / f\n\n    # 3. Compute exponential decay factors.\n    E_fac = np.exp(-delta_t / tau_fac)\n    E_rec = np.exp(-delta_t / tau_rec)\n\n    # 4. Calculate the steady-state pre-spike utilization u_ss_minus.\n    # Formula: u_ss_minus = U / (1 - (1-U) * E_fac)\n    u_ss_minus_denom = 1.0 - (1.0 - U) * E_fac\n    if u_ss_minus_denom == 0:\n        # This case is unlikely with physical parameters but good for robustness.\n        # It would imply u diverges.\n        u_ss_minus = np.inf\n    else:\n        u_ss_minus = U / u_ss_minus_denom\n\n    # 5. Calculate the steady-state post-spike utilization u_ss_plus.\n    # Formula: u_ss_plus = U + u_ss_minus * (1 - U)\n    u_ss_plus = U + u_ss_minus * (1.0 - U)\n    \n    # 6. Calculate the steady-state pre-spike resource fraction x_ss_minus.\n    # Formula: x_ss_minus = (1 - E_rec) / (1 - (1 - u_ss_plus) * E_rec)\n    x_ss_minus_denom = 1.0 - (1.0 - u_ss_plus) * E_rec\n    if x_ss_minus_denom == 0:\n        # Unlikely case, would imply x diverges.\n        x_ss_minus = np.inf\n    else:\n        x_ss_minus = (1.0 - E_rec) / x_ss_minus_denom\n        \n    # 7. Calculate the final steady-state efficacy y_ss.\n    # Formula: y_ss = u_ss_plus * x_ss_minus\n    y_ss = u_ss_plus * x_ss_minus\n    \n    return y_ss\n\n# Run the solver.\nsolve()\n```"
        }
    ]
}