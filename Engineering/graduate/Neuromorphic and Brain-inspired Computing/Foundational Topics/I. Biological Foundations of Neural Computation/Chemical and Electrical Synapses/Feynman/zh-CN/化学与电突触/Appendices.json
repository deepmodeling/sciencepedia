{
    "hands_on_practices": [
        {
            "introduction": "突触最基本的功能是传递电流，从而改变突触后神经元的膜电位。本练习  将神经元建模为一个简单的RC电路，要求你从第一性原理（基尔霍夫定律）出发，推导突触后电位（PSP）的时间演化过程。这项实践是理解神经元内在特性（如电阻和电容，由膜时间常数 $\\tau_m$ 体现）如何与突触输入特性（其电流的时间过程）相互作用，共同塑造最终电压信号的基础，并为所有更复杂的神经整合模型奠定了基石。",
            "id": "4039276",
            "problem": "在一个受大脑启发的神经形态点神经元模型中，假设胞体膜是一个等电位的、被动的、线性的电阻-电容元件，遵循基尔霍夫电流定律和标准线性电路理论。一个化学突触传递一个突触后电流，其波形由因果指数函数 $I(t) = I_{0}\\exp(-t/\\tau)$ ($t \\ge 0$) 描述，其中 $I_{0} = 100\\,\\mathrm{pA}$ 且 $\\tau = 5\\,\\mathrm{ms}$。该神经元的输入电阻为 $R_{\\mathrm{in}} = 100\\,\\mathrm{M}\\Omega$，其膜电容为 $C_{m} = 200\\,\\mathrm{pF}$。在 $t=0^{-}$ 时，初始膜电位偏差为零。\n\n从基本的线性电阻-电容膜动力学出发，并且不使用任何快捷公式，推导胞体处响应于此突触电流的突触后电位变化 $\\Delta V(t)$ 的时间进程。然后，确定 $\\Delta V(t)$ 的峰值振幅 $\\Delta V_{\\mathrm{peak}}$。简要解释，根据膜时间常数和突触时间常数，哪个时间常数主导 $\\Delta V(t)$ 的后期衰减。\n\n将峰值振幅 $\\Delta V_{\\mathrm{peak}}$ 的最终数值以 $\\mathrm{mV}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于应用于简化神经元模型的标准线性电路理论，是适定的（提供了足够信息以获得唯一解），并且以客观、正式的语言陈述。\n\n胞体膜被建模为一个并联电阻-电容（RC）电路。根据基尔霍夫电流定律，流入神经元的总突触电流 $I(t)$ 必须等于流过膜电阻的电流 $I_{R}(t)$ 和流过膜电容的电流 $I_{C}(t)$ 之和。\n$$I(t) = I_{R}(t) + I_{C}(t)$$\n设 $\\Delta V(t)$ 为膜电位与其静息值的偏差。流过电阻和电容的电流分别由欧姆定律和电容的定义给出：\n$$I_{R}(t) = \\frac{\\Delta V(t)}{R_{\\mathrm{in}}}$$\n$$I_{C}(t) = C_{m} \\frac{d(\\Delta V(t))}{dt}$$\n输入的突触电流为 $I(t) = I_{0}\\exp(-t/\\tau)$ ($t \\ge 0$)。将这些表达式代入基尔霍夫定律，得到控制突触后电位变化 $\\Delta V(t)$ 的一阶线性常微分方程（ODE）：\n$$I_{0}\\exp(-t/\\tau) = \\frac{\\Delta V(t)}{R_{\\mathrm{in}}} + C_{m} \\frac{d(\\Delta V(t))}{dt}$$\n我们可以将此方程重排为标准形式：\n$$\\frac{d(\\Delta V)}{dt} + \\frac{1}{R_{\\mathrm{in}}C_{m}}\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(-t/\\tau)$$\n我们定义膜时间常数 $\\tau_{m} = R_{\\mathrm{in}}C_{m}$。首先，我们计算其值：\n$$\\tau_{m} = (100 \\times 10^{6}\\,\\Omega) \\times (200 \\times 10^{-12}\\,\\mathrm{F}) = 20000 \\times 10^{-6}\\,\\mathrm{s} = 20 \\times 10^{-3}\\,\\mathrm{s} = 20\\,\\mathrm{ms}$$\n给定的突触时间常数为 $\\tau = 5\\,\\mathrm{ms}$。由于 $\\tau_{m} \\neq \\tau$，该ODE为：\n$$\\frac{d(\\Delta V)}{dt} + \\frac{1}{\\tau_{m}}\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(-t/\\tau)$$\n这个ODE可以用积分因子法求解。积分因子 $\\mu(t)$ 是：\n$$\\mu(t) = \\exp\\left(\\int \\frac{1}{\\tau_{m}} dt\\right) = \\exp(t/\\tau_{m})$$\n将ODE两边乘以 $\\mu(t)$：\n$$\\exp(t/\\tau_{m})\\frac{d(\\Delta V)}{dt} + \\frac{1}{\\tau_{m}}\\exp(t/\\tau_{m})\\Delta V(t) = \\frac{I_{0}}{C_{m}}\\exp(t/\\tau_{m})\\exp(-t/\\tau)$$\n左边是乘积 $\\Delta V(t)\\mu(t)$ 的导数：\n$$\\frac{d}{dt}\\left(\\Delta V(t)\\exp(t/\\tau_{m})\\right) = \\frac{I_{0}}{C_{m}}\\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right)$$\n两边对 $t$ 积分：\n$$\\Delta V(t)\\exp(t/\\tau_{m}) = \\int \\frac{I_{0}}{C_{m}}\\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right) dt$$\n$$\\Delta V(t)\\exp(t/\\tau_{m}) = \\frac{I_{0}}{C_{m}} \\frac{1}{\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}} \\exp\\left(t\\left(\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}\\right)\\right) + K$$\n其中 $K$ 是积分常数。化简系数：\n$$\\frac{1}{\\frac{1}{\\tau_{m}} - \\frac{1}{\\tau}} = \\frac{1}{\\frac{\\tau - \\tau_{m}}{\\tau_{m}\\tau}} = \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}}$$\n将此代回并解出 $\\Delta V(t)$：\n$$\\Delta V(t) = \\frac{I_{0}}{C_{m}} \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m})$$\n使用 $C_{m} = \\tau_{m}/R_{\\mathrm{in}}$，我们得到：\n$$\\Delta V(t) = \\frac{I_{0}}{(\\tau_{m}/R_{\\mathrm{in}})} \\frac{\\tau_{m}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m}) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(-t/\\tau) + K\\exp(-t/\\tau_{m})$$\n初始条件为 $\\Delta V(t=0^{-})=0$，这意味着 $\\Delta V(t=0)=0$。应用此条件：\n$$0 = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\exp(0) + K\\exp(0) \\implies K = -\\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}$$\n将 $K$ 代回到 $\\Delta V(t)$ 的解中：\n$$\\Delta V(t) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}\\exp(-t/\\tau) - \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}}\\exp(-t/\\tau_{m})$$\n$$\\Delta V(t) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(\\exp(-t/\\tau) - \\exp(-t/\\tau_{m})\\right)$$\n为求峰值振幅 $\\Delta V_{\\mathrm{peak}}$，我们必须找到电位达到最大值的时间 $t_{\\mathrm{peak}}$。这发生在 $\\Delta V(t)$ 对 $t$ 的导数为零时：\n$$\\frac{d(\\Delta V)}{dt} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau - \\tau_{m}} \\left(-\\frac{1}{\\tau}\\exp(-t/\\tau) + \\frac{1}{\\tau_{m}}\\exp(-t/\\tau_{m})\\right) = 0$$\n这要求括号中的项为零：\n$$\\frac{1}{\\tau_{m}}\\exp(-t_{\\mathrm{peak}}/\\tau_{m}) = \\frac{1}{\\tau}\\exp(-t_{\\mathrm{peak}}/\\tau)$$\n$$\\frac{\\exp(-t_{\\mathrm{peak}}/\\tau_{m})}{\\exp(-t_{\\mathrm{peak}}/\\tau)} = \\frac{\\tau_{m}}{\\tau} \\implies \\exp\\left(t_{\\mathrm{peak}}\\left(\\frac{1}{\\tau} - \\frac{1}{\\tau_{m}}\\right)\\right) = \\frac{\\tau_{m}}{\\tau}$$\n对两边取自然对数，并解出 $t_{\\mathrm{peak}}$：\n$$t_{\\mathrm{peak}}\\left(\\frac{\\tau_{m} - \\tau}{\\tau\\tau_{m}}\\right) = \\ln\\left(\\frac{\\tau_{m}}{\\tau}\\right) \\implies t_{\\mathrm{peak}} = \\frac{\\tau\\tau_{m}}{\\tau_{m} - \\tau}\\ln\\left(\\frac{\\tau_{m}}{\\tau}\\right)$$\n现在我们将 $t_{\\mathrm{peak}}$ 代入 $\\Delta V(t)$ 的表达式中以求得 $\\Delta V_{\\mathrm{peak}}$。为了代数上的简化，我们可以使用从导数设为零推导出的关系式 $\\exp(-t_{\\mathrm{peak}}/\\tau) = \\frac{\\tau}{\\tau_m}\\exp(-t_{\\mathrm{peak}}/\\tau_m)$。\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_m-\\tau} \\left(\\exp(-t_{\\mathrm{peak}}/\\tau_m) - \\exp(-t_{\\mathrm{peak}}/\\tau)\\right) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_m-\\tau} \\left(\\exp(-t_{\\mathrm{peak}}/\\tau_m) - \\frac{\\tau}{\\tau_m}\\exp(-t_{\\mathrm{peak}}/\\tau_m)\\right)$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_m-\\tau} \\exp(-t_{\\mathrm{peak}}/\\tau_m) \\left(1 - \\frac{\\tau}{\\tau_m}\\right) = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_m-\\tau} \\exp(-t_{\\mathrm{peak}}/\\tau_m) \\left(\\frac{\\tau_m-\\tau}{\\tau_m}\\right)$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{I_{0}R_{\\mathrm{in}}\\tau}{\\tau_{m}}\\exp(-t_{\\mathrm{peak}}/\\tau_{m})$$\n从 $t_{\\mathrm{peak}}$ 的表达式，我们有：\n$$-\\frac{t_{\\mathrm{peak}}}{\\tau_{m}} = -\\frac{\\tau}{\\tau_m - \\tau}\\ln\\left(\\frac{\\tau_m}{\\tau}\\right) = \\ln\\left[\\left(\\frac{\\tau_m}{\\tau}\\right)^{-\\frac{\\tau}{\\tau_m-\\tau}}\\right]$$\n所以，$\\exp(-t_{\\mathrm{peak}}/\\tau_{m}) = \\left(\\frac{\\tau_m}{\\tau}\\right)^{-\\frac{\\tau}{\\tau_m-\\tau}}$。\n代入数值：$\\tau_{m}=20\\,\\mathrm{ms}$，$\\tau=5\\,\\mathrm{ms}$，$I_{0}=100\\,\\mathrm{pA}$，$R_{\\mathrm{in}}=100\\,\\mathrm{M}\\Omega$。\n前置因子 $I_{0}R_{\\mathrm{in}} = (100 \\times 10^{-12}\\,\\mathrm{A})(100 \\times 10^{6}\\,\\Omega) = 10^{-2}\\,\\mathrm{V} = 10\\,\\mathrm{mV}$。\n$$\\Delta V_{\\mathrm{peak}} = \\frac{(10\\,\\mathrm{mV})(5\\,\\mathrm{ms})}{20\\,\\mathrm{ms}} \\left(\\frac{20\\,\\mathrm{ms}}{5\\,\\mathrm{ms}}\\right)^{-\\frac{5\\,\\mathrm{ms}}{20\\,\\mathrm{ms}-5\\,\\mathrm{ms}}}$$\n$$\\Delta V_{\\mathrm{peak}} = 2.5\\,\\mathrm{mV} \\times (4)^{-5/15} = 2.5\\,\\mathrm{mV} \\times (4)^{-1/3}$$\n$$\\Delta V_{\\mathrm{peak}} = \\frac{2.5}{4^{1/3}}\\,\\mathrm{mV} \\approx \\frac{2.5}{1.587401}\\,\\mathrm{mV} \\approx 1.574902\\,\\mathrm{mV}$$\n四舍五入到四位有效数字，我们得到 $\\Delta V_{\\mathrm{peak}} = 1.575\\,\\mathrm{mV}$。\n\n对于后期衰减，我们考察解 $\\Delta V(t) \\propto (\\exp(-t/\\tau_{m}) - \\exp(-t/\\tau))$。衰减由两个时间常数 $\\tau_{m} = 20\\,\\mathrm{ms}$ 和 $\\tau = 5\\,\\mathrm{ms}$ 控制。具有较大时间常数的项衰减得更慢。由于 $\\tau_{m} > \\tau$，项 $\\exp(-t/\\tau_{m})$ 比 $\\exp(-t/\\tau)$ 衰减得更慢。对于大的 $t$（即 $t \\gg \\tau$），项 $\\exp(-t/\\tau)$ 比 $\\exp(-t/\\tau_{m})$ 快得多地变得可以忽略不计。因此，$\\Delta V(t)$ 的后期衰减由膜时间常数 $\\tau_{m}$ 主导。其物理意义是，在相对较快的突触电流结束后，膜电位通过膜电阻对膜电容放电，从而衰减回静息状态，这个过程由 $\\tau_m$ 控制。",
            "answer": "$$\\boxed{1.575}$$"
        },
        {
            "introduction": "在单神经元模型的基础上，我们现在来探讨神经元如何通过电突触（即缝隙连接）直接相互作用。本练习  对由电阻性缝隙连接耦合的两个神经元进行建模，你将应用电路定律推导出一个耦合微分方程组来描述它们的集体行为。这项实践展示了线性系统分析在神经科学中的威力，揭示了电耦合如何产生同步等网络动力学行为。理解这些原理对于设计利用直接电耦合实现快速通信的神经形态电路至关重要。",
            "id": "4039228",
            "problem": "考虑两个通过电突触（间隙连接）耦合并接收外部注入电流的等电位神经元胞体。将每个胞体建模为阻容 (RC) 膜，其膜电容为 $C_{i}$，被动漏电导为 $g_{L,i}$，漏电反转电位为 $E_{L,i}$，其中 $i \\in \\{1,2\\}$。间隙连接被建模为连接两个胞体的纯欧姆电导 $g_{gj}$。注入电流为 $I_{1}(t)$ 和 $I_{2}(t)$，定义为流入细胞的电流。假设所有参数不随时间变化，且胞体是唯一的隔室。\n\n使用基尔霍夫电流定律 (KCL) 和欧姆定律来：\n\n- 在膜电流的层面上构建等效电路，并从第一性原理出发，写出控制膜电位 $V_{1}(t)$ 和 $V_{2}(t)$ 的耦合常微分方程 (ODEs)，明确考虑电容电流、漏电流和间隙连接电流，并使用正确的符号。\n- 将所得系统表示为 $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$ 的形式，其中 $\\mathbf{V} = \\begin{pmatrix} V_{1} \\\\ V_{2} \\end{pmatrix}$，并用 $C_{i}$、$g_{L,i}$、$E_{L,i}$、$g_{gj}$ 和 $I_{i}(t)$ 来确定系统矩阵 $\\mathbf{A}$ 和仿射项 $\\mathbf{b}$。\n- 专门研究具有恒定输入 $I_{1}(t) \\equiv I_{1,0}$ 和 $I_{2}(t) \\equiv I_{2,0}$ 的自治情况。对于偏离平衡的齐次动力学，在相同神经元的情况下（$C_{1} = C_{2} = C$，$g_{L,1} = g_{L,2} = g_{L}$，$E_{L,1} = E_{L,2} = E_{L}$ 且 $I_{1,0} = I_{2,0} = I_{0}$），确定线性系统的本征模态和本征值。\n\n答案规格：\n- 在相同神经元的情况下，为齐次动力学的反对称（差值）模态的特征时间常数提供一个单一的闭式解析表达式，该表达式应为 $C$、$g_{L}$ 和 $g_{gj}$ 的函数。\n- 在最终的方框表达式中不包含单位。无需进行数值计算或四舍五入。",
            "solution": "该问题被评估为有效。它在科学上基于应用于标准神经元生物物理模型（被动 RC 膜）的电路理论原理（基尔霍夫定律和欧姆定律）。该问题是适定的，所有必要的参数和条件都已定义，从而可以推导出唯一的数学解。语言客观而精确。\n\n第一步是使用基尔霍夫电流定律 (KCL) 构建等效电路并推导控制微分方程。KCL 指出，对于电路中的任何节点，流入该节点的电流代数和为零。按照惯例，我们认为离开胞体的电流为正。\n\n对于胞体 1，其膜电位为 $V_{1}(t)$，电流包括：\n1.  电容电流，$I_{C,1} = C_{1} \\frac{dV_{1}}{dt}$。这是为膜电容器充电的电流。\n2.  漏电流，$I_{L,1} = g_{L,1}(V_{1} - E_{L,1})$。这是通过被动漏通道流出细胞的离子电流，由膜电位和漏电反转电位之间的差值驱动。\n3.  间隙连接电流，$I_{gj,1 \\to 2} = g_{gj}(V_{1} - V_{2})$。这是通过间隙连接从胞体 1 流向胞体 2 的电流。\n4.  外部注入电流，$I_{1}(t)$。这被定义为流入细胞的电流，因此是一个内向电流。\n\n对胞体 1 应用 KCL (流出电流之和等于流入电流之和)：\n$$C_{1} \\frac{dV_{1}}{dt} + g_{L,1}(V_{1} - E_{L,1}) + g_{gj}(V_{1} - V_{2}) = I_{1}(t)$$\n整理此方程：\n$$C_{1} \\frac{dV_{1}}{dt} = -(g_{L,1} + g_{gj})V_{1} + g_{gj}V_{2} + g_{L,1}E_{L,1} + I_{1}(t)$$\n\n类似地，对于胞体 2，其膜电位为 $V_{2}(t)$，电流包括：\n1.  电容电流，$I_{C,2} = C_{2} \\frac{dV_{2}}{dt}$。\n2.  漏电流，$I_{L,2} = g_{L,2}(V_{2} - E_{L,2})$。\n3.  间隙连接电流，$I_{gj,2 \\to 1} = g_{gj}(V_{2} - V_{1})$。这是从胞体 2 流向胞体 1 的电流。\n4.  外部注入电流，$I_{2}(t)$。\n\n对胞体 2 应用 KCL：\n$$C_{2} \\frac{dV_{2}}{dt} + g_{L,2}(V_{2} - E_{L,2}) + g_{gj}(V_{2} - V_{1}) = I_{2}(t)$$\n整理此方程：\n$$C_{2} \\frac{dV_{2}}{dt} = g_{gj}V_{1} - (g_{L,2} + g_{gj})V_{2} + g_{L,2}E_{L,2} + I_{2}(t)$$\n\n第二个任务是将此系统表示为 $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$ 的形式。我们分离出导数 $\\frac{dV_{1}}{dt}$ 和 $\\frac{dV_{2}}{dt}$：\n$$\\frac{dV_{1}}{dt} = -\\frac{g_{L,1} + g_{gj}}{C_{1}}V_{1} + \\frac{g_{gj}}{C_{1}}V_{2} + \\frac{g_{L,1}E_{L,1} + I_{1}(t)}{C_{1}}$$\n$$\\frac{dV_{2}}{dt} = \\frac{g_{gj}}{C_{2}}V_{1} - \\frac{g_{L,2} + g_{gj}}{C_{2}}V_{2} + \\frac{g_{L,2}E_{L,2} + I_{2}(t)}{C_{2}}$$\n写成矩阵形式，其中 $\\mathbf{V} = \\begin{pmatrix} V_{1} \\\\ V_{2} \\end{pmatrix}$，方程为 $\\dot{\\mathbf{V}} = \\mathbf{A}\\mathbf{V} + \\mathbf{b}$，其中系统矩阵 $\\mathbf{A}$ 和仿射项 $\\mathbf{b}$ 为：\n$$\\mathbf{A} = \\begin{pmatrix} -\\frac{g_{L,1} + g_{gj}}{C_{1}} & \\frac{g_{gj}}{C_{1}} \\\\ \\frac{g_{gj}}{C_{2}} & -\\frac{g_{L,2} + g_{gj}}{C_{2}} \\end{pmatrix}$$\n$$\\mathbf{b} = \\begin{pmatrix} \\frac{g_{L,1}E_{L,1} + I_{1}(t)}{C_{1}} \\\\ \\frac{g_{L,2}E_{L,2} + I_{2}(t)}{C_{2}} \\end{pmatrix}$$\n\n第三个任务是分析自治的、相同神经元的情况。条件是：$I_{1}(t) \\equiv I_{1,0}$，$I_{2}(t) \\equiv I_{2,0}$，$C_{1} = C_{2} = C$，$g_{L,1} = g_{L,2} = g_{L}$，$E_{L,1} = E_{L,2} = E_{L}$，以及 $I_{1,0} = I_{2,0} = I_{0}$。\n在这些条件下，系统矩阵 $\\mathbf{A}$ 简化为：\n$$\\mathbf{A}_{\\text{symm}} = \\begin{pmatrix} -\\frac{g_{L} + g_{gj}}{C} & \\frac{g_{gj}}{C} \\\\ \\frac{g_{gj}}{C} & -\\frac{g_{L} + g_{gj}}{C} \\end{pmatrix} = \\frac{1}{C}\\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix}$$\n偏离平衡态 $\\mathbf{V}_{\\text{eq}}$ 的偏差 $\\mathbf{v}(t) = \\mathbf{V}(t) - \\mathbf{V}_{\\text{eq}}$ 的动力学由齐次线性系统 $\\dot{\\mathbf{v}} = \\mathbf{A}_{\\text{symm}}\\mathbf{v}$ 控制。该系统的解由 $\\mathbf{A}_{\\text{symm}}$ 的本征值和本征向量（本征模态）确定。\n\n为了找到本征值 $\\lambda$，我们求解特征方程 $\\det(\\mathbf{A}_{\\text{symm}} - \\lambda \\mathbf{I}) = 0$。先求出矩阵 $C \\mathbf{A}_{\\text{symm}}$ 的本征值 $\\mu$ 会更简单，其中 $\\lambda = \\mu/C$。\n$$\\det \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - \\begin{pmatrix} \\mu & 0 \\\\ 0 & \\mu \\end{pmatrix} \\right) = 0$$\n$$\\begin{vmatrix} -(g_{L} + g_{gj}) - \\mu & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) - \\mu \\end{vmatrix} = 0$$\n$$(-(g_{L} + g_{gj}) - \\mu)^{2} - g_{gj}^{2} = 0$$\n$$(g_{L} + g_{gj} + \\mu)^{2} = g_{gj}^{2}$$\n对两边取平方根，得到两种可能性：\n1. $g_{L} + g_{gj} + \\mu_{1} = g_{gj} \\implies \\mu_{1} = -g_{L}$\n2. $g_{L} + g_{gj} + \\mu_{2} = -g_{gj} \\implies \\mu_{2} = -(g_{L} + 2g_{gj})$\n\n$\\mathbf{A}_{\\text{symm}}$ 的相应本征值为 $\\lambda_{1} = \\frac{\\mu_{1}}{C} = -\\frac{g_{L}}{C}$ 和 $\\lambda_{2} = \\frac{\\mu_{2}}{C} = -\\frac{g_{L} + 2g_{gj}}{C}$。\n\n现在我们求解本征向量。\n对于 $\\lambda_{1} = -g_{L}/C$ (即 $\\mu_{1} = -g_L$)：\n$$ \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - (-g_{L}) \\mathbf{I} \\right) \\mathbf{u}_{1} = \\begin{pmatrix} -g_{gj} & g_{gj} \\\\ g_{gj} & -g_{gj} \\end{pmatrix} \\begin{pmatrix} u_{11} \\\\ u_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这意味着 $-g_{gj} u_{11} + g_{gj} u_{12} = 0$，所以 $u_{11} = u_{12}$。本征向量是 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 的任意倍数。这是对称或共模模态，其中 $V_{1}$ 和 $V_{2}$ 同步变化。\n\n对于 $\\lambda_{2} = -(g_{L} + 2g_{gj})/C$ (即 $\\mu_{2} = -(g_L + 2g_{gj})$)：\n$$ \\left( \\begin{pmatrix} -(g_{L} + g_{gj}) & g_{gj} \\\\ g_{gj} & -(g_{L} + g_{gj}) \\end{pmatrix} - (-(g_{L} + 2g_{gj})) \\mathbf{I} \\right) \\mathbf{u}_{2} = \\begin{pmatrix} g_{gj} & g_{gj} \\\\ g_{gj} & g_{gj} \\end{pmatrix} \\begin{pmatrix} u_{21} \\\\ u_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这意味着 $g_{gj} u_{21} + g_{gj} u_{22} = 0$，所以 $u_{21} = -u_{22}$。本征向量是 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 的任意倍数。这是反对称或差值模态，其中 $V_{1}$ 和 $V_{2}$ 反向变化。\n\n最后一步是确定反对称模态的特征时间常数 $\\tau$。每个本征模态的动力学演化遵循 $\\exp(\\lambda t) = \\exp(-t/\\tau)$。因此时间常数由 $\\tau = -1/\\lambda$ 给出。对于反对称模态，本征值为 $\\lambda_{2}$：\n$$\\tau_{\\text{anti}} = -\\frac{1}{\\lambda_{2}} = -\\frac{1}{-\\frac{g_{L} + 2g_{gj}}{C}} = \\frac{C}{g_{L} + 2g_{gj}}$$\n\n这个表达式表明，电压差的衰减比孤立神经元（$\\tau = C/g_{L}$）的衰减更快（时间常数更小），因为间隙连接为电流流动和平衡电位差提供了额外的通路。具体来说，差值模态的有效电导是 $g_{L} + 2g_{gj}$。",
            "answer": "$$\\boxed{\\frac{C}{g_{L} + 2g_{gj}}}$$"
        },
        {
            "introduction": "与前面练习中的静态突触不同，真实的化学突触是高度动态的，其强度会根据近期的活动而改变。本练习  采用著名的Tsodyks-Markram模型来探索这种短期可塑性（STP）。你将推导并实现描述突触效能在连续脉冲输入下如何演化的方程。通过分析该模型，你将亲身体验短期易化和抑制的机制，并理解突触响应如何依赖于输入频率，这是构建具备强大计算能力的神经形态系统的基础。",
            "id": "4039233",
            "problem": "考虑一个使用 Tsodyks–Markram 形式主义通过短期可塑性（STP）建模的周期性受激化学突触。设该突触有两个状态变量：突触效能利用率 $u(t)$ 和可用突触资源分数 $x(t)$。在突触前脉冲之间，状态变量根据经过充分检验的连续时间方程呈指数恢复\n$$\\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}}, \\quad \\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}},$$\n其中 $U$ 是基线利用率，$\\tau_{fac}$ 是易化时间常数，$\\tau_{rec}$ 是恢复（抑制）时间常数。在每个突触前脉冲时间 $t_n$，易化和抑制按以下顺序瞬时发生：首先，\n$$u(t_n^+) = u(t_n^-) + U\\left(1 - u(t_n^-)\\right),$$\n然后\n$$x(t_n^+) = x(t_n^-)\\left(1 - u(t_n^+)\\right).$$\n效能（每个脉冲释放的分数）定义为\n$$y_n = u(t_n^+) \\, x(t_n^-).$$\n假设一个严格周期性的脉冲序列，频率为 $f$，脉冲间期为 $\\Delta t = 1/f$（单位：秒）。在这种周期性刺激下，系统会收敛到一个稳态，在该稳态中，脉冲前的值 $u(t_n^-)$ 和 $x(t_n^-)$ 在不同脉冲间保持恒定。从上述定义和定律出发，通过分析脉冲间的指数恢复和脉冲时的瞬时更新所引起的脉冲到脉冲映射，推导出稳态效能 $y_{ss}(f)$ 作为 $f$ 和突触参数的函数。您必须仅用 $U$、$\\tau_{fac}$、$\\tau_{rec}$ 和 $f$ 来表示 $y_{ss}(f)$，并为下面的测试套件进行数值计算。\n\n重要约束和说明：\n- 所有时间常数 $\\tau_{rec}$ 和 $\\tau_{fac}$ 均以毫秒（ms）为单位提供，使用前必须转换为秒（s）。\n- 脉冲频率 $f$ 以赫兹（Hz）为单位，因此脉冲间期 $\\Delta t = 1/f$ 以秒（s）为单位。\n- 最终输出是每个脉冲的无量纲突触效能。将每个结果表示为小数点后保留六位的小数。不得打印任何单位。\n- 尽管电突触（间隙连接）是更广泛背景的一部分，但本问题关注的是由短期可塑性建模的化学突触。电突触不表现出囊泡耗竭或易化现象，不属于此处要求的计算内容。\n\n测试套件：\n1. 基线情况：$U = 0.2$，$\\tau_{rec} = 800\\,\\mathrm{ms}$，$\\tau_{fac} = 300\\,\\mathrm{ms}$，$f = 20\\,\\mathrm{Hz}$。\n2. 低频情况：$U$、$\\tau_{rec}$、$\\tau_{fac}$ 与测试 1 相同，但 $f = 0.1\\,\\mathrm{Hz}$。\n3. 高频情况：$U$、$\\tau_{rec}$、$\\tau_{fac}$ 与测试 1 相同，但 $f = 200\\,\\mathrm{Hz}$。\n4. 易化机制：$U = 0.05$，$\\tau_{rec} = 2000\\,\\mathrm{ms}$，$\\tau_{fac} = 1000\\,\\mathrm{ms}$，$f = 20\\,\\mathrm{Hz}$。\n5. 抑制机制：$U = 0.5$，$\\tau_{rec} = 100\\,\\mathrm{ms}$，$\\tau_{fac} = 50\\,\\mathrm{ms}$，$f = 20\\,\\mathrm{Hz}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个“result”对应于相应测试用例的 $y_{ss}(f)$，四舍五入到小数点后六位。",
            "solution": "该问题要求在频率为 $f$ 的周期性刺激下，推导由 Tsodyks-Markram 短期可塑性（STP）模型描述的化学突触的稳态突触效能 $y_{ss}(f)$。推导过程涉及找到状态变量 $u(t)$ 和 $x(t)$ 的脉冲到脉冲动力学的固定点。\n\n状态变量是突触效能利用率 $u(t)$ 和可用突触资源分数 $x(t)$。它们的动力学受两个过程控制：脉冲间的指数恢复和每次脉冲发生时的瞬时更新。\n\n首先，我们分析在时间 $t_n$ 和 $t_{n+1}$ 发生的两个连续脉冲之间的恢复阶段。脉冲间期为 $\\Delta t = t_{n+1} - t_n = 1/f$。恢复动力学由以下一阶线性常微分方程给出：\n$$ \\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}} $$\n$$ \\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}} $$\n其中 $U$ 是基线利用率，$\\tau_{fac}$ 是易化时间常数，$\\tau_{rec}$ 是恢复（抑制）时间常数。\n\n我们将 $t_n$ 时刻脉冲前一刻的变量值表示为 $u(t_n^-)$ 和 $x(t_n^-)$，脉冲后一刻的值表示为 $u(t_n^+)$ 和 $x(t_n^+)$。将微分方程在从 $t_n^+$ 到 $t_{n+1}^-$ 的脉冲间期内积分，我们得到下一个脉冲前一刻的值：\n$$ u(t_{n+1}^-) = U + (u(t_n^+) - U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n$$ x(t_{n+1}^-) = 1 + (x(t_n^+) - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\n\n接下来，我们考虑在每个脉冲时间 $t_n$ 发生的瞬时更新。规则按顺序应用：\n1. $u$ 的易化：\n$$ u(t_n^+) = u(t_n^-) + U(1 - u(t_n^-)) = U + u(t_n^-)(1-U) $$\n2. $x$ 的抑制：\n$$ x(t_n^+) = x(t_n^-)(1 - u(t_n^+)) $$\n\n现在我们可以构建完整的脉冲到脉冲映射，它描述了脉冲前的值 $(u(t_n^-), x(t_n^-))$ 如何演变为下一个脉冲前的值 $(u(t_{n+1}^-), x(t_{n+1}^-))$。为简化符号，令 $u_n^- = u(t_n^-)$，$u_n^+ = u(t_n^+)$，$x_n^- = x(t_n^-)$ 和 $x_n^+ = x(t_n^+)$。\n\n$u$ 的动力学与 $x$ 无关。我们可以创建一个关于 $u_n^-$ 的 $u_{n+1}^-$ 的映射：\n$$ u_{n+1}^- = U + (u_n^+ - U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n代入 $u_n^+$ 的表达式：\n$$ u_{n+1}^- = U + \\left( (U + u_n^-(1-U)) - U \\right) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n$$ u_{n+1}^- = U + u_n^-(1-U) \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right) $$\n\n在稳态下，系统达到一个固定点，此时脉冲前的值是恒定的，即 $u_{n+1}^- = u_n^- = u_{ss}^-$。令 $E_{fac} = \\exp(-\\Delta t / \\tau_{fac})$。$u_{ss}^-$ 的稳态方程为：\n$$ u_{ss}^- = U + u_{ss}^-(1-U)E_{fac} $$\n求解 $u_{ss}^-$：\n$$ u_{ss}^- \\left(1 - (1-U)E_{fac}\\right) = U $$\n$$ u_{ss}^- = \\frac{U}{1 - (1-U)E_{fac}} $$\n\n利用稳态脉冲前值 $u_{ss}^-$，我们可以找到稳态脉冲后值 $u_{ss}^+$：\n$$ u_{ss}^+ = U + u_{ss}^-(1-U) $$\n\n现在我们推导 $x$ 的稳态值。$x_n^-$ 的映射为：\n$$ x_{n+1}^- = 1 + (x_n^+ - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\n代入 $x_n^+$ 的表达式：\n$$ x_{n+1}^- = 1 + (x_n^-(1 - u_n^+) - 1) \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right) $$\n在稳态下，$x_{n+1}^- = x_n^- = x_{ss}^-$ 且 $u_n^+ = u_{ss}^+$。令 $E_{rec} = \\exp(-\\Delta t / \\tau_{rec})$。固定点方程为：\n$$ x_{ss}^- = 1 + (x_{ss}^-(1 - u_{ss}^+) - 1)E_{rec} $$\n求解 $x_{ss}^-$：\n$$ x_{ss}^- = 1 - E_{rec} + x_{ss}^-(1 - u_{ss}^+)E_{rec} $$\n$$ x_{ss}^- \\left(1 - (1 - u_{ss}^+)E_{rec}\\right) = 1 - E_{rec} $$\n$$ x_{ss}^- = \\frac{1 - E_{rec}}{1 - (1 - u_{ss}^+)E_{rec}} $$\n\n最后，稳态突触效能 $y_{ss}$ 定义为在固定点处计算的 $y_n = u_n^+ x_n^-$：\n$$ y_{ss}(f) = u_{ss}^+ \\cdot x_{ss}^- $$\n\n总结给定参数集 $\\{U, \\tau_{fac}, \\tau_{rec}, f\\}$ 的计算过程：\n1. 将时间常数从毫秒（ms）转换为秒（s）：$\\tau_{fac, s} = \\tau_{fac, ms} / 1000$，$\\tau_{rec, s} = \\tau_{rec, ms} / 1000$。\n2. 计算脉冲间期：$\\Delta t = 1/f$。\n3. 计算指数衰减因子：$E_{fac} = \\exp(-\\Delta t / \\tau_{fac, s})$ 和 $E_{rec} = \\exp(-\\Delta t / \\tau_{rec, s})$。\n4. 计算稳态脉冲前利用率：$u_{ss}^- = \\frac{U}{1 - (1-U)E_{fac}}$。\n5. 计算稳态脉冲后利用率：$u_{ss}^+ = U + u_{ss}^-(1-U)$。\n6. 计算稳态脉冲前资源分数：$x_{ss}^- = \\frac{1 - E_{rec}}{1 - (1 - u_{ss}^+)E_{rec}}$。\n7. 计算最终的稳态效能：$y_{ss} = u_{ss}^+ \\cdot x_{ss}^-$。此过程得出 $y_{ss}(f)$ 作为给定参数的函数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the steady-state synaptic efficacy for a set of test cases\n    based on the Tsodyks-Markram model of short-term plasticity.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (U, tau_rec_ms, tau_fac_ms, f_hz)\n    test_cases = [\n        (0.2, 800.0, 300.0, 20.0),  # 1. Baseline case\n        (0.2, 800.0, 300.0, 0.1),   # 2. Low frequency\n        (0.2, 800.0, 300.0, 200.0), # 3. High frequency\n        (0.05, 2000.0, 1000.0, 20.0),# 4. Facilitating regime\n        (0.5, 100.0, 50.0, 20.0),    # 5. Depressing regime\n    ]\n\n    results = []\n    for case in test_cases:\n        y_ss = calculate_yss(*case)\n        results.append(y_ss)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef calculate_yss(U, tau_rec_ms, tau_fac_ms, f):\n    \"\"\"\n    Computes the steady-state efficacy y_ss(f) based on the derived formulas.\n\n    Args:\n        U (float): Baseline utilization.\n        tau_rec_ms (float): Recovery time constant in milliseconds.\n        tau_fac_ms (float): Facilitation time constant in milliseconds.\n        f (float): Spike frequency in Hertz.\n\n    Returns:\n        float: The steady-state synaptic efficacy, rounded to 6 decimal places.\n    \"\"\"\n    # 1. Convert time constants to seconds.\n    tau_rec = tau_rec_ms / 1000.0\n    tau_fac = tau_fac_ms / 1000.0\n\n    # 2. Calculate interspike interval.\n    # Handle the case of f=0 to avoid division by zero, though not in the test suite.\n    if f == 0:\n        return 0.0\n    delta_t = 1.0 / f\n\n    # 3. Compute exponential decay factors.\n    E_fac = np.exp(-delta_t / tau_fac)\n    E_rec = np.exp(-delta_t / tau_rec)\n\n    # 4. Calculate the steady-state pre-spike utilization u_ss_minus.\n    # Formula: u_ss_minus = U / (1 - (1-U) * E_fac)\n    u_ss_minus_denom = 1.0 - (1.0 - U) * E_fac\n    if u_ss_minus_denom == 0:\n        # This case is unlikely with physical parameters but good for robustness.\n        # It would imply u diverges.\n        u_ss_minus = np.inf\n    else:\n        u_ss_minus = U / u_ss_minus_denom\n\n    # 5. Calculate the steady-state post-spike utilization u_ss_plus.\n    # Formula: u_ss_plus = U + u_ss_minus * (1 - U)\n    u_ss_plus = U + u_ss_minus * (1.0 - U)\n    \n    # 6. Calculate the steady-state pre-spike resource fraction x_ss_minus.\n    # Formula: x_ss_minus = (1 - E_rec) / (1 - (1 - u_ss_plus) * E_rec)\n    x_ss_minus_denom = 1.0 - (1.0 - u_ss_plus) * E_rec\n    if x_ss_minus_denom == 0:\n        # Unlikely case, would imply x diverges.\n        x_ss_minus = np.inf\n    else:\n        x_ss_minus = (1.0 - E_rec) / x_ss_minus_denom\n        \n    # 7. Calculate the final steady-state efficacy y_ss.\n    # Formula: y_ss = u_ss_plus * x_ss_minus\n    y_ss = u_ss_plus * x_ss_minus\n    \n    return y_ss\n\n# Run the solver.\nsolve()\n```"
        }
    ]
}