{
    "hands_on_practices": [
        {
            "introduction": "掌握任何神经元模型的首要步骤是理解其最基本的兴奋性特性。基电流（rheobase current）是引起神经元发放单个动作电位的最小恒定输入电流，是衡量其兴奋性的一个核心指标。本练习将引导你通过动力系统分析，为自适应指数整合发放（AdEx）模型推导出基电流的解析表达式，这一过程涉及到寻找系统的平衡点并分析其稳定性。通过这个练习，你不仅能加深对 AdEx 模型方程的理解，还能掌握如何将模型的抽象参数与关键的生理学概念联系起来。",
            "id": "4034142",
            "problem": "考虑一个由恒定输入电流驱动的自适应指数积分-发放 (AdEx) 神经元模型。状态变量为膜电位 $V$ 和自适应电流 $w$。膜方程由电容 $C$、漏电导 $g_L$、漏泄反转电位 $E_L$、一个由斜率因子 $\\Delta_T$ 和阈值参数 $V_T$ 表征的指数形式尖峰起始项，以及输入电流 $I_0$ 定义。自适应动力学是线性的，其阈下自适应参数为 $a$，时间常数为 $\\tau_w$。本题不使用重置和尖峰发放机制；而是关注连续动力学的不动点及其稳定性。对于一个恒定输入 $I_0$，该系统为\n$$\nC \\,\\frac{dV}{dt} \\;=\\; -\\,g_L \\,\\big(V - E_L\\big) \\;+\\; g_L \\,\\Delta_T \\,\\exp\\!\\Big(\\frac{V - V_T}{\\Delta_T}\\Big) \\;-\\; w \\;+\\; I_0,\n$$\n$$\n\\tau_w \\,\\frac{dw}{dt} \\;=\\; a \\,\\big(V - E_L\\big) \\;-\\; w.\n$$\n从动力系统不动点存在性和线性稳定性的第一性原理出发，推导基电流 $I_{rheo}$ 的解析表达式。基电流定义为：当 $I_0$ 增加时，阈下动力学的不动点失去稳定性或消失的最低恒定输入 $I_0$。\n\n然后，使用您推导的表达式，对以下参数集计算 $I_{rheo}$ 的值\n- $C = 200\\,\\text{pF}$，\n- $g_L = 10\\,\\text{nS}$，\n- $E_L = -70\\,\\text{mV}$，\n- $V_T = -50\\,\\text{mV}$，\n- $\\Delta_T = 2\\,\\text{mV}$，\n- $a = 2\\,\\text{nS}$，\n- $\\tau_w = 100\\,\\text{ms}$。\n\n以纳安 (nA) 为单位表示最终电流。将答案四舍五入至四位有效数字。",
            "solution": "系统的不动点 $(V^*, w^*)$ 通过将时间导数设为零来找到，$\\frac{dV}{dt} = 0$ 和 $\\frac{dw}{dt} = 0$。\n自适应电流的方程给出了 $w$-零斜线：\n$$ \\tau_w \\frac{dw}{dt} = 0 \\quad\\implies\\quad a(V^* - E_L) - w^* = 0 \\quad\\implies\\quad w^* = a(V^* - E_L) $$\n膜电位的方程给出了 $V$-零斜线：\n$$ C \\frac{dV}{dt} = 0 \\quad\\implies\\quad -g_L(V^* - E_L) + g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) - w^* + I_0 = 0 $$\n将 $w^*$ 代入 $V$-零斜线方程，得到一个关于输入电流 $I_0$ 的不动点电压 $V^*$ 的方程：\n$$ -g_L(V^* - E_L) + g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) - a(V^* - E_L) + I_0 = 0 $$\n我们可以将电流 $I_0$ 表示为不动点电压 $V^*$ 的函数：\n$$ I_0(V^*) = (g_L + a)(V^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) $$\n基电流 $I_{rheo}$ 对应于稳定不动点消失时的 $I_0$ 值。这发生在鞍结分岔处，此时两个不动点（一个稳定，一个不稳定）合并并消失。这个分岔点对应于函数 $I_0(V^*)$ 的一个局部极值。我们通过将 $I_0(V^*)$ 对 $V^*$ 的导数设为零来找到它。设 $V_c^*$ 为此临界点处的电压。\n$$ \\frac{dI_0}{dV^*} \\bigg|_{V^*=V_c^*} = \\frac{d}{dV^*} \\left[ (g_L + a)(V^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V^* - V_T}{\\Delta_T}\\right) \\right] = 0 $$\n$$ (g_L + a) - g_L \\Delta_T \\cdot \\frac{1}{\\Delta_T} \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) = 0 $$\n$$ (g_L + a) = g_L \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) $$\n求解 $V_c^*$：\n$$ \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) = \\frac{g_L + a}{g_L} = 1 + \\frac{a}{g_L} $$\n$$ V_c^* = V_T + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) $$\n基电流 $I_{rheo}$ 是在 $V_c^*$ 处计算的 $I_0(V^*)$ 的值：\n$$ I_{rheo} = I_0(V_c^*) = (g_L + a)(V_c^* - E_L) - g_L \\Delta_T \\exp\\left(\\frac{V_c^* - V_T}{\\Delta_T}\\right) $$\n使用分岔条件 $g_L \\exp(\\dots) = g_L + a$，我们将其代入 $I_{rheo}$ 的表达式中：\n$$ I_{rheo} = (g_L + a)(V_c^* - E_L) - (g_L + a)\\Delta_T = (g_L + a)(V_c^* - E_L - \\Delta_T) $$\n代入 $V_c^*$ 的表达式，我们得到最终的解析公式：\n$$ I_{rheo} = (g_L + a) \\left[ \\left(V_T + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right)\\right) - E_L - \\Delta_T \\right] $$\n$$ I_{rheo} = (g_L + a) \\left[ (V_T - E_L - \\Delta_T) + \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) \\right] $$\n现在，我们使用给定的参数来计算这个表达式：\n$g_L = 10 \\times 10^{-9}\\,\\text{S}$\n$a = 2 \\times 10^{-9}\\,\\text{S}$\n$V_T = -50 \\times 10^{-3}\\,\\text{V}$\n$E_L = -70 \\times 10^{-3}\\,\\text{V}$\n$\\Delta_T = 2 \\times 10^{-3}\\,\\text{V}$\n\n首先，我们计算公式的各个组成部分：\n$$ g_L + a = 10\\,\\text{nS} + 2\\,\\text{nS} = 12\\,\\text{nS} = 12 \\times 10^{-9}\\,\\text{S} $$\n$$ V_T - E_L - \\Delta_T = (-50 \\times 10^{-3}\\,\\text{V}) - (-70 \\times 10^{-3}\\,\\text{V}) - (2 \\times 10^{-3}\\,\\text{V}) = 18 \\times 10^{-3}\\,\\text{V} $$\n$$ 1 + \\frac{a}{g_L} = 1 + \\frac{2\\,\\text{nS}}{10\\,\\text{nS}} = 1.2 $$\n$$ \\Delta_T \\ln\\left(1 + \\frac{a}{g_L}\\right) = (2 \\times 10^{-3}\\,\\text{V}) \\ln(1.2) $$\n将这些代入 $I_{rheo}$ 的表达式中：\n$$ I_{rheo} = (12 \\times 10^{-9}\\,\\text{S}) \\left[ (18 \\times 10^{-3}\\,\\text{V}) + (2 \\times 10^{-3}\\,\\text{V}) \\ln(1.2) \\right] $$\n$$ I_{rheo} = (12 \\times 10^{-9}\\,\\text{S}) \\cdot (10^{-3}\\,\\text{V}) \\cdot \\left[ 18 + 2 \\ln(1.2) \\right] $$\n使用 $\\ln(1.2) \\approx 0.1823215568$：\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot \\left[ 18 + 2 \\times 0.1823215568 \\right] $$\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot \\left[ 18 + 0.3646431136 \\right] $$\n$$ I_{rheo} = 12 \\times 10^{-12}\\,\\text{A} \\cdot 18.3646431136 $$\n$$ I_{rheo} \\approx 220.37571736 \\times 10^{-12}\\,\\text{A} = 220.37571736\\,\\text{pA} $$\n为了以纳安 (nA) 为单位表示答案，我们除以 $1000$：\n$$ I_{rheo} \\approx 0.22037571736\\,\\text{nA} $$\n四舍五入到四位有效数字，我们得到：\n$$ I_{rheo} \\approx 0.2204\\,\\text{nA} $$",
            "answer": "$$\n\\boxed{0.2204}\n$$"
        },
        {
            "introduction": "自适应指数整合发放（AdEx）模型的一个核心优势在于其能够简洁地模拟尖峰频率适应（spike-frequency adaptation）现象，即神经元在持续刺激下放电频率逐渐降低的行为。本练习将理论付诸实践，要求你编写程序来数值模拟 AdEx 模型，并量化其频率适应的程度。你将学习如何处理混合动力系统（连续动力学与离散重置事件相结合）的数值积分，并根据仿真结果计算适应比率，这对于在神经拟态硬件或大规模网络仿真中应用 AdEx 模型至关重要。",
            "id": "4034174",
            "problem": "一个单室神经元由自适应指数积分发放 (AdEx) 动力学模型建模，这是神经形态计算和类脑计算中的一种标准表述。AdEx 模型将指数膜非线性与自适应电流相结合，以捕捉尖峰频率自适应。考虑以下基于基尔霍夫电流定律的控制方程，用于描述由电流驱动的漏电电容器：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V - E_L) \\;+\\; g_L\\,\\Delta_T\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) \\;-\\; w \\;+\\; I(t),\n$$\n$$\n\\tau_w\\,\\frac{dw}{dt} \\;=\\; a\\,(V - E_L) \\;-\\; w,\n$$\n并遵循一个尖峰生成和重置规则：每当 $V$ 穿过一个尖峰检测阈值时，就会记录一个输出尖峰，膜电位 $V$ 被重置为 $V_r$，自适应变量增加 $w \\leftarrow w + b$，并且在短暂的绝对不应期 $\\tau_{\\mathrm{ref}}$ 内，$V$ 保持固定在 $V_r$，而 $w$ 继续演化。阶跃输入为：当 $t \\ge 0$ 时 $I(t) = I_0$，当 $t  0$ 时 $I(t) = 0$。\n\n所有物理量必须使用以下单位进行处理，以确保数值模拟中的量纲一致性：膜电位 $V$ 以毫伏 (mV) 为单位，时间 $t$ 以毫秒 (ms) 为单位，电容 $C$ 以纳法 (nF) 为单位，漏电导 $g_L$ 和耦合参数 $a$ 以微西门子 (μS) 为单位，电流 $I$ 和 $w$ 以纳安 (nA) 为单位。这些单位满足以下关系：当 $dV/dt$ 的单位为 mV/ms 时，$C\\,dV/dt$ 的单位为 nA；当 $V$ 的单位为 mV 时，$g_L(V-E_L)$ 的单位为 nA。\n\n您必须设计一个程序，在恒定阶跃输入下对这些方程进行数值积分，以第一个时间间隔频率与稳态频率之比来量化尖峰频率自适应。要求的输出是包含每个测试用例该比率的单行文本。使用以下固定的生物物理参数，这些参数的选择在生理上是合理的且内部一致：\n- 电容 $C = 0.2$ nF，\n- 漏电导 $g_L = 0.01$ μS，\n- 漏电反转电位 $E_L = -70$ mV，\n- 指数斜率 $\\Delta_T = 2$ mV，\n- 有效尖峰检测水平 $V_{\\mathrm{spike}} = 20$ mV，\n- 尖峰阈值参数 $V_T = -50$ mV，\n- 重置电位 $V_r = -58$ mV，\n- 不应期 $\\tau_{\\mathrm{ref}} = 2$ ms，\n- 阶跃幅度 $I_0 = 1.2$ nA，\n- 模拟时间步长 $\\Delta t = 0.05$ ms，\n- 总模拟时长 $T_{\\mathrm{end}} = 2000$ ms。\n\n初始条件为 $V(0) = E_L$ 和 $w(0) = 0$。\n\n测量量的定义：\n- 尖峰时间是 $V$ 在重置前穿过 $V_{\\mathrm{spike}}$ 的时间点。尖峰间期 (ISIs) 是尖峰时间之间的连续差值，以毫秒表示。\n- 第一个时间间隔频率定义为 $f_1 = 1000 / \\mathrm{ISI}_1$ (单位：赫兹)，其中 $\\mathrm{ISI}_1$ 是 $t = 0$ 后第一个和第二个尖峰之间的时间间隔。\n- 稳态频率定义为 $f_{\\mathrm{ss}} = 1000 / \\overline{\\mathrm{ISI}}$ (单位：赫兹)，其中 $\\overline{\\mathrm{ISI}}$ 是最后 $K$ 个 ISI 的算术平均值，这些 ISI 的第二个尖峰时间落在模拟的最后 $W$ 毫秒内。使用 $K = 10$ 和 $W = 600$ ms。如果存在的此类 ISI 少于 $K$ 个，则对该窗口中所有可用的 ISI 进行平均。如果该窗口中不存在任何 ISI，但在整个运行过程中至少发生了 10 个 ISI，则对最后 10 个 ISI 进行平均；如果总共发生的尖峰少于 2 个，则将比率设置为 $\\mathrm{NaN}$。\n- 需要报告的自适应比率是 $R = f_1 / f_{\\mathrm{ss}}$ (无量纲)。\n\n使用上述单位实现一个前向欧拉数值积分器来推进状态，执行尖峰/重置规则和不应期，并记录尖峰时间。您的程序应生成单行输出，其中包含所提供测试套件的比率，格式为方括号括起来的逗号分隔列表。\n\n待运行的参数三元组 $(a,\\tau_w,b)$ 测试套件：\n1. $(a = 0.002\\ \\mathrm{μS},\\ \\tau_w = 200\\ \\mathrm{ms},\\ b = 0.05\\ \\mathrm{nA})$，\n2. $(a = 0\\ \\mathrm{μS},\\ \\tau_w = 200\\ \\mathrm{ms},\\ b = 0.0\\ \\mathrm{nA})$，\n3. $(a = 0.004\\ \\mathrm{μS},\\ \\tau_w = 500\\ \\mathrm{ms},\\ b = 0.2\\ \\mathrm{nA})$，\n4. $(a = 0.001\\ \\mathrm{μS},\\ \\tau_w = 50\\ \\mathrm{ms},\\ b = 0.1\\ \\mathrm{nA})$。\n\n您的程序应生成单行输出，包含结果，格式为方括号括起来的逗号分隔列表（例如，\"[r1,r2,r3,r4]\"），其中每个 $r_i$ 是相应测试用例的比率 $R$，表示为浮点数。频率必须在内部以赫兹 (Hz) 计算，最终的比率是无量纲的浮点数；如果由于上述规定的尖峰数量不足而导致比率未定义，则该条目输出 $\\mathrm{NaN}$。",
            "solution": "自适应指数积分发放 (AdEx) 模型源于将基尔霍夫电流定律应用于代表神经元膜的漏电电容器。其基本原理是膜上的电流守恒：电容电流 $C\\,dV/dt$ 等于离子电流和输入电流的总和。AdEx 膜方程通过一个指数项来增强线性漏电，以捕捉尖峰的急剧起始，并引入一个自适应电流 $w$，该电流根据一个由膜电位驱动的一阶线性微分方程演化。\n\n出发点：物理定律 $C\\,\\frac{dV}{dt} = I_{\\mathrm{leak}} + I_{\\mathrm{exp}} - I_{\\mathrm{adapt}} + I_{\\mathrm{ext}}$，其中：\n- $I_{\\mathrm{leak}} = -g_L\\,(V - E_L)$ 是漏电流的欧姆定律，\n- $I_{\\mathrm{exp}} = g_L\\,\\Delta_T\\,\\exp\\!\\big((V-V_T)/\\Delta_T\\big)$ 提供了指数尖峰起始非线性，\n- $I_{\\mathrm{adapt}} = w$ 是一个抵抗去极化的动态电流，\n- $I_{\\mathrm{ext}} = I(t)$ 是外部刺激。\n\n自适应动力学遵循一个线性微分方程，该方程与类电导耦合参数 $a$ 和时间常数 $\\tau_w$ 一致：$\\tau_w\\,\\frac{dw}{dt} = a\\,(V - E_L) - w$。项 $a\\,(V - E_L)$ 将电压与自适应耦合；负 $w$ 项实现弛豫。根据经验，尖峰发放会触发 $w$ 的增量 $b$，模拟尖峰触发的自适应，并且 $V$ 被重置为 $V_r$，并伴有一个不应期 $\\tau_{\\mathrm{ref}}$，在此期间 $V$ 保持钳制在 $V_r$。这些规则在积分发放模型中是标准的，用以产生定义明确的尖峰时间。\n\n为了计算尖峰频率自适应，我们量化比率 $R = f_1 / f_{\\mathrm{ss}}$，其中 $f_1$ 是从第一个尖峰间期推断出的频率，$f_{\\mathrm{ss}}$ 是在瞬态衰减后从晚期 ISI 推断出的稳态频率。\n\n通过前向欧拉离散化的算法设计：\n1. 单位和缩放：选择 $V$ 的单位为毫伏 (mV)，$t$ 为毫秒 (ms)，$C$ 为纳法 (nF)，$g_L$ 和 $a$ 为微西门子 (μS)，$I$ 和 $w$ 为纳安 (nA)。这一选择确保了量纲的一致性，无需额外的比例因子，因为 $1\\ \\mathrm{nF}\\cdot 1\\ \\mathrm{mV}/1\\ \\mathrm{ms} = 1\\ \\mathrm{nA}$ 且 $1\\ \\mathrm{μS}\\cdot 1\\ \\mathrm{mV} = 1\\ \\mathrm{nA}$。\n2. 数值积分：用前向差分近似时间导数。对于时间步长 $\\Delta t$，更新\n$$\nV_{n+1} \\;=\\; V_n \\;+\\; \\frac{\\Delta t}{C}\\,\\Big(\\,-g_L\\,(V_n - E_L) \\;+\\; g_L\\,\\Delta_T\\,\\exp\\!\\big(\\tfrac{V_n - V_T}{\\Delta_T}\\big) \\;-\\; w_n \\;+\\; I_0 \\Big),\n$$\n$$\nw_{n+1} \\;=\\; w_n \\;+\\; \\frac{\\Delta t}{\\tau_w}\\,\\Big(a\\,(V_n - E_L) \\;-\\; w_n\\Big),\n$$\n前提是在步骤 $n$ 没有发生尖峰/重置。在绝对不应期内，强制 $V_{n+1} = V_r$，同时在 $w$ 更新方程的右侧使用 $V_n = V_r$ 继续更新 $w$。\n3. 尖峰检测和重置：更新 $V$ 后，检查是否 $V_{n+1} \\ge V_{\\mathrm{spike}}$。如果是，则在时间 $t_{n+1}$ 记录一个尖峰，设置 $V_{n+1} \\leftarrow V_r$，增加 $w_{n+1} \\leftarrow w_{n+1} + b$，并设置一个不应期计数器为 $\\tau_{\\mathrm{ref}}$，在此期间 $V$ 保持在 $V_r$，只有 $w$ 演化。对于所选的指数项，硬尖峰检测阈值是快速上升支的一个实用替代方法。\n4. 尖峰时间记录：收集发生阈值穿越的时间 $\\{t_i\\}$。计算尖峰间期为 $\\mathrm{ISI}_i = t_{i+1} - t_i$（单位：毫秒）。\n5. 频率计算：如果至少发生了两次尖峰，则设置 $f_1 = 1000 / \\mathrm{ISI}_1$（单位：赫兹）。对于稳态频率，考虑其第二个尖峰时间 $t_{i+1}$ 落在 $T_{\\mathrm{end}}$ 前最后 $W$ 毫秒窗口内的 ISI。平均最多 $K$ 个最近的此类 ISI；如果最终窗口内没有，但总体上至少有 10 个 ISI，则平均最后 10 个 ISI；如果发生的尖峰少于 2 个，则比率未定义，报告为 $\\mathrm{NaN}$。计算 $f_{\\mathrm{ss}} = 1000 / \\overline{\\mathrm{ISI}}$（单位：赫兹）。最后，计算无量纲比率 $R = f_1 / f_{\\mathrm{ss}}$。\n6. 边缘情况处理：通过强制执行绝对不应期来避免重复计数尖峰；确保在每一步都评估指数项；按规定处理尖峰不足的情况。\n\n科学原理：第一个尖峰间期反映了神经元在自适应累积之前对阶跃输入的初始响应能力。稳态频率反映了在恒定驱动下 $w$ 达到平衡后的长期发放率。比率 $R$ 量化了尖峰频率自适应：$R  1$ 表示神经元初始发放频率快于稳态；$R \\approx 1$ 表示自适应最小。\n\n测试套件的实现细节：\n- 固定的生物物理参数：$C = 0.2\\ \\mathrm{nF}$，$g_L = 0.01\\ \\mathrm{μS}$，$E_L = -70\\ \\mathrm{mV}$，$\\Delta_T = 2\\ \\mathrm{mV}$，$V_T = -50\\ \\mathrm{mV}$，$V_{\\mathrm{spike}} = 20\\ \\mathrm{mV}$，$V_r = -58\\ \\mathrm{mV}$，$\\tau_{\\mathrm{ref}} = 2\\ \\mathrm{ms}$，$I_0 = 1.2\\ \\mathrm{nA}$，$\\Delta t = 0.05\\ \\mathrm{ms}$，$T_{\\mathrm{end}} = 2000\\ \\mathrm{ms}$，最终窗口 $W = 600\\ \\mathrm{ms}$，以及最大尾部 ISI 数 $K = 10$。\n- 四个案例的参数三元组 $(a,\\tau_w,b)$ 在问题中已指定。数值积分使用这些参数能稳健地产生尖峰序列，从而能够为每个案例计算 $R$。\n\n程序将为每个测试用例执行模拟，计算自适应比率，并以所需的聚合格式打印单行文本：一个用方括号括起来的逗号分隔的浮点数列表 \"[r1,r2,r3,r4]\"。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_adex_ratio(a_uS, tau_w_ms, b_nA,\n                        C_nF=0.2, gL_uS=0.01, EL_mV=-70.0, DeltaT_mV=2.0,\n                        VT_mV=-50.0, V_spike_mV=20.0, V_reset_mV=-58.0,\n                        tau_ref_ms=2.0, I0_nA=1.2, dt_ms=0.05, T_end_ms=2000.0,\n                        window_ms=600.0, K_tail=10):\n    \"\"\"\n    Simulate the AdEx neuron and compute adaptation ratio R = f1 / f_ss.\n\n    Units:\n      - V in mV, t in ms, C in nF, gL  a in uS, I and w in nA.\n    \"\"\"\n\n    # Time setup\n    n_steps = int(np.round(T_end_ms / dt_ms))\n    t = 0.0\n\n    # State variables\n    V = EL_mV\n    w = 0.0\n    ref_time_left = 0.0\n\n    spike_times = []\n\n    # Simulation loop\n    for step in range(n_steps):\n        # During refractory: hold V at reset, update w using V_reset\n        if ref_time_left > 0.0:\n            # Update w during refractory\n            dw = (dt_ms / tau_w_ms) * (a_uS * (V_reset_mV - EL_mV) - w)\n            w += dw\n            V = V_reset_mV\n            ref_time_left = max(0.0, ref_time_left - dt_ms)\n            t += dt_ms\n            continue\n\n        # Compute membrane equation with forward Euler\n        # Currents (nA): -gL*(V-EL) + gL*DeltaT*exp((V-VT)/DeltaT) - w + I0\n        I_leak = -gL_uS * (V - EL_mV)\n        I_exp = gL_uS * DeltaT_mV * np.exp((V - VT_mV) / DeltaT_mV)\n        I_total = I_leak + I_exp - w + I0_nA\n\n        dV = (dt_ms / C_nF) * I_total\n        V_next = V + dV\n\n        # Update adaptation variable w (forward Euler, using current V)\n        dw = (dt_ms / tau_w_ms) * (a_uS * (V - EL_mV) - w)\n        w_next = w + dw\n\n        # Spike detection after update\n        if V_next >= V_spike_mV:\n            # Register spike at time t + dt_ms (end of step)\n            spike_time = t + dt_ms\n            spike_times.append(spike_time)\n            # Reset and refractory\n            V = V_reset_mV\n            w = w_next + b_nA\n            ref_time_left = tau_ref_ms\n            t += dt_ms\n            continue\n        else:\n            V = V_next\n            w = w_next\n            t += dt_ms\n\n    # Compute inter-spike intervals (ISIs) in ms\n    spike_times = np.array(spike_times, dtype=float)\n    if spike_times.size  2:\n        return float('nan')\n    isis = np.diff(spike_times)\n\n    # First-interval frequency f1 in Hz\n    isi1_ms = isis[0]\n    f1_hz = 1000.0 / isi1_ms if isi1_ms > 0.0 else float('nan')\n\n    # Steady-state frequency: average of last K_tail ISIs with second spike time in final window\n    # Identify ISIs by their ending spike times t_{i+1}\n    end_times = spike_times[1:]\n    in_window = end_times >= (T_end_ms - window_ms)\n    tail_isis = isis[in_window]\n    if tail_isis.size == 0:\n        # If none in window, but at least 10 ISIs total, take last 10 ISIs\n        if isis.size >= 10:\n            tail_isis = isis[-10:]\n        else:\n            # If fewer than 10, take all available ISIs beyond the first (to avoid initial transient bias)\n            tail_isis = isis[-min(isis.size, K_tail):]\n    else:\n        # If more than K_tail in window, take the last K_tail\n        if tail_isis.size > K_tail:\n            tail_isis = tail_isis[-K_tail:]\n\n    if tail_isis.size == 0:\n        return float('nan')\n\n    mean_tail_isi_ms = float(np.mean(tail_isis))\n    fss_hz = 1000.0 / mean_tail_isi_ms if mean_tail_isi_ms > 0.0 else float('nan')\n\n    if not np.isfinite(f1_hz) or not np.isfinite(fss_hz) or fss_hz == 0.0:\n        return float('nan')\n\n    R = f1_hz / fss_hz\n    return float(R)\n\ndef solve():\n    # Define the test cases from the problem statement: (a (uS), tau_w (ms), b (nA))\n    # Corrected units: gL is 10nS = 0.01uS, a is in nS, converted to uS\n    test_cases = [\n        (0.002, 200.0, 0.05),\n        (0.0,   200.0, 0.0),\n        (0.004, 500.0, 0.2),\n        (0.001, 50.0,  0.1),\n    ]\n\n    results = []\n    # gL = 10 nS is equivalent to 0.01 uS\n    gL_uS_val = 0.01\n\n    for a, tauw, b in test_cases:\n        # The 'a' parameter is now passed in uS, matching the code's expectation\n        ratio = simulate_adex_ratio(a_uS=a, tau_w_ms=tauw, b_nA=b, gL_uS=gL_uS_val)\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    # Convert floats to string, preserving 'nan' if present.\n    def fmt(x):\n        if np.isnan(x):\n            return \"nan\"\n        else:\n            return repr(float(x))\n    print(f\"[{','.join(fmt(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "一个优秀的建模者不仅要会使用模型，更要理解其能力的边界。虽然标准的双变量 AdEx 模型能很好地模拟适应性放电，但它能否产生更复杂的放电模式，如簇状放电（bursting）？本练习将引导你从慢快动力系统的角度进行批判性思考，分析为什么标准的 AdEx 模型无法产生某些类型的簇状放电，并探索需要引入何种最小扩展（如额外的慢变量）才能重现这种复杂的动力学行为。这项练习旨在培养你对神经元模型进行批判性评估和理论扩展的能力。",
            "id": "4034177",
            "problem": "在神经形态和类脑计算中，一种常用的高级神经元模型是自适应指数积分-发放 (AdEx) 模型。它在膜方程中结合了一个指数尖峰起始项和一个提供负反馈的适应性电流。膜被建模为一个电阻-电容 (RC) 电路，电容为 $C$，漏电导为 $g_L$，由一个恒定的外部电流 $I_{\\text{ext}}$ 驱动。适应性电流是一种外向的、类似钾离子的电流，具有慢时间常数 $\\tau_w$、阈下耦合 $a$ 和尖峰触发的增量 $b$；每次尖峰后，电压被重置，并施加适应性增量。在恒定的 $I_{\\text{ext}}$ 下，这产生了一个混合动力系统，其中包含一个快变量（膜电压 $V$）和一个慢变量（适应性变量 $w$）。\n\n在恒定输入下，确定性簇发放需要快速重复性尖峰发放和静息的交替时期，这由兴奋性的慢调制介导。从快慢动力系统的角度来看，方波簇发放的最小机制涉及一个慢变量，该慢变量通过滞后跃迁（通常通过快子系统中的不变圆上的鞍节点分岔或亚临界霍普夫分岔）驱动快子系统在不同的吸引子（一个稳定静息态和一个稳定尖峰发放机制）之间转换。用生物物理学的术语来说，稳健的方波簇发放除了慢负反馈（适应性）之外，通常还需要慢正反馈（一个再生性慢内向电流）。\n\n考虑上述标准的双变量 AdEx 模型，其参数满足 $a \\ge 0$ 和 $b \\ge 0$（纯外向的、类似适应性的反馈），且时间尺度排序为 $\\tau_m \\ll \\tau_w$，其中 $\\tau_m = C/g_L$ 是膜时间常数。神经元由一个恒定的电流 $I_{\\text{ext}}$ 驱动，该电流被选择在无适应性模型的基电流之上。从 RC 膜动力学、时间尺度分离和快子系统分岔结构的第一性原理出发，分析一个参数区域，在该区域内，AdEx 模型在没有额外电流的情况下无法复现确定性的方波簇发放。然后，选择一个最小的扩展，通过引入一个额外的慢变量来恢复方波簇发放动力学，并为该扩展指定适当的定性时间尺度和符号条件，以使快子系统在慢变量范围内表现出所需的双稳态。\n\n哪个选项正确地指出了一个失效区域和一个能在恒定 $I_{\\text{ext}}$ 下产生稳健方波簇发放的最小扩展？\n\nA. 当 $a \\ge 0$，$b  0$ 且 $\\tau_w \\gg \\tau_m$ 时，对于任何能够支持平台期的固定 $w$，双变量 AdEx 模型的快子系统都缺少一个去极化的稳定静息分支；因此，仅靠纯外向的适应性无法在恒定 $I_{\\text{ext}}$ 下产生方波簇发放。通过增加一个慢内向电流 $I_s = g_s s (E_s - V)$（其中 $E_s$ 高于静息电压），其门控动力学为 $\\tau_s \\,\\frac{ds}{dt} = s_\\infty(V) - s$，时间尺度为 $\\tau_s \\gg \\tau_w \\gg \\tau_m$，可以在快子系统中产生滞后跃迁并产生方波簇发放。\n\nB. 在原始的双变量 AdEx 模型中，将指数斜率参数 $\\Delta_T$ 变得极小并将尖峰阈值 $V_T$ 提得非常高，可以在快子系统中诱导出双稳态；因此不需要额外的慢电流，对于任何高于基电流的 $I_{\\text{ext}}$ 都会发生稳健的方波簇发放。\n\nC. 增加第二个代表钠激活 $m$ 的快变量，其动力学在膜时间尺度（即 $\\tau_m$ 数量级）上是足够的；快-快相互作用通过拍频产生簇发放，因此除了 $w$ 之外不需要其他慢变量。\n\nD. 在双变量 AdEx 模型中，设置 $a = 0$，同时增大 $b$ 并使 $\\tau_w$ 非常大，可以保证对于任何高于基电流的固定 $I_{\\text{ext}}$ 都会产生周期性的方波簇发放；因此不需要额外的内向电流。",
            "solution": "该问题要求从快慢动力系统的角度分析标准双变量AdEx模型的局限性，并确定产生稳健方波簇发放所需的最小扩展。\n\n**双变量AdEx模型的局限性分析**\n\n标准AdEx模型有两个变量：快变量 $V$ (膜电位) 和慢变量 $w$ (适应性电流)。要理解其动力学，我们分析快子系统（$V$ 的动力学），并将慢变量 $w$ 视为一个固定参数。快子系统的平衡态（不动点）由 $dV/dt=0$ 决定，这定义了相平面中的V-零增长线。对于AdEx模型，这条零增长线是N形的。这意味着对于给定的有效输入电流，系统最多可以有两个不动点：一个稳定的（在下支）和一个不稳定的（在中间支）。\n\n当有效输入电流（由 $I_{\\text{ext}} - w$ 决定）增加时，系统从静息态（稳定的不动点）过渡到放电态（稳定的极限环）。在AdEx模型中，这种转变通常通过不变圆上的鞍节点（Saddle-Node on Invariant Circle, SNIC）分岔发生。关键在于，SNIC分岔是非滞后性的。也就是说，从静息到放电的转变点与从放电回到静息的转变点是同一个点。系统不存在一个参数区域，使得稳定的静息态和稳定的放电态能够共存（即双稳态）。\n\n然而，经典的方波簇发放（square-wave bursting）机制恰恰依赖于这种双稳态和滞后现象。它要求快子系统在慢变量的某个范围内，同时拥有一个稳定的静息态（对应簇间静息期）和一个稳定的放电态（对应簇内尖峰发放）。慢变量的变化将驱动快子系统在这两个稳定态之间来回跳跃，形成簇放电。由于标准的双变量AdEx模型缺乏这种内在的双稳态结构，它无法产生经典的方波簇发放。\n\n**寻找最小扩展**\n\n为了在模型中引入双稳态和滞后，我们需要从根本上改变快子系统的分岔结构。实现这一目标的标准方法是引入第二个慢变量，该变量提供慢的正反馈。这会改变V-零增长线的形状，从N形变为Z形（或类三次函数形）。Z形零增长线的上支和下支都是稳定的，代表了去极化的稳定平台期和超极化的稳定静息态，而中间支是不稳定的。\n\n一个生物物理上合理的实现是增加一个慢的、电压依赖的内向电流，例如钙电流或持续性钠电流。该电流提供慢的正反馈：当电压去极化时，它会缓慢激活，导致更多内向电流，从而进一步维持去极化。\n\n这导致一个三变量模型，包含：\n1.  一个快变量 $V$（膜电位）。\n2.  一个中等时间尺度的慢负反馈变量 $w$（适应性）。\n3.  一个更慢时间尺度的慢正反馈变量 $s$（例如，慢内向电流的门控变量）。\n\n时间尺度的分离至关重要，典型的排序是：膜时间常数 $\\tau_m \\ll$ 适应时间常数 $\\tau_w \\ll$ 慢正反馈时间常数 $\\tau_s$。这种结构是产生稳健方波簇发放的最小动力学核心。\n\n**选项评估**\n\n*   **A**: 该选项正确地指出了双变量AdEx模型缺少产生方波簇发放所需的滞后双稳态结构。它提出的解决方案——增加一个比适应性电流更慢的慢内向电流——正是创建所需Z形零增长线和滞后现象的经典、最小的扩展。时间尺度排序 $\\tau_s \\gg \\tau_w \\gg \\tau_m$ 也是正确的。因此，这个选项是正确的。\n*   **B**: 调整 $\\Delta_T$ 和 $V_T$ 只会改变尖峰起始的特性，并不会改变V-零增长线的整体拓扑结构来创造双稳态。这个说法是错误的。\n*   **C**: 增加另一个快变量无法提供簇发放所需的慢时间尺度调制。簇发放本质上是快慢动力学相互作用的结果。这个说法是错误的。\n*   **D**: 在 $a=0$、大 $b$ 和大 $\\tau_w$ 的参数区域，AdEx模型可以产生一种“适应性诱导”的簇发放，但这不是经典的方波簇发放。它不依赖于去极化平台期，其机制与选项A描述的滞后双稳态机制不同。因此，这个选项不正确，因为它无法产生问题中所指的稳健“方波”簇发放。\n\n综上所述，选项A最准确地描述了标准AdEx模型的局限性以及恢复方波簇发放的最小理论扩展。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}