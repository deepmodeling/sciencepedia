{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of understanding any neuron model is deriving its input-output relationship, often called the F-I curve. This first practice grounds the Leaky Integrate-and-Fire (LIF) model in its physical basis as an RC circuit and guides you through the fundamental analytical derivation of its steady-state firing rate in response to a constant input current. Mastering this derivation provides the essential mathematical foundation for analyzing and predicting the behavior of single LIF neurons .",
            "id": "4049955",
            "problem": "Consider a single-compartment Leaky Integrate-and-Fire (LIF) neuron driven by a constant input current. The membrane voltage obeys Kirchhoff’s current law combining the capacitive current and the leak current, leading to the first-order linear differential equation $C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$, where $C$ is the membrane capacitance, $g_{L}$ is the leak conductance, $E_{L}$ is the leak reversal potential, and $I_{0}$ is a constant input current. A spike is emitted when $V(t)$ reaches the threshold $V_{\\text{th}}$, upon which the voltage is instantaneously reset to $V_{r}$ and held there for an absolute refractory period $t_{\\text{ref}}$ before dynamics resume. Assume repeated, stationary spiking under constant drive.\n\nStarting only from the physical law stated above and the initial condition at the onset of each cycle $V(0)=V_{r}$, derive the closed-form expression for the steady-state firing rate as a function of the constant current $I_{0}$ and the neuron parameters. Then, using that expression, compute the firing rate for the following parameter values:\n- $C=250\\,\\text{pF}$,\n- $g_{L}=12.5\\,\\text{nS}$,\n- $E_{L}=-65\\,\\text{mV}$,\n- $V_{\\text{th}}=-50\\,\\text{mV}$,\n- $V_{r}=-65\\,\\text{mV}$,\n- $I_{0}=0.75\\,\\text{nA}$,\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$.\n\nExpress the final rate in $\\text{Hz}$ and round your answer to four significant figures. Ensure that the derivation begins from the stated differential equation and proceeds by first principles without invoking target-formula shortcuts.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the governing differential equation for the membrane voltage $V(t)$:\n$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$\n\nThe parameters and conditions are:\n- $C$: membrane capacitance\n- $g_{L}$: leak conductance\n- $E_{L}$: leak reversal potential\n- $I_{0}$: a constant input current\n- $V_{\\text{th}}$: threshold voltage\n- $V_{r}$: reset voltage\n- $t_{\\text{ref}}$: absolute refractory period\n\nThe initial condition for the integration phase of each cycle is $V(0)=V_{r}$.\n\nThe numerical values for the parameters are:\n- $C=250\\,\\text{pF}$\n- $g_{L}=12.5\\,\\text{nS}$\n- $E_{L}=-65\\,\\text{mV}$\n- $V_{\\text{th}}=-50\\,\\text{mV}$\n- $V_{r}=-65\\,\\text{mV}$\n- $I_{0}=0.75\\,\\text{nA}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem describes the Leaky Integrate-and-Fire (LIF) model, a standard and fundamental model in computational neuroscience. The governing equation is a direct application of Kirchhoff's current law to an RC circuit, which is a valid physical analogy for a simple neuron model. All concepts are well-established within the relevant scientific field.\n2.  **Well-Posed:** The problem provides a first-order linear ordinary differential equation with a clear initial condition. The dynamics of spiking and reset are explicitly defined. The task is to derive a closed-form expression and then compute a numerical value, both of which are achievable from the given information. A unique solution for the firing rate exists, provided the input current is sufficient to drive the voltage to threshold.\n3.  **Objective:** The language is formal and precise. The parameters are given with specific numerical values and units. The question is unambiguous.\n4.  **Completeness:** The problem is self-contained. All necessary parameters and conditions to solve for the firing rate are provided.\n5.  **Consistency:** The parameters and their units are consistent. For instance, capacitance is in Farads, conductance in Siemens, potential in Volts, current in Amperes, and time in seconds (after conversion from prefixes). There are no contradictions in the setup.\n6.  **Realism:** The parameter values are typical for a biological neuron model.\n\n### Step 3: Verdict and Action\nThe first step is to solve the differential equation for the membrane potential $V(t)$. The given equation is:\n$$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$$\nWe can rearrange this equation by dividing by $g_{L}$:\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -\\big(V(t)-E_{L}\\big) + \\frac{I_{0}}{g_{L}}$$\nLet us define the membrane time constant $\\tau_{m} = C/g_{L}$ and the steady-state voltage (or reversal potential of the total current) $V_{\\infty} = E_{L} + I_{0}/g_{L}$. Substituting these into the equation gives:\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L} - \\frac{I_{0}}{g_{L}}) = -(V - V_{\\infty})$$\nThis is a first-order linear ordinary differential equation. We can solve it by separation of variables:\n$$\\frac{dV}{V-V_{\\infty}} = -\\frac{dt}{\\tau_{m}}$$\nWe integrate this equation. The voltage starts at the reset potential $V_{r}$ at time $t=0$ (this time marks the end of the refractory period) and increases until it reaches the threshold $V_{\\text{th}}$ at a time we'll call $t_{\\text{charge}}$.\n$$\\int_{V_{r}}^{V_{\\text{th}}} \\frac{dV}{V-V_{\\infty}} = \\int_{0}^{t_{\\text{charge}}} -\\frac{dt}{\\tau_{m}}$$\n$$[\\ln|V-V_{\\infty}|]_{V_{r}}^{V_{\\text{th}}} = [-\\frac{t}{\\tau_{m}}]_{0}^{t_{\\text{charge}}}$$\nFor the neuron to spike, the steady-state voltage $V_{\\infty}$ must be greater than the threshold voltage $V_{\\text{th}}$. Given that $V_{\\text{th}} > V_{r}$ typically, we have $V_{\\infty} > V_{\\text{th}} > V_{r}$. Therefore, both $V-V_{\\infty}$ terms in the integration limits are negative, and their absolute value is $V_{\\infty}-V$.\n$$\\ln(V_{\\infty}-V_{\\text{th}}) - \\ln(V_{\\infty}-V_{r}) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n$$\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\nSolving for the charging time $t_{\\text{charge}}$:\n$$t_{\\text{charge}} = -\\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\nThis expression for $t_{\\text{charge}}$ is valid if and only if $V_{\\infty} > V_{\\text{th}}$, which is equivalent to the condition $E_{L} + I_{0}/g_{L} > V_{\\text{th}}$, or $I_{0} > g_{L}(V_{\\text{th}} - E_{L})$. If this condition is not met, the neuron will never spike.\n\nThe total time for one cycle, the inter-spike interval ($T_{\\text{ISI}}$), is the sum of the charging time $t_{\\text{charge}}$ and the absolute refractory period $t_{\\text{ref}}$.\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = t_{\\text{ref}} + \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\nThe steady-state firing rate $f$ is the reciprocal of the inter-spike interval, $f = 1/T_{\\text{ISI}}$.\nSubstituting the expressions for $\\tau_{m}$ and $V_{\\infty}$:\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{(E_{L} + I_{0}/g_{L}) - V_{r}}{(E_{L} + I_{0}/g_{L}) - V_{\\text{th}}}\\right)\\right]^{-1}$$\nThis is the closed-form expression for the firing rate. This can be rewritten by rearranging the terms inside the logarithm:\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{I_{0} + g_{L}(E_{L} - V_{r})}{I_{0} + g_{L}(E_{L} - V_{\\text{th}})}\\right)\\right]^{-1}$$\n\nNow, we compute the numerical value using the given parameters. First, we convert all parameters to base SI units:\n- $C=250\\,\\text{pF} = 250 \\times 10^{-12}\\,\\text{F}$\n- $g_{L}=12.5\\,\\text{nS} = 12.5 \\times 10^{-9}\\,\\text{S}$\n- $E_{L}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $V_{\\text{th}}=-50\\,\\text{mV} = -0.050\\,\\text{V}$\n- $V_{r}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $I_{0}=0.75\\,\\text{nA} = 0.75 \\times 10^{-9}\\,\\text{A}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms} = 1.5 \\times 10^{-3}\\,\\text{s}$\n\nWe calculate the intermediate values $\\tau_m$ and $V_{\\infty}$:\n$$\\tau_{m} = \\frac{C}{g_{L}} = \\frac{250 \\times 10^{-12}\\,\\text{F}}{12.5 \\times 10^{-9}\\,\\text{S}} = 20 \\times 10^{-3}\\,\\text{s} = 0.02\\,\\text{s}$$\n$$V_{\\infty} = E_{L} + \\frac{I_{0}}{g_{L}} = -0.065\\,\\text{V} + \\frac{0.75 \\times 10^{-9}\\,\\text{A}}{12.5 \\times 10^{-9}\\,\\text{S}} = -0.065\\,\\text{V} + 0.06\\,\\text{V} = -0.005\\,\\text{V}$$\n\nLet's check the firing condition: Is $V_{\\infty} > V_{\\text{th}}$?\n$-0.005\\,\\text{V} > -0.050\\,\\text{V}$. The condition is met, so the neuron will fire.\n\nNow, we calculate $t_{\\text{charge}}$. Note that since $V_r = E_L$, the term $g_L(E_L - V_r)$ in the more general derived formula is zero.\n$$t_{\\text{charge}} = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{-0.005\\,\\text{V} - (-0.065\\,\\text{V})}{-0.005\\,\\text{V} - (-0.050\\,\\text{V})}\\right)$$\n$$t_{\\text{charge}} = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{0.060\\,\\text{V}}{0.045\\,\\text{V}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\nUsing the value $\\ln(4/3) \\approx 0.287682$:\n$$t_{\\text{charge}} \\approx 0.02 \\times 0.287682\\,\\text{s} \\approx 0.00575364\\,\\text{s}$$\nNext, we calculate the total inter-spike interval $T_{\\text{ISI}}$:\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = 1.5 \\times 10^{-3}\\,\\text{s} + 0.00575364\\,\\text{s} = 0.0015\\,\\text{s} + 0.00575364\\,\\text{s} = 0.00725364\\,\\text{s}$$\nFinally, we compute the firing rate $f$:\n$$f = \\frac{1}{T_{\\text{ISI}}} = \\frac{1}{0.00725364\\,\\text{s}} \\approx 137.862\\,\\text{Hz}$$\nRounding the result to four significant figures gives $137.9\\,\\text{Hz}$.",
            "answer": "$$\\boxed{137.9}$$"
        },
        {
            "introduction": "While a simplified current injection is useful for analysis, real neurons receive input through synapses that modulate ion channels, changing the membrane's conductance. This exercise explores the crucial biophysical distinction between abstract current-based synapses and more realistic conductance-based synapses. By comparing their effects on the neuron's subthreshold properties, you will gain insight into how synaptic inputs can dynamically alter a neuron's effective time constant and integrative behavior, a concept central to phenomena like shunting inhibition .",
            "id": "4049958",
            "problem": "A single-compartment Leaky Integrate-and-Fire (LIF) neuron is modeled by the membrane equation $C_m \\,\\dfrac{dV}{dt} = -g_L \\,\\big(V - E_L\\big) + I_{\\text{syn}}(t)$, where $C_m$ is the membrane capacitance, $g_L$ is the leak conductance, $E_L$ is the leak reversal potential, and $I_{\\text{syn}}(t)$ is the synaptic input current. Two synapse models are compared under a constant excitatory drive over a time window in which the neuron remains subthreshold: (i) a current-based synapse that injects membrane-potential-independent current, and (ii) a conductance-based synapse that changes the total membrane conductance and drives the membrane toward an excitatory reversal potential. In the conductance-based case, the synaptic current obeys the standard biophysical form $I_{\\text{syn}}(t) = g_{\\text{syn}}(t)\\,\\big(E_{\\text{exc}} - V(t)\\big)$, with $g_{\\text{syn}}(t)$ the synaptic conductance and $E_{\\text{exc}}$ the excitatory reversal potential.\n\nConsider a constant input scenario with parameters $C_m = 200$ pF, $g_L = 100$ nS, $E_L = -70$ mV. In the current-based case, the synapse delivers a constant current $\\bar{I} = 350$ pA. In the conductance-based case, the synaptic conductance is held constant at $\\bar{g} = 5$ nS with $E_{\\text{exc}} = 0$ mV. Assume the neuron remains below threshold so that the subthreshold linear dynamics and steady states are well-defined, and spike generation can be neglected in this comparison.\n\nWhich option correctly characterizes the steady-state membrane potential and effective membrane time constant under the two synapse models?\n\nA. Under the current-based synapse, the steady-state membrane potential is approximately $-66.5$ mV and the effective membrane time constant remains $2.0$ ms; under the conductance-based synapse, the steady-state membrane potential is approximately $-66.67$ mV and the effective membrane time constant decreases to approximately $1.90$ ms.\n\nB. Under the conductance-based synapse, the steady-state membrane potential is approximately $-65.0$ mV and the effective membrane time constant remains $2.0$ ms because the excitatory reversal potential is $0$ mV.\n\nC. Under the current-based synapse, the steady-state membrane potential is approximately $-66.67$ mV and the effective membrane time constant decreases to approximately $1.90$ ms, while under the conductance-based synapse the time constant remains $2.0$ ms.\n\nD. Matching the synaptic drive at $V = E_L$ guarantees that the current-based and conductance-based synapses produce identical steady-state membrane potentials and identical effective membrane time constants.\n\nE. Conductance-based synapses can never change the effective membrane time constant in the LIF model because the leak dominates subthreshold dynamics.",
            "solution": "The analysis will be conducted for each of the two synapse models. The fundamental equation for the LIF neuron is:\n$C_m \\frac{dV}{dt} = -g_L(V - E_L) + I_{\\text{syn}}(t)$\n\nThis equation can be rewritten in the general form $\\tau_{\\text{eff}} \\frac{dV}{dt} = -V + V_{\\infty}$, where $\\tau_{\\text{eff}}$ is the effective membrane time constant and $V_{\\infty}$ is the steady-state membrane potential ($V_{\\text{ss}}$).\n\n**Case (i): Current-Based Synapse**\nIn this case, the synaptic input is a constant current, $I_{\\text{syn}}(t) = \\bar{I}$.\nThe membrane equation becomes:\n$C_m \\frac{dV}{dt} = -g_L(V - E_L) + \\bar{I}$\n$C_m \\frac{dV}{dt} = -g_L V + g_L E_L + \\bar{I}$\n\nTo find the effective time constant, we rearrange the equation:\n$\\frac{C_m}{g_L} \\frac{dV}{dt} = -V + \\left(E_L + \\frac{\\bar{I}}{g_L}\\right)$\nFrom this standard form, the effective time constant $\\tau_{\\text{eff}}^{(i)}$ is the coefficient of the derivative term:\n$\\tau_{\\text{eff}}^{(i)} = \\frac{C_m}{g_L}$\nPlugging in the given values:\n$C_m = 200 \\times 10^{-12} \\text{ F}$\n$g_L = 100 \\times 10^{-9} \\text{ S}$\n$\\tau_{\\text{eff}}^{(i)} = \\frac{200 \\times 10^{-12} \\text{ F}}{100 \\times 10^{-9} \\text{ S}} = 2.0 \\times 10^{-3} \\text{ s} = 2.0 \\text{ ms}$\nIn the current-based model, the effective time constant is identical to the intrinsic membrane time constant and is not altered by the input current.\n\nThe steady-state membrane potential $V_{\\text{ss}}^{(i)}$ is found by setting $\\frac{dV}{dt}=0$:\n$0 = -g_L(V_{\\text{ss}}^{(i)} - E_L) + \\bar{I}$\n$V_{\\text{ss}}^{(i)} = E_L + \\frac{\\bar{I}}{g_L}$\nUsing the given values:\n$E_L = -70 \\text{ mV}$\n$\\bar{I} = 350 \\text{ pA} = 350 \\times 10^{-12} \\text{ A}$\n$\\frac{\\bar{I}}{g_L} = \\frac{350 \\times 10^{-12} \\text{ A}}{100 \\times 10^{-9} \\text{ S}} = 3.5 \\times 10^{-3} \\text{ V} = 3.5 \\text{ mV}$\n$V_{\\text{ss}}^{(i)} = -70 \\text{ mV} + 3.5 \\text{ mV} = -66.5 \\text{ mV}$\n\n**Case (ii): Conductance-Based Synapse**\nIn this case, the synaptic input is $I_{\\text{syn}}(t) = \\bar{g}(E_{\\text{exc}} - V)$, where $\\bar{g}$ is a constant conductance.\nThe membrane equation is:\n$C_m \\frac{dV}{dt} = -g_L(V - E_L) + \\bar{g}(E_{\\text{exc}} - V)$\nWe collect terms involving $V$:\n$C_m \\frac{dV}{dt} = -g_L V + g_L E_L + \\bar{g} E_{\\text{exc}} - \\bar{g} V$\n$C_m \\frac{dV}{dt} = -(g_L + \\bar{g})V + (g_L E_L + \\bar{g} E_{\\text{exc}})$\n\nLet the total conductance be $g_{\\text{tot}} = g_L + \\bar{g}$.\n$C_m \\frac{dV}{dt} = -g_{\\text{tot}} V + (g_L E_L + \\bar{g} E_{\\text{exc}})$\nRearranging into the standard form:\n$\\frac{C_m}{g_{\\text{tot}}} \\frac{dV}{dt} = -V + \\frac{g_L E_L + \\bar{g} E_{\\text{exc}}}{g_{\\text{tot}}}$\n\nThe effective time constant $\\tau_{\\text{eff}}^{(ii)}$ is:\n$\\tau_{\\text{eff}}^{(ii)} = \\frac{C_m}{g_{\\text{tot}}} = \\frac{C_m}{g_L + \\bar{g}}$\nUsing the given values:\n$\\bar{g} = 5 \\text{ nS} = 5 \\times 10^{-9} \\text{ S}$\n$g_{\\text{tot}} = 100 \\times 10^{-9} \\text{ S} + 5 \\times 10^{-9} \\text{ S} = 105 \\times 10^{-9} \\text{ S}$\n$\\tau_{\\text{eff}}^{(ii)} = \\frac{200 \\times 10^{-12} \\text{ F}}{105 \\times 10^{-9} \\text{ S}} \\approx 1.90476 \\times 10^{-3} \\text{ s} \\approx 1.90 \\text{ ms}$\nThe addition of the synaptic conductance increases the total membrane conductance, thereby decreasing the effective membrane time constant.\n\nThe steady-state membrane potential $V_{\\text{ss}}^{(ii)}$ is the constant term on the right-hand side:\n$V_{\\text{ss}}^{(ii)} = \\frac{g_L E_L + \\bar{g} E_{\\text{exc}}}{g_L + \\bar{g}}$\nUsing the given values in units of nS and mV:\n$g_L = 100 \\text{ nS}, E_L = -70 \\text{ mV}, \\bar{g} = 5 \\text{ nS}, E_{\\text{exc}} = 0 \\text{ mV}$\n$V_{\\text{ss}}^{(ii)} = \\frac{(100 \\text{ nS})(-70 \\text{ mV}) + (5 \\text{ nS})(0 \\text{ mV})}{100 \\text{ nS} + 5 \\text{ nS}}$\n$V_{\\text{ss}}^{(ii)} = \\frac{-7000}{105} \\text{ mV} \\approx -66.666... \\text{ mV} \\approx -66.67 \\text{ mV}$\n\n**Summary of Results:**\n-   **Current-based:** $V_{\\text{ss}} = -66.5$ mV, $\\tau_{\\text{eff}} = 2.0$ ms.\n-   **Conductance-based:** $V_{\\text{ss}} \\approx -66.67$ mV, $\\tau_{\\text{eff}} \\approx 1.90$ ms.\n\n**Option-by-Option Analysis**\n\nA. Under the current-based synapse, the steady-state membrane potential is approximately $-66.5$ mV and the effective membrane time constant remains $2.0$ ms; under the conductance-based synapse, the steady-state membrane potential is approximately $-66.67$ mV and the effective membrane time constant decreases to approximately $1.90$ ms.\nThis option precisely matches all four calculated values.\n\nB. Under the conductance-based synapse, the steady-state membrane potential is approximately $-65.0$ mV and the effective membrane time constant remains $2.0$ ms because the excitatory reversal potential is $0$ mV.\nThis is incorrect. The calculated potential and time constant are different.\n\nC. Under the current-based synapse, the steady-state membrane potential is approximately $-66.67$ mV and the effective membrane time constant decreases to approximately $1.90$ ms, while under the conductance-based synapse the time constant remains $2.0$ ms.\nThis option incorrectly swaps the results between the two models.\n\nD. Matching the synaptic drive at $V = E_L$ guarantees that the current-based and conductance-based synapses produce identical steady-state membrane potentials and identical effective membrane time constants.\nThis is incorrect. The drives are indeed matched at $V=E_L$, but the calculations show that the steady-state potentials and effective time constants are not identical.\n\nE. Conductance-based synapses can never change the effective membrane time constant in the LIF model because the leak dominates subthreshold dynamics.\nThis statement is fundamentally incorrect. A conductance-based synapse always adds its conductance to the total membrane conductance, thereby changing the effective time constant.\n\nThus, option A is the only correct choice.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Analytical solutions for neuron models are typically only available for highly simplified scenarios. To study more realistic situations, such as neurons receiving complex, time-varying inputs within a network, we must turn to numerical simulation. This practice bridges the gap between the continuous-time differential equation of the LIF model and the discrete-time algorithms required for its implementation on a computer. You will derive, implement, and analyze the stability of several fundamental integration schemes, providing you with the practical skills needed to build reliable computational models of neural dynamics .",
            "id": "4049957",
            "problem": "Consider the Leaky Integrate-and-Fire (LIF) neuron model as an idealized resistor-capacitor circuit driven by an external current. The membrane is modeled as a capacitor of capacitance $C$ in parallel with a leak conductance $g_L$ and a reversal (leak) potential $E_L$. By Kirchhoff’s current law and the constitutive relations for capacitors and resistors, the membrane potential $V(t)$ satisfies\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V(t)-E_L) \\;+\\; I(t),\n$$\nwhere $I(t)$ is the applied input current. Define the membrane time constant $\\tau \\equiv \\frac{C}{g_L}$ and the leak resistance $R \\equiv \\frac{1}{g_L} = \\frac{\\tau}{C}$. Throughout, express membrane potentials in volts, time in seconds, capacitance in farads, conductance in siemens, resistance in ohms, and current in amperes.\n\nYour task is to start from these fundamental circuit laws and, without assuming any pre-given integration formulas, derive and implement three discrete-time numerical integration schemes for advancing the membrane potential over a fixed time step $h$ under the assumption that $I(t)$ is piecewise constant over each step:\n- Forward Euler (FE).\n- Backward Euler (BE).\n- Exact discretization under piecewise-constant input, also known as Exponential Euler (EE).\n\nIn addition to computing the membrane potential trajectory, analyze the linear stability of each scheme in the homogeneous case (that is, with $I(t)$ held constant over the step so that the deviation from the instantaneous fixed point is governed by a scalar amplification factor). For each scheme, define the homogeneous amplification factor $a$ as the scalar multiplier that maps the deviation from the fixed point at step $k$ to the deviation at step $k+1$. A scheme is asymptotically stable if and only if $\\lvert a \\rvert < 1$. Derive $a$ for each scheme from first principles and use it to produce a boolean stability verdict for each parameter set.\n\nImplement a program that, for each test case below, simulates the membrane potential from initial condition $V(0)=V_0$ for a total duration $T$ using the three schemes with a uniform time step $h$. Assume that $I(t)$ is constant and equal to the specified amplitude over the entire simulation window for each test. For each test case, report:\n- The final membrane potentials after the last step for Forward Euler, Backward Euler, and Exact discretization, respectively.\n- The boolean asymptotic stability verdict for Forward Euler, Backward Euler, and Exact discretization, determined solely by the homogeneous amplification factor for the given $h$ and $\\tau$.\n\nRound all reported membrane potentials to $6$ decimal places. The boolean stability verdicts must be computed using the strict inequality $\\lvert a \\rvert < 1$.\n\nUse the following scientifically plausible test suite of parameter values:\n- Test case $1$ (happy path, small step): $C = 200\\times 10^{-12}\\,\\mathrm{F}$, $\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$, hence $g_L = \\frac{C}{\\tau}$ and $R=\\frac{\\tau}{C}$, $E_L = -65\\times 10^{-3}\\,\\mathrm{V}$, $I = 0.5\\times 10^{-9}\\,\\mathrm{A}$, $h = 0.1\\times 10^{-3}\\,\\mathrm{s}$, $T = 0.5\\,\\mathrm{s}$, $V_0 = -70\\times 10^{-3}\\,\\mathrm{V}$.\n- Test case $2$ (boundary condition for Forward Euler): $C = 200\\times 10^{-12}\\,\\mathrm{F}$, $\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$, $E_L = -65\\times 10^{-3}\\,\\mathrm{V}$, $I = 0\\,\\mathrm{A}$, $h = 40\\times 10^{-3}\\,\\mathrm{s}$, $T = 0.4\\,\\mathrm{s}$, $V_0 = -55\\times 10^{-3}\\,\\mathrm{V}$.\n- Test case $3$ (unstable Forward Euler): $C = 200\\times 10^{-12}\\,\\mathrm{F}$, $\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$, $E_L = -65\\times 10^{-3}\\,\\mathrm{V}$, $I = 0\\,\\mathrm{A}$, $h = 50\\times 10^{-3}\\,\\mathrm{s}$, $T = 0.3\\,\\mathrm{s}$, $V_0 = -65\\times 10^{-3}\\,\\mathrm{V}$.\n- Test case $4$ (different biophysical scale): $C = 100\\times 10^{-12}\\,\\mathrm{F}$, $\\tau = 5\\times 10^{-3}\\,\\mathrm{s}$, $E_L = -70\\times 10^{-3}\\,\\mathrm{V}$, $I = 0.2\\times 10^{-9}\\,\\mathrm{A}$, $h = 1\\times 10^{-3}\\,\\mathrm{s}$, $T = 0.05\\,\\mathrm{s}$, $V_0 = -80\\times 10^{-3}\\,\\mathrm{V}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of the form $[V_{\\mathrm{FE}},V_{\\mathrm{BE}},V_{\\mathrm{EE}},S_{\\mathrm{FE}},S_{\\mathrm{BE}},S_{\\mathrm{EE}}]$. For example, the overall output format must be\n$$\n\\big[ [v_1^{\\mathrm{FE}},v_1^{\\mathrm{BE}},v_1^{\\mathrm{EE}},s_1^{\\mathrm{FE}},s_1^{\\mathrm{BE}},s_1^{\\mathrm{EE}}],\\; [v_2^{\\mathrm{FE}},v_2^{\\mathrm{BE}},v_2^{\\mathrm{EE}},s_2^{\\mathrm{FE}},s_2^{\\mathrm{BE}},s_2^{\\mathrm{EE}}],\\; [v_3^{\\mathrm{FE}},v_3^{\\mathrm{BE}},v_3^{\\mathrm{EE}},s_3^{\\mathrm{FE}},s_3^{\\mathrm{BE}},s_3^{\\mathrm{EE}}],\\; [v_4^{\\mathrm{FE}},v_4^{\\mathrm{BE}},v_4^{\\mathrm{EE}},s_4^{\\mathrm{FE}},s_4^{\\mathrm{BE}},s_4^{\\mathrm{EE}}] \\big],\n$$\nwhere $v_i^{\\mathrm{scheme}}$ are floats rounded to $6$ decimal places in volts and $s_i^{\\mathrm{scheme}}$ are booleans.\n\nNo user input or external data is permitted; all parameters must be hard-coded exactly as specified above in the program.",
            "solution": "The starting point is the governing ordinary differential equation (ODE) for the membrane potential $V(t)$:\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V(t)-E_L) \\;+\\; I(t)\n$$\nWe can rearrange this equation into a standard form for a linear first-order ODE. Dividing by $C$ and using the definitions $\\tau = C/g_L$ and $R = 1/g_L = \\tau/C$, we get:\n$$\n\\frac{dV}{dt} = -\\frac{g_L}{C}(V - E_L) + \\frac{I(t)}{C} = -\\frac{1}{\\tau}(V - E_L) + \\frac{I(t)}{C}\n$$\nThis equation can be written as $\\frac{dV}{dt} = f(V, t)$. Our goal is to find an approximate solution $V_{k+1} \\approx V(t_{k+1})$ given $V_k \\approx V(t_k)$, where $t_{k+1} = t_k + h$ and $h$ is a fixed time step. We assume the current $I(t)$ is constant over the interval $[t_k, t_{k+1}]$, denoted as $I_k$.\n\n**1. Derivation of Numerical Schemes**\n\nThe basic idea of finite difference methods is to approximate the derivative $\\frac{dV}{dt}$ at some point in the interval by $\\frac{V_{k+1} - V_k}{h}$.\n\n**Forward Euler (FE):**\nThe Forward Euler method approximates the derivative at the beginning of the interval, $t_k$.\n$$\n\\frac{V_{k+1} - V_k}{h} = f(V_k, t_k) = -\\frac{1}{\\tau}(V_k - E_L) + \\frac{I_k}{C}\n$$\nSolving for $V_{k+1}$:\n$$\nV_{k+1} = V_k + h \\left( -\\frac{1}{\\tau}V_k + \\frac{1}{\\tau}E_L + \\frac{I_k}{C} \\right) = \\left(1 - \\frac{h}{\\tau}\\right)V_k + \\frac{h}{\\tau}E_L + \\frac{h}{C}I_k\n$$\n\n**Backward Euler (BE):**\nThe Backward Euler method is an implicit method that approximates the derivative at the end of the interval, $t_{k+1}$.\n$$\n\\frac{V_{k+1} - V_k}{h} = f(V_{k+1}, t_{k+1}) = -\\frac{1}{\\tau}(V_{k+1} - E_L) + \\frac{I_k}{C}\n$$\nWe must now solve for $V_{k+1}$:\n$$\nV_{k+1}\\left(1 + \\frac{h}{\\tau}\\right) = V_k + \\frac{h}{\\tau}E_L + \\frac{h}{C}I_k \\implies V_{k+1} = \\frac{1}{1 + \\frac{h}{\\tau}} \\left( V_k + \\frac{h}{\\tau}E_L + \\frac{h}{C}I_k \\right)\n$$\n\n**Exact Discretization (EE):**\nFor a linear ODE with a piecewise-constant forcing term, we can find an exact solution over each step. Let $V_\\infty = E_L + R I_k$ be the steady-state voltage for the constant current $I_k$. The ODE becomes:\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}(V - V_\\infty)\n$$\nThis is a separable ODE. Integrating from $t_k$ to $t_{k+1}=t_k+h$ yields the update rule:\n$$\nV_{k+1} = V_\\infty + (V_k - V_\\infty)e^{-h/\\tau}\n$$\n\n**2. Stability Analysis**\n\nStability is analyzed for the homogeneous case where the input current $I$ is held constant. The system evolves towards a fixed point $V_\\infty = E_L + R I$. We study the evolution of the deviation from this fixed point, $\\delta_k = V_k - V_\\infty$. A scheme is asymptotically stable if the amplification factor $a$, defined by $\\delta_{k+1} = a \\delta_k$, has a magnitude less than $1$.\n\n**Forward Euler:** The amplification factor is $a_{FE} = 1 - \\frac{h}{\\tau}$. Stability requires $|a_{FE}| < 1$, which means $-1 < 1 - \\frac{h}{\\tau} < 1$. This implies $0 < \\frac{h}{\\tau} < 2$, or $h < 2\\tau$ (since $h, \\tau > 0$).\n\n**Backward Euler:** The amplification factor is $a_{BE} = \\frac{1}{1 + h/\\tau}$. Since $h > 0$ and $\\tau > 0$, we have $0 < a_{BE} < 1$. Thus, $|a_{BE}| < 1$ is always true, meaning BE is unconditionally stable.\n\n**Exact Discretization:** The amplification factor is $a_{EE} = e^{-h/\\tau}$. Since $h > 0$ and $\\tau > 0$, we have $0 < a_{EE} < 1$. Thus, $|a_{EE}| < 1$ is always true, meaning EE is also unconditionally stable.\n\nThe implementation will proceed by applying these derived update rules and stability conditions to the given test cases to produce the final output string.",
            "answer": "[[-0.015000,-0.015000,-0.015000,True,True,True],[-0.055000,-0.065000,-0.065000,False,True,True],[-0.065000,-0.065000,-0.065000,False,True,True],[-0.060000,-0.060000,-0.060001,True,True,True]]"
        }
    ]
}