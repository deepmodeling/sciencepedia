{
    "hands_on_practices": [
        {
            "introduction": "神经元最基本的功能之一是将其接收到的输入电流转换为输出发放率。这种输入-输出关系，即频率-电流（$f-I$）曲线，是理解神经计算的基础。本练习将指导您从LIF模型的基本电路定律出发，通过解析推导，得出在恒定电流输入下神经元的稳态发放率表达式，这是计算神经科学中的一项标志性计算。",
            "id": "4049955",
            "problem": "考虑一个由恒定输入电流驱动的单室漏放电（LIF）神经元。膜电压遵循基尔霍夫电流定律，结合了电容电流和泄漏电流，从而得到一阶线性微分方程 $C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$，其中 $C$ 是膜电容，$g_{L}$ 是泄漏电导，$E_{L}$ 是泄漏反转电位，$I_{0}$ 是恒定输入电流。当 $V(t)$ 达到阈值 $V_{\\text{th}}$ 时，会发出一个脉冲，随后电压被瞬时重置为 $V_{r}$，并在动力学恢复之前保持绝对不应期 $t_{\\text{ref}}$。假设在恒定驱动下，神经元会重复、稳定地发放脉冲。\n\n仅从上述物理定律和每个周期开始时的初始条件 $V(0)=V_{r}$ 出发，推导稳态放电频率作为恒定电流 $I_{0}$ 和神经元参数函数的闭式表达式。然后，使用该表达式，计算以下参数值下的放电频率：\n- $C=250\\,\\text{pF}$，\n- $g_{L}=12.5\\,\\text{nS}$，\n- $E_{L}=-65\\,\\text{mV}$，\n- $V_{\\text{th}}=-50\\,\\text{mV}$，\n- $V_{r}=-65\\,\\text{mV}$，\n- $I_{0}=0.75\\,\\text{nA}$，\n- $t_{\\text{ref}}=1.5\\,\\text{ms}$。\n\n将最终频率以 $\\text{Hz}$ 为单位表示，并将答案四舍五入到四位有效数字。确保推导从给定的微分方程开始，并遵循第一性原理，不使用目标公式的快捷方式。",
            "solution": "我们从描述膜电位 $V(t)$ 的微分方程开始：\n$$C\\,\\frac{dV(t)}{dt}=-g_{L}\\big(V(t)-E_{L}\\big)+I_{0}$$\n我们的目标是求解在初始条件 $V(0)=V_{r}$ 下，电压达到阈值 $V_{\\text{th}}$ 所需的时间。\n\n首先，通过两边除以 $g_{L}$ 来重新整理这个方程：\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -\\big(V(t)-E_{L}\\big) + \\frac{I_{0}}{g_{L}}$$\n我们定义膜时间常数 $\\tau_{m} = C/g_{L}$ 和在恒定电流输入下的稳态电压 $V_{\\infty} = E_{L} + I_{0}/g_{L}$。代入这些定义，方程简化为：\n$$\\tau_{m}\\frac{dV}{dt} = -(V - V_{\\infty})$$\n这是一个一阶线性常微分方程。我们可以通过分离变量法求解。我们将电压从重置电位 $V_r$ 积分到阈值电位 $V_{th}$，对应的时间是从 $0$ 积分到充电时间 $t_{\\text{charge}}$：\n$$\\int_{V_{r}}^{V_{\\text{th}}} \\frac{dV}{V-V_{\\infty}} = \\int_{0}^{t_{\\text{charge}}} -\\frac{dt}{\\tau_{m}}$$\n求解积分得到：\n$$[\\ln|V-V_{\\infty}|]_{V_{r}}^{V_{\\text{th}}} = [-\\frac{t}{\\tau_{m}}]_{0}^{t_{\\text{charge}}}$$\n假设输入电流足以使神经元发放脉冲，即 $V_{\\infty} > V_{\\text{th}}$。由于通常 $V_{th} > V_r$，在积分区间内 $V(t)  V_{\\infty}$，因此 $|V-V_{\\infty}| = V_{\\infty}-V$。\n$$\\ln(V_{\\infty}-V_{\\text{th}}) - \\ln(V_{\\infty}-V_{r}) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n整理对数项：\n$$\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = -\\frac{t_{\\text{charge}}}{\\tau_{m}}$$\n求解充电时间 $t_{\\text{charge}}$：\n$$t_{\\text{charge}} = -\\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{\\text{th}}}{V_{\\infty}-V_{r}}\\right) = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n这个表达式仅在 $V_{\\infty} > V_{\\text{th}}$ 时有效，否则神经元将永远不会发放脉冲。\n\n一个完整的放电周期，即脉冲间期（$T_{\\text{ISI}}$），是充电时间 $t_{\\text{charge}}$ 与绝对不应期 $t_{\\text{ref}}$ 之和：\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = t_{\\text{ref}} + \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right)$$\n稳态放电频率 $f$ 是脉冲间期的倒数，$f = 1/T_{\\text{ISI}}$。将 $\\tau_{m}$ 和 $V_{\\infty}$ 的表达式代回，得到最终的闭式表达式：\n$$f = \\left[t_{\\text{ref}} + \\frac{C}{g_{L}}\\ln\\left(\\frac{(E_{L} + I_{0}/g_{L}) - V_{r}}{(E_{L} + I_{0}/g_{L}) - V_{\\text{th}}}\\right)\\right]^{-1}$$\n\n现在，我们使用给定的参数进行数值计算。首先，将所有参数转换为国际单位制（SI）基本单位：\n- $C=250\\,\\text{pF} = 250 \\times 10^{-12}\\,\\text{F}$\n- $g_{L}=12.5\\,\\text{nS} = 12.5 \\times 10^{-9}\\,\\text{S}$\n- $E_{L}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $V_{\\text{th}}=-50\\,\\text{mV} = -0.050\\,\\text{V}$\n- $V_{r}=-65\\,\\text{mV} = -0.065\\,\\text{V}$\n- $I_{0}=0.75\\,\\text{nA} = 0.75 \\times 10^{-9}\\,\\text{A}$\n- $t_{\\text{ref}}=1.5\\,\\text{ms} = 1.5 \\times 10^{-3}\\,\\text{s}$\n\n接下来，计算中间值 $\\tau_m$ 和 $V_{\\infty}$：\n$$\\tau_{m} = \\frac{C}{g_{L}} = \\frac{250 \\times 10^{-12}\\,\\text{F}}{12.5 \\times 10^{-9}\\,\\text{S}} = 20 \\times 10^{-3}\\,\\text{s} = 0.02\\,\\text{s}$$\n$$V_{\\infty} = E_{L} + \\frac{I_{0}}{g_{L}} = -0.065\\,\\text{V} + \\frac{0.75 \\times 10^{-9}\\,\\text{A}}{12.5 \\times 10^{-9}\\,\\text{S}} = -0.065\\,\\text{V} + 0.06\\,\\text{V} = -0.005\\,\\text{V}$$\n我们检查放电条件：$V_{\\infty} > V_{\\text{th}}$ 是否成立？\n$-0.005\\,\\text{V} > -0.050\\,\\text{V}$。条件满足，神经元会放电。\n\n现在，我们计算 $t_{\\text{charge}}$：\n$$t_{\\text{charge}} = \\tau_{m}\\ln\\left(\\frac{V_{\\infty}-V_{r}}{V_{\\infty}-V_{\\text{th}}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{-0.005\\,\\text{V} - (-0.065\\,\\text{V})}{-0.005\\,\\text{V} - (-0.050\\,\\text{V})}\\right)$$\n$$t_{\\text{charge}} = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{0.060\\,\\text{V}}{0.045\\,\\text{V}}\\right) = 0.02\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\n使用 $\\ln(4/3) \\approx 0.287682$：\n$$t_{\\text{charge}} \\approx 0.02 \\times 0.287682\\,\\text{s} \\approx 0.00575364\\,\\text{s}$$\n接下来，计算总的脉冲间期 $T_{\\text{ISI}}$：\n$$T_{\\text{ISI}} = t_{\\text{ref}} + t_{\\text{charge}} = 1.5 \\times 10^{-3}\\,\\text{s} + 0.00575364\\,\\text{s} = 0.00725364\\,\\text{s}$$\n最后，计算放电频率 $f$：\n$$f = \\frac{1}{T_{\\text{ISI}}} = \\frac{1}{0.00725364\\,\\text{s}} \\approx 137.862\\,\\text{Hz}$$\n将结果四舍五入到四位有效数字，得到 $137.9\\,\\text{Hz}$。",
            "answer": "$$\\boxed{137.9}$$"
        },
        {
            "introduction": "对于随时间变化的复杂输入，LIF模型的解析解往往难以获得，这时数值模拟便成为不可或缺的工具。本计算实践旨在将理论付诸于代码，您将为LIF模型实现并比较几种核心的数值积分方案。此过程不仅能锻炼您的编程能力，更重要的是，它将揭示数值方法的核心概念，特别是显式与隐式方法在稳定性上的差异。",
            "id": "4049957",
            "problem": "考虑漏积分-发放 (Leaky Integrate-and-Fire, LIF) 神经元模型，它被理想化为一个由外部电流驱动的电阻-电容电路。细胞膜被建模为一个电容为 $C$ 的电容器，与一个漏电导 $g_L$ 和一个反转（漏）电位 $E_L$ 并联。根据基尔霍夫电流定律以及电容器和电阻器的本构关系，膜电位 $V(t)$ 满足\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V(t)-E_L) \\;+\\; I(t),\n$$\n其中 $I(t)$ 是施加的输入电流。定义膜时间常数 $\\tau \\equiv \\frac{C}{g_L}$ 和漏电阻 $R \\equiv \\frac{1}{g_L} = \\frac{\\tau}{C}$。在整个问题中，膜电位以伏特（volts）为单位，时间以秒（seconds）为单位，电容以法拉（farads）为单位，电导以西门子（siemens）为单位，电阻以欧姆（ohms）为单位，电流以安培（amperes）为单位。\n\n您的任务是从这些基本电路定律出发，在不假定任何预先给定的积分公式的情况下，推导并实现三种离散时间数值积分方案，以在固定时间步长 $h$ 上推进膜电位，并假设 $I(t)$ 在每个步长内是分段常数：\n- 前向欧拉法 (Forward Euler, FE)。\n- 后向欧拉法 (Backward Euler, BE)。\n- 分段恒定输入下的精确离散化，也称为指数欧拉法 (Exponential Euler, EE)。\n\n除了计算膜电位轨迹外，还需分析每种方案在齐次情况下的线性稳定性（即，在步长内保持 $I(t)$ 恒定，使得与瞬时不动点的偏差由一个标量放大因子决定）。对于每种方案，将齐次放大因子 $a$ 定义为将第 $k$ 步与不动点的偏差映射到第 $k+1$ 步偏差的标量乘子。当且仅当 $\\lvert a \\rvert  1$ 时，一个方案是渐近稳定的。从第一性原理出发为每种方案推导出 $a$，并用它为每个参数集生成一个布尔类型的稳定性判定。\n\n实现一个程序，针对下方的每个测试用例，使用三种方案和统一的时间步长 $h$，从初始条件 $V(0)=V_0$ 开始模拟总时长为 $T$ 的膜电位。假设在每个测试的整个模拟窗口内，$I(t)$ 是恒定的，并且等于指定的幅值。对于每个测试用例，报告：\n- 在前向欧拉法、后向欧拉法和精确离散化方案下，最后一步之后的最终膜电位。\n- 前向欧拉法、后向欧拉法和精确离散化方案的布尔类型渐近稳定性判定，该判定仅由给定的 $h$ 和 $\\tau$ 的齐次放大因子决定。\n\n将所有报告的膜电位四舍五入到 $6$ 位小数。布尔类型的稳定性判定必须使用严格不等式 $\\lvert a \\rvert  1$ 来计算。\n\n使用以下科学上合理的参数值测试套件：\n- 测试用例 $1$（正常路径，小步长）：$C = 200\\times 10^{-12}\\,\\mathrm{F}$，$\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$，因此 $g_L = \\frac{C}{\\tau}$ 且 $R=\\frac{\\tau}{C}$，$E_L = -65\\times 10^{-3}\\,\\mathrm{V}$，$I = 0.5\\times 10^{-9}\\,\\mathrm{A}$，$h = 0.1\\times 10^{-3}\\,\\mathrm{s}$，$T = 0.5\\,\\mathrm{s}$，$V_0 = -70\\times 10^{-3}\\,\\mathrm{V}$。\n- 测试用例 $2$（前向欧拉法的边界条件）：$C = 200\\times 10^{-12}\\,\\mathrm{F}$，$\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$，$E_L = -65\\times 10^{-3}\\,\\mathrm{V}$，$I = 0\\,\\mathrm{A}$，$h = 40\\times 10^{-3}\\,\\mathrm{s}$，$T = 0.4\\,\\mathrm{s}$，$V_0 = -55\\times 10^{-3}\\,\\mathrm{V}$。\n- 测试用例 $3$（不稳定的前向欧拉法）：$C = 200\\times 10^{-12}\\,\\mathrm{F}$，$\\tau = 20\\times 10^{-3}\\,\\mathrm{s}$，$E_L = -65\\times 10^{-3}\\,\\mathrm{V}$，$I = 0\\,\\mathrm{A}$，$h = 50\\times 10^{-3}\\,\\mathrm{s}$，$T = 0.3\\,\\mathrm{s}$，$V_0 = -65\\times 10^{-3}\\,\\mathrm{V}$。\n- 测试用例 $4$（不同的生物物理尺度）：$C = 100\\times 10^{-12}\\,\\mathrm{F}$，$\\tau = 5\\times 10^{-3}\\,\\mathrm{s}$，$E_L = -70\\times 10^{-3}\\,\\mathrm{V}$，$I = 0.2\\times 10^{-9}\\,\\mathrm{A}$，$h = 1\\times 10^{-3}\\,\\mathrm{s}$，$T = 0.05\\,\\mathrm{s}$，$V_0 = -80\\times 10^{-3}\\,\\mathrm{V}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个形式为 $[V_{\\mathrm{FE}},V_{\\mathrm{BE}},V_{\\mathrm{EE}},S_{\\mathrm{FE}},S_{\\mathrm{BE}},S_{\\mathrm{EE}}]$ 的列表。例如，整体输出格式必须是\n$$\n\\big[ [v_1^{\\mathrm{FE}},v_1^{\\mathrm{BE}},v_1^{\\mathrm{EE}},s_1^{\\mathrm{FE}},s_1^{\\mathrm{BE}},s_1^{\\mathrm{EE}}],\\; [v_2^{\\mathrm{FE}},v_2^{\\mathrm{BE}},v_2^{\\mathrm{EE}},s_2^{\\mathrm{FE}},s_2^{\\mathrm{BE}},s_2^{\\mathrm{EE}}],\\; [v_3^{\\mathrm{FE}},v_3^{\\mathrm{BE}},v_3^{\\mathrm{EE}},s_3^{\\mathrm{FE}},s_3^{\\mathrm{BE}},s_3^{\\mathrm{EE}}],\\; [v_4^{\\mathrm{FE}},v_4^{\\mathrm{BE}},v_4^{\\mathrm{EE}},s_4^{\\mathrm{FE}},s_4^{\\mathrm{BE}},s_4^{\\mathrm{EE}}] \\big],\n$$\n其中 $v_i^{\\mathrm{scheme}}$ 是以伏特为单位、四舍五入到 $6$ 位小数的浮点数，而 $s_i^{\\mathrm{scheme}}$ 是布尔值。\n\n不允许用户输入或外部数据；所有参数必须完全按照上述规定在程序中硬编码。",
            "solution": "### 1. 数值方案的推导\n\n我们的起点是膜电位 $V(t)$ 的控制常微分方程 (ODE)：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; -\\,g_L\\,(V(t)-E_L) \\;+\\; I(t)\n$$\n我们可以将此方程重排为线性一阶常微分方程的标准形式。两边同除以 $C$ 并使用定义 $\\tau = C/g_L$，我们得到：\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}(V - E_L) + \\frac{I(t)}{C}\n$$\n我们的目标是给定 $V_k \\approx V(t_k)$，求解近似解 $V_{k+1} \\approx V(t_{k+1})$，其中 $t_{k+1} = t_k + h$ 且 $h$ 是一个固定的时间步长。我们假设电流 $I(t)$ 在区间 $[t_k, t_{k+1}]$ 内是常数，记为 $I_k$。\n\n#### 前向欧拉法 (FE)\n前向欧拉法在区间的起点 $t_k$ 处用差商近似导数：\n$$\n\\frac{V_{k+1} - V_k}{h} \\approx \\frac{dV}{dt}\\bigg|_{t_k} = -\\frac{1}{\\tau}(V_k - E_L) + \\frac{I_k}{C}\n$$\n求解 $V_{k+1}$，得到更新规则：\n$$\nV_{k+1} = V_k + h \\left( -\\frac{1}{\\tau}V_k + \\frac{1}{\\tau}E_L + \\frac{I_k}{C} \\right) = \\left(1 - \\frac{h}{\\tau}\\right)V_k + \\frac{h}{\\tau}E_L + \\frac{hI_k}{C}\n$$\n\n#### 后向欧拉法 (BE)\n后向欧拉法是一种隐式方法，它在区间的终点 $t_{k+1}$ 处近似导数：\n$$\n\\frac{V_{k+1} - V_k}{h} \\approx \\frac{dV}{dt}\\bigg|_{t_{k+1}} = -\\frac{1}{\\tau}(V_{k+1} - E_L) + \\frac{I_k}{C}\n$$\n我们需要求解 $V_{k+1}$：\n$$\nV_{k+1} - V_k = -\\frac{h}{\\tau}V_{k+1} + \\frac{h}{\\tau}E_L + \\frac{hI_k}{C}\n$$\n$$\nV_{k+1}\\left(1 + \\frac{h}{\\tau}\\right) = V_k + \\frac{h}{\\tau}E_L + \\frac{hI_k}{C}\n$$\n$$\nV_{k+1} = \\frac{1}{1 + h/\\tau} \\left( V_k + \\frac{h}{\\tau}E_L + \\frac{hI_k}{C} \\right)\n$$\n\n#### 精确离散化 (EE)\n对于带有分段常数强迫项的线性常微分方程，我们可以在每个步长上找到精确解。令 $V_\\infty = E_L + R I_k$ (其中 $R=1/g_L$) 为恒定电流 $I_k$ 下的稳态电压。该常微分方程变为：\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau}(V - V_\\infty)\n$$\n这是一个可分离的常微分方程。从 $t_k$ 积分到 $t_{k+1}=t_k+h$：\n$$\n\\int_{V_k}^{V_{k+1}} \\frac{dV}{V - V_\\infty} = \\int_{t_k}^{t_{k+1}} -\\frac{1}{\\tau}dt\n$$\n$$\n\\ln\\left(\\frac{V_{k+1} - V_\\infty}{V_k - V_\\infty}\\right) = -\\frac{h}{\\tau}\n$$\n对两边取指数，得到更新规则：\n$$\nV_{k+1} = V_\\infty + (V_k - V_\\infty)e^{-h/\\tau}\n$$\n这正是指数欧拉法的表达式。\n\n### 2. 稳定性分析\n\n稳定性分析在输入电流 $I$ 恒定的齐次情况下进行。系统向一个不动点 $V_\\infty = E_L + R I$ 演化。我们研究与该不动点的偏差 $\\delta_k = V_k - V_\\infty$ 的演化。如果由 $\\delta_{k+1} = a \\delta_k$ 定义的放大因子 $a$ 的绝对值小于 1，即 $|a|  1$，则该方案是渐近稳定的。\n\n#### 前向欧拉法\n从 FE 更新规则出发，代入 $V_k = \\delta_k + V_\\infty$ 和 $V_{k+1} = \\delta_{k+1} + V_\\infty$：\n$$\n\\delta_{k+1} + V_\\infty = \\left(1 - \\frac{h}{\\tau}\\right)(\\delta_k + V_\\infty) + \\frac{h}{\\tau}E_L + \\frac{hI_k}{C}\n$$\n注意到 $\\frac{h}{\\tau}E_L + \\frac{hI_k}{C} = \\frac{h}{\\tau}(E_L + R I_k) = \\frac{h}{\\tau}V_\\infty$：\n$$\n\\delta_{k+1} + V_\\infty = \\left(1 - \\frac{h}{\\tau}\\right)\\delta_k + \\left(1 - \\frac{h}{\\tau}\\right)V_\\infty + \\frac{h}{\\tau}V_\\infty = \\left(1 - \\frac{h}{\\tau}\\right)\\delta_k + V_\\infty\n$$\n因此，$\\delta_{k+1} = (1 - h/\\tau)\\delta_k$。放大因子为 $a_{\\text{FE}} = 1 - h/\\tau$。稳定性要求 $|a_{\\text{FE}}|  1$，即 $-1  1 - h/\\tau  1$，这意味着 $0  h/\\tau  2$，或 $h  2\\tau$（因为 $h, \\tau > 0$）。\n\n#### 后向欧拉法\n类似地，将 $V_k = \\delta_k + V_\\infty$ 代入 BE 更新规则：\n$$\n(\\delta_{k+1} + V_\\infty)\\left(1 + \\frac{h}{\\tau}\\right) = (\\delta_k + V_\\infty) + \\frac{h}{\\tau}V_\\infty\n$$\n$$\n\\delta_{k+1}\\left(1 + \\frac{h}{\\tau}\\right) + V_\\infty\\left(1 + \\frac{h}{\\tau}\\right) = \\delta_k + V_\\infty + \\frac{h}{\\tau}V_\\infty = \\delta_k + V_\\infty\\left(1 + \\frac{h}{\\tau}\\right)\n$$\n$$\n\\delta_{k+1}\\left(1 + \\frac{h}{\\tau}\\right) = \\delta_k \\implies \\delta_{k+1} = \\frac{1}{1 + h/\\tau}\\delta_k\n$$\n放大因子为 $a_{\\text{BE}} = 1 / (1 + h/\\tau)$。由于 $h > 0$ 且 $\\tau > 0$，我们有 $0  a_{\\text{BE}}  1$。因此，$|a_{\\text{BE}}|  1$ 恒成立，后向欧拉法是无条件稳定的。\n\n#### 精确离散化\n从 EE 的推导中，我们已经得到了偏差的演化方程：\n$$\n\\delta_{k+1} = V_{k+1} - V_\\infty = (V_k - V_\\infty)e^{-h/\\tau} = \\delta_k e^{-h/\\tau}\n$$\n放大因子为 $a_{\\text{EE}} = e^{-h/\\tau}$。由于 $h > 0$ 且 $\\tau > 0$，我们有 $0  a_{\\text{EE}}  1$。因此，$|a_{\\text{EE}}|  1$ 恒成立，指数欧拉法也是无条件稳定的。\n\n该实现将通过将这些推导出的更新规则和稳定性条件应用于给定的测试用例来进行。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and analyzes three numerical schemes for the LIF neuron model.\n    \"\"\"\n\n    test_cases = [\n        # C, tau, E_L, I, h, T, V_0\n        (200e-12, 20e-3, -65e-3, 0.5e-9, 0.1e-3, 0.5, -70e-3),\n        (200e-12, 20e-3, -65e-3, 0, 40e-3, 0.4, -55e-3),\n        (200e-12, 20e-3, -65e-3, 0, 50e-3, 0.3, -65e-3),\n        (100e-12, 5e-3, -70e-3, 0.2e-9, 1e-3, 0.05, -80e-3),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        C, tau, E_L, I, h, T, V_0 = case\n        \n        # Derived parameters\n        R = tau / C\n        \n        # Calculations for simulation\n        # It is crucial to use a precise number of steps, rounding T/h can introduce small errors.\n        # Given the problem's values, T/h is always an integer.\n        num_steps = int(round(T / h))\n        \n        # --- Stability Analysis ---\n        # Stability condition is |a|  1\n        a_fe = 1 - h / tau\n        is_stable_fe = abs(a_fe)  1\n        \n        a_be = 1 / (1 + h / tau)\n        is_stable_be = abs(a_be)  1 # Always true for h, tau > 0\n\n        a_ee = np.exp(-h / tau)\n        is_stable_ee = abs(a_ee)  1 # Always true for h, tau > 0\n\n        # --- Simulation ---\n        # Initialize membrane potentials\n        V_fe = V_0\n        V_be = V_0\n        V_ee = V_0\n        \n        # Pre-compute constant terms for efficiency\n        h_over_tau = h / tau\n        h_over_C = h / C\n        V_infinity = E_L + R * I\n        exp_term = np.exp(-h / tau)\n\n        for _ in range(num_steps):\n            # Forward Euler Update\n            V_fe = (1 - h_over_tau) * V_fe + h_over_tau * E_L + h_over_C * I\n            \n            # Backward Euler Update\n            V_be = (V_be + h_over_tau * E_L + h_over_C * I) / (1 + h_over_tau)\n\n            # Exact Discretization (Exponential Euler) Update\n            V_ee = V_infinity + (V_ee - V_infinity) * exp_term\n\n        # Collect results for this test case, rounding potentials as required\n        case_results = [\n            round(V_fe, 6), round(V_be, 6), round(V_ee, 6),\n            is_stable_fe, is_stable_be, is_stable_ee\n        ]\n        all_results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Format each sublist into the specified string representation.\n    # f-string formatting with :.6f handles rounding for display.\n    # Boolean True/False values are automatically converted to their string representations.\n    formatted_results = []\n    for res in all_results:\n        v_fe, v_be, v_ee, s_fe, s_be, s_ee = res\n        res_str = f\"[{v_fe:.6f},{v_be:.6f},{v_ee:.6f},{s_fe},{s_be},{s_ee}]\"\n        res_str = res_str.replace(\"True\", \"true\").replace(\"False\", \"false\") # Python prints True/False, problem example seems to imply lowercase\n        formatted_results.append(res_str)\n\n    # Join the formatted sublists into the final output string.\n    output_string = f\"[{','.join(formatted_results)}]\"\n    # A quick check on the final expected format. It uses spaces after commas between sub-lists.\n    # `[ [v1...], [v2...], ... ]`\n    # My current code will produce `[[v1...],[v2...],...]`\n    # I will adjust this for perfect compliance.\n    final_output = f\"[{', '.join(formatted_results)}]\"\n    \n    # Python prints booleans as 'True' and 'False'. The prompt output example uses all lowercase letters, but doesn't explicitly state booleans should be lowercase.\n    # To be safe and match the style, let's make them lowercase.\n    final_output = final_output.replace('True', 'True').replace('False', 'False') # Backtracking on lowercase; standard bool representation is better unless specified. Let's assume standard python output is fine.\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}