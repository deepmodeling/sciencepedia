{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握三因子学习法则，第一步是亲手计算其对突触权重的具体影响。本练习将引导您完成一个基于神经调质门控的脉冲时间依赖可塑性（STDP）的直接计算。通过处理给定的突触前和突触后脉冲时间序列以及分段变化的神经调质信号，您将能够体会到这三个因子——突触前活动、突触后活动和全局调质信号——是如何共同决定突触变化的 。",
            "id": "4066403",
            "problem": "考虑一个脉冲神经网络中的单个突触，它从突触前神经元 $i$ 连接到突触后神经元 $j$，并实现了一种神经调质门控的三因子脉冲时间依赖可塑性（STDP）机制。在一次试验中，突触权重变化 $\\Delta w_{ij}$ 由脉冲时间相互作用产生的、受神经调质门控的资格决定。突触前脉冲时间为 $t_{i} \\in \\{10 \\ \\text{ms}, 50 \\ \\text{ms}, 95 \\ \\text{ms}, 140 \\ \\text{ms}\\}$，突触后脉冲时间为 $t_{j} \\in \\{30 \\ \\text{ms}, 60 \\ \\text{ms}, 105 \\ \\text{ms}, 170 \\ \\text{ms}\\}$。控制时间敏感性的参数为 $A_{+} = 0.01$，$A_{-} = -0.012$，$\\tau_{+} = 20 \\ \\text{ms}$ 和 $\\tau_{-} = 20 \\ \\text{ms}$。神经调质信号 $m(t)$ 在试验期间是分段常数：当 $0 \\le t  40 \\ \\text{ms}$ 时，$m(t) = 0$；当 $40 \\le t  120 \\ \\text{ms}$ 时，$m(t) = 0.8$；当 $120 \\le t \\le 200 \\ \\text{ms}$ 时，$m(t) = -0.5$。假设当突触后脉冲晚于突触前脉冲时，分配因果时间贡献；当突触前脉冲晚于突触后脉冲时，分配反因果时间贡献，每个贡献的大小由使用 $\\tau_{+}$ 或 $\\tau_{-}$ 的相应指数敏感性确定。并且，神经调质因子 $m(t)$ 在分配更新时（即每对脉冲中较晚的那个脉冲的时间）门控该贡献。使用这些假设和给定参数，通过对所有有序的突触前-突触后脉冲对的神经调质门控贡献求和，计算整个试验期间的总突触权重变化 $\\Delta w_{ij}$。请用无量纲量表示您的最终答案，并将结果四舍五入到七位有效数字。",
            "solution": "用户希望我解决这个问题。我需要输出解答。\n此问题经验证是合理且定义明确的。三因子脉冲时间依赖可塑性（STDP）、神经调质和资格迹等概念是计算神经科学和神经形态工程的基础。所有必要的参数和条件都已提供，并且没有内部矛盾。\n\n总突触权重变化 $\\Delta w_{ij}$ 是所有有序的突触前脉冲 $(t_i)$ 和突触后脉冲 $(t_j)$ 对的贡献之和。每对脉冲的贡献由资格迹 $E(\\Delta t)$ 和神经调质信号 $m(t)$ 的乘积决定。\n总权重变化的公式为：\n$$ \\Delta w_{ij} = \\sum_{t_i \\in T_i} \\sum_{t_j \\in T_j} \\delta w_{ij}(t_i, t_j) $$\n其中 $T_i$ 是突触前脉冲时间的集合，$T_j$ 是突触后脉冲时间的集合。单个脉冲对的贡献 $\\delta w_{ij}(t_i, t_j)$ 由下式给出：\n$$ \\delta w_{ij}(t_i, t_j) = m(t_{\\text{update}}) \\cdot E(\\Delta t) $$\n更新时间指定为脉冲对中较晚的那个脉冲的时间，即 $t_{\\text{update}} = \\max(t_i, t_j)$。时间差为 $\\Delta t = t_j - t_i$。资格迹 $E(\\Delta t)$ 由标准 STDP 规则定义：\n$$ E(\\Delta t) = \\begin{cases} A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)   \\text{if } \\Delta t  0 \\ \\text{(causal, LTP)} \\\\ A_{-} \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right)   \\text{if } \\Delta t  0 \\ \\text{(anti-causal, LTD)} \\end{cases} $$\n\n给定的参数如下：\n突触前脉冲时间：$T_i = \\{10, 50, 95, 140\\}$，单位为 ms。\n突触后脉冲时间：$T_j = \\{30, 60, 105, 170\\}$，单位为 ms。\nSTDP 参数：$A_{+} = 0.01$, $A_{-} = -0.012$, $\\tau_{+} = 20 \\ \\text{ms}$, $\\tau_{-} = 20 \\ \\text{ms}$。\n神经调质信号 $m(t)$：\n$$ m(t) = \\begin{cases} 0  \\text{for } 0 \\le t  40 \\ \\text{ms} \\\\ 0.8  \\text{for } 40 \\le t  120 \\ \\text{ms} \\\\ -0.5  \\text{for } 120 \\le t \\le 200 \\ \\text{ms} \\end{cases} $$\n\n我们将计算 $4 \\times 4 = 16$ 个脉冲对中每一个的贡献，并根据神经调质信号 $m(t_{\\text{update}})$ 的值对它们进行分组。\n\n**1. $m(t_{\\text{update}}) = 0$ 时的贡献**\n这适用于 $t_{\\text{update}}  40 \\ \\text{ms}$ 的脉冲对。\n-   脉冲对 $(t_i, t_j) = (10, 30)$: $\\Delta t = 20 \\ \\text{ms}$，$t_{\\text{update}} = 30 \\ \\text{ms}$。神经调质值为 $m(30) = 0$。\n    贡献为 $0 \\times \\left( A_{+} \\exp\\left(-\\frac{20}{20}\\right) \\right) = 0$。\n\n**2. $m(t_{\\text{update}}) = 0.8$ 时的贡献**\n这适用于 $40 \\le t_{\\text{update}}  120 \\ \\text{ms}$ 的脉冲对。\n因果脉冲对 ($\\Delta t  0$):\n-   $(10, 60)$: $\\Delta t = 50$, $t_{\\text{update}} = 60$。贡献: $0.8 \\cdot A_{+} \\exp(-50/20) = 0.008 \\exp(-2.5)$。\n-   $(10, 105)$: $\\Delta t = 95$, $t_{\\text{update}} = 105$。贡献: $0.8 \\cdot A_{+} \\exp(-95/20) = 0.008 \\exp(-4.75)$。\n-   $(50, 60)$: $\\Delta t = 10$, $t_{\\text{update}} = 60$。贡献: $0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$。\n-   $(50, 105)$: $\\Delta t = 55$, $t_{\\text{update}} = 105$。贡献: $0.8 \\cdot A_{+} \\exp(-55/20) = 0.008 \\exp(-2.75)$。\n-   $(95, 105)$: $\\Delta t = 10$, $t_{\\text{update}} = 105$。贡献: $0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$。\n反因果脉冲对 ($\\Delta t  0$):\n-   $(50, 30)$: $\\Delta t = -20$, $t_{\\text{update}} = 50$。贡献: $0.8 \\cdot A_{-} \\exp(-20/20) = 0.8(-0.012)\\exp(-1) = -0.0096 \\exp(-1)$。\n-   $(95, 30)$: $\\Delta t = -65$, $t_{\\text{update}} = 95$。贡献: $0.8 \\cdot A_{-} \\exp(-65/20) = -0.0096 \\exp(-3.25)$。\n-   $(95, 60)$: $\\Delta t = -35$, $t_{\\text{update}} = 95$。贡献: $0.8 \\cdot A_{-} \\exp(-35/20) = -0.0096 \\exp(-1.75)$。\n\n该组的贡献总和 $\\Delta w_{0.8}$：\n$\\Delta w_{0.8} = 0.008(\\exp(-2.5) + \\exp(-4.75) + 2\\exp(-0.5) + \\exp(-2.75)) - 0.0096(\\exp(-1) + \\exp(-3.25) + \\exp(-1.75))$\n$\\Delta w_{0.8} \\approx 0.008(1.3677265) - 0.0096(0.5804276) \\approx 0.01094181 - 0.00557211 \\approx 0.00536970$。\n\n**3. $m(t_{\\text{update}}) = -0.5$ 时的贡献**\n这适用于 $120 \\le t_{\\text{update}} \\le 200 \\ \\text{ms}$ 的脉冲对。\n因果脉冲对 ($\\Delta t  0$):\n-   $(10, 170)$: $\\Delta t = 160$, $t_{\\text{update}} = 170$。贡献: $-0.5 \\cdot A_{+} \\exp(-160/20) = -0.005 \\exp(-8)$。\n-   $(50, 170)$: $\\Delta t = 120$, $t_{\\text{update}} = 170$。贡献: $-0.5 \\cdot A_{+} \\exp(-120/20) = -0.005 \\exp(-6)$。\n-   $(95, 170)$: $\\Delta t = 75$, $t_{\\text{update}} = 170$。贡献: $-0.5 \\cdot A_{+} \\exp(-75/20) = -0.005 \\exp(-3.75)$。\n-   $(140, 170)$: $\\Delta t = 30$, $t_{\\text{update}} = 170$。贡献: $-0.5 \\cdot A_{+} \\exp(-30/20) = -0.005 \\exp(-1.5)$。\n反因果脉冲对 ($\\Delta t  0$):\n-   $(140, 30)$: $\\Delta t = -110$, $t_{\\text{update}} = 140$。贡献: $-0.5 \\cdot A_{-} \\exp(-110/20) = -0.5(-0.012)\\exp(-5.5) = 0.006 \\exp(-5.5)$。\n-   $(140, 60)$: $\\Delta t = -80$, $t_{\\text{update}} = 140$。贡献: $-0.5 \\cdot A_{-} \\exp(-80/20) = 0.006 \\exp(-4)$。\n-   $(140, 105)$: $\\Delta t = -35$, $t_{\\text{update}} = 140$。贡献: $-0.5 \\cdot A_{-} \\exp(-35/20) = 0.006 \\exp(-1.75)$。\n\n该组的贡献总和 $\\Delta w_{-0.5}$：\n$\\Delta w_{-0.5} = -0.005(\\exp(-8) + \\exp(-6) + \\exp(-3.75) + \\exp(-1.5)) + 0.006(\\exp(-5.5) + \\exp(-4) + \\exp(-1.75))$\n$\\Delta w_{-0.5} \\approx -0.005(0.2494621) + 0.006(0.1961764) \\approx -0.00124731 + 0.00117706 \\approx -0.00007025$。\n\n**总突触权重变化**\n总变化 $\\Delta w_{ij}$ 是所有贡献的总和：\n$$ \\Delta w_{ij} = \\Delta w_{0} + \\Delta w_{0.8} + \\Delta w_{-0.5} $$\n$$ \\Delta w_{ij} \\approx 0 + 0.0053697072 - 0.0000702525 \\approx 0.0052994547 $$\n问题要求将最终答案四舍五入到七位有效数字。计算值为 $0.0052994547...$。前七位有效数字是 $5, 2, 9, 9, 4, 5, 4$。第八位有效数字是 $7$，由于 $\\ge 5$，因此我们将第七位数字向上取整。\n$$ \\Delta w_{ij} \\approx 0.005299455 $$",
            "answer": "$$\n\\boxed{0.005299455}\n$$"
        },
        {
            "introduction": "在理解了三因子学习法则的计算机制后，下一个关键问题是：这个“第三因子”在功能上代表什么？本练习将三因子学习法则与强化学习（RL）理论联系起来，揭示了神经调质信号通常可被解释为时间差分（TD）奖励预测误差。您将计算一个离散时间序列的TD误差，并用它来调节突触权重更新，从而深入理解大脑如何利用预测误差来指导学习 。",
            "id": "4066380",
            "problem": "考虑一个离散时间分幕式强化学习 (RL) 环境，其中一个标量神经调节信号通过三因子学习法则来门控突触可塑性。该神经调节信号是时间差分 (TD) 奖励预测误差，可理解为一个分幕式任务的单步贝尔曼残差，该任务的终止状态值为零。在单个幕中，一个突触后神经元在时间步 $t \\in \\{1,2,3\\}$ 上接收到奖励序列 $r(1)=0$, $r(2)=0$, $r(3)=1$。评论家提供的状态价值估计为 $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$，折扣因子为 $\\gamma=0.9$。该幕在 $t=3$ 后终止，终止状态的价值为 $V(4)=0$。对于一个特定的突触 $(i,j)$，在相同时间步上的特定于突触的效用迹值为 $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$。假设学习率为恒定值 $\\eta=0.2$，并且在时间 $t$ 的瞬时突触增量与该时间的神经调节信号和效用迹值的乘积成正比。\n\n仅使用有限视界分幕式预测的贝尔曼残差定义和三因子神经调节可塑性原理，计算：\n- 时间差分误差序列 $\\delta(1)$, $\\delta(2)$, $\\delta(3)$，以及\n- 相应的瞬时突触增量 $\\Delta w_{ij}(1)$, $\\Delta w_{ij}(2)$, $\\Delta w_{ij}(3)$。\n\n以单行矩阵的形式提供最终答案，顺序为 $[\\delta(1),\\ \\delta(2),\\ \\delta(3),\\ \\Delta w_{ij}(1),\\ \\Delta w_{ij}(2),\\ \\Delta w_{ij}(3)]$。无需四舍五入，最终答案中不包含任何单位。",
            "solution": "该问题被验证为具有科学依据、定义明确且信息完整。所有必要信息均已提供，所要求的计算基于强化学习和计算神经科学的标准原理。\n\n第一步是计算时间差分 (TD) 误差序列，记为 $\\delta(t)$。问题将 TD 误差定义为分幕式任务的单步贝尔曼残差。时间步 $t$ 的 TD 误差公式为：\n$$\n\\delta(t) = r(t) + \\gamma V(t+1) - V(t)\n$$\n其中 $r(t)$ 是在时间 $t$ 收到的奖励，$V(t)$ 是在时间 $t$ 的状态价值估计，$\\gamma$ 是折扣因子。\n\n我们已知以下值：\n- 奖励序列：$r(1)=0$, $r(2)=0$, $r(3)=1$。\n- 状态价值估计：$V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$。\n- 终止状态价值：$V(4)=0$。\n- 折扣因子：$\\gamma=0.9$。\n\n使用这些值，我们可以计算每个时间步 $t \\in \\{1, 2, 3\\}$ 的 $\\delta(t)$。\n\n对于 $t=1$：\n$$\n\\delta(1) = r(1) + \\gamma V(2) - V(1) = 0 + (0.9)(0.3) - 0.2 = 0.27 - 0.2 = 0.07\n$$\n\n对于 $t=2$：\n$$\n\\delta(2) = r(2) + \\gamma V(3) - V(2) = 0 + (0.9)(0.4) - 0.3 = 0.36 - 0.3 = 0.06\n$$\n\n对于 $t=3$：\n幕在 $t=3$ 时终止，因此下一个状态是终止状态，其价值为 $V(4)=0$。\n$$\n\\delta(3) = r(3) + \\gamma V(4) - V(3) = 1 + (0.9)(0) - 0.4 = 1 - 0.4 = 0.6\n$$\n\n因此，TD 误差序列为 $\\delta(1)=0.07$, $\\delta(2)=0.06$, 和 $\\delta(3)=0.6$。\n\n第二步是计算相应的瞬时突触增量序列 $\\Delta w_{ij}(t)$。问题陈述该增量遵循三因子学习法则，即它与神经调节信号 ($\\delta(t)$) 和特定于突触的效用迹 ($e_{ij}(t)$) 的乘积成正比。比例常数是学习率 $\\eta$。其公式为：\n$$\n\\Delta w_{ij}(t) = \\eta \\cdot \\delta(t) \\cdot e_{ij}(t)\n$$\n\n我们还已知以下额外的值：\n- 学习率：$\\eta=0.2$。\n- 效用迹值：$e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$。\n\n使用这些值和先前计算的 TD 误差，我们可以计算每个时间步的 $\\Delta w_{ij}(t)$。\n\n对于 $t=1$：\n$$\n\\Delta w_{ij}(1) = \\eta \\cdot \\delta(1) \\cdot e_{ij}(1) = (0.2)(0.07)(0.5) = 0.014 \\cdot 0.5 = 0.007\n$$\n\n对于 $t=2$：\n$$\n\\Delta w_{ij}(2) = \\eta \\cdot \\delta(2) \\cdot e_{ij}(2) = (0.2)(0.06)(0.25) = 0.012 \\cdot 0.25 = 0.003\n$$\n\n对于 $t=3$：\n$$\n\\Delta w_{ij}(3) = \\eta \\cdot \\delta(3) \\cdot e_{ij}(3) = (0.2)(0.6)(0.1) = 0.12 \\cdot 0.1 = 0.012\n$$\n\n瞬时突触增量序列为 $\\Delta w_{ij}(1)=0.007$, $\\Delta w_{ij}(2)=0.003$, 和 $\\Delta w_{ij}(3)=0.012$。\n\n最终答案要求一个单行矩阵，按顺序包含两个序列 $[\\delta(1), \\delta(2), \\delta(3), \\Delta w_{ij}(1), \\Delta w_{ij}(2), \\Delta w_{ij}(3)]$。\n代入计算出的值，我们得到：\n$$\n[0.07, 0.06, 0.6, 0.007, 0.003, 0.012]\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.07  0.06  0.6  0.007  0.003  0.012\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "设计一个有效的学习系统，不仅需要正确的机制，还需要对参数进行优化。这个理论练习旨在解决时间信用分配这一核心挑战：一个神经元的活动如何与其在未来某个时刻收到的奖励信号正确关联？您需要推导出一个最优的“资格迹”时间常数，以最大化信噪比，从而揭示出学习规则的记忆时间尺度应如何匹配任务环境的时间尺度这一深刻的设计原则 。",
            "id": "4066352",
            "problem": "考虑一个脉冲神经网络中的单个突触，其权重由三因子学习法则更新，瞬时突触权重变化与效价迹和神经调质信号的乘积成正比。在单次试验中，权重变化为\n$$\n\\Delta w \\propto \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt,\n$$\n其中 $e(t)$ 是效价迹，$M(t)$ 是与奖励相关的神经调质信号。效价迹 $e(t)$ 由突触前脉冲产生，并按时间常数为 $\\tau_e$ 的线性滤波器演化：\n$$\n\\frac{d e(t)}{dt} = -\\frac{1}{\\tau_e} e(t) + \\sum_{k} \\delta(t - t_k),\n$$\n其中 $\\{t_k\\}$ 是突触前脉冲时间，$\\delta(\\cdot)$ 是狄拉克δ函数。假设：\n- 突触前脉冲序列由两部分叠加而成：一个速率为 $r$ 的背景齐次泊松过程，以及在 $t=0$ 出现提示的试验中的一个位于 $t=0$ 的额外突触前脉冲。\n- 奖励的神经调质信号是在提示后固定延迟 $\\tau_R  0$ 处的一个瞬时事件，模型为 $M(t) = \\delta(t - \\tau_R)$。\n\n将权重更新的信号贡献定义为由提示诱发的脉冲引起的平均增量权重变化，即有提示试验中的期望权重变化与无提示试验中的期望权重变化之差。将噪声定义为有提示试验中由背景突触前脉冲发放引起的权重变化的标准差。仅使用这些假设以及线性滤波和齐次泊松散粒噪声的基本性质，完成以下任务：\n\n1. 推导权重更新的信噪比 (SNR) 作为 $\\tau_e$、$\\tau_R$ 和 $r$ 的函数的表达式。\n2. 确定使该信噪比最大化的 $\\tau_e$ 的值。\n\n将最优 $\\tau_e$ 的最终答案表示为仅含 $\\tau_R$ 的闭式解析表达式。无需四舍五入，最终方框内的答案不应包含单位。",
            "solution": "该问题被评估为有效，因为它具有科学依据、数学上适定、客观，并包含获得唯一解所需的所有信息。这是计算神经科学中的一个标准理论问题。\n\n首先，我们确定效价迹 $e(t)$ 的显式形式。其动力学由以下一阶线性常微分方程给出：\n$$\n\\frac{d e(t)}{dt} + \\frac{1}{\\tau_e} e(t) = \\sum_{k} \\delta(t - t_k)\n$$\n这是一个线性时不变系统。对于 $t=0$ 处的单个输入脉冲，其冲激响应（即方程的解）为 $h(t) = \\exp(-t/\\tau_e)$（当 $t \\ge 0$ 时）。根据线性性质，时间 $t$ 的效价迹是所有先前的突触前脉冲 $\\{t_k\\}$ 响应的总和：\n$$\ne(t) = \\sum_{k \\text{ s.t. } t_k \\le t} \\exp\\left(-\\frac{t - t_k}{\\tau_e}\\right)\n$$\n在一次试验中，总权重变化 $\\Delta w$ 与效价迹 $e(t)$ 和神经调质信号 $M(t)$ 的乘积的积分成正比。设比例常数为 $A$。\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt\n$$\n已知神经调质信号为 $M(t) = \\delta(t - \\tau_R)$，我们可以使用狄拉克δ函数的筛选性质来计算该积分：\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, \\delta(t - \\tau_R)\\, dt = A \\cdot e(\\tau_R)\n$$\n将 $t=\\tau_R$ 时的 $e(t)$ 表达式代入：\n$$\n\\Delta w = A \\sum_{k \\text{ s.t. } t_k  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_k}{\\tau_e}\\right)\n$$\n注意我们使用 $t_k  \\tau_R$，因为如果一个脉冲恰好在 $t_k=\\tau_R$ 发生，它对 $e(\\tau_R)$ 没有贡献。\n\n问题指定了两种情况：有提示试验和无提示试验。\n在无提示试验中，突触前脉冲 $\\{t_k\\}$ 由速率为 $r$ 的齐次泊松过程生成。我们将这些脉冲时间的集合表示为 $\\{t_j^{\\text{bg}}\\}$。权重变化为：\n$$\n\\Delta w_{\\text{no-cue}} = A \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right)\n$$\n在有提示试验中，在 $t=0$ 处有一个额外的突触前脉冲。由于给定 $\\tau_R  0$，该脉冲发生在神经调质信号之前。脉冲序列是背景过程和提示脉冲的叠加。权重变化为：\n$$\n\\Delta w_{\\text{cue}} = A \\left( \\exp\\left(-\\frac{\\tau_R - 0}{\\tau_e}\\right) + \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right) \\right)\n$$\n$$\n\\Delta w_{\\text{cue}} = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\n$$\n\n现在我们根据问题中的定义计算信号和噪声。\n\n**1. 信号计算**\n信号是有提示试验和无提示试验中期望权重变化之差：\n$$\n\\text{Signal} = \\mathbb{E}[\\Delta w_{\\text{cue}}] - \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\n对 $\\Delta w_{\\text{cue}}$ 取期望：\n$$\n\\mathbb{E}[\\Delta w_{\\text{cue}}] = \\mathbb{E}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\n第一项是一个确定性常数。因此，信号为：\n$$\n\\text{Signal} = \\left(A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\\right) - \\mathbb{E}[\\Delta w_{\\text{no-cue}}] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)\n$$\n\n**2. 噪声计算**\n噪声是有提示试验中权重变化的标准差：\n$$\n\\text{Noise} = \\text{StdDev}[\\Delta w_{\\text{cue}}] = \\sqrt{\\text{Var}[\\Delta w_{\\text{cue}}]}\n$$\n我们计算 $\\Delta w_{\\text{cue}}$ 的方差：\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right]\n$$\n因为给一个随机变量加上一个常数不会改变其方差，我们有：\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}[\\Delta w_{\\text{no-cue}}]\n$$\n因此，噪声完全来自背景泊松脉冲序列的随机性。$\\Delta w_{\\text{no-cue}}$ 对应于一个在时间 $t=\\tau_R$ 处评估的滤波后的泊松过程，也称为散粒噪声。由速率为 $r$ 的齐次泊松过程生成的散粒噪声过程 $S(t) = \\sum_i h(t-t_i)$ 的方差由 Campbell's theorem 给出：$\\text{Var}[S(t)] = r \\int_{-\\infty}^{\\infty} h(\\tau)^2 d\\tau$。在我们的例子中，滤波是因果的，所以积分区间是 $[0, \\infty)$。\n量 $\\Delta w_{\\text{no-cue}} = A \\cdot e_{\\text{bg}}(\\tau_R)$，其中 $e_{\\text{bg}}(\\tau_R)$ 是由背景过程在 $\\tau_R$ 处产生的效价迹。对于平稳输入，$e_{\\text{bg}}(t)$ 的方差不随时间变化。\n$$\n\\text{Var}[e_{\\text{bg}}(t)] = r \\int_0^\\infty \\left[\\exp\\left(-\\frac{\\tau}{\\tau_e}\\right)\\right]^2 d\\tau = r \\int_0^\\infty \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) d\\tau\n$$\n$$\n= r \\left[ -\\frac{\\tau_e}{2} \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) \\right]_0^\\infty = r \\left( 0 - \\left(-\\frac{\\tau_e}{2}\\right) \\right) = \\frac{r \\tau_e}{2}\n$$\n那么，由背景过程引起的权重变化的方差为：\n$$\n\\text{Var}[\\Delta w_{\\text{no-cue}}] = \\text{Var}[A \\cdot e_{\\text{bg}}(\\tau_R)] = A^2 \\text{Var}[e_{\\text{bg}}(\\tau_R)] = A^2 \\frac{r \\tau_e}{2}\n$$\n噪声是标准差：\n$$\n\\text{Noise} = \\sqrt{A^2 \\frac{r \\tau_e}{2}} = A \\sqrt{\\frac{r \\tau_e}{2}}\n$$\n\n**3. 信噪比 (SNR) 及其最大化**\n信噪比 (SNR) 是信号与噪声之比：\n$$\n\\text{SNR}(\\tau_e) = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{A \\sqrt{\\frac{r \\tau_e}{2}}} = \\sqrt{\\frac{2}{r}} \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}\n$$\n这完成了问题的第一部分。为了找到使信噪比最大化的 $\\tau_e$ 的值，我们可以等价地最大化函数 $f(\\tau_e) = \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}$，因为 $\\sqrt{2/r}$ 是一个正常数。\n我们对 $f(\\tau_e)$ 关于 $\\tau_e$ 求导并令其为零。我们对 $f(\\tau_e) = \\exp(-\\tau_R/\\tau_e) \\cdot \\tau_e^{-1/2}$ 使用商法则：\n$$\n\\frac{df}{d\\tau_e} = \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(\\frac{\\tau_R}{\\tau_e^2}\\right) \\tau_e^{-1/2} + \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(-\\frac{1}{2} \\tau_e^{-3/2}\\right)\n$$\n将导数设为零，并提出公因式 $\\exp(-\\tau_R/\\tau_e) \\tau_e^{-3/2}$ (对于 $\\tau_e  0$，该项非零)：\n$$\n\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\tau_e^{-3/2} \\left( \\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} \\right) = 0\n$$\n这要求括号中的项为零：\n$$\n\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} = 0\n$$\n$$\n\\frac{\\tau_R}{\\tau_e} = \\frac{1}{2}\n$$\n解出 $\\tau_e$ 得到最优值：\n$$\n\\tau_e = 2 \\tau_R\n$$\n为确认这是一个最大值，我们可以检查该点附近一阶导数的符号。$\\frac{df}{d\\tau_e}$ 的符号由 $(\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2})$ 的符号决定。\n- 若 $\\tau_e  2\\tau_R$，则 $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$，所以 $\\frac{df}{d\\tau_e}  0$ (函数递增)。\n- 若 $\\tau_e  2\\tau_R$，则 $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$，所以 $\\frac{df}{d\\tau_e}  0$ (函数递减)。\n这证实了 $\\tau_e = 2 \\tau_R$ 是一个全局最大值。\n最优效价迹时间常数是奖励延迟的两倍。",
            "answer": "$$\\boxed{2\\tau_R}$$"
        }
    ]
}