{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete, step-by-step calculation of synaptic weight change in a model of neuromodulated plasticity. You will compute how synaptic eligibility, created by precise spike-timing interactions, is converted into a weight update by a time-varying third factor. Mastering this calculation builds a fundamental intuition for how the three components—presynaptic activity, postsynaptic activity, and a global signal—combine at the single-synapse level.",
            "id": "4066403",
            "problem": "Consider a single synapse from a presynaptic neuron $i$ to a postsynaptic neuron $j$ in a spiking neural network that implements a neuromodulator-gated, three-factor spike-timing dependent plasticity (STDP) mechanism. The synaptic weight change $\\Delta w_{ij}$ over a trial is determined by neuromodulator-gated eligibility generated by spike-timing interactions. The presynaptic spike times are $t_{i} \\in \\{10 \\ \\text{ms}, 50 \\ \\text{ms}, 95 \\ \\text{ms}, 140 \\ \\text{ms}\\}$ and the postsynaptic spike times are $t_{j} \\in \\{30 \\ \\text{ms}, 60 \\ \\text{ms}, 105 \\ \\text{ms}, 170 \\ \\text{ms}\\}$. The parameters governing the timing sensitivity are $A_{+} = 0.01$, $A_{-} = -0.012$, $\\tau_{+} = 20 \\ \\text{ms}$, and $\\tau_{-} = 20 \\ \\text{ms}$. The neuromodulatory signal $m(t)$ is piecewise constant over the trial: $m(t) = 0$ for $0 \\le t  40 \\ \\text{ms}$, $m(t) = 0.8$ for $40 \\le t  120 \\ \\text{ms}$, and $m(t) = -0.5$ for $120 \\le t \\le 200 \\ \\text{ms}$. Assume that the causal timing contribution is assigned when the postsynaptic spike occurs later than the presynaptic spike and the anti-causal timing contribution is assigned when the presynaptic spike occurs later than the postsynaptic spike, with the magnitude of each contribution determined by the corresponding exponential sensitivity using $\\tau_{+}$ or $\\tau_{-}$, and that the neuromodulatory factor $m(t)$ gates the contribution at the time the update is assigned (the later spike time for each pair). Using these assumptions and the given parameters, compute the total synaptic weight change $\\Delta w_{ij}$ over the entire trial by summing the neuromodulator-gated contributions over all ordered presynaptic–postsynaptic spike pairs. Express your final answer as a dimensionless quantity and round your result to seven significant figures.",
            "solution": "The user wants me to solve the problem. I need to output the solution.\nThe problem is validated as sound and well-posed. The concepts of three-factor spike-timing dependent plasticity (STDP), neuromodulation, and eligibility traces are fundamental to computational neuroscience and neuromorphic engineering. All necessary parameters and conditions are provided, and there are no internal contradictions.\n\nThe total synaptic weight change, $\\Delta w_{ij}$, is the sum of contributions from all ordered pairs of presynaptic spikes $(t_i)$ and postsynaptic spikes $(t_j)$. The contribution of each pair is determined by the product of an eligibility trace, $E(\\Delta t)$, and a neuromodulatory signal, $m(t)$.\nThe formula for the total weight change is:\n$$ \\Delta w_{ij} = \\sum_{t_i \\in T_i} \\sum_{t_j \\in T_j} \\delta w_{ij}(t_i, t_j) $$\nwhere $T_i$ is the set of presynaptic spike times and $T_j$ is the set of postsynaptic spike times. The contribution from a single pair, $\\delta w_{ij}(t_i, t_j)$, is given by:\n$$ \\delta w_{ij}(t_i, t_j) = m(t_{\\text{update}}) \\cdot E(\\Delta t) $$\nThe time of the update is specified as the time of the later spike in the pair, i.e., $t_{\\text{update}} = \\max(t_i, t_j)$. The time difference is $\\Delta t = t_j - t_i$. The eligibility trace, $E(\\Delta t)$, is defined by the standard STDP rule:\n$$ E(\\Delta t) = \\begin{cases} A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)  \\text{if } \\Delta t  0 \\ \\text{(causal, LTP)} \\\\ A_{-} \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right)  \\text{if } \\Delta t  0 \\ \\text{(anti-causal, LTD)} \\end{cases} $$\n\nThe given parameters are:\nPresynaptic spike times: $T_i = \\{10, 50, 95, 140\\}$ in units of ms.\nPostsynaptic spike times: $T_j = \\{30, 60, 105, 170\\}$ in units of ms.\nSTDP parameters: $A_{+} = 0.01$, $A_{-} = -0.012$, $\\tau_{+} = 20 \\ \\text{ms}$, $\\tau_{-} = 20 \\ \\text{ms}$.\nNeuromodulatory signal, $m(t)$:\n$$ m(t) = \\begin{cases} 0  \\text{for } 0 \\le t  40 \\ \\text{ms} \\\\ 0.8  \\text{for } 40 \\le t  120 \\ \\text{ms} \\\\ -0.5  \\text{for } 120 \\le t \\le 200 \\ \\text{ms} \\end{cases} $$\n\nWe will calculate the contribution for each of the $4 \\times 4 = 16$ spike pairs, grouping them by the value of the neuromodulatory signal $m(t_{\\text{update}})$.\n\n**1. Contributions with $m(t_{\\text{update}}) = 0$**\nThis applies to pairs where $t_{\\text{update}}  40 \\ \\text{ms}$.\n-   Pair $(t_i, t_j) = (10, 30)$: $\\Delta t = 20 \\ \\text{ms}$, $t_{\\text{update}} = 30 \\ \\text{ms}$. The neuromodulator value is $m(30) = 0$.\n    The contribution is $0 \\times \\left( A_{+} \\exp\\left(-\\frac{20}{20}\\right) \\right) = 0$.\n\n**2. Contributions with $m(t_{\\text{update}}) = 0.8$**\nThis applies to pairs where $40 \\le t_{\\text{update}}  120 \\ \\text{ms}$.\nCausal pairs ($\\Delta t  0$):\n-   $(10, 60)$: $\\Delta t = 50$, $t_{\\text{update}} = 60$. Contribution: $0.8 \\cdot A_{+} \\exp(-50/20) = 0.008 \\exp(-2.5)$.\n-   $(10, 105)$: $\\Delta t = 95$, $t_{\\text{update}} = 105$. Contribution: $0.8 \\cdot A_{+} \\exp(-95/20) = 0.008 \\exp(-4.75)$.\n-   $(50, 60)$: $\\Delta t = 10$, $t_{\\text{update}} = 60$. Contribution: $0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$.\n-   $(50, 105)$: $\\Delta t = 55$, $t_{\\text{update}} = 105$. Contribution: $0.8 \\cdot A_{+} \\exp(-55/20) = 0.008 \\exp(-2.75)$.\n-   $(95, 105)$: $\\Delta t = 10$, $t_{\\text{update}} = 105$. Contribution: $0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$.\nAnti-causal pairs ($\\Delta t  0$):\n-   $(50, 30)$: $\\Delta t = -20$, $t_{\\text{update}} = 50$. Contribution: $0.8 \\cdot A_{-} \\exp(-20/20) = 0.8(-0.012)\\exp(-1) = -0.0096 \\exp(-1)$.\n-   $(95, 30)$: $\\Delta t = -65$, $t_{\\text{update}} = 95$. Contribution: $0.8 \\cdot A_{-} \\exp(-65/20) = -0.0096 \\exp(-3.25)$.\n-   $(95, 60)$: $\\Delta t = -35$, $t_{\\text{update}} = 95$. Contribution: $0.8 \\cdot A_{-} \\exp(-35/20) = -0.0096 \\exp(-1.75)$.\n\nSum of contributions for this group, $\\Delta w_{0.8}$:\n$\\Delta w_{0.8} = 0.008(\\exp(-2.5) + \\exp(-4.75) + 2\\exp(-0.5) + \\exp(-2.75)) - 0.0096(\\exp(-1) + \\exp(-3.25) + \\exp(-1.75))$\n$\\Delta w_{0.8} \\approx 0.008(1.3677265) - 0.0096(0.5804276) \\approx 0.01094181 - 0.00557211 \\approx 0.00536970$.\n\n**3. Contributions with $m(t_{\\text{update}}) = -0.5$**\nThis applies to pairs where $120 \\le t_{\\text{update}} \\le 200 \\ \\text{ms}$.\nCausal pairs ($\\Delta t  0$):\n-   $(10, 170)$: $\\Delta t = 160$, $t_{\\text{update}} = 170$. Contribution: $-0.5 \\cdot A_{+} \\exp(-160/20) = -0.005 \\exp(-8)$.\n-   $(50, 170)$: $\\Delta t = 120$, $t_{\\text{update}} = 170$. Contribution: $-0.5 \\cdot A_{+} \\exp(-120/20) = -0.005 \\exp(-6)$.\n-   $(95, 170)$: $\\Delta t = 75$, $t_{\\text{update}} = 170$. Contribution: $-0.5 \\cdot A_{+} \\exp(-75/20) = -0.005 \\exp(-3.75)$.\n-   $(140, 170)$: $\\Delta t = 30$, $t_{\\text{update}} = 170$. Contribution: $-0.5 \\cdot A_{+} \\exp(-30/20) = -0.005 \\exp(-1.5)$.\nAnti-causal pairs ($\\Delta t  0$):\n-   $(140, 30)$: $\\Delta t = -110$, $t_{\\text{update}} = 140$. Contribution: $-0.5 \\cdot A_{-} \\exp(-110/20) = -0.5(-0.012)\\exp(-5.5) = 0.006 \\exp(-5.5)$.\n-   $(140, 60)$: $\\Delta t = -80$, $t_{\\text{update}} = 140$. Contribution: $-0.5 \\cdot A_{-} \\exp(-80/20) = 0.006 \\exp(-4)$.\n-   $(140, 105)$: $\\Delta t = -35$, $t_{\\text{update}} = 140$. Contribution: $-0.5 \\cdot A_{-} \\exp(-35/20) = 0.006 \\exp(-1.75)$.\n\nSum of contributions for this group, $\\Delta w_{-0.5}$:\n$\\Delta w_{-0.5} = -0.005(\\exp(-8) + \\exp(-6) + \\exp(-3.75) + \\exp(-1.5)) + 0.006(\\exp(-5.5) + \\exp(-4) + \\exp(-1.75))$\n$\\Delta w_{-0.5} \\approx -0.005(0.2494621) + 0.006(0.1961764) \\approx -0.00124731 + 0.00117706 \\approx -0.00007025$.\n\n**Total Synaptic Weight Change**\nThe total change $\\Delta w_{ij}$ is the sum of all contributions:\n$$ \\Delta w_{ij} = \\Delta w_{0} + \\Delta w_{0.8} + \\Delta w_{-0.5} $$\n$$ \\Delta w_{ij} \\approx 0 + 0.0053697072 - 0.0000702525 \\approx 0.0052994547 $$\nThe problem requires rounding the final answer to seven significant figures. The calculated value is $0.0052994547...$. The first seven significant digits are $5, 2, 9, 9, 4, 5, 4$. The eighth significant digit is $7$, which is $\\ge 5$, so we round up the seventh digit.\n$$ \\Delta w_{ij} \\approx 0.005299455 $$",
            "answer": "$$\n\\boxed{0.005299455}\n$$"
        },
        {
            "introduction": "This problem bridges the gap between low-level synaptic rules and high-level reinforcement learning (RL). You will calculate synaptic updates where the neuromodulatory signal is explicitly defined as a temporal-difference (TD) reward prediction error, a cornerstone concept in modern AI and neuroscience. This exercise demonstrates how three-factor rules provide a biologically plausible mechanism for implementing core components of sophisticated RL algorithms.",
            "id": "4066380",
            "problem": "Consider a discrete-time episodic reinforcement learning (RL) setting in which a scalar neuromodulatory signal gates synaptic plasticity through a three-factor learning rule. The neuromodulatory signal is the temporal-difference (TD) reward prediction error understood as the single-step Bellman residual for an episodic task whose terminal state has zero value. A postsynaptic neuron receives a reward sequence $r(1)=0$, $r(2)=0$, $r(3)=1$ over time steps $t \\in \\{1,2,3\\}$ within a single episode. The critic provides state value estimates $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$, and the discount factor is $\\gamma=0.9$. The episode terminates after $t=3$, and the terminal value is $V(4)=0$. For a particular synapse $(i,j)$, the synapse-specific eligibility trace values at the same time steps are given by $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$. Assume a constant learning rate $\\eta=0.2$, and that the instantaneous synaptic increment at time $t$ is proportional to the product of the neuromodulatory signal and the eligibility at that time.\n\nUsing only the definitions of the Bellman residual for finite-horizon episodic prediction and the three-factor neuromodulated plasticity principle, compute:\n- the sequence of temporal-difference errors $\\delta(1)$, $\\delta(2)$, $\\delta(3)$, and\n- the corresponding instantaneous synaptic increments $\\Delta w_{ij}(1)$, $\\Delta w_{ij}(2)$, $\\Delta w_{ij}(3)$.\n\nProvide the final answer as a single row matrix in the order $[\\delta(1),\\ \\delta(2),\\ \\delta(3),\\ \\Delta w_{ij}(1),\\ \\Delta w_{ij}(2),\\ \\Delta w_{ij}(3)]$. No rounding is required and no units are to be included in the final answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and complete. All necessary information is provided, and the requested calculations are based on standard principles of reinforcement learning and computational neuroscience.\n\nThe first step is to compute the sequence of temporal-difference (TD) errors, denoted by $\\delta(t)$. The problem defines the TD error as the single-step Bellman residual for an episodic task. The formula for the TD error at time step $t$ is:\n$$\n\\delta(t) = r(t) + \\gamma V(t+1) - V(t)\n$$\nwhere $r(t)$ is the reward received at time $t$, $V(t)$ is the estimated value of the state at time $t$, and $\\gamma$ is the discount factor.\n\nWe are given the following values:\n- Reward sequence: $r(1)=0$, $r(2)=0$, $r(3)=1$.\n- State value estimates: $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$.\n- Terminal state value: $V(4)=0$.\n- Discount factor: $\\gamma=0.9$.\n\nUsing these values, we can calculate $\\delta(t)$ for each time step $t \\in \\{1, 2, 3\\}$.\n\nFor $t=1$:\n$$\n\\delta(1) = r(1) + \\gamma V(2) - V(1) = 0 + (0.9)(0.3) - 0.2 = 0.27 - 0.2 = 0.07\n$$\n\nFor $t=2$:\n$$\n\\delta(2) = r(2) + \\gamma V(3) - V(2) = 0 + (0.9)(0.4) - 0.3 = 0.36 - 0.3 = 0.06\n$$\n\nFor $t=3$:\nThe episode terminates at $t=3$, so the next state is the terminal state with value $V(4)=0$.\n$$\n\\delta(3) = r(3) + \\gamma V(4) - V(3) = 1 + (0.9)(0) - 0.4 = 1 - 0.4 = 0.6\n$$\n\nThe sequence of TD errors is therefore $\\delta(1)=0.07$, $\\delta(2)=0.06$, and $\\delta(3)=0.6$.\n\nThe second step is to compute the corresponding sequence of instantaneous synaptic increments, $\\Delta w_{ij}(t)$. The problem states that this increment follows a three-factor learning rule where it is proportional to the product of the neuromodulatory signal ($\\delta(t)$) and the synapse-specific eligibility trace ($e_{ij}(t)$). The constant of proportionality is the learning rate $\\eta$. The formula is:\n$$\n\\Delta w_{ij}(t) = \\eta \\cdot \\delta(t) \\cdot e_{ij}(t)\n$$\n\nWe are given the additional values:\n- Learning rate: $\\eta=0.2$.\n- Eligibility trace values: $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$.\n\nUsing these values and the previously computed TD errors, we can calculate $\\Delta w_{ij}(t)$ for each time step.\n\nFor $t=1$:\n$$\n\\Delta w_{ij}(1) = \\eta \\cdot \\delta(1) \\cdot e_{ij}(1) = (0.2)(0.07)(0.5) = 0.014 \\cdot 0.5 = 0.007\n$$\n\nFor $t=2$:\n$$\n\\Delta w_{ij}(2) = \\eta \\cdot \\delta(2) \\cdot e_{ij}(2) = (0.2)(0.06)(0.25) = 0.012 \\cdot 0.25 = 0.003\n$$\n\nFor $t=3$:\n$$\n\\Delta w_{ij}(3) = \\eta \\cdot \\delta(3) \\cdot e_{ij}(3) = (0.2)(0.6)(0.1) = 0.12 \\cdot 0.1 = 0.012\n$$\n\nThe sequence of instantaneous synaptic increments is $\\Delta w_{ij}(1)=0.007$, $\\Delta w_{ij}(2)=0.003$, and $\\Delta w_{ij}(3)=0.012$.\n\nThe final answer requires a single row matrix containing both sequences in the order $[\\delta(1), \\delta(2), \\delta(3), \\Delta w_{ij}(1), \\Delta w_{ij}(2), \\Delta w_{ij}(3)]$.\nSubstituting the calculated values, we get:\n$$\n[0.07, 0.06, 0.6, 0.007, 0.003, 0.012]\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.07  0.06  0.6  0.007  0.003  0.012\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from direct calculation to theoretical principles, this final exercise explores a critical design question: how should a learning system's parameters be tuned for optimal performance? By analyzing a hypothetical scenario involving signal and noise, you will derive the optimal timescale for an eligibility trace to link events to delayed feedback. This reveals a fundamental principle for solving the credit assignment problem, showing that the memory of an event should be scaled to the expected delay of its consequence.",
            "id": "4066352",
            "problem": "Consider a single synapse in a spiking neural network updated by a three-factor learning rule, where the instantaneous synaptic weight change is proportional to the product of an eligibility trace and a neuromodulatory signal. Over a single trial, the weight change is\n$$\n\\Delta w \\propto \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt,\n$$\nwhere $e(t)$ is an eligibility trace and $M(t)$ is a neuromodulatory signal associated with reward. The eligibility trace $e(t)$ is generated by presynaptic spikes and evolves as a linear filter with time constant $\\tau_e$:\n$$\n\\frac{d e(t)}{dt} = -\\frac{1}{\\tau_e} e(t) + \\sum_{k} \\delta(t - t_k),\n$$\nwhere $\\{t_k\\}$ are the presynaptic spike times and $\\delta(\\cdot)$ is the Dirac delta. Assume that:\n- The presynaptic spike train is the superposition of a background homogeneous Poisson process of rate $r$ and, on trials where a cue at time $t=0$ is presented, a single additional presynaptic spike at $t=0$.\n- The neuromodulatory signal for reward is a punctual event at a fixed delay $\\tau_R  0$ after the cue, modeled as $M(t) = \\delta(t - \\tau_R)$.\n\nDefine the signal contribution to the weight update as the mean incremental weight change due to the cue-evoked spike, that is, the difference between the expected weight change on cue trials and the expected weight change on no-cue trials. Define the noise as the standard deviation of the weight change on cue trials arising from background presynaptic spiking. Using only these assumptions and fundamental properties of linear filtering and homogeneous Poisson shot noise, do the following:\n\n1. Derive an expression for the signal-to-noise ratio (SNR) of the weight update as a function of $\\tau_e$, $\\tau_R$, and $r$.\n2. Determine the value of $\\tau_e$ that maximizes this SNR.\n\nExpress your final answer for the optimal $\\tau_e$ as a closed-form analytic expression in terms of $\\tau_R$ only. No rounding is required, and no units should be provided in the final boxed answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, mathematically well-posed, objective, and contains all necessary information for a unique solution. It is a standard theoretical problem in computational neuroscience.\n\nFirst, we determine the explicit form of the eligibility trace $e(t)$. The dynamics are given by the first-order linear ordinary differential equation:\n$$\n\\frac{d e(t)}{dt} + \\frac{1}{\\tau_e} e(t) = \\sum_{k} \\delta(t - t_k)\n$$\nThis is a linear time-invariant system. The impulse response, which is the solution for a single input spike at $t=0$, is $h(t) = \\exp(-t/\\tau_e)$ for $t \\ge 0$. By linearity, the eligibility trace at time $t$ is the sum of the responses to all preceding presynaptic spikes $\\{t_k\\}$:\n$$\ne(t) = \\sum_{k \\text{ s.t. } t_k \\le t} \\exp\\left(-\\frac{t - t_k}{\\tau_e}\\right)\n$$\nThe total weight change $\\Delta w$ over a trial is proportional to the integral of the product of the eligibility trace $e(t)$ and the neuromodulatory signal $M(t)$. Let the constant of proportionality be $A$.\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt\n$$\nGiven the neuromodulatory signal is $M(t) = \\delta(t - \\tau_R)$, we can use the sifting property of the Dirac delta function to evaluate the integral:\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, \\delta(t - \\tau_R)\\, dt = A \\cdot e(\\tau_R)\n$$\nSubstituting the expression for $e(t)$ at $t=\\tau_R$:\n$$\n\\Delta w = A \\sum_{k \\text{ s.t. } t_k  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_k}{\\tau_e}\\right)\n$$\nNote we use $t_k  \\tau_R$ because if a spike occurs exactly at $t_k=\\tau_R$, it does not contribute to $e(\\tau_R)$.\n\nThe problem specifies two conditions: cue trials and no-cue trials.\nOn no-cue trials, the presynaptic spikes $\\{t_k\\}$ are generated by a homogeneous Poisson process with rate $r$. Let's denote the set of these spike times as $\\{t_j^{\\text{bg}}\\}$. The weight change is:\n$$\n\\Delta w_{\\text{no-cue}} = A \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right)\n$$\nOn cue trials, there is an additional presynaptic spike at $t=0$. Since $\\tau_R  0$ is given, this spike occurs before the neuromodulatory signal. The spike train is the superposition of the background process and the cue spike. The weight change is:\n$$\n\\Delta w_{\\text{cue}} = A \\left( \\exp\\left(-\\frac{\\tau_R - 0}{\\tau_e}\\right) + \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right) \\right)\n$$\n$$\n\\Delta w_{\\text{cue}} = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\n$$\n\nNow we compute the signal and noise as defined in the problem.\n\n**1. Signal Calculation**\nThe signal is the difference between the expected weight change on cue trials and no-cue trials:\n$$\n\\text{Signal} = \\mathbb{E}[\\Delta w_{\\text{cue}}] - \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\nTaking the expectation of $\\Delta w_{\\text{cue}}$:\n$$\n\\mathbb{E}[\\Delta w_{\\text{cue}}] = \\mathbb{E}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\nThe first term is a deterministic constant. Therefore, the signal is:\n$$\n\\text{Signal} = \\left(A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\\right) - \\mathbb{E}[\\Delta w_{\\text{no-cue}}] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)\n$$\n\n**2. Noise Calculation**\nThe noise is the standard deviation of the weight change on cue trials:\n$$\n\\text{Noise} = \\text{StdDev}[\\Delta w_{\\text{cue}}] = \\sqrt{\\text{Var}[\\Delta w_{\\text{cue}}]}\n$$\nWe compute the variance of $\\Delta w_{\\text{cue}}$:\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right]\n$$\nSince adding a constant does not change the variance of a random variable, we have:\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}[\\Delta w_{\\text{no-cue}}]\n$$\nThe noise is therefore entirely due to the stochasticity of the background Poisson spike train. $\\Delta w_{\\text{no-cue}}$ corresponds to a filtered Poisson process, also known as shot noise, evaluated at time $t=\\tau_R$. The variance of a shot noise process $S(t) = \\sum_i h(t-t_i)$ generated by a homogeneous Poisson process of rate $r$ is given by Campbell's theorem: $\\text{Var}[S(t)] = r \\int_{-\\infty}^{\\infty} h(\\tau)^2 d\\tau$. In our case, filtering is causal, so the integral is over $[0, \\infty)$.\nThe quantity $\\Delta w_{\\text{no-cue}} = A \\cdot e_{\\text{bg}}(\\tau_R)$, where $e_{\\text{bg}}(\\tau_R)$ is the eligibility trace at $\\tau_R$ from the background process. The variance of $e_{\\text{bg}}(t)$ for a stationary input is constant in time.\n$$\n\\text{Var}[e_{\\text{bg}}(t)] = r \\int_0^\\infty \\left[\\exp\\left(-\\frac{\\tau}{\\tau_e}\\right)\\right]^2 d\\tau = r \\int_0^\\infty \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) d\\tau\n$$\n$$\n= r \\left[ -\\frac{\\tau_e}{2} \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) \\right]_0^\\infty = r \\left( 0 - \\left(-\\frac{\\tau_e}{2}\\right) \\right) = \\frac{r \\tau_e}{2}\n$$\nThe variance of the weight change from the background is then:\n$$\n\\text{Var}[\\Delta w_{\\text{no-cue}}] = \\text{Var}[A \\cdot e_{\\text{bg}}(\\tau_R)] = A^2 \\text{Var}[e_{\\text{bg}}(\\tau_R)] = A^2 \\frac{r \\tau_e}{2}\n$$\nThe noise is the standard deviation:\n$$\n\\text{Noise} = \\sqrt{A^2 \\frac{r \\tau_e}{2}} = A \\sqrt{\\frac{r \\tau_e}{2}}\n$$\n\n**3. Signal-to-Noise Ratio (SNR) and its Maximization**\nThe SNR is the ratio of the signal to the noise:\n$$\n\\text{SNR}(\\tau_e) = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{A \\sqrt{\\frac{r \\tau_e}{2}}} = \\sqrt{\\frac{2}{r}} \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}\n$$\nThis completes the first part of the problem. To find the value of $\\tau_e$ that maximizes the SNR, we can equivalently maximize the function $f(\\tau_e) = \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}$, as $\\sqrt{2/r}$ is a positive constant.\nWe find the derivative of $f(\\tau_e)$ with respect to $\\tau_e$ and set it to zero. Let's use the quotient rule on $f(\\tau_e) = \\exp(-\\tau_R/\\tau_e) \\cdot \\tau_e^{-1/2}$:\n$$\n\\frac{df}{d\\tau_e} = \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(\\frac{\\tau_R}{\\tau_e^2}\\right) \\tau_e^{-1/2} + \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(-\\frac{1}{2} \\tau_e^{-3/2}\\right)\n$$\nSetting the derivative to zero, and factoring out the common term $\\exp(-\\tau_R/\\tau_e) \\tau_e^{-3/2}$ (which is non-zero for $\\tau_e  0$):\n$$\n\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\tau_e^{-3/2} \\left( \\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} \\right) = 0\n$$\nThis requires the term in the parenthesis to be zero:\n$$\n\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} = 0\n$$\n$$\n\\frac{\\tau_R}{\\tau_e} = \\frac{1}{2}\n$$\nSolving for $\\tau_e$ gives the optimal value:\n$$\n\\tau_e = 2 \\tau_R\n$$\nTo confirm this is a maximum, we can check the sign of the first derivative around this point. The sign of $\\frac{df}{d\\tau_e}$ is determined by the sign of $(\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2})$.\n- If $\\tau_e  2\\tau_R$, then $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$, so $\\frac{df}{d\\tau_e}  0$ (function is increasing).\n- If $\\tau_e  2\\tau_R$, then $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$, so $\\frac{df}{d\\tau_e}  0$ (function is decreasing).\nThis confirms that $\\tau_e = 2 \\tau_R$ is a global maximum.\nThe optimal eligibility trace time constant is twice the reward delay.",
            "answer": "$$\\boxed{2\\tau_R}$$"
        }
    ]
}