{
    "hands_on_practices": [
        {
            "introduction": "要想真正掌握三因子学习法则，我们必须从其基本机制入手。第一个练习提供了一个具体场景，其中包含特定的突触前和突触后脉冲时间，以及一个随时间变化的神经调质信号。通过细致地计算总的突触权重变化，您将亲身体验到脉冲时序依赖的可塑性（STDP）和全局第三因子是如何随时间相互作用以塑造突触强度的 。",
            "id": "4066403",
            "problem": "考虑一个尖峰神经网络中从突触前神经元 $i$ 到突触后神经元 $j$ 的单个突触，该网络实现了一种神经调质门控的三因子尖峰时间依赖可塑性（STDP）机制。在一个试验中，突触权重变化 $\\Delta w_{ij}$ 由尖峰时间相互作用产生的神经调质门控资格迹决定。突触前尖峰时间为 $t_{i} \\in \\{10 \\ \\text{ms}, 50 \\ \\text{ms}, 95 \\ \\text{ms}, 140 \\ \\text{ms}\\}$，突触后尖峰时间为 $t_{j} \\in \\{30 \\ \\text{ms}, 60 \\ \\text{ms}, 105 \\ \\text{ms}, 170 \\ \\text{ms}\\}$。控制时间敏感性的参数为 $A_{+} = 0.01$，$A_{-} = -0.012$，$\\tau_{+} = 20 \\ \\text{ms}$，以及 $\\tau_{-} = 20 \\ \\text{ms}$。神经调质信号 $m(t)$ 在试验期间是分段常数：当 $0 \\le t  40 \\ \\text{ms}$ 时，$m(t) = 0$；当 $40 \\le t  120 \\ \\text{ms}$ 时，$m(t) = 0.8$；当 $120 \\le t \\le 200 \\ \\text{ms}$ 时，$m(t) = -0.5$。假设当突触后尖峰晚于突触前尖峰发生时，分配因果时间贡献；而当突触前尖峰晚于突触后尖峰发生时，分配反因果时间贡献，每个贡献的大小由使用 $\\tau_{+}$ 或 $\\tau_{-}$ 的相应指数敏感性决定，并且神经调质因子 $m(t)$ 在分配更新的时刻（即每对尖峰中较晚的那个尖峰时间）门控该贡献。使用这些假设和给定参数，通过对所有有序的突触前-突触后尖峰对的神经调质门控贡献求和，计算整个试验过程中的总突触权重变化 $\\Delta w_{ij}$。将您的最终答案表示为一个无量纲量，并将结果四舍五入到七位有效数字。",
            "solution": "用户希望我解决这个问题。我需要输出解答。\n该问题被验证为合理且定义明确。三因子尖峰时间依赖可塑性（STDP）、神经调质和资格迹的概念是计算神经科学和神经形态工程的基础。所有必要的参数和条件都已提供，且没有内部矛盾。\n\n总突触权重变化 $\\Delta w_{ij}$ 是所有有序的突触前尖峰 $(t_i)$ 和突触后尖峰 $(t_j)$ 对的贡献之和。每对尖峰的贡献由资格迹 $E(\\Delta t)$ 和神经调质信号 $m(t)$ 的乘积决定。\n总权重变化的公式为：\n$$ \\Delta w_{ij} = \\sum_{t_i \\in T_i} \\sum_{t_j \\in T_j} \\delta w_{ij}(t_i, t_j) $$\n其中 $T_i$ 是突触前尖峰时间的集合，$T_j$ 是突触后尖峰时间的集合。来自单个尖峰对的贡献 $\\delta w_{ij}(t_i, t_j)$ 由以下公式给出：\n$$ \\delta w_{ij}(t_i, t_j) = m(t_{\\text{update}}) \\cdot E(\\Delta t) $$\n更新时间被指定为该对中较晚的尖峰时间，即 $t_{\\text{update}} = \\max(t_i, t_j)$。时间差为 $\\Delta t = t_j - t_i$。资格迹 $E(\\Delta t)$ 由标准STDP规则定义：\n$$ E(\\Delta t) = \\begin{cases} A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)  \\text{if } \\Delta t  0 \\ \\text{(causal, LTP)} \\\\ A_{-} \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right)  \\text{if } \\Delta t  0 \\ \\text{(anti-causal, LTD)} \\end{cases} $$\n\n给定的参数是：\n突触前尖峰时间：$T_i = \\{10, 50, 95, 140\\}$，单位为ms。\n突触后尖峰时间：$T_j = \\{30, 60, 105, 170\\}$，单位为ms。\nSTDP参数：$A_{+} = 0.01$，$A_{-} = -0.012$，$\\tau_{+} = 20 \\ \\text{ms}$，$\\tau_{-} = 20 \\ \\text{ms}$。\n神经调质信号，$m(t)$：\n$$ m(t) = \\begin{cases} 0  \\text{for } 0 \\le t  40 \\ \\text{ms} \\\\ 0.8  \\text{for } 40 \\le t  120 \\ \\text{ms} \\\\ -0.5  \\text{for } 120 \\le t \\le 200 \\ \\text{ms} \\end{cases} $$\n\n我们将计算 $4 \\times 4 = 16$ 个尖峰对中每一个的贡献，并根据神经调质信号 $m(t_{\\text{update}})$ 的值对它们进行分组。\n\n**1. $m(t_{\\text{update}}) = 0$ 时的贡献**\n这适用于 $t_{\\text{update}}  40 \\ \\text{ms}$ 的尖峰对。\n-   尖峰对 $(t_i, t_j) = (10, 30)$: $\\Delta t = 20 \\ \\text{ms}$, $t_{\\text{update}} = 30 \\ \\text{ms}$。神经调质值为 $m(30) = 0$。\n    贡献为 $0 \\times \\left( A_{+} \\exp\\left(-\\frac{20}{20}\\right) \\right) = 0$。\n\n**2. $m(t_{\\text{update}}) = 0.8$ 时的贡献**\n这适用于 $40 \\le t_{\\text{update}}  120 \\ \\text{ms}$ 的尖峰对。\n因果对 ($\\Delta t  0$):\n-   $(10, 60)$: $\\Delta t = 50$, $t_{\\text{update}} = 60$。贡献：$0.8 \\cdot A_{+} \\exp(-50/20) = 0.008 \\exp(-2.5)$。\n-   $(10, 105)$: $\\Delta t = 95$, $t_{\\text{update}} = 105$。贡献：$0.8 \\cdot A_{+} \\exp(-95/20) = 0.008 \\exp(-4.75)$。\n-   $(50, 60)$: $\\Delta t = 10$, $t_{\\text{update}} = 60$。贡献：$0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$。\n-   $(50, 105)$: $\\Delta t = 55$, $t_{\\text{update}} = 105$。贡献：$0.8 \\cdot A_{+} \\exp(-55/20) = 0.008 \\exp(-2.75)$。\n-   $(95, 105)$: $\\Delta t = 10$, $t_{\\text{update}} = 105$。贡献：$0.8 \\cdot A_{+} \\exp(-10/20) = 0.008 \\exp(-0.5)$。\n反因果对 ($\\Delta t  0$):\n-   $(50, 30)$: $\\Delta t = -20$, $t_{\\text{update}} = 50$。贡献：$0.8 \\cdot A_{-} \\exp(-20/20) = 0.8(-0.012)\\exp(-1) = -0.0096 \\exp(-1)$。\n-   $(95, 30)$: $\\Delta t = -65$, $t_{\\text{update}} = 95$。贡献：$0.8 \\cdot A_{-} \\exp(-65/20) = -0.0096 \\exp(-3.25)$。\n-   $(95, 60)$: $\\Delta t = -35$, $t_{\\text{update}} = 95$。贡献：$0.8 \\cdot A_{-} \\exp(-35/20) = -0.0096 \\exp(-1.75)$。\n\n该组的贡献总和，$\\Delta w_{0.8}$：\n$\\Delta w_{0.8} = 0.008(\\exp(-2.5) + \\exp(-4.75) + 2\\exp(-0.5) + \\exp(-2.75)) - 0.0096(\\exp(-1) + \\exp(-3.25) + \\exp(-1.75))$\n$\\Delta w_{0.8} \\approx 0.008(1.3677265) - 0.0096(0.5804276) \\approx 0.01094181 - 0.00557211 \\approx 0.00536970$。\n\n**3. $m(t_{\\text{update}}) = -0.5$ 时的贡献**\n这适用于 $120 \\le t_{\\text{update}} \\le 200 \\ \\text{ms}$ 的尖峰对。\n因果对 ($\\Delta t  0$):\n-   $(10, 170)$: $\\Delta t = 160$, $t_{\\text{update}} = 170$。贡献：$-0.5 \\cdot A_{+} \\exp(-160/20) = -0.005 \\exp(-8)$。\n-   $(50, 170)$: $\\Delta t = 120$, $t_{\\text{update}} = 170$。贡献：$-0.5 \\cdot A_{+} \\exp(-120/20) = -0.005 \\exp(-6)$。\n-   $(95, 170)$: $\\Delta t = 75$, $t_{\\text{update}} = 170$。贡献：$-0.5 \\cdot A_{+} \\exp(-75/20) = -0.005 \\exp(-3.75)$。\n-   $(140, 170)$: $\\Delta t = 30$, $t_{\\text{update}} = 170$。贡献：$-0.5 \\cdot A_{+} \\exp(-30/20) = -0.005 \\exp(-1.5)$。\n反因果对 ($\\Delta t  0$):\n-   $(140, 30)$: $\\Delta t = -110$, $t_{\\text{update}} = 140$。贡献：$-0.5 \\cdot A_{-} \\exp(-110/20) = -0.5(-0.012)\\exp(-5.5) = 0.006 \\exp(-5.5)$。\n-   $(140, 60)$: $\\Delta t = -80$, $t_{\\text{update}} = 140$。贡献：$-0.5 \\cdot A_{-} \\exp(-80/20) = 0.006 \\exp(-4)$。\n-   $(140, 105)$: $\\Delta t = -35$, $t_{\\text{update}} = 140$。贡献：$-0.5 \\cdot A_{-} \\exp(-35/20) = 0.006 \\exp(-1.75)$。\n\n该组的贡献总和，$\\Delta w_{-0.5}$：\n$\\Delta w_{-0.5} = -0.005(\\exp(-8) + \\exp(-6) + \\exp(-3.75) + \\exp(-1.5)) + 0.006(\\exp(-5.5) + \\exp(-4) + \\exp(-1.75))$\n$\\Delta w_{-0.5} \\approx -0.005(0.2494621) + 0.006(0.1961764) \\approx -0.00124731 + 0.00117706 \\approx -0.00007025$。\n\n**总突触权重变化**\n总变化 $\\Delta w_{ij}$ 是所有贡献的总和：\n$$ \\Delta w_{ij} = \\Delta w_{0} + \\Delta w_{0.8} + \\Delta w_{-0.5} $$\n$$ \\Delta w_{ij} \\approx 0 + 0.0053697072 - 0.0000702525 \\approx 0.0052994547 $$\n问题要求将最终答案四舍五入到七位有效数字。计算值为 $0.0052994547...$。前七位有效数字是 $5, 2, 9, 9, 4, 5, 4$。第八位有效数字是 $7$，大于等于 $5$，所以我们将第七位数字向上取整。\n$$ \\Delta w_{ij} \\approx 0.005299455 $$",
            "answer": "$$\n\\boxed{0.005299455}\n$$"
        },
        {
            "introduction": "在掌握了基本机制之后，我们现在将在强化学习的背景下探索三因子法则的功能意义。本练习将神经调质信号定义为时间差分（TD）误差，这是从奖励中学习的关键信号。通过根据 TD 误差和局部资格迹计算突触更新，您将看到单个突触如何实现强大的学习算法，从而将突触可塑性与目标导向行为直接联系起来 。",
            "id": "4066380",
            "problem": "考虑一个离散时间回合制强化学习（RL）情景，其中一个标量神经调节信号通过三因子学习法则来门控突触可塑性。该神经调节信号是时间差分（TD）奖励预测误差，可理解为终止状态值为零的回合制任务的单步Bellman残差。在单个回合内，一个突触后神经元在时间步 $t \\in \\{1,2,3\\}$ 上接收到奖励序列 $r(1)=0$, $r(2)=0$, $r(3)=1$。评论家提供的状态价值估计为 $V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$，折扣因子为 $\\gamma=0.9$。该回合在 $t=3$ 后终止，终止状态的价值为 $V(4)=0$。对于一个特定的突触 $(i,j)$，其在相同时间步的突触特异性资格迹值为 $e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$。假设学习率为常数 $\\eta=0.2$，并且在时间 $t$ 的瞬时突触增量与该时间的神经调节信号和资格迹值的乘积成正比。\n\n仅使用有限期回合制预测的Bellman残差定义和三因子神经调节可塑性原理，计算：\n- 时间差分误差序列 $\\delta(1)$, $\\delta(2)$, $\\delta(3)$，以及\n- 相应的瞬时突触增量 $\\Delta w_{ij}(1)$, $\\Delta w_{ij}(2)$, $\\Delta w_{ij}(3)$。\n\n以单行矩阵的形式提供最终答案，顺序为 $[\\delta(1),\\ \\delta(2),\\ \\delta(3),\\ \\Delta w_{ij}(1),\\ \\Delta w_{ij}(2),\\ \\Delta w_{ij}(3)]$。无需四舍五入，最终答案中不包含任何单位。",
            "solution": "该问题被验证为具有科学依据、适定且完整。所有必要信息均已提供，所要求的计算基于强化学习和计算神经科学的标准原理。\n\n第一步是计算时间差分（TD）误差序列，记为 $\\delta(t)$。问题将TD误差定义为回合制任务的单步Bellman残差。时间步 $t$ 的TD误差公式为：\n$$\n\\delta(t) = r(t) + \\gamma V(t+1) - V(t)\n$$\n其中 $r(t)$ 是在时间 $t$ 收到的奖励，$V(t)$ 是在时间 $t$ 的状态价值估计，$\\gamma$ 是折扣因子。\n\n我们已知以下值：\n- 奖励序列：$r(1)=0$, $r(2)=0$, $r(3)=1$。\n- 状态价值估计：$V(1)=0.2$, $V(2)=0.3$, $V(3)=0.4$。\n- 终止状态价值：$V(4)=0$。\n- 折扣因子：$\\gamma=0.9$。\n\n使用这些值，我们可以为每个时间步 $t \\in \\{1, 2, 3\\}$ 计算 $\\delta(t)$。\n\n对于 $t=1$:\n$$\n\\delta(1) = r(1) + \\gamma V(2) - V(1) = 0 + (0.9)(0.3) - 0.2 = 0.27 - 0.2 = 0.07\n$$\n\n对于 $t=2$:\n$$\n\\delta(2) = r(2) + \\gamma V(3) - V(2) = 0 + (0.9)(0.4) - 0.3 = 0.36 - 0.3 = 0.06\n$$\n\n对于 $t=3$:\n回合在 $t=3$ 终止，所以下一个状态是终止状态，其价值为 $V(4)=0$。\n$$\n\\delta(3) = r(3) + \\gamma V(4) - V(3) = 1 + (0.9)(0) - 0.4 = 1 - 0.4 = 0.6\n$$\n\n因此，TD误差序列为 $\\delta(1)=0.07$, $\\delta(2)=0.06$, $\\delta(3)=0.6$。\n\n第二步是计算相应的瞬时突触增量序列 $\\Delta w_{ij}(t)$。问题指出，该增量遵循三因子学习法则，即它与神经调节信号（$\\delta(t)$）和突触特异性资格迹（$e_{ij}(t)$）的乘积成正比。比例常数是学习率 $\\eta$。其公式为：\n$$\n\\Delta w_{ij}(t) = \\eta \\cdot \\delta(t) \\cdot e_{ij}(t)\n$$\n\n我们还已知以下附加值：\n- 学习率：$\\eta=0.2$。\n- 资格迹值：$e_{ij}(1)=0.5$, $e_{ij}(2)=0.25$, $e_{ij}(3)=0.1$。\n\n使用这些值和先前计算的TD误差，我们可以计算每个时间步的 $\\Delta w_{ij}(t)$。\n\n对于 $t=1$:\n$$\n\\Delta w_{ij}(1) = \\eta \\cdot \\delta(1) \\cdot e_{ij}(1) = (0.2)(0.07)(0.5) = 0.014 \\cdot 0.5 = 0.007\n$$\n\n对于 $t=2$:\n$$\n\\Delta w_{ij}(2) = \\eta \\cdot \\delta(2) \\cdot e_{ij}(2) = (0.2)(0.06)(0.25) = 0.012 \\cdot 0.25 = 0.003\n$$\n\n对于 $t=3$:\n$$\n\\Delta w_{ij}(3) = \\eta \\cdot \\delta(3) \\cdot e_{ij}(3) = (0.2)(0.6)(0.1) = 0.12 \\cdot 0.1 = 0.012\n$$\n\n瞬时突触增量序列为 $\\Delta w_{ij}(1)=0.007$, $\\Delta w_{ij}(2)=0.003$, $\\Delta w_{ij}(3)=0.012$。\n\n最终答案要求一个单行矩阵，按顺序包含两个序列 $[\\delta(1), \\delta(2), \\delta(3), \\Delta w_{ij}(1), \\Delta w_{ij}(2), \\Delta w_{ij}(3)]$。代入计算出的值，我们得到：\n$$\n[0.07, 0.06, 0.6, 0.007, 0.003, 0.012]\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.07  0.06  0.6  0.007  0.003  0.012\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "学习中的一个关键挑战是为延迟的结果分配合理的信度。最后的这个练习深入探讨了优化这种时间信度分配的理论原则。您将推导出一个资格迹的最优时间常数，以最好地将神经事件与延迟的奖励联系起来，揭示突触参数与学习任务的时间结构之间的基本关系 。",
            "id": "4066352",
            "problem": "考虑一个脉冲神经网络中的单个突触，其更新遵循三因子学习法则，即瞬时突触权重变化与资格迹和神经调节信号的乘积成正比。在单次试验中，权重变化为\n$$\n\\Delta w \\propto \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt,\n$$\n其中 $e(t)$ 是资格迹，$M(t)$ 是与奖励相关的神经调节信号。资格迹 $e(t)$ 由突触前脉冲产生，并作为一个时间常数为 $\\tau_e$ 的线性滤波器进行演化：\n$$\n\\frac{d e(t)}{dt} = -\\frac{1}{\\tau_e} e(t) + \\sum_{k} \\delta(t - t_k),\n$$\n其中 $\\{t_k\\}$ 是突触前脉冲时间，$\\delta(\\cdot)$ 是狄拉克δ函数。假设：\n- 突触前脉冲序列是一个速率为 $r$ 的背景均匀泊松过程，与在 $t=0$ 时刻出现提示的试验中位于 $t=0$ 的单个额外突触前脉冲的叠加。\n- 奖励的神经调节信号是在提示后固定延迟 $\\tau_R  0$ 处的一个瞬时事件，建模为 $M(t) = \\delta(t - \\tau_R)$。\n\n将权重更新的信号贡献定义为由提示诱发的脉冲引起的平均增量权重变化，即提示试验中的期望权重变化与无提示试验中的期望权重变化之差。将噪声定义为提示试验中由背景突触前脉冲发放引起的权重变化的标准差。仅使用这些假设以及线性滤波和均匀泊松散粒噪声的基本性质，完成以下任务：\n\n1. 推导权重更新的信噪比 (SNR) 作为 $\\tau_e$、$\\tau_R$ 和 $r$ 的函数的表达式。\n2. 确定使此信噪比最大化的 $\\tau_e$ 的值。\n\n将最优 $\\tau_e$ 的最终答案表示为仅含 $\\tau_R$ 的闭式解析表达式。无需四舍五入，最终方框内的答案不应包含单位。",
            "solution": "该问题经评估是有效的，因为它具有科学依据、在数学上是适定的、客观的，并包含得出唯一解所需的所有信息。这是计算神经科学中的一个标准理论问题。\n\n首先，我们确定资格迹 $e(t)$ 的显式形式。其动力学由以下一阶线性常微分方程给出：\n$$\n\\frac{d e(t)}{dt} + \\frac{1}{\\tau_e} e(t) = \\sum_{k} \\delta(t - t_k)\n$$\n这是一个线性时不变系统。对于 $t=0$ 时的单个输入脉冲，其脉冲响应（即解）为 $h(t) = \\exp(-t/\\tau_e)$（当 $t \\ge 0$ 时）。根据线性性质，时刻 $t$ 的资格迹是所有先前突触前脉冲 $\\{t_k\\}$ 响应的总和：\n$$\ne(t) = \\sum_{k \\text{ s.t. } t_k \\le t} \\exp\\left(-\\frac{t - t_k}{\\tau_e}\\right)\n$$\n单次试验中的总权重变化 $\\Delta w$ 与资格迹 $e(t)$ 和神经调节信号 $M(t)$ 的乘积的积分成正比。设比例常数为 $A$。\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, M(t)\\, dt\n$$\n给定神经调节信号为 $M(t) = \\delta(t - \\tau_R)$，我们可以使用狄拉克δ函数的筛选性质来计算该积分：\n$$\n\\Delta w = A \\int_{-\\infty}^{\\infty} e(t)\\, \\delta(t - \\tau_R)\\, dt = A \\cdot e(\\tau_R)\n$$\n将 $t=\\tau_R$ 时的 $e(t)$ 表达式代入：\n$$\n\\Delta w = A \\sum_{k \\text{ s.t. } t_k  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_k}{\\tau_e}\\right)\n$$\n注意我们使用 $t_k  \\tau_R$ 是因为如果一个脉冲恰好在 $t_k=\\tau_R$ 时刻发生，它对 $e(\\tau_R)$ 没有贡献。\n\n题目指定了两种情况：提示试验和无提示试验。\n在无提示试验中，突触前脉冲 $\\{t_k\\}$ 由速率为 $r$ 的均匀泊松过程生成。我们将这些脉冲时间的集合表示为 $\\{t_j^{\\text{bg}}\\}$。权重变化为：\n$$\n\\Delta w_{\\text{no-cue}} = A \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right)\n$$\n在提示试验中，在 $t=0$ 时刻有一个额外的突触前脉冲。由于给定 $\\tau_R  0$，该脉冲发生在神经调节信号之前。脉冲序列是背景过程和提示脉冲的叠加。权重变化为：\n$$\n\\Delta w_{\\text{cue}} = A \\left( \\exp\\left(-\\frac{\\tau_R - 0}{\\tau_e}\\right) + \\sum_{j \\text{ s.t. } t_j^{\\text{bg}}  \\tau_R} \\exp\\left(-\\frac{\\tau_R - t_j^{\\text{bg}}}{\\tau_e}\\right) \\right)\n$$\n$$\n\\Delta w_{\\text{cue}} = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\n$$\n\n现在我们按照题目中的定义计算信号和噪声。\n\n**1. 信号计算**\n信号是提示试验和无提示试验中期望权重变化之差：\n$$\n\\text{Signal} = \\mathbb{E}[\\Delta w_{\\text{cue}}] - \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\n对 $\\Delta w_{\\text{cue}}$ 取期望：\n$$\n\\mathbb{E}[\\Delta w_{\\text{cue}}] = \\mathbb{E}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\n$$\n第一项是一个确定性常数。因此，信号为：\n$$\n\\text{Signal} = \\left(A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\mathbb{E}[\\Delta w_{\\text{no-cue}}]\\right) - \\mathbb{E}[\\Delta w_{\\text{no-cue}}] = A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)\n$$\n\n**2. 噪声计算**\n噪声是提示试验中权重变化的标准差：\n$$\n\\text{Noise} = \\text{StdDev}[\\Delta w_{\\text{cue}}] = \\sqrt{\\text{Var}[\\Delta w_{\\text{cue}}]}\n$$\n我们计算 $\\Delta w_{\\text{cue}}$ 的方差：\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}\\left[A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) + \\Delta w_{\\text{no-cue}}\\right]\n$$\n由于给一个随机变量加上一个常数不会改变其方差，我们有：\n$$\n\\text{Var}[\\Delta w_{\\text{cue}}] = \\text{Var}[\\Delta w_{\\text{no-cue}}]\n$$\n因此，噪声完全来自背景泊松脉冲序列的随机性。$\\Delta w_{\\text{no-cue}}$ 对应于一个在 $t=\\tau_R$ 时刻取值的滤波泊松过程，也称为散粒噪声。由速率为 $r$ 的均匀泊松过程生成的散粒噪声过程 $S(t) = \\sum_i h(t-t_i)$ 的方差由坎贝尔定理给出：$\\text{Var}[S(t)] = r \\int_{-\\infty}^{\\infty} h(\\tau)^2 d\\tau$。在我们的例子中，滤波是因果的，所以积分区间是 $[0, \\infty)$。\n量 $\\Delta w_{\\text{no-cue}} = A \\cdot e_{\\text{bg}}(\\tau_R)$，其中 $e_{\\text{bg}}(\\tau_R)$ 是由背景过程产生的在 $\\tau_R$ 时刻的资格迹。对于一个平稳输入， $e_{\\text{bg}}(t)$ 的方差不随时间变化。\n$$\n\\text{Var}[e_{\\text{bg}}(t)] = r \\int_0^\\infty \\left[\\exp\\left(-\\frac{\\tau}{\\tau_e}\\right)\\right]^2 d\\tau = r \\int_0^\\infty \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) d\\tau\n$$\n$$\n= r \\left[ -\\frac{\\tau_e}{2} \\exp\\left(-\\frac{2\\tau}{\\tau_e}\\right) \\right]_0^\\infty = r \\left( 0 - \\left(-\\frac{\\tau_e}{2}\\right) \\right) = \\frac{r \\tau_e}{2}\n$$\n那么，由背景过程引起的权重变化的方差为：\n$$\n\\text{Var}[\\Delta w_{\\text{no-cue}}] = \\text{Var}[A \\cdot e_{\\text{bg}}(\\tau_R)] = A^2 \\text{Var}[e_{\\text{bg}}(\\tau_R)] = A^2 \\frac{r \\tau_e}{2}\n$$\n噪声是标准差：\n$$\n\\text{Noise} = \\sqrt{A^2 \\frac{r \\tau_e}{2}} = A \\sqrt{\\frac{r \\tau_e}{2}}\n$$\n\n**3. 信噪比 (SNR) 及其最大化**\n信噪比是信号与噪声的比值：\n$$\n\\text{SNR}(\\tau_e) = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{A \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{A \\sqrt{\\frac{r \\tau_e}{2}}} = \\sqrt{\\frac{2}{r}} \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}\n$$\n这就完成了问题的第一部分。为了找到使信噪比最大化的 $\\tau_e$ 值，我们可以等价地最大化函数 $f(\\tau_e) = \\frac{\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right)}{\\sqrt{\\tau_e}}$，因为 $\\sqrt{2/r}$ 是一个正常数。\n我们求 $f(\\tau_e)$ 关于 $\\tau_e$ 的导数并令其为零。我们对 $f(\\tau_e) = \\exp(-\\tau_R/\\tau_e) \\cdot \\tau_e^{-1/2}$ 使用积法则：\n$$\n\\frac{df}{d\\tau_e} = \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(\\frac{\\tau_R}{\\tau_e^2}\\right) \\tau_e^{-1/2} + \\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\left(-\\frac{1}{2} \\tau_e^{-3/2}\\right)\n$$\n将导数设为零，并提出公因式 $\\exp(-\\tau_R/\\tau_e) \\tau_e^{-3/2}$（当 $\\tau_e  0$ 时，该项非零）：\n$$\n\\exp\\left(-\\frac{\\tau_R}{\\tau_e}\\right) \\tau_e^{-3/2} \\left( \\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} \\right) = 0\n$$\n这要求括号中的项为零：\n$$\n\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2} = 0\n$$\n$$\n\\frac{\\tau_R}{\\tau_e} = \\frac{1}{2}\n$$\n解出 $\\tau_e$ 得到最优值：\n$$\n\\tau_e = 2 \\tau_R\n$$\n为了确认这是一个最大值，我们可以检查该点附近一阶导数的符号。$\\frac{df}{d\\tau_e}$ 的符号由 $(\\frac{\\tau_R}{\\tau_e} - \\frac{1}{2})$ 的符号决定。\n- 如果 $\\tau_e  2\\tau_R$，那么 $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$，所以 $\\frac{df}{d\\tau_e}  0$（函数递增）。\n- 如果 $\\tau_e  2\\tau_R$，那么 $\\frac{\\tau_R}{\\tau_e}  \\frac{1}{2}$，所以 $\\frac{df}{d\\tau_e}  0$（函数递减）。\n这证实了 $\\tau_e = 2 \\tau_R$ 是一个全局最大值。\n最优资格迹时间常数是奖励延迟的两倍。",
            "answer": "$$\\boxed{2\\tau_R}$$"
        }
    ]
}