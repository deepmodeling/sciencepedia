{
    "hands_on_practices": [
        {
            "introduction": "三联体和电压依赖STDP模型的核心是突触痕迹（synaptic trace）的概念，这些痕迹在不同时间尺度上整合了脉冲历史。这个练习旨在通过一个具体的脉冲序列，动手计算突触前和突触后痕迹的动态演化过程。通过这个基本计算，你将深入理解时间常数（例如 $\\tau_x$ 和 $\\tau_y$）如何塑造模型对单个脉冲和脉冲簇的敏感性，这是掌握更复杂可塑性规则的基础。",
            "id": "4066540",
            "problem": "考虑典型的脉冲时序依赖可塑性（STDP）三联体模型，其中突触前和突触后活动分别由两个标量迹 $x(t)$ 和 $y(t)$ 追踪。在三联体模型中，这些迹用于构建对脉冲模式（如脉冲簇）的高阶时间敏感性。在基于电压的 STDP 模型中，类似的迹可以通过突触后膜电压来门控可塑性；在此，我们专注于迹动力学本身，以分离时间常数如何影响敏感性。\n\n假设迹具有以下标准动力学假设：在脉冲之间，每个迹以其自身的时间常数指数衰减；在脉冲到达时，相应的迹会跳跃一个固定的增量。具体来说，对于时间为 $\\{t_{k}^{\\mathrm{pre}}\\}$ 的突触前脉冲和时间为 $\\{t_{m}^{\\mathrm{post}}\\}$ 的突触后脉冲，这些迹遵循 $x(0^{-}) = 0$, $y(0^{-}) = 0$，并且对于 $t \\geq 0$：\n- 在脉冲之间，$\\frac{dx}{dt} = -\\frac{x}{\\tau_{x}}$ 和 $\\frac{dy}{dt} = -\\frac{y}{\\tau_{y}}$，\n- 在每个突触前脉冲时间 $t_{k}^{\\mathrm{pre}}$，$x(t_{k}^{\\mathrm{pre},+}) = x(t_{k}^{\\mathrm{pre},-}) + a_{x}$，\n- 在每个突触后脉冲时间 $t_{m}^{\\mathrm{post}}$，$y(t_{m}^{\\mathrm{post},+}) = y(t_{m}^{\\mathrm{post},-}) + a_{y}$，\n固定增量为 $a_{x} = 1$ 和 $a_{y} = 1$。\n\n考虑一个简单的脉冲簇序列，旨在探测模型对短脉冲间隔和较长间隙的敏感性：突触前脉冲发生在时间 $t = 0\\,\\mathrm{ms}$、$t = 4\\,\\mathrm{ms}$、$t = 8\\,\\mathrm{ms}$（一个包含3个脉冲的脉冲簇）和 $t = 40\\,\\mathrm{ms}$（一个孤立脉冲）；突触后脉冲发生在时间 $t = 9\\,\\mathrm{ms}$ 和 $t = 44\\,\\mathrm{ms}$。将迹的振幅视为无量纲。\n\n从上述动力学假设出发，推导 $t \\geq 0$ 时 $x(t)$ 和 $y(t)$ 的闭式表达式。然后，为了明确其对时间常数的依赖关系，在特定时间 $t^{*} = 12\\,\\mathrm{ms}$ 处计算比率 $R(t^{*}) = \\frac{y(t^{*})}{x(t^{*})}$。\n\n将最终比率 $R(t^{*})$ 表示为关于 $\\tau_{x}$ 和 $\\tau_{y}$ 的单个闭式解析表达式。最终答案必须是无量纲的。不需要进行数值舍入。",
            "solution": "该问题具有科学依据，提法明确，并包含得出唯一解所需的所有信息。它描述了一个突触迹动力学的典型模型，这是计算神经科学中的一个基本概念。任务是在给定一系列事件的情况下，确定这些迹在特定时间的状态。\n\n$x(t)$ 和 $y(t)$ 这两个迹的动力学由一阶线性常微分方程描述，其系数为常数，并在指定时间点发生瞬时跳跃。对于由 $\\frac{dz}{dt} = -\\frac{z}{\\tau_z}$ 和初始条件 $z(t_0) = z_0$ 控制的迹 $z(t)$，其通解为 $z(t) = z_0 \\exp\\left(-\\frac{t-t_0}{\\tau_z}\\right)$（对于 $t  t_0$）。\n\n由于系统的线性特性，任何时间 $t$ 处迹的值是过去所有脉冲衰减影响的总和。对于一个在脉冲时间 $\\{t_i\\}$ 处跳跃振幅为 $a_z$、且从 $z(0^-)=0$ 开始的迹 $z(t)$，其解可以表示为叠加形式：\n$$z(t) = \\sum_{t_i  t} a_z \\exp\\left(-\\frac{t - t_i}{\\tau_z}\\right)$$\n\n题目要求我们在特定时间 $t^{*} = 12\\,\\mathrm{ms}$ 处计算比率 $R(t^{*}) = \\frac{y(t^{*})}{x(t^{*})}$。我们将分别计算 $x(t^{*})$ 和 $y(t^{*})$。\n\n首先，我们确定突触前迹 $x(t)$ 在 $t^{*} = 12$ 时的值。突触前脉冲 $\\{t_{k}^{\\mathrm{pre}}\\}$ 发生在时间 $t = 0\\,\\mathrm{ms}$、$t = 4\\,\\mathrm{ms}$、$t = 8\\,\\mathrm{ms}$ 和 $t = 40\\,\\mathrm{ms}$。增量为 $a_x = 1$。只有在 $t^{*} = 12$ 之前发生的脉冲才会对 $x(12)$ 有贡献。这些脉冲发生在 $t=0$、$t=4$ 和 $t=8$。\n\n使用叠加原理，我们将这三个脉冲的贡献相加：\n$$x(t^{*}) = x(12) = a_x \\exp\\left(-\\frac{12 - 0}{\\tau_x}\\right) + a_x \\exp\\left(-\\frac{12 - 4}{\\tau_x}\\right) + a_x \\exp\\left(-\\frac{12 - 8}{\\tau_x}\\right)$$\n代入 $a_x = 1$ 并简化时间差：\n$$x(12) = \\exp\\left(-\\frac{12}{\\tau_x}\\right) + \\exp\\left(-\\frac{8}{\\tau_x}\\right) + \\exp\\left(-\\frac{4}{\\tau_x}\\right)$$\n\n接下来，我们确定突触后迹 $y(t)$ 在 $t^{*} = 12$ 时的值。突触后脉冲 $\\{t_{m}^{\\mathrm{post}}\\}$ 发生在时间 $t = 9\\,\\mathrm{ms}$ 和 $t = 44\\,\\mathrm{ms}$。增量为 $a_y = 1$。只有在 $t^{*} = 12$ 之前发生的脉冲才会对 $y(12)$ 有贡献。唯一的此类脉冲发生在 $t=9$。\n\n对 $y$ 迹使用叠加原理：\n$$y(t^{*}) = y(12) = a_y \\exp\\left(-\\frac{12 - 9}{\\tau_y}\\right)$$\n代入 $a_y = 1$ 并简化时间差：\n$$y(12) = \\exp\\left(-\\frac{3}{\\tau_y}\\right)$$\n\n最后，我们计算比率 $R(t^{*}) = R(12)$。\n$$R(12) = \\frac{y(12)}{x(12)} = \\frac{\\exp\\left(-\\frac{3}{\\tau_y}\\right)}{\\exp\\left(-\\frac{12}{\\tau_x}\\right) + \\exp\\left(-\\frac{8}{\\tau_x}\\right) + \\exp\\left(-\\frac{4}{\\tau_x}\\right)}$$\n这就是以时间常数 $\\tau_x$ 和 $\\tau_y$ 表示的比率的最终闭式表达式。该表达式是无量纲的，因为 $x(t)$ 和 $y(t)$ 都是无量纲的。",
            "answer": "$$\\boxed{\\frac{\\exp\\left(-\\frac{3}{\\tau_{y}}\\right)}{\\exp\\left(-\\frac{12}{\\tau_{x}}\\right) + \\exp\\left(-\\frac{8}{\\tau_{x}}\\right) + \\exp\\left(-\\frac{4}{\\tau_{x}}\\right)}}$$"
        },
        {
            "introduction": "理论模型的一个关键目标是与生物物理机制建立联系。这个练习将抽象的痕迹模型与一个具体的生物过程——NMDA受体介导的钙离子内流——联系起来，这是LTP诱导的关键步骤。通过分析两种不同的三脉冲序列（pre-post-post vs. post-pre-pre）产生的总钙离子内流，你将学会如何运用模型来预测不同脉冲模式在诱导突触可塑性方面的效能差异。",
            "id": "4066495",
            "problem": "考虑一个在基于电压的脉冲时间依赖可塑性 (Spike-Timing-Dependent Plasticity, STDP) 范式下，通过N-甲基-D-天冬氨酸 (N-methyl-D-aspartate, NMDA) 受体门控建模的单个谷氨酸能突触。假设通过NMDA受体的钙电流 $i_{\\mathrm{Ca}}(t)$ 近似为突触前NMDA开放概率与由反向传播动作电位 (backpropagating action potentials, bAPs) 引起的突触后去极化的乘积，即 $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$，其中 $\\gamma  0$ 是一个常数，$s(t)$ 是突触前NMDA通道门控变量，$u(t)$ 是突触后电压依赖因子。在时间点 $\\{t_{k}^{\\mathrm{pre}}\\}$ 的突触前脉冲产生NMDA门控 $s(t) = \\sum_{k} \\exp\\!\\big(-(t - t_{k}^{\\mathrm{pre}})/\\tau_{s}\\big)\\, H(t - t_{k}^{\\mathrm{pre}})$，而在时间点 $\\{t_{j}^{\\mathrm{post}}\\}$ 的突触后脉冲产生去极化 $u(t) = \\sum_{j} \\exp\\!\\big(-(t - t_{j}^{\\mathrm{post}})/\\tau_{v}\\big)\\, H(t - t_{j}^{\\mathrm{post}})$，其中 $H(\\cdot)$ 是 Heaviside 阶跃函数，$\\tau_{s}  0$ 是NMDA突触门控时间常数，$\\tau_{v}  0$ 是突触后去极化时间常数。设三联脉冲序列之间由一个固定的正时间间隔 $\\Delta  0$ 分隔：\n- 序列 A (前-后-后)：一个突触前脉冲在 $t = 0$ 时刻，两个突触后脉冲在 $t = \\Delta$ 和 $t = 2\\Delta$ 时刻。\n- 序列 B (后-前-前)：一个突触后脉冲在 $t = 0$ 时刻，两个突触前脉冲在 $t = \\Delta$ 和 $t = 2\\Delta$ 时刻。\n\n将一个序列的总钙内流定义为 $I = \\int_{-\\infty}^{\\infty} i_{\\mathrm{Ca}}(t)\\, dt$。从这些定义以及指数函数和 Heaviside 函数的标准性质出发，分别推导序列 A 和序列 B 的总钙内流 $I_{A}$ 和 $I_{B}$ 的闭式表达式，然后构建比率 $R = I_{A}/I_{B}$ 作为一个关于 $\\Delta$、$\\tau_{s}$ 和 $\\tau_{v}$ 的单一解析表达式。在长时程增强 (Long-Term Potentiation, LTP) 概率 $P_{\\mathrm{LTP}}$ 是积分钙内流 $I$ 的单调递增函数的广泛使用的假设下，根据 $R$ 预测哪个序列会产生更高的LTP概率。\n\n将您的最终答案表示为 $R$ 的闭式解析表达式。不包括单位。不需要数值近似或四舍五入。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题设定良好、客观，并包含获得唯一解所需的所有必要信息。它基于一个标准的、简化的用于脉冲时间依赖可塑性 (STDP) 的NMDA受体依赖性钙内流模型。\n\n总钙内流 $I$ 定义为钙电流 $i_{\\mathrm{Ca}}(t) = \\gamma\\, s(t)\\, u(t)$ 的时间积分。我们将为指定的两个三联脉冲序列计算该积分。\n\n首先，我们定义一个将出现在我们计算中的常用积分。令积分 $K$ 定义为：\n$$\nK(t_0, \\tau_1, \\tau_2) = \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-(t - t_0)/\\tau_2) dt\n$$\n其中 $t_0 > 0$ 且 $\\tau_1, \\tau_2 > 0$。我们可以如下求解此积分：\n$$\nK = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp(-t/\\tau_1) \\exp(-t/\\tau_2) dt = \\exp(t_0/\\tau_2) \\int_{t_0}^{\\infty} \\exp\\left(-t \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) dt\n$$\n我们定义一个有效时间常数 $\\tau_{\\mathrm{eff}}$，使得 $\\frac{1}{\\tau_{\\mathrm{eff}}} = \\frac{1}{\\tau_1} + \\frac{1}{\\tau_2} = \\frac{\\tau_1 + \\tau_2}{\\tau_1 \\tau_2}$。\n$$\nK = \\exp(t_0/\\tau_2) \\left[ \\frac{-\\exp(-t/\\tau_{\\mathrm{eff}})}{1/\\tau_{\\mathrm{eff}}} \\right]_{t_0}^{\\infty} = \\exp(t_0/\\tau_2) \\left[ 0 - (-\\tau_{\\mathrm{eff}} \\exp(-t_0/\\tau_{\\mathrm{eff}})) \\right] = \\tau_{\\mathrm{eff}} \\exp(t_0/\\tau_2 - t_0/\\tau_{\\mathrm{eff}})\n$$\n指数部分简化为：\n$$\n\\frac{t_0}{\\tau_2} - \\frac{t_0}{\\tau_{\\mathrm{eff}}} = t_0 \\left(\\frac{1}{\\tau_2} - \\left(\\frac{1}{\\tau_1} + \\frac{1}{\\tau_2}\\right)\\right) = t_0 \\left(-\\frac{1}{\\tau_1}\\right) = -\\frac{t_0}{\\tau_1}\n$$\n所以，该积分的一般形式是：\n$$\nK(t_0, \\tau_1, \\tau_2) = \\frac{\\tau_1 \\tau_2}{\\tau_1 + \\tau_2} \\exp(-t_0/\\tau_1)\n$$\n\n现在，我们计算序列 A (前-后-后) 的总钙内流。\n突触前脉冲发生在 $t_1^{\\mathrm{pre}} = 0$。突触后脉冲发生在 $t_1^{\\mathrm{post}} = \\Delta$ 和 $t_2^{\\mathrm{post}} = 2\\Delta$。\n突触前门控变量是：\n$$\ns_A(t) = \\exp(-t/\\tau_s) H(t)\n$$\n突触后电压因子是：\n$$\nu_A(t) = \\exp(-(t-\\Delta)/\\tau_v) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_v) H(t-2\\Delta)\n$$\n总钙内流 $I_A$ 是它们乘积的积分：\n$$\nI_A = \\int_{-\\infty}^{\\infty} \\gamma\\, s_A(t)\\, u_A(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\exp(-t/\\tau_s) H(t) \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_v}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_v}) H(t-2\\Delta) \\right] dt\n$$\n由于 $\\Delta > 0$，Heaviside 函数简化了积分限：$H(t)H(t-\\Delta) = H(t-\\Delta)$ 且 $H(t)H(t-2\\Delta) = H(t-2\\Delta)$。该积分分为两部分：\n$$\nI_A = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-\\Delta)/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-t/\\tau_s) \\exp(-(t-2\\Delta)/\\tau_v) dt \\right]\n$$\n第一个积分是 $K(\\Delta, \\tau_s, \\tau_v)$，第二个是 $K(2\\Delta, \\tau_s, \\tau_v)$。使用我们对 $K$ 的通解：\n$$\nI_A = \\gamma \\left[ \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-\\Delta/\\tau_s) + \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\exp(-2\\Delta/\\tau_s) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)\n$$\n\n接下来，我们计算序列 B (后-前-前) 的总钙内流。\n突触后脉冲发生在 $t_1^{\\mathrm{post}} = 0$。突触前脉冲发生在 $t_1^{\\mathrm{pre}} = \\Delta$ 和 $t_2^{\\mathrm{pre}} = 2\\Delta$。\n突触前门控变量是：\n$$\ns_B(t) = \\exp(-(t-\\Delta)/\\tau_s) H(t-\\Delta) + \\exp(-(t-2\\Delta)/\\tau_s) H(t-2\\Delta)\n$$\n突触后电压因子是：\n$$\nu_B(t) = \\exp(-t/\\tau_v) H(t)\n$$\n总钙内流 $I_B$ 是：\n$$\nI_B = \\int_{-\\infty}^{\\infty} \\gamma\\, s_B(t)\\, u_B(t) dt = \\gamma \\int_{-\\infty}^{\\infty} \\left[ \\exp(-\\frac{t-\\Delta}{\\tau_s}) H(t-\\Delta) + \\exp(-\\frac{t-2\\Delta}{\\tau_s}) H(t-2\\Delta) \\right] \\exp(-t/\\tau_v) H(t) dt\n$$\n同样，我们将积分拆分：\n$$\nI_B = \\gamma \\left[ \\int_{\\Delta}^{\\infty} \\exp(-(t-\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt + \\int_{2\\Delta}^{\\infty} \\exp(-(t-2\\Delta)/\\tau_s) \\exp(-t/\\tau_v) dt \\right]\n$$\n第一个积分是 $K(\\Delta, \\tau_v, \\tau_s)$，第二个是 $K(2\\Delta, \\tau_v, \\tau_s)$。注意与序列 A 相比，$\\tau_s$ 和 $\\tau_v$ 的顺序互换了。\n$$\nI_B = \\gamma \\left[ \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-\\Delta/\\tau_v) + \\frac{\\tau_v \\tau_s}{\\tau_v+\\tau_s} \\exp(-2\\Delta/\\tau_v) \\right] = \\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)\n$$\n\n最后，我们计算比率 $R = I_A/I_B$：\n$$\nR = \\frac{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s) \\right)}{\\gamma \\frac{\\tau_s \\tau_v}{\\tau_s+\\tau_v} \\left( \\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v) \\right)}\n$$\n前置因子相消，得到比率的最终表达式：\n$$\nR = \\frac{\\exp(-\\Delta/\\tau_s) + \\exp(-2\\Delta/\\tau_s)}{\\exp(-\\Delta/\\tau_v) + \\exp(-2\\Delta/\\tau_v)}\n$$\n\n为了预测哪个序列产生更高的LTP概率，我们必须比较 $I_A$ 和 $I_B$，这等价于确定 $R$ 是大于、小于还是等于 $1$。我们定义函数 $f(x) = \\exp(-x) + \\exp(-2x)$，其中 $x > 0$。该比率为 $R = f(\\Delta/\\tau_s) / f(\\Delta/\\tau_v)$。$f(x)$ 的导数是 $f'(x) = -\\exp(-x) - 2\\exp(-2x)$，对于所有 $x$ 该导数都严格为负。因此，$f(x)$ 是一个单调递减函数。\n因此，$f(\\Delta/\\tau_s)$ 和 $f(\\Delta/\\tau_v)$ 的比较取决于它们的自变量 $\\Delta/\\tau_s$ 和 $\\Delta/\\tau_v$ 的比较。由于 $\\Delta > 0$，这取决于 $\\tau_s$ 和 $\\tau_v$ 的相对大小。\n\n1.  如果 $\\tau_s > \\tau_v$：那么 $1/\\tau_s  1/\\tau_v$，这意味着 $\\Delta/\\tau_s  \\Delta/\\tau_v$。由于 $f(x)$ 是一个递减函数，所以 $f(\\Delta/\\tau_s) > f(\\Delta/\\tau_v)$。这意味着 $I_A > I_B$ 且 $R > 1$。序列 A (前-后-后) 产生更高的LTP概率。在生理学上，NMDA门控时间常数 $\\tau_s$ (几十到几百毫秒) 显著长于反向传播动作电位去极化时间常数 $\\tau_v$ (几十毫秒)，因此这是最相关的情况。\n2.  如果 $\\tau_s  \\tau_v$：那么 $1/\\tau_s > 1/\\tau_v$，所以 $\\Delta/\\tau_s > \\Delta/\\tau_v$。这意味着 $f(\\Delta/\\tau_s)  f(\\Delta/\\tau_v)$，所以 $I_A  I_B$ 且 $R  1$。序列 B (后-前-前) 会产生更高的LTP概率。\n3.  如果 $\\tau_s = \\tau_v$：那么自变量相等，所以 $f(\\Delta/\\tau_s) = f(\\Delta/\\tau_v)$，这得出 $I_A = I_B$ 且 $R = 1$。LTP概率将相等。\n\n基于 $\\tau_s > \\tau_v$ 的典型生物物理参数，该模型预测前-后-后三联脉冲 (序列 A) 在诱导钙内流并因此诱导LTP方面比后-前-前三联脉冲 (序列 B) 更有效。",
            "answer": "$$\n\\boxed{\\frac{\\exp(-\\frac{\\Delta}{\\tau_{s}}) + \\exp(-\\frac{2\\Delta}{\\tau_{s}})}{\\exp(-\\frac{\\Delta}{\\tau_{v}}) + \\exp(-\\frac{2\\Delta}{\\tau_{v}})}}\n$$"
        },
        {
            "introduction": "理论知识的最终检验在于实践应用。这个综合性练习要求你将前面学到的概念整合成一个完整的、事件驱动的三联体STDP计算模型。你的任务是通过编程实现该模型，并使用给定的“经典”实验数据集对其进行验证，量化模型预测与真实数据之间的误差。这个练习不仅能让你掌握模型实现的具体技术，还能让你体会到优秀的计算模型如何用一套统一的参数解释多种不同的实验现象，例如经典的脉冲配对STDP窗口和脉冲簇诱导的增强可塑性。",
            "id": "4066560",
            "problem": "您需要实现并验证一个用于神经形态和类脑计算的三联体类脉冲时间依赖可塑性（STDP）模型。验证过程必须证明，与标准实验数据集进行定量比较时，单一一组拟合的三联体参数能够同时再现基于脉冲对的STDP时间窗口和三联体脉冲簇增强。所有时间量必须以毫秒表示，所有突触权重变化值均为无量纲。最终程序必须输出一行内容，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按以下指定顺序计算的每个测试用例的均方根误差。\n\n从以下基本原理开始：\n- 脉冲时间依赖可塑性（STDP）：突触权重的变化取决于突触前和突触后脉冲的精确时间。\n- 指数衰减的脉冲迹：一个脉冲序列会引发随时间指数衰减的短时程和长时程脉冲迹。对于突触前神经元，定义一个时间常数为 $\\tau_{+}$ 的短时程迹和一个时间常数为 $\\tau_{x}$ 的长时程迹。对于突触后神经元，定义一个时间常数为 $\\tau_{-}$ 的短时程迹和一个时间常数为 $\\tau_{y}$ 的长时程迹。这些脉冲迹在初始化时为零，并在各自的脉冲事件发生时增加 $1$。\n- 基于事件的更新规则：突触权重的更新在每个脉冲事件发生时瞬时进行。在时间 $t$ 发生突触后脉冲时，长时程增强是该时刻突触前短时程迹及其与突触后长时程迹相互作用的函数。在时间 $t$ 发生突触前脉冲时，长时程抑制是该时刻突触后短时程迹及其与突触前长时程迹相互作用的函数。在事件之间，脉冲迹总是根据其各自的时间常数连续衰减。\n\n您必须通过按时间顺序处理脉冲事件来实现模拟。在持续时间为 $\\Delta t$ 的两个事件之间，每个脉冲迹 $z$ 按 $z \\leftarrow z \\exp\\left(-\\Delta t / \\tau\\right)$ 衰减，其中 $\\tau$ 为其对应的时间常数。在突触后脉冲发生时，在增加突触后脉冲迹之前，使用突触前短时程迹和突触后长时程迹的瞬时值施加增强作用。在突触前脉冲发生时，在增加突触前脉冲迹之前，使用突触后短时程迹和突触前长时程迹的瞬时值施加抑制作用。脉冲对和三联体相互作用的振幅由四个参数给出，这些参数用于缩放各自的更新贡献。\n\n模型参数化和单位：\n- 突触前短时程迹时间常数 $\\tau_{+} = 16.8$ ms。\n- 突触后短时程迹时间常数 $\\tau_{-} = 33.7$ ms。\n- 突触前长时程迹时间常数 $\\tau_{x} = 101.0$ ms。\n- 突触后长时程迹时间常数 $\\tau_{y} = 125.0$ ms。\n- 基于脉冲对的增强振幅 $A_{2}^{+} = 0.010$ (无量纲)。\n- 基于脉冲对的抑制振幅 $A_{2}^{-} = 0.012$ (无量纲)。\n- 三联体增强振幅 $A_{3}^{+} = 0.006$ (无量纲)。\n- 三联体抑制振幅 $A_{3}^{-} = 0.004$ (无量纲)。\n\n您还将验证第二组参数，其中三联体振幅被移除以测试边缘情况行为：\n- 时间常数与上述相同，但 $A_{3}^{+} = 0.000$ 且 $A_{3}^{-} = 0.000$。\n\n用于比较的标准实验数据集（无量纲 $\\Delta w$ 值）：\n1. 基于脉冲对的STDP窗口数据集，$\\Delta t$ 列表为 $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms，标准 $\\Delta w$ 值为 $[-0.00272,-0.00366,-0.00492,-0.00662,-0.00892,-0.01034,0.00742,0.00551,0.00304,0.00168,0.00092,0.00051]$。\n2. 边界条件脉冲对数据集，$\\Delta t$ 列表为 $[-100,100]$ ms，标准 $\\Delta w$ 值为 $[-0.00062,0.000026]$。\n3. 三联体脉冲簇增强数据集，突触前脉冲在 $0$ ms，突触后脉冲在 $10$ ms 和 $10+\\Delta_{2}$ ms，$\\Delta_{2}$ 列表为 $[5,10,20,40]$ ms。标准总 $\\Delta w$ 值为 $[0.01196,0.01023,0.00805,0.00624]$。\n\n对于基于脉冲对的数据集，协议为一个突触前脉冲和一个突触后脉冲，其相对时间为 $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$。当 $\\Delta t > 0$ 时，突触前脉冲在 $0$ ms，突触后脉冲在 $\\Delta t$ ms。当 $\\Delta t  0$ 时，突触后脉冲在 $0$ ms，突触前脉冲在 $|\\Delta t|$ ms。对于三联体数据集，突触前脉冲在 $0$ ms，突触后脉冲在 $10$ ms，另一个突触后脉冲在 $10+\\Delta_{2}$ ms。\n\n您的程序必须：\n- 实现上述基于事件的三联体STDP模型。\n- 使用拟合的参数集（$A_{3}^{+} = 0.006$，$A_{3}^{-} = 0.004$）为每个数据集中的每个时间点生成预测的 $\\Delta w$。\n- 计算每个数据集的预测值和标准值之间的均方根误差（RMSE）。\n- 使用第二组参数（$A_{3}^{+} = 0.000$，$A_{3}^{-} = 0.000$）重复三联体数据集的RMSE计算。\n- 输出一行，包含四个RMSE值，顺序为：脉冲对数据集RMSE（拟合三联体），边界脉冲对数据集RMSE（拟合三联体），三联体数据集RMSE（拟合三联体），三联体数据集RMSE（无三联体）。最终输出格式必须是单行，形式为逗号分隔的列表并用方括号括起，例如 $[r_{1},r_{2},r_{3},r_{4}]$。\n\n测试套件规范：\n- 用例 $1$ (正常路径)：使用拟合的三联体参数，在 $\\Delta t$ 值为 $[-50,-40,-30,-20,-10,-5,5,10,20,30,40,50]$ ms 时进行基于脉冲对的STDP窗口测试。\n- 用例 $2$ (边界条件)：使用拟合的三联体参数，在极端延迟 $\\Delta t = -100$ ms 和 $\\Delta t = 100$ ms 时进行基于脉冲对的STDP测试。\n- 用例 $3$ (三联体增强)：使用拟合的三联体参数，突触前脉冲在 $0$ ms，突触后脉冲在 $10$ ms，另一个突触后脉冲在 $10+\\Delta_{2}$ ms，其中 $\\Delta_{2} \\in \\{5,10,20,40\\}$ ms。\n- 用例 $4$ (边缘情况，三联体消融)：与用例 $3$ 相同的协议，但三联体振幅设置为零。\n\n所有输出均为表示RMSE值的无量纲浮点数。不涉及角度，也不需要百分比输出。测试套件必须严格按照所列顺序处理，程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。",
            "solution": "用户提供的问题是有效的。它在科学上基于计算神经科学的既定原理，特别是脉冲时间依赖可塑性（STDP）的三联体模型。该问题提法恰当，提供了一套完整且一致的参数、定义和实验协议。目标明确，语言精确无歧义。因此，可以构建一个合理的解决方案。\n\n该问题要求实现并验证一个基于三联体的STDP模型。该模型扩展了经典的基于脉冲对的STDP框架，以考虑高阶脉冲相互作用，这对于再现某些实验观察至关重要，例如可塑性对脉冲频率和脉冲簇时间的依赖性。该模型的核心在于其基于事件的性质以及指数衰减脉冲迹的使用。\n\n**1. 模型公式化**\n\n突触的状态由其权重 $w$ 和四个内部变量（或称为脉冲迹）描述，这些变量跟踪突触前和突触后活动的近期历史。对于突触前神经元，我们定义一个短时程迹 $o_1(t)$ 和一个长时程迹 $r_1(t)$。类似地，对于突触后神经元，我们有一个短时程迹 $o_2(t)$ 和一个长时程迹 $r_2(t)$。每个脉冲迹都由一个一阶线性微分方程控制：\n$$ \\tau_z \\frac{dz(t)}{dt} = -z(t) $$\n其中 $z$ 可以是四个脉冲迹（$o_1$, $r_1$, $o_2$, $r_2$）中的任意一个，$\\tau_z$ 是其对应的时间常数（$\\tau_{+}$, $\\tau_{x}$, $\\tau_{-}$, $\\tau_{y}$）。\n\n在脉冲发生时，脉冲迹会瞬时增加 $1$。如果一个突触前脉冲发生在时间 $t_{pre}$，更新规则为 $o_1(t_{pre}) \\to o_1(t_{pre}^{-}) + 1$ 和 $r_1(t_{pre}) \\to r_1(t_{pre}^{-}) + 1$。如果一个突触后脉冲发生在时间 $t_{post}$，更新规则为 $o_2(t_{post}) \\to o_2(t_{post}^{-}) + 1$ 和 $r_2(t_{post}) \\to r_2(t_{post}^{-}) + 1$。符号 $t^{-}$ 表示脉冲发生前的瞬间。\n\n在脉冲之间，经过一个时间间隔 $\\Delta t$，每个脉冲迹指数衰减：\n$$ z(t + \\Delta t) = z(t) \\exp\\left(-\\frac{\\Delta t}{\\tau_z}\\right) $$\n\n**2. 突触权重更新规则**\n\n突触权重的变化 $\\Delta w$ 在脉冲发生的瞬间即时发生。更新规则定义如下：\n\n- **在突触后脉冲时（时间 $t_{post}$）：** 诱发长时程增强（LTP）。权重变化是突触前短时程迹以及与突触后长时程迹相互作用的函数。这同时捕捉了脉冲对相互作用（突触前-后）和三联体相互作用（突触前-后-后）。\n$$ \\Delta w = o_1(t_{post}^{-}) \\left[ A_{2}^{+} + A_{3}^{+} r_2(t_{post}^{-}) \\right] $$\n此处，$A_{2}^{+}$ 是基于脉冲对的LTP的振幅，$A_{3}^{+}$ 是基于三联体的LTP的振幅。\n\n- **在突触前脉冲时（时间 $t_{pre}$）：** 诱发长时程抑制（LTD）。权重变化是突触后短时程迹以及与突触前长时程迹相互作用的函数。这同时捕捉了脉冲对相互作用（突触后-前）和三联体相互作用（突触后-前-后）。\n$$ \\Delta w = -o_2(t_{pre}^{-}) \\left[ A_{2}^{-} + A_{3}^{-} r_1(t_{pre}^{-}) \\right] $$\n此处，$A_{2}^{-}$ 是基于脉冲对的LTD的振幅，$A_{3}^{-}$ 是基于三联体的LTD的振幅。\n\n**3. 基于事件的模拟算法**\n\n为了确定给定脉冲序列的总权重变化，我们进行基于事件的模拟。脉冲被视为按时间顺序排列的离散事件。\n\n算法流程如下：\n1. 初始化总权重变化 $\\Delta W_{total} = 0$，所有四个脉冲迹（$o_1, r_1, o_2, r_2$）为 $0$，以及上一个事件时间 $t_{last} = 0$。\n2. 按发生时间对所有突触前和突触后脉冲的列表进行排序。\n3. 遍历已排序的脉冲事件列表。对于每个在时间 $t_{event}$ 发生的事件：\n    a. 计算自上一个事件以来经过的时间：$\\Delta t = t_{event} - t_{last}$。\n    b. 如果 $\\Delta t > 0$，使所有四个脉冲迹指数衰减：$z \\leftarrow z \\cdot \\exp(-\\Delta t / \\tau_z)$。\n    c. 如果事件是突触后脉冲，使用 $o_1$ 和 $r_2$ 的当前值计算LTP贡献 $\\Delta w_{LTP}$。将其加到总权重变化中：$\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTP}$。然后，增加突触后脉冲迹：$o_2 \\leftarrow o_2 + 1$ 和 $r_2 \\leftarrow r_2 + 1$。\n    d. 如果事件是突触前脉冲，使用 $o_2$ 和 $r_1$ 的当前值计算LTD贡献 $\\Delta w_{LTD}$。将其加到总权重变化中：$\\Delta W_{total} \\leftarrow \\Delta W_{total} + \\Delta w_{LTD}$。然后，增加突触前脉冲迹：$o_1 \\leftarrow o_1 + 1$ 和 $r_1 \\leftarrow r_1 + 1$。\n    e. 更新上一个事件时间：$t_{last} \\leftarrow t_{event}$。\n4. 处理完所有脉冲后，最终的 $\\Delta W_{total}$ 即为给定脉冲协议的预测突触权重变化。\n\n**4. 验证与误差计算**\n\n通过将其预测与标准实验数据集进行比较来验证模型。对于每个数据集，针对每个指定的脉冲时间配置运行模拟。然后计算均方根误差（RMSE）以量化模型预测的权重变化（$\\hat{y}_i$）与标准实验值（$y_i$）之间的差异：\n$$ \\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\hat{y}_i - y_i)^2} $$\n其中 $N$ 是集合中数据点的数量。对四个指定的测试用例重复此过程，涉及两组不同的参数集和三种不同的实验协议，以生成所需的四个RMSE值。使用第二组将三联体振幅 $A_3^+$ 和 $A_3^-$ 设置为零的参数集作为对照，以证明三联体项对于再现三联体脉冲簇增强数据是必要的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and validates a triplet-based STDP model against canonical datasets.\n    \"\"\"\n\n    # Define the two parameter sets.\n    params_fitted_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.006, 'A3_minus': 0.004\n    }\n\n    params_no_triplet = {\n        'tau_plus': 16.8, 'tau_minus': 33.7,\n        'tau_x': 101.0, 'tau_y': 125.0,\n        'A2_plus': 0.010, 'A2_minus': 0.012,\n        'A3_plus': 0.000, 'A3_minus': 0.000\n    }\n\n    # Define canonical experimental datasets.\n    canonical_data = {\n        'pair_window': {\n            'dt': np.array([-50, -40, -30, -20, -10, -5, 5, 10, 20, 30, 40, 50]),\n            'dw': np.array([-0.00272, -0.00366, -0.00492, -0.00662, -0.00892, -0.01034, 0.00742, 0.00551, 0.00304, 0.00168, 0.00092, 0.00051])\n        },\n        'boundary_pair': {\n            'dt': np.array([-100, 100]),\n            'dw': np.array([-0.00062, 0.000026])\n        },\n        'triplet': {\n            'd2': np.array([5, 10, 20, 40]),\n            'dw': np.array([0.01196, 0.01023, 0.00805, 0.00624])\n        }\n    }\n\n    def run_simulation(spikes, params):\n        \"\"\"\n        Runs an event-based simulation for a given spike train and model parameters.\n\n        Args:\n            spikes (list of tuples): A list of (time, type) tuples, where type is 'pre' or 'post'.\n            params (dict): A dictionary of model parameters.\n\n        Returns:\n            float: The total synaptic weight change.\n        \"\"\"\n        # Sort spikes by time to ensure chronological processing.\n        spikes.sort(key=lambda x: x[0])\n        \n        # Initialize traces and total weight change\n        o1, r1, o2, r2 = 0.0, 0.0, 0.0, 0.0  # pre_short, pre_long, post_short, post_long\n        total_dw = 0.0\n        last_event_time = 0.0\n\n        p = params\n\n        for time, spike_type in spikes:\n            delta_t = time - last_event_time\n            \n            if delta_t > 0:\n                # Decay all traces exponentially\n                o1 *= np.exp(-delta_t / p['tau_plus'])\n                r1 *= np.exp(-delta_t / p['tau_x'])\n                o2 *= np.exp(-delta_t / p['tau_minus'])\n                r2 *= np.exp(-delta_t / p['tau_y'])\n            \n            if spike_type == 'post':\n                # Potentiation update\n                dw = o1 * (p['A2_plus'] + p['A3_plus'] * r2)\n                total_dw += dw\n                # Increment postsynaptic traces\n                o2 += 1.0\n                r2 += 1.0\n            \n            elif spike_type == 'pre':\n                # Depression update\n                dw = -o2 * (p['A2_minus'] + p['A3_minus'] * r1)\n                total_dw += dw\n                # Increment presynaptic traces\n                o1 += 1.0\n                r1 += 1.0\n            \n            last_event_time = time\n            \n        return total_dw\n\n    def calculate_rmse(predicted, canonical):\n        return np.sqrt(np.mean((predicted - canonical)**2))\n\n    results = []\n\n    # Case 1: Pair-based STDP window (fitted triplet parameters)\n    predicted_dw_case1 = []\n    for dt in canonical_data['pair_window']['dt']:\n        if dt > 0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case1.append(run_simulation(spikes, params_fitted_triplet))\n    \n    rmse1 = calculate_rmse(np.array(predicted_dw_case1), canonical_data['pair_window']['dw'])\n    results.append(rmse1)\n\n    # Case 2: Boundary pair conditions (fitted triplet parameters)\n    predicted_dw_case2 = []\n    for dt in canonical_data['boundary_pair']['dt']:\n        if dt > 0:\n            spikes = [(0, 'pre'), (dt, 'post')]\n        else: # dt  0\n            spikes = [(0, 'post'), (abs(dt), 'pre')]\n        predicted_dw_case2.append(run_simulation(spikes, params_fitted_triplet))\n\n    rmse2 = calculate_rmse(np.array(predicted_dw_case2), canonical_data['boundary_pair']['dw'])\n    results.append(rmse2)\n\n    # Case 3: Triplet burst potentiation (fitted triplet parameters)\n    predicted_dw_case3 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case3.append(run_simulation(spikes, params_fitted_triplet))\n        \n    rmse3 = calculate_rmse(np.array(predicted_dw_case3), canonical_data['triplet']['dw'])\n    results.append(rmse3)\n\n    # Case 4: Triplet burst potentiation (ablated triplet parameters)\n    predicted_dw_case4 = []\n    for d2 in canonical_data['triplet']['d2']:\n        spikes = [(0, 'pre'), (10, 'post'), (10 + d2, 'post')]\n        predicted_dw_case4.append(run_simulation(spikes, params_no_triplet))\n        \n    rmse4 = calculate_rmse(np.array(predicted_dw_case4), canonical_data['triplet']['dw'])\n    results.append(rmse4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}