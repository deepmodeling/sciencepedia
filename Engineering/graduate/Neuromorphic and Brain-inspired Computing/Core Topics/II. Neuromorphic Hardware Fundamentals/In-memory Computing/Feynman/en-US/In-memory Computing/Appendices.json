{
    "hands_on_practices": [
        {
            "introduction": "The core promise of in-memory computing (IMC) is its potential to drastically reduce energy consumption by minimizing data movement, a primary cost in conventional von Neumann architectures. This first practice () invites you to perform a high-level energy analysis, quantifying the savings achieved by an IMC approach for a typical neural network layer. This foundational calculation will solidify your understanding of why IMC is a critical direction for future energy-efficient computing.",
            "id": "4048694",
            "problem": "A Convolutional Neural Network (CNN) layer executes $10^{8}$ Multiply–Accumulate (MAC) operations and incurs external memory traffic of $10^{9}$ bits when implemented on a conventional system-on-chip. Suppose the energy per moved bit is $E_{\\text{move}} = 100$ pJ/bit and the energy per MAC is $E_{\\text{compute}} = 1$ pJ/MAC. Consider an In-Memory Computing (IMC) architecture that reduces external memory traffic by $90\\%$ while leaving the number of MAC operations and their per-operation energy unchanged. Using the first-principles definition that total energy for independent processes is the sum of their individual energies, compute the total energy saved by switching to IMC for this layer. Express your final answer in Joules (J). Provide an exact value (no rounding).",
            "solution": "The problem statement is first validated for scientific soundness, completeness, and objectivity.\n\n### Step 1: Extract Givens\n-   Number of Multiply–Accumulate (MAC) operations for the Convolutional Neural Network (CNN) layer: $N_{\\text{MAC}} = 10^8$.\n-   External memory traffic for the conventional system: $T_{\\text{conv}} = 10^9$ bits.\n-   Energy per moved bit: $E_{\\text{move}} = 100$ pJ/bit.\n-   Energy per MAC operation: $E_{\\text{MAC}} = 1$ pJ/MAC.\n-   Reduction in external memory traffic with In-Memory Computing (IMC): $r = 90\\%$.\n-   Change in MAC operations and per-operation energy with IMC: unchanged.\n-   Governing principle: Total energy is the sum of the energies of independent processes.\n-   Required final unit: Joules (J).\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is based on standard principles of energy consumption in digital circuits, a core topic in computer architecture and engineering. The concepts of MAC operations, memory traffic, energy per operation, and their contribution to total energy are fundamental. The provided values are within realistic orders of magnitude for modern semiconductor technologies. The problem is well-posed, providing all necessary data and a clear objective. The language is precise and quantitative, making it objective. It is self-contained and free of contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation\nThe total energy consumption for any system, based on the problem's principle, is the sum of the energy consumed by computation and the energy consumed by data movement (memory traffic).\n\nLet $E_{\\text{total}}$ be the total energy, $E_{\\text{compute}}$ be the computational energy, and $E_{\\text{traffic}}$ be the memory traffic energy.\n$$E_{\\text{total}} = E_{\\text{compute}} + E_{\\text{traffic}}$$\n\nFor the conventional system, let us denote the total energy as $E_{\\text{conv}}$.\nThe computational energy is the number of MAC operations multiplied by the energy per MAC:\n$$E_{\\text{compute, conv}} = N_{\\text{MAC}} \\times E_{\\text{MAC}}$$\nThe memory traffic energy is the total bits moved multiplied by the energy per bit:\n$$E_{\\text{traffic, conv}} = T_{\\text{conv}} \\times E_{\\text{move}}$$\nThus, the total energy for the conventional system is:\n$$E_{\\text{conv}} = (N_{\\text{MAC}} \\times E_{\\text{MAC}}) + (T_{\\text{conv}} \\times E_{\\text{move}})$$\n\nFor the In-Memory Computing (IMC) system, let us denote the total energy as $E_{\\text{IMC}}$.\nThe problem states that the number of MAC operations and the energy per MAC are unchanged.\n$$E_{\\text{compute, IMC}} = N_{\\text{MAC}} \\times E_{\\text{MAC}} = E_{\\text{compute, conv}}$$\nThe external memory traffic is reduced by $r = 90\\% = 0.9$. The new traffic, $T_{\\text{IMC}}$, is:\n$$T_{\\text{IMC}} = T_{\\text{conv}} \\times (1 - r)$$\nThe energy per moved bit, $E_{\\text{move}}$, remains the same for the remaining external traffic. The traffic energy for the IMC system is:\n$$E_{\\text{traffic, IMC}} = T_{\\text{IMC}} \\times E_{\\text{move}} = T_{\\text{conv}} \\times (1 - r) \\times E_{\\text{move}}$$\nThus, the total energy for the IMC system is:\n$$E_{\\text{IMC}} = (N_{\\text{MAC}} \\times E_{\\text{MAC}}) + (T_{\\text{conv}} \\times (1 - r) \\times E_{\\text{move}})$$\n\nThe total energy saved, $\\Delta E$, is the difference between the energy of the conventional system and the IMC system.\n$$\\Delta E = E_{\\text{conv}} - E_{\\text{IMC}}$$\n$$\\Delta E = \\left[ (N_{\\text{MAC}} \\times E_{\\text{MAC}}) + (T_{\\text{conv}} \\times E_{\\text{move}}) \\right] - \\left[ (N_{\\text{MAC}} \\times E_{\\text{MAC}}) + (T_{\\text{conv}} \\times (1 - r) \\times E_{\\text{move}}) \\right]$$\nSince the computational energy term, $N_{\\text{MAC}} \\times E_{\\text{MAC}}$, is identical for both systems, it cancels out upon subtraction.\n$$\\Delta E = (T_{\\text{conv}} \\times E_{\\text{move}}) - (T_{\\text{conv}} \\times (1 - r) \\times E_{\\text{move}})$$\nFactoring out the term $T_{\\text{conv}} \\times E_{\\text{move}}$:\n$$\\Delta E = (T_{\\text{conv}} \\times E_{\\text{move}}) \\times [1 - (1 - r)]$$\n$$\\Delta E = (T_{\\text{conv}} \\times E_{\\text{move}}) \\times r$$\nThis shows that the total energy saving is precisely the energy associated with the eliminated memory traffic.\n\nNow, we substitute the given values into this expression for $\\Delta E$.\n-   $T_{\\text{conv}} = 10^9$ bits\n-   $E_{\\text{move}} = 100$ pJ/bit\n-   $r = 0.9$\n\n$$\\Delta E = (10^9 \\text{ bits}) \\times (100 \\frac{\\text{pJ}}{\\text{bit}}) \\times 0.9$$\n$$\\Delta E = 10^9 \\times 100 \\times 0.9 \\text{ pJ}$$\n$$\\Delta E = 0.9 \\times 10^{11} \\text{ pJ}$$\n$$\\Delta E = 9 \\times 10^{10} \\text{ pJ}$$\n\nThe problem requires the final answer to be expressed in Joules (J). We use the conversion factor $1 \\text{ pJ} = 10^{-12} \\text{ J}$.\n$$\\Delta E = (9 \\times 10^{10}) \\times (10^{-12} \\text{ J})$$\n$$\\Delta E = 9 \\times 10^{(10 - 12)} \\text{ J}$$\n$$\\Delta E = 9 \\times 10^{-2} \\text{ J}$$",
            "answer": "$$\\boxed{9 \\times 10^{-2}}$$"
        },
        {
            "introduction": "Having established the \"why\" of IMC, we now turn to the \"how.\" Real-world computational tasks involve matrices far larger than any single physical crossbar array can accommodate. This exercise () guides you through the system-level problem of mapping a large logical matrix onto a tiled hardware architecture, a fundamental technique in scalable IMC design. By calculating the required number of tiles and the total operational cost in analog-to-digital conversions, you will grasp the architectural principles of building large-scale IMC processors.",
            "id": "4048638",
            "problem": "A resistive processing-in-memory crossbar system is used to implement a fully connected layer with weight matrix $W \\in \\mathbb{R}^{4096 \\times 4096}$. The system employs crossbar tiles of size $128 \\times 128$, where each column in a tile is terminated by a dedicated Analog-to-Digital Converter (ADC). Signed weights are encoded using differential conductance pairs per synapse, and a differential sense amplifier performs a single conversion per column to obtain a signed output. Consider a single inference that computes $y = W x$ for one input vector $x \\in \\mathbb{R}^{4096}$.\n\nThe mapping strategy is as follows:\n- The matrix $W$ is partitioned into non-overlapping square submatrices of size $128 \\times 128$, each programmed into one crossbar tile.\n- For a given input vector $x$, each row-partitioned subvector of length $128$ is applied to the corresponding tile rows. Within a tile, the column currents are summed by Kirchhoff’s current law and digitized once per column by the local ADCs during one multiply-accumulate cycle per input.\n- Partial sums across tiles that share the same output indices (i.e., across the row partitions for a fixed column partition) are added digitally after ADC, with no additional ADC conversion required.\n\nAssume that $4096$ is exactly divisible by $128$ and that there is no bit-serial time decomposition in either the inputs or the weights beyond the single conversion per column per tile stated above. Compute:\n1) The total number of crossbar tiles required to store and compute $W$.\n2) The total number of ADC conversions required to complete one inference $y = W x$ that produces all $4096$ outputs.\n\nExpress your final answer as two exact integers with no units. No rounding is required.",
            "solution": "The problem statement will first be validated for scientific correctness, self-consistency, and clarity before a solution is attempted.\n\n### Step 1: Extract Givens\n- Weight matrix: $W \\in \\mathbb{R}^{4096 \\times 4096}$\n- System architecture: Resistive processing-in-memory crossbar system\n- Crossbar tile size: $128 \\times 128$\n- ADC configuration: Each column in a tile is terminated by a dedicated Analog-to-Digital Converter (ADC).\n- Weight encoding: Signed weights are encoded using differential conductance pairs.\n- Sensing mechanism: A differential sense amplifier performs a single conversion per column.\n- Task: Compute one inference $y = W x$ for an input vector $x \\in \\mathbb{R}^{4096}$.\n- Matrix mapping strategy: $W$ is partitioned into non-overlapping square submatrices of size $128 \\times 128$, each programmed into one crossbar tile.\n- Computation process:\n    - Input vector $x$ is partitioned into subvectors of length $128$.\n    - Each subvector is applied to the corresponding tile rows.\n    - Column currents are summed via Kirchhoff’s current law.\n    - Digitization occurs once per column by local ADCs during one multiply-accumulate cycle.\n- Partial sum aggregation: Partial sums from tiles corresponding to the same output indices are added digitally after the ADC stage.\n- Assumption 1: $4096$ is exactly divisible by $128$.\n- Assumption 2: No bit-serial time decomposition in inputs or weights.\n- Required outputs:\n    1. The total number of crossbar tiles required.\n    2. The total number of ADC conversions for one full inference $y = Wx$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem describes a standard tiled architecture for implementing matrix-vector multiplication using resistive crossbar arrays, a central topic in the field of in-memory computing. The principles described, such as using Kirchhoff's current law for analog summation, partitioning a large matrix onto smaller physical tiles, and using ADCs at the periphery to convert analog results to digital, are all well-established and scientifically sound concepts in this domain.\n- **Well-Posed**: The problem is well-defined. The dimensions of the matrix ($4096 \\times 4096$) and the tiles ($128 \\times 128$) are explicitly given. The mapping strategy is clearly described. The questions are specific and lead to unique numerical answers based on the provided data. The assumption that $4096$ is divisible by $128$ ensures that the tiling is perfect, with no partial or irregular tiles, making the problem straightforward to solve.\n- **Objective**: The problem is expressed in precise, technical language with no subjective or ambiguous statements.\n- **Completeness and Consistency**: The problem provides all necessary information to calculate the required quantities. The description of the computational flow (parallel application of inputs, one conversion per column, digital summation of partial results) is internally consistent and complete for the scope of the questions asked.\n- **Realism**: The specified dimensions for the matrix and tiles are realistic for current and near-future neuromorphic hardware research and development.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, and all necessary information is provided in a clear and consistent manner. A solution will now be derived.\n\n### Solution Derivation\n\nThe problem requires the calculation of two quantities: the total number of tiles and the total number of ADC conversions for a single matrix-vector multiplication $y = Wx$.\n\n**1. Calculation of the Total Number of Crossbar Tiles**\n\nThe weight matrix $W$ has dimensions $N \\times N$, where $N = 4096$.\nThe crossbar tiles are square with dimensions $M \\times M$, where $M = 128$.\nThe matrix $W$ is partitioned into non-overlapping square submatrices of size $M \\times M$, each corresponding to one physical tile.\nThe number of tiles required along the row dimension of the matrix $W$ is the total number of rows of $W$ divided by the number of rows per tile.\nLet $T_{rows}$ be the number of tiles along the row dimension:\n$$T_{rows} = \\frac{N}{M} = \\frac{4096}{128}$$\nTo compute this, we can use powers of $2$: $4096 = 2^{12}$ and $128 = 2^7$.\n$$T_{rows} = \\frac{2^{12}}{2^7} = 2^{12-7} = 2^5 = 32$$\nSimilarly, the number of tiles required along the column dimension of the matrix $W$ is the total number of columns of $W$ divided by the number of columns per tile.\nLet $T_{cols}$ be the number of tiles along the column dimension:\n$$T_{cols} = \\frac{N}{M} = \\frac{4096}{128} = 32$$\nThe total number of tiles, $T_{total}$, is the product of the number of tiles along each dimension, forming a $2D$ grid of tiles.\n$$T_{total} = T_{rows} \\times T_{cols} = 32 \\times 32 = 1024$$\nThus, $1024$ crossbar tiles are required to store the entire weight matrix $W$.\n\n**2. Calculation of the Total Number of ADC Conversions**\n\nThe problem states that \"each column in a tile is terminated by a dedicated Analog-to-Digital Converter (ADC)\" and that there is a \"single conversion per column\" during the computation for a given input.\nThe number of columns in a single tile is $M = 128$. Therefore, there are $128$ ADCs per tile.\nThe computation of $y = Wx$ for a single input vector $x$ is performed in one parallel operation. The input vector $x$ is partitioned and its subvectors are applied to the rows of the corresponding tiles. The analog multiply-accumulate operations happen simultaneously across all tiles.\nThe resulting analog current sums at the bottom of each column of every tile are then converted to digital values.\nSince there is one ADC per column and the problem specifies \"one multiply-accumulate cycle per input\" with \"no bit-serial time decomposition\", one ADC conversion occurs on every column of every tile used in the computation.\nThe number of ADC conversions per tile is equal to the number of columns per tile, which is $128$.\nThe total number of ADC conversions, $C_{total}$, for the entire inference is the number of conversions per tile multiplied by the total number of tiles.\n$$C_{total} = (\\text{Number of ADCs per tile}) \\times (\\text{Total number of tiles})$$\n$$C_{total} = M \\times T_{total} = 128 \\times 1024$$\nUsing powers of $2$ for calculation:\n$$C_{total} = 2^7 \\times 2^{10} = 2^{7+10} = 2^{17}$$\n$$2^{17} = 131072$$\nTherefore, a total of $131072$ ADC conversions are required to complete one full inference. The statement that \"Partial sums across tiles... are added digitally after ADC\" confirms that the ADC operation is completed locally within each tile before any further digital processing, and does not introduce additional conversions.\n\nThe final answer consists of these two computed integer values.\n1) Total number of tiles: $1024$.\n2) Total number of ADC conversions: $131072$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1024 & 131072\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A scaled-out architecture must be supported by robust circuits that can handle the realities of analog computation. In an IMC system, the results of matrix-vector multiplication manifest as analog currents that must be accurately sensed and digitized. This final practice () brings you to the circuit level, where you will analyze the range of possible output currents to determine the dynamic range required for the peripheral Analog-to-Digital Converters (ADCs). This reveals a critical trade-off between array size, device characteristics, and the precision of the final computation.",
            "id": "4048653",
            "problem": "A resistive crossbar array is used for in-memory vector-matrix multiplication in neuromorphic and brain-inspired computing. Each cross-point device behaves as a linear conductance element obeying Ohm’s law, where the instantaneous current through a device is given by $I = G V$, with $G$ the conductance and $V$ the applied voltage across the device. Consider a $128 \\times 128$ crossbar in which an input voltage vector $\\{V_i\\}$ is applied along the rows and currents are sensed along the columns. For a chosen column index $j$, the column current is the superposition of all row contributions, modeled as\n$$\nI_{\\text{col},j} = \\sum_{i=1}^{128} G_{ij} V_i,\n$$\nassuming negligible interconnect resistance, no sneak paths, and that all devices operate within their linear regime.\n\nSuppose the input voltages take binary values $V_i \\in \\{0, 0.2\\}$ volts, and each device conductance lies within $G_{ij} \\in [1, 10]$ microSiemens. Under these conditions:\n\n- Compute the maximum possible column current $I_{\\max}$ in microamperes by invoking the fundamental laws governing linear conductance and superposition.\n- Compute the minimum non-zero column current $I_{\\min}$ in microamperes under the same assumptions.\n- Define the required linear dynamic range for the sense amplifier as the unitless ratio $D = I_{\\max}/I_{\\min}$.\n\nExplain, from first principles, how these quantities follow from the base laws and what they imply for the design of a current-mode sense amplifier or an Analog-to-Digital Converter (ADC). As your final answer, provide only the numerical value of $D$, with no rounding and no units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of linear circuit theory (Ohm's Law and Kirchhoff's Current Law), is well-posed with all necessary parameters defined, and is objective and formalizable. The provided physical parameters and simplifying assumptions (e.g., negligible interconnect resistance, no sneak paths) are standard for a first-order analysis of resistive crossbar arrays in the context of in-memory computing.\n\nThe problem requires the analysis of the output current range for a column in a $128 \\times 128$ resistive crossbar array. The fundamental law governing the behavior of each crosspoint device is Ohm's law, given as $I = G V$, where $I$ is the current, $G$ is the conductance, and $V$ is the voltage across the device. The total current for a specific column, indexed by $j$, is determined by Kirchhoff's Current Law (KCL). KCL dictates that the algebraic sum of currents entering a node must be zero. In this model, the column line acts as a summing node. Therefore, the total column current $I_{\\text{col},j}$ is the linear superposition of the currents flowing from each row $i$ through the corresponding crosspoint device $G_{ij}$. This is correctly modeled by the provided equation:\n$$\nI_{\\text{col},j} = \\sum_{i=1}^{128} I_{ij} = \\sum_{i=1}^{128} G_{ij} V_i\n$$\nThe givens for this analysis are:\n- The number of rows, $N = 128$.\n- The set of possible input voltages for each row $i$: $V_i \\in \\{0, 0.2\\}$ volts.\n- The range of possible conductance values for each device $(i,j)$: $G_{ij} \\in [1, 10]$ microSiemens, which can be written as $G_{ij} \\in [1 \\times 10^{-6}, 10 \\times 10^{-6}]$ Siemens.\n\nWe proceed to compute the maximum possible column current $I_{\\max}$, the minimum non-zero column current $I_{\\min}$, and the required dynamic range $D$.\n\nFirst, we determine the maximum possible column current, $I_{\\max}$. The expression for $I_{\\text{col},j}$ is a sum of $128$ terms, where each term $G_{ij} V_i$ is non-negative since $G_{ij} > 0$ and $V_i \\ge 0$. To maximize a sum of non-negative terms, each individual term must be maximized. The term $G_{ij} V_i$ is maximized when both the conductance $G_{ij}$ and the voltage $V_i$ are at their maximum possible values.\nThe maximum voltage is $V_{\\max} = 0.2 \\, \\text{V}$.\nThe maximum conductance is $G_{\\max} = 10 \\, \\mu\\text{S}$.\nTherefore, to achieve $I_{\\max}$, we must set all input voltages to their maximum value, $V_i = 0.2 \\, \\text{V}$ for all $i \\in \\{1, ..., 128\\}$, and assume all conductances in the chosen column $j$ are at their maximum value, $G_{ij} = 10 \\, \\mu\\text{S}$.\n$$\nI_{\\max} = \\sum_{i=1}^{128} (G_{\\max}) (V_{\\max}) = \\sum_{i=1}^{128} (10 \\, \\mu\\text{S}) \\times (0.2 \\, \\text{V})\n$$\nThe product $(10 \\, \\mu\\text{S}) \\times (0.2 \\, \\text{V})$ is equal to $2 \\, \\mu\\text{A}$.\n$$\nI_{\\max} = \\sum_{i=1}^{128} 2 \\, \\mu\\text{A} = 128 \\times 2 \\, \\mu\\text{A} = 256 \\, \\mu\\text{A}\n$$\nThus, the maximum possible column current is $256$ microamperes.\n\nNext, we determine the minimum non-zero column current, $I_{\\min}$. A non-zero current requires at least one term $G_{ij} V_i$ in the sum to be non-zero. Since $G_{ij}$ is always positive ($G_{ij} \\ge 1 \\, \\mu\\text{S}$), a term is non-zero if and only if its corresponding voltage $V_i$ is non-zero. The only non-zero voltage available is $V_i = 0.2 \\, \\text{V}$.\nTo minimize the sum while keeping it non-zero, we should have the minimum number of non-zero terms, and each of those terms should be as small as possible. The minimum number of non-zero terms is one. This occurs when exactly one row, say row $k$, has an input voltage of $V_k = 0.2 \\, \\text{V}$, and all other rows have $V_i = 0 \\, \\text{V}$ for $i \\neq k$.\nFor this single active row, the contribution to the current is $G_{kj} V_k$. To minimize this term, we must select the minimum possible conductance value, $G_{\\min} = 1 \\, \\mu\\text{S}$.\nSo, the minimum non-zero current is:\n$$\nI_{\\min} = (G_{\\min}) (V_{\\max}) + \\sum_{i \\neq k} (G_{ij}) (0 \\, \\text{V}) = (1 \\, \\mu\\text{S}) \\times (0.2 \\, \\text{V}) = 0.2 \\, \\mu\\text{A}\n$$\nThus, the minimum non-zero column current is $0.2$ microamperes.\n\nFinally, we compute the required linear dynamic range for the sense amplifier, defined as the unitless ratio $D = I_{\\max}/I_{\\min}$.\n$$\nD = \\frac{I_{\\max}}{I_{\\min}} = \\frac{256 \\, \\mu\\text{A}}{0.2 \\, \\mu\\text{A}} = \\frac{256}{0.2} = 1280\n$$\n\nThe implications of these values for the design of a current-mode sense amplifier or an Analog-to-Digital Converter (ADC) are significant.\n1.  **Dynamic Range**: The sensing circuit must have a dynamic range of at least $1280$. This means it must be able to accurately measure currents from as low as $0.2 \\, \\mu\\text{A}$ to as high as $256 \\, \\mu\\text{A}$. For an ADC, this implies a minimum resolution. The number of bits required to resolve this range is at least $\\log_2(D) = \\log_2(1280) \\approx 10.32$. Therefore, an ADC with at least $11$ bits of resolution would be necessary to distinguish all possible unique current levels, assuming they were spaced appropriately.\n2.  **Sensitivity and Noise**: The circuit must be sensitive enough to reliably detect and quantify the minimum current level, $I_{\\min} = 0.2 \\, \\mu\\text{A}$. The total noise of the sensing circuit (including thermal noise, shot noise, and amplifier input-referred noise) must be substantially lower than $I_{\\min}$ to ensure a high signal-to-noise ratio (SNR) for the weakest signals.\n3.  **Linearity**: For the crossbar to accurately perform the mathematical operation of vector-matrix multiplication, the relationship between the actual summed current and the output of the sense amplifier or ADC must be highly linear across the entire operational range $[I_{\\min}, I_{\\max}]$. Any non-linearity introduces computational error.\n4.  **Slew Rate and Bandwidth**: The sensing circuit must be fast enough to settle to the correct current value within the time allotted for a single computation cycle. The large current swing from near zero to $I_{\\max}$ places stringent demands on the slew rate and settling time of the amplifier.\n\nThese requirements highlight a central challenge in designing analog in-memory computing hardware: the need for sensing electronics that are simultaneously high-resolution, low-noise, highly linear, and fast, all while operating under power and area constraints typical of large-scale integrated circuits. The idealizations in the problem (no interconnect resistance or sneak paths) provide a best-case scenario; in a real device, these non-idealities would further degrade signal integrity and complicate the sensing task.",
            "answer": "$$\n\\boxed{1280}\n$$"
        }
    ]
}