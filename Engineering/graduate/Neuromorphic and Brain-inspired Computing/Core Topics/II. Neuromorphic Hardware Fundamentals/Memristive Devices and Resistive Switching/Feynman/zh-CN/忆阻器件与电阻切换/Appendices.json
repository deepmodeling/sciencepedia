{
    "hands_on_practices": [
        {
            "introduction": "在我们为忆阻器的开关行为建模之前，首先必须理解控制其电阻态的物理原理。本练习题  深入探讨了纳米级导电细丝中电阻的微观起源，应用 Drude 模型和马西森定则来解释电子边界散射的影响。通过完成此练习，您将定量地理解尺寸效应如何显著增加电阻率（相较于体材料），这是精确建模忆阻器件的关键一环。",
            "id": "4051465",
            "problem": "一个阻性随机存取存储器（RRAM）忆阻器在其导通状态下通过嵌入在氧化物中的圆柱形截面金属灯丝导电。考虑一个半径为 $R$、长度为 $L$ 的灯丝，其导电主要由无序金属相中费米能级附近的电子主导。在块状金属中，电阻率 $\\rho_{0}$ 由德鲁德模型描述，其中电导率为 $\\sigma_{0} = n e^{2} \\tau_{0} / m$，电阻率为 $\\rho_{0} = m / (n e^{2} \\tau_{0})$。块状材料的平均自由程为 $l = v_{F} \\tau_{0}$，其中 $v_{F}$ 是费米速度，$n$ 是电子密度，$e$ 是基本电荷，$m$ 是有效质量，$\\tau_{0}$ 是由晶格和杂质散射引起的块状材料动量弛豫时间。在纳米尺度的灯丝中，除了体散射外，电子还会在灯丝边界上发生散射；这种边界散射由镜面反射参数 $p \\in [0,1]$ 来表征，其中 $p = 1$ 表示完全镜面反射，$p = 0$ 表示完全漫散射。\n\n仅从德鲁德模型中关于 $\\sigma$ 和 $\\rho$ 的关系、平均自由程的定义 $l = v_{F} \\tau$ 以及独立散射率相加的原理（马西森定则）出发，通过在电子速度各向同性分布和电子位置在横截面内均匀分布的假设下，估计圆柱形灯丝中的附加边界散射率，推导出一个用 $l$、$R$ 和 $p$ 表示的电阻率增强因子 $\\rho / \\rho_{0}$ 的解析表达式。使用适用于三维各向同性速度分布的、物理上合理的边界平均径向速度估计值。\n\n然后，对于一个具有参数 $R = 2\\,\\mathrm{nm}$、$L = 50\\,\\mathrm{nm}$、$l = 10\\,\\mathrm{nm}$ 和 $p = 0$（完全漫反射边界散射）的忆阻器中的实际导通状态灯丝，评估电阻率增强因子 $\\rho / \\rho_{0}$。将最终答案表示为一个无量纲数。无需四舍五入；提供精确值。",
            "solution": "问题是推导圆柱形金属灯丝的电阻率增强因子 $\\rho/\\rho_0$ 的表达式，然后根据给定的一组参数计算其值。推导必须从德鲁德模型和马西森定则开始。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   灯丝几何形状：半径为 $R$、长度为 $L$ 的圆柱体。\n-   块状材料电阻率：$\\rho_{0} = m / (n e^{2} \\tau_{0})$，来自德鲁德模型的电导率 $\\sigma_{0} = n e^{2} \\tau_{0} / m$。\n-   块状材料平均自由程：$l = v_{F} \\tau_{0}$。\n-   变量：费米速度 $v_{F}$，电子密度 $n$，基本电荷 $e$，有效质量 $m$，块状材料动量弛豫时间 $\\tau_0$。\n-   边界散射：由镜面反射参数 $p \\in [0,1]$ 表征。$p=1$ 为镜面反射，$p=0$ 为漫散射。\n-   基本原理：独立散射率相加（马西森定则）。\n-   推导约束：必须基于电子速度各向同性分布和电子位置均匀分布来估计边界散射率。\n-   用于评估的数值：$R = 2\\,\\mathrm{nm}$，$L = 50\\,\\mathrm{nm}$，$l = 10\\,\\mathrm{nm}$，$p = 0$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学性：**该问题基于电子导电的德鲁德模型、用于组合散射率的马西森定则以及纳米线中的边界散射概念。这些是凝聚态物理学中用于描述尺寸对电导率影响的标准、成熟的概念。该模型是一种简化但物理上合理的方法（与Fuchs-Sondheimer和Dingle模型相关）。\n-   **良构性：**该问题要求进行特定的推导和后续计算。它提供了足够的物理原理和约束来指导唯一解析表达式的推导。\n-   **客观性：**该问题以精确、定量和客观的科学语言陈述。\n-   **完整性：**该问题提供了所有必要的物理原理和参数。“估计”散射率的指令是物理推导题的标准部分，而不是不完整的标志。参数 $L$ 已提供，但如下所示，计算电阻率这一内在属性时并不需要它，这是一个精心设计问题的标志。\n\n**步骤3：结论和行动**\n该问题科学有效、良构且完整。将提供解决方案。\n\n### 推导与求解\n\n根据德鲁德模型，电阻率 $\\rho$ 与动量弛豫时间 $\\tau$ 成反比：\n$$ \\rho = \\frac{m}{n e^2 \\tau} $$\n总动量弛豫时间 $\\tau$ 由所有贡献的散射机制决定。马西森定则指出，总散射率 $1/\\tau$ 是来自独立散射过程的速率之和。在这种情况下，这些过程是体散射（速率 $1/\\tau_0$）和边界散射（速率 $1/\\tau_b$）。\n$$ \\frac{1}{\\tau} = \\frac{1}{\\tau_0} + \\frac{1}{\\tau_b} $$\n电阻率增强因子是总电阻率 $\\rho$ 与块状材料电阻率 $\\rho_0$ 的比值：\n$$ \\frac{\\rho}{\\rho_0} = \\frac{m / (n e^2 \\tau)}{m / (n e^2 \\tau_0)} = \\frac{\\tau_0}{\\tau} $$\n代入马西森定则中 $1/\\tau$ 的表达式：\n$$ \\frac{\\rho}{\\rho_0} = \\tau_0 \\left( \\frac{1}{\\tau_0} + \\frac{1}{\\tau_b} \\right) = 1 + \\frac{\\tau_0}{\\tau_b} $$\n为了继续推导，我们必须估计边界散射弛豫时间 $\\tau_b$。速率 $1/\\tau_b$ 是在灯丝边界上发生动量随机化散射事件的有效速率。与边界的碰撞只有在是漫反射的情况下才能有效地使动量随机化。参数 $p$ 给出了镜面反射的比例，因此 $(1-p)$ 是漫散射事件的比例。有效的边界散射速率为：\n$$ \\frac{1}{\\tau_b} = (1-p) \\times (\\text{与边界的几何碰撞率}) $$\n几何碰撞率，我们记为 $1/\\tau_{coll}$，是单个电子每单位时间与边界碰撞的平均次数。这可以通过考虑射向边界表面的总电子通量除以灯丝中的总电子数来估算。\n\n对于半径为 $R$、长度为 $L$ 的灯丝，其体积为 $V = \\pi R^2 L$，边界表面积（圆柱壁）为 $A = 2\\pi R L$。导电电子的总数为 $N_{tot} = nV = n \\pi R^2 L$。\n\n对于以单一速度 $v_F$ 运动的各向同性三维粒子气体（如费米能级上的电子所假设的那样），射向任何表面的粒子通量 $J$（单位面积单位时间的粒子数）由动力学理论的一个标准结果给出：\n$$ J = \\frac{1}{4} n v_F $$\n每单位时间与边界碰撞的电子总数是通量乘以边界面积：\n$$ \\frac{dN_{coll}}{dt} = J \\cdot A = \\left(\\frac{1}{4} n v_F\\right) (2\\pi R L) = \\frac{1}{2} n v_F \\pi R L $$\n每个电子的平均碰撞率 $1/\\tau_{coll}$ 是这个总速率除以电子总数 $N_{tot}$：\n$$ \\frac{1}{\\tau_{coll}} = \\frac{dN_{coll}/dt}{N_{tot}} = \\frac{\\frac{1}{2} n v_F \\pi R L}{n \\pi R^2 L} = \\frac{v_F}{2R} $$\n这个结果具有正确的时间倒数单位，并表明对于更快的电子和更小的半径，碰撞率会增加，这与预期相符。\n\n现在，我们可以求出由边界引起的动量弛豫率：\n$$ \\frac{1}{\\tau_b} = (1-p) \\frac{1}{\\tau_{coll}} = (1-p) \\frac{v_F}{2R} $$\n我们将此代回电阻率增强因子的表达式中：\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{\\tau_0}{\\tau_b} = 1 + \\tau_0 \\left( (1-p) \\frac{v_F}{2R} \\right) $$\n使用块状材料平均自由程的定义 $l = v_F \\tau_0$，我们可以用 $l/v_F$ 替换 $\\tau_0$：\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{l}{v_F} \\left( (1-p) \\frac{v_F}{2R} \\right) $$\n费米速度 $v_F$ 被消掉，得到电阻率增强因子的最终解析表达式：\n$$ \\frac{\\rho}{\\rho_0} = 1 + (1-p) \\frac{l}{2R} $$\n这个表达式仅取决于块状材料平均自由程与灯丝半径的比率以及边界镜面反射参数，这在物理上是正确的。\n\n现在，我们使用给定的参数评估此表达式：$R = 2\\,\\mathrm{nm}$，$l = 10\\,\\mathrm{nm}$，以及 $p = 0$（完全漫散射）。\n$$ \\frac{\\rho}{\\rho_0} = 1 + (1 - 0) \\frac{10\\,\\mathrm{nm}}{2 \\times (2\\,\\mathrm{nm})} $$\n$$ \\frac{\\rho}{\\rho_0} = 1 + \\frac{10}{4} $$\n$$ \\frac{\\rho}{\\rho_0} = 1 + 2.5 $$\n$$ \\frac{\\rho}{\\rho_0} = 3.5 $$\n由于窄灯丝中漫反射边界散射的主导作用，灯丝的电阻率比块状材料的电阻率高3.5倍。",
            "answer": "$$\\boxed{3.5}$$"
        },
        {
            "introduction": "在建立了电阻态的物理基础之后，我们现在转向它们之间转换的动力学过程。本练习  要求您从第一性原理出发，推导忆阻器的状态演化方程，将导电区域的宏观变化与离子物质的微观漂移联系起来。这一基础性的推导阐明了记忆效应的物理基础，并为许多紧凑模型提供了核心的动态方程。",
            "id": "4051466",
            "problem": "一个双极性电阻开关二氧化钛忆阻器通过单一内部状态变量 $w(t)$ 进行建模，该变量表示总厚度为 $D$ 的薄膜内氧空位掺杂的低阻区域的宽度。当器件完全掺杂时（即当 $w=D$ 时），其测得的低阻态电阻为 $R_{\\mathrm{on}}$。假设在电激励期间，氧空位的离子漂移主导了 $w$ 边界的运动，并且在短时激励期间，离子扩散和任何场增强的非线性效应都可以忽略不计。该器件由一个矩形电流脉冲序列驱动，其脉冲幅度为 $I_{0}$，脉冲宽度为 $\\tau$，周期为 $T$，且满足 $T \\gg \\tau$，并且关断时间对 $w$ 的影响可以忽略不计。有源层具有均匀的横截面积 $A$，但 $A$ 的值未被提供。\n\n仅从以下基本关系和定义出发：\n- 带电缺陷的漂移速度为 $v_{\\mathrm{d}}=\\mu_{v} E$，其中 $\\mu_{v}$ 是离子迁移率， $E$ 是局域电场。\n- 均匀导体中的本构关系为 $E=\\rho J$，其中 $\\rho$ 是电阻率， $J$ 是电流密度，对于端电流 $i$ 和横截面积 $A$，$J=i/A$。\n- 长度为 $L$、横截面积为 $A$ 的均匀材料板的宏观电阻为 $R=\\rho L/A$。\n\n在不假设任何预先给定的状态演化定律的情况下，请从这些基础出发，推导在单个电流脉冲期间 $w$ 的变化量 $\\Delta w$（单位为米）的表达式。此推导应在小脉冲极限下进行，即脉冲期间 $w$ 没有显著变化。你的最终表达式必须只包含 $I_{0}$、$\\tau$ 和给定的器件参数，并且不应包含未知的横截面积 $A$。\n\n使用以下参数值：$\\mu_{v}=10^{-10}\\,\\mathrm{m}^{2}/\\mathrm{V\\,s}$，$D=10\\,\\mathrm{nm}$，$R_{\\mathrm{on}}=1\\,\\mathrm{k}\\Omega$。将 $\\Delta w$ 的最终结果（单位为米）表示为一个闭合形式的解析表达式。无需四舍五入。",
            "solution": "问题要求计算在幅度为 $I_0$、持续时间为 $\\tau$ 的单个电流脉冲作用下，掺杂区域宽度 $\\Delta w$ 的变化量。推导必须仅从提供的基本关系出发。\n\n状态变量 $w(t)$ 代表低阻（掺杂）区域的宽度。其变化率由掺杂区和非掺杂区之间边界的速度决定。这个速度就是氧空位的漂移速度 $v_{\\mathrm{d}}$。\n$$\n\\frac{dw}{dt} = v_{\\mathrm{d}}\n$$\n\n问题给出了带电缺陷漂移速度的关系式：\n$$\nv_{\\mathrm{d}} = \\mu_{v} E\n$$\n其中 $\\mu_{v}$ 是离子迁移率， $E$ 是驱动运动的局域电场。将它们结合起来得到：\n$$\n\\frac{dw}{dt} = \\mu_{v} E\n$$\n\n问题的结构使得只有与掺杂（低阻）区域相关的参数被完全指定。掺杂区域的电阻率为 $\\rho_{\\mathrm{on}}$。这个均匀导体内的电场由本构关系 $E = \\rho J$ 给出。我们必须解释驱动边界运动的“局域电场” $E$。根据所提供的信息，唯一可以在不引入新的未知参数（如非掺杂区的电阻率 $\\rho_{\\mathrm{off}}$）的情况下量化的场是掺杂区内的电场 $E_{\\mathrm{on}}$。因此，我们假设 $E = E_{\\mathrm{on}}$ 进行推导。\n$$\nE = E_{\\mathrm{on}} = \\rho_{\\mathrm{on}} J\n$$\n其中 $J$ 是器件中的电流密度。由于横截面积 $A$ 均匀，电流密度也是均匀的，并且通过 $J = i(t)/A$ 与端电流 $i(t)$ 相关联。在脉冲期间，电流是恒定的 $i(t) = I_0$。因此，\n$$\nJ = \\frac{I_0}{A}\n$$\n\n将这些关系代入 $dw/dt$ 的方程，我们得到：\n$$\n\\frac{dw}{dt} = \\mu_{v} \\left( \\rho_{\\mathrm{on}} \\frac{I_0}{A} \\right) = \\mu_{v} I_0 \\frac{\\rho_{\\mathrm{on}}}{A}\n$$\n这个表达式包含项 $\\rho_{\\mathrm{on}}/A$，其中涉及两个未知数 $\\rho_{\\mathrm{on}}$ 和 $A$。问题指出横截面积 $A$ 未被提供，且最终答案中不能出现 $A$。我们可以使用给定的器件参数 $R_{\\mathrm{on}}$ 来消去比值 $\\rho_{\\mathrm{on}}/A$。\n\n$R_{\\mathrm{on}}$ 是器件完全掺杂时的电阻，即掺杂区域延伸至整个薄膜厚度时（$w=D$）。使用均匀材料板的宏观电阻公式 $R = \\rho L/A$，其中电阻 $R=R_{\\mathrm{on}}$，电阻率 $\\rho=\\rho_{\\mathrm{on}}$，长度 $L=D$：\n$$\nR_{\\mathrm{on}} = \\frac{\\rho_{\\mathrm{on}} D}{A}\n$$\n由此，我们可以解出比值 $\\rho_{\\mathrm{on}}/A$：\n$$\n\\frac{\\rho_{\\mathrm{on}}}{A} = \\frac{R_{\\mathrm{on}}}{D}\n$$\n\n现在，我们将其代回到 $dw/dt$ 的表达式中：\n$$\n\\frac{dw}{dt} = \\mu_{v} I_0 \\left( \\frac{R_{\\mathrm{on}}}{D} \\right)\n$$\n这就是掺杂区域宽度的变化率。问题说明我们处于小脉冲极限下，即脉冲期间 $w$ 没有显著变化。我们推导出的 $dw/dt$ 表达式与 $w$ 无关，并且在电流脉冲持续期间是恒定的，因为 $\\mu_{v}$、$I_0$、$R_{\\mathrm{on}}$ 和 $D$ 都是常数。这与小脉冲极限的假设完全一致。\n\n为了求出在持续时间为 $\\tau$ 的单个脉冲内的总宽度变化量 $\\Delta w$，我们将 $dw/dt$ 从 $t=0$ 到 $t=\\tau$ 对时间进行积分：\n$$\n\\Delta w = \\int_{0}^{\\tau} \\frac{dw}{dt} dt = \\int_{0}^{\\tau} \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 dt\n$$\n由于被积函数是常数，积分变为：\n$$\n\\Delta w = \\left( \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 \\right) \\int_{0}^{\\tau} dt = \\mu_{v} \\frac{R_{\\mathrm{on}}}{D} I_0 \\tau\n$$\n这是用给定参数、$I_0$ 和 $\\tau$ 表示的 $\\Delta w$ 的符号表达式，其中未知面积 $A$ 已被成功消去。\n\n问题要求使用提供的数值给出一个闭合形式的解析表达式。给定的值为：\n$\\mu_{v} = 10^{-10}\\,\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})$\n$D = 10\\,\\mathrm{nm} = 10 \\times 10^{-9}\\,\\mathrm{m} = 10^{-8}\\,\\mathrm{m}$\n$R_{\\mathrm{on}} = 1\\,\\mathrm{k}\\Omega = 10^{3}\\,\\Omega$\n\n我们来计算常系数 $\\mu_{v} R_{\\mathrm{on}} / D$：\n$$\n\\frac{\\mu_{v} R_{\\mathrm{on}}}{D} = \\frac{(10^{-10}\\,\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})) \\cdot (10^{3}\\,\\Omega)}{10^{-8}\\,\\mathrm{m}}\n$$\n回顾 $1\\,\\Omega = 1\\,\\mathrm{V}/\\mathrm{A}$，单位变为：\n$$\n\\frac{(\\mathrm{m}^{2}/(\\mathrm{V}\\cdot\\mathrm{s})) \\cdot (\\mathrm{V}/\\mathrm{A})}{\\mathrm{m}} = \\frac{\\mathrm{m}}{\\mathrm{A} \\cdot \\mathrm{s}}\n$$\n数值为：\n$$\n\\frac{10^{-10} \\cdot 10^{3}}{10^{-8}} = \\frac{10^{-7}}{10^{-8}} = 10^{1} = 10\n$$\n所以，系数为 $10\\,\\mathrm{m}/(\\mathrm{A} \\cdot \\mathrm{s})$。\n\n将此值代回到 $\\Delta w$ 的表达式中：\n$$\n\\Delta w = 10 \\, I_0 \\tau\n$$\n这就是 $\\Delta w$ 的最终闭合形式解析表达式。如果电流 $I_0$ 的单位是安培，脉冲宽度 $\\tau$ 的单位是秒，则得到的 $\\Delta w$ 的单位将是米，符合要求。",
            "answer": "$$\n\\boxed{10 I_{0} \\tau}\n$$"
        },
        {
            "introduction": "物理理解是基础，但对于电路和系统设计，我们需要高效的紧凑模型。最后的这项练习  将状态依赖电阻和基于阈值的开关动力学等概念整合到一个完整的、计算上易于处理的模型中。通过实现该模型并对照合成数据验证其预测，您将体验从物理理论到模型验证的完整工作流程，这是神经形态工程中的一项关键技能。",
            "id": "4051518",
            "problem": "要求您通过预测一种阻变忆阻器件对新电压脉冲序列的电学响应，并将这些预测与一个合成实验数据集使用定量误差度量进行比较，从而验证该器件的紧凑模型。其背景是专注于忆阻器件和电阻转换的高阶研究生水平的神经形态和脑启发计算。\n\n该器件使用一个状态依赖电阻器建模，该模型捕捉了导电细丝的形成和断裂过程。设内部状态变量为 $w \\in [0,1]$，代表已形成的低阻细丝的归一化部分，其中 $w=0$ 对应高阻态，$w=1$ 对应低阻态。\n\n使用以下基本依据和经过充分检验的事实：\n\n- 欧姆定律 (Ohm’s law)：$i = \\frac{v}{R}$，其中 $i$ 是电流（单位：安培），$v$ 是电压（单位：伏特），$R$ 是电阻（单位：欧姆）。\n- 在忆阻器件的状态依赖电阻器模型中，电阻依赖于内部状态变量 $w$：\n  $$ R(w) = R_{\\mathrm{on}} \\, w + R_{\\mathrm{off}} \\, (1 - w), $$\n  其中 $R_{\\mathrm{on}}$ 和 $R_{\\mathrm{off}}$ 是正常数，分别代表低阻和高阻极限。\n- 内部状态变量 $w$ 的演化是由可移动离子种类（例如氧空位）在电场驱动下的漂移引起的，且仅当所施加电压的幅值超过取决于材料的阈值时才会发生。在边界 $w=0$ 和 $w=1$ 附近，其演化速度减慢至零。\n\n从这些基础出发，为状态演化 $dw/dt$ 推导一个紧凑、物理上一致、分段、带阈值的漂移模型，该模型应满足：\n- 与超出阈值的电驱动成正比，\n- 对于正电压和负电压具有相反的极性行为，\n- 包含一个平滑窗函数 $F(w)$，其中 $F(0)=F(1)=0$，以抑制在边界处的非物理增长，\n- 在任何时候都遵守 $w \\in [0,1]$ 的界限。\n\n假设窗函数的形式为\n$$ F(w) = 1 - \\left(2w - 1\\right)^{4}, $$\n并引入正常数参数 $\\alpha_{\\mathrm{pos}}$ 和 $\\alpha_{\\mathrm{neg}}$（单位的选择应使 $w$ 无量纲且时间单位为秒）作为正向和负向驱动下漂移的比例常数，以及正常数电压阈值 $V_{\\mathrm{th,pos}}$ 和 $V_{\\mathrm{th,neg}}$。\n\n推导出模型后，用固定的时间步长 $\\Delta t$ 实现一个数值时间积分程序，以模拟对指定电压脉冲序列的响应。应在每个脉冲结束时对电流进行采样。在每个积分步骤后，将状态 $w$ 限制在 $[0,1]$ 区间内。\n\n通过将相同的脉冲应用于与预测模型不同的“真实”器件参数集，并添加具有指定标准差的确定性零均值高斯噪声，来构建合成的“实验”电流。使用固定的随机种子以使噪声可复现。\n\n计算在脉冲结束时采样的预测电流和实验电流之间的以下误差度量：\n- 均方根误差 (RMSE): \n  $$ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right)^2 }, $$\n- 平均绝对误差 (MAE):\n  $$ \\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right|, $$\n其中 $N$ 是序列中的脉冲数。将 $\\mathrm{RMSE}$ 和 $\\mathrm{MAE}$ 均以安培 (A) 为单位，表示为十进制数。\n\n仿真和参数说明：\n\n- 时间步长：$\\Delta t = 10^{-4} \\, \\mathrm{s}$。\n- 预测模型参数：\n  - $R_{\\mathrm{on}} = 1000 \\, \\Omega$,\n  - $R_{\\mathrm{off}} = 100000 \\, \\Omega$,\n  - $\\alpha_{\\mathrm{pos}} = 80 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $\\alpha_{\\mathrm{neg}} = 60 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $V_{\\mathrm{th,pos}} = 0.9 \\, \\mathrm{V}$,\n  - $V_{\\mathrm{th,neg}} = 0.9 \\, \\mathrm{V}$。\n- 真实（实验）模型参数：\n  - $R_{\\mathrm{on,true}} = 1200 \\, \\Omega$,\n  - $R_{\\mathrm{off,true}} = 90000 \\, \\Omega$,\n  - $\\alpha_{\\mathrm{pos,true}} = 100 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $\\alpha_{\\mathrm{neg,true}} = 50 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n  - $V_{\\mathrm{th,pos,true}} = 0.85 \\, \\mathrm{V}$,\n  - $V_{\\mathrm{th,neg,true}} = 0.95 \\, \\mathrm{V}$。\n- 窗函数指数已如上所示嵌入在 $F(w)$ 中。\n- 噪声：加性零均值高斯噪声，标准差为 $\\sigma = 5 \\times 10^{-7} \\, \\mathrm{A}$；使用随机种子 $42$。\n\n测试套件（每个测试用例指定一个初始状态 $w_0$ 和一个电压脉冲列表 $(A, \\tau)$，其中 $A$ 是幅值（单位：伏特），$\\tau$ 是持续时间（单位：秒）；在每个脉冲结束时对电流进行采样）：\n\n- 用例 1（混合极性，包含亚阈值）：\n  - $w_0 = 0.3$,\n  - 脉冲：$(1.2, 0.010)$, $(-1.1, 0.008)$, $(0.8, 0.020)$, $(1.5, 0.005)$。\n- 用例 2（强置位，饱和，后接亚阈值复位）：\n  - $w_0 = 0.1$,\n  - 脉冲：$(2.0, 0.020)$, $(2.0, 0.015)$, $(-0.5, 0.050)$。\n- 用例 3（主要为亚阈值，含一个近阈值的负脉冲）：\n  - $w_0 = 0.6$,\n  - 脉冲：$(0.7, 0.010)$, $(-0.8, 0.010)$, $(0.85, 0.005)$, $(-0.95, 0.004)$。\n\n你的程序必须：\n- 推导并实现紧凑模型，\n- 为每个用例模拟预测电流和实验电流，\n- 为每个用例计算 $\\mathrm{RMSE}$ 和 $\\mathrm{MAE}$（单位：安培），\n- 生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中按顺序包含六个数字\n  $$ [\\mathrm{RMSE}_1, \\mathrm{MAE}_1, \\mathrm{RMSE}_2, \\mathrm{MAE}_2, \\mathrm{RMSE}_3, \\mathrm{MAE}_3] $$\n\n角度不适用。所有物理量必须以指定单位处理。最终输出必须以安培为单位，表示为十进制数。",
            "solution": "我们从用于阻变忆阻器件的标准状态依赖电阻器框架开始。瞬时电学行为遵循欧姆定律，其中电阻依赖于内部状态变量。具体来说，\n$$ i(t) = \\frac{v(t)}{R\\left(w(t)\\right)}, $$\n其中\n$$ R(w) = R_{\\mathrm{on}} \\, w + R_{\\mathrm{off}} \\, (1 - w), $$\n对于 $w \\in [0,1]$，$R_{\\mathrm{on}}  0$ 且 $R_{\\mathrm{off}}  0$。此形式表示由细丝分数 $w$ 加权的低阻和高阻极限的凸组合。\n\n为了对 $w$ 的动力学建模，我们借助于可移动物种（例如氧空位）在外加电场下的漂移。漂移速度 $v_{\\mathrm{drift}}$ 与超过材料相关阈值的有效驱动场成正比。在阈值以下，电场不足以激活通过势垒的漂移，导致可忽略的净演化。此外，当细丝接近完全形成（$w \\to 1$）或完全断裂（$w \\to 0$）时，空间位阻和边界约束会抑制进一步的演化。这通过一个窗函数 $F(w)$ 来捕捉，该函数满足 $F(0) = F(1) = 0$ 并在 $(0,1)$ 区间内为正。\n\n通过分离正负极性，可以写出一个最小的、物理上一致、分段、带阈值的漂移模型。设 $v(t)$ 为施加电压，$V_{\\mathrm{th,pos}}  0$ 和 $V_{\\mathrm{th,neg}}  0$ 为正负阈值，并让 $\\alpha_{\\mathrm{pos}}  0$ 和 $\\alpha_{\\mathrm{neg}}  0$ 缩放速率。使用指定的窗函数\n$$ F(w) = 1 - \\left(2w - 1\\right)^{4}, $$\n我们写出\n$$\n\\frac{dw}{dt} =\n\\begin{cases}\n\\alpha_{\\mathrm{pos}} \\, \\left(v - V_{\\mathrm{th,pos}}\\right) \\, F(w),  v \\ge V_{\\mathrm{th,pos}}, \\\\\n-\\alpha_{\\mathrm{neg}} \\, \\left(|v| - V_{\\mathrm{th,neg}}\\right) \\, F(1 - w),  v \\le -V_{\\mathrm{th,neg}}, \\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n此形式确保：\n- 对于足够大的正电压（$v \\ge V_{\\mathrm{th,pos}}$），细丝生长（$dw/dt  0$），并在 $w=1$ 附近被 $F(w)$ 抑制。\n- 对于足够大的负电压（$v \\le -V_{\\mathrm{th,neg}}$），细丝断裂（$dw/dt  0$），并通过 $F(1-w)$ 在 $w=0$ 附近被抑制。\n- 对于亚阈值电压（$|v|  \\min(V_{\\mathrm{th,pos}}, V_{\\mathrm{th,neg}})$），演化可忽略不计（$dw/dt \\approx 0$）。\n状态变量 $w$ 在每次更新后必须被限制在物理区间 $[0,1]$ 内。\n\n给定一个恒定幅值为 $A$、持续时间为 $\\tau$ 的电压脉冲，以及一个固定的时间步长 $\\Delta t$，我们实现显式欧拉积分：\n$$ w_{n+1} = \\mathrm{clip}\\left( w_n + \\Delta t \\cdot \\frac{dw}{dt}\\bigg|_{v=A,\\, w=w_n}, \\, 0, \\, 1 \\right), $$\n迭代 $N = \\left\\lfloor \\frac{\\tau}{\\Delta t} \\right\\rfloor$ 步。在脉冲结束时，电流采样为\n$$ i_{\\mathrm{end}} = \\frac{A}{R\\left(w_N\\right)}. $$\n\n预测模型使用校准后的参数：\n- $R_{\\mathrm{on}} = 1000 \\, \\Omega$,\n- $R_{\\mathrm{off}} = 100000 \\, \\Omega$,\n- $\\alpha_{\\mathrm{pos}} = 80 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $\\alpha_{\\mathrm{neg}} = 60 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $V_{\\mathrm{th,pos}} = 0.9 \\, \\mathrm{V}$,\n- $V_{\\mathrm{th,neg}} = 0.9 \\, \\mathrm{V}$。\n\n合成实验电流使用真实参数生成：\n- $R_{\\mathrm{on,true}} = 1200 \\, \\Omega$,\n- $R_{\\mathrm{off,true}} = 90000 \\, \\Omega$,\n- $\\alpha_{\\mathrm{pos,true}} = 100 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $\\alpha_{\\mathrm{neg,true}} = 50 \\, \\mathrm{s}^{-1} \\, \\mathrm{V}^{-1}$,\n- $V_{\\mathrm{th,pos,true}} = 0.85 \\, \\mathrm{V}$,\n- $V_{\\mathrm{th,neg,true}} = 0.95 \\, \\mathrm{V}$。\n我们使用固定的随机种子 42 添加标准差为 $\\sigma = 5 \\times 10^{-7} \\, \\mathrm{A}$ 的零均值高斯噪声以确保可复现性：\n$$ i_{\\mathrm{exp}}^{(k)} = i_{\\mathrm{true}}^{(k)} + \\epsilon^{(k)}, \\quad \\epsilon^{(k)} \\sim \\mathcal{N}(0, \\sigma^2). $$\n\n对于每个测试用例，我们从指定的初始条件 $w_0$ 开始，在相同的脉冲序列下模拟预测模型和真实模型。对两个模型的每个脉冲结束时的电流进行采样，并计算误差度量：\n$$ \\mathrm{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{k=1}^{N} \\left( i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right)^2 }, \\quad\n\\mathrm{MAE} = \\frac{1}{N} \\sum_{k=1}^{N} \\left| i_{\\mathrm{pred}}^{(k)} - i_{\\mathrm{exp}}^{(k)} \\right|. $$\n\n算法步骤如下：\n- 实现窗函数 $F(w)$ 和 $dw/dt$ 的分段漂移规则。\n- 使用带限制的显式欧拉法对每个脉冲上的 $w$ 进行积分。\n- 通过欧姆定律和状态依赖电阻计算每个脉冲结束时的电流 $i$。\n- 使用真实参数生成实验电流，并使用固定种子添加确定性高斯噪声。\n- 为每个用例计算 $\\mathrm{RMSE}$ 和 $\\mathrm{MAE}$。\n- 以安培为单位，输出包含六个数字 $[\\mathrm{RMSE}_1, \\mathrm{MAE}_1, \\mathrm{RMSE}_2, \\mathrm{MAE}_2, \\mathrm{RMSE}_3, \\mathrm{MAE}_3]$ 的单行。\n\n测试套件涵盖：\n- 一个包含亚阈值脉冲的混合极性序列，用于验证阈值行为和可逆性（用例 1），\n- 驱动饱和至 $w \\approx 1$ 的强正脉冲和一个亚阈值负脉冲，用于测试边界限制和窗函数抑制效果（用例 2），\n- 主要为亚阈值脉冲，并带有一个近阈值的负脉冲，用于测试阈值附近的灵敏度（用例 3）。\n\n这种基于原理的推导与阻变器件的物理原理相符，并得出了一个适用于通过安培单位的预测准确性度量进行神经形态验证的紧凑模型。",
            "answer": "```python\nimport numpy as np\n\n# Model and simulation for memristive device validation via error metrics.\n# Python 3.12, numpy 1.23.5; no other external libraries.\n\ndef window_function(w):\n    # F(w) = 1 - (2w - 1)^4\n    return 1.0 - (2.0 * w - 1.0) ** 4\n\ndef dw_dt(v, w, params):\n    # Piecewise thresholded drift model\n    Vth_pos = params[\"V_th_pos\"]\n    Vth_neg = params[\"V_th_neg\"]\n    alpha_pos = params[\"alpha_pos\"]\n    alpha_neg = params[\"alpha_neg\"]\n    if v >= Vth_pos:\n        return alpha_pos * (v - Vth_pos) * window_function(w)\n    elif v = -Vth_neg:\n        return -alpha_neg * (abs(v) - Vth_neg) * window_function(1.0 - w)\n    else:\n        return 0.0\n\ndef resistance(w, params):\n    # R(w) = R_on * w + R_off * (1 - w)\n    return params[\"R_on\"] * w + params[\"R_off\"] * (1.0 - w)\n\ndef simulate_pulses(pulses, w0, params, dt):\n    # Simulate over sequence of pulses, sampling current at end of each pulse\n    currents = []\n    w = float(w0)\n    for A, tau in pulses:\n        steps = int(round(tau / dt))\n        for _ in range(steps):\n            w += dt * dw_dt(A, w, params)\n            # Clamp w to [0,1]\n            if w  0.0:\n                w = 0.0\n            elif w > 1.0:\n                w = 1.0\n        # Current sampled at end of pulse\n        Rw = resistance(w, params)\n        i_end = A / Rw\n        currents.append(i_end)\n    return np.array(currents), w\n\ndef compute_errors(pred, exp):\n    # RMSE and MAE\n    diff = pred - exp\n    rmse = float(np.sqrt(np.mean(diff ** 2)))\n    mae = float(np.mean(np.abs(diff)))\n    return rmse, mae\n\ndef solve():\n    # Time step\n    dt = 1e-4  # seconds\n\n    # Prediction (calibrated) model parameters\n    pred_params = {\n        \"R_on\": 1000.0,        # ohms\n        \"R_off\": 100000.0,     # ohms\n        \"alpha_pos\": 80.0,     # s^-1 V^-1\n        \"alpha_neg\": 60.0,     # s^-1 V^-1\n        \"V_th_pos\": 0.9,       # V\n        \"V_th_neg\": 0.9,       # V\n    }\n\n    # True (experimental) model parameters\n    true_params = {\n        \"R_on\": 1200.0,        # ohms\n        \"R_off\": 90000.0,      # ohms\n        \"alpha_pos\": 100.0,    # s^-1 V^-1\n        \"alpha_neg\": 50.0,     # s^-1 V^-1\n        \"V_th_pos\": 0.85,      # V\n        \"V_th_neg\": 0.95,      # V\n    }\n\n    # Noise specifications\n    sigma_noise = 5e-7  # A\n    rng = np.random.default_rng(42)\n\n    # Test suite: pulses and initial states\n    test_cases = [\n        {\n            \"w0\": 0.3,\n            \"pulses\": [(1.2, 0.010), (-1.1, 0.008), (0.8, 0.020), (1.5, 0.005)],\n        },\n        {\n            \"w0\": 0.1,\n            \"pulses\": [(2.0, 0.020), (2.0, 0.015), (-0.5, 0.050)],\n        },\n        {\n            \"w0\": 0.6,\n            \"pulses\": [(0.7, 0.010), (-0.8, 0.010), (0.85, 0.005), (-0.95, 0.004)],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        w0 = case[\"w0\"]\n        pulses = case[\"pulses\"]\n\n        # Predicted currents using calibrated model\n        pred_currents, _ = simulate_pulses(pulses, w0, pred_params, dt)\n\n        # Experimental currents using true model + noise\n        exp_currents, _ = simulate_pulses(pulses, w0, true_params, dt)\n        exp_currents_noisy = exp_currents + rng.normal(0.0, sigma_noise, size=exp_currents.shape)\n\n        rmse, mae = compute_errors(pred_currents, exp_currents_noisy)\n        results.extend([rmse, mae])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}