## 引言
随着对更高性能、更安全电池的需求日益增长，依赖物理模型的仿真实践已成为加速研发、优化设计和预测寿命的关键。这些模型由一组复杂的、紧密耦合的[偏微分](@entry_id:194612)方程（PDE）和[微分代数方程](@entry_id:748394)（DAE）所描述，准确而高效地求解这些方程是实现高保真[虚拟样机](@entry_id:1133826)的核心挑战。传统的实验试错法成本高昂且周期漫长，而数值仿真提供了一条洞察电池内部工作机理、探索广阔设计空间的有效途径。然而，如何将描述电化学、[热力学](@entry_id:172368)和[输运过程](@entry_id:177992)的物理定律转化为稳定、可靠的计算算法，并克服模型固有的刚性（stiffness）和强[非线性](@entry_id:637147)，是工程师和研究者必须解决的关键问题。

本文旨在系统性地阐述求解[电池模型](@entry_id:1121428)的数值方法。在**“原理与机制”**一章中，我们将深入剖析从空间离散化到时间积分的完整数值流程，揭示处理刚性[DAE系统](@entry_id:1123360)的核心策略。接下来，在**“应用与跨学科交叉”**一章中，我们将展示这些数值方法如何被应用于多物理场耦合、老化预测、自动化[设计优化](@entry_id:748326)和不确定性量化等前沿领域，体现其作为连接基础科学与工程应用的桥梁作用。最后，通过**“动手实践”**部分，您将有机会通过具体问题加深对关键数值概念的理解和应用能力。

## 原理与机制

本章深入探讨了求解[电池模型](@entry_id:1121428)中常见的[偏微分](@entry_id:194612)方程（PDE）和微分代数方程（DAE）系统的核心数值原理与机制。在“引言”章节的基础上，我们将系统性地剖析从建立[半离散化](@entry_id:163562)系统到进行鲁棒[时域积分](@entry_id:755982)的完整流程。我们将展示如何将复杂的物理定律转化为可计算的代数系统，并阐明为何某些数值策略在电池仿真中至关重要。

### 空间离散化：线方法

求解电池模型中耦合的瞬态[偏微分](@entry_id:194612)方程，一个强大而通用的策略是**线方法**（Method of Lines, MOL）。该方法的核心思想是将空间维度和时间维度[解耦](@entry_id:160890)处理。首先，我们对空间变量进行离散化，将[偏微分](@entry_id:194612)方程（PDE）系统转化为一个大型的[常微分方程](@entry_id:147024)（ODE）和代数方程组，即**[微分代数方程](@entry_id:748394)**（DAE）系统。随后，我们可以使用为求解 ODE/DAE [系统设计](@entry_id:755777)的成熟[时域积分](@entry_id:755982)器来求解这个[半离散化](@entry_id:163562)系统。

[有限体积法](@entry_id:141374)（Finite Volume Method, FVM）是进行空间离散化的一种特别有效的方法，因为它天然地保证了物理量的守恒性，这对于模拟电荷和质量的输运至关重要。

#### 单一域中的[扩散离散化](@entry_id:748413)

让我们以[电池模型](@entry_id:1121428)中的一个核心子问题为例：锂在球形活性材料颗粒中的扩散 。该过程由[菲克第二定律](@entry_id:149792)在[球坐标](@entry_id:146054)下描述：
$$
\frac{\partial c_s}{\partial t} = \frac{D_s}{r^2}\frac{\partial}{\partial r}\left(r^2 \frac{\partial c_s}{\partial r}\right)
$$
其中 $c_s(r,t)$ 是锂浓度，$D_s$ 是固相扩散系数，$r \in [0,R]$ 是[径向坐标](@entry_id:165186)。

为了应用[有限体积法](@entry_id:141374)，我们将球体划分为 $N$ 个同心球壳。对于第 $i$ 个球壳，其体积为 $V_i$，跨越径向区间 $[r_{i-1/2}, r_{i+1/2}]$。对上述[守恒方程](@entry_id:1122898)在 $V_i$ 上积分，并应用散度定理，我们得到：
$$
V_i \frac{d c_i}{dt} = A_{i+1/2} J_{i+1/2} - A_{i-1/2} J_{i-1/2}
$$
其中 $c_i(t)$ 是第 $i$ 个球壳的平均浓度，$A_{i \pm 1/2} = 4\pi r_{i \pm 1/2}^2$ 是球壳的内外表面积，$J$ 是径向[摩尔通量](@entry_id:156263)。通量 $J$ 由[菲克第一定律](@entry_id:141732)给出，$J = -D_s \frac{\partial c_s}{\partial r}$。使用[中心差分近似](@entry_id:177025)界面通量，例如：
$$
J_{i+1/2} \approx -D_s \frac{c_{i+1} - c_i}{\Delta r}
$$
其中 $\Delta r$ 是相邻球壳中心的距离。

边界条件的处理至关重要。在球心 $r=0$ 处，对称性要求通量为零，即 $J_0=0$。在颗粒表面 $r=R$ 处，通量由电化学反应电流密度 $j_n$ 决定：$-D_s\frac{\partial c_s}{\partial r}|_{r=R} = j_n / (a_s F)$。将这些离散化表达式组合起来，我们便可得到一个形如 $\mathbf{M}\frac{d\mathbf{c}}{dt} = \mathbf{A}\mathbf{c} + \mathbf{g}(t)$ 的[半离散化](@entry_id:163562) ODE 系统。其中，$\mathbf{M}$ 是一个[对角矩阵](@entry_id:637782)，其元素为各球壳的体积（质量矩阵）；$\mathbf{A}$ 是一个[三对角矩阵](@entry_id:138829)，代表了相邻球壳间的[扩散耦合](@entry_id:155952)（刚度矩阵）；$\mathbf{g}(t)$ 是源项向量，包含了表面[通量边界条件](@entry_id:749481)。

#### [复合域](@entry_id:151036)与[界面条件](@entry_id:750725)

电池宏观模型本质上是一个[复合域](@entry_id:151036)问题，包含了负极、隔膜和正极等不同材料层。在这些材料的界面处，必须施加物理上正确的连接条件才能获得有意义的解  。

考虑一维[稳态扩散](@entry_id:154663)问题 $-\frac{d}{dx}\left(D(x)\frac{dc}{dx}\right)=0$，其中扩散系数 $D(x)$ 在不同区域是分段常数。在两个区域的界面处，必须同时满足两个条件：
1.  **浓度连续性**：$c(x^-) = c(x^+)$。这源于[热力学平衡](@entry_id:141660)，避免了无限大的[化学势梯度](@entry_id:142294)。
2.  **通量连续性**：$-D(x^-)\frac{dc}{dx}(x^-) = -D(x^+)\frac{dc}{dx}(x^+)$。这源于[质量守恒](@entry_id:204015)，即在界面上没有物质的产生或消失。

在[有限体积法](@entry_id:141374)中，为了精确地施加这些条件，一个有效的技巧是使用**[调和平均](@entry_id:750175)**（harmonic mean）来计算界面处的有效电导率或扩散率。例如，对于两个相邻的控制体 $i$ 和 $i+1$，它们的宽度分别为 $\Delta x_i$ 和 $\Delta x_{i+1}$，扩散系数分别为 $D_i$ 和 $D_{i+1}$，则它们之间的界面通量 $J_{i+1/2}$ 可以表示为：
$$
J_{i+1/2} = -G_{i+1/2} (c_{i+1} - c_i)
$$
其中，界面电导（conductance）$G_{i+1/2}$ 通过对两个半单元的“扩散电阻”求和再取倒数得到：
$$
G_{i+1/2} = \left( \frac{\Delta x_i/2}{D_i} + \frac{\Delta x_{i+1}/2}{D_{i+1}} \right)^{-1}
$$
这种形式的[调和平均](@entry_id:750175)确保了即使当 $D$ 发生突变时，数值计算的通量仍然是连续的。

这些原则同样适用于多物理场问题。在电极与隔膜的界面处 ：
-   **固相电势 $\phi_s$**：隔膜是电子绝缘体，因此电子电流不能流入隔膜。这表现为在电极一侧施加一个绝缘（诺伊曼）边界条件：$i_s = -\sigma_{\text{eff}} \frac{\partial \phi_s}{\partial x} = 0$。
-   **[电解质](@entry_id:261072)电势 $\phi_e$ 和浓度 $c_e$**：[电解质](@entry_id:261072)在整个电池中是连续的，因此电势和浓度必须跨界面连续。
-   **[电解质](@entry_id:261072)相电流 $i_e$ 和盐通量 $N_e$**：由于界面上没有电荷或盐的奇异源或汇，这两个通量也必须是连续的。

正确处理这些界面条件是构建准确的多域[电池模型](@entry_id:1121428)的基石。

### [Doyle-Fuller-Newman 模型](@entry_id:1123959)作为[微分](@entry_id:158422)代数系统

当我们将线方法应用于完整的 Doyle-Fuller-Newman（DFN）模型时，所得到的系统具有一种特殊的数学结构，即微分代数方程（DAE）系统。

#### [微分](@entry_id:158422)变量与代数变量的识别

一个变量是**[微分](@entry_id:158422)变量**还是**代数变量**，取决于其控制方程中是否包含时间导数项  。
-   **[微分](@entry_id:158422)变量**：固相浓度 $c_s$ 和[电解质](@entry_id:261072)浓度 $c_e$ 的控制方程是源于[质量守恒](@entry_id:204015)的[抛物型偏微分方程](@entry_id:168935)，形式为 $\frac{\partial c}{\partial t} = \dots$。经过[空间离散化](@entry_id:172158)后，这些方程会转化为关于节点浓度值向量 $\mathbf{c}_s(t)$ 和 $\mathbf{c}_e(t)$ 的常微分方程。因此，$c_s$ 和 $c_e$ 是系统的[微分](@entry_id:158422)变量。

-   **代数变量**：固相电势 $\phi_s$ 和[电解质](@entry_id:261072)电势 $\phi_e$ 的控制方程源于电荷守恒，在忽略双电层电容的[准静态近似](@entry_id:167818)下，其形式为 $\nabla \cdot \mathbf{i} = \dots$。这些方程中不包含 $\frac{\partial \phi}{\partial t}$ 项。它们是椭圆型[偏微分](@entry_id:194612)方程。[空间离散化](@entry_id:172158)后，它们会转化为一组在每个时刻都必须满足的[代数方程](@entry_id:272665)。因此，$\phi_s$ 和 $\phi_e$ 是系统的**代数变量**。同样，通过Butler-Volmer等动力学关系与电势和浓度耦合的反应电流密度 $j$ 也是一个代数变量。

因此，[DFN模型](@entry_id:1123629)的[半离散化](@entry_id:163562)形式可以写成一个标准的半显式[DAE系统](@entry_id:1123360)：
$$
\begin{align*}
\dot{\mathbf{y}}  = \mathbf{f}(\mathbf{y}, \mathbf{z}, t) \\
\mathbf{0}  = \mathbf{g}(\mathbf{y}, \mathbf{z}, t)
\end{align*}
$$
其中，$\mathbf{y} = [\mathbf{c}_s, \mathbf{c}_e]^T$ 是[微分](@entry_id:158422)变量向量，而 $\mathbf{z} = [\boldsymbol{\phi}_s, \boldsymbol{\phi}_e, \mathbf{j}]^T$ 是代数变量向量。

#### [DAE系统](@entry_id:1123360)的指数

[DAE系统](@entry_id:1123360)的**指数**（index）是一个衡量其“奇异”程度或隐式约束复杂度的整数。通俗地说，它表示为了将系统转化为一个显式的ODE，需要对代数[约束方程](@entry_id:138140) $\mathbf{g}$ 求多少次时间导数。

-   **指数-1 DAE**：如果代数约束关于代数变量的[雅可比矩阵](@entry_id:178326) $\frac{\partial \mathbf{g}}{\partial \mathbf{z}}$ 是非奇异的（即可逆的），那么该系统就是指数-1的。这意味着在任意时刻 $t$，给定[微分](@entry_id:158422)变量 $\mathbf{y}(t)$ 的值，原则上都可以从代数方程 $\mathbf{g}(\mathbf{y}(t), \mathbf{z}, t) = \mathbf{0}$ 中唯一地求解出代数变量 $\mathbf{z}(t)$。

在[DFN模型](@entry_id:1123629)中，[代数方程](@entry_id:272665)由电势的控制方程和动力学关系组成。这些方程在物理上是良态的，即对于给定的浓度分布，电势和电流的分布是唯一确定的（在一个“浮动电势”的[规范自由度](@entry_id:160491)被固定之后）。例如，通过将一个点的电势设为参考零点来**固定规范**（gauge fixing），就可以消除电势算子的零空间，使得代数系统的[雅可比矩阵](@entry_id:178326)变得可逆 。

由于我们不需要对代数约束进行[微分](@entry_id:158422)就能求解代数变量，标准的[DFN模型](@entry_id:1123629)在经过[半离散化](@entry_id:163562)后，是一个**指数-1 DAE**系统 。这个结论对于选择合适的数值求解器至关重要。

### 时域离散化：应对系统刚性

将PDE系统转化为[DAE系统](@entry_id:1123360)后，下一步是进行[时域积分](@entry_id:755982)。然而，[电池模型](@entry_id:1121428)的[DAE系统](@entry_id:1123360)通常具有一个极具挑战性的特性：**刚性**（stiffness）。

#### [电池模型](@entry_id:1121428)中刚性的来源

一个ODE或[DAE系统](@entry_id:1123360)被称为“刚性”的，是指其解的各个模式（或特征值）在时间尺度上存在巨大差异。对于[电池模型](@entry_id:1121428)，刚性主要来源于以下几个方面 ：

1.  **扩散算子**：如前所述，[扩散过程](@entry_id:268015)的空间离散化会产生一个刚度矩阵 $\mathbf{A}$。该矩阵的[特征值谱](@entry_id:1124216)非常宽。最小的特征值（绝对值）对应于宏观尺度上的缓慢[扩散过程](@entry_id:268015)（例如，整个颗粒的锂化/脱锂），其时间常数 $\tau_{\text{slow}} \sim L^2/D$。最大的特征值（绝对值）对应于网格尺度上的快速弛豫过程，其时间常数 $\tau_{\text{fast}} \sim h^2/D$，其中 $h$ 是网格尺寸。刚[性比](@entry_id:172643) $S = \tau_{\text{slow}} / \tau_{\text{fast}} \propto (L/h)^2$。当我们为了精度而细化网格（减小 $h$）时，刚性会急剧增加。

2.  **DAE结构**：代数约束可以被看作是具有无限快响应速度（零时间常数）的动力学过程。电[势场](@entry_id:143025)必须在每个瞬间都精确地满足[电荷守恒](@entry_id:264158)，这种瞬时调整是刚性的极端表现。

3.  **快速[反应动力学](@entry_id:150220)**：[Butler-Volmer动力学](@entry_id:1121961)中的指数项意味着，当过电势稍大时，电流密度会发生非常剧烈的变化。这种高度的[非线性](@entry_id:637147)也贡献了系统的刚性。

#### 隐式[时域积分](@entry_id:755982)方法

刚性系统的存在对[数值积分方法](@entry_id:141406)的稳定性提出了严苛的要求。对于**显式方法**（如[前向欧拉法](@entry_id:141238)），为了保持数值稳定，时间步长 $\Delta t$ 必须受限于系统最快的时间尺度，即 $\Delta t \le C \cdot \tau_{\text{fast}} \propto h^2$。这意味着，如果我们将空间[网格加密](@entry_id:168565)一倍，时间步长就必须缩减为原来的四分之一。对于[电池模拟](@entry_id:1121445)中感兴趣的分钟或小时级过程，这种限制将导致计算成本高到无法接受。

相比之下，**[隐式方法](@entry_id:138537)**（如[后向欧拉法](@entry_id:139674)或**[后向微分公式](@entry_id:144036)** BDF）具有更优的稳定性。例如，A-稳定（A-stable）的方法对于所有左半复平面（即具有负实部的特征值）的线性问题都是无条件稳定的。这意味着时间步长 $\Delta t$ 的选择可以仅仅基于求解慢速物理过程所需的精度，而无需担心快速、非物理模式导致的稳定性崩溃。

**[后向微分公式](@entry_id:144036)**（Backward Differentiation Formulas, BDF）是一类特别适用于求解刚性[DAE系统](@entry_id:1123360)的隐式[多步法](@entry_id:147097)。低阶（1-2阶）的[BDF方法](@entry_id:176038)是A-稳定的，而高阶（3-6阶）的[BDF方法](@entry_id:176038)虽然不是A-稳定的，但它们具有一个非常适合刚性问题的性质，即在负[实轴](@entry_id:148276)远端具有很强的阻尼效应（所谓的“无穷远处衰减”），能够有效地抑制来自扩散算子的高频伪影。因此，BDF是[自动化电池设计](@entry_id:1121262)和仿真软件中进行[时域积分](@entry_id:755982)的黄金标准 。

### 求解每一步的[非线性系统](@entry_id:168347)

选择[隐式积分](@entry_id:1126415)方法（如BDF）的代价是，在每个时间步，我们都需要求解一个大型的**[非线性](@entry_id:637147)[代数方程](@entry_id:272665)组**。以最简单的[隐式方法](@entry_id:138537)——[后向欧拉法](@entry_id:139674)为例，[DAE系统](@entry_id:1123360) $\dot{\mathbf{y}} = \mathbf{f}(\mathbf{y}, \mathbf{z}), \mathbf{0} = \mathbf{g}(\mathbf{y}, \mathbf{z})$ 在时间步 $t_n$ 处被离散为：
$$
\begin{align*}
\frac{\mathbf{y}_n - \mathbf{y}_{n-1}}{\Delta t} - \mathbf{f}(\mathbf{y}_n, \mathbf{z}_n)  = \mathbf{0} \\
\mathbf{g}(\mathbf{y}_n, \mathbf{z}_n)  = \mathbf{0}
\end{align*}
$$
这是一个关于当前时刻未知数 $\mathbf{u}_n = [\mathbf{y}_n, \mathbf{z}_n]^T$ 的非线性方程组，我们可以将其统一写为 $\mathbf{R}(\mathbf{u}_n) = \mathbf{0}$。

#### 全耦合[牛顿-拉弗森法](@entry_id:140620)

求解该[非线性](@entry_id:637147)残差方程 $\mathbf{R}(\mathbf{u}) = \mathbf{0}$ 的标准方法是**[牛顿-拉弗森法](@entry_id:140620)**（或简称[牛顿法](@entry_id:140116)）。该方法从一个初始猜测 $\mathbf{u}^{(k)}$ 开始，通过求解一个线性系统来迭代地计算修正量 $\Delta \mathbf{u}^{(k)}$：
$$
J(\mathbf{u}^{(k)}) \Delta \mathbf{u}^{(k)} = -\mathbf{R}(\mathbf{u}^{(k)})
$$
然后更新解：
$$
\mathbf{u}^{(k+1)} = \mathbf{u}^{(k)} + \Delta \mathbf{u}^{(k)}
$$
其中，$J(\mathbf{u}^{(k)}) = \frac{\partial \mathbf{R}}{\partial \mathbf{u}}|_{\mathbf{u}^{(k)}}$ 是[残差向量](@entry_id:165091)关于未知数向量的**[雅可比矩阵](@entry_id:178326)**。

#### [雅可比矩阵](@entry_id:178326)的结构与[稀疏性](@entry_id:136793)

[雅可比矩阵](@entry_id:178326) $J$ 的结构直接反映了模型中物理场之间的耦合关系 。如果我们按照物理场对未知数向量进行分块，例如 $\mathbf{u} = [\mathbf{c}_s, \mathbf{c}_e, \boldsymbol{\phi}_s, \boldsymbol{\phi}_e]^T$，那么[雅可比矩阵](@entry_id:178326)也相应地呈现出 $4 \times 4$ 的块结构：
$$
J = \begin{pmatrix}
J_{c_s, c_s}  J_{c_s, c_e}  J_{c_s, \phi_s}  J_{c_s, \phi_e} \\
J_{c_e, c_s}  J_{c_e, c_e}  J_{c_e, \phi_s}  J_{c_e, \phi_e} \\
J_{\phi_s, c_s}  J_{\phi_s, c_e}  J_{\phi_s, \phi_s}  J_{\phi_s, \phi_e} \\
J_{\phi_e, c_s}  J_{\phi_e, c_e}  J_{\phi_e, \phi_s}  J_{\phi_e, \phi_e}
\end{pmatrix}
$$
每个子块 $J_{i,j} = \frac{\partial \mathbf{R}_i}{\partial \mathbf{u}_j}$ 的稀疏模式由离散化模板和物理耦合的局部性决定。
-   **对角块**（如 $J_{c_e, c_e}$）：通常包含了来[自扩散](@entry_id:754665)项的三对角结构（对于一维问题），以及来自反应项的对角贡献。
-   **非对角块**（如 $J_{c_s, \phi_e}$）：描述了不同物理场之间的耦合。在[DFN模型](@entry_id:1123629)中，绝大多数耦合都通过局部的电化学反应项 $j$ 发生。例如，固相浓度方程的残差 $R_{c_s}$ 仅在颗粒表面处依赖于电势，因此 $J_{c_s, \phi_s}$ 和 $J_{c_s, \phi_e}$ 会非常稀疏，只在对应于[表面浓度](@entry_id:265418)的行中有非零元。

整个[雅可比矩阵](@entry_id:178326)是高度稀疏的。利用这种[稀疏性](@entry_id:136793)是高效求解[牛顿法](@entry_id:140116)[线性系统](@entry_id:147850)的关键。

#### 鲁棒收敛的[全局化策略](@entry_id:177837)

标准的[牛顿法](@entry_id:140116)仅在离真解足够近时才保证收敛。对于[电池模型](@entry_id:1121428)中源于 $\ln(c_e)$ 和 $\exp(\eta)$ 的强[非线性](@entry_id:637147)，从一个不好的初值（例如上一个时间步的解）开始，标准的[牛顿步长](@entry_id:177069)可能过大，导致发散或迭代到非物理的解（如负浓度）。为了确保从任意初值都能稳健地收敛，必须采用**[全局化策略](@entry_id:177837)** 。

常用的[全局化策略](@entry_id:177837)有两类：
1.  **[线搜索法](@entry_id:175906)**（Line Search Methods）：该方法在计算出牛顿方向 $\Delta \mathbf{u}^{(k)}$ 后，并不直接取完整的步长，而是寻找一个步长因子 $\alpha_k \in (0,1]$，使得新迭代点 $\mathbf{u}^{(k+1)} = \mathbf{u}^{(k)} + \alpha_k \Delta \mathbf{u}^{(k)}$ 能够在一个**价值函数**（merit function，通常是[残差范数](@entry_id:754273)的平方 $\phi(\mathbf{u}) = \frac{1}{2}||\mathbf{R}(\mathbf{u})||^2$）上实现充分下降。这可以防止迭代步长过大，并保证算法朝向解的方向前进。处理像 $c_e  0$ 这样的物理约束时，[线搜索](@entry_id:141607)还可以结合“边界分数”规则，缩短步长以避免跨越物理边界。

2.  **信赖域法**（Trust-Region Methods）：该方法在当前迭代点周围定义一个“信赖域”（通常是一个球体），并在这个区域内求解一个近似的子问题来获得下一步的位移。如果该步产生了预期的下降，则扩大信赖域；否则，缩小信赖域并重新求解。这种方法通过限制步长的大小来天然地抑制振荡和过大的步进，对于处理指数型[非线性](@entry_id:637147)尤其有效。Levenberg-Marquardt 方法就是信赖域法的一个著名特例。

在现代电池仿真软件中，鲁棒的[非线性求解器](@entry_id:177708)几乎总是包含这些[全局化策略](@entry_id:177837)中的一种。

### 建立一致的初始条件

任何瞬态仿真的第一步都是建立一个物理上和数学上都一致的初始状态 ($t=0$) 。对于一个处于开路静置状态的电池，这意味着系统处于热力学平衡状态，所有内部净电流和通量均为零。

为了构建一个一致的静置初始条件，我们必须满足以下所有约束：
1.  **零界面反应通量**：$j_n(x,0) = 0$。根据[Butler-Volmer方程](@entry_id:150187)，这等价于要求所有电极区域的过电势为零：$\eta(x,0) = 0$。
2.  **零过电势**：$\eta = \phi_s - \phi_e - U(c_s^{\text{surf}}) = 0$。这直接将固相和液相电势与颗粒[表面浓度](@entry_id:265418)联系起来：$\phi_s(x,0) - \phi_e(x,0) = U(c_s^{\text{surf}}(x,0))$。
3.  **零固相内部通量**：$j_n(x,0)=0$ 意味着颗粒表面没有锂的流入或流出。为了使颗粒内部处于平衡，必须没有内部浓度梯度，即 $c_s(r,x,0)$ 在每个颗粒内部关于[径向坐标](@entry_id:165186) $r$ 是均匀的。通常也假设在一个电极内的所有颗粒具有相同的初始状态，因此 $c_s$ 在每个电极内部是完全均匀的。
4.  **零[电解质](@entry_id:261072)通量**：在没有电流和反应的情况下，任何[电解质](@entry_id:261072)浓度梯度都会因扩散而消失。因此，在平衡状态下，$c_e(x,0)$ 必须在整个电池中（负极、隔膜、正极）是一个常数。
5.  **零相电流**：零总电流意味着固相电子电流 $i_s$ 和液相离子电流 $i_e$ 都必须处处为零。
    -   $i_s = -\sigma_{\text{eff}} \frac{\partial \phi_s}{\partial x} = 0 \implies \phi_s$ 在每个电极内部必须是常数。
    -   $i_e = -\kappa_{\text{eff}} \frac{\partial \phi_e}{\partial x} - (\dots)\frac{\partial \ln c_e}{\partial x} = 0$。由于 $c_e$ 是常数，第二项为零，因此 $\frac{\partial \phi_e}{\partial x} = 0 \implies \phi_e$ 在整个电池中必须是常数。

综上所述，一个一致的开路静置初始条件由以下状态定义：
-   $c_s(r,x,0)$ 在负极和正极内部各自为均匀常数。
-   $c_e(x,0)$ 在整个电池中为一个均匀常数。
-   $\phi_e(x,0)$ 在整个电池中为一个均匀常数。
-   $\phi_s(x,0)$ 在负极和正极内部各自为一个均匀常数，其值通过零过电势条件与 $\phi_e$ 和 $U(c_s)$ 关联。

任何偏离这个状态的初始设定都会在模拟开始的瞬间引入非物理的瞬态效应，甚至导致数值求解失败。