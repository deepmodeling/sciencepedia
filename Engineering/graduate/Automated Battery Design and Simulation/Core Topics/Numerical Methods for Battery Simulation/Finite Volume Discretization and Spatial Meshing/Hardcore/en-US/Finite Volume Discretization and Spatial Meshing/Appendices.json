{
    "hands_on_practices": [
        {
            "introduction": "The finite volume method is built on the principle of local conservation, which makes it particularly robust for simulating physical transport phenomena. This exercise guides you through the foundational derivation of a semi-discrete FVM scheme for a diffusion problem, starting from the integral form of the conservation law. By demonstrating that the sum of local changes is determined only by boundary fluxes, you will solidify your understanding of why FVM is inherently conservative, a crucial property for accurate battery simulations .",
            "id": "3914775",
            "problem": "Consider a one-dimensional lithium-ion battery half-cell electrolyte domain of thickness $L$ and uniform cross-sectional area $A$, with spatial coordinate $x \\in [0, L]$. The electrolyte volume fraction (porosity) is spatially constant and equal to $\\varepsilon$. The electrolyte concentration $c(x,t)$ evolves according to the conservation of mass and Fickian diffusion at the macroscale, with the flux obeying Fick’s law. Specifically, the governing Partial Differential Equation (PDE) and constitutive relation are\n$$\n\\frac{\\partial}{\\partial t}\\left(\\varepsilon\\,c(x,t)\\right) + \\frac{\\partial}{\\partial x} J(x,t) \\;=\\; 0,\n\\qquad\nJ(x,t) \\;=\\; -D\\,\\frac{\\partial c}{\\partial x}(x,t),\n$$\nwhere $D$ is a constant effective diffusivity, and there are no volumetric sources or sinks. This half-cell is part of a larger automated battery design and simulation workflow, and the spatial discretization must preserve conservation under mesh refinement.\n\nDiscretize the domain by the Finite Volume Method (FVM) into $N$ nonuniform control volumes with cell centers $\\{x_i\\}_{i=1}^N$ and widths $\\{\\Delta x_i\\}_{i=1}^N$ such that $\\sum_{i=1}^N \\Delta x_i = L$. Denote the cell-averaged concentration in cell $i$ by $c_i(t)$, and let the interface between cells $i$ and $i+1$ be located at $x_{i+1/2}$, with geometric half-spacing $\\delta_{i+1/2} = \\frac{\\Delta x_i}{2} + \\frac{\\Delta x_{i+1}}{2}$. Adopt the standard two-point flux approximation at interior interfaces,\n$$\nJ_{i+1/2}(t) \\;=\\; -D\\,\\frac{c_{i+1}(t) - c_i(t)}{\\delta_{i+1/2}},\n$$\nand assume general boundary fluxes $J_{1/2}(t)$ at $x=0$ and $J_{N+1/2}(t)$ at $x=L$ (taken positive in the $+x$ direction). Starting from the integral form of conservation over each control volume and using the Divergence Theorem, derive the semi-discrete ordinary differential equation (ODE) for $c_i(t)$ in cell $i$, expressed in terms of the neighboring numerical fluxes. Then, sum the semi-discrete equations over all $i \\in \\{1,\\dots,N\\}$ to show that the discrete scheme preserves global conservation up to boundary fluxes, and obtain the compact expression for the net rate of change of the total electrolyte moles contained in the half-cell in terms of the boundary fluxes only.\n\nYour final reported quantity must be the compact expression for the net rate of change of the total electrolyte moles contained in the half-cell, expressed in units of $\\mathrm{mol}\\,\\mathrm{s}^{-1}$. No numerical evaluation is required. Provide no intermediate equalities in the final answer; report only the final expression.",
            "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded, well-posed, and objective. It represents a standard derivation in the field of numerical methods for partial differential equations, specifically for demonstrating the conservation property of a finite volume scheme.\n\nThe derivation proceeds as follows.\n\nFirst, we establish the integral form of the conservation law. The governing partial differential equation (PDE) for the electrolyte concentration $c(x,t)$ is given as:\n$$\n\\frac{\\partial}{\\partial t}\\left(\\varepsilon\\,c(x,t)\\right) + \\frac{\\partial}{\\partial x} J(x,t) = 0\n$$\nwhere $\\varepsilon$ is the constant porosity, $c$ is the concentration, and $J$ is the molar flux. The Finite Volume Method (FVM) is based on satisfying this conservation law in an integral sense over each control volume. We integrate the PDE over an arbitrary control volume $i$, which is defined by the interval $[x_{i-1/2}, x_{i+1/2}]$ with width $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$.\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\frac{\\partial}{\\partial t}(\\varepsilon c) \\right) dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\frac{\\partial J}{\\partial x} \\right) dx = 0\n$$\nThe integral of a quantity over a control volume is a fundamental step in FVM.\n\nNext, we evaluate the two integral terms. For the time-derivative term, we can interchange the differentiation and integration operators (Leibniz integral rule) since the integration limits are fixed in time. Further, since $\\varepsilon$ is a constant, it can be factored out.\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial}{\\partial t}(\\varepsilon c) \\, dx = \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\varepsilon c \\, dx = \\varepsilon \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} c \\, dx\n$$\nThe problem defines the cell-averaged concentration in cell $i$ as $c_i(t)$. This quantity represents the average value of the continuous concentration $c(x,t)$ over the control volume $i$:\n$$\nc_i(t) = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} c(x,t) \\, dx\n$$\nSubstituting this definition, the time-derivative term becomes:\n$$\n\\varepsilon \\frac{d}{dt} \\left( \\Delta x_i c_i(t) \\right) = \\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt}\n$$\nwhere we have used the fact that the cell width $\\Delta x_i$ is constant in time.\n\nFor the spatial-derivative term, we apply the Fundamental Theorem of Calculus, which is the one-dimensional form of the Divergence Theorem:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial J}{\\partial x} \\, dx = J(x_{i+1/2}, t) - J(x_{i-1/2}, t)\n$$\nThis term represents the net flux out of the control volume $i$ through its boundaries at $x_{i-1/2}$ and $x_{i+1/2}$.\n\nCombining these results, we obtain the exact integral balance for the cell-averaged concentration:\n$$\n\\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} + J(x_{i+1/2}, t) - J(x_{i-1/2}, t) = 0\n$$\nTo obtain the semi-discrete FVM equation, we replace the exact, continuous fluxes at the interfaces, $J(x_{i\\pm1/2}, t)$, with their numerical approximations, denoted as $J_{i\\pm1/2}(t)$. This yields the semi-discrete ordinary differential equation (ODE) for the evolution of $c_i(t)$:\n$$\n\\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} = J_{i-1/2}(t) - J_{i+1/2}(t)\n$$\nThis equation is the first required result. It expresses the rate of change of the species amount in control volume $i$ as the balance of numerical fluxes entering and leaving the volume. The specific form of the flux, $J_{i+1/2} = -D(c_{i+1} - c_i)/\\delta_{i+1/2}$, ensures that the flux leaving cell $i$ is identical to the flux entering cell $i+1$, a property essential for local conservation.\n\nThe next task is to demonstrate global conservation. The total number of moles of the electrolyte species in the entire domain, $M_{total}(t)$, is the sum of the moles in each of the $N$ control volumes. The volume of the electrolyte in cell $i$ is $\\varepsilon A \\Delta x_i$. Thus, the total moles are:\n$$\nM_{total}(t) = \\sum_{i=1}^{N} c_i(t) (\\varepsilon A \\Delta x_i)\n$$\nTo find the net rate of change of the total moles, we differentiate this expression with respect to time. Since $\\varepsilon$, $A$, and $\\Delta x_i$ are constants:\n$$\n\\frac{d M_{total}}{dt} = \\frac{d}{dt} \\left( \\sum_{i=1}^{N} \\varepsilon A \\Delta x_i c_i(t) \\right) = A \\sum_{i=1}^{N} \\left( \\varepsilon \\Delta x_i \\frac{d c_i(t)}{dt} \\right)\n$$\nWe now substitute the semi-discrete ODE derived previously into this summation:\n$$\n\\frac{d M_{total}}{dt} = A \\sum_{i=1}^{N} \\left( J_{i-1/2}(t) - J_{i+1/2}(t) \\right)\n$$\nThe sum on the right-hand side is a telescoping series:\n$$\n\\sum_{i=1}^{N} (J_{i-1/2} - J_{i+1/2}) = (J_{1/2} - J_{3/2}) + (J_{3/2} - J_{5/2}) + \\dots + (J_{N-1/2} - J_{N+1/2})\n$$\nIn this series, all interior fluxes cancel out. For example, the flux leaving cell $i$, $-J_{i+1/2}$, cancels with the flux entering cell $i+1$, $+J_{(i+1)-1/2} = +J_{i+1/2}$. The only terms that remain are the fluxes at the external boundaries of the domain: the flux at the left boundary of the first cell ($i=1$), $J_{1/2}$, and the flux at the right boundary of the last cell ($i=N$), $J_{N+1/2}$.\n$$\n\\sum_{i=1}^{N} (J_{i-1/2} - J_{i+1/2}) = J_{1/2}(t) - J_{N+1/2}(t)\n$$\nThis result shows that the change in the total amount of the conserved quantity within the entire domain is determined solely by the fluxes across the domain's external boundaries. This is the definition of a discretely conservative scheme.\n\nFinally, we write the compact expression for the net rate of change of the total electrolyte moles contained in the half-cell. This is the final result of the summation:\n$$\n\\frac{d M_{total}}{dt} = A \\left( J_{1/2}(t) - J_{N+1/2}(t) \\right)\n$$\nThe flux $J$ has units of $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and the area $A$ has units of $\\mathrm{m}^2$. Therefore, the expression $A(J_{1/2} - J_{N+1/2})$ has units of $\\mathrm{mol}\\,\\mathrm{s}^{-1}$, which is the correct unit for the rate of change of moles. The expression represents the total molar flow rate into the domain at $x=0$ minus the total molar flow rate out of the domain at $x=L$.",
            "answer": "$$\n\\boxed{A \\left( J_{1/2} - J_{N+1/2} \\right)}\n$$"
        },
        {
            "introduction": "Writing a simulation code is only the first step; verifying its correctness is paramount to ensure the reliability of its predictions. This practice introduces the Method of Manufactured Solutions (MMS), a rigorous and general technique for code verification, applied here to a coupled diffusion-reaction system common in battery models. By prescribing an exact analytical solution and deriving the corresponding source terms, you will learn how to create a definitive test case that your FVM code must solve to a high degree of accuracy, providing confidence in your implementation of the discretized operators .",
            "id": "3914764",
            "problem": "In automated battery design and simulation, a coupled diffusive-transport and charge-conservation system in a porous electrode subdomain is often solved using the finite volume method (FVM). To verify a code’s spatial meshing and FVM implementation independent of geometry and mesh skewness, one can employ the method of manufactured solutions by prescribing smooth fields that exactly satisfy the governing equations with appropriately chosen source terms. Consider the following dimensionless coupled partial differential equations posed on the unit square domain $\\Omega = [0,1] \\times [0,1]$:\n$$\n-\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c = S_{\\phi}(x,y), \\quad (x,y) \\in \\Omega,\n$$\n$$\n-\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\, \\phi = S_{c}(x,y), \\quad (x,y) \\in \\Omega,\n$$\nwhere $\\phi(x,y)$ is the dimensionless electrolyte potential, $c(x,y)$ is the dimensionless solute concentration, $\\kappa>0$ and $D>0$ are constant dimensionless transport coefficients, and $\\beta$ and $\\gamma$ are constant coupling parameters embodying linearized reaction terms. In a finite volume method (FVM), fluxes are integrated over control-volume faces and sources are integrated over cell volumes; thus, known volumetric sources $S_{\\phi}$ and $S_{c}$ support rigorous code verification on arbitrary spatial meshes via the method of manufactured solutions.\n\nSelect smooth manufactured fields that are twice continuously differentiable on $\\Omega$,\n$$\n\\phi(x,y) = \\sin(\\pi x)\\,\\cos(\\pi y), \\qquad c(x,y) = \\cos(\\pi x)\\,\\sin(\\pi y),\n$$\nand define boundary conditions by restricting these fields to $\\partial \\Omega$ so that the manufactured fields are the exact solution. Using only fundamental conservation statements for charge and mass together with Fick’s and Ohm’s linear laws in their dimensionless forms (i.e., diffusive fluxes proportional to gradients and sources representing volumetric production/consumption), derive the source terms $S_{\\phi}(x,y)$ and $S_{c}(x,y)$ such that the above equations are satisfied identically for all $(x,y) \\in \\Omega$.\n\nTo obtain a mesh-independent scalar diagnostic suitable for FVM code verification on arbitrary spatial meshes, define the functional\n$$\nJ \\;=\\; \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nProvide $J$ in closed form as a function of $\\kappa$, $D$, $\\beta$, and $\\gamma$. Your final answer must be this single, closed-form analytic expression. Do not include units in your final answer.",
            "solution": "The user wants me to solve a problem based on the method of manufactured solutions in computational physics.\n\n### Step 1: Extract Givens\n-   **Domain**: $\\Omega = [0,1] \\times [0,1]$.\n-   **Governing Equations**:\n    -   $-\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c = S_{\\phi}(x,y)$\n    -   $-\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\, \\phi = S_{c}(x,y)$\n-   **Variables and Fields**:\n    -   $\\phi(x,y)$: dimensionless electrolyte potential.\n    -   $c(x,y)$: dimensionless solute concentration.\n    -   $S_{\\phi}(x,y), S_{c}(x,y)$: volumetric source terms.\n-   **Constants**:\n    -   $\\kappa>0$: constant dimensionless transport coefficient.\n    -   $D>0$: constant dimensionless transport coefficient.\n    -   $\\beta, \\gamma$: constant coupling parameters.\n-   **Manufactured Solutions**:\n    -   $\\phi(x,y) = \\sin(\\pi x)\\,\\cos(\\pi y)$\n    -   $c(x,y) = \\cos(\\pi x)\\,\\sin(\\pi y)$\n-   **Functional to be calculated**:\n    -   $J = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a rigorous validation process.\n\n-   **Scientific Grounding**: The problem is well-grounded in the principles of continuum mechanics and numerical analysis. The governing equations represent a linearized, steady-state reaction-diffusion system, which is a common model for coupled transport phenomena in fields like electrochemistry. The Method of Manufactured Solutions is a standard, respected technique for verifying the correctness of numerical code implementations. The setup is scientifically and mathematically sound.\n-   **Well-Posedness**: The problem is well-posed. It does not ask to solve the PDEs for unknown fields, but rather to derive the source terms that are required to satisfy the equations for given, specified fields. This is a direct calculation involving differentiation and substitution. The subsequent task of evaluating a definite integral of these derived source terms is also a well-defined mathematical problem. The provided fields are twice continuously differentiable ($C^{\\infty}$) on the domain, ensuring all required derivatives exist and are continuous.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language. There are no subjective or ambiguous terms.\n-   **Consistency and Completeness**: The problem is self-contained. All necessary equations, fields, and constants are provided to derive the source terms and compute the functional $J$. The definition of boundary conditions as restrictions of the manufactured solution is a standard and complete specification within the context of MMS.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard exercise in vector calculus applied to the verification of numerical methods for partial differential equations. The solution process will now proceed.\n\n### Derivation of Source Terms\n\nThe primary task is to find the source terms $S_{\\phi}(x,y)$ and $S_{c}(x,y)$ that identically satisfy the governing equations for the given manufactured solutions $\\phi(x,y)$ and $c(x,y)$.\n\nFor the first equation, concerning the potential $\\phi$:\n$$\nS_{\\phi}(x,y) = -\\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) + \\beta \\, c\n$$\nSince $\\kappa$ is a constant, the divergence term simplifies to $-\\kappa \\nabla \\cdot (\\nabla \\phi) = -\\kappa \\nabla^2 \\phi$, where $\\nabla^2$ is the Laplace operator.\n$$\nS_{\\phi}(x,y) = -\\kappa \\nabla^2 \\phi + \\beta \\, c\n$$\nWe compute the Laplacian of the manufactured solution $\\phi(x,y) = \\sin(\\pi x)\\cos(\\pi y)$.\nFirst, we find the partial derivatives with respect to $x$:\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sin(\\pi x)\\cos(\\pi y) \\right) = \\pi \\cos(\\pi x)\\cos(\\pi y)\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\pi \\cos(\\pi x)\\cos(\\pi y) \\right) = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\nNext, the partial derivatives with respect to $y$:\n$$\n\\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sin(\\pi x)\\cos(\\pi y) \\right) = -\\pi \\sin(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left( -\\pi \\sin(\\pi x)\\sin(\\pi y) \\right) = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\nThe Laplacian is the sum of the second partial derivatives:\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\cos(\\pi y) - \\pi^2 \\sin(\\pi x)\\cos(\\pi y) = -2\\pi^2 \\sin(\\pi x)\\cos(\\pi y)\n$$\nRecognizing that $\\phi(x,y) = \\sin(\\pi x)\\cos(\\pi y)$, we have $\\nabla^2 \\phi = -2\\pi^2 \\phi$.\nSubstituting this back into the expression for $S_{\\phi}$:\n$$\nS_{\\phi}(x,y) = -\\kappa (-2\\pi^2 \\phi) + \\beta c = 2\\pi^2 \\kappa \\phi + \\beta c\n$$\nExpressing this in terms of $x$ and $y$:\n$$\nS_{\\phi}(x,y) = 2\\pi^2 \\kappa \\sin(\\pi x)\\cos(\\pi y) + \\beta \\cos(\\pi x)\\sin(\\pi y)\n$$\n\nSimilarly, for the second equation, concerning the concentration $c$:\n$$\nS_{c}(x,y) = -\\nabla \\cdot \\left( D \\nabla c \\right) - \\gamma \\phi\n$$\nSince $D$ is a constant, this simplifies to:\n$$\nS_{c}(x,y) = -D \\nabla^2 c - \\gamma \\phi\n$$\nWe compute the Laplacian of the manufactured solution $c(x,y) = \\cos(\\pi x)\\sin(\\pi y)$.\nThe partial derivatives with respect to $x$:\n$$\n\\frac{\\partial c}{\\partial x} = -\\pi \\sin(\\pi x)\\sin(\\pi y), \\qquad \\frac{\\partial^2 c}{\\partial x^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\nThe partial derivatives with respect to $y$:\n$$\n\\frac{\\partial c}{\\partial y} = \\pi \\cos(\\pi x)\\cos(\\pi y), \\qquad \\frac{\\partial^2 c}{\\partial y^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\nThe Laplacian of $c$ is:\n$$\n\\nabla^2 c = \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial y^2} = -\\pi^2 \\cos(\\pi x)\\sin(\\pi y) - \\pi^2 \\cos(\\pi x)\\sin(\\pi y) = -2\\pi^2 \\cos(\\pi x)\\sin(\\pi y)\n$$\nRecognizing that $c(x,y) = \\cos(\\pi x)\\sin(\\pi y)$, we have $\\nabla^2 c = -2\\pi^2 c$.\nSubstituting this back into the expression for $S_{c}$:\n$$\nS_{c}(x,y) = -D (-2\\pi^2 c) - \\gamma \\phi = 2\\pi^2 D c - \\gamma \\phi\n$$\nExpressing this in terms of $x$ and $y$:\n$$\nS_{c}(x,y) = 2\\pi^2 D \\cos(\\pi x)\\sin(\\pi y) - \\gamma \\sin(\\pi x)\\cos(\\pi y)\n$$\n\n### Calculation of the Functional $J$\n\nNow we must compute the integral $J$:\n$$\nJ = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\left( S_{\\phi}(x,y)^{2} + S_{c}(x,y)^{2} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nLet's analyze the integrand $S_{\\phi}^{2} + S_{c}^{2}$.\n$$\nS_{\\phi}^{2} = \\left( 2\\pi^2 \\kappa \\phi + \\beta c \\right)^2 = (2\\pi^2 \\kappa)^2 \\phi^2 + \\beta^2 c^2 + 2(2\\pi^2 \\kappa)\\beta \\phi c\n$$\n$$\nS_{c}^{2} = \\left( 2\\pi^2 D c - \\gamma \\phi \\right)^2 = (2\\pi^2 D)^2 c^2 + \\gamma^2 \\phi^2 - 2(2\\pi^2 D)\\gamma \\phi c\n$$\nSumming them gives:\n$$\nS_{\\phi}^{2} + S_{c}^{2} = \\left( (2\\pi^2\\kappa)^2 + \\gamma^2 \\right)\\phi^2 + \\left( \\beta^2 + (2\\pi^2 D)^2 \\right)c^2 + \\left( 4\\pi^2\\kappa\\beta - 4\\pi^2 D\\gamma \\right)\\phi c\n$$\nThe integral $J$ becomes:\n$$\nJ = \\left( 4\\pi^4\\kappa^2 + \\gamma^2 \\right) \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y + \\left( \\beta^2 + 4\\pi^4 D^2 \\right) \\int_{0}^{1}\\!\\!\\int_{0}^{1} c^2 \\,\\mathrm{d}x\\mathrm{d}y + 4\\pi^2(\\kappa\\beta - D\\gamma) \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y\n$$\nWe need to evaluate three double integrals.\n$1$. Integral of $\\phi^2$:\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\sin^2(\\pi x)\\cos^2(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\int_{0}^{1} \\sin^2(\\pi x) \\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\cos^2(\\pi y) \\,\\mathrm{d}y\\right)\n$$\nUsing the identity $\\int_0^1 \\sin^2(\\pi u)\\,\\mathrm{d}u = \\int_0^1 \\frac{1-\\cos(2\\pi u)}{2}\\,\\mathrm{d}u = \\left[\\frac{u}{2} - \\frac{\\sin(2\\pi u)}{4\\pi}\\right]_0^1 = \\frac{1}{2}$, and similarly $\\int_0^1 \\cos^2(\\pi u)\\,\\mathrm{d}u = \\frac{1}{2}$.\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi^2 \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n$2$. Integral of $c^2$:\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} c^2 \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\cos^2(\\pi x)\\sin^2(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y = \\left(\\int_{0}^{1} \\cos^2(\\pi x) \\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\sin^2(\\pi y) \\,\\mathrm{d}y\\right) = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n$3$. Integral of the cross-term $\\phi c$:\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\sin(\\pi x)\\cos(\\pi y) \\cos(\\pi x)\\sin(\\pi y) \\,\\mathrm{d}x\\mathrm{d}y\n$$\n$$\n= \\left(\\int_{0}^{1} \\sin(\\pi x)\\cos(\\pi x)\\,\\mathrm{d}x\\right) \\left(\\int_{0}^{1} \\cos(\\pi y)\\sin(\\pi y)\\,\\mathrm{d}y\\right)\n$$\nUsing the identity $\\int_0^1 \\sin(\\pi u)\\cos(\\pi u)\\,\\mathrm{d}u = \\int_0^1 \\frac{1}{2}\\sin(2\\pi u)\\,\\mathrm{d}u = \\left[-\\frac{\\cos(2\\pi u)}{4\\pi}\\right]_0^1 = -\\frac{1}{4\\pi}(\\cos(2\\pi)-\\cos(0)) = 0$.\n$$\n\\int_{0}^{1}\\!\\!\\int_{0}^{1} \\phi c \\,\\mathrm{d}x\\mathrm{d}y = (0)(0) = 0\n$$\nThe orthogonality of the functions $\\phi$ and $c$ over the domain $\\Omega$ greatly simplifies the calculation. Substituting these integral values back into the expression for $J$:\n$$\nJ = \\left( 4\\pi^4\\kappa^2 + \\gamma^2 \\right) \\left(\\frac{1}{4}\\right) + \\left( \\beta^2 + 4\\pi^4 D^2 \\right) \\left(\\frac{1}{4}\\right) + 4\\pi^2(\\kappa\\beta - D\\gamma) (0)\n$$\n$$\nJ = \\frac{1}{4} \\left( 4\\pi^4\\kappa^2 + \\gamma^2 + \\beta^2 + 4\\pi^4 D^2 \\right)\n$$\nRearranging the terms to group common factors:\n$$\nJ = \\frac{1}{4} \\left( 4\\pi^4(\\kappa^2 + D^2) + (\\beta^2 + \\gamma^2) \\right) = \\pi^4(\\kappa^2 + D^2) + \\frac{1}{4}(\\beta^2 + \\gamma^2)\n$$\nThis is the final closed-form expression for the functional $J$.",
            "answer": "$$\n\\boxed{\\pi^{4}(\\kappa^{2} + D^{2}) + \\frac{1}{4}(\\beta^{2} + \\gamma^{2})}\n$$"
        },
        {
            "introduction": "Every numerical simulation contains discretization error, and a responsible computational scientist must quantify this uncertainty. This exercise introduces a standard procedure for a posteriori error estimation using Richardson extrapolation and the Grid Convergence Index (GCI). By analyzing results from a sequence of systematically refined meshes, you will learn to calculate the observed order of accuracy $p$ of your method and establish a credible error band for your simulation results, a critical step in verification and validation .",
            "id": "3914785",
            "problem": "A lithium-ion battery (LIB) electrolyte concentration field is computed in a one-dimensional domain using the Finite Volume Method (FVM). The governing base for the species is a conservation principle stating that the rate of change of the conserved quantity equals net flux divergence plus sources, which in differential form is a Partial Differential Equation (PDE). For steady operation at a fixed probe location, the numerical discretization error of a consistent FVM scheme in the asymptotic range is assumed to behave as a leading-order power of the characteristic mesh spacing. Specifically, let the mesh spacings be $h_1$, $h_2$, and $h_3$ for the fine, medium, and coarse meshes, respectively, with a common refinement ratio $r$ defined by $r = h_2 / h_1 = h_3 / h_2$ and $r &gt; 1$. Assume the numerical solution for electrolyte concentration $c$ at a fixed probe location satisfies an asymptotic error model $c(h) = c^\\ast + C h^p + \\mathcal{O}(h^{p+1})$, where $c^\\ast$ is the continuum-limit solution, $C$ is a constant independent of $h$, and $p$ is the observed order of accuracy.\n\nYour task is to derive, from these assumptions, how to determine the observed order of accuracy $p$ using Richardson extrapolation with three successively refined meshes, to compute the continuum-extrapolated concentration $c^\\ast$ at the probe, and to compute the Grid Convergence Index (GCI) for the fine grid. The Grid Convergence Index (GCI) must be reported as a decimal fraction (not a percentage). Use a safety factor of $F_s = 1.25$ for all test cases.\n\nThe program must implement the derivation in a way that is applicable to any modern programming language and must produce numerical answers for a given test suite. Treat the following input data as the computed electrolyte concentration values at the same probe location for three meshes and the refinement ratio $r$:\n\n- Test case $1$ (happy path, clear second-order behavior): $c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_2 = 995.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_3 = 975.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $r = 2.0$.\n- Test case $2$ (boundary case with $r$ close to $1$): $c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_2 = 990.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_3 = 977.9$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $r = 1.1$.\n- Test case $3$ (edge case, non-monotonic sequence): $c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_2 = 1002.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_3 = 998.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $r = 2.0$.\n- Test case $4$ (high refinement ratio): $c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_2 = 997.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_3 = 988.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $r = 3.0$.\n- Test case $5$ (non-integer refinement ratio, fractional order): $c_1 = 1000.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_2 = 992.0$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $c_3 = 977.304$ $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $r = 1.5$.\n\nFor each test case, compute:\n- The observed order of accuracy $p$.\n- The continuum-extrapolated probe concentration $c^\\ast$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- The fine-grid Grid Convergence Index $\\mathrm{GCI}_{21}$ as a decimal fraction (unitless).\n- A boolean flag indicating whether the sequence is asymptotic and monotonic, defined by the conditions $r > 1$, $\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$, and $(c_1 - c_2)$ and $(c_2 - c_3)$ having the same sign.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $[p, c^\\ast, \\mathrm{GCI}_{21}, \\mathrm{is\\_asymptotic}]$. For example, the output format is $[[p_1, c^\\ast_1, \\mathrm{GCI}_{21,1}, \\mathrm{is\\_asymptotic}_1],[p_2, c^\\ast_2, \\mathrm{GCI}_{21,2}, \\mathrm{is\\_asymptotic}_2],\\ldots]$. All reported $c^\\ast$ must be in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. All GCI values must be decimal fractions.",
            "solution": "The problem requires the derivation and application of formulas for grid convergence analysis based on the principles of Richardson extrapolation. The analysis will be performed on numerical solutions for electrolyte concentration in a lithium-ion battery simulation.\n\n**Problem Validation**\n\nFirst, I shall validate the problem statement.\n\n**Step 1: Extracted Givens**\n- **Physical Context:** A one-dimensional Finite Volume Method (FVM) simulation for a lithium-ion battery (LIB) electrolyte concentration field.\n- **Error Model:** The numerical solution $c$ for concentration at a fixed point is assumed to follow an asymptotic error model: $c(h) = c^\\ast + C h^p + \\mathcal{O}(h^{p+1})$, where $c^\\ast$ is the continuum-limit solution, $C$ is a constant, $h$ is the characteristic mesh spacing, and $p$ is the observed order of accuracy.\n- **Mesh Hierarchy:** Three successively refined meshes are used: fine (spacing $h_1$, solution $c_1$), medium (spacing $h_2$, solution $c_2$), and coarse (spacing $h_3$, solution $c_3$).\n- **Refinement Ratio:** A constant refinement ratio $r$ is used, defined as $r = h_2 / h_1 = h_3 / h_2$ with $r > 1$. This implies $h_2 = r h_1$ and $h_3 = r^2 h_1$.\n- **GCI Safety Factor:** A safety factor of $F_s = 1.25$ is specified for the Grid Convergence Index (GCI) calculation.\n- **Asymptotic/Monotonic Check:** A sequence is considered to be in the asymptotic monotonic convergence range if $r > 1$, $\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$, and $(c_1 - c_2)$ and $(c_2 - c_3)$ have the same sign.\n- **Input Data:** Five test cases are provided, each with values for $c_1$, $c_2$, $c_3$, and $r$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, as it concerns the standard and widely accepted Grid Convergence Index (GCI) methodology, a cornerstone of verification and validation in computational science. The problem is well-posed, providing all necessary data and a clear, unambiguous theoretical model ($c(h) = c^\\ast + C h^p$) from which the required quantities can be uniquely derived. The language is objective and formal. The problem does not violate any of the specified invalidity criteria; it is a standard exercise in numerical methods.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A full, reasoned solution follows.\n\n**Derivation of Grid Convergence Quantities**\n\nLet us begin from the asymptotic error model, neglecting the higher-order terms for the three grids:\n$c_1 \\approx c^\\ast + C h_1^p$  (1)\n$c_2 \\approx c^\\ast + C h_2^p = c^\\ast + C (r h_1)^p = c^\\ast + C r^p h_1^p$  (2)\n$c_3 \\approx c^\\ast + C h_3^p = c^\\ast + C (r^2 h_1)^p = c^\\ast + C r^{2p} h_1^p$  (3)\n\n**1. Derivation of the Observed Order of Accuracy ($p$)**\nTo find $p$, we must eliminate the unknown constants $c^\\ast$ and $C$. This can be accomplished by examining the differences between the solutions on successive grids.\nLet $\\epsilon_{21} = c_2 - c_1$ and $\\epsilon_{32} = c_3 - c_2$.\nFrom equations (1) and (2):\n$\\epsilon_{21} = c_2 - c_1 \\approx (c^\\ast + C r^p h_1^p) - (c^\\ast + C h_1^p) = C h_1^p (r^p - 1)$  (4)\nFrom equations (2) and (3):\n$\\epsilon_{32} = c_3 - c_2 \\approx (c^\\ast + C r^{2p} h_1^p) - (c^\\ast + C r^p h_1^p) = C h_1^p (r^{2p} - r^p) = C r^p h_1^p (r^p - 1)$  (5)\nNow, we take the ratio of these two differences to eliminate $C$, $h_1$, and the term $(r^p - 1)$:\n$$ \\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{c_3 - c_2}{c_2 - c_1} \\approx \\frac{C r^p h_1^p (r^p - 1)}{C h_1^p (r^p - 1)} = r^p $$\nThis relationship holds if the convergence is monotonic. To handle cases of oscillatory convergence, where the ratio may be negative, we use the absolute value. Solving for $p$:\n$$ r^p = \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| $$\nTaking the natural logarithm of both sides yields:\n$$ p \\ln(r) = \\ln\\left( \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| \\right) $$\nThus, the observed order of accuracy is:\n$$ p = \\frac{\\ln\\left( \\left| \\frac{c_3 - c_2}{c_2 - c_1} \\right| \\right)}{\\ln(r)} $$\n\n**2. Derivation of the Continuum-Extrapolated Solution ($c^\\ast$)**\nThis procedure, known as Richardson extrapolation, uses the solutions from two grids and the determined order of accuracy $p$ to estimate the solution at zero grid spacing ($h=0$). Using equations (1) and (2):\n$c_1 = c^\\ast + C h_1^p$\n$c_2 = c^\\ast + C r^p h_1^p$\nTo eliminate the error term $C h_1^p$, we can multiply the first equation by $r^p$ and subtract the second equation:\n$r^p c_1 = r^p c^\\ast + r^p C h_1^p$\n$c_2 = c^\\ast + C r^p h_1^p$\nSubtracting the second from the first gives:\n$r^p c_1 - c_2 = (r^p - 1) c^\\ast$\nSolving for the continuum-extrapolated concentration $c^\\ast$:\n$$ c^\\ast = \\frac{r^p c_1 - c_2}{r^p - 1} $$\nAn alternative, but equivalent, form often used is:\n$$ c^\\ast = c_1 + \\frac{c_1 - c_2}{r^p - 1} $$\n\n**3. Derivation of the Fine-Grid Convergence Index ($\\mathrm{GCI}_{21}$)**\nThe Grid Convergence Index (GCI) provides a conservative estimate of the discretization error in the numerical solution on a given grid. For the fine grid (using solutions from grids 1 and 2), the $\\mathrm{GCI}_{21}$ is defined based on an estimate of the relative error, scaled by a factor of safety $F_s$.\nThe true error in the fine-grid solution is $E_1 = c_1 - c^\\ast$. Using our expression for $c^\\ast$:\n$E_1 = c_1 - \\left( c_1 + \\frac{c_1 - c_2}{r^p - 1} \\right) = - \\frac{c_1 - c_2}{r^p - 1} = \\frac{c_2 - c_1}{r^p - 1}$\nThe GCI methodology approximates this error. The approximate relative error, $e_a$, between the fine and medium grids is defined as:\n$$ e_a^{21} = \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\nThe fine-grid GCI, $\\mathrm{GCI}_{21}$, is then calculated by scaling this relative difference:\n$$ \\mathrm{GCI}_{21} = F_s \\frac{|(c_1 - c^\\ast)/c_1|}{|c_1 - c^\\ast|} \\approx F_s \\frac{|E_1|}{|c_1|} $$\nSubstituting the estimate for the error $E_1$, we arrive at the standard formula for the fine-grid GCI:\n$$ \\mathrm{GCI}_{21} = \\frac{F_s}{r^p - 1} \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\nWith the given safety factor $F_s = 1.25$, the formula becomes:\n$$ \\mathrm{GCI}_{21} = \\frac{1.25}{r^p - 1} \\left| \\frac{c_1 - c_2}{c_1} \\right| $$\nThis value is reported as a decimal fraction, representing an error band on the fine-grid solution.\n\n**4. Asymptotic and Monotonic Convergence Check**\nThe problem specifies three conditions to determine if the solution is in the asymptotic and monotonic convergence range:\n1. The refinement ratio must be greater than one: $r > 1$.\n2. The change in the solution must decrease as the grid is refined: $\\lvert c_1 - c_2 \\rvert < \\lvert c_2 - c_3 \\rvert$. This indicates that the solution is stabilizing.\n3. The convergence must be monotonic, meaning the solutions approach the continuum value from one side. This is checked by ensuring that the differences $(c_1 - c_2)$ and $(c_2 - c_3)$ have the same sign. Mathematically, this is equivalent to their product being positive: $(c_1 - c_2)(c_2 - c_3) > 0$.\n\nA boolean flag, `is_asymptotic`, will be set to true only if all three conditions are met. These derivations provide the complete theoretical basis for implementing the required program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for grid convergence metrics based on Richardson extrapolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c1, c2, c3, r)\n    # c1, c2, c3 are solutions on fine, medium, and coarse meshes.\n    # r is the constant refinement ratio.\n    test_cases = [\n        (1000.0, 995.0, 975.0, 2.0),\n        (1000.0, 990.0, 977.9, 1.1),\n        (1000.0, 1002.0, 998.0, 2.0),\n        (1000.0, 997.0, 988.0, 3.0),\n        (1000.0, 992.0, 977.304, 1.5),\n    ]\n\n    results = []\n    Fs = 1.25  # Safety factor for GCI\n\n    for case in test_cases:\n        c1, c2, c3, r = case\n\n        # Calculate differences between solutions\n        e21 = c2 - c1\n        e32 = c3 - c2\n\n        # --- 1. Observed Order of Accuracy (p) ---\n        # p = ln(|(c3 - c2) / (c2 - c1)|) / ln(r)\n        # Handle potential division by zero if c1 and c2 are identical.\n        if e21 == 0.0:\n            # If the fine and medium solutions are the same, the ratio is undefined.\n            # This indicates the method is not applicable or has converged to machine precision.\n            # For this problem, we can expect p to be NaN or infinity, but we will assign\n            # a marker value. Given the test cases, this path is not taken.\n            p = np.nan\n        else:\n            ratio = e32 / e21\n            # The argument to log must be positive for the real-valued p.\n            if ratio <= 0:\n                p = np.log(abs(ratio)) / np.log(r)\n            else:\n                p = np.log(ratio) / np.log(r)\n        \n        # --- 2. Continuum-Extrapolated Solution (c_star) ---\n        # c_star = (r^p * c1 - c2) / (r^p - 1)\n        # also expressed as c_star = c1 + (c1 - c2)/(r^p - 1)\n        rp = r**p\n        if rp == 1.0:\n            # Avoid division by zero if r^p = 1 (e.g., if p=0).\n            c_star = np.nan\n        else:\n            c_star = c1 + (c1 - c2) / (rp - 1)\n        \n        # --- 3. Fine-Grid Convergence Index (GCI_21) ---\n        # GCI_21 = Fs * |(c1 - c2) / c1| / (r^p - 1)\n        if rp == 1.0 or c1 == 0.0:\n            gci_21 = np.nan # Avoid division by zero\n        else:\n            relative_error_approx = abs((c1 - c2) / c1)\n            gci_21 = Fs * relative_error_approx / (rp - 1)\n            \n        # --- 4. Asymptotic and Monotonic Convergence Check ---\n        # Conditions:\n        # 1. r > 1 (given for all cases)\n        # 2. |c1 - c2| < |c2 - c3|\n        # 3. (c1 - c2) and (c2 - c3) have the same sign, i.e., their product is positive.\n        diff12 = c1 - c2\n        diff23 = c2 - c3\n        \n        # The product (diff12 * diff23 > 0) checks if signs are the same.\n        # It correctly returns False if one of them is zero.\n        is_asymptotic = (r > 1) and (abs(diff12) < abs(diff23)) and (diff12 * diff23 > 0)\n        \n        # Assemble the results for the current test case.\n        # Boolean is converted to string 'True' or 'False' by str().\n        results.append([p, c_star, gci_21, is_asymptotic])\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) will format each inner list as a string \"[p, c_star, ...]\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}