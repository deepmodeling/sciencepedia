{
    "hands_on_practices": [
        {
            "introduction": "从理论走向实践的第一步是掌握数值方法的稳定性。显式时间步进方案因其实现简单而备受青睐，但它们带来了一个关键的权衡：数值稳定性。本练习将通过傅里叶稳定性分析，探讨扩散问题中著名的 Courant–Friedrichs–Lewy (CFL) 条件，揭示时间步长 $ \\Delta t $ 和网格间距 $ \\Delta x $ 之间严格的二次方缩放关系 $ \\Delta t \\propto (\\Delta x)^2 $。理解并能够推导这种关系，是所有从事显式动力学模拟工作的研究者的基本功。",
            "id": "3901447",
            "problem": "考虑锂离子电池隔膜中一维等温电解质传输，其厚度为 $L$，该过程由菲克第二定律控制，即 $\\partial c_{e}/\\partial t = D_{e} \\, \\partial^{2} c_{e}/\\partial x^{2}$，其中 $c_{e}(x,t)$ 是电解质浓度，$D_{e}$ 是恒定的电解质扩散系数。隔膜的空间范围为 $x \\in [0, L]$，具有物理上真实的边界条件：电极-隔膜界面处的电解质浓度固定，即 $c_{e}(0,t) = c_{0}$ 和 $c_{e}(L,t) = c_{L}$，以及一个光滑有界的初始分布 $c_{e}(x,0) = c_{e,0}(x)$。空间域被一个由 $N$ 个控制体积（单元）组成的均匀计算网格离散化，每个控制体积的宽度为 $\\Delta x = L/N$。时间推进采用前向欧拉显式方法，并结合扩散算子的二阶中心差分近似。\n\n从该偏微分方程和这些离散化选择出发，进行傅里叶（冯·诺依曼）模态稳定性分析，以推导显式格式的稳定性条件。确定 Courant–Friedrichs–Lewy (CFL) 类条件中的常数 $\\alpha$（就离散化和物理量而言），并说明最大稳定时间步长 $\\Delta t_{\\max}$ 如何依赖于 $\\Delta x$ 和 $D_{e}$。然后，对于一个细化的网格，其中隔膜厚度 $L = 30 \\times 10^{-6}$ m，电解质扩散系数 $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s，单元数 $N = 240$，计算为保证稳定性所允许的最大显式时间步长。将最终数值答案以秒为单位表示，并四舍五入到四位有效数字。\n\n最后，定性解释网格加密（在固定的 $L$ 下增加 $N$）如何影响显式扩散更新所允许的时间步长，阐明其标度关系及其对采用网格加密策略的自动化电池设计和仿真工作流程的影响。",
            "solution": "在进行求解之前，对问题进行验证。\n\n### 步骤1：提取给定信息\n-   **控制方程**：一维等温电解质传输由菲克第二定律控制，$\\partial c_{e}/\\partial t = D_{e} \\, \\partial^{2} c_{e}/\\partial x^{2}$。\n-   **变量与常数**：$c_{e}(x,t)$ 是电解质浓度，$D_{e}$ 是恒定的电解质扩散系数，$L$ 是隔膜厚度。\n-   **域**：空间域为 $x \\in [0, L]$。\n-   **边界条件 (BCs)**：界面处浓度固定，$c_{e}(0,t) = c_{0}$ 和 $c_{e}(L,t) = c_{L}$。\n-   **初始条件 (IC)**：一个光滑有界的初始分布 $c_{e}(x,0) = c_{e,0}(x)$。\n-   **空间离散化**：均匀计算网格，包含 $N$ 个控制体积，宽度为 $\\Delta x = L/N$。\n-   **时间离散化**：前向欧拉显式方法。\n-   **空间算子离散化**：扩散算子的二阶中心差分近似。\n-   **数值参数**：对于特定情况，$N = 240$，$L = 30 \\times 10^{-6}$ m，以及 $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s。\n-   **要求完成的任务**：\n    1.  使用傅里叶（冯·诺依曼）分析推导该格式的稳定性条件。\n    2.  确定 Courant–Friedrichs–Lewy (CFL) 类条件中的常数 $\\alpha$。\n    3.  说明最大稳定时间步长 $\\Delta t_{\\max}$ 对 $\\Delta x$ 和 $D_{e}$ 的依赖关系。\n    4.  计算给定参数下的 $\\Delta t_{\\max}$ 数值，并四舍五入到四位有效数字。\n    5.  定性解释网格加密如何影响所允许的时间步长。\n\n### 步骤2：使用提取的信息进行验证\n-   **科学依据**：该问题基于扩散方程（菲克第二定律），这是输运现象的基石，并将其应用于电池建模的实际场景中。所用的离散化方法（前向欧拉、中心差分）是计算物理和工程中的标准技术。给定的 $L$ 和 $D_e$ 的物理参数对于锂离子电池是合适的。该问题在科学上是合理的。\n-   **适定性**：该问题是一个标准的抛物线型偏微分方程的初边值问题。任务具体，计算上可行，并能导出一个唯一且有意义的结果。\n-   **客观性**：问题以精确的技术语言陈述，没有主观性或歧义。\n-   **完整性与一致性**：问题提供了进行分析和计算所需的所有必要信息——偏微分方程、域、边界和初始条件、离散化方案以及数值。内部没有矛盾。\n-   **现实性**：自动化电池设计的背景以及显式格式带来的数值稳定性挑战，在计算科学中非常现实且具有现实意义。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定、客观且完整。将提供完整解答。\n\n控制偏微分方程 (PDE) 是一维扩散的菲克第二定律：\n$$\n\\frac{\\partial c_{e}}{\\partial t} = D_{e} \\frac{\\partial^{2} c_{e}}{\\partial x^{2}}\n$$\n我们在一个均匀网格上对此方程进行离散化。令 $c_{j}^{n}$ 表示在空间节点 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 处浓度 $c_{e}(x,t)$ 的数值近似。\n\n时间导数 $\\partial c_{e}/\\partial t$ 使用前向欧拉方法近似：\n$$\n\\frac{\\partial c_{e}}{\\partial t} \\bigg|_{j,n} \\approx \\frac{c_{j}^{n+1} - c_{j}^{n}}{\\Delta t}\n$$\n空间二阶导数 $\\partial^{2} c_{e}/\\partial x^{2}$ 使用二阶中心差分格式近似：\n$$\n\\frac{\\partial^{2} c_{e}}{\\partial x^{2}} \\bigg|_{j,n} \\approx \\frac{c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}}{(\\Delta x)^{2}}\n$$\n将这些近似代入偏微分方程，得到完全离散的显式格式：\n$$\n\\frac{c_{j}^{n+1} - c_{j}^{n}}{\\Delta t} = D_{e} \\frac{c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}}{(\\Delta x)^{2}}\n$$\n求解下一时间步的浓度 $c_{j}^{n+1}$，我们得到：\n$$\nc_{j}^{n+1} = c_{j}^{n} + \\frac{D_{e} \\Delta t}{(\\Delta x)^{2}} (c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n})\n$$\n我们定义无量纲扩散数 $s$ 为：\n$$\ns = \\frac{D_{e} \\Delta t}{(\\Delta x)^{2}}\n$$\n更新方程简化为：\n$$\nc_{j}^{n+1} = c_{j}^{n} + s(c_{j+1}^{n} - 2c_{j}^{n} + c_{j-1}^{n}) = s c_{j-1}^{n} + (1 - 2s) c_{j}^{n} + s c_{j+1}^{n}\n$$\n为了进行冯·诺依曼稳定性分析，我们研究解（或误差）的单个傅里叶模态的增长或衰减。虽然该问题具有固定的狄利克雷边界条件，但此分析为内部节点提供了稳定性极限，这是一种标准做法，并且通常是充分的。我们假设一个形式为以下形式的解：\n$$\nc_{j}^{n} = G^{n} e^{i k x_j} = G^{n} e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$G$ 是每个时间步的放大因子。为使格式稳定，对于任何可能的波数，放大因子的模都不能超过1，即 $|G| \\le 1$。\n\n将傅里叶模态代入离散方程：\n$$\nG^{n+1} e^{i k j \\Delta x} = s (G^{n} e^{i k (j-1) \\Delta x}) + (1 - 2s) (G^{n} e^{i k j \\Delta x}) + s (G^{n} e^{i k (j+1) \\Delta x})\n$$\n两边同除以 $G^{n} e^{i k j \\Delta x}$，得到放大因子 $G$：\n$$\nG = s e^{-i k \\Delta x} + (1 - 2s) + s e^{i k \\Delta x}\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们可以简化 $G$ 的表达式：\n$$\nG = 1 - 2s + s(e^{i k \\Delta x} + e^{-i k \\Delta x}) = 1 - 2s + 2s\\cos(k \\Delta x) = 1 - 2s(1 - \\cos(k \\Delta x))\n$$\n使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$：\n$$\nG = 1 - 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n稳定性条件 $|G| \\le 1$ 等价于 $-1 \\le G \\le 1$。\n上界 $G \\le 1$ 总是满足的，因为 $s = D_{e} \\Delta t/(\\Delta x)^2 \\ge 0$ 且 $\\sin^{2}(k \\Delta x / 2) \\ge 0$，所以 $G$ 总是小于或等于 $1$。\n关键的约束来自下界 $G \\ge -1$：\n$$\n1 - 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4s \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\ns \\le \\frac{1}{2 \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)}\n$$\n这个条件必须对所有波数 $k$ 都成立。最严格的情况（稳定性的“最坏情况”）发生在分母最小时，这对应于 $\\sin^{2}(k \\Delta x / 2)$ 取最大值。$\\sin^{2}(\\cdot)$ 的最大值为 $1$，这发生在网格能表示的最高频率模态，即 $k \\Delta x = \\pi$。\n令 $\\sin^{2}(k \\Delta x / 2) = 1$，稳定性条件变为：\n$$\ns \\le \\frac{1}{2}\n$$\n这就是显式格式的稳定性条件。对于这个抛物线型问题，类CFL条件表述为 $\\frac{D_e \\Delta t}{(\\Delta x)^2} \\le \\alpha$。通过比较，我们确定常数 $\\alpha = 1/2$。\n\n根据这个条件，我们可以确定最大允许时间步长 $\\Delta t_{\\max}$。\n$$\n\\frac{D_{e} \\Delta t}{(\\Delta x)^{2}} \\le \\frac{1}{2} \\implies \\Delta t \\le \\frac{(\\Delta x)^{2}}{2D_{e}}\n$$\n因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2D_{e}}\n$$\n这表明 $\\Delta t_{\\max}$ 与单元宽度 ($\\Delta x^2$) 的平方成正比，与扩散系数 ($D_e$) 成反比。\n\n现在，我们使用给定的参数计算 $\\Delta t_{\\max}$ 的数值：$N = 240$，$L = 30 \\times 10^{-6}$ m，以及 $D_{e} = 2.8 \\times 10^{-10}$ m$^{2}$/s。\n首先，计算网格间距 $\\Delta x$：\n$$\n\\Delta x = \\frac{L}{N} = \\frac{30 \\times 10^{-6} \\, \\text{m}}{240} = 0.125 \\times 10^{-6} \\, \\text{m} = 1.25 \\times 10^{-7} \\, \\text{m}\n$$\n接下来，将 $\\Delta x$ 和 $D_{e}$ 代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{(1.25 \\times 10^{-7} \\, \\text{m})^{2}}{2(2.8 \\times 10^{-10} \\, \\text{m}^{2}/\\text{s})} = \\frac{1.5625 \\times 10^{-14} \\, \\text{m}^{2}}{5.6 \\times 10^{-10} \\, \\text{m}^{2}/\\text{s}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.5625}{5.6} \\times 10^{-4} \\, \\text{s} \\approx 0.279017857... \\times 10^{-4} \\, \\text{s}\n$$\n用科学记数法表示，这大约是 $2.79017857... \\times 10^{-5}$ s。四舍五入到四位有效数字，得到：\n$$\n\\Delta t_{\\max} \\approx 2.790 \\times 10^{-5} \\, \\text{s}\n$$\n\n最后，我们解释网格加密对允许时间步长的影响。关系式为 $\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2D_{e}}$。由于 $\\Delta x = L/N$，我们可以用 $N$ 来表示 $\\Delta t_{\\max}$（对于固定的域尺寸 $L$）：\n$$\n\\Delta t_{\\max} = \\frac{(L/N)^{2}}{2D_{e}} = \\left(\\frac{L^{2}}{2D_{e}}\\right) \\frac{1}{N^{2}}\n$$\n这表明 $\\Delta t_{\\max}$ 与网格单元数的平方成反比：$\\Delta t_{\\max} \\propto N^{-2}$。\n这种二次方标度关系对自动化电池设计和仿真有严重影响。当自动化工作流程为了提高精度而加密网格（即增加 $N$）时，显式方法的最大稳定时间步长会呈二次方下降。例如，将网格分辨率加倍（$N \\to 2N$）会迫使时间步长减少四倍（$\\Delta t_{\\max} \\to \\Delta t_{\\max}/4$）。这极大地增加了模拟给定物理时间段所需的总时间步数，从而导致计算成本大幅增加。对于扩散问题，这种稳定性约束是显式格式的一个主要缺点，在需要精细网格或长时间模拟的情况下，通常需要使用计算上更复杂但无条件稳定的隐式方法。",
            "answer": "$$\\boxed{2.790 \\times 10^{-5}}$$"
        },
        {
            "introduction": "真实的电池电极并非均匀介质；它们的微观结构性质在其厚度范围内可能存在显著变化。本练习超越了理想化的均匀介质模型，探讨了材料性质（如孔隙率 $ \\epsilon_e(x) $ 和扩散系数 $ D_e(x) $）的空间非均匀性如何对计算网格施加新的约束。您将从质量守恒第一性原理推导出控制方程，并学习如何根据材料属性的梯度来确定网格分辨率，这是确保模拟能够准确捕捉局部物理现象、从而获得高保真度预测结果的关键一步。",
            "id": "3901541",
            "problem": "考虑一个用于自动化电池设计和仿真的厚度为 $L$ 的一维充满电解质的多孔域，其中 $x \\in [0,L]$ 表示沿厚度方向的坐标。电解质浓度为 $c_e(x,t)$，电解质孔隙率为 $\\epsilon_e(x)$，电解质扩散系数为 $D_e(x)$。电解质被视为一种具有菲克扩散且对流可忽略不计的二元盐。设 $S_e(x,t)$ 表示由电化学反应产生的体积源项。\n\n从多孔介质中的基本物质守恒定律和二元电解质的扩散通量定义出发，推导 $c_e(x,t)$ 的偏微分方程，其形式为\n$$\n\\partial_t\\!\\big(\\epsilon_e c_e\\big) \\;=\\; \\nabla \\cdot \\!\\big(D_e \\nabla c_e\\big) \\;+\\; S_e.\n$$\n明确陈述适用于初始浓度均匀的封闭无通量域的边界和初始条件，并确定 $D_e(x)$ 和 $\\epsilon_e(x)$ 的空间非均匀性如何引入模型中。\n\n接下来，考虑在 $x \\in [0,L]$ 上使用网格单元尺寸为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格显式前向时间中心空间 (FTCS) 离散化和有限体积 (FV) 空间离散化。为确保网格引起的误差在强物性梯度区域不占主导地位，施加以下分辨率要求：在域中任何位置，$\\epsilon_e(x)$ 和 $D_e(x)$ 在单个网格单元内的相对变化都不得超过容差 $\\eta$。此外，还需满足具有可变系数的显式格式的稳定性。\n\n对于数值设计任务，使用以下科学上合理的数据：\n- $L = 1.0 \\times 10^{-4}$ m,\n- $\\epsilon_e(x) = \\epsilon_0 + \\alpha x$，其中 $\\epsilon_0 = 0.35$ 且 $\\alpha = 1.5 \\times 10^{3}$ m$^{-1}$,\n- $D_e(x) = D_0\\big(1 + \\beta x\\big)$，其中 $D_0 = 2.0 \\times 10^{-10}$ m$^{2}$ s$^{-1}$ 且 $\\beta = 3.0 \\times 10^{3}$ m$^{-1}$,\n- $\\eta = 0.02$,\n- $\\Delta t = 0.01$ s.\n\n假设 $S_e(x,t)$ 是有界的，因此它不会改变主阶网格分辨率或显式稳定性约束。确定在 $[0,L]$ 范围内处处满足分辨率约束，并且对于给定的 $\\Delta t$ 满足显式稳定性约束的最大均匀网格间距 $\\Delta x_{\\max}$。以米为单位表示你的 $\\Delta x_{\\max}$ 最终答案，并将其四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其具有科学依据、是良构的且客观的。\n\n**步骤 1：提取已知条件**\n- 域：厚度为 $L$ 的一维多孔介质，坐标 $x \\in [0,L]$。\n- 变量：电解质浓度 $c_e(x,t)$，空间依赖的孔隙率 $\\epsilon_e(x)$，空间依赖的扩散系数 $D_e(x)$，以及体积源项 $S_e(x,t)$。\n- 物理模型：二元盐的菲克扩散，对流可忽略。\n- 目标偏微分方程：$\\partial_t(\\epsilon_e c_e) = \\nabla \\cdot (D_e \\nabla c_e) + S_e$。\n- 条件：封闭的无通量域；初始浓度均匀。\n- 离散格式：均匀网格显式前向时间中心空间 (FTCS) 或有限体积 (FV)，网格单元尺寸为 $\\Delta x$，时间步长为 $\\Delta t$。\n- 分辨率约束：$\\epsilon_e(x)$ 和 $D_e(x)$ 的网格单元内相对变化不得超过容差 $\\eta$。\n- 稳定性约束：具有可变系数的显式格式的稳定性。\n- 数据：\n    - $L = 1.0 \\times 10^{-4}$ m\n    - $\\epsilon_e(x) = \\epsilon_0 + \\alpha x$，其中 $\\epsilon_0 = 0.35$ 且 $\\alpha = 1.5 \\times 10^{3}$ m$^{-1}$\n    - $D_e(x) = D_0(1 + \\beta x)$，其中 $D_0 = 2.0 \\times 10^{-10}$ m$^{2}$ s$^{-1}$ 且 $\\beta = 3.0 \\times 10^{3}$ m$^{-1}$\n    - $\\eta = 0.02$\n    - $\\Delta t = 0.01$ s\n- 假设：$S_e(x,t)$ 不改变主阶网格分辨率或稳定性约束。\n- 目标：确定满足所有约束的最大均匀网格间距 $\\Delta x_{\\max}$，并四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了多孔电池组件中离子输运的一个简化但标准的模型（例如，浓溶液理论）。该偏微分方程是物质守恒方程的标准形式。材料性质的函数形式是线性的，这是一种常见的简化。所提供的长度尺度、孔隙率和扩散系数的数值在物理上是现实的。问题是良构的，提供了确定 $\\Delta x_{\\max}$ 唯一值所需的所有信息和约束。语言客观而精确。该问题有效。\n\n**步骤 3：结论和行动**\n问题有效。将提供完整解答。\n\n**第一部分：控制方程和条件的推导**\n多孔介质内任意控制体积 $V$ 中的物质守恒基本原理如下：\n$$ \\frac{d}{dt} \\int_V \\epsilon_e(x) c_e(x,t) \\,dV = - \\oint_{\\partial V} \\mathbf{N}_e \\cdot \\mathbf{n} \\,dS + \\int_V S_e(x,t) \\,dV $$\n此处，$\\epsilon_e c_e$ 是多孔介质中物质的体积浓度，$\\mathbf{N}_e$ 是摩尔通量矢量。对面积分应用散度定理，将其转换为体积分：\n$$ \\int_V \\frac{\\partial}{\\partial t} \\big(\\epsilon_e c_e\\big) \\,dV = - \\int_V \\nabla \\cdot \\mathbf{N}_e \\,dV + \\int_V S_e \\,dV $$\n由于此式必须对任意体积 $V$ 成立，我们得到其微分形式：\n$$ \\frac{\\partial}{\\partial t}\\big(\\epsilon_e c_e\\big) = - \\nabla \\cdot \\mathbf{N}_e + S_e $$\n问题指出扩散是菲克式的，因此通量 $\\mathbf{N}_e$ 由 $\\mathbf{N}_e = -D_e(x) \\nabla c_e$ 给出。将此式代入守恒定律，得到：\n$$ \\frac{\\partial}{\\partial t}\\big(\\epsilon_e c_e\\big) = - \\nabla \\cdot \\big(-D_e \\nabla c_e\\big) + S_e $$\n$$ \\partial_t\\big(\\epsilon_e c_e\\big) = \\nabla \\cdot \\big(D_e \\nabla c_e\\big) + S_e $$\n这就是所求的偏微分方程。\n\n对于均匀浓度 $c_{e,0}$ 的初始条件是：\n$$ c_e(x, 0) = c_{e,0} \\quad \\text{for } x \\in [0, L] $$\n封闭的无通量域的边界条件意味着在边界 $x=0$ 和 $x=L$ 处的通量必须为零。一维通量为 $N_{e,x} = -D_e(x) \\frac{\\partial c_e}{\\partial x}$。\n$$ N_{e,x}|_{x=0} = -D_e(0)\\frac{\\partial c_e}{\\partial x}\\Big|_{x=0} = 0 \\implies \\frac{\\partial c_e}{\\partial x}\\Big|_{x=0} = 0 $$\n$$ N_{e,x}|_{x=L} = -D_e(L)\\frac{\\partial c_e}{\\partial x}\\Big|_{x=L} = 0 \\implies \\frac{\\partial c_e}{\\partial x}\\Big|_{x=L} = 0 $$\n因为在整个域中 $D_e(x) > 0$。空间非均匀性通过空间依赖的系数 $\\epsilon_e(x)$ 和 $D_e(x)$ 被引入模型中。\n\n**第二部分：分辨率约束**\n分辨率约束要求，性质 $P(x)$ 在尺寸为 $\\Delta x$ 的单个网格单元内的相对变化小于或等于 $\\eta$。对于小的 $\\Delta x$，这可以表示为：\n$$ \\frac{|P(x+\\Delta x) - P(x)|}{|P(x)|} \\approx \\frac{|P'(x)| \\Delta x}{|P(x)|} \\le \\eta $$\n为在域中处处满足此条件，$\\Delta x$ 必须小于右侧项的最小值：\n$$ \\Delta x \\le \\eta \\min_{x \\in [0,L]} \\left| \\frac{P(x)}{P'(x)} \\right| $$\n对于 $\\epsilon_e(x) = \\epsilon_0 + \\alpha x$，我们有 $\\epsilon_e'(x) = \\alpha$。比率为 $\\frac{\\epsilon_0 + \\alpha x}{\\alpha} = \\frac{\\epsilon_0}{\\alpha} + x$。由于 $\\epsilon_0, \\alpha, x$ 均为正，该函数在 $x=0$ 处取得最小值。由孔隙率得出的对 $\\Delta x$ 的约束为：\n$$ \\Delta x \\le \\eta \\frac{\\epsilon_0}{\\alpha} $$\n对于 $D_e(x) = D_0(1 + \\beta x)$，我们有 $D_e'(x) = D_0 \\beta$。比率为 $\\frac{D_0(1 + \\beta x)}{D_0 \\beta} = \\frac{1}{\\beta} + x$。该函数同样在 $x=0$ 处取得最小值。由扩散系数得出的约束为：\n$$ \\Delta x \\le \\eta \\frac{1}{\\beta} $$\n为同时满足这两个约束，$\\Delta x$ 必须小于或等于这两个上界的最小值。我们将这个上界称为 $\\Delta x_{\\text{res}}$。\n$$ \\Delta x_{\\text{res}} = \\min\\left( \\eta \\frac{\\epsilon_0}{\\alpha}, \\eta \\frac{1}{\\beta} \\right) $$\n代入给定值：\n$$ \\eta \\frac{\\epsilon_0}{\\alpha} = 0.02 \\times \\frac{0.35}{1.5 \\times 10^{3} \\text{ m}^{-1}} = \\frac{0.007}{1500} \\text{ m} \\approx 4.667 \\times 10^{-6} \\text{ m} $$\n$$ \\eta \\frac{1}{\\beta} = 0.02 \\times \\frac{1}{3.0 \\times 10^{3} \\text{ m}^{-1}} = \\frac{0.02}{3000} \\text{ m} \\approx 6.667 \\times 10^{-6} \\text{ m} $$\n更严格的约束来自于孔隙率的变化。因此，分辨率约束要求：\n$$ \\Delta x \\le 4.666... \\times 10^{-6} \\text{ m} $$\n\n**第三部分：稳定性约束**\n偏微分方程为 $\\epsilon_e(x) \\frac{\\partial c_e}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( D_e(x) \\frac{\\partial c_e}{\\partial x} \\right)$，在稳定性分析中忽略源项。显式 FTCS/FV 离散化得到形如 $c_{e,i}^{n+1} = c_{e,i}^n + \\dots$ 的更新格式。为保证稳定性，一个必要条件是在重排后的更新方程中 $c_{e,i}^n$ 项的系数为非负。这导出了以此方式离散化的可变系数扩散方程的标准局部稳定性判据：\n$$ \\frac{\\Delta t}{\\epsilon_{e,i}(\\Delta x)^2} (D_{e, i+1/2} + D_{e, i-1/2}) \\le 1 $$\n其中各项量在网格单元中心 $i$ 或网格单元面 $i \\pm 1/2$ 处取值。为使此条件对所有网格单元都成立，我们必须满足最坏情况，即左侧项被最大化。问题给定了固定的 $\\Delta t$ 并要求对 $\\Delta x$ 的约束。重排不等式：\n$$ (\\Delta x)^2 \\ge \\Delta t \\frac{D_{e, i+1/2} + D_{e, i-1/2}}{\\epsilon_{e,i}} $$\n为确保处处稳定，$\\Delta x$ 必须对“最坏”的网格单元满足此条件，即右侧项被最大化的单元：\n$$ (\\Delta x)^2 \\ge \\Delta t \\max_{x \\in [0,L]} \\left( \\frac{2 D_e(x)}{\\epsilon_e(x)} \\right) $$\n这里我们使用了连续介质极限近似 $D_{e, i+1/2} + D_{e, i-1/2} \\approx 2 D_{e,i}$。让我们求函数 $f(x) = \\frac{D_e(x)}{\\epsilon_e(x)} = \\frac{D_0(1+\\beta x)}{\\epsilon_0 + \\alpha x}$ 的最大值。其导数为：\n$$ f'(x) = D_0 \\frac{\\beta(\\epsilon_0 + \\alpha x) - \\alpha(1+\\beta x)}{(\\epsilon_0 + \\alpha x)^2} = D_0 \\frac{\\beta \\epsilon_0 - \\alpha}{(\\epsilon_0 + \\alpha x)^2} $$\n$f'(x)$ 的符号由 $\\beta \\epsilon_0 - \\alpha$ 的符号决定：\n$$ \\beta \\epsilon_0 - \\alpha = (3.0 \\times 10^3)(0.35) - (1.5 \\times 10^3) = 1050 - 1500 = -450 $$\n由于导数为负，$f(x)$ 是在 $[0,L]$ 上的递减函数。其最大值出现在 $x=0$ 处：\n$$ \\max_{x \\in [0,L]} \\frac{D_e(x)}{\\epsilon_e(x)} = \\frac{D_e(0)}{\\epsilon_e(0)} = \\frac{D_0}{\\epsilon_0} $$\n因此，稳定性约束对 $\\Delta x$ 施加了一个下界：\n$$ \\Delta x \\ge \\sqrt{\\frac{2 D_0 \\Delta t}{\\epsilon_0}} $$\n我们将这个下界称为 $\\Delta x_{\\text{stab}}$：\n$$ \\Delta x_{\\text{stab}} = \\sqrt{\\frac{2(2.0 \\times 10^{-10} \\text{ m}^2\\text{s}^{-1})(0.01 \\text{ s})}{0.35}} = \\sqrt{\\frac{4.0 \\times 10^{-12}}{0.35}} \\text{ m} \\approx 3.3806 \\times 10^{-6} \\text{ m} $$\n\n**第四部分：$\\Delta x_{\\max}$ 的最终确定**\n我们必须同时满足分辨率和稳定性约束：\n$$ \\Delta x_{\\text{stab}} \\le \\Delta x \\le \\Delta x_{\\text{res}} $$\n$$ 3.3806 \\times 10^{-6} \\text{ m} \\le \\Delta x \\le 4.666... \\times 10^{-6} \\text{ m} $$\n问题要求满足这些条件的最大均匀网格间距 $\\Delta x_{\\max}$。$\\Delta x$ 的最大可能值是这个有效区间的上界。\n$$ \\Delta x_{\\max} = \\Delta x_{\\text{res}} = \\eta \\frac{\\epsilon_0}{\\alpha} = \\frac{0.007}{1500} \\text{ m} \\approx 4.6666... \\times 10^{-6} \\text{ m} $$\n将此值四舍五入到四位有效数字，得到 $4.667 \\times 10^{-6}$ m。",
            "answer": "$$\\boxed{4.667 \\times 10^{-6}}$$"
        },
        {
            "introduction": "现代电池设计通常涉及复杂的二维和三维几何形状，这些形状无法简单地用结构化矩形网格进行划分。有限元方法(FEM)通过将简单的“参考”单元（如正方形）映射到任意形状的“物理”单元来优雅地解决这个问题。本练习将带您深入这种映射变换的核心——雅可比行列式 $ J(\\xi, \\eta) $，它不仅是连接两个坐标系的桥梁，更是一个关键的网格质量度量。您将理解为何必须保证 $ J \\gt 0 $，以避免出现“翻转”或“扭曲”的无效单元，这种情况会使仿真在物理和数学上都变得毫无意义。",
            "id": "3901526",
            "problem": "锂离子电池中的一个二维多孔电极片被离散化，用于求解耦合电化学输运偏微分方程 (PDE) 的有限元方法 (FEM) 解。为保证在自动化电池设计工作流程中，因制造形状变化而产生的单元级残差和边界通量能够被精确地数值积分，我们考虑一个单一的四节点等参双线性四边形单元。该单元将父坐标系 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 中的参考正方形映射到 $(x,y)$ 空间中的一个物理四边形。物理节点按逆时针顺序排列，其位置为\n$$\n(x_1,y_1)=\\left(0,\\,0\\right),\\quad (x_2,y_2)=\\left(1.5\\times 10^{-3},\\,0\\right),\\quad (x_3,y_3)=\\left(1.6\\times 10^{-3},\\,1.0\\times 10^{-3}\\right),\\quad (x_4,y_4)=\\left(0.1\\times 10^{-3},\\,1.0\\times 10^{-3}\\right).\n$$\n假设从参考正方形到物理单元的映射采用标准的、具有四节点形函数的双线性等参映射。使用多维积分中的变量替换定理和映射的雅可比矩阵的定义作为第一性原理，推导该单元的雅可比行列式 $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ 作为 $(\\xi,\\eta)$ 的函数，并计算其值。\n\n从弱形式中面积度量的正确变换以及映射边上诺伊曼(Neumann)型通量边界条件的法向一致朝外的角度，解释为什么 $J(\\xi,\\eta)$ 必须在整个参考正方形上保持为正，以避免单元反转并确保在自动化电池设计和仿真中积分的正确性。\n\n最终的行列式以平方米为单位表示，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导并计算一个特定的四节点等参双线性四边形单元的雅可比行列式，并解释其符号在自动化电池仿真的有限元方法 (FEM) 背景下的重要性。\n\n首先，我们必须验证问题的陈述。\n已知条件如下：\n- 一个四节点等参双线性四边形单元。\n- 参考单元是父坐标 $(\\xi, \\eta)$ 中的一个正方形，其中 $\\xi \\in [-1, 1]$ 且 $\\eta \\in [-1, 1]$。\n- 物理节点为 $(x_1, y_1) = (0, 0)$、$(x_2, y_2) = (1.5 \\times 10^{-3}, 0)$、$(x_3, y_3) = (1.6 \\times 10^{-3}, 1.0 \\times 10^{-3})$ 和 $(x_4, y_4) = (0.1 \\times 10^{-3}, 1.0 \\times 10^{-3})$。由于最终答案要求以平方米为单位，因此单位默认为米。\n- 映射是标准的双线性等参变换。\n\n该问题在科学上基于数值方法 (FEM) 和连续介质力学的原理。题目设定是自洽、一致且适定的。节点坐标描述了一个有效的凸四边形。任务明确且客观。因此，可以构建一个解决方案。\n\n从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的映射由四节点双线性形函数 $N_i(\\xi, \\eta)$ 定义：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad \\text{和} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\n从 $(\\xi, \\eta) = (-1, -1)$ 开始按逆时针顺序排列的节点的形函数为：\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n变换 $\\partial(x,y)/\\partial(\\xi,\\eta)$ 的雅可比矩阵由下式给出：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n该矩阵的分量通过对映射方程求导得出：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i \\quad, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i\n$$\n对 $y$ 也进行类似操作。形函数的导数为：\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)\n$$\n$$\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\n让我们整理雅可比矩阵各项的计算。将它们表示为以下形式会很方便：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ (x_2-x_1)(1-\\eta) + (x_3-x_4)(1+\\eta) \\right]\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ (x_4-x_1)(1-\\xi) + (x_3-x_2)(1+\\xi) \\right]\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ (y_2-y_1)(1-\\eta) + (y_3-y_4)(1+\\eta) \\right]\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ (y_4-y_1)(1-\\xi) + (y_3-y_2)(1+\\xi) \\right]\n$$\n现在，我们代入给定的节点坐标，所有值均以米为单位：\n$x_1=0$, $x_2=1.5 \\times 10^{-3}$, $x_3=1.6 \\times 10^{-3}$, $x_4=0.1 \\times 10^{-3}$\n$y_1=0$, $y_2=0$, $y_3=1.0 \\times 10^{-3}$, $y_4=1.0 \\times 10^{-3}$\n\n让我们计算坐标差：\n$x_2-x_1 = 1.5 \\times 10^{-3}$\n$x_3-x_4 = 1.6 \\times 10^{-3} - 0.1 \\times 10^{-3} = 1.5 \\times 10^{-3}$\n$x_4-x_1 = 0.1 \\times 10^{-3}$\n$x_3-x_2 = 1.6 \\times 10^{-3} - 1.5 \\times 10^{-3} = 0.1 \\times 10^{-3}$\n\n$y_2-y_1 = 0$\n$y_3-y_4 = 1.0 \\times 10^{-3} - 1.0 \\times 10^{-3} = 0$\n$y_4-y_1 = 1.0 \\times 10^{-3}$\n$y_3-y_2 = 1.0 \\times 10^{-3} - 0 = 1.0 \\times 10^{-3}$\n\n由于 $x_2-x_1 = x_3-x_4$ 且 $x_4-x_1 = x_3-x_2$，该物理单元是一个平行四边形。这简化了偏导数的计算，因为依赖于 $\\xi$ 和 $\\eta$ 的项将会消失。\n\n将这些差值代入偏导数的表达式中：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} \\left[ (1.5 \\times 10^{-3})(1-\\eta) + (1.5 \\times 10^{-3})(1+\\eta) \\right] = \\frac{1.5 \\times 10^{-3}}{4} (1-\\eta+1+\\eta) = \\frac{3.0 \\times 10^{-3}}{4} = 0.75 \\times 10^{-3}\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} \\left[ (0.1 \\times 10^{-3})(1-\\xi) + (0.1 \\times 10^{-3})(1+\\xi) \\right] = \\frac{0.1 \\times 10^{-3}}{4} (1-\\xi+1+\\xi) = \\frac{0.2 \\times 10^{-3}}{4} = 0.05 \\times 10^{-3}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} \\left[ (0)(1-\\eta) + (0)(1+\\eta) \\right] = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} \\left[ (1.0 \\times 10^{-3})(1-\\xi) + (1.0 \\times 10^{-3})(1+\\xi) \\right] = \\frac{1.0 \\times 10^{-3}}{4} (1-\\xi+1+\\xi) = \\frac{2.0 \\times 10^{-3}}{4} = 0.5 \\times 10^{-3}\n$$\n雅可比矩阵在整个单元上是恒定的：\n$$\n\\mathbf{J} = \\begin{pmatrix} 0.75 \\times 10^{-3} & 0.05 \\times 10^{-3} \\\\ 0 & 0.5 \\times 10^{-3} \\end{pmatrix}\n$$\n因此，雅可比行列式 $J(\\xi, \\eta)$ 也是恒定的：\n$$\nJ = \\det(\\mathbf{J}) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\nJ = (0.75 \\times 10^{-3})(0.5 \\times 10^{-3}) - (0.05 \\times 10^{-3})(0) = 0.375 \\times 10^{-6}\n$$\n单位是平方米 (m$^2$)。用标准科学记数法表示为 $3.75 \\times 10^{-7} \\text{ m}^2$。按要求四舍五入到四位有效数字，其值为 $3.750 \\times 10^{-7} \\text{ m}^2$。\n\n雅可比行列式必须在整个参考域上保持为正，即对于所有的 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$，都有 $J(\\xi, \\eta) > 0$。这个条件至关重要，原因有几点：\n\n1.  **几何解释与面积变换：** 雅可比行列式通过变量替换定理将物理坐标系中的微分面积元 $dA_{xy} = dx dy$ 与参考坐标系中的微分面积元 $dA_{\\xi\\eta} = d\\xi d\\eta$ 联系起来：$dA_{xy} = J(\\xi, \\eta) dA_{\\xi\\eta}$。正的雅可比行列式表示该映射是保向的。对 $dA_{\\xi\\eta}$ 边界的逆时针遍历会映射为物理空间中的逆时针遍历。如果 $J(\\xi, \\eta) < 0$，则映射在局部反转了方向，对应于一个“反转”或“扭曲”的单元，其中映射发生了自身折叠。对于有限体积的材料来说，这是一种非物理的构型。如果 $J(\\xi, \\eta) = 0$，则单元局部退化为一条线或一个点，面积为零。\n\n2.  **正确的数值积分：** 在有限元方法中，单元级积分（例如，刚度矩阵或残差向量的积分）是在物理单元 $\\Omega_e$ 上计算的。为了便于计算，这些积分被变换到参考正方形上，通常使用数值求积法（如高斯求积法）：\n    $$\n    \\int_{\\Omega_e} f(x, y) \\,dx\\,dy = \\int_{-1}^{1} \\int_{-1}^{1} f(x(\\xi,\\eta), y(\\xi,\\eta)) J(\\xi, \\eta) \\,d\\xi\\,d\\eta\n    $$\n    如果 $J(\\xi, \\eta)$ 在域的某一部分变为负值，则该区域对积分的贡献的符号将被翻转。这会导致全局方程组的组装错误，并产生无意义的解。数值求积方案要求 $J(\\xi,\\eta)$ 在所有求积点上都为正。\n\n3.  **一致的边界条件：** 对于诺伊曼(Neumann)型边界条件，它指定了穿过单元边的通量（例如，热通量、物质通量），边界的外法向量 $\\vec{n}$ 至关重要。法向量是根据沿边的切向量计算的。一个反转的单元 ($J<0$) 意味着节点的局部排序相对于一致的逆时针约定是颠倒的。这种颠倒会翻转沿边界计算的切向量的方向，导致计算出的“外”法线实际上指向单元内部。因此，一个指定的向外通量将被错误地应用为向内的源，这违反了仿真旨在求解的物理守恒定律。\n\n在自动化电池设计工作流程中，为了优化性能，电极等组件的几何形状会进行参数化变动，计算网格的节点也因此频繁移动。确保对于任何新的几何构型，网格中每个单元的雅可比行列式始终保持为正，这是一项关键的有效性检查。任何产生具有非正雅可比行列式的网格的设计都必须被拒绝，因为它在物理上和数学上对于仿真是无效的。",
            "answer": "$$\\boxed{3.750 \\times 10^{-7}}$$"
        }
    ]
}