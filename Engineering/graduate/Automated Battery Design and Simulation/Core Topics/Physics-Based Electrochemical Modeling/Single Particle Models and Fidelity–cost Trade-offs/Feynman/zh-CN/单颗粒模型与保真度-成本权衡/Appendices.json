{
    "hands_on_practices": [
        {
            "introduction": "在电池建模中，第一步通常是选择能够捕捉核心物理现象的最简化模型。本练习将引导你使用量纲分析来推导固相和电解质中扩散过程的特征时间尺度。通过比较这些时间尺度，我们可以定量地判断在何种情况下可以接受使用计算成本较低的单颗粒模型（SPM），该模型忽略了电解质动力学的影响，这项练习是理解模型保真度与成本权衡的关键一步。",
            "id": "3949392",
            "problem": "一个锂离子电池在以下假设下进行建模：球形活性材料颗粒嵌入多孔电极中，以及一个穿过隔膜的一维电解质域。单颗粒模型 (SPM) 忽略了电解质浓度动力学，而带电解质的单颗粒模型 (SPMe) 则保留了这一部分。从固相和电解质的菲克第二扩散定律出发，并使用量纲分析来确定特征扩散时间尺度，推导颗粒中的特征固相扩散时间（记为 $\\tau_{s}$）和穿过隔膜的特征电解质扩散时间（记为 $\\tau_{e}$）的表达式。然后，对于一个球形颗粒半径 $R_{p} = 5\\ \\mu\\mathrm{m}$、固相扩散系数 $D_{s} = 10^{-14}\\ \\mathrm{m}^{2}/\\mathrm{s}$、隔膜厚度 $L_{e} = 50\\ \\mu\\mathrm{m}$ 和电解质扩散系数 $D_{e} = 10^{-10}\\ \\mathrm{m}^{2}/\\mathrm{s}$ 的电池，对这些时间尺度进行数值计算。计算比率 $\\tau_{s}/\\tau_{e}$，并通过将这些时间尺度与 $2\\ \\mathrm{C}$ 放电（其中 $1\\ \\mathrm{C}$ 表示一小时放电）进行比较，说明在 $2\\ \\mathrm{C}$ 条件下，SPM中忽略电解质极化的做法在保真度上是否可接受。将 $\\tau_{s}$ 和 $\\tau_{e}$ 以秒为单位表示。将最终答案报告为纯数 $\\tau_{s}/\\tau_{e}$，不带单位，除非必要，否则不要进行四舍五入。",
            "solution": "首先验证问题陈述的科学合理性、完整性和客观性。\n\n**步骤1：提取已知条件**\n- **模型：** 一个锂离子电池，具有球形活性材料颗粒和一维电解质域。\n- **用于比较的模型：** 单颗粒模型 (SPM) 和带电解质的单颗粒模型 (SPMe)。\n- **假设：** SPM忽略电解质浓度动力学；SPMe保留它们。\n- **控制物理学：** 固相和电解质相的菲克第二扩散定律。\n- **数据：**\n    - 球形颗粒半径, $R_{p} = 5\\ \\mu\\mathrm{m}$。\n    - 固相扩散系数, $D_{s} = 10^{-14}\\ \\mathrm{m}^{2}/\\mathrm{s}$。\n    - 隔膜厚度, $L_{e} = 50\\ \\mu\\mathrm{m}$。\n    - 电解质扩散系数, $D_{e} = 10^{-10}\\ \\mathrm{m}^{2}/\\mathrm{s}$。\n- **工艺条件：** $2\\ \\mathrm{C}$ 放电。\n- **定义：** $1\\ \\mathrm{C}$ 是一小时放电。\n- **任务：**\n    1. 推导特征固相扩散时间 $\\tau_{s}$ 和特征电解质扩散时间 $\\tau_{e}$ 的表达式。\n    2. 以秒为单位，数值计算 $\\tau_{s}$ 和 $\\tau_{e}$。\n    3. 计算比率 $\\tau_{s}/\\tau_{e}$。\n    4. 评估在 $2\\ \\mathrm{C}$ 条件下，SPM中忽略电解质极化在保真度上是否可接受。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，依赖于菲克扩散定律和标准电池模型 (SPM/SPMe)。所提供的物理参数（$R_p$, $D_s$, $L_e$, $D_e$）在典型锂离子电池的实际范围内。该问题是适定的，为获得唯一解提供了所有必要信息。所用术语精确且客观。该任务与电池仿真中的保真度-成本权衡直接相关，这是自动化电池设计中的一个核心概念。该问题不违反任何无效标准。\n\n**步骤3：结论与行动**\n该问题被认为是有效的。将提供完整解答。\n\n**特征时间尺度的推导**\n固相活性材料和液态电解质中的扩散过程均受菲克第二定律支配，其一般形式为：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c\n$$\n其中 $c$ 是扩散物质的浓度，$t$ 是时间，$D$ 是扩散系数。为了找到该过程的特征时间尺度，我们进行量纲分析。令 $[L]$ 表示扩散发生的特征长度尺度，$[\\tau]$ 表示特征时间尺度。方程中的各项可以按如下方式进行尺度分析：\n$$\n\\frac{\\partial c}{\\partial t} \\sim \\frac{\\Delta c}{\\tau}\n$$\n$$\nD \\nabla^2 c \\sim D \\frac{\\Delta c}{L^2}\n$$\n为了使这些项处于同一数量级（这是方程描述动力学的必要条件），它们的尺度必须平衡：\n$$\n\\frac{1}{\\tau} \\sim \\frac{D}{L^2}\n$$\n这给出了扩散过程的特征时间：\n$$\n\\tau = \\frac{L^2}{D}\n$$\n\n对于固相活性材料颗粒，锂离子的扩散发生在半径为 $R_{p}$ 的球体内。因此，特征长度尺度为 $L = R_{p}$。相应的扩散系数是 $D_{s}$。特征固相扩散时间 $\\tau_{s}$ 为：\n$$\n\\tau_{s} = \\frac{R_{p}^2}{D_{s}}\n$$\n\n对于电解质，锂离子的扩散发生在厚度为 $L_{e}$ 的隔膜中。特征长度尺度为 $L = L_{e}$。相应的扩散系数是 $D_{e}$。特征电解质扩散时间 $\\tau_{e}$ 为：\n$$\n\\tau_{e} = \\frac{L_{e}^2}{D_{e}}\n$$\n\n**数值计算**\n给定以下数值，必须将其转换为国际单位制（SI）基本单位（米，秒）：\n- $R_{p} = 5\\ \\mu\\mathrm{m} = 5 \\times 10^{-6}\\ \\mathrm{m}$\n- $D_{s} = 10^{-14}\\ \\mathrm{m}^{2}/\\mathrm{s}$\n- $L_{e} = 50\\ \\mu\\mathrm{m} = 50 \\times 10^{-6}\\ \\mathrm{m} = 5 \\times 10^{-5}\\ \\mathrm{m}$\n- $D_{e} = 10^{-10}\\ \\mathrm{m}^{2}/\\mathrm{s}$\n\n现在，我们可以计算 $\\tau_{s}$ 和 $\\tau_{e}$。\n\n对于固相：\n$$\n\\tau_{s} = \\frac{(5 \\times 10^{-6}\\ \\mathrm{m})^2}{10^{-14}\\ \\mathrm{m}^{2}/\\mathrm{s}} = \\frac{25 \\times 10^{-12}\\ \\mathrm{m}^2}{10^{-14}\\ \\mathrm{m}^{2}/\\mathrm{s}} = 25 \\times 10^{2}\\ \\mathrm{s} = 2500\\ \\mathrm{s}\n$$\n\n对于电解质相：\n$$\n\\tau_{e} = \\frac{(5 \\times 10^{-5}\\ \\mathrm{m})^2}{10^{-10}\\ \\mathrm{m}^{2}/\\mathrm{s}} = \\frac{25 \\times 10^{-10}\\ \\mathrm{m}^2}{10^{-10}\\ \\mathrm{m}^{2}/\\mathrm{s}} = 25\\ \\mathrm{s}\n$$\n因此，固相扩散的特征时间为 $\\tau_{s} = 2500\\ \\mathrm{s}$，电解质扩散的特征时间为 $\\tau_{e} = 25\\ \\mathrm{s}$。\n\n**比率计算**\n两个时间尺度的比率为：\n$$\n\\frac{\\tau_{s}}{\\tau_{e}} = \\frac{2500\\ \\mathrm{s}}{25\\ \\mathrm{s}} = 100\n$$\n\n**SPM的保真度评估**\nSPM的核心假设是电解质浓度梯度可以忽略不计。如果电解质扩散过程比我们关注的整个过程（即电池放电）快得多，那么这个假设就成立。\n\n首先，我们确定放电过程的特征时间 $\\tau_{\\text{discharge}}$。1C倍率对应于在1小时内完全放电。\n$$\n\\tau_{\\text{discharge}, 1\\mathrm{C}} = 1\\ \\mathrm{hour} = 3600\\ \\mathrm{s}\n$$\n2C放电速度是1C的两倍，所以特征时间减半：\n$$\n\\tau_{\\text{discharge}, 2\\mathrm{C}} = \\frac{1\\ \\mathrm{hour}}{2} = 0.5\\ \\mathrm{hours} = 1800\\ \\mathrm{s}\n$$\n现在我们将特征电解质扩散时间 $\\tau_{e}$ 与放电时间 $\\tau_{\\text{discharge}, 2\\mathrm{C}}$ 进行比较：\n- $\\tau_{e} = 25\\ \\mathrm{s}$\n- $\\tau_{\\text{discharge}, 2\\mathrm{C}} = 1800\\ \\mathrm{s}$\n\nSPM成为一个有效近似的条件是 $\\tau_{e} \\ll \\tau_{\\text{discharge}}$。在本例中，$25 \\ll 1800$，其比率为 $\\tau_{e}/\\tau_{\\text{discharge}, 2\\mathrm{C}} = 25/1800 \\approx 0.014$。由于电解质扩散时间大约比放电时间小两个数量级，因此可以认为相对于放电的时间尺度，电解质浓度几乎是瞬时达到平衡的。因此，对于这个特定的电池，在 $2\\ \\mathrm{C}$ 倍率下，忽略电解质中的浓度极化（正如SPM中所做的）预计在保真度上是一个可接受的近似。较大的比率 $\\tau_s / \\tau_e = 100$ 进一步支持了这一结论，因为它表明固相扩散是慢得多的过程，因而是主导的限制因素，而这正是SPM模型旨在捕捉的动力学特性。\n\n问题要求报告代表比率 $\\tau_s/\\tau_e$ 的纯数。\n$$\n\\frac{\\tau_s}{\\tau_e} = 100\n$$",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "在选定了基础模型之后，我们必须确保其内部的物理描述是正确的。本练习聚焦于发生锂离子嵌入的颗粒表面。通过计算代表扩散与反应速率之比的无量纲数——丹柯勒数（Damköhler number），我们可以判断该过程是由扩散控制还是由反应动力学控制，而这一判断直接决定了我们应采用何种数学边界条件，从而影响模型的保真度。",
            "id": "3949421",
            "problem": "球形嵌入颗粒模型在自动化电池设计和仿真中被广泛使用，以平衡建模保真度和计算成本。在单颗粒模型（SPM）和含电解质的单颗粒模型（SPMe）中，半径为 $R_p$ 的球形活性材料颗粒内部的固相浓度 $c_s(r,t)$ 通过扩散演变，而表面嵌入反应则施加了边界通量。您的任务是量化在 $1\\ \\mathrm{C}$ 恒流操作过程中颗粒表面的控制物理过程，以决定简化的恒定通量边界（扩散控制）是否足够，还是必须保留有限的表面动力学（反应控制）。仅使用第一性原理：球坐标系下的 Fick 定律、质量守恒和时间尺度论证。\n\n定义和数据：\n- 单颗粒模型（SPM）将每个电极视为相同球形颗粒的集合；含电解质的单颗粒模型（SPMe）通过解析电解质传输来增强 SPM。\n- 在 $T=3600\\ \\mathrm{s}$ 的时间间隔内进行 $1\\ \\mathrm{C}$ 恒流操作时，当电流随时间均匀施加时，活性颗粒中的电极平均固相浓度变化量为 $c_{s,\\max}$。\n- 固相扩散系数为 $D_s$，为了进行时间尺度比较，界面反应被线性化为一级反应，速率常数为 $k$（单位为 $\\mathrm{m/s}$）。\n- 无量纲表面通量通过经典的 Fickian 无量纲化定义为 $\\tilde{j} = \\dfrac{j R_p}{D_s c_{s,\\max}}$，其中 $j$ 是颗粒表面的摩尔通量（单位为 $\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$）。\n- 固相 Damköhler 数定义为扩散和反应时间尺度的比值 $\\mathrm{Da}_s = \\dfrac{k R_p}{D_s}$。\n- 参数：$R_p = 5.0 \\times 10^{-6}\\ \\mathrm{m}$，$D_s = 1.0 \\times 10^{-14}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$，$k = 3.0 \\times 10^{-11}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，以及 $c_{s,\\max} = 3.1 \\times 10^{4}\\ \\mathrm{mol}\\ \\mathrm{m}^{-3}$。\n\n任务：\n1. 从球体中的质量守恒和球坐标系下的 Fick 定律出发，推导在时间 $T$ 内实现颗粒平均浓度变化 $1\\ \\mathrm{C}$ 所需的恒定表面通量 $j$ 的表达式，然后计算无量纲表面通量 $\\tilde{j}$。\n2. 根据时间尺度论证推导固相 Damköhler 数 $\\mathrm{Da}_s$ 并计算其值。\n3. 使用在荷电状态中点（为进行此推断，设无量纲表面浓度 $\\theta_s \\equiv c_{s,s}/c_{s,\\max}$ 约等于 $0.5$）评估的 $\\tilde{j}$ 和 $\\mathrm{Da}_s$ 的量级，解释哪一项主导了表面浓度动力学（扩散施加的恒定通量边界 vs. 反应限制的 Robin 边界），并论证哪种模型保真度在自动化设计流程中是合适的。\n\n以无量纲形式表示 $\\tilde{j}$ 和 $\\mathrm{Da}_s$ 的最终数值，并四舍五入至四位有效数字。以 $1 \\times 2$ 行矩阵的形式按顺序 $\\left(\\tilde{j},\\ \\mathrm{Da}_s\\right)$ 提供您的最终答案。最终答案中不要包含单位。",
            "solution": "所述问题具有科学依据、提法恰当且客观。它基于已建立的用于电池仿真的单颗粒模型（SPM）中应用的输运现象和电化学的标准原理。所提供的参数在物理上是现实的，任务定义清晰，可以得出一个唯一且有意义的解。因此，该问题是有效的。\n\n解答将分三部分呈现，对应于问题陈述中概述的三个任务。\n\n**1. 无量纲表面通量 $\\tilde{j}$ 的推导与计算**\n\n第一个任务是确定实现指定的平均浓度变化所需的表面通量 $j$，然后计算其无量纲形式 $\\tilde{j}$。该推导从单个球形颗粒内嵌入物质的质量守恒原理开始。\n\n颗粒体积 $V_p$ 内物质总摩尔数 $N_s$ 的变化率必须等于通过其表面积 $A_p$ 的净摩尔通量。总摩尔流入量是表面通量 $j$（单位为 $\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$）与表面积 $A_p = 4\\pi R_p^2$ 的乘积。因此，守恒方程为：\n$$\n\\frac{dN_s}{dt} = j A_p\n$$\n总摩尔数 $N_s$ 通过 $N_s(t) = \\bar{c}_s(t) V_p$ 与体平均浓度 $\\bar{c}_s(t)$ 相关，其中颗粒体积为 $V_p = \\frac{4}{3}\\pi R_p^3$。将此代入守恒方程可得：\n$$\n\\frac{d}{dt} \\left( \\bar{c}_s(t) V_p \\right) = j A_p\n$$\n假设颗粒体积 $V_p$ 恒定，我们有：\n$$\nV_p \\frac{d\\bar{c}_s}{dt} = j A_p\n$$\n求解表面通量 $j$：\n$$\nj = \\frac{V_p}{A_p} \\frac{d\\bar{c}_s}{dt} = \\frac{\\frac{4}{3}\\pi R_p^3}{4\\pi R_p^2} \\frac{d\\bar{c}_s}{dt} = \\frac{R_p}{3} \\frac{d\\bar{c}_s}{dt}\n$$\n问题将 $1\\ \\mathrm{C}$ 恒流操作定义为在时间周期 $T = 3600\\ \\mathrm{s}$ 内使电极平均固相浓度变化 $c_{s,\\max}$ 的操作。假设电流均匀，平均浓度的变化率是恒定的，可以表示为：\n$$\n\\frac{d\\bar{c}_s}{dt} = \\frac{\\Delta \\bar{c}_s}{\\Delta t} = \\frac{c_{s,\\max}}{T}\n$$\n将此代入 $j$ 的表达式，得到所需的恒定表面通量：\n$$\nj = \\frac{R_p c_{s,\\max}}{3 T}\n$$\n接下来，我们计算无量纲表面通量 $\\tilde{j}$，在问题中其定义为 $\\tilde{j} = \\dfrac{j R_p}{D_s c_{s,\\max}}$。代入我们推导出的 $j$ 的表达式：\n$$\n\\tilde{j} = \\frac{\\left( \\frac{R_p c_{s,\\max}}{3 T} \\right) R_p}{D_s c_{s,\\max}} = \\frac{R_p^2}{3 D_s T}\n$$\n现在，我们代入给定的参数值：$R_p = 5.0 \\times 10^{-6}\\ \\mathrm{m}$，$D_s = 1.0 \\times 10^{-14}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$，以及 $T = 3600\\ \\mathrm{s}$。\n$$\n\\tilde{j} = \\frac{(5.0 \\times 10^{-6})^2}{3 (1.0 \\times 10^{-14}) (3600)} = \\frac{2.5 \\times 10^{-11}}{1.08 \\times 10^{-10}} \\approx 0.231481...\n$$\n四舍五入到四位有效数字，无量纲表面通量为 $\\tilde{j} = 0.2315$。\n\n**2. 固相 Damköhler 数 $\\mathrm{Da}_s$ 的推导与计算**\n\n固相 Damköhler 数 $\\mathrm{Da}_s$ 是一个无量纲数群，用于比较扩散和反应的特征时间尺度。\n\n扩散的特征时间 $\\tau_{diff}$ 是物质扩散通过特征长度（即颗粒半径 $R_p$）所需的时间。根据量纲分析，该时间尺度由下式给出：\n$$\n\\tau_{diff} = \\frac{R_p^2}{D_s}\n$$\n反应的特征时间 $\\tau_{rxn}$ 与界面反应速率常数 $k$ 相关，其单位为速度（$\\mathrm{m}\\ \\mathrm{s}^{-1}$）。反应过程传播通过特征长度 $R_p$ 所需的时间为：\n$$\n\\tau_{rxn} = \\frac{R_p}{k}\n$$\nDamköhler 数定义为扩散时间尺度与反应时间尺度之比：\n$$\n\\mathrm{Da}_s = \\frac{\\tau_{diff}}{\\tau_{rxn}} = \\frac{R_p^2 / D_s}{R_p / k} = \\frac{k R_p}{D_s}\n$$\n这个推导出的表达式与问题陈述中提供的定义相符。$\\mathrm{Da}_s \\ll 1$ 的值表示反应远慢于扩散（反应控制），而 $\\mathrm{Da}_s \\gg 1$ 则表示扩散远慢于反应（扩散控制）。\n\n使用给定的参数值：$k = 3.0 \\times 10^{-11}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，$R_p = 5.0 \\times 10^{-6}\\ \\mathrm{m}$，以及 $D_s = 1.0 \\times 10^{-14}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$：\n$$\n\\mathrm{Da}_s = \\frac{(3.0 \\times 10^{-11}) (5.0 \\times 10^{-6})}{1.0 \\times 10^{-14}} = \\frac{1.5 \\times 10^{-16}}{1.0 \\times 10^{-14}} = 0.015\n$$\n表示为四位有效数字，Damköhler 数为 $\\mathrm{Da}_s = 0.01500$。\n\n**3. 控制物理过程与模型保真度的解释**\n\n最后的任务是使用计算出的 $\\tilde{j}$ 和 $\\mathrm{Da}_s$ 的值来确定颗粒表面的控制物理过程，并论证合适的模型保真度。\n\n计算值为：\n$$\n\\tilde{j} \\approx 0.2315 \\quad \\text{and} \\quad \\mathrm{Da}_s = 0.01500\n$$\n- $\\mathrm{Da}_s$ 代表反应速率与扩散速率的内在比值。由于 $\\mathrm{Da}_s = 0.01500 \\ll 1$，反应的特征时间（$\\tau_{rxn} = R_p/k \\approx 1.67 \\times 10^5\\ \\mathrm{s}$）明显长于扩散的特征时间（$\\tau_{diff} = R_p^2/D_s = 2500\\ \\mathrm{s}$）。这表明表面嵌入反应是缓慢的、限制速率的步骤。该系统基本上是反应控制的。\n\n- $\\tilde{j}$ 代表外部 $1\\ \\mathrm{C}$ 电流所要求的无量纲通量。在表面（$r=R_p$）处关联扩散和反应的边界条件由 Fick 定律给出：$-D_s \\frac{\\partial c_s}{\\partial r} = j_{rxn}$，其中反应通量 $j_{rxn}$ 驱动该过程。以无量纲形式，这变为 $-\\frac{\\partial (c_s/c_{s,max})}{\\partial (r/R_p)} = \\frac{j_{rxn} R_p}{D_s c_{s,max}}$。右侧是一个无量纲的反应通量。对于线性化的反应动力学（$j_{rxn} \\propto k$），其特征量级由 $\\mathrm{Da}_s$ 决定。\n\n我们观察到，所需的通量 $\\tilde{j}$ 比由 $\\mathrm{Da}_s$ 代表的内在本征动力学能力大一个数量级以上（$\\tilde{j} / \\mathrm{Da}_s \\approx 15.4$）。这种巨大的差异意味着，为了达到所需的电流，表面反应必须由非常大的热力学驱动力来驱动。在形式为 $-D_s \\frac{\\partial c_s}{\\partial r} = k(c_{s,s} - c_{s,eq})$ 的 Robin 边界条件的背景下，这意味着表面浓度 $c_{s,s}$ 与其平衡值 $c_{s,eq}$ 之间存在大的偏差。这种在表面发生的浓度变化，即所谓的浓差过电势，是这些条件下的主导物理现象。\n\n**关于模型保真度的结论：**\n简化的“恒定通量”边界条件（Neumann 条件）仅适用于扩散控制的系统（$\\mathrm{Da}_s \\gg 1$），其中假定表面动力学无限快且不限制过程。在此类模型中，施加的电流直接转化为浓度梯度，而表面浓度本身不是一个主要的动态变量。\n\n鉴于我们的分析表明系统是强反应控制的（$\\mathrm{Da}_s \\ll 1$），这种简化的方法是不够的。主要的物理过程是表面的动力学限制。因此，**必须保留**一个明确考虑有限表面动力学的高保真度模型。这对应于使用 Robin 型边界条件，它能捕捉通量和表面浓度之间的关系。对于自动化电池设计流程，使用简化的、不充分的模型将导致严重不准确的预测，特别是对电池的电压响应，因为它无法捕捉主导的动力学过电势。为了物理准确性，解析表面动力学所需的额外计算成本是合理的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2315  0.01500 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "建模的最后一步是数值求解控制方程，而这正是保真度与成本权衡最直观的体现。本练习要求你实现一个低阶有限体积法方案，用以求解颗粒内部的扩散方程。这项动手编程任务将展示离散化选择（例如，球壳的数量）如何直接影响计算的复杂性以及最终的仿真精度。",
            "id": "3949410",
            "problem": "假设一个球形单颗粒电极通过物种守恒和球坐标下的菲克扩散进行建模。固相锂浓度 $c_s(r,t)$ 的控制方程为\n$$\n\\frac{\\partial c_s}{\\partial t} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 D_s(c_s)\\frac{\\partial c_s}{\\partial r}\\right),\n$$\n其中 $r \\in [0,R_p]$，$t \\ge 0$，$D_s(c_s)$ 是固相扩散系数，$R_p$ 是颗粒半径。边界条件为中心对称，\n$$\n\\left.\\frac{\\partial c_s}{\\partial r}\\right|_{r=0} = 0,\n$$\n以及在颗粒表面的指定界面通量，\n$$\n- D_s(c_s)\\left.\\frac{\\partial c_s}{\\partial r}\\right|_{r=R_p} = j_{\\mathrm{surf}}(t),\n$$\n其中 $j_{\\mathrm{surf}}(t)$ 是表面的摩尔通量。在单颗粒模型 (Single Particle Model, SPM) 和带电解质动力学的单颗粒模型 (Single Particle Model with Electrolyte dynamics, SPMe) 中，此偏微分方程描述了代表性颗粒内部的径向扩散。为了探究保真度与成本之间的权衡，使用一个包含三个同心球壳的低阶有限体积法来近似该连续模型，并认识到较少的球壳会降低计算成本，但同时也会降低模型保真度。\n\n假设固相扩散系数随浓度线性变化，\n$$\nD_s(c_s) = D_0 + k_D\\, c_s,\n$$\n其中 $D_0$ 和 $k_D$ 是常数。设颗粒半径为 $R_p = 4\\,\\mu\\mathrm{m}$，即 $R_p = 4\\times 10^{-6}\\ \\mathrm{m}$。将球体划分为三个等厚度 $\\Delta r = R_p/3$ 的球壳，其界面半径为\n$$\nr_{1/2} = 0,\\quad r_{3/2} = \\frac{R_p}{3},\\quad r_{5/2} = \\frac{2R_p}{3},\\quad r_{7/2} = R_p,\n$$\n并在体积\n$$\nV_i = \\frac{4\\pi}{3}\\left(r_{i+1/2}^3 - r_{i-1/2}^3\\right),\\quad i=1,2,3,\n$$\n上定义球壳平均浓度 $c_1(t)$、$c_2(t)$ 和 $c_3(t)$，其界面面积为\n$$\nA_{i+1/2} = 4\\pi r_{i+1/2}^2.\n$$\n构建一个包含三个球壳的守恒型有限体积法来近似 $\\partial c_s/\\partial t$，并写出以界面通量 $J_{i+1/2}$ 表示的球壳平均浓度 $c_i(t)$ 的离散更新方程。使用以下原则：\n- 通过内部界面 $r_{i+1/2}$ 的通量由下式给出\n$$\nJ_{i+1/2} = -D_{i+1/2}\\frac{c_{i+1} - c_i}{\\Delta r},\n$$\n其中 $\\Delta r = R_p/3$，$D_{i+1/2}$ 是通过相邻球壳扩散系数的调和平均计算得出的界面扩散系数，\n$$\nD_{i+1/2} = \\left(\\frac{1}{2}\\left[\\frac{1}{D_i} + \\frac{1}{D_{i+1}}\\right]\\right)^{-1},\\quad D_i = D_0 + k_D\\, c_i.\n$$\n- 中心界面通量满足 $J_{1/2} = 0$，表面界面通量满足 $J_{7/2} = j_{\\mathrm{surf}}(t)$。\n- 每个球壳的守恒更新为\n$$\n\\frac{\\mathrm{d}c_i}{\\mathrm{d}t} = \\frac{A_{i-1/2}J_{i-1/2} - A_{i+1/2}J_{i+1/2}}{V_i},\\quad i=1,2,3.\n$$\n\n将上述方案实现为一个程序，对于给定的参数 $\\{D_0,k_D,R_p\\}$（其中 $R_p$ 固定为 $4\\times 10^{-6}\\ \\mathrm{m}$）、指定的表面通量 $j_{\\mathrm{surf}}$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）以及球壳平均浓度向量 $\\mathbf{c} = [c_1,c_2,c_3]$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$），使用离散方程计算右侧项 $\\mathrm{d}\\mathbf{c}/\\mathrm{d}t$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$）。该程序应为以下测试套件生成结果：\n\n- 测试用例 1（正常情况，均匀浓度，零通量）：\n  $D_0 = 1.0\\times 10^{-14}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k_D = 2.0\\times 10^{-19}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}\\,(\\mathrm{mol}\\,\\mathrm{m}^{-3})^{-1}$，$R_p = 4.0\\times 10^{-6}\\ \\mathrm{m}$，$\\mathbf{c} = [20000.0,20000.0,20000.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，$j_{\\mathrm{surf}} = 0.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n- 测试用例 2（均匀浓度，表面向外通量）：\n  $D_0 = 1.0\\times 10^{-14}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k_D = 2.0\\times 10^{-19}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}\\,(\\mathrm{mol}\\,\\mathrm{m}^{-3})^{-1}$，$R_p = 4.0\\times 10^{-6}\\ \\mathrm{m}$，$\\mathbf{c} = [20000.0,20000.0,20000.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，$j_{\\mathrm{surf}} = 1.0\\times 10^{-6}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n- 测试用例 3（非均匀浓度，向内通量，负斜率 $k_D  0$）：\n  $D_0 = 1.5\\times 10^{-14}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$k_D = -1.0\\times 10^{-19}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}\\,(\\mathrm{mol}\\,\\mathrm{m}^{-3})^{-1}$，$R_p = 4.0\\times 10^{-6}\\ \\mathrm{m}$，$\\mathbf{c} = [10000.0,20000.0,30000.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$，$j_{\\mathrm{surf}} = -5.0\\times 10^{-7}\\ \\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ 为单位表示每个测试用例的输出 $\\mathrm{d}\\mathbf{c}/\\mathrm{d}t$。您的程序应生成单行输出，其中包含三个结果，格式为逗号分隔的列表的列表，每个内部列表按 $[\\,\\mathrm{d}c_1/\\mathrm{d}t,\\mathrm{d}c_2/\\mathrm{d}t,\\mathrm{d}c_3/\\mathrm{d}t\\,]$ 的顺序排列，并用方括号括起来，例如 $[[x_1,x_2,x_3],[y_1,y_2,y_3],[z_1,z_2,z_3]]$。",
            "solution": "该问题要求构建一个用于球形颗粒内固相扩散的三球壳有限体积模型，并实现该模型以计算球壳平均浓度的时间导数。该物理过程由物种守恒定律控制，表示为锂浓度 $c_s(r, t)$ 的偏微分方程：\n$$\n\\frac{\\partial c_s}{\\partial t} = \\frac{1}{r^2}\\frac{\\partial}{\\partial r}\\left(r^2 D_s(c_s)\\frac{\\partial c_s}{\\partial r}\\right)\n$$\n为了近似求解，将半径为 $R_p$ 的球形颗粒离散为 $N=3$ 个等厚度 $\\Delta r = R_p/3$ 的同心球壳。我们将球壳平均浓度定义为 $c_1$、$c_2$ 和 $c_3$。\n\n有限体积法基于守恒定律的积分形式。对于每个球壳 $i$，球壳中物质总量的变化率（浓度 $c_i$ 乘以体积 $V_i$）等于穿过其边界的物质净通量。球壳 $i$ 的边界是位于半径 $r_{i-1/2}$ 和 $r_{i+1/2}$ 处的球面，其对应的表面积为 $A_{i-1/2}$ 和 $A_{i+1/2}$。球壳 $i$ 的守恒定律为：\n$$\nV_i \\frac{\\mathrm{d}c_i}{\\mathrmd t} = A_{i-1/2} J_{i-1/2} - A_{i+1/2} J_{i+1/2}\n$$\n其中 $J_{i \\pm 1/2}$ 表示界面处的摩尔通量。可以重新整理此式以求解时间导数：\n$$\n\\frac{\\mathrm{d}c_i}{\\mathrm{d}t} = \\frac{A_{i-1/2}J_{i-1/2} - A_{i+1/2}J_{i+1/2}}{V_i}\n$$\n几何参数由界面半径 $r_{1/2}=0$、$r_{3/2}=R_p/3$、$r_{5/2}=2R_p/3$ 和 $r_{7/2}=R_p$ 定义。界面面积为 $A_{i+1/2} = 4\\pi r_{i+1/2}^2$，球壳体积为 $V_i = \\frac{4\\pi}{3}(r_{i+1/2}^3 - r_{i-1/2}^3)$。\n\n写出每个球壳（共3个）的更新方程：\n对于球壳 1（$i=1$）：内界面位于中心（$r_{1/2}=0$），因此其面积 $A_{1/2}=0$。对称边界条件意味着通过中心的通量为零，$J_{1/2}=0$。\n$$\n\\frac{\\mathrm{d}c_1}{\\mathrm{d}t} = \\frac{A_{1/2}J_{1/2} - A_{3/2}J_{3/2}}{V_1} = \\frac{0 - A_{3/2}J_{3/2}}{V_1}\n$$\n对于球壳 2（$i=2$）：\n$$\n\\frac{\\mathrm{d}c_2}{\\mathrm{d}t} = \\frac{A_{3/2}J_{3/2} - A_{5/2}J_{5/2}}{V_2}\n$$\n对于球壳 3（$i=3$）：外界面是颗粒表面（$r_{7/2}=R_p$），此处的通量被指定为 $J_{7/2} = j_{\\mathrm{surf}}(t)$。\n$$\n\\frac{\\mathrm{d}c_3}{\\mathrm{d}t} = \\frac{A_{5/2}J_{5/2} - A_{7/2}J_{7/2}}{V_3}\n$$\n内部界面 $J_{3/2}$ 和 $J_{5/2}$ 处的通量由相邻球壳之间的浓度梯度决定。球壳 $i$ 和球壳 $i+1$ 之间的通量近似为：\n$$\nJ_{i+1/2} = -D_{i+1/2}\\frac{c_{i+1} - c_i}{\\Delta r}\n$$\n扩散系数 $D_s$ 依赖于浓度，$D_s(c_s) = D_0 + k_D c_s$，并为每个球壳计算为 $D_i = D_0 + k_D c_i$。球壳间界面的扩散系数 $D_{i+1/2}$ 使用相邻球壳扩散系数的调和平均值计算。这确保了通量的连续性和数值稳定性。\n$$\nD_{i+1/2} = \\left(\\frac{1}{2}\\left[\\frac{1}{D_i} + \\frac{1}{D_{i+1}}\\right]\\right)^{-1} = \\frac{2 D_i D_{i+1}}{D_i + D_{i+1}}\n$$\n计算 $\\mathrm{d}\\mathbf{c}/\\mathrm{d}t$ 的总体算法是这些方程的直接实现：\n1.  给定输入参数（$D_0, k_D$）、状态向量（$\\mathbf{c}=[c_1, c_2, c_3]$）和边界条件（$j_{\\mathrm{surf}}$），其中 $R_p$ 固定为 $4\\times 10^{-6}\\ \\mathrm{m}$。\n2.  计算恒定的几何参数：$\\Delta r$、$r_{i+1/2}$、$A_{i+1/2}$ 和 $V_i$（对于 $i=1,2,3$）。\n3.  计算每个球壳的扩散系数：$D_1$、$D_2$、$D_3$。\n4.  计算内部界面的调和平均扩散系数：$D_{3/2}$ 和 $D_{5/2}$。\n5.  计算内部界面的摩尔通量：$J_{3/2}$ 和 $J_{5/2}$。\n6.  使用边界条件 $J_{1/2}=0$ 和 $J_{7/2}=j_{\\mathrm{surf}}$。\n7.  将面积、体积和通量代入更新方程，以求得 $\\mathrm{d}c_1/\\mathrm{d}t$、$\\mathrm{d}c_2/\\mathrm{d}t$ 和 $\\mathrm{d}c_3/\\mathrm{d}t$。\n\n在提供的 Python 程序中，该过程被系统地应用于每个测试用例，以获得所需的结果。",
            "answer": "[[0.0,0.0,0.0],[0.0,0.0,-1.066292275685718],[2.169116715560662,-0.6385750849764516,-0.2858882092523293]]"
        }
    ]
}