{
    "hands_on_practices": [
        {
            "introduction": "电池模型中的许多参数都与温度相关，理解其依赖关系是准确仿真的关键。塔菲尔斜率（Tafel slope）是描述电极动力学的一个核心参数，这个练习将引导你从基本的巴特勒-沃尔默（Butler-Volmer）方程出发，推导塔菲尔斜率与温度的函数关系。通过这个实践，你将加深对基本电化学原理的理解，并掌握如何将理论模型与可测量的宏观参数联系起来。",
            "id": "3955222",
            "problem": "在锂离子电池（Li-ion）系统的自动化设计和仿真中，电极上的电化学反应速率通常由Butler-Volmer方程建模，该方程描述了电流密度 $i$ 对过电位 $\\eta$、温度 $T$ 和电荷转移系数 $\\alpha$ 的依赖关系。考虑一个单步电荷转移反应，其在Tafel区的动力学由适用于大幅值过电位的Butler-Volmer关系式描述。定义Tafel斜率大小 $b(T)$ 为过电位与电流密度的常用对数（以10为底）之间的关系式 $b(T) \\equiv \\mathrm{d}\\eta / \\mathrm{d}\\log_{10} i$，此关系在相应的Tafel极限下求得。假设在所研究的温度范围内，电荷转移系数 $\\alpha$ 不随温度变化，并且交换电流密度 $i_{0}$ 可被视为一个指前因子，在求导后不进入斜率表达式。\n\n从第一性原理和广泛接受的定律出发，即：\n- 用于单步电子转移的Butler-Volmer方程，\n- Tafel区的定义，即其中一个指数项占主导地位的极限情况，\n- 以及自然对数 $\\ln$ 和常用对数 $\\log_{10}$ 之间的换底公式，\n\n推导出在阴极Tafel区，$b(T)$ 对温度 $T$ 和电荷转移系数 $\\alpha$ 的函数依赖关系。然后，对于在环境条件下校准的锂离子电池中的石墨负极，假设 $\\alpha = 0.42$。计算当温度从 $T_{1} = 298\\ \\mathrm{K}$ 升高到 $T_{2} = 333\\ \\mathrm{K}$ 时，Tafel斜率大小的预期变化。\n\n使用摩尔气体常数 $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 和法拉第常数 $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$。将最终的斜率变化以毫伏每十倍程（mV per decade）为单位表示。将答案四舍五入至四位有效数字。",
            "solution": "该问题要求从Butler-Volmer方程推导阴极Tafel斜率大小的温度依赖性，并随后计算其在指定温度区间内的变化。\n\n**第一部分：Tafel斜率大小的推导**\n\n单步、单电子转移（$n=1$）反应的Butler-Volmer方程如下所示：\n$$i = i_{0} \\left[ \\exp\\left(\\frac{(1-\\alpha) F \\eta}{R T}\\right) - \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right) \\right]$$\n其中 $i$ 是净电流密度，$i_{0}$ 是交换电流密度，$\\alpha$ 是电荷转移系数，$\\eta$ 是过电位，$F$ 是法拉第常数，$R$ 是摩尔气体常数，$T$ 是绝对温度。\n\n问题指定了阴极Tafel区，这对应于大的负过电位（$\\eta \\ll 0$）。在此极限下，项 $\\exp\\left(\\frac{(1-\\alpha) F \\eta}{R T}\\right)$ 趋近于零的速度远快于项 $\\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$ 增长的速度。因此，第一个指数项与第二个相比可以忽略不计。Butler-Volmer方程简化为：\n$$i \\approx -i_{0} \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$$\n在这里，净电流密度 $i$ 是负值，表示阴极电流。我们定义阴极电流密度的大小为 $i_c = -i$，它是一个正值。方程变为：\n$$i_c = i_{0} \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$$\n为了求出过电位 $\\eta$ 作为 $i_c$ 的函数，我们对方程进行重排。首先，我们对两边取自然对数：\n$$\\ln\\left(\\frac{i_c}{i_0}\\right) = -\\frac{\\alpha F \\eta}{R T}$$\n解出 $\\eta$：\n$$\\eta = -\\frac{R T}{\\alpha F} \\ln\\left(\\frac{i_c}{i_0}\\right) = -\\frac{R T}{\\alpha F} (\\ln(i_c) - \\ln(i_0))$$\n\n问题使用以10为底的对数 $\\log_{10}$ 来定义Tafel斜率大小。我们使用换底公式 $\\ln(x) = \\ln(10) \\log_{10}(x)$ 来转换 $\\eta$ 的表达式：\n$$\\eta = -\\frac{R T \\ln(10)}{\\alpha F} (\\log_{10}(i_c) - \\log_{10}(i_0))$$\n这可以写成：\n$$\\eta = -\\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_c) + \\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_0)$$\n问题将Tafel斜率定义为 $b(T) \\equiv \\mathrm{d}\\eta / \\mathrm{d}\\log_{10} i$。对于阴极分支，我们对 $\\eta$ 关于 $\\log_{10}(i_c)$ 求导。根据题目陈述，在求导过程中，交换电流密度 $i_0$ 被视为相对于 $i_c$ 的常数。\n$$b_c(T) = \\frac{\\mathrm{d}\\eta}{\\mathrm{d}\\log_{10}(i_c)} = \\frac{\\mathrm{d}}{\\mathrm{d}\\log_{10}(i_c)} \\left( -\\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_c) + \\text{constant} \\right)$$\n$$b_c(T) = -\\frac{R T \\ln(10)}{\\alpha F}$$\n这就是阴极Tafel斜率。问题要求的是Tafel斜率的大小，我们将其记为 $B(T)$。由于 $R$、$T$、$\\alpha$、$F$ 和 $\\ln(10)$ 都是正值，斜率 $b_c(T)$ 是负值。其大小为：\n$$B(T) = |b_c(T)| = \\frac{R T \\ln(10)}{\\alpha F}$$\n这个表达式表明，Tafel斜率的大小与绝对温度 $T$ 成正比。\n\n**第二部分：Tafel斜率大小变化的计算**\n\n我们被要求计算当温度从 $T_1 = 298\\ \\mathrm{K}$ 升高到 $T_2 = 333\\ \\mathrm{K}$ 时，Tafel斜率大小的变化量 $\\Delta B$。\n$$\\Delta B = B(T_2) - B(T_1)$$\n代入推导出的 $B(T)$ 表达式：\n$$\\Delta B = \\frac{R T_2 \\ln(10)}{\\alpha F} - \\frac{R T_1 \\ln(10)}{\\alpha F}$$\n提出公因式：\n$$\\Delta B = \\frac{R \\ln(10)}{\\alpha F} (T_2 - T_1)$$\n现在，我们代入给定的值：\n- $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$\n- $\\alpha = 0.42$\n- $T_1 = 298\\ \\mathrm{K}$\n- $T_2 = 333\\ \\mathrm{K}$\n\n温差为 $\\Delta T = T_2 - T_1 = 333\\ \\mathrm{K} - 298\\ \\mathrm{K} = 35\\ \\mathrm{K}$。\n10的自然对数值为 $\\ln(10) \\approx 2.302585$。\n将这些值代入 $\\Delta B$ 的方程：\n$$\\Delta B = \\frac{(8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times \\ln(10) \\times (35\\ \\mathrm{K})}{(0.42) \\times (96485.33212\\ \\mathrm{C\\,mol^{-1}})}$$\n计算的单位是 $\\frac{\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\cdot \\mathrm{K}}{\\mathrm{C\\,mol^{-1}}} = \\frac{\\mathrm{J}}{\\mathrm{C}} = \\mathrm{V}$。结果的单位将是伏特（每十倍程）。\n我们来计算数值：\n$$\\Delta B = \\frac{8.314462618 \\times 2.302585093 \\times 35}{0.42 \\times 96485.33212}$$\n$$\\Delta B = \\frac{670.0678278...}{40523.83949...} \\approx 0.01653528\\ \\mathrm{V\\,decade^{-1}}$$\n问题要求答案以毫伏每十倍程（mV per decade）表示。为了从伏特转换为毫伏，我们乘以 $1000$：\n$$\\Delta B \\approx 0.01653528 \\times 1000\\ \\mathrm{mV\\,decade^{-1}} \\approx 16.53528\\ \\mathrm{mV\\,decade^{-1}}$$\n最后，我们将结果四舍五入到四位有效数字：\n$$\\Delta B \\approx 16.54\\ \\mathrm{mV\\,decade^{-1}}$$",
            "answer": "$$\\boxed{16.54}$$"
        },
        {
            "introduction": "在掌握了理论推导之后，我们来处理一个更接近实际的问题：如何从实验数据中提取模型参数。在真实的电化学测量（如循环伏安法）中，测得的电流往往是电荷转移和物质传输等多个过程共同作用的结果。本练习将通过一个计算任务，教你如何使用Koutecký-Levich分析方法，从混合电流中分离出纯粹的动力学电流，并最终计算出对温度敏感的电荷转移活化能$E_{a,ct}$。",
            "id": "3955175",
            "problem": "给定一个科学上合理的循环伏安法 (CV) 测量抽象模型，该模型用于研究在多个温度下记录的、发生在电池电极-电解质界面的单电子电荷转移过程。任务是分离由电荷转移动力学和质量输运引起的温度效应，并使用 Arrhenius 分析估算电荷转移的活化能。使用以下基本原理来构建您的方法和程序：\n\n- 在固定电位偏移（过电位）$\\eta$ 和正向扫描过程中的固定测量时间 $t^\\ast$ 下，测得的总电流 $i(T)$ 是动力学电流 $i_k(T)$ 和扩散限制电流 $i_d(T)$ 的调和加和，遵循 Koutecký-Levich 关系：\n$$\n\\frac{1}{i(T)} = \\frac{1}{i_k(T)} + \\frac{1}{i_d(T)}.\n$$\n\n- 在中低过电位下，单电子反应的动力学电流 $i_k(T)$ 由 Butler-Volmer 方程决定：\n$$\ni_k(T) = A \\, i_0(T) \\left[\\exp\\!\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\!\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right],\n$$\n其中 $A$ 是电极面积，$i_0(T)$ 是交换电流密度，$\\alpha$ 是电荷转移对称因子，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n- 在测量时间 $t^\\ast$（在线性扫描期间近似为半无限线性扩散），扩散限制电流 $i_d(T)$ 遵循 Cottrell 型标度关系：\n$$\ni_d(T) = \\frac{n F A c \\sqrt{D(T)}}{\\sqrt{\\pi \\, t^\\ast}},\n$$\n其中 $n$ 是每个反应事件中转移的电子数，$c$ 是可氧化物种的体相浓度，$D(T)$ 是随温度变化的扩散系数。\n\n- 扩散系数 $D(T)$ 遵循 Arrhenius 形式：\n$$\nD(T) = D_0 \\exp\\!\\left(-\\frac{E_{a,D}}{R T}\\right),\n$$\n其中 $D_0$ 是指前因子，$E_{a,D}$ 是扩散活化能。\n\n- 交换电流密度 $i_0(T)$ 遵循 Arrhenius 形式：\n$$\ni_0(T) = i_{00} \\exp\\!\\left(-\\frac{E_{a,ct}}{R T}\\right),\n$$\n其中 $i_{00}$ 是电荷转移的指前因子，$E_{a,ct}$ 是电荷转移的活化能。取自然对数并令 $x = 1/T$，Arrhenius 关系变为线性：\n$$\n\\ln i_0 = \\ln i_{00} - \\frac{E_{a,ct}}{R} x,\n$$\n于是 $\\ln i_0$ 对 $1/T$ 作图的斜率 $m$ 满足 $m = -E_{a,ct}/R$。\n\n您的程序必须：\n- 对于每个测试用例，根据提供的 $D_0$、$E_{a,D}$ 和 $t^\\ast$ 计算 $i_d(T)$，然后使用 Koutecký-Levich 分离法从测量的 $i(T)$ 中获得 $i_k(T)$。\n- 在每个温度 $T$下，使用已知的 $A$、$\\alpha$、$F$、$\\eta$ 和 $R$，对 Butler-Volmer 表达式求逆，从 $i_k(T)$ 中获得 $i_0(T)$。\n- 对 $\\ln i_0(T)$ 与 $1/T$ 进行线性回归，并使用 $E_{a,ct} = - m R$ 计算 $E_{a,ct}$。\n\n所有测试用例通用的常量：\n- 电子数：$n = 1$。\n- 法拉第常数：$F = 96485 \\, \\mathrm{C/mol}$。\n- 普适气体常数：$R = 8.314 \\, \\mathrm{J/(mol \\cdot K)}$。\n- 对称因子：$\\alpha = 0.5$。\n- 过电位：$\\eta = 0.050 \\, \\mathrm{V}$。\n- 电极面积：$A = 1.0 \\times 10^{-4} \\, \\mathrm{m^2}$。\n- 体相浓度：$c = 1000 \\, \\mathrm{mol/m^3}$。\n- 扩散指前因子：$D_0 = 1.0 \\times 10^{-6} \\, \\mathrm{m^2/s}$。\n- 扩散活化能：$E_{a,D} = 15000 \\, \\mathrm{J/mol}$。\n\n测试套件：\n- 温度（所有用例）：$[298.0, 318.0, 338.0] \\, \\mathrm{K}$。\n\n提供在固定 $\\eta$ 和 $t^\\ast$ 下测量的 CV 电流（每个用例三个温度）：\n1. 理想路径（中等质量输运限制），$t^\\ast = 0.50 \\, \\mathrm{s}$：\n   - 测量电流 $i(T)$：$298.0 \\, \\mathrm{K}$ 时为 $0.02728 \\, \\mathrm{A}$，$318.0 \\, \\mathrm{K}$ 时为 $0.07138 \\, \\mathrm{A}$，$338.0 \\, \\mathrm{K}$ 时为 $0.1552 \\, \\mathrm{A}$。\n2. 近动力学控制（短扩散时间），$t^\\ast = 0.050 \\, \\mathrm{s}$：\n   - 测量电流 $i(T)$：$298.0 \\, \\mathrm{K}$ 时为 $0.02873 \\, \\mathrm{A}$，$318.0 \\, \\mathrm{K}$ 时为 $0.08011 \\, \\mathrm{A}$，$338.0 \\, \\mathrm{K}$ 时为 $0.1926 \\, \\mathrm{A}$。\n3. 近扩散控制（长扩散时间），$t^\\ast = 5.00 \\, \\mathrm{s}$：\n   - 测量电流 $i(T)$：$298.0 \\, \\mathrm{K}$ 时为 $0.02359 \\, \\mathrm{A}$，$318.0 \\, \\mathrm{K}$ 时为 $0.05322 \\, \\mathrm{A}$，$338.0 \\, \\mathrm{K}$ 时为 $0.09510 \\, \\mathrm{A}$。\n\n半无限扩散近似和单电子 Butler-Volmer 动力学保证了科学真实性，这两种模型在中小过电位附近的 CV 分析中都经过了充分的检验。\n\n最终答案的单位要求：将每个估算的电荷转移活化能 $E_{a,ct}$ 以 $\\mathrm{kJ/mol}$ 为单位表示为浮点数，并四舍五入到两位小数。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含三个测试用例的结果。结果应按上述顺序排列，以逗号分隔，并用方括号括起来，例如 $[e_1,e_2,e_3]$，其中每个 $e_i$ 是以 $\\mathrm{kJ/mol}$ 为单位、四舍五入到两位小数的活化能。",
            "solution": "我们首先定义电化学动力学和质量输运中的主导关系，这些关系将测量电流与潜在的、随温度变化的材料特性联系起来。在固定过电位 $\\eta$ 和测量时间 $t^\\ast$ 下，测得的总电流 $i(T)$ 同时受到电荷转移动力学（由 Butler-Volmer 描述）和半无限扩散（由 Fick 输运和 Cottrell 标度关系描述）的限制。当两种限制同时作用时，适用 Koutecký-Levich 调和加和：\n$$\n\\frac{1}{i(T)} = \\frac{1}{i_k(T)} + \\frac{1}{i_d(T)}.\n$$\n该恒等式源于考虑与动力学和质量输运过程相关的电阻串联组合：每种机制都提供一个电流限制，这些限制以倒数形式相加，因此净电流小于或等于任一单独的限制电流。\n\n对于单电子反应，在过电位 $\\eta$ 下的动力学电流 $i_k(T)$ 遵循 Butler-Volmer 形式：\n$$\ni_k(T) = A \\, i_0(T) \\left[\\exp\\!\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\!\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right].\n$$\n该表达式源于界面上正向和反向电子转移反应的速率，每个速率都与由热能 $R T$ 归一化的过电位呈指数依赖关系。指前因子 $A \\, i_0(T)$ 表明反应速率与电极面积和交换电流密度 $i_0(T)$ 成正比。\n\n在线性扫描中，在时间 $t^\\ast$ 时，对于体相浓度为 $c$、扩散系数为 $D(T)$ 的电活性物种，其扩散限制电流 $i_d(T)$ 可通过半无限扩散响应（类 Cottrell）来近似：\n$$\ni_d(T) = \\frac{n F A c \\sqrt{D(T)}}{\\sqrt{\\pi \\, t^\\ast}},\n$$\n该式通过求解具有消耗边界条件的半无限域上的 Fick 第二定律，然后通过法拉第定律将摩尔通量转换为电流而得出。\n\n扩散系数 $D(T)$ 通常遵循 Arrhenius 依赖关系：\n$$\nD(T) = D_0 \\exp\\!\\left(-\\frac{E_{a,D}}{R T}\\right),\n$$\n同样地，交换电流密度 $i_0(T)$ 遵循\n$$\ni_0(T) = i_{00} \\exp\\!\\left(-\\frac{E_{a,ct}}{R T}\\right).\n$$\n对后者取自然对数，可得到关于 $x=1/T$ 的线性模型：\n$$\n\\ln i_0 = \\ln i_{00} - \\frac{E_{a,ct}}{R} x,\n$$\n因此，$\\ln i_0$ 对 $1/T$ 的线性回归斜率 $m$ 满足 $m = -E_{a,ct}/R$，从而得到\n$$\nE_{a,ct} = - m R.\n$$\n\n从多个温度下的 CV 数据估算 $E_{a,ct}$ 的算法步骤：\n1. 对于测试用例中的每个温度 $T$，使用已知的 $D_0$ 和 $E_{a,D}$，通过 Arrhenius 形式 $D(T) = D_0 \\exp(-E_{a,D}/(R T))$ 计算 $D(T)$。\n2. 使用给定的 $n$、$F$、$A$、$c$ 和 $t^\\ast$，通过 $i_d(T) = \\dfrac{n F A c \\sqrt{D(T)}}{\\sqrt{\\pi \\, t^\\ast}}$ 计算扩散限制电流 $i_d(T)$。\n3. 使用 Koutecký-Levich 分离法从测量的总电流 $i(T)$ 中恢复动力学电流 $i_k(T)$：\n$$\ni_k(T) = \\frac{1}{\\frac{1}{i(T)} - \\frac{1}{i_d(T)}},\n$$\n该式通过重排调和加和来分离出 $i_k(T)$，其前提是假设 $i_d(T) > i(T)$（这在物理上是一致的，因为净电流不能超过扩散限制值）。\n4. 对 Butler-Volmer 方程求逆以提取 $i_0(T)$：\n$$\ni_0(T) = \\frac{i_k(T)}{A \\left[\\exp\\!\\left(\\frac{\\alpha F \\eta}{R T}\\right) - \\exp\\!\\left(-\\frac{(1-\\alpha) F \\eta}{R T}\\right)\\right]}.\n$$\n右侧的所有量均为已知或已在前面步骤中计算得出。\n5. 对 $y = \\ln i_0(T)$ 与 $x = 1/T$ 进行最小二乘线性回归，以获得斜率 $m$ 和截距。活化能由 $E_{a,ct} = - m R$ 得出。\n6. 将 $E_{a,ct}$ 的单位从 $\\mathrm{J/mol}$ 转换为 $\\mathrm{kJ/mol}$（通过除以 1000），并四舍五入到两位小数。\n\n测试套件的覆盖范围：\n- 理想路径用例（$t^\\ast = 0.50 \\, \\mathrm{s}$）将质量输运和动力学置于可比的量级上，确保了两者的贡献都非常显著。\n- 近动力学控制用例（$t^\\ast = 0.050 \\, \\mathrm{s}$）通过减少扩散时间来增加扩散限制电流，从而将系统推向更接近动力学限制的状态，并测试分离方法的鲁棒性。\n- 近扩散控制用例（$t^\\ast = 5.00 \\, \\mathrm{s}$）通过增加扩散时间来减小扩散限制电流，从而将系统推向更接近扩散限制的状态，并测试当 $i_k(T)$ 远小于 $i_d(T)$ 时算法的稳定性。\n\n数值输出规范：\n- 对于三个测试用例中的每一个，返回一个浮点数，代表以 $\\mathrm{kJ/mol}$ 为单位、四舍五入到两位小数的 $E_{a,ct}$。将这三个浮点数聚合到一个列表中，并以单行打印，格式完全为 $[e_1,e_2,e_3]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_activation_energy_kJmol(temperatures_K, currents_A, t_star_s):\n    # Constants\n    n = 1.0\n    F = 96485.0  # C/mol\n    R = 8.314  # J/(mol*K)\n    alpha = 0.5\n    eta_V = 0.050  # V\n    A_m2 = 1.0e-4  # m^2\n    c_bulk_mol_m3 = 1000.0  # mol/m^3\n    D0_m2_s = 1.0e-6  # m^2/s\n    Ea_D_J_mol = 15000.0  # J/mol\n\n    # Compute i_d(T) for each T using Arrhenius D(T)\n    temps = np.array(temperatures_K, dtype=float)\n    currents = np.array(currents_A, dtype=float)\n\n    D_T = D0_m2_s * np.exp(-Ea_D_J_mol / (R * temps))\n    i_d_T = (n * F * A_m2 * c_bulk_mol_m3 * np.sqrt(D_T)) / np.sqrt(np.pi * t_star_s)\n\n    # Koutecký–Levich separation to get i_k(T)\n    # i_k = 1 / (1/i - 1/i_d)\n    denom = (1.0 / currents) - (1.0 / i_d_T)\n    i_k_T = 1.0 / denom\n\n    # Butler–Volmer inversion to get i0(T)\n    exponent_forward = (alpha * F * eta_V) / (R * temps)\n    exponent_backward = ((1.0 - alpha) * F * eta_V) / (R * temps)\n    g_T = np.exp(exponent_forward) - np.exp(-exponent_backward)\n\n    i0_T = i_k_T / (A_m2 * g_T)\n\n    # Linear regression: ln(i0) vs 1/T\n    x = 1.0 / temps\n    y = np.log(i0_T)\n\n    # Fit y = m*x + b\n    m, b = np.polyfit(x, y, 1)\n\n    # Activation energy for charge transfer: Ea_ct = -m * R [J/mol]\n    Ea_ct_J_mol = -m * R\n    Ea_ct_kJ_mol = Ea_ct_J_mol / 1000.0\n\n    return Ea_ct_kJ_mol\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (temperatures_K, currents_A, t_star_s)\n        ([298.0, 318.0, 338.0], [0.02728, 0.07138, 0.1552], 0.50),\n        ([298.0, 318.0, 338.0], [0.02873, 0.08011, 0.1926], 0.050),\n        ([298.0, 318.0, 338.0], [0.02359, 0.05322, 0.09510], 5.00),\n    ]\n\n    results = []\n    for temperatures_K, currents_A, t_star_s in test_cases:\n        Ea_kJmol = estimate_activation_energy_kJmol(temperatures_K, currents_A, t_star_s)\n        # Round to two decimals as required\n        results.append(f\"{Ea_kJmol:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "参数估计的终点并非只是得到一个最佳拟合值，更重要的是量化我们对这个估计值的不确定性。这个高级练习将引导你进入贝叶斯推断的领域，这是一个强大的统计框架。你将学习如何将来自第一性原理计算（如密度泛函理论，DFT）的先验知识与充满噪声的实验数据相结合，从而不仅推断出活化能$E_a$，还能严格量化其后验分布和置信区间，这代表了现代科学研究中参数化的前沿方法。",
            "id": "3955249",
            "problem": "您的任务是为与电池材料相关的动力学速率的阿伦尼乌斯型温度依赖性，构建并实现一个贝叶斯线性模型。其中，活化能的先验由密度泛函理论（DFT）提供信息。目标是基于带噪声的实验测量数据，推断活化能的后验均值和标准差。\n\n假设一个与温度相关的速率常数 $k(T)$ 服从源自过渡态理论（TST）的阿伦尼乌斯形式：$k(T) = \\nu \\exp\\!\\left(-\\frac{E_a}{k_B T}\\right)$，其中 $E_a$ 是以电子伏特 $\\mathrm{(eV)}$ 为单位的活化能，$\\nu$ 是以 $\\mathrm{s^{-1}}$ 为单位的尝试频率，$T$ 是以开尔文 $\\mathrm{(K)}$ 为单位的温度，$k_B$ 是以 $\\mathrm{eV/K}$ 为单位的玻尔兹曼常数。为了进行计算线性化，定义 $y = \\ln k(T)$ 和 $x = 1/T$，从而得到一个线性模型 $y = a + b\\,x + \\varepsilon$，其中 $a = \\ln \\nu$，$b = -E_a/k_B$，且 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_y^2)$ 代表对数空间中的加性实验噪声。使用 $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n\n您必须构建一个具有高斯先验的贝叶斯模型：\n- 对于 $a = \\ln \\nu$，采用 $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$，其超参数 $(\\mu_a, s_a)$ 将针对每个测试用例提供。\n- 对于 $E_a$，构建一个由DFT信息启发的先验，即 $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$，其中 $\\mu_{\\mathrm{DFT}}$ 和 $s_{\\mathrm{DFT}}$ 分别是根据每个测试用例提供的DFT势垒列表计算出的样本均值和无偏样本标准差（使用贝塞尔校正）。这导出了 $b$ 的先验 $b \\sim \\mathcal{N}(\\mu_b, s_b^2)$，其中 $\\mu_b = -\\mu_{\\mathrm{DFT}}/k_B$ 且 $s_b = s_{\\mathrm{DFT}}/k_B$。\n\n给定一个数据集 $\\{(T_i, y_i)\\}_{i=1}^n$ 和已知的 $\\sigma_y$，将设计矩阵 $X \\in \\mathbb{R}^{n \\times 2}$ 定义为 $X = [\\mathbf{1}, \\mathbf{x}]$，其中第一列是1，第二列是 $x_i = 1/T_i$。设参数矢量为 $\\theta = [a, b]^\\top$。在高斯似然 $y \\mid \\theta \\sim \\mathcal{N}(X\\theta, \\sigma_y^2 I)$ 和高斯先验 $\\theta \\sim \\mathcal{N}(m_0, S_0)$（其中 $m_0 = [\\mu_a, \\mu_b]^\\top$ 且 $S_0 = \\mathrm{diag}(s_a^2, s_b^2)$）的条件下，后验分布也是高斯的：\n$$\nS_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}, \\quad\nm_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top y\\right).\n$$\n转换此后验分布以获得活化能的边缘后验分布：\n$$\nE_a = -k_B\\, b, \\quad E_a \\mid \\text{data} \\sim \\mathcal{N}\\!\\left(-k_B\\, m_{\\text{post},b},\\ k_B^2\\, S_{\\text{post},bb}\\right),\n$$\n其中 $m_{\\text{post},b}$ 和 $S_{\\text{post},bb}$ 分别表示 $m_{\\text{post}}$ 的第二个分量和 $S_{\\text{post}}$ 的 $(2,2)$ 元素。\n\n请实现一个程序，为以下每个测试用例计算并返回 $E_a$ 的后验均值和后验标准差（以电子伏特为单位）。所有输出必须表示为四舍五入到六位小数的十进制浮点数，单位为 $\\mathrm{eV}$。打印输出中不应出现单位。\n\n使用以下测试套件。对于每个用例，输入包括温度列表 $\\{T_i\\}$（单位K）、观测到的速率常数对数 $\\{y_i = \\ln k_i\\}$（无量纲）、已知的对数空间实验噪声标准差 $\\sigma_y$（无量纲）、用于构建 $E_a$ 先验的DFT计算势垒列表（单位eV），以及 $a = \\ln \\nu$ 的先验超参数 $(\\mu_a, s_a)$：\n\n- 用例 $1$（数据约束良好，DFT先验信息适中）：\n  - $T = [\\,280,\\,300,\\,320,\\,340,\\,360\\,]$\n  - $y = [\\,11.3036,\\,12.5186,\\,13.6066,\\,14.5996,\\,15.3976\\,]$\n  - $\\sigma_y = 0.05$\n  - DFT势垒 (单位 $\\mathrm{eV}$): $[\\,0.47,\\,0.52,\\,0.49\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,2.0)$\n\n- 用例 $2$（数据点少，紧凑的DFT先验与数据冲突）：\n  - $T = [\\,300,\\,310\\,]$\n  - $y = [\\,22.2066,\\,22.4306\\,]$\n  - $\\sigma_y = 0.03$\n  - DFT势垒 (单位 $\\mathrm{eV}$): $[\\,0.62,\\,0.58,\\,0.60,\\,0.59\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,1.0)$\n\n- 用例 $3$（数据点多，实验噪声较高）：\n  - $T = [\\,260,\\,280,\\,300,\\,320,\\,340,\\,360,\\,380\\,]$\n  - $y = [\\,14.4056,\\,15.3836,\\,16.3956,\\,17.2616,\\,17.9116,\\,18.6736,\\,19.2356\\,]$\n  - $\\sigma_y = 0.12$\n  - DFT势垒 (单位 $\\mathrm{eV}$): $[\\,0.30,\\,0.36,\\,0.33,\\,0.39\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,2.5)$\n\n- 用例 $4$（数据点非常多，噪声极低，DFT先验紧凑但与数据强烈冲突）：\n  - $T = [\\,260,\\,280,\\,300,\\,320,\\,340,\\,360,\\,380,\\,400\\,]$\n  - $y = [\\,12.0816,\\,13.3506,\\,14.4636,\\,15.4226,\\,16.2866,\\,17.0226,\\,17.7196,\\,18.3276\\,]$\n  - $\\sigma_y = 0.01$\n  - DFT势垒 (单位 $\\mathrm{eV}$): $[\\,0.75,\\,0.72\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,3.0)$\n\n您的程序应针对每个用例计算：\n- $E_a$ 的后验均值（单位 $\\mathrm{eV}$），\n- $E_a$ 的后验标准差（单位 $\\mathrm{eV}$），\n将每个值四舍五入到六位小数，然后将所有结果按用例顺序扁平化为一个列表输出，格式如下：\n$[\\,\\text{mean}_{E_a}^{(1)},\\ \\text{std}_{E_a}^{(1)},\\ \\text{mean}_{E_a}^{(2)},\\ \\text{std}_{E_a}^{(2)},\\ \\text{mean}_{E_a}^{(3)},\\ \\text{std}_{E_a}^{(3)},\\ \\text{mean}_{E_a}^{(4)},\\ \\text{std}_{E_a}^{(4)}\\,]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[\\,\\cdots\\,]$）。所有数值输出必须是四舍五入到六位小数的十进制浮点数，打印输出中不包含任何单位。",
            "solution": "已对用户提供的问题进行分析和验证。\n\n### 第1步：提取给定信息\n- **物理模型**：温度依赖的速率常数 $k(T)$ 服从阿伦尼乌斯方程 $k(T) = \\nu \\exp\\!\\left(-\\frac{E_a}{k_B T}\\right)$。\n- **参数**：$E_a$ 是活化能，单位为 $\\mathrm{eV}$；$\\nu$ 是尝试频率，单位为 $\\mathrm{s^{-1}}$；$T$ 是温度，单位为 $\\mathrm{K}$。\n- **常数**：玻尔兹曼常数 $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n- **线性化模型**：$y = \\ln k(T)$，$x = 1/T$，得到 $y = a + b\\,x + \\varepsilon$，其中 $a = \\ln \\nu$，$b = -E_a/k_B$，且 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_y^2)$。\n- **先验**：\n    - $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$，其中 $(\\mu_a, s_a)$ 已提供。\n    - $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$，其中 $\\mu_{\\mathrm{DFT}}$ 和 $s_{\\mathrm{DFT}}$ 是DFT计算势垒的样本均值和无偏样本标准差。这意味着 $b \\sim \\mathcal{N}(\\mu_b, s_b^2)$，其中 $\\mu_b = -\\mu_{\\mathrm{DFT}}/k_B$ 且 $s_b = s_{\\mathrm{DFT}}/k_B$。\n- **贝叶斯更新方程**：\n    - 令 $\\theta = [a, b]^\\top$，$\\mathbf{y}$ 为观测值向量，$X$ 为设计矩阵。\n    - 先验：$\\theta \\sim \\mathcal{N}(m_0, S_0)$，其中 $m_0 = [\\mu_a, \\mu_b]^\\top$ 且 $S_0 = \\mathrm{diag}(s_a^2, s_b^2)$。\n    - 似然：$\\mathbf{y} \\mid \\theta \\sim \\mathcal{N}(X\\theta, \\sigma_y^2 I)$。\n    - 后验协方差：$S_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}$。\n    - 后验均值：$m_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top \\mathbf{y}\\right)$。\n- **目标量**：$E_a = -k_B b$ 的后验分布。\n    - $E_a \\mid \\text{data} \\sim \\mathcal{N}\\!\\left(-k_B\\, m_{\\text{post},b},\\ k_B^2\\, S_{\\text{post},bb}\\right)$，其中 $m_{\\text{post},b}$ 是 $m_{\\text{post}}$ 的第二个元素，$S_{\\text{post},bb}$ 是 $S_{\\text{post}}$ 的 $(2,2)$ 元素。\n- **数据**：提供了四个测试用例，每个用例都有一组温度 $\\{T_i\\}$、对数速率 $\\{y_i\\}$、噪声 $\\sigma_y$、DFT势垒以及先验超参数 $(\\mu_a, s_a)$。\n- **输出要求**：为每个用例计算 $E_a$ 的后验均值和标准差，四舍五入到六位小数，并以单个扁平化列表的形式呈现。\n\n### 第2步：使用提取的给定信息进行验证\n- **科学基础**：该问题在统计力学（阿伦尼乌斯方程）、统计学（贝叶斯线性回归）和计算材料科学（使用DFT为先验提供信息）方面有坚实的基础。所提供的方程和方法是标准且正确的。\n- **适定性（Well-Posedness）**：该问题是适定的。所有必要的数据、模型和常数都已提供。贝叶斯框架及其先验的使用确保了即使在数据有限的情况下，也存在唯一且稳定的解。\n- **客观性**：问题以精确、客观的数学术语陈述。要求是定量的、明确的。\n- **完整性和一致性**：问题是自洽且内部一致的。没有缺失的参数或相互矛盾的约束。\n\n### 第3步：结论与行动\n该问题是**有效的**。它是贝叶斯推断在物理模型上的一个标准且定义明确的应用。将制定并实施解决方案。\n\n### 求解推导\n\n目标是使用应用于阿伦尼乌斯模型的贝叶斯线性回归框架，计算活化能 $E_a$ 的后验均值和标准差。\n\n**1. 模型构建与线性化**\n阿伦尼乌斯方程描述了速率常数 $k$ 对温度的依赖性：\n$$\nk(T) = \\nu \\exp\\left(-\\frac{E_a}{k_B T}\\right)\n$$\n对两边取自然对数，可将方程线性化：\n$$\n\\ln k(T) = \\ln \\nu - \\frac{E_a}{k_B} \\frac{1}{T}\n$$\n我们为线性模型定义变量：$y = \\ln k(T)$，$x = 1/T$，以及参数 $a = \\ln \\nu$ 和 $b = -E_a/k_B$。在温度 $T_i$ 下，单个带噪声观测值 $y_i$ 的模型为：\n$$\ny_i = a + b x_i + \\varepsilon_i\n$$\n其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2)$ 是高斯噪声。对于一组 $n$ 个观测值，我们使用矩阵表示法：\n$$\n\\mathbf{y} = X\\theta + \\varepsilon\n$$\n其中 $\\mathbf{y} = [y_1, \\dots, y_n]^\\top$，$\\theta = [a, b]^\\top$，$\\varepsilon \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_y^2 I)$，以及 $X$ 是 $n \\times 2$ 的设计矩阵：\n$$\nX = \\begin{bmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_n \\end{bmatrix} = \\begin{bmatrix} 1  1/T_1 \\\\ 1  1/T_2 \\\\ \\vdots  \\vdots \\\\ 1  1/T_n \\end{bmatrix}\n$$\n\n**2. 贝叶斯推断框架**\n给定参数 $\\theta$ 时数据的似然，是一个从噪声模型导出的多元高斯分布：\n$$\np(\\mathbf{y} | \\theta) = \\mathcal{N}(\\mathbf{y} | X\\theta, \\sigma_y^2 I) \\propto \\exp\\left( -\\frac{1}{2\\sigma_y^2} (\\mathbf{y} - X\\theta)^\\top (\\mathbf{y} - X\\theta) \\right)\n$$\n参数矢量 $\\theta$ 的先验分布也是高斯的，$p(\\theta) = \\mathcal{N}(\\theta | m_0, S_0)$，其对角协方差矩阵表明关于 $a$ 和 $b$ 的先验信念是独立的。\n- $a = \\ln \\nu$ 的先验直接给定为 $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$。\n- $b = -E_a/k_B$ 的先验由DFT信息启发的 $E_a$ 先验导出。给定一组DFT计算的活化能，我们计算它们的样本均值 $\\mu_{\\mathrm{DFT}}$ 和无偏样本标准差 $s_{\\mathrm{DFT}}$。$E_a$ 的先验为 $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$。由于 $b$ 是 $E_a$ 的线性变换，其先验也是高斯的：\n    - $b$ 的均值：$\\mu_b = E[-E_a/k_B] = -E[E_a]/k_B = -\\mu_{\\mathrm{DFT}}/k_B$。\n    - $b$ 的方差：$\\mathrm{Var}(b) = \\mathrm{Var}(-E_a/k_B) = (-1/k_B)^2 \\mathrm{Var}(E_a) = s_{\\mathrm{DFT}}^2/k_B^2$。标准差为 $s_b = s_{\\mathrm{DFT}}/k_B$。\n\n因此，$\\theta$ 的先验均值向量和协方差矩阵为：\n$$\nm_0 = \\begin{bmatrix} \\mu_a \\\\ \\mu_b \\end{bmatrix}, \\quad S_0 = \\begin{bmatrix} s_a^2  0 \\\\ 0  s_b^2 \\end{bmatrix}\n$$\n通过贝叶斯定理结合似然和先验，可以得到后验分布 $p(\\theta|\\mathbf{y})$。对于高斯似然和高斯先验，后验也是高斯的，$p(\\theta|\\mathbf{y}) = \\mathcal{N}(\\theta|m_{\\text{post}}, S_{\\text{post}})$。后验参数由以下公式给出：\n$$\nS_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}\n$$\n$$\nm_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top \\mathbf{y}\\right)\n$$\n其中 $S_0^{-1} = \\mathrm{diag}(1/s_a^2, 1/s_b^2)$。\n\n**3. 活化能（$E_a$）的后验分布**\n我们关心的是 $E_a = -k_B b$ 的后验分布。$\\theta$ 的后验是一个二元正态分布。$b$ 的边缘分布是一个一元正态分布，其参数从 $m_{\\text{post}}$ 和 $S_{\\text{post}}$ 中提取：\n$$\nb | \\mathbf{y} \\sim \\mathcal{N}(m_{\\text{post},b}, S_{\\text{post},bb})\n$$\n其中 $m_{\\text{post},b}$ 是均值向量 $m_{\\text{post}}$ 的第二个元素，$S_{\\text{post},bb}$ 是协方差矩阵 $S_{\\text{post}}$ 的 $(2,2)$ 元素。\n应用线性变换 $E_a = -k_B b$ 得到活化能的后验分布：\n- 后验均值：$\\mu_{E_a, \\text{post}} = E[E_a|\\mathbf{y}] = E[-k_B b|\\mathbf{y}] = -k_B E[b|\\mathbf{y}] = -k_B\\, m_{\\text{post},b}$\n- 后验方差：$\\sigma^2_{E_a, \\text{post}} = \\mathrm{Var}(E_a|\\mathbf{y}) = \\mathrm{Var}(-k_B b|\\mathbf{y}) = (-k_B)^2 \\mathrm{Var}(b|\\mathbf{y}) = k_B^2\\, S_{\\text{post},bb}$\n\n后验标准差为 $\\sigma_{E_a, \\text{post}} = \\sqrt{\\sigma^2_{E_a, \\text{post}}} = k_B \\sqrt{S_{\\text{post},bb}}$。\n\n**4. 计算算法**\n对每个测试用例，执行以下步骤：\n1. 初始化玻尔兹曼常数 $k_B$。\n2. 从提供的DFT势垒列表中，计算样本均值 $\\mu_{\\mathrm{DFT}}$ 和无偏样本标准差 $s_{\\mathrm{DFT}}$。\n3. 构建先验均值向量 $m_0 = [\\mu_a, -\\mu_{\\mathrm{DFT}}/k_B]^\\top$ 和先验精度矩阵 $S_0^{-1} = \\mathrm{diag}(1/s_a^2, k_B^2/s_{\\mathrm{DFT}}^2)$。\n4. 根据温度数据 $\\{T_i\\}$ 构建设计矩阵 $X$。\n5. 计算矩阵乘积 $X^\\top X$ 和向量 $X^\\top \\mathbf{y}$。\n6. 计算后验精度矩阵 $P_{\\text{post}} = S_0^{-1} + (\\sigma_y^2)^{-1} X^\\top X$。\n7. 对 $P_{\\text{post}}$ 求逆，得到后验协方差矩阵 $S_{\\text{post}} = P_{\\text{post}}^{-1}$。使用`numpy`中可用的标准线性代数程序进行数值求逆。\n8. 计算后验均值向量 $m_{\\text{post}} = S_{\\text{post}} (S_0^{-1} m_0 + (\\sigma_y^2)^{-1} X^\\top \\mathbf{y})$。\n9. 提取后验均值的第二个分量 $m_{\\text{post},b} = m_{\\text{post}}[1]$ 和后验协方差的 $(2,2)$ 元素 $S_{\\text{post},bb} = S_{\\text{post}}[1,1]$。\n10. 计算最终目标量：$E_a$ 的后验均值为 $-k_B\\, m_{\\text{post},b}$，$E_a$ 的后验标准差为 $k_B \\sqrt{S_{\\text{post},bb}}$。\n11. 按要求将结果四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the posterior mean and standard deviation of activation energy (Ea)\n    for an Arrhenius model using Bayesian linear regression.\n    \"\"\"\n    \n    # Define the Boltzmann constant in eV/K\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"T\": np.array([280, 300, 320, 340, 360]),\n            \"y\": np.array([11.3036, 12.5186, 13.6066, 14.5996, 15.3976]),\n            \"sigma_y\": 0.05,\n            \"dft_barriers\": np.array([0.47, 0.52, 0.49]),\n            \"prior_a_params\": (27.631021, 2.0)\n        },\n        {\n            \"T\": np.array([300, 310]),\n            \"y\": np.array([22.2066, 22.4306]),\n            \"sigma_y\": 0.03,\n            \"dft_barriers\": np.array([0.62, 0.58, 0.60, 0.59]),\n            \"prior_a_params\": (27.631021, 1.0)\n        },\n        {\n            \"T\": np.array([260, 280, 300, 320, 340, 360, 380]),\n            \"y\": np.array([14.4056, 15.3836, 16.3956, 17.2616, 17.9116, 18.6736, 19.2356]),\n            \"sigma_y\": 0.12,\n            \"dft_barriers\": np.array([0.30, 0.36, 0.33, 0.39]),\n            \"prior_a_params\": (27.631021, 2.5)\n        },\n        {\n            \"T\": np.array([260, 280, 300, 320, 340, 360, 380, 400]),\n            \"y\": np.array([12.0816, 13.3506, 14.4636, 15.4226, 16.2866, 17.0226, 17.7196, 18.3276]),\n            \"sigma_y\": 0.01,\n            \"dft_barriers\": np.array([0.75, 0.72]),\n            \"prior_a_params\": (27.631021, 3.0)\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack data for the current case\n        T = case[\"T\"]\n        y = case[\"y\"]\n        sigma_y = case[\"sigma_y\"]\n        dft_barriers = case[\"dft_barriers\"]\n        mu_a, s_a = case[\"prior_a_params\"]\n\n        # 1. Construct the prior distribution for the parameter vector theta = [a, b]^T\n        # Calculate DFT-informed prior for Ea\n        mu_dft = np.mean(dft_barriers)\n        # Use ddof=1 for unbiased sample standard deviation (Bessel's correction)\n        s_dft = np.std(dft_barriers, ddof=1) if len(dft_barriers) > 1 else 0.0\n\n        # Transform prior on Ea to prior on b = -Ea/k_B\n        mu_b = -mu_dft / k_B\n        s_b = s_dft / k_B\n        \n        # Prior mean vector m0 and covariance matrix S0\n        m0 = np.array([mu_a, mu_b])\n        # Note: s_a and s_b are standard deviations, so we square them for the variance\n        S0_inv = np.diag([1 / s_a**2, 1 / s_b**2 if s_b > 0 else 1e12])\n        if s_dft == 0: # Handle zero variance in prior\n             S0_inv[1,1] = 1e12\n\n        # 2. Construct the data-related matrices for the likelihood term\n        # x is the reciprocal temperature\n        x = 1.0 / T\n        # Design matrix X\n        X = np.c_[np.ones_like(x), x]\n\n        # 3. Compute the posterior distribution for theta\n        # Calculate intermediate terms\n        XtX = X.T @ X\n        Xty = X.T @ y\n        \n        # Posterior precision matrix P_post = S0_inv + (1/sigma_y^2) * X^T * X\n        P_post = S0_inv + (1 / sigma_y**2) * XtX\n        \n        # Posterior covariance matrix S_post is the inverse of the posterior precision\n        S_post = np.linalg.inv(P_post)\n        \n        # Posterior mean vector m_post\n        m_post = S_post @ (S0_inv @ m0 + (1 / sigma_y**2) * Xty)\n\n        # 4. Extract posterior distribution for Ea = -k_B * b\n        # Extract marginal posterior mean and variance for b\n        m_post_b = m_post[1]\n        S_post_bb = S_post[1, 1]\n\n        # Transform to posterior mean and standard deviation for Ea\n        mean_Ea = -k_B * m_post_b\n        std_Ea = k_B * np.sqrt(S_post_bb)\n        \n        all_results.extend([mean_Ea, std_Ea])\n\n    # 5. Format and print the final results as a single list\n    print(f\"[{','.join([f'{r:.6f}' for r in all_results])}]\")\n\nsolve()\n```"
        }
    ]
}