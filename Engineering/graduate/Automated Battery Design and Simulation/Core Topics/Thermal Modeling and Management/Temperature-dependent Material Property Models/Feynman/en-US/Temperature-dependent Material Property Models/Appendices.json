{
    "hands_on_practices": [
        {
            "introduction": "The Butler-Volmer equation is a cornerstone of electrochemical kinetics, and the Tafel slope is a key experimental parameter that describes how reaction rates change with voltage. Understanding how the Tafel slope itself changes with temperature is crucial for predicting battery performance and degradation across a range of operating conditions. This exercise  provides foundational practice in deriving such relationships from first principles, connecting the abstract model to concrete, measurable quantities.",
            "id": "3955222",
            "problem": "In automated battery design and simulation for Lithium-ion battery (Li-ion) systems, the electrochemical reaction rate at an electrode is commonly modeled by the Butler–Volmer equation, which captures the dependence of the current density $i$ on the overpotential $\\eta$, temperature $T$, and the charge-transfer coefficient $\\alpha$. Consider a single-step charge-transfer reaction whose kinetics in the Tafel regime are described by the Butler–Volmer relation for large-magnitude overpotentials, and define the Tafel slope magnitude $b(T)$ by the relation between the overpotential and the base-$10$ logarithm of the current density, $b(T) \\equiv \\mathrm{d}\\eta / \\mathrm{d}\\log_{10} i$, evaluated in the appropriate Tafel limit. Assume that the charge-transfer coefficient $\\alpha$ is temperature-independent over the temperature range of interest and that the exchange current density $i_{0}$ may be treated as a prefactor that does not enter the slope expression after differentiation.\n\nStarting from first principles and widely accepted laws, namely:\n- the Butler–Volmer equation for a single-step electron transfer,\n- the definition of the Tafel region as the limit where one exponential term dominates,\n- and the change-of-base formula between $\\ln$ and $\\log_{10}$,\n\nderive the functional dependence of $b(T)$ on temperature $T$ and the charge-transfer coefficient $\\alpha$ in the cathodic Tafel regime. Then, for a graphite negative electrode in a Li-ion cell calibrated at ambient conditions, suppose $\\alpha = 0.42$. Compute the expected change in the Tafel slope magnitude when the temperature is increased from $T_{1} = 298\\ \\mathrm{K}$ to $T_{2} = 333\\ \\mathrm{K}$.\n\nUse the molar gas constant $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$ and the Faraday constant $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$. Express the final change in slope in millivolts per decade (mV per decade). Round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the temperature dependence of the cathodic Tafel slope magnitude from the Butler-Volmer equation and a subsequent calculation of its change over a specified temperature interval.\n\n**Part 1: Derivation of the Tafel Slope Magnitude**\n\nThe Butler–Volmer equation for a single-step, one-electron transfer ($n=1$) reaction is given by:\n$$i = i_{0} \\left[ \\exp\\left(\\frac{(1-\\alpha) F \\eta}{R T}\\right) - \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right) \\right]$$\nwhere $i$ is the net current density, $i_{0}$ is the exchange current density, $\\alpha$ is the charge-transfer coefficient, $\\eta$ is the overpotential, $F$ is the Faraday constant, $R$ is the molar gas constant, and $T$ is the absolute temperature.\n\nThe problem specifies the cathodic Tafel regime, which corresponds to large negative overpotentials ($\\eta \\ll 0$). In this limit, the term $\\exp\\left(\\frac{(1-\\alpha) F \\eta}{R T}\\right)$ approaches zero much faster than the term $\\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$ grows. Therefore, the first exponential term becomes negligible compared to the second. The Butler–Volmer equation simplifies to:\n$$i \\approx -i_{0} \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$$\nHere, the net current density $i$ is negative, indicating a cathodic current. Let us define the magnitude of the cathodic current density as $i_c = -i$, which is a positive quantity. The equation becomes:\n$$i_c = i_{0} \\exp\\left(-\\frac{\\alpha F \\eta}{R T}\\right)$$\nTo find the overpotential $\\eta$ as a function of $i_c$, we rearrange the equation. First, we take the natural logarithm of both sides:\n$$\\ln\\left(\\frac{i_c}{i_0}\\right) = -\\frac{\\alpha F \\eta}{R T}$$\nSolving for $\\eta$:\n$$\\eta = -\\frac{R T}{\\alpha F} \\ln\\left(\\frac{i_c}{i_0}\\right) = -\\frac{R T}{\\alpha F} (\\ln(i_c) - \\ln(i_0))$$\n\nThe problem defines the Tafel slope magnitude using the base-$10$ logarithm, $\\log_{10}$. We use the change-of-base formula, $\\ln(x) = \\ln(10) \\log_{10}(x)$, to convert the expression for $\\eta$:\n$$\\eta = -\\frac{R T \\ln(10)}{\\alpha F} (\\log_{10}(i_c) - \\log_{10}(i_0))$$\nThis can be written as:\n$$\\eta = -\\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_c) + \\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_0)$$\nThe problem defines the Tafel slope as $b(T) \\equiv \\mathrm{d}\\eta / \\mathrm{d}\\log_{10} i$. For the cathodic branch, we differentiate $\\eta$ with respect to $\\log_{10}(i_c)$. The exchange current density $i_0$ is treated as a constant with respect to $i_c$ during differentiation, as per the problem statement.\n$$b_c(T) = \\frac{\\mathrm{d}\\eta}{\\mathrm{d}\\log_{10}(i_c)} = \\frac{\\mathrm{d}}{\\mathrm{d}\\log_{10}(i_c)} \\left( -\\frac{R T \\ln(10)}{\\alpha F} \\log_{10}(i_c) + \\text{constant} \\right)$$\n$$b_c(T) = -\\frac{R T \\ln(10)}{\\alpha F}$$\nThis is the cathodic Tafel slope. The problem asks for the Tafel slope magnitude, which we will denote as $B(T)$. Since $R$, $T$, $\\alpha$, $F$, and $\\ln(10)$ are all positive quantities, the slope $b_c(T)$ is negative. The magnitude is:\n$$B(T) = |b_c(T)| = \\frac{R T \\ln(10)}{\\alpha F}$$\nThis expression shows that the Tafel slope magnitude is directly proportional to the absolute temperature $T$.\n\n**Part 2: Calculation of the Change in Tafel Slope Magnitude**\n\nWe are asked to compute the change in the Tafel slope magnitude, $\\Delta B$, when the temperature increases from $T_1 = 298\\ \\mathrm{K}$ to $T_2 = 333\\ \\mathrm{K}$.\n$$\\Delta B = B(T_2) - B(T_1)$$\nSubstituting the derived expression for $B(T)$:\n$$\\Delta B = \\frac{R T_2 \\ln(10)}{\\alpha F} - \\frac{R T_1 \\ln(10)}{\\alpha F}$$\nFactoring out the common terms:\n$$\\Delta B = \\frac{R \\ln(10)}{\\alpha F} (T_2 - T_1)$$\nNow, we substitute the given values:\n- $R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- $F = 96485.33212\\ \\mathrm{C\\,mol^{-1}}$\n- $\\alpha = 0.42$\n- $T_1 = 298\\ \\mathrm{K}$\n- $T_2 = 333\\ \\mathrm{K}$\n\nThe temperature difference is $\\Delta T = T_2 - T_1 = 333\\ \\mathrm{K} - 298\\ \\mathrm{K} = 35\\ \\mathrm{K}$.\nThe value of the natural logarithm of $10$ is $\\ln(10) \\approx 2.302585$.\nSubstituting these values into the equation for $\\Delta B$:\n$$\\Delta B = \\frac{(8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times \\ln(10) \\times (35\\ \\mathrm{K})}{(0.42) \\times (96485.33212\\ \\mathrm{C\\,mol^{-1}})}$$\nThe units of the calculation are $\\frac{\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\cdot \\mathrm{K}}{\\mathrm{C\\,mol^{-1}}} = \\frac{\\mathrm{J}}{\\mathrm{C}} = \\mathrm{V}$. The result will be in Volts (per decade).\nLet's compute the numerical value:\n$$\\Delta B = \\frac{8.314462618 \\times 2.302585093 \\times 35}{0.42 \\times 96485.33212}$$\n$$\\Delta B = \\frac{670.0678278...}{40523.83949...} \\approx 0.01653528\\ \\mathrm{V\\,decade^{-1}}$$\nThe problem requires the answer to be expressed in millivolts per decade (mV per decade). To convert from Volts to millivolts, we multiply by $1000$:\n$$\\Delta B \\approx 0.01653528 \\times 1000\\ \\mathrm{mV\\,decade^{-1}} \\approx 16.53528\\ \\mathrm{mV\\,decade^{-1}}$$\nFinally, we round the result to four significant figures:\n$$\\Delta B \\approx 16.54\\ \\mathrm{mV\\,decade^{-1}}$$",
            "answer": "$$\\boxed{16.54}$$"
        },
        {
            "introduction": "Moving from analytical models to computer simulations introduces new challenges, especially when dealing with the exponential temperature sensitivity of reaction rates described by the Arrhenius equation. These \"stiff\" equations can destabilize simple numerical solvers, making robust simulation of phenomena like thermal runaway difficult. This practice  offers a hands-on look at the principles of numerical stability, guiding you to derive a criterion that illustrates why advanced time-stepping strategies are essential for accurate and efficient battery simulation.",
            "id": "3955178",
            "problem": "A single control volume in a lithium-ion battery electrode is modeled thermally as lumped and spatially uniform. The thermal energy balance is governed by an ordinary differential equation (ODE),\n$$\n\\rho c \\,\\frac{dT}{dt} \\;=\\; -h\\,(T - T_{\\infty}) \\;+\\; \\dot{q}(T),\n$$\nwhere $T$ is the temperature, $\\rho$ is density, $c$ is specific heat capacity, $h$ is an effective heat transfer coefficient to an ambient at temperature $T_{\\infty}$, and $\\dot{q}(T)$ is a volumetric heat generation rate dominated by a side reaction with Arrhenius temperature dependence,\n$$\n\\dot{q}(T) \\;=\\; H\\,k_0 \\,\\exp\\!\\Big(-\\frac{E_a}{R\\,T}\\Big),\n$$\nwith $H$ the heat of reaction per unit extent, $k_0$ a pre-exponential factor, $E_a$ an activation energy, and $R$ the universal gas constant. This Arrhenius term arises from Solid-Electrolyte Interphase (SEI) decomposition and similar parasitic reactions in cells subject to abuse conditions, a setting common in automated design-and-simulation loops. Consider advancing the temperature with a time integrator that operator-splits heat loss and reaction; in the reaction substep one integrates\n$$\n\\frac{dT}{dt} \\;=\\; f(T) \\;\\equiv\\; \\frac{H\\,k_0}{\\rho c}\\,\\exp\\!\\Big(-\\frac{E_a}{R\\,T}\\Big),\n$$\nwhich captures the most temperature-sensitive part of the dynamics. The goal is to compare an explicit forward Euler update for this reaction substep to an implicit backward Euler update, with attention to stiffness and stability as the dimensionless sensitivity\n$$\n\\theta \\;\\equiv\\; \\frac{E_a}{R\\,T}\n$$\nbecomes large.\n\nStarting from the Arrhenius form and the definition of forward Euler, use first principles to derive a local, state-dependent explicit time-step restriction that ensures the Arrhenius rate $k(T) = k_0 \\exp(-E_a/(R\\,T))$ increases by at most a factor of $2$ over a single explicit substep. Express your restriction in terms of $T$, $f(T)$, $\\theta$, and universal constants, without assuming any specific numerical values for parameters. Then, by comparing this restriction to a practical “reactive timescale” $\\tau_r \\equiv T/f(T)$, propose a criterion that triggers switching to an implicit update whenever the admissible explicit step would be less than a small fraction $\\beta$ of $\\tau_r$ (take $\\beta = 0.05$). Your derivation must begin from the ODE and the Arrhenius law and should not invoke any pre-packaged stability formulas.\n\nWhich of the following decision rules is consistent with that derivation?\n\nA. Use forward Euler for the reaction substep if and only if\n$$\n\\Delta t \\;\\le\\; (\\ln 2)\\,\\frac{R\\,T^2}{E_a\\,f(T)}\n\\quad\\text{and}\\quad\n\\frac{E_a}{R\\,T} \\;\\le\\; \\frac{\\ln 2}{\\beta};\n$$\notherwise, switch to an implicit update.\n\nB. Use forward Euler for the reaction substep if and only if\n$$\n\\Delta t \\;\\le\\; \\frac{2}{\\big|f'(T)\\big|}\n\\quad\\text{and}\\quad\n\\frac{E_a}{R\\,T} \\;\\le\\; \\frac{1}{\\beta};\n$$\notherwise, switch to an implicit update.\n\nC. Use forward Euler for the reaction substep if and only if\n$$\n\\Delta t \\;\\le\\; \\frac{R\\,T^2}{E_a\\,f(T)}\n\\quad\\text{and}\\quad\n\\frac{E_a}{R\\,T} \\;\\le\\; \\frac{1}{(\\ln 2)\\,\\beta};\n$$\notherwise, switch to an implicit update.\n\nD. Use forward Euler for the reaction substep if and only if\n$$\n\\Delta t \\;\\le\\; \\frac{\\ln 2}{\\,f'(T)/f(T)\\,}\n\\quad\\text{and}\\quad\n\\frac{E_a}{R\\,T} \\;\\le\\; \\frac{\\ln 2}{\\beta};\n$$\notherwise, switch to an implicit update.",
            "solution": "The derivation consists of two parts. First, we will derive the explicit time-step restriction based on the constraint on the Arrhenius rate. Second, we will use this restriction to derive a criterion for switching to an implicit method.\n\n**Part 1: Derivation of the Time-Step Restriction**\n\nThe explicit forward Euler method for the reaction substep ODE, $\\frac{dT}{dt} = f(T)$, is given by:\n$$\nT_{n+1} = T_n + \\Delta t \\, f(T_n)\n$$\nFor clarity, we will let $T$ denote the temperature at the beginning of the step, $T_n$, so the updated temperature is $T_{n+1} = T + \\Delta t \\, f(T)$.\n\nThe problem imposes the constraint that the Arrhenius rate, $k(T) = k_0 \\exp(-E_a/(R\\,T))$, increases by at most a factor of $2$ over this single time step. Mathematically, this is:\n$$\nk(T_{n+1}) \\le 2 \\, k(T)\n$$\nSubstituting the expression for $k(T)$:\n$$\nk_0 \\exp\\!\\Big(-\\frac{E_a}{R\\,T_{n+1}}\\Big) \\le 2 \\, k_0 \\exp\\!\\Big(-\\frac{E_a}{R\\,T}\\Big)\n$$\nWe cancel the pre-exponential factor $k_0$ and take the natural logarithm of both sides:\n$$\n-\\frac{E_a}{R\\,T_{n+1}} \\le \\ln(2) - \\frac{E_a}{R\\,T}\n$$\nRearranging the terms to isolate the temperature-dependent parts yields:\n$$\n\\frac{E_a}{R\\,T} - \\frac{E_a}{R\\,T_{n+1}} \\le \\ln(2)\n$$\nFactoring out the term $\\frac{E_a}{R}$ and combining the fractions gives:\n$$\n\\frac{E_a}{R} \\left( \\frac{T_{n+1} - T}{T \\, T_{n+1}} \\right) \\le \\ln(2)\n$$\nFrom the forward Euler update, we know that $T_{n+1} - T = \\Delta t \\, f(T)$. Substituting this into the inequality:\n$$\n\\frac{E_a}{R} \\left( \\frac{\\Delta t \\, f(T)}{T \\, T_{n+1}} \\right) \\le \\ln(2)\n$$\nTo obtain an explicit restriction on $\\Delta t$, we must handle the $T_{n+1}$ term in the denominator. For a single time step to be considered a reasonable approximation of the continuous dynamics, the change in temperature must be small relative to the temperature itself, i.e., $\\Delta T = \\Delta t \\, f(T) \\ll T$. This implies that $T_{n+1} = T + \\Delta T \\approx T$. This is a standard first-order approximation consistent with the accuracy of the forward Euler method itself. Applying this approximation to the denominator, $T \\, T_{n+1} \\approx T^2$, we get:\n$$\n\\frac{E_a}{R} \\left( \\frac{\\Delta t \\, f(T)}{T^2} \\right) \\le \\ln(2)\n$$\nNow, we solve for $\\Delta t$:\n$$\n\\Delta t \\le (\\ln 2) \\, \\frac{R\\,T^2}{E_a\\,f(T)}\n$$\nThis is the required local, state-dependent explicit time-step restriction.\n\n**Part 2: Derivation of the Switching Criterion**\n\nThe problem defines a characteristic \"reactive timescale\" as $\\tau_r \\equiv T/f(T)$. It proposes that an implicit method should be used when the maximum admissible explicit time step, which we denote $\\Delta t_{\\text{max}}$, becomes smaller than a fraction $\\beta$ of this timescale. The condition to switch is thus $\\Delta t_{\\text{max}} < \\beta \\, \\tau_r$. Consequently, the forward Euler method is considered practical to use if and only if the opposite holds:\n$$\n\\Delta t_{\\text{max}} \\ge \\beta \\, \\tau_r\n$$\nSubstituting the expressions for $\\Delta t_{\\text{max}}$ from Part 1 and for $\\tau_r$:\n$$\n(\\ln 2)\\,\\frac{R\\,T^2}{E_a\\,f(T)} \\ge \\beta\\,\\frac{T}{f(T)}\n$$\nWe can cancel the positive term $f(T)$ from both sides. We can also divide by $T$ (as $T$ is an absolute temperature and thus positive):\n$$\n(\\ln 2)\\,\\frac{R\\,T}{E_a} \\ge \\beta\n$$\nTo make this condition a statement about the dimensionless sensitivity $\\theta = E_a/(R\\,T)$, we rearrange the inequality:\n$$\n\\frac{\\ln 2}{\\beta} \\ge \\frac{E_a}{R\\,T} \\quad \\text{or} \\quad \\frac{E_a}{R\\,T} \\le \\frac{\\ln 2}{\\beta}\n$$\nThis inequality provides a threshold for the dimensionless sensitivity: if the sensitivity is too high, the explicit step size required for accuracy becomes impractically small relative to the characteristic timescale of the problem, indicating stiffness.\n\n**Combined Decision Rule**\n\nThe complete decision rule is to use forward Euler if and only if both the chosen time step $\\Delta t$ respects the accuracy limit derived in Part 1, and the problem is not excessively stiff as determined in Part 2. The full condition is:\n$$\n\\Delta t \\le (\\ln 2)\\,\\frac{R\\,T^2}{E_a\\,f(T)} \\quad \\text{and} \\quad \\frac{E_a}{R\\,T} \\le \\frac{\\ln 2}{\\beta}\n$$\n\n**Evaluation of Options**\n\n*   **Option A**: This option states the decision rule is to use forward Euler if $\\Delta t \\le (\\ln 2)\\,\\frac{R\\,T^2}{E_a\\,f(T)}$ and $\\frac{E_a}{R\\,T} \\le \\frac{\\ln 2}{\\beta}$. This exactly matches our derived result.\n    **Verdict: Correct.**\n\n*   **Option B**: This option presents $\\Delta t \\le \\frac{2}{\\big|f'(T)\\big|}$. This is the standard stability limit for forward Euler applied to the linearized problem $y' = \\lambda y$, where $\\lambda = f'(T)$. The problem explicitly disallows invoking such \"pre-packaged\" formulas and demands a derivation from the nonlinear rate constraint. This approach is therefore invalid. Furthermore, the second condition, $\\frac{E_a}{R\\,T} \\le \\frac{1}{\\beta}$, is inconsistent with the time-step limit provided.\n    **Verdict: Incorrect.**\n\n*   **Option C**: This option gives $\\Delta t \\le \\frac{R\\,T^2}{E_a\\,f(T)}$, which is missing the factor of $\\ln 2$. This result would be obtained from an inaccurate linearization of the exponential constraint. The second condition, $\\frac{E_a}{R\\,T} \\le \\frac{1}{(\\ln 2)\\,\\beta}$, is inconsistent with the first part.\n    **Verdict: Incorrect.**\n\n*   **Option D**: The time-step restriction $\\Delta t \\le \\frac{\\ln 2}{\\,f'(T)/f(T)\\,}$ is dimensionally and factually incorrect as it is missing a factor of $1/f(T)$. While the second part of the condition is correct, the first part is fundamentally flawed.\n    **Verdict: Incorrect.**\n\nBased on a rigorous derivation from first principles as requested, only Option A is correct.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A critical step in building predictive battery simulations is populating models with accurate parameters, like activation energies. This often requires a sophisticated fusion of information from first-principles calculations (like DFT) and noisy experimental measurements. This exercise  guides you through a modern Bayesian inference workflow to achieve this, allowing you to quantify the uncertainty in your estimated parameters. Mastering this technique is key to building models that are not only predictive but also honest about their confidence.",
            "id": "3955249",
            "problem": "You are tasked with formulating and implementing a Bayesian linear model for an Arrhenius-type temperature dependence of a kinetic rate relevant to battery materials, with a prior on the activation energy informed by Density Functional Theory (DFT). The target is to infer the posterior mean and standard deviation of the activation energy based on noisy experimental measurements.\n\nAssume that a temperature-dependent rate constant $k(T)$ follows the Arrhenius form derived from Transition State Theory (TST): $k(T) = \\nu \\exp\\!\\left(-\\frac{E_a}{k_B T}\\right)$, where $E_a$ is the activation energy in electronvolts $\\mathrm{(eV)}$, $\\nu$ is the attempt frequency in $\\mathrm{s^{-1}}$, $T$ is temperature in Kelvin $\\mathrm{(K)}$, and $k_B$ is the Boltzmann constant in $\\mathrm{eV/K}$. For computational linearization, define $y = \\ln k(T)$ and $x = 1/T$ to obtain a linear model $y = a + b\\,x + \\varepsilon$, where $a = \\ln \\nu$, $b = -E_a/k_B$, and $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_y^2)$ represents additive experimental noise in log-space. Use $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$.\n\nYou must construct a Bayesian model with Gaussian priors:\n- For $a = \\ln \\nu$, adopt $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$ with hyperparameters $(\\mu_a, s_a)$ provided per test case.\n- For $E_a$, form a DFT-informed prior as $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$, where $\\mu_{\\mathrm{DFT}}$ and $s_{\\mathrm{DFT}}$ are the sample mean and unbiased sample standard deviation (with Bessel’s correction) computed from the provided DFT barrier list for each test case. This induces the prior $b \\sim \\mathcal{N}(\\mu_b, s_b^2)$, where $\\mu_b = -\\mu_{\\mathrm{DFT}}/k_B$ and $s_b = s_{\\mathrm{DFT}}/k_B$.\n\nGiven a dataset $\\{(T_i, y_i)\\}_{i=1}^n$ with known $\\sigma_y$, define the design matrix $X \\in \\mathbb{R}^{n \\times 2}$ as $X = [\\mathbf{1}, \\mathbf{x}]$, where the first column is ones and the second column is $x_i = 1/T_i$. Let the parameter vector be $\\theta = [a, b]^\\top$. With the Gaussian likelihood $y \\mid \\theta \\sim \\mathcal{N}(X\\theta, \\sigma_y^2 I)$ and Gaussian prior $\\theta \\sim \\mathcal{N}(m_0, S_0)$ with $m_0 = [\\mu_a, \\mu_b]^\\top$ and $S_0 = \\mathrm{diag}(s_a^2, s_b^2)$, the posterior distribution is Gaussian:\n$$\nS_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}, \\quad\nm_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top y\\right).\n$$\nTransform this posterior to obtain the marginal posterior for the activation energy:\n$$\nE_a = -k_B\\, b, \\quad E_a \\mid \\text{data} \\sim \\mathcal{N}\\!\\left(-k_B\\, m_{\\text{post},b},\\ k_B^2\\, S_{\\text{post},bb}\\right),\n$$\nwhere $m_{\\text{post},b}$ and $S_{\\text{post},bb}$ denote the second component of $m_{\\text{post}}$ and the $(2,2)$ element of $S_{\\text{post}}$, respectively.\n\nImplement a program that, for each of the following test cases, computes and returns the posterior mean and posterior standard deviation of $E_a$ in electronvolts. All outputs must be expressed in $\\mathrm{eV}$ as decimal floats rounded to six decimal places. No units should appear in the printed output.\n\nUse the following test suite. For each case, the inputs include the temperature list $\\{T_i\\}$ in $\\mathrm{K}$, the observed logarithms of rate constants $\\{y_i = \\ln k_i\\}$ (dimensionless), the known experimental noise standard deviation in log-space $\\sigma_y$ (dimensionless), a list of DFT-calculated barriers in $\\mathrm{eV}$ used to construct the prior on $E_a$, and the prior hyperparameters $(\\mu_a, s_a)$ for $a = \\ln \\nu$:\n\n- Case $1$ (well-constrained data, moderately informative DFT prior):\n  - $T = [\\,280,\\,300,\\,320,\\,340,\\,360\\,]$\n  - $y = [\\,11.3036,\\,12.5186,\\,13.6066,\\,14.5996,\\,15.3976\\,]$\n  - $\\sigma_y = 0.05$\n  - DFT barriers (in $\\mathrm{eV}$): $[\\,0.47,\\,0.52,\\,0.49\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,2.0)$\n\n- Case $2$ (few points, tight DFT prior conflicting with data):\n  - $T = [\\,300,\\,310\\,]$\n  - $y = [\\,22.2066,\\,22.4306\\,]$\n  - $\\sigma_y = 0.03$\n  - DFT barriers (in $\\mathrm{eV}$): $[\\,0.62,\\,0.58,\\,0.60,\\,0.59\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,1.0)$\n\n- Case $3$ (more points, higher experimental noise):\n  - $T = [\\,260,\\,280,\\,300,\\,320,\\,340,\\,360,\\,380\\,]$\n  - $y = [\\,14.4056,\\,15.3836,\\,16.3956,\\,17.2616,\\,17.9116,\\,18.6736,\\,19.2356\\,]$\n  - $\\sigma_y = 0.12$\n  - DFT barriers (in $\\mathrm{eV}$): $[\\,0.30,\\,0.36,\\,0.33,\\,0.39\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,2.5)$\n\n- Case $4$ (many points, very low noise, strongly conflicting but tight DFT prior):\n  - $T = [\\,260,\\,280,\\,300,\\,320,\\,340,\\,360,\\,380,\\,400\\,]$\n  - $y = [\\,12.0816,\\,13.3506,\\,14.4636,\\,15.4226,\\,16.2866,\\,17.0226,\\,17.7196,\\,18.3276\\,]$\n  - $\\sigma_y = 0.01$\n  - DFT barriers (in $\\mathrm{eV}$): $[\\,0.75,\\,0.72\\,]$\n  - $(\\mu_a, s_a) = (27.631021,\\,3.0)$\n\nYour program should, for each case, compute:\n- the posterior mean of $E_a$ in $\\mathrm{eV}$,\n- the posterior standard deviation of $E_a$ in $\\mathrm{eV}$,\nround each to six decimal places, and then output all results flattened into a single list, ordered by cases, as\n$[\\,\\text{mean}_{E_a}^{(1)},\\ \\text{std}_{E_a}^{(1)},\\ \\text{mean}_{E_a}^{(2)},\\ \\text{std}_{E_a}^{(2)},\\ \\text{mean}_{E_a}^{(3)},\\ \\text{std}_{E_a}^{(3)},\\ \\text{mean}_{E_a}^{(4)},\\ \\text{std}_{E_a}^{(4)}\\,]$.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\cdots\\,]$).",
            "solution": "The user-provided problem has been analyzed and validated.\n\n### Step 1: Extract Givens\n- **Physical Model**: The temperature-dependent rate constant $k(T)$ follows the Arrhenius equation $k(T) = \\nu \\exp\\!\\left(-\\frac{E_a}{k_B T}\\right)$.\n- **Parameters**: $E_a$ is activation energy in $\\mathrm{eV}$, $\\nu$ is attempt frequency in $\\mathrm{s^{-1}}$, $T$ is temperature in $\\mathrm{K}$.\n- **Constant**: Boltzmann constant $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$.\n- **Linearized Model**: $y = \\ln k(T)$, $x = 1/T$, yielding $y = a + b\\,x + \\varepsilon$, where $a = \\ln \\nu$, $b = -E_a/k_B$, and $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_y^2)$.\n- **Priors**:\n    - $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$, with $(\\mu_a, s_a)$ provided.\n    - $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$, where $\\mu_{\\mathrm{DFT}}$ and $s_{\\mathrm{DFT}}$ are the sample mean and unbiased sample standard deviation of DFT-calculated barriers. This implies $b \\sim \\mathcal{N}(\\mu_b, s_b^2)$ where $\\mu_b = -\\mu_{\\mathrm{DFT}}/k_B$ and $s_b = s_{\\mathrm{DFT}}/k_B$.\n- **Bayesian Update Equations**:\n    - Let $\\theta = [a, b]^\\top$, $\\mathbf{y}$ be the vector of observations, and $X$ be the design matrix.\n    - Prior: $\\theta \\sim \\mathcal{N}(m_0, S_0)$ with $m_0 = [\\mu_a, \\mu_b]^\\top$ and $S_0 = \\mathrm{diag}(s_a^2, s_b^2)$.\n    - Likelihood: $\\mathbf{y} \\mid \\theta \\sim \\mathcal{N}(X\\theta, \\sigma_y^2 I)$.\n    - Posterior Covariance: $S_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}$.\n    - Posterior Mean: $m_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top \\mathbf{y}\\right)$.\n- **Target Quantity**: Posterior distribution of $E_a = -k_B b$.\n    - $E_a \\mid \\text{data} \\sim \\mathcal{N}\\!\\left(-k_B\\, m_{\\text{post},b},\\ k_B^2\\, S_{\\text{post},bb}\\right)$, where $m_{\\text{post},b}$ is the second element of $m_{\\text{post}}$ and $S_{\\text{post},bb}$ is the $(2,2)$ element of $S_{\\text{post}}$.\n- **Data**: Four test cases are provided, each with a set of temperatures $\\{T_i\\}$, log-rates $\\{y_i\\}$, noise $\\sigma_y$, DFT barriers, and prior hyperparameters $(\\mu_a, s_a)$.\n- **Output Requirement**: Compute the posterior mean and standard deviation of $E_a$ for each case, rounded to six decimal places, and present them in a single flattened list.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in statistical mechanics (Arrhenius equation), statistics (Bayesian linear regression), and computational materials science (use of DFT to inform priors). The provided equations and methodology are standard and correct.\n- **Well-Posedness**: The problem is well-posed. All necessary data, models, and constants are provided. The Bayesian framework, with its use of priors, ensures a unique and stable solution exists even for cases with limited data.\n- **Objectivity**: The problem is stated in precise, objective mathematical terms. The requirements are quantitative and unambiguous.\n- **Completeness and Consistency**: The problem is self-contained and internally consistent. There are no missing parameters or contradictory constraints.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard and well-defined application of Bayesian inference to a physical model. A solution will be formulated and implemented.\n\n### Solution Derivation\n\nThe objective is to compute the posterior mean and standard deviation of the activation energy, $E_a$, using a Bayesian linear regression framework applied to the Arrhenius model.\n\n**1. Model Formulation and Linearization**\nThe Arrhenius equation describes the temperature dependence of a rate constant $k$:\n$$\nk(T) = \\nu \\exp\\left(-\\frac{E_a}{k_B T}\\right)\n$$\nTaking the natural logarithm of both sides linearizes the equation:\n$$\n\\ln k(T) = \\ln \\nu - \\frac{E_a}{k_B} \\frac{1}{T}\n$$\nWe define the variables for a linear model: $y = \\ln k(T)$, $x = 1/T$, and the parameters $a = \\ln \\nu$ and $b = -E_a/k_B$. The model for a single noisy observation $y_i$ at temperature $T_i$ is:\n$$\ny_i = a + b x_i + \\varepsilon_i\n$$\nwhere $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2)$ is Gaussian noise. For a set of $n$ observations, we use matrix notation:\n$$\n\\mathbf{y} = X\\theta + \\varepsilon\n$$\nwhere $\\mathbf{y} = [y_1, \\dots, y_n]^\\top$, $\\theta = [a, b]^\\top$, $\\varepsilon \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_y^2 I)$, and $X$ is the $n \\times 2$ design matrix:\n$$\nX = \\begin{bmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_n \\end{bmatrix} = \\begin{bmatrix} 1 & 1/T_1 \\\\ 1 & 1/T_2 \\\\ \\vdots & \\vdots \\\\ 1 & 1/T_n \\end{bmatrix}\n$$\n\n**2. Bayesian Inference Framework**\nThe likelihood of the data given the parameters $\\theta$ is a multivariate Gaussian distribution derived from the noise model:\n$$\np(\\mathbf{y} | \\theta) = \\mathcal{N}(\\mathbf{y} | X\\theta, \\sigma_y^2 I) \\propto \\exp\\left( -\\frac{1}{2\\sigma_y^2} (\\mathbf{y} - X\\theta)^\\top (\\mathbf{y} - X\\theta) \\right)\n$$\nThe prior distribution for the parameter vector $\\theta$ is also Gaussian, $p(\\theta) = \\mathcal{N}(\\theta | m_0, S_0)$, with a diagonal covariance matrix indicating that the prior beliefs about $a$ and $b$ are independent.\n- The prior for $a = \\ln \\nu$ is given directly as $a \\sim \\mathcal{N}(\\mu_a, s_a^2)$.\n- The prior for $b = -E_a/k_B$ is derived from the DFT-informed prior on $E_a$. Given a set of DFT-calculated activation energies, we compute their sample mean $\\mu_{\\mathrm{DFT}}$ and unbiased sample standard deviation $s_{\\mathrm{DFT}}$. The prior on $E_a$ is $E_a \\sim \\mathcal{N}(\\mu_{\\mathrm{DFT}}, s_{\\mathrm{DFT}}^2)$. Since $b$ is a linear transformation of $E_a$, its prior is also Gaussian:\n    - Mean of $b$: $\\mu_b = E[-E_a/k_B] = -E[E_a]/k_B = -\\mu_{\\mathrm{DFT}}/k_B$.\n    - Variance of $b$: $\\mathrm{Var}(b) = \\mathrm{Var}(-E_a/k_B) = (-1/k_B)^2 \\mathrm{Var}(E_a) = s_{\\mathrm{DFT}}^2/k_B^2$. The standard deviation is $s_b = s_{\\mathrm{DFT}}/k_B$.\n\nThe prior mean vector and covariance matrix for $\\theta$ are thus:\n$$\nm_0 = \\begin{bmatrix} \\mu_a \\\\ \\mu_b \\end{bmatrix}, \\quad S_0 = \\begin{bmatrix} s_a^2 & 0 \\\\ 0 & s_b^2 \\end{bmatrix}\n$$\nThe posterior distribution $p(\\theta|\\mathbf{y})$ is found by combining the likelihood and prior via Bayes' theorem. For a Gaussian likelihood and Gaussian prior, the posterior is also Gaussian, $p(\\theta|\\mathbf{y}) = \\mathcal{N}(\\theta|m_{\\text{post}}, S_{\\text{post}})$. The posterior parameters are given by:\n$$\nS_{\\text{post}} = \\left(S_0^{-1} + \\frac{1}{\\sigma_y^2} X^\\top X\\right)^{-1}\n$$\n$$\nm_{\\text{post}} = S_{\\text{post}} \\left(S_0^{-1} m_0 + \\frac{1}{\\sigma_y^2} X^\\top \\mathbf{y}\\right)\n$$\nwhere $S_0^{-1} = \\mathrm{diag}(1/s_a^2, 1/s_b^2)$.\n\n**3. Posterior Distribution of Activation Energy ($E_a$)**\nOur interest is in the posterior distribution of $E_a = -k_B b$. The posterior for $\\theta$ is a bivariate normal distribution. The marginal distribution for $b$ is a univariate normal distribution with parameters extracted from $m_{\\text{post}}$ and $S_{\\text{post}}$:\n$$\nb | \\mathbf{y} \\sim \\mathcal{N}(m_{\\text{post},b}, S_{\\text{post},bb})\n$$\nwhere $m_{\\text{post},b}$ is the second element of the mean vector $m_{\\text{post}}$, and $S_{\\text{post},bb}$ is the $(2,2)$ element of the covariance matrix $S_{\\text{post}}$.\nApplying the linear transformation $E_a = -k_B b$ yields the posterior distribution for the activation energy:\n- Posterior Mean: $\\mu_{E_a, \\text{post}} = E[E_a|\\mathbf{y}] = E[-k_B b|\\mathbf{y}] = -k_B E[b|\\mathbf{y}] = -k_B\\, m_{\\text{post},b}$\n- Posterior Variance: $\\sigma^2_{E_a, \\text{post}} = \\mathrm{Var}(E_a|\\mathbf{y}) = \\mathrm{Var}(-k_B b|\\mathbf{y}) = (-k_B)^2 \\mathrm{Var}(b|\\mathbf{y}) = k_B^2\\, S_{\\text{post},bb}$\n\nThe posterior standard deviation is $\\sigma_{E_a, \\text{post}} = \\sqrt{\\sigma^2_{E_a, \\text{post}}} = k_B \\sqrt{S_{\\text{post},bb}}$.\n\n**4. Computational Algorithm**\nFor each test case, the following procedure is executed:\n1.  Initialize the Boltzmann constant $k_B$.\n2.  From the provided DFT barrier list, compute the sample mean $\\mu_{\\mathrm{DFT}}$ and unbiased sample standard deviation $s_{\\mathrm{DFT}}$.\n3.  Construct the prior mean vector $m_0 = [\\mu_a, -\\mu_{\\mathrm{DFT}}/k_B]^\\top$ and the prior precision matrix $S_0^{-1} = \\mathrm{diag}(1/s_a^2, k_B^2/s_{\\mathrm{DFT}}^2)$.\n4.  Construct the design matrix $X$ from the temperature data $\\{T_i\\}$.\n5.  Compute the matrix product $X^\\top X$ and the vector $X^\\top \\mathbf{y}$.\n6.  Calculate the posterior precision matrix $P_{\\text{post}} = S_0^{-1} + (\\sigma_y^2)^{-1} X^\\top X$.\n7.  Invert $P_{\\text{post}}$ to obtain the posterior covariance matrix $S_{\\text{post}} = P_{\\text{post}}^{-1}$. The numerical inversion is performed using standard linear algebra routines available in `numpy`.\n8.  Calculate the posterior mean vector $m_{\\text{post}} = S_{\\text{post}} (S_0^{-1} m_0 + (\\sigma_y^2)^{-1} X^\\top \\mathbf{y})$.\n9.  Extract the second component of the posterior mean, $m_{\\text{post},b} = m_{\\text{post}}[1]$, and the $(2,2)$ element of the posterior covariance, $S_{\\text{post},bb} = S_{\\text{post}}[1,1]$.\n10. Compute the final target quantities: the posterior mean of $E_a$ as $-k_B\\, m_{\\text{post},b}$ and the posterior standard deviation of $E_a$ as $k_B \\sqrt{S_{\\text{post},bb}}$.\n11. Round the results to six decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the posterior mean and standard deviation of activation energy (Ea)\n    for an Arrhenius model using Bayesian linear regression.\n    \"\"\"\n    \n    # Define the Boltzmann constant in eV/K\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"T\": np.array([280, 300, 320, 340, 360]),\n            \"y\": np.array([11.3036, 12.5186, 13.6066, 14.5996, 15.3976]),\n            \"sigma_y\": 0.05,\n            \"dft_barriers\": np.array([0.47, 0.52, 0.49]),\n            \"prior_a_params\": (27.631021, 2.0)\n        },\n        {\n            \"T\": np.array([300, 310]),\n            \"y\": np.array([22.2066, 22.4306]),\n            \"sigma_y\": 0.03,\n            \"dft_barriers\": np.array([0.62, 0.58, 0.60, 0.59]),\n            \"prior_a_params\": (27.631021, 1.0)\n        },\n        {\n            \"T\": np.array([260, 280, 300, 320, 340, 360, 380]),\n            \"y\": np.array([14.4056, 15.3836, 16.3956, 17.2616, 17.9116, 18.6736, 19.2356]),\n            \"sigma_y\": 0.12,\n            \"dft_barriers\": np.array([0.30, 0.36, 0.33, 0.39]),\n            \"prior_a_params\": (27.631021, 2.5)\n        },\n        {\n            \"T\": np.array([260, 280, 300, 320, 340, 360, 380, 400]),\n            \"y\": np.array([12.0816, 13.3506, 14.4636, 15.4226, 16.2866, 17.0226, 17.7196, 18.3276]),\n            \"sigma_y\": 0.01,\n            \"dft_barriers\": np.array([0.75, 0.72]),\n            \"prior_a_params\": (27.631021, 3.0)\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack data for the current case\n        T = case[\"T\"]\n        y = case[\"y\"]\n        sigma_y = case[\"sigma_y\"]\n        dft_barriers = case[\"dft_barriers\"]\n        mu_a, s_a = case[\"prior_a_params\"]\n\n        # 1. Construct the prior distribution for the parameter vector theta = [a, b]^T\n        # Calculate DFT-informed prior for Ea\n        mu_dft = np.mean(dft_barriers)\n        # Use ddof=1 for unbiased sample standard deviation (Bessel's correction)\n        s_dft = np.std(dft_barriers, ddof=1) if len(dft_barriers) > 1 else 0.0\n\n        # Transform prior on Ea to prior on b = -Ea/k_B\n        mu_b = -mu_dft / k_B\n        s_b = s_dft / k_B\n        \n        # Prior mean vector m0 and covariance matrix S0\n        m0 = np.array([mu_a, mu_b])\n        # Note: s_a and s_b are standard deviations, so we square them for the variance\n        S0 = np.diag([s_a**2, s_b**2])\n        # Inverse of prior covariance (prior precision)\n        S0_inv = np.diag([1 / s_a**2, 1 / s_b**2] if s_a > 0 and s_b > 0 else [1/s_a**2, np.inf if s_b == 0 else 1/s_b**2])\n        if s_b == 0: S0_inv[1,1] = 1e12 # A large number to approximate infinite precision\n\n        # 2. Construct the data-related matrices for the likelihood term\n        # x is the reciprocal temperature\n        x = 1.0 / T\n        # Design matrix X\n        X = np.c_[np.ones_like(x), x]\n\n        # 3. Compute the posterior distribution for theta\n        # Calculate intermediate terms\n        XtX = X.T @ X\n        Xty = X.T @ y\n        \n        # Posterior precision matrix P_post = S0_inv + (1/sigma_y^2) * X^T * X\n        P_post = S0_inv + (1 / sigma_y**2) * XtX\n        \n        # Posterior covariance matrix S_post is the inverse of the posterior precision\n        S_post = np.linalg.inv(P_post)\n        \n        # Posterior mean vector m_post\n        m_post = S_post @ (S0_inv @ m0 + (1 / sigma_y**2) * Xty)\n\n        # 4. Extract posterior distribution for Ea = -k_B * b\n        # Extract marginal posterior mean and variance for b\n        m_post_b = m_post[1]\n        S_post_bb = S_post[1, 1]\n\n        # Transform to posterior mean and standard deviation for Ea\n        mean_Ea = -k_B * m_post_b\n        std_Ea = k_B * np.sqrt(S_post_bb)\n        \n        all_results.extend([mean_Ea, std_Ea])\n\n    # 5. Format and print the final results as a single list\n    print(f\"[{','.join([f'{r:.6f}' for r in all_results])}]\")\n\nsolve()\n```"
        }
    ]
}