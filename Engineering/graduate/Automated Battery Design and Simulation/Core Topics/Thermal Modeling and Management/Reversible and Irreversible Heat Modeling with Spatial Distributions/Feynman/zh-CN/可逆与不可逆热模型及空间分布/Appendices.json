{
    "hands_on_practices": [
        {
            "introduction": "动手实践的第一步是建立物理直觉。在进行复杂的空间分辨模拟之前，通过无量纲数分析来快速评估电池的主要热行为是一项基本技能。本练习将引导你计算傅里叶数 ($Fo$)、毕渥数 ($Bi$) 和热源比率 ($\\Pi$)，并利用它们来判断电池内部的温度分布以及可逆热与不可逆热的相对重要性。",
            "id": "3946816",
            "problem": "考虑一个正在恒流放电的方形锂离子软包电池。关注中等荷电状态下沿厚度方向的传热与产热。以下性能参数和工作条件是典型电芯的代表，并假设在所关注的时间段内，这些参数在空间上是均匀的，在时间上是恒定的。\n\n几何形状与热传输：\n- 沿厚度方向的平板厚度为 $H = 6 \\times 10^{-3} \\ \\mathrm{m}$，对于一维平板热传导，特征长度为 $L = H/2 = 3 \\times 10^{-3} \\ \\mathrm{m}$。\n- 沿厚度方向的导热系数为 $k = 0.8 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}$。\n- 密度为 $\\rho = 2400 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，等温比热容为 $c_{p} = 900 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$，因此热扩散率为 $\\alpha = k/(\\rho c_{p})$。\n- 宽面上的对流换热系数为 $h = 15 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-1}$。\n- 考虑一个持续时间为 $t = 60 \\ \\mathrm{s}$ 的放电窗口，初始温度均匀且等于环境温度，并视外部对流为空间均匀的。\n\n电化学产热：\n- 放电电流为 $I = 20 \\ \\mathrm{A}$。\n- 直流内阻（集总参数，包括当前工作点下的欧姆和电荷转移贡献）为 $R = 2.5 \\times 10^{-2} \\ \\Omega$。\n- 在指定的荷电状态下，熵系数（开路电位(OCP)的温度导数，也称为可逆电化学电位）为 $\\partial U_{\\mathrm{ocp}}/\\partial T = -4 \\times 10^{-4} \\ \\mathrm{V} \\ \\mathrm{K}^{-1}$，并假设在时间窗口内为常数。\n- 环境温度和电芯初始温度为 $T = 298 \\ \\mathrm{K}$。\n\n从平板热传导的热力学第一定律、瞬态对流传热的无量纲输运数组的定义，以及电化学产热分解为不可逆（焦耳）和可逆（熵）分量出发，完成以下任务：\n\n1. 推导适用于上述一维平板几何形状和对流边界的傅里叶数 $Fo$ 和毕渥数 $Bi$ 的表达式，并使用所给参数计算它们的值。\n2. 将可逆产热与不可逆产热的无量纲比值 $\\Pi$ 定义为可逆产热速率的绝对值除以不可逆产热速率，并根据给定的工作条件计算其值。\n3. 根据 $Fo$、$Bi$ 和 $\\Pi$ 的量级，简要解释在何种情况下可逆热相比不可逆热占主导地位或可忽略不计，以及沿厚度方向的空间温度分布预计将如何表现。\n\n将 $Fo$、$Bi$ 和 $\\Pi$ 的最终数值以单行向量的形式报告，并将每个值四舍五入到四位有效数字。这些是无量纲量，报告时无需单位。",
            "solution": "首先验证问题，以确保其科学基础可靠、设定合理且客观。\n\n### 步骤1：提取已知条件\n- 平板厚度：$H = 6 \\times 10^{-3} \\ \\mathrm{m}$\n- 特征长度：$L = H/2 = 3 \\times 10^{-3} \\ \\mathrm{m}$\n- 导热系数：$k = 0.8 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}$\n- 密度：$\\rho = 2400 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n- 比热容：$c_{p} = 900 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n- 热扩散率：$\\alpha = k/(\\rho c_{p})$\n- 对流换热系数：$h = 15 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-1}$\n- 持续时间：$t = 60 \\ \\mathrm{s}$\n- 放电电流：$I = 20 \\ \\mathrm{A}$\n- 内阻：$R = 2.5 \\times 10^{-2} \\ \\Omega$\n- 熵系数：$\\partial U_{\\mathrm{ocp}}/\\partial T = -4 \\times 10^{-4} \\ \\mathrm{V} \\ \\mathrm{K}^{-1}$\n- 环境温度和初始温度：$T = 298 \\ \\mathrm{K}$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它使用了标准的热传导方程以及成熟的电化学产热模型（焦耳热和熵热）。所有给定的物理和电化学参数都在方形锂离子电芯的实际范围内。问题设定合理，因为计算所需的无量纲数所需的所有信息都已提供。语言客观且精确。问题是完整的、一致的且可行的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n***\n\n### 1. 傅里叶数 ($Fo$) 和毕渥数 ($Bi$)\n\n毕渥数 $Bi$ 是一个无量纲数，表示热量传递的内部导热热阻与外部对流换热热阻之比。对于特征长度为 $L$ 的平板，其定义为：\n$$Bi = \\frac{hL}{k}$$\n其中 $h$ 是对流换热系数，$L$ 是特征长度（对于对称平板为半厚度），$k$ 是导热系数。\n\n代入给定值：\n$h = 15 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-1}$\n$L = 3 \\times 10^{-3} \\ \\mathrm{m}$\n$k = 0.8 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}$\n\n我们计算毕渥数：\n$$Bi = \\frac{(15)(3 \\times 10^{-3})}{0.8} = \\frac{0.045}{0.8} = 0.05625$$\n\n傅里叶数 $Fo$ 是一个表征非稳态热传导的无量纲数。它表示热传导速率与体积元中热能储存速率之比。其定义为：\n$$Fo = \\frac{\\alpha t}{L^2}$$\n其中 $\\alpha$ 是热扩散率，$t$ 是时间，$L$ 是特征长度。热扩散率 $\\alpha$ 定义为 $\\alpha = k/(\\rho c_{p})$。\n\n首先，我们计算热扩散率 $\\alpha$：\n$\\rho = 2400 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n$c_{p} = 900 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$\n$k = 0.8 \\ \\mathrm{W} \\ \\mathrm{m}^{-1} \\ \\mathrm{K}^{-1}$\n$$\\alpha = \\frac{k}{\\rho c_{p}} = \\frac{0.8}{(2400)(900)} = \\frac{0.8}{2160000} \\approx 3.7037 \\times 10^{-7} \\ \\mathrm{m^2 s^{-1}}$$\n\n现在，我们可以使用 $t = 60 \\ \\mathrm{s}$ 和 $L = 3 \\times 10^{-3} \\ \\mathrm{m}$ 计算傅里叶数：\n$$Fo = \\frac{\\alpha t}{L^2} = \\frac{(3.7037 \\times 10^{-7})(60)}{(3 \\times 10^{-3})^2} = \\frac{2.2222 \\times 10^{-5}}{9 \\times 10^{-6}} \\approx 2.4691358$$\n\n四舍五入到四位有效数字，$Fo = 2.469$，$Bi = 0.05625$。\n\n### 2. 可逆热与不可逆热的无量纲比值 ($\\Pi$)\n\n总电化学产热速率 $\\dot{Q}_{\\mathrm{gen}}$ 是不可逆（焦耳）产热速率和可逆（熵）产热速率之和：$\\dot{Q}_{\\mathrm{gen}} = \\dot{Q}_{\\mathrm{irr}} + \\dot{Q}_{\\mathrm{rev}}$。\n\n不可逆产热速率 $\\dot{Q}_{\\mathrm{irr}}$ 是由电流通过电芯内阻产生的焦耳热：\n$$\\dot{Q}_{\\mathrm{irr}} = I^2 R$$\n当 $I = 20 \\ \\mathrm{A}$ 且 $R = 2.5 \\times 10^{-2} \\ \\Omega$ 时：\n$$\\dot{Q}_{\\mathrm{irr}} = (20)^2 (2.5 \\times 10^{-2}) = (400)(0.025) = 10 \\ \\mathrm{W}$$\n\n可逆产热速率 $\\dot{Q}_{\\mathrm{rev}}$ 是由电化学反应的熵变引起的。它由下式给出：\n$$\\dot{Q}_{\\mathrm{rev}} = -I \\cdot T \\cdot \\frac{\\partial U_{\\mathrm{ocp}}}{\\partial T}$$\n符号约定为正值表示产热。当 $I = 20 \\ \\mathrm{A}$，$T = 298 \\ \\mathrm{K}$，且 $\\partial U_{\\mathrm{ocp}}/\\partial T = -4 \\times 10^{-4} \\ \\mathrm{V} \\ \\mathrm{K}^{-1}$ 时：\n$$\\dot{Q}_{\\mathrm{rev}} = -(20)(298)(-4 \\times 10^{-4}) = (20)(298)(4 \\times 10^{-4}) = 2.384 \\ \\mathrm{W}$$\n由于 $\\dot{Q}_{\\mathrm{rev}}$ 为正，因此在这些条件下（放电），可逆反应是放热的。\n\n问题将无量纲比值 $\\Pi$ 定义为可逆产热速率的绝对值除以不可逆产热速率：\n$$\\Pi = \\frac{|\\dot{Q}_{\\mathrm{rev}}|}{\\dot{Q}_{\\mathrm{irr}}}$$\n代入计算出的值：\n$$\\Pi = \\frac{|2.384|}{10} = 0.2384$$\n\n四舍五入到四位有效数字，$\\Pi = 0.2384$。\n\n### 3. 物理诠释\n\n计算出的无量纲数为了解电芯的热行为提供了洞见。\n\n- **毕渥数 ($Bi = 0.05625$)**：毕渥数很小 ($Bi \\ll 0.1$)。这表明电芯内部的导热热阻远小于从电芯表面到周围环境的对流换热热阻。因此，预计沿电芯厚度方向的温度梯度将非常小。该电芯可以被精确地近似为一个“集总电容”系统，其温度在任何给定时刻在空间上都是均匀的。\n\n- **傅里叶数 ($Fo \\approx 2.469$)**：傅里叶数大于一 ($Fo > 1$)。这表明放电持续时间 ($t = 60 \\ \\mathrm{s}$) 足够长，热量可以扩散到整个电芯半厚度。热响应已超越了初始的瞬态渗透期，并正在接近准稳态。温度分布已充分发展，并由产热和边界条件决定，而不是由初始的均匀温度主导。\n\n- **产热比 ($\\Pi = 0.2384$)**：该值表明可逆（熵）产热速率约占不可逆（焦耳）产热速率的 $23.8\\%$。这是一个显著的贡献。虽然焦耳热是主要的产热来源，但忽略可逆热将导致总产热量被低估近四分之一。因此，为了在这些工作条件下对该电芯进行精确的热建模，必须包括这两种产热机制。对于这个特定情况（放电，负熵系数），可逆热是放热的，它会叠加在焦耳热之上，加速温度上升。\n\n总而言之，预计电芯会升温，且其厚度方向上的温度分布接近均匀。温度上升是显著的，因为时间尺度允许了大量的产热和热扩散 ($Fo > 1$)，并且总产热是占主导地位的焦耳热和不可忽略的熵热项之和。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.469  0.05625  0.2384 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了宏观评估方法后，我们深入到电极微观尺度，对热源的空间分布进行建模。本计算练习的核心是应用 Butler-Volmer 方程来模拟由电化学反应动力学引起的不均匀不可逆热生成，并量化其对温度的敏感性。这对于理解和预测电池内部“热点”的形成机制至关重要。",
            "id": "3946867",
            "problem": "考虑一个一维多孔电极域，其空间坐标为 $x \\in [0,L]$。目标是使用巴特勒-沃尔默（Butler–Volmer）关系计算体积反应电流密度 $i_{\\mathrm{rxn}}(x)$，并量化不可逆反应热密度 $q_{\\mathrm{rxn}}(x)$ 对交换电流密度的阿伦尼乌斯（Arrhenius）温度依赖性的灵敏度。采用以下科学依据。\n\n- 局部界面电流密度 $i_{\\mathrm{ct}}(x)$ 的巴特勒-沃尔默方程为\n$$\ni_{\\mathrm{ct}}(x) = i_0(x)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta(x)}{R T(x)}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta(x)}{R T(x)}\\right)\\right],\n$$\n其中 $i_0(x)$ 是交换电流密度，$\\alpha_a$ 是阳极电荷转移系数，$\\alpha_c$ 是阴极电荷转移系数，$F$ 是法拉第常数，$R$ 是普适气体常数，$T(x)$ 是局部绝对温度，$\\eta(x)$ 是局部过电势。体积反应电流密度为\n$$\ni_{\\mathrm{rxn}}(x) = a_s \\, i_{\\mathrm{ct}}(x),\n$$\n其中 $a_s$ 是比界面面积（单位体积的表面积）。\n\n- 不可逆反应热密度建模为\n$$\nq_{\\mathrm{rxn}}(x) = i_{\\mathrm{rxn}}(x)\\,\\eta(x),\n$$\n单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}$，因为 $i_{\\mathrm{rxn}}(x)$ 的单位是 $\\mathrm{A}\\,\\mathrm{m}^{-3}$，$\\eta(x)$ 的单位是 $\\mathrm{V}$。\n\n- 交换电流密度遵循阿伦尼乌斯温度依赖性和浓度标度关系：\n$$\ni_0(x; E_a) = i_{0,\\mathrm{ref}} \\left(\\frac{c_e(x)}{c_{\\mathrm{ref}}}\\right)^{\\nu} \\exp\\!\\left[-\\frac{E_a}{R}\\left(\\frac{1}{T(x)} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right],\n$$\n其中 $E_a$ 是活化能，$i_{0,\\mathrm{ref}}$ 是在参考温度 $T_{\\mathrm{ref}}$ 和参考浓度 $c_{\\mathrm{ref}}$ 下的交换电流密度，$c_e(x)$ 是局部电解质浓度，$\\nu$ 是反应级数指数。\n\n- 过电势定义为\n$$\n\\eta(x) = \\phi_s(x) - \\phi_e(x) - U,\n$$\n其中 $\\phi_s(x)$ 是局部固相电势，$\\phi_e(x)$ 是局部液相电势，$U$ 是开路电势，在本问题中视为常数。虽然电池中的可逆热（熵热）通常建模为 $q_{\\mathrm{rev}}(x) = i_{\\mathrm{rxn}}(x)\\,T(x)\\,\\frac{\\partial U}{\\partial T}$，但本任务侧重于由电荷转移动力学引起的不可逆反应热 $q_{\\mathrm{rxn}}(x)$。\n\n您的程序必须：\n1. 使用足够精细的均匀网格对 $x \\in [0,L]$ 进行离散化，以确保数值稳定性和空间积分的准确性。\n2. 对每个测试用例，计算基准活化能 $E_a$ 下的 $i_{\\mathrm{rxn}}(x)$ 和 $q_{\\mathrm{rxn}}(x)$，然后使用中心有限差分和小的微扰 $\\Delta E_a$ 来量化 $q_{\\mathrm{rxn}}(x)$ 对 $E_a$ 的灵敏度：\n$$\nS(x) \\approx \\frac{q_{\\mathrm{rxn}}(x; E_a + \\Delta E_a) - q_{\\mathrm{rxn}}(x; E_a - \\Delta E_a)}{2\\,\\Delta E_a},\n$$\n其单位为 $\\mathrm{W}\\,\\mathrm{m}^{-3}$ 每 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n3. 报告通过数值积分计算出的 $q_{\\mathrm{rxn}}(x)$ 的空间平均值和 $S(x)$ 的空间平均值：\n$$\n\\overline{q}_{\\mathrm{rxn}} = \\frac{1}{L}\\int_{0}^{L} q_{\\mathrm{rxn}}(x)\\,\\mathrm{d}x,\\quad\n\\overline{S} = \\frac{1}{L}\\int_{0}^{L} S(x)\\,\\mathrm{d}x.\n$$\n以国际单位制（SI）基本单位表示 $\\overline{q}_{\\mathrm{rxn}}$（单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}$）和 $\\overline{S}$（单位 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,(\\mathrm{J}\\,\\mathrm{mol}^{-1})^{-1}$）。\n\n所有测试用例中使用的常数：\n- 法拉第常数 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n- 普适气体常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 阳极电荷转移系数 $\\alpha_a = 0.5$。\n- 阴极电荷转移系数 $\\alpha_c = 0.5$。\n- 比界面面积 $a_s = 10^5\\,\\mathrm{m}^2\\,\\mathrm{m}^{-3}$。\n- 参考交换电流密度 $i_{0,\\mathrm{ref}} = 3\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n- 参考浓度 $c_{\\mathrm{ref}} = 1000\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 参考温度 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。\n- 反应级数指数 $\\nu = 0.5$。\n- 开路电势 $U = 4.0\\,\\mathrm{V}$。\n\n在每个测试用例中，通过过电势 $\\eta(x)$ 定义电解质浓度 $c_e(x)$、温度 $T(x)$ 以及电势 $\\phi_s(x)$ 和 $\\phi_e(x)$ 的空间分布如下：\n\n- 测试用例 1（一般情况）：\n  - 域长度 $L = 1\\times 10^{-4}\\,\\mathrm{m}$。\n  - 电解质浓度分布：\n    $$\n    c_e(x) = c_{\\mathrm{ref}}\\left[1 + 0.1 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right].\n    $$\n  - 温度分布：\n    $$\n    T(x) = T_{\\mathrm{ref}} + 10\\left(\\frac{x}{L}\\right)\\,\\mathrm{K}.\n    $$\n  - 过电势分布：\n    $$\n    \\eta(x) = 0.05\\left[1 + 0.2 \\cos\\left(\\frac{2\\pi x}{L}\\right)\\right]\\,\\mathrm{V}.\n    $$\n  - 活化能 $E_a = 3.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n  - 微扰 $\\Delta E_a = 5.0\\times 10^{2}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n- 测试用例 2（小过电势下的近线性区域）：\n  - 域长度 $L = 1\\times 10^{-4}\\,\\mathrm{m}$。\n  - 电解质浓度分布：\n    $$\n    c_e(x) = c_{\\mathrm{ref}}\\left[1 - 0.2\\left(\\frac{x}{L}\\right)\\right].\n    $$\n  - 温度分布：\n    $$\n    T(x) = T_{\\mathrm{ref}}.\n    $$\n  - 过电势分布：\n    $$\n    \\eta(x) = 0.001\\left[1 + 0.5 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]\\,\\mathrm{V}.\n    $$\n  - 活化能 $E_a = 4.0\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n  - 微扰 $\\Delta E_a = 5.0\\times 10^{2}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n- 测试用例 3（更高过电势和更强温度梯度）：\n  - 域长度 $L = 2\\times 10^{-4}\\,\\mathrm{m}$。\n  - 电解质浓度分布：\n    $$\n    c_e(x) = c_{\\mathrm{ref}}\\left[1 + 0.3 \\cos\\left(\\frac{\\pi x}{L}\\right)\\right].\n    $$\n  - 温度分布：\n    $$\n    T(x) = T_{\\mathrm{ref}} + 20 \\sin\\left(\\frac{\\pi x}{L}\\right)\\,\\mathrm{K}.\n    $$\n  - 过电势分布：\n    $$\n    \\eta(x) = 0.2\\left[1 - 0.3 \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]\\,\\mathrm{V}.\n    $$\n  - 活化能 $E_a = 3.5\\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n  - 微扰 $\\Delta E_a = 5.0\\times 10^{2}\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n计算要求：\n- 使用均匀网格，每 $L=10^{-4}\\,\\mathrm{m}$ 至少有 $N=1000$ 个点；随 $L$ 线性缩放 $N$，使得空间步长 $\\Delta x$ 在所有测试用例中保持不变。\n- 对于基准 $E_a$，计算 $i_0(x;E_a)$、$i_{\\mathrm{ct}}(x)$、$i_{\\mathrm{rxn}}(x)$ 和 $q_{\\mathrm{rxn}}(x)$，并使用 $\\Delta E_a$ 通过中心差分计算 $S(x)$。\n- 使用梯形法则等数值积分法在 $x$ 上计算 $\\overline{q}_{\\mathrm{rxn}}$ 和 $\\overline{S}$。\n\n输出：\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为\n$$\n\\left[\\overline{q}_{\\mathrm{rxn},1},\\,\\overline{S}_1,\\,\\overline{q}_{\\mathrm{rxn},2},\\,\\overline{S}_2,\\,\\overline{q}_{\\mathrm{rxn},3},\\,\\overline{S}_3\\right].\n$$\n所有条目必须是实数（浮点数）。单位：对于测试用例 $k$，$\\overline{q}_{\\mathrm{rxn},k}$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-3}$，$\\overline{S}_k$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,(\\mathrm{J}\\,\\mathrm{mol}^{-1})^{-1}$。",
            "solution": "所述问题在科学上是合理的、自洽的且适定的。所用的物理模型和参数在电化学工程和电池模拟领域是标准的。具体来说，使用巴特勒-沃尔默方程描述反应动力学，使用阿伦尼乌斯定律描述交换电流密度的温度依赖性，以及不可逆反应热的定义，都是该领域的基石。所提供的空间分布函数在数学上是明确的，在物理上是合理的，允许直接且无歧义的计算解。因此，可以推导出一个解。\n\n该解决方案是通过为每个测试用例遵循一系列明确定义的计算步骤来算法化构建的。\n\n1.  **空间离散化**：将一维域 $x \\in [0, L]$ 离散化为一个均匀网格。问题要求网格密度对于长度 $L=10^{-4}\\,\\mathrm{m}$ 至少为 $1000$ 个点，并且该密度随 $L$ 线性缩放。为满足此要求，选择一个恒定的空间步长 $\\Delta x = 10^{-7}\\,\\mathrm{m}$。对于长度为 $L$ 的域，这将产生 $N = \\lfloor L/\\Delta x \\rfloor + 1$ 个网格点。例如，对于 $L=10^{-4}\\,\\mathrm{m}$，这将得到 $N=1001$ 个点。空间网格坐标由 $x_i = i \\cdot \\Delta x$ 给出，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n\n2.  **热密度分布的核心计算**：设计一个模块化函数来计算不可逆热密度 $q_{\\mathrm{rxn}}(x; E_a)$ 的空间分布，该函数是活化能 $E_a$ 和测试用例参数的函数。此函数遍历每个网格点 $x_i$ 并执行以下计算序列：\n    a.  **局部状态的评估**：使用给定测试用例的指定函数形式，确定电解质浓度 $c_e(x_i)$、温度 $T(x_i)$ 和过电势 $\\eta(x_i)$ 的局部值。\n    b.  **交换电流密度计算**：使用提供的阿伦尼乌斯和浓度依赖关系计算交换电流密度 $i_0(x_i; E_a)$：\n        $$\n        i_0(x_i; E_a) = i_{0,\\mathrm{ref}} \\left(\\frac{c_e(x_i)}{c_{\\mathrm{ref}}}\\right)^{\\nu} \\exp\\!\\left[-\\frac{E_a}{R}\\left(\\frac{1}{T(x_i)} - \\frac{1}{T_{\\mathrm{ref}}}\\right)\\right]\n        $$\n    c.  **电荷转移电流密度计算**：然后使用巴特勒-沃尔默方程找到局部界面电流密度 $i_{\\mathrm{ct}}(x_i)$：\n        $$\n        i_{\\mathrm{ct}}(x_i) = i_0(x_i; E_a)\\left[\\exp\\left(\\frac{\\alpha_a F \\eta(x_i)}{R T(x_i)}\\right) - \\exp\\left(-\\frac{\\alpha_c F \\eta(x_i)}{R T(x_i)}\\right)\\right]\n        $$\n    d.  **体积电流与热密度计算**：最后，计算体积反应电流密度 $i_{\\mathrm{rxn}}(x_i) = a_s \\, i_{\\mathrm{ct}}(x_i)$ 和不可逆热生成密度 $q_{\\mathrm{rxn}}(x_i; E_a) = i_{\\mathrm{rxn}}(x_i)\\,\\eta(x_i)$。\n    此函数返回一个数值数组，表示在离散域上的分布 $q_{\\mathrm{rxn}}(x; E_a)$。\n\n3.  **灵敏度分布计算**：对于每个测试用例，使用二阶中心有限差分来近似计算关于活化能 $E_a$ 的灵敏度分布 $S(x)$。此方法在准确性和计算成本之间提供了良好的平衡。它需要对热密度分布进行三次评估：\n    - 在 $E_a$ 下的基准评估，得到 $q_{\\mathrm{rxn}}(x; E_a)$。\n    - 在 $E_a + \\Delta E_a$ 下的微扰评估，得到 $q_{\\mathrm{rxn}}(x; E_a + \\Delta E_a)$。\n    - 在 $E_a - \\Delta E_a$ 下的微扰评估，得到 $q_{\\mathrm{rxn}}(x; E_a - \\Delta E_a)$。\n    然后，每个网格点 $x_i$ 的灵敏度计算如下：\n    $$\n    S(x_i) = \\frac{q_{\\mathrm{rxn}}(x_i; E_a + \\Delta E_a) - q_{\\mathrm{rxn}}(x_i; E_a - \\Delta E_a)}{2\\,\\Delta E_a}\n    $$\n\n4.  **通过数值积分进行空间平均**：通过对其各自的分布在域 $[0, L]$上进行数值积分并除以长度 $L$ 来计算空间平均量 $\\overline{q}_{\\mathrm{rxn}}$ 和 $\\overline{S}$。为此积分实现了梯形法则，因为它是对均匀网格上数据的标准且稳健的方法。公式为：\n    $$\n    \\overline{q}_{\\mathrm{rxn}} = \\frac{1}{L}\\int_{0}^{L} q_{\\mathrm{rxn}}(x; E_a)\\,\\mathrm{d}x \\approx \\frac{1}{L} \\sum_{i=1}^{N-1} \\frac{q_{\\mathrm{rxn}}(x_i; E_a) + q_{\\mathrm{rxn}}(x_{i-1}; E_a)}{2} \\Delta x\n    $$\n    $$\n    \\overline{S} = \\frac{1}{L}\\int_{0}^{L} S(x)\\,\\mathrm{d}x \\approx \\frac{1}{L} \\sum_{i=1}^{N-1} \\frac{S(x_i) + S(x_{i-1})}{2} \\Delta x\n    $$\n    `scipy.integrate.trapezoid` 函数为此数值积分法提供了直接且高效的实现。\n\n5.  **迭代执行与最终输出**：从网格生成到空间平均的整个过程，会对三个指定的测试用例中的每一个执行。将得到的六个标量值 $\\{\\overline{q}_{\\mathrm{rxn},k}, \\overline{S}_k\\}_{k=1}^3$ 整理到一个列表中，并格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the battery heat modeling problem for three test cases.\n    \"\"\"\n\n    # Define physical and model constants\n    constants = {\n        'F': 96485.0,  # Faraday constant (C/mol)\n        'R': 8.314,    # Universal gas constant (J/mol/K)\n        'alpha_a': 0.5, # Anodic charge-transfer coefficient\n        'alpha_c': 0.5, # Cathodic charge-transfer coefficient\n        'a_s': 1e5,    # Specific interfacial area (m^2/m^3)\n        'i0_ref': 3.0,   # Reference exchange current density (A/m^2)\n        'c_ref': 1000.0, # Reference concentration (mol/m^3)\n        'T_ref': 298.0,  # Reference temperature (K)\n        'nu': 0.5      # Reaction order exponent\n    }\n\n    # Define the three test cases\n    test_cases = [\n        {\n            'L': 1e-4, 'E_a': 3.0e4, 'delta_E_a': 5.0e2,\n            'c_e_func': lambda x, L, c_ref: c_ref * (1 + 0.1 * np.sin(2 * np.pi * x / L)),\n            'T_func':   lambda x, L, T_ref: T_ref + 10 * (x / L),\n            'eta_func': lambda x, L: 0.05 * (1 + 0.2 * np.cos(2 * np.pi * x / L))\n        },\n        {\n            'L': 1e-4, 'E_a': 4.0e4, 'delta_E_a': 5.0e2,\n            'c_e_func': lambda x, L, c_ref: c_ref * (1 - 0.2 * (x / L)),\n            'T_func':   lambda x, L, T_ref: T_ref * np.ones_like(x),\n            'eta_func': lambda x, L: 0.001 * (1 + 0.5 * np.sin(2 * np.pi * x / L))\n        },\n        {\n            'L': 2e-4, 'E_a': 3.5e4, 'delta_E_a': 5.0e2,\n            'c_e_func': lambda x, L, c_ref: c_ref * (1 + 0.3 * np.cos(np.pi * x / L)),\n            'T_func':   lambda x, L, T_ref: T_ref + 20 * np.sin(np.pi * x / L),\n            'eta_func': lambda x, L: 0.2 * (1 - 0.3 * np.sin(2 * np.pi * x / L))\n        }\n    ]\n\n    final_results = []\n    for case in test_cases:\n        avg_q_rxn, avg_S = run_simulation_case(case, constants)\n        final_results.extend([avg_q_rxn, avg_S])\n\n    print(f\"[{','.join(map(str, final_results))}]\")\n\n\ndef calculate_q_rxn_profile(E_a, x_grid, case_params, consts):\n    \"\"\"\n    Calculates the spatial profile of the irreversible reaction heat density.\n    \"\"\"\n    L = case_params['L']\n    c_e_func = case_params['c_e_func']\n    T_func = case_params['T_func']\n    eta_func = case_params['eta_func']\n    \n    # Unpack constants for easier access\n    R, F, alpha_a, alpha_c = consts['R'], consts['F'], consts['alpha_a'], consts['alpha_c']\n    a_s, i0_ref, c_ref, T_ref, nu = consts['a_s'], consts['i0_ref'], consts['c_ref'], consts['T_ref'], consts['nu']\n    \n    # Evaluate spatial profiles of concentration, temperature, and overpotential\n    c_e_x = c_e_func(x_grid, L, c_ref)\n    T_x = T_func(x_grid, L, T_ref)\n    eta_x = eta_func(x_grid, L)\n    \n    # Calculate exchange current density i0(x) using Arrhenius relation\n    # Note: Handle T(x) == T_ref to avoid potential 0/0 issues if not careful, though 1/T-1/T_ref handles it.\n    temp_term = np.exp(-E_a / R * (1.0/T_x - 1.0/T_ref))\n    i0_x = i0_ref * (c_e_x / c_ref)**nu * temp_term\n    \n    # Calculate charge-transfer current density i_ct(x) using Butler-Volmer equation\n    exp_arg = F * eta_x / (R * T_x)\n    ict_x = i0_x * (np.exp(alpha_a * exp_arg) - np.exp(-alpha_c * exp_arg))\n    \n    # Calculate volumetric reaction current density i_rxn(x)\n    irxn_x = a_s * ict_x\n    \n    # Calculate irreversible reaction heat density q_rxn(x)\n    q_rxn_x = irxn_x * eta_x\n    \n    return q_rxn_x\n\ndef run_simulation_case(case_params, consts):\n    \"\"\"\n    Runs the simulation for a single test case to find average heat and sensitivity.\n    \"\"\"\n    L = case_params['L']\n    E_a = case_params['E_a']\n    delta_E_a = case_params['delta_E_a']\n    \n    # Set up the spatial grid with a constant step size\n    dx = 1e-7  # m\n    num_points = int(L / dx) + 1\n    x_grid = np.linspace(0, L, num_points)\n    \n    # Calculate q_rxn for the baseline activation energy\n    q_rxn_baseline = calculate_q_rxn_profile(E_a, x_grid, case_params, consts)\n    \n    # Calculate q_rxn for perturbed activation energies for sensitivity analysis\n    q_rxn_plus = calculate_q_rxn_profile(E_a + delta_E_a, x_grid, case_params, consts)\n    q_rxn_minus = calculate_q_rxn_profile(E_a - delta_E_a, x_grid, case_params, consts)\n    \n    # Calculate the sensitivity profile S(x) using a central finite difference\n    S_x = (q_rxn_plus - q_rxn_minus) / (2 * delta_E_a)\n    \n    # Use the trapezoidal rule for numerical integration to find the spatial average\n    avg_q_rxn = trapezoid(q_rxn_baseline, x_grid) / L\n    avg_S = trapezoid(S_x, x_grid) / L\n    \n    return avg_q_rxn, avg_S\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "最后一个实践练习将不同来源的不可逆性整合到一个统一的框架中，即非平衡热力学。你将通过计算电流传导、多组分质量输运和电化学反应产生的总熵产密度图，来绘制电池内部的“不可逆性地图”。这种方法能够最根本地识别和量化电池的能量损失区域，为先进的电池设计和优化提供直接指导。",
            "id": "3946833",
            "problem": "考虑一个在均匀笛卡尔网格上表示的二维电极域，其空间坐标为 $(x,y)$，厚度为 $h$。根据测试用例的规定，该系统是等温或弱非等温的。目标是计算由电传导、多组分质量输运和电化学反应不可逆性引起的局部熵产生密度图 $\\sigma(x,y)$，然后识别出不可逆性最高的区域。程序必须从非平衡热力学的框架出发，实现一个有原则的模型：熵产生是通过将通量与其共轭热力学力的乘积求和得到的。您必须仅使用以下基本关系来推导和实现每个贡献的计算：\n- 电传导：对于电导率为 $\\kappa$ 的各向同性介质，电流密度 $\\boldsymbol{J}$ 与电场 $\\boldsymbol{E}$ 的关系为 $\\boldsymbol{J} = \\kappa \\boldsymbol{E}$，这意味着 $\\boldsymbol{J} \\cdot \\boldsymbol{E} = \\|\\boldsymbol{J}\\|^2 / \\kappa$。\n- 质量输运的线性不可逆热力学：对于每个组分 $i$，其通量 $\\boldsymbol{N}_i$ 与其热力学驱动力 $-\\nabla \\mu_i$ 成正比，唯象系数为 $L_i$，使得 $\\boldsymbol{N}_i = L_i \\, (-\\nabla \\mu_i)$。这意味着局部耗散为 $\\boldsymbol{N}_i \\cdot (-\\nabla \\mu_i) = \\|\\boldsymbol{N}_i\\|^2 / L_i$。\n- 界面处的电化学反应不可逆性（按体积分布）：局部体积法拉第速率 $r_F$ 乘以过电势 $\\eta$ 得到体积不可逆功率 $r_F \\eta$。\n\n局部熵产生密度 $\\sigma(x,y)$ 必须计算为这些贡献的总和除以绝对温度 $T(x,y)$：\n$$\n\\sigma(x,y) = \\frac{1}{T(x,y)} \\left[ \\frac{\\|\\boldsymbol{J}(x,y)\\|^2}{\\kappa(x,y)} + \\sum_{i} \\frac{\\|\\boldsymbol{N}_i(x,y)\\|^2}{L_i(x,y)} + r_F(x,y)\\,\\eta(x,y) \\right].\n$$\n此外，局部不可逆生热密度 $q_{\\text{irrev}}(x,y)$ 由 $q_{\\text{irrev}}(x,y) = T(x,y)\\,\\sigma(x,y)$ 给出，而与反应的熵贡献相关的可逆热密度 $q_{\\text{rev}}(x,y)$ 为\n$$\nq_{\\text{rev}}(x,y) = T(x,y)\\, r_F(x,y)\\, \\frac{dU}{dT}(x,y),\n$$\n其中 $U$ 是平衡开路电势。请注意，$q_{\\text{rev}}(x,y)$ 对 $\\sigma(x,y)$ 没有贡献，因为可逆过程不产生熵；它被包含进来是为了模型的完整性，但您对不可逆性的识别必须基于 $\\sigma(x,y)$。\n\n您的程序必须：\n- 为每个测试用例在均匀网格上构建指定的场 $\\boldsymbol{J}(x,y)$、$\\eta(x,y)$、$\\boldsymbol{N}_i(x,y)$、$T(x,y)$、$\\kappa(x,y)$、$L_i(x,y)$、$r_F(x,y)$ 和 $\\frac{dU}{dT}(x,y)$。\n- 计算局部熵产生密度图 $\\sigma(x,y)$ 和局部不可逆生热密度 $q_{\\text{irrev}}(x,y)$。\n- 使用网格上的黎曼和近似计算总熵产生率 $S_{\\text{total}} = \\int_V \\sigma \\, dV$，其中 $dV = (\\Delta x)(\\Delta y) h$，$(\\Delta x)$ 和 $(\\Delta y)$ 分别是 $x$ 和 $y$ 方向的均匀网格间距。\n- 识别具有 $\\sigma(x,y)$ 最大值的单元格的网格索引 $(i_{\\max}, j_{\\max})$，其中 $i_{\\max}$ 是从零开始的行索引（沿 $y$ 方向），$j_{\\max}$ 是从零开始的列索引（沿 $x$ 方向）。\n\n您必须以瓦特每开尔文 (W/K) 表示 $S_{\\text{total}}$，以瓦特每立方米 (W/m$^3$) 表示 $q_{\\text{irrev}}$，以瓦特每开尔文每立方米 (W/(K·m$^3$)) 表示 $\\sigma$，并以整数形式报告 $(i_{\\max}, j_{\\max})$。出现在三角函数中的角度必须以弧度计算。\n\n定义以下测试套件。对于所有情况，使用均匀网格和以下约定：网格包含 $N_x \\times N_y$ 个节点，坐标由 $x = 0, \\Delta x, 2\\Delta x, \\dots, (N_x-1)\\Delta x$ 和 $y = 0, \\Delta y, 2\\Delta y, \\dots, (N_y-1)\\Delta y$ 定义，其中 $\\Delta x = L_x / N_x$ 且 $\\Delta y = L_y / N_y$。\n\n测试用例 1（基准非均相电极）：\n- 几何：$L_x = 10^{-3}$ m, $L_y = 10^{-3}$ m, $h = 5 \\times 10^{-6}$ m, $N_x = 32$, $N_y = 32$。\n- 温度：$T(x,y) = 298$ K。\n- 电导率：$\\kappa(x,y) = 10$ S/m。\n- 电流密度：\n$$\nJ_x(x,y) = J_0 \\sin\\left(\\pi \\frac{x}{L_x}\\right), \\quad J_y(x,y) = J_0 \\cos\\left(\\pi \\frac{y}{L_y}\\right), \\quad J_0 = 8 \\times 10^{3} \\text{ A/m}^2.\n$$\n- 体积法拉第速率和过电势：\n$$\nr_F(x,y) = r_0 \\left[1 + 0.5 \\sin\\left(2\\pi \\frac{x}{L_x}\\right) \\sin\\left(2\\pi \\frac{y}{L_y}\\right) \\right], \\quad r_0 = 8 \\times 10^{5} \\text{ A/m}^3,\n$$\n$$\n\\eta(x,y) = 0.04 + 0.01 \\sin\\left(\\pi \\frac{x}{L_x}\\right)\\cos\\left(\\pi \\frac{y}{L_y}\\right) \\text{ V}.\n$$\n- 组分通量（两种组分 $i=1,2$）：\n$$\n\\boldsymbol{N}_1(x,y) = N_0 \\left[ \\cos\\left(2\\pi \\frac{x}{L_x}\\right)\\sin\\left(2\\pi \\frac{y}{L_y}\\right), \\; \\sin\\left(2\\pi \\frac{x}{L_x}\\right)\\cos\\left(2\\pi \\frac{y}{L_y}\\right) \\right],\n$$\n$$\n\\boldsymbol{N}_2(x,y) = -0.8 \\, \\boldsymbol{N}_1(x,y), \\quad N_0 = 10^{-3} \\text{ mol/(m}^2\\text{ s)}.\n$$\n- 唯象系数：\n$$\nL_1(x,y) = 10^{-9}, \\quad L_2(x,y) = 1.5 \\times 10^{-9} \\quad \\text{单位与 } \\boldsymbol{N}_i \\cdot (-\\nabla \\mu_i) = \\|\\boldsymbol{N}_i\\|^2 / L_i \\text{ 一致}.\n$$\n- 熵电势斜率：\n$$\n\\frac{dU}{dT}(x,y) = 2 \\times 10^{-3} \\text{ V/K}.\n$$\n\n测试用例 2（反应主导，质量输运可忽略）：\n- 几何：$L_x = 5 \\times 10^{-4}$ m, $L_y = 5 \\times 10^{-4}$ m, $h = 10^{-5}$ m, $N_x = 16$, $N_y = 16$。\n- 温度：$T(x,y) = 298 + 5 \\left(\\frac{x}{L_x}\\right)\\left(\\frac{y}{L_y}\\right)$ K。\n- 电导率：$\\kappa(x,y) = 500$ S/m。\n- 电流密度：\n$$\nJ_x(x,y) = J_0 \\left(\\frac{x}{L_x}\\right), \\quad J_y(x,y) = 0.5 J_0 \\left(\\frac{y}{L_y}\\right), \\quad J_0 = 10^{3} \\text{ A/m}^2.\n$$\n- 体积法拉第速率和过电势：\n$$\nr_F(x,y) = r_0 \\left[1 - 0.5 \\left(\\frac{x}{L_x}\\right) \\right], \\quad r_0 = 4 \\times 10^{5} \\text{ A/m}^3,\n$$\n$$\n\\eta(x,y) = 0.02 \\text{ V}.\n$$\n- 组分通量：$\\boldsymbol{N}_1(x,y) = \\boldsymbol{0}$, $\\boldsymbol{N}_2(x,y) = \\boldsymbol{0}$。\n- 唯象系数：由于通量为零，不使用 $L_1(x,y)$ 和 $L_2(x,y)$，但为完整性起见，设置 $L_1(x,y) = 10^{-9}$，$L_2(x,y) = 10^{-9}$。\n- 熵电势斜率：\n$$\n\\frac{dU}{dT}(x,y) = -1.5 \\times 10^{-3} \\text{ V/K}.\n$$\n\n测试用例 3（输运受限，具有空间变化的电导率和通量系数）：\n- 几何：$L_x = 2 \\times 10^{-3}$ m, $L_y = 10^{-3}$ m, $h = 2 \\times 10^{-5}$ m, $N_x = 32$, $N_y = 24$。\n- 温度：$T(x,y) = 305$ K。\n- 电导率：\n$$\n\\kappa(x,y) = 0.5 + 1.5 \\left(\\frac{x}{L_x}\\right) + 0.2 \\left[\\sin\\left(\\pi \\frac{y}{L_y}\\right) + 1 \\right] \\quad \\text{S/m}.\n$$\n- 电流密度：\n$$\nJ_x(x,y) = J_0 \\left(1 - \\frac{x}{L_x}\\right)\\sin\\left(\\pi \\frac{y}{L_y}\\right), \\quad\nJ_y(x,y) = J_0 \\left(\\frac{x}{L_x}\\right)\\cos\\left(\\pi \\frac{y}{L_y}\\right), \\quad J_0 = 6 \\times 10^{3} \\text{ A/m}^2.\n$$\n- 体积法拉第速率和过电势：\n$$\nr_F(x,y) = r_0 \\left[1 + 0.3 \\left(\\frac{y}{L_y}\\right) \\right], \\quad r_0 = 7 \\times 10^{5} \\text{ A/m}^3,\n$$\n$$\n\\eta(x,y) = 0.03 + 0.015 \\left(\\frac{x}{L_x}\\right) \\text{ V}.\n$$\n- 组分通量（两种组分 $i=1,2$）：\n$$\n\\boldsymbol{N}_1(x,y) = N_0 \\left[ \\sin\\left(2\\pi \\frac{x}{L_x}\\right), \\; \\cos\\left(2\\pi \\frac{y}{L_y}\\right) \\right], \\quad\n\\boldsymbol{N}_2(x,y) = 0.6 N_0 \\left[ \\cos\\left(2\\pi \\frac{x}{L_x}\\right), \\; -\\sin\\left(2\\pi \\frac{y}{L_y}\\right) \\right],\n$$\n其中 $N_0 = 5 \\times 10^{-4}$ mol/(m$^2$ s)。\n- 唯象系数：\n$$\nL_1(x,y) = 0.8 \\times 10^{-9} \\left[1 + 0.5 \\left(\\frac{y}{L_y}\\right) \\right], \\quad\nL_2(x,y) = 1.2 \\times 10^{-9} \\left[1 + 0.1 \\left(\\frac{x}{L_x}\\right) \\right].\n$$\n- 熵电势斜率：\n$$\n\\frac{dU}{dT}(x,y) = 1.0 \\times 10^{-3} \\text{ V/K}.\n$$\n\n对于每个测试用例，计算并返回以下三个量：\n- $S_{\\text{total}}$（单位 W/K）。\n- $\\max \\sigma$（单位 W/(K·m$^3$)）。\n- $(i_{\\max}, j_{\\max})$（一个包含两个整数的列表）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例的结果格式化为一个子列表，形式为 $[S_{\\text{total}},\\max \\sigma,i_{\\max},j_{\\max}]$。例如：$[[a,b,i,j],[\\dots],[\\dots]]$。不应打印其他任何文本。",
            "solution": "该问题要求基于非平衡热力学的基本原理，计算二维电池电极域内熵产生的空间分布图。总局部熵产生密度 $\\sigma(x,y)$ 是系统内发生的所有不可逆过程贡献的总和，再除以局部绝对温度 $T(x,y)$。问题为三种此类过程提供了具体模型：电传导（焦耳热）、电化学反应和多组分质量输运。\n\n此分析的基本原理是，局部熵产生密度（每单位体积）由热力学通量与其共轭力的乘积之和给出：\n$$\n\\sigma = \\frac{1}{T} \\sum_k \\boldsymbol{\\mathcal{J}}_k \\cdot \\boldsymbol{\\mathcal{X}}_k\n$$\n其中 $\\boldsymbol{\\mathcal{J}}_k$ 代表通量（例如，电流密度、质量通量），$\\boldsymbol{\\mathcal{X}}_k$ 是相应的热力学驱动力（例如，电场、化学势梯度）。问题指定了以下贡献：\n\n1.  **电传导：** 通量是电流密度 $\\boldsymbol{J}$，力是电场 $\\boldsymbol{E}$。耗散（不可逆功率密度）为 $\\boldsymbol{J} \\cdot \\boldsymbol{E}$。使用所提供的线性唯象定律（欧姆定律）$\\boldsymbol{J} = \\kappa \\boldsymbol{E}$，我们可以用通量表示力：$\\boldsymbol{E} = \\boldsymbol{J} / \\kappa$。耗散项变为 $\\|\\boldsymbol{J}\\|^2 / \\kappa$。\n\n2.  **电化学反应：** 在电极-电解质界面上按体积分布的不可逆功率密度，由体积法拉第反应速率 $r_F$ 和表面过电势 $\\eta$ 的乘积给出。过电势代表与平衡电势的偏差，是反应的驱动力。因此，耗散为 $r_F \\eta$。\n\n3.  **质量输运：** 对于每个组分 $i$，通量是摩尔通量 $\\boldsymbol{N}_i$，共轭力是其化学势的负梯度 $-\\nabla\\mu_i$。问题提供了通量和力之间的线性关系 $\\boldsymbol{N}_i = L_i (-\\nabla\\mu_i)$，其中 $L_i$ 是一个唯象系数。组分 $i$ 的耗散为 $\\boldsymbol{N}_i \\cdot (-\\nabla\\mu_i) = \\|\\boldsymbol{N}_i\\|^2 / L_i$。质量输运的总耗散是所有组分的总和。\n\n结合这些贡献，总不可逆生热密度 $q_{\\text{irrev}}(x,y)$ 为：\n$$\nq_{\\text{irrev}}(x,y) = \\frac{\\|\\boldsymbol{J}(x,y)\\|^2}{\\kappa(x,y)} + r_F(x,y)\\eta(x,y) + \\sum_{i} \\frac{\\|\\boldsymbol{N}_i(x,y)\\|^2}{L_i(x,y)}\n$$\n然后，通过除以局部绝对温度得到局部熵产生密度 $\\sigma(x,y)$：\n$$\n\\sigma(x,y) = \\frac{q_{\\text{irrev}}(x,y)}{T(x,y)}\n$$\n与反应熵相关的可逆热分量 $q_{\\text{rev}}(x,y) = T(x,y) r_F(x,y) \\frac{dU}{dT}(x,y)$ 不产生熵，因此正确地从 $\\sigma(x,y)$ 的计算中排除。\n\n解决该问题的算法步骤如下：\n首先，为域 $[0, L_x] \\times [0, L_y]$ 建立一个具有 $N_y$ 行和 $N_x$ 列的均匀笛卡尔网格。对于位于第 $i$ 行和第 $j$ 列的网格单元，其坐标 $(x_j, y_i)$ 定义为 $x_j = j \\cdot \\Delta x$ 和 $y_i = i \\cdot \\Delta y$，其中 $\\Delta x = L_x / N_x$ 和 $\\Delta y = L_y / N_y$，对于 $j \\in \\{0, \\dots, N_x-1\\}$ 和 $i \\in \\{0, \\dots, N_y-1\\}$。\n\n其次，在每个网格点上计算每个测试用例中提供的所有空间变化的物理量——温度 $T(x,y)$、电导率 $\\kappa(x,y)$、电流密度分量 $J_x(x,y)$ 和 $J_y(x,y)$、反应速率 $r_F(x,y)$、过电势 $\\eta(x,y)$、组分通量 $\\boldsymbol{N}_i(x,y)$ 和唯象系数 $L_i(x,y)$。这将产生一组代表每个量空间分布的 $N_y \\times N_x$ 矩阵。\n\n第三，使用这些矩阵，逐元素计算不可逆生热密度的三个分量（$q_{\\text{ohm}}$、$q_{\\text{rxn}}$、$q_{\\text{transport}}$）。\n- 欧姆项：$q_{\\text{ohm}} = (J_x^2 + J_y^2) / \\kappa$\n- 反应项：$q_{\\text{rxn}} = r_F \\cdot \\eta$\n- 输运项：$q_{\\text{transport}} = \\sum_i (N_{ix}^2 + N_{iy}^2) / L_i$\n\n将这些项相加，得到总不可逆生热图 $q_{\\text{irrev}} = q_{\\text{ohm}} + q_{\\text{rxn}} + q_{\\text{transport}}$。\n\n第四，通过将 $q_{\\text{irrev}}$ 矩阵逐元素除以温度矩阵 $T(x,y)$ 来计算熵产生密度图 $\\sigma(x,y)$。\n\n最后，从 $\\sigma$ 图中导出所需的输出：\n- 总熵产生率 $S_{\\text{total}}$ 通过黎曼和对体积积分 $\\int_V \\sigma \\, dV$ 进行近似计算：$S_{\\text{total}} = \\left(\\sum_{i,j} \\sigma_{ij}\\right) \\Delta V$，其中每个网格单元的体积为 $\\Delta V = \\Delta x \\cdot \\Delta y \\cdot h$。\n- 通过取 $\\sigma$ 矩阵中的最大值来找到熵产生密度的最大值 $\\max \\sigma$。\n- 识别与该最大值对应的网格索引 $(i_{\\max}, j_{\\max})$。行索引 $i_{\\max}$ 对应于 $y$ 方向，列索引 $j_{\\max}$ 对应于 $x$ 方向。\n\n此过程系统地应用于三个测试用例中的每一个，从而为每个测试用例得出指定的结果。所有数值计算均使用 `numpy` 库进行高效的数组操作。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_case(Lx, Ly, h, Nx, Ny, T_field, K_field, Jx_field, Jy_field, rF_field, eta_field, N_fields, L_fields):\n    \"\"\"\n    Computes entropy production metrics for a single test case.\n\n    Args:\n        Lx, Ly, h (float): Domain dimensions and thickness.\n        Nx, Ny (int): Grid resolution.\n        T_field (np.ndarray): Temperature map [K].\n        K_field (np.ndarray): Electrical conductivity map [S/m].\n        Jx_field, Jy_field (np.ndarray): Current density component maps [A/m^2].\n        rF_field (np.ndarray): Volumetric Faradaic rate map [A/m^3].\n        eta_field (np.ndarray): Overpotential map [V].\n        N_fields (list of tuples): List of species flux component maps [(N_ix, N_iy), ...], [mol/(m^2 s)].\n        L_fields (list): List of phenomenological coefficients [mol^2/(J m s)].\n\n    Returns:\n        list: [S_total, max_sigma, i_max, j_max].\n    \"\"\"\n    dx = Lx / Nx\n    dy = Ly / Ny\n    dV = dx * dy * h\n\n    # Calculate dissipation densities (W/m^3)\n    # Ohmic dissipation\n    q_ohm = (Jx_field**2 + Jy_field**2) / K_field\n\n    # Reaction dissipation\n    q_rxn = rF_field * eta_field\n\n    # Mass transport dissipation\n    q_transport = np.zeros_like(Jx_field)\n    for i in range(len(N_fields)):\n        N_vec = N_fields[i]  # Tuple (N_ix_field, N_iy_field)\n        L_val = L_fields[i]  # Scalar or array\n        q_transport += (N_vec[0]**2 + N_vec[1]**2) / L_val\n\n    # Total irreversible heat generation density\n    q_irrev = q_ohm + q_rxn + q_transport\n    \n    # Entropy production density (W/(K*m^3))\n    sigma = q_irrev / T_field\n\n    # Total entropy production rate (W/K)\n    S_total = np.sum(sigma) * dV\n    \n    # Maximum entropy production density\n    max_sigma = np.max(sigma)\n    \n    # Location of maximum\n    flat_idx = np.argmax(sigma)\n    i_max, j_max = np.unravel_index(flat_idx, sigma.shape)\n    \n    return [S_total, max_sigma, int(i_max), int(j_max)]\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    results = []\n\n    # Test Case 1\n    Lx, Ly, h, Nx, Ny = 1e-3, 1e-3, 5e-6, 32, 32\n    dx, dy = Lx / Nx, Ly / Ny\n    x_coords = np.arange(Nx) * dx\n    y_coords = np.arange(Ny) * dy\n    yy, xx = np.meshgrid(y_coords, x_coords, indexing='ij')\n\n    T_field = np.full((Ny, Nx), 298.0)\n    K_field = np.full((Ny, Nx), 10.0)\n    J0 = 8e3\n    Jx_field = J0 * np.sin(np.pi * xx / Lx)\n    Jy_field = J0 * np.cos(np.pi * yy / Ly)\n    r0 = 8e5\n    rF_field = r0 * (1 + 0.5 * np.sin(2 * np.pi * xx / Lx) * np.sin(2 * np.pi * yy / Ly))\n    eta_field = 0.04 + 0.01 * np.sin(np.pi * xx / Lx) * np.cos(np.pi * yy / Ly)\n    N0 = 1e-3\n    N1x = N0 * (np.cos(2 * np.pi * xx / Lx) * np.sin(2 * np.pi * yy / Ly))\n    N1y = N0 * (np.sin(2 * np.pi * xx / Lx) * np.cos(2 * np.pi * yy / Ly))\n    N_fields = [(N1x, N1y), (-0.8 * N1x, -0.8 * N1y)]\n    L_fields = [1e-9, 1.5e-9]\n\n    results.append(calculate_case(Lx, Ly, h, Nx, Ny, T_field, K_field, Jx_field, Jy_field, rF_field, eta_field, N_fields, L_fields))\n\n    # Test Case 2\n    Lx, Ly, h, Nx, Ny = 5e-4, 5e-4, 1e-5, 16, 16\n    dx, dy = Lx / Nx, Ly / Ny\n    x_coords = np.arange(Nx) * dx\n    y_coords = np.arange(Ny) * dy\n    yy, xx = np.meshgrid(y_coords, x_coords, indexing='ij')\n\n    T_field = 298.0 + 5.0 * (xx / Lx) * (yy / Ly)\n    K_field = np.full((Ny, Nx), 500.0)\n    J0 = 1e3\n    Jx_field = J0 * (xx / Lx)\n    Jy_field = 0.5 * J0 * (yy / Ly)\n    r0 = 4e5\n    rF_field = r0 * (1 - 0.5 * (xx / Lx))\n    eta_field = np.full((Ny, Nx), 0.02)\n    N_fields = [(np.zeros_like(xx), np.zeros_like(xx)), (np.zeros_like(xx), np.zeros_like(xx))]\n    L_fields = [1e-9, 1e-9]\n\n    results.append(calculate_case(Lx, Ly, h, Nx, Ny, T_field, K_field, Jx_field, Jy_field, rF_field, eta_field, N_fields, L_fields))\n\n    # Test Case 3\n    Lx, Ly, h, Nx, Ny = 2e-3, 1e-3, 2e-5, 32, 24\n    dx, dy = Lx / Nx, Ly / Ny\n    x_coords = np.arange(Nx) * dx\n    y_coords = np.arange(Ny) * dy\n    yy, xx = np.meshgrid(y_coords, x_coords, indexing='ij')\n\n    T_field = np.full((Ny, Nx), 305.0)\n    K_field = 0.5 + 1.5 * (xx / Lx) + 0.2 * (np.sin(np.pi * yy / Ly) + 1.0)\n    J0 = 6e3\n    Jx_field = J0 * (1 - xx / Lx) * np.sin(np.pi * yy / Ly)\n    Jy_field = J0 * (xx / Lx) * np.cos(np.pi * yy / Ly)\n    r0 = 7e5\n    rF_field = r0 * (1 + 0.3 * (yy / Ly))\n    eta_field = 0.03 + 0.015 * (xx / Lx)\n    N0 = 5e-4\n    N1x = N0 * np.sin(2 * np.pi * xx / Lx)\n    N1y = N0 * np.cos(2 * np.pi * yy / Ly)\n    N2x = 0.6 * N0 * np.cos(2 * np.pi * xx / Lx)\n    N2y = -0.6 * N0 * np.sin(2 * np.pi * yy / Ly)\n    N_fields = [(N1x, N1y), (N2x, N2y)]\n    L1_field = 0.8e-9 * (1 + 0.5 * (yy / Ly))\n    L2_field = 1.2e-9 * (1 + 0.1 * (xx / Lx))\n    L_fields = [L1_field, L2_field]\n\n    results.append(calculate_case(Lx, Ly, h, Nx, Ny, T_field, K_field, Jx_field, Jy_field, rF_field, eta_field, N_fields, L_fields))\n\n    # Format and print the final output\n    sub_results_str = [f\"[{s},{m},{i},{j}]\" for s, m, i, j in results]\n    print(f\"[{','.join(sub_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}