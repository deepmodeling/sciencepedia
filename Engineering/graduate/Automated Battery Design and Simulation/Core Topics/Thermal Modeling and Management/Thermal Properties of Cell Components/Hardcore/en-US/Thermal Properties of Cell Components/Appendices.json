{
    "hands_on_practices": [
        {
            "introduction": "Battery electrodes are complex porous composites, but for large-scale simulations, we treat them as homogeneous materials. This practice guides you through deriving the effective volumetric heat capacity, $(\\rho c_{p})_{\\mathrm{eff}}$, for such a material from first principles . Mastering this skill is fundamental to correctly representing heat storage in continuum-level battery thermal models.",
            "id": "3955826",
            "problem": "A porous battery electrode comprises a contiguous solid matrix saturated with a liquid electrolyte. Let the porosity be the electrolyte-filled volume fraction $\\varepsilon \\in (0,1)$, the solid occupy volume fraction $1-\\varepsilon$, and assume that the solid and liquid phases are each homogeneous with constant density and isobaric specific heat $(\\rho_{s}, c_{p,s})$ for the solid and $(\\rho_{\\ell}, c_{p,\\ell})$ for the liquid. Consider a small Representative Elementary Volume (REV) of total volume $V$ over which local thermal equilibrium holds, so that the temperature field is single-valued, $T(\\mathbf{x},t)$, for both phases. Neglect compressibility and phase change, and consider only sensible heat.\n\nStarting from the First Law of Thermodynamics for a control volume and the definition of sensible energy in terms of specific enthalpy for condensed phases, derive the form of an effective volumetric heat capacity $(\\rho c_{p})_{\\mathrm{eff}}$ such that the total sensible energy stored per unit volume in the REV can be written as $(\\rho c_{p})_{\\mathrm{eff}} T$ (relative to a common reference temperature). In your derivation, explicitly justify whether an arithmetic or a harmonic mixing rule in $\\varepsilon$ is appropriate for $(\\rho c_{p})_{\\mathrm{eff}}$ under the stated assumptions.\n\nProvide your final result as a single closed-form symbolic expression in terms of $\\varepsilon$, $\\rho_{s}$, $c_{p,s}$, $\\rho_{\\ell}$, and $c_{p,\\ell}$. Do not include units in your final boxed answer.",
            "solution": "The problem is first validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- Porous medium: contiguous solid matrix saturated with a liquid electrolyte.\n- Porosity: $\\varepsilon \\in (0,1)$, the electrolyte-filled volume fraction.\n- Solid volume fraction: $1-\\varepsilon$.\n- Solid phase properties: homogeneous, constant density $\\rho_{s}$, constant isobaric specific heat $c_{p,s}$.\n- Liquid phase properties: homogeneous, constant density $\\rho_{\\ell}$, constant isobaric specific heat $c_{p,\\ell}$.\n- A Representative Elementary Volume (REV) of total volume $V$.\n- Assumption: Local thermal equilibrium holds, yielding a single-valued temperature field $T(\\mathbf{x},t)$ for both phases.\n- Assumptions: Neglect compressibility and phase change; consider only sensible heat.\n- Objective: Derive the form of an effective volumetric heat capacity $(\\rho c_{p})_{\\mathrm{eff}}$.\n- Condition: The total sensible energy stored per unit volume is $(\\rho c_{p})_{\\mathrm{eff}} T$ (relative to a common reference temperature).\n- Task: Justify the use of an arithmetic versus a harmonic mixing rule.\n- Final Result: A closed-form symbolic expression for $(\\rho c_{p})_{\\mathrm{eff}}$ in terms of $\\varepsilon$, $\\rho_{s}$, $c_{p,s}$, $\\rho_{\\ell}$, and $c_{p,\\ell}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, drawing upon fundamental principles of thermodynamics and the well-established theory of transport in porous media. The concepts of a Representative Elementary Volume (REV), volume fractions, local thermal equilibrium, and effective properties are standard in continuum modeling of multiphase systems. The problem is well-posed, providing all necessary information and assumptions ($\\varepsilon$, constant properties, local thermal equilibrium) to derive a unique solution. The language is objective and precise. No scientific flaws, contradictions, or ambiguities are present. The problem is a standard derivation in heat transfer and is neither trivial nor ill-posed.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full derivation will be provided.\n\n**Derivation**\n\nThe derivation begins with the First Law of Thermodynamics applied to the Representative Elementary Volume (REV). The total sensible energy, $U_{total}$, stored within the REV of total volume $V$ is the sum of the sensible energies of the solid phase, $U_s$, and the liquid phase, $U_{\\ell}$.\n$$\nU_{total} = U_s + U_{\\ell}\n$$\nThe volume occupied by the solid phase within the REV is $V_s = (1-\\varepsilon)V$, and the volume occupied by the liquid phase is $V_{\\ell} = \\varepsilon V$.\n\nThe mass of each phase can be expressed in terms of its density and volume:\nThe mass of the solid phase is $m_s = \\rho_s V_s = \\rho_s (1-\\varepsilon)V$.\nThe mass of the liquid phase is $m_{\\ell} = \\rho_{\\ell} V_{\\ell} = \\rho_{\\ell} \\varepsilon V$.\n\nFor a condensed phase (solid or liquid) under the specified assumptions (constant pressure, negligible compressibility), the sensible energy is directly related to the specific enthalpy, $h$. The problem defines the energy relative to a common reference temperature, $T_{ref}$. The specific enthalpy is given by $h = \\int_{T_{ref}}^{T} c_p \\,dT'$. Since the specific heats $c_{p,s}$ and $c_{p,\\ell}$ are constant, this integrates to $h = c_p (T-T_{ref})$. The problem statement implies a final form of $(\\rho c_p)_{\\mathrm{eff}} T$, which is equivalent to choosing $T_{ref}=0$ for notational convenience. Thus, the specific enthalpy for each phase is $h_s = c_{p,s}T$ and $h_{\\ell} = c_{p,\\ell}T$. The crucial assumption of local thermal equilibrium guarantees that both phases share the same temperature $T$ at any point within the REV.\n\nThe sensible energy of each phase is the product of its mass and specific enthalpy:\n$$\nU_s = m_s h_s = (\\rho_s (1-\\varepsilon)V)(c_{p,s}T)\n$$\n$$\nU_{\\ell} = m_{\\ell} h_{\\ell} = (\\rho_{\\ell} \\varepsilon V)(c_{p,\\ell}T)\n$$\nThe total sensible energy in the REV is therefore:\n$$\nU_{total} = \\rho_s (1-\\varepsilon)V c_{p,s}T + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}T\n$$\nThe problem asks for the effective volumetric heat capacity, $(\\rho c_{p})_{\\mathrm{eff}}$, which is defined in relation to the total sensible energy stored per unit volume, $u_{total} = U_{total}/V$.\n$$\nu_{total} = \\frac{U_{total}}{V} = \\frac{\\rho_s (1-\\varepsilon)V c_{p,s}T + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}T}{V}\n$$\nThe total volume $V$ cancels out:\n$$\nu_{total} = \\rho_s (1-\\varepsilon) c_{p,s}T + \\rho_{\\ell} \\varepsilon c_{p,\\ell}T\n$$\nFactoring out the temperature $T$:\n$$\nu_{total} = \\left[ (1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell} \\right] T\n$$\nBy comparing this derived expression with the definitional relationship given in the problem, $u_{total} = (\\rho c_{p})_{\\mathrm{eff}} T$, we can directly identify the effective volumetric heat capacity:\n$$\n(\\rho c_{p})_{\\mathrm{eff}} = (1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell}\n$$\n\n**Justification of the Mixing Rule**\n\nThe derived expression for $(\\rho c_{p})_{\\mathrm{eff}}$ is a volume-weighted arithmetic average of the volumetric heat capacities of the individual phases, $(\\rho c_p)_s = \\rho_s c_{p,s}$ and $(\\rho c_p)_{\\ell} = \\rho_{\\ell} c_{p,\\ell}$.\n$$\n(\\rho c_{p})_{\\mathrm{eff}} = (1-\\varepsilon)(\\rho c_p)_s + \\varepsilon (\\rho c_p)_{\\ell}\n$$\nThis arithmetic mixing rule is appropriate because heat capacity is an extensive property. For a composite system, the total heat capacity is the direct sum of the heat capacities of its components. Let $C_{total}$ be the total heat capacity of the REV.\n$$\nC_{total} = \\frac{dU_{total}}{dT}\n$$\nGiven the linear dependence of $U_{total}$ on $T$, this becomes:\n$$\nC_{total} = \\frac{d}{dT} \\left( (\\rho_s (1-\\varepsilon)V c_{p,s} + \\rho_{\\ell} \\varepsilon V c_{p,\\ell})T \\right) = \\rho_s (1-\\varepsilon)V c_{p,s} + \\rho_{\\ell} \\varepsilon V c_{p,\\ell}\n$$\nThis shows that the total heat capacity $C_{total}$ is the sum of the heat capacities of the solid component, $C_s = m_s c_{p,s}$, and the liquid component, $C_{\\ell} = m_{\\ell} c_{p,\\ell}$. The effective volumetric heat capacity is the total heat capacity per unit total volume, $(\\rho c_p)_{\\mathrm{eff}} = C_{total}/V$, which directly yields the derived arithmetic mean.\n\nA harmonic mixing rule, of the form $(\\rho c_p)_{\\mathrm{eff}}^{-1} = (1-\\varepsilon)(\\rho c_p)_s^{-1} + \\varepsilon (\\rho c_p)_{\\ell}^{-1}$, is inappropriate here. Such a rule typically applies to transport properties (like thermal conductivity or electrical conductivity) in a serial arrangement of components, where resistances add. Heat storage is not a transport process. The assumption of local thermal equilibrium implies that the two phases are thermally in parallel, meaning they respond to temperature changes together, and their capacities to store heat are simply additive. The derivation from the first principles of energy conservation and additivity of energy confirms that the arithmetic mixing rule is the correct choice.",
            "answer": "$$\n\\boxed{(1-\\varepsilon)\\rho_s c_{p,s} + \\varepsilon \\rho_{\\ell} c_{p,\\ell}}\n$$"
        },
        {
            "introduction": "A critical input for any thermal model is the heat source. This exercise bridges electrochemical and thermal modeling by having you calculate the total Ohmic heat generated within the cell based on current density distributions from a Pseudo-Two-Dimensional (P2D) model . This practice demonstrates how local transport phenomena give rise to the overall thermal load that must be managed.",
            "id": "3955800",
            "problem": "A planar lithium-ion cell stack is modeled in one spatial dimension across thickness using the Pseudo Two-Dimensional (P2D) framework. Consider three contiguous domains: a negative porous electrode occupying $x\\in[0,L_n]$, a porous separator occupying $x\\in[L_n,L_n+L_s]$, and a positive porous electrode occupying $x\\in[L_n+L_s,L_n+L_s+L_p]$. The cross-sectional area is $A$, and a uniform applied areal current density $I_{\\mathrm{app}}$ (units $\\mathrm{A}\\,\\mathrm{m}^{-2}$) is imposed, directed from the negative current collector to the positive current collector. The Pseudo Two-Dimensional (P2D) solution provides local phase current densities $i_s(x)$ in the electronically conducting solid (defined and nonzero only in the electrodes) and $i_e(x)$ in the ionically conducting electrolyte (defined and nonzero in all porous domains). Charge conservation in one dimension implies $i_s(x)+i_e(x)=I_{\\mathrm{app}}$ wherever both phases are present and that no Faradaic reaction occurs in the separator.\n\nStarting from conservation of energy and charge together with constitutive transport laws, derive the appropriate local irreversible volumetric heat source terms arising from Ohmic conduction in the electronically conducting solid and the ionically conducting electrolyte, using effective transport coefficients appropriate for porous media. Then, using those sources, compute the total irreversible Ohmic heat rate by integrating across each domain and summing the contributions, with units in $\\mathrm{W}$.\n\nAssumptions for numerical evaluation:\n- The effective electronic conductivity in the negative and positive electrodes are constants denoted $\\sigma_n$ and $\\sigma_p$ (units $\\mathrm{S}\\,\\mathrm{m}^{-1}$). The effective ionic conductivity in the electrolyte within the negative electrode, separator, and positive electrode are constants denoted $\\kappa_n$, $\\kappa_s$, and $\\kappa_p$ (units $\\mathrm{S}\\,\\mathrm{m}^{-1}$), respectively.\n- In the separator, the electronically conducting phase is absent, so $i_s(x)=0$ for $x\\in[L_n,L_n+L_s]$, and $i_e(x)=I_{\\mathrm{app}}$ there.\n- In the electrodes, use the following Pseudo Two-Dimensional (P2D)-consistent one-dimensional current distributions to represent distinct cases. Let $\\xi_n=x/L_n\\in[0,1]$ be the normalized coordinate in the negative electrode, and let $\\xi_p=(x-(L_n+L_s))/L_p\\in[0,1]$ be the normalized coordinate in the positive electrode:\n  - Linear distributions: $i_s(x)=I_{\\mathrm{app}}\\,(1-\\xi_n)$ in the negative electrode and $i_s(x)=I_{\\mathrm{app}}\\,\\xi_p$ in the positive electrode. In each electrode, enforce $i_e(x)=I_{\\mathrm{app}}-i_s(x)$.\n  - Quadratic distributions: $i_s(x)=I_{\\mathrm{app}}\\,(1-\\xi_n^2)$ in the negative electrode and $i_s(x)=I_{\\mathrm{app}}\\,\\xi_p^2$ in the positive electrode. In each electrode, enforce $i_e(x)=I_{\\mathrm{app}}-i_s(x)$.\n\nYour task is to implement a program that, for each test case below, evaluates the total irreversible Ohmic heat rate by integrating the appropriate local volumetric sources across $x\\in[0,L_n+L_s+L_p]$ and multiplying by $A$. You must express each result in $\\mathrm{W}$, rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$ (baseline, linear distributions):\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=6.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.0\\times 10^{-5}\\ \\mathrm{m}$, $L_p=7.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=8.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=9.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n- Case $2$ (electrolyte-limited, linear distributions):\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=6.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.0\\times 10^{-5}\\ \\mathrm{m}$, $L_p=7.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=5.0\\times 10^{4}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=1.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=5.0\\times 10^{-2}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=1.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n- Case $3$ (highly conductive solid, quadratic distributions):\n  - $A=1.0\\times 10^{-2}\\ \\mathrm{m}^2$, $I_{\\mathrm{app}}=2.0\\times 10^{1}\\ \\mathrm{A}\\,\\mathrm{m}^{-2}$\n  - $L_n=4.0\\times 10^{-5}\\ \\mathrm{m}$, $L_s=2.5\\times 10^{-5}\\ \\mathrm{m}$, $L_p=4.0\\times 10^{-5}\\ \\mathrm{m}$\n  - $\\sigma_n=1.0\\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\sigma_p=1.0\\times 10^{6}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n  - $\\kappa_n=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_s=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$, $\\kappa_p=6.0\\times 10^{-1}\\ \\mathrm{S}\\,\\mathrm{m}^{-1}$\n\nFinal output format:\n- Your program should produce a single line of output containing the results for Cases $1$, $2$, and $3$ in order, as a comma-separated list enclosed in square brackets, for example: \"[r1,r2,r3]\". Each entry must be the total irreversible Ohmic heat rate in $\\mathrm{W}$ for the corresponding case, rounded to $6$ decimal places.",
            "solution": "The problem requires the derivation and calculation of the total irreversible Ohmic heat rate in a one-dimensional model of a lithium-ion cell stack. The derivation begins from the fundamental principles of energy conservation and electrical conduction.\n\nThe local volumetric rate of irreversible heat generation due to Ohmic resistance, $\\dot{q}_{\\mathrm{Ohm}}$ (in $\\mathrm{W}\\,\\mathrm{m}^{-3}$), is given by the product of the electric field and the current density. In a material obeying Ohm's law, where current density $\\vec{J}$ is related to the electric field $\\vec{E}$ by $\\vec{J} = \\sigma \\vec{E}$ (with $\\sigma$ being the electrical conductivity), the volumetric heat source is given by:\n$$\n\\dot{q}_{\\mathrm{Ohm}} = \\vec{J} \\cdot \\vec{E} = \\vec{J} \\cdot (\\sigma^{-1} \\vec{J}) = \\frac{|\\vec{J}|^2}{\\sigma}\n$$\nIn the context of the Pseudo Two-Dimensional (P2D) model, porous electrodes contain two conducting phases: the solid matrix (electronic conductor) and the electrolyte filling the pores (ionic conductor). The total Ohmic heat generation is the sum of the contributions from both phases. Let $i_s(x)$ and $i_e(x)$ be the local areal current densities ($\\mathrm{A}\\,\\mathrm{m}^{-2}$) in the solid and electrolyte phases, respectively. Let $\\sigma_{\\mathrm{eff}}(x)$ and $\\kappa_{\\mathrm{eff}}(x)$ be the effective electronic and ionic conductivities ($\\mathrm{S}\\,\\mathrm{m}^{-1}$), respectively. The total local volumetric Ohmic heat source is:\n$$\n\\dot{q}_{\\mathrm{Ohm}}(x) = \\frac{i_s(x)^2}{\\sigma_{\\mathrm{eff}}(x)} + \\frac{i_e(x)^2}{\\kappa_{\\mathrm{eff}}(x)}\n$$\nThe total Ohmic heat rate, $Q_{\\mathrm{Ohm}}$ (in $\\mathrm{W}$), is obtained by integrating this volumetric source over the entire cell volume. For a planar cell with a uniform cross-sectional area $A$, the volume element is $dV = A \\, dx$, and the total heat rate is:\n$$\nQ_{\\mathrm{Ohm}} = \\int_{V} \\dot{q}_{\\mathrm{Ohm}} \\, dV = A \\int_{0}^{L_n+L_s+L_p} \\dot{q}_{\\mathrm{Ohm}}(x) \\, dx\n$$\nThe integral is partitioned into the three domains: negative electrode ($n$), separator ($s$), and positive electrode ($p$).\n$$\nQ_{\\mathrm{Ohm}} = Q_n + Q_s + Q_p\n$$\nwhere\n$$\nQ_n = A \\int_{0}^{L_n} \\left( \\frac{i_s(x)^2}{\\sigma_n} + \\frac{i_e(x)^2}{\\kappa_n} \\right) dx\n$$\n$$\nQ_s = A \\int_{L_n}^{L_n+L_s} \\left( \\frac{i_s(x)^2}{\\sigma_s} + \\frac{i_e(x)^2}{\\kappa_s} \\right) dx\n$$\n$$\nQ_p = A \\int_{L_n+L_s}^{L_n+L_s+L_p} \\left( \\frac{i_s(x)^2}{\\sigma_p} + \\frac{i_e(x)^2}{\\kappa_p} \\right) dx\n$$\nAccording to the problem statement, the separator is not electronically conductive, so $i_s(x) = 0$ for $x \\in [L_n, L_n+L_s]$. Conservation of charge dictates $i_e(x) = I_{\\mathrm{app}}$ in this region. The heat contribution from the separator is thus:\n$$\nQ_s = A \\int_{L_n}^{L_n+L_s} \\frac{I_{\\mathrm{app}}^2}{\\kappa_s} dx = A \\frac{I_{\\mathrm{app}}^2 L_s}{\\kappa_s}\n$$\nFor the electrodes, we analyze the two specified functional forms for the current distributions. For both cases, we use the normalized coordinates $\\xi_n = x/L_n$ for the negative electrode and $\\xi_p = (x-(L_n+L_s))/L_p$ for the positive electrode. The differentials are $dx = L_n d\\xi_n$ and $dx = L_p d\\xi_p$, respectively.\n\n**Linear Current Distributions**\n\nIn the negative electrode: $i_s(x) = I_{\\mathrm{app}}(1-\\xi_n)$ and $i_e(x) = I_{\\mathrm{app}} - i_s(x) = I_{\\mathrm{app}}\\xi_n$.\n$$\nQ_n^{\\mathrm{lin}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}(1-\\xi_n))^2}{\\sigma_n} + \\frac{(I_{\\mathrm{app}}\\xi_n)^2}{\\kappa_n} \\right) L_n d\\xi_n\n$$\n$$\nQ_n^{\\mathrm{lin}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_n} \\int_{0}^{1}(1-\\xi_n)^2 d\\xi_n + \\frac{1}{\\kappa_n} \\int_{0}^{1}\\xi_n^2 d\\xi_n \\right)\n$$\nThe definite integrals are $\\int_0^1 (1-\\xi_n)^2 d\\xi_n = 1/3$ and $\\int_0^1 \\xi_n^2 d\\xi_n = 1/3$.\n$$\nQ_n^{\\mathrm{lin}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{3\\sigma_n} + \\frac{1}{3\\kappa_n} \\right) = \\frac{A L_n I_{\\mathrm{app}}^2}{3} \\left( \\frac{1}{\\sigma_n} + \\frac{1}{\\kappa_n} \\right)\n$$\nIn the positive electrode: $i_s(x) = I_{\\mathrm{app}}\\xi_p$ and $i_e(x) = I_{\\mathrm{app}}(1-\\xi_p)$. By symmetry, the calculation is analogous:\n$$\nQ_p^{\\mathrm{lin}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}\\xi_p)^2}{\\sigma_p} + \\frac{(I_{\\mathrm{app}}(1-\\xi_p))^2}{\\kappa_p} \\right) L_p d\\xi_p = \\frac{A L_p I_{\\mathrm{app}}^2}{3} \\left( \\frac{1}{\\sigma_p} + \\frac{1}{\\kappa_p} \\right)\n$$\nThe total Ohmic heat rate for linear distributions is:\n$$\nQ_{\\mathrm{Ohm}}^{\\mathrm{lin}} = A I_{\\mathrm{app}}^2 \\left[ \\frac{L_n}{3} \\left( \\frac{1}{\\sigma_n} + \\frac{1}{\\kappa_n} \\right) + \\frac{L_s}{\\kappa_s} + \\frac{L_p}{3} \\left( \\frac{1}{\\sigma_p} + \\frac{1}{\\kappa_p} \\right) \\right]\n$$\n\n**Quadratic Current Distributions**\n\nIn the negative electrode: $i_s(x) = I_{\\mathrm{app}}(1-\\xi_n^2)$ and $i_e(x) = I_{\\mathrm{app}}\\xi_n^2$.\n$$\nQ_n^{\\mathrm{quad}} = A \\int_{0}^{1} \\left( \\frac{(I_{\\mathrm{app}}(1-\\xi_n^2))^2}{\\sigma_n} + \\frac{(I_{\\mathrm{app}}\\xi_n^2)^2}{\\kappa_n} \\right) L_n d\\xi_n\n$$\n$$\nQ_n^{\\mathrm{quad}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_n} \\int_{0}^{1}(1-\\xi_n^2)^2 d\\xi_n + \\frac{1}{\\kappa_n} \\int_{0}^{1}\\xi_n^4 d\\xi_n \\right)\n$$\nThe definite integrals are $\\int_0^1 (1-\\xi_n^2)^2 d\\xi_n = \\int_0^1 (1-2\\xi_n^2+\\xi_n^4)d\\xi_n = [ \\xi_n - \\frac{2}{3}\\xi_n^3 + \\frac{1}{5}\\xi_n^5 ]_0^1 = 1 - 2/3 + 1/5 = 8/15$, and $\\int_0^1 \\xi_n^4 d\\xi_n = [\\xi_n^5/5]_0^1 = 1/5$.\n$$\nQ_n^{\\mathrm{quad}} = A L_n I_{\\mathrm{app}}^2 \\left( \\frac{8}{15\\sigma_n} + \\frac{1}{5\\kappa_n} \\right)\n$$\nIn the positive electrode: $i_s(x) = I_{\\mathrm{app}}\\xi_p^2$ and $i_e(x) = I_{\\mathrm{app}}(1-\\xi_p^2)$. By symmetry:\n$$\nQ_p^{\\mathrm{quad}} = A L_p I_{\\mathrm{app}}^2 \\left( \\frac{1}{\\sigma_p} \\int_{0}^{1}\\xi_p^4 d\\xi_p + \\frac{1}{\\kappa_p} \\int_{0}^{1}(1-\\xi_p^2)^2 d\\xi_p \\right) = A L_p I_{\\mathrm{app}}^2 \\left( \\frac{1}{5\\sigma_p} + \\frac{8}{15\\kappa_p} \\right)\n$$\nThe total Ohmic heat rate for quadratic distributions is:\n$$\nQ_{\\mathrm{Ohm}}^{\\mathrm{quad}} = A I_{\\mathrm{app}}^2 \\left[ L_n \\left( \\frac{8}{15\\sigma_n} + \\frac{1}{5\\kappa_n} \\right) + \\frac{L_s}{\\kappa_s} + L_p \\left( \\frac{1}{5\\sigma_p} + \\frac{8}{15\\kappa_p} \\right) \\right]\n$$\nThese derived closed-form expressions allow for the direct computation of the total irreversible Ohmic heat rate for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_ohmic_heat(params, distribution_type):\n    \"\"\"\n    Calculates the total irreversible Ohmic heat rate for a Li-ion cell stack.\n\n    Args:\n        params (dict): A dictionary containing all the cell parameters.\n        distribution_type (str): The type of current distribution ('linear' or 'quadratic').\n\n    Returns:\n        float: The total Ohmic heat rate in Watts.\n    \"\"\"\n    A = params['A']\n    I_app = params['I_app']\n    L_n, L_s, L_p = params['L_n'], params['L_s'], params['L_p']\n    sigma_n, sigma_p = params['sigma_n'], params['sigma_p']\n    kappa_n, kappa_s, kappa_p = params['kappa_n'], params['kappa_s'], params['kappa_p']\n\n    # Common factor A * I_app^2\n    common_factor = A * I_app**2\n\n    # Separator contribution (same for both distributions)\n    q_s = L_s / kappa_s\n\n    # Electrode contributions depend on the distribution type\n    if distribution_type == 'linear':\n        # Negative electrode contribution\n        q_n = (L_n / 3.0) * (1.0 / sigma_n + 1.0 / kappa_n)\n        # Positive electrode contribution\n        q_p = (L_p / 3.0) * (1.0 / sigma_p + 1.0 / kappa_p)\n    elif distribution_type == 'quadratic':\n        # Negative electrode contribution\n        q_n = L_n * (8.0 / (15.0 * sigma_n) + 1.0 / (5.0 * kappa_n))\n        # Positive electrode contribution\n        q_p = L_p * (1.0 / (5.0 * sigma_p) + 8.0 / (15.0 * kappa_p))\n    else:\n        raise ValueError(\"Invalid distribution type specified.\")\n\n    total_heat_rate = common_factor * (q_n + q_s + q_p)\n    \n    return total_heat_rate\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (baseline, linear distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 6.0e-5, 'L_s': 2.0e-5, 'L_p': 7.0e-5,\n                'sigma_n': 5.0e4, 'sigma_p': 5.0e4, 'kappa_n': 8.0e-1, 'kappa_s': 6.0e-1, 'kappa_p': 9.0e-1\n            },\n            'dist_type': 'linear'\n        },\n        # Case 2 (electrolyte-limited, linear distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 6.0e-5, 'L_s': 2.0e-5, 'L_p': 7.0e-5,\n                'sigma_n': 5.0e4, 'sigma_p': 5.0e4, 'kappa_n': 1.0e-1, 'kappa_s': 5.0e-2, 'kappa_p': 1.0e-1\n            },\n            'dist_type': 'linear'\n        },\n        # Case 3 (highly conductive solid, quadratic distributions)\n        {\n            'params': {\n                'A': 1.0e-2, 'I_app': 2.0e1, 'L_n': 4.0e-5, 'L_s': 2.5e-5, 'L_p': 4.0e-5,\n                'sigma_n': 1.0e6, 'sigma_p': 1.0e6, 'kappa_n': 6.0e-1, 'kappa_s': 6.0e-1, 'kappa_p': 6.0e-1\n            },\n            'dist_type': 'quadratic'\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_ohmic_heat(case['params'], case['dist_type'])\n        # Round to 6 decimal places as required\n        rounded_result = round(result, 6)\n        results.append(str(rounded_result))\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Heat must flow through multiple layers and interfaces within a battery, and these interfaces often impede heat transfer significantly. This hands-on practice challenges you to implement a numerical solver that accurately captures interfacial thermal resistance, a key phenomenon in multilayer systems . Verifying your code against an analytical solution will build confidence in your ability to construct robust and physically accurate thermal simulation tools.",
            "id": "3955778",
            "problem": "You are tasked with implementing a one-dimensional, steady-state thermal conduction solver for a two-layer composite cell component with an interfacial thermal resistance between the layers. The objective is to construct a discrete model using either ghost cells or explicit interface elements such that the interface produces a finite temperature jump proportional to the transmitted heat flux, while maintaining heat flux continuity. Your implementation must be verified against an analytically derived benchmark solution on a two-layer slab. The problem should be formulated and solved within the framework of an automated battery design and simulation workflow that models thermal properties of cell components.\n\nStart from fundamental physical principles:\n- Fourierâ€™s law of heat conduction in one dimension: the local heat flux density is $q^{\\prime\\prime} = -k\\,\\frac{dT}{dx}$, where $k$ is the thermal conductivity and $T$ is the temperature field.\n- Steady-state energy conservation in one dimension with no internal heat generation implies $\\frac{d}{dx}\\left(k\\,\\frac{dT}{dx}\\right)=0$ within each homogeneous layer.\n- An interfacial thermal resistance (also called Thermal Contact Resistance, or TCR) induces a temperature discontinuity proportional to the transmitted heat flux at the interface, while the heat flux remains continuous across the interface.\n\nModel description to implement:\n- Consider a slab comprising two homogeneous layers arranged in series along the $x$-axis. The left layer occupies $x\\in[0,L_1]$ with constant thermal conductivity $k_1$, and the right layer occupies $x\\in[L_1,L_1+L_2]$ with constant thermal conductivity $k_2$. The interface at $x=L_1$ has an interfacial thermal resistance $R_\\text{int}$ such that the temperature jump across the interface is proportional to the common heat flux crossing the interface.\n- Apply Dirichlet boundary conditions at the ends: $T(0)=T_\\text{left}$ and $T(L_1+L_2)=T_\\text{right}$.\n- Assume a unit cross-sectional area $A=1$ m$^2$.\n\nDiscretization requirements:\n- Build a finite-volume or finite-difference discretization on cell centers such that each internal face contributes a thermal conductance equal to the reciprocal of the sum of the appropriate face resistances.\n- For faces inside a homogeneous layer, the face resistance is the sum of half-cell resistances from the adjacent cells.\n- At the material interface, the face resistance must include the interfacial thermal resistance $R_\\text{int}$ in addition to the two half-cell resistances. This ensures the discrete model captures a finite temperature jump at the interface while preserving heat flux continuity.\n- Dirichlet boundary conditions must be imposed consistently using half-cell boundary resistances.\n\nAnalytical benchmark requirement:\n- Using only the listed fundamental principles, derive a closed-form analytical temperature field for this configuration, which is piecewise linear in each layer with a temperature jump at the interface proportional to the interfacial heat flux. The common heat flux and the temperature profiles must be expressed in terms of $L_1$, $L_2$, $k_1$, $k_2$, $R_\\text{int}$, $T_\\text{left}$, and $T_\\text{right}$.\n\nVerification requirement:\n- Implement your discretization and compute the numerical temperature at the centers of all cells.\n- Compute the analytical temperature at the same cell-center locations.\n- For each test case, report the maximum absolute difference between the numerical and analytical temperatures, expressed in Kelvin and rounded to six digits after the decimal point.\n\nTest suite:\nUse the following four test cases to validate your implementation. For each case, $L_1$, $L_2$ are in meters, $k_1$, $k_2$ are in Watts per meter-Kelvin, $R_\\text{int}$ is in meter-squared-Kelvin per Watt, and $T_\\text{left}$, $T_\\text{right}$ are in Kelvin. The number of cells in layer $i$ is $N_i$.\n\n- Case 1 (contrast in conductivities with moderate interfacial resistance):\n  - $L_1 = 80\\times 10^{-6}$ m, $L_2 = 16\\times 10^{-6}$ m, $k_1 = 0.3$ W m$^{-1}$ K$^{-1}$, $k_2 = 200$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 1.0\\times 10^{-5}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 320$ K, $T_\\text{right} = 300$ K, $N_1 = 40$, $N_2 = 40$.\n- Case 2 (no interfacial resistance, identical layers):\n  - $L_1 = 0.01$ m, $L_2 = 0.01$ m, $k_1 = 1.0$ W m$^{-1}$ K$^{-1}$, $k_2 = 1.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 0$ m$^2$ K W$^{-1}$, $T_\\text{left} = 400$ K, $T_\\text{right} = 350$ K, $N_1 = 10$, $N_2 = 10$.\n- Case 3 (dominant interfacial resistance):\n  - $L_1 = 1.0\\times 10^{-3}$ m, $L_2 = 1.0\\times 10^{-3}$ m, $k_1 = 10.0$ W m$^{-1}$ K$^{-1}$, $k_2 = 10.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 1.0\\times 10^{-2}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 310$ K, $T_\\text{right} = 300$ K, $N_1 = 50$, $N_2 = 50$.\n- Case 4 (zero end-to-end temperature difference):\n  - $L_1 = 5.0\\times 10^{-4}$ m, $L_2 = 7.0\\times 10^{-4}$ m, $k_1 = 2.5$ W m$^{-1}$ K$^{-1}$, $k_2 = 5.0$ W m$^{-1}$ K$^{-1}$, $R_\\text{int} = 3.0\\times 10^{-5}$ m$^2$ K W$^{-1}$, $T_\\text{left} = 300$ K, $T_\\text{right} = 300$ K, $N_1 = 25$, $N_2 = 25$.\n\nWhat your program must do:\n- Assemble and solve the discrete system for each test case to obtain the numerical temperature field.\n- Evaluate the analytical temperature field at the same cell-center locations.\n- For each case, compute the maximum absolute error in Kelvin and round it to six digits after the decimal point.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, the four maximum absolute errors in Kelvin for the four test cases, each rounded to six digits after the decimal point (e.g., \"[0.000001,0.000002,0.123457,0.000000]\").",
            "solution": "The user-provided problem is a well-posed, one-dimensional, steady-state heat conduction problem for a composite slab with interfacial thermal resistance. The problem is scientifically grounded, self-contained, and all parameters are clearly defined. No inconsistencies or invalid premises have been identified. Therefore, the problem is valid and can be solved.\n\nThe solution is developed in three parts: first, the derivation of the analytical temperature profile; second, the formulation of a finite volume numerical model; and third, the implementation of both to verify the numerical model against the analytical benchmark.\n\n### 1. Analytical Solution\n\nThe problem is governed by the steady-state, one-dimensional heat conduction equation with no internal heat generation. For a homogeneous material with constant thermal conductivity $k$, this is given by:\n$$\n\\frac{d}{dx}\\left(-k\\frac{dT}{dx}\\right) = 0\n$$\nThis implies that the heat flux, $q^{\\prime\\prime} = -k\\frac{dT}{dx}$, is constant throughout the slab. Integrating the equation twice shows that the temperature profile $T(x)$ is piecewise linear within each layer.\n\nWe can model the system as a series of thermal resistances. For a unit cross-sectional area ($A=1 \\, \\text{m}^2$), the total thermal resistance $R_\\text{total}$ is the sum of the resistances of the two layers and the interfacial resistance:\n$$\nR_\\text{total} = R_1 + R_\\text{int} + R_2\n$$\nwhere $R_1 = L_1/k_1$ is the resistance of the first layer, $R_2 = L_2/k_2$ is the resistance of the second layer, and $R_\\text{int}$ is the interfacial thermal resistance (given in units of $\\text{m}^2\\cdot\\text{K}/\\text{W}$, which corresponds to resistance for a unit area).\nThe total resistance is:\n$$\nR_\\text{total} = \\frac{L_1}{k_1} + R_\\text{int} + \\frac{L_2}{k_2}\n$$\nThe constant heat flux $q^{\\prime\\prime}$ flowing from the left boundary ($x=0$) to the right boundary ($x=L_1+L_2$) is driven by the overall temperature difference $\\Delta T = T_\\text{left} - T_\\text{right}$ and inversely proportional to the total resistance:\n$$\nq^{\\prime\\prime} = \\frac{T_\\text{left} - T_\\text{right}}{R_\\text{total}} = \\frac{T_\\text{left} - T_\\text{right}}{\\frac{L_1}{k_1} + R_\\text{int} + \\frac{L_2}{k_2}}\n$$\nIf $T_\\text{left} = T_\\text{right}$, then $q^{\\prime\\prime} = 0$.\n\nWith the heat flux known, the temperature profile $T(x)$ can be determined.\nFor the first layer, $x \\in [0, L_1]$:\nThe temperature drops linearly from $T_\\text{left}$ at $x=0$.\n$$\nT(x) = T_\\text{left} - q^{\\prime\\prime} \\frac{x}{k_1}\n$$\nAt the interface, $x=L_1$, the temperature on the left side is $T(L_1^-) = T_\\text{left} - q^{\\prime\\prime} \\frac{L_1}{k_1}$.\n\nAcross the interface, there is a temperature drop proportional to the heat flux, $\\Delta T_\\text{int} = q^{\\prime\\prime} R_\\text{int}$. The temperature on the right side of the interface, $T(L_1^+)$, is:\n$$\nT(L_1^+) = T(L_1^-) - q^{\\prime\\prime} R_\\text{int} = T_\\text{left} - q^{\\prime\\prime} \\left( \\frac{L_1}{k_1} + R_\\text{int} \\right)\n$$\nFor the second layer, $x \\in (L_1, L_1+L_2]$:\nThe temperature drops linearly from $T(L_1^+)$. The temperature at a point $x$ is:\n$$\nT(x) = T(L_1^+) - q^{\\prime\\prime} \\frac{x-L_1}{k_2} = T_\\text{left} - q^{\\prime\\prime} \\left( \\frac{L_1}{k_1} + R_\\text{int} + \\frac{x-L_1}{k_2} \\right)\n$$\nThis completes the analytical solution.\n\n### 2. Numerical Model (Finite Volume Method)\n\nThe domain is discretized into $N = N_1 + N_2$ control volumes (cells). Layer $1$ contains $N_1$ cells of width $\\Delta x_1 = L_1/N_1$, and layer $2$ contains $N_2$ cells of width $\\Delta x_2 = L_2/N_2$. Let $T_i$ be the temperature at the center of cell $i$.\n\nThe steady-state energy balance for each cell $i$ states that the sum of heat fluxes into the cell is zero.\n$$\n\\sum_j q_{j \\to i} = 0\n$$\nwhere $q_{j \\to i}$ is the heat rate from an adjacent cell $j$ (or boundary) to cell $i$. Assuming unit area, this is equivalent to balancing heat fluxes $q^{\\prime\\prime}$. The flux between two cell centers, $i$ and $i+1$, is $q^{\\prime\\prime}_{i+1/2} = C_{i+1/2}(T_i - T_{i+1})$, where $C_{i+1/2}$ is the thermal conductance between the cell centers.\n\nThe conductance is the reciprocal of the total thermal resistance between the cell centers.\n- **Within a homogeneous layer** (e.g., between cells $i$ and $i+1$ in layer 1): The resistance is the sum of two half-cell resistances.\n$$\nR_{i, i+1} = \\frac{\\Delta x_1/2}{k_1} + \\frac{\\Delta x_1/2}{k_1} = \\frac{\\Delta x_1}{k_1} \\quad \\implies \\quad C_{i, i+1} = \\frac{k_1}{\\Delta x_1}\n$$\n- **At the material interface** (between cell $N_1$ and $N_1+1$): The resistance includes the two half-cell resistances and the interfacial resistance.\n$$\nR_{N_1, N_1+1} = \\frac{\\Delta x_1/2}{k_1} + R_\\text{int} + \\frac{\\Delta x_2/2}{k_2} \\quad \\implies \\quad C_{N_1, N_1+1} = \\frac{1}{\\frac{\\Delta x_1}{2k_1} + R_\\text{int} + \\frac{\\Delta x_2}{2k_2}}\n$$\n- **At the boundaries**: The resistance between the boundary and the first/last cell center is a half-cell resistance.\n  - Left boundary: $R_{L,1} = \\frac{\\Delta x_1/2}{k_1} \\implies C_{L,1} = \\frac{k_1}{\\Delta x_1/2} = \\frac{2k_1}{\\Delta x_1}$\n  - Right boundary: $R_{N,R} = \\frac{\\Delta x_2/2}{k_2} \\implies C_{N,R} = \\frac{k_2}{\\Delta x_2/2} = \\frac{2k_2}{\\Delta x_2}$\n\nApplying the energy balance to each cell generates a system of linear equations $A\\vec{T} = \\vec{b}$ for the unknown cell temperatures $\\vec{T} = [T_1, T_2, \\dots, T_N]^T$. The system is tridiagonal.\n\n- **Cell 1 (left boundary):** $C_{L,1}(T_\\text{left} - T_1) + C_{1,2}(T_2 - T_1) = 0$\n  $$ -(C_{L,1} + C_{1,2})T_1 + C_{1,2}T_2 = -C_{L,1}T_\\text{left} $$\n- **Interior cell $i$ in Layer 1 ($1 < i < N_1$):** $C_{i-1,i}(T_{i-1} - T_i) + C_{i,i+1}(T_{i+1} - T_i) = 0$\n  $$ C_{i-1,i}T_{i-1} - (C_{i-1,i} + C_{i,i+1})T_i + C_{i,i+1}T_{i+1} = 0 $$\n- **Cell $N_1$ (interface):** $C_{N_1-1,N_1}(T_{N_1-1} - T_{N_1}) + C_{N_1,N_1+1}(T_{N_1+1} - T_{N_1}) = 0$\n  $$ C_{N_1-1,N_1}T_{N_1-1} - (C_{N_1-1,N_1} + C_{N_1,N_1+1})T_{N_1} + C_{N_1,N_1+1}T_{N_1+1} = 0 $$\n- **Cell $N_1+1$ (interface):** $C_{N_1,N_1+1}(T_{N_1} - T_{N_1+1}) + C_{N_1+1,N_1+2}(T_{N_1+2} - T_{N_1+1}) = 0$\n  $$ C_{N_1,N_1+1}T_{N_1} - (C_{N_1,N_1+1} + C_{N_1+1,N_1+2})T_{N_1+1} + C_{N_1+1,N_1+2}T_{N_1+2} = 0 $$\n- **Interior cell $i$ in Layer 2 ($N_1+1 < i < N$):** Similar to interior cells in layer 1, with appropriate conductances.\n- **Cell $N$ (right boundary):** $C_{N-1,N}(T_{N-1} - T_N) + C_{N,R}(T_\\text{right} - T_N) = 0$\n  $$ C_{N-1,N}T_{N-1} - (C_{N-1,N} + C_{N,R})T_N = -C_{N,R}T_\\text{right} $$\n\nThis tridiagonal system is assembled and solved for $\\vec{T}$.\n\n### 3. Verification\n\nThe numerical solution for the temperatures $T_i$ at the cell centers is compared against the analytical solution evaluated at the same cell center coordinates $x_i$. The maximum absolute difference, $\\max_i |T_{i, \\text{numerical}} - T_{i, \\text{analytical}}|$, is computed for each test case as the verification metric. The implementation confirms that for the provided test cases, the finite volume model accurately reproduces the analytical solution, with errors approaching machine precision. This validates the discretization of the interface condition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state heat conduction problem for a two-layer slab\n    with interfacial resistance for a given set of test cases.\n    It calculates both numerical and analytical solutions and finds the\n    maximum absolute error between them.\n    \"\"\"\n    test_cases = [\n        # Case 1: Contrast in conductivities\n        {\n            \"L1\": 80e-6, \"L2\": 16e-6, \"k1\": 0.3, \"k2\": 200,\n            \"R_int\": 1.0e-5, \"T_left\": 320, \"T_right\": 300,\n            \"N1\": 40, \"N2\": 40\n        },\n        # Case 2: No interfacial resistance, identical layers\n        {\n            \"L1\": 0.01, \"L2\": 0.01, \"k1\": 1.0, \"k2\": 1.0,\n            \"R_int\": 0, \"T_left\": 400, \"T_right\": 350,\n            \"N1\": 10, \"N2\": 10\n        },\n        # Case 3: Dominant interfacial resistance\n        {\n            \"L1\": 1.0e-3, \"L2\": 1.0e-3, \"k1\": 10.0, \"k2\": 10.0,\n            \"R_int\": 1.0e-2, \"T_left\": 310, \"T_right\": 300,\n            \"N1\": 50, \"N2\": 50\n        },\n        # Case 4: Zero end-to-end temperature difference\n        {\n            \"L1\": 5.0e-4, \"L2\": 7.0e-4, \"k1\": 2.5, \"k2\": 5.0,\n            \"R_int\": 3.0e-5, \"T_left\": 300, \"T_right\": 300,\n            \"N1\": 25, \"N2\": 25\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        max_error = solve_one_case(**params)\n        results.append(f\"{max_error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_one_case(L1, L2, k1, k2, R_int, T_left, T_right, N1, N2):\n    \"\"\"\n    Solves a single case of the heat conduction problem.\n\n    Returns:\n        float: The maximum absolute error between numerical and analytical solutions.\n    \"\"\"\n    N = N1 + N2\n    dx1 = L1 / N1\n    dx2 = L2 / N2\n\n    # --- Analytical Solution ---\n    R1 = L1 / k1 if k1 > 0 else float('inf')\n    R2 = L2 / k2 if k2 > 0 else float('inf')\n    R_total = R1 + R_int + R2\n\n    if abs(R_total)  1e-15: # Avoid division by zero if all resistances are zero\n        q_flux = 0.0\n    else:\n        q_flux = (T_left - T_right) / R_total\n\n    x_centers = np.concatenate([\n        np.linspace(dx1 / 2, L1 - dx1 / 2, N1),\n        np.linspace(L1 + dx2 / 2, L1 + L2 - dx2 / 2, N2)\n    ])\n\n    T_analytical = np.zeros(N)\n    for i, x in enumerate(x_centers):\n        if x = L1:\n            T_analytical[i] = T_left - q_flux * (x / k1)\n        else:\n            T_analytical[i] = T_left - q_flux * (R1 + R_int + (x - L1) / k2)\n\n    # --- Numerical Solution (Finite Volume Method) ---\n    # The system is A*T = b, where A is tridiagonal. We build the three diagonals.\n    # We use scipy.linalg.solve_banded which takes a matrix `ab` where\n    # ab[0,:] is the upper diagonal, ab[1,:] is the main, ab[2,:] is the lower.\n    ab = np.zeros((3, N))\n    b = np.zeros(N)\n\n    # Conductance definitions\n    C_layer1 = k1 / dx1\n    C_layer2 = k2 / dx2\n    C_interface = 1 / (dx1 / (2 * k1) + R_int + dx2 / (2 * k2))\n    C_left_bnd = 2 * k1 / dx1\n    C_right_bnd = 2 * k2 / dx2\n\n    # Assemble the matrix diagonals and the rhs vector b\n    # Loop over cell indices (0-based)\n    for i in range(N):\n        if i == 0:  # Left boundary cell\n            C_W = C_left_bnd\n            C_E = C_layer1\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n            b[i] = -C_W * T_left\n        elif i  N1 - 1:  # Interior cell in layer 1\n            C_W = C_layer1\n            C_E = C_layer1\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N1 - 1:  # Cell before interface\n            C_W = C_layer1\n            C_E = C_interface\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N1:  # Cell after interface\n            C_W = C_interface\n            C_E = C_layer2\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i  N - 1: # Interior cell in layer 2\n            C_W = C_layer2\n            C_E = C_layer2\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            ab[0, i + 1] = C_E\n        elif i == N - 1: # Right boundary cell\n            C_W = C_layer2\n            C_E = C_right_bnd\n            ab[2, i - 1] = C_W\n            ab[1, i] = -(C_W + C_E)\n            b[i] = -C_E * T_right\n\n    # Solve the tridiagonal system\n    T_numerical = solve_banded((1, 1), ab, b)\n    \n    # --- Verification ---\n    max_error = np.max(np.abs(T_numerical - T_analytical))\n    return max_error\n    \n# Execute the solver\nsolve()\n```"
        }
    ]
}