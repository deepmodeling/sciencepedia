{
    "hands_on_practices": [
        {
            "introduction": "开路电压（OCV）和熵系数是热力学平衡态的性质，因此确保电池达到平衡是精确测量的先决条件。本练习将指导您通过对两个关键弛豫过程——活性材料颗粒内部的锂离子扩散和电芯的整体热传导——进行建模，来计算获得可靠测量结果所必需的静置时间。通过分析，您将学会如何确定实验中的速率控制步骤，这对于设计高效且准确的测量流程至关重要 。",
            "id": "3934479",
            "problem": "为了测量开路电压（OCV）-化学计量关系以及定义为在固定化学计量比下 OCV 的温度导数 $\\partial U/\\partial T$ 的熵系数，我们制备了一个锂离子半电池。为确保 OCV 读数及其温度依赖性均反映热力学平衡，在停止小幅调节电流后和施加小幅温度阶跃后，电极在开路条件下被允许静置。复合电极被建模为半径为 $L$ 的球形活性材料颗粒的集合，每个颗粒在目标化学计量比下都遵循菲克固态扩散定律，并具有恒定的扩散系数 $D$。电流中断后，界面通量立即变为零，扩散过程开始弛豫颗粒内的任何浓度梯度。电池在小幅温度阶跃后的热弛豫被建模为具有单一时间常数的一阶过程。\n\n从球对称下的菲克第二定律和集总热系统的牛顿冷却定律出发，推导出一个表达式，用于计算确保以下条件所需的最小静置时间 $t_{\\mathrm{rest}}$：\n- 颗粒内浓度梯度已经弛豫，使得与均匀浓度的残余偏差已减小到其初始值的 $(1-f)$ 倍，并且\n- 电池温度已经弛豫，使得与其最终值的残余偏差已减小到其初始值的 $(1-f)$ 倍，\n其中指定了 $0  f  1$。使用以下参数计算 $t_{\\mathrm{rest}}$ 的数值：\n- **颗粒半径** $L = 4.0 \\times 10^{-6}\\ \\mathrm{m}$\n- **固态扩散系数** $D = 5.0 \\times 10^{-15}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- **热时间常数** $\\tau_{\\mathrm{th}} = 600\\ \\mathrm{s}$\n- **目标平衡分数** $f = 0.995$\n\n通过识别哪个弛豫过程（浓度或热）是速率限制步骤来论证您的结果。",
            "solution": "首先根据所需标准验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **系统：** 一个锂离子半电池，其复合电极被建模为球形活性材料颗粒的集合。\n- **颗粒半径：** $L = 4.0 \\times 10^{-6}\\ \\mathrm{m}$。\n- **固态扩散系数：** $D = 5.0 \\times 10^{-15}\\ \\mathrm{m^{2}\\,s^{-1}}$ (恒定)。\n- **热时间常数：** $\\tau_{\\mathrm{th}} = 600\\ \\mathrm{s}$。\n- **目标平衡分数：** $f = 0.995$。\n- **过程 1 (浓度)：** 颗粒内浓度弛豫由球坐标系下的菲克扩散控制。颗粒表面（$r=L$）的边界条件为零通量。假设弛豫由最慢的非零扩散本征模主导。\n- **过程 2 (热)：** 电池温度弛豫被建模为具有时间常数 $\\tau_{\\mathrm{th}}$ 的一阶过程。\n- **静置时间的条件 ($t_{\\mathrm{rest}}$)：** 所需的最小时间，以使 i) 与均匀浓度的残余偏差减小到其初始值的 $(1-f)$ 倍，以及 ii) 电池温度与其最终值的残余偏差减小到其初始值的 $(1-f)$ 倍。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于传质（菲克扩散定律）和传热（牛顿冷却定律）的基本原理。这些是电化学工程和电池模拟领域（例如，在 Doyle-Fuller-Newman 或 P$2$D 模型中）使用的标准模型。所提供的参数对于锂离子电池材料而言是物理上 realistic 的。\n- **适定性：** 该问题提供了足够的信息来确定唯一解。控制方程、边界条件和弛豫标准都已明确指定。使用最慢本征模的假设解决了定义“与均匀浓度的残余偏差”时可能存在的模糊性。\n- **客观性：** 问题陈述使用精确、客观的语言表达，没有主观或基于意见的论断。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定且客观。将推导求解。\n\n### 求解推导\n\n最小静置时间 $t_{\\mathrm{rest}}$ 必须足以让浓度和热弛豫都满足指定标准。这意味着 $t_{\\mathrm{rest}}$ 必须是两个独立弛豫时间 $t_{\\mathrm{conc}}$ 和 $t_{\\mathrm{therm}}$ 中较大的一个。\n$t_{\\mathrm{rest}} = \\max(t_{\\mathrm{conc}}, t_{\\mathrm{therm}})$。\n\n**1. 浓度弛豫时间 ($t_{\\mathrm{conc}}$)**\n\n半径为 $L$ 的球形颗粒内部浓度场 $c(r, t)$ 的弛豫由球坐标系下的菲克第二定律控制：\n$$ \\frac{\\partial c}{\\partial t} = D \\nabla^2 c = D \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial c}{\\partial r} \\right) $$\n边界条件是中心处（由于对称性）和表面处（由于开路条件）通量为零：\n$$ \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=0} = 0 \\quad \\text{和} \\quad \\left. \\frac{\\partial c}{\\partial r} \\right|_{r=L} = 0 $$\n此偏微分方程的解可以通过分离变量法找到。浓度与最终均匀平衡浓度 $c_{\\infty}$ 的偏差 $\\Delta c(r, t) = c(r, t) - c_{\\infty}$，可以表示为衰减本征模的无穷级数。问题陈述表明，弛豫由最慢的非零本征模主导。\n\n解的空间部分涉及求解满足边界条件的本征值 $\\lambda_n$。对于给定的边界条件，本征值是超越方程的根：\n$$ \\tan(\\lambda_n L) = \\lambda_n L $$\n令 $\\mu_n = \\lambda_n L$。方程为 $\\tan(\\mu_n) = \\mu_n$。$n=0$ 的解 $\\mu_0=0$ 对应于均匀稳态浓度。最慢的非零衰减模式对应于最小的正根 $\\mu_1$。数值上，$\\mu_1 \\approx 4.4934$。\n\n这个最慢模式的时间相关部分以特征时间常数 $\\tau_{\\mathrm{diff}}$ 指数衰减：\n$$ \\tau_{\\mathrm{diff}} = \\frac{1}{D \\lambda_1^2} = \\frac{L^2}{D \\mu_1^2} $$\n与平衡的偏差（与此模式成正比）按 $\\exp(-t/\\tau_{\\mathrm{diff}})$ 衰减。条件是，在时间 $t_{\\mathrm{conc}}$ 时的残余偏差是初始偏差的 $(1-f)$ 倍：\n$$ \\frac{\\Delta c(t_{\\mathrm{conc}})}{\\Delta c(0)} = \\exp\\left(-\\frac{t_{\\mathrm{conc}}}{\\tau_{\\mathrm{diff}}}\\right) = 1 - f $$\n求解 $t_{\\mathrm{conc}}$：\n$$ -\\frac{t_{\\mathrm{conc}}}{\\tau_{\\mathrm{diff}}} = \\ln(1-f) $$\n$$ t_{\\mathrm{conc}} = - \\tau_{\\mathrm{diff}} \\ln(1-f) = -\\frac{L^2}{D \\mu_1^2} \\ln(1-f) $$\n\n**2. 热弛豫时间 ($t_{\\mathrm{therm}}$)**\n\n电池温度 $T(t)$ 被建模为一个集总系统，根据牛顿冷却定律进行弛豫，这是一个具有给定时间常数 $\\tau_{\\mathrm{th}}$ 的一阶过程。与最终温度的偏差 $\\Delta T(t) = T(t) - T_{f}$ 遵循以下方程：\n$$ \\frac{d(\\Delta T)}{dt} = -\\frac{1}{\\tau_{\\mathrm{th}}} \\Delta T $$\n解为 $\\Delta T(t) = \\Delta T(0) \\exp(-t/\\tau_{\\mathrm{th}})$。热弛豫的条件与浓度情况类似：\n$$ \\frac{\\Delta T(t_{\\mathrm{therm}})}{\\Delta T(0)} = \\exp\\left(-\\frac{t_{\\mathrm{therm}}}{\\tau_{\\mathrm{th}}}\\right) = 1-f $$\n求解 $t_{\\mathrm{therm}}$：\n$$ t_{\\mathrm{therm}} = -\\tau_{\\mathrm{th}} \\ln(1-f) $$\n\n**3. 最小静置时间的计算 ($t_{\\mathrm{rest}}$)**\n\n首先，我们比较特征时间常数 $\\tau_{\\mathrm{diff}}$ 和 $\\tau_{\\mathrm{th}}$。\n给定值：\n$L = 4.0 \\times 10^{-6}\\ \\mathrm{m}$\n$D = 5.0 \\times 10^{-15}\\ \\mathrm{m^{2}\\,s^{-1}}$\n$\\tau_{\\mathrm{th}} = 600\\ \\mathrm{s}$\n$\\mu_1^2 \\approx (4.4934)^2 \\approx 20.1907$\n\n扩散时间常数为：\n$$ \\tau_{\\mathrm{diff}} = \\frac{L^2}{D \\mu_1^2} = \\frac{(4.0 \\times 10^{-6}\\ \\mathrm{m})^2}{(5.0 \\times 10^{-15}\\ \\mathrm{m^{2}\\,s^{-1}})(20.1907)} = \\frac{1.6 \\times 10^{-11}\\ \\mathrm{m^2}}{1.0095 \\times 10^{-13}\\ \\mathrm{m^2\\,s^{-1}}} \\approx 158.5\\ \\mathrm{s} $$\n比较时间常数：\n$$ \\tau_{\\mathrm{diff}} \\approx 158.5\\ \\mathrm{s} \\quad  \\quad \\tau_{\\mathrm{th}} = 600\\ \\mathrm{s} $$\n由于 $\\tau_{\\mathrm{th}} > \\tau_{\\mathrm{diff}}$，热弛豫是较慢的过程，因此决定了最小静置时间。\n$$ t_{\\mathrm{rest}} = t_{\\mathrm{therm}} = -\\tau_{\\mathrm{th}} \\ln(1-f) $$\n现在，我们代入 $\\tau_{\\mathrm{th}}$ 和 $f$ 的数值：\n$f = 0.995$，所以 $1-f = 0.005$。\n$$ t_{\\mathrm{rest}} = - (600\\ \\mathrm{s}) \\ln(0.005) \\approx - (600\\ \\mathrm{s})(-5.298317) \\approx 3178.99\\ \\mathrm{s} $$\n四舍五入至三位有效数字，我们得到 $3180\\ \\mathrm{s}$。\n\n### 论证\n计算表明，热弛豫的特征时间 ($\\tau_{\\mathrm{th}} = 600\\ \\mathrm{s}$) 显著长于颗粒内浓度弛豫的特征时间 ($\\tau_{\\mathrm{diff}} \\approx 158.5\\ \\mathrm{s}$)。因此，半电池的整体平衡受传热速率限制，而非活性材料颗粒内的传质速率。熵系数 $\\partial U/\\partial T$ 的测量涉及测量 OCV ($U$) 对小的、受控的温度变化 ($T$) 的响应。为了使此测量反映真实的热力学性质，电池必须在每个温度设定点都处于热平衡状态。由于热弛豫是主导（最慢）过程，因此最小静置时间必须由电池温度稳定所需的时间决定。在此时间范围内，浓度梯度将早已弛豫到所需程度。因此，实验装置的热力学动态是此项测量的主要约束。",
            "answer": "$$\\boxed{3.18 \\times 10^{3}}$$"
        },
        {
            "introduction": "在实际测量中，由于引线电阻和热电效应（塞贝克效应）等寄生效应的存在，仪器读数往往不等于真实的开路电压。本练习旨在阐明如何对这些测量伪影进行建模和修正，从而从受影响的测量数据中恢复真实的熵系数值。通过这个过程，您将深刻理解为何采用四端子（开尔文）测量法等先进技术对于从源头上减少测量误差至关重要 。",
            "id": "3934468",
            "problem": "一个锂离子电池正在一个自动化电池设计和仿真平台上进行表征，以绘制其开路电压 (OCV) 作为化学计量和温度的函数，在化学计量分数 $x \\approx 0.5$ 附近。开路电压 (OCV)，记为 $U(x,T)$，是由电极上电化学电势差定义的平衡电池电势。熵系数是在固定化学计量下 OCV 对温度的导数，即 $(\\partial U/\\partial T)_{x}$。\n\n为了在无需完全弛豫的情况下稳定近开路状态的测量，该平台采用一个大小为 $I_{m}$ 的微电流控制（一个恒定的非零电流，其值小到足以使内部极化在一阶近似下可以忽略），同时在仪器接线柱处记录表观电压 $V_{\\mathrm{meas}}(x,T)$。仪器到电池的连接使用两根载流导线，每根导线具有有限的导线电阻 $R_{l}(T)$，并且在电池端子处存在有限的接触电阻 $R_{c}(T)$。导线与电池极耳的金属材料不同，因此存在与金属结和温度梯度相关的热电 (Seebeck) 偏移电压 $V_{S}(T)$。\n\n仅从基本定律和核心定义出发：\n- 用于串联电阻压降的欧姆定律 ($V=IR$)，\n- Seebeck 效应 ($V_{S}=\\int S\\,\\mathrm{d}T$，对于热电偶路径，其中 $S$ 是 Seebeck 系数)，\n- OCV $U(x,T)$ 和熵系数 $(\\partial U/\\partial T)_{x}$ 的定义，\n\n完成以下任务：\n\n1. 在 $I_{m}$ 的一阶近似下，推导表观两端测量电压 $V_{\\mathrm{meas}}(x,T)$ 的符号表达式，用 $U(x,T)$、$I_{m}$、$R_{c}(T)$、$R_{l}(T)$ 和 $V_{S}(T)$ 表示。清晰地说明 $I_{m}$ 的符号约定以及由此产生的电阻贡献项的符号。\n\n2. 提出一个四端 (Kelvin) 测量方案，并用它推导实验观测到的温度斜率 $\\mathrm{d}V_{\\mathrm{meas}}/\\mathrm{d}T$ 与真实熵系数 $(\\partial U/\\partial T)_{x}$ 之间的关系。您的推导应将 $(\\partial U/\\partial T)_{x}$ 分离出来，用可测量量和寄生参数的温度导数表示，并允许非零的 $\\mathrm{d}V_{S}/\\mathrm{d}T$。\n\n3. 使用推导出的关系，根据在两端微电流控制下获得的以下数据，计算 $x \\approx 0.5$ 处的修正熵系数 $(\\partial U/\\partial T)_{x}$：\n- 测量斜率 $\\mathrm{d}V_{\\mathrm{meas}}/\\mathrm{d}T = -0.35 \\ \\mathrm{mV/K}$，\n- 微电流大小 $I_{m} = 100 \\ \\mu\\mathrm{A}$ (取正 $I_{m}$ 为放电，通过电阻压降降低端电压)，\n- 接触电阻建模为 $R_{c}(T) = R_{c0}\\left[1+\\alpha_{c}\\left(T-298 \\ \\mathrm{K}\\right)\\right]$，其中 $R_{c0} = 20 \\ \\mathrm{m}\\Omega$，温度系数 $\\alpha_{c} = 3.0 \\times 10^{-3} \\ \\mathrm{K}^{-1}$，\n- 每根导线的电阻建模为 $R_{l}(T) = R_{l0}\\left[1+\\alpha_{l}\\left(T-298 \\ \\mathrm{K}\\right)\\right]$，其中 $R_{l0} = 50 \\ \\mathrm{m}\\Omega$，温度系数 $\\alpha_{l} = 2.0 \\times 10^{-3} \\ \\mathrm{K}^{-1}$，\n- 由于不可避免的不对称性，净热电斜率 $\\mathrm{d}V_{S}/\\mathrm{d}T = +2.0 \\ \\mu\\mathrm{V/K}$。\n\n假设总寄生路径为一个接触电阻与两根相同的导线串联，忽略微电流下的内部电池极化和任何非欧姆动力学，并对 $298 \\ \\mathrm{K}$ 附近的温度变化进行一阶近似处理。将 $(\\partial U/\\partial T)_{x}$ 的最终数值答案以 $\\mathrm{mV/K}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "我们首先对物理模型进行形式化。开路电压 (OCV) $U(x,T)$ 是在给定化学计量分数 $x$ 和温度 $T$ 下的平衡电势。当施加一个微小电流 $I_{m}$ 时，由于连接上的串联欧姆压降和热电偏移，仪器在其接线柱处测量的电压会与 $U(x,T)$ 不同。根据欧姆定律，流过电阻 $R(T)$ 的电流 $I_{m}$ 产生的串联压降为 $I_{m} R(T)$。根据 Seebeck 效应，具有 Seebeck 系数 $S$ 的热电路径会产生一个偏移电压 $V_{S}(T)=\\int S\\,\\mathrm{d}T$，因此对于有效热电偶，局部有 $\\mathrm{d}V_{S}/\\mathrm{d}T=S_{\\mathrm{eff}}$。\n\n我们采用符号约定，$I_{m}0$ 对应于放电（电流从正极端流出），这会降低任何串联电阻上的端电压。设 $R_{\\mathrm{path}}(T)$ 为总寄生路径电阻，模型为\n$$\nR_{\\mathrm{path}}(T)=R_{c}(T)+2\\,R_{l}(T),\n$$\n包含一个接触电阻和两根相同的串联导线电阻。在 $I_{m}$ 的一阶近似下，表观两端测量电压为\n$$\nV_{\\mathrm{meas}}(x,T)=U(x,T)-I_{m}R_{\\mathrm{path}}(T)+V_{S}(T).\n$$\n电阻项中的负号是因为在放电过程中，欧姆压降会降低测量的端电压。\n\n四端 (Kelvin) 测量方案使用两条独立的感测导线直接连接到电池端子，其吸收的电流可忽略不计，而电流则由独立的驱动导线承载。在 Kelvin 配置中，感测导线测量的是电池端子处的电势，不受驱动导线及其驱动接触电阻上的欧姆压降影响，因为感测导线中的电流近似为零，因此在感测路径上产生的 $I R$ 压降可以忽略。如果感测线路的金属和结点产生了净 Seebeck 路径，残余的热电偏移 $V_{S}(T)$ 仍然可能存在；这些偏移可通过使用相同的金属和对称布线来最小化，但此处仍将其作为一个非零的 $\\mathrm{d}V_{S}/\\mathrm{d}T$ 包含在内。\n\n将两端法表达式对温度在固定化学计量 $x$ 下求导，得到\n$$\n\\frac{\\mathrm{d}V_{\\mathrm{meas}}}{\\mathrm{d}T}=\\left(\\frac{\\partial U}{\\partial T}\\right)_{x}-I_{m}\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}+\\frac{\\mathrm{d}V_{S}}{\\mathrm{d}T}.\n$$\n求解真实的熵系数得到\n$$\n\\left(\\frac{\\partial U}{\\partial T}\\right)_{x}=\\frac{\\mathrm{d}V_{\\mathrm{meas}}}{\\mathrm{d}T}+I_{m}\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}-\\frac{\\mathrm{d}V_{S}}{\\mathrm{d}T}.\n$$\n在 Kelvin 配置下，$R_{\\mathrm{path}}(T)$ 仅指驱动路径；由于感测路径承载的电流可忽略不计，欧姆项不会出现在感测电压中，但当使用两端法数据时，上述修正仍然适用。\n\n我们现在使用所提供的线性电阻温度系数 (TCR) 模型来评估修正项：\n$$\nR_{c}(T)=R_{c0}\\left[1+\\alpha_{c}\\left(T-298\\ \\mathrm{K}\\right)\\right],\\quad R_{l}(T)=R_{l0}\\left[1+\\alpha_{l}\\left(T-298\\ \\mathrm{K}\\right)\\right].\n$$\n求导得到\n$$\n\\frac{\\mathrm{d}R_{c}}{\\mathrm{d}T}=R_{c0}\\alpha_{c},\\quad \\frac{\\mathrm{d}R_{l}}{\\mathrm{d}T}=R_{l0}\\alpha_{l},\n$$\n因此\n$$\n\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}=R_{c0}\\alpha_{c}+2\\,R_{l0}\\alpha_{l}.\n$$\n将给定数量转换为基本单位（欧姆、安培、伏特）：\n- $R_{c0}=20\\ \\mathrm{m}\\Omega=2.0\\times 10^{-2}\\ \\Omega$，\n- $R_{l0}=50\\ \\mathrm{m}\\Omega=5.0\\times 10^{-2}\\ \\Omega$，\n- $\\alpha_{c}=3.0\\times 10^{-3}\\ \\mathrm{K}^{-1}$，\n- $\\alpha_{l}=2.0\\times 10^{-3}\\ \\mathrm{K}^{-1}$，\n- $I_{m}=100\\ \\mu\\mathrm{A}=1.0\\times 10^{-4}\\ \\mathrm{A}$，\n- $\\mathrm{d}V_{S}/\\mathrm{d}T=+2.0\\ \\mu\\mathrm{V/K}=2.0\\times 10^{-6}\\ \\mathrm{V/K}$，\n- $\\mathrm{d}V_{\\mathrm{meas}}/\\mathrm{d}T=-0.35\\ \\mathrm{mV/K}=-3.5\\times 10^{-4}\\ \\mathrm{V/K}$。\n\n计算电阻导数：\n$$\n\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}=\\left(2.0\\times 10^{-2}\\right)\\left(3.0\\times 10^{-3}\\right)+2\\left(5.0\\times 10^{-2}\\right)\\left(2.0\\times 10^{-3}\\right).\n$$\n数值上，\n$$\n\\left(2.0\\times 10^{-2}\\right)\\left(3.0\\times 10^{-3}\\right)=6.0\\times 10^{-5}\\ \\Omega/\\mathrm{K},\n$$\n$$\n2\\left(5.0\\times 10^{-2}\\right)\\left(2.0\\times 10^{-3}\\right)=2.0\\times 10^{-4}\\ \\Omega/\\mathrm{K},\n$$\n所以\n$$\n\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}=2.6\\times 10^{-4}\\ \\Omega/\\mathrm{K}.\n$$\n然后\n$$\nI_{m}\\frac{\\mathrm{d}R_{\\mathrm{path}}}{\\mathrm{d}T}=\\left(1.0\\times 10^{-4}\\right)\\left(2.6\\times 10^{-4}\\right)=2.6\\times 10^{-8}\\ \\mathrm{V/K}.\n$$\n代入熵系数表达式：\n$$\n\\left(\\frac{\\partial U}{\\partial T}\\right)_{x}=-3.5\\times 10^{-4}+2.6\\times 10^{-8}-2.0\\times 10^{-6}\\ \\ \\mathrm{V/K}.\n$$\n合并各项：\n$$\n-3.5\\times 10^{-4}-2.0\\times 10^{-6}=-3.52\\times 10^{-4}\\ \\mathrm{V/K},\n$$\n$$\n-3.52\\times 10^{-4}+2.6\\times 10^{-8}=-3.51974\\times 10^{-4}\\ \\mathrm{V/K}.\n$$\n乘以 $10^{3}$ 转换为 $\\mathrm{mV/K}$：\n$$\n-3.51974\\times 10^{-4}\\ \\mathrm{V/K}=-0.351974\\ \\mathrm{mV/K}.\n$$\n四舍五入到三位有效数字：\n$$\n\\left(\\frac{\\partial U}{\\partial T}\\right)_{x}\\approx -0.352\\ \\mathrm{mV/K}.\n$$\n这个值代表了在 $x\\approx 0.5$ 处修正后的熵系数，它考虑了在所述的两端微电流测量条件下寄生欧姆电阻的温度依赖性和热电斜率。当 $\\mathrm{d}V_{S}/\\mathrm{d}T$ 被最小化时，一个正确实施的四端 Kelvin 感测将直接趋近于这个目标量。",
            "answer": "$$\\boxed{-0.352}$$"
        },
        {
            "introduction": "采集到数据后，关键步骤便是从中提取有物理意义的参数。本练习聚焦于数据分析的核心环节，您将通过编程实现加权线性回归算法，从一系列电压-温度数据点中估算熵系数及其不确定度。这项实践还将引导您学习如何将估算结果与参考值进行统计学上的交叉验证，这在自动化电池表征流程中是一项不可或缺的技能 。",
            "id": "3934436",
            "problem": "给你与锂离子电池的开路电压 (OCV) – 化学计量分析相关的测量数据。令 $U(x,T)$ 表示在化学计量变量为 $x$ 和绝对温度为 $T$ 时的开路电压，并定义熵系数 $\\alpha(x)$ 为 $\\alpha(x) = \\left(\\frac{\\partial U}{\\partial T}\\right)_{x}$。从 Gibbs 自由能 $G$ 的热力学定义以及 OCV 与电池反应中 Gibbs 自由能变化之间的关系出发，你的任务是使用统计上可靠的估计方法，从固定 $x$ 下的 $U(T)$ 数据集中计算 $\\alpha(x)$，然后与独立测量的直接温度扫描值进行交叉检验。你的程序必须实现一个有理论依据的估计器，用于从固定 $x$ 下的 $U(T)$ 数据估计 $\\alpha(x)$，并在预定义的不确定度范围内评估其与直接测量值的一致性。\n\n推导的基本原理：\n- 开路电压满足 $U(x,T) = -\\frac{\\Delta G(x,T)}{nF}$，其中 $\\Delta G$ 是电池反应的 Gibbs 自由能变化， $n$ 是每个反应单元转移的电子数， $F$ 是 Faraday 常数。\n- 熵满足 $S = -\\left(\\frac{\\partial G}{\\partial T}\\right)_{p}$，因此 $\\left(\\frac{\\partial U}{\\partial T}\\right)_{x} = \\frac{\\Delta S(x,T)}{nF}$，这定义了固定化学计量下的熵系数。\n- 对于固定 $x$ 下足够小的温度变化，函数 $U(x,T)$ 可以通过在 $T$ 上的一阶展开进行局部近似，熵系数 $\\alpha(x)$ 可以被估计为固定 $x$ 下 $U$ 相对于 $T$ 的最佳拟合斜率。\n\n你的程序必须：\n- 对于每个固定 $x$ 的测试数据集，使用统计上一致的加权线性回归，从给定的 $U(T)$ 测量值中估计 $\\alpha_{\\text{fit}}(x)$（单位为 $\\mathrm{V}\\,\\mathrm{K}^{-1}$），该回归应考虑所提供的电压测量的标准不确定度。假设测量噪声是具有已知方差的独立高斯噪声，使用加权正规方程的逆来计算斜率估计的标准不确定度 $s_{\\alpha,\\text{fit}}(x)$（单位为 $\\mathrm{V}\\,\\mathrm{K}^{-1}$）。\n- 将 $\\alpha_{\\text{fit}}(x)$ 与具有标准不确定度 $s_{\\alpha,\\text{direct}}(x)$（单位为 $\\mathrm{V}\\,\\mathrm{K}^{-1}$）的独立测量的直接值 $\\alpha_{\\text{direct}}(x)$ 进行比较。使用接受准则\n$$\n\\left|\\alpha_{\\text{fit}}(x) - \\alpha_{\\text{direct}}(x)\\right| \\leq K \\sqrt{ s_{\\alpha,\\text{fit}}(x)^2 + s_{\\alpha,\\text{direct}}(x)^2 },\n$$\n其中覆盖因子 $K = 2$。\n- 对每个数据集，输出一个布尔值，指示是否满足一致性准则。\n\n物理和数值单位：\n- 温度 $T$以 $\\mathrm{K}$ 为单位给出，并且必须以 $\\mathrm{K}$ 为单位进行处理。\n- 电压 $U$ 以 $\\mathrm{V}$ 为单位给出，并且必须以 $\\mathrm{V}$ 为单位进行处理。\n- 熵系数 $\\alpha$ 及其不确定度 $s_{\\alpha}$ 必须以 $\\mathrm{V}\\,\\mathrm{K}^{-1}$ 为单位表示。\n\n测试套件：\n提供以下三个数据集，每个数据集都在一个固定的化学计量 $x$ 下：\n\n1. 理想情况（良好的覆盖和一致性）：\n   - $x = 0.45$\n   - 温度 $T$: $[298.0, 303.0, 308.0, 313.0, 318.0]$，单位 $\\mathrm{K}$\n   - 电压 $U$: $[3.850005, 3.85059, 3.85122, 3.85178, 3.85241]$，单位 $\\mathrm{V}$\n   - 电压标准不确定度 $\\sigma_U$: $[5\\times 10^{-5}, 4\\times 10^{-5}, 5\\times 10^{-5}, 6\\times 10^{-5}, 5\\times 10^{-5}]$，单位 $\\mathrm{V}$\n   - 独立熵系数 $\\alpha_{\\text{direct}}$: $0.000119$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n   - 标准不确定度 $s_{\\alpha,\\text{direct}}$: $1.5\\times 10^{-6}$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n\n2. 有噪声但可接受的情况：\n   - $x = 0.65$\n   - 温度 $T$: $[293.0, 298.0, 303.0, 308.0, 313.0, 318.0]$，单位 $\\mathrm{K}$\n   - 电压 $U$: $[3.72038, 3.72001, 3.71962, 3.71919, 3.71883, 3.71838]$，单位 $\\mathrm{V}$\n   - 电压标准不确定度 $\\sigma_U$: $[1.0\\times 10^{-4}, 1.0\\times 10^{-4}, 1.2\\times 10^{-4}, 1.2\\times 10^{-4}, 1.0\\times 10^{-4}, 8.0\\times 10^{-5}]$，单位 $\\mathrm{V}$\n   - 独立熵系数 $\\alpha_{\\text{direct}}$: $-8.2\\times 10^{-5}$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n   - 标准不确定度 $s_{\\alpha,\\text{direct}}$: $5.0\\times 10^{-6}$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n\n3. 边界情况（有限的温度范围）：\n   - $x = 0.05$\n   - 温度 $T$: $[296.0, 298.0, 300.0]$，单位 $\\mathrm{K}$\n   - 电压 $U$: $[3.90972, 3.90999, 3.91028]$，单位 $\\mathrm{V}$\n   - 电压标准不确定度 $\\sigma_U$: $[3.0\\times 10^{-5}, 3.0\\times 10^{-5}, 3.0\\times 10^{-5}]$，单位 $\\mathrm{V}$\n   - 独立熵系数 $\\alpha_{\\text{direct}}$: $1.2\\times 10^{-4}$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n   - 标准不确定度 $s_{\\alpha,\\text{direct}}$: $1.0\\times 10^{-6}$，单位 $\\mathrm{V}\\,\\mathrm{K}^{-1}$\n\n算法要求：\n- 实现 $U$ 相对于 $T$ 的加权线性回归，使用权重 $w_i = 1/\\sigma_{U,i}^2$，设计矩阵为 $X = [\\mathbf{1}, T]$，参数向量为 $\\beta = [\\beta_0, \\beta_1]^\\top$，斜率为 $\\beta_1 = \\alpha_{\\text{fit}}$，协方差矩阵为 $\\mathrm{Cov}(\\beta) = (X^\\top W X)^{-1}$（假设测量误差是具有已知方差的独立高斯误差）。提取 $s_{\\alpha,\\text{fit}} = \\sqrt{\\mathrm{Cov}(\\beta)_{11}}$（斜率标准不确定度）。\n- 使用覆盖因子 $K=2$ 的接受准则，为每个数据集生成一个布尔结果。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的布尔值列表（例如，`[True,False,True]`）。",
            "solution": "该问题是有效的，因为它有科学依据、良定且完整。它基于应用于电化学的热力学基本原理，并使用标准的统计方法进行参数估计。所有必要的数据和一个清晰、明确的计算过程都已提供。\n\n主要目标是估计电池在固定荷电状态（或化学计量）$x$ 下的熵系数 $\\alpha(x) = \\left(\\frac{\\partial U}{\\partial T}\\right)_{x}$。该系数用以量化电芯开路电压 $U$ 相对于温度 $T$ 的变化。其理论基础在于电芯电压与 Gibbs 自由能 $\\Delta G$ 之间的关系，以及 Gibbs 自由能与熵 $\\Delta S$ 之间的关系。\n\n开路电压的基本热力学关系由下式给出：\n$$U(x, T) = -\\frac{\\Delta G(x, T)}{nF}$$\n其中 $n$ 是电池反应中转移的电子摩尔数，$F$ 是 Faraday 常数。\n\n熵变 $\\Delta S$ 与恒定压力下 Gibbs 自由能的温度导数相关：\n$$\\Delta S(x, T) = -\\left(\\frac{\\partial (\\Delta G)}{\\partial T}\\right)_{p,x}$$\n通过在固定化学计量 $x$ 下对 $U(x,T)$ 的表达式关于温度 $T$ 求导，我们推导出熵系数的表达式：\n$$\\alpha(x) \\equiv \\left(\\frac{\\partial U}{\\partial T}\\right)_{x} = -\\frac{1}{nF}\\left(\\frac{\\partial (\\Delta G)}{\\partial T}\\right)_{x} = \\frac{\\Delta S(x, T)}{nF}$$\n这表明熵系数与电池反应的熵变成正比。\n\n对于足够小的温度区间，固定 $x$ 下的函数 $U(T)$ 可以用线性模型精确近似：\n$$U(T_i) = \\beta_0 + \\beta_1 T_i + \\epsilon_i$$\n这里，$\\beta_1$ 是斜率，代表我们对熵系数 $\\alpha_{\\text{fit}}(x)$ 的估计值。项 $\\epsilon_i$ 代表第 $i$ 个数据点 $(T_i, U_i)$ 的测量误差。我们已知这些误差是独立的，服从均值为零、标准差为 $\\sigma_{U,i}$（即方差为 $\\sigma_{U,i}^2$）的高斯分布。\n\n为了找到参数 $\\beta = [\\beta_0, \\beta_1]^\\top$ 的最佳估计，我们采用加权最小二乘法 (WLS)，它在这些条件下是最佳线性无偏估计量 (BLUE)。WLS 方法通过最小化加权残差平方和 $\\sum_{i} w_i (U_i - (\\beta_0 + \\beta_1 T_i))^2$ 来实现，其中最佳权重是测量方差的倒数，即 $w_i = 1/\\sigma_{U,i}^2$。\n\n在矩阵形式下，线性模型为 $U = X\\beta + \\epsilon$，其中：\n- $U = [U_1, U_2, \\dots, U_N]^\\top$ 是测量电压的向量。\n- $X$ 是 $N \\times 2$ 的设计矩阵：\n$$X = \\begin{pmatrix} 1  T_1 \\\\ 1  T_2 \\\\ \\vdots  \\vdots \\\\ 1  T_N \\end{pmatrix}$$\n- $W$ 是 $N \\times N$ 的对角权重矩阵：\n$$W = \\mathrm{diag}(w_1, w_2, \\dots, w_N) = \\mathrm{diag}(1/\\sigma_{U,1}^2, 1/\\sigma_{U,2}^2, \\dots, 1/\\sigma_{U,N}^2)$$\n\n参数向量 $\\hat{\\beta}$ 的 WLS 解由正规方程给出：\n$$\\hat{\\beta} = (X^\\top W X)^{-1} X^\\top W U$$\n所求的熵系数是斜率分量：$\\alpha_{\\text{fit}} = \\hat{\\beta}_1$。\n\n估计参数的协方差矩阵 $\\mathrm{Cov}(\\hat{\\beta})$ 提供了我们估计值的不确定度。对于已知方差的 WLS，该矩阵为：\n$$\\mathrm{Cov}(\\hat{\\beta}) = (X^\\top W X)^{-1}$$\n这是一个 $2 \\times 2$ 的矩阵，其对角元素分别是估计的截距和斜率的方差。拟合斜率的标准不确定度 $s_{\\alpha,\\text{fit}}$ 是第二个对角元素的平方根：\n$$s_{\\alpha,\\text{fit}}(x) = \\sqrt{\\mathrm{Cov}(\\hat{\\beta})_{11}}$$\n\n最后，我们必须将我们估计的系数 $\\alpha_{\\text{fit}}(x)$ 与具有自身标准不确定度 $s_{\\alpha,\\text{direct}}(x)$ 的独立测量值 $\\alpha_{\\text{direct}}(x)$ 进行验证。一致性通过以下提供的准则进行评估：\n$$\\left|\\alpha_{\\text{fit}}(x) - \\alpha_{\\text{direct}}(x)\\right| \\leq K \\sqrt{ s_{\\alpha,\\text{fit}}(x)^2 + s_{\\alpha,\\text{direct}}(x)^2 }$$\n其中覆盖因子 $K=2$。平方根下的项是两个估计值之差的组合方差（假设它们是独立的）。该准则检查两个值之间的绝对差是否在其组合不确定度的 $K$ 个标准差之内。对于正态分布，这大约对应于 95% 的置信区间。对于每个数据集，一个布尔结果将指示是否满足此准则。\n\n对提供的三个测试案例中的每一个都实施了该程序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the OCV-stoichiometry problem by performing weighted linear\n    regression to estimate the entropic coefficient and comparing it\n    against a direct measurement.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy-path\n        {\n            \"T\": np.array([298.0, 303.0, 308.0, 313.0, 318.0]),\n            \"U\": np.array([3.850005, 3.85059, 3.85122, 3.85178, 3.85241]),\n            \"sigma_U\": np.array([5e-5, 4e-5, 5e-5, 6e-5, 5e-5]),\n            \"alpha_direct\": 0.000119,\n            \"s_alpha_direct\": 1.5e-6\n        },\n        # Case 2: Noisy but acceptable\n        {\n            \"T\": np.array([293.0, 298.0, 303.0, 308.0, 313.0, 318.0]),\n            \"U\": np.array([3.72038, 3.72001, 3.71962, 3.71919, 3.71883, 3.71838]),\n            \"sigma_U\": np.array([1.0e-4, 1.0e-4, 1.2e-4, 1.2e-4, 1.0e-4, 8.0e-5]),\n            \"alpha_direct\": -8.2e-5,\n            \"s_alpha_direct\": 5.0e-6\n        },\n        # Case 3: Edge case (limited temperature span)\n        {\n            \"T\": np.array([296.0, 298.0, 300.0]),\n            \"U\": np.array([3.90972, 3.90999, 3.91028]),\n            \"sigma_U\": np.array([3.0e-5, 3.0e-5, 3.0e-5]),\n            \"alpha_direct\": 1.2e-4,\n            \"s_alpha_direct\": 1.0e-6\n        }\n    ]\n\n    results = []\n    \n    K = 2.0  # Coverage factor\n\n    for case in test_cases:\n        T = case[\"T\"]\n        U = case[\"U\"]\n        sigma_U = case[\"sigma_U\"]\n        alpha_direct = case[\"alpha_direct\"]\n        s_alpha_direct = case[\"s_alpha_direct\"]\n\n        # 1. Construct the design matrix X\n        # X has a column of ones (for the intercept) and a column of temperatures T.\n        X = np.vstack((np.ones_like(T), T)).T\n        \n        # 2. Construct the weight matrix W\n        # Weights are the inverse of the variances of the voltage measurements.\n        # W is a diagonal matrix of these weights.\n        weights = 1.0 / (sigma_U**2)\n        W = np.diag(weights)\n\n        # 3. Solve the weighted least squares normal equations\n        # beta_hat = (X.T @ W @ X)^-1 @ X.T @ W @ U\n        XT_W_X = X.T @ W @ X\n        XT_W_U = X.T @ W @ U\n        \n        # Using np.linalg.solve for better numerical stability than np.linalg.inv\n        try:\n            beta_hat = np.linalg.solve(XT_W_X, XT_W_U)\n        except np.linalg.LinAlgError:\n            # This case should not happen with the given data but is good practice\n            results.append(False) # Mark as failure if matrix is singular\n            continue\n            \n        alpha_fit = beta_hat[1]\n\n        # 4. Calculate the standard uncertainty of the fitted slope\n        # This is the square root of the corresponding diagonal element\n        # of the covariance matrix Cov(beta) = (X.T @ W @ X)^-1.\n        try:\n            cov_beta = np.linalg.inv(XT_W_X)\n        except np.linalg.LinAlgError:\n            results.append(False)\n            continue\n            \n        s_alpha_fit = np.sqrt(cov_beta[1, 1])\n\n        # 5. Apply the acceptance criterion\n        # |alpha_fit - alpha_direct| = K * sqrt(s_alpha_fit^2 + s_alpha_direct^2)\n        abs_diff = np.abs(alpha_fit - alpha_direct)\n        combined_uncertainty = np.sqrt(s_alpha_fit**2 + s_alpha_direct**2)\n        \n        agreement = abs_diff = K * combined_uncertainty\n        results.append(agreement)\n\n    # Format the final output as a comma-separated list of booleans\n    # e.g., [True,True,False]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}