{
    "hands_on_practices": [
        {
            "introduction": "The Nyquist plot provides a powerful visual fingerprint of a battery's internal state, where the shape of the impedance arc reveals the nature of the underlying electrochemical processes. This foundational exercise builds the skills to interpret these plots by connecting the visual representation to the mathematical model. You will derive from first principles how an ideal electrode interface, modeled as a simple parallel resistor-capacitor ($R_{ct} \\parallel C_{dl}$) circuit, produces a perfect semicircle in the impedance plane, and then see how introducing a Constant Phase Element (CPE) to account for non-ideal, distributed behavior results in the more commonly observed \"depressed\" semicircle .",
            "id": "3936532",
            "problem": "A lithium-ion cell is modeled for parameter estimation within an automated battery design workflow by combining time-domain galvanostatic cycling (GC) with frequency-domain Electrochemical Impedance Spectroscopy (EIS). In the linear small-signal regime about a fixed state of charge, assume the electrode–electrolyte interface can be represented in series with a solution resistance $R_{s}$ by a parallel branch consisting of a charge-transfer resistance $R_{ct}$ and an interfacial storage element. Under ideal behavior this storage element is a double-layer capacitance $C_{dl}$, while under non-ideal behavior it is a Constant Phase Element (CPE) with admittance $Y_{CPE}(\\omega) = Q \\left( j \\omega \\right)^{n}$, where $Q>0$ is the CPE prefactor, $0<n\\leq 1$ is the exponent characterizing distributed time constants, $\\omega$ is the angular frequency, and $j=\\sqrt{-1}$.\n\nStarting from Kirchhoff’s laws and the definition of impedance $Z(\\omega) = \\hat{V}(\\omega)/\\hat{I}(\\omega)$ for sinusoidal steady-state response, derive the complex impedance $Z(\\omega)$ of the series $R_{s}$ with the parallel $R_{ct}$–$C_{dl}$ branch and show that the Nyquist plot $\\left( \\Re(Z), -\\Im(Z) \\right)$ is a semicircle for the ideal case. Then replace $C_{dl}$ with the CPE and, using only first principles and the definitions above, analytically demonstrate that the Nyquist locus becomes a “depressed semicircle” when $n<1$.\n\nFinally, for the non-ideal $R_{s}$–$\\left( R_{ct} \\parallel \\text{CPE} \\right)$ model, derive the closed-form expression for the characteristic angular frequency $\\omega_{p}$ at which the magnitude of the imaginary part of the total impedance $Z(\\omega)$ attains its maximum (the apex of the arc). Express your final answer symbolically in terms of $Q$, $R_{ct}$, and $n$. No numerical evaluation is required; give your answer as an exact analytic expression for $\\omega_{p}$ in radians per second. Do not include units in the final boxed answer.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and complete. It describes a standard problem in electrochemical impedance spectroscopy, using established models (Randles circuit with a resistor, capacitor, and constant phase element) and definitions. The objectives are clearly stated and the given information is sufficient to derive the requested analytical expressions. The problem is therefore deemed valid and a solution is provided below.\n\nThe problem asks for three derivations related to an electrochemical impedance model.\n\nFirst, we derive the impedance for the ideal case and show its Nyquist plot is a semicircle. The model consists of a solution resistance $R_s$ in series with a parallel combination of a charge-transfer resistance $R_{ct}$ and a double-layer capacitance $C_{dl}$.\n\nThe impedance of the parallel branch, $Z_{||}(\\omega)$, is given by the reciprocal of the sum of the admittances of the components:\n$$ \\frac{1}{Z_{||}(\\omega)} = \\frac{1}{R_{ct}} + \\frac{1}{Z_{C_{dl}}(\\omega)} $$\nThe impedance of a capacitor is $Z_{C_{dl}}(\\omega) = \\frac{1}{j \\omega C_{dl}}$, where $j = \\sqrt{-1}$ and $\\omega$ is the angular frequency.\nSubstituting this into the admittance sum gives:\n$$ \\frac{1}{Z_{||}(\\omega)} = \\frac{1}{R_{ct}} + j \\omega C_{dl} = \\frac{1 + j \\omega R_{ct} C_{dl}}{R_{ct}} $$\nInverting this expression gives the impedance of the parallel branch:\n$$ Z_{||}(\\omega) = \\frac{R_{ct}}{1 + j \\omega R_{ct} C_{dl}} $$\nThe total impedance $Z(\\omega)$ is the sum of the series resistance $R_s$ and the parallel branch impedance $Z_{||}(\\omega)$:\n$$ Z(\\omega) = R_s + \\frac{R_{ct}}{1 + j \\omega R_{ct} C_{dl}} $$\nTo analyze the Nyquist plot, we separate the impedance into its real part, $Z'(\\omega) = \\Re(Z(\\omega))$, and imaginary part, $Z''(\\omega) = \\Im(Z(\\omega))$. We multiply the numerator and denominator of the second term by the complex conjugate of the denominator:\n$$ Z(\\omega) = R_s + \\frac{R_{ct}(1 - j \\omega R_{ct} C_{dl})}{(1 + j \\omega R_{ct} C_{dl})(1 - j \\omega R_{ct} C_{dl})} = R_s + \\frac{R_{ct} - j \\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} $$\nThe real and imaginary parts are:\n$$ Z'(\\omega) = R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} $$\n$$ Z''(\\omega) = - \\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} $$\nThe Nyquist plot is a parametric plot of $(\\Re(Z), -\\Im(Z))$, which we denote as $(x, y)$.\n$$ x = R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} $$\n$$ y = -Z''(\\omega) = \\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} $$\nWe now show that these parametric equations describe a circle. From the expression for $x$:\n$$ x - R_s = \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} $$\nWe can rewrite the expression for $y$ using this relationship:\n$$ y = \\left( \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} \\right) (\\omega R_{ct} C_{dl}) = (x - R_s) (\\omega R_{ct} C_{dl}) $$\nFrom the expression for $x-R_s$, we can solve for $(\\omega R_{ct} C_{dl})^2$:\n$$ 1 + (\\omega R_{ct} C_{dl})^2 = \\frac{R_{ct}}{x - R_s} \\implies (\\omega R_{ct} C_{dl})^2 = \\frac{R_{ct}}{x - R_s} - 1 = \\frac{R_{ct} - (x - R_s)}{x - R_s} $$\nFrom the expression for $y$, we have $y^2 = (x - R_s)^2 (\\omega R_{ct} C_{dl})^2$. Substituting the expression for $(\\omega R_{ct} C_{dl})^2$:\n$$ y^2 = (x - R_s)^2 \\left( \\frac{R_{ct} - x + R_s}{x - R_s} \\right) = (x - R_s)(R_{ct} - x + R_s) $$\n$$ y^2 = R_{ct}x - x^2 + R_s x - R_s R_{ct} + R_s x - R_s^2 = -x^2 + (R_{ct} + 2R_s)x - R_s(R_{ct} + R_s) $$\nRearranging into the standard form of a circle by completing the square for $x$:\n$$ x^2 - (R_{ct} + 2R_s)x + y^2 = -R_s(R_{ct} + R_s) $$\n$$ \\left(x - \\left(R_s + \\frac{R_{ct}}{2}\\right)\\right)^2 - \\left(R_s + \\frac{R_{ct}}{2}\\right)^2 + y^2 = -R_s(R_{ct} + R_s) $$\n$$ \\left(x - \\left(R_s + \\frac{R_{ct}}{2}\\right)\\right)^2 + y^2 = \\left(R_s + \\frac{R_{ct}}{2}\\right)^2 - R_s(R_{ct} + R_s) $$\n$$ \\left(x - \\left(R_s + \\frac{R_{ct}}{2}\\right)\\right)^2 + y^2 = R_s^2 + R_s R_{ct} + \\frac{R_{ct}^2}{4} - R_s R_{ct} - R_s^2 = \\left(\\frac{R_{ct}}{2}\\right)^2 $$\nThis is the equation of a circle in the $(x, y)$ plane with center at $(R_s + R_{ct}/2, 0)$ and radius $R_{ct}/2$. Since $y = -Z''(\\omega) \\ge 0$, the plot is a semicircle in the upper half-plane, with diameter $R_{ct}$ on the real axis.\n\nSecond, we replace the capacitor $C_{dl}$ with a Constant Phase Element (CPE) and demonstrate that the Nyquist locus becomes a depressed semicircle for $n<1$. The admittance of the CPE is given as $Y_{CPE}(\\omega) = Q(j\\omega)^n$. The total impedance is:\n$$ Z(\\omega) = R_s + Z_{||}(\\omega) = R_s + \\frac{1}{\\frac{1}{R_{ct}} + Y_{CPE}(\\omega)} = R_s + \\frac{1}{\\frac{1}{R_{ct}} + Q(j\\omega)^n} $$\nWe express the complex term $(j\\omega)^n$ using Euler's formula, with $j = \\exp(j\\pi/2)$:\n$$ (j\\omega)^n = (\\omega \\exp(j\\pi/2))^n = \\omega^n \\exp\\left(j\\frac{n\\pi}{2}\\right) = \\omega^n \\left(\\cos\\left(\\frac{n\\pi}{2}\\right) + j\\sin\\left(\\frac{n\\pi}{2}\\right)\\right) $$\nThe impedance of the parallel part, $Z_{p}(\\omega) = Z(\\omega) - R_s$, is:\n$$ Z_{p}(\\omega) = \\frac{1}{\\frac{1}{R_{ct}} + Q\\omega^n \\cos\\left(\\frac{n\\pi}{2}\\right) + j Q\\omega^n \\sin\\left(\\frac{n\\pi}{2}\\right)} $$\nFor $0 < n < 1$, both $\\cos(n\\pi/2)$ and $\\sin(n\\pi/2)$ are positive. The denominator is a complex number in the first quadrant of the admittance plane.\nThe locus of the parallel admittance $Y_{p}(\\omega) = 1/R_{ct} + Y_{CPE}(\\omega)$ as $\\omega$ varies from $0$ to $\\infty$ is a ray starting at $(1/R_{ct}, 0)$ and extending into the first quadrant at a constant angle of $n\\pi/2$ with respect to the real axis.\nThe impedance $Z_{p}(\\omega)$ is the complex inversion of this ray. An inversion maps a line not passing through the origin to a circle that passes through the origin. The endpoints of the $Z_{p}(\\omega)$ locus are:\n$$ \\lim_{\\omega \\to 0} Z_{p}(\\omega) = \\frac{1}{1/R_{ct}} = R_{ct} $$\n$$ \\lim_{\\omega \\to \\infty} Z_{p}(\\omega) = \\lim_{\\omega \\to \\infty} \\frac{1}{Q(j\\omega)^n} = 0 $$\nSo, the locus of $Z_p(\\omega)$ is a circular arc from $(R_{ct}, 0)$ to $(0,0)$. For the total impedance $Z(\\omega)$, this arc is shifted to start at $(R_s+R_{ct}, 0)$ and end at $(R_s, 0)$.\nTo demonstrate that this is a \"depressed\" semicircle, we examine the argument of $Z_p(\\omega)$ as it approaches the origin ($\\omega \\to \\infty$).\n$$ \\arg(Z_p(\\omega)) \\approx \\arg\\left(\\frac{1}{Q(j\\omega)^n}\\right) = \\arg\\left(\\frac{1}{Q\\omega^n \\exp(j n\\pi/2)}\\right) = \\arg\\left(\\frac{1}{Q\\omega^n}\\exp(-j n\\pi/2)\\right) = - \\frac{n\\pi}{2} $$\nFor the ideal case ($n=1$), the arc approaches the origin at an angle of $-\\pi/2$, i.e., vertically downwards. For $0<n<1$, the angle of approach is between $0$ and $-\\pi/2$. The tangent to the Nyquist plot at the high frequency intercept $(R_s,0)$ is not perpendicular to the real axis. This rotation of the arc, causing its center to lie below the real axis (for the $Z'$ vs $Z''$ plot), is what characterizes it as a \"depressed semicircle\".\n\nThird, we derive the expression for the angular frequency $\\omega_p$ where the magnitude of the imaginary part of $Z(\\omega)$ is maximum for the non-ideal model. The imaginary part is:\n$$ Z''(\\omega) = \\Im\\left( R_s + \\frac{1}{\\frac{1}{R_{ct}} + Q\\omega^n\\cos\\left(\\frac{n\\pi}{2}\\right) + jQ\\omega^n\\sin\\left(\\frac{n\\pi}{2}\\right)} \\right) $$\nLet the denominator be $D = A+jB$, where $A = 1/R_{ct} + Q\\omega^n\\cos(n\\pi/2)$ and $B = Q\\omega^n\\sin(n\\pi/2)$.\n$$ Z''(\\omega) = \\Im\\left(\\frac{A-jB}{A^2+B^2}\\right) = \\frac{-B}{A^2+B^2} $$\n$$ Z''(\\omega) = \\frac{-Q\\omega^n\\sin(n\\pi/2)}{\\left(\\frac{1}{R_{ct}} + Q\\omega^n\\cos\\left(\\frac{n\\pi}{2}\\right)\\right)^2 + \\left(Q\\omega^n\\sin\\left(\\frac{n\\pi}{2}\\right)\\right)^2} $$\n$$ Z''(\\omega) = \\frac{-Q\\omega^n\\sin(n\\pi/2)}{\\frac{1}{R_{ct}^2} + \\frac{2Q\\omega^n}{R_{ct}}\\cos\\left(\\frac{n\\pi}{2}\\right) + (Q\\omega^n)^2\\cos^2\\left(\\frac{n\\pi}{2}\\right) + (Q\\omega^n)^2\\sin^2\\left(\\frac{n\\pi}{2}\\right)} $$\n$$ Z''(\\omega) = \\frac{-Q R_{ct}^2 \\omega^n \\sin(n\\pi/2)}{1 + 2 R_{ct} Q \\omega^n \\cos(n\\pi/2) + (R_{ct} Q \\omega^n)^2} $$\nWe want to find the maximum of $|Z''(\\omega)|$, which is equivalent to maximizing $-Z''(\\omega)$ since $\\sin(n\\pi/2) \\ge 0$ for $0<n\\le 1$. Let $f(\\omega) = -Z''(\\omega)$.\nLet us define a variable $u = R_{ct} Q \\omega^n$. The function to maximize is proportional to:\n$$ g(u) = \\frac{u}{1 + 2u\\cos(n\\pi/2) + u^2} $$\nWe find the maximum by setting the derivative $\\frac{dg}{du}$ to $0$:\n$$ \\frac{dg}{du} = \\frac{1 \\cdot (1 + 2u\\cos(n\\pi/2) + u^2) - u \\cdot (2\\cos(n\\pi/2) + 2u)}{(1 + 2u\\cos(n\\pi/2) + u^2)^2} = 0 $$\nThe numerator must be zero:\n$$ 1 + 2u\\cos(n\\pi/2) + u^2 - 2u\\cos(n\\pi/2) - 2u^2 = 0 $$\n$$ 1 - u^2 = 0 $$\nSince $u = R_{ct} Q \\omega^n$ must be positive, we have $u=1$.\nThe maximum of $|Z''(\\omega)|$ occurs at the frequency $\\omega_p$ where this condition is met:\n$$ R_{ct} Q \\omega_p^n = 1 $$\nSolving for $\\omega_p$:\n$$ \\omega_p^n = \\frac{1}{R_{ct} Q} $$\n$$ \\omega_p = \\left( \\frac{1}{Q R_{ct}} \\right)^{\\frac{1}{n}} $$",
            "answer": "$$\\boxed{\\left(\\frac{1}{Q R_{ct}}\\right)^{\\frac{1}{n}}}$$"
        },
        {
            "introduction": "While impedance spectroscopy probes the system in the frequency domain, galvanostatic cycling provides crucial information from time-domain responses. However, real-world cells exhibit complex behaviors like voltage hysteresis that simple models often neglect. This practice demonstrates the critical importance of model fidelity by quantifying how ignoring rate-independent hysteresis leads to a systematic bias in parameter estimates derived from charge-discharge data . By modeling hysteresis with a simple yet effective relay operator, you will analytically derive the error introduced into a common formula for series resistance.",
            "id": "3936560",
            "problem": "A rechargeable electrochemical cell is modeled in automated battery design and simulation by a lumped terminal equation with open-circuit voltage (OCV) and resistive overpotential. Let the state of charge (SOC) be denoted by $z(t)$, the terminal current by $i(t)$ (positive for charge), the cell capacity by $Q$, and the OCV by $U(z)$. The terminal voltage is modeled as\n$$\nV(t) = U\\big(z(t)\\big) + R_{s}\\,i(t) + \\eta(t),\n$$\nwhere $R_{s}$ is the series resistance and $\\eta(t)$ is a hysteretic voltage offset that depends on the recent charge/discharge history. The SOC obeys the mass balance\n$$\n\\dot{z}(t) = \\frac{i(t)}{Q}.\n$$\nTo capture rate-independent voltage hysteresis during cycling, consider a simple Preisach-like single-relay operator acting on the input $\\dot{z}(t)$ that outputs an additive offset with two stable states. Specifically, define\n$$\n\\eta(t) = h\\,m(t), \\quad m(t) \\in \\{-1, +1\\},\n$$\nwith $m(t)$ switching to $+1$ when $\\dot{z}(t) > 0$ (net charging direction) and to $-1$ when $\\dot{z}(t) < 0$ (net discharging direction). The constant $h > 0$ represents the hysteresis amplitude.\n\nA symmetric galvanostatic cycling protocol is executed over a narrow SOC window $[z_{1}, z_{2}]$ at low rate such that dynamic polarization is negligible and $U(z)$ can be approximated as locally constant $U\\big(z(t)\\big) \\approx U_{0}$ over this window. The protocol consists of:\n\n- A constant-current charge at $i(t) = +I$ from $z_{1}$ to $z_{2}$, yielding a measured average plateau voltage $V_{\\text{chg}}$ within the window.\n- A constant-current discharge at $i(t) = -I$ from $z_{2}$ to $z_{1}$, yielding a measured average plateau voltage $V_{\\text{dis}}$ within the same window.\n\nAn engineer infers $R_{s}$ from cycling by a naive formula that ignores hysteresis and attributes the charge–discharge voltage difference solely to the resistive $IR$ drop:\n$$\nR_{\\text{est}} \\equiv \\frac{V_{\\text{chg}} - V_{\\text{dis}}}{2I}.\n$$\n\nStarting from the terminal equation, the mass balance, and the hysteresis operator defined above, derive the closed-form expression for the bias in the naive series resistance estimate,\n$$\n\\Delta R \\equiv R_{\\text{est}} - R_{s},\n$$\nas a function of the hysteresis amplitude $h$ and the cycling current magnitude $I$, under the assumptions stated. Explain the modeling steps that justify the form of $\\eta(t)$ and the conditions under which the OCV cancels in the charge–discharge comparison. Express your final answer in ohms. No rounding is required. Define all acronyms on first use: Open-Circuit Voltage (OCV), State of Charge (SOC), and Electrochemical Impedance Spectroscopy (EIS) if referenced.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and self-contained. The model presented is a standard, albeit simplified, equivalent circuit model used for battery simulation, incorporating a relay operator to represent rate-independent voltage hysteresis. The experimental protocol and assumptions are clearly stated and physically reasonable for the purpose of deriving the analytical expression requested.\n\nThe objective is to derive an expression for the bias, $\\Delta R$, in a naive estimate of a battery's series resistance, $R_s$. The bias is defined as $\\Delta R \\equiv R_{\\text{est}} - R_{s}$, where $R_{\\text{est}}$ is an estimate derived from galvanostatic cycling data.\n\nFirst, we define the acronyms used: Open-Circuit Voltage (OCV) and State of Charge (SOC).\n\nThe terminal voltage of the electrochemical cell is given by the model:\n$$\nV(t) = U\\big(z(t)\\big) + R_{s}\\,i(t) + \\eta(t)\n$$\nwhere $V(t)$ is the terminal voltage, $U\\big(z(t)\\big)$ is the OCV as a function of SOC $z(t)$, $R_s$ is the true series resistance, $i(t)$ is the current (positive for charging), and $\\eta(t)$ is a hysteretic voltage offset.\n\nThe SOC dynamics are described by the mass balance equation:\n$$\n\\dot{z}(t) = \\frac{i(t)}{Q}\n$$\nwhere $Q$ is the cell capacity.\n\nThe hysteretic offset, $\\eta(t)$, is modeled by a single-relay operator:\n$$\n\\eta(t) = h\\,m(t)\n$$\nwhere $h > 0$ is the constant hysteresis amplitude and $m(t)$ is a state variable that depends on the direction of the change in SOC:\n$$\nm(t) = \\begin{cases} +1 & \\text{if } \\dot{z}(t) > 0 \\\\ -1 & \\text{if } \\dot{z}(t) < 0 \\end{cases}\n$$\nThis model represents a rate-independent hysteresis, meaning the voltage offset depends only on the direction of the current (charging or discharging) and not its magnitude.\n\nThe problem describes a symmetric galvanostatic cycling protocol performed over a narrow SOC window, where the OCV can be approximated as a constant, $U\\big(z(t)\\big) \\approx U_{0}$. This assumption is crucial as it allows the OCV contribution to be treated as a constant offset during both the charge and discharge plateaus within the measurement window.\n\nWe analyze the two steps of the protocol separately.\n\n1.  **Constant-Current Charge Step:**\n    The cell is charged at a constant current $i(t) = +I$. Since the current $I$ and capacity $Q$ are positive constants, the rate of change of SOC is:\n    $$\n    \\dot{z}(t) = \\frac{I}{Q} > 0\n    $$\n    According to the definition of the hysteresis operator, when $\\dot{z}(t) > 0$, the state variable $m(t)$ becomes $+1$. The hysteretic offset is therefore:\n    $$\n    \\eta(t) = h \\cdot (+1) = h\n    $$\n    Substituting these into the terminal voltage equation, we get the voltage during the charge step:\n    $$\n    V(t) = U\\big(z(t)\\big) + R_{s}I + h\n    $$\n    Using the approximation that $U\\big(z(t)\\big) \\approx U_{0}$ within the narrow SOC window, the voltage is approximately constant. The measured average plateau voltage, $V_{\\text{chg}}$, is thus:\n    $$\n    V_{\\text{chg}} = U_{0} + R_{s}I + h\n    $$\n\n2.  **Constant-Current Discharge Step:**\n    The cell is discharged at a constant current $i(t) = -I$. The rate of change of SOC is:\n    $$\n    \\dot{z}(t) = \\frac{-I}{Q} < 0\n    $$\n    When $\\dot{z}(t) < 0$, the state variable $m(t)$ becomes $-1$. The hysteretic offset is:\n    $$\n    \\eta(t) = h \\cdot (-1) = -h\n    $$\n    Substituting these into the terminal voltage equation gives the voltage during the discharge step:\n    $$\n    V(t) = U\\big(z(t)\\big) + R_{s}(-I) - h\n    $$\n    Again, using the approximation $U\\big(z(t)\\big) \\approx U_{0}$, the measured average plateau voltage, $V_{\\text{dis}}$, is:\n    $$\n    V_{\\text{dis}} = U_{0} - R_{s}I - h\n    $$\n\nThe cancellation of the OCV in the subsequent calculation is justified by this very assumption. Since the charge and discharge plateaus are measured over the same SOC window where $U(z)$ is approximated as the same constant $U_0$, this term will subtract out when we compute the difference between $V_{\\text{chg}}$ and $V_{\\text{dis}}$.\n\nNow, we use the derived expressions for $V_{\\text{chg}}$ and $V_{\\text{dis}}$ to evaluate the engineer's naive resistance estimate, $R_{\\text{est}}$. The formula given is:\n$$\nR_{\\text{est}} \\equiv \\frac{V_{\\text{chg}} - V_{\\text{dis}}}{2I}\n$$\nLet's compute the numerator, $V_{\\text{chg}} - V_{\\text{dis}}$:\n$$\nV_{\\text{chg}} - V_{\\text{dis}} = (U_{0} + R_{s}I + h) - (U_{0} - R_{s}I - h)\n$$\n$$\nV_{\\text{chg}} - V_{\\text{dis}} = U_{0} + R_{s}I + h - U_{0} + R_{s}I + h\n$$\n$$\nV_{\\text{chg}} - V_{\\text{dis}} = 2R_{s}I + 2h\n$$\nAs anticipated, the OCV term $U_{0}$ cancels. The difference in voltage is due to the combined effect of the resistive drop across $R_s$ and the hysteretic offset $h$, both of which reverse sign with the current.\n\nSubstitute this result into the formula for $R_{\\text{est}}$:\n$$\nR_{\\text{est}} = \\frac{2R_{s}I + 2h}{2I} = \\frac{2R_{s}I}{2I} + \\frac{2h}{2I}\n$$\n$$\nR_{\\text{est}} = R_{s} + \\frac{h}{I}\n$$\nThis expression shows that the naive formula overestimates the true series resistance $R_s$ by a term that depends on the hysteresis amplitude $h$ and the cycling current $I$.\n\nFinally, we calculate the bias in the estimate, $\\Delta R$, which is defined as the difference between the estimated resistance and the true resistance:\n$$\n\\Delta R \\equiv R_{\\text{est}} - R_{s}\n$$\nSubstituting the expression for $R_{\\text{est}}$ we just derived:\n$$\n\\Delta R = \\left(R_{s} + \\frac{h}{I}\\right) - R_{s}\n$$\n$$\n\\Delta R = \\frac{h}{I}\n$$\nThe bias in the naive resistance estimate is directly proportional to the hysteresis amplitude $h$ and inversely proportional to the magnitude of the cycling current $I$. This result quantifies the error introduced by ignoring voltage hysteresis. The units are consistent: if $h$ is in volts ($V$) and $I$ is in amperes ($A$), then $\\Delta R$ is in ohms ($\\Omega$), as required.",
            "answer": "$$\\boxed{\\frac{h}{I}}$$"
        },
        {
            "introduction": "Beyond simply fitting a model to data, a key skill in advanced characterization is designing experiments that yield the most useful information. Given that an impedance spectrum can be measured over many decades of frequency, a practical question arises: which frequencies are most sensitive to a particular parameter of interest? This practice introduces local sensitivity analysis, a cornerstone of optimal experiment design, to answer precisely this question . You will compute the sensitivity of the impedance response with respect to each parameter in a standard model and identify the frequencies that maximize the information content, enabling the design of more focused and efficient experiments.",
            "id": "3936558",
            "problem": "You are tasked with designing a program to compute local parameter sensitivities of the complex Electrochemical Impedance Spectroscopy (EIS) response and to determine which angular frequencies maximize the information content for each parameter in a physically plausible equivalent circuit used in automated battery design and simulation. The circuit models a porous electrode/electrolyte interface with a series solution resistance, a parallel charge-transfer resistance and double-layer capacitance, and a semi-infinite Warburg diffusion element. This task lies within the broader context of parameter estimation from galvanostatic cycling and impedance data, leveraging shared physical parameters across both time-domain and frequency-domain measurements.\n\nBegin from the following foundations:\n\n- Kirchhoff’s circuit laws for series and parallel combinations.\n- Impedance definitions of canonical linear elements in the frequency domain:\n  - A resistor with resistance $R$ has impedance $Z_{R}(\\omega) = R$.\n  - A capacitor with capacitance $C$ has impedance $Z_{C}(\\omega) = \\dfrac{1}{j \\, \\omega \\, C}$, where $j = \\sqrt{-1}$.\n  - A semi-infinite Warburg diffusion element has impedance $Z_{W}(\\omega) = \\dfrac{\\sigma}{\\sqrt{j \\, \\omega}}$, where $\\sigma$ is the Warburg coefficient.\n- Series combination: impedances add in series.\n- Parallel combination: the equivalent impedance $Z_{\\parallel}$ of impedances $Z_{1}$ and $Z_{2}$ satisfies $\\dfrac{1}{Z_{\\parallel}} = \\dfrac{1}{Z_{1}} + \\dfrac{1}{Z_{2}}$.\n\nUsing these foundations, construct the total impedance $Z(\\omega)$ of the circuit comprised of:\n- A series solution resistance $R_{\\mathrm{s}}$,\n- A parallel branch consisting of the charge-transfer resistance $R_{\\mathrm{ct}}$ and double-layer capacitance $C_{\\mathrm{dl}}$,\n- A semi-infinite Warburg element with coefficient $\\sigma$.\n\nDefine the parameter vector $\\boldsymbol{\\theta} = \\left[R_{\\mathrm{s}}, \\, R_{\\mathrm{ct}}, \\, C_{\\mathrm{dl}}, \\, \\sigma\\right]$. The local sensitivity of the complex impedance with respect to a parameter $\\theta_{k}$ at angular frequency $\\omega$ is the complex derivative $\\dfrac{\\partial Z(\\omega)}{\\partial \\theta_{k}}$. To assess frequency-dependent information content for each parameter, define the scalar local information density for parameter $\\theta_{k}$ at frequency $\\omega$ as\n$$\n\\mathcal{I}_{k}(\\omega) = \\frac{\\left(\\frac{\\partial}{\\partial \\theta_{k}} \\operatorname{Re}\\{Z(\\omega)\\}\\right)^{2}}{\\sigma_{\\mathrm{Re}}^{2}} \\;+\\; \\frac{\\left(\\frac{\\partial}{\\partial \\theta_{k}} \\operatorname{Im}\\{Z(\\omega)\\}\\right)^{2}}{\\sigma_{\\mathrm{Im}}^{2}},\n$$\nwhere $\\sigma_{\\mathrm{Re}}$ and $\\sigma_{\\mathrm{Im}}$ are the standard deviations of additive measurement noise on the real and imaginary parts, respectively. The goal is to compute $\\mathcal{I}_{k}(\\omega)$ across the provided frequency grid and to identify the angular frequency $\\omega$ that maximizes $\\mathcal{I}_{k}(\\omega)$ for each parameter $\\theta_{k}$. If multiple angular frequencies achieve the same maximal value (ties), select the smallest angular frequency among the maximizers.\n\nYour program must implement the above for the following test suite. For each test case, use the same angular frequency grid defined by $N$ logarithmically spaced points $\\omega_{i}$ between $\\omega_{\\min}$ and $\\omega_{\\max}$, inclusive:\n- $\\omega_{\\min} = 10^{-2}$ radians per second,\n- $\\omega_{\\max} = 10^{5}$ radians per second,\n- $N = 121$.\nUse $\\sigma_{\\mathrm{Re}} = 10^{-3}$ Ohms and $\\sigma_{\\mathrm{Im}} = 10^{-3}$ Ohms.\n\nTest case $1$ (happy path, moderate values):\n- $R_{\\mathrm{s}} = 0.05$ Ohms,\n- $R_{\\mathrm{ct}} = 0.5$ Ohms,\n- $C_{\\mathrm{dl}} = 0.002$ Farads,\n- $\\sigma = 0.1$ Ohms·seconds$^{1/2}$.\n\nTest case $2$ (edge case, small charge-transfer resistance):\n- $R_{\\mathrm{s}} = 0.1$ Ohms,\n- $R_{\\mathrm{ct}} = 0.05$ Ohms,\n- $C_{\\mathrm{dl}} = 0.001$ Farads,\n- $\\sigma = 0.2$ Ohms·seconds$^{1/2}$.\n\nTest case $3$ (edge case, large charge-transfer resistance and capacitance, no diffusion contribution):\n- $R_{\\mathrm{s}} = 0.02$ Ohms,\n- $R_{\\mathrm{ct}} = 2.0$ Ohms,\n- $C_{\\mathrm{dl}} = 0.005$ Farads,\n- $\\sigma = 0.0$ Ohms·seconds$^{1/2}$.\n\nUnits:\n- All angular frequencies must be expressed in radians per second.\n- Resistances must be in Ohms.\n- Capacitances must be in Farads.\n- Warburg coefficients must be in Ohms·seconds$^{1/2}$.\n- Noise standard deviations must be in Ohms.\n\nYour program should produce, for each test case, the quadruple of angular frequencies that maximizes $\\mathcal{I}_{k}(\\omega)$ for each parameter in the order $\\left[R_{\\mathrm{s}}, \\, R_{\\mathrm{ct}}, \\, C_{\\mathrm{dl}}, \\, \\sigma\\right]$. The final program output must be a single line containing a list of lists, one inner list per test case, each inner list containing the four maximizing angular frequencies as floating-point numbers in radians per second, in the specified parameter order. For example, the format must be exactly:\n$[[\\omega_{R_{\\mathrm{s}}}^{(1)},\\omega_{R_{\\mathrm{ct}}}^{(1)},\\omega_{C_{\\mathrm{dl}}}^{(1)},\\omega_{\\sigma}^{(1)}],[\\omega_{R_{\\mathrm{s}}}^{(2)},\\omega_{R_{\\mathrm{ct}}}^{(2)},\\omega_{C_{\\mathrm{dl}}}^{(2)},\\omega_{\\sigma}^{(2)}],[\\omega_{R_{\\mathrm{s}}}^{(3)},\\omega_{R_{\\mathrm{ct}}}^{(3)},\\omega_{C_{\\mathrm{dl}}}^{(3)},\\omega_{\\sigma}^{(3)}]]$.",
            "solution": "The problem requires the design of a program to compute the angular frequencies that maximize the local information density for the parameters of a specific electrochemical equivalent circuit model. The analysis begins with a critical validation of the problem statement, followed by a systematic derivation of the required mathematical expressions and the design of the computational algorithm.\n\n### Problem Validation\nThe problem statement is self-contained, scientifically grounded in the principles of electrochemistry and parameter estimation, and mathematically well-posed.\n- **Givens**: The problem provides a specific equivalent circuit topology (Randles-like), the impedance definitions for its R-C-W components, the formula for total impedance combination, the parameter vector $\\boldsymbol{\\theta} = \\left[R_{\\mathrm{s}}, \\, R_{\\mathrm{ct}}, \\, C_{\\mathrm{dl}}, \\, \\sigma\\right]$, the definition of the local information density $\\mathcal{I}_{k}(\\omega)$, the noise standard deviations ($\\sigma_{\\mathrm{Re}}$, $\\sigma_{\\mathrm{Im}}$), the frequency grid parameters ($\\omega_{\\min}$, $\\omega_{\\max}$, $N$), and three distinct test cases with specific parameter values.\n- **Scientific Grounding**: The model is a standard simplified Randles circuit used in Electrochemical Impedance Spectroscopy (EIS) analysis. The impedance functions and circuit laws are fundamental principles of electrical engineering and electrochemistry. The concept of using parameter sensitivities to quantify information content is a cornerstone of system identification and optimal experiment design, often related to the Fisher Information Matrix.\n- **Well-Posedness**: The objective is to maximize a well-defined, continuous function $\\mathcal{I}_{k}(\\omega)$ over a discrete, finite set of frequencies. A maximum is guaranteed to exist. The explicit tie-breaking rule (select the smallest frequency) ensures a unique solution for each parameter.\n- **Verdict**: The problem is valid. We may proceed to the solution.\n\n### Step 1: Derivation of the Total Impedance $Z(\\omega)$\nThe problem describes a circuit composed of three components in series:\n1. A solution resistor with impedance $Z_{R_{\\mathrm{s}}} = R_{\\mathrm{s}}$.\n2. A parallel branch containing a charge-transfer resistor ($R_{\\mathrm{ct}}$) and a double-layer capacitor ($C_{\\mathrm{dl}}$).\n3. A semi-infinite Warburg diffusion element with impedance $Z_{W}(\\omega) = \\frac{\\sigma}{\\sqrt{j \\omega}}$.\n\nThe impedance of the parallel branch, $Z_{\\parallel}$, is found by inverting the sum of the admittances:\n$$\n\\frac{1}{Z_{\\parallel}(\\omega)} = \\frac{1}{Z_{R_{\\mathrm{ct}}}} + \\frac{1}{Z_{C_{\\mathrm{dl}}}} = \\frac{1}{R_{\\mathrm{ct}}} + j \\omega C_{\\mathrm{dl}}\n$$\n$$\nZ_{\\parallel}(\\omega) = \\frac{1}{\\frac{1}{R_{\\mathrm{ct}}} + j \\omega C_{\\mathrm{dl}}} = \\frac{R_{\\mathrm{ct}}}{1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}}\n$$\nTo separate the real and imaginary parts, we multiply by the complex conjugate of the denominator:\n$$\nZ_{\\parallel}(\\omega) = \\frac{R_{\\mathrm{ct}}}{1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}} \\cdot \\frac{1 - j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}}{1 - j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}} = \\frac{R_{\\mathrm{ct}}(1 - j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})}{1 + (\\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2} = \\frac{R_{\\mathrm{ct}}}{1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2} - j \\frac{\\omega R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}}{1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2}\n$$\nThe Warburg impedance, $Z_{W}(\\omega)$, can be expressed in terms of its real and imaginary parts by noting that $\\sqrt{j} = (e^{j\\pi/2})^{1/2} = e^{j\\pi/4} = \\cos(\\pi/4) + j\\sin(\\pi/4) = \\frac{1+j}{\\sqrt{2}}$.\n$$\nZ_{W}(\\omega) = \\frac{\\sigma}{\\sqrt{\\omega}\\sqrt{j}} = \\frac{\\sigma}{\\sqrt{\\omega}} \\frac{\\sqrt{2}}{1+j} = \\frac{\\sigma \\sqrt{2}}{\\sqrt{\\omega}} \\frac{1-j}{2} = \\frac{\\sigma}{\\sqrt{2\\omega}} - j \\frac{\\sigma}{\\sqrt{2\\omega}}\n$$\nThe total impedance $Z(\\omega)$ is the sum of the components in series: $Z(\\omega) = Z_{R_{\\mathrm{s}}} + Z_{\\parallel}(\\omega) + Z_{W}(\\omega)$.\nThe real and imaginary parts of the total impedance are:\n$$\n\\operatorname{Re}\\{Z(\\omega)\\} = R_{\\mathrm{s}} + \\frac{R_{\\mathrm{ct}}}{1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2} + \\frac{\\sigma}{\\sqrt{2\\omega}}\n$$\n$$\n\\operatorname{Im}\\{Z(\\omega)\\} = - \\frac{\\omega R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}}{1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2} - \\frac{\\sigma}{\\sqrt{2\\omega}}\n$$\n\n### Step 2: Derivation of Parameter Sensitivities\nThe local information density $\\mathcal{I}_{k}(\\omega)$ depends on the partial derivatives of $\\operatorname{Re}\\{Z(\\omega)\\}$ and $\\operatorname{Im}\\{Z(\\omega)\\}$ with respect to each parameter $\\theta_k$. Since $\\sigma_{\\mathrm{Re}} = \\sigma_{\\mathrm{Im}} = \\sigma_{\\text{noise}}$, maximizing $\\mathcal{I}_{k}(\\omega)$ is equivalent to maximizing the squared magnitude of the complex sensitivity, $S_k(\\omega) = |\\frac{\\partial Z(\\omega)}{\\partial \\theta_k}|^2 = \\left(\\frac{\\partial \\operatorname{Re}\\{Z\\}}{\\partial \\theta_k}\\right)^2 + \\left(\\frac{\\partial \\operatorname{Im}\\{Z\\}}{\\partial \\theta_k}\\right)^2$. We derive $S_k(\\omega)$ for each parameter.\n\n**Parameter 1: Solution Resistance, $R_{\\mathrm{s}}$**\n$$\n\\frac{\\partial Z(\\omega)}{\\partial R_{\\mathrm{s}}} = 1\n$$\nThus, $S_{R_{\\mathrm{s}}}(\\omega) = |1|^2 = 1$. This is constant across all frequencies.\n\n**Parameter 2: Charge-Transfer Resistance, $R_{\\mathrm{ct}}$**\nThe derivative is most easily found using complex differentiation on the relevant term, $Z_{\\parallel}(\\omega)$. Other terms are independent of $R_{\\mathrm{ct}}$.\n$$\n\\frac{\\partial Z(\\omega)}{\\partial R_{\\mathrm{ct}}} = \\frac{\\partial Z_{\\parallel}(\\omega)}{\\partial R_{\\mathrm{ct}}} = \\frac{\\partial}{\\partial R_{\\mathrm{ct}}} \\left( \\frac{R_{\\mathrm{ct}}}{1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}} \\right) = \\frac{1 \\cdot (1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}) - R_{\\mathrm{ct}} \\cdot (j \\omega C_{\\mathrm{dl}})}{(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2} = \\frac{1}{(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2}\n$$\nThe squared magnitude is:\n$$\nS_{R_{\\mathrm{ct}}}(\\omega) = \\left| \\frac{1}{(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2} \\right|^2 = \\frac{1}{|1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}|^4} = \\frac{1}{(1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2)^2}\n$$\n\n**Parameter 3: Double-Layer Capacitance, $C_{\\mathrm{dl}}$**\nSimilarly, we differentiate with respect to $C_{\\mathrm{dl}}$:\n$$\n\\frac{\\partial Z(\\omega)}{\\partial C_{\\mathrm{dl}}} = \\frac{\\partial Z_{\\parallel}(\\omega)}{\\partial C_{\\mathrm{dl}}} = \\frac{\\partial}{\\partial C_{\\mathrm{dl}}} \\left( R_{\\mathrm{ct}}(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^{-1} \\right) = R_{\\mathrm{ct}} (-1)(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^{-2} (j \\omega R_{\\mathrm{ct}}) = \\frac{-j \\omega R_{\\mathrm{ct}}^2}{(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2}\n$$\nThe squared magnitude is:\n$$\nS_{C_{\\mathrm{dl}}}(\\omega) = \\left| \\frac{-j \\omega R_{\\mathrm{ct}}^2}{(1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}})^2} \\right|^2 = \\frac{|-j \\omega R_{\\mathrm{ct}}^2|^2}{|1 + j \\omega R_{\\mathrm{ct}} C_{\\mathrm{dl}}|^4} = \\frac{\\omega^2 R_{\\mathrm{ct}}^4}{(1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2)^2}\n$$\n\n**Parameter 4: Warburg Coefficient, $\\sigma$**\nThe derivative with respect to $\\sigma$ affects only the Warburg term:\n$$\n\\frac{\\partial Z(\\omega)}{\\partial \\sigma} = \\frac{\\partial Z_W(\\omega)}{\\partial \\sigma} = \\frac{1}{\\sqrt{j\\omega}} = \\frac{1}{\\sqrt{2\\omega}}(1-j)\n$$\nThe squared magnitude is:\n$$\nS_{\\sigma}(\\omega) = \\left| \\frac{1}{\\sqrt{2\\omega}}(1-j) \\right|^2 = \\frac{1}{2\\omega}|1-j|^2 = \\frac{1}{2\\omega}(1^2 + (-1)^2) = \\frac{2}{2\\omega} = \\frac{1}{\\omega}\n$$\nIf $\\sigma=0$, then $Z(\\omega)$ is independent of $\\sigma$, making $\\frac{\\partial Z(\\omega)}{\\partial \\sigma}=0$ and $S_{\\sigma}(\\omega)=0$ for all $\\omega$.\n\n### Step 3: Maximization of Information Density\nWe now analyze the derived sensitivity functions $S_k(\\omega)$ to find the maximizing angular frequency for each parameter.\n\n- **For $R_{\\mathrm{s}}$**: $S_{R_{\\mathrm{s}}}(\\omega) = 1$, which is a constant. The maximum value occurs at all frequencies. According to the tie-breaking rule (\"select the smallest angular frequency among the maximizers\"), we must choose the lowest frequency in the grid, $\\omega_{\\min}$.\n\n- **For $R_{\\mathrm{ct}}$**: $S_{R_{\\mathrm{ct}}}(\\omega) = \\frac{1}{(1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2)^2}$. This function is monotonically decreasing as $\\omega$ increases from $0$. Therefore, its maximum value on the given grid occurs at the lowest frequency, $\\omega_{\\min}$.\n\n- **For $C_{\\mathrm{dl}}$**: $S_{C_{\\mathrm{dl}}}(\\omega) = \\frac{\\omega^2 R_{\\mathrm{ct}}^4}{(1 + \\omega^2 R_{\\mathrm{ct}}^2 C_{\\mathrm{dl}}^2)^2}$. To find the maximum, we can analyze its derivative with respect to $\\omega$. Setting the derivative of this function to zero reveals a maximum at $\\omega = \\frac{1}{R_{\\mathrm{ct}} C_{\\mathrm{dl}}}$. We must numerically evaluate $S_{C_{\\mathrm{dl}}}(\\omega)$ for all $\\omega_i$ in the provided discrete frequency grid and find the frequency that yields the highest value.\n\n- **For $\\sigma$**: If $\\sigma > 0$, $S_{\\sigma}(\\omega) = \\frac{1}{\\omega}$. This function is monotonically decreasing with $\\omega$. Its maximum on the grid occurs at the lowest frequency, $\\omega_{\\min}$. If $\\sigma=0$ (as in Test Case 3), $S_{\\sigma}(\\omega)=0$ for all $\\omega$. Applying the tie-breaking rule, we again select the lowest frequency, $\\omega_{\\min}$.\n\n### Algorithmic Design\nBased on the analysis, the algorithm is as follows:\n1. Generate the logarithmically spaced frequency grid $\\omega_i$ from $\\omega_{\\min}=10^{-2}$ to $\\omega_{\\max}=10^5$ with $N=121$ points.\n2. For each test case $(\\_R_{\\mathrm{s}}, R_{\\mathrm{ct}}, C_{\\mathrm{dl}}, \\sigma)$:\n   a. The optimal frequency for $R_{\\mathrm{s}}$ is $\\omega_{\\min}$.\n   b. The optimal frequency for $R_{\\mathrm{ct}}$ is $\\omega_{\\min}$.\n   c. The optimal frequency for $\\sigma$ is $\\omega_{\\min}$.\n   d. For $C_{\\mathrm{dl}}$, calculate the vector of sensitivity values $S_{C_{\\mathrm{dl}}}(\\omega_i)$ over the entire frequency grid. Find the index of the maximum value using a function like `numpy.argmax()`, which correctly handles ties by returning the first index. The optimal frequency is the grid frequency at this index.\n3. Collect the four frequencies for each test case and format the output as a list of lists.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal angular frequencies that maximize parameter information\n    content for an electrochemical impedance model.\n    \"\"\"\n\n    # Define global constants and the frequency grid\n    omega_min = 1e-2\n    omega_max = 1e5\n    N = 121\n    \n    # Generate a logarithmically spaced frequency grid\n    omegas = np.logspace(np.log10(omega_min), np.log10(omega_max), num=N)\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # (Rs, Rct, Cdl, sigma)\n        (0.05, 0.5, 0.002, 0.1),   # Test case 1\n        (0.1, 0.05, 0.001, 0.2),  # Test case 2\n        (0.02, 2.0, 0.005, 0.0),   # Test case 3\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        _Rs, Rct, Cdl, _sigma = case\n        \n        # 1. Optimal frequency for Rs\n        # The sensitivity |dZ/dRs|^2 is 1 for all frequencies.\n        # By the tie-breaking rule (select smallest frequency), the answer is omega_min.\n        w_opt_Rs = omega_min\n\n        # 2. Optimal frequency for Rct\n        # The sensitivity |dZ/dRct|^2 = 1 / (1 + (w*Rct*Cdl)^2)^2.\n        # This function is monotonically decreasing with w.\n        # The maximum is at the smallest frequency, omega_min.\n        w_opt_Rct = omega_min\n\n        # 3. Optimal frequency for Cdl\n        # The sensitivity is |dZ/dCdl|^2 = (w^2 * Rct^4) / (1 + (w*Rct*Cdl)^2)^2.\n        # We must evaluate this function over the frequency grid to find the maximum.\n        # Check for Rct=0 or Cdl=0 to avoid division by zero, though not in test cases.\n        if Rct == 0.0 or Cdl == 0.0:\n            # If Rct or Cdl is zero, sensitivity is zero. By tie-break, use omega_min.\n            w_opt_Cdl = omega_min\n        else:\n            w2 = omegas**2\n            Rct4 = Rct**4\n            tau2 = (Rct * Cdl)**2\n            \n            numerator = w2 * Rct4\n            denominator = (1 + w2 * tau2)**2\n            \n            S_Cdl = numerator / denominator\n            \n            # np.argmax returns the index of the first occurrence of the maximum value,\n            # which respects the tie-breaking rule.\n            max_idx = np.argmax(S_Cdl)\n            w_opt_Cdl = omegas[max_idx]\n\n        # 4. Optimal frequency for sigma\n        # The sensitivity |dZ/dsigma|^2 = 1/w for sigma > 0.\n        # This is monotonically decreasing, so the max is at omega_min.\n        # If sigma = 0 (Test Case 3), dZ/dsigma = 0, so sensitivity is 0 for all w.\n        # Applying the tie-breaking rule, the answer is omega_min.\n        w_opt_sigma = omega_min\n        \n        case_results = [w_opt_Rs, w_opt_Rct, w_opt_Cdl, w_opt_sigma]\n        all_results.append(case_results)\n\n    # Format the final output string as per the problem specification.\n    formatted_cases = [f\"[{','.join(map(str, case_res))}]\" for case_res in all_results]\n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}