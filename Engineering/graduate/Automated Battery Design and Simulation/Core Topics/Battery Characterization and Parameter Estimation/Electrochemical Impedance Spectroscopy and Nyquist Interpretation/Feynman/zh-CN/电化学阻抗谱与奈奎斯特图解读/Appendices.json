{
    "hands_on_practices": [
        {
            "introduction": "在对电化学阻抗谱 (EIS) 数据进行任何物理解释或模型拟合之前，一个关键的首要步骤是验证其数据质量。源于阻抗所固有的因果性和线性等基本原理的 Kramers-Kronig (K-K) 关系，为此提供了一个强大的数学工具。这项实践将挑战您从第一性原理出发，实现一个数值化的 K-K 测试，使您能够诊断实验数据中可能存在的非线性、漂移或过度噪声等问题。",
            "id": "3908839",
            "problem": "针对自动化电池设计和仿真中的电化学阻抗谱 (EIS) 数据，设计并实现一个 Kramers–Kronig (K-K) 相符性测试。EIS 阻抗是角频率 $\\omega$ 的一个复函数 $Z(\\omega) = Z^{\\prime}(\\omega) + \\mathrm{i}\\,Z^{\\prime\\prime}(\\omega)$，其中 $Z^{\\prime}(\\omega)$ 和 $Z^{\\prime\\prime}(\\omega)$ 分别表示其实部和虚部。您必须从以下基本原理出发：一个线性时不变、因果且稳定的电化学系统，其响应函数的傅里叶变换在复频率平面的上半平面是解析的，因此其实部和虚部通过希尔伯特变换类型的积分关系（即 Kramers–Kronig 关系）相联系。根据这些原理，推导出将 $Z^{\\prime}(\\omega)$ 表示为 $Z^{\\prime\\prime}(\\omega)$ 的积分以及将 $Z^{\\prime\\prime}(\\omega)$ 表示为 $Z^{\\prime}(\\omega)$ 的积分的积分约束，这些积分均为正频率范围上的主值积分。利用这些约束，设计一个数值测试，通过一部分重构另一部分并量化残差。\n\n您的程序必须仅使用本说明中的信息完成以下任务：\n\n- 从解析性和因果性出发，推导出连接 $Z^{\\prime}(\\omega)$ 和 $Z^{\\prime\\prime}(\\omega)$ 的主值积分表达式。在一个有限、严格递增、正值的角频率网格 $\\{\\omega_i\\}_{i=1}^N$ 上，使用一致的求积规则对积分进行离散化。在重构 $\\omega_k$ 处的值时，通过排除在 $\\omega = \\omega_k$ 处的奇异贡献来实现柯西主值。在 $\\omega$ 域中使用梯形类型的权重 $w_i$，其定义为在端点处使用单边差分，在内部使用中心差分；即 $w_1 = \\omega_2 - \\omega_1$，$w_N = \\omega_N - \\omega_{N-1}$，对于内部索引 $i \\in \\{2,\\dots,N-1\\}$，$w_i = (\\omega_{i+1} - \\omega_{i-1})/2$。\n- 由于积分需要知道渐近行为，通过在最高测量频率处评估的 $Z^{\\prime}(\\omega)$ 来估计高频极限 $Z(\\infty)$，即 $Z^{\\prime}(\\omega_N)$，并在两个重构中一致地使用它。\n- 计算每个 $\\omega_k$ 处的残差 $r^{\\prime}(\\omega_k) = Z^{\\prime}_{\\mathrm{meas}}(\\omega_k) - Z^{\\prime}_{\\mathrm{rec}}(\\omega_k)$ 和 $r^{\\prime\\prime}(\\omega_k) = Z^{\\prime\\prime}_{\\mathrm{meas}}(\\omega_k) - Z^{\\prime\\prime}_{\\mathrm{rec}}(\\omega_k)$。通过模值 $|Z(\\omega_k)| = \\sqrt{[Z^{\\prime}(\\omega_k)]^2 + [Z^{\\prime\\prime}(\\omega_k)]^2}$ 进行逐点归一化，以获得无量纲残差。\n- 将归一化残差聚合成三个指标：归一化实部残差的均方根 (RMS)，归一化虚部残差的 RMS，以及定义为这两个 RMS 值平方的平均值的平方根的组合 RMS。具体来说，如果归一化残差向量是 $\\rho^{\\prime}$ 和 $\\rho^{\\prime\\prime}$，计算 $\\mathrm{NRMS}_{\\mathrm{re}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N [\\rho^{\\prime}(\\omega_k)]^2}$，$\\mathrm{NRMS}_{\\mathrm{im}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N [\\rho^{\\prime\\prime}(\\omega_k)]^2}$，以及 $\\mathrm{NRMS}_{\\mathrm{all}} = \\sqrt{\\frac{1}{2}\\left(\\mathrm{NRMS}_{\\mathrm{re}}^2 + \\mathrm{NRMS}_{\\mathrm{im}}^2\\right)}$。\n- 提出一个决策阈值 $\\tau$（无量纲），用于标记由非线性、噪声或漂移导致的非相符性。您的提议应基于电池测试中合理的 EIS 信噪比假设，并用它为每个数据集返回一个布尔决策：如果 $\\mathrm{NRMS}_{\\mathrm{all}} \\le \\tau$，则返回 $\\mathrm{True}$，否则返回 $\\mathrm{False}$。\n\n物理单位和数值要求：\n\n- 输入的频率必须解释为以赫兹 (Hz) 为单位的频率 $f$，并通过 $\\omega = 2\\pi f$ 转换为以弧度/秒为单位的角频率。阻抗单位为欧姆 (Ω)。您的输出是无量纲的。\n- 将所有浮点输出四舍五入到 $6$ 位小数。\n\n测试套件和数据集：\n\n使用以下四个合成数据集作为测试套件。对于每个数据集，在指定的 $f_{\\min}$ 和 $f_{\\max}$ 之间构造 $N$ 个对数间隔的频率 $f_i$（单位为赫兹），计算 $\\omega_i = 2\\pi f_i$，并为一个单时间常数 Randles 电路模拟复阻抗 $Z(\\omega)$。Randles 电路模型是一个串联欧姆电阻与一个电荷转移电阻和一个双电层电容的并联组合串联而成；它是根据标准电路定律和线性时不变假设生成的。按每个数据集的规定使用以下参数值：\n\n- 数据集 A (理想情况): $R_s = 0.5$ 欧姆, $R_{ct} = 1.0$ 欧姆, $C_{dl} = 1.5\\times 10^{-3}$ 法拉, $N = 64$, $f_{\\min} = 0.1$ 赫兹, $f_{\\max} = 10^4$ 赫兹。无额外扰动。\n- 数据集 B (噪声): 与数据集 A 相同，但在每个频率上向 $Z^{\\prime}$ 和 $Z^{\\prime\\prime}$ 分别添加标准差为 $\\sigma = 5\\times 10^{-3}$ 欧姆的独立零均值高斯噪声。使用固定的随机种子 $12345$ 以确保可复现性。\n- 数据集 C (漂移/非线性替代): 与数据集 A 相同，但向虚部添加一个缓慢变化的基线偏置：$Z^{\\prime\\prime} \\leftarrow Z^{\\prime\\prime} + b(f)$，其中 $b(f) = b_0 (f/f_{\\mathrm{ref}})^{-\\alpha}$，$b_0 = 0.05$ 欧姆，$f_{\\mathrm{ref}} = 1.0$ 赫兹，以及 $\\alpha = 0.3$。\n- 数据集 D (稀疏网格边界情况): 与数据集 A 相同，但 $N = 12$。\n\n最终程序输出的规范：\n\n- 对于每个数据集，计算并返回一个包含四项的列表：$[\\mathrm{NRMS}_{\\mathrm{re}}, \\mathrm{NRMS}_{\\mathrm{im}}, \\mathrm{NRMS}_{\\mathrm{all}}, \\mathrm{Decision}]$，其中三个 RMS 指标是四舍五入到 $6$ 位小数的浮点数，决策是根据您提出的 $\\tau$ 定义的布尔值。\n- 您的程序应产生单行输出，其中包含四个数据集的结果，格式为一个逗号分隔的、每个数据集四个结果的列表，并用方括号括起来，不含空格。例如，打印的行必须看起来像 $[[a,b,c,True],[d,e,f,False],\\dots]$，所有浮点数按规定四舍五入，布尔值拼写为 $True$ 或 $False$。\n\n所有计算必须由您自己实现；不要调用任何专门的 K-K 或 EIS 库函数。程序必须完全自包含，不接受任何输入，并严格按照指定格式产生一行输出。",
            "solution": "该问题要求设计并实现一个用于电化学阻抗谱（EIS）数据的 Kramers-Kronig（K-K）相符性测试。解决方案涉及从基本原理推导 K-K 关系，将其离散化以便进行数值计算，并将该测试应用于几个合成数据集以评估其相符性。\n\n### 基于原理的设计\n\n#### 1. Kramers-Kronig 关系的推导\n该测试的基础在于复阻抗 $Z(\\tilde{\\omega})$ 作为一个线性、时不变（LTI）、因果且稳定系统的响应函数所具有的性质。对于这样的系统，$Z(\\tilde{\\omega})$ 在复频率平面的上半平面（$\\mathrm{Im}(\\tilde{\\omega}) > 0$）是解析的。这种解析性允许使用柯西积分关系。\n\n设无穷大频率处的阻抗为一个实数值 $Z_{\\infty} = \\lim_{\\omega\\to\\infty} Z(\\omega)$。函数 $Z(\\tilde{\\omega}) - Z_{\\infty}$ 在上半平面当 $|\\tilde{\\omega}| \\to \\infty$ 时趋于零。对于实轴上的一个点 $\\omega$，柯西主值积分公式给出：\n$$ Z(\\omega) - Z_{\\infty} = \\frac{1}{\\mathrm{i}\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z(\\omega') - Z_{\\infty}}{\\omega' - \\omega} d\\omega' $$\n其中 $\\mathcal{P}$ 表示柯西主值。代入 $Z(\\omega) = Z'(\\omega) + \\mathrm{i}Z''(\\omega)$ 得到：\n$$ Z'(\\omega) - Z_{\\infty} + \\mathrm{i}Z''(\\omega) = \\frac{1}{\\mathrm{i}\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z'(\\omega') - Z_{\\infty} + \\mathrm{i}Z''(\\omega')}{\\omega' - \\omega} d\\omega' = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z''(\\omega')}{\\omega' - \\omega} d\\omega' - \\frac{\\mathrm{i}}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z'(\\omega') - Z_{\\infty}}{\\omega' - \\omega} d\\omega' $$\n分别令实部和虚部相等，我们得到：\n$$ Z'(\\omega) - Z_{\\infty} = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z''(\\omega')}{\\omega' - \\omega} d\\omega' $$\n$$ Z''(\\omega) = -\\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{Z'(\\omega') - Z_{\\infty}}{\\omega' - \\omega} d\\omega' $$\n对于真实的物理系统，阻抗满足性质 $Z(-\\omega) = Z^*(\\omega)$，这意味着 $Z'(\\omega)$ 是频率的偶函数，而 $Z''(\\omega)$ 是频率的奇函数。这种对称性允许将积分变换到正频率域 $[0, \\infty)$：\n$$ Z'(\\omega) - Z_{\\infty} = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' Z''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega' \\quad (1) $$\n$$ Z''(\\omega) = -\\frac{2\\omega}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{Z'(\\omega') - Z_{\\infty}}{(\\omega')^2 - \\omega^2} d\\omega' \\quad (2) $$\n这些积分关系构成了我们数值测试的基础。它们允许从阻抗谱的一部分重构另一部分。\n\n#### 2. 数值实现\n该测试通过在有限的测量角频率网格 $\\{\\omega_i\\}_{i=1}^N$ 上离散化积分（1）和（2）来实现。\n\n**离散化：** 积分通过加权和来近似。给定一组测量的阻抗值 $(Z'(\\omega_i), Z''(\\omega_i))$，我们在网格中的每个频率 $\\omega_k$ 处重构谱，记为 $Z'_{\\mathrm{rec}}(\\omega_k)$ 和 $Z''_{\\mathrm{rec}}(\\omega_k)$。问题指定了一个具有权重 $w_i$ 的特定求积规则：\n- $w_1 = \\omega_2 - \\omega_1$\n- $w_N = \\omega_N - \\omega_{N-1}$\n- 对于 $i \\in \\{2, \\ldots, N-1\\}$，$w_i = (\\omega_{i+1} - \\omega_{i-1})/2$\n\n高频极限 $Z_{\\infty}$ 是未知的，必须从可用数据中估计。按照规定，我们使用最高测量频率处的阻抗实部：$Z_{\\infty} \\approx Z'_{\\mathrm{meas}}(\\omega_N)$。\n\n柯西主值通过从求和中排除 $i=k$ 的项来处理，因为在该点积分函数的分母为零。方程（1）和（2）的离散形式是：\n$$ Z'_{\\mathrm{rec}}(\\omega_k) \\approx Z_{\\infty} + \\frac{2}{\\pi} \\sum_{i=1, i \\neq k}^{N} \\frac{\\omega_i Z''_{\\mathrm{meas}}(\\omega_i)}{(\\omega_i)^2 - \\omega_k^2} w_i \\quad (3) $$\n$$ Z''_{\\mathrm{rec}}(\\omega_k) \\approx -\\frac{2\\omega_k}{\\pi} \\sum_{i=1, i \\neq k}^{N} \\frac{Z'_{\\mathrm{meas}}(\\omega_i) - Z_{\\infty}}{(\\omega_i)^2 - \\omega_k^2} w_i \\quad (4) $$\n\n#### 3. 残差分析与度量\n通过量化测量谱与重构谱之间的差异来评估给定数据集的 K-K 关系有效性。\n\n**残差：** 在每个频率点 $\\omega_k$ 计算残差：\n- 实部残差: $r'(\\omega_k) = Z'_{\\mathrm{meas}}(\\omega_k) - Z'_{\\mathrm{rec}}(\\omega_k)$\n- 虚部残差: $r''(\\omega_k) = Z''_{\\mathrm{meas}}(\\omega_k) - Z''_{\\mathrm{rec}}(\\omega_k)$\n\n**归一化：** 为了使残差无量纲化，并在不同频率范围和阻抗大小之间具有可比性，它们通过阻抗模量 $|Z(\\omega_k)| = \\sqrt{Z'_{\\mathrm{meas}}(\\omega_k)^2 + Z''_{\\mathrm{meas}}(\\omega_k)^2}$ 进行归一化：\n- 归一化实部残差: $\\rho'(\\omega_k) = r'(\\omega_k) / |Z(\\omega_k)|$\n- 归一化虚部残差: $\\rho''(\\omega_k) = r''(\\omega_k) / |Z(\\omega_k)|$\n\n**聚合度量：** 将归一化残差集合聚合成三个均方根（RMS）度量，以提供对整体相符性的简明摘要：\n- $\\mathrm{NRMS}_{\\mathrm{re}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N [\\rho'(\\omega_k)]^2}$\n- $\\mathrm{NRMS}_{\\mathrm{im}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N [\\rho''(\\omega_k)]^2}$\n- $\\mathrm{NRMS}_{\\mathrm{all}} = \\sqrt{\\frac{1}{2}\\left(\\mathrm{NRMS}_{\\mathrm{re}}^2 + \\mathrm{NRMS}_{\\mathrm{im}}^2\\right)}$\n\n#### 4. 相符性判定\n通过将组合度量 $\\mathrm{NRMS}_{\\mathrm{all}}$ 与预定义阈值 $\\tau$ 进行比较，来对 K-K 相符性做出判定。\n在高质量的 EIS 测量中，与理想 LTI 行为的偏差很小。低于百分之几的归一化残差水平通常被认为表示数据质量良好。低于 $1\\%$ 的残差表明数据极佳，而超过 $5\\%$ 的残差通常指向显著的测量伪影，如噪声、漂移或非线性。基于这些考虑，我们提出一个阈值 $\\tau = 0.03$。该值代表 $3\\%$ 的平均相对误差，为标记可能不相符的数据提供了一个合理的平衡，同时容忍了轻微的实验噪声和数值伪影。\n决策规则是：\n- 如果 $\\mathrm{NRMS}_{\\mathrm{all}} \\le \\tau$，返回 `True`（相符）。\n- 如果 $\\mathrm{NRMS}_{\\mathrm{all}} > \\tau$，返回 `False`（不相符）。\n\n#### 5. 测试数据生成\n测试套件使用来自 Randles 等效电路的合成数据，其阻抗由下式给出：\n$$ Z(\\omega) = R_s + \\frac{R_{ct}}{1 + \\mathrm{i}\\omega R_{ct} C_{dl}} $$\n这可以分离成实部和虚部：\n$$ Z'(\\omega) = R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2} $$\n$$ Z''(\\omega) = - \\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} $$\n其中 $R_s$ 是串联电阻，$R_{ct}$ 是电荷转移电阻，$C_{dl}$ 是双电层电容。该模型本质上是 LTI，因此是 K-K 相符的。添加扰动以模拟测量中的不完美之处。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported, as per the rules.\n\ndef solve():\n    \"\"\"\n    Main function to run the Kramers-Kronig compliance test on a suite of datasets.\n    \"\"\"\n    \n    # Decision threshold for K-K compliance.\n    # A value of 0.03 (3%) is chosen as a reasonable threshold for distinguishing\n    # high-quality data from data with significant artifacts.\n    TAU_THRESHOLD = 0.03\n\n    # Define the parameters for the four test cases.\n    # (Rs, Rct, Cdl, N, fmin, fmax, noise_sigma, drift_params)\n    test_cases = [\n        # Dataset A (happy path)\n        (0.5, 1.0, 1.5e-3, 64, 0.1, 1e4, 0.0, None),\n        # Dataset B (noise)\n        (0.5, 1.0, 1.5e-3, 64, 0.1, 1e4, 5e-3, None),\n        # Dataset C (drift/non-linearity surrogate)\n        (0.5, 1.0, 1.5e-3, 64, 0.1, 1e4, 0.0, {'b0': 0.05, 'f_ref': 1.0, 'alpha': 0.3}),\n        # Dataset D (sparse grid boundary case)\n        (0.5, 1.0, 1.5e-3, 12, 0.1, 1e4, 0.0, None)\n    ]\n\n    all_results = []\n    \n    # Use a fixed seed for the random number generator for reproducibility.\n    rng = np.random.default_rng(12345)\n\n    for case in test_cases:\n        rs, rct, cdl, n, fmin, fmax, noise_sigma, drift_params = case\n        \n        # 1. Generate Data\n        f = np.logspace(np.log10(fmin), np.log10(fmax), n)\n        omega = 2 * np.pi * f\n        \n        # Randles circuit impedance\n        z_prime_ideal = rs + rct / (1 + (omega * rct * cdl)**2)\n        z_imag_ideal = - (omega * rct**2 * cdl) / (1 + (omega * rct * cdl)**2)\n        \n        z_meas_prime = z_prime_ideal\n        z_meas_imag = z_imag_ideal\n        \n        # Apply perturbations\n        if noise_sigma > 0:\n            noise_prime = rng.normal(scale=noise_sigma, size=n)\n            noise_imag = rng.normal(scale=noise_sigma, size=n)\n            z_meas_prime += noise_prime\n            z_meas_imag += noise_imag\n        \n        if drift_params:\n            b0, f_ref, alpha = drift_params['b0'], drift_params['f_ref'], drift_params['alpha']\n            bias = b0 * (f / f_ref)**(-alpha)\n            z_meas_imag += bias\n\n        # 2. K-K Transform\n        # Estimate high-frequency limit\n        z_inf = z_meas_prime[-1]\n        \n        # Calculate quadrature weights\n        w = np.zeros(n)\n        if n > 1:\n            w[0] = omega[1] - omega[0]\n            w[-1] = omega[-1] - omega[-2]\n            if n > 2:\n                w[1:-1] = (omega[2:] - omega[:-2]) / 2\n\n        z_rec_prime = np.zeros(n)\n        z_rec_imag = np.zeros(n)\n\n        # Perform reconstruction for each frequency point k\n        for k in range(n):\n            omega_k = omega[k]\n            \n            # Use boolean mask to exclude the singularity at i=k\n            i_not_k = np.arange(n) != k\n            omega_i = omega[i_not_k]\n            w_i = w[i_not_k]\n            \n            # Common denominator term\n            denom = omega_i**2 - omega_k**2\n            \n            # Reconstruct real part from imaginary part\n            integrand_prime = (omega_i * z_meas_imag[i_not_k]) / denom\n            sum_prime = np.sum(integrand_prime * w_i)\n            z_rec_prime[k] = z_inf + (2 / np.pi) * sum_prime\n            \n            # Reconstruct imaginary part from real part\n            integrand_imag = (z_meas_prime[i_not_k] - z_inf) / denom\n            sum_imag = np.sum(integrand_imag * w_i)\n            z_rec_imag[k] = (-2 * omega_k / np.pi) * sum_imag\n            \n        # 3. Residuals and Metrics\n        res_prime = z_meas_prime - z_rec_prime\n        res_imag = z_meas_imag - z_rec_imag\n        \n        # Impedance modulus for normalization\n        z_mod = np.sqrt(z_meas_prime**2 + z_meas_imag**2)\n        # Avoid division by zero, although not expected in these datasets\n        z_mod[z_mod == 0] = 1e-9 \n        \n        norm_res_prime = res_prime / z_mod\n        norm_res_imag = res_imag / z_mod\n        \n        # Calculate final metrics\n        nrms_re = np.sqrt(np.mean(norm_res_prime**2))\n        nrms_im = np.sqrt(np.mean(norm_res_imag**2))\n        nrms_all = np.sqrt(0.5 * (nrms_re**2 + nrms_im**2))\n        \n        # 4. Decision\n        decision = nrms_all = TAU_THRESHOLD\n        \n        # Store rounded results\n        all_results.append([\n            round(nrms_re, 6),\n            round(nrms_im, 6),\n            round(nrms_all, 6),\n            decision\n        ])\n\n    # 5. Final Output Formatting\n    case_outputs = []\n    for res in all_results:\n        # Format: [float,float,float,Bool] with 6 decimal places for floats\n        s = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]}]\"\n        case_outputs.append(s)\n        \n    final_output_string = f\"[{','.join(case_outputs)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "一旦数据有效性得到确认，我们就可以开始从阻抗谱中提取物理意义。高频截距 $R_s$ 代表总欧姆电阻，通常是谱图中最容易解释的特征。本练习将指导您基于电解质的物理特性，特别是其电导率 $\\kappa(T)$，来构建一个依赖于温度的 $R_s$ 预测模型，从而在观测到的 EIS 参数与潜在的材料科学之间建立联系。",
            "id": "3908796",
            "problem": "您正在构建一个自动化模块，用于根据温度预测锂离子电池单元的电化学阻抗谱（EIS）中的高频截距。高频截距，用 $R_s$ 表示，反映了主要由电解质和电子接触决定的总欧姆电阻。从电传导的第一性原理和对EIS高频截距的公认解释出发，推导并实现一种算法，该算法使用测量的电解质电导率数据计算在指定温度区间内 $R_s$ 的预期变化，并使用线性拟合方法根据提供的截距测量值验证模型。\n\n基础原理：\n- 电导率 $\\kappa(T)$ 是电阻率 $\\rho(T)$ 的倒数，即 $\\rho(T) = 1/\\kappa(T)$。\n- 在均匀传导条件下，微分形式的欧姆定律通过 $J = \\kappa E$ 将电流密度 $J$ 和电场 $E$ 联系起来，厚度为 $L$、截面积为 $A$ 的平板电阻由 $R = V/I$、 $V = E L$ 和 $I = J A$ 得到，得出 $R_{\\text{electrolyte}}(T) = \\dfrac{L}{\\kappa(T) A}$。\n- EIS高频截距被建模为 $R_s(T) = \\dfrac{L}{\\kappa(T) A} + R_0$，其中 $R_0$ 在所考虑的狭窄范围内是一个与温度无关的接触/电子电阻。\n\n任务：\n1. 给定一个以开尔文为单位的温度数组 $\\{T_i\\}$、以西门子/米为单位的测量的电解质电导率 $\\{\\kappa_i\\}$、以米为单位的几何参数 $L$ 和以平方米为单位的 $A$、以及一个以欧姆为单位的常数 $R_0$，对电导率倒数与温度倒数进行线性最小二乘拟合：\n   $$y_i = \\frac{1}{\\kappa_i}, \\quad x_i = \\frac{1}{T_i}, \\quad y \\approx \\alpha x + \\beta,$$\n   其中 $\\alpha$ 和 $\\beta$ 是拟合参数，其单位的选择使得关系在量纲上保持一致。\n2. 使用拟合关系，通过以下公式预测每个 $T_i$ 处的电导率：\n   $$\\kappa_{\\text{pred}}(T_i) = \\frac{1}{\\alpha \\cdot \\frac{1}{T_i} + \\beta}.$$\n3. 使用以下公式计算每个温度下的预测高频截距：\n   $$R_{s,\\text{pred}}(T_i) = \\frac{L}{\\kappa_{\\text{pred}}(T_i) \\, A} + R_0.$$\n4. 计算在测试温度所跨越的区间内 $R_s$ 的预期变化，如下所示：\n   $$\\Delta R_s = R_{s,\\text{pred}}(T_{\\max}) - R_{s,\\text{pred}}(T_{\\min}),$$\n   以欧姆表示。\n5. 通过计算以欧姆为单位的均方根误差（RMSE），根据提供的测量截距 $\\{R_{s,\\text{meas}}(T_i)\\}$ 验证预测：\n   $$\\text{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\left( R_{s,\\text{pred}}(T_i) - R_{s,\\text{meas}}(T_i) \\right)^2 }.$$\n\n物理单位：\n- 温度 $T$ 必须以开尔文为单位。\n- 电导率 $\\kappa$ 必须以西门子/米为单位。\n- 厚度 $L$ 必须以米为单位。\n- 面积 $A$ 必须以平方米为单位。\n- 电阻 $R_s$ 和 $R_0$ 必须以欧姆为单位。\n\n角度单位不适用。百分比不适用。\n\n测试套件：\n对以下参数集实现该算法。所有输出必须以欧姆表示。\n\n- 案例1（一般情况）：$L = 25 \\times 10^{-6}$ m, $A = 1 \\times 10^{-2}$ m$^2$, $R_0 = 0.005$ $\\Omega$, 温度 $[293, 298, 303, 308, 313]$ K, 测量的电导率 $\\kappa$ $[0.9881, 0.9867, 1.0151, 1.0131, 1.0162]$ S/m, 测量的 $R_s$ $[0.007529, 0.007557, 0.0074388, 0.0074936, 0.0074378]$ $\\Omega$。\n- 案例2（边界：用于线性拟合的最少点数）：$L = 20 \\times 10^{-6}$ m, $A = 5 \\times 10^{-3}$ m$^2$, $R_0 = 0.002$ $\\Omega$, 温度 $[295, 310]$ K, 测量的电导率 $\\kappa$ $[0.8825, 0.8869]$ S/m, 测量的 $R_s$ $[0.006577, 0.006478]$ $\\Omega$。\n- 案例3（边缘：由于高电导率和大面积导致的极小截距）：$L = 10 \\times 10^{-6}$ m, $A = 5 \\times 10^{-2}$ m$^2$, $R_0 = 0.0$ $\\Omega$, 温度 $[298, 299, 300]$ K, 测量的电导率 $\\kappa$ $[1.1516, 1.1559, 1.1515]$ S/m, 测量的 $R_s$ $[0.0001737, 0.0001725, 0.0001743]$ $\\Omega$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含六个用逗号分隔的浮点数，并用方括号括起来，表示按顺序排列的每个案例的指标的扁平化列表\n$$[\\Delta R_{s}^{(1)}, \\text{RMSE}^{(1)}, \\Delta R_{s}^{(2)}, \\text{RMSE}^{(2)}, \\Delta R_{s}^{(3)}, \\text{RMSE}^{(3)}],$$\n其中上标表示案例索引。所有值必须以欧姆为单位。不应打印任何附加文本。",
            "solution": "该问题要求开发并验证一个模型，用于预测锂离子电池单元的高频欧姆电阻 $R_s$ 作为温度 $T$ 的函数。该模型基于电传导的基本原理和对电化学阻抗谱（EIS）数据的标准解释。解决方案涉及实现一个包括数据拟合、预测和误差分析的多步骤算法。\n\n高频截距的物理模型由以下公式给出：\n$$R_s(T) = R_{\\text{electrolyte}}(T) + R_0$$\n其中 $R_0$ 是与温度无关的接触和电子电阻，而 $R_{\\text{electrolyte}}(T)$ 是电解质的温度依赖性电阻。对于厚度为 $L$、截面积为 $A$ 的电解质平板，其电阻与电解质的电导率 $\\kappa(T)$ 的关系如下：\n$$R_{\\text{electrolyte}}(T) = \\frac{L}{\\kappa(T) A}$$\n将此代入 $R_s(T)$ 的模型中，得到：\n$$R_s(T) = \\frac{L}{\\kappa(T) A} + R_0$$\n任务是使用在一系列温度 $\\{T_i\\}$ 下测得的电导率数据 $\\{\\kappa_i\\}$，为 $\\kappa(T)$ 以及随后的 $R_s(T)$ 创建一个预测模型。\n\n算法过程执行如下：\n\n步骤1：电解质电阻率的经验建模\n问题假设电导率的倒数（电阻率, $\\rho$）与绝对温度的倒数之间存在经验线性关系。这是在狭窄温度范围内对热激活过程进行建模的常用方法。我们将线性拟合的变量定义为 $y_i = 1/\\kappa_i$ 和 $x_i = 1/T_i$。要拟合的模型是：\n$$y \\approx \\alpha x + \\beta$$\n其中 $\\alpha$ 和 $\\beta$ 是待定参数。为确保量纲一致性，$\\alpha$ 的单位是 $\\Omega \\cdot m \\cdot K$，$\\beta$ 的单位是 $\\Omega \\cdot m$。我们得到 $n$ 个数据点 $(x_i, y_i)$，对应于测量的温度和电导率。通过最小化残差平方和 $S = \\sum_{i=1}^{n} (y_i - (\\alpha x_i + \\beta))^2$ 来找到参数 $\\alpha$ 和 $\\beta$。通过求解正规方程组可以获得最优值，只要 $x_i$ 值存在方差，就能得到 $\\alpha$ 和 $\\beta$ 的唯一解：\n$$ \\alpha = \\frac{n \\sum_{i=1}^{n} x_i y_i - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n \\sum_{i=1}^{n} x_i^2 - (\\sum_{i=1}^{n} x_i)^2} $$\n$$ \\beta = \\bar{y} - \\alpha \\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} y_i - \\alpha \\left( \\frac{1}{n}\\sum_{i=1}^{n} x_i \\right) $$\n\n步骤2：电导率和高频截距的预测\n一旦从拟合中确定了参数 $\\alpha$ 和 $\\beta$，该模型就可用于预测在拟合范围内的任何给定温度 $T$ 下的电解质电阻率 $\\rho_{\\text{pred}}$ 和电导率 $\\kappa_{\\text{pred}}$：\n$$ \\rho_{\\text{pred}}(T) = \\alpha \\cdot \\frac{1}{T} + \\beta $$\n$$ \\kappa_{\\text{pred}}(T) = \\frac{1}{\\rho_{\\text{pred}}(T)} = \\frac{1}{\\alpha \\cdot \\frac{1}{T} + \\beta} $$\n使用此预测电导率，为原始数据集中的每个温度 $T_i$ 计算高频截距 $R_{s,\\text{pred}}$：\n$$R_{s,\\text{pred}}(T_i) = \\frac{L}{\\kappa_{\\text{pred}}(T_i) A} + R_0 = \\frac{L}{A} \\rho_{\\text{pred}}(T_i) + R_0$$\n\n步骤3：性能指标的计算\n使用两个指标来评估模型的性能。首先，计算在测量温度范围内预测电阻的总变化 $\\Delta R_s$。这被定义为输入集中最高温度 $T_{\\max}$ 和最低温度 $T_{\\min}$ 时的预测电阻之差：\n$$\\Delta R_s = R_{s,\\text{pred}}(T_{\\max}) - R_{s,\\text{pred}}(T_{\\min})$$\n$\\Delta R_s$ 的负值表示电阻随温度升高而减小，这对于液体电解质是典型的。\n\n其次，通过计算预测截距 $\\{R_{s,\\text{pred}}(T_i)\\}$ 与实验测量的截距 $\\{R_{s,\\text{meas}}(T_i)\\}$ 之间的均方根误差（RMSE）来量化模型的准确性。RMSE由以下公式给出：\n$$\\text{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\left( R_{s,\\text{pred}}(T_i) - R_{s,\\text{meas}}(T_i) \\right)^2 }$$\n该指标以欧姆为单位，提供了模型预测值与测量值之间平均偏差的度量。\n\n对提供的每个测试案例实施该算法，为每个案例生成两个指定的指标：$\\Delta R_s$ 和 RMSE。然后将这些结果按要求编译成一个单一的输出数组。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the battery EIS modeling problem for all specified test cases.\n    \"\"\"\n    # Test cases defined as per the problem statement.\n    # Each case is a tuple: (L, A, R0, T_array, kappa_array, Rs_meas_array)\n    test_cases = [\n        # Case 1\n        (25e-6, 1e-2, 0.005,\n         np.array([293, 298, 303, 308, 313]),\n         np.array([0.9881, 0.9867, 1.0151, 1.0131, 1.0162]),\n         np.array([0.007529, 0.007557, 0.0074388, 0.0074936, 0.0074378])),\n        # Case 2\n        (20e-6, 5e-3, 0.002,\n         np.array([295, 310]),\n         np.array([0.8825, 0.8869]),\n         np.array([0.006577, 0.006478])),\n        # Case 3\n        (10e-6, 5e-2, 0.0,\n         np.array([298, 299, 300]),\n         np.array([1.1516, 1.1559, 1.1515]),\n         np.array([0.0001737, 0.0001725, 0.0001743]))\n    ]\n\n    results = []\n    for case in test_cases:\n        L, A, R0, T, kappa_meas, Rs_meas = case\n        n = len(T)\n\n        # Step 1: Perform a linear least-squares fit\n        # y = 1/kappa, x = 1/T\n        x = 1.0 / T\n        y = 1.0 / kappa_meas\n        \n        # Fit y = alpha * x + beta using numpy.polyfit\n        # alpha is the first coefficient, beta is the second\n        alpha, beta = np.polyfit(x, y, deg=1)\n\n        # Step 2: Predict conductivity at each temperature\n        # rho_pred = alpha * (1/T) + beta\n        rho_pred = alpha * x + beta\n        kappa_pred = 1.0 / rho_pred\n\n        # Step 3: Compute the predicted high-frequency intercept\n        Rs_pred = (L / A) * rho_pred + R0\n\n        # Step 4: Compute the expected change in Rs\n        # T_min and T_max are the first and last elements since T is sorted.\n        # R_s_pred is also sorted according to T.\n        delta_Rs = Rs_pred[-1] - Rs_pred[0]\n\n        # Step 5: Validate the prediction by computing the RMSE\n        rmse = np.sqrt(np.mean((Rs_pred - Rs_meas)**2))\n        \n        results.extend([delta_Rs, rmse])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然某些 EIS 特征的解释相对直接，但对整个频谱的建模常常会遇到模型模糊性的挑战，即多个等效电路模型可能产生视觉上非常相似的奈奎斯特图。这项实践通过比较一个包含理想电容的简单 Randles 电路与另一个使用恒相元件 (CPE) 的电路，来深入探讨这一问题。您不仅将证明它们近乎相同的阻抗特征，还将学习如何应用严谨的统计方法——贝叶斯信息准则 (BIC)，在这些竞争模型之间做出有原则的选择。",
            "id": "3908855",
            "problem": "一个自动化的电池设计与仿真流程使用两个候选等效电路模型来评估来自锂离子电池的电化学阻抗谱 (EIS) 数据。电化学阻抗谱 (EIS) 在角频率为 $\\omega$ 的小振幅正弦扰动下测量复阻抗 $Z(\\omega)$，奈奎斯特图是 $\\operatorname{Re}\\{Z(\\omega)\\}$ 相对于 $-\\operatorname{Im}\\{Z(\\omega)\\}$ 的参数图。考虑以下两种用于中频电荷转移特征的模型：\n\n- 模型 A：一个串联欧姆电阻 $R_{s}$ 与一个由电荷转移电阻 $R_{ct}$ 和双电层电容 $C_{dl}$ 构成的并联组合相串联。\n- 模型 B：一个串联欧姆电阻 $R_{s}$ 与一个由电荷转移电阻 $R_{ct}$ 和一个由 $Q$ 和 $n$ 参数化的恒相角元件 (CPE) 构成的并联组合相串联。\n\n两个模型都使用相同的电阻值实例化：$R_{s} = 0.051\\,\\Omega$ 和 $R_{ct} = 0.189\\,\\Omega$。模型 A 使用 $C_{dl} = 6.3 \\times 10^{-3}\\,\\mathrm{F}$，模型 B 使用 $n = 0.98$ 和一个选定的 $Q$ 值，使得 CPE 的有效电容在模型 A 并联支路的特征角频率处与模型 A 的理想电容局部匹配。具体而言，将特征角频率定义为 $\\omega_{0} = \\frac{1}{R_{ct} C_{dl}}$，并选择 $Q$ 以满足 $Q\\,\\omega_{0}^{n-1} = C_{dl}$。使用这些参数：\n\n1. 从串联元件的阻抗和并联支路的导纳 $Y(\\omega)$ 的定义，以及理想电容器和恒相角元件的性质出发，推导两种模型下 $\\operatorname{Re}\\{Z(\\omega)\\}$ 的高频 ($\\omega \\to \\infty$) 和低频 ($\\omega \\to 0$) 极限，并证明对于给定的 $R_{s}$ 和 $R_{ct}$，奈奎斯特弧的截距重合。\n2. 使用匹配条件 $Q\\,\\omega_{0}^{n-1} = C_{dl}$，计算两种模型的虚部 $-\\operatorname{Im}\\{Z(\\omega_{0})\\}$，并证明奈奎斯特弧顶点高度的差异在典型的仪器公差 $\\pm 5 \\times 10^{-3}\\,\\Omega$ 范围内。\n\n该流程将两种模型拟合到 $M = 150$ 个频率，在实部和虚部都产生了残差。假设残差在两个分量上是独立同分布的高斯实值误差，因此标量残差的总数为 $N = 2M$。最小二乘残差和为：\n- 对于模型 A (理想电容器): $\\mathrm{RSS}_{A} = 1.35 \\times 10^{-4}\\,\\Omega^{2}$。\n- 对于模型 B (CPE): $\\mathrm{RSS}_{B} = 1.28 \\times 10^{-4}\\,\\Omega^{2}$。\n\n模型 A 的拟合参数数量为 $k_{A} = 3$，模型 B 的拟合参数数量为 $k_{B} = 4$ (不包括任何固定的测量缩放因子)。基于高斯噪声假设和最大似然估计，推导每个模型的贝叶斯信息准则 (BIC)，并计算差值 $\\Delta \\mathrm{BIC} = \\mathrm{BIC}_{A} - \\mathrm{BIC}_{B}$。将您的最终数值答案四舍五入到四位有效数字，并以奈特 (nats) 为单位表示。",
            "solution": "该问题经验证具有科学依据、适定且客观。它提出了电化学分析中的一个标准任务：推导等效电路模型的性质并执行统计模型选择。所有必要的数据和定义都已提供。我们将按顺序解决问题的三个部分。\n\n电阻的阻抗为 $Z_R = R$。理想电容器的阻抗为 $Z_C(\\omega) = \\frac{1}{j\\omega C}$。恒相角元件 (CPE) 的阻抗为 $Z_{CPE}(\\omega) = \\frac{1}{Q(j\\omega)^n}$，其中 $j = \\sqrt{-1}$ 是虚数单位，$\\omega$ 是角频率，$Q$ 和 $n$ 是 CPE 参数。\n\n**第1部分：高频和低频极限**\n\n对于模型 A，阻抗由一个串联电阻 $R_s$ 和一个包含 $R_{ct}$ 与 $C_{dl}$ 的并联支路组成。并联支路的导纳是各个导纳之和：\n$$ Y_{p,A}(\\omega) = \\frac{1}{R_{ct}} + \\frac{1}{Z_{C_{dl}}(\\omega)} = \\frac{1}{R_{ct}} + j\\omega C_{dl} $$\n该并联支路的阻抗为 $Z_{p,A}(\\omega) = \\frac{1}{Y_{p,A}(\\omega)} = \\frac{1}{\\frac{1}{R_{ct}} + j\\omega C_{dl}} = \\frac{R_{ct}}{1 + j\\omega R_{ct} C_{dl}}$。\n模型 A 的总阻抗是串联元件之和：\n$$ Z_A(\\omega) = R_s + Z_{p,A}(\\omega) = R_s + \\frac{R_{ct}}{1 + j\\omega R_{ct} C_{dl}} $$\n为求实部，我们将复数分式进行有理化：\n$$ Z_A(\\omega) = R_s + \\frac{R_{ct}(1 - j\\omega R_{ct} C_{dl})}{1 + (\\omega R_{ct} C_{dl})^2} = \\left(R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2}\\right) - j\\left(\\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2}\\right) $$\n实部为 $\\operatorname{Re}\\{Z_A(\\omega)\\} = R_s + \\frac{R_{ct}}{1 + (\\omega R_{ct} C_{dl})^2}$。\n我们现在计算极限：\n当 $\\omega \\to \\infty$ 时，项 $(\\omega R_{ct} C_{dl})^2 \\to \\infty$，导致分式趋于 $0$。因此，高频极限为：\n$$ \\lim_{\\omega\\to\\infty} \\operatorname{Re}\\{Z_A(\\omega)\\} = R_s + 0 = R_s $$\n当 $\\omega \\to 0$ 时，项 $(\\omega R_{ct} C_{dl})^2 \\to 0$。因此，低频极限为：\n$$ \\lim_{\\omega\\to 0} \\operatorname{Re}\\{Z_A(\\omega)\\} = R_s + \\frac{R_{ct}}{1 + 0} = R_s + R_{ct} $$\n\n对于模型 B，电容器被 CPE 替代。并联支路的导纳为：\n$$ Y_{p,B}(\\omega) = \\frac{1}{R_{ct}} + \\frac{1}{Z_{CPE}(\\omega)} = \\frac{1}{R_{ct}} + Q(j\\omega)^n $$\n模型 B 的总阻抗为：\n$$ Z_B(\\omega) = R_s + \\frac{1}{\\frac{1}{R_{ct}} + Q(j\\omega)^n} = R_s + \\frac{R_{ct}}{1 + R_{ct}Q(j\\omega)^n} $$\n我们直接计算阻抗极限。\n当 $\\omega \\to \\infty$ 时，项 $(j\\omega)^n$ 的幅值趋于无穷大 (因为 $n=0.980$)。分式的分母被该项主导，导致分式的幅值趋近于 $0$。因此，在高频极限下：\n$$ \\lim_{\\omega\\to\\infty} Z_B(\\omega) = R_s + 0 = R_s $$\n因此实部为 $\\operatorname{Re}\\{Z_B(\\infty)\\} = R_s$。\n当 $\\omega \\to 0$ 时，项 $(j\\omega)^n$ 趋于 $0$。因此，在低频极限下：\n$$ \\lim_{\\omega\\to 0} Z_B(\\omega) = R_s + \\frac{R_{ct}}{1+0} = R_s + R_{ct} $$\n因此实部为 $\\operatorname{Re}\\{Z_B(0)\\} = R_s + R_{ct}$。\n对于这两种模型，奈奎斯特图的弧线在高频时与实轴相交于 $R_s$，在低频时与实轴相交于 $R_s + R_{ct}$。由于两种模型共享相同的 $R_s$ 和 $R_{ct}$ 值，这些截距是相同的。\n\n**第2部分：顶点高度比较**\n\n奈奎斯特弧的顶点通常在特征频率 $\\omega_0 = \\frac{1}{R_{ct} C_{dl}}$ 附近。我们需要计算两种模型的 $-\\operatorname{Im}\\{Z(\\omega_0)\\}$。\n\n对于模型 A，我们得到 $\\operatorname{Im}\\{Z_A(\\omega)\\} = -\\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2}$。因此：\n$$ -\\operatorname{Im}\\{Z_A(\\omega)\\} = \\frac{\\omega R_{ct}^2 C_{dl}}{1 + (\\omega R_{ct} C_{dl})^2} $$\n在 $\\omega = \\omega_0 = \\frac{1}{R_{ct} C_{dl}}$ 处，乘积 $\\omega_0 R_{ct} C_{dl} = 1$。将其代入：\n$$ -\\operatorname{Im}\\{Z_A(\\omega_0)\\} = \\frac{(\\frac{1}{R_{ct} C_{dl}}) R_{ct}^2 C_{dl}}{1 + (1)^2} = \\frac{R_{ct}}{2} $$\n这代表半圆的半径，也就是顶点的高度。\n\n对于模型 B，我们需要 $Z_B(\\omega) = R_s + \\frac{R_{ct}}{1 + R_{ct}Q(j\\omega)^n}$ 的虚部。\n让我们使用性质 $j^n = \\exp(j\\frac{n\\pi}{2}) = \\cos(\\frac{n\\pi}{2}) + j\\sin(\\frac{n\\pi}{2})$。\n$$ Z_B(\\omega) = R_s + \\frac{R_{ct}}{1 + R_{ct}Q\\omega^n \\cos(\\frac{n\\pi}{2}) + j R_{ct}Q\\omega^n \\sin(\\frac{n\\pi}{2})} $$\n分式的虚部是：\n$$ \\operatorname{Im}\\left\\{\\frac{R_{ct}( (1 + R_{ct}Q\\omega^n \\cos(\\frac{n\\pi}{2})) - j R_{ct}Q\\omega^n \\sin(\\frac{n\\pi}{2}) )}{(1 + R_{ct}Q\\omega^n \\cos(\\frac{n\\pi}{2}))^2 + (R_{ct}Q\\omega^n \\sin(\\frac{n\\pi}{2}))^2}\\right\\} = \\frac{-R_{ct}^2Q\\omega^n \\sin(\\frac{n\\pi}{2})}{\\text{分母}} $$\n所以，$-\\operatorname{Im}\\{Z_B(\\omega)\\} = \\frac{R_{ct}^2Q\\omega^n \\sin(\\frac{n\\pi}{2})}{(1 + R_{ct}Q\\omega^n \\cos(\\frac{n\\pi}{2}))^2 + (R_{ct}Q\\omega^n \\sin(\\frac{n\\pi}{2}))^2}$。\n我们在 $\\omega = \\omega_0$ 处计算该值。问题提供了匹配条件 $Q \\omega_0^{n-1} = C_{dl}$。我们可以用它来简化项 $R_{ct}Q\\omega_0^n$：\n$$ R_{ct}Q\\omega_0^n = R_{ct}Q\\omega_0^{n-1}\\omega_0 = R_{ct}(C_{dl})\\omega_0 = R_{ct}C_{dl}\\left(\\frac{1}{R_{ct}C_{dl}}\\right) = 1 $$\n将此结果代入 $-\\operatorname{Im}\\{Z_B(\\omega_0)\\}$ 的表达式中：\n$$ -\\operatorname{Im}\\{Z_B(\\omega_0)\\} = \\frac{R_{ct} \\cdot (1) \\cdot \\sin(\\frac{n\\pi}{2})}{(1 + (1) \\cos(\\frac{n\\pi}{2}))^2 + (\\sin(\\frac{n\\pi}{2}))^2} $$\n分母使用 $\\cos^2(x) + \\sin^2(x) = 1$ 进行简化：\n$$ \\text{分母} = 1 + 2\\cos(\\frac{n\\pi}{2}) + \\cos^2(\\frac{n\\pi}{2}) + \\sin^2(\\frac{n\\pi}{2}) = 2 + 2\\cos(\\frac{n\\pi}{2}) = 2(1 + \\cos(\\frac{n\\pi}{2})) $$\n使用半角恒等式 $1+\\cos(x)=2\\cos^2(x/2)$，分母变为 $4\\cos^2(\\frac{n\\pi}{4})$。\n使用二倍角恒等式 $\\sin(x)=2\\sin(x/2)\\cos(x/2)$，分子项为 $\\sin(\\frac{n\\pi}{2}) = 2\\sin(\\frac{n\\pi}{4})\\cos(\\frac{n\\pi}{4})$。\n$$ -\\operatorname{Im}\\{Z_B(\\omega_0)\\} = \\frac{R_{ct} \\cdot 2\\sin(\\frac{n\\pi}{4})\\cos(\\frac{n\\pi}{4})}{4\\cos^2(\\frac{n\\pi}{4})} = \\frac{R_{ct}}{2} \\frac{\\sin(\\frac{n\\pi}{4})}{\\cos(\\frac{n\\pi}{4})} = \\frac{R_{ct}}{2} \\tan(\\frac{n\\pi}{4}) $$\n现在我们计算数值。给定 $R_{ct} = 0.189\\,\\Omega$ 和 $n = 0.98$：\n$$ -\\operatorname{Im}\\{Z_A(\\omega_0)\\} = \\frac{0.189}{2} = 0.0945\\,\\Omega $$\n$$ -\\operatorname{Im}\\{Z_B(\\omega_0)\\} = \\frac{0.189}{2} \\tan\\left(\\frac{0.98\\pi}{4}\\right) \\approx 0.0945 \\times \\tan(0.76969) \\approx 0.0945 \\times 0.96767 \\approx 0.09144\\,\\Omega $$\n顶点高度的差异是：\n$$ \\Delta_h = |-\\operatorname{Im}\\{Z_A(\\omega_0)\\} - (-\\operatorname{Im}\\{Z_B(\\omega_0)\\})| \\approx |0.0945 - 0.09144| = 0.00306\\,\\Omega $$\n这个差异 $3.06 \\times 10^{-3}\\,\\Omega$ 在指定的仪器公差 $\\pm 5 \\times 10^{-3}\\,\\Omega$ 范围内。\n\n**第3部分：贝叶斯信息准则 (BIC)**\n\n贝叶斯信息准则 (BIC) 定义为 $\\mathrm{BIC} = -2\\ln(\\hat{L}) + k \\ln(N)$，其中 $\\hat{L}$ 是似然函数的最大值，$k$ 是估计参数的数量，$N$ 是数据点的数量。对于具有独立同分布高斯误差的模型，最大化对数似然由下式给出：\n$$ \\ln(\\hat{L}) = -\\frac{N}{2} \\ln(2\\pi) - \\frac{N}{2} \\ln(\\hat{\\sigma}^2) - \\frac{N}{2} $$\n其中误差方差的最大似然估计为 $\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}}{N}$，$\\mathrm{RSS}$ 是残差平方和。代入 $\\hat{\\sigma}^2$ 可得：\n$$ \\ln(\\hat{L}) = -\\frac{N}{2} \\left[ \\ln(2\\pi) + \\ln\\left(\\frac{\\mathrm{RSS}}{N}\\right) + 1 \\right] $$\n因此，BIC 为：\n$$ \\mathrm{BIC} = N\\left[\\ln(2\\pi) + \\ln\\left(\\frac{\\mathrm{RSS}}{N}\\right) + 1\\right] + k \\ln(N) $$\n我们被要求计算差值 $\\Delta \\mathrm{BIC} = \\mathrm{BIC}_{A} - \\mathrm{BIC}_{B}$。当对拟合到相同数据 (相同的 $N$) 的两个模型取差值时，不依赖于模型特定量 ($k$, $\\mathrm{RSS}$) 的项会消去。\n$$ \\mathrm{BIC}_{A} = N\\left[\\ln\\left(\\frac{\\mathrm{RSS}_{A}}{N}\\right)\\right] + k_{A} \\ln(N) + C $$\n$$ \\mathrm{BIC}_{B} = N\\left[\\ln\\left(\\frac{\\mathrm{RSS}_{B}}{N}\\right)\\right] + k_{B} \\ln(N) + C $$\n其中 $C = N(\\ln(2\\pi) + 1)$ 对两个模型来说是一个常数。\n$$ \\Delta \\mathrm{BIC} = \\mathrm{BIC}_{A} - \\mathrm{BIC}_{B} = N\\left[\\ln\\left(\\frac{\\mathrm{RSS}_{A}}{N}\\right) - \\ln\\left(\\frac{\\mathrm{RSS}_{B}}{N}\\right)\\right] + (k_{A} - k_{B})\\ln(N) $$\n$$ \\Delta \\mathrm{BIC} = N \\ln\\left(\\frac{\\mathrm{RSS}_{A}}{\\mathrm{RSS}_{B}}\\right) + (k_{A} - k_{B})\\ln(N) $$\n现在我们代入给定值：\n$N=300$, $k_A=3$, $k_B=4$, $\\mathrm{RSS}_A = 1.35 \\times 10^{-4}\\,\\Omega^2$, $\\mathrm{RSS}_B = 1.28 \\times 10^{-4}\\,\\Omega^2$。\n$$ \\Delta \\mathrm{BIC} = 300 \\ln\\left(\\frac{1.35 \\times 10^{-4}}{1.28 \\times 10^{-4}}\\right) + (3 - 4)\\ln(300) $$\n$$ \\Delta \\mathrm{BIC} = 300 \\ln\\left(\\frac{1.35}{1.28}\\right) - \\ln(300) $$\n我们计算数值：\n$$ \\ln(300) \\approx 5.70378 $$\n$$ \\frac{1.35}{1.28} \\approx 1.0546875 $$\n$$ \\ln\\left(\\frac{1.35}{1.28}\\right) \\approx \\ln(1.0546875) \\approx 0.053236 $$\n$$ \\Delta \\mathrm{BIC} \\approx 300 \\times 0.053236 - 5.70378 $$\n$$ \\Delta \\mathrm{BIC} \\approx 15.9708 - 5.70378 = 10.26702 $$\n四舍五入到四位有效数字，我们得到 $10.27$。单位是奈特 (nats)，因为使用了自然对数。正的 $\\Delta \\mathrm{BIC}$ 值表明模型 B 优于模型 A，因为它具有更低的 BIC 值。",
            "answer": "$$\n\\boxed{10.27}\n$$"
        }
    ]
}