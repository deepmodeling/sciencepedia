{
    "hands_on_practices": [
        {
            "introduction": "恒电流间歇滴定技术（GITT）是表征电池材料动力学特性的基石方法之一。本实践将引导你建立基础扩散理论（菲克定律）与真实电化学测量数据之间的桥梁。通过推导和应用一个简化模型，你将学会如何从电压弛豫曲线中提取关键的动力学参数——固相扩散系数（$D_s$），该参数直接影响电池的功率性能。",
            "id": "3937359",
            "problem": "给定恒电流间歇滴定技术（GITT）的弛豫数据，该数据来自一个由单分散球形活性材料颗粒组成的锂嵌入电极，您的目标是利用第一性原理建模和参数化逻辑来确定固相扩散系数。弛豫阶段在恒流脉冲关闭后立即开始。对于足够短的弛豫时间，假设颗粒表面附近的扩散可以近似为半无限和一维的，并且开路电压的变化局部正比于颗粒表面浓度的变化。从以下基本原理出发：\n\n- 关于固相中锂浓度 $c_s(r,t)$ 的菲克第二定律，\n- 将摩尔通量密度 $J$ 与颗粒表面浓度梯度联系起来的菲克第一定律，\n- 使用已知斜率 $dU/dc_s$ 对平衡电势相对于表面浓度进行线性化，\n\n推导出一个表达式，将电压弛豫对 $\\sqrt{t}$ 的斜率与固相扩散系数 $D_s$ 及施加的电流历史联系起来。推导必须从固相中的扩散方程、恒流脉冲和随后的零通量弛豫所隐含的边界和初始条件，以及电压与表面浓度之间的局部线性关系开始。在极早期的弛豫时间内，您可以将球形几何结构视为局部平面，并以此为基础证明使用半无限近似的合理性。\n\n定义和给定数量：\n\n- 设颗粒为半径为 $R_p$ 的球体，总数为 $N_p$，每个球体的表面积为 $A_p = 4\\pi R_p^2$，总颗粒表面积为 $A_{\\text{tot}} = N_p \\cdot 4\\pi R_p^2$。\n- 设脉冲期间施加的恒定电流大小为 $I_{\\text{tot}}$（安培），每个嵌入锂离子的电子数为 $n$，法拉第常数为 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$。\n- 脉冲期间颗粒表面的摩尔通量密度为 $J = I_{\\text{tot}}/(n F A_{\\text{tot}})$，单位为 $\\text{mol}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$。\n- 电流中断后，在短时弛豫区间，测量的电压 $U(t)$ 表现出对 $\\sqrt{t}$ 的线性依赖关系，斜率为 $S = dU/d(\\sqrt{t})$，单位为 $\\text{V}\\,\\text{s}^{-1/2}$。\n- 平衡电势灵敏度已知为 $dU/dc_s$，单位为 $\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$，电压的微小变化与颗粒表面浓度的微小变化之间的关系为 $\\Delta U(t) \\approx (dU/dc_s)\\,\\Delta c_s(R_p,t)$。\n\n假设：\n\n- 使用电流中断后的早期弛豫时间，使得半无限扩散近似有效；即，$t \\ll R_p^2/D_s$。\n- 空间变化是径向的；在表面附近和早期时间内，曲率可以忽略不计，并可以近似为半无限笛卡尔域。\n- 电压响应主要由颗粒表面浓度的变化决定，双电层电容和接触电阻等非理想因素在所选时间窗口内可忽略不计。\n\n任务：\n\n1. 基于以上定义和假设，推导一个连接测量斜率 $S$ 与 $D_s$、$J$ 和 $dU/dc_s$ 的关系式。推导必须从菲克第二定律和边界条件开始，然后通过线性化的平衡电势将浓度弛豫与电压弛豫联系起来。\n2. 使用推导出的关系式，计算下述每个测试用例的 $D_s$。将每个 $D_s$ 以 $\\text{m}^2/\\text{s}$ 为单位表示。\n3. 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个数字采用科学记数法，保留六位有效数字（例如，$[1.234567\\text{e-}08,9.876543\\text{e-}12]$）。\n\n在所有情况下均使用 $n = 1$。测试套件包含四个不同的用例，以探究典型、较高扩散率和较低扩散率的情况，以及对几何形状和电流的敏感性：\n\n- 用例1（一般情况）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 1.5\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 用例2（较小斜率意味着较大 $D_s$）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 5.0\\times 10^{-4}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 用例3（较大斜率意味着较小 $D_s$）：\n  - $R_p = 5.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 3.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 1.0\\,\\text{A}$\n  - $dU/dc_s = 4.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 4.0\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n- 用例4（不同几何形状和电流；测试敏感性）：\n  - $R_p = 2.0\\times 10^{-6}\\,\\text{m}$\n  - $N_p = 2.0\\times 10^{8}$\n  - $I_{\\text{tot}} = 0.5\\,\\text{A}$\n  - $dU/dc_s = 6.0\\times 10^{-5}\\,\\text{V}\\,\\text{m}^3\\,\\text{mol}^{-1}$\n  - $S = 1.0\\times 10^{-3}\\,\\text{V}\\,\\text{s}^{-1/2}$\n\n您的程序必须为每个用例计算 $A_{\\text{tot}}$、摩尔通量密度 $J$，然后是 $D_s$，并以指定的单行输出格式打印四个 $D_s$ 值。",
            "solution": "该问题要求根据恒电流间歇滴定技术（GITT）的弛豫数据推导固相扩散系数 $D_s$ 的表达式，并随后为一组测试用例计算其值。推导将从扩散和电化学的基本原理开始，并遵循指定的假设。\n\n**第1部分：$D_s$ 关系的推导**\n\n推导过程主要分三个阶段：（1）求解GITT条件下浓度分布的扩散方程，（2）将浓度变化与电压变化相关联，以及（3）提取实验测量的斜率 $S$ 与扩散系数 $D_s$ 之间的关系。\n\n**1. 从扩散方程得到浓度分布**\n\n我们从菲克第二扩散定律开始。问题指出，对于短弛豫时间，球形颗粒表面附近的扩散可以近似为半无限和一维的。设 $x$ 为从颗粒表面（$x=0$）指向颗粒内部（$x>0$）的空间坐标，$c_s(x,t)$ 为固相中锂的浓度。控制性偏微分方程为：\n$$\n\\frac{\\partial c_s(x,t)}{\\partial t} = D_s \\frac{\\partial^2 c_s(x,t)}{\\partial x^2}\n$$\n其中 $D_s$ 是固相扩散系数，假定为常数。\n\nGITT实验包括施加一个持续时间为 $\\tau$ 的恒定电流脉冲，然后是一个电流为零的弛豫期。对于线性扩散方程，此过程可以使用叠加原理进行建模。电流脉冲对应于颗粒表面的恒定摩尔通量密度 $J$。关闭电流等效于在脉冲结束的瞬间叠加一个 $-J$ 的通量。\n\n设实验从时间 $t_p=0$ 开始。在 $0 \\le t_p \\le \\tau$ 期间，在边界 $x=0$ 处施加恒定通量 $J$。边界条件由菲克第一定律给出：\n$$\n-D_s \\frac{\\partial c_s}{\\partial x}\\bigg|_{x=0} = J\n$$\n在半无限介质中，对于初始浓度均匀为 $c_0$ 且边界条件为恒定通量的情况，扩散方程的解是众所周知。表面（$x=0$）浓度随时间 $t_p$ 的变化为：\n$$\n\\Delta c_s(0, t_p) = c_s(0, t_p) - c_0 = \\frac{2J\\sqrt{t_p}}{\\sqrt{\\pi D_s}}\n$$\n在时间 $t_p = \\tau$ 时，电流被关闭。我们可以通过在所有时间 $t_p > \\tau$ 添加一个通量 $-J$ 来对此进行建模。对于 $t_p > \\tau$，总的表面浓度变化是响应从 $t_p=0$ 开始的通量 $+J$ 与响应从 $t_p=\\tau$ 开始的通量 $-J$ 的总和。\n$$\n\\Delta c_{s, \\text{total}}(0, t_p) = \\frac{2J\\sqrt{t_p}}{\\sqrt{\\pi D_s}} - \\frac{2J\\sqrt{t_p - \\tau}}{\\sqrt{\\pi D_s}} = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{t_p} - \\sqrt{t_p - \\tau} \\right)\n$$\n这个方程描述了弛豫阶段表面浓度相对于初始浓度 $c_0$ 的演变。\n\n我们将弛豫时间定义为 $t = t_p - \\tau$。弛豫从 $t=0$ 开始。将 $t_p = t + \\tau$ 代入上式，得到总浓度变化作为弛豫时间 $t$ 的函数：\n$$\n\\Delta c_{s, \\text{total}}(0, \\tau+t) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{\\tau+t} - \\sqrt{t} \\right)\n$$\n我们关心的是弛豫期间的浓度变化，即相对于脉冲结束时（$t_p=\\tau$，或 $t=0$）的浓度变化。脉冲结束时的浓度变化为 $\\Delta c_s(0, \\tau) = \\frac{2J\\sqrt{\\tau}}{\\sqrt{\\pi D_s}}$。因此，弛豫期间的浓度变化为：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) = \\Delta c_{s, \\text{total}}(0, \\tau+t) - \\Delta c_s(0, \\tau) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\sqrt{\\tau+t} - \\sqrt{t} - \\sqrt{\\tau} \\right)\n$$\n问题指明分析是针对“足够短的弛豫时间”。这意味着弛豫时间 $t$ 远小于脉冲持续时间 $\\tau$（即 $t \\ll \\tau$）。在此条件下，我们可以对 $\\sqrt{\\tau+t}$ 项使用泰勒展开：\n$$\n\\sqrt{\\tau+t} = \\sqrt{\\tau(1+t/\\tau)} \\approx \\sqrt{\\tau}\\left(1 + \\frac{1}{2}\\frac{t}{\\tau}\\right)\n$$\n将此近似代入 $\\Delta c_{s, \\text{relax}}(0, t)$ 的表达式中：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) \\approx \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\left(\\sqrt{\\tau} + \\frac{t}{2\\sqrt{\\tau}}\\right) - \\sqrt{t} - \\sqrt{\\tau} \\right) = \\frac{2J}{\\sqrt{\\pi D_s}} \\left( \\frac{t}{2\\sqrt{\\tau}} - \\sqrt{t} \\right)\n$$\n对于非常短的时间（$t \\to 0$），$\\sqrt{t}$ 项相比于 $t$ 项占主导地位。因此，表达式简化为：\n$$\n\\Delta c_{s, \\text{relax}}(0, t) \\approx -\\frac{2J}{\\sqrt{\\pi D_s}}\\sqrt{t}\n$$\n这个方程表明，在短弛豫时间内，表面浓度的变化与弛豫时间的平方根成线性比例。\n\n**2. 电压响应**\n\n问题指出，开路电压的变化 $\\Delta U(t)$ 与表面浓度的变化 $\\Delta c_s(R_p, t)$ 通过已知的灵敏度 $dU/dc_s$ 成局部正比关系：\n$$\n\\Delta U(t) \\approx \\left(\\frac{dU}{dc_s}\\right) \\Delta c_s(R_p, t)\n$$\n将此应用于弛豫期间的变化 $\\Delta U_{\\text{relax}}(t)$：\n$$\n\\Delta U_{\\text{relax}}(t) \\approx \\left(\\frac{dU}{dc_s}\\right) \\Delta c_{s, \\text{relax}}(0, t) \\approx -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\\sqrt{t}\n$$\n这个推导出的关系证实了问题中陈述的实验观察：弛豫期间的电压 $U(t)$ 对 $\\sqrt{t}$ 表现出线性依赖性。\n\n**3. 斜率 $S$ 与 $D_s$ 之间的关系**\n\n斜率 $S$ 定义为 $S = dU/d(\\sqrt{t})$。从我们推导的弛豫期间电压变化的表达式，我们可以计算这个斜率：\n$$\nS = \\frac{d(\\Delta U_{\\text{relax}}(t))}{d(\\sqrt{t})} = -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\n$$\n问题给出的 $S$ 和 $dU/dc_s$ 均为正值。由于在弛豫过程中表面浓度降低，电压（随 $c_s$ 增加而增加）也随之降低，使得真实斜率为负。因此，给定的 $S$ 必须解释为斜率的绝对值：\n$$\nS = \\left| -\\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}} \\right| = \\left(\\frac{dU}{dc_s}\\right) \\frac{2J}{\\sqrt{\\pi D_s}}\n$$\n我们的目标是找到 $D_s$ 的表达式。重新整理方程：\n$$\n\\sqrt{\\pi D_s} = \\frac{2J}{S} \\left(\\frac{dU}{dc_s}\\right)\n$$\n两边平方得到：\n$$\n\\pi D_s = \\left( \\frac{2J}{S} \\left(\\frac{dU}{dc_s}\\right) \\right)^2 = \\frac{4J^2}{S^2} \\left(\\frac{dU}{dc_s}\\right)^2\n$$\n最后，分离出 $D_s$，我们得到所求的关系式：\n$$\nD_s = \\frac{4}{\\pi} \\left( \\frac{J}{S} \\frac{dU}{dc_s} \\right)^2\n$$\n此表达式将固相扩散系数 $D_s$ 与测量的斜率 $S$、施加的通量密度 $J$ 和热力学因子 $dU/dc_s$ 联系起来。通量 $J$ 由总施加电流 $I_{\\text{tot}}$ 和总活性表面积 $A_{\\text{tot}}$ 计算得出：\n$$\nJ = \\frac{I_{\\text{tot}}}{nF A_{\\text{tot}}}, \\quad \\text{其中} \\quad A_{\\text{tot}} = N_p \\cdot 4\\pi R_p^2\n$$\n\n**第2部分：计算测试用例的 $D_s$**\n\n使用推导出的公式，我们现在将为提供的四个测试用例计算 $D_s$。在所有计算中，使用 $n=1$ 和 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$。每个用例的计算首先涉及计算 $A_{\\text{tot}}$ 和 $J$，然后将这些值代入 $D_s$ 的表达式中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the solid-phase diffusion coefficient (D_s) for a series of\n    GITT experiment test cases based on a derived first-principles model.\n    \"\"\"\n    \n    # Define physical constants\n    F = 96485  # Faraday constant in C/mol\n    n = 1      # Number of electrons transferred per Li ion\n\n    # Test cases from the problem statement\n    # Each tuple contains: (R_p, N_p, I_tot, dU_dcs, S)\n    test_cases = [\n        # Case 1 (general case)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 1.5e-3),\n        # Case 2 (smaller slope implies larger D_s)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 5.0e-4),\n        # Case 3 (larger slope implies smaller D_s)\n        (5.0e-6, 3.0e8, 1.0, 4.0e-5, 4.0e-3),\n        # Case 4 (different geometry and current)\n        (2.0e-6, 2.0e8, 0.5, 6.0e-5, 1.0e-3),\n    ]\n\n    results = []\n    for case in test_cases:\n        Rp, Np, Itot, dU_dcs, S = case\n\n        # Step 1: Calculate the total particle surface area (A_tot)\n        # A_p = 4 * pi * R_p^2 for a single spherical particle\n        # A_tot = N_p * A_p\n        A_tot = Np * 4.0 * np.pi * (Rp**2)\n\n        # Step 2: Calculate the molar flux density (J) at the particle surface\n        # J = I_tot / (n * F * A_tot)\n        J = Itot / (n * F * A_tot)\n\n        # Step 3: Calculate the solid-phase diffusion coefficient (D_s)\n        # The derived formula is D_s = (4/pi) * (J * dU/dc_s / S)^2\n        term_in_paren = (J * dU_dcs) / S\n        D_s = (4.0 / np.pi) * (term_in_paren**2)\n        \n        results.append(D_s)\n\n    # Format the results into a single string as specified:\n    # Comma-separated list in scientific notation with six significant digits.\n    # The format specifier {:.5e} provides 1 digit before the decimal and 5 after,\n    # totaling 6 significant digits.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在第一个实践的基础上，我们将从纯粹的物理推导转向包含统计思想的参数化任务。许多基于物理的模型包含了半经验关系式，例如将有效电导率与电极孔隙度相关联的布鲁格曼关系。本练习将教授如何对线性化后的数据进行加权最小二乘回归，以估计模型中的结构指数（$\\beta$），并更关键地，量化该估计值的不确定性。",
            "id": "3937395",
            "problem": "你的任务是为一个多孔介质中电解质有效电导率的基于物理的标度关系进行参数化，并确定一个关键的结构参数。考虑一个被具有本征电导率的液体电解质饱和的多孔电极。在多孔介质均质化和欧姆定律的假设下，有效体相离子电导可以通过一个无量纲的孔隙度指数来建模。具体来说，假设在多孔介质中存在以下被广泛使用并得到实验支持的标度律：有效电解质电导率 $\\kappa_{\\mathrm{eff}}$ 作为孔隙度 $\\varepsilon$ 的函数，遵循幂律关系 $\\kappa_{\\mathrm{eff}}(\\varepsilon) = \\kappa_{0}\\,\\varepsilon^{\\beta}$，其中 $\\kappa_{0} > 0$ 是一个恒定的参考电导率（对于在非曲折几何结构中的相同电解质而言），$\\beta$ 是一个无量纲的孔隙度-曲折度指数，它包含了形貌和传输阻碍的信息。\n\n在不同孔隙度 $\\varepsilon_{i}$ 下对 $\\kappa_{\\mathrm{eff}}$ 进行测量，你应该将这些测量值视为对数空间中一个随机测量模型的实现。定义 $x_{i} = \\ln(\\varepsilon_{i})$ 和 $y_{i}^{\\mathrm{obs}} = \\ln(\\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$，并假设在对数空间中存在加性高斯噪声 $y_{i}^{\\mathrm{obs}} = \\alpha + \\beta x_{i} + e_{i}$，其中 $\\alpha = \\ln(\\kappa_{0})$，$e_{i} \\sim \\mathcal{N}(0,\\sigma_{i}^{2})$ 是相互独立的，并且所有 $\\sigma_{i} > 0$ 都是已知的。在这些假设下，估计 $\\beta$ 及其不确定度简化为对变换后变量的加权线性回归。\n\n从通过多孔介质中的欧姆定律得到的有效电导率的基本物理定义出发，并将对数测量模型视为电导率测量中乘性误差的结果，构建一个参数估计算法，该算法应：\n- 使用列为 $[1, x_{i}]$ 的设计矩阵和对角权重矩阵 $W = \\mathrm{diag}(w_{i})$（其中 $w_{i} = 1/\\sigma_{i}^{2}$），建立 $(\\alpha,\\beta)$ 的加权最小二乘估计量。\n- 在对数空间中的高斯噪声模型下，计算 $\\beta$ 的最大似然估计。\n- 使用费雪信息的逆来计算 $\\beta$ 的标准不确定度（一个标准差），在所述假设下，该逆矩阵等于参数协方差矩阵 $(X^{\\mathsf{T}} W X)^{-1}$。需要报告的不确定度是 $\\sqrt{\\left[(X^{\\mathsf{T}} W X)^{-1}\\right]_{22}}$，即对应于 $\\beta$ 的协方差矩阵的 $(2,2)$ 元素的平方根。\n\n所有 $\\kappa_{\\mathrm{eff}}$ 测量的单位均为西门子/米，缩写为 S/m。孔隙度是无量纲的，且严格介于 $0$ 和 $1$ 之间。在整个计算过程中使用自然对数（以 $e$ 为底）。\n\n你的程序必须实现以上要求，并处理以下包含三个测试用例的测试套件，每个用例包含三个测量值：\n- 测试用例 1 (一般情况，孔隙度分布良好且不确定度适中)：\n  - 孔隙度 $\\varepsilon$: $[0.30,\\,0.60,\\,0.75]$\n  - 测量的有效电导率 $\\kappa_{\\mathrm{eff}}$ (S/m): $[0.42,\\,1.15,\\,1.60]$\n  - 对数空间标准差 $\\sigma$: $[0.05,\\,0.05,\\,0.05]$\n- 测试用例 2 (边界情况，孔隙度密集聚集导致较大的几何参数不确定性)：\n  - 孔隙度 $\\varepsilon$: $[0.58,\\,0.60,\\,0.62]$\n  - 测量的有效电导率 $\\kappa_{\\mathrm{eff}}$ (S/m): $[1.10,\\,1.16,\\,1.22]$\n  - 对数空间标准差 $\\sigma$: $[0.02,\\,0.02,\\,0.02]$\n- 测试用例 3 (极端情况，孔隙度分布广泛且具有异方差不确定性)：\n  - 孔隙度 $\\varepsilon$: $[0.20,\\,0.50,\\,0.90]$\n  - 测量的有效电导率 $\\kappa_{\\mathrm{eff}}$ (S/m): $[0.27,\\,1.05,\\,2.60]$\n  - 对数空间标准差 $\\sigma$: $[0.10,\\,0.05,\\,0.20]$\n\n对于每个测试用例，估计 $\\beta$ 及其标准不确定度。最终输出必须是无量纲的浮点数。你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应测试用例的一个双元素列表 $[\\hat{\\beta},\\,u_{\\beta}]$，每个浮点数四舍五入到六位小数，例如：$[[\\hat{\\beta}_{1},u_{\\beta,1}],\\,[\\hat{\\beta}_{2},u_{\\beta,2}],\\,[\\hat{\\beta}_{3},u_{\\beta,3}]]$.",
            "solution": "从实验数据中估计孔隙度-曲折度指数 $\\beta$ 的问题是材料科学和电化学中一个经典的参数识别任务。该问题是适定的，并有充分的科学依据。我将继续提供完整的解决方案。\n\n所提供的物理模型是多孔介质中有效电导率 $\\kappa_{\\mathrm{eff}}$ 的幂律关系：\n$$\n\\kappa_{\\mathrm{eff}}(\\varepsilon) = \\kappa_{0} \\, \\varepsilon^{\\beta}\n$$\n其中 $\\varepsilon$ 是孔隙度，$\\kappa_{0}$ 是参考电导率，而 $\\beta$ 是待确定的无量纲指数。该模型是 Bruggeman 关联式或 Archie 定律的一种形式，广泛用于描述复合介质中的传输特性。\n\n为了便于从实验数据 $(\\varepsilon_i, \\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$ 进行参数估计，我们通过对等式两边取自然对数来线性化模型：\n$$\n\\ln(\\kappa_{\\mathrm{eff}}) = \\ln(\\kappa_{0}) + \\beta \\ln(\\varepsilon)\n$$\n这将幂律关系转换为线性关系。我们定义变换后的变量 $y = \\ln(\\kappa_{\\mathrm{eff}})$、$x = \\ln(\\varepsilon)$ 和常数 $\\alpha = \\ln(\\kappa_{0})$。模型变为：\n$$\ny = \\alpha + \\beta x\n$$\n问题指定了一个随机测量模型，其中观测值 $y_{i}^{\\mathrm{obs}} = \\ln(\\kappa_{\\mathrm{eff},i}^{\\mathrm{obs}})$ 包含加性高斯噪声 $e_i$，其方差 $\\sigma_i^2$ 已知且相互独立：\n$$\ny_{i}^{\\mathrm{obs}} = \\alpha + \\beta x_{i} + e_{i}, \\quad \\text{其中 } e_{i} \\sim \\mathcal{N}(0, \\sigma_{i}^{2})\n$$\n我们的目标是找到参数 $\\alpha$ 和 $\\beta$ 的最佳估计值，特别是 $\\hat{\\beta}$，并量化该估计的不确定度 $u_{\\beta}$。\n\n在独立高斯误差的假设下，参数 $(\\alpha, \\beta)$ 的最大似然估计 (MLE) 是使加权残差平方和（通常表示为 $\\chi^2$）最小化的估计：\n$$\n\\chi^2(\\alpha, \\beta) = \\sum_{i=1}^{n} \\left( \\frac{y_{i}^{\\mathrm{obs}} - (\\alpha + \\beta x_i)}{\\sigma_i} \\right)^2 = \\sum_{i=1}^{n} w_i (y_{i}^{\\mathrm{obs}} - (\\alpha + \\beta x_i))^2\n$$\n其中 $n$ 是测量次数，$w_i = 1/\\sigma_i^2$ 是权重。这就是加权最小二乘法 (WLS) 的原理。\n\n为了有效地解决这个最小化问题，我们采用矩阵形式。设参数向量为 $\\boldsymbol{\\theta}$，观测向量为 $\\mathbf{y}$，设计矩阵为 $X$：\n$$\n\\boldsymbol{\\theta} = \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} y_1^{\\mathrm{obs}} \\\\ y_2^{\\mathrm{obs}} \\\\ \\vdots \\\\ y_n^{\\mathrm{obs}} \\end{pmatrix}, \\quad X = \\begin{pmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_n \\end{pmatrix}\n$$\n设 $W$ 为对角权重矩阵：\n$$\nW = \\mathrm{diag}(w_1, w_2, \\dots, w_n) = \\begin{pmatrix} 1/\\sigma_1^2 & 0 & \\dots & 0 \\\\ 0 & 1/\\sigma_2^2 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\dots & 1/\\sigma_n^2 \\end{pmatrix}\n$$\n$\\chi^2$ 目标函数可以写成矩阵形式：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = (\\mathbf{y} - X\\boldsymbol{\\theta})^{\\mathsf{T}} W (\\mathbf{y} - X\\boldsymbol{\\theta})\n$$\n通过将关于 $\\boldsymbol{\\theta}$ 的梯度设为零，可以找到最小化此表达式的解，这会得到 WLS 的正规方程：\n$$\n(X^{\\mathsf{T}} W X) \\hat{\\boldsymbol{\\theta}} = X^{\\mathsf{T}} W \\mathbf{y}\n$$\n因此，参数向量 $\\hat{\\boldsymbol{\\theta}}$ 的 WLS 估计为：\n$$\n\\hat{\\boldsymbol{\\theta}} = (X^{\\mathsf{T}} W X)^{-1} X^{\\mathsf{T}} W \\mathbf{y}\n$$\n孔隙度指数的估计值 $\\hat{\\beta}$ 是向量 $\\hat{\\boldsymbol{\\theta}}$ 的第二个元素。\n\n统计理论的一个关键结果是，估计参数的协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 由费雪信息矩阵的逆给出。对于这个带有高斯噪声的线性模型，它就是：\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) = (X^{\\mathsf{T}} W X)^{-1}\n$$\n矩阵 $X^{\\mathsf{T}} W X$ 是一个 $2 \\times 2$ 矩阵：\n$$\nX^{\\mathsf{T}} W X = \\begin{pmatrix} \\sum_{i=1}^{n} w_i & \\sum_{i=1}^{n} w_i x_i \\\\ \\sum_{i=1}^{n} w_i x_i & \\sum_{i=1}^{n} w_i x_i^2 \\end{pmatrix}\n$$\n$\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 的对角元素是各个参数估计值的方差。我们关心的是 $\\hat{\\beta}$ 的方差，即第二个对角元素，记为 $(\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}))_{22}$。标准不确定度 $u_{\\beta}$ 是该方差的平方根：\n$$\nu_{\\beta} = \\sqrt{ \\left[ (X^{\\mathsf{T}} W X)^{-1} \\right]_{22} }\n$$\n该算法将实现这些矩阵方程。对于每个测试用例，我们将：\n1.  对给定的孔隙度 $\\varepsilon_i$ 和电导率 $\\kappa_{\\mathrm{eff},i}$ 数据取自然对数，以获得 $x_i$ 和 $y_i^{\\mathrm{obs}}$。\n2.  根据 $\\sigma_i$ 值构建设计矩阵 $X$、观测向量 $\\mathbf{y}$ 和权重矩阵 $W$。\n3.  计算矩阵乘积 $C = X^{\\mathsf{T}} W X$。\n4.  对该矩阵求逆，得到协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) = C^{-1}$。\n5.  计算参数向量估计值 $\\hat{\\boldsymbol{\\theta}} = C^{-1} X^{\\mathsf{T}} W \\mathbf{y}$。\n6.  估计值 $\\hat{\\beta}$ 是 $\\hat{\\boldsymbol{\\theta}}$ 的第二个元素。\n7.  标准不确定度 $u_{\\beta}$ 是 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 对角线上第二个元素的平方根。\n\n此过程将应用于所提供的三个测试用例中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the porosity-tortuosity exponent and its uncertainty for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"epsilons\": np.array([0.30, 0.60, 0.75]),\n            \"kappas_eff\": np.array([0.42, 1.15, 1.60]),\n            \"sigmas\": np.array([0.05, 0.05, 0.05]),\n        },\n        # Test case 2\n        {\n            \"epsilons\": np.array([0.58, 0.60, 0.62]),\n            \"kappas_eff\": np.array([1.10, 1.16, 1.22]),\n            \"sigmas\": np.array([0.02, 0.02, 0.02]),\n        },\n        # Test case 3\n        {\n            \"epsilons\": np.array([0.20, 0.50, 0.90]),\n            \"kappas_eff\": np.array([0.27, 1.05, 2.60]),\n            \"sigmas\": np.array([0.10, 0.05, 0.20]),\n        },\n    ]\n\n    def estimate_beta_and_uncertainty(epsilons, kappas_eff, sigmas):\n        \"\"\"\n        Performs weighted linear regression to estimate beta and its uncertainty.\n        \n        Args:\n            epsilons (np.ndarray): Array of porosity values.\n            kappas_eff (np.ndarray): Array of measured effective conductivities.\n            sigmas (np.ndarray): Array of standard deviations in log-space.\n            \n        Returns:\n            tuple: A tuple containing the estimated beta (float) and its standard\n                   uncertainty (float).\n        \"\"\"\n        # Step 1: Transform variables to linear space (y = alpha + beta*x)\n        x = np.log(epsilons)\n        y_obs = np.log(kappas_eff)\n        \n        # Step 2: Set up the components for Weighted Least Squares (WLS)\n        # Design matrix X\n        X = np.vstack((np.ones_like(x), x)).T\n        \n        # Weights w_i = 1/sigma_i^2\n        weights = 1.0 / (sigmas**2)\n        \n        # Weight matrix W (diagonal matrix of weights)\n        W = np.diag(weights)\n        \n        # Step 3: Compute the WLS solution for the parameters [alpha, beta]\n        # Calculate the matrix (X^T * W * X)\n        XT_W_X = X.T @ W @ X\n        \n        # Calculate its inverse, which is the covariance matrix of parameters\n        try:\n            cov_matrix = np.linalg.inv(XT_W_X)\n        except np.linalg.LinAlgError:\n            # This case occurs if the matrix is singular (e.g., all x values are the same)\n            return (np.nan, np.nan)\n            \n        # Calculate the vector (X^T * W * y)\n        XT_W_y = X.T @ W @ y_obs\n        \n        # The parameter vector estimate theta_hat = [alpha_hat, beta_hat]\n        theta_hat = cov_matrix @ XT_W_y\n        \n        # Step 4: Extract the results for beta\n        # The estimate for beta is the second element of theta_hat\n        beta_hat = theta_hat[1]\n        \n        # The standard uncertainty for beta is the square root of the (2,2) element\n        # of the covariance matrix.\n        uncertainty_beta = np.sqrt(cov_matrix[1, 1])\n        \n        return beta_hat, uncertainty_beta\n\n    results = []\n    for case in test_cases:\n        beta, u_beta = estimate_beta_and_uncertainty(\n            case[\"epsilons\"], case[\"kappas_eff\"], case[\"sigmas\"]\n        )\n        results.append([beta, u_beta])\n    \n    # Format the final output string as specified in the problem\n    formatted_results = [f\"[{beta:.6f},{u_beta:.6f}]\" for beta, u_beta in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "本节将探讨参数化过程中一个更高级且普遍存在的挑战：参数的不可辨识性与相关性。在复杂的多物理场模型中，不同参数对模型输出的影响可能会相互混淆，导致它们难以被独立地精确估计。本实践通过分析参数估计的系综，利用统计相关性矩阵来识别这类强相关参数对，并将其与模型底层的物理定律（如巴特勒-沃尔默动力学方程）联系起来，从而让你对模型结构和实验设计的局限性有更深刻的理解。",
            "id": "3937407",
            "problem": "您的任务是分析基于物理的锂离子电池模型的参数估计集成，以量化参数间的相关性，并识别出具有高绝对相关性的参数对。该背景涉及电极模型中反应动力学和固相扩散的相互作用，该模型遵循基于物理的定律。具体而言，重点关注诸如交换电流密度 $i_0$ 和比表面积 $a_s$，以及固态扩散系数 $D_s$ 和颗粒半径 $R_p$ 等参数对。已知这些参数对通过反应动力学和扩散时间常数在结构上是混淆的。\n\n从以下基本依据开始：\n- Butler–Volmer 反应动力学：局部界面电流密度 $j$ 满足 $j \\approx a_s i_0 \\phi(\\eta)$，其中 $\\phi(\\eta)$ 是从 Butler–Volmer 表达式导出的过电势 $\\eta$ 的单调函数。在小过电势极限下，$j$ 近似与 $a_s i_0 \\eta$ 成正比，因此主要对 $j$ 敏感的数据集将在结构上耦合 $a_s$ 和 $i_0$。\n- 球形颗粒中的 Fickian 扩散：特征扩散时间常数为 $\\tau = R_p^2 / D_s$。当数据主要提供关于 $\\tau$ 的信息时，比率 $R_p^2 / D_s$ 在结构上是可识别的，从而在 $R_p$ 和 $D_s$ 之间引入耦合。\n\n您的工作是为每个测试案例计算所有运行的样本相关矩阵，然后识别出所有具有高相关性绝对值的参数索引对。在整个过程中使用以下参数索引映射：\n- 索引 $0$：$i_0$ (交换电流密度)，单位 $\\mathrm{A\\, m^{-2}}$。\n- 索引 $1$：$a_s$ (比表面积)，单位 $\\mathrm{m^2\\, m^{-3}}$。\n- 索引 $2$：$D_s$ (固态扩散系数)，单位 $\\mathrm{m^2\\, s^{-1}}$。\n- 索引 $3$：$R_p$ (颗粒半径)，单位 $\\mathrm{m}$。\n\n对于下述每个测试案例，您必须使用确切的随机规范生成参数估计的集成，计算样本相关矩阵 $C$，其元素为\n$$\nC_{ij} = \\frac{\\mathrm{cov}(\\theta_i, \\theta_j)}{\\sigma(\\theta_i)\\,\\sigma(\\theta_j)},\n$$\n其中 $\\theta_i$ 是第 $i$ 个参数在所有运行中的集合，$\\mathrm{cov}$ 表示样本协方差，$\\sigma(\\cdot)$ 表示样本标准差，然后列出所有满足 $|C_{ij}| \\geq r^\\star$ 的对 $\\{i,j\\}$（其中 $i < j$）。使用阈值 $r^\\star = 0.90$（无量纲）。\n\n物理单位适用于参数生成，但相关系数是无量纲的。不涉及角度。答案必须表示为整数列表和整数列表的列表；不允许使用字符串或其他类型。\n\n测试套件规范：\n- 测试案例 1（$i_0$ 和 $a_s$ 之间强耦合以及 $D_s$ 和 $R_p$ 之间中等耦合的一般情况）：\n  - 随机种子：$2025$。\n  - 运行次数：$N = 300$。\n  - 从一个4元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\Sigma)$ 中抽取 $\\boldsymbol{\\theta} = [i_0, a_s, D_s, R_p]^\\top$，其中\n    $$\n    \\boldsymbol{\\mu} =\n    \\begin{bmatrix}\n    3.0 \\\\\n    7.0 \\times 10^{5} \\\\\n    1.2 \\times 10^{-13} \\\\\n    9.0 \\times 10^{-6}\n    \\end{bmatrix},\n    \\quad\n    \\Sigma =\n    \\begin{bmatrix}\n    (0.5)^2 & -4.75 \\times 10^{4} & 0 & 0 \\\\\n    -4.75 \\times 10^{4} & (1.0 \\times 10^{5})^2 & 0 & 0 \\\\\n    0 & 0 & (2.0 \\times 10^{-14})^2 & 1.2 \\times 10^{-20} \\\\\n    0 & 0 & 1.2 \\times 10^{-20} & (1.0 \\times 10^{-6})^2\n    \\end{bmatrix}.\n    $$\n  - 单位：$i_0$ 单位为 $\\mathrm{A\\, m^{-2}}$，$a_s$ 单位为 $\\mathrm{m^2\\, m^{-3}}$，$D_s$ 单位为 $\\mathrm{m^2\\, s^{-1}}$，$R_p$ 单位为 $\\mathrm{m}$。\n\n- 测试案例 2（通过扩散时间约束，$D_s$ 和 $R_p$ 之间具有近乎完美的结构性耦合的边缘案例）：\n  - 随机种子：$7$。\n  - 运行次数：$N = 300$。\n  - 独立生成：\n    - $i_0 \\sim \\mathcal{N}(4.0, (0.3)^2)$，单位 $\\mathrm{A\\, m^{-2}}$，\n    - $a_s \\sim \\mathcal{N}(6.0 \\times 10^{5}, (5.0 \\times 10^{4})^2)$，单位 $\\mathrm{m^2\\, m^{-3}}$，\n    - $R_p \\sim \\mathrm{Uniform}(5.0 \\times 10^{-6}, 1.5 \\times 10^{-5})$，单位 $\\mathrm{m}$，\n    - $D_s = c \\, R_p^2 + \\varepsilon$，单位 $\\mathrm{m^2\\, s^{-1}}$，其中 $c = 1.0 \\times 10^{-3}$ 且 $\\varepsilon \\sim \\mathcal{N}(0, (5.0 \\times 10^{-15})^2)$ 为独立噪声。\n\n- 测试案例 3（相关性弱至可忽略不计的基准案例）：\n  - 随机种子：$99$。\n  - 运行次数：$N = 300$。\n  - 从一个4元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\Sigma)$ 中抽取 $\\boldsymbol{\\theta} = [i_0, a_s, D_s, R_p]^\\top$，其中\n    $$\n    \\boldsymbol{\\mu} =\n    \\begin{bmatrix}\n    3.5 \\\\\n    8.0 \\times 10^{5} \\\\\n    1.0 \\times 10^{-13} \\\\\n    7.0 \\times 10^{-6}\n    \\end{bmatrix},\n    \\quad\n    \\Sigma =\n    \\begin{bmatrix}\n    (0.4)^2 & 0 & 0 & 0 \\\\\n    0 & (0.8 \\times 10^{5})^2 & 0 & 0 \\\\\n    0 & 0 & (1.5 \\times 10^{-14})^2 & 0 \\\\\n    0 & 0 & 0 & (0.8 \\times 10^{-6})^2\n    \\end{bmatrix}.\n    $$\n\n程序要求：\n- 对于每个测试案例，计算样本相关矩阵 $C$（无量纲）。\n- 识别所有满足 $|C_{ij}| \\geq r^\\star$ 的索引对 $\\{i,j\\}$（其中 $i < j$），$r^\\star = 0.90$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例的结果是一个索引对的列表，每个对表示为一个包含两个整数的列表。例如，一个有效的输出可能看起来像 $[[[0,1]],[[2,3]],[]]$。\n- 答案是纯数字且无单位的，因为它由索引对和相关性阈值决策组成。请使用指定的随机种子以确保可复现性。\n\n在您的解答中，解释任何已识别出的高相关性的根本结构性原因，将其与上述基本定律联系起来，并论证为何该算法能根据统计定义正确识别这些参数对。",
            "solution": "目标是分析一个基于物理的锂离子电池模型的参数估计集成，为每个集成计算样本相关矩阵，并识别出具有高绝对相关性的参数对。高相关性定义为相关性绝对值大于或等于阈值 $r^\\star = 0.90$。该分析基于电池运行的物理原理，这些原理导致了某些参数之间出现结构性混淆。\n\n所考虑的参数按如下方式映射到索引：\n- 索引 $0$：$i_0$ (交换电流密度)\n- 索引 $1$：$a_s$ (比表面积)\n- 索引 $2$：$D_s$ (固态扩散系数)\n- 索引 $3$：$R_p$ (颗粒半径)\n\n### 方法论框架\n对于每个测试案例，根据指定的随机过程生成一个包含 $N$ 个参数向量的集成，即 $\\boldsymbol{\\theta}^{(k)} = [\\theta_0^{(k)}, \\theta_1^{(k)}, \\theta_2^{(k)}, \\theta_3^{(k)}]^\\top$，其中 $k=1, \\dots, N$。为此，使用一个伪随机数生成器，并使用指定的种子进行初始化以确保可复现性。\n\n从生成的 $N \\times 4$ 参数样本数据矩阵中，计算 $4 \\times 4$ 的样本相关矩阵 $C$。该矩阵的元素 $C_{ij}$ 由以下公式定义：\n$$\nC_{ij} = \\frac{\\mathrm{cov}(\\boldsymbol{\\theta}_i, \\boldsymbol{\\theta}_j)}{\\sigma(\\boldsymbol{\\theta}_i)\\,\\sigma(\\boldsymbol{\\theta}_j)}\n$$\n其中 $\\boldsymbol{\\theta}_i$ 代表第 $i$ 个参数的所有 $N$ 个样本组成的向量，$\\mathrm{cov}(\\cdot, \\cdot)$ 表示样本协方差，$\\sigma(\\cdot)$ 是样本标准差。\n\n最后，对唯一的参数对 $\\{i,j\\}$（其中 $i < j$）执行算法搜索。如果其样本相关系数的绝对值 $|C_{ij}|$ 达到或超过阈值 $r^\\star = 0.90$，则该参数对被识别为高度相关。\n\n### 逐案分析\n\n**测试案例 1：具有确定协方差的一般情况**\n该测试案例模拟了一个场景，其中参数估计程序已生成一组具有已知联合不确定性的参数，该不确定性由一个多元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\Sigma)$ 表示。协方差矩阵 $\\Sigma$ 的构造旨在反映 $i_0$ 和 $a_s$ 之间的强耦合以及 $D_s$ 和 $R_p$ 之间的中等耦合。\n\n- **物理学原理**：交换电流密度 $i_0$（索引 0）与比表面积 $a_s$（索引 1）之间的强负相关性是 Butler-Volmer 界面电流密度 $j$ 方程结构的直接统计结果。在简化形式下，$j$ 与乘积 $i_0 a_s$ 成正比。当实验数据主要约束 $j$ 时，乘积 $i_0 a_s$ 能被很好地识别，但单个参数则不能。$i_0$ 估计值的增加可以通过相应减小 $a_s$ 来补偿，同时产生相似的模型输出，这导致它们的后验分布中出现强负相关性。\n- **定量预测**：生成分布的理论相关系数为 $\\rho_{ij} = \\Sigma_{ij} / \\sqrt{\\Sigma_{ii} \\Sigma_{jj}}$。对于对 $\\{0, 1\\}$，这得出：\n$$\n\\rho_{01} = \\frac{-4.75 \\times 10^{4}}{\\sqrt{(0.5)^2 \\times (1.0 \\times 10^{5})^2}} = \\frac{-4.75 \\times 10^{4}}{0.5 \\times 1.0 \\times 10^{5}} = -0.95\n$$\n由于 $|\\rho_{01}| = 0.95 > r^\\star$，预计该对将具有高相关性。对于对 $\\{2, 3\\}$：\n$$\n\\rho_{23} = \\frac{1.2 \\times 10^{-20}}{\\sqrt{(2.0 \\times 10^{-14})^2 \\times (1.0 \\times 10^{-6})^2}} = \\frac{1.2 \\times 10^{-20}}{2.0 \\times 10^{-20}} = 0.6\n$$\n由于 $|\\rho_{23}| = 0.6 < r^\\star$，预计该对不会被标记。\n- **预期结果**：将识别出参数对 $\\{0, 1\\}$。\n\n**测试案例 2：近乎完美的结构性耦合**\n此案例明确构造了 $D_s$ 和 $R_p$ 之间近乎完美的函数依赖关系，以模拟结构性混淆的极端情况。\n\n- **物理学原理**：固态扩散过程的特征是扩散时间常数 $\\tau = R_p^2 / D_s$。如果实验数据对 $\\tau$ 最敏感，那么参数仅在组合 $D_s/R_p^2 \\approx 1/\\tau$ 中是可识别的。这意味着一个近似的二次关系，$D_s \\approx (1/\\tau) R_p^2$。该测试案例通过设置 $D_s = c R_p^2 + \\varepsilon$ 来模拟这一点，其中 $c$ 是一个常数，$\\varepsilon$ 是一个非常小的噪声项。因为 $D_s$ 是 $R_p$ 的一个强增函数，它们之间的相关性应为正且非常接近 1。其他参数 $i_0$ 和 $a_s$ 是独立生成的，预计它们之间以及与扩散参数之间的相关性可忽略不计。\n- **定量预测**：关系的确定性部分是 $D_s = (1.0 \\times 10^{-3}) R_p^2$。$R_p$ 的范围是 $[5.0 \\times 10^{-6}, 1.5 \\times 10^{-5}]\\,\\mathrm{m}$，导致项 $c R_p^2$ 在大约 $[2.5 \\times 10^{-14}, 2.25 \\times 10^{-13}]\\,\\mathrm{m^2\\,s^{-1}}$ 的范围内变化。噪声 $\\varepsilon$ 的标准差是 $5.0 \\times 10^{-15}\\,\\mathrm{m^2\\,s^{-1}}$，比信号的方差小一个数量级。这表明该关系由确定性的二次项主导，$D_s$ 和 $R_p$ 之间的皮尔逊相关系数将非常接近 +1。\n- **预期结果**：将识别出参数对 $\\{2, 3\\}$。\n\n**测试案例 3：无相关性的基准案例**\n此案例用作基准对照，其中所有参数均从独立的​​正态分布生成。\n\n- **物理学原理**：此场景对应一个理想化的情况，即用于参数化的实验数据足够丰富，可以消除所有参数间的相关性。生成分布由一个对角协方差矩阵定义，这意味着任何参数对之间的真实相关性都为零。\n- **定量预测**：对于有限的样本量（$N=300$），由于随机抽样波动，$i \\neq j$ 的样本相关系数 $C_{ij}$ 将不为零。然而，对于从未相关总体中抽取的样本，观察到绝对值高达 $0.90$ 的样本相关性的概率极低。\n- **预期结果**：不会识别出任何参数对。这证实了该算法在基准条件下不会产生假阳性。\n\n实现将按所述为每个案例生成数据集，计算样本相关矩阵，并应用阈值来识别指定的参数对。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport json\n\ndef solve():\n    \"\"\"\n    Main function to execute the analysis for all test cases.\n    It computes the sample correlation matrix for each parameter ensemble and\n    identifies pairs with a correlation magnitude >= 0.90.\n    \"\"\"\n    \n    # Test case definitions as a list of dictionaries\n    test_specs = [\n        {\n            \"case_id\": 1,\n            \"seed\": 2025,\n            \"N\": 300,\n            \"r_star\": 0.90,\n            \"description\": \"General case with strong and moderate coupling\",\n            \"generation_method\": \"multivariate_normal\",\n            \"params\": {\n                \"mu\": np.array([3.0, 7.0e5, 1.2e-13, 9.0e-6]),\n                \"Sigma\": np.array([\n                    [(0.5)**2, -4.75e4, 0, 0],\n                    [-4.75e4, (1.0e5)**2, 0, 0],\n                    [0, 0, (2.0e-14)**2, 1.2e-20],\n                    [0, 0, 1.2e-20, (1.0e-6)**2]\n                ])\n            }\n        },\n        {\n            \"case_id\": 2,\n            \"seed\": 7,\n            \"N\": 300,\n            \"r_star\": 0.90,\n            \"description\": \"Near-perfect structural coupling via function\",\n            \"generation_method\": \"custom_generation\",\n            \"params\": {\n                \"i0_dist\": {\"mean\": 4.0, \"std\": 0.3},\n                \"as_dist\": {\"mean\": 6.0e5, \"std\": 5.0e4},\n                \"Rp_dist\": {\"low\": 5.0e-6, \"high\": 1.5e-5},\n                \"Ds_relation\": {\"c\": 1.0e-3, \"noise_std\": 5.0e-15}\n            }\n        },\n        {\n            \"case_id\": 3,\n            \"seed\": 99,\n            \"N\": 300,\n            \"r_star\": 0.90,\n            \"description\": \"Baseline with weak to negligible correlations\",\n            \"generation_method\": \"multivariate_normal\",\n            \"params\": {\n                \"mu\": np.array([3.5, 8.0e5, 1.0e-13, 7.0e-6]),\n                \"Sigma\": np.diag([\n                    (0.4)**2, (0.8e5)**2, (1.5e-14)**2, (0.8e-6)**2\n                ])\n            }\n        }\n    ]\n\n    all_results = []\n\n    for spec in test_specs:\n        rng = np.random.default_rng(spec[\"seed\"])\n        N = spec[\"N\"]\n        \n        if spec[\"generation_method\"] == \"multivariate_normal\":\n            mu = spec[\"params\"][\"mu\"]\n            Sigma = spec[\"params\"][\"Sigma\"]\n            samples = rng.multivariate_normal(mu, Sigma, size=N)\n        \n        elif spec[\"generation_method\"] == \"custom_generation\":\n            # Generate each parameter series according to the custom rules\n            p = spec[\"params\"]\n            i0_samples = rng.normal(p[\"i0_dist\"][\"mean\"], p[\"i0_dist\"][\"std\"], size=N)\n            as_samples = rng.normal(p[\"as_dist\"][\"mean\"], p[\"as_dist\"][\"std\"], size=N)\n            Rp_samples = rng.uniform(p[\"Rp_dist\"][\"low\"], p[\"Rp_dist\"][\"high\"], size=N)\n            \n            c = p[\"Ds_relation\"][\"c\"]\n            noise = rng.normal(0, p[\"Ds_relation\"][\"noise_std\"], size=N)\n            Ds_samples = c * Rp_samples**2 + noise\n            \n            # Stack the parameter samples into a single N x 4 array\n            samples = np.vstack((i0_samples, as_samples, Ds_samples, Rp_samples)).T\n            \n        # Compute the 4x4 sample correlation matrix\n        # rowvar=False because our data is N_samples x N_features\n        corr_matrix = np.corrcoef(samples, rowvar=False)\n        \n        # Identify pairs with high correlation\n        highly_correlated_pairs = []\n        num_params = 4\n        r_star = spec[\"r_star\"]\n        \n        # Iterate over the upper triangle of the correlation matrix\n        for i in range(num_params):\n            for j in range(i + 1, num_params):\n                if abs(corr_matrix[i, j]) >= r_star:\n                    highly_correlated_pairs.append([i, j])\n                    \n        all_results.append(highly_correlated_pairs)\n\n    # Format the final output string exactly as specified in the problem\n    # no spaces between elements\n    final_output_str = json.dumps(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}