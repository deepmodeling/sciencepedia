{
    "hands_on_practices": [
        {
            "introduction": "电池模型的建立始于对其核心特性的精确表征，其中开路电压（OCV）与荷电状态（SOC）之间的关系至关重要。本练习将指导您构建一个参数化的 $OCV(SOC)$ 函数，该函数通过其结构本身来保证物理上的单调性约束，这是从数据中学习一个既准确又符合热力学原理的模型的关键一步。通过解决这个正则化优化问题 ，您将掌握在自动化电池设计中融合物理洞察和数据驱动方法的核心技能。",
            "id": "3900359",
            "problem": "一个锂离子电池在足够低的充/放电速率（例如，量级远小于$1$的C倍率）和长的静置期下进行测试，使得测得的电压近似于开路电压（Open-Circuit Voltage, OCV）。令荷电状态（State of Charge, SOC）由$x \\in [0,1]$表示，其中$x=0$对应于完全放电状态，$x=1$对应于完全充电状态。放电深度（Depth of Discharge, DOD）定义为$\\mathrm{DOD} = 1 - x$。根据定义，在电流为$I(t)$、额定容量为$Q_{\\mathrm{nom}}$的恒流操作下，SOC满足$\\mathrm{d}x/\\mathrm{d}t = -I(t)/Q_{\\mathrm{nom}}$。对于此处考虑的准平衡数据，您可以忽略动态过电势，并假设测量电压等于OCV。\n\n考虑在恒定温度下，$x \\in [0,1]$范围内的单相嵌入体系，其中OCV是SOC的函数$V(x)$。根据基础热力学，OCV与电极之间的电化学势之差成正比，并且在稳定的单相区域中，化学势是成分的增函数。因此，物理上要求$V(x)$是$x$的单调非减函数是合理的。\n\n给定$N$个平衡数据对$\\{(x_i, y_i)\\}_{i=1}^{N}$，其中$x_i \\in [0,1]$表示SOC，$y_i$表示测得的OCV（单位为伏特）。假设存在一个加性噪声模型$y_i = V(x_i) + \\eta_i$，其中$\\eta_i$是零均值噪声。令$V_{\\min}$和$V_{\\max}$分别为$x=0$和$x=1$处可靠的参考OCV值。\n\n任务：\n1. 从OCV根据电极电化学势的平衡定义以及稳定单相自由能具有正曲率的事实出发，陈述对$V(x)$的单调性要求，并将其表示为涉及$V'(x)$的微分不等式。\n2. 提出一种$V(x)$的参数化表示，通过一个非负导数在构造上强制实现单调性，具体形式为\n   $$V(x) = E_0 + \\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s$$\n   其中$p(s)$是一个系数未知的多项式，$\\varepsilon \\ge 0$是一个小的固定非负常数，代表一个最小斜率下限。选择$p(s)$为$s$的二次多项式，其系数未知，并推导出$V(x)$作为$x$和这些系数的函数的闭式解析表达式。\n3. 建立一个Tikhonov正则化最小二乘问题来估计您模型中的参数，使用数据$\\{(x_i,y_i)\\}_{i=1}^{N}$，并受制于具有物理意义的约束，包括边界条件$V(0)=V_{\\min}$和$V(1)=V_{\\max}$以及在$[0,1]$中有限个配置点上强制施加的斜率界限$0 \\le V'(x) \\le \\gamma_{\\max}$（对于给定的$\\gamma_{\\max}  0$）。使用曲率平方积分$\\int_{0}^{1} \\left(V''(s)\\right)^2 \\,\\mathrm{d}s$作为正则化项。您的公式必须以数学形式明确包含所有决策变量、目标和所有约束。\n4. 作为最终答案，提供在任务$2$中得到的$V(x)$关于多项式系数和$\\varepsilon$的闭式表达式。将最终的OCV表示为SOC的函数，不带单位。\n\n重要说明：\n- 所有变量必须有明确定义。陈述您使用的任何假设。\n- 确保所提出的参数化在$x \\in [0,1]$上是科学上现实的。\n- 最终答案必须是$V(x)$关于所选参数的单个闭式解析表达式，不包含任何单位。不需要进行数值评估。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它在电池建模领域，特别是在具有物理意义的约束下从带噪声的数据中进行开路电压（OCV）曲线的参数估计方面，提出了一个连贯且标准的任务。所有提供的信息都是自洽且足以继续执行所要求的任务。\n\n1.  对$V(x)$的单调性要求\n\n该问题基于稳定单相系统的热力学原理假定，开路电压$V(x)$是荷电状态（SOC）$x$的单调非减函数。如果一个函数在其定义域内的任意两点，较大点处的函数值大于或等于较小点处的函数值，则该函数在该区间上是单调非减的。\n\n对于一个可微函数$V(x)$，此属性等价于其一阶导数在其定义域内处处非负。OCV对SOC的导数$V'(x) = \\frac{\\mathrm{d}V}{\\mathrm{d}x}$代表了电压曲线的局部斜率。因此，$V(x)$在其定义域$x \\in [0,1]$上单调非减的要求可以表示为以下微分不等式：\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}x} \\ge 0, \\quad \\forall x \\in [0,1]\n$$\n这个不等式确保了当电池充电时电压不会下降，这与许多锂离子电池化学体系在单相嵌入区间的行为一致。\n\n2.  $V(x)$的参数化表示\n\n任务是提出一种$V(x)$的参数化形式，该形式内在地满足单调性约束。建议的形式是\n$$\nV(x) = E_0 + \\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s\n$$\n其中$E_0$是一个积分常数，$p(s)$是一个待定义的函数，而$\\varepsilon \\ge 0$是一个小的固定常数。根据微积分基本定理，$V(x)$的导数是$V'(x) = p(x)^2 + \\varepsilon$。由于对于任何实值函数$p(x)$都有$p(x)^2 \\ge 0$，且给定$\\varepsilon \\ge 0$，因此可以保证$V'(x) \\ge 0$，从而通过构造满足了单调性要求。\n\n我们被要求选择$p(s)$为一个系数$a_0, a_1, a_2$未知的$s$的二次多项式：\n$$\np(s) = a_2 s^2 + a_1 s + a_0\n$$\n为了找到$V(x)$的闭式表达式，我们首先计算$p(s)^2$：\n$$\np(s)^2 = (a_2 s^2 + a_1 s + a_0)^2 = a_2^2 s^4 + a_1^2 s^2 + a_0^2 + 2a_1a_2 s^3 + 2a_0a_2 s^2 + 2a_0a_1 s\n$$\n按$s$的幂次对各项进行分组：\n$$\np(s)^2 = a_2^2 s^4 + (2a_1 a_2) s^3 + (a_1^2 + 2a_0 a_2) s^2 + (2a_0 a_1) s + a_0^2\n$$\n现在，我们将$p(s)^2 + \\varepsilon$从$s=0$积分到$s=x$：\n$$\n\\int_{0}^{x} \\left( p(s)^2 + \\varepsilon \\right) \\,\\mathrm{d}s = \\int_{0}^{x} \\left( a_2^2 s^4 + 2a_1 a_2 s^3 + (a_1^2 + 2a_0 a_2) s^2 + 2a_0 a_1 s + a_0^2 + \\varepsilon \\right) \\,\\mathrm{d}s\n$$\n逐项积分得到：\n$$\n\\left[ \\frac{a_2^2}{5}s^5 + \\frac{2a_1 a_2}{4}s^4 + \\frac{a_1^2 + 2a_0 a_2}{3}s^3 + \\frac{2a_0 a_1}{2}s^2 + (a_0^2 + \\varepsilon)s \\right]_0^x\n$$\n计算定积分得到：\n$$\n\\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x\n$$\n将此结果代回$V(x)$的表达式，我们得到最终的闭式解析表达式：\n$$\nV(x) = E_0 + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x\n$$\n该模型的参数是积分常数$E_0$和多项式系数$a_0, a_1, a_2$。\n\n3. Tikhonov正则化最小二乘公式\n\n目标是通过拟合实验数据$\\{(x_i, y_i)\\}_{i=1}^{N}$来估计模型参数，同时满足物理约束。这可以被构建为一个约束优化问题。\n\n首先，我们引入边界条件$V(0) = V_{\\min}$。从我们推导的表达式可知，$V(0) = E_0$。因此，我们固定$E_0 = V_{\\min}$，这消去了一个参数。模型变为：\n$$\nV(x; \\mathbf{a}) = V_{\\min} + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x,\n$$\n其中$\\mathbf{a} = [a_0, a_1, a_2]^T$是决策变量的向量。\n\n优化问题公式如下：\n\n**决策变量**：多项式$p(s)$的系数，记为向量$\\mathbf{a} = [a_0, a_1, a_2]^T \\in \\mathbb{R}^3$。\n\n**目标函数**：找到$\\mathbf{a}$以最小化Tikhonov正则化目标函数$J(\\mathbf{a})$：\n$$\n\\min_{\\mathbf{a}} J(\\mathbf{a}) = \\sum_{i=1}^{N} \\left( V(x_i; \\mathbf{a}) - y_i \\right)^2 + \\lambda \\int_{0}^{1} \\left(V''(s; \\mathbf{a})\\right)^2 \\,\\mathrm{d}s\n$$\n其中$\\lambda  0$是Tikhonov正则化参数，用于平衡数据拟合和所得曲线的平滑度。项$V(x_i; \\mathbf{a})$是在数据点$x_i$处评估的模型值，$V''(s; \\mathbf{a})$是电压模型的二阶导数（曲率）。\n\n**约束**：优化受以下约束条件限制：\n1.  $x=1$处的边界条件：模型必须满足$V(1) = V_{\\max}$。\n    $$\n    V(1; \\mathbf{a}) = V_{\\min} + \\frac{a_2^2}{5} + \\frac{a_1 a_2}{2} + \\frac{a_1^2 + 2a_0 a_2}{3} + a_0 a_1 + (a_0^2 + \\varepsilon) = V_{\\max}\n    $$\n    这是一个关于变量$\\mathbf{a}$的二次等式约束。\n\n2.  斜率界限：在一组位于$[0,1]$中的$M$个配置点$\\{z_j\\}_{j=1}^{M}$上，斜率$V'(x)$必须有界，$0 \\le V'(x) \\le \\gamma_{\\max}$。\n    我们有$V'(x) = p(x)^2 + \\varepsilon$。下界$V'(x) \\ge \\varepsilon \\ge 0$通过构造得到满足。上界转化为：\n    $$\n    (a_2 z_j^2 + a_1 z_j + a_0)^2 + \\varepsilon \\le \\gamma_{\\max}, \\quad \\text{对于 } j = 1, \\dots, M\n    $$\n    这组$M$个不等式构成了二次不等式约束。\n\n这完全定义了估计模型参数所需的非线性约束优化问题。\n\n4.  最终答案表达式\n\n任务4要求提供在任务2中获得的$V(x)$的闭式表达式。此表达式将OCV定义为SOC $x$的函数，以模型参数$E_0, a_0, a_1, a_2$和固定常数$\\varepsilon$表示。此表达式在下方的最终答案框中提供。",
            "answer": "$$\n\\boxed{E_0 + \\frac{a_2^2}{5}x^5 + \\frac{a_1 a_2}{2}x^4 + \\frac{a_1^2 + 2a_0 a_2}{3}x^3 + a_0 a_1 x^2 + (a_0^2 + \\varepsilon)x}\n$$"
        },
        {
            "introduction": "拥有电池模型后，下一步是利用它来预测在特定工作条件下的动态行为。本练习将模拟一个常见的实际场景：恒流-恒压（CC-CV）充电过程，要求您推导出 $SOC$ 随时间演化的完整轨迹 。通过这个实践，您不仅能加深对电池充电动态的理解，还能学会如何应用基本物理定律来计算如充电时间等关键性能指标。",
            "id": "3900357",
            "problem": "考虑一个单一锂离子电池，其充电动态被建模用于自动化电池设计和仿真。充电控制器采用恒流-恒压（CC-CV）协议。设荷电状态（SOC）由 $SOC(t) = \\frac{Q_{\\text{stored}}(t)}{Q_{\\text{nom}}}$ 定义，其中 $Q_{\\text{stored}}(t)$ 是时间 $t$ 时的存储电荷，$Q_{\\text{nom}}$ 是额定容量；设放电深度（DOD）为 $DOD(t) = 1 - SOC(t)$。假设如下：\n\n- 额定容量为 $Q_{\\text{nom}} = 3.0\\,\\text{Ah}$。\n- 开路电压是 SOC 的仿射函数，由 $OCV(SOC) = V_{0} + \\alpha\\,SOC$ 给出，其中 $V_{0} = 3.3\\,\\text{V}$ 且 $\\alpha = 0.9\\,\\text{V}$。\n- 在所考虑的 SOC 范围内，内阻是恒定的，为 $R_{\\text{int}} = 60\\,\\text{m}\\Omega$。\n- 恒流（CC）电流限制为 $I_{\\text{CC}} = 4.0\\,\\text{A}$，恒压（CV）电压限制为 $V_{\\text{lim}} = 4.2\\,\\text{V}$。\n- 初始 SOC 为 $SOC(0) = 0.20$。\n- 充电过程中的库伦效率为 1。\n\n仅从基本定义和定律（电荷守恒 $dQ/dt = I$，内阻的欧姆定律，以及给定的 $OCV(SOC)$ 本构关系）出发，推导 CC-CV 充电的显式分段轨迹 $SOC(t)$。然后，计算达到 $SOC = 0.80$ 所需的总充电时间，并考虑到当测量的端电压 $V_{\\text{term}}(t)$ 首次等于 $V_{\\text{lim}}$ 时从 CC 转换到 CV 的过程。以秒为单位表示最终时间，并将答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它使用一个简化但有效的等效电路模型描述了一个标准的电池充电场景。所有参数均已提供且物理上是现实的。\n\n充电过程遵循恒流-恒压（CC-CV）协议。分析分为两个阶段：恒流（CC）阶段和恒压（CV）阶段。\n\n控制系统的基本方程如下：\n1. 存储电荷 $Q_{\\text{stored}}(t)$ 与荷电状态 $SOC(t)$ 之间的关系：\n$$SOC(t) = \\frac{Q_{\\text{stored}}(t)}{Q_{\\text{nom}}}$$\n2. 假设库伦效率为 1 时，电荷积累的动态过程：\n$$\\frac{dQ_{\\text{stored}}(t)}{dt} = I(t)$$\n结合以上两点，得到 $SOC(t)$ 的微分方程：\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = I(t)$$\n3. 端电压 $V_{\\text{term}}(t)$ 由一个等效电路模型描述：\n$$V_{\\text{term}}(t) = OCV(SOC(t)) + I(t)R_{\\text{int}}$$\n4. 开路电压 $OCV$ 是 $SOC$ 的仿射函数：\n$$OCV(SOC) = V_{0} + \\alpha\\,SOC$$\n\n首先，我们必须将额定容量 $Q_{\\text{nom}}$ 转换为国际单位制（安培-秒或库伦）：\n$Q_{\\text{nom}} = 3.0\\,\\text{Ah} = 3.0\\,\\text{A} \\times 3600\\,\\text{s} = 10800\\,\\text{As}$。\n\n**阶段 1：恒流（CC）充电**\n此阶段从 $t=0$ 开始，一直持续到端电压 $V_{\\text{term}}(t)$ 达到预设限制 $V_{\\text{lim}}$。在此阶段，电流是恒定的：$I(t) = I_{\\text{CC}} = 4.0\\,\\text{A}$。\n\n$SOC$ 的控制方程为：\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = I_{\\text{CC}}$$\n将此方程从 $t=0$ 积分到恒流阶段的某个时间 $t$：\n$$\\int_{SOC(0)}^{SOC(t)} d(SOC) = \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} \\int_{0}^{t} d\\tau$$\n$$SOC(t) - SOC(0) = \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} t$$\n因此，恒流阶段的 $SOC$ 轨迹为：\n$$SOC(t) = SOC(0) + \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}} t$$\n\n当 $V_{\\text{term}}(t_{\\text{trans}}) = V_{\\text{lim}}$ 时，恒流阶段在转换时间 $t_{\\text{trans}}$ 结束。此阶段的端电压为：\n$$V_{\\text{term}}(t) = OCV(SOC(t)) + I_{\\text{CC}}R_{\\text{int}} = (V_{0} + \\alpha\\,SOC(t)) + I_{\\text{CC}}R_{\\text{int}}$$\n在 $t = t_{\\text{trans}}$ 时，设 $SOC(t_{\\text{trans}}) = SOC_{\\text{trans}}$。条件是：\n$$V_{\\text{lim}} = V_{0} + \\alpha\\,SOC_{\\text{trans}} + I_{\\text{CC}}R_{\\text{int}}$$\n我们可以解出转换点的荷电状态：\n$$SOC_{\\text{trans}} = \\frac{V_{\\text{lim}} - V_{0} - I_{\\text{CC}}R_{\\text{int}}}{\\alpha}$$\n使用给定值：$V_{\\text{lim}} = 4.2\\,\\text{V}$, $V_{0} = 3.3\\,\\text{V}$, $I_{\\text{CC}} = 4.0\\,\\text{A}$, $R_{\\text{int}} = 60\\,\\text{m}\\Omega = 0.060\\,\\Omega$, 以及 $\\alpha = 0.9\\,\\text{V}$。\n$$SOC_{\\text{trans}} = \\frac{4.2 - 3.3 - (4.0 \\times 0.060)}{0.9} = \\frac{0.9 - 0.24}{0.9} = \\frac{0.66}{0.9} = \\frac{11}{15}$$\n数值上，$SOC_{\\text{trans}} \\approx 0.7333$。由于目标 SOC 为 $0.80$，大于 $SOC_{\\text{trans}}$，因此电池必须进入恒压阶段才能达到目标。\n\n恒流阶段的持续时间 $t_{\\text{trans}}$ 是从 $SOC(0) = 0.20$ 达到 $SOC_{\\text{trans}}$ 所需的时间。\n$$t_{\\text{trans}} = \\frac{Q_{\\text{nom}}}{I_{\\text{CC}}} (SOC_{\\text{trans}} - SOC(0))$$\n$$t_{\\text{trans}} = \\frac{10800\\,\\text{As}}{4.0\\,\\text{A}} \\left(\\frac{11}{15} - 0.20\\right) = 2700\\,\\text{s} \\left(\\frac{11}{15} - \\frac{3}{15}\\right) = 2700\\,\\text{s} \\left(\\frac{8}{15}\\right) = 1440\\,\\text{s}$$\n\n**阶段 2：恒压（CV）充电**\n此阶段从 $t = t_{\\text{trans}}$ 开始，并持续到最终目标 SOC。在此阶段，端电压保持恒定，$V_{\\text{term}}(t) = V_{\\text{lim}}$，而电流 $I(t)$ 减小。\n\n从端电压方程：\n$$V_{\\text{lim}} = OCV(SOC(t)) + I(t)R_{\\text{int}} = (V_0 + \\alpha\\,SOC(t)) + I(t)R_{\\text{int}}$$\n我们可以将随时间变化的电流 $I(t)$ 表示为：\n$$I(t) = \\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)}{R_{\\text{int}}}$$\n将此代入 SOC 微分方程：\n$$Q_{\\text{nom}} \\frac{d(SOC)}{dt} = \\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)}{R_{\\text{int}}}$$\n这是一个一阶可分离常微分方程。我们可以求解从 $SOC_{\\text{trans}}$ 充电到最终状态 $SOC_{\\text{final}} = 0.80$ 所需的时间。设此持续时间为 $t_{\\text{CV}} = t_{\\text{final}} - t_{\\text{trans}}$。\n$$\\frac{d(SOC)}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC(t)} = \\frac{dt}{Q_{\\text{nom}}R_{\\text{int}}}$$\n从 $t_{\\text{trans}}$ 到 $t_{\\text{final}}$ 积分：\n$$\\int_{SOC_{\\text{trans}}}^{SOC_{\\text{final}}} \\frac{d(SOC)}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC} = \\int_{t_{\\text{trans}}}^{t_{\\text{final}}} \\frac{1}{Q_{\\text{nom}}R_{\\text{int}}} dt$$\n$$\\left[ -\\frac{1}{\\alpha} \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC) \\right]_{SOC_{\\text{trans}}}^{SOC_{\\text{final}}} = \\frac{t_{\\text{final}} - t_{\\text{trans}}}{Q_{\\text{nom}}R_{\\text{int}}}$$\n$$t_{\\text{CV}} = t_{\\text{final}} - t_{\\text{trans}} = -\\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} \\left[ \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}}) - \\ln(V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}}) \\right]$$\n$$t_{\\text{CV}} = \\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} \\ln\\left(\\frac{V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}}}{V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}}}\\right)$$\n从恒流阶段的分析中，我们知道 $V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{trans}} = I_{\\text{CC}}R_{\\text{int}}$。分母是 $I(t_{\\text{final}})R_{\\text{int}}$。让我们计算这些项。\n分子：$I_{\\text{CC}}R_{\\text{int}} = 4.0\\,\\text{A} \\times 0.060\\,\\Omega = 0.24\\,\\text{V}$。\n分母：$V_{\\text{lim}} - V_0 - \\alpha\\,SOC_{\\text{final}} = 4.2 - 3.3 - 0.9 \\times 0.80 = 0.9 - 0.72 = 0.18\\,\\text{V}$。\n恒压阶段的时间常数为 $\\tau_c = \\frac{Q_{\\text{nom}}R_{\\text{int}}}{\\alpha} = \\frac{10800\\,\\text{As} \\times 0.060\\,\\Omega}{0.9\\,\\text{V}} = \\frac{648}{0.9}\\,\\text{s} = 720\\,\\text{s}$。\n$$t_{\\text{CV}} = 720\\,\\text{s} \\times \\ln\\left(\\frac{0.24}{0.18}\\right) = 720\\,\\text{s} \\times \\ln\\left(\\frac{4}{3}\\right)$$\n\n**总充电时间与分段轨迹**\n达到 $SOC = 0.80$ 的总时间是两个阶段持续时间的总和：\n$$t_{\\text{total}} = t_{\\text{trans}} + t_{\\text{CV}} = 1440\\,\\text{s} + 720 \\ln\\left(\\frac{4}{3}\\right)\\,\\text{s}$$\n使用 $\\ln(4/3) \\approx 0.28768$ 的值，我们得到：\n$$t_{\\text{total}} \\approx 1440 + 720 \\times 0.28768 = 1440 + 207.13 = 1647.13\\,\\text{s}$$\n四舍五入到四位有效数字，总时间为 $1647\\,\\text{s}$。\n\n显式分段轨迹 $SOC(t)$ 推导如下：\n对于恒流阶段（$0 \\le t \\le t_{\\text{trans}}$）：\n$$SOC(t) = SOC(0) + \\frac{I_{\\text{CC}}}{Q_{\\text{nom}}}t = 0.20 + \\frac{4.0}{10800}t = 0.20 + \\frac{1}{2700}t$$\n对于恒压阶段（$t  t_{\\text{trans}}$），常微分方程的解形式为 $SOC(t) = A + B\\exp(-(t-t_{\\text{trans}})/\\tau_c)$。稳态 SOC 为 $A = (V_{\\text{lim}} - V_0)/\\alpha = (4.2-3.3)/0.9 = 1$。常数 $B$ 由 $t=t_{\\text{trans}}$ 时的条件求得，得到 $B=SOC_{\\text{trans}}-1$。\n$$SOC(t) = 1 + (SOC_{\\text{trans}} - 1)\\exp\\left(-\\frac{t-t_{\\text{trans}}}{\\tau_c}\\right) = 1 + \\left(\\frac{11}{15}-1\\right)\\exp\\left(-\\frac{t-1440}{720}\\right) = 1 - \\frac{4}{15}\\exp\\left(-\\frac{t-1440}{720}\\right)$$\n完整的分段轨迹是：\n$$SOC(t) = \\begin{cases} 0.20 + \\frac{1}{2700}t  \\text{for } 0 \\le t \\le 1440\\,\\text{s} \\\\ 1 - \\frac{4}{15}\\exp\\left(-\\frac{t-1440}{720}\\right)  \\text{for } t  1440\\,\\text{s} \\end{cases}$$\n最终要求的值是达到 $SOC=0.80$ 的总时间。\n\n最终计算：\n$t_{\\text{total}} = 1440 + 720 \\ln(4/3) \\approx 1647.131092...$\n四舍五入到四位有效数字得到 $1647$。",
            "answer": "$$\\boxed{1647}$$"
        },
        {
            "introduction": "为了在电池管理系统（BMS）中实现高级控制和状态估计，将等效电路模型转换为状态空间形式是至关重要的一步。本练习引导您为一个二阶模型构建状态空间表示，并进一步探讨其可观测性——这是判断能否从外部测量（电压和电流）中准确推断内部状态（如 $SOC$ 和极化电压）的理论基石 。完成这个分析，您将理解状态估计器（如卡尔曼滤波器）设计的理论前提，并掌握连接物理模型与现代控制理论的关键技术。",
            "id": "3900308",
            "problem": "考虑一个锂离子电池的等效电路模型（ECM），该模型由一个开路电压源与一个欧姆电阻以及两个捕捉极化动态的并联电阻-电容支路串联组成。定义以下量和约定：荷电状态（SOC）$z(t)$，放电深度（DOD）$d(t)$，开路电压（OCV）$V_{\\mathrm{oc}}(z)$，串联电阻 $R_{0}$，支路电阻 $R_{1}$ 和 $R_{2}$，支路电容 $C_{1}$ 和 $C_{2}$，以及端电流 $i(t)$（放电为正）。设端电压为 $v(t)$。电芯的标称容量为 $Q_{n}$，放电深度为 $d(t) = 1 - z(t)$。该ECM的构建方式为：将 $R_{0}$ 与两个并联支路 $(R_{1}, C_{1})$ 和 $(R_{2}, C_{2})$ 串联，每个支路的电压分别表示为 $v_{1}(t)$ 和 $v_{2}(t)$。\n\n从适用于自动化电池设计和仿真的基本定律和定义出发：\n- SOC的电荷守恒：$z(t) = q(t)/Q_{n}$ 以及 $\\frac{dq(t)}{dt} = -i(t)$（根据所选的符号约定）。\n- 电容器本构关系：$i_{C}(t) = C \\frac{dv_{C}(t)}{dt}$ 和欧姆定律：$v_{R}(t) = R i_{R}(t)$。\n- 适用于上述串并联网络的基尔霍夫定律。\n\n执行以下步骤：\n1. 构建连续时间状态空间模型，其状态向量为 $x(t) = \\begin{pmatrix} v_{1}(t) \\\\ v_{2}(t) \\\\ z(t) \\end{pmatrix}$，输入为 $u(t) = i(t)$，输出为 $y(t) = v(t)$，过程中除已给出的基本原理外，不使用任何简化公式。\n2. 在一个固定的工作SOC点 $z^{\\star}$ 附近对输出关系进行线性化，其中OCV由其一阶展开式 $V_{\\mathrm{oc}}(z) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z - z^{\\star}\\right)$ 近似，且 $\\kappa = \\left.\\frac{dV_{\\mathrm{oc}}}{dz}\\right|_{z^{\\star}}$ 非零有限。将线性化后的输出表示为状态和输入的仿射函数，并确定测量矩阵 $C$ 和前馈项 $D$。\n3. 为线性化系统构建 $3 \\times 3$ 的能观性矩阵 $\\mathcal{O} = \\begin{pmatrix} C \\\\ C A \\\\ C A^{2} \\end{pmatrix}$，其中 $A$ 是步骤1中的系统矩阵，$C$ 是步骤2中的测量矩阵。然后，计算其行列式的封闭形式表达式，该表达式是 $R_{1}$、$R_{2}$、$C_{1}$、$C_{2}$ 和 $\\kappa$ 的函数。假设所有参数均为严格正且有限的。\n4. 基于您推导出的模型，简要解释电压和电流测量如何与状态的能观性相关，重点说明为什么斜率 $\\kappa$ 至关重要，并讨论电流测量在能观性计算中的作用（或其缺失的作用）。\n\n将您的最终答案表示为 $\\det(\\mathcal{O})$ 的单一封闭形式解析表达式。不要代入数值，也不要为最终表达式附加单位。无需四舍五入。您的解答应在给定背景下自成体系且科学上一致。",
            "solution": "我们首先从基本原理构建等效电路模型（ECM）。端电压 $v(t)$ 等于开路电压减去欧姆电阻和极化支路上的电压降。设两个并联的电阻-电容支路其电容两端的电压分别为 $v_{1}(t)$ 和 $v_{2}(t)$，串联电阻为 $R_{0}$。那么端电压为\n$$\nv(t) = V_{\\mathrm{oc}}(z(t)) - v_{1}(t) - v_{2}(t) - R_{0}\\, i(t).\n$$\n此符号约定与 $i(t)  0$ 表示放电一致，因此欧姆项 $R_{0}\\, i(t)$ 会使端电压相对于开路电压降低。\n\n接下来，我们从电容器和电荷守恒定律推导状态动态。对于每个极化支路，电阻和电容是并联的，因此由端电流驱动的支路电流在该支路的电阻和电容之间分流。在Thevenin型ECM中常用的有效支路动态可以用以下标准关系简洁地表示，这些关系遵循 $i_{C}(t) = C \\frac{dv(t)}{dt}$，$v_{R}(t) = R i_{R}(t)$，以及净支路电压等于支路 $k \\in \\{1,2\\}$ 的电容电压 $v_{k}(t)$ 这一约束，从而得到由端电流驱动的 $v_{k}(t)$ 的一阶衰减：\n$$\n\\frac{dv_{1}(t)}{dt} = -\\frac{1}{R_{1} C_{1}}\\, v_{1}(t) + \\frac{1}{C_{1}}\\, i(t),\n\\qquad\n\\frac{dv_{2}(t)}{dt} = -\\frac{1}{R_{2} C_{2}}\\, v_{2}(t) + \\frac{1}{C_{2}}\\, i(t).\n$$\n对于荷电状态（SOC），我们使用 $z(t) = \\frac{q(t)}{Q_{n}}$ 和电荷守恒 $\\frac{dq(t)}{dt} = -i(t)$（根据我们的符号约定），得到\n$$\n\\frac{dz(t)}{dt} = -\\frac{1}{Q_{n}}\\, i(t).\n$$\n定义状态向量 $x(t) = \\begin{pmatrix} v_{1}(t) \\\\ v_{2}(t) \\\\ z(t) \\end{pmatrix}$ 和输入 $u(t) = i(t)$，我们可以写出连续时间状态空间方程\n$$\n\\frac{dx(t)}{dt} = A\\, x(t) + B\\, u(t),\n$$\n其中\n$$\nA = \\begin{pmatrix}\n-\\frac{1}{R_{1} C_{1}}  0  0 \\\\\n0  -\\frac{1}{R_{2} C_{2}}  0 \\\\\n0  0  0\n\\end{pmatrix},\n\\qquad\nB = \\begin{pmatrix}\n\\frac{1}{C_{1}} \\\\\n\\frac{1}{C_{2}} \\\\\n-\\frac{1}{Q_{n}}\n\\end{pmatrix}.\n$$\n\n现在，我们在一个固定的工作SOC点 $z^{\\star}$ 附近对输出关系进行线性化。设开路电压由一阶近似表示为\n$$\nV_{\\mathrm{oc}}(z) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z - z^{\\star}\\right),\n\\qquad\n\\kappa = \\left.\\frac{dV_{\\mathrm{oc}}}{dz}\\right|_{z^{\\star}}.\n$$\n定义输出 $y(t) = v(t)$ 并考虑与工作点的偏差。关于点 $(z^{\\star}, v_{1}^{\\star}, v_{2}^{\\star}, i^{\\star})$（在恒定电流和足够长的时间下，稳态时 $v_{1}^{\\star} = 0$, $v_{2}^{\\star} = 0$）的线性化输出为\n$$\ny(t) \\approx V_{\\mathrm{oc}}(z^{\\star}) + \\kappa \\left(z(t) - z^{\\star}\\right) - v_{1}(t) - v_{2}(t) - R_{0}\\, i(t).\n$$\n忽略常数项，状态和输入的仿射映射为\n$$\ny(t) = C\\, x(t) + D\\, u(t) + \\text{constant},\n$$\n其中测量矩阵 $C$ 和前馈项 $D$ 分别为\n$$\nC = \\begin{pmatrix} -1  -1  \\kappa \\end{pmatrix},\n\\qquad\nD = \\begin{pmatrix} -R_{0} \\end{pmatrix}.\n$$\n对于能观性分析，常数偏移项和 $D$ 不影响 $(A,C)$ 对的能观性；只有 $A$ 和 $C$ 起作用。\n\n我们现在构建这个三状态系统的能观性矩阵：\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nC A \\\\\nC A^{2}\n\\end{pmatrix}\n$$\n我们使用上面推导出的 $A$ 和 $C$ 来显式计算它。令\n$$\na_{1} = \\frac{1}{R_{1} C_{1}},\n\\qquad\na_{2} = \\frac{1}{R_{2} C_{2}}.\n$$\n那么\n$$\nA = \\operatorname{diag}\\left(-a_{1}, -a_{2}, 0\\right),\n$$\n于是我们得到\n$$\nC = \\begin{pmatrix} -1  -1  \\kappa \\end{pmatrix},\n\\qquad\nC A = \\begin{pmatrix} -1  -1  \\kappa \\end{pmatrix} \\operatorname{diag}\\left(-a_{1}, -a_{2}, 0\\right) = \\begin{pmatrix} a_{1}  a_{2}  0 \\end{pmatrix},\n$$\n$$\nA^{2} = \\operatorname{diag}\\left(a_{1}^{2}, a_{2}^{2}, 0\\right),\n\\qquad\nC A^{2} = \\begin{pmatrix} -1  -1  \\kappa \\end{pmatrix} \\operatorname{diag}\\left(a_{1}^{2}, a_{2}^{2}, 0\\right) = \\begin{pmatrix} -a_{1}^{2}  -a_{2}^{2}  0 \\end{pmatrix}.\n$$\n因此，\n$$\n\\mathcal{O} = \n\\begin{pmatrix}\n-1  -1  \\kappa \\\\\na_{1}  a_{2}  0 \\\\\n-a_{1}^{2}  -a_{2}^{2}  0\n\\end{pmatrix}.\n$$\n$\\mathcal{O}$ 的行列式可以通过沿第三列（该列只有第一个元素非零）展开来方便地计算：\n$$\n\\det(\\mathcal{O}) = \\kappa \\cdot \\det\n\\begin{pmatrix}\na_{1}  a_{2} \\\\\n-a_{1}^{2}  -a_{2}^{2}\n\\end{pmatrix}\n= \\kappa \\left( a_{1} \\left(-a_{2}^{2}\\right) - a_{2} \\left(-a_{1}^{2}\\right) \\right)\n= \\kappa \\left( -a_{1} a_{2}^{2} + a_{2} a_{1}^{2} \\right)\n= \\kappa\\, a_{1} a_{2} \\left( a_{1} - a_{2} \\right).\n$$\n将 $a_{1}$ 和 $a_{2}$ 代回，得到封闭形式的表达式\n$$\n\\det(\\mathcal{O}) = \\kappa \\left( \\frac{1}{R_{1} C_{1}} \\right) \\left( \\frac{1}{R_{2} C_{2}} \\right) \\left( \\frac{1}{R_{1} C_{1}} - \\frac{1}{R_{2} C_{2}} \\right).\n$$\n\n最后，我们讨论通过电压和电流测量实现的能观性问题。线性化系统的能观性取决于矩阵对 $(A,C)$，其中 $C$ 将状态映射到测量的端电压。在状态空间模型中，电流 $i(t)$ 被视为已知输入 $u(t)$；包含其测量值并不会增强状态-输出映射 $C$，因为 $i(t)$ 是通过前馈项 $D$ 和输入通道 $B$ 进入模型的，而不是直接作为状态的函数。因此，能观性矩阵的秩仅由 $A$ 和 $C$ 决定。上面推导的行列式表明，能观性要求 $\\kappa \\neq 0$（开路电压必须在工作点对SOC敏感）和不同的非零极化率 $a_{1} \\neq a_{2}$（即，时间常数 $\\tau_{k} = R_{k} C_{k}$ 不同）。当这些条件满足时，端电压唯一地编码了关于SOC和极化状态的信息，从而能够在自动化电池设计和仿真中进行状态估计。电流测量对于正确的状态传播和输入核算是必不可少的，但在线性化分析中，它并不能增加超出 $v(t)$ 所能提供的状态能观性。",
            "answer": "$$\\boxed{\\kappa \\left( \\frac{1}{R_{1} C_{1}} \\right) \\left( \\frac{1}{R_{2} C_{2}} \\right) \\left( \\frac{1}{R_{1} C_{1}} - \\frac{1}{R_{2} C_{2}} \\right)}$$"
        }
    ]
}